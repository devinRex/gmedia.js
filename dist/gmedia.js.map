{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/flv-g7.js/dist/flv.js","node_modules/recorder-core/src/engine/mp3-engine.js","node_modules/recorder-core/src/engine/mp3.js","node_modules/recorder-core/src/recorder-core.js","src/common/bytearray.js","src/common/util.js","src/gmedia.js","src/helper/ghelper-events.js","src/helper/ghelper.js","src/index.js","src/player/gplayer-events.js","src/player/gplayer.js","src/player/httpflv-player.js","src/talker/gtalker-events.js","src/talker/gtalker.js","src/talker/httpflv-talker.js"],"names":[],"mappings":"AAAA;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACr4XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC51bA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ICl3Ba,S,WAAA,S;AAET,yBAAc;AAAA;;AACV,aAAK,IAAL,GAAU,EAAV;AACA,aAAK,UAAL,GAAgB,CAAhB;AACA,aAAK,MAAL,GAAY,CAAZ;AACH;;;;6BAEI,Q,EAAU;AACX,iBAAK,IAAL,CAAU,IAAV,CAAe,QAAf;AACA,iBAAK,MAAL,IAAa,SAAS,MAAtB;AACH;;;kCAES,G,EAAK;AACX,gBAAG,MAAI,CAAP,EAAS;AACL,oBAAI,OAAK,IAAI,UAAJ,CAAe,GAAf,CAAT;AACA,oBAAI,WAAS,CAAb;AACA,uBAAM,WAAS,GAAf,EAAmB;AACf,wBAAG,KAAK,IAAL,CAAU,MAAV,GAAiB,CAApB,EAAsB;AAClB,4BAAI,SAAO,KAAK,IAAL,CAAU,KAAV,EAAX;AACA,4BAAI,SAAO,OAAO,MAAlB;AACA,4BAAI,WAAS,MAAI,QAAjB;AACA,4BAAG,UAAQ,QAAX,EAAoB;AAChB;AACA,gCAAI,UAAU,OAAO,QAAP,CAAgB,CAAhB,EAAmB,QAAnB,CAAd;AACA,iCAAK,GAAL,CAAS,OAAT,EAAiB,QAAjB;AACA,wCAAU,QAAQ,MAAlB;AACA,gCAAG,WAAS,MAAZ,EAAmB;AACf,oCAAI,gBAAgB,OAAO,QAAP,CAAgB,QAAhB,EAA0B,MAA1B,CAApB;AACA,qCAAK,IAAL,CAAU,OAAV,CAAkB,aAAlB;AACH;AACD;AACH,yBAVD,MAUK;AACD,iCAAK,GAAL,CAAS,MAAT,EAAgB,QAAhB;AACA,wCAAU,MAAV;AACH;AACJ,qBAlBD,MAkBK;AACD,+BAAK,KAAK,QAAL,CAAc,CAAd,EAAiB,QAAjB,CAAL;AACA;AACH;AACJ;AACD,qBAAK,MAAL,IAAa,KAAK,MAAlB;AACA,uBAAO,IAAP;AACH;AACD,mBAAO,IAAP;AACH;;;;;;;;;;;;;;;;;IC5CQ,I,WAAA,I;;;;;;;sCACY,G,EAAK;AACtB,gBAAI,OAAO,SAAP,IAAoB,OAAO,IAA3B,IAAmC,OAAO,EAA9C,EAAkD;AAC9C,uBAAO,IAAP;AACH,aAFD,MAGK;AACD,uBAAO,KAAP;AACH;AACJ;;;;;;;;;;;;;ACTL;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA,SAAS,YAAT,CAAsB,GAAtB,EAA0C;AAAA,MAAf,MAAe,uEAAN,IAAM;;AACxC,MAAI,SAAS,IAAI,4BAAJ,EAAb;AACA,SAAO,IAAP,CAAY,GAAZ,EAAiB,MAAjB;AACA,SAAO,MAAP;AACD;;AAED,SAAS,YAAT,CAAsB,OAAtB,EAA+B,KAA/B,EAAsC,IAAtC,EAA4C,OAA5C,EAAoE;AAAA,MAAf,MAAe,uEAAN,IAAM;;AAClE,MAAI,SAAS,IAAI,4BAAJ,EAAb;AACA,MAAI,CAAC,OAAO,IAAP,CAAY,OAAZ,EAAqB,KAArB,EAA4B,IAA5B,EAAkC,OAAlC,EAA2C,MAA3C,CAAL,EAAyD;AACvD,WAAO,IAAP;AACD;AACD,SAAO,MAAP;AACD;;AAED,SAAS,YAAT,CAAsB,GAAtB,EAA2B;AACzB,MAAI,SAAS,IAAI,gBAAJ,EAAb;AACA,SAAO,IAAP,CAAY,GAAZ;AACA,SAAO,MAAP;AACD;;AAED,SAAS,kBAAT,GAA8B;AAC5B,SAAO,6BAAc,WAAd,EAAP;AACD;;AAED,SAAS,eAAT,GAA2B;AACzB,SAAO,6BAAc,WAAd,EAAP;AACD;;AAED,IAAI,WAAW,EAAf;;AAEA,SAAS,YAAT,GAAwB,YAAxB;AACA,SAAS,kBAAT,GAA8B,kBAA9B;AACA,SAAS,aAAT,GAAyB,4BAAzB;AACA,SAAS,YAAT,GAAwB,2BAAxB;AACA,SAAS,UAAT,GAAsB,yBAAtB;AACA,SAAS,sBAAT,GAAkC,qCAAlC;;AAEA,SAAS,YAAT,GAAwB,YAAxB;AACA,SAAS,eAAT,GAA2B,eAA3B;AACA,SAAS,aAAT,GAAyB,4BAAzB;AACA,SAAS,YAAT,GAAwB,2BAAxB;AACA,SAAS,oBAAT,GAAgC,mCAAhC;AACA,SAAS,uBAAT,GAAmC,sCAAnC;;AAEA,SAAS,YAAT,GAAwB,YAAxB;AACA,SAAS,OAAT,GAAmB,gBAAnB;AACA,SAAS,YAAT,GAAwB,2BAAxB;;kBAEe,Q;;;;;;;;ACxDR,IAAM,sCAAe;AACxB,iBAAa;AADW,CAArB;;;;;;;;;;;;ACAP;;;;IACa,O,WAAA,O;AACT,uBAAc;AAAA;;AACV,aAAK,cAAL,GAAsB,IAAtB;AACA,aAAK,OAAL,GAAe,IAAf;AACH;;;;6BAEI,G,EAAK;AACN,iBAAK,OAAL,GAAe,IAAI,SAAJ,CAAc,GAAd,CAAf;AACA,iBAAK,OAAL,CAAa,MAAb,GAAsB,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAAtB;AACA,iBAAK,OAAL,CAAa,SAAb,GAAyB,KAAK,iBAAL,CAAuB,IAAvB,CAA4B,IAA5B,CAAzB;AACA,iBAAK,OAAL,CAAa,OAAb,GAAuB,KAAK,eAAL,CAAqB,IAArB,CAA0B,IAA1B,CAAvB;AACA,iBAAK,OAAL,CAAa,OAAb,GAAuB,KAAK,eAAL,CAAqB,IAArB,CAA0B,IAA1B,CAAvB;AACH;;;2BAEE,K,EAAO,I,EAAM;AACZ,gBAAI,QAAQ,4BAAa,WAAzB,EAAsC;AAClC,qBAAK,cAAL,GAAsB,IAAtB;AACH;AACJ;;;4BAEG,K,EAAO;AACP,gBAAI,QAAQ,4BAAa,WAAzB,EAAsC;AAClC,qBAAK,cAAL,GAAsB,IAAtB;AACH;AACJ;;;kCAES;AACN,iBAAK,cAAL,GAAsB,IAAtB;;AAEA,gBAAI,KAAK,OAAL,IAAgB,IAApB,EAA0B;AACtB,qBAAK,OAAL,CAAa,KAAb;AACA,qBAAK,OAAL,GAAe,IAAf;AACH;AACJ;;;yCAEgB;AACb,iBAAK,yBAAL;AACH;;;0CAEiB,C,EAAG;AACjB,gBAAI,OAAO,KAAK,KAAL,CAAW,EAAE,IAAb,CAAX;AACA,gBAAI,QAAQ,IAAR,IAAgB,KAAK,IAAL,IAAa,IAAjC,EAAuC;AACnC;AACH;;AAED,gBAAI,KAAK,IAAL,IAAa,YAAb,IAA6B,KAAK,cAAL,IAAuB,IAAxD,EAA8D;AAC1D,qBAAK,cAAL,CAAoB,KAAK,IAAzB;AACH;AACJ;;;0CAEiB,CAEjB;;;0CAEiB,CAEjB;;;oDAE2B;AACxB,gBAAI,OAAO,EAAX;AACA,iBAAK,KAAL,IAAc,SAAd;AACA,iBAAK,MAAL,IAAe,YAAf;AACA,iBAAK,IAAL,IAAa,EAAb;AACA,iBAAK,MAAL,IAAe,EAAf;;AAEA,gBAAI,MAAM,KAAK,SAAL,CAAe,IAAf,CAAV;;AAEA,iBAAK,OAAL,CAAa,IAAb,CAAkB,GAAlB;AACH;;;;;;;;;ACrEL,OAAO,OAAP,GAAiB,QAAQ,aAAR,EAAuB,OAAxC;;;;;;;;ACAO,IAAM,sCAAe;AACxB,WAAO,OADiB;AAExB,sBAAkB,kBAFM;AAGxB,gBAAY,YAHY;AAIxB,qBAAiB,iBAJO;AAKxB,iBAAa,aALW;AAMxB,4BAAwB;AANA,CAArB;;AASA,IAAM,kCAAa;AACtB,mBAAe,cADO;AAEtB,iBAAa,YAFS;AAGtB,iBAAa;AAHS,CAAnB;;AAMA,IAAM,0DAAyB;AAClC,eAAW,CADuB;AAElC,cAAU,CAFwB;AAGlC,iBAAa;AAHqB,CAA/B;;;;;;;;;;;;;ICfM,O,WAAA,O;AAET,qBAAY,QAAZ,EAAsB;AAAA;;AAClB,aAAK,KAAL,GAAa,YAAY,WAAzB;AACH;;;;6BAEI,G,EAAK,M,EAAQ,CACjB;;;2BAEE,K,EAAO,I,EAAM,CAEf;;;4BAEG,K,EAAO,CAEV;;;2CAEkB,Y,EAAc,CAChC;;;+BAEM,CACN;;;+BAEM,CAEN;;;kCAES,CAET;;;gCAEO,CAEP;;;iCAEQ,CAER;;;2CAEmB,CAEnB;;;6BAEI,I,EAAM,CAEV;;;kCAES,CAET;;;;;;;;;;;;;;;;ACjDL;;AACA;;AACA;;;;AAEA;;AACA;;;;;;;;;;AAEA,IAAM,cAAc,uBAApB;;AAEA,IAAM,kBAAkB;AACpB,UAAK,CADe;AAEpB,YAAO,CAFa;AAGpB,aAAQ;AAHY,CAAxB;;IAMa,a,WAAA,a;;;AAET,6BAAe;AAAA;;AAAA,kIACL,gBADK;;AAEX,cAAK,GAAL,GAAW,eAAX;;AAEA,cAAK,MAAL,GAAc,IAAd;AACA,cAAK,OAAL,GAAe,IAAf;AACA,cAAK,MAAL,GAAc,IAAd;;AAEA,cAAK,OAAL,GAAe,IAAf;AACA,cAAK,MAAL,GAAc,IAAd;;AAEA,cAAK,YAAL,GAAoB,CAApB;AACA,cAAK,eAAL,GAAuB,gBAAgB,IAAvC;;AAEA,cAAK,SAAL,GAAiB,KAAjB;AACA,cAAK,QAAL,GAAgB,KAAhB;AACA,cAAK,OAAL,GAAe,KAAf;AACA,cAAK,QAAL,GAAgB,CAAhB;AACA,cAAK,gBAAL,GAAwB,CAAxB;AACA,cAAK,cAAL,GAAsB,CAAtB;;AAEA,cAAK,kBAAL,GAA0B,IAA1B;AACA,cAAK,kBAAL,GAA0B,IAA1B;AACA,cAAK,aAAL,GAAqB,IAArB;AACA,cAAK,sBAAL,GAA8B,IAA9B;AACA,cAAK,kBAAL,GAA0B,IAA1B;AACA,cAAK,4BAAL,GAAoC,IAApC;;AAEA,cAAK,WAAL,GAAmB,IAAnB;;AAEA,cAAK,CAAL,GAAS;AACL,0BAAe,MAAK,cAAL,CAAoB,IAApB;AADV,SAAT;AA9BW;AAiCd;;;;6BAOK,G,EAAK,M,EAAQ;AACf,iBAAK,YAAL,CAAkB,MAAlB;AACA,iBAAK,MAAL,GAAc,KAAK,YAAL,CAAkB,GAAlB,CAAd;AACA,iBAAK,eAAL,GAAuB,KAAK,qBAAL,CAA2B,GAA3B,CAAvB;;AAEA,iBAAK,MAAL,GAAc,eAAM,YAAN,CAAmB,EAAC,QAAO,KAAK,MAAb,EAAqB,MAAK,KAA1B,EAAgC,KAAI,GAApC,EAAnB,EAA6D;AACvE,0BAAU,KAD6D;AAEvE,mCAAmB,KAFoD;AAGvE,0CAAyB;AAH8C,aAA7D,CAAd;;AAMA,iBAAK,MAAL,CAAY,EAAZ,CAAe,eAAM,MAAN,CAAa,eAA5B,EAA6C,KAAK,iBAAL,CAAuB,IAAvB,CAA4B,IAA5B,CAA7C;AACA,iBAAK,MAAL,CAAY,EAAZ,CAAe,eAAM,MAAN,CAAa,KAA5B,EAAmC,KAAK,QAAL,CAAc,IAAd,CAAmB,IAAnB,CAAnC;AACA,iBAAK,MAAL,CAAY,yBAAZ,CAAsC,KAAK,iBAAL,CAAuB,IAAvB,CAA4B,IAA5B,CAAtC;AACA,iBAAK,MAAL,CAAY,qBAAZ,CAAkC,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAAlC;AACH;;;2BAEE,K,EAAO,I,EAAM;AACZ,gBAAI,UAAU,4BAAa,UAA3B,EAAuC;AACnC,qBAAK,kBAAL,GAA0B,IAA1B;AACH,aAFD,MAGK,IAAI,UAAU,4BAAa,eAA3B,EAA4C;AAC7C,qBAAK,kBAAL,GAA0B,IAA1B;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,KAA3B,EAAkC;AACnC,qBAAK,aAAL,GAAqB,IAArB;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,gBAA3B,EAA6C;AAC9C,qBAAK,sBAAL,GAA8B,IAA9B;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,WAA3B,EAAwC;AACzC,qBAAK,kBAAL,GAA0B,IAA1B;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,sBAA3B,EAAmD;AACpD,qBAAK,4BAAL,GAAoC,IAApC;AACH;AACJ;;;4BAEG,K,EAAO;AACP,gBAAI,UAAU,4BAAa,UAA3B,EAAuC;AACnC,qBAAK,kBAAL,GAA0B,IAA1B;AACH,aAFD,MAGK,IAAI,UAAU,4BAAa,eAA3B,EAA4C;AAC7C,qBAAK,kBAAL,GAA0B,IAA1B;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,KAA3B,EAAkC;AACnC,qBAAK,aAAL,GAAqB,IAArB;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,gBAA3B,EAA6C;AAC9C,qBAAK,sBAAL,GAA8B,IAA9B;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,WAA3B,EAAwC;AACzC,qBAAK,kBAAL,GAA0B,IAA1B;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,sBAA3B,EAAmD;AACpD,qBAAK,4BAAL,GAAoC,IAApC;AACH;AACJ;;;2CAEkB,E,EAAI;AACnB,iBAAK,OAAL,GAAe,EAAf;AACA,iBAAK,OAAL,CAAa,gBAAb,CAA8B,YAA9B,EAA4C,KAAK,CAAL,CAAO,YAAnD;AACA,iBAAK,MAAL,CAAY,kBAAZ,CAA+B,EAA/B;AACH;;;+BAEM;AACH,gBAAI,KAAK,OAAL,IAAgB,IAApB,EAA0B;AACtB,qBAAK,MAAL,GAAc,IAAI,gBAAJ,EAAd;AACA,qBAAK,MAAL,CAAY,IAAZ,CAAiB,KAAK,OAAtB;AACA,qBAAK,MAAL,CAAY,EAAZ,CAAe,4BAAa,WAA5B,EAAwC,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAAxC;AACH;;AAED,iBAAK,MAAL,CAAY,IAAZ;AACH;;;+BAEM;AACH,iBAAK,MAAL,CAAY,IAAZ;AACH;;;kCAES;AACN,gBAAI,SAAS,SAAS,aAAT,CAAuB,QAAvB,CAAb;AACA,mBAAO,KAAP,GAAe,KAAK,OAAL,CAAa,UAA5B;AACA,mBAAO,MAAP,GAAgB,KAAK,OAAL,CAAa,WAA7B;AACA,mBAAO,UAAP,CAAkB,IAAlB,EAAwB,SAAxB,CAAkC,KAAK,OAAvC,EAAgD,CAAhD,EAAmD,CAAnD,EAAsD,OAAO,KAA7D,EAAoE,OAAO,MAA3E;AACA,gBAAI,UAAU,OAAO,SAAP,EAAd;AACA,mBAAO,OAAP;AACH;;;gCAEO;AACJ,iBAAK,OAAL,CAAa,KAAb;AACA,mBAAO,KAAP;AACH;;;iCAEQ;AACL,iBAAK,OAAL,CAAa,IAAb;AACA,mBAAO,KAAP;AACH;;;2CAEmB;AAChB,gBAAI,WAAW,KAAK,OAAL,CAAa,QAA5B;AACA,gBAAI,SAAS,MAAT,GAAkB,CAAtB,EAAyB;AACrB,oBAAI,OAAO,SAAS,KAAT,CAAe,SAAS,MAAT,GAAiB,CAAhC,CAAX;AACA,oBAAI,KAAK,SAAS,GAAT,CAAa,SAAS,MAAT,GAAiB,CAA9B,CAAT;AACA,qBAAK,OAAL,CAAa,WAAb,GAA2B,EAA3B;AACH;AACJ;;;6BAEI,I,EAAM;AACP,gBAAI,KAAK,OAAL,IAAgB,IAApB,EAA0B;AACtB,uBAAO,KAAP;AACH;AACD,gBAAI,KAAK,OAAT,EAAkB;AACd,uBAAO,KAAP;AACH;;AAED,gBAAI,KAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,qBAAK,4BAAL,CAAkC,sCAAuB,SAAzD,EACI,UADJ;AAEH;;AAED,gBAAI,CAAC,KAAK,aAAL,CAAmB,IAAnB,CAAL,EAA+B;AAC3B,uBAAO,KAAP;AACH;AACD,gBAAI,KAAK,eAAL,IAAwB,gBAAgB,MAA5C,EAAoD;AAChD,qBAAK,aAAL,CAAmB,IAAnB;AACH,aAFD,MAGK;AACD,qBAAK,cAAL,CAAoB,IAApB;AACH;AACD,mBAAO,IAAP;AACH;;;kCAES;AACN,gBAAI,KAAK,MAAL,IAAe,IAAnB,EAAyB;AACrB,qBAAK,MAAL,CAAY,OAAZ;AACH;;AAED,gBAAI,KAAK,MAAL,IAAe,IAAnB,EAAyB;AACrB,qBAAK,MAAL,CAAY,KAAZ;AACA,qBAAK,MAAL,CAAY,MAAZ;AACA,qBAAK,MAAL,CAAY,kBAAZ;AACA,qBAAK,MAAL,CAAY,OAAZ;AACA,qBAAK,MAAL,GAAc,IAAd;AACH;;AAED,gBAAI,KAAK,OAAL,IAAgB,IAApB,EAA0B;AACtB,qBAAK,OAAL,CAAa,mBAAb,CAAiC,YAAjC,EAA+C,KAAK,CAAL,CAAO,YAAtD;AACA,qBAAK,OAAL,GAAe,IAAf;AACH;AACJ;;;qCAEY,M,EAAQ;AACjB,gBAAI,UAAU,IAAd,EAAoB;AAChB;AACH;;AAED,gBAAI,OAAO,YAAP,IAAuB,IAA3B,EAAiC;AAC7B,qBAAK,YAAL,GAAoB,OAAO,YAA3B;AACH;;AAED,gBAAI,OAAO,OAAP,IAAkB,IAAtB,EAA4B;AACxB,qBAAK,OAAL,GAAe,OAAO,OAAtB;AACH;AACJ;;;qCAEY,G,EAAK;AACd,gBAAI,IAAI,OAAJ,CAAY,WAAZ,KAA4B,CAAC,CAAjC,EAAoC;AAChC,uBAAO,KAAP;AACH;AACD,mBAAO,IAAP;AACH;;;8CAEqB,G,EAAK;AACvB,gBAAI,MAAM,IAAI,KAAJ,CAAU,UAAV,CAAV;AACA,gBAAI,IAAI,MAAJ,GAAa,CAAb,IAAkB,IAAI,CAAJ,EAAO,MAAP,GAAgB,CAAtC,EAAyC;AACrC,uBAAO,gBAAgB,IAAvB;AACH;AACD,gBAAI,aAAa,IAAI,CAAJ,CAAjB;AACA,gBAAI,aAAa,WAAW,SAAX,CAAqB,CAArB,EAAuB,CAAvB,CAAjB;AACA,gBAAI,cAAc,KAAlB,EAAyB;AACrB,uBAAO,gBAAgB,OAAvB;AACH;AACD,mBAAO,gBAAgB,MAAvB;AACH;;;sCAEa,I,EAAM;AAChB,gBAAI,CAAC,KAAK,SAAV,EAAqB;AACjB,uBAAO,IAAP;AACH;;AAED,iBAAK,OAAL,GAAe,IAAf;;AAEA,gBAAI,UAAU,KAAd;AACA,gBAAI,WAAW,KAAK,OAAL,CAAa,QAA5B;AACA,iBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,SAAS,MAA7B,EAAqC,GAArC,EAA0C;AACtC,oBAAI,OAAO,SAAS,KAAT,CAAe,CAAf,CAAX;AACA,oBAAI,KAAK,SAAS,GAAT,CAAa,CAAb,CAAT;AACA,oBAAI,OAAO,IAAP,IAAe,OAAO,EAA1B,EAA8B;AAC1B,8BAAU,IAAV;AACH;AACJ;;AAED,gBAAI,WAAW,OAAO,KAAK,OAAL,CAAa,WAAnC,EAAgD;AAC5C,qBAAK,OAAL,CAAa,WAAb,GAA2B,IAA3B;AACA,oBAAI,KAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,yBAAK,4BAAL,CAAkC,sCAAuB,WAAzD,EACI,UADJ;AAEH;AACJ,aAND,MAOK;AACD,oBAAI,KAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,yBAAK,4BAAL,CAAkC,sCAAuB,QAAzD,EACI,mBADJ;AAEH;AACJ;;AAED,iBAAK,OAAL,GAAe,KAAf;AACA,mBAAO,KAAP;AACH;;;sCAEa,I,EAAM;AAAA;;AAChB,iBAAK,OAAL,GAAe,IAAf;;AAEA,iBAAK,cAAL,GAAsB,IAAI,IAAJ,GAAW,OAAX,EAAtB;;AAEA,iBAAK,WAAL,GAAmB,WAAW,YAAI;AAC9B,uBAAK,QAAL,GAAgB,KAAhB;AACA,uBAAK,OAAL,GAAe,KAAf;AACA,oBAAI,OAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,2BAAK,4BAAL,CAAkC,sCAAuB,QAAzD,EACI,gBADJ;AAEH;AACJ,aAPkB,EAOjB,KAAG,IAPc,CAAnB;;AASA,iBAAK,QAAL,GAAgB,IAAhB;AACA,iBAAK,QAAL,GAAgB,IAAhB;AACH;;;uCAEc,I,EAAM;AAAA;;AACjB,iBAAK,OAAL,GAAe,IAAf;;AAEA,iBAAK,QAAL,GAAgB,IAAhB;AACA;AACA,gBAAI,WAAW,KAAK,OAAL,CAAa,QAA5B;AACA,gBAAI,SAAS,MAAT,GAAkB,CAAtB,EAAyB;AACrB;AACA,oBAAI,OAAO,SAAS,KAAT,CAAe,CAAf,CAAX;AACA,oBAAI,KAAK,SAAS,GAAT,CAAa,CAAb,CAAT;AACA,qBAAK,gBAAL,GAAwB,EAAxB;;AAEA,qBAAK,OAAL,CAAa,WAAb,GAA2B,KAAK,gBAAhC;AACH;;AAED,uBAAW,YAAI;AACX,uBAAK,OAAL,GAAe,KAAf;AACA,oBAAI,OAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,2BAAK,4BAAL,CAAkC,sCAAuB,WAAzD,EACI,UADJ;AAEH;AACJ,aAND,EAME,IANF;AAOH;;;sCAEa,I,EAAM;AAChB,gBAAI,KAAK,kBAAL,IAA2B,IAA/B,EAAqC;AACjC,qBAAK,kBAAL,CAAwB,IAAxB;AACH;AACJ;;;0CAEiB,I,EAAM;AACpB,gBAAI,KAAK,kBAAL,IAA2B,IAA/B,EAAqC;AACjC,oBAAI,OAAO,EAAX;AACA,qBAAK,KAAL,GAAa,KAAK,KAAlB;AACA,qBAAK,kBAAL,CAAwB,IAAxB;AACH;AACJ;;;iCAEQ,I,EAAM,M,EAAQ,M,EAAQ;AAC3B,gBAAI,KAAK,aAAL,IAAsB,IAA1B,EAAgC;AAC5B,oBAAI,QAAQ,IAAZ;AACA,oBAAI,WAAW,MAAf;AACA,oBAAI,OAAO,IAAX;AACA,qBAAK,aAAL,CAAmB,IAAnB,EAAyB,QAAzB,EAAmC,IAAnC;AACH;AACJ;;;0CAEiB,I,EAAM;AACpB,iBAAK,SAAL,GAAiB,IAAjB;AACA,gBAAI,KAAK,sBAAL,IAA+B,IAAnC,EAAyC;AACrC,qBAAK,sBAAL;AACH;AACJ;;;uCAEc,K,EAAO;AAClB;AACA,gBAAI,KAAK,YAAL,IAAqB,CAAzB,EAA4B;AACxB,oBAAI,KAAK,kBAAL,IAA2B,IAA3B,IAAmC,KAAK,OAAL,IAAgB,IAAvD,EAA6D;AACzD,yBAAK,kBAAL,CAAwB,KAAK,OAAL,CAAa,WAArC;AACH;AACD;AACH;;AAED;AACA,gBAAI,KAAK,eAAL,KAAyB,gBAAgB,MAA7C,EAAqD;AACjD,oBAAI,CAAC,KAAK,OAAN,IAAiB,KAAK,kBAAL,IAA2B,IAA5C,IAAoD,KAAK,OAAL,IAAgB,IAAxE,EAA8E;AAC1E,yBAAK,kBAAL,CAAwB,KAAK,OAAL,CAAa,WAArC;AACH;AACJ,aAJD,MAKK,IAAI,KAAK,eAAL,KAAyB,gBAAgB,OAA7C,EAAsD;AACvD,oBAAI,CAAC,KAAK,OAAN,IAAiB,KAAK,kBAAL,IAA2B,IAA5C,IAAoD,KAAK,OAAL,IAAgB,IAAxE,EAA8E;AAC1E,wBAAI,cAAc,KAAK,QAAL,IAAiB,KAAK,OAAL,CAAa,WAAb,GAA2B,KAAK,gBAAjD,CAAlB;AACA,yBAAK,kBAAL,CAAwB,WAAxB;AACH;AACJ;AACJ;;;sCAEa,I,EAAM;AAAA;;AAChB,gBAAI,KAAK,QAAT,EAAmB;AACf,oBAAI,KAAK,GAAL,CAAS,KAAK,QAAL,GAAc,IAAd,GAAqB,IAA9B,KAAuC,IAA3C,EAAiD;AAC7C;AACH;;AAED,oBAAI,KAAK,WAAL,IAAoB,IAAxB,EAA8B;AAC1B,iCAAa,KAAK,WAAlB;AACA,yBAAK,WAAL,GAAmB,IAAnB;AACH;;AAED,qBAAK,QAAL,GAAgB,KAAhB;AACA,2BAAW,YAAI;AACX,2BAAK,OAAL,GAAe,KAAf;AACA,2BAAK,OAAL,CAAa,WAAb,GAA2B,OAAK,IAAhC;AACA,wBAAI,MAAM,IAAI,IAAJ,GAAW,OAAX,KAAuB,OAAK,cAAtC;AACA,4BAAQ,GAAR,CAAY,WAAW,GAAvB;AACA,wBAAI,OAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,+BAAK,4BAAL,CAAkC,sCAAuB,WAAzD,EACI,UADJ;AAEH;AACJ,iBATD,EASE,IATF;AAUA;AACH;AACJ;;;sCAxVoB;AACjB,mBAAO,OAAO,WAAP,IACH,OAAO,WAAP,CAAmB,eAAnB,CAAmC,2CAAnC,CADJ;AAEH;;;;EAxC8B,gB;;;;;;;;ACf5B,IAAM,sCAAe;AACxB,oBAAgB;AADQ,CAArB;;AAIA,IAAM,sDAAuB;AAChC,oBAAgB,gBADgB;AAEhC,kBAAc;AAFkB,CAA7B;;AAKA,IAAM,4DAA0B;AACnC,yBAAqB,qBADc;AAEnC,4BAAwB,wBAFW;AAGnC,kBAAc,cAHqB;AAInC,gBAAY,YAJuB;AAKnC,+BAA2B,2BALQ;AAMnC,4BAAwB;AANW,CAAhC;;;;;;;;;;;;;ICTM,O,WAAA,O;AAET,qBAAY,QAAZ,EAAsB;AAAA;;AAClB,aAAK,KAAL,GAAa,YAAY,WAAzB;AACH;;;;6BAEI,O,EAAS,K,EAAO,I,EAAM,O,EAAS,M,EAAQ,CAC3C;;;2BAEE,K,EAAO,I,EAAM,CAEf;;;4BAEG,K,EAAO,CAEV;;;2CAEkB,O,EAAS,CAC3B;;;+BAEM,CACN;;;kCAES,CAET;;;;;;;;;;;;;;;;ACzBL;;AACA;;AACA;;AACA;;AAEA;;;;AAEA;;;;AACA;;AACA;;;;;;;;;;AAEA,IAAM,cAAc,GAApB;AACA,IAAM,YAAY,KAAlB;;IAEa,a,WAAA,a;;;AAET,6BAAe;AAAA;;AAAA,kIACL,gBADK;;AAEX,cAAK,GAAL,GAAW,eAAX;;AAEA,cAAK,OAAL,GAAe,IAAf;AACA,cAAK,KAAL,GAAa,IAAb;AACA,cAAK,IAAL,GAAY,IAAZ;AACA,cAAK,OAAL,GAAe,IAAf;;AAEA,cAAK,MAAL,GAAc,IAAd;AACA,cAAK,QAAL,GAAgB,IAAhB;AACA,cAAK,MAAL,GAAc,IAAd;AACA,cAAK,OAAL,GAAe,IAAf;;AAEA,cAAK,qBAAL,GAA6B,IAA7B;;AAEA,cAAK,SAAL,GAAiB,IAAI,oBAAJ,EAAjB;;AAEA,cAAK,UAAL,GAAkB,IAAlB;AACA,cAAK,SAAL,GAAiB,IAAjB;;AAEA,cAAK,oBAAL,GAA4B,KAA5B;AACA,cAAK,iBAAL,GAAyB,KAAzB;AACA,cAAK,4BAAL,GAAoC,KAApC;AACA,cAAK,UAAL,GAAkB,KAAlB;AAxBW;AAyBd;;;;6BAOI,O,EAAS,K,EAAO,I,EAAM,O,EAAS,M,EAAQ;AACxC,iBAAK,OAAL,GAAe,OAAf;AACA,iBAAK,KAAL,GAAa,KAAb;AACA,iBAAK,IAAL,GAAY,IAAZ;AACA,iBAAK,OAAL,GAAe,OAAf;AACA,gBAAI,CAAC,KAAK,gBAAL,EAAL,EAA8B;AAC1B,uBAAO,KAAP;AACH;;AAED,iBAAK,YAAL,CAAkB,OAAlB;AACA,mBAAO,IAAP;AACH;;;2BAEE,K,EAAO,I,EAAM;AACZ,gBAAI,UAAU,4BAAa,cAA3B,EAA2C;AACvC,qBAAK,qBAAL,GAA6B,IAA7B;AACH;AACJ;;;4BAEG,K,EAAO;AACP,gBAAI,UAAU,4BAAa,cAA3B,EAA2C;AACvC,qBAAK,qBAAL,GAA6B,IAA7B;AACH;AACJ;;;2CAEkB,O,EAAS;AACxB,iBAAK,OAAL,GAAe,OAAf;;AAEA,iBAAK,OAAL,CAAa,gBAAb,CAA8B,YAA9B,EAA4C,KAAK,mBAAL,CAAyB,IAAzB,CAA8B,IAA9B,CAA5C,EAAiF,EAAC,MAAM,IAAP,EAAjF;AACA,iBAAK,MAAL,CAAY,EAAZ,CAAe,eAAM,MAAN,CAAa,KAA5B,EAAmC,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAAnC;AACA,iBAAK,MAAL,CAAY,yBAAZ,CAAsC,KAAK,uBAAL,CAA6B,IAA7B,CAAkC,IAAlC,CAAtC;;AAEA,iBAAK,MAAL,CAAY,kBAAZ,CAA+B,OAA/B;AACH;;;+BAEM;AACH,iBAAK,MAAL,CAAY,IAAZ;AACA,iBAAK,YAAL,CAAkB,KAAK,KAAvB;AACH;;;kCAES;AACN,iBAAK,UAAL,GAAkB,IAAlB;;AAEA,iBAAK,cAAL;AACA,iBAAK,cAAL;AACA,iBAAK,gBAAL;AACA,iBAAK,gBAAL;AACH;;;2CAEkB;AACf,gBAAI,WAAK,aAAL,CAAmB,KAAK,OAAxB,KAAoC,WAAK,aAAL,CAAmB,KAAK,KAAxB,CAAxC,EAAwE;AACpE,uBAAO,KAAP;AACH;AACD,gBAAI,WAAK,aAAL,CAAmB,KAAK,IAAxB,CAAJ,EAAmC;AAC/B,uBAAO,KAAP;AACH;AACD,gBAAI,KAAK,OAAL,GAAe,CAAf,IAAoB,KAAK,OAAL,GAAe,GAAvC,EAA4C;AACxC,uBAAO,KAAP;AACH;AACD,mBAAO,IAAP;AACH;;;qCAEY,G,EAAK;AACd,iBAAK,cAAL;;AAEA,iBAAK,MAAL,GAAc,eAAM,YAAN,CAAmB,EAAC,QAAO,IAAR,EAAc,MAAK,KAAnB,EAAyB,KAAI,GAA7B,EAAnB,EAAsD;AAChE,0BAAU,KADsD;AAEhE,mCAAmB,KAF6C;AAGhE,0CAAyB;AAHuC,aAAtD,CAAd;AAKH;;;8CAEqB;AAClB,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,mBAAZ;AACH;;AAED,iBAAK,oBAAL,GAA4B,IAA5B;AACA,gBAAI,KAAK,iBAAL,IAA0B,KAAK,qBAAL,IAA8B,IAA5D,EAAkE;AAC9D,qBAAK,qBAAL,CAA2B,oCAAqB,cAAhD,EAAgE,EAAhE;AACH;AACJ;;;uCAEc,I,EAAM,M,EAAQ,M,EAAQ;AACjC,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,cAAZ;AACH;;AAED,gBAAI,KAAK,qBAAL,IAA8B,IAAlC,EAAwC;AACpC;AACH;;AAED,gBAAI,KAAK,oBAAT,EAA+B;AAC3B,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,YAD5B;AAEH,aAHD,MAIK;AACD,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,mBAD5B;AAEH;AACJ;;;gDAEuB,I,EAAM;AAC1B,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,mBAAZ;AACH;;AAED,gBAAI,KAAK,qBAAL,IAA8B,IAAlC,EAAwC;AACpC,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,sBAD5B;AAEH;AACJ;;;yCAEgB;AACb,gBAAI,KAAK,MAAL,IAAe,IAAnB,EAAyB;AACrB,qBAAK,MAAL,CAAY,KAAZ;AACA,qBAAK,MAAL,CAAY,MAAZ;AACA,qBAAK,MAAL,CAAY,kBAAZ;AACA,qBAAK,MAAL,CAAY,OAAZ;AACA,qBAAK,MAAL,GAAc,IAAd;AACH;;AAED,gBAAI,KAAK,OAAL,IAAgB,IAApB,EAA0B;AACtB,qBAAK,OAAL,GAAe,IAAf;AACH;AACJ;;;qCAEY,G,EAAK;AACd,iBAAK,MAAL,GAAc,IAAI,SAAJ,CAAc,GAAd,CAAd;AACA,iBAAK,MAAL,CAAY,MAAZ,GAAqB,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAArB;AACA,iBAAK,MAAL,CAAY,SAAZ,GAAwB,KAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,CAAxB;AACA,iBAAK,MAAL,CAAY,OAAZ,GAAsB,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAAtB;AACA,iBAAK,MAAL,CAAY,OAAZ,GAAsB,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAAtB;AACH;;;wCAEe;AACZ,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,gBAAZ;AACH;;AAED,iBAAK,cAAL;AACH;;;qCAEY,C,EAAG,CAEf;;;uCAEc,C,EAAG;AACd,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,iBAAZ;AACH;;AAED,gBAAI,KAAK,qBAAL,IAA8B,IAAlC,EAAwC;AACpC,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,UAD5B;AAEH;AACJ;;;uCAEc,C,EAAG;AACd,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,iBAAZ;AACH;AACJ;;;yCAEgB;AACb,iBAAK,MAAL,CAAY,KAAZ;AACA,iBAAK,MAAL,GAAc,IAAd;AACH;;;yCAEgB;AACb,gBAAI,KAAK,QAAT,EAAmB;AACf,qBAAK,QAAL,CAAc,KAAd;AACH;;AAED,iBAAK,QAAL,GAAgB,4BAAS;AACrB,sBAAK,KADgB;AAErB,4BAAW,IAFU;AAGrB,yBAAQ,EAHa;AAIrB,2BAAU,KAAK,wBAAL,CAA8B,IAA9B,CAAmC,IAAnC;AAJW,aAAT,CAAhB;AAMA,iBAAK,UAAL,GAAkB,WAAW,KAAK,kCAAL,CAAwC,IAAxC,CAA6C,IAA7C,CAAX,EAA8D,KAA9D,CAAlB;AACA,iBAAK,QAAL,CAAc,IAAd,CAAmB,KAAK,sBAAL,CAA4B,IAA5B,CAAiC,IAAjC,CAAnB,EACI,KAAK,yBAAL,CAA+B,IAA/B,CAAoC,IAApC,CADJ;AAEH;;;6DAEoC;AACjC,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,iCAAZ;AACH;;AAED,iBAAK,4BAAL,GAAoC,IAApC;;AAEA,gBAAI,KAAK,qBAAL,IAA8B,IAAlC,EAAwC;AACpC,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,yBAD5B;AAEH;AACJ;;;iDAEwB;AACrB,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,0BAAZ;AACH;;AAED,gBAAI,KAAK,4BAAT,EAAuC;AACnC;AACH;;AAED,yBAAa,KAAK,UAAlB;;AAEA,iBAAK,iBAAL,GAAyB,IAAzB;AACA,gBAAI,KAAK,oBAAL,IAA6B,KAAK,qBAAL,IAA8B,IAA/D,EAAqE;AACjE,qBAAK,qBAAL,CAA2B,oCAAqB,cAAhD,EAAgE,EAAhE;AACH;;AAED,iBAAK,QAAL,CAAc,KAAd;AACA,iBAAK,SAAL;AACH;;;kDAEyB,G,EAAK,c,EAAgB;AAC3C,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,6BAAZ;AACH;;AAED,yBAAa,KAAK,UAAlB;;AAEA,gBAAI,KAAK,qBAAL,IAA8B,IAAlC,EAAwC;AACpC,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,sBAD5B;AAEH;AACJ;;;iDAEwB,O,EAAS,U,EAAY,c,EAAgB,gB,EAAkB;AAC5E,gBAAI,WAAW,QAAQ,QAAQ,MAAR,GAAiB,CAAzB,EAA4B,MAA3C,CAD4E,CACzB;AACnD,gBAAI,QAAQ,IAAI,UAAJ,CAAe,QAAf,CAAZ,CAF4E,CAEtC;AACtC,iBAAK,SAAL,CAAe,IAAf,CAAoB,KAApB;AACH;;;2CAEkB;AACf,iBAAK,QAAL,CAAc,KAAd;AACA,iBAAK,QAAL,GAAgB,IAAhB;AACH;;;oCAEW;AACR,gBAAI,KAAK,UAAT,EAAqB;AACjB;AACH;;AAED,gBAAI,KAAK,SAAL,CAAe,MAAf,GAAwB,WAA5B,EAAyC;AACrC,qBAAK,SAAL,GAAiB,WAAW,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,CAAX,EAAsC,CAAtC,CAAjB;AACH,aAFD,MAGK;AACD,oBAAI,WAAW,KAAK,SAAL,CAAe,SAAf,CAAyB,WAAzB,CAAf;;AAEA,oBAAI,SAAS,IAAI,oBAAJ,EAAb;AACA,uBAAO,IAAP,CAAY,IAAI,UAAJ,CAAe,CAAC,IAAD,EAAM,IAAN,EAAW,IAAX,EAAgB,IAAhB,CAAf,CAAZ;AACA,oBAAI,cAAc,KAAK,IAAL,CAAU,KAAV,CAAgB,EAAhB,CAAlB;AACA,qBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,YAAY,MAAhC,EAAwC,GAAxC,EAA6C;AACzC,2BAAO,IAAP,CAAY,IAAI,UAAJ,CAAe,CAAC,YAAY,CAAZ,EAAe,UAAf,EAAD,CAAf,CAAZ;AACH;AACD,uBAAO,IAAP,CAAY,IAAI,UAAJ,CAAe,CAAC,SAAS,KAAK,OAAd,CAAD,CAAf,CAAZ;AACA,uBAAO,IAAP,CAAY,IAAI,UAAJ,CAAe,CAAC,KAAK,KAAL,CAAW,cAAY,GAAvB,CAAD,CAAf,CAAZ;AACA,uBAAO,IAAP,CAAY,IAAI,UAAJ,CAAe,CAAC,cAAY,GAAb,CAAf,CAAZ;AACA,uBAAO,IAAP,CAAY,QAAZ;;AAEA,oBAAI,WAAW,IAAI,YAAY,MAAhB,GAAyB,CAAzB,GAA6B,WAA5C;AACA,oBAAI,KAAK,MAAL,IAAe,IAAnB,EAAyB;AACrB,yBAAK,MAAL,CAAY,IAAZ,CAAiB,OAAO,SAAP,CAAiB,QAAjB,CAAjB;AACH;;AAED,qBAAK,SAAL;AACH;AACJ;;;2CAEkB;AACf,yBAAa,KAAK,SAAlB;AACH;;;sCAxRoB;AACjB,mBAAO,OAAO,SAAP,IAAoB,WAApB,IAAmC,uBAAS,OAAT,EAAnC,IAAyD,OAAO,WAAhE,IACH,OAAO,WAAP,CAAmB,eAAnB,CAAmC,2CAAnC,CADJ;AAEH;;;;EAhC8B,gB","file":"gmedia.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.flvjs = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n(function (process,global){\n/*!\n * @overview es6-promise - a tiny implementation of Promises/A+.\n * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)\n * @license   Licensed under MIT license\n *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE\n * @version   v4.2.5+7f2b526d\n */\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.ES6Promise = factory());\n}(this, (function () { 'use strict';\n\nfunction objectOrFunction(x) {\n  var type = typeof x;\n  return x !== null && (type === 'object' || type === 'function');\n}\n\nfunction isFunction(x) {\n  return typeof x === 'function';\n}\n\n\n\nvar _isArray = void 0;\nif (Array.isArray) {\n  _isArray = Array.isArray;\n} else {\n  _isArray = function (x) {\n    return Object.prototype.toString.call(x) === '[object Array]';\n  };\n}\n\nvar isArray = _isArray;\n\nvar len = 0;\nvar vertxNext = void 0;\nvar customSchedulerFn = void 0;\n\nvar asap = function asap(callback, arg) {\n  queue[len] = callback;\n  queue[len + 1] = arg;\n  len += 2;\n  if (len === 2) {\n    // If len is 2, that means that we need to schedule an async flush.\n    // If additional callbacks are queued before the queue is flushed, they\n    // will be processed by this flush that we are scheduling.\n    if (customSchedulerFn) {\n      customSchedulerFn(flush);\n    } else {\n      scheduleFlush();\n    }\n  }\n};\n\nfunction setScheduler(scheduleFn) {\n  customSchedulerFn = scheduleFn;\n}\n\nfunction setAsap(asapFn) {\n  asap = asapFn;\n}\n\nvar browserWindow = typeof window !== 'undefined' ? window : undefined;\nvar browserGlobal = browserWindow || {};\nvar BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;\nvar isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';\n\n// test for web worker but not in IE10\nvar isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined';\n\n// node\nfunction useNextTick() {\n  // node version 0.10.x displays a deprecation warning when nextTick is used recursively\n  // see https://github.com/cujojs/when/issues/410 for details\n  return function () {\n    return process.nextTick(flush);\n  };\n}\n\n// vertx\nfunction useVertxTimer() {\n  if (typeof vertxNext !== 'undefined') {\n    return function () {\n      vertxNext(flush);\n    };\n  }\n\n  return useSetTimeout();\n}\n\nfunction useMutationObserver() {\n  var iterations = 0;\n  var observer = new BrowserMutationObserver(flush);\n  var node = document.createTextNode('');\n  observer.observe(node, { characterData: true });\n\n  return function () {\n    node.data = iterations = ++iterations % 2;\n  };\n}\n\n// web worker\nfunction useMessageChannel() {\n  var channel = new MessageChannel();\n  channel.port1.onmessage = flush;\n  return function () {\n    return channel.port2.postMessage(0);\n  };\n}\n\nfunction useSetTimeout() {\n  // Store setTimeout reference so es6-promise will be unaffected by\n  // other code modifying setTimeout (like sinon.useFakeTimers())\n  var globalSetTimeout = setTimeout;\n  return function () {\n    return globalSetTimeout(flush, 1);\n  };\n}\n\nvar queue = new Array(1000);\nfunction flush() {\n  for (var i = 0; i < len; i += 2) {\n    var callback = queue[i];\n    var arg = queue[i + 1];\n\n    callback(arg);\n\n    queue[i] = undefined;\n    queue[i + 1] = undefined;\n  }\n\n  len = 0;\n}\n\nfunction attemptVertx() {\n  try {\n    var vertx = Function('return this')().require('vertx');\n    vertxNext = vertx.runOnLoop || vertx.runOnContext;\n    return useVertxTimer();\n  } catch (e) {\n    return useSetTimeout();\n  }\n}\n\nvar scheduleFlush = void 0;\n// Decide what async method to use to triggering processing of queued callbacks:\nif (isNode) {\n  scheduleFlush = useNextTick();\n} else if (BrowserMutationObserver) {\n  scheduleFlush = useMutationObserver();\n} else if (isWorker) {\n  scheduleFlush = useMessageChannel();\n} else if (browserWindow === undefined && typeof _dereq_ === 'function') {\n  scheduleFlush = attemptVertx();\n} else {\n  scheduleFlush = useSetTimeout();\n}\n\nfunction then(onFulfillment, onRejection) {\n  var parent = this;\n\n  var child = new this.constructor(noop);\n\n  if (child[PROMISE_ID] === undefined) {\n    makePromise(child);\n  }\n\n  var _state = parent._state;\n\n\n  if (_state) {\n    var callback = arguments[_state - 1];\n    asap(function () {\n      return invokeCallback(_state, child, callback, parent._result);\n    });\n  } else {\n    subscribe(parent, child, onFulfillment, onRejection);\n  }\n\n  return child;\n}\n\n/**\n  `Promise.resolve` returns a promise that will become resolved with the\n  passed `value`. It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    resolve(1);\n  });\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.resolve(1);\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  @method resolve\n  @static\n  @param {Any} value value that the returned promise will be resolved with\n  Useful for tooling.\n  @return {Promise} a promise that will become fulfilled with the given\n  `value`\n*/\nfunction resolve$1(object) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (object && typeof object === 'object' && object.constructor === Constructor) {\n    return object;\n  }\n\n  var promise = new Constructor(noop);\n  resolve(promise, object);\n  return promise;\n}\n\nvar PROMISE_ID = Math.random().toString(36).substring(2);\n\nfunction noop() {}\n\nvar PENDING = void 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\n\nvar TRY_CATCH_ERROR = { error: null };\n\nfunction selfFulfillment() {\n  return new TypeError(\"You cannot resolve a promise with itself\");\n}\n\nfunction cannotReturnOwn() {\n  return new TypeError('A promises callback cannot return that same promise.');\n}\n\nfunction getThen(promise) {\n  try {\n    return promise.then;\n  } catch (error) {\n    TRY_CATCH_ERROR.error = error;\n    return TRY_CATCH_ERROR;\n  }\n}\n\nfunction tryThen(then$$1, value, fulfillmentHandler, rejectionHandler) {\n  try {\n    then$$1.call(value, fulfillmentHandler, rejectionHandler);\n  } catch (e) {\n    return e;\n  }\n}\n\nfunction handleForeignThenable(promise, thenable, then$$1) {\n  asap(function (promise) {\n    var sealed = false;\n    var error = tryThen(then$$1, thenable, function (value) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n      if (thenable !== value) {\n        resolve(promise, value);\n      } else {\n        fulfill(promise, value);\n      }\n    }, function (reason) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n\n      reject(promise, reason);\n    }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n    if (!sealed && error) {\n      sealed = true;\n      reject(promise, error);\n    }\n  }, promise);\n}\n\nfunction handleOwnThenable(promise, thenable) {\n  if (thenable._state === FULFILLED) {\n    fulfill(promise, thenable._result);\n  } else if (thenable._state === REJECTED) {\n    reject(promise, thenable._result);\n  } else {\n    subscribe(thenable, undefined, function (value) {\n      return resolve(promise, value);\n    }, function (reason) {\n      return reject(promise, reason);\n    });\n  }\n}\n\nfunction handleMaybeThenable(promise, maybeThenable, then$$1) {\n  if (maybeThenable.constructor === promise.constructor && then$$1 === then && maybeThenable.constructor.resolve === resolve$1) {\n    handleOwnThenable(promise, maybeThenable);\n  } else {\n    if (then$$1 === TRY_CATCH_ERROR) {\n      reject(promise, TRY_CATCH_ERROR.error);\n      TRY_CATCH_ERROR.error = null;\n    } else if (then$$1 === undefined) {\n      fulfill(promise, maybeThenable);\n    } else if (isFunction(then$$1)) {\n      handleForeignThenable(promise, maybeThenable, then$$1);\n    } else {\n      fulfill(promise, maybeThenable);\n    }\n  }\n}\n\nfunction resolve(promise, value) {\n  if (promise === value) {\n    reject(promise, selfFulfillment());\n  } else if (objectOrFunction(value)) {\n    handleMaybeThenable(promise, value, getThen(value));\n  } else {\n    fulfill(promise, value);\n  }\n}\n\nfunction publishRejection(promise) {\n  if (promise._onerror) {\n    promise._onerror(promise._result);\n  }\n\n  publish(promise);\n}\n\nfunction fulfill(promise, value) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n\n  promise._result = value;\n  promise._state = FULFILLED;\n\n  if (promise._subscribers.length !== 0) {\n    asap(publish, promise);\n  }\n}\n\nfunction reject(promise, reason) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n  promise._state = REJECTED;\n  promise._result = reason;\n\n  asap(publishRejection, promise);\n}\n\nfunction subscribe(parent, child, onFulfillment, onRejection) {\n  var _subscribers = parent._subscribers;\n  var length = _subscribers.length;\n\n\n  parent._onerror = null;\n\n  _subscribers[length] = child;\n  _subscribers[length + FULFILLED] = onFulfillment;\n  _subscribers[length + REJECTED] = onRejection;\n\n  if (length === 0 && parent._state) {\n    asap(publish, parent);\n  }\n}\n\nfunction publish(promise) {\n  var subscribers = promise._subscribers;\n  var settled = promise._state;\n\n  if (subscribers.length === 0) {\n    return;\n  }\n\n  var child = void 0,\n      callback = void 0,\n      detail = promise._result;\n\n  for (var i = 0; i < subscribers.length; i += 3) {\n    child = subscribers[i];\n    callback = subscribers[i + settled];\n\n    if (child) {\n      invokeCallback(settled, child, callback, detail);\n    } else {\n      callback(detail);\n    }\n  }\n\n  promise._subscribers.length = 0;\n}\n\nfunction tryCatch(callback, detail) {\n  try {\n    return callback(detail);\n  } catch (e) {\n    TRY_CATCH_ERROR.error = e;\n    return TRY_CATCH_ERROR;\n  }\n}\n\nfunction invokeCallback(settled, promise, callback, detail) {\n  var hasCallback = isFunction(callback),\n      value = void 0,\n      error = void 0,\n      succeeded = void 0,\n      failed = void 0;\n\n  if (hasCallback) {\n    value = tryCatch(callback, detail);\n\n    if (value === TRY_CATCH_ERROR) {\n      failed = true;\n      error = value.error;\n      value.error = null;\n    } else {\n      succeeded = true;\n    }\n\n    if (promise === value) {\n      reject(promise, cannotReturnOwn());\n      return;\n    }\n  } else {\n    value = detail;\n    succeeded = true;\n  }\n\n  if (promise._state !== PENDING) {\n    // noop\n  } else if (hasCallback && succeeded) {\n    resolve(promise, value);\n  } else if (failed) {\n    reject(promise, error);\n  } else if (settled === FULFILLED) {\n    fulfill(promise, value);\n  } else if (settled === REJECTED) {\n    reject(promise, value);\n  }\n}\n\nfunction initializePromise(promise, resolver) {\n  try {\n    resolver(function resolvePromise(value) {\n      resolve(promise, value);\n    }, function rejectPromise(reason) {\n      reject(promise, reason);\n    });\n  } catch (e) {\n    reject(promise, e);\n  }\n}\n\nvar id = 0;\nfunction nextId() {\n  return id++;\n}\n\nfunction makePromise(promise) {\n  promise[PROMISE_ID] = id++;\n  promise._state = undefined;\n  promise._result = undefined;\n  promise._subscribers = [];\n}\n\nfunction validationError() {\n  return new Error('Array Methods must be provided an Array');\n}\n\nvar Enumerator = function () {\n  function Enumerator(Constructor, input) {\n    this._instanceConstructor = Constructor;\n    this.promise = new Constructor(noop);\n\n    if (!this.promise[PROMISE_ID]) {\n      makePromise(this.promise);\n    }\n\n    if (isArray(input)) {\n      this.length = input.length;\n      this._remaining = input.length;\n\n      this._result = new Array(this.length);\n\n      if (this.length === 0) {\n        fulfill(this.promise, this._result);\n      } else {\n        this.length = this.length || 0;\n        this._enumerate(input);\n        if (this._remaining === 0) {\n          fulfill(this.promise, this._result);\n        }\n      }\n    } else {\n      reject(this.promise, validationError());\n    }\n  }\n\n  Enumerator.prototype._enumerate = function _enumerate(input) {\n    for (var i = 0; this._state === PENDING && i < input.length; i++) {\n      this._eachEntry(input[i], i);\n    }\n  };\n\n  Enumerator.prototype._eachEntry = function _eachEntry(entry, i) {\n    var c = this._instanceConstructor;\n    var resolve$$1 = c.resolve;\n\n\n    if (resolve$$1 === resolve$1) {\n      var _then = getThen(entry);\n\n      if (_then === then && entry._state !== PENDING) {\n        this._settledAt(entry._state, i, entry._result);\n      } else if (typeof _then !== 'function') {\n        this._remaining--;\n        this._result[i] = entry;\n      } else if (c === Promise$1) {\n        var promise = new c(noop);\n        handleMaybeThenable(promise, entry, _then);\n        this._willSettleAt(promise, i);\n      } else {\n        this._willSettleAt(new c(function (resolve$$1) {\n          return resolve$$1(entry);\n        }), i);\n      }\n    } else {\n      this._willSettleAt(resolve$$1(entry), i);\n    }\n  };\n\n  Enumerator.prototype._settledAt = function _settledAt(state, i, value) {\n    var promise = this.promise;\n\n\n    if (promise._state === PENDING) {\n      this._remaining--;\n\n      if (state === REJECTED) {\n        reject(promise, value);\n      } else {\n        this._result[i] = value;\n      }\n    }\n\n    if (this._remaining === 0) {\n      fulfill(promise, this._result);\n    }\n  };\n\n  Enumerator.prototype._willSettleAt = function _willSettleAt(promise, i) {\n    var enumerator = this;\n\n    subscribe(promise, undefined, function (value) {\n      return enumerator._settledAt(FULFILLED, i, value);\n    }, function (reason) {\n      return enumerator._settledAt(REJECTED, i, reason);\n    });\n  };\n\n  return Enumerator;\n}();\n\n/**\n  `Promise.all` accepts an array of promises, and returns a new promise which\n  is fulfilled with an array of fulfillment values for the passed promises, or\n  rejected with the reason of the first passed promise to be rejected. It casts all\n  elements of the passed iterable to promises as it runs this algorithm.\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = resolve(2);\n  let promise3 = resolve(3);\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // The array here would be [ 1, 2, 3 ];\n  });\n  ```\n\n  If any of the `promises` given to `all` are rejected, the first promise\n  that is rejected will be given as an argument to the returned promises's\n  rejection handler. For example:\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = reject(new Error(\"2\"));\n  let promise3 = reject(new Error(\"3\"));\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // Code here never runs because there are rejected promises!\n  }, function(error) {\n    // error.message === \"2\"\n  });\n  ```\n\n  @method all\n  @static\n  @param {Array} entries array of promises\n  @param {String} label optional string for labeling the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled when all `promises` have been\n  fulfilled, or rejected if any of them become rejected.\n  @static\n*/\nfunction all(entries) {\n  return new Enumerator(this, entries).promise;\n}\n\n/**\n  `Promise.race` returns a new promise which is settled in the same way as the\n  first passed promise to settle.\n\n  Example:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 2');\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // result === 'promise 2' because it was resolved before promise1\n    // was resolved.\n  });\n  ```\n\n  `Promise.race` is deterministic in that only the state of the first\n  settled promise matters. For example, even if other promises given to the\n  `promises` array argument are resolved, but the first settled promise has\n  become rejected before the other promises became fulfilled, the returned\n  promise will become rejected:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      reject(new Error('promise 2'));\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // Code here never runs\n  }, function(reason){\n    // reason.message === 'promise 2' because promise 2 became rejected before\n    // promise 1 became fulfilled\n  });\n  ```\n\n  An example real-world use case is implementing timeouts:\n\n  ```javascript\n  Promise.race([ajax('foo.json'), timeout(5000)])\n  ```\n\n  @method race\n  @static\n  @param {Array} promises array of promises to observe\n  Useful for tooling.\n  @return {Promise} a promise which settles in the same way as the first passed\n  promise to settle.\n*/\nfunction race(entries) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (!isArray(entries)) {\n    return new Constructor(function (_, reject) {\n      return reject(new TypeError('You must pass an array to race.'));\n    });\n  } else {\n    return new Constructor(function (resolve, reject) {\n      var length = entries.length;\n      for (var i = 0; i < length; i++) {\n        Constructor.resolve(entries[i]).then(resolve, reject);\n      }\n    });\n  }\n}\n\n/**\n  `Promise.reject` returns a promise rejected with the passed `reason`.\n  It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    reject(new Error('WHOOPS'));\n  });\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.reject(new Error('WHOOPS'));\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  @method reject\n  @static\n  @param {Any} reason value that the returned promise will be rejected with.\n  Useful for tooling.\n  @return {Promise} a promise rejected with the given `reason`.\n*/\nfunction reject$1(reason) {\n  /*jshint validthis:true */\n  var Constructor = this;\n  var promise = new Constructor(noop);\n  reject(promise, reason);\n  return promise;\n}\n\nfunction needsResolver() {\n  throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n}\n\nfunction needsNew() {\n  throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n}\n\n/**\n  Promise objects represent the eventual result of an asynchronous operation. The\n  primary way of interacting with a promise is through its `then` method, which\n  registers callbacks to receive either a promise's eventual value or the reason\n  why the promise cannot be fulfilled.\n\n  Terminology\n  -----------\n\n  - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\n  - `thenable` is an object or function that defines a `then` method.\n  - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\n  - `exception` is a value that is thrown using the throw statement.\n  - `reason` is a value that indicates why a promise was rejected.\n  - `settled` the final resting state of a promise, fulfilled or rejected.\n\n  A promise can be in one of three states: pending, fulfilled, or rejected.\n\n  Promises that are fulfilled have a fulfillment value and are in the fulfilled\n  state.  Promises that are rejected have a rejection reason and are in the\n  rejected state.  A fulfillment value is never a thenable.\n\n  Promises can also be said to *resolve* a value.  If this value is also a\n  promise, then the original promise's settled state will match the value's\n  settled state.  So a promise that *resolves* a promise that rejects will\n  itself reject, and a promise that *resolves* a promise that fulfills will\n  itself fulfill.\n\n\n  Basic Usage:\n  ------------\n\n  ```js\n  let promise = new Promise(function(resolve, reject) {\n    // on success\n    resolve(value);\n\n    // on failure\n    reject(reason);\n  });\n\n  promise.then(function(value) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Advanced Usage:\n  ---------------\n\n  Promises shine when abstracting away asynchronous interactions such as\n  `XMLHttpRequest`s.\n\n  ```js\n  function getJSON(url) {\n    return new Promise(function(resolve, reject){\n      let xhr = new XMLHttpRequest();\n\n      xhr.open('GET', url);\n      xhr.onreadystatechange = handler;\n      xhr.responseType = 'json';\n      xhr.setRequestHeader('Accept', 'application/json');\n      xhr.send();\n\n      function handler() {\n        if (this.readyState === this.DONE) {\n          if (this.status === 200) {\n            resolve(this.response);\n          } else {\n            reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\n          }\n        }\n      };\n    });\n  }\n\n  getJSON('/posts.json').then(function(json) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Unlike callbacks, promises are great composable primitives.\n\n  ```js\n  Promise.all([\n    getJSON('/posts'),\n    getJSON('/comments')\n  ]).then(function(values){\n    values[0] // => postsJSON\n    values[1] // => commentsJSON\n\n    return values;\n  });\n  ```\n\n  @class Promise\n  @param {Function} resolver\n  Useful for tooling.\n  @constructor\n*/\n\nvar Promise$1 = function () {\n  function Promise(resolver) {\n    this[PROMISE_ID] = nextId();\n    this._result = this._state = undefined;\n    this._subscribers = [];\n\n    if (noop !== resolver) {\n      typeof resolver !== 'function' && needsResolver();\n      this instanceof Promise ? initializePromise(this, resolver) : needsNew();\n    }\n  }\n\n  /**\n  The primary way of interacting with a promise is through its `then` method,\n  which registers callbacks to receive either a promise's eventual value or the\n  reason why the promise cannot be fulfilled.\n   ```js\n  findUser().then(function(user){\n    // user is available\n  }, function(reason){\n    // user is unavailable, and you are given the reason why\n  });\n  ```\n   Chaining\n  --------\n   The return value of `then` is itself a promise.  This second, 'downstream'\n  promise is resolved with the return value of the first promise's fulfillment\n  or rejection handler, or rejected if the handler throws an exception.\n   ```js\n  findUser().then(function (user) {\n    return user.name;\n  }, function (reason) {\n    return 'default name';\n  }).then(function (userName) {\n    // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\n    // will be `'default name'`\n  });\n   findUser().then(function (user) {\n    throw new Error('Found user, but still unhappy');\n  }, function (reason) {\n    throw new Error('`findUser` rejected and we're unhappy');\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\n    // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.\n  });\n  ```\n  If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\n   ```js\n  findUser().then(function (user) {\n    throw new PedagogicalException('Upstream error');\n  }).then(function (value) {\n    // never reached\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // The `PedgagocialException` is propagated all the way down to here\n  });\n  ```\n   Assimilation\n  ------------\n   Sometimes the value you want to propagate to a downstream promise can only be\n  retrieved asynchronously. This can be achieved by returning a promise in the\n  fulfillment or rejection handler. The downstream promise will then be pending\n  until the returned promise is settled. This is called *assimilation*.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // The user's comments are now available\n  });\n  ```\n   If the assimliated promise rejects, then the downstream promise will also reject.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // If `findCommentsByAuthor` fulfills, we'll have the value here\n  }, function (reason) {\n    // If `findCommentsByAuthor` rejects, we'll have the reason here\n  });\n  ```\n   Simple Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let result;\n   try {\n    result = findResult();\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n  findResult(function(result, err){\n    if (err) {\n      // failure\n    } else {\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findResult().then(function(result){\n    // success\n  }, function(reason){\n    // failure\n  });\n  ```\n   Advanced Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let author, books;\n   try {\n    author = findAuthor();\n    books  = findBooksByAuthor(author);\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n   function foundBooks(books) {\n   }\n   function failure(reason) {\n   }\n   findAuthor(function(author, err){\n    if (err) {\n      failure(err);\n      // failure\n    } else {\n      try {\n        findBoooksByAuthor(author, function(books, err) {\n          if (err) {\n            failure(err);\n          } else {\n            try {\n              foundBooks(books);\n            } catch(reason) {\n              failure(reason);\n            }\n          }\n        });\n      } catch(error) {\n        failure(err);\n      }\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findAuthor().\n    then(findBooksByAuthor).\n    then(function(books){\n      // found books\n  }).catch(function(reason){\n    // something went wrong\n  });\n  ```\n   @method then\n  @param {Function} onFulfilled\n  @param {Function} onRejected\n  Useful for tooling.\n  @return {Promise}\n  */\n\n  /**\n  `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\n  as the catch block of a try/catch statement.\n  ```js\n  function findAuthor(){\n  throw new Error('couldn't find that author');\n  }\n  // synchronous\n  try {\n  findAuthor();\n  } catch(reason) {\n  // something went wrong\n  }\n  // async with promises\n  findAuthor().catch(function(reason){\n  // something went wrong\n  });\n  ```\n  @method catch\n  @param {Function} onRejection\n  Useful for tooling.\n  @return {Promise}\n  */\n\n\n  Promise.prototype.catch = function _catch(onRejection) {\n    return this.then(null, onRejection);\n  };\n\n  /**\n    `finally` will be invoked regardless of the promise's fate just as native\n    try/catch/finally behaves\n  \n    Synchronous example:\n  \n    ```js\n    findAuthor() {\n      if (Math.random() > 0.5) {\n        throw new Error();\n      }\n      return new Author();\n    }\n  \n    try {\n      return findAuthor(); // succeed or fail\n    } catch(error) {\n      return findOtherAuther();\n    } finally {\n      // always runs\n      // doesn't affect the return value\n    }\n    ```\n  \n    Asynchronous example:\n  \n    ```js\n    findAuthor().catch(function(reason){\n      return findOtherAuther();\n    }).finally(function(){\n      // author was either found, or not\n    });\n    ```\n  \n    @method finally\n    @param {Function} callback\n    @return {Promise}\n  */\n\n\n  Promise.prototype.finally = function _finally(callback) {\n    var promise = this;\n    var constructor = promise.constructor;\n\n    if (isFunction(callback)) {\n      return promise.then(function (value) {\n        return constructor.resolve(callback()).then(function () {\n          return value;\n        });\n      }, function (reason) {\n        return constructor.resolve(callback()).then(function () {\n          throw reason;\n        });\n      });\n    }\n\n    return promise.then(callback, callback);\n  };\n\n  return Promise;\n}();\n\nPromise$1.prototype.then = then;\nPromise$1.all = all;\nPromise$1.race = race;\nPromise$1.resolve = resolve$1;\nPromise$1.reject = reject$1;\nPromise$1._setScheduler = setScheduler;\nPromise$1._setAsap = setAsap;\nPromise$1._asap = asap;\n\n/*global self*/\nfunction polyfill() {\n  var local = void 0;\n\n  if (typeof global !== 'undefined') {\n    local = global;\n  } else if (typeof self !== 'undefined') {\n    local = self;\n  } else {\n    try {\n      local = Function('return this')();\n    } catch (e) {\n      throw new Error('polyfill failed because global object is unavailable in this environment');\n    }\n  }\n\n  var P = local.Promise;\n\n  if (P) {\n    var promiseToString = null;\n    try {\n      promiseToString = Object.prototype.toString.call(P.resolve());\n    } catch (e) {\n      // silently ignored\n    }\n\n    if (promiseToString === '[object Promise]' && !P.cast) {\n      return;\n    }\n  }\n\n  local.Promise = Promise$1;\n}\n\n// Strange compat..\nPromise$1.polyfill = polyfill;\nPromise$1.Promise = Promise$1;\n\nreturn Promise$1;\n\n})));\n\n\n\n\n\n}).call(this,_dereq_('_process'),typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n\n},{\"_process\":3}],2:[function(_dereq_,module,exports){\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n},{}],3:[function(_dereq_,module,exports){\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n},{}],4:[function(_dereq_,module,exports){\nvar bundleFn = arguments[3];\nvar sources = arguments[4];\nvar cache = arguments[5];\n\nvar stringify = JSON.stringify;\n\nmodule.exports = function (fn, options) {\n    var wkey;\n    var cacheKeys = Object.keys(cache);\n\n    for (var i = 0, l = cacheKeys.length; i < l; i++) {\n        var key = cacheKeys[i];\n        var exp = cache[key].exports;\n        // Using babel as a transpiler to use esmodule, the export will always\n        // be an object with the default export as a property of it. To ensure\n        // the existing api and babel esmodule exports are both supported we\n        // check for both\n        if (exp === fn || exp && exp.default === fn) {\n            wkey = key;\n            break;\n        }\n    }\n\n    if (!wkey) {\n        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n        var wcache = {};\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\n            var key = cacheKeys[i];\n            wcache[key] = key;\n        }\n        sources[wkey] = [\n            'function(require,module,exports){' + fn + '(self); }',\n            wcache\n        ];\n    }\n    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n\n    var scache = {}; scache[wkey] = wkey;\n    sources[skey] = [\n        'function(require,module,exports){' +\n            // try to call default if defined to also support babel esmodule exports\n            'var f = require(' + stringify(wkey) + ');' +\n            '(f.default ? f.default : f)(self);' +\n        '}',\n        scache\n    ];\n\n    var workerSources = {};\n    resolveSources(skey);\n\n    function resolveSources(key) {\n        workerSources[key] = true;\n\n        for (var depPath in sources[key][1]) {\n            var depKey = sources[key][1][depPath];\n            if (!workerSources[depKey]) {\n                resolveSources(depKey);\n            }\n        }\n    }\n\n    var src = '(' + bundleFn + ')({'\n        + Object.keys(workerSources).map(function (key) {\n            return stringify(key) + ':['\n                + sources[key][0]\n                + ',' + stringify(sources[key][1]) + ']'\n            ;\n        }).join(',')\n        + '},{},[' + stringify(skey) + '])'\n    ;\n\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    var blob = new Blob([src], { type: 'text/javascript' });\n    if (options && options.bare) { return blob; }\n    var workerUrl = URL.createObjectURL(blob);\n    var worker = new Worker(workerUrl);\n    worker.objectURL = workerUrl;\n    return worker;\n};\n\n},{}],5:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.createDefaultConfig = createDefaultConfig;\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar defaultConfig = exports.defaultConfig = {\n    enableWorker: false,\n    enableStashBuffer: true,\n    stashInitialSize: undefined,\n\n    isLive: false,\n\n    lazyLoad: true,\n    lazyLoadMaxDuration: 3 * 60,\n    lazyLoadRecoverDuration: 30,\n    deferLoadAfterSourceOpen: true,\n\n    // autoCleanupSourceBuffer: default as false, leave unspecified\n    autoCleanupMaxBackwardDuration: 3 * 60,\n    autoCleanupMinBackwardDuration: 2 * 60,\n\n    statisticsInfoReportInterval: 600,\n\n    fixAudioTimestampGap: true,\n\n    accurateSeek: false,\n    seekType: 'range', // [range, param, custom]\n    seekParamStart: 'bstart',\n    seekParamEnd: 'bend',\n    rangeLoadZeroStart: false,\n    customSeekHandler: undefined,\n    reuseRedirectedURL: false,\n    // referrerPolicy: leave as unspecified\n\n    headers: undefined,\n    customLoader: undefined\n};\n\nfunction createDefaultConfig() {\n    return Object.assign({}, defaultConfig);\n}\n\n},{}],6:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _ioController = _dereq_('../io/io-controller.js');\n\nvar _ioController2 = _interopRequireDefault(_ioController);\n\nvar _config = _dereq_('../config.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Features = function () {\n    function Features() {\n        _classCallCheck(this, Features);\n    }\n\n    _createClass(Features, null, [{\n        key: 'supportMSEH264Playback',\n        value: function supportMSEH264Playback() {\n            return window.MediaSource && window.MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"');\n        }\n    }, {\n        key: 'supportNetworkStreamIO',\n        value: function supportNetworkStreamIO() {\n            var ioctl = new _ioController2.default({}, (0, _config.createDefaultConfig)());\n            var loaderType = ioctl.loaderType;\n            ioctl.destroy();\n            return loaderType == 'fetch-stream-loader' || loaderType == 'xhr-moz-chunked-loader';\n        }\n    }, {\n        key: 'getNetworkLoaderTypeName',\n        value: function getNetworkLoaderTypeName() {\n            var ioctl = new _ioController2.default({}, (0, _config.createDefaultConfig)());\n            var loaderType = ioctl.loaderType;\n            ioctl.destroy();\n            return loaderType;\n        }\n    }, {\n        key: 'supportNativeMediaPlayback',\n        value: function supportNativeMediaPlayback(mimeType) {\n            if (Features.videoElement == undefined) {\n                Features.videoElement = window.document.createElement('video');\n            }\n            var canPlay = Features.videoElement.canPlayType(mimeType);\n            return canPlay === 'probably' || canPlay == 'maybe';\n        }\n    }, {\n        key: 'getFeatureList',\n        value: function getFeatureList() {\n            var features = {\n                mseFlvPlayback: false,\n                mseLiveFlvPlayback: false,\n                networkStreamIO: false,\n                networkLoaderName: '',\n                nativeMP4H264Playback: false,\n                nativeWebmVP8Playback: false,\n                nativeWebmVP9Playback: false\n            };\n\n            features.mseFlvPlayback = Features.supportMSEH264Playback();\n            features.networkStreamIO = Features.supportNetworkStreamIO();\n            features.networkLoaderName = Features.getNetworkLoaderTypeName();\n            features.mseLiveFlvPlayback = features.mseFlvPlayback && features.networkStreamIO;\n            features.nativeMP4H264Playback = Features.supportNativeMediaPlayback('video/mp4; codecs=\"avc1.42001E, mp4a.40.2\"');\n            features.nativeWebmVP8Playback = Features.supportNativeMediaPlayback('video/webm; codecs=\"vp8.0, vorbis\"');\n            features.nativeWebmVP9Playback = Features.supportNativeMediaPlayback('video/webm; codecs=\"vp9\"');\n\n            return features;\n        }\n    }]);\n\n    return Features;\n}();\n\nexports.default = Features;\n\n},{\"../config.js\":5,\"../io/io-controller.js\":23}],7:[function(_dereq_,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar MediaInfo = function () {\n    function MediaInfo() {\n        _classCallCheck(this, MediaInfo);\n\n        this.mimeType = null;\n        this.duration = null;\n\n        this.hasAudio = null;\n        this.hasVideo = null;\n        this.audioCodec = null;\n        this.videoCodec = null;\n        this.audioDataRate = null;\n        this.videoDataRate = null;\n\n        this.audioSampleRate = null;\n        this.audioChannelCount = null;\n\n        this.width = null;\n        this.height = null;\n        this.fps = null;\n        this.profile = null;\n        this.level = null;\n        this.refFrames = null;\n        this.chromaFormat = null;\n        this.sarNum = null;\n        this.sarDen = null;\n\n        this.metadata = null;\n        this.segments = null; // MediaInfo[]\n        this.segmentCount = null;\n        this.hasKeyframesIndex = null;\n        this.keyframesIndex = null;\n    }\n\n    _createClass(MediaInfo, [{\n        key: \"isComplete\",\n        value: function isComplete() {\n            var audioInfoComplete = this.hasAudio === false || this.hasAudio === true && this.audioCodec != null && this.audioSampleRate != null && this.audioChannelCount != null;\n\n            var videoInfoComplete = this.hasVideo === false || this.hasVideo === true && this.videoCodec != null && this.width != null && this.height != null && this.fps != null && this.profile != null && this.level != null && this.refFrames != null && this.chromaFormat != null && this.sarNum != null && this.sarDen != null;\n\n            // keyframesIndex may not be present\n            return this.mimeType != null && this.duration != null && this.metadata != null && this.hasKeyframesIndex != null && audioInfoComplete && videoInfoComplete;\n        }\n    }, {\n        key: \"isSeekable\",\n        value: function isSeekable() {\n            return this.hasKeyframesIndex === true;\n        }\n    }, {\n        key: \"getNearestKeyframe\",\n        value: function getNearestKeyframe(milliseconds) {\n            if (this.keyframesIndex == null) {\n                return null;\n            }\n\n            var table = this.keyframesIndex;\n            var keyframeIdx = this._search(table.times, milliseconds);\n\n            return {\n                index: keyframeIdx,\n                milliseconds: table.times[keyframeIdx],\n                fileposition: table.filepositions[keyframeIdx]\n            };\n        }\n    }, {\n        key: \"_search\",\n        value: function _search(list, value) {\n            var idx = 0;\n\n            var last = list.length - 1;\n            var mid = 0;\n            var lbound = 0;\n            var ubound = last;\n\n            if (value < list[0]) {\n                idx = 0;\n                lbound = ubound + 1; // skip search\n            }\n\n            while (lbound <= ubound) {\n                mid = lbound + Math.floor((ubound - lbound) / 2);\n                if (mid === last || value >= list[mid] && value < list[mid + 1]) {\n                    idx = mid;\n                    break;\n                } else if (list[mid] < value) {\n                    lbound = mid + 1;\n                } else {\n                    ubound = mid - 1;\n                }\n            }\n\n            return idx;\n        }\n    }]);\n\n    return MediaInfo;\n}();\n\nexports.default = MediaInfo;\n\n},{}],8:[function(_dereq_,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n// Represents an media sample (audio / video)\nvar SampleInfo = exports.SampleInfo = function SampleInfo(dts, pts, duration, originalDts, isSync) {\n    _classCallCheck(this, SampleInfo);\n\n    this.dts = dts;\n    this.pts = pts;\n    this.duration = duration;\n    this.originalDts = originalDts;\n    this.isSyncPoint = isSync;\n    this.fileposition = null;\n};\n\n// Media Segment concept is defined in Media Source Extensions spec.\n// Particularly in ISO BMFF format, an Media Segment contains a moof box followed by a mdat box.\n\n\nvar MediaSegmentInfo = exports.MediaSegmentInfo = function () {\n    function MediaSegmentInfo() {\n        _classCallCheck(this, MediaSegmentInfo);\n\n        this.beginDts = 0;\n        this.endDts = 0;\n        this.beginPts = 0;\n        this.endPts = 0;\n        this.originalBeginDts = 0;\n        this.originalEndDts = 0;\n        this.syncPoints = []; // SampleInfo[n], for video IDR frames only\n        this.firstSample = null; // SampleInfo\n        this.lastSample = null; // SampleInfo\n    }\n\n    _createClass(MediaSegmentInfo, [{\n        key: \"appendSyncPoint\",\n        value: function appendSyncPoint(sampleInfo) {\n            // also called Random Access Point\n            sampleInfo.isSyncPoint = true;\n            this.syncPoints.push(sampleInfo);\n        }\n    }]);\n\n    return MediaSegmentInfo;\n}();\n\n// Ordered list for recording video IDR frames, sorted by originalDts\n\n\nvar IDRSampleList = exports.IDRSampleList = function () {\n    function IDRSampleList() {\n        _classCallCheck(this, IDRSampleList);\n\n        this._list = [];\n    }\n\n    _createClass(IDRSampleList, [{\n        key: \"clear\",\n        value: function clear() {\n            this._list = [];\n        }\n    }, {\n        key: \"appendArray\",\n        value: function appendArray(syncPoints) {\n            var list = this._list;\n\n            if (syncPoints.length === 0) {\n                return;\n            }\n\n            if (list.length > 0 && syncPoints[0].originalDts < list[list.length - 1].originalDts) {\n                this.clear();\n            }\n\n            Array.prototype.push.apply(list, syncPoints);\n        }\n    }, {\n        key: \"getLastSyncPointBeforeDts\",\n        value: function getLastSyncPointBeforeDts(dts) {\n            if (this._list.length == 0) {\n                return null;\n            }\n\n            var list = this._list;\n            var idx = 0;\n            var last = list.length - 1;\n            var mid = 0;\n            var lbound = 0;\n            var ubound = last;\n\n            if (dts < list[0].dts) {\n                idx = 0;\n                lbound = ubound + 1;\n            }\n\n            while (lbound <= ubound) {\n                mid = lbound + Math.floor((ubound - lbound) / 2);\n                if (mid === last || dts >= list[mid].dts && dts < list[mid + 1].dts) {\n                    idx = mid;\n                    break;\n                } else if (list[mid].dts < dts) {\n                    lbound = mid + 1;\n                } else {\n                    ubound = mid - 1;\n                }\n            }\n            return this._list[idx];\n        }\n    }]);\n\n    return IDRSampleList;\n}();\n\n// Data structure for recording information of media segments in single track.\n\n\nvar MediaSegmentInfoList = exports.MediaSegmentInfoList = function () {\n    function MediaSegmentInfoList(type) {\n        _classCallCheck(this, MediaSegmentInfoList);\n\n        this._type = type;\n        this._list = [];\n        this._lastAppendLocation = -1; // cached last insert location\n    }\n\n    _createClass(MediaSegmentInfoList, [{\n        key: \"isEmpty\",\n        value: function isEmpty() {\n            return this._list.length === 0;\n        }\n    }, {\n        key: \"clear\",\n        value: function clear() {\n            this._list = [];\n            this._lastAppendLocation = -1;\n        }\n    }, {\n        key: \"_searchNearestSegmentBefore\",\n        value: function _searchNearestSegmentBefore(originalBeginDts) {\n            var list = this._list;\n            if (list.length === 0) {\n                return -2;\n            }\n            var last = list.length - 1;\n            var mid = 0;\n            var lbound = 0;\n            var ubound = last;\n\n            var idx = 0;\n\n            if (originalBeginDts < list[0].originalBeginDts) {\n                idx = -1;\n                return idx;\n            }\n\n            while (lbound <= ubound) {\n                mid = lbound + Math.floor((ubound - lbound) / 2);\n                if (mid === last || originalBeginDts > list[mid].lastSample.originalDts && originalBeginDts < list[mid + 1].originalBeginDts) {\n                    idx = mid;\n                    break;\n                } else if (list[mid].originalBeginDts < originalBeginDts) {\n                    lbound = mid + 1;\n                } else {\n                    ubound = mid - 1;\n                }\n            }\n            return idx;\n        }\n    }, {\n        key: \"_searchNearestSegmentAfter\",\n        value: function _searchNearestSegmentAfter(originalBeginDts) {\n            return this._searchNearestSegmentBefore(originalBeginDts) + 1;\n        }\n    }, {\n        key: \"append\",\n        value: function append(mediaSegmentInfo) {\n            var list = this._list;\n            var msi = mediaSegmentInfo;\n            var lastAppendIdx = this._lastAppendLocation;\n            var insertIdx = 0;\n\n            if (lastAppendIdx !== -1 && lastAppendIdx < list.length && msi.originalBeginDts >= list[lastAppendIdx].lastSample.originalDts && (lastAppendIdx === list.length - 1 || lastAppendIdx < list.length - 1 && msi.originalBeginDts < list[lastAppendIdx + 1].originalBeginDts)) {\n                insertIdx = lastAppendIdx + 1; // use cached location idx\n            } else {\n                if (list.length > 0) {\n                    insertIdx = this._searchNearestSegmentBefore(msi.originalBeginDts) + 1;\n                }\n            }\n\n            this._lastAppendLocation = insertIdx;\n            this._list.splice(insertIdx, 0, msi);\n        }\n    }, {\n        key: \"getLastSegmentBefore\",\n        value: function getLastSegmentBefore(originalBeginDts) {\n            var idx = this._searchNearestSegmentBefore(originalBeginDts);\n            if (idx >= 0) {\n                return this._list[idx];\n            } else {\n                // -1\n                return null;\n            }\n        }\n    }, {\n        key: \"getLastSampleBefore\",\n        value: function getLastSampleBefore(originalBeginDts) {\n            var segment = this.getLastSegmentBefore(originalBeginDts);\n            if (segment != null) {\n                return segment.lastSample;\n            } else {\n                return null;\n            }\n        }\n    }, {\n        key: \"getLastSyncPointBefore\",\n        value: function getLastSyncPointBefore(originalBeginDts) {\n            var segmentIdx = this._searchNearestSegmentBefore(originalBeginDts);\n            var syncPoints = this._list[segmentIdx].syncPoints;\n            while (syncPoints.length === 0 && segmentIdx > 0) {\n                segmentIdx--;\n                syncPoints = this._list[segmentIdx].syncPoints;\n            }\n            if (syncPoints.length > 0) {\n                return syncPoints[syncPoints.length - 1];\n            } else {\n                return null;\n            }\n        }\n    }, {\n        key: \"type\",\n        get: function get() {\n            return this._type;\n        }\n    }, {\n        key: \"length\",\n        get: function get() {\n            return this._list.length;\n        }\n    }]);\n\n    return MediaSegmentInfoList;\n}();\n\n},{}],9:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _browser = _dereq_('../utils/browser.js');\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _mseEvents = _dereq_('./mse-events.js');\n\nvar _mseEvents2 = _interopRequireDefault(_mseEvents);\n\nvar _mediaSegmentInfo = _dereq_('./media-segment-info.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Media Source Extensions controller\nvar MSEController = function () {\n    function MSEController(config) {\n        _classCallCheck(this, MSEController);\n\n        this.TAG = 'MSEController';\n\n        this._config = config;\n        this._emitter = new _events2.default();\n\n        if (this._config.isLive && this._config.autoCleanupSourceBuffer == undefined) {\n            // For live stream, do auto cleanup by default\n            this._config.autoCleanupSourceBuffer = true;\n        }\n\n        this.e = {\n            onSourceOpen: this._onSourceOpen.bind(this),\n            onSourceEnded: this._onSourceEnded.bind(this),\n            onSourceClose: this._onSourceClose.bind(this),\n            onSourceBufferError: this._onSourceBufferError.bind(this),\n            onSourceBufferUpdateEnd: this._onSourceBufferUpdateEnd.bind(this)\n        };\n\n        this._mediaSource = null;\n        this._mediaSourceObjectURL = null;\n        this._mediaElement = null;\n\n        this._isBufferFull = false;\n        this._hasPendingEos = false;\n\n        this._requireSetMediaDuration = false;\n        this._pendingMediaDuration = 0;\n\n        this._pendingSourceBufferInit = [];\n        this._mimeTypes = {\n            video: null,\n            audio: null\n        };\n        this._sourceBuffers = {\n            video: null,\n            audio: null\n        };\n        this._lastInitSegments = {\n            video: null,\n            audio: null\n        };\n        this._pendingSegments = {\n            video: [],\n            audio: []\n        };\n        this._pendingRemoveRanges = {\n            video: [],\n            audio: []\n        };\n        this._idrList = new _mediaSegmentInfo.IDRSampleList();\n    }\n\n    _createClass(MSEController, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._mediaElement || this._mediaSource) {\n                this.detachMediaElement();\n            }\n            this.e = null;\n            this._emitter.removeAllListeners();\n            this._emitter = null;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, listener) {\n            this._emitter.addListener(event, listener);\n        }\n    }, {\n        key: 'off',\n        value: function off(event, listener) {\n            this._emitter.removeListener(event, listener);\n        }\n    }, {\n        key: 'attachMediaElement',\n        value: function attachMediaElement(mediaElement) {\n            if (this._mediaSource) {\n                throw new _exception.IllegalStateException('MediaSource has been attached to an HTMLMediaElement!');\n            }\n            var ms = this._mediaSource = new window.MediaSource();\n            ms.addEventListener('sourceopen', this.e.onSourceOpen);\n            ms.addEventListener('sourceended', this.e.onSourceEnded);\n            ms.addEventListener('sourceclose', this.e.onSourceClose);\n\n            this._mediaElement = mediaElement;\n            this._mediaSourceObjectURL = window.URL.createObjectURL(this._mediaSource);\n            mediaElement.src = this._mediaSourceObjectURL;\n        }\n    }, {\n        key: 'detachMediaElement',\n        value: function detachMediaElement() {\n            if (this._mediaSource) {\n                var ms = this._mediaSource;\n                for (var type in this._sourceBuffers) {\n                    // pending segments should be discard\n                    var ps = this._pendingSegments[type];\n                    ps.splice(0, ps.length);\n                    this._pendingSegments[type] = null;\n                    this._pendingRemoveRanges[type] = null;\n                    this._lastInitSegments[type] = null;\n\n                    // remove all sourcebuffers\n                    var sb = this._sourceBuffers[type];\n                    if (sb) {\n                        if (ms.readyState !== 'closed') {\n                            // ms edge can throw an error: Unexpected call to method or property access\n                            try {\n                                ms.removeSourceBuffer(sb);\n                            } catch (error) {\n                                _logger2.default.e(this.TAG, error.message);\n                            }\n                            sb.removeEventListener('error', this.e.onSourceBufferError);\n                            sb.removeEventListener('updateend', this.e.onSourceBufferUpdateEnd);\n                        }\n                        this._mimeTypes[type] = null;\n                        this._sourceBuffers[type] = null;\n                    }\n                }\n                if (ms.readyState === 'open') {\n                    try {\n                        ms.endOfStream();\n                    } catch (error) {\n                        _logger2.default.e(this.TAG, error.message);\n                    }\n                }\n                ms.removeEventListener('sourceopen', this.e.onSourceOpen);\n                ms.removeEventListener('sourceended', this.e.onSourceEnded);\n                ms.removeEventListener('sourceclose', this.e.onSourceClose);\n                this._pendingSourceBufferInit = [];\n                this._isBufferFull = false;\n                this._idrList.clear();\n                this._mediaSource = null;\n            }\n\n            if (this._mediaElement) {\n                this._mediaElement.src = '';\n                this._mediaElement.removeAttribute('src');\n                this._mediaElement = null;\n            }\n            if (this._mediaSourceObjectURL) {\n                window.URL.revokeObjectURL(this._mediaSourceObjectURL);\n                this._mediaSourceObjectURL = null;\n            }\n        }\n    }, {\n        key: 'appendInitSegment',\n        value: function appendInitSegment(initSegment, deferred) {\n            if (!this._mediaSource || this._mediaSource.readyState !== 'open') {\n                // sourcebuffer creation requires mediaSource.readyState === 'open'\n                // so we defer the sourcebuffer creation, until sourceopen event triggered\n                this._pendingSourceBufferInit.push(initSegment);\n                // make sure that this InitSegment is in the front of pending segments queue\n                this._pendingSegments[initSegment.type].push(initSegment);\n                return;\n            }\n\n            var is = initSegment;\n            var mimeType = '' + is.container;\n            if (is.codec && is.codec.length > 0) {\n                mimeType += ';codecs=' + is.codec;\n            }\n\n            var firstInitSegment = false;\n\n            _logger2.default.v(this.TAG, 'Received Initialization Segment, mimeType: ' + mimeType);\n            this._lastInitSegments[is.type] = is;\n\n            if (mimeType !== this._mimeTypes[is.type]) {\n                if (!this._mimeTypes[is.type]) {\n                    // empty, first chance create sourcebuffer\n                    firstInitSegment = true;\n                    try {\n                        var sb = this._sourceBuffers[is.type] = this._mediaSource.addSourceBuffer(mimeType);\n                        sb.addEventListener('error', this.e.onSourceBufferError);\n                        sb.addEventListener('updateend', this.e.onSourceBufferUpdateEnd);\n                    } catch (error) {\n                        _logger2.default.e(this.TAG, error.message);\n                        this._emitter.emit(_mseEvents2.default.ERROR, { code: error.code, msg: error.message });\n                        return;\n                    }\n                } else {\n                    _logger2.default.v(this.TAG, 'Notice: ' + is.type + ' mimeType changed, origin: ' + this._mimeTypes[is.type] + ', target: ' + mimeType);\n                }\n                this._mimeTypes[is.type] = mimeType;\n            }\n\n            if (!deferred) {\n                // deferred means this InitSegment has been pushed to pendingSegments queue\n                this._pendingSegments[is.type].push(is);\n            }\n            if (!firstInitSegment) {\n                // append immediately only if init segment in subsequence\n                if (this._sourceBuffers[is.type] && !this._sourceBuffers[is.type].updating) {\n                    this._doAppendSegments();\n                }\n            }\n            if (_browser2.default.safari && is.container === 'audio/mpeg' && is.mediaDuration > 0) {\n                // 'audio/mpeg' track under Safari may cause MediaElement's duration to be NaN\n                // Manually correct MediaSource.duration to make progress bar seekable, and report right duration\n                this._requireSetMediaDuration = true;\n                this._pendingMediaDuration = is.mediaDuration / 1000; // in seconds\n                this._updateMediaSourceDuration();\n            }\n        }\n    }, {\n        key: 'appendMediaSegment',\n        value: function appendMediaSegment(mediaSegment) {\n            var ms = mediaSegment;\n            this._pendingSegments[ms.type].push(ms);\n\n            if (this._config.autoCleanupSourceBuffer && this._needCleanupSourceBuffer()) {\n                this._doCleanupSourceBuffer();\n            }\n\n            var sb = this._sourceBuffers[ms.type];\n            if (sb && !sb.updating && !this._hasPendingRemoveRanges()) {\n                this._doAppendSegments();\n            }\n        }\n    }, {\n        key: 'seek',\n        value: function seek(seconds) {\n            // remove all appended buffers\n            for (var type in this._sourceBuffers) {\n                if (!this._sourceBuffers[type]) {\n                    continue;\n                }\n\n                // abort current buffer append algorithm\n                var sb = this._sourceBuffers[type];\n                if (this._mediaSource.readyState === 'open') {\n                    try {\n                        // If range removal algorithm is running, InvalidStateError will be throwed\n                        // Ignore it.\n                        sb.abort();\n                    } catch (error) {\n                        _logger2.default.e(this.TAG, error.message);\n                    }\n                }\n\n                // IDRList should be clear\n                this._idrList.clear();\n\n                // pending segments should be discard\n                var ps = this._pendingSegments[type];\n                ps.splice(0, ps.length);\n\n                if (this._mediaSource.readyState === 'closed') {\n                    // Parent MediaSource object has been detached from HTMLMediaElement\n                    continue;\n                }\n\n                // record ranges to be remove from SourceBuffer\n                for (var i = 0; i < sb.buffered.length; i++) {\n                    var start = sb.buffered.start(i);\n                    var end = sb.buffered.end(i);\n                    this._pendingRemoveRanges[type].push({ start: start, end: end });\n                }\n\n                // if sb is not updating, let's remove ranges now!\n                if (!sb.updating) {\n                    this._doRemoveRanges();\n                }\n\n                // Safari 10 may get InvalidStateError in the later appendBuffer() after SourceBuffer.remove() call\n                // Internal parser's state may be invalid at this time. Re-append last InitSegment to workaround.\n                // Related issue: https://bugs.webkit.org/show_bug.cgi?id=159230\n                if (_browser2.default.safari) {\n                    var lastInitSegment = this._lastInitSegments[type];\n                    if (lastInitSegment) {\n                        this._pendingSegments[type].push(lastInitSegment);\n                        if (!sb.updating) {\n                            this._doAppendSegments();\n                        }\n                    }\n                }\n            }\n        }\n    }, {\n        key: 'endOfStream',\n        value: function endOfStream() {\n            var ms = this._mediaSource;\n            var sb = this._sourceBuffers;\n            if (!ms || ms.readyState !== 'open') {\n                if (ms && ms.readyState === 'closed' && this._hasPendingSegments()) {\n                    // If MediaSource hasn't turned into open state, and there're pending segments\n                    // Mark pending endOfStream, defer call until all pending segments appended complete\n                    this._hasPendingEos = true;\n                }\n                return;\n            }\n            if (sb.video && sb.video.updating || sb.audio && sb.audio.updating) {\n                // If any sourcebuffer is updating, defer endOfStream operation\n                // See _onSourceBufferUpdateEnd()\n                this._hasPendingEos = true;\n            } else {\n                this._hasPendingEos = false;\n                // Notify media data loading complete\n                // This is helpful for correcting total duration to match last media segment\n                // Otherwise MediaElement's ended event may not be triggered\n                ms.endOfStream();\n            }\n        }\n    }, {\n        key: 'getNearestKeyframe',\n        value: function getNearestKeyframe(dts) {\n            return this._idrList.getLastSyncPointBeforeDts(dts);\n        }\n    }, {\n        key: '_needCleanupSourceBuffer',\n        value: function _needCleanupSourceBuffer() {\n            if (!this._config.autoCleanupSourceBuffer) {\n                return false;\n            }\n\n            var currentTime = this._mediaElement.currentTime;\n\n            for (var type in this._sourceBuffers) {\n                var sb = this._sourceBuffers[type];\n                if (sb) {\n                    var buffered = sb.buffered;\n                    if (buffered.length >= 1) {\n                        if (currentTime - buffered.start(0) >= this._config.autoCleanupMaxBackwardDuration) {\n                            return true;\n                        }\n                    }\n                }\n            }\n\n            return false;\n        }\n    }, {\n        key: '_doCleanupSourceBuffer',\n        value: function _doCleanupSourceBuffer() {\n            var currentTime = this._mediaElement.currentTime;\n\n            for (var type in this._sourceBuffers) {\n                var sb = this._sourceBuffers[type];\n                if (sb) {\n                    var buffered = sb.buffered;\n                    var doRemove = false;\n\n                    for (var i = 0; i < buffered.length; i++) {\n                        var start = buffered.start(i);\n                        var end = buffered.end(i);\n\n                        if (start <= currentTime && currentTime < end + 3) {\n                            // padding 3 seconds\n                            if (currentTime - start >= this._config.autoCleanupMaxBackwardDuration) {\n                                doRemove = true;\n                                var removeEnd = currentTime - this._config.autoCleanupMinBackwardDuration;\n                                this._pendingRemoveRanges[type].push({ start: start, end: removeEnd });\n                            }\n                        } else if (end < currentTime) {\n                            doRemove = true;\n                            this._pendingRemoveRanges[type].push({ start: start, end: end });\n                        }\n                    }\n\n                    if (doRemove && !sb.updating) {\n                        this._doRemoveRanges();\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_updateMediaSourceDuration',\n        value: function _updateMediaSourceDuration() {\n            var sb = this._sourceBuffers;\n            if (this._mediaElement.readyState === 0 || this._mediaSource.readyState !== 'open') {\n                return;\n            }\n            if (sb.video && sb.video.updating || sb.audio && sb.audio.updating) {\n                return;\n            }\n\n            var current = this._mediaSource.duration;\n            var target = this._pendingMediaDuration;\n\n            if (target > 0 && (isNaN(current) || target > current)) {\n                _logger2.default.v(this.TAG, 'Update MediaSource duration from ' + current + ' to ' + target);\n                this._mediaSource.duration = target;\n            }\n\n            this._requireSetMediaDuration = false;\n            this._pendingMediaDuration = 0;\n        }\n    }, {\n        key: '_doRemoveRanges',\n        value: function _doRemoveRanges() {\n            for (var type in this._pendingRemoveRanges) {\n                if (!this._sourceBuffers[type] || this._sourceBuffers[type].updating) {\n                    continue;\n                }\n                var sb = this._sourceBuffers[type];\n                var ranges = this._pendingRemoveRanges[type];\n                while (ranges.length && !sb.updating) {\n                    var range = ranges.shift();\n                    sb.remove(range.start, range.end);\n                }\n            }\n        }\n    }, {\n        key: '_doAppendSegments',\n        value: function _doAppendSegments() {\n            var pendingSegments = this._pendingSegments;\n\n            for (var type in pendingSegments) {\n                if (!this._sourceBuffers[type] || this._sourceBuffers[type].updating) {\n                    continue;\n                }\n\n                if (pendingSegments[type].length > 0) {\n                    var segment = pendingSegments[type].shift();\n\n                    if (segment.timestampOffset) {\n                        // For MPEG audio stream in MSE, if unbuffered-seeking occurred\n                        // We need explicitly set timestampOffset to the desired point in timeline for mpeg SourceBuffer.\n                        var currentOffset = this._sourceBuffers[type].timestampOffset;\n                        var targetOffset = segment.timestampOffset / 1000; // in seconds\n\n                        var delta = Math.abs(currentOffset - targetOffset);\n                        if (delta > 0.1) {\n                            // If time delta > 100ms\n                            _logger2.default.v(this.TAG, 'Update MPEG audio timestampOffset from ' + currentOffset + ' to ' + targetOffset);\n                            this._sourceBuffers[type].timestampOffset = targetOffset;\n                        }\n                        delete segment.timestampOffset;\n                    }\n\n                    if (!segment.data || segment.data.byteLength === 0) {\n                        // Ignore empty buffer\n                        continue;\n                    }\n\n                    try {\n                        this._sourceBuffers[type].appendBuffer(segment.data);\n                        this._isBufferFull = false;\n                        if (type === 'video' && segment.hasOwnProperty('info')) {\n                            this._idrList.appendArray(segment.info.syncPoints);\n                        }\n                    } catch (error) {\n                        this._pendingSegments[type].unshift(segment);\n                        if (error.code === 22) {\n                            // QuotaExceededError\n                            /* Notice that FireFox may not throw QuotaExceededError if SourceBuffer is full\r\n                             * Currently we can only do lazy-load to avoid SourceBuffer become scattered.\r\n                             * SourceBuffer eviction policy may be changed in future version of FireFox.\r\n                             *\r\n                             * Related issues:\r\n                             * https://bugzilla.mozilla.org/show_bug.cgi?id=1279885\r\n                             * https://bugzilla.mozilla.org/show_bug.cgi?id=1280023\r\n                             */\n\n                            // report buffer full, abort network IO\n                            if (!this._isBufferFull) {\n                                this._emitter.emit(_mseEvents2.default.BUFFER_FULL);\n                            }\n                            this._isBufferFull = true;\n                        } else {\n                            _logger2.default.e(this.TAG, error.message);\n                            this._emitter.emit(_mseEvents2.default.ERROR, { code: error.code, msg: error.message });\n                        }\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_onSourceOpen',\n        value: function _onSourceOpen() {\n            _logger2.default.v(this.TAG, 'MediaSource onSourceOpen');\n            this._mediaSource.removeEventListener('sourceopen', this.e.onSourceOpen);\n            // deferred sourcebuffer creation / initialization\n            if (this._pendingSourceBufferInit.length > 0) {\n                var pendings = this._pendingSourceBufferInit;\n                while (pendings.length) {\n                    var segment = pendings.shift();\n                    this.appendInitSegment(segment, true);\n                }\n            }\n            // there may be some pending media segments, append them\n            if (this._hasPendingSegments()) {\n                this._doAppendSegments();\n            }\n            this._emitter.emit(_mseEvents2.default.SOURCE_OPEN);\n        }\n    }, {\n        key: '_onSourceEnded',\n        value: function _onSourceEnded() {\n            // fired on endOfStream\n            _logger2.default.v(this.TAG, 'MediaSource onSourceEnded');\n            this._emitter.emit(_mseEvents2.default.SOURCE_END, 'MediaSource onSourceEnded');\n        }\n    }, {\n        key: '_onSourceClose',\n        value: function _onSourceClose() {\n            // fired on detaching from media element\n            _logger2.default.v(this.TAG, 'MediaSource onSourceClose');\n            if (this._mediaSource && this.e != null) {\n                this._mediaSource.removeEventListener('sourceopen', this.e.onSourceOpen);\n                this._mediaSource.removeEventListener('sourceended', this.e.onSourceEnded);\n                this._mediaSource.removeEventListener('sourceclose', this.e.onSourceClose);\n            }\n        }\n    }, {\n        key: '_hasPendingSegments',\n        value: function _hasPendingSegments() {\n            var ps = this._pendingSegments;\n            return ps.video.length > 0 || ps.audio.length > 0;\n        }\n    }, {\n        key: '_hasPendingRemoveRanges',\n        value: function _hasPendingRemoveRanges() {\n            var prr = this._pendingRemoveRanges;\n            return prr.video.length > 0 || prr.audio.length > 0;\n        }\n    }, {\n        key: '_onSourceBufferUpdateEnd',\n        value: function _onSourceBufferUpdateEnd() {\n            if (this._requireSetMediaDuration) {\n                this._updateMediaSourceDuration();\n            } else if (this._hasPendingRemoveRanges()) {\n                this._doRemoveRanges();\n            } else if (this._hasPendingSegments()) {\n                this._doAppendSegments();\n            } else if (this._hasPendingEos) {\n                this.endOfStream();\n            }\n            this._emitter.emit(_mseEvents2.default.UPDATE_END);\n        }\n    }, {\n        key: '_onSourceBufferError',\n        value: function _onSourceBufferError(e) {\n            _logger2.default.e(this.TAG, 'SourceBuffer Error: ' + e);\n            // this error might not always be fatal, just ignore it\n        }\n    }]);\n\n    return MSEController;\n}();\n\nexports.default = MSEController;\n\n},{\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./media-segment-info.js\":8,\"./mse-events.js\":10,\"events\":2}],10:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar MSEEvents = {\n  ERROR: 'error',\n  SOURCE_OPEN: 'source_open',\n  UPDATE_END: 'update_end',\n  BUFFER_FULL: 'buffer_full',\n  SOURCE_END: 'source_end'\n};\n\nexports.default = MSEEvents;\n\n},{}],11:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _loggingControl = _dereq_('../utils/logging-control.js');\n\nvar _loggingControl2 = _interopRequireDefault(_loggingControl);\n\nvar _transmuxingController = _dereq_('./transmuxing-controller.js');\n\nvar _transmuxingController2 = _interopRequireDefault(_transmuxingController);\n\nvar _transmuxingEvents = _dereq_('./transmuxing-events.js');\n\nvar _transmuxingEvents2 = _interopRequireDefault(_transmuxingEvents);\n\nvar _transmuxingWorker = _dereq_('./transmuxing-worker.js');\n\nvar _transmuxingWorker2 = _interopRequireDefault(_transmuxingWorker);\n\nvar _mediaInfo = _dereq_('./media-info.js');\n\nvar _mediaInfo2 = _interopRequireDefault(_mediaInfo);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Transmuxer = function () {\n    function Transmuxer(mediaDataSource, config) {\n        _classCallCheck(this, Transmuxer);\n\n        this.TAG = 'Transmuxer';\n        this._emitter = new _events2.default();\n\n        if (config.enableWorker && typeof Worker !== 'undefined') {\n            try {\n                var work = _dereq_('webworkify');\n                this._worker = work(_transmuxingWorker2.default);\n                this._workerDestroying = false;\n                this._worker.addEventListener('message', this._onWorkerMessage.bind(this));\n                this._worker.postMessage({ cmd: 'init', param: [mediaDataSource, config] });\n                this.e = {\n                    onLoggingConfigChanged: this._onLoggingConfigChanged.bind(this)\n                };\n                _loggingControl2.default.registerListener(this.e.onLoggingConfigChanged);\n                this._worker.postMessage({ cmd: 'logging_config', param: _loggingControl2.default.getConfig() });\n            } catch (error) {\n                _logger2.default.e(this.TAG, 'Error while initialize transmuxing worker, fallback to inline transmuxing');\n                this._worker = null;\n                this._controller = new _transmuxingController2.default(mediaDataSource, config);\n            }\n        } else {\n            this._controller = new _transmuxingController2.default(mediaDataSource, config);\n        }\n\n        if (this._controller) {\n            var ctl = this._controller;\n            ctl.on(_transmuxingEvents2.default.IO_ERROR, this._onIOError.bind(this));\n            ctl.on(_transmuxingEvents2.default.DEMUX_ERROR, this._onDemuxError.bind(this));\n            ctl.on(_transmuxingEvents2.default.INIT_SEGMENT, this._onInitSegment.bind(this));\n            ctl.on(_transmuxingEvents2.default.MEDIA_SEGMENT, this._onMediaSegment.bind(this));\n            ctl.on(_transmuxingEvents2.default.LOADING_COMPLETE, this._onLoadingComplete.bind(this));\n            ctl.on(_transmuxingEvents2.default.RECOVERED_EARLY_EOF, this._onRecoveredEarlyEof.bind(this));\n            ctl.on(_transmuxingEvents2.default.MEDIA_INFO, this._onMediaInfo.bind(this));\n            ctl.on(_transmuxingEvents2.default.METADATA_ARRIVED, this._onMetaDataArrived.bind(this));\n            ctl.on(_transmuxingEvents2.default.SCRIPTDATA_ARRIVED, this._onScriptDataArrived.bind(this));\n            ctl.on(_transmuxingEvents2.default.STATISTICS_INFO, this._onStatisticsInfo.bind(this));\n            ctl.on(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, this._onRecommendSeekpoint.bind(this));\n            ctl.on(_transmuxingEvents2.default.STREAM_TIME, this._onStreamTime.bind(this));\n        }\n    }\n\n    _createClass(Transmuxer, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._worker) {\n                if (!this._workerDestroying) {\n                    this._workerDestroying = true;\n                    this._worker.postMessage({ cmd: 'destroy' });\n                    _loggingControl2.default.removeListener(this.e.onLoggingConfigChanged);\n                    this.e = null;\n                }\n            } else {\n                this._controller.destroy();\n                this._controller = null;\n            }\n            this._emitter.removeAllListeners();\n            this._emitter = null;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, listener) {\n            this._emitter.addListener(event, listener);\n        }\n    }, {\n        key: 'off',\n        value: function off(event, listener) {\n            this._emitter.removeListener(event, listener);\n        }\n    }, {\n        key: 'hasWorker',\n        value: function hasWorker() {\n            return this._worker != null;\n        }\n    }, {\n        key: 'open',\n        value: function open() {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'start' });\n            } else {\n                this._controller.start();\n            }\n        }\n    }, {\n        key: 'close',\n        value: function close() {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'stop' });\n            } else {\n                this._controller.stop();\n            }\n        }\n    }, {\n        key: 'seek',\n        value: function seek(milliseconds) {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'seek', param: milliseconds });\n            } else {\n                this._controller.seek(milliseconds);\n            }\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'pause' });\n            } else {\n                this._controller.pause();\n            }\n        }\n    }, {\n        key: 'resume',\n        value: function resume() {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'resume' });\n            } else {\n                this._controller.resume();\n            }\n        }\n    }, {\n        key: '_onInitSegment',\n        value: function _onInitSegment(type, initSegment) {\n            var _this = this;\n\n            // do async invoke\n            Promise.resolve().then(function () {\n                _this._emitter.emit(_transmuxingEvents2.default.INIT_SEGMENT, type, initSegment);\n            });\n        }\n    }, {\n        key: '_onMediaSegment',\n        value: function _onMediaSegment(type, mediaSegment) {\n            var _this2 = this;\n\n            Promise.resolve().then(function () {\n                _this2._emitter.emit(_transmuxingEvents2.default.MEDIA_SEGMENT, type, mediaSegment);\n            });\n        }\n    }, {\n        key: '_onLoadingComplete',\n        value: function _onLoadingComplete() {\n            var _this3 = this;\n\n            Promise.resolve().then(function () {\n                _this3._emitter.emit(_transmuxingEvents2.default.LOADING_COMPLETE);\n            });\n        }\n    }, {\n        key: '_onRecoveredEarlyEof',\n        value: function _onRecoveredEarlyEof() {\n            var _this4 = this;\n\n            Promise.resolve().then(function () {\n                _this4._emitter.emit(_transmuxingEvents2.default.RECOVERED_EARLY_EOF);\n            });\n        }\n    }, {\n        key: '_onMediaInfo',\n        value: function _onMediaInfo(mediaInfo) {\n            var _this5 = this;\n\n            Promise.resolve().then(function () {\n                _this5._emitter.emit(_transmuxingEvents2.default.MEDIA_INFO, mediaInfo);\n            });\n        }\n    }, {\n        key: '_onMetaDataArrived',\n        value: function _onMetaDataArrived(metadata) {\n            var _this6 = this;\n\n            Promise.resolve().then(function () {\n                _this6._emitter.emit(_transmuxingEvents2.default.METADATA_ARRIVED, metadata);\n            });\n        }\n    }, {\n        key: '_onScriptDataArrived',\n        value: function _onScriptDataArrived(data) {\n            var _this7 = this;\n\n            Promise.resolve().then(function () {\n                _this7._emitter.emit(_transmuxingEvents2.default.SCRIPTDATA_ARRIVED, data);\n            });\n        }\n    }, {\n        key: '_onStatisticsInfo',\n        value: function _onStatisticsInfo(statisticsInfo) {\n            var _this8 = this;\n\n            Promise.resolve().then(function () {\n                _this8._emitter.emit(_transmuxingEvents2.default.STATISTICS_INFO, statisticsInfo);\n            });\n        }\n    }, {\n        key: '_onIOError',\n        value: function _onIOError(type, info) {\n            var _this9 = this;\n\n            Promise.resolve().then(function () {\n                _this9._emitter.emit(_transmuxingEvents2.default.IO_ERROR, type, info);\n            });\n        }\n    }, {\n        key: '_onDemuxError',\n        value: function _onDemuxError(type, info) {\n            var _this10 = this;\n\n            Promise.resolve().then(function () {\n                _this10._emitter.emit(_transmuxingEvents2.default.DEMUX_ERROR, type, info);\n            });\n        }\n    }, {\n        key: '_onRecommendSeekpoint',\n        value: function _onRecommendSeekpoint(milliseconds) {\n            var _this11 = this;\n\n            Promise.resolve().then(function () {\n                _this11._emitter.emit(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, milliseconds);\n            });\n        }\n    }, {\n        key: '_onStreamTime',\n        value: function _onStreamTime(time) {\n            var _this12 = this;\n\n            Promise.resolve().then(function () {\n                _this12._emitter.emit(_transmuxingEvents2.default.STREAM_TIME, time);\n            });\n        }\n    }, {\n        key: '_onLoggingConfigChanged',\n        value: function _onLoggingConfigChanged(config) {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'logging_config', param: config });\n            }\n        }\n    }, {\n        key: '_onWorkerMessage',\n        value: function _onWorkerMessage(e) {\n            var message = e.data;\n            var data = message.data;\n\n            if (message.msg === 'destroyed' || this._workerDestroying) {\n                this._workerDestroying = false;\n                this._worker.terminate();\n                this._worker = null;\n                return;\n            }\n\n            switch (message.msg) {\n                case _transmuxingEvents2.default.INIT_SEGMENT:\n                case _transmuxingEvents2.default.MEDIA_SEGMENT:\n                    this._emitter.emit(message.msg, data.type, data.data);\n                    break;\n                case _transmuxingEvents2.default.LOADING_COMPLETE:\n                case _transmuxingEvents2.default.RECOVERED_EARLY_EOF:\n                    this._emitter.emit(message.msg);\n                    break;\n                case _transmuxingEvents2.default.MEDIA_INFO:\n                    Object.setPrototypeOf(data, _mediaInfo2.default.prototype);\n                    this._emitter.emit(message.msg, data);\n                    break;\n                case _transmuxingEvents2.default.METADATA_ARRIVED:\n                case _transmuxingEvents2.default.SCRIPTDATA_ARRIVED:\n                case _transmuxingEvents2.default.STATISTICS_INFO:\n                    this._emitter.emit(message.msg, data);\n                    break;\n                case _transmuxingEvents2.default.IO_ERROR:\n                case _transmuxingEvents2.default.DEMUX_ERROR:\n                    this._emitter.emit(message.msg, data.type, data.info);\n                    break;\n                case _transmuxingEvents2.default.RECOMMEND_SEEKPOINT:\n                    this._emitter.emit(message.msg, data);\n                    break;\n                case 'logcat_callback':\n                    _logger2.default.emitter.emit('log', data.type, data.logcat);\n                    break;\n                default:\n                    break;\n            }\n        }\n    }]);\n\n    return Transmuxer;\n}();\n\nexports.default = Transmuxer;\n\n},{\"../utils/logger.js\":41,\"../utils/logging-control.js\":42,\"./media-info.js\":7,\"./transmuxing-controller.js\":12,\"./transmuxing-events.js\":13,\"./transmuxing-worker.js\":14,\"events\":2,\"webworkify\":4}],12:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _browser = _dereq_('../utils/browser.js');\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _mediaInfo = _dereq_('./media-info.js');\n\nvar _mediaInfo2 = _interopRequireDefault(_mediaInfo);\n\nvar _flvDemuxer = _dereq_('../demux/flv-demuxer.js');\n\nvar _flvDemuxer2 = _interopRequireDefault(_flvDemuxer);\n\nvar _mp4Remuxer = _dereq_('../remux/mp4-remuxer.js');\n\nvar _mp4Remuxer2 = _interopRequireDefault(_mp4Remuxer);\n\nvar _demuxErrors = _dereq_('../demux/demux-errors.js');\n\nvar _demuxErrors2 = _interopRequireDefault(_demuxErrors);\n\nvar _ioController = _dereq_('../io/io-controller.js');\n\nvar _ioController2 = _interopRequireDefault(_ioController);\n\nvar _transmuxingEvents = _dereq_('./transmuxing-events.js');\n\nvar _transmuxingEvents2 = _interopRequireDefault(_transmuxingEvents);\n\nvar _loader = _dereq_('../io/loader.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Transmuxing (IO, Demuxing, Remuxing) controller, with multipart support\nvar TransmuxingController = function () {\n    function TransmuxingController(mediaDataSource, config) {\n        _classCallCheck(this, TransmuxingController);\n\n        this.TAG = 'TransmuxingController';\n        this._emitter = new _events2.default();\n\n        this._config = config;\n\n        // treat single part media as multipart media, which has only one segment\n        if (!mediaDataSource.segments) {\n            mediaDataSource.segments = [{\n                duration: mediaDataSource.duration,\n                filesize: mediaDataSource.filesize,\n                url: mediaDataSource.url\n            }];\n        }\n\n        // fill in default IO params if not exists\n        if (typeof mediaDataSource.cors !== 'boolean') {\n            mediaDataSource.cors = true;\n        }\n        if (typeof mediaDataSource.withCredentials !== 'boolean') {\n            mediaDataSource.withCredentials = false;\n        }\n\n        this._mediaDataSource = mediaDataSource;\n        this._currentSegmentIndex = 0;\n        var totalDuration = 0;\n\n        this._mediaDataSource.segments.forEach(function (segment) {\n            // timestampBase for each segment, and calculate total duration\n            segment.timestampBase = totalDuration;\n            totalDuration += segment.duration;\n            // params needed by IOController\n            segment.cors = mediaDataSource.cors;\n            segment.withCredentials = mediaDataSource.withCredentials;\n            // referrer policy control, if exist\n            if (config.referrerPolicy) {\n                segment.referrerPolicy = config.referrerPolicy;\n            }\n        });\n\n        if (!isNaN(totalDuration) && this._mediaDataSource.duration !== totalDuration) {\n            this._mediaDataSource.duration = totalDuration;\n        }\n\n        this._mediaInfo = null;\n        this._demuxer = null;\n        this._remuxer = null;\n        this._ioctl = null;\n\n        this._pendingSeekTime = null;\n        this._pendingResolveSeekPoint = null;\n\n        this._statisticsReporter = null;\n    }\n\n    _createClass(TransmuxingController, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._mediaInfo = null;\n            this._mediaDataSource = null;\n\n            if (this._statisticsReporter) {\n                this._disableStatisticsReporter();\n            }\n            if (this._ioctl) {\n                this._ioctl.destroy();\n                this._ioctl = null;\n            }\n            if (this._demuxer) {\n                this._demuxer.destroy();\n                this._demuxer = null;\n            }\n            if (this._remuxer) {\n                this._remuxer.destroy();\n                this._remuxer = null;\n            }\n\n            this._emitter.removeAllListeners();\n            this._emitter = null;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, listener) {\n            this._emitter.addListener(event, listener);\n        }\n    }, {\n        key: 'off',\n        value: function off(event, listener) {\n            this._emitter.removeListener(event, listener);\n        }\n    }, {\n        key: 'start',\n        value: function start() {\n            this._loadSegment(0);\n            this._enableStatisticsReporter();\n        }\n    }, {\n        key: '_loadSegment',\n        value: function _loadSegment(segmentIndex, optionalFrom) {\n            this._currentSegmentIndex = segmentIndex;\n            var dataSource = this._mediaDataSource.segments[segmentIndex];\n\n            var ioctl = this._ioctl = new _ioController2.default(dataSource, this._config, segmentIndex);\n            ioctl.onError = this._onIOException.bind(this);\n            ioctl.onSeeked = this._onIOSeeked.bind(this);\n            ioctl.onComplete = this._onIOComplete.bind(this);\n            ioctl.onRedirect = this._onIORedirect.bind(this);\n            ioctl.onRecoveredEarlyEof = this._onIORecoveredEarlyEof.bind(this);\n\n            if (optionalFrom) {\n                this._demuxer.bindDataSource(this._ioctl);\n            } else {\n                ioctl.onDataArrival = this._onInitChunkArrival.bind(this);\n            }\n\n            ioctl.open(optionalFrom);\n        }\n    }, {\n        key: 'stop',\n        value: function stop() {\n            this._internalAbort();\n            this._disableStatisticsReporter();\n        }\n    }, {\n        key: '_internalAbort',\n        value: function _internalAbort() {\n            if (this._ioctl) {\n                this._ioctl.destroy();\n                this._ioctl = null;\n            }\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            // take a rest\n            if (this._ioctl && this._ioctl.isWorking()) {\n                this._ioctl.pause();\n                this._disableStatisticsReporter();\n            }\n        }\n    }, {\n        key: 'resume',\n        value: function resume() {\n            if (this._ioctl && this._ioctl.isPaused()) {\n                this._ioctl.resume();\n                this._enableStatisticsReporter();\n            }\n        }\n    }, {\n        key: 'seek',\n        value: function seek(milliseconds) {\n            if (this._mediaInfo == null || !this._mediaInfo.isSeekable()) {\n                return;\n            }\n\n            var targetSegmentIndex = this._searchSegmentIndexContains(milliseconds);\n\n            if (targetSegmentIndex === this._currentSegmentIndex) {\n                // intra-segment seeking\n                var segmentInfo = this._mediaInfo.segments[targetSegmentIndex];\n\n                if (segmentInfo == undefined) {\n                    // current segment loading started, but mediainfo hasn't received yet\n                    // wait for the metadata loaded, then seek to expected position\n                    this._pendingSeekTime = milliseconds;\n                } else {\n                    var keyframe = segmentInfo.getNearestKeyframe(milliseconds);\n                    this._remuxer.seek(keyframe.milliseconds);\n                    this._ioctl.seek(keyframe.fileposition);\n                    // Will be resolved in _onRemuxerMediaSegmentArrival()\n                    this._pendingResolveSeekPoint = keyframe.milliseconds;\n                }\n            } else {\n                // cross-segment seeking\n                var targetSegmentInfo = this._mediaInfo.segments[targetSegmentIndex];\n\n                if (targetSegmentInfo == undefined) {\n                    // target segment hasn't been loaded. We need metadata then seek to expected time\n                    this._pendingSeekTime = milliseconds;\n                    this._internalAbort();\n                    this._remuxer.seek();\n                    this._remuxer.insertDiscontinuity();\n                    this._loadSegment(targetSegmentIndex);\n                    // Here we wait for the metadata loaded, then seek to expected position\n                } else {\n                    // We have target segment's metadata, direct seek to target position\n                    var _keyframe = targetSegmentInfo.getNearestKeyframe(milliseconds);\n                    this._internalAbort();\n                    this._remuxer.seek(milliseconds);\n                    this._remuxer.insertDiscontinuity();\n                    this._demuxer.resetMediaInfo();\n                    this._demuxer.timestampBase = this._mediaDataSource.segments[targetSegmentIndex].timestampBase;\n                    this._loadSegment(targetSegmentIndex, _keyframe.fileposition);\n                    this._pendingResolveSeekPoint = _keyframe.milliseconds;\n                    this._reportSegmentMediaInfo(targetSegmentIndex);\n                }\n            }\n\n            this._enableStatisticsReporter();\n        }\n    }, {\n        key: '_searchSegmentIndexContains',\n        value: function _searchSegmentIndexContains(milliseconds) {\n            var segments = this._mediaDataSource.segments;\n            var idx = segments.length - 1;\n\n            for (var i = 0; i < segments.length; i++) {\n                if (milliseconds < segments[i].timestampBase) {\n                    idx = i - 1;\n                    break;\n                }\n            }\n            return idx;\n        }\n    }, {\n        key: '_onInitChunkArrival',\n        value: function _onInitChunkArrival(data, byteStart) {\n            var _this = this;\n\n            var probeData = null;\n            var consumed = 0;\n\n            if (byteStart > 0) {\n                // IOController seeked immediately after opened, byteStart > 0 callback may received\n                this._demuxer.bindDataSource(this._ioctl);\n                this._demuxer.timestampBase = this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase;\n\n                consumed = this._demuxer.parseChunks(data, byteStart);\n            } else if ((probeData = _flvDemuxer2.default.probe(data)).match) {\n                // Always create new FLVDemuxer\n                this._demuxer = new _flvDemuxer2.default(probeData, this._config);\n\n                if (!this._remuxer) {\n                    this._remuxer = new _mp4Remuxer2.default(this._config);\n                }\n\n                var mds = this._mediaDataSource;\n                if (mds.duration != undefined && !isNaN(mds.duration)) {\n                    this._demuxer.overridedDuration = mds.duration;\n                }\n                if (typeof mds.hasAudio === 'boolean') {\n                    this._demuxer.overridedHasAudio = mds.hasAudio;\n                }\n                if (typeof mds.hasVideo === 'boolean') {\n                    this._demuxer.overridedHasVideo = mds.hasVideo;\n                }\n\n                this._demuxer.timestampBase = mds.segments[this._currentSegmentIndex].timestampBase;\n\n                this._demuxer.onError = this._onDemuxException.bind(this);\n                this._demuxer.onMediaInfo = this._onMediaInfo.bind(this);\n                this._demuxer.onMetaDataArrived = this._onMetaDataArrived.bind(this);\n                this._demuxer.onScriptDataArrived = this._onScriptDataArrived.bind(this);\n                this._demuxer.onStreamTime = this._onStreamTime.bind(this);\n\n                this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl));\n\n                this._remuxer.onInitSegment = this._onRemuxerInitSegmentArrival.bind(this);\n                this._remuxer.onMediaSegment = this._onRemuxerMediaSegmentArrival.bind(this);\n\n                consumed = this._demuxer.parseChunks(data, byteStart);\n            } else {\n                probeData = null;\n                _logger2.default.e(this.TAG, 'Non-FLV, Unsupported media type!');\n                Promise.resolve().then(function () {\n                    _this._internalAbort();\n                });\n                this._emitter.emit(_transmuxingEvents2.default.DEMUX_ERROR, _demuxErrors2.default.FORMAT_UNSUPPORTED, 'Non-FLV, Unsupported media type');\n\n                consumed = 0;\n            }\n\n            return consumed;\n        }\n    }, {\n        key: '_onMediaInfo',\n        value: function _onMediaInfo(mediaInfo) {\n            var _this2 = this;\n\n            if (this._mediaInfo == null) {\n                // Store first segment's mediainfo as global mediaInfo\n                this._mediaInfo = Object.assign({}, mediaInfo);\n                this._mediaInfo.keyframesIndex = null;\n                this._mediaInfo.segments = [];\n                this._mediaInfo.segmentCount = this._mediaDataSource.segments.length;\n                Object.setPrototypeOf(this._mediaInfo, _mediaInfo2.default.prototype);\n            }\n\n            var segmentInfo = Object.assign({}, mediaInfo);\n            Object.setPrototypeOf(segmentInfo, _mediaInfo2.default.prototype);\n            this._mediaInfo.segments[this._currentSegmentIndex] = segmentInfo;\n\n            // notify mediaInfo update\n            this._reportSegmentMediaInfo(this._currentSegmentIndex);\n\n            if (this._pendingSeekTime != null) {\n                Promise.resolve().then(function () {\n                    var target = _this2._pendingSeekTime;\n                    _this2._pendingSeekTime = null;\n                    _this2.seek(target);\n                });\n            }\n        }\n    }, {\n        key: '_onMetaDataArrived',\n        value: function _onMetaDataArrived(metadata) {\n            this._emitter.emit(_transmuxingEvents2.default.METADATA_ARRIVED, metadata);\n        }\n    }, {\n        key: '_onScriptDataArrived',\n        value: function _onScriptDataArrived(data) {\n            this._emitter.emit(_transmuxingEvents2.default.SCRIPTDATA_ARRIVED, data);\n        }\n    }, {\n        key: '_onStreamTime',\n        value: function _onStreamTime(time) {\n            this._emitter.emit(_transmuxingEvents2.default.STREAM_TIME, time);\n        }\n    }, {\n        key: '_onIOSeeked',\n        value: function _onIOSeeked() {\n            this._remuxer.insertDiscontinuity();\n        }\n    }, {\n        key: '_onIOComplete',\n        value: function _onIOComplete(extraData) {\n            var segmentIndex = extraData;\n            var nextSegmentIndex = segmentIndex + 1;\n\n            if (nextSegmentIndex < this._mediaDataSource.segments.length) {\n                this._internalAbort();\n                this._remuxer.flushStashedSamples();\n                this._loadSegment(nextSegmentIndex);\n            } else {\n                this._remuxer.flushStashedSamples();\n                this._emitter.emit(_transmuxingEvents2.default.LOADING_COMPLETE);\n                this._disableStatisticsReporter();\n            }\n        }\n    }, {\n        key: '_onIORedirect',\n        value: function _onIORedirect(redirectedURL) {\n            var segmentIndex = this._ioctl.extraData;\n            this._mediaDataSource.segments[segmentIndex].redirectedURL = redirectedURL;\n        }\n    }, {\n        key: '_onIORecoveredEarlyEof',\n        value: function _onIORecoveredEarlyEof() {\n            this._emitter.emit(_transmuxingEvents2.default.RECOVERED_EARLY_EOF);\n        }\n    }, {\n        key: '_onIOException',\n        value: function _onIOException(type, info) {\n            _logger2.default.e(this.TAG, 'IOException: type = ' + type + ', code = ' + info.code + ', msg = ' + info.msg);\n            this._emitter.emit(_transmuxingEvents2.default.IO_ERROR, type, info);\n            this._disableStatisticsReporter();\n        }\n    }, {\n        key: '_onDemuxException',\n        value: function _onDemuxException(type, info) {\n            _logger2.default.e(this.TAG, 'DemuxException: type = ' + type + ', info = ' + info);\n            this._emitter.emit(_transmuxingEvents2.default.DEMUX_ERROR, type, info);\n        }\n    }, {\n        key: '_onRemuxerInitSegmentArrival',\n        value: function _onRemuxerInitSegmentArrival(type, initSegment) {\n            this._emitter.emit(_transmuxingEvents2.default.INIT_SEGMENT, type, initSegment);\n        }\n    }, {\n        key: '_onRemuxerMediaSegmentArrival',\n        value: function _onRemuxerMediaSegmentArrival(type, mediaSegment) {\n            if (this._pendingSeekTime != null) {\n                // Media segments after new-segment cross-seeking should be dropped.\n                return;\n            }\n            this._emitter.emit(_transmuxingEvents2.default.MEDIA_SEGMENT, type, mediaSegment);\n\n            // Resolve pending seekPoint\n            if (this._pendingResolveSeekPoint != null && type === 'video') {\n                var syncPoints = mediaSegment.info.syncPoints;\n                var seekpoint = this._pendingResolveSeekPoint;\n                this._pendingResolveSeekPoint = null;\n\n                // Safari: Pass PTS for recommend_seekpoint\n                if (_browser2.default.safari && syncPoints.length > 0 && syncPoints[0].originalDts === seekpoint) {\n                    seekpoint = syncPoints[0].pts;\n                }\n                // else: use original DTS (keyframe.milliseconds)\n\n                this._emitter.emit(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, seekpoint);\n            }\n        }\n    }, {\n        key: '_enableStatisticsReporter',\n        value: function _enableStatisticsReporter() {\n            if (this._statisticsReporter == null) {\n                this._statisticsReporter = self.setInterval(this._reportStatisticsInfo.bind(this), this._config.statisticsInfoReportInterval);\n            }\n        }\n    }, {\n        key: '_disableStatisticsReporter',\n        value: function _disableStatisticsReporter() {\n            if (this._statisticsReporter) {\n                self.clearInterval(this._statisticsReporter);\n                this._statisticsReporter = null;\n            }\n        }\n    }, {\n        key: '_reportSegmentMediaInfo',\n        value: function _reportSegmentMediaInfo(segmentIndex) {\n            var segmentInfo = this._mediaInfo.segments[segmentIndex];\n            var exportInfo = Object.assign({}, segmentInfo);\n\n            exportInfo.duration = this._mediaInfo.duration;\n            exportInfo.segmentCount = this._mediaInfo.segmentCount;\n            delete exportInfo.segments;\n            delete exportInfo.keyframesIndex;\n\n            this._emitter.emit(_transmuxingEvents2.default.MEDIA_INFO, exportInfo);\n        }\n    }, {\n        key: '_reportStatisticsInfo',\n        value: function _reportStatisticsInfo() {\n            var info = {};\n\n            info.url = this._ioctl.currentURL;\n            info.hasRedirect = this._ioctl.hasRedirect;\n            if (info.hasRedirect) {\n                info.redirectedURL = this._ioctl.currentRedirectedURL;\n            }\n\n            info.speed = this._ioctl.currentSpeed;\n            info.loaderType = this._ioctl.loaderType;\n            info.currentSegmentIndex = this._currentSegmentIndex;\n            info.totalSegmentCount = this._mediaDataSource.segments.length;\n\n            this._emitter.emit(_transmuxingEvents2.default.STATISTICS_INFO, info);\n        }\n    }]);\n\n    return TransmuxingController;\n}();\n\nexports.default = TransmuxingController;\n\n},{\"../demux/demux-errors.js\":16,\"../demux/flv-demuxer.js\":18,\"../io/io-controller.js\":23,\"../io/loader.js\":24,\"../remux/mp4-remuxer.js\":38,\"../utils/browser.js\":39,\"../utils/logger.js\":41,\"./media-info.js\":7,\"./transmuxing-events.js\":13,\"events\":2}],13:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar TransmuxingEvents = {\n  IO_ERROR: 'io_error',\n  DEMUX_ERROR: 'demux_error',\n  INIT_SEGMENT: 'init_segment',\n  MEDIA_SEGMENT: 'media_segment',\n  LOADING_COMPLETE: 'loading_complete',\n  RECOVERED_EARLY_EOF: 'recovered_early_eof',\n  MEDIA_INFO: 'media_info',\n  METADATA_ARRIVED: 'metadata_arrived',\n  SCRIPTDATA_ARRIVED: 'scriptdata_arrived',\n  STATISTICS_INFO: 'statistics_info',\n  RECOMMEND_SEEKPOINT: 'recommend_seekpoint',\n  STREAM_TIME: 'stream_time'\n};\n\nexports.default = TransmuxingEvents;\n\n},{}],14:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _loggingControl = _dereq_('../utils/logging-control.js');\n\nvar _loggingControl2 = _interopRequireDefault(_loggingControl);\n\nvar _polyfill = _dereq_('../utils/polyfill.js');\n\nvar _polyfill2 = _interopRequireDefault(_polyfill);\n\nvar _transmuxingController = _dereq_('./transmuxing-controller.js');\n\nvar _transmuxingController2 = _interopRequireDefault(_transmuxingController);\n\nvar _transmuxingEvents = _dereq_('./transmuxing-events.js');\n\nvar _transmuxingEvents2 = _interopRequireDefault(_transmuxingEvents);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/* post message to worker:\r\n   data: {\r\n       cmd: string\r\n       param: any\r\n   }\r\n\r\n   receive message from worker:\r\n   data: {\r\n       msg: string,\r\n       data: any\r\n   }\r\n */\n\nvar TransmuxingWorker = function TransmuxingWorker(self) {\n\n    var TAG = 'TransmuxingWorker';\n    var controller = null;\n    var logcatListener = onLogcatCallback.bind(this);\n\n    _polyfill2.default.install();\n\n    self.addEventListener('message', function (e) {\n        switch (e.data.cmd) {\n            case 'init':\n                controller = new _transmuxingController2.default(e.data.param[0], e.data.param[1]);\n                controller.on(_transmuxingEvents2.default.IO_ERROR, onIOError.bind(this));\n                controller.on(_transmuxingEvents2.default.DEMUX_ERROR, onDemuxError.bind(this));\n                controller.on(_transmuxingEvents2.default.INIT_SEGMENT, onInitSegment.bind(this));\n                controller.on(_transmuxingEvents2.default.MEDIA_SEGMENT, onMediaSegment.bind(this));\n                controller.on(_transmuxingEvents2.default.LOADING_COMPLETE, onLoadingComplete.bind(this));\n                controller.on(_transmuxingEvents2.default.RECOVERED_EARLY_EOF, onRecoveredEarlyEof.bind(this));\n                controller.on(_transmuxingEvents2.default.MEDIA_INFO, onMediaInfo.bind(this));\n                controller.on(_transmuxingEvents2.default.METADATA_ARRIVED, onMetaDataArrived.bind(this));\n                controller.on(_transmuxingEvents2.default.SCRIPTDATA_ARRIVED, onScriptDataArrived.bind(this));\n                controller.on(_transmuxingEvents2.default.STATISTICS_INFO, onStatisticsInfo.bind(this));\n                controller.on(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, onRecommendSeekpoint.bind(this));\n                break;\n            case 'destroy':\n                if (controller) {\n                    controller.destroy();\n                    controller = null;\n                }\n                self.postMessage({ msg: 'destroyed' });\n                break;\n            case 'start':\n                controller.start();\n                break;\n            case 'stop':\n                controller.stop();\n                break;\n            case 'seek':\n                controller.seek(e.data.param);\n                break;\n            case 'pause':\n                controller.pause();\n                break;\n            case 'resume':\n                controller.resume();\n                break;\n            case 'logging_config':\n                {\n                    var config = e.data.param;\n                    _loggingControl2.default.applyConfig(config);\n\n                    if (config.enableCallback === true) {\n                        _loggingControl2.default.addLogListener(logcatListener);\n                    } else {\n                        _loggingControl2.default.removeLogListener(logcatListener);\n                    }\n                    break;\n                }\n        }\n    });\n\n    function onInitSegment(type, initSegment) {\n        var obj = {\n            msg: _transmuxingEvents2.default.INIT_SEGMENT,\n            data: {\n                type: type,\n                data: initSegment\n            }\n        };\n        self.postMessage(obj, [initSegment.data]); // data: ArrayBuffer\n    }\n\n    function onMediaSegment(type, mediaSegment) {\n        var obj = {\n            msg: _transmuxingEvents2.default.MEDIA_SEGMENT,\n            data: {\n                type: type,\n                data: mediaSegment\n            }\n        };\n        self.postMessage(obj, [mediaSegment.data]); // data: ArrayBuffer\n    }\n\n    function onLoadingComplete() {\n        var obj = {\n            msg: _transmuxingEvents2.default.LOADING_COMPLETE\n        };\n        self.postMessage(obj);\n    }\n\n    function onRecoveredEarlyEof() {\n        var obj = {\n            msg: _transmuxingEvents2.default.RECOVERED_EARLY_EOF\n        };\n        self.postMessage(obj);\n    }\n\n    function onMediaInfo(mediaInfo) {\n        var obj = {\n            msg: _transmuxingEvents2.default.MEDIA_INFO,\n            data: mediaInfo\n        };\n        self.postMessage(obj);\n    }\n\n    function onMetaDataArrived(metadata) {\n        var obj = {\n            msg: _transmuxingEvents2.default.METADATA_ARRIVED,\n            data: metadata\n        };\n        self.postMessage(obj);\n    }\n\n    function onScriptDataArrived(data) {\n        var obj = {\n            msg: _transmuxingEvents2.default.SCRIPTDATA_ARRIVED,\n            data: data\n        };\n        self.postMessage(obj);\n    }\n\n    function onStatisticsInfo(statInfo) {\n        var obj = {\n            msg: _transmuxingEvents2.default.STATISTICS_INFO,\n            data: statInfo\n        };\n        self.postMessage(obj);\n    }\n\n    function onIOError(type, info) {\n        self.postMessage({\n            msg: _transmuxingEvents2.default.IO_ERROR,\n            data: {\n                type: type,\n                info: info\n            }\n        });\n    }\n\n    function onDemuxError(type, info) {\n        self.postMessage({\n            msg: _transmuxingEvents2.default.DEMUX_ERROR,\n            data: {\n                type: type,\n                info: info\n            }\n        });\n    }\n\n    function onRecommendSeekpoint(milliseconds) {\n        self.postMessage({\n            msg: _transmuxingEvents2.default.RECOMMEND_SEEKPOINT,\n            data: milliseconds\n        });\n    }\n\n    function onLogcatCallback(type, str) {\n        self.postMessage({\n            msg: 'logcat_callback',\n            data: {\n                type: type,\n                logcat: str\n            }\n        });\n    }\n}; /*\r\n    * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n    *\r\n    * @author zheng qian <xqq@xqq.im>\r\n    *\r\n    * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n    * you may not use this file except in compliance with the License.\r\n    * You may obtain a copy of the License at\r\n    *\r\n    *     http://www.apache.org/licenses/LICENSE-2.0\r\n    *\r\n    * Unless required by applicable law or agreed to in writing, software\r\n    * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n    * See the License for the specific language governing permissions and\r\n    * limitations under the License.\r\n    */\n\nexports.default = TransmuxingWorker;\n\n},{\"../utils/logger.js\":41,\"../utils/logging-control.js\":42,\"../utils/polyfill.js\":43,\"./transmuxing-controller.js\":12,\"./transmuxing-events.js\":13}],15:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _utf8Conv = _dereq_('../utils/utf8-conv.js');\n\nvar _utf8Conv2 = _interopRequireDefault(_utf8Conv);\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar le = function () {\n    var buf = new ArrayBuffer(2);\n    new DataView(buf).setInt16(0, 256, true); // little-endian write\n    return new Int16Array(buf)[0] === 256; // platform-spec read, if equal then LE\n}();\n\nvar AMF = function () {\n    function AMF() {\n        _classCallCheck(this, AMF);\n    }\n\n    _createClass(AMF, null, [{\n        key: 'parseScriptData',\n        value: function parseScriptData(arrayBuffer, dataOffset, dataSize) {\n            var data = {};\n\n            try {\n                var name = AMF.parseValue(arrayBuffer, dataOffset, dataSize);\n                var value = AMF.parseValue(arrayBuffer, dataOffset + name.size, dataSize - name.size);\n\n                data[name.data] = value.data;\n            } catch (e) {\n                _logger2.default.e('AMF', e.toString());\n            }\n\n            return data;\n        }\n    }, {\n        key: 'parseObject',\n        value: function parseObject(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 3) {\n                throw new _exception.IllegalStateException('Data not enough when parse ScriptDataObject');\n            }\n            var name = AMF.parseString(arrayBuffer, dataOffset, dataSize);\n            var value = AMF.parseValue(arrayBuffer, dataOffset + name.size, dataSize - name.size);\n            var isObjectEnd = value.objectEnd;\n\n            return {\n                data: {\n                    name: name.data,\n                    value: value.data\n                },\n                size: name.size + value.size,\n                objectEnd: isObjectEnd\n            };\n        }\n    }, {\n        key: 'parseVariable',\n        value: function parseVariable(arrayBuffer, dataOffset, dataSize) {\n            return AMF.parseObject(arrayBuffer, dataOffset, dataSize);\n        }\n    }, {\n        key: 'parseString',\n        value: function parseString(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 2) {\n                throw new _exception.IllegalStateException('Data not enough when parse String');\n            }\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n            var length = v.getUint16(0, !le);\n\n            var str = void 0;\n            if (length > 0) {\n                str = (0, _utf8Conv2.default)(new Uint8Array(arrayBuffer, dataOffset + 2, length));\n            } else {\n                str = '';\n            }\n\n            return {\n                data: str,\n                size: 2 + length\n            };\n        }\n    }, {\n        key: 'parseLongString',\n        value: function parseLongString(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 4) {\n                throw new _exception.IllegalStateException('Data not enough when parse LongString');\n            }\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n            var length = v.getUint32(0, !le);\n\n            var str = void 0;\n            if (length > 0) {\n                str = (0, _utf8Conv2.default)(new Uint8Array(arrayBuffer, dataOffset + 4, length));\n            } else {\n                str = '';\n            }\n\n            return {\n                data: str,\n                size: 4 + length\n            };\n        }\n    }, {\n        key: 'parseDate',\n        value: function parseDate(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 10) {\n                throw new _exception.IllegalStateException('Data size invalid when parse Date');\n            }\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n            var timestamp = v.getFloat64(0, !le);\n            var localTimeOffset = v.getInt16(8, !le);\n            timestamp += localTimeOffset * 60 * 1000; // get UTC time\n\n            return {\n                data: new Date(timestamp),\n                size: 8 + 2\n            };\n        }\n    }, {\n        key: 'parseValue',\n        value: function parseValue(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 1) {\n                throw new _exception.IllegalStateException('Data not enough when parse Value');\n            }\n\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n            var offset = 1;\n            var type = v.getUint8(0);\n            var value = void 0;\n            var objectEnd = false;\n\n            try {\n                switch (type) {\n                    case 0:\n                        // Number(Double) type\n                        value = v.getFloat64(1, !le);\n                        offset += 8;\n                        break;\n                    case 1:\n                        {\n                            // Boolean type\n                            var b = v.getUint8(1);\n                            value = b ? true : false;\n                            offset += 1;\n                            break;\n                        }\n                    case 2:\n                        {\n                            // String type\n                            var amfstr = AMF.parseString(arrayBuffer, dataOffset + 1, dataSize - 1);\n                            value = amfstr.data;\n                            offset += amfstr.size;\n                            break;\n                        }\n                    case 3:\n                        {\n                            // Object(s) type\n                            value = {};\n                            var terminal = 0; // workaround for malformed Objects which has missing ScriptDataObjectEnd\n                            if ((v.getUint32(dataSize - 4, !le) & 0x00FFFFFF) === 9) {\n                                terminal = 3;\n                            }\n                            while (offset < dataSize - 4) {\n                                // 4 === type(UI8) + ScriptDataObjectEnd(UI24)\n                                var amfobj = AMF.parseObject(arrayBuffer, dataOffset + offset, dataSize - offset - terminal);\n                                if (amfobj.objectEnd) break;\n                                value[amfobj.data.name] = amfobj.data.value;\n                                offset += amfobj.size;\n                            }\n                            if (offset <= dataSize - 3) {\n                                var marker = v.getUint32(offset - 1, !le) & 0x00FFFFFF;\n                                if (marker === 9) {\n                                    offset += 3;\n                                }\n                            }\n                            break;\n                        }\n                    case 8:\n                        {\n                            // ECMA array type (Mixed array)\n                            value = {};\n                            offset += 4; // ECMAArrayLength(UI32)\n                            var _terminal = 0; // workaround for malformed MixedArrays which has missing ScriptDataObjectEnd\n                            if ((v.getUint32(dataSize - 4, !le) & 0x00FFFFFF) === 9) {\n                                _terminal = 3;\n                            }\n                            while (offset < dataSize - 8) {\n                                // 8 === type(UI8) + ECMAArrayLength(UI32) + ScriptDataVariableEnd(UI24)\n                                var amfvar = AMF.parseVariable(arrayBuffer, dataOffset + offset, dataSize - offset - _terminal);\n                                if (amfvar.objectEnd) break;\n                                value[amfvar.data.name] = amfvar.data.value;\n                                offset += amfvar.size;\n                            }\n                            if (offset <= dataSize - 3) {\n                                var _marker = v.getUint32(offset - 1, !le) & 0x00FFFFFF;\n                                if (_marker === 9) {\n                                    offset += 3;\n                                }\n                            }\n                            break;\n                        }\n                    case 9:\n                        // ScriptDataObjectEnd\n                        value = undefined;\n                        offset = 1;\n                        objectEnd = true;\n                        break;\n                    case 10:\n                        {\n                            // Strict array type\n                            // ScriptDataValue[n]. NOTE: according to video_file_format_spec_v10_1.pdf\n                            value = [];\n                            var strictArrayLength = v.getUint32(1, !le);\n                            offset += 4;\n                            for (var i = 0; i < strictArrayLength; i++) {\n                                var val = AMF.parseValue(arrayBuffer, dataOffset + offset, dataSize - offset);\n                                value.push(val.data);\n                                offset += val.size;\n                            }\n                            break;\n                        }\n                    case 11:\n                        {\n                            // Date type\n                            var date = AMF.parseDate(arrayBuffer, dataOffset + 1, dataSize - 1);\n                            value = date.data;\n                            offset += date.size;\n                            break;\n                        }\n                    case 12:\n                        {\n                            // Long string type\n                            var amfLongStr = AMF.parseString(arrayBuffer, dataOffset + 1, dataSize - 1);\n                            value = amfLongStr.data;\n                            offset += amfLongStr.size;\n                            break;\n                        }\n                    default:\n                        // ignore and skip\n                        offset = dataSize;\n                        _logger2.default.w('AMF', 'Unsupported AMF value type ' + type);\n                }\n            } catch (e) {\n                _logger2.default.e('AMF', e.toString());\n            }\n\n            return {\n                data: value,\n                size: offset,\n                objectEnd: objectEnd\n            };\n        }\n    }]);\n\n    return AMF;\n}();\n\nexports.default = AMF;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"../utils/utf8-conv.js\":44}],16:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar DemuxErrors = {\n  OK: 'OK',\n  FORMAT_ERROR: 'FormatError',\n  FORMAT_UNSUPPORTED: 'FormatUnsupported',\n  CODEC_UNSUPPORTED: 'CodecUnsupported'\n};\n\nexports.default = DemuxErrors;\n\n},{}],17:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Exponential-Golomb buffer decoder\nvar ExpGolomb = function () {\n    function ExpGolomb(uint8array) {\n        _classCallCheck(this, ExpGolomb);\n\n        this.TAG = 'ExpGolomb';\n\n        this._buffer = uint8array;\n        this._buffer_index = 0;\n        this._total_bytes = uint8array.byteLength;\n        this._total_bits = uint8array.byteLength * 8;\n        this._current_word = 0;\n        this._current_word_bits_left = 0;\n    }\n\n    _createClass(ExpGolomb, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._buffer = null;\n        }\n    }, {\n        key: '_fillCurrentWord',\n        value: function _fillCurrentWord() {\n            var buffer_bytes_left = this._total_bytes - this._buffer_index;\n            if (buffer_bytes_left <= 0) throw new _exception.IllegalStateException('ExpGolomb: _fillCurrentWord() but no bytes available');\n\n            var bytes_read = Math.min(4, buffer_bytes_left);\n            var word = new Uint8Array(4);\n            word.set(this._buffer.subarray(this._buffer_index, this._buffer_index + bytes_read));\n            this._current_word = new DataView(word.buffer).getUint32(0, false);\n\n            this._buffer_index += bytes_read;\n            this._current_word_bits_left = bytes_read * 8;\n        }\n    }, {\n        key: 'readBits',\n        value: function readBits(bits) {\n            if (bits > 32) throw new _exception.InvalidArgumentException('ExpGolomb: readBits() bits exceeded max 32bits!');\n\n            if (bits <= this._current_word_bits_left) {\n                var _result = this._current_word >>> 32 - bits;\n                this._current_word <<= bits;\n                this._current_word_bits_left -= bits;\n                return _result;\n            }\n\n            var result = this._current_word_bits_left ? this._current_word : 0;\n            result = result >>> 32 - this._current_word_bits_left;\n            var bits_need_left = bits - this._current_word_bits_left;\n\n            this._fillCurrentWord();\n            var bits_read_next = Math.min(bits_need_left, this._current_word_bits_left);\n\n            var result2 = this._current_word >>> 32 - bits_read_next;\n            this._current_word <<= bits_read_next;\n            this._current_word_bits_left -= bits_read_next;\n\n            result = result << bits_read_next | result2;\n            return result;\n        }\n    }, {\n        key: 'readBool',\n        value: function readBool() {\n            return this.readBits(1) === 1;\n        }\n    }, {\n        key: 'readByte',\n        value: function readByte() {\n            return this.readBits(8);\n        }\n    }, {\n        key: '_skipLeadingZero',\n        value: function _skipLeadingZero() {\n            var zero_count = void 0;\n            for (zero_count = 0; zero_count < this._current_word_bits_left; zero_count++) {\n                if (0 !== (this._current_word & 0x80000000 >>> zero_count)) {\n                    this._current_word <<= zero_count;\n                    this._current_word_bits_left -= zero_count;\n                    return zero_count;\n                }\n            }\n            this._fillCurrentWord();\n            return zero_count + this._skipLeadingZero();\n        }\n    }, {\n        key: 'readUEG',\n        value: function readUEG() {\n            // unsigned exponential golomb\n            var leading_zeros = this._skipLeadingZero();\n            return this.readBits(leading_zeros + 1) - 1;\n        }\n    }, {\n        key: 'readSEG',\n        value: function readSEG() {\n            // signed exponential golomb\n            var value = this.readUEG();\n            if (value & 0x01) {\n                return value + 1 >>> 1;\n            } else {\n                return -1 * (value >>> 1);\n            }\n        }\n    }]);\n\n    return ExpGolomb;\n}();\n\nexports.default = ExpGolomb;\n\n},{\"../utils/exception.js\":40}],18:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _amfParser = _dereq_('./amf-parser.js');\n\nvar _amfParser2 = _interopRequireDefault(_amfParser);\n\nvar _spsParser = _dereq_('./sps-parser.js');\n\nvar _spsParser2 = _interopRequireDefault(_spsParser);\n\nvar _demuxErrors = _dereq_('./demux-errors.js');\n\nvar _demuxErrors2 = _interopRequireDefault(_demuxErrors);\n\nvar _mediaInfo = _dereq_('../core/media-info.js');\n\nvar _mediaInfo2 = _interopRequireDefault(_mediaInfo);\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Swap16(src) {\n    return src >>> 8 & 0xFF | (src & 0xFF) << 8;\n}\n\nfunction Swap32(src) {\n    return (src & 0xFF000000) >>> 24 | (src & 0x00FF0000) >>> 8 | (src & 0x0000FF00) << 8 | (src & 0x000000FF) << 24;\n}\n\nfunction ReadBig32(array, index) {\n    return array[index] << 24 | array[index + 1] << 16 | array[index + 2] << 8 | array[index + 3];\n}\n\nvar FLVDemuxer = function () {\n    function FLVDemuxer(probeData, config) {\n        _classCallCheck(this, FLVDemuxer);\n\n        this.TAG = 'FLVDemuxer';\n\n        this._config = config;\n\n        this._onError = null;\n        this._onMediaInfo = null;\n        this._onMetaDataArrived = null;\n        this._onScriptDataArrived = null;\n        this._onTrackMetadata = null;\n        this._onDataAvailable = null;\n        this._onStreamTime = null;\n\n        this._dataOffset = probeData.dataOffset;\n        this._firstParse = true;\n        this._dispatch = false;\n\n        this._hasAudio = probeData.hasAudioTrack;\n        this._hasVideo = probeData.hasVideoTrack;\n\n        this._hasAudioFlagOverrided = false;\n        this._hasVideoFlagOverrided = false;\n\n        this._audioInitialMetadataDispatched = false;\n        this._videoInitialMetadataDispatched = false;\n\n        this._mediaInfo = new _mediaInfo2.default();\n        this._mediaInfo.hasAudio = this._hasAudio;\n        this._mediaInfo.hasVideo = this._hasVideo;\n        this._metadata = null;\n        this._audioMetadata = null;\n        this._videoMetadata = null;\n\n        this._naluLengthSize = 4;\n        this._timestampBase = 0; // int32, in milliseconds\n        this._timescale = 1000;\n        this._duration = 0; // int32, in milliseconds\n        this._durationOverrided = false;\n        this._referenceFrameRate = {\n            fixed: true,\n            fps: 23.976,\n            fps_num: 23976,\n            fps_den: 1000\n        };\n\n        this._flvSoundRateTable = [5500, 11025, 22050, 44100, 48000];\n\n        this._mpegSamplingRates = [96000, 88200, 64000, 48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000, 7350];\n\n        this._mpegAudioV10SampleRateTable = [44100, 48000, 32000, 0];\n        this._mpegAudioV20SampleRateTable = [22050, 24000, 16000, 0];\n        this._mpegAudioV25SampleRateTable = [11025, 12000, 8000, 0];\n\n        this._mpegAudioL1BitRateTable = [0, 32, 64, 96, 128, 160, 192, 224, 256, 288, 320, 352, 384, 416, 448, -1];\n        this._mpegAudioL2BitRateTable = [0, 32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 384, -1];\n        this._mpegAudioL3BitRateTable = [0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, -1];\n\n        this._videoTrack = { type: 'video', id: 1, sequenceNumber: 0, samples: [], length: 0 };\n        this._audioTrack = { type: 'audio', id: 2, sequenceNumber: 0, samples: [], length: 0 };\n\n        this._littleEndian = function () {\n            var buf = new ArrayBuffer(2);\n            new DataView(buf).setInt16(0, 256, true); // little-endian write\n            return new Int16Array(buf)[0] === 256; // platform-spec read, if equal then LE\n        }();\n    }\n\n    _createClass(FLVDemuxer, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._mediaInfo = null;\n            this._metadata = null;\n            this._audioMetadata = null;\n            this._videoMetadata = null;\n            this._videoTrack = null;\n            this._audioTrack = null;\n\n            this._onError = null;\n            this._onMediaInfo = null;\n            this._onMetaDataArrived = null;\n            this._onScriptDataArrived = null;\n            this._onTrackMetadata = null;\n            this._onDataAvailable = null;\n            this._onStreamTime = null;\n        }\n    }, {\n        key: 'bindDataSource',\n        value: function bindDataSource(loader) {\n            loader.onDataArrival = this.parseChunks.bind(this);\n            return this;\n        }\n\n        // prototype: function(type: string, metadata: any): void\n\n    }, {\n        key: 'resetMediaInfo',\n        value: function resetMediaInfo() {\n            this._mediaInfo = new _mediaInfo2.default();\n        }\n    }, {\n        key: '_isInitialMetadataDispatched',\n        value: function _isInitialMetadataDispatched() {\n            if (this._hasAudio && this._hasVideo) {\n                // both audio & video\n                return this._audioInitialMetadataDispatched && this._videoInitialMetadataDispatched;\n            }\n            if (this._hasAudio && !this._hasVideo) {\n                // audio only\n                return this._audioInitialMetadataDispatched;\n            }\n            if (!this._hasAudio && this._hasVideo) {\n                // video only\n                return this._videoInitialMetadataDispatched;\n            }\n            return false;\n        }\n\n        // function parseChunks(chunk: ArrayBuffer, byteStart: number): number;\n\n    }, {\n        key: 'parseChunks',\n        value: function parseChunks(chunk, byteStart) {\n            if (!this._onError || !this._onMediaInfo || !this._onTrackMetadata || !this._onDataAvailable) {\n                throw new _exception.IllegalStateException('Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified');\n            }\n\n            var offset = 0;\n            var le = this._littleEndian;\n\n            if (byteStart === 0) {\n                // buffer with FLV header\n                if (chunk.byteLength > 13) {\n                    var probeData = FLVDemuxer.probe(chunk);\n                    offset = probeData.dataOffset;\n                } else {\n                    return 0;\n                }\n            }\n\n            if (this._firstParse) {\n                // handle PreviousTagSize0 before Tag1\n                this._firstParse = false;\n                if (byteStart + offset !== this._dataOffset) {\n                    _logger2.default.w(this.TAG, 'First time parsing but chunk byteStart invalid!');\n                }\n\n                var v = new DataView(chunk, offset);\n                var prevTagSize0 = v.getUint32(0, !le);\n                if (prevTagSize0 !== 0) {\n                    _logger2.default.w(this.TAG, 'PrevTagSize0 !== 0 !!!');\n                }\n                offset += 4;\n            }\n\n            while (offset < chunk.byteLength) {\n                this._dispatch = true;\n\n                var _v = new DataView(chunk, offset);\n\n                if (offset + 11 + 4 > chunk.byteLength) {\n                    // data not enough for parsing an flv tag\n                    break;\n                }\n\n                var tagType = _v.getUint8(0);\n                var dataSize = _v.getUint32(0, !le) & 0x00FFFFFF;\n\n                if (offset + 11 + dataSize + 4 > chunk.byteLength) {\n                    // data not enough for parsing actual data body\n                    break;\n                }\n\n                if (tagType !== 8 && tagType !== 9 && tagType !== 18) {\n                    _logger2.default.w(this.TAG, 'Unsupported tag type ' + tagType + ', skipped');\n                    // consume the whole tag (skip it)\n                    offset += 11 + dataSize + 4;\n                    continue;\n                }\n\n                var ts2 = _v.getUint8(4);\n                var ts1 = _v.getUint8(5);\n                var ts0 = _v.getUint8(6);\n                var ts3 = _v.getUint8(7);\n\n                var timestamp = ts0 | ts1 << 8 | ts2 << 16 | ts3 << 24;\n\n                var streamId = _v.getUint32(7, !le) & 0x00FFFFFF;\n                if (streamId !== 0) {\n                    _logger2.default.w(this.TAG, 'Meet tag which has StreamID != 0!');\n                }\n\n                var dataOffset = offset + 11;\n\n                switch (tagType) {\n                    case 8:\n                        // Audio\n                        this._parseAudioData(chunk, dataOffset, dataSize, timestamp);\n                        break;\n                    case 9:\n                        // Video\n                        if (this._onStreamTime != null) {\n                            this._onStreamTime(timestamp);\n                        }\n                        this._parseVideoData(chunk, dataOffset, dataSize, timestamp, byteStart + offset);\n                        break;\n                    case 18:\n                        // ScriptDataObject\n                        this._parseScriptData(chunk, dataOffset, dataSize);\n                        break;\n                }\n\n                var prevTagSize = _v.getUint32(11 + dataSize, !le);\n                if (prevTagSize !== 11 + dataSize) {\n                    _logger2.default.w(this.TAG, 'Invalid PrevTagSize ' + prevTagSize);\n                }\n\n                offset += 11 + dataSize + 4; // tagBody + dataSize + prevTagSize\n            }\n\n            // dispatch parsed frames to consumer (typically, the remuxer)\n            if (this._isInitialMetadataDispatched()) {\n                if (this._dispatch && (this._audioTrack.length || this._videoTrack.length)) {\n                    this._onDataAvailable(this._audioTrack, this._videoTrack);\n                }\n            }\n\n            return offset; // consumed bytes, just equals latest offset index\n        }\n    }, {\n        key: '_parseScriptData',\n        value: function _parseScriptData(arrayBuffer, dataOffset, dataSize) {\n            var scriptData = _amfParser2.default.parseScriptData(arrayBuffer, dataOffset, dataSize);\n\n            if (scriptData.hasOwnProperty('onMetaData')) {\n                if (scriptData.onMetaData == null || _typeof(scriptData.onMetaData) !== 'object') {\n                    _logger2.default.w(this.TAG, 'Invalid onMetaData structure!');\n                    return;\n                }\n                if (this._metadata) {\n                    _logger2.default.w(this.TAG, 'Found another onMetaData tag!');\n                }\n                this._metadata = scriptData;\n                var onMetaData = this._metadata.onMetaData;\n\n                if (this._onMetaDataArrived) {\n                    this._onMetaDataArrived(Object.assign({}, onMetaData));\n                }\n\n                if (typeof onMetaData.hasAudio === 'boolean') {\n                    // hasAudio\n                    if (this._hasAudioFlagOverrided === false) {\n                        this._hasAudio = onMetaData.hasAudio;\n                        this._mediaInfo.hasAudio = this._hasAudio;\n                    }\n                }\n                if (typeof onMetaData.hasVideo === 'boolean') {\n                    // hasVideo\n                    if (this._hasVideoFlagOverrided === false) {\n                        this._hasVideo = onMetaData.hasVideo;\n                        this._mediaInfo.hasVideo = this._hasVideo;\n                    }\n                }\n                if (typeof onMetaData.audiodatarate === 'number') {\n                    // audiodatarate\n                    this._mediaInfo.audioDataRate = onMetaData.audiodatarate;\n                }\n                if (typeof onMetaData.videodatarate === 'number') {\n                    // videodatarate\n                    this._mediaInfo.videoDataRate = onMetaData.videodatarate;\n                }\n                if (typeof onMetaData.width === 'number') {\n                    // width\n                    this._mediaInfo.width = onMetaData.width;\n                }\n                if (typeof onMetaData.height === 'number') {\n                    // height\n                    this._mediaInfo.height = onMetaData.height;\n                }\n                if (typeof onMetaData.duration === 'number') {\n                    // duration\n                    if (!this._durationOverrided) {\n                        var duration = Math.floor(onMetaData.duration * this._timescale);\n                        this._duration = duration;\n                        this._mediaInfo.duration = duration;\n                    }\n                } else {\n                    this._mediaInfo.duration = 0;\n                }\n                if (typeof onMetaData.framerate === 'number') {\n                    // framerate\n                    var fps_num = Math.floor(onMetaData.framerate * 1000);\n                    if (fps_num > 0) {\n                        var fps = fps_num / 1000;\n                        this._referenceFrameRate.fixed = true;\n                        this._referenceFrameRate.fps = fps;\n                        this._referenceFrameRate.fps_num = fps_num;\n                        this._referenceFrameRate.fps_den = 1000;\n                        this._mediaInfo.fps = fps;\n                    }\n                }\n                if (_typeof(onMetaData.keyframes) === 'object') {\n                    // keyframes\n                    this._mediaInfo.hasKeyframesIndex = true;\n                    var keyframes = onMetaData.keyframes;\n                    this._mediaInfo.keyframesIndex = this._parseKeyframesIndex(keyframes);\n                    onMetaData.keyframes = null; // keyframes has been extracted, remove it\n                } else {\n                    this._mediaInfo.hasKeyframesIndex = false;\n                }\n                this._dispatch = false;\n                this._mediaInfo.metadata = onMetaData;\n                _logger2.default.v(this.TAG, 'Parsed onMetaData');\n                if (this._mediaInfo.isComplete()) {\n                    this._onMediaInfo(this._mediaInfo);\n                }\n            }\n\n            if (Object.keys(scriptData).length > 0) {\n                if (this._onScriptDataArrived) {\n                    this._onScriptDataArrived(Object.assign({}, scriptData));\n                }\n            }\n        }\n    }, {\n        key: '_parseKeyframesIndex',\n        value: function _parseKeyframesIndex(keyframes) {\n            var times = [];\n            var filepositions = [];\n\n            // ignore first keyframe which is actually AVC Sequence Header (AVCDecoderConfigurationRecord)\n            for (var i = 1; i < keyframes.times.length; i++) {\n                var time = this._timestampBase + Math.floor(keyframes.times[i] * 1000);\n                times.push(time);\n                filepositions.push(keyframes.filepositions[i]);\n            }\n\n            return {\n                times: times,\n                filepositions: filepositions\n            };\n        }\n    }, {\n        key: '_parseAudioData',\n        value: function _parseAudioData(arrayBuffer, dataOffset, dataSize, tagTimestamp) {\n            if (dataSize <= 1) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid audio packet, missing SoundData payload!');\n                return;\n            }\n\n            if (this._hasAudioFlagOverrided === true && this._hasAudio === false) {\n                // If hasAudio: false indicated explicitly in MediaDataSource,\n                // Ignore all the audio packets\n                return;\n            }\n\n            var le = this._littleEndian;\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n            var soundSpec = v.getUint8(0);\n\n            var soundFormat = soundSpec >>> 4;\n            if (soundFormat !== 2 && soundFormat !== 10) {\n                // MP3 or AAC\n                this._onError(_demuxErrors2.default.CODEC_UNSUPPORTED, 'Flv: Unsupported audio codec idx: ' + soundFormat);\n                return;\n            }\n\n            var soundRate = 0;\n            var soundRateIndex = (soundSpec & 12) >>> 2;\n            if (soundRateIndex >= 0 && soundRateIndex <= 4) {\n                soundRate = this._flvSoundRateTable[soundRateIndex];\n            } else {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid audio sample rate idx: ' + soundRateIndex);\n                return;\n            }\n\n            var soundSize = (soundSpec & 2) >>> 1; // unused\n            var soundType = soundSpec & 1;\n\n            var meta = this._audioMetadata;\n            var track = this._audioTrack;\n\n            if (!meta) {\n                if (this._hasAudio === false && this._hasAudioFlagOverrided === false) {\n                    this._hasAudio = true;\n                    this._mediaInfo.hasAudio = true;\n                }\n\n                // initial metadata\n                meta = this._audioMetadata = {};\n                meta.type = 'audio';\n                meta.id = track.id;\n                meta.timescale = this._timescale;\n                meta.duration = this._duration;\n                meta.audioSampleRate = soundRate;\n                meta.channelCount = soundType === 0 ? 1 : 2;\n            }\n\n            if (soundFormat === 10) {\n                // AAC\n                var aacData = this._parseAACAudioData(arrayBuffer, dataOffset + 1, dataSize - 1);\n                if (aacData == undefined) {\n                    return;\n                }\n\n                if (aacData.packetType === 0) {\n                    // AAC sequence header (AudioSpecificConfig)\n                    if (meta.config) {\n                        _logger2.default.w(this.TAG, 'Found another AudioSpecificConfig!');\n                    }\n                    var misc = aacData.data;\n                    meta.audioSampleRate = misc.samplingRate;\n                    meta.channelCount = misc.channelCount;\n                    meta.codec = misc.codec;\n                    meta.originalCodec = misc.originalCodec;\n                    meta.config = misc.config;\n                    // The decode result of an aac sample is 1024 PCM samples\n                    meta.refSampleDuration = 1024 / meta.audioSampleRate * meta.timescale;\n                    _logger2.default.v(this.TAG, 'Parsed AudioSpecificConfig');\n\n                    if (this._isInitialMetadataDispatched()) {\n                        // Non-initial metadata, force dispatch (or flush) parsed frames to remuxer\n                        if (this._dispatch && (this._audioTrack.length || this._videoTrack.length)) {\n                            this._onDataAvailable(this._audioTrack, this._videoTrack);\n                        }\n                    } else {\n                        this._audioInitialMetadataDispatched = true;\n                    }\n                    // then notify new metadata\n                    this._dispatch = false;\n                    this._onTrackMetadata('audio', meta);\n\n                    var mi = this._mediaInfo;\n                    mi.audioCodec = meta.originalCodec;\n                    mi.audioSampleRate = meta.audioSampleRate;\n                    mi.audioChannelCount = meta.channelCount;\n                    if (mi.hasVideo) {\n                        if (mi.videoCodec != null) {\n                            mi.mimeType = 'video/x-flv; codecs=\"' + mi.videoCodec + ',' + mi.audioCodec + '\"';\n                        }\n                    } else {\n                        mi.mimeType = 'video/x-flv; codecs=\"' + mi.audioCodec + '\"';\n                    }\n                    if (mi.isComplete()) {\n                        this._onMediaInfo(mi);\n                    }\n                } else if (aacData.packetType === 1) {\n                    // AAC raw frame data\n                    var dts = this._timestampBase + tagTimestamp;\n                    var aacSample = { unit: aacData.data, length: aacData.data.byteLength, dts: dts, pts: dts };\n                    track.samples.push(aacSample);\n                    track.length += aacData.data.length;\n                } else {\n                    _logger2.default.e(this.TAG, 'Flv: Unsupported AAC data type ' + aacData.packetType);\n                }\n            } else if (soundFormat === 2) {\n                // MP3\n                if (!meta.codec) {\n                    // We need metadata for mp3 audio track, extract info from frame header\n                    var _misc = this._parseMP3AudioData(arrayBuffer, dataOffset + 1, dataSize - 1, true);\n                    if (_misc == undefined) {\n                        return;\n                    }\n                    meta.audioSampleRate = _misc.samplingRate;\n                    meta.channelCount = _misc.channelCount;\n                    meta.codec = _misc.codec;\n                    meta.originalCodec = _misc.originalCodec;\n                    // The decode result of an mp3 sample is 1152 PCM samples\n                    meta.refSampleDuration = 1152 / meta.audioSampleRate * meta.timescale;\n                    _logger2.default.v(this.TAG, 'Parsed MPEG Audio Frame Header');\n\n                    this._audioInitialMetadataDispatched = true;\n                    this._onTrackMetadata('audio', meta);\n\n                    var _mi = this._mediaInfo;\n                    _mi.audioCodec = meta.codec;\n                    _mi.audioSampleRate = meta.audioSampleRate;\n                    _mi.audioChannelCount = meta.channelCount;\n                    _mi.audioDataRate = _misc.bitRate;\n                    if (_mi.hasVideo) {\n                        if (_mi.videoCodec != null) {\n                            _mi.mimeType = 'video/x-flv; codecs=\"' + _mi.videoCodec + ',' + _mi.audioCodec + '\"';\n                        }\n                    } else {\n                        _mi.mimeType = 'video/x-flv; codecs=\"' + _mi.audioCodec + '\"';\n                    }\n                    if (_mi.isComplete()) {\n                        this._onMediaInfo(_mi);\n                    }\n                }\n\n                // This packet is always a valid audio packet, extract it\n                var data = this._parseMP3AudioData(arrayBuffer, dataOffset + 1, dataSize - 1, false);\n                if (data == undefined) {\n                    return;\n                }\n                var _dts = this._timestampBase + tagTimestamp;\n                var mp3Sample = { unit: data, length: data.byteLength, dts: _dts, pts: _dts };\n                track.samples.push(mp3Sample);\n                track.length += data.length;\n            }\n        }\n    }, {\n        key: '_parseAACAudioData',\n        value: function _parseAACAudioData(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize <= 1) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid AAC packet, missing AACPacketType or/and Data!');\n                return;\n            }\n\n            var result = {};\n            var array = new Uint8Array(arrayBuffer, dataOffset, dataSize);\n\n            result.packetType = array[0];\n\n            if (array[0] === 0) {\n                result.data = this._parseAACAudioSpecificConfig(arrayBuffer, dataOffset + 1, dataSize - 1);\n            } else {\n                result.data = array.subarray(1);\n            }\n\n            return result;\n        }\n    }, {\n        key: '_parseAACAudioSpecificConfig',\n        value: function _parseAACAudioSpecificConfig(arrayBuffer, dataOffset, dataSize) {\n            var array = new Uint8Array(arrayBuffer, dataOffset, dataSize);\n            var config = null;\n\n            /* Audio Object Type:\r\n               0: Null\r\n               1: AAC Main\r\n               2: AAC LC\r\n               3: AAC SSR (Scalable Sample Rate)\r\n               4: AAC LTP (Long Term Prediction)\r\n               5: HE-AAC / SBR (Spectral Band Replication)\r\n               6: AAC Scalable\r\n            */\n\n            var audioObjectType = 0;\n            var originalAudioObjectType = 0;\n            var audioExtensionObjectType = null;\n            var samplingIndex = 0;\n            var extensionSamplingIndex = null;\n\n            // 5 bits\n            audioObjectType = originalAudioObjectType = array[0] >>> 3;\n            // 4 bits\n            samplingIndex = (array[0] & 0x07) << 1 | array[1] >>> 7;\n            if (samplingIndex < 0 || samplingIndex >= this._mpegSamplingRates.length) {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: AAC invalid sampling frequency index!');\n                return;\n            }\n\n            var samplingFrequence = this._mpegSamplingRates[samplingIndex];\n\n            // 4 bits\n            var channelConfig = (array[1] & 0x78) >>> 3;\n            if (channelConfig < 0 || channelConfig >= 8) {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: AAC invalid channel configuration');\n                return;\n            }\n\n            if (audioObjectType === 5) {\n                // HE-AAC?\n                // 4 bits\n                extensionSamplingIndex = (array[1] & 0x07) << 1 | array[2] >>> 7;\n                // 5 bits\n                audioExtensionObjectType = (array[2] & 0x7C) >>> 2;\n            }\n\n            // workarounds for various browsers\n            var userAgent = self.navigator.userAgent.toLowerCase();\n\n            if (userAgent.indexOf('firefox') !== -1) {\n                // firefox: use SBR (HE-AAC) if freq less than 24kHz\n                if (samplingIndex >= 6) {\n                    audioObjectType = 5;\n                    config = new Array(4);\n                    extensionSamplingIndex = samplingIndex - 3;\n                } else {\n                    // use LC-AAC\n                    audioObjectType = 2;\n                    config = new Array(2);\n                    extensionSamplingIndex = samplingIndex;\n                }\n            } else if (userAgent.indexOf('android') !== -1) {\n                // android: always use LC-AAC\n                audioObjectType = 2;\n                config = new Array(2);\n                extensionSamplingIndex = samplingIndex;\n            } else {\n                // for other browsers, e.g. chrome...\n                // Always use HE-AAC to make it easier to switch aac codec profile\n                audioObjectType = 5;\n                extensionSamplingIndex = samplingIndex;\n                config = new Array(4);\n\n                if (samplingIndex >= 6) {\n                    extensionSamplingIndex = samplingIndex - 3;\n                } else if (channelConfig === 1) {\n                    // Mono channel\n                    audioObjectType = 2;\n                    config = new Array(2);\n                    extensionSamplingIndex = samplingIndex;\n                }\n            }\n\n            config[0] = audioObjectType << 3;\n            config[0] |= (samplingIndex & 0x0F) >>> 1;\n            config[1] = (samplingIndex & 0x0F) << 7;\n            config[1] |= (channelConfig & 0x0F) << 3;\n            if (audioObjectType === 5) {\n                config[1] |= (extensionSamplingIndex & 0x0F) >>> 1;\n                config[2] = (extensionSamplingIndex & 0x01) << 7;\n                // extended audio object type: force to 2 (LC-AAC)\n                config[2] |= 2 << 2;\n                config[3] = 0;\n            }\n\n            return {\n                config: config,\n                samplingRate: samplingFrequence,\n                channelCount: channelConfig,\n                codec: 'mp4a.40.' + audioObjectType,\n                originalCodec: 'mp4a.40.' + originalAudioObjectType\n            };\n        }\n    }, {\n        key: '_parseMP3AudioData',\n        value: function _parseMP3AudioData(arrayBuffer, dataOffset, dataSize, requestHeader) {\n            if (dataSize < 4) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid MP3 packet, header missing!');\n                return;\n            }\n\n            var le = this._littleEndian;\n            var array = new Uint8Array(arrayBuffer, dataOffset, dataSize);\n            var result = null;\n\n            if (requestHeader) {\n                if (array[0] !== 0xFF) {\n                    return;\n                }\n                var ver = array[1] >>> 3 & 0x03;\n                var layer = (array[1] & 0x06) >> 1;\n\n                var bitrate_index = (array[2] & 0xF0) >>> 4;\n                var sampling_freq_index = (array[2] & 0x0C) >>> 2;\n\n                var channel_mode = array[3] >>> 6 & 0x03;\n                var channel_count = channel_mode !== 3 ? 2 : 1;\n\n                var sample_rate = 0;\n                var bit_rate = 0;\n                var object_type = 34; // Layer-3, listed in MPEG-4 Audio Object Types\n\n                var codec = 'mp3';\n\n                switch (ver) {\n                    case 0:\n                        // MPEG 2.5\n                        sample_rate = this._mpegAudioV25SampleRateTable[sampling_freq_index];\n                        break;\n                    case 2:\n                        // MPEG 2\n                        sample_rate = this._mpegAudioV20SampleRateTable[sampling_freq_index];\n                        break;\n                    case 3:\n                        // MPEG 1\n                        sample_rate = this._mpegAudioV10SampleRateTable[sampling_freq_index];\n                        break;\n                }\n\n                switch (layer) {\n                    case 1:\n                        // Layer 3\n                        object_type = 34;\n                        if (bitrate_index < this._mpegAudioL3BitRateTable.length) {\n                            bit_rate = this._mpegAudioL3BitRateTable[bitrate_index];\n                        }\n                        break;\n                    case 2:\n                        // Layer 2\n                        object_type = 33;\n                        if (bitrate_index < this._mpegAudioL2BitRateTable.length) {\n                            bit_rate = this._mpegAudioL2BitRateTable[bitrate_index];\n                        }\n                        break;\n                    case 3:\n                        // Layer 1\n                        object_type = 32;\n                        if (bitrate_index < this._mpegAudioL1BitRateTable.length) {\n                            bit_rate = this._mpegAudioL1BitRateTable[bitrate_index];\n                        }\n                        break;\n                }\n\n                result = {\n                    bitRate: bit_rate,\n                    samplingRate: sample_rate,\n                    channelCount: channel_count,\n                    codec: codec,\n                    originalCodec: codec\n                };\n            } else {\n                result = array;\n            }\n\n            return result;\n        }\n    }, {\n        key: '_parseVideoData',\n        value: function _parseVideoData(arrayBuffer, dataOffset, dataSize, tagTimestamp, tagPosition) {\n            if (dataSize <= 1) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid video packet, missing VideoData payload!');\n                return;\n            }\n\n            if (this._hasVideoFlagOverrided === true && this._hasVideo === false) {\n                // If hasVideo: false indicated explicitly in MediaDataSource,\n                // Ignore all the video packets\n                return;\n            }\n\n            var spec = new Uint8Array(arrayBuffer, dataOffset, dataSize)[0];\n\n            var frameType = (spec & 240) >>> 4;\n            var codecId = spec & 15;\n\n            if (codecId !== 7) {\n                this._onError(_demuxErrors2.default.CODEC_UNSUPPORTED, 'Flv: Unsupported codec in video frame: ' + codecId);\n                return;\n            }\n\n            this._parseAVCVideoPacket(arrayBuffer, dataOffset + 1, dataSize - 1, tagTimestamp, tagPosition, frameType);\n        }\n    }, {\n        key: '_parseAVCVideoPacket',\n        value: function _parseAVCVideoPacket(arrayBuffer, dataOffset, dataSize, tagTimestamp, tagPosition, frameType) {\n            if (dataSize < 4) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime');\n                return;\n            }\n\n            var le = this._littleEndian;\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n            var packetType = v.getUint8(0);\n            var cts_unsigned = v.getUint32(0, !le) & 0x00FFFFFF;\n            var cts = cts_unsigned << 8 >> 8; // convert to 24-bit signed int\n\n            if (packetType === 0) {\n                // AVCDecoderConfigurationRecord\n                this._parseAVCDecoderConfigurationRecord(arrayBuffer, dataOffset + 4, dataSize - 4);\n            } else if (packetType === 1) {\n                // One or more Nalus\n                this._parseAVCVideoData(arrayBuffer, dataOffset + 4, dataSize - 4, tagTimestamp, tagPosition, frameType, cts);\n            } else if (packetType === 2) {\n                // empty, AVC end of sequence\n            } else {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid video packet type ' + packetType);\n                return;\n            }\n        }\n    }, {\n        key: '_parseAVCDecoderConfigurationRecord',\n        value: function _parseAVCDecoderConfigurationRecord(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 7) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid AVCDecoderConfigurationRecord, lack of data!');\n                return;\n            }\n\n            var meta = this._videoMetadata;\n            var track = this._videoTrack;\n            var le = this._littleEndian;\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n            if (!meta) {\n                if (this._hasVideo === false && this._hasVideoFlagOverrided === false) {\n                    this._hasVideo = true;\n                    this._mediaInfo.hasVideo = true;\n                }\n\n                meta = this._videoMetadata = {};\n                meta.type = 'video';\n                meta.id = track.id;\n                meta.timescale = this._timescale;\n                meta.duration = this._duration;\n            } else {\n                if (typeof meta.avcc !== 'undefined') {\n                    _logger2.default.w(this.TAG, 'Found another AVCDecoderConfigurationRecord!');\n                }\n            }\n\n            var version = v.getUint8(0); // configurationVersion\n            var avcProfile = v.getUint8(1); // avcProfileIndication\n            var profileCompatibility = v.getUint8(2); // profile_compatibility\n            var avcLevel = v.getUint8(3); // AVCLevelIndication\n\n            if (version !== 1 || avcProfile === 0) {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid AVCDecoderConfigurationRecord');\n                return;\n            }\n\n            this._naluLengthSize = (v.getUint8(4) & 3) + 1; // lengthSizeMinusOne\n            if (this._naluLengthSize !== 3 && this._naluLengthSize !== 4) {\n                // holy shit!!!\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Strange NaluLengthSizeMinusOne: ' + (this._naluLengthSize - 1));\n                return;\n            }\n\n            var spsCount = v.getUint8(5) & 31; // numOfSequenceParameterSets\n            if (spsCount === 0) {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid AVCDecoderConfigurationRecord: No SPS');\n                return;\n            } else if (spsCount > 1) {\n                _logger2.default.w(this.TAG, 'Flv: Strange AVCDecoderConfigurationRecord: SPS Count = ' + spsCount);\n            }\n\n            var offset = 6;\n\n            for (var i = 0; i < spsCount; i++) {\n                var len = v.getUint16(offset, !le); // sequenceParameterSetLength\n                offset += 2;\n\n                if (len === 0) {\n                    continue;\n                }\n\n                // Notice: Nalu without startcode header (00 00 00 01)\n                var sps = new Uint8Array(arrayBuffer, dataOffset + offset, len);\n                offset += len;\n\n                var config = _spsParser2.default.parseSPS(sps);\n                if (i !== 0) {\n                    // ignore other sps's config\n                    continue;\n                }\n\n                meta.codecWidth = config.codec_size.width;\n                meta.codecHeight = config.codec_size.height;\n                meta.presentWidth = config.present_size.width;\n                meta.presentHeight = config.present_size.height;\n\n                meta.profile = config.profile_string;\n                meta.level = config.level_string;\n                meta.bitDepth = config.bit_depth;\n                meta.chromaFormat = config.chroma_format;\n                meta.sarRatio = config.sar_ratio;\n                meta.frameRate = config.frame_rate;\n\n                if (config.frame_rate.fixed === false || config.frame_rate.fps_num === 0 || config.frame_rate.fps_den === 0) {\n                    meta.frameRate = this._referenceFrameRate;\n                }\n\n                var fps_den = meta.frameRate.fps_den;\n                var fps_num = meta.frameRate.fps_num;\n                meta.refSampleDuration = meta.timescale * (fps_den / fps_num);\n\n                var codecArray = sps.subarray(1, 4);\n                var codecString = 'avc1.';\n                for (var j = 0; j < 3; j++) {\n                    var h = codecArray[j].toString(16);\n                    if (h.length < 2) {\n                        h = '0' + h;\n                    }\n                    codecString += h;\n                }\n                meta.codec = codecString;\n\n                var mi = this._mediaInfo;\n                mi.width = meta.codecWidth;\n                mi.height = meta.codecHeight;\n                mi.fps = meta.frameRate.fps;\n                mi.profile = meta.profile;\n                mi.level = meta.level;\n                mi.refFrames = config.ref_frames;\n                mi.chromaFormat = config.chroma_format_string;\n                mi.sarNum = meta.sarRatio.width;\n                mi.sarDen = meta.sarRatio.height;\n                mi.videoCodec = codecString;\n\n                if (mi.hasAudio) {\n                    if (mi.audioCodec != null) {\n                        mi.mimeType = 'video/x-flv; codecs=\"' + mi.videoCodec + ',' + mi.audioCodec + '\"';\n                    }\n                } else {\n                    mi.mimeType = 'video/x-flv; codecs=\"' + mi.videoCodec + '\"';\n                }\n                if (mi.isComplete()) {\n                    this._onMediaInfo(mi);\n                }\n            }\n\n            var ppsCount = v.getUint8(offset); // numOfPictureParameterSets\n            if (ppsCount === 0) {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid AVCDecoderConfigurationRecord: No PPS');\n                return;\n            } else if (ppsCount > 1) {\n                _logger2.default.w(this.TAG, 'Flv: Strange AVCDecoderConfigurationRecord: PPS Count = ' + ppsCount);\n            }\n\n            offset++;\n\n            for (var _i = 0; _i < ppsCount; _i++) {\n                var _len = v.getUint16(offset, !le); // pictureParameterSetLength\n                offset += 2;\n\n                if (_len === 0) {\n                    continue;\n                }\n\n                // pps is useless for extracting video information\n                offset += _len;\n            }\n\n            meta.avcc = new Uint8Array(dataSize);\n            meta.avcc.set(new Uint8Array(arrayBuffer, dataOffset, dataSize), 0);\n            _logger2.default.v(this.TAG, 'Parsed AVCDecoderConfigurationRecord');\n\n            if (this._isInitialMetadataDispatched()) {\n                // flush parsed frames\n                if (this._dispatch && (this._audioTrack.length || this._videoTrack.length)) {\n                    this._onDataAvailable(this._audioTrack, this._videoTrack);\n                }\n            } else {\n                this._videoInitialMetadataDispatched = true;\n            }\n            // notify new metadata\n            this._dispatch = false;\n            this._onTrackMetadata('video', meta);\n        }\n    }, {\n        key: '_parseAVCVideoData',\n        value: function _parseAVCVideoData(arrayBuffer, dataOffset, dataSize, tagTimestamp, tagPosition, frameType, cts) {\n            var le = this._littleEndian;\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n            var units = [],\n                length = 0;\n\n            var offset = 0;\n            var lengthSize = this._naluLengthSize;\n            var dts = this._timestampBase + tagTimestamp;\n            var keyframe = frameType === 1; // from FLV Frame Type constants\n\n            while (offset < dataSize) {\n                if (offset + 4 >= dataSize) {\n                    _logger2.default.w(this.TAG, 'Malformed Nalu near timestamp ' + dts + ', offset = ' + offset + ', dataSize = ' + dataSize);\n                    break; // data not enough for next Nalu\n                }\n                // Nalu with length-header (AVC1)\n                var naluSize = v.getUint32(offset, !le); // Big-Endian read\n                if (lengthSize === 3) {\n                    naluSize >>>= 8;\n                }\n                if (naluSize > dataSize - lengthSize) {\n                    _logger2.default.w(this.TAG, 'Malformed Nalus near timestamp ' + dts + ', NaluSize > DataSize!');\n                    return;\n                }\n\n                var unitType = v.getUint8(offset + lengthSize) & 0x1F;\n\n                if (unitType === 5) {\n                    // IDR\n                    keyframe = true;\n                }\n\n                var data = new Uint8Array(arrayBuffer, dataOffset + offset, lengthSize + naluSize);\n                var unit = { type: unitType, data: data };\n                units.push(unit);\n                length += data.byteLength;\n\n                offset += lengthSize + naluSize;\n            }\n\n            if (units.length) {\n                var track = this._videoTrack;\n                var avcSample = {\n                    units: units,\n                    length: length,\n                    isKeyframe: keyframe,\n                    dts: dts,\n                    cts: cts,\n                    pts: dts + cts\n                };\n                if (keyframe) {\n                    avcSample.fileposition = tagPosition;\n                }\n                track.samples.push(avcSample);\n                track.length += length;\n            }\n        }\n    }, {\n        key: 'onTrackMetadata',\n        get: function get() {\n            return this._onTrackMetadata;\n        },\n        set: function set(callback) {\n            this._onTrackMetadata = callback;\n        }\n\n        // prototype: function(mediaInfo: MediaInfo): void\n\n    }, {\n        key: 'onMediaInfo',\n        get: function get() {\n            return this._onMediaInfo;\n        },\n        set: function set(callback) {\n            this._onMediaInfo = callback;\n        }\n    }, {\n        key: 'onMetaDataArrived',\n        get: function get() {\n            return this._onMetaDataArrived;\n        },\n        set: function set(callback) {\n            this._onMetaDataArrived = callback;\n        }\n    }, {\n        key: 'onScriptDataArrived',\n        get: function get() {\n            return this._onScriptDataArrived;\n        },\n        set: function set(callback) {\n            this._onScriptDataArrived = callback;\n        }\n\n        // prototype: function(type: number, info: string): void\n\n    }, {\n        key: 'onError',\n        get: function get() {\n            return this._onError;\n        },\n        set: function set(callback) {\n            this._onError = callback;\n        }\n\n        // prototype: function(videoTrack: any, audioTrack: any): void\n\n    }, {\n        key: 'onDataAvailable',\n        get: function get() {\n            return this._onDataAvailable;\n        },\n        set: function set(callback) {\n            this._onDataAvailable = callback;\n        }\n    }, {\n        key: 'onStreamTime',\n        get: function get() {\n            return this._onStreamTime;\n        },\n        set: function set(callback) {\n            this._onStreamTime = callback;\n        }\n\n        // timestamp base for output samples, must be in milliseconds\n\n    }, {\n        key: 'timestampBase',\n        get: function get() {\n            return this._timestampBase;\n        },\n        set: function set(base) {\n            this._timestampBase = base;\n        }\n    }, {\n        key: 'overridedDuration',\n        get: function get() {\n            return this._duration;\n        }\n\n        // Force-override media duration. Must be in milliseconds, int32\n        ,\n        set: function set(duration) {\n            this._durationOverrided = true;\n            this._duration = duration;\n            this._mediaInfo.duration = duration;\n        }\n\n        // Force-override audio track present flag, boolean\n\n    }, {\n        key: 'overridedHasAudio',\n        set: function set(hasAudio) {\n            this._hasAudioFlagOverrided = true;\n            this._hasAudio = hasAudio;\n            this._mediaInfo.hasAudio = hasAudio;\n        }\n\n        // Force-override video track present flag, boolean\n\n    }, {\n        key: 'overridedHasVideo',\n        set: function set(hasVideo) {\n            this._hasVideoFlagOverrided = true;\n            this._hasVideo = hasVideo;\n            this._mediaInfo.hasVideo = hasVideo;\n        }\n    }], [{\n        key: 'probe',\n        value: function probe(buffer) {\n            var data = new Uint8Array(buffer);\n            var mismatch = { match: false };\n\n            if (data[0] !== 0x46 || data[1] !== 0x4C || data[2] !== 0x56 || data[3] !== 0x01) {\n                return mismatch;\n            }\n\n            var hasAudio = (data[4] & 4) >>> 2 !== 0;\n            var hasVideo = (data[4] & 1) !== 0;\n\n            var offset = ReadBig32(data, 5);\n\n            if (offset < 9) {\n                return mismatch;\n            }\n\n            return {\n                match: true,\n                consumed: offset,\n                dataOffset: offset,\n                hasAudioTrack: hasAudio,\n                hasVideoTrack: hasVideo\n            };\n        }\n    }]);\n\n    return FLVDemuxer;\n}();\n\nexports.default = FLVDemuxer;\n\n},{\"../core/media-info.js\":7,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./amf-parser.js\":15,\"./demux-errors.js\":16,\"./sps-parser.js\":19}],19:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _expGolomb = _dereq_('./exp-golomb.js');\n\nvar _expGolomb2 = _interopRequireDefault(_expGolomb);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar SPSParser = function () {\n    function SPSParser() {\n        _classCallCheck(this, SPSParser);\n    }\n\n    _createClass(SPSParser, null, [{\n        key: '_ebsp2rbsp',\n        value: function _ebsp2rbsp(uint8array) {\n            var src = uint8array;\n            var src_length = src.byteLength;\n            var dst = new Uint8Array(src_length);\n            var dst_idx = 0;\n\n            for (var i = 0; i < src_length; i++) {\n                if (i >= 2) {\n                    // Unescape: Skip 0x03 after 00 00\n                    if (src[i] === 0x03 && src[i - 1] === 0x00 && src[i - 2] === 0x00) {\n                        continue;\n                    }\n                }\n                dst[dst_idx] = src[i];\n                dst_idx++;\n            }\n\n            return new Uint8Array(dst.buffer, 0, dst_idx);\n        }\n    }, {\n        key: 'parseSPS',\n        value: function parseSPS(uint8array) {\n            var rbsp = SPSParser._ebsp2rbsp(uint8array);\n            var gb = new _expGolomb2.default(rbsp);\n\n            gb.readByte();\n            var profile_idc = gb.readByte(); // profile_idc\n            gb.readByte(); // constraint_set_flags[5] + reserved_zero[3]\n            var level_idc = gb.readByte(); // level_idc\n            gb.readUEG(); // seq_parameter_set_id\n\n            var profile_string = SPSParser.getProfileString(profile_idc);\n            var level_string = SPSParser.getLevelString(level_idc);\n            var chroma_format_idc = 1;\n            var chroma_format = 420;\n            var chroma_format_table = [0, 420, 422, 444];\n            var bit_depth = 8;\n\n            if (profile_idc === 100 || profile_idc === 110 || profile_idc === 122 || profile_idc === 244 || profile_idc === 44 || profile_idc === 83 || profile_idc === 86 || profile_idc === 118 || profile_idc === 128 || profile_idc === 138 || profile_idc === 144) {\n\n                chroma_format_idc = gb.readUEG();\n                if (chroma_format_idc === 3) {\n                    gb.readBits(1); // separate_colour_plane_flag\n                }\n                if (chroma_format_idc <= 3) {\n                    chroma_format = chroma_format_table[chroma_format_idc];\n                }\n\n                bit_depth = gb.readUEG() + 8; // bit_depth_luma_minus8\n                gb.readUEG(); // bit_depth_chroma_minus8\n                gb.readBits(1); // qpprime_y_zero_transform_bypass_flag\n                if (gb.readBool()) {\n                    // seq_scaling_matrix_present_flag\n                    var scaling_list_count = chroma_format_idc !== 3 ? 8 : 12;\n                    for (var i = 0; i < scaling_list_count; i++) {\n                        if (gb.readBool()) {\n                            // seq_scaling_list_present_flag\n                            if (i < 6) {\n                                SPSParser._skipScalingList(gb, 16);\n                            } else {\n                                SPSParser._skipScalingList(gb, 64);\n                            }\n                        }\n                    }\n                }\n            }\n            gb.readUEG(); // log2_max_frame_num_minus4\n            var pic_order_cnt_type = gb.readUEG();\n            if (pic_order_cnt_type === 0) {\n                gb.readUEG(); // log2_max_pic_order_cnt_lsb_minus_4\n            } else if (pic_order_cnt_type === 1) {\n                gb.readBits(1); // delta_pic_order_always_zero_flag\n                gb.readSEG(); // offset_for_non_ref_pic\n                gb.readSEG(); // offset_for_top_to_bottom_field\n                var num_ref_frames_in_pic_order_cnt_cycle = gb.readUEG();\n                for (var _i = 0; _i < num_ref_frames_in_pic_order_cnt_cycle; _i++) {\n                    gb.readSEG(); // offset_for_ref_frame\n                }\n            }\n            var ref_frames = gb.readUEG(); // max_num_ref_frames\n            gb.readBits(1); // gaps_in_frame_num_value_allowed_flag\n\n            var pic_width_in_mbs_minus1 = gb.readUEG();\n            var pic_height_in_map_units_minus1 = gb.readUEG();\n\n            var frame_mbs_only_flag = gb.readBits(1);\n            if (frame_mbs_only_flag === 0) {\n                gb.readBits(1); // mb_adaptive_frame_field_flag\n            }\n            gb.readBits(1); // direct_8x8_inference_flag\n\n            var frame_crop_left_offset = 0;\n            var frame_crop_right_offset = 0;\n            var frame_crop_top_offset = 0;\n            var frame_crop_bottom_offset = 0;\n\n            var frame_cropping_flag = gb.readBool();\n            if (frame_cropping_flag) {\n                frame_crop_left_offset = gb.readUEG();\n                frame_crop_right_offset = gb.readUEG();\n                frame_crop_top_offset = gb.readUEG();\n                frame_crop_bottom_offset = gb.readUEG();\n            }\n\n            var sar_width = 1,\n                sar_height = 1;\n            var fps = 0,\n                fps_fixed = true,\n                fps_num = 0,\n                fps_den = 0;\n\n            var vui_parameters_present_flag = gb.readBool();\n            if (vui_parameters_present_flag) {\n                if (gb.readBool()) {\n                    // aspect_ratio_info_present_flag\n                    var aspect_ratio_idc = gb.readByte();\n                    var sar_w_table = [1, 12, 10, 16, 40, 24, 20, 32, 80, 18, 15, 64, 160, 4, 3, 2];\n                    var sar_h_table = [1, 11, 11, 11, 33, 11, 11, 11, 33, 11, 11, 33, 99, 3, 2, 1];\n\n                    if (aspect_ratio_idc > 0 && aspect_ratio_idc < 16) {\n                        sar_width = sar_w_table[aspect_ratio_idc - 1];\n                        sar_height = sar_h_table[aspect_ratio_idc - 1];\n                    } else if (aspect_ratio_idc === 255) {\n                        sar_width = gb.readByte() << 8 | gb.readByte();\n                        sar_height = gb.readByte() << 8 | gb.readByte();\n                    }\n                }\n\n                if (gb.readBool()) {\n                    // overscan_info_present_flag\n                    gb.readBool(); // overscan_appropriate_flag\n                }\n                if (gb.readBool()) {\n                    // video_signal_type_present_flag\n                    gb.readBits(4); // video_format & video_full_range_flag\n                    if (gb.readBool()) {\n                        // colour_description_present_flag\n                        gb.readBits(24); // colour_primaries & transfer_characteristics & matrix_coefficients\n                    }\n                }\n                if (gb.readBool()) {\n                    // chroma_loc_info_present_flag\n                    gb.readUEG(); // chroma_sample_loc_type_top_field\n                    gb.readUEG(); // chroma_sample_loc_type_bottom_field\n                }\n                if (gb.readBool()) {\n                    // timing_info_present_flag\n                    var num_units_in_tick = gb.readBits(32);\n                    var time_scale = gb.readBits(32);\n                    fps_fixed = gb.readBool(); // fixed_frame_rate_flag\n\n                    fps_num = time_scale;\n                    fps_den = num_units_in_tick * 2;\n                    fps = fps_num / fps_den;\n                }\n            }\n\n            var sarScale = 1;\n            if (sar_width !== 1 || sar_height !== 1) {\n                sarScale = sar_width / sar_height;\n            }\n\n            var crop_unit_x = 0,\n                crop_unit_y = 0;\n            if (chroma_format_idc === 0) {\n                crop_unit_x = 1;\n                crop_unit_y = 2 - frame_mbs_only_flag;\n            } else {\n                var sub_wc = chroma_format_idc === 3 ? 1 : 2;\n                var sub_hc = chroma_format_idc === 1 ? 2 : 1;\n                crop_unit_x = sub_wc;\n                crop_unit_y = sub_hc * (2 - frame_mbs_only_flag);\n            }\n\n            var codec_width = (pic_width_in_mbs_minus1 + 1) * 16;\n            var codec_height = (2 - frame_mbs_only_flag) * ((pic_height_in_map_units_minus1 + 1) * 16);\n\n            codec_width -= (frame_crop_left_offset + frame_crop_right_offset) * crop_unit_x;\n            codec_height -= (frame_crop_top_offset + frame_crop_bottom_offset) * crop_unit_y;\n\n            var present_width = Math.ceil(codec_width * sarScale);\n\n            gb.destroy();\n            gb = null;\n\n            return {\n                profile_string: profile_string, // baseline, high, high10, ...\n                level_string: level_string, // 3, 3.1, 4, 4.1, 5, 5.1, ...\n                bit_depth: bit_depth, // 8bit, 10bit, ...\n                ref_frames: ref_frames,\n                chroma_format: chroma_format, // 4:2:0, 4:2:2, ...\n                chroma_format_string: SPSParser.getChromaFormatString(chroma_format),\n\n                frame_rate: {\n                    fixed: fps_fixed,\n                    fps: fps,\n                    fps_den: fps_den,\n                    fps_num: fps_num\n                },\n\n                sar_ratio: {\n                    width: sar_width,\n                    height: sar_height\n                },\n\n                codec_size: {\n                    width: codec_width,\n                    height: codec_height\n                },\n\n                present_size: {\n                    width: present_width,\n                    height: codec_height\n                }\n            };\n        }\n    }, {\n        key: '_skipScalingList',\n        value: function _skipScalingList(gb, count) {\n            var last_scale = 8,\n                next_scale = 8;\n            var delta_scale = 0;\n            for (var i = 0; i < count; i++) {\n                if (next_scale !== 0) {\n                    delta_scale = gb.readSEG();\n                    next_scale = (last_scale + delta_scale + 256) % 256;\n                }\n                last_scale = next_scale === 0 ? last_scale : next_scale;\n            }\n        }\n    }, {\n        key: 'getProfileString',\n        value: function getProfileString(profile_idc) {\n            switch (profile_idc) {\n                case 66:\n                    return 'Baseline';\n                case 77:\n                    return 'Main';\n                case 88:\n                    return 'Extended';\n                case 100:\n                    return 'High';\n                case 110:\n                    return 'High10';\n                case 122:\n                    return 'High422';\n                case 244:\n                    return 'High444';\n                default:\n                    return 'Unknown';\n            }\n        }\n    }, {\n        key: 'getLevelString',\n        value: function getLevelString(level_idc) {\n            return (level_idc / 10).toFixed(1);\n        }\n    }, {\n        key: 'getChromaFormatString',\n        value: function getChromaFormatString(chroma) {\n            switch (chroma) {\n                case 420:\n                    return '4:2:0';\n                case 422:\n                    return '4:2:2';\n                case 444:\n                    return '4:4:4';\n                default:\n                    return 'Unknown';\n            }\n        }\n    }]);\n\n    return SPSParser;\n}();\n\nexports.default = SPSParser;\n\n},{\"./exp-golomb.js\":17}],20:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; /*\r\n                                                                                                                                                                                                                                                                               * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                               *\r\n                                                                                                                                                                                                                                                                               * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                               *\r\n                                                                                                                                                                                                                                                                               * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                               * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                               * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                               *\r\n                                                                                                                                                                                                                                                                               *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                               *\r\n                                                                                                                                                                                                                                                                               * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                               * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                               * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                               * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                               * limitations under the License.\r\n                                                                                                                                                                                                                                                                               */\n\nvar _polyfill = _dereq_('./utils/polyfill.js');\n\nvar _polyfill2 = _interopRequireDefault(_polyfill);\n\nvar _features = _dereq_('./core/features.js');\n\nvar _features2 = _interopRequireDefault(_features);\n\nvar _loader = _dereq_('./io/loader.js');\n\nvar _flvPlayer = _dereq_('./player/flv-player.js');\n\nvar _flvPlayer2 = _interopRequireDefault(_flvPlayer);\n\nvar _nativePlayer = _dereq_('./player/native-player.js');\n\nvar _nativePlayer2 = _interopRequireDefault(_nativePlayer);\n\nvar _playerEvents = _dereq_('./player/player-events.js');\n\nvar _playerEvents2 = _interopRequireDefault(_playerEvents);\n\nvar _playerErrors = _dereq_('./player/player-errors.js');\n\nvar _loggingControl = _dereq_('./utils/logging-control.js');\n\nvar _loggingControl2 = _interopRequireDefault(_loggingControl);\n\nvar _exception = _dereq_('./utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// here are all the interfaces\n\n// install polyfills\n_polyfill2.default.install();\n\n// factory method\nfunction createPlayer(mediaDataSource, optionalConfig) {\n    var mds = mediaDataSource;\n    if (mds == null || (typeof mds === 'undefined' ? 'undefined' : _typeof(mds)) !== 'object') {\n        throw new _exception.InvalidArgumentException('MediaDataSource must be an javascript object!');\n    }\n\n    if (!mds.hasOwnProperty('type')) {\n        throw new _exception.InvalidArgumentException('MediaDataSource must has type field to indicate video file type!');\n    }\n\n    switch (mds.type) {\n        case 'flv':\n            return new _flvPlayer2.default(mds, optionalConfig);\n        default:\n            return new _nativePlayer2.default(mds, optionalConfig);\n    }\n}\n\n// feature detection\nfunction isSupported() {\n    return _features2.default.supportMSEH264Playback();\n}\n\nfunction getFeatureList() {\n    return _features2.default.getFeatureList();\n}\n\n// interfaces\nvar flvjs = {};\n\nflvjs.createPlayer = createPlayer;\nflvjs.isSupported = isSupported;\nflvjs.getFeatureList = getFeatureList;\n\nflvjs.BaseLoader = _loader.BaseLoader;\nflvjs.LoaderStatus = _loader.LoaderStatus;\nflvjs.LoaderErrors = _loader.LoaderErrors;\n\nflvjs.Events = _playerEvents2.default;\nflvjs.ErrorTypes = _playerErrors.ErrorTypes;\nflvjs.ErrorDetails = _playerErrors.ErrorDetails;\n\nflvjs.FlvPlayer = _flvPlayer2.default;\nflvjs.NativePlayer = _nativePlayer2.default;\nflvjs.LoggingControl = _loggingControl2.default;\n\nObject.defineProperty(flvjs, 'version', {\n    enumerable: true,\n    get: function get() {\n        // replaced by browserify-versionify transform\n        return '1.6.1';\n    }\n});\n\nexports.default = flvjs;\n\n},{\"./core/features.js\":6,\"./io/loader.js\":24,\"./player/flv-player.js\":32,\"./player/native-player.js\":33,\"./player/player-errors.js\":34,\"./player/player-events.js\":35,\"./utils/exception.js\":40,\"./utils/logging-control.js\":42,\"./utils/polyfill.js\":43}],21:[function(_dereq_,module,exports){\n'use strict';\n\n// entry/index file\n\n// make it compatible with browserify's umd wrapper\nmodule.exports = _dereq_('./flv.js').default;\n\n},{\"./flv.js\":20}],22:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _browser = _dereq_('../utils/browser.js');\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/* fetch + stream IO loader. Currently working on chrome 43+.\r\n * fetch provides a better alternative http API to XMLHttpRequest\r\n *\r\n * fetch spec   https://fetch.spec.whatwg.org/\r\n * stream spec  https://streams.spec.whatwg.org/\r\n */\nvar FetchStreamLoader = function (_BaseLoader) {\n    _inherits(FetchStreamLoader, _BaseLoader);\n\n    _createClass(FetchStreamLoader, null, [{\n        key: 'isSupported',\n        value: function isSupported() {\n            try {\n                // fetch + stream is broken on Microsoft Edge. Disable before build 15048.\n                // see https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8196907/\n                // Fixed in Jan 10, 2017. Build 15048+ removed from blacklist.\n                var isWorkWellEdge = _browser2.default.msedge && _browser2.default.version.minor >= 15048;\n                var browserNotBlacklisted = _browser2.default.msedge ? isWorkWellEdge : true;\n                return self.fetch && self.ReadableStream && browserNotBlacklisted;\n            } catch (e) {\n                return false;\n            }\n        }\n    }]);\n\n    function FetchStreamLoader(seekHandler, config) {\n        _classCallCheck(this, FetchStreamLoader);\n\n        var _this = _possibleConstructorReturn(this, (FetchStreamLoader.__proto__ || Object.getPrototypeOf(FetchStreamLoader)).call(this, 'fetch-stream-loader'));\n\n        _this.TAG = 'FetchStreamLoader';\n\n        _this._seekHandler = seekHandler;\n        _this._config = config;\n        _this._needStash = true;\n\n        _this._requestAbort = false;\n        _this._contentLength = null;\n        _this._receivedLength = 0;\n        return _this;\n    }\n\n    _createClass(FetchStreamLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this.isWorking()) {\n                this.abort();\n            }\n            _get(FetchStreamLoader.prototype.__proto__ || Object.getPrototypeOf(FetchStreamLoader.prototype), 'destroy', this).call(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(dataSource, range) {\n            var _this2 = this;\n\n            this._dataSource = dataSource;\n            this._range = range;\n\n            var sourceURL = dataSource.url;\n            if (this._config.reuseRedirectedURL && dataSource.redirectedURL != undefined) {\n                sourceURL = dataSource.redirectedURL;\n            }\n\n            var seekConfig = this._seekHandler.getConfig(sourceURL, range);\n\n            var headers = new self.Headers();\n\n            if (_typeof(seekConfig.headers) === 'object') {\n                var configHeaders = seekConfig.headers;\n                for (var key in configHeaders) {\n                    if (configHeaders.hasOwnProperty(key)) {\n                        headers.append(key, configHeaders[key]);\n                    }\n                }\n            }\n\n            var params = {\n                method: 'GET',\n                headers: headers,\n                mode: 'cors',\n                cache: 'default',\n                // The default policy of Fetch API in the whatwg standard\n                // Safari incorrectly indicates 'no-referrer' as default policy, fuck it\n                referrerPolicy: 'no-referrer-when-downgrade'\n            };\n\n            // add additional headers\n            if (_typeof(this._config.headers) === 'object') {\n                for (var _key in this._config.headers) {\n                    headers.append(_key, this._config.headers[_key]);\n                }\n            }\n\n            // cors is enabled by default\n            if (dataSource.cors === false) {\n                // no-cors means 'disregard cors policy', which can only be used in ServiceWorker\n                params.mode = 'same-origin';\n            }\n\n            // withCredentials is disabled by default\n            if (dataSource.withCredentials) {\n                params.credentials = 'include';\n            }\n\n            // referrerPolicy from config\n            if (dataSource.referrerPolicy) {\n                params.referrerPolicy = dataSource.referrerPolicy;\n            }\n\n            // add abort controller, by wmlgl 2019-5-10 12:21:27\n            if (self.AbortController) {\n                this._abortController = new self.AbortController();\n                params.signal = this._abortController.signal;\n            }\n\n            this._status = _loader.LoaderStatus.kConnecting;\n            self.fetch(seekConfig.url, params).then(function (res) {\n                if (_this2._requestAbort) {\n                    _this2._status = _loader.LoaderStatus.kIdle;\n                    res.body.cancel();\n                    return;\n                }\n                if (res.ok && res.status >= 200 && res.status <= 299) {\n                    if (res.url !== seekConfig.url) {\n                        if (_this2._onURLRedirect) {\n                            var redirectedURL = _this2._seekHandler.removeURLParameters(res.url);\n                            _this2._onURLRedirect(redirectedURL);\n                        }\n                    }\n\n                    var lengthHeader = res.headers.get('Content-Length');\n                    if (lengthHeader != null) {\n                        _this2._contentLength = parseInt(lengthHeader);\n                        if (_this2._contentLength !== 0) {\n                            if (_this2._onContentLengthKnown) {\n                                _this2._onContentLengthKnown(_this2._contentLength);\n                            }\n                        }\n                    }\n\n                    return _this2._pump.call(_this2, res.body.getReader());\n                } else {\n                    _this2._status = _loader.LoaderStatus.kError;\n                    if (_this2._onError) {\n                        _this2._onError(_loader.LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: res.status, msg: res.statusText });\n                    } else {\n                        throw new _exception.RuntimeException('FetchStreamLoader: Http code invalid, ' + res.status + ' ' + res.statusText);\n                    }\n                }\n            }).catch(function (e) {\n                if (_this2._abortController && _this2._abortController.signal.aborted) {\n                    return;\n                }\n\n                _this2._status = _loader.LoaderStatus.kError;\n                if (_this2._onError) {\n                    _this2._onError(_loader.LoaderErrors.EXCEPTION, { code: -1, msg: e.message });\n                } else {\n                    throw e;\n                }\n            });\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            this._requestAbort = true;\n\n            if (this._status !== _loader.LoaderStatus.kBuffering || !_browser2.default.chrome) {\n                // Chrome may throw Exception-like things here, avoid using if is buffering\n                if (this._abortController) {\n                    try {\n                        this._abortController.abort();\n                    } catch (e) {\n                        return;\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_pump',\n        value: function _pump(reader) {\n            var _this3 = this;\n\n            // ReadableStreamReader\n            return reader.read().then(function (result) {\n                if (result.done) {\n                    // First check received length\n                    if (_this3._contentLength !== null && _this3._receivedLength < _this3._contentLength) {\n                        // Report Early-EOF\n                        _this3._status = _loader.LoaderStatus.kError;\n                        var type = _loader.LoaderErrors.EARLY_EOF;\n                        var info = { code: -1, msg: 'Fetch stream meet Early-EOF' };\n                        if (_this3._onError) {\n                            _this3._onError(type, info);\n                        } else {\n                            throw new _exception.RuntimeException(info.msg);\n                        }\n                    } else {\n                        // OK. Download complete\n                        _this3._status = _loader.LoaderStatus.kComplete;\n                        if (_this3._onComplete) {\n                            _this3._onComplete(_this3._range.from, _this3._range.from + _this3._receivedLength - 1);\n                        }\n                    }\n                } else {\n                    if (_this3._abortController && _this3._abortController.signal.aborted) {\n                        _this3._status = _loader.LoaderStatus.kComplete;\n                        return;\n                    } else if (_this3._requestAbort === true) {\n                        _this3._status = _loader.LoaderStatus.kComplete;\n                        return reader.cancel();\n                    }\n\n                    _this3._status = _loader.LoaderStatus.kBuffering;\n\n                    var chunk = result.value.buffer;\n                    var byteStart = _this3._range.from + _this3._receivedLength;\n                    _this3._receivedLength += chunk.byteLength;\n\n                    if (_this3._onDataArrival) {\n                        _this3._onDataArrival(chunk, byteStart, _this3._receivedLength);\n                    }\n\n                    _this3._pump(reader);\n                }\n            }).catch(function (e) {\n                if (_this3._abortController && _this3._abortController.signal.aborted) {\n                    _this3._status = _loader.LoaderStatus.kComplete;\n                    return;\n                }\n\n                if (e.code === 11 && _browser2.default.msedge) {\n                    // InvalidStateError on Microsoft Edge\n                    // Workaround: Edge may throw InvalidStateError after ReadableStreamReader.cancel() call\n                    // Ignore the unknown exception.\n                    // Related issue: https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/11265202/\n                    return;\n                }\n\n                _this3._status = _loader.LoaderStatus.kError;\n                var type = 0;\n                var info = null;\n\n                if ((e.code === 19 || e.message === 'network error') && ( // NETWORK_ERR\n                _this3._contentLength === null || _this3._contentLength !== null && _this3._receivedLength < _this3._contentLength)) {\n                    type = _loader.LoaderErrors.EARLY_EOF;\n                    info = { code: e.code, msg: 'Fetch stream meet Early-EOF' };\n                } else {\n                    type = _loader.LoaderErrors.EXCEPTION;\n                    info = { code: e.code, msg: e.message };\n                }\n\n                if (_this3._onError) {\n                    _this3._onError(type, info);\n                } else {\n                    throw new _exception.RuntimeException(info.msg);\n                }\n            });\n        }\n    }]);\n\n    return FetchStreamLoader;\n}(_loader.BaseLoader);\n\nexports.default = FetchStreamLoader;\n\n},{\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],23:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _speedSampler = _dereq_('./speed-sampler.js');\n\nvar _speedSampler2 = _interopRequireDefault(_speedSampler);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _fetchStreamLoader = _dereq_('./fetch-stream-loader.js');\n\nvar _fetchStreamLoader2 = _interopRequireDefault(_fetchStreamLoader);\n\nvar _xhrMozChunkedLoader = _dereq_('./xhr-moz-chunked-loader.js');\n\nvar _xhrMozChunkedLoader2 = _interopRequireDefault(_xhrMozChunkedLoader);\n\nvar _xhrMsstreamLoader = _dereq_('./xhr-msstream-loader.js');\n\nvar _xhrMsstreamLoader2 = _interopRequireDefault(_xhrMsstreamLoader);\n\nvar _xhrRangeLoader = _dereq_('./xhr-range-loader.js');\n\nvar _xhrRangeLoader2 = _interopRequireDefault(_xhrRangeLoader);\n\nvar _websocketLoader = _dereq_('./websocket-loader.js');\n\nvar _websocketLoader2 = _interopRequireDefault(_websocketLoader);\n\nvar _rangeSeekHandler = _dereq_('./range-seek-handler.js');\n\nvar _rangeSeekHandler2 = _interopRequireDefault(_rangeSeekHandler);\n\nvar _paramSeekHandler = _dereq_('./param-seek-handler.js');\n\nvar _paramSeekHandler2 = _interopRequireDefault(_paramSeekHandler);\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * DataSource: {\r\n *     url: string,\r\n *     filesize: number,\r\n *     cors: boolean,\r\n *     withCredentials: boolean\r\n * }\r\n * \r\n */\n\n// Manage IO Loaders\nvar IOController = function () {\n    function IOController(dataSource, config, extraData) {\n        _classCallCheck(this, IOController);\n\n        this.TAG = 'IOController';\n\n        this._config = config;\n        this._extraData = extraData;\n\n        this._stashInitialSize = 1024 * 384; // default initial size: 384KB\n        if (config.stashInitialSize != undefined && config.stashInitialSize > 0) {\n            // apply from config\n            this._stashInitialSize = config.stashInitialSize;\n        }\n\n        this._stashUsed = 0;\n        this._stashSize = this._stashInitialSize;\n        this._bufferSize = 1024 * 1024 * 3; // initial size: 3MB\n        this._stashBuffer = new ArrayBuffer(this._bufferSize);\n        this._stashByteStart = 0;\n        this._enableStash = true;\n        if (config.enableStashBuffer === false) {\n            this._enableStash = false;\n        }\n\n        this._loader = null;\n        this._loaderClass = null;\n        this._seekHandler = null;\n\n        this._dataSource = dataSource;\n        this._isWebSocketURL = /wss?:\\/\\/(.+?)/.test(dataSource.url);\n        this._refTotalLength = dataSource.filesize ? dataSource.filesize : null;\n        this._totalLength = this._refTotalLength;\n        this._fullRequestFlag = false;\n        this._currentRange = null;\n        this._redirectedURL = null;\n\n        this._speedNormalized = 0;\n        this._speedSampler = new _speedSampler2.default();\n        this._speedNormalizeList = [64, 128, 256, 384, 512, 768, 1024, 1536, 2048, 3072, 4096];\n\n        this._isEarlyEofReconnecting = false;\n\n        this._paused = false;\n        this._resumeFrom = 0;\n\n        this._onDataArrival = null;\n        this._onSeeked = null;\n        this._onError = null;\n        this._onComplete = null;\n        this._onRedirect = null;\n        this._onRecoveredEarlyEof = null;\n\n        this._selectSeekHandler();\n        this._selectLoader();\n        this._createLoader();\n    }\n\n    _createClass(IOController, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._loader.isWorking()) {\n                this._loader.abort();\n            }\n            this._loader.destroy();\n            this._loader = null;\n            this._loaderClass = null;\n            this._dataSource = null;\n            this._stashBuffer = null;\n            this._stashUsed = this._stashSize = this._bufferSize = this._stashByteStart = 0;\n            this._currentRange = null;\n            this._speedSampler = null;\n\n            this._isEarlyEofReconnecting = false;\n\n            this._onDataArrival = null;\n            this._onSeeked = null;\n            this._onError = null;\n            this._onComplete = null;\n            this._onRedirect = null;\n            this._onRecoveredEarlyEof = null;\n\n            this._extraData = null;\n        }\n    }, {\n        key: 'isWorking',\n        value: function isWorking() {\n            return this._loader && this._loader.isWorking() && !this._paused;\n        }\n    }, {\n        key: 'isPaused',\n        value: function isPaused() {\n            return this._paused;\n        }\n    }, {\n        key: '_selectSeekHandler',\n        value: function _selectSeekHandler() {\n            var config = this._config;\n\n            if (config.seekType === 'range') {\n                this._seekHandler = new _rangeSeekHandler2.default(this._config.rangeLoadZeroStart);\n            } else if (config.seekType === 'param') {\n                var paramStart = config.seekParamStart || 'bstart';\n                var paramEnd = config.seekParamEnd || 'bend';\n\n                this._seekHandler = new _paramSeekHandler2.default(paramStart, paramEnd);\n            } else if (config.seekType === 'custom') {\n                if (typeof config.customSeekHandler !== 'function') {\n                    throw new _exception.InvalidArgumentException('Custom seekType specified in config but invalid customSeekHandler!');\n                }\n                this._seekHandler = new config.customSeekHandler();\n            } else {\n                throw new _exception.InvalidArgumentException('Invalid seekType in config: ' + config.seekType);\n            }\n        }\n    }, {\n        key: '_selectLoader',\n        value: function _selectLoader() {\n            if (this._config.customLoader != null) {\n                this._loaderClass = this._config.customLoader;\n            } else if (this._isWebSocketURL) {\n                this._loaderClass = _websocketLoader2.default;\n            } else if (_fetchStreamLoader2.default.isSupported()) {\n                this._loaderClass = _fetchStreamLoader2.default;\n            } else if (_xhrMozChunkedLoader2.default.isSupported()) {\n                this._loaderClass = _xhrMozChunkedLoader2.default;\n            } else if (_xhrRangeLoader2.default.isSupported()) {\n                this._loaderClass = _xhrRangeLoader2.default;\n            } else {\n                throw new _exception.RuntimeException('Your browser doesn\\'t support xhr with arraybuffer responseType!');\n            }\n        }\n    }, {\n        key: '_createLoader',\n        value: function _createLoader() {\n            this._loader = new this._loaderClass(this._seekHandler, this._config);\n            if (this._loader.needStashBuffer === false) {\n                this._enableStash = false;\n            }\n            this._loader.onContentLengthKnown = this._onContentLengthKnown.bind(this);\n            this._loader.onURLRedirect = this._onURLRedirect.bind(this);\n            this._loader.onDataArrival = this._onLoaderChunkArrival.bind(this);\n            this._loader.onComplete = this._onLoaderComplete.bind(this);\n            this._loader.onError = this._onLoaderError.bind(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(optionalFrom) {\n            this._currentRange = { from: 0, to: -1 };\n            if (optionalFrom) {\n                this._currentRange.from = optionalFrom;\n            }\n\n            this._speedSampler.reset();\n            if (!optionalFrom) {\n                this._fullRequestFlag = true;\n            }\n\n            this._loader.open(this._dataSource, Object.assign({}, this._currentRange));\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            this._loader.abort();\n\n            if (this._paused) {\n                this._paused = false;\n                this._resumeFrom = 0;\n            }\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            if (this.isWorking()) {\n                this._loader.abort();\n\n                if (this._stashUsed !== 0) {\n                    this._resumeFrom = this._stashByteStart;\n                    this._currentRange.to = this._stashByteStart - 1;\n                } else {\n                    this._resumeFrom = this._currentRange.to + 1;\n                }\n                this._stashUsed = 0;\n                this._stashByteStart = 0;\n                this._paused = true;\n            }\n        }\n    }, {\n        key: 'resume',\n        value: function resume() {\n            if (this._paused) {\n                this._paused = false;\n                var bytes = this._resumeFrom;\n                this._resumeFrom = 0;\n                this._internalSeek(bytes, true);\n            }\n        }\n    }, {\n        key: 'seek',\n        value: function seek(bytes) {\n            this._paused = false;\n            this._stashUsed = 0;\n            this._stashByteStart = 0;\n            this._internalSeek(bytes, true);\n        }\n\n        /**\r\n         * When seeking request is from media seeking, unconsumed stash data should be dropped\r\n         * However, stash data shouldn't be dropped if seeking requested from http reconnection\r\n         *\r\n         * @dropUnconsumed: Ignore and discard all unconsumed data in stash buffer\r\n         */\n\n    }, {\n        key: '_internalSeek',\n        value: function _internalSeek(bytes, dropUnconsumed) {\n            if (this._loader.isWorking()) {\n                this._loader.abort();\n            }\n\n            // dispatch & flush stash buffer before seek\n            this._flushStashBuffer(dropUnconsumed);\n\n            this._loader.destroy();\n            this._loader = null;\n\n            var requestRange = { from: bytes, to: -1 };\n            this._currentRange = { from: requestRange.from, to: -1 };\n\n            this._speedSampler.reset();\n            this._stashSize = this._stashInitialSize;\n            this._createLoader();\n            this._loader.open(this._dataSource, requestRange);\n\n            if (this._onSeeked) {\n                this._onSeeked();\n            }\n        }\n    }, {\n        key: 'updateUrl',\n        value: function updateUrl(url) {\n            if (!url || typeof url !== 'string' || url.length === 0) {\n                throw new _exception.InvalidArgumentException('Url must be a non-empty string!');\n            }\n\n            this._dataSource.url = url;\n\n            // TODO: replace with new url\n        }\n    }, {\n        key: '_expandBuffer',\n        value: function _expandBuffer(expectedBytes) {\n            var bufferNewSize = this._stashSize;\n            while (bufferNewSize + 1024 * 1024 * 1 < expectedBytes) {\n                bufferNewSize *= 2;\n            }\n\n            bufferNewSize += 1024 * 1024 * 1; // bufferSize = stashSize + 1MB\n            if (bufferNewSize === this._bufferSize) {\n                return;\n            }\n\n            var newBuffer = new ArrayBuffer(bufferNewSize);\n\n            if (this._stashUsed > 0) {\n                // copy existing data into new buffer\n                var stashOldArray = new Uint8Array(this._stashBuffer, 0, this._stashUsed);\n                var stashNewArray = new Uint8Array(newBuffer, 0, bufferNewSize);\n                stashNewArray.set(stashOldArray, 0);\n            }\n\n            this._stashBuffer = newBuffer;\n            this._bufferSize = bufferNewSize;\n        }\n    }, {\n        key: '_normalizeSpeed',\n        value: function _normalizeSpeed(input) {\n            var list = this._speedNormalizeList;\n            var last = list.length - 1;\n            var mid = 0;\n            var lbound = 0;\n            var ubound = last;\n\n            if (input < list[0]) {\n                return list[0];\n            }\n\n            // binary search\n            while (lbound <= ubound) {\n                mid = lbound + Math.floor((ubound - lbound) / 2);\n                if (mid === last || input >= list[mid] && input < list[mid + 1]) {\n                    return list[mid];\n                } else if (list[mid] < input) {\n                    lbound = mid + 1;\n                } else {\n                    ubound = mid - 1;\n                }\n            }\n        }\n    }, {\n        key: '_adjustStashSize',\n        value: function _adjustStashSize(normalized) {\n            var stashSizeKB = 0;\n\n            if (this._config.isLive) {\n                // live stream: always use single normalized speed for size of stashSizeKB\n                stashSizeKB = normalized;\n            } else {\n                if (normalized < 512) {\n                    stashSizeKB = normalized;\n                } else if (normalized >= 512 && normalized <= 1024) {\n                    stashSizeKB = Math.floor(normalized * 1.5);\n                } else {\n                    stashSizeKB = normalized * 2;\n                }\n            }\n\n            if (stashSizeKB > 8192) {\n                stashSizeKB = 8192;\n            }\n\n            var bufferSize = stashSizeKB * 1024 + 1024 * 1024 * 1; // stashSize + 1MB\n            if (this._bufferSize < bufferSize) {\n                this._expandBuffer(bufferSize);\n            }\n            this._stashSize = stashSizeKB * 1024;\n        }\n    }, {\n        key: '_dispatchChunks',\n        value: function _dispatchChunks(chunks, byteStart) {\n            this._currentRange.to = byteStart + chunks.byteLength - 1;\n            return this._onDataArrival(chunks, byteStart);\n        }\n    }, {\n        key: '_onURLRedirect',\n        value: function _onURLRedirect(redirectedURL) {\n            this._redirectedURL = redirectedURL;\n            if (this._onRedirect) {\n                this._onRedirect(redirectedURL);\n            }\n        }\n    }, {\n        key: '_onContentLengthKnown',\n        value: function _onContentLengthKnown(contentLength) {\n            if (contentLength && this._fullRequestFlag) {\n                this._totalLength = contentLength;\n                this._fullRequestFlag = false;\n            }\n        }\n    }, {\n        key: '_onLoaderChunkArrival',\n        value: function _onLoaderChunkArrival(chunk, byteStart, receivedLength) {\n            if (!this._onDataArrival) {\n                throw new _exception.IllegalStateException('IOController: No existing consumer (onDataArrival) callback!');\n            }\n            if (this._paused) {\n                return;\n            }\n            if (this._isEarlyEofReconnecting) {\n                // Auto-reconnect for EarlyEof succeed, notify to upper-layer by callback\n                this._isEarlyEofReconnecting = false;\n                if (this._onRecoveredEarlyEof) {\n                    this._onRecoveredEarlyEof();\n                }\n            }\n\n            this._speedSampler.addBytes(chunk.byteLength);\n\n            // adjust stash buffer size according to network speed dynamically\n            var KBps = this._speedSampler.lastSecondKBps;\n            if (KBps !== 0) {\n                var normalized = this._normalizeSpeed(KBps);\n                if (this._speedNormalized !== normalized) {\n                    this._speedNormalized = normalized;\n                    this._adjustStashSize(normalized);\n                }\n            }\n\n            if (!this._enableStash) {\n                // disable stash\n                if (this._stashUsed === 0) {\n                    // dispatch chunk directly to consumer;\n                    // check ret value (consumed bytes) and stash unconsumed to stashBuffer\n                    var consumed = this._dispatchChunks(chunk, byteStart);\n                    if (consumed < chunk.byteLength) {\n                        // unconsumed data remain.\n                        var remain = chunk.byteLength - consumed;\n                        if (remain > this._bufferSize) {\n                            this._expandBuffer(remain);\n                        }\n                        var stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                        stashArray.set(new Uint8Array(chunk, consumed), 0);\n                        this._stashUsed += remain;\n                        this._stashByteStart = byteStart + consumed;\n                    }\n                } else {\n                    // else: Merge chunk into stashBuffer, and dispatch stashBuffer to consumer.\n                    if (this._stashUsed + chunk.byteLength > this._bufferSize) {\n                        this._expandBuffer(this._stashUsed + chunk.byteLength);\n                    }\n                    var _stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                    _stashArray.set(new Uint8Array(chunk), this._stashUsed);\n                    this._stashUsed += chunk.byteLength;\n                    var _consumed = this._dispatchChunks(this._stashBuffer.slice(0, this._stashUsed), this._stashByteStart);\n                    if (_consumed < this._stashUsed && _consumed > 0) {\n                        // unconsumed data remain\n                        var remainArray = new Uint8Array(this._stashBuffer, _consumed);\n                        _stashArray.set(remainArray, 0);\n                    }\n                    this._stashUsed -= _consumed;\n                    this._stashByteStart += _consumed;\n                }\n            } else {\n                // enable stash\n                if (this._stashUsed === 0 && this._stashByteStart === 0) {\n                    // seeked? or init chunk?\n                    // This is the first chunk after seek action\n                    this._stashByteStart = byteStart;\n                }\n                if (this._stashUsed + chunk.byteLength <= this._stashSize) {\n                    // just stash\n                    var _stashArray2 = new Uint8Array(this._stashBuffer, 0, this._stashSize);\n                    _stashArray2.set(new Uint8Array(chunk), this._stashUsed);\n                    this._stashUsed += chunk.byteLength;\n                } else {\n                    // stashUsed + chunkSize > stashSize, size limit exceeded\n                    var _stashArray3 = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                    if (this._stashUsed > 0) {\n                        // There're stash datas in buffer\n                        // dispatch the whole stashBuffer, and stash remain data\n                        // then append chunk to stashBuffer (stash)\n                        var buffer = this._stashBuffer.slice(0, this._stashUsed);\n                        var _consumed2 = this._dispatchChunks(buffer, this._stashByteStart);\n                        if (_consumed2 < buffer.byteLength) {\n                            if (_consumed2 > 0) {\n                                var _remainArray = new Uint8Array(buffer, _consumed2);\n                                _stashArray3.set(_remainArray, 0);\n                                this._stashUsed = _remainArray.byteLength;\n                                this._stashByteStart += _consumed2;\n                            }\n                        } else {\n                            this._stashUsed = 0;\n                            this._stashByteStart += _consumed2;\n                        }\n                        if (this._stashUsed + chunk.byteLength > this._bufferSize) {\n                            this._expandBuffer(this._stashUsed + chunk.byteLength);\n                            _stashArray3 = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                        }\n                        _stashArray3.set(new Uint8Array(chunk), this._stashUsed);\n                        this._stashUsed += chunk.byteLength;\n                    } else {\n                        // stash buffer empty, but chunkSize > stashSize (oh, holy shit)\n                        // dispatch chunk directly and stash remain data\n                        var _consumed3 = this._dispatchChunks(chunk, byteStart);\n                        if (_consumed3 < chunk.byteLength) {\n                            var _remain = chunk.byteLength - _consumed3;\n                            if (_remain > this._bufferSize) {\n                                this._expandBuffer(_remain);\n                                _stashArray3 = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                            }\n                            _stashArray3.set(new Uint8Array(chunk, _consumed3), 0);\n                            this._stashUsed += _remain;\n                            this._stashByteStart = byteStart + _consumed3;\n                        }\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_flushStashBuffer',\n        value: function _flushStashBuffer(dropUnconsumed) {\n            if (this._stashUsed > 0) {\n                var buffer = this._stashBuffer.slice(0, this._stashUsed);\n                var consumed = this._dispatchChunks(buffer, this._stashByteStart);\n                var remain = buffer.byteLength - consumed;\n\n                if (consumed < buffer.byteLength) {\n                    if (dropUnconsumed) {\n                        _logger2.default.w(this.TAG, remain + ' bytes unconsumed data remain when flush buffer, dropped');\n                    } else {\n                        if (consumed > 0) {\n                            var stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                            var remainArray = new Uint8Array(buffer, consumed);\n                            stashArray.set(remainArray, 0);\n                            this._stashUsed = remainArray.byteLength;\n                            this._stashByteStart += consumed;\n                        }\n                        return 0;\n                    }\n                }\n                this._stashUsed = 0;\n                this._stashByteStart = 0;\n                return remain;\n            }\n            return 0;\n        }\n    }, {\n        key: '_onLoaderComplete',\n        value: function _onLoaderComplete(from, to) {\n            // Force-flush stash buffer, and drop unconsumed data\n            this._flushStashBuffer(true);\n\n            if (this._onComplete) {\n                this._onComplete(this._extraData);\n            }\n        }\n    }, {\n        key: '_onLoaderError',\n        value: function _onLoaderError(type, data) {\n            _logger2.default.e(this.TAG, 'Loader error, code = ' + data.code + ', msg = ' + data.msg);\n\n            this._flushStashBuffer(false);\n\n            if (this._isEarlyEofReconnecting) {\n                // Auto-reconnect for EarlyEof failed, throw UnrecoverableEarlyEof error to upper-layer\n                this._isEarlyEofReconnecting = false;\n                type = _loader.LoaderErrors.UNRECOVERABLE_EARLY_EOF;\n            }\n\n            switch (type) {\n                case _loader.LoaderErrors.EARLY_EOF:\n                    {\n                        if (!this._config.isLive) {\n                            // Do internal http reconnect if not live stream\n                            if (this._totalLength) {\n                                var nextFrom = this._currentRange.to + 1;\n                                if (nextFrom < this._totalLength) {\n                                    _logger2.default.w(this.TAG, 'Connection lost, trying reconnect...');\n                                    this._isEarlyEofReconnecting = true;\n                                    this._internalSeek(nextFrom, false);\n                                }\n                                return;\n                            }\n                            // else: We don't know totalLength, throw UnrecoverableEarlyEof\n                        }\n                        // live stream: throw UnrecoverableEarlyEof error to upper-layer\n                        type = _loader.LoaderErrors.UNRECOVERABLE_EARLY_EOF;\n                        break;\n                    }\n                case _loader.LoaderErrors.UNRECOVERABLE_EARLY_EOF:\n                case _loader.LoaderErrors.CONNECTING_TIMEOUT:\n                case _loader.LoaderErrors.HTTP_STATUS_CODE_INVALID:\n                case _loader.LoaderErrors.EXCEPTION:\n                    break;\n            }\n\n            if (this._onError) {\n                this._onError(type, data);\n            } else {\n                throw new _exception.RuntimeException('IOException: ' + data.msg);\n            }\n        }\n    }, {\n        key: 'status',\n        get: function get() {\n            return this._loader.status;\n        }\n    }, {\n        key: 'extraData',\n        get: function get() {\n            return this._extraData;\n        },\n        set: function set(data) {\n            this._extraData = data;\n        }\n\n        // prototype: function onDataArrival(chunks: ArrayBuffer, byteStart: number): number\n\n    }, {\n        key: 'onDataArrival',\n        get: function get() {\n            return this._onDataArrival;\n        },\n        set: function set(callback) {\n            this._onDataArrival = callback;\n        }\n    }, {\n        key: 'onSeeked',\n        get: function get() {\n            return this._onSeeked;\n        },\n        set: function set(callback) {\n            this._onSeeked = callback;\n        }\n\n        // prototype: function onError(type: number, info: {code: number, msg: string}): void\n\n    }, {\n        key: 'onError',\n        get: function get() {\n            return this._onError;\n        },\n        set: function set(callback) {\n            this._onError = callback;\n        }\n    }, {\n        key: 'onComplete',\n        get: function get() {\n            return this._onComplete;\n        },\n        set: function set(callback) {\n            this._onComplete = callback;\n        }\n    }, {\n        key: 'onRedirect',\n        get: function get() {\n            return this._onRedirect;\n        },\n        set: function set(callback) {\n            this._onRedirect = callback;\n        }\n    }, {\n        key: 'onRecoveredEarlyEof',\n        get: function get() {\n            return this._onRecoveredEarlyEof;\n        },\n        set: function set(callback) {\n            this._onRecoveredEarlyEof = callback;\n        }\n    }, {\n        key: 'currentURL',\n        get: function get() {\n            return this._dataSource.url;\n        }\n    }, {\n        key: 'hasRedirect',\n        get: function get() {\n            return this._redirectedURL != null || this._dataSource.redirectedURL != undefined;\n        }\n    }, {\n        key: 'currentRedirectedURL',\n        get: function get() {\n            return this._redirectedURL || this._dataSource.redirectedURL;\n        }\n\n        // in KB/s\n\n    }, {\n        key: 'currentSpeed',\n        get: function get() {\n            if (this._loaderClass === _xhrRangeLoader2.default) {\n                // SpeedSampler is inaccuracy if loader is RangeLoader\n                return this._loader.currentSpeed;\n            }\n            return this._speedSampler.lastSecondKBps;\n        }\n    }, {\n        key: 'loaderType',\n        get: function get() {\n            return this._loader.type;\n        }\n    }]);\n\n    return IOController;\n}();\n\nexports.default = IOController;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./fetch-stream-loader.js\":22,\"./loader.js\":24,\"./param-seek-handler.js\":25,\"./range-seek-handler.js\":26,\"./speed-sampler.js\":27,\"./websocket-loader.js\":28,\"./xhr-moz-chunked-loader.js\":29,\"./xhr-msstream-loader.js\":30,\"./xhr-range-loader.js\":31}],24:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.BaseLoader = exports.LoaderErrors = exports.LoaderStatus = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar LoaderStatus = exports.LoaderStatus = {\n    kIdle: 0,\n    kConnecting: 1,\n    kBuffering: 2,\n    kError: 3,\n    kComplete: 4\n};\n\nvar LoaderErrors = exports.LoaderErrors = {\n    OK: 'OK',\n    EXCEPTION: 'Exception',\n    HTTP_STATUS_CODE_INVALID: 'HttpStatusCodeInvalid',\n    CONNECTING_TIMEOUT: 'ConnectingTimeout',\n    EARLY_EOF: 'EarlyEof',\n    UNRECOVERABLE_EARLY_EOF: 'UnrecoverableEarlyEof'\n};\n\n/* Loader has callbacks which have following prototypes:\r\n *     function onContentLengthKnown(contentLength: number): void\r\n *     function onURLRedirect(url: string): void\r\n *     function onDataArrival(chunk: ArrayBuffer, byteStart: number, receivedLength: number): void\r\n *     function onError(errorType: number, errorInfo: {code: number, msg: string}): void\r\n *     function onComplete(rangeFrom: number, rangeTo: number): void\r\n */\n\nvar BaseLoader = exports.BaseLoader = function () {\n    function BaseLoader(typeName) {\n        _classCallCheck(this, BaseLoader);\n\n        this._type = typeName || 'undefined';\n        this._status = LoaderStatus.kIdle;\n        this._needStash = false;\n        // callbacks\n        this._onContentLengthKnown = null;\n        this._onURLRedirect = null;\n        this._onDataArrival = null;\n        this._onError = null;\n        this._onComplete = null;\n    }\n\n    _createClass(BaseLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._status = LoaderStatus.kIdle;\n            this._onContentLengthKnown = null;\n            this._onURLRedirect = null;\n            this._onDataArrival = null;\n            this._onError = null;\n            this._onComplete = null;\n        }\n    }, {\n        key: 'isWorking',\n        value: function isWorking() {\n            return this._status === LoaderStatus.kConnecting || this._status === LoaderStatus.kBuffering;\n        }\n    }, {\n        key: 'open',\n\n\n        // pure virtual\n        value: function open(dataSource, range) {\n            throw new _exception.NotImplementedException('Unimplemented abstract function!');\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            throw new _exception.NotImplementedException('Unimplemented abstract function!');\n        }\n    }, {\n        key: 'type',\n        get: function get() {\n            return this._type;\n        }\n    }, {\n        key: 'status',\n        get: function get() {\n            return this._status;\n        }\n    }, {\n        key: 'needStashBuffer',\n        get: function get() {\n            return this._needStash;\n        }\n    }, {\n        key: 'onContentLengthKnown',\n        get: function get() {\n            return this._onContentLengthKnown;\n        },\n        set: function set(callback) {\n            this._onContentLengthKnown = callback;\n        }\n    }, {\n        key: 'onURLRedirect',\n        get: function get() {\n            return this._onURLRedirect;\n        },\n        set: function set(callback) {\n            this._onURLRedirect = callback;\n        }\n    }, {\n        key: 'onDataArrival',\n        get: function get() {\n            return this._onDataArrival;\n        },\n        set: function set(callback) {\n            this._onDataArrival = callback;\n        }\n    }, {\n        key: 'onError',\n        get: function get() {\n            return this._onError;\n        },\n        set: function set(callback) {\n            this._onError = callback;\n        }\n    }, {\n        key: 'onComplete',\n        get: function get() {\n            return this._onComplete;\n        },\n        set: function set(callback) {\n            this._onComplete = callback;\n        }\n    }]);\n\n    return BaseLoader;\n}();\n\n},{\"../utils/exception.js\":40}],25:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar ParamSeekHandler = function () {\n    function ParamSeekHandler(paramStart, paramEnd) {\n        _classCallCheck(this, ParamSeekHandler);\n\n        this._startName = paramStart;\n        this._endName = paramEnd;\n    }\n\n    _createClass(ParamSeekHandler, [{\n        key: 'getConfig',\n        value: function getConfig(baseUrl, range) {\n            var url = baseUrl;\n\n            if (range.from !== 0 || range.to !== -1) {\n                var needAnd = true;\n                if (url.indexOf('?') === -1) {\n                    url += '?';\n                    needAnd = false;\n                }\n\n                if (needAnd) {\n                    url += '&';\n                }\n\n                url += this._startName + '=' + range.from.toString();\n\n                if (range.to !== -1) {\n                    url += '&' + this._endName + '=' + range.to.toString();\n                }\n            }\n\n            return {\n                url: url,\n                headers: {}\n            };\n        }\n    }, {\n        key: 'removeURLParameters',\n        value: function removeURLParameters(seekedURL) {\n            var baseURL = seekedURL.split('?')[0];\n            var params = undefined;\n\n            var queryIndex = seekedURL.indexOf('?');\n            if (queryIndex !== -1) {\n                params = seekedURL.substring(queryIndex + 1);\n            }\n\n            var resultParams = '';\n\n            if (params != undefined && params.length > 0) {\n                var pairs = params.split('&');\n\n                for (var i = 0; i < pairs.length; i++) {\n                    var pair = pairs[i].split('=');\n                    var requireAnd = i > 0;\n\n                    if (pair[0] !== this._startName && pair[0] !== this._endName) {\n                        if (requireAnd) {\n                            resultParams += '&';\n                        }\n                        resultParams += pairs[i];\n                    }\n                }\n            }\n\n            return resultParams.length === 0 ? baseURL : baseURL + '?' + resultParams;\n        }\n    }]);\n\n    return ParamSeekHandler;\n}();\n\nexports.default = ParamSeekHandler;\n\n},{}],26:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar RangeSeekHandler = function () {\n    function RangeSeekHandler(zeroStart) {\n        _classCallCheck(this, RangeSeekHandler);\n\n        this._zeroStart = zeroStart || false;\n    }\n\n    _createClass(RangeSeekHandler, [{\n        key: 'getConfig',\n        value: function getConfig(url, range) {\n            var headers = {};\n\n            if (range.from !== 0 || range.to !== -1) {\n                var param = void 0;\n                if (range.to !== -1) {\n                    param = 'bytes=' + range.from.toString() + '-' + range.to.toString();\n                } else {\n                    param = 'bytes=' + range.from.toString() + '-';\n                }\n                headers['Range'] = param;\n            } else if (this._zeroStart) {\n                headers['Range'] = 'bytes=0-';\n            }\n\n            return {\n                url: url,\n                headers: headers\n            };\n        }\n    }, {\n        key: 'removeURLParameters',\n        value: function removeURLParameters(seekedURL) {\n            return seekedURL;\n        }\n    }]);\n\n    return RangeSeekHandler;\n}();\n\nexports.default = RangeSeekHandler;\n\n},{}],27:[function(_dereq_,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n// Utility class to calculate realtime network I/O speed\nvar SpeedSampler = function () {\n    function SpeedSampler() {\n        _classCallCheck(this, SpeedSampler);\n\n        // milliseconds\n        this._firstCheckpoint = 0;\n        this._lastCheckpoint = 0;\n        this._intervalBytes = 0;\n        this._totalBytes = 0;\n        this._lastSecondBytes = 0;\n\n        // compatibility detection\n        if (self.performance && self.performance.now) {\n            this._now = self.performance.now.bind(self.performance);\n        } else {\n            this._now = Date.now;\n        }\n    }\n\n    _createClass(SpeedSampler, [{\n        key: \"reset\",\n        value: function reset() {\n            this._firstCheckpoint = this._lastCheckpoint = 0;\n            this._totalBytes = this._intervalBytes = 0;\n            this._lastSecondBytes = 0;\n        }\n    }, {\n        key: \"addBytes\",\n        value: function addBytes(bytes) {\n            if (this._firstCheckpoint === 0) {\n                this._firstCheckpoint = this._now();\n                this._lastCheckpoint = this._firstCheckpoint;\n                this._intervalBytes += bytes;\n                this._totalBytes += bytes;\n            } else if (this._now() - this._lastCheckpoint < 1000) {\n                this._intervalBytes += bytes;\n                this._totalBytes += bytes;\n            } else {\n                // duration >= 1000\n                this._lastSecondBytes = this._intervalBytes;\n                this._intervalBytes = bytes;\n                this._totalBytes += bytes;\n                this._lastCheckpoint = this._now();\n            }\n        }\n    }, {\n        key: \"currentKBps\",\n        get: function get() {\n            this.addBytes(0);\n\n            var durationSeconds = (this._now() - this._lastCheckpoint) / 1000;\n            if (durationSeconds == 0) durationSeconds = 1;\n            return this._intervalBytes / durationSeconds / 1024;\n        }\n    }, {\n        key: \"lastSecondKBps\",\n        get: function get() {\n            this.addBytes(0);\n\n            if (this._lastSecondBytes !== 0) {\n                return this._lastSecondBytes / 1024;\n            } else {\n                // lastSecondBytes === 0\n                if (this._now() - this._lastCheckpoint >= 500) {\n                    // if time interval since last checkpoint has exceeded 500ms\n                    // the speed is nearly accurate\n                    return this.currentKBps;\n                } else {\n                    // We don't know\n                    return 0;\n                }\n            }\n        }\n    }, {\n        key: \"averageKBps\",\n        get: function get() {\n            var durationSeconds = (this._now() - this._firstCheckpoint) / 1000;\n            return this._totalBytes / durationSeconds / 1024;\n        }\n    }]);\n\n    return SpeedSampler;\n}();\n\nexports.default = SpeedSampler;\n\n},{}],28:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n// For FLV over WebSocket live stream\nvar WebSocketLoader = function (_BaseLoader) {\n    _inherits(WebSocketLoader, _BaseLoader);\n\n    _createClass(WebSocketLoader, null, [{\n        key: 'isSupported',\n        value: function isSupported() {\n            try {\n                return typeof self.WebSocket !== 'undefined';\n            } catch (e) {\n                return false;\n            }\n        }\n    }]);\n\n    function WebSocketLoader() {\n        _classCallCheck(this, WebSocketLoader);\n\n        var _this = _possibleConstructorReturn(this, (WebSocketLoader.__proto__ || Object.getPrototypeOf(WebSocketLoader)).call(this, 'websocket-loader'));\n\n        _this.TAG = 'WebSocketLoader';\n\n        _this._needStash = true;\n\n        _this._ws = null;\n        _this._requestAbort = false;\n        _this._receivedLength = 0;\n        return _this;\n    }\n\n    _createClass(WebSocketLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._ws) {\n                this.abort();\n            }\n            _get(WebSocketLoader.prototype.__proto__ || Object.getPrototypeOf(WebSocketLoader.prototype), 'destroy', this).call(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(dataSource) {\n            try {\n                var ws = this._ws = new self.WebSocket(dataSource.url);\n                ws.binaryType = 'arraybuffer';\n                ws.onopen = this._onWebSocketOpen.bind(this);\n                ws.onclose = this._onWebSocketClose.bind(this);\n                ws.onmessage = this._onWebSocketMessage.bind(this);\n                ws.onerror = this._onWebSocketError.bind(this);\n\n                this._status = _loader.LoaderStatus.kConnecting;\n            } catch (e) {\n                this._status = _loader.LoaderStatus.kError;\n\n                var info = { code: e.code, msg: e.message };\n\n                if (this._onError) {\n                    this._onError(_loader.LoaderErrors.EXCEPTION, info);\n                } else {\n                    throw new _exception.RuntimeException(info.msg);\n                }\n            }\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            var ws = this._ws;\n            if (ws && (ws.readyState === 0 || ws.readyState === 1)) {\n                // CONNECTING || OPEN\n                this._requestAbort = true;\n                ws.close();\n            }\n\n            this._ws = null;\n            this._status = _loader.LoaderStatus.kComplete;\n        }\n    }, {\n        key: '_onWebSocketOpen',\n        value: function _onWebSocketOpen(e) {\n            this._status = _loader.LoaderStatus.kBuffering;\n        }\n    }, {\n        key: '_onWebSocketClose',\n        value: function _onWebSocketClose(e) {\n            if (this._requestAbort === true) {\n                this._requestAbort = false;\n                return;\n            }\n\n            this._status = _loader.LoaderStatus.kComplete;\n\n            if (this._onComplete) {\n                this._onComplete(0, this._receivedLength - 1);\n            }\n        }\n    }, {\n        key: '_onWebSocketMessage',\n        value: function _onWebSocketMessage(e) {\n            var _this2 = this;\n\n            if (e.data instanceof ArrayBuffer) {\n                this._dispatchArrayBuffer(e.data);\n            } else if (e.data instanceof Blob) {\n                var reader = new FileReader();\n                reader.onload = function () {\n                    _this2._dispatchArrayBuffer(reader.result);\n                };\n                reader.readAsArrayBuffer(e.data);\n            } else {\n                this._status = _loader.LoaderStatus.kError;\n                var info = { code: -1, msg: 'Unsupported WebSocket message type: ' + e.data.constructor.name };\n\n                if (this._onError) {\n                    this._onError(_loader.LoaderErrors.EXCEPTION, info);\n                } else {\n                    throw new _exception.RuntimeException(info.msg);\n                }\n            }\n        }\n    }, {\n        key: '_dispatchArrayBuffer',\n        value: function _dispatchArrayBuffer(arraybuffer) {\n            var chunk = arraybuffer;\n            var byteStart = this._receivedLength;\n            this._receivedLength += chunk.byteLength;\n\n            if (this._onDataArrival) {\n                this._onDataArrival(chunk, byteStart, this._receivedLength);\n            }\n        }\n    }, {\n        key: '_onWebSocketError',\n        value: function _onWebSocketError(e) {\n            this._status = _loader.LoaderStatus.kError;\n\n            var info = {\n                code: e.code,\n                msg: e.message\n            };\n\n            if (this._onError) {\n                this._onError(_loader.LoaderErrors.EXCEPTION, info);\n            } else {\n                throw new _exception.RuntimeException(info.msg);\n            }\n        }\n    }]);\n\n    return WebSocketLoader;\n}(_loader.BaseLoader);\n\nexports.default = WebSocketLoader;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],29:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n// For FireFox browser which supports `xhr.responseType = 'moz-chunked-arraybuffer'`\nvar MozChunkedLoader = function (_BaseLoader) {\n    _inherits(MozChunkedLoader, _BaseLoader);\n\n    _createClass(MozChunkedLoader, null, [{\n        key: 'isSupported',\n        value: function isSupported() {\n            try {\n                var xhr = new XMLHttpRequest();\n                // Firefox 37- requires .open() to be called before setting responseType\n                xhr.open('GET', 'https://example.com', true);\n                xhr.responseType = 'moz-chunked-arraybuffer';\n                return xhr.responseType === 'moz-chunked-arraybuffer';\n            } catch (e) {\n                _logger2.default.w('MozChunkedLoader', e.message);\n                return false;\n            }\n        }\n    }]);\n\n    function MozChunkedLoader(seekHandler, config) {\n        _classCallCheck(this, MozChunkedLoader);\n\n        var _this = _possibleConstructorReturn(this, (MozChunkedLoader.__proto__ || Object.getPrototypeOf(MozChunkedLoader)).call(this, 'xhr-moz-chunked-loader'));\n\n        _this.TAG = 'MozChunkedLoader';\n\n        _this._seekHandler = seekHandler;\n        _this._config = config;\n        _this._needStash = true;\n\n        _this._xhr = null;\n        _this._requestAbort = false;\n        _this._contentLength = null;\n        _this._receivedLength = 0;\n        return _this;\n    }\n\n    _createClass(MozChunkedLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this.isWorking()) {\n                this.abort();\n            }\n            if (this._xhr) {\n                this._xhr.onreadystatechange = null;\n                this._xhr.onprogress = null;\n                this._xhr.onloadend = null;\n                this._xhr.onerror = null;\n                this._xhr = null;\n            }\n            _get(MozChunkedLoader.prototype.__proto__ || Object.getPrototypeOf(MozChunkedLoader.prototype), 'destroy', this).call(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(dataSource, range) {\n            this._dataSource = dataSource;\n            this._range = range;\n\n            var sourceURL = dataSource.url;\n            if (this._config.reuseRedirectedURL && dataSource.redirectedURL != undefined) {\n                sourceURL = dataSource.redirectedURL;\n            }\n\n            var seekConfig = this._seekHandler.getConfig(sourceURL, range);\n            this._requestURL = seekConfig.url;\n\n            var xhr = this._xhr = new XMLHttpRequest();\n            xhr.open('GET', seekConfig.url, true);\n            xhr.responseType = 'moz-chunked-arraybuffer';\n            xhr.onreadystatechange = this._onReadyStateChange.bind(this);\n            xhr.onprogress = this._onProgress.bind(this);\n            xhr.onloadend = this._onLoadEnd.bind(this);\n            xhr.onerror = this._onXhrError.bind(this);\n\n            // cors is auto detected and enabled by xhr\n\n            // withCredentials is disabled by default\n            if (dataSource.withCredentials) {\n                xhr.withCredentials = true;\n            }\n\n            if (_typeof(seekConfig.headers) === 'object') {\n                var headers = seekConfig.headers;\n\n                for (var key in headers) {\n                    if (headers.hasOwnProperty(key)) {\n                        xhr.setRequestHeader(key, headers[key]);\n                    }\n                }\n            }\n\n            // add additional headers\n            if (_typeof(this._config.headers) === 'object') {\n                var _headers = this._config.headers;\n\n                for (var _key in _headers) {\n                    if (_headers.hasOwnProperty(_key)) {\n                        xhr.setRequestHeader(_key, _headers[_key]);\n                    }\n                }\n            }\n\n            this._status = _loader.LoaderStatus.kConnecting;\n            xhr.send();\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            this._requestAbort = true;\n            if (this._xhr) {\n                this._xhr.abort();\n            }\n            this._status = _loader.LoaderStatus.kComplete;\n        }\n    }, {\n        key: '_onReadyStateChange',\n        value: function _onReadyStateChange(e) {\n            var xhr = e.target;\n\n            if (xhr.readyState === 2) {\n                // HEADERS_RECEIVED\n                if (xhr.responseURL != undefined && xhr.responseURL !== this._requestURL) {\n                    if (this._onURLRedirect) {\n                        var redirectedURL = this._seekHandler.removeURLParameters(xhr.responseURL);\n                        this._onURLRedirect(redirectedURL);\n                    }\n                }\n\n                if (xhr.status !== 0 && (xhr.status < 200 || xhr.status > 299)) {\n                    this._status = _loader.LoaderStatus.kError;\n                    if (this._onError) {\n                        this._onError(_loader.LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: xhr.status, msg: xhr.statusText });\n                    } else {\n                        throw new _exception.RuntimeException('MozChunkedLoader: Http code invalid, ' + xhr.status + ' ' + xhr.statusText);\n                    }\n                } else {\n                    this._status = _loader.LoaderStatus.kBuffering;\n                }\n            }\n        }\n    }, {\n        key: '_onProgress',\n        value: function _onProgress(e) {\n            if (this._status === _loader.LoaderStatus.kError) {\n                // Ignore error response\n                return;\n            }\n\n            if (this._contentLength === null) {\n                if (e.total !== null && e.total !== 0) {\n                    this._contentLength = e.total;\n                    if (this._onContentLengthKnown) {\n                        this._onContentLengthKnown(this._contentLength);\n                    }\n                }\n            }\n\n            var chunk = e.target.response;\n            var byteStart = this._range.from + this._receivedLength;\n            this._receivedLength += chunk.byteLength;\n\n            if (this._onDataArrival) {\n                this._onDataArrival(chunk, byteStart, this._receivedLength);\n            }\n        }\n    }, {\n        key: '_onLoadEnd',\n        value: function _onLoadEnd(e) {\n            if (this._requestAbort === true) {\n                this._requestAbort = false;\n                return;\n            } else if (this._status === _loader.LoaderStatus.kError) {\n                return;\n            }\n\n            this._status = _loader.LoaderStatus.kComplete;\n            if (this._onComplete) {\n                this._onComplete(this._range.from, this._range.from + this._receivedLength - 1);\n            }\n        }\n    }, {\n        key: '_onXhrError',\n        value: function _onXhrError(e) {\n            this._status = _loader.LoaderStatus.kError;\n            var type = 0;\n            var info = null;\n\n            if (this._contentLength && e.loaded < this._contentLength) {\n                type = _loader.LoaderErrors.EARLY_EOF;\n                info = { code: -1, msg: 'Moz-Chunked stream meet Early-Eof' };\n            } else {\n                type = _loader.LoaderErrors.EXCEPTION;\n                info = { code: -1, msg: e.constructor.name + ' ' + e.type };\n            }\n\n            if (this._onError) {\n                this._onError(type, info);\n            } else {\n                throw new _exception.RuntimeException(info.msg);\n            }\n        }\n    }]);\n\n    return MozChunkedLoader;\n}(_loader.BaseLoader);\n\nexports.default = MozChunkedLoader;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],30:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/* Notice: ms-stream may cause IE/Edge browser crash if seek too frequently!!!\r\n * The browser may crash in wininet.dll. Disable for now.\r\n *\r\n * For IE11/Edge browser by microsoft which supports `xhr.responseType = 'ms-stream'`\r\n * Notice that ms-stream API sucks. The buffer is always expanding along with downloading.\r\n *\r\n * We need to abort the xhr if buffer size exceeded limit size (e.g. 16 MiB), then do reconnect.\r\n * in order to release previous ArrayBuffer to avoid memory leak\r\n *\r\n * Otherwise, the ArrayBuffer will increase to a terrible size that equals final file size.\r\n */\nvar MSStreamLoader = function (_BaseLoader) {\n    _inherits(MSStreamLoader, _BaseLoader);\n\n    _createClass(MSStreamLoader, null, [{\n        key: 'isSupported',\n        value: function isSupported() {\n            try {\n                if (typeof self.MSStream === 'undefined' || typeof self.MSStreamReader === 'undefined') {\n                    return false;\n                }\n\n                var xhr = new XMLHttpRequest();\n                xhr.open('GET', 'https://example.com', true);\n                xhr.responseType = 'ms-stream';\n                return xhr.responseType === 'ms-stream';\n            } catch (e) {\n                _logger2.default.w('MSStreamLoader', e.message);\n                return false;\n            }\n        }\n    }]);\n\n    function MSStreamLoader(seekHandler, config) {\n        _classCallCheck(this, MSStreamLoader);\n\n        var _this = _possibleConstructorReturn(this, (MSStreamLoader.__proto__ || Object.getPrototypeOf(MSStreamLoader)).call(this, 'xhr-msstream-loader'));\n\n        _this.TAG = 'MSStreamLoader';\n\n        _this._seekHandler = seekHandler;\n        _this._config = config;\n        _this._needStash = true;\n\n        _this._xhr = null;\n        _this._reader = null; // MSStreamReader\n\n        _this._totalRange = null;\n        _this._currentRange = null;\n\n        _this._currentRequestURL = null;\n        _this._currentRedirectedURL = null;\n\n        _this._contentLength = null;\n        _this._receivedLength = 0;\n\n        _this._bufferLimit = 16 * 1024 * 1024; // 16MB\n        _this._lastTimeBufferSize = 0;\n        _this._isReconnecting = false;\n        return _this;\n    }\n\n    _createClass(MSStreamLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this.isWorking()) {\n                this.abort();\n            }\n            if (this._reader) {\n                this._reader.onprogress = null;\n                this._reader.onload = null;\n                this._reader.onerror = null;\n                this._reader = null;\n            }\n            if (this._xhr) {\n                this._xhr.onreadystatechange = null;\n                this._xhr = null;\n            }\n            _get(MSStreamLoader.prototype.__proto__ || Object.getPrototypeOf(MSStreamLoader.prototype), 'destroy', this).call(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(dataSource, range) {\n            this._internalOpen(dataSource, range, false);\n        }\n    }, {\n        key: '_internalOpen',\n        value: function _internalOpen(dataSource, range, isSubrange) {\n            this._dataSource = dataSource;\n\n            if (!isSubrange) {\n                this._totalRange = range;\n            } else {\n                this._currentRange = range;\n            }\n\n            var sourceURL = dataSource.url;\n            if (this._config.reuseRedirectedURL) {\n                if (this._currentRedirectedURL != undefined) {\n                    sourceURL = this._currentRedirectedURL;\n                } else if (dataSource.redirectedURL != undefined) {\n                    sourceURL = dataSource.redirectedURL;\n                }\n            }\n\n            var seekConfig = this._seekHandler.getConfig(sourceURL, range);\n            this._currentRequestURL = seekConfig.url;\n\n            var reader = this._reader = new self.MSStreamReader();\n            reader.onprogress = this._msrOnProgress.bind(this);\n            reader.onload = this._msrOnLoad.bind(this);\n            reader.onerror = this._msrOnError.bind(this);\n\n            var xhr = this._xhr = new XMLHttpRequest();\n            xhr.open('GET', seekConfig.url, true);\n            xhr.responseType = 'ms-stream';\n            xhr.onreadystatechange = this._xhrOnReadyStateChange.bind(this);\n            xhr.onerror = this._xhrOnError.bind(this);\n\n            if (dataSource.withCredentials) {\n                xhr.withCredentials = true;\n            }\n\n            if (_typeof(seekConfig.headers) === 'object') {\n                var headers = seekConfig.headers;\n\n                for (var key in headers) {\n                    if (headers.hasOwnProperty(key)) {\n                        xhr.setRequestHeader(key, headers[key]);\n                    }\n                }\n            }\n\n            // add additional headers\n            if (_typeof(this._config.headers) === 'object') {\n                var _headers = this._config.headers;\n\n                for (var _key in _headers) {\n                    if (_headers.hasOwnProperty(_key)) {\n                        xhr.setRequestHeader(_key, _headers[_key]);\n                    }\n                }\n            }\n\n            if (this._isReconnecting) {\n                this._isReconnecting = false;\n            } else {\n                this._status = _loader.LoaderStatus.kConnecting;\n            }\n            xhr.send();\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            this._internalAbort();\n            this._status = _loader.LoaderStatus.kComplete;\n        }\n    }, {\n        key: '_internalAbort',\n        value: function _internalAbort() {\n            if (this._reader) {\n                if (this._reader.readyState === 1) {\n                    // LOADING\n                    this._reader.abort();\n                }\n                this._reader.onprogress = null;\n                this._reader.onload = null;\n                this._reader.onerror = null;\n                this._reader = null;\n            }\n            if (this._xhr) {\n                this._xhr.abort();\n                this._xhr.onreadystatechange = null;\n                this._xhr = null;\n            }\n        }\n    }, {\n        key: '_xhrOnReadyStateChange',\n        value: function _xhrOnReadyStateChange(e) {\n            var xhr = e.target;\n\n            if (xhr.readyState === 2) {\n                // HEADERS_RECEIVED\n                if (xhr.status >= 200 && xhr.status <= 299) {\n                    this._status = _loader.LoaderStatus.kBuffering;\n\n                    if (xhr.responseURL != undefined) {\n                        var redirectedURL = this._seekHandler.removeURLParameters(xhr.responseURL);\n                        if (xhr.responseURL !== this._currentRequestURL && redirectedURL !== this._currentRedirectedURL) {\n                            this._currentRedirectedURL = redirectedURL;\n                            if (this._onURLRedirect) {\n                                this._onURLRedirect(redirectedURL);\n                            }\n                        }\n                    }\n\n                    var lengthHeader = xhr.getResponseHeader('Content-Length');\n                    if (lengthHeader != null && this._contentLength == null) {\n                        var length = parseInt(lengthHeader);\n                        if (length > 0) {\n                            this._contentLength = length;\n                            if (this._onContentLengthKnown) {\n                                this._onContentLengthKnown(this._contentLength);\n                            }\n                        }\n                    }\n                } else {\n                    this._status = _loader.LoaderStatus.kError;\n                    if (this._onError) {\n                        this._onError(_loader.LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: xhr.status, msg: xhr.statusText });\n                    } else {\n                        throw new _exception.RuntimeException('MSStreamLoader: Http code invalid, ' + xhr.status + ' ' + xhr.statusText);\n                    }\n                }\n            } else if (xhr.readyState === 3) {\n                // LOADING\n                if (xhr.status >= 200 && xhr.status <= 299) {\n                    this._status = _loader.LoaderStatus.kBuffering;\n\n                    var msstream = xhr.response;\n                    this._reader.readAsArrayBuffer(msstream);\n                }\n            }\n        }\n    }, {\n        key: '_xhrOnError',\n        value: function _xhrOnError(e) {\n            this._status = _loader.LoaderStatus.kError;\n            var type = _loader.LoaderErrors.EXCEPTION;\n            var info = { code: -1, msg: e.constructor.name + ' ' + e.type };\n\n            if (this._onError) {\n                this._onError(type, info);\n            } else {\n                throw new _exception.RuntimeException(info.msg);\n            }\n        }\n    }, {\n        key: '_msrOnProgress',\n        value: function _msrOnProgress(e) {\n            var reader = e.target;\n            var bigbuffer = reader.result;\n            if (bigbuffer == null) {\n                // result may be null, workaround for buggy M$\n                this._doReconnectIfNeeded();\n                return;\n            }\n\n            var slice = bigbuffer.slice(this._lastTimeBufferSize);\n            this._lastTimeBufferSize = bigbuffer.byteLength;\n            var byteStart = this._totalRange.from + this._receivedLength;\n            this._receivedLength += slice.byteLength;\n\n            if (this._onDataArrival) {\n                this._onDataArrival(slice, byteStart, this._receivedLength);\n            }\n\n            if (bigbuffer.byteLength >= this._bufferLimit) {\n                _logger2.default.v(this.TAG, 'MSStream buffer exceeded max size near ' + (byteStart + slice.byteLength) + ', reconnecting...');\n                this._doReconnectIfNeeded();\n            }\n        }\n    }, {\n        key: '_doReconnectIfNeeded',\n        value: function _doReconnectIfNeeded() {\n            if (this._contentLength == null || this._receivedLength < this._contentLength) {\n                this._isReconnecting = true;\n                this._lastTimeBufferSize = 0;\n                this._internalAbort();\n\n                var range = {\n                    from: this._totalRange.from + this._receivedLength,\n                    to: -1\n                };\n                this._internalOpen(this._dataSource, range, true);\n            }\n        }\n    }, {\n        key: '_msrOnLoad',\n        value: function _msrOnLoad(e) {\n            // actually it is onComplete event\n            this._status = _loader.LoaderStatus.kComplete;\n            if (this._onComplete) {\n                this._onComplete(this._totalRange.from, this._totalRange.from + this._receivedLength - 1);\n            }\n        }\n    }, {\n        key: '_msrOnError',\n        value: function _msrOnError(e) {\n            this._status = _loader.LoaderStatus.kError;\n            var type = 0;\n            var info = null;\n\n            if (this._contentLength && this._receivedLength < this._contentLength) {\n                type = _loader.LoaderErrors.EARLY_EOF;\n                info = { code: -1, msg: 'MSStream meet Early-Eof' };\n            } else {\n                type = _loader.LoaderErrors.EARLY_EOF;\n                info = { code: -1, msg: e.constructor.name + ' ' + e.type };\n            }\n\n            if (this._onError) {\n                this._onError(type, info);\n            } else {\n                throw new _exception.RuntimeException(info.msg);\n            }\n        }\n    }]);\n\n    return MSStreamLoader;\n}(_loader.BaseLoader);\n\nexports.default = MSStreamLoader;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],31:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _speedSampler = _dereq_('./speed-sampler.js');\n\nvar _speedSampler2 = _interopRequireDefault(_speedSampler);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n// Universal IO Loader, implemented by adding Range header in xhr's request header\nvar RangeLoader = function (_BaseLoader) {\n    _inherits(RangeLoader, _BaseLoader);\n\n    _createClass(RangeLoader, null, [{\n        key: 'isSupported',\n        value: function isSupported() {\n            try {\n                var xhr = new XMLHttpRequest();\n                xhr.open('GET', 'https://example.com', true);\n                xhr.responseType = 'arraybuffer';\n                return xhr.responseType === 'arraybuffer';\n            } catch (e) {\n                _logger2.default.w('RangeLoader', e.message);\n                return false;\n            }\n        }\n    }]);\n\n    function RangeLoader(seekHandler, config) {\n        _classCallCheck(this, RangeLoader);\n\n        var _this = _possibleConstructorReturn(this, (RangeLoader.__proto__ || Object.getPrototypeOf(RangeLoader)).call(this, 'xhr-range-loader'));\n\n        _this.TAG = 'RangeLoader';\n\n        _this._seekHandler = seekHandler;\n        _this._config = config;\n        _this._needStash = false;\n\n        _this._chunkSizeKBList = [128, 256, 384, 512, 768, 1024, 1536, 2048, 3072, 4096, 5120, 6144, 7168, 8192];\n        _this._currentChunkSizeKB = 384;\n        _this._currentSpeedNormalized = 0;\n        _this._zeroSpeedChunkCount = 0;\n\n        _this._xhr = null;\n        _this._speedSampler = new _speedSampler2.default();\n\n        _this._requestAbort = false;\n        _this._waitForTotalLength = false;\n        _this._totalLengthReceived = false;\n\n        _this._currentRequestURL = null;\n        _this._currentRedirectedURL = null;\n        _this._currentRequestRange = null;\n        _this._totalLength = null; // size of the entire file\n        _this._contentLength = null; // Content-Length of entire request range\n        _this._receivedLength = 0; // total received bytes\n        _this._lastTimeLoaded = 0; // received bytes of current request sub-range\n        return _this;\n    }\n\n    _createClass(RangeLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this.isWorking()) {\n                this.abort();\n            }\n            if (this._xhr) {\n                this._xhr.onreadystatechange = null;\n                this._xhr.onprogress = null;\n                this._xhr.onload = null;\n                this._xhr.onerror = null;\n                this._xhr = null;\n            }\n            _get(RangeLoader.prototype.__proto__ || Object.getPrototypeOf(RangeLoader.prototype), 'destroy', this).call(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(dataSource, range) {\n            this._dataSource = dataSource;\n            this._range = range;\n            this._status = _loader.LoaderStatus.kConnecting;\n\n            var useRefTotalLength = false;\n            if (this._dataSource.filesize != undefined && this._dataSource.filesize !== 0) {\n                useRefTotalLength = true;\n                this._totalLength = this._dataSource.filesize;\n            }\n\n            if (!this._totalLengthReceived && !useRefTotalLength) {\n                // We need total filesize\n                this._waitForTotalLength = true;\n                this._internalOpen(this._dataSource, { from: 0, to: -1 });\n            } else {\n                // We have filesize, start loading\n                this._openSubRange();\n            }\n        }\n    }, {\n        key: '_openSubRange',\n        value: function _openSubRange() {\n            var chunkSize = this._currentChunkSizeKB * 1024;\n\n            var from = this._range.from + this._receivedLength;\n            var to = from + chunkSize;\n\n            if (this._contentLength != null) {\n                if (to - this._range.from >= this._contentLength) {\n                    to = this._range.from + this._contentLength - 1;\n                }\n            }\n\n            this._currentRequestRange = { from: from, to: to };\n            this._internalOpen(this._dataSource, this._currentRequestRange);\n        }\n    }, {\n        key: '_internalOpen',\n        value: function _internalOpen(dataSource, range) {\n            this._lastTimeLoaded = 0;\n\n            var sourceURL = dataSource.url;\n            if (this._config.reuseRedirectedURL) {\n                if (this._currentRedirectedURL != undefined) {\n                    sourceURL = this._currentRedirectedURL;\n                } else if (dataSource.redirectedURL != undefined) {\n                    sourceURL = dataSource.redirectedURL;\n                }\n            }\n\n            var seekConfig = this._seekHandler.getConfig(sourceURL, range);\n            this._currentRequestURL = seekConfig.url;\n\n            var xhr = this._xhr = new XMLHttpRequest();\n            xhr.open('GET', seekConfig.url, true);\n            xhr.responseType = 'arraybuffer';\n            xhr.onreadystatechange = this._onReadyStateChange.bind(this);\n            xhr.onprogress = this._onProgress.bind(this);\n            xhr.onload = this._onLoad.bind(this);\n            xhr.onerror = this._onXhrError.bind(this);\n\n            if (dataSource.withCredentials) {\n                xhr.withCredentials = true;\n            }\n\n            if (_typeof(seekConfig.headers) === 'object') {\n                var headers = seekConfig.headers;\n\n                for (var key in headers) {\n                    if (headers.hasOwnProperty(key)) {\n                        xhr.setRequestHeader(key, headers[key]);\n                    }\n                }\n            }\n\n            // add additional headers\n            if (_typeof(this._config.headers) === 'object') {\n                var _headers = this._config.headers;\n\n                for (var _key in _headers) {\n                    if (_headers.hasOwnProperty(_key)) {\n                        xhr.setRequestHeader(_key, _headers[_key]);\n                    }\n                }\n            }\n\n            xhr.send();\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            this._requestAbort = true;\n            this._internalAbort();\n            this._status = _loader.LoaderStatus.kComplete;\n        }\n    }, {\n        key: '_internalAbort',\n        value: function _internalAbort() {\n            if (this._xhr) {\n                this._xhr.onreadystatechange = null;\n                this._xhr.onprogress = null;\n                this._xhr.onload = null;\n                this._xhr.onerror = null;\n                this._xhr.abort();\n                this._xhr = null;\n            }\n        }\n    }, {\n        key: '_onReadyStateChange',\n        value: function _onReadyStateChange(e) {\n            var xhr = e.target;\n\n            if (xhr.readyState === 2) {\n                // HEADERS_RECEIVED\n                if (xhr.responseURL != undefined) {\n                    // if the browser support this property\n                    var redirectedURL = this._seekHandler.removeURLParameters(xhr.responseURL);\n                    if (xhr.responseURL !== this._currentRequestURL && redirectedURL !== this._currentRedirectedURL) {\n                        this._currentRedirectedURL = redirectedURL;\n                        if (this._onURLRedirect) {\n                            this._onURLRedirect(redirectedURL);\n                        }\n                    }\n                }\n\n                if (xhr.status >= 200 && xhr.status <= 299) {\n                    if (this._waitForTotalLength) {\n                        return;\n                    }\n                    this._status = _loader.LoaderStatus.kBuffering;\n                } else {\n                    this._status = _loader.LoaderStatus.kError;\n                    if (this._onError) {\n                        this._onError(_loader.LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: xhr.status, msg: xhr.statusText });\n                    } else {\n                        throw new _exception.RuntimeException('RangeLoader: Http code invalid, ' + xhr.status + ' ' + xhr.statusText);\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_onProgress',\n        value: function _onProgress(e) {\n            if (this._status === _loader.LoaderStatus.kError) {\n                // Ignore error response\n                return;\n            }\n\n            if (this._contentLength === null) {\n                var openNextRange = false;\n\n                if (this._waitForTotalLength) {\n                    this._waitForTotalLength = false;\n                    this._totalLengthReceived = true;\n                    openNextRange = true;\n\n                    var total = e.total;\n                    this._internalAbort();\n                    if (total != null & total !== 0) {\n                        this._totalLength = total;\n                    }\n                }\n\n                // calculate currrent request range's contentLength\n                if (this._range.to === -1) {\n                    this._contentLength = this._totalLength - this._range.from;\n                } else {\n                    // to !== -1\n                    this._contentLength = this._range.to - this._range.from + 1;\n                }\n\n                if (openNextRange) {\n                    this._openSubRange();\n                    return;\n                }\n                if (this._onContentLengthKnown) {\n                    this._onContentLengthKnown(this._contentLength);\n                }\n            }\n\n            var delta = e.loaded - this._lastTimeLoaded;\n            this._lastTimeLoaded = e.loaded;\n            this._speedSampler.addBytes(delta);\n        }\n    }, {\n        key: '_normalizeSpeed',\n        value: function _normalizeSpeed(input) {\n            var list = this._chunkSizeKBList;\n            var last = list.length - 1;\n            var mid = 0;\n            var lbound = 0;\n            var ubound = last;\n\n            if (input < list[0]) {\n                return list[0];\n            }\n\n            while (lbound <= ubound) {\n                mid = lbound + Math.floor((ubound - lbound) / 2);\n                if (mid === last || input >= list[mid] && input < list[mid + 1]) {\n                    return list[mid];\n                } else if (list[mid] < input) {\n                    lbound = mid + 1;\n                } else {\n                    ubound = mid - 1;\n                }\n            }\n        }\n    }, {\n        key: '_onLoad',\n        value: function _onLoad(e) {\n            if (this._status === _loader.LoaderStatus.kError) {\n                // Ignore error response\n                return;\n            }\n\n            if (this._waitForTotalLength) {\n                this._waitForTotalLength = false;\n                return;\n            }\n\n            this._lastTimeLoaded = 0;\n            var KBps = this._speedSampler.lastSecondKBps;\n            if (KBps === 0) {\n                this._zeroSpeedChunkCount++;\n                if (this._zeroSpeedChunkCount >= 3) {\n                    // Try get currentKBps after 3 chunks\n                    KBps = this._speedSampler.currentKBps;\n                }\n            }\n\n            if (KBps !== 0) {\n                var normalized = this._normalizeSpeed(KBps);\n                if (this._currentSpeedNormalized !== normalized) {\n                    this._currentSpeedNormalized = normalized;\n                    this._currentChunkSizeKB = normalized;\n                }\n            }\n\n            var chunk = e.target.response;\n            var byteStart = this._range.from + this._receivedLength;\n            this._receivedLength += chunk.byteLength;\n\n            var reportComplete = false;\n\n            if (this._contentLength != null && this._receivedLength < this._contentLength) {\n                // continue load next chunk\n                this._openSubRange();\n            } else {\n                reportComplete = true;\n            }\n\n            // dispatch received chunk\n            if (this._onDataArrival) {\n                this._onDataArrival(chunk, byteStart, this._receivedLength);\n            }\n\n            if (reportComplete) {\n                this._status = _loader.LoaderStatus.kComplete;\n                if (this._onComplete) {\n                    this._onComplete(this._range.from, this._range.from + this._receivedLength - 1);\n                }\n            }\n        }\n    }, {\n        key: '_onXhrError',\n        value: function _onXhrError(e) {\n            this._status = _loader.LoaderStatus.kError;\n            var type = 0;\n            var info = null;\n\n            if (this._contentLength && this._receivedLength > 0 && this._receivedLength < this._contentLength) {\n                type = _loader.LoaderErrors.EARLY_EOF;\n                info = { code: -1, msg: 'RangeLoader meet Early-Eof' };\n            } else {\n                type = _loader.LoaderErrors.EXCEPTION;\n                info = { code: -1, msg: e.constructor.name + ' ' + e.type };\n            }\n\n            if (this._onError) {\n                this._onError(type, info);\n            } else {\n                throw new _exception.RuntimeException(info.msg);\n            }\n        }\n    }, {\n        key: 'currentSpeed',\n        get: function get() {\n            return this._speedSampler.lastSecondKBps;\n        }\n    }]);\n\n    return RangeLoader;\n}(_loader.BaseLoader);\n\nexports.default = RangeLoader;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24,\"./speed-sampler.js\":27}],32:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _browser = _dereq_('../utils/browser.js');\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _playerEvents = _dereq_('./player-events.js');\n\nvar _playerEvents2 = _interopRequireDefault(_playerEvents);\n\nvar _transmuxer = _dereq_('../core/transmuxer.js');\n\nvar _transmuxer2 = _interopRequireDefault(_transmuxer);\n\nvar _transmuxingEvents = _dereq_('../core/transmuxing-events.js');\n\nvar _transmuxingEvents2 = _interopRequireDefault(_transmuxingEvents);\n\nvar _mseController = _dereq_('../core/mse-controller.js');\n\nvar _mseController2 = _interopRequireDefault(_mseController);\n\nvar _mseEvents = _dereq_('../core/mse-events.js');\n\nvar _mseEvents2 = _interopRequireDefault(_mseEvents);\n\nvar _playerErrors = _dereq_('./player-errors.js');\n\nvar _config = _dereq_('../config.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar FlvPlayer = function () {\n    function FlvPlayer(mediaDataSource, config) {\n        _classCallCheck(this, FlvPlayer);\n\n        this.TAG = 'FlvPlayer';\n        this._type = 'FlvPlayer';\n        this._emitter = new _events2.default();\n\n        this._config = (0, _config.createDefaultConfig)();\n        if ((typeof config === 'undefined' ? 'undefined' : _typeof(config)) === 'object') {\n            Object.assign(this._config, config);\n        }\n\n        if (mediaDataSource.type.toLowerCase() !== 'flv') {\n            throw new _exception.InvalidArgumentException('FlvPlayer requires an flv MediaDataSource input!');\n        }\n\n        if (mediaDataSource.isLive === true) {\n            this._config.isLive = true;\n        }\n\n        this.e = {\n            onvLoadedMetadata: this._onvLoadedMetadata.bind(this),\n            onvSeeking: this._onvSeeking.bind(this),\n            onvCanPlay: this._onvCanPlay.bind(this),\n            onvStalled: this._onvStalled.bind(this),\n            onvProgress: this._onvProgress.bind(this)\n        };\n\n        if (self.performance && self.performance.now) {\n            this._now = self.performance.now.bind(self.performance);\n        } else {\n            this._now = Date.now;\n        }\n\n        this._pendingSeekTime = null; // in seconds\n        this._requestSetTime = false;\n        this._seekpointRecord = null;\n        this._progressChecker = null;\n\n        this._mediaDataSource = mediaDataSource;\n        this._mediaElement = null;\n        this._msectl = null;\n        this._transmuxer = null;\n\n        this._mseSourceOpened = false;\n        this._hasPendingLoad = false;\n        this._receivedCanPlay = false;\n\n        this._mediaInfo = null;\n        this._statisticsInfo = null;\n\n        var chromeNeedIDRFix = _browser2.default.chrome && (_browser2.default.version.major < 50 || _browser2.default.version.major === 50 && _browser2.default.version.build < 2661);\n        this._alwaysSeekKeyframe = chromeNeedIDRFix || _browser2.default.msedge || _browser2.default.msie ? true : false;\n\n        if (this._alwaysSeekKeyframe) {\n            this._config.accurateSeek = false;\n        }\n\n        this.callbackStreamTime = null;\n        this._mediaSourceEndCallback = null;\n    }\n\n    _createClass(FlvPlayer, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._progressChecker != null) {\n                window.clearInterval(this._progressChecker);\n                this._progressChecker = null;\n            }\n            if (this._transmuxer) {\n                this.unload();\n            }\n            if (this._mediaElement) {\n                this.detachMediaElement();\n            }\n            this.e = null;\n            this._mediaDataSource = null;\n\n            this._emitter.removeAllListeners();\n            this._emitter = null;\n\n            this.callbackStreamTime = null;\n            this._mediaSourceEndCallback = null;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, listener) {\n            var _this = this;\n\n            if (event === _playerEvents2.default.MEDIA_INFO) {\n                if (this._mediaInfo != null) {\n                    Promise.resolve().then(function () {\n                        _this._emitter.emit(_playerEvents2.default.MEDIA_INFO, _this.mediaInfo);\n                    });\n                }\n            } else if (event === _playerEvents2.default.STATISTICS_INFO) {\n                if (this._statisticsInfo != null) {\n                    Promise.resolve().then(function () {\n                        _this._emitter.emit(_playerEvents2.default.STATISTICS_INFO, _this.statisticsInfo);\n                    });\n                }\n            }\n            this._emitter.addListener(event, listener);\n        }\n    }, {\n        key: 'off',\n        value: function off(event, listener) {\n            this._emitter.removeListener(event, listener);\n        }\n    }, {\n        key: 'attachMediaElement',\n        value: function attachMediaElement(mediaElement) {\n            var _this2 = this;\n\n            this._mediaElement = mediaElement;\n            mediaElement.addEventListener('loadedmetadata', this.e.onvLoadedMetadata);\n            //mediaElement.addEventListener('seeking', this.e.onvSeeking);\n            mediaElement.addEventListener('canplay', this.e.onvCanPlay);\n            mediaElement.addEventListener('stalled', this.e.onvStalled);\n            //mediaElement.addEventListener('progress', this.e.onvProgress);\n\n            this._msectl = new _mseController2.default(this._config);\n\n            this._msectl.on(_mseEvents2.default.UPDATE_END, this._onmseUpdateEnd.bind(this));\n            this._msectl.on(_mseEvents2.default.BUFFER_FULL, this._onmseBufferFull.bind(this));\n            this._msectl.on(_mseEvents2.default.SOURCE_OPEN, function () {\n                _this2._mseSourceOpened = true;\n                if (_this2._hasPendingLoad) {\n                    _this2._hasPendingLoad = false;\n                    _this2.load();\n                }\n            });\n            this._msectl.on(_mseEvents2.default.ERROR, function (info) {\n                _this2._emitter.emit(_playerEvents2.default.ERROR, _playerErrors.ErrorTypes.MEDIA_ERROR, _playerErrors.ErrorDetails.MEDIA_MSE_ERROR, info);\n            });\n            this._msectl.on(_mseEvents2.default.SOURCE_END, function (info) {\n                if (_this2._mediaSourceEndCallback != null) {\n                    _this2._mediaSourceEndCallback(info);\n                }\n            });\n\n            this._msectl.attachMediaElement(mediaElement);\n\n            if (this._pendingSeekTime != null) {\n                try {\n                    mediaElement.currentTime = this._pendingSeekTime;\n                    this._pendingSeekTime = null;\n                } catch (e) {\n                    // IE11 may throw InvalidStateError if readyState === 0\n                    // We can defer set currentTime operation after loadedmetadata\n                }\n            }\n        }\n    }, {\n        key: 'detachMediaElement',\n        value: function detachMediaElement() {\n            if (this._mediaElement) {\n                this._msectl.detachMediaElement();\n                this._mediaElement.removeEventListener('loadedmetadata', this.e.onvLoadedMetadata);\n                //this._mediaElement.removeEventListener('seeking', this.e.onvSeeking);\n                this._mediaElement.removeEventListener('canplay', this.e.onvCanPlay);\n                this._mediaElement.removeEventListener('stalled', this.e.onvStalled);\n                //this._mediaElement.removeEventListener('progress', this.e.onvProgress);\n                this._mediaElement = null;\n            }\n            if (this._msectl) {\n                this._msectl.destroy();\n                this._msectl = null;\n            }\n        }\n    }, {\n        key: 'load',\n        value: function load() {\n            var _this3 = this;\n\n            if (!this._mediaElement) {\n                throw new _exception.IllegalStateException('HTMLMediaElement must be attached before load()!');\n            }\n            if (this._transmuxer) {\n                throw new _exception.IllegalStateException('FlvPlayer.load() has been called, please call unload() first!');\n            }\n            if (this._hasPendingLoad) {\n                return;\n            }\n\n            if (this._config.deferLoadAfterSourceOpen && this._mseSourceOpened === false) {\n                this._hasPendingLoad = true;\n                return;\n            }\n\n            if (this._mediaElement.readyState > 0) {\n                this._requestSetTime = true;\n                // IE11 may throw InvalidStateError if readyState === 0\n                this._mediaElement.currentTime = 0;\n            }\n\n            this._transmuxer = new _transmuxer2.default(this._mediaDataSource, this._config);\n\n            this._transmuxer.on(_transmuxingEvents2.default.INIT_SEGMENT, function (type, is) {\n                _this3._msectl.appendInitSegment(is);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.MEDIA_SEGMENT, function (type, ms) {\n                _this3._msectl.appendMediaSegment(ms);\n\n                // lazyLoad check\n                if (_this3._config.lazyLoad && !_this3._config.isLive) {\n                    var currentTime = _this3._mediaElement.currentTime;\n                    if (ms.info.endDts >= (currentTime + _this3._config.lazyLoadMaxDuration) * 1000) {\n                        if (_this3._progressChecker == null) {\n                            _logger2.default.v(_this3.TAG, 'Maximum buffering duration exceeded, suspend transmuxing task');\n                            _this3._suspendTransmuxer();\n                        }\n                    }\n                }\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.LOADING_COMPLETE, function () {\n                _this3._msectl.endOfStream();\n                _this3._emitter.emit(_playerEvents2.default.LOADING_COMPLETE);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.RECOVERED_EARLY_EOF, function () {\n                _this3._emitter.emit(_playerEvents2.default.RECOVERED_EARLY_EOF);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.IO_ERROR, function (detail, info) {\n                _this3._emitter.emit(_playerEvents2.default.ERROR, _playerErrors.ErrorTypes.NETWORK_ERROR, detail, info);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.DEMUX_ERROR, function (detail, info) {\n                _this3._emitter.emit(_playerEvents2.default.ERROR, _playerErrors.ErrorTypes.MEDIA_ERROR, detail, { code: -1, msg: info });\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.MEDIA_INFO, function (mediaInfo) {\n                _this3._mediaInfo = mediaInfo;\n                _this3._emitter.emit(_playerEvents2.default.MEDIA_INFO, Object.assign({}, mediaInfo));\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.METADATA_ARRIVED, function (metadata) {\n                _this3._emitter.emit(_playerEvents2.default.METADATA_ARRIVED, metadata);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.SCRIPTDATA_ARRIVED, function (data) {\n                _this3._emitter.emit(_playerEvents2.default.SCRIPTDATA_ARRIVED, data);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.STATISTICS_INFO, function (statInfo) {\n                _this3._statisticsInfo = _this3._fillStatisticsInfo(statInfo);\n                _this3._emitter.emit(_playerEvents2.default.STATISTICS_INFO, Object.assign({}, _this3._statisticsInfo));\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, function (milliseconds) {\n                if (_this3._mediaElement && !_this3._config.accurateSeek) {\n                    _this3._requestSetTime = true;\n                    _this3._mediaElement.currentTime = milliseconds / 1000;\n                }\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.STREAM_TIME, function (ts) {\n                _this3._receiveStreamTime(ts);\n            });\n\n            this._transmuxer.open();\n        }\n    }, {\n        key: 'unload',\n        value: function unload() {\n            if (this._mediaElement) {\n                this._mediaElement.pause();\n            }\n            if (this._msectl) {\n                this._msectl.seek(0);\n            }\n            if (this._transmuxer) {\n                this._transmuxer.close();\n                this._transmuxer.destroy();\n                this._transmuxer = null;\n            }\n        }\n    }, {\n        key: 'play',\n        value: function play() {\n            return this._mediaElement.play();\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            this._mediaElement.pause();\n        }\n    }, {\n        key: '_fillStatisticsInfo',\n        value: function _fillStatisticsInfo(statInfo) {\n            statInfo.playerType = this._type;\n\n            if (!(this._mediaElement instanceof HTMLVideoElement)) {\n                return statInfo;\n            }\n\n            var hasQualityInfo = true;\n            var decoded = 0;\n            var dropped = 0;\n\n            if (this._mediaElement.getVideoPlaybackQuality) {\n                var quality = this._mediaElement.getVideoPlaybackQuality();\n                decoded = quality.totalVideoFrames;\n                dropped = quality.droppedVideoFrames;\n            } else if (this._mediaElement.webkitDecodedFrameCount != undefined) {\n                decoded = this._mediaElement.webkitDecodedFrameCount;\n                dropped = this._mediaElement.webkitDroppedFrameCount;\n            } else {\n                hasQualityInfo = false;\n            }\n\n            if (hasQualityInfo) {\n                statInfo.decodedFrames = decoded;\n                statInfo.droppedFrames = dropped;\n            }\n\n            return statInfo;\n        }\n    }, {\n        key: '_onmseUpdateEnd',\n        value: function _onmseUpdateEnd() {\n            if (!this._config.lazyLoad || this._config.isLive) {\n                return;\n            }\n\n            var buffered = this._mediaElement.buffered;\n            var currentTime = this._mediaElement.currentTime;\n            var currentRangeStart = 0;\n            var currentRangeEnd = 0;\n\n            for (var i = 0; i < buffered.length; i++) {\n                var start = buffered.start(i);\n                var end = buffered.end(i);\n                if (start <= currentTime && currentTime < end) {\n                    currentRangeStart = start;\n                    currentRangeEnd = end;\n                    break;\n                }\n            }\n\n            if (currentRangeEnd >= currentTime + this._config.lazyLoadMaxDuration && this._progressChecker == null) {\n                _logger2.default.v(this.TAG, 'Maximum buffering duration exceeded, suspend transmuxing task');\n                this._suspendTransmuxer();\n            }\n        }\n    }, {\n        key: '_onmseBufferFull',\n        value: function _onmseBufferFull() {\n            _logger2.default.v(this.TAG, 'MSE SourceBuffer is full, suspend transmuxing task');\n            if (this._progressChecker == null) {\n                this._suspendTransmuxer();\n            }\n        }\n    }, {\n        key: '_suspendTransmuxer',\n        value: function _suspendTransmuxer() {\n            if (this._transmuxer) {\n                this._transmuxer.pause();\n\n                if (this._progressChecker == null) {\n                    this._progressChecker = window.setInterval(this._checkProgressAndResume.bind(this), 1000);\n                }\n            }\n        }\n    }, {\n        key: '_checkProgressAndResume',\n        value: function _checkProgressAndResume() {\n            var currentTime = this._mediaElement.currentTime;\n            var buffered = this._mediaElement.buffered;\n\n            var needResume = false;\n\n            for (var i = 0; i < buffered.length; i++) {\n                var from = buffered.start(i);\n                var to = buffered.end(i);\n                if (currentTime >= from && currentTime < to) {\n                    if (currentTime >= to - this._config.lazyLoadRecoverDuration) {\n                        needResume = true;\n                    }\n                    break;\n                }\n            }\n\n            if (needResume) {\n                window.clearInterval(this._progressChecker);\n                this._progressChecker = null;\n                if (needResume) {\n                    _logger2.default.v(this.TAG, 'Continue loading from paused position');\n                    this._transmuxer.resume();\n                }\n            }\n        }\n    }, {\n        key: '_isTimepointBuffered',\n        value: function _isTimepointBuffered(seconds) {\n            var buffered = this._mediaElement.buffered;\n\n            for (var i = 0; i < buffered.length; i++) {\n                var from = buffered.start(i);\n                var to = buffered.end(i);\n                if (seconds >= from && seconds < to) {\n                    return true;\n                }\n            }\n            return false;\n        }\n    }, {\n        key: '_internalSeek',\n        value: function _internalSeek(seconds) {\n            var directSeek = this._isTimepointBuffered(seconds);\n\n            var directSeekBegin = false;\n            var directSeekBeginTime = 0;\n\n            if (seconds < 1.0 && this._mediaElement.buffered.length > 0) {\n                var videoBeginTime = this._mediaElement.buffered.start(0);\n                if (videoBeginTime < 1.0 && seconds < videoBeginTime || _browser2.default.safari) {\n                    directSeekBegin = true;\n                    // also workaround for Safari: Seek to 0 may cause video stuck, use 0.1 to avoid\n                    directSeekBeginTime = _browser2.default.safari ? 0.1 : videoBeginTime;\n                }\n            }\n\n            if (directSeekBegin) {\n                // seek to video begin, set currentTime directly if beginPTS buffered\n                this._requestSetTime = true;\n                this._mediaElement.currentTime = directSeekBeginTime;\n            } else if (directSeek) {\n                // buffered position\n                if (!this._alwaysSeekKeyframe) {\n                    this._requestSetTime = true;\n                    this._mediaElement.currentTime = seconds;\n                } else {\n                    var idr = this._msectl.getNearestKeyframe(Math.floor(seconds * 1000));\n                    this._requestSetTime = true;\n                    if (idr != null) {\n                        this._mediaElement.currentTime = idr.dts / 1000;\n                    } else {\n                        this._mediaElement.currentTime = seconds;\n                    }\n                }\n                if (this._progressChecker != null) {\n                    this._checkProgressAndResume();\n                }\n            } else {\n                if (this._progressChecker != null) {\n                    window.clearInterval(this._progressChecker);\n                    this._progressChecker = null;\n                }\n                this._msectl.seek(seconds);\n                this._transmuxer.seek(Math.floor(seconds * 1000)); // in milliseconds\n                // no need to set mediaElement.currentTime if non-accurateSeek,\n                // just wait for the recommend_seekpoint callback\n                if (this._config.accurateSeek) {\n                    this._requestSetTime = true;\n                    this._mediaElement.currentTime = seconds;\n                }\n            }\n        }\n    }, {\n        key: '_checkAndApplyUnbufferedSeekpoint',\n        value: function _checkAndApplyUnbufferedSeekpoint() {\n            if (this._seekpointRecord) {\n                if (this._seekpointRecord.recordTime <= this._now() - 100) {\n                    var target = this._mediaElement.currentTime;\n                    this._seekpointRecord = null;\n                    if (!this._isTimepointBuffered(target)) {\n                        if (this._progressChecker != null) {\n                            window.clearTimeout(this._progressChecker);\n                            this._progressChecker = null;\n                        }\n                        // .currentTime is consists with .buffered timestamp\n                        // Chrome/Edge use DTS, while FireFox/Safari use PTS\n                        this._msectl.seek(target);\n                        this._transmuxer.seek(Math.floor(target * 1000));\n                        // set currentTime if accurateSeek, or wait for recommend_seekpoint callback\n                        if (this._config.accurateSeek) {\n                            this._requestSetTime = true;\n                            this._mediaElement.currentTime = target;\n                        }\n                    }\n                } else {\n                    window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this), 50);\n                }\n            }\n        }\n    }, {\n        key: '_checkAndResumeStuckPlayback',\n        value: function _checkAndResumeStuckPlayback(stalled) {\n            var media = this._mediaElement;\n            if (stalled || !this._receivedCanPlay || media.readyState < 2) {\n                // HAVE_CURRENT_DATA\n                var buffered = media.buffered;\n                if (buffered.length > 0 && media.currentTime < buffered.start(0)) {\n                    _logger2.default.w(this.TAG, 'Playback seems stuck at ' + media.currentTime + ', seek to ' + buffered.start(0));\n                    this._requestSetTime = true;\n                    this._mediaElement.currentTime = buffered.start(0);\n                    this._mediaElement.removeEventListener('progress', this.e.onvProgress);\n                }\n            } else {\n                // Playback didn't stuck, remove progress event listener\n                this._mediaElement.removeEventListener('progress', this.e.onvProgress);\n            }\n        }\n    }, {\n        key: '_onvLoadedMetadata',\n        value: function _onvLoadedMetadata(e) {\n            if (this._pendingSeekTime != null) {\n                this._mediaElement.currentTime = this._pendingSeekTime;\n                this._pendingSeekTime = null;\n            }\n        }\n    }, {\n        key: '_onvSeeking',\n        value: function _onvSeeking(e) {\n            // handle seeking request from browser's progress bar\n            var target = this._mediaElement.currentTime;\n            var buffered = this._mediaElement.buffered;\n\n            if (this._requestSetTime) {\n                this._requestSetTime = false;\n                return;\n            }\n\n            if (target < 1.0 && buffered.length > 0) {\n                // seek to video begin, set currentTime directly if beginPTS buffered\n                var videoBeginTime = buffered.start(0);\n                if (videoBeginTime < 1.0 && target < videoBeginTime || _browser2.default.safari) {\n                    this._requestSetTime = true;\n                    // also workaround for Safari: Seek to 0 may cause video stuck, use 0.1 to avoid\n                    this._mediaElement.currentTime = _browser2.default.safari ? 0.1 : videoBeginTime;\n                    return;\n                }\n            }\n\n            if (this._isTimepointBuffered(target)) {\n                if (this._alwaysSeekKeyframe) {\n                    var idr = this._msectl.getNearestKeyframe(Math.floor(target * 1000));\n                    if (idr != null) {\n                        this._requestSetTime = true;\n                        this._mediaElement.currentTime = idr.dts / 1000;\n                    }\n                }\n                if (this._progressChecker != null) {\n                    this._checkProgressAndResume();\n                }\n                return;\n            }\n\n            this._seekpointRecord = {\n                seekPoint: target,\n                recordTime: this._now()\n            };\n            window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this), 50);\n        }\n    }, {\n        key: '_onvCanPlay',\n        value: function _onvCanPlay(e) {\n            this._receivedCanPlay = true;\n            this._mediaElement.removeEventListener('canplay', this.e.onvCanPlay);\n        }\n    }, {\n        key: '_onvStalled',\n        value: function _onvStalled(e) {\n            this._checkAndResumeStuckPlayback(true);\n        }\n    }, {\n        key: '_onvProgress',\n        value: function _onvProgress(e) {\n            this._checkAndResumeStuckPlayback();\n        }\n    }, {\n        key: 'setMediaSourceEndCallback',\n        value: function setMediaSourceEndCallback(call) {\n            this._mediaSourceEndCallback = call;\n        }\n    }, {\n        key: 'setStreamTimeCallback',\n        value: function setStreamTimeCallback(call) {\n            this.callbackStreamTime = call;\n        }\n    }, {\n        key: '_receiveStreamTime',\n        value: function _receiveStreamTime(ts) {\n            if (this.callbackStreamTime != null) {\n                this.callbackStreamTime(ts);\n            }\n        }\n    }, {\n        key: 'type',\n        get: function get() {\n            return this._type;\n        }\n    }, {\n        key: 'buffered',\n        get: function get() {\n            return this._mediaElement.buffered;\n        }\n    }, {\n        key: 'duration',\n        get: function get() {\n            return this._mediaElement.duration;\n        }\n    }, {\n        key: 'volume',\n        get: function get() {\n            return this._mediaElement.volume;\n        },\n        set: function set(value) {\n            this._mediaElement.volume = value;\n        }\n    }, {\n        key: 'muted',\n        get: function get() {\n            return this._mediaElement.muted;\n        },\n        set: function set(muted) {\n            this._mediaElement.muted = muted;\n        }\n    }, {\n        key: 'currentTime',\n        get: function get() {\n            if (this._mediaElement) {\n                return this._mediaElement.currentTime;\n            }\n            return 0;\n        },\n        set: function set(seconds) {\n            if (this._mediaElement) {\n                this._internalSeek(seconds);\n            } else {\n                this._pendingSeekTime = seconds;\n            }\n        }\n    }, {\n        key: 'mediaInfo',\n        get: function get() {\n            return Object.assign({}, this._mediaInfo);\n        }\n    }, {\n        key: 'statisticsInfo',\n        get: function get() {\n            if (this._statisticsInfo == null) {\n                this._statisticsInfo = {};\n            }\n            this._statisticsInfo = this._fillStatisticsInfo(this._statisticsInfo);\n            return Object.assign({}, this._statisticsInfo);\n        }\n    }]);\n\n    return FlvPlayer;\n}();\n\nexports.default = FlvPlayer;\n\n},{\"../config.js\":5,\"../core/mse-controller.js\":9,\"../core/mse-events.js\":10,\"../core/transmuxer.js\":11,\"../core/transmuxing-events.js\":13,\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./player-errors.js\":34,\"./player-events.js\":35,\"events\":2}],33:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _playerEvents = _dereq_('./player-events.js');\n\nvar _playerEvents2 = _interopRequireDefault(_playerEvents);\n\nvar _config = _dereq_('../config.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Player wrapper for browser's native player (HTMLVideoElement) without MediaSource src. \nvar NativePlayer = function () {\n    function NativePlayer(mediaDataSource, config) {\n        _classCallCheck(this, NativePlayer);\n\n        this.TAG = 'NativePlayer';\n        this._type = 'NativePlayer';\n        this._emitter = new _events2.default();\n\n        this._config = (0, _config.createDefaultConfig)();\n        if ((typeof config === 'undefined' ? 'undefined' : _typeof(config)) === 'object') {\n            Object.assign(this._config, config);\n        }\n\n        if (mediaDataSource.type.toLowerCase() === 'flv') {\n            throw new _exception.InvalidArgumentException('NativePlayer does\\'t support flv MediaDataSource input!');\n        }\n        if (mediaDataSource.hasOwnProperty('segments')) {\n            throw new _exception.InvalidArgumentException('NativePlayer(' + mediaDataSource.type + ') doesn\\'t support multipart playback!');\n        }\n\n        this.e = {\n            onvLoadedMetadata: this._onvLoadedMetadata.bind(this)\n        };\n\n        this._pendingSeekTime = null;\n        this._statisticsReporter = null;\n\n        this._mediaDataSource = mediaDataSource;\n        this._mediaElement = null;\n    }\n\n    _createClass(NativePlayer, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._mediaElement) {\n                this.unload();\n                this.detachMediaElement();\n            }\n            this.e = null;\n            this._mediaDataSource = null;\n            this._emitter.removeAllListeners();\n            this._emitter = null;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, listener) {\n            var _this = this;\n\n            if (event === _playerEvents2.default.MEDIA_INFO) {\n                if (this._mediaElement != null && this._mediaElement.readyState !== 0) {\n                    // HAVE_NOTHING\n                    Promise.resolve().then(function () {\n                        _this._emitter.emit(_playerEvents2.default.MEDIA_INFO, _this.mediaInfo);\n                    });\n                }\n            } else if (event === _playerEvents2.default.STATISTICS_INFO) {\n                if (this._mediaElement != null && this._mediaElement.readyState !== 0) {\n                    Promise.resolve().then(function () {\n                        _this._emitter.emit(_playerEvents2.default.STATISTICS_INFO, _this.statisticsInfo);\n                    });\n                }\n            }\n            this._emitter.addListener(event, listener);\n        }\n    }, {\n        key: 'off',\n        value: function off(event, listener) {\n            this._emitter.removeListener(event, listener);\n        }\n    }, {\n        key: 'attachMediaElement',\n        value: function attachMediaElement(mediaElement) {\n            this._mediaElement = mediaElement;\n            mediaElement.addEventListener('loadedmetadata', this.e.onvLoadedMetadata);\n\n            if (this._pendingSeekTime != null) {\n                try {\n                    mediaElement.currentTime = this._pendingSeekTime;\n                    this._pendingSeekTime = null;\n                } catch (e) {\n                    // IE11 may throw InvalidStateError if readyState === 0\n                    // Defer set currentTime operation after loadedmetadata\n                }\n            }\n        }\n    }, {\n        key: 'detachMediaElement',\n        value: function detachMediaElement() {\n            if (this._mediaElement) {\n                this._mediaElement.src = '';\n                this._mediaElement.removeAttribute('src');\n                this._mediaElement.removeEventListener('loadedmetadata', this.e.onvLoadedMetadata);\n                this._mediaElement = null;\n            }\n            if (this._statisticsReporter != null) {\n                window.clearInterval(this._statisticsReporter);\n                this._statisticsReporter = null;\n            }\n        }\n    }, {\n        key: 'load',\n        value: function load() {\n            if (!this._mediaElement) {\n                throw new _exception.IllegalStateException('HTMLMediaElement must be attached before load()!');\n            }\n            this._mediaElement.src = this._mediaDataSource.url;\n\n            if (this._mediaElement.readyState > 0) {\n                this._mediaElement.currentTime = 0;\n            }\n\n            this._mediaElement.preload = 'auto';\n            this._mediaElement.load();\n            this._statisticsReporter = window.setInterval(this._reportStatisticsInfo.bind(this), this._config.statisticsInfoReportInterval);\n        }\n    }, {\n        key: 'unload',\n        value: function unload() {\n            if (this._mediaElement) {\n                this._mediaElement.src = '';\n                this._mediaElement.removeAttribute('src');\n            }\n            if (this._statisticsReporter != null) {\n                window.clearInterval(this._statisticsReporter);\n                this._statisticsReporter = null;\n            }\n        }\n    }, {\n        key: 'play',\n        value: function play() {\n            return this._mediaElement.play();\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            this._mediaElement.pause();\n        }\n    }, {\n        key: '_onvLoadedMetadata',\n        value: function _onvLoadedMetadata(e) {\n            if (this._pendingSeekTime != null) {\n                this._mediaElement.currentTime = this._pendingSeekTime;\n                this._pendingSeekTime = null;\n            }\n            this._emitter.emit(_playerEvents2.default.MEDIA_INFO, this.mediaInfo);\n        }\n    }, {\n        key: '_reportStatisticsInfo',\n        value: function _reportStatisticsInfo() {\n            this._emitter.emit(_playerEvents2.default.STATISTICS_INFO, this.statisticsInfo);\n        }\n    }, {\n        key: 'type',\n        get: function get() {\n            return this._type;\n        }\n    }, {\n        key: 'buffered',\n        get: function get() {\n            return this._mediaElement.buffered;\n        }\n    }, {\n        key: 'duration',\n        get: function get() {\n            return this._mediaElement.duration;\n        }\n    }, {\n        key: 'volume',\n        get: function get() {\n            return this._mediaElement.volume;\n        },\n        set: function set(value) {\n            this._mediaElement.volume = value;\n        }\n    }, {\n        key: 'muted',\n        get: function get() {\n            return this._mediaElement.muted;\n        },\n        set: function set(muted) {\n            this._mediaElement.muted = muted;\n        }\n    }, {\n        key: 'currentTime',\n        get: function get() {\n            if (this._mediaElement) {\n                return this._mediaElement.currentTime;\n            }\n            return 0;\n        },\n        set: function set(seconds) {\n            if (this._mediaElement) {\n                this._mediaElement.currentTime = seconds;\n            } else {\n                this._pendingSeekTime = seconds;\n            }\n        }\n    }, {\n        key: 'mediaInfo',\n        get: function get() {\n            var mediaPrefix = this._mediaElement instanceof HTMLAudioElement ? 'audio/' : 'video/';\n            var info = {\n                mimeType: mediaPrefix + this._mediaDataSource.type\n            };\n            if (this._mediaElement) {\n                info.duration = Math.floor(this._mediaElement.duration * 1000);\n                if (this._mediaElement instanceof HTMLVideoElement) {\n                    info.width = this._mediaElement.videoWidth;\n                    info.height = this._mediaElement.videoHeight;\n                }\n            }\n            return info;\n        }\n    }, {\n        key: 'statisticsInfo',\n        get: function get() {\n            var info = {\n                playerType: this._type,\n                url: this._mediaDataSource.url\n            };\n\n            if (!(this._mediaElement instanceof HTMLVideoElement)) {\n                return info;\n            }\n\n            var hasQualityInfo = true;\n            var decoded = 0;\n            var dropped = 0;\n\n            if (this._mediaElement.getVideoPlaybackQuality) {\n                var quality = this._mediaElement.getVideoPlaybackQuality();\n                decoded = quality.totalVideoFrames;\n                dropped = quality.droppedVideoFrames;\n            } else if (this._mediaElement.webkitDecodedFrameCount != undefined) {\n                decoded = this._mediaElement.webkitDecodedFrameCount;\n                dropped = this._mediaElement.webkitDroppedFrameCount;\n            } else {\n                hasQualityInfo = false;\n            }\n\n            if (hasQualityInfo) {\n                info.decodedFrames = decoded;\n                info.droppedFrames = dropped;\n            }\n\n            return info;\n        }\n    }]);\n\n    return NativePlayer;\n}();\n\nexports.default = NativePlayer;\n\n},{\"../config.js\":5,\"../utils/exception.js\":40,\"./player-events.js\":35,\"events\":2}],34:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.ErrorDetails = exports.ErrorTypes = undefined;\n\nvar _loader = _dereq_('../io/loader.js');\n\nvar _demuxErrors = _dereq_('../demux/demux-errors.js');\n\nvar _demuxErrors2 = _interopRequireDefault(_demuxErrors);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar ErrorTypes = exports.ErrorTypes = {\n    NETWORK_ERROR: 'NetworkError',\n    MEDIA_ERROR: 'MediaError',\n    OTHER_ERROR: 'OtherError'\n};\n\nvar ErrorDetails = exports.ErrorDetails = {\n    NETWORK_EXCEPTION: _loader.LoaderErrors.EXCEPTION,\n    NETWORK_STATUS_CODE_INVALID: _loader.LoaderErrors.HTTP_STATUS_CODE_INVALID,\n    NETWORK_TIMEOUT: _loader.LoaderErrors.CONNECTING_TIMEOUT,\n    NETWORK_UNRECOVERABLE_EARLY_EOF: _loader.LoaderErrors.UNRECOVERABLE_EARLY_EOF,\n\n    MEDIA_MSE_ERROR: 'MediaMSEError',\n\n    MEDIA_FORMAT_ERROR: _demuxErrors2.default.FORMAT_ERROR,\n    MEDIA_FORMAT_UNSUPPORTED: _demuxErrors2.default.FORMAT_UNSUPPORTED,\n    MEDIA_CODEC_UNSUPPORTED: _demuxErrors2.default.CODEC_UNSUPPORTED\n};\n\n},{\"../demux/demux-errors.js\":16,\"../io/loader.js\":24}],35:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar PlayerEvents = {\n  ERROR: 'error',\n  LOADING_COMPLETE: 'loading_complete',\n  RECOVERED_EARLY_EOF: 'recovered_early_eof',\n  MEDIA_INFO: 'media_info',\n  METADATA_ARRIVED: 'metadata_arrived',\n  SCRIPTDATA_ARRIVED: 'scriptdata_arrived',\n  STATISTICS_INFO: 'statistics_info'\n};\n\nexports.default = PlayerEvents;\n\n},{}],36:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * This file is modified from dailymotion's hls.js library (hls.js/src/helper/aac.js)\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar AAC = function () {\n    function AAC() {\n        _classCallCheck(this, AAC);\n    }\n\n    _createClass(AAC, null, [{\n        key: 'getSilentFrame',\n        value: function getSilentFrame(codec, channelCount) {\n            if (codec === 'mp4a.40.2') {\n                // handle LC-AAC\n                if (channelCount === 1) {\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x23, 0x80]);\n                } else if (channelCount === 2) {\n                    return new Uint8Array([0x21, 0x00, 0x49, 0x90, 0x02, 0x19, 0x00, 0x23, 0x80]);\n                } else if (channelCount === 3) {\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x8e]);\n                } else if (channelCount === 4) {\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x80, 0x2c, 0x80, 0x08, 0x02, 0x38]);\n                } else if (channelCount === 5) {\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x38]);\n                } else if (channelCount === 6) {\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x00, 0xb2, 0x00, 0x20, 0x08, 0xe0]);\n                }\n            } else {\n                // handle HE-AAC (mp4a.40.5 / mp4a.40.29)\n                if (channelCount === 1) {\n                    // ffmpeg -y -f lavfi -i \"aevalsrc=0:d=0.05\" -c:a libfdk_aac -profile:a aac_he -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n                    return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x4e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x1c, 0x6, 0xf1, 0xc1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\n                } else if (channelCount === 2) {\n                    // ffmpeg -y -f lavfi -i \"aevalsrc=0|0:d=0.05\" -c:a libfdk_aac -profile:a aac_he_v2 -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n                    return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x5e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x0, 0x95, 0x0, 0x6, 0xf1, 0xa1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\n                } else if (channelCount === 3) {\n                    // ffmpeg -y -f lavfi -i \"aevalsrc=0|0|0:d=0.05\" -c:a libfdk_aac -profile:a aac_he_v2 -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n                    return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x5e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x0, 0x95, 0x0, 0x6, 0xf1, 0xa1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\n                }\n            }\n            return null;\n        }\n    }]);\n\n    return AAC;\n}();\n\nexports.default = AAC;\n\n},{}],37:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * This file is derived from dailymotion's hls.js library (hls.js/src/remux/mp4-generator.js)\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n//  MP4 boxes generator for ISO BMFF (ISO Base Media File Format, defined in ISO/IEC 14496-12)\nvar MP4 = function () {\n    function MP4() {\n        _classCallCheck(this, MP4);\n    }\n\n    _createClass(MP4, null, [{\n        key: 'init',\n        value: function init() {\n            MP4.types = {\n                avc1: [], avcC: [], btrt: [], dinf: [],\n                dref: [], esds: [], ftyp: [], hdlr: [],\n                mdat: [], mdhd: [], mdia: [], mfhd: [],\n                minf: [], moof: [], moov: [], mp4a: [],\n                mvex: [], mvhd: [], sdtp: [], stbl: [],\n                stco: [], stsc: [], stsd: [], stsz: [],\n                stts: [], tfdt: [], tfhd: [], traf: [],\n                trak: [], trun: [], trex: [], tkhd: [],\n                vmhd: [], smhd: [], '.mp3': []\n            };\n\n            for (var name in MP4.types) {\n                if (MP4.types.hasOwnProperty(name)) {\n                    MP4.types[name] = [name.charCodeAt(0), name.charCodeAt(1), name.charCodeAt(2), name.charCodeAt(3)];\n                }\n            }\n\n            var constants = MP4.constants = {};\n\n            constants.FTYP = new Uint8Array([0x69, 0x73, 0x6F, 0x6D, // major_brand: isom\n            0x0, 0x0, 0x0, 0x1, // minor_version: 0x01\n            0x69, 0x73, 0x6F, 0x6D, // isom\n            0x61, 0x76, 0x63, 0x31 // avc1\n            ]);\n\n            constants.STSD_PREFIX = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x01 // entry_count\n            ]);\n\n            constants.STTS = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00 // entry_count\n            ]);\n\n            constants.STSC = constants.STCO = constants.STTS;\n\n            constants.STSZ = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // sample_size\n            0x00, 0x00, 0x00, 0x00 // sample_count\n            ]);\n\n            constants.HDLR_VIDEO = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // pre_defined\n            0x76, 0x69, 0x64, 0x65, // handler_type: 'vide'\n            0x00, 0x00, 0x00, 0x00, // reserved: 3 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x56, 0x69, 0x64, 0x65, 0x6F, 0x48, 0x61, 0x6E, 0x64, 0x6C, 0x65, 0x72, 0x00 // name: VideoHandler\n            ]);\n\n            constants.HDLR_AUDIO = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // pre_defined\n            0x73, 0x6F, 0x75, 0x6E, // handler_type: 'soun'\n            0x00, 0x00, 0x00, 0x00, // reserved: 3 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x53, 0x6F, 0x75, 0x6E, 0x64, 0x48, 0x61, 0x6E, 0x64, 0x6C, 0x65, 0x72, 0x00 // name: SoundHandler\n            ]);\n\n            constants.DREF = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x01, // entry_count\n            0x00, 0x00, 0x00, 0x0C, // entry_size\n            0x75, 0x72, 0x6C, 0x20, // type 'url '\n            0x00, 0x00, 0x00, 0x01 // version(0) + flags\n            ]);\n\n            // Sound media header\n            constants.SMHD = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00 // balance(2) + reserved(2)\n            ]);\n\n            // video media header\n            constants.VMHD = new Uint8Array([0x00, 0x00, 0x00, 0x01, // version(0) + flags\n            0x00, 0x00, // graphicsmode: 2 bytes\n            0x00, 0x00, 0x00, 0x00, // opcolor: 3 * 2 bytes\n            0x00, 0x00]);\n        }\n\n        // Generate a box\n\n    }, {\n        key: 'box',\n        value: function box(type) {\n            var size = 8;\n            var result = null;\n            var datas = Array.prototype.slice.call(arguments, 1);\n            var arrayCount = datas.length;\n\n            for (var i = 0; i < arrayCount; i++) {\n                size += datas[i].byteLength;\n            }\n\n            result = new Uint8Array(size);\n            result[0] = size >>> 24 & 0xFF; // size\n            result[1] = size >>> 16 & 0xFF;\n            result[2] = size >>> 8 & 0xFF;\n            result[3] = size & 0xFF;\n\n            result.set(type, 4); // type\n\n            var offset = 8;\n            for (var _i = 0; _i < arrayCount; _i++) {\n                // data body\n                result.set(datas[_i], offset);\n                offset += datas[_i].byteLength;\n            }\n\n            return result;\n        }\n\n        // emit ftyp & moov\n\n    }, {\n        key: 'generateInitSegment',\n        value: function generateInitSegment(meta) {\n            var ftyp = MP4.box(MP4.types.ftyp, MP4.constants.FTYP);\n            var moov = MP4.moov(meta);\n\n            var result = new Uint8Array(ftyp.byteLength + moov.byteLength);\n            result.set(ftyp, 0);\n            result.set(moov, ftyp.byteLength);\n            return result;\n        }\n\n        // Movie metadata box\n\n    }, {\n        key: 'moov',\n        value: function moov(meta) {\n            var mvhd = MP4.mvhd(meta.timescale, meta.duration);\n            var trak = MP4.trak(meta);\n            var mvex = MP4.mvex(meta);\n            return MP4.box(MP4.types.moov, mvhd, trak, mvex);\n        }\n\n        // Movie header box\n\n    }, {\n        key: 'mvhd',\n        value: function mvhd(timescale, duration) {\n            return MP4.box(MP4.types.mvhd, new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // creation_time\n            0x00, 0x00, 0x00, 0x00, // modification_time\n            timescale >>> 24 & 0xFF, // timescale: 4 bytes\n            timescale >>> 16 & 0xFF, timescale >>> 8 & 0xFF, timescale & 0xFF, duration >>> 24 & 0xFF, // duration: 4 bytes\n            duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, 0x00, 0x01, 0x00, 0x00, // Preferred rate: 1.0\n            0x01, 0x00, 0x00, 0x00, // PreferredVolume(1.0, 2bytes) + reserved(2bytes)\n            0x00, 0x00, 0x00, 0x00, // reserved: 4 + 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, // ----begin composition matrix----\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, // ----end composition matrix----\n            0x00, 0x00, 0x00, 0x00, // ----begin pre_defined 6 * 4 bytes----\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // ----end pre_defined 6 * 4 bytes----\n            0xFF, 0xFF, 0xFF, 0xFF // next_track_ID\n            ]));\n        }\n\n        // Track box\n\n    }, {\n        key: 'trak',\n        value: function trak(meta) {\n            return MP4.box(MP4.types.trak, MP4.tkhd(meta), MP4.mdia(meta));\n        }\n\n        // Track header box\n\n    }, {\n        key: 'tkhd',\n        value: function tkhd(meta) {\n            var trackId = meta.id,\n                duration = meta.duration;\n            var width = meta.presentWidth,\n                height = meta.presentHeight;\n\n            return MP4.box(MP4.types.tkhd, new Uint8Array([0x00, 0x00, 0x00, 0x07, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // creation_time\n            0x00, 0x00, 0x00, 0x00, // modification_time\n            trackId >>> 24 & 0xFF, // track_ID: 4 bytes\n            trackId >>> 16 & 0xFF, trackId >>> 8 & 0xFF, trackId & 0xFF, 0x00, 0x00, 0x00, 0x00, // reserved: 4 bytes\n            duration >>> 24 & 0xFF, // duration: 4 bytes\n            duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, 0x00, 0x00, 0x00, 0x00, // reserved: 2 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // layer(2bytes) + alternate_group(2bytes)\n            0x00, 0x00, 0x00, 0x00, // volume(2bytes) + reserved(2bytes)\n            0x00, 0x01, 0x00, 0x00, // ----begin composition matrix----\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, // ----end composition matrix----\n            width >>> 8 & 0xFF, // width and height\n            width & 0xFF, 0x00, 0x00, height >>> 8 & 0xFF, height & 0xFF, 0x00, 0x00]));\n        }\n\n        // Media Box\n\n    }, {\n        key: 'mdia',\n        value: function mdia(meta) {\n            return MP4.box(MP4.types.mdia, MP4.mdhd(meta), MP4.hdlr(meta), MP4.minf(meta));\n        }\n\n        // Media header box\n\n    }, {\n        key: 'mdhd',\n        value: function mdhd(meta) {\n            var timescale = meta.timescale;\n            var duration = meta.duration;\n            return MP4.box(MP4.types.mdhd, new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // creation_time\n            0x00, 0x00, 0x00, 0x00, // modification_time\n            timescale >>> 24 & 0xFF, // timescale: 4 bytes\n            timescale >>> 16 & 0xFF, timescale >>> 8 & 0xFF, timescale & 0xFF, duration >>> 24 & 0xFF, // duration: 4 bytes\n            duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, 0x55, 0xC4, // language: und (undetermined)\n            0x00, 0x00 // pre_defined = 0\n            ]));\n        }\n\n        // Media handler reference box\n\n    }, {\n        key: 'hdlr',\n        value: function hdlr(meta) {\n            var data = null;\n            if (meta.type === 'audio') {\n                data = MP4.constants.HDLR_AUDIO;\n            } else {\n                data = MP4.constants.HDLR_VIDEO;\n            }\n            return MP4.box(MP4.types.hdlr, data);\n        }\n\n        // Media infomation box\n\n    }, {\n        key: 'minf',\n        value: function minf(meta) {\n            var xmhd = null;\n            if (meta.type === 'audio') {\n                xmhd = MP4.box(MP4.types.smhd, MP4.constants.SMHD);\n            } else {\n                xmhd = MP4.box(MP4.types.vmhd, MP4.constants.VMHD);\n            }\n            return MP4.box(MP4.types.minf, xmhd, MP4.dinf(), MP4.stbl(meta));\n        }\n\n        // Data infomation box\n\n    }, {\n        key: 'dinf',\n        value: function dinf() {\n            var result = MP4.box(MP4.types.dinf, MP4.box(MP4.types.dref, MP4.constants.DREF));\n            return result;\n        }\n\n        // Sample table box\n\n    }, {\n        key: 'stbl',\n        value: function stbl(meta) {\n            var result = MP4.box(MP4.types.stbl, // type: stbl\n            MP4.stsd(meta), // Sample Description Table\n            MP4.box(MP4.types.stts, MP4.constants.STTS), // Time-To-Sample\n            MP4.box(MP4.types.stsc, MP4.constants.STSC), // Sample-To-Chunk\n            MP4.box(MP4.types.stsz, MP4.constants.STSZ), // Sample size\n            MP4.box(MP4.types.stco, MP4.constants.STCO // Chunk offset\n            ));\n            return result;\n        }\n\n        // Sample description box\n\n    }, {\n        key: 'stsd',\n        value: function stsd(meta) {\n            if (meta.type === 'audio') {\n                if (meta.codec === 'mp3') {\n                    return MP4.box(MP4.types.stsd, MP4.constants.STSD_PREFIX, MP4.mp3(meta));\n                }\n                // else: aac -> mp4a\n                return MP4.box(MP4.types.stsd, MP4.constants.STSD_PREFIX, MP4.mp4a(meta));\n            } else {\n                return MP4.box(MP4.types.stsd, MP4.constants.STSD_PREFIX, MP4.avc1(meta));\n            }\n        }\n    }, {\n        key: 'mp3',\n        value: function mp3(meta) {\n            var channelCount = meta.channelCount;\n            var sampleRate = meta.audioSampleRate;\n\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // reserved(4)\n            0x00, 0x00, 0x00, 0x01, // reserved(2) + data_reference_index(2)\n            0x00, 0x00, 0x00, 0x00, // reserved: 2 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, channelCount, // channelCount(2)\n            0x00, 0x10, // sampleSize(2)\n            0x00, 0x00, 0x00, 0x00, // reserved(4)\n            sampleRate >>> 8 & 0xFF, // Audio sample rate\n            sampleRate & 0xFF, 0x00, 0x00]);\n\n            return MP4.box(MP4.types['.mp3'], data);\n        }\n    }, {\n        key: 'mp4a',\n        value: function mp4a(meta) {\n            var channelCount = meta.channelCount;\n            var sampleRate = meta.audioSampleRate;\n\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // reserved(4)\n            0x00, 0x00, 0x00, 0x01, // reserved(2) + data_reference_index(2)\n            0x00, 0x00, 0x00, 0x00, // reserved: 2 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, channelCount, // channelCount(2)\n            0x00, 0x10, // sampleSize(2)\n            0x00, 0x00, 0x00, 0x00, // reserved(4)\n            sampleRate >>> 8 & 0xFF, // Audio sample rate\n            sampleRate & 0xFF, 0x00, 0x00]);\n\n            return MP4.box(MP4.types.mp4a, data, MP4.esds(meta));\n        }\n    }, {\n        key: 'esds',\n        value: function esds(meta) {\n            var config = meta.config || [];\n            var configSize = config.length;\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version 0 + flags\n\n            0x03, // descriptor_type\n            0x17 + configSize, // length3\n            0x00, 0x01, // es_id\n            0x00, // stream_priority\n\n            0x04, // descriptor_type\n            0x0F + configSize, // length\n            0x40, // codec: mpeg4_audio\n            0x15, // stream_type: Audio\n            0x00, 0x00, 0x00, // buffer_size\n            0x00, 0x00, 0x00, 0x00, // maxBitrate\n            0x00, 0x00, 0x00, 0x00, // avgBitrate\n\n            0x05 // descriptor_type\n            ].concat([configSize]).concat(config).concat([0x06, 0x01, 0x02 // GASpecificConfig\n            ]));\n            return MP4.box(MP4.types.esds, data);\n        }\n    }, {\n        key: 'avc1',\n        value: function avc1(meta) {\n            var avcc = meta.avcc;\n            var width = meta.codecWidth,\n                height = meta.codecHeight;\n\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // reserved(4)\n            0x00, 0x00, 0x00, 0x01, // reserved(2) + data_reference_index(2)\n            0x00, 0x00, 0x00, 0x00, // pre_defined(2) + reserved(2)\n            0x00, 0x00, 0x00, 0x00, // pre_defined: 3 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, width >>> 8 & 0xFF, // width: 2 bytes\n            width & 0xFF, height >>> 8 & 0xFF, // height: 2 bytes\n            height & 0xFF, 0x00, 0x48, 0x00, 0x00, // horizresolution: 4 bytes\n            0x00, 0x48, 0x00, 0x00, // vertresolution: 4 bytes\n            0x00, 0x00, 0x00, 0x00, // reserved: 4 bytes\n            0x00, 0x01, // frame_count\n            0x0A, // strlen\n            0x78, 0x71, 0x71, 0x2F, // compressorname: 32 bytes\n            0x66, 0x6C, 0x76, 0x2E, 0x6A, 0x73, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, // depth\n            0xFF, 0xFF // pre_defined = -1\n            ]);\n            return MP4.box(MP4.types.avc1, data, MP4.box(MP4.types.avcC, avcc));\n        }\n\n        // Movie Extends box\n\n    }, {\n        key: 'mvex',\n        value: function mvex(meta) {\n            return MP4.box(MP4.types.mvex, MP4.trex(meta));\n        }\n\n        // Track Extends box\n\n    }, {\n        key: 'trex',\n        value: function trex(meta) {\n            var trackId = meta.id;\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            trackId >>> 24 & 0xFF, // track_ID\n            trackId >>> 16 & 0xFF, trackId >>> 8 & 0xFF, trackId & 0xFF, 0x00, 0x00, 0x00, 0x01, // default_sample_description_index\n            0x00, 0x00, 0x00, 0x00, // default_sample_duration\n            0x00, 0x00, 0x00, 0x00, // default_sample_size\n            0x00, 0x01, 0x00, 0x01 // default_sample_flags\n            ]);\n            return MP4.box(MP4.types.trex, data);\n        }\n\n        // Movie fragment box\n\n    }, {\n        key: 'moof',\n        value: function moof(track, baseMediaDecodeTime) {\n            return MP4.box(MP4.types.moof, MP4.mfhd(track.sequenceNumber), MP4.traf(track, baseMediaDecodeTime));\n        }\n    }, {\n        key: 'mfhd',\n        value: function mfhd(sequenceNumber) {\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, sequenceNumber >>> 24 & 0xFF, // sequence_number: int32\n            sequenceNumber >>> 16 & 0xFF, sequenceNumber >>> 8 & 0xFF, sequenceNumber & 0xFF]);\n            return MP4.box(MP4.types.mfhd, data);\n        }\n\n        // Track fragment box\n\n    }, {\n        key: 'traf',\n        value: function traf(track, baseMediaDecodeTime) {\n            var trackId = track.id;\n\n            // Track fragment header box\n            var tfhd = MP4.box(MP4.types.tfhd, new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) & flags\n            trackId >>> 24 & 0xFF, // track_ID\n            trackId >>> 16 & 0xFF, trackId >>> 8 & 0xFF, trackId & 0xFF]));\n            // Track Fragment Decode Time\n            var tfdt = MP4.box(MP4.types.tfdt, new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) & flags\n            baseMediaDecodeTime >>> 24 & 0xFF, // baseMediaDecodeTime: int32\n            baseMediaDecodeTime >>> 16 & 0xFF, baseMediaDecodeTime >>> 8 & 0xFF, baseMediaDecodeTime & 0xFF]));\n            var sdtp = MP4.sdtp(track);\n            var trun = MP4.trun(track, sdtp.byteLength + 16 + 16 + 8 + 16 + 8 + 8);\n\n            return MP4.box(MP4.types.traf, tfhd, tfdt, trun, sdtp);\n        }\n\n        // Sample Dependency Type box\n\n    }, {\n        key: 'sdtp',\n        value: function sdtp(track) {\n            var samples = track.samples || [];\n            var sampleCount = samples.length;\n            var data = new Uint8Array(4 + sampleCount);\n            // 0~4 bytes: version(0) & flags\n            for (var i = 0; i < sampleCount; i++) {\n                var flags = samples[i].flags;\n                data[i + 4] = flags.isLeading << 6 | // is_leading: 2 (bit)\n                flags.dependsOn << 4 // sample_depends_on\n                | flags.isDependedOn << 2 // sample_is_depended_on\n                | flags.hasRedundancy; // sample_has_redundancy\n            }\n            return MP4.box(MP4.types.sdtp, data);\n        }\n\n        // Track fragment run box\n\n    }, {\n        key: 'trun',\n        value: function trun(track, offset) {\n            var samples = track.samples || [];\n            var sampleCount = samples.length;\n            var dataSize = 12 + 16 * sampleCount;\n            var data = new Uint8Array(dataSize);\n            offset += 8 + dataSize;\n\n            data.set([0x00, 0x00, 0x0F, 0x01, // version(0) & flags\n            sampleCount >>> 24 & 0xFF, // sample_count\n            sampleCount >>> 16 & 0xFF, sampleCount >>> 8 & 0xFF, sampleCount & 0xFF, offset >>> 24 & 0xFF, // data_offset\n            offset >>> 16 & 0xFF, offset >>> 8 & 0xFF, offset & 0xFF], 0);\n\n            for (var i = 0; i < sampleCount; i++) {\n                var duration = samples[i].duration;\n                var size = samples[i].size;\n                var flags = samples[i].flags;\n                var cts = samples[i].cts;\n                data.set([duration >>> 24 & 0xFF, // sample_duration\n                duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, size >>> 24 & 0xFF, // sample_size\n                size >>> 16 & 0xFF, size >>> 8 & 0xFF, size & 0xFF, flags.isLeading << 2 | flags.dependsOn, // sample_flags\n                flags.isDependedOn << 6 | flags.hasRedundancy << 4 | flags.isNonSync, 0x00, 0x00, // sample_degradation_priority\n                cts >>> 24 & 0xFF, // sample_composition_time_offset\n                cts >>> 16 & 0xFF, cts >>> 8 & 0xFF, cts & 0xFF], 12 + 16 * i);\n            }\n            return MP4.box(MP4.types.trun, data);\n        }\n    }, {\n        key: 'mdat',\n        value: function mdat(data) {\n            return MP4.box(MP4.types.mdat, data);\n        }\n    }]);\n\n    return MP4;\n}();\n\nMP4.init();\n\nexports.default = MP4;\n\n},{}],38:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _mp4Generator = _dereq_('./mp4-generator.js');\n\nvar _mp4Generator2 = _interopRequireDefault(_mp4Generator);\n\nvar _aacSilent = _dereq_('./aac-silent.js');\n\nvar _aacSilent2 = _interopRequireDefault(_aacSilent);\n\nvar _browser = _dereq_('../utils/browser.js');\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _mediaSegmentInfo = _dereq_('../core/media-segment-info.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Fragmented mp4 remuxer\nvar MP4Remuxer = function () {\n    function MP4Remuxer(config) {\n        _classCallCheck(this, MP4Remuxer);\n\n        this.TAG = 'MP4Remuxer';\n\n        this._config = config;\n        this._isLive = config.isLive === true ? true : false;\n\n        this._dtsBase = -1;\n        this._dtsBaseInited = false;\n        this._audioDtsBase = Infinity;\n        this._videoDtsBase = Infinity;\n        this._audioNextDts = undefined;\n        this._videoNextDts = undefined;\n        this._audioStashedLastSample = null;\n        this._videoStashedLastSample = null;\n\n        this._audioMeta = null;\n        this._videoMeta = null;\n\n        this._audioSegmentInfoList = new _mediaSegmentInfo.MediaSegmentInfoList('audio');\n        this._videoSegmentInfoList = new _mediaSegmentInfo.MediaSegmentInfoList('video');\n\n        this._onInitSegment = null;\n        this._onMediaSegment = null;\n\n        // Workaround for chrome < 50: Always force first sample as a Random Access Point in media segment\n        // see https://bugs.chromium.org/p/chromium/issues/detail?id=229412\n        this._forceFirstIDR = _browser2.default.chrome && (_browser2.default.version.major < 50 || _browser2.default.version.major === 50 && _browser2.default.version.build < 2661) ? true : false;\n\n        // Workaround for IE11/Edge: Fill silent aac frame after keyframe-seeking\n        // Make audio beginDts equals with video beginDts, in order to fix seek freeze\n        this._fillSilentAfterSeek = _browser2.default.msedge || _browser2.default.msie;\n\n        // While only FireFox supports 'audio/mp4, codecs=\"mp3\"', use 'audio/mpeg' for chrome, safari, ...\n        this._mp3UseMpegAudio = !_browser2.default.firefox;\n\n        this._fillAudioTimestampGap = this._config.fixAudioTimestampGap;\n    }\n\n    _createClass(MP4Remuxer, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._dtsBase = -1;\n            this._dtsBaseInited = false;\n            this._audioMeta = null;\n            this._videoMeta = null;\n            this._audioSegmentInfoList.clear();\n            this._audioSegmentInfoList = null;\n            this._videoSegmentInfoList.clear();\n            this._videoSegmentInfoList = null;\n            this._onInitSegment = null;\n            this._onMediaSegment = null;\n        }\n    }, {\n        key: 'bindDataSource',\n        value: function bindDataSource(producer) {\n            producer.onDataAvailable = this.remux.bind(this);\n            producer.onTrackMetadata = this._onTrackMetadataReceived.bind(this);\n            return this;\n        }\n\n        /* prototype: function onInitSegment(type: string, initSegment: ArrayBuffer): void\r\n           InitSegment: {\r\n               type: string,\r\n               data: ArrayBuffer,\r\n               codec: string,\r\n               container: string\r\n           }\r\n        */\n\n    }, {\n        key: 'insertDiscontinuity',\n        value: function insertDiscontinuity() {\n            this._audioNextDts = this._videoNextDts = undefined;\n        }\n    }, {\n        key: 'seek',\n        value: function seek(originalDts) {\n            this._audioStashedLastSample = null;\n            this._videoStashedLastSample = null;\n            this._videoSegmentInfoList.clear();\n            this._audioSegmentInfoList.clear();\n        }\n    }, {\n        key: 'remux',\n        value: function remux(audioTrack, videoTrack) {\n            if (!this._onMediaSegment) {\n                throw new _exception.IllegalStateException('MP4Remuxer: onMediaSegment callback must be specificed!');\n            }\n            if (!this._dtsBaseInited) {\n                this._calculateDtsBase(audioTrack, videoTrack);\n            }\n            this._remuxVideo(videoTrack);\n            this._remuxAudio(audioTrack);\n        }\n    }, {\n        key: '_onTrackMetadataReceived',\n        value: function _onTrackMetadataReceived(type, metadata) {\n            var metabox = null;\n\n            var container = 'mp4';\n            var codec = metadata.codec;\n\n            if (type === 'audio') {\n                this._audioMeta = metadata;\n                if (metadata.codec === 'mp3' && this._mp3UseMpegAudio) {\n                    // 'audio/mpeg' for MP3 audio track\n                    container = 'mpeg';\n                    codec = '';\n                    metabox = new Uint8Array();\n                } else {\n                    // 'audio/mp4, codecs=\"codec\"'\n                    metabox = _mp4Generator2.default.generateInitSegment(metadata);\n                }\n            } else if (type === 'video') {\n                this._videoMeta = metadata;\n                metabox = _mp4Generator2.default.generateInitSegment(metadata);\n            } else {\n                return;\n            }\n\n            // dispatch metabox (Initialization Segment)\n            if (!this._onInitSegment) {\n                throw new _exception.IllegalStateException('MP4Remuxer: onInitSegment callback must be specified!');\n            }\n            this._onInitSegment(type, {\n                type: type,\n                data: metabox.buffer,\n                codec: codec,\n                container: type + '/' + container,\n                mediaDuration: metadata.duration // in timescale 1000 (milliseconds)\n            });\n        }\n    }, {\n        key: '_calculateDtsBase',\n        value: function _calculateDtsBase(audioTrack, videoTrack) {\n            if (this._dtsBaseInited) {\n                return;\n            }\n\n            if (audioTrack.samples && audioTrack.samples.length) {\n                this._audioDtsBase = audioTrack.samples[0].dts;\n            }\n            if (videoTrack.samples && videoTrack.samples.length) {\n                this._videoDtsBase = videoTrack.samples[0].dts;\n            }\n\n            this._dtsBase = Math.min(this._audioDtsBase, this._videoDtsBase);\n            this._dtsBaseInited = true;\n        }\n    }, {\n        key: 'flushStashedSamples',\n        value: function flushStashedSamples() {\n            var videoSample = this._videoStashedLastSample;\n            var audioSample = this._audioStashedLastSample;\n\n            var videoTrack = {\n                type: 'video',\n                id: 1,\n                sequenceNumber: 0,\n                samples: [],\n                length: 0\n            };\n\n            if (videoSample != null) {\n                videoTrack.samples.push(videoSample);\n                videoTrack.length = videoSample.length;\n            }\n\n            var audioTrack = {\n                type: 'audio',\n                id: 2,\n                sequenceNumber: 0,\n                samples: [],\n                length: 0\n            };\n\n            if (audioSample != null) {\n                audioTrack.samples.push(audioSample);\n                audioTrack.length = audioSample.length;\n            }\n\n            this._videoStashedLastSample = null;\n            this._audioStashedLastSample = null;\n\n            this._remuxVideo(videoTrack, true);\n            this._remuxAudio(audioTrack, true);\n        }\n    }, {\n        key: '_remuxAudio',\n        value: function _remuxAudio(audioTrack, force) {\n            if (this._audioMeta == null) {\n                return;\n            }\n\n            var track = audioTrack;\n            var samples = track.samples;\n            var dtsCorrection = undefined;\n            var firstDts = -1,\n                lastDts = -1,\n                lastPts = -1;\n            var refSampleDuration = this._audioMeta.refSampleDuration;\n\n            var mpegRawTrack = this._audioMeta.codec === 'mp3' && this._mp3UseMpegAudio;\n            var firstSegmentAfterSeek = this._dtsBaseInited && this._audioNextDts === undefined;\n\n            var insertPrefixSilentFrame = false;\n\n            if (!samples || samples.length === 0) {\n                return;\n            }\n            if (samples.length === 1 && !force) {\n                // If [sample count in current batch] === 1 && (force != true)\n                // Ignore and keep in demuxer's queue\n                return;\n            } // else if (force === true) do remux\n\n            var offset = 0;\n            var mdatbox = null;\n            var mdatBytes = 0;\n\n            // calculate initial mdat size\n            if (mpegRawTrack) {\n                // for raw mpeg buffer\n                offset = 0;\n                mdatBytes = track.length;\n            } else {\n                // for fmp4 mdat box\n                offset = 8; // size + type\n                mdatBytes = 8 + track.length;\n            }\n\n            var lastSample = null;\n\n            // Pop the lastSample and waiting for stash\n            if (samples.length > 1) {\n                lastSample = samples.pop();\n                mdatBytes -= lastSample.length;\n            }\n\n            // Insert [stashed lastSample in the previous batch] to the front\n            if (this._audioStashedLastSample != null) {\n                var sample = this._audioStashedLastSample;\n                this._audioStashedLastSample = null;\n                samples.unshift(sample);\n                mdatBytes += sample.length;\n            }\n\n            // Stash the lastSample of current batch, waiting for next batch\n            if (lastSample != null) {\n                this._audioStashedLastSample = lastSample;\n            }\n\n            var firstSampleOriginalDts = samples[0].dts - this._dtsBase;\n\n            // calculate dtsCorrection\n            if (this._audioNextDts) {\n                dtsCorrection = firstSampleOriginalDts - this._audioNextDts;\n            } else {\n                // this._audioNextDts == undefined\n                if (this._audioSegmentInfoList.isEmpty()) {\n                    dtsCorrection = 0;\n                    if (this._fillSilentAfterSeek && !this._videoSegmentInfoList.isEmpty()) {\n                        if (this._audioMeta.originalCodec !== 'mp3') {\n                            insertPrefixSilentFrame = true;\n                        }\n                    }\n                } else {\n                    var _lastSample = this._audioSegmentInfoList.getLastSampleBefore(firstSampleOriginalDts);\n                    if (_lastSample != null) {\n                        var distance = firstSampleOriginalDts - (_lastSample.originalDts + _lastSample.duration);\n                        if (distance <= 3) {\n                            distance = 0;\n                        }\n                        var expectedDts = _lastSample.dts + _lastSample.duration + distance;\n                        dtsCorrection = firstSampleOriginalDts - expectedDts;\n                    } else {\n                        // lastSample == null, cannot found\n                        dtsCorrection = 0;\n                    }\n                }\n            }\n\n            if (insertPrefixSilentFrame) {\n                // align audio segment beginDts to match with current video segment's beginDts\n                var firstSampleDts = firstSampleOriginalDts - dtsCorrection;\n                var videoSegment = this._videoSegmentInfoList.getLastSegmentBefore(firstSampleOriginalDts);\n                if (videoSegment != null && videoSegment.beginDts < firstSampleDts) {\n                    var silentUnit = _aacSilent2.default.getSilentFrame(this._audioMeta.originalCodec, this._audioMeta.channelCount);\n                    if (silentUnit) {\n                        var dts = videoSegment.beginDts;\n                        var silentFrameDuration = firstSampleDts - videoSegment.beginDts;\n                        _logger2.default.v(this.TAG, 'InsertPrefixSilentAudio: dts: ' + dts + ', duration: ' + silentFrameDuration);\n                        samples.unshift({ unit: silentUnit, dts: dts, pts: dts });\n                        mdatBytes += silentUnit.byteLength;\n                    } // silentUnit == null: Cannot generate, skip\n                } else {\n                    insertPrefixSilentFrame = false;\n                }\n            }\n\n            var mp4Samples = [];\n\n            // Correct dts for each sample, and calculate sample duration. Then output to mp4Samples\n            for (var i = 0; i < samples.length; i++) {\n                var _sample = samples[i];\n                var unit = _sample.unit;\n                var originalDts = _sample.dts - this._dtsBase;\n                var _dts = originalDts;\n                var needFillSilentFrames = false;\n                var silentFrames = null;\n                var sampleDuration = 0;\n\n                if (originalDts < -0.001) {\n                    continue; //pass the first sample with the invalid dts\n                }\n\n                if (this._audioMeta.codec !== 'mp3') {\n                    // for AAC codec, we need to keep dts increase based on refSampleDuration\n                    var curRefDts = originalDts;\n                    var maxAudioFramesDrift = 3;\n                    if (this._audioNextDts) {\n                        curRefDts = this._audioNextDts;\n                    }\n\n                    dtsCorrection = originalDts - curRefDts;\n                    if (dtsCorrection <= -maxAudioFramesDrift * refSampleDuration) {\n                        // If we're overlapping by more than maxAudioFramesDrift number of frame, drop this sample\n                        //Log.w(this.TAG, `Dropping 1 audio frame (originalDts: ${originalDts} ms ,curRefDts: ${curRefDts} ms)  due to dtsCorrection: ${dtsCorrection} ms overlap.`);\n                        continue;\n                    } else if (dtsCorrection >= maxAudioFramesDrift * refSampleDuration && this._fillAudioTimestampGap && !_browser2.default.safari) {\n                        // Silent frame generation, if large timestamp gap detected && config.fixAudioTimestampGap\n                        needFillSilentFrames = true;\n                        // We need to insert silent frames to fill timestamp gap\n                        var frameCount = Math.floor(dtsCorrection / refSampleDuration);\n                        _logger2.default.w(this.TAG, 'Large audio timestamp gap detected, may cause AV sync to drift. ' + 'Silent frames will be generated to avoid unsync.\\n' + ('originalDts: ' + originalDts + ' ms, curRefDts: ' + curRefDts + ' ms, ') + ('dtsCorrection: ' + Math.round(dtsCorrection) + ' ms, generate: ' + frameCount + ' frames'));\n\n                        _dts = Math.floor(curRefDts);\n                        sampleDuration = Math.floor(curRefDts + refSampleDuration) - _dts;\n\n                        var _silentUnit = _aacSilent2.default.getSilentFrame(this._audioMeta.originalCodec, this._audioMeta.channelCount);\n                        if (_silentUnit == null) {\n                            _logger2.default.w(this.TAG, 'Unable to generate silent frame for ' + (this._audioMeta.originalCodec + ' with ' + this._audioMeta.channelCount + ' channels, repeat last frame'));\n                            // Repeat last frame\n                            _silentUnit = unit;\n                        }\n                        silentFrames = [];\n\n                        for (var j = 0; j < frameCount; j++) {\n                            curRefDts = curRefDts + refSampleDuration;\n                            var intDts = Math.floor(curRefDts); // change to integer\n                            var intDuration = Math.floor(curRefDts + refSampleDuration) - intDts;\n                            var frame = {\n                                dts: intDts,\n                                pts: intDts,\n                                cts: 0,\n                                unit: _silentUnit,\n                                size: _silentUnit.byteLength,\n                                duration: intDuration, // wait for next sample\n                                originalDts: originalDts,\n                                flags: {\n                                    isLeading: 0,\n                                    dependsOn: 1,\n                                    isDependedOn: 0,\n                                    hasRedundancy: 0\n                                }\n                            };\n                            silentFrames.push(frame);\n                            mdatBytes += frame.size;\n                        }\n\n                        this._audioNextDts = curRefDts + refSampleDuration;\n                    } else {\n\n                        _dts = Math.floor(curRefDts);\n                        sampleDuration = Math.floor(curRefDts + refSampleDuration) - _dts;\n                        this._audioNextDts = curRefDts + refSampleDuration;\n                    }\n                } else {\n                    // keep the original dts calculate algorithm for mp3\n                    _dts = originalDts - dtsCorrection;\n\n                    if (i !== samples.length - 1) {\n                        var nextDts = samples[i + 1].dts - this._dtsBase - dtsCorrection;\n                        sampleDuration = nextDts - _dts;\n                    } else {\n                        // the last sample\n                        if (lastSample != null) {\n                            // use stashed sample's dts to calculate sample duration\n                            var _nextDts = lastSample.dts - this._dtsBase - dtsCorrection;\n                            sampleDuration = _nextDts - _dts;\n                        } else if (mp4Samples.length >= 1) {\n                            // use second last sample duration\n                            sampleDuration = mp4Samples[mp4Samples.length - 1].duration;\n                        } else {\n                            // the only one sample, use reference sample duration\n                            sampleDuration = Math.floor(refSampleDuration);\n                        }\n                    }\n                    this._audioNextDts = _dts + sampleDuration;\n                }\n\n                if (firstDts === -1) {\n                    firstDts = _dts;\n                }\n                mp4Samples.push({\n                    dts: _dts,\n                    pts: _dts,\n                    cts: 0,\n                    unit: _sample.unit,\n                    size: _sample.unit.byteLength,\n                    duration: sampleDuration,\n                    originalDts: originalDts,\n                    flags: {\n                        isLeading: 0,\n                        dependsOn: 1,\n                        isDependedOn: 0,\n                        hasRedundancy: 0\n                    }\n                });\n\n                if (needFillSilentFrames) {\n                    // Silent frames should be inserted after wrong-duration frame\n                    mp4Samples.push.apply(mp4Samples, silentFrames);\n                }\n            }\n\n            if (mp4Samples.length === 0) {\n                //no samples need to remux\n                track.samples = [];\n                track.length = 0;\n                return;\n            }\n\n            // allocate mdatbox\n            if (mpegRawTrack) {\n                // allocate for raw mpeg buffer\n                mdatbox = new Uint8Array(mdatBytes);\n            } else {\n                // allocate for fmp4 mdat box\n                mdatbox = new Uint8Array(mdatBytes);\n                // size field\n                mdatbox[0] = mdatBytes >>> 24 & 0xFF;\n                mdatbox[1] = mdatBytes >>> 16 & 0xFF;\n                mdatbox[2] = mdatBytes >>> 8 & 0xFF;\n                mdatbox[3] = mdatBytes & 0xFF;\n                // type field (fourCC)\n                mdatbox.set(_mp4Generator2.default.types.mdat, 4);\n            }\n\n            // Write samples into mdatbox\n            for (var _i = 0; _i < mp4Samples.length; _i++) {\n                var _unit = mp4Samples[_i].unit;\n                mdatbox.set(_unit, offset);\n                offset += _unit.byteLength;\n            }\n\n            var latest = mp4Samples[mp4Samples.length - 1];\n            lastDts = latest.dts + latest.duration;\n            //this._audioNextDts = lastDts;\n\n            // fill media segment info & add to info list\n            var info = new _mediaSegmentInfo.MediaSegmentInfo();\n            info.beginDts = firstDts;\n            info.endDts = lastDts;\n            info.beginPts = firstDts;\n            info.endPts = lastDts;\n            info.originalBeginDts = mp4Samples[0].originalDts;\n            info.originalEndDts = latest.originalDts + latest.duration;\n            info.firstSample = new _mediaSegmentInfo.SampleInfo(mp4Samples[0].dts, mp4Samples[0].pts, mp4Samples[0].duration, mp4Samples[0].originalDts, false);\n            info.lastSample = new _mediaSegmentInfo.SampleInfo(latest.dts, latest.pts, latest.duration, latest.originalDts, false);\n            if (!this._isLive) {\n                this._audioSegmentInfoList.append(info);\n            }\n\n            track.samples = mp4Samples;\n            track.sequenceNumber++;\n\n            var moofbox = null;\n\n            if (mpegRawTrack) {\n                // Generate empty buffer, because useless for raw mpeg\n                moofbox = new Uint8Array();\n            } else {\n                // Generate moof for fmp4 segment\n                moofbox = _mp4Generator2.default.moof(track, firstDts);\n            }\n\n            track.samples = [];\n            track.length = 0;\n\n            var segment = {\n                type: 'audio',\n                data: this._mergeBoxes(moofbox, mdatbox).buffer,\n                sampleCount: mp4Samples.length,\n                info: info\n            };\n\n            if (mpegRawTrack && firstSegmentAfterSeek) {\n                // For MPEG audio stream in MSE, if seeking occurred, before appending new buffer\n                // We need explicitly set timestampOffset to the desired point in timeline for mpeg SourceBuffer.\n                segment.timestampOffset = firstDts;\n            }\n\n            this._onMediaSegment('audio', segment);\n        }\n    }, {\n        key: '_remuxVideo',\n        value: function _remuxVideo(videoTrack, force) {\n            if (this._videoMeta == null) {\n                return;\n            }\n\n            var track = videoTrack;\n            var samples = track.samples;\n            var dtsCorrection = undefined;\n            var firstDts = -1,\n                lastDts = -1;\n            var firstPts = -1,\n                lastPts = -1;\n\n            if (!samples || samples.length === 0) {\n                return;\n            }\n            if (samples.length === 1 && !force) {\n                // If [sample count in current batch] === 1 && (force != true)\n                // Ignore and keep in demuxer's queue\n                return;\n            } // else if (force === true) do remux\n\n            var offset = 8;\n            var mdatbox = null;\n            var mdatBytes = 8 + videoTrack.length;\n\n            var lastSample = null;\n\n            // Pop the lastSample and waiting for stash\n            if (samples.length > 1) {\n                lastSample = samples.pop();\n                mdatBytes -= lastSample.length;\n            }\n\n            // Insert [stashed lastSample in the previous batch] to the front\n            if (this._videoStashedLastSample != null) {\n                var sample = this._videoStashedLastSample;\n                this._videoStashedLastSample = null;\n                samples.unshift(sample);\n                mdatBytes += sample.length;\n            }\n\n            // Stash the lastSample of current batch, waiting for next batch\n            if (lastSample != null) {\n                this._videoStashedLastSample = lastSample;\n            }\n\n            var firstSampleOriginalDts = samples[0].dts - this._dtsBase;\n\n            // calculate dtsCorrection\n            if (this._videoNextDts) {\n                dtsCorrection = firstSampleOriginalDts - this._videoNextDts;\n            } else {\n                // this._videoNextDts == undefined\n                if (this._videoSegmentInfoList.isEmpty()) {\n                    dtsCorrection = 0;\n                } else {\n                    var _lastSample2 = this._videoSegmentInfoList.getLastSampleBefore(firstSampleOriginalDts);\n                    if (_lastSample2 != null) {\n                        var distance = firstSampleOriginalDts - (_lastSample2.originalDts + _lastSample2.duration);\n                        if (distance <= 3) {\n                            distance = 0;\n                        }\n                        var expectedDts = _lastSample2.dts + _lastSample2.duration + distance;\n                        dtsCorrection = firstSampleOriginalDts - expectedDts;\n                    } else {\n                        // lastSample == null, cannot found\n                        dtsCorrection = 0;\n                    }\n                }\n            }\n\n            var info = new _mediaSegmentInfo.MediaSegmentInfo();\n            var mp4Samples = [];\n\n            // Correct dts for each sample, and calculate sample duration. Then output to mp4Samples\n            for (var i = 0; i < samples.length; i++) {\n                var _sample2 = samples[i];\n                var originalDts = _sample2.dts - this._dtsBase;\n                var isKeyframe = _sample2.isKeyframe;\n                var dts = originalDts - dtsCorrection;\n                var cts = _sample2.cts;\n                var pts = dts + cts;\n\n                if (firstDts === -1) {\n                    firstDts = dts;\n                    firstPts = pts;\n                }\n\n                var sampleDuration = 0;\n\n                if (i !== samples.length - 1) {\n                    var nextDts = samples[i + 1].dts - this._dtsBase - dtsCorrection;\n                    sampleDuration = nextDts - dts;\n                } else {\n                    // the last sample\n                    if (lastSample != null) {\n                        // use stashed sample's dts to calculate sample duration\n                        var _nextDts2 = lastSample.dts - this._dtsBase - dtsCorrection;\n                        sampleDuration = _nextDts2 - dts;\n                    } else if (mp4Samples.length >= 1) {\n                        // use second last sample duration\n                        sampleDuration = mp4Samples[mp4Samples.length - 1].duration;\n                    } else {\n                        // the only one sample, use reference sample duration\n                        sampleDuration = Math.floor(this._videoMeta.refSampleDuration);\n                    }\n                }\n\n                if (isKeyframe) {\n                    var syncPoint = new _mediaSegmentInfo.SampleInfo(dts, pts, sampleDuration, _sample2.dts, true);\n                    syncPoint.fileposition = _sample2.fileposition;\n                    info.appendSyncPoint(syncPoint);\n                }\n\n                mp4Samples.push({\n                    dts: dts,\n                    pts: pts,\n                    cts: cts,\n                    units: _sample2.units,\n                    size: _sample2.length,\n                    isKeyframe: isKeyframe,\n                    duration: sampleDuration,\n                    originalDts: originalDts,\n                    flags: {\n                        isLeading: 0,\n                        dependsOn: isKeyframe ? 2 : 1,\n                        isDependedOn: isKeyframe ? 1 : 0,\n                        hasRedundancy: 0,\n                        isNonSync: isKeyframe ? 0 : 1\n                    }\n                });\n            }\n\n            // allocate mdatbox\n            mdatbox = new Uint8Array(mdatBytes);\n            mdatbox[0] = mdatBytes >>> 24 & 0xFF;\n            mdatbox[1] = mdatBytes >>> 16 & 0xFF;\n            mdatbox[2] = mdatBytes >>> 8 & 0xFF;\n            mdatbox[3] = mdatBytes & 0xFF;\n            mdatbox.set(_mp4Generator2.default.types.mdat, 4);\n\n            // Write samples into mdatbox\n            for (var _i2 = 0; _i2 < mp4Samples.length; _i2++) {\n                var units = mp4Samples[_i2].units;\n                while (units.length) {\n                    var unit = units.shift();\n                    var data = unit.data;\n                    mdatbox.set(data, offset);\n                    offset += data.byteLength;\n                }\n            }\n\n            var latest = mp4Samples[mp4Samples.length - 1];\n            lastDts = latest.dts + latest.duration;\n            lastPts = latest.pts + latest.duration;\n            this._videoNextDts = lastDts;\n\n            // fill media segment info & add to info list\n            info.beginDts = firstDts;\n            info.endDts = lastDts;\n            info.beginPts = firstPts;\n            info.endPts = lastPts;\n            info.originalBeginDts = mp4Samples[0].originalDts;\n            info.originalEndDts = latest.originalDts + latest.duration;\n            info.firstSample = new _mediaSegmentInfo.SampleInfo(mp4Samples[0].dts, mp4Samples[0].pts, mp4Samples[0].duration, mp4Samples[0].originalDts, mp4Samples[0].isKeyframe);\n            info.lastSample = new _mediaSegmentInfo.SampleInfo(latest.dts, latest.pts, latest.duration, latest.originalDts, latest.isKeyframe);\n            if (!this._isLive) {\n                this._videoSegmentInfoList.append(info);\n            }\n\n            track.samples = mp4Samples;\n            track.sequenceNumber++;\n\n            // workaround for chrome < 50: force first sample as a random access point\n            // see https://bugs.chromium.org/p/chromium/issues/detail?id=229412\n            if (this._forceFirstIDR) {\n                var flags = mp4Samples[0].flags;\n                flags.dependsOn = 2;\n                flags.isNonSync = 0;\n            }\n\n            var moofbox = _mp4Generator2.default.moof(track, firstDts);\n            track.samples = [];\n            track.length = 0;\n\n            this._onMediaSegment('video', {\n                type: 'video',\n                data: this._mergeBoxes(moofbox, mdatbox).buffer,\n                sampleCount: mp4Samples.length,\n                info: info\n            });\n        }\n    }, {\n        key: '_mergeBoxes',\n        value: function _mergeBoxes(moof, mdat) {\n            var result = new Uint8Array(moof.byteLength + mdat.byteLength);\n            result.set(moof, 0);\n            result.set(mdat, moof.byteLength);\n            return result;\n        }\n    }, {\n        key: 'onInitSegment',\n        get: function get() {\n            return this._onInitSegment;\n        },\n        set: function set(callback) {\n            this._onInitSegment = callback;\n        }\n\n        /* prototype: function onMediaSegment(type: string, mediaSegment: MediaSegment): void\r\n           MediaSegment: {\r\n               type: string,\r\n               data: ArrayBuffer,\r\n               sampleCount: int32\r\n               info: MediaSegmentInfo\r\n           }\r\n        */\n\n    }, {\n        key: 'onMediaSegment',\n        get: function get() {\n            return this._onMediaSegment;\n        },\n        set: function set(callback) {\n            this._onMediaSegment = callback;\n        }\n    }]);\n\n    return MP4Remuxer;\n}();\n\nexports.default = MP4Remuxer;\n\n},{\"../core/media-segment-info.js\":8,\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./aac-silent.js\":36,\"./mp4-generator.js\":37}],39:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar Browser = {};\n\nfunction detect() {\n    // modified from jquery-browser-plugin\n\n    var ua = self.navigator.userAgent.toLowerCase();\n\n    var match = /(edge)\\/([\\w.]+)/.exec(ua) || /(opr)[\\/]([\\w.]+)/.exec(ua) || /(chrome)[ \\/]([\\w.]+)/.exec(ua) || /(iemobile)[\\/]([\\w.]+)/.exec(ua) || /(version)(applewebkit)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.exec(ua) || /(webkit)[ \\/]([\\w.]+).*(version)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.exec(ua) || /(webkit)[ \\/]([\\w.]+)/.exec(ua) || /(opera)(?:.*version|)[ \\/]([\\w.]+)/.exec(ua) || /(msie) ([\\w.]+)/.exec(ua) || ua.indexOf('trident') >= 0 && /(rv)(?::| )([\\w.]+)/.exec(ua) || ua.indexOf('compatible') < 0 && /(firefox)[ \\/]([\\w.]+)/.exec(ua) || [];\n\n    var platform_match = /(ipad)/.exec(ua) || /(ipod)/.exec(ua) || /(windows phone)/.exec(ua) || /(iphone)/.exec(ua) || /(kindle)/.exec(ua) || /(android)/.exec(ua) || /(windows)/.exec(ua) || /(mac)/.exec(ua) || /(linux)/.exec(ua) || /(cros)/.exec(ua) || [];\n\n    var matched = {\n        browser: match[5] || match[3] || match[1] || '',\n        version: match[2] || match[4] || '0',\n        majorVersion: match[4] || match[2] || '0',\n        platform: platform_match[0] || ''\n    };\n\n    var browser = {};\n    if (matched.browser) {\n        browser[matched.browser] = true;\n\n        var versionArray = matched.majorVersion.split('.');\n        browser.version = {\n            major: parseInt(matched.majorVersion, 10),\n            string: matched.version\n        };\n        if (versionArray.length > 1) {\n            browser.version.minor = parseInt(versionArray[1], 10);\n        }\n        if (versionArray.length > 2) {\n            browser.version.build = parseInt(versionArray[2], 10);\n        }\n    }\n\n    if (matched.platform) {\n        browser[matched.platform] = true;\n    }\n\n    if (browser.chrome || browser.opr || browser.safari) {\n        browser.webkit = true;\n    }\n\n    // MSIE. IE11 has 'rv' identifer\n    if (browser.rv || browser.iemobile) {\n        if (browser.rv) {\n            delete browser.rv;\n        }\n        var msie = 'msie';\n        matched.browser = msie;\n        browser[msie] = true;\n    }\n\n    // Microsoft Edge\n    if (browser.edge) {\n        delete browser.edge;\n        var msedge = 'msedge';\n        matched.browser = msedge;\n        browser[msedge] = true;\n    }\n\n    // Opera 15+\n    if (browser.opr) {\n        var opera = 'opera';\n        matched.browser = opera;\n        browser[opera] = true;\n    }\n\n    // Stock android browsers are marked as Safari\n    if (browser.safari && browser.android) {\n        var android = 'android';\n        matched.browser = android;\n        browser[android] = true;\n    }\n\n    browser.name = matched.browser;\n    browser.platform = matched.platform;\n\n    for (var key in Browser) {\n        if (Browser.hasOwnProperty(key)) {\n            delete Browser[key];\n        }\n    }\n    Object.assign(Browser, browser);\n}\n\ndetect();\n\nexports.default = Browser;\n\n},{}],40:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar RuntimeException = exports.RuntimeException = function () {\n    function RuntimeException(message) {\n        _classCallCheck(this, RuntimeException);\n\n        this._message = message;\n    }\n\n    _createClass(RuntimeException, [{\n        key: 'toString',\n        value: function toString() {\n            return this.name + ': ' + this.message;\n        }\n    }, {\n        key: 'name',\n        get: function get() {\n            return 'RuntimeException';\n        }\n    }, {\n        key: 'message',\n        get: function get() {\n            return this._message;\n        }\n    }]);\n\n    return RuntimeException;\n}();\n\nvar IllegalStateException = exports.IllegalStateException = function (_RuntimeException) {\n    _inherits(IllegalStateException, _RuntimeException);\n\n    function IllegalStateException(message) {\n        _classCallCheck(this, IllegalStateException);\n\n        return _possibleConstructorReturn(this, (IllegalStateException.__proto__ || Object.getPrototypeOf(IllegalStateException)).call(this, message));\n    }\n\n    _createClass(IllegalStateException, [{\n        key: 'name',\n        get: function get() {\n            return 'IllegalStateException';\n        }\n    }]);\n\n    return IllegalStateException;\n}(RuntimeException);\n\nvar InvalidArgumentException = exports.InvalidArgumentException = function (_RuntimeException2) {\n    _inherits(InvalidArgumentException, _RuntimeException2);\n\n    function InvalidArgumentException(message) {\n        _classCallCheck(this, InvalidArgumentException);\n\n        return _possibleConstructorReturn(this, (InvalidArgumentException.__proto__ || Object.getPrototypeOf(InvalidArgumentException)).call(this, message));\n    }\n\n    _createClass(InvalidArgumentException, [{\n        key: 'name',\n        get: function get() {\n            return 'InvalidArgumentException';\n        }\n    }]);\n\n    return InvalidArgumentException;\n}(RuntimeException);\n\nvar NotImplementedException = exports.NotImplementedException = function (_RuntimeException3) {\n    _inherits(NotImplementedException, _RuntimeException3);\n\n    function NotImplementedException(message) {\n        _classCallCheck(this, NotImplementedException);\n\n        return _possibleConstructorReturn(this, (NotImplementedException.__proto__ || Object.getPrototypeOf(NotImplementedException)).call(this, message));\n    }\n\n    _createClass(NotImplementedException, [{\n        key: 'name',\n        get: function get() {\n            return 'NotImplementedException';\n        }\n    }]);\n\n    return NotImplementedException;\n}(RuntimeException);\n\n},{}],41:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Log = function () {\n    function Log() {\n        _classCallCheck(this, Log);\n    }\n\n    _createClass(Log, null, [{\n        key: 'e',\n        value: function e(tag, msg) {\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\n\n            var str = '[' + tag + '] > ' + msg;\n\n            if (Log.ENABLE_CALLBACK) {\n                Log.emitter.emit('log', 'error', str);\n            }\n\n            if (!Log.ENABLE_ERROR) {\n                return;\n            }\n\n            if (console.error) {\n                console.error(str);\n            } else if (console.warn) {\n                console.warn(str);\n            } else {\n                console.log(str);\n            }\n        }\n    }, {\n        key: 'i',\n        value: function i(tag, msg) {\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\n\n            var str = '[' + tag + '] > ' + msg;\n\n            if (Log.ENABLE_CALLBACK) {\n                Log.emitter.emit('log', 'info', str);\n            }\n\n            if (!Log.ENABLE_INFO) {\n                return;\n            }\n\n            if (console.info) {\n                console.info(str);\n            } else {\n                console.log(str);\n            }\n        }\n    }, {\n        key: 'w',\n        value: function w(tag, msg) {\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\n\n            var str = '[' + tag + '] > ' + msg;\n\n            if (Log.ENABLE_CALLBACK) {\n                Log.emitter.emit('log', 'warn', str);\n            }\n\n            if (!Log.ENABLE_WARN) {\n                return;\n            }\n\n            if (console.warn) {\n                console.warn(str);\n            } else {\n                console.log(str);\n            }\n        }\n    }, {\n        key: 'd',\n        value: function d(tag, msg) {\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\n\n            var str = '[' + tag + '] > ' + msg;\n\n            if (Log.ENABLE_CALLBACK) {\n                Log.emitter.emit('log', 'debug', str);\n            }\n\n            if (!Log.ENABLE_DEBUG) {\n                return;\n            }\n\n            if (console.debug) {\n                console.debug(str);\n            } else {\n                console.log(str);\n            }\n        }\n    }, {\n        key: 'v',\n        value: function v(tag, msg) {\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\n\n            var str = '[' + tag + '] > ' + msg;\n\n            if (Log.ENABLE_CALLBACK) {\n                Log.emitter.emit('log', 'verbose', str);\n            }\n\n            if (!Log.ENABLE_VERBOSE) {\n                return;\n            }\n\n            console.log(str);\n        }\n    }]);\n\n    return Log;\n}();\n\nLog.GLOBAL_TAG = 'flv.js';\nLog.FORCE_GLOBAL_TAG = false;\nLog.ENABLE_ERROR = true;\nLog.ENABLE_INFO = true;\nLog.ENABLE_WARN = true;\nLog.ENABLE_DEBUG = true;\nLog.ENABLE_VERBOSE = true;\n\nLog.ENABLE_CALLBACK = false;\n\nLog.emitter = new _events2.default();\n\nexports.default = Log;\n\n},{\"events\":2}],42:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_('./logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar LoggingControl = function () {\n    function LoggingControl() {\n        _classCallCheck(this, LoggingControl);\n    }\n\n    _createClass(LoggingControl, null, [{\n        key: 'getConfig',\n        value: function getConfig() {\n            return {\n                globalTag: _logger2.default.GLOBAL_TAG,\n                forceGlobalTag: _logger2.default.FORCE_GLOBAL_TAG,\n                enableVerbose: _logger2.default.ENABLE_VERBOSE,\n                enableDebug: _logger2.default.ENABLE_DEBUG,\n                enableInfo: _logger2.default.ENABLE_INFO,\n                enableWarn: _logger2.default.ENABLE_WARN,\n                enableError: _logger2.default.ENABLE_ERROR,\n                enableCallback: _logger2.default.ENABLE_CALLBACK\n            };\n        }\n    }, {\n        key: 'applyConfig',\n        value: function applyConfig(config) {\n            _logger2.default.GLOBAL_TAG = config.globalTag;\n            _logger2.default.FORCE_GLOBAL_TAG = config.forceGlobalTag;\n            _logger2.default.ENABLE_VERBOSE = config.enableVerbose;\n            _logger2.default.ENABLE_DEBUG = config.enableDebug;\n            _logger2.default.ENABLE_INFO = config.enableInfo;\n            _logger2.default.ENABLE_WARN = config.enableWarn;\n            _logger2.default.ENABLE_ERROR = config.enableError;\n            _logger2.default.ENABLE_CALLBACK = config.enableCallback;\n        }\n    }, {\n        key: '_notifyChange',\n        value: function _notifyChange() {\n            var emitter = LoggingControl.emitter;\n\n            if (emitter.listenerCount('change') > 0) {\n                var config = LoggingControl.getConfig();\n                emitter.emit('change', config);\n            }\n        }\n    }, {\n        key: 'registerListener',\n        value: function registerListener(listener) {\n            LoggingControl.emitter.addListener('change', listener);\n        }\n    }, {\n        key: 'removeListener',\n        value: function removeListener(listener) {\n            LoggingControl.emitter.removeListener('change', listener);\n        }\n    }, {\n        key: 'addLogListener',\n        value: function addLogListener(listener) {\n            _logger2.default.emitter.addListener('log', listener);\n            if (_logger2.default.emitter.listenerCount('log') > 0) {\n                _logger2.default.ENABLE_CALLBACK = true;\n                LoggingControl._notifyChange();\n            }\n        }\n    }, {\n        key: 'removeLogListener',\n        value: function removeLogListener(listener) {\n            _logger2.default.emitter.removeListener('log', listener);\n            if (_logger2.default.emitter.listenerCount('log') === 0) {\n                _logger2.default.ENABLE_CALLBACK = false;\n                LoggingControl._notifyChange();\n            }\n        }\n    }, {\n        key: 'forceGlobalTag',\n        get: function get() {\n            return _logger2.default.FORCE_GLOBAL_TAG;\n        },\n        set: function set(enable) {\n            _logger2.default.FORCE_GLOBAL_TAG = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'globalTag',\n        get: function get() {\n            return _logger2.default.GLOBAL_TAG;\n        },\n        set: function set(tag) {\n            _logger2.default.GLOBAL_TAG = tag;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableAll',\n        get: function get() {\n            return _logger2.default.ENABLE_VERBOSE && _logger2.default.ENABLE_DEBUG && _logger2.default.ENABLE_INFO && _logger2.default.ENABLE_WARN && _logger2.default.ENABLE_ERROR;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_VERBOSE = enable;\n            _logger2.default.ENABLE_DEBUG = enable;\n            _logger2.default.ENABLE_INFO = enable;\n            _logger2.default.ENABLE_WARN = enable;\n            _logger2.default.ENABLE_ERROR = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableDebug',\n        get: function get() {\n            return _logger2.default.ENABLE_DEBUG;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_DEBUG = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableVerbose',\n        get: function get() {\n            return _logger2.default.ENABLE_VERBOSE;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_VERBOSE = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableInfo',\n        get: function get() {\n            return _logger2.default.ENABLE_INFO;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_INFO = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableWarn',\n        get: function get() {\n            return _logger2.default.ENABLE_WARN;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_WARN = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableError',\n        get: function get() {\n            return _logger2.default.ENABLE_ERROR;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_ERROR = enable;\n            LoggingControl._notifyChange();\n        }\n    }]);\n\n    return LoggingControl;\n}();\n\nLoggingControl.emitter = new _events2.default();\n\nexports.default = LoggingControl;\n\n},{\"./logger.js\":41,\"events\":2}],43:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar Polyfill = function () {\n    function Polyfill() {\n        _classCallCheck(this, Polyfill);\n    }\n\n    _createClass(Polyfill, null, [{\n        key: 'install',\n        value: function install() {\n            // ES6 Object.setPrototypeOf\n            Object.setPrototypeOf = Object.setPrototypeOf || function (obj, proto) {\n                obj.__proto__ = proto;\n                return obj;\n            };\n\n            // ES6 Object.assign\n            Object.assign = Object.assign || function (target) {\n                if (target === undefined || target === null) {\n                    throw new TypeError('Cannot convert undefined or null to object');\n                }\n\n                var output = Object(target);\n                for (var i = 1; i < arguments.length; i++) {\n                    var source = arguments[i];\n                    if (source !== undefined && source !== null) {\n                        for (var key in source) {\n                            if (source.hasOwnProperty(key)) {\n                                output[key] = source[key];\n                            }\n                        }\n                    }\n                }\n                return output;\n            };\n\n            // ES6 Promise (missing support in IE11)\n            if (typeof self.Promise !== 'function') {\n                _dereq_('es6-promise').polyfill();\n            }\n        }\n    }]);\n\n    return Polyfill;\n}();\n\nPolyfill.install();\n\nexports.default = Polyfill;\n\n},{\"es6-promise\":1}],44:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * This file is derived from C++ project libWinTF8 (https://github.com/m13253/libWinTF8)\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nfunction checkContinuation(uint8array, start, checkLength) {\n    var array = uint8array;\n    if (start + checkLength < array.length) {\n        while (checkLength--) {\n            if ((array[++start] & 0xC0) !== 0x80) return false;\n        }\n        return true;\n    } else {\n        return false;\n    }\n}\n\nfunction decodeUTF8(uint8array) {\n    var out = [];\n    var input = uint8array;\n    var i = 0;\n    var length = uint8array.length;\n\n    while (i < length) {\n        if (input[i] < 0x80) {\n            out.push(String.fromCharCode(input[i]));\n            ++i;\n            continue;\n        } else if (input[i] < 0xC0) {\n            // fallthrough\n        } else if (input[i] < 0xE0) {\n            if (checkContinuation(input, i, 1)) {\n                var ucs4 = (input[i] & 0x1F) << 6 | input[i + 1] & 0x3F;\n                if (ucs4 >= 0x80) {\n                    out.push(String.fromCharCode(ucs4 & 0xFFFF));\n                    i += 2;\n                    continue;\n                }\n            }\n        } else if (input[i] < 0xF0) {\n            if (checkContinuation(input, i, 2)) {\n                var _ucs = (input[i] & 0xF) << 12 | (input[i + 1] & 0x3F) << 6 | input[i + 2] & 0x3F;\n                if (_ucs >= 0x800 && (_ucs & 0xF800) !== 0xD800) {\n                    out.push(String.fromCharCode(_ucs & 0xFFFF));\n                    i += 3;\n                    continue;\n                }\n            }\n        } else if (input[i] < 0xF8) {\n            if (checkContinuation(input, i, 3)) {\n                var _ucs2 = (input[i] & 0x7) << 18 | (input[i + 1] & 0x3F) << 12 | (input[i + 2] & 0x3F) << 6 | input[i + 3] & 0x3F;\n                if (_ucs2 > 0x10000 && _ucs2 < 0x110000) {\n                    _ucs2 -= 0x10000;\n                    out.push(String.fromCharCode(_ucs2 >>> 10 | 0xD800));\n                    out.push(String.fromCharCode(_ucs2 & 0x3FF | 0xDC00));\n                    i += 4;\n                    continue;\n                }\n            }\n        }\n        out.push(String.fromCharCode(0xFFFD));\n        ++i;\n    }\n\n    return out.join('');\n}\n\nexports.default = decodeUTF8;\n\n},{}]},{},[21])(21)\n});\n\n//# sourceMappingURL=flv.js.map\n","/*\nmp3编码器用到的lamejs编码引擎，一般都用MP3格式，浏览器支持广泛，此引擎测试的也比较多，稳定\nhttps://github.com/xiangyuecn/Recorder\n*/\n(function(){\n\"use strict\";\n\n//end2 ****开始copy lamejs*****\n/*\nmp3编码依赖lamejs，如果无需mp3支持直接移除此代码\nhttps://github.com/zhuker/lamejs/blob/bfb7f6c6d7877e0fe1ad9e72697a871676119a0e/lame.all.js\n*/\n\nfunction lamejs() {\nvar Math_log10=function(s){//坚决不能用也不要报语言问题的错误\n\treturn Math.log(s)/Math.log(10);\n};\n\nfunction new_byte(count) {\n    return new Int8Array(count);\n}\n\nfunction new_short(count) {\n    return new Int16Array(count);\n}\n\nfunction new_int(count) {\n    return new Int32Array(count);\n}\n\nfunction new_float(count) {\n    return new Float32Array(count);\n}\n\nfunction new_double(count) {\n    return new Float64Array(count);\n}\n\nfunction new_float_n(args) {\n    if (args.length == 1) {\n        return new_float(args[0]);\n    }\n    var sz = args[0];\n    args = args.slice(1);\n    var A = [];\n    for (var i = 0; i < sz; i++) {\n        A.push(new_float_n(args));\n    }\n    return A;\n}\nfunction new_int_n(args) {\n    if (args.length == 1) {\n        return new_int(args[0]);\n    }\n    var sz = args[0];\n    args = args.slice(1);\n    var A = [];\n    for (var i = 0; i < sz; i++) {\n        A.push(new_int_n(args));\n    }\n    return A;\n}\n\nfunction new_short_n(args) {\n    if (args.length == 1) {\n        return new_short(args[0]);\n    }\n    var sz = args[0];\n    args = args.slice(1);\n    var A = [];\n    for (var i = 0; i < sz; i++) {\n        A.push(new_short_n(args));\n    }\n    return A;\n}\n\nfunction new_array_n(args) {\n    if (args.length == 1) {\n        return new Array(args[0]);\n    }\n    var sz = args[0];\n    args = args.slice(1);\n    var A = [];\n    for (var i = 0; i < sz; i++) {\n        A.push(new_array_n(args));\n    }\n    return A;\n}\n\n\nvar Arrays = {};\n\nArrays.fill = function (a, fromIndex, toIndex, val) {\n    if (arguments.length == 2) {\n        for (var i = 0; i < a.length; i++) {\n            a[i] = arguments[1];\n        }\n    } else {\n        for (var i = fromIndex; i < toIndex; i++) {\n            a[i] = val;\n        }\n    }\n};\n\nvar System = {};\n\nSystem.arraycopy = function (src, srcPos, dest, destPos, length) {\n    var srcEnd = srcPos + length;\n    while (srcPos < srcEnd)\n        dest[destPos++] = src[srcPos++];\n};\n\n\nvar Util = {};\nUtil.SQRT2 = 1.41421356237309504880;\nUtil.FAST_LOG10 = function (x) {\n    return Math_log10(x);\n};\n\nUtil.FAST_LOG10_X = function (x, y) {\n    return Math_log10(x) * y;\n};\n\nfunction ShortBlock(ordinal) {\n    this.ordinal = ordinal;\n}\n/**\n * LAME may use them, even different block types for L/R.\n */\nShortBlock.short_block_allowed = new ShortBlock(0);\n/**\n * LAME may use them, but always same block types in L/R.\n */\nShortBlock.short_block_coupled = new ShortBlock(1);\n/**\n * LAME will not use short blocks, long blocks only.\n */\nShortBlock.short_block_dispensed = new ShortBlock(2);\n/**\n * LAME will not use long blocks, short blocks only.\n */\nShortBlock.short_block_forced = new ShortBlock(3);\n\nvar Float = {};\nFloat.MAX_VALUE = 3.4028235e+38;\n\nfunction VbrMode(ordinal) {\n    this.ordinal = ordinal;\n}\nVbrMode.vbr_off = new VbrMode(0);\nVbrMode.vbr_mt = new VbrMode(1);\nVbrMode.vbr_rh = new VbrMode(2);\nVbrMode.vbr_abr = new VbrMode(3);\nVbrMode.vbr_mtrh = new VbrMode(4);\nVbrMode.vbr_default = VbrMode.vbr_mtrh;\n\nvar assert = function (x) {\n    //console.assert(x);\n};\n\nvar module_exports = {\n    \"System\": System,\n    \"VbrMode\": VbrMode,\n    \"Float\": Float,\n    \"ShortBlock\": ShortBlock,\n    \"Util\": Util,\n    \"Arrays\": Arrays,\n    \"new_array_n\": new_array_n,\n    \"new_byte\": new_byte,\n    \"new_double\": new_double,\n    \"new_float\": new_float,\n    \"new_float_n\": new_float_n,\n    \"new_int\": new_int,\n    \"new_int_n\": new_int_n,\n    \"new_short\": new_short,\n    \"new_short_n\": new_short_n,\n    \"assert\": assert\n};\n//package mp3;\n\n/* MPEG modes */\nfunction MPEGMode(ordinal) {\n    var _ordinal = ordinal;\n    this.ordinal = function () {\n        return _ordinal;\n    }\n}\n\nMPEGMode.STEREO = new MPEGMode(0);\nMPEGMode.JOINT_STEREO = new MPEGMode(1);\nMPEGMode.DUAL_CHANNEL = new MPEGMode(2);\nMPEGMode.MONO = new MPEGMode(3);\nMPEGMode.NOT_SET = new MPEGMode(4);\n\nfunction Version() {\n\n    /**\n     * URL for the LAME website.\n     */\n    var LAME_URL = \"http://www.mp3dev.org/\";\n\n    /**\n     * Major version number.\n     */\n    var LAME_MAJOR_VERSION = 3;\n    /**\n     * Minor version number.\n     */\n    var LAME_MINOR_VERSION = 98;\n    /**\n     * Patch level.\n     */\n    var LAME_PATCH_VERSION = 4;\n\n    /**\n     * Major version number.\n     */\n    var PSY_MAJOR_VERSION = 0;\n    /**\n     * Minor version number.\n     */\n    var PSY_MINOR_VERSION = 93;\n\n    /**\n     * A string which describes the version of LAME.\n     *\n     * @return string which describes the version of LAME\n     */\n    this.getLameVersion = function () {\n        // primary to write screen reports\n        return (LAME_MAJOR_VERSION + \".\" + LAME_MINOR_VERSION + \".\" + LAME_PATCH_VERSION);\n    }\n\n    /**\n     * The short version of the LAME version string.\n     *\n     * @return short version of the LAME version string\n     */\n    this.getLameShortVersion = function () {\n        // Adding date and time to version string makes it harder for output\n        // validation\n        return (LAME_MAJOR_VERSION + \".\" + LAME_MINOR_VERSION + \".\" + LAME_PATCH_VERSION);\n    }\n\n    /**\n     * The shortest version of the LAME version string.\n     *\n     * @return shortest version of the LAME version string\n     */\n    this.getLameVeryShortVersion = function () {\n        // Adding date and time to version string makes it harder for output\n        return (\"LAME\" + LAME_MAJOR_VERSION + \".\" + LAME_MINOR_VERSION + \"r\");\n    }\n\n    /**\n     * String which describes the version of GPSYCHO\n     *\n     * @return string which describes the version of GPSYCHO\n     */\n    this.getPsyVersion = function () {\n        return (PSY_MAJOR_VERSION + \".\" + PSY_MINOR_VERSION);\n    }\n\n    /**\n     * String which is a URL for the LAME website.\n     *\n     * @return string which is a URL for the LAME website\n     */\n    this.getLameUrl = function () {\n        return LAME_URL;\n    }\n\n    /**\n     * Quite useless for a java version, however we are compatible ;-)\n     *\n     * @return \"32bits\"\n     */\n    this.getLameOsBitness = function () {\n        return \"32bits\";\n    }\n\n}\n\n/*\n *\tMP3 huffman table selecting and bit counting\n *\n *\tCopyright (c) 1999-2005 Takehiro TOMINAGA\n *\tCopyright (c) 2002-2005 Gabriel Bouvigne\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\t See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n\n/* $Id: Takehiro.java,v 1.26 2011/05/24 20:48:06 kenchis Exp $ */\n\n//package mp3;\n\n//import java.util.Arrays;\n\n\n\nfunction Takehiro() {\n\n    var qupvt = null;\n    this.qupvt = null;\n\n    this.setModules = function (_qupvt) {\n        this.qupvt = _qupvt;\n        qupvt = _qupvt;\n    }\n\n    function Bits(b) {\n        this.bits = 0 | b;\n    }\n\n    var subdv_table = [[0, 0], /* 0 bands */\n        [0, 0], /* 1 bands */\n        [0, 0], /* 2 bands */\n        [0, 0], /* 3 bands */\n        [0, 0], /* 4 bands */\n        [0, 1], /* 5 bands */\n        [1, 1], /* 6 bands */\n        [1, 1], /* 7 bands */\n        [1, 2], /* 8 bands */\n        [2, 2], /* 9 bands */\n        [2, 3], /* 10 bands */\n        [2, 3], /* 11 bands */\n        [3, 4], /* 12 bands */\n        [3, 4], /* 13 bands */\n        [3, 4], /* 14 bands */\n        [4, 5], /* 15 bands */\n        [4, 5], /* 16 bands */\n        [4, 6], /* 17 bands */\n        [5, 6], /* 18 bands */\n        [5, 6], /* 19 bands */\n        [5, 7], /* 20 bands */\n        [6, 7], /* 21 bands */\n        [6, 7], /* 22 bands */\n    ];\n\n\n    /**\n     * nonlinear quantization of xr More accurate formula than the ISO formula.\n     * Takes into account the fact that we are quantizing xr . ix, but we want\n     * ix^4/3 to be as close as possible to x^4/3. (taking the nearest int would\n     * mean ix is as close as possible to xr, which is different.)\n     *\n     * From Segher Boessenkool <segher@eastsite.nl> 11/1999\n     *\n     * 09/2000: ASM code removed in favor of IEEE754 hack by Takehiro Tominaga.\n     * If you need the ASM code, check CVS circa Aug 2000.\n     *\n     * 01/2004: Optimizations by Gabriel Bouvigne\n     */\n    function quantize_lines_xrpow_01(l, istep, xr, xrPos, ix, ixPos) {\n        var compareval0 = (1.0 - 0.4054) / istep;\n\n        l = l >> 1;\n        while ((l--) != 0) {\n            ix[ixPos++] = (compareval0 > xr[xrPos++]) ? 0 : 1;\n            ix[ixPos++] = (compareval0 > xr[xrPos++]) ? 0 : 1;\n        }\n    }\n\n    /**\n     * XRPOW_FTOI is a macro to convert floats to ints.<BR>\n     * if XRPOW_FTOI(x) = nearest_int(x), then QUANTFAC(x)=adj43asm[x]<BR>\n     * ROUNDFAC= -0.0946<BR>\n     *\n     * if XRPOW_FTOI(x) = floor(x), then QUANTFAC(x)=asj43[x]<BR>\n     * ROUNDFAC=0.4054<BR>\n     *\n     * Note: using floor() or 0| is extremely slow. On machines where the\n     * TAKEHIRO_IEEE754_HACK code above does not work, it is worthwile to write\n     * some ASM for XRPOW_FTOI().\n     */\n    function quantize_lines_xrpow(l, istep, xr, xrPos, ix, ixPos) {\n\n        l = l >> 1;\n        var remaining = l % 2;\n        l = l >> 1;\n        while (l-- != 0) {\n            var x0, x1, x2, x3;\n            var rx0, rx1, rx2, rx3;\n\n            x0 = xr[xrPos++] * istep;\n            x1 = xr[xrPos++] * istep;\n            rx0 = 0 | x0;\n            x2 = xr[xrPos++] * istep;\n            rx1 = 0 | x1;\n            x3 = xr[xrPos++] * istep;\n            rx2 = 0 | x2;\n            x0 += qupvt.adj43[rx0];\n            rx3 = 0 | x3;\n            x1 += qupvt.adj43[rx1];\n            ix[ixPos++] = 0 | x0;\n            x2 += qupvt.adj43[rx2];\n            ix[ixPos++] = 0 | x1;\n            x3 += qupvt.adj43[rx3];\n            ix[ixPos++] = 0 | x2;\n            ix[ixPos++] = 0 | x3;\n        }\n        if (remaining != 0) {\n            var x0, x1;\n            var rx0, rx1;\n\n            x0 = xr[xrPos++] * istep;\n            x1 = xr[xrPos++] * istep;\n            rx0 = 0 | x0;\n            rx1 = 0 | x1;\n            x0 += qupvt.adj43[rx0];\n            x1 += qupvt.adj43[rx1];\n            ix[ixPos++] = 0 | x0;\n            ix[ixPos++] = 0 | x1;\n        }\n    }\n\n    /**\n     * Quantization function This function will select which lines to quantize\n     * and call the proper quantization function\n     */\n    function quantize_xrpow(xp, pi, istep, codInfo, prevNoise) {\n        /* quantize on xr^(3/4) instead of xr */\n        var sfb;\n        var sfbmax;\n        var j = 0;\n        var prev_data_use;\n        var accumulate = 0;\n        var accumulate01 = 0;\n        var xpPos = 0;\n        var iData = pi;\n        var iDataPos = 0;\n        var acc_iData = iData;\n        var acc_iDataPos = 0;\n        var acc_xp = xp;\n        var acc_xpPos = 0;\n\n        /*\n         * Reusing previously computed data does not seems to work if global\n         * gain is changed. Finding why it behaves this way would allow to use a\n         * cache of previously computed values (let's 10 cached values per sfb)\n         * that would probably provide a noticeable speedup\n         */\n        prev_data_use = (prevNoise != null && (codInfo.global_gain == prevNoise.global_gain));\n\n        if (codInfo.block_type == Encoder.SHORT_TYPE)\n            sfbmax = 38;\n        else\n            sfbmax = 21;\n\n        for (sfb = 0; sfb <= sfbmax; sfb++) {\n            var step = -1;\n\n            if (prev_data_use || codInfo.block_type == Encoder.NORM_TYPE) {\n                step = codInfo.global_gain\n                    - ((codInfo.scalefac[sfb] + (codInfo.preflag != 0 ? qupvt.pretab[sfb]\n                        : 0)) << (codInfo.scalefac_scale + 1))\n                    - codInfo.subblock_gain[codInfo.window[sfb]] * 8;\n            }\n            if (prev_data_use && (prevNoise.step[sfb] == step)) {\n                /*\n                 * do not recompute this part, but compute accumulated lines\n                 */\n                if (accumulate != 0) {\n                    quantize_lines_xrpow(accumulate, istep, acc_xp, acc_xpPos,\n                        acc_iData, acc_iDataPos);\n                    accumulate = 0;\n                }\n                if (accumulate01 != 0) {\n                    quantize_lines_xrpow_01(accumulate01, istep, acc_xp,\n                        acc_xpPos, acc_iData, acc_iDataPos);\n                    accumulate01 = 0;\n                }\n            } else { /* should compute this part */\n                var l = codInfo.width[sfb];\n\n                if ((j + codInfo.width[sfb]) > codInfo.max_nonzero_coeff) {\n                    /* do not compute upper zero part */\n                    var usefullsize;\n                    usefullsize = codInfo.max_nonzero_coeff - j + 1;\n                    Arrays.fill(pi, codInfo.max_nonzero_coeff, 576, 0);\n                    l = usefullsize;\n\n                    if (l < 0) {\n                        l = 0;\n                    }\n\n                    /* no need to compute higher sfb values */\n                    sfb = sfbmax + 1;\n                }\n\n                /* accumulate lines to quantize */\n                if (0 == accumulate && 0 == accumulate01) {\n                    acc_iData = iData;\n                    acc_iDataPos = iDataPos;\n                    acc_xp = xp;\n                    acc_xpPos = xpPos;\n                }\n                if (prevNoise != null && prevNoise.sfb_count1 > 0\n                    && sfb >= prevNoise.sfb_count1\n                    && prevNoise.step[sfb] > 0\n                    && step >= prevNoise.step[sfb]) {\n\n                    if (accumulate != 0) {\n                        quantize_lines_xrpow(accumulate, istep, acc_xp,\n                            acc_xpPos, acc_iData, acc_iDataPos);\n                        accumulate = 0;\n                        acc_iData = iData;\n                        acc_iDataPos = iDataPos;\n                        acc_xp = xp;\n                        acc_xpPos = xpPos;\n                    }\n                    accumulate01 += l;\n                } else {\n                    if (accumulate01 != 0) {\n                        quantize_lines_xrpow_01(accumulate01, istep, acc_xp,\n                            acc_xpPos, acc_iData, acc_iDataPos);\n                        accumulate01 = 0;\n                        acc_iData = iData;\n                        acc_iDataPos = iDataPos;\n                        acc_xp = xp;\n                        acc_xpPos = xpPos;\n                    }\n                    accumulate += l;\n                }\n\n                if (l <= 0) {\n                    /*\n                     * rh: 20040215 may happen due to \"prev_data_use\"\n                     * optimization\n                     */\n                    if (accumulate01 != 0) {\n                        quantize_lines_xrpow_01(accumulate01, istep, acc_xp,\n                            acc_xpPos, acc_iData, acc_iDataPos);\n                        accumulate01 = 0;\n                    }\n                    if (accumulate != 0) {\n                        quantize_lines_xrpow(accumulate, istep, acc_xp,\n                            acc_xpPos, acc_iData, acc_iDataPos);\n                        accumulate = 0;\n                    }\n\n                    break;\n                    /* ends for-loop */\n                }\n            }\n            if (sfb <= sfbmax) {\n                iDataPos += codInfo.width[sfb];\n                xpPos += codInfo.width[sfb];\n                j += codInfo.width[sfb];\n            }\n        }\n        if (accumulate != 0) { /* last data part */\n            quantize_lines_xrpow(accumulate, istep, acc_xp, acc_xpPos,\n                acc_iData, acc_iDataPos);\n            accumulate = 0;\n        }\n        if (accumulate01 != 0) { /* last data part */\n            quantize_lines_xrpow_01(accumulate01, istep, acc_xp, acc_xpPos,\n                acc_iData, acc_iDataPos);\n            accumulate01 = 0;\n        }\n\n    }\n\n    /**\n     * ix_max\n     */\n    function ix_max(ix, ixPos, endPos) {\n        var max1 = 0, max2 = 0;\n\n        do {\n            var x1 = ix[ixPos++];\n            var x2 = ix[ixPos++];\n            if (max1 < x1)\n                max1 = x1;\n\n            if (max2 < x2)\n                max2 = x2;\n        } while (ixPos < endPos);\n        if (max1 < max2)\n            max1 = max2;\n        return max1;\n    }\n\n    function count_bit_ESC(ix, ixPos, end, t1, t2, s) {\n        /* ESC-table is used */\n        var linbits = Tables.ht[t1].xlen * 65536 + Tables.ht[t2].xlen;\n        var sum = 0, sum2;\n\n        do {\n            var x = ix[ixPos++];\n            var y = ix[ixPos++];\n\n            if (x != 0) {\n                if (x > 14) {\n                    x = 15;\n                    sum += linbits;\n                }\n                x *= 16;\n            }\n\n            if (y != 0) {\n                if (y > 14) {\n                    y = 15;\n                    sum += linbits;\n                }\n                x += y;\n            }\n\n            sum += Tables.largetbl[x];\n        } while (ixPos < end);\n\n        sum2 = sum & 0xffff;\n        sum >>= 16;\n\n        if (sum > sum2) {\n            sum = sum2;\n            t1 = t2;\n        }\n\n        s.bits += sum;\n        return t1;\n    }\n\n    function count_bit_noESC(ix, ixPos, end, s) {\n        /* No ESC-words */\n        var sum1 = 0;\n        var hlen1 = Tables.ht[1].hlen;\n\n        do {\n            var x = ix[ixPos + 0] * 2 + ix[ixPos + 1];\n            ixPos += 2;\n            sum1 += hlen1[x];\n        } while (ixPos < end);\n\n        s.bits += sum1;\n        return 1;\n    }\n\n    function count_bit_noESC_from2(ix, ixPos, end, t1, s) {\n        /* No ESC-words */\n        var sum = 0, sum2;\n        var xlen = Tables.ht[t1].xlen;\n        var hlen;\n        if (t1 == 2)\n            hlen = Tables.table23;\n        else\n            hlen = Tables.table56;\n\n        do {\n            var x = ix[ixPos + 0] * xlen + ix[ixPos + 1];\n            ixPos += 2;\n            sum += hlen[x];\n        } while (ixPos < end);\n\n        sum2 = sum & 0xffff;\n        sum >>= 16;\n\n        if (sum > sum2) {\n            sum = sum2;\n            t1++;\n        }\n\n        s.bits += sum;\n        return t1;\n    }\n\n    function count_bit_noESC_from3(ix, ixPos, end, t1, s) {\n        /* No ESC-words */\n        var sum1 = 0;\n        var sum2 = 0;\n        var sum3 = 0;\n        var xlen = Tables.ht[t1].xlen;\n        var hlen1 = Tables.ht[t1].hlen;\n        var hlen2 = Tables.ht[t1 + 1].hlen;\n        var hlen3 = Tables.ht[t1 + 2].hlen;\n\n        do {\n            var x = ix[ixPos + 0] * xlen + ix[ixPos + 1];\n            ixPos += 2;\n            sum1 += hlen1[x];\n            sum2 += hlen2[x];\n            sum3 += hlen3[x];\n        } while (ixPos < end);\n        var t = t1;\n        if (sum1 > sum2) {\n            sum1 = sum2;\n            t++;\n        }\n        if (sum1 > sum3) {\n            sum1 = sum3;\n            t = t1 + 2;\n        }\n        s.bits += sum1;\n\n        return t;\n    }\n\n    /*************************************************************************/\n    /* choose table */\n    /*************************************************************************/\n\n    var huf_tbl_noESC = [1, 2, 5, 7, 7, 10, 10, 13, 13,\n        13, 13, 13, 13, 13, 13];\n\n    /**\n     * Choose the Huffman table that will encode ix[begin..end] with the fewest\n     * bits.\n     *\n     * Note: This code contains knowledge about the sizes and characteristics of\n     * the Huffman tables as defined in the IS (Table B.7), and will not work\n     * with any arbitrary tables.\n     */\n    function choose_table(ix, ixPos, endPos, s) {\n        var max = ix_max(ix, ixPos, endPos);\n\n        switch (max) {\n            case 0:\n                return max;\n\n            case 1:\n                return count_bit_noESC(ix, ixPos, endPos, s);\n\n            case 2:\n            case 3:\n                return count_bit_noESC_from2(ix, ixPos, endPos,\n                    huf_tbl_noESC[max - 1], s);\n\n            case 4:\n            case 5:\n            case 6:\n            case 7:\n            case 8:\n            case 9:\n            case 10:\n            case 11:\n            case 12:\n            case 13:\n            case 14:\n            case 15:\n                return count_bit_noESC_from3(ix, ixPos, endPos,\n                    huf_tbl_noESC[max - 1], s);\n\n            default:\n                /* try tables with linbits */\n                if (max > QuantizePVT.IXMAX_VAL) {\n                    s.bits = QuantizePVT.LARGE_BITS;\n                    return -1;\n                }\n                max -= 15;\n                var choice2;\n                for (choice2 = 24; choice2 < 32; choice2++) {\n                    if (Tables.ht[choice2].linmax >= max) {\n                        break;\n                    }\n                }\n                var choice;\n                for (choice = choice2 - 8; choice < 24; choice++) {\n                    if (Tables.ht[choice].linmax >= max) {\n                        break;\n                    }\n                }\n                return count_bit_ESC(ix, ixPos, endPos, choice, choice2, s);\n        }\n    }\n\n    /**\n     * count_bit\n     */\n    this.noquant_count_bits = function (gfc, gi, prev_noise) {\n        var ix = gi.l3_enc;\n        var i = Math.min(576, ((gi.max_nonzero_coeff + 2) >> 1) << 1);\n\n        if (prev_noise != null)\n            prev_noise.sfb_count1 = 0;\n\n        /* Determine count1 region */\n        for (; i > 1; i -= 2)\n            if ((ix[i - 1] | ix[i - 2]) != 0)\n                break;\n        gi.count1 = i;\n\n        /* Determines the number of bits to encode the quadruples. */\n        var a1 = 0;\n        var a2 = 0;\n        for (; i > 3; i -= 4) {\n            var p;\n            /* hack to check if all values <= 1 */\n            //throw \"TODO: HACK         if ((((long) ix[i - 1] | (long) ix[i - 2] | (long) ix[i - 3] | (long) ix[i - 4]) & 0xffffffffL) > 1L        \"\n            //if (true) {\n            if (((ix[i - 1] | ix[i - 2] | ix[i - 3] | ix[i - 4]) & 0x7fffffff) > 1) {\n                break;\n            }\n            p = ((ix[i - 4] * 2 + ix[i - 3]) * 2 + ix[i - 2]) * 2 + ix[i - 1];\n            a1 += Tables.t32l[p];\n            a2 += Tables.t33l[p];\n        }\n        var bits = a1;\n        gi.count1table_select = 0;\n        if (a1 > a2) {\n            bits = a2;\n            gi.count1table_select = 1;\n        }\n\n        gi.count1bits = bits;\n        gi.big_values = i;\n        if (i == 0)\n            return bits;\n\n        if (gi.block_type == Encoder.SHORT_TYPE) {\n            a1 = 3 * gfc.scalefac_band.s[3];\n            if (a1 > gi.big_values)\n                a1 = gi.big_values;\n            a2 = gi.big_values;\n\n        } else if (gi.block_type == Encoder.NORM_TYPE) {\n            /* bv_scf has 576 entries (0..575) */\n            a1 = gi.region0_count = gfc.bv_scf[i - 2];\n            a2 = gi.region1_count = gfc.bv_scf[i - 1];\n\n            a2 = gfc.scalefac_band.l[a1 + a2 + 2];\n            a1 = gfc.scalefac_band.l[a1 + 1];\n            if (a2 < i) {\n                var bi = new Bits(bits);\n                gi.table_select[2] = choose_table(ix, a2, i, bi);\n                bits = bi.bits;\n            }\n        } else {\n            gi.region0_count = 7;\n            /* gi.region1_count = SBPSY_l - 7 - 1; */\n            gi.region1_count = Encoder.SBMAX_l - 1 - 7 - 1;\n            a1 = gfc.scalefac_band.l[7 + 1];\n            a2 = i;\n            if (a1 > a2) {\n                a1 = a2;\n            }\n        }\n\n        /* have to allow for the case when bigvalues < region0 < region1 */\n        /* (and region0, region1 are ignored) */\n        a1 = Math.min(a1, i);\n        a2 = Math.min(a2, i);\n\n\n        /* Count the number of bits necessary to code the bigvalues region. */\n        if (0 < a1) {\n            var bi = new Bits(bits);\n            gi.table_select[0] = choose_table(ix, 0, a1, bi);\n            bits = bi.bits;\n        }\n        if (a1 < a2) {\n            var bi = new Bits(bits);\n            gi.table_select[1] = choose_table(ix, a1, a2, bi);\n            bits = bi.bits;\n        }\n        if (gfc.use_best_huffman == 2) {\n            gi.part2_3_length = bits;\n            best_huffman_divide(gfc, gi);\n            bits = gi.part2_3_length;\n        }\n\n        if (prev_noise != null) {\n            if (gi.block_type == Encoder.NORM_TYPE) {\n                var sfb = 0;\n                while (gfc.scalefac_band.l[sfb] < gi.big_values) {\n                    sfb++;\n                }\n                prev_noise.sfb_count1 = sfb;\n            }\n        }\n\n        return bits;\n    }\n\n    this.count_bits = function (gfc, xr, gi, prev_noise) {\n        var ix = gi.l3_enc;\n\n        /* since quantize_xrpow uses table lookup, we need to check this first: */\n        var w = (QuantizePVT.IXMAX_VAL) / qupvt.IPOW20(gi.global_gain);\n\n        if (gi.xrpow_max > w)\n            return QuantizePVT.LARGE_BITS;\n\n        quantize_xrpow(xr, ix, qupvt.IPOW20(gi.global_gain), gi, prev_noise);\n\n        if ((gfc.substep_shaping & 2) != 0) {\n            var j = 0;\n            /* 0.634521682242439 = 0.5946*2**(.5*0.1875) */\n            var gain = gi.global_gain + gi.scalefac_scale;\n            var roundfac = 0.634521682242439 / qupvt.IPOW20(gain);\n            for (var sfb = 0; sfb < gi.sfbmax; sfb++) {\n                var width = gi.width[sfb];\n                if (0 == gfc.pseudohalf[sfb]) {\n                    j += width;\n                } else {\n                    var k;\n                    for (k = j, j += width; k < j; ++k) {\n                        ix[k] = (xr[k] >= roundfac) ? ix[k] : 0;\n                    }\n                }\n            }\n        }\n        return this.noquant_count_bits(gfc, gi, prev_noise);\n    }\n\n    /**\n     * re-calculate the best scalefac_compress using scfsi the saved bits are\n     * kept in the bit reservoir.\n     */\n    function recalc_divide_init(gfc, cod_info, ix, r01_bits, r01_div, r0_tbl, r1_tbl) {\n        var bigv = cod_info.big_values;\n\n        for (var r0 = 0; r0 <= 7 + 15; r0++) {\n            r01_bits[r0] = QuantizePVT.LARGE_BITS;\n        }\n\n        for (var r0 = 0; r0 < 16; r0++) {\n            var a1 = gfc.scalefac_band.l[r0 + 1];\n            if (a1 >= bigv)\n                break;\n            var r0bits = 0;\n            var bi = new Bits(r0bits);\n            var r0t = choose_table(ix, 0, a1, bi);\n            r0bits = bi.bits;\n\n            for (var r1 = 0; r1 < 8; r1++) {\n                var a2 = gfc.scalefac_band.l[r0 + r1 + 2];\n                if (a2 >= bigv)\n                    break;\n                var bits = r0bits;\n                bi = new Bits(bits);\n                var r1t = choose_table(ix, a1, a2, bi);\n                bits = bi.bits;\n                if (r01_bits[r0 + r1] > bits) {\n                    r01_bits[r0 + r1] = bits;\n                    r01_div[r0 + r1] = r0;\n                    r0_tbl[r0 + r1] = r0t;\n                    r1_tbl[r0 + r1] = r1t;\n                }\n            }\n        }\n    }\n\n    function recalc_divide_sub(gfc, cod_info2, gi, ix, r01_bits, r01_div, r0_tbl, r1_tbl) {\n        var bigv = cod_info2.big_values;\n\n        for (var r2 = 2; r2 < Encoder.SBMAX_l + 1; r2++) {\n            var a2 = gfc.scalefac_band.l[r2];\n            if (a2 >= bigv)\n                break;\n            var bits = r01_bits[r2 - 2] + cod_info2.count1bits;\n            if (gi.part2_3_length <= bits)\n                break;\n\n            var bi = new Bits(bits);\n            var r2t = choose_table(ix, a2, bigv, bi);\n            bits = bi.bits;\n            if (gi.part2_3_length <= bits)\n                continue;\n\n            gi.assign(cod_info2);\n            gi.part2_3_length = bits;\n            gi.region0_count = r01_div[r2 - 2];\n            gi.region1_count = r2 - 2 - r01_div[r2 - 2];\n            gi.table_select[0] = r0_tbl[r2 - 2];\n            gi.table_select[1] = r1_tbl[r2 - 2];\n            gi.table_select[2] = r2t;\n        }\n    }\n\n    this.best_huffman_divide = function (gfc, gi) {\n        var cod_info2 = new GrInfo();\n        var ix = gi.l3_enc;\n        var r01_bits = new_int(7 + 15 + 1);\n        var r01_div = new_int(7 + 15 + 1);\n        var r0_tbl = new_int(7 + 15 + 1);\n        var r1_tbl = new_int(7 + 15 + 1);\n\n        /* SHORT BLOCK stuff fails for MPEG2 */\n        if (gi.block_type == Encoder.SHORT_TYPE && gfc.mode_gr == 1)\n            return;\n\n        cod_info2.assign(gi);\n        if (gi.block_type == Encoder.NORM_TYPE) {\n            recalc_divide_init(gfc, gi, ix, r01_bits, r01_div, r0_tbl, r1_tbl);\n            recalc_divide_sub(gfc, cod_info2, gi, ix, r01_bits, r01_div,\n                r0_tbl, r1_tbl);\n        }\n        var i = cod_info2.big_values;\n        if (i == 0 || (ix[i - 2] | ix[i - 1]) > 1)\n            return;\n\n        i = gi.count1 + 2;\n        if (i > 576)\n            return;\n\n        /* Determines the number of bits to encode the quadruples. */\n        cod_info2.assign(gi);\n        cod_info2.count1 = i;\n        var a1 = 0;\n        var a2 = 0;\n\n\n        for (; i > cod_info2.big_values; i -= 4) {\n            var p = ((ix[i - 4] * 2 + ix[i - 3]) * 2 + ix[i - 2]) * 2\n                + ix[i - 1];\n            a1 += Tables.t32l[p];\n            a2 += Tables.t33l[p];\n        }\n        cod_info2.big_values = i;\n\n        cod_info2.count1table_select = 0;\n        if (a1 > a2) {\n            a1 = a2;\n            cod_info2.count1table_select = 1;\n        }\n\n        cod_info2.count1bits = a1;\n\n        if (cod_info2.block_type == Encoder.NORM_TYPE)\n            recalc_divide_sub(gfc, cod_info2, gi, ix, r01_bits, r01_div,\n                r0_tbl, r1_tbl);\n        else {\n            /* Count the number of bits necessary to code the bigvalues region. */\n            cod_info2.part2_3_length = a1;\n            a1 = gfc.scalefac_band.l[7 + 1];\n            if (a1 > i) {\n                a1 = i;\n            }\n            if (a1 > 0) {\n                var bi = new Bits(cod_info2.part2_3_length);\n                cod_info2.table_select[0] = choose_table(ix, 0, a1, bi);\n                cod_info2.part2_3_length = bi.bits;\n            }\n            if (i > a1) {\n                var bi = new Bits(cod_info2.part2_3_length);\n                cod_info2.table_select[1] = choose_table(ix, a1, i, bi);\n                cod_info2.part2_3_length = bi.bits;\n            }\n            if (gi.part2_3_length > cod_info2.part2_3_length)\n                gi.assign(cod_info2);\n        }\n    }\n\n    var slen1_n = [1, 1, 1, 1, 8, 2, 2, 2, 4, 4, 4, 8, 8, 8, 16, 16];\n    var slen2_n = [1, 2, 4, 8, 1, 2, 4, 8, 2, 4, 8, 2, 4, 8, 4, 8];\n    var slen1_tab = [0, 0, 0, 0, 3, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4];\n    var slen2_tab = [0, 1, 2, 3, 0, 1, 2, 3, 1, 2, 3, 1, 2, 3, 2, 3];\n    Takehiro.slen1_tab = slen1_tab;\n    Takehiro.slen2_tab = slen2_tab;\n\n    function scfsi_calc(ch, l3_side) {\n        var sfb;\n        var gi = l3_side.tt[1][ch];\n        var g0 = l3_side.tt[0][ch];\n\n        for (var i = 0; i < Tables.scfsi_band.length - 1; i++) {\n            for (sfb = Tables.scfsi_band[i]; sfb < Tables.scfsi_band[i + 1]; sfb++) {\n                if (g0.scalefac[sfb] != gi.scalefac[sfb]\n                    && gi.scalefac[sfb] >= 0)\n                    break;\n            }\n            if (sfb == Tables.scfsi_band[i + 1]) {\n                for (sfb = Tables.scfsi_band[i]; sfb < Tables.scfsi_band[i + 1]; sfb++) {\n                    gi.scalefac[sfb] = -1;\n                }\n                l3_side.scfsi[ch][i] = 1;\n            }\n        }\n        var s1 = 0;\n        var c1 = 0;\n        for (sfb = 0; sfb < 11; sfb++) {\n            if (gi.scalefac[sfb] == -1)\n                continue;\n            c1++;\n            if (s1 < gi.scalefac[sfb])\n                s1 = gi.scalefac[sfb];\n        }\n        var s2 = 0;\n        var c2 = 0;\n        for (; sfb < Encoder.SBPSY_l; sfb++) {\n            if (gi.scalefac[sfb] == -1)\n                continue;\n            c2++;\n            if (s2 < gi.scalefac[sfb])\n                s2 = gi.scalefac[sfb];\n        }\n\n        for (var i = 0; i < 16; i++) {\n            if (s1 < slen1_n[i] && s2 < slen2_n[i]) {\n                var c = slen1_tab[i] * c1 + slen2_tab[i] * c2;\n                if (gi.part2_length > c) {\n                    gi.part2_length = c;\n                    gi.scalefac_compress = i;\n                }\n            }\n        }\n    }\n\n    /**\n     * Find the optimal way to store the scalefactors. Only call this routine\n     * after final scalefactors have been chosen and the channel/granule will\n     * not be re-encoded.\n     */\n    this.best_scalefac_store = function (gfc, gr, ch, l3_side) {\n        /* use scalefac_scale if we can */\n        var gi = l3_side.tt[gr][ch];\n        var sfb, i, j, l;\n        var recalc = 0;\n\n        /*\n         * remove scalefacs from bands with ix=0. This idea comes from the AAC\n         * ISO docs. added mt 3/00\n         */\n        /* check if l3_enc=0 */\n        j = 0;\n        for (sfb = 0; sfb < gi.sfbmax; sfb++) {\n            var width = gi.width[sfb];\n            j += width;\n            for (l = -width; l < 0; l++) {\n                if (gi.l3_enc[l + j] != 0)\n                    break;\n            }\n            if (l == 0)\n                gi.scalefac[sfb] = recalc = -2;\n            /* anything goes. */\n            /*\n             * only best_scalefac_store and calc_scfsi know--and only they\n             * should know--about the magic number -2.\n             */\n        }\n\n        if (0 == gi.scalefac_scale && 0 == gi.preflag) {\n            var s = 0;\n            for (sfb = 0; sfb < gi.sfbmax; sfb++)\n                if (gi.scalefac[sfb] > 0)\n                    s |= gi.scalefac[sfb];\n\n            if (0 == (s & 1) && s != 0) {\n                for (sfb = 0; sfb < gi.sfbmax; sfb++)\n                    if (gi.scalefac[sfb] > 0)\n                        gi.scalefac[sfb] >>= 1;\n\n                gi.scalefac_scale = recalc = 1;\n            }\n        }\n\n        if (0 == gi.preflag && gi.block_type != Encoder.SHORT_TYPE\n            && gfc.mode_gr == 2) {\n            for (sfb = 11; sfb < Encoder.SBPSY_l; sfb++)\n                if (gi.scalefac[sfb] < qupvt.pretab[sfb]\n                    && gi.scalefac[sfb] != -2)\n                    break;\n            if (sfb == Encoder.SBPSY_l) {\n                for (sfb = 11; sfb < Encoder.SBPSY_l; sfb++)\n                    if (gi.scalefac[sfb] > 0)\n                        gi.scalefac[sfb] -= qupvt.pretab[sfb];\n\n                gi.preflag = recalc = 1;\n            }\n        }\n\n        for (i = 0; i < 4; i++)\n            l3_side.scfsi[ch][i] = 0;\n\n        if (gfc.mode_gr == 2 && gr == 1\n            && l3_side.tt[0][ch].block_type != Encoder.SHORT_TYPE\n            && l3_side.tt[1][ch].block_type != Encoder.SHORT_TYPE) {\n            scfsi_calc(ch, l3_side);\n            recalc = 0;\n        }\n        for (sfb = 0; sfb < gi.sfbmax; sfb++) {\n            if (gi.scalefac[sfb] == -2) {\n                gi.scalefac[sfb] = 0;\n                /* if anything goes, then 0 is a good choice */\n            }\n        }\n        if (recalc != 0) {\n            if (gfc.mode_gr == 2) {\n                this.scale_bitcount(gi);\n            } else {\n                this.scale_bitcount_lsf(gfc, gi);\n            }\n        }\n    }\n\n    function all_scalefactors_not_negative(scalefac, n) {\n        for (var i = 0; i < n; ++i) {\n            if (scalefac[i] < 0)\n                return false;\n        }\n        return true;\n    }\n\n    /**\n     * number of bits used to encode scalefacs.\n     *\n     * 18*slen1_tab[i] + 18*slen2_tab[i]\n     */\n    var scale_short = [0, 18, 36, 54, 54, 36, 54, 72,\n        54, 72, 90, 72, 90, 108, 108, 126];\n\n    /**\n     * number of bits used to encode scalefacs.\n     *\n     * 17*slen1_tab[i] + 18*slen2_tab[i]\n     */\n    var scale_mixed = [0, 18, 36, 54, 51, 35, 53, 71,\n        52, 70, 88, 69, 87, 105, 104, 122];\n\n    /**\n     * number of bits used to encode scalefacs.\n     *\n     * 11*slen1_tab[i] + 10*slen2_tab[i]\n     */\n    var scale_long = [0, 10, 20, 30, 33, 21, 31, 41, 32, 42,\n        52, 43, 53, 63, 64, 74];\n\n    /**\n     * Also calculates the number of bits necessary to code the scalefactors.\n     */\n    this.scale_bitcount = function (cod_info) {\n        var k, sfb, max_slen1 = 0, max_slen2 = 0;\n\n        /* maximum values */\n        var tab;\n        var scalefac = cod_info.scalefac;\n\n\n        if (cod_info.block_type == Encoder.SHORT_TYPE) {\n            tab = scale_short;\n            if (cod_info.mixed_block_flag != 0)\n                tab = scale_mixed;\n        } else { /* block_type == 1,2,or 3 */\n            tab = scale_long;\n            if (0 == cod_info.preflag) {\n                for (sfb = 11; sfb < Encoder.SBPSY_l; sfb++)\n                    if (scalefac[sfb] < qupvt.pretab[sfb])\n                        break;\n\n                if (sfb == Encoder.SBPSY_l) {\n                    cod_info.preflag = 1;\n                    for (sfb = 11; sfb < Encoder.SBPSY_l; sfb++)\n                        scalefac[sfb] -= qupvt.pretab[sfb];\n                }\n            }\n        }\n\n        for (sfb = 0; sfb < cod_info.sfbdivide; sfb++)\n            if (max_slen1 < scalefac[sfb])\n                max_slen1 = scalefac[sfb];\n\n        for (; sfb < cod_info.sfbmax; sfb++)\n            if (max_slen2 < scalefac[sfb])\n                max_slen2 = scalefac[sfb];\n\n        /*\n         * from Takehiro TOMINAGA <tominaga@isoternet.org> 10/99 loop over *all*\n         * posible values of scalefac_compress to find the one which uses the\n         * smallest number of bits. ISO would stop at first valid index\n         */\n        cod_info.part2_length = QuantizePVT.LARGE_BITS;\n        for (k = 0; k < 16; k++) {\n            if (max_slen1 < slen1_n[k] && max_slen2 < slen2_n[k]\n                && cod_info.part2_length > tab[k]) {\n                cod_info.part2_length = tab[k];\n                cod_info.scalefac_compress = k;\n            }\n        }\n        return cod_info.part2_length == QuantizePVT.LARGE_BITS;\n    }\n\n    /**\n     * table of largest scalefactor values for MPEG2\n     */\n    var max_range_sfac_tab = [[15, 15, 7, 7],\n        [15, 15, 7, 0], [7, 3, 0, 0], [15, 31, 31, 0],\n        [7, 7, 7, 0], [3, 3, 0, 0]];\n\n    /**\n     * Also counts the number of bits to encode the scalefacs but for MPEG 2\n     * Lower sampling frequencies (24, 22.05 and 16 kHz.)\n     *\n     * This is reverse-engineered from section 2.4.3.2 of the MPEG2 IS,\n     * \"Audio Decoding Layer III\"\n     */\n    this.scale_bitcount_lsf = function (gfc, cod_info) {\n        var table_number, row_in_table, partition, nr_sfb, window;\n        var over;\n        var i, sfb;\n        var max_sfac = new_int(4);\n//var partition_table;\n        var scalefac = cod_info.scalefac;\n\n        /*\n         * Set partition table. Note that should try to use table one, but do\n         * not yet...\n         */\n        if (cod_info.preflag != 0)\n            table_number = 2;\n        else\n            table_number = 0;\n\n        for (i = 0; i < 4; i++)\n            max_sfac[i] = 0;\n\n        if (cod_info.block_type == Encoder.SHORT_TYPE) {\n            row_in_table = 1;\n            var partition_table = qupvt.nr_of_sfb_block[table_number][row_in_table];\n            for (sfb = 0, partition = 0; partition < 4; partition++) {\n                nr_sfb = partition_table[partition] / 3;\n                for (i = 0; i < nr_sfb; i++, sfb++)\n                    for (window = 0; window < 3; window++)\n                        if (scalefac[sfb * 3 + window] > max_sfac[partition])\n                            max_sfac[partition] = scalefac[sfb * 3 + window];\n            }\n        } else {\n            row_in_table = 0;\n            var partition_table = qupvt.nr_of_sfb_block[table_number][row_in_table];\n            for (sfb = 0, partition = 0; partition < 4; partition++) {\n                nr_sfb = partition_table[partition];\n                for (i = 0; i < nr_sfb; i++, sfb++)\n                    if (scalefac[sfb] > max_sfac[partition])\n                        max_sfac[partition] = scalefac[sfb];\n            }\n        }\n\n        for (over = false, partition = 0; partition < 4; partition++) {\n            if (max_sfac[partition] > max_range_sfac_tab[table_number][partition])\n                over = true;\n        }\n        if (!over) {\n            var slen1, slen2, slen3, slen4;\n\n            cod_info.sfb_partition_table = qupvt.nr_of_sfb_block[table_number][row_in_table];\n            for (partition = 0; partition < 4; partition++)\n                cod_info.slen[partition] = log2tab[max_sfac[partition]];\n\n            /* set scalefac_compress */\n            slen1 = cod_info.slen[0];\n            slen2 = cod_info.slen[1];\n            slen3 = cod_info.slen[2];\n            slen4 = cod_info.slen[3];\n\n            switch (table_number) {\n                case 0:\n                    cod_info.scalefac_compress = (((slen1 * 5) + slen2) << 4)\n                        + (slen3 << 2) + slen4;\n                    break;\n\n                case 1:\n                    cod_info.scalefac_compress = 400 + (((slen1 * 5) + slen2) << 2)\n                        + slen3;\n                    break;\n\n                case 2:\n                    cod_info.scalefac_compress = 500 + (slen1 * 3) + slen2;\n                    break;\n\n                default:\n                    System.err.printf(\"intensity stereo not implemented yet\\n\");\n                    break;\n            }\n        }\n        if (!over) {\n            cod_info.part2_length = 0;\n            for (partition = 0; partition < 4; partition++)\n                cod_info.part2_length += cod_info.slen[partition]\n                    * cod_info.sfb_partition_table[partition];\n        }\n        return over;\n    }\n\n    /*\n     * Since no bands have been over-amplified, we can set scalefac_compress and\n     * slen[] for the formatter\n     */\n    var log2tab = [0, 1, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4,\n        4, 4, 4, 4];\n\n    this.huffman_init = function (gfc) {\n        for (var i = 2; i <= 576; i += 2) {\n            var scfb_anz = 0, bv_index;\n            while (gfc.scalefac_band.l[++scfb_anz] < i)\n                ;\n\n            bv_index = subdv_table[scfb_anz][0]; // .region0_count\n            while (gfc.scalefac_band.l[bv_index + 1] > i)\n                bv_index--;\n\n            if (bv_index < 0) {\n                /*\n                 * this is an indication that everything is going to be encoded\n                 * as region0: bigvalues < region0 < region1 so lets set\n                 * region0, region1 to some value larger than bigvalues\n                 */\n                bv_index = subdv_table[scfb_anz][0]; // .region0_count\n            }\n\n            gfc.bv_scf[i - 2] = bv_index;\n\n            bv_index = subdv_table[scfb_anz][1]; // .region1_count\n            while (gfc.scalefac_band.l[bv_index + gfc.bv_scf[i - 2] + 2] > i)\n                bv_index--;\n\n            if (bv_index < 0) {\n                bv_index = subdv_table[scfb_anz][1]; // .region1_count\n            }\n\n            gfc.bv_scf[i - 1] = bv_index;\n        }\n    }\n}\n\n/*\n *  ReplayGainAnalysis - analyzes input samples and give the recommended dB change\n *  Copyright (C) 2001 David Robinson and Glen Sawyer\n *  Improvements and optimizations added by Frank Klemm, and by Marcel Muller \n *\n *  This library is free software; you can redistribute it and/or\n *  modify it under the terms of the GNU Lesser General Public\n *  License as published by the Free Software Foundation; either\n *  version 2.1 of the License, or (at your option) any later version.\n *\n *  This library is distributed in the hope that it will be useful,\n *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n *  Lesser General Public License for more details.\n *\n *  You should have received a copy of the GNU Lesser General Public\n *  License along with this library; if not, write to the Free Software\n *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n *\n *  concept and filter values by David Robinson (David@Robinson.org)\n *    -- blame him if you think the idea is flawed\n *  original coding by Glen Sawyer (mp3gain@hotmail.com)\n *    -- blame him if you think this runs too slowly, or the coding is otherwise flawed\n *\n *  lots of code improvements by Frank Klemm ( http://www.uni-jena.de/~pfk/mpp/ )\n *    -- credit him for all the _good_ programming ;)\n *\n *\n *  For an explanation of the concepts and the basic algorithms involved, go to:\n *    http://www.replaygain.org/\n */\n\n/*\n *  Here's the deal. Call\n *\n *    InitGainAnalysis ( long samplefreq );\n *\n *  to initialize everything. Call\n *\n *    AnalyzeSamples ( var Float_t*  left_samples,\n *                     var Float_t*  right_samples,\n *                     size_t          num_samples,\n *                     int             num_channels );\n *\n *  as many times as you want, with as many or as few samples as you want.\n *  If mono, pass the sample buffer in through left_samples, leave\n *  right_samples NULL, and make sure num_channels = 1.\n *\n *    GetTitleGain()\n *\n *  will return the recommended dB level change for all samples analyzed\n *  SINCE THE LAST TIME you called GetTitleGain() OR InitGainAnalysis().\n *\n *    GetAlbumGain()\n *\n *  will return the recommended dB level change for all samples analyzed\n *  since InitGainAnalysis() was called and finalized with GetTitleGain().\n *\n *  Pseudo-code to process an album:\n *\n *    Float_t       l_samples [4096];\n *    Float_t       r_samples [4096];\n *    size_t        num_samples;\n *    unsigned int  num_songs;\n *    unsigned int  i;\n *\n *    InitGainAnalysis ( 44100 );\n *    for ( i = 1; i <= num_songs; i++ ) {\n *        while ( ( num_samples = getSongSamples ( song[i], left_samples, right_samples ) ) > 0 )\n *            AnalyzeSamples ( left_samples, right_samples, num_samples, 2 );\n *        fprintf (\"Recommended dB change for song %2d: %+6.2 dB\\n\", i, GetTitleGain() );\n *    }\n *    fprintf (\"Recommended dB change for whole album: %+6.2 dB\\n\", GetAlbumGain() );\n */\n\n/*\n *  So here's the main source of potential code confusion:\n *\n *  The filters applied to the incoming samples are IIR filters,\n *  meaning they rely on up to <filter order> number of previous samples\n *  AND up to <filter order> number of previous filtered samples.\n *\n *  I set up the AnalyzeSamples routine to minimize memory usage and interface\n *  complexity. The speed isn't compromised too much (I don't think), but the\n *  internal complexity is higher than it should be for such a relatively\n *  simple routine.\n *\n *  Optimization/clarity suggestions are welcome.\n */\n\n/**\n * Table entries per dB\n */\nGainAnalysis.STEPS_per_dB = 100.;\n/**\n * Table entries for 0...MAX_dB (normal max. values are 70...80 dB)\n */\nGainAnalysis.MAX_dB = 120.;\nGainAnalysis.GAIN_NOT_ENOUGH_SAMPLES = -24601;\nGainAnalysis.GAIN_ANALYSIS_ERROR = 0;\nGainAnalysis.GAIN_ANALYSIS_OK = 1;\nGainAnalysis.INIT_GAIN_ANALYSIS_ERROR = 0;\nGainAnalysis.INIT_GAIN_ANALYSIS_OK = 1;\n\nGainAnalysis.YULE_ORDER = 10;\nGainAnalysis.MAX_ORDER = GainAnalysis.YULE_ORDER;\n\nGainAnalysis.MAX_SAMP_FREQ = 48000;\nGainAnalysis.RMS_WINDOW_TIME_NUMERATOR = 1;\nGainAnalysis.RMS_WINDOW_TIME_DENOMINATOR = 20;\nGainAnalysis.MAX_SAMPLES_PER_WINDOW = ((GainAnalysis.MAX_SAMP_FREQ * GainAnalysis.RMS_WINDOW_TIME_NUMERATOR) / GainAnalysis.RMS_WINDOW_TIME_DENOMINATOR + 1);\n\nfunction GainAnalysis() {\n\t//fix 精简\n}\n\n\nfunction Presets() {\n    function VBRPresets(qual, comp, compS,\n                        y, shThreshold, shThresholdS,\n                        adj, adjShort, lower,\n                        curve, sens, inter,\n                        joint, mod, fix) {\n        this.vbr_q = qual;\n        this.quant_comp = comp;\n        this.quant_comp_s = compS;\n        this.expY = y;\n        this.st_lrm = shThreshold;\n        this.st_s = shThresholdS;\n        this.masking_adj = adj;\n        this.masking_adj_short = adjShort;\n        this.ath_lower = lower;\n        this.ath_curve = curve;\n        this.ath_sensitivity = sens;\n        this.interch = inter;\n        this.safejoint = joint;\n        this.sfb21mod = mod;\n        this.msfix = fix;\n    }\n\n    function ABRPresets(kbps, comp, compS,\n                        joint, fix, shThreshold,\n                        shThresholdS, bass, sc,\n                        mask, lower, curve,\n                        interCh, sfScale) {\n        this.quant_comp = comp;\n        this.quant_comp_s = compS;\n        this.safejoint = joint;\n        this.nsmsfix = fix;\n        this.st_lrm = shThreshold;\n        this.st_s = shThresholdS;\n        this.nsbass = bass;\n        this.scale = sc;\n        this.masking_adj = mask;\n        this.ath_lower = lower;\n        this.ath_curve = curve;\n        this.interch = interCh;\n        this.sfscale = sfScale;\n    }\n\n    var lame;\n\n    this.setModules = function (_lame) {\n        lame = _lame;\n    };\n\n    /**\n     * <PRE>\n     * Switch mappings for VBR mode VBR_RH\n     *             vbr_q  qcomp_l  qcomp_s  expY  st_lrm   st_s  mask adj_l  adj_s  ath_lower  ath_curve  ath_sens  interChR  safejoint sfb21mod  msfix\n     * </PRE>\n     */\n    var vbr_old_switch_map = [\n        new VBRPresets(0, 9, 9, 0, 5.20, 125.0, -4.2, -6.3, 4.8, 1, 0, 0, 2, 21, 0.97),\n        new VBRPresets(1, 9, 9, 0, 5.30, 125.0, -3.6, -5.6, 4.5, 1.5, 0, 0, 2, 21, 1.35),\n        new VBRPresets(2, 9, 9, 0, 5.60, 125.0, -2.2, -3.5, 2.8, 2, 0, 0, 2, 21, 1.49),\n        new VBRPresets(3, 9, 9, 1, 5.80, 130.0, -1.8, -2.8, 2.6, 3, -4, 0, 2, 20, 1.64),\n        new VBRPresets(4, 9, 9, 1, 6.00, 135.0, -0.7, -1.1, 1.1, 3.5, -8, 0, 2, 0, 1.79),\n        new VBRPresets(5, 9, 9, 1, 6.40, 140.0, 0.5, 0.4, -7.5, 4, -12, 0.0002, 0, 0, 1.95),\n        new VBRPresets(6, 9, 9, 1, 6.60, 145.0, 0.67, 0.65, -14.7, 6.5, -19, 0.0004, 0, 0, 2.30),\n        new VBRPresets(7, 9, 9, 1, 6.60, 145.0, 0.8, 0.75, -19.7, 8, -22, 0.0006, 0, 0, 2.70),\n        new VBRPresets(8, 9, 9, 1, 6.60, 145.0, 1.2, 1.15, -27.5, 10, -23, 0.0007, 0, 0, 0),\n        new VBRPresets(9, 9, 9, 1, 6.60, 145.0, 1.6, 1.6, -36, 11, -25, 0.0008, 0, 0, 0),\n        new VBRPresets(10, 9, 9, 1, 6.60, 145.0, 2.0, 2.0, -36, 12, -25, 0.0008, 0, 0, 0)\n    ];\n\n    /**\n     * <PRE>\n     *                 vbr_q  qcomp_l  qcomp_s  expY  st_lrm   st_s  mask adj_l  adj_s  ath_lower  ath_curve  ath_sens  interChR  safejoint sfb21mod  msfix\n     * </PRE>\n     */\n    var vbr_psy_switch_map = [\n        new VBRPresets(0, 9, 9, 0, 4.20, 25.0, -7.0, -4.0, 7.5, 1, 0, 0, 2, 26, 0.97),\n        new VBRPresets(1, 9, 9, 0, 4.20, 25.0, -5.6, -3.6, 4.5, 1.5, 0, 0, 2, 21, 1.35),\n        new VBRPresets(2, 9, 9, 0, 4.20, 25.0, -4.4, -1.8, 2, 2, 0, 0, 2, 18, 1.49),\n        new VBRPresets(3, 9, 9, 1, 4.20, 25.0, -3.4, -1.25, 1.1, 3, -4, 0, 2, 15, 1.64),\n        new VBRPresets(4, 9, 9, 1, 4.20, 25.0, -2.2, 0.1, 0, 3.5, -8, 0, 2, 0, 1.79),\n        new VBRPresets(5, 9, 9, 1, 4.20, 25.0, -1.0, 1.65, -7.7, 4, -12, 0.0002, 0, 0, 1.95),\n        new VBRPresets(6, 9, 9, 1, 4.20, 25.0, -0.0, 2.47, -7.7, 6.5, -19, 0.0004, 0, 0, 2),\n        new VBRPresets(7, 9, 9, 1, 4.20, 25.0, 0.5, 2.0, -14.5, 8, -22, 0.0006, 0, 0, 2),\n        new VBRPresets(8, 9, 9, 1, 4.20, 25.0, 1.0, 2.4, -22.0, 10, -23, 0.0007, 0, 0, 2),\n        new VBRPresets(9, 9, 9, 1, 4.20, 25.0, 1.5, 2.95, -30.0, 11, -25, 0.0008, 0, 0, 2),\n        new VBRPresets(10, 9, 9, 1, 4.20, 25.0, 2.0, 2.95, -36.0, 12, -30, 0.0008, 0, 0, 2)\n    ];\n\n    function apply_vbr_preset(gfp, a, enforce) {\n        var vbr_preset = gfp.VBR == VbrMode.vbr_rh ? vbr_old_switch_map\n            : vbr_psy_switch_map;\n\n        var x = gfp.VBR_q_frac;\n        var p = vbr_preset[a];\n        var q = vbr_preset[a + 1];\n        var set = p;\n\n        // NOOP(vbr_q);\n        // NOOP(quant_comp);\n        // NOOP(quant_comp_s);\n        // NOOP(expY);\n        p.st_lrm = p.st_lrm + x * (q.st_lrm - p.st_lrm);\n        // LERP(st_lrm);\n        p.st_s = p.st_s + x * (q.st_s - p.st_s);\n        // LERP(st_s);\n        p.masking_adj = p.masking_adj + x * (q.masking_adj - p.masking_adj);\n        // LERP(masking_adj);\n        p.masking_adj_short = p.masking_adj_short + x\n            * (q.masking_adj_short - p.masking_adj_short);\n        // LERP(masking_adj_short);\n        p.ath_lower = p.ath_lower + x * (q.ath_lower - p.ath_lower);\n        // LERP(ath_lower);\n        p.ath_curve = p.ath_curve + x * (q.ath_curve - p.ath_curve);\n        // LERP(ath_curve);\n        p.ath_sensitivity = p.ath_sensitivity + x\n            * (q.ath_sensitivity - p.ath_sensitivity);\n        // LERP(ath_sensitivity);\n        p.interch = p.interch + x * (q.interch - p.interch);\n        // LERP(interch);\n        // NOOP(safejoint);\n        // NOOP(sfb21mod);\n        p.msfix = p.msfix + x * (q.msfix - p.msfix);\n        // LERP(msfix);\n\n        lame_set_VBR_q(gfp, set.vbr_q);\n\n        if (enforce != 0)\n            gfp.quant_comp = set.quant_comp;\n        else if (!(Math.abs(gfp.quant_comp - -1) > 0))\n            gfp.quant_comp = set.quant_comp;\n        // SET_OPTION(quant_comp, set.quant_comp, -1);\n        if (enforce != 0)\n            gfp.quant_comp_short = set.quant_comp_s;\n        else if (!(Math.abs(gfp.quant_comp_short - -1) > 0))\n            gfp.quant_comp_short = set.quant_comp_s;\n        // SET_OPTION(quant_comp_short, set.quant_comp_s, -1);\n        if (set.expY != 0) {\n            gfp.experimentalY = set.expY != 0;\n        }\n        if (enforce != 0)\n            gfp.internal_flags.nsPsy.attackthre = set.st_lrm;\n        else if (!(Math.abs(gfp.internal_flags.nsPsy.attackthre - -1) > 0))\n            gfp.internal_flags.nsPsy.attackthre = set.st_lrm;\n        // SET_OPTION(short_threshold_lrm, set.st_lrm, -1);\n        if (enforce != 0)\n            gfp.internal_flags.nsPsy.attackthre_s = set.st_s;\n        else if (!(Math.abs(gfp.internal_flags.nsPsy.attackthre_s - -1) > 0))\n            gfp.internal_flags.nsPsy.attackthre_s = set.st_s;\n        // SET_OPTION(short_threshold_s, set.st_s, -1);\n        if (enforce != 0)\n            gfp.maskingadjust = set.masking_adj;\n        else if (!(Math.abs(gfp.maskingadjust - 0) > 0))\n            gfp.maskingadjust = set.masking_adj;\n        // SET_OPTION(maskingadjust, set.masking_adj, 0);\n        if (enforce != 0)\n            gfp.maskingadjust_short = set.masking_adj_short;\n        else if (!(Math.abs(gfp.maskingadjust_short - 0) > 0))\n            gfp.maskingadjust_short = set.masking_adj_short;\n        // SET_OPTION(maskingadjust_short, set.masking_adj_short, 0);\n        if (enforce != 0)\n            gfp.ATHlower = -set.ath_lower / 10.0;\n        else if (!(Math.abs((-gfp.ATHlower * 10.0) - 0) > 0))\n            gfp.ATHlower = -set.ath_lower / 10.0;\n        // SET_OPTION(ATHlower, set.ath_lower, 0);\n        if (enforce != 0)\n            gfp.ATHcurve = set.ath_curve;\n        else if (!(Math.abs(gfp.ATHcurve - -1) > 0))\n            gfp.ATHcurve = set.ath_curve;\n        // SET_OPTION(ATHcurve, set.ath_curve, -1);\n        if (enforce != 0)\n            gfp.athaa_sensitivity = set.ath_sensitivity;\n        else if (!(Math.abs(gfp.athaa_sensitivity - -1) > 0))\n            gfp.athaa_sensitivity = set.ath_sensitivity;\n        // SET_OPTION(athaa_sensitivity, set.ath_sensitivity, 0);\n        if (set.interch > 0) {\n            if (enforce != 0)\n                gfp.interChRatio = set.interch;\n            else if (!(Math.abs(gfp.interChRatio - -1) > 0))\n                gfp.interChRatio = set.interch;\n            // SET_OPTION(interChRatio, set.interch, -1);\n        }\n\n        /* parameters for which there is no proper set/get interface */\n        if (set.safejoint > 0) {\n            gfp.exp_nspsytune = gfp.exp_nspsytune | set.safejoint;\n        }\n        if (set.sfb21mod > 0) {\n            gfp.exp_nspsytune = gfp.exp_nspsytune | (set.sfb21mod << 20);\n        }\n        if (enforce != 0)\n            gfp.msfix = set.msfix;\n        else if (!(Math.abs(gfp.msfix - -1) > 0))\n            gfp.msfix = set.msfix;\n        // SET_OPTION(msfix, set.msfix, -1);\n\n        if (enforce == 0) {\n            gfp.VBR_q = a;\n            gfp.VBR_q_frac = x;\n        }\n    }\n\n    /**\n     * <PRE>\n     *  Switch mappings for ABR mode\n     *\n     *              kbps  quant q_s safejoint nsmsfix st_lrm  st_s  ns-bass scale   msk ath_lwr ath_curve  interch , sfscale\n     * </PRE>\n     */\n    var abr_switch_map = [\n        new ABRPresets(8, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -30.0, 11, 0.0012, 1), /*   8, impossible to use in stereo */\n        new ABRPresets(16, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -25.0, 11, 0.0010, 1), /*  16 */\n        new ABRPresets(24, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -20.0, 11, 0.0010, 1), /*  24 */\n        new ABRPresets(32, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -15.0, 11, 0.0010, 1), /*  32 */\n        new ABRPresets(40, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -10.0, 11, 0.0009, 1), /*  40 */\n        new ABRPresets(48, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -10.0, 11, 0.0009, 1), /*  48 */\n        new ABRPresets(56, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -6.0, 11, 0.0008, 1), /*  56 */\n        new ABRPresets(64, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -2.0, 11, 0.0008, 1), /*  64 */\n        new ABRPresets(80, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, .0, 8, 0.0007, 1), /*  80 */\n        new ABRPresets(96, 9, 9, 0, 2.50, 6.60, 145, 0, 0.95, 0, 1.0, 5.5, 0.0006, 1), /*  96 */\n        new ABRPresets(112, 9, 9, 0, 2.25, 6.60, 145, 0, 0.95, 0, 2.0, 4.5, 0.0005, 1), /* 112 */\n        new ABRPresets(128, 9, 9, 0, 1.95, 6.40, 140, 0, 0.95, 0, 3.0, 4, 0.0002, 1), /* 128 */\n        new ABRPresets(160, 9, 9, 1, 1.79, 6.00, 135, 0, 0.95, -2, 5.0, 3.5, 0, 1), /* 160 */\n        new ABRPresets(192, 9, 9, 1, 1.49, 5.60, 125, 0, 0.97, -4, 7.0, 3, 0, 0), /* 192 */\n        new ABRPresets(224, 9, 9, 1, 1.25, 5.20, 125, 0, 0.98, -6, 9.0, 2, 0, 0), /* 224 */\n        new ABRPresets(256, 9, 9, 1, 0.97, 5.20, 125, 0, 1.00, -8, 10.0, 1, 0, 0), /* 256 */\n        new ABRPresets(320, 9, 9, 1, 0.90, 5.20, 125, 0, 1.00, -10, 12.0, 0, 0, 0)  /* 320 */\n    ];\n\n    function apply_abr_preset(gfp, preset, enforce) {\n        /* Variables for the ABR stuff */\n        var actual_bitrate = preset;\n\n        var r = lame.nearestBitrateFullIndex(preset);\n\n        gfp.VBR = VbrMode.vbr_abr;\n        gfp.VBR_mean_bitrate_kbps = actual_bitrate;\n        gfp.VBR_mean_bitrate_kbps = Math.min(gfp.VBR_mean_bitrate_kbps, 320);\n        gfp.VBR_mean_bitrate_kbps = Math.max(gfp.VBR_mean_bitrate_kbps, 8);\n        gfp.brate = gfp.VBR_mean_bitrate_kbps;\n        if (gfp.VBR_mean_bitrate_kbps > 320) {\n            gfp.disable_reservoir = true;\n        }\n\n        /* parameters for which there is no proper set/get interface */\n        if (abr_switch_map[r].safejoint > 0)\n            gfp.exp_nspsytune = gfp.exp_nspsytune | 2;\n        /* safejoint */\n\n        if (abr_switch_map[r].sfscale > 0) {\n            gfp.internal_flags.noise_shaping = 2;\n        }\n        /* ns-bass tweaks */\n        if (Math.abs(abr_switch_map[r].nsbass) > 0) {\n            var k = (int)(abr_switch_map[r].nsbass * 4);\n            if (k < 0)\n                k += 64;\n            gfp.exp_nspsytune = gfp.exp_nspsytune | (k << 2);\n        }\n\n        if (enforce != 0)\n            gfp.quant_comp = abr_switch_map[r].quant_comp;\n        else if (!(Math.abs(gfp.quant_comp - -1) > 0))\n            gfp.quant_comp = abr_switch_map[r].quant_comp;\n        // SET_OPTION(quant_comp, abr_switch_map[r].quant_comp, -1);\n        if (enforce != 0)\n            gfp.quant_comp_short = abr_switch_map[r].quant_comp_s;\n        else if (!(Math.abs(gfp.quant_comp_short - -1) > 0))\n            gfp.quant_comp_short = abr_switch_map[r].quant_comp_s;\n        // SET_OPTION(quant_comp_short, abr_switch_map[r].quant_comp_s, -1);\n\n        if (enforce != 0)\n            gfp.msfix = abr_switch_map[r].nsmsfix;\n        else if (!(Math.abs(gfp.msfix - -1) > 0))\n            gfp.msfix = abr_switch_map[r].nsmsfix;\n        // SET_OPTION(msfix, abr_switch_map[r].nsmsfix, -1);\n\n        if (enforce != 0)\n            gfp.internal_flags.nsPsy.attackthre = abr_switch_map[r].st_lrm;\n        else if (!(Math.abs(gfp.internal_flags.nsPsy.attackthre - -1) > 0))\n            gfp.internal_flags.nsPsy.attackthre = abr_switch_map[r].st_lrm;\n        // SET_OPTION(short_threshold_lrm, abr_switch_map[r].st_lrm, -1);\n        if (enforce != 0)\n            gfp.internal_flags.nsPsy.attackthre_s = abr_switch_map[r].st_s;\n        else if (!(Math.abs(gfp.internal_flags.nsPsy.attackthre_s - -1) > 0))\n            gfp.internal_flags.nsPsy.attackthre_s = abr_switch_map[r].st_s;\n        // SET_OPTION(short_threshold_s, abr_switch_map[r].st_s, -1);\n\n        /*\n         * ABR seems to have big problems with clipping, especially at low\n         * bitrates\n         */\n        /*\n         * so we compensate for that here by using a scale value depending on\n         * bitrate\n         */\n        if (enforce != 0)\n            gfp.scale = abr_switch_map[r].scale;\n        else if (!(Math.abs(gfp.scale - -1) > 0))\n            gfp.scale = abr_switch_map[r].scale;\n        // SET_OPTION(scale, abr_switch_map[r].scale, -1);\n\n        if (enforce != 0)\n            gfp.maskingadjust = abr_switch_map[r].masking_adj;\n        else if (!(Math.abs(gfp.maskingadjust - 0) > 0))\n            gfp.maskingadjust = abr_switch_map[r].masking_adj;\n        // SET_OPTION(maskingadjust, abr_switch_map[r].masking_adj, 0);\n        if (abr_switch_map[r].masking_adj > 0) {\n            if (enforce != 0)\n                gfp.maskingadjust_short = (abr_switch_map[r].masking_adj * .9);\n            else if (!(Math.abs(gfp.maskingadjust_short - 0) > 0))\n                gfp.maskingadjust_short = (abr_switch_map[r].masking_adj * .9);\n            // SET_OPTION(maskingadjust_short, abr_switch_map[r].masking_adj *\n            // .9, 0);\n        } else {\n            if (enforce != 0)\n                gfp.maskingadjust_short = (abr_switch_map[r].masking_adj * 1.1);\n            else if (!(Math.abs(gfp.maskingadjust_short - 0) > 0))\n                gfp.maskingadjust_short = (abr_switch_map[r].masking_adj * 1.1);\n            // SET_OPTION(maskingadjust_short, abr_switch_map[r].masking_adj *\n            // 1.1, 0);\n        }\n\n        if (enforce != 0)\n            gfp.ATHlower = -abr_switch_map[r].ath_lower / 10.;\n        else if (!(Math.abs((-gfp.ATHlower * 10.) - 0) > 0))\n            gfp.ATHlower = -abr_switch_map[r].ath_lower / 10.;\n        // SET_OPTION(ATHlower, abr_switch_map[r].ath_lower, 0);\n        if (enforce != 0)\n            gfp.ATHcurve = abr_switch_map[r].ath_curve;\n        else if (!(Math.abs(gfp.ATHcurve - -1) > 0))\n            gfp.ATHcurve = abr_switch_map[r].ath_curve;\n        // SET_OPTION(ATHcurve, abr_switch_map[r].ath_curve, -1);\n\n        if (enforce != 0)\n            gfp.interChRatio = abr_switch_map[r].interch;\n        else if (!(Math.abs(gfp.interChRatio - -1) > 0))\n            gfp.interChRatio = abr_switch_map[r].interch;\n        // SET_OPTION(interChRatio, abr_switch_map[r].interch, -1);\n\n        return preset;\n    }\n\n    this.apply_preset = function(gfp, preset, enforce) {\n        /* translate legacy presets */\n        switch (preset) {\n            case Lame.R3MIX:\n            {\n                preset = Lame.V3;\n                gfp.VBR = VbrMode.vbr_mtrh;\n                break;\n            }\n            case Lame.MEDIUM:\n            {\n                preset = Lame.V4;\n                gfp.VBR = VbrMode.vbr_rh;\n                break;\n            }\n            case Lame.MEDIUM_FAST:\n            {\n                preset = Lame.V4;\n                gfp.VBR = VbrMode.vbr_mtrh;\n                break;\n            }\n            case Lame.STANDARD:\n            {\n                preset = Lame.V2;\n                gfp.VBR = VbrMode.vbr_rh;\n                break;\n            }\n            case Lame.STANDARD_FAST:\n            {\n                preset = Lame.V2;\n                gfp.VBR = VbrMode.vbr_mtrh;\n                break;\n            }\n            case Lame.EXTREME:\n            {\n                preset = Lame.V0;\n                gfp.VBR = VbrMode.vbr_rh;\n                break;\n            }\n            case Lame.EXTREME_FAST:\n            {\n                preset = Lame.V0;\n                gfp.VBR = VbrMode.vbr_mtrh;\n                break;\n            }\n            case Lame.INSANE:\n            {\n                preset = 320;\n                gfp.preset = preset;\n                apply_abr_preset(gfp, preset, enforce);\n                gfp.VBR = VbrMode.vbr_off;\n                return preset;\n            }\n        }\n\n        gfp.preset = preset;\n        {\n            switch (preset) {\n                case Lame.V9:\n                    apply_vbr_preset(gfp, 9, enforce);\n                    return preset;\n                case Lame.V8:\n                    apply_vbr_preset(gfp, 8, enforce);\n                    return preset;\n                case Lame.V7:\n                    apply_vbr_preset(gfp, 7, enforce);\n                    return preset;\n                case Lame.V6:\n                    apply_vbr_preset(gfp, 6, enforce);\n                    return preset;\n                case Lame.V5:\n                    apply_vbr_preset(gfp, 5, enforce);\n                    return preset;\n                case Lame.V4:\n                    apply_vbr_preset(gfp, 4, enforce);\n                    return preset;\n                case Lame.V3:\n                    apply_vbr_preset(gfp, 3, enforce);\n                    return preset;\n                case Lame.V2:\n                    apply_vbr_preset(gfp, 2, enforce);\n                    return preset;\n                case Lame.V1:\n                    apply_vbr_preset(gfp, 1, enforce);\n                    return preset;\n                case Lame.V0:\n                    apply_vbr_preset(gfp, 0, enforce);\n                    return preset;\n                default:\n                    break;\n            }\n        }\n        if (8 <= preset && preset <= 320) {\n            return apply_abr_preset(gfp, preset, enforce);\n        }\n\n        /* no corresponding preset found */\n        gfp.preset = 0;\n        return preset;\n    }\n\n    // Rest from getset.c:\n\n    /**\n     * VBR quality level.<BR>\n     * 0 = highest<BR>\n     * 9 = lowest\n     */\n    function lame_set_VBR_q(gfp, VBR_q) {\n        var ret = 0;\n\n        if (0 > VBR_q) {\n            /* Unknown VBR quality level! */\n            ret = -1;\n            VBR_q = 0;\n        }\n        if (9 < VBR_q) {\n            ret = -1;\n            VBR_q = 9;\n        }\n\n        gfp.VBR_q = VBR_q;\n        gfp.VBR_q_frac = 0;\n        return ret;\n    }\n\n}\n\n/*\n *      bit reservoir source file\n *\n *      Copyright (c) 1999-2000 Mark Taylor\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n\n/* $Id: Reservoir.java,v 1.9 2011/05/24 20:48:06 kenchis Exp $ */\n\n//package mp3;\n\n/**\n * ResvFrameBegin:<BR>\n * Called (repeatedly) at the beginning of a frame. Updates the maximum size of\n * the reservoir, and checks to make sure main_data_begin was set properly by\n * the formatter<BR>\n * Background information:\n * \n * This is the original text from the ISO standard. Because of sooo many bugs\n * and irritations correcting comments are added in brackets []. A '^W' means\n * you should remove the last word.\n * \n * <PRE>\n *  1. The following rule can be used to calculate the maximum\n *     number of bits used for one granule [^W frame]:<BR>\n *     At the highest possible bitrate of Layer III (320 kbps\n *     per stereo signal [^W^W^W], 48 kHz) the frames must be of\n *     [^W^W^W are designed to have] constant length, i.e.\n *     one buffer [^W^W the frame] length is:<BR>\n * \n *         320 kbps * 1152/48 kHz = 7680 bit = 960 byte\n * \n *     This value is used as the maximum buffer per channel [^W^W] at\n *     lower bitrates [than 320 kbps]. At 64 kbps mono or 128 kbps\n *     stereo the main granule length is 64 kbps * 576/48 kHz = 768 bit\n *     [per granule and channel] at 48 kHz sampling frequency.\n *     This means that there is a maximum deviation (short time buffer\n *     [= reservoir]) of 7680 - 2*2*768 = 4608 bits is allowed at 64 kbps.\n *     The actual deviation is equal to the number of bytes [with the\n *     meaning of octets] denoted by the main_data_end offset pointer.\n *     The actual maximum deviation is (2^9-1)*8 bit = 4088 bits\n *     [for MPEG-1 and (2^8-1)*8 bit for MPEG-2, both are hard limits].\n *     ... The xchange of buffer bits between the left and right channel\n *     is allowed without restrictions [exception: dual channel].\n *     Because of the [constructed] constraint on the buffer size\n *     main_data_end is always set to 0 in the case of bit_rate_index==14,\n *     i.e. data rate 320 kbps per stereo signal [^W^W^W]. In this case\n *     all data are allocated between adjacent header [^W sync] words\n *     [, i.e. there is no buffering at all].\n * </PRE>\n */\n\n\nfunction Reservoir() {\n\tvar bs;\n\n\tthis.setModules  = function(_bs) {\n\t\tbs = _bs;\n\t}\n\n\tthis.ResvFrameBegin = function(gfp, mean_bits) {\n\t\tvar gfc = gfp.internal_flags;\n\t\tvar maxmp3buf;\n\t\tvar l3_side = gfc.l3_side;\n\n\t\tvar frameLength = bs.getframebits(gfp);\n\t\tmean_bits.bits = (frameLength - gfc.sideinfo_len * 8) / gfc.mode_gr;\n\n\t\t/**\n\t\t * <PRE>\n\t\t *  Meaning of the variables:\n\t\t *      resvLimit: (0, 8, ..., 8*255 (MPEG-2), 8*511 (MPEG-1))\n\t\t *          Number of bits can be stored in previous frame(s) due to\n\t\t *          counter size constaints\n\t\t *      maxmp3buf: ( ??? ... 8*1951 (MPEG-1 and 2), 8*2047 (MPEG-2.5))\n\t\t *          Number of bits allowed to encode one frame (you can take 8*511 bit\n\t\t *          from the bit reservoir and at most 8*1440 bit from the current\n\t\t *          frame (320 kbps, 32 kHz), so 8*1951 bit is the largest possible\n\t\t *          value for MPEG-1 and -2)\n\t\t * \n\t\t *          maximum allowed granule/channel size times 4 = 8*2047 bits.,\n\t\t *          so this is the absolute maximum supported by the format.\n\t\t * \n\t\t * \n\t\t *      fullFrameBits:  maximum number of bits available for encoding\n\t\t *                      the current frame.\n\t\t * \n\t\t *      mean_bits:      target number of bits per granule.\n\t\t * \n\t\t *      frameLength:\n\t\t * \n\t\t *      gfc.ResvMax:   maximum allowed reservoir\n\t\t * \n\t\t *      gfc.ResvSize:  current reservoir size\n\t\t * \n\t\t *      l3_side.resvDrain_pre:\n\t\t *         ancillary data to be added to previous frame:\n\t\t *         (only usefull in VBR modes if it is possible to have\n\t\t *         maxmp3buf < fullFrameBits)).  Currently disabled,\n\t\t *         see #define NEW_DRAIN\n\t\t *         2010-02-13: RH now enabled, it seems to be needed for CBR too,\n\t\t *                     as there exists one example, where the FhG decoder\n\t\t *                     can't decode a -b320 CBR file anymore.\n\t\t * \n\t\t *      l3_side.resvDrain_post:\n\t\t *         ancillary data to be added to this frame:\n\t\t * \n\t\t * </PRE>\n\t\t */\n\n\t\t/* main_data_begin has 9 bits in MPEG-1, 8 bits MPEG-2 */\n\t\tvar resvLimit = (8 * 256) * gfc.mode_gr - 8;\n\n\t\t/*\n\t\t * maximum allowed frame size. dont use more than this number of bits,\n\t\t * even if the frame has the space for them:\n\t\t */\n\t\tif (gfp.brate > 320) {\n\t\t\t/* in freeformat the buffer is constant */\n\t\t\tmaxmp3buf = 8 * ((int) ((gfp.brate * 1000)\n\t\t\t\t\t/ (gfp.out_samplerate / 1152) / 8 + .5));\n\t\t} else {\n\t\t\t/*\n\t\t\t * all mp3 decoders should have enough buffer to handle this value:\n\t\t\t * size of a 320kbps 32kHz frame\n\t\t\t */\n\t\t\tmaxmp3buf = 8 * 1440;\n\n\t\t\t/*\n\t\t\t * Bouvigne suggests this more lax interpretation of the ISO doc\n\t\t\t * instead of using 8*960.\n\t\t\t */\n\n\t\t\tif (gfp.strict_ISO) {\n\t\t\t\tmaxmp3buf = 8 * ((int) (320000 / (gfp.out_samplerate / 1152) / 8 + .5));\n\t\t\t}\n\t\t}\n\n\t\tgfc.ResvMax = maxmp3buf - frameLength;\n\t\tif (gfc.ResvMax > resvLimit)\n\t\t\tgfc.ResvMax = resvLimit;\n\t\tif (gfc.ResvMax < 0 || gfp.disable_reservoir)\n\t\t\tgfc.ResvMax = 0;\n\n\t\tvar fullFrameBits = mean_bits.bits * gfc.mode_gr\n\t\t\t\t+ Math.min(gfc.ResvSize, gfc.ResvMax);\n\n\t\tif (fullFrameBits > maxmp3buf)\n\t\t\tfullFrameBits = maxmp3buf;\n\n\n\t\tl3_side.resvDrain_pre = 0;\n\n\t\t// frame analyzer code\n\t\tif (gfc.pinfo != null) {\n\t\t\t/*\n\t\t\t * expected bits per channel per granule [is this also right for\n\t\t\t * mono/stereo, MPEG-1/2 ?]\n\t\t\t */\n\t\t\tgfc.pinfo.mean_bits = mean_bits.bits / 2;\n\t\t\tgfc.pinfo.resvsize = gfc.ResvSize;\n\t\t}\n\n\t\treturn fullFrameBits;\n\t}\n\n\t/**\n\t * returns targ_bits: target number of bits to use for 1 granule<BR>\n\t * extra_bits: amount extra available from reservoir<BR>\n\t * Mark Taylor 4/99\n\t */\n\tthis.ResvMaxBits = function(gfp, mean_bits, targ_bits, cbr) {\n\t\tvar gfc = gfp.internal_flags;\n\t\tvar add_bits;\n        var ResvSize = gfc.ResvSize, ResvMax = gfc.ResvMax;\n\n\t\t/* compensate the saved bits used in the 1st granule */\n\t\tif (cbr != 0)\n\t\t\tResvSize += mean_bits;\n\n\t\tif ((gfc.substep_shaping & 1) != 0)\n\t\t\tResvMax *= 0.9;\n\n\t\ttarg_bits.bits = mean_bits;\n\n\t\t/* extra bits if the reservoir is almost full */\n\t\tif (ResvSize * 10 > ResvMax * 9) {\n\t\t\tadd_bits = ResvSize - (ResvMax * 9) / 10;\n\t\t\ttarg_bits.bits += add_bits;\n\t\t\tgfc.substep_shaping |= 0x80;\n\t\t} else {\n\t\t\tadd_bits = 0;\n\t\t\tgfc.substep_shaping &= 0x7f;\n\t\t\t/*\n\t\t\t * build up reservoir. this builds the reservoir a little slower\n\t\t\t * than FhG. It could simple be mean_bits/15, but this was rigged to\n\t\t\t * always produce 100 (the old value) at 128kbs\n\t\t\t */\n\t\t\tif (!gfp.disable_reservoir && 0 == (gfc.substep_shaping & 1))\n\t\t\t\ttarg_bits.bits -= .1 * mean_bits;\n\t\t}\n\n\t\t/* amount from the reservoir we are allowed to use. ISO says 6/10 */\n\t\tvar extra_bits = (ResvSize < (gfc.ResvMax * 6) / 10 ? ResvSize\n\t\t\t\t: (gfc.ResvMax * 6) / 10);\n\t\textra_bits -= add_bits;\n\n\t\tif (extra_bits < 0)\n\t\t\textra_bits = 0;\n\t\treturn extra_bits;\n\t}\n\n\t/**\n\t * Called after a granule's bit allocation. Readjusts the size of the\n\t * reservoir to reflect the granule's usage.\n\t */\n\tthis.ResvAdjust = function(gfc, gi) {\n\t\tgfc.ResvSize -= gi.part2_3_length + gi.part2_length;\n\t}\n\n\t/**\n\t * Called after all granules in a frame have been allocated. Makes sure that\n\t * the reservoir size is within limits, possibly by adding stuffing bits.\n\t */\n\tthis.ResvFrameEnd = function(gfc, mean_bits) {\n\t\tvar over_bits;\n\t\tvar l3_side = gfc.l3_side;\n\n\t\tgfc.ResvSize += mean_bits * gfc.mode_gr;\n\t\tvar stuffingBits = 0;\n\t\tl3_side.resvDrain_post = 0;\n\t\tl3_side.resvDrain_pre = 0;\n\n\t\t/* we must be byte aligned */\n\t\tif ((over_bits = gfc.ResvSize % 8) != 0)\n\t\t\tstuffingBits += over_bits;\n\n\t\tover_bits = (gfc.ResvSize - stuffingBits) - gfc.ResvMax;\n\t\tif (over_bits > 0) {\n\t\t\tstuffingBits += over_bits;\n\t\t}\n\n\t\t/*\n\t\t * NOTE: enabling the NEW_DRAIN code fixes some problems with FhG\n\t\t * decoder shipped with MS Windows operating systems. Using this, it is\n\t\t * even possible to use Gabriel's lax buffer consideration again, which\n\t\t * assumes, any decoder should have a buffer large enough for a 320 kbps\n\t\t * frame at 32 kHz sample rate.\n\t\t * \n\t\t * old drain code: lame -b320 BlackBird.wav --. does not play with\n\t\t * GraphEdit.exe using FhG decoder V1.5 Build 50\n\t\t * \n\t\t * new drain code: lame -b320 BlackBird.wav --. plays fine with\n\t\t * GraphEdit.exe using FhG decoder V1.5 Build 50\n\t\t * \n\t\t * Robert Hegemann, 2010-02-13.\n\t\t */\n\t\t/*\n\t\t * drain as many bits as possible into previous frame ancillary data In\n\t\t * particular, in VBR mode ResvMax may have changed, and we have to make\n\t\t * sure main_data_begin does not create a reservoir bigger than ResvMax\n\t\t * mt 4/00\n\t\t */\n\t\t{\n\t\t\tvar mdb_bytes = Math.min(l3_side.main_data_begin * 8, stuffingBits) / 8;\n\t\t\tl3_side.resvDrain_pre += 8 * mdb_bytes;\n\t\t\tstuffingBits -= 8 * mdb_bytes;\n\t\t\tgfc.ResvSize -= 8 * mdb_bytes;\n\t\t\tl3_side.main_data_begin -= mdb_bytes;\n\t\t}\n\t\t/* drain the rest into this frames ancillary data */\n\t\tl3_side.resvDrain_post += stuffingBits;\n\t\tgfc.ResvSize -= stuffingBits;\n\t}\n}\n\n\n/**\n * A Vbr header may be present in the ancillary data field of the first frame of\n * an mp3 bitstream<BR>\n * The Vbr header (optionally) contains\n * <UL>\n * <LI>frames total number of audio frames in the bitstream\n * <LI>bytes total number of bytes in the bitstream\n * <LI>toc table of contents\n * </UL>\n *\n * toc (table of contents) gives seek points for random access.<BR>\n * The ith entry determines the seek point for i-percent duration.<BR>\n * seek point in bytes = (toc[i]/256.0) * total_bitstream_bytes<BR>\n * e.g. half duration seek point = (toc[50]/256.0) * total_bitstream_bytes\n */\nVBRTag.NUMTOCENTRIES = 100;\nVBRTag.MAXFRAMESIZE = 2880;\n\nfunction VBRTag() {\n\n    var lame;\n    var bs;\n    var v;\n\n    this.setModules = function (_lame, _bs, _v) {\n        lame = _lame;\n        bs = _bs;\n        v = _v;\n    };\n\t\n\t//fix 精简\n\t\n    /**\n     * Lookup table for fast CRC-16 computation. Uses the polynomial\n     * x^16+x^15+x^2+1\n     */\n    var crc16Lookup = [0x0000, 0xC0C1, 0xC181, 0x0140,\n        0xC301, 0x03C0, 0x0280, 0xC241, 0xC601, 0x06C0, 0x0780, 0xC741,\n        0x0500, 0xC5C1, 0xC481, 0x0440, 0xCC01, 0x0CC0, 0x0D80, 0xCD41,\n        0x0F00, 0xCFC1, 0xCE81, 0x0E40, 0x0A00, 0xCAC1, 0xCB81, 0x0B40,\n        0xC901, 0x09C0, 0x0880, 0xC841, 0xD801, 0x18C0, 0x1980, 0xD941,\n        0x1B00, 0xDBC1, 0xDA81, 0x1A40, 0x1E00, 0xDEC1, 0xDF81, 0x1F40,\n        0xDD01, 0x1DC0, 0x1C80, 0xDC41, 0x1400, 0xD4C1, 0xD581, 0x1540,\n        0xD701, 0x17C0, 0x1680, 0xD641, 0xD201, 0x12C0, 0x1380, 0xD341,\n        0x1100, 0xD1C1, 0xD081, 0x1040, 0xF001, 0x30C0, 0x3180, 0xF141,\n        0x3300, 0xF3C1, 0xF281, 0x3240, 0x3600, 0xF6C1, 0xF781, 0x3740,\n        0xF501, 0x35C0, 0x3480, 0xF441, 0x3C00, 0xFCC1, 0xFD81, 0x3D40,\n        0xFF01, 0x3FC0, 0x3E80, 0xFE41, 0xFA01, 0x3AC0, 0x3B80, 0xFB41,\n        0x3900, 0xF9C1, 0xF881, 0x3840, 0x2800, 0xE8C1, 0xE981, 0x2940,\n        0xEB01, 0x2BC0, 0x2A80, 0xEA41, 0xEE01, 0x2EC0, 0x2F80, 0xEF41,\n        0x2D00, 0xEDC1, 0xEC81, 0x2C40, 0xE401, 0x24C0, 0x2580, 0xE541,\n        0x2700, 0xE7C1, 0xE681, 0x2640, 0x2200, 0xE2C1, 0xE381, 0x2340,\n        0xE101, 0x21C0, 0x2080, 0xE041, 0xA001, 0x60C0, 0x6180, 0xA141,\n        0x6300, 0xA3C1, 0xA281, 0x6240, 0x6600, 0xA6C1, 0xA781, 0x6740,\n        0xA501, 0x65C0, 0x6480, 0xA441, 0x6C00, 0xACC1, 0xAD81, 0x6D40,\n        0xAF01, 0x6FC0, 0x6E80, 0xAE41, 0xAA01, 0x6AC0, 0x6B80, 0xAB41,\n        0x6900, 0xA9C1, 0xA881, 0x6840, 0x7800, 0xB8C1, 0xB981, 0x7940,\n        0xBB01, 0x7BC0, 0x7A80, 0xBA41, 0xBE01, 0x7EC0, 0x7F80, 0xBF41,\n        0x7D00, 0xBDC1, 0xBC81, 0x7C40, 0xB401, 0x74C0, 0x7580, 0xB541,\n        0x7700, 0xB7C1, 0xB681, 0x7640, 0x7200, 0xB2C1, 0xB381, 0x7340,\n        0xB101, 0x71C0, 0x7080, 0xB041, 0x5000, 0x90C1, 0x9181, 0x5140,\n        0x9301, 0x53C0, 0x5280, 0x9241, 0x9601, 0x56C0, 0x5780, 0x9741,\n        0x5500, 0x95C1, 0x9481, 0x5440, 0x9C01, 0x5CC0, 0x5D80, 0x9D41,\n        0x5F00, 0x9FC1, 0x9E81, 0x5E40, 0x5A00, 0x9AC1, 0x9B81, 0x5B40,\n        0x9901, 0x59C0, 0x5880, 0x9841, 0x8801, 0x48C0, 0x4980, 0x8941,\n        0x4B00, 0x8BC1, 0x8A81, 0x4A40, 0x4E00, 0x8EC1, 0x8F81, 0x4F40,\n        0x8D01, 0x4DC0, 0x4C80, 0x8C41, 0x4400, 0x84C1, 0x8581, 0x4540,\n        0x8701, 0x47C0, 0x4680, 0x8641, 0x8201, 0x42C0, 0x4380, 0x8341,\n        0x4100, 0x81C1, 0x8081, 0x4040];\n\t\t\n\t//fix 精简\n\t\n    /**\n     * Fast CRC-16 computation (uses table crc16Lookup).\n     *\n     * @param value\n     * @param crc\n     * @return\n     */\n    function crcUpdateLookup(value, crc) {\n        var tmp = crc ^ value;\n        crc = (crc >> 8) ^ crc16Lookup[tmp & 0xff];\n        return crc;\n    }\n\n    this.updateMusicCRC = function (crc, buffer, bufferPos, size) {\n        for (var i = 0; i < size; ++i)\n            crc[0] = crcUpdateLookup(buffer[bufferPos + i], crc[0]);\n    }\n\n\t//fix 精简\n}\n\n\n\nBitStream.EQ = function (a, b) {\n    return (Math.abs(a) > Math.abs(b)) ? (Math.abs((a) - (b)) <= (Math\n        .abs(a) * 1e-6))\n        : (Math.abs((a) - (b)) <= (Math.abs(b) * 1e-6));\n};\n\nBitStream.NEQ = function (a, b) {\n    return !BitStream.EQ(a, b);\n};\n\nfunction BitStream() {\n    var self = this;\n    var CRC16_POLYNOMIAL = 0x8005;\n\n    /*\n     * we work with ints, so when doing bit manipulation, we limit ourselves to\n     * MAX_LENGTH-2 just to be on the safe side\n     */\n    var MAX_LENGTH = 32;\n\n    //GainAnalysis ga;\n    //MPGLib mpg;\n    //Version ver;\n    //VBRTag vbr;\n    var ga = null;\n    var mpg = null;\n    var ver = null;\n    var vbr = null;\n\n    //public final void setModules(GainAnalysis ga, MPGLib mpg, Version ver,\n    //\tVBRTag vbr) {\n\n    this.setModules = function (_ga, _mpg, _ver, _vbr) {\n        ga = _ga;\n        mpg = _mpg;\n        ver = _ver;\n        vbr = _vbr;\n    };\n\n    /**\n     * Bit stream buffer.\n     */\n    //private byte[] buf;\n    var buf = null;\n    /**\n     * Bit counter of bit stream.\n     */\n    var totbit = 0;\n    /**\n     * Pointer to top byte in buffer.\n     */\n    var bufByteIdx = 0;\n    /**\n     * Pointer to top bit of top byte in buffer.\n     */\n    var bufBitIdx = 0;\n\n    /**\n     * compute bitsperframe and mean_bits for a layer III frame\n     */\n    this.getframebits = function (gfp) {\n        var gfc = gfp.internal_flags;\n        var bit_rate;\n\n        /* get bitrate in kbps [?] */\n        if (gfc.bitrate_index != 0)\n            bit_rate = Tables.bitrate_table[gfp.version][gfc.bitrate_index];\n        else\n            bit_rate = gfp.brate;\n\n        /* main encoding routine toggles padding on and off */\n        /* one Layer3 Slot consists of 8 bits */\n        var bytes = 0 | (gfp.version + 1) * 72000 * bit_rate / gfp.out_samplerate + gfc.padding;\n        return 8 * bytes;\n    };\n\n    function putheader_bits(gfc) {\n        System.arraycopy(gfc.header[gfc.w_ptr].buf, 0, buf, bufByteIdx, gfc.sideinfo_len);\n        bufByteIdx += gfc.sideinfo_len;\n        totbit += gfc.sideinfo_len * 8;\n        gfc.w_ptr = (gfc.w_ptr + 1) & (LameInternalFlags.MAX_HEADER_BUF - 1);\n    }\n\n    /**\n     * write j bits into the bit stream\n     */\n    function putbits2(gfc, val, j) {\n\n\n        while (j > 0) {\n            var k;\n            if (bufBitIdx == 0) {\n                bufBitIdx = 8;\n                bufByteIdx++;\n                if (gfc.header[gfc.w_ptr].write_timing == totbit) {\n                    putheader_bits(gfc);\n                }\n                buf[bufByteIdx] = 0;\n            }\n\n            k = Math.min(j, bufBitIdx);\n            j -= k;\n\n            bufBitIdx -= k;\n\n            /* 32 too large on 32 bit machines */\n\n            buf[bufByteIdx] |= ((val >> j) << bufBitIdx);\n            totbit += k;\n        }\n    }\n\n    /**\n     * write j bits into the bit stream, ignoring frame headers\n     */\n    function putbits_noheaders(gfc, val, j) {\n\n        while (j > 0) {\n            var k;\n            if (bufBitIdx == 0) {\n                bufBitIdx = 8;\n                bufByteIdx++;\n                buf[bufByteIdx] = 0;\n            }\n\n            k = Math.min(j, bufBitIdx);\n            j -= k;\n\n            bufBitIdx -= k;\n\n            /* 32 too large on 32 bit machines */\n\n            buf[bufByteIdx] |= ((val >> j) << bufBitIdx);\n            totbit += k;\n        }\n    }\n\n    /**\n     * Some combinations of bitrate, Fs, and stereo make it impossible to stuff\n     * out a frame using just main_data, due to the limited number of bits to\n     * indicate main_data_length. In these situations, we put stuffing bits into\n     * the ancillary data...\n     */\n    function drain_into_ancillary(gfp, remainingBits) {\n        var gfc = gfp.internal_flags;\n        var i;\n\n        if (remainingBits >= 8) {\n            putbits2(gfc, 0x4c, 8);\n            remainingBits -= 8;\n        }\n        if (remainingBits >= 8) {\n            putbits2(gfc, 0x41, 8);\n            remainingBits -= 8;\n        }\n        if (remainingBits >= 8) {\n            putbits2(gfc, 0x4d, 8);\n            remainingBits -= 8;\n        }\n        if (remainingBits >= 8) {\n            putbits2(gfc, 0x45, 8);\n            remainingBits -= 8;\n        }\n\n        if (remainingBits >= 32) {\n            var version = ver.getLameShortVersion();\n            if (remainingBits >= 32)\n                for (i = 0; i < version.length && remainingBits >= 8; ++i) {\n                    remainingBits -= 8;\n                    putbits2(gfc, version.charCodeAt(i), 8); //fix 错误的使用charAt\n                }\n        }\n\n        for (; remainingBits >= 1; remainingBits -= 1) {\n            putbits2(gfc, gfc.ancillary_flag, 1);\n            gfc.ancillary_flag ^= (!gfp.disable_reservoir ? 1 : 0);\n        }\n\n\n    }\n\n    /**\n     * write N bits into the header\n     */\n    function writeheader(gfc, val, j) {\n        var ptr = gfc.header[gfc.h_ptr].ptr;\n\n        while (j > 0) {\n            var k = Math.min(j, 8 - (ptr & 7));\n            j -= k;\n            /* >> 32 too large for 32 bit machines */\n\n            gfc.header[gfc.h_ptr].buf[ptr >> 3] |= ((val >> j)) << (8 - (ptr & 7) - k);\n            ptr += k;\n        }\n        gfc.header[gfc.h_ptr].ptr = ptr;\n    }\n\n    function CRC_update(value, crc) {\n        value <<= 8;\n        for (var i = 0; i < 8; i++) {\n            value <<= 1;\n            crc <<= 1;\n\n            if ((((crc ^ value) & 0x10000) != 0))\n                crc ^= CRC16_POLYNOMIAL;\n        }\n        return crc;\n    }\n\n    this.CRC_writeheader = function (gfc, header) {\n        var crc = 0xffff;\n        /* (jo) init crc16 for error_protection */\n\n        crc = CRC_update(header[2] & 0xff, crc);\n        crc = CRC_update(header[3] & 0xff, crc);\n        for (var i = 6; i < gfc.sideinfo_len; i++) {\n            crc = CRC_update(header[i] & 0xff, crc);\n        }\n\n        header[4] = (byte)(crc >> 8);\n        header[5] = (byte)(crc & 255);\n    };\n\n    function encodeSideInfo2(gfp, bitsPerFrame) {\n        var gfc = gfp.internal_flags;\n        var l3_side;\n        var gr, ch;\n\n        l3_side = gfc.l3_side;\n        gfc.header[gfc.h_ptr].ptr = 0;\n        Arrays.fill(gfc.header[gfc.h_ptr].buf, 0, gfc.sideinfo_len, 0);\n        if (gfp.out_samplerate < 16000)\n            writeheader(gfc, 0xffe, 12);\n        else\n            writeheader(gfc, 0xfff, 12);\n        writeheader(gfc, (gfp.version), 1);\n        writeheader(gfc, 4 - 3, 2);\n        writeheader(gfc, (!gfp.error_protection ? 1 : 0), 1);\n        writeheader(gfc, (gfc.bitrate_index), 4);\n        writeheader(gfc, (gfc.samplerate_index), 2);\n        writeheader(gfc, (gfc.padding), 1);\n        writeheader(gfc, (gfp.extension), 1);\n        writeheader(gfc, (gfp.mode.ordinal()), 2);\n        writeheader(gfc, (gfc.mode_ext), 2);\n        writeheader(gfc, (gfp.copyright), 1);\n        writeheader(gfc, (gfp.original), 1);\n        writeheader(gfc, (gfp.emphasis), 2);\n        if (gfp.error_protection) {\n            writeheader(gfc, 0, 16);\n            /* dummy */\n        }\n\n        if (gfp.version == 1) {\n            /* MPEG1 */\n            writeheader(gfc, (l3_side.main_data_begin), 9);\n\n            if (gfc.channels_out == 2)\n                writeheader(gfc, l3_side.private_bits, 3);\n            else\n                writeheader(gfc, l3_side.private_bits, 5);\n\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                var band;\n                for (band = 0; band < 4; band++) {\n                    writeheader(gfc, l3_side.scfsi[ch][band], 1);\n                }\n            }\n\n            for (gr = 0; gr < 2; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    var gi = l3_side.tt[gr][ch];\n                    writeheader(gfc, gi.part2_3_length + gi.part2_length, 12);\n                    writeheader(gfc, gi.big_values / 2, 9);\n                    writeheader(gfc, gi.global_gain, 8);\n                    writeheader(gfc, gi.scalefac_compress, 4);\n\n                    if (gi.block_type != Encoder.NORM_TYPE) {\n                        writeheader(gfc, 1, 1);\n                        /* window_switching_flag */\n                        writeheader(gfc, gi.block_type, 2);\n                        writeheader(gfc, gi.mixed_block_flag, 1);\n\n                        if (gi.table_select[0] == 14)\n                            gi.table_select[0] = 16;\n                        writeheader(gfc, gi.table_select[0], 5);\n                        if (gi.table_select[1] == 14)\n                            gi.table_select[1] = 16;\n                        writeheader(gfc, gi.table_select[1], 5);\n\n                        writeheader(gfc, gi.subblock_gain[0], 3);\n                        writeheader(gfc, gi.subblock_gain[1], 3);\n                        writeheader(gfc, gi.subblock_gain[2], 3);\n                    } else {\n                        writeheader(gfc, 0, 1);\n                        /* window_switching_flag */\n                        if (gi.table_select[0] == 14)\n                            gi.table_select[0] = 16;\n                        writeheader(gfc, gi.table_select[0], 5);\n                        if (gi.table_select[1] == 14)\n                            gi.table_select[1] = 16;\n                        writeheader(gfc, gi.table_select[1], 5);\n                        if (gi.table_select[2] == 14)\n                            gi.table_select[2] = 16;\n                        writeheader(gfc, gi.table_select[2], 5);\n\n                        writeheader(gfc, gi.region0_count, 4);\n                        writeheader(gfc, gi.region1_count, 3);\n                    }\n                    writeheader(gfc, gi.preflag, 1);\n                    writeheader(gfc, gi.scalefac_scale, 1);\n                    writeheader(gfc, gi.count1table_select, 1);\n                }\n            }\n        } else {\n            /* MPEG2 */\n            writeheader(gfc, (l3_side.main_data_begin), 8);\n            writeheader(gfc, l3_side.private_bits, gfc.channels_out);\n\n            gr = 0;\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                var gi = l3_side.tt[gr][ch];\n                writeheader(gfc, gi.part2_3_length + gi.part2_length, 12);\n                writeheader(gfc, gi.big_values / 2, 9);\n                writeheader(gfc, gi.global_gain, 8);\n                writeheader(gfc, gi.scalefac_compress, 9);\n\n                if (gi.block_type != Encoder.NORM_TYPE) {\n                    writeheader(gfc, 1, 1);\n                    /* window_switching_flag */\n                    writeheader(gfc, gi.block_type, 2);\n                    writeheader(gfc, gi.mixed_block_flag, 1);\n\n                    if (gi.table_select[0] == 14)\n                        gi.table_select[0] = 16;\n                    writeheader(gfc, gi.table_select[0], 5);\n                    if (gi.table_select[1] == 14)\n                        gi.table_select[1] = 16;\n                    writeheader(gfc, gi.table_select[1], 5);\n\n                    writeheader(gfc, gi.subblock_gain[0], 3);\n                    writeheader(gfc, gi.subblock_gain[1], 3);\n                    writeheader(gfc, gi.subblock_gain[2], 3);\n                } else {\n                    writeheader(gfc, 0, 1);\n                    /* window_switching_flag */\n                    if (gi.table_select[0] == 14)\n                        gi.table_select[0] = 16;\n                    writeheader(gfc, gi.table_select[0], 5);\n                    if (gi.table_select[1] == 14)\n                        gi.table_select[1] = 16;\n                    writeheader(gfc, gi.table_select[1], 5);\n                    if (gi.table_select[2] == 14)\n                        gi.table_select[2] = 16;\n                    writeheader(gfc, gi.table_select[2], 5);\n\n                    writeheader(gfc, gi.region0_count, 4);\n                    writeheader(gfc, gi.region1_count, 3);\n                }\n\n                writeheader(gfc, gi.scalefac_scale, 1);\n                writeheader(gfc, gi.count1table_select, 1);\n            }\n        }\n\n        if (gfp.error_protection) {\n            /* (jo) error_protection: add crc16 information to header */\n            CRC_writeheader(gfc, gfc.header[gfc.h_ptr].buf);\n        }\n\n        {\n            var old = gfc.h_ptr;\n\n            gfc.h_ptr = (old + 1) & (LameInternalFlags.MAX_HEADER_BUF - 1);\n            gfc.header[gfc.h_ptr].write_timing = gfc.header[old].write_timing\n                + bitsPerFrame;\n\n            if (gfc.h_ptr == gfc.w_ptr) {\n                /* yikes! we are out of header buffer space */\n                System.err\n                    .println(\"Error: MAX_HEADER_BUF too small in bitstream.c \\n\");\n            }\n\n        }\n    }\n\n    function huffman_coder_count1(gfc, gi) {\n        /* Write count1 area */\n        var h = Tables.ht[gi.count1table_select + 32];\n        var i, bits = 0;\n\n        var ix = gi.big_values;\n        var xr = gi.big_values;\n\n        for (i = (gi.count1 - gi.big_values) / 4; i > 0; --i) {\n            var huffbits = 0;\n            var p = 0, v;\n\n            v = gi.l3_enc[ix + 0];\n            if (v != 0) {\n                p += 8;\n                if (gi.xr[xr + 0] < 0)\n                    huffbits++;\n            }\n\n            v = gi.l3_enc[ix + 1];\n            if (v != 0) {\n                p += 4;\n                huffbits *= 2;\n                if (gi.xr[xr + 1] < 0)\n                    huffbits++;\n            }\n\n            v = gi.l3_enc[ix + 2];\n            if (v != 0) {\n                p += 2;\n                huffbits *= 2;\n                if (gi.xr[xr + 2] < 0)\n                    huffbits++;\n            }\n\n            v = gi.l3_enc[ix + 3];\n            if (v != 0) {\n                p++;\n                huffbits *= 2;\n                if (gi.xr[xr + 3] < 0)\n                    huffbits++;\n            }\n\n            ix += 4;\n            xr += 4;\n            putbits2(gfc, huffbits + h.table[p], h.hlen[p]);\n            bits += h.hlen[p];\n        }\n        return bits;\n    }\n\n    /**\n     * Implements the pseudocode of page 98 of the IS\n     */\n    function Huffmancode(gfc, tableindex, start, end, gi) {\n        var h = Tables.ht[tableindex];\n        var bits = 0;\n\n        if (0 == tableindex)\n            return bits;\n\n        for (var i = start; i < end; i += 2) {\n            var cbits = 0;\n            var xbits = 0;\n            var linbits = h.xlen;\n            var xlen = h.xlen;\n            var ext = 0;\n            var x1 = gi.l3_enc[i];\n            var x2 = gi.l3_enc[i + 1];\n\n            if (x1 != 0) {\n                if (gi.xr[i] < 0)\n                    ext++;\n                cbits--;\n            }\n\n            if (tableindex > 15) {\n                /* use ESC-words */\n                if (x1 > 14) {\n                    var linbits_x1 = x1 - 15;\n                    ext |= linbits_x1 << 1;\n                    xbits = linbits;\n                    x1 = 15;\n                }\n\n                if (x2 > 14) {\n                    var linbits_x2 = x2 - 15;\n                    ext <<= linbits;\n                    ext |= linbits_x2;\n                    xbits += linbits;\n                    x2 = 15;\n                }\n                xlen = 16;\n            }\n\n            if (x2 != 0) {\n                ext <<= 1;\n                if (gi.xr[i + 1] < 0)\n                    ext++;\n                cbits--;\n            }\n\n\n            x1 = x1 * xlen + x2;\n            xbits -= cbits;\n            cbits += h.hlen[x1];\n\n\n            putbits2(gfc, h.table[x1], cbits);\n            putbits2(gfc, ext, xbits);\n            bits += cbits + xbits;\n        }\n        return bits;\n    }\n\n    /**\n     * Note the discussion of huffmancodebits() on pages 28 and 29 of the IS, as\n     * well as the definitions of the side information on pages 26 and 27.\n     */\n    function ShortHuffmancodebits(gfc, gi) {\n        var region1Start = 3 * gfc.scalefac_band.s[3];\n        if (region1Start > gi.big_values)\n            region1Start = gi.big_values;\n\n        /* short blocks do not have a region2 */\n        var bits = Huffmancode(gfc, gi.table_select[0], 0, region1Start, gi);\n        bits += Huffmancode(gfc, gi.table_select[1], region1Start,\n            gi.big_values, gi);\n        return bits;\n    }\n\n    function LongHuffmancodebits(gfc, gi) {\n        var bigvalues, bits;\n        var region1Start, region2Start;\n\n        bigvalues = gi.big_values;\n\n        var i = gi.region0_count + 1;\n        region1Start = gfc.scalefac_band.l[i];\n        i += gi.region1_count + 1;\n        region2Start = gfc.scalefac_band.l[i];\n\n        if (region1Start > bigvalues)\n            region1Start = bigvalues;\n\n        if (region2Start > bigvalues)\n            region2Start = bigvalues;\n\n        bits = Huffmancode(gfc, gi.table_select[0], 0, region1Start, gi);\n        bits += Huffmancode(gfc, gi.table_select[1], region1Start,\n            region2Start, gi);\n        bits += Huffmancode(gfc, gi.table_select[2], region2Start, bigvalues,\n            gi);\n        return bits;\n    }\n\n    function writeMainData(gfp) {\n        var gr, ch, sfb, data_bits, tot_bits = 0;\n        var gfc = gfp.internal_flags;\n        var l3_side = gfc.l3_side;\n\n        if (gfp.version == 1) {\n            /* MPEG 1 */\n            for (gr = 0; gr < 2; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    var gi = l3_side.tt[gr][ch];\n                    var slen1 = Takehiro.slen1_tab[gi.scalefac_compress];\n                    var slen2 = Takehiro.slen2_tab[gi.scalefac_compress];\n                    data_bits = 0;\n                    for (sfb = 0; sfb < gi.sfbdivide; sfb++) {\n                        if (gi.scalefac[sfb] == -1)\n                            continue;\n                        /* scfsi is used */\n                        putbits2(gfc, gi.scalefac[sfb], slen1);\n                        data_bits += slen1;\n                    }\n                    for (; sfb < gi.sfbmax; sfb++) {\n                        if (gi.scalefac[sfb] == -1)\n                            continue;\n                        /* scfsi is used */\n                        putbits2(gfc, gi.scalefac[sfb], slen2);\n                        data_bits += slen2;\n                    }\n\n                    if (gi.block_type == Encoder.SHORT_TYPE) {\n                        data_bits += ShortHuffmancodebits(gfc, gi);\n                    } else {\n                        data_bits += LongHuffmancodebits(gfc, gi);\n                    }\n                    data_bits += huffman_coder_count1(gfc, gi);\n                    /* does bitcount in quantize.c agree with actual bit count? */\n                    tot_bits += data_bits;\n                }\n                /* for ch */\n            }\n            /* for gr */\n        } else {\n            /* MPEG 2 */\n            gr = 0;\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                var gi = l3_side.tt[gr][ch];\n                var i, sfb_partition, scale_bits = 0;\n                data_bits = 0;\n                sfb = 0;\n                sfb_partition = 0;\n\n                if (gi.block_type == Encoder.SHORT_TYPE) {\n                    for (; sfb_partition < 4; sfb_partition++) {\n                        var sfbs = gi.sfb_partition_table[sfb_partition] / 3;\n                        var slen = gi.slen[sfb_partition];\n                        for (i = 0; i < sfbs; i++, sfb++) {\n                            putbits2(gfc,\n                                Math.max(gi.scalefac[sfb * 3 + 0], 0), slen);\n                            putbits2(gfc,\n                                Math.max(gi.scalefac[sfb * 3 + 1], 0), slen);\n                            putbits2(gfc,\n                                Math.max(gi.scalefac[sfb * 3 + 2], 0), slen);\n                            scale_bits += 3 * slen;\n                        }\n                    }\n                    data_bits += ShortHuffmancodebits(gfc, gi);\n                } else {\n                    for (; sfb_partition < 4; sfb_partition++) {\n                        var sfbs = gi.sfb_partition_table[sfb_partition];\n                        var slen = gi.slen[sfb_partition];\n                        for (i = 0; i < sfbs; i++, sfb++) {\n                            putbits2(gfc, Math.max(gi.scalefac[sfb], 0), slen);\n                            scale_bits += slen;\n                        }\n                    }\n                    data_bits += LongHuffmancodebits(gfc, gi);\n                }\n                data_bits += huffman_coder_count1(gfc, gi);\n                /* does bitcount in quantize.c agree with actual bit count? */\n                tot_bits += scale_bits + data_bits;\n            }\n            /* for ch */\n        }\n        /* for gf */\n        return tot_bits;\n    }\n\n    /* main_data */\n\n    function TotalBytes() {\n        this.total = 0;\n    }\n\n    /*\n     * compute the number of bits required to flush all mp3 frames currently in\n     * the buffer. This should be the same as the reservoir size. Only call this\n     * routine between frames - i.e. only after all headers and data have been\n     * added to the buffer by format_bitstream().\n     *\n     * Also compute total_bits_output = size of mp3 buffer (including frame\n     * headers which may not have yet been send to the mp3 buffer) + number of\n     * bits needed to flush all mp3 frames.\n     *\n     * total_bytes_output is the size of the mp3 output buffer if\n     * lame_encode_flush_nogap() was called right now.\n     */\n    function compute_flushbits(gfp, total_bytes_output) {\n        var gfc = gfp.internal_flags;\n        var flushbits, remaining_headers;\n        var bitsPerFrame;\n        var last_ptr, first_ptr;\n        first_ptr = gfc.w_ptr;\n        /* first header to add to bitstream */\n        last_ptr = gfc.h_ptr - 1;\n        /* last header to add to bitstream */\n        if (last_ptr == -1)\n            last_ptr = LameInternalFlags.MAX_HEADER_BUF - 1;\n\n        /* add this many bits to bitstream so we can flush all headers */\n        flushbits = gfc.header[last_ptr].write_timing - totbit;\n        total_bytes_output.total = flushbits;\n\n        if (flushbits >= 0) {\n            /* if flushbits >= 0, some headers have not yet been written */\n            /* reduce flushbits by the size of the headers */\n            remaining_headers = 1 + last_ptr - first_ptr;\n            if (last_ptr < first_ptr)\n                remaining_headers = 1 + last_ptr - first_ptr\n                    + LameInternalFlags.MAX_HEADER_BUF;\n            flushbits -= remaining_headers * 8 * gfc.sideinfo_len;\n        }\n\n        /*\n         * finally, add some bits so that the last frame is complete these bits\n         * are not necessary to decode the last frame, but some decoders will\n         * ignore last frame if these bits are missing\n         */\n        bitsPerFrame = self.getframebits(gfp);\n        flushbits += bitsPerFrame;\n        total_bytes_output.total += bitsPerFrame;\n        /* round up: */\n        if ((total_bytes_output.total % 8) != 0)\n            total_bytes_output.total = 1 + (total_bytes_output.total / 8);\n        else\n            total_bytes_output.total = (total_bytes_output.total / 8);\n        total_bytes_output.total += bufByteIdx + 1;\n\n        if (flushbits < 0) {\n            System.err.println(\"strange error flushing buffer ... \\n\");\n        }\n        return flushbits;\n    }\n\n    this.flush_bitstream = function (gfp) {\n        var gfc = gfp.internal_flags;\n        var l3_side;\n        var flushbits;\n        var last_ptr = gfc.h_ptr - 1;\n        /* last header to add to bitstream */\n        if (last_ptr == -1)\n            last_ptr = LameInternalFlags.MAX_HEADER_BUF - 1;\n        l3_side = gfc.l3_side;\n\n        if ((flushbits = compute_flushbits(gfp, new TotalBytes())) < 0)\n            return;\n        drain_into_ancillary(gfp, flushbits);\n\n        /* check that the 100% of the last frame has been written to bitstream */\n\n        /*\n         * we have padded out all frames with ancillary data, which is the same\n         * as filling the bitreservoir with ancillary data, so :\n         */\n        gfc.ResvSize = 0;\n        l3_side.main_data_begin = 0;\n\n        /* save the ReplayGain value */\n        if (gfc.findReplayGain) {\n            var RadioGain = ga.GetTitleGain(gfc.rgdata);\n            gfc.RadioGain = Math.floor(RadioGain * 10.0 + 0.5) | 0;\n            /* round to nearest */\n        }\n\n        /* find the gain and scale change required for no clipping */\n        if (gfc.findPeakSample) {\n            gfc.noclipGainChange = Math.ceil(\n                        Math_log10(gfc.PeakSample / 32767.0) * 20.0 * 10.0) | 0;\n            /* round up */\n\n            if (gfc.noclipGainChange > 0) {\n                /* clipping occurs */\n                if (EQ(gfp.scale, 1.0) || EQ(gfp.scale, 0.0))\n                    gfc.noclipScale = (Math\n                        .floor((32767.0 / gfc.PeakSample) * 100.0) / 100.0);\n                /* round down */\n                else {\n                    /*\n                     * the user specified his own scaling factor. We could\n                     * suggest the scaling factor of\n                     * (32767.0/gfp.PeakSample)*(gfp.scale) but it's usually\n                     * very inaccurate. So we'd rather not advice him on the\n                     * scaling factor.\n                     */\n                    gfc.noclipScale = -1;\n                }\n            } else\n            /* no clipping */\n                gfc.noclipScale = -1;\n        }\n    };\n\n    this.add_dummy_byte = function (gfp, val, n) {\n        var gfc = gfp.internal_flags;\n        var i;\n\n        while (n-- > 0) {\n            putbits_noheaders(gfc, val, 8);\n\n            for (i = 0; i < LameInternalFlags.MAX_HEADER_BUF; ++i)\n                gfc.header[i].write_timing += 8;\n        }\n    };\n\n    /**\n     * This is called after a frame of audio has been quantized and coded. It\n     * will write the encoded audio to the bitstream. Note that from a layer3\n     * encoder's perspective the bit stream is primarily a series of main_data()\n     * blocks, with header and side information inserted at the proper locations\n     * to maintain framing. (See Figure A.7 in the IS).\n     */\n    this.format_bitstream = function (gfp) {\n        var gfc = gfp.internal_flags;\n        var l3_side;\n        l3_side = gfc.l3_side;\n\n        var bitsPerFrame = this.getframebits(gfp);\n        drain_into_ancillary(gfp, l3_side.resvDrain_pre);\n\n        encodeSideInfo2(gfp, bitsPerFrame);\n        var bits = 8 * gfc.sideinfo_len;\n        bits += writeMainData(gfp);\n        drain_into_ancillary(gfp, l3_side.resvDrain_post);\n        bits += l3_side.resvDrain_post;\n\n        l3_side.main_data_begin += (bitsPerFrame - bits) / 8;\n\n        /*\n         * compare number of bits needed to clear all buffered mp3 frames with\n         * what we think the resvsize is:\n         */\n        if (compute_flushbits(gfp, new TotalBytes()) != gfc.ResvSize) {\n            System.err.println(\"Internal buffer inconsistency. flushbits <> ResvSize\");\n        }\n\n        /*\n         * compare main_data_begin for the next frame with what we think the\n         * resvsize is:\n         */\n        if ((l3_side.main_data_begin * 8) != gfc.ResvSize) {\n            System.err.printf(\"bit reservoir error: \\n\"\n                + \"l3_side.main_data_begin: %d \\n\"\n                + \"Resvoir size:             %d \\n\"\n                + \"resv drain (post)         %d \\n\"\n                + \"resv drain (pre)          %d \\n\"\n                + \"header and sideinfo:      %d \\n\"\n                + \"data bits:                %d \\n\"\n                + \"total bits:               %d (remainder: %d) \\n\"\n                + \"bitsperframe:             %d \\n\",\n                8 * l3_side.main_data_begin, gfc.ResvSize,\n                l3_side.resvDrain_post, l3_side.resvDrain_pre,\n                8 * gfc.sideinfo_len, bits - l3_side.resvDrain_post - 8\n                * gfc.sideinfo_len, bits, bits % 8, bitsPerFrame);\n\n            System.err.println(\"This is a fatal error.  It has several possible causes:\");\n            System.err.println(\"90%%  LAME compiled with buggy version of gcc using advanced optimizations\");\n            System.err.println(\" 9%%  Your system is overclocked\");\n            System.err.println(\" 1%%  bug in LAME encoding library\");\n\n            gfc.ResvSize = l3_side.main_data_begin * 8;\n        }\n        //;\n\n        if (totbit > 1000000000) {\n            /*\n             * to avoid totbit overflow, (at 8h encoding at 128kbs) lets reset\n             * bit counter\n             */\n            var i;\n            for (i = 0; i < LameInternalFlags.MAX_HEADER_BUF; ++i)\n                gfc.header[i].write_timing -= totbit;\n            totbit = 0;\n        }\n\n        return 0;\n    };\n\n    /**\n     * <PRE>\n     * copy data out of the internal MP3 bit buffer into a user supplied\n     *       unsigned char buffer.\n     *\n     *       mp3data=0      indicates data in buffer is an id3tags and VBR tags\n     *       mp3data=1      data is real mp3 frame data.\n     * </PRE>\n     */\n    this.copy_buffer = function (gfc, buffer, bufferPos, size, mp3data) {\n        var minimum = bufByteIdx + 1;\n        if (minimum <= 0)\n            return 0;\n        if (size != 0 && minimum > size) {\n            /* buffer is too small */\n            return -1;\n        }\n        System.arraycopy(buf, 0, buffer, bufferPos, minimum);\n        bufByteIdx = -1;\n        bufBitIdx = 0;\n\n        if (mp3data != 0) {\n            var crc = new_int(1);\n            crc[0] = gfc.nMusicCRC;\n            vbr.updateMusicCRC(crc, buffer, bufferPos, minimum);\n            gfc.nMusicCRC = crc[0];\n\n            /**\n             * sum number of bytes belonging to the mp3 stream this info will be\n             * written into the Xing/LAME header for seeking\n             */\n            if (minimum > 0) {\n                gfc.VBR_seek_table.nBytesWritten += minimum;\n            }\n\n            if (gfc.decode_on_the_fly) { /* decode the frame */\n                var pcm_buf = new_float_n([2, 1152]);\n                var mp3_in = minimum;\n                var samples_out = -1;\n                var i;\n\n                /* re-synthesis to pcm. Repeat until we get a samples_out=0 */\n                while (samples_out != 0) {\n\n                    samples_out = mpg.hip_decode1_unclipped(gfc.hip, buffer,\n                        bufferPos, mp3_in, pcm_buf[0], pcm_buf[1]);\n                    /*\n                     * samples_out = 0: need more data to decode samples_out =\n                     * -1: error. Lets assume 0 pcm output samples_out = number\n                     * of samples output\n                     */\n\n                    /*\n                     * set the lenght of the mp3 input buffer to zero, so that\n                     * in the next iteration of the loop we will be querying\n                     * mpglib about buffered data\n                     */\n                    mp3_in = 0;\n\n                    if (samples_out == -1) {\n                        /*\n                         * error decoding. Not fatal, but might screw up the\n                         * ReplayGain tag. What should we do? Ignore for now\n                         */\n                        samples_out = 0;\n                    }\n                    if (samples_out > 0) {\n                        /* process the PCM data */\n\n                        /*\n                         * this should not be possible, and indicates we have\n                         * overflown the pcm_buf buffer\n                         */\n\n                        if (gfc.findPeakSample) {\n                            for (i = 0; i < samples_out; i++) {\n                                if (pcm_buf[0][i] > gfc.PeakSample)\n                                    gfc.PeakSample = pcm_buf[0][i];\n                                else if (-pcm_buf[0][i] > gfc.PeakSample)\n                                    gfc.PeakSample = -pcm_buf[0][i];\n                            }\n                            if (gfc.channels_out > 1)\n                                for (i = 0; i < samples_out; i++) {\n                                    if (pcm_buf[1][i] > gfc.PeakSample)\n                                        gfc.PeakSample = pcm_buf[1][i];\n                                    else if (-pcm_buf[1][i] > gfc.PeakSample)\n                                        gfc.PeakSample = -pcm_buf[1][i];\n                                }\n                        }\n\n                        if (gfc.findReplayGain)\n                            if (ga.AnalyzeSamples(gfc.rgdata, pcm_buf[0], 0,\n                                    pcm_buf[1], 0, samples_out,\n                                    gfc.channels_out) == GainAnalysis.GAIN_ANALYSIS_ERROR)\n                                return -6;\n\n                    }\n                    /* if (samples_out>0) */\n                }\n                /* while (samples_out!=0) */\n            }\n            /* if (gfc.decode_on_the_fly) */\n\n        }\n        /* if (mp3data) */\n        return minimum;\n    };\n\n    this.init_bit_stream_w = function (gfc) {\n        buf = new_byte(Lame.LAME_MAXMP3BUFFER);\n\n        gfc.h_ptr = gfc.w_ptr = 0;\n        gfc.header[gfc.h_ptr].write_timing = 0;\n        bufByteIdx = -1;\n        bufBitIdx = 0;\n        totbit = 0;\n    };\n\n    // From machine.h\n\n\n}\n\nfunction HuffCodeTab(len, max, tab, hl) {\n    this.xlen = len;\n    this.linmax = max;\n    this.table = tab;\n    this.hlen = hl;\n}\n\nvar Tables = {};\n\n\nTables.t1HB = [\n    1, 1,\n    1, 0\n];\n\nTables.t2HB = [\n    1, 2, 1,\n    3, 1, 1,\n    3, 2, 0\n];\n\nTables.t3HB = [\n    3, 2, 1,\n    1, 1, 1,\n    3, 2, 0\n];\n\nTables.t5HB = [\n    1, 2, 6, 5,\n    3, 1, 4, 4,\n    7, 5, 7, 1,\n    6, 1, 1, 0\n];\n\nTables.t6HB = [\n    7, 3, 5, 1,\n    6, 2, 3, 2,\n    5, 4, 4, 1,\n    3, 3, 2, 0\n];\n\nTables.t7HB = [\n    1, 2, 10, 19, 16, 10,\n    3, 3, 7, 10, 5, 3,\n    11, 4, 13, 17, 8, 4,\n    12, 11, 18, 15, 11, 2,\n    7, 6, 9, 14, 3, 1,\n    6, 4, 5, 3, 2, 0\n];\n\nTables.t8HB = [\n    3, 4, 6, 18, 12, 5,\n    5, 1, 2, 16, 9, 3,\n    7, 3, 5, 14, 7, 3,\n    19, 17, 15, 13, 10, 4,\n    13, 5, 8, 11, 5, 1,\n    12, 4, 4, 1, 1, 0\n];\n\nTables.t9HB = [\n    7, 5, 9, 14, 15, 7,\n    6, 4, 5, 5, 6, 7,\n    7, 6, 8, 8, 8, 5,\n    15, 6, 9, 10, 5, 1,\n    11, 7, 9, 6, 4, 1,\n    14, 4, 6, 2, 6, 0\n];\n\nTables.t10HB = [\n    1, 2, 10, 23, 35, 30, 12, 17,\n    3, 3, 8, 12, 18, 21, 12, 7,\n    11, 9, 15, 21, 32, 40, 19, 6,\n    14, 13, 22, 34, 46, 23, 18, 7,\n    20, 19, 33, 47, 27, 22, 9, 3,\n    31, 22, 41, 26, 21, 20, 5, 3,\n    14, 13, 10, 11, 16, 6, 5, 1,\n    9, 8, 7, 8, 4, 4, 2, 0\n];\n\nTables.t11HB = [\n    3, 4, 10, 24, 34, 33, 21, 15,\n    5, 3, 4, 10, 32, 17, 11, 10,\n    11, 7, 13, 18, 30, 31, 20, 5,\n    25, 11, 19, 59, 27, 18, 12, 5,\n    35, 33, 31, 58, 30, 16, 7, 5,\n    28, 26, 32, 19, 17, 15, 8, 14,\n    14, 12, 9, 13, 14, 9, 4, 1,\n    11, 4, 6, 6, 6, 3, 2, 0\n];\n\nTables.t12HB = [\n    9, 6, 16, 33, 41, 39, 38, 26,\n    7, 5, 6, 9, 23, 16, 26, 11,\n    17, 7, 11, 14, 21, 30, 10, 7,\n    17, 10, 15, 12, 18, 28, 14, 5,\n    32, 13, 22, 19, 18, 16, 9, 5,\n    40, 17, 31, 29, 17, 13, 4, 2,\n    27, 12, 11, 15, 10, 7, 4, 1,\n    27, 12, 8, 12, 6, 3, 1, 0\n];\n\nTables.t13HB = [\n    1, 5, 14, 21, 34, 51, 46, 71, 42, 52, 68, 52, 67, 44, 43, 19,\n    3, 4, 12, 19, 31, 26, 44, 33, 31, 24, 32, 24, 31, 35, 22, 14,\n    15, 13, 23, 36, 59, 49, 77, 65, 29, 40, 30, 40, 27, 33, 42, 16,\n    22, 20, 37, 61, 56, 79, 73, 64, 43, 76, 56, 37, 26, 31, 25, 14,\n    35, 16, 60, 57, 97, 75, 114, 91, 54, 73, 55, 41, 48, 53, 23, 24,\n    58, 27, 50, 96, 76, 70, 93, 84, 77, 58, 79, 29, 74, 49, 41, 17,\n    47, 45, 78, 74, 115, 94, 90, 79, 69, 83, 71, 50, 59, 38, 36, 15,\n    72, 34, 56, 95, 92, 85, 91, 90, 86, 73, 77, 65, 51, 44, 43, 42,\n    43, 20, 30, 44, 55, 78, 72, 87, 78, 61, 46, 54, 37, 30, 20, 16,\n    53, 25, 41, 37, 44, 59, 54, 81, 66, 76, 57, 54, 37, 18, 39, 11,\n    35, 33, 31, 57, 42, 82, 72, 80, 47, 58, 55, 21, 22, 26, 38, 22,\n    53, 25, 23, 38, 70, 60, 51, 36, 55, 26, 34, 23, 27, 14, 9, 7,\n    34, 32, 28, 39, 49, 75, 30, 52, 48, 40, 52, 28, 18, 17, 9, 5,\n    45, 21, 34, 64, 56, 50, 49, 45, 31, 19, 12, 15, 10, 7, 6, 3,\n    48, 23, 20, 39, 36, 35, 53, 21, 16, 23, 13, 10, 6, 1, 4, 2,\n    16, 15, 17, 27, 25, 20, 29, 11, 17, 12, 16, 8, 1, 1, 0, 1\n];\n\nTables.t15HB = [\n    7, 12, 18, 53, 47, 76, 124, 108, 89, 123, 108, 119, 107, 81, 122, 63,\n    13, 5, 16, 27, 46, 36, 61, 51, 42, 70, 52, 83, 65, 41, 59, 36,\n    19, 17, 15, 24, 41, 34, 59, 48, 40, 64, 50, 78, 62, 80, 56, 33,\n    29, 28, 25, 43, 39, 63, 55, 93, 76, 59, 93, 72, 54, 75, 50, 29,\n    52, 22, 42, 40, 67, 57, 95, 79, 72, 57, 89, 69, 49, 66, 46, 27,\n    77, 37, 35, 66, 58, 52, 91, 74, 62, 48, 79, 63, 90, 62, 40, 38,\n    125, 32, 60, 56, 50, 92, 78, 65, 55, 87, 71, 51, 73, 51, 70, 30,\n    109, 53, 49, 94, 88, 75, 66, 122, 91, 73, 56, 42, 64, 44, 21, 25,\n    90, 43, 41, 77, 73, 63, 56, 92, 77, 66, 47, 67, 48, 53, 36, 20,\n    71, 34, 67, 60, 58, 49, 88, 76, 67, 106, 71, 54, 38, 39, 23, 15,\n    109, 53, 51, 47, 90, 82, 58, 57, 48, 72, 57, 41, 23, 27, 62, 9,\n    86, 42, 40, 37, 70, 64, 52, 43, 70, 55, 42, 25, 29, 18, 11, 11,\n    118, 68, 30, 55, 50, 46, 74, 65, 49, 39, 24, 16, 22, 13, 14, 7,\n    91, 44, 39, 38, 34, 63, 52, 45, 31, 52, 28, 19, 14, 8, 9, 3,\n    123, 60, 58, 53, 47, 43, 32, 22, 37, 24, 17, 12, 15, 10, 2, 1,\n    71, 37, 34, 30, 28, 20, 17, 26, 21, 16, 10, 6, 8, 6, 2, 0\n];\n\nTables.t16HB = [\n    1, 5, 14, 44, 74, 63, 110, 93, 172, 149, 138, 242, 225, 195, 376, 17,\n    3, 4, 12, 20, 35, 62, 53, 47, 83, 75, 68, 119, 201, 107, 207, 9,\n    15, 13, 23, 38, 67, 58, 103, 90, 161, 72, 127, 117, 110, 209, 206, 16,\n    45, 21, 39, 69, 64, 114, 99, 87, 158, 140, 252, 212, 199, 387, 365, 26,\n    75, 36, 68, 65, 115, 101, 179, 164, 155, 264, 246, 226, 395, 382, 362, 9,\n    66, 30, 59, 56, 102, 185, 173, 265, 142, 253, 232, 400, 388, 378, 445, 16,\n    111, 54, 52, 100, 184, 178, 160, 133, 257, 244, 228, 217, 385, 366, 715, 10,\n    98, 48, 91, 88, 165, 157, 148, 261, 248, 407, 397, 372, 380, 889, 884, 8,\n    85, 84, 81, 159, 156, 143, 260, 249, 427, 401, 392, 383, 727, 713, 708, 7,\n    154, 76, 73, 141, 131, 256, 245, 426, 406, 394, 384, 735, 359, 710, 352, 11,\n    139, 129, 67, 125, 247, 233, 229, 219, 393, 743, 737, 720, 885, 882, 439, 4,\n    243, 120, 118, 115, 227, 223, 396, 746, 742, 736, 721, 712, 706, 223, 436, 6,\n    202, 224, 222, 218, 216, 389, 386, 381, 364, 888, 443, 707, 440, 437, 1728, 4,\n    747, 211, 210, 208, 370, 379, 734, 723, 714, 1735, 883, 877, 876, 3459, 865, 2,\n    377, 369, 102, 187, 726, 722, 358, 711, 709, 866, 1734, 871, 3458, 870, 434, 0,\n    12, 10, 7, 11, 10, 17, 11, 9, 13, 12, 10, 7, 5, 3, 1, 3\n];\n\nTables.t24HB = [\n    15, 13, 46, 80, 146, 262, 248, 434, 426, 669, 653, 649, 621, 517, 1032, 88,\n    14, 12, 21, 38, 71, 130, 122, 216, 209, 198, 327, 345, 319, 297, 279, 42,\n    47, 22, 41, 74, 68, 128, 120, 221, 207, 194, 182, 340, 315, 295, 541, 18,\n    81, 39, 75, 70, 134, 125, 116, 220, 204, 190, 178, 325, 311, 293, 271, 16,\n    147, 72, 69, 135, 127, 118, 112, 210, 200, 188, 352, 323, 306, 285, 540, 14,\n    263, 66, 129, 126, 119, 114, 214, 202, 192, 180, 341, 317, 301, 281, 262, 12,\n    249, 123, 121, 117, 113, 215, 206, 195, 185, 347, 330, 308, 291, 272, 520, 10,\n    435, 115, 111, 109, 211, 203, 196, 187, 353, 332, 313, 298, 283, 531, 381, 17,\n    427, 212, 208, 205, 201, 193, 186, 177, 169, 320, 303, 286, 268, 514, 377, 16,\n    335, 199, 197, 191, 189, 181, 174, 333, 321, 305, 289, 275, 521, 379, 371, 11,\n    668, 184, 183, 179, 175, 344, 331, 314, 304, 290, 277, 530, 383, 373, 366, 10,\n    652, 346, 171, 168, 164, 318, 309, 299, 287, 276, 263, 513, 375, 368, 362, 6,\n    648, 322, 316, 312, 307, 302, 292, 284, 269, 261, 512, 376, 370, 364, 359, 4,\n    620, 300, 296, 294, 288, 282, 273, 266, 515, 380, 374, 369, 365, 361, 357, 2,\n    1033, 280, 278, 274, 267, 264, 259, 382, 378, 372, 367, 363, 360, 358, 356, 0,\n    43, 20, 19, 17, 15, 13, 11, 9, 7, 6, 4, 7, 5, 3, 1, 3\n];\n\nTables.t32HB = [\n    1 << 0, 5 << 1, 4 << 1, 5 << 2, 6 << 1, 5 << 2, 4 << 2, 4 << 3,\n    7 << 1, 3 << 2, 6 << 2, 0 << 3, 7 << 2, 2 << 3, 3 << 3, 1 << 4\n];\n\nTables.t33HB = [\n    15 << 0, 14 << 1, 13 << 1, 12 << 2, 11 << 1, 10 << 2, 9 << 2, 8 << 3,\n    7 << 1, 6 << 2, 5 << 2, 4 << 3, 3 << 2, 2 << 3, 1 << 3, 0 << 4\n];\n\nTables.t1l = [\n    1, 4,\n    3, 5\n];\n\nTables.t2l = [\n    1, 4, 7,\n    4, 5, 7,\n    6, 7, 8\n];\n\nTables.t3l = [\n    2, 3, 7,\n    4, 4, 7,\n    6, 7, 8\n];\n\nTables.t5l = [\n    1, 4, 7, 8,\n    4, 5, 8, 9,\n    7, 8, 9, 10,\n    8, 8, 9, 10\n];\n\nTables.t6l = [\n    3, 4, 6, 8,\n    4, 4, 6, 7,\n    5, 6, 7, 8,\n    7, 7, 8, 9\n];\n\nTables.t7l = [\n    1, 4, 7, 9, 9, 10,\n    4, 6, 8, 9, 9, 10,\n    7, 7, 9, 10, 10, 11,\n    8, 9, 10, 11, 11, 11,\n    8, 9, 10, 11, 11, 12,\n    9, 10, 11, 12, 12, 12\n];\n\nTables.t8l = [\n    2, 4, 7, 9, 9, 10,\n    4, 4, 6, 10, 10, 10,\n    7, 6, 8, 10, 10, 11,\n    9, 10, 10, 11, 11, 12,\n    9, 9, 10, 11, 12, 12,\n    10, 10, 11, 11, 13, 13\n];\n\nTables.t9l = [\n    3, 4, 6, 7, 9, 10,\n    4, 5, 6, 7, 8, 10,\n    5, 6, 7, 8, 9, 10,\n    7, 7, 8, 9, 9, 10,\n    8, 8, 9, 9, 10, 11,\n    9, 9, 10, 10, 11, 11\n];\n\nTables.t10l = [\n    1, 4, 7, 9, 10, 10, 10, 11,\n    4, 6, 8, 9, 10, 11, 10, 10,\n    7, 8, 9, 10, 11, 12, 11, 11,\n    8, 9, 10, 11, 12, 12, 11, 12,\n    9, 10, 11, 12, 12, 12, 12, 12,\n    10, 11, 12, 12, 13, 13, 12, 13,\n    9, 10, 11, 12, 12, 12, 13, 13,\n    10, 10, 11, 12, 12, 13, 13, 13\n];\n\nTables.t11l = [\n    2, 4, 6, 8, 9, 10, 9, 10,\n    4, 5, 6, 8, 10, 10, 9, 10,\n    6, 7, 8, 9, 10, 11, 10, 10,\n    8, 8, 9, 11, 10, 12, 10, 11,\n    9, 10, 10, 11, 11, 12, 11, 12,\n    9, 10, 11, 12, 12, 13, 12, 13,\n    9, 9, 9, 10, 11, 12, 12, 12,\n    9, 9, 10, 11, 12, 12, 12, 12\n];\n\nTables.t12l = [\n    4, 4, 6, 8, 9, 10, 10, 10,\n    4, 5, 6, 7, 9, 9, 10, 10,\n    6, 6, 7, 8, 9, 10, 9, 10,\n    7, 7, 8, 8, 9, 10, 10, 10,\n    8, 8, 9, 9, 10, 10, 10, 11,\n    9, 9, 10, 10, 10, 11, 10, 11,\n    9, 9, 9, 10, 10, 11, 11, 12,\n    10, 10, 10, 11, 11, 11, 11, 12\n];\n\nTables.t13l = [\n    1, 5, 7, 8, 9, 10, 10, 11, 10, 11, 12, 12, 13, 13, 14, 14,\n    4, 6, 8, 9, 10, 10, 11, 11, 11, 11, 12, 12, 13, 14, 14, 14,\n    7, 8, 9, 10, 11, 11, 12, 12, 11, 12, 12, 13, 13, 14, 15, 15,\n    8, 9, 10, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 14, 15, 15,\n    9, 9, 11, 11, 12, 12, 13, 13, 12, 13, 13, 14, 14, 15, 15, 16,\n    10, 10, 11, 12, 12, 12, 13, 13, 13, 13, 14, 13, 15, 15, 16, 16,\n    10, 11, 12, 12, 13, 13, 13, 13, 13, 14, 14, 14, 15, 15, 16, 16,\n    11, 11, 12, 13, 13, 13, 14, 14, 14, 14, 15, 15, 15, 16, 18, 18,\n    10, 10, 11, 12, 12, 13, 13, 14, 14, 14, 14, 15, 15, 16, 17, 17,\n    11, 11, 12, 12, 13, 13, 13, 15, 14, 15, 15, 16, 16, 16, 18, 17,\n    11, 12, 12, 13, 13, 14, 14, 15, 14, 15, 16, 15, 16, 17, 18, 19,\n    12, 12, 12, 13, 14, 14, 14, 14, 15, 15, 15, 16, 17, 17, 17, 18,\n    12, 13, 13, 14, 14, 15, 14, 15, 16, 16, 17, 17, 17, 18, 18, 18,\n    13, 13, 14, 15, 15, 15, 16, 16, 16, 16, 16, 17, 18, 17, 18, 18,\n    14, 14, 14, 15, 15, 15, 17, 16, 16, 19, 17, 17, 17, 19, 18, 18,\n    13, 14, 15, 16, 16, 16, 17, 16, 17, 17, 18, 18, 21, 20, 21, 18\n];\n\nTables.t15l = [\n    3, 5, 6, 8, 8, 9, 10, 10, 10, 11, 11, 12, 12, 12, 13, 14,\n    5, 5, 7, 8, 9, 9, 10, 10, 10, 11, 11, 12, 12, 12, 13, 13,\n    6, 7, 7, 8, 9, 9, 10, 10, 10, 11, 11, 12, 12, 13, 13, 13,\n    7, 8, 8, 9, 9, 10, 10, 11, 11, 11, 12, 12, 12, 13, 13, 13,\n    8, 8, 9, 9, 10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 13, 13,\n    9, 9, 9, 10, 10, 10, 11, 11, 11, 11, 12, 12, 13, 13, 13, 14,\n    10, 9, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 13, 14, 14,\n    10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 13, 13, 14,\n    10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 13, 13, 14, 14, 14,\n    10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 13, 13, 13, 14, 14, 14,\n    11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 13, 13, 13, 14, 15, 14,\n    11, 11, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 14, 14, 14, 15,\n    12, 12, 11, 12, 12, 12, 13, 13, 13, 13, 13, 13, 14, 14, 15, 15,\n    12, 12, 12, 12, 12, 13, 13, 13, 13, 14, 14, 14, 14, 14, 15, 15,\n    13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 15, 15, 14, 15,\n    13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 15, 15, 15, 15\n];\n\nTables.t16_5l = [\n    1, 5, 7, 9, 10, 10, 11, 11, 12, 12, 12, 13, 13, 13, 14, 11,\n    4, 6, 8, 9, 10, 11, 11, 11, 12, 12, 12, 13, 14, 13, 14, 11,\n    7, 8, 9, 10, 11, 11, 12, 12, 13, 12, 13, 13, 13, 14, 14, 12,\n    9, 9, 10, 11, 11, 12, 12, 12, 13, 13, 14, 14, 14, 15, 15, 13,\n    10, 10, 11, 11, 12, 12, 13, 13, 13, 14, 14, 14, 15, 15, 15, 12,\n    10, 10, 11, 11, 12, 13, 13, 14, 13, 14, 14, 15, 15, 15, 16, 13,\n    11, 11, 11, 12, 13, 13, 13, 13, 14, 14, 14, 14, 15, 15, 16, 13,\n    11, 11, 12, 12, 13, 13, 13, 14, 14, 15, 15, 15, 15, 17, 17, 13,\n    11, 12, 12, 13, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 13,\n    12, 12, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 15, 16, 15, 14,\n    12, 13, 12, 13, 14, 14, 14, 14, 15, 16, 16, 16, 17, 17, 16, 13,\n    13, 13, 13, 13, 14, 14, 15, 16, 16, 16, 16, 16, 16, 15, 16, 14,\n    13, 14, 14, 14, 14, 15, 15, 15, 15, 17, 16, 16, 16, 16, 18, 14,\n    15, 14, 14, 14, 15, 15, 16, 16, 16, 18, 17, 17, 17, 19, 17, 14,\n    14, 15, 13, 14, 16, 16, 15, 16, 16, 17, 18, 17, 19, 17, 16, 14,\n    11, 11, 11, 12, 12, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 12\n];\n\nTables.t16l = [\n    1, 5, 7, 9, 10, 10, 11, 11, 12, 12, 12, 13, 13, 13, 14, 10,\n    4, 6, 8, 9, 10, 11, 11, 11, 12, 12, 12, 13, 14, 13, 14, 10,\n    7, 8, 9, 10, 11, 11, 12, 12, 13, 12, 13, 13, 13, 14, 14, 11,\n    9, 9, 10, 11, 11, 12, 12, 12, 13, 13, 14, 14, 14, 15, 15, 12,\n    10, 10, 11, 11, 12, 12, 13, 13, 13, 14, 14, 14, 15, 15, 15, 11,\n    10, 10, 11, 11, 12, 13, 13, 14, 13, 14, 14, 15, 15, 15, 16, 12,\n    11, 11, 11, 12, 13, 13, 13, 13, 14, 14, 14, 14, 15, 15, 16, 12,\n    11, 11, 12, 12, 13, 13, 13, 14, 14, 15, 15, 15, 15, 17, 17, 12,\n    11, 12, 12, 13, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 12,\n    12, 12, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 15, 16, 15, 13,\n    12, 13, 12, 13, 14, 14, 14, 14, 15, 16, 16, 16, 17, 17, 16, 12,\n    13, 13, 13, 13, 14, 14, 15, 16, 16, 16, 16, 16, 16, 15, 16, 13,\n    13, 14, 14, 14, 14, 15, 15, 15, 15, 17, 16, 16, 16, 16, 18, 13,\n    15, 14, 14, 14, 15, 15, 16, 16, 16, 18, 17, 17, 17, 19, 17, 13,\n    14, 15, 13, 14, 16, 16, 15, 16, 16, 17, 18, 17, 19, 17, 16, 13,\n    10, 10, 10, 11, 11, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 10\n];\n\nTables.t24l = [\n    4, 5, 7, 8, 9, 10, 10, 11, 11, 12, 12, 12, 12, 12, 13, 10,\n    5, 6, 7, 8, 9, 10, 10, 11, 11, 11, 12, 12, 12, 12, 12, 10,\n    7, 7, 8, 9, 9, 10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 9,\n    8, 8, 9, 9, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 9,\n    9, 9, 9, 10, 10, 10, 10, 11, 11, 11, 12, 12, 12, 12, 13, 9,\n    10, 9, 10, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 9,\n    10, 10, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 9,\n    11, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 13, 10,\n    11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 13, 13, 10,\n    11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 13, 13, 10,\n    12, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 10,\n    12, 12, 11, 11, 11, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 10,\n    12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 10,\n    12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 10,\n    13, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 10,\n    9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 6\n];\n\nTables.t32l = [\n    1 + 0, 4 + 1, 4 + 1, 5 + 2, 4 + 1, 6 + 2, 5 + 2, 6 + 3,\n    4 + 1, 5 + 2, 5 + 2, 6 + 3, 5 + 2, 6 + 3, 6 + 3, 6 + 4\n];\n\nTables.t33l = [\n    4 + 0, 4 + 1, 4 + 1, 4 + 2, 4 + 1, 4 + 2, 4 + 2, 4 + 3,\n    4 + 1, 4 + 2, 4 + 2, 4 + 3, 4 + 2, 4 + 3, 4 + 3, 4 + 4\n];\n\nTables.ht = [\n    /* xlen, linmax, table, hlen */\n    new HuffCodeTab(0, 0, null, null),\n    new HuffCodeTab(2, 0, Tables.t1HB, Tables.t1l),\n    new HuffCodeTab(3, 0, Tables.t2HB, Tables.t2l),\n    new HuffCodeTab(3, 0, Tables.t3HB, Tables.t3l),\n    new HuffCodeTab(0, 0, null, null), /* Apparently not used */\n    new HuffCodeTab(4, 0, Tables.t5HB, Tables.t5l),\n    new HuffCodeTab(4, 0, Tables.t6HB, Tables.t6l),\n    new HuffCodeTab(6, 0, Tables.t7HB, Tables.t7l),\n    new HuffCodeTab(6, 0, Tables.t8HB, Tables.t8l),\n    new HuffCodeTab(6, 0, Tables.t9HB, Tables.t9l),\n    new HuffCodeTab(8, 0, Tables.t10HB, Tables.t10l),\n    new HuffCodeTab(8, 0, Tables.t11HB, Tables.t11l),\n    new HuffCodeTab(8, 0, Tables.t12HB, Tables.t12l),\n    new HuffCodeTab(16, 0, Tables.t13HB, Tables.t13l),\n    new HuffCodeTab(0, 0, null, Tables.t16_5l), /* Apparently not used */\n    new HuffCodeTab(16, 0, Tables.t15HB, Tables.t15l),\n\n    new HuffCodeTab(1, 1, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(2, 3, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(3, 7, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(4, 15, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(6, 63, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(8, 255, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(10, 1023, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(13, 8191, Tables.t16HB, Tables.t16l),\n\n    new HuffCodeTab(4, 15, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(5, 31, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(6, 63, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(7, 127, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(8, 255, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(9, 511, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(11, 2047, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(13, 8191, Tables.t24HB, Tables.t24l),\n\n    new HuffCodeTab(0, 0, Tables.t32HB, Tables.t32l),\n    new HuffCodeTab(0, 0, Tables.t33HB, Tables.t33l),\n];\n\n/**\n * <CODE>\n *  for (i = 0; i < 16*16; i++) [\n *      largetbl[i] = ((ht[16].hlen[i]) << 16) + ht[24].hlen[i];\n *  ]\n * </CODE>\n *\n */\nTables.largetbl = [\n    0x010004, 0x050005, 0x070007, 0x090008, 0x0a0009, 0x0a000a, 0x0b000a, 0x0b000b,\n    0x0c000b, 0x0c000c, 0x0c000c, 0x0d000c, 0x0d000c, 0x0d000c, 0x0e000d, 0x0a000a,\n    0x040005, 0x060006, 0x080007, 0x090008, 0x0a0009, 0x0b000a, 0x0b000a, 0x0b000b,\n    0x0c000b, 0x0c000b, 0x0c000c, 0x0d000c, 0x0e000c, 0x0d000c, 0x0e000c, 0x0a000a,\n    0x070007, 0x080007, 0x090008, 0x0a0009, 0x0b0009, 0x0b000a, 0x0c000a, 0x0c000b,\n    0x0d000b, 0x0c000b, 0x0d000b, 0x0d000c, 0x0d000c, 0x0e000c, 0x0e000d, 0x0b0009,\n    0x090008, 0x090008, 0x0a0009, 0x0b0009, 0x0b000a, 0x0c000a, 0x0c000a, 0x0c000b,\n    0x0d000b, 0x0d000b, 0x0e000b, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x0c0009,\n    0x0a0009, 0x0a0009, 0x0b0009, 0x0b000a, 0x0c000a, 0x0c000a, 0x0d000a, 0x0d000b,\n    0x0d000b, 0x0e000b, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x0f000d, 0x0b0009,\n    0x0a000a, 0x0a0009, 0x0b000a, 0x0b000a, 0x0c000a, 0x0d000a, 0x0d000b, 0x0e000b,\n    0x0d000b, 0x0e000b, 0x0e000c, 0x0f000c, 0x0f000c, 0x0f000c, 0x10000c, 0x0c0009,\n    0x0b000a, 0x0b000a, 0x0b000a, 0x0c000a, 0x0d000a, 0x0d000b, 0x0d000b, 0x0d000b,\n    0x0e000b, 0x0e000c, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x10000d, 0x0c0009,\n    0x0b000b, 0x0b000a, 0x0c000a, 0x0c000a, 0x0d000b, 0x0d000b, 0x0d000b, 0x0e000b,\n    0x0e000c, 0x0f000c, 0x0f000c, 0x0f000c, 0x0f000c, 0x11000d, 0x11000d, 0x0c000a,\n    0x0b000b, 0x0c000b, 0x0c000b, 0x0d000b, 0x0d000b, 0x0d000b, 0x0e000b, 0x0e000b,\n    0x0f000b, 0x0f000c, 0x0f000c, 0x0f000c, 0x10000c, 0x10000d, 0x10000d, 0x0c000a,\n    0x0c000b, 0x0c000b, 0x0c000b, 0x0d000b, 0x0d000b, 0x0e000b, 0x0e000b, 0x0f000c,\n    0x0f000c, 0x0f000c, 0x0f000c, 0x10000c, 0x0f000d, 0x10000d, 0x0f000d, 0x0d000a,\n    0x0c000c, 0x0d000b, 0x0c000b, 0x0d000b, 0x0e000b, 0x0e000c, 0x0e000c, 0x0e000c,\n    0x0f000c, 0x10000c, 0x10000c, 0x10000d, 0x11000d, 0x11000d, 0x10000d, 0x0c000a,\n    0x0d000c, 0x0d000c, 0x0d000b, 0x0d000b, 0x0e000b, 0x0e000c, 0x0f000c, 0x10000c,\n    0x10000c, 0x10000c, 0x10000c, 0x10000d, 0x10000d, 0x0f000d, 0x10000d, 0x0d000a,\n    0x0d000c, 0x0e000c, 0x0e000c, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x0f000c,\n    0x0f000c, 0x11000c, 0x10000d, 0x10000d, 0x10000d, 0x10000d, 0x12000d, 0x0d000a,\n    0x0f000c, 0x0e000c, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x10000c, 0x10000c,\n    0x10000d, 0x12000d, 0x11000d, 0x11000d, 0x11000d, 0x13000d, 0x11000d, 0x0d000a,\n    0x0e000d, 0x0f000c, 0x0d000c, 0x0e000c, 0x10000c, 0x10000c, 0x0f000c, 0x10000d,\n    0x10000d, 0x11000d, 0x12000d, 0x11000d, 0x13000d, 0x11000d, 0x10000d, 0x0d000a,\n    0x0a0009, 0x0a0009, 0x0a0009, 0x0b0009, 0x0b0009, 0x0c0009, 0x0c0009, 0x0c0009,\n    0x0d0009, 0x0d0009, 0x0d0009, 0x0d000a, 0x0d000a, 0x0d000a, 0x0d000a, 0x0a0006\n];\n/**\n * <CODE>\n *  for (i = 0; i < 3*3; i++) [\n *      table23[i] = ((ht[2].hlen[i]) << 16) + ht[3].hlen[i];\n *  ]\n * </CODE>\n *\n */\nTables.table23 = [\n    0x010002, 0x040003, 0x070007,\n    0x040004, 0x050004, 0x070007,\n    0x060006, 0x070007, 0x080008\n];\n\n/**\n * <CODE>\n *  for (i = 0; i < 4*4; i++) [\n *       table56[i] = ((ht[5].hlen[i]) << 16) + ht[6].hlen[i];\n *   ]\n * </CODE>\n *\n */\nTables.table56 = [\n    0x010003, 0x040004, 0x070006, 0x080008, 0x040004, 0x050004, 0x080006, 0x090007,\n    0x070005, 0x080006, 0x090007, 0x0a0008, 0x080007, 0x080007, 0x090008, 0x0a0009\n];\n\nTables.bitrate_table = [\n    [0, 8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, -1], /* MPEG 2 */\n    [0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, -1], /* MPEG 1 */\n    [0, 8, 16, 24, 32, 40, 48, 56, 64, -1, -1, -1, -1, -1, -1, -1], /* MPEG 2.5 */\n];\n\n/**\n * MPEG 2, MPEG 1, MPEG 2.5.\n */\nTables.samplerate_table = [\n    [22050, 24000, 16000, -1],\n    [44100, 48000, 32000, -1],\n    [11025, 12000, 8000, -1],\n];\n\n/**\n * This is the scfsi_band table from 2.4.2.7 of the IS.\n */\nTables.scfsi_band = [0, 6, 11, 16, 21];\n\nfunction MeanBits(meanBits) {\n    this.bits = meanBits;\n}\n\n//package mp3;\n\nfunction CalcNoiseResult() {\n    /**\n     * sum of quantization noise > masking\n     */\n    this.over_noise = 0.;\n    /**\n     * sum of all quantization noise\n     */\n    this.tot_noise = 0.;\n    /**\n     * max quantization noise\n     */\n    this.max_noise = 0.;\n    /**\n     * number of quantization noise > masking\n     */\n    this.over_count = 0;\n    /**\n     * SSD-like cost of distorted bands\n     */\n    this.over_SSD = 0;\n    this.bits = 0;\n}\n\nfunction VBRQuantize() {\n    var qupvt;\n    var tak;\n\n    this.setModules = function (_qupvt, _tk) {\n        qupvt = _qupvt;\n        tak = _tk;\n    }\n    //TODO\n\n}\n\n\n\n/**\n * ATH related stuff, if something new ATH related has to be added, please plug\n * it here into the ATH.\n */\nfunction ATH() {\n    /**\n     * Method for the auto adjustment.\n     */\n    this.useAdjust = 0;\n    /**\n     * factor for tuning the (sample power) point below which adaptive threshold\n     * of hearing adjustment occurs\n     */\n    this.aaSensitivityP = 0.;\n    /**\n     * Lowering based on peak volume, 1 = no lowering.\n     */\n    this.adjust = 0.;\n    /**\n     * Limit for dynamic ATH adjust.\n     */\n    this.adjustLimit = 0.;\n    /**\n     * Determined to lower x dB each second.\n     */\n    this.decay = 0.;\n    /**\n     * Lowest ATH value.\n     */\n    this.floor = 0.;\n    /**\n     * ATH for sfbs in long blocks.\n     */\n    this.l = new_float(Encoder.SBMAX_l);\n    /**\n     * ATH for sfbs in short blocks.\n     */\n    this.s = new_float(Encoder.SBMAX_s);\n    /**\n     * ATH for partitioned sfb21 in long blocks.\n     */\n    this.psfb21 = new_float(Encoder.PSFB21);\n    /**\n     * ATH for partitioned sfb12 in short blocks.\n     */\n    this.psfb12 = new_float(Encoder.PSFB12);\n    /**\n     * ATH for long block convolution bands.\n     */\n    this.cb_l = new_float(Encoder.CBANDS);\n    /**\n     * ATH for short block convolution bands.\n     */\n    this.cb_s = new_float(Encoder.CBANDS);\n    /**\n     * Equal loudness weights (based on ATH).\n     */\n    this.eql_w = new_float(Encoder.BLKSIZE / 2);\n}\n\n\nfunction LameGlobalFlags() {\n\n    this.class_id = 0;\n\n    /* input description */\n\n    /**\n     * number of samples. default=-1\n     */\n    this.num_samples = 0;\n    /**\n     * input number of channels. default=2\n     */\n    this.num_channels = 0;\n    /**\n     * input_samp_rate in Hz. default=44.1 kHz\n     */\n    this.in_samplerate = 0;\n    /**\n     * output_samp_rate. default: LAME picks best value at least not used for\n     * MP3 decoding: Remember 44.1 kHz MP3s and AC97\n     */\n    this.out_samplerate = 0;\n    /**\n     * scale input by this amount before encoding at least not used for MP3\n     * decoding\n     */\n    this.scale = 0.;\n    /**\n     * scale input of channel 0 (left) by this amount before encoding\n     */\n    this.scale_left = 0.;\n    /**\n     * scale input of channel 1 (right) by this amount before encoding\n     */\n    this.scale_right = 0.;\n\n    /* general control params */\n    /**\n     * collect data for a MP3 frame analyzer?\n     */\n    this.analysis = false;\n    /**\n     * add Xing VBR tag?\n     */\n    this.bWriteVbrTag = false;\n\n    /**\n     * use lame/mpglib to convert mp3 to wav\n     */\n    this.decode_only = false;\n    /**\n     * quality setting 0=best, 9=worst default=5\n     */\n    this.quality = 0;\n    /**\n     * see enum default = LAME picks best value\n     */\n    this.mode = MPEGMode.STEREO;\n    /**\n     * force M/S mode. requires mode=1\n     */\n    this.force_ms = false;\n    /**\n     * use free format? default=0\n     */\n    this.free_format = false;\n    /**\n     * find the RG value? default=0\n     */\n    this.findReplayGain = false;\n    /**\n     * decode on the fly? default=0\n     */\n    this.decode_on_the_fly = false;\n    /**\n     * 1 (default) writes ID3 tags, 0 not\n     */\n    this.write_id3tag_automatic = false;\n\n    /*\n     * set either brate>0 or compression_ratio>0, LAME will compute the value of\n     * the variable not set. Default is compression_ratio = 11.025\n     */\n    /**\n     * bitrate\n     */\n    this.brate = 0;\n    /**\n     * sizeof(wav file)/sizeof(mp3 file)\n     */\n    this.compression_ratio = 0.;\n\n    /* frame params */\n    /**\n     * mark as copyright. default=0\n     */\n    this.copyright = 0;\n    /**\n     * mark as original. default=1\n     */\n    this.original = 0;\n    /**\n     * the MP3 'private extension' bit. Meaningless\n     */\n    this.extension = 0;\n    /**\n     * Input PCM is emphased PCM (for instance from one of the rarely emphased\n     * CDs), it is STRONGLY not recommended to use this, because psycho does not\n     * take it into account, and last but not least many decoders don't care\n     * about these bits\n     */\n    this.emphasis = 0;\n    /**\n     * use 2 bytes per frame for a CRC checksum. default=0\n     */\n    this.error_protection = 0;\n    /**\n     * enforce ISO spec as much as possible\n     */\n    this.strict_ISO = false;\n\n    /**\n     * use bit reservoir?\n     */\n    this.disable_reservoir = false;\n\n    /* quantization/noise shaping */\n    this.quant_comp = 0;\n    this.quant_comp_short = 0;\n    this.experimentalY = false;\n    this.experimentalZ = 0;\n    this.exp_nspsytune = 0;\n\n    this.preset = 0;\n\n    /* VBR control */\n    this.VBR = null;\n    /**\n     * Range [0,...,1[\n     */\n    this.VBR_q_frac = 0.;\n    /**\n     * Range [0,...,9]\n     */\n    this.VBR_q = 0;\n    this.VBR_mean_bitrate_kbps = 0;\n    this.VBR_min_bitrate_kbps = 0;\n    this.VBR_max_bitrate_kbps = 0;\n    /**\n     * strictly enforce VBR_min_bitrate normaly, it will be violated for analog\n     * silence\n     */\n    this.VBR_hard_min = 0;\n\n    /* resampling and filtering */\n\n    /**\n     * freq in Hz. 0=lame choses. -1=no filter\n     */\n    this.lowpassfreq = 0;\n    /**\n     * freq in Hz. 0=lame choses. -1=no filter\n     */\n    this.highpassfreq = 0;\n    /**\n     * freq width of filter, in Hz (default=15%)\n     */\n    this.lowpasswidth = 0;\n    /**\n     * freq width of filter, in Hz (default=15%)\n     */\n    this.highpasswidth = 0;\n\n    /*\n     * psycho acoustics and other arguments which you should not change unless\n     * you know what you are doing\n     */\n\n    this.maskingadjust = 0.;\n    this.maskingadjust_short = 0.;\n    /**\n     * only use ATH\n     */\n    this.ATHonly = false;\n    /**\n     * only use ATH for short blocks\n     */\n    this.ATHshort = false;\n    /**\n     * disable ATH\n     */\n    this.noATH = false;\n    /**\n     * select ATH formula\n     */\n    this.ATHtype = 0;\n    /**\n     * change ATH formula 4 shape\n     */\n    this.ATHcurve = 0.;\n    /**\n     * lower ATH by this many db\n     */\n    this.ATHlower = 0.;\n    /**\n     * select ATH auto-adjust scheme\n     */\n    this.athaa_type = 0;\n    /**\n     * select ATH auto-adjust loudness calc\n     */\n    this.athaa_loudapprox = 0;\n    /**\n     * dB, tune active region of auto-level\n     */\n    this.athaa_sensitivity = 0.;\n    this.short_blocks = null;\n    /**\n     * use temporal masking effect\n     */\n    this.useTemporal = false;\n    this.interChRatio = 0.;\n    /**\n     * Naoki's adjustment of Mid/Side maskings\n     */\n    this.msfix = 0.;\n\n    /**\n     * 0 off, 1 on\n     */\n    this.tune = false;\n    /**\n     * used to pass values for debugging and stuff\n     */\n    this.tune_value_a = 0.;\n\n    /************************************************************************/\n    /* internal variables, do not set... */\n    /* provided because they may be of use to calling application */\n    /************************************************************************/\n\n    /**\n     * 0=MPEG-2/2.5 1=MPEG-1\n     */\n    this.version = 0;\n    this.encoder_delay = 0;\n    /**\n     * number of samples of padding appended to input\n     */\n    this.encoder_padding = 0;\n    this.framesize = 0;\n    /**\n     * number of frames encoded\n     */\n    this.frameNum = 0;\n    /**\n     * is this struct owned by calling program or lame?\n     */\n    this.lame_allocated_gfp = 0;\n    /**************************************************************************/\n    /* more internal variables are stored in this structure: */\n    /**************************************************************************/\n    this.internal_flags = null;\n}\n\n\n\nfunction CBRNewIterationLoop(_quantize)  {\n    var quantize = _quantize;\n    this.quantize = quantize;\n\tthis.iteration_loop = function(gfp, pe, ms_ener_ratio, ratio) {\n\t\tvar gfc = gfp.internal_flags;\n        var l3_xmin = new_float(L3Side.SFBMAX);\n\t\tvar xrpow = new_float(576);\n\t\tvar targ_bits = new_int(2);\n\t\tvar mean_bits = 0, max_bits;\n\t\tvar l3_side = gfc.l3_side;\n\n\t\tvar mb = new MeanBits(mean_bits);\n\t\tthis.quantize.rv.ResvFrameBegin(gfp, mb);\n\t\tmean_bits = mb.bits;\n\n\t\t/* quantize! */\n\t\tfor (var gr = 0; gr < gfc.mode_gr; gr++) {\n\n\t\t\t/*\n\t\t\t * calculate needed bits\n\t\t\t */\n\t\t\tmax_bits = this.quantize.qupvt.on_pe(gfp, pe, targ_bits, mean_bits,\n\t\t\t\t\tgr, gr);\n\n\t\t\tif (gfc.mode_ext == Encoder.MPG_MD_MS_LR) {\n\t\t\t\tthis.quantize.ms_convert(gfc.l3_side, gr);\n\t\t\t\tthis.quantize.qupvt.reduce_side(targ_bits, ms_ener_ratio[gr],\n\t\t\t\t\t\tmean_bits, max_bits);\n\t\t\t}\n\n\t\t\tfor (var ch = 0; ch < gfc.channels_out; ch++) {\n\t\t\t\tvar adjust, masking_lower_db;\n\t\t\t\tvar cod_info = l3_side.tt[gr][ch];\n\n\t\t\t\tif (cod_info.block_type != Encoder.SHORT_TYPE) {\n\t\t\t\t\t// NORM, START or STOP type\n\t\t\t\t\tadjust = 0;\n\t\t\t\t\tmasking_lower_db = gfc.PSY.mask_adjust - adjust;\n\t\t\t\t} else {\n\t\t\t\t\tadjust = 0;\n\t\t\t\t\tmasking_lower_db = gfc.PSY.mask_adjust_short - adjust;\n\t\t\t\t}\n\t\t\t\tgfc.masking_lower =  Math.pow(10.0,\n\t\t\t\t\t\tmasking_lower_db * 0.1);\n\n\t\t\t\t/*\n\t\t\t\t * init_outer_loop sets up cod_info, scalefac and xrpow\n\t\t\t\t */\n\t\t\t\tthis.quantize.init_outer_loop(gfc, cod_info);\n\t\t\t\tif (this.quantize.init_xrpow(gfc, cod_info, xrpow)) {\n\t\t\t\t\t/*\n\t\t\t\t\t * xr contains energy we will have to encode calculate the\n\t\t\t\t\t * masking abilities find some good quantization in\n\t\t\t\t\t * outer_loop\n\t\t\t\t\t */\n\t\t\t\t\tthis.quantize.qupvt.calc_xmin(gfp, ratio[gr][ch], cod_info,\n\t\t\t\t\t\t\tl3_xmin);\n\t\t\t\t\tthis.quantize.outer_loop(gfp, cod_info, l3_xmin, xrpow, ch,\n\t\t\t\t\t\t\ttarg_bits[ch]);\n\t\t\t\t}\n\n\t\t\t\tthis.quantize.iteration_finish_one(gfc, gr, ch);\n\t\t\t} /* for ch */\n\t\t} /* for gr */\n\n\t\tthis.quantize.rv.ResvFrameEnd(gfc, mean_bits);\n\t}\n}\n\n\nfunction ReplayGain() {\n\t//fix 精简\n}\n\n//package mp3;\n\n/**\n * Layer III side information.\n *\n * @author Ken\n *\n */\n\n\n\nfunction ScaleFac(arrL, arrS, arr21, arr12) {\n\n    this.l = new_int(1 + Encoder.SBMAX_l);\n    this.s = new_int(1 + Encoder.SBMAX_s);\n    this.psfb21 = new_int(1 + Encoder.PSFB21);\n    this.psfb12 = new_int(1 + Encoder.PSFB12);\n    var l = this.l;\n    var s = this.s;\n\n    if (arguments.length == 4) {\n        //public ScaleFac(final int[] arrL, final int[] arrS, final int[] arr21,\n        //    final int[] arr12) {\n        this.arrL = arguments[0];\n        this.arrS = arguments[1];\n        this.arr21 = arguments[2];\n        this.arr12 = arguments[3];\n\n        System.arraycopy(this.arrL, 0, l, 0, Math.min(this.arrL.length, this.l.length));\n        System.arraycopy(this.arrS, 0, s, 0, Math.min(this.arrS.length, this.s.length));\n        System.arraycopy(this.arr21, 0, this.psfb21, 0, Math.min(this.arr21.length, this.psfb21.length));\n        System.arraycopy(this.arr12, 0, this.psfb12, 0, Math.min(this.arr12.length, this.psfb12.length));\n    }\n}\n\n/*\n *      quantize_pvt source file\n *\n *      Copyright (c) 1999-2002 Takehiro Tominaga\n *      Copyright (c) 2000-2002 Robert Hegemann\n *      Copyright (c) 2001 Naoki Shibata\n *      Copyright (c) 2002-2005 Gabriel Bouvigne\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n\n/* $Id: QuantizePVT.java,v 1.24 2011/05/24 20:48:06 kenchis Exp $ */\n\n\nQuantizePVT.Q_MAX = (256 + 1);\nQuantizePVT.Q_MAX2 = 116;\nQuantizePVT.LARGE_BITS = 100000;\nQuantizePVT.IXMAX_VAL = 8206;\n\nfunction QuantizePVT() {\n\n    var tak = null;\n    var rv = null;\n    var psy = null;\n\n    this.setModules = function (_tk, _rv, _psy) {\n        tak = _tk;\n        rv = _rv;\n        psy = _psy;\n    };\n\n    function POW20(x) {\n        return pow20[x + QuantizePVT.Q_MAX2];\n    }\n\n    this.IPOW20 = function (x) {\n        return ipow20[x];\n    }\n\n    /**\n     * smallest such that 1.0+DBL_EPSILON != 1.0\n     */\n    var DBL_EPSILON = 2.2204460492503131e-016;\n\n    /**\n     * ix always <= 8191+15. see count_bits()\n     */\n    var IXMAX_VAL = QuantizePVT.IXMAX_VAL;\n\n    var PRECALC_SIZE = (IXMAX_VAL + 2);\n\n    var Q_MAX = QuantizePVT.Q_MAX;\n\n\n    /**\n     * <CODE>\n     * minimum possible number of\n     * -cod_info.global_gain + ((scalefac[] + (cod_info.preflag ? pretab[sfb] : 0))\n     * << (cod_info.scalefac_scale + 1)) + cod_info.subblock_gain[cod_info.window[sfb]] * 8;\n     *\n     * for long block, 0+((15+3)<<2) = 18*4 = 72\n     * for short block, 0+(15<<2)+7*8 = 15*4+56 = 116\n     * </CODE>\n     */\n    var Q_MAX2 = QuantizePVT.Q_MAX2;\n\n    var LARGE_BITS = QuantizePVT.LARGE_BITS;\n\n\n    /**\n     * Assuming dynamic range=96dB, this value should be 92\n     */\n    var NSATHSCALE = 100;\n\n    /**\n     * The following table is used to implement the scalefactor partitioning for\n     * MPEG2 as described in section 2.4.3.2 of the IS. The indexing corresponds\n     * to the way the tables are presented in the IS:\n     *\n     * [table_number][row_in_table][column of nr_of_sfb]\n     */\n    this.nr_of_sfb_block = [\n        [[6, 5, 5, 5], [9, 9, 9, 9], [6, 9, 9, 9]],\n        [[6, 5, 7, 3], [9, 9, 12, 6], [6, 9, 12, 6]],\n        [[11, 10, 0, 0], [18, 18, 0, 0], [15, 18, 0, 0]],\n        [[7, 7, 7, 0], [12, 12, 12, 0], [6, 15, 12, 0]],\n        [[6, 6, 6, 3], [12, 9, 9, 6], [6, 12, 9, 6]],\n        [[8, 8, 5, 0], [15, 12, 9, 0], [6, 18, 9, 0]]];\n\n    /**\n     * Table B.6: layer3 preemphasis\n     */\n    var pretab = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1,\n        2, 2, 3, 3, 3, 2, 0];\n    this.pretab = pretab;\n\n    /**\n     * Here are MPEG1 Table B.8 and MPEG2 Table B.1 -- Layer III scalefactor\n     * bands. <BR>\n     * Index into this using a method such as:<BR>\n     * idx = fr_ps.header.sampling_frequency + (fr_ps.header.version * 3)\n     */\n    this.sfBandIndex = [\n        // Table B.2.b: 22.05 kHz\n        new ScaleFac([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 116, 140, 168, 200, 238, 284, 336, 396, 464,\n                522, 576],\n            [0, 4, 8, 12, 18, 24, 32, 42, 56, 74, 100, 132, 174, 192]\n            , [0, 0, 0, 0, 0, 0, 0] //  sfb21 pseudo sub bands\n            , [0, 0, 0, 0, 0, 0, 0] //  sfb12 pseudo sub bands\n        ),\n        /* Table B.2.c: 24 kHz */ /* docs: 332. mpg123(broken): 330 */\n        new ScaleFac([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 114, 136, 162, 194, 232, 278, 332, 394, 464,\n                540, 576],\n            [0, 4, 8, 12, 18, 26, 36, 48, 62, 80, 104, 136, 180, 192]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* Table B.2.a: 16 kHz */\n        new ScaleFac([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 116, 140, 168, 200, 238, 284, 336, 396, 464,\n                522, 576],\n            [0, 4, 8, 12, 18, 26, 36, 48, 62, 80, 104, 134, 174, 192]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* Table B.8.b: 44.1 kHz */\n        new ScaleFac([0, 4, 8, 12, 16, 20, 24, 30, 36, 44, 52, 62, 74, 90, 110, 134, 162, 196, 238, 288, 342, 418,\n                576],\n            [0, 4, 8, 12, 16, 22, 30, 40, 52, 66, 84, 106, 136, 192]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* Table B.8.c: 48 kHz */\n        new ScaleFac([0, 4, 8, 12, 16, 20, 24, 30, 36, 42, 50, 60, 72, 88, 106, 128, 156, 190, 230, 276, 330, 384,\n                576],\n            [0, 4, 8, 12, 16, 22, 28, 38, 50, 64, 80, 100, 126, 192]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* Table B.8.a: 32 kHz */\n        new ScaleFac([0, 4, 8, 12, 16, 20, 24, 30, 36, 44, 54, 66, 82, 102, 126, 156, 194, 240, 296, 364, 448, 550,\n                576],\n            [0, 4, 8, 12, 16, 22, 30, 42, 58, 78, 104, 138, 180, 192]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* MPEG-2.5 11.025 kHz */\n        new ScaleFac([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 116, 140, 168, 200, 238, 284, 336, 396, 464,\n                522, 576],\n            [0 / 3, 12 / 3, 24 / 3, 36 / 3, 54 / 3, 78 / 3, 108 / 3, 144 / 3, 186 / 3, 240 / 3, 312 / 3,\n                402 / 3, 522 / 3, 576 / 3]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* MPEG-2.5 12 kHz */\n        new ScaleFac([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 116, 140, 168, 200, 238, 284, 336, 396, 464,\n                522, 576],\n            [0 / 3, 12 / 3, 24 / 3, 36 / 3, 54 / 3, 78 / 3, 108 / 3, 144 / 3, 186 / 3, 240 / 3, 312 / 3,\n                402 / 3, 522 / 3, 576 / 3]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* MPEG-2.5 8 kHz */\n        new ScaleFac([0, 12, 24, 36, 48, 60, 72, 88, 108, 132, 160, 192, 232, 280, 336, 400, 476, 566, 568, 570,\n                572, 574, 576],\n            [0 / 3, 24 / 3, 48 / 3, 72 / 3, 108 / 3, 156 / 3, 216 / 3, 288 / 3, 372 / 3, 480 / 3, 486 / 3,\n                492 / 3, 498 / 3, 576 / 3]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        )\n    ];\n\n    var pow20 = new_float(Q_MAX + Q_MAX2 + 1);\n    var ipow20 = new_float(Q_MAX);\n    var pow43 = new_float(PRECALC_SIZE);\n\n    var adj43 = new_float(PRECALC_SIZE);\n    this.adj43 = adj43;\n\n    /**\n     * <PRE>\n     * compute the ATH for each scalefactor band cd range: 0..96db\n     *\n     * Input: 3.3kHz signal 32767 amplitude (3.3kHz is where ATH is smallest =\n     * -5db) longblocks: sfb=12 en0/bw=-11db max_en0 = 1.3db shortblocks: sfb=5\n     * -9db 0db\n     *\n     * Input: 1 1 1 1 1 1 1 -1 -1 -1 -1 -1 -1 -1 (repeated) longblocks: amp=1\n     * sfb=12 en0/bw=-103 db max_en0 = -92db amp=32767 sfb=12 -12 db -1.4db\n     *\n     * Input: 1 1 1 1 1 1 1 -1 -1 -1 -1 -1 -1 -1 (repeated) shortblocks: amp=1\n     * sfb=5 en0/bw= -99 -86 amp=32767 sfb=5 -9 db 4db\n     *\n     *\n     * MAX energy of largest wave at 3.3kHz = 1db AVE energy of largest wave at\n     * 3.3kHz = -11db Let's take AVE: -11db = maximum signal in sfb=12. Dynamic\n     * range of CD: 96db. Therefor energy of smallest audible wave in sfb=12 =\n     * -11 - 96 = -107db = ATH at 3.3kHz.\n     *\n     * ATH formula for this wave: -5db. To adjust to LAME scaling, we need ATH =\n     * ATH_formula - 103 (db) ATH = ATH * 2.5e-10 (ener)\n     * </PRE>\n     */\n    function ATHmdct(gfp, f) {\n        var ath = psy.ATHformula(f, gfp);\n\n        ath -= NSATHSCALE;\n\n        /* modify the MDCT scaling for the ATH and convert to energy */\n        ath = Math.pow(10.0, ath / 10.0 + gfp.ATHlower);\n        return ath;\n    }\n\n    function compute_ath(gfp) {\n        var ATH_l = gfp.internal_flags.ATH.l;\n        var ATH_psfb21 = gfp.internal_flags.ATH.psfb21;\n        var ATH_s = gfp.internal_flags.ATH.s;\n        var ATH_psfb12 = gfp.internal_flags.ATH.psfb12;\n        var gfc = gfp.internal_flags;\n        var samp_freq = gfp.out_samplerate;\n\n        for (var sfb = 0; sfb < Encoder.SBMAX_l; sfb++) {\n            var start = gfc.scalefac_band.l[sfb];\n            var end = gfc.scalefac_band.l[sfb + 1];\n            ATH_l[sfb] = Float.MAX_VALUE;\n            for (var i = start; i < end; i++) {\n                var freq = i * samp_freq / (2 * 576);\n                var ATH_f = ATHmdct(gfp, freq);\n                /* freq in kHz */\n                ATH_l[sfb] = Math.min(ATH_l[sfb], ATH_f);\n            }\n        }\n\n        for (var sfb = 0; sfb < Encoder.PSFB21; sfb++) {\n            var start = gfc.scalefac_band.psfb21[sfb];\n            var end = gfc.scalefac_band.psfb21[sfb + 1];\n            ATH_psfb21[sfb] = Float.MAX_VALUE;\n            for (var i = start; i < end; i++) {\n                var freq = i * samp_freq / (2 * 576);\n                var ATH_f = ATHmdct(gfp, freq);\n                /* freq in kHz */\n                ATH_psfb21[sfb] = Math.min(ATH_psfb21[sfb], ATH_f);\n            }\n        }\n\n        for (var sfb = 0; sfb < Encoder.SBMAX_s; sfb++) {\n            var start = gfc.scalefac_band.s[sfb];\n            var end = gfc.scalefac_band.s[sfb + 1];\n            ATH_s[sfb] = Float.MAX_VALUE;\n            for (var i = start; i < end; i++) {\n                var freq = i * samp_freq / (2 * 192);\n                var ATH_f = ATHmdct(gfp, freq);\n                /* freq in kHz */\n                ATH_s[sfb] = Math.min(ATH_s[sfb], ATH_f);\n            }\n            ATH_s[sfb] *= (gfc.scalefac_band.s[sfb + 1] - gfc.scalefac_band.s[sfb]);\n        }\n\n        for (var sfb = 0; sfb < Encoder.PSFB12; sfb++) {\n            var start = gfc.scalefac_band.psfb12[sfb];\n            var end = gfc.scalefac_band.psfb12[sfb + 1];\n            ATH_psfb12[sfb] = Float.MAX_VALUE;\n            for (var i = start; i < end; i++) {\n                var freq = i * samp_freq / (2 * 192);\n                var ATH_f = ATHmdct(gfp, freq);\n                /* freq in kHz */\n                ATH_psfb12[sfb] = Math.min(ATH_psfb12[sfb], ATH_f);\n            }\n            /* not sure about the following */\n            ATH_psfb12[sfb] *= (gfc.scalefac_band.s[13] - gfc.scalefac_band.s[12]);\n        }\n\n        /*\n         * no-ATH mode: reduce ATH to -200 dB\n         */\n        if (gfp.noATH) {\n            for (var sfb = 0; sfb < Encoder.SBMAX_l; sfb++) {\n                ATH_l[sfb] = 1E-20;\n            }\n            for (var sfb = 0; sfb < Encoder.PSFB21; sfb++) {\n                ATH_psfb21[sfb] = 1E-20;\n            }\n            for (var sfb = 0; sfb < Encoder.SBMAX_s; sfb++) {\n                ATH_s[sfb] = 1E-20;\n            }\n            for (var sfb = 0; sfb < Encoder.PSFB12; sfb++) {\n                ATH_psfb12[sfb] = 1E-20;\n            }\n        }\n\n        /*\n         * work in progress, don't rely on it too much\n         */\n        gfc.ATH.floor = 10. * Math_log10(ATHmdct(gfp, -1.));\n    }\n\n    /**\n     * initialization for iteration_loop\n     */\n    this.iteration_init = function (gfp) {\n        var gfc = gfp.internal_flags;\n        var l3_side = gfc.l3_side;\n        var i;\n\n        if (gfc.iteration_init_init == 0) {\n            gfc.iteration_init_init = 1;\n\n            l3_side.main_data_begin = 0;\n            compute_ath(gfp);\n\n            pow43[0] = 0.0;\n            for (i = 1; i < PRECALC_SIZE; i++)\n                pow43[i] = Math.pow(i, 4.0 / 3.0);\n\n            for (i = 0; i < PRECALC_SIZE - 1; i++)\n                adj43[i] = ((i + 1) - Math.pow(\n                    0.5 * (pow43[i] + pow43[i + 1]), 0.75));\n            adj43[i] = 0.5;\n\n            for (i = 0; i < Q_MAX; i++)\n                ipow20[i] = Math.pow(2.0, (i - 210) * -0.1875);\n            for (i = 0; i <= Q_MAX + Q_MAX2; i++)\n                pow20[i] = Math.pow(2.0, (i - 210 - Q_MAX2) * 0.25);\n\n            tak.huffman_init(gfc);\n\n            {\n                var bass, alto, treble, sfb21;\n\n                i = (gfp.exp_nspsytune >> 2) & 63;\n                if (i >= 32)\n                    i -= 64;\n                bass = Math.pow(10, i / 4.0 / 10.0);\n\n                i = (gfp.exp_nspsytune >> 8) & 63;\n                if (i >= 32)\n                    i -= 64;\n                alto = Math.pow(10, i / 4.0 / 10.0);\n\n                i = (gfp.exp_nspsytune >> 14) & 63;\n                if (i >= 32)\n                    i -= 64;\n                treble = Math.pow(10, i / 4.0 / 10.0);\n\n                /*\n                 * to be compatible with Naoki's original code, the next 6 bits\n                 * define only the amount of changing treble for sfb21\n                 */\n                i = (gfp.exp_nspsytune >> 20) & 63;\n                if (i >= 32)\n                    i -= 64;\n                sfb21 = treble * Math.pow(10, i / 4.0 / 10.0);\n                for (i = 0; i < Encoder.SBMAX_l; i++) {\n                    var f;\n                    if (i <= 6)\n                        f = bass;\n                    else if (i <= 13)\n                        f = alto;\n                    else if (i <= 20)\n                        f = treble;\n                    else\n                        f = sfb21;\n\n                    gfc.nsPsy.longfact[i] = f;\n                }\n                for (i = 0; i < Encoder.SBMAX_s; i++) {\n                    var f;\n                    if (i <= 5)\n                        f = bass;\n                    else if (i <= 10)\n                        f = alto;\n                    else if (i <= 11)\n                        f = treble;\n                    else\n                        f = sfb21;\n\n                    gfc.nsPsy.shortfact[i] = f;\n                }\n            }\n        }\n    }\n\n    /**\n     * allocate bits among 2 channels based on PE<BR>\n     * mt 6/99<BR>\n     * bugfixes rh 8/01: often allocated more than the allowed 4095 bits\n     */\n    this.on_pe = function (gfp, pe,\n                           targ_bits, mean_bits, gr, cbr) {\n        var gfc = gfp.internal_flags;\n        var tbits = 0, bits;\n        var add_bits = new_int(2);\n        var ch;\n\n        /* allocate targ_bits for granule */\n        var mb = new MeanBits(tbits);\n        var extra_bits = rv.ResvMaxBits(gfp, mean_bits, mb, cbr);\n        tbits = mb.bits;\n        /* maximum allowed bits for this granule */\n        var max_bits = tbits + extra_bits;\n        if (max_bits > LameInternalFlags.MAX_BITS_PER_GRANULE) {\n            // hard limit per granule\n            max_bits = LameInternalFlags.MAX_BITS_PER_GRANULE;\n        }\n        for (bits = 0, ch = 0; ch < gfc.channels_out; ++ch) {\n            /******************************************************************\n             * allocate bits for each channel\n             ******************************************************************/\n            targ_bits[ch] = Math.min(LameInternalFlags.MAX_BITS_PER_CHANNEL,\n                tbits / gfc.channels_out);\n\n            add_bits[ch] = 0 | (targ_bits[ch] * pe[gr][ch] / 700.0 - targ_bits[ch]);\n\n            /* at most increase bits by 1.5*average */\n            if (add_bits[ch] > mean_bits * 3 / 4)\n                add_bits[ch] = mean_bits * 3 / 4;\n\n            if (add_bits[ch] < 0)\n                add_bits[ch] = 0;\n\n            if (add_bits[ch] + targ_bits[ch] > LameInternalFlags.MAX_BITS_PER_CHANNEL)\n                add_bits[ch] = Math.max(0,\n                    LameInternalFlags.MAX_BITS_PER_CHANNEL - targ_bits[ch]);\n\n            bits += add_bits[ch];\n        }\n        if (bits > extra_bits) {\n            for (ch = 0; ch < gfc.channels_out; ++ch) {\n                add_bits[ch] = extra_bits * add_bits[ch] / bits;\n            }\n        }\n\n        for (ch = 0; ch < gfc.channels_out; ++ch) {\n            targ_bits[ch] += add_bits[ch];\n            extra_bits -= add_bits[ch];\n        }\n\n        for (bits = 0, ch = 0; ch < gfc.channels_out; ++ch) {\n            bits += targ_bits[ch];\n        }\n        if (bits > LameInternalFlags.MAX_BITS_PER_GRANULE) {\n            var sum = 0;\n            for (ch = 0; ch < gfc.channels_out; ++ch) {\n                targ_bits[ch] *= LameInternalFlags.MAX_BITS_PER_GRANULE;\n                targ_bits[ch] /= bits;\n                sum += targ_bits[ch];\n            }\n        }\n\n        return max_bits;\n    }\n\n    this.reduce_side = function (targ_bits, ms_ener_ratio, mean_bits, max_bits) {\n\n        /*\n         * ms_ener_ratio = 0: allocate 66/33 mid/side fac=.33 ms_ener_ratio =.5:\n         * allocate 50/50 mid/side fac= 0\n         */\n        /* 75/25 split is fac=.5 */\n        var fac = .33 * (.5 - ms_ener_ratio) / .5;\n        if (fac < 0)\n            fac = 0;\n        if (fac > .5)\n            fac = .5;\n\n        /* number of bits to move from side channel to mid channel */\n        /* move_bits = fac*targ_bits[1]; */\n        var move_bits = 0 | (fac * .5 * (targ_bits[0] + targ_bits[1]));\n\n        if (move_bits > LameInternalFlags.MAX_BITS_PER_CHANNEL - targ_bits[0]) {\n            move_bits = LameInternalFlags.MAX_BITS_PER_CHANNEL - targ_bits[0];\n        }\n        if (move_bits < 0)\n            move_bits = 0;\n\n        if (targ_bits[1] >= 125) {\n            /* dont reduce side channel below 125 bits */\n            if (targ_bits[1] - move_bits > 125) {\n\n                /* if mid channel already has 2x more than average, dont bother */\n                /* mean_bits = bits per granule (for both channels) */\n                if (targ_bits[0] < mean_bits)\n                    targ_bits[0] += move_bits;\n                targ_bits[1] -= move_bits;\n            } else {\n                targ_bits[0] += targ_bits[1] - 125;\n                targ_bits[1] = 125;\n            }\n        }\n\n        move_bits = targ_bits[0] + targ_bits[1];\n        if (move_bits > max_bits) {\n            targ_bits[0] = (max_bits * targ_bits[0]) / move_bits;\n            targ_bits[1] = (max_bits * targ_bits[1]) / move_bits;\n        }\n    };\n\n    /**\n     *  Robert Hegemann 2001-04-27:\n     *  this adjusts the ATH, keeping the original noise floor\n     *  affects the higher frequencies more than the lower ones\n     */\n    this.athAdjust = function (a, x, athFloor) {\n        /*\n         * work in progress\n         */\n        var o = 90.30873362;\n        var p = 94.82444863;\n        var u = Util.FAST_LOG10_X(x, 10.0);\n        var v = a * a;\n        var w = 0.0;\n        u -= athFloor;\n        /* undo scaling */\n        if (v > 1E-20)\n            w = 1. + Util.FAST_LOG10_X(v, 10.0 / o);\n        if (w < 0)\n            w = 0.;\n        u *= w;\n        u += athFloor + o - p;\n        /* redo scaling */\n\n        return Math.pow(10., 0.1 * u);\n    };\n\n    /**\n     * Calculate the allowed distortion for each scalefactor band, as determined\n     * by the psychoacoustic model. xmin(sb) = ratio(sb) * en(sb) / bw(sb)\n     *\n     * returns number of sfb's with energy > ATH\n     */\n    this.calc_xmin = function (gfp, ratio, cod_info, pxmin) {\n        var pxminPos = 0;\n        var gfc = gfp.internal_flags;\n        var gsfb, j = 0, ath_over = 0;\n        var ATH = gfc.ATH;\n        var xr = cod_info.xr;\n        var enable_athaa_fix = (gfp.VBR == VbrMode.vbr_mtrh) ? 1 : 0;\n        var masking_lower = gfc.masking_lower;\n\n        if (gfp.VBR == VbrMode.vbr_mtrh || gfp.VBR == VbrMode.vbr_mt) {\n            /* was already done in PSY-Model */\n            masking_lower = 1.0;\n        }\n\n        for (gsfb = 0; gsfb < cod_info.psy_lmax; gsfb++) {\n            var en0, xmin;\n            var rh1, rh2;\n            var width, l;\n\n            if (gfp.VBR == VbrMode.vbr_rh || gfp.VBR == VbrMode.vbr_mtrh)\n                xmin = athAdjust(ATH.adjust, ATH.l[gsfb], ATH.floor);\n            else\n                xmin = ATH.adjust * ATH.l[gsfb];\n\n            width = cod_info.width[gsfb];\n            rh1 = xmin / width;\n            rh2 = DBL_EPSILON;\n            l = width >> 1;\n            en0 = 0.0;\n            do {\n                var xa, xb;\n                xa = xr[j] * xr[j];\n                en0 += xa;\n                rh2 += (xa < rh1) ? xa : rh1;\n                j++;\n                xb = xr[j] * xr[j];\n                en0 += xb;\n                rh2 += (xb < rh1) ? xb : rh1;\n                j++;\n            } while (--l > 0);\n            if (en0 > xmin)\n                ath_over++;\n\n            if (gsfb == Encoder.SBPSY_l) {\n                var x = xmin * gfc.nsPsy.longfact[gsfb];\n                if (rh2 < x) {\n                    rh2 = x;\n                }\n            }\n            if (enable_athaa_fix != 0) {\n                xmin = rh2;\n            }\n            if (!gfp.ATHonly) {\n                var e = ratio.en.l[gsfb];\n                if (e > 0.0) {\n                    var x;\n                    x = en0 * ratio.thm.l[gsfb] * masking_lower / e;\n                    if (enable_athaa_fix != 0)\n                        x *= gfc.nsPsy.longfact[gsfb];\n                    if (xmin < x)\n                        xmin = x;\n                }\n            }\n            if (enable_athaa_fix != 0)\n                pxmin[pxminPos++] = xmin;\n            else\n                pxmin[pxminPos++] = xmin * gfc.nsPsy.longfact[gsfb];\n        }\n        /* end of long block loop */\n\n        /* use this function to determine the highest non-zero coeff */\n        var max_nonzero = 575;\n        if (cod_info.block_type != Encoder.SHORT_TYPE) {\n            // NORM, START or STOP type, but not SHORT\n            var k = 576;\n            while (k-- != 0 && BitStream.EQ(xr[k], 0)) {\n                max_nonzero = k;\n            }\n        }\n        cod_info.max_nonzero_coeff = max_nonzero;\n\n        for (var sfb = cod_info.sfb_smin; gsfb < cod_info.psymax; sfb++, gsfb += 3) {\n            var width, b;\n            var tmpATH;\n            if (gfp.VBR == VbrMode.vbr_rh || gfp.VBR == VbrMode.vbr_mtrh)\n                tmpATH = athAdjust(ATH.adjust, ATH.s[sfb], ATH.floor);\n            else\n                tmpATH = ATH.adjust * ATH.s[sfb];\n\n            width = cod_info.width[gsfb];\n            for (b = 0; b < 3; b++) {\n                var en0 = 0.0, xmin;\n                var rh1, rh2;\n                var l = width >> 1;\n\n                rh1 = tmpATH / width;\n                rh2 = DBL_EPSILON;\n                do {\n                    var xa, xb;\n                    xa = xr[j] * xr[j];\n                    en0 += xa;\n                    rh2 += (xa < rh1) ? xa : rh1;\n                    j++;\n                    xb = xr[j] * xr[j];\n                    en0 += xb;\n                    rh2 += (xb < rh1) ? xb : rh1;\n                    j++;\n                } while (--l > 0);\n                if (en0 > tmpATH)\n                    ath_over++;\n                if (sfb == Encoder.SBPSY_s) {\n                    var x = tmpATH * gfc.nsPsy.shortfact[sfb];\n                    if (rh2 < x) {\n                        rh2 = x;\n                    }\n                }\n                if (enable_athaa_fix != 0)\n                    xmin = rh2;\n                else\n                    xmin = tmpATH;\n\n                if (!gfp.ATHonly && !gfp.ATHshort) {\n                    var e = ratio.en.s[sfb][b];\n                    if (e > 0.0) {\n                        var x;\n                        x = en0 * ratio.thm.s[sfb][b] * masking_lower / e;\n                        if (enable_athaa_fix != 0)\n                            x *= gfc.nsPsy.shortfact[sfb];\n                        if (xmin < x)\n                            xmin = x;\n                    }\n                }\n                if (enable_athaa_fix != 0)\n                    pxmin[pxminPos++] = xmin;\n                else\n                    pxmin[pxminPos++] = xmin * gfc.nsPsy.shortfact[sfb];\n            }\n            /* b */\n            if (gfp.useTemporal) {\n                if (pxmin[pxminPos - 3] > pxmin[pxminPos - 3 + 1])\n                    pxmin[pxminPos - 3 + 1] += (pxmin[pxminPos - 3] - pxmin[pxminPos - 3 + 1])\n                        * gfc.decay;\n                if (pxmin[pxminPos - 3 + 1] > pxmin[pxminPos - 3 + 2])\n                    pxmin[pxminPos - 3 + 2] += (pxmin[pxminPos - 3 + 1] - pxmin[pxminPos - 3 + 2])\n                        * gfc.decay;\n            }\n        }\n        /* end of short block sfb loop */\n\n        return ath_over;\n    };\n\n    function StartLine(j) {\n        this.s = j;\n    }\n\n    this.calc_noise_core = function (cod_info, startline, l, step) {\n        var noise = 0;\n        var j = startline.s;\n        var ix = cod_info.l3_enc;\n\n        if (j > cod_info.count1) {\n            while ((l--) != 0) {\n                var temp;\n                temp = cod_info.xr[j];\n                j++;\n                noise += temp * temp;\n                temp = cod_info.xr[j];\n                j++;\n                noise += temp * temp;\n            }\n        } else if (j > cod_info.big_values) {\n            var ix01 = new_float(2);\n            ix01[0] = 0;\n            ix01[1] = step;\n            while ((l--) != 0) {\n                var temp;\n                temp = Math.abs(cod_info.xr[j]) - ix01[ix[j]];\n                j++;\n                noise += temp * temp;\n                temp = Math.abs(cod_info.xr[j]) - ix01[ix[j]];\n                j++;\n                noise += temp * temp;\n            }\n        } else {\n            while ((l--) != 0) {\n                var temp;\n                temp = Math.abs(cod_info.xr[j]) - pow43[ix[j]] * step;\n                j++;\n                noise += temp * temp;\n                temp = Math.abs(cod_info.xr[j]) - pow43[ix[j]] * step;\n                j++;\n                noise += temp * temp;\n            }\n        }\n\n        startline.s = j;\n        return noise;\n    }\n\n    /**\n     * <PRE>\n     * -oo dB  =>  -1.00\n     * - 6 dB  =>  -0.97\n     * - 3 dB  =>  -0.80\n     * - 2 dB  =>  -0.64\n     * - 1 dB  =>  -0.38\n     *   0 dB  =>   0.00\n     * + 1 dB  =>  +0.49\n     * + 2 dB  =>  +1.06\n     * + 3 dB  =>  +1.68\n     * + 6 dB  =>  +3.69\n     * +10 dB  =>  +6.45\n     * </PRE>\n     */\n    this.calc_noise = function (cod_info, l3_xmin, distort, res, prev_noise) {\n        var distortPos = 0;\n        var l3_xminPos = 0;\n        var sfb, l, over = 0;\n        var over_noise_db = 0;\n        /* 0 dB relative to masking */\n        var tot_noise_db = 0;\n        /* -200 dB relative to masking */\n        var max_noise = -20.0;\n        var j = 0;\n        var scalefac = cod_info.scalefac;\n        var scalefacPos = 0;\n\n        res.over_SSD = 0;\n\n        for (sfb = 0; sfb < cod_info.psymax; sfb++) {\n            var s = cod_info.global_gain\n                - (((scalefac[scalefacPos++]) + (cod_info.preflag != 0 ? pretab[sfb]\n                    : 0)) << (cod_info.scalefac_scale + 1))\n                - cod_info.subblock_gain[cod_info.window[sfb]] * 8;\n            var noise = 0.0;\n\n            if (prev_noise != null && (prev_noise.step[sfb] == s)) {\n\n                /* use previously computed values */\n                noise = prev_noise.noise[sfb];\n                j += cod_info.width[sfb];\n                distort[distortPos++] = noise / l3_xmin[l3_xminPos++];\n\n                noise = prev_noise.noise_log[sfb];\n\n            } else {\n                var step = POW20(s);\n                l = cod_info.width[sfb] >> 1;\n\n                if ((j + cod_info.width[sfb]) > cod_info.max_nonzero_coeff) {\n                    var usefullsize;\n                    usefullsize = cod_info.max_nonzero_coeff - j + 1;\n\n                    if (usefullsize > 0)\n                        l = usefullsize >> 1;\n                    else\n                        l = 0;\n                }\n\n                var sl = new StartLine(j);\n                noise = this.calc_noise_core(cod_info, sl, l, step);\n                j = sl.s;\n\n                if (prev_noise != null) {\n                    /* save noise values */\n                    prev_noise.step[sfb] = s;\n                    prev_noise.noise[sfb] = noise;\n                }\n\n                noise = distort[distortPos++] = noise / l3_xmin[l3_xminPos++];\n\n                /* multiplying here is adding in dB, but can overflow */\n                noise = Util.FAST_LOG10(Math.max(noise, 1E-20));\n\n                if (prev_noise != null) {\n                    /* save noise values */\n                    prev_noise.noise_log[sfb] = noise;\n                }\n            }\n\n            if (prev_noise != null) {\n                /* save noise values */\n                prev_noise.global_gain = cod_info.global_gain;\n            }\n\n            tot_noise_db += noise;\n\n            if (noise > 0.0) {\n                var tmp;\n\n                tmp = Math.max(0 | (noise * 10 + .5), 1);\n                res.over_SSD += tmp * tmp;\n\n                over++;\n                /* multiplying here is adding in dB -but can overflow */\n                /* over_noise *= noise; */\n                over_noise_db += noise;\n            }\n            max_noise = Math.max(max_noise, noise);\n\n        }\n\n        res.over_count = over;\n        res.tot_noise = tot_noise_db;\n        res.over_noise = over_noise_db;\n        res.max_noise = max_noise;\n\n        return over;\n    }\n\n    /**\n     * updates plotting data\n     *\n     * Mark Taylor 2000-??-??\n     *\n     * Robert Hegemann: moved noise/distortion calc into it\n     */\n    this.set_pinfo = function (gfp, cod_info, ratio, gr, ch) {\n        var gfc = gfp.internal_flags;\n        var sfb, sfb2;\n        var l;\n        var en0, en1;\n        var ifqstep = (cod_info.scalefac_scale == 0) ? .5 : 1.0;\n        var scalefac = cod_info.scalefac;\n\n        var l3_xmin = new_float(L3Side.SFBMAX);\n        var xfsf = new_float(L3Side.SFBMAX);\n        var noise = new CalcNoiseResult();\n\n        calc_xmin(gfp, ratio, cod_info, l3_xmin);\n        calc_noise(cod_info, l3_xmin, xfsf, noise, null);\n\n        var j = 0;\n        sfb2 = cod_info.sfb_lmax;\n        if (cod_info.block_type != Encoder.SHORT_TYPE\n            && 0 == cod_info.mixed_block_flag)\n            sfb2 = 22;\n        for (sfb = 0; sfb < sfb2; sfb++) {\n            var start = gfc.scalefac_band.l[sfb];\n            var end = gfc.scalefac_band.l[sfb + 1];\n            var bw = end - start;\n            for (en0 = 0.0; j < end; j++)\n                en0 += cod_info.xr[j] * cod_info.xr[j];\n            en0 /= bw;\n            /* convert to MDCT units */\n            /* scaling so it shows up on FFT plot */\n            en1 = 1e15;\n            gfc.pinfo.en[gr][ch][sfb] = en1 * en0;\n            gfc.pinfo.xfsf[gr][ch][sfb] = en1 * l3_xmin[sfb] * xfsf[sfb] / bw;\n\n            if (ratio.en.l[sfb] > 0 && !gfp.ATHonly)\n                en0 = en0 / ratio.en.l[sfb];\n            else\n                en0 = 0.0;\n\n            gfc.pinfo.thr[gr][ch][sfb] = en1\n                * Math.max(en0 * ratio.thm.l[sfb], gfc.ATH.l[sfb]);\n\n            /* there is no scalefactor bands >= SBPSY_l */\n            gfc.pinfo.LAMEsfb[gr][ch][sfb] = 0;\n            if (cod_info.preflag != 0 && sfb >= 11)\n                gfc.pinfo.LAMEsfb[gr][ch][sfb] = -ifqstep * pretab[sfb];\n\n            if (sfb < Encoder.SBPSY_l) {\n                /* scfsi should be decoded by caller side */\n                gfc.pinfo.LAMEsfb[gr][ch][sfb] -= ifqstep * scalefac[sfb];\n            }\n        }\n        /* for sfb */\n\n        if (cod_info.block_type == Encoder.SHORT_TYPE) {\n            sfb2 = sfb;\n            for (sfb = cod_info.sfb_smin; sfb < Encoder.SBMAX_s; sfb++) {\n                var start = gfc.scalefac_band.s[sfb];\n                var end = gfc.scalefac_band.s[sfb + 1];\n                var bw = end - start;\n                for (var i = 0; i < 3; i++) {\n                    for (en0 = 0.0, l = start; l < end; l++) {\n                        en0 += cod_info.xr[j] * cod_info.xr[j];\n                        j++;\n                    }\n                    en0 = Math.max(en0 / bw, 1e-20);\n                    /* convert to MDCT units */\n                    /* scaling so it shows up on FFT plot */\n                    en1 = 1e15;\n\n                    gfc.pinfo.en_s[gr][ch][3 * sfb + i] = en1 * en0;\n                    gfc.pinfo.xfsf_s[gr][ch][3 * sfb + i] = en1 * l3_xmin[sfb2]\n                        * xfsf[sfb2] / bw;\n                    if (ratio.en.s[sfb][i] > 0)\n                        en0 = en0 / ratio.en.s[sfb][i];\n                    else\n                        en0 = 0.0;\n                    if (gfp.ATHonly || gfp.ATHshort)\n                        en0 = 0;\n\n                    gfc.pinfo.thr_s[gr][ch][3 * sfb + i] = en1\n                        * Math.max(en0 * ratio.thm.s[sfb][i],\n                            gfc.ATH.s[sfb]);\n\n                    /* there is no scalefactor bands >= SBPSY_s */\n                    gfc.pinfo.LAMEsfb_s[gr][ch][3 * sfb + i] = -2.0\n                        * cod_info.subblock_gain[i];\n                    if (sfb < Encoder.SBPSY_s) {\n                        gfc.pinfo.LAMEsfb_s[gr][ch][3 * sfb + i] -= ifqstep\n                            * scalefac[sfb2];\n                    }\n                    sfb2++;\n                }\n            }\n        }\n        /* block type short */\n        gfc.pinfo.LAMEqss[gr][ch] = cod_info.global_gain;\n        gfc.pinfo.LAMEmainbits[gr][ch] = cod_info.part2_3_length\n            + cod_info.part2_length;\n        gfc.pinfo.LAMEsfbits[gr][ch] = cod_info.part2_length;\n\n        gfc.pinfo.over[gr][ch] = noise.over_count;\n        gfc.pinfo.max_noise[gr][ch] = noise.max_noise * 10.0;\n        gfc.pinfo.over_noise[gr][ch] = noise.over_noise * 10.0;\n        gfc.pinfo.tot_noise[gr][ch] = noise.tot_noise * 10.0;\n        gfc.pinfo.over_SSD[gr][ch] = noise.over_SSD;\n    }\n\n    /**\n     * updates plotting data for a whole frame\n     *\n     * Robert Hegemann 2000-10-21\n     */\n    function set_frame_pinfo(gfp, ratio) {\n        var gfc = gfp.internal_flags;\n\n        gfc.masking_lower = 1.0;\n\n        /*\n         * for every granule and channel patch l3_enc and set info\n         */\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            for (var ch = 0; ch < gfc.channels_out; ch++) {\n                var cod_info = gfc.l3_side.tt[gr][ch];\n                var scalefac_sav = new_int(L3Side.SFBMAX);\n                System.arraycopy(cod_info.scalefac, 0, scalefac_sav, 0,\n                    scalefac_sav.length);\n\n                /*\n                 * reconstruct the scalefactors in case SCFSI was used\n                 */\n                if (gr == 1) {\n                    var sfb;\n                    for (sfb = 0; sfb < cod_info.sfb_lmax; sfb++) {\n                        if (cod_info.scalefac[sfb] < 0) /* scfsi */\n                            cod_info.scalefac[sfb] = gfc.l3_side.tt[0][ch].scalefac[sfb];\n                    }\n                }\n\n                set_pinfo(gfp, cod_info, ratio[gr][ch], gr, ch);\n                System.arraycopy(scalefac_sav, 0, cod_info.scalefac, 0,\n                    scalefac_sav.length);\n            }\n            /* for ch */\n        }\n        /* for gr */\n    }\n\n}\n\n\nfunction CalcNoiseData() {\n    this.global_gain = 0;\n    this.sfb_count1 = 0;\n    this.step = new_int(39);\n    this.noise = new_float(39);\n    this.noise_log = new_float(39);\n}\n\n//package mp3;\n\n\nfunction GrInfo() {\n    //float xr[] = new float[576];\n    this.xr = new_float(576);\n    //int l3_enc[] = new int[576];\n    this.l3_enc = new_int(576);\n    //int scalefac[] = new int[L3Side.SFBMAX];\n    this.scalefac = new_int(L3Side.SFBMAX);\n    this.xrpow_max = 0.;\n\n    this.part2_3_length = 0;\n    this.big_values = 0;\n    this.count1 = 0;\n    this.global_gain = 0;\n    this.scalefac_compress = 0;\n    this.block_type = 0;\n    this.mixed_block_flag = 0;\n    this.table_select = new_int(3);\n    this.subblock_gain = new_int(3 + 1);\n    this.region0_count = 0;\n    this.region1_count = 0;\n    this.preflag = 0;\n    this.scalefac_scale = 0;\n    this.count1table_select = 0;\n\n    this.part2_length = 0;\n    this.sfb_lmax = 0;\n    this.sfb_smin = 0;\n    this.psy_lmax = 0;\n    this.sfbmax = 0;\n    this.psymax = 0;\n    this.sfbdivide = 0;\n    this.width = new_int(L3Side.SFBMAX);\n    this.window = new_int(L3Side.SFBMAX);\n    this.count1bits = 0;\n    /**\n     * added for LSF\n     */\n    this.sfb_partition_table = null;\n    this.slen = new_int(4);\n\n    this.max_nonzero_coeff = 0;\n\n    var self = this;\n    function clone_int(array) {\n        return new Int32Array(array);\n    }\n    function clone_float(array) {\n        return new Float32Array(array);\n    }\n    this.assign = function (other) {\n        self.xr = clone_float(other.xr); //.slice(0); //clone();\n        self.l3_enc = clone_int(other.l3_enc); //.slice(0); //clone();\n        self.scalefac = clone_int(other.scalefac);//.slice(0); //clone();\n        self.xrpow_max = other.xrpow_max;\n\n        self.part2_3_length = other.part2_3_length;\n        self.big_values = other.big_values;\n        self.count1 = other.count1;\n        self.global_gain = other.global_gain;\n        self.scalefac_compress = other.scalefac_compress;\n        self.block_type = other.block_type;\n        self.mixed_block_flag = other.mixed_block_flag;\n        self.table_select = clone_int(other.table_select);//.slice(0); //clone();\n        self.subblock_gain = clone_int(other.subblock_gain); //.slice(0); //.clone();\n        self.region0_count = other.region0_count;\n        self.region1_count = other.region1_count;\n        self.preflag = other.preflag;\n        self.scalefac_scale = other.scalefac_scale;\n        self.count1table_select = other.count1table_select;\n\n        self.part2_length = other.part2_length;\n        self.sfb_lmax = other.sfb_lmax;\n        self.sfb_smin = other.sfb_smin;\n        self.psy_lmax = other.psy_lmax;\n        self.sfbmax = other.sfbmax;\n        self.psymax = other.psymax;\n        self.sfbdivide = other.sfbdivide;\n        self.width = clone_int(other.width); //.slice(0); //.clone();\n        self.window = clone_int(other.window); //.slice(0); //.clone();\n        self.count1bits = other.count1bits;\n\n        self.sfb_partition_table = other.sfb_partition_table.slice(0); //.clone();\n        self.slen = clone_int(other.slen); //.slice(0); //.clone();\n        self.max_nonzero_coeff = other.max_nonzero_coeff;\n    }\n}\n\n\nvar L3Side = {};\n\n\n\t/**\n\t * max scalefactor band, max(SBMAX_l, SBMAX_s*3, (SBMAX_s-3)*3+8)\n\t */\nL3Side.SFBMAX = (Encoder.SBMAX_s * 3);\n\n/*\n * MP3 quantization\n *\n *      Copyright (c) 1999-2000 Mark Taylor\n *      Copyright (c) 1999-2003 Takehiro Tominaga\n *      Copyright (c) 2000-2007 Robert Hegemann\n *      Copyright (c) 2001-2005 Gabriel Bouvigne\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.     See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n\n/* $Id: Quantize.java,v 1.24 2011/05/24 20:48:06 kenchis Exp $ */\n\n//package mp3;\n\n//import java.util.Arrays;\n\n\nfunction Quantize() {\n    var bs;\n    this.rv = null;\n    var rv;\n    this.qupvt = null;\n    var qupvt;\n\n    var vbr = new VBRQuantize();\n    var tk;\n\n    this.setModules = function (_bs, _rv, _qupvt, _tk) {\n        bs = _bs;\n        rv = _rv;\n        this.rv = _rv;\n        qupvt = _qupvt;\n        this.qupvt = _qupvt;\n        tk = _tk;\n        vbr.setModules(qupvt, tk);\n    }\n\n    /**\n     * convert from L/R <. Mid/Side\n     */\n    this.ms_convert = function (l3_side, gr) {\n        for (var i = 0; i < 576; ++i) {\n            var l = l3_side.tt[gr][0].xr[i];\n            var r = l3_side.tt[gr][1].xr[i];\n            l3_side.tt[gr][0].xr[i] = (l + r) * (Util.SQRT2 * 0.5);\n            l3_side.tt[gr][1].xr[i] = (l - r) * (Util.SQRT2 * 0.5);\n        }\n    };\n\n    /**\n     * mt 6/99\n     *\n     * initializes cod_info, scalefac and xrpow\n     *\n     * returns 0 if all energies in xr are zero, else 1\n     */\n    function init_xrpow_core(cod_info, xrpow, upper, sum) {\n        sum = 0;\n        for (var i = 0; i <= upper; ++i) {\n            var tmp = Math.abs(cod_info.xr[i]);\n            sum += tmp;\n            xrpow[i] = Math.sqrt(tmp * Math.sqrt(tmp));\n\n            if (xrpow[i] > cod_info.xrpow_max)\n                cod_info.xrpow_max = xrpow[i];\n        }\n        return sum;\n    }\n\n    this.init_xrpow = function (gfc, cod_info, xrpow) {\n        var sum = 0;\n        var upper = 0 | cod_info.max_nonzero_coeff;\n\n        cod_info.xrpow_max = 0;\n\n        /*\n         * check if there is some energy we have to quantize and calculate xrpow\n         * matching our fresh scalefactors\n         */\n\n        Arrays.fill(xrpow, upper, 576, 0);\n\n        sum = init_xrpow_core(cod_info, xrpow, upper, sum);\n\n        /*\n         * return 1 if we have something to quantize, else 0\n         */\n        if (sum > 1E-20) {\n            var j = 0;\n            if ((gfc.substep_shaping & 2) != 0)\n                j = 1;\n\n            for (var i = 0; i < cod_info.psymax; i++)\n                gfc.pseudohalf[i] = j;\n\n            return true;\n        }\n\n        Arrays.fill(cod_info.l3_enc, 0, 576, 0);\n        return false;\n    }\n\n    /**\n     * Gabriel Bouvigne feb/apr 2003<BR>\n     * Analog silence detection in partitionned sfb21 or sfb12 for short blocks\n     *\n     * From top to bottom of sfb, changes to 0 coeffs which are below ath. It\n     * stops on the first coeff higher than ath.\n     */\n    function psfb21_analogsilence(gfc, cod_info) {\n        var ath = gfc.ATH;\n        var xr = cod_info.xr;\n\n        if (cod_info.block_type != Encoder.SHORT_TYPE) {\n            /* NORM, START or STOP type, but not SHORT blocks */\n            var stop = false;\n            for (var gsfb = Encoder.PSFB21 - 1; gsfb >= 0 && !stop; gsfb--) {\n                var start = gfc.scalefac_band.psfb21[gsfb];\n                var end = gfc.scalefac_band.psfb21[gsfb + 1];\n                var ath21 = qupvt.athAdjust(ath.adjust, ath.psfb21[gsfb],\n                    ath.floor);\n\n                if (gfc.nsPsy.longfact[21] > 1e-12)\n                    ath21 *= gfc.nsPsy.longfact[21];\n\n                for (var j = end - 1; j >= start; j--) {\n                    if (Math.abs(xr[j]) < ath21)\n                        xr[j] = 0;\n                    else {\n                        stop = true;\n                        break;\n                    }\n                }\n            }\n        } else {\n            /* note: short blocks coeffs are reordered */\n            for (var block = 0; block < 3; block++) {\n                var stop = false;\n                for (var gsfb = Encoder.PSFB12 - 1; gsfb >= 0 && !stop; gsfb--) {\n                    var start = gfc.scalefac_band.s[12]\n                        * 3\n                        + (gfc.scalefac_band.s[13] - gfc.scalefac_band.s[12])\n                        * block\n                        + (gfc.scalefac_band.psfb12[gsfb] - gfc.scalefac_band.psfb12[0]);\n                    var end = start\n                        + (gfc.scalefac_band.psfb12[gsfb + 1] - gfc.scalefac_band.psfb12[gsfb]);\n                    var ath12 = qupvt.athAdjust(ath.adjust, ath.psfb12[gsfb],\n                        ath.floor);\n\n                    if (gfc.nsPsy.shortfact[12] > 1e-12)\n                        ath12 *= gfc.nsPsy.shortfact[12];\n\n                    for (var j = end - 1; j >= start; j--) {\n                        if (Math.abs(xr[j]) < ath12)\n                            xr[j] = 0;\n                        else {\n                            stop = true;\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n\n    }\n\n    this.init_outer_loop = function (gfc, cod_info) {\n        /*\n         * initialize fresh cod_info\n         */\n        cod_info.part2_3_length = 0;\n        cod_info.big_values = 0;\n        cod_info.count1 = 0;\n        cod_info.global_gain = 210;\n        cod_info.scalefac_compress = 0;\n        /* mixed_block_flag, block_type was set in psymodel.c */\n        cod_info.table_select[0] = 0;\n        cod_info.table_select[1] = 0;\n        cod_info.table_select[2] = 0;\n        cod_info.subblock_gain[0] = 0;\n        cod_info.subblock_gain[1] = 0;\n        cod_info.subblock_gain[2] = 0;\n        cod_info.subblock_gain[3] = 0;\n        /* this one is always 0 */\n        cod_info.region0_count = 0;\n        cod_info.region1_count = 0;\n        cod_info.preflag = 0;\n        cod_info.scalefac_scale = 0;\n        cod_info.count1table_select = 0;\n        cod_info.part2_length = 0;\n        cod_info.sfb_lmax = Encoder.SBPSY_l;\n        cod_info.sfb_smin = Encoder.SBPSY_s;\n        cod_info.psy_lmax = gfc.sfb21_extra ? Encoder.SBMAX_l : Encoder.SBPSY_l;\n        cod_info.psymax = cod_info.psy_lmax;\n        cod_info.sfbmax = cod_info.sfb_lmax;\n        cod_info.sfbdivide = 11;\n        for (var sfb = 0; sfb < Encoder.SBMAX_l; sfb++) {\n            cod_info.width[sfb] = gfc.scalefac_band.l[sfb + 1]\n                - gfc.scalefac_band.l[sfb];\n            /* which is always 0. */\n            cod_info.window[sfb] = 3;\n        }\n        if (cod_info.block_type == Encoder.SHORT_TYPE) {\n            var ixwork = new_float(576);\n\n            cod_info.sfb_smin = 0;\n            cod_info.sfb_lmax = 0;\n            if (cod_info.mixed_block_flag != 0) {\n                /*\n                 * MPEG-1: sfbs 0-7 long block, 3-12 short blocks MPEG-2(.5):\n                 * sfbs 0-5 long block, 3-12 short blocks\n                 */\n                cod_info.sfb_smin = 3;\n                cod_info.sfb_lmax = gfc.mode_gr * 2 + 4;\n            }\n            cod_info.psymax = cod_info.sfb_lmax\n                + 3\n                * ((gfc.sfb21_extra ? Encoder.SBMAX_s : Encoder.SBPSY_s) - cod_info.sfb_smin);\n            cod_info.sfbmax = cod_info.sfb_lmax + 3\n                * (Encoder.SBPSY_s - cod_info.sfb_smin);\n            cod_info.sfbdivide = cod_info.sfbmax - 18;\n            cod_info.psy_lmax = cod_info.sfb_lmax;\n            /* re-order the short blocks, for more efficient encoding below */\n            /* By Takehiro TOMINAGA */\n            /*\n             * Within each scalefactor band, data is given for successive time\n             * windows, beginning with window 0 and ending with window 2. Within\n             * each window, the quantized values are then arranged in order of\n             * increasing frequency...\n             */\n            var ix = gfc.scalefac_band.l[cod_info.sfb_lmax];\n            System.arraycopy(cod_info.xr, 0, ixwork, 0, 576);\n            for (var sfb = cod_info.sfb_smin; sfb < Encoder.SBMAX_s; sfb++) {\n                var start = gfc.scalefac_band.s[sfb];\n                var end = gfc.scalefac_band.s[sfb + 1];\n                for (var window = 0; window < 3; window++) {\n                    for (var l = start; l < end; l++) {\n                        cod_info.xr[ix++] = ixwork[3 * l + window];\n                    }\n                }\n            }\n\n            var j = cod_info.sfb_lmax;\n            for (var sfb = cod_info.sfb_smin; sfb < Encoder.SBMAX_s; sfb++) {\n                cod_info.width[j] = cod_info.width[j + 1] = cod_info.width[j + 2] = gfc.scalefac_band.s[sfb + 1]\n                    - gfc.scalefac_band.s[sfb];\n                cod_info.window[j] = 0;\n                cod_info.window[j + 1] = 1;\n                cod_info.window[j + 2] = 2;\n                j += 3;\n            }\n        }\n\n        cod_info.count1bits = 0;\n        cod_info.sfb_partition_table = qupvt.nr_of_sfb_block[0][0];\n        cod_info.slen[0] = 0;\n        cod_info.slen[1] = 0;\n        cod_info.slen[2] = 0;\n        cod_info.slen[3] = 0;\n\n        cod_info.max_nonzero_coeff = 575;\n\n        /*\n         * fresh scalefactors are all zero\n         */\n        Arrays.fill(cod_info.scalefac, 0);\n\n        psfb21_analogsilence(gfc, cod_info);\n    };\n\n    function BinSearchDirection(ordinal) {\n        this.ordinal = ordinal;\n    }\n\n    BinSearchDirection.BINSEARCH_NONE = new BinSearchDirection(0);\n    BinSearchDirection.BINSEARCH_UP = new BinSearchDirection(1);\n    BinSearchDirection.BINSEARCH_DOWN = new BinSearchDirection(2);\n\n    /**\n     * author/date??\n     *\n     * binary step size search used by outer_loop to get a quantizer step size\n     * to start with\n     */\n    function bin_search_StepSize(gfc, cod_info, desired_rate, ch, xrpow) {\n        var nBits;\n        var CurrentStep = gfc.CurrentStep[ch];\n        var flagGoneOver = false;\n        var start = gfc.OldValue[ch];\n        var Direction = BinSearchDirection.BINSEARCH_NONE;\n        cod_info.global_gain = start;\n        desired_rate -= cod_info.part2_length;\n\n        for (; ;) {\n            var step;\n            nBits = tk.count_bits(gfc, xrpow, cod_info, null);\n\n            if (CurrentStep == 1 || nBits == desired_rate)\n                break;\n            /* nothing to adjust anymore */\n\n            if (nBits > desired_rate) {\n                /* increase Quantize_StepSize */\n                if (Direction == BinSearchDirection.BINSEARCH_DOWN)\n                    flagGoneOver = true;\n\n                if (flagGoneOver)\n                    CurrentStep /= 2;\n                Direction = BinSearchDirection.BINSEARCH_UP;\n                step = CurrentStep;\n            } else {\n                /* decrease Quantize_StepSize */\n                if (Direction == BinSearchDirection.BINSEARCH_UP)\n                    flagGoneOver = true;\n\n                if (flagGoneOver)\n                    CurrentStep /= 2;\n                Direction = BinSearchDirection.BINSEARCH_DOWN;\n                step = -CurrentStep;\n            }\n            cod_info.global_gain += step;\n            if (cod_info.global_gain < 0) {\n                cod_info.global_gain = 0;\n                flagGoneOver = true;\n            }\n            if (cod_info.global_gain > 255) {\n                cod_info.global_gain = 255;\n                flagGoneOver = true;\n            }\n        }\n\n\n        while (nBits > desired_rate && cod_info.global_gain < 255) {\n            cod_info.global_gain++;\n            nBits = tk.count_bits(gfc, xrpow, cod_info, null);\n        }\n        gfc.CurrentStep[ch] = (start - cod_info.global_gain >= 4) ? 4 : 2;\n        gfc.OldValue[ch] = cod_info.global_gain;\n        cod_info.part2_3_length = nBits;\n        return nBits;\n    }\n\n    this.trancate_smallspectrums = function (gfc, gi, l3_xmin, work) {\n        var distort = new_float(L3Side.SFBMAX);\n\n        if ((0 == (gfc.substep_shaping & 4) && gi.block_type == Encoder.SHORT_TYPE)\n            || (gfc.substep_shaping & 0x80) != 0)\n            return;\n        qupvt.calc_noise(gi, l3_xmin, distort, new CalcNoiseResult(), null);\n        for (var j = 0; j < 576; j++) {\n            var xr = 0.0;\n            if (gi.l3_enc[j] != 0)\n                xr = Math.abs(gi.xr[j]);\n            work[j] = xr;\n        }\n\n        var j = 0;\n        var sfb = 8;\n        if (gi.block_type == Encoder.SHORT_TYPE)\n            sfb = 6;\n        do {\n            var allowedNoise, trancateThreshold;\n            var nsame, start;\n\n            var width = gi.width[sfb];\n            j += width;\n            if (distort[sfb] >= 1.0)\n                continue;\n\n            Arrays.sort(work, j - width, width);\n            if (BitStream.EQ(work[j - 1], 0.0))\n                continue;\n            /* all zero sfb */\n\n            allowedNoise = (1.0 - distort[sfb]) * l3_xmin[sfb];\n            trancateThreshold = 0.0;\n            start = 0;\n            do {\n                var noise;\n                for (nsame = 1; start + nsame < width; nsame++)\n                    if (BitStream.NEQ(work[start + j - width], work[start + j\n                        + nsame - width]))\n                        break;\n\n                noise = work[start + j - width] * work[start + j - width]\n                    * nsame;\n                if (allowedNoise < noise) {\n                    if (start != 0)\n                        trancateThreshold = work[start + j - width - 1];\n                    break;\n                }\n                allowedNoise -= noise;\n                start += nsame;\n            } while (start < width);\n            if (BitStream.EQ(trancateThreshold, 0.0))\n                continue;\n\n            do {\n                if (Math.abs(gi.xr[j - width]) <= trancateThreshold)\n                    gi.l3_enc[j - width] = 0;\n            } while (--width > 0);\n        } while (++sfb < gi.psymax);\n\n        gi.part2_3_length = tk.noquant_count_bits(gfc, gi, null);\n    };\n\n    /**\n     * author/date??\n     *\n     * Function: Returns zero if there is a scalefac which has not been\n     * amplified. Otherwise it returns one.\n     */\n    function loop_break(cod_info) {\n        for (var sfb = 0; sfb < cod_info.sfbmax; sfb++)\n            if (cod_info.scalefac[sfb]\n                + cod_info.subblock_gain[cod_info.window[sfb]] == 0)\n                return false;\n\n        return true;\n    }\n\n    /* mt 5/99: Function: Improved calc_noise for a single channel */\n\n    function penalties(noise) {\n        return Util.FAST_LOG10((0.368 + 0.632 * noise * noise * noise));\n    }\n\n    /**\n     * author/date??\n     *\n     * several different codes to decide which quantization is better\n     */\n    function get_klemm_noise(distort, gi) {\n        var klemm_noise = 1E-37;\n        for (var sfb = 0; sfb < gi.psymax; sfb++)\n            klemm_noise += penalties(distort[sfb]);\n\n        return Math.max(1e-20, klemm_noise);\n    }\n\n    function quant_compare(quant_comp, best, calc, gi, distort) {\n        /**\n         * noise is given in decibels (dB) relative to masking thesholds.<BR>\n         *\n         * over_noise: ??? (the previous comment is fully wrong)<BR>\n         * tot_noise: ??? (the previous comment is fully wrong)<BR>\n         * max_noise: max quantization noise\n         */\n        var better;\n\n        switch (quant_comp) {\n            default:\n            case 9:\n            {\n                if (best.over_count > 0) {\n                    /* there are distorted sfb */\n                    better = calc.over_SSD <= best.over_SSD;\n                    if (calc.over_SSD == best.over_SSD)\n                        better = calc.bits < best.bits;\n                } else {\n                    /* no distorted sfb */\n                    better = ((calc.max_noise < 0) && ((calc.max_noise * 10 + calc.bits) <= (best.max_noise * 10 + best.bits)));\n                }\n                break;\n            }\n\n            case 0:\n                better = calc.over_count < best.over_count\n                    || (calc.over_count == best.over_count && calc.over_noise < best.over_noise)\n                    || (calc.over_count == best.over_count\n                    && BitStream.EQ(calc.over_noise, best.over_noise) && calc.tot_noise < best.tot_noise);\n                break;\n\n            case 8:\n                calc.max_noise = get_klemm_noise(distort, gi);\n            //$FALL-THROUGH$\n            case 1:\n                better = calc.max_noise < best.max_noise;\n                break;\n            case 2:\n                better = calc.tot_noise < best.tot_noise;\n                break;\n            case 3:\n                better = (calc.tot_noise < best.tot_noise)\n                    && (calc.max_noise < best.max_noise);\n                break;\n            case 4:\n                better = (calc.max_noise <= 0.0 && best.max_noise > 0.2)\n                    || (calc.max_noise <= 0.0 && best.max_noise < 0.0\n                    && best.max_noise > calc.max_noise - 0.2 && calc.tot_noise < best.tot_noise)\n                    || (calc.max_noise <= 0.0 && best.max_noise > 0.0\n                    && best.max_noise > calc.max_noise - 0.2 && calc.tot_noise < best.tot_noise\n                    + best.over_noise)\n                    || (calc.max_noise > 0.0 && best.max_noise > -0.05\n                    && best.max_noise > calc.max_noise - 0.1 && calc.tot_noise\n                    + calc.over_noise < best.tot_noise\n                    + best.over_noise)\n                    || (calc.max_noise > 0.0 && best.max_noise > -0.1\n                    && best.max_noise > calc.max_noise - 0.15 && calc.tot_noise\n                    + calc.over_noise + calc.over_noise < best.tot_noise\n                    + best.over_noise + best.over_noise);\n                break;\n            case 5:\n                better = calc.over_noise < best.over_noise\n                    || (BitStream.EQ(calc.over_noise, best.over_noise) && calc.tot_noise < best.tot_noise);\n                break;\n            case 6:\n                better = calc.over_noise < best.over_noise\n                    || (BitStream.EQ(calc.over_noise, best.over_noise) && (calc.max_noise < best.max_noise || (BitStream\n                        .EQ(calc.max_noise, best.max_noise) && calc.tot_noise <= best.tot_noise)));\n                break;\n            case 7:\n                better = calc.over_count < best.over_count\n                    || calc.over_noise < best.over_noise;\n                break;\n        }\n\n        if (best.over_count == 0) {\n            /*\n             * If no distorted bands, only use this quantization if it is\n             * better, and if it uses less bits. Unfortunately, part2_3_length\n             * is sometimes a poor estimator of the final size at low bitrates.\n             */\n            better = better && calc.bits < best.bits;\n        }\n\n        return better;\n    }\n\n    /**\n     * author/date??\n     *\n     * <PRE>\n     *  Amplify the scalefactor bands that violate the masking threshold.\n     *  See ISO 11172-3 Section C.1.5.4.3.5\n     *\n     *  distort[] = noise/masking\n     *  distort[] > 1   ==> noise is not masked\n     *  distort[] < 1   ==> noise is masked\n     *  max_dist = maximum value of distort[]\n     *\n     *  Three algorithms:\n     *  noise_shaping_amp\n     *        0             Amplify all bands with distort[]>1.\n     *\n     *        1             Amplify all bands with distort[] >= max_dist^(.5);\n     *                     ( 50% in the db scale)\n     *\n     *        2             Amplify first band with distort[] >= max_dist;\n     *\n     *\n     *  For algorithms 0 and 1, if max_dist < 1, then amplify all bands\n     *  with distort[] >= .95*max_dist.  This is to make sure we always\n     *  amplify at least one band.\n     * </PRE>\n     */\n    function amp_scalefac_bands(gfp, cod_info, distort, xrpow, bRefine) {\n        var gfc = gfp.internal_flags;\n        var ifqstep34;\n\n        if (cod_info.scalefac_scale == 0) {\n            ifqstep34 = 1.29683955465100964055;\n            /* 2**(.75*.5) */\n        } else {\n            ifqstep34 = 1.68179283050742922612;\n            /* 2**(.75*1) */\n        }\n\n        /* compute maximum value of distort[] */\n        var trigger = 0;\n        for (var sfb = 0; sfb < cod_info.sfbmax; sfb++) {\n            if (trigger < distort[sfb])\n                trigger = distort[sfb];\n        }\n\n        var noise_shaping_amp = gfc.noise_shaping_amp;\n        if (noise_shaping_amp == 3) {\n            if (bRefine)\n                noise_shaping_amp = 2;\n            else\n                noise_shaping_amp = 1;\n        }\n        switch (noise_shaping_amp) {\n            case 2:\n                /* amplify exactly 1 band */\n                break;\n\n            case 1:\n                /* amplify bands within 50% of max (on db scale) */\n                if (trigger > 1.0)\n                    trigger = Math.pow(trigger, .5);\n                else\n                    trigger *= .95;\n                break;\n\n            case 0:\n            default:\n                /* ISO algorithm. amplify all bands with distort>1 */\n                if (trigger > 1.0)\n                    trigger = 1.0;\n                else\n                    trigger *= .95;\n                break;\n        }\n\n        var j = 0;\n        for (var sfb = 0; sfb < cod_info.sfbmax; sfb++) {\n            var width = cod_info.width[sfb];\n            var l;\n            j += width;\n            if (distort[sfb] < trigger)\n                continue;\n\n            if ((gfc.substep_shaping & 2) != 0) {\n                gfc.pseudohalf[sfb] = (0 == gfc.pseudohalf[sfb]) ? 1 : 0;\n                if (0 == gfc.pseudohalf[sfb] && gfc.noise_shaping_amp == 2)\n                    return;\n            }\n            cod_info.scalefac[sfb]++;\n            for (l = -width; l < 0; l++) {\n                xrpow[j + l] *= ifqstep34;\n                if (xrpow[j + l] > cod_info.xrpow_max)\n                    cod_info.xrpow_max = xrpow[j + l];\n            }\n\n            if (gfc.noise_shaping_amp == 2)\n                return;\n        }\n    }\n\n    /**\n     * Takehiro Tominaga 2000-xx-xx\n     *\n     * turns on scalefac scale and adjusts scalefactors\n     */\n    function inc_scalefac_scale(cod_info, xrpow) {\n        var ifqstep34 = 1.29683955465100964055;\n\n        var j = 0;\n        for (var sfb = 0; sfb < cod_info.sfbmax; sfb++) {\n            var width = cod_info.width[sfb];\n            var s = cod_info.scalefac[sfb];\n            if (cod_info.preflag != 0)\n                s += qupvt.pretab[sfb];\n            j += width;\n            if ((s & 1) != 0) {\n                s++;\n                for (var l = -width; l < 0; l++) {\n                    xrpow[j + l] *= ifqstep34;\n                    if (xrpow[j + l] > cod_info.xrpow_max)\n                        cod_info.xrpow_max = xrpow[j + l];\n                }\n            }\n            cod_info.scalefac[sfb] = s >> 1;\n        }\n        cod_info.preflag = 0;\n        cod_info.scalefac_scale = 1;\n    }\n\n    /**\n     * Takehiro Tominaga 2000-xx-xx\n     *\n     * increases the subblock gain and adjusts scalefactors\n     */\n    function inc_subblock_gain(gfc, cod_info, xrpow) {\n        var sfb;\n        var scalefac = cod_info.scalefac;\n\n        /* subbloc_gain can't do anything in the long block region */\n        for (sfb = 0; sfb < cod_info.sfb_lmax; sfb++) {\n            if (scalefac[sfb] >= 16)\n                return true;\n        }\n\n        for (var window = 0; window < 3; window++) {\n            var s1 = 0;\n            var s2 = 0;\n\n            for (sfb = cod_info.sfb_lmax + window; sfb < cod_info.sfbdivide; sfb += 3) {\n                if (s1 < scalefac[sfb])\n                    s1 = scalefac[sfb];\n            }\n            for (; sfb < cod_info.sfbmax; sfb += 3) {\n                if (s2 < scalefac[sfb])\n                    s2 = scalefac[sfb];\n            }\n\n            if (s1 < 16 && s2 < 8)\n                continue;\n\n            if (cod_info.subblock_gain[window] >= 7)\n                return true;\n\n            /*\n             * even though there is no scalefactor for sfb12 subblock gain\n             * affects upper frequencies too, that's why we have to go up to\n             * SBMAX_s\n             */\n            cod_info.subblock_gain[window]++;\n            var j = gfc.scalefac_band.l[cod_info.sfb_lmax];\n            for (sfb = cod_info.sfb_lmax + window; sfb < cod_info.sfbmax; sfb += 3) {\n                var amp;\n                var width = cod_info.width[sfb];\n                var s = scalefac[sfb];\n                s = s - (4 >> cod_info.scalefac_scale);\n                if (s >= 0) {\n                    scalefac[sfb] = s;\n                    j += width * 3;\n                    continue;\n                }\n\n                scalefac[sfb] = 0;\n                {\n                    var gain = 210 + (s << (cod_info.scalefac_scale + 1));\n                    amp = qupvt.IPOW20(gain);\n                }\n                j += width * (window + 1);\n                for (var l = -width; l < 0; l++) {\n                    xrpow[j + l] *= amp;\n                    if (xrpow[j + l] > cod_info.xrpow_max)\n                        cod_info.xrpow_max = xrpow[j + l];\n                }\n                j += width * (3 - window - 1);\n            }\n\n            {\n                var amp = qupvt.IPOW20(202);\n                j += cod_info.width[sfb] * (window + 1);\n                for (var l = -cod_info.width[sfb]; l < 0; l++) {\n                    xrpow[j + l] *= amp;\n                    if (xrpow[j + l] > cod_info.xrpow_max)\n                        cod_info.xrpow_max = xrpow[j + l];\n                }\n            }\n        }\n        return false;\n    }\n\n    /**\n     * <PRE>\n     *  Takehiro Tominaga /date??\n     *  Robert Hegemann 2000-09-06: made a function of it\n     *\n     *  amplifies scalefactor bands,\n     *   - if all are already amplified returns 0\n     *   - if some bands are amplified too much:\n     *      * try to increase scalefac_scale\n     *      * if already scalefac_scale was set\n     *          try on short blocks to increase subblock gain\n     * </PRE>\n     */\n    function balance_noise(gfp, cod_info, distort, xrpow, bRefine) {\n        var gfc = gfp.internal_flags;\n\n        amp_scalefac_bands(gfp, cod_info, distort, xrpow, bRefine);\n\n        /*\n         * check to make sure we have not amplified too much loop_break returns\n         * 0 if there is an unamplified scalefac scale_bitcount returns 0 if no\n         * scalefactors are too large\n         */\n\n        var status = loop_break(cod_info);\n\n        if (status)\n            return false;\n        /* all bands amplified */\n\n        /*\n         * not all scalefactors have been amplified. so these scalefacs are\n         * possibly valid. encode them:\n         */\n        if (gfc.mode_gr == 2)\n            status = tk.scale_bitcount(cod_info);\n        else\n            status = tk.scale_bitcount_lsf(gfc, cod_info);\n\n        if (!status)\n            return true;\n        /* amplified some bands not exceeding limits */\n\n        /*\n         * some scalefactors are too large. lets try setting scalefac_scale=1\n         */\n        if (gfc.noise_shaping > 1) {\n            Arrays.fill(gfc.pseudohalf, 0);\n            if (0 == cod_info.scalefac_scale) {\n                inc_scalefac_scale(cod_info, xrpow);\n                status = false;\n            } else {\n                if (cod_info.block_type == Encoder.SHORT_TYPE\n                    && gfc.subblock_gain > 0) {\n                    status = (inc_subblock_gain(gfc, cod_info, xrpow) || loop_break(cod_info));\n                }\n            }\n        }\n\n        if (!status) {\n            if (gfc.mode_gr == 2)\n                status = tk.scale_bitcount(cod_info);\n            else\n                status = tk.scale_bitcount_lsf(gfc, cod_info);\n        }\n        return !status;\n    }\n\n    /**\n     * <PRE>\n     *  Function: The outer iteration loop controls the masking conditions\n     *  of all scalefactorbands. It computes the best scalefac and\n     *  global gain. This module calls the inner iteration loop\n     *\n     *  mt 5/99 completely rewritten to allow for bit reservoir control,\n     *  mid/side channels with L/R or mid/side masking thresholds,\n     *  and chooses best quantization instead of last quantization when\n     *  no distortion free quantization can be found.\n     *\n     *  added VBR support mt 5/99\n\n     *\n     *  some code shuffle rh 9/00\n     * </PRE>\n     *\n     * @param l3_xmin\n     *            allowed distortion\n     * @param xrpow\n     *            coloured magnitudes of spectral\n     * @param targ_bits\n     *            maximum allowed bits\n     */\n    this.outer_loop = function (gfp, cod_info, l3_xmin, xrpow, ch, targ_bits) {\n        var gfc = gfp.internal_flags;\n        var cod_info_w = new GrInfo();\n        var save_xrpow = new_float(576);\n        var distort = new_float(L3Side.SFBMAX);\n        var best_noise_info = new CalcNoiseResult();\n        var better;\n        var prev_noise = new CalcNoiseData();\n        var best_part2_3_length = 9999999;\n        var bEndOfSearch = false;\n        var bRefine = false;\n        var best_ggain_pass1 = 0;\n\n        bin_search_StepSize(gfc, cod_info, targ_bits, ch, xrpow);\n\n        if (0 == gfc.noise_shaping)\n        /* fast mode, no noise shaping, we are ready */\n            return 100;\n        /* default noise_info.over_count */\n\n        /* compute the distortion in this quantization */\n        /* coefficients and thresholds both l/r (or both mid/side) */\n        qupvt.calc_noise(cod_info, l3_xmin, distort, best_noise_info,\n            prev_noise);\n        best_noise_info.bits = cod_info.part2_3_length;\n\n        cod_info_w.assign(cod_info);\n        var age = 0;\n        System.arraycopy(xrpow, 0, save_xrpow, 0, 576);\n\n        while (!bEndOfSearch) {\n            /* BEGIN MAIN LOOP */\n            do {\n                var noise_info = new CalcNoiseResult();\n                var search_limit;\n                var maxggain = 255;\n\n                /*\n                 * When quantization with no distorted bands is found, allow up\n                 * to X new unsuccesful tries in serial. This gives us more\n                 * possibilities for different quant_compare modes. Much more\n                 * than 3 makes not a big difference, it is only slower.\n                 */\n\n                if ((gfc.substep_shaping & 2) != 0) {\n                    search_limit = 20;\n                } else {\n                    search_limit = 3;\n                }\n\n                /*\n                 * Check if the last scalefactor band is distorted. in VBR mode\n                 * we can't get rid of the distortion, so quit now and VBR mode\n                 * will try again with more bits. (makes a 10% speed increase,\n                 * the files I tested were binary identical, 2000/05/20 Robert\n                 * Hegemann) distort[] > 1 means noise > allowed noise\n                 */\n                if (gfc.sfb21_extra) {\n                    if (distort[cod_info_w.sfbmax] > 1.0)\n                        break;\n                    if (cod_info_w.block_type == Encoder.SHORT_TYPE\n                        && (distort[cod_info_w.sfbmax + 1] > 1.0 || distort[cod_info_w.sfbmax + 2] > 1.0))\n                        break;\n                }\n\n                /* try a new scalefactor conbination on cod_info_w */\n                if (!balance_noise(gfp, cod_info_w, distort, xrpow, bRefine))\n                    break;\n                if (cod_info_w.scalefac_scale != 0)\n                    maxggain = 254;\n\n                /*\n                 * inner_loop starts with the initial quantization step computed\n                 * above and slowly increases until the bits < huff_bits. Thus\n                 * it is important not to start with too large of an inital\n                 * quantization step. Too small is ok, but inner_loop will take\n                 * longer\n                 */\n                var huff_bits = targ_bits - cod_info_w.part2_length;\n                if (huff_bits <= 0)\n                    break;\n\n                /*\n                 * increase quantizer stepsize until needed bits are below\n                 * maximum\n                 */\n                while ((cod_info_w.part2_3_length = tk.count_bits(gfc, xrpow,\n                    cod_info_w, prev_noise)) > huff_bits\n                && cod_info_w.global_gain <= maxggain)\n                    cod_info_w.global_gain++;\n\n                if (cod_info_w.global_gain > maxggain)\n                    break;\n\n                if (best_noise_info.over_count == 0) {\n\n                    while ((cod_info_w.part2_3_length = tk.count_bits(gfc,\n                        xrpow, cod_info_w, prev_noise)) > best_part2_3_length\n                    && cod_info_w.global_gain <= maxggain)\n                        cod_info_w.global_gain++;\n\n                    if (cod_info_w.global_gain > maxggain)\n                        break;\n                }\n\n                /* compute the distortion in this quantization */\n                qupvt.calc_noise(cod_info_w, l3_xmin, distort, noise_info,\n                    prev_noise);\n                noise_info.bits = cod_info_w.part2_3_length;\n\n                /*\n                 * check if this quantization is better than our saved\n                 * quantization\n                 */\n                if (cod_info.block_type != Encoder.SHORT_TYPE) {\n                    // NORM, START or STOP type\n                    better = gfp.quant_comp;\n                } else\n                    better = gfp.quant_comp_short;\n\n                better = quant_compare(better, best_noise_info, noise_info,\n                    cod_info_w, distort) ? 1 : 0;\n\n                /* save data so we can restore this quantization later */\n                if (better != 0) {\n                    best_part2_3_length = cod_info.part2_3_length;\n                    best_noise_info = noise_info;\n                    cod_info.assign(cod_info_w);\n                    age = 0;\n                    /* save data so we can restore this quantization later */\n                    /* store for later reuse */\n                    System.arraycopy(xrpow, 0, save_xrpow, 0, 576);\n                } else {\n                    /* early stop? */\n                    if (gfc.full_outer_loop == 0) {\n                        if (++age > search_limit\n                            && best_noise_info.over_count == 0)\n                            break;\n                        if ((gfc.noise_shaping_amp == 3) && bRefine && age > 30)\n                            break;\n                        if ((gfc.noise_shaping_amp == 3)\n                            && bRefine\n                            && (cod_info_w.global_gain - best_ggain_pass1) > 15)\n                            break;\n                    }\n                }\n            } while ((cod_info_w.global_gain + cod_info_w.scalefac_scale) < 255);\n\n            if (gfc.noise_shaping_amp == 3) {\n                if (!bRefine) {\n                    /* refine search */\n                    cod_info_w.assign(cod_info);\n                    System.arraycopy(save_xrpow, 0, xrpow, 0, 576);\n                    age = 0;\n                    best_ggain_pass1 = cod_info_w.global_gain;\n\n                    bRefine = true;\n                } else {\n                    /* search already refined, stop */\n                    bEndOfSearch = true;\n                }\n\n            } else {\n                bEndOfSearch = true;\n            }\n        }\n\n        /*\n         * finish up\n         */\n        if (gfp.VBR == VbrMode.vbr_rh || gfp.VBR == VbrMode.vbr_mtrh)\n        /* restore for reuse on next try */\n            System.arraycopy(save_xrpow, 0, xrpow, 0, 576);\n        /*\n         * do the 'substep shaping'\n         */\n        else if ((gfc.substep_shaping & 1) != 0)\n            trancate_smallspectrums(gfc, cod_info, l3_xmin, xrpow);\n\n        return best_noise_info.over_count;\n    }\n\n    /**\n     * Robert Hegemann 2000-09-06\n     *\n     * update reservoir status after FINAL quantization/bitrate\n     */\n    this.iteration_finish_one = function (gfc, gr, ch) {\n        var l3_side = gfc.l3_side;\n        var cod_info = l3_side.tt[gr][ch];\n\n        /*\n         * try some better scalefac storage\n         */\n        tk.best_scalefac_store(gfc, gr, ch, l3_side);\n\n        /*\n         * best huffman_divide may save some bits too\n         */\n        if (gfc.use_best_huffman == 1)\n            tk.best_huffman_divide(gfc, cod_info);\n\n        /*\n         * update reservoir status after FINAL quantization/bitrate\n         */\n        rv.ResvAdjust(gfc, cod_info);\n    };\n\n    /**\n     *\n     * 2000-09-04 Robert Hegemann\n     *\n     * @param l3_xmin\n     *            allowed distortion of the scalefactor\n     * @param xrpow\n     *            coloured magnitudes of spectral values\n     */\n    this.VBR_encode_granule = function (gfp, cod_info, l3_xmin, xrpow, ch, min_bits, max_bits) {\n        var gfc = gfp.internal_flags;\n        var bst_cod_info = new GrInfo();\n        var bst_xrpow = new_float(576);\n        var Max_bits = max_bits;\n        var real_bits = max_bits + 1;\n        var this_bits = (max_bits + min_bits) / 2;\n        var dbits, over, found = 0;\n        var sfb21_extra = gfc.sfb21_extra;\n\n        Arrays.fill(bst_cod_info.l3_enc, 0);\n\n        /*\n         * search within round about 40 bits of optimal\n         */\n        do {\n\n            if (this_bits > Max_bits - 42)\n                gfc.sfb21_extra = false;\n            else\n                gfc.sfb21_extra = sfb21_extra;\n\n            over = outer_loop(gfp, cod_info, l3_xmin, xrpow, ch, this_bits);\n\n            /*\n             * is quantization as good as we are looking for ? in this case: is\n             * no scalefactor band distorted?\n             */\n            if (over <= 0) {\n                found = 1;\n                /*\n                 * now we know it can be done with \"real_bits\" and maybe we can\n                 * skip some iterations\n                 */\n                real_bits = cod_info.part2_3_length;\n\n                /*\n                 * store best quantization so far\n                 */\n                bst_cod_info.assign(cod_info);\n                System.arraycopy(xrpow, 0, bst_xrpow, 0, 576);\n\n                /*\n                 * try with fewer bits\n                 */\n                max_bits = real_bits - 32;\n                dbits = max_bits - min_bits;\n                this_bits = (max_bits + min_bits) / 2;\n            } else {\n                /*\n                 * try with more bits\n                 */\n                min_bits = this_bits + 32;\n                dbits = max_bits - min_bits;\n                this_bits = (max_bits + min_bits) / 2;\n\n                if (found != 0) {\n                    found = 2;\n                    /*\n                     * start again with best quantization so far\n                     */\n                    cod_info.assign(bst_cod_info);\n                    System.arraycopy(bst_xrpow, 0, xrpow, 0, 576);\n                }\n            }\n        } while (dbits > 12);\n\n        gfc.sfb21_extra = sfb21_extra;\n\n        /*\n         * found=0 => nothing found, use last one found=1 => we just found the\n         * best and left the loop found=2 => we restored a good one and have now\n         * l3_enc to restore too\n         */\n        if (found == 2) {\n            System.arraycopy(bst_cod_info.l3_enc, 0, cod_info.l3_enc, 0, 576);\n        }\n    }\n\n    /**\n     * Robert Hegemann 2000-09-05\n     *\n     * calculates * how many bits are available for analog silent granules * how\n     * many bits to use for the lowest allowed bitrate * how many bits each\n     * bitrate would provide\n     */\n    this.get_framebits = function (gfp, frameBits) {\n        var gfc = gfp.internal_flags;\n\n        /*\n         * always use at least this many bits per granule per channel unless we\n         * detect analog silence, see below\n         */\n        gfc.bitrate_index = gfc.VBR_min_bitrate;\n        var bitsPerFrame = bs.getframebits(gfp);\n\n        /*\n         * bits for analog silence\n         */\n        gfc.bitrate_index = 1;\n        bitsPerFrame = bs.getframebits(gfp);\n\n        for (var i = 1; i <= gfc.VBR_max_bitrate; i++) {\n            gfc.bitrate_index = i;\n            var mb = new MeanBits(bitsPerFrame);\n            frameBits[i] = rv.ResvFrameBegin(gfp, mb);\n            bitsPerFrame = mb.bits;\n        }\n    };\n\n    /* RH: this one needs to be overhauled sometime */\n\n    /**\n     * <PRE>\n     *  2000-09-04 Robert Hegemann\n     *\n     *  * converts LR to MS coding when necessary\n     *  * calculates allowed/adjusted quantization noise amounts\n     *  * detects analog silent frames\n     *\n     *  some remarks:\n     *  - lower masking depending on Quality setting\n     *  - quality control together with adjusted ATH MDCT scaling\n     *    on lower quality setting allocate more noise from\n     *    ATH masking, and on higher quality setting allocate\n     *    less noise from ATH masking.\n     *  - experiments show that going more than 2dB over GPSYCHO's\n     *    limits ends up in very annoying artefacts\n     * </PRE>\n     */\n    this.VBR_old_prepare = function (gfp, pe, ms_ener_ratio, ratio, l3_xmin, frameBits, min_bits,\n                                     max_bits, bands) {\n        var gfc = gfp.internal_flags;\n\n        var masking_lower_db, adjust = 0.0;\n        var analog_silence = 1;\n        var bits = 0;\n\n        gfc.bitrate_index = gfc.VBR_max_bitrate;\n        var avg = rv.ResvFrameBegin(gfp, new MeanBits(0)) / gfc.mode_gr;\n\n        get_framebits(gfp, frameBits);\n\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            var mxb = qupvt.on_pe(gfp, pe, max_bits[gr], avg, gr, 0);\n            if (gfc.mode_ext == Encoder.MPG_MD_MS_LR) {\n                ms_convert(gfc.l3_side, gr);\n                qupvt.reduce_side(max_bits[gr], ms_ener_ratio[gr], avg, mxb);\n            }\n            for (var ch = 0; ch < gfc.channels_out; ++ch) {\n                var cod_info = gfc.l3_side.tt[gr][ch];\n\n                if (cod_info.block_type != Encoder.SHORT_TYPE) {\n                    // NORM, START or STOP type\n                    adjust = 1.28 / (1 + Math\n                            .exp(3.5 - pe[gr][ch] / 300.)) - 0.05;\n                    masking_lower_db = gfc.PSY.mask_adjust - adjust;\n                } else {\n                    adjust = 2.56 / (1 + Math\n                            .exp(3.5 - pe[gr][ch] / 300.)) - 0.14;\n                    masking_lower_db = gfc.PSY.mask_adjust_short - adjust;\n                }\n                gfc.masking_lower = Math.pow(10.0,\n                    masking_lower_db * 0.1);\n\n                init_outer_loop(gfc, cod_info);\n                bands[gr][ch] = qupvt.calc_xmin(gfp, ratio[gr][ch], cod_info,\n                    l3_xmin[gr][ch]);\n                if (bands[gr][ch] != 0)\n                    analog_silence = 0;\n\n                min_bits[gr][ch] = 126;\n\n                bits += max_bits[gr][ch];\n            }\n        }\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            for (var ch = 0; ch < gfc.channels_out; ch++) {\n                if (bits > frameBits[gfc.VBR_max_bitrate]) {\n                    max_bits[gr][ch] *= frameBits[gfc.VBR_max_bitrate];\n                    max_bits[gr][ch] /= bits;\n                }\n                if (min_bits[gr][ch] > max_bits[gr][ch])\n                    min_bits[gr][ch] = max_bits[gr][ch];\n\n            }\n            /* for ch */\n        }\n        /* for gr */\n\n        return analog_silence;\n    };\n\n    this.bitpressure_strategy = function (gfc, l3_xmin, min_bits, max_bits) {\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            for (var ch = 0; ch < gfc.channels_out; ch++) {\n                var gi = gfc.l3_side.tt[gr][ch];\n                var pxmin = l3_xmin[gr][ch];\n                var pxminPos = 0;\n                for (var sfb = 0; sfb < gi.psy_lmax; sfb++)\n                    pxmin[pxminPos++] *= 1. + .029 * sfb * sfb\n                        / Encoder.SBMAX_l / Encoder.SBMAX_l;\n\n                if (gi.block_type == Encoder.SHORT_TYPE) {\n                    for (var sfb = gi.sfb_smin; sfb < Encoder.SBMAX_s; sfb++) {\n                        pxmin[pxminPos++] *= 1. + .029 * sfb * sfb\n                            / Encoder.SBMAX_s / Encoder.SBMAX_s;\n                        pxmin[pxminPos++] *= 1. + .029 * sfb * sfb\n                            / Encoder.SBMAX_s / Encoder.SBMAX_s;\n                        pxmin[pxminPos++] *= 1. + .029 * sfb * sfb\n                            / Encoder.SBMAX_s / Encoder.SBMAX_s;\n                    }\n                }\n                max_bits[gr][ch] = 0 | Math.max(min_bits[gr][ch],\n                        0.9 * max_bits[gr][ch]);\n            }\n        }\n    };\n\n    this.VBR_new_prepare = function (gfp, pe, ratio, l3_xmin, frameBits, max_bits) {\n        var gfc = gfp.internal_flags;\n\n        var analog_silence = 1;\n        var avg = 0, bits = 0;\n        var maximum_framebits;\n\n        if (!gfp.free_format) {\n            gfc.bitrate_index = gfc.VBR_max_bitrate;\n\n            var mb = new MeanBits(avg);\n            rv.ResvFrameBegin(gfp, mb);\n            avg = mb.bits;\n\n            get_framebits(gfp, frameBits);\n            maximum_framebits = frameBits[gfc.VBR_max_bitrate];\n        } else {\n            gfc.bitrate_index = 0;\n            var mb = new MeanBits(avg);\n            maximum_framebits = rv.ResvFrameBegin(gfp, mb);\n            avg = mb.bits;\n            frameBits[0] = maximum_framebits;\n        }\n\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            qupvt.on_pe(gfp, pe, max_bits[gr], avg, gr, 0);\n            if (gfc.mode_ext == Encoder.MPG_MD_MS_LR) {\n                ms_convert(gfc.l3_side, gr);\n            }\n            for (var ch = 0; ch < gfc.channels_out; ++ch) {\n                var cod_info = gfc.l3_side.tt[gr][ch];\n\n                gfc.masking_lower = Math.pow(10.0,\n                    gfc.PSY.mask_adjust * 0.1);\n\n                init_outer_loop(gfc, cod_info);\n                if (0 != qupvt.calc_xmin(gfp, ratio[gr][ch], cod_info,\n                        l3_xmin[gr][ch]))\n                    analog_silence = 0;\n\n                bits += max_bits[gr][ch];\n            }\n        }\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            for (var ch = 0; ch < gfc.channels_out; ch++) {\n                if (bits > maximum_framebits) {\n                    max_bits[gr][ch] *= maximum_framebits;\n                    max_bits[gr][ch] /= bits;\n                }\n\n            }\n            /* for ch */\n        }\n        /* for gr */\n\n        return analog_silence;\n    };\n\n    /**\n     * calculates target bits for ABR encoding\n     *\n     * mt 2000/05/31\n     */\n    this.calc_target_bits = function (gfp, pe, ms_ener_ratio, targ_bits, analog_silence_bits, max_frame_bits) {\n        var gfc = gfp.internal_flags;\n        var l3_side = gfc.l3_side;\n        var res_factor;\n        var gr, ch, totbits, mean_bits = 0;\n\n        gfc.bitrate_index = gfc.VBR_max_bitrate;\n        var mb = new MeanBits(mean_bits);\n        max_frame_bits[0] = rv.ResvFrameBegin(gfp, mb);\n        mean_bits = mb.bits;\n\n        gfc.bitrate_index = 1;\n        mean_bits = bs.getframebits(gfp) - gfc.sideinfo_len * 8;\n        analog_silence_bits[0] = mean_bits / (gfc.mode_gr * gfc.channels_out);\n\n        mean_bits = gfp.VBR_mean_bitrate_kbps * gfp.framesize * 1000;\n        if ((gfc.substep_shaping & 1) != 0)\n            mean_bits *= 1.09;\n        mean_bits /= gfp.out_samplerate;\n        mean_bits -= gfc.sideinfo_len * 8;\n        mean_bits /= (gfc.mode_gr * gfc.channels_out);\n\n        /**\n         * <PRE>\n         *           res_factor is the percentage of the target bitrate that should\n         *           be used on average.  the remaining bits are added to the\n         *           bitreservoir and used for difficult to encode frames.\n         *\n         *           Since we are tracking the average bitrate, we should adjust\n         *           res_factor \"on the fly\", increasing it if the average bitrate\n         *           is greater than the requested bitrate, and decreasing it\n         *           otherwise.  Reasonable ranges are from .9 to 1.0\n         *\n         *           Until we get the above suggestion working, we use the following\n         *           tuning:\n         *           compression ratio    res_factor\n         *           5.5  (256kbps)         1.0      no need for bitreservoir\n         *           11   (128kbps)         .93      7% held for reservoir\n         *\n         *           with linear interpolation for other values.\n         * </PRE>\n         */\n        res_factor = .93 + .07 * (11.0 - gfp.compression_ratio)\n            / (11.0 - 5.5);\n        if (res_factor < .90)\n            res_factor = .90;\n        if (res_factor > 1.00)\n            res_factor = 1.00;\n\n        for (gr = 0; gr < gfc.mode_gr; gr++) {\n            var sum = 0;\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                targ_bits[gr][ch] = (int)(res_factor * mean_bits);\n\n                if (pe[gr][ch] > 700) {\n                    var add_bits = (int)((pe[gr][ch] - 700) / 1.4);\n\n                    var cod_info = l3_side.tt[gr][ch];\n                    targ_bits[gr][ch] = (int)(res_factor * mean_bits);\n\n                    /* short blocks use a little extra, no matter what the pe */\n                    if (cod_info.block_type == Encoder.SHORT_TYPE) {\n                        if (add_bits < mean_bits / 2)\n                            add_bits = mean_bits / 2;\n                    }\n                    /* at most increase bits by 1.5*average */\n                    if (add_bits > mean_bits * 3 / 2)\n                        add_bits = mean_bits * 3 / 2;\n                    else if (add_bits < 0)\n                        add_bits = 0;\n\n                    targ_bits[gr][ch] += add_bits;\n                }\n                if (targ_bits[gr][ch] > LameInternalFlags.MAX_BITS_PER_CHANNEL) {\n                    targ_bits[gr][ch] = LameInternalFlags.MAX_BITS_PER_CHANNEL;\n                }\n                sum += targ_bits[gr][ch];\n            }\n            /* for ch */\n            if (sum > LameInternalFlags.MAX_BITS_PER_GRANULE) {\n                for (ch = 0; ch < gfc.channels_out; ++ch) {\n                    targ_bits[gr][ch] *= LameInternalFlags.MAX_BITS_PER_GRANULE;\n                    targ_bits[gr][ch] /= sum;\n                }\n            }\n        }\n        /* for gr */\n\n        if (gfc.mode_ext == Encoder.MPG_MD_MS_LR)\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                qupvt.reduce_side(targ_bits[gr], ms_ener_ratio[gr], mean_bits\n                    * gfc.channels_out,\n                    LameInternalFlags.MAX_BITS_PER_GRANULE);\n            }\n\n        /*\n         * sum target bits\n         */\n        totbits = 0;\n        for (gr = 0; gr < gfc.mode_gr; gr++) {\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                if (targ_bits[gr][ch] > LameInternalFlags.MAX_BITS_PER_CHANNEL)\n                    targ_bits[gr][ch] = LameInternalFlags.MAX_BITS_PER_CHANNEL;\n                totbits += targ_bits[gr][ch];\n            }\n        }\n\n        /*\n         * repartion target bits if needed\n         */\n        if (totbits > max_frame_bits[0]) {\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    targ_bits[gr][ch] *= max_frame_bits[0];\n                    targ_bits[gr][ch] /= totbits;\n                }\n            }\n        }\n    }\n\n}\n\n/*\n *      MP3 window subband -> subband filtering -> mdct routine\n *\n *      Copyright (c) 1999-2000 Takehiro Tominaga\n *\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Library General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n/*\n *         Special Thanks to Patrick De Smet for your advices.\n */\n\n/* $Id: NewMDCT.java,v 1.11 2011/05/24 20:48:06 kenchis Exp $ */\n\n//package mp3;\n\n//import java.util.Arrays;\n\n\n\nfunction NewMDCT() {\n\n\tvar enwindow = [\n\t\t\t-4.77e-07 * 0.740951125354959 / 2.384e-06,\n\t\t\t1.03951e-04 * 0.740951125354959 / 2.384e-06,\n\t\t\t9.53674e-04 * 0.740951125354959 / 2.384e-06,\n\t\t\t2.841473e-03 * 0.740951125354959 / 2.384e-06,\n\t\t\t3.5758972e-02 * 0.740951125354959 / 2.384e-06,\n\t\t\t3.401756e-03 * 0.740951125354959 / 2.384e-06,\n\t\t\t9.83715e-04 * 0.740951125354959 / 2.384e-06,\n\t\t\t9.9182e-05 * 0.740951125354959 / 2.384e-06, /* 15 */\n\t\t\t1.2398e-05 * 0.740951125354959 / 2.384e-06,\n\t\t\t1.91212e-04 * 0.740951125354959 / 2.384e-06,\n\t\t\t2.283096e-03 * 0.740951125354959 / 2.384e-06,\n\t\t\t1.6994476e-02 * 0.740951125354959 / 2.384e-06,\n\t\t\t-1.8756866e-02 * 0.740951125354959 / 2.384e-06,\n\t\t\t-2.630711e-03 * 0.740951125354959 / 2.384e-06,\n\t\t\t-2.47478e-04 * 0.740951125354959 / 2.384e-06,\n\t\t\t-1.4782e-05 * 0.740951125354959 / 2.384e-06,\n\t\t\t9.063471690191471e-01, 1.960342806591213e-01,\n\n\t\t\t-4.77e-07 * 0.773010453362737 / 2.384e-06,\n\t\t\t1.05858e-04 * 0.773010453362737 / 2.384e-06,\n\t\t\t9.30786e-04 * 0.773010453362737 / 2.384e-06,\n\t\t\t2.521515e-03 * 0.773010453362737 / 2.384e-06,\n\t\t\t3.5694122e-02 * 0.773010453362737 / 2.384e-06,\n\t\t\t3.643036e-03 * 0.773010453362737 / 2.384e-06,\n\t\t\t9.91821e-04 * 0.773010453362737 / 2.384e-06,\n\t\t\t9.6321e-05 * 0.773010453362737 / 2.384e-06, /* 14 */\n\t\t\t1.1444e-05 * 0.773010453362737 / 2.384e-06,\n\t\t\t1.65462e-04 * 0.773010453362737 / 2.384e-06,\n\t\t\t2.110004e-03 * 0.773010453362737 / 2.384e-06,\n\t\t\t1.6112804e-02 * 0.773010453362737 / 2.384e-06,\n\t\t\t-1.9634247e-02 * 0.773010453362737 / 2.384e-06,\n\t\t\t-2.803326e-03 * 0.773010453362737 / 2.384e-06,\n\t\t\t-2.77042e-04 * 0.773010453362737 / 2.384e-06,\n\t\t\t-1.6689e-05 * 0.773010453362737 / 2.384e-06,\n\t\t\t8.206787908286602e-01, 3.901806440322567e-01,\n\n\t\t\t-4.77e-07 * 0.803207531480645 / 2.384e-06,\n\t\t\t1.07288e-04 * 0.803207531480645 / 2.384e-06,\n\t\t\t9.02653e-04 * 0.803207531480645 / 2.384e-06,\n\t\t\t2.174854e-03 * 0.803207531480645 / 2.384e-06,\n\t\t\t3.5586357e-02 * 0.803207531480645 / 2.384e-06,\n\t\t\t3.858566e-03 * 0.803207531480645 / 2.384e-06,\n\t\t\t9.95159e-04 * 0.803207531480645 / 2.384e-06,\n\t\t\t9.3460e-05 * 0.803207531480645 / 2.384e-06, /* 13 */\n\t\t\t1.0014e-05 * 0.803207531480645 / 2.384e-06,\n\t\t\t1.40190e-04 * 0.803207531480645 / 2.384e-06,\n\t\t\t1.937389e-03 * 0.803207531480645 / 2.384e-06,\n\t\t\t1.5233517e-02 * 0.803207531480645 / 2.384e-06,\n\t\t\t-2.0506859e-02 * 0.803207531480645 / 2.384e-06,\n\t\t\t-2.974033e-03 * 0.803207531480645 / 2.384e-06,\n\t\t\t-3.07560e-04 * 0.803207531480645 / 2.384e-06,\n\t\t\t-1.8120e-05 * 0.803207531480645 / 2.384e-06,\n\t\t\t7.416505462720353e-01, 5.805693545089249e-01,\n\n\t\t\t-4.77e-07 * 0.831469612302545 / 2.384e-06,\n\t\t\t1.08242e-04 * 0.831469612302545 / 2.384e-06,\n\t\t\t8.68797e-04 * 0.831469612302545 / 2.384e-06,\n\t\t\t1.800537e-03 * 0.831469612302545 / 2.384e-06,\n\t\t\t3.5435200e-02 * 0.831469612302545 / 2.384e-06,\n\t\t\t4.049301e-03 * 0.831469612302545 / 2.384e-06,\n\t\t\t9.94205e-04 * 0.831469612302545 / 2.384e-06,\n\t\t\t9.0599e-05 * 0.831469612302545 / 2.384e-06, /* 12 */\n\t\t\t9.060e-06 * 0.831469612302545 / 2.384e-06,\n\t\t\t1.16348e-04 * 0.831469612302545 / 2.384e-06,\n\t\t\t1.766682e-03 * 0.831469612302545 / 2.384e-06,\n\t\t\t1.4358521e-02 * 0.831469612302545 / 2.384e-06,\n\t\t\t-2.1372318e-02 * 0.831469612302545 / 2.384e-06,\n\t\t\t-3.14188e-03 * 0.831469612302545 / 2.384e-06,\n\t\t\t-3.39031e-04 * 0.831469612302545 / 2.384e-06,\n\t\t\t-1.9550e-05 * 0.831469612302545 / 2.384e-06,\n\t\t\t6.681786379192989e-01, 7.653668647301797e-01,\n\n\t\t\t-4.77e-07 * 0.857728610000272 / 2.384e-06,\n\t\t\t1.08719e-04 * 0.857728610000272 / 2.384e-06,\n\t\t\t8.29220e-04 * 0.857728610000272 / 2.384e-06,\n\t\t\t1.399517e-03 * 0.857728610000272 / 2.384e-06,\n\t\t\t3.5242081e-02 * 0.857728610000272 / 2.384e-06,\n\t\t\t4.215240e-03 * 0.857728610000272 / 2.384e-06,\n\t\t\t9.89437e-04 * 0.857728610000272 / 2.384e-06,\n\t\t\t8.7261e-05 * 0.857728610000272 / 2.384e-06, /* 11 */\n\t\t\t8.106e-06 * 0.857728610000272 / 2.384e-06,\n\t\t\t9.3937e-05 * 0.857728610000272 / 2.384e-06,\n\t\t\t1.597881e-03 * 0.857728610000272 / 2.384e-06,\n\t\t\t1.3489246e-02 * 0.857728610000272 / 2.384e-06,\n\t\t\t-2.2228718e-02 * 0.857728610000272 / 2.384e-06,\n\t\t\t-3.306866e-03 * 0.857728610000272 / 2.384e-06,\n\t\t\t-3.71456e-04 * 0.857728610000272 / 2.384e-06,\n\t\t\t-2.1458e-05 * 0.857728610000272 / 2.384e-06,\n\t\t\t5.993769336819237e-01, 9.427934736519954e-01,\n\n\t\t\t-4.77e-07 * 0.881921264348355 / 2.384e-06,\n\t\t\t1.08719e-04 * 0.881921264348355 / 2.384e-06,\n\t\t\t7.8392e-04 * 0.881921264348355 / 2.384e-06,\n\t\t\t9.71317e-04 * 0.881921264348355 / 2.384e-06,\n\t\t\t3.5007000e-02 * 0.881921264348355 / 2.384e-06,\n\t\t\t4.357815e-03 * 0.881921264348355 / 2.384e-06,\n\t\t\t9.80854e-04 * 0.881921264348355 / 2.384e-06,\n\t\t\t8.3923e-05 * 0.881921264348355 / 2.384e-06, /* 10 */\n\t\t\t7.629e-06 * 0.881921264348355 / 2.384e-06,\n\t\t\t7.2956e-05 * 0.881921264348355 / 2.384e-06,\n\t\t\t1.432419e-03 * 0.881921264348355 / 2.384e-06,\n\t\t\t1.2627602e-02 * 0.881921264348355 / 2.384e-06,\n\t\t\t-2.3074150e-02 * 0.881921264348355 / 2.384e-06,\n\t\t\t-3.467083e-03 * 0.881921264348355 / 2.384e-06,\n\t\t\t-4.04358e-04 * 0.881921264348355 / 2.384e-06,\n\t\t\t-2.3365e-05 * 0.881921264348355 / 2.384e-06,\n\t\t\t5.345111359507916e-01, 1.111140466039205e+00,\n\n\t\t\t-9.54e-07 * 0.903989293123443 / 2.384e-06,\n\t\t\t1.08242e-04 * 0.903989293123443 / 2.384e-06,\n\t\t\t7.31945e-04 * 0.903989293123443 / 2.384e-06,\n\t\t\t5.15938e-04 * 0.903989293123443 / 2.384e-06,\n\t\t\t3.4730434e-02 * 0.903989293123443 / 2.384e-06,\n\t\t\t4.477024e-03 * 0.903989293123443 / 2.384e-06,\n\t\t\t9.68933e-04 * 0.903989293123443 / 2.384e-06,\n\t\t\t8.0585e-05 * 0.903989293123443 / 2.384e-06, /* 9 */\n\t\t\t6.676e-06 * 0.903989293123443 / 2.384e-06,\n\t\t\t5.2929e-05 * 0.903989293123443 / 2.384e-06,\n\t\t\t1.269817e-03 * 0.903989293123443 / 2.384e-06,\n\t\t\t1.1775017e-02 * 0.903989293123443 / 2.384e-06,\n\t\t\t-2.3907185e-02 * 0.903989293123443 / 2.384e-06,\n\t\t\t-3.622532e-03 * 0.903989293123443 / 2.384e-06,\n\t\t\t-4.38213e-04 * 0.903989293123443 / 2.384e-06,\n\t\t\t-2.5272e-05 * 0.903989293123443 / 2.384e-06,\n\t\t\t4.729647758913199e-01, 1.268786568327291e+00,\n\n\t\t\t-9.54e-07 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t1.06812e-04 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t6.74248e-04 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t3.3379e-05 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t3.4412861e-02 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t4.573822e-03 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t9.54151e-04 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t7.6771e-05 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t6.199e-06 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t3.4332e-05 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t1.111031e-03 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t1.0933399e-02 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t-2.4725437e-02 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t-3.771782e-03 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t-4.72546e-04 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t-2.7657e-05 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t4.1421356237309504879e-01, /* tan(PI/8) */\n\t\t\t1.414213562373095e+00,\n\n\t\t\t-9.54e-07 * 0.941544065183021 / 2.384e-06,\n\t\t\t1.05381e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t6.10352e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t-4.75883e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t3.4055710e-02 * 0.941544065183021 / 2.384e-06,\n\t\t\t4.649162e-03 * 0.941544065183021 / 2.384e-06,\n\t\t\t9.35555e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t7.3433e-05 * 0.941544065183021 / 2.384e-06, /* 7 */\n\t\t\t5.245e-06 * 0.941544065183021 / 2.384e-06,\n\t\t\t1.7166e-05 * 0.941544065183021 / 2.384e-06,\n\t\t\t9.56535e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t1.0103703e-02 * 0.941544065183021 / 2.384e-06,\n\t\t\t-2.5527000e-02 * 0.941544065183021 / 2.384e-06,\n\t\t\t-3.914356e-03 * 0.941544065183021 / 2.384e-06,\n\t\t\t-5.07355e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t-3.0041e-05 * 0.941544065183021 / 2.384e-06,\n\t\t\t3.578057213145241e-01, 1.546020906725474e+00,\n\n\t\t\t-9.54e-07 * 0.956940335732209 / 2.384e-06,\n\t\t\t1.02520e-04 * 0.956940335732209 / 2.384e-06,\n\t\t\t5.39303e-04 * 0.956940335732209 / 2.384e-06,\n\t\t\t-1.011848e-03 * 0.956940335732209 / 2.384e-06,\n\t\t\t3.3659935e-02 * 0.956940335732209 / 2.384e-06,\n\t\t\t4.703045e-03 * 0.956940335732209 / 2.384e-06,\n\t\t\t9.15051e-04 * 0.956940335732209 / 2.384e-06,\n\t\t\t7.0095e-05 * 0.956940335732209 / 2.384e-06, /* 6 */\n\t\t\t4.768e-06 * 0.956940335732209 / 2.384e-06,\n\t\t\t9.54e-07 * 0.956940335732209 / 2.384e-06,\n\t\t\t8.06808e-04 * 0.956940335732209 / 2.384e-06,\n\t\t\t9.287834e-03 * 0.956940335732209 / 2.384e-06,\n\t\t\t-2.6310921e-02 * 0.956940335732209 / 2.384e-06,\n\t\t\t-4.048824e-03 * 0.956940335732209 / 2.384e-06,\n\t\t\t-5.42164e-04 * 0.956940335732209 / 2.384e-06,\n\t\t\t-3.2425e-05 * 0.956940335732209 / 2.384e-06,\n\t\t\t3.033466836073424e-01, 1.662939224605090e+00,\n\n\t\t\t-1.431e-06 * 0.970031253194544 / 2.384e-06,\n\t\t\t9.9182e-05 * 0.970031253194544 / 2.384e-06,\n\t\t\t4.62532e-04 * 0.970031253194544 / 2.384e-06,\n\t\t\t-1.573563e-03 * 0.970031253194544 / 2.384e-06,\n\t\t\t3.3225536e-02 * 0.970031253194544 / 2.384e-06,\n\t\t\t4.737377e-03 * 0.970031253194544 / 2.384e-06,\n\t\t\t8.91685e-04 * 0.970031253194544 / 2.384e-06,\n\t\t\t6.6280e-05 * 0.970031253194544 / 2.384e-06, /* 5 */\n\t\t\t4.292e-06 * 0.970031253194544 / 2.384e-06,\n\t\t\t-1.3828e-05 * 0.970031253194544 / 2.384e-06,\n\t\t\t6.61850e-04 * 0.970031253194544 / 2.384e-06,\n\t\t\t8.487225e-03 * 0.970031253194544 / 2.384e-06,\n\t\t\t-2.7073860e-02 * 0.970031253194544 / 2.384e-06,\n\t\t\t-4.174709e-03 * 0.970031253194544 / 2.384e-06,\n\t\t\t-5.76973e-04 * 0.970031253194544 / 2.384e-06,\n\t\t\t-3.4809e-05 * 0.970031253194544 / 2.384e-06,\n\t\t\t2.504869601913055e-01, 1.763842528696710e+00,\n\n\t\t\t-1.431e-06 * 0.98078528040323 / 2.384e-06,\n\t\t\t9.5367e-05 * 0.98078528040323 / 2.384e-06,\n\t\t\t3.78609e-04 * 0.98078528040323 / 2.384e-06,\n\t\t\t-2.161503e-03 * 0.98078528040323 / 2.384e-06,\n\t\t\t3.2754898e-02 * 0.98078528040323 / 2.384e-06,\n\t\t\t4.752159e-03 * 0.98078528040323 / 2.384e-06,\n\t\t\t8.66413e-04 * 0.98078528040323 / 2.384e-06,\n\t\t\t6.2943e-05 * 0.98078528040323 / 2.384e-06, /* 4 */\n\t\t\t3.815e-06 * 0.98078528040323 / 2.384e-06,\n\t\t\t-2.718e-05 * 0.98078528040323 / 2.384e-06,\n\t\t\t5.22137e-04 * 0.98078528040323 / 2.384e-06,\n\t\t\t7.703304e-03 * 0.98078528040323 / 2.384e-06,\n\t\t\t-2.7815342e-02 * 0.98078528040323 / 2.384e-06,\n\t\t\t-4.290581e-03 * 0.98078528040323 / 2.384e-06,\n\t\t\t-6.11782e-04 * 0.98078528040323 / 2.384e-06,\n\t\t\t-3.7670e-05 * 0.98078528040323 / 2.384e-06,\n\t\t\t1.989123673796580e-01, 1.847759065022573e+00,\n\n\t\t\t-1.907e-06 * 0.989176509964781 / 2.384e-06,\n\t\t\t9.0122e-05 * 0.989176509964781 / 2.384e-06,\n\t\t\t2.88486e-04 * 0.989176509964781 / 2.384e-06,\n\t\t\t-2.774239e-03 * 0.989176509964781 / 2.384e-06,\n\t\t\t3.2248020e-02 * 0.989176509964781 / 2.384e-06,\n\t\t\t4.748821e-03 * 0.989176509964781 / 2.384e-06,\n\t\t\t8.38757e-04 * 0.989176509964781 / 2.384e-06,\n\t\t\t5.9605e-05 * 0.989176509964781 / 2.384e-06, /* 3 */\n\t\t\t3.338e-06 * 0.989176509964781 / 2.384e-06,\n\t\t\t-3.9577e-05 * 0.989176509964781 / 2.384e-06,\n\t\t\t3.88145e-04 * 0.989176509964781 / 2.384e-06,\n\t\t\t6.937027e-03 * 0.989176509964781 / 2.384e-06,\n\t\t\t-2.8532982e-02 * 0.989176509964781 / 2.384e-06,\n\t\t\t-4.395962e-03 * 0.989176509964781 / 2.384e-06,\n\t\t\t-6.46591e-04 * 0.989176509964781 / 2.384e-06,\n\t\t\t-4.0531e-05 * 0.989176509964781 / 2.384e-06,\n\t\t\t1.483359875383474e-01, 1.913880671464418e+00,\n\n\t\t\t-1.907e-06 * 0.995184726672197 / 2.384e-06,\n\t\t\t8.4400e-05 * 0.995184726672197 / 2.384e-06,\n\t\t\t1.91689e-04 * 0.995184726672197 / 2.384e-06,\n\t\t\t-3.411293e-03 * 0.995184726672197 / 2.384e-06,\n\t\t\t3.1706810e-02 * 0.995184726672197 / 2.384e-06,\n\t\t\t4.728317e-03 * 0.995184726672197 / 2.384e-06,\n\t\t\t8.09669e-04 * 0.995184726672197 / 2.384e-06,\n\t\t\t5.579e-05 * 0.995184726672197 / 2.384e-06,\n\t\t\t3.338e-06 * 0.995184726672197 / 2.384e-06,\n\t\t\t-5.0545e-05 * 0.995184726672197 / 2.384e-06,\n\t\t\t2.59876e-04 * 0.995184726672197 / 2.384e-06,\n\t\t\t6.189346e-03 * 0.995184726672197 / 2.384e-06,\n\t\t\t-2.9224873e-02 * 0.995184726672197 / 2.384e-06,\n\t\t\t-4.489899e-03 * 0.995184726672197 / 2.384e-06,\n\t\t\t-6.80923e-04 * 0.995184726672197 / 2.384e-06,\n\t\t\t-4.3392e-05 * 0.995184726672197 / 2.384e-06,\n\t\t\t9.849140335716425e-02, 1.961570560806461e+00,\n\n\t\t\t-2.384e-06 * 0.998795456205172 / 2.384e-06,\n\t\t\t7.7724e-05 * 0.998795456205172 / 2.384e-06,\n\t\t\t8.8215e-05 * 0.998795456205172 / 2.384e-06,\n\t\t\t-4.072189e-03 * 0.998795456205172 / 2.384e-06,\n\t\t\t3.1132698e-02 * 0.998795456205172 / 2.384e-06,\n\t\t\t4.691124e-03 * 0.998795456205172 / 2.384e-06,\n\t\t\t7.79152e-04 * 0.998795456205172 / 2.384e-06,\n\t\t\t5.2929e-05 * 0.998795456205172 / 2.384e-06,\n\t\t\t2.861e-06 * 0.998795456205172 / 2.384e-06,\n\t\t\t-6.0558e-05 * 0.998795456205172 / 2.384e-06,\n\t\t\t1.37329e-04 * 0.998795456205172 / 2.384e-06,\n\t\t\t5.462170e-03 * 0.998795456205172 / 2.384e-06,\n\t\t\t-2.9890060e-02 * 0.998795456205172 / 2.384e-06,\n\t\t\t-4.570484e-03 * 0.998795456205172 / 2.384e-06,\n\t\t\t-7.14302e-04 * 0.998795456205172 / 2.384e-06,\n\t\t\t-4.6253e-05 * 0.998795456205172 / 2.384e-06,\n\t\t\t4.912684976946725e-02, 1.990369453344394e+00,\n\n\t\t\t3.5780907e-02 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t1.7876148e-02 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t3.134727e-03 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t2.457142e-03 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t9.71317e-04 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t2.18868e-04 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t1.01566e-04 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t1.3828e-05 * Util.SQRT2 * 0.5 / 2.384e-06,\n\n\t\t\t3.0526638e-02 / 2.384e-06, 4.638195e-03 / 2.384e-06,\n\t\t\t7.47204e-04 / 2.384e-06, 4.9591e-05 / 2.384e-06,\n\t\t\t4.756451e-03 / 2.384e-06, 2.1458e-05 / 2.384e-06,\n\t\t\t-6.9618e-05 / 2.384e-06, /* 2.384e-06/2.384e-06 */\n\t];\n\n\tvar NS = 12;\n\tvar NL = 36;\n\n\tvar win = [\n\t    [\n\t     2.382191739347913e-13,\n\t     6.423305872147834e-13,\n\t     9.400849094049688e-13,\n\t     1.122435026096556e-12,\n\t     1.183840321267481e-12,\n\t     1.122435026096556e-12,\n\t     9.400849094049690e-13,\n\t     6.423305872147839e-13,\n\t     2.382191739347918e-13,\n\n\t     5.456116108943412e-12,\n\t     4.878985199565852e-12,\n\t     4.240448995017367e-12,\n\t     3.559909094758252e-12,\n\t     2.858043359288075e-12,\n\t     2.156177623817898e-12,\n\t     1.475637723558783e-12,\n\t     8.371015190102974e-13,\n\t     2.599706096327376e-13,\n\n\t     -5.456116108943412e-12,\n\t     -4.878985199565852e-12,\n\t     -4.240448995017367e-12,\n\t     -3.559909094758252e-12,\n\t     -2.858043359288076e-12,\n\t     -2.156177623817898e-12,\n\t     -1.475637723558783e-12,\n\t     -8.371015190102975e-13,\n\t     -2.599706096327376e-13,\n\n\t     -2.382191739347923e-13,\n\t     -6.423305872147843e-13,\n\t     -9.400849094049696e-13,\n\t     -1.122435026096556e-12,\n\t     -1.183840321267481e-12,\n\t     -1.122435026096556e-12,\n\t     -9.400849094049694e-13,\n\t     -6.423305872147840e-13,\n\t     -2.382191739347918e-13,\n\t     ],\n\t    [\n\t     2.382191739347913e-13,\n\t     6.423305872147834e-13,\n\t     9.400849094049688e-13,\n\t     1.122435026096556e-12,\n\t     1.183840321267481e-12,\n\t     1.122435026096556e-12,\n\t     9.400849094049688e-13,\n\t     6.423305872147841e-13,\n\t     2.382191739347918e-13,\n\n\t     5.456116108943413e-12,\n\t     4.878985199565852e-12,\n\t     4.240448995017367e-12,\n\t     3.559909094758253e-12,\n\t     2.858043359288075e-12,\n\t     2.156177623817898e-12,\n\t     1.475637723558782e-12,\n\t     8.371015190102975e-13,\n\t     2.599706096327376e-13,\n\n\t     -5.461314069809755e-12,\n\t     -4.921085770524055e-12,\n\t     -4.343405037091838e-12,\n\t     -3.732668368707687e-12,\n\t     -3.093523840190885e-12,\n\t     -2.430835727329465e-12,\n\t     -1.734679010007751e-12,\n\t     -9.748253656609281e-13,\n\t     -2.797435120168326e-13,\n\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     -2.283748241799531e-13,\n\t     -4.037858874020686e-13,\n\t     -2.146547464825323e-13,\n\t     ],\n\t    [\n\t     1.316524975873958e-01, /* win[SHORT_TYPE] */\n\t     4.142135623730950e-01,\n\t     7.673269879789602e-01,\n\n\t     1.091308501069271e+00, /* tantab_l */\n\t     1.303225372841206e+00,\n\t     1.569685577117490e+00,\n\t     1.920982126971166e+00,\n\t     2.414213562373094e+00,\n\t     3.171594802363212e+00,\n\t     4.510708503662055e+00,\n\t     7.595754112725146e+00,\n\t     2.290376554843115e+01,\n\n\t     0.98480775301220802032, /* cx */\n\t     0.64278760968653936292,\n\t     0.34202014332566882393,\n\t     0.93969262078590842791,\n\t     -0.17364817766693030343,\n\t     -0.76604444311897790243,\n\t     0.86602540378443870761,\n\t     0.500000000000000e+00,\n\n\t     -5.144957554275265e-01, /* ca */\n\t     -4.717319685649723e-01,\n\t     -3.133774542039019e-01,\n\t     -1.819131996109812e-01,\n\t     -9.457419252642064e-02,\n\t     -4.096558288530405e-02,\n\t     -1.419856857247115e-02,\n\t     -3.699974673760037e-03,\n\n\t     8.574929257125442e-01, /* cs */\n\t     8.817419973177052e-01,\n\t     9.496286491027329e-01,\n\t     9.833145924917901e-01,\n\t     9.955178160675857e-01,\n\t     9.991605581781475e-01,\n\t     9.998991952444470e-01,\n\t     9.999931550702802e-01,\n\t     ],\n\t    [\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     2.283748241799531e-13,\n\t     4.037858874020686e-13,\n\t     2.146547464825323e-13,\n\n\t     5.461314069809755e-12,\n\t     4.921085770524055e-12,\n\t     4.343405037091838e-12,\n\t     3.732668368707687e-12,\n\t     3.093523840190885e-12,\n\t     2.430835727329466e-12,\n\t     1.734679010007751e-12,\n\t     9.748253656609281e-13,\n\t     2.797435120168326e-13,\n\n\t     -5.456116108943413e-12,\n\t     -4.878985199565852e-12,\n\t     -4.240448995017367e-12,\n\t     -3.559909094758253e-12,\n\t     -2.858043359288075e-12,\n\t     -2.156177623817898e-12,\n\t     -1.475637723558782e-12,\n\t     -8.371015190102975e-13,\n\t     -2.599706096327376e-13,\n\n\t     -2.382191739347913e-13,\n\t     -6.423305872147834e-13,\n\t     -9.400849094049688e-13,\n\t     -1.122435026096556e-12,\n\t     -1.183840321267481e-12,\n\t     -1.122435026096556e-12,\n\t     -9.400849094049688e-13,\n\t     -6.423305872147841e-13,\n\t     -2.382191739347918e-13,\n\t     ]\n\t];\n\n\tvar tantab_l = win[Encoder.SHORT_TYPE];\n\tvar cx = win[Encoder.SHORT_TYPE];\n\tvar ca = win[Encoder.SHORT_TYPE];\n\tvar cs = win[Encoder.SHORT_TYPE];\n\n\t/**\n\t * new IDCT routine written by Takehiro TOMINAGA\n\t *\n\t * PURPOSE: Overlapping window on PCM samples<BR>\n\t *\n\t * SEMANTICS:<BR>\n\t * 32 16-bit pcm samples are scaled to fractional 2's complement and\n\t * concatenated to the end of the window buffer #x#. The updated window\n\t * buffer #x# is then windowed by the analysis window #c# to produce the\n\t * windowed sample #z#\n\t */\n\tvar order = [\n\t    0, 1, 16, 17, 8, 9, 24, 25, 4, 5, 20, 21, 12, 13, 28, 29,\n\t    2, 3, 18, 19, 10, 11, 26, 27, 6, 7, 22, 23, 14, 15, 30, 31\n\t];\n\n\t/**\n\t * returns sum_j=0^31 a[j]*cos(PI*j*(k+1/2)/32), 0<=k<32\n\t */\n\tfunction window_subband(x1, x1Pos, a) {\n\t\tvar wp = 10;\n\n\t\tvar x2 = x1Pos + 238 - 14 - 286;\n\n\t\tfor (var i = -15; i < 0; i++) {\n\t\t\tvar w, s, t;\n\n\t\t\tw = enwindow[wp + -10];\n\t\t\ts = x1[x2 + -224] * w;\n\t\t\tt = x1[x1Pos + 224] * w;\n\t\t\tw = enwindow[wp + -9];\n\t\t\ts += x1[x2 + -160] * w;\n\t\t\tt += x1[x1Pos + 160] * w;\n\t\t\tw = enwindow[wp + -8];\n\t\t\ts += x1[x2 + -96] * w;\n\t\t\tt += x1[x1Pos + 96] * w;\n\t\t\tw = enwindow[wp + -7];\n\t\t\ts += x1[x2 + -32] * w;\n\t\t\tt += x1[x1Pos + 32] * w;\n\t\t\tw = enwindow[wp + -6];\n\t\t\ts += x1[x2 + 32] * w;\n\t\t\tt += x1[x1Pos + -32] * w;\n\t\t\tw = enwindow[wp + -5];\n\t\t\ts += x1[x2 + 96] * w;\n\t\t\tt += x1[x1Pos + -96] * w;\n\t\t\tw = enwindow[wp + -4];\n\t\t\ts += x1[x2 + 160] * w;\n\t\t\tt += x1[x1Pos + -160] * w;\n\t\t\tw = enwindow[wp + -3];\n\t\t\ts += x1[x2 + 224] * w;\n\t\t\tt += x1[x1Pos + -224] * w;\n\n\t\t\tw = enwindow[wp + -2];\n\t\t\ts += x1[x1Pos + -256] * w;\n\t\t\tt -= x1[x2 + 256] * w;\n\t\t\tw = enwindow[wp + -1];\n\t\t\ts += x1[x1Pos + -192] * w;\n\t\t\tt -= x1[x2 + 192] * w;\n\t\t\tw = enwindow[wp + 0];\n\t\t\ts += x1[x1Pos + -128] * w;\n\t\t\tt -= x1[x2 + 128] * w;\n\t\t\tw = enwindow[wp + 1];\n\t\t\ts += x1[x1Pos + -64] * w;\n\t\t\tt -= x1[x2 + 64] * w;\n\t\t\tw = enwindow[wp + 2];\n\t\t\ts += x1[x1Pos + 0] * w;\n\t\t\tt -= x1[x2 + 0] * w;\n\t\t\tw = enwindow[wp + 3];\n\t\t\ts += x1[x1Pos + 64] * w;\n\t\t\tt -= x1[x2 + -64] * w;\n\t\t\tw = enwindow[wp + 4];\n\t\t\ts += x1[x1Pos + 128] * w;\n\t\t\tt -= x1[x2 + -128] * w;\n\t\t\tw = enwindow[wp + 5];\n\t\t\ts += x1[x1Pos + 192] * w;\n\t\t\tt -= x1[x2 + -192] * w;\n\n\t\t\t/*\n\t\t\t * this multiplyer could be removed, but it needs more 256 FLOAT\n\t\t\t * data. thinking about the data cache performance, I think we\n\t\t\t * should not use such a huge table. tt 2000/Oct/25\n\t\t\t */\n\t\t\ts *= enwindow[wp + 6];\n\t\t\tw = t - s;\n\t\t\ta[30 + i * 2] = t + s;\n\t\t\ta[31 + i * 2] = enwindow[wp + 7] * w;\n\t\t\twp += 18;\n\t\t\tx1Pos--;\n\t\t\tx2++;\n\t\t}\n\t\t{\n\t\t\tvar s, t, u, v;\n\t\t\tt = x1[x1Pos + -16] * enwindow[wp + -10];\n\t\t\ts = x1[x1Pos + -32] * enwindow[wp + -2];\n\t\t\tt += (x1[x1Pos + -48] - x1[x1Pos + 16]) * enwindow[wp + -9];\n\t\t\ts += x1[x1Pos + -96] * enwindow[wp + -1];\n\t\t\tt += (x1[x1Pos + -80] + x1[x1Pos + 48]) * enwindow[wp + -8];\n\t\t\ts += x1[x1Pos + -160] * enwindow[wp + 0];\n\t\t\tt += (x1[x1Pos + -112] - x1[x1Pos + 80]) * enwindow[wp + -7];\n\t\t\ts += x1[x1Pos + -224] * enwindow[wp + 1];\n\t\t\tt += (x1[x1Pos + -144] + x1[x1Pos + 112]) * enwindow[wp + -6];\n\t\t\ts -= x1[x1Pos + 32] * enwindow[wp + 2];\n\t\t\tt += (x1[x1Pos + -176] - x1[x1Pos + 144]) * enwindow[wp + -5];\n\t\t\ts -= x1[x1Pos + 96] * enwindow[wp + 3];\n\t\t\tt += (x1[x1Pos + -208] + x1[x1Pos + 176]) * enwindow[wp + -4];\n\t\t\ts -= x1[x1Pos + 160] * enwindow[wp + 4];\n\t\t\tt += (x1[x1Pos + -240] - x1[x1Pos + 208]) * enwindow[wp + -3];\n\t\t\ts -= x1[x1Pos + 224];\n\n\t\t\tu = s - t;\n\t\t\tv = s + t;\n\n\t\t\tt = a[14];\n\t\t\ts = a[15] - t;\n\n\t\t\ta[31] = v + t; /* A0 */\n\t\t\ta[30] = u + s; /* A1 */\n\t\t\ta[15] = u - s; /* A2 */\n\t\t\ta[14] = v - t; /* A3 */\n\t\t}\n\t\t{\n\t\t\tvar xr;\n\t\t\txr = a[28] - a[0];\n\t\t\ta[0] += a[28];\n\t\t\ta[28] = xr * enwindow[wp + -2 * 18 + 7];\n\t\t\txr = a[29] - a[1];\n\t\t\ta[1] += a[29];\n\t\t\ta[29] = xr * enwindow[wp + -2 * 18 + 7];\n\n\t\t\txr = a[26] - a[2];\n\t\t\ta[2] += a[26];\n\t\t\ta[26] = xr * enwindow[wp + -4 * 18 + 7];\n\t\t\txr = a[27] - a[3];\n\t\t\ta[3] += a[27];\n\t\t\ta[27] = xr * enwindow[wp + -4 * 18 + 7];\n\n\t\t\txr = a[24] - a[4];\n\t\t\ta[4] += a[24];\n\t\t\ta[24] = xr * enwindow[wp + -6 * 18 + 7];\n\t\t\txr = a[25] - a[5];\n\t\t\ta[5] += a[25];\n\t\t\ta[25] = xr * enwindow[wp + -6 * 18 + 7];\n\n\t\t\txr = a[22] - a[6];\n\t\t\ta[6] += a[22];\n\t\t\ta[22] = xr * Util.SQRT2;\n\t\t\txr = a[23] - a[7];\n\t\t\ta[7] += a[23];\n\t\t\ta[23] = xr * Util.SQRT2 - a[7];\n\t\t\ta[7] -= a[6];\n\t\t\ta[22] -= a[7];\n\t\t\ta[23] -= a[22];\n\n\t\t\txr = a[6];\n\t\t\ta[6] = a[31] - xr;\n\t\t\ta[31] = a[31] + xr;\n\t\t\txr = a[7];\n\t\t\ta[7] = a[30] - xr;\n\t\t\ta[30] = a[30] + xr;\n\t\t\txr = a[22];\n\t\t\ta[22] = a[15] - xr;\n\t\t\ta[15] = a[15] + xr;\n\t\t\txr = a[23];\n\t\t\ta[23] = a[14] - xr;\n\t\t\ta[14] = a[14] + xr;\n\n\t\t\txr = a[20] - a[8];\n\t\t\ta[8] += a[20];\n\t\t\ta[20] = xr * enwindow[wp + -10 * 18 + 7];\n\t\t\txr = a[21] - a[9];\n\t\t\ta[9] += a[21];\n\t\t\ta[21] = xr * enwindow[wp + -10 * 18 + 7];\n\n\t\t\txr = a[18] - a[10];\n\t\t\ta[10] += a[18];\n\t\t\ta[18] = xr * enwindow[wp + -12 * 18 + 7];\n\t\t\txr = a[19] - a[11];\n\t\t\ta[11] += a[19];\n\t\t\ta[19] = xr * enwindow[wp + -12 * 18 + 7];\n\n\t\t\txr = a[16] - a[12];\n\t\t\ta[12] += a[16];\n\t\t\ta[16] = xr * enwindow[wp + -14 * 18 + 7];\n\t\t\txr = a[17] - a[13];\n\t\t\ta[13] += a[17];\n\t\t\ta[17] = xr * enwindow[wp + -14 * 18 + 7];\n\n\t\t\txr = -a[20] + a[24];\n\t\t\ta[20] += a[24];\n\t\t\ta[24] = xr * enwindow[wp + -12 * 18 + 7];\n\t\t\txr = -a[21] + a[25];\n\t\t\ta[21] += a[25];\n\t\t\ta[25] = xr * enwindow[wp + -12 * 18 + 7];\n\n\t\t\txr = a[4] - a[8];\n\t\t\ta[4] += a[8];\n\t\t\ta[8] = xr * enwindow[wp + -12 * 18 + 7];\n\t\t\txr = a[5] - a[9];\n\t\t\ta[5] += a[9];\n\t\t\ta[9] = xr * enwindow[wp + -12 * 18 + 7];\n\n\t\t\txr = a[0] - a[12];\n\t\t\ta[0] += a[12];\n\t\t\ta[12] = xr * enwindow[wp + -4 * 18 + 7];\n\t\t\txr = a[1] - a[13];\n\t\t\ta[1] += a[13];\n\t\t\ta[13] = xr * enwindow[wp + -4 * 18 + 7];\n\t\t\txr = a[16] - a[28];\n\t\t\ta[16] += a[28];\n\t\t\ta[28] = xr * enwindow[wp + -4 * 18 + 7];\n\t\t\txr = -a[17] + a[29];\n\t\t\ta[17] += a[29];\n\t\t\ta[29] = xr * enwindow[wp + -4 * 18 + 7];\n\n\t\t\txr = Util.SQRT2 * (a[2] - a[10]);\n\t\t\ta[2] += a[10];\n\t\t\ta[10] = xr;\n\t\t\txr = Util.SQRT2 * (a[3] - a[11]);\n\t\t\ta[3] += a[11];\n\t\t\ta[11] = xr;\n\t\t\txr = Util.SQRT2 * (-a[18] + a[26]);\n\t\t\ta[18] += a[26];\n\t\t\ta[26] = xr - a[18];\n\t\t\txr = Util.SQRT2 * (-a[19] + a[27]);\n\t\t\ta[19] += a[27];\n\t\t\ta[27] = xr - a[19];\n\n\t\t\txr = a[2];\n\t\t\ta[19] -= a[3];\n\t\t\ta[3] -= xr;\n\t\t\ta[2] = a[31] - xr;\n\t\t\ta[31] += xr;\n\t\t\txr = a[3];\n\t\t\ta[11] -= a[19];\n\t\t\ta[18] -= xr;\n\t\t\ta[3] = a[30] - xr;\n\t\t\ta[30] += xr;\n\t\t\txr = a[18];\n\t\t\ta[27] -= a[11];\n\t\t\ta[19] -= xr;\n\t\t\ta[18] = a[15] - xr;\n\t\t\ta[15] += xr;\n\n\t\t\txr = a[19];\n\t\t\ta[10] -= xr;\n\t\t\ta[19] = a[14] - xr;\n\t\t\ta[14] += xr;\n\t\t\txr = a[10];\n\t\t\ta[11] -= xr;\n\t\t\ta[10] = a[23] - xr;\n\t\t\ta[23] += xr;\n\t\t\txr = a[11];\n\t\t\ta[26] -= xr;\n\t\t\ta[11] = a[22] - xr;\n\t\t\ta[22] += xr;\n\t\t\txr = a[26];\n\t\t\ta[27] -= xr;\n\t\t\ta[26] = a[7] - xr;\n\t\t\ta[7] += xr;\n\n\t\t\txr = a[27];\n\t\t\ta[27] = a[6] - xr;\n\t\t\ta[6] += xr;\n\n\t\t\txr = Util.SQRT2 * (a[0] - a[4]);\n\t\t\ta[0] += a[4];\n\t\t\ta[4] = xr;\n\t\t\txr = Util.SQRT2 * (a[1] - a[5]);\n\t\t\ta[1] += a[5];\n\t\t\ta[5] = xr;\n\t\t\txr = Util.SQRT2 * (a[16] - a[20]);\n\t\t\ta[16] += a[20];\n\t\t\ta[20] = xr;\n\t\t\txr = Util.SQRT2 * (a[17] - a[21]);\n\t\t\ta[17] += a[21];\n\t\t\ta[21] = xr;\n\n\t\t\txr = -Util.SQRT2 * (a[8] - a[12]);\n\t\t\ta[8] += a[12];\n\t\t\ta[12] = xr - a[8];\n\t\t\txr = -Util.SQRT2 * (a[9] - a[13]);\n\t\t\ta[9] += a[13];\n\t\t\ta[13] = xr - a[9];\n\t\t\txr = -Util.SQRT2 * (a[25] - a[29]);\n\t\t\ta[25] += a[29];\n\t\t\ta[29] = xr - a[25];\n\t\t\txr = -Util.SQRT2 * (a[24] + a[28]);\n\t\t\ta[24] -= a[28];\n\t\t\ta[28] = xr - a[24];\n\n\t\t\txr = a[24] - a[16];\n\t\t\ta[24] = xr;\n\t\t\txr = a[20] - xr;\n\t\t\ta[20] = xr;\n\t\t\txr = a[28] - xr;\n\t\t\ta[28] = xr;\n\n\t\t\txr = a[25] - a[17];\n\t\t\ta[25] = xr;\n\t\t\txr = a[21] - xr;\n\t\t\ta[21] = xr;\n\t\t\txr = a[29] - xr;\n\t\t\ta[29] = xr;\n\n\t\t\txr = a[17] - a[1];\n\t\t\ta[17] = xr;\n\t\t\txr = a[9] - xr;\n\t\t\ta[9] = xr;\n\t\t\txr = a[25] - xr;\n\t\t\ta[25] = xr;\n\t\t\txr = a[5] - xr;\n\t\t\ta[5] = xr;\n\t\t\txr = a[21] - xr;\n\t\t\ta[21] = xr;\n\t\t\txr = a[13] - xr;\n\t\t\ta[13] = xr;\n\t\t\txr = a[29] - xr;\n\t\t\ta[29] = xr;\n\n\t\t\txr = a[1] - a[0];\n\t\t\ta[1] = xr;\n\t\t\txr = a[16] - xr;\n\t\t\ta[16] = xr;\n\t\t\txr = a[17] - xr;\n\t\t\ta[17] = xr;\n\t\t\txr = a[8] - xr;\n\t\t\ta[8] = xr;\n\t\t\txr = a[9] - xr;\n\t\t\ta[9] = xr;\n\t\t\txr = a[24] - xr;\n\t\t\ta[24] = xr;\n\t\t\txr = a[25] - xr;\n\t\t\ta[25] = xr;\n\t\t\txr = a[4] - xr;\n\t\t\ta[4] = xr;\n\t\t\txr = a[5] - xr;\n\t\t\ta[5] = xr;\n\t\t\txr = a[20] - xr;\n\t\t\ta[20] = xr;\n\t\t\txr = a[21] - xr;\n\t\t\ta[21] = xr;\n\t\t\txr = a[12] - xr;\n\t\t\ta[12] = xr;\n\t\t\txr = a[13] - xr;\n\t\t\ta[13] = xr;\n\t\t\txr = a[28] - xr;\n\t\t\ta[28] = xr;\n\t\t\txr = a[29] - xr;\n\t\t\ta[29] = xr;\n\n\t\t\txr = a[0];\n\t\t\ta[0] += a[31];\n\t\t\ta[31] -= xr;\n\t\t\txr = a[1];\n\t\t\ta[1] += a[30];\n\t\t\ta[30] -= xr;\n\t\t\txr = a[16];\n\t\t\ta[16] += a[15];\n\t\t\ta[15] -= xr;\n\t\t\txr = a[17];\n\t\t\ta[17] += a[14];\n\t\t\ta[14] -= xr;\n\t\t\txr = a[8];\n\t\t\ta[8] += a[23];\n\t\t\ta[23] -= xr;\n\t\t\txr = a[9];\n\t\t\ta[9] += a[22];\n\t\t\ta[22] -= xr;\n\t\t\txr = a[24];\n\t\t\ta[24] += a[7];\n\t\t\ta[7] -= xr;\n\t\t\txr = a[25];\n\t\t\ta[25] += a[6];\n\t\t\ta[6] -= xr;\n\t\t\txr = a[4];\n\t\t\ta[4] += a[27];\n\t\t\ta[27] -= xr;\n\t\t\txr = a[5];\n\t\t\ta[5] += a[26];\n\t\t\ta[26] -= xr;\n\t\t\txr = a[20];\n\t\t\ta[20] += a[11];\n\t\t\ta[11] -= xr;\n\t\t\txr = a[21];\n\t\t\ta[21] += a[10];\n\t\t\ta[10] -= xr;\n\t\t\txr = a[12];\n\t\t\ta[12] += a[19];\n\t\t\ta[19] -= xr;\n\t\t\txr = a[13];\n\t\t\ta[13] += a[18];\n\t\t\ta[18] -= xr;\n\t\t\txr = a[28];\n\t\t\ta[28] += a[3];\n\t\t\ta[3] -= xr;\n\t\t\txr = a[29];\n\t\t\ta[29] += a[2];\n\t\t\ta[2] -= xr;\n\t\t}\n\t}\n\n\t/**\n\t * Function: Calculation of the MDCT In the case of long blocks (type 0,1,3)\n\t * there are 36 coefficents in the time domain and 18 in the frequency\n\t * domain.<BR>\n\t * In the case of short blocks (type 2) there are 3 transformations with\n\t * short length. This leads to 12 coefficents in the time and 6 in the\n\t * frequency domain. In this case the results are stored side by side in the\n\t * vector out[].\n\t *\n\t * New layer3\n\t */\n\tfunction mdct_short(inout, inoutPos) {\n\t\tfor (var l = 0; l < 3; l++) {\n\t\t\tvar tc0, tc1, tc2, ts0, ts1, ts2;\n\n\t\t\tts0 = inout[inoutPos + 2 * 3] * win[Encoder.SHORT_TYPE][0]\n\t\t\t\t\t- inout[inoutPos + 5 * 3];\n\t\t\ttc0 = inout[inoutPos + 0 * 3] * win[Encoder.SHORT_TYPE][2]\n\t\t\t\t\t- inout[inoutPos + 3 * 3];\n\t\t\ttc1 = ts0 + tc0;\n\t\t\ttc2 = ts0 - tc0;\n\n\t\t\tts0 = inout[inoutPos + 5 * 3] * win[Encoder.SHORT_TYPE][0]\n\t\t\t\t\t+ inout[inoutPos + 2 * 3];\n\t\t\ttc0 = inout[inoutPos + 3 * 3] * win[Encoder.SHORT_TYPE][2]\n\t\t\t\t\t+ inout[inoutPos + 0 * 3];\n\t\t\tts1 = ts0 + tc0;\n\t\t\tts2 = -ts0 + tc0;\n\n\t\t\ttc0 = (inout[inoutPos + 1 * 3] * win[Encoder.SHORT_TYPE][1] - inout[inoutPos + 4 * 3]) * 2.069978111953089e-11;\n\t\t\t/*\n\t\t\t * tritab_s [ 1 ]\n\t\t\t */\n\t\t\tts0 = (inout[inoutPos + 4 * 3] * win[Encoder.SHORT_TYPE][1] + inout[inoutPos + 1 * 3]) * 2.069978111953089e-11;\n\t\t\t/*\n\t\t\t * tritab_s [ 1 ]\n\t\t\t */\n\t\t\tinout[inoutPos + 3 * 0] = tc1 * 1.907525191737280e-11 + tc0;\n\t\t\t/*\n\t\t\t * tritab_s[ 2 ]\n\t\t\t */\n\t\t\tinout[inoutPos + 3 * 5] = -ts1 * 1.907525191737280e-11 + ts0;\n\t\t\t/*\n\t\t\t * tritab_s[0 ]\n\t\t\t */\n\t\t\ttc2 = tc2 * 0.86602540378443870761 * 1.907525191737281e-11;\n\t\t\t/*\n\t\t\t * tritab_s[ 2]\n\t\t\t */\n\t\t\tts1 = ts1 * 0.5 * 1.907525191737281e-11 + ts0;\n\t\t\tinout[inoutPos + 3 * 1] = tc2 - ts1;\n\t\t\tinout[inoutPos + 3 * 2] = tc2 + ts1;\n\n\t\t\ttc1 = tc1 * 0.5 * 1.907525191737281e-11 - tc0;\n\t\t\tts2 = ts2 * 0.86602540378443870761 * 1.907525191737281e-11;\n\t\t\t/*\n\t\t\t * tritab_s[ 0]\n\t\t\t */\n\t\t\tinout[inoutPos + 3 * 3] = tc1 + ts2;\n\t\t\tinout[inoutPos + 3 * 4] = tc1 - ts2;\n\n\t\t\tinoutPos++;\n\t\t}\n\t}\n\n\tfunction mdct_long(out, outPos, _in) {\n\t\tvar ct, st;\n\t\t{\n\t\t\tvar tc1, tc2, tc3, tc4, ts5, ts6, ts7, ts8;\n\t\t\t/* 1,2, 5,6, 9,10, 13,14, 17 */\n\t\t\ttc1 = _in[17] - _in[9];\n\t\t\ttc3 = _in[15] - _in[11];\n\t\t\ttc4 = _in[14] - _in[12];\n\t\t\tts5 = _in[0] + _in[8];\n\t\t\tts6 = _in[1] + _in[7];\n\t\t\tts7 = _in[2] + _in[6];\n\t\t\tts8 = _in[3] + _in[5];\n\n\t\t\tout[outPos + 17] = (ts5 + ts7 - ts8) - (ts6 - _in[4]);\n\t\t\tst = (ts5 + ts7 - ts8) * cx[12 + 7] + (ts6 - _in[4]);\n\t\t\tct = (tc1 - tc3 - tc4) * cx[12 + 6];\n\t\t\tout[outPos + 5] = ct + st;\n\t\t\tout[outPos + 6] = ct - st;\n\n\t\t\ttc2 = (_in[16] - _in[10]) * cx[12 + 6];\n\t\t\tts6 = ts6 * cx[12 + 7] + _in[4];\n\t\t\tct = tc1 * cx[12 + 0] + tc2 + tc3 * cx[12 + 1] + tc4 * cx[12 + 2];\n\t\t\tst = -ts5 * cx[12 + 4] + ts6 - ts7 * cx[12 + 5] + ts8 * cx[12 + 3];\n\t\t\tout[outPos + 1] = ct + st;\n\t\t\tout[outPos + 2] = ct - st;\n\n\t\t\tct = tc1 * cx[12 + 1] - tc2 - tc3 * cx[12 + 2] + tc4 * cx[12 + 0];\n\t\t\tst = -ts5 * cx[12 + 5] + ts6 - ts7 * cx[12 + 3] + ts8 * cx[12 + 4];\n\t\t\tout[outPos + 9] = ct + st;\n\t\t\tout[outPos + 10] = ct - st;\n\n\t\t\tct = tc1 * cx[12 + 2] - tc2 + tc3 * cx[12 + 0] - tc4 * cx[12 + 1];\n\t\t\tst = ts5 * cx[12 + 3] - ts6 + ts7 * cx[12 + 4] - ts8 * cx[12 + 5];\n\t\t\tout[outPos + 13] = ct + st;\n\t\t\tout[outPos + 14] = ct - st;\n\t\t}\n\t\t{\n\t\t\tvar ts1, ts2, ts3, ts4, tc5, tc6, tc7, tc8;\n\n\t\t\tts1 = _in[8] - _in[0];\n\t\t\tts3 = _in[6] - _in[2];\n\t\t\tts4 = _in[5] - _in[3];\n\t\t\ttc5 = _in[17] + _in[9];\n\t\t\ttc6 = _in[16] + _in[10];\n\t\t\ttc7 = _in[15] + _in[11];\n\t\t\ttc8 = _in[14] + _in[12];\n\n\t\t\tout[outPos + 0] = (tc5 + tc7 + tc8) + (tc6 + _in[13]);\n\t\t\tct = (tc5 + tc7 + tc8) * cx[12 + 7] - (tc6 + _in[13]);\n\t\t\tst = (ts1 - ts3 + ts4) * cx[12 + 6];\n\t\t\tout[outPos + 11] = ct + st;\n\t\t\tout[outPos + 12] = ct - st;\n\n\t\t\tts2 = (_in[7] - _in[1]) * cx[12 + 6];\n\t\t\ttc6 = _in[13] - tc6 * cx[12 + 7];\n\t\t\tct = tc5 * cx[12 + 3] - tc6 + tc7 * cx[12 + 4] + tc8 * cx[12 + 5];\n\t\t\tst = ts1 * cx[12 + 2] + ts2 + ts3 * cx[12 + 0] + ts4 * cx[12 + 1];\n\t\t\tout[outPos + 3] = ct + st;\n\t\t\tout[outPos + 4] = ct - st;\n\n\t\t\tct = -tc5 * cx[12 + 5] + tc6 - tc7 * cx[12 + 3] - tc8 * cx[12 + 4];\n\t\t\tst = ts1 * cx[12 + 1] + ts2 - ts3 * cx[12 + 2] - ts4 * cx[12 + 0];\n\t\t\tout[outPos + 7] = ct + st;\n\t\t\tout[outPos + 8] = ct - st;\n\n\t\t\tct = -tc5 * cx[12 + 4] + tc6 - tc7 * cx[12 + 5] - tc8 * cx[12 + 3];\n\t\t\tst = ts1 * cx[12 + 0] - ts2 + ts3 * cx[12 + 1] - ts4 * cx[12 + 2];\n\t\t\tout[outPos + 15] = ct + st;\n\t\t\tout[outPos + 16] = ct - st;\n\t\t}\n\t}\n\n\tthis.mdct_sub48 = function(gfc, w0, w1) {\n\t\tvar wk = w0;\n\t\tvar wkPos = 286;\n\t\t/* thinking cache performance, ch->gr loop is better than gr->ch loop */\n\t\tfor (var ch = 0; ch < gfc.channels_out; ch++) {\n\t\t\tfor (var gr = 0; gr < gfc.mode_gr; gr++) {\n\t\t\t\tvar band;\n\t\t\t\tvar gi = (gfc.l3_side.tt[gr][ch]);\n\t\t\t\tvar mdct_enc = gi.xr;\n\t\t\t\tvar mdct_encPos = 0;\n\t\t\t\tvar samp = gfc.sb_sample[ch][1 - gr];\n\t\t\t\tvar sampPos = 0;\n\n\t\t\t\tfor (var k = 0; k < 18 / 2; k++) {\n\t\t\t\t\twindow_subband(wk, wkPos, samp[sampPos]);\n\t\t\t\t\twindow_subband(wk, wkPos + 32, samp[sampPos + 1]);\n\t\t\t\t\tsampPos += 2;\n\t\t\t\t\twkPos += 64;\n\t\t\t\t\t/*\n\t\t\t\t\t * Compensate for inversion in the analysis filter\n\t\t\t\t\t */\n\t\t\t\t\tfor (band = 1; band < 32; band += 2) {\n\t\t\t\t\t\tsamp[sampPos - 1][band] *= -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/*\n\t\t\t\t * Perform imdct of 18 previous subband samples + 18 current\n\t\t\t\t * subband samples\n\t\t\t\t */\n\t\t\t\tfor (band = 0; band < 32; band++, mdct_encPos += 18) {\n\t\t\t\t\tvar type = gi.block_type;\n\t\t\t\t\tvar band0 = gfc.sb_sample[ch][gr];\n\t\t\t\t\tvar band1 = gfc.sb_sample[ch][1 - gr];\n\t\t\t\t\tif (gi.mixed_block_flag != 0 && band < 2)\n\t\t\t\t\t\ttype = 0;\n\t\t\t\t\tif (gfc.amp_filter[band] < 1e-12) {\n\t\t\t\t\t\tArrays.fill(mdct_enc, mdct_encPos + 0,\n\t\t\t\t\t\t\t\tmdct_encPos + 18, 0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (gfc.amp_filter[band] < 1.0) {\n\t\t\t\t\t\t\tfor (var k = 0; k < 18; k++)\n\t\t\t\t\t\t\t\tband1[k][order[band]] *= gfc.amp_filter[band];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (type == Encoder.SHORT_TYPE) {\n\t\t\t\t\t\t\tfor (var k = -NS / 4; k < 0; k++) {\n\t\t\t\t\t\t\t\tvar w = win[Encoder.SHORT_TYPE][k + 3];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 9] = band0[9 + k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w - band0[8 - k][order[band]];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 18] = band0[14 - k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w + band0[15 + k][order[band]];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 10] = band0[15 + k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w - band0[14 - k][order[band]];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 19] = band1[2 - k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w + band1[3 + k][order[band]];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 11] = band1[3 + k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w - band1[2 - k][order[band]];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 20] = band1[8 - k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w + band1[9 + k][order[band]];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tmdct_short(mdct_enc, mdct_encPos);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar work = new_float(18);\n\t\t\t\t\t\t\tfor (var k = -NL / 4; k < 0; k++) {\n\t\t\t\t\t\t\t\tvar a, b;\n\t\t\t\t\t\t\t\ta = win[type][k + 27]\n\t\t\t\t\t\t\t\t\t\t* band1[k + 9][order[band]]\n\t\t\t\t\t\t\t\t\t\t+ win[type][k + 36]\n\t\t\t\t\t\t\t\t\t\t* band1[8 - k][order[band]];\n\t\t\t\t\t\t\t\tb = win[type][k + 9]\n\t\t\t\t\t\t\t\t\t\t* band0[k + 9][order[band]]\n\t\t\t\t\t\t\t\t\t\t- win[type][k + 18]\n\t\t\t\t\t\t\t\t\t\t* band0[8 - k][order[band]];\n\t\t\t\t\t\t\t\twork[k + 9] = a - b * tantab_l[3 + k + 9];\n\t\t\t\t\t\t\t\twork[k + 18] = a * tantab_l[3 + k + 9] + b;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tmdct_long(mdct_enc, mdct_encPos, work);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t/*\n\t\t\t\t\t * Perform aliasing reduction butterfly\n\t\t\t\t\t */\n\t\t\t\t\tif (type != Encoder.SHORT_TYPE && band != 0) {\n\t\t\t\t\t\tfor (var k = 7; k >= 0; --k) {\n\t\t\t\t\t\t\tvar bu, bd;\n\t\t\t\t\t\t\tbu = mdct_enc[mdct_encPos + k] * ca[20 + k]\n\t\t\t\t\t\t\t\t\t+ mdct_enc[mdct_encPos + -1 - k]\n\t\t\t\t\t\t\t\t\t* cs[28 + k];\n\t\t\t\t\t\t\tbd = mdct_enc[mdct_encPos + k] * cs[28 + k]\n\t\t\t\t\t\t\t\t\t- mdct_enc[mdct_encPos + -1 - k]\n\t\t\t\t\t\t\t\t\t* ca[20 + k];\n\n\t\t\t\t\t\t\tmdct_enc[mdct_encPos + -1 - k] = bu;\n\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k] = bd;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\twk = w1;\n\t\t\twkPos = 286;\n\t\t\tif (gfc.mode_gr == 1) {\n\t\t\t\tfor (var i = 0; i < 18; i++) {\n\t\t\t\t\tSystem.arraycopy(gfc.sb_sample[ch][1][i], 0,\n\t\t\t\t\t\t\tgfc.sb_sample[ch][0][i], 0, 32);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n//package mp3;\n\n\nfunction III_psy_ratio() {\n\tthis.thm = new III_psy_xmin();\n\tthis.en = new III_psy_xmin();\n}\n\n\n/**\n * ENCDELAY The encoder delay.\n *\n * Minimum allowed is MDCTDELAY (see below)\n *\n * The first 96 samples will be attenuated, so using a value less than 96\n * will result in corrupt data for the first 96-ENCDELAY samples.\n *\n * suggested: 576 set to 1160 to sync with FhG.\n */\nEncoder.ENCDELAY = 576;\n/**\n * make sure there is at least one complete frame after the last frame\n * containing real data\n *\n * Using a value of 288 would be sufficient for a a very sophisticated\n * decoder that can decode granule-by-granule instead of frame by frame. But\n * lets not assume this, and assume the decoder will not decode frame N\n * unless it also has data for frame N+1\n */\nEncoder.POSTDELAY = 1152;\n\n/**\n * delay of the MDCT used in mdct.c original ISO routines had a delay of\n * 528! Takehiro's routines:\n */\nEncoder.MDCTDELAY = 48;\nEncoder.FFTOFFSET = (224 + Encoder.MDCTDELAY);\n\n/**\n * Most decoders, including the one we use, have a delay of 528 samples.\n */\nEncoder.DECDELAY = 528;\n\n/**\n * number of subbands\n */\nEncoder.SBLIMIT = 32;\n\n/**\n * parition bands bands\n */\nEncoder.CBANDS = 64;\n\n/**\n * number of critical bands/scale factor bands where masking is computed\n */\nEncoder.SBPSY_l = 21;\nEncoder.SBPSY_s = 12;\n\n/**\n * total number of scalefactor bands encoded\n */\nEncoder.SBMAX_l = 22;\nEncoder.SBMAX_s = 13;\nEncoder.PSFB21 = 6;\nEncoder.PSFB12 = 6;\n\n/**\n * FFT sizes\n */\nEncoder.BLKSIZE = 1024;\nEncoder.HBLKSIZE = (Encoder.BLKSIZE / 2 + 1);\nEncoder.BLKSIZE_s = 256;\nEncoder.HBLKSIZE_s = (Encoder.BLKSIZE_s / 2 + 1);\n\nEncoder.NORM_TYPE = 0;\nEncoder.START_TYPE = 1;\nEncoder.SHORT_TYPE = 2;\nEncoder.STOP_TYPE = 3;\n\n/**\n * <PRE>\n * Mode Extention:\n * When we are in stereo mode, there are 4 possible methods to store these\n * two channels. The stereo modes -m? are using a subset of them.\n *\n *  -ms: MPG_MD_LR_LR\n *  -mj: MPG_MD_LR_LR and MPG_MD_MS_LR\n *  -mf: MPG_MD_MS_LR\n *  -mi: all\n * </PRE>\n */\nEncoder.MPG_MD_LR_LR = 0;\nEncoder.MPG_MD_LR_I = 1;\nEncoder.MPG_MD_MS_LR = 2;\nEncoder.MPG_MD_MS_I = 3;\n\nEncoder.fircoef = [-0.0207887 * 5, -0.0378413 * 5,\n    -0.0432472 * 5, -0.031183 * 5, 7.79609e-18 * 5, 0.0467745 * 5,\n    0.10091 * 5, 0.151365 * 5, 0.187098 * 5];\n\nfunction Encoder() {\n\n    var FFTOFFSET = Encoder.FFTOFFSET;\n    var MPG_MD_MS_LR = Encoder.MPG_MD_MS_LR;\n    //BitStream bs;\n    //PsyModel psy;\n    //VBRTag vbr;\n    //QuantizePVT qupvt;\n    var bs = null;\n    this.psy = null;\n    var psy = null;\n    var vbr = null;\n    var qupvt = null;\n\n    //public final void setModules(BitStream bs, PsyModel psy, QuantizePVT qupvt,\n    //    VBRTag vbr) {\n    this.setModules = function (_bs, _psy, _qupvt, _vbr) {\n        bs = _bs;\n        this.psy = _psy;\n        psy = _psy;\n        vbr = _vbr;\n        qupvt = _qupvt;\n    };\n\n    var newMDCT = new NewMDCT();\n\n    /***********************************************************************\n     *\n     * encoder and decoder delays\n     *\n     ***********************************************************************/\n\n    /**\n     * <PRE>\n     * layer III enc->dec delay:  1056 (1057?)   (observed)\n     * layer  II enc->dec delay:   480  (481?)   (observed)\n     *\n     * polyphase 256-16             (dec or enc)        = 240\n     * mdct      256+32  (9*32)     (dec or enc)        = 288\n     * total:    512+16\n     *\n     * My guess is that delay of polyphase filterbank is actualy 240.5\n     * (there are technical reasons for this, see postings in mp3encoder).\n     * So total Encode+Decode delay = ENCDELAY + 528 + 1\n     * </PRE>\n     */\n\n\n    /**\n     * auto-adjust of ATH, useful for low volume Gabriel Bouvigne 3 feb 2001\n     *\n     * modifies some values in gfp.internal_flags.ATH (gfc.ATH)\n     */\n//private void adjust_ATH(final LameInternalFlags gfc) {\n    function adjust_ATH(gfc) {\n        var gr2_max, max_pow;\n\n        if (gfc.ATH.useAdjust == 0) {\n            gfc.ATH.adjust = 1.0;\n            /* no adjustment */\n            return;\n        }\n\n        /* jd - 2001 mar 12, 27, jun 30 */\n        /* loudness based on equal loudness curve; */\n        /* use granule with maximum combined loudness */\n        max_pow = gfc.loudness_sq[0][0];\n        gr2_max = gfc.loudness_sq[1][0];\n        if (gfc.channels_out == 2) {\n            max_pow += gfc.loudness_sq[0][1];\n            gr2_max += gfc.loudness_sq[1][1];\n        } else {\n            max_pow += max_pow;\n            gr2_max += gr2_max;\n        }\n        if (gfc.mode_gr == 2) {\n            max_pow = Math.max(max_pow, gr2_max);\n        }\n        max_pow *= 0.5;\n        /* max_pow approaches 1.0 for full band noise */\n\n        /* jd - 2001 mar 31, jun 30 */\n        /* user tuning of ATH adjustment region */\n        max_pow *= gfc.ATH.aaSensitivityP;\n\n        /*\n         * adjust ATH depending on range of maximum value\n         */\n\n        /* jd - 2001 feb27, mar12,20, jun30, jul22 */\n        /* continuous curves based on approximation */\n        /* to GB's original values. */\n        /* For an increase in approximate loudness, */\n        /* set ATH adjust to adjust_limit immediately */\n        /* after a delay of one frame. */\n        /* For a loudness decrease, reduce ATH adjust */\n        /* towards adjust_limit gradually. */\n        /* max_pow is a loudness squared or a power. */\n        if (max_pow > 0.03125) { /* ((1 - 0.000625)/ 31.98) from curve below */\n            if (gfc.ATH.adjust >= 1.0) {\n                gfc.ATH.adjust = 1.0;\n            } else {\n                /* preceding frame has lower ATH adjust; */\n                /* ascend only to the preceding adjust_limit */\n                /* in case there is leading low volume */\n                if (gfc.ATH.adjust < gfc.ATH.adjustLimit) {\n                    gfc.ATH.adjust = gfc.ATH.adjustLimit;\n                }\n            }\n            gfc.ATH.adjustLimit = 1.0;\n        } else { /* adjustment curve */\n            /* about 32 dB maximum adjust (0.000625) */\n            var adj_lim_new = 31.98 * max_pow + 0.000625;\n            if (gfc.ATH.adjust >= adj_lim_new) { /* descend gradually */\n                gfc.ATH.adjust *= adj_lim_new * 0.075 + 0.925;\n                if (gfc.ATH.adjust < adj_lim_new) { /* stop descent */\n                    gfc.ATH.adjust = adj_lim_new;\n                }\n            } else { /* ascend */\n                if (gfc.ATH.adjustLimit >= adj_lim_new) {\n                    gfc.ATH.adjust = adj_lim_new;\n                } else {\n                    /* preceding frame has lower ATH adjust; */\n                    /* ascend only to the preceding adjust_limit */\n                    if (gfc.ATH.adjust < gfc.ATH.adjustLimit) {\n                        gfc.ATH.adjust = gfc.ATH.adjustLimit;\n                    }\n                }\n            }\n            gfc.ATH.adjustLimit = adj_lim_new;\n        }\n    }\n\n    /**\n     * <PRE>\n     *  some simple statistics\n     *\n     *  bitrate index 0: free bitrate . not allowed in VBR mode\n     *  : bitrates, kbps depending on MPEG version\n     *  bitrate index 15: forbidden\n     *\n     *  mode_ext:\n     *  0:  LR\n     *  1:  LR-i\n     *  2:  MS\n     *  3:  MS-i\n     * </PRE>\n     */\n    function updateStats(gfc) {\n        var gr, ch;\n\n        /* count bitrate indices */\n        gfc.bitrate_stereoMode_Hist[gfc.bitrate_index][4]++;\n        gfc.bitrate_stereoMode_Hist[15][4]++;\n\n        /* count 'em for every mode extension in case of 2 channel encoding */\n        if (gfc.channels_out == 2) {\n            gfc.bitrate_stereoMode_Hist[gfc.bitrate_index][gfc.mode_ext]++;\n            gfc.bitrate_stereoMode_Hist[15][gfc.mode_ext]++;\n        }\n        for (gr = 0; gr < gfc.mode_gr; ++gr) {\n            for (ch = 0; ch < gfc.channels_out; ++ch) {\n                var bt = gfc.l3_side.tt[gr][ch].block_type | 0;\n                if (gfc.l3_side.tt[gr][ch].mixed_block_flag != 0)\n                    bt = 4;\n                gfc.bitrate_blockType_Hist[gfc.bitrate_index][bt]++;\n                gfc.bitrate_blockType_Hist[gfc.bitrate_index][5]++;\n                gfc.bitrate_blockType_Hist[15][bt]++;\n                gfc.bitrate_blockType_Hist[15][5]++;\n            }\n        }\n    }\n\n    function lame_encode_frame_init(gfp, inbuf) {\n        var gfc = gfp.internal_flags;\n\n        var ch, gr;\n\n        if (gfc.lame_encode_frame_init == 0) {\n            /* prime the MDCT/polyphase filterbank with a short block */\n            var i, j;\n            var primebuff0 = new_float(286 + 1152 + 576);\n            var primebuff1 = new_float(286 + 1152 + 576);\n            gfc.lame_encode_frame_init = 1;\n            for (i = 0, j = 0; i < 286 + 576 * (1 + gfc.mode_gr); ++i) {\n                if (i < 576 * gfc.mode_gr) {\n                    primebuff0[i] = 0;\n                    if (gfc.channels_out == 2)\n                        primebuff1[i] = 0;\n                } else {\n                    primebuff0[i] = inbuf[0][j];\n                    if (gfc.channels_out == 2)\n                        primebuff1[i] = inbuf[1][j];\n                    ++j;\n                }\n            }\n            /* polyphase filtering / mdct */\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    gfc.l3_side.tt[gr][ch].block_type = Encoder.SHORT_TYPE;\n                }\n            }\n            newMDCT.mdct_sub48(gfc, primebuff0, primebuff1);\n\n            /* check FFT will not use a negative starting offset */\n            /* check if we have enough data for FFT */\n            /* check if we have enough data for polyphase filterbank */\n        }\n\n    }\n\n    /**\n     * <PRE>\n     * encodeframe()           Layer 3\n     *\n     * encode a single frame\n     *\n     *\n     *    lame_encode_frame()\n     *\n     *\n     *                           gr 0            gr 1\n     *    inbuf:           |--------------|--------------|--------------|\n     *\n     *\n     *    Polyphase (18 windows, each shifted 32)\n     *    gr 0:\n     *    window1          <----512---.\n     *    window18                 <----512---.\n     *\n     *    gr 1:\n     *    window1                         <----512---.\n     *    window18                                <----512---.\n     *\n     *\n     *\n     *    MDCT output:  |--------------|--------------|--------------|\n     *\n     *    FFT's                    <---------1024---------.\n     *                                             <---------1024-------.\n     *\n     *\n     *\n     *        inbuf = buffer of PCM data size=MP3 framesize\n     *        encoder acts on inbuf[ch][0], but output is delayed by MDCTDELAY\n     *        so the MDCT coefficints are from inbuf[ch][-MDCTDELAY]\n     *\n     *        psy-model FFT has a 1 granule delay, so we feed it data for the\n     *        next granule.\n     *        FFT is centered over granule:  224+576+224\n     *        So FFT starts at:   576-224-MDCTDELAY\n     *\n     *        MPEG2:  FFT ends at:  BLKSIZE+576-224-MDCTDELAY      (1328)\n     *        MPEG1:  FFT ends at:  BLKSIZE+2*576-224-MDCTDELAY    (1904)\n     *\n     *        MPEG2:  polyphase first window:  [0..511]\n     *                          18th window:   [544..1055]          (1056)\n     *        MPEG1:            36th window:   [1120..1631]         (1632)\n     *                data needed:  512+framesize-32\n     *\n     *        A close look newmdct.c shows that the polyphase filterbank\n     *        only uses data from [0..510] for each window.  Perhaps because the window\n     *        used by the filterbank is zero for the last point, so Takehiro's\n     *        code doesn't bother to compute with it.\n     *\n     *        FFT starts at 576-224-MDCTDELAY (304)  = 576-FFTOFFSET\n     *\n     * </PRE>\n     */\n\n\n    this.lame_encode_mp3_frame = function (gfp, inbuf_l, inbuf_r, mp3buf, mp3bufPos, mp3buf_size) {\n        var mp3count;\n        var masking_LR = new_array_n([2, 2]);\n        /*\n         * LR masking &\n         * energy\n         */\n        masking_LR[0][0] = new III_psy_ratio();\n        masking_LR[0][1] = new III_psy_ratio();\n        masking_LR[1][0] = new III_psy_ratio();\n        masking_LR[1][1] = new III_psy_ratio();\n        var masking_MS = new_array_n([2, 2]);\n        /* MS masking & energy */\n        masking_MS[0][0] = new III_psy_ratio();\n        masking_MS[0][1] = new III_psy_ratio();\n        masking_MS[1][0] = new III_psy_ratio();\n        masking_MS[1][1] = new III_psy_ratio();\n        //III_psy_ratio masking[][];\n        var masking;\n        /* pointer to selected maskings */\n        var inbuf = [null, null];\n        var gfc = gfp.internal_flags;\n\n        var tot_ener = new_float_n([2, 4]);\n        var ms_ener_ratio = [.5, .5];\n        var pe = [[0., 0.], [0., 0.]];\n        var pe_MS = [[0., 0.], [0., 0.]];\n\n//float[][] pe_use;\n        var pe_use;\n\n        var ch, gr;\n\n        inbuf[0] = inbuf_l;\n        inbuf[1] = inbuf_r;\n\n        if (gfc.lame_encode_frame_init == 0) {\n            /* first run? */\n            lame_encode_frame_init(gfp, inbuf);\n\n        }\n\n        /********************** padding *****************************/\n        /**\n         * <PRE>\n         * padding method as described in\n         * \"MPEG-Layer3 / Bitstream Syntax and Decoding\"\n         * by Martin Sieler, Ralph Sperschneider\n         *\n         * note: there is no padding for the very first frame\n         *\n         * Robert Hegemann 2000-06-22\n         * </PRE>\n         */\n        gfc.padding = 0;\n        if ((gfc.slot_lag -= gfc.frac_SpF) < 0) {\n            gfc.slot_lag += gfp.out_samplerate;\n            gfc.padding = 1;\n        }\n\n        /****************************************\n         * Stage 1: psychoacoustic model *\n         ****************************************/\n\n        if (gfc.psymodel != 0) {\n            /*\n             * psychoacoustic model psy model has a 1 granule (576) delay that\n             * we must compensate for (mt 6/99).\n             */\n            var ret;\n            var bufp = [null, null];\n            /* address of beginning of left & right granule */\n            var bufpPos = 0;\n            /* address of beginning of left & right granule */\n            var blocktype = new_int(2);\n\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    bufp[ch] = inbuf[ch];\n                    bufpPos = 576 + gr * 576 - Encoder.FFTOFFSET;\n                }\n                if (gfp.VBR == VbrMode.vbr_mtrh || gfp.VBR == VbrMode.vbr_mt) {\n                    ret = psy.L3psycho_anal_vbr(gfp, bufp, bufpPos, gr,\n                        masking_LR, masking_MS, pe[gr], pe_MS[gr],\n                        tot_ener[gr], blocktype);\n                } else {\n                    ret = psy.L3psycho_anal_ns(gfp, bufp, bufpPos, gr,\n                        masking_LR, masking_MS, pe[gr], pe_MS[gr],\n                        tot_ener[gr], blocktype);\n                }\n                if (ret != 0)\n                    return -4;\n\n                if (gfp.mode == MPEGMode.JOINT_STEREO) {\n                    ms_ener_ratio[gr] = tot_ener[gr][2] + tot_ener[gr][3];\n                    if (ms_ener_ratio[gr] > 0)\n                        ms_ener_ratio[gr] = tot_ener[gr][3] / ms_ener_ratio[gr];\n                }\n\n                /* block type flags */\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    var cod_info = gfc.l3_side.tt[gr][ch];\n                    cod_info.block_type = blocktype[ch];\n                    cod_info.mixed_block_flag = 0;\n                }\n            }\n        } else {\n            /* no psy model */\n            for (gr = 0; gr < gfc.mode_gr; gr++)\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    gfc.l3_side.tt[gr][ch].block_type = Encoder.NORM_TYPE;\n                    gfc.l3_side.tt[gr][ch].mixed_block_flag = 0;\n                    pe_MS[gr][ch] = pe[gr][ch] = 700;\n                }\n        }\n\n        /* auto-adjust of ATH, useful for low volume */\n        adjust_ATH(gfc);\n\n        /****************************************\n         * Stage 2: MDCT *\n         ****************************************/\n\n        /* polyphase filtering / mdct */\n        newMDCT.mdct_sub48(gfc, inbuf[0], inbuf[1]);\n\n        /****************************************\n         * Stage 3: MS/LR decision *\n         ****************************************/\n\n        /* Here will be selected MS or LR coding of the 2 stereo channels */\n        gfc.mode_ext = Encoder.MPG_MD_LR_LR;\n\n        if (gfp.force_ms) {\n            gfc.mode_ext = Encoder.MPG_MD_MS_LR;\n        } else if (gfp.mode == MPEGMode.JOINT_STEREO) {\n            /*\n             * ms_ratio = is scaled, for historical reasons, to look like a\n             * ratio of side_channel / total. 0 = signal is 100% mono .5 = L & R\n             * uncorrelated\n             */\n\n            /**\n             * <PRE>\n             * [0] and [1] are the results for the two granules in MPEG-1,\n             * in MPEG-2 it's only a faked averaging of the same value\n             * _prev is the value of the last granule of the previous frame\n             * _next is the value of the first granule of the next frame\n             * </PRE>\n             */\n\n            var sum_pe_MS = 0.;\n            var sum_pe_LR = 0.;\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    sum_pe_MS += pe_MS[gr][ch];\n                    sum_pe_LR += pe[gr][ch];\n                }\n            }\n\n            /* based on PE: M/S coding would not use much more bits than L/R */\n            if (sum_pe_MS <= 1.00 * sum_pe_LR) {\n\n                var gi0 = gfc.l3_side.tt[0];\n                var gi1 = gfc.l3_side.tt[gfc.mode_gr - 1];\n\n                if (gi0[0].block_type == gi0[1].block_type\n                    && gi1[0].block_type == gi1[1].block_type) {\n\n                    gfc.mode_ext = Encoder.MPG_MD_MS_LR;\n                }\n            }\n        }\n\n        /* bit and noise allocation */\n        if (gfc.mode_ext == MPG_MD_MS_LR) {\n            masking = masking_MS;\n            /* use MS masking */\n            pe_use = pe_MS;\n        } else {\n            masking = masking_LR;\n            /* use LR masking */\n            pe_use = pe;\n        }\n\n        /* copy data for MP3 frame analyzer */\n        if (gfp.analysis && gfc.pinfo != null) {\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    gfc.pinfo.ms_ratio[gr] = gfc.ms_ratio[gr];\n                    gfc.pinfo.ms_ener_ratio[gr] = ms_ener_ratio[gr];\n                    gfc.pinfo.blocktype[gr][ch] = gfc.l3_side.tt[gr][ch].block_type;\n                    gfc.pinfo.pe[gr][ch] = pe_use[gr][ch];\n                    System.arraycopy(gfc.l3_side.tt[gr][ch].xr, 0,\n                        gfc.pinfo.xr[gr][ch], 0, 576);\n                    /*\n                     * in psymodel, LR and MS data was stored in pinfo. switch\n                     * to MS data:\n                     */\n                    if (gfc.mode_ext == MPG_MD_MS_LR) {\n                        gfc.pinfo.ers[gr][ch] = gfc.pinfo.ers[gr][ch + 2];\n                        System.arraycopy(gfc.pinfo.energy[gr][ch + 2], 0,\n                            gfc.pinfo.energy[gr][ch], 0,\n                            gfc.pinfo.energy[gr][ch].length);\n                    }\n                }\n            }\n        }\n\n        /****************************************\n         * Stage 4: quantization loop *\n         ****************************************/\n\n        if (gfp.VBR == VbrMode.vbr_off || gfp.VBR == VbrMode.vbr_abr) {\n\n            var i;\n            var f;\n\n            for (i = 0; i < 18; i++)\n                gfc.nsPsy.pefirbuf[i] = gfc.nsPsy.pefirbuf[i + 1];\n\n            f = 0.0;\n            for (gr = 0; gr < gfc.mode_gr; gr++)\n                for (ch = 0; ch < gfc.channels_out; ch++)\n                    f += pe_use[gr][ch];\n            gfc.nsPsy.pefirbuf[18] = f;\n\n            f = gfc.nsPsy.pefirbuf[9];\n            for (i = 0; i < 9; i++)\n                f += (gfc.nsPsy.pefirbuf[i] + gfc.nsPsy.pefirbuf[18 - i])\n                    * Encoder.fircoef[i];\n\n            f = (670 * 5 * gfc.mode_gr * gfc.channels_out) / f;\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    pe_use[gr][ch] *= f;\n                }\n            }\n        }\n        gfc.iteration_loop.iteration_loop(gfp, pe_use, ms_ener_ratio, masking);\n\n        /****************************************\n         * Stage 5: bitstream formatting *\n         ****************************************/\n\n        /* write the frame to the bitstream */\n        bs.format_bitstream(gfp);\n\n        /* copy mp3 bit buffer into array */\n        mp3count = bs.copy_buffer(gfc, mp3buf, mp3bufPos, mp3buf_size, 1);\n\n        if (gfp.bWriteVbrTag)\n            vbr.addVbrFrame(gfp);\n\n        if (gfp.analysis && gfc.pinfo != null) {\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                var j;\n                for (j = 0; j < FFTOFFSET; j++)\n                    gfc.pinfo.pcmdata[ch][j] = gfc.pinfo.pcmdata[ch][j\n                    + gfp.framesize];\n                for (j = FFTOFFSET; j < 1600; j++) {\n                    gfc.pinfo.pcmdata[ch][j] = inbuf[ch][j - FFTOFFSET];\n                }\n            }\n            qupvt.set_frame_pinfo(gfp, masking);\n        }\n\n        updateStats(gfc);\n\n        return mp3count;\n    }\n}\n\n\n//package mp3;\n\nfunction VBRSeekInfo() {\n    /**\n     * What we have seen so far.\n     */\n    this.sum = 0;\n    /**\n     * How many frames we have seen in this chunk.\n     */\n    this.seen = 0;\n    /**\n     * How many frames we want to collect into one chunk.\n     */\n    this.want = 0;\n    /**\n     * Actual position in our bag.\n     */\n    this.pos = 0;\n    /**\n     * Size of our bag.\n     */\n    this.size = 0;\n    /**\n     * Pointer to our bag.\n     */\n    this.bag = null;\n    this.nVbrNumFrames = 0;\n    this.nBytesWritten = 0;\n    /* VBR tag data */\n    this.TotalFrameSize = 0;\n}\n\n\n\nfunction IIISideInfo() {\n    this.tt = [[null, null], [null, null]];\n    this.main_data_begin = 0;\n    this.private_bits = 0;\n    this.resvDrain_pre = 0;\n    this.resvDrain_post = 0;\n    this.scfsi = [new_int(4), new_int(4)];\n\n    for (var gr = 0; gr < 2; gr++) {\n        for (var ch = 0; ch < 2; ch++) {\n            this.tt[gr][ch] = new GrInfo();\n        }\n    }\n}\n\n\nfunction III_psy_xmin() {\n    this.l = new_float(Encoder.SBMAX_l);\n    this.s = new_float_n([Encoder.SBMAX_s, 3]);\n\n    var self = this;\n    this.assign = function (iii_psy_xmin) {\n        System.arraycopy(iii_psy_xmin.l, 0, self.l, 0, Encoder.SBMAX_l);\n        for (var i = 0; i < Encoder.SBMAX_s; i++) {\n            for (var j = 0; j < 3; j++) {\n                self.s[i][j] = iii_psy_xmin.s[i][j];\n            }\n        }\n    }\n}\n\n\n\n//package mp3;\n\n/**\n * Variables used for --nspsytune\n *\n * @author Ken\n *\n */\nfunction NsPsy() {\n    this.last_en_subshort = new_float_n([4, 9]);\n    this.lastAttacks = new_int(4);\n    this.pefirbuf = new_float(19);\n    this.longfact = new_float(Encoder.SBMAX_l);\n    this.shortfact = new_float(Encoder.SBMAX_s);\n\n    /**\n     * short block tuning\n     */\n    this.attackthre = 0.;\n    this.attackthre_s = 0.;\n}\n\n\n\n\nLameInternalFlags.MFSIZE = (3 * 1152 + Encoder.ENCDELAY - Encoder.MDCTDELAY);\nLameInternalFlags.MAX_HEADER_BUF = 256;\nLameInternalFlags.MAX_BITS_PER_CHANNEL = 4095;\nLameInternalFlags.MAX_BITS_PER_GRANULE = 7680;\nLameInternalFlags.BPC = 320;\n\nfunction LameInternalFlags() {\n    var MAX_HEADER_LEN = 40;\n\n\n    /********************************************************************\n     * internal variables NOT set by calling program, and should not be *\n     * modified by the calling program *\n     ********************************************************************/\n\n    /**\n     * Some remarks to the Class_ID field: The Class ID is an Identifier for a\n     * pointer to this struct. It is very unlikely that a pointer to\n     * lame_global_flags has the same 32 bits in it's structure (large and other\n     * special properties, for instance prime).\n     *\n     * To test that the structure is right and initialized, use: if ( gfc .\n     * Class_ID == LAME_ID ) ... Other remark: If you set a flag to 0 for uninit\n     * data and 1 for init data, the right test should be \"if (flag == 1)\" and\n     * NOT \"if (flag)\". Unintended modification of this element will be\n     * otherwise misinterpreted as an init.\n     */\n    this.Class_ID = 0;\n\n    this.lame_encode_frame_init = 0;\n    this.iteration_init_init = 0;\n    this.fill_buffer_resample_init = 0;\n\n    //public float mfbuf[][] = new float[2][MFSIZE];\n    this.mfbuf = new_float_n([2, LameInternalFlags.MFSIZE]);\n\n    /**\n     * granules per frame\n     */\n    this.mode_gr = 0;\n    /**\n     * number of channels in the input data stream (PCM or decoded PCM)\n     */\n    this.channels_in = 0;\n    /**\n     * number of channels in the output data stream (not used for decoding)\n     */\n    this.channels_out = 0;\n    /**\n     * input_samp_rate/output_samp_rate\n     */\n        //public double resample_ratio;\n    this.resample_ratio = 0.;\n\n    this.mf_samples_to_encode = 0;\n    this.mf_size = 0;\n    /**\n     * min bitrate index\n     */\n    this.VBR_min_bitrate = 0;\n    /**\n     * max bitrate index\n     */\n    this.VBR_max_bitrate = 0;\n    this.bitrate_index = 0;\n    this.samplerate_index = 0;\n    this.mode_ext = 0;\n\n    /* lowpass and highpass filter control */\n    /**\n     * normalized frequency bounds of passband\n     */\n    this.lowpass1 = 0.;\n    this.lowpass2 = 0.;\n    /**\n     * normalized frequency bounds of passband\n     */\n    this.highpass1 = 0.;\n    this.highpass2 = 0.;\n\n    /**\n     * 0 = none 1 = ISO AAC model 2 = allow scalefac_select=1\n     */\n    this.noise_shaping = 0;\n\n    /**\n     * 0 = ISO model: amplify all distorted bands<BR>\n     * 1 = amplify within 50% of max (on db scale)<BR>\n     * 2 = amplify only most distorted band<BR>\n     * 3 = method 1 and refine with method 2<BR>\n     */\n    this.noise_shaping_amp = 0;\n    /**\n     * 0 = no substep<BR>\n     * 1 = use substep shaping at last step(VBR only)<BR>\n     * (not implemented yet)<BR>\n     * 2 = use substep inside loop<BR>\n     * 3 = use substep inside loop and last step<BR>\n     */\n    this.substep_shaping = 0;\n\n    /**\n     * 1 = gpsycho. 0 = none\n     */\n    this.psymodel = 0;\n    /**\n     * 0 = stop at over=0, all scalefacs amplified or<BR>\n     * a scalefac has reached max value<BR>\n     * 1 = stop when all scalefacs amplified or a scalefac has reached max value<BR>\n     * 2 = stop when all scalefacs amplified\n     */\n    this.noise_shaping_stop = 0;\n\n    /**\n     * 0 = no, 1 = yes\n     */\n    this.subblock_gain = 0;\n    /**\n     * 0 = no. 1=outside loop 2=inside loop(slow)\n     */\n    this.use_best_huffman = 0;\n\n    /**\n     * 0 = stop early after 0 distortion found. 1 = full search\n     */\n    this.full_outer_loop = 0;\n\n    //public IIISideInfo l3_side = new IIISideInfo();\n    this.l3_side = new IIISideInfo();\n    this.ms_ratio = new_float(2);\n\n    /* used for padding */\n    /**\n     * padding for the current frame?\n     */\n    this.padding = 0;\n    this.frac_SpF = 0;\n    this.slot_lag = 0;\n\n    /**\n     * optional ID3 tags\n     */\n        //public ID3TagSpec tag_spec;\n    this.tag_spec = null;\n    this.nMusicCRC = 0;\n\n    /* variables used by Quantize */\n    //public int OldValue[] = new int[2];\n    this.OldValue = new_int(2);\n    //public int CurrentStep[] = new int[2];\n    this.CurrentStep = new_int(2);\n\n    this.masking_lower = 0.;\n    //public int bv_scf[] = new int[576];\n    this.bv_scf = new_int(576);\n    //public int pseudohalf[] = new int[L3Side.SFBMAX];\n    this.pseudohalf = new_int(L3Side.SFBMAX);\n\n    /**\n     * will be set in lame_init_params\n     */\n    this.sfb21_extra = false;\n\n    /* BPC = maximum number of filter convolution windows to precompute */\n    //public float[][] inbuf_old = new float[2][];\n    this.inbuf_old = new Array(2);\n    //public float[][] blackfilt = new float[2 * BPC + 1][];\n    this.blackfilt = new Array(2 * LameInternalFlags.BPC + 1);\n    //public double itime[] = new double[2];\n    this.itime = new_double(2);\n    this.sideinfo_len = 0;\n\n    /* variables for newmdct.c */\n    //public float sb_sample[][][][] = new float[2][2][18][Encoder.SBLIMIT];\n    this.sb_sample = new_float_n([2, 2, 18, Encoder.SBLIMIT]);\n    this.amp_filter = new_float(32);\n\n    /* variables for BitStream */\n\n    /**\n     * <PRE>\n     * mpeg1: buffer=511 bytes  smallest frame: 96-38(sideinfo)=58\n     * max number of frames in reservoir:  8\n     * mpeg2: buffer=255 bytes.  smallest frame: 24-23bytes=1\n     * with VBR, if you are encoding all silence, it is possible to\n     * have 8kbs/24khz frames with 1byte of data each, which means we need\n     * to buffer up to 255 headers!\n     * </PRE>\n     */\n    /**\n     * also, max_header_buf has to be a power of two\n     */\n    /**\n     * max size of header is 38\n     */\n\n    function Header() {\n        this.write_timing = 0;\n        this.ptr = 0;\n        //public byte buf[] = new byte[MAX_HEADER_LEN];\n        this.buf = new_byte(MAX_HEADER_LEN);\n    }\n\n    this.header = new Array(LameInternalFlags.MAX_HEADER_BUF);\n\n    this.h_ptr = 0;\n    this.w_ptr = 0;\n    this.ancillary_flag = 0;\n\n    /* variables for Reservoir */\n    /**\n     * in bits\n     */\n    this.ResvSize = 0;\n    /**\n     * in bits\n     */\n    this.ResvMax = 0;\n\n    //public ScaleFac scalefac_band = new ScaleFac();\n    this.scalefac_band = new ScaleFac();\n\n    /* daa from PsyModel */\n    /* The static variables \"r\", \"phi_sav\", \"new\", \"old\" and \"oldest\" have */\n    /* to be remembered for the unpredictability measure. For \"r\" and */\n    /* \"phi_sav\", the first index from the left is the channel select and */\n    /* the second index is the \"age\" of the data. */\n    this.minval_l = new_float(Encoder.CBANDS);\n    this.minval_s = new_float(Encoder.CBANDS);\n    this.nb_1 = new_float_n([4, Encoder.CBANDS]);\n    this.nb_2 = new_float_n([4, Encoder.CBANDS]);\n    this.nb_s1 = new_float_n([4, Encoder.CBANDS]);\n    this.nb_s2 = new_float_n([4, Encoder.CBANDS]);\n    this.s3_ss = null;\n    this.s3_ll = null;\n    this.decay = 0.;\n\n    //public III_psy_xmin[] thm = new III_psy_xmin[4];\n    //public III_psy_xmin[] en = new III_psy_xmin[4];\n    this.thm = new Array(4);\n    this.en = new Array(4);\n\n    /**\n     * fft and energy calculation\n     */\n    this.tot_ener = new_float(4);\n\n    /* loudness calculation (for adaptive threshold of hearing) */\n    /**\n     * loudness^2 approx. per granule and channel\n     */\n    this.loudness_sq = new_float_n([2, 2]);\n    /**\n     * account for granule delay of L3psycho_anal\n     */\n    this.loudness_sq_save = new_float(2);\n\n    /**\n     * Scale Factor Bands\n     */\n    this.mld_l = new_float(Encoder.SBMAX_l);\n    this.mld_s = new_float(Encoder.SBMAX_s);\n    this.bm_l = new_int(Encoder.SBMAX_l);\n    this.bo_l = new_int(Encoder.SBMAX_l);\n    this.bm_s = new_int(Encoder.SBMAX_s);\n    this.bo_s = new_int(Encoder.SBMAX_s);\n    this.npart_l = 0;\n    this.npart_s = 0;\n\n    this.s3ind = new_int_n([Encoder.CBANDS, 2]);\n    this.s3ind_s = new_int_n([Encoder.CBANDS, 2]);\n\n    this.numlines_s = new_int(Encoder.CBANDS);\n    this.numlines_l = new_int(Encoder.CBANDS);\n    this.rnumlines_l = new_float(Encoder.CBANDS);\n    this.mld_cb_l = new_float(Encoder.CBANDS);\n    this.mld_cb_s = new_float(Encoder.CBANDS);\n    this.numlines_s_num1 = 0;\n    this.numlines_l_num1 = 0;\n\n    /* ratios */\n    this.pe = new_float(4);\n    this.ms_ratio_s_old = 0.;\n    this.ms_ratio_l_old = 0.;\n    this.ms_ener_ratio_old = 0.;\n\n    /**\n     * block type\n     */\n    this.blocktype_old = new_int(2);\n\n    /**\n     * variables used for --nspsytune\n     */\n    this.nsPsy = new NsPsy();\n\n    /**\n     * used for Xing VBR header\n     */\n    this.VBR_seek_table = new VBRSeekInfo();\n\n    /**\n     * all ATH related stuff\n     */\n        //public ATH ATH;\n    this.ATH = null;\n\n    this.PSY = null;\n\n    this.nogap_total = 0;\n    this.nogap_current = 0;\n\n    /* ReplayGain */\n    this.decode_on_the_fly = true;\n    this.findReplayGain = true;\n    this.findPeakSample = true;\n    this.PeakSample = 0.;\n    this.RadioGain = 0;\n    this.AudiophileGain = 0;\n    //public ReplayGain rgdata;\n    this.rgdata = null;\n\n    /**\n     * gain change required for preventing clipping\n     */\n    this.noclipGainChange = 0;\n    /**\n     * user-specified scale factor required for preventing clipping\n     */\n    this.noclipScale = 0.;\n\n    /* simple statistics */\n    this.bitrate_stereoMode_Hist = new_int_n([16, 4 + 1]);\n    /**\n     * norm/start/short/stop/mixed(short)/sum\n     */\n    this.bitrate_blockType_Hist = new_int_n([16, 4 + 1 + 1]);\n\n    //public PlottingData pinfo;\n    //public MPGLib.mpstr_tag hip;\n    this.pinfo = null;\n    this.hip = null;\n\n    this.in_buffer_nsamples = 0;\n    //public float[] in_buffer_0;\n    //public float[] in_buffer_1;\n    this.in_buffer_0 = null;\n    this.in_buffer_1 = null;\n\n    //public IIterationLoop iteration_loop;\n    this.iteration_loop = null;\n\n    for (var i = 0; i < this.en.length; i++) {\n        this.en[i] = new III_psy_xmin();\n    }\n    for (var i = 0; i < this.thm.length; i++) {\n        this.thm[i] = new III_psy_xmin();\n    }\n    for (var i = 0; i < this.header.length; i++) {\n        this.header[i] = new Header();\n    }\n\n}\n\n\n\nfunction FFT() {\n\n    var window = new_float(Encoder.BLKSIZE);\n    var window_s = new_float(Encoder.BLKSIZE_s / 2);\n\n    var costab = [\n        9.238795325112867e-01, 3.826834323650898e-01,\n        9.951847266721969e-01, 9.801714032956060e-02,\n        9.996988186962042e-01, 2.454122852291229e-02,\n        9.999811752826011e-01, 6.135884649154475e-03\n    ];\n\n    function fht(fz, fzPos, n) {\n        var tri = 0;\n        var k4;\n        var fi;\n        var gi;\n\n        n <<= 1;\n        /* to get BLKSIZE, because of 3DNow! ASM routine */\n        var fn = fzPos + n;\n        k4 = 4;\n        do {\n            var s1, c1;\n            var i, k1, k2, k3, kx;\n            kx = k4 >> 1;\n            k1 = k4;\n            k2 = k4 << 1;\n            k3 = k2 + k1;\n            k4 = k2 << 1;\n            fi = fzPos;\n            gi = fi + kx;\n            do {\n                var f0, f1, f2, f3;\n                f1 = fz[fi + 0] - fz[fi + k1];\n                f0 = fz[fi + 0] + fz[fi + k1];\n                f3 = fz[fi + k2] - fz[fi + k3];\n                f2 = fz[fi + k2] + fz[fi + k3];\n                fz[fi + k2] = f0 - f2;\n                fz[fi + 0] = f0 + f2;\n                fz[fi + k3] = f1 - f3;\n                fz[fi + k1] = f1 + f3;\n                f1 = fz[gi + 0] - fz[gi + k1];\n                f0 = fz[gi + 0] + fz[gi + k1];\n                f3 = (Util.SQRT2 * fz[gi + k3]);\n                f2 = (Util.SQRT2 * fz[gi + k2]);\n                fz[gi + k2] = f0 - f2;\n                fz[gi + 0] = f0 + f2;\n                fz[gi + k3] = f1 - f3;\n                fz[gi + k1] = f1 + f3;\n                gi += k4;\n                fi += k4;\n            } while (fi < fn);\n            c1 = costab[tri + 0];\n            s1 = costab[tri + 1];\n            for (i = 1; i < kx; i++) {\n                var c2, s2;\n                c2 = 1 - (2 * s1) * s1;\n                s2 = (2 * s1) * c1;\n                fi = fzPos + i;\n                gi = fzPos + k1 - i;\n                do {\n                    var a, b, g0, f0, f1, g1, f2, g2, f3, g3;\n                    b = s2 * fz[fi + k1] - c2 * fz[gi + k1];\n                    a = c2 * fz[fi + k1] + s2 * fz[gi + k1];\n                    f1 = fz[fi + 0] - a;\n                    f0 = fz[fi + 0] + a;\n                    g1 = fz[gi + 0] - b;\n                    g0 = fz[gi + 0] + b;\n                    b = s2 * fz[fi + k3] - c2 * fz[gi + k3];\n                    a = c2 * fz[fi + k3] + s2 * fz[gi + k3];\n                    f3 = fz[fi + k2] - a;\n                    f2 = fz[fi + k2] + a;\n                    g3 = fz[gi + k2] - b;\n                    g2 = fz[gi + k2] + b;\n                    b = s1 * f2 - c1 * g3;\n                    a = c1 * f2 + s1 * g3;\n                    fz[fi + k2] = f0 - a;\n                    fz[fi + 0] = f0 + a;\n                    fz[gi + k3] = g1 - b;\n                    fz[gi + k1] = g1 + b;\n                    b = c1 * g2 - s1 * f3;\n                    a = s1 * g2 + c1 * f3;\n                    fz[gi + k2] = g0 - a;\n                    fz[gi + 0] = g0 + a;\n                    fz[fi + k3] = f1 - b;\n                    fz[fi + k1] = f1 + b;\n                    gi += k4;\n                    fi += k4;\n                } while (fi < fn);\n                c2 = c1;\n                c1 = c2 * costab[tri + 0] - s1 * costab[tri + 1];\n                s1 = c2 * costab[tri + 1] + s1 * costab[tri + 0];\n            }\n            tri += 2;\n        } while (k4 < n);\n    }\n\n    var rv_tbl = [0x00, 0x80, 0x40,\n        0xc0, 0x20, 0xa0, 0x60, 0xe0, 0x10,\n        0x90, 0x50, 0xd0, 0x30, 0xb0, 0x70,\n        0xf0, 0x08, 0x88, 0x48, 0xc8, 0x28,\n        0xa8, 0x68, 0xe8, 0x18, 0x98, 0x58,\n        0xd8, 0x38, 0xb8, 0x78, 0xf8, 0x04,\n        0x84, 0x44, 0xc4, 0x24, 0xa4, 0x64,\n        0xe4, 0x14, 0x94, 0x54, 0xd4, 0x34,\n        0xb4, 0x74, 0xf4, 0x0c, 0x8c, 0x4c,\n        0xcc, 0x2c, 0xac, 0x6c, 0xec, 0x1c,\n        0x9c, 0x5c, 0xdc, 0x3c, 0xbc, 0x7c,\n        0xfc, 0x02, 0x82, 0x42, 0xc2, 0x22,\n        0xa2, 0x62, 0xe2, 0x12, 0x92, 0x52,\n        0xd2, 0x32, 0xb2, 0x72, 0xf2, 0x0a,\n        0x8a, 0x4a, 0xca, 0x2a, 0xaa, 0x6a,\n        0xea, 0x1a, 0x9a, 0x5a, 0xda, 0x3a,\n        0xba, 0x7a, 0xfa, 0x06, 0x86, 0x46,\n        0xc6, 0x26, 0xa6, 0x66, 0xe6, 0x16,\n        0x96, 0x56, 0xd6, 0x36, 0xb6, 0x76,\n        0xf6, 0x0e, 0x8e, 0x4e, 0xce, 0x2e,\n        0xae, 0x6e, 0xee, 0x1e, 0x9e, 0x5e,\n        0xde, 0x3e, 0xbe, 0x7e, 0xfe];\n\n    this.fft_short = function (gfc, x_real, chn, buffer, bufPos) {\n        for (var b = 0; b < 3; b++) {\n            var x = Encoder.BLKSIZE_s / 2;\n            var k = 0xffff & ((576 / 3) * (b + 1));\n            var j = Encoder.BLKSIZE_s / 8 - 1;\n            do {\n                var f0, f1, f2, f3, w;\n                var i = rv_tbl[j << 2] & 0xff;\n\n                f0 = window_s[i] * buffer[chn][bufPos + i + k];\n                w = window_s[0x7f - i] * buffer[chn][bufPos + i + k + 0x80];\n                f1 = f0 - w;\n                f0 = f0 + w;\n                f2 = window_s[i + 0x40] * buffer[chn][bufPos + i + k + 0x40];\n                w = window_s[0x3f - i] * buffer[chn][bufPos + i + k + 0xc0];\n                f3 = f2 - w;\n                f2 = f2 + w;\n\n                x -= 4;\n                x_real[b][x + 0] = f0 + f2;\n                x_real[b][x + 2] = f0 - f2;\n                x_real[b][x + 1] = f1 + f3;\n                x_real[b][x + 3] = f1 - f3;\n\n                f0 = window_s[i + 0x01] * buffer[chn][bufPos + i + k + 0x01];\n                w = window_s[0x7e - i] * buffer[chn][bufPos + i + k + 0x81];\n                f1 = f0 - w;\n                f0 = f0 + w;\n                f2 = window_s[i + 0x41] * buffer[chn][bufPos + i + k + 0x41];\n                w = window_s[0x3e - i] * buffer[chn][bufPos + i + k + 0xc1];\n                f3 = f2 - w;\n                f2 = f2 + w;\n\n                x_real[b][x + Encoder.BLKSIZE_s / 2 + 0] = f0 + f2;\n                x_real[b][x + Encoder.BLKSIZE_s / 2 + 2] = f0 - f2;\n                x_real[b][x + Encoder.BLKSIZE_s / 2 + 1] = f1 + f3;\n                x_real[b][x + Encoder.BLKSIZE_s / 2 + 3] = f1 - f3;\n            } while (--j >= 0);\n\n            fht(x_real[b], x, Encoder.BLKSIZE_s / 2);\n            /* BLKSIZE_s/2 because of 3DNow! ASM routine */\n            /* BLKSIZE/2 because of 3DNow! ASM routine */\n        }\n    }\n\n    this.fft_long = function (gfc, y, chn, buffer, bufPos) {\n        var jj = Encoder.BLKSIZE / 8 - 1;\n        var x = Encoder.BLKSIZE / 2;\n\n        do {\n            var f0, f1, f2, f3, w;\n            var i = rv_tbl[jj] & 0xff;\n            f0 = window[i] * buffer[chn][bufPos + i];\n            w = window[i + 0x200] * buffer[chn][bufPos + i + 0x200];\n            f1 = f0 - w;\n            f0 = f0 + w;\n            f2 = window[i + 0x100] * buffer[chn][bufPos + i + 0x100];\n            w = window[i + 0x300] * buffer[chn][bufPos + i + 0x300];\n            f3 = f2 - w;\n            f2 = f2 + w;\n\n            x -= 4;\n            y[x + 0] = f0 + f2;\n            y[x + 2] = f0 - f2;\n            y[x + 1] = f1 + f3;\n            y[x + 3] = f1 - f3;\n\n            f0 = window[i + 0x001] * buffer[chn][bufPos + i + 0x001];\n            w = window[i + 0x201] * buffer[chn][bufPos + i + 0x201];\n            f1 = f0 - w;\n            f0 = f0 + w;\n            f2 = window[i + 0x101] * buffer[chn][bufPos + i + 0x101];\n            w = window[i + 0x301] * buffer[chn][bufPos + i + 0x301];\n            f3 = f2 - w;\n            f2 = f2 + w;\n\n            y[x + Encoder.BLKSIZE / 2 + 0] = f0 + f2;\n            y[x + Encoder.BLKSIZE / 2 + 2] = f0 - f2;\n            y[x + Encoder.BLKSIZE / 2 + 1] = f1 + f3;\n            y[x + Encoder.BLKSIZE / 2 + 3] = f1 - f3;\n        } while (--jj >= 0);\n\n        fht(y, x, Encoder.BLKSIZE / 2);\n        /* BLKSIZE/2 because of 3DNow! ASM routine */\n    }\n\n    this.init_fft = function (gfc) {\n        /* The type of window used here will make no real difference, but */\n        /*\n         * in the interest of merging nspsytune stuff - switch to blackman\n         * window\n         */\n        for (var i = 0; i < Encoder.BLKSIZE; i++)\n            /* blackman window */\n            window[i] = (0.42 - 0.5 * Math.cos(2 * Math.PI * (i + .5)\n                / Encoder.BLKSIZE) + 0.08 * Math.cos(4 * Math.PI * (i + .5)\n                / Encoder.BLKSIZE));\n\n        for (var i = 0; i < Encoder.BLKSIZE_s / 2; i++)\n            window_s[i] = (0.5 * (1.0 - Math.cos(2.0 * Math.PI\n                * (i + 0.5) / Encoder.BLKSIZE_s)));\n\n    }\n\n}\n\n/*\n *      psymodel.c\n *\n *      Copyright (c) 1999-2000 Mark Taylor\n *      Copyright (c) 2001-2002 Naoki Shibata\n *      Copyright (c) 2000-2003 Takehiro Tominaga\n *      Copyright (c) 2000-2008 Robert Hegemann\n *      Copyright (c) 2000-2005 Gabriel Bouvigne\n *      Copyright (c) 2000-2005 Alexander Leidinger\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n\n/* $Id: PsyModel.java,v 1.27 2011/05/24 20:48:06 kenchis Exp $ */\n\n\n/*\n PSYCHO ACOUSTICS\n\n\n This routine computes the psycho acoustics, delayed by one granule.\n\n Input: buffer of PCM data (1024 samples).\n\n This window should be centered over the 576 sample granule window.\n The routine will compute the psycho acoustics for\n this granule, but return the psycho acoustics computed\n for the *previous* granule.  This is because the block\n type of the previous granule can only be determined\n after we have computed the psycho acoustics for the following\n granule.\n\n Output:  maskings and energies for each scalefactor band.\n block type, PE, and some correlation measures.\n The PE is used by CBR modes to determine if extra bits\n from the bit reservoir should be used.  The correlation\n measures are used to determine mid/side or regular stereo.\n */\n/*\n Notation:\n\n barks:  a non-linear frequency scale.  Mapping from frequency to\n barks is given by freq2bark()\n\n scalefactor bands: The spectrum (frequencies) are broken into\n SBMAX \"scalefactor bands\".  Thes bands\n are determined by the MPEG ISO spec.  In\n the noise shaping/quantization code, we allocate\n bits among the partition bands to achieve the\n best possible quality\n\n partition bands:   The spectrum is also broken into about\n 64 \"partition bands\".  Each partition\n band is about .34 barks wide.  There are about 2-5\n partition bands for each scalefactor band.\n\n LAME computes all psycho acoustic information for each partition\n band.  Then at the end of the computations, this information\n is mapped to scalefactor bands.  The energy in each scalefactor\n band is taken as the sum of the energy in all partition bands\n which overlap the scalefactor band.  The maskings can be computed\n in the same way (and thus represent the average masking in that band)\n or by taking the minmum value multiplied by the number of\n partition bands used (which represents a minimum masking in that band).\n */\n/*\n The general outline is as follows:\n\n 1. compute the energy in each partition band\n 2. compute the tonality in each partition band\n 3. compute the strength of each partion band \"masker\"\n 4. compute the masking (via the spreading function applied to each masker)\n 5. Modifications for mid/side masking.\n\n Each partition band is considiered a \"masker\".  The strength\n of the i'th masker in band j is given by:\n\n s3(bark(i)-bark(j))*strength(i)\n\n The strength of the masker is a function of the energy and tonality.\n The more tonal, the less masking.  LAME uses a simple linear formula\n (controlled by NMT and TMN) which says the strength is given by the\n energy divided by a linear function of the tonality.\n */\n/*\n s3() is the \"spreading function\".  It is given by a formula\n determined via listening tests.\n\n The total masking in the j'th partition band is the sum over\n all maskings i.  It is thus given by the convolution of\n the strength with s3(), the \"spreading function.\"\n\n masking(j) = sum_over_i  s3(i-j)*strength(i)  = s3 o strength\n\n where \"o\" = convolution operator.  s3 is given by a formula determined\n via listening tests.  It is normalized so that s3 o 1 = 1.\n\n Note: instead of a simple convolution, LAME also has the\n option of using \"additive masking\"\n\n The most critical part is step 2, computing the tonality of each\n partition band.  LAME has two tonality estimators.  The first\n is based on the ISO spec, and measures how predictiable the\n signal is over time.  The more predictable, the more tonal.\n The second measure is based on looking at the spectrum of\n a single granule.  The more peaky the spectrum, the more\n tonal.  By most indications, the latter approach is better.\n\n Finally, in step 5, the maskings for the mid and side\n channel are possibly increased.  Under certain circumstances,\n noise in the mid & side channels is assumed to also\n be masked by strong maskers in the L or R channels.\n\n\n Other data computed by the psy-model:\n\n ms_ratio        side-channel / mid-channel masking ratio (for previous granule)\n ms_ratio_next   side-channel / mid-channel masking ratio for this granule\n\n percep_entropy[2]     L and R values (prev granule) of PE - A measure of how\n much pre-echo is in the previous granule\n percep_entropy_MS[2]  mid and side channel values (prev granule) of percep_entropy\n energy[4]             L,R,M,S energy in each channel, prev granule\n blocktype_d[2]        block type to use for previous granule\n */\n//package mp3;\n\n//import java.util.Arrays;\n\n\nfunction PsyModel() {\n\n    var fft = new FFT();\n\n    var LOG10 = 2.30258509299404568402;\n\n    var rpelev = 2;\n    var rpelev2 = 16;\n    var rpelev_s = 2;\n    var rpelev2_s = 16;\n\n    /* size of each partition band, in barks: */\n    var DELBARK = .34;\n\n    /* tuned for output level (sensitive to energy scale) */\n    var VO_SCALE = (1. / (14752 * 14752) / (Encoder.BLKSIZE / 2));\n\n    var temporalmask_sustain_sec = 0.01;\n\n    var NS_PREECHO_ATT0 = 0.8;\n    var NS_PREECHO_ATT1 = 0.6;\n    var NS_PREECHO_ATT2 = 0.3;\n\n    var NS_MSFIX = 3.5;\n\n    var NSATTACKTHRE = 4.4;\n    var NSATTACKTHRE_S = 25;\n\n    var NSFIRLEN = 21;\n\n    /* size of each partition band, in barks: */\n    var LN_TO_LOG10 = 0.2302585093;\n\n    function NON_LINEAR_SCALE_ENERGY(x) {\n        return x;\n    }\n\n    /**\n     * <PRE>\n     *       L3psycho_anal.  Compute psycho acoustics.\n     *\n     *       Data returned to the calling program must be delayed by one\n     *       granule.\n     *\n     *       This is done in two places.\n     *       If we do not need to know the blocktype, the copying\n     *       can be done here at the top of the program: we copy the data for\n     *       the last granule (computed during the last call) before it is\n     *       overwritten with the new data.  It looks like this:\n     *\n     *       0. static psymodel_data\n     *       1. calling_program_data = psymodel_data\n     *       2. compute psymodel_data\n     *\n     *       For data which needs to know the blocktype, the copying must be\n     *       done at the end of this loop, and the old values must be saved:\n     *\n     *       0. static psymodel_data_old\n     *       1. compute psymodel_data\n     *       2. compute possible block type of this granule\n     *       3. compute final block type of previous granule based on #2.\n     *       4. calling_program_data = psymodel_data_old\n     *       5. psymodel_data_old = psymodel_data\n     *     psycho_loudness_approx\n     *       jd - 2001 mar 12\n     *    in:  energy   - BLKSIZE/2 elements of frequency magnitudes ^ 2\n     *         gfp      - uses out_samplerate, ATHtype (also needed for ATHformula)\n     *    returns: loudness^2 approximation, a positive value roughly tuned for a value\n     *             of 1.0 for signals near clipping.\n     *    notes:   When calibrated, feeding this function binary white noise at sample\n     *             values +32767 or -32768 should return values that approach 3.\n     *             ATHformula is used to approximate an equal loudness curve.\n     *    future:  Data indicates that the shape of the equal loudness curve varies\n     *             with intensity.  This function might be improved by using an equal\n     *             loudness curve shaped for typical playback levels (instead of the\n     *             ATH, that is shaped for the threshold).  A flexible realization might\n     *             simply bend the existing ATH curve to achieve the desired shape.\n     *             However, the potential gain may not be enough to justify an effort.\n     * </PRE>\n     */\n    function psycho_loudness_approx(energy, gfc) {\n        var loudness_power = 0.0;\n        /* apply weights to power in freq. bands */\n        for (var i = 0; i < Encoder.BLKSIZE / 2; ++i)\n            loudness_power += energy[i] * gfc.ATH.eql_w[i];\n        loudness_power *= VO_SCALE;\n\n        return loudness_power;\n    }\n\n    function compute_ffts(gfp, fftenergy, fftenergy_s, wsamp_l, wsamp_lPos, wsamp_s, wsamp_sPos, gr_out, chn, buffer, bufPos) {\n        var gfc = gfp.internal_flags;\n        if (chn < 2) {\n            fft.fft_long(gfc, wsamp_l[wsamp_lPos], chn, buffer, bufPos);\n            fft.fft_short(gfc, wsamp_s[wsamp_sPos], chn, buffer, bufPos);\n        }\n        /* FFT data for mid and side channel is derived from L & R */\n        else if (chn == 2) {\n            for (var j = Encoder.BLKSIZE - 1; j >= 0; --j) {\n                var l = wsamp_l[wsamp_lPos + 0][j];\n                var r = wsamp_l[wsamp_lPos + 1][j];\n                wsamp_l[wsamp_lPos + 0][j] = (l + r) * Util.SQRT2 * 0.5;\n                wsamp_l[wsamp_lPos + 1][j] = (l - r) * Util.SQRT2 * 0.5;\n            }\n            for (var b = 2; b >= 0; --b) {\n                for (var j = Encoder.BLKSIZE_s - 1; j >= 0; --j) {\n                    var l = wsamp_s[wsamp_sPos + 0][b][j];\n                    var r = wsamp_s[wsamp_sPos + 1][b][j];\n                    wsamp_s[wsamp_sPos + 0][b][j] = (l + r) * Util.SQRT2 * 0.5;\n                    wsamp_s[wsamp_sPos + 1][b][j] = (l - r) * Util.SQRT2 * 0.5;\n                }\n            }\n        }\n\n        /*********************************************************************\n         * compute energies\n         *********************************************************************/\n        fftenergy[0] = NON_LINEAR_SCALE_ENERGY(wsamp_l[wsamp_lPos + 0][0]);\n        fftenergy[0] *= fftenergy[0];\n\n        for (var j = Encoder.BLKSIZE / 2 - 1; j >= 0; --j) {\n            var re = (wsamp_l[wsamp_lPos + 0])[Encoder.BLKSIZE / 2 - j];\n            var im = (wsamp_l[wsamp_lPos + 0])[Encoder.BLKSIZE / 2 + j];\n            fftenergy[Encoder.BLKSIZE / 2 - j] = NON_LINEAR_SCALE_ENERGY((re\n                * re + im * im) * 0.5);\n        }\n        for (var b = 2; b >= 0; --b) {\n            fftenergy_s[b][0] = (wsamp_s[wsamp_sPos + 0])[b][0];\n            fftenergy_s[b][0] *= fftenergy_s[b][0];\n            for (var j = Encoder.BLKSIZE_s / 2 - 1; j >= 0; --j) {\n                var re = (wsamp_s[wsamp_sPos + 0])[b][Encoder.BLKSIZE_s\n                / 2 - j];\n                var im = (wsamp_s[wsamp_sPos + 0])[b][Encoder.BLKSIZE_s\n                / 2 + j];\n                fftenergy_s[b][Encoder.BLKSIZE_s / 2 - j] = NON_LINEAR_SCALE_ENERGY((re\n                    * re + im * im) * 0.5);\n            }\n        }\n        /* total energy */\n        {\n            var totalenergy = 0.0;\n            for (var j = 11; j < Encoder.HBLKSIZE; j++)\n                totalenergy += fftenergy[j];\n\n            gfc.tot_ener[chn] = totalenergy;\n        }\n\n        if (gfp.analysis) {\n            for (var j = 0; j < Encoder.HBLKSIZE; j++) {\n                gfc.pinfo.energy[gr_out][chn][j] = gfc.pinfo.energy_save[chn][j];\n                gfc.pinfo.energy_save[chn][j] = fftenergy[j];\n            }\n            gfc.pinfo.pe[gr_out][chn] = gfc.pe[chn];\n        }\n\n        /*********************************************************************\n         * compute loudness approximation (used for ATH auto-level adjustment)\n         *********************************************************************/\n        if (gfp.athaa_loudapprox == 2 && chn < 2) {\n            // no loudness for mid/side ch\n            gfc.loudness_sq[gr_out][chn] = gfc.loudness_sq_save[chn];\n            gfc.loudness_sq_save[chn] = psycho_loudness_approx(fftenergy, gfc);\n        }\n    }\n\n    /* mask_add optimization */\n    /* init the limit values used to avoid computing log in mask_add when it is not necessary */\n\n    /**\n     * <PRE>\n     *  For example, with i = 10*log10(m2/m1)/10*16         (= log10(m2/m1)*16)\n     *\n     * abs(i)>8 is equivalent (as i is an integer) to\n     * abs(i)>=9\n     * i>=9 || i<=-9\n     * equivalent to (as i is the biggest integer smaller than log10(m2/m1)*16\n     * or the smallest integer bigger than log10(m2/m1)*16 depending on the sign of log10(m2/m1)*16)\n     * log10(m2/m1)>=9/16 || log10(m2/m1)<=-9/16\n     * exp10 is strictly increasing thus this is equivalent to\n     * m2/m1 >= 10^(9/16) || m2/m1<=10^(-9/16) which are comparisons to constants\n     * </PRE>\n     */\n\n    /**\n     * as in if(i>8)\n     */\n    var I1LIMIT = 8;\n    /**\n     * as in if(i>24) . changed 23\n     */\n    var I2LIMIT = 23;\n    /**\n     * as in if(m<15)\n     */\n    var MLIMIT = 15;\n\n    var ma_max_i1;\n    var ma_max_i2;\n    var ma_max_m;\n\n    /**\n     * This is the masking table:<BR>\n     * According to tonality, values are going from 0dB (TMN) to 9.3dB (NMT).<BR>\n     * After additive masking computation, 8dB are added, so final values are\n     * going from 8dB to 17.3dB\n     *\n     * pow(10, -0.0..-0.6)\n     */\n    var tab = [1.0, 0.79433, 0.63096, 0.63096,\n        0.63096, 0.63096, 0.63096, 0.25119, 0.11749];\n\n    function init_mask_add_max_values() {\n        ma_max_i1 = Math.pow(10, (I1LIMIT + 1) / 16.0);\n        ma_max_i2 = Math.pow(10, (I2LIMIT + 1) / 16.0);\n        ma_max_m = Math.pow(10, (MLIMIT) / 10.0);\n    }\n\n    var table1 = [3.3246 * 3.3246,\n        3.23837 * 3.23837, 3.15437 * 3.15437, 3.00412 * 3.00412,\n        2.86103 * 2.86103, 2.65407 * 2.65407, 2.46209 * 2.46209,\n        2.284 * 2.284, 2.11879 * 2.11879, 1.96552 * 1.96552,\n        1.82335 * 1.82335, 1.69146 * 1.69146, 1.56911 * 1.56911,\n        1.46658 * 1.46658, 1.37074 * 1.37074, 1.31036 * 1.31036,\n        1.25264 * 1.25264, 1.20648 * 1.20648, 1.16203 * 1.16203,\n        1.12765 * 1.12765, 1.09428 * 1.09428, 1.0659 * 1.0659,\n        1.03826 * 1.03826, 1.01895 * 1.01895, 1];\n\n    var table2 = [1.33352 * 1.33352,\n        1.35879 * 1.35879, 1.38454 * 1.38454, 1.39497 * 1.39497,\n        1.40548 * 1.40548, 1.3537 * 1.3537, 1.30382 * 1.30382,\n        1.22321 * 1.22321, 1.14758 * 1.14758, 1];\n\n    var table3 = [2.35364 * 2.35364,\n        2.29259 * 2.29259, 2.23313 * 2.23313, 2.12675 * 2.12675,\n        2.02545 * 2.02545, 1.87894 * 1.87894, 1.74303 * 1.74303,\n        1.61695 * 1.61695, 1.49999 * 1.49999, 1.39148 * 1.39148,\n        1.29083 * 1.29083, 1.19746 * 1.19746, 1.11084 * 1.11084,\n        1.03826 * 1.03826];\n\n    /**\n     * addition of simultaneous masking Naoki Shibata 2000/7\n     */\n    function mask_add(m1, m2, kk, b, gfc, shortblock) {\n        var ratio;\n\n        if (m2 > m1) {\n            if (m2 < (m1 * ma_max_i2))\n                ratio = m2 / m1;\n            else\n                return (m1 + m2);\n        } else {\n            if (m1 >= (m2 * ma_max_i2))\n                return (m1 + m2);\n            ratio = m1 / m2;\n        }\n\n        /* Should always be true, just checking */\n\n        m1 += m2;\n        //if (((long)(b + 3) & 0xffffffff) <= 3 + 3) {\n        if ((b + 3) <= 3 + 3) {\n            /* approximately, 1 bark = 3 partitions */\n            /* 65% of the cases */\n            /* originally 'if(i > 8)' */\n            if (ratio >= ma_max_i1) {\n                /* 43% of the total */\n                return m1;\n            }\n\n            /* 22% of the total */\n            var i = 0 | (Util.FAST_LOG10_X(ratio, 16.0));\n            return m1 * table2[i];\n        }\n\n        /**\n         * <PRE>\n         * m<15 equ log10((m1+m2)/gfc.ATH.cb[k])<1.5\n         * equ (m1+m2)/gfc.ATH.cb[k]<10^1.5\n         * equ (m1+m2)<10^1.5 * gfc.ATH.cb[k]\n         * </PRE>\n         */\n        var i = 0 | Util.FAST_LOG10_X(ratio, 16.0);\n        if (shortblock != 0) {\n            m2 = gfc.ATH.cb_s[kk] * gfc.ATH.adjust;\n        } else {\n            m2 = gfc.ATH.cb_l[kk] * gfc.ATH.adjust;\n        }\n        if (m1 < ma_max_m * m2) {\n            /* 3% of the total */\n            /* Originally if (m > 0) { */\n            if (m1 > m2) {\n                var f, r;\n\n                f = 1.0;\n                if (i <= 13)\n                    f = table3[i];\n\n                r = Util.FAST_LOG10_X(m1 / m2, 10.0 / 15.0);\n                return m1 * ((table1[i] - f) * r + f);\n            }\n\n            if (i > 13)\n                return m1;\n\n            return m1 * table3[i];\n        }\n\n        /* 10% of total */\n        return m1 * table1[i];\n    }\n\n    var table2_ = [1.33352 * 1.33352,\n        1.35879 * 1.35879, 1.38454 * 1.38454, 1.39497 * 1.39497,\n        1.40548 * 1.40548, 1.3537 * 1.3537, 1.30382 * 1.30382,\n        1.22321 * 1.22321, 1.14758 * 1.14758, 1];\n\n    /**\n     * addition of simultaneous masking Naoki Shibata 2000/7\n     */\n    function vbrpsy_mask_add(m1, m2, b) {\n        var ratio;\n\n        if (m1 < 0) {\n            m1 = 0;\n        }\n        if (m2 < 0) {\n            m2 = 0;\n        }\n        if (m1 <= 0) {\n            return m2;\n        }\n        if (m2 <= 0) {\n            return m1;\n        }\n        if (m2 > m1) {\n            ratio = m2 / m1;\n        } else {\n            ratio = m1 / m2;\n        }\n        if (-2 <= b && b <= 2) {\n            /* approximately, 1 bark = 3 partitions */\n            /* originally 'if(i > 8)' */\n            if (ratio >= ma_max_i1) {\n                return m1 + m2;\n            } else {\n                var i = 0 | (Util.FAST_LOG10_X(ratio, 16.0));\n                return (m1 + m2) * table2_[i];\n            }\n        }\n        if (ratio < ma_max_i2) {\n            return m1 + m2;\n        }\n        if (m1 < m2) {\n            m1 = m2;\n        }\n        return m1;\n    }\n\n    /**\n     * compute interchannel masking effects\n     */\n    function calc_interchannel_masking(gfp, ratio) {\n        var gfc = gfp.internal_flags;\n        if (gfc.channels_out > 1) {\n            for (var sb = 0; sb < Encoder.SBMAX_l; sb++) {\n                var l = gfc.thm[0].l[sb];\n                var r = gfc.thm[1].l[sb];\n                gfc.thm[0].l[sb] += r * ratio;\n                gfc.thm[1].l[sb] += l * ratio;\n            }\n            for (var sb = 0; sb < Encoder.SBMAX_s; sb++) {\n                for (var sblock = 0; sblock < 3; sblock++) {\n                    var l = gfc.thm[0].s[sb][sblock];\n                    var r = gfc.thm[1].s[sb][sblock];\n                    gfc.thm[0].s[sb][sblock] += r * ratio;\n                    gfc.thm[1].s[sb][sblock] += l * ratio;\n                }\n            }\n        }\n    }\n\n    /**\n     * compute M/S thresholds from Johnston & Ferreira 1992 ICASSP paper\n     */\n    function msfix1(gfc) {\n        for (var sb = 0; sb < Encoder.SBMAX_l; sb++) {\n            /* use this fix if L & R masking differs by 2db or less */\n            /* if db = 10*log10(x2/x1) < 2 */\n            /* if (x2 < 1.58*x1) { */\n            if (gfc.thm[0].l[sb] > 1.58 * gfc.thm[1].l[sb]\n                || gfc.thm[1].l[sb] > 1.58 * gfc.thm[0].l[sb])\n                continue;\n            var mld = gfc.mld_l[sb] * gfc.en[3].l[sb];\n            var rmid = Math.max(gfc.thm[2].l[sb],\n                Math.min(gfc.thm[3].l[sb], mld));\n\n            mld = gfc.mld_l[sb] * gfc.en[2].l[sb];\n            var rside = Math.max(gfc.thm[3].l[sb],\n                Math.min(gfc.thm[2].l[sb], mld));\n            gfc.thm[2].l[sb] = rmid;\n            gfc.thm[3].l[sb] = rside;\n        }\n\n        for (var sb = 0; sb < Encoder.SBMAX_s; sb++) {\n            for (var sblock = 0; sblock < 3; sblock++) {\n                if (gfc.thm[0].s[sb][sblock] > 1.58 * gfc.thm[1].s[sb][sblock]\n                    || gfc.thm[1].s[sb][sblock] > 1.58 * gfc.thm[0].s[sb][sblock])\n                    continue;\n                var mld = gfc.mld_s[sb] * gfc.en[3].s[sb][sblock];\n                var rmid = Math.max(gfc.thm[2].s[sb][sblock],\n                    Math.min(gfc.thm[3].s[sb][sblock], mld));\n\n                mld = gfc.mld_s[sb] * gfc.en[2].s[sb][sblock];\n                var rside = Math.max(gfc.thm[3].s[sb][sblock],\n                    Math.min(gfc.thm[2].s[sb][sblock], mld));\n\n                gfc.thm[2].s[sb][sblock] = rmid;\n                gfc.thm[3].s[sb][sblock] = rside;\n            }\n        }\n    }\n\n    /**\n     * Adjust M/S maskings if user set \"msfix\"\n     *\n     * Naoki Shibata 2000\n     */\n    function ns_msfix(gfc, msfix, athadjust) {\n        var msfix2 = msfix;\n        var athlower = Math.pow(10, athadjust);\n\n        msfix *= 2.0;\n        msfix2 *= 2.0;\n        for (var sb = 0; sb < Encoder.SBMAX_l; sb++) {\n            var thmLR, thmM, thmS, ath;\n            ath = (gfc.ATH.cb_l[gfc.bm_l[sb]]) * athlower;\n            thmLR = Math.min(Math.max(gfc.thm[0].l[sb], ath),\n                Math.max(gfc.thm[1].l[sb], ath));\n            thmM = Math.max(gfc.thm[2].l[sb], ath);\n            thmS = Math.max(gfc.thm[3].l[sb], ath);\n            if (thmLR * msfix < thmM + thmS) {\n                var f = thmLR * msfix2 / (thmM + thmS);\n                thmM *= f;\n                thmS *= f;\n            }\n            gfc.thm[2].l[sb] = Math.min(thmM, gfc.thm[2].l[sb]);\n            gfc.thm[3].l[sb] = Math.min(thmS, gfc.thm[3].l[sb]);\n        }\n\n        athlower *= ( Encoder.BLKSIZE_s / Encoder.BLKSIZE);\n        for (var sb = 0; sb < Encoder.SBMAX_s; sb++) {\n            for (var sblock = 0; sblock < 3; sblock++) {\n                var thmLR, thmM, thmS, ath;\n                ath = (gfc.ATH.cb_s[gfc.bm_s[sb]]) * athlower;\n                thmLR = Math.min(Math.max(gfc.thm[0].s[sb][sblock], ath),\n                    Math.max(gfc.thm[1].s[sb][sblock], ath));\n                thmM = Math.max(gfc.thm[2].s[sb][sblock], ath);\n                thmS = Math.max(gfc.thm[3].s[sb][sblock], ath);\n\n                if (thmLR * msfix < thmM + thmS) {\n                    var f = thmLR * msfix / (thmM + thmS);\n                    thmM *= f;\n                    thmS *= f;\n                }\n                gfc.thm[2].s[sb][sblock] = Math.min(gfc.thm[2].s[sb][sblock],\n                    thmM);\n                gfc.thm[3].s[sb][sblock] = Math.min(gfc.thm[3].s[sb][sblock],\n                    thmS);\n            }\n        }\n    }\n\n    /**\n     * short block threshold calculation (part 2)\n     *\n     * partition band bo_s[sfb] is at the transition from scalefactor band sfb\n     * to the next one sfb+1; enn and thmm have to be split between them\n     */\n    function convert_partition2scalefac_s(gfc, eb, thr, chn, sblock) {\n        var sb, b;\n        var enn = 0.0;\n        var thmm = 0.0;\n        for (sb = b = 0; sb < Encoder.SBMAX_s; ++b, ++sb) {\n            var bo_s_sb = gfc.bo_s[sb];\n            var npart_s = gfc.npart_s;\n            var b_lim = bo_s_sb < npart_s ? bo_s_sb : npart_s;\n            while (b < b_lim) {\n                // iff failed, it may indicate some index error elsewhere\n                enn += eb[b];\n                thmm += thr[b];\n                b++;\n            }\n            gfc.en[chn].s[sb][sblock] = enn;\n            gfc.thm[chn].s[sb][sblock] = thmm;\n\n            if (b >= npart_s) {\n                ++sb;\n                break;\n            }\n            // iff failed, it may indicate some index error elsewhere\n            {\n                /* at transition sfb . sfb+1 */\n                var w_curr = gfc.PSY.bo_s_weight[sb];\n                var w_next = 1.0 - w_curr;\n                enn = w_curr * eb[b];\n                thmm = w_curr * thr[b];\n                gfc.en[chn].s[sb][sblock] += enn;\n                gfc.thm[chn].s[sb][sblock] += thmm;\n                enn = w_next * eb[b];\n                thmm = w_next * thr[b];\n            }\n        }\n        /* zero initialize the rest */\n        for (; sb < Encoder.SBMAX_s; ++sb) {\n            gfc.en[chn].s[sb][sblock] = 0;\n            gfc.thm[chn].s[sb][sblock] = 0;\n        }\n    }\n\n    /**\n     * longblock threshold calculation (part 2)\n     */\n    function convert_partition2scalefac_l(gfc, eb, thr, chn) {\n        var sb, b;\n        var enn = 0.0;\n        var thmm = 0.0;\n        for (sb = b = 0; sb < Encoder.SBMAX_l; ++b, ++sb) {\n            var bo_l_sb = gfc.bo_l[sb];\n            var npart_l = gfc.npart_l;\n            var b_lim = bo_l_sb < npart_l ? bo_l_sb : npart_l;\n            while (b < b_lim) {\n                // iff failed, it may indicate some index error elsewhere\n                enn += eb[b];\n                thmm += thr[b];\n                b++;\n            }\n            gfc.en[chn].l[sb] = enn;\n            gfc.thm[chn].l[sb] = thmm;\n\n            if (b >= npart_l) {\n                ++sb;\n                break;\n            }\n            {\n                /* at transition sfb . sfb+1 */\n                var w_curr = gfc.PSY.bo_l_weight[sb];\n                var w_next = 1.0 - w_curr;\n                enn = w_curr * eb[b];\n                thmm = w_curr * thr[b];\n                gfc.en[chn].l[sb] += enn;\n                gfc.thm[chn].l[sb] += thmm;\n                enn = w_next * eb[b];\n                thmm = w_next * thr[b];\n            }\n        }\n        /* zero initialize the rest */\n        for (; sb < Encoder.SBMAX_l; ++sb) {\n            gfc.en[chn].l[sb] = 0;\n            gfc.thm[chn].l[sb] = 0;\n        }\n    }\n\n    function compute_masking_s(gfp, fftenergy_s, eb, thr, chn, sblock) {\n        var gfc = gfp.internal_flags;\n        var j, b;\n\n        for (b = j = 0; b < gfc.npart_s; ++b) {\n            var ebb = 0, m = 0;\n            var n = gfc.numlines_s[b];\n            for (var i = 0; i < n; ++i, ++j) {\n                var el = fftenergy_s[sblock][j];\n                ebb += el;\n                if (m < el)\n                    m = el;\n            }\n            eb[b] = ebb;\n        }\n        for (j = b = 0; b < gfc.npart_s; b++) {\n            var kk = gfc.s3ind_s[b][0];\n            var ecb = gfc.s3_ss[j++] * eb[kk];\n            ++kk;\n            while (kk <= gfc.s3ind_s[b][1]) {\n                ecb += gfc.s3_ss[j] * eb[kk];\n                ++j;\n                ++kk;\n            }\n\n            { /* limit calculated threshold by previous granule */\n                var x = rpelev_s * gfc.nb_s1[chn][b];\n                thr[b] = Math.min(ecb, x);\n            }\n            if (gfc.blocktype_old[chn & 1] == Encoder.SHORT_TYPE) {\n                /* limit calculated threshold by even older granule */\n                var x = rpelev2_s * gfc.nb_s2[chn][b];\n                var y = thr[b];\n                thr[b] = Math.min(x, y);\n            }\n\n            gfc.nb_s2[chn][b] = gfc.nb_s1[chn][b];\n            gfc.nb_s1[chn][b] = ecb;\n        }\n        for (; b <= Encoder.CBANDS; ++b) {\n            eb[b] = 0;\n            thr[b] = 0;\n        }\n    }\n\n    function block_type_set(gfp, uselongblock, blocktype_d, blocktype) {\n        var gfc = gfp.internal_flags;\n\n        if (gfp.short_blocks == ShortBlock.short_block_coupled\n                /* force both channels to use the same block type */\n                /* this is necessary if the frame is to be encoded in ms_stereo. */\n                /* But even without ms_stereo, FhG does this */\n            && !(uselongblock[0] != 0 && uselongblock[1] != 0))\n            uselongblock[0] = uselongblock[1] = 0;\n\n        /*\n         * update the blocktype of the previous granule, since it depends on\n         * what happend in this granule\n         */\n        for (var chn = 0; chn < gfc.channels_out; chn++) {\n            blocktype[chn] = Encoder.NORM_TYPE;\n            /* disable short blocks */\n            if (gfp.short_blocks == ShortBlock.short_block_dispensed)\n                uselongblock[chn] = 1;\n            if (gfp.short_blocks == ShortBlock.short_block_forced)\n                uselongblock[chn] = 0;\n\n            if (uselongblock[chn] != 0) {\n                /* no attack : use long blocks */\n                if (gfc.blocktype_old[chn] == Encoder.SHORT_TYPE)\n                    blocktype[chn] = Encoder.STOP_TYPE;\n            } else {\n                /* attack : use short blocks */\n                blocktype[chn] = Encoder.SHORT_TYPE;\n                if (gfc.blocktype_old[chn] == Encoder.NORM_TYPE) {\n                    gfc.blocktype_old[chn] = Encoder.START_TYPE;\n                }\n                if (gfc.blocktype_old[chn] == Encoder.STOP_TYPE)\n                    gfc.blocktype_old[chn] = Encoder.SHORT_TYPE;\n            }\n\n            blocktype_d[chn] = gfc.blocktype_old[chn];\n            // value returned to calling program\n            gfc.blocktype_old[chn] = blocktype[chn];\n            // save for next call to l3psy_anal\n        }\n    }\n\n    function NS_INTERP(x, y, r) {\n        /* was pow((x),(r))*pow((y),1-(r)) */\n        if (r >= 1.0) {\n            /* 99.7% of the time */\n            return x;\n        }\n        if (r <= 0.0)\n            return y;\n        if (y > 0.0) {\n            /* rest of the time */\n            return (Math.pow(x / y, r) * y);\n        }\n        /* never happens */\n        return 0.0;\n    }\n\n    /**\n     * these values are tuned only for 44.1kHz...\n     */\n    var regcoef_s = [11.8, 13.6, 17.2, 32, 46.5,\n        51.3, 57.5, 67.1, 71.5, 84.6, 97.6, 130,\n        /* 255.8 */\n    ];\n\n    function pecalc_s(mr, masking_lower) {\n        var pe_s = 1236.28 / 4;\n        for (var sb = 0; sb < Encoder.SBMAX_s - 1; sb++) {\n            for (var sblock = 0; sblock < 3; sblock++) {\n                var thm = mr.thm.s[sb][sblock];\n                if (thm > 0.0) {\n                    var x = thm * masking_lower;\n                    var en = mr.en.s[sb][sblock];\n                    if (en > x) {\n                        if (en > x * 1e10) {\n                            pe_s += regcoef_s[sb] * (10.0 * LOG10);\n                        } else {\n                            pe_s += regcoef_s[sb] * Util.FAST_LOG10(en / x);\n                        }\n                    }\n                }\n            }\n        }\n\n        return pe_s;\n    }\n\n    /**\n     * these values are tuned only for 44.1kHz...\n     */\n    var regcoef_l = [6.8, 5.8, 5.8, 6.4, 6.5, 9.9,\n        12.1, 14.4, 15, 18.9, 21.6, 26.9, 34.2, 40.2, 46.8, 56.5,\n        60.7, 73.9, 85.7, 93.4, 126.1,\n        /* 241.3 */\n    ];\n\n    function pecalc_l(mr, masking_lower) {\n        var pe_l = 1124.23 / 4;\n        for (var sb = 0; sb < Encoder.SBMAX_l - 1; sb++) {\n            var thm = mr.thm.l[sb];\n            if (thm > 0.0) {\n                var x = thm * masking_lower;\n                var en = mr.en.l[sb];\n                if (en > x) {\n                    if (en > x * 1e10) {\n                        pe_l += regcoef_l[sb] * (10.0 * LOG10);\n                    } else {\n                        pe_l += regcoef_l[sb] * Util.FAST_LOG10(en / x);\n                    }\n                }\n            }\n        }\n        return pe_l;\n    }\n\n    function calc_energy(gfc, fftenergy, eb, max, avg) {\n        var b, j;\n\n        for (b = j = 0; b < gfc.npart_l; ++b) {\n            var ebb = 0, m = 0;\n            var i;\n            for (i = 0; i < gfc.numlines_l[b]; ++i, ++j) {\n                var el = fftenergy[j];\n                ebb += el;\n                if (m < el)\n                    m = el;\n            }\n            eb[b] = ebb;\n            max[b] = m;\n            avg[b] = ebb * gfc.rnumlines_l[b];\n        }\n    }\n\n    function calc_mask_index_l(gfc, max, avg, mask_idx) {\n        var last_tab_entry = tab.length - 1;\n        var b = 0;\n        var a = avg[b] + avg[b + 1];\n        if (a > 0.0) {\n            var m = max[b];\n            if (m < max[b + 1])\n                m = max[b + 1];\n            a = 20.0 * (m * 2.0 - a)\n                / (a * (gfc.numlines_l[b] + gfc.numlines_l[b + 1] - 1));\n            var k = 0 | a;\n            if (k > last_tab_entry)\n                k = last_tab_entry;\n            mask_idx[b] = k;\n        } else {\n            mask_idx[b] = 0;\n        }\n\n        for (b = 1; b < gfc.npart_l - 1; b++) {\n            a = avg[b - 1] + avg[b] + avg[b + 1];\n            if (a > 0.0) {\n                var m = max[b - 1];\n                if (m < max[b])\n                    m = max[b];\n                if (m < max[b + 1])\n                    m = max[b + 1];\n                a = 20.0\n                    * (m * 3.0 - a)\n                    / (a * (gfc.numlines_l[b - 1] + gfc.numlines_l[b]\n                    + gfc.numlines_l[b + 1] - 1));\n                var k = 0 | a;\n                if (k > last_tab_entry)\n                    k = last_tab_entry;\n                mask_idx[b] = k;\n            } else {\n                mask_idx[b] = 0;\n            }\n        }\n\n        a = avg[b - 1] + avg[b];\n        if (a > 0.0) {\n            var m = max[b - 1];\n            if (m < max[b])\n                m = max[b];\n            a = 20.0 * (m * 2.0 - a)\n                / (a * (gfc.numlines_l[b - 1] + gfc.numlines_l[b] - 1));\n            var k = 0 | a;\n            if (k > last_tab_entry)\n                k = last_tab_entry;\n            mask_idx[b] = k;\n        } else {\n            mask_idx[b] = 0;\n        }\n    }\n\n    var fircoef = [\n        -8.65163e-18 * 2, -0.00851586 * 2, -6.74764e-18 * 2, 0.0209036 * 2,\n        -3.36639e-17 * 2, -0.0438162 * 2, -1.54175e-17 * 2, 0.0931738 * 2,\n        -5.52212e-17 * 2, -0.313819 * 2\n    ];\n\n    this.L3psycho_anal_ns = function (gfp, buffer, bufPos, gr_out, masking_ratio, masking_MS_ratio, percep_entropy, percep_MS_entropy, energy, blocktype_d) {\n        /*\n         * to get a good cache performance, one has to think about the sequence,\n         * in which the variables are used.\n         */\n        var gfc = gfp.internal_flags;\n\n        /* fft and energy calculation */\n        var wsamp_L = new_float_n([2, Encoder.BLKSIZE]);\n        var wsamp_S = new_float_n([2, 3, Encoder.BLKSIZE_s]);\n\n        /* convolution */\n        var eb_l = new_float(Encoder.CBANDS + 1);\n        var eb_s = new_float(Encoder.CBANDS + 1);\n        var thr = new_float(Encoder.CBANDS + 2);\n\n        /* block type */\n        var blocktype = new_int(2), uselongblock = new_int(2);\n\n        /* usual variables like loop indices, etc.. */\n        var numchn, chn;\n        var b, i, j, k;\n        var sb, sblock;\n\n        /* variables used for --nspsytune */\n        var ns_hpfsmpl = new_float_n([2, 576]);\n        var pcfact;\n        var mask_idx_l = new_int(Encoder.CBANDS + 2), mask_idx_s = new_int(Encoder.CBANDS + 2);\n\n        Arrays.fill(mask_idx_s, 0);\n\n        numchn = gfc.channels_out;\n        /* chn=2 and 3 = Mid and Side channels */\n        if (gfp.mode == MPEGMode.JOINT_STEREO)\n            numchn = 4;\n\n        if (gfp.VBR == VbrMode.vbr_off)\n            pcfact = gfc.ResvMax == 0 ? 0 : ( gfc.ResvSize)\n            / gfc.ResvMax * 0.5;\n        else if (gfp.VBR == VbrMode.vbr_rh || gfp.VBR == VbrMode.vbr_mtrh\n            || gfp.VBR == VbrMode.vbr_mt) {\n            pcfact = 0.6;\n        } else\n            pcfact = 1.0;\n\n        /**********************************************************************\n         * Apply HPF of fs/4 to the input signal. This is used for attack\n         * detection / handling.\n         **********************************************************************/\n        /* Don't copy the input buffer into a temporary buffer */\n        /* unroll the loop 2 times */\n        for (chn = 0; chn < gfc.channels_out; chn++) {\n            /* apply high pass filter of fs/4 */\n            var firbuf = buffer[chn];\n            var firbufPos = bufPos + 576 - 350 - NSFIRLEN + 192;\n            for (i = 0; i < 576; i++) {\n                var sum1, sum2;\n                sum1 = firbuf[firbufPos + i + 10];\n                sum2 = 0.0;\n                for (j = 0; j < ((NSFIRLEN - 1) / 2) - 1; j += 2) {\n                    sum1 += fircoef[j]\n                        * (firbuf[firbufPos + i + j] + firbuf[firbufPos + i\n                        + NSFIRLEN - j]);\n                    sum2 += fircoef[j + 1]\n                        * (firbuf[firbufPos + i + j + 1] + firbuf[firbufPos\n                        + i + NSFIRLEN - j - 1]);\n                }\n                ns_hpfsmpl[chn][i] = sum1 + sum2;\n            }\n            masking_ratio[gr_out][chn].en.assign(gfc.en[chn]);\n            masking_ratio[gr_out][chn].thm.assign(gfc.thm[chn]);\n            if (numchn > 2) {\n                /* MS maskings */\n                /* percep_MS_entropy [chn-2] = gfc . pe [chn]; */\n                masking_MS_ratio[gr_out][chn].en.assign(gfc.en[chn + 2]);\n                masking_MS_ratio[gr_out][chn].thm.assign(gfc.thm[chn + 2]);\n            }\n        }\n\n        for (chn = 0; chn < numchn; chn++) {\n            var wsamp_l;\n            var wsamp_s;\n            var en_subshort = new_float(12);\n            var en_short = [0, 0, 0, 0];\n            var attack_intensity = new_float(12);\n            var ns_uselongblock = 1;\n            var attackThreshold;\n            var max = new_float(Encoder.CBANDS), avg = new_float(Encoder.CBANDS);\n            var ns_attacks = [0, 0, 0, 0];\n            var fftenergy = new_float(Encoder.HBLKSIZE);\n            var fftenergy_s = new_float_n([3, Encoder.HBLKSIZE_s]);\n\n            /*\n             * rh 20040301: the following loops do access one off the limits so\n             * I increase the array dimensions by one and initialize the\n             * accessed values to zero\n             */\n\n            /***************************************************************\n             * determine the block type (window type)\n             ***************************************************************/\n            /* calculate energies of each sub-shortblocks */\n            for (i = 0; i < 3; i++) {\n                en_subshort[i] = gfc.nsPsy.last_en_subshort[chn][i + 6];\n                attack_intensity[i] = en_subshort[i]\n                    / gfc.nsPsy.last_en_subshort[chn][i + 4];\n                en_short[0] += en_subshort[i];\n            }\n\n            if (chn == 2) {\n                for (i = 0; i < 576; i++) {\n                    var l, r;\n                    l = ns_hpfsmpl[0][i];\n                    r = ns_hpfsmpl[1][i];\n                    ns_hpfsmpl[0][i] = l + r;\n                    ns_hpfsmpl[1][i] = l - r;\n                }\n            }\n            {\n                var pf = ns_hpfsmpl[chn & 1];\n                var pfPos = 0;\n                for (i = 0; i < 9; i++) {\n                    var pfe = pfPos + 576 / 9;\n                    var p = 1.;\n                    for (; pfPos < pfe; pfPos++)\n                        if (p < Math.abs(pf[pfPos]))\n                            p = Math.abs(pf[pfPos]);\n\n                    gfc.nsPsy.last_en_subshort[chn][i] = en_subshort[i + 3] = p;\n                    en_short[1 + i / 3] += p;\n                    if (p > en_subshort[i + 3 - 2]) {\n                        p = p / en_subshort[i + 3 - 2];\n                    } else if (en_subshort[i + 3 - 2] > p * 10.0) {\n                        p = en_subshort[i + 3 - 2] / (p * 10.0);\n                    } else\n                        p = 0.0;\n                    attack_intensity[i + 3] = p;\n                }\n            }\n\n            if (gfp.analysis) {\n                var x = attack_intensity[0];\n                for (i = 1; i < 12; i++)\n                    if (x < attack_intensity[i])\n                        x = attack_intensity[i];\n                gfc.pinfo.ers[gr_out][chn] = gfc.pinfo.ers_save[chn];\n                gfc.pinfo.ers_save[chn] = x;\n            }\n\n            /* compare energies between sub-shortblocks */\n            attackThreshold = (chn == 3) ? gfc.nsPsy.attackthre_s\n                : gfc.nsPsy.attackthre;\n            for (i = 0; i < 12; i++)\n                if (0 == ns_attacks[i / 3]\n                    && attack_intensity[i] > attackThreshold)\n                    ns_attacks[i / 3] = (i % 3) + 1;\n\n            /*\n             * should have energy change between short blocks, in order to avoid\n             * periodic signals\n             */\n            for (i = 1; i < 4; i++) {\n                var ratio;\n                if (en_short[i - 1] > en_short[i]) {\n                    ratio = en_short[i - 1] / en_short[i];\n                } else {\n                    ratio = en_short[i] / en_short[i - 1];\n                }\n                if (ratio < 1.7) {\n                    ns_attacks[i] = 0;\n                    if (i == 1)\n                        ns_attacks[0] = 0;\n                }\n            }\n\n            if (ns_attacks[0] != 0 && gfc.nsPsy.lastAttacks[chn] != 0)\n                ns_attacks[0] = 0;\n\n            if (gfc.nsPsy.lastAttacks[chn] == 3\n                || (ns_attacks[0] + ns_attacks[1] + ns_attacks[2] + ns_attacks[3]) != 0) {\n                ns_uselongblock = 0;\n\n                if (ns_attacks[1] != 0 && ns_attacks[0] != 0)\n                    ns_attacks[1] = 0;\n                if (ns_attacks[2] != 0 && ns_attacks[1] != 0)\n                    ns_attacks[2] = 0;\n                if (ns_attacks[3] != 0 && ns_attacks[2] != 0)\n                    ns_attacks[3] = 0;\n            }\n\n            if (chn < 2) {\n                uselongblock[chn] = ns_uselongblock;\n            } else {\n                if (ns_uselongblock == 0) {\n                    uselongblock[0] = uselongblock[1] = 0;\n                }\n            }\n\n            /*\n             * there is a one granule delay. Copy maskings computed last call\n             * into masking_ratio to return to calling program.\n             */\n            energy[chn] = gfc.tot_ener[chn];\n\n            /*********************************************************************\n             * compute FFTs\n             *********************************************************************/\n            wsamp_s = wsamp_S;\n            wsamp_l = wsamp_L;\n            compute_ffts(gfp, fftenergy, fftenergy_s, wsamp_l, (chn & 1),\n                wsamp_s, (chn & 1), gr_out, chn, buffer, bufPos);\n\n            /*********************************************************************\n             * Calculate the energy and the tonality of each partition.\n             *********************************************************************/\n            calc_energy(gfc, fftenergy, eb_l, max, avg);\n            calc_mask_index_l(gfc, max, avg, mask_idx_l);\n            /* compute masking thresholds for short blocks */\n            for (sblock = 0; sblock < 3; sblock++) {\n                var enn, thmm;\n                compute_masking_s(gfp, fftenergy_s, eb_s, thr, chn, sblock);\n                convert_partition2scalefac_s(gfc, eb_s, thr, chn, sblock);\n                /**** short block pre-echo control ****/\n                for (sb = 0; sb < Encoder.SBMAX_s; sb++) {\n                    thmm = gfc.thm[chn].s[sb][sblock];\n\n                    thmm *= NS_PREECHO_ATT0;\n                    if (ns_attacks[sblock] >= 2 || ns_attacks[sblock + 1] == 1) {\n                        var idx = (sblock != 0) ? sblock - 1 : 2;\n                        var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                            NS_PREECHO_ATT1 * pcfact);\n                        thmm = Math.min(thmm, p);\n                    }\n\n                    if (ns_attacks[sblock] == 1) {\n                        var idx = (sblock != 0) ? sblock - 1 : 2;\n                        var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                            NS_PREECHO_ATT2 * pcfact);\n                        thmm = Math.min(thmm, p);\n                    } else if ((sblock != 0 && ns_attacks[sblock - 1] == 3)\n                        || (sblock == 0 && gfc.nsPsy.lastAttacks[chn] == 3)) {\n                        var idx = (sblock != 2) ? sblock + 1 : 0;\n                        var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                            NS_PREECHO_ATT2 * pcfact);\n                        thmm = Math.min(thmm, p);\n                    }\n\n                    /* pulse like signal detection for fatboy.wav and so on */\n                    enn = en_subshort[sblock * 3 + 3]\n                        + en_subshort[sblock * 3 + 4]\n                        + en_subshort[sblock * 3 + 5];\n                    if (en_subshort[sblock * 3 + 5] * 6 < enn) {\n                        thmm *= 0.5;\n                        if (en_subshort[sblock * 3 + 4] * 6 < enn)\n                            thmm *= 0.5;\n                    }\n\n                    gfc.thm[chn].s[sb][sblock] = thmm;\n                }\n            }\n            gfc.nsPsy.lastAttacks[chn] = ns_attacks[2];\n\n            /*********************************************************************\n             * convolve the partitioned energy and unpredictability with the\n             * spreading function, s3_l[b][k]\n             ********************************************************************/\n            k = 0;\n            {\n                for (b = 0; b < gfc.npart_l; b++) {\n                    /*\n                     * convolve the partitioned energy with the spreading\n                     * function\n                     */\n                    var kk = gfc.s3ind[b][0];\n                    var eb2 = eb_l[kk] * tab[mask_idx_l[kk]];\n                    var ecb = gfc.s3_ll[k++] * eb2;\n                    while (++kk <= gfc.s3ind[b][1]) {\n                        eb2 = eb_l[kk] * tab[mask_idx_l[kk]];\n                        ecb = mask_add(ecb, gfc.s3_ll[k++] * eb2, kk, kk - b,\n                            gfc, 0);\n                    }\n                    ecb *= 0.158489319246111;\n                    /* pow(10,-0.8) */\n\n                    /**** long block pre-echo control ****/\n                    /**\n                     * <PRE>\n                     * dont use long block pre-echo control if previous granule was\n                     * a short block.  This is to avoid the situation:\n                     * frame0:  quiet (very low masking)\n                     * frame1:  surge  (triggers short blocks)\n                     * frame2:  regular frame.  looks like pre-echo when compared to\n                     *          frame0, but all pre-echo was in frame1.\n                     * </PRE>\n                     */\n                    /*\n                     * chn=0,1 L and R channels\n                     *\n                     * chn=2,3 S and M channels.\n                     */\n\n                    if (gfc.blocktype_old[chn & 1] == Encoder.SHORT_TYPE)\n                        thr[b] = ecb;\n                    else\n                        thr[b] = NS_INTERP(\n                            Math.min(ecb, Math.min(rpelev\n                                * gfc.nb_1[chn][b], rpelev2\n                                * gfc.nb_2[chn][b])), ecb, pcfact);\n\n                    gfc.nb_2[chn][b] = gfc.nb_1[chn][b];\n                    gfc.nb_1[chn][b] = ecb;\n                }\n            }\n            for (; b <= Encoder.CBANDS; ++b) {\n                eb_l[b] = 0;\n                thr[b] = 0;\n            }\n            /* compute masking thresholds for long blocks */\n            convert_partition2scalefac_l(gfc, eb_l, thr, chn);\n        }\n        /* end loop over chn */\n\n        if (gfp.mode == MPEGMode.STEREO || gfp.mode == MPEGMode.JOINT_STEREO) {\n            if (gfp.interChRatio > 0.0) {\n                calc_interchannel_masking(gfp, gfp.interChRatio);\n            }\n        }\n\n        if (gfp.mode == MPEGMode.JOINT_STEREO) {\n            var msfix;\n            msfix1(gfc);\n            msfix = gfp.msfix;\n            if (Math.abs(msfix) > 0.0)\n                ns_msfix(gfc, msfix, gfp.ATHlower * gfc.ATH.adjust);\n        }\n\n        /***************************************************************\n         * determine final block type\n         ***************************************************************/\n        block_type_set(gfp, uselongblock, blocktype_d, blocktype);\n\n        /*********************************************************************\n         * compute the value of PE to return ... no delay and advance\n         *********************************************************************/\n        for (chn = 0; chn < numchn; chn++) {\n            var ppe;\n            var ppePos = 0;\n            var type;\n            var mr;\n\n            if (chn > 1) {\n                ppe = percep_MS_entropy;\n                ppePos = -2;\n                type = Encoder.NORM_TYPE;\n                if (blocktype_d[0] == Encoder.SHORT_TYPE\n                    || blocktype_d[1] == Encoder.SHORT_TYPE)\n                    type = Encoder.SHORT_TYPE;\n                mr = masking_MS_ratio[gr_out][chn - 2];\n            } else {\n                ppe = percep_entropy;\n                ppePos = 0;\n                type = blocktype_d[chn];\n                mr = masking_ratio[gr_out][chn];\n            }\n\n            if (type == Encoder.SHORT_TYPE)\n                ppe[ppePos + chn] = pecalc_s(mr, gfc.masking_lower);\n            else\n                ppe[ppePos + chn] = pecalc_l(mr, gfc.masking_lower);\n\n            if (gfp.analysis)\n                gfc.pinfo.pe[gr_out][chn] = ppe[ppePos + chn];\n\n        }\n        return 0;\n    }\n\n    function vbrpsy_compute_fft_l(gfp, buffer, bufPos, chn, gr_out, fftenergy, wsamp_l, wsamp_lPos) {\n        var gfc = gfp.internal_flags;\n        if (chn < 2) {\n            fft.fft_long(gfc, wsamp_l[wsamp_lPos], chn, buffer, bufPos);\n        } else if (chn == 2) {\n            /* FFT data for mid and side channel is derived from L & R */\n            for (var j = Encoder.BLKSIZE - 1; j >= 0; --j) {\n                var l = wsamp_l[wsamp_lPos + 0][j];\n                var r = wsamp_l[wsamp_lPos + 1][j];\n                wsamp_l[wsamp_lPos + 0][j] = (l + r) * Util.SQRT2 * 0.5;\n                wsamp_l[wsamp_lPos + 1][j] = (l - r) * Util.SQRT2 * 0.5;\n            }\n        }\n\n        /*********************************************************************\n         * compute energies\n         *********************************************************************/\n        fftenergy[0] = NON_LINEAR_SCALE_ENERGY(wsamp_l[wsamp_lPos + 0][0]);\n        fftenergy[0] *= fftenergy[0];\n\n        for (var j = Encoder.BLKSIZE / 2 - 1; j >= 0; --j) {\n            var re = wsamp_l[wsamp_lPos + 0][Encoder.BLKSIZE / 2 - j];\n            var im = wsamp_l[wsamp_lPos + 0][Encoder.BLKSIZE / 2 + j];\n            fftenergy[Encoder.BLKSIZE / 2 - j] = NON_LINEAR_SCALE_ENERGY((re\n                * re + im * im) * 0.5);\n        }\n        /* total energy */\n        {\n            var totalenergy = 0.0;\n            for (var j = 11; j < Encoder.HBLKSIZE; j++)\n                totalenergy += fftenergy[j];\n\n            gfc.tot_ener[chn] = totalenergy;\n        }\n\n        if (gfp.analysis) {\n            for (var j = 0; j < Encoder.HBLKSIZE; j++) {\n                gfc.pinfo.energy[gr_out][chn][j] = gfc.pinfo.energy_save[chn][j];\n                gfc.pinfo.energy_save[chn][j] = fftenergy[j];\n            }\n            gfc.pinfo.pe[gr_out][chn] = gfc.pe[chn];\n        }\n    }\n\n    function vbrpsy_compute_fft_s(gfp, buffer, bufPos, chn, sblock, fftenergy_s, wsamp_s, wsamp_sPos) {\n        var gfc = gfp.internal_flags;\n\n        if (sblock == 0 && chn < 2) {\n            fft.fft_short(gfc, wsamp_s[wsamp_sPos], chn, buffer, bufPos);\n        }\n        if (chn == 2) {\n            /* FFT data for mid and side channel is derived from L & R */\n            for (var j = Encoder.BLKSIZE_s - 1; j >= 0; --j) {\n                var l = wsamp_s[wsamp_sPos + 0][sblock][j];\n                var r = wsamp_s[wsamp_sPos + 1][sblock][j];\n                wsamp_s[wsamp_sPos + 0][sblock][j] = (l + r) * Util.SQRT2 * 0.5;\n                wsamp_s[wsamp_sPos + 1][sblock][j] = (l - r) * Util.SQRT2 * 0.5;\n            }\n        }\n\n        /*********************************************************************\n         * compute energies\n         *********************************************************************/\n        fftenergy_s[sblock][0] = wsamp_s[wsamp_sPos + 0][sblock][0];\n        fftenergy_s[sblock][0] *= fftenergy_s[sblock][0];\n        for (var j = Encoder.BLKSIZE_s / 2 - 1; j >= 0; --j) {\n            var re = wsamp_s[wsamp_sPos + 0][sblock][Encoder.BLKSIZE_s / 2 - j];\n            var im = wsamp_s[wsamp_sPos + 0][sblock][Encoder.BLKSIZE_s / 2 + j];\n            fftenergy_s[sblock][Encoder.BLKSIZE_s / 2 - j] = NON_LINEAR_SCALE_ENERGY((re\n                * re + im * im) * 0.5);\n        }\n    }\n\n    /**\n     * compute loudness approximation (used for ATH auto-level adjustment)\n     */\n    function vbrpsy_compute_loudness_approximation_l(gfp, gr_out, chn, fftenergy) {\n        var gfc = gfp.internal_flags;\n        if (gfp.athaa_loudapprox == 2 && chn < 2) {\n            // no loudness for mid/side ch\n            gfc.loudness_sq[gr_out][chn] = gfc.loudness_sq_save[chn];\n            gfc.loudness_sq_save[chn] = psycho_loudness_approx(fftenergy, gfc);\n        }\n    }\n\n    var fircoef_ = [-8.65163e-18 * 2,\n        -0.00851586 * 2, -6.74764e-18 * 2, 0.0209036 * 2,\n        -3.36639e-17 * 2, -0.0438162 * 2, -1.54175e-17 * 2,\n        0.0931738 * 2, -5.52212e-17 * 2, -0.313819 * 2];\n\n    /**\n     * Apply HPF of fs/4 to the input signal. This is used for attack detection\n     * / handling.\n     */\n    function vbrpsy_attack_detection(gfp, buffer, bufPos, gr_out, masking_ratio, masking_MS_ratio, energy, sub_short_factor, ns_attacks, uselongblock) {\n        var ns_hpfsmpl = new_float_n([2, 576]);\n        var gfc = gfp.internal_flags;\n        var n_chn_out = gfc.channels_out;\n        /* chn=2 and 3 = Mid and Side channels */\n        var n_chn_psy = (gfp.mode == MPEGMode.JOINT_STEREO) ? 4 : n_chn_out;\n        /* Don't copy the input buffer into a temporary buffer */\n        /* unroll the loop 2 times */\n        for (var chn = 0; chn < n_chn_out; chn++) {\n            /* apply high pass filter of fs/4 */\n            firbuf = buffer[chn];\n            var firbufPos = bufPos + 576 - 350 - NSFIRLEN + 192;\n            for (var i = 0; i < 576; i++) {\n                var sum1, sum2;\n                sum1 = firbuf[firbufPos + i + 10];\n                sum2 = 0.0;\n                for (var j = 0; j < ((NSFIRLEN - 1) / 2) - 1; j += 2) {\n                    sum1 += fircoef_[j]\n                        * (firbuf[firbufPos + i + j] + firbuf[firbufPos + i\n                        + NSFIRLEN - j]);\n                    sum2 += fircoef_[j + 1]\n                        * (firbuf[firbufPos + i + j + 1] + firbuf[firbufPos\n                        + i + NSFIRLEN - j - 1]);\n                }\n                ns_hpfsmpl[chn][i] = sum1 + sum2;\n            }\n            masking_ratio[gr_out][chn].en.assign(gfc.en[chn]);\n            masking_ratio[gr_out][chn].thm.assign(gfc.thm[chn]);\n            if (n_chn_psy > 2) {\n                /* MS maskings */\n                /* percep_MS_entropy [chn-2] = gfc . pe [chn]; */\n                masking_MS_ratio[gr_out][chn].en.assign(gfc.en[chn + 2]);\n                masking_MS_ratio[gr_out][chn].thm.assign(gfc.thm[chn + 2]);\n            }\n        }\n        for (var chn = 0; chn < n_chn_psy; chn++) {\n            var attack_intensity = new_float(12);\n            var en_subshort = new_float(12);\n            var en_short = [0, 0, 0, 0];\n            var pf = ns_hpfsmpl[chn & 1];\n            var pfPos = 0;\n            var attackThreshold = (chn == 3) ? gfc.nsPsy.attackthre_s\n                : gfc.nsPsy.attackthre;\n            var ns_uselongblock = 1;\n\n            if (chn == 2) {\n                for (var i = 0, j = 576; j > 0; ++i, --j) {\n                    var l = ns_hpfsmpl[0][i];\n                    var r = ns_hpfsmpl[1][i];\n                    ns_hpfsmpl[0][i] = l + r;\n                    ns_hpfsmpl[1][i] = l - r;\n                }\n            }\n            /***************************************************************\n             * determine the block type (window type)\n             ***************************************************************/\n            /* calculate energies of each sub-shortblocks */\n            for (var i = 0; i < 3; i++) {\n                en_subshort[i] = gfc.nsPsy.last_en_subshort[chn][i + 6];\n                attack_intensity[i] = en_subshort[i]\n                    / gfc.nsPsy.last_en_subshort[chn][i + 4];\n                en_short[0] += en_subshort[i];\n            }\n\n            for (var i = 0; i < 9; i++) {\n                var pfe = pfPos + 576 / 9;\n                var p = 1.;\n                for (; pfPos < pfe; pfPos++)\n                    if (p < Math.abs(pf[pfPos]))\n                        p = Math.abs(pf[pfPos]);\n\n                gfc.nsPsy.last_en_subshort[chn][i] = en_subshort[i + 3] = p;\n                en_short[1 + i / 3] += p;\n                if (p > en_subshort[i + 3 - 2]) {\n                    p = p / en_subshort[i + 3 - 2];\n                } else if (en_subshort[i + 3 - 2] > p * 10.0) {\n                    p = en_subshort[i + 3 - 2] / (p * 10.0);\n                } else {\n                    p = 0.0;\n                }\n                attack_intensity[i + 3] = p;\n            }\n            /* pulse like signal detection for fatboy.wav and so on */\n            for (var i = 0; i < 3; ++i) {\n                var enn = en_subshort[i * 3 + 3]\n                    + en_subshort[i * 3 + 4] + en_subshort[i * 3 + 5];\n                var factor = 1.;\n                if (en_subshort[i * 3 + 5] * 6 < enn) {\n                    factor *= 0.5;\n                    if (en_subshort[i * 3 + 4] * 6 < enn) {\n                        factor *= 0.5;\n                    }\n                }\n                sub_short_factor[chn][i] = factor;\n            }\n\n            if (gfp.analysis) {\n                var x = attack_intensity[0];\n                for (var i = 1; i < 12; i++) {\n                    if (x < attack_intensity[i]) {\n                        x = attack_intensity[i];\n                    }\n                }\n                gfc.pinfo.ers[gr_out][chn] = gfc.pinfo.ers_save[chn];\n                gfc.pinfo.ers_save[chn] = x;\n            }\n\n            /* compare energies between sub-shortblocks */\n            for (var i = 0; i < 12; i++) {\n                if (0 == ns_attacks[chn][i / 3]\n                    && attack_intensity[i] > attackThreshold) {\n                    ns_attacks[chn][i / 3] = (i % 3) + 1;\n                }\n            }\n\n            /*\n             * should have energy change between short blocks, in order to avoid\n             * periodic signals\n             */\n            /* Good samples to show the effect are Trumpet test songs */\n            /*\n             * GB: tuned (1) to avoid too many short blocks for test sample\n             * TRUMPET\n             */\n            /*\n             * RH: tuned (2) to let enough short blocks through for test sample\n             * FSOL and SNAPS\n             */\n            for (var i = 1; i < 4; i++) {\n                var u = en_short[i - 1];\n                var v = en_short[i];\n                var m = Math.max(u, v);\n                if (m < 40000) { /* (2) */\n                    if (u < 1.7 * v && v < 1.7 * u) { /* (1) */\n                        if (i == 1 && ns_attacks[chn][0] <= ns_attacks[chn][i]) {\n                            ns_attacks[chn][0] = 0;\n                        }\n                        ns_attacks[chn][i] = 0;\n                    }\n                }\n            }\n\n            if (ns_attacks[chn][0] <= gfc.nsPsy.lastAttacks[chn]) {\n                ns_attacks[chn][0] = 0;\n            }\n\n            if (gfc.nsPsy.lastAttacks[chn] == 3\n                || (ns_attacks[chn][0] + ns_attacks[chn][1]\n                + ns_attacks[chn][2] + ns_attacks[chn][3]) != 0) {\n                ns_uselongblock = 0;\n\n                if (ns_attacks[chn][1] != 0 && ns_attacks[chn][0] != 0) {\n                    ns_attacks[chn][1] = 0;\n                }\n                if (ns_attacks[chn][2] != 0 && ns_attacks[chn][1] != 0) {\n                    ns_attacks[chn][2] = 0;\n                }\n                if (ns_attacks[chn][3] != 0 && ns_attacks[chn][2] != 0) {\n                    ns_attacks[chn][3] = 0;\n                }\n            }\n            if (chn < 2) {\n                uselongblock[chn] = ns_uselongblock;\n            } else {\n                if (ns_uselongblock == 0) {\n                    uselongblock[0] = uselongblock[1] = 0;\n                }\n            }\n\n            /*\n             * there is a one granule delay. Copy maskings computed last call\n             * into masking_ratio to return to calling program.\n             */\n            energy[chn] = gfc.tot_ener[chn];\n        }\n    }\n\n    function vbrpsy_skip_masking_s(gfc, chn, sblock) {\n        if (sblock == 0) {\n            for (var b = 0; b < gfc.npart_s; b++) {\n                gfc.nb_s2[chn][b] = gfc.nb_s1[chn][b];\n                gfc.nb_s1[chn][b] = 0;\n            }\n        }\n    }\n\n    function vbrpsy_skip_masking_l(gfc, chn) {\n        for (var b = 0; b < gfc.npart_l; b++) {\n            gfc.nb_2[chn][b] = gfc.nb_1[chn][b];\n            gfc.nb_1[chn][b] = 0;\n        }\n    }\n\n    function psyvbr_calc_mask_index_s(gfc, max, avg, mask_idx) {\n        var last_tab_entry = tab.length - 1;\n        var b = 0;\n        var a = avg[b] + avg[b + 1];\n        if (a > 0.0) {\n            var m = max[b];\n            if (m < max[b + 1])\n                m = max[b + 1];\n            a = 20.0 * (m * 2.0 - a)\n                / (a * (gfc.numlines_s[b] + gfc.numlines_s[b + 1] - 1));\n            var k = 0 | a;\n            if (k > last_tab_entry)\n                k = last_tab_entry;\n            mask_idx[b] = k;\n        } else {\n            mask_idx[b] = 0;\n        }\n\n        for (b = 1; b < gfc.npart_s - 1; b++) {\n            a = avg[b - 1] + avg[b] + avg[b + 1];\n            if (a > 0.0) {\n                var m = max[b - 1];\n                if (m < max[b])\n                    m = max[b];\n                if (m < max[b + 1])\n                    m = max[b + 1];\n                a = 20.0\n                    * (m * 3.0 - a)\n                    / (a * (gfc.numlines_s[b - 1] + gfc.numlines_s[b]\n                    + gfc.numlines_s[b + 1] - 1));\n                var k = 0 | a;\n                if (k > last_tab_entry)\n                    k = last_tab_entry;\n                mask_idx[b] = k;\n            } else {\n                mask_idx[b] = 0;\n            }\n        }\n\n        a = avg[b - 1] + avg[b];\n        if (a > 0.0) {\n            var m = max[b - 1];\n            if (m < max[b])\n                m = max[b];\n            a = 20.0 * (m * 2.0 - a)\n                / (a * (gfc.numlines_s[b - 1] + gfc.numlines_s[b] - 1));\n            var k = 0 | a;\n            if (k > last_tab_entry)\n                k = last_tab_entry;\n            mask_idx[b] = k;\n        } else {\n            mask_idx[b] = 0;\n        }\n    }\n\n    function vbrpsy_compute_masking_s(gfp, fftenergy_s, eb, thr, chn, sblock) {\n        var gfc = gfp.internal_flags;\n        var max = new float[Encoder.CBANDS], avg = new_float(Encoder.CBANDS);\n        var i, j, b;\n        var mask_idx_s = new int[Encoder.CBANDS];\n\n        for (b = j = 0; b < gfc.npart_s; ++b) {\n            var ebb = 0, m = 0;\n            var n = gfc.numlines_s[b];\n            for (i = 0; i < n; ++i, ++j) {\n                var el = fftenergy_s[sblock][j];\n                ebb += el;\n                if (m < el)\n                    m = el;\n            }\n            eb[b] = ebb;\n            max[b] = m;\n            avg[b] = ebb / n;\n        }\n        for (; b < Encoder.CBANDS; ++b) {\n            max[b] = 0;\n            avg[b] = 0;\n        }\n        psyvbr_calc_mask_index_s(gfc, max, avg, mask_idx_s);\n        for (j = b = 0; b < gfc.npart_s; b++) {\n            var kk = gfc.s3ind_s[b][0];\n            var last = gfc.s3ind_s[b][1];\n            var dd, dd_n;\n            var x, ecb, avg_mask;\n            dd = mask_idx_s[kk];\n            dd_n = 1;\n            ecb = gfc.s3_ss[j] * eb[kk] * tab[mask_idx_s[kk]];\n            ++j;\n            ++kk;\n            while (kk <= last) {\n                dd += mask_idx_s[kk];\n                dd_n += 1;\n                x = gfc.s3_ss[j] * eb[kk] * tab[mask_idx_s[kk]];\n                ecb = vbrpsy_mask_add(ecb, x, kk - b);\n                ++j;\n                ++kk;\n            }\n            dd = (1 + 2 * dd) / (2 * dd_n);\n            avg_mask = tab[dd] * 0.5;\n            ecb *= avg_mask;\n            thr[b] = ecb;\n            gfc.nb_s2[chn][b] = gfc.nb_s1[chn][b];\n            gfc.nb_s1[chn][b] = ecb;\n            {\n                /*\n                 * if THR exceeds EB, the quantization routines will take the\n                 * difference from other bands. in case of strong tonal samples\n                 * (tonaltest.wav) this leads to heavy distortions. that's why\n                 * we limit THR here.\n                 */\n                x = max[b];\n                x *= gfc.minval_s[b];\n                x *= avg_mask;\n                if (thr[b] > x) {\n                    thr[b] = x;\n                }\n            }\n            if (gfc.masking_lower > 1) {\n                thr[b] *= gfc.masking_lower;\n            }\n            if (thr[b] > eb[b]) {\n                thr[b] = eb[b];\n            }\n            if (gfc.masking_lower < 1) {\n                thr[b] *= gfc.masking_lower;\n            }\n\n        }\n        for (; b < Encoder.CBANDS; ++b) {\n            eb[b] = 0;\n            thr[b] = 0;\n        }\n    }\n\n    function vbrpsy_compute_masking_l(gfc, fftenergy, eb_l, thr, chn) {\n        var max = new_float(Encoder.CBANDS), avg = new_float(Encoder.CBANDS);\n        var mask_idx_l = new_int(Encoder.CBANDS + 2);\n        var b;\n\n        /*********************************************************************\n         * Calculate the energy and the tonality of each partition.\n         *********************************************************************/\n        calc_energy(gfc, fftenergy, eb_l, max, avg);\n        calc_mask_index_l(gfc, max, avg, mask_idx_l);\n\n        /*********************************************************************\n         * convolve the partitioned energy and unpredictability with the\n         * spreading function, s3_l[b][k]\n         ********************************************************************/\n        var k = 0;\n        for (b = 0; b < gfc.npart_l; b++) {\n            var x, ecb, avg_mask, t;\n            /* convolve the partitioned energy with the spreading function */\n            var kk = gfc.s3ind[b][0];\n            var last = gfc.s3ind[b][1];\n            var dd = 0, dd_n = 0;\n            dd = mask_idx_l[kk];\n            dd_n += 1;\n            ecb = gfc.s3_ll[k] * eb_l[kk] * tab[mask_idx_l[kk]];\n            ++k;\n            ++kk;\n            while (kk <= last) {\n                dd += mask_idx_l[kk];\n                dd_n += 1;\n                x = gfc.s3_ll[k] * eb_l[kk] * tab[mask_idx_l[kk]];\n                t = vbrpsy_mask_add(ecb, x, kk - b);\n                ecb = t;\n                ++k;\n                ++kk;\n            }\n            dd = (1 + 2 * dd) / (2 * dd_n);\n            avg_mask = tab[dd] * 0.5;\n            ecb *= avg_mask;\n\n            /**** long block pre-echo control ****/\n            /**\n             * <PRE>\n             * dont use long block pre-echo control if previous granule was\n             * a short block.  This is to avoid the situation:\n             * frame0:  quiet (very low masking)\n             * frame1:  surge  (triggers short blocks)\n             * frame2:  regular frame.  looks like pre-echo when compared to\n             *          frame0, but all pre-echo was in frame1.\n             * </PRE>\n             */\n            /*\n             * chn=0,1 L and R channels chn=2,3 S and M channels.\n             */\n            if (gfc.blocktype_old[chn & 0x01] == Encoder.SHORT_TYPE) {\n                var ecb_limit = rpelev * gfc.nb_1[chn][b];\n                if (ecb_limit > 0) {\n                    thr[b] = Math.min(ecb, ecb_limit);\n                } else {\n                    /**\n                     * <PRE>\n                     * Robert 071209:\n                     * Because we don't calculate long block psy when we know a granule\n                     * should be of short blocks, we don't have any clue how the granule\n                     * before would have looked like as a long block. So we have to guess\n                     * a little bit for this END_TYPE block.\n                     * Most of the time we get away with this sloppyness. (fingers crossed :)\n                     * The speed increase is worth it.\n                     * </PRE>\n                     */\n                    thr[b] = Math.min(ecb, eb_l[b] * NS_PREECHO_ATT2);\n                }\n            } else {\n                var ecb_limit_2 = rpelev2 * gfc.nb_2[chn][b];\n                var ecb_limit_1 = rpelev * gfc.nb_1[chn][b];\n                var ecb_limit;\n                if (ecb_limit_2 <= 0) {\n                    ecb_limit_2 = ecb;\n                }\n                if (ecb_limit_1 <= 0) {\n                    ecb_limit_1 = ecb;\n                }\n                if (gfc.blocktype_old[chn & 0x01] == Encoder.NORM_TYPE) {\n                    ecb_limit = Math.min(ecb_limit_1, ecb_limit_2);\n                } else {\n                    ecb_limit = ecb_limit_1;\n                }\n                thr[b] = Math.min(ecb, ecb_limit);\n            }\n            gfc.nb_2[chn][b] = gfc.nb_1[chn][b];\n            gfc.nb_1[chn][b] = ecb;\n            {\n                /*\n                 * if THR exceeds EB, the quantization routines will take the\n                 * difference from other bands. in case of strong tonal samples\n                 * (tonaltest.wav) this leads to heavy distortions. that's why\n                 * we limit THR here.\n                 */\n                x = max[b];\n                x *= gfc.minval_l[b];\n                x *= avg_mask;\n                if (thr[b] > x) {\n                    thr[b] = x;\n                }\n            }\n            if (gfc.masking_lower > 1) {\n                thr[b] *= gfc.masking_lower;\n            }\n            if (thr[b] > eb_l[b]) {\n                thr[b] = eb_l[b];\n            }\n            if (gfc.masking_lower < 1) {\n                thr[b] *= gfc.masking_lower;\n            }\n        }\n        for (; b < Encoder.CBANDS; ++b) {\n            eb_l[b] = 0;\n            thr[b] = 0;\n        }\n    }\n\n    function vbrpsy_compute_block_type(gfp, uselongblock) {\n        var gfc = gfp.internal_flags;\n\n        if (gfp.short_blocks == ShortBlock.short_block_coupled\n                /* force both channels to use the same block type */\n                /* this is necessary if the frame is to be encoded in ms_stereo. */\n                /* But even without ms_stereo, FhG does this */\n            && !(uselongblock[0] != 0 && uselongblock[1] != 0))\n            uselongblock[0] = uselongblock[1] = 0;\n\n        for (var chn = 0; chn < gfc.channels_out; chn++) {\n            /* disable short blocks */\n            if (gfp.short_blocks == ShortBlock.short_block_dispensed) {\n                uselongblock[chn] = 1;\n            }\n            if (gfp.short_blocks == ShortBlock.short_block_forced) {\n                uselongblock[chn] = 0;\n            }\n        }\n    }\n\n    function vbrpsy_apply_block_type(gfp, uselongblock, blocktype_d) {\n        var gfc = gfp.internal_flags;\n\n        /*\n         * update the blocktype of the previous granule, since it depends on\n         * what happend in this granule\n         */\n        for (var chn = 0; chn < gfc.channels_out; chn++) {\n            var blocktype = Encoder.NORM_TYPE;\n            /* disable short blocks */\n\n            if (uselongblock[chn] != 0) {\n                /* no attack : use long blocks */\n                if (gfc.blocktype_old[chn] == Encoder.SHORT_TYPE)\n                    blocktype = Encoder.STOP_TYPE;\n            } else {\n                /* attack : use short blocks */\n                blocktype = Encoder.SHORT_TYPE;\n                if (gfc.blocktype_old[chn] == Encoder.NORM_TYPE) {\n                    gfc.blocktype_old[chn] = Encoder.START_TYPE;\n                }\n                if (gfc.blocktype_old[chn] == Encoder.STOP_TYPE)\n                    gfc.blocktype_old[chn] = Encoder.SHORT_TYPE;\n            }\n\n            blocktype_d[chn] = gfc.blocktype_old[chn];\n            // value returned to calling program\n            gfc.blocktype_old[chn] = blocktype;\n            // save for next call to l3psy_anal\n        }\n    }\n\n    /**\n     * compute M/S thresholds from Johnston & Ferreira 1992 ICASSP paper\n     */\n    function vbrpsy_compute_MS_thresholds(eb, thr, cb_mld, ath_cb, athadjust, msfix, n) {\n        var msfix2 = msfix * 2;\n        var athlower = msfix > 0 ? Math.pow(10, athadjust) : 1;\n        var rside, rmid;\n        for (var b = 0; b < n; ++b) {\n            var ebM = eb[2][b];\n            var ebS = eb[3][b];\n            var thmL = thr[0][b];\n            var thmR = thr[1][b];\n            var thmM = thr[2][b];\n            var thmS = thr[3][b];\n\n            /* use this fix if L & R masking differs by 2db or less */\n            if (thmL <= 1.58 * thmR && thmR <= 1.58 * thmL) {\n                var mld_m = cb_mld[b] * ebS;\n                var mld_s = cb_mld[b] * ebM;\n                rmid = Math.max(thmM, Math.min(thmS, mld_m));\n                rside = Math.max(thmS, Math.min(thmM, mld_s));\n            } else {\n                rmid = thmM;\n                rside = thmS;\n            }\n            if (msfix > 0) {\n                /***************************************************************/\n                /* Adjust M/S maskings if user set \"msfix\" */\n                /***************************************************************/\n                /* Naoki Shibata 2000 */\n                var thmLR, thmMS;\n                var ath = ath_cb[b] * athlower;\n                thmLR = Math.min(Math.max(thmL, ath), Math.max(thmR, ath));\n                thmM = Math.max(rmid, ath);\n                thmS = Math.max(rside, ath);\n                thmMS = thmM + thmS;\n                if (thmMS > 0 && (thmLR * msfix2) < thmMS) {\n                    var f = thmLR * msfix2 / thmMS;\n                    thmM *= f;\n                    thmS *= f;\n                }\n                rmid = Math.min(thmM, rmid);\n                rside = Math.min(thmS, rside);\n            }\n            if (rmid > ebM) {\n                rmid = ebM;\n            }\n            if (rside > ebS) {\n                rside = ebS;\n            }\n            thr[2][b] = rmid;\n            thr[3][b] = rside;\n        }\n    }\n\n    this.L3psycho_anal_vbr = function (gfp, buffer, bufPos, gr_out, masking_ratio, masking_MS_ratio, percep_entropy, percep_MS_entropy, energy, blocktype_d) {\n        var gfc = gfp.internal_flags;\n\n        /* fft and energy calculation */\n        var wsamp_l;\n        var wsamp_s;\n        var fftenergy = new_float(Encoder.HBLKSIZE);\n        var fftenergy_s = new_float_n([3, Encoder.HBLKSIZE_s]);\n        var wsamp_L = new_float_n([2, Encoder.BLKSIZE]);\n        var wsamp_S = new_float_n([2, 3, Encoder.BLKSIZE_s]);\n        var eb = new_float_n([4, Encoder.CBANDS]), thr = new_float_n([4, Encoder.CBANDS]);\n        var sub_short_factor = new_float_n([4, 3]);\n        var pcfact = 0.6;\n\n        /* block type */\n        var ns_attacks = [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0],\n            [0, 0, 0, 0]];\n        var uselongblock = new_int(2);\n\n        /* usual variables like loop indices, etc.. */\n\n        /* chn=2 and 3 = Mid and Side channels */\n        var n_chn_psy = (gfp.mode == MPEGMode.JOINT_STEREO) ? 4\n            : gfc.channels_out;\n\n        vbrpsy_attack_detection(gfp, buffer, bufPos, gr_out, masking_ratio,\n            masking_MS_ratio, energy, sub_short_factor, ns_attacks,\n            uselongblock);\n\n        vbrpsy_compute_block_type(gfp, uselongblock);\n\n        /* LONG BLOCK CASE */\n        {\n            for (var chn = 0; chn < n_chn_psy; chn++) {\n                var ch01 = chn & 0x01;\n                wsamp_l = wsamp_L;\n                vbrpsy_compute_fft_l(gfp, buffer, bufPos, chn, gr_out,\n                    fftenergy, wsamp_l, ch01);\n\n                vbrpsy_compute_loudness_approximation_l(gfp, gr_out, chn,\n                    fftenergy);\n\n                if (uselongblock[ch01] != 0) {\n                    vbrpsy_compute_masking_l(gfc, fftenergy, eb[chn], thr[chn],\n                        chn);\n                } else {\n                    vbrpsy_skip_masking_l(gfc, chn);\n                }\n            }\n            if ((uselongblock[0] + uselongblock[1]) == 2) {\n                /* M/S channel */\n                if (gfp.mode == MPEGMode.JOINT_STEREO) {\n                    vbrpsy_compute_MS_thresholds(eb, thr, gfc.mld_cb_l,\n                        gfc.ATH.cb_l, gfp.ATHlower * gfc.ATH.adjust,\n                        gfp.msfix, gfc.npart_l);\n                }\n            }\n            /* TODO: apply adaptive ATH masking here ?? */\n            for (var chn = 0; chn < n_chn_psy; chn++) {\n                var ch01 = chn & 0x01;\n                if (uselongblock[ch01] != 0) {\n                    convert_partition2scalefac_l(gfc, eb[chn], thr[chn], chn);\n                }\n            }\n        }\n\n        /* SHORT BLOCKS CASE */\n        {\n            for (var sblock = 0; sblock < 3; sblock++) {\n                for (var chn = 0; chn < n_chn_psy; ++chn) {\n                    var ch01 = chn & 0x01;\n\n                    if (uselongblock[ch01] != 0) {\n                        vbrpsy_skip_masking_s(gfc, chn, sblock);\n                    } else {\n                        /* compute masking thresholds for short blocks */\n                        wsamp_s = wsamp_S;\n                        vbrpsy_compute_fft_s(gfp, buffer, bufPos, chn, sblock,\n                            fftenergy_s, wsamp_s, ch01);\n                        vbrpsy_compute_masking_s(gfp, fftenergy_s, eb[chn],\n                            thr[chn], chn, sblock);\n                    }\n                }\n                if ((uselongblock[0] + uselongblock[1]) == 0) {\n                    /* M/S channel */\n                    if (gfp.mode == MPEGMode.JOINT_STEREO) {\n                        vbrpsy_compute_MS_thresholds(eb, thr, gfc.mld_cb_s,\n                            gfc.ATH.cb_s, gfp.ATHlower * gfc.ATH.adjust,\n                            gfp.msfix, gfc.npart_s);\n                    }\n                    /* L/R channel */\n                }\n                /* TODO: apply adaptive ATH masking here ?? */\n                for (var chn = 0; chn < n_chn_psy; ++chn) {\n                    var ch01 = chn & 0x01;\n                    if (0 == uselongblock[ch01]) {\n                        convert_partition2scalefac_s(gfc, eb[chn], thr[chn],\n                            chn, sblock);\n                    }\n                }\n            }\n\n            /**** short block pre-echo control ****/\n            for (var chn = 0; chn < n_chn_psy; chn++) {\n                var ch01 = chn & 0x01;\n\n                if (uselongblock[ch01] != 0) {\n                    continue;\n                }\n                for (var sb = 0; sb < Encoder.SBMAX_s; sb++) {\n                    var new_thmm = new_float(3);\n                    for (var sblock = 0; sblock < 3; sblock++) {\n                        var thmm = gfc.thm[chn].s[sb][sblock];\n                        thmm *= NS_PREECHO_ATT0;\n\n                        if (ns_attacks[chn][sblock] >= 2\n                            || ns_attacks[chn][sblock + 1] == 1) {\n                            var idx = (sblock != 0) ? sblock - 1 : 2;\n                            var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                                NS_PREECHO_ATT1 * pcfact);\n                            thmm = Math.min(thmm, p);\n                        } else if (ns_attacks[chn][sblock] == 1) {\n                            var idx = (sblock != 0) ? sblock - 1 : 2;\n                            var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                                NS_PREECHO_ATT2 * pcfact);\n                            thmm = Math.min(thmm, p);\n                        } else if ((sblock != 0 && ns_attacks[chn][sblock - 1] == 3)\n                            || (sblock == 0 && gfc.nsPsy.lastAttacks[chn] == 3)) {\n                            var idx = (sblock != 2) ? sblock + 1 : 0;\n                            var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                                NS_PREECHO_ATT2 * pcfact);\n                            thmm = Math.min(thmm, p);\n                        }\n\n                        /* pulse like signal detection for fatboy.wav and so on */\n                        thmm *= sub_short_factor[chn][sblock];\n\n                        new_thmm[sblock] = thmm;\n                    }\n                    for (var sblock = 0; sblock < 3; sblock++) {\n                        gfc.thm[chn].s[sb][sblock] = new_thmm[sblock];\n                    }\n                }\n            }\n        }\n        for (var chn = 0; chn < n_chn_psy; chn++) {\n            gfc.nsPsy.lastAttacks[chn] = ns_attacks[chn][2];\n        }\n\n        /***************************************************************\n         * determine final block type\n         ***************************************************************/\n        vbrpsy_apply_block_type(gfp, uselongblock, blocktype_d);\n\n        /*********************************************************************\n         * compute the value of PE to return ... no delay and advance\n         *********************************************************************/\n        for (var chn = 0; chn < n_chn_psy; chn++) {\n            var ppe;\n            var ppePos;\n            var type;\n            var mr;\n\n            if (chn > 1) {\n                ppe = percep_MS_entropy;\n                ppePos = -2;\n                type = Encoder.NORM_TYPE;\n                if (blocktype_d[0] == Encoder.SHORT_TYPE\n                    || blocktype_d[1] == Encoder.SHORT_TYPE)\n                    type = Encoder.SHORT_TYPE;\n                mr = masking_MS_ratio[gr_out][chn - 2];\n            } else {\n                ppe = percep_entropy;\n                ppePos = 0;\n                type = blocktype_d[chn];\n                mr = masking_ratio[gr_out][chn];\n            }\n\n            if (type == Encoder.SHORT_TYPE) {\n                ppe[ppePos + chn] = pecalc_s(mr, gfc.masking_lower);\n            } else {\n                ppe[ppePos + chn] = pecalc_l(mr, gfc.masking_lower);\n            }\n\n            if (gfp.analysis) {\n                gfc.pinfo.pe[gr_out][chn] = ppe[ppePos + chn];\n            }\n        }\n        return 0;\n    }\n\n    function s3_func_x(bark, hf_slope) {\n        var tempx = bark, tempy;\n\n        if (tempx >= 0) {\n            tempy = -tempx * 27;\n        } else {\n            tempy = tempx * hf_slope;\n        }\n        if (tempy <= -72.0) {\n            return 0;\n        }\n        return Math.exp(tempy * LN_TO_LOG10);\n    }\n\n    function norm_s3_func_x(hf_slope) {\n        var lim_a = 0, lim_b = 0;\n        {\n            var x = 0, l, h;\n            for (x = 0; s3_func_x(x, hf_slope) > 1e-20; x -= 1)\n                ;\n            l = x;\n            h = 0;\n            while (Math.abs(h - l) > 1e-12) {\n                x = (h + l) / 2;\n                if (s3_func_x(x, hf_slope) > 0) {\n                    h = x;\n                } else {\n                    l = x;\n                }\n            }\n            lim_a = l;\n        }\n        {\n            var x = 0, l, h;\n            for (x = 0; s3_func_x(x, hf_slope) > 1e-20; x += 1)\n                ;\n            l = 0;\n            h = x;\n            while (Math.abs(h - l) > 1e-12) {\n                x = (h + l) / 2;\n                if (s3_func_x(x, hf_slope) > 0) {\n                    l = x;\n                } else {\n                    h = x;\n                }\n            }\n            lim_b = h;\n        }\n        {\n            var sum = 0;\n            var m = 1000;\n            var i;\n            for (i = 0; i <= m; ++i) {\n                var x = lim_a + i * (lim_b - lim_a) / m;\n                var y = s3_func_x(x, hf_slope);\n                sum += y;\n            }\n            {\n                var norm = (m + 1) / (sum * (lim_b - lim_a));\n                /* printf( \"norm = %lf\\n\",norm); */\n                return norm;\n            }\n        }\n    }\n\n    /**\n     *   The spreading function.  Values returned in units of energy\n     */\n    function s3_func(bark) {\n        var tempx, x, tempy, temp;\n        tempx = bark;\n        if (tempx >= 0)\n            tempx *= 3;\n        else\n            tempx *= 1.5;\n\n        if (tempx >= 0.5 && tempx <= 2.5) {\n            temp = tempx - 0.5;\n            x = 8.0 * (temp * temp - 2.0 * temp);\n        } else\n            x = 0.0;\n        tempx += 0.474;\n        tempy = 15.811389 + 7.5 * tempx - 17.5\n            * Math.sqrt(1.0 + tempx * tempx);\n\n        if (tempy <= -60.0)\n            return 0.0;\n\n        tempx = Math.exp((x + tempy) * LN_TO_LOG10);\n\n        /**\n         * <PRE>\n         * Normalization.  The spreading function should be normalized so that:\n         * +inf\n         * /\n         * |  s3 [ bark ]  d(bark)   =  1\n         * /\n         * -inf\n         * </PRE>\n         */\n        tempx /= .6609193;\n        return tempx;\n    }\n\n    /**\n     * see for example \"Zwicker: Psychoakustik, 1982; ISBN 3-540-11401-7\n     */\n    function freq2bark(freq) {\n        /* input: freq in hz output: barks */\n        if (freq < 0)\n            freq = 0;\n        freq = freq * 0.001;\n        return 13.0 * Math.atan(.76 * freq) + 3.5\n            * Math.atan(freq * freq / (7.5 * 7.5));\n    }\n\n    function init_numline(numlines, bo, bm, bval, bval_width, mld, bo_w, sfreq, blksize, scalepos, deltafreq, sbmax) {\n        var b_frq = new_float(Encoder.CBANDS + 1);\n        var sample_freq_frac = sfreq / (sbmax > 15 ? 2 * 576 : 2 * 192);\n        var partition = new_int(Encoder.HBLKSIZE);\n        var i;\n        sfreq /= blksize;\n        var j = 0;\n        var ni = 0;\n        /* compute numlines, the number of spectral lines in each partition band */\n        /* each partition band should be about DELBARK wide. */\n        for (i = 0; i < Encoder.CBANDS; i++) {\n            var bark1;\n            var j2;\n            bark1 = freq2bark(sfreq * j);\n\n            b_frq[i] = sfreq * j;\n\n            for (j2 = j; freq2bark(sfreq * j2) - bark1 < DELBARK\n            && j2 <= blksize / 2; j2++)\n                ;\n\n            numlines[i] = j2 - j;\n            ni = i + 1;\n\n            while (j < j2) {\n                partition[j++] = i;\n            }\n            if (j > blksize / 2) {\n                j = blksize / 2;\n                ++i;\n                break;\n            }\n        }\n        b_frq[i] = sfreq * j;\n\n        for (var sfb = 0; sfb < sbmax; sfb++) {\n            var i1, i2, start, end;\n            var arg;\n            start = scalepos[sfb];\n            end = scalepos[sfb + 1];\n\n            i1 = 0 | Math.floor(.5 + deltafreq * (start - .5));\n            if (i1 < 0)\n                i1 = 0;\n            i2 = 0 | Math.floor(.5 + deltafreq * (end - .5));\n\n            if (i2 > blksize / 2)\n                i2 = blksize / 2;\n\n            bm[sfb] = (partition[i1] + partition[i2]) / 2;\n            bo[sfb] = partition[i2];\n            var f_tmp = sample_freq_frac * end;\n            /*\n             * calculate how much of this band belongs to current scalefactor\n             * band\n             */\n            bo_w[sfb] = (f_tmp - b_frq[bo[sfb]])\n                / (b_frq[bo[sfb] + 1] - b_frq[bo[sfb]]);\n            if (bo_w[sfb] < 0) {\n                bo_w[sfb] = 0;\n            } else {\n                if (bo_w[sfb] > 1) {\n                    bo_w[sfb] = 1;\n                }\n            }\n            /* setup stereo demasking thresholds */\n            /* formula reverse enginerred from plot in paper */\n            arg = freq2bark(sfreq * scalepos[sfb] * deltafreq);\n            arg = ( Math.min(arg, 15.5) / 15.5);\n\n            mld[sfb] = Math.pow(10.0,\n                1.25 * (1 - Math.cos(Math.PI * arg)) - 2.5);\n        }\n\n        /* compute bark values of each critical band */\n        j = 0;\n        for (var k = 0; k < ni; k++) {\n            var w = numlines[k];\n            var bark1, bark2;\n\n            bark1 = freq2bark(sfreq * (j));\n            bark2 = freq2bark(sfreq * (j + w - 1));\n            bval[k] = .5 * (bark1 + bark2);\n\n            bark1 = freq2bark(sfreq * (j - .5));\n            bark2 = freq2bark(sfreq * (j + w - .5));\n            bval_width[k] = bark2 - bark1;\n            j += w;\n        }\n\n        return ni;\n    }\n\n    function init_s3_values(s3ind, npart, bval, bval_width, norm, use_old_s3) {\n        var s3 = new_float_n([Encoder.CBANDS, Encoder.CBANDS]);\n        /*\n         * The s3 array is not linear in the bark scale.\n         *\n         * bval[x] should be used to get the bark value.\n         */\n        var j;\n        var numberOfNoneZero = 0;\n\n        /**\n         * <PRE>\n         * s[i][j], the value of the spreading function,\n         * centered at band j (masker), for band i (maskee)\n         *\n         * i.e.: sum over j to spread into signal barkval=i\n         * NOTE: i and j are used opposite as in the ISO docs\n         * </PRE>\n         */\n        if (use_old_s3) {\n            for (var i = 0; i < npart; i++) {\n                for (j = 0; j < npart; j++) {\n                    var v = s3_func(bval[i] - bval[j]) * bval_width[j];\n                    s3[i][j] = v * norm[i];\n                }\n            }\n        } else {\n            for (j = 0; j < npart; j++) {\n                var hf_slope = 15 + Math.min(21 / bval[j], 12);\n                var s3_x_norm = norm_s3_func_x(hf_slope);\n                for (var i = 0; i < npart; i++) {\n                    var v = s3_x_norm\n                        * s3_func_x(bval[i] - bval[j], hf_slope)\n                        * bval_width[j];\n                    s3[i][j] = v * norm[i];\n                }\n            }\n        }\n        for (var i = 0; i < npart; i++) {\n            for (j = 0; j < npart; j++) {\n                if (s3[i][j] > 0.0)\n                    break;\n            }\n            s3ind[i][0] = j;\n\n            for (j = npart - 1; j > 0; j--) {\n                if (s3[i][j] > 0.0)\n                    break;\n            }\n            s3ind[i][1] = j;\n            numberOfNoneZero += (s3ind[i][1] - s3ind[i][0] + 1);\n        }\n\n        var p = new_float(numberOfNoneZero);\n        var k = 0;\n        for (var i = 0; i < npart; i++)\n            for (j = s3ind[i][0]; j <= s3ind[i][1]; j++)\n                p[k++] = s3[i][j];\n\n        return p;\n    }\n\n    function stereo_demask(f) {\n        /* setup stereo demasking thresholds */\n        /* formula reverse enginerred from plot in paper */\n        var arg = freq2bark(f);\n        arg = (Math.min(arg, 15.5) / 15.5);\n\n        return Math.pow(10.0,\n            1.25 * (1 - Math.cos(Math.PI * arg)) - 2.5);\n    }\n\n    /**\n     * NOTE: the bitrate reduction from the inter-channel masking effect is low\n     * compared to the chance of getting annyoing artefacts. L3psycho_anal_vbr\n     * does not use this feature. (Robert 071216)\n     */\n    this.psymodel_init = function (gfp) {\n        var gfc = gfp.internal_flags;\n        var i;\n        var useOldS3 = true;\n        var bvl_a = 13, bvl_b = 24;\n        var snr_l_a = 0, snr_l_b = 0;\n        var snr_s_a = -8.25, snr_s_b = -4.5;\n        var bval = new_float(Encoder.CBANDS);\n        var bval_width = new_float(Encoder.CBANDS);\n        var norm = new_float(Encoder.CBANDS);\n        var sfreq = gfp.out_samplerate;\n\n        switch (gfp.experimentalZ) {\n            default:\n            case 0:\n                useOldS3 = true;\n                break;\n            case 1:\n                useOldS3 = (gfp.VBR == VbrMode.vbr_mtrh || gfp.VBR == VbrMode.vbr_mt) ? false\n                    : true;\n                break;\n            case 2:\n                useOldS3 = false;\n                break;\n            case 3:\n                bvl_a = 8;\n                snr_l_a = -1.75;\n                snr_l_b = -0.0125;\n                snr_s_a = -8.25;\n                snr_s_b = -2.25;\n                break;\n        }\n        gfc.ms_ener_ratio_old = .25;\n        gfc.blocktype_old[0] = gfc.blocktype_old[1] = Encoder.NORM_TYPE;\n        // the vbr header is long blocks\n\n        for (i = 0; i < 4; ++i) {\n            for (var j = 0; j < Encoder.CBANDS; ++j) {\n                gfc.nb_1[i][j] = 1e20;\n                gfc.nb_2[i][j] = 1e20;\n                gfc.nb_s1[i][j] = gfc.nb_s2[i][j] = 1.0;\n            }\n            for (var sb = 0; sb < Encoder.SBMAX_l; sb++) {\n                gfc.en[i].l[sb] = 1e20;\n                gfc.thm[i].l[sb] = 1e20;\n            }\n            for (var j = 0; j < 3; ++j) {\n                for (var sb = 0; sb < Encoder.SBMAX_s; sb++) {\n                    gfc.en[i].s[sb][j] = 1e20;\n                    gfc.thm[i].s[sb][j] = 1e20;\n                }\n                gfc.nsPsy.lastAttacks[i] = 0;\n            }\n            for (var j = 0; j < 9; j++)\n                gfc.nsPsy.last_en_subshort[i][j] = 10.;\n        }\n\n        /* init. for loudness approx. -jd 2001 mar 27 */\n        gfc.loudness_sq_save[0] = gfc.loudness_sq_save[1] = 0.0;\n\n        /*************************************************************************\n         * now compute the psychoacoustic model specific constants\n         ************************************************************************/\n        /* compute numlines, bo, bm, bval, bval_width, mld */\n\n        gfc.npart_l = init_numline(gfc.numlines_l, gfc.bo_l, gfc.bm_l, bval,\n            bval_width, gfc.mld_l, gfc.PSY.bo_l_weight, sfreq,\n            Encoder.BLKSIZE, gfc.scalefac_band.l, Encoder.BLKSIZE\n            / (2.0 * 576), Encoder.SBMAX_l);\n        /* compute the spreading function */\n        for (i = 0; i < gfc.npart_l; i++) {\n            var snr = snr_l_a;\n            if (bval[i] >= bvl_a) {\n                snr = snr_l_b * (bval[i] - bvl_a) / (bvl_b - bvl_a) + snr_l_a\n                    * (bvl_b - bval[i]) / (bvl_b - bvl_a);\n            }\n            norm[i] = Math.pow(10.0, snr / 10.0);\n            if (gfc.numlines_l[i] > 0) {\n                gfc.rnumlines_l[i] = 1.0 / gfc.numlines_l[i];\n            } else {\n                gfc.rnumlines_l[i] = 0;\n            }\n        }\n        gfc.s3_ll = init_s3_values(gfc.s3ind, gfc.npart_l, bval, bval_width,\n            norm, useOldS3);\n\n        /* compute long block specific values, ATH and MINVAL */\n        var j = 0;\n        for (i = 0; i < gfc.npart_l; i++) {\n            var x;\n\n            /* ATH */\n            x = Float.MAX_VALUE;\n            for (var k = 0; k < gfc.numlines_l[i]; k++, j++) {\n                var freq = sfreq * j / (1000.0 * Encoder.BLKSIZE);\n                var level;\n                /*\n                 * ATH below 100 Hz constant, not further climbing\n                 */\n                level = this.ATHformula(freq * 1000, gfp) - 20;\n                // scale to FFT units; returned value is in dB\n                level = Math.pow(10., 0.1 * level);\n                // convert from dB . energy\n                level *= gfc.numlines_l[i];\n                if (x > level)\n                    x = level;\n            }\n            gfc.ATH.cb_l[i] = x;\n\n            /*\n             * MINVAL. For low freq, the strength of the masking is limited by\n             * minval this is an ISO MPEG1 thing, dont know if it is really\n             * needed\n             */\n            /*\n             * FIXME: it does work to reduce low-freq problems in S53-Wind-Sax\n             * and lead-voice samples, but introduces some 3 kbps bit bloat too.\n             * TODO: Further refinement of the shape of this hack.\n             */\n            x = -20 + bval[i] * 20 / 10;\n            if (x > 6) {\n                x = 100;\n            }\n            if (x < -15) {\n                x = -15;\n            }\n            x -= 8.;\n            gfc.minval_l[i] = (Math.pow(10.0, x / 10.) * gfc.numlines_l[i]);\n        }\n\n        /************************************************************************\n         * do the same things for short blocks\n         ************************************************************************/\n        gfc.npart_s = init_numline(gfc.numlines_s, gfc.bo_s, gfc.bm_s, bval,\n            bval_width, gfc.mld_s, gfc.PSY.bo_s_weight, sfreq,\n            Encoder.BLKSIZE_s, gfc.scalefac_band.s, Encoder.BLKSIZE_s\n            / (2.0 * 192), Encoder.SBMAX_s);\n\n        /* SNR formula. short block is normalized by SNR. is it still right ? */\n        j = 0;\n        for (i = 0; i < gfc.npart_s; i++) {\n            var x;\n            var snr = snr_s_a;\n            if (bval[i] >= bvl_a) {\n                snr = snr_s_b * (bval[i] - bvl_a) / (bvl_b - bvl_a) + snr_s_a\n                    * (bvl_b - bval[i]) / (bvl_b - bvl_a);\n            }\n            norm[i] = Math.pow(10.0, snr / 10.0);\n\n            /* ATH */\n            x = Float.MAX_VALUE;\n            for (var k = 0; k < gfc.numlines_s[i]; k++, j++) {\n                var freq = sfreq * j / (1000.0 * Encoder.BLKSIZE_s);\n                var level;\n                /* freq = Min(.1,freq); */\n                /*\n                 * ATH below 100 Hz constant, not\n                 * further climbing\n                 */\n                level = this.ATHformula(freq * 1000, gfp) - 20;\n                // scale to FFT units; returned value is in dB\n                level = Math.pow(10., 0.1 * level);\n                // convert from dB . energy\n                level *= gfc.numlines_s[i];\n                if (x > level)\n                    x = level;\n            }\n            gfc.ATH.cb_s[i] = x;\n\n            /*\n             * MINVAL. For low freq, the strength of the masking is limited by\n             * minval this is an ISO MPEG1 thing, dont know if it is really\n             * needed\n             */\n            x = (-7.0 + bval[i] * 7.0 / 12.0);\n            if (bval[i] > 12) {\n                x *= 1 + Math.log(1 + x) * 3.1;\n            }\n            if (bval[i] < 12) {\n                x *= 1 + Math.log(1 - x) * 2.3;\n            }\n            if (x < -15) {\n                x = -15;\n            }\n            x -= 8;\n            gfc.minval_s[i] = Math.pow(10.0, x / 10)\n                * gfc.numlines_s[i];\n        }\n\n        gfc.s3_ss = init_s3_values(gfc.s3ind_s, gfc.npart_s, bval, bval_width,\n            norm, useOldS3);\n\n        init_mask_add_max_values();\n        fft.init_fft(gfc);\n\n        /* setup temporal masking */\n        gfc.decay = Math.exp(-1.0 * LOG10\n            / (temporalmask_sustain_sec * sfreq / 192.0));\n\n        {\n            var msfix;\n            msfix = NS_MSFIX;\n            if ((gfp.exp_nspsytune & 2) != 0)\n                msfix = 1.0;\n            if (Math.abs(gfp.msfix) > 0.0)\n                msfix = gfp.msfix;\n            gfp.msfix = msfix;\n\n            /*\n             * spread only from npart_l bands. Normally, we use the spreading\n             * function to convolve from npart_l down to npart_l bands\n             */\n            for (var b = 0; b < gfc.npart_l; b++)\n                if (gfc.s3ind[b][1] > gfc.npart_l - 1)\n                    gfc.s3ind[b][1] = gfc.npart_l - 1;\n        }\n\n        /*\n         * prepare for ATH auto adjustment: we want to decrease the ATH by 12 dB\n         * per second\n         */\n        var frame_duration = (576. * gfc.mode_gr / sfreq);\n        gfc.ATH.decay = Math.pow(10., -12. / 10. * frame_duration);\n        gfc.ATH.adjust = 0.01;\n        /* minimum, for leading low loudness */\n        gfc.ATH.adjustLimit = 1.0;\n        /* on lead, allow adjust up to maximum */\n\n\n        if (gfp.ATHtype != -1) {\n            /* compute equal loudness weights (eql_w) */\n            var freq;\n            var freq_inc = gfp.out_samplerate\n                / (Encoder.BLKSIZE);\n            var eql_balance = 0.0;\n            freq = 0.0;\n            for (i = 0; i < Encoder.BLKSIZE / 2; ++i) {\n                /* convert ATH dB to relative power (not dB) */\n                /* to determine eql_w */\n                freq += freq_inc;\n                gfc.ATH.eql_w[i] = 1. / Math.pow(10, this.ATHformula(freq, gfp) / 10);\n                eql_balance += gfc.ATH.eql_w[i];\n            }\n            eql_balance = 1.0 / eql_balance;\n            for (i = Encoder.BLKSIZE / 2; --i >= 0;) { /* scale weights */\n                gfc.ATH.eql_w[i] *= eql_balance;\n            }\n        }\n        {\n            for (var b = j = 0; b < gfc.npart_s; ++b) {\n                for (i = 0; i < gfc.numlines_s[b]; ++i) {\n                    ++j;\n                }\n            }\n            for (var b = j = 0; b < gfc.npart_l; ++b) {\n                for (i = 0; i < gfc.numlines_l[b]; ++i) {\n                    ++j;\n                }\n            }\n        }\n        j = 0;\n        for (i = 0; i < gfc.npart_l; i++) {\n            var freq = sfreq * (j + gfc.numlines_l[i] / 2) / (1.0 * Encoder.BLKSIZE);\n            gfc.mld_cb_l[i] = stereo_demask(freq);\n            j += gfc.numlines_l[i];\n        }\n        for (; i < Encoder.CBANDS; ++i) {\n            gfc.mld_cb_l[i] = 1;\n        }\n        j = 0;\n        for (i = 0; i < gfc.npart_s; i++) {\n            var freq = sfreq * (j + gfc.numlines_s[i] / 2) / (1.0 * Encoder.BLKSIZE_s);\n            gfc.mld_cb_s[i] = stereo_demask(freq);\n            j += gfc.numlines_s[i];\n        }\n        for (; i < Encoder.CBANDS; ++i) {\n            gfc.mld_cb_s[i] = 1;\n        }\n        return 0;\n    }\n\n    /**\n     * Those ATH formulas are returning their minimum value for input = -1\n     */\n    function ATHformula_GB(f, value) {\n        /**\n         * <PRE>\n         *  from Painter & Spanias\n         *           modified by Gabriel Bouvigne to better fit the reality\n         *           ath =    3.640 * pow(f,-0.8)\n         *           - 6.800 * exp(-0.6*pow(f-3.4,2.0))\n         *           + 6.000 * exp(-0.15*pow(f-8.7,2.0))\n         *           + 0.6* 0.001 * pow(f,4.0);\n         *\n         *\n         *           In the past LAME was using the Painter &Spanias formula.\n         *           But we had some recurrent problems with HF content.\n         *           We measured real ATH values, and found the older formula\n         *           to be inaccurate in the higher part. So we made this new\n         *           formula and this solved most of HF problematic test cases.\n         *           The tradeoff is that in VBR mode it increases a lot the\n         *           bitrate.\n         * </PRE>\n         */\n\n        /*\n         * This curve can be adjusted according to the VBR scale: it adjusts\n         * from something close to Painter & Spanias on V9 up to Bouvigne's\n         * formula for V0. This way the VBR bitrate is more balanced according\n         * to the -V value.\n         */\n\n        // the following Hack allows to ask for the lowest value\n        if (f < -.3)\n            f = 3410;\n\n        // convert to khz\n        f /= 1000;\n        f = Math.max(0.1, f);\n        var ath = 3.640 * Math.pow(f, -0.8) - 6.800\n            * Math.exp(-0.6 * Math.pow(f - 3.4, 2.0)) + 6.000\n            * Math.exp(-0.15 * Math.pow(f - 8.7, 2.0))\n            + (0.6 + 0.04 * value) * 0.001 * Math.pow(f, 4.0);\n        return ath;\n    }\n\n    this.ATHformula = function (f, gfp) {\n        var ath;\n        switch (gfp.ATHtype) {\n            case 0:\n                ath = ATHformula_GB(f, 9);\n                break;\n            case 1:\n                // over sensitive, should probably be removed\n                ath = ATHformula_GB(f, -1);\n                break;\n            case 2:\n                ath = ATHformula_GB(f, 0);\n                break;\n            case 3:\n                // modification of GB formula by Roel\n                ath = ATHformula_GB(f, 1) + 6;\n                break;\n            case 4:\n                ath = ATHformula_GB(f, gfp.ATHcurve);\n                break;\n            default:\n                ath = ATHformula_GB(f, 0);\n                break;\n        }\n        return ath;\n    }\n\n}\n\n\n\nfunction Lame() {\n    var self = this;\n    var LAME_MAXALBUMART = (128 * 1024);\n\n    Lame.V9 = 410;\n    Lame.V8 = 420;\n    Lame.V7 = 430;\n    Lame.V6 = 440;\n    Lame.V5 = 450;\n    Lame.V4 = 460;\n    Lame.V3 = 470;\n    Lame.V2 = 480;\n    Lame.V1 = 490;\n    Lame.V0 = 500;\n\n    /* still there for compatibility */\n\n    Lame.R3MIX = 1000;\n    Lame.STANDARD = 1001;\n    Lame.EXTREME = 1002;\n    Lame.INSANE = 1003;\n    Lame.STANDARD_FAST = 1004;\n    Lame.EXTREME_FAST = 1005;\n    Lame.MEDIUM = 1006;\n    Lame.MEDIUM_FAST = 1007;\n\n    /**\n     * maximum size of mp3buffer needed if you encode at most 1152 samples for\n     * each call to lame_encode_buffer. see lame_encode_buffer() below\n     * (LAME_MAXMP3BUFFER is now obsolete)\n     */\n    var LAME_MAXMP3BUFFER = (16384 + LAME_MAXALBUMART);\n    Lame.LAME_MAXMP3BUFFER = LAME_MAXMP3BUFFER;\n\n    var ga;\n    var bs;\n    var p;\n    var qupvt;\n    var qu;\n    var psy = new PsyModel();\n    var vbr;\n    var ver;\n    var id3;\n    var mpglib;\n    this.enc = new Encoder();\n\n    this.setModules = function (_ga, _bs, _p, _qupvt, _qu, _vbr, _ver, _id3, _mpglib) {\n        ga = _ga;\n        bs = _bs;\n        p = _p;\n        qupvt = _qupvt;\n        qu = _qu;\n        vbr = _vbr;\n        ver = _ver;\n        id3 = _id3;\n        mpglib = _mpglib;\n        this.enc.setModules(bs, psy, qupvt, vbr);\n    }\n\n    /**\n     * PSY Model related stuff\n     */\n    function PSY() {\n        /**\n         * The dbQ stuff.\n         */\n        this.mask_adjust = 0.;\n        /**\n         * The dbQ stuff.\n         */\n        this.mask_adjust_short = 0.;\n        /* at transition from one scalefactor band to next */\n        /**\n         * Band weight long scalefactor bands.\n         */\n        this.bo_l_weight = new_float(Encoder.SBMAX_l);\n        /**\n         * Band weight short scalefactor bands.\n         */\n        this.bo_s_weight = new_float(Encoder.SBMAX_s);\n    }\n\n    function LowPassHighPass() {\n        this.lowerlimit = 0.;\n    }\n\n    function BandPass(bitrate, lPass) {\n        this.lowpass = lPass;\n    }\n\n    var LAME_ID = 0xFFF88E3B;\n\n    function lame_init_old(gfp) {\n        var gfc;\n\n        gfp.class_id = LAME_ID;\n\n        gfc = gfp.internal_flags = new LameInternalFlags();\n\n        /* Global flags. set defaults here for non-zero values */\n        /* see lame.h for description */\n        /*\n         * set integer values to -1 to mean that LAME will compute the best\n         * value, UNLESS the calling program as set it (and the value is no\n         * longer -1)\n         */\n\n        gfp.mode = MPEGMode.NOT_SET;\n        gfp.original = 1;\n        gfp.in_samplerate = 44100;\n        gfp.num_channels = 2;\n        gfp.num_samples = -1;\n\n        gfp.bWriteVbrTag = true;\n        gfp.quality = -1;\n        gfp.short_blocks = null;\n        gfc.subblock_gain = -1;\n\n        gfp.lowpassfreq = 0;\n        gfp.highpassfreq = 0;\n        gfp.lowpasswidth = -1;\n        gfp.highpasswidth = -1;\n\n        gfp.VBR = VbrMode.vbr_off;\n        gfp.VBR_q = 4;\n        gfp.ATHcurve = -1;\n        gfp.VBR_mean_bitrate_kbps = 128;\n        gfp.VBR_min_bitrate_kbps = 0;\n        gfp.VBR_max_bitrate_kbps = 0;\n        gfp.VBR_hard_min = 0;\n        gfc.VBR_min_bitrate = 1;\n        /* not 0 ????? */\n        gfc.VBR_max_bitrate = 13;\n        /* not 14 ????? */\n\n        gfp.quant_comp = -1;\n        gfp.quant_comp_short = -1;\n\n        gfp.msfix = -1;\n\n        gfc.resample_ratio = 1;\n\n        gfc.OldValue[0] = 180;\n        gfc.OldValue[1] = 180;\n        gfc.CurrentStep[0] = 4;\n        gfc.CurrentStep[1] = 4;\n        gfc.masking_lower = 1;\n        gfc.nsPsy.attackthre = -1;\n        gfc.nsPsy.attackthre_s = -1;\n\n        gfp.scale = -1;\n\n        gfp.athaa_type = -1;\n        gfp.ATHtype = -1;\n        /* default = -1 = set in lame_init_params */\n        gfp.athaa_loudapprox = -1;\n        /* 1 = flat loudness approx. (total energy) */\n        /* 2 = equal loudness curve */\n        gfp.athaa_sensitivity = 0.0;\n        /* no offset */\n        gfp.useTemporal = null;\n        gfp.interChRatio = -1;\n\n        /*\n         * The reason for int mf_samples_to_encode = ENCDELAY + POSTDELAY;\n         * ENCDELAY = internal encoder delay. And then we have to add\n         * POSTDELAY=288 because of the 50% MDCT overlap. A 576 MDCT granule\n         * decodes to 1152 samples. To synthesize the 576 samples centered under\n         * this granule we need the previous granule for the first 288 samples\n         * (no problem), and the next granule for the next 288 samples (not\n         * possible if this is last granule). So we need to pad with 288 samples\n         * to make sure we can encode the 576 samples we are interested in.\n         */\n        gfc.mf_samples_to_encode = Encoder.ENCDELAY + Encoder.POSTDELAY;\n        gfp.encoder_padding = 0;\n        gfc.mf_size = Encoder.ENCDELAY - Encoder.MDCTDELAY;\n        /*\n         * we pad input with this many 0's\n         */\n\n        gfp.findReplayGain = false;\n        gfp.decode_on_the_fly = false;\n\n        gfc.decode_on_the_fly = false;\n        gfc.findReplayGain = false;\n        gfc.findPeakSample = false;\n\n        gfc.RadioGain = 0;\n        gfc.AudiophileGain = 0;\n        gfc.noclipGainChange = 0;\n        gfc.noclipScale = -1.0;\n\n        gfp.preset = 0;\n\n        gfp.write_id3tag_automatic = true;\n        return 0;\n    }\n\n    this.lame_init = function () {\n        var gfp = new LameGlobalFlags();\n\n        var ret = lame_init_old(gfp);\n        if (ret != 0) {\n            return null;\n        }\n\n        gfp.lame_allocated_gfp = 1;\n        return gfp;\n    }\n\n    function filter_coef(x) {\n        if (x > 1.0)\n            return 0.0;\n        if (x <= 0.0)\n            return 1.0;\n\n        return Math.cos(Math.PI / 2 * x);\n    }\n\n    this.nearestBitrateFullIndex = function (bitrate) {\n        /* borrowed from DM abr presets */\n\n        var full_bitrate_table = [8, 16, 24, 32, 40, 48, 56, 64, 80,\n            96, 112, 128, 160, 192, 224, 256, 320];\n\n        var lower_range = 0, lower_range_kbps = 0, upper_range = 0, upper_range_kbps = 0;\n\n        /* We assume specified bitrate will be 320kbps */\n        upper_range_kbps = full_bitrate_table[16];\n        upper_range = 16;\n        lower_range_kbps = full_bitrate_table[16];\n        lower_range = 16;\n\n        /*\n         * Determine which significant bitrates the value specified falls\n         * between, if loop ends without breaking then we were correct above\n         * that the value was 320\n         */\n        for (var b = 0; b < 16; b++) {\n            if ((Math.max(bitrate, full_bitrate_table[b + 1])) != bitrate) {\n                upper_range_kbps = full_bitrate_table[b + 1];\n                upper_range = b + 1;\n                lower_range_kbps = full_bitrate_table[b];\n                lower_range = (b);\n                break;\n                /* We found upper range */\n            }\n        }\n\n        /* Determine which range the value specified is closer to */\n        if ((upper_range_kbps - bitrate) > (bitrate - lower_range_kbps)) {\n            return lower_range;\n        }\n        return upper_range;\n    }\n\n    function optimum_samplefreq(lowpassfreq, input_samplefreq) {\n        /*\n         * Rules:\n         *\n         * - if possible, sfb21 should NOT be used\n         */\n        var suggested_samplefreq = 44100;\n\n        if (input_samplefreq >= 48000)\n            suggested_samplefreq = 48000;\n        else if (input_samplefreq >= 44100)\n            suggested_samplefreq = 44100;\n        else if (input_samplefreq >= 32000)\n            suggested_samplefreq = 32000;\n        else if (input_samplefreq >= 24000)\n            suggested_samplefreq = 24000;\n        else if (input_samplefreq >= 22050)\n            suggested_samplefreq = 22050;\n        else if (input_samplefreq >= 16000)\n            suggested_samplefreq = 16000;\n        else if (input_samplefreq >= 12000)\n            suggested_samplefreq = 12000;\n        else if (input_samplefreq >= 11025)\n            suggested_samplefreq = 11025;\n        else if (input_samplefreq >= 8000)\n            suggested_samplefreq = 8000;\n\n        if (lowpassfreq == -1)\n            return suggested_samplefreq;\n\n        if (lowpassfreq <= 15960)\n            suggested_samplefreq = 44100;\n        if (lowpassfreq <= 15250)\n            suggested_samplefreq = 32000;\n        if (lowpassfreq <= 11220)\n            suggested_samplefreq = 24000;\n        if (lowpassfreq <= 9970)\n            suggested_samplefreq = 22050;\n        if (lowpassfreq <= 7230)\n            suggested_samplefreq = 16000;\n        if (lowpassfreq <= 5420)\n            suggested_samplefreq = 12000;\n        if (lowpassfreq <= 4510)\n            suggested_samplefreq = 11025;\n        if (lowpassfreq <= 3970)\n            suggested_samplefreq = 8000;\n\n        if (input_samplefreq < suggested_samplefreq) {\n            /*\n             * choose a valid MPEG sample frequency above the input sample\n             * frequency to avoid SFB21/12 bitrate bloat rh 061115\n             */\n            if (input_samplefreq > 44100) {\n                return 48000;\n            }\n            if (input_samplefreq > 32000) {\n                return 44100;\n            }\n            if (input_samplefreq > 24000) {\n                return 32000;\n            }\n            if (input_samplefreq > 22050) {\n                return 24000;\n            }\n            if (input_samplefreq > 16000) {\n                return 22050;\n            }\n            if (input_samplefreq > 12000) {\n                return 16000;\n            }\n            if (input_samplefreq > 11025) {\n                return 12000;\n            }\n            if (input_samplefreq > 8000) {\n                return 11025;\n            }\n            return 8000;\n        }\n        return suggested_samplefreq;\n    }\n\n    /**\n     * convert samp freq in Hz to index\n     */\n    function SmpFrqIndex(sample_freq, gpf) {\n        switch (sample_freq) {\n            case 44100:\n                gpf.version = 1;\n                return 0;\n            case 48000:\n                gpf.version = 1;\n                return 1;\n            case 32000:\n                gpf.version = 1;\n                return 2;\n            case 22050:\n                gpf.version = 0;\n                return 0;\n            case 24000:\n                gpf.version = 0;\n                return 1;\n            case 16000:\n                gpf.version = 0;\n                return 2;\n            case 11025:\n                gpf.version = 0;\n                return 0;\n            case 12000:\n                gpf.version = 0;\n                return 1;\n            case 8000:\n                gpf.version = 0;\n                return 2;\n            default:\n                gpf.version = 0;\n                return -1;\n        }\n    }\n\n    /**\n     * @param bRate\n     *            legal rates from 8 to 320\n     */\n    function FindNearestBitrate(bRate, version, samplerate) {\n        /* MPEG-1 or MPEG-2 LSF */\n        if (samplerate < 16000)\n            version = 2;\n\n        var bitrate = Tables.bitrate_table[version][1];\n\n        for (var i = 2; i <= 14; i++) {\n            if (Tables.bitrate_table[version][i] > 0) {\n                if (Math.abs(Tables.bitrate_table[version][i] - bRate) < Math\n                        .abs(bitrate - bRate))\n                    bitrate = Tables.bitrate_table[version][i];\n            }\n        }\n        return bitrate;\n    }\n\n    /**\n     * @param bRate\n     *            legal rates from 32 to 448 kbps\n     * @param version\n     *            MPEG-1 or MPEG-2/2.5 LSF\n     */\n    function BitrateIndex(bRate, version, samplerate) {\n        /* convert bitrate in kbps to index */\n        if (samplerate < 16000)\n            version = 2;\n        for (var i = 0; i <= 14; i++) {\n            if (Tables.bitrate_table[version][i] > 0) {\n                if (Tables.bitrate_table[version][i] == bRate) {\n                    return i;\n                }\n            }\n        }\n        return -1;\n    }\n\n    function optimum_bandwidth(lh, bitrate) {\n        /**\n         * <PRE>\n         *  Input:\n         *      bitrate     total bitrate in kbps\n         *\n         *   Output:\n         *      lowerlimit: best lowpass frequency limit for input filter in Hz\n         *      upperlimit: best highpass frequency limit for input filter in Hz\n         * </PRE>\n         */\n        var freq_map = [new BandPass(8, 2000),\n            new BandPass(16, 3700), new BandPass(24, 3900),\n            new BandPass(32, 5500), new BandPass(40, 7000),\n            new BandPass(48, 7500), new BandPass(56, 10000),\n            new BandPass(64, 11000), new BandPass(80, 13500),\n            new BandPass(96, 15100), new BandPass(112, 15600),\n            new BandPass(128, 17000), new BandPass(160, 17500),\n            new BandPass(192, 18600), new BandPass(224, 19400),\n            new BandPass(256, 19700), new BandPass(320, 20500)];\n\n        var table_index = self.nearestBitrateFullIndex(bitrate);\n        lh.lowerlimit = freq_map[table_index].lowpass;\n    }\n\n    function lame_init_params_ppflt(gfp) {\n        var gfc = gfp.internal_flags;\n        /***************************************************************/\n        /* compute info needed for polyphase filter (filter type==0, default) */\n        /***************************************************************/\n\n        var lowpass_band = 32;\n        var highpass_band = -1;\n\n        if (gfc.lowpass1 > 0) {\n            var minband = 999;\n            for (var band = 0; band <= 31; band++) {\n                var freq = (band / 31.0);\n                /* this band and above will be zeroed: */\n                if (freq >= gfc.lowpass2) {\n                    lowpass_band = Math.min(lowpass_band, band);\n                }\n                if (gfc.lowpass1 < freq && freq < gfc.lowpass2) {\n                    minband = Math.min(minband, band);\n                }\n            }\n\n            /*\n             * compute the *actual* transition band implemented by the polyphase\n             * filter\n             */\n            if (minband == 999) {\n                gfc.lowpass1 = (lowpass_band - .75) / 31.0;\n            } else {\n                gfc.lowpass1 = (minband - .75) / 31.0;\n            }\n            gfc.lowpass2 = lowpass_band / 31.0;\n        }\n\n        /*\n         * make sure highpass filter is within 90% of what the effective\n         * highpass frequency will be\n         */\n        if (gfc.highpass2 > 0) {\n            if (gfc.highpass2 < .9 * (.75 / 31.0)) {\n                gfc.highpass1 = 0;\n                gfc.highpass2 = 0;\n                System.err.println(\"Warning: highpass filter disabled.  \"\n                    + \"highpass frequency too small\\n\");\n            }\n        }\n\n        if (gfc.highpass2 > 0) {\n            var maxband = -1;\n            for (var band = 0; band <= 31; band++) {\n                var freq = band / 31.0;\n                /* this band and below will be zereod */\n                if (freq <= gfc.highpass1) {\n                    highpass_band = Math.max(highpass_band, band);\n                }\n                if (gfc.highpass1 < freq && freq < gfc.highpass2) {\n                    maxband = Math.max(maxband, band);\n                }\n            }\n            /*\n             * compute the *actual* transition band implemented by the polyphase\n             * filter\n             */\n            gfc.highpass1 = highpass_band / 31.0;\n            if (maxband == -1) {\n                gfc.highpass2 = (highpass_band + .75) / 31.0;\n            } else {\n                gfc.highpass2 = (maxband + .75) / 31.0;\n            }\n        }\n\n        for (var band = 0; band < 32; band++) {\n            var fc1, fc2;\n            var freq = band / 31.0;\n            if (gfc.highpass2 > gfc.highpass1) {\n                fc1 = filter_coef((gfc.highpass2 - freq)\n                    / (gfc.highpass2 - gfc.highpass1 + 1e-20));\n            } else {\n                fc1 = 1.0;\n            }\n            if (gfc.lowpass2 > gfc.lowpass1) {\n                fc2 = filter_coef((freq - gfc.lowpass1)\n                    / (gfc.lowpass2 - gfc.lowpass1 + 1e-20));\n            } else {\n                fc2 = 1.0;\n            }\n            gfc.amp_filter[band] = (fc1 * fc2);\n        }\n    }\n\n    function lame_init_qval(gfp) {\n        var gfc = gfp.internal_flags;\n\n        switch (gfp.quality) {\n            default:\n            case 9: /* no psymodel, no noise shaping */\n                gfc.psymodel = 0;\n                gfc.noise_shaping = 0;\n                gfc.noise_shaping_amp = 0;\n                gfc.noise_shaping_stop = 0;\n                gfc.use_best_huffman = 0;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 8:\n                gfp.quality = 7;\n            //$FALL-THROUGH$\n            case 7:\n                /*\n                 * use psymodel (for short block and m/s switching), but no noise\n                 * shapping\n                 */\n                gfc.psymodel = 1;\n                gfc.noise_shaping = 0;\n                gfc.noise_shaping_amp = 0;\n                gfc.noise_shaping_stop = 0;\n                gfc.use_best_huffman = 0;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 6:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                gfc.noise_shaping_amp = 0;\n                gfc.noise_shaping_stop = 0;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 0;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 5:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                gfc.noise_shaping_amp = 0;\n                gfc.noise_shaping_stop = 0;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 0;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 4:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                gfc.noise_shaping_amp = 0;\n                gfc.noise_shaping_stop = 0;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 1;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 3:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                gfc.noise_shaping_amp = 1;\n                gfc.noise_shaping_stop = 1;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 1;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 2:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                if (gfc.substep_shaping == 0)\n                    gfc.substep_shaping = 2;\n                gfc.noise_shaping_amp = 1;\n                gfc.noise_shaping_stop = 1;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 1;\n                /* inner loop */\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 1:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                if (gfc.substep_shaping == 0)\n                    gfc.substep_shaping = 2;\n                gfc.noise_shaping_amp = 2;\n                gfc.noise_shaping_stop = 1;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 1;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 0:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                if (gfc.substep_shaping == 0)\n                    gfc.substep_shaping = 2;\n                gfc.noise_shaping_amp = 2;\n                gfc.noise_shaping_stop = 1;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 1;\n                /*\n                 * type 2 disabled because of it slowness, in favor of full outer\n                 * loop search\n                 */\n                gfc.full_outer_loop = 0;\n                /*\n                 * full outer loop search disabled because of audible distortions it\n                 * may generate rh 060629\n                 */\n                break;\n        }\n\n    }\n\n    function lame_init_bitstream(gfp) {\n        var gfc = gfp.internal_flags;\n        gfp.frameNum = 0;\n\n        if (gfp.write_id3tag_automatic) {\n            id3.id3tag_write_v2(gfp);\n        }\n        /* initialize histogram data optionally used by frontend */\n\n        gfc.bitrate_stereoMode_Hist = new_int_n([16, 4 + 1]);\n        gfc.bitrate_blockType_Hist = new_int_n([16, 4 + 1 + 1]);\n\n        gfc.PeakSample = 0.0;\n\n        /* Write initial VBR Header to bitstream and init VBR data */\n        if (gfp.bWriteVbrTag)\n            vbr.InitVbrTag(gfp);\n    }\n\n    /********************************************************************\n     * initialize internal params based on data in gf (globalflags struct filled\n     * in by calling program)\n     *\n     * OUTLINE:\n     *\n     * We first have some complex code to determine bitrate, output samplerate\n     * and mode. It is complicated by the fact that we allow the user to set\n     * some or all of these parameters, and need to determine best possible\n     * values for the rest of them:\n     *\n     * 1. set some CPU related flags 2. check if we are mono.mono, stereo.mono\n     * or stereo.stereo 3. compute bitrate and output samplerate: user may have\n     * set compression ratio user may have set a bitrate user may have set a\n     * output samplerate 4. set some options which depend on output samplerate\n     * 5. compute the actual compression ratio 6. set mode based on compression\n     * ratio\n     *\n     * The remaining code is much simpler - it just sets options based on the\n     * mode & compression ratio:\n     *\n     * set allow_diff_short based on mode select lowpass filter based on\n     * compression ratio & mode set the bitrate index, and min/max bitrates for\n     * VBR modes disable VBR tag if it is not appropriate initialize the\n     * bitstream initialize scalefac_band data set sideinfo_len (based on\n     * channels, CRC, out_samplerate) write an id3v2 tag into the bitstream\n     * write VBR tag into the bitstream set mpeg1/2 flag estimate the number of\n     * frames (based on a lot of data)\n     *\n     * now we set more flags: nspsytune: see code VBR modes see code CBR/ABR see\n     * code\n     *\n     * Finally, we set the algorithm flags based on the gfp.quality value\n     * lame_init_qval(gfp);\n     *\n     ********************************************************************/\n    this.lame_init_params = function (gfp) {\n        var gfc = gfp.internal_flags;\n\n        gfc.Class_ID = 0;\n        if (gfc.ATH == null)\n            gfc.ATH = new ATH();\n        if (gfc.PSY == null)\n            gfc.PSY = new PSY();\n        if (gfc.rgdata == null)\n            gfc.rgdata = new ReplayGain();\n\n        gfc.channels_in = gfp.num_channels;\n        if (gfc.channels_in == 1)\n            gfp.mode = MPEGMode.MONO;\n        gfc.channels_out = (gfp.mode == MPEGMode.MONO) ? 1 : 2;\n        gfc.mode_ext = Encoder.MPG_MD_MS_LR;\n        if (gfp.mode == MPEGMode.MONO)\n            gfp.force_ms = false;\n        /*\n         * don't allow forced mid/side stereo for mono output\n         */\n\n        if (gfp.VBR == VbrMode.vbr_off && gfp.VBR_mean_bitrate_kbps != 128\n            && gfp.brate == 0)\n            gfp.brate = gfp.VBR_mean_bitrate_kbps;\n\n        if (gfp.VBR == VbrMode.vbr_off || gfp.VBR == VbrMode.vbr_mtrh\n            || gfp.VBR == VbrMode.vbr_mt) {\n            /* these modes can handle free format condition */\n        } else {\n            gfp.free_format = false;\n            /* mode can't be mixed with free format */\n        }\n\n        if (gfp.VBR == VbrMode.vbr_off && gfp.brate == 0) {\n            /* no bitrate or compression ratio specified, use 11.025 */\n            if (BitStream.EQ(gfp.compression_ratio, 0))\n                gfp.compression_ratio = 11.025;\n            /*\n             * rate to compress a CD down to exactly 128000 bps\n             */\n        }\n\n        /* find bitrate if user specify a compression ratio */\n        if (gfp.VBR == VbrMode.vbr_off && gfp.compression_ratio > 0) {\n\n            if (gfp.out_samplerate == 0)\n                gfp.out_samplerate = map2MP3Frequency((int)(0.97 * gfp.in_samplerate));\n            /*\n             * round up with a margin of 3 %\n             */\n\n            /*\n             * choose a bitrate for the output samplerate which achieves\n             * specified compression ratio\n             */\n            gfp.brate = 0 | (gfp.out_samplerate * 16 * gfc.channels_out / (1.e3 * gfp.compression_ratio));\n\n            /* we need the version for the bitrate table look up */\n            gfc.samplerate_index = SmpFrqIndex(gfp.out_samplerate, gfp);\n\n            if (!gfp.free_format) /*\n             * for non Free Format find the nearest allowed\n             * bitrate\n             */\n                gfp.brate = FindNearestBitrate(gfp.brate, gfp.version,\n                    gfp.out_samplerate);\n        }\n\n        if (gfp.out_samplerate != 0) {\n            if (gfp.out_samplerate < 16000) {\n                gfp.VBR_mean_bitrate_kbps = Math.max(gfp.VBR_mean_bitrate_kbps,\n                    8);\n                gfp.VBR_mean_bitrate_kbps = Math.min(gfp.VBR_mean_bitrate_kbps,\n                    64);\n            } else if (gfp.out_samplerate < 32000) {\n                gfp.VBR_mean_bitrate_kbps = Math.max(gfp.VBR_mean_bitrate_kbps,\n                    8);\n                gfp.VBR_mean_bitrate_kbps = Math.min(gfp.VBR_mean_bitrate_kbps,\n                    160);\n            } else {\n                gfp.VBR_mean_bitrate_kbps = Math.max(gfp.VBR_mean_bitrate_kbps,\n                    32);\n                gfp.VBR_mean_bitrate_kbps = Math.min(gfp.VBR_mean_bitrate_kbps,\n                    320);\n            }\n        }\n\n        /****************************************************************/\n        /* if a filter has not been enabled, see if we should add one: */\n        /****************************************************************/\n        if (gfp.lowpassfreq == 0) {\n            var lowpass = 16000.;\n\n            switch (gfp.VBR) {\n                case VbrMode.vbr_off:\n                {\n                    var lh = new LowPassHighPass();\n                    optimum_bandwidth(lh, gfp.brate);\n                    lowpass = lh.lowerlimit;\n                    break;\n                }\n                case VbrMode.vbr_abr:\n                {\n                    var lh = new LowPassHighPass();\n                    optimum_bandwidth(lh, gfp.VBR_mean_bitrate_kbps);\n                    lowpass = lh.lowerlimit;\n                    break;\n                }\n                case VbrMode.vbr_rh:\n                {\n                    var x = [19500, 19000, 18600, 18000, 17500, 16000,\n                        15600, 14900, 12500, 10000, 3950];\n                    if (0 <= gfp.VBR_q && gfp.VBR_q <= 9) {\n                        var a = x[gfp.VBR_q], b = x[gfp.VBR_q + 1], m = gfp.VBR_q_frac;\n                        lowpass = linear_int(a, b, m);\n                    } else {\n                        lowpass = 19500;\n                    }\n                    break;\n                }\n                default:\n                {\n                    var x = [19500, 19000, 18500, 18000, 17500, 16500,\n                        15500, 14500, 12500, 9500, 3950];\n                    if (0 <= gfp.VBR_q && gfp.VBR_q <= 9) {\n                        var a = x[gfp.VBR_q], b = x[gfp.VBR_q + 1], m = gfp.VBR_q_frac;\n                        lowpass = linear_int(a, b, m);\n                    } else {\n                        lowpass = 19500;\n                    }\n                }\n            }\n            if (gfp.mode == MPEGMode.MONO\n                && (gfp.VBR == VbrMode.vbr_off || gfp.VBR == VbrMode.vbr_abr))\n                lowpass *= 1.5;\n\n            gfp.lowpassfreq = lowpass | 0;\n        }\n\n        if (gfp.out_samplerate == 0) {\n            if (2 * gfp.lowpassfreq > gfp.in_samplerate) {\n                gfp.lowpassfreq = gfp.in_samplerate / 2;\n            }\n            gfp.out_samplerate = optimum_samplefreq(gfp.lowpassfreq | 0,\n                gfp.in_samplerate);\n        }\n\n        gfp.lowpassfreq = Math.min(20500, gfp.lowpassfreq);\n        gfp.lowpassfreq = Math.min(gfp.out_samplerate / 2, gfp.lowpassfreq);\n\n        if (gfp.VBR == VbrMode.vbr_off) {\n            gfp.compression_ratio = gfp.out_samplerate * 16 * gfc.channels_out\n                / (1.e3 * gfp.brate);\n        }\n        if (gfp.VBR == VbrMode.vbr_abr) {\n            gfp.compression_ratio = gfp.out_samplerate * 16 * gfc.channels_out\n                / (1.e3 * gfp.VBR_mean_bitrate_kbps);\n        }\n\n        /*\n         * do not compute ReplayGain values and do not find the peak sample if\n         * we can't store them\n         */\n        if (!gfp.bWriteVbrTag) {\n            gfp.findReplayGain = false;\n            gfp.decode_on_the_fly = false;\n            gfc.findPeakSample = false;\n        }\n        gfc.findReplayGain = gfp.findReplayGain;\n        gfc.decode_on_the_fly = gfp.decode_on_the_fly;\n\n        if (gfc.decode_on_the_fly)\n            gfc.findPeakSample = true;\n\n        if (gfc.findReplayGain) {\n            if (ga.InitGainAnalysis(gfc.rgdata, gfp.out_samplerate) == GainAnalysis.INIT_GAIN_ANALYSIS_ERROR) {\n                gfp.internal_flags = null;\n                return -6;\n            }\n        }\n\n        if (gfc.decode_on_the_fly && !gfp.decode_only) {\n            if (gfc.hip != null) {\n                mpglib.hip_decode_exit(gfc.hip);\n            }\n            gfc.hip = mpglib.hip_decode_init();\n        }\n\n        gfc.mode_gr = gfp.out_samplerate <= 24000 ? 1 : 2;\n        /*\n         * Number of granules per frame\n         */\n        gfp.framesize = 576 * gfc.mode_gr;\n        gfp.encoder_delay = Encoder.ENCDELAY;\n\n        gfc.resample_ratio = gfp.in_samplerate / gfp.out_samplerate;\n\n        /**\n         * <PRE>\n         *  sample freq       bitrate     compression ratio\n         *     [kHz]      [kbps/channel]   for 16 bit input\n         *     44.1            56               12.6\n         *     44.1            64               11.025\n         *     44.1            80                8.82\n         *     22.05           24               14.7\n         *     22.05           32               11.025\n         *     22.05           40                8.82\n         *     16              16               16.0\n         *     16              24               10.667\n         * </PRE>\n         */\n        /**\n         * <PRE>\n         *  For VBR, take a guess at the compression_ratio.\n         *  For example:\n         *\n         *    VBR_q    compression     like\n         *     -        4.4         320 kbps/44 kHz\n         *   0...1      5.5         256 kbps/44 kHz\n         *     2        7.3         192 kbps/44 kHz\n         *     4        8.8         160 kbps/44 kHz\n         *     6       11           128 kbps/44 kHz\n         *     9       14.7          96 kbps\n         *\n         *  for lower bitrates, downsample with --resample\n         * </PRE>\n         */\n        switch (gfp.VBR) {\n            case VbrMode.vbr_mt:\n            case VbrMode.vbr_rh:\n            case VbrMode.vbr_mtrh:\n            {\n                /* numbers are a bit strange, but they determine the lowpass value */\n                var cmp = [5.7, 6.5, 7.3, 8.2, 10, 11.9, 13, 14,\n                    15, 16.5];\n                gfp.compression_ratio = cmp[gfp.VBR_q];\n            }\n                break;\n            case VbrMode.vbr_abr:\n                gfp.compression_ratio = gfp.out_samplerate * 16 * gfc.channels_out\n                    / (1.e3 * gfp.VBR_mean_bitrate_kbps);\n                break;\n            default:\n                gfp.compression_ratio = gfp.out_samplerate * 16 * gfc.channels_out\n                    / (1.e3 * gfp.brate);\n                break;\n        }\n\n        /*\n         * mode = -1 (not set by user) or mode = MONO (because of only 1 input\n         * channel). If mode has not been set, then select J-STEREO\n         */\n        if (gfp.mode == MPEGMode.NOT_SET) {\n            gfp.mode = MPEGMode.JOINT_STEREO;\n        }\n\n        /* apply user driven high pass filter */\n        if (gfp.highpassfreq > 0) {\n            gfc.highpass1 = 2. * gfp.highpassfreq;\n\n            if (gfp.highpasswidth >= 0)\n                gfc.highpass2 = 2. * (gfp.highpassfreq + gfp.highpasswidth);\n            else\n            /* 0% above on default */\n                gfc.highpass2 = (1 + 0.00) * 2. * gfp.highpassfreq;\n\n            gfc.highpass1 /= gfp.out_samplerate;\n            gfc.highpass2 /= gfp.out_samplerate;\n        } else {\n            gfc.highpass1 = 0;\n            gfc.highpass2 = 0;\n        }\n        /* apply user driven low pass filter */\n        if (gfp.lowpassfreq > 0) {\n            gfc.lowpass2 = 2. * gfp.lowpassfreq;\n            if (gfp.lowpasswidth >= 0) {\n                gfc.lowpass1 = 2. * (gfp.lowpassfreq - gfp.lowpasswidth);\n                if (gfc.lowpass1 < 0) /* has to be >= 0 */\n                    gfc.lowpass1 = 0;\n            } else { /* 0% below on default */\n                gfc.lowpass1 = (1 - 0.00) * 2. * gfp.lowpassfreq;\n            }\n            gfc.lowpass1 /= gfp.out_samplerate;\n            gfc.lowpass2 /= gfp.out_samplerate;\n        } else {\n            gfc.lowpass1 = 0;\n            gfc.lowpass2 = 0;\n        }\n\n        /**********************************************************************/\n        /* compute info needed for polyphase filter (filter type==0, default) */\n        /**********************************************************************/\n        lame_init_params_ppflt(gfp);\n        /*******************************************************\n         * samplerate and bitrate index\n         *******************************************************/\n        gfc.samplerate_index = SmpFrqIndex(gfp.out_samplerate, gfp);\n        if (gfc.samplerate_index < 0) {\n            gfp.internal_flags = null;\n            return -1;\n        }\n\n        if (gfp.VBR == VbrMode.vbr_off) {\n            if (gfp.free_format) {\n                gfc.bitrate_index = 0;\n            } else {\n                gfp.brate = FindNearestBitrate(gfp.brate, gfp.version,\n                    gfp.out_samplerate);\n                gfc.bitrate_index = BitrateIndex(gfp.brate, gfp.version,\n                    gfp.out_samplerate);\n                if (gfc.bitrate_index <= 0) {\n                    gfp.internal_flags = null;\n                    return -1;\n                }\n            }\n        } else {\n            gfc.bitrate_index = 1;\n        }\n\n        /* for CBR, we will write an \"info\" tag. */\n\n        if (gfp.analysis)\n            gfp.bWriteVbrTag = false;\n\n        /* some file options not allowed if output is: not specified or stdout */\n        if (gfc.pinfo != null)\n            gfp.bWriteVbrTag = false;\n        /* disable Xing VBR tag */\n\n        bs.init_bit_stream_w(gfc);\n\n        var j = gfc.samplerate_index + (3 * gfp.version) + 6\n            * (gfp.out_samplerate < 16000 ? 1 : 0);\n        for (var i = 0; i < Encoder.SBMAX_l + 1; i++)\n            gfc.scalefac_band.l[i] = qupvt.sfBandIndex[j].l[i];\n\n        for (var i = 0; i < Encoder.PSFB21 + 1; i++) {\n            var size = (gfc.scalefac_band.l[22] - gfc.scalefac_band.l[21])\n                / Encoder.PSFB21;\n            var start = gfc.scalefac_band.l[21] + i * size;\n            gfc.scalefac_band.psfb21[i] = start;\n        }\n        gfc.scalefac_band.psfb21[Encoder.PSFB21] = 576;\n\n        for (var i = 0; i < Encoder.SBMAX_s + 1; i++)\n            gfc.scalefac_band.s[i] = qupvt.sfBandIndex[j].s[i];\n\n        for (var i = 0; i < Encoder.PSFB12 + 1; i++) {\n            var size = (gfc.scalefac_band.s[13] - gfc.scalefac_band.s[12])\n                / Encoder.PSFB12;\n            var start = gfc.scalefac_band.s[12] + i * size;\n            gfc.scalefac_band.psfb12[i] = start;\n        }\n        gfc.scalefac_band.psfb12[Encoder.PSFB12] = 192;\n        /* determine the mean bitrate for main data */\n        if (gfp.version == 1) /* MPEG 1 */\n            gfc.sideinfo_len = (gfc.channels_out == 1) ? 4 + 17 : 4 + 32;\n        else\n        /* MPEG 2 */\n            gfc.sideinfo_len = (gfc.channels_out == 1) ? 4 + 9 : 4 + 17;\n\n        if (gfp.error_protection)\n            gfc.sideinfo_len += 2;\n\n        lame_init_bitstream(gfp);\n\n        gfc.Class_ID = LAME_ID;\n\n        {\n            var k;\n\n            for (k = 0; k < 19; k++)\n                gfc.nsPsy.pefirbuf[k] = 700 * gfc.mode_gr * gfc.channels_out;\n\n            if (gfp.ATHtype == -1)\n                gfp.ATHtype = 4;\n        }\n\n        switch (gfp.VBR) {\n\n            case VbrMode.vbr_mt:\n                gfp.VBR = VbrMode.vbr_mtrh;\n            //$FALL-THROUGH$\n            case VbrMode.vbr_mtrh:\n            {\n                if (gfp.useTemporal == null) {\n                    gfp.useTemporal = false;\n                    /* off by default for this VBR mode */\n                }\n\n                p.apply_preset(gfp, 500 - (gfp.VBR_q * 10), 0);\n                /**\n                 * <PRE>\n                 *   The newer VBR code supports only a limited\n                 *     subset of quality levels:\n                 *     9-5=5 are the same, uses x^3/4 quantization\n                 *   4-0=0 are the same  5 plus best huffman divide code\n                 * </PRE>\n                 */\n                if (gfp.quality < 0)\n                    gfp.quality = LAME_DEFAULT_QUALITY;\n                if (gfp.quality < 5)\n                    gfp.quality = 0;\n                if (gfp.quality > 5)\n                    gfp.quality = 5;\n\n                gfc.PSY.mask_adjust = gfp.maskingadjust;\n                gfc.PSY.mask_adjust_short = gfp.maskingadjust_short;\n\n                /*\n                 * sfb21 extra only with MPEG-1 at higher sampling rates\n                 */\n                if (gfp.experimentalY)\n                    gfc.sfb21_extra = false;\n                else\n                    gfc.sfb21_extra = (gfp.out_samplerate > 44000);\n\n                gfc.iteration_loop = new VBRNewIterationLoop(qu);\n                break;\n\n            }\n            case VbrMode.vbr_rh:\n            {\n\n                p.apply_preset(gfp, 500 - (gfp.VBR_q * 10), 0);\n\n                gfc.PSY.mask_adjust = gfp.maskingadjust;\n                gfc.PSY.mask_adjust_short = gfp.maskingadjust_short;\n\n                /*\n                 * sfb21 extra only with MPEG-1 at higher sampling rates\n                 */\n                if (gfp.experimentalY)\n                    gfc.sfb21_extra = false;\n                else\n                    gfc.sfb21_extra = (gfp.out_samplerate > 44000);\n\n                /*\n                 * VBR needs at least the output of GPSYCHO, so we have to garantee\n                 * that by setting a minimum quality level, actually level 6 does\n                 * it. down to level 6\n                 */\n                if (gfp.quality > 6)\n                    gfp.quality = 6;\n\n                if (gfp.quality < 0)\n                    gfp.quality = LAME_DEFAULT_QUALITY;\n\n                gfc.iteration_loop = new VBROldIterationLoop(qu);\n                break;\n            }\n\n            default: /* cbr/abr */\n            {\n                var vbrmode;\n\n                /*\n                 * no sfb21 extra with CBR code\n                 */\n                gfc.sfb21_extra = false;\n\n                if (gfp.quality < 0)\n                    gfp.quality = LAME_DEFAULT_QUALITY;\n\n                vbrmode = gfp.VBR;\n                if (vbrmode == VbrMode.vbr_off)\n                    gfp.VBR_mean_bitrate_kbps = gfp.brate;\n                /* second, set parameters depending on bitrate */\n                p.apply_preset(gfp, gfp.VBR_mean_bitrate_kbps, 0);\n                gfp.VBR = vbrmode;\n\n                gfc.PSY.mask_adjust = gfp.maskingadjust;\n                gfc.PSY.mask_adjust_short = gfp.maskingadjust_short;\n\n                if (vbrmode == VbrMode.vbr_off) {\n                    gfc.iteration_loop = new CBRNewIterationLoop(qu);\n                } else {\n                    gfc.iteration_loop = new ABRIterationLoop(qu);\n                }\n                break;\n            }\n        }\n        /* initialize default values common for all modes */\n\n        if (gfp.VBR != VbrMode.vbr_off) { /* choose a min/max bitrate for VBR */\n            /* if the user didn't specify VBR_max_bitrate: */\n            gfc.VBR_min_bitrate = 1;\n            /*\n             * default: allow 8 kbps (MPEG-2) or 32 kbps (MPEG-1)\n             */\n            gfc.VBR_max_bitrate = 14;\n            /*\n             * default: allow 160 kbps (MPEG-2) or 320 kbps (MPEG-1)\n             */\n            if (gfp.out_samplerate < 16000)\n                gfc.VBR_max_bitrate = 8;\n            /* default: allow 64 kbps (MPEG-2.5) */\n            if (gfp.VBR_min_bitrate_kbps != 0) {\n                gfp.VBR_min_bitrate_kbps = FindNearestBitrate(\n                    gfp.VBR_min_bitrate_kbps, gfp.version,\n                    gfp.out_samplerate);\n                gfc.VBR_min_bitrate = BitrateIndex(gfp.VBR_min_bitrate_kbps,\n                    gfp.version, gfp.out_samplerate);\n                if (gfc.VBR_min_bitrate < 0)\n                    return -1;\n            }\n            if (gfp.VBR_max_bitrate_kbps != 0) {\n                gfp.VBR_max_bitrate_kbps = FindNearestBitrate(\n                    gfp.VBR_max_bitrate_kbps, gfp.version,\n                    gfp.out_samplerate);\n                gfc.VBR_max_bitrate = BitrateIndex(gfp.VBR_max_bitrate_kbps,\n                    gfp.version, gfp.out_samplerate);\n                if (gfc.VBR_max_bitrate < 0)\n                    return -1;\n            }\n            gfp.VBR_min_bitrate_kbps = Tables.bitrate_table[gfp.version][gfc.VBR_min_bitrate];\n            gfp.VBR_max_bitrate_kbps = Tables.bitrate_table[gfp.version][gfc.VBR_max_bitrate];\n            gfp.VBR_mean_bitrate_kbps = Math.min(\n                Tables.bitrate_table[gfp.version][gfc.VBR_max_bitrate],\n                gfp.VBR_mean_bitrate_kbps);\n            gfp.VBR_mean_bitrate_kbps = Math.max(\n                Tables.bitrate_table[gfp.version][gfc.VBR_min_bitrate],\n                gfp.VBR_mean_bitrate_kbps);\n        }\n\n        /* just another daily changing developer switch */\n        if (gfp.tune) {\n            gfc.PSY.mask_adjust += gfp.tune_value_a;\n            gfc.PSY.mask_adjust_short += gfp.tune_value_a;\n        }\n\n        /* initialize internal qval settings */\n        lame_init_qval(gfp);\n        /*\n         * automatic ATH adjustment on\n         */\n        if (gfp.athaa_type < 0)\n            gfc.ATH.useAdjust = 3;\n        else\n            gfc.ATH.useAdjust = gfp.athaa_type;\n\n        /* initialize internal adaptive ATH settings -jd */\n        gfc.ATH.aaSensitivityP = Math.pow(10.0, gfp.athaa_sensitivity\n            / -10.0);\n\n        if (gfp.short_blocks == null) {\n            gfp.short_blocks = ShortBlock.short_block_allowed;\n        }\n\n        /*\n         * Note Jan/2003: Many hardware decoders cannot handle short blocks in\n         * regular stereo mode unless they are coupled (same type in both\n         * channels) it is a rare event (1 frame per min. or so) that LAME would\n         * use uncoupled short blocks, so lets turn them off until we decide how\n         * to handle this. No other encoders allow uncoupled short blocks, even\n         * though it is in the standard.\n         */\n        /*\n         * rh 20040217: coupling makes no sense for mono and dual-mono streams\n         */\n        if (gfp.short_blocks == ShortBlock.short_block_allowed\n            && (gfp.mode == MPEGMode.JOINT_STEREO || gfp.mode == MPEGMode.STEREO)) {\n            gfp.short_blocks = ShortBlock.short_block_coupled;\n        }\n\n        if (gfp.quant_comp < 0)\n            gfp.quant_comp = 1;\n        if (gfp.quant_comp_short < 0)\n            gfp.quant_comp_short = 0;\n\n        if (gfp.msfix < 0)\n            gfp.msfix = 0;\n\n        /* select psychoacoustic model */\n        gfp.exp_nspsytune = gfp.exp_nspsytune | 1;\n\n        if (gfp.internal_flags.nsPsy.attackthre < 0)\n            gfp.internal_flags.nsPsy.attackthre = PsyModel.NSATTACKTHRE;\n        if (gfp.internal_flags.nsPsy.attackthre_s < 0)\n            gfp.internal_flags.nsPsy.attackthre_s = PsyModel.NSATTACKTHRE_S;\n\n\n        if (gfp.scale < 0)\n            gfp.scale = 1;\n\n        if (gfp.ATHtype < 0)\n            gfp.ATHtype = 4;\n\n        if (gfp.ATHcurve < 0)\n            gfp.ATHcurve = 4;\n\n        if (gfp.athaa_loudapprox < 0)\n            gfp.athaa_loudapprox = 2;\n\n        if (gfp.interChRatio < 0)\n            gfp.interChRatio = 0;\n\n        if (gfp.useTemporal == null)\n            gfp.useTemporal = true;\n        /* on by default */\n\n        /*\n         * padding method as described in\n         * \"MPEG-Layer3 / Bitstream Syntax and Decoding\" by Martin Sieler, Ralph\n         * Sperschneider\n         *\n         * note: there is no padding for the very first frame\n         *\n         * Robert Hegemann 2000-06-22\n         */\n        gfc.slot_lag = gfc.frac_SpF = 0;\n        if (gfp.VBR == VbrMode.vbr_off)\n            gfc.slot_lag = gfc.frac_SpF = (((gfp.version + 1) * 72000 * gfp.brate) % gfp.out_samplerate) | 0;\n\n        qupvt.iteration_init(gfp);\n        psy.psymodel_init(gfp);\n        return 0;\n    }\n\n    function update_inbuffer_size(gfc, nsamples) {\n        if (gfc.in_buffer_0 == null || gfc.in_buffer_nsamples < nsamples) {\n            gfc.in_buffer_0 = new_float(nsamples);\n            gfc.in_buffer_1 = new_float(nsamples);\n            gfc.in_buffer_nsamples = nsamples;\n        }\n    }\n\n    this.lame_encode_flush = function (gfp, mp3buffer, mp3bufferPos, mp3buffer_size) {\n        var gfc = gfp.internal_flags;\n        var buffer = new_short_n([2, 1152]);\n        var imp3 = 0, mp3count, mp3buffer_size_remaining;\n\n        /*\n         * we always add POSTDELAY=288 padding to make sure granule with real\n         * data can be complety decoded (because of 50% overlap with next\n         * granule\n         */\n        var end_padding;\n        var frames_left;\n        var samples_to_encode = gfc.mf_samples_to_encode - Encoder.POSTDELAY;\n        var mf_needed = calcNeeded(gfp);\n\n        /* Was flush already called? */\n        if (gfc.mf_samples_to_encode < 1) {\n            return 0;\n        }\n        mp3count = 0;\n\n        if (gfp.in_samplerate != gfp.out_samplerate) {\n            /*\n             * delay due to resampling; needs to be fixed, if resampling code\n             * gets changed\n             */\n            samples_to_encode += 16. * gfp.out_samplerate / gfp.in_samplerate;\n        }\n        end_padding = gfp.framesize - (samples_to_encode % gfp.framesize);\n        if (end_padding < 576)\n            end_padding += gfp.framesize;\n        gfp.encoder_padding = end_padding;\n\n        frames_left = (samples_to_encode + end_padding) / gfp.framesize;\n\n        /*\n         * send in a frame of 0 padding until all internal sample buffers are\n         * flushed\n         */\n        while (frames_left > 0 && imp3 >= 0) {\n            var bunch = mf_needed - gfc.mf_size;\n            var frame_num = gfp.frameNum;\n\n            bunch *= gfp.in_samplerate;\n            bunch /= gfp.out_samplerate;\n            if (bunch > 1152)\n                bunch = 1152;\n            if (bunch < 1)\n                bunch = 1;\n\n            mp3buffer_size_remaining = mp3buffer_size - mp3count;\n\n            /* if user specifed buffer size = 0, dont check size */\n            if (mp3buffer_size == 0)\n                mp3buffer_size_remaining = 0;\n\n            imp3 = this.lame_encode_buffer(gfp, buffer[0], buffer[1], bunch,\n                mp3buffer, mp3bufferPos, mp3buffer_size_remaining);\n\n            mp3bufferPos += imp3;\n            mp3count += imp3;\n            frames_left -= (frame_num != gfp.frameNum) ? 1 : 0;\n        }\n        /*\n         * Set gfc.mf_samples_to_encode to 0, so we may detect and break loops\n         * calling it more than once in a row.\n         */\n        gfc.mf_samples_to_encode = 0;\n\n        if (imp3 < 0) {\n            /* some type of fatal error */\n            return imp3;\n        }\n\n        mp3buffer_size_remaining = mp3buffer_size - mp3count;\n        /* if user specifed buffer size = 0, dont check size */\n        if (mp3buffer_size == 0)\n            mp3buffer_size_remaining = 0;\n\n        /* mp3 related stuff. bit buffer might still contain some mp3 data */\n        bs.flush_bitstream(gfp);\n        imp3 = bs.copy_buffer(gfc, mp3buffer, mp3bufferPos,\n            mp3buffer_size_remaining, 1);\n        if (imp3 < 0) {\n            /* some type of fatal error */\n            return imp3;\n        }\n        mp3bufferPos += imp3;\n        mp3count += imp3;\n        mp3buffer_size_remaining = mp3buffer_size - mp3count;\n        /* if user specifed buffer size = 0, dont check size */\n        if (mp3buffer_size == 0)\n            mp3buffer_size_remaining = 0;\n\n        if (gfp.write_id3tag_automatic) {\n            /* write a id3 tag to the bitstream */\n            id3.id3tag_write_v1(gfp);\n\n            imp3 = bs.copy_buffer(gfc, mp3buffer, mp3bufferPos,\n                mp3buffer_size_remaining, 0);\n\n            if (imp3 < 0) {\n                return imp3;\n            }\n            mp3count += imp3;\n        }\n        return mp3count;\n    };\n\n    this.lame_encode_buffer = function (gfp, buffer_l, buffer_r, nsamples, mp3buf, mp3bufPos, mp3buf_size) {\n        var gfc = gfp.internal_flags;\n        var in_buffer = [null, null];\n\n        if (gfc.Class_ID != LAME_ID)\n            return -3;\n\n        if (nsamples == 0)\n            return 0;\n\n        update_inbuffer_size(gfc, nsamples);\n\n        in_buffer[0] = gfc.in_buffer_0;\n        in_buffer[1] = gfc.in_buffer_1;\n\n        /* make a copy of input buffer, changing type to sample_t */\n        for (var i = 0; i < nsamples; i++) {\n            in_buffer[0][i] = buffer_l[i];\n            if (gfc.channels_in > 1)\n                in_buffer[1][i] = buffer_r[i];\n        }\n\n        return lame_encode_buffer_sample(gfp, in_buffer[0], in_buffer[1],\n            nsamples, mp3buf, mp3bufPos, mp3buf_size);\n    }\n\n    function calcNeeded(gfp) {\n        var mf_needed = Encoder.BLKSIZE + gfp.framesize - Encoder.FFTOFFSET;\n        /*\n         * amount needed for FFT\n         */\n        mf_needed = Math.max(mf_needed, 512 + gfp.framesize - 32);\n\n        return mf_needed;\n    }\n\n    function lame_encode_buffer_sample(gfp, buffer_l, buffer_r, nsamples, mp3buf, mp3bufPos, mp3buf_size) {\n        var gfc = gfp.internal_flags;\n        var mp3size = 0, ret, i, ch, mf_needed;\n        var mp3out;\n        var mfbuf = [null, null];\n        var in_buffer = [null, null];\n\n        if (gfc.Class_ID != LAME_ID)\n            return -3;\n\n        if (nsamples == 0)\n            return 0;\n\n        /* copy out any tags that may have been written into bitstream */\n        mp3out = bs.copy_buffer(gfc, mp3buf, mp3bufPos, mp3buf_size, 0);\n        if (mp3out < 0)\n            return mp3out;\n        /* not enough buffer space */\n        mp3bufPos += mp3out;\n        mp3size += mp3out;\n\n        in_buffer[0] = buffer_l;\n        in_buffer[1] = buffer_r;\n\n        /* Apply user defined re-scaling */\n\n        /* user selected scaling of the samples */\n        if (BitStream.NEQ(gfp.scale, 0) && BitStream.NEQ(gfp.scale, 1.0)) {\n            for (i = 0; i < nsamples; ++i) {\n                in_buffer[0][i] *= gfp.scale;\n                if (gfc.channels_out == 2)\n                    in_buffer[1][i] *= gfp.scale;\n            }\n        }\n\n        /* user selected scaling of the channel 0 (left) samples */\n        if (BitStream.NEQ(gfp.scale_left, 0)\n            && BitStream.NEQ(gfp.scale_left, 1.0)) {\n            for (i = 0; i < nsamples; ++i) {\n                in_buffer[0][i] *= gfp.scale_left;\n            }\n        }\n\n        /* user selected scaling of the channel 1 (right) samples */\n        if (BitStream.NEQ(gfp.scale_right, 0)\n            && BitStream.NEQ(gfp.scale_right, 1.0)) {\n            for (i = 0; i < nsamples; ++i) {\n                in_buffer[1][i] *= gfp.scale_right;\n            }\n        }\n\n        /* Downsample to Mono if 2 channels in and 1 channel out */\n        if (gfp.num_channels == 2 && gfc.channels_out == 1) {\n            for (i = 0; i < nsamples; ++i) {\n                in_buffer[0][i] = 0.5 * ( in_buffer[0][i] + in_buffer[1][i]);\n                in_buffer[1][i] = 0.0;\n            }\n        }\n\n        mf_needed = calcNeeded(gfp);\n\n        mfbuf[0] = gfc.mfbuf[0];\n        mfbuf[1] = gfc.mfbuf[1];\n\n        var in_bufferPos = 0;\n        while (nsamples > 0) {\n            var in_buffer_ptr = [null, null];\n            var n_in = 0;\n            /* number of input samples processed with fill_buffer */\n            var n_out = 0;\n            /* number of samples output with fill_buffer */\n            /* n_in <> n_out if we are resampling */\n\n            in_buffer_ptr[0] = in_buffer[0];\n            in_buffer_ptr[1] = in_buffer[1];\n            /* copy in new samples into mfbuf, with resampling */\n            var inOut = new InOut();\n            fill_buffer(gfp, mfbuf, in_buffer_ptr, in_bufferPos, nsamples,\n                inOut);\n            n_in = inOut.n_in;\n            n_out = inOut.n_out;\n\n            /* compute ReplayGain of resampled input if requested */\n            if (gfc.findReplayGain && !gfc.decode_on_the_fly)\n                if (ga.AnalyzeSamples(gfc.rgdata, mfbuf[0], gfc.mf_size,\n                        mfbuf[1], gfc.mf_size, n_out, gfc.channels_out) == GainAnalysis.GAIN_ANALYSIS_ERROR)\n                    return -6;\n\n            /* update in_buffer counters */\n            nsamples -= n_in;\n            in_bufferPos += n_in;\n            if (gfc.channels_out == 2)\n                ;// in_bufferPos += n_in;\n\n            /* update mfbuf[] counters */\n            gfc.mf_size += n_out;\n\n            /*\n             * lame_encode_flush may have set gfc.mf_sample_to_encode to 0 so we\n             * have to reinitialize it here when that happened.\n             */\n            if (gfc.mf_samples_to_encode < 1) {\n                gfc.mf_samples_to_encode = Encoder.ENCDELAY + Encoder.POSTDELAY;\n            }\n            gfc.mf_samples_to_encode += n_out;\n\n            if (gfc.mf_size >= mf_needed) {\n                /* encode the frame. */\n                /* mp3buf = pointer to current location in buffer */\n                /* mp3buf_size = size of original mp3 output buffer */\n                /* = 0 if we should not worry about the */\n                /* buffer size because calling program is */\n                /* to lazy to compute it */\n                /* mp3size = size of data written to buffer so far */\n                /* mp3buf_size-mp3size = amount of space avalable */\n\n                var buf_size = mp3buf_size - mp3size;\n                if (mp3buf_size == 0)\n                    buf_size = 0;\n\n                ret = lame_encode_frame(gfp, mfbuf[0], mfbuf[1], mp3buf,\n                    mp3bufPos, buf_size);\n\n                if (ret < 0)\n                    return ret;\n                mp3bufPos += ret;\n                mp3size += ret;\n\n                /* shift out old samples */\n                gfc.mf_size -= gfp.framesize;\n                gfc.mf_samples_to_encode -= gfp.framesize;\n                for (ch = 0; ch < gfc.channels_out; ch++)\n                    for (i = 0; i < gfc.mf_size; i++)\n                        mfbuf[ch][i] = mfbuf[ch][i + gfp.framesize];\n            }\n        }\n\n        return mp3size;\n    }\n\n    function lame_encode_frame(gfp, inbuf_l, inbuf_r, mp3buf, mp3bufPos, mp3buf_size) {\n        var ret = self.enc.lame_encode_mp3_frame(gfp, inbuf_l, inbuf_r, mp3buf,\n            mp3bufPos, mp3buf_size);\n        gfp.frameNum++;\n        return ret;\n    }\n\n    function InOut() {\n        this.n_in = 0;\n        this.n_out = 0;\n    }\n\n\n    function NumUsed() {\n        this.num_used = 0;\n    }\n\n    /**\n     * Greatest common divisor.\n     * <p>\n     * Joint work of Euclid and M. Hendry\n     */\n    function gcd(i, j) {\n        return j != 0 ? gcd(j, i % j) : i;\n    }\n\n    /**\n     * Resampling via FIR filter, blackman window.\n     */\n    function blackman(x, fcn, l) {\n        /*\n         * This algorithm from: SIGNAL PROCESSING ALGORITHMS IN FORTRAN AND C\n         * S.D. Stearns and R.A. David, Prentice-Hall, 1992\n         */\n        var wcn = (Math.PI * fcn);\n\n        x /= l;\n        if (x < 0)\n            x = 0;\n        if (x > 1)\n            x = 1;\n        var x2 = x - .5;\n\n        var bkwn = 0.42 - 0.5 * Math.cos(2 * x * Math.PI) + 0.08 * Math.cos(4 * x * Math.PI);\n        if (Math.abs(x2) < 1e-9)\n            return (wcn / Math.PI);\n        else\n            return (bkwn * Math.sin(l * wcn * x2) / (Math.PI * l * x2));\n    }\n\n    function fill_buffer_resample(gfp, outbuf, outbufPos, desired_len, inbuf, in_bufferPos, len, num_used, ch) {\n        var gfc = gfp.internal_flags;\n        var i, j = 0, k;\n        /* number of convolution functions to pre-compute */\n        var bpc = gfp.out_samplerate\n            / gcd(gfp.out_samplerate, gfp.in_samplerate);\n        if (bpc > LameInternalFlags.BPC)\n            bpc = LameInternalFlags.BPC;\n\n        var intratio = (Math.abs(gfc.resample_ratio\n            - Math.floor(.5 + gfc.resample_ratio)) < .0001) ? 1 : 0;\n        var fcn = 1.00 / gfc.resample_ratio;\n        if (fcn > 1.00)\n            fcn = 1.00;\n        var filter_l = 31;\n        if (0 == filter_l % 2)\n            --filter_l;\n        /* must be odd */\n        filter_l += intratio;\n        /* unless resample_ratio=int, it must be even */\n\n        var BLACKSIZE = filter_l + 1;\n        /* size of data needed for FIR */\n\n        if (gfc.fill_buffer_resample_init == 0) {\n            gfc.inbuf_old[0] = new_float(BLACKSIZE);\n            gfc.inbuf_old[1] = new_float(BLACKSIZE);\n            for (i = 0; i <= 2 * bpc; ++i)\n                gfc.blackfilt[i] = new_float(BLACKSIZE);\n\n            gfc.itime[0] = 0;\n            gfc.itime[1] = 0;\n\n            /* precompute blackman filter coefficients */\n            for (j = 0; j <= 2 * bpc; j++) {\n                var sum = 0.;\n                var offset = (j - bpc) / (2. * bpc);\n                for (i = 0; i <= filter_l; i++)\n                    sum += gfc.blackfilt[j][i] = blackman(i - offset, fcn,\n                        filter_l);\n                for (i = 0; i <= filter_l; i++)\n                    gfc.blackfilt[j][i] /= sum;\n            }\n            gfc.fill_buffer_resample_init = 1;\n        }\n\n        var inbuf_old = gfc.inbuf_old[ch];\n\n        /* time of j'th element in inbuf = itime + j/ifreq; */\n        /* time of k'th element in outbuf = j/ofreq */\n        for (k = 0; k < desired_len; k++) {\n            var time0;\n            var joff;\n\n            time0 = k * gfc.resample_ratio;\n            /* time of k'th output sample */\n            j = 0 | Math.floor(time0 - gfc.itime[ch]);\n\n            /* check if we need more input data */\n            if ((filter_l + j - filter_l / 2) >= len)\n                break;\n\n            /* blackman filter. by default, window centered at j+.5(filter_l%2) */\n            /* but we want a window centered at time0. */\n            var offset = (time0 - gfc.itime[ch] - (j + .5 * (filter_l % 2)));\n\n            /* find the closest precomputed window for this offset: */\n            joff = 0 | Math.floor((offset * 2 * bpc) + bpc + .5);\n            var xvalue = 0.;\n            for (i = 0; i <= filter_l; ++i) {\n                var j2 = i + j - filter_l / 2;\n                var y;\n                y = (j2 < 0) ? inbuf_old[BLACKSIZE + j2] : inbuf[in_bufferPos\n                + j2];\n                xvalue += y * gfc.blackfilt[joff][i];\n            }\n            outbuf[outbufPos + k] = xvalue;\n        }\n\n        /* k = number of samples added to outbuf */\n        /* last k sample used data from [j-filter_l/2,j+filter_l-filter_l/2] */\n\n        /* how many samples of input data were used: */\n        num_used.num_used = Math.min(len, filter_l + j - filter_l / 2);\n\n        /*\n         * adjust our input time counter. Incriment by the number of samples\n         * used, then normalize so that next output sample is at time 0, next\n         * input buffer is at time itime[ch]\n         */\n        gfc.itime[ch] += num_used.num_used - k * gfc.resample_ratio;\n\n        /* save the last BLACKSIZE samples into the inbuf_old buffer */\n        if (num_used.num_used >= BLACKSIZE) {\n            for (i = 0; i < BLACKSIZE; i++)\n                inbuf_old[i] = inbuf[in_bufferPos + num_used.num_used + i\n                - BLACKSIZE];\n        } else {\n            /* shift in num_used.num_used samples into inbuf_old */\n            var n_shift = BLACKSIZE - num_used.num_used;\n            /*\n             * number of samples to\n             * shift\n             */\n\n            /*\n             * shift n_shift samples by num_used.num_used, to make room for the\n             * num_used new samples\n             */\n            for (i = 0; i < n_shift; ++i)\n                inbuf_old[i] = inbuf_old[i + num_used.num_used];\n\n            /* shift in the num_used.num_used samples */\n            for (j = 0; i < BLACKSIZE; ++i, ++j)\n                inbuf_old[i] = inbuf[in_bufferPos + j];\n\n        }\n        return k;\n        /* return the number samples created at the new samplerate */\n    }\n\n    function fill_buffer(gfp, mfbuf, in_buffer, in_bufferPos, nsamples, io) {\n        var gfc = gfp.internal_flags;\n\n        /* copy in new samples into mfbuf, with resampling if necessary */\n        if ((gfc.resample_ratio < .9999) || (gfc.resample_ratio > 1.0001)) {\n            for (var ch = 0; ch < gfc.channels_out; ch++) {\n                var numUsed = new NumUsed();\n                io.n_out = fill_buffer_resample(gfp, mfbuf[ch], gfc.mf_size,\n                    gfp.framesize, in_buffer[ch], in_bufferPos, nsamples,\n                    numUsed, ch);\n                io.n_in = numUsed.num_used;\n            }\n        } else {\n            io.n_out = Math.min(gfp.framesize, nsamples);\n            io.n_in = io.n_out;\n            for (var i = 0; i < io.n_out; ++i) {\n                mfbuf[0][gfc.mf_size + i] = in_buffer[0][in_bufferPos + i];\n                if (gfc.channels_out == 2)\n                    mfbuf[1][gfc.mf_size + i] = in_buffer[1][in_bufferPos + i];\n            }\n        }\n    }\n\n}\n\n\n\nfunction GetAudio() {\n    var parse;\n    var mpg;\n\n    this.setModules = function (parse2, mpg2) {\n        parse = parse2;\n        mpg = mpg2;\n    }\n}\n\n\nfunction Parse() {\n    var ver;\n    var id3;\n    var pre;\n\n    this.setModules = function (ver2, id32, pre2) {\n        ver = ver2;\n        id3 = id32;\n        pre = pre2;\n    }\n}\n\nfunction MPGLib() {\n}\n\nfunction ID3Tag() {\n    var bits;\n    var ver;\n\n    this.setModules = function (_bits, _ver) {\n        bits = _bits;\n        ver = _ver;\n    }\n}\n\nfunction Mp3Encoder(channels, samplerate, kbps) {\n    if (arguments.length != 3) {\n        console.error('WARN: Mp3Encoder(channels, samplerate, kbps) not specified');\n        channels = 1;\n        samplerate = 44100;\n        kbps = 128;\n    }\n    var lame = new Lame();\n    var gaud = new GetAudio();\n    var ga = new GainAnalysis();\n    var bs = new BitStream();\n    var p = new Presets();\n    var qupvt = new QuantizePVT();\n    var qu = new Quantize();\n    var vbr = new VBRTag();\n    var ver = new Version();\n    var id3 = new ID3Tag();\n    var rv = new Reservoir();\n    var tak = new Takehiro();\n    var parse = new Parse();\n    var mpg = new MPGLib();\n\n    lame.setModules(ga, bs, p, qupvt, qu, vbr, ver, id3, mpg);\n    bs.setModules(ga, mpg, ver, vbr);\n    id3.setModules(bs, ver);\n    p.setModules(lame);\n    qu.setModules(bs, rv, qupvt, tak);\n    qupvt.setModules(tak, rv, lame.enc.psy);\n    rv.setModules(bs);\n    tak.setModules(qupvt);\n    vbr.setModules(lame, bs, ver);\n    gaud.setModules(parse, mpg);\n    parse.setModules(ver, id3, p);\n\n    var gfp = lame.lame_init();\n\n    gfp.num_channels = channels;\n    gfp.in_samplerate = samplerate;\n    gfp.out_samplerate = samplerate;//fix by xiangyuecn 2018-12-6 01:48:12 64kbps以下可能无声音，手动控制输出码率\n    gfp.brate = kbps;\n    gfp.mode = MPEGMode.STEREO;\n    gfp.quality = 3;\n    gfp.bWriteVbrTag = false;\n    gfp.disable_reservoir = true;\n    gfp.write_id3tag_automatic = false;\n\n    var retcode = lame.lame_init_params(gfp);\n    var maxSamples = 1152;\n    var mp3buf_size = 0 | (1.25 * maxSamples + 7200);\n    var mp3buf = new_byte(mp3buf_size);\n\n    this.encodeBuffer = function (left, right) {\n        if (channels == 1) {\n            right = left;\n        }\n        if (left.length > maxSamples) {\n            maxSamples = left.length;\n            mp3buf_size = 0 | (1.25 * maxSamples + 7200);\n            mp3buf = new_byte(mp3buf_size);\n        }\n\n        var _sz = lame.lame_encode_buffer(gfp, left, right, left.length, mp3buf, 0, mp3buf_size);\n        return new Int8Array(mp3buf.subarray(0, _sz));\n    };\n\n    this.flush = function () {\n        var _sz = lame.lame_encode_flush(gfp, mp3buf, 0, mp3buf_size);\n        return new Int8Array(mp3buf.subarray(0, _sz));\n    };\n}\n\n//fix 精简\nL3Side.SFBMAX = (Encoder.SBMAX_s * 3);\n//testFullLength();\nlamejs.Mp3Encoder = Mp3Encoder;\n}\n//fs=require('fs');\nlamejs();\n\n\nRecorder.lamejs=lamejs;\n\n//end3 ****结束copy lamejs*****\n})();","/*\nmp3编码器，需带上mp3-engine.js引擎使用\nhttps://github.com/xiangyuecn/Recorder\n\n当然最佳推荐使用mp3、wav格式，代码也是优先照顾这两种格式\n浏览器支持情况\nhttps://developer.mozilla.org/en-US/docs/Web/HTML/Supported_media_formats\n*/\n(function(){\n\"use strict\";\n\nRecorder.prototype.enc_mp3={\n\tstable:true\n\t,testmsg:\"采样率范围48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000\"\n};\n\n\n\n//*******标准UI线程转码支持函数************\n\nRecorder.prototype.mp3=function(res,True,False){\n\t\tvar This=this,set=This.set,size=res.length;\n\t\t\n\t\t//优先采用worker编码，太低版本下面用老方法提供兼容\n\t\tvar ctx=This.mp3_start(set);\n\t\tif(ctx){\n\t\t\tThis.mp3_encode(ctx,res);\n\t\t\tThis.mp3_complete(ctx,True,False,1);\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//https://github.com/wangpengfei15975/recorder.js\n\t\t//https://github.com/zhuker/lamejs bug:采样率必须和源一致，不然8k时没有声音，有问题fix：https://github.com/zhuker/lamejs/pull/11\n\t\tvar mp3=new Recorder.lamejs.Mp3Encoder(1,set.sampleRate,set.bitRate);\n\t\t\n\t\tvar blockSize=57600;\n\t\tvar data=[];\n\t\t\n\t\tvar idx=0,mp3Size=0;\n\t\tvar run=function(){\n\t\t\tif(idx<size){\n\t\t\t\tvar buf=mp3.encodeBuffer(res.subarray(idx,idx+blockSize));\n\t\t\t\tif(buf.length>0){\n\t\t\t\t\tmp3Size+=buf.buffer.byteLength;\n\t\t\t\t\tdata.push(buf.buffer);\n\t\t\t\t};\n\t\t\t\tidx+=blockSize;\n\t\t\t\tsetTimeout(run);//尽量避免卡ui\n\t\t\t}else{\n\t\t\t\tvar buf=mp3.flush();\n\t\t\t\tif(buf.length>0){\n\t\t\t\t\tmp3Size+=buf.buffer.byteLength;\n\t\t\t\t\tdata.push(buf.buffer);\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t//去掉开头的标记信息帧\n\t\t\t\tvar meta=mp3TrimFix.fn(data,mp3Size,size,set.sampleRate);\n\t\t\t\tmp3TrimFixSetMeta(meta,set);\n\t\t\t\t\n\t\t\t\tTrue(new Blob(data,{type:\"audio/mp3\"}));\n\t\t\t};\n\t\t};\n\t\trun();\n\t}\n\n\n//********边录边转码(Worker)支持函数，如果提供就代表可能支持，否则只支持标准转码*********\n\n//全局共享一个Worker，后台串行执行。如果每次都开一个新的，编码速度可能会慢很多，可能是浏览器运行缓存的因素，并且可能瞬间产生多个并行操作占用大量cpu\nvar mp3Worker;\nRecorder.BindDestroy(\"mp3Worker\",function(){\n\tconsole.log(\"mp3Worker Destroy\");\n\tmp3Worker&&mp3Worker.terminate();\n\tmp3Worker=null;\n});\n\n\nRecorder.prototype.mp3_envCheck=function(envInfo,set){//检查环境下配置是否可用\n\tvar errMsg=\"\";\n\t//需要实时编码返回数据，此时需要检查环境是否有实时特性、和是否可实时编码\n\tif(set.takeoffEncodeChunk){\n\t\tif(!envInfo.canProcess){\n\t\t\terrMsg=envInfo.envName+\"环境不支持实时处理\";\n\t\t}else if(!newContext()){//浏览器不能创建实时编码环境\n\t\t\terrMsg=\"当前浏览器版本太低，无法实时处理\";\n\t\t};\n\t};\n\treturn errMsg;\n};\nRecorder.prototype.mp3_start=function(set){//如果返回null代表不支持\n\treturn newContext(set);\n};\nvar openList={id:0};\nvar newContext=function(setOrNull){\n\tvar worker=mp3Worker;\n\ttry{\n\t\tif(!worker){\n\t\t\tvar onmsg=function(e){\n\t\t\t\tvar ed=e.data;\n\t\t\t\tvar cur=wk_ctxs[ed.id];\n\t\t\t\tif(ed.action==\"init\"){\n\t\t\t\t\twk_ctxs[ed.id]={\n\t\t\t\t\t\tsampleRate:ed.sampleRate\n\t\t\t\t\t\t,bitRate:ed.bitRate\n\t\t\t\t\t\t,takeoff:ed.takeoff\n\t\t\t\t\t\t\n\t\t\t\t\t\t,mp3Size:0\n\t\t\t\t\t\t,pcmSize:0\n\t\t\t\t\t\t,encArr:[]\n\t\t\t\t\t\t,encObj:new wk_lame.Mp3Encoder(1,ed.sampleRate,ed.bitRate)\n\t\t\t\t\t};\n\t\t\t\t}else if(!cur){\n\t\t\t\t\treturn;\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tswitch(ed.action){\n\t\t\t\tcase \"stop\":\n\t\t\t\t\tcur.encObj=null;\n\t\t\t\t\tdelete wk_ctxs[ed.id];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"encode\":\n\t\t\t\t\tcur.pcmSize+=ed.pcm.length;\n\t\t\t\t\tvar buf=cur.encObj.encodeBuffer(ed.pcm);\n\t\t\t\t\tif(buf.length>0){\n\t\t\t\t\t\tif(cur.takeoff){\n\t\t\t\t\t\t\tself.postMessage({action:\"takeoff\",id:ed.id,chunk:buf});\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tcur.mp3Size+=buf.buffer.byteLength;\n\t\t\t\t\t\t\tcur.encArr.push(buf.buffer);\n\t\t\t\t\t\t};\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"complete\":\n\t\t\t\t\tvar buf=cur.encObj.flush();\n\t\t\t\t\tif(buf.length>0){\n\t\t\t\t\t\tif(cur.takeoff){\n\t\t\t\t\t\t\tself.postMessage({action:\"takeoff\",id:ed.id,chunk:buf});\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tcur.mp3Size+=buf.buffer.byteLength;\n\t\t\t\t\t\t\tcur.encArr.push(buf.buffer);\n\t\t\t\t\t\t};\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\t//去掉开头的标记信息帧\n\t\t\t\t\tvar meta=wk_mp3TrimFix.fn(cur.encArr,cur.mp3Size,cur.pcmSize,cur.sampleRate);\n\t\t\t\t\t\n\t\t\t\t\tself.postMessage({\n\t\t\t\t\t\taction:ed.action\n\t\t\t\t\t\t,id:ed.id\n\t\t\t\t\t\t,blob:new Blob(cur.encArr,{type:\"audio/mp3\"})\n\t\t\t\t\t\t,meta:meta\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\t};\n\t\t\t};\n\t\t\t\n\t\t\t//创建一个新Worker\n\t\t\tvar jsCode=\");wk_lame();var wk_ctxs={};self.onmessage=\"+onmsg;\n\t\t\tjsCode+=\";var wk_mp3TrimFix={rm:\"+mp3TrimFix.rm+\",fn:\"+mp3TrimFix.fn+\"}\";\n\t\t\t\n\t\t\tvar lamejsCode=Recorder.lamejs.toString();\n\t\t\tvar url=(window.URL||webkitURL).createObjectURL(new Blob([\"var wk_lame=(\",lamejsCode,jsCode], {type:\"text/javascript\"}));\n\t\t\t\n\t\t\tworker=new Worker(url);\n\t\t\tsetTimeout(function(){\n\t\t\t\t(window.URL||webkitURL).revokeObjectURL(url);//必须要释放，不然每次调用内存都明显泄露内存\n\t\t\t},10000);//chrome 83 file协议下如果直接释放，将会使WebWorker无法启动\n\t\t\t\n\t\t\tworker.onmessage=function(e){\n\t\t\t\tvar data=e.data;\n\t\t\t\tvar ctx=openList[data.id];\n\t\t\t\tif(ctx){\n\t\t\t\t\tif(data.action==\"takeoff\"){\n\t\t\t\t\t\t//取走实时生成的mp3数据\n\t\t\t\t\t\tctx.set.takeoffEncodeChunk(new Uint8Array(data.chunk.buffer));\n\t\t\t\t\t}else{\n\t\t\t\t\t\t//complete\n\t\t\t\t\t\tctx.call&&ctx.call(data);\n\t\t\t\t\t\tctx.call=null;\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t\t\n\t\tvar ctx={worker:worker,set:setOrNull,takeoffQueue:[]};\n\t\tif(setOrNull){\n\t\t\tctx.id=++openList.id;\n\t\t\topenList[ctx.id]=ctx;\n\t\t\t\n\t\t\tworker.postMessage({\n\t\t\t\taction:\"init\"\n\t\t\t\t,id:ctx.id\n\t\t\t\t,sampleRate:setOrNull.sampleRate\n\t\t\t\t,bitRate:setOrNull.bitRate\n\t\t\t\t,takeoff:!!setOrNull.takeoffEncodeChunk\n\t\t\t\t\n\t\t\t\t,x:new Int16Array(5)//低版本浏览器不支持序列化TypedArray\n\t\t\t});\n\t\t}else{\n\t\t\tworker.postMessage({\n\t\t\t\tx:new Int16Array(5)//低版本浏览器不支持序列化TypedArray\n\t\t\t});\n\t\t};\n\t\t\n\t\t\n\t\tmp3Worker=worker;\n\t\treturn ctx;\n\t}catch(e){//出错了就不要提供了\n\t\tworker&&worker.terminate();\n\t\t\n\t\tconsole.error(e);\n\t\treturn null;\n\t};\n};\nRecorder.prototype.mp3_stop=function(startCtx){\n\tif(startCtx&&startCtx.worker){\n\t\tstartCtx.worker.postMessage({\n\t\t\taction:\"stop\"\n\t\t\t,id:startCtx.id\n\t\t});\n\t\tstartCtx.worker=null;\n\t\tdelete openList[startCtx.id];\n\t\t\n\t\t//疑似泄露检测 排除id\n\t\tvar opens=-1;\n\t\tfor(var k in openList){\n\t\t\topens++;\n\t\t};\n\t\tif(opens){\n\t\t\tconsole.warn(\"mp3 worker剩\"+opens+\"个在串行等待\");\n\t\t};\n\t};\n};\nRecorder.prototype.mp3_encode=function(startCtx,pcm){\n\tif(startCtx&&startCtx.worker){\n\t\tstartCtx.worker.postMessage({\n\t\t\taction:\"encode\"\n\t\t\t,id:startCtx.id\n\t\t\t,pcm:pcm\n\t\t});\n\t};\n};\nRecorder.prototype.mp3_complete=function(startCtx,True,False,autoStop){\n\tvar This=this;\n\tif(startCtx&&startCtx.worker){\n\t\tstartCtx.call=function(data){\n\t\t\tmp3TrimFixSetMeta(data.meta,startCtx.set);\n\t\t\tTrue(data.blob);\n\t\t\t\n\t\t\tif(autoStop){\n\t\t\t\tThis.mp3_stop(startCtx);\n\t\t\t};\n\t\t};\n\t\tstartCtx.worker.postMessage({\n\t\t\taction:\"complete\"\n\t\t\t,id:startCtx.id\n\t\t});\n\t}else{\n\t\tFalse(\"mp3编码器未打开\");\n\t};\n};\n\n\n\n\n\n\n\n//*******辅助函数************\n\n/*读取lamejs编码出来的mp3信息，只能读特定格式，如果读取失败返回null\nmp3Buffers=[ArrayBuffer,...]\nlength=mp3Buffers的数据二进制总长度\n*/\nRecorder.mp3ReadMeta=function(mp3Buffers,length){\n\t//kill babel-polyfill ES6 Number.parseInt 不然放到Worker里面找不到方法\n\tvar parseInt_ES3=typeof(window)==\"object\"?window.parseInt:self.parseInt;\n\t\n\tvar u8arr0=new Uint8Array(mp3Buffers[0]||[]);\n\tif(u8arr0.length<4){\n\t\treturn null;\n\t};\n\tvar byteAt=function(idx,u8){\n\t\treturn (\"0000000\"+((u8||u8arr0)[idx]||0).toString(2)).substr(-8);\n\t};\n\tvar b2=byteAt(0)+byteAt(1);\n\tvar b4=byteAt(2)+byteAt(3);\n\t\n\tif(!/^1{11}/.test(b2)){//未发现帧同步\n\t\treturn null;\n\t};\n\tvar version=({\"00\":2.5,\"10\":2,\"11\":1})[b2.substr(11,2)];\n\tvar layer=({\"01\":3})[b2.substr(13,2)];//仅支持Layer3\n\tvar sampleRate=({ //lamejs -> Tables.samplerate_table\n\t\t\"1\":[44100, 48000, 32000]\n\t\t,\"2\":[22050, 24000, 16000]\n\t\t,\"2.5\":[11025, 12000, 8000]\n\t})[version];\n\tsampleRate&&(sampleRate=sampleRate[parseInt_ES3(b4.substr(4,2),2)]);\n\tvar bitRate=[ //lamejs -> Tables.bitrate_table\n\t\t[0, 8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160] //MPEG 2 2.5\n\t\t,[0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320]//MPEG 1\n\t][version==1?1:0][parseInt_ES3(b4.substr(0,4),2)];\n\t\n\tif(!version || !layer || !bitRate || !sampleRate){\n\t\treturn null;\n\t};\n\t\n\tvar duration=Math.round(length*8/bitRate);\n\tvar frame=layer==1?384:layer==2?1152:version==1?1152:576;\n\tvar frameDurationFloat=frame/sampleRate*1000;\n\tvar frameSize=Math.floor((frame*bitRate)/8/sampleRate*1000);\n\t\n\t//检测是否存在Layer3帧填充1字节。这里只获取第二帧的填充信息，首帧永远没有填充。其他帧可能隔一帧出现一个填充，或者隔很多帧出现一个填充；目测是取决于frameSize未舍入时的小数部分，因为有些采样率的frameSize会出现小数（11025、22050、44100 典型的除不尽），然后字节数无法表示这种小数，就通过一定步长来填充弥补小数部分丢失\n\tvar hasPadding=0,seek=0;\n\tfor(var i=0;i<mp3Buffers.length;i++){\n\t\t//寻找第二帧\n\t\tvar buf=mp3Buffers[i];\n\t\tseek+=buf.byteLength;\n\t\tif(seek>=frameSize+3){\n\t\t\tvar buf8=new Uint8Array(buf);\n\t\t\tvar idx=buf.byteLength-(seek-(frameSize+3)+1);\n\t\t\tvar ib4=byteAt(idx,buf8);\n\t\t\thasPadding=ib4.charAt(6)==\"1\";\n\t\t\tbreak;\n\t\t};\n\t};\n\tif(hasPadding){\n\t\tframeSize++;\n\t};\n\t\n\t\n\treturn {\n\t\tversion:version //1 2 2.5 -> MPEG1 MPEG2 MPEG2.5\n\t\t,layer:layer//3 -> Layer3\n\t\t,sampleRate:sampleRate //采样率 hz\n\t\t,bitRate:bitRate //比特率 kbps\n\t\t\n\t\t,duration:duration //音频时长 ms\n\t\t,size:length //总长度 byte\n\t\t,hasPadding:hasPadding //是否存在1字节填充，首帧永远没有，这个值其实代表的第二帧是否有填充，并不代表其他帧的\n\t\t,frameSize:frameSize //每帧最大长度，含可能存在的1字节padding byte\n\t\t,frameDurationFloat:frameDurationFloat //每帧时长，含小数 ms\n\t};\n};\n\n//去掉lamejs开头的标记信息帧，免得mp3解码出来的时长比pcm的长太多\nvar mp3TrimFix={//minfiy keep name\nrm:Recorder.mp3ReadMeta\n,fn:function(mp3Buffers,length,pcmLength,pcmSampleRate){\n\tvar meta=this.rm(mp3Buffers,length);\n\tif(!meta){\n\t\treturn {err:\"mp3非预定格式\"};\n\t};\n\tvar pcmDuration=Math.round(pcmLength/pcmSampleRate*1000);\n\t\n\t//开头多出这么多帧，移除掉；正常情况下最多为2帧\n\tvar num=Math.floor((meta.duration-pcmDuration)/meta.frameDurationFloat);\n\tif(num>0){\n\t\tvar size=num*meta.frameSize-(meta.hasPadding?1:0);//首帧没有填充，第二帧可能有填充，这里假设最多为2帧（测试并未出现3帧以上情况），其他帧不管，就算出现了并且导致了错误后面自动容错\n\t\tlength-=size;\n\t\tvar arr0=0,arrs=[];\n\t\tfor(var i=0;i<mp3Buffers.length;i++){\n\t\t\tvar arr=mp3Buffers[i];\n\t\t\tif(size<=0){\n\t\t\t\tbreak;\n\t\t\t};\n\t\t\tif(size>=arr.byteLength){\n\t\t\t\tsize-=arr.byteLength;\n\t\t\t\tarrs.push(arr);\n\t\t\t\tmp3Buffers.splice(i,1);\n\t\t\t\ti--;\n\t\t\t}else{\n\t\t\t\tmp3Buffers[i]=arr.slice(size);\n\t\t\t\tarr0=arr;\n\t\t\t\tsize=0;\n\t\t\t};\n\t\t};\n\t\tvar checkMeta=this.rm(mp3Buffers,length);\n\t\tif(!checkMeta){\n\t\t\t//还原变更，应该不太可能会出现\n\t\t\tarr0&&(mp3Buffers[0]=arr0);\n\t\t\tfor(var i=0;i<arrs.length;i++){\n\t\t\t\tmp3Buffers.splice(i,0,arrs[i]);\n\t\t\t};\n\t\t\tmeta.err=\"fix后数据错误，已还原，错误原因不明\";\n\t\t};\n\t\t\n\t\tvar fix=meta.trimFix={};\n\t\tfix.remove=num;\n\t\tfix.removeDuration=Math.round(num*meta.frameDurationFloat);\n\t\tfix.duration=Math.round(length*8/meta.bitRate);\n\t};\n\treturn meta;\n}\n};\nvar mp3TrimFixSetMeta=function(meta,set){\n\tvar tag=\"MP3信息 \";\n\tif(meta.sampleRate&&meta.sampleRate!=set.sampleRate || meta.bitRate&&meta.bitRate!=set.bitRate){\n\t\tconsole.warn(tag+\"和设置的不匹配set:\"+set.bitRate+\"kbps \"+set.sampleRate+\"hz，已更新set:\"+meta.bitRate+\"kbps \"+meta.sampleRate+\"hz\",set);\n\t\tset.sampleRate=meta.sampleRate;\n\t\tset.bitRate=meta.bitRate;\n\t};\n\t\n\tvar trimFix=meta.trimFix;\n\tif(trimFix){\n\t\ttag+=\"Fix移除\"+trimFix.remove+\"帧\"+trimFix.removeDuration+\"ms -> \"+trimFix.duration+\"ms\";\n\t\tif(trimFix.remove>2){\n\t\t\tmeta.err=(meta.err?meta.err+\", \":\"\")+\"移除帧数过多\";\n\t\t};\n\t}else{\n\t\ttag+=(meta.duration||\"-\")+\"ms\";\n\t};\n\t\n\tif(meta.err){\n\t\tconsole.error(tag,meta.err,meta);\n\t}else{\n\t\tconsole.log(tag,meta);\n\t};\n};\n\n\n\t\n})();","/*\n录音\nhttps://github.com/xiangyuecn/Recorder\n*/\n(function(factory){\n\tfactory(window);\n\t//umd returnExports.js\n\tif(typeof(define)=='function' && define.amd){\n\t\tdefine(function(){\n\t\t\treturn Recorder;\n\t\t});\n\t};\n\tif(typeof(module)=='object' && module.exports){\n\t\tmodule.exports=Recorder;\n\t};\n}(function(window){\n\"use strict\";\n\n//兼容环境\nvar LM=\"2020-11-15 21:36:11\";\nvar NOOP=function(){};\n//end 兼容环境 ****从以下开始copy源码*****\n\nvar Recorder=function(set){\n\treturn new initFn(set);\n};\n//是否已经打开了录音，所有工作都已经准备好了，就等接收音频数据了\nRecorder.IsOpen=function(){\n\tvar stream=Recorder.Stream;\n\tif(stream){\n\t\tvar tracks=stream.getTracks&&stream.getTracks()||stream.audioTracks||[];\n\t\tvar track=tracks[0];\n\t\tif(track){\n\t\t\tvar state=track.readyState;\n\t\t\treturn state==\"live\"||state==track.LIVE;\n\t\t};\n\t};\n\treturn false;\n};\n/*H5录音时的AudioContext缓冲大小。会影响H5录音时的onProcess调用速率，相对于AudioContext.sampleRate=48000时，4096接近12帧/s，调节此参数可生成比较流畅的回调动画。\n\t取值256, 512, 1024, 2048, 4096, 8192, or 16384\n\t注意，取值不能过低，2048开始不同浏览器可能回调速率跟不上造成音质问题。\n\t一般无需调整，调整后需要先close掉已打开的录音，再open时才会生效。\n*/\nRecorder.BufferSize=4096;\n//销毁已持有的所有全局资源，当要彻底移除Recorder时需要显式的调用此方法\nRecorder.Destroy=function(){\n\tCLog(\"Recorder Destroy\");\n\tfor(var k in DestroyList){\n\t\tDestroyList[k]();\n\t};\n};\nvar DestroyList={};\n//登记一个需要销毁全局资源的处理方法\nRecorder.BindDestroy=function(key,call){\n\tDestroyList[key]=call;\n};\n//判断浏览器是否支持录音，随时可以调用。注意：仅仅是检测浏览器支持情况，不会判断和调起用户授权，不会判断是否支持特定格式录音。\nRecorder.Support=function(){\n\tvar AC=window.AudioContext;\n\tif(!AC){\n\t\tAC=window.webkitAudioContext;\n\t};\n\tif(!AC){\n\t\treturn false;\n\t};\n\tvar scope=navigator.mediaDevices||{};\n\tif(!scope.getUserMedia){\n\t\tscope=navigator;\n\t\tscope.getUserMedia||(scope.getUserMedia=scope.webkitGetUserMedia||scope.mozGetUserMedia||scope.msGetUserMedia);\n\t};\n\tif(!scope.getUserMedia){\n\t\treturn false;\n\t};\n\t\n\tRecorder.Scope=scope;\n\tif(!Recorder.Ctx||Recorder.Ctx.state==\"closed\"){\n\t\t//不能反复构造，低版本number of hardware contexts reached maximum (6)\n\t\tRecorder.Ctx=new AC();\n\t\t\n\t\tRecorder.BindDestroy(\"Ctx\",function(){\n\t\t\tvar ctx=Recorder.Ctx;\n\t\t\tctx&&ctx.close&&ctx.close();\n\t\t});\n\t};\n\treturn true;\n};\n/*初始化H5音频采集连接，因为Stream是全局的，Safari上断开后就无法再次进行连接使用，表现为静音，因此使用全部使用全局处理避免调用到disconnect；全局处理也有利于屏蔽底层细节，start时无需再调用底层接口，提升兼容、可靠性。*/\nvar Connect=function(){\n\tvar ctx=Recorder.Ctx,stream=Recorder.Stream;\n\tvar media=stream._m=ctx.createMediaStreamSource(stream);\n\tvar process=stream._p=(ctx.createScriptProcessor||ctx.createJavaScriptNode).call(ctx,Recorder.BufferSize,1,1);//单声道，省的数据处理复杂\n\t\n\tmedia.connect(process);\n\tprocess.connect(ctx.destination);\n\t\n\tvar calls=stream._call;\n\tprocess.onaudioprocess=function(e){\n\t\tfor(var k0 in calls){//has item\n\t\t\tvar o=e.inputBuffer.getChannelData(0);//块是共享的，必须复制出来\n\t\t\tvar size=o.length;\n\t\t\t\n\t\t\tvar pcm=new Int16Array(size);\n\t\t\tvar sum=0;\n\t\t\tfor(var j=0;j<size;j++){//floatTo16BitPCM \n\t\t\t\tvar s=Math.max(-1,Math.min(1,o[j]));\n\t\t\t\ts=s<0?s*0x8000:s*0x7FFF;\n\t\t\t\tpcm[j]=s;\n\t\t\t\tsum+=Math.abs(s);\n\t\t\t};\n\t\t\t\n\t\t\tfor(var k in calls){\n\t\t\t\tcalls[k](pcm,sum);\n\t\t\t};\n\t\t\t\n\t\t\treturn;\n\t\t};\n\t};\n};\nvar Disconnect=function(){\n\tvar stream=Recorder.Stream;\n\tif(stream._m){\n\t\tstream._m.disconnect();\n\t\tstream._p.disconnect();\n\t\tstream._p.onaudioprocess=stream._p=stream._m=null;\n\t};\n};\n\n/*对pcm数据的采样率进行转换\npcmDatas: [[Int16,...]] pcm片段列表\npcmSampleRate:48000 pcm数据的采样率\nnewSampleRate:16000 需要转换成的采样率，newSampleRate>=pcmSampleRate时不会进行任何处理，小于时会进行重新采样\nprevChunkInfo:{} 可选，上次调用时的返回值，用于连续转换，本次调用将从上次结束位置开始进行处理。或可自行定义一个ChunkInfo从pcmDatas指定的位置开始进行转换\noption:{ 可选，配置项\n\t\tframeSize:123456 帧大小，每帧的PCM Int16的数量，采样率转换后的pcm长度为frameSize的整数倍，用于连续转换。目前仅在mp3格式时才有用，frameSize取值为1152，这样编码出来的mp3时长和pcm的时长完全一致，否则会因为mp3最后一帧录音不够填满时添加填充数据导致mp3的时长变长。\n\t\tframeType:\"\" 帧类型，一般为rec.set.type，提供此参数时无需提供frameSize，会自动使用最佳的值给frameSize赋值，目前仅支持mp3=1152(MPEG1 Layer3的每帧采采样数)，其他类型=1。\n\t\t\t以上两个参数用于连续转换时使用，最多使用一个，不提供时不进行帧的特殊处理，提供时必须同时提供prevChunkInfo才有作用。最后一段数据处理时无需提供帧大小以便输出最后一丁点残留数据。\n\t}\n\n返回ChunkInfo:{\n\t//可定义，从指定位置开始转换到结尾\n\tindex:0 pcmDatas已处理到的索引\n\toffset:0.0 已处理到的index对应的pcm中的偏移的下一个位置\n\t\n\t//仅作为返回值\n\tframeNext:null||[Int16,...] 下一帧的部分数据，frameSize设置了的时候才可能会有\n\tsampleRate:16000 结果的采样率，<=newSampleRate\n\tdata:[Int16,...] 转换后的PCM结果；如果是连续转换，并且pcmDatas中并没有新数据时，data的长度可能为0\n}\n*/\nRecorder.SampleData=function(pcmDatas,pcmSampleRate,newSampleRate,prevChunkInfo,option){\n\tprevChunkInfo||(prevChunkInfo={});\n\tvar index=prevChunkInfo.index||0;\n\tvar offset=prevChunkInfo.offset||0;\n\t\n\tvar frameNext=prevChunkInfo.frameNext||[];\n\toption||(option={});\n\tvar frameSize=option.frameSize||1;\n\tif(option.frameType){\n\t\tframeSize=option.frameType==\"mp3\"?1152:1;\n\t};\n\t\n\tvar size=0;\n\tfor(var i=index;i<pcmDatas.length;i++){\n\t\tsize+=pcmDatas[i].length;\n\t};\n\tsize=Math.max(0,size-Math.floor(offset));\n\t\n\t//采样 https://www.cnblogs.com/blqw/p/3782420.html\n\tvar step=pcmSampleRate/newSampleRate;\n\tif(step>1){//新采样低于录音采样，进行抽样\n\t\tsize=Math.floor(size/step);\n\t}else{//新采样高于录音采样不处理，省去了插值处理\n\t\tstep=1;\n\t\tnewSampleRate=pcmSampleRate;\n\t};\n\t\n\tsize+=frameNext.length;\n\tvar res=new Int16Array(size);\n\tvar idx=0;\n\t//添加上一次不够一帧的剩余数据\n\tfor(var i=0;i<frameNext.length;i++){\n\t\tres[idx]=frameNext[i];\n\t\tidx++;\n\t};\n\t//处理数据\n\tfor (var nl=pcmDatas.length;index<nl;index++) {\n\t\tvar o=pcmDatas[index];\n\t\tvar i=offset,il=o.length;\n\t\twhile(i<il){\n\t\t\t//res[idx]=o[Math.round(i)]; 直接简单抽样\n\t\t\t\n\t\t\t//https://www.cnblogs.com/xiaoqi/p/6993912.html\n\t\t\t//当前点=当前点+到后面一个点之间的增量，音质比直接简单抽样好些\n\t\t\tvar before = Math.floor(i);\n\t\t\tvar after = Math.ceil(i);\n\t\t\tvar atPoint = i - before;\n\t\t\t\n\t\t\tvar beforeVal=o[before];\n\t\t\tvar afterVal=after<il ? o[after]\n\t\t\t\t: (//后个点越界了，查找下一个数组\n\t\t\t\t\t(pcmDatas[index+1]||[beforeVal])[0]||0\n\t\t\t\t);\n\t\t\tres[idx]=beforeVal+(afterVal-beforeVal)*atPoint;\n\t\t\t\n\t\t\tidx++;\n\t\t\ti+=step;//抽样\n\t\t};\n\t\toffset=i-il;\n\t};\n\t//帧处理\n\tframeNext=null;\n\tvar frameNextSize=res.length%frameSize;\n\tif(frameNextSize>0){\n\t\tvar u8Pos=(res.length-frameNextSize)*2;\n\t\tframeNext=new Int16Array(res.buffer.slice(u8Pos));\n\t\tres=new Int16Array(res.buffer.slice(0,u8Pos));\n\t};\n\t\n\treturn {\n\t\tindex:index\n\t\t,offset:offset\n\t\t\n\t\t,frameNext:frameNext\n\t\t,sampleRate:newSampleRate\n\t\t,data:res\n\t};\n};\n\n\n/*计算音量百分比的一个方法\npcmAbsSum: pcm Int16所有采样的绝对值的和\npcmLength: pcm长度\n返回值：0-100，主要当做百分比用\n注意：这个不是分贝，因此没用volume当做名称*/\nRecorder.PowerLevel=function(pcmAbsSum,pcmLength){\n\t/*计算音量 https://blog.csdn.net/jody1989/article/details/73480259\n\t更高灵敏度算法:\n\t\t限定最大感应值10000\n\t\t\t线性曲线：低音量不友好\n\t\t\t\tpower/10000*100 \n\t\t\t对数曲线：低音量友好，但需限定最低感应值\n\t\t\t\t(1+Math.log10(power/10000))*100\n\t*/\n\tvar power=(pcmAbsSum/pcmLength) || 0;//NaN\n\tvar level;\n\tif(power<1251){//1250的结果10%，更小的音量采用线性取值\n\t\tlevel=Math.round(power/1250*10);\n\t}else{\n\t\tlevel=Math.round(Math.min(100,Math.max(0,(1+Math.log(power/10000)/Math.log(10))*100)));\n\t};\n\treturn level;\n};\n\n\n\n\n//带时间的日志输出，CLog(msg,errOrLogMsg, logMsg...) err为数字时代表日志类型1:error 2:log默认 3:warn，否则当做内容输出，第一个参数不能是对象因为要拼接时间，后面可以接无数个输出参数\nvar CLog=function(msg,err){\n\tvar now=new Date();\n\tvar t=(\"0\"+now.getMinutes()).substr(-2)\n\t\t+\":\"+(\"0\"+now.getSeconds()).substr(-2)\n\t\t+\".\"+(\"00\"+now.getMilliseconds()).substr(-3);\n\tvar arr=[\"[\"+t+\" Recorder]\"+msg];\n\tvar a=arguments;\n\tvar i=2,fn=console.log;\n\tif(typeof(err)==\"number\"){\n\t\tfn=err==1?console.error:err==3?console.warn:fn;\n\t}else{\n\t\ti=1;\n\t};\n\tfor(;i<a.length;i++){\n\t\tarr.push(a[i]);\n\t};\n\tfn.apply(console,arr);\n};\nRecorder.CLog=CLog;\n\n\n\n\nvar ID=0;\nfunction initFn(set){\n\tthis.id=++ID;\n\t\n\t//如果开启了流量统计，这里将发送一个图片请求\n\tRecorder.Traffic&&Recorder.Traffic();\n\t\n\t\n\tvar o={\n\t\ttype:\"mp3\" //输出类型：mp3,wav，wav输出文件尺寸超大不推荐使用，但mp3编码支持会导致js文件超大，如果不需支持mp3可以使js文件大幅减小\n\t\t,bitRate:16 //比特率 wav:16或8位，MP3：8kbps 1k/s，8kbps 2k/s 录音文件很小\n\t\t\n\t\t,sampleRate:16000 //采样率，wav格式大小=sampleRate*时间；mp3此项对低比特率有影响，高比特率几乎无影响。\n\t\t\t\t\t//wav任意值，mp3取值范围：48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000\n\t\t\t\t\t//采样率参考https://www.cnblogs.com/devin87/p/mp3-recorder.html\n\t\t\n\t\t,onProcess:NOOP //fn(buffers,powerLevel,bufferDuration,bufferSampleRate,newBufferIdx,asyncEnd) buffers=[[Int16,...],...]：缓冲的PCM数据，为从开始录音到现在的所有pcm片段；powerLevel：当前缓冲的音量级别0-100，bufferDuration：已缓冲时长，bufferSampleRate：缓冲使用的采样率（当type支持边录边转码(Worker)时，此采样率和设置的采样率相同，否则不一定相同）；newBufferIdx:本次回调新增的buffer起始索引；asyncEnd:fn() 如果onProcess是异步的(返回值为true时)，处理完成时需要调用此回调，如果不是异步的请忽略此参数，此方法回调时必须是真异步（不能真异步时需用setTimeout包裹）。onProcess返回值：如果返回true代表开启异步模式，在某些大量运算的场合异步是必须的，必须在异步处理完成时调用asyncEnd(不能真异步时需用setTimeout包裹)，在onProcess执行后新增的buffer会全部替换成空数组，因此本回调开头应立即将newBufferIdx到本次回调结尾位置的buffer全部保存到另外一个数组内，处理完成后写回buffers中本次回调的结尾位置。\n\t\t\n\t\t//*******高级设置******\n\t\t//,disableEnvInFix:false 内部参数，禁用设备卡顿时音频输入丢失补偿功能\n\t\t\n\t\t//,takeoffEncodeChunk:NOOP //fn(chunkBytes) chunkBytes=[Uint8,...]：实时编码环境下接管编码器输出，当编码器实时编码出一块有效的二进制音频数据时实时回调此方法；参数为二进制的Uint8Array，就是编码出来的音频数据片段，所有的chunkBytes拼接在一起即为完整音频。本实现的想法最初由QQ2543775048提出\n\t\t\t\t//当提供此回调方法时，将接管编码器的数据输出，编码器内部将放弃存储生成的音频数据；环境要求比较苛刻：如果当前环境不支持实时编码处理，将在open时直接走fail逻辑\n\t\t\t\t//因此提供此回调后调用stop方法将无法获得有效的音频数据，因为编码器内没有音频数据，因此stop时返回的blob将是一个字节长度为0的blob\n\t\t\t\t//目前只有mp3格式实现了实时编码，在支持实时处理的环境中将会实时的将编码出来的mp3片段通过此方法回调，所有的chunkBytes拼接到一起即为完整的mp3，此种拼接的结果比mock方法实时生成的音质更加，因为天然避免了首尾的静默\n\t\t\t\t//目前除mp3外其他格式不可以提供此回调，提供了将在open时直接走fail逻辑\n\t};\n\t\n\tfor(var k in set){\n\t\to[k]=set[k];\n\t};\n\tthis.set=o;\n\t\n\tthis._S=9;//stop同步锁，stop可以阻止open过程中还未运行的start\n};\n//同步锁，控制对Stream的竞争；用于close时中断异步的open；一个对象open如果变化了都要阻止close，Stream的控制权交个新的对象\nRecorder.Sync={/*open*/O:9,/*close*/C:9};\n\nRecorder.prototype=initFn.prototype={\n\t//打开录音资源True(),False(msg,isUserNotAllow)，需要调用close。注意：此方法是异步的；一般使用时打开，用完立即关闭；可重复调用，可用来测试是否能录音\n\topen:function(True,False){\n\t\tvar This=this;\n\t\tTrue=True||NOOP;\n\t\tvar failCall=function(errMsg,isUserNotAllow){\n\t\t\tisUserNotAllow=!!isUserNotAllow;\n\t\t\tCLog(\"录音open失败：\"+errMsg+\",isUserNotAllow:\"+isUserNotAllow,1);\n\t\t\tFalse&&False(errMsg,isUserNotAllow);\n\t\t};\n\t\t\n\t\tvar ok=function(){\n\t\t\tCLog(\"open成功\");\n\t\t\tTrue();\n\t\t\t\n\t\t\tThis._SO=0;//解除stop对open中的start调用的阻止\n\t\t};\n\t\tvar codeFail=function(code,msg){\n\t\t\ttry{//跨域的优先检测一下\n\t\t\t\twindow.top.a;\n\t\t\t}catch(e){\n\t\t\t\tfailCall('无权录音(跨域，请尝试给iframe添加麦克风访问策略，如allow=\"camera;microphone\")');\n\t\t\t\treturn;\n\t\t\t};\n\t\t\t\n\t\t\tif(/Permission|Allow/i.test(code)){\n\t\t\t\tfailCall(\"用户拒绝了录音权限\",true);\n\t\t\t}else if(window.isSecureContext===false){\n\t\t\t\tfailCall(\"无权录音(需https)\");\n\t\t\t}else if(/Found/i.test(code)){//可能是非安全环境导致的没有设备\n\t\t\t\tfailCall(msg+\"，无可用麦克风\");\n\t\t\t}else{\n\t\t\t\tfailCall(msg);\n\t\t\t};\n\t\t};\n\t\t\n\t\t//同步锁\n\t\tvar Lock=Recorder.Sync;\n\t\tvar lockOpen=++Lock.O,lockClose=Lock.C;\n\t\tThis._O=This._O_=lockOpen;//记住当前的open，如果变化了要阻止close，这里假定了新对象已取代当前对象并且不再使用\n\t\tThis._SO=This._S;//记住open过程中的stop，中途任何stop调用后都不能继续open中的start\n\t\tvar lockFail=function(){\n\t\t\t//允许多次open，但不允许任何一次close，或者自身已经调用了关闭\n\t\t\tif(lockClose!=Lock.C || !This._O){\n\t\t\t\tvar err=\"open被取消\";\n\t\t\t\tif(lockOpen==Lock.O){\n\t\t\t\t\t//无新的open，已经调用了close进行取消，此处应让上次的close明确生效\n\t\t\t\t\tThis.close();\n\t\t\t\t}else{\n\t\t\t\t\terr=\"open被中断\";\n\t\t\t\t};\n\t\t\t\tfailCall(err);\n\t\t\t\treturn true;\n\t\t\t};\n\t\t};\n\t\t\n\t\t\n\t\t//如果已打开就不要再打开了\n\t\tif(Recorder.IsOpen()){\n\t\t\tok();\n\t\t\treturn;\n\t\t};\n\t\tif(!Recorder.Support()){\n\t\t\tcodeFail(\"\",\"此浏览器不支持录音\");\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//环境配置检查\n\t\tvar checkMsg=This.envCheck({envName:\"H5\",canProcess:true});\n\t\tif(checkMsg){\n\t\t\tfailCall(\"不能录音：\"+checkMsg);\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//请求权限，如果从未授权，一般浏览器会弹出权限请求弹框\n\t\tvar f1=function(stream){\n\t\t\tRecorder.Stream=stream;\n\t\t\tstream._call={};//此时is open，但并未connect，是允许绑定接收数据的\n\t\t\tif(lockFail())return;\n\t\t\t\n\t\t\t//https://github.com/xiangyuecn/Recorder/issues/14 获取到的track.readyState!=\"live\"，刚刚回调时可能是正常的，但过一下可能就被关掉了，原因不明。延迟一下保证真异步。对正常浏览器不影响\n\t\t\tsetTimeout(function(){\n\t\t\t\tif(lockFail())return;\n\t\t\t\t\n\t\t\t\tif(Recorder.IsOpen()){\n\t\t\t\t\tConnect();\n\t\t\t\t\tok();\n\t\t\t\t}else{\n\t\t\t\t\tfailCall(\"录音功能无效：无音频流\");\n\t\t\t\t};\n\t\t\t},100);\n\t\t};\n\t\tvar f2=function(e){\n\t\t\tvar code=e.name||e.message||e.code+\":\"+e;\n\t\t\tCLog(\"请求录音权限错误\",1,e);\n\t\t\t\n\t\t\tcodeFail(code,\"无法录音：\"+code);\n\t\t};\n\t\tvar pro=Recorder.Scope.getUserMedia({audio:true},f1,f2);\n\t\tif(pro&&pro.then){\n\t\t\tpro.then(f1)[True&&\"catch\"](f2); //fix 关键字，保证catch压缩时保持字符串形式\n\t\t};\n\t}\n\t//关闭释放录音资源\n\t,close:function(call){\n\t\tcall=call||NOOP;\n\t\t\n\t\tvar This=this;\n\t\tThis._stop();\n\t\t\n\t\tvar Lock=Recorder.Sync;\n\t\tThis._O=0;\n\t\tif(This._O_!=Lock.O){\n\t\t\t//唯一资源Stream的控制权已交给新对象，这里不能关闭。此处在每次都弹权限的浏览器内可能存在泄漏，新对象被拒绝权限可能不会调用close，忽略这种不处理\n\t\t\tCLog(\"close被忽略\",3);\n\t\t\tcall();\n\t\t\treturn;\n\t\t};\n\t\tLock.C++;//获得控制权\n\t\t\n\t\tvar stream=Recorder.Stream;\n\t\tif(stream){\n\t\t\tDisconnect();\n\t\t\t\n\t\t\tvar tracks=stream.getTracks&&stream.getTracks()||stream.audioTracks||[];\n\t\t\tfor(var i=0;i<tracks.length;i++){\n\t\t\t\tvar track=tracks[i];\n\t\t\t\ttrack.stop&&track.stop();\n\t\t\t};\n\t\t\tstream.stop&&stream.stop();\n\t\t};\n\t\t\n\t\tRecorder.Stream=0;\n\t\tCLog(\"close\");\n\t\tcall();\n\t}\n\t\n\t\n\t\n\t\n\t\n\t/*模拟一段录音数据，后面可以调用stop进行编码，需提供pcm数据[1,2,3...]，pcm的采样率*/\n\t,mock:function(pcmData,pcmSampleRate){\n\t\tvar This=this;\n\t\tThis._stop();//清理掉已有的资源\n\t\t\n\t\tThis.isMock=1;\n\t\tThis.mockEnvInfo=null;\n\t\tThis.buffers=[pcmData];\n\t\tThis.recSize=pcmData.length;\n\t\tThis.srcSampleRate=pcmSampleRate;\n\t\treturn This;\n\t}\n\t,envCheck:function(envInfo){//平台环境下的可用性检查，任何时候都可以调用检查，返回errMsg:\"\"正常，\"失败原因\"\n\t\t//envInfo={envName:\"H5\",canProcess:true}\n\t\tvar errMsg,This=this,set=This.set;\n\t\t\n\t\t//编码器检查环境下配置是否可用\n\t\tif(!errMsg){\n\t\t\tif(This[set.type+\"_envCheck\"]){//编码器已实现环境检查\n\t\t\t\terrMsg=This[set.type+\"_envCheck\"](envInfo,set);\n\t\t\t}else{//未实现检查的手动检查配置是否有效\n\t\t\t\tif(set.takeoffEncodeChunk){\n\t\t\t\t\terrMsg=set.type+\"类型不支持设置takeoffEncodeChunk\";\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t\t\n\t\treturn errMsg||\"\";\n\t}\n\t,envStart:function(mockEnvInfo,sampleRate){//平台环境相关的start调用\n\t\tvar This=this,set=This.set;\n\t\tThis.isMock=mockEnvInfo?1:0;//非H5环境需要启用mock，并提供envCheck需要的环境信息\n\t\tThis.mockEnvInfo=mockEnvInfo;\n\t\tThis.buffers=[];//数据缓冲\n\t\tThis.recSize=0;//数据大小\n\t\t\n\t\tThis.envInLast=0;//envIn接收到最后录音内容的时间\n\t\tThis.envInFirst=0;//envIn接收到的首个录音内容的录制时间\n\t\tThis.envInFix=0;//补偿的总时间\n\t\tThis.envInFixTs=[];//补偿计数列表\n\t\t\n\t\tset.sampleRate=Math.min(sampleRate,set.sampleRate);//engineCtx需要提前确定最终的采样率\n\t\tThis.srcSampleRate=sampleRate;\n\t\t\n\t\tThis.engineCtx=0;\n\t\t//此类型有边录边转码(Worker)支持\n\t\tif(This[set.type+\"_start\"]){\n\t\t\tvar engineCtx=This.engineCtx=This[set.type+\"_start\"](set);\n\t\t\tif(engineCtx){\n\t\t\t\tengineCtx.pcmDatas=[];\n\t\t\t\tengineCtx.pcmSize=0;\n\t\t\t};\n\t\t};\n\t}\n\t,envResume:function(){//和平台环境无关的恢复录音\n\t\t//重新开始计数\n\t\tthis.envInFixTs=[];\n\t}\n\t,envIn:function(pcm,sum){//和平台环境无关的pcm[Int16]输入\n\t\tvar This=this,set=This.set,engineCtx=This.engineCtx;\n\t\tvar bufferSampleRate=This.srcSampleRate;\n\t\tvar size=pcm.length;\n\t\tvar powerLevel=Recorder.PowerLevel(sum,size);\n\t\t\n\t\tvar buffers=This.buffers;\n\t\tvar bufferFirstIdx=buffers.length;//之前的buffer都是经过onProcess处理好的，不允许再修改\n\t\tbuffers.push(pcm);\n\t\t\n\t\t//有engineCtx时会被覆盖，这里保存一份\n\t\tvar buffersThis=buffers;\n\t\tvar bufferFirstIdxThis=bufferFirstIdx;\n\t\t\n\t\t//卡顿丢失补偿：因为设备很卡的时候导致H5接收到的数据量不够造成播放时候变速，结果比实际的时长要短，此处保证了不会变短，但不能修复丢失的音频数据造成音质变差。当前算法采用输入时间侦测下一帧是否需要添加补偿帧，需要(6次输入||超过1秒)以上才会开始侦测，如果滑动窗口内丢失超过1/3就会进行补偿\n\t\tvar now=Date.now();\n\t\tvar pcmTime=Math.round(size/bufferSampleRate*1000);\n\t\tThis.envInLast=now;\n\t\tif(This.buffers.length==1){//记下首个录音数据的录制时间\n\t\t\tThis.envInFirst=now-pcmTime;\n\t\t};\n\t\tvar envInFixTs=This.envInFixTs;\n\t\tenvInFixTs.splice(0,0,{t:now,d:pcmTime});\n\t\t//保留3秒的计数滑动窗口，另外超过3秒的停顿不补偿\n\t\tvar tsInStart=now,tsPcm=0;\n\t\tfor(var i=0;i<envInFixTs.length;i++){\n\t\t\tvar o=envInFixTs[i];\n\t\t\tif(now-o.t>3000){\n\t\t\t\tenvInFixTs.length=i;\n\t\t\t\tbreak;\n\t\t\t};\n\t\t\ttsInStart=o.t;\n\t\t\ttsPcm+=o.d;\n\t\t};\n\t\t//达到需要的数据量，开始侦测是否需要补偿\n\t\tvar tsInPrev=envInFixTs[1];\n\t\tvar tsIn=now-tsInStart;\n\t\tvar lost=tsIn-tsPcm;\n\t\tif( lost>tsIn/3 && (tsInPrev&&tsIn>1000 || envInFixTs.length>=6) ){\n\t\t\t//丢失过多，开始执行补偿\n\t\t\tvar addTime=now-tsInPrev.t-pcmTime;//距离上次输入丢失这么多ms\n\t\t\tif(addTime>pcmTime/5){//丢失超过本帧的1/5\n\t\t\t\tvar fixOpen=!set.disableEnvInFix;\n\t\t\t\tCLog(\"[\"+now+\"]\"+(fixOpen?\"\":\"未\")+\"补偿\"+addTime+\"ms\",3);\n\t\t\t\tThis.envInFix+=addTime;\n\t\t\t\t\n\t\t\t\t//用静默进行补偿\n\t\t\t\tif(fixOpen){\n\t\t\t\t\tvar addPcm=new Int16Array(addTime*bufferSampleRate/1000);\n\t\t\t\t\tsize+=addPcm.length;\n\t\t\t\t\tbuffers.push(addPcm);\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t\t\n\t\t\n\t\tvar sizeOld=This.recSize,addSize=size;\n\t\tvar bufferSize=sizeOld+addSize;\n\t\tThis.recSize=bufferSize;//此值在onProcess后需要修正，可能新数据被修改\n\t\t\n\t\t\n\t\t//此类型有边录边转码(Worker)支持，开启实时转码\n\t\tif(engineCtx){\n\t\t\t//转换成set的采样率\n\t\t\tvar chunkInfo=Recorder.SampleData(buffers,bufferSampleRate,set.sampleRate,engineCtx.chunkInfo);\n\t\t\tengineCtx.chunkInfo=chunkInfo;\n\t\t\t\n\t\t\tsizeOld=engineCtx.pcmSize;\n\t\t\taddSize=chunkInfo.data.length;\n\t\t\tbufferSize=sizeOld+addSize;\n\t\t\tengineCtx.pcmSize=bufferSize;//此值在onProcess后需要修正，可能新数据被修改\n\t\t\t\n\t\t\tbuffers=engineCtx.pcmDatas;\n\t\t\tbufferFirstIdx=buffers.length;\n\t\t\tbuffers.push(chunkInfo.data);\n\t\t\tbufferSampleRate=chunkInfo.sampleRate;\n\t\t};\n\t\t\n\t\tvar duration=Math.round(bufferSize/bufferSampleRate*1000);\n\t\tvar bufferNextIdx=buffers.length;\n\t\tvar bufferNextIdxThis=buffersThis.length;\n\t\t\n\t\t//允许异步处理buffer数据\n\t\tvar asyncEnd=function(){\n\t\t\t//重新计算size，异步的早已减去添加的，同步的需去掉本次添加的然后重新计算\n\t\t\tvar num=asyncBegin?0:-addSize;\n\t\t\tvar hasClear=buffers[0]==null;\n\t\t\tfor(var i=bufferFirstIdx;i<bufferNextIdx;i++){\n\t\t\t\tvar buffer=buffers[i];\n\t\t\t\tif(buffer==null){//已被主动释放内存，比如长时间实时传输录音时\n\t\t\t\t\thasClear=1;\n\t\t\t\t}else{\n\t\t\t\t\tnum+=buffer.length;\n\t\t\t\t\t\n\t\t\t\t\t//推入后台边录边转码\n\t\t\t\t\tif(engineCtx&&buffer.length){\n\t\t\t\t\t\tThis[set.type+\"_encode\"](engineCtx,buffer);\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t};\n\t\t\t\n\t\t\t//同步清理This.buffers，不管buffers到底清了多少个，buffersThis是使用不到的进行全清\n\t\t\tif(hasClear && engineCtx){\n\t\t\t\tvar i=bufferFirstIdxThis;\n\t\t\t\tif(buffersThis[0]){\n\t\t\t\t\ti=0;\n\t\t\t\t};\n\t\t\t\tfor(;i<bufferNextIdxThis;i++){\n\t\t\t\t\tbuffersThis[i]=null;\n\t\t\t\t};\n\t\t\t};\n\t\t\t\n\t\t\t//统计修改后的size，如果异步发生clear要原样加回来，同步的无需操作\n\t\t\tif(hasClear){\n\t\t\t\tnum=asyncBegin?addSize:0;\n\t\t\t\t\n\t\t\t\tbuffers[0]=null;//彻底被清理\n\t\t\t};\n\t\t\tif(engineCtx){\n\t\t\t\tengineCtx.pcmSize+=num;\n\t\t\t}else{\n\t\t\t\tThis.recSize+=num;\n\t\t\t};\n\t\t};\n\t\t//实时回调处理数据，允许修改或替换上次回调以来新增的数据 ，但是不允许修改已处理过的，不允许增删第一维数组 ，允许将第二维数组任意修改替换成空数组也可以\n\t\tvar asyncBegin=set.onProcess(buffers,powerLevel,duration,bufferSampleRate,bufferFirstIdx,asyncEnd);\n\t\t\n\t\tif(asyncBegin===true){\n\t\t\t//开启了异步模式，onProcess已接管buffers新数据，立即清空，避免出现未处理的数据\n\t\t\tvar hasClear=0;\n\t\t\tfor(var i=bufferFirstIdx;i<bufferNextIdx;i++){\n\t\t\t\tif(buffers[i]==null){//已被主动释放内存，比如长时间实时传输录音时 ，但又要开启异步模式，此种情况是非法的\n\t\t\t\t\thasClear=1;\n\t\t\t\t}else{\n\t\t\t\t\tbuffers[i]=new Int16Array(0);\n\t\t\t\t};\n\t\t\t};\n\t\t\t\n\t\t\tif(hasClear){\n\t\t\t\tCLog(\"未进入异步前不能清除buffers\",3);\n\t\t\t}else{\n\t\t\t\t//还原size，异步结束后再统计仅修改后的size，如果发生clear要原样加回来\n\t\t\t\tif(engineCtx){\n\t\t\t\t\tengineCtx.pcmSize-=addSize;\n\t\t\t\t}else{\n\t\t\t\t\tThis.recSize-=addSize;\n\t\t\t\t};\n\t\t\t};\n\t\t}else{\n\t\t\tasyncEnd();\n\t\t};\n\t}\n\t\n\t\n\t\n\t\n\t//开始录音，需先调用open；只要open成功时，调用此方法是安全的，如果未open强行调用导致的内部错误将不会有任何提示，stop时自然能得到错误\n\t,start:function(){\n\t\tif(!Recorder.IsOpen()){\n\t\t\tCLog(\"未open\",1);\n\t\t\treturn;\n\t\t};\n\t\tCLog(\"开始录音\");\n\t\t\n\t\tvar This=this,set=This.set,ctx=Recorder.Ctx;\n\t\tThis._stop();\n\t\tThis.state=0;\n\t\tThis.envStart(null,ctx.sampleRate);\n\t\t\n\t\t//检查open过程中stop是否已经调用过\n\t\tif(This._SO&&This._SO+1!=This._S){//上面调用过一次 _stop\n\t\t\t//open未完成就调用了stop，此种情况终止start。也应尽量避免出现此情况\n\t\t\tCLog(\"start被中断\",3);\n\t\t\treturn;\n\t\t};\n\t\tThis._SO=0;\n\t\t\n\t\tvar end=function(){\n\t\t\tThis.state=1;\n\t\t\tThis.resume();\n\t\t};\n\t\tif(ctx.state==\"suspended\"){\n\t\t\tctx.resume().then(function(){\n\t\t\t\tCLog(\"ctx resume\");\n\t\t\t\tend();\n\t\t\t});\n\t\t}else{\n\t\t\tend();\n\t\t};\n\t}\n\t/*暂停录音*/\n\t,pause:function(){\n\t\tvar This=this;\n\t\tif(This.state){\n\t\t\tThis.state=2;\n\t\t\tCLog(\"pause\");\n\t\t\tdelete Recorder.Stream._call[This.id];\n\t\t};\n\t}\n\t/*恢复录音*/\n\t,resume:function(){\n\t\tvar This=this;\n\t\tif(This.state){\n\t\t\tThis.state=1;\n\t\t\tCLog(\"resume\");\n\t\t\tThis.envResume();\n\t\t\t\n\t\t\tRecorder.Stream._call[This.id]=function(pcm,sum){\n\t\t\t\tif(This.state==1){\n\t\t\t\t\tThis.envIn(pcm,sum);\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t}\n\t\n\t\n\t\n\t\n\t,_stop:function(keepEngine){\n\t\tvar This=this,set=This.set;\n\t\tif(!This.isMock){\n\t\t\tThis._S++;\n\t\t};\n\t\tif(This.state){\n\t\t\tThis.pause();\n\t\t\tThis.state=0;\n\t\t};\n\t\tif(!keepEngine && This[set.type+\"_stop\"]){\n\t\t\tThis[set.type+\"_stop\"](This.engineCtx);\n\t\t\tThis.engineCtx=0;\n\t\t};\n\t}\n\t/*\n\t结束录音并返回录音数据blob对象\n\t\tTrue(blob,duration) blob：录音数据audio/mp3|wav格式\n\t\t\t\t\t\t\tduration：录音时长，单位毫秒\n\t\tFalse(msg)\n\t\tautoClose:false 可选，是否自动调用close，默认为false\n\t*/\n\t,stop:function(True,False,autoClose){\n\t\tvar This=this,set=This.set,t1;\n\t\tCLog(\"Stop \"+(This.envInLast?This.envInLast-This.envInFirst+\"ms 补\"+This.envInFix+\"ms\":\"-\"));\n\t\t\n\t\tvar end=function(){\n\t\t\tThis._stop();//彻底关掉engineCtx\n\t\t\tif(autoClose){\n\t\t\t\tThis.close();\n\t\t\t};\n\t\t};\n\t\tvar err=function(msg){\n\t\t\tCLog(\"结束录音失败：\"+msg,1);\n\t\t\tFalse&&False(msg);\n\t\t\tend();\n\t\t};\n\t\tvar ok=function(blob,duration){\n\t\t\tCLog(\"结束录音 编码\"+(Date.now()-t1)+\"ms 音频\"+duration+\"ms/\"+blob.size+\"b\");\n\t\t\tif(set.takeoffEncodeChunk){//接管了输出，此时blob长度为0\n\t\t\t\tCLog(\"启用takeoffEncodeChunk后stop返回的blob长度为0不提供音频数据\",3);\n\t\t\t}else if(blob.size<Math.max(100,duration/2)){//1秒小于0.5k？\n\t\t\t\terr(\"生成的\"+set.type+\"无效\");\n\t\t\t\treturn;\n\t\t\t};\n\t\t\tTrue&&True(blob,duration);\n\t\t\tend();\n\t\t};\n\t\tif(!This.isMock){\n\t\t\tif(!This.state){\n\t\t\t\terr(\"未开始录音\");\n\t\t\t\treturn;\n\t\t\t};\n\t\t\tThis._stop(true);\n\t\t};\n\t\tvar size=This.recSize;\n\t\tif(!size){\n\t\t\terr(\"未采集到录音\");\n\t\t\treturn;\n\t\t};\n\t\tif(!This.buffers[0]){\n\t\t\terr(\"音频被释放\");\n\t\t\treturn;\n\t\t};\n\t\tif(!This[set.type]){\n\t\t\terr(\"未加载\"+set.type+\"编码器\");\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//环境配置检查，此处仅针对mock调用，因为open已经检查过了\n\t\tif(This.isMock){\n\t\t\tvar checkMsg=This.envCheck(This.mockEnvInfo||{envName:\"mock\",canProcess:false});//没有提供环境信息的mock时没有onProcess回调\n\t\t\tif(checkMsg){\n\t\t\t\terr(\"录音错误：\"+checkMsg);\n\t\t\t\treturn;\n\t\t\t};\n\t\t};\n\t\t\n\t\t//此类型有边录边转码(Worker)支持\n\t\tvar engineCtx=This.engineCtx;\n\t\tif(This[set.type+\"_complete\"]&&engineCtx){\n\t\t\tvar duration=Math.round(engineCtx.pcmSize/set.sampleRate*1000);//采用后的数据长度和buffers的长度可能微小的不一致，是采样率连续转换的精度问题\n\t\t\t\n\t\t\tt1=Date.now();\n\t\t\tThis[set.type+\"_complete\"](engineCtx,function(blob){\n\t\t\t\tok(blob,duration);\n\t\t\t},err);\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//标准UI线程转码，调整采样率\n\t\tt1=Date.now();\n\t\tvar chunk=Recorder.SampleData(This.buffers,This.srcSampleRate,set.sampleRate);\n\t\t\n\t\tset.sampleRate=chunk.sampleRate;\n\t\tvar res=chunk.data;\n\t\tvar duration=Math.round(res.length/set.sampleRate*1000);\n\t\t\n\t\tCLog(\"采样\"+size+\"->\"+res.length+\" 花:\"+(Date.now()-t1)+\"ms\");\n\t\t\n\t\tsetTimeout(function(){\n\t\t\tt1=Date.now();\n\t\t\tThis[set.type](res,function(blob){\n\t\t\t\tok(blob,duration);\n\t\t\t},function(msg){\n\t\t\t\terr(msg);\n\t\t\t});\n\t\t});\n\t}\n\n};\n\nif(window.Recorder){\n\twindow.Recorder.Destroy();\n};\nwindow.Recorder=Recorder;\n\n//end ****copy源码结束*****\nRecorder.LM=LM;\n\n//流量统计用1像素图片地址，设置为空将不参与统计\nRecorder.TrafficImgUrl=\"//ia.51.la/go1?id=20469973&pvFlag=1\";\nRecorder.Traffic=function(){\n\tvar imgUrl=Recorder.TrafficImgUrl;\n\tif(imgUrl){\n\t\tvar data=Recorder.Traffic;\n\t\tvar idf=location.href.replace(/#.*/,\"\");\n\t\t\n\t\tif(imgUrl.indexOf(\"//\")==0){\n\t\t\t//给url加上http前缀，如果是file协议下，不加前缀没法用\n\t\t\tif(/^https:/i.test(idf)){\n\t\t\t\timgUrl=\"https:\"+imgUrl;\n\t\t\t}else{\n\t\t\t\timgUrl=\"http:\"+imgUrl;\n\t\t\t};\n\t\t};\n\t\t\n\t\tif(!data[idf]){\n\t\t\tdata[idf]=1;\n\t\t\t\n\t\t\tvar img=new Image();\n\t\t\timg.src=imgUrl;\n\t\t\tCLog(\"Traffic Analysis Image: Recorder.TrafficImgUrl=\"+Recorder.TrafficImgUrl);\n\t\t};\n\t};\n};\n\n}));","export class ByteArray {\r\n\r\n    constructor() {\r\n        this.list=[];\r\n        this.byteOffset=0;\r\n        this.length=0;\r\n    }\r\n\r\n    push(unit8Arr) {\r\n        this.list.push(unit8Arr);\r\n        this.length+=unit8Arr.length;\r\n    }\r\n\r\n    readBytes(len) {\r\n        if(len>0){\r\n            let rbuf=new Uint8Array(len);\r\n            let rbuf_ind=0;\r\n            while(rbuf_ind<len){\r\n                if(this.list.length>0){\r\n                    let tmpbuf=this.list.shift();\r\n                    let tmplen=tmpbuf.length;\r\n                    let last_len=len-rbuf_ind;\r\n                    if(tmplen>=last_len){\r\n                        //足夠了\r\n                        let tmpbuf2 = tmpbuf.subarray(0, last_len);\r\n                        rbuf.set(tmpbuf2,rbuf_ind);\r\n                        rbuf_ind+=tmpbuf2.length;\r\n                        if(last_len<tmplen){\r\n                            let newUint8Array = tmpbuf.subarray(last_len, tmplen);\r\n                            this.list.unshift(newUint8Array);\r\n                        }\r\n                        break;\r\n                    }else{\r\n                        rbuf.set(tmpbuf,rbuf_ind);\r\n                        rbuf_ind+=tmplen;\r\n                    }\r\n                }else{\r\n                    rbuf=rbuf.subarray(0, rbuf_ind);\r\n                    break;\r\n                }\r\n            }\r\n            this.length-=rbuf.length;\r\n            return rbuf;\r\n        }\r\n        return null;\r\n    }\r\n\r\n}","\r\nexport class Util {\r\n    static isEmptyString(str) {\r\n        if (str == undefined || str == null || str == \"\") {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n}","import {GPlayerEvent, GErrorType, GPlaybackControlStatus} from './player/gplayer-events';\r\nimport {GTalkerEvent, GTalkerConnectStatus, GTalkerConnectErrorType} from './talker/gtalker-events';\r\nimport {GHelperEvent} from \"./helper/ghelper-events.js\";\r\nimport {GPlayer} from './player/gplayer.js';\r\nimport { HttpFlvPlayer } from './player/httpflv-player.js';\r\nimport { HttpFlvTalker } from './talker/httpflv-talker.js';\r\nimport { GHelper } from \"./helper/ghelper.js\";\r\n\r\nfunction createPlayer(url, config = null) {\r\n  let player = new HttpFlvPlayer();\r\n  player.init(url, config);\r\n  return player;\r\n}\r\n\r\nfunction createTalker(downUrl, upUrl, imei, channel, config = null) {\r\n  let talker = new HttpFlvTalker();\r\n  if (!talker.init(downUrl, upUrl, imei, channel, config)) {\r\n    return null;\r\n  }\r\n  return talker;\r\n}\r\n\r\nfunction createHelper(url) {\r\n  let helper = new GHelper();\r\n  helper.init(url);\r\n  return helper;\r\n}\r\n\r\nfunction isHttpFlvSupported() {\r\n  return HttpFlvPlayer.isSupported();\r\n}\r\n\r\nfunction isTalkSupported() {\r\n  return HttpFlvTalker.isSupported();\r\n}\r\n\r\nlet gmediajs = {};\r\n\r\ngmediajs.createPlayer = createPlayer;\r\ngmediajs.isHttpFlvSupported = isHttpFlvSupported;\r\ngmediajs.HttpFlvPlayer = HttpFlvPlayer;\r\ngmediajs.GPlayerEvent = GPlayerEvent;\r\ngmediajs.GErrorType = GErrorType;\r\ngmediajs.GPlaybackControlStatus = GPlaybackControlStatus;\r\n\r\ngmediajs.createTalker = createTalker;\r\ngmediajs.isTalkSupported = isTalkSupported;\r\ngmediajs.HttpFlvTalker = HttpFlvTalker;\r\ngmediajs.GTalkerEvent = GTalkerEvent;\r\ngmediajs.GTalkerConnectStatus = GTalkerConnectStatus;\r\ngmediajs.GTalkerConnectErrorType = GTalkerConnectErrorType;\r\n\r\ngmediajs.createHelper = createHelper;\r\ngmediajs.GHelper = GHelper;\r\ngmediajs.GHelperEvent = GHelperEvent;\r\n\r\nexport default gmediajs;","export const GHelperEvent = {\r\n    MEDIA_STATE: 'media_state'\r\n};","import {GHelperEvent} from \"./ghelper-events.js\"\r\nexport class GHelper {\r\n    constructor() {\r\n        this.callMediaState = null;\r\n        this.connect = null;\r\n    }\r\n\r\n    init(url) {\r\n        this.connect = new WebSocket(url);\r\n        this.connect.onopen = this._onConnectOpen.bind(this);\r\n        this.connect.onmessage = this._onConnectMessage.bind(this);\r\n        this.connect.onclose = this._onConnectClose.bind(this);\r\n        this.connect.onerror = this._onConnectError.bind(this);\r\n    }\r\n\r\n    on(event, call) {\r\n        if (event = GHelperEvent.MEDIA_STATE) {\r\n            this.callMediaState = call;\r\n        }\r\n    }\r\n\r\n    off(event) {\r\n        if (event = GHelperEvent.MEDIA_STATE) {\r\n            this.callMediaState = null;\r\n        }\r\n    }\r\n\r\n    destroy() {\r\n        this.callMediaState = null;\r\n\r\n        if (this.connect != null) {\r\n            this.connect.close();\r\n            this.connect = null;\r\n        }\r\n    }\r\n\r\n    _onConnectOpen() {\r\n        this._sendConsumeMediaStateCmd();\r\n    }\r\n\r\n    _onConnectMessage(e) {\r\n        let head = JSON.parse(e.data);\r\n        if (head == null || head.type == null) {\r\n            return;\r\n        }\r\n\r\n        if (head.type == \"mediastate\" && this.callMediaState != null) {\r\n            this.callMediaState(head.data);\r\n        }\r\n    }\r\n\r\n    _onConnectClose() {\r\n        \r\n    }\r\n\r\n    _onConnectError() {\r\n        \r\n    }\r\n\r\n    _sendConsumeMediaStateCmd() {\r\n        let head = {}\r\n        head[\"cmd\"] = \"consume\";\r\n        head[\"type\"] = \"mediastate\";\r\n        head[\"id\"] = \"\";\r\n        head[\"data\"] = {};\r\n\r\n        let msg = JSON.stringify(head);\r\n\r\n        this.connect.send(msg);\r\n    }\r\n}","module.exports = require('./gmedia.js').default;","export const GPlayerEvent = {\r\n    ERROR: 'error',\r\n    MEDIA_SOURCE_END: 'media_source_end',\r\n    TIMEUPDATE: 'timeupdate',\r\n    STATISTICS_INFO: 'statistics_info',\r\n    MEDIA_STATE: 'media_state',\r\n    PLAYBACK_CONTROL_EVENT: 'playback_control_event',\r\n};\r\n\r\nexport const GErrorType = {\r\n    NETWORK_ERROR: 'NetworkError',\r\n    MEDIA_ERROR: 'MediaError',\r\n    OTHER_ERROR: 'OtherError'\r\n};\r\n\r\nexport const GPlaybackControlStatus = {\r\n    SeekStart: 0,\r\n    SeekFail: 1,\r\n    SeekSuccess: 2\r\n};\r\n","export class GPlayer {\r\n\r\n    constructor(typeName) {\r\n        this._type = typeName || 'undefined';\r\n    }\r\n\r\n    init(url, config) {\r\n    }\r\n\r\n    on(event, call) {\r\n\r\n    }\r\n\r\n    off(event) {\r\n\r\n    }\r\n\r\n    attachMediaElement(mediaElement) {  \r\n    }\r\n\r\n    load() {\r\n    }\r\n\r\n    play() {\r\n\r\n    }\r\n\r\n    capture() {\r\n\r\n    }\r\n\r\n    pause() {\r\n        \r\n    }\r\n\r\n    resume() {\r\n        \r\n    }\r\n\r\n    seekToNewestTime () {\r\n\r\n    }\r\n\r\n    seek(time) {\r\n\r\n    }\r\n\r\n    destroy() {\r\n\r\n    }\r\n\r\n}","import {GPlayerEvent, GErrorType, GPlaybackControlStatus} from \"./gplayer-events.js\"\r\nimport {GPlayer} from \"./gplayer.js\"\r\nimport flvjs from \"flv-g7.js\";\r\n\r\nimport {GHelperEvent} from \"../helper/ghelper-events.js\";\r\nimport { GHelper } from \"../helper/ghelper.js\";\r\n\r\nconst PlaybackKey = \"g7-flv-video-playback\";\r\n\r\nconst PlaybackControl = {\r\n    None:0,\r\n    Active:1,\r\n    Passive:2\r\n}\r\n\r\nexport class HttpFlvPlayer extends GPlayer {\r\n\r\n    constructor () {\r\n        super('httpflv-player');\r\n        this.TAG = 'HttpFlvPlayer';\r\n        \r\n        this.player = null;\r\n        this.element = null;\r\n        this.isLive = true;\r\n\r\n        this.helpUrl = null;\r\n        this.helper = null;\r\n\r\n        this.playbackPlan = 1;\r\n        this.playbackControl = PlaybackControl.None;\r\n\r\n        this.streamEnd = false;\r\n        this.needSeek = false;\r\n        this.seeking = false;\r\n        this.seekTime = 0;\r\n        this.newPlayStartTime = 0;\r\n        this.lastSendSeekTs = 0;\r\n\r\n        this.callbackTimeUpdate = null;\r\n        this.callbackStatistics = null;\r\n        this.callbackError = null;\r\n        this.callbackMediaSourceEnd = null;\r\n        this.callbackMediaState = null;\r\n        this.callbackPlaybackControlEvent = null;\r\n\r\n        this.checkerSeek = null;\r\n\r\n        this.e = {\r\n            onTimeUpdate : this._onElementTime.bind(this)\r\n        };\r\n    }\r\n\r\n    static isSupported() {\r\n        return window.MediaSource &&\r\n            window.MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"');\r\n    }\r\n\r\n    init (url, config) {\r\n        this._checkConfig(config);\r\n        this.isLive = this._checkIfLive(url);  \r\n        this.playbackControl = this._checkPlaybackControl(url);  \r\n\r\n        this.player = flvjs.createPlayer({isLive:this.isLive, type:'flv',url:url}, {\r\n            lazyLoad: false,\r\n            enableStashBuffer: false,\r\n            deferLoadAfterSourceOpen:true\r\n        });\r\n\r\n        this.player.on(flvjs.Events.STATISTICS_INFO, this._onStatisticsInfo.bind(this));\r\n        this.player.on(flvjs.Events.ERROR, this._onError.bind(this));\r\n        this.player.setMediaSourceEndCallback(this._onMediaSourceEnd.bind(this));\r\n        this.player.setStreamTimeCallback(this._onStreamTime.bind(this));\r\n    }\r\n\r\n    on(event, call) {\r\n        if (event === GPlayerEvent.TIMEUPDATE) {\r\n            this.callbackTimeUpdate = call;\r\n        }\r\n        else if (event === GPlayerEvent.STATISTICS_INFO) {\r\n            this.callbackStatistics = call;\r\n        }\r\n        else if (event === GPlayerEvent.ERROR) {\r\n            this.callbackError = call;\r\n        }\r\n        else if (event === GPlayerEvent.MEDIA_SOURCE_END) {\r\n            this.callbackMediaSourceEnd = call;\r\n        }\r\n        else if (event === GPlayerEvent.MEDIA_STATE) {\r\n            this.callbackMediaState = call;\r\n        }\r\n        else if (event === GPlayerEvent.PLAYBACK_CONTROL_EVENT) {\r\n            this.callbackPlaybackControlEvent = call;\r\n        }\r\n    }\r\n\r\n    off(event) {\r\n        if (event === GPlayerEvent.TIMEUPDATE) {\r\n            this.callbackTimeUpdate = null;\r\n        }\r\n        else if (event === GPlayerEvent.STATISTICS_INFO) {\r\n            this.callbackStatistics = null;\r\n        }\r\n        else if (event === GPlayerEvent.ERROR) {\r\n            this.callbackError = null;\r\n        }\r\n        else if (event === GPlayerEvent.MEDIA_SOURCE_END) {\r\n            this.callbackMediaSourceEnd = null;\r\n        }\r\n        else if (event === GPlayerEvent.MEDIA_STATE) {\r\n            this.callbackMediaState = null;\r\n        }\r\n        else if (event === GPlayerEvent.PLAYBACK_CONTROL_EVENT) {\r\n            this.callbackPlaybackControlEvent = null;\r\n        }\r\n    }\r\n\r\n    attachMediaElement(el) {\r\n        this.element = el;\r\n        this.element.addEventListener(\"timeupdate\", this.e.onTimeUpdate);\r\n        this.player.attachMediaElement(el);\r\n    }\r\n\r\n    load() {\r\n        if (this.helpUrl != null) {\r\n            this.helper = new GHelper();\r\n            this.helper.init(this.helpUrl);\r\n            this.helper.on(GHelperEvent.MEDIA_STATE,this._onMediaState.bind(this));\r\n        }\r\n\r\n        this.player.load();\r\n    }\r\n\r\n    play() {\r\n        this.player.play();\r\n    }\r\n\r\n    capture() {\r\n        let canvas = document.createElement(\"canvas\");\r\n        canvas.width = this.element.videoWidth;\r\n        canvas.height = this.element.videoHeight;\r\n        canvas.getContext('2d').drawImage(this.element, 0, 0, canvas.width, canvas.height);\r\n        let dataurl = canvas.toDataURL();\r\n        return dataurl;\r\n    }\r\n\r\n    pause() {\r\n        this.element.pause();\r\n        return false;\r\n    }\r\n\r\n    resume() {\r\n        this.element.play();\r\n        return false;\r\n    }\r\n\r\n    seekToNewestTime () {\r\n        let buffered = this.element.buffered;\r\n        if (buffered.length > 0) { \r\n            let from = buffered.start(buffered.length -1);\r\n            let to = buffered.end(buffered.length -1);\r\n            this.element.currentTime = to;\r\n        }\r\n    }\r\n\r\n    seek(time) {\r\n        if (this.element == null) {\r\n            return false;\r\n        }\r\n        if (this.seeking) {\r\n            return false;\r\n        }\r\n        \r\n        if (this.callbackPlaybackControlEvent != null) {\r\n            this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekStart, \r\n                \"开始切换播放时间\");\r\n        }\r\n\r\n        if (!this._seekByCached(time)) {\r\n            return false;\r\n        }\r\n        if (this.playbackControl == PlaybackControl.Active) {\r\n            this._seekByActive(time);\r\n        }\r\n        else {\r\n            this._seekByPassive(time);\r\n        }\r\n        return true;\r\n    }\r\n\r\n    destroy() {\r\n        if (this.helper != null) {\r\n            this.helper.destroy();\r\n        }\r\n\r\n        if (this.player != null) {\r\n            this.player.pause();\r\n            this.player.unload();\r\n            this.player.detachMediaElement();\r\n            this.player.destroy();\r\n            this.player = null;\r\n        }\r\n\r\n        if (this.element != null) {\r\n            this.element.removeEventListener(\"timeupdate\", this.e.onTimeUpdate);\r\n            this.element = null;\r\n        }\r\n    }\r\n\r\n    _checkConfig(config) {\r\n        if (config == null) {\r\n            return;\r\n        }\r\n\r\n        if (config.playbackPlan != null) {\r\n            this.playbackPlan = config.playbackPlan;\r\n        }\r\n\r\n        if (config.helpUrl != null) {\r\n            this.helpUrl = config.helpUrl;\r\n        }\r\n    }\r\n\r\n    _checkIfLive(url) {\r\n        if (url.indexOf(PlaybackKey) != -1) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    _checkPlaybackControl(url) {\r\n        let arr = url.split('&stream=');\r\n        if (arr.length < 2 || arr[1].length < 3) {\r\n            return PlaybackControl.None;\r\n        }\r\n        let streamName = arr[1];\r\n        let deviceType = streamName.substring(0,3);\r\n        if (deviceType == '131') {\r\n            return PlaybackControl.Passive;\r\n        }\r\n        return PlaybackControl.Active;\r\n    }\r\n\r\n    _seekByCached(time) {\r\n        if (!this.streamEnd) {\r\n            return true;\r\n        }\r\n\r\n        this.seeking = true;\r\n\r\n        let bCached = false;\r\n        let buffered = this.element.buffered;\r\n        for (let i = 0; i < buffered.length; i++) {\r\n            let from = buffered.start(i);\r\n            let to = buffered.end(i);\r\n            if (time > from && time < to) {\r\n                bCached = true;\r\n            }\r\n        }\r\n\r\n        if (bCached && time > this.element.currentTime) {\r\n            this.element.currentTime = time;\r\n            if (this.callbackPlaybackControlEvent != null) {\r\n                this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekSuccess,\r\n                    \"切换播放时间成功\");\r\n            }\r\n        }\r\n        else {\r\n            if (this.callbackPlaybackControlEvent != null) {\r\n                this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekFail,\r\n                    \"缓冲流已结束，无法切换到未缓冲区域\");\r\n            }\r\n        }\r\n\r\n        this.seeking = false;\r\n        return false;\r\n    }\r\n\r\n    _seekByActive(time) {\r\n        this.seeking = true;\r\n\r\n        this.lastSendSeekTs = new Date().getTime();\r\n\r\n        this.checkerSeek = setTimeout(()=>{\r\n            this.needSeek = false;\r\n            this.seeking = false;\r\n            if (this.callbackPlaybackControlEvent != null) {\r\n                this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekFail,\r\n                    \"切换播放时间失败，请重新尝试\");\r\n            }\r\n        },15*1000);\r\n\r\n        this.seekTime = time;\r\n        this.needSeek = true;\r\n    }\r\n\r\n    _seekByPassive(time) {\r\n        this.seeking = true;\r\n\r\n        this.seekTime = time;\r\n        //获取当前video标签解码缓存\r\n        let buffered = this.element.buffered;\r\n        if (buffered.length > 0) { \r\n            //由设备端控制回放的buffered只会产生一段\r\n            let from = buffered.start(0);\r\n            let to = buffered.end(0);\r\n            this.newPlayStartTime = to;\r\n\r\n            this.element.currentTime = this.newPlayStartTime;\r\n        }\r\n\r\n        setTimeout(()=>{\r\n            this.seeking = false;\r\n            if (this.callbackPlaybackControlEvent != null) {\r\n                this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekSuccess,\r\n                    \"切换播放时间成功\");\r\n            }\r\n        },1000);\r\n    }\r\n\r\n    _onMediaState(info) {\r\n        if (this.callbackMediaState != null) {\r\n            this.callbackMediaState(info);\r\n        }\r\n    }\r\n\r\n    _onStatisticsInfo(data) {\r\n        if (this.callbackStatistics != null) {\r\n            let info = {};\r\n            info.speed = data.speed;\r\n            this.callbackStatistics(info);\r\n        }\r\n    }\r\n\r\n    _onError(type, detail, errObj) {\r\n        if (this.callbackError != null) {\r\n            let gtype = type;\r\n            let gsubtype = detail;\r\n            let info = type;\r\n            this.callbackError(type, gsubtype, info);\r\n        }\r\n    }\r\n\r\n    _onMediaSourceEnd(info) {\r\n        this.streamEnd = true;\r\n        if (this.callbackMediaSourceEnd != null) {\r\n            this.callbackMediaSourceEnd();\r\n        }\r\n    }\r\n\r\n    _onElementTime(event) {\r\n        //回放方案1\r\n        if (this.playbackPlan == 1) {\r\n            if (this.callbackTimeUpdate != null && this.element != null) {\r\n                this.callbackTimeUpdate(this.element.currentTime);\r\n            }\r\n            return;\r\n        }\r\n\r\n        //回放方案2\r\n        if (this.playbackControl === PlaybackControl.Active) {\r\n            if (!this.seeking && this.callbackTimeUpdate != null && this.element != null) {\r\n                this.callbackTimeUpdate(this.element.currentTime);\r\n            }\r\n        }\r\n        else if (this.playbackControl === PlaybackControl.Passive) {\r\n            if (!this.seeking && this.callbackTimeUpdate != null && this.element != null) {\r\n                let curPlayTime = this.seekTime + (this.element.currentTime - this.newPlayStartTime);\r\n                this.callbackTimeUpdate(curPlayTime);\r\n            }\r\n        }\r\n    }\r\n\r\n    _onStreamTime(time) {\r\n        if (this.needSeek) {\r\n            if (Math.abs(this.seekTime*1000 - time) >= 1000) {\r\n                return;\r\n            }\r\n\r\n            if (this.checkerSeek != null) {\r\n                clearTimeout(this.checkerSeek);\r\n                this.checkerSeek = null;\r\n            }\r\n\r\n            this.needSeek = false;\r\n            setTimeout(()=>{\r\n                this.seeking = false;\r\n                this.element.currentTime = time/1000;\r\n                let off = new Date().getTime() - this.lastSendSeekTs;\r\n                console.log(\"切换耗时: \" + off);\r\n                if (this.callbackPlaybackControlEvent != null) {\r\n                    this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekSuccess,\r\n                        \"切换播放时间成功\");\r\n                }\r\n            },1000);\r\n            return;\r\n        }\r\n    }\r\n}\r\n\r\n","export const GTalkerEvent = {\r\n    CONNECT_STATUS: 'connect_status'\r\n};\r\n\r\nexport const GTalkerConnectStatus = {\r\n    ConnectSuccess: 'ConnectSuccess',\r\n    ConnectError: 'ConnectError'\r\n};\r\n\r\nexport const GTalkerConnectErrorType = {\r\n    DeviceNotResponding: 'DeviceNotResponding',\r\n    DeviceStopedResponding: 'DeviceStopedResponding',\r\n    DownLinkFail: 'DownLinkFail',\r\n    UpLinkFail: 'UpLinkFail',\r\n    WaitOpenMicrophoneTimeout: 'WaitOpenMicrophoneTimeout',\r\n    NotAllowOpenMicrophone: 'NotAllowOpenMicrophone'\r\n};","export class GTalker {\r\n\r\n    constructor(typeName) {\r\n        this._type = typeName || 'undefined';\r\n    }\r\n\r\n    init(downUrl, upUrl, imei, channel, config) {\r\n    }\r\n\r\n    on(event, call) {\r\n\r\n    }\r\n\r\n    off(event) {\r\n\r\n    }\r\n\r\n    attachMediaElement(element) {  \r\n    }\r\n\r\n    load() {\r\n    }\r\n\r\n    destroy() {\r\n\r\n    }\r\n\r\n}","import {GTalkerEvent, GTalkerConnectStatus, GTalkerConnectErrorType} from \"./gtalker-events.js\"\r\nimport {GTalker} from \"./gtalker.js\"\r\nimport {ByteArray} from \"../common/bytearray.js\"\r\nimport {Util} from \"../common/util.js\"\r\n\r\nimport flvjs from \"flv-g7.js\";\r\n\r\nimport Recorder from 'recorder-core'\r\nimport 'recorder-core/src/engine/mp3'\r\nimport 'recorder-core/src/engine/mp3-engine'\r\n\r\nconst AudioBufLen = 640;\r\nconst DebugFlag = false;\r\n\r\nexport class HttpFlvTalker extends GTalker {\r\n\r\n    constructor () {\r\n        super('httpflv-talker');\r\n        this.TAG = 'HttpFlvTalker';\r\n\r\n        this.downUrl = null;\r\n        this.upUrl = null;\r\n        this.imei = null;\r\n        this.channel = null;\r\n        \r\n        this.player = null;\r\n        this.recorder = null;\r\n        this.sender = null;\r\n        this.element = null;\r\n\r\n        this.callbackConnectStatus = null;\r\n\r\n        this.byteArray = new ByteArray();\r\n\r\n        this.timerCheck = null;\r\n        this.timerSend = null;\r\n\r\n        this.hasReceiveServerData = false;\r\n        this.hasSendClientData = false;\r\n        this.hasWaitOpenMicrophoneTimeout = false;\r\n        this.hasDestory = false;\r\n    }\r\n\r\n    static isSupported() {\r\n        return typeof WebSocket != 'undefined' && Recorder.Support() && window.MediaSource &&\r\n            window.MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"');\r\n    }\r\n\r\n    init(downUrl, upUrl, imei, channel, config) {\r\n        this.downUrl = downUrl;\r\n        this.upUrl = upUrl;\r\n        this.imei = imei;\r\n        this.channel = channel;\r\n        if (!this._checkInputParam()) {\r\n            return false;\r\n        }\r\n\r\n        this._startPlayer(downUrl);\r\n        return true;\r\n    }\r\n\r\n    on(event, call) {\r\n        if (event === GTalkerEvent.CONNECT_STATUS) {\r\n            this.callbackConnectStatus = call;\r\n        }\r\n    }\r\n\r\n    off(event) {\r\n        if (event === GTalkerEvent.CONNECT_STATUS) {\r\n            this.callbackConnectStatus = null;\r\n        }\r\n    }\r\n\r\n    attachMediaElement(element) {  \r\n        this.element = element;\r\n\r\n        this.element.addEventListener(\"loadeddata\", this._onPlayerLoadedData.bind(this), {once: true});\r\n        this.player.on(flvjs.Events.ERROR, this._onPlayerError.bind(this));\r\n        this.player.setMediaSourceEndCallback(this._onPlayerMediaSourceEnd.bind(this));\r\n\r\n        this.player.attachMediaElement(element);\r\n    }\r\n\r\n    load() {\r\n        this.player.load();\r\n        this._startSender(this.upUrl);\r\n    }\r\n\r\n    destroy() {\r\n        this.hasDestory = true;\r\n\r\n        this._destroyPlayer();\r\n        this._destroySender();\r\n        this._destroyRecorder();\r\n        this._destroySendProc();\r\n    }\r\n\r\n    _checkInputParam() {\r\n        if (Util.isEmptyString(this.downUrl) || Util.isEmptyString(this.upUrl)) {\r\n            return false;\r\n        }\r\n        if (Util.isEmptyString(this.imei)) {\r\n            return false;\r\n        }\r\n        if (this.channel < 0 || this.channel > 255) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    _startPlayer(url) {\r\n        this._destroyPlayer();\r\n\r\n        this.player = flvjs.createPlayer({isLive:true, type:'flv',url:url}, {\r\n            lazyLoad: false,\r\n            enableStashBuffer: false,\r\n            deferLoadAfterSourceOpen:true\r\n        });\r\n    }\r\n\r\n    _onPlayerLoadedData() {\r\n        if (DebugFlag) {\r\n            console.log(\"player loadedData\");\r\n        }\r\n\r\n        this.hasReceiveServerData = true;\r\n        if (this.hasSendClientData && this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectSuccess, \"\");\r\n        }\r\n    }\r\n\r\n    _onPlayerError(type, detail, errObj) {\r\n        if (DebugFlag) {\r\n            console.log(\"player error\");\r\n        }\r\n\r\n        if (this.callbackConnectStatus == null) {\r\n            return;\r\n        }\r\n\r\n        if (this.hasReceiveServerData) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.DownLinkFail);\r\n        }\r\n        else {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.DeviceNotResponding);\r\n        }\r\n    }\r\n\r\n    _onPlayerMediaSourceEnd(info) {\r\n        if (DebugFlag) {\r\n            console.log(\"player source end\");\r\n        }\r\n\r\n        if (this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.DeviceStopedResponding);\r\n        }\r\n    }\r\n\r\n    _destroyPlayer() {\r\n        if (this.player != null) {\r\n            this.player.pause();\r\n            this.player.unload();\r\n            this.player.detachMediaElement();\r\n            this.player.destroy();\r\n            this.player = null;\r\n        }\r\n\r\n        if (this.element != null) {\r\n            this.element = null;\r\n        }\r\n    }\r\n\r\n    _startSender(url) {\r\n        this.sender = new WebSocket(url);\r\n        this.sender.onopen = this._onSenderOpen.bind(this);\r\n        this.sender.onmessage = this._onSenderMsg.bind(this);\r\n        this.sender.onclose = this._onSenderClose.bind(this);\r\n        this.sender.onerror = this._onSenderError.bind(this);\r\n    }\r\n\r\n    _onSenderOpen() {\r\n        if (DebugFlag) {\r\n            console.log(\"websocket open\");\r\n        }\r\n        \r\n        this._startRecorder();\r\n    }\r\n\r\n    _onSenderMsg(e) {\r\n        \r\n    }\r\n\r\n    _onSenderClose(e) {\r\n        if (DebugFlag) {\r\n            console.log(\"websocket close\");\r\n        }\r\n\r\n        if (this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.UpLinkFail);\r\n        }\r\n    }\r\n\r\n    _onSenderError(e) {\r\n        if (DebugFlag) {\r\n            console.log(\"websocket error\");\r\n        }\r\n    }\r\n\r\n    _destroySender() {\r\n        this.sender.close();\r\n        this.sender = null;\r\n    }\r\n\r\n    _startRecorder() {\r\n        if (this.recorder) {\r\n            this.recorder.close();\r\n        }\r\n\r\n        this.recorder = Recorder({\r\n            type:\"mp3\",\r\n            sampleRate:8000,\r\n            bitRate:16,\r\n            onProcess:this._onReceiveMicrophoneData.bind(this)\r\n        });\r\n        this.timerCheck = setTimeout(this._timeoutCheckIfAllowOpenMicrophone.bind(this),10000);\r\n        this.recorder.open(this._onAllowOpenMicrophone.bind(this),\r\n            this._onNotAllowOpenMicrophone.bind(this));\r\n    }\r\n\r\n    _timeoutCheckIfAllowOpenMicrophone() {\r\n        if (DebugFlag) {\r\n            console.log(\"user WaitOpenMicrophone Timeout\");\r\n        }\r\n\r\n        this.hasWaitOpenMicrophoneTimeout = true;\r\n\r\n        if (this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.WaitOpenMicrophoneTimeout);\r\n        }\r\n    }\r\n\r\n    _onAllowOpenMicrophone() {\r\n        if (DebugFlag) {\r\n            console.log(\"user AllowOpenMicrophone\");\r\n        }\r\n\r\n        if (this.hasWaitOpenMicrophoneTimeout) {\r\n            return;\r\n        }\r\n\r\n        clearTimeout(this.timerCheck);\r\n\r\n        this.hasSendClientData = true;\r\n        if (this.hasReceiveServerData && this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectSuccess, \"\");\r\n        }\r\n\r\n        this.recorder.start();\r\n        this._sendProc();\r\n    }\r\n\r\n    _onNotAllowOpenMicrophone(msg, isUserNotAllow) {\r\n        if (DebugFlag) {\r\n            console.log(\"user NotAllowOpenMicrophone\");\r\n        }\r\n\r\n        clearTimeout(this.timerCheck);\r\n\r\n        if (this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.NotAllowOpenMicrophone);\r\n        }\r\n    }\r\n\r\n    _onReceiveMicrophoneData(buffers, powerLevel, bufferDuration, bufferSampleRate) {\r\n        let arrayBuf = buffers[buffers.length - 1].buffer; //Uint16Array To ArrayBuffer\r\n        let u8buf = new Uint8Array(arrayBuf); //ArrayBuffer To Uint8Array\r\n        this.byteArray.push(u8buf);\r\n    }\r\n\r\n    _destroyRecorder() {\r\n        this.recorder.close();\r\n        this.recorder = null;\r\n    }\r\n\r\n    _sendProc() {\r\n        if (this.hasDestory) {\r\n            return;\r\n        }\r\n\r\n        if (this.byteArray.length < AudioBufLen) {\r\n            this.timerSend = setTimeout(this._sendProc.bind(this), 5);\r\n        }\r\n        else {\r\n            let audioBuf = this.byteArray.readBytes(AudioBufLen);\r\n\r\n            let packer = new ByteArray();\r\n            packer.push(new Uint8Array([0x31,0x32,0x63,0x64]));\r\n            let arrImeiChar = this.imei.split('');\r\n            for (let i = 0; i < arrImeiChar.length; i++) {\r\n                packer.push(new Uint8Array([arrImeiChar[i].charCodeAt()]));\r\n            }\r\n            packer.push(new Uint8Array([parseInt(this.channel)]));\r\n            packer.push(new Uint8Array([Math.floor(AudioBufLen/256)]));\r\n            packer.push(new Uint8Array([AudioBufLen%256]));\r\n            packer.push(audioBuf);\r\n\r\n            let totalLen = 4 + arrImeiChar.length + 3 + AudioBufLen;\r\n            if (this.sender != null) {\r\n                this.sender.send(packer.readBytes(totalLen));\r\n            }\r\n\r\n            this._sendProc();\r\n        }\r\n    }\r\n\r\n    _destroySendProc() {\r\n        clearTimeout(this.timerSend);\r\n    }\r\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvZmx2LWc3LmpzL2Rpc3QvZmx2LmpzIiwibm9kZV9tb2R1bGVzL3JlY29yZGVyLWNvcmUvc3JjL2VuZ2luZS9tcDMtZW5naW5lLmpzIiwibm9kZV9tb2R1bGVzL3JlY29yZGVyLWNvcmUvc3JjL2VuZ2luZS9tcDMuanMiLCJub2RlX21vZHVsZXMvcmVjb3JkZXItY29yZS9zcmMvcmVjb3JkZXItY29yZS5qcyIsInNyYy9jb21tb24vYnl0ZWFycmF5LmpzIiwic3JjL2NvbW1vbi91dGlsLmpzIiwic3JjL2dtZWRpYS5qcyIsInNyYy9oZWxwZXIvZ2hlbHBlci1ldmVudHMuanMiLCJzcmMvaGVscGVyL2doZWxwZXIuanMiLCJzcmMvaW5kZXguanMiLCJzcmMvcGxheWVyL2dwbGF5ZXItZXZlbnRzLmpzIiwic3JjL3BsYXllci9ncGxheWVyLmpzIiwic3JjL3BsYXllci9odHRwZmx2LXBsYXllci5qcyIsInNyYy90YWxrZXIvZ3RhbGtlci1ldmVudHMuanMiLCJzcmMvdGFsa2VyL2d0YWxrZXIuanMiLCJzcmMvdGFsa2VyL2h0dHBmbHYtdGFsa2VyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDcjRYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1MWJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZhQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0lDbDNCYSxTLFdBQUEsUztBQUVULHlCQUFjO0FBQUE7O0FBQ1YsYUFBSyxJQUFMLEdBQVUsRUFBVjtBQUNBLGFBQUssVUFBTCxHQUFnQixDQUFoQjtBQUNBLGFBQUssTUFBTCxHQUFZLENBQVo7QUFDSDs7Ozs2QkFFSSxRLEVBQVU7QUFDWCxpQkFBSyxJQUFMLENBQVUsSUFBVixDQUFlLFFBQWY7QUFDQSxpQkFBSyxNQUFMLElBQWEsU0FBUyxNQUF0QjtBQUNIOzs7a0NBRVMsRyxFQUFLO0FBQ1gsZ0JBQUcsTUFBSSxDQUFQLEVBQVM7QUFDTCxvQkFBSSxPQUFLLElBQUksVUFBSixDQUFlLEdBQWYsQ0FBVDtBQUNBLG9CQUFJLFdBQVMsQ0FBYjtBQUNBLHVCQUFNLFdBQVMsR0FBZixFQUFtQjtBQUNmLHdCQUFHLEtBQUssSUFBTCxDQUFVLE1BQVYsR0FBaUIsQ0FBcEIsRUFBc0I7QUFDbEIsNEJBQUksU0FBTyxLQUFLLElBQUwsQ0FBVSxLQUFWLEVBQVg7QUFDQSw0QkFBSSxTQUFPLE9BQU8sTUFBbEI7QUFDQSw0QkFBSSxXQUFTLE1BQUksUUFBakI7QUFDQSw0QkFBRyxVQUFRLFFBQVgsRUFBb0I7QUFDaEI7QUFDQSxnQ0FBSSxVQUFVLE9BQU8sUUFBUCxDQUFnQixDQUFoQixFQUFtQixRQUFuQixDQUFkO0FBQ0EsaUNBQUssR0FBTCxDQUFTLE9BQVQsRUFBaUIsUUFBakI7QUFDQSx3Q0FBVSxRQUFRLE1BQWxCO0FBQ0EsZ0NBQUcsV0FBUyxNQUFaLEVBQW1CO0FBQ2Ysb0NBQUksZ0JBQWdCLE9BQU8sUUFBUCxDQUFnQixRQUFoQixFQUEwQixNQUExQixDQUFwQjtBQUNBLHFDQUFLLElBQUwsQ0FBVSxPQUFWLENBQWtCLGFBQWxCO0FBQ0g7QUFDRDtBQUNILHlCQVZELE1BVUs7QUFDRCxpQ0FBSyxHQUFMLENBQVMsTUFBVCxFQUFnQixRQUFoQjtBQUNBLHdDQUFVLE1BQVY7QUFDSDtBQUNKLHFCQWxCRCxNQWtCSztBQUNELCtCQUFLLEtBQUssUUFBTCxDQUFjLENBQWQsRUFBaUIsUUFBakIsQ0FBTDtBQUNBO0FBQ0g7QUFDSjtBQUNELHFCQUFLLE1BQUwsSUFBYSxLQUFLLE1BQWxCO0FBQ0EsdUJBQU8sSUFBUDtBQUNIO0FBQ0QsbUJBQU8sSUFBUDtBQUNIOzs7Ozs7Ozs7Ozs7Ozs7OztJQzVDUSxJLFdBQUEsSTs7Ozs7OztzQ0FDWSxHLEVBQUs7QUFDdEIsZ0JBQUksT0FBTyxTQUFQLElBQW9CLE9BQU8sSUFBM0IsSUFBbUMsT0FBTyxFQUE5QyxFQUFrRDtBQUM5Qyx1QkFBTyxJQUFQO0FBQ0gsYUFGRCxNQUdLO0FBQ0QsdUJBQU8sS0FBUDtBQUNIO0FBQ0o7Ozs7Ozs7Ozs7Ozs7QUNUTDs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQSxTQUFTLFlBQVQsQ0FBc0IsR0FBdEIsRUFBMEM7QUFBQSxNQUFmLE1BQWUsdUVBQU4sSUFBTTs7QUFDeEMsTUFBSSxTQUFTLElBQUksNEJBQUosRUFBYjtBQUNBLFNBQU8sSUFBUCxDQUFZLEdBQVosRUFBaUIsTUFBakI7QUFDQSxTQUFPLE1BQVA7QUFDRDs7QUFFRCxTQUFTLFlBQVQsQ0FBc0IsT0FBdEIsRUFBK0IsS0FBL0IsRUFBc0MsSUFBdEMsRUFBNEMsT0FBNUMsRUFBb0U7QUFBQSxNQUFmLE1BQWUsdUVBQU4sSUFBTTs7QUFDbEUsTUFBSSxTQUFTLElBQUksNEJBQUosRUFBYjtBQUNBLE1BQUksQ0FBQyxPQUFPLElBQVAsQ0FBWSxPQUFaLEVBQXFCLEtBQXJCLEVBQTRCLElBQTVCLEVBQWtDLE9BQWxDLEVBQTJDLE1BQTNDLENBQUwsRUFBeUQ7QUFDdkQsV0FBTyxJQUFQO0FBQ0Q7QUFDRCxTQUFPLE1BQVA7QUFDRDs7QUFFRCxTQUFTLFlBQVQsQ0FBc0IsR0FBdEIsRUFBMkI7QUFDekIsTUFBSSxTQUFTLElBQUksZ0JBQUosRUFBYjtBQUNBLFNBQU8sSUFBUCxDQUFZLEdBQVo7QUFDQSxTQUFPLE1BQVA7QUFDRDs7QUFFRCxTQUFTLGtCQUFULEdBQThCO0FBQzVCLFNBQU8sNkJBQWMsV0FBZCxFQUFQO0FBQ0Q7O0FBRUQsU0FBUyxlQUFULEdBQTJCO0FBQ3pCLFNBQU8sNkJBQWMsV0FBZCxFQUFQO0FBQ0Q7O0FBRUQsSUFBSSxXQUFXLEVBQWY7O0FBRUEsU0FBUyxZQUFULEdBQXdCLFlBQXhCO0FBQ0EsU0FBUyxrQkFBVCxHQUE4QixrQkFBOUI7QUFDQSxTQUFTLGFBQVQsR0FBeUIsNEJBQXpCO0FBQ0EsU0FBUyxZQUFULEdBQXdCLDJCQUF4QjtBQUNBLFNBQVMsVUFBVCxHQUFzQix5QkFBdEI7QUFDQSxTQUFTLHNCQUFULEdBQWtDLHFDQUFsQzs7QUFFQSxTQUFTLFlBQVQsR0FBd0IsWUFBeEI7QUFDQSxTQUFTLGVBQVQsR0FBMkIsZUFBM0I7QUFDQSxTQUFTLGFBQVQsR0FBeUIsNEJBQXpCO0FBQ0EsU0FBUyxZQUFULEdBQXdCLDJCQUF4QjtBQUNBLFNBQVMsb0JBQVQsR0FBZ0MsbUNBQWhDO0FBQ0EsU0FBUyx1QkFBVCxHQUFtQyxzQ0FBbkM7O0FBRUEsU0FBUyxZQUFULEdBQXdCLFlBQXhCO0FBQ0EsU0FBUyxPQUFULEdBQW1CLGdCQUFuQjtBQUNBLFNBQVMsWUFBVCxHQUF3QiwyQkFBeEI7O2tCQUVlLFE7Ozs7Ozs7O0FDeERSLElBQU0sc0NBQWU7QUFDeEIsaUJBQWE7QUFEVyxDQUFyQjs7Ozs7Ozs7Ozs7O0FDQVA7Ozs7SUFDYSxPLFdBQUEsTztBQUNULHVCQUFjO0FBQUE7O0FBQ1YsYUFBSyxjQUFMLEdBQXNCLElBQXRCO0FBQ0EsYUFBSyxPQUFMLEdBQWUsSUFBZjtBQUNIOzs7OzZCQUVJLEcsRUFBSztBQUNOLGlCQUFLLE9BQUwsR0FBZSxJQUFJLFNBQUosQ0FBYyxHQUFkLENBQWY7QUFDQSxpQkFBSyxPQUFMLENBQWEsTUFBYixHQUFzQixLQUFLLGNBQUwsQ0FBb0IsSUFBcEIsQ0FBeUIsSUFBekIsQ0FBdEI7QUFDQSxpQkFBSyxPQUFMLENBQWEsU0FBYixHQUF5QixLQUFLLGlCQUFMLENBQXVCLElBQXZCLENBQTRCLElBQTVCLENBQXpCO0FBQ0EsaUJBQUssT0FBTCxDQUFhLE9BQWIsR0FBdUIsS0FBSyxlQUFMLENBQXFCLElBQXJCLENBQTBCLElBQTFCLENBQXZCO0FBQ0EsaUJBQUssT0FBTCxDQUFhLE9BQWIsR0FBdUIsS0FBSyxlQUFMLENBQXFCLElBQXJCLENBQTBCLElBQTFCLENBQXZCO0FBQ0g7OzsyQkFFRSxLLEVBQU8sSSxFQUFNO0FBQ1osZ0JBQUksUUFBUSw0QkFBYSxXQUF6QixFQUFzQztBQUNsQyxxQkFBSyxjQUFMLEdBQXNCLElBQXRCO0FBQ0g7QUFDSjs7OzRCQUVHLEssRUFBTztBQUNQLGdCQUFJLFFBQVEsNEJBQWEsV0FBekIsRUFBc0M7QUFDbEMscUJBQUssY0FBTCxHQUFzQixJQUF0QjtBQUNIO0FBQ0o7OztrQ0FFUztBQUNOLGlCQUFLLGNBQUwsR0FBc0IsSUFBdEI7O0FBRUEsZ0JBQUksS0FBSyxPQUFMLElBQWdCLElBQXBCLEVBQTBCO0FBQ3RCLHFCQUFLLE9BQUwsQ0FBYSxLQUFiO0FBQ0EscUJBQUssT0FBTCxHQUFlLElBQWY7QUFDSDtBQUNKOzs7eUNBRWdCO0FBQ2IsaUJBQUsseUJBQUw7QUFDSDs7OzBDQUVpQixDLEVBQUc7QUFDakIsZ0JBQUksT0FBTyxLQUFLLEtBQUwsQ0FBVyxFQUFFLElBQWIsQ0FBWDtBQUNBLGdCQUFJLFFBQVEsSUFBUixJQUFnQixLQUFLLElBQUwsSUFBYSxJQUFqQyxFQUF1QztBQUNuQztBQUNIOztBQUVELGdCQUFJLEtBQUssSUFBTCxJQUFhLFlBQWIsSUFBNkIsS0FBSyxjQUFMLElBQXVCLElBQXhELEVBQThEO0FBQzFELHFCQUFLLGNBQUwsQ0FBb0IsS0FBSyxJQUF6QjtBQUNIO0FBQ0o7OzswQ0FFaUIsQ0FFakI7OzswQ0FFaUIsQ0FFakI7OztvREFFMkI7QUFDeEIsZ0JBQUksT0FBTyxFQUFYO0FBQ0EsaUJBQUssS0FBTCxJQUFjLFNBQWQ7QUFDQSxpQkFBSyxNQUFMLElBQWUsWUFBZjtBQUNBLGlCQUFLLElBQUwsSUFBYSxFQUFiO0FBQ0EsaUJBQUssTUFBTCxJQUFlLEVBQWY7O0FBRUEsZ0JBQUksTUFBTSxLQUFLLFNBQUwsQ0FBZSxJQUFmLENBQVY7O0FBRUEsaUJBQUssT0FBTCxDQUFhLElBQWIsQ0FBa0IsR0FBbEI7QUFDSDs7Ozs7Ozs7O0FDckVMLE9BQU8sT0FBUCxHQUFpQixRQUFRLGFBQVIsRUFBdUIsT0FBeEM7Ozs7Ozs7O0FDQU8sSUFBTSxzQ0FBZTtBQUN4QixXQUFPLE9BRGlCO0FBRXhCLHNCQUFrQixrQkFGTTtBQUd4QixnQkFBWSxZQUhZO0FBSXhCLHFCQUFpQixpQkFKTztBQUt4QixpQkFBYSxhQUxXO0FBTXhCLDRCQUF3QjtBQU5BLENBQXJCOztBQVNBLElBQU0sa0NBQWE7QUFDdEIsbUJBQWUsY0FETztBQUV0QixpQkFBYSxZQUZTO0FBR3RCLGlCQUFhO0FBSFMsQ0FBbkI7O0FBTUEsSUFBTSwwREFBeUI7QUFDbEMsZUFBVyxDQUR1QjtBQUVsQyxjQUFVLENBRndCO0FBR2xDLGlCQUFhO0FBSHFCLENBQS9COzs7Ozs7Ozs7Ozs7O0lDZk0sTyxXQUFBLE87QUFFVCxxQkFBWSxRQUFaLEVBQXNCO0FBQUE7O0FBQ2xCLGFBQUssS0FBTCxHQUFhLFlBQVksV0FBekI7QUFDSDs7Ozs2QkFFSSxHLEVBQUssTSxFQUFRLENBQ2pCOzs7MkJBRUUsSyxFQUFPLEksRUFBTSxDQUVmOzs7NEJBRUcsSyxFQUFPLENBRVY7OzsyQ0FFa0IsWSxFQUFjLENBQ2hDOzs7K0JBRU0sQ0FDTjs7OytCQUVNLENBRU47OztrQ0FFUyxDQUVUOzs7Z0NBRU8sQ0FFUDs7O2lDQUVRLENBRVI7OzsyQ0FFbUIsQ0FFbkI7Ozs2QkFFSSxJLEVBQU0sQ0FFVjs7O2tDQUVTLENBRVQ7Ozs7Ozs7Ozs7Ozs7Ozs7QUNqREw7O0FBQ0E7O0FBQ0E7Ozs7QUFFQTs7QUFDQTs7Ozs7Ozs7OztBQUVBLElBQU0sY0FBYyx1QkFBcEI7O0FBRUEsSUFBTSxrQkFBa0I7QUFDcEIsVUFBSyxDQURlO0FBRXBCLFlBQU8sQ0FGYTtBQUdwQixhQUFRO0FBSFksQ0FBeEI7O0lBTWEsYSxXQUFBLGE7OztBQUVULDZCQUFlO0FBQUE7O0FBQUEsa0lBQ0wsZ0JBREs7O0FBRVgsY0FBSyxHQUFMLEdBQVcsZUFBWDs7QUFFQSxjQUFLLE1BQUwsR0FBYyxJQUFkO0FBQ0EsY0FBSyxPQUFMLEdBQWUsSUFBZjtBQUNBLGNBQUssTUFBTCxHQUFjLElBQWQ7O0FBRUEsY0FBSyxPQUFMLEdBQWUsSUFBZjtBQUNBLGNBQUssTUFBTCxHQUFjLElBQWQ7O0FBRUEsY0FBSyxZQUFMLEdBQW9CLENBQXBCO0FBQ0EsY0FBSyxlQUFMLEdBQXVCLGdCQUFnQixJQUF2Qzs7QUFFQSxjQUFLLFNBQUwsR0FBaUIsS0FBakI7QUFDQSxjQUFLLFFBQUwsR0FBZ0IsS0FBaEI7QUFDQSxjQUFLLE9BQUwsR0FBZSxLQUFmO0FBQ0EsY0FBSyxRQUFMLEdBQWdCLENBQWhCO0FBQ0EsY0FBSyxnQkFBTCxHQUF3QixDQUF4QjtBQUNBLGNBQUssY0FBTCxHQUFzQixDQUF0Qjs7QUFFQSxjQUFLLGtCQUFMLEdBQTBCLElBQTFCO0FBQ0EsY0FBSyxrQkFBTCxHQUEwQixJQUExQjtBQUNBLGNBQUssYUFBTCxHQUFxQixJQUFyQjtBQUNBLGNBQUssc0JBQUwsR0FBOEIsSUFBOUI7QUFDQSxjQUFLLGtCQUFMLEdBQTBCLElBQTFCO0FBQ0EsY0FBSyw0QkFBTCxHQUFvQyxJQUFwQzs7QUFFQSxjQUFLLFdBQUwsR0FBbUIsSUFBbkI7O0FBRUEsY0FBSyxDQUFMLEdBQVM7QUFDTCwwQkFBZSxNQUFLLGNBQUwsQ0FBb0IsSUFBcEI7QUFEVixTQUFUO0FBOUJXO0FBaUNkOzs7OzZCQU9LLEcsRUFBSyxNLEVBQVE7QUFDZixpQkFBSyxZQUFMLENBQWtCLE1BQWxCO0FBQ0EsaUJBQUssTUFBTCxHQUFjLEtBQUssWUFBTCxDQUFrQixHQUFsQixDQUFkO0FBQ0EsaUJBQUssZUFBTCxHQUF1QixLQUFLLHFCQUFMLENBQTJCLEdBQTNCLENBQXZCOztBQUVBLGlCQUFLLE1BQUwsR0FBYyxlQUFNLFlBQU4sQ0FBbUIsRUFBQyxRQUFPLEtBQUssTUFBYixFQUFxQixNQUFLLEtBQTFCLEVBQWdDLEtBQUksR0FBcEMsRUFBbkIsRUFBNkQ7QUFDdkUsMEJBQVUsS0FENkQ7QUFFdkUsbUNBQW1CLEtBRm9EO0FBR3ZFLDBDQUF5QjtBQUg4QyxhQUE3RCxDQUFkOztBQU1BLGlCQUFLLE1BQUwsQ0FBWSxFQUFaLENBQWUsZUFBTSxNQUFOLENBQWEsZUFBNUIsRUFBNkMsS0FBSyxpQkFBTCxDQUF1QixJQUF2QixDQUE0QixJQUE1QixDQUE3QztBQUNBLGlCQUFLLE1BQUwsQ0FBWSxFQUFaLENBQWUsZUFBTSxNQUFOLENBQWEsS0FBNUIsRUFBbUMsS0FBSyxRQUFMLENBQWMsSUFBZCxDQUFtQixJQUFuQixDQUFuQztBQUNBLGlCQUFLLE1BQUwsQ0FBWSx5QkFBWixDQUFzQyxLQUFLLGlCQUFMLENBQXVCLElBQXZCLENBQTRCLElBQTVCLENBQXRDO0FBQ0EsaUJBQUssTUFBTCxDQUFZLHFCQUFaLENBQWtDLEtBQUssYUFBTCxDQUFtQixJQUFuQixDQUF3QixJQUF4QixDQUFsQztBQUNIOzs7MkJBRUUsSyxFQUFPLEksRUFBTTtBQUNaLGdCQUFJLFVBQVUsNEJBQWEsVUFBM0IsRUFBdUM7QUFDbkMscUJBQUssa0JBQUwsR0FBMEIsSUFBMUI7QUFDSCxhQUZELE1BR0ssSUFBSSxVQUFVLDRCQUFhLGVBQTNCLEVBQTRDO0FBQzdDLHFCQUFLLGtCQUFMLEdBQTBCLElBQTFCO0FBQ0gsYUFGSSxNQUdBLElBQUksVUFBVSw0QkFBYSxLQUEzQixFQUFrQztBQUNuQyxxQkFBSyxhQUFMLEdBQXFCLElBQXJCO0FBQ0gsYUFGSSxNQUdBLElBQUksVUFBVSw0QkFBYSxnQkFBM0IsRUFBNkM7QUFDOUMscUJBQUssc0JBQUwsR0FBOEIsSUFBOUI7QUFDSCxhQUZJLE1BR0EsSUFBSSxVQUFVLDRCQUFhLFdBQTNCLEVBQXdDO0FBQ3pDLHFCQUFLLGtCQUFMLEdBQTBCLElBQTFCO0FBQ0gsYUFGSSxNQUdBLElBQUksVUFBVSw0QkFBYSxzQkFBM0IsRUFBbUQ7QUFDcEQscUJBQUssNEJBQUwsR0FBb0MsSUFBcEM7QUFDSDtBQUNKOzs7NEJBRUcsSyxFQUFPO0FBQ1AsZ0JBQUksVUFBVSw0QkFBYSxVQUEzQixFQUF1QztBQUNuQyxxQkFBSyxrQkFBTCxHQUEwQixJQUExQjtBQUNILGFBRkQsTUFHSyxJQUFJLFVBQVUsNEJBQWEsZUFBM0IsRUFBNEM7QUFDN0MscUJBQUssa0JBQUwsR0FBMEIsSUFBMUI7QUFDSCxhQUZJLE1BR0EsSUFBSSxVQUFVLDRCQUFhLEtBQTNCLEVBQWtDO0FBQ25DLHFCQUFLLGFBQUwsR0FBcUIsSUFBckI7QUFDSCxhQUZJLE1BR0EsSUFBSSxVQUFVLDRCQUFhLGdCQUEzQixFQUE2QztBQUM5QyxxQkFBSyxzQkFBTCxHQUE4QixJQUE5QjtBQUNILGFBRkksTUFHQSxJQUFJLFVBQVUsNEJBQWEsV0FBM0IsRUFBd0M7QUFDekMscUJBQUssa0JBQUwsR0FBMEIsSUFBMUI7QUFDSCxhQUZJLE1BR0EsSUFBSSxVQUFVLDRCQUFhLHNCQUEzQixFQUFtRDtBQUNwRCxxQkFBSyw0QkFBTCxHQUFvQyxJQUFwQztBQUNIO0FBQ0o7OzsyQ0FFa0IsRSxFQUFJO0FBQ25CLGlCQUFLLE9BQUwsR0FBZSxFQUFmO0FBQ0EsaUJBQUssT0FBTCxDQUFhLGdCQUFiLENBQThCLFlBQTlCLEVBQTRDLEtBQUssQ0FBTCxDQUFPLFlBQW5EO0FBQ0EsaUJBQUssTUFBTCxDQUFZLGtCQUFaLENBQStCLEVBQS9CO0FBQ0g7OzsrQkFFTTtBQUNILGdCQUFJLEtBQUssT0FBTCxJQUFnQixJQUFwQixFQUEwQjtBQUN0QixxQkFBSyxNQUFMLEdBQWMsSUFBSSxnQkFBSixFQUFkO0FBQ0EscUJBQUssTUFBTCxDQUFZLElBQVosQ0FBaUIsS0FBSyxPQUF0QjtBQUNBLHFCQUFLLE1BQUwsQ0FBWSxFQUFaLENBQWUsNEJBQWEsV0FBNUIsRUFBd0MsS0FBSyxhQUFMLENBQW1CLElBQW5CLENBQXdCLElBQXhCLENBQXhDO0FBQ0g7O0FBRUQsaUJBQUssTUFBTCxDQUFZLElBQVo7QUFDSDs7OytCQUVNO0FBQ0gsaUJBQUssTUFBTCxDQUFZLElBQVo7QUFDSDs7O2tDQUVTO0FBQ04sZ0JBQUksU0FBUyxTQUFTLGFBQVQsQ0FBdUIsUUFBdkIsQ0FBYjtBQUNBLG1CQUFPLEtBQVAsR0FBZSxLQUFLLE9BQUwsQ0FBYSxVQUE1QjtBQUNBLG1CQUFPLE1BQVAsR0FBZ0IsS0FBSyxPQUFMLENBQWEsV0FBN0I7QUFDQSxtQkFBTyxVQUFQLENBQWtCLElBQWxCLEVBQXdCLFNBQXhCLENBQWtDLEtBQUssT0FBdkMsRUFBZ0QsQ0FBaEQsRUFBbUQsQ0FBbkQsRUFBc0QsT0FBTyxLQUE3RCxFQUFvRSxPQUFPLE1BQTNFO0FBQ0EsZ0JBQUksVUFBVSxPQUFPLFNBQVAsRUFBZDtBQUNBLG1CQUFPLE9BQVA7QUFDSDs7O2dDQUVPO0FBQ0osaUJBQUssT0FBTCxDQUFhLEtBQWI7QUFDQSxtQkFBTyxLQUFQO0FBQ0g7OztpQ0FFUTtBQUNMLGlCQUFLLE9BQUwsQ0FBYSxJQUFiO0FBQ0EsbUJBQU8sS0FBUDtBQUNIOzs7MkNBRW1CO0FBQ2hCLGdCQUFJLFdBQVcsS0FBSyxPQUFMLENBQWEsUUFBNUI7QUFDQSxnQkFBSSxTQUFTLE1BQVQsR0FBa0IsQ0FBdEIsRUFBeUI7QUFDckIsb0JBQUksT0FBTyxTQUFTLEtBQVQsQ0FBZSxTQUFTLE1BQVQsR0FBaUIsQ0FBaEMsQ0FBWDtBQUNBLG9CQUFJLEtBQUssU0FBUyxHQUFULENBQWEsU0FBUyxNQUFULEdBQWlCLENBQTlCLENBQVQ7QUFDQSxxQkFBSyxPQUFMLENBQWEsV0FBYixHQUEyQixFQUEzQjtBQUNIO0FBQ0o7Ozs2QkFFSSxJLEVBQU07QUFDUCxnQkFBSSxLQUFLLE9BQUwsSUFBZ0IsSUFBcEIsRUFBMEI7QUFDdEIsdUJBQU8sS0FBUDtBQUNIO0FBQ0QsZ0JBQUksS0FBSyxPQUFULEVBQWtCO0FBQ2QsdUJBQU8sS0FBUDtBQUNIOztBQUVELGdCQUFJLEtBQUssNEJBQUwsSUFBcUMsSUFBekMsRUFBK0M7QUFDM0MscUJBQUssNEJBQUwsQ0FBa0Msc0NBQXVCLFNBQXpELEVBQ0ksVUFESjtBQUVIOztBQUVELGdCQUFJLENBQUMsS0FBSyxhQUFMLENBQW1CLElBQW5CLENBQUwsRUFBK0I7QUFDM0IsdUJBQU8sS0FBUDtBQUNIO0FBQ0QsZ0JBQUksS0FBSyxlQUFMLElBQXdCLGdCQUFnQixNQUE1QyxFQUFvRDtBQUNoRCxxQkFBSyxhQUFMLENBQW1CLElBQW5CO0FBQ0gsYUFGRCxNQUdLO0FBQ0QscUJBQUssY0FBTCxDQUFvQixJQUFwQjtBQUNIO0FBQ0QsbUJBQU8sSUFBUDtBQUNIOzs7a0NBRVM7QUFDTixnQkFBSSxLQUFLLE1BQUwsSUFBZSxJQUFuQixFQUF5QjtBQUNyQixxQkFBSyxNQUFMLENBQVksT0FBWjtBQUNIOztBQUVELGdCQUFJLEtBQUssTUFBTCxJQUFlLElBQW5CLEVBQXlCO0FBQ3JCLHFCQUFLLE1BQUwsQ0FBWSxLQUFaO0FBQ0EscUJBQUssTUFBTCxDQUFZLE1BQVo7QUFDQSxxQkFBSyxNQUFMLENBQVksa0JBQVo7QUFDQSxxQkFBSyxNQUFMLENBQVksT0FBWjtBQUNBLHFCQUFLLE1BQUwsR0FBYyxJQUFkO0FBQ0g7O0FBRUQsZ0JBQUksS0FBSyxPQUFMLElBQWdCLElBQXBCLEVBQTBCO0FBQ3RCLHFCQUFLLE9BQUwsQ0FBYSxtQkFBYixDQUFpQyxZQUFqQyxFQUErQyxLQUFLLENBQUwsQ0FBTyxZQUF0RDtBQUNBLHFCQUFLLE9BQUwsR0FBZSxJQUFmO0FBQ0g7QUFDSjs7O3FDQUVZLE0sRUFBUTtBQUNqQixnQkFBSSxVQUFVLElBQWQsRUFBb0I7QUFDaEI7QUFDSDs7QUFFRCxnQkFBSSxPQUFPLFlBQVAsSUFBdUIsSUFBM0IsRUFBaUM7QUFDN0IscUJBQUssWUFBTCxHQUFvQixPQUFPLFlBQTNCO0FBQ0g7O0FBRUQsZ0JBQUksT0FBTyxPQUFQLElBQWtCLElBQXRCLEVBQTRCO0FBQ3hCLHFCQUFLLE9BQUwsR0FBZSxPQUFPLE9BQXRCO0FBQ0g7QUFDSjs7O3FDQUVZLEcsRUFBSztBQUNkLGdCQUFJLElBQUksT0FBSixDQUFZLFdBQVosS0FBNEIsQ0FBQyxDQUFqQyxFQUFvQztBQUNoQyx1QkFBTyxLQUFQO0FBQ0g7QUFDRCxtQkFBTyxJQUFQO0FBQ0g7Ozs4Q0FFcUIsRyxFQUFLO0FBQ3ZCLGdCQUFJLE1BQU0sSUFBSSxLQUFKLENBQVUsVUFBVixDQUFWO0FBQ0EsZ0JBQUksSUFBSSxNQUFKLEdBQWEsQ0FBYixJQUFrQixJQUFJLENBQUosRUFBTyxNQUFQLEdBQWdCLENBQXRDLEVBQXlDO0FBQ3JDLHVCQUFPLGdCQUFnQixJQUF2QjtBQUNIO0FBQ0QsZ0JBQUksYUFBYSxJQUFJLENBQUosQ0FBakI7QUFDQSxnQkFBSSxhQUFhLFdBQVcsU0FBWCxDQUFxQixDQUFyQixFQUF1QixDQUF2QixDQUFqQjtBQUNBLGdCQUFJLGNBQWMsS0FBbEIsRUFBeUI7QUFDckIsdUJBQU8sZ0JBQWdCLE9BQXZCO0FBQ0g7QUFDRCxtQkFBTyxnQkFBZ0IsTUFBdkI7QUFDSDs7O3NDQUVhLEksRUFBTTtBQUNoQixnQkFBSSxDQUFDLEtBQUssU0FBVixFQUFxQjtBQUNqQix1QkFBTyxJQUFQO0FBQ0g7O0FBRUQsaUJBQUssT0FBTCxHQUFlLElBQWY7O0FBRUEsZ0JBQUksVUFBVSxLQUFkO0FBQ0EsZ0JBQUksV0FBVyxLQUFLLE9BQUwsQ0FBYSxRQUE1QjtBQUNBLGlCQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksU0FBUyxNQUE3QixFQUFxQyxHQUFyQyxFQUEwQztBQUN0QyxvQkFBSSxPQUFPLFNBQVMsS0FBVCxDQUFlLENBQWYsQ0FBWDtBQUNBLG9CQUFJLEtBQUssU0FBUyxHQUFULENBQWEsQ0FBYixDQUFUO0FBQ0Esb0JBQUksT0FBTyxJQUFQLElBQWUsT0FBTyxFQUExQixFQUE4QjtBQUMxQiw4QkFBVSxJQUFWO0FBQ0g7QUFDSjs7QUFFRCxnQkFBSSxXQUFXLE9BQU8sS0FBSyxPQUFMLENBQWEsV0FBbkMsRUFBZ0Q7QUFDNUMscUJBQUssT0FBTCxDQUFhLFdBQWIsR0FBMkIsSUFBM0I7QUFDQSxvQkFBSSxLQUFLLDRCQUFMLElBQXFDLElBQXpDLEVBQStDO0FBQzNDLHlCQUFLLDRCQUFMLENBQWtDLHNDQUF1QixXQUF6RCxFQUNJLFVBREo7QUFFSDtBQUNKLGFBTkQsTUFPSztBQUNELG9CQUFJLEtBQUssNEJBQUwsSUFBcUMsSUFBekMsRUFBK0M7QUFDM0MseUJBQUssNEJBQUwsQ0FBa0Msc0NBQXVCLFFBQXpELEVBQ0ksbUJBREo7QUFFSDtBQUNKOztBQUVELGlCQUFLLE9BQUwsR0FBZSxLQUFmO0FBQ0EsbUJBQU8sS0FBUDtBQUNIOzs7c0NBRWEsSSxFQUFNO0FBQUE7O0FBQ2hCLGlCQUFLLE9BQUwsR0FBZSxJQUFmOztBQUVBLGlCQUFLLGNBQUwsR0FBc0IsSUFBSSxJQUFKLEdBQVcsT0FBWCxFQUF0Qjs7QUFFQSxpQkFBSyxXQUFMLEdBQW1CLFdBQVcsWUFBSTtBQUM5Qix1QkFBSyxRQUFMLEdBQWdCLEtBQWhCO0FBQ0EsdUJBQUssT0FBTCxHQUFlLEtBQWY7QUFDQSxvQkFBSSxPQUFLLDRCQUFMLElBQXFDLElBQXpDLEVBQStDO0FBQzNDLDJCQUFLLDRCQUFMLENBQWtDLHNDQUF1QixRQUF6RCxFQUNJLGdCQURKO0FBRUg7QUFDSixhQVBrQixFQU9qQixLQUFHLElBUGMsQ0FBbkI7O0FBU0EsaUJBQUssUUFBTCxHQUFnQixJQUFoQjtBQUNBLGlCQUFLLFFBQUwsR0FBZ0IsSUFBaEI7QUFDSDs7O3VDQUVjLEksRUFBTTtBQUFBOztBQUNqQixpQkFBSyxPQUFMLEdBQWUsSUFBZjs7QUFFQSxpQkFBSyxRQUFMLEdBQWdCLElBQWhCO0FBQ0E7QUFDQSxnQkFBSSxXQUFXLEtBQUssT0FBTCxDQUFhLFFBQTVCO0FBQ0EsZ0JBQUksU0FBUyxNQUFULEdBQWtCLENBQXRCLEVBQXlCO0FBQ3JCO0FBQ0Esb0JBQUksT0FBTyxTQUFTLEtBQVQsQ0FBZSxDQUFmLENBQVg7QUFDQSxvQkFBSSxLQUFLLFNBQVMsR0FBVCxDQUFhLENBQWIsQ0FBVDtBQUNBLHFCQUFLLGdCQUFMLEdBQXdCLEVBQXhCOztBQUVBLHFCQUFLLE9BQUwsQ0FBYSxXQUFiLEdBQTJCLEtBQUssZ0JBQWhDO0FBQ0g7O0FBRUQsdUJBQVcsWUFBSTtBQUNYLHVCQUFLLE9BQUwsR0FBZSxLQUFmO0FBQ0Esb0JBQUksT0FBSyw0QkFBTCxJQUFxQyxJQUF6QyxFQUErQztBQUMzQywyQkFBSyw0QkFBTCxDQUFrQyxzQ0FBdUIsV0FBekQsRUFDSSxVQURKO0FBRUg7QUFDSixhQU5ELEVBTUUsSUFORjtBQU9IOzs7c0NBRWEsSSxFQUFNO0FBQ2hCLGdCQUFJLEtBQUssa0JBQUwsSUFBMkIsSUFBL0IsRUFBcUM7QUFDakMscUJBQUssa0JBQUwsQ0FBd0IsSUFBeEI7QUFDSDtBQUNKOzs7MENBRWlCLEksRUFBTTtBQUNwQixnQkFBSSxLQUFLLGtCQUFMLElBQTJCLElBQS9CLEVBQXFDO0FBQ2pDLG9CQUFJLE9BQU8sRUFBWDtBQUNBLHFCQUFLLEtBQUwsR0FBYSxLQUFLLEtBQWxCO0FBQ0EscUJBQUssa0JBQUwsQ0FBd0IsSUFBeEI7QUFDSDtBQUNKOzs7aUNBRVEsSSxFQUFNLE0sRUFBUSxNLEVBQVE7QUFDM0IsZ0JBQUksS0FBSyxhQUFMLElBQXNCLElBQTFCLEVBQWdDO0FBQzVCLG9CQUFJLFFBQVEsSUFBWjtBQUNBLG9CQUFJLFdBQVcsTUFBZjtBQUNBLG9CQUFJLE9BQU8sSUFBWDtBQUNBLHFCQUFLLGFBQUwsQ0FBbUIsSUFBbkIsRUFBeUIsUUFBekIsRUFBbUMsSUFBbkM7QUFDSDtBQUNKOzs7MENBRWlCLEksRUFBTTtBQUNwQixpQkFBSyxTQUFMLEdBQWlCLElBQWpCO0FBQ0EsZ0JBQUksS0FBSyxzQkFBTCxJQUErQixJQUFuQyxFQUF5QztBQUNyQyxxQkFBSyxzQkFBTDtBQUNIO0FBQ0o7Ozt1Q0FFYyxLLEVBQU87QUFDbEI7QUFDQSxnQkFBSSxLQUFLLFlBQUwsSUFBcUIsQ0FBekIsRUFBNEI7QUFDeEIsb0JBQUksS0FBSyxrQkFBTCxJQUEyQixJQUEzQixJQUFtQyxLQUFLLE9BQUwsSUFBZ0IsSUFBdkQsRUFBNkQ7QUFDekQseUJBQUssa0JBQUwsQ0FBd0IsS0FBSyxPQUFMLENBQWEsV0FBckM7QUFDSDtBQUNEO0FBQ0g7O0FBRUQ7QUFDQSxnQkFBSSxLQUFLLGVBQUwsS0FBeUIsZ0JBQWdCLE1BQTdDLEVBQXFEO0FBQ2pELG9CQUFJLENBQUMsS0FBSyxPQUFOLElBQWlCLEtBQUssa0JBQUwsSUFBMkIsSUFBNUMsSUFBb0QsS0FBSyxPQUFMLElBQWdCLElBQXhFLEVBQThFO0FBQzFFLHlCQUFLLGtCQUFMLENBQXdCLEtBQUssT0FBTCxDQUFhLFdBQXJDO0FBQ0g7QUFDSixhQUpELE1BS0ssSUFBSSxLQUFLLGVBQUwsS0FBeUIsZ0JBQWdCLE9BQTdDLEVBQXNEO0FBQ3ZELG9CQUFJLENBQUMsS0FBSyxPQUFOLElBQWlCLEtBQUssa0JBQUwsSUFBMkIsSUFBNUMsSUFBb0QsS0FBSyxPQUFMLElBQWdCLElBQXhFLEVBQThFO0FBQzFFLHdCQUFJLGNBQWMsS0FBSyxRQUFMLElBQWlCLEtBQUssT0FBTCxDQUFhLFdBQWIsR0FBMkIsS0FBSyxnQkFBakQsQ0FBbEI7QUFDQSx5QkFBSyxrQkFBTCxDQUF3QixXQUF4QjtBQUNIO0FBQ0o7QUFDSjs7O3NDQUVhLEksRUFBTTtBQUFBOztBQUNoQixnQkFBSSxLQUFLLFFBQVQsRUFBbUI7QUFDZixvQkFBSSxLQUFLLEdBQUwsQ0FBUyxLQUFLLFFBQUwsR0FBYyxJQUFkLEdBQXFCLElBQTlCLEtBQXVDLElBQTNDLEVBQWlEO0FBQzdDO0FBQ0g7O0FBRUQsb0JBQUksS0FBSyxXQUFMLElBQW9CLElBQXhCLEVBQThCO0FBQzFCLGlDQUFhLEtBQUssV0FBbEI7QUFDQSx5QkFBSyxXQUFMLEdBQW1CLElBQW5CO0FBQ0g7O0FBRUQscUJBQUssUUFBTCxHQUFnQixLQUFoQjtBQUNBLDJCQUFXLFlBQUk7QUFDWCwyQkFBSyxPQUFMLEdBQWUsS0FBZjtBQUNBLDJCQUFLLE9BQUwsQ0FBYSxXQUFiLEdBQTJCLE9BQUssSUFBaEM7QUFDQSx3QkFBSSxNQUFNLElBQUksSUFBSixHQUFXLE9BQVgsS0FBdUIsT0FBSyxjQUF0QztBQUNBLDRCQUFRLEdBQVIsQ0FBWSxXQUFXLEdBQXZCO0FBQ0Esd0JBQUksT0FBSyw0QkFBTCxJQUFxQyxJQUF6QyxFQUErQztBQUMzQywrQkFBSyw0QkFBTCxDQUFrQyxzQ0FBdUIsV0FBekQsRUFDSSxVQURKO0FBRUg7QUFDSixpQkFURCxFQVNFLElBVEY7QUFVQTtBQUNIO0FBQ0o7OztzQ0F4Vm9CO0FBQ2pCLG1CQUFPLE9BQU8sV0FBUCxJQUNILE9BQU8sV0FBUCxDQUFtQixlQUFuQixDQUFtQywyQ0FBbkMsQ0FESjtBQUVIOzs7O0VBeEM4QixnQjs7Ozs7Ozs7QUNmNUIsSUFBTSxzQ0FBZTtBQUN4QixvQkFBZ0I7QUFEUSxDQUFyQjs7QUFJQSxJQUFNLHNEQUF1QjtBQUNoQyxvQkFBZ0IsZ0JBRGdCO0FBRWhDLGtCQUFjO0FBRmtCLENBQTdCOztBQUtBLElBQU0sNERBQTBCO0FBQ25DLHlCQUFxQixxQkFEYztBQUVuQyw0QkFBd0Isd0JBRlc7QUFHbkMsa0JBQWMsY0FIcUI7QUFJbkMsZ0JBQVksWUFKdUI7QUFLbkMsK0JBQTJCLDJCQUxRO0FBTW5DLDRCQUF3QjtBQU5XLENBQWhDOzs7Ozs7Ozs7Ozs7O0lDVE0sTyxXQUFBLE87QUFFVCxxQkFBWSxRQUFaLEVBQXNCO0FBQUE7O0FBQ2xCLGFBQUssS0FBTCxHQUFhLFlBQVksV0FBekI7QUFDSDs7Ozs2QkFFSSxPLEVBQVMsSyxFQUFPLEksRUFBTSxPLEVBQVMsTSxFQUFRLENBQzNDOzs7MkJBRUUsSyxFQUFPLEksRUFBTSxDQUVmOzs7NEJBRUcsSyxFQUFPLENBRVY7OzsyQ0FFa0IsTyxFQUFTLENBQzNCOzs7K0JBRU0sQ0FDTjs7O2tDQUVTLENBRVQ7Ozs7Ozs7Ozs7Ozs7Ozs7QUN6Qkw7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7Ozs7QUFFQTs7OztBQUNBOztBQUNBOzs7Ozs7Ozs7O0FBRUEsSUFBTSxjQUFjLEdBQXBCO0FBQ0EsSUFBTSxZQUFZLEtBQWxCOztJQUVhLGEsV0FBQSxhOzs7QUFFVCw2QkFBZTtBQUFBOztBQUFBLGtJQUNMLGdCQURLOztBQUVYLGNBQUssR0FBTCxHQUFXLGVBQVg7O0FBRUEsY0FBSyxPQUFMLEdBQWUsSUFBZjtBQUNBLGNBQUssS0FBTCxHQUFhLElBQWI7QUFDQSxjQUFLLElBQUwsR0FBWSxJQUFaO0FBQ0EsY0FBSyxPQUFMLEdBQWUsSUFBZjs7QUFFQSxjQUFLLE1BQUwsR0FBYyxJQUFkO0FBQ0EsY0FBSyxRQUFMLEdBQWdCLElBQWhCO0FBQ0EsY0FBSyxNQUFMLEdBQWMsSUFBZDtBQUNBLGNBQUssT0FBTCxHQUFlLElBQWY7O0FBRUEsY0FBSyxxQkFBTCxHQUE2QixJQUE3Qjs7QUFFQSxjQUFLLFNBQUwsR0FBaUIsSUFBSSxvQkFBSixFQUFqQjs7QUFFQSxjQUFLLFVBQUwsR0FBa0IsSUFBbEI7QUFDQSxjQUFLLFNBQUwsR0FBaUIsSUFBakI7O0FBRUEsY0FBSyxvQkFBTCxHQUE0QixLQUE1QjtBQUNBLGNBQUssaUJBQUwsR0FBeUIsS0FBekI7QUFDQSxjQUFLLDRCQUFMLEdBQW9DLEtBQXBDO0FBQ0EsY0FBSyxVQUFMLEdBQWtCLEtBQWxCO0FBeEJXO0FBeUJkOzs7OzZCQU9JLE8sRUFBUyxLLEVBQU8sSSxFQUFNLE8sRUFBUyxNLEVBQVE7QUFDeEMsaUJBQUssT0FBTCxHQUFlLE9BQWY7QUFDQSxpQkFBSyxLQUFMLEdBQWEsS0FBYjtBQUNBLGlCQUFLLElBQUwsR0FBWSxJQUFaO0FBQ0EsaUJBQUssT0FBTCxHQUFlLE9BQWY7QUFDQSxnQkFBSSxDQUFDLEtBQUssZ0JBQUwsRUFBTCxFQUE4QjtBQUMxQix1QkFBTyxLQUFQO0FBQ0g7O0FBRUQsaUJBQUssWUFBTCxDQUFrQixPQUFsQjtBQUNBLG1CQUFPLElBQVA7QUFDSDs7OzJCQUVFLEssRUFBTyxJLEVBQU07QUFDWixnQkFBSSxVQUFVLDRCQUFhLGNBQTNCLEVBQTJDO0FBQ3ZDLHFCQUFLLHFCQUFMLEdBQTZCLElBQTdCO0FBQ0g7QUFDSjs7OzRCQUVHLEssRUFBTztBQUNQLGdCQUFJLFVBQVUsNEJBQWEsY0FBM0IsRUFBMkM7QUFDdkMscUJBQUsscUJBQUwsR0FBNkIsSUFBN0I7QUFDSDtBQUNKOzs7MkNBRWtCLE8sRUFBUztBQUN4QixpQkFBSyxPQUFMLEdBQWUsT0FBZjs7QUFFQSxpQkFBSyxPQUFMLENBQWEsZ0JBQWIsQ0FBOEIsWUFBOUIsRUFBNEMsS0FBSyxtQkFBTCxDQUF5QixJQUF6QixDQUE4QixJQUE5QixDQUE1QyxFQUFpRixFQUFDLE1BQU0sSUFBUCxFQUFqRjtBQUNBLGlCQUFLLE1BQUwsQ0FBWSxFQUFaLENBQWUsZUFBTSxNQUFOLENBQWEsS0FBNUIsRUFBbUMsS0FBSyxjQUFMLENBQW9CLElBQXBCLENBQXlCLElBQXpCLENBQW5DO0FBQ0EsaUJBQUssTUFBTCxDQUFZLHlCQUFaLENBQXNDLEtBQUssdUJBQUwsQ0FBNkIsSUFBN0IsQ0FBa0MsSUFBbEMsQ0FBdEM7O0FBRUEsaUJBQUssTUFBTCxDQUFZLGtCQUFaLENBQStCLE9BQS9CO0FBQ0g7OzsrQkFFTTtBQUNILGlCQUFLLE1BQUwsQ0FBWSxJQUFaO0FBQ0EsaUJBQUssWUFBTCxDQUFrQixLQUFLLEtBQXZCO0FBQ0g7OztrQ0FFUztBQUNOLGlCQUFLLFVBQUwsR0FBa0IsSUFBbEI7O0FBRUEsaUJBQUssY0FBTDtBQUNBLGlCQUFLLGNBQUw7QUFDQSxpQkFBSyxnQkFBTDtBQUNBLGlCQUFLLGdCQUFMO0FBQ0g7OzsyQ0FFa0I7QUFDZixnQkFBSSxXQUFLLGFBQUwsQ0FBbUIsS0FBSyxPQUF4QixLQUFvQyxXQUFLLGFBQUwsQ0FBbUIsS0FBSyxLQUF4QixDQUF4QyxFQUF3RTtBQUNwRSx1QkFBTyxLQUFQO0FBQ0g7QUFDRCxnQkFBSSxXQUFLLGFBQUwsQ0FBbUIsS0FBSyxJQUF4QixDQUFKLEVBQW1DO0FBQy9CLHVCQUFPLEtBQVA7QUFDSDtBQUNELGdCQUFJLEtBQUssT0FBTCxHQUFlLENBQWYsSUFBb0IsS0FBSyxPQUFMLEdBQWUsR0FBdkMsRUFBNEM7QUFDeEMsdUJBQU8sS0FBUDtBQUNIO0FBQ0QsbUJBQU8sSUFBUDtBQUNIOzs7cUNBRVksRyxFQUFLO0FBQ2QsaUJBQUssY0FBTDs7QUFFQSxpQkFBSyxNQUFMLEdBQWMsZUFBTSxZQUFOLENBQW1CLEVBQUMsUUFBTyxJQUFSLEVBQWMsTUFBSyxLQUFuQixFQUF5QixLQUFJLEdBQTdCLEVBQW5CLEVBQXNEO0FBQ2hFLDBCQUFVLEtBRHNEO0FBRWhFLG1DQUFtQixLQUY2QztBQUdoRSwwQ0FBeUI7QUFIdUMsYUFBdEQsQ0FBZDtBQUtIOzs7OENBRXFCO0FBQ2xCLGdCQUFJLFNBQUosRUFBZTtBQUNYLHdCQUFRLEdBQVIsQ0FBWSxtQkFBWjtBQUNIOztBQUVELGlCQUFLLG9CQUFMLEdBQTRCLElBQTVCO0FBQ0EsZ0JBQUksS0FBSyxpQkFBTCxJQUEwQixLQUFLLHFCQUFMLElBQThCLElBQTVELEVBQWtFO0FBQzlELHFCQUFLLHFCQUFMLENBQTJCLG9DQUFxQixjQUFoRCxFQUFnRSxFQUFoRTtBQUNIO0FBQ0o7Ozt1Q0FFYyxJLEVBQU0sTSxFQUFRLE0sRUFBUTtBQUNqQyxnQkFBSSxTQUFKLEVBQWU7QUFDWCx3QkFBUSxHQUFSLENBQVksY0FBWjtBQUNIOztBQUVELGdCQUFJLEtBQUsscUJBQUwsSUFBOEIsSUFBbEMsRUFBd0M7QUFDcEM7QUFDSDs7QUFFRCxnQkFBSSxLQUFLLG9CQUFULEVBQStCO0FBQzNCLHFCQUFLLHFCQUFMLENBQTJCLG9DQUFxQixZQUFoRCxFQUNJLHVDQUF3QixZQUQ1QjtBQUVILGFBSEQsTUFJSztBQUNELHFCQUFLLHFCQUFMLENBQTJCLG9DQUFxQixZQUFoRCxFQUNJLHVDQUF3QixtQkFENUI7QUFFSDtBQUNKOzs7Z0RBRXVCLEksRUFBTTtBQUMxQixnQkFBSSxTQUFKLEVBQWU7QUFDWCx3QkFBUSxHQUFSLENBQVksbUJBQVo7QUFDSDs7QUFFRCxnQkFBSSxLQUFLLHFCQUFMLElBQThCLElBQWxDLEVBQXdDO0FBQ3BDLHFCQUFLLHFCQUFMLENBQTJCLG9DQUFxQixZQUFoRCxFQUNJLHVDQUF3QixzQkFENUI7QUFFSDtBQUNKOzs7eUNBRWdCO0FBQ2IsZ0JBQUksS0FBSyxNQUFMLElBQWUsSUFBbkIsRUFBeUI7QUFDckIscUJBQUssTUFBTCxDQUFZLEtBQVo7QUFDQSxxQkFBSyxNQUFMLENBQVksTUFBWjtBQUNBLHFCQUFLLE1BQUwsQ0FBWSxrQkFBWjtBQUNBLHFCQUFLLE1BQUwsQ0FBWSxPQUFaO0FBQ0EscUJBQUssTUFBTCxHQUFjLElBQWQ7QUFDSDs7QUFFRCxnQkFBSSxLQUFLLE9BQUwsSUFBZ0IsSUFBcEIsRUFBMEI7QUFDdEIscUJBQUssT0FBTCxHQUFlLElBQWY7QUFDSDtBQUNKOzs7cUNBRVksRyxFQUFLO0FBQ2QsaUJBQUssTUFBTCxHQUFjLElBQUksU0FBSixDQUFjLEdBQWQsQ0FBZDtBQUNBLGlCQUFLLE1BQUwsQ0FBWSxNQUFaLEdBQXFCLEtBQUssYUFBTCxDQUFtQixJQUFuQixDQUF3QixJQUF4QixDQUFyQjtBQUNBLGlCQUFLLE1BQUwsQ0FBWSxTQUFaLEdBQXdCLEtBQUssWUFBTCxDQUFrQixJQUFsQixDQUF1QixJQUF2QixDQUF4QjtBQUNBLGlCQUFLLE1BQUwsQ0FBWSxPQUFaLEdBQXNCLEtBQUssY0FBTCxDQUFvQixJQUFwQixDQUF5QixJQUF6QixDQUF0QjtBQUNBLGlCQUFLLE1BQUwsQ0FBWSxPQUFaLEdBQXNCLEtBQUssY0FBTCxDQUFvQixJQUFwQixDQUF5QixJQUF6QixDQUF0QjtBQUNIOzs7d0NBRWU7QUFDWixnQkFBSSxTQUFKLEVBQWU7QUFDWCx3QkFBUSxHQUFSLENBQVksZ0JBQVo7QUFDSDs7QUFFRCxpQkFBSyxjQUFMO0FBQ0g7OztxQ0FFWSxDLEVBQUcsQ0FFZjs7O3VDQUVjLEMsRUFBRztBQUNkLGdCQUFJLFNBQUosRUFBZTtBQUNYLHdCQUFRLEdBQVIsQ0FBWSxpQkFBWjtBQUNIOztBQUVELGdCQUFJLEtBQUsscUJBQUwsSUFBOEIsSUFBbEMsRUFBd0M7QUFDcEMscUJBQUsscUJBQUwsQ0FBMkIsb0NBQXFCLFlBQWhELEVBQ0ksdUNBQXdCLFVBRDVCO0FBRUg7QUFDSjs7O3VDQUVjLEMsRUFBRztBQUNkLGdCQUFJLFNBQUosRUFBZTtBQUNYLHdCQUFRLEdBQVIsQ0FBWSxpQkFBWjtBQUNIO0FBQ0o7Ozt5Q0FFZ0I7QUFDYixpQkFBSyxNQUFMLENBQVksS0FBWjtBQUNBLGlCQUFLLE1BQUwsR0FBYyxJQUFkO0FBQ0g7Ozt5Q0FFZ0I7QUFDYixnQkFBSSxLQUFLLFFBQVQsRUFBbUI7QUFDZixxQkFBSyxRQUFMLENBQWMsS0FBZDtBQUNIOztBQUVELGlCQUFLLFFBQUwsR0FBZ0IsNEJBQVM7QUFDckIsc0JBQUssS0FEZ0I7QUFFckIsNEJBQVcsSUFGVTtBQUdyQix5QkFBUSxFQUhhO0FBSXJCLDJCQUFVLEtBQUssd0JBQUwsQ0FBOEIsSUFBOUIsQ0FBbUMsSUFBbkM7QUFKVyxhQUFULENBQWhCO0FBTUEsaUJBQUssVUFBTCxHQUFrQixXQUFXLEtBQUssa0NBQUwsQ0FBd0MsSUFBeEMsQ0FBNkMsSUFBN0MsQ0FBWCxFQUE4RCxLQUE5RCxDQUFsQjtBQUNBLGlCQUFLLFFBQUwsQ0FBYyxJQUFkLENBQW1CLEtBQUssc0JBQUwsQ0FBNEIsSUFBNUIsQ0FBaUMsSUFBakMsQ0FBbkIsRUFDSSxLQUFLLHlCQUFMLENBQStCLElBQS9CLENBQW9DLElBQXBDLENBREo7QUFFSDs7OzZEQUVvQztBQUNqQyxnQkFBSSxTQUFKLEVBQWU7QUFDWCx3QkFBUSxHQUFSLENBQVksaUNBQVo7QUFDSDs7QUFFRCxpQkFBSyw0QkFBTCxHQUFvQyxJQUFwQzs7QUFFQSxnQkFBSSxLQUFLLHFCQUFMLElBQThCLElBQWxDLEVBQXdDO0FBQ3BDLHFCQUFLLHFCQUFMLENBQTJCLG9DQUFxQixZQUFoRCxFQUNJLHVDQUF3Qix5QkFENUI7QUFFSDtBQUNKOzs7aURBRXdCO0FBQ3JCLGdCQUFJLFNBQUosRUFBZTtBQUNYLHdCQUFRLEdBQVIsQ0FBWSwwQkFBWjtBQUNIOztBQUVELGdCQUFJLEtBQUssNEJBQVQsRUFBdUM7QUFDbkM7QUFDSDs7QUFFRCx5QkFBYSxLQUFLLFVBQWxCOztBQUVBLGlCQUFLLGlCQUFMLEdBQXlCLElBQXpCO0FBQ0EsZ0JBQUksS0FBSyxvQkFBTCxJQUE2QixLQUFLLHFCQUFMLElBQThCLElBQS9ELEVBQXFFO0FBQ2pFLHFCQUFLLHFCQUFMLENBQTJCLG9DQUFxQixjQUFoRCxFQUFnRSxFQUFoRTtBQUNIOztBQUVELGlCQUFLLFFBQUwsQ0FBYyxLQUFkO0FBQ0EsaUJBQUssU0FBTDtBQUNIOzs7a0RBRXlCLEcsRUFBSyxjLEVBQWdCO0FBQzNDLGdCQUFJLFNBQUosRUFBZTtBQUNYLHdCQUFRLEdBQVIsQ0FBWSw2QkFBWjtBQUNIOztBQUVELHlCQUFhLEtBQUssVUFBbEI7O0FBRUEsZ0JBQUksS0FBSyxxQkFBTCxJQUE4QixJQUFsQyxFQUF3QztBQUNwQyxxQkFBSyxxQkFBTCxDQUEyQixvQ0FBcUIsWUFBaEQsRUFDSSx1Q0FBd0Isc0JBRDVCO0FBRUg7QUFDSjs7O2lEQUV3QixPLEVBQVMsVSxFQUFZLGMsRUFBZ0IsZ0IsRUFBa0I7QUFDNUUsZ0JBQUksV0FBVyxRQUFRLFFBQVEsTUFBUixHQUFpQixDQUF6QixFQUE0QixNQUEzQyxDQUQ0RSxDQUN6QjtBQUNuRCxnQkFBSSxRQUFRLElBQUksVUFBSixDQUFlLFFBQWYsQ0FBWixDQUY0RSxDQUV0QztBQUN0QyxpQkFBSyxTQUFMLENBQWUsSUFBZixDQUFvQixLQUFwQjtBQUNIOzs7MkNBRWtCO0FBQ2YsaUJBQUssUUFBTCxDQUFjLEtBQWQ7QUFDQSxpQkFBSyxRQUFMLEdBQWdCLElBQWhCO0FBQ0g7OztvQ0FFVztBQUNSLGdCQUFJLEtBQUssVUFBVCxFQUFxQjtBQUNqQjtBQUNIOztBQUVELGdCQUFJLEtBQUssU0FBTCxDQUFlLE1BQWYsR0FBd0IsV0FBNUIsRUFBeUM7QUFDckMscUJBQUssU0FBTCxHQUFpQixXQUFXLEtBQUssU0FBTCxDQUFlLElBQWYsQ0FBb0IsSUFBcEIsQ0FBWCxFQUFzQyxDQUF0QyxDQUFqQjtBQUNILGFBRkQsTUFHSztBQUNELG9CQUFJLFdBQVcsS0FBSyxTQUFMLENBQWUsU0FBZixDQUF5QixXQUF6QixDQUFmOztBQUVBLG9CQUFJLFNBQVMsSUFBSSxvQkFBSixFQUFiO0FBQ0EsdUJBQU8sSUFBUCxDQUFZLElBQUksVUFBSixDQUFlLENBQUMsSUFBRCxFQUFNLElBQU4sRUFBVyxJQUFYLEVBQWdCLElBQWhCLENBQWYsQ0FBWjtBQUNBLG9CQUFJLGNBQWMsS0FBSyxJQUFMLENBQVUsS0FBVixDQUFnQixFQUFoQixDQUFsQjtBQUNBLHFCQUFLLElBQUksSUFBSSxDQUFiLEVBQWdCLElBQUksWUFBWSxNQUFoQyxFQUF3QyxHQUF4QyxFQUE2QztBQUN6QywyQkFBTyxJQUFQLENBQVksSUFBSSxVQUFKLENBQWUsQ0FBQyxZQUFZLENBQVosRUFBZSxVQUFmLEVBQUQsQ0FBZixDQUFaO0FBQ0g7QUFDRCx1QkFBTyxJQUFQLENBQVksSUFBSSxVQUFKLENBQWUsQ0FBQyxTQUFTLEtBQUssT0FBZCxDQUFELENBQWYsQ0FBWjtBQUNBLHVCQUFPLElBQVAsQ0FBWSxJQUFJLFVBQUosQ0FBZSxDQUFDLEtBQUssS0FBTCxDQUFXLGNBQVksR0FBdkIsQ0FBRCxDQUFmLENBQVo7QUFDQSx1QkFBTyxJQUFQLENBQVksSUFBSSxVQUFKLENBQWUsQ0FBQyxjQUFZLEdBQWIsQ0FBZixDQUFaO0FBQ0EsdUJBQU8sSUFBUCxDQUFZLFFBQVo7O0FBRUEsb0JBQUksV0FBVyxJQUFJLFlBQVksTUFBaEIsR0FBeUIsQ0FBekIsR0FBNkIsV0FBNUM7QUFDQSxvQkFBSSxLQUFLLE1BQUwsSUFBZSxJQUFuQixFQUF5QjtBQUNyQix5QkFBSyxNQUFMLENBQVksSUFBWixDQUFpQixPQUFPLFNBQVAsQ0FBaUIsUUFBakIsQ0FBakI7QUFDSDs7QUFFRCxxQkFBSyxTQUFMO0FBQ0g7QUFDSjs7OzJDQUVrQjtBQUNmLHlCQUFhLEtBQUssU0FBbEI7QUFDSDs7O3NDQXhSb0I7QUFDakIsbUJBQU8sT0FBTyxTQUFQLElBQW9CLFdBQXBCLElBQW1DLHVCQUFTLE9BQVQsRUFBbkMsSUFBeUQsT0FBTyxXQUFoRSxJQUNILE9BQU8sV0FBUCxDQUFtQixlQUFuQixDQUFtQywyQ0FBbkMsQ0FESjtBQUVIOzs7O0VBaEM4QixnQiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIihmdW5jdGlvbihmKXtpZih0eXBlb2YgZXhwb3J0cz09PVwib2JqZWN0XCImJnR5cGVvZiBtb2R1bGUhPT1cInVuZGVmaW5lZFwiKXttb2R1bGUuZXhwb3J0cz1mKCl9ZWxzZSBpZih0eXBlb2YgZGVmaW5lPT09XCJmdW5jdGlvblwiJiZkZWZpbmUuYW1kKXtkZWZpbmUoW10sZil9ZWxzZXt2YXIgZztpZih0eXBlb2Ygd2luZG93IT09XCJ1bmRlZmluZWRcIil7Zz13aW5kb3d9ZWxzZSBpZih0eXBlb2YgZ2xvYmFsIT09XCJ1bmRlZmluZWRcIil7Zz1nbG9iYWx9ZWxzZSBpZih0eXBlb2Ygc2VsZiE9PVwidW5kZWZpbmVkXCIpe2c9c2VsZn1lbHNle2c9dGhpc31nLmZsdmpzID0gZigpfX0pKGZ1bmN0aW9uKCl7dmFyIGRlZmluZSxtb2R1bGUsZXhwb3J0cztyZXR1cm4gKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkoezE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuKGZ1bmN0aW9uIChwcm9jZXNzLGdsb2JhbCl7XG4vKiFcbiAqIEBvdmVydmlldyBlczYtcHJvbWlzZSAtIGEgdGlueSBpbXBsZW1lbnRhdGlvbiBvZiBQcm9taXNlcy9BKy5cbiAqIEBjb3B5cmlnaHQgQ29weXJpZ2h0IChjKSAyMDE0IFllaHVkYSBLYXR6LCBUb20gRGFsZSwgU3RlZmFuIFBlbm5lciBhbmQgY29udHJpYnV0b3JzIChDb252ZXJzaW9uIHRvIEVTNiBBUEkgYnkgSmFrZSBBcmNoaWJhbGQpXG4gKiBAbGljZW5zZSAgIExpY2Vuc2VkIHVuZGVyIE1JVCBsaWNlbnNlXG4gKiAgICAgICAgICAgIFNlZSBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vc3RlZmFucGVubmVyL2VzNi1wcm9taXNlL21hc3Rlci9MSUNFTlNFXG4gKiBAdmVyc2lvbiAgIHY0LjIuNSs3ZjJiNTI2ZFxuICovXG5cbihmdW5jdGlvbiAoZ2xvYmFsLCBmYWN0b3J5KSB7XG5cdHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJyA/IG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpIDpcblx0dHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKGZhY3RvcnkpIDpcblx0KGdsb2JhbC5FUzZQcm9taXNlID0gZmFjdG9yeSgpKTtcbn0odGhpcywgKGZ1bmN0aW9uICgpIHsgJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBvYmplY3RPckZ1bmN0aW9uKHgpIHtcbiAgdmFyIHR5cGUgPSB0eXBlb2YgeDtcbiAgcmV0dXJuIHggIT09IG51bGwgJiYgKHR5cGUgPT09ICdvYmplY3QnIHx8IHR5cGUgPT09ICdmdW5jdGlvbicpO1xufVxuXG5mdW5jdGlvbiBpc0Z1bmN0aW9uKHgpIHtcbiAgcmV0dXJuIHR5cGVvZiB4ID09PSAnZnVuY3Rpb24nO1xufVxuXG5cblxudmFyIF9pc0FycmF5ID0gdm9pZCAwO1xuaWYgKEFycmF5LmlzQXJyYXkpIHtcbiAgX2lzQXJyYXkgPSBBcnJheS5pc0FycmF5O1xufSBlbHNlIHtcbiAgX2lzQXJyYXkgPSBmdW5jdGlvbiAoeCkge1xuICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoeCkgPT09ICdbb2JqZWN0IEFycmF5XSc7XG4gIH07XG59XG5cbnZhciBpc0FycmF5ID0gX2lzQXJyYXk7XG5cbnZhciBsZW4gPSAwO1xudmFyIHZlcnR4TmV4dCA9IHZvaWQgMDtcbnZhciBjdXN0b21TY2hlZHVsZXJGbiA9IHZvaWQgMDtcblxudmFyIGFzYXAgPSBmdW5jdGlvbiBhc2FwKGNhbGxiYWNrLCBhcmcpIHtcbiAgcXVldWVbbGVuXSA9IGNhbGxiYWNrO1xuICBxdWV1ZVtsZW4gKyAxXSA9IGFyZztcbiAgbGVuICs9IDI7XG4gIGlmIChsZW4gPT09IDIpIHtcbiAgICAvLyBJZiBsZW4gaXMgMiwgdGhhdCBtZWFucyB0aGF0IHdlIG5lZWQgdG8gc2NoZWR1bGUgYW4gYXN5bmMgZmx1c2guXG4gICAgLy8gSWYgYWRkaXRpb25hbCBjYWxsYmFja3MgYXJlIHF1ZXVlZCBiZWZvcmUgdGhlIHF1ZXVlIGlzIGZsdXNoZWQsIHRoZXlcbiAgICAvLyB3aWxsIGJlIHByb2Nlc3NlZCBieSB0aGlzIGZsdXNoIHRoYXQgd2UgYXJlIHNjaGVkdWxpbmcuXG4gICAgaWYgKGN1c3RvbVNjaGVkdWxlckZuKSB7XG4gICAgICBjdXN0b21TY2hlZHVsZXJGbihmbHVzaCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNjaGVkdWxlRmx1c2goKTtcbiAgICB9XG4gIH1cbn07XG5cbmZ1bmN0aW9uIHNldFNjaGVkdWxlcihzY2hlZHVsZUZuKSB7XG4gIGN1c3RvbVNjaGVkdWxlckZuID0gc2NoZWR1bGVGbjtcbn1cblxuZnVuY3Rpb24gc2V0QXNhcChhc2FwRm4pIHtcbiAgYXNhcCA9IGFzYXBGbjtcbn1cblxudmFyIGJyb3dzZXJXaW5kb3cgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHVuZGVmaW5lZDtcbnZhciBicm93c2VyR2xvYmFsID0gYnJvd3NlcldpbmRvdyB8fCB7fTtcbnZhciBCcm93c2VyTXV0YXRpb25PYnNlcnZlciA9IGJyb3dzZXJHbG9iYWwuTXV0YXRpb25PYnNlcnZlciB8fCBicm93c2VyR2xvYmFsLldlYktpdE11dGF0aW9uT2JzZXJ2ZXI7XG52YXIgaXNOb2RlID0gdHlwZW9mIHNlbGYgPT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHByb2Nlc3MpID09PSAnW29iamVjdCBwcm9jZXNzXSc7XG5cbi8vIHRlc3QgZm9yIHdlYiB3b3JrZXIgYnV0IG5vdCBpbiBJRTEwXG52YXIgaXNXb3JrZXIgPSB0eXBlb2YgVWludDhDbGFtcGVkQXJyYXkgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBpbXBvcnRTY3JpcHRzICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgTWVzc2FnZUNoYW5uZWwgIT09ICd1bmRlZmluZWQnO1xuXG4vLyBub2RlXG5mdW5jdGlvbiB1c2VOZXh0VGljaygpIHtcbiAgLy8gbm9kZSB2ZXJzaW9uIDAuMTAueCBkaXNwbGF5cyBhIGRlcHJlY2F0aW9uIHdhcm5pbmcgd2hlbiBuZXh0VGljayBpcyB1c2VkIHJlY3Vyc2l2ZWx5XG4gIC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vY3Vqb2pzL3doZW4vaXNzdWVzLzQxMCBmb3IgZGV0YWlsc1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBwcm9jZXNzLm5leHRUaWNrKGZsdXNoKTtcbiAgfTtcbn1cblxuLy8gdmVydHhcbmZ1bmN0aW9uIHVzZVZlcnR4VGltZXIoKSB7XG4gIGlmICh0eXBlb2YgdmVydHhOZXh0ICE9PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICB2ZXJ0eE5leHQoZmx1c2gpO1xuICAgIH07XG4gIH1cblxuICByZXR1cm4gdXNlU2V0VGltZW91dCgpO1xufVxuXG5mdW5jdGlvbiB1c2VNdXRhdGlvbk9ic2VydmVyKCkge1xuICB2YXIgaXRlcmF0aW9ucyA9IDA7XG4gIHZhciBvYnNlcnZlciA9IG5ldyBCcm93c2VyTXV0YXRpb25PYnNlcnZlcihmbHVzaCk7XG4gIHZhciBub2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpO1xuICBvYnNlcnZlci5vYnNlcnZlKG5vZGUsIHsgY2hhcmFjdGVyRGF0YTogdHJ1ZSB9KTtcblxuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIG5vZGUuZGF0YSA9IGl0ZXJhdGlvbnMgPSArK2l0ZXJhdGlvbnMgJSAyO1xuICB9O1xufVxuXG4vLyB3ZWIgd29ya2VyXG5mdW5jdGlvbiB1c2VNZXNzYWdlQ2hhbm5lbCgpIHtcbiAgdmFyIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWwoKTtcbiAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBmbHVzaDtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gY2hhbm5lbC5wb3J0Mi5wb3N0TWVzc2FnZSgwKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gdXNlU2V0VGltZW91dCgpIHtcbiAgLy8gU3RvcmUgc2V0VGltZW91dCByZWZlcmVuY2Ugc28gZXM2LXByb21pc2Ugd2lsbCBiZSB1bmFmZmVjdGVkIGJ5XG4gIC8vIG90aGVyIGNvZGUgbW9kaWZ5aW5nIHNldFRpbWVvdXQgKGxpa2Ugc2lub24udXNlRmFrZVRpbWVycygpKVxuICB2YXIgZ2xvYmFsU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGdsb2JhbFNldFRpbWVvdXQoZmx1c2gsIDEpO1xuICB9O1xufVxuXG52YXIgcXVldWUgPSBuZXcgQXJyYXkoMTAwMCk7XG5mdW5jdGlvbiBmbHVzaCgpIHtcbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gMikge1xuICAgIHZhciBjYWxsYmFjayA9IHF1ZXVlW2ldO1xuICAgIHZhciBhcmcgPSBxdWV1ZVtpICsgMV07XG5cbiAgICBjYWxsYmFjayhhcmcpO1xuXG4gICAgcXVldWVbaV0gPSB1bmRlZmluZWQ7XG4gICAgcXVldWVbaSArIDFdID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgbGVuID0gMDtcbn1cblxuZnVuY3Rpb24gYXR0ZW1wdFZlcnR4KCkge1xuICB0cnkge1xuICAgIHZhciB2ZXJ0eCA9IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCkucmVxdWlyZSgndmVydHgnKTtcbiAgICB2ZXJ0eE5leHQgPSB2ZXJ0eC5ydW5Pbkxvb3AgfHwgdmVydHgucnVuT25Db250ZXh0O1xuICAgIHJldHVybiB1c2VWZXJ0eFRpbWVyKCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gdXNlU2V0VGltZW91dCgpO1xuICB9XG59XG5cbnZhciBzY2hlZHVsZUZsdXNoID0gdm9pZCAwO1xuLy8gRGVjaWRlIHdoYXQgYXN5bmMgbWV0aG9kIHRvIHVzZSB0byB0cmlnZ2VyaW5nIHByb2Nlc3Npbmcgb2YgcXVldWVkIGNhbGxiYWNrczpcbmlmIChpc05vZGUpIHtcbiAgc2NoZWR1bGVGbHVzaCA9IHVzZU5leHRUaWNrKCk7XG59IGVsc2UgaWYgKEJyb3dzZXJNdXRhdGlvbk9ic2VydmVyKSB7XG4gIHNjaGVkdWxlRmx1c2ggPSB1c2VNdXRhdGlvbk9ic2VydmVyKCk7XG59IGVsc2UgaWYgKGlzV29ya2VyKSB7XG4gIHNjaGVkdWxlRmx1c2ggPSB1c2VNZXNzYWdlQ2hhbm5lbCgpO1xufSBlbHNlIGlmIChicm93c2VyV2luZG93ID09PSB1bmRlZmluZWQgJiYgdHlwZW9mIF9kZXJlcV8gPT09ICdmdW5jdGlvbicpIHtcbiAgc2NoZWR1bGVGbHVzaCA9IGF0dGVtcHRWZXJ0eCgpO1xufSBlbHNlIHtcbiAgc2NoZWR1bGVGbHVzaCA9IHVzZVNldFRpbWVvdXQoKTtcbn1cblxuZnVuY3Rpb24gdGhlbihvbkZ1bGZpbGxtZW50LCBvblJlamVjdGlvbikge1xuICB2YXIgcGFyZW50ID0gdGhpcztcblxuICB2YXIgY2hpbGQgPSBuZXcgdGhpcy5jb25zdHJ1Y3Rvcihub29wKTtcblxuICBpZiAoY2hpbGRbUFJPTUlTRV9JRF0gPT09IHVuZGVmaW5lZCkge1xuICAgIG1ha2VQcm9taXNlKGNoaWxkKTtcbiAgfVxuXG4gIHZhciBfc3RhdGUgPSBwYXJlbnQuX3N0YXRlO1xuXG5cbiAgaWYgKF9zdGF0ZSkge1xuICAgIHZhciBjYWxsYmFjayA9IGFyZ3VtZW50c1tfc3RhdGUgLSAxXTtcbiAgICBhc2FwKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBpbnZva2VDYWxsYmFjayhfc3RhdGUsIGNoaWxkLCBjYWxsYmFjaywgcGFyZW50Ll9yZXN1bHQpO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHN1YnNjcmliZShwYXJlbnQsIGNoaWxkLCBvbkZ1bGZpbGxtZW50LCBvblJlamVjdGlvbik7XG4gIH1cblxuICByZXR1cm4gY2hpbGQ7XG59XG5cbi8qKlxuICBgUHJvbWlzZS5yZXNvbHZlYCByZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdpbGwgYmVjb21lIHJlc29sdmVkIHdpdGggdGhlXG4gIHBhc3NlZCBgdmFsdWVgLiBJdCBpcyBzaG9ydGhhbmQgZm9yIHRoZSBmb2xsb3dpbmc6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG4gICAgcmVzb2x2ZSgxKTtcbiAgfSk7XG5cbiAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAvLyB2YWx1ZSA9PT0gMVxuICB9KTtcbiAgYGBgXG5cbiAgSW5zdGVhZCBvZiB3cml0aW5nIHRoZSBhYm92ZSwgeW91ciBjb2RlIG5vdyBzaW1wbHkgYmVjb21lcyB0aGUgZm9sbG93aW5nOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoMSk7XG5cbiAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAvLyB2YWx1ZSA9PT0gMVxuICB9KTtcbiAgYGBgXG5cbiAgQG1ldGhvZCByZXNvbHZlXG4gIEBzdGF0aWNcbiAgQHBhcmFtIHtBbnl9IHZhbHVlIHZhbHVlIHRoYXQgdGhlIHJldHVybmVkIHByb21pc2Ugd2lsbCBiZSByZXNvbHZlZCB3aXRoXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQHJldHVybiB7UHJvbWlzZX0gYSBwcm9taXNlIHRoYXQgd2lsbCBiZWNvbWUgZnVsZmlsbGVkIHdpdGggdGhlIGdpdmVuXG4gIGB2YWx1ZWBcbiovXG5mdW5jdGlvbiByZXNvbHZlJDEob2JqZWN0KSB7XG4gIC8qanNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gIHZhciBDb25zdHJ1Y3RvciA9IHRoaXM7XG5cbiAgaWYgKG9iamVjdCAmJiB0eXBlb2Ygb2JqZWN0ID09PSAnb2JqZWN0JyAmJiBvYmplY3QuY29uc3RydWN0b3IgPT09IENvbnN0cnVjdG9yKSB7XG4gICAgcmV0dXJuIG9iamVjdDtcbiAgfVxuXG4gIHZhciBwcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKG5vb3ApO1xuICByZXNvbHZlKHByb21pc2UsIG9iamVjdCk7XG4gIHJldHVybiBwcm9taXNlO1xufVxuXG52YXIgUFJPTUlTRV9JRCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyKTtcblxuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbnZhciBQRU5ESU5HID0gdm9pZCAwO1xudmFyIEZVTEZJTExFRCA9IDE7XG52YXIgUkVKRUNURUQgPSAyO1xuXG52YXIgVFJZX0NBVENIX0VSUk9SID0geyBlcnJvcjogbnVsbCB9O1xuXG5mdW5jdGlvbiBzZWxmRnVsZmlsbG1lbnQoKSB7XG4gIHJldHVybiBuZXcgVHlwZUVycm9yKFwiWW91IGNhbm5vdCByZXNvbHZlIGEgcHJvbWlzZSB3aXRoIGl0c2VsZlwiKTtcbn1cblxuZnVuY3Rpb24gY2Fubm90UmV0dXJuT3duKCkge1xuICByZXR1cm4gbmV3IFR5cGVFcnJvcignQSBwcm9taXNlcyBjYWxsYmFjayBjYW5ub3QgcmV0dXJuIHRoYXQgc2FtZSBwcm9taXNlLicpO1xufVxuXG5mdW5jdGlvbiBnZXRUaGVuKHByb21pc2UpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gcHJvbWlzZS50aGVuO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIFRSWV9DQVRDSF9FUlJPUi5lcnJvciA9IGVycm9yO1xuICAgIHJldHVybiBUUllfQ0FUQ0hfRVJST1I7XG4gIH1cbn1cblxuZnVuY3Rpb24gdHJ5VGhlbih0aGVuJCQxLCB2YWx1ZSwgZnVsZmlsbG1lbnRIYW5kbGVyLCByZWplY3Rpb25IYW5kbGVyKSB7XG4gIHRyeSB7XG4gICAgdGhlbiQkMS5jYWxsKHZhbHVlLCBmdWxmaWxsbWVudEhhbmRsZXIsIHJlamVjdGlvbkhhbmRsZXIpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGU7XG4gIH1cbn1cblxuZnVuY3Rpb24gaGFuZGxlRm9yZWlnblRoZW5hYmxlKHByb21pc2UsIHRoZW5hYmxlLCB0aGVuJCQxKSB7XG4gIGFzYXAoZnVuY3Rpb24gKHByb21pc2UpIHtcbiAgICB2YXIgc2VhbGVkID0gZmFsc2U7XG4gICAgdmFyIGVycm9yID0gdHJ5VGhlbih0aGVuJCQxLCB0aGVuYWJsZSwgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICBpZiAoc2VhbGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHNlYWxlZCA9IHRydWU7XG4gICAgICBpZiAodGhlbmFibGUgIT09IHZhbHVlKSB7XG4gICAgICAgIHJlc29sdmUocHJvbWlzZSwgdmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZnVsZmlsbChwcm9taXNlLCB2YWx1ZSk7XG4gICAgICB9XG4gICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgaWYgKHNlYWxlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBzZWFsZWQgPSB0cnVlO1xuXG4gICAgICByZWplY3QocHJvbWlzZSwgcmVhc29uKTtcbiAgICB9LCAnU2V0dGxlOiAnICsgKHByb21pc2UuX2xhYmVsIHx8ICcgdW5rbm93biBwcm9taXNlJykpO1xuXG4gICAgaWYgKCFzZWFsZWQgJiYgZXJyb3IpIHtcbiAgICAgIHNlYWxlZCA9IHRydWU7XG4gICAgICByZWplY3QocHJvbWlzZSwgZXJyb3IpO1xuICAgIH1cbiAgfSwgcHJvbWlzZSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZU93blRoZW5hYmxlKHByb21pc2UsIHRoZW5hYmxlKSB7XG4gIGlmICh0aGVuYWJsZS5fc3RhdGUgPT09IEZVTEZJTExFRCkge1xuICAgIGZ1bGZpbGwocHJvbWlzZSwgdGhlbmFibGUuX3Jlc3VsdCk7XG4gIH0gZWxzZSBpZiAodGhlbmFibGUuX3N0YXRlID09PSBSRUpFQ1RFRCkge1xuICAgIHJlamVjdChwcm9taXNlLCB0aGVuYWJsZS5fcmVzdWx0KTtcbiAgfSBlbHNlIHtcbiAgICBzdWJzY3JpYmUodGhlbmFibGUsIHVuZGVmaW5lZCwgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICByZXR1cm4gcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSk7XG4gICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgcmV0dXJuIHJlamVjdChwcm9taXNlLCByZWFzb24pO1xuICAgIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhhbmRsZU1heWJlVGhlbmFibGUocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSwgdGhlbiQkMSkge1xuICBpZiAobWF5YmVUaGVuYWJsZS5jb25zdHJ1Y3RvciA9PT0gcHJvbWlzZS5jb25zdHJ1Y3RvciAmJiB0aGVuJCQxID09PSB0aGVuICYmIG1heWJlVGhlbmFibGUuY29uc3RydWN0b3IucmVzb2x2ZSA9PT0gcmVzb2x2ZSQxKSB7XG4gICAgaGFuZGxlT3duVGhlbmFibGUocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSk7XG4gIH0gZWxzZSB7XG4gICAgaWYgKHRoZW4kJDEgPT09IFRSWV9DQVRDSF9FUlJPUikge1xuICAgICAgcmVqZWN0KHByb21pc2UsIFRSWV9DQVRDSF9FUlJPUi5lcnJvcik7XG4gICAgICBUUllfQ0FUQ0hfRVJST1IuZXJyb3IgPSBudWxsO1xuICAgIH0gZWxzZSBpZiAodGhlbiQkMSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBmdWxmaWxsKHByb21pc2UsIG1heWJlVGhlbmFibGUpO1xuICAgIH0gZWxzZSBpZiAoaXNGdW5jdGlvbih0aGVuJCQxKSkge1xuICAgICAgaGFuZGxlRm9yZWlnblRoZW5hYmxlKHByb21pc2UsIG1heWJlVGhlbmFibGUsIHRoZW4kJDEpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmdWxmaWxsKHByb21pc2UsIG1heWJlVGhlbmFibGUpO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiByZXNvbHZlKHByb21pc2UsIHZhbHVlKSB7XG4gIGlmIChwcm9taXNlID09PSB2YWx1ZSkge1xuICAgIHJlamVjdChwcm9taXNlLCBzZWxmRnVsZmlsbG1lbnQoKSk7XG4gIH0gZWxzZSBpZiAob2JqZWN0T3JGdW5jdGlvbih2YWx1ZSkpIHtcbiAgICBoYW5kbGVNYXliZVRoZW5hYmxlKHByb21pc2UsIHZhbHVlLCBnZXRUaGVuKHZhbHVlKSk7XG4gIH0gZWxzZSB7XG4gICAgZnVsZmlsbChwcm9taXNlLCB2YWx1ZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcHVibGlzaFJlamVjdGlvbihwcm9taXNlKSB7XG4gIGlmIChwcm9taXNlLl9vbmVycm9yKSB7XG4gICAgcHJvbWlzZS5fb25lcnJvcihwcm9taXNlLl9yZXN1bHQpO1xuICB9XG5cbiAgcHVibGlzaChwcm9taXNlKTtcbn1cblxuZnVuY3Rpb24gZnVsZmlsbChwcm9taXNlLCB2YWx1ZSkge1xuICBpZiAocHJvbWlzZS5fc3RhdGUgIT09IFBFTkRJTkcpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBwcm9taXNlLl9yZXN1bHQgPSB2YWx1ZTtcbiAgcHJvbWlzZS5fc3RhdGUgPSBGVUxGSUxMRUQ7XG5cbiAgaWYgKHByb21pc2UuX3N1YnNjcmliZXJzLmxlbmd0aCAhPT0gMCkge1xuICAgIGFzYXAocHVibGlzaCwgcHJvbWlzZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcmVqZWN0KHByb21pc2UsIHJlYXNvbikge1xuICBpZiAocHJvbWlzZS5fc3RhdGUgIT09IFBFTkRJTkcpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgcHJvbWlzZS5fc3RhdGUgPSBSRUpFQ1RFRDtcbiAgcHJvbWlzZS5fcmVzdWx0ID0gcmVhc29uO1xuXG4gIGFzYXAocHVibGlzaFJlamVjdGlvbiwgcHJvbWlzZSk7XG59XG5cbmZ1bmN0aW9uIHN1YnNjcmliZShwYXJlbnQsIGNoaWxkLCBvbkZ1bGZpbGxtZW50LCBvblJlamVjdGlvbikge1xuICB2YXIgX3N1YnNjcmliZXJzID0gcGFyZW50Ll9zdWJzY3JpYmVycztcbiAgdmFyIGxlbmd0aCA9IF9zdWJzY3JpYmVycy5sZW5ndGg7XG5cblxuICBwYXJlbnQuX29uZXJyb3IgPSBudWxsO1xuXG4gIF9zdWJzY3JpYmVyc1tsZW5ndGhdID0gY2hpbGQ7XG4gIF9zdWJzY3JpYmVyc1tsZW5ndGggKyBGVUxGSUxMRURdID0gb25GdWxmaWxsbWVudDtcbiAgX3N1YnNjcmliZXJzW2xlbmd0aCArIFJFSkVDVEVEXSA9IG9uUmVqZWN0aW9uO1xuXG4gIGlmIChsZW5ndGggPT09IDAgJiYgcGFyZW50Ll9zdGF0ZSkge1xuICAgIGFzYXAocHVibGlzaCwgcGFyZW50KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBwdWJsaXNoKHByb21pc2UpIHtcbiAgdmFyIHN1YnNjcmliZXJzID0gcHJvbWlzZS5fc3Vic2NyaWJlcnM7XG4gIHZhciBzZXR0bGVkID0gcHJvbWlzZS5fc3RhdGU7XG5cbiAgaWYgKHN1YnNjcmliZXJzLmxlbmd0aCA9PT0gMCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBjaGlsZCA9IHZvaWQgMCxcbiAgICAgIGNhbGxiYWNrID0gdm9pZCAwLFxuICAgICAgZGV0YWlsID0gcHJvbWlzZS5fcmVzdWx0O1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgc3Vic2NyaWJlcnMubGVuZ3RoOyBpICs9IDMpIHtcbiAgICBjaGlsZCA9IHN1YnNjcmliZXJzW2ldO1xuICAgIGNhbGxiYWNrID0gc3Vic2NyaWJlcnNbaSArIHNldHRsZWRdO1xuXG4gICAgaWYgKGNoaWxkKSB7XG4gICAgICBpbnZva2VDYWxsYmFjayhzZXR0bGVkLCBjaGlsZCwgY2FsbGJhY2ssIGRldGFpbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNhbGxiYWNrKGRldGFpbCk7XG4gICAgfVxuICB9XG5cbiAgcHJvbWlzZS5fc3Vic2NyaWJlcnMubGVuZ3RoID0gMDtcbn1cblxuZnVuY3Rpb24gdHJ5Q2F0Y2goY2FsbGJhY2ssIGRldGFpbCkge1xuICB0cnkge1xuICAgIHJldHVybiBjYWxsYmFjayhkZXRhaWwpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgVFJZX0NBVENIX0VSUk9SLmVycm9yID0gZTtcbiAgICByZXR1cm4gVFJZX0NBVENIX0VSUk9SO1xuICB9XG59XG5cbmZ1bmN0aW9uIGludm9rZUNhbGxiYWNrKHNldHRsZWQsIHByb21pc2UsIGNhbGxiYWNrLCBkZXRhaWwpIHtcbiAgdmFyIGhhc0NhbGxiYWNrID0gaXNGdW5jdGlvbihjYWxsYmFjayksXG4gICAgICB2YWx1ZSA9IHZvaWQgMCxcbiAgICAgIGVycm9yID0gdm9pZCAwLFxuICAgICAgc3VjY2VlZGVkID0gdm9pZCAwLFxuICAgICAgZmFpbGVkID0gdm9pZCAwO1xuXG4gIGlmIChoYXNDYWxsYmFjaykge1xuICAgIHZhbHVlID0gdHJ5Q2F0Y2goY2FsbGJhY2ssIGRldGFpbCk7XG5cbiAgICBpZiAodmFsdWUgPT09IFRSWV9DQVRDSF9FUlJPUikge1xuICAgICAgZmFpbGVkID0gdHJ1ZTtcbiAgICAgIGVycm9yID0gdmFsdWUuZXJyb3I7XG4gICAgICB2YWx1ZS5lcnJvciA9IG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN1Y2NlZWRlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKHByb21pc2UgPT09IHZhbHVlKSB7XG4gICAgICByZWplY3QocHJvbWlzZSwgY2Fubm90UmV0dXJuT3duKCkpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICB2YWx1ZSA9IGRldGFpbDtcbiAgICBzdWNjZWVkZWQgPSB0cnVlO1xuICB9XG5cbiAgaWYgKHByb21pc2UuX3N0YXRlICE9PSBQRU5ESU5HKSB7XG4gICAgLy8gbm9vcFxuICB9IGVsc2UgaWYgKGhhc0NhbGxiYWNrICYmIHN1Y2NlZWRlZCkge1xuICAgIHJlc29sdmUocHJvbWlzZSwgdmFsdWUpO1xuICB9IGVsc2UgaWYgKGZhaWxlZCkge1xuICAgIHJlamVjdChwcm9taXNlLCBlcnJvcik7XG4gIH0gZWxzZSBpZiAoc2V0dGxlZCA9PT0gRlVMRklMTEVEKSB7XG4gICAgZnVsZmlsbChwcm9taXNlLCB2YWx1ZSk7XG4gIH0gZWxzZSBpZiAoc2V0dGxlZCA9PT0gUkVKRUNURUQpIHtcbiAgICByZWplY3QocHJvbWlzZSwgdmFsdWUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGluaXRpYWxpemVQcm9taXNlKHByb21pc2UsIHJlc29sdmVyKSB7XG4gIHRyeSB7XG4gICAgcmVzb2x2ZXIoZnVuY3Rpb24gcmVzb2x2ZVByb21pc2UodmFsdWUpIHtcbiAgICAgIHJlc29sdmUocHJvbWlzZSwgdmFsdWUpO1xuICAgIH0sIGZ1bmN0aW9uIHJlamVjdFByb21pc2UocmVhc29uKSB7XG4gICAgICByZWplY3QocHJvbWlzZSwgcmVhc29uKTtcbiAgICB9KTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJlamVjdChwcm9taXNlLCBlKTtcbiAgfVxufVxuXG52YXIgaWQgPSAwO1xuZnVuY3Rpb24gbmV4dElkKCkge1xuICByZXR1cm4gaWQrKztcbn1cblxuZnVuY3Rpb24gbWFrZVByb21pc2UocHJvbWlzZSkge1xuICBwcm9taXNlW1BST01JU0VfSURdID0gaWQrKztcbiAgcHJvbWlzZS5fc3RhdGUgPSB1bmRlZmluZWQ7XG4gIHByb21pc2UuX3Jlc3VsdCA9IHVuZGVmaW5lZDtcbiAgcHJvbWlzZS5fc3Vic2NyaWJlcnMgPSBbXTtcbn1cblxuZnVuY3Rpb24gdmFsaWRhdGlvbkVycm9yKCkge1xuICByZXR1cm4gbmV3IEVycm9yKCdBcnJheSBNZXRob2RzIG11c3QgYmUgcHJvdmlkZWQgYW4gQXJyYXknKTtcbn1cblxudmFyIEVudW1lcmF0b3IgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEVudW1lcmF0b3IoQ29uc3RydWN0b3IsIGlucHV0KSB7XG4gICAgdGhpcy5faW5zdGFuY2VDb25zdHJ1Y3RvciA9IENvbnN0cnVjdG9yO1xuICAgIHRoaXMucHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3Rvcihub29wKTtcblxuICAgIGlmICghdGhpcy5wcm9taXNlW1BST01JU0VfSURdKSB7XG4gICAgICBtYWtlUHJvbWlzZSh0aGlzLnByb21pc2UpO1xuICAgIH1cblxuICAgIGlmIChpc0FycmF5KGlucHV0KSkge1xuICAgICAgdGhpcy5sZW5ndGggPSBpbnB1dC5sZW5ndGg7XG4gICAgICB0aGlzLl9yZW1haW5pbmcgPSBpbnB1dC5sZW5ndGg7XG5cbiAgICAgIHRoaXMuX3Jlc3VsdCA9IG5ldyBBcnJheSh0aGlzLmxlbmd0aCk7XG5cbiAgICAgIGlmICh0aGlzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBmdWxmaWxsKHRoaXMucHJvbWlzZSwgdGhpcy5fcmVzdWx0KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubGVuZ3RoID0gdGhpcy5sZW5ndGggfHwgMDtcbiAgICAgICAgdGhpcy5fZW51bWVyYXRlKGlucHV0KTtcbiAgICAgICAgaWYgKHRoaXMuX3JlbWFpbmluZyA9PT0gMCkge1xuICAgICAgICAgIGZ1bGZpbGwodGhpcy5wcm9taXNlLCB0aGlzLl9yZXN1bHQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlamVjdCh0aGlzLnByb21pc2UsIHZhbGlkYXRpb25FcnJvcigpKTtcbiAgICB9XG4gIH1cblxuICBFbnVtZXJhdG9yLnByb3RvdHlwZS5fZW51bWVyYXRlID0gZnVuY3Rpb24gX2VudW1lcmF0ZShpbnB1dCkge1xuICAgIGZvciAodmFyIGkgPSAwOyB0aGlzLl9zdGF0ZSA9PT0gUEVORElORyAmJiBpIDwgaW5wdXQubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMuX2VhY2hFbnRyeShpbnB1dFtpXSwgaSk7XG4gICAgfVxuICB9O1xuXG4gIEVudW1lcmF0b3IucHJvdG90eXBlLl9lYWNoRW50cnkgPSBmdW5jdGlvbiBfZWFjaEVudHJ5KGVudHJ5LCBpKSB7XG4gICAgdmFyIGMgPSB0aGlzLl9pbnN0YW5jZUNvbnN0cnVjdG9yO1xuICAgIHZhciByZXNvbHZlJCQxID0gYy5yZXNvbHZlO1xuXG5cbiAgICBpZiAocmVzb2x2ZSQkMSA9PT0gcmVzb2x2ZSQxKSB7XG4gICAgICB2YXIgX3RoZW4gPSBnZXRUaGVuKGVudHJ5KTtcblxuICAgICAgaWYgKF90aGVuID09PSB0aGVuICYmIGVudHJ5Ll9zdGF0ZSAhPT0gUEVORElORykge1xuICAgICAgICB0aGlzLl9zZXR0bGVkQXQoZW50cnkuX3N0YXRlLCBpLCBlbnRyeS5fcmVzdWx0KTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIF90aGVuICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRoaXMuX3JlbWFpbmluZy0tO1xuICAgICAgICB0aGlzLl9yZXN1bHRbaV0gPSBlbnRyeTtcbiAgICAgIH0gZWxzZSBpZiAoYyA9PT0gUHJvbWlzZSQxKSB7XG4gICAgICAgIHZhciBwcm9taXNlID0gbmV3IGMobm9vcCk7XG4gICAgICAgIGhhbmRsZU1heWJlVGhlbmFibGUocHJvbWlzZSwgZW50cnksIF90aGVuKTtcbiAgICAgICAgdGhpcy5fd2lsbFNldHRsZUF0KHByb21pc2UsIGkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fd2lsbFNldHRsZUF0KG5ldyBjKGZ1bmN0aW9uIChyZXNvbHZlJCQxKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc29sdmUkJDEoZW50cnkpO1xuICAgICAgICB9KSwgaSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3dpbGxTZXR0bGVBdChyZXNvbHZlJCQxKGVudHJ5KSwgaSk7XG4gICAgfVxuICB9O1xuXG4gIEVudW1lcmF0b3IucHJvdG90eXBlLl9zZXR0bGVkQXQgPSBmdW5jdGlvbiBfc2V0dGxlZEF0KHN0YXRlLCBpLCB2YWx1ZSkge1xuICAgIHZhciBwcm9taXNlID0gdGhpcy5wcm9taXNlO1xuXG5cbiAgICBpZiAocHJvbWlzZS5fc3RhdGUgPT09IFBFTkRJTkcpIHtcbiAgICAgIHRoaXMuX3JlbWFpbmluZy0tO1xuXG4gICAgICBpZiAoc3RhdGUgPT09IFJFSkVDVEVEKSB7XG4gICAgICAgIHJlamVjdChwcm9taXNlLCB2YWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9yZXN1bHRbaV0gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5fcmVtYWluaW5nID09PSAwKSB7XG4gICAgICBmdWxmaWxsKHByb21pc2UsIHRoaXMuX3Jlc3VsdCk7XG4gICAgfVxuICB9O1xuXG4gIEVudW1lcmF0b3IucHJvdG90eXBlLl93aWxsU2V0dGxlQXQgPSBmdW5jdGlvbiBfd2lsbFNldHRsZUF0KHByb21pc2UsIGkpIHtcbiAgICB2YXIgZW51bWVyYXRvciA9IHRoaXM7XG5cbiAgICBzdWJzY3JpYmUocHJvbWlzZSwgdW5kZWZpbmVkLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHJldHVybiBlbnVtZXJhdG9yLl9zZXR0bGVkQXQoRlVMRklMTEVELCBpLCB2YWx1ZSk7XG4gICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgcmV0dXJuIGVudW1lcmF0b3IuX3NldHRsZWRBdChSRUpFQ1RFRCwgaSwgcmVhc29uKTtcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4gRW51bWVyYXRvcjtcbn0oKTtcblxuLyoqXG4gIGBQcm9taXNlLmFsbGAgYWNjZXB0cyBhbiBhcnJheSBvZiBwcm9taXNlcywgYW5kIHJldHVybnMgYSBuZXcgcHJvbWlzZSB3aGljaFxuICBpcyBmdWxmaWxsZWQgd2l0aCBhbiBhcnJheSBvZiBmdWxmaWxsbWVudCB2YWx1ZXMgZm9yIHRoZSBwYXNzZWQgcHJvbWlzZXMsIG9yXG4gIHJlamVjdGVkIHdpdGggdGhlIHJlYXNvbiBvZiB0aGUgZmlyc3QgcGFzc2VkIHByb21pc2UgdG8gYmUgcmVqZWN0ZWQuIEl0IGNhc3RzIGFsbFxuICBlbGVtZW50cyBvZiB0aGUgcGFzc2VkIGl0ZXJhYmxlIHRvIHByb21pc2VzIGFzIGl0IHJ1bnMgdGhpcyBhbGdvcml0aG0uXG5cbiAgRXhhbXBsZTpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlMSA9IHJlc29sdmUoMSk7XG4gIGxldCBwcm9taXNlMiA9IHJlc29sdmUoMik7XG4gIGxldCBwcm9taXNlMyA9IHJlc29sdmUoMyk7XG4gIGxldCBwcm9taXNlcyA9IFsgcHJvbWlzZTEsIHByb21pc2UyLCBwcm9taXNlMyBdO1xuXG4gIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uKGFycmF5KXtcbiAgICAvLyBUaGUgYXJyYXkgaGVyZSB3b3VsZCBiZSBbIDEsIDIsIDMgXTtcbiAgfSk7XG4gIGBgYFxuXG4gIElmIGFueSBvZiB0aGUgYHByb21pc2VzYCBnaXZlbiB0byBgYWxsYCBhcmUgcmVqZWN0ZWQsIHRoZSBmaXJzdCBwcm9taXNlXG4gIHRoYXQgaXMgcmVqZWN0ZWQgd2lsbCBiZSBnaXZlbiBhcyBhbiBhcmd1bWVudCB0byB0aGUgcmV0dXJuZWQgcHJvbWlzZXMnc1xuICByZWplY3Rpb24gaGFuZGxlci4gRm9yIGV4YW1wbGU6XG5cbiAgRXhhbXBsZTpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlMSA9IHJlc29sdmUoMSk7XG4gIGxldCBwcm9taXNlMiA9IHJlamVjdChuZXcgRXJyb3IoXCIyXCIpKTtcbiAgbGV0IHByb21pc2UzID0gcmVqZWN0KG5ldyBFcnJvcihcIjNcIikpO1xuICBsZXQgcHJvbWlzZXMgPSBbIHByb21pc2UxLCBwcm9taXNlMiwgcHJvbWlzZTMgXTtcblxuICBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbihmdW5jdGlvbihhcnJheSl7XG4gICAgLy8gQ29kZSBoZXJlIG5ldmVyIHJ1bnMgYmVjYXVzZSB0aGVyZSBhcmUgcmVqZWN0ZWQgcHJvbWlzZXMhXG4gIH0sIGZ1bmN0aW9uKGVycm9yKSB7XG4gICAgLy8gZXJyb3IubWVzc2FnZSA9PT0gXCIyXCJcbiAgfSk7XG4gIGBgYFxuXG4gIEBtZXRob2QgYWxsXG4gIEBzdGF0aWNcbiAgQHBhcmFtIHtBcnJheX0gZW50cmllcyBhcnJheSBvZiBwcm9taXNlc1xuICBAcGFyYW0ge1N0cmluZ30gbGFiZWwgb3B0aW9uYWwgc3RyaW5nIGZvciBsYWJlbGluZyB0aGUgcHJvbWlzZS5cbiAgVXNlZnVsIGZvciB0b29saW5nLlxuICBAcmV0dXJuIHtQcm9taXNlfSBwcm9taXNlIHRoYXQgaXMgZnVsZmlsbGVkIHdoZW4gYWxsIGBwcm9taXNlc2AgaGF2ZSBiZWVuXG4gIGZ1bGZpbGxlZCwgb3IgcmVqZWN0ZWQgaWYgYW55IG9mIHRoZW0gYmVjb21lIHJlamVjdGVkLlxuICBAc3RhdGljXG4qL1xuZnVuY3Rpb24gYWxsKGVudHJpZXMpIHtcbiAgcmV0dXJuIG5ldyBFbnVtZXJhdG9yKHRoaXMsIGVudHJpZXMpLnByb21pc2U7XG59XG5cbi8qKlxuICBgUHJvbWlzZS5yYWNlYCByZXR1cm5zIGEgbmV3IHByb21pc2Ugd2hpY2ggaXMgc2V0dGxlZCBpbiB0aGUgc2FtZSB3YXkgYXMgdGhlXG4gIGZpcnN0IHBhc3NlZCBwcm9taXNlIHRvIHNldHRsZS5cblxuICBFeGFtcGxlOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UxID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICByZXNvbHZlKCdwcm9taXNlIDEnKTtcbiAgICB9LCAyMDApO1xuICB9KTtcblxuICBsZXQgcHJvbWlzZTIgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIHJlc29sdmUoJ3Byb21pc2UgMicpO1xuICAgIH0sIDEwMCk7XG4gIH0pO1xuXG4gIFByb21pc2UucmFjZShbcHJvbWlzZTEsIHByb21pc2UyXSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuICAgIC8vIHJlc3VsdCA9PT0gJ3Byb21pc2UgMicgYmVjYXVzZSBpdCB3YXMgcmVzb2x2ZWQgYmVmb3JlIHByb21pc2UxXG4gICAgLy8gd2FzIHJlc29sdmVkLlxuICB9KTtcbiAgYGBgXG5cbiAgYFByb21pc2UucmFjZWAgaXMgZGV0ZXJtaW5pc3RpYyBpbiB0aGF0IG9ubHkgdGhlIHN0YXRlIG9mIHRoZSBmaXJzdFxuICBzZXR0bGVkIHByb21pc2UgbWF0dGVycy4gRm9yIGV4YW1wbGUsIGV2ZW4gaWYgb3RoZXIgcHJvbWlzZXMgZ2l2ZW4gdG8gdGhlXG4gIGBwcm9taXNlc2AgYXJyYXkgYXJndW1lbnQgYXJlIHJlc29sdmVkLCBidXQgdGhlIGZpcnN0IHNldHRsZWQgcHJvbWlzZSBoYXNcbiAgYmVjb21lIHJlamVjdGVkIGJlZm9yZSB0aGUgb3RoZXIgcHJvbWlzZXMgYmVjYW1lIGZ1bGZpbGxlZCwgdGhlIHJldHVybmVkXG4gIHByb21pc2Ugd2lsbCBiZWNvbWUgcmVqZWN0ZWQ6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZTEgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIHJlc29sdmUoJ3Byb21pc2UgMScpO1xuICAgIH0sIDIwMCk7XG4gIH0pO1xuXG4gIGxldCBwcm9taXNlMiA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgcmVqZWN0KG5ldyBFcnJvcigncHJvbWlzZSAyJykpO1xuICAgIH0sIDEwMCk7XG4gIH0pO1xuXG4gIFByb21pc2UucmFjZShbcHJvbWlzZTEsIHByb21pc2UyXSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuICAgIC8vIENvZGUgaGVyZSBuZXZlciBydW5zXG4gIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgLy8gcmVhc29uLm1lc3NhZ2UgPT09ICdwcm9taXNlIDInIGJlY2F1c2UgcHJvbWlzZSAyIGJlY2FtZSByZWplY3RlZCBiZWZvcmVcbiAgICAvLyBwcm9taXNlIDEgYmVjYW1lIGZ1bGZpbGxlZFxuICB9KTtcbiAgYGBgXG5cbiAgQW4gZXhhbXBsZSByZWFsLXdvcmxkIHVzZSBjYXNlIGlzIGltcGxlbWVudGluZyB0aW1lb3V0czpcblxuICBgYGBqYXZhc2NyaXB0XG4gIFByb21pc2UucmFjZShbYWpheCgnZm9vLmpzb24nKSwgdGltZW91dCg1MDAwKV0pXG4gIGBgYFxuXG4gIEBtZXRob2QgcmFjZVxuICBAc3RhdGljXG4gIEBwYXJhbSB7QXJyYXl9IHByb21pc2VzIGFycmF5IG9mIHByb21pc2VzIHRvIG9ic2VydmVcbiAgVXNlZnVsIGZvciB0b29saW5nLlxuICBAcmV0dXJuIHtQcm9taXNlfSBhIHByb21pc2Ugd2hpY2ggc2V0dGxlcyBpbiB0aGUgc2FtZSB3YXkgYXMgdGhlIGZpcnN0IHBhc3NlZFxuICBwcm9taXNlIHRvIHNldHRsZS5cbiovXG5mdW5jdGlvbiByYWNlKGVudHJpZXMpIHtcbiAgLypqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cbiAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcblxuICBpZiAoIWlzQXJyYXkoZW50cmllcykpIHtcbiAgICByZXR1cm4gbmV3IENvbnN0cnVjdG9yKGZ1bmN0aW9uIChfLCByZWplY3QpIHtcbiAgICAgIHJldHVybiByZWplY3QobmV3IFR5cGVFcnJvcignWW91IG11c3QgcGFzcyBhbiBhcnJheSB0byByYWNlLicpKTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gbmV3IENvbnN0cnVjdG9yKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHZhciBsZW5ndGggPSBlbnRyaWVzLmxlbmd0aDtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgQ29uc3RydWN0b3IucmVzb2x2ZShlbnRyaWVzW2ldKS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cblxuLyoqXG4gIGBQcm9taXNlLnJlamVjdGAgcmV0dXJucyBhIHByb21pc2UgcmVqZWN0ZWQgd2l0aCB0aGUgcGFzc2VkIGByZWFzb25gLlxuICBJdCBpcyBzaG9ydGhhbmQgZm9yIHRoZSBmb2xsb3dpbmc6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG4gICAgcmVqZWN0KG5ldyBFcnJvcignV0hPT1BTJykpO1xuICB9KTtcblxuICBwcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpe1xuICAgIC8vIENvZGUgaGVyZSBkb2Vzbid0IHJ1biBiZWNhdXNlIHRoZSBwcm9taXNlIGlzIHJlamVjdGVkIVxuICB9LCBmdW5jdGlvbihyZWFzb24pe1xuICAgIC8vIHJlYXNvbi5tZXNzYWdlID09PSAnV0hPT1BTJ1xuICB9KTtcbiAgYGBgXG5cbiAgSW5zdGVhZCBvZiB3cml0aW5nIHRoZSBhYm92ZSwgeW91ciBjb2RlIG5vdyBzaW1wbHkgYmVjb21lcyB0aGUgZm9sbG93aW5nOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UgPSBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ1dIT09QUycpKTtcblxuICBwcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpe1xuICAgIC8vIENvZGUgaGVyZSBkb2Vzbid0IHJ1biBiZWNhdXNlIHRoZSBwcm9taXNlIGlzIHJlamVjdGVkIVxuICB9LCBmdW5jdGlvbihyZWFzb24pe1xuICAgIC8vIHJlYXNvbi5tZXNzYWdlID09PSAnV0hPT1BTJ1xuICB9KTtcbiAgYGBgXG5cbiAgQG1ldGhvZCByZWplY3RcbiAgQHN0YXRpY1xuICBAcGFyYW0ge0FueX0gcmVhc29uIHZhbHVlIHRoYXQgdGhlIHJldHVybmVkIHByb21pc2Ugd2lsbCBiZSByZWplY3RlZCB3aXRoLlxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEByZXR1cm4ge1Byb21pc2V9IGEgcHJvbWlzZSByZWplY3RlZCB3aXRoIHRoZSBnaXZlbiBgcmVhc29uYC5cbiovXG5mdW5jdGlvbiByZWplY3QkMShyZWFzb24pIHtcbiAgLypqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cbiAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcbiAgdmFyIHByb21pc2UgPSBuZXcgQ29uc3RydWN0b3Iobm9vcCk7XG4gIHJlamVjdChwcm9taXNlLCByZWFzb24pO1xuICByZXR1cm4gcHJvbWlzZTtcbn1cblxuZnVuY3Rpb24gbmVlZHNSZXNvbHZlcigpIHtcbiAgdGhyb3cgbmV3IFR5cGVFcnJvcignWW91IG11c3QgcGFzcyBhIHJlc29sdmVyIGZ1bmN0aW9uIGFzIHRoZSBmaXJzdCBhcmd1bWVudCB0byB0aGUgcHJvbWlzZSBjb25zdHJ1Y3RvcicpO1xufVxuXG5mdW5jdGlvbiBuZWVkc05ldygpIHtcbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkZhaWxlZCB0byBjb25zdHJ1Y3QgJ1Byb21pc2UnOiBQbGVhc2UgdXNlIHRoZSAnbmV3JyBvcGVyYXRvciwgdGhpcyBvYmplY3QgY29uc3RydWN0b3IgY2Fubm90IGJlIGNhbGxlZCBhcyBhIGZ1bmN0aW9uLlwiKTtcbn1cblxuLyoqXG4gIFByb21pc2Ugb2JqZWN0cyByZXByZXNlbnQgdGhlIGV2ZW50dWFsIHJlc3VsdCBvZiBhbiBhc3luY2hyb25vdXMgb3BlcmF0aW9uLiBUaGVcbiAgcHJpbWFyeSB3YXkgb2YgaW50ZXJhY3Rpbmcgd2l0aCBhIHByb21pc2UgaXMgdGhyb3VnaCBpdHMgYHRoZW5gIG1ldGhvZCwgd2hpY2hcbiAgcmVnaXN0ZXJzIGNhbGxiYWNrcyB0byByZWNlaXZlIGVpdGhlciBhIHByb21pc2UncyBldmVudHVhbCB2YWx1ZSBvciB0aGUgcmVhc29uXG4gIHdoeSB0aGUgcHJvbWlzZSBjYW5ub3QgYmUgZnVsZmlsbGVkLlxuXG4gIFRlcm1pbm9sb2d5XG4gIC0tLS0tLS0tLS0tXG5cbiAgLSBgcHJvbWlzZWAgaXMgYW4gb2JqZWN0IG9yIGZ1bmN0aW9uIHdpdGggYSBgdGhlbmAgbWV0aG9kIHdob3NlIGJlaGF2aW9yIGNvbmZvcm1zIHRvIHRoaXMgc3BlY2lmaWNhdGlvbi5cbiAgLSBgdGhlbmFibGVgIGlzIGFuIG9iamVjdCBvciBmdW5jdGlvbiB0aGF0IGRlZmluZXMgYSBgdGhlbmAgbWV0aG9kLlxuICAtIGB2YWx1ZWAgaXMgYW55IGxlZ2FsIEphdmFTY3JpcHQgdmFsdWUgKGluY2x1ZGluZyB1bmRlZmluZWQsIGEgdGhlbmFibGUsIG9yIGEgcHJvbWlzZSkuXG4gIC0gYGV4Y2VwdGlvbmAgaXMgYSB2YWx1ZSB0aGF0IGlzIHRocm93biB1c2luZyB0aGUgdGhyb3cgc3RhdGVtZW50LlxuICAtIGByZWFzb25gIGlzIGEgdmFsdWUgdGhhdCBpbmRpY2F0ZXMgd2h5IGEgcHJvbWlzZSB3YXMgcmVqZWN0ZWQuXG4gIC0gYHNldHRsZWRgIHRoZSBmaW5hbCByZXN0aW5nIHN0YXRlIG9mIGEgcHJvbWlzZSwgZnVsZmlsbGVkIG9yIHJlamVjdGVkLlxuXG4gIEEgcHJvbWlzZSBjYW4gYmUgaW4gb25lIG9mIHRocmVlIHN0YXRlczogcGVuZGluZywgZnVsZmlsbGVkLCBvciByZWplY3RlZC5cblxuICBQcm9taXNlcyB0aGF0IGFyZSBmdWxmaWxsZWQgaGF2ZSBhIGZ1bGZpbGxtZW50IHZhbHVlIGFuZCBhcmUgaW4gdGhlIGZ1bGZpbGxlZFxuICBzdGF0ZS4gIFByb21pc2VzIHRoYXQgYXJlIHJlamVjdGVkIGhhdmUgYSByZWplY3Rpb24gcmVhc29uIGFuZCBhcmUgaW4gdGhlXG4gIHJlamVjdGVkIHN0YXRlLiAgQSBmdWxmaWxsbWVudCB2YWx1ZSBpcyBuZXZlciBhIHRoZW5hYmxlLlxuXG4gIFByb21pc2VzIGNhbiBhbHNvIGJlIHNhaWQgdG8gKnJlc29sdmUqIGEgdmFsdWUuICBJZiB0aGlzIHZhbHVlIGlzIGFsc28gYVxuICBwcm9taXNlLCB0aGVuIHRoZSBvcmlnaW5hbCBwcm9taXNlJ3Mgc2V0dGxlZCBzdGF0ZSB3aWxsIG1hdGNoIHRoZSB2YWx1ZSdzXG4gIHNldHRsZWQgc3RhdGUuICBTbyBhIHByb21pc2UgdGhhdCAqcmVzb2x2ZXMqIGEgcHJvbWlzZSB0aGF0IHJlamVjdHMgd2lsbFxuICBpdHNlbGYgcmVqZWN0LCBhbmQgYSBwcm9taXNlIHRoYXQgKnJlc29sdmVzKiBhIHByb21pc2UgdGhhdCBmdWxmaWxscyB3aWxsXG4gIGl0c2VsZiBmdWxmaWxsLlxuXG5cbiAgQmFzaWMgVXNhZ2U6XG4gIC0tLS0tLS0tLS0tLVxuXG4gIGBgYGpzXG4gIGxldCBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgLy8gb24gc3VjY2Vzc1xuICAgIHJlc29sdmUodmFsdWUpO1xuXG4gICAgLy8gb24gZmFpbHVyZVxuICAgIHJlamVjdChyZWFzb24pO1xuICB9KTtcblxuICBwcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAvLyBvbiBmdWxmaWxsbWVudFxuICB9LCBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAvLyBvbiByZWplY3Rpb25cbiAgfSk7XG4gIGBgYFxuXG4gIEFkdmFuY2VkIFVzYWdlOlxuICAtLS0tLS0tLS0tLS0tLS1cblxuICBQcm9taXNlcyBzaGluZSB3aGVuIGFic3RyYWN0aW5nIGF3YXkgYXN5bmNocm9ub3VzIGludGVyYWN0aW9ucyBzdWNoIGFzXG4gIGBYTUxIdHRwUmVxdWVzdGBzLlxuXG4gIGBgYGpzXG4gIGZ1bmN0aW9uIGdldEpTT04odXJsKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG4gICAgICBsZXQgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgICAgIHhoci5vcGVuKCdHRVQnLCB1cmwpO1xuICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGhhbmRsZXI7XG4gICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2pzb24nO1xuICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0FjY2VwdCcsICdhcHBsaWNhdGlvbi9qc29uJyk7XG4gICAgICB4aHIuc2VuZCgpO1xuXG4gICAgICBmdW5jdGlvbiBoYW5kbGVyKCkge1xuICAgICAgICBpZiAodGhpcy5yZWFkeVN0YXRlID09PSB0aGlzLkRPTkUpIHtcbiAgICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLnJlc3BvbnNlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignZ2V0SlNPTjogYCcgKyB1cmwgKyAnYCBmYWlsZWQgd2l0aCBzdGF0dXM6IFsnICsgdGhpcy5zdGF0dXMgKyAnXScpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBnZXRKU09OKCcvcG9zdHMuanNvbicpLnRoZW4oZnVuY3Rpb24oanNvbikge1xuICAgIC8vIG9uIGZ1bGZpbGxtZW50XG4gIH0sIGZ1bmN0aW9uKHJlYXNvbikge1xuICAgIC8vIG9uIHJlamVjdGlvblxuICB9KTtcbiAgYGBgXG5cbiAgVW5saWtlIGNhbGxiYWNrcywgcHJvbWlzZXMgYXJlIGdyZWF0IGNvbXBvc2FibGUgcHJpbWl0aXZlcy5cblxuICBgYGBqc1xuICBQcm9taXNlLmFsbChbXG4gICAgZ2V0SlNPTignL3Bvc3RzJyksXG4gICAgZ2V0SlNPTignL2NvbW1lbnRzJylcbiAgXSkudGhlbihmdW5jdGlvbih2YWx1ZXMpe1xuICAgIHZhbHVlc1swXSAvLyA9PiBwb3N0c0pTT05cbiAgICB2YWx1ZXNbMV0gLy8gPT4gY29tbWVudHNKU09OXG5cbiAgICByZXR1cm4gdmFsdWVzO1xuICB9KTtcbiAgYGBgXG5cbiAgQGNsYXNzIFByb21pc2VcbiAgQHBhcmFtIHtGdW5jdGlvbn0gcmVzb2x2ZXJcbiAgVXNlZnVsIGZvciB0b29saW5nLlxuICBAY29uc3RydWN0b3JcbiovXG5cbnZhciBQcm9taXNlJDEgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIFByb21pc2UocmVzb2x2ZXIpIHtcbiAgICB0aGlzW1BST01JU0VfSURdID0gbmV4dElkKCk7XG4gICAgdGhpcy5fcmVzdWx0ID0gdGhpcy5fc3RhdGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fc3Vic2NyaWJlcnMgPSBbXTtcblxuICAgIGlmIChub29wICE9PSByZXNvbHZlcikge1xuICAgICAgdHlwZW9mIHJlc29sdmVyICE9PSAnZnVuY3Rpb24nICYmIG5lZWRzUmVzb2x2ZXIoKTtcbiAgICAgIHRoaXMgaW5zdGFuY2VvZiBQcm9taXNlID8gaW5pdGlhbGl6ZVByb21pc2UodGhpcywgcmVzb2x2ZXIpIDogbmVlZHNOZXcoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgVGhlIHByaW1hcnkgd2F5IG9mIGludGVyYWN0aW5nIHdpdGggYSBwcm9taXNlIGlzIHRocm91Z2ggaXRzIGB0aGVuYCBtZXRob2QsXG4gIHdoaWNoIHJlZ2lzdGVycyBjYWxsYmFja3MgdG8gcmVjZWl2ZSBlaXRoZXIgYSBwcm9taXNlJ3MgZXZlbnR1YWwgdmFsdWUgb3IgdGhlXG4gIHJlYXNvbiB3aHkgdGhlIHByb21pc2UgY2Fubm90IGJlIGZ1bGZpbGxlZC5cbiAgIGBgYGpzXG4gIGZpbmRVc2VyKCkudGhlbihmdW5jdGlvbih1c2VyKXtcbiAgICAvLyB1c2VyIGlzIGF2YWlsYWJsZVxuICB9LCBmdW5jdGlvbihyZWFzb24pe1xuICAgIC8vIHVzZXIgaXMgdW5hdmFpbGFibGUsIGFuZCB5b3UgYXJlIGdpdmVuIHRoZSByZWFzb24gd2h5XG4gIH0pO1xuICBgYGBcbiAgIENoYWluaW5nXG4gIC0tLS0tLS0tXG4gICBUaGUgcmV0dXJuIHZhbHVlIG9mIGB0aGVuYCBpcyBpdHNlbGYgYSBwcm9taXNlLiAgVGhpcyBzZWNvbmQsICdkb3duc3RyZWFtJ1xuICBwcm9taXNlIGlzIHJlc29sdmVkIHdpdGggdGhlIHJldHVybiB2YWx1ZSBvZiB0aGUgZmlyc3QgcHJvbWlzZSdzIGZ1bGZpbGxtZW50XG4gIG9yIHJlamVjdGlvbiBoYW5kbGVyLCBvciByZWplY3RlZCBpZiB0aGUgaGFuZGxlciB0aHJvd3MgYW4gZXhjZXB0aW9uLlxuICAgYGBganNcbiAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgcmV0dXJuIHVzZXIubmFtZTtcbiAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgIHJldHVybiAnZGVmYXVsdCBuYW1lJztcbiAgfSkudGhlbihmdW5jdGlvbiAodXNlck5hbWUpIHtcbiAgICAvLyBJZiBgZmluZFVzZXJgIGZ1bGZpbGxlZCwgYHVzZXJOYW1lYCB3aWxsIGJlIHRoZSB1c2VyJ3MgbmFtZSwgb3RoZXJ3aXNlIGl0XG4gICAgLy8gd2lsbCBiZSBgJ2RlZmF1bHQgbmFtZSdgXG4gIH0pO1xuICAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdGb3VuZCB1c2VyLCBidXQgc3RpbGwgdW5oYXBweScpO1xuICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdgZmluZFVzZXJgIHJlamVjdGVkIGFuZCB3ZSdyZSB1bmhhcHB5Jyk7XG4gIH0pLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgLy8gbmV2ZXIgcmVhY2hlZFxuICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgLy8gaWYgYGZpbmRVc2VyYCBmdWxmaWxsZWQsIGByZWFzb25gIHdpbGwgYmUgJ0ZvdW5kIHVzZXIsIGJ1dCBzdGlsbCB1bmhhcHB5Jy5cbiAgICAvLyBJZiBgZmluZFVzZXJgIHJlamVjdGVkLCBgcmVhc29uYCB3aWxsIGJlICdgZmluZFVzZXJgIHJlamVjdGVkIGFuZCB3ZSdyZSB1bmhhcHB5Jy5cbiAgfSk7XG4gIGBgYFxuICBJZiB0aGUgZG93bnN0cmVhbSBwcm9taXNlIGRvZXMgbm90IHNwZWNpZnkgYSByZWplY3Rpb24gaGFuZGxlciwgcmVqZWN0aW9uIHJlYXNvbnMgd2lsbCBiZSBwcm9wYWdhdGVkIGZ1cnRoZXIgZG93bnN0cmVhbS5cbiAgIGBgYGpzXG4gIGZpbmRVc2VyKCkudGhlbihmdW5jdGlvbiAodXNlcikge1xuICAgIHRocm93IG5ldyBQZWRhZ29naWNhbEV4Y2VwdGlvbignVXBzdHJlYW0gZXJyb3InKTtcbiAgfSkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAvLyBuZXZlciByZWFjaGVkXG4gIH0pLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgLy8gbmV2ZXIgcmVhY2hlZFxuICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgLy8gVGhlIGBQZWRnYWdvY2lhbEV4Y2VwdGlvbmAgaXMgcHJvcGFnYXRlZCBhbGwgdGhlIHdheSBkb3duIHRvIGhlcmVcbiAgfSk7XG4gIGBgYFxuICAgQXNzaW1pbGF0aW9uXG4gIC0tLS0tLS0tLS0tLVxuICAgU29tZXRpbWVzIHRoZSB2YWx1ZSB5b3Ugd2FudCB0byBwcm9wYWdhdGUgdG8gYSBkb3duc3RyZWFtIHByb21pc2UgY2FuIG9ubHkgYmVcbiAgcmV0cmlldmVkIGFzeW5jaHJvbm91c2x5LiBUaGlzIGNhbiBiZSBhY2hpZXZlZCBieSByZXR1cm5pbmcgYSBwcm9taXNlIGluIHRoZVxuICBmdWxmaWxsbWVudCBvciByZWplY3Rpb24gaGFuZGxlci4gVGhlIGRvd25zdHJlYW0gcHJvbWlzZSB3aWxsIHRoZW4gYmUgcGVuZGluZ1xuICB1bnRpbCB0aGUgcmV0dXJuZWQgcHJvbWlzZSBpcyBzZXR0bGVkLiBUaGlzIGlzIGNhbGxlZCAqYXNzaW1pbGF0aW9uKi5cbiAgIGBgYGpzXG4gIGZpbmRVc2VyKCkudGhlbihmdW5jdGlvbiAodXNlcikge1xuICAgIHJldHVybiBmaW5kQ29tbWVudHNCeUF1dGhvcih1c2VyKTtcbiAgfSkudGhlbihmdW5jdGlvbiAoY29tbWVudHMpIHtcbiAgICAvLyBUaGUgdXNlcidzIGNvbW1lbnRzIGFyZSBub3cgYXZhaWxhYmxlXG4gIH0pO1xuICBgYGBcbiAgIElmIHRoZSBhc3NpbWxpYXRlZCBwcm9taXNlIHJlamVjdHMsIHRoZW4gdGhlIGRvd25zdHJlYW0gcHJvbWlzZSB3aWxsIGFsc28gcmVqZWN0LlxuICAgYGBganNcbiAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgcmV0dXJuIGZpbmRDb21tZW50c0J5QXV0aG9yKHVzZXIpO1xuICB9KS50aGVuKGZ1bmN0aW9uIChjb21tZW50cykge1xuICAgIC8vIElmIGBmaW5kQ29tbWVudHNCeUF1dGhvcmAgZnVsZmlsbHMsIHdlJ2xsIGhhdmUgdGhlIHZhbHVlIGhlcmVcbiAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgIC8vIElmIGBmaW5kQ29tbWVudHNCeUF1dGhvcmAgcmVqZWN0cywgd2UnbGwgaGF2ZSB0aGUgcmVhc29uIGhlcmVcbiAgfSk7XG4gIGBgYFxuICAgU2ltcGxlIEV4YW1wbGVcbiAgLS0tLS0tLS0tLS0tLS1cbiAgIFN5bmNocm9ub3VzIEV4YW1wbGVcbiAgIGBgYGphdmFzY3JpcHRcbiAgbGV0IHJlc3VsdDtcbiAgIHRyeSB7XG4gICAgcmVzdWx0ID0gZmluZFJlc3VsdCgpO1xuICAgIC8vIHN1Y2Nlc3NcbiAgfSBjYXRjaChyZWFzb24pIHtcbiAgICAvLyBmYWlsdXJlXG4gIH1cbiAgYGBgXG4gICBFcnJiYWNrIEV4YW1wbGVcbiAgIGBgYGpzXG4gIGZpbmRSZXN1bHQoZnVuY3Rpb24ocmVzdWx0LCBlcnIpe1xuICAgIGlmIChlcnIpIHtcbiAgICAgIC8vIGZhaWx1cmVcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gc3VjY2Vzc1xuICAgIH1cbiAgfSk7XG4gIGBgYFxuICAgUHJvbWlzZSBFeGFtcGxlO1xuICAgYGBgamF2YXNjcmlwdFxuICBmaW5kUmVzdWx0KCkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuICAgIC8vIHN1Y2Nlc3NcbiAgfSwgZnVuY3Rpb24ocmVhc29uKXtcbiAgICAvLyBmYWlsdXJlXG4gIH0pO1xuICBgYGBcbiAgIEFkdmFuY2VkIEV4YW1wbGVcbiAgLS0tLS0tLS0tLS0tLS1cbiAgIFN5bmNocm9ub3VzIEV4YW1wbGVcbiAgIGBgYGphdmFzY3JpcHRcbiAgbGV0IGF1dGhvciwgYm9va3M7XG4gICB0cnkge1xuICAgIGF1dGhvciA9IGZpbmRBdXRob3IoKTtcbiAgICBib29rcyAgPSBmaW5kQm9va3NCeUF1dGhvcihhdXRob3IpO1xuICAgIC8vIHN1Y2Nlc3NcbiAgfSBjYXRjaChyZWFzb24pIHtcbiAgICAvLyBmYWlsdXJlXG4gIH1cbiAgYGBgXG4gICBFcnJiYWNrIEV4YW1wbGVcbiAgIGBgYGpzXG4gICBmdW5jdGlvbiBmb3VuZEJvb2tzKGJvb2tzKSB7XG4gICB9XG4gICBmdW5jdGlvbiBmYWlsdXJlKHJlYXNvbikge1xuICAgfVxuICAgZmluZEF1dGhvcihmdW5jdGlvbihhdXRob3IsIGVycil7XG4gICAgaWYgKGVycikge1xuICAgICAgZmFpbHVyZShlcnIpO1xuICAgICAgLy8gZmFpbHVyZVxuICAgIH0gZWxzZSB7XG4gICAgICB0cnkge1xuICAgICAgICBmaW5kQm9vb2tzQnlBdXRob3IoYXV0aG9yLCBmdW5jdGlvbihib29rcywgZXJyKSB7XG4gICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgZmFpbHVyZShlcnIpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBmb3VuZEJvb2tzKGJvb2tzKTtcbiAgICAgICAgICAgIH0gY2F0Y2gocmVhc29uKSB7XG4gICAgICAgICAgICAgIGZhaWx1cmUocmVhc29uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSBjYXRjaChlcnJvcikge1xuICAgICAgICBmYWlsdXJlKGVycik7XG4gICAgICB9XG4gICAgICAvLyBzdWNjZXNzXG4gICAgfVxuICB9KTtcbiAgYGBgXG4gICBQcm9taXNlIEV4YW1wbGU7XG4gICBgYGBqYXZhc2NyaXB0XG4gIGZpbmRBdXRob3IoKS5cbiAgICB0aGVuKGZpbmRCb29rc0J5QXV0aG9yKS5cbiAgICB0aGVuKGZ1bmN0aW9uKGJvb2tzKXtcbiAgICAgIC8vIGZvdW5kIGJvb2tzXG4gIH0pLmNhdGNoKGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgLy8gc29tZXRoaW5nIHdlbnQgd3JvbmdcbiAgfSk7XG4gIGBgYFxuICAgQG1ldGhvZCB0aGVuXG4gIEBwYXJhbSB7RnVuY3Rpb259IG9uRnVsZmlsbGVkXG4gIEBwYXJhbSB7RnVuY3Rpb259IG9uUmVqZWN0ZWRcbiAgVXNlZnVsIGZvciB0b29saW5nLlxuICBAcmV0dXJuIHtQcm9taXNlfVxuICAqL1xuXG4gIC8qKlxuICBgY2F0Y2hgIGlzIHNpbXBseSBzdWdhciBmb3IgYHRoZW4odW5kZWZpbmVkLCBvblJlamVjdGlvbilgIHdoaWNoIG1ha2VzIGl0IHRoZSBzYW1lXG4gIGFzIHRoZSBjYXRjaCBibG9jayBvZiBhIHRyeS9jYXRjaCBzdGF0ZW1lbnQuXG4gIGBgYGpzXG4gIGZ1bmN0aW9uIGZpbmRBdXRob3IoKXtcbiAgdGhyb3cgbmV3IEVycm9yKCdjb3VsZG4ndCBmaW5kIHRoYXQgYXV0aG9yJyk7XG4gIH1cbiAgLy8gc3luY2hyb25vdXNcbiAgdHJ5IHtcbiAgZmluZEF1dGhvcigpO1xuICB9IGNhdGNoKHJlYXNvbikge1xuICAvLyBzb21ldGhpbmcgd2VudCB3cm9uZ1xuICB9XG4gIC8vIGFzeW5jIHdpdGggcHJvbWlzZXNcbiAgZmluZEF1dGhvcigpLmNhdGNoKGZ1bmN0aW9uKHJlYXNvbil7XG4gIC8vIHNvbWV0aGluZyB3ZW50IHdyb25nXG4gIH0pO1xuICBgYGBcbiAgQG1ldGhvZCBjYXRjaFxuICBAcGFyYW0ge0Z1bmN0aW9ufSBvblJlamVjdGlvblxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEByZXR1cm4ge1Byb21pc2V9XG4gICovXG5cblxuICBQcm9taXNlLnByb3RvdHlwZS5jYXRjaCA9IGZ1bmN0aW9uIF9jYXRjaChvblJlamVjdGlvbikge1xuICAgIHJldHVybiB0aGlzLnRoZW4obnVsbCwgb25SZWplY3Rpb24pO1xuICB9O1xuXG4gIC8qKlxuICAgIGBmaW5hbGx5YCB3aWxsIGJlIGludm9rZWQgcmVnYXJkbGVzcyBvZiB0aGUgcHJvbWlzZSdzIGZhdGUganVzdCBhcyBuYXRpdmVcbiAgICB0cnkvY2F0Y2gvZmluYWxseSBiZWhhdmVzXG4gIFxuICAgIFN5bmNocm9ub3VzIGV4YW1wbGU6XG4gIFxuICAgIGBgYGpzXG4gICAgZmluZEF1dGhvcigpIHtcbiAgICAgIGlmIChNYXRoLnJhbmRvbSgpID4gMC41KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcigpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG5ldyBBdXRob3IoKTtcbiAgICB9XG4gIFxuICAgIHRyeSB7XG4gICAgICByZXR1cm4gZmluZEF1dGhvcigpOyAvLyBzdWNjZWVkIG9yIGZhaWxcbiAgICB9IGNhdGNoKGVycm9yKSB7XG4gICAgICByZXR1cm4gZmluZE90aGVyQXV0aGVyKCk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIC8vIGFsd2F5cyBydW5zXG4gICAgICAvLyBkb2Vzbid0IGFmZmVjdCB0aGUgcmV0dXJuIHZhbHVlXG4gICAgfVxuICAgIGBgYFxuICBcbiAgICBBc3luY2hyb25vdXMgZXhhbXBsZTpcbiAgXG4gICAgYGBganNcbiAgICBmaW5kQXV0aG9yKCkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKXtcbiAgICAgIHJldHVybiBmaW5kT3RoZXJBdXRoZXIoKTtcbiAgICB9KS5maW5hbGx5KGZ1bmN0aW9uKCl7XG4gICAgICAvLyBhdXRob3Igd2FzIGVpdGhlciBmb3VuZCwgb3Igbm90XG4gICAgfSk7XG4gICAgYGBgXG4gIFxuICAgIEBtZXRob2QgZmluYWxseVxuICAgIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrXG4gICAgQHJldHVybiB7UHJvbWlzZX1cbiAgKi9cblxuXG4gIFByb21pc2UucHJvdG90eXBlLmZpbmFsbHkgPSBmdW5jdGlvbiBfZmluYWxseShjYWxsYmFjaykge1xuICAgIHZhciBwcm9taXNlID0gdGhpcztcbiAgICB2YXIgY29uc3RydWN0b3IgPSBwcm9taXNlLmNvbnN0cnVjdG9yO1xuXG4gICAgaWYgKGlzRnVuY3Rpb24oY2FsbGJhY2spKSB7XG4gICAgICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gY29uc3RydWN0b3IucmVzb2x2ZShjYWxsYmFjaygpKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgICAgICByZXR1cm4gY29uc3RydWN0b3IucmVzb2x2ZShjYWxsYmFjaygpKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0aHJvdyByZWFzb247XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHByb21pc2UudGhlbihjYWxsYmFjaywgY2FsbGJhY2spO1xuICB9O1xuXG4gIHJldHVybiBQcm9taXNlO1xufSgpO1xuXG5Qcm9taXNlJDEucHJvdG90eXBlLnRoZW4gPSB0aGVuO1xuUHJvbWlzZSQxLmFsbCA9IGFsbDtcblByb21pc2UkMS5yYWNlID0gcmFjZTtcblByb21pc2UkMS5yZXNvbHZlID0gcmVzb2x2ZSQxO1xuUHJvbWlzZSQxLnJlamVjdCA9IHJlamVjdCQxO1xuUHJvbWlzZSQxLl9zZXRTY2hlZHVsZXIgPSBzZXRTY2hlZHVsZXI7XG5Qcm9taXNlJDEuX3NldEFzYXAgPSBzZXRBc2FwO1xuUHJvbWlzZSQxLl9hc2FwID0gYXNhcDtcblxuLypnbG9iYWwgc2VsZiovXG5mdW5jdGlvbiBwb2x5ZmlsbCgpIHtcbiAgdmFyIGxvY2FsID0gdm9pZCAwO1xuXG4gIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xuICAgIGxvY2FsID0gZ2xvYmFsO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJykge1xuICAgIGxvY2FsID0gc2VsZjtcbiAgfSBlbHNlIHtcbiAgICB0cnkge1xuICAgICAgbG9jYWwgPSBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcigncG9seWZpbGwgZmFpbGVkIGJlY2F1c2UgZ2xvYmFsIG9iamVjdCBpcyB1bmF2YWlsYWJsZSBpbiB0aGlzIGVudmlyb25tZW50Jyk7XG4gICAgfVxuICB9XG5cbiAgdmFyIFAgPSBsb2NhbC5Qcm9taXNlO1xuXG4gIGlmIChQKSB7XG4gICAgdmFyIHByb21pc2VUb1N0cmluZyA9IG51bGw7XG4gICAgdHJ5IHtcbiAgICAgIHByb21pc2VUb1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChQLnJlc29sdmUoKSk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gc2lsZW50bHkgaWdub3JlZFxuICAgIH1cblxuICAgIGlmIChwcm9taXNlVG9TdHJpbmcgPT09ICdbb2JqZWN0IFByb21pc2VdJyAmJiAhUC5jYXN0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG5cbiAgbG9jYWwuUHJvbWlzZSA9IFByb21pc2UkMTtcbn1cblxuLy8gU3RyYW5nZSBjb21wYXQuLlxuUHJvbWlzZSQxLnBvbHlmaWxsID0gcG9seWZpbGw7XG5Qcm9taXNlJDEuUHJvbWlzZSA9IFByb21pc2UkMTtcblxucmV0dXJuIFByb21pc2UkMTtcblxufSkpKTtcblxuXG5cblxuXG59KS5jYWxsKHRoaXMsX2RlcmVxXygnX3Byb2Nlc3MnKSx0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHt9KVxuXG59LHtcIl9wcm9jZXNzXCI6M31dLDI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuLy8gQ29weXJpZ2h0IEpveWVudCwgSW5jLiBhbmQgb3RoZXIgTm9kZSBjb250cmlidXRvcnMuXG4vL1xuLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGFcbi8vIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGVcbi8vIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZ1xuLy8gd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLFxuLy8gZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdFxuLy8gcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlXG4vLyBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZFxuLy8gaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTU1xuLy8gT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRlxuLy8gTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTlxuLy8gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1Jcbi8vIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLCBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEVcbi8vIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbmZ1bmN0aW9uIEV2ZW50RW1pdHRlcigpIHtcbiAgdGhpcy5fZXZlbnRzID0gdGhpcy5fZXZlbnRzIHx8IHt9O1xuICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSB0aGlzLl9tYXhMaXN0ZW5lcnMgfHwgdW5kZWZpbmVkO1xufVxubW9kdWxlLmV4cG9ydHMgPSBFdmVudEVtaXR0ZXI7XG5cbi8vIEJhY2t3YXJkcy1jb21wYXQgd2l0aCBub2RlIDAuMTAueFxuRXZlbnRFbWl0dGVyLkV2ZW50RW1pdHRlciA9IEV2ZW50RW1pdHRlcjtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5fZXZlbnRzID0gdW5kZWZpbmVkO1xuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5fbWF4TGlzdGVuZXJzID0gdW5kZWZpbmVkO1xuXG4vLyBCeSBkZWZhdWx0IEV2ZW50RW1pdHRlcnMgd2lsbCBwcmludCBhIHdhcm5pbmcgaWYgbW9yZSB0aGFuIDEwIGxpc3RlbmVycyBhcmVcbi8vIGFkZGVkIHRvIGl0LiBUaGlzIGlzIGEgdXNlZnVsIGRlZmF1bHQgd2hpY2ggaGVscHMgZmluZGluZyBtZW1vcnkgbGVha3MuXG5FdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVycyA9IDEwO1xuXG4vLyBPYnZpb3VzbHkgbm90IGFsbCBFbWl0dGVycyBzaG91bGQgYmUgbGltaXRlZCB0byAxMC4gVGhpcyBmdW5jdGlvbiBhbGxvd3Ncbi8vIHRoYXQgdG8gYmUgaW5jcmVhc2VkLiBTZXQgdG8gemVybyBmb3IgdW5saW1pdGVkLlxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5zZXRNYXhMaXN0ZW5lcnMgPSBmdW5jdGlvbihuKSB7XG4gIGlmICghaXNOdW1iZXIobikgfHwgbiA8IDAgfHwgaXNOYU4obikpXG4gICAgdGhyb3cgVHlwZUVycm9yKCduIG11c3QgYmUgYSBwb3NpdGl2ZSBudW1iZXInKTtcbiAgdGhpcy5fbWF4TGlzdGVuZXJzID0gbjtcbiAgcmV0dXJuIHRoaXM7XG59O1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbih0eXBlKSB7XG4gIHZhciBlciwgaGFuZGxlciwgbGVuLCBhcmdzLCBpLCBsaXN0ZW5lcnM7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHMpXG4gICAgdGhpcy5fZXZlbnRzID0ge307XG5cbiAgLy8gSWYgdGhlcmUgaXMgbm8gJ2Vycm9yJyBldmVudCBsaXN0ZW5lciB0aGVuIHRocm93LlxuICBpZiAodHlwZSA9PT0gJ2Vycm9yJykge1xuICAgIGlmICghdGhpcy5fZXZlbnRzLmVycm9yIHx8XG4gICAgICAgIChpc09iamVjdCh0aGlzLl9ldmVudHMuZXJyb3IpICYmICF0aGlzLl9ldmVudHMuZXJyb3IubGVuZ3RoKSkge1xuICAgICAgZXIgPSBhcmd1bWVudHNbMV07XG4gICAgICBpZiAoZXIgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICB0aHJvdyBlcjsgLy8gVW5oYW5kbGVkICdlcnJvcicgZXZlbnRcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEF0IGxlYXN0IGdpdmUgc29tZSBraW5kIG9mIGNvbnRleHQgdG8gdGhlIHVzZXJcbiAgICAgICAgdmFyIGVyciA9IG5ldyBFcnJvcignVW5jYXVnaHQsIHVuc3BlY2lmaWVkIFwiZXJyb3JcIiBldmVudC4gKCcgKyBlciArICcpJyk7XG4gICAgICAgIGVyci5jb250ZXh0ID0gZXI7XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBoYW5kbGVyID0gdGhpcy5fZXZlbnRzW3R5cGVdO1xuXG4gIGlmIChpc1VuZGVmaW5lZChoYW5kbGVyKSlcbiAgICByZXR1cm4gZmFsc2U7XG5cbiAgaWYgKGlzRnVuY3Rpb24oaGFuZGxlcikpIHtcbiAgICBzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcbiAgICAgIC8vIGZhc3QgY2FzZXNcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMjpcbiAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAzOlxuICAgICAgICBoYW5kbGVyLmNhbGwodGhpcywgYXJndW1lbnRzWzFdLCBhcmd1bWVudHNbMl0pO1xuICAgICAgICBicmVhaztcbiAgICAgIC8vIHNsb3dlclxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgICAgIGhhbmRsZXIuYXBwbHkodGhpcywgYXJncyk7XG4gICAgfVxuICB9IGVsc2UgaWYgKGlzT2JqZWN0KGhhbmRsZXIpKSB7XG4gICAgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgbGlzdGVuZXJzID0gaGFuZGxlci5zbGljZSgpO1xuICAgIGxlbiA9IGxpc3RlbmVycy5sZW5ndGg7XG4gICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKVxuICAgICAgbGlzdGVuZXJzW2ldLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICB9XG5cbiAgcmV0dXJuIHRydWU7XG59O1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZExpc3RlbmVyID0gZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIpIHtcbiAgdmFyIG07XG5cbiAgaWYgKCFpc0Z1bmN0aW9uKGxpc3RlbmVyKSlcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzKVxuICAgIHRoaXMuX2V2ZW50cyA9IHt9O1xuXG4gIC8vIFRvIGF2b2lkIHJlY3Vyc2lvbiBpbiB0aGUgY2FzZSB0aGF0IHR5cGUgPT09IFwibmV3TGlzdGVuZXJcIiEgQmVmb3JlXG4gIC8vIGFkZGluZyBpdCB0byB0aGUgbGlzdGVuZXJzLCBmaXJzdCBlbWl0IFwibmV3TGlzdGVuZXJcIi5cbiAgaWYgKHRoaXMuX2V2ZW50cy5uZXdMaXN0ZW5lcilcbiAgICB0aGlzLmVtaXQoJ25ld0xpc3RlbmVyJywgdHlwZSxcbiAgICAgICAgICAgICAgaXNGdW5jdGlvbihsaXN0ZW5lci5saXN0ZW5lcikgP1xuICAgICAgICAgICAgICBsaXN0ZW5lci5saXN0ZW5lciA6IGxpc3RlbmVyKTtcblxuICBpZiAoIXRoaXMuX2V2ZW50c1t0eXBlXSlcbiAgICAvLyBPcHRpbWl6ZSB0aGUgY2FzZSBvZiBvbmUgbGlzdGVuZXIuIERvbid0IG5lZWQgdGhlIGV4dHJhIGFycmF5IG9iamVjdC5cbiAgICB0aGlzLl9ldmVudHNbdHlwZV0gPSBsaXN0ZW5lcjtcbiAgZWxzZSBpZiAoaXNPYmplY3QodGhpcy5fZXZlbnRzW3R5cGVdKSlcbiAgICAvLyBJZiB3ZSd2ZSBhbHJlYWR5IGdvdCBhbiBhcnJheSwganVzdCBhcHBlbmQuXG4gICAgdGhpcy5fZXZlbnRzW3R5cGVdLnB1c2gobGlzdGVuZXIpO1xuICBlbHNlXG4gICAgLy8gQWRkaW5nIHRoZSBzZWNvbmQgZWxlbWVudCwgbmVlZCB0byBjaGFuZ2UgdG8gYXJyYXkuXG4gICAgdGhpcy5fZXZlbnRzW3R5cGVdID0gW3RoaXMuX2V2ZW50c1t0eXBlXSwgbGlzdGVuZXJdO1xuXG4gIC8vIENoZWNrIGZvciBsaXN0ZW5lciBsZWFrXG4gIGlmIChpc09iamVjdCh0aGlzLl9ldmVudHNbdHlwZV0pICYmICF0aGlzLl9ldmVudHNbdHlwZV0ud2FybmVkKSB7XG4gICAgaWYgKCFpc1VuZGVmaW5lZCh0aGlzLl9tYXhMaXN0ZW5lcnMpKSB7XG4gICAgICBtID0gdGhpcy5fbWF4TGlzdGVuZXJzO1xuICAgIH0gZWxzZSB7XG4gICAgICBtID0gRXZlbnRFbWl0dGVyLmRlZmF1bHRNYXhMaXN0ZW5lcnM7XG4gICAgfVxuXG4gICAgaWYgKG0gJiYgbSA+IDAgJiYgdGhpcy5fZXZlbnRzW3R5cGVdLmxlbmd0aCA+IG0pIHtcbiAgICAgIHRoaXMuX2V2ZW50c1t0eXBlXS53YXJuZWQgPSB0cnVlO1xuICAgICAgY29uc29sZS5lcnJvcignKG5vZGUpIHdhcm5pbmc6IHBvc3NpYmxlIEV2ZW50RW1pdHRlciBtZW1vcnkgJyArXG4gICAgICAgICAgICAgICAgICAgICdsZWFrIGRldGVjdGVkLiAlZCBsaXN0ZW5lcnMgYWRkZWQuICcgK1xuICAgICAgICAgICAgICAgICAgICAnVXNlIGVtaXR0ZXIuc2V0TWF4TGlzdGVuZXJzKCkgdG8gaW5jcmVhc2UgbGltaXQuJyxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdLmxlbmd0aCk7XG4gICAgICBpZiAodHlwZW9mIGNvbnNvbGUudHJhY2UgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgLy8gbm90IHN1cHBvcnRlZCBpbiBJRSAxMFxuICAgICAgICBjb25zb2xlLnRyYWNlKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uID0gRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5hZGRMaXN0ZW5lcjtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbmNlID0gZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIpIHtcbiAgaWYgKCFpc0Z1bmN0aW9uKGxpc3RlbmVyKSlcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuXG4gIHZhciBmaXJlZCA9IGZhbHNlO1xuXG4gIGZ1bmN0aW9uIGcoKSB7XG4gICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBnKTtcblxuICAgIGlmICghZmlyZWQpIHtcbiAgICAgIGZpcmVkID0gdHJ1ZTtcbiAgICAgIGxpc3RlbmVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgfVxuICB9XG5cbiAgZy5saXN0ZW5lciA9IGxpc3RlbmVyO1xuICB0aGlzLm9uKHR5cGUsIGcpO1xuXG4gIHJldHVybiB0aGlzO1xufTtcblxuLy8gZW1pdHMgYSAncmVtb3ZlTGlzdGVuZXInIGV2ZW50IGlmZiB0aGUgbGlzdGVuZXIgd2FzIHJlbW92ZWRcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlTGlzdGVuZXIgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikge1xuICB2YXIgbGlzdCwgcG9zaXRpb24sIGxlbmd0aCwgaTtcblxuICBpZiAoIWlzRnVuY3Rpb24obGlzdGVuZXIpKVxuICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHMgfHwgIXRoaXMuX2V2ZW50c1t0eXBlXSlcbiAgICByZXR1cm4gdGhpcztcblxuICBsaXN0ID0gdGhpcy5fZXZlbnRzW3R5cGVdO1xuICBsZW5ndGggPSBsaXN0Lmxlbmd0aDtcbiAgcG9zaXRpb24gPSAtMTtcblxuICBpZiAobGlzdCA9PT0gbGlzdGVuZXIgfHxcbiAgICAgIChpc0Z1bmN0aW9uKGxpc3QubGlzdGVuZXIpICYmIGxpc3QubGlzdGVuZXIgPT09IGxpc3RlbmVyKSkge1xuICAgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07XG4gICAgaWYgKHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcilcbiAgICAgIHRoaXMuZW1pdCgncmVtb3ZlTGlzdGVuZXInLCB0eXBlLCBsaXN0ZW5lcik7XG5cbiAgfSBlbHNlIGlmIChpc09iamVjdChsaXN0KSkge1xuICAgIGZvciAoaSA9IGxlbmd0aDsgaS0tID4gMDspIHtcbiAgICAgIGlmIChsaXN0W2ldID09PSBsaXN0ZW5lciB8fFxuICAgICAgICAgIChsaXN0W2ldLmxpc3RlbmVyICYmIGxpc3RbaV0ubGlzdGVuZXIgPT09IGxpc3RlbmVyKSkge1xuICAgICAgICBwb3NpdGlvbiA9IGk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChwb3NpdGlvbiA8IDApXG4gICAgICByZXR1cm4gdGhpcztcblxuICAgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMSkge1xuICAgICAgbGlzdC5sZW5ndGggPSAwO1xuICAgICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTtcbiAgICB9IGVsc2Uge1xuICAgICAgbGlzdC5zcGxpY2UocG9zaXRpb24sIDEpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9ldmVudHMucmVtb3ZlTGlzdGVuZXIpXG4gICAgICB0aGlzLmVtaXQoJ3JlbW92ZUxpc3RlbmVyJywgdHlwZSwgbGlzdGVuZXIpO1xuICB9XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUFsbExpc3RlbmVycyA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgdmFyIGtleSwgbGlzdGVuZXJzO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzKVxuICAgIHJldHVybiB0aGlzO1xuXG4gIC8vIG5vdCBsaXN0ZW5pbmcgZm9yIHJlbW92ZUxpc3RlbmVyLCBubyBuZWVkIHRvIGVtaXRcbiAgaWYgKCF0aGlzLl9ldmVudHMucmVtb3ZlTGlzdGVuZXIpIHtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMClcbiAgICAgIHRoaXMuX2V2ZW50cyA9IHt9O1xuICAgIGVsc2UgaWYgKHRoaXMuX2V2ZW50c1t0eXBlXSlcbiAgICAgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvLyBlbWl0IHJlbW92ZUxpc3RlbmVyIGZvciBhbGwgbGlzdGVuZXJzIG9uIGFsbCBldmVudHNcbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICBmb3IgKGtleSBpbiB0aGlzLl9ldmVudHMpIHtcbiAgICAgIGlmIChrZXkgPT09ICdyZW1vdmVMaXN0ZW5lcicpIGNvbnRpbnVlO1xuICAgICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoa2V5KTtcbiAgICB9XG4gICAgdGhpcy5yZW1vdmVBbGxMaXN0ZW5lcnMoJ3JlbW92ZUxpc3RlbmVyJyk7XG4gICAgdGhpcy5fZXZlbnRzID0ge307XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBsaXN0ZW5lcnMgPSB0aGlzLl9ldmVudHNbdHlwZV07XG5cbiAgaWYgKGlzRnVuY3Rpb24obGlzdGVuZXJzKSkge1xuICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXJzKTtcbiAgfSBlbHNlIGlmIChsaXN0ZW5lcnMpIHtcbiAgICAvLyBMSUZPIG9yZGVyXG4gICAgd2hpbGUgKGxpc3RlbmVycy5sZW5ndGgpXG4gICAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVyc1tsaXN0ZW5lcnMubGVuZ3RoIC0gMV0pO1xuICB9XG4gIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVycyA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgdmFyIHJldDtcbiAgaWYgKCF0aGlzLl9ldmVudHMgfHwgIXRoaXMuX2V2ZW50c1t0eXBlXSlcbiAgICByZXQgPSBbXTtcbiAgZWxzZSBpZiAoaXNGdW5jdGlvbih0aGlzLl9ldmVudHNbdHlwZV0pKVxuICAgIHJldCA9IFt0aGlzLl9ldmVudHNbdHlwZV1dO1xuICBlbHNlXG4gICAgcmV0ID0gdGhpcy5fZXZlbnRzW3R5cGVdLnNsaWNlKCk7XG4gIHJldHVybiByZXQ7XG59O1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLmxpc3RlbmVyQ291bnQgPSBmdW5jdGlvbih0eXBlKSB7XG4gIGlmICh0aGlzLl9ldmVudHMpIHtcbiAgICB2YXIgZXZsaXN0ZW5lciA9IHRoaXMuX2V2ZW50c1t0eXBlXTtcblxuICAgIGlmIChpc0Z1bmN0aW9uKGV2bGlzdGVuZXIpKVxuICAgICAgcmV0dXJuIDE7XG4gICAgZWxzZSBpZiAoZXZsaXN0ZW5lcilcbiAgICAgIHJldHVybiBldmxpc3RlbmVyLmxlbmd0aDtcbiAgfVxuICByZXR1cm4gMDtcbn07XG5cbkV2ZW50RW1pdHRlci5saXN0ZW5lckNvdW50ID0gZnVuY3Rpb24oZW1pdHRlciwgdHlwZSkge1xuICByZXR1cm4gZW1pdHRlci5saXN0ZW5lckNvdW50KHR5cGUpO1xufTtcblxuZnVuY3Rpb24gaXNGdW5jdGlvbihhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdmdW5jdGlvbic7XG59XG5cbmZ1bmN0aW9uIGlzTnVtYmVyKGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ251bWJlcic7XG59XG5cbmZ1bmN0aW9uIGlzT2JqZWN0KGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ29iamVjdCcgJiYgYXJnICE9PSBudWxsO1xufVxuXG5mdW5jdGlvbiBpc1VuZGVmaW5lZChhcmcpIHtcbiAgcmV0dXJuIGFyZyA9PT0gdm9pZCAwO1xufVxuXG59LHt9XSwzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxudmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG4vLyBjYWNoZWQgZnJvbSB3aGF0ZXZlciBnbG9iYWwgaXMgcHJlc2VudCBzbyB0aGF0IHRlc3QgcnVubmVycyB0aGF0IHN0dWIgaXRcbi8vIGRvbid0IGJyZWFrIHRoaW5ncy4gIEJ1dCB3ZSBuZWVkIHRvIHdyYXAgaXQgaW4gYSB0cnkgY2F0Y2ggaW4gY2FzZSBpdCBpc1xuLy8gd3JhcHBlZCBpbiBzdHJpY3QgbW9kZSBjb2RlIHdoaWNoIGRvZXNuJ3QgZGVmaW5lIGFueSBnbG9iYWxzLiAgSXQncyBpbnNpZGUgYVxuLy8gZnVuY3Rpb24gYmVjYXVzZSB0cnkvY2F0Y2hlcyBkZW9wdGltaXplIGluIGNlcnRhaW4gZW5naW5lcy5cblxudmFyIGNhY2hlZFNldFRpbWVvdXQ7XG52YXIgY2FjaGVkQ2xlYXJUaW1lb3V0O1xuXG5mdW5jdGlvbiBkZWZhdWx0U2V0VGltb3V0KCkge1xuICAgIHRocm93IG5ldyBFcnJvcignc2V0VGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuZnVuY3Rpb24gZGVmYXVsdENsZWFyVGltZW91dCAoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdjbGVhclRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbihmdW5jdGlvbiAoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBzZXRUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBjbGVhclRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgfVxufSAoKSlcbmZ1bmN0aW9uIHJ1blRpbWVvdXQoZnVuKSB7XG4gICAgaWYgKGNhY2hlZFNldFRpbWVvdXQgPT09IHNldFRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIC8vIGlmIHNldFRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRTZXRUaW1lb3V0ID09PSBkZWZhdWx0U2V0VGltb3V0IHx8ICFjYWNoZWRTZXRUaW1lb3V0KSAmJiBzZXRUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfSBjYXRjaChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbChudWxsLCBmdW4sIDApO1xuICAgICAgICB9IGNhdGNoKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3JcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwodGhpcywgZnVuLCAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG59XG5mdW5jdGlvbiBydW5DbGVhclRpbWVvdXQobWFya2VyKSB7XG4gICAgaWYgKGNhY2hlZENsZWFyVGltZW91dCA9PT0gY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIC8vIGlmIGNsZWFyVGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZENsZWFyVGltZW91dCA9PT0gZGVmYXVsdENsZWFyVGltZW91dCB8fCAhY2FjaGVkQ2xlYXJUaW1lb3V0KSAmJiBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0ICB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKG51bGwsIG1hcmtlcik7XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3IuXG4gICAgICAgICAgICAvLyBTb21lIHZlcnNpb25zIG9mIEkuRS4gaGF2ZSBkaWZmZXJlbnQgcnVsZXMgZm9yIGNsZWFyVGltZW91dCB2cyBzZXRUaW1lb3V0XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwodGhpcywgbWFya2VyKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG5cbn1cbnZhciBxdWV1ZSA9IFtdO1xudmFyIGRyYWluaW5nID0gZmFsc2U7XG52YXIgY3VycmVudFF1ZXVlO1xudmFyIHF1ZXVlSW5kZXggPSAtMTtcblxuZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuICAgIGlmICghZHJhaW5pbmcgfHwgIWN1cnJlbnRRdWV1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgfVxuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcbiAgICBpZiAoZHJhaW5pbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGltZW91dCA9IHJ1blRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTtcbiAgICBkcmFpbmluZyA9IHRydWU7XG5cbiAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIHdoaWxlKGxlbikge1xuICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcbiAgICAgICAgcXVldWUgPSBbXTtcbiAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB9XG4gICAgY3VycmVudFF1ZXVlID0gbnVsbDtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIHJ1bkNsZWFyVGltZW91dCh0aW1lb3V0KTtcbn1cblxucHJvY2Vzcy5uZXh0VGljayA9IGZ1bmN0aW9uIChmdW4pIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpO1xuICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDEgJiYgIWRyYWluaW5nKSB7XG4gICAgICAgIHJ1blRpbWVvdXQoZHJhaW5RdWV1ZSk7XG4gICAgfVxufTtcblxuLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0c1xuZnVuY3Rpb24gSXRlbShmdW4sIGFycmF5KSB7XG4gICAgdGhpcy5mdW4gPSBmdW47XG4gICAgdGhpcy5hcnJheSA9IGFycmF5O1xufVxuSXRlbS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpO1xufTtcbnByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5wcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xucHJvY2Vzcy5lbnYgPSB7fTtcbnByb2Nlc3MuYXJndiA9IFtdO1xucHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzXG5wcm9jZXNzLnZlcnNpb25zID0ge307XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5wcm9jZXNzLm9uID0gbm9vcDtcbnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5vbmNlID0gbm9vcDtcbnByb2Nlc3Mub2ZmID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wO1xucHJvY2Vzcy5lbWl0ID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZE9uY2VMaXN0ZW5lciA9IG5vb3A7XG5cbnByb2Nlc3MubGlzdGVuZXJzID0gZnVuY3Rpb24gKG5hbWUpIHsgcmV0dXJuIFtdIH1cblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xuXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbnByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07XG5cbn0se31dLDQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xudmFyIGJ1bmRsZUZuID0gYXJndW1lbnRzWzNdO1xudmFyIHNvdXJjZXMgPSBhcmd1bWVudHNbNF07XG52YXIgY2FjaGUgPSBhcmd1bWVudHNbNV07XG5cbnZhciBzdHJpbmdpZnkgPSBKU09OLnN0cmluZ2lmeTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoZm4sIG9wdGlvbnMpIHtcbiAgICB2YXIgd2tleTtcbiAgICB2YXIgY2FjaGVLZXlzID0gT2JqZWN0LmtleXMoY2FjaGUpO1xuXG4gICAgZm9yICh2YXIgaSA9IDAsIGwgPSBjYWNoZUtleXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIHZhciBrZXkgPSBjYWNoZUtleXNbaV07XG4gICAgICAgIHZhciBleHAgPSBjYWNoZVtrZXldLmV4cG9ydHM7XG4gICAgICAgIC8vIFVzaW5nIGJhYmVsIGFzIGEgdHJhbnNwaWxlciB0byB1c2UgZXNtb2R1bGUsIHRoZSBleHBvcnQgd2lsbCBhbHdheXNcbiAgICAgICAgLy8gYmUgYW4gb2JqZWN0IHdpdGggdGhlIGRlZmF1bHQgZXhwb3J0IGFzIGEgcHJvcGVydHkgb2YgaXQuIFRvIGVuc3VyZVxuICAgICAgICAvLyB0aGUgZXhpc3RpbmcgYXBpIGFuZCBiYWJlbCBlc21vZHVsZSBleHBvcnRzIGFyZSBib3RoIHN1cHBvcnRlZCB3ZVxuICAgICAgICAvLyBjaGVjayBmb3IgYm90aFxuICAgICAgICBpZiAoZXhwID09PSBmbiB8fCBleHAgJiYgZXhwLmRlZmF1bHQgPT09IGZuKSB7XG4gICAgICAgICAgICB3a2V5ID0ga2V5O1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIXdrZXkpIHtcbiAgICAgICAgd2tleSA9IE1hdGguZmxvb3IoTWF0aC5wb3coMTYsIDgpICogTWF0aC5yYW5kb20oKSkudG9TdHJpbmcoMTYpO1xuICAgICAgICB2YXIgd2NhY2hlID0ge307XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gY2FjaGVLZXlzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICAgICAgdmFyIGtleSA9IGNhY2hlS2V5c1tpXTtcbiAgICAgICAgICAgIHdjYWNoZVtrZXldID0ga2V5O1xuICAgICAgICB9XG4gICAgICAgIHNvdXJjZXNbd2tleV0gPSBbXG4gICAgICAgICAgICAnZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7JyArIGZuICsgJyhzZWxmKTsgfScsXG4gICAgICAgICAgICB3Y2FjaGVcbiAgICAgICAgXTtcbiAgICB9XG4gICAgdmFyIHNrZXkgPSBNYXRoLmZsb29yKE1hdGgucG93KDE2LCA4KSAqIE1hdGgucmFuZG9tKCkpLnRvU3RyaW5nKDE2KTtcblxuICAgIHZhciBzY2FjaGUgPSB7fTsgc2NhY2hlW3drZXldID0gd2tleTtcbiAgICBzb3VyY2VzW3NrZXldID0gW1xuICAgICAgICAnZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7JyArXG4gICAgICAgICAgICAvLyB0cnkgdG8gY2FsbCBkZWZhdWx0IGlmIGRlZmluZWQgdG8gYWxzbyBzdXBwb3J0IGJhYmVsIGVzbW9kdWxlIGV4cG9ydHNcbiAgICAgICAgICAgICd2YXIgZiA9IHJlcXVpcmUoJyArIHN0cmluZ2lmeSh3a2V5KSArICcpOycgK1xuICAgICAgICAgICAgJyhmLmRlZmF1bHQgPyBmLmRlZmF1bHQgOiBmKShzZWxmKTsnICtcbiAgICAgICAgJ30nLFxuICAgICAgICBzY2FjaGVcbiAgICBdO1xuXG4gICAgdmFyIHdvcmtlclNvdXJjZXMgPSB7fTtcbiAgICByZXNvbHZlU291cmNlcyhza2V5KTtcblxuICAgIGZ1bmN0aW9uIHJlc29sdmVTb3VyY2VzKGtleSkge1xuICAgICAgICB3b3JrZXJTb3VyY2VzW2tleV0gPSB0cnVlO1xuXG4gICAgICAgIGZvciAodmFyIGRlcFBhdGggaW4gc291cmNlc1trZXldWzFdKSB7XG4gICAgICAgICAgICB2YXIgZGVwS2V5ID0gc291cmNlc1trZXldWzFdW2RlcFBhdGhdO1xuICAgICAgICAgICAgaWYgKCF3b3JrZXJTb3VyY2VzW2RlcEtleV0pIHtcbiAgICAgICAgICAgICAgICByZXNvbHZlU291cmNlcyhkZXBLZXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHNyYyA9ICcoJyArIGJ1bmRsZUZuICsgJykoeydcbiAgICAgICAgKyBPYmplY3Qua2V5cyh3b3JrZXJTb3VyY2VzKS5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgcmV0dXJuIHN0cmluZ2lmeShrZXkpICsgJzpbJ1xuICAgICAgICAgICAgICAgICsgc291cmNlc1trZXldWzBdXG4gICAgICAgICAgICAgICAgKyAnLCcgKyBzdHJpbmdpZnkoc291cmNlc1trZXldWzFdKSArICddJ1xuICAgICAgICAgICAgO1xuICAgICAgICB9KS5qb2luKCcsJylcbiAgICAgICAgKyAnfSx7fSxbJyArIHN0cmluZ2lmeShza2V5KSArICddKSdcbiAgICA7XG5cbiAgICB2YXIgVVJMID0gd2luZG93LlVSTCB8fCB3aW5kb3cud2Via2l0VVJMIHx8IHdpbmRvdy5tb3pVUkwgfHwgd2luZG93Lm1zVVJMO1xuXG4gICAgdmFyIGJsb2IgPSBuZXcgQmxvYihbc3JjXSwgeyB0eXBlOiAndGV4dC9qYXZhc2NyaXB0JyB9KTtcbiAgICBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmJhcmUpIHsgcmV0dXJuIGJsb2I7IH1cbiAgICB2YXIgd29ya2VyVXJsID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcbiAgICB2YXIgd29ya2VyID0gbmV3IFdvcmtlcih3b3JrZXJVcmwpO1xuICAgIHdvcmtlci5vYmplY3RVUkwgPSB3b3JrZXJVcmw7XG4gICAgcmV0dXJuIHdvcmtlcjtcbn07XG5cbn0se31dLDU6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmNyZWF0ZURlZmF1bHRDb25maWcgPSBjcmVhdGVEZWZhdWx0Q29uZmlnO1xuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxudmFyIGRlZmF1bHRDb25maWcgPSBleHBvcnRzLmRlZmF1bHRDb25maWcgPSB7XG4gICAgZW5hYmxlV29ya2VyOiBmYWxzZSxcbiAgICBlbmFibGVTdGFzaEJ1ZmZlcjogdHJ1ZSxcbiAgICBzdGFzaEluaXRpYWxTaXplOiB1bmRlZmluZWQsXG5cbiAgICBpc0xpdmU6IGZhbHNlLFxuXG4gICAgbGF6eUxvYWQ6IHRydWUsXG4gICAgbGF6eUxvYWRNYXhEdXJhdGlvbjogMyAqIDYwLFxuICAgIGxhenlMb2FkUmVjb3ZlckR1cmF0aW9uOiAzMCxcbiAgICBkZWZlckxvYWRBZnRlclNvdXJjZU9wZW46IHRydWUsXG5cbiAgICAvLyBhdXRvQ2xlYW51cFNvdXJjZUJ1ZmZlcjogZGVmYXVsdCBhcyBmYWxzZSwgbGVhdmUgdW5zcGVjaWZpZWRcbiAgICBhdXRvQ2xlYW51cE1heEJhY2t3YXJkRHVyYXRpb246IDMgKiA2MCxcbiAgICBhdXRvQ2xlYW51cE1pbkJhY2t3YXJkRHVyYXRpb246IDIgKiA2MCxcblxuICAgIHN0YXRpc3RpY3NJbmZvUmVwb3J0SW50ZXJ2YWw6IDYwMCxcblxuICAgIGZpeEF1ZGlvVGltZXN0YW1wR2FwOiB0cnVlLFxuXG4gICAgYWNjdXJhdGVTZWVrOiBmYWxzZSxcbiAgICBzZWVrVHlwZTogJ3JhbmdlJywgLy8gW3JhbmdlLCBwYXJhbSwgY3VzdG9tXVxuICAgIHNlZWtQYXJhbVN0YXJ0OiAnYnN0YXJ0JyxcbiAgICBzZWVrUGFyYW1FbmQ6ICdiZW5kJyxcbiAgICByYW5nZUxvYWRaZXJvU3RhcnQ6IGZhbHNlLFxuICAgIGN1c3RvbVNlZWtIYW5kbGVyOiB1bmRlZmluZWQsXG4gICAgcmV1c2VSZWRpcmVjdGVkVVJMOiBmYWxzZSxcbiAgICAvLyByZWZlcnJlclBvbGljeTogbGVhdmUgYXMgdW5zcGVjaWZpZWRcblxuICAgIGhlYWRlcnM6IHVuZGVmaW5lZCxcbiAgICBjdXN0b21Mb2FkZXI6IHVuZGVmaW5lZFxufTtcblxuZnVuY3Rpb24gY3JlYXRlRGVmYXVsdENvbmZpZygpIHtcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdENvbmZpZyk7XG59XG5cbn0se31dLDY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgX2lvQ29udHJvbGxlciA9IF9kZXJlcV8oJy4uL2lvL2lvLWNvbnRyb2xsZXIuanMnKTtcblxudmFyIF9pb0NvbnRyb2xsZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW9Db250cm9sbGVyKTtcblxudmFyIF9jb25maWcgPSBfZGVyZXFfKCcuLi9jb25maWcuanMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIEZlYXR1cmVzID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEZlYXR1cmVzKCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRmVhdHVyZXMpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhGZWF0dXJlcywgbnVsbCwgW3tcbiAgICAgICAga2V5OiAnc3VwcG9ydE1TRUgyNjRQbGF5YmFjaycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdXBwb3J0TVNFSDI2NFBsYXliYWNrKCkge1xuICAgICAgICAgICAgcmV0dXJuIHdpbmRvdy5NZWRpYVNvdXJjZSAmJiB3aW5kb3cuTWVkaWFTb3VyY2UuaXNUeXBlU3VwcG9ydGVkKCd2aWRlby9tcDQ7IGNvZGVjcz1cImF2YzEuNDJFMDFFLG1wNGEuNDAuMlwiJyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3N1cHBvcnROZXR3b3JrU3RyZWFtSU8nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3VwcG9ydE5ldHdvcmtTdHJlYW1JTygpIHtcbiAgICAgICAgICAgIHZhciBpb2N0bCA9IG5ldyBfaW9Db250cm9sbGVyMi5kZWZhdWx0KHt9LCAoMCwgX2NvbmZpZy5jcmVhdGVEZWZhdWx0Q29uZmlnKSgpKTtcbiAgICAgICAgICAgIHZhciBsb2FkZXJUeXBlID0gaW9jdGwubG9hZGVyVHlwZTtcbiAgICAgICAgICAgIGlvY3RsLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIHJldHVybiBsb2FkZXJUeXBlID09ICdmZXRjaC1zdHJlYW0tbG9hZGVyJyB8fCBsb2FkZXJUeXBlID09ICd4aHItbW96LWNodW5rZWQtbG9hZGVyJztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZ2V0TmV0d29ya0xvYWRlclR5cGVOYW1lJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldE5ldHdvcmtMb2FkZXJUeXBlTmFtZSgpIHtcbiAgICAgICAgICAgIHZhciBpb2N0bCA9IG5ldyBfaW9Db250cm9sbGVyMi5kZWZhdWx0KHt9LCAoMCwgX2NvbmZpZy5jcmVhdGVEZWZhdWx0Q29uZmlnKSgpKTtcbiAgICAgICAgICAgIHZhciBsb2FkZXJUeXBlID0gaW9jdGwubG9hZGVyVHlwZTtcbiAgICAgICAgICAgIGlvY3RsLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIHJldHVybiBsb2FkZXJUeXBlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzdXBwb3J0TmF0aXZlTWVkaWFQbGF5YmFjaycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdXBwb3J0TmF0aXZlTWVkaWFQbGF5YmFjayhtaW1lVHlwZSkge1xuICAgICAgICAgICAgaWYgKEZlYXR1cmVzLnZpZGVvRWxlbWVudCA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBGZWF0dXJlcy52aWRlb0VsZW1lbnQgPSB3aW5kb3cuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndmlkZW8nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjYW5QbGF5ID0gRmVhdHVyZXMudmlkZW9FbGVtZW50LmNhblBsYXlUeXBlKG1pbWVUeXBlKTtcbiAgICAgICAgICAgIHJldHVybiBjYW5QbGF5ID09PSAncHJvYmFibHknIHx8IGNhblBsYXkgPT0gJ21heWJlJztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZ2V0RmVhdHVyZUxpc3QnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RmVhdHVyZUxpc3QoKSB7XG4gICAgICAgICAgICB2YXIgZmVhdHVyZXMgPSB7XG4gICAgICAgICAgICAgICAgbXNlRmx2UGxheWJhY2s6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG1zZUxpdmVGbHZQbGF5YmFjazogZmFsc2UsXG4gICAgICAgICAgICAgICAgbmV0d29ya1N0cmVhbUlPOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBuZXR3b3JrTG9hZGVyTmFtZTogJycsXG4gICAgICAgICAgICAgICAgbmF0aXZlTVA0SDI2NFBsYXliYWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBuYXRpdmVXZWJtVlA4UGxheWJhY2s6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG5hdGl2ZVdlYm1WUDlQbGF5YmFjazogZmFsc2VcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZlYXR1cmVzLm1zZUZsdlBsYXliYWNrID0gRmVhdHVyZXMuc3VwcG9ydE1TRUgyNjRQbGF5YmFjaygpO1xuICAgICAgICAgICAgZmVhdHVyZXMubmV0d29ya1N0cmVhbUlPID0gRmVhdHVyZXMuc3VwcG9ydE5ldHdvcmtTdHJlYW1JTygpO1xuICAgICAgICAgICAgZmVhdHVyZXMubmV0d29ya0xvYWRlck5hbWUgPSBGZWF0dXJlcy5nZXROZXR3b3JrTG9hZGVyVHlwZU5hbWUoKTtcbiAgICAgICAgICAgIGZlYXR1cmVzLm1zZUxpdmVGbHZQbGF5YmFjayA9IGZlYXR1cmVzLm1zZUZsdlBsYXliYWNrICYmIGZlYXR1cmVzLm5ldHdvcmtTdHJlYW1JTztcbiAgICAgICAgICAgIGZlYXR1cmVzLm5hdGl2ZU1QNEgyNjRQbGF5YmFjayA9IEZlYXR1cmVzLnN1cHBvcnROYXRpdmVNZWRpYVBsYXliYWNrKCd2aWRlby9tcDQ7IGNvZGVjcz1cImF2YzEuNDIwMDFFLCBtcDRhLjQwLjJcIicpO1xuICAgICAgICAgICAgZmVhdHVyZXMubmF0aXZlV2VibVZQOFBsYXliYWNrID0gRmVhdHVyZXMuc3VwcG9ydE5hdGl2ZU1lZGlhUGxheWJhY2soJ3ZpZGVvL3dlYm07IGNvZGVjcz1cInZwOC4wLCB2b3JiaXNcIicpO1xuICAgICAgICAgICAgZmVhdHVyZXMubmF0aXZlV2VibVZQOVBsYXliYWNrID0gRmVhdHVyZXMuc3VwcG9ydE5hdGl2ZU1lZGlhUGxheWJhY2soJ3ZpZGVvL3dlYm07IGNvZGVjcz1cInZwOVwiJyk7XG5cbiAgICAgICAgICAgIHJldHVybiBmZWF0dXJlcztcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBGZWF0dXJlcztcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gRmVhdHVyZXM7XG5cbn0se1wiLi4vY29uZmlnLmpzXCI6NSxcIi4uL2lvL2lvLWNvbnRyb2xsZXIuanNcIjoyM31dLDc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxudmFyIE1lZGlhSW5mbyA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBNZWRpYUluZm8oKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNZWRpYUluZm8pO1xuXG4gICAgICAgIHRoaXMubWltZVR5cGUgPSBudWxsO1xuICAgICAgICB0aGlzLmR1cmF0aW9uID0gbnVsbDtcblxuICAgICAgICB0aGlzLmhhc0F1ZGlvID0gbnVsbDtcbiAgICAgICAgdGhpcy5oYXNWaWRlbyA9IG51bGw7XG4gICAgICAgIHRoaXMuYXVkaW9Db2RlYyA9IG51bGw7XG4gICAgICAgIHRoaXMudmlkZW9Db2RlYyA9IG51bGw7XG4gICAgICAgIHRoaXMuYXVkaW9EYXRhUmF0ZSA9IG51bGw7XG4gICAgICAgIHRoaXMudmlkZW9EYXRhUmF0ZSA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5hdWRpb1NhbXBsZVJhdGUgPSBudWxsO1xuICAgICAgICB0aGlzLmF1ZGlvQ2hhbm5lbENvdW50ID0gbnVsbDtcblxuICAgICAgICB0aGlzLndpZHRoID0gbnVsbDtcbiAgICAgICAgdGhpcy5oZWlnaHQgPSBudWxsO1xuICAgICAgICB0aGlzLmZwcyA9IG51bGw7XG4gICAgICAgIHRoaXMucHJvZmlsZSA9IG51bGw7XG4gICAgICAgIHRoaXMubGV2ZWwgPSBudWxsO1xuICAgICAgICB0aGlzLnJlZkZyYW1lcyA9IG51bGw7XG4gICAgICAgIHRoaXMuY2hyb21hRm9ybWF0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5zYXJOdW0gPSBudWxsO1xuICAgICAgICB0aGlzLnNhckRlbiA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5tZXRhZGF0YSA9IG51bGw7XG4gICAgICAgIHRoaXMuc2VnbWVudHMgPSBudWxsOyAvLyBNZWRpYUluZm9bXVxuICAgICAgICB0aGlzLnNlZ21lbnRDb3VudCA9IG51bGw7XG4gICAgICAgIHRoaXMuaGFzS2V5ZnJhbWVzSW5kZXggPSBudWxsO1xuICAgICAgICB0aGlzLmtleWZyYW1lc0luZGV4ID0gbnVsbDtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoTWVkaWFJbmZvLCBbe1xuICAgICAgICBrZXk6IFwiaXNDb21wbGV0ZVwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaXNDb21wbGV0ZSgpIHtcbiAgICAgICAgICAgIHZhciBhdWRpb0luZm9Db21wbGV0ZSA9IHRoaXMuaGFzQXVkaW8gPT09IGZhbHNlIHx8IHRoaXMuaGFzQXVkaW8gPT09IHRydWUgJiYgdGhpcy5hdWRpb0NvZGVjICE9IG51bGwgJiYgdGhpcy5hdWRpb1NhbXBsZVJhdGUgIT0gbnVsbCAmJiB0aGlzLmF1ZGlvQ2hhbm5lbENvdW50ICE9IG51bGw7XG5cbiAgICAgICAgICAgIHZhciB2aWRlb0luZm9Db21wbGV0ZSA9IHRoaXMuaGFzVmlkZW8gPT09IGZhbHNlIHx8IHRoaXMuaGFzVmlkZW8gPT09IHRydWUgJiYgdGhpcy52aWRlb0NvZGVjICE9IG51bGwgJiYgdGhpcy53aWR0aCAhPSBudWxsICYmIHRoaXMuaGVpZ2h0ICE9IG51bGwgJiYgdGhpcy5mcHMgIT0gbnVsbCAmJiB0aGlzLnByb2ZpbGUgIT0gbnVsbCAmJiB0aGlzLmxldmVsICE9IG51bGwgJiYgdGhpcy5yZWZGcmFtZXMgIT0gbnVsbCAmJiB0aGlzLmNocm9tYUZvcm1hdCAhPSBudWxsICYmIHRoaXMuc2FyTnVtICE9IG51bGwgJiYgdGhpcy5zYXJEZW4gIT0gbnVsbDtcblxuICAgICAgICAgICAgLy8ga2V5ZnJhbWVzSW5kZXggbWF5IG5vdCBiZSBwcmVzZW50XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5taW1lVHlwZSAhPSBudWxsICYmIHRoaXMuZHVyYXRpb24gIT0gbnVsbCAmJiB0aGlzLm1ldGFkYXRhICE9IG51bGwgJiYgdGhpcy5oYXNLZXlmcmFtZXNJbmRleCAhPSBudWxsICYmIGF1ZGlvSW5mb0NvbXBsZXRlICYmIHZpZGVvSW5mb0NvbXBsZXRlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiaXNTZWVrYWJsZVwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaXNTZWVrYWJsZSgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmhhc0tleWZyYW1lc0luZGV4ID09PSB0cnVlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiZ2V0TmVhcmVzdEtleWZyYW1lXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROZWFyZXN0S2V5ZnJhbWUobWlsbGlzZWNvbmRzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5rZXlmcmFtZXNJbmRleCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciB0YWJsZSA9IHRoaXMua2V5ZnJhbWVzSW5kZXg7XG4gICAgICAgICAgICB2YXIga2V5ZnJhbWVJZHggPSB0aGlzLl9zZWFyY2godGFibGUudGltZXMsIG1pbGxpc2Vjb25kcyk7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaW5kZXg6IGtleWZyYW1lSWR4LFxuICAgICAgICAgICAgICAgIG1pbGxpc2Vjb25kczogdGFibGUudGltZXNba2V5ZnJhbWVJZHhdLFxuICAgICAgICAgICAgICAgIGZpbGVwb3NpdGlvbjogdGFibGUuZmlsZXBvc2l0aW9uc1trZXlmcmFtZUlkeF1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJfc2VhcmNoXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfc2VhcmNoKGxpc3QsIHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgaWR4ID0gMDtcblxuICAgICAgICAgICAgdmFyIGxhc3QgPSBsaXN0Lmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB2YXIgbWlkID0gMDtcbiAgICAgICAgICAgIHZhciBsYm91bmQgPSAwO1xuICAgICAgICAgICAgdmFyIHVib3VuZCA9IGxhc3Q7XG5cbiAgICAgICAgICAgIGlmICh2YWx1ZSA8IGxpc3RbMF0pIHtcbiAgICAgICAgICAgICAgICBpZHggPSAwO1xuICAgICAgICAgICAgICAgIGxib3VuZCA9IHVib3VuZCArIDE7IC8vIHNraXAgc2VhcmNoXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHdoaWxlIChsYm91bmQgPD0gdWJvdW5kKSB7XG4gICAgICAgICAgICAgICAgbWlkID0gbGJvdW5kICsgTWF0aC5mbG9vcigodWJvdW5kIC0gbGJvdW5kKSAvIDIpO1xuICAgICAgICAgICAgICAgIGlmIChtaWQgPT09IGxhc3QgfHwgdmFsdWUgPj0gbGlzdFttaWRdICYmIHZhbHVlIDwgbGlzdFttaWQgKyAxXSkge1xuICAgICAgICAgICAgICAgICAgICBpZHggPSBtaWQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGlzdFttaWRdIDwgdmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgbGJvdW5kID0gbWlkICsgMTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB1Ym91bmQgPSBtaWQgLSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGlkeDtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBNZWRpYUluZm87XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IE1lZGlhSW5mbztcblxufSx7fV0sODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG4vLyBSZXByZXNlbnRzIGFuIG1lZGlhIHNhbXBsZSAoYXVkaW8gLyB2aWRlbylcbnZhciBTYW1wbGVJbmZvID0gZXhwb3J0cy5TYW1wbGVJbmZvID0gZnVuY3Rpb24gU2FtcGxlSW5mbyhkdHMsIHB0cywgZHVyYXRpb24sIG9yaWdpbmFsRHRzLCBpc1N5bmMpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU2FtcGxlSW5mbyk7XG5cbiAgICB0aGlzLmR0cyA9IGR0cztcbiAgICB0aGlzLnB0cyA9IHB0cztcbiAgICB0aGlzLmR1cmF0aW9uID0gZHVyYXRpb247XG4gICAgdGhpcy5vcmlnaW5hbER0cyA9IG9yaWdpbmFsRHRzO1xuICAgIHRoaXMuaXNTeW5jUG9pbnQgPSBpc1N5bmM7XG4gICAgdGhpcy5maWxlcG9zaXRpb24gPSBudWxsO1xufTtcblxuLy8gTWVkaWEgU2VnbWVudCBjb25jZXB0IGlzIGRlZmluZWQgaW4gTWVkaWEgU291cmNlIEV4dGVuc2lvbnMgc3BlYy5cbi8vIFBhcnRpY3VsYXJseSBpbiBJU08gQk1GRiBmb3JtYXQsIGFuIE1lZGlhIFNlZ21lbnQgY29udGFpbnMgYSBtb29mIGJveCBmb2xsb3dlZCBieSBhIG1kYXQgYm94LlxuXG5cbnZhciBNZWRpYVNlZ21lbnRJbmZvID0gZXhwb3J0cy5NZWRpYVNlZ21lbnRJbmZvID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1lZGlhU2VnbWVudEluZm8oKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNZWRpYVNlZ21lbnRJbmZvKTtcblxuICAgICAgICB0aGlzLmJlZ2luRHRzID0gMDtcbiAgICAgICAgdGhpcy5lbmREdHMgPSAwO1xuICAgICAgICB0aGlzLmJlZ2luUHRzID0gMDtcbiAgICAgICAgdGhpcy5lbmRQdHMgPSAwO1xuICAgICAgICB0aGlzLm9yaWdpbmFsQmVnaW5EdHMgPSAwO1xuICAgICAgICB0aGlzLm9yaWdpbmFsRW5kRHRzID0gMDtcbiAgICAgICAgdGhpcy5zeW5jUG9pbnRzID0gW107IC8vIFNhbXBsZUluZm9bbl0sIGZvciB2aWRlbyBJRFIgZnJhbWVzIG9ubHlcbiAgICAgICAgdGhpcy5maXJzdFNhbXBsZSA9IG51bGw7IC8vIFNhbXBsZUluZm9cbiAgICAgICAgdGhpcy5sYXN0U2FtcGxlID0gbnVsbDsgLy8gU2FtcGxlSW5mb1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhNZWRpYVNlZ21lbnRJbmZvLCBbe1xuICAgICAgICBrZXk6IFwiYXBwZW5kU3luY1BvaW50XCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBlbmRTeW5jUG9pbnQoc2FtcGxlSW5mbykge1xuICAgICAgICAgICAgLy8gYWxzbyBjYWxsZWQgUmFuZG9tIEFjY2VzcyBQb2ludFxuICAgICAgICAgICAgc2FtcGxlSW5mby5pc1N5bmNQb2ludCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnN5bmNQb2ludHMucHVzaChzYW1wbGVJbmZvKTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBNZWRpYVNlZ21lbnRJbmZvO1xufSgpO1xuXG4vLyBPcmRlcmVkIGxpc3QgZm9yIHJlY29yZGluZyB2aWRlbyBJRFIgZnJhbWVzLCBzb3J0ZWQgYnkgb3JpZ2luYWxEdHNcblxuXG52YXIgSURSU2FtcGxlTGlzdCA9IGV4cG9ydHMuSURSU2FtcGxlTGlzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBJRFJTYW1wbGVMaXN0KCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSURSU2FtcGxlTGlzdCk7XG5cbiAgICAgICAgdGhpcy5fbGlzdCA9IFtdO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhJRFJTYW1wbGVMaXN0LCBbe1xuICAgICAgICBrZXk6IFwiY2xlYXJcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsZWFyKCkge1xuICAgICAgICAgICAgdGhpcy5fbGlzdCA9IFtdO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiYXBwZW5kQXJyYXlcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGVuZEFycmF5KHN5bmNQb2ludHMpIHtcbiAgICAgICAgICAgIHZhciBsaXN0ID0gdGhpcy5fbGlzdDtcblxuICAgICAgICAgICAgaWYgKHN5bmNQb2ludHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobGlzdC5sZW5ndGggPiAwICYmIHN5bmNQb2ludHNbMF0ub3JpZ2luYWxEdHMgPCBsaXN0W2xpc3QubGVuZ3RoIC0gMV0ub3JpZ2luYWxEdHMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsZWFyKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5wdXNoLmFwcGx5KGxpc3QsIHN5bmNQb2ludHMpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiZ2V0TGFzdFN5bmNQb2ludEJlZm9yZUR0c1wiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TGFzdFN5bmNQb2ludEJlZm9yZUR0cyhkdHMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9saXN0Lmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBsaXN0ID0gdGhpcy5fbGlzdDtcbiAgICAgICAgICAgIHZhciBpZHggPSAwO1xuICAgICAgICAgICAgdmFyIGxhc3QgPSBsaXN0Lmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB2YXIgbWlkID0gMDtcbiAgICAgICAgICAgIHZhciBsYm91bmQgPSAwO1xuICAgICAgICAgICAgdmFyIHVib3VuZCA9IGxhc3Q7XG5cbiAgICAgICAgICAgIGlmIChkdHMgPCBsaXN0WzBdLmR0cykge1xuICAgICAgICAgICAgICAgIGlkeCA9IDA7XG4gICAgICAgICAgICAgICAgbGJvdW5kID0gdWJvdW5kICsgMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgd2hpbGUgKGxib3VuZCA8PSB1Ym91bmQpIHtcbiAgICAgICAgICAgICAgICBtaWQgPSBsYm91bmQgKyBNYXRoLmZsb29yKCh1Ym91bmQgLSBsYm91bmQpIC8gMik7XG4gICAgICAgICAgICAgICAgaWYgKG1pZCA9PT0gbGFzdCB8fCBkdHMgPj0gbGlzdFttaWRdLmR0cyAmJiBkdHMgPCBsaXN0W21pZCArIDFdLmR0cykge1xuICAgICAgICAgICAgICAgICAgICBpZHggPSBtaWQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGlzdFttaWRdLmR0cyA8IGR0cykge1xuICAgICAgICAgICAgICAgICAgICBsYm91bmQgPSBtaWQgKyAxO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHVib3VuZCA9IG1pZCAtIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xpc3RbaWR4XTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBJRFJTYW1wbGVMaXN0O1xufSgpO1xuXG4vLyBEYXRhIHN0cnVjdHVyZSBmb3IgcmVjb3JkaW5nIGluZm9ybWF0aW9uIG9mIG1lZGlhIHNlZ21lbnRzIGluIHNpbmdsZSB0cmFjay5cblxuXG52YXIgTWVkaWFTZWdtZW50SW5mb0xpc3QgPSBleHBvcnRzLk1lZGlhU2VnbWVudEluZm9MaXN0ID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1lZGlhU2VnbWVudEluZm9MaXN0KHR5cGUpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1lZGlhU2VnbWVudEluZm9MaXN0KTtcblxuICAgICAgICB0aGlzLl90eXBlID0gdHlwZTtcbiAgICAgICAgdGhpcy5fbGlzdCA9IFtdO1xuICAgICAgICB0aGlzLl9sYXN0QXBwZW5kTG9jYXRpb24gPSAtMTsgLy8gY2FjaGVkIGxhc3QgaW5zZXJ0IGxvY2F0aW9uXG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKE1lZGlhU2VnbWVudEluZm9MaXN0LCBbe1xuICAgICAgICBrZXk6IFwiaXNFbXB0eVwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaXNFbXB0eSgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9saXN0Lmxlbmd0aCA9PT0gMDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImNsZWFyXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhcigpIHtcbiAgICAgICAgICAgIHRoaXMuX2xpc3QgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuX2xhc3RBcHBlbmRMb2NhdGlvbiA9IC0xO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiX3NlYXJjaE5lYXJlc3RTZWdtZW50QmVmb3JlXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfc2VhcmNoTmVhcmVzdFNlZ21lbnRCZWZvcmUob3JpZ2luYWxCZWdpbkR0cykge1xuICAgICAgICAgICAgdmFyIGxpc3QgPSB0aGlzLl9saXN0O1xuICAgICAgICAgICAgaWYgKGxpc3QubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC0yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGxhc3QgPSBsaXN0Lmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB2YXIgbWlkID0gMDtcbiAgICAgICAgICAgIHZhciBsYm91bmQgPSAwO1xuICAgICAgICAgICAgdmFyIHVib3VuZCA9IGxhc3Q7XG5cbiAgICAgICAgICAgIHZhciBpZHggPSAwO1xuXG4gICAgICAgICAgICBpZiAob3JpZ2luYWxCZWdpbkR0cyA8IGxpc3RbMF0ub3JpZ2luYWxCZWdpbkR0cykge1xuICAgICAgICAgICAgICAgIGlkeCA9IC0xO1xuICAgICAgICAgICAgICAgIHJldHVybiBpZHg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHdoaWxlIChsYm91bmQgPD0gdWJvdW5kKSB7XG4gICAgICAgICAgICAgICAgbWlkID0gbGJvdW5kICsgTWF0aC5mbG9vcigodWJvdW5kIC0gbGJvdW5kKSAvIDIpO1xuICAgICAgICAgICAgICAgIGlmIChtaWQgPT09IGxhc3QgfHwgb3JpZ2luYWxCZWdpbkR0cyA+IGxpc3RbbWlkXS5sYXN0U2FtcGxlLm9yaWdpbmFsRHRzICYmIG9yaWdpbmFsQmVnaW5EdHMgPCBsaXN0W21pZCArIDFdLm9yaWdpbmFsQmVnaW5EdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWR4ID0gbWlkO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpc3RbbWlkXS5vcmlnaW5hbEJlZ2luRHRzIDwgb3JpZ2luYWxCZWdpbkR0cykge1xuICAgICAgICAgICAgICAgICAgICBsYm91bmQgPSBtaWQgKyAxO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHVib3VuZCA9IG1pZCAtIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGlkeDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcIl9zZWFyY2hOZWFyZXN0U2VnbWVudEFmdGVyXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfc2VhcmNoTmVhcmVzdFNlZ21lbnRBZnRlcihvcmlnaW5hbEJlZ2luRHRzKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc2VhcmNoTmVhcmVzdFNlZ21lbnRCZWZvcmUob3JpZ2luYWxCZWdpbkR0cykgKyAxO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiYXBwZW5kXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBlbmQobWVkaWFTZWdtZW50SW5mbykge1xuICAgICAgICAgICAgdmFyIGxpc3QgPSB0aGlzLl9saXN0O1xuICAgICAgICAgICAgdmFyIG1zaSA9IG1lZGlhU2VnbWVudEluZm87XG4gICAgICAgICAgICB2YXIgbGFzdEFwcGVuZElkeCA9IHRoaXMuX2xhc3RBcHBlbmRMb2NhdGlvbjtcbiAgICAgICAgICAgIHZhciBpbnNlcnRJZHggPSAwO1xuXG4gICAgICAgICAgICBpZiAobGFzdEFwcGVuZElkeCAhPT0gLTEgJiYgbGFzdEFwcGVuZElkeCA8IGxpc3QubGVuZ3RoICYmIG1zaS5vcmlnaW5hbEJlZ2luRHRzID49IGxpc3RbbGFzdEFwcGVuZElkeF0ubGFzdFNhbXBsZS5vcmlnaW5hbER0cyAmJiAobGFzdEFwcGVuZElkeCA9PT0gbGlzdC5sZW5ndGggLSAxIHx8IGxhc3RBcHBlbmRJZHggPCBsaXN0Lmxlbmd0aCAtIDEgJiYgbXNpLm9yaWdpbmFsQmVnaW5EdHMgPCBsaXN0W2xhc3RBcHBlbmRJZHggKyAxXS5vcmlnaW5hbEJlZ2luRHRzKSkge1xuICAgICAgICAgICAgICAgIGluc2VydElkeCA9IGxhc3RBcHBlbmRJZHggKyAxOyAvLyB1c2UgY2FjaGVkIGxvY2F0aW9uIGlkeFxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAobGlzdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGluc2VydElkeCA9IHRoaXMuX3NlYXJjaE5lYXJlc3RTZWdtZW50QmVmb3JlKG1zaS5vcmlnaW5hbEJlZ2luRHRzKSArIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9sYXN0QXBwZW5kTG9jYXRpb24gPSBpbnNlcnRJZHg7XG4gICAgICAgICAgICB0aGlzLl9saXN0LnNwbGljZShpbnNlcnRJZHgsIDAsIG1zaSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJnZXRMYXN0U2VnbWVudEJlZm9yZVwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TGFzdFNlZ21lbnRCZWZvcmUob3JpZ2luYWxCZWdpbkR0cykge1xuICAgICAgICAgICAgdmFyIGlkeCA9IHRoaXMuX3NlYXJjaE5lYXJlc3RTZWdtZW50QmVmb3JlKG9yaWdpbmFsQmVnaW5EdHMpO1xuICAgICAgICAgICAgaWYgKGlkeCA+PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xpc3RbaWR4XTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gLTFcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImdldExhc3RTYW1wbGVCZWZvcmVcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldExhc3RTYW1wbGVCZWZvcmUob3JpZ2luYWxCZWdpbkR0cykge1xuICAgICAgICAgICAgdmFyIHNlZ21lbnQgPSB0aGlzLmdldExhc3RTZWdtZW50QmVmb3JlKG9yaWdpbmFsQmVnaW5EdHMpO1xuICAgICAgICAgICAgaWYgKHNlZ21lbnQgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzZWdtZW50Lmxhc3RTYW1wbGU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiZ2V0TGFzdFN5bmNQb2ludEJlZm9yZVwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TGFzdFN5bmNQb2ludEJlZm9yZShvcmlnaW5hbEJlZ2luRHRzKSB7XG4gICAgICAgICAgICB2YXIgc2VnbWVudElkeCA9IHRoaXMuX3NlYXJjaE5lYXJlc3RTZWdtZW50QmVmb3JlKG9yaWdpbmFsQmVnaW5EdHMpO1xuICAgICAgICAgICAgdmFyIHN5bmNQb2ludHMgPSB0aGlzLl9saXN0W3NlZ21lbnRJZHhdLnN5bmNQb2ludHM7XG4gICAgICAgICAgICB3aGlsZSAoc3luY1BvaW50cy5sZW5ndGggPT09IDAgJiYgc2VnbWVudElkeCA+IDApIHtcbiAgICAgICAgICAgICAgICBzZWdtZW50SWR4LS07XG4gICAgICAgICAgICAgICAgc3luY1BvaW50cyA9IHRoaXMuX2xpc3Rbc2VnbWVudElkeF0uc3luY1BvaW50cztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzeW5jUG9pbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3luY1BvaW50c1tzeW5jUG9pbnRzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcInR5cGVcIixcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdHlwZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImxlbmd0aFwiLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9saXN0Lmxlbmd0aDtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBNZWRpYVNlZ21lbnRJbmZvTGlzdDtcbn0oKTtcblxufSx7fV0sOTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfZXZlbnRzID0gX2RlcmVxXygnZXZlbnRzJyk7XG5cbnZhciBfZXZlbnRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V2ZW50cyk7XG5cbnZhciBfbG9nZ2VyID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nZ2VyLmpzJyk7XG5cbnZhciBfbG9nZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dlcik7XG5cbnZhciBfYnJvd3NlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2Jyb3dzZXIuanMnKTtcblxudmFyIF9icm93c2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2Jyb3dzZXIpO1xuXG52YXIgX21zZUV2ZW50cyA9IF9kZXJlcV8oJy4vbXNlLWV2ZW50cy5qcycpO1xuXG52YXIgX21zZUV2ZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tc2VFdmVudHMpO1xuXG52YXIgX21lZGlhU2VnbWVudEluZm8gPSBfZGVyZXFfKCcuL21lZGlhLXNlZ21lbnQtaW5mby5qcycpO1xuXG52YXIgX2V4Y2VwdGlvbiA9IF9kZXJlcV8oJy4uL3V0aWxzL2V4Y2VwdGlvbi5qcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vLyBNZWRpYSBTb3VyY2UgRXh0ZW5zaW9ucyBjb250cm9sbGVyXG52YXIgTVNFQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBNU0VDb250cm9sbGVyKGNvbmZpZykge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTVNFQ29udHJvbGxlcik7XG5cbiAgICAgICAgdGhpcy5UQUcgPSAnTVNFQ29udHJvbGxlcic7XG5cbiAgICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgICAgICB0aGlzLl9lbWl0dGVyID0gbmV3IF9ldmVudHMyLmRlZmF1bHQoKTtcblxuICAgICAgICBpZiAodGhpcy5fY29uZmlnLmlzTGl2ZSAmJiB0aGlzLl9jb25maWcuYXV0b0NsZWFudXBTb3VyY2VCdWZmZXIgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAvLyBGb3IgbGl2ZSBzdHJlYW0sIGRvIGF1dG8gY2xlYW51cCBieSBkZWZhdWx0XG4gICAgICAgICAgICB0aGlzLl9jb25maWcuYXV0b0NsZWFudXBTb3VyY2VCdWZmZXIgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5lID0ge1xuICAgICAgICAgICAgb25Tb3VyY2VPcGVuOiB0aGlzLl9vblNvdXJjZU9wZW4uYmluZCh0aGlzKSxcbiAgICAgICAgICAgIG9uU291cmNlRW5kZWQ6IHRoaXMuX29uU291cmNlRW5kZWQuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIG9uU291cmNlQ2xvc2U6IHRoaXMuX29uU291cmNlQ2xvc2UuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIG9uU291cmNlQnVmZmVyRXJyb3I6IHRoaXMuX29uU291cmNlQnVmZmVyRXJyb3IuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIG9uU291cmNlQnVmZmVyVXBkYXRlRW5kOiB0aGlzLl9vblNvdXJjZUJ1ZmZlclVwZGF0ZUVuZC5iaW5kKHRoaXMpXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5fbWVkaWFTb3VyY2UgPSBudWxsO1xuICAgICAgICB0aGlzLl9tZWRpYVNvdXJjZU9iamVjdFVSTCA9IG51bGw7XG4gICAgICAgIHRoaXMuX21lZGlhRWxlbWVudCA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5faXNCdWZmZXJGdWxsID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2hhc1BlbmRpbmdFb3MgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLl9yZXF1aXJlU2V0TWVkaWFEdXJhdGlvbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9wZW5kaW5nTWVkaWFEdXJhdGlvbiA9IDA7XG5cbiAgICAgICAgdGhpcy5fcGVuZGluZ1NvdXJjZUJ1ZmZlckluaXQgPSBbXTtcbiAgICAgICAgdGhpcy5fbWltZVR5cGVzID0ge1xuICAgICAgICAgICAgdmlkZW86IG51bGwsXG4gICAgICAgICAgICBhdWRpbzogbnVsbFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9zb3VyY2VCdWZmZXJzID0ge1xuICAgICAgICAgICAgdmlkZW86IG51bGwsXG4gICAgICAgICAgICBhdWRpbzogbnVsbFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9sYXN0SW5pdFNlZ21lbnRzID0ge1xuICAgICAgICAgICAgdmlkZW86IG51bGwsXG4gICAgICAgICAgICBhdWRpbzogbnVsbFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9wZW5kaW5nU2VnbWVudHMgPSB7XG4gICAgICAgICAgICB2aWRlbzogW10sXG4gICAgICAgICAgICBhdWRpbzogW11cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5fcGVuZGluZ1JlbW92ZVJhbmdlcyA9IHtcbiAgICAgICAgICAgIHZpZGVvOiBbXSxcbiAgICAgICAgICAgIGF1ZGlvOiBbXVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9pZHJMaXN0ID0gbmV3IF9tZWRpYVNlZ21lbnRJbmZvLklEUlNhbXBsZUxpc3QoKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoTVNFQ29udHJvbGxlciwgW3tcbiAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudCB8fCB0aGlzLl9tZWRpYVNvdXJjZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGV0YWNoTWVkaWFFbGVtZW50KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmUgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIgPSBudWxsO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbihldmVudCwgbGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuYWRkTGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb2ZmJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9mZihldmVudCwgbGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIucmVtb3ZlTGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYXR0YWNoTWVkaWFFbGVtZW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGF0dGFjaE1lZGlhRWxlbWVudChtZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYVNvdXJjZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbignTWVkaWFTb3VyY2UgaGFzIGJlZW4gYXR0YWNoZWQgdG8gYW4gSFRNTE1lZGlhRWxlbWVudCEnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBtcyA9IHRoaXMuX21lZGlhU291cmNlID0gbmV3IHdpbmRvdy5NZWRpYVNvdXJjZSgpO1xuICAgICAgICAgICAgbXMuYWRkRXZlbnRMaXN0ZW5lcignc291cmNlb3BlbicsIHRoaXMuZS5vblNvdXJjZU9wZW4pO1xuICAgICAgICAgICAgbXMuYWRkRXZlbnRMaXN0ZW5lcignc291cmNlZW5kZWQnLCB0aGlzLmUub25Tb3VyY2VFbmRlZCk7XG4gICAgICAgICAgICBtcy5hZGRFdmVudExpc3RlbmVyKCdzb3VyY2VjbG9zZScsIHRoaXMuZS5vblNvdXJjZUNsb3NlKTtcblxuICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50ID0gbWVkaWFFbGVtZW50O1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFTb3VyY2VPYmplY3RVUkwgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTCh0aGlzLl9tZWRpYVNvdXJjZSk7XG4gICAgICAgICAgICBtZWRpYUVsZW1lbnQuc3JjID0gdGhpcy5fbWVkaWFTb3VyY2VPYmplY3RVUkw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2RldGFjaE1lZGlhRWxlbWVudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXRhY2hNZWRpYUVsZW1lbnQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFTb3VyY2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgbXMgPSB0aGlzLl9tZWRpYVNvdXJjZTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciB0eXBlIGluIHRoaXMuX3NvdXJjZUJ1ZmZlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gcGVuZGluZyBzZWdtZW50cyBzaG91bGQgYmUgZGlzY2FyZFxuICAgICAgICAgICAgICAgICAgICB2YXIgcHMgPSB0aGlzLl9wZW5kaW5nU2VnbWVudHNbdHlwZV07XG4gICAgICAgICAgICAgICAgICAgIHBzLnNwbGljZSgwLCBwcy5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nU2VnbWVudHNbdHlwZV0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nUmVtb3ZlUmFuZ2VzW3R5cGVdID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbGFzdEluaXRTZWdtZW50c1t0eXBlXSA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGFsbCBzb3VyY2VidWZmZXJzXG4gICAgICAgICAgICAgICAgICAgIHZhciBzYiA9IHRoaXMuX3NvdXJjZUJ1ZmZlcnNbdHlwZV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChzYikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1zLnJlYWR5U3RhdGUgIT09ICdjbG9zZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbXMgZWRnZSBjYW4gdGhyb3cgYW4gZXJyb3I6IFVuZXhwZWN0ZWQgY2FsbCB0byBtZXRob2Qgb3IgcHJvcGVydHkgYWNjZXNzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbXMucmVtb3ZlU291cmNlQnVmZmVyKHNiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmUodGhpcy5UQUcsIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYi5yZW1vdmVFdmVudExpc3RlbmVyKCdlcnJvcicsIHRoaXMuZS5vblNvdXJjZUJ1ZmZlckVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYi5yZW1vdmVFdmVudExpc3RlbmVyKCd1cGRhdGVlbmQnLCB0aGlzLmUub25Tb3VyY2VCdWZmZXJVcGRhdGVFbmQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWltZVR5cGVzW3R5cGVdID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NvdXJjZUJ1ZmZlcnNbdHlwZV0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChtcy5yZWFkeVN0YXRlID09PSAnb3BlbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1zLmVuZE9mU3RyZWFtKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmUodGhpcy5UQUcsIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG1zLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3NvdXJjZW9wZW4nLCB0aGlzLmUub25Tb3VyY2VPcGVuKTtcbiAgICAgICAgICAgICAgICBtcy5yZW1vdmVFdmVudExpc3RlbmVyKCdzb3VyY2VlbmRlZCcsIHRoaXMuZS5vblNvdXJjZUVuZGVkKTtcbiAgICAgICAgICAgICAgICBtcy5yZW1vdmVFdmVudExpc3RlbmVyKCdzb3VyY2VjbG9zZScsIHRoaXMuZS5vblNvdXJjZUNsb3NlKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nU291cmNlQnVmZmVySW5pdCA9IFtdO1xuICAgICAgICAgICAgICAgIHRoaXMuX2lzQnVmZmVyRnVsbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2lkckxpc3QuY2xlYXIoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYVNvdXJjZSA9IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuc3JjID0gJyc7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnc3JjJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYVNvdXJjZU9iamVjdFVSTCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5VUkwucmV2b2tlT2JqZWN0VVJMKHRoaXMuX21lZGlhU291cmNlT2JqZWN0VVJMKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYVNvdXJjZU9iamVjdFVSTCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2FwcGVuZEluaXRTZWdtZW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGVuZEluaXRTZWdtZW50KGluaXRTZWdtZW50LCBkZWZlcnJlZCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9tZWRpYVNvdXJjZSB8fCB0aGlzLl9tZWRpYVNvdXJjZS5yZWFkeVN0YXRlICE9PSAnb3BlbicpIHtcbiAgICAgICAgICAgICAgICAvLyBzb3VyY2VidWZmZXIgY3JlYXRpb24gcmVxdWlyZXMgbWVkaWFTb3VyY2UucmVhZHlTdGF0ZSA9PT0gJ29wZW4nXG4gICAgICAgICAgICAgICAgLy8gc28gd2UgZGVmZXIgdGhlIHNvdXJjZWJ1ZmZlciBjcmVhdGlvbiwgdW50aWwgc291cmNlb3BlbiBldmVudCB0cmlnZ2VyZWRcbiAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nU291cmNlQnVmZmVySW5pdC5wdXNoKGluaXRTZWdtZW50KTtcbiAgICAgICAgICAgICAgICAvLyBtYWtlIHN1cmUgdGhhdCB0aGlzIEluaXRTZWdtZW50IGlzIGluIHRoZSBmcm9udCBvZiBwZW5kaW5nIHNlZ21lbnRzIHF1ZXVlXG4gICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1NlZ21lbnRzW2luaXRTZWdtZW50LnR5cGVdLnB1c2goaW5pdFNlZ21lbnQpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGlzID0gaW5pdFNlZ21lbnQ7XG4gICAgICAgICAgICB2YXIgbWltZVR5cGUgPSAnJyArIGlzLmNvbnRhaW5lcjtcbiAgICAgICAgICAgIGlmIChpcy5jb2RlYyAmJiBpcy5jb2RlYy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgbWltZVR5cGUgKz0gJztjb2RlY3M9JyArIGlzLmNvZGVjO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZmlyc3RJbml0U2VnbWVudCA9IGZhbHNlO1xuXG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYodGhpcy5UQUcsICdSZWNlaXZlZCBJbml0aWFsaXphdGlvbiBTZWdtZW50LCBtaW1lVHlwZTogJyArIG1pbWVUeXBlKTtcbiAgICAgICAgICAgIHRoaXMuX2xhc3RJbml0U2VnbWVudHNbaXMudHlwZV0gPSBpcztcblxuICAgICAgICAgICAgaWYgKG1pbWVUeXBlICE9PSB0aGlzLl9taW1lVHlwZXNbaXMudHlwZV0pIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX21pbWVUeXBlc1tpcy50eXBlXSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBlbXB0eSwgZmlyc3QgY2hhbmNlIGNyZWF0ZSBzb3VyY2VidWZmZXJcbiAgICAgICAgICAgICAgICAgICAgZmlyc3RJbml0U2VnbWVudCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2IgPSB0aGlzLl9zb3VyY2VCdWZmZXJzW2lzLnR5cGVdID0gdGhpcy5fbWVkaWFTb3VyY2UuYWRkU291cmNlQnVmZmVyKG1pbWVUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNiLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgdGhpcy5lLm9uU291cmNlQnVmZmVyRXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2IuYWRkRXZlbnRMaXN0ZW5lcigndXBkYXRlZW5kJywgdGhpcy5lLm9uU291cmNlQnVmZmVyVXBkYXRlRW5kKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZSh0aGlzLlRBRywgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX21zZUV2ZW50czIuZGVmYXVsdC5FUlJPUiwgeyBjb2RlOiBlcnJvci5jb2RlLCBtc2c6IGVycm9yLm1lc3NhZ2UgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYodGhpcy5UQUcsICdOb3RpY2U6ICcgKyBpcy50eXBlICsgJyBtaW1lVHlwZSBjaGFuZ2VkLCBvcmlnaW46ICcgKyB0aGlzLl9taW1lVHlwZXNbaXMudHlwZV0gKyAnLCB0YXJnZXQ6ICcgKyBtaW1lVHlwZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX21pbWVUeXBlc1tpcy50eXBlXSA9IG1pbWVUeXBlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIWRlZmVycmVkKSB7XG4gICAgICAgICAgICAgICAgLy8gZGVmZXJyZWQgbWVhbnMgdGhpcyBJbml0U2VnbWVudCBoYXMgYmVlbiBwdXNoZWQgdG8gcGVuZGluZ1NlZ21lbnRzIHF1ZXVlXG4gICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1NlZ21lbnRzW2lzLnR5cGVdLnB1c2goaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFmaXJzdEluaXRTZWdtZW50KSB7XG4gICAgICAgICAgICAgICAgLy8gYXBwZW5kIGltbWVkaWF0ZWx5IG9ubHkgaWYgaW5pdCBzZWdtZW50IGluIHN1YnNlcXVlbmNlXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3NvdXJjZUJ1ZmZlcnNbaXMudHlwZV0gJiYgIXRoaXMuX3NvdXJjZUJ1ZmZlcnNbaXMudHlwZV0udXBkYXRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZG9BcHBlbmRTZWdtZW50cygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChfYnJvd3NlcjIuZGVmYXVsdC5zYWZhcmkgJiYgaXMuY29udGFpbmVyID09PSAnYXVkaW8vbXBlZycgJiYgaXMubWVkaWFEdXJhdGlvbiA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyAnYXVkaW8vbXBlZycgdHJhY2sgdW5kZXIgU2FmYXJpIG1heSBjYXVzZSBNZWRpYUVsZW1lbnQncyBkdXJhdGlvbiB0byBiZSBOYU5cbiAgICAgICAgICAgICAgICAvLyBNYW51YWxseSBjb3JyZWN0IE1lZGlhU291cmNlLmR1cmF0aW9uIHRvIG1ha2UgcHJvZ3Jlc3MgYmFyIHNlZWthYmxlLCBhbmQgcmVwb3J0IHJpZ2h0IGR1cmF0aW9uXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVxdWlyZVNldE1lZGlhRHVyYXRpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdNZWRpYUR1cmF0aW9uID0gaXMubWVkaWFEdXJhdGlvbiAvIDEwMDA7IC8vIGluIHNlY29uZHNcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVNZWRpYVNvdXJjZUR1cmF0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2FwcGVuZE1lZGlhU2VnbWVudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBlbmRNZWRpYVNlZ21lbnQobWVkaWFTZWdtZW50KSB7XG4gICAgICAgICAgICB2YXIgbXMgPSBtZWRpYVNlZ21lbnQ7XG4gICAgICAgICAgICB0aGlzLl9wZW5kaW5nU2VnbWVudHNbbXMudHlwZV0ucHVzaChtcyk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9jb25maWcuYXV0b0NsZWFudXBTb3VyY2VCdWZmZXIgJiYgdGhpcy5fbmVlZENsZWFudXBTb3VyY2VCdWZmZXIoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2RvQ2xlYW51cFNvdXJjZUJ1ZmZlcigpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc2IgPSB0aGlzLl9zb3VyY2VCdWZmZXJzW21zLnR5cGVdO1xuICAgICAgICAgICAgaWYgKHNiICYmICFzYi51cGRhdGluZyAmJiAhdGhpcy5faGFzUGVuZGluZ1JlbW92ZVJhbmdlcygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZG9BcHBlbmRTZWdtZW50cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzZWVrJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNlZWsoc2Vjb25kcykge1xuICAgICAgICAgICAgLy8gcmVtb3ZlIGFsbCBhcHBlbmRlZCBidWZmZXJzXG4gICAgICAgICAgICBmb3IgKHZhciB0eXBlIGluIHRoaXMuX3NvdXJjZUJ1ZmZlcnMpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3NvdXJjZUJ1ZmZlcnNbdHlwZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gYWJvcnQgY3VycmVudCBidWZmZXIgYXBwZW5kIGFsZ29yaXRobVxuICAgICAgICAgICAgICAgIHZhciBzYiA9IHRoaXMuX3NvdXJjZUJ1ZmZlcnNbdHlwZV07XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhU291cmNlLnJlYWR5U3RhdGUgPT09ICdvcGVuJykge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgcmFuZ2UgcmVtb3ZhbCBhbGdvcml0aG0gaXMgcnVubmluZywgSW52YWxpZFN0YXRlRXJyb3Igd2lsbCBiZSB0aHJvd2VkXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgaXQuXG4gICAgICAgICAgICAgICAgICAgICAgICBzYi5hYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lKHRoaXMuVEFHLCBlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIElEUkxpc3Qgc2hvdWxkIGJlIGNsZWFyXG4gICAgICAgICAgICAgICAgdGhpcy5faWRyTGlzdC5jbGVhcigpO1xuXG4gICAgICAgICAgICAgICAgLy8gcGVuZGluZyBzZWdtZW50cyBzaG91bGQgYmUgZGlzY2FyZFxuICAgICAgICAgICAgICAgIHZhciBwcyA9IHRoaXMuX3BlbmRpbmdTZWdtZW50c1t0eXBlXTtcbiAgICAgICAgICAgICAgICBwcy5zcGxpY2UoMCwgcHMubGVuZ3RoKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYVNvdXJjZS5yZWFkeVN0YXRlID09PSAnY2xvc2VkJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBQYXJlbnQgTWVkaWFTb3VyY2Ugb2JqZWN0IGhhcyBiZWVuIGRldGFjaGVkIGZyb20gSFRNTE1lZGlhRWxlbWVudFxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyByZWNvcmQgcmFuZ2VzIHRvIGJlIHJlbW92ZSBmcm9tIFNvdXJjZUJ1ZmZlclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2IuYnVmZmVyZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gc2IuYnVmZmVyZWQuc3RhcnQoaSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbmQgPSBzYi5idWZmZXJlZC5lbmQoaSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdSZW1vdmVSYW5nZXNbdHlwZV0ucHVzaCh7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQgfSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gaWYgc2IgaXMgbm90IHVwZGF0aW5nLCBsZXQncyByZW1vdmUgcmFuZ2VzIG5vdyFcbiAgICAgICAgICAgICAgICBpZiAoIXNiLnVwZGF0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RvUmVtb3ZlUmFuZ2VzKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gU2FmYXJpIDEwIG1heSBnZXQgSW52YWxpZFN0YXRlRXJyb3IgaW4gdGhlIGxhdGVyIGFwcGVuZEJ1ZmZlcigpIGFmdGVyIFNvdXJjZUJ1ZmZlci5yZW1vdmUoKSBjYWxsXG4gICAgICAgICAgICAgICAgLy8gSW50ZXJuYWwgcGFyc2VyJ3Mgc3RhdGUgbWF5IGJlIGludmFsaWQgYXQgdGhpcyB0aW1lLiBSZS1hcHBlbmQgbGFzdCBJbml0U2VnbWVudCB0byB3b3JrYXJvdW5kLlxuICAgICAgICAgICAgICAgIC8vIFJlbGF0ZWQgaXNzdWU6IGh0dHBzOi8vYnVncy53ZWJraXQub3JnL3Nob3dfYnVnLmNnaT9pZD0xNTkyMzBcbiAgICAgICAgICAgICAgICBpZiAoX2Jyb3dzZXIyLmRlZmF1bHQuc2FmYXJpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYXN0SW5pdFNlZ21lbnQgPSB0aGlzLl9sYXN0SW5pdFNlZ21lbnRzW3R5cGVdO1xuICAgICAgICAgICAgICAgICAgICBpZiAobGFzdEluaXRTZWdtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nU2VnbWVudHNbdHlwZV0ucHVzaChsYXN0SW5pdFNlZ21lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzYi51cGRhdGluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2RvQXBwZW5kU2VnbWVudHMoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZW5kT2ZTdHJlYW0nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZW5kT2ZTdHJlYW0oKSB7XG4gICAgICAgICAgICB2YXIgbXMgPSB0aGlzLl9tZWRpYVNvdXJjZTtcbiAgICAgICAgICAgIHZhciBzYiA9IHRoaXMuX3NvdXJjZUJ1ZmZlcnM7XG4gICAgICAgICAgICBpZiAoIW1zIHx8IG1zLnJlYWR5U3RhdGUgIT09ICdvcGVuJykge1xuICAgICAgICAgICAgICAgIGlmIChtcyAmJiBtcy5yZWFkeVN0YXRlID09PSAnY2xvc2VkJyAmJiB0aGlzLl9oYXNQZW5kaW5nU2VnbWVudHMoKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJZiBNZWRpYVNvdXJjZSBoYXNuJ3QgdHVybmVkIGludG8gb3BlbiBzdGF0ZSwgYW5kIHRoZXJlJ3JlIHBlbmRpbmcgc2VnbWVudHNcbiAgICAgICAgICAgICAgICAgICAgLy8gTWFyayBwZW5kaW5nIGVuZE9mU3RyZWFtLCBkZWZlciBjYWxsIHVudGlsIGFsbCBwZW5kaW5nIHNlZ21lbnRzIGFwcGVuZGVkIGNvbXBsZXRlXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhc1BlbmRpbmdFb3MgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2IudmlkZW8gJiYgc2IudmlkZW8udXBkYXRpbmcgfHwgc2IuYXVkaW8gJiYgc2IuYXVkaW8udXBkYXRpbmcpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiBhbnkgc291cmNlYnVmZmVyIGlzIHVwZGF0aW5nLCBkZWZlciBlbmRPZlN0cmVhbSBvcGVyYXRpb25cbiAgICAgICAgICAgICAgICAvLyBTZWUgX29uU291cmNlQnVmZmVyVXBkYXRlRW5kKClcbiAgICAgICAgICAgICAgICB0aGlzLl9oYXNQZW5kaW5nRW9zID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGFzUGVuZGluZ0VvcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIC8vIE5vdGlmeSBtZWRpYSBkYXRhIGxvYWRpbmcgY29tcGxldGVcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIGhlbHBmdWwgZm9yIGNvcnJlY3RpbmcgdG90YWwgZHVyYXRpb24gdG8gbWF0Y2ggbGFzdCBtZWRpYSBzZWdtZW50XG4gICAgICAgICAgICAgICAgLy8gT3RoZXJ3aXNlIE1lZGlhRWxlbWVudCdzIGVuZGVkIGV2ZW50IG1heSBub3QgYmUgdHJpZ2dlcmVkXG4gICAgICAgICAgICAgICAgbXMuZW5kT2ZTdHJlYW0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZ2V0TmVhcmVzdEtleWZyYW1lJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldE5lYXJlc3RLZXlmcmFtZShkdHMpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pZHJMaXN0LmdldExhc3RTeW5jUG9pbnRCZWZvcmVEdHMoZHRzKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX25lZWRDbGVhbnVwU291cmNlQnVmZmVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9uZWVkQ2xlYW51cFNvdXJjZUJ1ZmZlcigpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fY29uZmlnLmF1dG9DbGVhbnVwU291cmNlQnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgY3VycmVudFRpbWUgPSB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWU7XG5cbiAgICAgICAgICAgIGZvciAodmFyIHR5cGUgaW4gdGhpcy5fc291cmNlQnVmZmVycykge1xuICAgICAgICAgICAgICAgIHZhciBzYiA9IHRoaXMuX3NvdXJjZUJ1ZmZlcnNbdHlwZV07XG4gICAgICAgICAgICAgICAgaWYgKHNiKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBidWZmZXJlZCA9IHNiLmJ1ZmZlcmVkO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYnVmZmVyZWQubGVuZ3RoID49IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VGltZSAtIGJ1ZmZlcmVkLnN0YXJ0KDApID49IHRoaXMuX2NvbmZpZy5hdXRvQ2xlYW51cE1heEJhY2t3YXJkRHVyYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfZG9DbGVhbnVwU291cmNlQnVmZmVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9kb0NsZWFudXBTb3VyY2VCdWZmZXIoKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFRpbWUgPSB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWU7XG5cbiAgICAgICAgICAgIGZvciAodmFyIHR5cGUgaW4gdGhpcy5fc291cmNlQnVmZmVycykge1xuICAgICAgICAgICAgICAgIHZhciBzYiA9IHRoaXMuX3NvdXJjZUJ1ZmZlcnNbdHlwZV07XG4gICAgICAgICAgICAgICAgaWYgKHNiKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBidWZmZXJlZCA9IHNiLmJ1ZmZlcmVkO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZG9SZW1vdmUgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJ1ZmZlcmVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBidWZmZXJlZC5zdGFydChpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbmQgPSBidWZmZXJlZC5lbmQoaSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdGFydCA8PSBjdXJyZW50VGltZSAmJiBjdXJyZW50VGltZSA8IGVuZCArIDMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBwYWRkaW5nIDMgc2Vjb25kc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VGltZSAtIHN0YXJ0ID49IHRoaXMuX2NvbmZpZy5hdXRvQ2xlYW51cE1heEJhY2t3YXJkRHVyYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9SZW1vdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtb3ZlRW5kID0gY3VycmVudFRpbWUgLSB0aGlzLl9jb25maWcuYXV0b0NsZWFudXBNaW5CYWNrd2FyZER1cmF0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nUmVtb3ZlUmFuZ2VzW3R5cGVdLnB1c2goeyBzdGFydDogc3RhcnQsIGVuZDogcmVtb3ZlRW5kIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZW5kIDwgY3VycmVudFRpbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb1JlbW92ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1JlbW92ZVJhbmdlc1t0eXBlXS5wdXNoKHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChkb1JlbW92ZSAmJiAhc2IudXBkYXRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2RvUmVtb3ZlUmFuZ2VzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ191cGRhdGVNZWRpYVNvdXJjZUR1cmF0aW9uJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF91cGRhdGVNZWRpYVNvdXJjZUR1cmF0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHNiID0gdGhpcy5fc291cmNlQnVmZmVycztcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQucmVhZHlTdGF0ZSA9PT0gMCB8fCB0aGlzLl9tZWRpYVNvdXJjZS5yZWFkeVN0YXRlICE9PSAnb3BlbicpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2IudmlkZW8gJiYgc2IudmlkZW8udXBkYXRpbmcgfHwgc2IuYXVkaW8gJiYgc2IuYXVkaW8udXBkYXRpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBjdXJyZW50ID0gdGhpcy5fbWVkaWFTb3VyY2UuZHVyYXRpb247XG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy5fcGVuZGluZ01lZGlhRHVyYXRpb247XG5cbiAgICAgICAgICAgIGlmICh0YXJnZXQgPiAwICYmIChpc05hTihjdXJyZW50KSB8fCB0YXJnZXQgPiBjdXJyZW50KSkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudih0aGlzLlRBRywgJ1VwZGF0ZSBNZWRpYVNvdXJjZSBkdXJhdGlvbiBmcm9tICcgKyBjdXJyZW50ICsgJyB0byAnICsgdGFyZ2V0KTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYVNvdXJjZS5kdXJhdGlvbiA9IHRhcmdldDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fcmVxdWlyZVNldE1lZGlhRHVyYXRpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdNZWRpYUR1cmF0aW9uID0gMDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2RvUmVtb3ZlUmFuZ2VzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9kb1JlbW92ZVJhbmdlcygpIHtcbiAgICAgICAgICAgIGZvciAodmFyIHR5cGUgaW4gdGhpcy5fcGVuZGluZ1JlbW92ZVJhbmdlcykge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fc291cmNlQnVmZmVyc1t0eXBlXSB8fCB0aGlzLl9zb3VyY2VCdWZmZXJzW3R5cGVdLnVwZGF0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgc2IgPSB0aGlzLl9zb3VyY2VCdWZmZXJzW3R5cGVdO1xuICAgICAgICAgICAgICAgIHZhciByYW5nZXMgPSB0aGlzLl9wZW5kaW5nUmVtb3ZlUmFuZ2VzW3R5cGVdO1xuICAgICAgICAgICAgICAgIHdoaWxlIChyYW5nZXMubGVuZ3RoICYmICFzYi51cGRhdGluZykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSByYW5nZXMuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgc2IucmVtb3ZlKHJhbmdlLnN0YXJ0LCByYW5nZS5lbmQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2RvQXBwZW5kU2VnbWVudHMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2RvQXBwZW5kU2VnbWVudHMoKSB7XG4gICAgICAgICAgICB2YXIgcGVuZGluZ1NlZ21lbnRzID0gdGhpcy5fcGVuZGluZ1NlZ21lbnRzO1xuXG4gICAgICAgICAgICBmb3IgKHZhciB0eXBlIGluIHBlbmRpbmdTZWdtZW50cykge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fc291cmNlQnVmZmVyc1t0eXBlXSB8fCB0aGlzLl9zb3VyY2VCdWZmZXJzW3R5cGVdLnVwZGF0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChwZW5kaW5nU2VnbWVudHNbdHlwZV0ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VnbWVudCA9IHBlbmRpbmdTZWdtZW50c1t0eXBlXS5zaGlmdCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWdtZW50LnRpbWVzdGFtcE9mZnNldCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRm9yIE1QRUcgYXVkaW8gc3RyZWFtIGluIE1TRSwgaWYgdW5idWZmZXJlZC1zZWVraW5nIG9jY3VycmVkXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIGV4cGxpY2l0bHkgc2V0IHRpbWVzdGFtcE9mZnNldCB0byB0aGUgZGVzaXJlZCBwb2ludCBpbiB0aW1lbGluZSBmb3IgbXBlZyBTb3VyY2VCdWZmZXIuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudE9mZnNldCA9IHRoaXMuX3NvdXJjZUJ1ZmZlcnNbdHlwZV0udGltZXN0YW1wT2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldE9mZnNldCA9IHNlZ21lbnQudGltZXN0YW1wT2Zmc2V0IC8gMTAwMDsgLy8gaW4gc2Vjb25kc1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVsdGEgPSBNYXRoLmFicyhjdXJyZW50T2Zmc2V0IC0gdGFyZ2V0T2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkZWx0YSA+IDAuMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHRpbWUgZGVsdGEgPiAxMDBtc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudih0aGlzLlRBRywgJ1VwZGF0ZSBNUEVHIGF1ZGlvIHRpbWVzdGFtcE9mZnNldCBmcm9tICcgKyBjdXJyZW50T2Zmc2V0ICsgJyB0byAnICsgdGFyZ2V0T2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zb3VyY2VCdWZmZXJzW3R5cGVdLnRpbWVzdGFtcE9mZnNldCA9IHRhcmdldE9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBzZWdtZW50LnRpbWVzdGFtcE9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICghc2VnbWVudC5kYXRhIHx8IHNlZ21lbnQuZGF0YS5ieXRlTGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgZW1wdHkgYnVmZmVyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zb3VyY2VCdWZmZXJzW3R5cGVdLmFwcGVuZEJ1ZmZlcihzZWdtZW50LmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faXNCdWZmZXJGdWxsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ3ZpZGVvJyAmJiBzZWdtZW50Lmhhc093blByb3BlcnR5KCdpbmZvJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pZHJMaXN0LmFwcGVuZEFycmF5KHNlZ21lbnQuaW5mby5zeW5jUG9pbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTZWdtZW50c1t0eXBlXS51bnNoaWZ0KHNlZ21lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9yLmNvZGUgPT09IDIyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUXVvdGFFeGNlZWRlZEVycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogTm90aWNlIHRoYXQgRmlyZUZveCBtYXkgbm90IHRocm93IFF1b3RhRXhjZWVkZWRFcnJvciBpZiBTb3VyY2VCdWZmZXIgaXMgZnVsbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ3VycmVudGx5IHdlIGNhbiBvbmx5IGRvIGxhenktbG9hZCB0byBhdm9pZCBTb3VyY2VCdWZmZXIgYmVjb21lIHNjYXR0ZXJlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNvdXJjZUJ1ZmZlciBldmljdGlvbiBwb2xpY3kgbWF5IGJlIGNoYW5nZWQgaW4gZnV0dXJlIHZlcnNpb24gb2YgRmlyZUZveC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBSZWxhdGVkIGlzc3VlczpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTEyNzk4ODVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTEyODAwMjNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVwb3J0IGJ1ZmZlciBmdWxsLCBhYm9ydCBuZXR3b3JrIElPXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9pc0J1ZmZlckZ1bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF9tc2VFdmVudHMyLmRlZmF1bHQuQlVGRkVSX0ZVTEwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pc0J1ZmZlckZ1bGwgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmUodGhpcy5UQUcsIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfbXNlRXZlbnRzMi5kZWZhdWx0LkVSUk9SLCB7IGNvZGU6IGVycm9yLmNvZGUsIG1zZzogZXJyb3IubWVzc2FnZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uU291cmNlT3BlbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Tb3VyY2VPcGVuKCkge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KHRoaXMuVEFHLCAnTWVkaWFTb3VyY2Ugb25Tb3VyY2VPcGVuJyk7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYVNvdXJjZS5yZW1vdmVFdmVudExpc3RlbmVyKCdzb3VyY2VvcGVuJywgdGhpcy5lLm9uU291cmNlT3Blbik7XG4gICAgICAgICAgICAvLyBkZWZlcnJlZCBzb3VyY2VidWZmZXIgY3JlYXRpb24gLyBpbml0aWFsaXphdGlvblxuICAgICAgICAgICAgaWYgKHRoaXMuX3BlbmRpbmdTb3VyY2VCdWZmZXJJbml0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgcGVuZGluZ3MgPSB0aGlzLl9wZW5kaW5nU291cmNlQnVmZmVySW5pdDtcbiAgICAgICAgICAgICAgICB3aGlsZSAocGVuZGluZ3MubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWdtZW50ID0gcGVuZGluZ3Muc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHBlbmRJbml0U2VnbWVudChzZWdtZW50LCB0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyB0aGVyZSBtYXkgYmUgc29tZSBwZW5kaW5nIG1lZGlhIHNlZ21lbnRzLCBhcHBlbmQgdGhlbVxuICAgICAgICAgICAgaWYgKHRoaXMuX2hhc1BlbmRpbmdTZWdtZW50cygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZG9BcHBlbmRTZWdtZW50cygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF9tc2VFdmVudHMyLmRlZmF1bHQuU09VUkNFX09QRU4pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Tb3VyY2VFbmRlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Tb3VyY2VFbmRlZCgpIHtcbiAgICAgICAgICAgIC8vIGZpcmVkIG9uIGVuZE9mU3RyZWFtXG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYodGhpcy5UQUcsICdNZWRpYVNvdXJjZSBvblNvdXJjZUVuZGVkJyk7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX21zZUV2ZW50czIuZGVmYXVsdC5TT1VSQ0VfRU5ELCAnTWVkaWFTb3VyY2Ugb25Tb3VyY2VFbmRlZCcpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Tb3VyY2VDbG9zZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Tb3VyY2VDbG9zZSgpIHtcbiAgICAgICAgICAgIC8vIGZpcmVkIG9uIGRldGFjaGluZyBmcm9tIG1lZGlhIGVsZW1lbnRcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudih0aGlzLlRBRywgJ01lZGlhU291cmNlIG9uU291cmNlQ2xvc2UnKTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYVNvdXJjZSAmJiB0aGlzLmUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhU291cmNlLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3NvdXJjZW9wZW4nLCB0aGlzLmUub25Tb3VyY2VPcGVuKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYVNvdXJjZS5yZW1vdmVFdmVudExpc3RlbmVyKCdzb3VyY2VlbmRlZCcsIHRoaXMuZS5vblNvdXJjZUVuZGVkKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYVNvdXJjZS5yZW1vdmVFdmVudExpc3RlbmVyKCdzb3VyY2VjbG9zZScsIHRoaXMuZS5vblNvdXJjZUNsb3NlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2hhc1BlbmRpbmdTZWdtZW50cycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfaGFzUGVuZGluZ1NlZ21lbnRzKCkge1xuICAgICAgICAgICAgdmFyIHBzID0gdGhpcy5fcGVuZGluZ1NlZ21lbnRzO1xuICAgICAgICAgICAgcmV0dXJuIHBzLnZpZGVvLmxlbmd0aCA+IDAgfHwgcHMuYXVkaW8ubGVuZ3RoID4gMDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2hhc1BlbmRpbmdSZW1vdmVSYW5nZXMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2hhc1BlbmRpbmdSZW1vdmVSYW5nZXMoKSB7XG4gICAgICAgICAgICB2YXIgcHJyID0gdGhpcy5fcGVuZGluZ1JlbW92ZVJhbmdlcztcbiAgICAgICAgICAgIHJldHVybiBwcnIudmlkZW8ubGVuZ3RoID4gMCB8fCBwcnIuYXVkaW8ubGVuZ3RoID4gMDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uU291cmNlQnVmZmVyVXBkYXRlRW5kJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblNvdXJjZUJ1ZmZlclVwZGF0ZUVuZCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9yZXF1aXJlU2V0TWVkaWFEdXJhdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZU1lZGlhU291cmNlRHVyYXRpb24oKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5faGFzUGVuZGluZ1JlbW92ZVJhbmdlcygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZG9SZW1vdmVSYW5nZXMoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5faGFzUGVuZGluZ1NlZ21lbnRzKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kb0FwcGVuZFNlZ21lbnRzKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2hhc1BlbmRpbmdFb3MpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVuZE9mU3RyZWFtKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX21zZUV2ZW50czIuZGVmYXVsdC5VUERBVEVfRU5EKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uU291cmNlQnVmZmVyRXJyb3InLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uU291cmNlQnVmZmVyRXJyb3IoZSkge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lKHRoaXMuVEFHLCAnU291cmNlQnVmZmVyIEVycm9yOiAnICsgZSk7XG4gICAgICAgICAgICAvLyB0aGlzIGVycm9yIG1pZ2h0IG5vdCBhbHdheXMgYmUgZmF0YWwsIGp1c3QgaWdub3JlIGl0XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gTVNFQ29udHJvbGxlcjtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gTVNFQ29udHJvbGxlcjtcblxufSx7XCIuLi91dGlscy9icm93c2VyLmpzXCI6MzksXCIuLi91dGlscy9leGNlcHRpb24uanNcIjo0MCxcIi4uL3V0aWxzL2xvZ2dlci5qc1wiOjQxLFwiLi9tZWRpYS1zZWdtZW50LWluZm8uanNcIjo4LFwiLi9tc2UtZXZlbnRzLmpzXCI6MTAsXCJldmVudHNcIjoyfV0sMTA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxudmFyIE1TRUV2ZW50cyA9IHtcbiAgRVJST1I6ICdlcnJvcicsXG4gIFNPVVJDRV9PUEVOOiAnc291cmNlX29wZW4nLFxuICBVUERBVEVfRU5EOiAndXBkYXRlX2VuZCcsXG4gIEJVRkZFUl9GVUxMOiAnYnVmZmVyX2Z1bGwnLFxuICBTT1VSQ0VfRU5EOiAnc291cmNlX2VuZCdcbn07XG5cbmV4cG9ydHMuZGVmYXVsdCA9IE1TRUV2ZW50cztcblxufSx7fV0sMTE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgX2V2ZW50cyA9IF9kZXJlcV8oJ2V2ZW50cycpO1xuXG52YXIgX2V2ZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ldmVudHMpO1xuXG52YXIgX2xvZ2dlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZ2dlci5qcycpO1xuXG52YXIgX2xvZ2dlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnZXIpO1xuXG52YXIgX2xvZ2dpbmdDb250cm9sID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nZ2luZy1jb250cm9sLmpzJyk7XG5cbnZhciBfbG9nZ2luZ0NvbnRyb2wyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2luZ0NvbnRyb2wpO1xuXG52YXIgX3RyYW5zbXV4aW5nQ29udHJvbGxlciA9IF9kZXJlcV8oJy4vdHJhbnNtdXhpbmctY29udHJvbGxlci5qcycpO1xuXG52YXIgX3RyYW5zbXV4aW5nQ29udHJvbGxlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90cmFuc211eGluZ0NvbnRyb2xsZXIpO1xuXG52YXIgX3RyYW5zbXV4aW5nRXZlbnRzID0gX2RlcmVxXygnLi90cmFuc211eGluZy1ldmVudHMuanMnKTtcblxudmFyIF90cmFuc211eGluZ0V2ZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90cmFuc211eGluZ0V2ZW50cyk7XG5cbnZhciBfdHJhbnNtdXhpbmdXb3JrZXIgPSBfZGVyZXFfKCcuL3RyYW5zbXV4aW5nLXdvcmtlci5qcycpO1xuXG52YXIgX3RyYW5zbXV4aW5nV29ya2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RyYW5zbXV4aW5nV29ya2VyKTtcblxudmFyIF9tZWRpYUluZm8gPSBfZGVyZXFfKCcuL21lZGlhLWluZm8uanMnKTtcblxudmFyIF9tZWRpYUluZm8yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbWVkaWFJbmZvKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIFRyYW5zbXV4ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gVHJhbnNtdXhlcihtZWRpYURhdGFTb3VyY2UsIGNvbmZpZykge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVHJhbnNtdXhlcik7XG5cbiAgICAgICAgdGhpcy5UQUcgPSAnVHJhbnNtdXhlcic7XG4gICAgICAgIHRoaXMuX2VtaXR0ZXIgPSBuZXcgX2V2ZW50czIuZGVmYXVsdCgpO1xuXG4gICAgICAgIGlmIChjb25maWcuZW5hYmxlV29ya2VyICYmIHR5cGVvZiBXb3JrZXIgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciB3b3JrID0gX2RlcmVxXygnd2Vid29ya2lmeScpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlciA9IHdvcmsoX3RyYW5zbXV4aW5nV29ya2VyMi5kZWZhdWx0KTtcbiAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXJEZXN0cm95aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLl9vbldvcmtlck1lc3NhZ2UuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyLnBvc3RNZXNzYWdlKHsgY21kOiAnaW5pdCcsIHBhcmFtOiBbbWVkaWFEYXRhU291cmNlLCBjb25maWddIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgb25Mb2dnaW5nQ29uZmlnQ2hhbmdlZDogdGhpcy5fb25Mb2dnaW5nQ29uZmlnQ2hhbmdlZC5iaW5kKHRoaXMpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBfbG9nZ2luZ0NvbnRyb2wyLmRlZmF1bHQucmVnaXN0ZXJMaXN0ZW5lcih0aGlzLmUub25Mb2dnaW5nQ29uZmlnQ2hhbmdlZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyLnBvc3RNZXNzYWdlKHsgY21kOiAnbG9nZ2luZ19jb25maWcnLCBwYXJhbTogX2xvZ2dpbmdDb250cm9sMi5kZWZhdWx0LmdldENvbmZpZygpIH0pO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmUodGhpcy5UQUcsICdFcnJvciB3aGlsZSBpbml0aWFsaXplIHRyYW5zbXV4aW5nIHdvcmtlciwgZmFsbGJhY2sgdG8gaW5saW5lIHRyYW5zbXV4aW5nJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb250cm9sbGVyID0gbmV3IF90cmFuc211eGluZ0NvbnRyb2xsZXIyLmRlZmF1bHQobWVkaWFEYXRhU291cmNlLCBjb25maWcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fY29udHJvbGxlciA9IG5ldyBfdHJhbnNtdXhpbmdDb250cm9sbGVyMi5kZWZhdWx0KG1lZGlhRGF0YVNvdXJjZSwgY29uZmlnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9jb250cm9sbGVyKSB7XG4gICAgICAgICAgICB2YXIgY3RsID0gdGhpcy5fY29udHJvbGxlcjtcbiAgICAgICAgICAgIGN0bC5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuSU9fRVJST1IsIHRoaXMuX29uSU9FcnJvci5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGN0bC5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuREVNVVhfRVJST1IsIHRoaXMuX29uRGVtdXhFcnJvci5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGN0bC5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuSU5JVF9TRUdNRU5ULCB0aGlzLl9vbkluaXRTZWdtZW50LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgY3RsLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRURJQV9TRUdNRU5ULCB0aGlzLl9vbk1lZGlhU2VnbWVudC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGN0bC5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTE9BRElOR19DT01QTEVURSwgdGhpcy5fb25Mb2FkaW5nQ29tcGxldGUuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICBjdGwub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlJFQ09WRVJFRF9FQVJMWV9FT0YsIHRoaXMuX29uUmVjb3ZlcmVkRWFybHlFb2YuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICBjdGwub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FRElBX0lORk8sIHRoaXMuX29uTWVkaWFJbmZvLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgY3RsLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRVRBREFUQV9BUlJJVkVELCB0aGlzLl9vbk1ldGFEYXRhQXJyaXZlZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGN0bC5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU0NSSVBUREFUQV9BUlJJVkVELCB0aGlzLl9vblNjcmlwdERhdGFBcnJpdmVkLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgY3RsLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TVEFUSVNUSUNTX0lORk8sIHRoaXMuX29uU3RhdGlzdGljc0luZm8uYmluZCh0aGlzKSk7XG4gICAgICAgICAgICBjdGwub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlJFQ09NTUVORF9TRUVLUE9JTlQsIHRoaXMuX29uUmVjb21tZW5kU2Vla3BvaW50LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgY3RsLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TVFJFQU1fVElNRSwgdGhpcy5fb25TdHJlYW1UaW1lLmJpbmQodGhpcykpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFRyYW5zbXV4ZXIsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl93b3JrZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3dvcmtlckRlc3Ryb3lpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyRGVzdHJveWluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlci5wb3N0TWVzc2FnZSh7IGNtZDogJ2Rlc3Ryb3knIH0pO1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2luZ0NvbnRyb2wyLmRlZmF1bHQucmVtb3ZlTGlzdGVuZXIodGhpcy5lLm9uTG9nZ2luZ0NvbmZpZ0NoYW5nZWQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmUgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29udHJvbGxlci5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29udHJvbGxlciA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLnJlbW92ZUFsbExpc3RlbmVycygpO1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uKGV2ZW50LCBsaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5hZGRMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvZmYnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb2ZmKGV2ZW50LCBsaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5yZW1vdmVMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdoYXNXb3JrZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaGFzV29ya2VyKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3dvcmtlciAhPSBudWxsO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvcGVuJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW4oKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fd29ya2VyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyLnBvc3RNZXNzYWdlKHsgY21kOiAnc3RhcnQnIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb250cm9sbGVyLnN0YXJ0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2Nsb3NlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3dvcmtlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlci5wb3N0TWVzc2FnZSh7IGNtZDogJ3N0b3AnIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb250cm9sbGVyLnN0b3AoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc2VlaycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZWVrKG1pbGxpc2Vjb25kcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3dvcmtlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlci5wb3N0TWVzc2FnZSh7IGNtZDogJ3NlZWsnLCBwYXJhbTogbWlsbGlzZWNvbmRzIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb250cm9sbGVyLnNlZWsobWlsbGlzZWNvbmRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncGF1c2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fd29ya2VyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyLnBvc3RNZXNzYWdlKHsgY21kOiAncGF1c2UnIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb250cm9sbGVyLnBhdXNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3Jlc3VtZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWUoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fd29ya2VyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyLnBvc3RNZXNzYWdlKHsgY21kOiAncmVzdW1lJyB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29udHJvbGxlci5yZXN1bWUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uSW5pdFNlZ21lbnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uSW5pdFNlZ21lbnQodHlwZSwgaW5pdFNlZ21lbnQpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgICAgIC8vIGRvIGFzeW5jIGludm9rZVxuICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuSU5JVF9TRUdNRU5ULCB0eXBlLCBpbml0U2VnbWVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uTWVkaWFTZWdtZW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbk1lZGlhU2VnbWVudCh0eXBlLCBtZWRpYVNlZ21lbnQpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpczIuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVESUFfU0VHTUVOVCwgdHlwZSwgbWVkaWFTZWdtZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Mb2FkaW5nQ29tcGxldGUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uTG9hZGluZ0NvbXBsZXRlKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzMy5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5MT0FESU5HX0NPTVBMRVRFKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25SZWNvdmVyZWRFYXJseUVvZicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZWNvdmVyZWRFYXJseUVvZigpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczQgPSB0aGlzO1xuXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpczQuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuUkVDT1ZFUkVEX0VBUkxZX0VPRik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uTWVkaWFJbmZvJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbk1lZGlhSW5mbyhtZWRpYUluZm8pIHtcbiAgICAgICAgICAgIHZhciBfdGhpczUgPSB0aGlzO1xuXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpczUuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVESUFfSU5GTywgbWVkaWFJbmZvKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25NZXRhRGF0YUFycml2ZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uTWV0YURhdGFBcnJpdmVkKG1ldGFkYXRhKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXM2ID0gdGhpcztcblxuICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXM2Ll9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FVEFEQVRBX0FSUklWRUQsIG1ldGFkYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25TY3JpcHREYXRhQXJyaXZlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25TY3JpcHREYXRhQXJyaXZlZChkYXRhKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXM3ID0gdGhpcztcblxuICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXM3Ll9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNDUklQVERBVEFfQVJSSVZFRCwgZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uU3RhdGlzdGljc0luZm8nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uU3RhdGlzdGljc0luZm8oc3RhdGlzdGljc0luZm8pIHtcbiAgICAgICAgICAgIHZhciBfdGhpczggPSB0aGlzO1xuXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpczguX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU1RBVElTVElDU19JTkZPLCBzdGF0aXN0aWNzSW5mbyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uSU9FcnJvcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25JT0Vycm9yKHR5cGUsIGluZm8pIHtcbiAgICAgICAgICAgIHZhciBfdGhpczkgPSB0aGlzO1xuXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpczkuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuSU9fRVJST1IsIHR5cGUsIGluZm8pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbkRlbXV4RXJyb3InLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uRGVtdXhFcnJvcih0eXBlLCBpbmZvKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7XG5cbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzMTAuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuREVNVVhfRVJST1IsIHR5cGUsIGluZm8pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblJlY29tbWVuZFNlZWtwb2ludCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZWNvbW1lbmRTZWVrcG9pbnQobWlsbGlzZWNvbmRzKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMxMSA9IHRoaXM7XG5cbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzMTEuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuUkVDT01NRU5EX1NFRUtQT0lOVCwgbWlsbGlzZWNvbmRzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25TdHJlYW1UaW1lJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblN0cmVhbVRpbWUodGltZSkge1xuICAgICAgICAgICAgdmFyIF90aGlzMTIgPSB0aGlzO1xuXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpczEyLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNUUkVBTV9USU1FLCB0aW1lKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Mb2dnaW5nQ29uZmlnQ2hhbmdlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Mb2dnaW5nQ29uZmlnQ2hhbmdlZChjb25maWcpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl93b3JrZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXIucG9zdE1lc3NhZ2UoeyBjbWQ6ICdsb2dnaW5nX2NvbmZpZycsIHBhcmFtOiBjb25maWcgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbldvcmtlck1lc3NhZ2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uV29ya2VyTWVzc2FnZShlKSB7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9IGUuZGF0YTtcbiAgICAgICAgICAgIHZhciBkYXRhID0gbWVzc2FnZS5kYXRhO1xuXG4gICAgICAgICAgICBpZiAobWVzc2FnZS5tc2cgPT09ICdkZXN0cm95ZWQnIHx8IHRoaXMuX3dvcmtlckRlc3Ryb3lpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXJEZXN0cm95aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyLnRlcm1pbmF0ZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzd2l0Y2ggKG1lc3NhZ2UubXNnKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuSU5JVF9TRUdNRU5UOlxuICAgICAgICAgICAgICAgIGNhc2UgX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FRElBX1NFR01FTlQ6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChtZXNzYWdlLm1zZywgZGF0YS50eXBlLCBkYXRhLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5MT0FESU5HX0NPTVBMRVRFOlxuICAgICAgICAgICAgICAgIGNhc2UgX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlJFQ09WRVJFRF9FQVJMWV9FT0Y6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChtZXNzYWdlLm1zZyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FRElBX0lORk86XG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihkYXRhLCBfbWVkaWFJbmZvMi5kZWZhdWx0LnByb3RvdHlwZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChtZXNzYWdlLm1zZywgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FVEFEQVRBX0FSUklWRUQ6XG4gICAgICAgICAgICAgICAgY2FzZSBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU0NSSVBUREFUQV9BUlJJVkVEOlxuICAgICAgICAgICAgICAgIGNhc2UgX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNUQVRJU1RJQ1NfSU5GTzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KG1lc3NhZ2UubXNnLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuSU9fRVJST1I6XG4gICAgICAgICAgICAgICAgY2FzZSBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuREVNVVhfRVJST1I6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChtZXNzYWdlLm1zZywgZGF0YS50eXBlLCBkYXRhLmluZm8pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5SRUNPTU1FTkRfU0VFS1BPSU5UOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQobWVzc2FnZS5tc2csIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdsb2djYXRfY2FsbGJhY2snOlxuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmVtaXR0ZXIuZW1pdCgnbG9nJywgZGF0YS50eXBlLCBkYXRhLmxvZ2NhdCk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFRyYW5zbXV4ZXI7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFRyYW5zbXV4ZXI7XG5cbn0se1wiLi4vdXRpbHMvbG9nZ2VyLmpzXCI6NDEsXCIuLi91dGlscy9sb2dnaW5nLWNvbnRyb2wuanNcIjo0MixcIi4vbWVkaWEtaW5mby5qc1wiOjcsXCIuL3RyYW5zbXV4aW5nLWNvbnRyb2xsZXIuanNcIjoxMixcIi4vdHJhbnNtdXhpbmctZXZlbnRzLmpzXCI6MTMsXCIuL3RyYW5zbXV4aW5nLXdvcmtlci5qc1wiOjE0LFwiZXZlbnRzXCI6MixcIndlYndvcmtpZnlcIjo0fV0sMTI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgX2V2ZW50cyA9IF9kZXJlcV8oJ2V2ZW50cycpO1xuXG52YXIgX2V2ZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ldmVudHMpO1xuXG52YXIgX2xvZ2dlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZ2dlci5qcycpO1xuXG52YXIgX2xvZ2dlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnZXIpO1xuXG52YXIgX2Jyb3dzZXIgPSBfZGVyZXFfKCcuLi91dGlscy9icm93c2VyLmpzJyk7XG5cbnZhciBfYnJvd3NlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9icm93c2VyKTtcblxudmFyIF9tZWRpYUluZm8gPSBfZGVyZXFfKCcuL21lZGlhLWluZm8uanMnKTtcblxudmFyIF9tZWRpYUluZm8yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbWVkaWFJbmZvKTtcblxudmFyIF9mbHZEZW11eGVyID0gX2RlcmVxXygnLi4vZGVtdXgvZmx2LWRlbXV4ZXIuanMnKTtcblxudmFyIF9mbHZEZW11eGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZsdkRlbXV4ZXIpO1xuXG52YXIgX21wNFJlbXV4ZXIgPSBfZGVyZXFfKCcuLi9yZW11eC9tcDQtcmVtdXhlci5qcycpO1xuXG52YXIgX21wNFJlbXV4ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbXA0UmVtdXhlcik7XG5cbnZhciBfZGVtdXhFcnJvcnMgPSBfZGVyZXFfKCcuLi9kZW11eC9kZW11eC1lcnJvcnMuanMnKTtcblxudmFyIF9kZW11eEVycm9yczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kZW11eEVycm9ycyk7XG5cbnZhciBfaW9Db250cm9sbGVyID0gX2RlcmVxXygnLi4vaW8vaW8tY29udHJvbGxlci5qcycpO1xuXG52YXIgX2lvQ29udHJvbGxlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pb0NvbnRyb2xsZXIpO1xuXG52YXIgX3RyYW5zbXV4aW5nRXZlbnRzID0gX2RlcmVxXygnLi90cmFuc211eGluZy1ldmVudHMuanMnKTtcblxudmFyIF90cmFuc211eGluZ0V2ZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90cmFuc211eGluZ0V2ZW50cyk7XG5cbnZhciBfbG9hZGVyID0gX2RlcmVxXygnLi4vaW8vbG9hZGVyLmpzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8vIFRyYW5zbXV4aW5nIChJTywgRGVtdXhpbmcsIFJlbXV4aW5nKSBjb250cm9sbGVyLCB3aXRoIG11bHRpcGFydCBzdXBwb3J0XG52YXIgVHJhbnNtdXhpbmdDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFRyYW5zbXV4aW5nQ29udHJvbGxlcihtZWRpYURhdGFTb3VyY2UsIGNvbmZpZykge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVHJhbnNtdXhpbmdDb250cm9sbGVyKTtcblxuICAgICAgICB0aGlzLlRBRyA9ICdUcmFuc211eGluZ0NvbnRyb2xsZXInO1xuICAgICAgICB0aGlzLl9lbWl0dGVyID0gbmV3IF9ldmVudHMyLmRlZmF1bHQoKTtcblxuICAgICAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XG5cbiAgICAgICAgLy8gdHJlYXQgc2luZ2xlIHBhcnQgbWVkaWEgYXMgbXVsdGlwYXJ0IG1lZGlhLCB3aGljaCBoYXMgb25seSBvbmUgc2VnbWVudFxuICAgICAgICBpZiAoIW1lZGlhRGF0YVNvdXJjZS5zZWdtZW50cykge1xuICAgICAgICAgICAgbWVkaWFEYXRhU291cmNlLnNlZ21lbnRzID0gW3tcbiAgICAgICAgICAgICAgICBkdXJhdGlvbjogbWVkaWFEYXRhU291cmNlLmR1cmF0aW9uLFxuICAgICAgICAgICAgICAgIGZpbGVzaXplOiBtZWRpYURhdGFTb3VyY2UuZmlsZXNpemUsXG4gICAgICAgICAgICAgICAgdXJsOiBtZWRpYURhdGFTb3VyY2UudXJsXG4gICAgICAgICAgICB9XTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGZpbGwgaW4gZGVmYXVsdCBJTyBwYXJhbXMgaWYgbm90IGV4aXN0c1xuICAgICAgICBpZiAodHlwZW9mIG1lZGlhRGF0YVNvdXJjZS5jb3JzICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgIG1lZGlhRGF0YVNvdXJjZS5jb3JzID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIG1lZGlhRGF0YVNvdXJjZS53aXRoQ3JlZGVudGlhbHMgIT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgbWVkaWFEYXRhU291cmNlLndpdGhDcmVkZW50aWFscyA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fbWVkaWFEYXRhU291cmNlID0gbWVkaWFEYXRhU291cmNlO1xuICAgICAgICB0aGlzLl9jdXJyZW50U2VnbWVudEluZGV4ID0gMDtcbiAgICAgICAgdmFyIHRvdGFsRHVyYXRpb24gPSAwO1xuXG4gICAgICAgIHRoaXMuX21lZGlhRGF0YVNvdXJjZS5zZWdtZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChzZWdtZW50KSB7XG4gICAgICAgICAgICAvLyB0aW1lc3RhbXBCYXNlIGZvciBlYWNoIHNlZ21lbnQsIGFuZCBjYWxjdWxhdGUgdG90YWwgZHVyYXRpb25cbiAgICAgICAgICAgIHNlZ21lbnQudGltZXN0YW1wQmFzZSA9IHRvdGFsRHVyYXRpb247XG4gICAgICAgICAgICB0b3RhbER1cmF0aW9uICs9IHNlZ21lbnQuZHVyYXRpb247XG4gICAgICAgICAgICAvLyBwYXJhbXMgbmVlZGVkIGJ5IElPQ29udHJvbGxlclxuICAgICAgICAgICAgc2VnbWVudC5jb3JzID0gbWVkaWFEYXRhU291cmNlLmNvcnM7XG4gICAgICAgICAgICBzZWdtZW50LndpdGhDcmVkZW50aWFscyA9IG1lZGlhRGF0YVNvdXJjZS53aXRoQ3JlZGVudGlhbHM7XG4gICAgICAgICAgICAvLyByZWZlcnJlciBwb2xpY3kgY29udHJvbCwgaWYgZXhpc3RcbiAgICAgICAgICAgIGlmIChjb25maWcucmVmZXJyZXJQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICBzZWdtZW50LnJlZmVycmVyUG9saWN5ID0gY29uZmlnLnJlZmVycmVyUG9saWN5O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoIWlzTmFOKHRvdGFsRHVyYXRpb24pICYmIHRoaXMuX21lZGlhRGF0YVNvdXJjZS5kdXJhdGlvbiAhPT0gdG90YWxEdXJhdGlvbikge1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFEYXRhU291cmNlLmR1cmF0aW9uID0gdG90YWxEdXJhdGlvbjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX21lZGlhSW5mbyA9IG51bGw7XG4gICAgICAgIHRoaXMuX2RlbXV4ZXIgPSBudWxsO1xuICAgICAgICB0aGlzLl9yZW11eGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5faW9jdGwgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuX3BlbmRpbmdTZWVrVGltZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3BlbmRpbmdSZXNvbHZlU2Vla1BvaW50ID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9zdGF0aXN0aWNzUmVwb3J0ZXIgPSBudWxsO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhUcmFuc211eGluZ0NvbnRyb2xsZXIsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mbyA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYURhdGFTb3VyY2UgPSBudWxsO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhdGlzdGljc1JlcG9ydGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGlzYWJsZVN0YXRpc3RpY3NSZXBvcnRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX2lvY3RsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faW9jdGwuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2lvY3RsID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9kZW11eGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlci5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlciA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fcmVtdXhlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlbXV4ZXIuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlbXV4ZXIgPSBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLnJlbW92ZUFsbExpc3RlbmVycygpO1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uKGV2ZW50LCBsaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5hZGRMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvZmYnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb2ZmKGV2ZW50LCBsaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5yZW1vdmVMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzdGFydCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdGFydCgpIHtcbiAgICAgICAgICAgIHRoaXMuX2xvYWRTZWdtZW50KDApO1xuICAgICAgICAgICAgdGhpcy5fZW5hYmxlU3RhdGlzdGljc1JlcG9ydGVyKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19sb2FkU2VnbWVudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfbG9hZFNlZ21lbnQoc2VnbWVudEluZGV4LCBvcHRpb25hbEZyb20pIHtcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRTZWdtZW50SW5kZXggPSBzZWdtZW50SW5kZXg7XG4gICAgICAgICAgICB2YXIgZGF0YVNvdXJjZSA9IHRoaXMuX21lZGlhRGF0YVNvdXJjZS5zZWdtZW50c1tzZWdtZW50SW5kZXhdO1xuXG4gICAgICAgICAgICB2YXIgaW9jdGwgPSB0aGlzLl9pb2N0bCA9IG5ldyBfaW9Db250cm9sbGVyMi5kZWZhdWx0KGRhdGFTb3VyY2UsIHRoaXMuX2NvbmZpZywgc2VnbWVudEluZGV4KTtcbiAgICAgICAgICAgIGlvY3RsLm9uRXJyb3IgPSB0aGlzLl9vbklPRXhjZXB0aW9uLmJpbmQodGhpcyk7XG4gICAgICAgICAgICBpb2N0bC5vblNlZWtlZCA9IHRoaXMuX29uSU9TZWVrZWQuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIGlvY3RsLm9uQ29tcGxldGUgPSB0aGlzLl9vbklPQ29tcGxldGUuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIGlvY3RsLm9uUmVkaXJlY3QgPSB0aGlzLl9vbklPUmVkaXJlY3QuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIGlvY3RsLm9uUmVjb3ZlcmVkRWFybHlFb2YgPSB0aGlzLl9vbklPUmVjb3ZlcmVkRWFybHlFb2YuYmluZCh0aGlzKTtcblxuICAgICAgICAgICAgaWYgKG9wdGlvbmFsRnJvbSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIuYmluZERhdGFTb3VyY2UodGhpcy5faW9jdGwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpb2N0bC5vbkRhdGFBcnJpdmFsID0gdGhpcy5fb25Jbml0Q2h1bmtBcnJpdmFsLmJpbmQodGhpcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlvY3RsLm9wZW4ob3B0aW9uYWxGcm9tKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc3RvcCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdG9wKCkge1xuICAgICAgICAgICAgdGhpcy5faW50ZXJuYWxBYm9ydCgpO1xuICAgICAgICAgICAgdGhpcy5fZGlzYWJsZVN0YXRpc3RpY3NSZXBvcnRlcigpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfaW50ZXJuYWxBYm9ydCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfaW50ZXJuYWxBYm9ydCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9pb2N0bCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2lvY3RsLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9pb2N0bCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3BhdXNlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgICAgICAgICAgLy8gdGFrZSBhIHJlc3RcbiAgICAgICAgICAgIGlmICh0aGlzLl9pb2N0bCAmJiB0aGlzLl9pb2N0bC5pc1dvcmtpbmcoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2lvY3RsLnBhdXNlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGlzYWJsZVN0YXRpc3RpY3NSZXBvcnRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZXN1bWUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVzdW1lKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2lvY3RsICYmIHRoaXMuX2lvY3RsLmlzUGF1c2VkKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pb2N0bC5yZXN1bWUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9lbmFibGVTdGF0aXN0aWNzUmVwb3J0ZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc2VlaycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZWVrKG1pbGxpc2Vjb25kcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhSW5mbyA9PSBudWxsIHx8ICF0aGlzLl9tZWRpYUluZm8uaXNTZWVrYWJsZSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdGFyZ2V0U2VnbWVudEluZGV4ID0gdGhpcy5fc2VhcmNoU2VnbWVudEluZGV4Q29udGFpbnMobWlsbGlzZWNvbmRzKTtcblxuICAgICAgICAgICAgaWYgKHRhcmdldFNlZ21lbnRJbmRleCA9PT0gdGhpcy5fY3VycmVudFNlZ21lbnRJbmRleCkge1xuICAgICAgICAgICAgICAgIC8vIGludHJhLXNlZ21lbnQgc2Vla2luZ1xuICAgICAgICAgICAgICAgIHZhciBzZWdtZW50SW5mbyA9IHRoaXMuX21lZGlhSW5mby5zZWdtZW50c1t0YXJnZXRTZWdtZW50SW5kZXhdO1xuXG4gICAgICAgICAgICAgICAgaWYgKHNlZ21lbnRJbmZvID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjdXJyZW50IHNlZ21lbnQgbG9hZGluZyBzdGFydGVkLCBidXQgbWVkaWFpbmZvIGhhc24ndCByZWNlaXZlZCB5ZXRcbiAgICAgICAgICAgICAgICAgICAgLy8gd2FpdCBmb3IgdGhlIG1ldGFkYXRhIGxvYWRlZCwgdGhlbiBzZWVrIHRvIGV4cGVjdGVkIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTZWVrVGltZSA9IG1pbGxpc2Vjb25kcztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIga2V5ZnJhbWUgPSBzZWdtZW50SW5mby5nZXROZWFyZXN0S2V5ZnJhbWUobWlsbGlzZWNvbmRzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtdXhlci5zZWVrKGtleWZyYW1lLm1pbGxpc2Vjb25kcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2lvY3RsLnNlZWsoa2V5ZnJhbWUuZmlsZXBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2lsbCBiZSByZXNvbHZlZCBpbiBfb25SZW11eGVyTWVkaWFTZWdtZW50QXJyaXZhbCgpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdSZXNvbHZlU2Vla1BvaW50ID0ga2V5ZnJhbWUubWlsbGlzZWNvbmRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gY3Jvc3Mtc2VnbWVudCBzZWVraW5nXG4gICAgICAgICAgICAgICAgdmFyIHRhcmdldFNlZ21lbnRJbmZvID0gdGhpcy5fbWVkaWFJbmZvLnNlZ21lbnRzW3RhcmdldFNlZ21lbnRJbmRleF07XG5cbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0U2VnbWVudEluZm8gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRhcmdldCBzZWdtZW50IGhhc24ndCBiZWVuIGxvYWRlZC4gV2UgbmVlZCBtZXRhZGF0YSB0aGVuIHNlZWsgdG8gZXhwZWN0ZWQgdGltZVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nU2Vla1RpbWUgPSBtaWxsaXNlY29uZHM7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2ludGVybmFsQWJvcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtdXhlci5zZWVrKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbXV4ZXIuaW5zZXJ0RGlzY29udGludWl0eSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sb2FkU2VnbWVudCh0YXJnZXRTZWdtZW50SW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAvLyBIZXJlIHdlIHdhaXQgZm9yIHRoZSBtZXRhZGF0YSBsb2FkZWQsIHRoZW4gc2VlayB0byBleHBlY3RlZCBwb3NpdGlvblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIGhhdmUgdGFyZ2V0IHNlZ21lbnQncyBtZXRhZGF0YSwgZGlyZWN0IHNlZWsgdG8gdGFyZ2V0IHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgIHZhciBfa2V5ZnJhbWUgPSB0YXJnZXRTZWdtZW50SW5mby5nZXROZWFyZXN0S2V5ZnJhbWUobWlsbGlzZWNvbmRzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faW50ZXJuYWxBYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW11eGVyLnNlZWsobWlsbGlzZWNvbmRzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtdXhlci5pbnNlcnREaXNjb250aW51aXR5KCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIucmVzZXRNZWRpYUluZm8oKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlci50aW1lc3RhbXBCYXNlID0gdGhpcy5fbWVkaWFEYXRhU291cmNlLnNlZ21lbnRzW3RhcmdldFNlZ21lbnRJbmRleF0udGltZXN0YW1wQmFzZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbG9hZFNlZ21lbnQodGFyZ2V0U2VnbWVudEluZGV4LCBfa2V5ZnJhbWUuZmlsZXBvc2l0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1Jlc29sdmVTZWVrUG9pbnQgPSBfa2V5ZnJhbWUubWlsbGlzZWNvbmRzO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXBvcnRTZWdtZW50TWVkaWFJbmZvKHRhcmdldFNlZ21lbnRJbmRleCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9lbmFibGVTdGF0aXN0aWNzUmVwb3J0ZXIoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3NlYXJjaFNlZ21lbnRJbmRleENvbnRhaW5zJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9zZWFyY2hTZWdtZW50SW5kZXhDb250YWlucyhtaWxsaXNlY29uZHMpIHtcbiAgICAgICAgICAgIHZhciBzZWdtZW50cyA9IHRoaXMuX21lZGlhRGF0YVNvdXJjZS5zZWdtZW50cztcbiAgICAgICAgICAgIHZhciBpZHggPSBzZWdtZW50cy5sZW5ndGggLSAxO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlZ21lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1pbGxpc2Vjb25kcyA8IHNlZ21lbnRzW2ldLnRpbWVzdGFtcEJhc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWR4ID0gaSAtIDE7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpZHg7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbkluaXRDaHVua0Fycml2YWwnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uSW5pdENodW5rQXJyaXZhbChkYXRhLCBieXRlU3RhcnQpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgICAgIHZhciBwcm9iZURhdGEgPSBudWxsO1xuICAgICAgICAgICAgdmFyIGNvbnN1bWVkID0gMDtcblxuICAgICAgICAgICAgaWYgKGJ5dGVTdGFydCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBJT0NvbnRyb2xsZXIgc2Vla2VkIGltbWVkaWF0ZWx5IGFmdGVyIG9wZW5lZCwgYnl0ZVN0YXJ0ID4gMCBjYWxsYmFjayBtYXkgcmVjZWl2ZWRcbiAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyLmJpbmREYXRhU291cmNlKHRoaXMuX2lvY3RsKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyLnRpbWVzdGFtcEJhc2UgPSB0aGlzLl9tZWRpYURhdGFTb3VyY2Uuc2VnbWVudHNbdGhpcy5fY3VycmVudFNlZ21lbnRJbmRleF0udGltZXN0YW1wQmFzZTtcblxuICAgICAgICAgICAgICAgIGNvbnN1bWVkID0gdGhpcy5fZGVtdXhlci5wYXJzZUNodW5rcyhkYXRhLCBieXRlU3RhcnQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICgocHJvYmVEYXRhID0gX2ZsdkRlbXV4ZXIyLmRlZmF1bHQucHJvYmUoZGF0YSkpLm1hdGNoKSB7XG4gICAgICAgICAgICAgICAgLy8gQWx3YXlzIGNyZWF0ZSBuZXcgRkxWRGVtdXhlclxuICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIgPSBuZXcgX2ZsdkRlbXV4ZXIyLmRlZmF1bHQocHJvYmVEYXRhLCB0aGlzLl9jb25maWcpO1xuXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9yZW11eGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbXV4ZXIgPSBuZXcgX21wNFJlbXV4ZXIyLmRlZmF1bHQodGhpcy5fY29uZmlnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgbWRzID0gdGhpcy5fbWVkaWFEYXRhU291cmNlO1xuICAgICAgICAgICAgICAgIGlmIChtZHMuZHVyYXRpb24gIT0gdW5kZWZpbmVkICYmICFpc05hTihtZHMuZHVyYXRpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIub3ZlcnJpZGVkRHVyYXRpb24gPSBtZHMuZHVyYXRpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbWRzLmhhc0F1ZGlvID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlci5vdmVycmlkZWRIYXNBdWRpbyA9IG1kcy5oYXNBdWRpbztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtZHMuaGFzVmlkZW8gPT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyLm92ZXJyaWRlZEhhc1ZpZGVvID0gbWRzLmhhc1ZpZGVvO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIudGltZXN0YW1wQmFzZSA9IG1kcy5zZWdtZW50c1t0aGlzLl9jdXJyZW50U2VnbWVudEluZGV4XS50aW1lc3RhbXBCYXNlO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlci5vbkVycm9yID0gdGhpcy5fb25EZW11eEV4Y2VwdGlvbi5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIub25NZWRpYUluZm8gPSB0aGlzLl9vbk1lZGlhSW5mby5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIub25NZXRhRGF0YUFycml2ZWQgPSB0aGlzLl9vbk1ldGFEYXRhQXJyaXZlZC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIub25TY3JpcHREYXRhQXJyaXZlZCA9IHRoaXMuX29uU2NyaXB0RGF0YUFycml2ZWQuYmluZCh0aGlzKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyLm9uU3RyZWFtVGltZSA9IHRoaXMuX29uU3RyZWFtVGltZS5iaW5kKHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVtdXhlci5iaW5kRGF0YVNvdXJjZSh0aGlzLl9kZW11eGVyLmJpbmREYXRhU291cmNlKHRoaXMuX2lvY3RsKSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9yZW11eGVyLm9uSW5pdFNlZ21lbnQgPSB0aGlzLl9vblJlbXV4ZXJJbml0U2VnbWVudEFycml2YWwuYmluZCh0aGlzKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW11eGVyLm9uTWVkaWFTZWdtZW50ID0gdGhpcy5fb25SZW11eGVyTWVkaWFTZWdtZW50QXJyaXZhbC5iaW5kKHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgY29uc3VtZWQgPSB0aGlzLl9kZW11eGVyLnBhcnNlQ2h1bmtzKGRhdGEsIGJ5dGVTdGFydCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHByb2JlRGF0YSA9IG51bGw7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lKHRoaXMuVEFHLCAnTm9uLUZMViwgVW5zdXBwb3J0ZWQgbWVkaWEgdHlwZSEnKTtcbiAgICAgICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2ludGVybmFsQWJvcnQoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LkRFTVVYX0VSUk9SLCBfZGVtdXhFcnJvcnMyLmRlZmF1bHQuRk9STUFUX1VOU1VQUE9SVEVELCAnTm9uLUZMViwgVW5zdXBwb3J0ZWQgbWVkaWEgdHlwZScpO1xuXG4gICAgICAgICAgICAgICAgY29uc3VtZWQgPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gY29uc3VtZWQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbk1lZGlhSW5mbycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25NZWRpYUluZm8obWVkaWFJbmZvKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhSW5mbyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgLy8gU3RvcmUgZmlyc3Qgc2VnbWVudCdzIG1lZGlhaW5mbyBhcyBnbG9iYWwgbWVkaWFJbmZvXG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvID0gT2JqZWN0LmFzc2lnbih7fSwgbWVkaWFJbmZvKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8ua2V5ZnJhbWVzSW5kZXggPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5zZWdtZW50cyA9IFtdO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5zZWdtZW50Q291bnQgPSB0aGlzLl9tZWRpYURhdGFTb3VyY2Uuc2VnbWVudHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLl9tZWRpYUluZm8sIF9tZWRpYUluZm8yLmRlZmF1bHQucHJvdG90eXBlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHNlZ21lbnRJbmZvID0gT2JqZWN0LmFzc2lnbih7fSwgbWVkaWFJbmZvKTtcbiAgICAgICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZihzZWdtZW50SW5mbywgX21lZGlhSW5mbzIuZGVmYXVsdC5wcm90b3R5cGUpO1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLnNlZ21lbnRzW3RoaXMuX2N1cnJlbnRTZWdtZW50SW5kZXhdID0gc2VnbWVudEluZm87XG5cbiAgICAgICAgICAgIC8vIG5vdGlmeSBtZWRpYUluZm8gdXBkYXRlXG4gICAgICAgICAgICB0aGlzLl9yZXBvcnRTZWdtZW50TWVkaWFJbmZvKHRoaXMuX2N1cnJlbnRTZWdtZW50SW5kZXgpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fcGVuZGluZ1NlZWtUaW1lICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IF90aGlzMi5fcGVuZGluZ1NlZWtUaW1lO1xuICAgICAgICAgICAgICAgICAgICBfdGhpczIuX3BlbmRpbmdTZWVrVGltZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMi5zZWVrKHRhcmdldCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbk1ldGFEYXRhQXJyaXZlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25NZXRhRGF0YUFycml2ZWQobWV0YWRhdGEpIHtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVUQURBVEFfQVJSSVZFRCwgbWV0YWRhdGEpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25TY3JpcHREYXRhQXJyaXZlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25TY3JpcHREYXRhQXJyaXZlZChkYXRhKSB7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNDUklQVERBVEFfQVJSSVZFRCwgZGF0YSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblN0cmVhbVRpbWUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uU3RyZWFtVGltZSh0aW1lKSB7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNUUkVBTV9USU1FLCB0aW1lKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uSU9TZWVrZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uSU9TZWVrZWQoKSB7XG4gICAgICAgICAgICB0aGlzLl9yZW11eGVyLmluc2VydERpc2NvbnRpbnVpdHkoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uSU9Db21wbGV0ZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25JT0NvbXBsZXRlKGV4dHJhRGF0YSkge1xuICAgICAgICAgICAgdmFyIHNlZ21lbnRJbmRleCA9IGV4dHJhRGF0YTtcbiAgICAgICAgICAgIHZhciBuZXh0U2VnbWVudEluZGV4ID0gc2VnbWVudEluZGV4ICsgMTtcblxuICAgICAgICAgICAgaWYgKG5leHRTZWdtZW50SW5kZXggPCB0aGlzLl9tZWRpYURhdGFTb3VyY2Uuc2VnbWVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faW50ZXJuYWxBYm9ydCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlbXV4ZXIuZmx1c2hTdGFzaGVkU2FtcGxlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRTZWdtZW50KG5leHRTZWdtZW50SW5kZXgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW11eGVyLmZsdXNoU3Rhc2hlZFNhbXBsZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LkxPQURJTkdfQ09NUExFVEUpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2Rpc2FibGVTdGF0aXN0aWNzUmVwb3J0ZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uSU9SZWRpcmVjdCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25JT1JlZGlyZWN0KHJlZGlyZWN0ZWRVUkwpIHtcbiAgICAgICAgICAgIHZhciBzZWdtZW50SW5kZXggPSB0aGlzLl9pb2N0bC5leHRyYURhdGE7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYURhdGFTb3VyY2Uuc2VnbWVudHNbc2VnbWVudEluZGV4XS5yZWRpcmVjdGVkVVJMID0gcmVkaXJlY3RlZFVSTDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uSU9SZWNvdmVyZWRFYXJseUVvZicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25JT1JlY292ZXJlZEVhcmx5RW9mKCkge1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5SRUNPVkVSRURfRUFSTFlfRU9GKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uSU9FeGNlcHRpb24nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uSU9FeGNlcHRpb24odHlwZSwgaW5mbykge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lKHRoaXMuVEFHLCAnSU9FeGNlcHRpb246IHR5cGUgPSAnICsgdHlwZSArICcsIGNvZGUgPSAnICsgaW5mby5jb2RlICsgJywgbXNnID0gJyArIGluZm8ubXNnKTtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuSU9fRVJST1IsIHR5cGUsIGluZm8pO1xuICAgICAgICAgICAgdGhpcy5fZGlzYWJsZVN0YXRpc3RpY3NSZXBvcnRlcigpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25EZW11eEV4Y2VwdGlvbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25EZW11eEV4Y2VwdGlvbih0eXBlLCBpbmZvKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmUodGhpcy5UQUcsICdEZW11eEV4Y2VwdGlvbjogdHlwZSA9ICcgKyB0eXBlICsgJywgaW5mbyA9ICcgKyBpbmZvKTtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuREVNVVhfRVJST1IsIHR5cGUsIGluZm8pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25SZW11eGVySW5pdFNlZ21lbnRBcnJpdmFsJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlbXV4ZXJJbml0U2VnbWVudEFycml2YWwodHlwZSwgaW5pdFNlZ21lbnQpIHtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuSU5JVF9TRUdNRU5ULCB0eXBlLCBpbml0U2VnbWVudCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblJlbXV4ZXJNZWRpYVNlZ21lbnRBcnJpdmFsJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlbXV4ZXJNZWRpYVNlZ21lbnRBcnJpdmFsKHR5cGUsIG1lZGlhU2VnbWVudCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3BlbmRpbmdTZWVrVGltZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgLy8gTWVkaWEgc2VnbWVudHMgYWZ0ZXIgbmV3LXNlZ21lbnQgY3Jvc3Mtc2Vla2luZyBzaG91bGQgYmUgZHJvcHBlZC5cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FRElBX1NFR01FTlQsIHR5cGUsIG1lZGlhU2VnbWVudCk7XG5cbiAgICAgICAgICAgIC8vIFJlc29sdmUgcGVuZGluZyBzZWVrUG9pbnRcbiAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nUmVzb2x2ZVNlZWtQb2ludCAhPSBudWxsICYmIHR5cGUgPT09ICd2aWRlbycpIHtcbiAgICAgICAgICAgICAgICB2YXIgc3luY1BvaW50cyA9IG1lZGlhU2VnbWVudC5pbmZvLnN5bmNQb2ludHM7XG4gICAgICAgICAgICAgICAgdmFyIHNlZWtwb2ludCA9IHRoaXMuX3BlbmRpbmdSZXNvbHZlU2Vla1BvaW50O1xuICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdSZXNvbHZlU2Vla1BvaW50ID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIC8vIFNhZmFyaTogUGFzcyBQVFMgZm9yIHJlY29tbWVuZF9zZWVrcG9pbnRcbiAgICAgICAgICAgICAgICBpZiAoX2Jyb3dzZXIyLmRlZmF1bHQuc2FmYXJpICYmIHN5bmNQb2ludHMubGVuZ3RoID4gMCAmJiBzeW5jUG9pbnRzWzBdLm9yaWdpbmFsRHRzID09PSBzZWVrcG9pbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2Vla3BvaW50ID0gc3luY1BvaW50c1swXS5wdHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGVsc2U6IHVzZSBvcmlnaW5hbCBEVFMgKGtleWZyYW1lLm1pbGxpc2Vjb25kcylcblxuICAgICAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuUkVDT01NRU5EX1NFRUtQT0lOVCwgc2Vla3BvaW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2VuYWJsZVN0YXRpc3RpY3NSZXBvcnRlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZW5hYmxlU3RhdGlzdGljc1JlcG9ydGVyKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXRpc3RpY3NSZXBvcnRlciA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGlzdGljc1JlcG9ydGVyID0gc2VsZi5zZXRJbnRlcnZhbCh0aGlzLl9yZXBvcnRTdGF0aXN0aWNzSW5mby5iaW5kKHRoaXMpLCB0aGlzLl9jb25maWcuc3RhdGlzdGljc0luZm9SZXBvcnRJbnRlcnZhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19kaXNhYmxlU3RhdGlzdGljc1JlcG9ydGVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9kaXNhYmxlU3RhdGlzdGljc1JlcG9ydGVyKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXRpc3RpY3NSZXBvcnRlcikge1xuICAgICAgICAgICAgICAgIHNlbGYuY2xlYXJJbnRlcnZhbCh0aGlzLl9zdGF0aXN0aWNzUmVwb3J0ZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRpc3RpY3NSZXBvcnRlciA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19yZXBvcnRTZWdtZW50TWVkaWFJbmZvJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9yZXBvcnRTZWdtZW50TWVkaWFJbmZvKHNlZ21lbnRJbmRleCkge1xuICAgICAgICAgICAgdmFyIHNlZ21lbnRJbmZvID0gdGhpcy5fbWVkaWFJbmZvLnNlZ21lbnRzW3NlZ21lbnRJbmRleF07XG4gICAgICAgICAgICB2YXIgZXhwb3J0SW5mbyA9IE9iamVjdC5hc3NpZ24oe30sIHNlZ21lbnRJbmZvKTtcblxuICAgICAgICAgICAgZXhwb3J0SW5mby5kdXJhdGlvbiA9IHRoaXMuX21lZGlhSW5mby5kdXJhdGlvbjtcbiAgICAgICAgICAgIGV4cG9ydEluZm8uc2VnbWVudENvdW50ID0gdGhpcy5fbWVkaWFJbmZvLnNlZ21lbnRDb3VudDtcbiAgICAgICAgICAgIGRlbGV0ZSBleHBvcnRJbmZvLnNlZ21lbnRzO1xuICAgICAgICAgICAgZGVsZXRlIGV4cG9ydEluZm8ua2V5ZnJhbWVzSW5kZXg7XG5cbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVESUFfSU5GTywgZXhwb3J0SW5mbyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19yZXBvcnRTdGF0aXN0aWNzSW5mbycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVwb3J0U3RhdGlzdGljc0luZm8oKSB7XG4gICAgICAgICAgICB2YXIgaW5mbyA9IHt9O1xuXG4gICAgICAgICAgICBpbmZvLnVybCA9IHRoaXMuX2lvY3RsLmN1cnJlbnRVUkw7XG4gICAgICAgICAgICBpbmZvLmhhc1JlZGlyZWN0ID0gdGhpcy5faW9jdGwuaGFzUmVkaXJlY3Q7XG4gICAgICAgICAgICBpZiAoaW5mby5oYXNSZWRpcmVjdCkge1xuICAgICAgICAgICAgICAgIGluZm8ucmVkaXJlY3RlZFVSTCA9IHRoaXMuX2lvY3RsLmN1cnJlbnRSZWRpcmVjdGVkVVJMO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpbmZvLnNwZWVkID0gdGhpcy5faW9jdGwuY3VycmVudFNwZWVkO1xuICAgICAgICAgICAgaW5mby5sb2FkZXJUeXBlID0gdGhpcy5faW9jdGwubG9hZGVyVHlwZTtcbiAgICAgICAgICAgIGluZm8uY3VycmVudFNlZ21lbnRJbmRleCA9IHRoaXMuX2N1cnJlbnRTZWdtZW50SW5kZXg7XG4gICAgICAgICAgICBpbmZvLnRvdGFsU2VnbWVudENvdW50ID0gdGhpcy5fbWVkaWFEYXRhU291cmNlLnNlZ21lbnRzLmxlbmd0aDtcblxuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TVEFUSVNUSUNTX0lORk8sIGluZm8pO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFRyYW5zbXV4aW5nQ29udHJvbGxlcjtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gVHJhbnNtdXhpbmdDb250cm9sbGVyO1xuXG59LHtcIi4uL2RlbXV4L2RlbXV4LWVycm9ycy5qc1wiOjE2LFwiLi4vZGVtdXgvZmx2LWRlbXV4ZXIuanNcIjoxOCxcIi4uL2lvL2lvLWNvbnRyb2xsZXIuanNcIjoyMyxcIi4uL2lvL2xvYWRlci5qc1wiOjI0LFwiLi4vcmVtdXgvbXA0LXJlbXV4ZXIuanNcIjozOCxcIi4uL3V0aWxzL2Jyb3dzZXIuanNcIjozOSxcIi4uL3V0aWxzL2xvZ2dlci5qc1wiOjQxLFwiLi9tZWRpYS1pbmZvLmpzXCI6NyxcIi4vdHJhbnNtdXhpbmctZXZlbnRzLmpzXCI6MTMsXCJldmVudHNcIjoyfV0sMTM6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxudmFyIFRyYW5zbXV4aW5nRXZlbnRzID0ge1xuICBJT19FUlJPUjogJ2lvX2Vycm9yJyxcbiAgREVNVVhfRVJST1I6ICdkZW11eF9lcnJvcicsXG4gIElOSVRfU0VHTUVOVDogJ2luaXRfc2VnbWVudCcsXG4gIE1FRElBX1NFR01FTlQ6ICdtZWRpYV9zZWdtZW50JyxcbiAgTE9BRElOR19DT01QTEVURTogJ2xvYWRpbmdfY29tcGxldGUnLFxuICBSRUNPVkVSRURfRUFSTFlfRU9GOiAncmVjb3ZlcmVkX2Vhcmx5X2VvZicsXG4gIE1FRElBX0lORk86ICdtZWRpYV9pbmZvJyxcbiAgTUVUQURBVEFfQVJSSVZFRDogJ21ldGFkYXRhX2Fycml2ZWQnLFxuICBTQ1JJUFREQVRBX0FSUklWRUQ6ICdzY3JpcHRkYXRhX2Fycml2ZWQnLFxuICBTVEFUSVNUSUNTX0lORk86ICdzdGF0aXN0aWNzX2luZm8nLFxuICBSRUNPTU1FTkRfU0VFS1BPSU5UOiAncmVjb21tZW5kX3NlZWtwb2ludCcsXG4gIFNUUkVBTV9USU1FOiAnc3RyZWFtX3RpbWUnXG59O1xuXG5leHBvcnRzLmRlZmF1bHQgPSBUcmFuc211eGluZ0V2ZW50cztcblxufSx7fV0sMTQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfbG9nZ2VyID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nZ2VyLmpzJyk7XG5cbnZhciBfbG9nZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dlcik7XG5cbnZhciBfbG9nZ2luZ0NvbnRyb2wgPSBfZGVyZXFfKCcuLi91dGlscy9sb2dnaW5nLWNvbnRyb2wuanMnKTtcblxudmFyIF9sb2dnaW5nQ29udHJvbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnaW5nQ29udHJvbCk7XG5cbnZhciBfcG9seWZpbGwgPSBfZGVyZXFfKCcuLi91dGlscy9wb2x5ZmlsbC5qcycpO1xuXG52YXIgX3BvbHlmaWxsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BvbHlmaWxsKTtcblxudmFyIF90cmFuc211eGluZ0NvbnRyb2xsZXIgPSBfZGVyZXFfKCcuL3RyYW5zbXV4aW5nLWNvbnRyb2xsZXIuanMnKTtcblxudmFyIF90cmFuc211eGluZ0NvbnRyb2xsZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHJhbnNtdXhpbmdDb250cm9sbGVyKTtcblxudmFyIF90cmFuc211eGluZ0V2ZW50cyA9IF9kZXJlcV8oJy4vdHJhbnNtdXhpbmctZXZlbnRzLmpzJyk7XG5cbnZhciBfdHJhbnNtdXhpbmdFdmVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHJhbnNtdXhpbmdFdmVudHMpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG4vKiBwb3N0IG1lc3NhZ2UgdG8gd29ya2VyOlxyXG4gICBkYXRhOiB7XHJcbiAgICAgICBjbWQ6IHN0cmluZ1xyXG4gICAgICAgcGFyYW06IGFueVxyXG4gICB9XHJcblxyXG4gICByZWNlaXZlIG1lc3NhZ2UgZnJvbSB3b3JrZXI6XHJcbiAgIGRhdGE6IHtcclxuICAgICAgIG1zZzogc3RyaW5nLFxyXG4gICAgICAgZGF0YTogYW55XHJcbiAgIH1cclxuICovXG5cbnZhciBUcmFuc211eGluZ1dvcmtlciA9IGZ1bmN0aW9uIFRyYW5zbXV4aW5nV29ya2VyKHNlbGYpIHtcblxuICAgIHZhciBUQUcgPSAnVHJhbnNtdXhpbmdXb3JrZXInO1xuICAgIHZhciBjb250cm9sbGVyID0gbnVsbDtcbiAgICB2YXIgbG9nY2F0TGlzdGVuZXIgPSBvbkxvZ2NhdENhbGxiYWNrLmJpbmQodGhpcyk7XG5cbiAgICBfcG9seWZpbGwyLmRlZmF1bHQuaW5zdGFsbCgpO1xuXG4gICAgc2VsZi5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgc3dpdGNoIChlLmRhdGEuY21kKSB7XG4gICAgICAgICAgICBjYXNlICdpbml0JzpcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyID0gbmV3IF90cmFuc211eGluZ0NvbnRyb2xsZXIyLmRlZmF1bHQoZS5kYXRhLnBhcmFtWzBdLCBlLmRhdGEucGFyYW1bMV0pO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LklPX0VSUk9SLCBvbklPRXJyb3IuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuREVNVVhfRVJST1IsIG9uRGVtdXhFcnJvci5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5JTklUX1NFR01FTlQsIG9uSW5pdFNlZ21lbnQuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVESUFfU0VHTUVOVCwgb25NZWRpYVNlZ21lbnQuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTE9BRElOR19DT01QTEVURSwgb25Mb2FkaW5nQ29tcGxldGUuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuUkVDT1ZFUkVEX0VBUkxZX0VPRiwgb25SZWNvdmVyZWRFYXJseUVvZi5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRURJQV9JTkZPLCBvbk1lZGlhSW5mby5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRVRBREFUQV9BUlJJVkVELCBvbk1ldGFEYXRhQXJyaXZlZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TQ1JJUFREQVRBX0FSUklWRUQsIG9uU2NyaXB0RGF0YUFycml2ZWQuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU1RBVElTVElDU19JTkZPLCBvblN0YXRpc3RpY3NJbmZvLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlJFQ09NTUVORF9TRUVLUE9JTlQsIG9uUmVjb21tZW5kU2Vla3BvaW50LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnZGVzdHJveSc6XG4gICAgICAgICAgICAgICAgaWYgKGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHsgbXNnOiAnZGVzdHJveWVkJyB9KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3N0YXJ0JzpcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLnN0YXJ0KCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdzdG9wJzpcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLnN0b3AoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3NlZWsnOlxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuc2VlayhlLmRhdGEucGFyYW0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncGF1c2UnOlxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIucGF1c2UoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3Jlc3VtZSc6XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5yZXN1bWUoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2xvZ2dpbmdfY29uZmlnJzpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb25maWcgPSBlLmRhdGEucGFyYW07XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnaW5nQ29udHJvbDIuZGVmYXVsdC5hcHBseUNvbmZpZyhjb25maWcpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb25maWcuZW5hYmxlQ2FsbGJhY2sgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2dnaW5nQ29udHJvbDIuZGVmYXVsdC5hZGRMb2dMaXN0ZW5lcihsb2djYXRMaXN0ZW5lcik7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfbG9nZ2luZ0NvbnRyb2wyLmRlZmF1bHQucmVtb3ZlTG9nTGlzdGVuZXIobG9nY2F0TGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gb25Jbml0U2VnbWVudCh0eXBlLCBpbml0U2VnbWVudCkge1xuICAgICAgICB2YXIgb2JqID0ge1xuICAgICAgICAgICAgbXNnOiBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuSU5JVF9TRUdNRU5ULFxuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgICAgICAgZGF0YTogaW5pdFNlZ21lbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZShvYmosIFtpbml0U2VnbWVudC5kYXRhXSk7IC8vIGRhdGE6IEFycmF5QnVmZmVyXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25NZWRpYVNlZ21lbnQodHlwZSwgbWVkaWFTZWdtZW50KSB7XG4gICAgICAgIHZhciBvYmogPSB7XG4gICAgICAgICAgICBtc2c6IF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRURJQV9TRUdNRU5ULFxuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgICAgICAgZGF0YTogbWVkaWFTZWdtZW50XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHNlbGYucG9zdE1lc3NhZ2Uob2JqLCBbbWVkaWFTZWdtZW50LmRhdGFdKTsgLy8gZGF0YTogQXJyYXlCdWZmZXJcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbkxvYWRpbmdDb21wbGV0ZSgpIHtcbiAgICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAgICAgIG1zZzogX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LkxPQURJTkdfQ09NUExFVEVcbiAgICAgICAgfTtcbiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZShvYmopO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uUmVjb3ZlcmVkRWFybHlFb2YoKSB7XG4gICAgICAgIHZhciBvYmogPSB7XG4gICAgICAgICAgICBtc2c6IF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5SRUNPVkVSRURfRUFSTFlfRU9GXG4gICAgICAgIH07XG4gICAgICAgIHNlbGYucG9zdE1lc3NhZ2Uob2JqKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbk1lZGlhSW5mbyhtZWRpYUluZm8pIHtcbiAgICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAgICAgIG1zZzogX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FRElBX0lORk8sXG4gICAgICAgICAgICBkYXRhOiBtZWRpYUluZm9cbiAgICAgICAgfTtcbiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZShvYmopO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uTWV0YURhdGFBcnJpdmVkKG1ldGFkYXRhKSB7XG4gICAgICAgIHZhciBvYmogPSB7XG4gICAgICAgICAgICBtc2c6IF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRVRBREFUQV9BUlJJVkVELFxuICAgICAgICAgICAgZGF0YTogbWV0YWRhdGFcbiAgICAgICAgfTtcbiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZShvYmopO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uU2NyaXB0RGF0YUFycml2ZWQoZGF0YSkge1xuICAgICAgICB2YXIgb2JqID0ge1xuICAgICAgICAgICAgbXNnOiBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU0NSSVBUREFUQV9BUlJJVkVELFxuICAgICAgICAgICAgZGF0YTogZGF0YVxuICAgICAgICB9O1xuICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKG9iaik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25TdGF0aXN0aWNzSW5mbyhzdGF0SW5mbykge1xuICAgICAgICB2YXIgb2JqID0ge1xuICAgICAgICAgICAgbXNnOiBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU1RBVElTVElDU19JTkZPLFxuICAgICAgICAgICAgZGF0YTogc3RhdEluZm9cbiAgICAgICAgfTtcbiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZShvYmopO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uSU9FcnJvcih0eXBlLCBpbmZvKSB7XG4gICAgICAgIHNlbGYucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgbXNnOiBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuSU9fRVJST1IsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgICAgICBpbmZvOiBpbmZvXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uRGVtdXhFcnJvcih0eXBlLCBpbmZvKSB7XG4gICAgICAgIHNlbGYucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgbXNnOiBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuREVNVVhfRVJST1IsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgICAgICBpbmZvOiBpbmZvXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uUmVjb21tZW5kU2Vla3BvaW50KG1pbGxpc2Vjb25kcykge1xuICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgIG1zZzogX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlJFQ09NTUVORF9TRUVLUE9JTlQsXG4gICAgICAgICAgICBkYXRhOiBtaWxsaXNlY29uZHNcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25Mb2djYXRDYWxsYmFjayh0eXBlLCBzdHIpIHtcbiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICBtc2c6ICdsb2djYXRfY2FsbGJhY2snLFxuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgICAgICAgbG9nY2F0OiBzdHJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxufTsgLypcclxuICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgKlxyXG4gICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAqXHJcbiAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAqXHJcbiAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICpcclxuICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgKi9cblxuZXhwb3J0cy5kZWZhdWx0ID0gVHJhbnNtdXhpbmdXb3JrZXI7XG5cbn0se1wiLi4vdXRpbHMvbG9nZ2VyLmpzXCI6NDEsXCIuLi91dGlscy9sb2dnaW5nLWNvbnRyb2wuanNcIjo0MixcIi4uL3V0aWxzL3BvbHlmaWxsLmpzXCI6NDMsXCIuL3RyYW5zbXV4aW5nLWNvbnRyb2xsZXIuanNcIjoxMixcIi4vdHJhbnNtdXhpbmctZXZlbnRzLmpzXCI6MTN9XSwxNTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfbG9nZ2VyID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nZ2VyLmpzJyk7XG5cbnZhciBfbG9nZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dlcik7XG5cbnZhciBfdXRmOENvbnYgPSBfZGVyZXFfKCcuLi91dGlscy91dGY4LWNvbnYuanMnKTtcblxudmFyIF91dGY4Q29udjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF91dGY4Q29udik7XG5cbnZhciBfZXhjZXB0aW9uID0gX2RlcmVxXygnLi4vdXRpbHMvZXhjZXB0aW9uLmpzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYnVmID0gbmV3IEFycmF5QnVmZmVyKDIpO1xuICAgIG5ldyBEYXRhVmlldyhidWYpLnNldEludDE2KDAsIDI1NiwgdHJ1ZSk7IC8vIGxpdHRsZS1lbmRpYW4gd3JpdGVcbiAgICByZXR1cm4gbmV3IEludDE2QXJyYXkoYnVmKVswXSA9PT0gMjU2OyAvLyBwbGF0Zm9ybS1zcGVjIHJlYWQsIGlmIGVxdWFsIHRoZW4gTEVcbn0oKTtcblxudmFyIEFNRiA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBBTUYoKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBTUYpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhBTUYsIG51bGwsIFt7XG4gICAgICAgIGtleTogJ3BhcnNlU2NyaXB0RGF0YScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXJzZVNjcmlwdERhdGEoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHt9O1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBuYW1lID0gQU1GLnBhcnNlVmFsdWUoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKTtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBBTUYucGFyc2VWYWx1ZShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIG5hbWUuc2l6ZSwgZGF0YVNpemUgLSBuYW1lLnNpemUpO1xuXG4gICAgICAgICAgICAgICAgZGF0YVtuYW1lLmRhdGFdID0gdmFsdWUuZGF0YTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmUoJ0FNRicsIGUudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwYXJzZU9iamVjdCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXJzZU9iamVjdChhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpIHtcbiAgICAgICAgICAgIGlmIChkYXRhU2l6ZSA8IDMpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbGxlZ2FsU3RhdGVFeGNlcHRpb24oJ0RhdGEgbm90IGVub3VnaCB3aGVuIHBhcnNlIFNjcmlwdERhdGFPYmplY3QnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBuYW1lID0gQU1GLnBhcnNlU3RyaW5nKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSk7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBBTUYucGFyc2VWYWx1ZShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIG5hbWUuc2l6ZSwgZGF0YVNpemUgLSBuYW1lLnNpemUpO1xuICAgICAgICAgICAgdmFyIGlzT2JqZWN0RW5kID0gdmFsdWUub2JqZWN0RW5kO1xuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZS5kYXRhLFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdmFsdWUuZGF0YVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2l6ZTogbmFtZS5zaXplICsgdmFsdWUuc2l6ZSxcbiAgICAgICAgICAgICAgICBvYmplY3RFbmQ6IGlzT2JqZWN0RW5kXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwYXJzZVZhcmlhYmxlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBhcnNlVmFyaWFibGUoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKSB7XG4gICAgICAgICAgICByZXR1cm4gQU1GLnBhcnNlT2JqZWN0KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3BhcnNlU3RyaW5nJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBhcnNlU3RyaW5nKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSkge1xuICAgICAgICAgICAgaWYgKGRhdGFTaXplIDwgMikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbignRGF0YSBub3QgZW5vdWdoIHdoZW4gcGFyc2UgU3RyaW5nJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdiA9IG5ldyBEYXRhVmlldyhhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpO1xuICAgICAgICAgICAgdmFyIGxlbmd0aCA9IHYuZ2V0VWludDE2KDAsICFsZSk7XG5cbiAgICAgICAgICAgIHZhciBzdHIgPSB2b2lkIDA7XG4gICAgICAgICAgICBpZiAobGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHN0ciA9ICgwLCBfdXRmOENvbnYyLmRlZmF1bHQpKG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgMiwgbGVuZ3RoKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHN0ciA9ICcnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGRhdGE6IHN0cixcbiAgICAgICAgICAgICAgICBzaXplOiAyICsgbGVuZ3RoXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwYXJzZUxvbmdTdHJpbmcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGFyc2VMb25nU3RyaW5nKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSkge1xuICAgICAgICAgICAgaWYgKGRhdGFTaXplIDwgNCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbignRGF0YSBub3QgZW5vdWdoIHdoZW4gcGFyc2UgTG9uZ1N0cmluZycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHYgPSBuZXcgRGF0YVZpZXcoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKTtcbiAgICAgICAgICAgIHZhciBsZW5ndGggPSB2LmdldFVpbnQzMigwLCAhbGUpO1xuXG4gICAgICAgICAgICB2YXIgc3RyID0gdm9pZCAwO1xuICAgICAgICAgICAgaWYgKGxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBzdHIgPSAoMCwgX3V0ZjhDb252Mi5kZWZhdWx0KShuZXcgVWludDhBcnJheShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIDQsIGxlbmd0aCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdHIgPSAnJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkYXRhOiBzdHIsXG4gICAgICAgICAgICAgICAgc2l6ZTogNCArIGxlbmd0aFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncGFyc2VEYXRlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBhcnNlRGF0ZShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpIHtcbiAgICAgICAgICAgIGlmIChkYXRhU2l6ZSA8IDEwKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCdEYXRhIHNpemUgaW52YWxpZCB3aGVuIHBhcnNlIERhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2ID0gbmV3IERhdGFWaWV3KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSk7XG4gICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gdi5nZXRGbG9hdDY0KDAsICFsZSk7XG4gICAgICAgICAgICB2YXIgbG9jYWxUaW1lT2Zmc2V0ID0gdi5nZXRJbnQxNig4LCAhbGUpO1xuICAgICAgICAgICAgdGltZXN0YW1wICs9IGxvY2FsVGltZU9mZnNldCAqIDYwICogMTAwMDsgLy8gZ2V0IFVUQyB0aW1lXG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZGF0YTogbmV3IERhdGUodGltZXN0YW1wKSxcbiAgICAgICAgICAgICAgICBzaXplOiA4ICsgMlxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncGFyc2VWYWx1ZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXJzZVZhbHVlKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSkge1xuICAgICAgICAgICAgaWYgKGRhdGFTaXplIDwgMSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbignRGF0YSBub3QgZW5vdWdoIHdoZW4gcGFyc2UgVmFsdWUnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHYgPSBuZXcgRGF0YVZpZXcoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKTtcblxuICAgICAgICAgICAgdmFyIG9mZnNldCA9IDE7XG4gICAgICAgICAgICB2YXIgdHlwZSA9IHYuZ2V0VWludDgoMCk7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB2b2lkIDA7XG4gICAgICAgICAgICB2YXIgb2JqZWN0RW5kID0gZmFsc2U7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE51bWJlcihEb3VibGUpIHR5cGVcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdi5nZXRGbG9hdDY0KDEsICFsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gODtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQm9vbGVhbiB0eXBlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSB2LmdldFVpbnQ4KDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gYiA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0cmluZyB0eXBlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFtZnN0ciA9IEFNRi5wYXJzZVN0cmluZyhhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIDEsIGRhdGFTaXplIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBhbWZzdHIuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gYW1mc3RyLnNpemU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPYmplY3QocykgdHlwZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm1pbmFsID0gMDsgLy8gd29ya2Fyb3VuZCBmb3IgbWFsZm9ybWVkIE9iamVjdHMgd2hpY2ggaGFzIG1pc3NpbmcgU2NyaXB0RGF0YU9iamVjdEVuZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodi5nZXRVaW50MzIoZGF0YVNpemUgLSA0LCAhbGUpICYgMHgwMEZGRkZGRikgPT09IDkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVybWluYWwgPSAzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAob2Zmc2V0IDwgZGF0YVNpemUgLSA0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDQgPT09IHR5cGUoVUk4KSArIFNjcmlwdERhdGFPYmplY3RFbmQoVUkyNClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFtZm9iaiA9IEFNRi5wYXJzZU9iamVjdChhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIG9mZnNldCwgZGF0YVNpemUgLSBvZmZzZXQgLSB0ZXJtaW5hbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbWZvYmoub2JqZWN0RW5kKSBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVbYW1mb2JqLmRhdGEubmFtZV0gPSBhbWZvYmouZGF0YS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IGFtZm9iai5zaXplO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob2Zmc2V0IDw9IGRhdGFTaXplIC0gMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyID0gdi5nZXRVaW50MzIob2Zmc2V0IC0gMSwgIWxlKSAmIDB4MDBGRkZGRkY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtYXJrZXIgPT09IDkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSAzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRUNNQSBhcnJheSB0eXBlIChNaXhlZCBhcnJheSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSA0OyAvLyBFQ01BQXJyYXlMZW5ndGgoVUkzMilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3Rlcm1pbmFsID0gMDsgLy8gd29ya2Fyb3VuZCBmb3IgbWFsZm9ybWVkIE1peGVkQXJyYXlzIHdoaWNoIGhhcyBtaXNzaW5nIFNjcmlwdERhdGFPYmplY3RFbmRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHYuZ2V0VWludDMyKGRhdGFTaXplIC0gNCwgIWxlKSAmIDB4MDBGRkZGRkYpID09PSA5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90ZXJtaW5hbCA9IDM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChvZmZzZXQgPCBkYXRhU2l6ZSAtIDgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gOCA9PT0gdHlwZShVSTgpICsgRUNNQUFycmF5TGVuZ3RoKFVJMzIpICsgU2NyaXB0RGF0YVZhcmlhYmxlRW5kKFVJMjQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbWZ2YXIgPSBBTUYucGFyc2VWYXJpYWJsZShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIG9mZnNldCwgZGF0YVNpemUgLSBvZmZzZXQgLSBfdGVybWluYWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW1mdmFyLm9iamVjdEVuZCkgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlW2FtZnZhci5kYXRhLm5hbWVdID0gYW1mdmFyLmRhdGEudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSBhbWZ2YXIuc2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9mZnNldCA8PSBkYXRhU2l6ZSAtIDMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9tYXJrZXIgPSB2LmdldFVpbnQzMihvZmZzZXQgLSAxLCAhbGUpICYgMHgwMEZGRkZGRjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9tYXJrZXIgPT09IDkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSAzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTY3JpcHREYXRhT2JqZWN0RW5kXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RFbmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RyaWN0IGFycmF5IHR5cGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTY3JpcHREYXRhVmFsdWVbbl0uIE5PVEU6IGFjY29yZGluZyB0byB2aWRlb19maWxlX2Zvcm1hdF9zcGVjX3YxMF8xLnBkZlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0cmljdEFycmF5TGVuZ3RoID0gdi5nZXRVaW50MzIoMSwgIWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gNDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0cmljdEFycmF5TGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbCA9IEFNRi5wYXJzZVZhbHVlKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgb2Zmc2V0LCBkYXRhU2l6ZSAtIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlLnB1c2godmFsLmRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gdmFsLnNpemU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXNlIDExOlxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIERhdGUgdHlwZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRlID0gQU1GLnBhcnNlRGF0ZShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIDEsIGRhdGFTaXplIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBkYXRlLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IGRhdGUuc2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBMb25nIHN0cmluZyB0eXBlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFtZkxvbmdTdHIgPSBBTUYucGFyc2VTdHJpbmcoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyAxLCBkYXRhU2l6ZSAtIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gYW1mTG9uZ1N0ci5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSBhbWZMb25nU3RyLnNpemU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBpZ25vcmUgYW5kIHNraXBcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IGRhdGFTaXplO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KCdBTUYnLCAnVW5zdXBwb3J0ZWQgQU1GIHZhbHVlIHR5cGUgJyArIHR5cGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmUoJ0FNRicsIGUudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZGF0YTogdmFsdWUsXG4gICAgICAgICAgICAgICAgc2l6ZTogb2Zmc2V0LFxuICAgICAgICAgICAgICAgIG9iamVjdEVuZDogb2JqZWN0RW5kXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIEFNRjtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gQU1GO1xuXG59LHtcIi4uL3V0aWxzL2V4Y2VwdGlvbi5qc1wiOjQwLFwiLi4vdXRpbHMvbG9nZ2VyLmpzXCI6NDEsXCIuLi91dGlscy91dGY4LWNvbnYuanNcIjo0NH1dLDE2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbnZhciBEZW11eEVycm9ycyA9IHtcbiAgT0s6ICdPSycsXG4gIEZPUk1BVF9FUlJPUjogJ0Zvcm1hdEVycm9yJyxcbiAgRk9STUFUX1VOU1VQUE9SVEVEOiAnRm9ybWF0VW5zdXBwb3J0ZWQnLFxuICBDT0RFQ19VTlNVUFBPUlRFRDogJ0NvZGVjVW5zdXBwb3J0ZWQnXG59O1xuXG5leHBvcnRzLmRlZmF1bHQgPSBEZW11eEVycm9ycztcblxufSx7fV0sMTc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgX2V4Y2VwdGlvbiA9IF9kZXJlcV8oJy4uL3V0aWxzL2V4Y2VwdGlvbi5qcycpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vLyBFeHBvbmVudGlhbC1Hb2xvbWIgYnVmZmVyIGRlY29kZXJcbnZhciBFeHBHb2xvbWIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRXhwR29sb21iKHVpbnQ4YXJyYXkpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEV4cEdvbG9tYik7XG5cbiAgICAgICAgdGhpcy5UQUcgPSAnRXhwR29sb21iJztcblxuICAgICAgICB0aGlzLl9idWZmZXIgPSB1aW50OGFycmF5O1xuICAgICAgICB0aGlzLl9idWZmZXJfaW5kZXggPSAwO1xuICAgICAgICB0aGlzLl90b3RhbF9ieXRlcyA9IHVpbnQ4YXJyYXkuYnl0ZUxlbmd0aDtcbiAgICAgICAgdGhpcy5fdG90YWxfYml0cyA9IHVpbnQ4YXJyYXkuYnl0ZUxlbmd0aCAqIDg7XG4gICAgICAgIHRoaXMuX2N1cnJlbnRfd29yZCA9IDA7XG4gICAgICAgIHRoaXMuX2N1cnJlbnRfd29yZF9iaXRzX2xlZnQgPSAwO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhFeHBHb2xvbWIsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIHRoaXMuX2J1ZmZlciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19maWxsQ3VycmVudFdvcmQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2ZpbGxDdXJyZW50V29yZCgpIHtcbiAgICAgICAgICAgIHZhciBidWZmZXJfYnl0ZXNfbGVmdCA9IHRoaXMuX3RvdGFsX2J5dGVzIC0gdGhpcy5fYnVmZmVyX2luZGV4O1xuICAgICAgICAgICAgaWYgKGJ1ZmZlcl9ieXRlc19sZWZ0IDw9IDApIHRocm93IG5ldyBfZXhjZXB0aW9uLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbignRXhwR29sb21iOiBfZmlsbEN1cnJlbnRXb3JkKCkgYnV0IG5vIGJ5dGVzIGF2YWlsYWJsZScpO1xuXG4gICAgICAgICAgICB2YXIgYnl0ZXNfcmVhZCA9IE1hdGgubWluKDQsIGJ1ZmZlcl9ieXRlc19sZWZ0KTtcbiAgICAgICAgICAgIHZhciB3b3JkID0gbmV3IFVpbnQ4QXJyYXkoNCk7XG4gICAgICAgICAgICB3b3JkLnNldCh0aGlzLl9idWZmZXIuc3ViYXJyYXkodGhpcy5fYnVmZmVyX2luZGV4LCB0aGlzLl9idWZmZXJfaW5kZXggKyBieXRlc19yZWFkKSk7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50X3dvcmQgPSBuZXcgRGF0YVZpZXcod29yZC5idWZmZXIpLmdldFVpbnQzMigwLCBmYWxzZSk7XG5cbiAgICAgICAgICAgIHRoaXMuX2J1ZmZlcl9pbmRleCArPSBieXRlc19yZWFkO1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudF93b3JkX2JpdHNfbGVmdCA9IGJ5dGVzX3JlYWQgKiA4O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZWFkQml0cycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWFkQml0cyhiaXRzKSB7XG4gICAgICAgICAgICBpZiAoYml0cyA+IDMyKSB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbnZhbGlkQXJndW1lbnRFeGNlcHRpb24oJ0V4cEdvbG9tYjogcmVhZEJpdHMoKSBiaXRzIGV4Y2VlZGVkIG1heCAzMmJpdHMhJyk7XG5cbiAgICAgICAgICAgIGlmIChiaXRzIDw9IHRoaXMuX2N1cnJlbnRfd29yZF9iaXRzX2xlZnQpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3Jlc3VsdCA9IHRoaXMuX2N1cnJlbnRfd29yZCA+Pj4gMzIgLSBiaXRzO1xuICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRfd29yZCA8PD0gYml0cztcbiAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50X3dvcmRfYml0c19sZWZ0IC09IGJpdHM7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF9yZXN1bHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLl9jdXJyZW50X3dvcmRfYml0c19sZWZ0ID8gdGhpcy5fY3VycmVudF93b3JkIDogMDtcbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdCA+Pj4gMzIgLSB0aGlzLl9jdXJyZW50X3dvcmRfYml0c19sZWZ0O1xuICAgICAgICAgICAgdmFyIGJpdHNfbmVlZF9sZWZ0ID0gYml0cyAtIHRoaXMuX2N1cnJlbnRfd29yZF9iaXRzX2xlZnQ7XG5cbiAgICAgICAgICAgIHRoaXMuX2ZpbGxDdXJyZW50V29yZCgpO1xuICAgICAgICAgICAgdmFyIGJpdHNfcmVhZF9uZXh0ID0gTWF0aC5taW4oYml0c19uZWVkX2xlZnQsIHRoaXMuX2N1cnJlbnRfd29yZF9iaXRzX2xlZnQpO1xuXG4gICAgICAgICAgICB2YXIgcmVzdWx0MiA9IHRoaXMuX2N1cnJlbnRfd29yZCA+Pj4gMzIgLSBiaXRzX3JlYWRfbmV4dDtcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRfd29yZCA8PD0gYml0c19yZWFkX25leHQ7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50X3dvcmRfYml0c19sZWZ0IC09IGJpdHNfcmVhZF9uZXh0O1xuXG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQgPDwgYml0c19yZWFkX25leHQgfCByZXN1bHQyO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVhZEJvb2wnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVhZEJvb2woKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZWFkQml0cygxKSA9PT0gMTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVhZEJ5dGUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVhZEJ5dGUoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZWFkQml0cyg4KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3NraXBMZWFkaW5nWmVybycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfc2tpcExlYWRpbmdaZXJvKCkge1xuICAgICAgICAgICAgdmFyIHplcm9fY291bnQgPSB2b2lkIDA7XG4gICAgICAgICAgICBmb3IgKHplcm9fY291bnQgPSAwOyB6ZXJvX2NvdW50IDwgdGhpcy5fY3VycmVudF93b3JkX2JpdHNfbGVmdDsgemVyb19jb3VudCsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKDAgIT09ICh0aGlzLl9jdXJyZW50X3dvcmQgJiAweDgwMDAwMDAwID4+PiB6ZXJvX2NvdW50KSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50X3dvcmQgPDw9IHplcm9fY291bnQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRfd29yZF9iaXRzX2xlZnQgLT0gemVyb19jb3VudDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHplcm9fY291bnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fZmlsbEN1cnJlbnRXb3JkKCk7XG4gICAgICAgICAgICByZXR1cm4gemVyb19jb3VudCArIHRoaXMuX3NraXBMZWFkaW5nWmVybygpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZWFkVUVHJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlYWRVRUcoKSB7XG4gICAgICAgICAgICAvLyB1bnNpZ25lZCBleHBvbmVudGlhbCBnb2xvbWJcbiAgICAgICAgICAgIHZhciBsZWFkaW5nX3plcm9zID0gdGhpcy5fc2tpcExlYWRpbmdaZXJvKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZWFkQml0cyhsZWFkaW5nX3plcm9zICsgMSkgLSAxO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZWFkU0VHJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlYWRTRUcoKSB7XG4gICAgICAgICAgICAvLyBzaWduZWQgZXhwb25lbnRpYWwgZ29sb21iXG4gICAgICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLnJlYWRVRUcoKTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSAmIDB4MDEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUgKyAxID4+PiAxO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTEgKiAodmFsdWUgPj4+IDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIEV4cEdvbG9tYjtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gRXhwR29sb21iO1xuXG59LHtcIi4uL3V0aWxzL2V4Y2VwdGlvbi5qc1wiOjQwfV0sMTg6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfbG9nZ2VyID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nZ2VyLmpzJyk7XG5cbnZhciBfbG9nZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dlcik7XG5cbnZhciBfYW1mUGFyc2VyID0gX2RlcmVxXygnLi9hbWYtcGFyc2VyLmpzJyk7XG5cbnZhciBfYW1mUGFyc2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2FtZlBhcnNlcik7XG5cbnZhciBfc3BzUGFyc2VyID0gX2RlcmVxXygnLi9zcHMtcGFyc2VyLmpzJyk7XG5cbnZhciBfc3BzUGFyc2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3Nwc1BhcnNlcik7XG5cbnZhciBfZGVtdXhFcnJvcnMgPSBfZGVyZXFfKCcuL2RlbXV4LWVycm9ycy5qcycpO1xuXG52YXIgX2RlbXV4RXJyb3JzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RlbXV4RXJyb3JzKTtcblxudmFyIF9tZWRpYUluZm8gPSBfZGVyZXFfKCcuLi9jb3JlL21lZGlhLWluZm8uanMnKTtcblxudmFyIF9tZWRpYUluZm8yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbWVkaWFJbmZvKTtcblxudmFyIF9leGNlcHRpb24gPSBfZGVyZXFfKCcuLi91dGlscy9leGNlcHRpb24uanMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gU3dhcDE2KHNyYykge1xuICAgIHJldHVybiBzcmMgPj4+IDggJiAweEZGIHwgKHNyYyAmIDB4RkYpIDw8IDg7XG59XG5cbmZ1bmN0aW9uIFN3YXAzMihzcmMpIHtcbiAgICByZXR1cm4gKHNyYyAmIDB4RkYwMDAwMDApID4+PiAyNCB8IChzcmMgJiAweDAwRkYwMDAwKSA+Pj4gOCB8IChzcmMgJiAweDAwMDBGRjAwKSA8PCA4IHwgKHNyYyAmIDB4MDAwMDAwRkYpIDw8IDI0O1xufVxuXG5mdW5jdGlvbiBSZWFkQmlnMzIoYXJyYXksIGluZGV4KSB7XG4gICAgcmV0dXJuIGFycmF5W2luZGV4XSA8PCAyNCB8IGFycmF5W2luZGV4ICsgMV0gPDwgMTYgfCBhcnJheVtpbmRleCArIDJdIDw8IDggfCBhcnJheVtpbmRleCArIDNdO1xufVxuXG52YXIgRkxWRGVtdXhlciA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGTFZEZW11eGVyKHByb2JlRGF0YSwgY29uZmlnKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBGTFZEZW11eGVyKTtcblxuICAgICAgICB0aGlzLlRBRyA9ICdGTFZEZW11eGVyJztcblxuICAgICAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XG5cbiAgICAgICAgdGhpcy5fb25FcnJvciA9IG51bGw7XG4gICAgICAgIHRoaXMuX29uTWVkaWFJbmZvID0gbnVsbDtcbiAgICAgICAgdGhpcy5fb25NZXRhRGF0YUFycml2ZWQgPSBudWxsO1xuICAgICAgICB0aGlzLl9vblNjcmlwdERhdGFBcnJpdmVkID0gbnVsbDtcbiAgICAgICAgdGhpcy5fb25UcmFja01ldGFkYXRhID0gbnVsbDtcbiAgICAgICAgdGhpcy5fb25EYXRhQXZhaWxhYmxlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fb25TdHJlYW1UaW1lID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9kYXRhT2Zmc2V0ID0gcHJvYmVEYXRhLmRhdGFPZmZzZXQ7XG4gICAgICAgIHRoaXMuX2ZpcnN0UGFyc2UgPSB0cnVlO1xuICAgICAgICB0aGlzLl9kaXNwYXRjaCA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuX2hhc0F1ZGlvID0gcHJvYmVEYXRhLmhhc0F1ZGlvVHJhY2s7XG4gICAgICAgIHRoaXMuX2hhc1ZpZGVvID0gcHJvYmVEYXRhLmhhc1ZpZGVvVHJhY2s7XG5cbiAgICAgICAgdGhpcy5faGFzQXVkaW9GbGFnT3ZlcnJpZGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2hhc1ZpZGVvRmxhZ092ZXJyaWRlZCA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuX2F1ZGlvSW5pdGlhbE1ldGFkYXRhRGlzcGF0Y2hlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl92aWRlb0luaXRpYWxNZXRhZGF0YURpc3BhdGNoZWQgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLl9tZWRpYUluZm8gPSBuZXcgX21lZGlhSW5mbzIuZGVmYXVsdCgpO1xuICAgICAgICB0aGlzLl9tZWRpYUluZm8uaGFzQXVkaW8gPSB0aGlzLl9oYXNBdWRpbztcbiAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmhhc1ZpZGVvID0gdGhpcy5faGFzVmlkZW87XG4gICAgICAgIHRoaXMuX21ldGFkYXRhID0gbnVsbDtcbiAgICAgICAgdGhpcy5fYXVkaW9NZXRhZGF0YSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3ZpZGVvTWV0YWRhdGEgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuX25hbHVMZW5ndGhTaXplID0gNDtcbiAgICAgICAgdGhpcy5fdGltZXN0YW1wQmFzZSA9IDA7IC8vIGludDMyLCBpbiBtaWxsaXNlY29uZHNcbiAgICAgICAgdGhpcy5fdGltZXNjYWxlID0gMTAwMDtcbiAgICAgICAgdGhpcy5fZHVyYXRpb24gPSAwOyAvLyBpbnQzMiwgaW4gbWlsbGlzZWNvbmRzXG4gICAgICAgIHRoaXMuX2R1cmF0aW9uT3ZlcnJpZGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3JlZmVyZW5jZUZyYW1lUmF0ZSA9IHtcbiAgICAgICAgICAgIGZpeGVkOiB0cnVlLFxuICAgICAgICAgICAgZnBzOiAyMy45NzYsXG4gICAgICAgICAgICBmcHNfbnVtOiAyMzk3NixcbiAgICAgICAgICAgIGZwc19kZW46IDEwMDBcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLl9mbHZTb3VuZFJhdGVUYWJsZSA9IFs1NTAwLCAxMTAyNSwgMjIwNTAsIDQ0MTAwLCA0ODAwMF07XG5cbiAgICAgICAgdGhpcy5fbXBlZ1NhbXBsaW5nUmF0ZXMgPSBbOTYwMDAsIDg4MjAwLCA2NDAwMCwgNDgwMDAsIDQ0MTAwLCAzMjAwMCwgMjQwMDAsIDIyMDUwLCAxNjAwMCwgMTIwMDAsIDExMDI1LCA4MDAwLCA3MzUwXTtcblxuICAgICAgICB0aGlzLl9tcGVnQXVkaW9WMTBTYW1wbGVSYXRlVGFibGUgPSBbNDQxMDAsIDQ4MDAwLCAzMjAwMCwgMF07XG4gICAgICAgIHRoaXMuX21wZWdBdWRpb1YyMFNhbXBsZVJhdGVUYWJsZSA9IFsyMjA1MCwgMjQwMDAsIDE2MDAwLCAwXTtcbiAgICAgICAgdGhpcy5fbXBlZ0F1ZGlvVjI1U2FtcGxlUmF0ZVRhYmxlID0gWzExMDI1LCAxMjAwMCwgODAwMCwgMF07XG5cbiAgICAgICAgdGhpcy5fbXBlZ0F1ZGlvTDFCaXRSYXRlVGFibGUgPSBbMCwgMzIsIDY0LCA5NiwgMTI4LCAxNjAsIDE5MiwgMjI0LCAyNTYsIDI4OCwgMzIwLCAzNTIsIDM4NCwgNDE2LCA0NDgsIC0xXTtcbiAgICAgICAgdGhpcy5fbXBlZ0F1ZGlvTDJCaXRSYXRlVGFibGUgPSBbMCwgMzIsIDQ4LCA1NiwgNjQsIDgwLCA5NiwgMTEyLCAxMjgsIDE2MCwgMTkyLCAyMjQsIDI1NiwgMzIwLCAzODQsIC0xXTtcbiAgICAgICAgdGhpcy5fbXBlZ0F1ZGlvTDNCaXRSYXRlVGFibGUgPSBbMCwgMzIsIDQwLCA0OCwgNTYsIDY0LCA4MCwgOTYsIDExMiwgMTI4LCAxNjAsIDE5MiwgMjI0LCAyNTYsIDMyMCwgLTFdO1xuXG4gICAgICAgIHRoaXMuX3ZpZGVvVHJhY2sgPSB7IHR5cGU6ICd2aWRlbycsIGlkOiAxLCBzZXF1ZW5jZU51bWJlcjogMCwgc2FtcGxlczogW10sIGxlbmd0aDogMCB9O1xuICAgICAgICB0aGlzLl9hdWRpb1RyYWNrID0geyB0eXBlOiAnYXVkaW8nLCBpZDogMiwgc2VxdWVuY2VOdW1iZXI6IDAsIHNhbXBsZXM6IFtdLCBsZW5ndGg6IDAgfTtcblxuICAgICAgICB0aGlzLl9saXR0bGVFbmRpYW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgYnVmID0gbmV3IEFycmF5QnVmZmVyKDIpO1xuICAgICAgICAgICAgbmV3IERhdGFWaWV3KGJ1Zikuc2V0SW50MTYoMCwgMjU2LCB0cnVlKTsgLy8gbGl0dGxlLWVuZGlhbiB3cml0ZVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBJbnQxNkFycmF5KGJ1ZilbMF0gPT09IDI1NjsgLy8gcGxhdGZvcm0tc3BlYyByZWFkLCBpZiBlcXVhbCB0aGVuIExFXG4gICAgICAgIH0oKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoRkxWRGVtdXhlciwgW3tcbiAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX21ldGFkYXRhID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX2F1ZGlvTWV0YWRhdGEgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fdmlkZW9NZXRhZGF0YSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl92aWRlb1RyYWNrID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX2F1ZGlvVHJhY2sgPSBudWxsO1xuXG4gICAgICAgICAgICB0aGlzLl9vbkVycm9yID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uTWVkaWFJbmZvID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uTWV0YURhdGFBcnJpdmVkID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uU2NyaXB0RGF0YUFycml2ZWQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25UcmFja01ldGFkYXRhID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uRGF0YUF2YWlsYWJsZSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vblN0cmVhbVRpbWUgPSBudWxsO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdiaW5kRGF0YVNvdXJjZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBiaW5kRGF0YVNvdXJjZShsb2FkZXIpIHtcbiAgICAgICAgICAgIGxvYWRlci5vbkRhdGFBcnJpdmFsID0gdGhpcy5wYXJzZUNodW5rcy5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBwcm90b3R5cGU6IGZ1bmN0aW9uKHR5cGU6IHN0cmluZywgbWV0YWRhdGE6IGFueSk6IHZvaWRcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVzZXRNZWRpYUluZm8nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVzZXRNZWRpYUluZm8oKSB7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8gPSBuZXcgX21lZGlhSW5mbzIuZGVmYXVsdCgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfaXNJbml0aWFsTWV0YWRhdGFEaXNwYXRjaGVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9pc0luaXRpYWxNZXRhZGF0YURpc3BhdGNoZWQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5faGFzQXVkaW8gJiYgdGhpcy5faGFzVmlkZW8pIHtcbiAgICAgICAgICAgICAgICAvLyBib3RoIGF1ZGlvICYgdmlkZW9cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYXVkaW9Jbml0aWFsTWV0YWRhdGFEaXNwYXRjaGVkICYmIHRoaXMuX3ZpZGVvSW5pdGlhbE1ldGFkYXRhRGlzcGF0Y2hlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9oYXNBdWRpbyAmJiAhdGhpcy5faGFzVmlkZW8pIHtcbiAgICAgICAgICAgICAgICAvLyBhdWRpbyBvbmx5XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2F1ZGlvSW5pdGlhbE1ldGFkYXRhRGlzcGF0Y2hlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGhpcy5faGFzQXVkaW8gJiYgdGhpcy5faGFzVmlkZW8pIHtcbiAgICAgICAgICAgICAgICAvLyB2aWRlbyBvbmx5XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3ZpZGVvSW5pdGlhbE1ldGFkYXRhRGlzcGF0Y2hlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGZ1bmN0aW9uIHBhcnNlQ2h1bmtzKGNodW5rOiBBcnJheUJ1ZmZlciwgYnl0ZVN0YXJ0OiBudW1iZXIpOiBudW1iZXI7XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3BhcnNlQ2h1bmtzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBhcnNlQ2h1bmtzKGNodW5rLCBieXRlU3RhcnQpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fb25FcnJvciB8fCAhdGhpcy5fb25NZWRpYUluZm8gfHwgIXRoaXMuX29uVHJhY2tNZXRhZGF0YSB8fCAhdGhpcy5fb25EYXRhQXZhaWxhYmxlKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCdGbHY6IG9uRXJyb3IgJiBvbk1lZGlhSW5mbyAmIG9uVHJhY2tNZXRhZGF0YSAmIG9uRGF0YUF2YWlsYWJsZSBjYWxsYmFjayBtdXN0IGJlIHNwZWNpZmllZCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gMDtcbiAgICAgICAgICAgIHZhciBsZSA9IHRoaXMuX2xpdHRsZUVuZGlhbjtcblxuICAgICAgICAgICAgaWYgKGJ5dGVTdGFydCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIC8vIGJ1ZmZlciB3aXRoIEZMViBoZWFkZXJcbiAgICAgICAgICAgICAgICBpZiAoY2h1bmsuYnl0ZUxlbmd0aCA+IDEzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm9iZURhdGEgPSBGTFZEZW11eGVyLnByb2JlKGNodW5rKTtcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gcHJvYmVEYXRhLmRhdGFPZmZzZXQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5fZmlyc3RQYXJzZSkge1xuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBQcmV2aW91c1RhZ1NpemUwIGJlZm9yZSBUYWcxXG4gICAgICAgICAgICAgICAgdGhpcy5fZmlyc3RQYXJzZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChieXRlU3RhcnQgKyBvZmZzZXQgIT09IHRoaXMuX2RhdGFPZmZzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnRmlyc3QgdGltZSBwYXJzaW5nIGJ1dCBjaHVuayBieXRlU3RhcnQgaW52YWxpZCEnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdiA9IG5ldyBEYXRhVmlldyhjaHVuaywgb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICB2YXIgcHJldlRhZ1NpemUwID0gdi5nZXRVaW50MzIoMCwgIWxlKTtcbiAgICAgICAgICAgICAgICBpZiAocHJldlRhZ1NpemUwICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ1ByZXZUYWdTaXplMCAhPT0gMCAhISEnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHdoaWxlIChvZmZzZXQgPCBjaHVuay5ieXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGlzcGF0Y2ggPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgdmFyIF92ID0gbmV3IERhdGFWaWV3KGNodW5rLCBvZmZzZXQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKG9mZnNldCArIDExICsgNCA+IGNodW5rLmJ5dGVMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZGF0YSBub3QgZW5vdWdoIGZvciBwYXJzaW5nIGFuIGZsdiB0YWdcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHRhZ1R5cGUgPSBfdi5nZXRVaW50OCgwKTtcbiAgICAgICAgICAgICAgICB2YXIgZGF0YVNpemUgPSBfdi5nZXRVaW50MzIoMCwgIWxlKSAmIDB4MDBGRkZGRkY7XG5cbiAgICAgICAgICAgICAgICBpZiAob2Zmc2V0ICsgMTEgKyBkYXRhU2l6ZSArIDQgPiBjaHVuay5ieXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGRhdGEgbm90IGVub3VnaCBmb3IgcGFyc2luZyBhY3R1YWwgZGF0YSBib2R5XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0YWdUeXBlICE9PSA4ICYmIHRhZ1R5cGUgIT09IDkgJiYgdGFnVHlwZSAhPT0gMTgpIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnVW5zdXBwb3J0ZWQgdGFnIHR5cGUgJyArIHRhZ1R5cGUgKyAnLCBza2lwcGVkJyk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnN1bWUgdGhlIHdob2xlIHRhZyAoc2tpcCBpdClcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDExICsgZGF0YVNpemUgKyA0O1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdHMyID0gX3YuZ2V0VWludDgoNCk7XG4gICAgICAgICAgICAgICAgdmFyIHRzMSA9IF92LmdldFVpbnQ4KDUpO1xuICAgICAgICAgICAgICAgIHZhciB0czAgPSBfdi5nZXRVaW50OCg2KTtcbiAgICAgICAgICAgICAgICB2YXIgdHMzID0gX3YuZ2V0VWludDgoNyk7XG5cbiAgICAgICAgICAgICAgICB2YXIgdGltZXN0YW1wID0gdHMwIHwgdHMxIDw8IDggfCB0czIgPDwgMTYgfCB0czMgPDwgMjQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgc3RyZWFtSWQgPSBfdi5nZXRVaW50MzIoNywgIWxlKSAmIDB4MDBGRkZGRkY7XG4gICAgICAgICAgICAgICAgaWYgKHN0cmVhbUlkICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ01lZXQgdGFnIHdoaWNoIGhhcyBTdHJlYW1JRCAhPSAwIScpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBkYXRhT2Zmc2V0ID0gb2Zmc2V0ICsgMTE7XG5cbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHRhZ1R5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQXVkaW9cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BhcnNlQXVkaW9EYXRhKGNodW5rLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSwgdGltZXN0YW1wKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBWaWRlb1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uU3RyZWFtVGltZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25TdHJlYW1UaW1lKHRpbWVzdGFtcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wYXJzZVZpZGVvRGF0YShjaHVuaywgZGF0YU9mZnNldCwgZGF0YVNpemUsIHRpbWVzdGFtcCwgYnl0ZVN0YXJ0ICsgb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE4OlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2NyaXB0RGF0YU9iamVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGFyc2VTY3JpcHREYXRhKGNodW5rLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgcHJldlRhZ1NpemUgPSBfdi5nZXRVaW50MzIoMTEgKyBkYXRhU2l6ZSwgIWxlKTtcbiAgICAgICAgICAgICAgICBpZiAocHJldlRhZ1NpemUgIT09IDExICsgZGF0YVNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnSW52YWxpZCBQcmV2VGFnU2l6ZSAnICsgcHJldlRhZ1NpemUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG9mZnNldCArPSAxMSArIGRhdGFTaXplICsgNDsgLy8gdGFnQm9keSArIGRhdGFTaXplICsgcHJldlRhZ1NpemVcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gZGlzcGF0Y2ggcGFyc2VkIGZyYW1lcyB0byBjb25zdW1lciAodHlwaWNhbGx5LCB0aGUgcmVtdXhlcilcbiAgICAgICAgICAgIGlmICh0aGlzLl9pc0luaXRpYWxNZXRhZGF0YURpc3BhdGNoZWQoKSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kaXNwYXRjaCAmJiAodGhpcy5fYXVkaW9UcmFjay5sZW5ndGggfHwgdGhpcy5fdmlkZW9UcmFjay5sZW5ndGgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uRGF0YUF2YWlsYWJsZSh0aGlzLl9hdWRpb1RyYWNrLCB0aGlzLl92aWRlb1RyYWNrKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBvZmZzZXQ7IC8vIGNvbnN1bWVkIGJ5dGVzLCBqdXN0IGVxdWFscyBsYXRlc3Qgb2Zmc2V0IGluZGV4XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19wYXJzZVNjcmlwdERhdGEnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3BhcnNlU2NyaXB0RGF0YShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpIHtcbiAgICAgICAgICAgIHZhciBzY3JpcHREYXRhID0gX2FtZlBhcnNlcjIuZGVmYXVsdC5wYXJzZVNjcmlwdERhdGEoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKTtcblxuICAgICAgICAgICAgaWYgKHNjcmlwdERhdGEuaGFzT3duUHJvcGVydHkoJ29uTWV0YURhdGEnKSkge1xuICAgICAgICAgICAgICAgIGlmIChzY3JpcHREYXRhLm9uTWV0YURhdGEgPT0gbnVsbCB8fCBfdHlwZW9mKHNjcmlwdERhdGEub25NZXRhRGF0YSkgIT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ0ludmFsaWQgb25NZXRhRGF0YSBzdHJ1Y3R1cmUhJyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX21ldGFkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ0ZvdW5kIGFub3RoZXIgb25NZXRhRGF0YSB0YWchJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX21ldGFkYXRhID0gc2NyaXB0RGF0YTtcbiAgICAgICAgICAgICAgICB2YXIgb25NZXRhRGF0YSA9IHRoaXMuX21ldGFkYXRhLm9uTWV0YURhdGE7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25NZXRhRGF0YUFycml2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25NZXRhRGF0YUFycml2ZWQoT2JqZWN0LmFzc2lnbih7fSwgb25NZXRhRGF0YSkpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb25NZXRhRGF0YS5oYXNBdWRpbyA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGhhc0F1ZGlvXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9oYXNBdWRpb0ZsYWdPdmVycmlkZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYXNBdWRpbyA9IG9uTWV0YURhdGEuaGFzQXVkaW87XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uaGFzQXVkaW8gPSB0aGlzLl9oYXNBdWRpbztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9uTWV0YURhdGEuaGFzVmlkZW8gPT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBoYXNWaWRlb1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5faGFzVmlkZW9GbGFnT3ZlcnJpZGVkID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faGFzVmlkZW8gPSBvbk1ldGFEYXRhLmhhc1ZpZGVvO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmhhc1ZpZGVvID0gdGhpcy5faGFzVmlkZW87XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvbk1ldGFEYXRhLmF1ZGlvZGF0YXJhdGUgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGF1ZGlvZGF0YXJhdGVcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmF1ZGlvRGF0YVJhdGUgPSBvbk1ldGFEYXRhLmF1ZGlvZGF0YXJhdGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb25NZXRhRGF0YS52aWRlb2RhdGFyYXRlID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICAvLyB2aWRlb2RhdGFyYXRlXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby52aWRlb0RhdGFSYXRlID0gb25NZXRhRGF0YS52aWRlb2RhdGFyYXRlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9uTWV0YURhdGEud2lkdGggPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHdpZHRoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby53aWR0aCA9IG9uTWV0YURhdGEud2lkdGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb25NZXRhRGF0YS5oZWlnaHQgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGhlaWdodFxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uaGVpZ2h0ID0gb25NZXRhRGF0YS5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb25NZXRhRGF0YS5kdXJhdGlvbiA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZHVyYXRpb25cbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9kdXJhdGlvbk92ZXJyaWRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR1cmF0aW9uID0gTWF0aC5mbG9vcihvbk1ldGFEYXRhLmR1cmF0aW9uICogdGhpcy5fdGltZXNjYWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2R1cmF0aW9uID0gZHVyYXRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uZHVyYXRpb24gPSBkdXJhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5kdXJhdGlvbiA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb25NZXRhRGF0YS5mcmFtZXJhdGUgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGZyYW1lcmF0ZVxuICAgICAgICAgICAgICAgICAgICB2YXIgZnBzX251bSA9IE1hdGguZmxvb3Iob25NZXRhRGF0YS5mcmFtZXJhdGUgKiAxMDAwKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZwc19udW0gPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnBzID0gZnBzX251bSAvIDEwMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZWZlcmVuY2VGcmFtZVJhdGUuZml4ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVmZXJlbmNlRnJhbWVSYXRlLmZwcyA9IGZwcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlZmVyZW5jZUZyYW1lUmF0ZS5mcHNfbnVtID0gZnBzX251bTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlZmVyZW5jZUZyYW1lUmF0ZS5mcHNfZGVuID0gMTAwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5mcHMgPSBmcHM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKF90eXBlb2Yob25NZXRhRGF0YS5rZXlmcmFtZXMpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICAvLyBrZXlmcmFtZXNcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmhhc0tleWZyYW1lc0luZGV4ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleWZyYW1lcyA9IG9uTWV0YURhdGEua2V5ZnJhbWVzO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8ua2V5ZnJhbWVzSW5kZXggPSB0aGlzLl9wYXJzZUtleWZyYW1lc0luZGV4KGtleWZyYW1lcyk7XG4gICAgICAgICAgICAgICAgICAgIG9uTWV0YURhdGEua2V5ZnJhbWVzID0gbnVsbDsgLy8ga2V5ZnJhbWVzIGhhcyBiZWVuIGV4dHJhY3RlZCwgcmVtb3ZlIGl0XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmhhc0tleWZyYW1lc0luZGV4ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX2Rpc3BhdGNoID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLm1ldGFkYXRhID0gb25NZXRhRGF0YTtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYodGhpcy5UQUcsICdQYXJzZWQgb25NZXRhRGF0YScpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUluZm8uaXNDb21wbGV0ZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uTWVkaWFJbmZvKHRoaXMuX21lZGlhSW5mbyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoc2NyaXB0RGF0YSkubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vblNjcmlwdERhdGFBcnJpdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uU2NyaXB0RGF0YUFycml2ZWQoT2JqZWN0LmFzc2lnbih7fSwgc2NyaXB0RGF0YSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3BhcnNlS2V5ZnJhbWVzSW5kZXgnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3BhcnNlS2V5ZnJhbWVzSW5kZXgoa2V5ZnJhbWVzKSB7XG4gICAgICAgICAgICB2YXIgdGltZXMgPSBbXTtcbiAgICAgICAgICAgIHZhciBmaWxlcG9zaXRpb25zID0gW107XG5cbiAgICAgICAgICAgIC8vIGlnbm9yZSBmaXJzdCBrZXlmcmFtZSB3aGljaCBpcyBhY3R1YWxseSBBVkMgU2VxdWVuY2UgSGVhZGVyIChBVkNEZWNvZGVyQ29uZmlndXJhdGlvblJlY29yZClcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwga2V5ZnJhbWVzLnRpbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRpbWUgPSB0aGlzLl90aW1lc3RhbXBCYXNlICsgTWF0aC5mbG9vcihrZXlmcmFtZXMudGltZXNbaV0gKiAxMDAwKTtcbiAgICAgICAgICAgICAgICB0aW1lcy5wdXNoKHRpbWUpO1xuICAgICAgICAgICAgICAgIGZpbGVwb3NpdGlvbnMucHVzaChrZXlmcmFtZXMuZmlsZXBvc2l0aW9uc1tpXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGltZXM6IHRpbWVzLFxuICAgICAgICAgICAgICAgIGZpbGVwb3NpdGlvbnM6IGZpbGVwb3NpdGlvbnNcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19wYXJzZUF1ZGlvRGF0YScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcGFyc2VBdWRpb0RhdGEoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplLCB0YWdUaW1lc3RhbXApIHtcbiAgICAgICAgICAgIGlmIChkYXRhU2l6ZSA8PSAxKSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnRmx2OiBJbnZhbGlkIGF1ZGlvIHBhY2tldCwgbWlzc2luZyBTb3VuZERhdGEgcGF5bG9hZCEnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9oYXNBdWRpb0ZsYWdPdmVycmlkZWQgPT09IHRydWUgJiYgdGhpcy5faGFzQXVkaW8gPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgaGFzQXVkaW86IGZhbHNlIGluZGljYXRlZCBleHBsaWNpdGx5IGluIE1lZGlhRGF0YVNvdXJjZSxcbiAgICAgICAgICAgICAgICAvLyBJZ25vcmUgYWxsIHRoZSBhdWRpbyBwYWNrZXRzXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbGUgPSB0aGlzLl9saXR0bGVFbmRpYW47XG4gICAgICAgICAgICB2YXIgdiA9IG5ldyBEYXRhVmlldyhhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpO1xuXG4gICAgICAgICAgICB2YXIgc291bmRTcGVjID0gdi5nZXRVaW50OCgwKTtcblxuICAgICAgICAgICAgdmFyIHNvdW5kRm9ybWF0ID0gc291bmRTcGVjID4+PiA0O1xuICAgICAgICAgICAgaWYgKHNvdW5kRm9ybWF0ICE9PSAyICYmIHNvdW5kRm9ybWF0ICE9PSAxMCkge1xuICAgICAgICAgICAgICAgIC8vIE1QMyBvciBBQUNcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKF9kZW11eEVycm9yczIuZGVmYXVsdC5DT0RFQ19VTlNVUFBPUlRFRCwgJ0ZsdjogVW5zdXBwb3J0ZWQgYXVkaW8gY29kZWMgaWR4OiAnICsgc291bmRGb3JtYXQpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHNvdW5kUmF0ZSA9IDA7XG4gICAgICAgICAgICB2YXIgc291bmRSYXRlSW5kZXggPSAoc291bmRTcGVjICYgMTIpID4+PiAyO1xuICAgICAgICAgICAgaWYgKHNvdW5kUmF0ZUluZGV4ID49IDAgJiYgc291bmRSYXRlSW5kZXggPD0gNCkge1xuICAgICAgICAgICAgICAgIHNvdW5kUmF0ZSA9IHRoaXMuX2ZsdlNvdW5kUmF0ZVRhYmxlW3NvdW5kUmF0ZUluZGV4XTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcihfZGVtdXhFcnJvcnMyLmRlZmF1bHQuRk9STUFUX0VSUk9SLCAnRmx2OiBJbnZhbGlkIGF1ZGlvIHNhbXBsZSByYXRlIGlkeDogJyArIHNvdW5kUmF0ZUluZGV4KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzb3VuZFNpemUgPSAoc291bmRTcGVjICYgMikgPj4+IDE7IC8vIHVudXNlZFxuICAgICAgICAgICAgdmFyIHNvdW5kVHlwZSA9IHNvdW5kU3BlYyAmIDE7XG5cbiAgICAgICAgICAgIHZhciBtZXRhID0gdGhpcy5fYXVkaW9NZXRhZGF0YTtcbiAgICAgICAgICAgIHZhciB0cmFjayA9IHRoaXMuX2F1ZGlvVHJhY2s7XG5cbiAgICAgICAgICAgIGlmICghbWV0YSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9oYXNBdWRpbyA9PT0gZmFsc2UgJiYgdGhpcy5faGFzQXVkaW9GbGFnT3ZlcnJpZGVkID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYXNBdWRpbyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5oYXNBdWRpbyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gaW5pdGlhbCBtZXRhZGF0YVxuICAgICAgICAgICAgICAgIG1ldGEgPSB0aGlzLl9hdWRpb01ldGFkYXRhID0ge307XG4gICAgICAgICAgICAgICAgbWV0YS50eXBlID0gJ2F1ZGlvJztcbiAgICAgICAgICAgICAgICBtZXRhLmlkID0gdHJhY2suaWQ7XG4gICAgICAgICAgICAgICAgbWV0YS50aW1lc2NhbGUgPSB0aGlzLl90aW1lc2NhbGU7XG4gICAgICAgICAgICAgICAgbWV0YS5kdXJhdGlvbiA9IHRoaXMuX2R1cmF0aW9uO1xuICAgICAgICAgICAgICAgIG1ldGEuYXVkaW9TYW1wbGVSYXRlID0gc291bmRSYXRlO1xuICAgICAgICAgICAgICAgIG1ldGEuY2hhbm5lbENvdW50ID0gc291bmRUeXBlID09PSAwID8gMSA6IDI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzb3VuZEZvcm1hdCA9PT0gMTApIHtcbiAgICAgICAgICAgICAgICAvLyBBQUNcbiAgICAgICAgICAgICAgICB2YXIgYWFjRGF0YSA9IHRoaXMuX3BhcnNlQUFDQXVkaW9EYXRhKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgMSwgZGF0YVNpemUgLSAxKTtcbiAgICAgICAgICAgICAgICBpZiAoYWFjRGF0YSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChhYWNEYXRhLnBhY2tldFR5cGUgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQUFDIHNlcXVlbmNlIGhlYWRlciAoQXVkaW9TcGVjaWZpY0NvbmZpZylcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1ldGEuY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdGb3VuZCBhbm90aGVyIEF1ZGlvU3BlY2lmaWNDb25maWchJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIG1pc2MgPSBhYWNEYXRhLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIG1ldGEuYXVkaW9TYW1wbGVSYXRlID0gbWlzYy5zYW1wbGluZ1JhdGU7XG4gICAgICAgICAgICAgICAgICAgIG1ldGEuY2hhbm5lbENvdW50ID0gbWlzYy5jaGFubmVsQ291bnQ7XG4gICAgICAgICAgICAgICAgICAgIG1ldGEuY29kZWMgPSBtaXNjLmNvZGVjO1xuICAgICAgICAgICAgICAgICAgICBtZXRhLm9yaWdpbmFsQ29kZWMgPSBtaXNjLm9yaWdpbmFsQ29kZWM7XG4gICAgICAgICAgICAgICAgICAgIG1ldGEuY29uZmlnID0gbWlzYy5jb25maWc7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBkZWNvZGUgcmVzdWx0IG9mIGFuIGFhYyBzYW1wbGUgaXMgMTAyNCBQQ00gc2FtcGxlc1xuICAgICAgICAgICAgICAgICAgICBtZXRhLnJlZlNhbXBsZUR1cmF0aW9uID0gMTAyNCAvIG1ldGEuYXVkaW9TYW1wbGVSYXRlICogbWV0YS50aW1lc2NhbGU7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudih0aGlzLlRBRywgJ1BhcnNlZCBBdWRpb1NwZWNpZmljQ29uZmlnJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2lzSW5pdGlhbE1ldGFkYXRhRGlzcGF0Y2hlZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOb24taW5pdGlhbCBtZXRhZGF0YSwgZm9yY2UgZGlzcGF0Y2ggKG9yIGZsdXNoKSBwYXJzZWQgZnJhbWVzIHRvIHJlbXV4ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kaXNwYXRjaCAmJiAodGhpcy5fYXVkaW9UcmFjay5sZW5ndGggfHwgdGhpcy5fdmlkZW9UcmFjay5sZW5ndGgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25EYXRhQXZhaWxhYmxlKHRoaXMuX2F1ZGlvVHJhY2ssIHRoaXMuX3ZpZGVvVHJhY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXVkaW9Jbml0aWFsTWV0YWRhdGFEaXNwYXRjaGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvLyB0aGVuIG5vdGlmeSBuZXcgbWV0YWRhdGFcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGlzcGF0Y2ggPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25UcmFja01ldGFkYXRhKCdhdWRpbycsIG1ldGEpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBtaSA9IHRoaXMuX21lZGlhSW5mbztcbiAgICAgICAgICAgICAgICAgICAgbWkuYXVkaW9Db2RlYyA9IG1ldGEub3JpZ2luYWxDb2RlYztcbiAgICAgICAgICAgICAgICAgICAgbWkuYXVkaW9TYW1wbGVSYXRlID0gbWV0YS5hdWRpb1NhbXBsZVJhdGU7XG4gICAgICAgICAgICAgICAgICAgIG1pLmF1ZGlvQ2hhbm5lbENvdW50ID0gbWV0YS5jaGFubmVsQ291bnQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtaS5oYXNWaWRlbykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1pLnZpZGVvQ29kZWMgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pLm1pbWVUeXBlID0gJ3ZpZGVvL3gtZmx2OyBjb2RlY3M9XCInICsgbWkudmlkZW9Db2RlYyArICcsJyArIG1pLmF1ZGlvQ29kZWMgKyAnXCInO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWkubWltZVR5cGUgPSAndmlkZW8veC1mbHY7IGNvZGVjcz1cIicgKyBtaS5hdWRpb0NvZGVjICsgJ1wiJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAobWkuaXNDb21wbGV0ZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbk1lZGlhSW5mbyhtaSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFhY0RhdGEucGFja2V0VHlwZSA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBBQUMgcmF3IGZyYW1lIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgdmFyIGR0cyA9IHRoaXMuX3RpbWVzdGFtcEJhc2UgKyB0YWdUaW1lc3RhbXA7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhYWNTYW1wbGUgPSB7IHVuaXQ6IGFhY0RhdGEuZGF0YSwgbGVuZ3RoOiBhYWNEYXRhLmRhdGEuYnl0ZUxlbmd0aCwgZHRzOiBkdHMsIHB0czogZHRzIH07XG4gICAgICAgICAgICAgICAgICAgIHRyYWNrLnNhbXBsZXMucHVzaChhYWNTYW1wbGUpO1xuICAgICAgICAgICAgICAgICAgICB0cmFjay5sZW5ndGggKz0gYWFjRGF0YS5kYXRhLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmUodGhpcy5UQUcsICdGbHY6IFVuc3VwcG9ydGVkIEFBQyBkYXRhIHR5cGUgJyArIGFhY0RhdGEucGFja2V0VHlwZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChzb3VuZEZvcm1hdCA9PT0gMikge1xuICAgICAgICAgICAgICAgIC8vIE1QM1xuICAgICAgICAgICAgICAgIGlmICghbWV0YS5jb2RlYykge1xuICAgICAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIG1ldGFkYXRhIGZvciBtcDMgYXVkaW8gdHJhY2ssIGV4dHJhY3QgaW5mbyBmcm9tIGZyYW1lIGhlYWRlclxuICAgICAgICAgICAgICAgICAgICB2YXIgX21pc2MgPSB0aGlzLl9wYXJzZU1QM0F1ZGlvRGF0YShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIDEsIGRhdGFTaXplIC0gMSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfbWlzYyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBtZXRhLmF1ZGlvU2FtcGxlUmF0ZSA9IF9taXNjLnNhbXBsaW5nUmF0ZTtcbiAgICAgICAgICAgICAgICAgICAgbWV0YS5jaGFubmVsQ291bnQgPSBfbWlzYy5jaGFubmVsQ291bnQ7XG4gICAgICAgICAgICAgICAgICAgIG1ldGEuY29kZWMgPSBfbWlzYy5jb2RlYztcbiAgICAgICAgICAgICAgICAgICAgbWV0YS5vcmlnaW5hbENvZGVjID0gX21pc2Mub3JpZ2luYWxDb2RlYztcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGRlY29kZSByZXN1bHQgb2YgYW4gbXAzIHNhbXBsZSBpcyAxMTUyIFBDTSBzYW1wbGVzXG4gICAgICAgICAgICAgICAgICAgIG1ldGEucmVmU2FtcGxlRHVyYXRpb24gPSAxMTUyIC8gbWV0YS5hdWRpb1NhbXBsZVJhdGUgKiBtZXRhLnRpbWVzY2FsZTtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KHRoaXMuVEFHLCAnUGFyc2VkIE1QRUcgQXVkaW8gRnJhbWUgSGVhZGVyJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXVkaW9Jbml0aWFsTWV0YWRhdGFEaXNwYXRjaGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25UcmFja01ldGFkYXRhKCdhdWRpbycsIG1ldGEpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBfbWkgPSB0aGlzLl9tZWRpYUluZm87XG4gICAgICAgICAgICAgICAgICAgIF9taS5hdWRpb0NvZGVjID0gbWV0YS5jb2RlYztcbiAgICAgICAgICAgICAgICAgICAgX21pLmF1ZGlvU2FtcGxlUmF0ZSA9IG1ldGEuYXVkaW9TYW1wbGVSYXRlO1xuICAgICAgICAgICAgICAgICAgICBfbWkuYXVkaW9DaGFubmVsQ291bnQgPSBtZXRhLmNoYW5uZWxDb3VudDtcbiAgICAgICAgICAgICAgICAgICAgX21pLmF1ZGlvRGF0YVJhdGUgPSBfbWlzYy5iaXRSYXRlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoX21pLmhhc1ZpZGVvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX21pLnZpZGVvQ29kZWMgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9taS5taW1lVHlwZSA9ICd2aWRlby94LWZsdjsgY29kZWNzPVwiJyArIF9taS52aWRlb0NvZGVjICsgJywnICsgX21pLmF1ZGlvQ29kZWMgKyAnXCInO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgX21pLm1pbWVUeXBlID0gJ3ZpZGVvL3gtZmx2OyBjb2RlY3M9XCInICsgX21pLmF1ZGlvQ29kZWMgKyAnXCInO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChfbWkuaXNDb21wbGV0ZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbk1lZGlhSW5mbyhfbWkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gVGhpcyBwYWNrZXQgaXMgYWx3YXlzIGEgdmFsaWQgYXVkaW8gcGFja2V0LCBleHRyYWN0IGl0XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB0aGlzLl9wYXJzZU1QM0F1ZGlvRGF0YShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIDEsIGRhdGFTaXplIC0gMSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgIGlmIChkYXRhID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBfZHRzID0gdGhpcy5fdGltZXN0YW1wQmFzZSArIHRhZ1RpbWVzdGFtcDtcbiAgICAgICAgICAgICAgICB2YXIgbXAzU2FtcGxlID0geyB1bml0OiBkYXRhLCBsZW5ndGg6IGRhdGEuYnl0ZUxlbmd0aCwgZHRzOiBfZHRzLCBwdHM6IF9kdHMgfTtcbiAgICAgICAgICAgICAgICB0cmFjay5zYW1wbGVzLnB1c2gobXAzU2FtcGxlKTtcbiAgICAgICAgICAgICAgICB0cmFjay5sZW5ndGggKz0gZGF0YS5sZW5ndGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19wYXJzZUFBQ0F1ZGlvRGF0YScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcGFyc2VBQUNBdWRpb0RhdGEoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKSB7XG4gICAgICAgICAgICBpZiAoZGF0YVNpemUgPD0gMSkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ0ZsdjogSW52YWxpZCBBQUMgcGFja2V0LCBtaXNzaW5nIEFBQ1BhY2tldFR5cGUgb3IvYW5kIERhdGEhJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0ge307XG4gICAgICAgICAgICB2YXIgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpO1xuXG4gICAgICAgICAgICByZXN1bHQucGFja2V0VHlwZSA9IGFycmF5WzBdO1xuXG4gICAgICAgICAgICBpZiAoYXJyYXlbMF0gPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXN1bHQuZGF0YSA9IHRoaXMuX3BhcnNlQUFDQXVkaW9TcGVjaWZpY0NvbmZpZyhhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIDEsIGRhdGFTaXplIC0gMSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRhID0gYXJyYXkuc3ViYXJyYXkoMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19wYXJzZUFBQ0F1ZGlvU3BlY2lmaWNDb25maWcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3BhcnNlQUFDQXVkaW9TcGVjaWZpY0NvbmZpZyhhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpIHtcbiAgICAgICAgICAgIHZhciBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSk7XG4gICAgICAgICAgICB2YXIgY29uZmlnID0gbnVsbDtcblxuICAgICAgICAgICAgLyogQXVkaW8gT2JqZWN0IFR5cGU6XHJcbiAgICAgICAgICAgICAgIDA6IE51bGxcclxuICAgICAgICAgICAgICAgMTogQUFDIE1haW5cclxuICAgICAgICAgICAgICAgMjogQUFDIExDXHJcbiAgICAgICAgICAgICAgIDM6IEFBQyBTU1IgKFNjYWxhYmxlIFNhbXBsZSBSYXRlKVxyXG4gICAgICAgICAgICAgICA0OiBBQUMgTFRQIChMb25nIFRlcm0gUHJlZGljdGlvbilcclxuICAgICAgICAgICAgICAgNTogSEUtQUFDIC8gU0JSIChTcGVjdHJhbCBCYW5kIFJlcGxpY2F0aW9uKVxyXG4gICAgICAgICAgICAgICA2OiBBQUMgU2NhbGFibGVcclxuICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgdmFyIGF1ZGlvT2JqZWN0VHlwZSA9IDA7XG4gICAgICAgICAgICB2YXIgb3JpZ2luYWxBdWRpb09iamVjdFR5cGUgPSAwO1xuICAgICAgICAgICAgdmFyIGF1ZGlvRXh0ZW5zaW9uT2JqZWN0VHlwZSA9IG51bGw7XG4gICAgICAgICAgICB2YXIgc2FtcGxpbmdJbmRleCA9IDA7XG4gICAgICAgICAgICB2YXIgZXh0ZW5zaW9uU2FtcGxpbmdJbmRleCA9IG51bGw7XG5cbiAgICAgICAgICAgIC8vIDUgYml0c1xuICAgICAgICAgICAgYXVkaW9PYmplY3RUeXBlID0gb3JpZ2luYWxBdWRpb09iamVjdFR5cGUgPSBhcnJheVswXSA+Pj4gMztcbiAgICAgICAgICAgIC8vIDQgYml0c1xuICAgICAgICAgICAgc2FtcGxpbmdJbmRleCA9IChhcnJheVswXSAmIDB4MDcpIDw8IDEgfCBhcnJheVsxXSA+Pj4gNztcbiAgICAgICAgICAgIGlmIChzYW1wbGluZ0luZGV4IDwgMCB8fCBzYW1wbGluZ0luZGV4ID49IHRoaXMuX21wZWdTYW1wbGluZ1JhdGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoX2RlbXV4RXJyb3JzMi5kZWZhdWx0LkZPUk1BVF9FUlJPUiwgJ0ZsdjogQUFDIGludmFsaWQgc2FtcGxpbmcgZnJlcXVlbmN5IGluZGV4IScpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHNhbXBsaW5nRnJlcXVlbmNlID0gdGhpcy5fbXBlZ1NhbXBsaW5nUmF0ZXNbc2FtcGxpbmdJbmRleF07XG5cbiAgICAgICAgICAgIC8vIDQgYml0c1xuICAgICAgICAgICAgdmFyIGNoYW5uZWxDb25maWcgPSAoYXJyYXlbMV0gJiAweDc4KSA+Pj4gMztcbiAgICAgICAgICAgIGlmIChjaGFubmVsQ29uZmlnIDwgMCB8fCBjaGFubmVsQ29uZmlnID49IDgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKF9kZW11eEVycm9yczIuZGVmYXVsdC5GT1JNQVRfRVJST1IsICdGbHY6IEFBQyBpbnZhbGlkIGNoYW5uZWwgY29uZmlndXJhdGlvbicpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGF1ZGlvT2JqZWN0VHlwZSA9PT0gNSkge1xuICAgICAgICAgICAgICAgIC8vIEhFLUFBQz9cbiAgICAgICAgICAgICAgICAvLyA0IGJpdHNcbiAgICAgICAgICAgICAgICBleHRlbnNpb25TYW1wbGluZ0luZGV4ID0gKGFycmF5WzFdICYgMHgwNykgPDwgMSB8IGFycmF5WzJdID4+PiA3O1xuICAgICAgICAgICAgICAgIC8vIDUgYml0c1xuICAgICAgICAgICAgICAgIGF1ZGlvRXh0ZW5zaW9uT2JqZWN0VHlwZSA9IChhcnJheVsyXSAmIDB4N0MpID4+PiAyO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyB3b3JrYXJvdW5kcyBmb3IgdmFyaW91cyBicm93c2Vyc1xuICAgICAgICAgICAgdmFyIHVzZXJBZ2VudCA9IHNlbGYubmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgICAgICBpZiAodXNlckFnZW50LmluZGV4T2YoJ2ZpcmVmb3gnKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAvLyBmaXJlZm94OiB1c2UgU0JSIChIRS1BQUMpIGlmIGZyZXEgbGVzcyB0aGFuIDI0a0h6XG4gICAgICAgICAgICAgICAgaWYgKHNhbXBsaW5nSW5kZXggPj0gNikge1xuICAgICAgICAgICAgICAgICAgICBhdWRpb09iamVjdFR5cGUgPSA1O1xuICAgICAgICAgICAgICAgICAgICBjb25maWcgPSBuZXcgQXJyYXkoNCk7XG4gICAgICAgICAgICAgICAgICAgIGV4dGVuc2lvblNhbXBsaW5nSW5kZXggPSBzYW1wbGluZ0luZGV4IC0gMztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyB1c2UgTEMtQUFDXG4gICAgICAgICAgICAgICAgICAgIGF1ZGlvT2JqZWN0VHlwZSA9IDI7XG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZyA9IG5ldyBBcnJheSgyKTtcbiAgICAgICAgICAgICAgICAgICAgZXh0ZW5zaW9uU2FtcGxpbmdJbmRleCA9IHNhbXBsaW5nSW5kZXg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmICh1c2VyQWdlbnQuaW5kZXhPZignYW5kcm9pZCcpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIC8vIGFuZHJvaWQ6IGFsd2F5cyB1c2UgTEMtQUFDXG4gICAgICAgICAgICAgICAgYXVkaW9PYmplY3RUeXBlID0gMjtcbiAgICAgICAgICAgICAgICBjb25maWcgPSBuZXcgQXJyYXkoMik7XG4gICAgICAgICAgICAgICAgZXh0ZW5zaW9uU2FtcGxpbmdJbmRleCA9IHNhbXBsaW5nSW5kZXg7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGZvciBvdGhlciBicm93c2VycywgZS5nLiBjaHJvbWUuLi5cbiAgICAgICAgICAgICAgICAvLyBBbHdheXMgdXNlIEhFLUFBQyB0byBtYWtlIGl0IGVhc2llciB0byBzd2l0Y2ggYWFjIGNvZGVjIHByb2ZpbGVcbiAgICAgICAgICAgICAgICBhdWRpb09iamVjdFR5cGUgPSA1O1xuICAgICAgICAgICAgICAgIGV4dGVuc2lvblNhbXBsaW5nSW5kZXggPSBzYW1wbGluZ0luZGV4O1xuICAgICAgICAgICAgICAgIGNvbmZpZyA9IG5ldyBBcnJheSg0KTtcblxuICAgICAgICAgICAgICAgIGlmIChzYW1wbGluZ0luZGV4ID49IDYpIHtcbiAgICAgICAgICAgICAgICAgICAgZXh0ZW5zaW9uU2FtcGxpbmdJbmRleCA9IHNhbXBsaW5nSW5kZXggLSAzO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hhbm5lbENvbmZpZyA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBNb25vIGNoYW5uZWxcbiAgICAgICAgICAgICAgICAgICAgYXVkaW9PYmplY3RUeXBlID0gMjtcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnID0gbmV3IEFycmF5KDIpO1xuICAgICAgICAgICAgICAgICAgICBleHRlbnNpb25TYW1wbGluZ0luZGV4ID0gc2FtcGxpbmdJbmRleDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbmZpZ1swXSA9IGF1ZGlvT2JqZWN0VHlwZSA8PCAzO1xuICAgICAgICAgICAgY29uZmlnWzBdIHw9IChzYW1wbGluZ0luZGV4ICYgMHgwRikgPj4+IDE7XG4gICAgICAgICAgICBjb25maWdbMV0gPSAoc2FtcGxpbmdJbmRleCAmIDB4MEYpIDw8IDc7XG4gICAgICAgICAgICBjb25maWdbMV0gfD0gKGNoYW5uZWxDb25maWcgJiAweDBGKSA8PCAzO1xuICAgICAgICAgICAgaWYgKGF1ZGlvT2JqZWN0VHlwZSA9PT0gNSkge1xuICAgICAgICAgICAgICAgIGNvbmZpZ1sxXSB8PSAoZXh0ZW5zaW9uU2FtcGxpbmdJbmRleCAmIDB4MEYpID4+PiAxO1xuICAgICAgICAgICAgICAgIGNvbmZpZ1syXSA9IChleHRlbnNpb25TYW1wbGluZ0luZGV4ICYgMHgwMSkgPDwgNztcbiAgICAgICAgICAgICAgICAvLyBleHRlbmRlZCBhdWRpbyBvYmplY3QgdHlwZTogZm9yY2UgdG8gMiAoTEMtQUFDKVxuICAgICAgICAgICAgICAgIGNvbmZpZ1syXSB8PSAyIDw8IDI7XG4gICAgICAgICAgICAgICAgY29uZmlnWzNdID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjb25maWc6IGNvbmZpZyxcbiAgICAgICAgICAgICAgICBzYW1wbGluZ1JhdGU6IHNhbXBsaW5nRnJlcXVlbmNlLFxuICAgICAgICAgICAgICAgIGNoYW5uZWxDb3VudDogY2hhbm5lbENvbmZpZyxcbiAgICAgICAgICAgICAgICBjb2RlYzogJ21wNGEuNDAuJyArIGF1ZGlvT2JqZWN0VHlwZSxcbiAgICAgICAgICAgICAgICBvcmlnaW5hbENvZGVjOiAnbXA0YS40MC4nICsgb3JpZ2luYWxBdWRpb09iamVjdFR5cGVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19wYXJzZU1QM0F1ZGlvRGF0YScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcGFyc2VNUDNBdWRpb0RhdGEoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplLCByZXF1ZXN0SGVhZGVyKSB7XG4gICAgICAgICAgICBpZiAoZGF0YVNpemUgPCA0KSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnRmx2OiBJbnZhbGlkIE1QMyBwYWNrZXQsIGhlYWRlciBtaXNzaW5nIScpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGxlID0gdGhpcy5fbGl0dGxlRW5kaWFuO1xuICAgICAgICAgICAgdmFyIGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKTtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBudWxsO1xuXG4gICAgICAgICAgICBpZiAocmVxdWVzdEhlYWRlcikge1xuICAgICAgICAgICAgICAgIGlmIChhcnJheVswXSAhPT0gMHhGRikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciB2ZXIgPSBhcnJheVsxXSA+Pj4gMyAmIDB4MDM7XG4gICAgICAgICAgICAgICAgdmFyIGxheWVyID0gKGFycmF5WzFdICYgMHgwNikgPj4gMTtcblxuICAgICAgICAgICAgICAgIHZhciBiaXRyYXRlX2luZGV4ID0gKGFycmF5WzJdICYgMHhGMCkgPj4+IDQ7XG4gICAgICAgICAgICAgICAgdmFyIHNhbXBsaW5nX2ZyZXFfaW5kZXggPSAoYXJyYXlbMl0gJiAweDBDKSA+Pj4gMjtcblxuICAgICAgICAgICAgICAgIHZhciBjaGFubmVsX21vZGUgPSBhcnJheVszXSA+Pj4gNiAmIDB4MDM7XG4gICAgICAgICAgICAgICAgdmFyIGNoYW5uZWxfY291bnQgPSBjaGFubmVsX21vZGUgIT09IDMgPyAyIDogMTtcblxuICAgICAgICAgICAgICAgIHZhciBzYW1wbGVfcmF0ZSA9IDA7XG4gICAgICAgICAgICAgICAgdmFyIGJpdF9yYXRlID0gMDtcbiAgICAgICAgICAgICAgICB2YXIgb2JqZWN0X3R5cGUgPSAzNDsgLy8gTGF5ZXItMywgbGlzdGVkIGluIE1QRUctNCBBdWRpbyBPYmplY3QgVHlwZXNcblxuICAgICAgICAgICAgICAgIHZhciBjb2RlYyA9ICdtcDMnO1xuXG4gICAgICAgICAgICAgICAgc3dpdGNoICh2ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTVBFRyAyLjVcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhbXBsZV9yYXRlID0gdGhpcy5fbXBlZ0F1ZGlvVjI1U2FtcGxlUmF0ZVRhYmxlW3NhbXBsaW5nX2ZyZXFfaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1QRUcgMlxuICAgICAgICAgICAgICAgICAgICAgICAgc2FtcGxlX3JhdGUgPSB0aGlzLl9tcGVnQXVkaW9WMjBTYW1wbGVSYXRlVGFibGVbc2FtcGxpbmdfZnJlcV9pbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTVBFRyAxXG4gICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVfcmF0ZSA9IHRoaXMuX21wZWdBdWRpb1YxMFNhbXBsZVJhdGVUYWJsZVtzYW1wbGluZ19mcmVxX2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHN3aXRjaCAobGF5ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTGF5ZXIgM1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0X3R5cGUgPSAzNDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXRyYXRlX2luZGV4IDwgdGhpcy5fbXBlZ0F1ZGlvTDNCaXRSYXRlVGFibGUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYml0X3JhdGUgPSB0aGlzLl9tcGVnQXVkaW9MM0JpdFJhdGVUYWJsZVtiaXRyYXRlX2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBMYXllciAyXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RfdHlwZSA9IDMzO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpdHJhdGVfaW5kZXggPCB0aGlzLl9tcGVnQXVkaW9MMkJpdFJhdGVUYWJsZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRfcmF0ZSA9IHRoaXMuX21wZWdBdWRpb0wyQml0UmF0ZVRhYmxlW2JpdHJhdGVfaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIExheWVyIDFcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdF90eXBlID0gMzI7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYml0cmF0ZV9pbmRleCA8IHRoaXMuX21wZWdBdWRpb0wxQml0UmF0ZVRhYmxlLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdF9yYXRlID0gdGhpcy5fbXBlZ0F1ZGlvTDFCaXRSYXRlVGFibGVbYml0cmF0ZV9pbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXN1bHQgPSB7XG4gICAgICAgICAgICAgICAgICAgIGJpdFJhdGU6IGJpdF9yYXRlLFxuICAgICAgICAgICAgICAgICAgICBzYW1wbGluZ1JhdGU6IHNhbXBsZV9yYXRlLFxuICAgICAgICAgICAgICAgICAgICBjaGFubmVsQ291bnQ6IGNoYW5uZWxfY291bnQsXG4gICAgICAgICAgICAgICAgICAgIGNvZGVjOiBjb2RlYyxcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxDb2RlYzogY29kZWNcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBhcnJheTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3BhcnNlVmlkZW9EYXRhJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9wYXJzZVZpZGVvRGF0YShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUsIHRhZ1RpbWVzdGFtcCwgdGFnUG9zaXRpb24pIHtcbiAgICAgICAgICAgIGlmIChkYXRhU2l6ZSA8PSAxKSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnRmx2OiBJbnZhbGlkIHZpZGVvIHBhY2tldCwgbWlzc2luZyBWaWRlb0RhdGEgcGF5bG9hZCEnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9oYXNWaWRlb0ZsYWdPdmVycmlkZWQgPT09IHRydWUgJiYgdGhpcy5faGFzVmlkZW8gPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgaGFzVmlkZW86IGZhbHNlIGluZGljYXRlZCBleHBsaWNpdGx5IGluIE1lZGlhRGF0YVNvdXJjZSxcbiAgICAgICAgICAgICAgICAvLyBJZ25vcmUgYWxsIHRoZSB2aWRlbyBwYWNrZXRzXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc3BlYyA9IG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSlbMF07XG5cbiAgICAgICAgICAgIHZhciBmcmFtZVR5cGUgPSAoc3BlYyAmIDI0MCkgPj4+IDQ7XG4gICAgICAgICAgICB2YXIgY29kZWNJZCA9IHNwZWMgJiAxNTtcblxuICAgICAgICAgICAgaWYgKGNvZGVjSWQgIT09IDcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKF9kZW11eEVycm9yczIuZGVmYXVsdC5DT0RFQ19VTlNVUFBPUlRFRCwgJ0ZsdjogVW5zdXBwb3J0ZWQgY29kZWMgaW4gdmlkZW8gZnJhbWU6ICcgKyBjb2RlY0lkKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3BhcnNlQVZDVmlkZW9QYWNrZXQoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyAxLCBkYXRhU2l6ZSAtIDEsIHRhZ1RpbWVzdGFtcCwgdGFnUG9zaXRpb24sIGZyYW1lVHlwZSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19wYXJzZUFWQ1ZpZGVvUGFja2V0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9wYXJzZUFWQ1ZpZGVvUGFja2V0KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSwgdGFnVGltZXN0YW1wLCB0YWdQb3NpdGlvbiwgZnJhbWVUeXBlKSB7XG4gICAgICAgICAgICBpZiAoZGF0YVNpemUgPCA0KSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnRmx2OiBJbnZhbGlkIEFWQyBwYWNrZXQsIG1pc3NpbmcgQVZDUGFja2V0VHlwZSBvci9hbmQgQ29tcG9zaXRpb25UaW1lJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbGUgPSB0aGlzLl9saXR0bGVFbmRpYW47XG4gICAgICAgICAgICB2YXIgdiA9IG5ldyBEYXRhVmlldyhhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpO1xuXG4gICAgICAgICAgICB2YXIgcGFja2V0VHlwZSA9IHYuZ2V0VWludDgoMCk7XG4gICAgICAgICAgICB2YXIgY3RzX3Vuc2lnbmVkID0gdi5nZXRVaW50MzIoMCwgIWxlKSAmIDB4MDBGRkZGRkY7XG4gICAgICAgICAgICB2YXIgY3RzID0gY3RzX3Vuc2lnbmVkIDw8IDggPj4gODsgLy8gY29udmVydCB0byAyNC1iaXQgc2lnbmVkIGludFxuXG4gICAgICAgICAgICBpZiAocGFja2V0VHlwZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIC8vIEFWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkXG4gICAgICAgICAgICAgICAgdGhpcy5fcGFyc2VBVkNEZWNvZGVyQ29uZmlndXJhdGlvblJlY29yZChhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIDQsIGRhdGFTaXplIC0gNCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhY2tldFR5cGUgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAvLyBPbmUgb3IgbW9yZSBOYWx1c1xuICAgICAgICAgICAgICAgIHRoaXMuX3BhcnNlQVZDVmlkZW9EYXRhKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgNCwgZGF0YVNpemUgLSA0LCB0YWdUaW1lc3RhbXAsIHRhZ1Bvc2l0aW9uLCBmcmFtZVR5cGUsIGN0cyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhY2tldFR5cGUgPT09IDIpIHtcbiAgICAgICAgICAgICAgICAvLyBlbXB0eSwgQVZDIGVuZCBvZiBzZXF1ZW5jZVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKF9kZW11eEVycm9yczIuZGVmYXVsdC5GT1JNQVRfRVJST1IsICdGbHY6IEludmFsaWQgdmlkZW8gcGFja2V0IHR5cGUgJyArIHBhY2tldFR5cGUpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3BhcnNlQVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3BhcnNlQVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKSB7XG4gICAgICAgICAgICBpZiAoZGF0YVNpemUgPCA3KSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnRmx2OiBJbnZhbGlkIEFWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkLCBsYWNrIG9mIGRhdGEhJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbWV0YSA9IHRoaXMuX3ZpZGVvTWV0YWRhdGE7XG4gICAgICAgICAgICB2YXIgdHJhY2sgPSB0aGlzLl92aWRlb1RyYWNrO1xuICAgICAgICAgICAgdmFyIGxlID0gdGhpcy5fbGl0dGxlRW5kaWFuO1xuICAgICAgICAgICAgdmFyIHYgPSBuZXcgRGF0YVZpZXcoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKTtcblxuICAgICAgICAgICAgaWYgKCFtZXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2hhc1ZpZGVvID09PSBmYWxzZSAmJiB0aGlzLl9oYXNWaWRlb0ZsYWdPdmVycmlkZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhc1ZpZGVvID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmhhc1ZpZGVvID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBtZXRhID0gdGhpcy5fdmlkZW9NZXRhZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgIG1ldGEudHlwZSA9ICd2aWRlbyc7XG4gICAgICAgICAgICAgICAgbWV0YS5pZCA9IHRyYWNrLmlkO1xuICAgICAgICAgICAgICAgIG1ldGEudGltZXNjYWxlID0gdGhpcy5fdGltZXNjYWxlO1xuICAgICAgICAgICAgICAgIG1ldGEuZHVyYXRpb24gPSB0aGlzLl9kdXJhdGlvbjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtZXRhLmF2Y2MgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ0ZvdW5kIGFub3RoZXIgQVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQhJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdmVyc2lvbiA9IHYuZ2V0VWludDgoMCk7IC8vIGNvbmZpZ3VyYXRpb25WZXJzaW9uXG4gICAgICAgICAgICB2YXIgYXZjUHJvZmlsZSA9IHYuZ2V0VWludDgoMSk7IC8vIGF2Y1Byb2ZpbGVJbmRpY2F0aW9uXG4gICAgICAgICAgICB2YXIgcHJvZmlsZUNvbXBhdGliaWxpdHkgPSB2LmdldFVpbnQ4KDIpOyAvLyBwcm9maWxlX2NvbXBhdGliaWxpdHlcbiAgICAgICAgICAgIHZhciBhdmNMZXZlbCA9IHYuZ2V0VWludDgoMyk7IC8vIEFWQ0xldmVsSW5kaWNhdGlvblxuXG4gICAgICAgICAgICBpZiAodmVyc2lvbiAhPT0gMSB8fCBhdmNQcm9maWxlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcihfZGVtdXhFcnJvcnMyLmRlZmF1bHQuRk9STUFUX0VSUk9SLCAnRmx2OiBJbnZhbGlkIEFWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9uYWx1TGVuZ3RoU2l6ZSA9ICh2LmdldFVpbnQ4KDQpICYgMykgKyAxOyAvLyBsZW5ndGhTaXplTWludXNPbmVcbiAgICAgICAgICAgIGlmICh0aGlzLl9uYWx1TGVuZ3RoU2l6ZSAhPT0gMyAmJiB0aGlzLl9uYWx1TGVuZ3RoU2l6ZSAhPT0gNCkge1xuICAgICAgICAgICAgICAgIC8vIGhvbHkgc2hpdCEhIVxuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoX2RlbXV4RXJyb3JzMi5kZWZhdWx0LkZPUk1BVF9FUlJPUiwgJ0ZsdjogU3RyYW5nZSBOYWx1TGVuZ3RoU2l6ZU1pbnVzT25lOiAnICsgKHRoaXMuX25hbHVMZW5ndGhTaXplIC0gMSkpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHNwc0NvdW50ID0gdi5nZXRVaW50OCg1KSAmIDMxOyAvLyBudW1PZlNlcXVlbmNlUGFyYW1ldGVyU2V0c1xuICAgICAgICAgICAgaWYgKHNwc0NvdW50ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcihfZGVtdXhFcnJvcnMyLmRlZmF1bHQuRk9STUFUX0VSUk9SLCAnRmx2OiBJbnZhbGlkIEFWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkOiBObyBTUFMnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNwc0NvdW50ID4gMSkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ0ZsdjogU3RyYW5nZSBBVkNEZWNvZGVyQ29uZmlndXJhdGlvblJlY29yZDogU1BTIENvdW50ID0gJyArIHNwc0NvdW50KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIG9mZnNldCA9IDY7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3BzQ291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBsZW4gPSB2LmdldFVpbnQxNihvZmZzZXQsICFsZSk7IC8vIHNlcXVlbmNlUGFyYW1ldGVyU2V0TGVuZ3RoXG4gICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDI7XG5cbiAgICAgICAgICAgICAgICBpZiAobGVuID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIE5vdGljZTogTmFsdSB3aXRob3V0IHN0YXJ0Y29kZSBoZWFkZXIgKDAwIDAwIDAwIDAxKVxuICAgICAgICAgICAgICAgIHZhciBzcHMgPSBuZXcgVWludDhBcnJheShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIG9mZnNldCwgbGVuKTtcbiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gbGVuO1xuXG4gICAgICAgICAgICAgICAgdmFyIGNvbmZpZyA9IF9zcHNQYXJzZXIyLmRlZmF1bHQucGFyc2VTUFMoc3BzKTtcbiAgICAgICAgICAgICAgICBpZiAoaSAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBpZ25vcmUgb3RoZXIgc3BzJ3MgY29uZmlnXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG1ldGEuY29kZWNXaWR0aCA9IGNvbmZpZy5jb2RlY19zaXplLndpZHRoO1xuICAgICAgICAgICAgICAgIG1ldGEuY29kZWNIZWlnaHQgPSBjb25maWcuY29kZWNfc2l6ZS5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgbWV0YS5wcmVzZW50V2lkdGggPSBjb25maWcucHJlc2VudF9zaXplLndpZHRoO1xuICAgICAgICAgICAgICAgIG1ldGEucHJlc2VudEhlaWdodCA9IGNvbmZpZy5wcmVzZW50X3NpemUuaGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgbWV0YS5wcm9maWxlID0gY29uZmlnLnByb2ZpbGVfc3RyaW5nO1xuICAgICAgICAgICAgICAgIG1ldGEubGV2ZWwgPSBjb25maWcubGV2ZWxfc3RyaW5nO1xuICAgICAgICAgICAgICAgIG1ldGEuYml0RGVwdGggPSBjb25maWcuYml0X2RlcHRoO1xuICAgICAgICAgICAgICAgIG1ldGEuY2hyb21hRm9ybWF0ID0gY29uZmlnLmNocm9tYV9mb3JtYXQ7XG4gICAgICAgICAgICAgICAgbWV0YS5zYXJSYXRpbyA9IGNvbmZpZy5zYXJfcmF0aW87XG4gICAgICAgICAgICAgICAgbWV0YS5mcmFtZVJhdGUgPSBjb25maWcuZnJhbWVfcmF0ZTtcblxuICAgICAgICAgICAgICAgIGlmIChjb25maWcuZnJhbWVfcmF0ZS5maXhlZCA9PT0gZmFsc2UgfHwgY29uZmlnLmZyYW1lX3JhdGUuZnBzX251bSA9PT0gMCB8fCBjb25maWcuZnJhbWVfcmF0ZS5mcHNfZGVuID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIG1ldGEuZnJhbWVSYXRlID0gdGhpcy5fcmVmZXJlbmNlRnJhbWVSYXRlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBmcHNfZGVuID0gbWV0YS5mcmFtZVJhdGUuZnBzX2RlbjtcbiAgICAgICAgICAgICAgICB2YXIgZnBzX251bSA9IG1ldGEuZnJhbWVSYXRlLmZwc19udW07XG4gICAgICAgICAgICAgICAgbWV0YS5yZWZTYW1wbGVEdXJhdGlvbiA9IG1ldGEudGltZXNjYWxlICogKGZwc19kZW4gLyBmcHNfbnVtKTtcblxuICAgICAgICAgICAgICAgIHZhciBjb2RlY0FycmF5ID0gc3BzLnN1YmFycmF5KDEsIDQpO1xuICAgICAgICAgICAgICAgIHZhciBjb2RlY1N0cmluZyA9ICdhdmMxLic7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCAzOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGggPSBjb2RlY0FycmF5W2pdLnRvU3RyaW5nKDE2KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGgubGVuZ3RoIDwgMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaCA9ICcwJyArIGg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29kZWNTdHJpbmcgKz0gaDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbWV0YS5jb2RlYyA9IGNvZGVjU3RyaW5nO1xuXG4gICAgICAgICAgICAgICAgdmFyIG1pID0gdGhpcy5fbWVkaWFJbmZvO1xuICAgICAgICAgICAgICAgIG1pLndpZHRoID0gbWV0YS5jb2RlY1dpZHRoO1xuICAgICAgICAgICAgICAgIG1pLmhlaWdodCA9IG1ldGEuY29kZWNIZWlnaHQ7XG4gICAgICAgICAgICAgICAgbWkuZnBzID0gbWV0YS5mcmFtZVJhdGUuZnBzO1xuICAgICAgICAgICAgICAgIG1pLnByb2ZpbGUgPSBtZXRhLnByb2ZpbGU7XG4gICAgICAgICAgICAgICAgbWkubGV2ZWwgPSBtZXRhLmxldmVsO1xuICAgICAgICAgICAgICAgIG1pLnJlZkZyYW1lcyA9IGNvbmZpZy5yZWZfZnJhbWVzO1xuICAgICAgICAgICAgICAgIG1pLmNocm9tYUZvcm1hdCA9IGNvbmZpZy5jaHJvbWFfZm9ybWF0X3N0cmluZztcbiAgICAgICAgICAgICAgICBtaS5zYXJOdW0gPSBtZXRhLnNhclJhdGlvLndpZHRoO1xuICAgICAgICAgICAgICAgIG1pLnNhckRlbiA9IG1ldGEuc2FyUmF0aW8uaGVpZ2h0O1xuICAgICAgICAgICAgICAgIG1pLnZpZGVvQ29kZWMgPSBjb2RlY1N0cmluZztcblxuICAgICAgICAgICAgICAgIGlmIChtaS5oYXNBdWRpbykge1xuICAgICAgICAgICAgICAgICAgICBpZiAobWkuYXVkaW9Db2RlYyAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtaS5taW1lVHlwZSA9ICd2aWRlby94LWZsdjsgY29kZWNzPVwiJyArIG1pLnZpZGVvQ29kZWMgKyAnLCcgKyBtaS5hdWRpb0NvZGVjICsgJ1wiJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG1pLm1pbWVUeXBlID0gJ3ZpZGVvL3gtZmx2OyBjb2RlY3M9XCInICsgbWkudmlkZW9Db2RlYyArICdcIic7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChtaS5pc0NvbXBsZXRlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25NZWRpYUluZm8obWkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHBwc0NvdW50ID0gdi5nZXRVaW50OChvZmZzZXQpOyAvLyBudW1PZlBpY3R1cmVQYXJhbWV0ZXJTZXRzXG4gICAgICAgICAgICBpZiAocHBzQ291bnQgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKF9kZW11eEVycm9yczIuZGVmYXVsdC5GT1JNQVRfRVJST1IsICdGbHY6IEludmFsaWQgQVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQ6IE5vIFBQUycpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocHBzQ291bnQgPiAxKSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnRmx2OiBTdHJhbmdlIEFWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkOiBQUFMgQ291bnQgPSAnICsgcHBzQ291bnQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBvZmZzZXQrKztcblxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IHBwc0NvdW50OyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9sZW4gPSB2LmdldFVpbnQxNihvZmZzZXQsICFsZSk7IC8vIHBpY3R1cmVQYXJhbWV0ZXJTZXRMZW5ndGhcbiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gMjtcblxuICAgICAgICAgICAgICAgIGlmIChfbGVuID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIHBwcyBpcyB1c2VsZXNzIGZvciBleHRyYWN0aW5nIHZpZGVvIGluZm9ybWF0aW9uXG4gICAgICAgICAgICAgICAgb2Zmc2V0ICs9IF9sZW47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG1ldGEuYXZjYyA9IG5ldyBVaW50OEFycmF5KGRhdGFTaXplKTtcbiAgICAgICAgICAgIG1ldGEuYXZjYy5zZXQobmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKSwgMCk7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYodGhpcy5UQUcsICdQYXJzZWQgQVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQnKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzSW5pdGlhbE1ldGFkYXRhRGlzcGF0Y2hlZCgpKSB7XG4gICAgICAgICAgICAgICAgLy8gZmx1c2ggcGFyc2VkIGZyYW1lc1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9kaXNwYXRjaCAmJiAodGhpcy5fYXVkaW9UcmFjay5sZW5ndGggfHwgdGhpcy5fdmlkZW9UcmFjay5sZW5ndGgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uRGF0YUF2YWlsYWJsZSh0aGlzLl9hdWRpb1RyYWNrLCB0aGlzLl92aWRlb1RyYWNrKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZGVvSW5pdGlhbE1ldGFkYXRhRGlzcGF0Y2hlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBub3RpZnkgbmV3IG1ldGFkYXRhXG4gICAgICAgICAgICB0aGlzLl9kaXNwYXRjaCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fb25UcmFja01ldGFkYXRhKCd2aWRlbycsIG1ldGEpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcGFyc2VBVkNWaWRlb0RhdGEnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3BhcnNlQVZDVmlkZW9EYXRhKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSwgdGFnVGltZXN0YW1wLCB0YWdQb3NpdGlvbiwgZnJhbWVUeXBlLCBjdHMpIHtcbiAgICAgICAgICAgIHZhciBsZSA9IHRoaXMuX2xpdHRsZUVuZGlhbjtcbiAgICAgICAgICAgIHZhciB2ID0gbmV3IERhdGFWaWV3KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSk7XG5cbiAgICAgICAgICAgIHZhciB1bml0cyA9IFtdLFxuICAgICAgICAgICAgICAgIGxlbmd0aCA9IDA7XG5cbiAgICAgICAgICAgIHZhciBvZmZzZXQgPSAwO1xuICAgICAgICAgICAgdmFyIGxlbmd0aFNpemUgPSB0aGlzLl9uYWx1TGVuZ3RoU2l6ZTtcbiAgICAgICAgICAgIHZhciBkdHMgPSB0aGlzLl90aW1lc3RhbXBCYXNlICsgdGFnVGltZXN0YW1wO1xuICAgICAgICAgICAgdmFyIGtleWZyYW1lID0gZnJhbWVUeXBlID09PSAxOyAvLyBmcm9tIEZMViBGcmFtZSBUeXBlIGNvbnN0YW50c1xuXG4gICAgICAgICAgICB3aGlsZSAob2Zmc2V0IDwgZGF0YVNpemUpIHtcbiAgICAgICAgICAgICAgICBpZiAob2Zmc2V0ICsgNCA+PSBkYXRhU2l6ZSkge1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdNYWxmb3JtZWQgTmFsdSBuZWFyIHRpbWVzdGFtcCAnICsgZHRzICsgJywgb2Zmc2V0ID0gJyArIG9mZnNldCArICcsIGRhdGFTaXplID0gJyArIGRhdGFTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7IC8vIGRhdGEgbm90IGVub3VnaCBmb3IgbmV4dCBOYWx1XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIE5hbHUgd2l0aCBsZW5ndGgtaGVhZGVyIChBVkMxKVxuICAgICAgICAgICAgICAgIHZhciBuYWx1U2l6ZSA9IHYuZ2V0VWludDMyKG9mZnNldCwgIWxlKTsgLy8gQmlnLUVuZGlhbiByZWFkXG4gICAgICAgICAgICAgICAgaWYgKGxlbmd0aFNpemUgPT09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgbmFsdVNpemUgPj4+PSA4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobmFsdVNpemUgPiBkYXRhU2l6ZSAtIGxlbmd0aFNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnTWFsZm9ybWVkIE5hbHVzIG5lYXIgdGltZXN0YW1wICcgKyBkdHMgKyAnLCBOYWx1U2l6ZSA+IERhdGFTaXplIScpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHVuaXRUeXBlID0gdi5nZXRVaW50OChvZmZzZXQgKyBsZW5ndGhTaXplKSAmIDB4MUY7XG5cbiAgICAgICAgICAgICAgICBpZiAodW5pdFR5cGUgPT09IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSURSXG4gICAgICAgICAgICAgICAgICAgIGtleWZyYW1lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgb2Zmc2V0LCBsZW5ndGhTaXplICsgbmFsdVNpemUpO1xuICAgICAgICAgICAgICAgIHZhciB1bml0ID0geyB0eXBlOiB1bml0VHlwZSwgZGF0YTogZGF0YSB9O1xuICAgICAgICAgICAgICAgIHVuaXRzLnB1c2godW5pdCk7XG4gICAgICAgICAgICAgICAgbGVuZ3RoICs9IGRhdGEuYnl0ZUxlbmd0aDtcblxuICAgICAgICAgICAgICAgIG9mZnNldCArPSBsZW5ndGhTaXplICsgbmFsdVNpemU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh1bml0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdHJhY2sgPSB0aGlzLl92aWRlb1RyYWNrO1xuICAgICAgICAgICAgICAgIHZhciBhdmNTYW1wbGUgPSB7XG4gICAgICAgICAgICAgICAgICAgIHVuaXRzOiB1bml0cyxcbiAgICAgICAgICAgICAgICAgICAgbGVuZ3RoOiBsZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgIGlzS2V5ZnJhbWU6IGtleWZyYW1lLFxuICAgICAgICAgICAgICAgICAgICBkdHM6IGR0cyxcbiAgICAgICAgICAgICAgICAgICAgY3RzOiBjdHMsXG4gICAgICAgICAgICAgICAgICAgIHB0czogZHRzICsgY3RzXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICBpZiAoa2V5ZnJhbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgYXZjU2FtcGxlLmZpbGVwb3NpdGlvbiA9IHRhZ1Bvc2l0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0cmFjay5zYW1wbGVzLnB1c2goYXZjU2FtcGxlKTtcbiAgICAgICAgICAgICAgICB0cmFjay5sZW5ndGggKz0gbGVuZ3RoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvblRyYWNrTWV0YWRhdGEnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vblRyYWNrTWV0YWRhdGE7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vblRyYWNrTWV0YWRhdGEgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHByb3RvdHlwZTogZnVuY3Rpb24obWVkaWFJbmZvOiBNZWRpYUluZm8pOiB2b2lkXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uTWVkaWFJbmZvJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25NZWRpYUluZm87XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vbk1lZGlhSW5mbyA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbk1ldGFEYXRhQXJyaXZlZCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uTWV0YURhdGFBcnJpdmVkO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25NZXRhRGF0YUFycml2ZWQgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25TY3JpcHREYXRhQXJyaXZlZCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uU2NyaXB0RGF0YUFycml2ZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vblNjcmlwdERhdGFBcnJpdmVkID0gY2FsbGJhY2s7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBwcm90b3R5cGU6IGZ1bmN0aW9uKHR5cGU6IG51bWJlciwgaW5mbzogc3RyaW5nKTogdm9pZFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbkVycm9yJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25FcnJvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uRXJyb3IgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHByb3RvdHlwZTogZnVuY3Rpb24odmlkZW9UcmFjazogYW55LCBhdWRpb1RyYWNrOiBhbnkpOiB2b2lkXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uRGF0YUF2YWlsYWJsZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uRGF0YUF2YWlsYWJsZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uRGF0YUF2YWlsYWJsZSA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvblN0cmVhbVRpbWUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vblN0cmVhbVRpbWU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vblN0cmVhbVRpbWUgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHRpbWVzdGFtcCBiYXNlIGZvciBvdXRwdXQgc2FtcGxlcywgbXVzdCBiZSBpbiBtaWxsaXNlY29uZHNcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndGltZXN0YW1wQmFzZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RpbWVzdGFtcEJhc2U7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGJhc2UpIHtcbiAgICAgICAgICAgIHRoaXMuX3RpbWVzdGFtcEJhc2UgPSBiYXNlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvdmVycmlkZWREdXJhdGlvbicsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2R1cmF0aW9uO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRm9yY2Utb3ZlcnJpZGUgbWVkaWEgZHVyYXRpb24uIE11c3QgYmUgaW4gbWlsbGlzZWNvbmRzLCBpbnQzMlxuICAgICAgICAsXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGR1cmF0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLl9kdXJhdGlvbk92ZXJyaWRlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl9kdXJhdGlvbiA9IGR1cmF0aW9uO1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmR1cmF0aW9uID0gZHVyYXRpb247XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGb3JjZS1vdmVycmlkZSBhdWRpbyB0cmFjayBwcmVzZW50IGZsYWcsIGJvb2xlYW5cblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb3ZlcnJpZGVkSGFzQXVkaW8nLFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChoYXNBdWRpbykge1xuICAgICAgICAgICAgdGhpcy5faGFzQXVkaW9GbGFnT3ZlcnJpZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuX2hhc0F1ZGlvID0gaGFzQXVkaW87XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uaGFzQXVkaW8gPSBoYXNBdWRpbztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZvcmNlLW92ZXJyaWRlIHZpZGVvIHRyYWNrIHByZXNlbnQgZmxhZywgYm9vbGVhblxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvdmVycmlkZWRIYXNWaWRlbycsXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGhhc1ZpZGVvKSB7XG4gICAgICAgICAgICB0aGlzLl9oYXNWaWRlb0ZsYWdPdmVycmlkZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5faGFzVmlkZW8gPSBoYXNWaWRlbztcbiAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5oYXNWaWRlbyA9IGhhc1ZpZGVvO1xuICAgICAgICB9XG4gICAgfV0sIFt7XG4gICAgICAgIGtleTogJ3Byb2JlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHByb2JlKGJ1ZmZlcikge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBuZXcgVWludDhBcnJheShidWZmZXIpO1xuICAgICAgICAgICAgdmFyIG1pc21hdGNoID0geyBtYXRjaDogZmFsc2UgfTtcblxuICAgICAgICAgICAgaWYgKGRhdGFbMF0gIT09IDB4NDYgfHwgZGF0YVsxXSAhPT0gMHg0QyB8fCBkYXRhWzJdICE9PSAweDU2IHx8IGRhdGFbM10gIT09IDB4MDEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWlzbWF0Y2g7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBoYXNBdWRpbyA9IChkYXRhWzRdICYgNCkgPj4+IDIgIT09IDA7XG4gICAgICAgICAgICB2YXIgaGFzVmlkZW8gPSAoZGF0YVs0XSAmIDEpICE9PSAwO1xuXG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gUmVhZEJpZzMyKGRhdGEsIDUpO1xuXG4gICAgICAgICAgICBpZiAob2Zmc2V0IDwgOSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBtaXNtYXRjaDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBtYXRjaDogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb25zdW1lZDogb2Zmc2V0LFxuICAgICAgICAgICAgICAgIGRhdGFPZmZzZXQ6IG9mZnNldCxcbiAgICAgICAgICAgICAgICBoYXNBdWRpb1RyYWNrOiBoYXNBdWRpbyxcbiAgICAgICAgICAgICAgICBoYXNWaWRlb1RyYWNrOiBoYXNWaWRlb1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBGTFZEZW11eGVyO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBGTFZEZW11eGVyO1xuXG59LHtcIi4uL2NvcmUvbWVkaWEtaW5mby5qc1wiOjcsXCIuLi91dGlscy9leGNlcHRpb24uanNcIjo0MCxcIi4uL3V0aWxzL2xvZ2dlci5qc1wiOjQxLFwiLi9hbWYtcGFyc2VyLmpzXCI6MTUsXCIuL2RlbXV4LWVycm9ycy5qc1wiOjE2LFwiLi9zcHMtcGFyc2VyLmpzXCI6MTl9XSwxOTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfZXhwR29sb21iID0gX2RlcmVxXygnLi9leHAtZ29sb21iLmpzJyk7XG5cbnZhciBfZXhwR29sb21iMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V4cEdvbG9tYik7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBTUFNQYXJzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU1BTUGFyc2VyKCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU1BTUGFyc2VyKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoU1BTUGFyc2VyLCBudWxsLCBbe1xuICAgICAgICBrZXk6ICdfZWJzcDJyYnNwJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9lYnNwMnJic3AodWludDhhcnJheSkge1xuICAgICAgICAgICAgdmFyIHNyYyA9IHVpbnQ4YXJyYXk7XG4gICAgICAgICAgICB2YXIgc3JjX2xlbmd0aCA9IHNyYy5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGRzdCA9IG5ldyBVaW50OEFycmF5KHNyY19sZW5ndGgpO1xuICAgICAgICAgICAgdmFyIGRzdF9pZHggPSAwO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNyY19sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChpID49IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVW5lc2NhcGU6IFNraXAgMHgwMyBhZnRlciAwMCAwMFxuICAgICAgICAgICAgICAgICAgICBpZiAoc3JjW2ldID09PSAweDAzICYmIHNyY1tpIC0gMV0gPT09IDB4MDAgJiYgc3JjW2kgLSAyXSA9PT0gMHgwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZHN0W2RzdF9pZHhdID0gc3JjW2ldO1xuICAgICAgICAgICAgICAgIGRzdF9pZHgrKztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KGRzdC5idWZmZXIsIDAsIGRzdF9pZHgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwYXJzZVNQUycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXJzZVNQUyh1aW50OGFycmF5KSB7XG4gICAgICAgICAgICB2YXIgcmJzcCA9IFNQU1BhcnNlci5fZWJzcDJyYnNwKHVpbnQ4YXJyYXkpO1xuICAgICAgICAgICAgdmFyIGdiID0gbmV3IF9leHBHb2xvbWIyLmRlZmF1bHQocmJzcCk7XG5cbiAgICAgICAgICAgIGdiLnJlYWRCeXRlKCk7XG4gICAgICAgICAgICB2YXIgcHJvZmlsZV9pZGMgPSBnYi5yZWFkQnl0ZSgpOyAvLyBwcm9maWxlX2lkY1xuICAgICAgICAgICAgZ2IucmVhZEJ5dGUoKTsgLy8gY29uc3RyYWludF9zZXRfZmxhZ3NbNV0gKyByZXNlcnZlZF96ZXJvWzNdXG4gICAgICAgICAgICB2YXIgbGV2ZWxfaWRjID0gZ2IucmVhZEJ5dGUoKTsgLy8gbGV2ZWxfaWRjXG4gICAgICAgICAgICBnYi5yZWFkVUVHKCk7IC8vIHNlcV9wYXJhbWV0ZXJfc2V0X2lkXG5cbiAgICAgICAgICAgIHZhciBwcm9maWxlX3N0cmluZyA9IFNQU1BhcnNlci5nZXRQcm9maWxlU3RyaW5nKHByb2ZpbGVfaWRjKTtcbiAgICAgICAgICAgIHZhciBsZXZlbF9zdHJpbmcgPSBTUFNQYXJzZXIuZ2V0TGV2ZWxTdHJpbmcobGV2ZWxfaWRjKTtcbiAgICAgICAgICAgIHZhciBjaHJvbWFfZm9ybWF0X2lkYyA9IDE7XG4gICAgICAgICAgICB2YXIgY2hyb21hX2Zvcm1hdCA9IDQyMDtcbiAgICAgICAgICAgIHZhciBjaHJvbWFfZm9ybWF0X3RhYmxlID0gWzAsIDQyMCwgNDIyLCA0NDRdO1xuICAgICAgICAgICAgdmFyIGJpdF9kZXB0aCA9IDg7XG5cbiAgICAgICAgICAgIGlmIChwcm9maWxlX2lkYyA9PT0gMTAwIHx8IHByb2ZpbGVfaWRjID09PSAxMTAgfHwgcHJvZmlsZV9pZGMgPT09IDEyMiB8fCBwcm9maWxlX2lkYyA9PT0gMjQ0IHx8IHByb2ZpbGVfaWRjID09PSA0NCB8fCBwcm9maWxlX2lkYyA9PT0gODMgfHwgcHJvZmlsZV9pZGMgPT09IDg2IHx8IHByb2ZpbGVfaWRjID09PSAxMTggfHwgcHJvZmlsZV9pZGMgPT09IDEyOCB8fCBwcm9maWxlX2lkYyA9PT0gMTM4IHx8IHByb2ZpbGVfaWRjID09PSAxNDQpIHtcblxuICAgICAgICAgICAgICAgIGNocm9tYV9mb3JtYXRfaWRjID0gZ2IucmVhZFVFRygpO1xuICAgICAgICAgICAgICAgIGlmIChjaHJvbWFfZm9ybWF0X2lkYyA9PT0gMykge1xuICAgICAgICAgICAgICAgICAgICBnYi5yZWFkQml0cygxKTsgLy8gc2VwYXJhdGVfY29sb3VyX3BsYW5lX2ZsYWdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGNocm9tYV9mb3JtYXRfaWRjIDw9IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgY2hyb21hX2Zvcm1hdCA9IGNocm9tYV9mb3JtYXRfdGFibGVbY2hyb21hX2Zvcm1hdF9pZGNdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGJpdF9kZXB0aCA9IGdiLnJlYWRVRUcoKSArIDg7IC8vIGJpdF9kZXB0aF9sdW1hX21pbnVzOFxuICAgICAgICAgICAgICAgIGdiLnJlYWRVRUcoKTsgLy8gYml0X2RlcHRoX2Nocm9tYV9taW51czhcbiAgICAgICAgICAgICAgICBnYi5yZWFkQml0cygxKTsgLy8gcXBwcmltZV95X3plcm9fdHJhbnNmb3JtX2J5cGFzc19mbGFnXG4gICAgICAgICAgICAgICAgaWYgKGdiLnJlYWRCb29sKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gc2VxX3NjYWxpbmdfbWF0cml4X3ByZXNlbnRfZmxhZ1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2NhbGluZ19saXN0X2NvdW50ID0gY2hyb21hX2Zvcm1hdF9pZGMgIT09IDMgPyA4IDogMTI7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2NhbGluZ19saXN0X2NvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnYi5yZWFkQm9vbCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VxX3NjYWxpbmdfbGlzdF9wcmVzZW50X2ZsYWdcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IDYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BTUGFyc2VyLl9za2lwU2NhbGluZ0xpc3QoZ2IsIDE2KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUFNQYXJzZXIuX3NraXBTY2FsaW5nTGlzdChnYiwgNjQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdiLnJlYWRVRUcoKTsgLy8gbG9nMl9tYXhfZnJhbWVfbnVtX21pbnVzNFxuICAgICAgICAgICAgdmFyIHBpY19vcmRlcl9jbnRfdHlwZSA9IGdiLnJlYWRVRUcoKTtcbiAgICAgICAgICAgIGlmIChwaWNfb3JkZXJfY250X3R5cGUgPT09IDApIHtcbiAgICAgICAgICAgICAgICBnYi5yZWFkVUVHKCk7IC8vIGxvZzJfbWF4X3BpY19vcmRlcl9jbnRfbHNiX21pbnVzXzRcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGljX29yZGVyX2NudF90eXBlID09PSAxKSB7XG4gICAgICAgICAgICAgICAgZ2IucmVhZEJpdHMoMSk7IC8vIGRlbHRhX3BpY19vcmRlcl9hbHdheXNfemVyb19mbGFnXG4gICAgICAgICAgICAgICAgZ2IucmVhZFNFRygpOyAvLyBvZmZzZXRfZm9yX25vbl9yZWZfcGljXG4gICAgICAgICAgICAgICAgZ2IucmVhZFNFRygpOyAvLyBvZmZzZXRfZm9yX3RvcF90b19ib3R0b21fZmllbGRcbiAgICAgICAgICAgICAgICB2YXIgbnVtX3JlZl9mcmFtZXNfaW5fcGljX29yZGVyX2NudF9jeWNsZSA9IGdiLnJlYWRVRUcoKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgbnVtX3JlZl9mcmFtZXNfaW5fcGljX29yZGVyX2NudF9jeWNsZTsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICBnYi5yZWFkU0VHKCk7IC8vIG9mZnNldF9mb3JfcmVmX2ZyYW1lXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHJlZl9mcmFtZXMgPSBnYi5yZWFkVUVHKCk7IC8vIG1heF9udW1fcmVmX2ZyYW1lc1xuICAgICAgICAgICAgZ2IucmVhZEJpdHMoMSk7IC8vIGdhcHNfaW5fZnJhbWVfbnVtX3ZhbHVlX2FsbG93ZWRfZmxhZ1xuXG4gICAgICAgICAgICB2YXIgcGljX3dpZHRoX2luX21ic19taW51czEgPSBnYi5yZWFkVUVHKCk7XG4gICAgICAgICAgICB2YXIgcGljX2hlaWdodF9pbl9tYXBfdW5pdHNfbWludXMxID0gZ2IucmVhZFVFRygpO1xuXG4gICAgICAgICAgICB2YXIgZnJhbWVfbWJzX29ubHlfZmxhZyA9IGdiLnJlYWRCaXRzKDEpO1xuICAgICAgICAgICAgaWYgKGZyYW1lX21ic19vbmx5X2ZsYWcgPT09IDApIHtcbiAgICAgICAgICAgICAgICBnYi5yZWFkQml0cygxKTsgLy8gbWJfYWRhcHRpdmVfZnJhbWVfZmllbGRfZmxhZ1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2IucmVhZEJpdHMoMSk7IC8vIGRpcmVjdF84eDhfaW5mZXJlbmNlX2ZsYWdcblxuICAgICAgICAgICAgdmFyIGZyYW1lX2Nyb3BfbGVmdF9vZmZzZXQgPSAwO1xuICAgICAgICAgICAgdmFyIGZyYW1lX2Nyb3BfcmlnaHRfb2Zmc2V0ID0gMDtcbiAgICAgICAgICAgIHZhciBmcmFtZV9jcm9wX3RvcF9vZmZzZXQgPSAwO1xuICAgICAgICAgICAgdmFyIGZyYW1lX2Nyb3BfYm90dG9tX29mZnNldCA9IDA7XG5cbiAgICAgICAgICAgIHZhciBmcmFtZV9jcm9wcGluZ19mbGFnID0gZ2IucmVhZEJvb2woKTtcbiAgICAgICAgICAgIGlmIChmcmFtZV9jcm9wcGluZ19mbGFnKSB7XG4gICAgICAgICAgICAgICAgZnJhbWVfY3JvcF9sZWZ0X29mZnNldCA9IGdiLnJlYWRVRUcoKTtcbiAgICAgICAgICAgICAgICBmcmFtZV9jcm9wX3JpZ2h0X29mZnNldCA9IGdiLnJlYWRVRUcoKTtcbiAgICAgICAgICAgICAgICBmcmFtZV9jcm9wX3RvcF9vZmZzZXQgPSBnYi5yZWFkVUVHKCk7XG4gICAgICAgICAgICAgICAgZnJhbWVfY3JvcF9ib3R0b21fb2Zmc2V0ID0gZ2IucmVhZFVFRygpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc2FyX3dpZHRoID0gMSxcbiAgICAgICAgICAgICAgICBzYXJfaGVpZ2h0ID0gMTtcbiAgICAgICAgICAgIHZhciBmcHMgPSAwLFxuICAgICAgICAgICAgICAgIGZwc19maXhlZCA9IHRydWUsXG4gICAgICAgICAgICAgICAgZnBzX251bSA9IDAsXG4gICAgICAgICAgICAgICAgZnBzX2RlbiA9IDA7XG5cbiAgICAgICAgICAgIHZhciB2dWlfcGFyYW1ldGVyc19wcmVzZW50X2ZsYWcgPSBnYi5yZWFkQm9vbCgpO1xuICAgICAgICAgICAgaWYgKHZ1aV9wYXJhbWV0ZXJzX3ByZXNlbnRfZmxhZykge1xuICAgICAgICAgICAgICAgIGlmIChnYi5yZWFkQm9vbCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFzcGVjdF9yYXRpb19pbmZvX3ByZXNlbnRfZmxhZ1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXNwZWN0X3JhdGlvX2lkYyA9IGdiLnJlYWRCeXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzYXJfd190YWJsZSA9IFsxLCAxMiwgMTAsIDE2LCA0MCwgMjQsIDIwLCAzMiwgODAsIDE4LCAxNSwgNjQsIDE2MCwgNCwgMywgMl07XG4gICAgICAgICAgICAgICAgICAgIHZhciBzYXJfaF90YWJsZSA9IFsxLCAxMSwgMTEsIDExLCAzMywgMTEsIDExLCAxMSwgMzMsIDExLCAxMSwgMzMsIDk5LCAzLCAyLCAxXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoYXNwZWN0X3JhdGlvX2lkYyA+IDAgJiYgYXNwZWN0X3JhdGlvX2lkYyA8IDE2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzYXJfd2lkdGggPSBzYXJfd190YWJsZVthc3BlY3RfcmF0aW9faWRjIC0gMV07XG4gICAgICAgICAgICAgICAgICAgICAgICBzYXJfaGVpZ2h0ID0gc2FyX2hfdGFibGVbYXNwZWN0X3JhdGlvX2lkYyAtIDFdO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGFzcGVjdF9yYXRpb19pZGMgPT09IDI1NSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2FyX3dpZHRoID0gZ2IucmVhZEJ5dGUoKSA8PCA4IHwgZ2IucmVhZEJ5dGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhcl9oZWlnaHQgPSBnYi5yZWFkQnl0ZSgpIDw8IDggfCBnYi5yZWFkQnl0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGdiLnJlYWRCb29sKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gb3ZlcnNjYW5faW5mb19wcmVzZW50X2ZsYWdcbiAgICAgICAgICAgICAgICAgICAgZ2IucmVhZEJvb2woKTsgLy8gb3ZlcnNjYW5fYXBwcm9wcmlhdGVfZmxhZ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZ2IucmVhZEJvb2woKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyB2aWRlb19zaWduYWxfdHlwZV9wcmVzZW50X2ZsYWdcbiAgICAgICAgICAgICAgICAgICAgZ2IucmVhZEJpdHMoNCk7IC8vIHZpZGVvX2Zvcm1hdCAmIHZpZGVvX2Z1bGxfcmFuZ2VfZmxhZ1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2IucmVhZEJvb2woKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29sb3VyX2Rlc2NyaXB0aW9uX3ByZXNlbnRfZmxhZ1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2IucmVhZEJpdHMoMjQpOyAvLyBjb2xvdXJfcHJpbWFyaWVzICYgdHJhbnNmZXJfY2hhcmFjdGVyaXN0aWNzICYgbWF0cml4X2NvZWZmaWNpZW50c1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnYi5yZWFkQm9vbCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNocm9tYV9sb2NfaW5mb19wcmVzZW50X2ZsYWdcbiAgICAgICAgICAgICAgICAgICAgZ2IucmVhZFVFRygpOyAvLyBjaHJvbWFfc2FtcGxlX2xvY190eXBlX3RvcF9maWVsZFxuICAgICAgICAgICAgICAgICAgICBnYi5yZWFkVUVHKCk7IC8vIGNocm9tYV9zYW1wbGVfbG9jX3R5cGVfYm90dG9tX2ZpZWxkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnYi5yZWFkQm9vbCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRpbWluZ19pbmZvX3ByZXNlbnRfZmxhZ1xuICAgICAgICAgICAgICAgICAgICB2YXIgbnVtX3VuaXRzX2luX3RpY2sgPSBnYi5yZWFkQml0cygzMik7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aW1lX3NjYWxlID0gZ2IucmVhZEJpdHMoMzIpO1xuICAgICAgICAgICAgICAgICAgICBmcHNfZml4ZWQgPSBnYi5yZWFkQm9vbCgpOyAvLyBmaXhlZF9mcmFtZV9yYXRlX2ZsYWdcblxuICAgICAgICAgICAgICAgICAgICBmcHNfbnVtID0gdGltZV9zY2FsZTtcbiAgICAgICAgICAgICAgICAgICAgZnBzX2RlbiA9IG51bV91bml0c19pbl90aWNrICogMjtcbiAgICAgICAgICAgICAgICAgICAgZnBzID0gZnBzX251bSAvIGZwc19kZW47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc2FyU2NhbGUgPSAxO1xuICAgICAgICAgICAgaWYgKHNhcl93aWR0aCAhPT0gMSB8fCBzYXJfaGVpZ2h0ICE9PSAxKSB7XG4gICAgICAgICAgICAgICAgc2FyU2NhbGUgPSBzYXJfd2lkdGggLyBzYXJfaGVpZ2h0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgY3JvcF91bml0X3ggPSAwLFxuICAgICAgICAgICAgICAgIGNyb3BfdW5pdF95ID0gMDtcbiAgICAgICAgICAgIGlmIChjaHJvbWFfZm9ybWF0X2lkYyA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGNyb3BfdW5pdF94ID0gMTtcbiAgICAgICAgICAgICAgICBjcm9wX3VuaXRfeSA9IDIgLSBmcmFtZV9tYnNfb25seV9mbGFnO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgc3ViX3djID0gY2hyb21hX2Zvcm1hdF9pZGMgPT09IDMgPyAxIDogMjtcbiAgICAgICAgICAgICAgICB2YXIgc3ViX2hjID0gY2hyb21hX2Zvcm1hdF9pZGMgPT09IDEgPyAyIDogMTtcbiAgICAgICAgICAgICAgICBjcm9wX3VuaXRfeCA9IHN1Yl93YztcbiAgICAgICAgICAgICAgICBjcm9wX3VuaXRfeSA9IHN1Yl9oYyAqICgyIC0gZnJhbWVfbWJzX29ubHlfZmxhZyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBjb2RlY193aWR0aCA9IChwaWNfd2lkdGhfaW5fbWJzX21pbnVzMSArIDEpICogMTY7XG4gICAgICAgICAgICB2YXIgY29kZWNfaGVpZ2h0ID0gKDIgLSBmcmFtZV9tYnNfb25seV9mbGFnKSAqICgocGljX2hlaWdodF9pbl9tYXBfdW5pdHNfbWludXMxICsgMSkgKiAxNik7XG5cbiAgICAgICAgICAgIGNvZGVjX3dpZHRoIC09IChmcmFtZV9jcm9wX2xlZnRfb2Zmc2V0ICsgZnJhbWVfY3JvcF9yaWdodF9vZmZzZXQpICogY3JvcF91bml0X3g7XG4gICAgICAgICAgICBjb2RlY19oZWlnaHQgLT0gKGZyYW1lX2Nyb3BfdG9wX29mZnNldCArIGZyYW1lX2Nyb3BfYm90dG9tX29mZnNldCkgKiBjcm9wX3VuaXRfeTtcblxuICAgICAgICAgICAgdmFyIHByZXNlbnRfd2lkdGggPSBNYXRoLmNlaWwoY29kZWNfd2lkdGggKiBzYXJTY2FsZSk7XG5cbiAgICAgICAgICAgIGdiLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIGdiID0gbnVsbDtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBwcm9maWxlX3N0cmluZzogcHJvZmlsZV9zdHJpbmcsIC8vIGJhc2VsaW5lLCBoaWdoLCBoaWdoMTAsIC4uLlxuICAgICAgICAgICAgICAgIGxldmVsX3N0cmluZzogbGV2ZWxfc3RyaW5nLCAvLyAzLCAzLjEsIDQsIDQuMSwgNSwgNS4xLCAuLi5cbiAgICAgICAgICAgICAgICBiaXRfZGVwdGg6IGJpdF9kZXB0aCwgLy8gOGJpdCwgMTBiaXQsIC4uLlxuICAgICAgICAgICAgICAgIHJlZl9mcmFtZXM6IHJlZl9mcmFtZXMsXG4gICAgICAgICAgICAgICAgY2hyb21hX2Zvcm1hdDogY2hyb21hX2Zvcm1hdCwgLy8gNDoyOjAsIDQ6MjoyLCAuLi5cbiAgICAgICAgICAgICAgICBjaHJvbWFfZm9ybWF0X3N0cmluZzogU1BTUGFyc2VyLmdldENocm9tYUZvcm1hdFN0cmluZyhjaHJvbWFfZm9ybWF0KSxcblxuICAgICAgICAgICAgICAgIGZyYW1lX3JhdGU6IHtcbiAgICAgICAgICAgICAgICAgICAgZml4ZWQ6IGZwc19maXhlZCxcbiAgICAgICAgICAgICAgICAgICAgZnBzOiBmcHMsXG4gICAgICAgICAgICAgICAgICAgIGZwc19kZW46IGZwc19kZW4sXG4gICAgICAgICAgICAgICAgICAgIGZwc19udW06IGZwc19udW1cbiAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgc2FyX3JhdGlvOiB7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiBzYXJfd2lkdGgsXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogc2FyX2hlaWdodFxuICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICBjb2RlY19zaXplOiB7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiBjb2RlY193aWR0aCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBjb2RlY19oZWlnaHRcbiAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgcHJlc2VudF9zaXplOiB7XG4gICAgICAgICAgICAgICAgICAgIHdpZHRoOiBwcmVzZW50X3dpZHRoLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGNvZGVjX2hlaWdodFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19za2lwU2NhbGluZ0xpc3QnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3NraXBTY2FsaW5nTGlzdChnYiwgY291bnQpIHtcbiAgICAgICAgICAgIHZhciBsYXN0X3NjYWxlID0gOCxcbiAgICAgICAgICAgICAgICBuZXh0X3NjYWxlID0gODtcbiAgICAgICAgICAgIHZhciBkZWx0YV9zY2FsZSA9IDA7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAobmV4dF9zY2FsZSAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBkZWx0YV9zY2FsZSA9IGdiLnJlYWRTRUcoKTtcbiAgICAgICAgICAgICAgICAgICAgbmV4dF9zY2FsZSA9IChsYXN0X3NjYWxlICsgZGVsdGFfc2NhbGUgKyAyNTYpICUgMjU2O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsYXN0X3NjYWxlID0gbmV4dF9zY2FsZSA9PT0gMCA/IGxhc3Rfc2NhbGUgOiBuZXh0X3NjYWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdnZXRQcm9maWxlU3RyaW5nJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFByb2ZpbGVTdHJpbmcocHJvZmlsZV9pZGMpIHtcbiAgICAgICAgICAgIHN3aXRjaCAocHJvZmlsZV9pZGMpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDY2OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ0Jhc2VsaW5lJztcbiAgICAgICAgICAgICAgICBjYXNlIDc3OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ01haW4nO1xuICAgICAgICAgICAgICAgIGNhc2UgODg6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnRXh0ZW5kZWQnO1xuICAgICAgICAgICAgICAgIGNhc2UgMTAwOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ0hpZ2gnO1xuICAgICAgICAgICAgICAgIGNhc2UgMTEwOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ0hpZ2gxMCc7XG4gICAgICAgICAgICAgICAgY2FzZSAxMjI6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnSGlnaDQyMic7XG4gICAgICAgICAgICAgICAgY2FzZSAyNDQ6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnSGlnaDQ0NCc7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdVbmtub3duJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZ2V0TGV2ZWxTdHJpbmcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TGV2ZWxTdHJpbmcobGV2ZWxfaWRjKSB7XG4gICAgICAgICAgICByZXR1cm4gKGxldmVsX2lkYyAvIDEwKS50b0ZpeGVkKDEpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdnZXRDaHJvbWFGb3JtYXRTdHJpbmcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q2hyb21hRm9ybWF0U3RyaW5nKGNocm9tYSkge1xuICAgICAgICAgICAgc3dpdGNoIChjaHJvbWEpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDQyMDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc0OjI6MCc7XG4gICAgICAgICAgICAgICAgY2FzZSA0MjI6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnNDoyOjInO1xuICAgICAgICAgICAgICAgIGNhc2UgNDQ0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzQ6NDo0JztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ1Vua25vd24nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFNQU1BhcnNlcjtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gU1BTUGFyc2VyO1xuXG59LHtcIi4vZXhwLWdvbG9tYi5qc1wiOjE3fV0sMjA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTsgLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9wb2x5ZmlsbCA9IF9kZXJlcV8oJy4vdXRpbHMvcG9seWZpbGwuanMnKTtcblxudmFyIF9wb2x5ZmlsbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wb2x5ZmlsbCk7XG5cbnZhciBfZmVhdHVyZXMgPSBfZGVyZXFfKCcuL2NvcmUvZmVhdHVyZXMuanMnKTtcblxudmFyIF9mZWF0dXJlczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9mZWF0dXJlcyk7XG5cbnZhciBfbG9hZGVyID0gX2RlcmVxXygnLi9pby9sb2FkZXIuanMnKTtcblxudmFyIF9mbHZQbGF5ZXIgPSBfZGVyZXFfKCcuL3BsYXllci9mbHYtcGxheWVyLmpzJyk7XG5cbnZhciBfZmx2UGxheWVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZsdlBsYXllcik7XG5cbnZhciBfbmF0aXZlUGxheWVyID0gX2RlcmVxXygnLi9wbGF5ZXIvbmF0aXZlLXBsYXllci5qcycpO1xuXG52YXIgX25hdGl2ZVBsYXllcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9uYXRpdmVQbGF5ZXIpO1xuXG52YXIgX3BsYXllckV2ZW50cyA9IF9kZXJlcV8oJy4vcGxheWVyL3BsYXllci1ldmVudHMuanMnKTtcblxudmFyIF9wbGF5ZXJFdmVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcGxheWVyRXZlbnRzKTtcblxudmFyIF9wbGF5ZXJFcnJvcnMgPSBfZGVyZXFfKCcuL3BsYXllci9wbGF5ZXItZXJyb3JzLmpzJyk7XG5cbnZhciBfbG9nZ2luZ0NvbnRyb2wgPSBfZGVyZXFfKCcuL3V0aWxzL2xvZ2dpbmctY29udHJvbC5qcycpO1xuXG52YXIgX2xvZ2dpbmdDb250cm9sMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dpbmdDb250cm9sKTtcblxudmFyIF9leGNlcHRpb24gPSBfZGVyZXFfKCcuL3V0aWxzL2V4Y2VwdGlvbi5qcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG4vLyBoZXJlIGFyZSBhbGwgdGhlIGludGVyZmFjZXNcblxuLy8gaW5zdGFsbCBwb2x5ZmlsbHNcbl9wb2x5ZmlsbDIuZGVmYXVsdC5pbnN0YWxsKCk7XG5cbi8vIGZhY3RvcnkgbWV0aG9kXG5mdW5jdGlvbiBjcmVhdGVQbGF5ZXIobWVkaWFEYXRhU291cmNlLCBvcHRpb25hbENvbmZpZykge1xuICAgIHZhciBtZHMgPSBtZWRpYURhdGFTb3VyY2U7XG4gICAgaWYgKG1kcyA9PSBudWxsIHx8ICh0eXBlb2YgbWRzID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihtZHMpKSAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uKCdNZWRpYURhdGFTb3VyY2UgbXVzdCBiZSBhbiBqYXZhc2NyaXB0IG9iamVjdCEnKTtcbiAgICB9XG5cbiAgICBpZiAoIW1kcy5oYXNPd25Qcm9wZXJ0eSgndHlwZScpKSB7XG4gICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLkludmFsaWRBcmd1bWVudEV4Y2VwdGlvbignTWVkaWFEYXRhU291cmNlIG11c3QgaGFzIHR5cGUgZmllbGQgdG8gaW5kaWNhdGUgdmlkZW8gZmlsZSB0eXBlIScpO1xuICAgIH1cblxuICAgIHN3aXRjaCAobWRzLnR5cGUpIHtcbiAgICAgICAgY2FzZSAnZmx2JzpcbiAgICAgICAgICAgIHJldHVybiBuZXcgX2ZsdlBsYXllcjIuZGVmYXVsdChtZHMsIG9wdGlvbmFsQ29uZmlnKTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBuZXcgX25hdGl2ZVBsYXllcjIuZGVmYXVsdChtZHMsIG9wdGlvbmFsQ29uZmlnKTtcbiAgICB9XG59XG5cbi8vIGZlYXR1cmUgZGV0ZWN0aW9uXG5mdW5jdGlvbiBpc1N1cHBvcnRlZCgpIHtcbiAgICByZXR1cm4gX2ZlYXR1cmVzMi5kZWZhdWx0LnN1cHBvcnRNU0VIMjY0UGxheWJhY2soKTtcbn1cblxuZnVuY3Rpb24gZ2V0RmVhdHVyZUxpc3QoKSB7XG4gICAgcmV0dXJuIF9mZWF0dXJlczIuZGVmYXVsdC5nZXRGZWF0dXJlTGlzdCgpO1xufVxuXG4vLyBpbnRlcmZhY2VzXG52YXIgZmx2anMgPSB7fTtcblxuZmx2anMuY3JlYXRlUGxheWVyID0gY3JlYXRlUGxheWVyO1xuZmx2anMuaXNTdXBwb3J0ZWQgPSBpc1N1cHBvcnRlZDtcbmZsdmpzLmdldEZlYXR1cmVMaXN0ID0gZ2V0RmVhdHVyZUxpc3Q7XG5cbmZsdmpzLkJhc2VMb2FkZXIgPSBfbG9hZGVyLkJhc2VMb2FkZXI7XG5mbHZqcy5Mb2FkZXJTdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cztcbmZsdmpzLkxvYWRlckVycm9ycyA9IF9sb2FkZXIuTG9hZGVyRXJyb3JzO1xuXG5mbHZqcy5FdmVudHMgPSBfcGxheWVyRXZlbnRzMi5kZWZhdWx0O1xuZmx2anMuRXJyb3JUeXBlcyA9IF9wbGF5ZXJFcnJvcnMuRXJyb3JUeXBlcztcbmZsdmpzLkVycm9yRGV0YWlscyA9IF9wbGF5ZXJFcnJvcnMuRXJyb3JEZXRhaWxzO1xuXG5mbHZqcy5GbHZQbGF5ZXIgPSBfZmx2UGxheWVyMi5kZWZhdWx0O1xuZmx2anMuTmF0aXZlUGxheWVyID0gX25hdGl2ZVBsYXllcjIuZGVmYXVsdDtcbmZsdmpzLkxvZ2dpbmdDb250cm9sID0gX2xvZ2dpbmdDb250cm9sMi5kZWZhdWx0O1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZmx2anMsICd2ZXJzaW9uJywge1xuICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgIC8vIHJlcGxhY2VkIGJ5IGJyb3dzZXJpZnktdmVyc2lvbmlmeSB0cmFuc2Zvcm1cbiAgICAgICAgcmV0dXJuICcxLjYuMSc7XG4gICAgfVxufSk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IGZsdmpzO1xuXG59LHtcIi4vY29yZS9mZWF0dXJlcy5qc1wiOjYsXCIuL2lvL2xvYWRlci5qc1wiOjI0LFwiLi9wbGF5ZXIvZmx2LXBsYXllci5qc1wiOjMyLFwiLi9wbGF5ZXIvbmF0aXZlLXBsYXllci5qc1wiOjMzLFwiLi9wbGF5ZXIvcGxheWVyLWVycm9ycy5qc1wiOjM0LFwiLi9wbGF5ZXIvcGxheWVyLWV2ZW50cy5qc1wiOjM1LFwiLi91dGlscy9leGNlcHRpb24uanNcIjo0MCxcIi4vdXRpbHMvbG9nZ2luZy1jb250cm9sLmpzXCI6NDIsXCIuL3V0aWxzL3BvbHlmaWxsLmpzXCI6NDN9XSwyMTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbi8vIGVudHJ5L2luZGV4IGZpbGVcblxuLy8gbWFrZSBpdCBjb21wYXRpYmxlIHdpdGggYnJvd3NlcmlmeSdzIHVtZCB3cmFwcGVyXG5tb2R1bGUuZXhwb3J0cyA9IF9kZXJlcV8oJy4vZmx2LmpzJykuZGVmYXVsdDtcblxufSx7XCIuL2Zsdi5qc1wiOjIwfV0sMjI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9O1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2xvZ2dlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZ2dlci5qcycpO1xuXG52YXIgX2xvZ2dlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnZXIpO1xuXG52YXIgX2Jyb3dzZXIgPSBfZGVyZXFfKCcuLi91dGlscy9icm93c2VyLmpzJyk7XG5cbnZhciBfYnJvd3NlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9icm93c2VyKTtcblxudmFyIF9sb2FkZXIgPSBfZGVyZXFfKCcuL2xvYWRlci5qcycpO1xuXG52YXIgX2V4Y2VwdGlvbiA9IF9kZXJlcV8oJy4uL3V0aWxzL2V4Y2VwdGlvbi5qcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbi8qIGZldGNoICsgc3RyZWFtIElPIGxvYWRlci4gQ3VycmVudGx5IHdvcmtpbmcgb24gY2hyb21lIDQzKy5cclxuICogZmV0Y2ggcHJvdmlkZXMgYSBiZXR0ZXIgYWx0ZXJuYXRpdmUgaHR0cCBBUEkgdG8gWE1MSHR0cFJlcXVlc3RcclxuICpcclxuICogZmV0Y2ggc3BlYyAgIGh0dHBzOi8vZmV0Y2guc3BlYy53aGF0d2cub3JnL1xyXG4gKiBzdHJlYW0gc3BlYyAgaHR0cHM6Ly9zdHJlYW1zLnNwZWMud2hhdHdnLm9yZy9cclxuICovXG52YXIgRmV0Y2hTdHJlYW1Mb2FkZXIgPSBmdW5jdGlvbiAoX0Jhc2VMb2FkZXIpIHtcbiAgICBfaW5oZXJpdHMoRmV0Y2hTdHJlYW1Mb2FkZXIsIF9CYXNlTG9hZGVyKTtcblxuICAgIF9jcmVhdGVDbGFzcyhGZXRjaFN0cmVhbUxvYWRlciwgbnVsbCwgW3tcbiAgICAgICAga2V5OiAnaXNTdXBwb3J0ZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaXNTdXBwb3J0ZWQoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIGZldGNoICsgc3RyZWFtIGlzIGJyb2tlbiBvbiBNaWNyb3NvZnQgRWRnZS4gRGlzYWJsZSBiZWZvcmUgYnVpbGQgMTUwNDguXG4gICAgICAgICAgICAgICAgLy8gc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1pY3Jvc29mdC5jb20vZW4tdXMvbWljcm9zb2Z0LWVkZ2UvcGxhdGZvcm0vaXNzdWVzLzgxOTY5MDcvXG4gICAgICAgICAgICAgICAgLy8gRml4ZWQgaW4gSmFuIDEwLCAyMDE3LiBCdWlsZCAxNTA0OCsgcmVtb3ZlZCBmcm9tIGJsYWNrbGlzdC5cbiAgICAgICAgICAgICAgICB2YXIgaXNXb3JrV2VsbEVkZ2UgPSBfYnJvd3NlcjIuZGVmYXVsdC5tc2VkZ2UgJiYgX2Jyb3dzZXIyLmRlZmF1bHQudmVyc2lvbi5taW5vciA+PSAxNTA0ODtcbiAgICAgICAgICAgICAgICB2YXIgYnJvd3Nlck5vdEJsYWNrbGlzdGVkID0gX2Jyb3dzZXIyLmRlZmF1bHQubXNlZGdlID8gaXNXb3JrV2VsbEVkZ2UgOiB0cnVlO1xuICAgICAgICAgICAgICAgIHJldHVybiBzZWxmLmZldGNoICYmIHNlbGYuUmVhZGFibGVTdHJlYW0gJiYgYnJvd3Nlck5vdEJsYWNrbGlzdGVkO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIGZ1bmN0aW9uIEZldGNoU3RyZWFtTG9hZGVyKHNlZWtIYW5kbGVyLCBjb25maWcpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZldGNoU3RyZWFtTG9hZGVyKTtcblxuICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoRmV0Y2hTdHJlYW1Mb2FkZXIuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihGZXRjaFN0cmVhbUxvYWRlcikpLmNhbGwodGhpcywgJ2ZldGNoLXN0cmVhbS1sb2FkZXInKSk7XG5cbiAgICAgICAgX3RoaXMuVEFHID0gJ0ZldGNoU3RyZWFtTG9hZGVyJztcblxuICAgICAgICBfdGhpcy5fc2Vla0hhbmRsZXIgPSBzZWVrSGFuZGxlcjtcbiAgICAgICAgX3RoaXMuX2NvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgX3RoaXMuX25lZWRTdGFzaCA9IHRydWU7XG5cbiAgICAgICAgX3RoaXMuX3JlcXVlc3RBYm9ydCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5fY29udGVudExlbmd0aCA9IG51bGw7XG4gICAgICAgIF90aGlzLl9yZWNlaXZlZExlbmd0aCA9IDA7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoRmV0Y2hTdHJlYW1Mb2FkZXIsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzV29ya2luZygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX2dldChGZXRjaFN0cmVhbUxvYWRlci5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihGZXRjaFN0cmVhbUxvYWRlci5wcm90b3R5cGUpLCAnZGVzdHJveScsIHRoaXMpLmNhbGwodGhpcyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29wZW4nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb3BlbihkYXRhU291cmNlLCByYW5nZSkge1xuICAgICAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHRoaXMuX2RhdGFTb3VyY2UgPSBkYXRhU291cmNlO1xuICAgICAgICAgICAgdGhpcy5fcmFuZ2UgPSByYW5nZTtcblxuICAgICAgICAgICAgdmFyIHNvdXJjZVVSTCA9IGRhdGFTb3VyY2UudXJsO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbmZpZy5yZXVzZVJlZGlyZWN0ZWRVUkwgJiYgZGF0YVNvdXJjZS5yZWRpcmVjdGVkVVJMICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHNvdXJjZVVSTCA9IGRhdGFTb3VyY2UucmVkaXJlY3RlZFVSTDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHNlZWtDb25maWcgPSB0aGlzLl9zZWVrSGFuZGxlci5nZXRDb25maWcoc291cmNlVVJMLCByYW5nZSk7XG5cbiAgICAgICAgICAgIHZhciBoZWFkZXJzID0gbmV3IHNlbGYuSGVhZGVycygpO1xuXG4gICAgICAgICAgICBpZiAoX3R5cGVvZihzZWVrQ29uZmlnLmhlYWRlcnMpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIHZhciBjb25maWdIZWFkZXJzID0gc2Vla0NvbmZpZy5oZWFkZXJzO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBjb25maWdIZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb25maWdIZWFkZXJzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnMuYXBwZW5kKGtleSwgY29uZmlnSGVhZGVyc1trZXldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXG4gICAgICAgICAgICAgICAgbW9kZTogJ2NvcnMnLFxuICAgICAgICAgICAgICAgIGNhY2hlOiAnZGVmYXVsdCcsXG4gICAgICAgICAgICAgICAgLy8gVGhlIGRlZmF1bHQgcG9saWN5IG9mIEZldGNoIEFQSSBpbiB0aGUgd2hhdHdnIHN0YW5kYXJkXG4gICAgICAgICAgICAgICAgLy8gU2FmYXJpIGluY29ycmVjdGx5IGluZGljYXRlcyAnbm8tcmVmZXJyZXInIGFzIGRlZmF1bHQgcG9saWN5LCBmdWNrIGl0XG4gICAgICAgICAgICAgICAgcmVmZXJyZXJQb2xpY3k6ICduby1yZWZlcnJlci13aGVuLWRvd25ncmFkZSdcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIGFkZCBhZGRpdGlvbmFsIGhlYWRlcnNcbiAgICAgICAgICAgIGlmIChfdHlwZW9mKHRoaXMuX2NvbmZpZy5oZWFkZXJzKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfa2V5IGluIHRoaXMuX2NvbmZpZy5oZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcnMuYXBwZW5kKF9rZXksIHRoaXMuX2NvbmZpZy5oZWFkZXJzW19rZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGNvcnMgaXMgZW5hYmxlZCBieSBkZWZhdWx0XG4gICAgICAgICAgICBpZiAoZGF0YVNvdXJjZS5jb3JzID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIC8vIG5vLWNvcnMgbWVhbnMgJ2Rpc3JlZ2FyZCBjb3JzIHBvbGljeScsIHdoaWNoIGNhbiBvbmx5IGJlIHVzZWQgaW4gU2VydmljZVdvcmtlclxuICAgICAgICAgICAgICAgIHBhcmFtcy5tb2RlID0gJ3NhbWUtb3JpZ2luJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gd2l0aENyZWRlbnRpYWxzIGlzIGRpc2FibGVkIGJ5IGRlZmF1bHRcbiAgICAgICAgICAgIGlmIChkYXRhU291cmNlLndpdGhDcmVkZW50aWFscykge1xuICAgICAgICAgICAgICAgIHBhcmFtcy5jcmVkZW50aWFscyA9ICdpbmNsdWRlJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gcmVmZXJyZXJQb2xpY3kgZnJvbSBjb25maWdcbiAgICAgICAgICAgIGlmIChkYXRhU291cmNlLnJlZmVycmVyUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zLnJlZmVycmVyUG9saWN5ID0gZGF0YVNvdXJjZS5yZWZlcnJlclBvbGljeTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYWRkIGFib3J0IGNvbnRyb2xsZXIsIGJ5IHdtbGdsIDIwMTktNS0xMCAxMjoyMToyN1xuICAgICAgICAgICAgaWYgKHNlbGYuQWJvcnRDb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYWJvcnRDb250cm9sbGVyID0gbmV3IHNlbGYuQWJvcnRDb250cm9sbGVyKCk7XG4gICAgICAgICAgICAgICAgcGFyYW1zLnNpZ25hbCA9IHRoaXMuX2Fib3J0Q29udHJvbGxlci5zaWduYWw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb25uZWN0aW5nO1xuICAgICAgICAgICAgc2VsZi5mZXRjaChzZWVrQ29uZmlnLnVybCwgcGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLl9yZXF1ZXN0QWJvcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rSWRsZTtcbiAgICAgICAgICAgICAgICAgICAgcmVzLmJvZHkuY2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJlcy5vayAmJiByZXMuc3RhdHVzID49IDIwMCAmJiByZXMuc3RhdHVzIDw9IDI5OSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVzLnVybCAhPT0gc2Vla0NvbmZpZy51cmwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpczIuX29uVVJMUmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVkaXJlY3RlZFVSTCA9IF90aGlzMi5fc2Vla0hhbmRsZXIucmVtb3ZlVVJMUGFyYW1ldGVycyhyZXMudXJsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczIuX29uVVJMUmVkaXJlY3QocmVkaXJlY3RlZFVSTCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB2YXIgbGVuZ3RoSGVhZGVyID0gcmVzLmhlYWRlcnMuZ2V0KCdDb250ZW50LUxlbmd0aCcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobGVuZ3RoSGVhZGVyICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMi5fY29udGVudExlbmd0aCA9IHBhcnNlSW50KGxlbmd0aEhlYWRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLl9jb250ZW50TGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMi5fb25Db250ZW50TGVuZ3RoS25vd24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMyLl9vbkNvbnRlbnRMZW5ndGhLbm93bihfdGhpczIuX2NvbnRlbnRMZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIuX3B1bXAuY2FsbChfdGhpczIsIHJlcy5ib2R5LmdldFJlYWRlcigpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczIuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMi5fb25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMyLl9vbkVycm9yKF9sb2FkZXIuTG9hZGVyRXJyb3JzLkhUVFBfU1RBVFVTX0NPREVfSU5WQUxJRCwgeyBjb2RlOiByZXMuc3RhdHVzLCBtc2c6IHJlcy5zdGF0dXNUZXh0IH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uUnVudGltZUV4Y2VwdGlvbignRmV0Y2hTdHJlYW1Mb2FkZXI6IEh0dHAgY29kZSBpbnZhbGlkLCAnICsgcmVzLnN0YXR1cyArICcgJyArIHJlcy5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzMi5fYWJvcnRDb250cm9sbGVyICYmIF90aGlzMi5fYWJvcnRDb250cm9sbGVyLnNpZ25hbC5hYm9ydGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfdGhpczIuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcjtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLl9vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMi5fb25FcnJvcihfbG9hZGVyLkxvYWRlckVycm9ycy5FWENFUFRJT04sIHsgY29kZTogLTEsIG1zZzogZS5tZXNzYWdlIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2Fib3J0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFib3J0KCkge1xuICAgICAgICAgICAgdGhpcy5fcmVxdWVzdEFib3J0ID0gdHJ1ZTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXR1cyAhPT0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0J1ZmZlcmluZyB8fCAhX2Jyb3dzZXIyLmRlZmF1bHQuY2hyb21lKSB7XG4gICAgICAgICAgICAgICAgLy8gQ2hyb21lIG1heSB0aHJvdyBFeGNlcHRpb24tbGlrZSB0aGluZ3MgaGVyZSwgYXZvaWQgdXNpbmcgaWYgaXMgYnVmZmVyaW5nXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2Fib3J0Q29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWJvcnRDb250cm9sbGVyLmFib3J0KCk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3B1bXAnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3B1bXAocmVhZGVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgICAgICAgICAgLy8gUmVhZGFibGVTdHJlYW1SZWFkZXJcbiAgICAgICAgICAgIHJldHVybiByZWFkZXIucmVhZCgpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuZG9uZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBGaXJzdCBjaGVjayByZWNlaXZlZCBsZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMy5fY29udGVudExlbmd0aCAhPT0gbnVsbCAmJiBfdGhpczMuX3JlY2VpdmVkTGVuZ3RoIDwgX3RoaXMzLl9jb250ZW50TGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXBvcnQgRWFybHktRU9GXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpczMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0eXBlID0gX2xvYWRlci5Mb2FkZXJFcnJvcnMuRUFSTFlfRU9GO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZm8gPSB7IGNvZGU6IC0xLCBtc2c6ICdGZXRjaCBzdHJlYW0gbWVldCBFYXJseS1FT0YnIH07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMzLl9vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMzLl9vbkVycm9yKHR5cGUsIGluZm8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5SdW50aW1lRXhjZXB0aW9uKGluZm8ubXNnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9LLiBEb3dubG9hZCBjb21wbGV0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29tcGxldGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMzLl9vbkNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMzLl9vbkNvbXBsZXRlKF90aGlzMy5fcmFuZ2UuZnJvbSwgX3RoaXMzLl9yYW5nZS5mcm9tICsgX3RoaXMzLl9yZWNlaXZlZExlbmd0aCAtIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMy5fYWJvcnRDb250cm9sbGVyICYmIF90aGlzMy5fYWJvcnRDb250cm9sbGVyLnNpZ25hbC5hYm9ydGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpczMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb21wbGV0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChfdGhpczMuX3JlcXVlc3RBYm9ydCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29tcGxldGU7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVhZGVyLmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgX3RoaXMzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQnVmZmVyaW5nO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjaHVuayA9IHJlc3VsdC52YWx1ZS5idWZmZXI7XG4gICAgICAgICAgICAgICAgICAgIHZhciBieXRlU3RhcnQgPSBfdGhpczMuX3JhbmdlLmZyb20gKyBfdGhpczMuX3JlY2VpdmVkTGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICBfdGhpczMuX3JlY2VpdmVkTGVuZ3RoICs9IGNodW5rLmJ5dGVMZW5ndGg7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMy5fb25EYXRhQXJyaXZhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMzLl9vbkRhdGFBcnJpdmFsKGNodW5rLCBieXRlU3RhcnQsIF90aGlzMy5fcmVjZWl2ZWRMZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgX3RoaXMzLl9wdW1wKHJlYWRlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzLl9hYm9ydENvbnRyb2xsZXIgJiYgX3RoaXMzLl9hYm9ydENvbnRyb2xsZXIuc2lnbmFsLmFib3J0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29tcGxldGU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoZS5jb2RlID09PSAxMSAmJiBfYnJvd3NlcjIuZGVmYXVsdC5tc2VkZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSW52YWxpZFN0YXRlRXJyb3Igb24gTWljcm9zb2Z0IEVkZ2VcbiAgICAgICAgICAgICAgICAgICAgLy8gV29ya2Fyb3VuZDogRWRnZSBtYXkgdGhyb3cgSW52YWxpZFN0YXRlRXJyb3IgYWZ0ZXIgUmVhZGFibGVTdHJlYW1SZWFkZXIuY2FuY2VsKCkgY2FsbFxuICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgdGhlIHVua25vd24gZXhjZXB0aW9uLlxuICAgICAgICAgICAgICAgICAgICAvLyBSZWxhdGVkIGlzc3VlOiBodHRwczovL2RldmVsb3Blci5taWNyb3NvZnQuY29tL2VuLXVzL21pY3Jvc29mdC1lZGdlL3BsYXRmb3JtL2lzc3Vlcy8xMTI2NTIwMi9cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIF90aGlzMy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yO1xuICAgICAgICAgICAgICAgIHZhciB0eXBlID0gMDtcbiAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICBpZiAoKGUuY29kZSA9PT0gMTkgfHwgZS5tZXNzYWdlID09PSAnbmV0d29yayBlcnJvcicpICYmICggLy8gTkVUV09SS19FUlJcbiAgICAgICAgICAgICAgICBfdGhpczMuX2NvbnRlbnRMZW5ndGggPT09IG51bGwgfHwgX3RoaXMzLl9jb250ZW50TGVuZ3RoICE9PSBudWxsICYmIF90aGlzMy5fcmVjZWl2ZWRMZW5ndGggPCBfdGhpczMuX2NvbnRlbnRMZW5ndGgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSBfbG9hZGVyLkxvYWRlckVycm9ycy5FQVJMWV9FT0Y7XG4gICAgICAgICAgICAgICAgICAgIGluZm8gPSB7IGNvZGU6IGUuY29kZSwgbXNnOiAnRmV0Y2ggc3RyZWFtIG1lZXQgRWFybHktRU9GJyB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSBfbG9hZGVyLkxvYWRlckVycm9ycy5FWENFUFRJT047XG4gICAgICAgICAgICAgICAgICAgIGluZm8gPSB7IGNvZGU6IGUuY29kZSwgbXNnOiBlLm1lc3NhZ2UgfTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzLl9vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMy5fb25FcnJvcih0eXBlLCBpbmZvKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5SdW50aW1lRXhjZXB0aW9uKGluZm8ubXNnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBGZXRjaFN0cmVhbUxvYWRlcjtcbn0oX2xvYWRlci5CYXNlTG9hZGVyKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gRmV0Y2hTdHJlYW1Mb2FkZXI7XG5cbn0se1wiLi4vdXRpbHMvYnJvd3Nlci5qc1wiOjM5LFwiLi4vdXRpbHMvZXhjZXB0aW9uLmpzXCI6NDAsXCIuLi91dGlscy9sb2dnZXIuanNcIjo0MSxcIi4vbG9hZGVyLmpzXCI6MjR9XSwyMzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfbG9nZ2VyID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nZ2VyLmpzJyk7XG5cbnZhciBfbG9nZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dlcik7XG5cbnZhciBfc3BlZWRTYW1wbGVyID0gX2RlcmVxXygnLi9zcGVlZC1zYW1wbGVyLmpzJyk7XG5cbnZhciBfc3BlZWRTYW1wbGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NwZWVkU2FtcGxlcik7XG5cbnZhciBfbG9hZGVyID0gX2RlcmVxXygnLi9sb2FkZXIuanMnKTtcblxudmFyIF9mZXRjaFN0cmVhbUxvYWRlciA9IF9kZXJlcV8oJy4vZmV0Y2gtc3RyZWFtLWxvYWRlci5qcycpO1xuXG52YXIgX2ZldGNoU3RyZWFtTG9hZGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZldGNoU3RyZWFtTG9hZGVyKTtcblxudmFyIF94aHJNb3pDaHVua2VkTG9hZGVyID0gX2RlcmVxXygnLi94aHItbW96LWNodW5rZWQtbG9hZGVyLmpzJyk7XG5cbnZhciBfeGhyTW96Q2h1bmtlZExvYWRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF94aHJNb3pDaHVua2VkTG9hZGVyKTtcblxudmFyIF94aHJNc3N0cmVhbUxvYWRlciA9IF9kZXJlcV8oJy4veGhyLW1zc3RyZWFtLWxvYWRlci5qcycpO1xuXG52YXIgX3hock1zc3RyZWFtTG9hZGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3hock1zc3RyZWFtTG9hZGVyKTtcblxudmFyIF94aHJSYW5nZUxvYWRlciA9IF9kZXJlcV8oJy4veGhyLXJhbmdlLWxvYWRlci5qcycpO1xuXG52YXIgX3hoclJhbmdlTG9hZGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3hoclJhbmdlTG9hZGVyKTtcblxudmFyIF93ZWJzb2NrZXRMb2FkZXIgPSBfZGVyZXFfKCcuL3dlYnNvY2tldC1sb2FkZXIuanMnKTtcblxudmFyIF93ZWJzb2NrZXRMb2FkZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfd2Vic29ja2V0TG9hZGVyKTtcblxudmFyIF9yYW5nZVNlZWtIYW5kbGVyID0gX2RlcmVxXygnLi9yYW5nZS1zZWVrLWhhbmRsZXIuanMnKTtcblxudmFyIF9yYW5nZVNlZWtIYW5kbGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JhbmdlU2Vla0hhbmRsZXIpO1xuXG52YXIgX3BhcmFtU2Vla0hhbmRsZXIgPSBfZGVyZXFfKCcuL3BhcmFtLXNlZWstaGFuZGxlci5qcycpO1xuXG52YXIgX3BhcmFtU2Vla0hhbmRsZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcGFyYW1TZWVrSGFuZGxlcik7XG5cbnZhciBfZXhjZXB0aW9uID0gX2RlcmVxXygnLi4vdXRpbHMvZXhjZXB0aW9uLmpzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qKlxyXG4gKiBEYXRhU291cmNlOiB7XHJcbiAqICAgICB1cmw6IHN0cmluZyxcclxuICogICAgIGZpbGVzaXplOiBudW1iZXIsXHJcbiAqICAgICBjb3JzOiBib29sZWFuLFxyXG4gKiAgICAgd2l0aENyZWRlbnRpYWxzOiBib29sZWFuXHJcbiAqIH1cclxuICogXHJcbiAqL1xuXG4vLyBNYW5hZ2UgSU8gTG9hZGVyc1xudmFyIElPQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBJT0NvbnRyb2xsZXIoZGF0YVNvdXJjZSwgY29uZmlnLCBleHRyYURhdGEpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIElPQ29udHJvbGxlcik7XG5cbiAgICAgICAgdGhpcy5UQUcgPSAnSU9Db250cm9sbGVyJztcblxuICAgICAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XG4gICAgICAgIHRoaXMuX2V4dHJhRGF0YSA9IGV4dHJhRGF0YTtcblxuICAgICAgICB0aGlzLl9zdGFzaEluaXRpYWxTaXplID0gMTAyNCAqIDM4NDsgLy8gZGVmYXVsdCBpbml0aWFsIHNpemU6IDM4NEtCXG4gICAgICAgIGlmIChjb25maWcuc3Rhc2hJbml0aWFsU2l6ZSAhPSB1bmRlZmluZWQgJiYgY29uZmlnLnN0YXNoSW5pdGlhbFNpemUgPiAwKSB7XG4gICAgICAgICAgICAvLyBhcHBseSBmcm9tIGNvbmZpZ1xuICAgICAgICAgICAgdGhpcy5fc3Rhc2hJbml0aWFsU2l6ZSA9IGNvbmZpZy5zdGFzaEluaXRpYWxTaXplO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fc3Rhc2hVc2VkID0gMDtcbiAgICAgICAgdGhpcy5fc3Rhc2hTaXplID0gdGhpcy5fc3Rhc2hJbml0aWFsU2l6ZTtcbiAgICAgICAgdGhpcy5fYnVmZmVyU2l6ZSA9IDEwMjQgKiAxMDI0ICogMzsgLy8gaW5pdGlhbCBzaXplOiAzTUJcbiAgICAgICAgdGhpcy5fc3Rhc2hCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIodGhpcy5fYnVmZmVyU2l6ZSk7XG4gICAgICAgIHRoaXMuX3N0YXNoQnl0ZVN0YXJ0ID0gMDtcbiAgICAgICAgdGhpcy5fZW5hYmxlU3Rhc2ggPSB0cnVlO1xuICAgICAgICBpZiAoY29uZmlnLmVuYWJsZVN0YXNoQnVmZmVyID09PSBmYWxzZSkge1xuICAgICAgICAgICAgdGhpcy5fZW5hYmxlU3Rhc2ggPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2xvYWRlciA9IG51bGw7XG4gICAgICAgIHRoaXMuX2xvYWRlckNsYXNzID0gbnVsbDtcbiAgICAgICAgdGhpcy5fc2Vla0hhbmRsZXIgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuX2RhdGFTb3VyY2UgPSBkYXRhU291cmNlO1xuICAgICAgICB0aGlzLl9pc1dlYlNvY2tldFVSTCA9IC93c3M/OlxcL1xcLyguKz8pLy50ZXN0KGRhdGFTb3VyY2UudXJsKTtcbiAgICAgICAgdGhpcy5fcmVmVG90YWxMZW5ndGggPSBkYXRhU291cmNlLmZpbGVzaXplID8gZGF0YVNvdXJjZS5maWxlc2l6ZSA6IG51bGw7XG4gICAgICAgIHRoaXMuX3RvdGFsTGVuZ3RoID0gdGhpcy5fcmVmVG90YWxMZW5ndGg7XG4gICAgICAgIHRoaXMuX2Z1bGxSZXF1ZXN0RmxhZyA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9jdXJyZW50UmFuZ2UgPSBudWxsO1xuICAgICAgICB0aGlzLl9yZWRpcmVjdGVkVVJMID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9zcGVlZE5vcm1hbGl6ZWQgPSAwO1xuICAgICAgICB0aGlzLl9zcGVlZFNhbXBsZXIgPSBuZXcgX3NwZWVkU2FtcGxlcjIuZGVmYXVsdCgpO1xuICAgICAgICB0aGlzLl9zcGVlZE5vcm1hbGl6ZUxpc3QgPSBbNjQsIDEyOCwgMjU2LCAzODQsIDUxMiwgNzY4LCAxMDI0LCAxNTM2LCAyMDQ4LCAzMDcyLCA0MDk2XTtcblxuICAgICAgICB0aGlzLl9pc0Vhcmx5RW9mUmVjb25uZWN0aW5nID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5fcGF1c2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3Jlc3VtZUZyb20gPSAwO1xuXG4gICAgICAgIHRoaXMuX29uRGF0YUFycml2YWwgPSBudWxsO1xuICAgICAgICB0aGlzLl9vblNlZWtlZCA9IG51bGw7XG4gICAgICAgIHRoaXMuX29uRXJyb3IgPSBudWxsO1xuICAgICAgICB0aGlzLl9vbkNvbXBsZXRlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fb25SZWRpcmVjdCA9IG51bGw7XG4gICAgICAgIHRoaXMuX29uUmVjb3ZlcmVkRWFybHlFb2YgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuX3NlbGVjdFNlZWtIYW5kbGVyKCk7XG4gICAgICAgIHRoaXMuX3NlbGVjdExvYWRlcigpO1xuICAgICAgICB0aGlzLl9jcmVhdGVMb2FkZXIoKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoSU9Db250cm9sbGVyLCBbe1xuICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbG9hZGVyLmlzV29ya2luZygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZGVyLmFib3J0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9sb2FkZXIuZGVzdHJveSgpO1xuICAgICAgICAgICAgdGhpcy5fbG9hZGVyID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX2xvYWRlckNsYXNzID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX2RhdGFTb3VyY2UgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fc3Rhc2hCdWZmZXIgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fc3Rhc2hVc2VkID0gdGhpcy5fc3Rhc2hTaXplID0gdGhpcy5fYnVmZmVyU2l6ZSA9IHRoaXMuX3N0YXNoQnl0ZVN0YXJ0ID0gMDtcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRSYW5nZSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9zcGVlZFNhbXBsZXIgPSBudWxsO1xuXG4gICAgICAgICAgICB0aGlzLl9pc0Vhcmx5RW9mUmVjb25uZWN0aW5nID0gZmFsc2U7XG5cbiAgICAgICAgICAgIHRoaXMuX29uRGF0YUFycml2YWwgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25TZWVrZWQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25FcnJvciA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vbkNvbXBsZXRlID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uUmVkaXJlY3QgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25SZWNvdmVyZWRFYXJseUVvZiA9IG51bGw7XG5cbiAgICAgICAgICAgIHRoaXMuX2V4dHJhRGF0YSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2lzV29ya2luZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpc1dvcmtpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbG9hZGVyICYmIHRoaXMuX2xvYWRlci5pc1dvcmtpbmcoKSAmJiAhdGhpcy5fcGF1c2VkO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdpc1BhdXNlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpc1BhdXNlZCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9wYXVzZWQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19zZWxlY3RTZWVrSGFuZGxlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfc2VsZWN0U2Vla0hhbmRsZXIoKSB7XG4gICAgICAgICAgICB2YXIgY29uZmlnID0gdGhpcy5fY29uZmlnO1xuXG4gICAgICAgICAgICBpZiAoY29uZmlnLnNlZWtUeXBlID09PSAncmFuZ2UnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc2Vla0hhbmRsZXIgPSBuZXcgX3JhbmdlU2Vla0hhbmRsZXIyLmRlZmF1bHQodGhpcy5fY29uZmlnLnJhbmdlTG9hZFplcm9TdGFydCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNvbmZpZy5zZWVrVHlwZSA9PT0gJ3BhcmFtJykge1xuICAgICAgICAgICAgICAgIHZhciBwYXJhbVN0YXJ0ID0gY29uZmlnLnNlZWtQYXJhbVN0YXJ0IHx8ICdic3RhcnQnO1xuICAgICAgICAgICAgICAgIHZhciBwYXJhbUVuZCA9IGNvbmZpZy5zZWVrUGFyYW1FbmQgfHwgJ2JlbmQnO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fc2Vla0hhbmRsZXIgPSBuZXcgX3BhcmFtU2Vla0hhbmRsZXIyLmRlZmF1bHQocGFyYW1TdGFydCwgcGFyYW1FbmQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjb25maWcuc2Vla1R5cGUgPT09ICdjdXN0b20nKSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBjb25maWcuY3VzdG9tU2Vla0hhbmRsZXIgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uKCdDdXN0b20gc2Vla1R5cGUgc3BlY2lmaWVkIGluIGNvbmZpZyBidXQgaW52YWxpZCBjdXN0b21TZWVrSGFuZGxlciEnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fc2Vla0hhbmRsZXIgPSBuZXcgY29uZmlnLmN1c3RvbVNlZWtIYW5kbGVyKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLkludmFsaWRBcmd1bWVudEV4Y2VwdGlvbignSW52YWxpZCBzZWVrVHlwZSBpbiBjb25maWc6ICcgKyBjb25maWcuc2Vla1R5cGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfc2VsZWN0TG9hZGVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9zZWxlY3RMb2FkZXIoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29uZmlnLmN1c3RvbUxvYWRlciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZGVyQ2xhc3MgPSB0aGlzLl9jb25maWcuY3VzdG9tTG9hZGVyO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9pc1dlYlNvY2tldFVSTCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRlckNsYXNzID0gX3dlYnNvY2tldExvYWRlcjIuZGVmYXVsdDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoX2ZldGNoU3RyZWFtTG9hZGVyMi5kZWZhdWx0LmlzU3VwcG9ydGVkKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9sb2FkZXJDbGFzcyA9IF9mZXRjaFN0cmVhbUxvYWRlcjIuZGVmYXVsdDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoX3hock1vekNodW5rZWRMb2FkZXIyLmRlZmF1bHQuaXNTdXBwb3J0ZWQoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRlckNsYXNzID0gX3hock1vekNodW5rZWRMb2FkZXIyLmRlZmF1bHQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKF94aHJSYW5nZUxvYWRlcjIuZGVmYXVsdC5pc1N1cHBvcnRlZCgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZGVyQ2xhc3MgPSBfeGhyUmFuZ2VMb2FkZXIyLmRlZmF1bHQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLlJ1bnRpbWVFeGNlcHRpb24oJ1lvdXIgYnJvd3NlciBkb2VzblxcJ3Qgc3VwcG9ydCB4aHIgd2l0aCBhcnJheWJ1ZmZlciByZXNwb25zZVR5cGUhJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19jcmVhdGVMb2FkZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2NyZWF0ZUxvYWRlcigpIHtcbiAgICAgICAgICAgIHRoaXMuX2xvYWRlciA9IG5ldyB0aGlzLl9sb2FkZXJDbGFzcyh0aGlzLl9zZWVrSGFuZGxlciwgdGhpcy5fY29uZmlnKTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9sb2FkZXIubmVlZFN0YXNoQnVmZmVyID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2VuYWJsZVN0YXNoID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9sb2FkZXIub25Db250ZW50TGVuZ3RoS25vd24gPSB0aGlzLl9vbkNvbnRlbnRMZW5ndGhLbm93bi5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5fbG9hZGVyLm9uVVJMUmVkaXJlY3QgPSB0aGlzLl9vblVSTFJlZGlyZWN0LmJpbmQodGhpcyk7XG4gICAgICAgICAgICB0aGlzLl9sb2FkZXIub25EYXRhQXJyaXZhbCA9IHRoaXMuX29uTG9hZGVyQ2h1bmtBcnJpdmFsLmJpbmQodGhpcyk7XG4gICAgICAgICAgICB0aGlzLl9sb2FkZXIub25Db21wbGV0ZSA9IHRoaXMuX29uTG9hZGVyQ29tcGxldGUuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuX2xvYWRlci5vbkVycm9yID0gdGhpcy5fb25Mb2FkZXJFcnJvci5iaW5kKHRoaXMpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvcGVuJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW4ob3B0aW9uYWxGcm9tKSB7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50UmFuZ2UgPSB7IGZyb206IDAsIHRvOiAtMSB9O1xuICAgICAgICAgICAgaWYgKG9wdGlvbmFsRnJvbSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRSYW5nZS5mcm9tID0gb3B0aW9uYWxGcm9tO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9zcGVlZFNhbXBsZXIucmVzZXQoKTtcbiAgICAgICAgICAgIGlmICghb3B0aW9uYWxGcm9tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZnVsbFJlcXVlc3RGbGFnID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fbG9hZGVyLm9wZW4odGhpcy5fZGF0YVNvdXJjZSwgT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5fY3VycmVudFJhbmdlKSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2Fib3J0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFib3J0KCkge1xuICAgICAgICAgICAgdGhpcy5fbG9hZGVyLmFib3J0KCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9wYXVzZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9wYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXN1bWVGcm9tID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncGF1c2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1dvcmtpbmcoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRlci5hYm9ydCgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXNoVXNlZCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXN1bWVGcm9tID0gdGhpcy5fc3Rhc2hCeXRlU3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRSYW5nZS50byA9IHRoaXMuX3N0YXNoQnl0ZVN0YXJ0IC0gMTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXN1bWVGcm9tID0gdGhpcy5fY3VycmVudFJhbmdlLnRvICsgMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hVc2VkID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaEJ5dGVTdGFydCA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGF1c2VkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVzdW1lJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlc3VtZSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9wYXVzZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9wYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YXIgYnl0ZXMgPSB0aGlzLl9yZXN1bWVGcm9tO1xuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc3VtZUZyb20gPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuX2ludGVybmFsU2VlayhieXRlcywgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3NlZWsnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2VlayhieXRlcykge1xuICAgICAgICAgICAgdGhpcy5fcGF1c2VkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9zdGFzaFVzZWQgPSAwO1xuICAgICAgICAgICAgdGhpcy5fc3Rhc2hCeXRlU3RhcnQgPSAwO1xuICAgICAgICAgICAgdGhpcy5faW50ZXJuYWxTZWVrKGJ5dGVzLCB0cnVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFdoZW4gc2Vla2luZyByZXF1ZXN0IGlzIGZyb20gbWVkaWEgc2Vla2luZywgdW5jb25zdW1lZCBzdGFzaCBkYXRhIHNob3VsZCBiZSBkcm9wcGVkXHJcbiAgICAgICAgICogSG93ZXZlciwgc3Rhc2ggZGF0YSBzaG91bGRuJ3QgYmUgZHJvcHBlZCBpZiBzZWVraW5nIHJlcXVlc3RlZCBmcm9tIGh0dHAgcmVjb25uZWN0aW9uXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAZHJvcFVuY29uc3VtZWQ6IElnbm9yZSBhbmQgZGlzY2FyZCBhbGwgdW5jb25zdW1lZCBkYXRhIGluIHN0YXNoIGJ1ZmZlclxyXG4gICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfaW50ZXJuYWxTZWVrJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9pbnRlcm5hbFNlZWsoYnl0ZXMsIGRyb3BVbmNvbnN1bWVkKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbG9hZGVyLmlzV29ya2luZygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZGVyLmFib3J0KCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGRpc3BhdGNoICYgZmx1c2ggc3Rhc2ggYnVmZmVyIGJlZm9yZSBzZWVrXG4gICAgICAgICAgICB0aGlzLl9mbHVzaFN0YXNoQnVmZmVyKGRyb3BVbmNvbnN1bWVkKTtcblxuICAgICAgICAgICAgdGhpcy5fbG9hZGVyLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIHRoaXMuX2xvYWRlciA9IG51bGw7XG5cbiAgICAgICAgICAgIHZhciByZXF1ZXN0UmFuZ2UgPSB7IGZyb206IGJ5dGVzLCB0bzogLTEgfTtcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRSYW5nZSA9IHsgZnJvbTogcmVxdWVzdFJhbmdlLmZyb20sIHRvOiAtMSB9O1xuXG4gICAgICAgICAgICB0aGlzLl9zcGVlZFNhbXBsZXIucmVzZXQoKTtcbiAgICAgICAgICAgIHRoaXMuX3N0YXNoU2l6ZSA9IHRoaXMuX3N0YXNoSW5pdGlhbFNpemU7XG4gICAgICAgICAgICB0aGlzLl9jcmVhdGVMb2FkZXIoKTtcbiAgICAgICAgICAgIHRoaXMuX2xvYWRlci5vcGVuKHRoaXMuX2RhdGFTb3VyY2UsIHJlcXVlc3RSYW5nZSk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9vblNlZWtlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uU2Vla2VkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3VwZGF0ZVVybCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVVcmwodXJsKSB7XG4gICAgICAgICAgICBpZiAoIXVybCB8fCB0eXBlb2YgdXJsICE9PSAnc3RyaW5nJyB8fCB1cmwubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uKCdVcmwgbXVzdCBiZSBhIG5vbi1lbXB0eSBzdHJpbmchJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX2RhdGFTb3VyY2UudXJsID0gdXJsO1xuXG4gICAgICAgICAgICAvLyBUT0RPOiByZXBsYWNlIHdpdGggbmV3IHVybFxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfZXhwYW5kQnVmZmVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9leHBhbmRCdWZmZXIoZXhwZWN0ZWRCeXRlcykge1xuICAgICAgICAgICAgdmFyIGJ1ZmZlck5ld1NpemUgPSB0aGlzLl9zdGFzaFNpemU7XG4gICAgICAgICAgICB3aGlsZSAoYnVmZmVyTmV3U2l6ZSArIDEwMjQgKiAxMDI0ICogMSA8IGV4cGVjdGVkQnl0ZXMpIHtcbiAgICAgICAgICAgICAgICBidWZmZXJOZXdTaXplICo9IDI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJ1ZmZlck5ld1NpemUgKz0gMTAyNCAqIDEwMjQgKiAxOyAvLyBidWZmZXJTaXplID0gc3Rhc2hTaXplICsgMU1CXG4gICAgICAgICAgICBpZiAoYnVmZmVyTmV3U2l6ZSA9PT0gdGhpcy5fYnVmZmVyU2l6ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIG5ld0J1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcihidWZmZXJOZXdTaXplKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXNoVXNlZCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBjb3B5IGV4aXN0aW5nIGRhdGEgaW50byBuZXcgYnVmZmVyXG4gICAgICAgICAgICAgICAgdmFyIHN0YXNoT2xkQXJyYXkgPSBuZXcgVWludDhBcnJheSh0aGlzLl9zdGFzaEJ1ZmZlciwgMCwgdGhpcy5fc3Rhc2hVc2VkKTtcbiAgICAgICAgICAgICAgICB2YXIgc3Rhc2hOZXdBcnJheSA9IG5ldyBVaW50OEFycmF5KG5ld0J1ZmZlciwgMCwgYnVmZmVyTmV3U2l6ZSk7XG4gICAgICAgICAgICAgICAgc3Rhc2hOZXdBcnJheS5zZXQoc3Rhc2hPbGRBcnJheSwgMCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3N0YXNoQnVmZmVyID0gbmV3QnVmZmVyO1xuICAgICAgICAgICAgdGhpcy5fYnVmZmVyU2l6ZSA9IGJ1ZmZlck5ld1NpemU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19ub3JtYWxpemVTcGVlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfbm9ybWFsaXplU3BlZWQoaW5wdXQpIHtcbiAgICAgICAgICAgIHZhciBsaXN0ID0gdGhpcy5fc3BlZWROb3JtYWxpemVMaXN0O1xuICAgICAgICAgICAgdmFyIGxhc3QgPSBsaXN0Lmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB2YXIgbWlkID0gMDtcbiAgICAgICAgICAgIHZhciBsYm91bmQgPSAwO1xuICAgICAgICAgICAgdmFyIHVib3VuZCA9IGxhc3Q7XG5cbiAgICAgICAgICAgIGlmIChpbnB1dCA8IGxpc3RbMF0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbGlzdFswXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYmluYXJ5IHNlYXJjaFxuICAgICAgICAgICAgd2hpbGUgKGxib3VuZCA8PSB1Ym91bmQpIHtcbiAgICAgICAgICAgICAgICBtaWQgPSBsYm91bmQgKyBNYXRoLmZsb29yKCh1Ym91bmQgLSBsYm91bmQpIC8gMik7XG4gICAgICAgICAgICAgICAgaWYgKG1pZCA9PT0gbGFzdCB8fCBpbnB1dCA+PSBsaXN0W21pZF0gJiYgaW5wdXQgPCBsaXN0W21pZCArIDFdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsaXN0W21pZF07XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaXN0W21pZF0gPCBpbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICBsYm91bmQgPSBtaWQgKyAxO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHVib3VuZCA9IG1pZCAtIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfYWRqdXN0U3Rhc2hTaXplJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9hZGp1c3RTdGFzaFNpemUobm9ybWFsaXplZCkge1xuICAgICAgICAgICAgdmFyIHN0YXNoU2l6ZUtCID0gMDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbmZpZy5pc0xpdmUpIHtcbiAgICAgICAgICAgICAgICAvLyBsaXZlIHN0cmVhbTogYWx3YXlzIHVzZSBzaW5nbGUgbm9ybWFsaXplZCBzcGVlZCBmb3Igc2l6ZSBvZiBzdGFzaFNpemVLQlxuICAgICAgICAgICAgICAgIHN0YXNoU2l6ZUtCID0gbm9ybWFsaXplZDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKG5vcm1hbGl6ZWQgPCA1MTIpIHtcbiAgICAgICAgICAgICAgICAgICAgc3Rhc2hTaXplS0IgPSBub3JtYWxpemVkO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobm9ybWFsaXplZCA+PSA1MTIgJiYgbm9ybWFsaXplZCA8PSAxMDI0KSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXNoU2l6ZUtCID0gTWF0aC5mbG9vcihub3JtYWxpemVkICogMS41KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzdGFzaFNpemVLQiA9IG5vcm1hbGl6ZWQgKiAyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHN0YXNoU2l6ZUtCID4gODE5Mikge1xuICAgICAgICAgICAgICAgIHN0YXNoU2l6ZUtCID0gODE5MjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGJ1ZmZlclNpemUgPSBzdGFzaFNpemVLQiAqIDEwMjQgKyAxMDI0ICogMTAyNCAqIDE7IC8vIHN0YXNoU2l6ZSArIDFNQlxuICAgICAgICAgICAgaWYgKHRoaXMuX2J1ZmZlclNpemUgPCBidWZmZXJTaXplKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZXhwYW5kQnVmZmVyKGJ1ZmZlclNpemUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fc3Rhc2hTaXplID0gc3Rhc2hTaXplS0IgKiAxMDI0O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfZGlzcGF0Y2hDaHVua3MnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2Rpc3BhdGNoQ2h1bmtzKGNodW5rcywgYnl0ZVN0YXJ0KSB7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50UmFuZ2UudG8gPSBieXRlU3RhcnQgKyBjaHVua3MuYnl0ZUxlbmd0aCAtIDE7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25EYXRhQXJyaXZhbChjaHVua3MsIGJ5dGVTdGFydCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblVSTFJlZGlyZWN0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblVSTFJlZGlyZWN0KHJlZGlyZWN0ZWRVUkwpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlZGlyZWN0ZWRVUkwgPSByZWRpcmVjdGVkVVJMO1xuICAgICAgICAgICAgaWYgKHRoaXMuX29uUmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vblJlZGlyZWN0KHJlZGlyZWN0ZWRVUkwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Db250ZW50TGVuZ3RoS25vd24nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uQ29udGVudExlbmd0aEtub3duKGNvbnRlbnRMZW5ndGgpIHtcbiAgICAgICAgICAgIGlmIChjb250ZW50TGVuZ3RoICYmIHRoaXMuX2Z1bGxSZXF1ZXN0RmxhZykge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RvdGFsTGVuZ3RoID0gY29udGVudExlbmd0aDtcbiAgICAgICAgICAgICAgICB0aGlzLl9mdWxsUmVxdWVzdEZsYWcgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uTG9hZGVyQ2h1bmtBcnJpdmFsJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkxvYWRlckNodW5rQXJyaXZhbChjaHVuaywgYnl0ZVN0YXJ0LCByZWNlaXZlZExlbmd0aCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9vbkRhdGFBcnJpdmFsKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCdJT0NvbnRyb2xsZXI6IE5vIGV4aXN0aW5nIGNvbnN1bWVyIChvbkRhdGFBcnJpdmFsKSBjYWxsYmFjayEnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9wYXVzZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5faXNFYXJseUVvZlJlY29ubmVjdGluZykge1xuICAgICAgICAgICAgICAgIC8vIEF1dG8tcmVjb25uZWN0IGZvciBFYXJseUVvZiBzdWNjZWVkLCBub3RpZnkgdG8gdXBwZXItbGF5ZXIgYnkgY2FsbGJhY2tcbiAgICAgICAgICAgICAgICB0aGlzLl9pc0Vhcmx5RW9mUmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uUmVjb3ZlcmVkRWFybHlFb2YpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25SZWNvdmVyZWRFYXJseUVvZigpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fc3BlZWRTYW1wbGVyLmFkZEJ5dGVzKGNodW5rLmJ5dGVMZW5ndGgpO1xuXG4gICAgICAgICAgICAvLyBhZGp1c3Qgc3Rhc2ggYnVmZmVyIHNpemUgYWNjb3JkaW5nIHRvIG5ldHdvcmsgc3BlZWQgZHluYW1pY2FsbHlcbiAgICAgICAgICAgIHZhciBLQnBzID0gdGhpcy5fc3BlZWRTYW1wbGVyLmxhc3RTZWNvbmRLQnBzO1xuICAgICAgICAgICAgaWYgKEtCcHMgIT09IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgbm9ybWFsaXplZCA9IHRoaXMuX25vcm1hbGl6ZVNwZWVkKEtCcHMpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zcGVlZE5vcm1hbGl6ZWQgIT09IG5vcm1hbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3BlZWROb3JtYWxpemVkID0gbm9ybWFsaXplZDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYWRqdXN0U3Rhc2hTaXplKG5vcm1hbGl6ZWQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCF0aGlzLl9lbmFibGVTdGFzaCkge1xuICAgICAgICAgICAgICAgIC8vIGRpc2FibGUgc3Rhc2hcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3Rhc2hVc2VkID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGRpc3BhdGNoIGNodW5rIGRpcmVjdGx5IHRvIGNvbnN1bWVyO1xuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayByZXQgdmFsdWUgKGNvbnN1bWVkIGJ5dGVzKSBhbmQgc3Rhc2ggdW5jb25zdW1lZCB0byBzdGFzaEJ1ZmZlclxuICAgICAgICAgICAgICAgICAgICB2YXIgY29uc3VtZWQgPSB0aGlzLl9kaXNwYXRjaENodW5rcyhjaHVuaywgYnl0ZVN0YXJ0KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnN1bWVkIDwgY2h1bmsuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdW5jb25zdW1lZCBkYXRhIHJlbWFpbi5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1haW4gPSBjaHVuay5ieXRlTGVuZ3RoIC0gY29uc3VtZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVtYWluID4gdGhpcy5fYnVmZmVyU2l6ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2V4cGFuZEJ1ZmZlcihyZW1haW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXNoQXJyYXkgPSBuZXcgVWludDhBcnJheSh0aGlzLl9zdGFzaEJ1ZmZlciwgMCwgdGhpcy5fYnVmZmVyU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFzaEFycmF5LnNldChuZXcgVWludDhBcnJheShjaHVuaywgY29uc3VtZWQpLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoVXNlZCArPSByZW1haW47XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaEJ5dGVTdGFydCA9IGJ5dGVTdGFydCArIGNvbnN1bWVkO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZWxzZTogTWVyZ2UgY2h1bmsgaW50byBzdGFzaEJ1ZmZlciwgYW5kIGRpc3BhdGNoIHN0YXNoQnVmZmVyIHRvIGNvbnN1bWVyLlxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3Rhc2hVc2VkICsgY2h1bmsuYnl0ZUxlbmd0aCA+IHRoaXMuX2J1ZmZlclNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2V4cGFuZEJ1ZmZlcih0aGlzLl9zdGFzaFVzZWQgKyBjaHVuay5ieXRlTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgX3N0YXNoQXJyYXkgPSBuZXcgVWludDhBcnJheSh0aGlzLl9zdGFzaEJ1ZmZlciwgMCwgdGhpcy5fYnVmZmVyU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgIF9zdGFzaEFycmF5LnNldChuZXcgVWludDhBcnJheShjaHVuayksIHRoaXMuX3N0YXNoVXNlZCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoVXNlZCArPSBjaHVuay5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2NvbnN1bWVkID0gdGhpcy5fZGlzcGF0Y2hDaHVua3ModGhpcy5fc3Rhc2hCdWZmZXIuc2xpY2UoMCwgdGhpcy5fc3Rhc2hVc2VkKSwgdGhpcy5fc3Rhc2hCeXRlU3RhcnQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoX2NvbnN1bWVkIDwgdGhpcy5fc3Rhc2hVc2VkICYmIF9jb25zdW1lZCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVuY29uc3VtZWQgZGF0YSByZW1haW5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1haW5BcnJheSA9IG5ldyBVaW50OEFycmF5KHRoaXMuX3N0YXNoQnVmZmVyLCBfY29uc3VtZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3N0YXNoQXJyYXkuc2V0KHJlbWFpbkFycmF5LCAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaFVzZWQgLT0gX2NvbnN1bWVkO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaEJ5dGVTdGFydCArPSBfY29uc3VtZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBlbmFibGUgc3Rhc2hcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3Rhc2hVc2VkID09PSAwICYmIHRoaXMuX3N0YXNoQnl0ZVN0YXJ0ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHNlZWtlZD8gb3IgaW5pdCBjaHVuaz9cbiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3QgY2h1bmsgYWZ0ZXIgc2VlayBhY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hCeXRlU3RhcnQgPSBieXRlU3RhcnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdGFzaFVzZWQgKyBjaHVuay5ieXRlTGVuZ3RoIDw9IHRoaXMuX3N0YXNoU2l6ZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBqdXN0IHN0YXNoXG4gICAgICAgICAgICAgICAgICAgIHZhciBfc3Rhc2hBcnJheTIgPSBuZXcgVWludDhBcnJheSh0aGlzLl9zdGFzaEJ1ZmZlciwgMCwgdGhpcy5fc3Rhc2hTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgX3N0YXNoQXJyYXkyLnNldChuZXcgVWludDhBcnJheShjaHVuayksIHRoaXMuX3N0YXNoVXNlZCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoVXNlZCArPSBjaHVuay5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHN0YXNoVXNlZCArIGNodW5rU2l6ZSA+IHN0YXNoU2l6ZSwgc2l6ZSBsaW1pdCBleGNlZWRlZFxuICAgICAgICAgICAgICAgICAgICB2YXIgX3N0YXNoQXJyYXkzID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5fc3Rhc2hCdWZmZXIsIDAsIHRoaXMuX2J1ZmZlclNpemUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3Rhc2hVc2VkID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlcmUncmUgc3Rhc2ggZGF0YXMgaW4gYnVmZmVyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBkaXNwYXRjaCB0aGUgd2hvbGUgc3Rhc2hCdWZmZXIsIGFuZCBzdGFzaCByZW1haW4gZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlbiBhcHBlbmQgY2h1bmsgdG8gc3Rhc2hCdWZmZXIgKHN0YXNoKVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJ1ZmZlciA9IHRoaXMuX3N0YXNoQnVmZmVyLnNsaWNlKDAsIHRoaXMuX3N0YXNoVXNlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2NvbnN1bWVkMiA9IHRoaXMuX2Rpc3BhdGNoQ2h1bmtzKGJ1ZmZlciwgdGhpcy5fc3Rhc2hCeXRlU3RhcnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9jb25zdW1lZDIgPCBidWZmZXIuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfY29uc3VtZWQyID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlbWFpbkFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyLCBfY29uc3VtZWQyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3N0YXNoQXJyYXkzLnNldChfcmVtYWluQXJyYXksIDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaFVzZWQgPSBfcmVtYWluQXJyYXkuYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hCeXRlU3RhcnQgKz0gX2NvbnN1bWVkMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoVXNlZCA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hCeXRlU3RhcnQgKz0gX2NvbnN1bWVkMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdGFzaFVzZWQgKyBjaHVuay5ieXRlTGVuZ3RoID4gdGhpcy5fYnVmZmVyU2l6ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2V4cGFuZEJ1ZmZlcih0aGlzLl9zdGFzaFVzZWQgKyBjaHVuay5ieXRlTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc3Rhc2hBcnJheTMgPSBuZXcgVWludDhBcnJheSh0aGlzLl9zdGFzaEJ1ZmZlciwgMCwgdGhpcy5fYnVmZmVyU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBfc3Rhc2hBcnJheTMuc2V0KG5ldyBVaW50OEFycmF5KGNodW5rKSwgdGhpcy5fc3Rhc2hVc2VkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoVXNlZCArPSBjaHVuay5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3Rhc2ggYnVmZmVyIGVtcHR5LCBidXQgY2h1bmtTaXplID4gc3Rhc2hTaXplIChvaCwgaG9seSBzaGl0KVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZGlzcGF0Y2ggY2h1bmsgZGlyZWN0bHkgYW5kIHN0YXNoIHJlbWFpbiBkYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX2NvbnN1bWVkMyA9IHRoaXMuX2Rpc3BhdGNoQ2h1bmtzKGNodW5rLCBieXRlU3RhcnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9jb25zdW1lZDMgPCBjaHVuay5ieXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZW1haW4gPSBjaHVuay5ieXRlTGVuZ3RoIC0gX2NvbnN1bWVkMztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3JlbWFpbiA+IHRoaXMuX2J1ZmZlclNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZXhwYW5kQnVmZmVyKF9yZW1haW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc3Rhc2hBcnJheTMgPSBuZXcgVWludDhBcnJheSh0aGlzLl9zdGFzaEJ1ZmZlciwgMCwgdGhpcy5fYnVmZmVyU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zdGFzaEFycmF5My5zZXQobmV3IFVpbnQ4QXJyYXkoY2h1bmssIF9jb25zdW1lZDMpLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaFVzZWQgKz0gX3JlbWFpbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaEJ5dGVTdGFydCA9IGJ5dGVTdGFydCArIF9jb25zdW1lZDM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19mbHVzaFN0YXNoQnVmZmVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9mbHVzaFN0YXNoQnVmZmVyKGRyb3BVbmNvbnN1bWVkKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fc3Rhc2hVc2VkID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBidWZmZXIgPSB0aGlzLl9zdGFzaEJ1ZmZlci5zbGljZSgwLCB0aGlzLl9zdGFzaFVzZWQpO1xuICAgICAgICAgICAgICAgIHZhciBjb25zdW1lZCA9IHRoaXMuX2Rpc3BhdGNoQ2h1bmtzKGJ1ZmZlciwgdGhpcy5fc3Rhc2hCeXRlU3RhcnQpO1xuICAgICAgICAgICAgICAgIHZhciByZW1haW4gPSBidWZmZXIuYnl0ZUxlbmd0aCAtIGNvbnN1bWVkO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNvbnN1bWVkIDwgYnVmZmVyLmJ5dGVMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRyb3BVbmNvbnN1bWVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsIHJlbWFpbiArICcgYnl0ZXMgdW5jb25zdW1lZCBkYXRhIHJlbWFpbiB3aGVuIGZsdXNoIGJ1ZmZlciwgZHJvcHBlZCcpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnN1bWVkID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGFzaEFycmF5ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5fc3Rhc2hCdWZmZXIsIDAsIHRoaXMuX2J1ZmZlclNpemUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1haW5BcnJheSA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlciwgY29uc3VtZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXNoQXJyYXkuc2V0KHJlbWFpbkFycmF5LCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaFVzZWQgPSByZW1haW5BcnJheS5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoQnl0ZVN0YXJ0ICs9IGNvbnN1bWVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hVc2VkID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaEJ5dGVTdGFydCA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlbWFpbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Mb2FkZXJDb21wbGV0ZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Mb2FkZXJDb21wbGV0ZShmcm9tLCB0bykge1xuICAgICAgICAgICAgLy8gRm9yY2UtZmx1c2ggc3Rhc2ggYnVmZmVyLCBhbmQgZHJvcCB1bmNvbnN1bWVkIGRhdGFcbiAgICAgICAgICAgIHRoaXMuX2ZsdXNoU3Rhc2hCdWZmZXIodHJ1ZSk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9vbkNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25Db21wbGV0ZSh0aGlzLl9leHRyYURhdGEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Mb2FkZXJFcnJvcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Mb2FkZXJFcnJvcih0eXBlLCBkYXRhKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmUodGhpcy5UQUcsICdMb2FkZXIgZXJyb3IsIGNvZGUgPSAnICsgZGF0YS5jb2RlICsgJywgbXNnID0gJyArIGRhdGEubXNnKTtcblxuICAgICAgICAgICAgdGhpcy5fZmx1c2hTdGFzaEJ1ZmZlcihmYWxzZSk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9pc0Vhcmx5RW9mUmVjb25uZWN0aW5nKSB7XG4gICAgICAgICAgICAgICAgLy8gQXV0by1yZWNvbm5lY3QgZm9yIEVhcmx5RW9mIGZhaWxlZCwgdGhyb3cgVW5yZWNvdmVyYWJsZUVhcmx5RW9mIGVycm9yIHRvIHVwcGVyLWxheWVyXG4gICAgICAgICAgICAgICAgdGhpcy5faXNFYXJseUVvZlJlY29ubmVjdGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHR5cGUgPSBfbG9hZGVyLkxvYWRlckVycm9ycy5VTlJFQ09WRVJBQkxFX0VBUkxZX0VPRjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBfbG9hZGVyLkxvYWRlckVycm9ycy5FQVJMWV9FT0Y6XG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5fY29uZmlnLmlzTGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIERvIGludGVybmFsIGh0dHAgcmVjb25uZWN0IGlmIG5vdCBsaXZlIHN0cmVhbVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl90b3RhbExlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV4dEZyb20gPSB0aGlzLl9jdXJyZW50UmFuZ2UudG8gKyAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV4dEZyb20gPCB0aGlzLl90b3RhbExlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnQ29ubmVjdGlvbiBsb3N0LCB0cnlpbmcgcmVjb25uZWN0Li4uJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pc0Vhcmx5RW9mUmVjb25uZWN0aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2ludGVybmFsU2VlayhuZXh0RnJvbSwgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZWxzZTogV2UgZG9uJ3Qga25vdyB0b3RhbExlbmd0aCwgdGhyb3cgVW5yZWNvdmVyYWJsZUVhcmx5RW9mXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBsaXZlIHN0cmVhbTogdGhyb3cgVW5yZWNvdmVyYWJsZUVhcmx5RW9mIGVycm9yIHRvIHVwcGVyLWxheWVyXG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlID0gX2xvYWRlci5Mb2FkZXJFcnJvcnMuVU5SRUNPVkVSQUJMRV9FQVJMWV9FT0Y7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgX2xvYWRlci5Mb2FkZXJFcnJvcnMuVU5SRUNPVkVSQUJMRV9FQVJMWV9FT0Y6XG4gICAgICAgICAgICAgICAgY2FzZSBfbG9hZGVyLkxvYWRlckVycm9ycy5DT05ORUNUSU5HX1RJTUVPVVQ6XG4gICAgICAgICAgICAgICAgY2FzZSBfbG9hZGVyLkxvYWRlckVycm9ycy5IVFRQX1NUQVRVU19DT0RFX0lOVkFMSUQ6XG4gICAgICAgICAgICAgICAgY2FzZSBfbG9hZGVyLkxvYWRlckVycm9ycy5FWENFUFRJT046XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5fb25FcnJvcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IodHlwZSwgZGF0YSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLlJ1bnRpbWVFeGNlcHRpb24oJ0lPRXhjZXB0aW9uOiAnICsgZGF0YS5tc2cpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzdGF0dXMnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2FkZXIuc3RhdHVzO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdleHRyYURhdGEnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9leHRyYURhdGE7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGRhdGEpIHtcbiAgICAgICAgICAgIHRoaXMuX2V4dHJhRGF0YSA9IGRhdGE7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBwcm90b3R5cGU6IGZ1bmN0aW9uIG9uRGF0YUFycml2YWwoY2h1bmtzOiBBcnJheUJ1ZmZlciwgYnl0ZVN0YXJ0OiBudW1iZXIpOiBudW1iZXJcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25EYXRhQXJyaXZhbCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uRGF0YUFycml2YWw7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vbkRhdGFBcnJpdmFsID0gY2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uU2Vla2VkJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25TZWVrZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vblNlZWtlZCA9IGNhbGxiYWNrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcHJvdG90eXBlOiBmdW5jdGlvbiBvbkVycm9yKHR5cGU6IG51bWJlciwgaW5mbzoge2NvZGU6IG51bWJlciwgbXNnOiBzdHJpbmd9KTogdm9pZFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbkVycm9yJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25FcnJvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uRXJyb3IgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25Db21wbGV0ZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uQ29tcGxldGU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vbkNvbXBsZXRlID0gY2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uUmVkaXJlY3QnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vblJlZGlyZWN0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25SZWRpcmVjdCA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvblJlY292ZXJlZEVhcmx5RW9mJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25SZWNvdmVyZWRFYXJseUVvZjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uUmVjb3ZlcmVkRWFybHlFb2YgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnY3VycmVudFVSTCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2RhdGFTb3VyY2UudXJsO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdoYXNSZWRpcmVjdCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlZGlyZWN0ZWRVUkwgIT0gbnVsbCB8fCB0aGlzLl9kYXRhU291cmNlLnJlZGlyZWN0ZWRVUkwgIT0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdjdXJyZW50UmVkaXJlY3RlZFVSTCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlZGlyZWN0ZWRVUkwgfHwgdGhpcy5fZGF0YVNvdXJjZS5yZWRpcmVjdGVkVVJMO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaW4gS0Ivc1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdjdXJyZW50U3BlZWQnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9sb2FkZXJDbGFzcyA9PT0gX3hoclJhbmdlTG9hZGVyMi5kZWZhdWx0KSB7XG4gICAgICAgICAgICAgICAgLy8gU3BlZWRTYW1wbGVyIGlzIGluYWNjdXJhY3kgaWYgbG9hZGVyIGlzIFJhbmdlTG9hZGVyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xvYWRlci5jdXJyZW50U3BlZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3BlZWRTYW1wbGVyLmxhc3RTZWNvbmRLQnBzO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdsb2FkZXJUeXBlJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbG9hZGVyLnR5cGU7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gSU9Db250cm9sbGVyO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBJT0NvbnRyb2xsZXI7XG5cbn0se1wiLi4vdXRpbHMvZXhjZXB0aW9uLmpzXCI6NDAsXCIuLi91dGlscy9sb2dnZXIuanNcIjo0MSxcIi4vZmV0Y2gtc3RyZWFtLWxvYWRlci5qc1wiOjIyLFwiLi9sb2FkZXIuanNcIjoyNCxcIi4vcGFyYW0tc2Vlay1oYW5kbGVyLmpzXCI6MjUsXCIuL3JhbmdlLXNlZWstaGFuZGxlci5qc1wiOjI2LFwiLi9zcGVlZC1zYW1wbGVyLmpzXCI6MjcsXCIuL3dlYnNvY2tldC1sb2FkZXIuanNcIjoyOCxcIi4veGhyLW1vei1jaHVua2VkLWxvYWRlci5qc1wiOjI5LFwiLi94aHItbXNzdHJlYW0tbG9hZGVyLmpzXCI6MzAsXCIuL3hoci1yYW5nZS1sb2FkZXIuanNcIjozMX1dLDI0OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5CYXNlTG9hZGVyID0gZXhwb3J0cy5Mb2FkZXJFcnJvcnMgPSBleHBvcnRzLkxvYWRlclN0YXR1cyA9IHVuZGVmaW5lZDtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfZXhjZXB0aW9uID0gX2RlcmVxXygnLi4vdXRpbHMvZXhjZXB0aW9uLmpzJyk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBMb2FkZXJTdGF0dXMgPSBleHBvcnRzLkxvYWRlclN0YXR1cyA9IHtcbiAgICBrSWRsZTogMCxcbiAgICBrQ29ubmVjdGluZzogMSxcbiAgICBrQnVmZmVyaW5nOiAyLFxuICAgIGtFcnJvcjogMyxcbiAgICBrQ29tcGxldGU6IDRcbn07XG5cbnZhciBMb2FkZXJFcnJvcnMgPSBleHBvcnRzLkxvYWRlckVycm9ycyA9IHtcbiAgICBPSzogJ09LJyxcbiAgICBFWENFUFRJT046ICdFeGNlcHRpb24nLFxuICAgIEhUVFBfU1RBVFVTX0NPREVfSU5WQUxJRDogJ0h0dHBTdGF0dXNDb2RlSW52YWxpZCcsXG4gICAgQ09OTkVDVElOR19USU1FT1VUOiAnQ29ubmVjdGluZ1RpbWVvdXQnLFxuICAgIEVBUkxZX0VPRjogJ0Vhcmx5RW9mJyxcbiAgICBVTlJFQ09WRVJBQkxFX0VBUkxZX0VPRjogJ1VucmVjb3ZlcmFibGVFYXJseUVvZidcbn07XG5cbi8qIExvYWRlciBoYXMgY2FsbGJhY2tzIHdoaWNoIGhhdmUgZm9sbG93aW5nIHByb3RvdHlwZXM6XHJcbiAqICAgICBmdW5jdGlvbiBvbkNvbnRlbnRMZW5ndGhLbm93bihjb250ZW50TGVuZ3RoOiBudW1iZXIpOiB2b2lkXHJcbiAqICAgICBmdW5jdGlvbiBvblVSTFJlZGlyZWN0KHVybDogc3RyaW5nKTogdm9pZFxyXG4gKiAgICAgZnVuY3Rpb24gb25EYXRhQXJyaXZhbChjaHVuazogQXJyYXlCdWZmZXIsIGJ5dGVTdGFydDogbnVtYmVyLCByZWNlaXZlZExlbmd0aDogbnVtYmVyKTogdm9pZFxyXG4gKiAgICAgZnVuY3Rpb24gb25FcnJvcihlcnJvclR5cGU6IG51bWJlciwgZXJyb3JJbmZvOiB7Y29kZTogbnVtYmVyLCBtc2c6IHN0cmluZ30pOiB2b2lkXHJcbiAqICAgICBmdW5jdGlvbiBvbkNvbXBsZXRlKHJhbmdlRnJvbTogbnVtYmVyLCByYW5nZVRvOiBudW1iZXIpOiB2b2lkXHJcbiAqL1xuXG52YXIgQmFzZUxvYWRlciA9IGV4cG9ydHMuQmFzZUxvYWRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBCYXNlTG9hZGVyKHR5cGVOYW1lKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCYXNlTG9hZGVyKTtcblxuICAgICAgICB0aGlzLl90eXBlID0gdHlwZU5hbWUgfHwgJ3VuZGVmaW5lZCc7XG4gICAgICAgIHRoaXMuX3N0YXR1cyA9IExvYWRlclN0YXR1cy5rSWRsZTtcbiAgICAgICAgdGhpcy5fbmVlZFN0YXNoID0gZmFsc2U7XG4gICAgICAgIC8vIGNhbGxiYWNrc1xuICAgICAgICB0aGlzLl9vbkNvbnRlbnRMZW5ndGhLbm93biA9IG51bGw7XG4gICAgICAgIHRoaXMuX29uVVJMUmVkaXJlY3QgPSBudWxsO1xuICAgICAgICB0aGlzLl9vbkRhdGFBcnJpdmFsID0gbnVsbDtcbiAgICAgICAgdGhpcy5fb25FcnJvciA9IG51bGw7XG4gICAgICAgIHRoaXMuX29uQ29tcGxldGUgPSBudWxsO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhCYXNlTG9hZGVyLCBbe1xuICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBMb2FkZXJTdGF0dXMua0lkbGU7XG4gICAgICAgICAgICB0aGlzLl9vbkNvbnRlbnRMZW5ndGhLbm93biA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vblVSTFJlZGlyZWN0ID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uRGF0YUFycml2YWwgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25FcnJvciA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vbkNvbXBsZXRlID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnaXNXb3JraW5nJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzV29ya2luZygpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdGF0dXMgPT09IExvYWRlclN0YXR1cy5rQ29ubmVjdGluZyB8fCB0aGlzLl9zdGF0dXMgPT09IExvYWRlclN0YXR1cy5rQnVmZmVyaW5nO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvcGVuJyxcblxuXG4gICAgICAgIC8vIHB1cmUgdmlydHVhbFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb3BlbihkYXRhU291cmNlLCByYW5nZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uTm90SW1wbGVtZW50ZWRFeGNlcHRpb24oJ1VuaW1wbGVtZW50ZWQgYWJzdHJhY3QgZnVuY3Rpb24hJyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2Fib3J0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFib3J0KCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uTm90SW1wbGVtZW50ZWRFeGNlcHRpb24oJ1VuaW1wbGVtZW50ZWQgYWJzdHJhY3QgZnVuY3Rpb24hJyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3R5cGUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90eXBlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzdGF0dXMnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zdGF0dXM7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ25lZWRTdGFzaEJ1ZmZlcicsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX25lZWRTdGFzaDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25Db250ZW50TGVuZ3RoS25vd24nLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vbkNvbnRlbnRMZW5ndGhLbm93bjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uQ29udGVudExlbmd0aEtub3duID0gY2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uVVJMUmVkaXJlY3QnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vblVSTFJlZGlyZWN0O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25VUkxSZWRpcmVjdCA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbkRhdGFBcnJpdmFsJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25EYXRhQXJyaXZhbDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uRGF0YUFycml2YWwgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25FcnJvcicsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uRXJyb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vbkVycm9yID0gY2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uQ29tcGxldGUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vbkNvbXBsZXRlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25Db21wbGV0ZSA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIEJhc2VMb2FkZXI7XG59KCk7XG5cbn0se1wiLi4vdXRpbHMvZXhjZXB0aW9uLmpzXCI6NDB9XSwyNTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxudmFyIFBhcmFtU2Vla0hhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUGFyYW1TZWVrSGFuZGxlcihwYXJhbVN0YXJ0LCBwYXJhbUVuZCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUGFyYW1TZWVrSGFuZGxlcik7XG5cbiAgICAgICAgdGhpcy5fc3RhcnROYW1lID0gcGFyYW1TdGFydDtcbiAgICAgICAgdGhpcy5fZW5kTmFtZSA9IHBhcmFtRW5kO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhQYXJhbVNlZWtIYW5kbGVyLCBbe1xuICAgICAgICBrZXk6ICdnZXRDb25maWcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29uZmlnKGJhc2VVcmwsIHJhbmdlKSB7XG4gICAgICAgICAgICB2YXIgdXJsID0gYmFzZVVybDtcblxuICAgICAgICAgICAgaWYgKHJhbmdlLmZyb20gIT09IDAgfHwgcmFuZ2UudG8gIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5lZWRBbmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmICh1cmwuaW5kZXhPZignPycpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICB1cmwgKz0gJz8nO1xuICAgICAgICAgICAgICAgICAgICBuZWVkQW5kID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG5lZWRBbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsICs9ICcmJztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB1cmwgKz0gdGhpcy5fc3RhcnROYW1lICsgJz0nICsgcmFuZ2UuZnJvbS50b1N0cmluZygpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHJhbmdlLnRvICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICB1cmwgKz0gJyYnICsgdGhpcy5fZW5kTmFtZSArICc9JyArIHJhbmdlLnRvLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHt9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZW1vdmVVUkxQYXJhbWV0ZXJzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVVSTFBhcmFtZXRlcnMoc2Vla2VkVVJMKSB7XG4gICAgICAgICAgICB2YXIgYmFzZVVSTCA9IHNlZWtlZFVSTC5zcGxpdCgnPycpWzBdO1xuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgdmFyIHF1ZXJ5SW5kZXggPSBzZWVrZWRVUkwuaW5kZXhPZignPycpO1xuICAgICAgICAgICAgaWYgKHF1ZXJ5SW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zID0gc2Vla2VkVVJMLnN1YnN0cmluZyhxdWVyeUluZGV4ICsgMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciByZXN1bHRQYXJhbXMgPSAnJztcblxuICAgICAgICAgICAgaWYgKHBhcmFtcyAhPSB1bmRlZmluZWQgJiYgcGFyYW1zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFpcnMgPSBwYXJhbXMuc3BsaXQoJyYnKTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGFpcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhaXIgPSBwYWlyc1tpXS5zcGxpdCgnPScpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVxdWlyZUFuZCA9IGkgPiAwO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYWlyWzBdICE9PSB0aGlzLl9zdGFydE5hbWUgJiYgcGFpclswXSAhPT0gdGhpcy5fZW5kTmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcXVpcmVBbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRQYXJhbXMgKz0gJyYnO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0UGFyYW1zICs9IHBhaXJzW2ldO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0UGFyYW1zLmxlbmd0aCA9PT0gMCA/IGJhc2VVUkwgOiBiYXNlVVJMICsgJz8nICsgcmVzdWx0UGFyYW1zO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFBhcmFtU2Vla0hhbmRsZXI7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFBhcmFtU2Vla0hhbmRsZXI7XG5cbn0se31dLDI2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG52YXIgUmFuZ2VTZWVrSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBSYW5nZVNlZWtIYW5kbGVyKHplcm9TdGFydCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmFuZ2VTZWVrSGFuZGxlcik7XG5cbiAgICAgICAgdGhpcy5femVyb1N0YXJ0ID0gemVyb1N0YXJ0IHx8IGZhbHNlO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhSYW5nZVNlZWtIYW5kbGVyLCBbe1xuICAgICAgICBrZXk6ICdnZXRDb25maWcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29uZmlnKHVybCwgcmFuZ2UpIHtcbiAgICAgICAgICAgIHZhciBoZWFkZXJzID0ge307XG5cbiAgICAgICAgICAgIGlmIChyYW5nZS5mcm9tICE9PSAwIHx8IHJhbmdlLnRvICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHZhciBwYXJhbSA9IHZvaWQgMDtcbiAgICAgICAgICAgICAgICBpZiAocmFuZ2UudG8gIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmFtID0gJ2J5dGVzPScgKyByYW5nZS5mcm9tLnRvU3RyaW5nKCkgKyAnLScgKyByYW5nZS50by50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHBhcmFtID0gJ2J5dGVzPScgKyByYW5nZS5mcm9tLnRvU3RyaW5nKCkgKyAnLSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGhlYWRlcnNbJ1JhbmdlJ10gPSBwYXJhbTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5femVyb1N0YXJ0KSB7XG4gICAgICAgICAgICAgICAgaGVhZGVyc1snUmFuZ2UnXSA9ICdieXRlcz0wLSc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgaGVhZGVyczogaGVhZGVyc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVtb3ZlVVJMUGFyYW1ldGVycycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVVUkxQYXJhbWV0ZXJzKHNlZWtlZFVSTCkge1xuICAgICAgICAgICAgcmV0dXJuIHNlZWtlZFVSTDtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBSYW5nZVNlZWtIYW5kbGVyO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBSYW5nZVNlZWtIYW5kbGVyO1xuXG59LHt9XSwyNzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG4vLyBVdGlsaXR5IGNsYXNzIHRvIGNhbGN1bGF0ZSByZWFsdGltZSBuZXR3b3JrIEkvTyBzcGVlZFxudmFyIFNwZWVkU2FtcGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBTcGVlZFNhbXBsZXIoKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTcGVlZFNhbXBsZXIpO1xuXG4gICAgICAgIC8vIG1pbGxpc2Vjb25kc1xuICAgICAgICB0aGlzLl9maXJzdENoZWNrcG9pbnQgPSAwO1xuICAgICAgICB0aGlzLl9sYXN0Q2hlY2twb2ludCA9IDA7XG4gICAgICAgIHRoaXMuX2ludGVydmFsQnl0ZXMgPSAwO1xuICAgICAgICB0aGlzLl90b3RhbEJ5dGVzID0gMDtcbiAgICAgICAgdGhpcy5fbGFzdFNlY29uZEJ5dGVzID0gMDtcblxuICAgICAgICAvLyBjb21wYXRpYmlsaXR5IGRldGVjdGlvblxuICAgICAgICBpZiAoc2VsZi5wZXJmb3JtYW5jZSAmJiBzZWxmLnBlcmZvcm1hbmNlLm5vdykge1xuICAgICAgICAgICAgdGhpcy5fbm93ID0gc2VsZi5wZXJmb3JtYW5jZS5ub3cuYmluZChzZWxmLnBlcmZvcm1hbmNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX25vdyA9IERhdGUubm93O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFNwZWVkU2FtcGxlciwgW3tcbiAgICAgICAga2V5OiBcInJlc2V0XCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZXNldCgpIHtcbiAgICAgICAgICAgIHRoaXMuX2ZpcnN0Q2hlY2twb2ludCA9IHRoaXMuX2xhc3RDaGVja3BvaW50ID0gMDtcbiAgICAgICAgICAgIHRoaXMuX3RvdGFsQnl0ZXMgPSB0aGlzLl9pbnRlcnZhbEJ5dGVzID0gMDtcbiAgICAgICAgICAgIHRoaXMuX2xhc3RTZWNvbmRCeXRlcyA9IDA7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJhZGRCeXRlc1wiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkQnl0ZXMoYnl0ZXMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9maXJzdENoZWNrcG9pbnQgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9maXJzdENoZWNrcG9pbnQgPSB0aGlzLl9ub3coKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9sYXN0Q2hlY2twb2ludCA9IHRoaXMuX2ZpcnN0Q2hlY2twb2ludDtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnRlcnZhbEJ5dGVzICs9IGJ5dGVzO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RvdGFsQnl0ZXMgKz0gYnl0ZXM7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX25vdygpIC0gdGhpcy5fbGFzdENoZWNrcG9pbnQgPCAxMDAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faW50ZXJ2YWxCeXRlcyArPSBieXRlcztcbiAgICAgICAgICAgICAgICB0aGlzLl90b3RhbEJ5dGVzICs9IGJ5dGVzO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBkdXJhdGlvbiA+PSAxMDAwXG4gICAgICAgICAgICAgICAgdGhpcy5fbGFzdFNlY29uZEJ5dGVzID0gdGhpcy5faW50ZXJ2YWxCeXRlcztcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnRlcnZhbEJ5dGVzID0gYnl0ZXM7XG4gICAgICAgICAgICAgICAgdGhpcy5fdG90YWxCeXRlcyArPSBieXRlcztcbiAgICAgICAgICAgICAgICB0aGlzLl9sYXN0Q2hlY2twb2ludCA9IHRoaXMuX25vdygpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiY3VycmVudEtCcHNcIixcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICB0aGlzLmFkZEJ5dGVzKDApO1xuXG4gICAgICAgICAgICB2YXIgZHVyYXRpb25TZWNvbmRzID0gKHRoaXMuX25vdygpIC0gdGhpcy5fbGFzdENoZWNrcG9pbnQpIC8gMTAwMDtcbiAgICAgICAgICAgIGlmIChkdXJhdGlvblNlY29uZHMgPT0gMCkgZHVyYXRpb25TZWNvbmRzID0gMTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9pbnRlcnZhbEJ5dGVzIC8gZHVyYXRpb25TZWNvbmRzIC8gMTAyNDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImxhc3RTZWNvbmRLQnBzXCIsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgdGhpcy5hZGRCeXRlcygwKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX2xhc3RTZWNvbmRCeXRlcyAhPT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9sYXN0U2Vjb25kQnl0ZXMgLyAxMDI0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBsYXN0U2Vjb25kQnl0ZXMgPT09IDBcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbm93KCkgLSB0aGlzLl9sYXN0Q2hlY2twb2ludCA+PSA1MDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGltZSBpbnRlcnZhbCBzaW5jZSBsYXN0IGNoZWNrcG9pbnQgaGFzIGV4Y2VlZGVkIDUwMG1zXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBzcGVlZCBpcyBuZWFybHkgYWNjdXJhdGVcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VycmVudEtCcHM7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgZG9uJ3Qga25vd1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJhdmVyYWdlS0Jwc1wiLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHZhciBkdXJhdGlvblNlY29uZHMgPSAodGhpcy5fbm93KCkgLSB0aGlzLl9maXJzdENoZWNrcG9pbnQpIC8gMTAwMDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90b3RhbEJ5dGVzIC8gZHVyYXRpb25TZWNvbmRzIC8gMTAyNDtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBTcGVlZFNhbXBsZXI7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFNwZWVkU2FtcGxlcjtcblxufSx7fV0sMjg6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9sb2dnZXIgPSBfZGVyZXFfKCcuLi91dGlscy9sb2dnZXIuanMnKTtcblxudmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTtcblxudmFyIF9sb2FkZXIgPSBfZGVyZXFfKCcuL2xvYWRlci5qcycpO1xuXG52YXIgX2V4Y2VwdGlvbiA9IF9kZXJlcV8oJy4uL3V0aWxzL2V4Y2VwdGlvbi5qcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbi8vIEZvciBGTFYgb3ZlciBXZWJTb2NrZXQgbGl2ZSBzdHJlYW1cbnZhciBXZWJTb2NrZXRMb2FkZXIgPSBmdW5jdGlvbiAoX0Jhc2VMb2FkZXIpIHtcbiAgICBfaW5oZXJpdHMoV2ViU29ja2V0TG9hZGVyLCBfQmFzZUxvYWRlcik7XG5cbiAgICBfY3JlYXRlQ2xhc3MoV2ViU29ja2V0TG9hZGVyLCBudWxsLCBbe1xuICAgICAgICBrZXk6ICdpc1N1cHBvcnRlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpc1N1cHBvcnRlZCgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHR5cGVvZiBzZWxmLldlYlNvY2tldCAhPT0gJ3VuZGVmaW5lZCc7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgZnVuY3Rpb24gV2ViU29ja2V0TG9hZGVyKCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgV2ViU29ja2V0TG9hZGVyKTtcblxuICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoV2ViU29ja2V0TG9hZGVyLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoV2ViU29ja2V0TG9hZGVyKSkuY2FsbCh0aGlzLCAnd2Vic29ja2V0LWxvYWRlcicpKTtcblxuICAgICAgICBfdGhpcy5UQUcgPSAnV2ViU29ja2V0TG9hZGVyJztcblxuICAgICAgICBfdGhpcy5fbmVlZFN0YXNoID0gdHJ1ZTtcblxuICAgICAgICBfdGhpcy5fd3MgPSBudWxsO1xuICAgICAgICBfdGhpcy5fcmVxdWVzdEFib3J0ID0gZmFsc2U7XG4gICAgICAgIF90aGlzLl9yZWNlaXZlZExlbmd0aCA9IDA7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoV2ViU29ja2V0TG9hZGVyLCBbe1xuICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fd3MpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFib3J0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfZ2V0KFdlYlNvY2tldExvYWRlci5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihXZWJTb2NrZXRMb2FkZXIucHJvdG90eXBlKSwgJ2Rlc3Ryb3knLCB0aGlzKS5jYWxsKHRoaXMpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvcGVuJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW4oZGF0YVNvdXJjZSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgd3MgPSB0aGlzLl93cyA9IG5ldyBzZWxmLldlYlNvY2tldChkYXRhU291cmNlLnVybCk7XG4gICAgICAgICAgICAgICAgd3MuYmluYXJ5VHlwZSA9ICdhcnJheWJ1ZmZlcic7XG4gICAgICAgICAgICAgICAgd3Mub25vcGVuID0gdGhpcy5fb25XZWJTb2NrZXRPcGVuLmJpbmQodGhpcyk7XG4gICAgICAgICAgICAgICAgd3Mub25jbG9zZSA9IHRoaXMuX29uV2ViU29ja2V0Q2xvc2UuYmluZCh0aGlzKTtcbiAgICAgICAgICAgICAgICB3cy5vbm1lc3NhZ2UgPSB0aGlzLl9vbldlYlNvY2tldE1lc3NhZ2UuYmluZCh0aGlzKTtcbiAgICAgICAgICAgICAgICB3cy5vbmVycm9yID0gdGhpcy5fb25XZWJTb2NrZXRFcnJvci5iaW5kKHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Nvbm5lY3Rpbmc7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yO1xuXG4gICAgICAgICAgICAgICAgdmFyIGluZm8gPSB7IGNvZGU6IGUuY29kZSwgbXNnOiBlLm1lc3NhZ2UgfTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoX2xvYWRlci5Mb2FkZXJFcnJvcnMuRVhDRVBUSU9OLCBpbmZvKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5SdW50aW1lRXhjZXB0aW9uKGluZm8ubXNnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2Fib3J0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFib3J0KCkge1xuICAgICAgICAgICAgdmFyIHdzID0gdGhpcy5fd3M7XG4gICAgICAgICAgICBpZiAod3MgJiYgKHdzLnJlYWR5U3RhdGUgPT09IDAgfHwgd3MucmVhZHlTdGF0ZSA9PT0gMSkpIHtcbiAgICAgICAgICAgICAgICAvLyBDT05ORUNUSU5HIHx8IE9QRU5cbiAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0QWJvcnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHdzLmNsb3NlKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3dzID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb21wbGV0ZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uV2ViU29ja2V0T3BlbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25XZWJTb2NrZXRPcGVuKGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtCdWZmZXJpbmc7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbldlYlNvY2tldENsb3NlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbldlYlNvY2tldENsb3NlKGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9yZXF1ZXN0QWJvcnQgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0QWJvcnQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb21wbGV0ZTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX29uQ29tcGxldGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkNvbXBsZXRlKDAsIHRoaXMuX3JlY2VpdmVkTGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbldlYlNvY2tldE1lc3NhZ2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uV2ViU29ja2V0TWVzc2FnZShlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgICAgICAgaWYgKGUuZGF0YSBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGlzcGF0Y2hBcnJheUJ1ZmZlcihlLmRhdGEpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChlLmRhdGEgaW5zdGFuY2VvZiBCbG9iKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLl9kaXNwYXRjaEFycmF5QnVmZmVyKHJlYWRlci5yZXN1bHQpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKGUuZGF0YSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcjtcbiAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IHsgY29kZTogLTEsIG1zZzogJ1Vuc3VwcG9ydGVkIFdlYlNvY2tldCBtZXNzYWdlIHR5cGU6ICcgKyBlLmRhdGEuY29uc3RydWN0b3IubmFtZSB9O1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcihfbG9hZGVyLkxvYWRlckVycm9ycy5FWENFUFRJT04sIGluZm8pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLlJ1bnRpbWVFeGNlcHRpb24oaW5mby5tc2cpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2Rpc3BhdGNoQXJyYXlCdWZmZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2Rpc3BhdGNoQXJyYXlCdWZmZXIoYXJyYXlidWZmZXIpIHtcbiAgICAgICAgICAgIHZhciBjaHVuayA9IGFycmF5YnVmZmVyO1xuICAgICAgICAgICAgdmFyIGJ5dGVTdGFydCA9IHRoaXMuX3JlY2VpdmVkTGVuZ3RoO1xuICAgICAgICAgICAgdGhpcy5fcmVjZWl2ZWRMZW5ndGggKz0gY2h1bmsuYnl0ZUxlbmd0aDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX29uRGF0YUFycml2YWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkRhdGFBcnJpdmFsKGNodW5rLCBieXRlU3RhcnQsIHRoaXMuX3JlY2VpdmVkTGVuZ3RoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uV2ViU29ja2V0RXJyb3InLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uV2ViU29ja2V0RXJyb3IoZSkge1xuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yO1xuXG4gICAgICAgICAgICB2YXIgaW5mbyA9IHtcbiAgICAgICAgICAgICAgICBjb2RlOiBlLmNvZGUsXG4gICAgICAgICAgICAgICAgbXNnOiBlLm1lc3NhZ2VcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcihfbG9hZGVyLkxvYWRlckVycm9ycy5FWENFUFRJT04sIGluZm8pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5SdW50aW1lRXhjZXB0aW9uKGluZm8ubXNnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBXZWJTb2NrZXRMb2FkZXI7XG59KF9sb2FkZXIuQmFzZUxvYWRlcik7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFdlYlNvY2tldExvYWRlcjtcblxufSx7XCIuLi91dGlscy9leGNlcHRpb24uanNcIjo0MCxcIi4uL3V0aWxzL2xvZ2dlci5qc1wiOjQxLFwiLi9sb2FkZXIuanNcIjoyNH1dLDI5OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9sb2dnZXIgPSBfZGVyZXFfKCcuLi91dGlscy9sb2dnZXIuanMnKTtcblxudmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTtcblxudmFyIF9sb2FkZXIgPSBfZGVyZXFfKCcuL2xvYWRlci5qcycpO1xuXG52YXIgX2V4Y2VwdGlvbiA9IF9kZXJlcV8oJy4uL3V0aWxzL2V4Y2VwdGlvbi5qcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbi8vIEZvciBGaXJlRm94IGJyb3dzZXIgd2hpY2ggc3VwcG9ydHMgYHhoci5yZXNwb25zZVR5cGUgPSAnbW96LWNodW5rZWQtYXJyYXlidWZmZXInYFxudmFyIE1vekNodW5rZWRMb2FkZXIgPSBmdW5jdGlvbiAoX0Jhc2VMb2FkZXIpIHtcbiAgICBfaW5oZXJpdHMoTW96Q2h1bmtlZExvYWRlciwgX0Jhc2VMb2FkZXIpO1xuXG4gICAgX2NyZWF0ZUNsYXNzKE1vekNodW5rZWRMb2FkZXIsIG51bGwsIFt7XG4gICAgICAgIGtleTogJ2lzU3VwcG9ydGVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzU3VwcG9ydGVkKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgICAgICAgICAgLy8gRmlyZWZveCAzNy0gcmVxdWlyZXMgLm9wZW4oKSB0byBiZSBjYWxsZWQgYmVmb3JlIHNldHRpbmcgcmVzcG9uc2VUeXBlXG4gICAgICAgICAgICAgICAgeGhyLm9wZW4oJ0dFVCcsICdodHRwczovL2V4YW1wbGUuY29tJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdtb3otY2h1bmtlZC1hcnJheWJ1ZmZlcic7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHhoci5yZXNwb25zZVR5cGUgPT09ICdtb3otY2h1bmtlZC1hcnJheWJ1ZmZlcic7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KCdNb3pDaHVua2VkTG9hZGVyJywgZS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICBmdW5jdGlvbiBNb3pDaHVua2VkTG9hZGVyKHNlZWtIYW5kbGVyLCBjb25maWcpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1vekNodW5rZWRMb2FkZXIpO1xuXG4gICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChNb3pDaHVua2VkTG9hZGVyLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTW96Q2h1bmtlZExvYWRlcikpLmNhbGwodGhpcywgJ3hoci1tb3otY2h1bmtlZC1sb2FkZXInKSk7XG5cbiAgICAgICAgX3RoaXMuVEFHID0gJ01vekNodW5rZWRMb2FkZXInO1xuXG4gICAgICAgIF90aGlzLl9zZWVrSGFuZGxlciA9IHNlZWtIYW5kbGVyO1xuICAgICAgICBfdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgICAgICBfdGhpcy5fbmVlZFN0YXNoID0gdHJ1ZTtcblxuICAgICAgICBfdGhpcy5feGhyID0gbnVsbDtcbiAgICAgICAgX3RoaXMuX3JlcXVlc3RBYm9ydCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5fY29udGVudExlbmd0aCA9IG51bGw7XG4gICAgICAgIF90aGlzLl9yZWNlaXZlZExlbmd0aCA9IDA7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoTW96Q2h1bmtlZExvYWRlciwgW3tcbiAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNXb3JraW5nKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFib3J0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5feGhyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLm9ucHJvZ3Jlc3MgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5vbmxvYWRlbmQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5vbmVycm9yID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX2dldChNb3pDaHVua2VkTG9hZGVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE1vekNodW5rZWRMb2FkZXIucHJvdG90eXBlKSwgJ2Rlc3Ryb3knLCB0aGlzKS5jYWxsKHRoaXMpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvcGVuJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW4oZGF0YVNvdXJjZSwgcmFuZ2UpIHtcbiAgICAgICAgICAgIHRoaXMuX2RhdGFTb3VyY2UgPSBkYXRhU291cmNlO1xuICAgICAgICAgICAgdGhpcy5fcmFuZ2UgPSByYW5nZTtcblxuICAgICAgICAgICAgdmFyIHNvdXJjZVVSTCA9IGRhdGFTb3VyY2UudXJsO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbmZpZy5yZXVzZVJlZGlyZWN0ZWRVUkwgJiYgZGF0YVNvdXJjZS5yZWRpcmVjdGVkVVJMICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHNvdXJjZVVSTCA9IGRhdGFTb3VyY2UucmVkaXJlY3RlZFVSTDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHNlZWtDb25maWcgPSB0aGlzLl9zZWVrSGFuZGxlci5nZXRDb25maWcoc291cmNlVVJMLCByYW5nZSk7XG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0VVJMID0gc2Vla0NvbmZpZy51cmw7XG5cbiAgICAgICAgICAgIHZhciB4aHIgPSB0aGlzLl94aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgIHhoci5vcGVuKCdHRVQnLCBzZWVrQ29uZmlnLnVybCwgdHJ1ZSk7XG4gICAgICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ21vei1jaHVua2VkLWFycmF5YnVmZmVyJztcbiAgICAgICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSB0aGlzLl9vblJlYWR5U3RhdGVDaGFuZ2UuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHhoci5vbnByb2dyZXNzID0gdGhpcy5fb25Qcm9ncmVzcy5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgeGhyLm9ubG9hZGVuZCA9IHRoaXMuX29uTG9hZEVuZC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgeGhyLm9uZXJyb3IgPSB0aGlzLl9vblhockVycm9yLmJpbmQodGhpcyk7XG5cbiAgICAgICAgICAgIC8vIGNvcnMgaXMgYXV0byBkZXRlY3RlZCBhbmQgZW5hYmxlZCBieSB4aHJcblxuICAgICAgICAgICAgLy8gd2l0aENyZWRlbnRpYWxzIGlzIGRpc2FibGVkIGJ5IGRlZmF1bHRcbiAgICAgICAgICAgIGlmIChkYXRhU291cmNlLndpdGhDcmVkZW50aWFscykge1xuICAgICAgICAgICAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoX3R5cGVvZihzZWVrQ29uZmlnLmhlYWRlcnMpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIHZhciBoZWFkZXJzID0gc2Vla0NvbmZpZy5oZWFkZXJzO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhlYWRlcnMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoa2V5LCBoZWFkZXJzW2tleV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBhZGQgYWRkaXRpb25hbCBoZWFkZXJzXG4gICAgICAgICAgICBpZiAoX3R5cGVvZih0aGlzLl9jb25maWcuaGVhZGVycykgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9oZWFkZXJzID0gdGhpcy5fY29uZmlnLmhlYWRlcnM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfa2V5IGluIF9oZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfaGVhZGVycy5oYXNPd25Qcm9wZXJ0eShfa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoX2tleSwgX2hlYWRlcnNbX2tleV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29ubmVjdGluZztcbiAgICAgICAgICAgIHhoci5zZW5kKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2Fib3J0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFib3J0KCkge1xuICAgICAgICAgICAgdGhpcy5fcmVxdWVzdEFib3J0ID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmICh0aGlzLl94aHIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb21wbGV0ZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uUmVhZHlTdGF0ZUNoYW5nZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZWFkeVN0YXRlQ2hhbmdlKGUpIHtcbiAgICAgICAgICAgIHZhciB4aHIgPSBlLnRhcmdldDtcblxuICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSAyKSB7XG4gICAgICAgICAgICAgICAgLy8gSEVBREVSU19SRUNFSVZFRFxuICAgICAgICAgICAgICAgIGlmICh4aHIucmVzcG9uc2VVUkwgIT0gdW5kZWZpbmVkICYmIHhoci5yZXNwb25zZVVSTCAhPT0gdGhpcy5fcmVxdWVzdFVSTCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25VUkxSZWRpcmVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlZGlyZWN0ZWRVUkwgPSB0aGlzLl9zZWVrSGFuZGxlci5yZW1vdmVVUkxQYXJhbWV0ZXJzKHhoci5yZXNwb25zZVVSTCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vblVSTFJlZGlyZWN0KHJlZGlyZWN0ZWRVUkwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMgIT09IDAgJiYgKHhoci5zdGF0dXMgPCAyMDAgfHwgeGhyLnN0YXR1cyA+IDI5OSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcihfbG9hZGVyLkxvYWRlckVycm9ycy5IVFRQX1NUQVRVU19DT0RFX0lOVkFMSUQsIHsgY29kZTogeGhyLnN0YXR1cywgbXNnOiB4aHIuc3RhdHVzVGV4dCB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLlJ1bnRpbWVFeGNlcHRpb24oJ01vekNodW5rZWRMb2FkZXI6IEh0dHAgY29kZSBpbnZhbGlkLCAnICsgeGhyLnN0YXR1cyArICcgJyArIHhoci5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtCdWZmZXJpbmc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Qcm9ncmVzcycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Qcm9ncmVzcyhlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhdHVzID09PSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAvLyBJZ25vcmUgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9jb250ZW50TGVuZ3RoID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgaWYgKGUudG90YWwgIT09IG51bGwgJiYgZS50b3RhbCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb250ZW50TGVuZ3RoID0gZS50b3RhbDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uQ29udGVudExlbmd0aEtub3duKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkNvbnRlbnRMZW5ndGhLbm93bih0aGlzLl9jb250ZW50TGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGNodW5rID0gZS50YXJnZXQucmVzcG9uc2U7XG4gICAgICAgICAgICB2YXIgYnl0ZVN0YXJ0ID0gdGhpcy5fcmFuZ2UuZnJvbSArIHRoaXMuX3JlY2VpdmVkTGVuZ3RoO1xuICAgICAgICAgICAgdGhpcy5fcmVjZWl2ZWRMZW5ndGggKz0gY2h1bmsuYnl0ZUxlbmd0aDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX29uRGF0YUFycml2YWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkRhdGFBcnJpdmFsKGNodW5rLCBieXRlU3RhcnQsIHRoaXMuX3JlY2VpdmVkTGVuZ3RoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uTG9hZEVuZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Mb2FkRW5kKGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9yZXF1ZXN0QWJvcnQgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0QWJvcnQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX3N0YXR1cyA9PT0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29tcGxldGU7XG4gICAgICAgICAgICBpZiAodGhpcy5fb25Db21wbGV0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uQ29tcGxldGUodGhpcy5fcmFuZ2UuZnJvbSwgdGhpcy5fcmFuZ2UuZnJvbSArIHRoaXMuX3JlY2VpdmVkTGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblhockVycm9yJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblhockVycm9yKGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcjtcbiAgICAgICAgICAgIHZhciB0eXBlID0gMDtcbiAgICAgICAgICAgIHZhciBpbmZvID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbnRlbnRMZW5ndGggJiYgZS5sb2FkZWQgPCB0aGlzLl9jb250ZW50TGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdHlwZSA9IF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVBUkxZX0VPRjtcbiAgICAgICAgICAgICAgICBpbmZvID0geyBjb2RlOiAtMSwgbXNnOiAnTW96LUNodW5rZWQgc3RyZWFtIG1lZXQgRWFybHktRW9mJyB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0eXBlID0gX2xvYWRlci5Mb2FkZXJFcnJvcnMuRVhDRVBUSU9OO1xuICAgICAgICAgICAgICAgIGluZm8gPSB7IGNvZGU6IC0xLCBtc2c6IGUuY29uc3RydWN0b3IubmFtZSArICcgJyArIGUudHlwZSB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5fb25FcnJvcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IodHlwZSwgaW5mbyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLlJ1bnRpbWVFeGNlcHRpb24oaW5mby5tc2cpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIE1vekNodW5rZWRMb2FkZXI7XG59KF9sb2FkZXIuQmFzZUxvYWRlcik7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IE1vekNodW5rZWRMb2FkZXI7XG5cbn0se1wiLi4vdXRpbHMvZXhjZXB0aW9uLmpzXCI6NDAsXCIuLi91dGlscy9sb2dnZXIuanNcIjo0MSxcIi4vbG9hZGVyLmpzXCI6MjR9XSwzMDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfbG9nZ2VyID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nZ2VyLmpzJyk7XG5cbnZhciBfbG9nZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dlcik7XG5cbnZhciBfbG9hZGVyID0gX2RlcmVxXygnLi9sb2FkZXIuanMnKTtcblxudmFyIF9leGNlcHRpb24gPSBfZGVyZXFfKCcuLi91dGlscy9leGNlcHRpb24uanMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfSAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG4vKiBOb3RpY2U6IG1zLXN0cmVhbSBtYXkgY2F1c2UgSUUvRWRnZSBicm93c2VyIGNyYXNoIGlmIHNlZWsgdG9vIGZyZXF1ZW50bHkhISFcclxuICogVGhlIGJyb3dzZXIgbWF5IGNyYXNoIGluIHdpbmluZXQuZGxsLiBEaXNhYmxlIGZvciBub3cuXHJcbiAqXHJcbiAqIEZvciBJRTExL0VkZ2UgYnJvd3NlciBieSBtaWNyb3NvZnQgd2hpY2ggc3VwcG9ydHMgYHhoci5yZXNwb25zZVR5cGUgPSAnbXMtc3RyZWFtJ2BcclxuICogTm90aWNlIHRoYXQgbXMtc3RyZWFtIEFQSSBzdWNrcy4gVGhlIGJ1ZmZlciBpcyBhbHdheXMgZXhwYW5kaW5nIGFsb25nIHdpdGggZG93bmxvYWRpbmcuXHJcbiAqXHJcbiAqIFdlIG5lZWQgdG8gYWJvcnQgdGhlIHhociBpZiBidWZmZXIgc2l6ZSBleGNlZWRlZCBsaW1pdCBzaXplIChlLmcuIDE2IE1pQiksIHRoZW4gZG8gcmVjb25uZWN0LlxyXG4gKiBpbiBvcmRlciB0byByZWxlYXNlIHByZXZpb3VzIEFycmF5QnVmZmVyIHRvIGF2b2lkIG1lbW9yeSBsZWFrXHJcbiAqXHJcbiAqIE90aGVyd2lzZSwgdGhlIEFycmF5QnVmZmVyIHdpbGwgaW5jcmVhc2UgdG8gYSB0ZXJyaWJsZSBzaXplIHRoYXQgZXF1YWxzIGZpbmFsIGZpbGUgc2l6ZS5cclxuICovXG52YXIgTVNTdHJlYW1Mb2FkZXIgPSBmdW5jdGlvbiAoX0Jhc2VMb2FkZXIpIHtcbiAgICBfaW5oZXJpdHMoTVNTdHJlYW1Mb2FkZXIsIF9CYXNlTG9hZGVyKTtcblxuICAgIF9jcmVhdGVDbGFzcyhNU1N0cmVhbUxvYWRlciwgbnVsbCwgW3tcbiAgICAgICAga2V5OiAnaXNTdXBwb3J0ZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaXNTdXBwb3J0ZWQoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygc2VsZi5NU1N0cmVhbSA9PT0gJ3VuZGVmaW5lZCcgfHwgdHlwZW9mIHNlbGYuTVNTdHJlYW1SZWFkZXIgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgICAgICAgICAgeGhyLm9wZW4oJ0dFVCcsICdodHRwczovL2V4YW1wbGUuY29tJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdtcy1zdHJlYW0nO1xuICAgICAgICAgICAgICAgIHJldHVybiB4aHIucmVzcG9uc2VUeXBlID09PSAnbXMtc3RyZWFtJztcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncoJ01TU3RyZWFtTG9hZGVyJywgZS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICBmdW5jdGlvbiBNU1N0cmVhbUxvYWRlcihzZWVrSGFuZGxlciwgY29uZmlnKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNU1N0cmVhbUxvYWRlcik7XG5cbiAgICAgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKE1TU3RyZWFtTG9hZGVyLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTVNTdHJlYW1Mb2FkZXIpKS5jYWxsKHRoaXMsICd4aHItbXNzdHJlYW0tbG9hZGVyJykpO1xuXG4gICAgICAgIF90aGlzLlRBRyA9ICdNU1N0cmVhbUxvYWRlcic7XG5cbiAgICAgICAgX3RoaXMuX3NlZWtIYW5kbGVyID0gc2Vla0hhbmRsZXI7XG4gICAgICAgIF90aGlzLl9jb25maWcgPSBjb25maWc7XG4gICAgICAgIF90aGlzLl9uZWVkU3Rhc2ggPSB0cnVlO1xuXG4gICAgICAgIF90aGlzLl94aHIgPSBudWxsO1xuICAgICAgICBfdGhpcy5fcmVhZGVyID0gbnVsbDsgLy8gTVNTdHJlYW1SZWFkZXJcblxuICAgICAgICBfdGhpcy5fdG90YWxSYW5nZSA9IG51bGw7XG4gICAgICAgIF90aGlzLl9jdXJyZW50UmFuZ2UgPSBudWxsO1xuXG4gICAgICAgIF90aGlzLl9jdXJyZW50UmVxdWVzdFVSTCA9IG51bGw7XG4gICAgICAgIF90aGlzLl9jdXJyZW50UmVkaXJlY3RlZFVSTCA9IG51bGw7XG5cbiAgICAgICAgX3RoaXMuX2NvbnRlbnRMZW5ndGggPSBudWxsO1xuICAgICAgICBfdGhpcy5fcmVjZWl2ZWRMZW5ndGggPSAwO1xuXG4gICAgICAgIF90aGlzLl9idWZmZXJMaW1pdCA9IDE2ICogMTAyNCAqIDEwMjQ7IC8vIDE2TUJcbiAgICAgICAgX3RoaXMuX2xhc3RUaW1lQnVmZmVyU2l6ZSA9IDA7XG4gICAgICAgIF90aGlzLl9pc1JlY29ubmVjdGluZyA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKE1TU3RyZWFtTG9hZGVyLCBbe1xuICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1dvcmtpbmcoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9yZWFkZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWFkZXIub25wcm9ncmVzcyA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVhZGVyLm9ubG9hZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVhZGVyLm9uZXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlYWRlciA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5feGhyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9nZXQoTVNTdHJlYW1Mb2FkZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTVNTdHJlYW1Mb2FkZXIucHJvdG90eXBlKSwgJ2Rlc3Ryb3knLCB0aGlzKS5jYWxsKHRoaXMpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvcGVuJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW4oZGF0YVNvdXJjZSwgcmFuZ2UpIHtcbiAgICAgICAgICAgIHRoaXMuX2ludGVybmFsT3BlbihkYXRhU291cmNlLCByYW5nZSwgZmFsc2UpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfaW50ZXJuYWxPcGVuJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9pbnRlcm5hbE9wZW4oZGF0YVNvdXJjZSwgcmFuZ2UsIGlzU3VicmFuZ2UpIHtcbiAgICAgICAgICAgIHRoaXMuX2RhdGFTb3VyY2UgPSBkYXRhU291cmNlO1xuXG4gICAgICAgICAgICBpZiAoIWlzU3VicmFuZ2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90b3RhbFJhbmdlID0gcmFuZ2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRSYW5nZSA9IHJhbmdlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc291cmNlVVJMID0gZGF0YVNvdXJjZS51cmw7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29uZmlnLnJldXNlUmVkaXJlY3RlZFVSTCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9jdXJyZW50UmVkaXJlY3RlZFVSTCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlVVJMID0gdGhpcy5fY3VycmVudFJlZGlyZWN0ZWRVUkw7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhU291cmNlLnJlZGlyZWN0ZWRVUkwgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZVVSTCA9IGRhdGFTb3VyY2UucmVkaXJlY3RlZFVSTDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzZWVrQ29uZmlnID0gdGhpcy5fc2Vla0hhbmRsZXIuZ2V0Q29uZmlnKHNvdXJjZVVSTCwgcmFuZ2UpO1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFJlcXVlc3RVUkwgPSBzZWVrQ29uZmlnLnVybDtcblxuICAgICAgICAgICAgdmFyIHJlYWRlciA9IHRoaXMuX3JlYWRlciA9IG5ldyBzZWxmLk1TU3RyZWFtUmVhZGVyKCk7XG4gICAgICAgICAgICByZWFkZXIub25wcm9ncmVzcyA9IHRoaXMuX21zck9uUHJvZ3Jlc3MuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSB0aGlzLl9tc3JPbkxvYWQuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHJlYWRlci5vbmVycm9yID0gdGhpcy5fbXNyT25FcnJvci5iaW5kKHRoaXMpO1xuXG4gICAgICAgICAgICB2YXIgeGhyID0gdGhpcy5feGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgICAgICB4aHIub3BlbignR0VUJywgc2Vla0NvbmZpZy51cmwsIHRydWUpO1xuICAgICAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdtcy1zdHJlYW0nO1xuICAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IHRoaXMuX3hock9uUmVhZHlTdGF0ZUNoYW5nZS5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgeGhyLm9uZXJyb3IgPSB0aGlzLl94aHJPbkVycm9yLmJpbmQodGhpcyk7XG5cbiAgICAgICAgICAgIGlmIChkYXRhU291cmNlLndpdGhDcmVkZW50aWFscykge1xuICAgICAgICAgICAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoX3R5cGVvZihzZWVrQ29uZmlnLmhlYWRlcnMpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIHZhciBoZWFkZXJzID0gc2Vla0NvbmZpZy5oZWFkZXJzO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhlYWRlcnMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoa2V5LCBoZWFkZXJzW2tleV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBhZGQgYWRkaXRpb25hbCBoZWFkZXJzXG4gICAgICAgICAgICBpZiAoX3R5cGVvZih0aGlzLl9jb25maWcuaGVhZGVycykgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9oZWFkZXJzID0gdGhpcy5fY29uZmlnLmhlYWRlcnM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfa2V5IGluIF9oZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfaGVhZGVycy5oYXNPd25Qcm9wZXJ0eShfa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoX2tleSwgX2hlYWRlcnNbX2tleV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5faXNSZWNvbm5lY3RpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pc1JlY29ubmVjdGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29ubmVjdGluZztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHhoci5zZW5kKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2Fib3J0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFib3J0KCkge1xuICAgICAgICAgICAgdGhpcy5faW50ZXJuYWxBYm9ydCgpO1xuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0NvbXBsZXRlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfaW50ZXJuYWxBYm9ydCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfaW50ZXJuYWxBYm9ydCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9yZWFkZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcmVhZGVyLnJlYWR5U3RhdGUgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTE9BRElOR1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZWFkZXIuYWJvcnQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVhZGVyLm9ucHJvZ3Jlc3MgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlYWRlci5vbmxvYWQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlYWRlci5vbmVycm9yID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWFkZXIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX3hocikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5hYm9ydCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3hociA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ194aHJPblJlYWR5U3RhdGVDaGFuZ2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3hock9uUmVhZHlTdGF0ZUNoYW5nZShlKSB7XG4gICAgICAgICAgICB2YXIgeGhyID0gZS50YXJnZXQ7XG5cbiAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gMikge1xuICAgICAgICAgICAgICAgIC8vIEhFQURFUlNfUkVDRUlWRURcbiAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA+PSAyMDAgJiYgeGhyLnN0YXR1cyA8PSAyOTkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0J1ZmZlcmluZztcblxuICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnJlc3BvbnNlVVJMICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlZGlyZWN0ZWRVUkwgPSB0aGlzLl9zZWVrSGFuZGxlci5yZW1vdmVVUkxQYXJhbWV0ZXJzKHhoci5yZXNwb25zZVVSTCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnJlc3BvbnNlVVJMICE9PSB0aGlzLl9jdXJyZW50UmVxdWVzdFVSTCAmJiByZWRpcmVjdGVkVVJMICE9PSB0aGlzLl9jdXJyZW50UmVkaXJlY3RlZFVSTCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRSZWRpcmVjdGVkVVJMID0gcmVkaXJlY3RlZFVSTDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25VUkxSZWRpcmVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vblVSTFJlZGlyZWN0KHJlZGlyZWN0ZWRVUkwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBsZW5ndGhIZWFkZXIgPSB4aHIuZ2V0UmVzcG9uc2VIZWFkZXIoJ0NvbnRlbnQtTGVuZ3RoJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsZW5ndGhIZWFkZXIgIT0gbnVsbCAmJiB0aGlzLl9jb250ZW50TGVuZ3RoID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsZW5ndGggPSBwYXJzZUludChsZW5ndGhIZWFkZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb250ZW50TGVuZ3RoID0gbGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vbkNvbnRlbnRMZW5ndGhLbm93bikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkNvbnRlbnRMZW5ndGhLbm93bih0aGlzLl9jb250ZW50TGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKF9sb2FkZXIuTG9hZGVyRXJyb3JzLkhUVFBfU1RBVFVTX0NPREVfSU5WQUxJRCwgeyBjb2RlOiB4aHIuc3RhdHVzLCBtc2c6IHhoci5zdGF0dXNUZXh0IH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uUnVudGltZUV4Y2VwdGlvbignTVNTdHJlYW1Mb2FkZXI6IEh0dHAgY29kZSBpbnZhbGlkLCAnICsgeGhyLnN0YXR1cyArICcgJyArIHhoci5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDMpIHtcbiAgICAgICAgICAgICAgICAvLyBMT0FESU5HXG4gICAgICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMgPj0gMjAwICYmIHhoci5zdGF0dXMgPD0gMjk5KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtCdWZmZXJpbmc7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIG1zc3RyZWFtID0geGhyLnJlc3BvbnNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIobXNzdHJlYW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3hock9uRXJyb3InLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3hock9uRXJyb3IoZSkge1xuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yO1xuICAgICAgICAgICAgdmFyIHR5cGUgPSBfbG9hZGVyLkxvYWRlckVycm9ycy5FWENFUFRJT047XG4gICAgICAgICAgICB2YXIgaW5mbyA9IHsgY29kZTogLTEsIG1zZzogZS5jb25zdHJ1Y3Rvci5uYW1lICsgJyAnICsgZS50eXBlIH07XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcih0eXBlLCBpbmZvKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uUnVudGltZUV4Y2VwdGlvbihpbmZvLm1zZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19tc3JPblByb2dyZXNzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9tc3JPblByb2dyZXNzKGUpIHtcbiAgICAgICAgICAgIHZhciByZWFkZXIgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIHZhciBiaWdidWZmZXIgPSByZWFkZXIucmVzdWx0O1xuICAgICAgICAgICAgaWYgKGJpZ2J1ZmZlciA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgLy8gcmVzdWx0IG1heSBiZSBudWxsLCB3b3JrYXJvdW5kIGZvciBidWdneSBNJFxuICAgICAgICAgICAgICAgIHRoaXMuX2RvUmVjb25uZWN0SWZOZWVkZWQoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzbGljZSA9IGJpZ2J1ZmZlci5zbGljZSh0aGlzLl9sYXN0VGltZUJ1ZmZlclNpemUpO1xuICAgICAgICAgICAgdGhpcy5fbGFzdFRpbWVCdWZmZXJTaXplID0gYmlnYnVmZmVyLmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICB2YXIgYnl0ZVN0YXJ0ID0gdGhpcy5fdG90YWxSYW5nZS5mcm9tICsgdGhpcy5fcmVjZWl2ZWRMZW5ndGg7XG4gICAgICAgICAgICB0aGlzLl9yZWNlaXZlZExlbmd0aCArPSBzbGljZS5ieXRlTGVuZ3RoO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fb25EYXRhQXJyaXZhbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRGF0YUFycml2YWwoc2xpY2UsIGJ5dGVTdGFydCwgdGhpcy5fcmVjZWl2ZWRMZW5ndGgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoYmlnYnVmZmVyLmJ5dGVMZW5ndGggPj0gdGhpcy5fYnVmZmVyTGltaXQpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYodGhpcy5UQUcsICdNU1N0cmVhbSBidWZmZXIgZXhjZWVkZWQgbWF4IHNpemUgbmVhciAnICsgKGJ5dGVTdGFydCArIHNsaWNlLmJ5dGVMZW5ndGgpICsgJywgcmVjb25uZWN0aW5nLi4uJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZG9SZWNvbm5lY3RJZk5lZWRlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfZG9SZWNvbm5lY3RJZk5lZWRlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZG9SZWNvbm5lY3RJZk5lZWRlZCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9jb250ZW50TGVuZ3RoID09IG51bGwgfHwgdGhpcy5fcmVjZWl2ZWRMZW5ndGggPCB0aGlzLl9jb250ZW50TGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faXNSZWNvbm5lY3RpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2xhc3RUaW1lQnVmZmVyU2l6ZSA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5faW50ZXJuYWxBYm9ydCgpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHJhbmdlID0ge1xuICAgICAgICAgICAgICAgICAgICBmcm9tOiB0aGlzLl90b3RhbFJhbmdlLmZyb20gKyB0aGlzLl9yZWNlaXZlZExlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgdG86IC0xXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnRlcm5hbE9wZW4odGhpcy5fZGF0YVNvdXJjZSwgcmFuZ2UsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfbXNyT25Mb2FkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9tc3JPbkxvYWQoZSkge1xuICAgICAgICAgICAgLy8gYWN0dWFsbHkgaXQgaXMgb25Db21wbGV0ZSBldmVudFxuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0NvbXBsZXRlO1xuICAgICAgICAgICAgaWYgKHRoaXMuX29uQ29tcGxldGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkNvbXBsZXRlKHRoaXMuX3RvdGFsUmFuZ2UuZnJvbSwgdGhpcy5fdG90YWxSYW5nZS5mcm9tICsgdGhpcy5fcmVjZWl2ZWRMZW5ndGggLSAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX21zck9uRXJyb3InLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX21zck9uRXJyb3IoZSkge1xuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yO1xuICAgICAgICAgICAgdmFyIHR5cGUgPSAwO1xuICAgICAgICAgICAgdmFyIGluZm8gPSBudWxsO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fY29udGVudExlbmd0aCAmJiB0aGlzLl9yZWNlaXZlZExlbmd0aCA8IHRoaXMuX2NvbnRlbnRMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0eXBlID0gX2xvYWRlci5Mb2FkZXJFcnJvcnMuRUFSTFlfRU9GO1xuICAgICAgICAgICAgICAgIGluZm8gPSB7IGNvZGU6IC0xLCBtc2c6ICdNU1N0cmVhbSBtZWV0IEVhcmx5LUVvZicgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdHlwZSA9IF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVBUkxZX0VPRjtcbiAgICAgICAgICAgICAgICBpbmZvID0geyBjb2RlOiAtMSwgbXNnOiBlLmNvbnN0cnVjdG9yLm5hbWUgKyAnICcgKyBlLnR5cGUgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX29uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKHR5cGUsIGluZm8pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5SdW50aW1lRXhjZXB0aW9uKGluZm8ubXNnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBNU1N0cmVhbUxvYWRlcjtcbn0oX2xvYWRlci5CYXNlTG9hZGVyKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gTVNTdHJlYW1Mb2FkZXI7XG5cbn0se1wiLi4vdXRpbHMvZXhjZXB0aW9uLmpzXCI6NDAsXCIuLi91dGlscy9sb2dnZXIuanNcIjo0MSxcIi4vbG9hZGVyLmpzXCI6MjR9XSwzMTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfbG9nZ2VyID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nZ2VyLmpzJyk7XG5cbnZhciBfbG9nZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dlcik7XG5cbnZhciBfc3BlZWRTYW1wbGVyID0gX2RlcmVxXygnLi9zcGVlZC1zYW1wbGVyLmpzJyk7XG5cbnZhciBfc3BlZWRTYW1wbGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3NwZWVkU2FtcGxlcik7XG5cbnZhciBfbG9hZGVyID0gX2RlcmVxXygnLi9sb2FkZXIuanMnKTtcblxudmFyIF9leGNlcHRpb24gPSBfZGVyZXFfKCcuLi91dGlscy9leGNlcHRpb24uanMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfSAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG4vLyBVbml2ZXJzYWwgSU8gTG9hZGVyLCBpbXBsZW1lbnRlZCBieSBhZGRpbmcgUmFuZ2UgaGVhZGVyIGluIHhocidzIHJlcXVlc3QgaGVhZGVyXG52YXIgUmFuZ2VMb2FkZXIgPSBmdW5jdGlvbiAoX0Jhc2VMb2FkZXIpIHtcbiAgICBfaW5oZXJpdHMoUmFuZ2VMb2FkZXIsIF9CYXNlTG9hZGVyKTtcblxuICAgIF9jcmVhdGVDbGFzcyhSYW5nZUxvYWRlciwgbnVsbCwgW3tcbiAgICAgICAga2V5OiAnaXNTdXBwb3J0ZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaXNTdXBwb3J0ZWQoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgICB4aHIub3BlbignR0VUJywgJ2h0dHBzOi8vZXhhbXBsZS5jb20nLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2FycmF5YnVmZmVyJztcbiAgICAgICAgICAgICAgICByZXR1cm4geGhyLnJlc3BvbnNlVHlwZSA9PT0gJ2FycmF5YnVmZmVyJztcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncoJ1JhbmdlTG9hZGVyJywgZS5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICBmdW5jdGlvbiBSYW5nZUxvYWRlcihzZWVrSGFuZGxlciwgY29uZmlnKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBSYW5nZUxvYWRlcik7XG5cbiAgICAgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFJhbmdlTG9hZGVyLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoUmFuZ2VMb2FkZXIpKS5jYWxsKHRoaXMsICd4aHItcmFuZ2UtbG9hZGVyJykpO1xuXG4gICAgICAgIF90aGlzLlRBRyA9ICdSYW5nZUxvYWRlcic7XG5cbiAgICAgICAgX3RoaXMuX3NlZWtIYW5kbGVyID0gc2Vla0hhbmRsZXI7XG4gICAgICAgIF90aGlzLl9jb25maWcgPSBjb25maWc7XG4gICAgICAgIF90aGlzLl9uZWVkU3Rhc2ggPSBmYWxzZTtcblxuICAgICAgICBfdGhpcy5fY2h1bmtTaXplS0JMaXN0ID0gWzEyOCwgMjU2LCAzODQsIDUxMiwgNzY4LCAxMDI0LCAxNTM2LCAyMDQ4LCAzMDcyLCA0MDk2LCA1MTIwLCA2MTQ0LCA3MTY4LCA4MTkyXTtcbiAgICAgICAgX3RoaXMuX2N1cnJlbnRDaHVua1NpemVLQiA9IDM4NDtcbiAgICAgICAgX3RoaXMuX2N1cnJlbnRTcGVlZE5vcm1hbGl6ZWQgPSAwO1xuICAgICAgICBfdGhpcy5femVyb1NwZWVkQ2h1bmtDb3VudCA9IDA7XG5cbiAgICAgICAgX3RoaXMuX3hociA9IG51bGw7XG4gICAgICAgIF90aGlzLl9zcGVlZFNhbXBsZXIgPSBuZXcgX3NwZWVkU2FtcGxlcjIuZGVmYXVsdCgpO1xuXG4gICAgICAgIF90aGlzLl9yZXF1ZXN0QWJvcnQgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMuX3dhaXRGb3JUb3RhbExlbmd0aCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5fdG90YWxMZW5ndGhSZWNlaXZlZCA9IGZhbHNlO1xuXG4gICAgICAgIF90aGlzLl9jdXJyZW50UmVxdWVzdFVSTCA9IG51bGw7XG4gICAgICAgIF90aGlzLl9jdXJyZW50UmVkaXJlY3RlZFVSTCA9IG51bGw7XG4gICAgICAgIF90aGlzLl9jdXJyZW50UmVxdWVzdFJhbmdlID0gbnVsbDtcbiAgICAgICAgX3RoaXMuX3RvdGFsTGVuZ3RoID0gbnVsbDsgLy8gc2l6ZSBvZiB0aGUgZW50aXJlIGZpbGVcbiAgICAgICAgX3RoaXMuX2NvbnRlbnRMZW5ndGggPSBudWxsOyAvLyBDb250ZW50LUxlbmd0aCBvZiBlbnRpcmUgcmVxdWVzdCByYW5nZVxuICAgICAgICBfdGhpcy5fcmVjZWl2ZWRMZW5ndGggPSAwOyAvLyB0b3RhbCByZWNlaXZlZCBieXRlc1xuICAgICAgICBfdGhpcy5fbGFzdFRpbWVMb2FkZWQgPSAwOyAvLyByZWNlaXZlZCBieXRlcyBvZiBjdXJyZW50IHJlcXVlc3Qgc3ViLXJhbmdlXG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoUmFuZ2VMb2FkZXIsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzV29ya2luZygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX3hocikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5vbnByb2dyZXNzID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIub25sb2FkID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIub25lcnJvciA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9nZXQoUmFuZ2VMb2FkZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoUmFuZ2VMb2FkZXIucHJvdG90eXBlKSwgJ2Rlc3Ryb3knLCB0aGlzKS5jYWxsKHRoaXMpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvcGVuJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW4oZGF0YVNvdXJjZSwgcmFuZ2UpIHtcbiAgICAgICAgICAgIHRoaXMuX2RhdGFTb3VyY2UgPSBkYXRhU291cmNlO1xuICAgICAgICAgICAgdGhpcy5fcmFuZ2UgPSByYW5nZTtcbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb25uZWN0aW5nO1xuXG4gICAgICAgICAgICB2YXIgdXNlUmVmVG90YWxMZW5ndGggPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9kYXRhU291cmNlLmZpbGVzaXplICE9IHVuZGVmaW5lZCAmJiB0aGlzLl9kYXRhU291cmNlLmZpbGVzaXplICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgdXNlUmVmVG90YWxMZW5ndGggPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RvdGFsTGVuZ3RoID0gdGhpcy5fZGF0YVNvdXJjZS5maWxlc2l6ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCF0aGlzLl90b3RhbExlbmd0aFJlY2VpdmVkICYmICF1c2VSZWZUb3RhbExlbmd0aCkge1xuICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG90YWwgZmlsZXNpemVcbiAgICAgICAgICAgICAgICB0aGlzLl93YWl0Rm9yVG90YWxMZW5ndGggPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2ludGVybmFsT3Blbih0aGlzLl9kYXRhU291cmNlLCB7IGZyb206IDAsIHRvOiAtMSB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gV2UgaGF2ZSBmaWxlc2l6ZSwgc3RhcnQgbG9hZGluZ1xuICAgICAgICAgICAgICAgIHRoaXMuX29wZW5TdWJSYW5nZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb3BlblN1YlJhbmdlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vcGVuU3ViUmFuZ2UoKSB7XG4gICAgICAgICAgICB2YXIgY2h1bmtTaXplID0gdGhpcy5fY3VycmVudENodW5rU2l6ZUtCICogMTAyNDtcblxuICAgICAgICAgICAgdmFyIGZyb20gPSB0aGlzLl9yYW5nZS5mcm9tICsgdGhpcy5fcmVjZWl2ZWRMZW5ndGg7XG4gICAgICAgICAgICB2YXIgdG8gPSBmcm9tICsgY2h1bmtTaXplO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fY29udGVudExlbmd0aCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRvIC0gdGhpcy5fcmFuZ2UuZnJvbSA+PSB0aGlzLl9jb250ZW50TGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRvID0gdGhpcy5fcmFuZ2UuZnJvbSArIHRoaXMuX2NvbnRlbnRMZW5ndGggLSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fY3VycmVudFJlcXVlc3RSYW5nZSA9IHsgZnJvbTogZnJvbSwgdG86IHRvIH07XG4gICAgICAgICAgICB0aGlzLl9pbnRlcm5hbE9wZW4odGhpcy5fZGF0YVNvdXJjZSwgdGhpcy5fY3VycmVudFJlcXVlc3RSYW5nZSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19pbnRlcm5hbE9wZW4nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2ludGVybmFsT3BlbihkYXRhU291cmNlLCByYW5nZSkge1xuICAgICAgICAgICAgdGhpcy5fbGFzdFRpbWVMb2FkZWQgPSAwO1xuXG4gICAgICAgICAgICB2YXIgc291cmNlVVJMID0gZGF0YVNvdXJjZS51cmw7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29uZmlnLnJldXNlUmVkaXJlY3RlZFVSTCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9jdXJyZW50UmVkaXJlY3RlZFVSTCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlVVJMID0gdGhpcy5fY3VycmVudFJlZGlyZWN0ZWRVUkw7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkYXRhU291cmNlLnJlZGlyZWN0ZWRVUkwgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZVVSTCA9IGRhdGFTb3VyY2UucmVkaXJlY3RlZFVSTDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzZWVrQ29uZmlnID0gdGhpcy5fc2Vla0hhbmRsZXIuZ2V0Q29uZmlnKHNvdXJjZVVSTCwgcmFuZ2UpO1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFJlcXVlc3RVUkwgPSBzZWVrQ29uZmlnLnVybDtcblxuICAgICAgICAgICAgdmFyIHhociA9IHRoaXMuX3hociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICAgICAgeGhyLm9wZW4oJ0dFVCcsIHNlZWtDb25maWcudXJsLCB0cnVlKTtcbiAgICAgICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnYXJyYXlidWZmZXInO1xuICAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IHRoaXMuX29uUmVhZHlTdGF0ZUNoYW5nZS5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgeGhyLm9ucHJvZ3Jlc3MgPSB0aGlzLl9vblByb2dyZXNzLmJpbmQodGhpcyk7XG4gICAgICAgICAgICB4aHIub25sb2FkID0gdGhpcy5fb25Mb2FkLmJpbmQodGhpcyk7XG4gICAgICAgICAgICB4aHIub25lcnJvciA9IHRoaXMuX29uWGhyRXJyb3IuYmluZCh0aGlzKTtcblxuICAgICAgICAgICAgaWYgKGRhdGFTb3VyY2Uud2l0aENyZWRlbnRpYWxzKSB7XG4gICAgICAgICAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChfdHlwZW9mKHNlZWtDb25maWcuaGVhZGVycykgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGhlYWRlcnMgPSBzZWVrQ29uZmlnLmhlYWRlcnM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gaGVhZGVycykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaGVhZGVycy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihrZXksIGhlYWRlcnNba2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFkZCBhZGRpdGlvbmFsIGhlYWRlcnNcbiAgICAgICAgICAgIGlmIChfdHlwZW9mKHRoaXMuX2NvbmZpZy5oZWFkZXJzKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2hlYWRlcnMgPSB0aGlzLl9jb25maWcuaGVhZGVycztcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9rZXkgaW4gX2hlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9oZWFkZXJzLmhhc093blByb3BlcnR5KF9rZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihfa2V5LCBfaGVhZGVyc1tfa2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHhoci5zZW5kKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2Fib3J0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFib3J0KCkge1xuICAgICAgICAgICAgdGhpcy5fcmVxdWVzdEFib3J0ID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuX2ludGVybmFsQWJvcnQoKTtcbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb21wbGV0ZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2ludGVybmFsQWJvcnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2ludGVybmFsQWJvcnQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5feGhyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLm9ucHJvZ3Jlc3MgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5vbmxvYWQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5vbmVycm9yID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIuYWJvcnQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25SZWFkeVN0YXRlQ2hhbmdlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlYWR5U3RhdGVDaGFuZ2UoZSkge1xuICAgICAgICAgICAgdmFyIHhociA9IGUudGFyZ2V0O1xuXG4gICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDIpIHtcbiAgICAgICAgICAgICAgICAvLyBIRUFERVJTX1JFQ0VJVkVEXG4gICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZVVSTCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgdGhlIGJyb3dzZXIgc3VwcG9ydCB0aGlzIHByb3BlcnR5XG4gICAgICAgICAgICAgICAgICAgIHZhciByZWRpcmVjdGVkVVJMID0gdGhpcy5fc2Vla0hhbmRsZXIucmVtb3ZlVVJMUGFyYW1ldGVycyh4aHIucmVzcG9uc2VVUkwpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoeGhyLnJlc3BvbnNlVVJMICE9PSB0aGlzLl9jdXJyZW50UmVxdWVzdFVSTCAmJiByZWRpcmVjdGVkVVJMICE9PSB0aGlzLl9jdXJyZW50UmVkaXJlY3RlZFVSTCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudFJlZGlyZWN0ZWRVUkwgPSByZWRpcmVjdGVkVVJMO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uVVJMUmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vblVSTFJlZGlyZWN0KHJlZGlyZWN0ZWRVUkwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMgPj0gMjAwICYmIHhoci5zdGF0dXMgPD0gMjk5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl93YWl0Rm9yVG90YWxMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQnVmZmVyaW5nO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoX2xvYWRlci5Mb2FkZXJFcnJvcnMuSFRUUF9TVEFUVVNfQ09ERV9JTlZBTElELCB7IGNvZGU6IHhoci5zdGF0dXMsIG1zZzogeGhyLnN0YXR1c1RleHQgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5SdW50aW1lRXhjZXB0aW9uKCdSYW5nZUxvYWRlcjogSHR0cCBjb2RlIGludmFsaWQsICcgKyB4aHIuc3RhdHVzICsgJyAnICsgeGhyLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Qcm9ncmVzcycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Qcm9ncmVzcyhlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhdHVzID09PSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAvLyBJZ25vcmUgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9jb250ZW50TGVuZ3RoID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9wZW5OZXh0UmFuZ2UgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl93YWl0Rm9yVG90YWxMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fd2FpdEZvclRvdGFsTGVuZ3RoID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RvdGFsTGVuZ3RoUmVjZWl2ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBvcGVuTmV4dFJhbmdlID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgdG90YWwgPSBlLnRvdGFsO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbnRlcm5hbEFib3J0KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0b3RhbCAhPSBudWxsICYgdG90YWwgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3RvdGFsTGVuZ3RoID0gdG90YWw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBjYWxjdWxhdGUgY3VycnJlbnQgcmVxdWVzdCByYW5nZSdzIGNvbnRlbnRMZW5ndGhcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcmFuZ2UudG8gPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRMZW5ndGggPSB0aGlzLl90b3RhbExlbmd0aCAtIHRoaXMuX3JhbmdlLmZyb207XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdG8gIT09IC0xXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRMZW5ndGggPSB0aGlzLl9yYW5nZS50byAtIHRoaXMuX3JhbmdlLmZyb20gKyAxO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChvcGVuTmV4dFJhbmdlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29wZW5TdWJSYW5nZSgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vbkNvbnRlbnRMZW5ndGhLbm93bikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkNvbnRlbnRMZW5ndGhLbm93bih0aGlzLl9jb250ZW50TGVuZ3RoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBkZWx0YSA9IGUubG9hZGVkIC0gdGhpcy5fbGFzdFRpbWVMb2FkZWQ7XG4gICAgICAgICAgICB0aGlzLl9sYXN0VGltZUxvYWRlZCA9IGUubG9hZGVkO1xuICAgICAgICAgICAgdGhpcy5fc3BlZWRTYW1wbGVyLmFkZEJ5dGVzKGRlbHRhKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX25vcm1hbGl6ZVNwZWVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9ub3JtYWxpemVTcGVlZChpbnB1dCkge1xuICAgICAgICAgICAgdmFyIGxpc3QgPSB0aGlzLl9jaHVua1NpemVLQkxpc3Q7XG4gICAgICAgICAgICB2YXIgbGFzdCA9IGxpc3QubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIHZhciBtaWQgPSAwO1xuICAgICAgICAgICAgdmFyIGxib3VuZCA9IDA7XG4gICAgICAgICAgICB2YXIgdWJvdW5kID0gbGFzdDtcblxuICAgICAgICAgICAgaWYgKGlucHV0IDwgbGlzdFswXSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBsaXN0WzBdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3aGlsZSAobGJvdW5kIDw9IHVib3VuZCkge1xuICAgICAgICAgICAgICAgIG1pZCA9IGxib3VuZCArIE1hdGguZmxvb3IoKHVib3VuZCAtIGxib3VuZCkgLyAyKTtcbiAgICAgICAgICAgICAgICBpZiAobWlkID09PSBsYXN0IHx8IGlucHV0ID49IGxpc3RbbWlkXSAmJiBpbnB1dCA8IGxpc3RbbWlkICsgMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpc3RbbWlkXTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpc3RbbWlkXSA8IGlucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgIGxib3VuZCA9IG1pZCArIDE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdWJvdW5kID0gbWlkIC0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbkxvYWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uTG9hZChlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhdHVzID09PSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAvLyBJZ25vcmUgZXJyb3IgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl93YWl0Rm9yVG90YWxMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl93YWl0Rm9yVG90YWxMZW5ndGggPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX2xhc3RUaW1lTG9hZGVkID0gMDtcbiAgICAgICAgICAgIHZhciBLQnBzID0gdGhpcy5fc3BlZWRTYW1wbGVyLmxhc3RTZWNvbmRLQnBzO1xuICAgICAgICAgICAgaWYgKEtCcHMgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl96ZXJvU3BlZWRDaHVua0NvdW50Kys7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3plcm9TcGVlZENodW5rQ291bnQgPj0gMykge1xuICAgICAgICAgICAgICAgICAgICAvLyBUcnkgZ2V0IGN1cnJlbnRLQnBzIGFmdGVyIDMgY2h1bmtzXG4gICAgICAgICAgICAgICAgICAgIEtCcHMgPSB0aGlzLl9zcGVlZFNhbXBsZXIuY3VycmVudEtCcHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoS0JwcyAhPT0gMCkge1xuICAgICAgICAgICAgICAgIHZhciBub3JtYWxpemVkID0gdGhpcy5fbm9ybWFsaXplU3BlZWQoS0Jwcyk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRTcGVlZE5vcm1hbGl6ZWQgIT09IG5vcm1hbGl6ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudFNwZWVkTm9ybWFsaXplZCA9IG5vcm1hbGl6ZWQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRDaHVua1NpemVLQiA9IG5vcm1hbGl6ZWQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgY2h1bmsgPSBlLnRhcmdldC5yZXNwb25zZTtcbiAgICAgICAgICAgIHZhciBieXRlU3RhcnQgPSB0aGlzLl9yYW5nZS5mcm9tICsgdGhpcy5fcmVjZWl2ZWRMZW5ndGg7XG4gICAgICAgICAgICB0aGlzLl9yZWNlaXZlZExlbmd0aCArPSBjaHVuay5ieXRlTGVuZ3RoO1xuXG4gICAgICAgICAgICB2YXIgcmVwb3J0Q29tcGxldGUgPSBmYWxzZTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbnRlbnRMZW5ndGggIT0gbnVsbCAmJiB0aGlzLl9yZWNlaXZlZExlbmd0aCA8IHRoaXMuX2NvbnRlbnRMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAvLyBjb250aW51ZSBsb2FkIG5leHQgY2h1bmtcbiAgICAgICAgICAgICAgICB0aGlzLl9vcGVuU3ViUmFuZ2UoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVwb3J0Q29tcGxldGUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBkaXNwYXRjaCByZWNlaXZlZCBjaHVua1xuICAgICAgICAgICAgaWYgKHRoaXMuX29uRGF0YUFycml2YWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkRhdGFBcnJpdmFsKGNodW5rLCBieXRlU3RhcnQsIHRoaXMuX3JlY2VpdmVkTGVuZ3RoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHJlcG9ydENvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0NvbXBsZXRlO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vbkNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uQ29tcGxldGUodGhpcy5fcmFuZ2UuZnJvbSwgdGhpcy5fcmFuZ2UuZnJvbSArIHRoaXMuX3JlY2VpdmVkTGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25YaHJFcnJvcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25YaHJFcnJvcihlKSB7XG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3I7XG4gICAgICAgICAgICB2YXIgdHlwZSA9IDA7XG4gICAgICAgICAgICB2YXIgaW5mbyA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9jb250ZW50TGVuZ3RoICYmIHRoaXMuX3JlY2VpdmVkTGVuZ3RoID4gMCAmJiB0aGlzLl9yZWNlaXZlZExlbmd0aCA8IHRoaXMuX2NvbnRlbnRMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0eXBlID0gX2xvYWRlci5Mb2FkZXJFcnJvcnMuRUFSTFlfRU9GO1xuICAgICAgICAgICAgICAgIGluZm8gPSB7IGNvZGU6IC0xLCBtc2c6ICdSYW5nZUxvYWRlciBtZWV0IEVhcmx5LUVvZicgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdHlwZSA9IF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVYQ0VQVElPTjtcbiAgICAgICAgICAgICAgICBpbmZvID0geyBjb2RlOiAtMSwgbXNnOiBlLmNvbnN0cnVjdG9yLm5hbWUgKyAnICcgKyBlLnR5cGUgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX29uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKHR5cGUsIGluZm8pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5SdW50aW1lRXhjZXB0aW9uKGluZm8ubXNnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnY3VycmVudFNwZWVkJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3BlZWRTYW1wbGVyLmxhc3RTZWNvbmRLQnBzO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFJhbmdlTG9hZGVyO1xufShfbG9hZGVyLkJhc2VMb2FkZXIpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBSYW5nZUxvYWRlcjtcblxufSx7XCIuLi91dGlscy9leGNlcHRpb24uanNcIjo0MCxcIi4uL3V0aWxzL2xvZ2dlci5qc1wiOjQxLFwiLi9sb2FkZXIuanNcIjoyNCxcIi4vc3BlZWQtc2FtcGxlci5qc1wiOjI3fV0sMzI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfZXZlbnRzID0gX2RlcmVxXygnZXZlbnRzJyk7XG5cbnZhciBfZXZlbnRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V2ZW50cyk7XG5cbnZhciBfbG9nZ2VyID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nZ2VyLmpzJyk7XG5cbnZhciBfbG9nZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dlcik7XG5cbnZhciBfYnJvd3NlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2Jyb3dzZXIuanMnKTtcblxudmFyIF9icm93c2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2Jyb3dzZXIpO1xuXG52YXIgX3BsYXllckV2ZW50cyA9IF9kZXJlcV8oJy4vcGxheWVyLWV2ZW50cy5qcycpO1xuXG52YXIgX3BsYXllckV2ZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wbGF5ZXJFdmVudHMpO1xuXG52YXIgX3RyYW5zbXV4ZXIgPSBfZGVyZXFfKCcuLi9jb3JlL3RyYW5zbXV4ZXIuanMnKTtcblxudmFyIF90cmFuc211eGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RyYW5zbXV4ZXIpO1xuXG52YXIgX3RyYW5zbXV4aW5nRXZlbnRzID0gX2RlcmVxXygnLi4vY29yZS90cmFuc211eGluZy1ldmVudHMuanMnKTtcblxudmFyIF90cmFuc211eGluZ0V2ZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90cmFuc211eGluZ0V2ZW50cyk7XG5cbnZhciBfbXNlQ29udHJvbGxlciA9IF9kZXJlcV8oJy4uL2NvcmUvbXNlLWNvbnRyb2xsZXIuanMnKTtcblxudmFyIF9tc2VDb250cm9sbGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21zZUNvbnRyb2xsZXIpO1xuXG52YXIgX21zZUV2ZW50cyA9IF9kZXJlcV8oJy4uL2NvcmUvbXNlLWV2ZW50cy5qcycpO1xuXG52YXIgX21zZUV2ZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tc2VFdmVudHMpO1xuXG52YXIgX3BsYXllckVycm9ycyA9IF9kZXJlcV8oJy4vcGxheWVyLWVycm9ycy5qcycpO1xuXG52YXIgX2NvbmZpZyA9IF9kZXJlcV8oJy4uL2NvbmZpZy5qcycpO1xuXG52YXIgX2V4Y2VwdGlvbiA9IF9kZXJlcV8oJy4uL3V0aWxzL2V4Y2VwdGlvbi5qcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgRmx2UGxheWVyID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEZsdlBsYXllcihtZWRpYURhdGFTb3VyY2UsIGNvbmZpZykge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRmx2UGxheWVyKTtcblxuICAgICAgICB0aGlzLlRBRyA9ICdGbHZQbGF5ZXInO1xuICAgICAgICB0aGlzLl90eXBlID0gJ0ZsdlBsYXllcic7XG4gICAgICAgIHRoaXMuX2VtaXR0ZXIgPSBuZXcgX2V2ZW50czIuZGVmYXVsdCgpO1xuXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9ICgwLCBfY29uZmlnLmNyZWF0ZURlZmF1bHRDb25maWcpKCk7XG4gICAgICAgIGlmICgodHlwZW9mIGNvbmZpZyA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoY29uZmlnKSkgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuX2NvbmZpZywgY29uZmlnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtZWRpYURhdGFTb3VyY2UudHlwZS50b0xvd2VyQ2FzZSgpICE9PSAnZmx2Jykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uKCdGbHZQbGF5ZXIgcmVxdWlyZXMgYW4gZmx2IE1lZGlhRGF0YVNvdXJjZSBpbnB1dCEnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtZWRpYURhdGFTb3VyY2UuaXNMaXZlID09PSB0cnVlKSB7XG4gICAgICAgICAgICB0aGlzLl9jb25maWcuaXNMaXZlID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZSA9IHtcbiAgICAgICAgICAgIG9udkxvYWRlZE1ldGFkYXRhOiB0aGlzLl9vbnZMb2FkZWRNZXRhZGF0YS5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgb252U2Vla2luZzogdGhpcy5fb252U2Vla2luZy5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgb252Q2FuUGxheTogdGhpcy5fb252Q2FuUGxheS5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgb252U3RhbGxlZDogdGhpcy5fb252U3RhbGxlZC5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgb252UHJvZ3Jlc3M6IHRoaXMuX29udlByb2dyZXNzLmJpbmQodGhpcylcbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoc2VsZi5wZXJmb3JtYW5jZSAmJiBzZWxmLnBlcmZvcm1hbmNlLm5vdykge1xuICAgICAgICAgICAgdGhpcy5fbm93ID0gc2VsZi5wZXJmb3JtYW5jZS5ub3cuYmluZChzZWxmLnBlcmZvcm1hbmNlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX25vdyA9IERhdGUubm93O1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fcGVuZGluZ1NlZWtUaW1lID0gbnVsbDsgLy8gaW4gc2Vjb25kc1xuICAgICAgICB0aGlzLl9yZXF1ZXN0U2V0VGltZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9zZWVrcG9pbnRSZWNvcmQgPSBudWxsO1xuICAgICAgICB0aGlzLl9wcm9ncmVzc0NoZWNrZXIgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuX21lZGlhRGF0YVNvdXJjZSA9IG1lZGlhRGF0YVNvdXJjZTtcbiAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgdGhpcy5fbXNlY3RsID0gbnVsbDtcbiAgICAgICAgdGhpcy5fdHJhbnNtdXhlciA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5fbXNlU291cmNlT3BlbmVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2hhc1BlbmRpbmdMb2FkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3JlY2VpdmVkQ2FuUGxheSA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuX21lZGlhSW5mbyA9IG51bGw7XG4gICAgICAgIHRoaXMuX3N0YXRpc3RpY3NJbmZvID0gbnVsbDtcblxuICAgICAgICB2YXIgY2hyb21lTmVlZElEUkZpeCA9IF9icm93c2VyMi5kZWZhdWx0LmNocm9tZSAmJiAoX2Jyb3dzZXIyLmRlZmF1bHQudmVyc2lvbi5tYWpvciA8IDUwIHx8IF9icm93c2VyMi5kZWZhdWx0LnZlcnNpb24ubWFqb3IgPT09IDUwICYmIF9icm93c2VyMi5kZWZhdWx0LnZlcnNpb24uYnVpbGQgPCAyNjYxKTtcbiAgICAgICAgdGhpcy5fYWx3YXlzU2Vla0tleWZyYW1lID0gY2hyb21lTmVlZElEUkZpeCB8fCBfYnJvd3NlcjIuZGVmYXVsdC5tc2VkZ2UgfHwgX2Jyb3dzZXIyLmRlZmF1bHQubXNpZSA/IHRydWUgOiBmYWxzZTtcblxuICAgICAgICBpZiAodGhpcy5fYWx3YXlzU2Vla0tleWZyYW1lKSB7XG4gICAgICAgICAgICB0aGlzLl9jb25maWcuYWNjdXJhdGVTZWVrID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmNhbGxiYWNrU3RyZWFtVGltZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX21lZGlhU291cmNlRW5kQ2FsbGJhY2sgPSBudWxsO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhGbHZQbGF5ZXIsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9wcm9ncmVzc0NoZWNrZXIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuX3Byb2dyZXNzQ2hlY2tlcik7XG4gICAgICAgICAgICAgICAgdGhpcy5fcHJvZ3Jlc3NDaGVja2VyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl90cmFuc211eGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy51bmxvYWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRldGFjaE1lZGlhRWxlbWVudCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5lID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhRGF0YVNvdXJjZSA9IG51bGw7XG5cbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyID0gbnVsbDtcblxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja1N0cmVhbVRpbWUgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFTb3VyY2VFbmRDYWxsYmFjayA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uKGV2ZW50LCBsaXN0ZW5lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgICAgICAgaWYgKGV2ZW50ID09PSBfcGxheWVyRXZlbnRzMi5kZWZhdWx0Lk1FRElBX0lORk8pIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFJbmZvICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fZW1pdHRlci5lbWl0KF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuTUVESUFfSU5GTywgX3RoaXMubWVkaWFJbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudCA9PT0gX3BsYXllckV2ZW50czIuZGVmYXVsdC5TVEFUSVNUSUNTX0lORk8pIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3RhdGlzdGljc0luZm8gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9lbWl0dGVyLmVtaXQoX3BsYXllckV2ZW50czIuZGVmYXVsdC5TVEFUSVNUSUNTX0lORk8sIF90aGlzLnN0YXRpc3RpY3NJbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5hZGRMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvZmYnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb2ZmKGV2ZW50LCBsaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5yZW1vdmVMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhdHRhY2hNZWRpYUVsZW1lbnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXR0YWNoTWVkaWFFbGVtZW50KG1lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudCA9IG1lZGlhRWxlbWVudDtcbiAgICAgICAgICAgIG1lZGlhRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWRtZXRhZGF0YScsIHRoaXMuZS5vbnZMb2FkZWRNZXRhZGF0YSk7XG4gICAgICAgICAgICAvL21lZGlhRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzZWVraW5nJywgdGhpcy5lLm9udlNlZWtpbmcpO1xuICAgICAgICAgICAgbWVkaWFFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NhbnBsYXknLCB0aGlzLmUub252Q2FuUGxheSk7XG4gICAgICAgICAgICBtZWRpYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3RhbGxlZCcsIHRoaXMuZS5vbnZTdGFsbGVkKTtcbiAgICAgICAgICAgIC8vbWVkaWFFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgdGhpcy5lLm9udlByb2dyZXNzKTtcblxuICAgICAgICAgICAgdGhpcy5fbXNlY3RsID0gbmV3IF9tc2VDb250cm9sbGVyMi5kZWZhdWx0KHRoaXMuX2NvbmZpZyk7XG5cbiAgICAgICAgICAgIHRoaXMuX21zZWN0bC5vbihfbXNlRXZlbnRzMi5kZWZhdWx0LlVQREFURV9FTkQsIHRoaXMuX29ubXNlVXBkYXRlRW5kLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgdGhpcy5fbXNlY3RsLm9uKF9tc2VFdmVudHMyLmRlZmF1bHQuQlVGRkVSX0ZVTEwsIHRoaXMuX29ubXNlQnVmZmVyRnVsbC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIHRoaXMuX21zZWN0bC5vbihfbXNlRXZlbnRzMi5kZWZhdWx0LlNPVVJDRV9PUEVOLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMyLl9tc2VTb3VyY2VPcGVuZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChfdGhpczIuX2hhc1BlbmRpbmdMb2FkKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMi5faGFzUGVuZGluZ0xvYWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLmxvYWQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX21zZWN0bC5vbihfbXNlRXZlbnRzMi5kZWZhdWx0LkVSUk9SLCBmdW5jdGlvbiAoaW5mbykge1xuICAgICAgICAgICAgICAgIF90aGlzMi5fZW1pdHRlci5lbWl0KF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuRVJST1IsIF9wbGF5ZXJFcnJvcnMuRXJyb3JUeXBlcy5NRURJQV9FUlJPUiwgX3BsYXllckVycm9ycy5FcnJvckRldGFpbHMuTUVESUFfTVNFX0VSUk9SLCBpbmZvKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fbXNlY3RsLm9uKF9tc2VFdmVudHMyLmRlZmF1bHQuU09VUkNFX0VORCwgZnVuY3Rpb24gKGluZm8pIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLl9tZWRpYVNvdXJjZUVuZENhbGxiYWNrICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLl9tZWRpYVNvdXJjZUVuZENhbGxiYWNrKGluZm8pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLl9tc2VjdGwuYXR0YWNoTWVkaWFFbGVtZW50KG1lZGlhRWxlbWVudCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nU2Vla1RpbWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIG1lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IHRoaXMuX3BlbmRpbmdTZWVrVGltZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1NlZWtUaW1lID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElFMTEgbWF5IHRocm93IEludmFsaWRTdGF0ZUVycm9yIGlmIHJlYWR5U3RhdGUgPT09IDBcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgY2FuIGRlZmVyIHNldCBjdXJyZW50VGltZSBvcGVyYXRpb24gYWZ0ZXIgbG9hZGVkbWV0YWRhdGFcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2RldGFjaE1lZGlhRWxlbWVudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXRhY2hNZWRpYUVsZW1lbnQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbXNlY3RsLmRldGFjaE1lZGlhRWxlbWVudCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdsb2FkZWRtZXRhZGF0YScsIHRoaXMuZS5vbnZMb2FkZWRNZXRhZGF0YSk7XG4gICAgICAgICAgICAgICAgLy90aGlzLl9tZWRpYUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Vla2luZycsIHRoaXMuZS5vbnZTZWVraW5nKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2FucGxheScsIHRoaXMuZS5vbnZDYW5QbGF5KTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3RhbGxlZCcsIHRoaXMuZS5vbnZTdGFsbGVkKTtcbiAgICAgICAgICAgICAgICAvL3RoaXMuX21lZGlhRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIHRoaXMuZS5vbnZQcm9ncmVzcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9tc2VjdGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tc2VjdGwuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX21zZWN0bCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2xvYWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZCgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgICAgICAgICBpZiAoIXRoaXMuX21lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbignSFRNTE1lZGlhRWxlbWVudCBtdXN0IGJlIGF0dGFjaGVkIGJlZm9yZSBsb2FkKCkhJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fdHJhbnNtdXhlcikge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbignRmx2UGxheWVyLmxvYWQoKSBoYXMgYmVlbiBjYWxsZWQsIHBsZWFzZSBjYWxsIHVubG9hZCgpIGZpcnN0IScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX2hhc1BlbmRpbmdMb2FkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5fY29uZmlnLmRlZmVyTG9hZEFmdGVyU291cmNlT3BlbiAmJiB0aGlzLl9tc2VTb3VyY2VPcGVuZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGFzUGVuZGluZ0xvYWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudC5yZWFkeVN0YXRlID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RTZXRUaW1lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAvLyBJRTExIG1heSB0aHJvdyBJbnZhbGlkU3RhdGVFcnJvciBpZiByZWFkeVN0YXRlID09PSAwXG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlciA9IG5ldyBfdHJhbnNtdXhlcjIuZGVmYXVsdCh0aGlzLl9tZWRpYURhdGFTb3VyY2UsIHRoaXMuX2NvbmZpZyk7XG5cbiAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LklOSVRfU0VHTUVOVCwgZnVuY3Rpb24gKHR5cGUsIGlzKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMzLl9tc2VjdGwuYXBwZW5kSW5pdFNlZ21lbnQoaXMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRURJQV9TRUdNRU5ULCBmdW5jdGlvbiAodHlwZSwgbXMpIHtcbiAgICAgICAgICAgICAgICBfdGhpczMuX21zZWN0bC5hcHBlbmRNZWRpYVNlZ21lbnQobXMpO1xuXG4gICAgICAgICAgICAgICAgLy8gbGF6eUxvYWQgY2hlY2tcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzLl9jb25maWcubGF6eUxvYWQgJiYgIV90aGlzMy5fY29uZmlnLmlzTGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY3VycmVudFRpbWUgPSBfdGhpczMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1zLmluZm8uZW5kRHRzID49IChjdXJyZW50VGltZSArIF90aGlzMy5fY29uZmlnLmxhenlMb2FkTWF4RHVyYXRpb24pICogMTAwMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMy5fcHJvZ3Jlc3NDaGVja2VyID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYoX3RoaXMzLlRBRywgJ01heGltdW0gYnVmZmVyaW5nIGR1cmF0aW9uIGV4Y2VlZGVkLCBzdXNwZW5kIHRyYW5zbXV4aW5nIHRhc2snKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczMuX3N1c3BlbmRUcmFuc211eGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LkxPQURJTkdfQ09NUExFVEUsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpczMuX21zZWN0bC5lbmRPZlN0cmVhbSgpO1xuICAgICAgICAgICAgICAgIF90aGlzMy5fZW1pdHRlci5lbWl0KF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuTE9BRElOR19DT01QTEVURSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlJFQ09WRVJFRF9FQVJMWV9FT0YsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpczMuX2VtaXR0ZXIuZW1pdChfcGxheWVyRXZlbnRzMi5kZWZhdWx0LlJFQ09WRVJFRF9FQVJMWV9FT0YpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5JT19FUlJPUiwgZnVuY3Rpb24gKGRldGFpbCwgaW5mbykge1xuICAgICAgICAgICAgICAgIF90aGlzMy5fZW1pdHRlci5lbWl0KF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuRVJST1IsIF9wbGF5ZXJFcnJvcnMuRXJyb3JUeXBlcy5ORVRXT1JLX0VSUk9SLCBkZXRhaWwsIGluZm8pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5ERU1VWF9FUlJPUiwgZnVuY3Rpb24gKGRldGFpbCwgaW5mbykge1xuICAgICAgICAgICAgICAgIF90aGlzMy5fZW1pdHRlci5lbWl0KF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuRVJST1IsIF9wbGF5ZXJFcnJvcnMuRXJyb3JUeXBlcy5NRURJQV9FUlJPUiwgZGV0YWlsLCB7IGNvZGU6IC0xLCBtc2c6IGluZm8gfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FRElBX0lORk8sIGZ1bmN0aW9uIChtZWRpYUluZm8pIHtcbiAgICAgICAgICAgICAgICBfdGhpczMuX21lZGlhSW5mbyA9IG1lZGlhSW5mbztcbiAgICAgICAgICAgICAgICBfdGhpczMuX2VtaXR0ZXIuZW1pdChfcGxheWVyRXZlbnRzMi5kZWZhdWx0Lk1FRElBX0lORk8sIE9iamVjdC5hc3NpZ24oe30sIG1lZGlhSW5mbykpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRVRBREFUQV9BUlJJVkVELCBmdW5jdGlvbiAobWV0YWRhdGEpIHtcbiAgICAgICAgICAgICAgICBfdGhpczMuX2VtaXR0ZXIuZW1pdChfcGxheWVyRXZlbnRzMi5kZWZhdWx0Lk1FVEFEQVRBX0FSUklWRUQsIG1ldGFkYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU0NSSVBUREFUQV9BUlJJVkVELCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIF90aGlzMy5fZW1pdHRlci5lbWl0KF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuU0NSSVBUREFUQV9BUlJJVkVELCBkYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU1RBVElTVElDU19JTkZPLCBmdW5jdGlvbiAoc3RhdEluZm8pIHtcbiAgICAgICAgICAgICAgICBfdGhpczMuX3N0YXRpc3RpY3NJbmZvID0gX3RoaXMzLl9maWxsU3RhdGlzdGljc0luZm8oc3RhdEluZm8pO1xuICAgICAgICAgICAgICAgIF90aGlzMy5fZW1pdHRlci5lbWl0KF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuU1RBVElTVElDU19JTkZPLCBPYmplY3QuYXNzaWduKHt9LCBfdGhpczMuX3N0YXRpc3RpY3NJbmZvKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlJFQ09NTUVORF9TRUVLUE9JTlQsIGZ1bmN0aW9uIChtaWxsaXNlY29uZHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMzLl9tZWRpYUVsZW1lbnQgJiYgIV90aGlzMy5fY29uZmlnLmFjY3VyYXRlU2Vlaykge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczMuX3JlcXVlc3RTZXRUaW1lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSBtaWxsaXNlY29uZHMgLyAxMDAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU1RSRUFNX1RJTUUsIGZ1bmN0aW9uICh0cykge1xuICAgICAgICAgICAgICAgIF90aGlzMy5fcmVjZWl2ZVN0cmVhbVRpbWUodHMpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIub3BlbigpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICd1bmxvYWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5sb2FkKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5wYXVzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX21zZWN0bCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX21zZWN0bC5zZWVrKDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX3RyYW5zbXV4ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlciA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3BsYXknLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGxheSgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tZWRpYUVsZW1lbnQucGxheSgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwYXVzZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5wYXVzZSgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfZmlsbFN0YXRpc3RpY3NJbmZvJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9maWxsU3RhdGlzdGljc0luZm8oc3RhdEluZm8pIHtcbiAgICAgICAgICAgIHN0YXRJbmZvLnBsYXllclR5cGUgPSB0aGlzLl90eXBlO1xuXG4gICAgICAgICAgICBpZiAoISh0aGlzLl9tZWRpYUVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MVmlkZW9FbGVtZW50KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdGF0SW5mbztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGhhc1F1YWxpdHlJbmZvID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBkZWNvZGVkID0gMDtcbiAgICAgICAgICAgIHZhciBkcm9wcGVkID0gMDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudC5nZXRWaWRlb1BsYXliYWNrUXVhbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBxdWFsaXR5ID0gdGhpcy5fbWVkaWFFbGVtZW50LmdldFZpZGVvUGxheWJhY2tRdWFsaXR5KCk7XG4gICAgICAgICAgICAgICAgZGVjb2RlZCA9IHF1YWxpdHkudG90YWxWaWRlb0ZyYW1lcztcbiAgICAgICAgICAgICAgICBkcm9wcGVkID0gcXVhbGl0eS5kcm9wcGVkVmlkZW9GcmFtZXM7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX21lZGlhRWxlbWVudC53ZWJraXREZWNvZGVkRnJhbWVDb3VudCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBkZWNvZGVkID0gdGhpcy5fbWVkaWFFbGVtZW50LndlYmtpdERlY29kZWRGcmFtZUNvdW50O1xuICAgICAgICAgICAgICAgIGRyb3BwZWQgPSB0aGlzLl9tZWRpYUVsZW1lbnQud2Via2l0RHJvcHBlZEZyYW1lQ291bnQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGhhc1F1YWxpdHlJbmZvID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChoYXNRdWFsaXR5SW5mbykge1xuICAgICAgICAgICAgICAgIHN0YXRJbmZvLmRlY29kZWRGcmFtZXMgPSBkZWNvZGVkO1xuICAgICAgICAgICAgICAgIHN0YXRJbmZvLmRyb3BwZWRGcmFtZXMgPSBkcm9wcGVkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gc3RhdEluZm87XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbm1zZVVwZGF0ZUVuZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25tc2VVcGRhdGVFbmQoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2NvbmZpZy5sYXp5TG9hZCB8fCB0aGlzLl9jb25maWcuaXNMaXZlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgYnVmZmVyZWQgPSB0aGlzLl9tZWRpYUVsZW1lbnQuYnVmZmVyZWQ7XG4gICAgICAgICAgICB2YXIgY3VycmVudFRpbWUgPSB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWU7XG4gICAgICAgICAgICB2YXIgY3VycmVudFJhbmdlU3RhcnQgPSAwO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSYW5nZUVuZCA9IDA7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnVmZmVyZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBidWZmZXJlZC5zdGFydChpKTtcbiAgICAgICAgICAgICAgICB2YXIgZW5kID0gYnVmZmVyZWQuZW5kKGkpO1xuICAgICAgICAgICAgICAgIGlmIChzdGFydCA8PSBjdXJyZW50VGltZSAmJiBjdXJyZW50VGltZSA8IGVuZCkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50UmFuZ2VTdGFydCA9IHN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50UmFuZ2VFbmQgPSBlbmQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGN1cnJlbnRSYW5nZUVuZCA+PSBjdXJyZW50VGltZSArIHRoaXMuX2NvbmZpZy5sYXp5TG9hZE1heER1cmF0aW9uICYmIHRoaXMuX3Byb2dyZXNzQ2hlY2tlciA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KHRoaXMuVEFHLCAnTWF4aW11bSBidWZmZXJpbmcgZHVyYXRpb24gZXhjZWVkZWQsIHN1c3BlbmQgdHJhbnNtdXhpbmcgdGFzaycpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3N1c3BlbmRUcmFuc211eGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbm1zZUJ1ZmZlckZ1bGwnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29ubXNlQnVmZmVyRnVsbCgpIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudih0aGlzLlRBRywgJ01TRSBTb3VyY2VCdWZmZXIgaXMgZnVsbCwgc3VzcGVuZCB0cmFuc211eGluZyB0YXNrJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5fcHJvZ3Jlc3NDaGVja2VyID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdXNwZW5kVHJhbnNtdXhlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfc3VzcGVuZFRyYW5zbXV4ZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3N1c3BlbmRUcmFuc211eGVyKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3RyYW5zbXV4ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLnBhdXNlKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcHJvZ3Jlc3NDaGVja2VyID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcHJvZ3Jlc3NDaGVja2VyID0gd2luZG93LnNldEludGVydmFsKHRoaXMuX2NoZWNrUHJvZ3Jlc3NBbmRSZXN1bWUuYmluZCh0aGlzKSwgMTAwMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfY2hlY2tQcm9ncmVzc0FuZFJlc3VtZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfY2hlY2tQcm9ncmVzc0FuZFJlc3VtZSgpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50VGltZSA9IHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZTtcbiAgICAgICAgICAgIHZhciBidWZmZXJlZCA9IHRoaXMuX21lZGlhRWxlbWVudC5idWZmZXJlZDtcblxuICAgICAgICAgICAgdmFyIG5lZWRSZXN1bWUgPSBmYWxzZTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBidWZmZXJlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBmcm9tID0gYnVmZmVyZWQuc3RhcnQoaSk7XG4gICAgICAgICAgICAgICAgdmFyIHRvID0gYnVmZmVyZWQuZW5kKGkpO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VGltZSA+PSBmcm9tICYmIGN1cnJlbnRUaW1lIDwgdG8pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRUaW1lID49IHRvIC0gdGhpcy5fY29uZmlnLmxhenlMb2FkUmVjb3ZlckR1cmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZWVkUmVzdW1lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChuZWVkUmVzdW1lKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5fcHJvZ3Jlc3NDaGVja2VyKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9ncmVzc0NoZWNrZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgIGlmIChuZWVkUmVzdW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudih0aGlzLlRBRywgJ0NvbnRpbnVlIGxvYWRpbmcgZnJvbSBwYXVzZWQgcG9zaXRpb24nKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5yZXN1bWUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19pc1RpbWVwb2ludEJ1ZmZlcmVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9pc1RpbWVwb2ludEJ1ZmZlcmVkKHNlY29uZHMpIHtcbiAgICAgICAgICAgIHZhciBidWZmZXJlZCA9IHRoaXMuX21lZGlhRWxlbWVudC5idWZmZXJlZDtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBidWZmZXJlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBmcm9tID0gYnVmZmVyZWQuc3RhcnQoaSk7XG4gICAgICAgICAgICAgICAgdmFyIHRvID0gYnVmZmVyZWQuZW5kKGkpO1xuICAgICAgICAgICAgICAgIGlmIChzZWNvbmRzID49IGZyb20gJiYgc2Vjb25kcyA8IHRvKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2ludGVybmFsU2VlaycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfaW50ZXJuYWxTZWVrKHNlY29uZHMpIHtcbiAgICAgICAgICAgIHZhciBkaXJlY3RTZWVrID0gdGhpcy5faXNUaW1lcG9pbnRCdWZmZXJlZChzZWNvbmRzKTtcblxuICAgICAgICAgICAgdmFyIGRpcmVjdFNlZWtCZWdpbiA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIGRpcmVjdFNlZWtCZWdpblRpbWUgPSAwO1xuXG4gICAgICAgICAgICBpZiAoc2Vjb25kcyA8IDEuMCAmJiB0aGlzLl9tZWRpYUVsZW1lbnQuYnVmZmVyZWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciB2aWRlb0JlZ2luVGltZSA9IHRoaXMuX21lZGlhRWxlbWVudC5idWZmZXJlZC5zdGFydCgwKTtcbiAgICAgICAgICAgICAgICBpZiAodmlkZW9CZWdpblRpbWUgPCAxLjAgJiYgc2Vjb25kcyA8IHZpZGVvQmVnaW5UaW1lIHx8IF9icm93c2VyMi5kZWZhdWx0LnNhZmFyaSkge1xuICAgICAgICAgICAgICAgICAgICBkaXJlY3RTZWVrQmVnaW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAvLyBhbHNvIHdvcmthcm91bmQgZm9yIFNhZmFyaTogU2VlayB0byAwIG1heSBjYXVzZSB2aWRlbyBzdHVjaywgdXNlIDAuMSB0byBhdm9pZFxuICAgICAgICAgICAgICAgICAgICBkaXJlY3RTZWVrQmVnaW5UaW1lID0gX2Jyb3dzZXIyLmRlZmF1bHQuc2FmYXJpID8gMC4xIDogdmlkZW9CZWdpblRpbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZGlyZWN0U2Vla0JlZ2luKSB7XG4gICAgICAgICAgICAgICAgLy8gc2VlayB0byB2aWRlbyBiZWdpbiwgc2V0IGN1cnJlbnRUaW1lIGRpcmVjdGx5IGlmIGJlZ2luUFRTIGJ1ZmZlcmVkXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdFNldFRpbWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IGRpcmVjdFNlZWtCZWdpblRpbWU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGRpcmVjdFNlZWspIHtcbiAgICAgICAgICAgICAgICAvLyBidWZmZXJlZCBwb3NpdGlvblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fYWx3YXlzU2Vla0tleWZyYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RTZXRUaW1lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gc2Vjb25kcztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaWRyID0gdGhpcy5fbXNlY3RsLmdldE5lYXJlc3RLZXlmcmFtZShNYXRoLmZsb29yKHNlY29uZHMgKiAxMDAwKSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RTZXRUaW1lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSBpZHIuZHRzIC8gMTAwMDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IHNlY29uZHM7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Byb2dyZXNzQ2hlY2tlciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrUHJvZ3Jlc3NBbmRSZXN1bWUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9wcm9ncmVzc0NoZWNrZXIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLl9wcm9ncmVzc0NoZWNrZXIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wcm9ncmVzc0NoZWNrZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9tc2VjdGwuc2VlayhzZWNvbmRzKTtcbiAgICAgICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLnNlZWsoTWF0aC5mbG9vcihzZWNvbmRzICogMTAwMCkpOyAvLyBpbiBtaWxsaXNlY29uZHNcbiAgICAgICAgICAgICAgICAvLyBubyBuZWVkIHRvIHNldCBtZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgaWYgbm9uLWFjY3VyYXRlU2VlayxcbiAgICAgICAgICAgICAgICAvLyBqdXN0IHdhaXQgZm9yIHRoZSByZWNvbW1lbmRfc2Vla3BvaW50IGNhbGxiYWNrXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2NvbmZpZy5hY2N1cmF0ZVNlZWspIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdFNldFRpbWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSBzZWNvbmRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2NoZWNrQW5kQXBwbHlVbmJ1ZmZlcmVkU2Vla3BvaW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGVja0FuZEFwcGx5VW5idWZmZXJlZFNlZWtwb2ludCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9zZWVrcG9pbnRSZWNvcmQpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc2Vla3BvaW50UmVjb3JkLnJlY29yZFRpbWUgPD0gdGhpcy5fbm93KCkgLSAxMDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2Vla3BvaW50UmVjb3JkID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9pc1RpbWVwb2ludEJ1ZmZlcmVkKHRhcmdldCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9wcm9ncmVzc0NoZWNrZXIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5fcHJvZ3Jlc3NDaGVja2VyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wcm9ncmVzc0NoZWNrZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gLmN1cnJlbnRUaW1lIGlzIGNvbnNpc3RzIHdpdGggLmJ1ZmZlcmVkIHRpbWVzdGFtcFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hyb21lL0VkZ2UgdXNlIERUUywgd2hpbGUgRmlyZUZveC9TYWZhcmkgdXNlIFBUU1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbXNlY3RsLnNlZWsodGFyZ2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIuc2VlayhNYXRoLmZsb29yKHRhcmdldCAqIDEwMDApKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBjdXJyZW50VGltZSBpZiBhY2N1cmF0ZVNlZWssIG9yIHdhaXQgZm9yIHJlY29tbWVuZF9zZWVrcG9pbnQgY2FsbGJhY2tcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9jb25maWcuYWNjdXJhdGVTZWVrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdFNldFRpbWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IHRhcmdldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KHRoaXMuX2NoZWNrQW5kQXBwbHlVbmJ1ZmZlcmVkU2Vla3BvaW50LmJpbmQodGhpcyksIDUwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19jaGVja0FuZFJlc3VtZVN0dWNrUGxheWJhY2snLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2NoZWNrQW5kUmVzdW1lU3R1Y2tQbGF5YmFjayhzdGFsbGVkKSB7XG4gICAgICAgICAgICB2YXIgbWVkaWEgPSB0aGlzLl9tZWRpYUVsZW1lbnQ7XG4gICAgICAgICAgICBpZiAoc3RhbGxlZCB8fCAhdGhpcy5fcmVjZWl2ZWRDYW5QbGF5IHx8IG1lZGlhLnJlYWR5U3RhdGUgPCAyKSB7XG4gICAgICAgICAgICAgICAgLy8gSEFWRV9DVVJSRU5UX0RBVEFcbiAgICAgICAgICAgICAgICB2YXIgYnVmZmVyZWQgPSBtZWRpYS5idWZmZXJlZDtcbiAgICAgICAgICAgICAgICBpZiAoYnVmZmVyZWQubGVuZ3RoID4gMCAmJiBtZWRpYS5jdXJyZW50VGltZSA8IGJ1ZmZlcmVkLnN0YXJ0KDApKSB7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ1BsYXliYWNrIHNlZW1zIHN0dWNrIGF0ICcgKyBtZWRpYS5jdXJyZW50VGltZSArICcsIHNlZWsgdG8gJyArIGJ1ZmZlcmVkLnN0YXJ0KDApKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdFNldFRpbWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSBidWZmZXJlZC5zdGFydCgwKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgdGhpcy5lLm9udlByb2dyZXNzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFBsYXliYWNrIGRpZG4ndCBzdHVjaywgcmVtb3ZlIHByb2dyZXNzIGV2ZW50IGxpc3RlbmVyXG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgdGhpcy5lLm9udlByb2dyZXNzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29udkxvYWRlZE1ldGFkYXRhJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbnZMb2FkZWRNZXRhZGF0YShlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fcGVuZGluZ1NlZWtUaW1lICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSB0aGlzLl9wZW5kaW5nU2Vla1RpbWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1NlZWtUaW1lID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29udlNlZWtpbmcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29udlNlZWtpbmcoZSkge1xuICAgICAgICAgICAgLy8gaGFuZGxlIHNlZWtpbmcgcmVxdWVzdCBmcm9tIGJyb3dzZXIncyBwcm9ncmVzcyBiYXJcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWU7XG4gICAgICAgICAgICB2YXIgYnVmZmVyZWQgPSB0aGlzLl9tZWRpYUVsZW1lbnQuYnVmZmVyZWQ7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9yZXF1ZXN0U2V0VGltZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RTZXRUaW1lID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGFyZ2V0IDwgMS4wICYmIGJ1ZmZlcmVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAvLyBzZWVrIHRvIHZpZGVvIGJlZ2luLCBzZXQgY3VycmVudFRpbWUgZGlyZWN0bHkgaWYgYmVnaW5QVFMgYnVmZmVyZWRcbiAgICAgICAgICAgICAgICB2YXIgdmlkZW9CZWdpblRpbWUgPSBidWZmZXJlZC5zdGFydCgwKTtcbiAgICAgICAgICAgICAgICBpZiAodmlkZW9CZWdpblRpbWUgPCAxLjAgJiYgdGFyZ2V0IDwgdmlkZW9CZWdpblRpbWUgfHwgX2Jyb3dzZXIyLmRlZmF1bHQuc2FmYXJpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RTZXRUaW1lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgLy8gYWxzbyB3b3JrYXJvdW5kIGZvciBTYWZhcmk6IFNlZWsgdG8gMCBtYXkgY2F1c2UgdmlkZW8gc3R1Y2ssIHVzZSAwLjEgdG8gYXZvaWRcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gX2Jyb3dzZXIyLmRlZmF1bHQuc2FmYXJpID8gMC4xIDogdmlkZW9CZWdpblRpbWU7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1RpbWVwb2ludEJ1ZmZlcmVkKHRhcmdldCkpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYWx3YXlzU2Vla0tleWZyYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpZHIgPSB0aGlzLl9tc2VjdGwuZ2V0TmVhcmVzdEtleWZyYW1lKE1hdGguZmxvb3IodGFyZ2V0ICogMTAwMCkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWRyICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RTZXRUaW1lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IGlkci5kdHMgLyAxMDAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9wcm9ncmVzc0NoZWNrZXIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jaGVja1Byb2dyZXNzQW5kUmVzdW1lKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fc2Vla3BvaW50UmVjb3JkID0ge1xuICAgICAgICAgICAgICAgIHNlZWtQb2ludDogdGFyZ2V0LFxuICAgICAgICAgICAgICAgIHJlY29yZFRpbWU6IHRoaXMuX25vdygpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQodGhpcy5fY2hlY2tBbmRBcHBseVVuYnVmZmVyZWRTZWVrcG9pbnQuYmluZCh0aGlzKSwgNTApO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb252Q2FuUGxheScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb252Q2FuUGxheShlKSB7XG4gICAgICAgICAgICB0aGlzLl9yZWNlaXZlZENhblBsYXkgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NhbnBsYXknLCB0aGlzLmUub252Q2FuUGxheSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbnZTdGFsbGVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbnZTdGFsbGVkKGUpIHtcbiAgICAgICAgICAgIHRoaXMuX2NoZWNrQW5kUmVzdW1lU3R1Y2tQbGF5YmFjayh0cnVlKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29udlByb2dyZXNzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbnZQcm9ncmVzcyhlKSB7XG4gICAgICAgICAgICB0aGlzLl9jaGVja0FuZFJlc3VtZVN0dWNrUGxheWJhY2soKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc2V0TWVkaWFTb3VyY2VFbmRDYWxsYmFjaycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRNZWRpYVNvdXJjZUVuZENhbGxiYWNrKGNhbGwpIHtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhU291cmNlRW5kQ2FsbGJhY2sgPSBjYWxsO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzZXRTdHJlYW1UaW1lQ2FsbGJhY2snLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0U3RyZWFtVGltZUNhbGxiYWNrKGNhbGwpIHtcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tTdHJlYW1UaW1lID0gY2FsbDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3JlY2VpdmVTdHJlYW1UaW1lJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9yZWNlaXZlU3RyZWFtVGltZSh0cykge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tTdHJlYW1UaW1lICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNhbGxiYWNrU3RyZWFtVGltZSh0cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3R5cGUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90eXBlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdidWZmZXJlZCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21lZGlhRWxlbWVudC5idWZmZXJlZDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZHVyYXRpb24nLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tZWRpYUVsZW1lbnQuZHVyYXRpb247XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3ZvbHVtZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21lZGlhRWxlbWVudC52b2x1bWU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQudm9sdW1lID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ211dGVkJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWVkaWFFbGVtZW50Lm11dGVkO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChtdXRlZCkge1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50Lm11dGVkID0gbXV0ZWQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2N1cnJlbnRUaW1lJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChzZWNvbmRzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faW50ZXJuYWxTZWVrKHNlY29uZHMpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nU2Vla1RpbWUgPSBzZWNvbmRzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdtZWRpYUluZm8nLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCB0aGlzLl9tZWRpYUluZm8pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzdGF0aXN0aWNzSW5mbycsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXRpc3RpY3NJbmZvID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0aXN0aWNzSW5mbyA9IHt9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fc3RhdGlzdGljc0luZm8gPSB0aGlzLl9maWxsU3RhdGlzdGljc0luZm8odGhpcy5fc3RhdGlzdGljc0luZm8pO1xuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHRoaXMuX3N0YXRpc3RpY3NJbmZvKTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBGbHZQbGF5ZXI7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEZsdlBsYXllcjtcblxufSx7XCIuLi9jb25maWcuanNcIjo1LFwiLi4vY29yZS9tc2UtY29udHJvbGxlci5qc1wiOjksXCIuLi9jb3JlL21zZS1ldmVudHMuanNcIjoxMCxcIi4uL2NvcmUvdHJhbnNtdXhlci5qc1wiOjExLFwiLi4vY29yZS90cmFuc211eGluZy1ldmVudHMuanNcIjoxMyxcIi4uL3V0aWxzL2Jyb3dzZXIuanNcIjozOSxcIi4uL3V0aWxzL2V4Y2VwdGlvbi5qc1wiOjQwLFwiLi4vdXRpbHMvbG9nZ2VyLmpzXCI6NDEsXCIuL3BsYXllci1lcnJvcnMuanNcIjozNCxcIi4vcGxheWVyLWV2ZW50cy5qc1wiOjM1LFwiZXZlbnRzXCI6Mn1dLDMzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgX2V2ZW50cyA9IF9kZXJlcV8oJ2V2ZW50cycpO1xuXG52YXIgX2V2ZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ldmVudHMpO1xuXG52YXIgX3BsYXllckV2ZW50cyA9IF9kZXJlcV8oJy4vcGxheWVyLWV2ZW50cy5qcycpO1xuXG52YXIgX3BsYXllckV2ZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wbGF5ZXJFdmVudHMpO1xuXG52YXIgX2NvbmZpZyA9IF9kZXJlcV8oJy4uL2NvbmZpZy5qcycpO1xuXG52YXIgX2V4Y2VwdGlvbiA9IF9kZXJlcV8oJy4uL3V0aWxzL2V4Y2VwdGlvbi5qcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vLyBQbGF5ZXIgd3JhcHBlciBmb3IgYnJvd3NlcidzIG5hdGl2ZSBwbGF5ZXIgKEhUTUxWaWRlb0VsZW1lbnQpIHdpdGhvdXQgTWVkaWFTb3VyY2Ugc3JjLiBcbnZhciBOYXRpdmVQbGF5ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTmF0aXZlUGxheWVyKG1lZGlhRGF0YVNvdXJjZSwgY29uZmlnKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBOYXRpdmVQbGF5ZXIpO1xuXG4gICAgICAgIHRoaXMuVEFHID0gJ05hdGl2ZVBsYXllcic7XG4gICAgICAgIHRoaXMuX3R5cGUgPSAnTmF0aXZlUGxheWVyJztcbiAgICAgICAgdGhpcy5fZW1pdHRlciA9IG5ldyBfZXZlbnRzMi5kZWZhdWx0KCk7XG5cbiAgICAgICAgdGhpcy5fY29uZmlnID0gKDAsIF9jb25maWcuY3JlYXRlRGVmYXVsdENvbmZpZykoKTtcbiAgICAgICAgaWYgKCh0eXBlb2YgY29uZmlnID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihjb25maWcpKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5fY29uZmlnLCBjb25maWcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1lZGlhRGF0YVNvdXJjZS50eXBlLnRvTG93ZXJDYXNlKCkgPT09ICdmbHYnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbnZhbGlkQXJndW1lbnRFeGNlcHRpb24oJ05hdGl2ZVBsYXllciBkb2VzXFwndCBzdXBwb3J0IGZsdiBNZWRpYURhdGFTb3VyY2UgaW5wdXQhJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1lZGlhRGF0YVNvdXJjZS5oYXNPd25Qcm9wZXJ0eSgnc2VnbWVudHMnKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uKCdOYXRpdmVQbGF5ZXIoJyArIG1lZGlhRGF0YVNvdXJjZS50eXBlICsgJykgZG9lc25cXCd0IHN1cHBvcnQgbXVsdGlwYXJ0IHBsYXliYWNrIScpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5lID0ge1xuICAgICAgICAgICAgb252TG9hZGVkTWV0YWRhdGE6IHRoaXMuX29udkxvYWRlZE1ldGFkYXRhLmJpbmQodGhpcylcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLl9wZW5kaW5nU2Vla1RpbWUgPSBudWxsO1xuICAgICAgICB0aGlzLl9zdGF0aXN0aWNzUmVwb3J0ZXIgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuX21lZGlhRGF0YVNvdXJjZSA9IG1lZGlhRGF0YVNvdXJjZTtcbiAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50ID0gbnVsbDtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoTmF0aXZlUGxheWVyLCBbe1xuICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy51bmxvYWQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmRldGFjaE1lZGlhRWxlbWVudCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5lID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhRGF0YVNvdXJjZSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLnJlbW92ZUFsbExpc3RlbmVycygpO1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uKGV2ZW50LCBsaXN0ZW5lcikge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgICAgICAgaWYgKGV2ZW50ID09PSBfcGxheWVyRXZlbnRzMi5kZWZhdWx0Lk1FRElBX0lORk8pIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50ICE9IG51bGwgJiYgdGhpcy5fbWVkaWFFbGVtZW50LnJlYWR5U3RhdGUgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSEFWRV9OT1RISU5HXG4gICAgICAgICAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2VtaXR0ZXIuZW1pdChfcGxheWVyRXZlbnRzMi5kZWZhdWx0Lk1FRElBX0lORk8sIF90aGlzLm1lZGlhSW5mbyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQgPT09IF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuU1RBVElTVElDU19JTkZPKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudCAhPSBudWxsICYmIHRoaXMuX21lZGlhRWxlbWVudC5yZWFkeVN0YXRlICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2VtaXR0ZXIuZW1pdChfcGxheWVyRXZlbnRzMi5kZWZhdWx0LlNUQVRJU1RJQ1NfSU5GTywgX3RoaXMuc3RhdGlzdGljc0luZm8pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmFkZExpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29mZicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvZmYoZXZlbnQsIGxpc3RlbmVyKSB7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLnJlbW92ZUxpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2F0dGFjaE1lZGlhRWxlbWVudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhdHRhY2hNZWRpYUVsZW1lbnQobWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQgPSBtZWRpYUVsZW1lbnQ7XG4gICAgICAgICAgICBtZWRpYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbG9hZGVkbWV0YWRhdGEnLCB0aGlzLmUub252TG9hZGVkTWV0YWRhdGEpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fcGVuZGluZ1NlZWtUaW1lICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBtZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSB0aGlzLl9wZW5kaW5nU2Vla1RpbWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTZWVrVGltZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJRTExIG1heSB0aHJvdyBJbnZhbGlkU3RhdGVFcnJvciBpZiByZWFkeVN0YXRlID09PSAwXG4gICAgICAgICAgICAgICAgICAgIC8vIERlZmVyIHNldCBjdXJyZW50VGltZSBvcGVyYXRpb24gYWZ0ZXIgbG9hZGVkbWV0YWRhdGFcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2RldGFjaE1lZGlhRWxlbWVudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXRhY2hNZWRpYUVsZW1lbnQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnNyYyA9ICcnO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ3NyYycpO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdsb2FkZWRtZXRhZGF0YScsIHRoaXMuZS5vbnZMb2FkZWRNZXRhZGF0YSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGF0aXN0aWNzUmVwb3J0ZXIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuX3N0YXRpc3RpY3NSZXBvcnRlcik7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGlzdGljc1JlcG9ydGVyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbG9hZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9tZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbGxlZ2FsU3RhdGVFeGNlcHRpb24oJ0hUTUxNZWRpYUVsZW1lbnQgbXVzdCBiZSBhdHRhY2hlZCBiZWZvcmUgbG9hZCgpIScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnNyYyA9IHRoaXMuX21lZGlhRGF0YVNvdXJjZS51cmw7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQucmVhZHlTdGF0ZSA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQucHJlbG9hZCA9ICdhdXRvJztcbiAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5sb2FkKCk7XG4gICAgICAgICAgICB0aGlzLl9zdGF0aXN0aWNzUmVwb3J0ZXIgPSB3aW5kb3cuc2V0SW50ZXJ2YWwodGhpcy5fcmVwb3J0U3RhdGlzdGljc0luZm8uYmluZCh0aGlzKSwgdGhpcy5fY29uZmlnLnN0YXRpc3RpY3NJbmZvUmVwb3J0SW50ZXJ2YWwpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICd1bmxvYWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdW5sb2FkKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5zcmMgPSAnJztcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdzcmMnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGF0aXN0aWNzUmVwb3J0ZXIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuX3N0YXRpc3RpY3NSZXBvcnRlcik7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGlzdGljc1JlcG9ydGVyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncGxheScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwbGF5KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21lZGlhRWxlbWVudC5wbGF5KCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3BhdXNlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnBhdXNlKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbnZMb2FkZWRNZXRhZGF0YScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb252TG9hZGVkTWV0YWRhdGEoZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3BlbmRpbmdTZWVrVGltZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gdGhpcy5fcGVuZGluZ1NlZWtUaW1lO1xuICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTZWVrVGltZSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX3BsYXllckV2ZW50czIuZGVmYXVsdC5NRURJQV9JTkZPLCB0aGlzLm1lZGlhSW5mbyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19yZXBvcnRTdGF0aXN0aWNzSW5mbycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVwb3J0U3RhdGlzdGljc0luZm8oKSB7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX3BsYXllckV2ZW50czIuZGVmYXVsdC5TVEFUSVNUSUNTX0lORk8sIHRoaXMuc3RhdGlzdGljc0luZm8pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICd0eXBlJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdHlwZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYnVmZmVyZWQnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tZWRpYUVsZW1lbnQuYnVmZmVyZWQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2R1cmF0aW9uJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWVkaWFFbGVtZW50LmR1cmF0aW9uO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICd2b2x1bWUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tZWRpYUVsZW1lbnQudm9sdW1lO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnZvbHVtZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdtdXRlZCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21lZGlhRWxlbWVudC5tdXRlZDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQobXV0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5tdXRlZCA9IG11dGVkO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdjdXJyZW50VGltZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoc2Vjb25kcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IHNlY29uZHM7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTZWVrVGltZSA9IHNlY29uZHM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ21lZGlhSW5mbycsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgdmFyIG1lZGlhUHJlZml4ID0gdGhpcy5fbWVkaWFFbGVtZW50IGluc3RhbmNlb2YgSFRNTEF1ZGlvRWxlbWVudCA/ICdhdWRpby8nIDogJ3ZpZGVvLyc7XG4gICAgICAgICAgICB2YXIgaW5mbyA9IHtcbiAgICAgICAgICAgICAgICBtaW1lVHlwZTogbWVkaWFQcmVmaXggKyB0aGlzLl9tZWRpYURhdGFTb3VyY2UudHlwZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpbmZvLmR1cmF0aW9uID0gTWF0aC5mbG9vcih0aGlzLl9tZWRpYUVsZW1lbnQuZHVyYXRpb24gKiAxMDAwKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50IGluc3RhbmNlb2YgSFRNTFZpZGVvRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICBpbmZvLndpZHRoID0gdGhpcy5fbWVkaWFFbGVtZW50LnZpZGVvV2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIGluZm8uaGVpZ2h0ID0gdGhpcy5fbWVkaWFFbGVtZW50LnZpZGVvSGVpZ2h0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpbmZvO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzdGF0aXN0aWNzSW5mbycsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgdmFyIGluZm8gPSB7XG4gICAgICAgICAgICAgICAgcGxheWVyVHlwZTogdGhpcy5fdHlwZSxcbiAgICAgICAgICAgICAgICB1cmw6IHRoaXMuX21lZGlhRGF0YVNvdXJjZS51cmxcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmICghKHRoaXMuX21lZGlhRWxlbWVudCBpbnN0YW5jZW9mIEhUTUxWaWRlb0VsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGluZm87XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBoYXNRdWFsaXR5SW5mbyA9IHRydWU7XG4gICAgICAgICAgICB2YXIgZGVjb2RlZCA9IDA7XG4gICAgICAgICAgICB2YXIgZHJvcHBlZCA9IDA7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQuZ2V0VmlkZW9QbGF5YmFja1F1YWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgcXVhbGl0eSA9IHRoaXMuX21lZGlhRWxlbWVudC5nZXRWaWRlb1BsYXliYWNrUXVhbGl0eSgpO1xuICAgICAgICAgICAgICAgIGRlY29kZWQgPSBxdWFsaXR5LnRvdGFsVmlkZW9GcmFtZXM7XG4gICAgICAgICAgICAgICAgZHJvcHBlZCA9IHF1YWxpdHkuZHJvcHBlZFZpZGVvRnJhbWVzO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQud2Via2l0RGVjb2RlZEZyYW1lQ291bnQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgZGVjb2RlZCA9IHRoaXMuX21lZGlhRWxlbWVudC53ZWJraXREZWNvZGVkRnJhbWVDb3VudDtcbiAgICAgICAgICAgICAgICBkcm9wcGVkID0gdGhpcy5fbWVkaWFFbGVtZW50LndlYmtpdERyb3BwZWRGcmFtZUNvdW50O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBoYXNRdWFsaXR5SW5mbyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaGFzUXVhbGl0eUluZm8pIHtcbiAgICAgICAgICAgICAgICBpbmZvLmRlY29kZWRGcmFtZXMgPSBkZWNvZGVkO1xuICAgICAgICAgICAgICAgIGluZm8uZHJvcHBlZEZyYW1lcyA9IGRyb3BwZWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBpbmZvO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIE5hdGl2ZVBsYXllcjtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gTmF0aXZlUGxheWVyO1xuXG59LHtcIi4uL2NvbmZpZy5qc1wiOjUsXCIuLi91dGlscy9leGNlcHRpb24uanNcIjo0MCxcIi4vcGxheWVyLWV2ZW50cy5qc1wiOjM1LFwiZXZlbnRzXCI6Mn1dLDM0OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5FcnJvckRldGFpbHMgPSBleHBvcnRzLkVycm9yVHlwZXMgPSB1bmRlZmluZWQ7XG5cbnZhciBfbG9hZGVyID0gX2RlcmVxXygnLi4vaW8vbG9hZGVyLmpzJyk7XG5cbnZhciBfZGVtdXhFcnJvcnMgPSBfZGVyZXFfKCcuLi9kZW11eC9kZW11eC1lcnJvcnMuanMnKTtcblxudmFyIF9kZW11eEVycm9yczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kZW11eEVycm9ycyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbnZhciBFcnJvclR5cGVzID0gZXhwb3J0cy5FcnJvclR5cGVzID0ge1xuICAgIE5FVFdPUktfRVJST1I6ICdOZXR3b3JrRXJyb3InLFxuICAgIE1FRElBX0VSUk9SOiAnTWVkaWFFcnJvcicsXG4gICAgT1RIRVJfRVJST1I6ICdPdGhlckVycm9yJ1xufTtcblxudmFyIEVycm9yRGV0YWlscyA9IGV4cG9ydHMuRXJyb3JEZXRhaWxzID0ge1xuICAgIE5FVFdPUktfRVhDRVBUSU9OOiBfbG9hZGVyLkxvYWRlckVycm9ycy5FWENFUFRJT04sXG4gICAgTkVUV09SS19TVEFUVVNfQ09ERV9JTlZBTElEOiBfbG9hZGVyLkxvYWRlckVycm9ycy5IVFRQX1NUQVRVU19DT0RFX0lOVkFMSUQsXG4gICAgTkVUV09SS19USU1FT1VUOiBfbG9hZGVyLkxvYWRlckVycm9ycy5DT05ORUNUSU5HX1RJTUVPVVQsXG4gICAgTkVUV09SS19VTlJFQ09WRVJBQkxFX0VBUkxZX0VPRjogX2xvYWRlci5Mb2FkZXJFcnJvcnMuVU5SRUNPVkVSQUJMRV9FQVJMWV9FT0YsXG5cbiAgICBNRURJQV9NU0VfRVJST1I6ICdNZWRpYU1TRUVycm9yJyxcblxuICAgIE1FRElBX0ZPUk1BVF9FUlJPUjogX2RlbXV4RXJyb3JzMi5kZWZhdWx0LkZPUk1BVF9FUlJPUixcbiAgICBNRURJQV9GT1JNQVRfVU5TVVBQT1JURUQ6IF9kZW11eEVycm9yczIuZGVmYXVsdC5GT1JNQVRfVU5TVVBQT1JURUQsXG4gICAgTUVESUFfQ09ERUNfVU5TVVBQT1JURUQ6IF9kZW11eEVycm9yczIuZGVmYXVsdC5DT0RFQ19VTlNVUFBPUlRFRFxufTtcblxufSx7XCIuLi9kZW11eC9kZW11eC1lcnJvcnMuanNcIjoxNixcIi4uL2lvL2xvYWRlci5qc1wiOjI0fV0sMzU6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxudmFyIFBsYXllckV2ZW50cyA9IHtcbiAgRVJST1I6ICdlcnJvcicsXG4gIExPQURJTkdfQ09NUExFVEU6ICdsb2FkaW5nX2NvbXBsZXRlJyxcbiAgUkVDT1ZFUkVEX0VBUkxZX0VPRjogJ3JlY292ZXJlZF9lYXJseV9lb2YnLFxuICBNRURJQV9JTkZPOiAnbWVkaWFfaW5mbycsXG4gIE1FVEFEQVRBX0FSUklWRUQ6ICdtZXRhZGF0YV9hcnJpdmVkJyxcbiAgU0NSSVBUREFUQV9BUlJJVkVEOiAnc2NyaXB0ZGF0YV9hcnJpdmVkJyxcbiAgU1RBVElTVElDU19JTkZPOiAnc3RhdGlzdGljc19pbmZvJ1xufTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gUGxheWVyRXZlbnRzO1xuXG59LHt9XSwzNjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBUaGlzIGZpbGUgaXMgbW9kaWZpZWQgZnJvbSBkYWlseW1vdGlvbidzIGhscy5qcyBsaWJyYXJ5IChobHMuanMvc3JjL2hlbHBlci9hYWMuanMpXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG52YXIgQUFDID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEFBQygpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFBQyk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKEFBQywgbnVsbCwgW3tcbiAgICAgICAga2V5OiAnZ2V0U2lsZW50RnJhbWUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U2lsZW50RnJhbWUoY29kZWMsIGNoYW5uZWxDb3VudCkge1xuICAgICAgICAgICAgaWYgKGNvZGVjID09PSAnbXA0YS40MC4yJykge1xuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBMQy1BQUNcbiAgICAgICAgICAgICAgICBpZiAoY2hhbm5lbENvdW50ID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShbMHgwMCwgMHhjOCwgMHgwMCwgMHg4MCwgMHgyMywgMHg4MF0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hhbm5lbENvdW50ID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShbMHgyMSwgMHgwMCwgMHg0OSwgMHg5MCwgMHgwMiwgMHgxOSwgMHgwMCwgMHgyMywgMHg4MF0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hhbm5lbENvdW50ID09PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShbMHgwMCwgMHhjOCwgMHgwMCwgMHg4MCwgMHgyMCwgMHg4NCwgMHgwMSwgMHgyNiwgMHg0MCwgMHgwOCwgMHg2NCwgMHgwMCwgMHg4ZV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hhbm5lbENvdW50ID09PSA0KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShbMHgwMCwgMHhjOCwgMHgwMCwgMHg4MCwgMHgyMCwgMHg4NCwgMHgwMSwgMHgyNiwgMHg0MCwgMHgwOCwgMHg2NCwgMHgwMCwgMHg4MCwgMHgyYywgMHg4MCwgMHgwOCwgMHgwMiwgMHgzOF0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hhbm5lbENvdW50ID09PSA1KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShbMHgwMCwgMHhjOCwgMHgwMCwgMHg4MCwgMHgyMCwgMHg4NCwgMHgwMSwgMHgyNiwgMHg0MCwgMHgwOCwgMHg2NCwgMHgwMCwgMHg4MiwgMHgzMCwgMHgwNCwgMHg5OSwgMHgwMCwgMHgyMSwgMHg5MCwgMHgwMiwgMHgzOF0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hhbm5lbENvdW50ID09PSA2KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShbMHgwMCwgMHhjOCwgMHgwMCwgMHg4MCwgMHgyMCwgMHg4NCwgMHgwMSwgMHgyNiwgMHg0MCwgMHgwOCwgMHg2NCwgMHgwMCwgMHg4MiwgMHgzMCwgMHgwNCwgMHg5OSwgMHgwMCwgMHgyMSwgMHg5MCwgMHgwMiwgMHgwMCwgMHhiMiwgMHgwMCwgMHgyMCwgMHgwOCwgMHhlMF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIEhFLUFBQyAobXA0YS40MC41IC8gbXA0YS40MC4yOSlcbiAgICAgICAgICAgICAgICBpZiAoY2hhbm5lbENvdW50ID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGZmbXBlZyAteSAtZiBsYXZmaSAtaSBcImFldmFsc3JjPTA6ZD0wLjA1XCIgLWM6YSBsaWJmZGtfYWFjIC1wcm9maWxlOmEgYWFjX2hlIC1iOmEgNGsgb3V0cHV0LmFhYyAmJiBoZXhkdW1wIC12IC1lICcxNi8xIFwiMHgleCxcIiBcIlxcblwiJyAtdiBvdXRwdXQuYWFjXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShbMHgxLCAweDQwLCAweDIyLCAweDgwLCAweGEzLCAweDRlLCAweGU2LCAweDgwLCAweGJhLCAweDgsIDB4MCwgMHgwLCAweDAsIDB4MWMsIDB4NiwgMHhmMSwgMHhjMSwgMHhhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVlXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFubmVsQ291bnQgPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZmZtcGVnIC15IC1mIGxhdmZpIC1pIFwiYWV2YWxzcmM9MHwwOmQ9MC4wNVwiIC1jOmEgbGliZmRrX2FhYyAtcHJvZmlsZTphIGFhY19oZV92MiAtYjphIDRrIG91dHB1dC5hYWMgJiYgaGV4ZHVtcCAtdiAtZSAnMTYvMSBcIjB4JXgsXCIgXCJcXG5cIicgLXYgb3V0cHV0LmFhY1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzB4MSwgMHg0MCwgMHgyMiwgMHg4MCwgMHhhMywgMHg1ZSwgMHhlNiwgMHg4MCwgMHhiYSwgMHg4LCAweDAsIDB4MCwgMHgwLCAweDAsIDB4OTUsIDB4MCwgMHg2LCAweGYxLCAweGExLCAweGEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWVdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5uZWxDb3VudCA9PT0gMykge1xuICAgICAgICAgICAgICAgICAgICAvLyBmZm1wZWcgLXkgLWYgbGF2ZmkgLWkgXCJhZXZhbHNyYz0wfDB8MDpkPTAuMDVcIiAtYzphIGxpYmZka19hYWMgLXByb2ZpbGU6YSBhYWNfaGVfdjIgLWI6YSA0ayBvdXRwdXQuYWFjICYmIGhleGR1bXAgLXYgLWUgJzE2LzEgXCIweCV4LFwiIFwiXFxuXCInIC12IG91dHB1dC5hYWNcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KFsweDEsIDB4NDAsIDB4MjIsIDB4ODAsIDB4YTMsIDB4NWUsIDB4ZTYsIDB4ODAsIDB4YmEsIDB4OCwgMHgwLCAweDAsIDB4MCwgMHgwLCAweDk1LCAweDAsIDB4NiwgMHhmMSwgMHhhMSwgMHhhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVlXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gQUFDO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBBQUM7XG5cbn0se31dLDM3OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIFRoaXMgZmlsZSBpcyBkZXJpdmVkIGZyb20gZGFpbHltb3Rpb24ncyBobHMuanMgbGlicmFyeSAoaGxzLmpzL3NyYy9yZW11eC9tcDQtZ2VuZXJhdG9yLmpzKVxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxuLy8gIE1QNCBib3hlcyBnZW5lcmF0b3IgZm9yIElTTyBCTUZGIChJU08gQmFzZSBNZWRpYSBGaWxlIEZvcm1hdCwgZGVmaW5lZCBpbiBJU08vSUVDIDE0NDk2LTEyKVxudmFyIE1QNCA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBNUDQoKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNUDQpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhNUDQsIG51bGwsIFt7XG4gICAgICAgIGtleTogJ2luaXQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgICAgIE1QNC50eXBlcyA9IHtcbiAgICAgICAgICAgICAgICBhdmMxOiBbXSwgYXZjQzogW10sIGJ0cnQ6IFtdLCBkaW5mOiBbXSxcbiAgICAgICAgICAgICAgICBkcmVmOiBbXSwgZXNkczogW10sIGZ0eXA6IFtdLCBoZGxyOiBbXSxcbiAgICAgICAgICAgICAgICBtZGF0OiBbXSwgbWRoZDogW10sIG1kaWE6IFtdLCBtZmhkOiBbXSxcbiAgICAgICAgICAgICAgICBtaW5mOiBbXSwgbW9vZjogW10sIG1vb3Y6IFtdLCBtcDRhOiBbXSxcbiAgICAgICAgICAgICAgICBtdmV4OiBbXSwgbXZoZDogW10sIHNkdHA6IFtdLCBzdGJsOiBbXSxcbiAgICAgICAgICAgICAgICBzdGNvOiBbXSwgc3RzYzogW10sIHN0c2Q6IFtdLCBzdHN6OiBbXSxcbiAgICAgICAgICAgICAgICBzdHRzOiBbXSwgdGZkdDogW10sIHRmaGQ6IFtdLCB0cmFmOiBbXSxcbiAgICAgICAgICAgICAgICB0cmFrOiBbXSwgdHJ1bjogW10sIHRyZXg6IFtdLCB0a2hkOiBbXSxcbiAgICAgICAgICAgICAgICB2bWhkOiBbXSwgc21oZDogW10sICcubXAzJzogW11cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZvciAodmFyIG5hbWUgaW4gTVA0LnR5cGVzKSB7XG4gICAgICAgICAgICAgICAgaWYgKE1QNC50eXBlcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBNUDQudHlwZXNbbmFtZV0gPSBbbmFtZS5jaGFyQ29kZUF0KDApLCBuYW1lLmNoYXJDb2RlQXQoMSksIG5hbWUuY2hhckNvZGVBdCgyKSwgbmFtZS5jaGFyQ29kZUF0KDMpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBjb25zdGFudHMgPSBNUDQuY29uc3RhbnRzID0ge307XG5cbiAgICAgICAgICAgIGNvbnN0YW50cy5GVFlQID0gbmV3IFVpbnQ4QXJyYXkoWzB4NjksIDB4NzMsIDB4NkYsIDB4NkQsIC8vIG1ham9yX2JyYW5kOiBpc29tXG4gICAgICAgICAgICAweDAsIDB4MCwgMHgwLCAweDEsIC8vIG1pbm9yX3ZlcnNpb246IDB4MDFcbiAgICAgICAgICAgIDB4NjksIDB4NzMsIDB4NkYsIDB4NkQsIC8vIGlzb21cbiAgICAgICAgICAgIDB4NjEsIDB4NzYsIDB4NjMsIDB4MzEgLy8gYXZjMVxuICAgICAgICAgICAgXSk7XG5cbiAgICAgICAgICAgIGNvbnN0YW50cy5TVFNEX1BSRUZJWCA9IG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyB2ZXJzaW9uKDApICsgZmxhZ3NcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDEgLy8gZW50cnlfY291bnRcbiAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICBjb25zdGFudHMuU1RUUyA9IG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyB2ZXJzaW9uKDApICsgZmxhZ3NcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAgLy8gZW50cnlfY291bnRcbiAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICBjb25zdGFudHMuU1RTQyA9IGNvbnN0YW50cy5TVENPID0gY29uc3RhbnRzLlNUVFM7XG5cbiAgICAgICAgICAgIGNvbnN0YW50cy5TVFNaID0gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHZlcnNpb24oMCkgKyBmbGFnc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gc2FtcGxlX3NpemVcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAgLy8gc2FtcGxlX2NvdW50XG4gICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgY29uc3RhbnRzLkhETFJfVklERU8gPSBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gdmVyc2lvbigwKSArIGZsYWdzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBwcmVfZGVmaW5lZFxuICAgICAgICAgICAgMHg3NiwgMHg2OSwgMHg2NCwgMHg2NSwgLy8gaGFuZGxlcl90eXBlOiAndmlkZSdcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHJlc2VydmVkOiAzICogNCBieXRlc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHg1NiwgMHg2OSwgMHg2NCwgMHg2NSwgMHg2RiwgMHg0OCwgMHg2MSwgMHg2RSwgMHg2NCwgMHg2QywgMHg2NSwgMHg3MiwgMHgwMCAvLyBuYW1lOiBWaWRlb0hhbmRsZXJcbiAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICBjb25zdGFudHMuSERMUl9BVURJTyA9IG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyB2ZXJzaW9uKDApICsgZmxhZ3NcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHByZV9kZWZpbmVkXG4gICAgICAgICAgICAweDczLCAweDZGLCAweDc1LCAweDZFLCAvLyBoYW5kbGVyX3R5cGU6ICdzb3VuJ1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcmVzZXJ2ZWQ6IDMgKiA0IGJ5dGVzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDUzLCAweDZGLCAweDc1LCAweDZFLCAweDY0LCAweDQ4LCAweDYxLCAweDZFLCAweDY0LCAweDZDLCAweDY1LCAweDcyLCAweDAwIC8vIG5hbWU6IFNvdW5kSGFuZGxlclxuICAgICAgICAgICAgXSk7XG5cbiAgICAgICAgICAgIGNvbnN0YW50cy5EUkVGID0gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHZlcnNpb24oMCkgKyBmbGFnc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMSwgLy8gZW50cnlfY291bnRcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MEMsIC8vIGVudHJ5X3NpemVcbiAgICAgICAgICAgIDB4NzUsIDB4NzIsIDB4NkMsIDB4MjAsIC8vIHR5cGUgJ3VybCAnXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAxIC8vIHZlcnNpb24oMCkgKyBmbGFnc1xuICAgICAgICAgICAgXSk7XG5cbiAgICAgICAgICAgIC8vIFNvdW5kIG1lZGlhIGhlYWRlclxuICAgICAgICAgICAgY29uc3RhbnRzLlNNSEQgPSBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gdmVyc2lvbigwKSArIGZsYWdzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwIC8vIGJhbGFuY2UoMikgKyByZXNlcnZlZCgyKVxuICAgICAgICAgICAgXSk7XG5cbiAgICAgICAgICAgIC8vIHZpZGVvIG1lZGlhIGhlYWRlclxuICAgICAgICAgICAgY29uc3RhbnRzLlZNSEQgPSBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMSwgLy8gdmVyc2lvbigwKSArIGZsYWdzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAvLyBncmFwaGljc21vZGU6IDIgYnl0ZXNcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIG9wY29sb3I6IDMgKiAyIGJ5dGVzXG4gICAgICAgICAgICAweDAwLCAweDAwXSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBHZW5lcmF0ZSBhIGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdib3gnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYm94KHR5cGUpIHtcbiAgICAgICAgICAgIHZhciBzaXplID0gODtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBudWxsO1xuICAgICAgICAgICAgdmFyIGRhdGFzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgICAgICAgICAgIHZhciBhcnJheUNvdW50ID0gZGF0YXMubGVuZ3RoO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFycmF5Q291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHNpemUgKz0gZGF0YXNbaV0uYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkoc2l6ZSk7XG4gICAgICAgICAgICByZXN1bHRbMF0gPSBzaXplID4+PiAyNCAmIDB4RkY7IC8vIHNpemVcbiAgICAgICAgICAgIHJlc3VsdFsxXSA9IHNpemUgPj4+IDE2ICYgMHhGRjtcbiAgICAgICAgICAgIHJlc3VsdFsyXSA9IHNpemUgPj4+IDggJiAweEZGO1xuICAgICAgICAgICAgcmVzdWx0WzNdID0gc2l6ZSAmIDB4RkY7XG5cbiAgICAgICAgICAgIHJlc3VsdC5zZXQodHlwZSwgNCk7IC8vIHR5cGVcblxuICAgICAgICAgICAgdmFyIG9mZnNldCA9IDg7XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgYXJyYXlDb3VudDsgX2krKykge1xuICAgICAgICAgICAgICAgIC8vIGRhdGEgYm9keVxuICAgICAgICAgICAgICAgIHJlc3VsdC5zZXQoZGF0YXNbX2ldLCBvZmZzZXQpO1xuICAgICAgICAgICAgICAgIG9mZnNldCArPSBkYXRhc1tfaV0uYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGVtaXQgZnR5cCAmIG1vb3ZcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZ2VuZXJhdGVJbml0U2VnbWVudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZW5lcmF0ZUluaXRTZWdtZW50KG1ldGEpIHtcbiAgICAgICAgICAgIHZhciBmdHlwID0gTVA0LmJveChNUDQudHlwZXMuZnR5cCwgTVA0LmNvbnN0YW50cy5GVFlQKTtcbiAgICAgICAgICAgIHZhciBtb292ID0gTVA0Lm1vb3YobWV0YSk7XG5cbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBuZXcgVWludDhBcnJheShmdHlwLmJ5dGVMZW5ndGggKyBtb292LmJ5dGVMZW5ndGgpO1xuICAgICAgICAgICAgcmVzdWx0LnNldChmdHlwLCAwKTtcbiAgICAgICAgICAgIHJlc3VsdC5zZXQobW9vdiwgZnR5cC5ieXRlTGVuZ3RoKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNb3ZpZSBtZXRhZGF0YSBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbW9vdicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb292KG1ldGEpIHtcbiAgICAgICAgICAgIHZhciBtdmhkID0gTVA0Lm12aGQobWV0YS50aW1lc2NhbGUsIG1ldGEuZHVyYXRpb24pO1xuICAgICAgICAgICAgdmFyIHRyYWsgPSBNUDQudHJhayhtZXRhKTtcbiAgICAgICAgICAgIHZhciBtdmV4ID0gTVA0Lm12ZXgobWV0YSk7XG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMubW9vdiwgbXZoZCwgdHJhaywgbXZleCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNb3ZpZSBoZWFkZXIgYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ212aGQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbXZoZCh0aW1lc2NhbGUsIGR1cmF0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMubXZoZCwgbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHZlcnNpb24oMCkgKyBmbGFnc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gY3JlYXRpb25fdGltZVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gbW9kaWZpY2F0aW9uX3RpbWVcbiAgICAgICAgICAgIHRpbWVzY2FsZSA+Pj4gMjQgJiAweEZGLCAvLyB0aW1lc2NhbGU6IDQgYnl0ZXNcbiAgICAgICAgICAgIHRpbWVzY2FsZSA+Pj4gMTYgJiAweEZGLCB0aW1lc2NhbGUgPj4+IDggJiAweEZGLCB0aW1lc2NhbGUgJiAweEZGLCBkdXJhdGlvbiA+Pj4gMjQgJiAweEZGLCAvLyBkdXJhdGlvbjogNCBieXRlc1xuICAgICAgICAgICAgZHVyYXRpb24gPj4+IDE2ICYgMHhGRiwgZHVyYXRpb24gPj4+IDggJiAweEZGLCBkdXJhdGlvbiAmIDB4RkYsIDB4MDAsIDB4MDEsIDB4MDAsIDB4MDAsIC8vIFByZWZlcnJlZCByYXRlOiAxLjBcbiAgICAgICAgICAgIDB4MDEsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIFByZWZlcnJlZFZvbHVtZSgxLjAsIDJieXRlcykgKyByZXNlcnZlZCgyYnl0ZXMpXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyByZXNlcnZlZDogNCArIDQgYnl0ZXNcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDEsIDB4MDAsIDB4MDAsIC8vIC0tLS1iZWdpbiBjb21wb3NpdGlvbiBtYXRyaXgtLS0tXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAxLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDQwLCAweDAwLCAweDAwLCAweDAwLCAvLyAtLS0tZW5kIGNvbXBvc2l0aW9uIG1hdHJpeC0tLS1cbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIC0tLS1iZWdpbiBwcmVfZGVmaW5lZCA2ICogNCBieXRlcy0tLS1cbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIC0tLS1lbmQgcHJlX2RlZmluZWQgNiAqIDQgYnl0ZXMtLS0tXG4gICAgICAgICAgICAweEZGLCAweEZGLCAweEZGLCAweEZGIC8vIG5leHRfdHJhY2tfSURcbiAgICAgICAgICAgIF0pKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRyYWNrIGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICd0cmFrJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRyYWsobWV0YSkge1xuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLnRyYWssIE1QNC50a2hkKG1ldGEpLCBNUDQubWRpYShtZXRhKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUcmFjayBoZWFkZXIgYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3RraGQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdGtoZChtZXRhKSB7XG4gICAgICAgICAgICB2YXIgdHJhY2tJZCA9IG1ldGEuaWQsXG4gICAgICAgICAgICAgICAgZHVyYXRpb24gPSBtZXRhLmR1cmF0aW9uO1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gbWV0YS5wcmVzZW50V2lkdGgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gbWV0YS5wcmVzZW50SGVpZ2h0O1xuXG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMudGtoZCwgbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDcsIC8vIHZlcnNpb24oMCkgKyBmbGFnc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gY3JlYXRpb25fdGltZVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gbW9kaWZpY2F0aW9uX3RpbWVcbiAgICAgICAgICAgIHRyYWNrSWQgPj4+IDI0ICYgMHhGRiwgLy8gdHJhY2tfSUQ6IDQgYnl0ZXNcbiAgICAgICAgICAgIHRyYWNrSWQgPj4+IDE2ICYgMHhGRiwgdHJhY2tJZCA+Pj4gOCAmIDB4RkYsIHRyYWNrSWQgJiAweEZGLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyByZXNlcnZlZDogNCBieXRlc1xuICAgICAgICAgICAgZHVyYXRpb24gPj4+IDI0ICYgMHhGRiwgLy8gZHVyYXRpb246IDQgYnl0ZXNcbiAgICAgICAgICAgIGR1cmF0aW9uID4+PiAxNiAmIDB4RkYsIGR1cmF0aW9uID4+PiA4ICYgMHhGRiwgZHVyYXRpb24gJiAweEZGLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyByZXNlcnZlZDogMiAqIDQgYnl0ZXNcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIGxheWVyKDJieXRlcykgKyBhbHRlcm5hdGVfZ3JvdXAoMmJ5dGVzKVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gdm9sdW1lKDJieXRlcykgKyByZXNlcnZlZCgyYnl0ZXMpXG4gICAgICAgICAgICAweDAwLCAweDAxLCAweDAwLCAweDAwLCAvLyAtLS0tYmVnaW4gY29tcG9zaXRpb24gbWF0cml4LS0tLVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMSwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHg0MCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gLS0tLWVuZCBjb21wb3NpdGlvbiBtYXRyaXgtLS0tXG4gICAgICAgICAgICB3aWR0aCA+Pj4gOCAmIDB4RkYsIC8vIHdpZHRoIGFuZCBoZWlnaHRcbiAgICAgICAgICAgIHdpZHRoICYgMHhGRiwgMHgwMCwgMHgwMCwgaGVpZ2h0ID4+PiA4ICYgMHhGRiwgaGVpZ2h0ICYgMHhGRiwgMHgwMCwgMHgwMF0pKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1lZGlhIEJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdtZGlhJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1kaWEobWV0YSkge1xuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLm1kaWEsIE1QNC5tZGhkKG1ldGEpLCBNUDQuaGRscihtZXRhKSwgTVA0Lm1pbmYobWV0YSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTWVkaWEgaGVhZGVyIGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdtZGhkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1kaGQobWV0YSkge1xuICAgICAgICAgICAgdmFyIHRpbWVzY2FsZSA9IG1ldGEudGltZXNjYWxlO1xuICAgICAgICAgICAgdmFyIGR1cmF0aW9uID0gbWV0YS5kdXJhdGlvbjtcbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5tZGhkLCBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gdmVyc2lvbigwKSArIGZsYWdzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBjcmVhdGlvbl90aW1lXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBtb2RpZmljYXRpb25fdGltZVxuICAgICAgICAgICAgdGltZXNjYWxlID4+PiAyNCAmIDB4RkYsIC8vIHRpbWVzY2FsZTogNCBieXRlc1xuICAgICAgICAgICAgdGltZXNjYWxlID4+PiAxNiAmIDB4RkYsIHRpbWVzY2FsZSA+Pj4gOCAmIDB4RkYsIHRpbWVzY2FsZSAmIDB4RkYsIGR1cmF0aW9uID4+PiAyNCAmIDB4RkYsIC8vIGR1cmF0aW9uOiA0IGJ5dGVzXG4gICAgICAgICAgICBkdXJhdGlvbiA+Pj4gMTYgJiAweEZGLCBkdXJhdGlvbiA+Pj4gOCAmIDB4RkYsIGR1cmF0aW9uICYgMHhGRiwgMHg1NSwgMHhDNCwgLy8gbGFuZ3VhZ2U6IHVuZCAodW5kZXRlcm1pbmVkKVxuICAgICAgICAgICAgMHgwMCwgMHgwMCAvLyBwcmVfZGVmaW5lZCA9IDBcbiAgICAgICAgICAgIF0pKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1lZGlhIGhhbmRsZXIgcmVmZXJlbmNlIGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdoZGxyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGhkbHIobWV0YSkge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBudWxsO1xuICAgICAgICAgICAgaWYgKG1ldGEudHlwZSA9PT0gJ2F1ZGlvJykge1xuICAgICAgICAgICAgICAgIGRhdGEgPSBNUDQuY29uc3RhbnRzLkhETFJfQVVESU87XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGRhdGEgPSBNUDQuY29uc3RhbnRzLkhETFJfVklERU87XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMuaGRsciwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNZWRpYSBpbmZvbWF0aW9uIGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdtaW5mJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1pbmYobWV0YSkge1xuICAgICAgICAgICAgdmFyIHhtaGQgPSBudWxsO1xuICAgICAgICAgICAgaWYgKG1ldGEudHlwZSA9PT0gJ2F1ZGlvJykge1xuICAgICAgICAgICAgICAgIHhtaGQgPSBNUDQuYm94KE1QNC50eXBlcy5zbWhkLCBNUDQuY29uc3RhbnRzLlNNSEQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB4bWhkID0gTVA0LmJveChNUDQudHlwZXMudm1oZCwgTVA0LmNvbnN0YW50cy5WTUhEKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5taW5mLCB4bWhkLCBNUDQuZGluZigpLCBNUDQuc3RibChtZXRhKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBEYXRhIGluZm9tYXRpb24gYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2RpbmYnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGluZigpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBNUDQuYm94KE1QNC50eXBlcy5kaW5mLCBNUDQuYm94KE1QNC50eXBlcy5kcmVmLCBNUDQuY29uc3RhbnRzLkRSRUYpKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTYW1wbGUgdGFibGUgYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3N0YmwnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3RibChtZXRhKSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gTVA0LmJveChNUDQudHlwZXMuc3RibCwgLy8gdHlwZTogc3RibFxuICAgICAgICAgICAgTVA0LnN0c2QobWV0YSksIC8vIFNhbXBsZSBEZXNjcmlwdGlvbiBUYWJsZVxuICAgICAgICAgICAgTVA0LmJveChNUDQudHlwZXMuc3R0cywgTVA0LmNvbnN0YW50cy5TVFRTKSwgLy8gVGltZS1Uby1TYW1wbGVcbiAgICAgICAgICAgIE1QNC5ib3goTVA0LnR5cGVzLnN0c2MsIE1QNC5jb25zdGFudHMuU1RTQyksIC8vIFNhbXBsZS1Uby1DaHVua1xuICAgICAgICAgICAgTVA0LmJveChNUDQudHlwZXMuc3RzeiwgTVA0LmNvbnN0YW50cy5TVFNaKSwgLy8gU2FtcGxlIHNpemVcbiAgICAgICAgICAgIE1QNC5ib3goTVA0LnR5cGVzLnN0Y28sIE1QNC5jb25zdGFudHMuU1RDTyAvLyBDaHVuayBvZmZzZXRcbiAgICAgICAgICAgICkpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNhbXBsZSBkZXNjcmlwdGlvbiBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc3RzZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdHNkKG1ldGEpIHtcbiAgICAgICAgICAgIGlmIChtZXRhLnR5cGUgPT09ICdhdWRpbycpIHtcbiAgICAgICAgICAgICAgICBpZiAobWV0YS5jb2RlYyA9PT0gJ21wMycpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLnN0c2QsIE1QNC5jb25zdGFudHMuU1RTRF9QUkVGSVgsIE1QNC5tcDMobWV0YSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBlbHNlOiBhYWMgLT4gbXA0YVxuICAgICAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5zdHNkLCBNUDQuY29uc3RhbnRzLlNUU0RfUFJFRklYLCBNUDQubXA0YShtZXRhKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5zdHNkLCBNUDQuY29uc3RhbnRzLlNUU0RfUFJFRklYLCBNUDQuYXZjMShtZXRhKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ21wMycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtcDMobWV0YSkge1xuICAgICAgICAgICAgdmFyIGNoYW5uZWxDb3VudCA9IG1ldGEuY2hhbm5lbENvdW50O1xuICAgICAgICAgICAgdmFyIHNhbXBsZVJhdGUgPSBtZXRhLmF1ZGlvU2FtcGxlUmF0ZTtcblxuICAgICAgICAgICAgdmFyIGRhdGEgPSBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcmVzZXJ2ZWQoNClcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDEsIC8vIHJlc2VydmVkKDIpICsgZGF0YV9yZWZlcmVuY2VfaW5kZXgoMilcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHJlc2VydmVkOiAyICogNCBieXRlc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgY2hhbm5lbENvdW50LCAvLyBjaGFubmVsQ291bnQoMilcbiAgICAgICAgICAgIDB4MDAsIDB4MTAsIC8vIHNhbXBsZVNpemUoMilcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHJlc2VydmVkKDQpXG4gICAgICAgICAgICBzYW1wbGVSYXRlID4+PiA4ICYgMHhGRiwgLy8gQXVkaW8gc2FtcGxlIHJhdGVcbiAgICAgICAgICAgIHNhbXBsZVJhdGUgJiAweEZGLCAweDAwLCAweDAwXSk7XG5cbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlc1snLm1wMyddLCBkYXRhKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbXA0YScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtcDRhKG1ldGEpIHtcbiAgICAgICAgICAgIHZhciBjaGFubmVsQ291bnQgPSBtZXRhLmNoYW5uZWxDb3VudDtcbiAgICAgICAgICAgIHZhciBzYW1wbGVSYXRlID0gbWV0YS5hdWRpb1NhbXBsZVJhdGU7XG5cbiAgICAgICAgICAgIHZhciBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHJlc2VydmVkKDQpXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAxLCAvLyByZXNlcnZlZCgyKSArIGRhdGFfcmVmZXJlbmNlX2luZGV4KDIpXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyByZXNlcnZlZDogMiAqIDQgYnl0ZXNcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIGNoYW5uZWxDb3VudCwgLy8gY2hhbm5lbENvdW50KDIpXG4gICAgICAgICAgICAweDAwLCAweDEwLCAvLyBzYW1wbGVTaXplKDIpXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyByZXNlcnZlZCg0KVxuICAgICAgICAgICAgc2FtcGxlUmF0ZSA+Pj4gOCAmIDB4RkYsIC8vIEF1ZGlvIHNhbXBsZSByYXRlXG4gICAgICAgICAgICBzYW1wbGVSYXRlICYgMHhGRiwgMHgwMCwgMHgwMF0pO1xuXG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMubXA0YSwgZGF0YSwgTVA0LmVzZHMobWV0YSkpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdlc2RzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGVzZHMobWV0YSkge1xuICAgICAgICAgICAgdmFyIGNvbmZpZyA9IG1ldGEuY29uZmlnIHx8IFtdO1xuICAgICAgICAgICAgdmFyIGNvbmZpZ1NpemUgPSBjb25maWcubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gdmVyc2lvbiAwICsgZmxhZ3NcblxuICAgICAgICAgICAgMHgwMywgLy8gZGVzY3JpcHRvcl90eXBlXG4gICAgICAgICAgICAweDE3ICsgY29uZmlnU2l6ZSwgLy8gbGVuZ3RoM1xuICAgICAgICAgICAgMHgwMCwgMHgwMSwgLy8gZXNfaWRcbiAgICAgICAgICAgIDB4MDAsIC8vIHN0cmVhbV9wcmlvcml0eVxuXG4gICAgICAgICAgICAweDA0LCAvLyBkZXNjcmlwdG9yX3R5cGVcbiAgICAgICAgICAgIDB4MEYgKyBjb25maWdTaXplLCAvLyBsZW5ndGhcbiAgICAgICAgICAgIDB4NDAsIC8vIGNvZGVjOiBtcGVnNF9hdWRpb1xuICAgICAgICAgICAgMHgxNSwgLy8gc3RyZWFtX3R5cGU6IEF1ZGlvXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAvLyBidWZmZXJfc2l6ZVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gbWF4Qml0cmF0ZVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gYXZnQml0cmF0ZVxuXG4gICAgICAgICAgICAweDA1IC8vIGRlc2NyaXB0b3JfdHlwZVxuICAgICAgICAgICAgXS5jb25jYXQoW2NvbmZpZ1NpemVdKS5jb25jYXQoY29uZmlnKS5jb25jYXQoWzB4MDYsIDB4MDEsIDB4MDIgLy8gR0FTcGVjaWZpY0NvbmZpZ1xuICAgICAgICAgICAgXSkpO1xuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLmVzZHMsIGRhdGEpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhdmMxJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGF2YzEobWV0YSkge1xuICAgICAgICAgICAgdmFyIGF2Y2MgPSBtZXRhLmF2Y2M7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSBtZXRhLmNvZGVjV2lkdGgsXG4gICAgICAgICAgICAgICAgaGVpZ2h0ID0gbWV0YS5jb2RlY0hlaWdodDtcblxuICAgICAgICAgICAgdmFyIGRhdGEgPSBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcmVzZXJ2ZWQoNClcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDEsIC8vIHJlc2VydmVkKDIpICsgZGF0YV9yZWZlcmVuY2VfaW5kZXgoMilcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHByZV9kZWZpbmVkKDIpICsgcmVzZXJ2ZWQoMilcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHByZV9kZWZpbmVkOiAzICogNCBieXRlc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgd2lkdGggPj4+IDggJiAweEZGLCAvLyB3aWR0aDogMiBieXRlc1xuICAgICAgICAgICAgd2lkdGggJiAweEZGLCBoZWlnaHQgPj4+IDggJiAweEZGLCAvLyBoZWlnaHQ6IDIgYnl0ZXNcbiAgICAgICAgICAgIGhlaWdodCAmIDB4RkYsIDB4MDAsIDB4NDgsIDB4MDAsIDB4MDAsIC8vIGhvcml6cmVzb2x1dGlvbjogNCBieXRlc1xuICAgICAgICAgICAgMHgwMCwgMHg0OCwgMHgwMCwgMHgwMCwgLy8gdmVydHJlc29sdXRpb246IDQgYnl0ZXNcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHJlc2VydmVkOiA0IGJ5dGVzXG4gICAgICAgICAgICAweDAwLCAweDAxLCAvLyBmcmFtZV9jb3VudFxuICAgICAgICAgICAgMHgwQSwgLy8gc3RybGVuXG4gICAgICAgICAgICAweDc4LCAweDcxLCAweDcxLCAweDJGLCAvLyBjb21wcmVzc29ybmFtZTogMzIgYnl0ZXNcbiAgICAgICAgICAgIDB4NjYsIDB4NkMsIDB4NzYsIDB4MkUsIDB4NkEsIDB4NzMsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MTgsIC8vIGRlcHRoXG4gICAgICAgICAgICAweEZGLCAweEZGIC8vIHByZV9kZWZpbmVkID0gLTFcbiAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLmF2YzEsIGRhdGEsIE1QNC5ib3goTVA0LnR5cGVzLmF2Y0MsIGF2Y2MpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1vdmllIEV4dGVuZHMgYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ212ZXgnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbXZleChtZXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMubXZleCwgTVA0LnRyZXgobWV0YSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVHJhY2sgRXh0ZW5kcyBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndHJleCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0cmV4KG1ldGEpIHtcbiAgICAgICAgICAgIHZhciB0cmFja0lkID0gbWV0YS5pZDtcbiAgICAgICAgICAgIHZhciBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHZlcnNpb24oMCkgKyBmbGFnc1xuICAgICAgICAgICAgdHJhY2tJZCA+Pj4gMjQgJiAweEZGLCAvLyB0cmFja19JRFxuICAgICAgICAgICAgdHJhY2tJZCA+Pj4gMTYgJiAweEZGLCB0cmFja0lkID4+PiA4ICYgMHhGRiwgdHJhY2tJZCAmIDB4RkYsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDEsIC8vIGRlZmF1bHRfc2FtcGxlX2Rlc2NyaXB0aW9uX2luZGV4XG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBkZWZhdWx0X3NhbXBsZV9kdXJhdGlvblxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gZGVmYXVsdF9zYW1wbGVfc2l6ZVxuICAgICAgICAgICAgMHgwMCwgMHgwMSwgMHgwMCwgMHgwMSAvLyBkZWZhdWx0X3NhbXBsZV9mbGFnc1xuICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMudHJleCwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNb3ZpZSBmcmFnbWVudCBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbW9vZicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtb29mKHRyYWNrLCBiYXNlTWVkaWFEZWNvZGVUaW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMubW9vZiwgTVA0Lm1maGQodHJhY2suc2VxdWVuY2VOdW1iZXIpLCBNUDQudHJhZih0cmFjaywgYmFzZU1lZGlhRGVjb2RlVGltZSkpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdtZmhkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1maGQoc2VxdWVuY2VOdW1iZXIpIHtcbiAgICAgICAgICAgIHZhciBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIHNlcXVlbmNlTnVtYmVyID4+PiAyNCAmIDB4RkYsIC8vIHNlcXVlbmNlX251bWJlcjogaW50MzJcbiAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyID4+PiAxNiAmIDB4RkYsIHNlcXVlbmNlTnVtYmVyID4+PiA4ICYgMHhGRiwgc2VxdWVuY2VOdW1iZXIgJiAweEZGXSk7XG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMubWZoZCwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUcmFjayBmcmFnbWVudCBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndHJhZicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0cmFmKHRyYWNrLCBiYXNlTWVkaWFEZWNvZGVUaW1lKSB7XG4gICAgICAgICAgICB2YXIgdHJhY2tJZCA9IHRyYWNrLmlkO1xuXG4gICAgICAgICAgICAvLyBUcmFjayBmcmFnbWVudCBoZWFkZXIgYm94XG4gICAgICAgICAgICB2YXIgdGZoZCA9IE1QNC5ib3goTVA0LnR5cGVzLnRmaGQsIG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyB2ZXJzaW9uKDApICYgZmxhZ3NcbiAgICAgICAgICAgIHRyYWNrSWQgPj4+IDI0ICYgMHhGRiwgLy8gdHJhY2tfSURcbiAgICAgICAgICAgIHRyYWNrSWQgPj4+IDE2ICYgMHhGRiwgdHJhY2tJZCA+Pj4gOCAmIDB4RkYsIHRyYWNrSWQgJiAweEZGXSkpO1xuICAgICAgICAgICAgLy8gVHJhY2sgRnJhZ21lbnQgRGVjb2RlIFRpbWVcbiAgICAgICAgICAgIHZhciB0ZmR0ID0gTVA0LmJveChNUDQudHlwZXMudGZkdCwgbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHZlcnNpb24oMCkgJiBmbGFnc1xuICAgICAgICAgICAgYmFzZU1lZGlhRGVjb2RlVGltZSA+Pj4gMjQgJiAweEZGLCAvLyBiYXNlTWVkaWFEZWNvZGVUaW1lOiBpbnQzMlxuICAgICAgICAgICAgYmFzZU1lZGlhRGVjb2RlVGltZSA+Pj4gMTYgJiAweEZGLCBiYXNlTWVkaWFEZWNvZGVUaW1lID4+PiA4ICYgMHhGRiwgYmFzZU1lZGlhRGVjb2RlVGltZSAmIDB4RkZdKSk7XG4gICAgICAgICAgICB2YXIgc2R0cCA9IE1QNC5zZHRwKHRyYWNrKTtcbiAgICAgICAgICAgIHZhciB0cnVuID0gTVA0LnRydW4odHJhY2ssIHNkdHAuYnl0ZUxlbmd0aCArIDE2ICsgMTYgKyA4ICsgMTYgKyA4ICsgOCk7XG5cbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy50cmFmLCB0ZmhkLCB0ZmR0LCB0cnVuLCBzZHRwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNhbXBsZSBEZXBlbmRlbmN5IFR5cGUgYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3NkdHAnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2R0cCh0cmFjaykge1xuICAgICAgICAgICAgdmFyIHNhbXBsZXMgPSB0cmFjay5zYW1wbGVzIHx8IFtdO1xuICAgICAgICAgICAgdmFyIHNhbXBsZUNvdW50ID0gc2FtcGxlcy5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IG5ldyBVaW50OEFycmF5KDQgKyBzYW1wbGVDb3VudCk7XG4gICAgICAgICAgICAvLyAwfjQgYnl0ZXM6IHZlcnNpb24oMCkgJiBmbGFnc1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzYW1wbGVDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZsYWdzID0gc2FtcGxlc1tpXS5mbGFncztcbiAgICAgICAgICAgICAgICBkYXRhW2kgKyA0XSA9IGZsYWdzLmlzTGVhZGluZyA8PCA2IHwgLy8gaXNfbGVhZGluZzogMiAoYml0KVxuICAgICAgICAgICAgICAgIGZsYWdzLmRlcGVuZHNPbiA8PCA0IC8vIHNhbXBsZV9kZXBlbmRzX29uXG4gICAgICAgICAgICAgICAgfCBmbGFncy5pc0RlcGVuZGVkT24gPDwgMiAvLyBzYW1wbGVfaXNfZGVwZW5kZWRfb25cbiAgICAgICAgICAgICAgICB8IGZsYWdzLmhhc1JlZHVuZGFuY3k7IC8vIHNhbXBsZV9oYXNfcmVkdW5kYW5jeVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLnNkdHAsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVHJhY2sgZnJhZ21lbnQgcnVuIGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICd0cnVuJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRydW4odHJhY2ssIG9mZnNldCkge1xuICAgICAgICAgICAgdmFyIHNhbXBsZXMgPSB0cmFjay5zYW1wbGVzIHx8IFtdO1xuICAgICAgICAgICAgdmFyIHNhbXBsZUNvdW50ID0gc2FtcGxlcy5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgZGF0YVNpemUgPSAxMiArIDE2ICogc2FtcGxlQ291bnQ7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IG5ldyBVaW50OEFycmF5KGRhdGFTaXplKTtcbiAgICAgICAgICAgIG9mZnNldCArPSA4ICsgZGF0YVNpemU7XG5cbiAgICAgICAgICAgIGRhdGEuc2V0KFsweDAwLCAweDAwLCAweDBGLCAweDAxLCAvLyB2ZXJzaW9uKDApICYgZmxhZ3NcbiAgICAgICAgICAgIHNhbXBsZUNvdW50ID4+PiAyNCAmIDB4RkYsIC8vIHNhbXBsZV9jb3VudFxuICAgICAgICAgICAgc2FtcGxlQ291bnQgPj4+IDE2ICYgMHhGRiwgc2FtcGxlQ291bnQgPj4+IDggJiAweEZGLCBzYW1wbGVDb3VudCAmIDB4RkYsIG9mZnNldCA+Pj4gMjQgJiAweEZGLCAvLyBkYXRhX29mZnNldFxuICAgICAgICAgICAgb2Zmc2V0ID4+PiAxNiAmIDB4RkYsIG9mZnNldCA+Pj4gOCAmIDB4RkYsIG9mZnNldCAmIDB4RkZdLCAwKTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzYW1wbGVDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGR1cmF0aW9uID0gc2FtcGxlc1tpXS5kdXJhdGlvbjtcbiAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IHNhbXBsZXNbaV0uc2l6ZTtcbiAgICAgICAgICAgICAgICB2YXIgZmxhZ3MgPSBzYW1wbGVzW2ldLmZsYWdzO1xuICAgICAgICAgICAgICAgIHZhciBjdHMgPSBzYW1wbGVzW2ldLmN0cztcbiAgICAgICAgICAgICAgICBkYXRhLnNldChbZHVyYXRpb24gPj4+IDI0ICYgMHhGRiwgLy8gc2FtcGxlX2R1cmF0aW9uXG4gICAgICAgICAgICAgICAgZHVyYXRpb24gPj4+IDE2ICYgMHhGRiwgZHVyYXRpb24gPj4+IDggJiAweEZGLCBkdXJhdGlvbiAmIDB4RkYsIHNpemUgPj4+IDI0ICYgMHhGRiwgLy8gc2FtcGxlX3NpemVcbiAgICAgICAgICAgICAgICBzaXplID4+PiAxNiAmIDB4RkYsIHNpemUgPj4+IDggJiAweEZGLCBzaXplICYgMHhGRiwgZmxhZ3MuaXNMZWFkaW5nIDw8IDIgfCBmbGFncy5kZXBlbmRzT24sIC8vIHNhbXBsZV9mbGFnc1xuICAgICAgICAgICAgICAgIGZsYWdzLmlzRGVwZW5kZWRPbiA8PCA2IHwgZmxhZ3MuaGFzUmVkdW5kYW5jeSA8PCA0IHwgZmxhZ3MuaXNOb25TeW5jLCAweDAwLCAweDAwLCAvLyBzYW1wbGVfZGVncmFkYXRpb25fcHJpb3JpdHlcbiAgICAgICAgICAgICAgICBjdHMgPj4+IDI0ICYgMHhGRiwgLy8gc2FtcGxlX2NvbXBvc2l0aW9uX3RpbWVfb2Zmc2V0XG4gICAgICAgICAgICAgICAgY3RzID4+PiAxNiAmIDB4RkYsIGN0cyA+Pj4gOCAmIDB4RkYsIGN0cyAmIDB4RkZdLCAxMiArIDE2ICogaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMudHJ1biwgZGF0YSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ21kYXQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbWRhdChkYXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMubWRhdCwgZGF0YSk7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gTVA0O1xufSgpO1xuXG5NUDQuaW5pdCgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBNUDQ7XG5cbn0se31dLDM4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9sb2dnZXIgPSBfZGVyZXFfKCcuLi91dGlscy9sb2dnZXIuanMnKTtcblxudmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTtcblxudmFyIF9tcDRHZW5lcmF0b3IgPSBfZGVyZXFfKCcuL21wNC1nZW5lcmF0b3IuanMnKTtcblxudmFyIF9tcDRHZW5lcmF0b3IyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbXA0R2VuZXJhdG9yKTtcblxudmFyIF9hYWNTaWxlbnQgPSBfZGVyZXFfKCcuL2FhYy1zaWxlbnQuanMnKTtcblxudmFyIF9hYWNTaWxlbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYWFjU2lsZW50KTtcblxudmFyIF9icm93c2VyID0gX2RlcmVxXygnLi4vdXRpbHMvYnJvd3Nlci5qcycpO1xuXG52YXIgX2Jyb3dzZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYnJvd3Nlcik7XG5cbnZhciBfbWVkaWFTZWdtZW50SW5mbyA9IF9kZXJlcV8oJy4uL2NvcmUvbWVkaWEtc2VnbWVudC1pbmZvLmpzJyk7XG5cbnZhciBfZXhjZXB0aW9uID0gX2RlcmVxXygnLi4vdXRpbHMvZXhjZXB0aW9uLmpzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8vIEZyYWdtZW50ZWQgbXA0IHJlbXV4ZXJcbnZhciBNUDRSZW11eGVyID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1QNFJlbXV4ZXIoY29uZmlnKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNUDRSZW11eGVyKTtcblxuICAgICAgICB0aGlzLlRBRyA9ICdNUDRSZW11eGVyJztcblxuICAgICAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XG4gICAgICAgIHRoaXMuX2lzTGl2ZSA9IGNvbmZpZy5pc0xpdmUgPT09IHRydWUgPyB0cnVlIDogZmFsc2U7XG5cbiAgICAgICAgdGhpcy5fZHRzQmFzZSA9IC0xO1xuICAgICAgICB0aGlzLl9kdHNCYXNlSW5pdGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2F1ZGlvRHRzQmFzZSA9IEluZmluaXR5O1xuICAgICAgICB0aGlzLl92aWRlb0R0c0Jhc2UgPSBJbmZpbml0eTtcbiAgICAgICAgdGhpcy5fYXVkaW9OZXh0RHRzID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl92aWRlb05leHREdHMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuX2F1ZGlvU3Rhc2hlZExhc3RTYW1wbGUgPSBudWxsO1xuICAgICAgICB0aGlzLl92aWRlb1N0YXNoZWRMYXN0U2FtcGxlID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9hdWRpb01ldGEgPSBudWxsO1xuICAgICAgICB0aGlzLl92aWRlb01ldGEgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuX2F1ZGlvU2VnbWVudEluZm9MaXN0ID0gbmV3IF9tZWRpYVNlZ21lbnRJbmZvLk1lZGlhU2VnbWVudEluZm9MaXN0KCdhdWRpbycpO1xuICAgICAgICB0aGlzLl92aWRlb1NlZ21lbnRJbmZvTGlzdCA9IG5ldyBfbWVkaWFTZWdtZW50SW5mby5NZWRpYVNlZ21lbnRJbmZvTGlzdCgndmlkZW8nKTtcblxuICAgICAgICB0aGlzLl9vbkluaXRTZWdtZW50ID0gbnVsbDtcbiAgICAgICAgdGhpcy5fb25NZWRpYVNlZ21lbnQgPSBudWxsO1xuXG4gICAgICAgIC8vIFdvcmthcm91bmQgZm9yIGNocm9tZSA8IDUwOiBBbHdheXMgZm9yY2UgZmlyc3Qgc2FtcGxlIGFzIGEgUmFuZG9tIEFjY2VzcyBQb2ludCBpbiBtZWRpYSBzZWdtZW50XG4gICAgICAgIC8vIHNlZSBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0yMjk0MTJcbiAgICAgICAgdGhpcy5fZm9yY2VGaXJzdElEUiA9IF9icm93c2VyMi5kZWZhdWx0LmNocm9tZSAmJiAoX2Jyb3dzZXIyLmRlZmF1bHQudmVyc2lvbi5tYWpvciA8IDUwIHx8IF9icm93c2VyMi5kZWZhdWx0LnZlcnNpb24ubWFqb3IgPT09IDUwICYmIF9icm93c2VyMi5kZWZhdWx0LnZlcnNpb24uYnVpbGQgPCAyNjYxKSA/IHRydWUgOiBmYWxzZTtcblxuICAgICAgICAvLyBXb3JrYXJvdW5kIGZvciBJRTExL0VkZ2U6IEZpbGwgc2lsZW50IGFhYyBmcmFtZSBhZnRlciBrZXlmcmFtZS1zZWVraW5nXG4gICAgICAgIC8vIE1ha2UgYXVkaW8gYmVnaW5EdHMgZXF1YWxzIHdpdGggdmlkZW8gYmVnaW5EdHMsIGluIG9yZGVyIHRvIGZpeCBzZWVrIGZyZWV6ZVxuICAgICAgICB0aGlzLl9maWxsU2lsZW50QWZ0ZXJTZWVrID0gX2Jyb3dzZXIyLmRlZmF1bHQubXNlZGdlIHx8IF9icm93c2VyMi5kZWZhdWx0Lm1zaWU7XG5cbiAgICAgICAgLy8gV2hpbGUgb25seSBGaXJlRm94IHN1cHBvcnRzICdhdWRpby9tcDQsIGNvZGVjcz1cIm1wM1wiJywgdXNlICdhdWRpby9tcGVnJyBmb3IgY2hyb21lLCBzYWZhcmksIC4uLlxuICAgICAgICB0aGlzLl9tcDNVc2VNcGVnQXVkaW8gPSAhX2Jyb3dzZXIyLmRlZmF1bHQuZmlyZWZveDtcblxuICAgICAgICB0aGlzLl9maWxsQXVkaW9UaW1lc3RhbXBHYXAgPSB0aGlzLl9jb25maWcuZml4QXVkaW9UaW1lc3RhbXBHYXA7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKE1QNFJlbXV4ZXIsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIHRoaXMuX2R0c0Jhc2UgPSAtMTtcbiAgICAgICAgICAgIHRoaXMuX2R0c0Jhc2VJbml0ZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX2F1ZGlvTWV0YSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl92aWRlb01ldGEgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fYXVkaW9TZWdtZW50SW5mb0xpc3QuY2xlYXIoKTtcbiAgICAgICAgICAgIHRoaXMuX2F1ZGlvU2VnbWVudEluZm9MaXN0ID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX3ZpZGVvU2VnbWVudEluZm9MaXN0LmNsZWFyKCk7XG4gICAgICAgICAgICB0aGlzLl92aWRlb1NlZ21lbnRJbmZvTGlzdCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vbkluaXRTZWdtZW50ID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uTWVkaWFTZWdtZW50ID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYmluZERhdGFTb3VyY2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYmluZERhdGFTb3VyY2UocHJvZHVjZXIpIHtcbiAgICAgICAgICAgIHByb2R1Y2VyLm9uRGF0YUF2YWlsYWJsZSA9IHRoaXMucmVtdXguYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHByb2R1Y2VyLm9uVHJhY2tNZXRhZGF0YSA9IHRoaXMuX29uVHJhY2tNZXRhZGF0YVJlY2VpdmVkLmJpbmQodGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIHByb3RvdHlwZTogZnVuY3Rpb24gb25Jbml0U2VnbWVudCh0eXBlOiBzdHJpbmcsIGluaXRTZWdtZW50OiBBcnJheUJ1ZmZlcik6IHZvaWRcclxuICAgICAgICAgICBJbml0U2VnbWVudDoge1xyXG4gICAgICAgICAgICAgICB0eXBlOiBzdHJpbmcsXHJcbiAgICAgICAgICAgICAgIGRhdGE6IEFycmF5QnVmZmVyLFxyXG4gICAgICAgICAgICAgICBjb2RlYzogc3RyaW5nLFxyXG4gICAgICAgICAgICAgICBjb250YWluZXI6IHN0cmluZ1xyXG4gICAgICAgICAgIH1cclxuICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdpbnNlcnREaXNjb250aW51aXR5JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc2VydERpc2NvbnRpbnVpdHkoKSB7XG4gICAgICAgICAgICB0aGlzLl9hdWRpb05leHREdHMgPSB0aGlzLl92aWRlb05leHREdHMgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3NlZWsnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2VlayhvcmlnaW5hbER0cykge1xuICAgICAgICAgICAgdGhpcy5fYXVkaW9TdGFzaGVkTGFzdFNhbXBsZSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl92aWRlb1N0YXNoZWRMYXN0U2FtcGxlID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX3ZpZGVvU2VnbWVudEluZm9MaXN0LmNsZWFyKCk7XG4gICAgICAgICAgICB0aGlzLl9hdWRpb1NlZ21lbnRJbmZvTGlzdC5jbGVhcigpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZW11eCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW11eChhdWRpb1RyYWNrLCB2aWRlb1RyYWNrKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX29uTWVkaWFTZWdtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCdNUDRSZW11eGVyOiBvbk1lZGlhU2VnbWVudCBjYWxsYmFjayBtdXN0IGJlIHNwZWNpZmljZWQhJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2R0c0Jhc2VJbml0ZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jYWxjdWxhdGVEdHNCYXNlKGF1ZGlvVHJhY2ssIHZpZGVvVHJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fcmVtdXhWaWRlbyh2aWRlb1RyYWNrKTtcbiAgICAgICAgICAgIHRoaXMuX3JlbXV4QXVkaW8oYXVkaW9UcmFjayk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblRyYWNrTWV0YWRhdGFSZWNlaXZlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25UcmFja01ldGFkYXRhUmVjZWl2ZWQodHlwZSwgbWV0YWRhdGEpIHtcbiAgICAgICAgICAgIHZhciBtZXRhYm94ID0gbnVsbDtcblxuICAgICAgICAgICAgdmFyIGNvbnRhaW5lciA9ICdtcDQnO1xuICAgICAgICAgICAgdmFyIGNvZGVjID0gbWV0YWRhdGEuY29kZWM7XG5cbiAgICAgICAgICAgIGlmICh0eXBlID09PSAnYXVkaW8nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXVkaW9NZXRhID0gbWV0YWRhdGE7XG4gICAgICAgICAgICAgICAgaWYgKG1ldGFkYXRhLmNvZGVjID09PSAnbXAzJyAmJiB0aGlzLl9tcDNVc2VNcGVnQXVkaW8pIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gJ2F1ZGlvL21wZWcnIGZvciBNUDMgYXVkaW8gdHJhY2tcbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyID0gJ21wZWcnO1xuICAgICAgICAgICAgICAgICAgICBjb2RlYyA9ICcnO1xuICAgICAgICAgICAgICAgICAgICBtZXRhYm94ID0gbmV3IFVpbnQ4QXJyYXkoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyAnYXVkaW8vbXA0LCBjb2RlY3M9XCJjb2RlY1wiJ1xuICAgICAgICAgICAgICAgICAgICBtZXRhYm94ID0gX21wNEdlbmVyYXRvcjIuZGVmYXVsdC5nZW5lcmF0ZUluaXRTZWdtZW50KG1ldGFkYXRhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICd2aWRlbycpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl92aWRlb01ldGEgPSBtZXRhZGF0YTtcbiAgICAgICAgICAgICAgICBtZXRhYm94ID0gX21wNEdlbmVyYXRvcjIuZGVmYXVsdC5nZW5lcmF0ZUluaXRTZWdtZW50KG1ldGFkYXRhKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBkaXNwYXRjaCBtZXRhYm94IChJbml0aWFsaXphdGlvbiBTZWdtZW50KVxuICAgICAgICAgICAgaWYgKCF0aGlzLl9vbkluaXRTZWdtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCdNUDRSZW11eGVyOiBvbkluaXRTZWdtZW50IGNhbGxiYWNrIG11c3QgYmUgc3BlY2lmaWVkIScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fb25Jbml0U2VnbWVudCh0eXBlLCB7XG4gICAgICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgICAgICBkYXRhOiBtZXRhYm94LmJ1ZmZlcixcbiAgICAgICAgICAgICAgICBjb2RlYzogY29kZWMsXG4gICAgICAgICAgICAgICAgY29udGFpbmVyOiB0eXBlICsgJy8nICsgY29udGFpbmVyLFxuICAgICAgICAgICAgICAgIG1lZGlhRHVyYXRpb246IG1ldGFkYXRhLmR1cmF0aW9uIC8vIGluIHRpbWVzY2FsZSAxMDAwIChtaWxsaXNlY29uZHMpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2NhbGN1bGF0ZUR0c0Jhc2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2NhbGN1bGF0ZUR0c0Jhc2UoYXVkaW9UcmFjaywgdmlkZW9UcmFjaykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2R0c0Jhc2VJbml0ZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChhdWRpb1RyYWNrLnNhbXBsZXMgJiYgYXVkaW9UcmFjay5zYW1wbGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2F1ZGlvRHRzQmFzZSA9IGF1ZGlvVHJhY2suc2FtcGxlc1swXS5kdHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodmlkZW9UcmFjay5zYW1wbGVzICYmIHZpZGVvVHJhY2suc2FtcGxlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl92aWRlb0R0c0Jhc2UgPSB2aWRlb1RyYWNrLnNhbXBsZXNbMF0uZHRzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9kdHNCYXNlID0gTWF0aC5taW4odGhpcy5fYXVkaW9EdHNCYXNlLCB0aGlzLl92aWRlb0R0c0Jhc2UpO1xuICAgICAgICAgICAgdGhpcy5fZHRzQmFzZUluaXRlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2ZsdXNoU3Rhc2hlZFNhbXBsZXMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZmx1c2hTdGFzaGVkU2FtcGxlcygpIHtcbiAgICAgICAgICAgIHZhciB2aWRlb1NhbXBsZSA9IHRoaXMuX3ZpZGVvU3Rhc2hlZExhc3RTYW1wbGU7XG4gICAgICAgICAgICB2YXIgYXVkaW9TYW1wbGUgPSB0aGlzLl9hdWRpb1N0YXNoZWRMYXN0U2FtcGxlO1xuXG4gICAgICAgICAgICB2YXIgdmlkZW9UcmFjayA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAndmlkZW8nLFxuICAgICAgICAgICAgICAgIGlkOiAxLFxuICAgICAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyOiAwLFxuICAgICAgICAgICAgICAgIHNhbXBsZXM6IFtdLFxuICAgICAgICAgICAgICAgIGxlbmd0aDogMFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKHZpZGVvU2FtcGxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2aWRlb1RyYWNrLnNhbXBsZXMucHVzaCh2aWRlb1NhbXBsZSk7XG4gICAgICAgICAgICAgICAgdmlkZW9UcmFjay5sZW5ndGggPSB2aWRlb1NhbXBsZS5sZW5ndGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBhdWRpb1RyYWNrID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdhdWRpbycsXG4gICAgICAgICAgICAgICAgaWQ6IDIsXG4gICAgICAgICAgICAgICAgc2VxdWVuY2VOdW1iZXI6IDAsXG4gICAgICAgICAgICAgICAgc2FtcGxlczogW10sXG4gICAgICAgICAgICAgICAgbGVuZ3RoOiAwXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAoYXVkaW9TYW1wbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGF1ZGlvVHJhY2suc2FtcGxlcy5wdXNoKGF1ZGlvU2FtcGxlKTtcbiAgICAgICAgICAgICAgICBhdWRpb1RyYWNrLmxlbmd0aCA9IGF1ZGlvU2FtcGxlLmxlbmd0aDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fdmlkZW9TdGFzaGVkTGFzdFNhbXBsZSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9hdWRpb1N0YXNoZWRMYXN0U2FtcGxlID0gbnVsbDtcblxuICAgICAgICAgICAgdGhpcy5fcmVtdXhWaWRlbyh2aWRlb1RyYWNrLCB0cnVlKTtcbiAgICAgICAgICAgIHRoaXMuX3JlbXV4QXVkaW8oYXVkaW9UcmFjaywgdHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19yZW11eEF1ZGlvJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9yZW11eEF1ZGlvKGF1ZGlvVHJhY2ssIGZvcmNlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fYXVkaW9NZXRhID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciB0cmFjayA9IGF1ZGlvVHJhY2s7XG4gICAgICAgICAgICB2YXIgc2FtcGxlcyA9IHRyYWNrLnNhbXBsZXM7XG4gICAgICAgICAgICB2YXIgZHRzQ29ycmVjdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHZhciBmaXJzdER0cyA9IC0xLFxuICAgICAgICAgICAgICAgIGxhc3REdHMgPSAtMSxcbiAgICAgICAgICAgICAgICBsYXN0UHRzID0gLTE7XG4gICAgICAgICAgICB2YXIgcmVmU2FtcGxlRHVyYXRpb24gPSB0aGlzLl9hdWRpb01ldGEucmVmU2FtcGxlRHVyYXRpb247XG5cbiAgICAgICAgICAgIHZhciBtcGVnUmF3VHJhY2sgPSB0aGlzLl9hdWRpb01ldGEuY29kZWMgPT09ICdtcDMnICYmIHRoaXMuX21wM1VzZU1wZWdBdWRpbztcbiAgICAgICAgICAgIHZhciBmaXJzdFNlZ21lbnRBZnRlclNlZWsgPSB0aGlzLl9kdHNCYXNlSW5pdGVkICYmIHRoaXMuX2F1ZGlvTmV4dER0cyA9PT0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICB2YXIgaW5zZXJ0UHJlZml4U2lsZW50RnJhbWUgPSBmYWxzZTtcblxuICAgICAgICAgICAgaWYgKCFzYW1wbGVzIHx8IHNhbXBsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNhbXBsZXMubGVuZ3RoID09PSAxICYmICFmb3JjZSkge1xuICAgICAgICAgICAgICAgIC8vIElmIFtzYW1wbGUgY291bnQgaW4gY3VycmVudCBiYXRjaF0gPT09IDEgJiYgKGZvcmNlICE9IHRydWUpXG4gICAgICAgICAgICAgICAgLy8gSWdub3JlIGFuZCBrZWVwIGluIGRlbXV4ZXIncyBxdWV1ZVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gLy8gZWxzZSBpZiAoZm9yY2UgPT09IHRydWUpIGRvIHJlbXV4XG5cbiAgICAgICAgICAgIHZhciBvZmZzZXQgPSAwO1xuICAgICAgICAgICAgdmFyIG1kYXRib3ggPSBudWxsO1xuICAgICAgICAgICAgdmFyIG1kYXRCeXRlcyA9IDA7XG5cbiAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSBpbml0aWFsIG1kYXQgc2l6ZVxuICAgICAgICAgICAgaWYgKG1wZWdSYXdUcmFjaykge1xuICAgICAgICAgICAgICAgIC8vIGZvciByYXcgbXBlZyBidWZmZXJcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSAwO1xuICAgICAgICAgICAgICAgIG1kYXRCeXRlcyA9IHRyYWNrLmxlbmd0aDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gZm9yIGZtcDQgbWRhdCBib3hcbiAgICAgICAgICAgICAgICBvZmZzZXQgPSA4OyAvLyBzaXplICsgdHlwZVxuICAgICAgICAgICAgICAgIG1kYXRCeXRlcyA9IDggKyB0cmFjay5sZW5ndGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBsYXN0U2FtcGxlID0gbnVsbDtcblxuICAgICAgICAgICAgLy8gUG9wIHRoZSBsYXN0U2FtcGxlIGFuZCB3YWl0aW5nIGZvciBzdGFzaFxuICAgICAgICAgICAgaWYgKHNhbXBsZXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIGxhc3RTYW1wbGUgPSBzYW1wbGVzLnBvcCgpO1xuICAgICAgICAgICAgICAgIG1kYXRCeXRlcyAtPSBsYXN0U2FtcGxlLmxlbmd0aDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSW5zZXJ0IFtzdGFzaGVkIGxhc3RTYW1wbGUgaW4gdGhlIHByZXZpb3VzIGJhdGNoXSB0byB0aGUgZnJvbnRcbiAgICAgICAgICAgIGlmICh0aGlzLl9hdWRpb1N0YXNoZWRMYXN0U2FtcGxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2FtcGxlID0gdGhpcy5fYXVkaW9TdGFzaGVkTGFzdFNhbXBsZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9hdWRpb1N0YXNoZWRMYXN0U2FtcGxlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzYW1wbGVzLnVuc2hpZnQoc2FtcGxlKTtcbiAgICAgICAgICAgICAgICBtZGF0Qnl0ZXMgKz0gc2FtcGxlLmxlbmd0aDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU3Rhc2ggdGhlIGxhc3RTYW1wbGUgb2YgY3VycmVudCBiYXRjaCwgd2FpdGluZyBmb3IgbmV4dCBiYXRjaFxuICAgICAgICAgICAgaWYgKGxhc3RTYW1wbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2F1ZGlvU3Rhc2hlZExhc3RTYW1wbGUgPSBsYXN0U2FtcGxlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZmlyc3RTYW1wbGVPcmlnaW5hbER0cyA9IHNhbXBsZXNbMF0uZHRzIC0gdGhpcy5fZHRzQmFzZTtcblxuICAgICAgICAgICAgLy8gY2FsY3VsYXRlIGR0c0NvcnJlY3Rpb25cbiAgICAgICAgICAgIGlmICh0aGlzLl9hdWRpb05leHREdHMpIHtcbiAgICAgICAgICAgICAgICBkdHNDb3JyZWN0aW9uID0gZmlyc3RTYW1wbGVPcmlnaW5hbER0cyAtIHRoaXMuX2F1ZGlvTmV4dER0cztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gdGhpcy5fYXVkaW9OZXh0RHRzID09IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hdWRpb1NlZ21lbnRJbmZvTGlzdC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZHRzQ29ycmVjdGlvbiA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9maWxsU2lsZW50QWZ0ZXJTZWVrICYmICF0aGlzLl92aWRlb1NlZ21lbnRJbmZvTGlzdC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hdWRpb01ldGEub3JpZ2luYWxDb2RlYyAhPT0gJ21wMycpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnNlcnRQcmVmaXhTaWxlbnRGcmFtZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2xhc3RTYW1wbGUgPSB0aGlzLl9hdWRpb1NlZ21lbnRJbmZvTGlzdC5nZXRMYXN0U2FtcGxlQmVmb3JlKGZpcnN0U2FtcGxlT3JpZ2luYWxEdHMpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoX2xhc3RTYW1wbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpc3RhbmNlID0gZmlyc3RTYW1wbGVPcmlnaW5hbER0cyAtIChfbGFzdFNhbXBsZS5vcmlnaW5hbER0cyArIF9sYXN0U2FtcGxlLmR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkaXN0YW5jZSA8PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2UgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4cGVjdGVkRHRzID0gX2xhc3RTYW1wbGUuZHRzICsgX2xhc3RTYW1wbGUuZHVyYXRpb24gKyBkaXN0YW5jZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGR0c0NvcnJlY3Rpb24gPSBmaXJzdFNhbXBsZU9yaWdpbmFsRHRzIC0gZXhwZWN0ZWREdHM7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBsYXN0U2FtcGxlID09IG51bGwsIGNhbm5vdCBmb3VuZFxuICAgICAgICAgICAgICAgICAgICAgICAgZHRzQ29ycmVjdGlvbiA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChpbnNlcnRQcmVmaXhTaWxlbnRGcmFtZSkge1xuICAgICAgICAgICAgICAgIC8vIGFsaWduIGF1ZGlvIHNlZ21lbnQgYmVnaW5EdHMgdG8gbWF0Y2ggd2l0aCBjdXJyZW50IHZpZGVvIHNlZ21lbnQncyBiZWdpbkR0c1xuICAgICAgICAgICAgICAgIHZhciBmaXJzdFNhbXBsZUR0cyA9IGZpcnN0U2FtcGxlT3JpZ2luYWxEdHMgLSBkdHNDb3JyZWN0aW9uO1xuICAgICAgICAgICAgICAgIHZhciB2aWRlb1NlZ21lbnQgPSB0aGlzLl92aWRlb1NlZ21lbnRJbmZvTGlzdC5nZXRMYXN0U2VnbWVudEJlZm9yZShmaXJzdFNhbXBsZU9yaWdpbmFsRHRzKTtcbiAgICAgICAgICAgICAgICBpZiAodmlkZW9TZWdtZW50ICE9IG51bGwgJiYgdmlkZW9TZWdtZW50LmJlZ2luRHRzIDwgZmlyc3RTYW1wbGVEdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNpbGVudFVuaXQgPSBfYWFjU2lsZW50Mi5kZWZhdWx0LmdldFNpbGVudEZyYW1lKHRoaXMuX2F1ZGlvTWV0YS5vcmlnaW5hbENvZGVjLCB0aGlzLl9hdWRpb01ldGEuY2hhbm5lbENvdW50KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNpbGVudFVuaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdHMgPSB2aWRlb1NlZ21lbnQuYmVnaW5EdHM7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2lsZW50RnJhbWVEdXJhdGlvbiA9IGZpcnN0U2FtcGxlRHRzIC0gdmlkZW9TZWdtZW50LmJlZ2luRHRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KHRoaXMuVEFHLCAnSW5zZXJ0UHJlZml4U2lsZW50QXVkaW86IGR0czogJyArIGR0cyArICcsIGR1cmF0aW9uOiAnICsgc2lsZW50RnJhbWVEdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVzLnVuc2hpZnQoeyB1bml0OiBzaWxlbnRVbml0LCBkdHM6IGR0cywgcHRzOiBkdHMgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZGF0Qnl0ZXMgKz0gc2lsZW50VW5pdC5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICB9IC8vIHNpbGVudFVuaXQgPT0gbnVsbDogQ2Fubm90IGdlbmVyYXRlLCBza2lwXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaW5zZXJ0UHJlZml4U2lsZW50RnJhbWUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBtcDRTYW1wbGVzID0gW107XG5cbiAgICAgICAgICAgIC8vIENvcnJlY3QgZHRzIGZvciBlYWNoIHNhbXBsZSwgYW5kIGNhbGN1bGF0ZSBzYW1wbGUgZHVyYXRpb24uIFRoZW4gb3V0cHV0IHRvIG1wNFNhbXBsZXNcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2FtcGxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBfc2FtcGxlID0gc2FtcGxlc1tpXTtcbiAgICAgICAgICAgICAgICB2YXIgdW5pdCA9IF9zYW1wbGUudW5pdDtcbiAgICAgICAgICAgICAgICB2YXIgb3JpZ2luYWxEdHMgPSBfc2FtcGxlLmR0cyAtIHRoaXMuX2R0c0Jhc2U7XG4gICAgICAgICAgICAgICAgdmFyIF9kdHMgPSBvcmlnaW5hbER0cztcbiAgICAgICAgICAgICAgICB2YXIgbmVlZEZpbGxTaWxlbnRGcmFtZXMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YXIgc2lsZW50RnJhbWVzID0gbnVsbDtcbiAgICAgICAgICAgICAgICB2YXIgc2FtcGxlRHVyYXRpb24gPSAwO1xuXG4gICAgICAgICAgICAgICAgaWYgKG9yaWdpbmFsRHRzIDwgLTAuMDAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOyAvL3Bhc3MgdGhlIGZpcnN0IHNhbXBsZSB3aXRoIHRoZSBpbnZhbGlkIGR0c1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hdWRpb01ldGEuY29kZWMgIT09ICdtcDMnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGZvciBBQUMgY29kZWMsIHdlIG5lZWQgdG8ga2VlcCBkdHMgaW5jcmVhc2UgYmFzZWQgb24gcmVmU2FtcGxlRHVyYXRpb25cbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1clJlZkR0cyA9IG9yaWdpbmFsRHRzO1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWF4QXVkaW9GcmFtZXNEcmlmdCA9IDM7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hdWRpb05leHREdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1clJlZkR0cyA9IHRoaXMuX2F1ZGlvTmV4dER0cztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGR0c0NvcnJlY3Rpb24gPSBvcmlnaW5hbER0cyAtIGN1clJlZkR0cztcbiAgICAgICAgICAgICAgICAgICAgaWYgKGR0c0NvcnJlY3Rpb24gPD0gLW1heEF1ZGlvRnJhbWVzRHJpZnQgKiByZWZTYW1wbGVEdXJhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2UncmUgb3ZlcmxhcHBpbmcgYnkgbW9yZSB0aGFuIG1heEF1ZGlvRnJhbWVzRHJpZnQgbnVtYmVyIG9mIGZyYW1lLCBkcm9wIHRoaXMgc2FtcGxlXG4gICAgICAgICAgICAgICAgICAgICAgICAvL0xvZy53KHRoaXMuVEFHLCBgRHJvcHBpbmcgMSBhdWRpbyBmcmFtZSAob3JpZ2luYWxEdHM6ICR7b3JpZ2luYWxEdHN9IG1zICxjdXJSZWZEdHM6ICR7Y3VyUmVmRHRzfSBtcykgIGR1ZSB0byBkdHNDb3JyZWN0aW9uOiAke2R0c0NvcnJlY3Rpb259IG1zIG92ZXJsYXAuYCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChkdHNDb3JyZWN0aW9uID49IG1heEF1ZGlvRnJhbWVzRHJpZnQgKiByZWZTYW1wbGVEdXJhdGlvbiAmJiB0aGlzLl9maWxsQXVkaW9UaW1lc3RhbXBHYXAgJiYgIV9icm93c2VyMi5kZWZhdWx0LnNhZmFyaSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2lsZW50IGZyYW1lIGdlbmVyYXRpb24sIGlmIGxhcmdlIHRpbWVzdGFtcCBnYXAgZGV0ZWN0ZWQgJiYgY29uZmlnLmZpeEF1ZGlvVGltZXN0YW1wR2FwXG4gICAgICAgICAgICAgICAgICAgICAgICBuZWVkRmlsbFNpbGVudEZyYW1lcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIGluc2VydCBzaWxlbnQgZnJhbWVzIHRvIGZpbGwgdGltZXN0YW1wIGdhcFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZyYW1lQ291bnQgPSBNYXRoLmZsb29yKGR0c0NvcnJlY3Rpb24gLyByZWZTYW1wbGVEdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdMYXJnZSBhdWRpbyB0aW1lc3RhbXAgZ2FwIGRldGVjdGVkLCBtYXkgY2F1c2UgQVYgc3luYyB0byBkcmlmdC4gJyArICdTaWxlbnQgZnJhbWVzIHdpbGwgYmUgZ2VuZXJhdGVkIHRvIGF2b2lkIHVuc3luYy5cXG4nICsgKCdvcmlnaW5hbER0czogJyArIG9yaWdpbmFsRHRzICsgJyBtcywgY3VyUmVmRHRzOiAnICsgY3VyUmVmRHRzICsgJyBtcywgJykgKyAoJ2R0c0NvcnJlY3Rpb246ICcgKyBNYXRoLnJvdW5kKGR0c0NvcnJlY3Rpb24pICsgJyBtcywgZ2VuZXJhdGU6ICcgKyBmcmFtZUNvdW50ICsgJyBmcmFtZXMnKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9kdHMgPSBNYXRoLmZsb29yKGN1clJlZkR0cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVEdXJhdGlvbiA9IE1hdGguZmxvb3IoY3VyUmVmRHRzICsgcmVmU2FtcGxlRHVyYXRpb24pIC0gX2R0cztcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9zaWxlbnRVbml0ID0gX2FhY1NpbGVudDIuZGVmYXVsdC5nZXRTaWxlbnRGcmFtZSh0aGlzLl9hdWRpb01ldGEub3JpZ2luYWxDb2RlYywgdGhpcy5fYXVkaW9NZXRhLmNoYW5uZWxDb3VudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3NpbGVudFVuaXQgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ1VuYWJsZSB0byBnZW5lcmF0ZSBzaWxlbnQgZnJhbWUgZm9yICcgKyAodGhpcy5fYXVkaW9NZXRhLm9yaWdpbmFsQ29kZWMgKyAnIHdpdGggJyArIHRoaXMuX2F1ZGlvTWV0YS5jaGFubmVsQ291bnQgKyAnIGNoYW5uZWxzLCByZXBlYXQgbGFzdCBmcmFtZScpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZXBlYXQgbGFzdCBmcmFtZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zaWxlbnRVbml0ID0gdW5pdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHNpbGVudEZyYW1lcyA9IFtdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGZyYW1lQ291bnQ7IGorKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1clJlZkR0cyA9IGN1clJlZkR0cyArIHJlZlNhbXBsZUR1cmF0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbnREdHMgPSBNYXRoLmZsb29yKGN1clJlZkR0cyk7IC8vIGNoYW5nZSB0byBpbnRlZ2VyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGludER1cmF0aW9uID0gTWF0aC5mbG9vcihjdXJSZWZEdHMgKyByZWZTYW1wbGVEdXJhdGlvbikgLSBpbnREdHM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZyYW1lID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdHM6IGludER0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHRzOiBpbnREdHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN0czogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdW5pdDogX3NpbGVudFVuaXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpemU6IF9zaWxlbnRVbml0LmJ5dGVMZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBpbnREdXJhdGlvbiwgLy8gd2FpdCBmb3IgbmV4dCBzYW1wbGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxEdHM6IG9yaWdpbmFsRHRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbGFnczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNMZWFkaW5nOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVwZW5kc09uOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNEZXBlbmRlZE9uOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGFzUmVkdW5kYW5jeTogMFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaWxlbnRGcmFtZXMucHVzaChmcmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWRhdEJ5dGVzICs9IGZyYW1lLnNpemU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2F1ZGlvTmV4dER0cyA9IGN1clJlZkR0cyArIHJlZlNhbXBsZUR1cmF0aW9uO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfZHRzID0gTWF0aC5mbG9vcihjdXJSZWZEdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2FtcGxlRHVyYXRpb24gPSBNYXRoLmZsb29yKGN1clJlZkR0cyArIHJlZlNhbXBsZUR1cmF0aW9uKSAtIF9kdHM7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hdWRpb05leHREdHMgPSBjdXJSZWZEdHMgKyByZWZTYW1wbGVEdXJhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGtlZXAgdGhlIG9yaWdpbmFsIGR0cyBjYWxjdWxhdGUgYWxnb3JpdGhtIGZvciBtcDNcbiAgICAgICAgICAgICAgICAgICAgX2R0cyA9IG9yaWdpbmFsRHRzIC0gZHRzQ29ycmVjdGlvbjtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoaSAhPT0gc2FtcGxlcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV4dER0cyA9IHNhbXBsZXNbaSArIDFdLmR0cyAtIHRoaXMuX2R0c0Jhc2UgLSBkdHNDb3JyZWN0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2FtcGxlRHVyYXRpb24gPSBuZXh0RHRzIC0gX2R0cztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBsYXN0IHNhbXBsZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxhc3RTYW1wbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVzZSBzdGFzaGVkIHNhbXBsZSdzIGR0cyB0byBjYWxjdWxhdGUgc2FtcGxlIGR1cmF0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9uZXh0RHRzID0gbGFzdFNhbXBsZS5kdHMgLSB0aGlzLl9kdHNCYXNlIC0gZHRzQ29ycmVjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVEdXJhdGlvbiA9IF9uZXh0RHRzIC0gX2R0cztcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobXA0U2FtcGxlcy5sZW5ndGggPj0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVzZSBzZWNvbmQgbGFzdCBzYW1wbGUgZHVyYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVEdXJhdGlvbiA9IG1wNFNhbXBsZXNbbXA0U2FtcGxlcy5sZW5ndGggLSAxXS5kdXJhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIG9ubHkgb25lIHNhbXBsZSwgdXNlIHJlZmVyZW5jZSBzYW1wbGUgZHVyYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVEdXJhdGlvbiA9IE1hdGguZmxvb3IocmVmU2FtcGxlRHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2F1ZGlvTmV4dER0cyA9IF9kdHMgKyBzYW1wbGVEdXJhdGlvbjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoZmlyc3REdHMgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpcnN0RHRzID0gX2R0cztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbXA0U2FtcGxlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgZHRzOiBfZHRzLFxuICAgICAgICAgICAgICAgICAgICBwdHM6IF9kdHMsXG4gICAgICAgICAgICAgICAgICAgIGN0czogMCxcbiAgICAgICAgICAgICAgICAgICAgdW5pdDogX3NhbXBsZS51bml0LFxuICAgICAgICAgICAgICAgICAgICBzaXplOiBfc2FtcGxlLnVuaXQuYnl0ZUxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IHNhbXBsZUR1cmF0aW9uLFxuICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbER0czogb3JpZ2luYWxEdHMsXG4gICAgICAgICAgICAgICAgICAgIGZsYWdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc0xlYWRpbmc6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXBlbmRzT246IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0RlcGVuZGVkT246IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYXNSZWR1bmRhbmN5OiAwXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIGlmIChuZWVkRmlsbFNpbGVudEZyYW1lcykge1xuICAgICAgICAgICAgICAgICAgICAvLyBTaWxlbnQgZnJhbWVzIHNob3VsZCBiZSBpbnNlcnRlZCBhZnRlciB3cm9uZy1kdXJhdGlvbiBmcmFtZVxuICAgICAgICAgICAgICAgICAgICBtcDRTYW1wbGVzLnB1c2guYXBwbHkobXA0U2FtcGxlcywgc2lsZW50RnJhbWVzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChtcDRTYW1wbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIC8vbm8gc2FtcGxlcyBuZWVkIHRvIHJlbXV4XG4gICAgICAgICAgICAgICAgdHJhY2suc2FtcGxlcyA9IFtdO1xuICAgICAgICAgICAgICAgIHRyYWNrLmxlbmd0aCA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBhbGxvY2F0ZSBtZGF0Ym94XG4gICAgICAgICAgICBpZiAobXBlZ1Jhd1RyYWNrKSB7XG4gICAgICAgICAgICAgICAgLy8gYWxsb2NhdGUgZm9yIHJhdyBtcGVnIGJ1ZmZlclxuICAgICAgICAgICAgICAgIG1kYXRib3ggPSBuZXcgVWludDhBcnJheShtZGF0Qnl0ZXMpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBhbGxvY2F0ZSBmb3IgZm1wNCBtZGF0IGJveFxuICAgICAgICAgICAgICAgIG1kYXRib3ggPSBuZXcgVWludDhBcnJheShtZGF0Qnl0ZXMpO1xuICAgICAgICAgICAgICAgIC8vIHNpemUgZmllbGRcbiAgICAgICAgICAgICAgICBtZGF0Ym94WzBdID0gbWRhdEJ5dGVzID4+PiAyNCAmIDB4RkY7XG4gICAgICAgICAgICAgICAgbWRhdGJveFsxXSA9IG1kYXRCeXRlcyA+Pj4gMTYgJiAweEZGO1xuICAgICAgICAgICAgICAgIG1kYXRib3hbMl0gPSBtZGF0Qnl0ZXMgPj4+IDggJiAweEZGO1xuICAgICAgICAgICAgICAgIG1kYXRib3hbM10gPSBtZGF0Qnl0ZXMgJiAweEZGO1xuICAgICAgICAgICAgICAgIC8vIHR5cGUgZmllbGQgKGZvdXJDQylcbiAgICAgICAgICAgICAgICBtZGF0Ym94LnNldChfbXA0R2VuZXJhdG9yMi5kZWZhdWx0LnR5cGVzLm1kYXQsIDQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBXcml0ZSBzYW1wbGVzIGludG8gbWRhdGJveFxuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IG1wNFNhbXBsZXMubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIF91bml0ID0gbXA0U2FtcGxlc1tfaV0udW5pdDtcbiAgICAgICAgICAgICAgICBtZGF0Ym94LnNldChfdW5pdCwgb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gX3VuaXQuYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGxhdGVzdCA9IG1wNFNhbXBsZXNbbXA0U2FtcGxlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGxhc3REdHMgPSBsYXRlc3QuZHRzICsgbGF0ZXN0LmR1cmF0aW9uO1xuICAgICAgICAgICAgLy90aGlzLl9hdWRpb05leHREdHMgPSBsYXN0RHRzO1xuXG4gICAgICAgICAgICAvLyBmaWxsIG1lZGlhIHNlZ21lbnQgaW5mbyAmIGFkZCB0byBpbmZvIGxpc3RcbiAgICAgICAgICAgIHZhciBpbmZvID0gbmV3IF9tZWRpYVNlZ21lbnRJbmZvLk1lZGlhU2VnbWVudEluZm8oKTtcbiAgICAgICAgICAgIGluZm8uYmVnaW5EdHMgPSBmaXJzdER0cztcbiAgICAgICAgICAgIGluZm8uZW5kRHRzID0gbGFzdER0cztcbiAgICAgICAgICAgIGluZm8uYmVnaW5QdHMgPSBmaXJzdER0cztcbiAgICAgICAgICAgIGluZm8uZW5kUHRzID0gbGFzdER0cztcbiAgICAgICAgICAgIGluZm8ub3JpZ2luYWxCZWdpbkR0cyA9IG1wNFNhbXBsZXNbMF0ub3JpZ2luYWxEdHM7XG4gICAgICAgICAgICBpbmZvLm9yaWdpbmFsRW5kRHRzID0gbGF0ZXN0Lm9yaWdpbmFsRHRzICsgbGF0ZXN0LmR1cmF0aW9uO1xuICAgICAgICAgICAgaW5mby5maXJzdFNhbXBsZSA9IG5ldyBfbWVkaWFTZWdtZW50SW5mby5TYW1wbGVJbmZvKG1wNFNhbXBsZXNbMF0uZHRzLCBtcDRTYW1wbGVzWzBdLnB0cywgbXA0U2FtcGxlc1swXS5kdXJhdGlvbiwgbXA0U2FtcGxlc1swXS5vcmlnaW5hbER0cywgZmFsc2UpO1xuICAgICAgICAgICAgaW5mby5sYXN0U2FtcGxlID0gbmV3IF9tZWRpYVNlZ21lbnRJbmZvLlNhbXBsZUluZm8obGF0ZXN0LmR0cywgbGF0ZXN0LnB0cywgbGF0ZXN0LmR1cmF0aW9uLCBsYXRlc3Qub3JpZ2luYWxEdHMsIGZhbHNlKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5faXNMaXZlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXVkaW9TZWdtZW50SW5mb0xpc3QuYXBwZW5kKGluZm8pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0cmFjay5zYW1wbGVzID0gbXA0U2FtcGxlcztcbiAgICAgICAgICAgIHRyYWNrLnNlcXVlbmNlTnVtYmVyKys7XG5cbiAgICAgICAgICAgIHZhciBtb29mYm94ID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKG1wZWdSYXdUcmFjaykge1xuICAgICAgICAgICAgICAgIC8vIEdlbmVyYXRlIGVtcHR5IGJ1ZmZlciwgYmVjYXVzZSB1c2VsZXNzIGZvciByYXcgbXBlZ1xuICAgICAgICAgICAgICAgIG1vb2Zib3ggPSBuZXcgVWludDhBcnJheSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBHZW5lcmF0ZSBtb29mIGZvciBmbXA0IHNlZ21lbnRcbiAgICAgICAgICAgICAgICBtb29mYm94ID0gX21wNEdlbmVyYXRvcjIuZGVmYXVsdC5tb29mKHRyYWNrLCBmaXJzdER0cyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRyYWNrLnNhbXBsZXMgPSBbXTtcbiAgICAgICAgICAgIHRyYWNrLmxlbmd0aCA9IDA7XG5cbiAgICAgICAgICAgIHZhciBzZWdtZW50ID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdhdWRpbycsXG4gICAgICAgICAgICAgICAgZGF0YTogdGhpcy5fbWVyZ2VCb3hlcyhtb29mYm94LCBtZGF0Ym94KS5idWZmZXIsXG4gICAgICAgICAgICAgICAgc2FtcGxlQ291bnQ6IG1wNFNhbXBsZXMubGVuZ3RoLFxuICAgICAgICAgICAgICAgIGluZm86IGluZm9cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmIChtcGVnUmF3VHJhY2sgJiYgZmlyc3RTZWdtZW50QWZ0ZXJTZWVrKSB7XG4gICAgICAgICAgICAgICAgLy8gRm9yIE1QRUcgYXVkaW8gc3RyZWFtIGluIE1TRSwgaWYgc2Vla2luZyBvY2N1cnJlZCwgYmVmb3JlIGFwcGVuZGluZyBuZXcgYnVmZmVyXG4gICAgICAgICAgICAgICAgLy8gV2UgbmVlZCBleHBsaWNpdGx5IHNldCB0aW1lc3RhbXBPZmZzZXQgdG8gdGhlIGRlc2lyZWQgcG9pbnQgaW4gdGltZWxpbmUgZm9yIG1wZWcgU291cmNlQnVmZmVyLlxuICAgICAgICAgICAgICAgIHNlZ21lbnQudGltZXN0YW1wT2Zmc2V0ID0gZmlyc3REdHM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX29uTWVkaWFTZWdtZW50KCdhdWRpbycsIHNlZ21lbnQpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcmVtdXhWaWRlbycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVtdXhWaWRlbyh2aWRlb1RyYWNrLCBmb3JjZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3ZpZGVvTWV0YSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdHJhY2sgPSB2aWRlb1RyYWNrO1xuICAgICAgICAgICAgdmFyIHNhbXBsZXMgPSB0cmFjay5zYW1wbGVzO1xuICAgICAgICAgICAgdmFyIGR0c0NvcnJlY3Rpb24gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB2YXIgZmlyc3REdHMgPSAtMSxcbiAgICAgICAgICAgICAgICBsYXN0RHRzID0gLTE7XG4gICAgICAgICAgICB2YXIgZmlyc3RQdHMgPSAtMSxcbiAgICAgICAgICAgICAgICBsYXN0UHRzID0gLTE7XG5cbiAgICAgICAgICAgIGlmICghc2FtcGxlcyB8fCBzYW1wbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzYW1wbGVzLmxlbmd0aCA9PT0gMSAmJiAhZm9yY2UpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiBbc2FtcGxlIGNvdW50IGluIGN1cnJlbnQgYmF0Y2hdID09PSAxICYmIChmb3JjZSAhPSB0cnVlKVxuICAgICAgICAgICAgICAgIC8vIElnbm9yZSBhbmQga2VlcCBpbiBkZW11eGVyJ3MgcXVldWVcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9IC8vIGVsc2UgaWYgKGZvcmNlID09PSB0cnVlKSBkbyByZW11eFxuXG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gODtcbiAgICAgICAgICAgIHZhciBtZGF0Ym94ID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBtZGF0Qnl0ZXMgPSA4ICsgdmlkZW9UcmFjay5sZW5ndGg7XG5cbiAgICAgICAgICAgIHZhciBsYXN0U2FtcGxlID0gbnVsbDtcblxuICAgICAgICAgICAgLy8gUG9wIHRoZSBsYXN0U2FtcGxlIGFuZCB3YWl0aW5nIGZvciBzdGFzaFxuICAgICAgICAgICAgaWYgKHNhbXBsZXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIGxhc3RTYW1wbGUgPSBzYW1wbGVzLnBvcCgpO1xuICAgICAgICAgICAgICAgIG1kYXRCeXRlcyAtPSBsYXN0U2FtcGxlLmxlbmd0aDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gSW5zZXJ0IFtzdGFzaGVkIGxhc3RTYW1wbGUgaW4gdGhlIHByZXZpb3VzIGJhdGNoXSB0byB0aGUgZnJvbnRcbiAgICAgICAgICAgIGlmICh0aGlzLl92aWRlb1N0YXNoZWRMYXN0U2FtcGxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2FtcGxlID0gdGhpcy5fdmlkZW9TdGFzaGVkTGFzdFNhbXBsZTtcbiAgICAgICAgICAgICAgICB0aGlzLl92aWRlb1N0YXNoZWRMYXN0U2FtcGxlID0gbnVsbDtcbiAgICAgICAgICAgICAgICBzYW1wbGVzLnVuc2hpZnQoc2FtcGxlKTtcbiAgICAgICAgICAgICAgICBtZGF0Qnl0ZXMgKz0gc2FtcGxlLmxlbmd0aDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU3Rhc2ggdGhlIGxhc3RTYW1wbGUgb2YgY3VycmVudCBiYXRjaCwgd2FpdGluZyBmb3IgbmV4dCBiYXRjaFxuICAgICAgICAgICAgaWYgKGxhc3RTYW1wbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZGVvU3Rhc2hlZExhc3RTYW1wbGUgPSBsYXN0U2FtcGxlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZmlyc3RTYW1wbGVPcmlnaW5hbER0cyA9IHNhbXBsZXNbMF0uZHRzIC0gdGhpcy5fZHRzQmFzZTtcblxuICAgICAgICAgICAgLy8gY2FsY3VsYXRlIGR0c0NvcnJlY3Rpb25cbiAgICAgICAgICAgIGlmICh0aGlzLl92aWRlb05leHREdHMpIHtcbiAgICAgICAgICAgICAgICBkdHNDb3JyZWN0aW9uID0gZmlyc3RTYW1wbGVPcmlnaW5hbER0cyAtIHRoaXMuX3ZpZGVvTmV4dER0cztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gdGhpcy5fdmlkZW9OZXh0RHRzID09IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl92aWRlb1NlZ21lbnRJbmZvTGlzdC5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgICAgICAgICAgZHRzQ29ycmVjdGlvbiA9IDA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9sYXN0U2FtcGxlMiA9IHRoaXMuX3ZpZGVvU2VnbWVudEluZm9MaXN0LmdldExhc3RTYW1wbGVCZWZvcmUoZmlyc3RTYW1wbGVPcmlnaW5hbER0cyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfbGFzdFNhbXBsZTIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRpc3RhbmNlID0gZmlyc3RTYW1wbGVPcmlnaW5hbER0cyAtIChfbGFzdFNhbXBsZTIub3JpZ2luYWxEdHMgKyBfbGFzdFNhbXBsZTIuZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRpc3RhbmNlIDw9IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXN0YW5jZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXhwZWN0ZWREdHMgPSBfbGFzdFNhbXBsZTIuZHRzICsgX2xhc3RTYW1wbGUyLmR1cmF0aW9uICsgZGlzdGFuY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBkdHNDb3JyZWN0aW9uID0gZmlyc3RTYW1wbGVPcmlnaW5hbER0cyAtIGV4cGVjdGVkRHRzO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbGFzdFNhbXBsZSA9PSBudWxsLCBjYW5ub3QgZm91bmRcbiAgICAgICAgICAgICAgICAgICAgICAgIGR0c0NvcnJlY3Rpb24gPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgaW5mbyA9IG5ldyBfbWVkaWFTZWdtZW50SW5mby5NZWRpYVNlZ21lbnRJbmZvKCk7XG4gICAgICAgICAgICB2YXIgbXA0U2FtcGxlcyA9IFtdO1xuXG4gICAgICAgICAgICAvLyBDb3JyZWN0IGR0cyBmb3IgZWFjaCBzYW1wbGUsIGFuZCBjYWxjdWxhdGUgc2FtcGxlIGR1cmF0aW9uLiBUaGVuIG91dHB1dCB0byBtcDRTYW1wbGVzXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNhbXBsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgX3NhbXBsZTIgPSBzYW1wbGVzW2ldO1xuICAgICAgICAgICAgICAgIHZhciBvcmlnaW5hbER0cyA9IF9zYW1wbGUyLmR0cyAtIHRoaXMuX2R0c0Jhc2U7XG4gICAgICAgICAgICAgICAgdmFyIGlzS2V5ZnJhbWUgPSBfc2FtcGxlMi5pc0tleWZyYW1lO1xuICAgICAgICAgICAgICAgIHZhciBkdHMgPSBvcmlnaW5hbER0cyAtIGR0c0NvcnJlY3Rpb247XG4gICAgICAgICAgICAgICAgdmFyIGN0cyA9IF9zYW1wbGUyLmN0cztcbiAgICAgICAgICAgICAgICB2YXIgcHRzID0gZHRzICsgY3RzO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZpcnN0RHRzID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBmaXJzdER0cyA9IGR0cztcbiAgICAgICAgICAgICAgICAgICAgZmlyc3RQdHMgPSBwdHM7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHNhbXBsZUR1cmF0aW9uID0gMDtcblxuICAgICAgICAgICAgICAgIGlmIChpICE9PSBzYW1wbGVzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5leHREdHMgPSBzYW1wbGVzW2kgKyAxXS5kdHMgLSB0aGlzLl9kdHNCYXNlIC0gZHRzQ29ycmVjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgc2FtcGxlRHVyYXRpb24gPSBuZXh0RHRzIC0gZHRzO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBsYXN0IHNhbXBsZVxuICAgICAgICAgICAgICAgICAgICBpZiAobGFzdFNhbXBsZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB1c2Ugc3Rhc2hlZCBzYW1wbGUncyBkdHMgdG8gY2FsY3VsYXRlIHNhbXBsZSBkdXJhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9uZXh0RHRzMiA9IGxhc3RTYW1wbGUuZHRzIC0gdGhpcy5fZHRzQmFzZSAtIGR0c0NvcnJlY3Rpb247XG4gICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVEdXJhdGlvbiA9IF9uZXh0RHRzMiAtIGR0cztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtcDRTYW1wbGVzLmxlbmd0aCA+PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB1c2Ugc2Vjb25kIGxhc3Qgc2FtcGxlIGR1cmF0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVEdXJhdGlvbiA9IG1wNFNhbXBsZXNbbXA0U2FtcGxlcy5sZW5ndGggLSAxXS5kdXJhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBvbmx5IG9uZSBzYW1wbGUsIHVzZSByZWZlcmVuY2Ugc2FtcGxlIGR1cmF0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVEdXJhdGlvbiA9IE1hdGguZmxvb3IodGhpcy5fdmlkZW9NZXRhLnJlZlNhbXBsZUR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChpc0tleWZyYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzeW5jUG9pbnQgPSBuZXcgX21lZGlhU2VnbWVudEluZm8uU2FtcGxlSW5mbyhkdHMsIHB0cywgc2FtcGxlRHVyYXRpb24sIF9zYW1wbGUyLmR0cywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHN5bmNQb2ludC5maWxlcG9zaXRpb24gPSBfc2FtcGxlMi5maWxlcG9zaXRpb247XG4gICAgICAgICAgICAgICAgICAgIGluZm8uYXBwZW5kU3luY1BvaW50KHN5bmNQb2ludCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbXA0U2FtcGxlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgZHRzOiBkdHMsXG4gICAgICAgICAgICAgICAgICAgIHB0czogcHRzLFxuICAgICAgICAgICAgICAgICAgICBjdHM6IGN0cyxcbiAgICAgICAgICAgICAgICAgICAgdW5pdHM6IF9zYW1wbGUyLnVuaXRzLFxuICAgICAgICAgICAgICAgICAgICBzaXplOiBfc2FtcGxlMi5sZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgIGlzS2V5ZnJhbWU6IGlzS2V5ZnJhbWUsXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBzYW1wbGVEdXJhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxEdHM6IG9yaWdpbmFsRHRzLFxuICAgICAgICAgICAgICAgICAgICBmbGFnczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNMZWFkaW5nOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVwZW5kc09uOiBpc0tleWZyYW1lID8gMiA6IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0RlcGVuZGVkT246IGlzS2V5ZnJhbWUgPyAxIDogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc1JlZHVuZGFuY3k6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBpc05vblN5bmM6IGlzS2V5ZnJhbWUgPyAwIDogMVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFsbG9jYXRlIG1kYXRib3hcbiAgICAgICAgICAgIG1kYXRib3ggPSBuZXcgVWludDhBcnJheShtZGF0Qnl0ZXMpO1xuICAgICAgICAgICAgbWRhdGJveFswXSA9IG1kYXRCeXRlcyA+Pj4gMjQgJiAweEZGO1xuICAgICAgICAgICAgbWRhdGJveFsxXSA9IG1kYXRCeXRlcyA+Pj4gMTYgJiAweEZGO1xuICAgICAgICAgICAgbWRhdGJveFsyXSA9IG1kYXRCeXRlcyA+Pj4gOCAmIDB4RkY7XG4gICAgICAgICAgICBtZGF0Ym94WzNdID0gbWRhdEJ5dGVzICYgMHhGRjtcbiAgICAgICAgICAgIG1kYXRib3guc2V0KF9tcDRHZW5lcmF0b3IyLmRlZmF1bHQudHlwZXMubWRhdCwgNCk7XG5cbiAgICAgICAgICAgIC8vIFdyaXRlIHNhbXBsZXMgaW50byBtZGF0Ym94XG4gICAgICAgICAgICBmb3IgKHZhciBfaTIgPSAwOyBfaTIgPCBtcDRTYW1wbGVzLmxlbmd0aDsgX2kyKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgdW5pdHMgPSBtcDRTYW1wbGVzW19pMl0udW5pdHM7XG4gICAgICAgICAgICAgICAgd2hpbGUgKHVuaXRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdW5pdCA9IHVuaXRzLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gdW5pdC5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBtZGF0Ym94LnNldChkYXRhLCBvZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gZGF0YS5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGxhdGVzdCA9IG1wNFNhbXBsZXNbbXA0U2FtcGxlcy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIGxhc3REdHMgPSBsYXRlc3QuZHRzICsgbGF0ZXN0LmR1cmF0aW9uO1xuICAgICAgICAgICAgbGFzdFB0cyA9IGxhdGVzdC5wdHMgKyBsYXRlc3QuZHVyYXRpb247XG4gICAgICAgICAgICB0aGlzLl92aWRlb05leHREdHMgPSBsYXN0RHRzO1xuXG4gICAgICAgICAgICAvLyBmaWxsIG1lZGlhIHNlZ21lbnQgaW5mbyAmIGFkZCB0byBpbmZvIGxpc3RcbiAgICAgICAgICAgIGluZm8uYmVnaW5EdHMgPSBmaXJzdER0cztcbiAgICAgICAgICAgIGluZm8uZW5kRHRzID0gbGFzdER0cztcbiAgICAgICAgICAgIGluZm8uYmVnaW5QdHMgPSBmaXJzdFB0cztcbiAgICAgICAgICAgIGluZm8uZW5kUHRzID0gbGFzdFB0cztcbiAgICAgICAgICAgIGluZm8ub3JpZ2luYWxCZWdpbkR0cyA9IG1wNFNhbXBsZXNbMF0ub3JpZ2luYWxEdHM7XG4gICAgICAgICAgICBpbmZvLm9yaWdpbmFsRW5kRHRzID0gbGF0ZXN0Lm9yaWdpbmFsRHRzICsgbGF0ZXN0LmR1cmF0aW9uO1xuICAgICAgICAgICAgaW5mby5maXJzdFNhbXBsZSA9IG5ldyBfbWVkaWFTZWdtZW50SW5mby5TYW1wbGVJbmZvKG1wNFNhbXBsZXNbMF0uZHRzLCBtcDRTYW1wbGVzWzBdLnB0cywgbXA0U2FtcGxlc1swXS5kdXJhdGlvbiwgbXA0U2FtcGxlc1swXS5vcmlnaW5hbER0cywgbXA0U2FtcGxlc1swXS5pc0tleWZyYW1lKTtcbiAgICAgICAgICAgIGluZm8ubGFzdFNhbXBsZSA9IG5ldyBfbWVkaWFTZWdtZW50SW5mby5TYW1wbGVJbmZvKGxhdGVzdC5kdHMsIGxhdGVzdC5wdHMsIGxhdGVzdC5kdXJhdGlvbiwgbGF0ZXN0Lm9yaWdpbmFsRHRzLCBsYXRlc3QuaXNLZXlmcmFtZSk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2lzTGl2ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZGVvU2VnbWVudEluZm9MaXN0LmFwcGVuZChpbmZvKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdHJhY2suc2FtcGxlcyA9IG1wNFNhbXBsZXM7XG4gICAgICAgICAgICB0cmFjay5zZXF1ZW5jZU51bWJlcisrO1xuXG4gICAgICAgICAgICAvLyB3b3JrYXJvdW5kIGZvciBjaHJvbWUgPCA1MDogZm9yY2UgZmlyc3Qgc2FtcGxlIGFzIGEgcmFuZG9tIGFjY2VzcyBwb2ludFxuICAgICAgICAgICAgLy8gc2VlIGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTIyOTQxMlxuICAgICAgICAgICAgaWYgKHRoaXMuX2ZvcmNlRmlyc3RJRFIpIHtcbiAgICAgICAgICAgICAgICB2YXIgZmxhZ3MgPSBtcDRTYW1wbGVzWzBdLmZsYWdzO1xuICAgICAgICAgICAgICAgIGZsYWdzLmRlcGVuZHNPbiA9IDI7XG4gICAgICAgICAgICAgICAgZmxhZ3MuaXNOb25TeW5jID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIG1vb2Zib3ggPSBfbXA0R2VuZXJhdG9yMi5kZWZhdWx0Lm1vb2YodHJhY2ssIGZpcnN0RHRzKTtcbiAgICAgICAgICAgIHRyYWNrLnNhbXBsZXMgPSBbXTtcbiAgICAgICAgICAgIHRyYWNrLmxlbmd0aCA9IDA7XG5cbiAgICAgICAgICAgIHRoaXMuX29uTWVkaWFTZWdtZW50KCd2aWRlbycsIHtcbiAgICAgICAgICAgICAgICB0eXBlOiAndmlkZW8nLFxuICAgICAgICAgICAgICAgIGRhdGE6IHRoaXMuX21lcmdlQm94ZXMobW9vZmJveCwgbWRhdGJveCkuYnVmZmVyLFxuICAgICAgICAgICAgICAgIHNhbXBsZUNvdW50OiBtcDRTYW1wbGVzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBpbmZvOiBpbmZvXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX21lcmdlQm94ZXMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX21lcmdlQm94ZXMobW9vZiwgbWRhdCkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBVaW50OEFycmF5KG1vb2YuYnl0ZUxlbmd0aCArIG1kYXQuYnl0ZUxlbmd0aCk7XG4gICAgICAgICAgICByZXN1bHQuc2V0KG1vb2YsIDApO1xuICAgICAgICAgICAgcmVzdWx0LnNldChtZGF0LCBtb29mLmJ5dGVMZW5ndGgpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25Jbml0U2VnbWVudCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uSW5pdFNlZ21lbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vbkluaXRTZWdtZW50ID0gY2FsbGJhY2s7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBwcm90b3R5cGU6IGZ1bmN0aW9uIG9uTWVkaWFTZWdtZW50KHR5cGU6IHN0cmluZywgbWVkaWFTZWdtZW50OiBNZWRpYVNlZ21lbnQpOiB2b2lkXHJcbiAgICAgICAgICAgTWVkaWFTZWdtZW50OiB7XHJcbiAgICAgICAgICAgICAgIHR5cGU6IHN0cmluZyxcclxuICAgICAgICAgICAgICAgZGF0YTogQXJyYXlCdWZmZXIsXHJcbiAgICAgICAgICAgICAgIHNhbXBsZUNvdW50OiBpbnQzMlxyXG4gICAgICAgICAgICAgICBpbmZvOiBNZWRpYVNlZ21lbnRJbmZvXHJcbiAgICAgICAgICAgfVxyXG4gICAgICAgICovXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uTWVkaWFTZWdtZW50JyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25NZWRpYVNlZ21lbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vbk1lZGlhU2VnbWVudCA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIE1QNFJlbXV4ZXI7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IE1QNFJlbXV4ZXI7XG5cbn0se1wiLi4vY29yZS9tZWRpYS1zZWdtZW50LWluZm8uanNcIjo4LFwiLi4vdXRpbHMvYnJvd3Nlci5qc1wiOjM5LFwiLi4vdXRpbHMvZXhjZXB0aW9uLmpzXCI6NDAsXCIuLi91dGlscy9sb2dnZXIuanNcIjo0MSxcIi4vYWFjLXNpbGVudC5qc1wiOjM2LFwiLi9tcDQtZ2VuZXJhdG9yLmpzXCI6Mzd9XSwzOTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbnZhciBCcm93c2VyID0ge307XG5cbmZ1bmN0aW9uIGRldGVjdCgpIHtcbiAgICAvLyBtb2RpZmllZCBmcm9tIGpxdWVyeS1icm93c2VyLXBsdWdpblxuXG4gICAgdmFyIHVhID0gc2VsZi5uYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCk7XG5cbiAgICB2YXIgbWF0Y2ggPSAvKGVkZ2UpXFwvKFtcXHcuXSspLy5leGVjKHVhKSB8fCAvKG9wcilbXFwvXShbXFx3Ll0rKS8uZXhlYyh1YSkgfHwgLyhjaHJvbWUpWyBcXC9dKFtcXHcuXSspLy5leGVjKHVhKSB8fCAvKGllbW9iaWxlKVtcXC9dKFtcXHcuXSspLy5leGVjKHVhKSB8fCAvKHZlcnNpb24pKGFwcGxld2Via2l0KVsgXFwvXShbXFx3Ll0rKS4qKHNhZmFyaSlbIFxcL10oW1xcdy5dKykvLmV4ZWModWEpIHx8IC8od2Via2l0KVsgXFwvXShbXFx3Ll0rKS4qKHZlcnNpb24pWyBcXC9dKFtcXHcuXSspLiooc2FmYXJpKVsgXFwvXShbXFx3Ll0rKS8uZXhlYyh1YSkgfHwgLyh3ZWJraXQpWyBcXC9dKFtcXHcuXSspLy5leGVjKHVhKSB8fCAvKG9wZXJhKSg/Oi4qdmVyc2lvbnwpWyBcXC9dKFtcXHcuXSspLy5leGVjKHVhKSB8fCAvKG1zaWUpIChbXFx3Ll0rKS8uZXhlYyh1YSkgfHwgdWEuaW5kZXhPZigndHJpZGVudCcpID49IDAgJiYgLyhydikoPzo6fCApKFtcXHcuXSspLy5leGVjKHVhKSB8fCB1YS5pbmRleE9mKCdjb21wYXRpYmxlJykgPCAwICYmIC8oZmlyZWZveClbIFxcL10oW1xcdy5dKykvLmV4ZWModWEpIHx8IFtdO1xuXG4gICAgdmFyIHBsYXRmb3JtX21hdGNoID0gLyhpcGFkKS8uZXhlYyh1YSkgfHwgLyhpcG9kKS8uZXhlYyh1YSkgfHwgLyh3aW5kb3dzIHBob25lKS8uZXhlYyh1YSkgfHwgLyhpcGhvbmUpLy5leGVjKHVhKSB8fCAvKGtpbmRsZSkvLmV4ZWModWEpIHx8IC8oYW5kcm9pZCkvLmV4ZWModWEpIHx8IC8od2luZG93cykvLmV4ZWModWEpIHx8IC8obWFjKS8uZXhlYyh1YSkgfHwgLyhsaW51eCkvLmV4ZWModWEpIHx8IC8oY3JvcykvLmV4ZWModWEpIHx8IFtdO1xuXG4gICAgdmFyIG1hdGNoZWQgPSB7XG4gICAgICAgIGJyb3dzZXI6IG1hdGNoWzVdIHx8IG1hdGNoWzNdIHx8IG1hdGNoWzFdIHx8ICcnLFxuICAgICAgICB2ZXJzaW9uOiBtYXRjaFsyXSB8fCBtYXRjaFs0XSB8fCAnMCcsXG4gICAgICAgIG1ham9yVmVyc2lvbjogbWF0Y2hbNF0gfHwgbWF0Y2hbMl0gfHwgJzAnLFxuICAgICAgICBwbGF0Zm9ybTogcGxhdGZvcm1fbWF0Y2hbMF0gfHwgJydcbiAgICB9O1xuXG4gICAgdmFyIGJyb3dzZXIgPSB7fTtcbiAgICBpZiAobWF0Y2hlZC5icm93c2VyKSB7XG4gICAgICAgIGJyb3dzZXJbbWF0Y2hlZC5icm93c2VyXSA9IHRydWU7XG5cbiAgICAgICAgdmFyIHZlcnNpb25BcnJheSA9IG1hdGNoZWQubWFqb3JWZXJzaW9uLnNwbGl0KCcuJyk7XG4gICAgICAgIGJyb3dzZXIudmVyc2lvbiA9IHtcbiAgICAgICAgICAgIG1ham9yOiBwYXJzZUludChtYXRjaGVkLm1ham9yVmVyc2lvbiwgMTApLFxuICAgICAgICAgICAgc3RyaW5nOiBtYXRjaGVkLnZlcnNpb25cbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHZlcnNpb25BcnJheS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICBicm93c2VyLnZlcnNpb24ubWlub3IgPSBwYXJzZUludCh2ZXJzaW9uQXJyYXlbMV0sIDEwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodmVyc2lvbkFycmF5Lmxlbmd0aCA+IDIpIHtcbiAgICAgICAgICAgIGJyb3dzZXIudmVyc2lvbi5idWlsZCA9IHBhcnNlSW50KHZlcnNpb25BcnJheVsyXSwgMTApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKG1hdGNoZWQucGxhdGZvcm0pIHtcbiAgICAgICAgYnJvd3NlclttYXRjaGVkLnBsYXRmb3JtXSA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKGJyb3dzZXIuY2hyb21lIHx8IGJyb3dzZXIub3ByIHx8IGJyb3dzZXIuc2FmYXJpKSB7XG4gICAgICAgIGJyb3dzZXIud2Via2l0ID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyBNU0lFLiBJRTExIGhhcyAncnYnIGlkZW50aWZlclxuICAgIGlmIChicm93c2VyLnJ2IHx8IGJyb3dzZXIuaWVtb2JpbGUpIHtcbiAgICAgICAgaWYgKGJyb3dzZXIucnYpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBicm93c2VyLnJ2O1xuICAgICAgICB9XG4gICAgICAgIHZhciBtc2llID0gJ21zaWUnO1xuICAgICAgICBtYXRjaGVkLmJyb3dzZXIgPSBtc2llO1xuICAgICAgICBicm93c2VyW21zaWVdID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyBNaWNyb3NvZnQgRWRnZVxuICAgIGlmIChicm93c2VyLmVkZ2UpIHtcbiAgICAgICAgZGVsZXRlIGJyb3dzZXIuZWRnZTtcbiAgICAgICAgdmFyIG1zZWRnZSA9ICdtc2VkZ2UnO1xuICAgICAgICBtYXRjaGVkLmJyb3dzZXIgPSBtc2VkZ2U7XG4gICAgICAgIGJyb3dzZXJbbXNlZGdlXSA9IHRydWU7XG4gICAgfVxuXG4gICAgLy8gT3BlcmEgMTUrXG4gICAgaWYgKGJyb3dzZXIub3ByKSB7XG4gICAgICAgIHZhciBvcGVyYSA9ICdvcGVyYSc7XG4gICAgICAgIG1hdGNoZWQuYnJvd3NlciA9IG9wZXJhO1xuICAgICAgICBicm93c2VyW29wZXJhXSA9IHRydWU7XG4gICAgfVxuXG4gICAgLy8gU3RvY2sgYW5kcm9pZCBicm93c2VycyBhcmUgbWFya2VkIGFzIFNhZmFyaVxuICAgIGlmIChicm93c2VyLnNhZmFyaSAmJiBicm93c2VyLmFuZHJvaWQpIHtcbiAgICAgICAgdmFyIGFuZHJvaWQgPSAnYW5kcm9pZCc7XG4gICAgICAgIG1hdGNoZWQuYnJvd3NlciA9IGFuZHJvaWQ7XG4gICAgICAgIGJyb3dzZXJbYW5kcm9pZF0gPSB0cnVlO1xuICAgIH1cblxuICAgIGJyb3dzZXIubmFtZSA9IG1hdGNoZWQuYnJvd3NlcjtcbiAgICBicm93c2VyLnBsYXRmb3JtID0gbWF0Y2hlZC5wbGF0Zm9ybTtcblxuICAgIGZvciAodmFyIGtleSBpbiBCcm93c2VyKSB7XG4gICAgICAgIGlmIChCcm93c2VyLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBCcm93c2VyW2tleV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgT2JqZWN0LmFzc2lnbihCcm93c2VyLCBicm93c2VyKTtcbn1cblxuZGV0ZWN0KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEJyb3dzZXI7XG5cbn0se31dLDQwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbnZhciBSdW50aW1lRXhjZXB0aW9uID0gZXhwb3J0cy5SdW50aW1lRXhjZXB0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFJ1bnRpbWVFeGNlcHRpb24obWVzc2FnZSkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUnVudGltZUV4Y2VwdGlvbik7XG5cbiAgICAgICAgdGhpcy5fbWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFJ1bnRpbWVFeGNlcHRpb24sIFt7XG4gICAgICAgIGtleTogJ3RvU3RyaW5nJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubmFtZSArICc6ICcgKyB0aGlzLm1lc3NhZ2U7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ25hbWUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiAnUnVudGltZUV4Y2VwdGlvbic7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ21lc3NhZ2UnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tZXNzYWdlO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFJ1bnRpbWVFeGNlcHRpb247XG59KCk7XG5cbnZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb24gPSBleHBvcnRzLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbiA9IGZ1bmN0aW9uIChfUnVudGltZUV4Y2VwdGlvbikge1xuICAgIF9pbmhlcml0cyhJbGxlZ2FsU3RhdGVFeGNlcHRpb24sIF9SdW50aW1lRXhjZXB0aW9uKTtcblxuICAgIGZ1bmN0aW9uIElsbGVnYWxTdGF0ZUV4Y2VwdGlvbihtZXNzYWdlKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJbGxlZ2FsU3RhdGVFeGNlcHRpb24pO1xuXG4gICAgICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoSWxsZWdhbFN0YXRlRXhjZXB0aW9uLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoSWxsZWdhbFN0YXRlRXhjZXB0aW9uKSkuY2FsbCh0aGlzLCBtZXNzYWdlKSk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiwgW3tcbiAgICAgICAga2V5OiAnbmFtZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuICdJbGxlZ2FsU3RhdGVFeGNlcHRpb24nO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIElsbGVnYWxTdGF0ZUV4Y2VwdGlvbjtcbn0oUnVudGltZUV4Y2VwdGlvbik7XG5cbnZhciBJbnZhbGlkQXJndW1lbnRFeGNlcHRpb24gPSBleHBvcnRzLkludmFsaWRBcmd1bWVudEV4Y2VwdGlvbiA9IGZ1bmN0aW9uIChfUnVudGltZUV4Y2VwdGlvbjIpIHtcbiAgICBfaW5oZXJpdHMoSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uLCBfUnVudGltZUV4Y2VwdGlvbjIpO1xuXG4gICAgZnVuY3Rpb24gSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uKG1lc3NhZ2UpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEludmFsaWRBcmd1bWVudEV4Y2VwdGlvbik7XG5cbiAgICAgICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChJbnZhbGlkQXJndW1lbnRFeGNlcHRpb24uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihJbnZhbGlkQXJndW1lbnRFeGNlcHRpb24pKS5jYWxsKHRoaXMsIG1lc3NhZ2UpKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uLCBbe1xuICAgICAgICBrZXk6ICduYW1lJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ0ludmFsaWRBcmd1bWVudEV4Y2VwdGlvbic7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uO1xufShSdW50aW1lRXhjZXB0aW9uKTtcblxudmFyIE5vdEltcGxlbWVudGVkRXhjZXB0aW9uID0gZXhwb3J0cy5Ob3RJbXBsZW1lbnRlZEV4Y2VwdGlvbiA9IGZ1bmN0aW9uIChfUnVudGltZUV4Y2VwdGlvbjMpIHtcbiAgICBfaW5oZXJpdHMoTm90SW1wbGVtZW50ZWRFeGNlcHRpb24sIF9SdW50aW1lRXhjZXB0aW9uMyk7XG5cbiAgICBmdW5jdGlvbiBOb3RJbXBsZW1lbnRlZEV4Y2VwdGlvbihtZXNzYWdlKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBOb3RJbXBsZW1lbnRlZEV4Y2VwdGlvbik7XG5cbiAgICAgICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChOb3RJbXBsZW1lbnRlZEV4Y2VwdGlvbi5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE5vdEltcGxlbWVudGVkRXhjZXB0aW9uKSkuY2FsbCh0aGlzLCBtZXNzYWdlKSk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKE5vdEltcGxlbWVudGVkRXhjZXB0aW9uLCBbe1xuICAgICAgICBrZXk6ICduYW1lJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ05vdEltcGxlbWVudGVkRXhjZXB0aW9uJztcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBOb3RJbXBsZW1lbnRlZEV4Y2VwdGlvbjtcbn0oUnVudGltZUV4Y2VwdGlvbik7XG5cbn0se31dLDQxOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9ldmVudHMgPSBfZGVyZXFfKCdldmVudHMnKTtcblxudmFyIF9ldmVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXZlbnRzKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIExvZyA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBMb2coKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMb2cpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhMb2csIG51bGwsIFt7XG4gICAgICAgIGtleTogJ2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZSh0YWcsIG1zZykge1xuICAgICAgICAgICAgaWYgKCF0YWcgfHwgTG9nLkZPUkNFX0dMT0JBTF9UQUcpIHRhZyA9IExvZy5HTE9CQUxfVEFHO1xuXG4gICAgICAgICAgICB2YXIgc3RyID0gJ1snICsgdGFnICsgJ10gPiAnICsgbXNnO1xuXG4gICAgICAgICAgICBpZiAoTG9nLkVOQUJMRV9DQUxMQkFDSykge1xuICAgICAgICAgICAgICAgIExvZy5lbWl0dGVyLmVtaXQoJ2xvZycsICdlcnJvcicsIHN0cik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghTG9nLkVOQUJMRV9FUlJPUikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNvbnNvbGUuZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKHN0cik7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNvbnNvbGUud2Fybikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihzdHIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzdHIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdpJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGkodGFnLCBtc2cpIHtcbiAgICAgICAgICAgIGlmICghdGFnIHx8IExvZy5GT1JDRV9HTE9CQUxfVEFHKSB0YWcgPSBMb2cuR0xPQkFMX1RBRztcblxuICAgICAgICAgICAgdmFyIHN0ciA9ICdbJyArIHRhZyArICddID4gJyArIG1zZztcblxuICAgICAgICAgICAgaWYgKExvZy5FTkFCTEVfQ0FMTEJBQ0spIHtcbiAgICAgICAgICAgICAgICBMb2cuZW1pdHRlci5lbWl0KCdsb2cnLCAnaW5mbycsIHN0cik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghTG9nLkVOQUJMRV9JTkZPKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY29uc29sZS5pbmZvKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKHN0cik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0cik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3cnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdyh0YWcsIG1zZykge1xuICAgICAgICAgICAgaWYgKCF0YWcgfHwgTG9nLkZPUkNFX0dMT0JBTF9UQUcpIHRhZyA9IExvZy5HTE9CQUxfVEFHO1xuXG4gICAgICAgICAgICB2YXIgc3RyID0gJ1snICsgdGFnICsgJ10gPiAnICsgbXNnO1xuXG4gICAgICAgICAgICBpZiAoTG9nLkVOQUJMRV9DQUxMQkFDSykge1xuICAgICAgICAgICAgICAgIExvZy5lbWl0dGVyLmVtaXQoJ2xvZycsICd3YXJuJywgc3RyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFMb2cuRU5BQkxFX1dBUk4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjb25zb2xlLndhcm4pIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oc3RyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coc3RyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkKHRhZywgbXNnKSB7XG4gICAgICAgICAgICBpZiAoIXRhZyB8fCBMb2cuRk9SQ0VfR0xPQkFMX1RBRykgdGFnID0gTG9nLkdMT0JBTF9UQUc7XG5cbiAgICAgICAgICAgIHZhciBzdHIgPSAnWycgKyB0YWcgKyAnXSA+ICcgKyBtc2c7XG5cbiAgICAgICAgICAgIGlmIChMb2cuRU5BQkxFX0NBTExCQUNLKSB7XG4gICAgICAgICAgICAgICAgTG9nLmVtaXR0ZXIuZW1pdCgnbG9nJywgJ2RlYnVnJywgc3RyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFMb2cuRU5BQkxFX0RFQlVHKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY29uc29sZS5kZWJ1Zykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoc3RyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coc3RyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB2KHRhZywgbXNnKSB7XG4gICAgICAgICAgICBpZiAoIXRhZyB8fCBMb2cuRk9SQ0VfR0xPQkFMX1RBRykgdGFnID0gTG9nLkdMT0JBTF9UQUc7XG5cbiAgICAgICAgICAgIHZhciBzdHIgPSAnWycgKyB0YWcgKyAnXSA+ICcgKyBtc2c7XG5cbiAgICAgICAgICAgIGlmIChMb2cuRU5BQkxFX0NBTExCQUNLKSB7XG4gICAgICAgICAgICAgICAgTG9nLmVtaXR0ZXIuZW1pdCgnbG9nJywgJ3ZlcmJvc2UnLCBzdHIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIUxvZy5FTkFCTEVfVkVSQk9TRSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc29sZS5sb2coc3RyKTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBMb2c7XG59KCk7XG5cbkxvZy5HTE9CQUxfVEFHID0gJ2Zsdi5qcyc7XG5Mb2cuRk9SQ0VfR0xPQkFMX1RBRyA9IGZhbHNlO1xuTG9nLkVOQUJMRV9FUlJPUiA9IHRydWU7XG5Mb2cuRU5BQkxFX0lORk8gPSB0cnVlO1xuTG9nLkVOQUJMRV9XQVJOID0gdHJ1ZTtcbkxvZy5FTkFCTEVfREVCVUcgPSB0cnVlO1xuTG9nLkVOQUJMRV9WRVJCT1NFID0gdHJ1ZTtcblxuTG9nLkVOQUJMRV9DQUxMQkFDSyA9IGZhbHNlO1xuXG5Mb2cuZW1pdHRlciA9IG5ldyBfZXZlbnRzMi5kZWZhdWx0KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IExvZztcblxufSx7XCJldmVudHNcIjoyfV0sNDI6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgX2V2ZW50cyA9IF9kZXJlcV8oJ2V2ZW50cycpO1xuXG52YXIgX2V2ZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ldmVudHMpO1xuXG52YXIgX2xvZ2dlciA9IF9kZXJlcV8oJy4vbG9nZ2VyLmpzJyk7XG5cbnZhciBfbG9nZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dlcik7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBMb2dnaW5nQ29udHJvbCA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBMb2dnaW5nQ29udHJvbCgpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExvZ2dpbmdDb250cm9sKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoTG9nZ2luZ0NvbnRyb2wsIG51bGwsIFt7XG4gICAgICAgIGtleTogJ2dldENvbmZpZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDb25maWcoKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGdsb2JhbFRhZzogX2xvZ2dlcjIuZGVmYXVsdC5HTE9CQUxfVEFHLFxuICAgICAgICAgICAgICAgIGZvcmNlR2xvYmFsVGFnOiBfbG9nZ2VyMi5kZWZhdWx0LkZPUkNFX0dMT0JBTF9UQUcsXG4gICAgICAgICAgICAgICAgZW5hYmxlVmVyYm9zZTogX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfVkVSQk9TRSxcbiAgICAgICAgICAgICAgICBlbmFibGVEZWJ1ZzogX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfREVCVUcsXG4gICAgICAgICAgICAgICAgZW5hYmxlSW5mbzogX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfSU5GTyxcbiAgICAgICAgICAgICAgICBlbmFibGVXYXJuOiBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9XQVJOLFxuICAgICAgICAgICAgICAgIGVuYWJsZUVycm9yOiBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9FUlJPUixcbiAgICAgICAgICAgICAgICBlbmFibGVDYWxsYmFjazogX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfQ0FMTEJBQ0tcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2FwcGx5Q29uZmlnJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGx5Q29uZmlnKGNvbmZpZykge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5HTE9CQUxfVEFHID0gY29uZmlnLmdsb2JhbFRhZztcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRk9SQ0VfR0xPQkFMX1RBRyA9IGNvbmZpZy5mb3JjZUdsb2JhbFRhZztcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX1ZFUkJPU0UgPSBjb25maWcuZW5hYmxlVmVyYm9zZTtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0RFQlVHID0gY29uZmlnLmVuYWJsZURlYnVnO1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfSU5GTyA9IGNvbmZpZy5lbmFibGVJbmZvO1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfV0FSTiA9IGNvbmZpZy5lbmFibGVXYXJuO1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfRVJST1IgPSBjb25maWcuZW5hYmxlRXJyb3I7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9DQUxMQkFDSyA9IGNvbmZpZy5lbmFibGVDYWxsYmFjaztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX25vdGlmeUNoYW5nZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfbm90aWZ5Q2hhbmdlKCkge1xuICAgICAgICAgICAgdmFyIGVtaXR0ZXIgPSBMb2dnaW5nQ29udHJvbC5lbWl0dGVyO1xuXG4gICAgICAgICAgICBpZiAoZW1pdHRlci5saXN0ZW5lckNvdW50KCdjaGFuZ2UnKSA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgY29uZmlnID0gTG9nZ2luZ0NvbnRyb2wuZ2V0Q29uZmlnKCk7XG4gICAgICAgICAgICAgICAgZW1pdHRlci5lbWl0KCdjaGFuZ2UnLCBjb25maWcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZWdpc3Rlckxpc3RlbmVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlZ2lzdGVyTGlzdGVuZXIobGlzdGVuZXIpIHtcbiAgICAgICAgICAgIExvZ2dpbmdDb250cm9sLmVtaXR0ZXIuYWRkTGlzdGVuZXIoJ2NoYW5nZScsIGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVtb3ZlTGlzdGVuZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlTGlzdGVuZXIobGlzdGVuZXIpIHtcbiAgICAgICAgICAgIExvZ2dpbmdDb250cm9sLmVtaXR0ZXIucmVtb3ZlTGlzdGVuZXIoJ2NoYW5nZScsIGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYWRkTG9nTGlzdGVuZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkTG9nTGlzdGVuZXIobGlzdGVuZXIpIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZW1pdHRlci5hZGRMaXN0ZW5lcignbG9nJywgbGlzdGVuZXIpO1xuICAgICAgICAgICAgaWYgKF9sb2dnZXIyLmRlZmF1bHQuZW1pdHRlci5saXN0ZW5lckNvdW50KCdsb2cnKSA+IDApIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9DQUxMQkFDSyA9IHRydWU7XG4gICAgICAgICAgICAgICAgTG9nZ2luZ0NvbnRyb2wuX25vdGlmeUNoYW5nZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZW1vdmVMb2dMaXN0ZW5lcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVMb2dMaXN0ZW5lcihsaXN0ZW5lcikge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lbWl0dGVyLnJlbW92ZUxpc3RlbmVyKCdsb2cnLCBsaXN0ZW5lcik7XG4gICAgICAgICAgICBpZiAoX2xvZ2dlcjIuZGVmYXVsdC5lbWl0dGVyLmxpc3RlbmVyQ291bnQoJ2xvZycpID09PSAwKSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfQ0FMTEJBQ0sgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBMb2dnaW5nQ29udHJvbC5fbm90aWZ5Q2hhbmdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2ZvcmNlR2xvYmFsVGFnJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gX2xvZ2dlcjIuZGVmYXVsdC5GT1JDRV9HTE9CQUxfVEFHO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChlbmFibGUpIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRk9SQ0VfR0xPQkFMX1RBRyA9IGVuYWJsZTtcbiAgICAgICAgICAgIExvZ2dpbmdDb250cm9sLl9ub3RpZnlDaGFuZ2UoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZ2xvYmFsVGFnJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gX2xvZ2dlcjIuZGVmYXVsdC5HTE9CQUxfVEFHO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh0YWcpIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuR0xPQkFMX1RBRyA9IHRhZztcbiAgICAgICAgICAgIExvZ2dpbmdDb250cm9sLl9ub3RpZnlDaGFuZ2UoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZW5hYmxlQWxsJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfVkVSQk9TRSAmJiBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9ERUJVRyAmJiBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9JTkZPICYmIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX1dBUk4gJiYgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfRVJST1I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGVuYWJsZSkge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfVkVSQk9TRSA9IGVuYWJsZTtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0RFQlVHID0gZW5hYmxlO1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfSU5GTyA9IGVuYWJsZTtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX1dBUk4gPSBlbmFibGU7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9FUlJPUiA9IGVuYWJsZTtcbiAgICAgICAgICAgIExvZ2dpbmdDb250cm9sLl9ub3RpZnlDaGFuZ2UoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZW5hYmxlRGVidWcnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9ERUJVRztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZW5hYmxlKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9ERUJVRyA9IGVuYWJsZTtcbiAgICAgICAgICAgIExvZ2dpbmdDb250cm9sLl9ub3RpZnlDaGFuZ2UoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZW5hYmxlVmVyYm9zZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX1ZFUkJPU0U7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGVuYWJsZSkge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfVkVSQk9TRSA9IGVuYWJsZTtcbiAgICAgICAgICAgIExvZ2dpbmdDb250cm9sLl9ub3RpZnlDaGFuZ2UoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZW5hYmxlSW5mbycsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0lORk87XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGVuYWJsZSkge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfSU5GTyA9IGVuYWJsZTtcbiAgICAgICAgICAgIExvZ2dpbmdDb250cm9sLl9ub3RpZnlDaGFuZ2UoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZW5hYmxlV2FybicsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX1dBUk47XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGVuYWJsZSkge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfV0FSTiA9IGVuYWJsZTtcbiAgICAgICAgICAgIExvZ2dpbmdDb250cm9sLl9ub3RpZnlDaGFuZ2UoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZW5hYmxlRXJyb3InLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9FUlJPUjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZW5hYmxlKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9FUlJPUiA9IGVuYWJsZTtcbiAgICAgICAgICAgIExvZ2dpbmdDb250cm9sLl9ub3RpZnlDaGFuZ2UoKTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBMb2dnaW5nQ29udHJvbDtcbn0oKTtcblxuTG9nZ2luZ0NvbnRyb2wuZW1pdHRlciA9IG5ldyBfZXZlbnRzMi5kZWZhdWx0KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IExvZ2dpbmdDb250cm9sO1xuXG59LHtcIi4vbG9nZ2VyLmpzXCI6NDEsXCJldmVudHNcIjoyfV0sNDM6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbnZhciBQb2x5ZmlsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQb2x5ZmlsbCgpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBvbHlmaWxsKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoUG9seWZpbGwsIG51bGwsIFt7XG4gICAgICAgIGtleTogJ2luc3RhbGwnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zdGFsbCgpIHtcbiAgICAgICAgICAgIC8vIEVTNiBPYmplY3Quc2V0UHJvdG90eXBlT2ZcbiAgICAgICAgICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiAob2JqLCBwcm90bykge1xuICAgICAgICAgICAgICAgIG9iai5fX3Byb3RvX18gPSBwcm90bztcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JqO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gRVM2IE9iamVjdC5hc3NpZ25cbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHtcbiAgICAgICAgICAgICAgICBpZiAodGFyZ2V0ID09PSB1bmRlZmluZWQgfHwgdGFyZ2V0ID09PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjb252ZXJ0IHVuZGVmaW5lZCBvciBudWxsIHRvIG9iamVjdCcpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBvdXRwdXQgPSBPYmplY3QodGFyZ2V0KTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlICE9PSB1bmRlZmluZWQgJiYgc291cmNlICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gc291cmNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dFtrZXldID0gc291cmNlW2tleV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBFUzYgUHJvbWlzZSAobWlzc2luZyBzdXBwb3J0IGluIElFMTEpXG4gICAgICAgICAgICBpZiAodHlwZW9mIHNlbGYuUHJvbWlzZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIF9kZXJlcV8oJ2VzNi1wcm9taXNlJykucG9seWZpbGwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBQb2x5ZmlsbDtcbn0oKTtcblxuUG9seWZpbGwuaW5zdGFsbCgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBQb2x5ZmlsbDtcblxufSx7XCJlczYtcHJvbWlzZVwiOjF9XSw0NDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogVGhpcyBmaWxlIGlzIGRlcml2ZWQgZnJvbSBDKysgcHJvamVjdCBsaWJXaW5URjggKGh0dHBzOi8vZ2l0aHViLmNvbS9tMTMyNTMvbGliV2luVEY4KVxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxuZnVuY3Rpb24gY2hlY2tDb250aW51YXRpb24odWludDhhcnJheSwgc3RhcnQsIGNoZWNrTGVuZ3RoKSB7XG4gICAgdmFyIGFycmF5ID0gdWludDhhcnJheTtcbiAgICBpZiAoc3RhcnQgKyBjaGVja0xlbmd0aCA8IGFycmF5Lmxlbmd0aCkge1xuICAgICAgICB3aGlsZSAoY2hlY2tMZW5ndGgtLSkge1xuICAgICAgICAgICAgaWYgKChhcnJheVsrK3N0YXJ0XSAmIDB4QzApICE9PSAweDgwKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZGVjb2RlVVRGOCh1aW50OGFycmF5KSB7XG4gICAgdmFyIG91dCA9IFtdO1xuICAgIHZhciBpbnB1dCA9IHVpbnQ4YXJyYXk7XG4gICAgdmFyIGkgPSAwO1xuICAgIHZhciBsZW5ndGggPSB1aW50OGFycmF5Lmxlbmd0aDtcblxuICAgIHdoaWxlIChpIDwgbGVuZ3RoKSB7XG4gICAgICAgIGlmIChpbnB1dFtpXSA8IDB4ODApIHtcbiAgICAgICAgICAgIG91dC5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoaW5wdXRbaV0pKTtcbiAgICAgICAgICAgICsraTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9IGVsc2UgaWYgKGlucHV0W2ldIDwgMHhDMCkge1xuICAgICAgICAgICAgLy8gZmFsbHRocm91Z2hcbiAgICAgICAgfSBlbHNlIGlmIChpbnB1dFtpXSA8IDB4RTApIHtcbiAgICAgICAgICAgIGlmIChjaGVja0NvbnRpbnVhdGlvbihpbnB1dCwgaSwgMSkpIHtcbiAgICAgICAgICAgICAgICB2YXIgdWNzNCA9IChpbnB1dFtpXSAmIDB4MUYpIDw8IDYgfCBpbnB1dFtpICsgMV0gJiAweDNGO1xuICAgICAgICAgICAgICAgIGlmICh1Y3M0ID49IDB4ODApIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0LnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZSh1Y3M0ICYgMHhGRkZGKSk7XG4gICAgICAgICAgICAgICAgICAgIGkgKz0gMjtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGlucHV0W2ldIDwgMHhGMCkge1xuICAgICAgICAgICAgaWYgKGNoZWNrQ29udGludWF0aW9uKGlucHV0LCBpLCAyKSkge1xuICAgICAgICAgICAgICAgIHZhciBfdWNzID0gKGlucHV0W2ldICYgMHhGKSA8PCAxMiB8IChpbnB1dFtpICsgMV0gJiAweDNGKSA8PCA2IHwgaW5wdXRbaSArIDJdICYgMHgzRjtcbiAgICAgICAgICAgICAgICBpZiAoX3VjcyA+PSAweDgwMCAmJiAoX3VjcyAmIDB4RjgwMCkgIT09IDB4RDgwMCkge1xuICAgICAgICAgICAgICAgICAgICBvdXQucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKF91Y3MgJiAweEZGRkYpKTtcbiAgICAgICAgICAgICAgICAgICAgaSArPSAzO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoaW5wdXRbaV0gPCAweEY4KSB7XG4gICAgICAgICAgICBpZiAoY2hlY2tDb250aW51YXRpb24oaW5wdXQsIGksIDMpKSB7XG4gICAgICAgICAgICAgICAgdmFyIF91Y3MyID0gKGlucHV0W2ldICYgMHg3KSA8PCAxOCB8IChpbnB1dFtpICsgMV0gJiAweDNGKSA8PCAxMiB8IChpbnB1dFtpICsgMl0gJiAweDNGKSA8PCA2IHwgaW5wdXRbaSArIDNdICYgMHgzRjtcbiAgICAgICAgICAgICAgICBpZiAoX3VjczIgPiAweDEwMDAwICYmIF91Y3MyIDwgMHgxMTAwMDApIHtcbiAgICAgICAgICAgICAgICAgICAgX3VjczIgLT0gMHgxMDAwMDtcbiAgICAgICAgICAgICAgICAgICAgb3V0LnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShfdWNzMiA+Pj4gMTAgfCAweEQ4MDApKTtcbiAgICAgICAgICAgICAgICAgICAgb3V0LnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShfdWNzMiAmIDB4M0ZGIHwgMHhEQzAwKSk7XG4gICAgICAgICAgICAgICAgICAgIGkgKz0gNDtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIG91dC5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoMHhGRkZEKSk7XG4gICAgICAgICsraTtcbiAgICB9XG5cbiAgICByZXR1cm4gb3V0LmpvaW4oJycpO1xufVxuXG5leHBvcnRzLmRlZmF1bHQgPSBkZWNvZGVVVEY4O1xuXG59LHt9XX0se30sWzIxXSkoMjEpXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Zmx2LmpzLm1hcFxuIiwiLypcbm1wM+e8lueggeWZqOeUqOWIsOeahGxhbWVqc+e8lueggeW8leaTju+8jOS4gOiIrOmDveeUqE1QM+agvOW8j++8jOa1j+iniOWZqOaUr+aMgeW5v+azm++8jOatpOW8leaTjua1i+ivleeahOS5n+avlOi+g+Wkmu+8jOeos+WumlxuaHR0cHM6Ly9naXRodWIuY29tL3hpYW5neXVlY24vUmVjb3JkZXJcbiovXG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG4vL2VuZDIgKioqKuW8gOWni2NvcHkgbGFtZWpzKioqKipcbi8qXG5tcDPnvJbnoIHkvp3otZZsYW1lanPvvIzlpoLmnpzml6DpnIBtcDPmlK/mjIHnm7TmjqXnp7vpmaTmraTku6PnoIFcbmh0dHBzOi8vZ2l0aHViLmNvbS96aHVrZXIvbGFtZWpzL2Jsb2IvYmZiN2Y2YzZkNzg3N2UwZmUxYWQ5ZTcyNjk3YTg3MTY3NjExOWEwZS9sYW1lLmFsbC5qc1xuKi9cblxuZnVuY3Rpb24gbGFtZWpzKCkge1xudmFyIE1hdGhfbG9nMTA9ZnVuY3Rpb24ocyl7Ly/lnZrlhrPkuI3og73nlKjkuZ/kuI3opoHmiqXor63oqIDpl67popjnmoTplJnor69cblx0cmV0dXJuIE1hdGgubG9nKHMpL01hdGgubG9nKDEwKTtcbn07XG5cbmZ1bmN0aW9uIG5ld19ieXRlKGNvdW50KSB7XG4gICAgcmV0dXJuIG5ldyBJbnQ4QXJyYXkoY291bnQpO1xufVxuXG5mdW5jdGlvbiBuZXdfc2hvcnQoY291bnQpIHtcbiAgICByZXR1cm4gbmV3IEludDE2QXJyYXkoY291bnQpO1xufVxuXG5mdW5jdGlvbiBuZXdfaW50KGNvdW50KSB7XG4gICAgcmV0dXJuIG5ldyBJbnQzMkFycmF5KGNvdW50KTtcbn1cblxuZnVuY3Rpb24gbmV3X2Zsb2F0KGNvdW50KSB7XG4gICAgcmV0dXJuIG5ldyBGbG9hdDMyQXJyYXkoY291bnQpO1xufVxuXG5mdW5jdGlvbiBuZXdfZG91YmxlKGNvdW50KSB7XG4gICAgcmV0dXJuIG5ldyBGbG9hdDY0QXJyYXkoY291bnQpO1xufVxuXG5mdW5jdGlvbiBuZXdfZmxvYXRfbihhcmdzKSB7XG4gICAgaWYgKGFyZ3MubGVuZ3RoID09IDEpIHtcbiAgICAgICAgcmV0dXJuIG5ld19mbG9hdChhcmdzWzBdKTtcbiAgICB9XG4gICAgdmFyIHN6ID0gYXJnc1swXTtcbiAgICBhcmdzID0gYXJncy5zbGljZSgxKTtcbiAgICB2YXIgQSA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3o7IGkrKykge1xuICAgICAgICBBLnB1c2gobmV3X2Zsb2F0X24oYXJncykpO1xuICAgIH1cbiAgICByZXR1cm4gQTtcbn1cbmZ1bmN0aW9uIG5ld19pbnRfbihhcmdzKSB7XG4gICAgaWYgKGFyZ3MubGVuZ3RoID09IDEpIHtcbiAgICAgICAgcmV0dXJuIG5ld19pbnQoYXJnc1swXSk7XG4gICAgfVxuICAgIHZhciBzeiA9IGFyZ3NbMF07XG4gICAgYXJncyA9IGFyZ3Muc2xpY2UoMSk7XG4gICAgdmFyIEEgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN6OyBpKyspIHtcbiAgICAgICAgQS5wdXNoKG5ld19pbnRfbihhcmdzKSk7XG4gICAgfVxuICAgIHJldHVybiBBO1xufVxuXG5mdW5jdGlvbiBuZXdfc2hvcnRfbihhcmdzKSB7XG4gICAgaWYgKGFyZ3MubGVuZ3RoID09IDEpIHtcbiAgICAgICAgcmV0dXJuIG5ld19zaG9ydChhcmdzWzBdKTtcbiAgICB9XG4gICAgdmFyIHN6ID0gYXJnc1swXTtcbiAgICBhcmdzID0gYXJncy5zbGljZSgxKTtcbiAgICB2YXIgQSA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3o7IGkrKykge1xuICAgICAgICBBLnB1c2gobmV3X3Nob3J0X24oYXJncykpO1xuICAgIH1cbiAgICByZXR1cm4gQTtcbn1cblxuZnVuY3Rpb24gbmV3X2FycmF5X24oYXJncykge1xuICAgIGlmIChhcmdzLmxlbmd0aCA9PSAxKSB7XG4gICAgICAgIHJldHVybiBuZXcgQXJyYXkoYXJnc1swXSk7XG4gICAgfVxuICAgIHZhciBzeiA9IGFyZ3NbMF07XG4gICAgYXJncyA9IGFyZ3Muc2xpY2UoMSk7XG4gICAgdmFyIEEgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN6OyBpKyspIHtcbiAgICAgICAgQS5wdXNoKG5ld19hcnJheV9uKGFyZ3MpKTtcbiAgICB9XG4gICAgcmV0dXJuIEE7XG59XG5cblxudmFyIEFycmF5cyA9IHt9O1xuXG5BcnJheXMuZmlsbCA9IGZ1bmN0aW9uIChhLCBmcm9tSW5kZXgsIHRvSW5kZXgsIHZhbCkge1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDIpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhW2ldID0gYXJndW1lbnRzWzFdO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IGZyb21JbmRleDsgaSA8IHRvSW5kZXg7IGkrKykge1xuICAgICAgICAgICAgYVtpXSA9IHZhbDtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbnZhciBTeXN0ZW0gPSB7fTtcblxuU3lzdGVtLmFycmF5Y29weSA9IGZ1bmN0aW9uIChzcmMsIHNyY1BvcywgZGVzdCwgZGVzdFBvcywgbGVuZ3RoKSB7XG4gICAgdmFyIHNyY0VuZCA9IHNyY1BvcyArIGxlbmd0aDtcbiAgICB3aGlsZSAoc3JjUG9zIDwgc3JjRW5kKVxuICAgICAgICBkZXN0W2Rlc3RQb3MrK10gPSBzcmNbc3JjUG9zKytdO1xufTtcblxuXG52YXIgVXRpbCA9IHt9O1xuVXRpbC5TUVJUMiA9IDEuNDE0MjEzNTYyMzczMDk1MDQ4ODA7XG5VdGlsLkZBU1RfTE9HMTAgPSBmdW5jdGlvbiAoeCkge1xuICAgIHJldHVybiBNYXRoX2xvZzEwKHgpO1xufTtcblxuVXRpbC5GQVNUX0xPRzEwX1ggPSBmdW5jdGlvbiAoeCwgeSkge1xuICAgIHJldHVybiBNYXRoX2xvZzEwKHgpICogeTtcbn07XG5cbmZ1bmN0aW9uIFNob3J0QmxvY2sob3JkaW5hbCkge1xuICAgIHRoaXMub3JkaW5hbCA9IG9yZGluYWw7XG59XG4vKipcbiAqIExBTUUgbWF5IHVzZSB0aGVtLCBldmVuIGRpZmZlcmVudCBibG9jayB0eXBlcyBmb3IgTC9SLlxuICovXG5TaG9ydEJsb2NrLnNob3J0X2Jsb2NrX2FsbG93ZWQgPSBuZXcgU2hvcnRCbG9jaygwKTtcbi8qKlxuICogTEFNRSBtYXkgdXNlIHRoZW0sIGJ1dCBhbHdheXMgc2FtZSBibG9jayB0eXBlcyBpbiBML1IuXG4gKi9cblNob3J0QmxvY2suc2hvcnRfYmxvY2tfY291cGxlZCA9IG5ldyBTaG9ydEJsb2NrKDEpO1xuLyoqXG4gKiBMQU1FIHdpbGwgbm90IHVzZSBzaG9ydCBibG9ja3MsIGxvbmcgYmxvY2tzIG9ubHkuXG4gKi9cblNob3J0QmxvY2suc2hvcnRfYmxvY2tfZGlzcGVuc2VkID0gbmV3IFNob3J0QmxvY2soMik7XG4vKipcbiAqIExBTUUgd2lsbCBub3QgdXNlIGxvbmcgYmxvY2tzLCBzaG9ydCBibG9ja3Mgb25seS5cbiAqL1xuU2hvcnRCbG9jay5zaG9ydF9ibG9ja19mb3JjZWQgPSBuZXcgU2hvcnRCbG9jaygzKTtcblxudmFyIEZsb2F0ID0ge307XG5GbG9hdC5NQVhfVkFMVUUgPSAzLjQwMjgyMzVlKzM4O1xuXG5mdW5jdGlvbiBWYnJNb2RlKG9yZGluYWwpIHtcbiAgICB0aGlzLm9yZGluYWwgPSBvcmRpbmFsO1xufVxuVmJyTW9kZS52YnJfb2ZmID0gbmV3IFZick1vZGUoMCk7XG5WYnJNb2RlLnZicl9tdCA9IG5ldyBWYnJNb2RlKDEpO1xuVmJyTW9kZS52YnJfcmggPSBuZXcgVmJyTW9kZSgyKTtcblZick1vZGUudmJyX2FiciA9IG5ldyBWYnJNb2RlKDMpO1xuVmJyTW9kZS52YnJfbXRyaCA9IG5ldyBWYnJNb2RlKDQpO1xuVmJyTW9kZS52YnJfZGVmYXVsdCA9IFZick1vZGUudmJyX210cmg7XG5cbnZhciBhc3NlcnQgPSBmdW5jdGlvbiAoeCkge1xuICAgIC8vY29uc29sZS5hc3NlcnQoeCk7XG59O1xuXG52YXIgbW9kdWxlX2V4cG9ydHMgPSB7XG4gICAgXCJTeXN0ZW1cIjogU3lzdGVtLFxuICAgIFwiVmJyTW9kZVwiOiBWYnJNb2RlLFxuICAgIFwiRmxvYXRcIjogRmxvYXQsXG4gICAgXCJTaG9ydEJsb2NrXCI6IFNob3J0QmxvY2ssXG4gICAgXCJVdGlsXCI6IFV0aWwsXG4gICAgXCJBcnJheXNcIjogQXJyYXlzLFxuICAgIFwibmV3X2FycmF5X25cIjogbmV3X2FycmF5X24sXG4gICAgXCJuZXdfYnl0ZVwiOiBuZXdfYnl0ZSxcbiAgICBcIm5ld19kb3VibGVcIjogbmV3X2RvdWJsZSxcbiAgICBcIm5ld19mbG9hdFwiOiBuZXdfZmxvYXQsXG4gICAgXCJuZXdfZmxvYXRfblwiOiBuZXdfZmxvYXRfbixcbiAgICBcIm5ld19pbnRcIjogbmV3X2ludCxcbiAgICBcIm5ld19pbnRfblwiOiBuZXdfaW50X24sXG4gICAgXCJuZXdfc2hvcnRcIjogbmV3X3Nob3J0LFxuICAgIFwibmV3X3Nob3J0X25cIjogbmV3X3Nob3J0X24sXG4gICAgXCJhc3NlcnRcIjogYXNzZXJ0XG59O1xuLy9wYWNrYWdlIG1wMztcblxuLyogTVBFRyBtb2RlcyAqL1xuZnVuY3Rpb24gTVBFR01vZGUob3JkaW5hbCkge1xuICAgIHZhciBfb3JkaW5hbCA9IG9yZGluYWw7XG4gICAgdGhpcy5vcmRpbmFsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX29yZGluYWw7XG4gICAgfVxufVxuXG5NUEVHTW9kZS5TVEVSRU8gPSBuZXcgTVBFR01vZGUoMCk7XG5NUEVHTW9kZS5KT0lOVF9TVEVSRU8gPSBuZXcgTVBFR01vZGUoMSk7XG5NUEVHTW9kZS5EVUFMX0NIQU5ORUwgPSBuZXcgTVBFR01vZGUoMik7XG5NUEVHTW9kZS5NT05PID0gbmV3IE1QRUdNb2RlKDMpO1xuTVBFR01vZGUuTk9UX1NFVCA9IG5ldyBNUEVHTW9kZSg0KTtcblxuZnVuY3Rpb24gVmVyc2lvbigpIHtcblxuICAgIC8qKlxuICAgICAqIFVSTCBmb3IgdGhlIExBTUUgd2Vic2l0ZS5cbiAgICAgKi9cbiAgICB2YXIgTEFNRV9VUkwgPSBcImh0dHA6Ly93d3cubXAzZGV2Lm9yZy9cIjtcblxuICAgIC8qKlxuICAgICAqIE1ham9yIHZlcnNpb24gbnVtYmVyLlxuICAgICAqL1xuICAgIHZhciBMQU1FX01BSk9SX1ZFUlNJT04gPSAzO1xuICAgIC8qKlxuICAgICAqIE1pbm9yIHZlcnNpb24gbnVtYmVyLlxuICAgICAqL1xuICAgIHZhciBMQU1FX01JTk9SX1ZFUlNJT04gPSA5ODtcbiAgICAvKipcbiAgICAgKiBQYXRjaCBsZXZlbC5cbiAgICAgKi9cbiAgICB2YXIgTEFNRV9QQVRDSF9WRVJTSU9OID0gNDtcblxuICAgIC8qKlxuICAgICAqIE1ham9yIHZlcnNpb24gbnVtYmVyLlxuICAgICAqL1xuICAgIHZhciBQU1lfTUFKT1JfVkVSU0lPTiA9IDA7XG4gICAgLyoqXG4gICAgICogTWlub3IgdmVyc2lvbiBudW1iZXIuXG4gICAgICovXG4gICAgdmFyIFBTWV9NSU5PUl9WRVJTSU9OID0gOTM7XG5cbiAgICAvKipcbiAgICAgKiBBIHN0cmluZyB3aGljaCBkZXNjcmliZXMgdGhlIHZlcnNpb24gb2YgTEFNRS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4gc3RyaW5nIHdoaWNoIGRlc2NyaWJlcyB0aGUgdmVyc2lvbiBvZiBMQU1FXG4gICAgICovXG4gICAgdGhpcy5nZXRMYW1lVmVyc2lvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gcHJpbWFyeSB0byB3cml0ZSBzY3JlZW4gcmVwb3J0c1xuICAgICAgICByZXR1cm4gKExBTUVfTUFKT1JfVkVSU0lPTiArIFwiLlwiICsgTEFNRV9NSU5PUl9WRVJTSU9OICsgXCIuXCIgKyBMQU1FX1BBVENIX1ZFUlNJT04pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBzaG9ydCB2ZXJzaW9uIG9mIHRoZSBMQU1FIHZlcnNpb24gc3RyaW5nLlxuICAgICAqXG4gICAgICogQHJldHVybiBzaG9ydCB2ZXJzaW9uIG9mIHRoZSBMQU1FIHZlcnNpb24gc3RyaW5nXG4gICAgICovXG4gICAgdGhpcy5nZXRMYW1lU2hvcnRWZXJzaW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBBZGRpbmcgZGF0ZSBhbmQgdGltZSB0byB2ZXJzaW9uIHN0cmluZyBtYWtlcyBpdCBoYXJkZXIgZm9yIG91dHB1dFxuICAgICAgICAvLyB2YWxpZGF0aW9uXG4gICAgICAgIHJldHVybiAoTEFNRV9NQUpPUl9WRVJTSU9OICsgXCIuXCIgKyBMQU1FX01JTk9SX1ZFUlNJT04gKyBcIi5cIiArIExBTUVfUEFUQ0hfVkVSU0lPTik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIHNob3J0ZXN0IHZlcnNpb24gb2YgdGhlIExBTUUgdmVyc2lvbiBzdHJpbmcuXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHNob3J0ZXN0IHZlcnNpb24gb2YgdGhlIExBTUUgdmVyc2lvbiBzdHJpbmdcbiAgICAgKi9cbiAgICB0aGlzLmdldExhbWVWZXJ5U2hvcnRWZXJzaW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBBZGRpbmcgZGF0ZSBhbmQgdGltZSB0byB2ZXJzaW9uIHN0cmluZyBtYWtlcyBpdCBoYXJkZXIgZm9yIG91dHB1dFxuICAgICAgICByZXR1cm4gKFwiTEFNRVwiICsgTEFNRV9NQUpPUl9WRVJTSU9OICsgXCIuXCIgKyBMQU1FX01JTk9SX1ZFUlNJT04gKyBcInJcIik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RyaW5nIHdoaWNoIGRlc2NyaWJlcyB0aGUgdmVyc2lvbiBvZiBHUFNZQ0hPXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHN0cmluZyB3aGljaCBkZXNjcmliZXMgdGhlIHZlcnNpb24gb2YgR1BTWUNIT1xuICAgICAqL1xuICAgIHRoaXMuZ2V0UHN5VmVyc2lvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChQU1lfTUFKT1JfVkVSU0lPTiArIFwiLlwiICsgUFNZX01JTk9SX1ZFUlNJT04pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0cmluZyB3aGljaCBpcyBhIFVSTCBmb3IgdGhlIExBTUUgd2Vic2l0ZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm4gc3RyaW5nIHdoaWNoIGlzIGEgVVJMIGZvciB0aGUgTEFNRSB3ZWJzaXRlXG4gICAgICovXG4gICAgdGhpcy5nZXRMYW1lVXJsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gTEFNRV9VUkw7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUXVpdGUgdXNlbGVzcyBmb3IgYSBqYXZhIHZlcnNpb24sIGhvd2V2ZXIgd2UgYXJlIGNvbXBhdGlibGUgOy0pXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIFwiMzJiaXRzXCJcbiAgICAgKi9cbiAgICB0aGlzLmdldExhbWVPc0JpdG5lc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBcIjMyYml0c1wiO1xuICAgIH1cblxufVxuXG4vKlxuICpcdE1QMyBodWZmbWFuIHRhYmxlIHNlbGVjdGluZyBhbmQgYml0IGNvdW50aW5nXG4gKlxuICpcdENvcHlyaWdodCAoYykgMTk5OS0yMDA1IFRha2VoaXJvIFRPTUlOQUdBXG4gKlx0Q29weXJpZ2h0IChjKSAyMDAyLTIwMDUgR2FicmllbCBCb3V2aWduZVxuICpcbiAqIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3JcbiAqIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWNcbiAqIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlclxuICogdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLlxuICpcbiAqIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLFxuICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2ZcbiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS5cdCBTZWUgdGhlIEdOVVxuICogTGlicmFyeSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuXG4gKlxuICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpY1xuICogTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCB3cml0ZSB0byB0aGVcbiAqIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgSW5jLiwgNTkgVGVtcGxlIFBsYWNlIC0gU3VpdGUgMzMwLFxuICogQm9zdG9uLCBNQSAwMjExMS0xMzA3LCBVU0EuXG4gKi9cblxuLyogJElkOiBUYWtlaGlyby5qYXZhLHYgMS4yNiAyMDExLzA1LzI0IDIwOjQ4OjA2IGtlbmNoaXMgRXhwICQgKi9cblxuLy9wYWNrYWdlIG1wMztcblxuLy9pbXBvcnQgamF2YS51dGlsLkFycmF5cztcblxuXG5cbmZ1bmN0aW9uIFRha2VoaXJvKCkge1xuXG4gICAgdmFyIHF1cHZ0ID0gbnVsbDtcbiAgICB0aGlzLnF1cHZ0ID0gbnVsbDtcblxuICAgIHRoaXMuc2V0TW9kdWxlcyA9IGZ1bmN0aW9uIChfcXVwdnQpIHtcbiAgICAgICAgdGhpcy5xdXB2dCA9IF9xdXB2dDtcbiAgICAgICAgcXVwdnQgPSBfcXVwdnQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gQml0cyhiKSB7XG4gICAgICAgIHRoaXMuYml0cyA9IDAgfCBiO1xuICAgIH1cblxuICAgIHZhciBzdWJkdl90YWJsZSA9IFtbMCwgMF0sIC8qIDAgYmFuZHMgKi9cbiAgICAgICAgWzAsIDBdLCAvKiAxIGJhbmRzICovXG4gICAgICAgIFswLCAwXSwgLyogMiBiYW5kcyAqL1xuICAgICAgICBbMCwgMF0sIC8qIDMgYmFuZHMgKi9cbiAgICAgICAgWzAsIDBdLCAvKiA0IGJhbmRzICovXG4gICAgICAgIFswLCAxXSwgLyogNSBiYW5kcyAqL1xuICAgICAgICBbMSwgMV0sIC8qIDYgYmFuZHMgKi9cbiAgICAgICAgWzEsIDFdLCAvKiA3IGJhbmRzICovXG4gICAgICAgIFsxLCAyXSwgLyogOCBiYW5kcyAqL1xuICAgICAgICBbMiwgMl0sIC8qIDkgYmFuZHMgKi9cbiAgICAgICAgWzIsIDNdLCAvKiAxMCBiYW5kcyAqL1xuICAgICAgICBbMiwgM10sIC8qIDExIGJhbmRzICovXG4gICAgICAgIFszLCA0XSwgLyogMTIgYmFuZHMgKi9cbiAgICAgICAgWzMsIDRdLCAvKiAxMyBiYW5kcyAqL1xuICAgICAgICBbMywgNF0sIC8qIDE0IGJhbmRzICovXG4gICAgICAgIFs0LCA1XSwgLyogMTUgYmFuZHMgKi9cbiAgICAgICAgWzQsIDVdLCAvKiAxNiBiYW5kcyAqL1xuICAgICAgICBbNCwgNl0sIC8qIDE3IGJhbmRzICovXG4gICAgICAgIFs1LCA2XSwgLyogMTggYmFuZHMgKi9cbiAgICAgICAgWzUsIDZdLCAvKiAxOSBiYW5kcyAqL1xuICAgICAgICBbNSwgN10sIC8qIDIwIGJhbmRzICovXG4gICAgICAgIFs2LCA3XSwgLyogMjEgYmFuZHMgKi9cbiAgICAgICAgWzYsIDddLCAvKiAyMiBiYW5kcyAqL1xuICAgIF07XG5cblxuICAgIC8qKlxuICAgICAqIG5vbmxpbmVhciBxdWFudGl6YXRpb24gb2YgeHIgTW9yZSBhY2N1cmF0ZSBmb3JtdWxhIHRoYW4gdGhlIElTTyBmb3JtdWxhLlxuICAgICAqIFRha2VzIGludG8gYWNjb3VudCB0aGUgZmFjdCB0aGF0IHdlIGFyZSBxdWFudGl6aW5nIHhyIC4gaXgsIGJ1dCB3ZSB3YW50XG4gICAgICogaXheNC8zIHRvIGJlIGFzIGNsb3NlIGFzIHBvc3NpYmxlIHRvIHheNC8zLiAodGFraW5nIHRoZSBuZWFyZXN0IGludCB3b3VsZFxuICAgICAqIG1lYW4gaXggaXMgYXMgY2xvc2UgYXMgcG9zc2libGUgdG8geHIsIHdoaWNoIGlzIGRpZmZlcmVudC4pXG4gICAgICpcbiAgICAgKiBGcm9tIFNlZ2hlciBCb2Vzc2Vua29vbCA8c2VnaGVyQGVhc3RzaXRlLm5sPiAxMS8xOTk5XG4gICAgICpcbiAgICAgKiAwOS8yMDAwOiBBU00gY29kZSByZW1vdmVkIGluIGZhdm9yIG9mIElFRUU3NTQgaGFjayBieSBUYWtlaGlybyBUb21pbmFnYS5cbiAgICAgKiBJZiB5b3UgbmVlZCB0aGUgQVNNIGNvZGUsIGNoZWNrIENWUyBjaXJjYSBBdWcgMjAwMC5cbiAgICAgKlxuICAgICAqIDAxLzIwMDQ6IE9wdGltaXphdGlvbnMgYnkgR2FicmllbCBCb3V2aWduZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHF1YW50aXplX2xpbmVzX3hycG93XzAxKGwsIGlzdGVwLCB4ciwgeHJQb3MsIGl4LCBpeFBvcykge1xuICAgICAgICB2YXIgY29tcGFyZXZhbDAgPSAoMS4wIC0gMC40MDU0KSAvIGlzdGVwO1xuXG4gICAgICAgIGwgPSBsID4+IDE7XG4gICAgICAgIHdoaWxlICgobC0tKSAhPSAwKSB7XG4gICAgICAgICAgICBpeFtpeFBvcysrXSA9IChjb21wYXJldmFsMCA+IHhyW3hyUG9zKytdKSA/IDAgOiAxO1xuICAgICAgICAgICAgaXhbaXhQb3MrK10gPSAoY29tcGFyZXZhbDAgPiB4clt4clBvcysrXSkgPyAwIDogMTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFhSUE9XX0ZUT0kgaXMgYSBtYWNybyB0byBjb252ZXJ0IGZsb2F0cyB0byBpbnRzLjxCUj5cbiAgICAgKiBpZiBYUlBPV19GVE9JKHgpID0gbmVhcmVzdF9pbnQoeCksIHRoZW4gUVVBTlRGQUMoeCk9YWRqNDNhc21beF08QlI+XG4gICAgICogUk9VTkRGQUM9IC0wLjA5NDY8QlI+XG4gICAgICpcbiAgICAgKiBpZiBYUlBPV19GVE9JKHgpID0gZmxvb3IoeCksIHRoZW4gUVVBTlRGQUMoeCk9YXNqNDNbeF08QlI+XG4gICAgICogUk9VTkRGQUM9MC40MDU0PEJSPlxuICAgICAqXG4gICAgICogTm90ZTogdXNpbmcgZmxvb3IoKSBvciAwfCBpcyBleHRyZW1lbHkgc2xvdy4gT24gbWFjaGluZXMgd2hlcmUgdGhlXG4gICAgICogVEFLRUhJUk9fSUVFRTc1NF9IQUNLIGNvZGUgYWJvdmUgZG9lcyBub3Qgd29yaywgaXQgaXMgd29ydGh3aWxlIHRvIHdyaXRlXG4gICAgICogc29tZSBBU00gZm9yIFhSUE9XX0ZUT0koKS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBxdWFudGl6ZV9saW5lc194cnBvdyhsLCBpc3RlcCwgeHIsIHhyUG9zLCBpeCwgaXhQb3MpIHtcblxuICAgICAgICBsID0gbCA+PiAxO1xuICAgICAgICB2YXIgcmVtYWluaW5nID0gbCAlIDI7XG4gICAgICAgIGwgPSBsID4+IDE7XG4gICAgICAgIHdoaWxlIChsLS0gIT0gMCkge1xuICAgICAgICAgICAgdmFyIHgwLCB4MSwgeDIsIHgzO1xuICAgICAgICAgICAgdmFyIHJ4MCwgcngxLCByeDIsIHJ4MztcblxuICAgICAgICAgICAgeDAgPSB4clt4clBvcysrXSAqIGlzdGVwO1xuICAgICAgICAgICAgeDEgPSB4clt4clBvcysrXSAqIGlzdGVwO1xuICAgICAgICAgICAgcngwID0gMCB8IHgwO1xuICAgICAgICAgICAgeDIgPSB4clt4clBvcysrXSAqIGlzdGVwO1xuICAgICAgICAgICAgcngxID0gMCB8IHgxO1xuICAgICAgICAgICAgeDMgPSB4clt4clBvcysrXSAqIGlzdGVwO1xuICAgICAgICAgICAgcngyID0gMCB8IHgyO1xuICAgICAgICAgICAgeDAgKz0gcXVwdnQuYWRqNDNbcngwXTtcbiAgICAgICAgICAgIHJ4MyA9IDAgfCB4MztcbiAgICAgICAgICAgIHgxICs9IHF1cHZ0LmFkajQzW3J4MV07XG4gICAgICAgICAgICBpeFtpeFBvcysrXSA9IDAgfCB4MDtcbiAgICAgICAgICAgIHgyICs9IHF1cHZ0LmFkajQzW3J4Ml07XG4gICAgICAgICAgICBpeFtpeFBvcysrXSA9IDAgfCB4MTtcbiAgICAgICAgICAgIHgzICs9IHF1cHZ0LmFkajQzW3J4M107XG4gICAgICAgICAgICBpeFtpeFBvcysrXSA9IDAgfCB4MjtcbiAgICAgICAgICAgIGl4W2l4UG9zKytdID0gMCB8IHgzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZW1haW5pbmcgIT0gMCkge1xuICAgICAgICAgICAgdmFyIHgwLCB4MTtcbiAgICAgICAgICAgIHZhciByeDAsIHJ4MTtcblxuICAgICAgICAgICAgeDAgPSB4clt4clBvcysrXSAqIGlzdGVwO1xuICAgICAgICAgICAgeDEgPSB4clt4clBvcysrXSAqIGlzdGVwO1xuICAgICAgICAgICAgcngwID0gMCB8IHgwO1xuICAgICAgICAgICAgcngxID0gMCB8IHgxO1xuICAgICAgICAgICAgeDAgKz0gcXVwdnQuYWRqNDNbcngwXTtcbiAgICAgICAgICAgIHgxICs9IHF1cHZ0LmFkajQzW3J4MV07XG4gICAgICAgICAgICBpeFtpeFBvcysrXSA9IDAgfCB4MDtcbiAgICAgICAgICAgIGl4W2l4UG9zKytdID0gMCB8IHgxO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUXVhbnRpemF0aW9uIGZ1bmN0aW9uIFRoaXMgZnVuY3Rpb24gd2lsbCBzZWxlY3Qgd2hpY2ggbGluZXMgdG8gcXVhbnRpemVcbiAgICAgKiBhbmQgY2FsbCB0aGUgcHJvcGVyIHF1YW50aXphdGlvbiBmdW5jdGlvblxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHF1YW50aXplX3hycG93KHhwLCBwaSwgaXN0ZXAsIGNvZEluZm8sIHByZXZOb2lzZSkge1xuICAgICAgICAvKiBxdWFudGl6ZSBvbiB4cl4oMy80KSBpbnN0ZWFkIG9mIHhyICovXG4gICAgICAgIHZhciBzZmI7XG4gICAgICAgIHZhciBzZmJtYXg7XG4gICAgICAgIHZhciBqID0gMDtcbiAgICAgICAgdmFyIHByZXZfZGF0YV91c2U7XG4gICAgICAgIHZhciBhY2N1bXVsYXRlID0gMDtcbiAgICAgICAgdmFyIGFjY3VtdWxhdGUwMSA9IDA7XG4gICAgICAgIHZhciB4cFBvcyA9IDA7XG4gICAgICAgIHZhciBpRGF0YSA9IHBpO1xuICAgICAgICB2YXIgaURhdGFQb3MgPSAwO1xuICAgICAgICB2YXIgYWNjX2lEYXRhID0gaURhdGE7XG4gICAgICAgIHZhciBhY2NfaURhdGFQb3MgPSAwO1xuICAgICAgICB2YXIgYWNjX3hwID0geHA7XG4gICAgICAgIHZhciBhY2NfeHBQb3MgPSAwO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIFJldXNpbmcgcHJldmlvdXNseSBjb21wdXRlZCBkYXRhIGRvZXMgbm90IHNlZW1zIHRvIHdvcmsgaWYgZ2xvYmFsXG4gICAgICAgICAqIGdhaW4gaXMgY2hhbmdlZC4gRmluZGluZyB3aHkgaXQgYmVoYXZlcyB0aGlzIHdheSB3b3VsZCBhbGxvdyB0byB1c2UgYVxuICAgICAgICAgKiBjYWNoZSBvZiBwcmV2aW91c2x5IGNvbXB1dGVkIHZhbHVlcyAobGV0J3MgMTAgY2FjaGVkIHZhbHVlcyBwZXIgc2ZiKVxuICAgICAgICAgKiB0aGF0IHdvdWxkIHByb2JhYmx5IHByb3ZpZGUgYSBub3RpY2VhYmxlIHNwZWVkdXBcbiAgICAgICAgICovXG4gICAgICAgIHByZXZfZGF0YV91c2UgPSAocHJldk5vaXNlICE9IG51bGwgJiYgKGNvZEluZm8uZ2xvYmFsX2dhaW4gPT0gcHJldk5vaXNlLmdsb2JhbF9nYWluKSk7XG5cbiAgICAgICAgaWYgKGNvZEluZm8uYmxvY2tfdHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpXG4gICAgICAgICAgICBzZmJtYXggPSAzODtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgc2ZibWF4ID0gMjE7XG5cbiAgICAgICAgZm9yIChzZmIgPSAwOyBzZmIgPD0gc2ZibWF4OyBzZmIrKykge1xuICAgICAgICAgICAgdmFyIHN0ZXAgPSAtMTtcblxuICAgICAgICAgICAgaWYgKHByZXZfZGF0YV91c2UgfHwgY29kSW5mby5ibG9ja190eXBlID09IEVuY29kZXIuTk9STV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgc3RlcCA9IGNvZEluZm8uZ2xvYmFsX2dhaW5cbiAgICAgICAgICAgICAgICAgICAgLSAoKGNvZEluZm8uc2NhbGVmYWNbc2ZiXSArIChjb2RJbmZvLnByZWZsYWcgIT0gMCA/IHF1cHZ0LnByZXRhYltzZmJdXG4gICAgICAgICAgICAgICAgICAgICAgICA6IDApKSA8PCAoY29kSW5mby5zY2FsZWZhY19zY2FsZSArIDEpKVxuICAgICAgICAgICAgICAgICAgICAtIGNvZEluZm8uc3ViYmxvY2tfZ2Fpbltjb2RJbmZvLndpbmRvd1tzZmJdXSAqIDg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocHJldl9kYXRhX3VzZSAmJiAocHJldk5vaXNlLnN0ZXBbc2ZiXSA9PSBzdGVwKSkge1xuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogZG8gbm90IHJlY29tcHV0ZSB0aGlzIHBhcnQsIGJ1dCBjb21wdXRlIGFjY3VtdWxhdGVkIGxpbmVzXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgaWYgKGFjY3VtdWxhdGUgIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBxdWFudGl6ZV9saW5lc194cnBvdyhhY2N1bXVsYXRlLCBpc3RlcCwgYWNjX3hwLCBhY2NfeHBQb3MsXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NfaURhdGEsIGFjY19pRGF0YVBvcyk7XG4gICAgICAgICAgICAgICAgICAgIGFjY3VtdWxhdGUgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoYWNjdW11bGF0ZTAxICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcXVhbnRpemVfbGluZXNfeHJwb3dfMDEoYWNjdW11bGF0ZTAxLCBpc3RlcCwgYWNjX3hwLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjX3hwUG9zLCBhY2NfaURhdGEsIGFjY19pRGF0YVBvcyk7XG4gICAgICAgICAgICAgICAgICAgIGFjY3VtdWxhdGUwMSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHsgLyogc2hvdWxkIGNvbXB1dGUgdGhpcyBwYXJ0ICovXG4gICAgICAgICAgICAgICAgdmFyIGwgPSBjb2RJbmZvLndpZHRoW3NmYl07XG5cbiAgICAgICAgICAgICAgICBpZiAoKGogKyBjb2RJbmZvLndpZHRoW3NmYl0pID4gY29kSW5mby5tYXhfbm9uemVyb19jb2VmZikge1xuICAgICAgICAgICAgICAgICAgICAvKiBkbyBub3QgY29tcHV0ZSB1cHBlciB6ZXJvIHBhcnQgKi9cbiAgICAgICAgICAgICAgICAgICAgdmFyIHVzZWZ1bGxzaXplO1xuICAgICAgICAgICAgICAgICAgICB1c2VmdWxsc2l6ZSA9IGNvZEluZm8ubWF4X25vbnplcm9fY29lZmYgLSBqICsgMTtcbiAgICAgICAgICAgICAgICAgICAgQXJyYXlzLmZpbGwocGksIGNvZEluZm8ubWF4X25vbnplcm9fY29lZmYsIDU3NiwgMCk7XG4gICAgICAgICAgICAgICAgICAgIGwgPSB1c2VmdWxsc2l6ZTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAobCA8IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGwgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLyogbm8gbmVlZCB0byBjb21wdXRlIGhpZ2hlciBzZmIgdmFsdWVzICovXG4gICAgICAgICAgICAgICAgICAgIHNmYiA9IHNmYm1heCArIDE7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyogYWNjdW11bGF0ZSBsaW5lcyB0byBxdWFudGl6ZSAqL1xuICAgICAgICAgICAgICAgIGlmICgwID09IGFjY3VtdWxhdGUgJiYgMCA9PSBhY2N1bXVsYXRlMDEpIHtcbiAgICAgICAgICAgICAgICAgICAgYWNjX2lEYXRhID0gaURhdGE7XG4gICAgICAgICAgICAgICAgICAgIGFjY19pRGF0YVBvcyA9IGlEYXRhUG9zO1xuICAgICAgICAgICAgICAgICAgICBhY2NfeHAgPSB4cDtcbiAgICAgICAgICAgICAgICAgICAgYWNjX3hwUG9zID0geHBQb3M7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChwcmV2Tm9pc2UgIT0gbnVsbCAmJiBwcmV2Tm9pc2Uuc2ZiX2NvdW50MSA+IDBcbiAgICAgICAgICAgICAgICAgICAgJiYgc2ZiID49IHByZXZOb2lzZS5zZmJfY291bnQxXG4gICAgICAgICAgICAgICAgICAgICYmIHByZXZOb2lzZS5zdGVwW3NmYl0gPiAwXG4gICAgICAgICAgICAgICAgICAgICYmIHN0ZXAgPj0gcHJldk5vaXNlLnN0ZXBbc2ZiXSkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChhY2N1bXVsYXRlICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXplX2xpbmVzX3hycG93KGFjY3VtdWxhdGUsIGlzdGVwLCBhY2NfeHAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjX3hwUG9zLCBhY2NfaURhdGEsIGFjY19pRGF0YVBvcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY19pRGF0YSA9IGlEYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjX2lEYXRhUG9zID0gaURhdGFQb3M7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NfeHAgPSB4cDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY194cFBvcyA9IHhwUG9zO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGFjY3VtdWxhdGUwMSArPSBsO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhY2N1bXVsYXRlMDEgIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpemVfbGluZXNfeHJwb3dfMDEoYWNjdW11bGF0ZTAxLCBpc3RlcCwgYWNjX3hwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY194cFBvcywgYWNjX2lEYXRhLCBhY2NfaURhdGFQb3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZTAxID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY19pRGF0YSA9IGlEYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjX2lEYXRhUG9zID0gaURhdGFQb3M7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NfeHAgPSB4cDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY194cFBvcyA9IHhwUG9zO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGFjY3VtdWxhdGUgKz0gbDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAobCA8PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAqIHJoOiAyMDA0MDIxNSBtYXkgaGFwcGVuIGR1ZSB0byBcInByZXZfZGF0YV91c2VcIlxuICAgICAgICAgICAgICAgICAgICAgKiBvcHRpbWl6YXRpb25cbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGlmIChhY2N1bXVsYXRlMDEgIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpemVfbGluZXNfeHJwb3dfMDEoYWNjdW11bGF0ZTAxLCBpc3RlcCwgYWNjX3hwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY194cFBvcywgYWNjX2lEYXRhLCBhY2NfaURhdGFQb3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZTAxID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoYWNjdW11bGF0ZSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl6ZV9saW5lc194cnBvdyhhY2N1bXVsYXRlLCBpc3RlcCwgYWNjX3hwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY194cFBvcywgYWNjX2lEYXRhLCBhY2NfaURhdGFQb3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgLyogZW5kcyBmb3ItbG9vcCAqL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZmIgPD0gc2ZibWF4KSB7XG4gICAgICAgICAgICAgICAgaURhdGFQb3MgKz0gY29kSW5mby53aWR0aFtzZmJdO1xuICAgICAgICAgICAgICAgIHhwUG9zICs9IGNvZEluZm8ud2lkdGhbc2ZiXTtcbiAgICAgICAgICAgICAgICBqICs9IGNvZEluZm8ud2lkdGhbc2ZiXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoYWNjdW11bGF0ZSAhPSAwKSB7IC8qIGxhc3QgZGF0YSBwYXJ0ICovXG4gICAgICAgICAgICBxdWFudGl6ZV9saW5lc194cnBvdyhhY2N1bXVsYXRlLCBpc3RlcCwgYWNjX3hwLCBhY2NfeHBQb3MsXG4gICAgICAgICAgICAgICAgYWNjX2lEYXRhLCBhY2NfaURhdGFQb3MpO1xuICAgICAgICAgICAgYWNjdW11bGF0ZSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFjY3VtdWxhdGUwMSAhPSAwKSB7IC8qIGxhc3QgZGF0YSBwYXJ0ICovXG4gICAgICAgICAgICBxdWFudGl6ZV9saW5lc194cnBvd18wMShhY2N1bXVsYXRlMDEsIGlzdGVwLCBhY2NfeHAsIGFjY194cFBvcyxcbiAgICAgICAgICAgICAgICBhY2NfaURhdGEsIGFjY19pRGF0YVBvcyk7XG4gICAgICAgICAgICBhY2N1bXVsYXRlMDEgPSAwO1xuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBpeF9tYXhcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpeF9tYXgoaXgsIGl4UG9zLCBlbmRQb3MpIHtcbiAgICAgICAgdmFyIG1heDEgPSAwLCBtYXgyID0gMDtcblxuICAgICAgICBkbyB7XG4gICAgICAgICAgICB2YXIgeDEgPSBpeFtpeFBvcysrXTtcbiAgICAgICAgICAgIHZhciB4MiA9IGl4W2l4UG9zKytdO1xuICAgICAgICAgICAgaWYgKG1heDEgPCB4MSlcbiAgICAgICAgICAgICAgICBtYXgxID0geDE7XG5cbiAgICAgICAgICAgIGlmIChtYXgyIDwgeDIpXG4gICAgICAgICAgICAgICAgbWF4MiA9IHgyO1xuICAgICAgICB9IHdoaWxlIChpeFBvcyA8IGVuZFBvcyk7XG4gICAgICAgIGlmIChtYXgxIDwgbWF4MilcbiAgICAgICAgICAgIG1heDEgPSBtYXgyO1xuICAgICAgICByZXR1cm4gbWF4MTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb3VudF9iaXRfRVNDKGl4LCBpeFBvcywgZW5kLCB0MSwgdDIsIHMpIHtcbiAgICAgICAgLyogRVNDLXRhYmxlIGlzIHVzZWQgKi9cbiAgICAgICAgdmFyIGxpbmJpdHMgPSBUYWJsZXMuaHRbdDFdLnhsZW4gKiA2NTUzNiArIFRhYmxlcy5odFt0Ml0ueGxlbjtcbiAgICAgICAgdmFyIHN1bSA9IDAsIHN1bTI7XG5cbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgdmFyIHggPSBpeFtpeFBvcysrXTtcbiAgICAgICAgICAgIHZhciB5ID0gaXhbaXhQb3MrK107XG5cbiAgICAgICAgICAgIGlmICh4ICE9IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoeCA+IDE0KSB7XG4gICAgICAgICAgICAgICAgICAgIHggPSAxNTtcbiAgICAgICAgICAgICAgICAgICAgc3VtICs9IGxpbmJpdHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHggKj0gMTY7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh5ICE9IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoeSA+IDE0KSB7XG4gICAgICAgICAgICAgICAgICAgIHkgPSAxNTtcbiAgICAgICAgICAgICAgICAgICAgc3VtICs9IGxpbmJpdHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHggKz0geTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc3VtICs9IFRhYmxlcy5sYXJnZXRibFt4XTtcbiAgICAgICAgfSB3aGlsZSAoaXhQb3MgPCBlbmQpO1xuXG4gICAgICAgIHN1bTIgPSBzdW0gJiAweGZmZmY7XG4gICAgICAgIHN1bSA+Pj0gMTY7XG5cbiAgICAgICAgaWYgKHN1bSA+IHN1bTIpIHtcbiAgICAgICAgICAgIHN1bSA9IHN1bTI7XG4gICAgICAgICAgICB0MSA9IHQyO1xuICAgICAgICB9XG5cbiAgICAgICAgcy5iaXRzICs9IHN1bTtcbiAgICAgICAgcmV0dXJuIHQxO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvdW50X2JpdF9ub0VTQyhpeCwgaXhQb3MsIGVuZCwgcykge1xuICAgICAgICAvKiBObyBFU0Mtd29yZHMgKi9cbiAgICAgICAgdmFyIHN1bTEgPSAwO1xuICAgICAgICB2YXIgaGxlbjEgPSBUYWJsZXMuaHRbMV0uaGxlbjtcblxuICAgICAgICBkbyB7XG4gICAgICAgICAgICB2YXIgeCA9IGl4W2l4UG9zICsgMF0gKiAyICsgaXhbaXhQb3MgKyAxXTtcbiAgICAgICAgICAgIGl4UG9zICs9IDI7XG4gICAgICAgICAgICBzdW0xICs9IGhsZW4xW3hdO1xuICAgICAgICB9IHdoaWxlIChpeFBvcyA8IGVuZCk7XG5cbiAgICAgICAgcy5iaXRzICs9IHN1bTE7XG4gICAgICAgIHJldHVybiAxO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvdW50X2JpdF9ub0VTQ19mcm9tMihpeCwgaXhQb3MsIGVuZCwgdDEsIHMpIHtcbiAgICAgICAgLyogTm8gRVNDLXdvcmRzICovXG4gICAgICAgIHZhciBzdW0gPSAwLCBzdW0yO1xuICAgICAgICB2YXIgeGxlbiA9IFRhYmxlcy5odFt0MV0ueGxlbjtcbiAgICAgICAgdmFyIGhsZW47XG4gICAgICAgIGlmICh0MSA9PSAyKVxuICAgICAgICAgICAgaGxlbiA9IFRhYmxlcy50YWJsZTIzO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBobGVuID0gVGFibGVzLnRhYmxlNTY7XG5cbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgdmFyIHggPSBpeFtpeFBvcyArIDBdICogeGxlbiArIGl4W2l4UG9zICsgMV07XG4gICAgICAgICAgICBpeFBvcyArPSAyO1xuICAgICAgICAgICAgc3VtICs9IGhsZW5beF07XG4gICAgICAgIH0gd2hpbGUgKGl4UG9zIDwgZW5kKTtcblxuICAgICAgICBzdW0yID0gc3VtICYgMHhmZmZmO1xuICAgICAgICBzdW0gPj49IDE2O1xuXG4gICAgICAgIGlmIChzdW0gPiBzdW0yKSB7XG4gICAgICAgICAgICBzdW0gPSBzdW0yO1xuICAgICAgICAgICAgdDErKztcbiAgICAgICAgfVxuXG4gICAgICAgIHMuYml0cyArPSBzdW07XG4gICAgICAgIHJldHVybiB0MTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb3VudF9iaXRfbm9FU0NfZnJvbTMoaXgsIGl4UG9zLCBlbmQsIHQxLCBzKSB7XG4gICAgICAgIC8qIE5vIEVTQy13b3JkcyAqL1xuICAgICAgICB2YXIgc3VtMSA9IDA7XG4gICAgICAgIHZhciBzdW0yID0gMDtcbiAgICAgICAgdmFyIHN1bTMgPSAwO1xuICAgICAgICB2YXIgeGxlbiA9IFRhYmxlcy5odFt0MV0ueGxlbjtcbiAgICAgICAgdmFyIGhsZW4xID0gVGFibGVzLmh0W3QxXS5obGVuO1xuICAgICAgICB2YXIgaGxlbjIgPSBUYWJsZXMuaHRbdDEgKyAxXS5obGVuO1xuICAgICAgICB2YXIgaGxlbjMgPSBUYWJsZXMuaHRbdDEgKyAyXS5obGVuO1xuXG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIHZhciB4ID0gaXhbaXhQb3MgKyAwXSAqIHhsZW4gKyBpeFtpeFBvcyArIDFdO1xuICAgICAgICAgICAgaXhQb3MgKz0gMjtcbiAgICAgICAgICAgIHN1bTEgKz0gaGxlbjFbeF07XG4gICAgICAgICAgICBzdW0yICs9IGhsZW4yW3hdO1xuICAgICAgICAgICAgc3VtMyArPSBobGVuM1t4XTtcbiAgICAgICAgfSB3aGlsZSAoaXhQb3MgPCBlbmQpO1xuICAgICAgICB2YXIgdCA9IHQxO1xuICAgICAgICBpZiAoc3VtMSA+IHN1bTIpIHtcbiAgICAgICAgICAgIHN1bTEgPSBzdW0yO1xuICAgICAgICAgICAgdCsrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzdW0xID4gc3VtMykge1xuICAgICAgICAgICAgc3VtMSA9IHN1bTM7XG4gICAgICAgICAgICB0ID0gdDEgKyAyO1xuICAgICAgICB9XG4gICAgICAgIHMuYml0cyArPSBzdW0xO1xuXG4gICAgICAgIHJldHVybiB0O1xuICAgIH1cblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgIC8qIGNob29zZSB0YWJsZSAqL1xuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgdmFyIGh1Zl90Ymxfbm9FU0MgPSBbMSwgMiwgNSwgNywgNywgMTAsIDEwLCAxMywgMTMsXG4gICAgICAgIDEzLCAxMywgMTMsIDEzLCAxMywgMTNdO1xuXG4gICAgLyoqXG4gICAgICogQ2hvb3NlIHRoZSBIdWZmbWFuIHRhYmxlIHRoYXQgd2lsbCBlbmNvZGUgaXhbYmVnaW4uLmVuZF0gd2l0aCB0aGUgZmV3ZXN0XG4gICAgICogYml0cy5cbiAgICAgKlxuICAgICAqIE5vdGU6IFRoaXMgY29kZSBjb250YWlucyBrbm93bGVkZ2UgYWJvdXQgdGhlIHNpemVzIGFuZCBjaGFyYWN0ZXJpc3RpY3Mgb2ZcbiAgICAgKiB0aGUgSHVmZm1hbiB0YWJsZXMgYXMgZGVmaW5lZCBpbiB0aGUgSVMgKFRhYmxlIEIuNyksIGFuZCB3aWxsIG5vdCB3b3JrXG4gICAgICogd2l0aCBhbnkgYXJiaXRyYXJ5IHRhYmxlcy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjaG9vc2VfdGFibGUoaXgsIGl4UG9zLCBlbmRQb3MsIHMpIHtcbiAgICAgICAgdmFyIG1heCA9IGl4X21heChpeCwgaXhQb3MsIGVuZFBvcyk7XG5cbiAgICAgICAgc3dpdGNoIChtYXgpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF4O1xuXG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvdW50X2JpdF9ub0VTQyhpeCwgaXhQb3MsIGVuZFBvcywgcyk7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICByZXR1cm4gY291bnRfYml0X25vRVNDX2Zyb20yKGl4LCBpeFBvcywgZW5kUG9zLFxuICAgICAgICAgICAgICAgICAgICBodWZfdGJsX25vRVNDW21heCAtIDFdLCBzKTtcblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgY2FzZSAxMDpcbiAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICBjYXNlIDEyOlxuICAgICAgICAgICAgY2FzZSAxMzpcbiAgICAgICAgICAgIGNhc2UgMTQ6XG4gICAgICAgICAgICBjYXNlIDE1OlxuICAgICAgICAgICAgICAgIHJldHVybiBjb3VudF9iaXRfbm9FU0NfZnJvbTMoaXgsIGl4UG9zLCBlbmRQb3MsXG4gICAgICAgICAgICAgICAgICAgIGh1Zl90Ymxfbm9FU0NbbWF4IC0gMV0sIHMpO1xuXG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIC8qIHRyeSB0YWJsZXMgd2l0aCBsaW5iaXRzICovXG4gICAgICAgICAgICAgICAgaWYgKG1heCA+IFF1YW50aXplUFZULklYTUFYX1ZBTCkge1xuICAgICAgICAgICAgICAgICAgICBzLmJpdHMgPSBRdWFudGl6ZVBWVC5MQVJHRV9CSVRTO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG1heCAtPSAxNTtcbiAgICAgICAgICAgICAgICB2YXIgY2hvaWNlMjtcbiAgICAgICAgICAgICAgICBmb3IgKGNob2ljZTIgPSAyNDsgY2hvaWNlMiA8IDMyOyBjaG9pY2UyKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKFRhYmxlcy5odFtjaG9pY2UyXS5saW5tYXggPj0gbWF4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgY2hvaWNlO1xuICAgICAgICAgICAgICAgIGZvciAoY2hvaWNlID0gY2hvaWNlMiAtIDg7IGNob2ljZSA8IDI0OyBjaG9pY2UrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoVGFibGVzLmh0W2Nob2ljZV0ubGlubWF4ID49IG1heCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvdW50X2JpdF9FU0MoaXgsIGl4UG9zLCBlbmRQb3MsIGNob2ljZSwgY2hvaWNlMiwgcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjb3VudF9iaXRcbiAgICAgKi9cbiAgICB0aGlzLm5vcXVhbnRfY291bnRfYml0cyA9IGZ1bmN0aW9uIChnZmMsIGdpLCBwcmV2X25vaXNlKSB7XG4gICAgICAgIHZhciBpeCA9IGdpLmwzX2VuYztcbiAgICAgICAgdmFyIGkgPSBNYXRoLm1pbig1NzYsICgoZ2kubWF4X25vbnplcm9fY29lZmYgKyAyKSA+PiAxKSA8PCAxKTtcblxuICAgICAgICBpZiAocHJldl9ub2lzZSAhPSBudWxsKVxuICAgICAgICAgICAgcHJldl9ub2lzZS5zZmJfY291bnQxID0gMDtcblxuICAgICAgICAvKiBEZXRlcm1pbmUgY291bnQxIHJlZ2lvbiAqL1xuICAgICAgICBmb3IgKDsgaSA+IDE7IGkgLT0gMilcbiAgICAgICAgICAgIGlmICgoaXhbaSAtIDFdIHwgaXhbaSAtIDJdKSAhPSAwKVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBnaS5jb3VudDEgPSBpO1xuXG4gICAgICAgIC8qIERldGVybWluZXMgdGhlIG51bWJlciBvZiBiaXRzIHRvIGVuY29kZSB0aGUgcXVhZHJ1cGxlcy4gKi9cbiAgICAgICAgdmFyIGExID0gMDtcbiAgICAgICAgdmFyIGEyID0gMDtcbiAgICAgICAgZm9yICg7IGkgPiAzOyBpIC09IDQpIHtcbiAgICAgICAgICAgIHZhciBwO1xuICAgICAgICAgICAgLyogaGFjayB0byBjaGVjayBpZiBhbGwgdmFsdWVzIDw9IDEgKi9cbiAgICAgICAgICAgIC8vdGhyb3cgXCJUT0RPOiBIQUNLICAgICAgICAgaWYgKCgoKGxvbmcpIGl4W2kgLSAxXSB8IChsb25nKSBpeFtpIC0gMl0gfCAobG9uZykgaXhbaSAtIDNdIHwgKGxvbmcpIGl4W2kgLSA0XSkgJiAweGZmZmZmZmZmTCkgPiAxTCAgICAgICAgXCJcbiAgICAgICAgICAgIC8vaWYgKHRydWUpIHtcbiAgICAgICAgICAgIGlmICgoKGl4W2kgLSAxXSB8IGl4W2kgLSAyXSB8IGl4W2kgLSAzXSB8IGl4W2kgLSA0XSkgJiAweDdmZmZmZmZmKSA+IDEpIHtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHAgPSAoKGl4W2kgLSA0XSAqIDIgKyBpeFtpIC0gM10pICogMiArIGl4W2kgLSAyXSkgKiAyICsgaXhbaSAtIDFdO1xuICAgICAgICAgICAgYTEgKz0gVGFibGVzLnQzMmxbcF07XG4gICAgICAgICAgICBhMiArPSBUYWJsZXMudDMzbFtwXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgYml0cyA9IGExO1xuICAgICAgICBnaS5jb3VudDF0YWJsZV9zZWxlY3QgPSAwO1xuICAgICAgICBpZiAoYTEgPiBhMikge1xuICAgICAgICAgICAgYml0cyA9IGEyO1xuICAgICAgICAgICAgZ2kuY291bnQxdGFibGVfc2VsZWN0ID0gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdpLmNvdW50MWJpdHMgPSBiaXRzO1xuICAgICAgICBnaS5iaWdfdmFsdWVzID0gaTtcbiAgICAgICAgaWYgKGkgPT0gMClcbiAgICAgICAgICAgIHJldHVybiBiaXRzO1xuXG4gICAgICAgIGlmIChnaS5ibG9ja190eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgYTEgPSAzICogZ2ZjLnNjYWxlZmFjX2JhbmQuc1szXTtcbiAgICAgICAgICAgIGlmIChhMSA+IGdpLmJpZ192YWx1ZXMpXG4gICAgICAgICAgICAgICAgYTEgPSBnaS5iaWdfdmFsdWVzO1xuICAgICAgICAgICAgYTIgPSBnaS5iaWdfdmFsdWVzO1xuXG4gICAgICAgIH0gZWxzZSBpZiAoZ2kuYmxvY2tfdHlwZSA9PSBFbmNvZGVyLk5PUk1fVFlQRSkge1xuICAgICAgICAgICAgLyogYnZfc2NmIGhhcyA1NzYgZW50cmllcyAoMC4uNTc1KSAqL1xuICAgICAgICAgICAgYTEgPSBnaS5yZWdpb24wX2NvdW50ID0gZ2ZjLmJ2X3NjZltpIC0gMl07XG4gICAgICAgICAgICBhMiA9IGdpLnJlZ2lvbjFfY291bnQgPSBnZmMuYnZfc2NmW2kgLSAxXTtcblxuICAgICAgICAgICAgYTIgPSBnZmMuc2NhbGVmYWNfYmFuZC5sW2ExICsgYTIgKyAyXTtcbiAgICAgICAgICAgIGExID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFthMSArIDFdO1xuICAgICAgICAgICAgaWYgKGEyIDwgaSkge1xuICAgICAgICAgICAgICAgIHZhciBiaSA9IG5ldyBCaXRzKGJpdHMpO1xuICAgICAgICAgICAgICAgIGdpLnRhYmxlX3NlbGVjdFsyXSA9IGNob29zZV90YWJsZShpeCwgYTIsIGksIGJpKTtcbiAgICAgICAgICAgICAgICBiaXRzID0gYmkuYml0cztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdpLnJlZ2lvbjBfY291bnQgPSA3O1xuICAgICAgICAgICAgLyogZ2kucmVnaW9uMV9jb3VudCA9IFNCUFNZX2wgLSA3IC0gMTsgKi9cbiAgICAgICAgICAgIGdpLnJlZ2lvbjFfY291bnQgPSBFbmNvZGVyLlNCTUFYX2wgLSAxIC0gNyAtIDE7XG4gICAgICAgICAgICBhMSA9IGdmYy5zY2FsZWZhY19iYW5kLmxbNyArIDFdO1xuICAgICAgICAgICAgYTIgPSBpO1xuICAgICAgICAgICAgaWYgKGExID4gYTIpIHtcbiAgICAgICAgICAgICAgICBhMSA9IGEyO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogaGF2ZSB0byBhbGxvdyBmb3IgdGhlIGNhc2Ugd2hlbiBiaWd2YWx1ZXMgPCByZWdpb24wIDwgcmVnaW9uMSAqL1xuICAgICAgICAvKiAoYW5kIHJlZ2lvbjAsIHJlZ2lvbjEgYXJlIGlnbm9yZWQpICovXG4gICAgICAgIGExID0gTWF0aC5taW4oYTEsIGkpO1xuICAgICAgICBhMiA9IE1hdGgubWluKGEyLCBpKTtcblxuXG4gICAgICAgIC8qIENvdW50IHRoZSBudW1iZXIgb2YgYml0cyBuZWNlc3NhcnkgdG8gY29kZSB0aGUgYmlndmFsdWVzIHJlZ2lvbi4gKi9cbiAgICAgICAgaWYgKDAgPCBhMSkge1xuICAgICAgICAgICAgdmFyIGJpID0gbmV3IEJpdHMoYml0cyk7XG4gICAgICAgICAgICBnaS50YWJsZV9zZWxlY3RbMF0gPSBjaG9vc2VfdGFibGUoaXgsIDAsIGExLCBiaSk7XG4gICAgICAgICAgICBiaXRzID0gYmkuYml0cztcbiAgICAgICAgfVxuICAgICAgICBpZiAoYTEgPCBhMikge1xuICAgICAgICAgICAgdmFyIGJpID0gbmV3IEJpdHMoYml0cyk7XG4gICAgICAgICAgICBnaS50YWJsZV9zZWxlY3RbMV0gPSBjaG9vc2VfdGFibGUoaXgsIGExLCBhMiwgYmkpO1xuICAgICAgICAgICAgYml0cyA9IGJpLmJpdHM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGdmYy51c2VfYmVzdF9odWZmbWFuID09IDIpIHtcbiAgICAgICAgICAgIGdpLnBhcnQyXzNfbGVuZ3RoID0gYml0cztcbiAgICAgICAgICAgIGJlc3RfaHVmZm1hbl9kaXZpZGUoZ2ZjLCBnaSk7XG4gICAgICAgICAgICBiaXRzID0gZ2kucGFydDJfM19sZW5ndGg7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocHJldl9ub2lzZSAhPSBudWxsKSB7XG4gICAgICAgICAgICBpZiAoZ2kuYmxvY2tfdHlwZSA9PSBFbmNvZGVyLk5PUk1fVFlQRSkge1xuICAgICAgICAgICAgICAgIHZhciBzZmIgPSAwO1xuICAgICAgICAgICAgICAgIHdoaWxlIChnZmMuc2NhbGVmYWNfYmFuZC5sW3NmYl0gPCBnaS5iaWdfdmFsdWVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHNmYisrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBwcmV2X25vaXNlLnNmYl9jb3VudDEgPSBzZmI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYml0cztcbiAgICB9XG5cbiAgICB0aGlzLmNvdW50X2JpdHMgPSBmdW5jdGlvbiAoZ2ZjLCB4ciwgZ2ksIHByZXZfbm9pc2UpIHtcbiAgICAgICAgdmFyIGl4ID0gZ2kubDNfZW5jO1xuXG4gICAgICAgIC8qIHNpbmNlIHF1YW50aXplX3hycG93IHVzZXMgdGFibGUgbG9va3VwLCB3ZSBuZWVkIHRvIGNoZWNrIHRoaXMgZmlyc3Q6ICovXG4gICAgICAgIHZhciB3ID0gKFF1YW50aXplUFZULklYTUFYX1ZBTCkgLyBxdXB2dC5JUE9XMjAoZ2kuZ2xvYmFsX2dhaW4pO1xuXG4gICAgICAgIGlmIChnaS54cnBvd19tYXggPiB3KVxuICAgICAgICAgICAgcmV0dXJuIFF1YW50aXplUFZULkxBUkdFX0JJVFM7XG5cbiAgICAgICAgcXVhbnRpemVfeHJwb3coeHIsIGl4LCBxdXB2dC5JUE9XMjAoZ2kuZ2xvYmFsX2dhaW4pLCBnaSwgcHJldl9ub2lzZSk7XG5cbiAgICAgICAgaWYgKChnZmMuc3Vic3RlcF9zaGFwaW5nICYgMikgIT0gMCkge1xuICAgICAgICAgICAgdmFyIGogPSAwO1xuICAgICAgICAgICAgLyogMC42MzQ1MjE2ODIyNDI0MzkgPSAwLjU5NDYqMioqKC41KjAuMTg3NSkgKi9cbiAgICAgICAgICAgIHZhciBnYWluID0gZ2kuZ2xvYmFsX2dhaW4gKyBnaS5zY2FsZWZhY19zY2FsZTtcbiAgICAgICAgICAgIHZhciByb3VuZGZhYyA9IDAuNjM0NTIxNjgyMjQyNDM5IC8gcXVwdnQuSVBPVzIwKGdhaW4pO1xuICAgICAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgZ2kuc2ZibWF4OyBzZmIrKykge1xuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGdpLndpZHRoW3NmYl07XG4gICAgICAgICAgICAgICAgaWYgKDAgPT0gZ2ZjLnBzZXVkb2hhbGZbc2ZiXSkge1xuICAgICAgICAgICAgICAgICAgICBqICs9IHdpZHRoO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBrO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGsgPSBqLCBqICs9IHdpZHRoOyBrIDwgajsgKytrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpeFtrXSA9ICh4cltrXSA+PSByb3VuZGZhYykgPyBpeFtrXSA6IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMubm9xdWFudF9jb3VudF9iaXRzKGdmYywgZ2ksIHByZXZfbm9pc2UpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHJlLWNhbGN1bGF0ZSB0aGUgYmVzdCBzY2FsZWZhY19jb21wcmVzcyB1c2luZyBzY2ZzaSB0aGUgc2F2ZWQgYml0cyBhcmVcbiAgICAgKiBrZXB0IGluIHRoZSBiaXQgcmVzZXJ2b2lyLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlY2FsY19kaXZpZGVfaW5pdChnZmMsIGNvZF9pbmZvLCBpeCwgcjAxX2JpdHMsIHIwMV9kaXYsIHIwX3RibCwgcjFfdGJsKSB7XG4gICAgICAgIHZhciBiaWd2ID0gY29kX2luZm8uYmlnX3ZhbHVlcztcblxuICAgICAgICBmb3IgKHZhciByMCA9IDA7IHIwIDw9IDcgKyAxNTsgcjArKykge1xuICAgICAgICAgICAgcjAxX2JpdHNbcjBdID0gUXVhbnRpemVQVlQuTEFSR0VfQklUUztcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIHIwID0gMDsgcjAgPCAxNjsgcjArKykge1xuICAgICAgICAgICAgdmFyIGExID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFtyMCArIDFdO1xuICAgICAgICAgICAgaWYgKGExID49IGJpZ3YpXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB2YXIgcjBiaXRzID0gMDtcbiAgICAgICAgICAgIHZhciBiaSA9IG5ldyBCaXRzKHIwYml0cyk7XG4gICAgICAgICAgICB2YXIgcjB0ID0gY2hvb3NlX3RhYmxlKGl4LCAwLCBhMSwgYmkpO1xuICAgICAgICAgICAgcjBiaXRzID0gYmkuYml0cztcblxuICAgICAgICAgICAgZm9yICh2YXIgcjEgPSAwOyByMSA8IDg7IHIxKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYTIgPSBnZmMuc2NhbGVmYWNfYmFuZC5sW3IwICsgcjEgKyAyXTtcbiAgICAgICAgICAgICAgICBpZiAoYTIgPj0gYmlndilcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgdmFyIGJpdHMgPSByMGJpdHM7XG4gICAgICAgICAgICAgICAgYmkgPSBuZXcgQml0cyhiaXRzKTtcbiAgICAgICAgICAgICAgICB2YXIgcjF0ID0gY2hvb3NlX3RhYmxlKGl4LCBhMSwgYTIsIGJpKTtcbiAgICAgICAgICAgICAgICBiaXRzID0gYmkuYml0cztcbiAgICAgICAgICAgICAgICBpZiAocjAxX2JpdHNbcjAgKyByMV0gPiBiaXRzKSB7XG4gICAgICAgICAgICAgICAgICAgIHIwMV9iaXRzW3IwICsgcjFdID0gYml0cztcbiAgICAgICAgICAgICAgICAgICAgcjAxX2RpdltyMCArIHIxXSA9IHIwO1xuICAgICAgICAgICAgICAgICAgICByMF90YmxbcjAgKyByMV0gPSByMHQ7XG4gICAgICAgICAgICAgICAgICAgIHIxX3RibFtyMCArIHIxXSA9IHIxdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZWNhbGNfZGl2aWRlX3N1YihnZmMsIGNvZF9pbmZvMiwgZ2ksIGl4LCByMDFfYml0cywgcjAxX2RpdiwgcjBfdGJsLCByMV90YmwpIHtcbiAgICAgICAgdmFyIGJpZ3YgPSBjb2RfaW5mbzIuYmlnX3ZhbHVlcztcblxuICAgICAgICBmb3IgKHZhciByMiA9IDI7IHIyIDwgRW5jb2Rlci5TQk1BWF9sICsgMTsgcjIrKykge1xuICAgICAgICAgICAgdmFyIGEyID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFtyMl07XG4gICAgICAgICAgICBpZiAoYTIgPj0gYmlndilcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIHZhciBiaXRzID0gcjAxX2JpdHNbcjIgLSAyXSArIGNvZF9pbmZvMi5jb3VudDFiaXRzO1xuICAgICAgICAgICAgaWYgKGdpLnBhcnQyXzNfbGVuZ3RoIDw9IGJpdHMpXG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIHZhciBiaSA9IG5ldyBCaXRzKGJpdHMpO1xuICAgICAgICAgICAgdmFyIHIydCA9IGNob29zZV90YWJsZShpeCwgYTIsIGJpZ3YsIGJpKTtcbiAgICAgICAgICAgIGJpdHMgPSBiaS5iaXRzO1xuICAgICAgICAgICAgaWYgKGdpLnBhcnQyXzNfbGVuZ3RoIDw9IGJpdHMpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgICAgIGdpLmFzc2lnbihjb2RfaW5mbzIpO1xuICAgICAgICAgICAgZ2kucGFydDJfM19sZW5ndGggPSBiaXRzO1xuICAgICAgICAgICAgZ2kucmVnaW9uMF9jb3VudCA9IHIwMV9kaXZbcjIgLSAyXTtcbiAgICAgICAgICAgIGdpLnJlZ2lvbjFfY291bnQgPSByMiAtIDIgLSByMDFfZGl2W3IyIC0gMl07XG4gICAgICAgICAgICBnaS50YWJsZV9zZWxlY3RbMF0gPSByMF90YmxbcjIgLSAyXTtcbiAgICAgICAgICAgIGdpLnRhYmxlX3NlbGVjdFsxXSA9IHIxX3RibFtyMiAtIDJdO1xuICAgICAgICAgICAgZ2kudGFibGVfc2VsZWN0WzJdID0gcjJ0O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5iZXN0X2h1ZmZtYW5fZGl2aWRlID0gZnVuY3Rpb24gKGdmYywgZ2kpIHtcbiAgICAgICAgdmFyIGNvZF9pbmZvMiA9IG5ldyBHckluZm8oKTtcbiAgICAgICAgdmFyIGl4ID0gZ2kubDNfZW5jO1xuICAgICAgICB2YXIgcjAxX2JpdHMgPSBuZXdfaW50KDcgKyAxNSArIDEpO1xuICAgICAgICB2YXIgcjAxX2RpdiA9IG5ld19pbnQoNyArIDE1ICsgMSk7XG4gICAgICAgIHZhciByMF90YmwgPSBuZXdfaW50KDcgKyAxNSArIDEpO1xuICAgICAgICB2YXIgcjFfdGJsID0gbmV3X2ludCg3ICsgMTUgKyAxKTtcblxuICAgICAgICAvKiBTSE9SVCBCTE9DSyBzdHVmZiBmYWlscyBmb3IgTVBFRzIgKi9cbiAgICAgICAgaWYgKGdpLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFICYmIGdmYy5tb2RlX2dyID09IDEpXG4gICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgY29kX2luZm8yLmFzc2lnbihnaSk7XG4gICAgICAgIGlmIChnaS5ibG9ja190eXBlID09IEVuY29kZXIuTk9STV9UWVBFKSB7XG4gICAgICAgICAgICByZWNhbGNfZGl2aWRlX2luaXQoZ2ZjLCBnaSwgaXgsIHIwMV9iaXRzLCByMDFfZGl2LCByMF90YmwsIHIxX3RibCk7XG4gICAgICAgICAgICByZWNhbGNfZGl2aWRlX3N1YihnZmMsIGNvZF9pbmZvMiwgZ2ksIGl4LCByMDFfYml0cywgcjAxX2RpdixcbiAgICAgICAgICAgICAgICByMF90YmwsIHIxX3RibCk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGkgPSBjb2RfaW5mbzIuYmlnX3ZhbHVlcztcbiAgICAgICAgaWYgKGkgPT0gMCB8fCAoaXhbaSAtIDJdIHwgaXhbaSAtIDFdKSA+IDEpXG4gICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgaSA9IGdpLmNvdW50MSArIDI7XG4gICAgICAgIGlmIChpID4gNTc2KVxuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIC8qIERldGVybWluZXMgdGhlIG51bWJlciBvZiBiaXRzIHRvIGVuY29kZSB0aGUgcXVhZHJ1cGxlcy4gKi9cbiAgICAgICAgY29kX2luZm8yLmFzc2lnbihnaSk7XG4gICAgICAgIGNvZF9pbmZvMi5jb3VudDEgPSBpO1xuICAgICAgICB2YXIgYTEgPSAwO1xuICAgICAgICB2YXIgYTIgPSAwO1xuXG5cbiAgICAgICAgZm9yICg7IGkgPiBjb2RfaW5mbzIuYmlnX3ZhbHVlczsgaSAtPSA0KSB7XG4gICAgICAgICAgICB2YXIgcCA9ICgoaXhbaSAtIDRdICogMiArIGl4W2kgLSAzXSkgKiAyICsgaXhbaSAtIDJdKSAqIDJcbiAgICAgICAgICAgICAgICArIGl4W2kgLSAxXTtcbiAgICAgICAgICAgIGExICs9IFRhYmxlcy50MzJsW3BdO1xuICAgICAgICAgICAgYTIgKz0gVGFibGVzLnQzM2xbcF07XG4gICAgICAgIH1cbiAgICAgICAgY29kX2luZm8yLmJpZ192YWx1ZXMgPSBpO1xuXG4gICAgICAgIGNvZF9pbmZvMi5jb3VudDF0YWJsZV9zZWxlY3QgPSAwO1xuICAgICAgICBpZiAoYTEgPiBhMikge1xuICAgICAgICAgICAgYTEgPSBhMjtcbiAgICAgICAgICAgIGNvZF9pbmZvMi5jb3VudDF0YWJsZV9zZWxlY3QgPSAxO1xuICAgICAgICB9XG5cbiAgICAgICAgY29kX2luZm8yLmNvdW50MWJpdHMgPSBhMTtcblxuICAgICAgICBpZiAoY29kX2luZm8yLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5OT1JNX1RZUEUpXG4gICAgICAgICAgICByZWNhbGNfZGl2aWRlX3N1YihnZmMsIGNvZF9pbmZvMiwgZ2ksIGl4LCByMDFfYml0cywgcjAxX2RpdixcbiAgICAgICAgICAgICAgICByMF90YmwsIHIxX3RibCk7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLyogQ291bnQgdGhlIG51bWJlciBvZiBiaXRzIG5lY2Vzc2FyeSB0byBjb2RlIHRoZSBiaWd2YWx1ZXMgcmVnaW9uLiAqL1xuICAgICAgICAgICAgY29kX2luZm8yLnBhcnQyXzNfbGVuZ3RoID0gYTE7XG4gICAgICAgICAgICBhMSA9IGdmYy5zY2FsZWZhY19iYW5kLmxbNyArIDFdO1xuICAgICAgICAgICAgaWYgKGExID4gaSkge1xuICAgICAgICAgICAgICAgIGExID0gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChhMSA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgYmkgPSBuZXcgQml0cyhjb2RfaW5mbzIucGFydDJfM19sZW5ndGgpO1xuICAgICAgICAgICAgICAgIGNvZF9pbmZvMi50YWJsZV9zZWxlY3RbMF0gPSBjaG9vc2VfdGFibGUoaXgsIDAsIGExLCBiaSk7XG4gICAgICAgICAgICAgICAgY29kX2luZm8yLnBhcnQyXzNfbGVuZ3RoID0gYmkuYml0cztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpID4gYTEpIHtcbiAgICAgICAgICAgICAgICB2YXIgYmkgPSBuZXcgQml0cyhjb2RfaW5mbzIucGFydDJfM19sZW5ndGgpO1xuICAgICAgICAgICAgICAgIGNvZF9pbmZvMi50YWJsZV9zZWxlY3RbMV0gPSBjaG9vc2VfdGFibGUoaXgsIGExLCBpLCBiaSk7XG4gICAgICAgICAgICAgICAgY29kX2luZm8yLnBhcnQyXzNfbGVuZ3RoID0gYmkuYml0cztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChnaS5wYXJ0Ml8zX2xlbmd0aCA+IGNvZF9pbmZvMi5wYXJ0Ml8zX2xlbmd0aClcbiAgICAgICAgICAgICAgICBnaS5hc3NpZ24oY29kX2luZm8yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciBzbGVuMV9uID0gWzEsIDEsIDEsIDEsIDgsIDIsIDIsIDIsIDQsIDQsIDQsIDgsIDgsIDgsIDE2LCAxNl07XG4gICAgdmFyIHNsZW4yX24gPSBbMSwgMiwgNCwgOCwgMSwgMiwgNCwgOCwgMiwgNCwgOCwgMiwgNCwgOCwgNCwgOF07XG4gICAgdmFyIHNsZW4xX3RhYiA9IFswLCAwLCAwLCAwLCAzLCAxLCAxLCAxLCAyLCAyLCAyLCAzLCAzLCAzLCA0LCA0XTtcbiAgICB2YXIgc2xlbjJfdGFiID0gWzAsIDEsIDIsIDMsIDAsIDEsIDIsIDMsIDEsIDIsIDMsIDEsIDIsIDMsIDIsIDNdO1xuICAgIFRha2VoaXJvLnNsZW4xX3RhYiA9IHNsZW4xX3RhYjtcbiAgICBUYWtlaGlyby5zbGVuMl90YWIgPSBzbGVuMl90YWI7XG5cbiAgICBmdW5jdGlvbiBzY2ZzaV9jYWxjKGNoLCBsM19zaWRlKSB7XG4gICAgICAgIHZhciBzZmI7XG4gICAgICAgIHZhciBnaSA9IGwzX3NpZGUudHRbMV1bY2hdO1xuICAgICAgICB2YXIgZzAgPSBsM19zaWRlLnR0WzBdW2NoXTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IFRhYmxlcy5zY2ZzaV9iYW5kLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICAgICAgZm9yIChzZmIgPSBUYWJsZXMuc2Nmc2lfYmFuZFtpXTsgc2ZiIDwgVGFibGVzLnNjZnNpX2JhbmRbaSArIDFdOyBzZmIrKykge1xuICAgICAgICAgICAgICAgIGlmIChnMC5zY2FsZWZhY1tzZmJdICE9IGdpLnNjYWxlZmFjW3NmYl1cbiAgICAgICAgICAgICAgICAgICAgJiYgZ2kuc2NhbGVmYWNbc2ZiXSA+PSAwKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzZmIgPT0gVGFibGVzLnNjZnNpX2JhbmRbaSArIDFdKSB7XG4gICAgICAgICAgICAgICAgZm9yIChzZmIgPSBUYWJsZXMuc2Nmc2lfYmFuZFtpXTsgc2ZiIDwgVGFibGVzLnNjZnNpX2JhbmRbaSArIDFdOyBzZmIrKykge1xuICAgICAgICAgICAgICAgICAgICBnaS5zY2FsZWZhY1tzZmJdID0gLTE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGwzX3NpZGUuc2Nmc2lbY2hdW2ldID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB2YXIgczEgPSAwO1xuICAgICAgICB2YXIgYzEgPSAwO1xuICAgICAgICBmb3IgKHNmYiA9IDA7IHNmYiA8IDExOyBzZmIrKykge1xuICAgICAgICAgICAgaWYgKGdpLnNjYWxlZmFjW3NmYl0gPT0gLTEpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICBjMSsrO1xuICAgICAgICAgICAgaWYgKHMxIDwgZ2kuc2NhbGVmYWNbc2ZiXSlcbiAgICAgICAgICAgICAgICBzMSA9IGdpLnNjYWxlZmFjW3NmYl07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHMyID0gMDtcbiAgICAgICAgdmFyIGMyID0gMDtcbiAgICAgICAgZm9yICg7IHNmYiA8IEVuY29kZXIuU0JQU1lfbDsgc2ZiKyspIHtcbiAgICAgICAgICAgIGlmIChnaS5zY2FsZWZhY1tzZmJdID09IC0xKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgYzIrKztcbiAgICAgICAgICAgIGlmIChzMiA8IGdpLnNjYWxlZmFjW3NmYl0pXG4gICAgICAgICAgICAgICAgczIgPSBnaS5zY2FsZWZhY1tzZmJdO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxNjsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoczEgPCBzbGVuMV9uW2ldICYmIHMyIDwgc2xlbjJfbltpXSkge1xuICAgICAgICAgICAgICAgIHZhciBjID0gc2xlbjFfdGFiW2ldICogYzEgKyBzbGVuMl90YWJbaV0gKiBjMjtcbiAgICAgICAgICAgICAgICBpZiAoZ2kucGFydDJfbGVuZ3RoID4gYykge1xuICAgICAgICAgICAgICAgICAgICBnaS5wYXJ0Ml9sZW5ndGggPSBjO1xuICAgICAgICAgICAgICAgICAgICBnaS5zY2FsZWZhY19jb21wcmVzcyA9IGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmluZCB0aGUgb3B0aW1hbCB3YXkgdG8gc3RvcmUgdGhlIHNjYWxlZmFjdG9ycy4gT25seSBjYWxsIHRoaXMgcm91dGluZVxuICAgICAqIGFmdGVyIGZpbmFsIHNjYWxlZmFjdG9ycyBoYXZlIGJlZW4gY2hvc2VuIGFuZCB0aGUgY2hhbm5lbC9ncmFudWxlIHdpbGxcbiAgICAgKiBub3QgYmUgcmUtZW5jb2RlZC5cbiAgICAgKi9cbiAgICB0aGlzLmJlc3Rfc2NhbGVmYWNfc3RvcmUgPSBmdW5jdGlvbiAoZ2ZjLCBnciwgY2gsIGwzX3NpZGUpIHtcbiAgICAgICAgLyogdXNlIHNjYWxlZmFjX3NjYWxlIGlmIHdlIGNhbiAqL1xuICAgICAgICB2YXIgZ2kgPSBsM19zaWRlLnR0W2dyXVtjaF07XG4gICAgICAgIHZhciBzZmIsIGksIGosIGw7XG4gICAgICAgIHZhciByZWNhbGMgPSAwO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHJlbW92ZSBzY2FsZWZhY3MgZnJvbSBiYW5kcyB3aXRoIGl4PTAuIFRoaXMgaWRlYSBjb21lcyBmcm9tIHRoZSBBQUNcbiAgICAgICAgICogSVNPIGRvY3MuIGFkZGVkIG10IDMvMDBcbiAgICAgICAgICovXG4gICAgICAgIC8qIGNoZWNrIGlmIGwzX2VuYz0wICovXG4gICAgICAgIGogPSAwO1xuICAgICAgICBmb3IgKHNmYiA9IDA7IHNmYiA8IGdpLnNmYm1heDsgc2ZiKyspIHtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IGdpLndpZHRoW3NmYl07XG4gICAgICAgICAgICBqICs9IHdpZHRoO1xuICAgICAgICAgICAgZm9yIChsID0gLXdpZHRoOyBsIDwgMDsgbCsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGdpLmwzX2VuY1tsICsgal0gIT0gMClcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobCA9PSAwKVxuICAgICAgICAgICAgICAgIGdpLnNjYWxlZmFjW3NmYl0gPSByZWNhbGMgPSAtMjtcbiAgICAgICAgICAgIC8qIGFueXRoaW5nIGdvZXMuICovXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogb25seSBiZXN0X3NjYWxlZmFjX3N0b3JlIGFuZCBjYWxjX3NjZnNpIGtub3ctLWFuZCBvbmx5IHRoZXlcbiAgICAgICAgICAgICAqIHNob3VsZCBrbm93LS1hYm91dCB0aGUgbWFnaWMgbnVtYmVyIC0yLlxuICAgICAgICAgICAgICovXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoMCA9PSBnaS5zY2FsZWZhY19zY2FsZSAmJiAwID09IGdpLnByZWZsYWcpIHtcbiAgICAgICAgICAgIHZhciBzID0gMDtcbiAgICAgICAgICAgIGZvciAoc2ZiID0gMDsgc2ZiIDwgZ2kuc2ZibWF4OyBzZmIrKylcbiAgICAgICAgICAgICAgICBpZiAoZ2kuc2NhbGVmYWNbc2ZiXSA+IDApXG4gICAgICAgICAgICAgICAgICAgIHMgfD0gZ2kuc2NhbGVmYWNbc2ZiXTtcblxuICAgICAgICAgICAgaWYgKDAgPT0gKHMgJiAxKSAmJiBzICE9IDApIHtcbiAgICAgICAgICAgICAgICBmb3IgKHNmYiA9IDA7IHNmYiA8IGdpLnNmYm1heDsgc2ZiKyspXG4gICAgICAgICAgICAgICAgICAgIGlmIChnaS5zY2FsZWZhY1tzZmJdID4gMClcbiAgICAgICAgICAgICAgICAgICAgICAgIGdpLnNjYWxlZmFjW3NmYl0gPj49IDE7XG5cbiAgICAgICAgICAgICAgICBnaS5zY2FsZWZhY19zY2FsZSA9IHJlY2FsYyA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoMCA9PSBnaS5wcmVmbGFnICYmIGdpLmJsb2NrX3R5cGUgIT0gRW5jb2Rlci5TSE9SVF9UWVBFXG4gICAgICAgICAgICAmJiBnZmMubW9kZV9nciA9PSAyKSB7XG4gICAgICAgICAgICBmb3IgKHNmYiA9IDExOyBzZmIgPCBFbmNvZGVyLlNCUFNZX2w7IHNmYisrKVxuICAgICAgICAgICAgICAgIGlmIChnaS5zY2FsZWZhY1tzZmJdIDwgcXVwdnQucHJldGFiW3NmYl1cbiAgICAgICAgICAgICAgICAgICAgJiYgZ2kuc2NhbGVmYWNbc2ZiXSAhPSAtMilcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBpZiAoc2ZiID09IEVuY29kZXIuU0JQU1lfbCkge1xuICAgICAgICAgICAgICAgIGZvciAoc2ZiID0gMTE7IHNmYiA8IEVuY29kZXIuU0JQU1lfbDsgc2ZiKyspXG4gICAgICAgICAgICAgICAgICAgIGlmIChnaS5zY2FsZWZhY1tzZmJdID4gMClcbiAgICAgICAgICAgICAgICAgICAgICAgIGdpLnNjYWxlZmFjW3NmYl0gLT0gcXVwdnQucHJldGFiW3NmYl07XG5cbiAgICAgICAgICAgICAgICBnaS5wcmVmbGFnID0gcmVjYWxjID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCA0OyBpKyspXG4gICAgICAgICAgICBsM19zaWRlLnNjZnNpW2NoXVtpXSA9IDA7XG5cbiAgICAgICAgaWYgKGdmYy5tb2RlX2dyID09IDIgJiYgZ3IgPT0gMVxuICAgICAgICAgICAgJiYgbDNfc2lkZS50dFswXVtjaF0uYmxvY2tfdHlwZSAhPSBFbmNvZGVyLlNIT1JUX1RZUEVcbiAgICAgICAgICAgICYmIGwzX3NpZGUudHRbMV1bY2hdLmJsb2NrX3R5cGUgIT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICBzY2ZzaV9jYWxjKGNoLCBsM19zaWRlKTtcbiAgICAgICAgICAgIHJlY2FsYyA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChzZmIgPSAwOyBzZmIgPCBnaS5zZmJtYXg7IHNmYisrKSB7XG4gICAgICAgICAgICBpZiAoZ2kuc2NhbGVmYWNbc2ZiXSA9PSAtMikge1xuICAgICAgICAgICAgICAgIGdpLnNjYWxlZmFjW3NmYl0gPSAwO1xuICAgICAgICAgICAgICAgIC8qIGlmIGFueXRoaW5nIGdvZXMsIHRoZW4gMCBpcyBhIGdvb2QgY2hvaWNlICovXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlY2FsYyAhPSAwKSB7XG4gICAgICAgICAgICBpZiAoZ2ZjLm1vZGVfZ3IgPT0gMikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2NhbGVfYml0Y291bnQoZ2kpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNjYWxlX2JpdGNvdW50X2xzZihnZmMsIGdpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGFsbF9zY2FsZWZhY3RvcnNfbm90X25lZ2F0aXZlKHNjYWxlZmFjLCBuKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgKytpKSB7XG4gICAgICAgICAgICBpZiAoc2NhbGVmYWNbaV0gPCAwKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBudW1iZXIgb2YgYml0cyB1c2VkIHRvIGVuY29kZSBzY2FsZWZhY3MuXG4gICAgICpcbiAgICAgKiAxOCpzbGVuMV90YWJbaV0gKyAxOCpzbGVuMl90YWJbaV1cbiAgICAgKi9cbiAgICB2YXIgc2NhbGVfc2hvcnQgPSBbMCwgMTgsIDM2LCA1NCwgNTQsIDM2LCA1NCwgNzIsXG4gICAgICAgIDU0LCA3MiwgOTAsIDcyLCA5MCwgMTA4LCAxMDgsIDEyNl07XG5cbiAgICAvKipcbiAgICAgKiBudW1iZXIgb2YgYml0cyB1c2VkIHRvIGVuY29kZSBzY2FsZWZhY3MuXG4gICAgICpcbiAgICAgKiAxNypzbGVuMV90YWJbaV0gKyAxOCpzbGVuMl90YWJbaV1cbiAgICAgKi9cbiAgICB2YXIgc2NhbGVfbWl4ZWQgPSBbMCwgMTgsIDM2LCA1NCwgNTEsIDM1LCA1MywgNzEsXG4gICAgICAgIDUyLCA3MCwgODgsIDY5LCA4NywgMTA1LCAxMDQsIDEyMl07XG5cbiAgICAvKipcbiAgICAgKiBudW1iZXIgb2YgYml0cyB1c2VkIHRvIGVuY29kZSBzY2FsZWZhY3MuXG4gICAgICpcbiAgICAgKiAxMSpzbGVuMV90YWJbaV0gKyAxMCpzbGVuMl90YWJbaV1cbiAgICAgKi9cbiAgICB2YXIgc2NhbGVfbG9uZyA9IFswLCAxMCwgMjAsIDMwLCAzMywgMjEsIDMxLCA0MSwgMzIsIDQyLFxuICAgICAgICA1MiwgNDMsIDUzLCA2MywgNjQsIDc0XTtcblxuICAgIC8qKlxuICAgICAqIEFsc28gY2FsY3VsYXRlcyB0aGUgbnVtYmVyIG9mIGJpdHMgbmVjZXNzYXJ5IHRvIGNvZGUgdGhlIHNjYWxlZmFjdG9ycy5cbiAgICAgKi9cbiAgICB0aGlzLnNjYWxlX2JpdGNvdW50ID0gZnVuY3Rpb24gKGNvZF9pbmZvKSB7XG4gICAgICAgIHZhciBrLCBzZmIsIG1heF9zbGVuMSA9IDAsIG1heF9zbGVuMiA9IDA7XG5cbiAgICAgICAgLyogbWF4aW11bSB2YWx1ZXMgKi9cbiAgICAgICAgdmFyIHRhYjtcbiAgICAgICAgdmFyIHNjYWxlZmFjID0gY29kX2luZm8uc2NhbGVmYWM7XG5cblxuICAgICAgICBpZiAoY29kX2luZm8uYmxvY2tfdHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgIHRhYiA9IHNjYWxlX3Nob3J0O1xuICAgICAgICAgICAgaWYgKGNvZF9pbmZvLm1peGVkX2Jsb2NrX2ZsYWcgIT0gMClcbiAgICAgICAgICAgICAgICB0YWIgPSBzY2FsZV9taXhlZDtcbiAgICAgICAgfSBlbHNlIHsgLyogYmxvY2tfdHlwZSA9PSAxLDIsb3IgMyAqL1xuICAgICAgICAgICAgdGFiID0gc2NhbGVfbG9uZztcbiAgICAgICAgICAgIGlmICgwID09IGNvZF9pbmZvLnByZWZsYWcpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHNmYiA9IDExOyBzZmIgPCBFbmNvZGVyLlNCUFNZX2w7IHNmYisrKVxuICAgICAgICAgICAgICAgICAgICBpZiAoc2NhbGVmYWNbc2ZiXSA8IHF1cHZ0LnByZXRhYltzZmJdKVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBpZiAoc2ZiID09IEVuY29kZXIuU0JQU1lfbCkge1xuICAgICAgICAgICAgICAgICAgICBjb2RfaW5mby5wcmVmbGFnID0gMTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChzZmIgPSAxMTsgc2ZiIDwgRW5jb2Rlci5TQlBTWV9sOyBzZmIrKylcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlZmFjW3NmYl0gLT0gcXVwdnQucHJldGFiW3NmYl07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChzZmIgPSAwOyBzZmIgPCBjb2RfaW5mby5zZmJkaXZpZGU7IHNmYisrKVxuICAgICAgICAgICAgaWYgKG1heF9zbGVuMSA8IHNjYWxlZmFjW3NmYl0pXG4gICAgICAgICAgICAgICAgbWF4X3NsZW4xID0gc2NhbGVmYWNbc2ZiXTtcblxuICAgICAgICBmb3IgKDsgc2ZiIDwgY29kX2luZm8uc2ZibWF4OyBzZmIrKylcbiAgICAgICAgICAgIGlmIChtYXhfc2xlbjIgPCBzY2FsZWZhY1tzZmJdKVxuICAgICAgICAgICAgICAgIG1heF9zbGVuMiA9IHNjYWxlZmFjW3NmYl07XG5cbiAgICAgICAgLypcbiAgICAgICAgICogZnJvbSBUYWtlaGlybyBUT01JTkFHQSA8dG9taW5hZ2FAaXNvdGVybmV0Lm9yZz4gMTAvOTkgbG9vcCBvdmVyICphbGwqXG4gICAgICAgICAqIHBvc2libGUgdmFsdWVzIG9mIHNjYWxlZmFjX2NvbXByZXNzIHRvIGZpbmQgdGhlIG9uZSB3aGljaCB1c2VzIHRoZVxuICAgICAgICAgKiBzbWFsbGVzdCBudW1iZXIgb2YgYml0cy4gSVNPIHdvdWxkIHN0b3AgYXQgZmlyc3QgdmFsaWQgaW5kZXhcbiAgICAgICAgICovXG4gICAgICAgIGNvZF9pbmZvLnBhcnQyX2xlbmd0aCA9IFF1YW50aXplUFZULkxBUkdFX0JJVFM7XG4gICAgICAgIGZvciAoayA9IDA7IGsgPCAxNjsgaysrKSB7XG4gICAgICAgICAgICBpZiAobWF4X3NsZW4xIDwgc2xlbjFfbltrXSAmJiBtYXhfc2xlbjIgPCBzbGVuMl9uW2tdXG4gICAgICAgICAgICAgICAgJiYgY29kX2luZm8ucGFydDJfbGVuZ3RoID4gdGFiW2tdKSB7XG4gICAgICAgICAgICAgICAgY29kX2luZm8ucGFydDJfbGVuZ3RoID0gdGFiW2tdO1xuICAgICAgICAgICAgICAgIGNvZF9pbmZvLnNjYWxlZmFjX2NvbXByZXNzID0gaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY29kX2luZm8ucGFydDJfbGVuZ3RoID09IFF1YW50aXplUFZULkxBUkdFX0JJVFM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogdGFibGUgb2YgbGFyZ2VzdCBzY2FsZWZhY3RvciB2YWx1ZXMgZm9yIE1QRUcyXG4gICAgICovXG4gICAgdmFyIG1heF9yYW5nZV9zZmFjX3RhYiA9IFtbMTUsIDE1LCA3LCA3XSxcbiAgICAgICAgWzE1LCAxNSwgNywgMF0sIFs3LCAzLCAwLCAwXSwgWzE1LCAzMSwgMzEsIDBdLFxuICAgICAgICBbNywgNywgNywgMF0sIFszLCAzLCAwLCAwXV07XG5cbiAgICAvKipcbiAgICAgKiBBbHNvIGNvdW50cyB0aGUgbnVtYmVyIG9mIGJpdHMgdG8gZW5jb2RlIHRoZSBzY2FsZWZhY3MgYnV0IGZvciBNUEVHIDJcbiAgICAgKiBMb3dlciBzYW1wbGluZyBmcmVxdWVuY2llcyAoMjQsIDIyLjA1IGFuZCAxNiBrSHouKVxuICAgICAqXG4gICAgICogVGhpcyBpcyByZXZlcnNlLWVuZ2luZWVyZWQgZnJvbSBzZWN0aW9uIDIuNC4zLjIgb2YgdGhlIE1QRUcyIElTLFxuICAgICAqIFwiQXVkaW8gRGVjb2RpbmcgTGF5ZXIgSUlJXCJcbiAgICAgKi9cbiAgICB0aGlzLnNjYWxlX2JpdGNvdW50X2xzZiA9IGZ1bmN0aW9uIChnZmMsIGNvZF9pbmZvKSB7XG4gICAgICAgIHZhciB0YWJsZV9udW1iZXIsIHJvd19pbl90YWJsZSwgcGFydGl0aW9uLCBucl9zZmIsIHdpbmRvdztcbiAgICAgICAgdmFyIG92ZXI7XG4gICAgICAgIHZhciBpLCBzZmI7XG4gICAgICAgIHZhciBtYXhfc2ZhYyA9IG5ld19pbnQoNCk7XG4vL3ZhciBwYXJ0aXRpb25fdGFibGU7XG4gICAgICAgIHZhciBzY2FsZWZhYyA9IGNvZF9pbmZvLnNjYWxlZmFjO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIFNldCBwYXJ0aXRpb24gdGFibGUuIE5vdGUgdGhhdCBzaG91bGQgdHJ5IHRvIHVzZSB0YWJsZSBvbmUsIGJ1dCBkb1xuICAgICAgICAgKiBub3QgeWV0Li4uXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoY29kX2luZm8ucHJlZmxhZyAhPSAwKVxuICAgICAgICAgICAgdGFibGVfbnVtYmVyID0gMjtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgdGFibGVfbnVtYmVyID0gMDtcblxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgNDsgaSsrKVxuICAgICAgICAgICAgbWF4X3NmYWNbaV0gPSAwO1xuXG4gICAgICAgIGlmIChjb2RfaW5mby5ibG9ja190eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgcm93X2luX3RhYmxlID0gMTtcbiAgICAgICAgICAgIHZhciBwYXJ0aXRpb25fdGFibGUgPSBxdXB2dC5ucl9vZl9zZmJfYmxvY2tbdGFibGVfbnVtYmVyXVtyb3dfaW5fdGFibGVdO1xuICAgICAgICAgICAgZm9yIChzZmIgPSAwLCBwYXJ0aXRpb24gPSAwOyBwYXJ0aXRpb24gPCA0OyBwYXJ0aXRpb24rKykge1xuICAgICAgICAgICAgICAgIG5yX3NmYiA9IHBhcnRpdGlvbl90YWJsZVtwYXJ0aXRpb25dIC8gMztcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbnJfc2ZiOyBpKyssIHNmYisrKVxuICAgICAgICAgICAgICAgICAgICBmb3IgKHdpbmRvdyA9IDA7IHdpbmRvdyA8IDM7IHdpbmRvdysrKVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjYWxlZmFjW3NmYiAqIDMgKyB3aW5kb3ddID4gbWF4X3NmYWNbcGFydGl0aW9uXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhfc2ZhY1twYXJ0aXRpb25dID0gc2NhbGVmYWNbc2ZiICogMyArIHdpbmRvd107XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByb3dfaW5fdGFibGUgPSAwO1xuICAgICAgICAgICAgdmFyIHBhcnRpdGlvbl90YWJsZSA9IHF1cHZ0Lm5yX29mX3NmYl9ibG9ja1t0YWJsZV9udW1iZXJdW3Jvd19pbl90YWJsZV07XG4gICAgICAgICAgICBmb3IgKHNmYiA9IDAsIHBhcnRpdGlvbiA9IDA7IHBhcnRpdGlvbiA8IDQ7IHBhcnRpdGlvbisrKSB7XG4gICAgICAgICAgICAgICAgbnJfc2ZiID0gcGFydGl0aW9uX3RhYmxlW3BhcnRpdGlvbl07XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG5yX3NmYjsgaSsrLCBzZmIrKylcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNjYWxlZmFjW3NmYl0gPiBtYXhfc2ZhY1twYXJ0aXRpb25dKVxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4X3NmYWNbcGFydGl0aW9uXSA9IHNjYWxlZmFjW3NmYl07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKG92ZXIgPSBmYWxzZSwgcGFydGl0aW9uID0gMDsgcGFydGl0aW9uIDwgNDsgcGFydGl0aW9uKyspIHtcbiAgICAgICAgICAgIGlmIChtYXhfc2ZhY1twYXJ0aXRpb25dID4gbWF4X3JhbmdlX3NmYWNfdGFiW3RhYmxlX251bWJlcl1bcGFydGl0aW9uXSlcbiAgICAgICAgICAgICAgICBvdmVyID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW92ZXIpIHtcbiAgICAgICAgICAgIHZhciBzbGVuMSwgc2xlbjIsIHNsZW4zLCBzbGVuNDtcblxuICAgICAgICAgICAgY29kX2luZm8uc2ZiX3BhcnRpdGlvbl90YWJsZSA9IHF1cHZ0Lm5yX29mX3NmYl9ibG9ja1t0YWJsZV9udW1iZXJdW3Jvd19pbl90YWJsZV07XG4gICAgICAgICAgICBmb3IgKHBhcnRpdGlvbiA9IDA7IHBhcnRpdGlvbiA8IDQ7IHBhcnRpdGlvbisrKVxuICAgICAgICAgICAgICAgIGNvZF9pbmZvLnNsZW5bcGFydGl0aW9uXSA9IGxvZzJ0YWJbbWF4X3NmYWNbcGFydGl0aW9uXV07XG5cbiAgICAgICAgICAgIC8qIHNldCBzY2FsZWZhY19jb21wcmVzcyAqL1xuICAgICAgICAgICAgc2xlbjEgPSBjb2RfaW5mby5zbGVuWzBdO1xuICAgICAgICAgICAgc2xlbjIgPSBjb2RfaW5mby5zbGVuWzFdO1xuICAgICAgICAgICAgc2xlbjMgPSBjb2RfaW5mby5zbGVuWzJdO1xuICAgICAgICAgICAgc2xlbjQgPSBjb2RfaW5mby5zbGVuWzNdO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKHRhYmxlX251bWJlcikge1xuICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgY29kX2luZm8uc2NhbGVmYWNfY29tcHJlc3MgPSAoKChzbGVuMSAqIDUpICsgc2xlbjIpIDw8IDQpXG4gICAgICAgICAgICAgICAgICAgICAgICArIChzbGVuMyA8PCAyKSArIHNsZW40O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgY29kX2luZm8uc2NhbGVmYWNfY29tcHJlc3MgPSA0MDAgKyAoKChzbGVuMSAqIDUpICsgc2xlbjIpIDw8IDIpXG4gICAgICAgICAgICAgICAgICAgICAgICArIHNsZW4zO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgY29kX2luZm8uc2NhbGVmYWNfY29tcHJlc3MgPSA1MDAgKyAoc2xlbjEgKiAzKSArIHNsZW4yO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRmKFwiaW50ZW5zaXR5IHN0ZXJlbyBub3QgaW1wbGVtZW50ZWQgeWV0XFxuXCIpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoIW92ZXIpIHtcbiAgICAgICAgICAgIGNvZF9pbmZvLnBhcnQyX2xlbmd0aCA9IDA7XG4gICAgICAgICAgICBmb3IgKHBhcnRpdGlvbiA9IDA7IHBhcnRpdGlvbiA8IDQ7IHBhcnRpdGlvbisrKVxuICAgICAgICAgICAgICAgIGNvZF9pbmZvLnBhcnQyX2xlbmd0aCArPSBjb2RfaW5mby5zbGVuW3BhcnRpdGlvbl1cbiAgICAgICAgICAgICAgICAgICAgKiBjb2RfaW5mby5zZmJfcGFydGl0aW9uX3RhYmxlW3BhcnRpdGlvbl07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG92ZXI7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBTaW5jZSBubyBiYW5kcyBoYXZlIGJlZW4gb3Zlci1hbXBsaWZpZWQsIHdlIGNhbiBzZXQgc2NhbGVmYWNfY29tcHJlc3MgYW5kXG4gICAgICogc2xlbltdIGZvciB0aGUgZm9ybWF0dGVyXG4gICAgICovXG4gICAgdmFyIGxvZzJ0YWIgPSBbMCwgMSwgMiwgMiwgMywgMywgMywgMywgNCwgNCwgNCwgNCxcbiAgICAgICAgNCwgNCwgNCwgNF07XG5cbiAgICB0aGlzLmh1ZmZtYW5faW5pdCA9IGZ1bmN0aW9uIChnZmMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDI7IGkgPD0gNTc2OyBpICs9IDIpIHtcbiAgICAgICAgICAgIHZhciBzY2ZiX2FueiA9IDAsIGJ2X2luZGV4O1xuICAgICAgICAgICAgd2hpbGUgKGdmYy5zY2FsZWZhY19iYW5kLmxbKytzY2ZiX2Fuel0gPCBpKVxuICAgICAgICAgICAgICAgIDtcblxuICAgICAgICAgICAgYnZfaW5kZXggPSBzdWJkdl90YWJsZVtzY2ZiX2Fuel1bMF07IC8vIC5yZWdpb24wX2NvdW50XG4gICAgICAgICAgICB3aGlsZSAoZ2ZjLnNjYWxlZmFjX2JhbmQubFtidl9pbmRleCArIDFdID4gaSlcbiAgICAgICAgICAgICAgICBidl9pbmRleC0tO1xuXG4gICAgICAgICAgICBpZiAoYnZfaW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiB0aGlzIGlzIGFuIGluZGljYXRpb24gdGhhdCBldmVyeXRoaW5nIGlzIGdvaW5nIHRvIGJlIGVuY29kZWRcbiAgICAgICAgICAgICAgICAgKiBhcyByZWdpb24wOiBiaWd2YWx1ZXMgPCByZWdpb24wIDwgcmVnaW9uMSBzbyBsZXRzIHNldFxuICAgICAgICAgICAgICAgICAqIHJlZ2lvbjAsIHJlZ2lvbjEgdG8gc29tZSB2YWx1ZSBsYXJnZXIgdGhhbiBiaWd2YWx1ZXNcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBidl9pbmRleCA9IHN1YmR2X3RhYmxlW3NjZmJfYW56XVswXTsgLy8gLnJlZ2lvbjBfY291bnRcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZ2ZjLmJ2X3NjZltpIC0gMl0gPSBidl9pbmRleDtcblxuICAgICAgICAgICAgYnZfaW5kZXggPSBzdWJkdl90YWJsZVtzY2ZiX2Fuel1bMV07IC8vIC5yZWdpb24xX2NvdW50XG4gICAgICAgICAgICB3aGlsZSAoZ2ZjLnNjYWxlZmFjX2JhbmQubFtidl9pbmRleCArIGdmYy5idl9zY2ZbaSAtIDJdICsgMl0gPiBpKVxuICAgICAgICAgICAgICAgIGJ2X2luZGV4LS07XG5cbiAgICAgICAgICAgIGlmIChidl9pbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICBidl9pbmRleCA9IHN1YmR2X3RhYmxlW3NjZmJfYW56XVsxXTsgLy8gLnJlZ2lvbjFfY291bnRcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZ2ZjLmJ2X3NjZltpIC0gMV0gPSBidl9pbmRleDtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLypcbiAqICBSZXBsYXlHYWluQW5hbHlzaXMgLSBhbmFseXplcyBpbnB1dCBzYW1wbGVzIGFuZCBnaXZlIHRoZSByZWNvbW1lbmRlZCBkQiBjaGFuZ2VcbiAqICBDb3B5cmlnaHQgKEMpIDIwMDEgRGF2aWQgUm9iaW5zb24gYW5kIEdsZW4gU2F3eWVyXG4gKiAgSW1wcm92ZW1lbnRzIGFuZCBvcHRpbWl6YXRpb25zIGFkZGVkIGJ5IEZyYW5rIEtsZW1tLCBhbmQgYnkgTWFyY2VsIE11bGxlciBcbiAqXG4gKiAgVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vclxuICogIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWNcbiAqICBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXJcbiAqICB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiAgVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG4gKiAgYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2ZcbiAqICBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVVxuICogIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuXG4gKlxuICogIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWNcbiAqICBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHdyaXRlIHRvIHRoZSBGcmVlIFNvZnR3YXJlXG4gKiAgRm91bmRhdGlvbiwgSW5jLiwgNTkgVGVtcGxlIFBsYWNlLCBTdWl0ZSAzMzAsIEJvc3RvbiwgTUEgIDAyMTExLTEzMDcgIFVTQVxuICpcbiAqICBjb25jZXB0IGFuZCBmaWx0ZXIgdmFsdWVzIGJ5IERhdmlkIFJvYmluc29uIChEYXZpZEBSb2JpbnNvbi5vcmcpXG4gKiAgICAtLSBibGFtZSBoaW0gaWYgeW91IHRoaW5rIHRoZSBpZGVhIGlzIGZsYXdlZFxuICogIG9yaWdpbmFsIGNvZGluZyBieSBHbGVuIFNhd3llciAobXAzZ2FpbkBob3RtYWlsLmNvbSlcbiAqICAgIC0tIGJsYW1lIGhpbSBpZiB5b3UgdGhpbmsgdGhpcyBydW5zIHRvbyBzbG93bHksIG9yIHRoZSBjb2RpbmcgaXMgb3RoZXJ3aXNlIGZsYXdlZFxuICpcbiAqICBsb3RzIG9mIGNvZGUgaW1wcm92ZW1lbnRzIGJ5IEZyYW5rIEtsZW1tICggaHR0cDovL3d3dy51bmktamVuYS5kZS9+cGZrL21wcC8gKVxuICogICAgLS0gY3JlZGl0IGhpbSBmb3IgYWxsIHRoZSBfZ29vZF8gcHJvZ3JhbW1pbmcgOylcbiAqXG4gKlxuICogIEZvciBhbiBleHBsYW5hdGlvbiBvZiB0aGUgY29uY2VwdHMgYW5kIHRoZSBiYXNpYyBhbGdvcml0aG1zIGludm9sdmVkLCBnbyB0bzpcbiAqICAgIGh0dHA6Ly93d3cucmVwbGF5Z2Fpbi5vcmcvXG4gKi9cblxuLypcbiAqICBIZXJlJ3MgdGhlIGRlYWwuIENhbGxcbiAqXG4gKiAgICBJbml0R2FpbkFuYWx5c2lzICggbG9uZyBzYW1wbGVmcmVxICk7XG4gKlxuICogIHRvIGluaXRpYWxpemUgZXZlcnl0aGluZy4gQ2FsbFxuICpcbiAqICAgIEFuYWx5emVTYW1wbGVzICggdmFyIEZsb2F0X3QqICBsZWZ0X3NhbXBsZXMsXG4gKiAgICAgICAgICAgICAgICAgICAgIHZhciBGbG9hdF90KiAgcmlnaHRfc2FtcGxlcyxcbiAqICAgICAgICAgICAgICAgICAgICAgc2l6ZV90ICAgICAgICAgIG51bV9zYW1wbGVzLFxuICogICAgICAgICAgICAgICAgICAgICBpbnQgICAgICAgICAgICAgbnVtX2NoYW5uZWxzICk7XG4gKlxuICogIGFzIG1hbnkgdGltZXMgYXMgeW91IHdhbnQsIHdpdGggYXMgbWFueSBvciBhcyBmZXcgc2FtcGxlcyBhcyB5b3Ugd2FudC5cbiAqICBJZiBtb25vLCBwYXNzIHRoZSBzYW1wbGUgYnVmZmVyIGluIHRocm91Z2ggbGVmdF9zYW1wbGVzLCBsZWF2ZVxuICogIHJpZ2h0X3NhbXBsZXMgTlVMTCwgYW5kIG1ha2Ugc3VyZSBudW1fY2hhbm5lbHMgPSAxLlxuICpcbiAqICAgIEdldFRpdGxlR2FpbigpXG4gKlxuICogIHdpbGwgcmV0dXJuIHRoZSByZWNvbW1lbmRlZCBkQiBsZXZlbCBjaGFuZ2UgZm9yIGFsbCBzYW1wbGVzIGFuYWx5emVkXG4gKiAgU0lOQ0UgVEhFIExBU1QgVElNRSB5b3UgY2FsbGVkIEdldFRpdGxlR2FpbigpIE9SIEluaXRHYWluQW5hbHlzaXMoKS5cbiAqXG4gKiAgICBHZXRBbGJ1bUdhaW4oKVxuICpcbiAqICB3aWxsIHJldHVybiB0aGUgcmVjb21tZW5kZWQgZEIgbGV2ZWwgY2hhbmdlIGZvciBhbGwgc2FtcGxlcyBhbmFseXplZFxuICogIHNpbmNlIEluaXRHYWluQW5hbHlzaXMoKSB3YXMgY2FsbGVkIGFuZCBmaW5hbGl6ZWQgd2l0aCBHZXRUaXRsZUdhaW4oKS5cbiAqXG4gKiAgUHNldWRvLWNvZGUgdG8gcHJvY2VzcyBhbiBhbGJ1bTpcbiAqXG4gKiAgICBGbG9hdF90ICAgICAgIGxfc2FtcGxlcyBbNDA5Nl07XG4gKiAgICBGbG9hdF90ICAgICAgIHJfc2FtcGxlcyBbNDA5Nl07XG4gKiAgICBzaXplX3QgICAgICAgIG51bV9zYW1wbGVzO1xuICogICAgdW5zaWduZWQgaW50ICBudW1fc29uZ3M7XG4gKiAgICB1bnNpZ25lZCBpbnQgIGk7XG4gKlxuICogICAgSW5pdEdhaW5BbmFseXNpcyAoIDQ0MTAwICk7XG4gKiAgICBmb3IgKCBpID0gMTsgaSA8PSBudW1fc29uZ3M7IGkrKyApIHtcbiAqICAgICAgICB3aGlsZSAoICggbnVtX3NhbXBsZXMgPSBnZXRTb25nU2FtcGxlcyAoIHNvbmdbaV0sIGxlZnRfc2FtcGxlcywgcmlnaHRfc2FtcGxlcyApICkgPiAwIClcbiAqICAgICAgICAgICAgQW5hbHl6ZVNhbXBsZXMgKCBsZWZ0X3NhbXBsZXMsIHJpZ2h0X3NhbXBsZXMsIG51bV9zYW1wbGVzLCAyICk7XG4gKiAgICAgICAgZnByaW50ZiAoXCJSZWNvbW1lbmRlZCBkQiBjaGFuZ2UgZm9yIHNvbmcgJTJkOiAlKzYuMiBkQlxcblwiLCBpLCBHZXRUaXRsZUdhaW4oKSApO1xuICogICAgfVxuICogICAgZnByaW50ZiAoXCJSZWNvbW1lbmRlZCBkQiBjaGFuZ2UgZm9yIHdob2xlIGFsYnVtOiAlKzYuMiBkQlxcblwiLCBHZXRBbGJ1bUdhaW4oKSApO1xuICovXG5cbi8qXG4gKiAgU28gaGVyZSdzIHRoZSBtYWluIHNvdXJjZSBvZiBwb3RlbnRpYWwgY29kZSBjb25mdXNpb246XG4gKlxuICogIFRoZSBmaWx0ZXJzIGFwcGxpZWQgdG8gdGhlIGluY29taW5nIHNhbXBsZXMgYXJlIElJUiBmaWx0ZXJzLFxuICogIG1lYW5pbmcgdGhleSByZWx5IG9uIHVwIHRvIDxmaWx0ZXIgb3JkZXI+IG51bWJlciBvZiBwcmV2aW91cyBzYW1wbGVzXG4gKiAgQU5EIHVwIHRvIDxmaWx0ZXIgb3JkZXI+IG51bWJlciBvZiBwcmV2aW91cyBmaWx0ZXJlZCBzYW1wbGVzLlxuICpcbiAqICBJIHNldCB1cCB0aGUgQW5hbHl6ZVNhbXBsZXMgcm91dGluZSB0byBtaW5pbWl6ZSBtZW1vcnkgdXNhZ2UgYW5kIGludGVyZmFjZVxuICogIGNvbXBsZXhpdHkuIFRoZSBzcGVlZCBpc24ndCBjb21wcm9taXNlZCB0b28gbXVjaCAoSSBkb24ndCB0aGluayksIGJ1dCB0aGVcbiAqICBpbnRlcm5hbCBjb21wbGV4aXR5IGlzIGhpZ2hlciB0aGFuIGl0IHNob3VsZCBiZSBmb3Igc3VjaCBhIHJlbGF0aXZlbHlcbiAqICBzaW1wbGUgcm91dGluZS5cbiAqXG4gKiAgT3B0aW1pemF0aW9uL2NsYXJpdHkgc3VnZ2VzdGlvbnMgYXJlIHdlbGNvbWUuXG4gKi9cblxuLyoqXG4gKiBUYWJsZSBlbnRyaWVzIHBlciBkQlxuICovXG5HYWluQW5hbHlzaXMuU1RFUFNfcGVyX2RCID0gMTAwLjtcbi8qKlxuICogVGFibGUgZW50cmllcyBmb3IgMC4uLk1BWF9kQiAobm9ybWFsIG1heC4gdmFsdWVzIGFyZSA3MC4uLjgwIGRCKVxuICovXG5HYWluQW5hbHlzaXMuTUFYX2RCID0gMTIwLjtcbkdhaW5BbmFseXNpcy5HQUlOX05PVF9FTk9VR0hfU0FNUExFUyA9IC0yNDYwMTtcbkdhaW5BbmFseXNpcy5HQUlOX0FOQUxZU0lTX0VSUk9SID0gMDtcbkdhaW5BbmFseXNpcy5HQUlOX0FOQUxZU0lTX09LID0gMTtcbkdhaW5BbmFseXNpcy5JTklUX0dBSU5fQU5BTFlTSVNfRVJST1IgPSAwO1xuR2FpbkFuYWx5c2lzLklOSVRfR0FJTl9BTkFMWVNJU19PSyA9IDE7XG5cbkdhaW5BbmFseXNpcy5ZVUxFX09SREVSID0gMTA7XG5HYWluQW5hbHlzaXMuTUFYX09SREVSID0gR2FpbkFuYWx5c2lzLllVTEVfT1JERVI7XG5cbkdhaW5BbmFseXNpcy5NQVhfU0FNUF9GUkVRID0gNDgwMDA7XG5HYWluQW5hbHlzaXMuUk1TX1dJTkRPV19USU1FX05VTUVSQVRPUiA9IDE7XG5HYWluQW5hbHlzaXMuUk1TX1dJTkRPV19USU1FX0RFTk9NSU5BVE9SID0gMjA7XG5HYWluQW5hbHlzaXMuTUFYX1NBTVBMRVNfUEVSX1dJTkRPVyA9ICgoR2FpbkFuYWx5c2lzLk1BWF9TQU1QX0ZSRVEgKiBHYWluQW5hbHlzaXMuUk1TX1dJTkRPV19USU1FX05VTUVSQVRPUikgLyBHYWluQW5hbHlzaXMuUk1TX1dJTkRPV19USU1FX0RFTk9NSU5BVE9SICsgMSk7XG5cbmZ1bmN0aW9uIEdhaW5BbmFseXNpcygpIHtcblx0Ly9maXgg57K+566AXG59XG5cblxuZnVuY3Rpb24gUHJlc2V0cygpIHtcbiAgICBmdW5jdGlvbiBWQlJQcmVzZXRzKHF1YWwsIGNvbXAsIGNvbXBTLFxuICAgICAgICAgICAgICAgICAgICAgICAgeSwgc2hUaHJlc2hvbGQsIHNoVGhyZXNob2xkUyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkaiwgYWRqU2hvcnQsIGxvd2VyLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3VydmUsIHNlbnMsIGludGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgam9pbnQsIG1vZCwgZml4KSB7XG4gICAgICAgIHRoaXMudmJyX3EgPSBxdWFsO1xuICAgICAgICB0aGlzLnF1YW50X2NvbXAgPSBjb21wO1xuICAgICAgICB0aGlzLnF1YW50X2NvbXBfcyA9IGNvbXBTO1xuICAgICAgICB0aGlzLmV4cFkgPSB5O1xuICAgICAgICB0aGlzLnN0X2xybSA9IHNoVGhyZXNob2xkO1xuICAgICAgICB0aGlzLnN0X3MgPSBzaFRocmVzaG9sZFM7XG4gICAgICAgIHRoaXMubWFza2luZ19hZGogPSBhZGo7XG4gICAgICAgIHRoaXMubWFza2luZ19hZGpfc2hvcnQgPSBhZGpTaG9ydDtcbiAgICAgICAgdGhpcy5hdGhfbG93ZXIgPSBsb3dlcjtcbiAgICAgICAgdGhpcy5hdGhfY3VydmUgPSBjdXJ2ZTtcbiAgICAgICAgdGhpcy5hdGhfc2Vuc2l0aXZpdHkgPSBzZW5zO1xuICAgICAgICB0aGlzLmludGVyY2ggPSBpbnRlcjtcbiAgICAgICAgdGhpcy5zYWZlam9pbnQgPSBqb2ludDtcbiAgICAgICAgdGhpcy5zZmIyMW1vZCA9IG1vZDtcbiAgICAgICAgdGhpcy5tc2ZpeCA9IGZpeDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBBQlJQcmVzZXRzKGticHMsIGNvbXAsIGNvbXBTLFxuICAgICAgICAgICAgICAgICAgICAgICAgam9pbnQsIGZpeCwgc2hUaHJlc2hvbGQsXG4gICAgICAgICAgICAgICAgICAgICAgICBzaFRocmVzaG9sZFMsIGJhc3MsIHNjLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFzaywgbG93ZXIsIGN1cnZlLFxuICAgICAgICAgICAgICAgICAgICAgICAgaW50ZXJDaCwgc2ZTY2FsZSkge1xuICAgICAgICB0aGlzLnF1YW50X2NvbXAgPSBjb21wO1xuICAgICAgICB0aGlzLnF1YW50X2NvbXBfcyA9IGNvbXBTO1xuICAgICAgICB0aGlzLnNhZmVqb2ludCA9IGpvaW50O1xuICAgICAgICB0aGlzLm5zbXNmaXggPSBmaXg7XG4gICAgICAgIHRoaXMuc3RfbHJtID0gc2hUaHJlc2hvbGQ7XG4gICAgICAgIHRoaXMuc3RfcyA9IHNoVGhyZXNob2xkUztcbiAgICAgICAgdGhpcy5uc2Jhc3MgPSBiYXNzO1xuICAgICAgICB0aGlzLnNjYWxlID0gc2M7XG4gICAgICAgIHRoaXMubWFza2luZ19hZGogPSBtYXNrO1xuICAgICAgICB0aGlzLmF0aF9sb3dlciA9IGxvd2VyO1xuICAgICAgICB0aGlzLmF0aF9jdXJ2ZSA9IGN1cnZlO1xuICAgICAgICB0aGlzLmludGVyY2ggPSBpbnRlckNoO1xuICAgICAgICB0aGlzLnNmc2NhbGUgPSBzZlNjYWxlO1xuICAgIH1cblxuICAgIHZhciBsYW1lO1xuXG4gICAgdGhpcy5zZXRNb2R1bGVzID0gZnVuY3Rpb24gKF9sYW1lKSB7XG4gICAgICAgIGxhbWUgPSBfbGFtZTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogPFBSRT5cbiAgICAgKiBTd2l0Y2ggbWFwcGluZ3MgZm9yIFZCUiBtb2RlIFZCUl9SSFxuICAgICAqICAgICAgICAgICAgIHZicl9xICBxY29tcF9sICBxY29tcF9zICBleHBZICBzdF9scm0gICBzdF9zICBtYXNrIGFkal9sICBhZGpfcyAgYXRoX2xvd2VyICBhdGhfY3VydmUgIGF0aF9zZW5zICBpbnRlckNoUiAgc2FmZWpvaW50IHNmYjIxbW9kICBtc2ZpeFxuICAgICAqIDwvUFJFPlxuICAgICAqL1xuICAgIHZhciB2YnJfb2xkX3N3aXRjaF9tYXAgPSBbXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDAsIDksIDksIDAsIDUuMjAsIDEyNS4wLCAtNC4yLCAtNi4zLCA0LjgsIDEsIDAsIDAsIDIsIDIxLCAwLjk3KSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoMSwgOSwgOSwgMCwgNS4zMCwgMTI1LjAsIC0zLjYsIC01LjYsIDQuNSwgMS41LCAwLCAwLCAyLCAyMSwgMS4zNSksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDIsIDksIDksIDAsIDUuNjAsIDEyNS4wLCAtMi4yLCAtMy41LCAyLjgsIDIsIDAsIDAsIDIsIDIxLCAxLjQ5KSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoMywgOSwgOSwgMSwgNS44MCwgMTMwLjAsIC0xLjgsIC0yLjgsIDIuNiwgMywgLTQsIDAsIDIsIDIwLCAxLjY0KSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoNCwgOSwgOSwgMSwgNi4wMCwgMTM1LjAsIC0wLjcsIC0xLjEsIDEuMSwgMy41LCAtOCwgMCwgMiwgMCwgMS43OSksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDUsIDksIDksIDEsIDYuNDAsIDE0MC4wLCAwLjUsIDAuNCwgLTcuNSwgNCwgLTEyLCAwLjAwMDIsIDAsIDAsIDEuOTUpLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cyg2LCA5LCA5LCAxLCA2LjYwLCAxNDUuMCwgMC42NywgMC42NSwgLTE0LjcsIDYuNSwgLTE5LCAwLjAwMDQsIDAsIDAsIDIuMzApLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cyg3LCA5LCA5LCAxLCA2LjYwLCAxNDUuMCwgMC44LCAwLjc1LCAtMTkuNywgOCwgLTIyLCAwLjAwMDYsIDAsIDAsIDIuNzApLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cyg4LCA5LCA5LCAxLCA2LjYwLCAxNDUuMCwgMS4yLCAxLjE1LCAtMjcuNSwgMTAsIC0yMywgMC4wMDA3LCAwLCAwLCAwKSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoOSwgOSwgOSwgMSwgNi42MCwgMTQ1LjAsIDEuNiwgMS42LCAtMzYsIDExLCAtMjUsIDAuMDAwOCwgMCwgMCwgMCksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDEwLCA5LCA5LCAxLCA2LjYwLCAxNDUuMCwgMi4wLCAyLjAsIC0zNiwgMTIsIC0yNSwgMC4wMDA4LCAwLCAwLCAwKVxuICAgIF07XG5cbiAgICAvKipcbiAgICAgKiA8UFJFPlxuICAgICAqICAgICAgICAgICAgICAgICB2YnJfcSAgcWNvbXBfbCAgcWNvbXBfcyAgZXhwWSAgc3RfbHJtICAgc3RfcyAgbWFzayBhZGpfbCAgYWRqX3MgIGF0aF9sb3dlciAgYXRoX2N1cnZlICBhdGhfc2VucyAgaW50ZXJDaFIgIHNhZmVqb2ludCBzZmIyMW1vZCAgbXNmaXhcbiAgICAgKiA8L1BSRT5cbiAgICAgKi9cbiAgICB2YXIgdmJyX3BzeV9zd2l0Y2hfbWFwID0gW1xuICAgICAgICBuZXcgVkJSUHJlc2V0cygwLCA5LCA5LCAwLCA0LjIwLCAyNS4wLCAtNy4wLCAtNC4wLCA3LjUsIDEsIDAsIDAsIDIsIDI2LCAwLjk3KSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoMSwgOSwgOSwgMCwgNC4yMCwgMjUuMCwgLTUuNiwgLTMuNiwgNC41LCAxLjUsIDAsIDAsIDIsIDIxLCAxLjM1KSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoMiwgOSwgOSwgMCwgNC4yMCwgMjUuMCwgLTQuNCwgLTEuOCwgMiwgMiwgMCwgMCwgMiwgMTgsIDEuNDkpLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cygzLCA5LCA5LCAxLCA0LjIwLCAyNS4wLCAtMy40LCAtMS4yNSwgMS4xLCAzLCAtNCwgMCwgMiwgMTUsIDEuNjQpLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cyg0LCA5LCA5LCAxLCA0LjIwLCAyNS4wLCAtMi4yLCAwLjEsIDAsIDMuNSwgLTgsIDAsIDIsIDAsIDEuNzkpLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cyg1LCA5LCA5LCAxLCA0LjIwLCAyNS4wLCAtMS4wLCAxLjY1LCAtNy43LCA0LCAtMTIsIDAuMDAwMiwgMCwgMCwgMS45NSksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDYsIDksIDksIDEsIDQuMjAsIDI1LjAsIC0wLjAsIDIuNDcsIC03LjcsIDYuNSwgLTE5LCAwLjAwMDQsIDAsIDAsIDIpLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cyg3LCA5LCA5LCAxLCA0LjIwLCAyNS4wLCAwLjUsIDIuMCwgLTE0LjUsIDgsIC0yMiwgMC4wMDA2LCAwLCAwLCAyKSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoOCwgOSwgOSwgMSwgNC4yMCwgMjUuMCwgMS4wLCAyLjQsIC0yMi4wLCAxMCwgLTIzLCAwLjAwMDcsIDAsIDAsIDIpLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cyg5LCA5LCA5LCAxLCA0LjIwLCAyNS4wLCAxLjUsIDIuOTUsIC0zMC4wLCAxMSwgLTI1LCAwLjAwMDgsIDAsIDAsIDIpLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cygxMCwgOSwgOSwgMSwgNC4yMCwgMjUuMCwgMi4wLCAyLjk1LCAtMzYuMCwgMTIsIC0zMCwgMC4wMDA4LCAwLCAwLCAyKVxuICAgIF07XG5cbiAgICBmdW5jdGlvbiBhcHBseV92YnJfcHJlc2V0KGdmcCwgYSwgZW5mb3JjZSkge1xuICAgICAgICB2YXIgdmJyX3ByZXNldCA9IGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfcmggPyB2YnJfb2xkX3N3aXRjaF9tYXBcbiAgICAgICAgICAgIDogdmJyX3BzeV9zd2l0Y2hfbWFwO1xuXG4gICAgICAgIHZhciB4ID0gZ2ZwLlZCUl9xX2ZyYWM7XG4gICAgICAgIHZhciBwID0gdmJyX3ByZXNldFthXTtcbiAgICAgICAgdmFyIHEgPSB2YnJfcHJlc2V0W2EgKyAxXTtcbiAgICAgICAgdmFyIHNldCA9IHA7XG5cbiAgICAgICAgLy8gTk9PUCh2YnJfcSk7XG4gICAgICAgIC8vIE5PT1AocXVhbnRfY29tcCk7XG4gICAgICAgIC8vIE5PT1AocXVhbnRfY29tcF9zKTtcbiAgICAgICAgLy8gTk9PUChleHBZKTtcbiAgICAgICAgcC5zdF9scm0gPSBwLnN0X2xybSArIHggKiAocS5zdF9scm0gLSBwLnN0X2xybSk7XG4gICAgICAgIC8vIExFUlAoc3RfbHJtKTtcbiAgICAgICAgcC5zdF9zID0gcC5zdF9zICsgeCAqIChxLnN0X3MgLSBwLnN0X3MpO1xuICAgICAgICAvLyBMRVJQKHN0X3MpO1xuICAgICAgICBwLm1hc2tpbmdfYWRqID0gcC5tYXNraW5nX2FkaiArIHggKiAocS5tYXNraW5nX2FkaiAtIHAubWFza2luZ19hZGopO1xuICAgICAgICAvLyBMRVJQKG1hc2tpbmdfYWRqKTtcbiAgICAgICAgcC5tYXNraW5nX2Fkal9zaG9ydCA9IHAubWFza2luZ19hZGpfc2hvcnQgKyB4XG4gICAgICAgICAgICAqIChxLm1hc2tpbmdfYWRqX3Nob3J0IC0gcC5tYXNraW5nX2Fkal9zaG9ydCk7XG4gICAgICAgIC8vIExFUlAobWFza2luZ19hZGpfc2hvcnQpO1xuICAgICAgICBwLmF0aF9sb3dlciA9IHAuYXRoX2xvd2VyICsgeCAqIChxLmF0aF9sb3dlciAtIHAuYXRoX2xvd2VyKTtcbiAgICAgICAgLy8gTEVSUChhdGhfbG93ZXIpO1xuICAgICAgICBwLmF0aF9jdXJ2ZSA9IHAuYXRoX2N1cnZlICsgeCAqIChxLmF0aF9jdXJ2ZSAtIHAuYXRoX2N1cnZlKTtcbiAgICAgICAgLy8gTEVSUChhdGhfY3VydmUpO1xuICAgICAgICBwLmF0aF9zZW5zaXRpdml0eSA9IHAuYXRoX3NlbnNpdGl2aXR5ICsgeFxuICAgICAgICAgICAgKiAocS5hdGhfc2Vuc2l0aXZpdHkgLSBwLmF0aF9zZW5zaXRpdml0eSk7XG4gICAgICAgIC8vIExFUlAoYXRoX3NlbnNpdGl2aXR5KTtcbiAgICAgICAgcC5pbnRlcmNoID0gcC5pbnRlcmNoICsgeCAqIChxLmludGVyY2ggLSBwLmludGVyY2gpO1xuICAgICAgICAvLyBMRVJQKGludGVyY2gpO1xuICAgICAgICAvLyBOT09QKHNhZmVqb2ludCk7XG4gICAgICAgIC8vIE5PT1Aoc2ZiMjFtb2QpO1xuICAgICAgICBwLm1zZml4ID0gcC5tc2ZpeCArIHggKiAocS5tc2ZpeCAtIHAubXNmaXgpO1xuICAgICAgICAvLyBMRVJQKG1zZml4KTtcblxuICAgICAgICBsYW1lX3NldF9WQlJfcShnZnAsIHNldC52YnJfcSk7XG5cbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5xdWFudF9jb21wID0gc2V0LnF1YW50X2NvbXA7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLnF1YW50X2NvbXAgLSAtMSkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5xdWFudF9jb21wID0gc2V0LnF1YW50X2NvbXA7XG4gICAgICAgIC8vIFNFVF9PUFRJT04ocXVhbnRfY29tcCwgc2V0LnF1YW50X2NvbXAsIC0xKTtcbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5xdWFudF9jb21wX3Nob3J0ID0gc2V0LnF1YW50X2NvbXBfcztcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAucXVhbnRfY29tcF9zaG9ydCAtIC0xKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLnF1YW50X2NvbXBfc2hvcnQgPSBzZXQucXVhbnRfY29tcF9zO1xuICAgICAgICAvLyBTRVRfT1BUSU9OKHF1YW50X2NvbXBfc2hvcnQsIHNldC5xdWFudF9jb21wX3MsIC0xKTtcbiAgICAgICAgaWYgKHNldC5leHBZICE9IDApIHtcbiAgICAgICAgICAgIGdmcC5leHBlcmltZW50YWxZID0gc2V0LmV4cFkgIT0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLmludGVybmFsX2ZsYWdzLm5zUHN5LmF0dGFja3RocmUgPSBzZXQuc3RfbHJtO1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5pbnRlcm5hbF9mbGFncy5uc1BzeS5hdHRhY2t0aHJlIC0gLTEpID4gMCkpXG4gICAgICAgICAgICBnZnAuaW50ZXJuYWxfZmxhZ3MubnNQc3kuYXR0YWNrdGhyZSA9IHNldC5zdF9scm07XG4gICAgICAgIC8vIFNFVF9PUFRJT04oc2hvcnRfdGhyZXNob2xkX2xybSwgc2V0LnN0X2xybSwgLTEpO1xuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLmludGVybmFsX2ZsYWdzLm5zUHN5LmF0dGFja3RocmVfcyA9IHNldC5zdF9zO1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5pbnRlcm5hbF9mbGFncy5uc1BzeS5hdHRhY2t0aHJlX3MgLSAtMSkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5pbnRlcm5hbF9mbGFncy5uc1BzeS5hdHRhY2t0aHJlX3MgPSBzZXQuc3RfcztcbiAgICAgICAgLy8gU0VUX09QVElPTihzaG9ydF90aHJlc2hvbGRfcywgc2V0LnN0X3MsIC0xKTtcbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5tYXNraW5nYWRqdXN0ID0gc2V0Lm1hc2tpbmdfYWRqO1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5tYXNraW5nYWRqdXN0IC0gMCkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5tYXNraW5nYWRqdXN0ID0gc2V0Lm1hc2tpbmdfYWRqO1xuICAgICAgICAvLyBTRVRfT1BUSU9OKG1hc2tpbmdhZGp1c3QsIHNldC5tYXNraW5nX2FkaiwgMCk7XG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAubWFza2luZ2FkanVzdF9zaG9ydCA9IHNldC5tYXNraW5nX2Fkal9zaG9ydDtcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAubWFza2luZ2FkanVzdF9zaG9ydCAtIDApID4gMCkpXG4gICAgICAgICAgICBnZnAubWFza2luZ2FkanVzdF9zaG9ydCA9IHNldC5tYXNraW5nX2Fkal9zaG9ydDtcbiAgICAgICAgLy8gU0VUX09QVElPTihtYXNraW5nYWRqdXN0X3Nob3J0LCBzZXQubWFza2luZ19hZGpfc2hvcnQsIDApO1xuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLkFUSGxvd2VyID0gLXNldC5hdGhfbG93ZXIgLyAxMC4wO1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKCgtZ2ZwLkFUSGxvd2VyICogMTAuMCkgLSAwKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLkFUSGxvd2VyID0gLXNldC5hdGhfbG93ZXIgLyAxMC4wO1xuICAgICAgICAvLyBTRVRfT1BUSU9OKEFUSGxvd2VyLCBzZXQuYXRoX2xvd2VyLCAwKTtcbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5BVEhjdXJ2ZSA9IHNldC5hdGhfY3VydmU7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLkFUSGN1cnZlIC0gLTEpID4gMCkpXG4gICAgICAgICAgICBnZnAuQVRIY3VydmUgPSBzZXQuYXRoX2N1cnZlO1xuICAgICAgICAvLyBTRVRfT1BUSU9OKEFUSGN1cnZlLCBzZXQuYXRoX2N1cnZlLCAtMSk7XG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAuYXRoYWFfc2Vuc2l0aXZpdHkgPSBzZXQuYXRoX3NlbnNpdGl2aXR5O1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5hdGhhYV9zZW5zaXRpdml0eSAtIC0xKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLmF0aGFhX3NlbnNpdGl2aXR5ID0gc2V0LmF0aF9zZW5zaXRpdml0eTtcbiAgICAgICAgLy8gU0VUX09QVElPTihhdGhhYV9zZW5zaXRpdml0eSwgc2V0LmF0aF9zZW5zaXRpdml0eSwgMCk7XG4gICAgICAgIGlmIChzZXQuaW50ZXJjaCA+IDApIHtcbiAgICAgICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICAgICAgZ2ZwLmludGVyQ2hSYXRpbyA9IHNldC5pbnRlcmNoO1xuICAgICAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAuaW50ZXJDaFJhdGlvIC0gLTEpID4gMCkpXG4gICAgICAgICAgICAgICAgZ2ZwLmludGVyQ2hSYXRpbyA9IHNldC5pbnRlcmNoO1xuICAgICAgICAgICAgLy8gU0VUX09QVElPTihpbnRlckNoUmF0aW8sIHNldC5pbnRlcmNoLCAtMSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBwYXJhbWV0ZXJzIGZvciB3aGljaCB0aGVyZSBpcyBubyBwcm9wZXIgc2V0L2dldCBpbnRlcmZhY2UgKi9cbiAgICAgICAgaWYgKHNldC5zYWZlam9pbnQgPiAwKSB7XG4gICAgICAgICAgICBnZnAuZXhwX25zcHN5dHVuZSA9IGdmcC5leHBfbnNwc3l0dW5lIHwgc2V0LnNhZmVqb2ludDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2V0LnNmYjIxbW9kID4gMCkge1xuICAgICAgICAgICAgZ2ZwLmV4cF9uc3BzeXR1bmUgPSBnZnAuZXhwX25zcHN5dHVuZSB8IChzZXQuc2ZiMjFtb2QgPDwgMjApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAubXNmaXggPSBzZXQubXNmaXg7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLm1zZml4IC0gLTEpID4gMCkpXG4gICAgICAgICAgICBnZnAubXNmaXggPSBzZXQubXNmaXg7XG4gICAgICAgIC8vIFNFVF9PUFRJT04obXNmaXgsIHNldC5tc2ZpeCwgLTEpO1xuXG4gICAgICAgIGlmIChlbmZvcmNlID09IDApIHtcbiAgICAgICAgICAgIGdmcC5WQlJfcSA9IGE7XG4gICAgICAgICAgICBnZnAuVkJSX3FfZnJhYyA9IHg7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiA8UFJFPlxuICAgICAqICBTd2l0Y2ggbWFwcGluZ3MgZm9yIEFCUiBtb2RlXG4gICAgICpcbiAgICAgKiAgICAgICAgICAgICAga2JwcyAgcXVhbnQgcV9zIHNhZmVqb2ludCBuc21zZml4IHN0X2xybSAgc3RfcyAgbnMtYmFzcyBzY2FsZSAgIG1zayBhdGhfbHdyIGF0aF9jdXJ2ZSAgaW50ZXJjaCAsIHNmc2NhbGVcbiAgICAgKiA8L1BSRT5cbiAgICAgKi9cbiAgICB2YXIgYWJyX3N3aXRjaF9tYXAgPSBbXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDgsIDksIDksIDAsIDAsIDYuNjAsIDE0NSwgMCwgMC45NSwgMCwgLTMwLjAsIDExLCAwLjAwMTIsIDEpLCAvKiAgIDgsIGltcG9zc2libGUgdG8gdXNlIGluIHN0ZXJlbyAqL1xuICAgICAgICBuZXcgQUJSUHJlc2V0cygxNiwgOSwgOSwgMCwgMCwgNi42MCwgMTQ1LCAwLCAwLjk1LCAwLCAtMjUuMCwgMTEsIDAuMDAxMCwgMSksIC8qICAxNiAqL1xuICAgICAgICBuZXcgQUJSUHJlc2V0cygyNCwgOSwgOSwgMCwgMCwgNi42MCwgMTQ1LCAwLCAwLjk1LCAwLCAtMjAuMCwgMTEsIDAuMDAxMCwgMSksIC8qICAyNCAqL1xuICAgICAgICBuZXcgQUJSUHJlc2V0cygzMiwgOSwgOSwgMCwgMCwgNi42MCwgMTQ1LCAwLCAwLjk1LCAwLCAtMTUuMCwgMTEsIDAuMDAxMCwgMSksIC8qICAzMiAqL1xuICAgICAgICBuZXcgQUJSUHJlc2V0cyg0MCwgOSwgOSwgMCwgMCwgNi42MCwgMTQ1LCAwLCAwLjk1LCAwLCAtMTAuMCwgMTEsIDAuMDAwOSwgMSksIC8qICA0MCAqL1xuICAgICAgICBuZXcgQUJSUHJlc2V0cyg0OCwgOSwgOSwgMCwgMCwgNi42MCwgMTQ1LCAwLCAwLjk1LCAwLCAtMTAuMCwgMTEsIDAuMDAwOSwgMSksIC8qICA0OCAqL1xuICAgICAgICBuZXcgQUJSUHJlc2V0cyg1NiwgOSwgOSwgMCwgMCwgNi42MCwgMTQ1LCAwLCAwLjk1LCAwLCAtNi4wLCAxMSwgMC4wMDA4LCAxKSwgLyogIDU2ICovXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDY0LCA5LCA5LCAwLCAwLCA2LjYwLCAxNDUsIDAsIDAuOTUsIDAsIC0yLjAsIDExLCAwLjAwMDgsIDEpLCAvKiAgNjQgKi9cbiAgICAgICAgbmV3IEFCUlByZXNldHMoODAsIDksIDksIDAsIDAsIDYuNjAsIDE0NSwgMCwgMC45NSwgMCwgLjAsIDgsIDAuMDAwNywgMSksIC8qICA4MCAqL1xuICAgICAgICBuZXcgQUJSUHJlc2V0cyg5NiwgOSwgOSwgMCwgMi41MCwgNi42MCwgMTQ1LCAwLCAwLjk1LCAwLCAxLjAsIDUuNSwgMC4wMDA2LCAxKSwgLyogIDk2ICovXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDExMiwgOSwgOSwgMCwgMi4yNSwgNi42MCwgMTQ1LCAwLCAwLjk1LCAwLCAyLjAsIDQuNSwgMC4wMDA1LCAxKSwgLyogMTEyICovXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDEyOCwgOSwgOSwgMCwgMS45NSwgNi40MCwgMTQwLCAwLCAwLjk1LCAwLCAzLjAsIDQsIDAuMDAwMiwgMSksIC8qIDEyOCAqL1xuICAgICAgICBuZXcgQUJSUHJlc2V0cygxNjAsIDksIDksIDEsIDEuNzksIDYuMDAsIDEzNSwgMCwgMC45NSwgLTIsIDUuMCwgMy41LCAwLCAxKSwgLyogMTYwICovXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDE5MiwgOSwgOSwgMSwgMS40OSwgNS42MCwgMTI1LCAwLCAwLjk3LCAtNCwgNy4wLCAzLCAwLCAwKSwgLyogMTkyICovXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDIyNCwgOSwgOSwgMSwgMS4yNSwgNS4yMCwgMTI1LCAwLCAwLjk4LCAtNiwgOS4wLCAyLCAwLCAwKSwgLyogMjI0ICovXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDI1NiwgOSwgOSwgMSwgMC45NywgNS4yMCwgMTI1LCAwLCAxLjAwLCAtOCwgMTAuMCwgMSwgMCwgMCksIC8qIDI1NiAqL1xuICAgICAgICBuZXcgQUJSUHJlc2V0cygzMjAsIDksIDksIDEsIDAuOTAsIDUuMjAsIDEyNSwgMCwgMS4wMCwgLTEwLCAxMi4wLCAwLCAwLCAwKSAgLyogMzIwICovXG4gICAgXTtcblxuICAgIGZ1bmN0aW9uIGFwcGx5X2Ficl9wcmVzZXQoZ2ZwLCBwcmVzZXQsIGVuZm9yY2UpIHtcbiAgICAgICAgLyogVmFyaWFibGVzIGZvciB0aGUgQUJSIHN0dWZmICovXG4gICAgICAgIHZhciBhY3R1YWxfYml0cmF0ZSA9IHByZXNldDtcblxuICAgICAgICB2YXIgciA9IGxhbWUubmVhcmVzdEJpdHJhdGVGdWxsSW5kZXgocHJlc2V0KTtcblxuICAgICAgICBnZnAuVkJSID0gVmJyTW9kZS52YnJfYWJyO1xuICAgICAgICBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzID0gYWN0dWFsX2JpdHJhdGU7XG4gICAgICAgIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMgPSBNYXRoLm1pbihnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzLCAzMjApO1xuICAgICAgICBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzID0gTWF0aC5tYXgoZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcywgOCk7XG4gICAgICAgIGdmcC5icmF0ZSA9IGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHM7XG4gICAgICAgIGlmIChnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzID4gMzIwKSB7XG4gICAgICAgICAgICBnZnAuZGlzYWJsZV9yZXNlcnZvaXIgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogcGFyYW1ldGVycyBmb3Igd2hpY2ggdGhlcmUgaXMgbm8gcHJvcGVyIHNldC9nZXQgaW50ZXJmYWNlICovXG4gICAgICAgIGlmIChhYnJfc3dpdGNoX21hcFtyXS5zYWZlam9pbnQgPiAwKVxuICAgICAgICAgICAgZ2ZwLmV4cF9uc3BzeXR1bmUgPSBnZnAuZXhwX25zcHN5dHVuZSB8IDI7XG4gICAgICAgIC8qIHNhZmVqb2ludCAqL1xuXG4gICAgICAgIGlmIChhYnJfc3dpdGNoX21hcFtyXS5zZnNjYWxlID4gMCkge1xuICAgICAgICAgICAgZ2ZwLmludGVybmFsX2ZsYWdzLm5vaXNlX3NoYXBpbmcgPSAyO1xuICAgICAgICB9XG4gICAgICAgIC8qIG5zLWJhc3MgdHdlYWtzICovXG4gICAgICAgIGlmIChNYXRoLmFicyhhYnJfc3dpdGNoX21hcFtyXS5uc2Jhc3MpID4gMCkge1xuICAgICAgICAgICAgdmFyIGsgPSAoaW50KShhYnJfc3dpdGNoX21hcFtyXS5uc2Jhc3MgKiA0KTtcbiAgICAgICAgICAgIGlmIChrIDwgMClcbiAgICAgICAgICAgICAgICBrICs9IDY0O1xuICAgICAgICAgICAgZ2ZwLmV4cF9uc3BzeXR1bmUgPSBnZnAuZXhwX25zcHN5dHVuZSB8IChrIDw8IDIpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5xdWFudF9jb21wID0gYWJyX3N3aXRjaF9tYXBbcl0ucXVhbnRfY29tcDtcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAucXVhbnRfY29tcCAtIC0xKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLnF1YW50X2NvbXAgPSBhYnJfc3dpdGNoX21hcFtyXS5xdWFudF9jb21wO1xuICAgICAgICAvLyBTRVRfT1BUSU9OKHF1YW50X2NvbXAsIGFicl9zd2l0Y2hfbWFwW3JdLnF1YW50X2NvbXAsIC0xKTtcbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5xdWFudF9jb21wX3Nob3J0ID0gYWJyX3N3aXRjaF9tYXBbcl0ucXVhbnRfY29tcF9zO1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5xdWFudF9jb21wX3Nob3J0IC0gLTEpID4gMCkpXG4gICAgICAgICAgICBnZnAucXVhbnRfY29tcF9zaG9ydCA9IGFicl9zd2l0Y2hfbWFwW3JdLnF1YW50X2NvbXBfcztcbiAgICAgICAgLy8gU0VUX09QVElPTihxdWFudF9jb21wX3Nob3J0LCBhYnJfc3dpdGNoX21hcFtyXS5xdWFudF9jb21wX3MsIC0xKTtcblxuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLm1zZml4ID0gYWJyX3N3aXRjaF9tYXBbcl0ubnNtc2ZpeDtcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAubXNmaXggLSAtMSkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5tc2ZpeCA9IGFicl9zd2l0Y2hfbWFwW3JdLm5zbXNmaXg7XG4gICAgICAgIC8vIFNFVF9PUFRJT04obXNmaXgsIGFicl9zd2l0Y2hfbWFwW3JdLm5zbXNmaXgsIC0xKTtcblxuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLmludGVybmFsX2ZsYWdzLm5zUHN5LmF0dGFja3RocmUgPSBhYnJfc3dpdGNoX21hcFtyXS5zdF9scm07XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLmludGVybmFsX2ZsYWdzLm5zUHN5LmF0dGFja3RocmUgLSAtMSkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5pbnRlcm5hbF9mbGFncy5uc1BzeS5hdHRhY2t0aHJlID0gYWJyX3N3aXRjaF9tYXBbcl0uc3RfbHJtO1xuICAgICAgICAvLyBTRVRfT1BUSU9OKHNob3J0X3RocmVzaG9sZF9scm0sIGFicl9zd2l0Y2hfbWFwW3JdLnN0X2xybSwgLTEpO1xuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLmludGVybmFsX2ZsYWdzLm5zUHN5LmF0dGFja3RocmVfcyA9IGFicl9zd2l0Y2hfbWFwW3JdLnN0X3M7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLmludGVybmFsX2ZsYWdzLm5zUHN5LmF0dGFja3RocmVfcyAtIC0xKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLmludGVybmFsX2ZsYWdzLm5zUHN5LmF0dGFja3RocmVfcyA9IGFicl9zd2l0Y2hfbWFwW3JdLnN0X3M7XG4gICAgICAgIC8vIFNFVF9PUFRJT04oc2hvcnRfdGhyZXNob2xkX3MsIGFicl9zd2l0Y2hfbWFwW3JdLnN0X3MsIC0xKTtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBBQlIgc2VlbXMgdG8gaGF2ZSBiaWcgcHJvYmxlbXMgd2l0aCBjbGlwcGluZywgZXNwZWNpYWxseSBhdCBsb3dcbiAgICAgICAgICogYml0cmF0ZXNcbiAgICAgICAgICovXG4gICAgICAgIC8qXG4gICAgICAgICAqIHNvIHdlIGNvbXBlbnNhdGUgZm9yIHRoYXQgaGVyZSBieSB1c2luZyBhIHNjYWxlIHZhbHVlIGRlcGVuZGluZyBvblxuICAgICAgICAgKiBiaXRyYXRlXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLnNjYWxlID0gYWJyX3N3aXRjaF9tYXBbcl0uc2NhbGU7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLnNjYWxlIC0gLTEpID4gMCkpXG4gICAgICAgICAgICBnZnAuc2NhbGUgPSBhYnJfc3dpdGNoX21hcFtyXS5zY2FsZTtcbiAgICAgICAgLy8gU0VUX09QVElPTihzY2FsZSwgYWJyX3N3aXRjaF9tYXBbcl0uc2NhbGUsIC0xKTtcblxuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLm1hc2tpbmdhZGp1c3QgPSBhYnJfc3dpdGNoX21hcFtyXS5tYXNraW5nX2FkajtcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAubWFza2luZ2FkanVzdCAtIDApID4gMCkpXG4gICAgICAgICAgICBnZnAubWFza2luZ2FkanVzdCA9IGFicl9zd2l0Y2hfbWFwW3JdLm1hc2tpbmdfYWRqO1xuICAgICAgICAvLyBTRVRfT1BUSU9OKG1hc2tpbmdhZGp1c3QsIGFicl9zd2l0Y2hfbWFwW3JdLm1hc2tpbmdfYWRqLCAwKTtcbiAgICAgICAgaWYgKGFicl9zd2l0Y2hfbWFwW3JdLm1hc2tpbmdfYWRqID4gMCkge1xuICAgICAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgICAgICBnZnAubWFza2luZ2FkanVzdF9zaG9ydCA9IChhYnJfc3dpdGNoX21hcFtyXS5tYXNraW5nX2FkaiAqIC45KTtcbiAgICAgICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLm1hc2tpbmdhZGp1c3Rfc2hvcnQgLSAwKSA+IDApKVxuICAgICAgICAgICAgICAgIGdmcC5tYXNraW5nYWRqdXN0X3Nob3J0ID0gKGFicl9zd2l0Y2hfbWFwW3JdLm1hc2tpbmdfYWRqICogLjkpO1xuICAgICAgICAgICAgLy8gU0VUX09QVElPTihtYXNraW5nYWRqdXN0X3Nob3J0LCBhYnJfc3dpdGNoX21hcFtyXS5tYXNraW5nX2FkaiAqXG4gICAgICAgICAgICAvLyAuOSwgMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgICAgIGdmcC5tYXNraW5nYWRqdXN0X3Nob3J0ID0gKGFicl9zd2l0Y2hfbWFwW3JdLm1hc2tpbmdfYWRqICogMS4xKTtcbiAgICAgICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLm1hc2tpbmdhZGp1c3Rfc2hvcnQgLSAwKSA+IDApKVxuICAgICAgICAgICAgICAgIGdmcC5tYXNraW5nYWRqdXN0X3Nob3J0ID0gKGFicl9zd2l0Y2hfbWFwW3JdLm1hc2tpbmdfYWRqICogMS4xKTtcbiAgICAgICAgICAgIC8vIFNFVF9PUFRJT04obWFza2luZ2FkanVzdF9zaG9ydCwgYWJyX3N3aXRjaF9tYXBbcl0ubWFza2luZ19hZGogKlxuICAgICAgICAgICAgLy8gMS4xLCAwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAuQVRIbG93ZXIgPSAtYWJyX3N3aXRjaF9tYXBbcl0uYXRoX2xvd2VyIC8gMTAuO1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKCgtZ2ZwLkFUSGxvd2VyICogMTAuKSAtIDApID4gMCkpXG4gICAgICAgICAgICBnZnAuQVRIbG93ZXIgPSAtYWJyX3N3aXRjaF9tYXBbcl0uYXRoX2xvd2VyIC8gMTAuO1xuICAgICAgICAvLyBTRVRfT1BUSU9OKEFUSGxvd2VyLCBhYnJfc3dpdGNoX21hcFtyXS5hdGhfbG93ZXIsIDApO1xuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLkFUSGN1cnZlID0gYWJyX3N3aXRjaF9tYXBbcl0uYXRoX2N1cnZlO1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5BVEhjdXJ2ZSAtIC0xKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLkFUSGN1cnZlID0gYWJyX3N3aXRjaF9tYXBbcl0uYXRoX2N1cnZlO1xuICAgICAgICAvLyBTRVRfT1BUSU9OKEFUSGN1cnZlLCBhYnJfc3dpdGNoX21hcFtyXS5hdGhfY3VydmUsIC0xKTtcblxuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLmludGVyQ2hSYXRpbyA9IGFicl9zd2l0Y2hfbWFwW3JdLmludGVyY2g7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLmludGVyQ2hSYXRpbyAtIC0xKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLmludGVyQ2hSYXRpbyA9IGFicl9zd2l0Y2hfbWFwW3JdLmludGVyY2g7XG4gICAgICAgIC8vIFNFVF9PUFRJT04oaW50ZXJDaFJhdGlvLCBhYnJfc3dpdGNoX21hcFtyXS5pbnRlcmNoLCAtMSk7XG5cbiAgICAgICAgcmV0dXJuIHByZXNldDtcbiAgICB9XG5cbiAgICB0aGlzLmFwcGx5X3ByZXNldCA9IGZ1bmN0aW9uKGdmcCwgcHJlc2V0LCBlbmZvcmNlKSB7XG4gICAgICAgIC8qIHRyYW5zbGF0ZSBsZWdhY3kgcHJlc2V0cyAqL1xuICAgICAgICBzd2l0Y2ggKHByZXNldCkge1xuICAgICAgICAgICAgY2FzZSBMYW1lLlIzTUlYOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHByZXNldCA9IExhbWUuVjM7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUiA9IFZick1vZGUudmJyX210cmg7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIExhbWUuTUVESVVNOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHByZXNldCA9IExhbWUuVjQ7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUiA9IFZick1vZGUudmJyX3JoO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBMYW1lLk1FRElVTV9GQVNUOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHByZXNldCA9IExhbWUuVjQ7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUiA9IFZick1vZGUudmJyX210cmg7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIExhbWUuU1RBTkRBUkQ6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJlc2V0ID0gTGFtZS5WMjtcbiAgICAgICAgICAgICAgICBnZnAuVkJSID0gVmJyTW9kZS52YnJfcmg7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIExhbWUuU1RBTkRBUkRfRkFTVDpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcmVzZXQgPSBMYW1lLlYyO1xuICAgICAgICAgICAgICAgIGdmcC5WQlIgPSBWYnJNb2RlLnZicl9tdHJoO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBMYW1lLkVYVFJFTUU6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJlc2V0ID0gTGFtZS5WMDtcbiAgICAgICAgICAgICAgICBnZnAuVkJSID0gVmJyTW9kZS52YnJfcmg7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIExhbWUuRVhUUkVNRV9GQVNUOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHByZXNldCA9IExhbWUuVjA7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUiA9IFZick1vZGUudmJyX210cmg7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIExhbWUuSU5TQU5FOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHByZXNldCA9IDMyMDtcbiAgICAgICAgICAgICAgICBnZnAucHJlc2V0ID0gcHJlc2V0O1xuICAgICAgICAgICAgICAgIGFwcGx5X2Ficl9wcmVzZXQoZ2ZwLCBwcmVzZXQsIGVuZm9yY2UpO1xuICAgICAgICAgICAgICAgIGdmcC5WQlIgPSBWYnJNb2RlLnZicl9vZmY7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByZXNldDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGdmcC5wcmVzZXQgPSBwcmVzZXQ7XG4gICAgICAgIHtcbiAgICAgICAgICAgIHN3aXRjaCAocHJlc2V0KSB7XG4gICAgICAgICAgICAgICAgY2FzZSBMYW1lLlY5OlxuICAgICAgICAgICAgICAgICAgICBhcHBseV92YnJfcHJlc2V0KGdmcCwgOSwgZW5mb3JjZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmVzZXQ7XG4gICAgICAgICAgICAgICAgY2FzZSBMYW1lLlY4OlxuICAgICAgICAgICAgICAgICAgICBhcHBseV92YnJfcHJlc2V0KGdmcCwgOCwgZW5mb3JjZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmVzZXQ7XG4gICAgICAgICAgICAgICAgY2FzZSBMYW1lLlY3OlxuICAgICAgICAgICAgICAgICAgICBhcHBseV92YnJfcHJlc2V0KGdmcCwgNywgZW5mb3JjZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmVzZXQ7XG4gICAgICAgICAgICAgICAgY2FzZSBMYW1lLlY2OlxuICAgICAgICAgICAgICAgICAgICBhcHBseV92YnJfcHJlc2V0KGdmcCwgNiwgZW5mb3JjZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmVzZXQ7XG4gICAgICAgICAgICAgICAgY2FzZSBMYW1lLlY1OlxuICAgICAgICAgICAgICAgICAgICBhcHBseV92YnJfcHJlc2V0KGdmcCwgNSwgZW5mb3JjZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmVzZXQ7XG4gICAgICAgICAgICAgICAgY2FzZSBMYW1lLlY0OlxuICAgICAgICAgICAgICAgICAgICBhcHBseV92YnJfcHJlc2V0KGdmcCwgNCwgZW5mb3JjZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmVzZXQ7XG4gICAgICAgICAgICAgICAgY2FzZSBMYW1lLlYzOlxuICAgICAgICAgICAgICAgICAgICBhcHBseV92YnJfcHJlc2V0KGdmcCwgMywgZW5mb3JjZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmVzZXQ7XG4gICAgICAgICAgICAgICAgY2FzZSBMYW1lLlYyOlxuICAgICAgICAgICAgICAgICAgICBhcHBseV92YnJfcHJlc2V0KGdmcCwgMiwgZW5mb3JjZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmVzZXQ7XG4gICAgICAgICAgICAgICAgY2FzZSBMYW1lLlYxOlxuICAgICAgICAgICAgICAgICAgICBhcHBseV92YnJfcHJlc2V0KGdmcCwgMSwgZW5mb3JjZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmVzZXQ7XG4gICAgICAgICAgICAgICAgY2FzZSBMYW1lLlYwOlxuICAgICAgICAgICAgICAgICAgICBhcHBseV92YnJfcHJlc2V0KGdmcCwgMCwgZW5mb3JjZSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcmVzZXQ7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKDggPD0gcHJlc2V0ICYmIHByZXNldCA8PSAzMjApIHtcbiAgICAgICAgICAgIHJldHVybiBhcHBseV9hYnJfcHJlc2V0KGdmcCwgcHJlc2V0LCBlbmZvcmNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIG5vIGNvcnJlc3BvbmRpbmcgcHJlc2V0IGZvdW5kICovXG4gICAgICAgIGdmcC5wcmVzZXQgPSAwO1xuICAgICAgICByZXR1cm4gcHJlc2V0O1xuICAgIH1cblxuICAgIC8vIFJlc3QgZnJvbSBnZXRzZXQuYzpcblxuICAgIC8qKlxuICAgICAqIFZCUiBxdWFsaXR5IGxldmVsLjxCUj5cbiAgICAgKiAwID0gaGlnaGVzdDxCUj5cbiAgICAgKiA5ID0gbG93ZXN0XG4gICAgICovXG4gICAgZnVuY3Rpb24gbGFtZV9zZXRfVkJSX3EoZ2ZwLCBWQlJfcSkge1xuICAgICAgICB2YXIgcmV0ID0gMDtcblxuICAgICAgICBpZiAoMCA+IFZCUl9xKSB7XG4gICAgICAgICAgICAvKiBVbmtub3duIFZCUiBxdWFsaXR5IGxldmVsISAqL1xuICAgICAgICAgICAgcmV0ID0gLTE7XG4gICAgICAgICAgICBWQlJfcSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKDkgPCBWQlJfcSkge1xuICAgICAgICAgICAgcmV0ID0gLTE7XG4gICAgICAgICAgICBWQlJfcSA9IDk7XG4gICAgICAgIH1cblxuICAgICAgICBnZnAuVkJSX3EgPSBWQlJfcTtcbiAgICAgICAgZ2ZwLlZCUl9xX2ZyYWMgPSAwO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH1cblxufVxuXG4vKlxuICogICAgICBiaXQgcmVzZXJ2b2lyIHNvdXJjZSBmaWxlXG4gKlxuICogICAgICBDb3B5cmlnaHQgKGMpIDE5OTktMjAwMCBNYXJrIFRheWxvclxuICpcbiAqIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3JcbiAqIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWNcbiAqIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlclxuICogdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLlxuICpcbiAqIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLFxuICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2ZcbiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VXG4gKiBMaWJyYXJ5IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cbiAqXG4gKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG4gKiBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHdyaXRlIHRvIHRoZVxuICogRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBJbmMuLCA1OSBUZW1wbGUgUGxhY2UgLSBTdWl0ZSAzMzAsXG4gKiBCb3N0b24sIE1BIDAyMTExLTEzMDcsIFVTQS5cbiAqL1xuXG4vKiAkSWQ6IFJlc2Vydm9pci5qYXZhLHYgMS45IDIwMTEvMDUvMjQgMjA6NDg6MDYga2VuY2hpcyBFeHAgJCAqL1xuXG4vL3BhY2thZ2UgbXAzO1xuXG4vKipcbiAqIFJlc3ZGcmFtZUJlZ2luOjxCUj5cbiAqIENhbGxlZCAocmVwZWF0ZWRseSkgYXQgdGhlIGJlZ2lubmluZyBvZiBhIGZyYW1lLiBVcGRhdGVzIHRoZSBtYXhpbXVtIHNpemUgb2ZcbiAqIHRoZSByZXNlcnZvaXIsIGFuZCBjaGVja3MgdG8gbWFrZSBzdXJlIG1haW5fZGF0YV9iZWdpbiB3YXMgc2V0IHByb3Blcmx5IGJ5XG4gKiB0aGUgZm9ybWF0dGVyPEJSPlxuICogQmFja2dyb3VuZCBpbmZvcm1hdGlvbjpcbiAqIFxuICogVGhpcyBpcyB0aGUgb3JpZ2luYWwgdGV4dCBmcm9tIHRoZSBJU08gc3RhbmRhcmQuIEJlY2F1c2Ugb2Ygc29vbyBtYW55IGJ1Z3NcbiAqIGFuZCBpcnJpdGF0aW9ucyBjb3JyZWN0aW5nIGNvbW1lbnRzIGFyZSBhZGRlZCBpbiBicmFja2V0cyBbXS4gQSAnXlcnIG1lYW5zXG4gKiB5b3Ugc2hvdWxkIHJlbW92ZSB0aGUgbGFzdCB3b3JkLlxuICogXG4gKiA8UFJFPlxuICogIDEuIFRoZSBmb2xsb3dpbmcgcnVsZSBjYW4gYmUgdXNlZCB0byBjYWxjdWxhdGUgdGhlIG1heGltdW1cbiAqICAgICBudW1iZXIgb2YgYml0cyB1c2VkIGZvciBvbmUgZ3JhbnVsZSBbXlcgZnJhbWVdOjxCUj5cbiAqICAgICBBdCB0aGUgaGlnaGVzdCBwb3NzaWJsZSBiaXRyYXRlIG9mIExheWVyIElJSSAoMzIwIGticHNcbiAqICAgICBwZXIgc3RlcmVvIHNpZ25hbCBbXldeV15XXSwgNDgga0h6KSB0aGUgZnJhbWVzIG11c3QgYmUgb2ZcbiAqICAgICBbXldeV15XIGFyZSBkZXNpZ25lZCB0byBoYXZlXSBjb25zdGFudCBsZW5ndGgsIGkuZS5cbiAqICAgICBvbmUgYnVmZmVyIFteV15XIHRoZSBmcmFtZV0gbGVuZ3RoIGlzOjxCUj5cbiAqIFxuICogICAgICAgICAzMjAga2JwcyAqIDExNTIvNDgga0h6ID0gNzY4MCBiaXQgPSA5NjAgYnl0ZVxuICogXG4gKiAgICAgVGhpcyB2YWx1ZSBpcyB1c2VkIGFzIHRoZSBtYXhpbXVtIGJ1ZmZlciBwZXIgY2hhbm5lbCBbXldeV10gYXRcbiAqICAgICBsb3dlciBiaXRyYXRlcyBbdGhhbiAzMjAga2Jwc10uIEF0IDY0IGticHMgbW9ubyBvciAxMjgga2Jwc1xuICogICAgIHN0ZXJlbyB0aGUgbWFpbiBncmFudWxlIGxlbmd0aCBpcyA2NCBrYnBzICogNTc2LzQ4IGtIeiA9IDc2OCBiaXRcbiAqICAgICBbcGVyIGdyYW51bGUgYW5kIGNoYW5uZWxdIGF0IDQ4IGtIeiBzYW1wbGluZyBmcmVxdWVuY3kuXG4gKiAgICAgVGhpcyBtZWFucyB0aGF0IHRoZXJlIGlzIGEgbWF4aW11bSBkZXZpYXRpb24gKHNob3J0IHRpbWUgYnVmZmVyXG4gKiAgICAgWz0gcmVzZXJ2b2lyXSkgb2YgNzY4MCAtIDIqMio3NjggPSA0NjA4IGJpdHMgaXMgYWxsb3dlZCBhdCA2NCBrYnBzLlxuICogICAgIFRoZSBhY3R1YWwgZGV2aWF0aW9uIGlzIGVxdWFsIHRvIHRoZSBudW1iZXIgb2YgYnl0ZXMgW3dpdGggdGhlXG4gKiAgICAgbWVhbmluZyBvZiBvY3RldHNdIGRlbm90ZWQgYnkgdGhlIG1haW5fZGF0YV9lbmQgb2Zmc2V0IHBvaW50ZXIuXG4gKiAgICAgVGhlIGFjdHVhbCBtYXhpbXVtIGRldmlhdGlvbiBpcyAoMl45LTEpKjggYml0ID0gNDA4OCBiaXRzXG4gKiAgICAgW2ZvciBNUEVHLTEgYW5kICgyXjgtMSkqOCBiaXQgZm9yIE1QRUctMiwgYm90aCBhcmUgaGFyZCBsaW1pdHNdLlxuICogICAgIC4uLiBUaGUgeGNoYW5nZSBvZiBidWZmZXIgYml0cyBiZXR3ZWVuIHRoZSBsZWZ0IGFuZCByaWdodCBjaGFubmVsXG4gKiAgICAgaXMgYWxsb3dlZCB3aXRob3V0IHJlc3RyaWN0aW9ucyBbZXhjZXB0aW9uOiBkdWFsIGNoYW5uZWxdLlxuICogICAgIEJlY2F1c2Ugb2YgdGhlIFtjb25zdHJ1Y3RlZF0gY29uc3RyYWludCBvbiB0aGUgYnVmZmVyIHNpemVcbiAqICAgICBtYWluX2RhdGFfZW5kIGlzIGFsd2F5cyBzZXQgdG8gMCBpbiB0aGUgY2FzZSBvZiBiaXRfcmF0ZV9pbmRleD09MTQsXG4gKiAgICAgaS5lLiBkYXRhIHJhdGUgMzIwIGticHMgcGVyIHN0ZXJlbyBzaWduYWwgW15XXldeV10uIEluIHRoaXMgY2FzZVxuICogICAgIGFsbCBkYXRhIGFyZSBhbGxvY2F0ZWQgYmV0d2VlbiBhZGphY2VudCBoZWFkZXIgW15XIHN5bmNdIHdvcmRzXG4gKiAgICAgWywgaS5lLiB0aGVyZSBpcyBubyBidWZmZXJpbmcgYXQgYWxsXS5cbiAqIDwvUFJFPlxuICovXG5cblxuZnVuY3Rpb24gUmVzZXJ2b2lyKCkge1xuXHR2YXIgYnM7XG5cblx0dGhpcy5zZXRNb2R1bGVzICA9IGZ1bmN0aW9uKF9icykge1xuXHRcdGJzID0gX2JzO1xuXHR9XG5cblx0dGhpcy5SZXN2RnJhbWVCZWdpbiA9IGZ1bmN0aW9uKGdmcCwgbWVhbl9iaXRzKSB7XG5cdFx0dmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblx0XHR2YXIgbWF4bXAzYnVmO1xuXHRcdHZhciBsM19zaWRlID0gZ2ZjLmwzX3NpZGU7XG5cblx0XHR2YXIgZnJhbWVMZW5ndGggPSBicy5nZXRmcmFtZWJpdHMoZ2ZwKTtcblx0XHRtZWFuX2JpdHMuYml0cyA9IChmcmFtZUxlbmd0aCAtIGdmYy5zaWRlaW5mb19sZW4gKiA4KSAvIGdmYy5tb2RlX2dyO1xuXG5cdFx0LyoqXG5cdFx0ICogPFBSRT5cblx0XHQgKiAgTWVhbmluZyBvZiB0aGUgdmFyaWFibGVzOlxuXHRcdCAqICAgICAgcmVzdkxpbWl0OiAoMCwgOCwgLi4uLCA4KjI1NSAoTVBFRy0yKSwgOCo1MTEgKE1QRUctMSkpXG5cdFx0ICogICAgICAgICAgTnVtYmVyIG9mIGJpdHMgY2FuIGJlIHN0b3JlZCBpbiBwcmV2aW91cyBmcmFtZShzKSBkdWUgdG9cblx0XHQgKiAgICAgICAgICBjb3VudGVyIHNpemUgY29uc3RhaW50c1xuXHRcdCAqICAgICAgbWF4bXAzYnVmOiAoID8/PyAuLi4gOCoxOTUxIChNUEVHLTEgYW5kIDIpLCA4KjIwNDcgKE1QRUctMi41KSlcblx0XHQgKiAgICAgICAgICBOdW1iZXIgb2YgYml0cyBhbGxvd2VkIHRvIGVuY29kZSBvbmUgZnJhbWUgKHlvdSBjYW4gdGFrZSA4KjUxMSBiaXRcblx0XHQgKiAgICAgICAgICBmcm9tIHRoZSBiaXQgcmVzZXJ2b2lyIGFuZCBhdCBtb3N0IDgqMTQ0MCBiaXQgZnJvbSB0aGUgY3VycmVudFxuXHRcdCAqICAgICAgICAgIGZyYW1lICgzMjAga2JwcywgMzIga0h6KSwgc28gOCoxOTUxIGJpdCBpcyB0aGUgbGFyZ2VzdCBwb3NzaWJsZVxuXHRcdCAqICAgICAgICAgIHZhbHVlIGZvciBNUEVHLTEgYW5kIC0yKVxuXHRcdCAqIFxuXHRcdCAqICAgICAgICAgIG1heGltdW0gYWxsb3dlZCBncmFudWxlL2NoYW5uZWwgc2l6ZSB0aW1lcyA0ID0gOCoyMDQ3IGJpdHMuLFxuXHRcdCAqICAgICAgICAgIHNvIHRoaXMgaXMgdGhlIGFic29sdXRlIG1heGltdW0gc3VwcG9ydGVkIGJ5IHRoZSBmb3JtYXQuXG5cdFx0ICogXG5cdFx0ICogXG5cdFx0ICogICAgICBmdWxsRnJhbWVCaXRzOiAgbWF4aW11bSBudW1iZXIgb2YgYml0cyBhdmFpbGFibGUgZm9yIGVuY29kaW5nXG5cdFx0ICogICAgICAgICAgICAgICAgICAgICAgdGhlIGN1cnJlbnQgZnJhbWUuXG5cdFx0ICogXG5cdFx0ICogICAgICBtZWFuX2JpdHM6ICAgICAgdGFyZ2V0IG51bWJlciBvZiBiaXRzIHBlciBncmFudWxlLlxuXHRcdCAqIFxuXHRcdCAqICAgICAgZnJhbWVMZW5ndGg6XG5cdFx0ICogXG5cdFx0ICogICAgICBnZmMuUmVzdk1heDogICBtYXhpbXVtIGFsbG93ZWQgcmVzZXJ2b2lyXG5cdFx0ICogXG5cdFx0ICogICAgICBnZmMuUmVzdlNpemU6ICBjdXJyZW50IHJlc2Vydm9pciBzaXplXG5cdFx0ICogXG5cdFx0ICogICAgICBsM19zaWRlLnJlc3ZEcmFpbl9wcmU6XG5cdFx0ICogICAgICAgICBhbmNpbGxhcnkgZGF0YSB0byBiZSBhZGRlZCB0byBwcmV2aW91cyBmcmFtZTpcblx0XHQgKiAgICAgICAgIChvbmx5IHVzZWZ1bGwgaW4gVkJSIG1vZGVzIGlmIGl0IGlzIHBvc3NpYmxlIHRvIGhhdmVcblx0XHQgKiAgICAgICAgIG1heG1wM2J1ZiA8IGZ1bGxGcmFtZUJpdHMpKS4gIEN1cnJlbnRseSBkaXNhYmxlZCxcblx0XHQgKiAgICAgICAgIHNlZSAjZGVmaW5lIE5FV19EUkFJTlxuXHRcdCAqICAgICAgICAgMjAxMC0wMi0xMzogUkggbm93IGVuYWJsZWQsIGl0IHNlZW1zIHRvIGJlIG5lZWRlZCBmb3IgQ0JSIHRvbyxcblx0XHQgKiAgICAgICAgICAgICAgICAgICAgIGFzIHRoZXJlIGV4aXN0cyBvbmUgZXhhbXBsZSwgd2hlcmUgdGhlIEZoRyBkZWNvZGVyXG5cdFx0ICogICAgICAgICAgICAgICAgICAgICBjYW4ndCBkZWNvZGUgYSAtYjMyMCBDQlIgZmlsZSBhbnltb3JlLlxuXHRcdCAqIFxuXHRcdCAqICAgICAgbDNfc2lkZS5yZXN2RHJhaW5fcG9zdDpcblx0XHQgKiAgICAgICAgIGFuY2lsbGFyeSBkYXRhIHRvIGJlIGFkZGVkIHRvIHRoaXMgZnJhbWU6XG5cdFx0ICogXG5cdFx0ICogPC9QUkU+XG5cdFx0ICovXG5cblx0XHQvKiBtYWluX2RhdGFfYmVnaW4gaGFzIDkgYml0cyBpbiBNUEVHLTEsIDggYml0cyBNUEVHLTIgKi9cblx0XHR2YXIgcmVzdkxpbWl0ID0gKDggKiAyNTYpICogZ2ZjLm1vZGVfZ3IgLSA4O1xuXG5cdFx0Lypcblx0XHQgKiBtYXhpbXVtIGFsbG93ZWQgZnJhbWUgc2l6ZS4gZG9udCB1c2UgbW9yZSB0aGFuIHRoaXMgbnVtYmVyIG9mIGJpdHMsXG5cdFx0ICogZXZlbiBpZiB0aGUgZnJhbWUgaGFzIHRoZSBzcGFjZSBmb3IgdGhlbTpcblx0XHQgKi9cblx0XHRpZiAoZ2ZwLmJyYXRlID4gMzIwKSB7XG5cdFx0XHQvKiBpbiBmcmVlZm9ybWF0IHRoZSBidWZmZXIgaXMgY29uc3RhbnQgKi9cblx0XHRcdG1heG1wM2J1ZiA9IDggKiAoKGludCkgKChnZnAuYnJhdGUgKiAxMDAwKVxuXHRcdFx0XHRcdC8gKGdmcC5vdXRfc2FtcGxlcmF0ZSAvIDExNTIpIC8gOCArIC41KSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8qXG5cdFx0XHQgKiBhbGwgbXAzIGRlY29kZXJzIHNob3VsZCBoYXZlIGVub3VnaCBidWZmZXIgdG8gaGFuZGxlIHRoaXMgdmFsdWU6XG5cdFx0XHQgKiBzaXplIG9mIGEgMzIwa2JwcyAzMmtIeiBmcmFtZVxuXHRcdFx0ICovXG5cdFx0XHRtYXhtcDNidWYgPSA4ICogMTQ0MDtcblxuXHRcdFx0Lypcblx0XHRcdCAqIEJvdXZpZ25lIHN1Z2dlc3RzIHRoaXMgbW9yZSBsYXggaW50ZXJwcmV0YXRpb24gb2YgdGhlIElTTyBkb2Ncblx0XHRcdCAqIGluc3RlYWQgb2YgdXNpbmcgOCo5NjAuXG5cdFx0XHQgKi9cblxuXHRcdFx0aWYgKGdmcC5zdHJpY3RfSVNPKSB7XG5cdFx0XHRcdG1heG1wM2J1ZiA9IDggKiAoKGludCkgKDMyMDAwMCAvIChnZnAub3V0X3NhbXBsZXJhdGUgLyAxMTUyKSAvIDggKyAuNSkpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGdmYy5SZXN2TWF4ID0gbWF4bXAzYnVmIC0gZnJhbWVMZW5ndGg7XG5cdFx0aWYgKGdmYy5SZXN2TWF4ID4gcmVzdkxpbWl0KVxuXHRcdFx0Z2ZjLlJlc3ZNYXggPSByZXN2TGltaXQ7XG5cdFx0aWYgKGdmYy5SZXN2TWF4IDwgMCB8fCBnZnAuZGlzYWJsZV9yZXNlcnZvaXIpXG5cdFx0XHRnZmMuUmVzdk1heCA9IDA7XG5cblx0XHR2YXIgZnVsbEZyYW1lQml0cyA9IG1lYW5fYml0cy5iaXRzICogZ2ZjLm1vZGVfZ3Jcblx0XHRcdFx0KyBNYXRoLm1pbihnZmMuUmVzdlNpemUsIGdmYy5SZXN2TWF4KTtcblxuXHRcdGlmIChmdWxsRnJhbWVCaXRzID4gbWF4bXAzYnVmKVxuXHRcdFx0ZnVsbEZyYW1lQml0cyA9IG1heG1wM2J1ZjtcblxuXG5cdFx0bDNfc2lkZS5yZXN2RHJhaW5fcHJlID0gMDtcblxuXHRcdC8vIGZyYW1lIGFuYWx5emVyIGNvZGVcblx0XHRpZiAoZ2ZjLnBpbmZvICE9IG51bGwpIHtcblx0XHRcdC8qXG5cdFx0XHQgKiBleHBlY3RlZCBiaXRzIHBlciBjaGFubmVsIHBlciBncmFudWxlIFtpcyB0aGlzIGFsc28gcmlnaHQgZm9yXG5cdFx0XHQgKiBtb25vL3N0ZXJlbywgTVBFRy0xLzIgP11cblx0XHRcdCAqL1xuXHRcdFx0Z2ZjLnBpbmZvLm1lYW5fYml0cyA9IG1lYW5fYml0cy5iaXRzIC8gMjtcblx0XHRcdGdmYy5waW5mby5yZXN2c2l6ZSA9IGdmYy5SZXN2U2l6ZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gZnVsbEZyYW1lQml0cztcblx0fVxuXG5cdC8qKlxuXHQgKiByZXR1cm5zIHRhcmdfYml0czogdGFyZ2V0IG51bWJlciBvZiBiaXRzIHRvIHVzZSBmb3IgMSBncmFudWxlPEJSPlxuXHQgKiBleHRyYV9iaXRzOiBhbW91bnQgZXh0cmEgYXZhaWxhYmxlIGZyb20gcmVzZXJ2b2lyPEJSPlxuXHQgKiBNYXJrIFRheWxvciA0Lzk5XG5cdCAqL1xuXHR0aGlzLlJlc3ZNYXhCaXRzID0gZnVuY3Rpb24oZ2ZwLCBtZWFuX2JpdHMsIHRhcmdfYml0cywgY2JyKSB7XG5cdFx0dmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblx0XHR2YXIgYWRkX2JpdHM7XG4gICAgICAgIHZhciBSZXN2U2l6ZSA9IGdmYy5SZXN2U2l6ZSwgUmVzdk1heCA9IGdmYy5SZXN2TWF4O1xuXG5cdFx0LyogY29tcGVuc2F0ZSB0aGUgc2F2ZWQgYml0cyB1c2VkIGluIHRoZSAxc3QgZ3JhbnVsZSAqL1xuXHRcdGlmIChjYnIgIT0gMClcblx0XHRcdFJlc3ZTaXplICs9IG1lYW5fYml0cztcblxuXHRcdGlmICgoZ2ZjLnN1YnN0ZXBfc2hhcGluZyAmIDEpICE9IDApXG5cdFx0XHRSZXN2TWF4ICo9IDAuOTtcblxuXHRcdHRhcmdfYml0cy5iaXRzID0gbWVhbl9iaXRzO1xuXG5cdFx0LyogZXh0cmEgYml0cyBpZiB0aGUgcmVzZXJ2b2lyIGlzIGFsbW9zdCBmdWxsICovXG5cdFx0aWYgKFJlc3ZTaXplICogMTAgPiBSZXN2TWF4ICogOSkge1xuXHRcdFx0YWRkX2JpdHMgPSBSZXN2U2l6ZSAtIChSZXN2TWF4ICogOSkgLyAxMDtcblx0XHRcdHRhcmdfYml0cy5iaXRzICs9IGFkZF9iaXRzO1xuXHRcdFx0Z2ZjLnN1YnN0ZXBfc2hhcGluZyB8PSAweDgwO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRhZGRfYml0cyA9IDA7XG5cdFx0XHRnZmMuc3Vic3RlcF9zaGFwaW5nICY9IDB4N2Y7XG5cdFx0XHQvKlxuXHRcdFx0ICogYnVpbGQgdXAgcmVzZXJ2b2lyLiB0aGlzIGJ1aWxkcyB0aGUgcmVzZXJ2b2lyIGEgbGl0dGxlIHNsb3dlclxuXHRcdFx0ICogdGhhbiBGaEcuIEl0IGNvdWxkIHNpbXBsZSBiZSBtZWFuX2JpdHMvMTUsIGJ1dCB0aGlzIHdhcyByaWdnZWQgdG9cblx0XHRcdCAqIGFsd2F5cyBwcm9kdWNlIDEwMCAodGhlIG9sZCB2YWx1ZSkgYXQgMTI4a2JzXG5cdFx0XHQgKi9cblx0XHRcdGlmICghZ2ZwLmRpc2FibGVfcmVzZXJ2b2lyICYmIDAgPT0gKGdmYy5zdWJzdGVwX3NoYXBpbmcgJiAxKSlcblx0XHRcdFx0dGFyZ19iaXRzLmJpdHMgLT0gLjEgKiBtZWFuX2JpdHM7XG5cdFx0fVxuXG5cdFx0LyogYW1vdW50IGZyb20gdGhlIHJlc2Vydm9pciB3ZSBhcmUgYWxsb3dlZCB0byB1c2UuIElTTyBzYXlzIDYvMTAgKi9cblx0XHR2YXIgZXh0cmFfYml0cyA9IChSZXN2U2l6ZSA8IChnZmMuUmVzdk1heCAqIDYpIC8gMTAgPyBSZXN2U2l6ZVxuXHRcdFx0XHQ6IChnZmMuUmVzdk1heCAqIDYpIC8gMTApO1xuXHRcdGV4dHJhX2JpdHMgLT0gYWRkX2JpdHM7XG5cblx0XHRpZiAoZXh0cmFfYml0cyA8IDApXG5cdFx0XHRleHRyYV9iaXRzID0gMDtcblx0XHRyZXR1cm4gZXh0cmFfYml0cztcblx0fVxuXG5cdC8qKlxuXHQgKiBDYWxsZWQgYWZ0ZXIgYSBncmFudWxlJ3MgYml0IGFsbG9jYXRpb24uIFJlYWRqdXN0cyB0aGUgc2l6ZSBvZiB0aGVcblx0ICogcmVzZXJ2b2lyIHRvIHJlZmxlY3QgdGhlIGdyYW51bGUncyB1c2FnZS5cblx0ICovXG5cdHRoaXMuUmVzdkFkanVzdCA9IGZ1bmN0aW9uKGdmYywgZ2kpIHtcblx0XHRnZmMuUmVzdlNpemUgLT0gZ2kucGFydDJfM19sZW5ndGggKyBnaS5wYXJ0Ml9sZW5ndGg7XG5cdH1cblxuXHQvKipcblx0ICogQ2FsbGVkIGFmdGVyIGFsbCBncmFudWxlcyBpbiBhIGZyYW1lIGhhdmUgYmVlbiBhbGxvY2F0ZWQuIE1ha2VzIHN1cmUgdGhhdFxuXHQgKiB0aGUgcmVzZXJ2b2lyIHNpemUgaXMgd2l0aGluIGxpbWl0cywgcG9zc2libHkgYnkgYWRkaW5nIHN0dWZmaW5nIGJpdHMuXG5cdCAqL1xuXHR0aGlzLlJlc3ZGcmFtZUVuZCA9IGZ1bmN0aW9uKGdmYywgbWVhbl9iaXRzKSB7XG5cdFx0dmFyIG92ZXJfYml0cztcblx0XHR2YXIgbDNfc2lkZSA9IGdmYy5sM19zaWRlO1xuXG5cdFx0Z2ZjLlJlc3ZTaXplICs9IG1lYW5fYml0cyAqIGdmYy5tb2RlX2dyO1xuXHRcdHZhciBzdHVmZmluZ0JpdHMgPSAwO1xuXHRcdGwzX3NpZGUucmVzdkRyYWluX3Bvc3QgPSAwO1xuXHRcdGwzX3NpZGUucmVzdkRyYWluX3ByZSA9IDA7XG5cblx0XHQvKiB3ZSBtdXN0IGJlIGJ5dGUgYWxpZ25lZCAqL1xuXHRcdGlmICgob3Zlcl9iaXRzID0gZ2ZjLlJlc3ZTaXplICUgOCkgIT0gMClcblx0XHRcdHN0dWZmaW5nQml0cyArPSBvdmVyX2JpdHM7XG5cblx0XHRvdmVyX2JpdHMgPSAoZ2ZjLlJlc3ZTaXplIC0gc3R1ZmZpbmdCaXRzKSAtIGdmYy5SZXN2TWF4O1xuXHRcdGlmIChvdmVyX2JpdHMgPiAwKSB7XG5cdFx0XHRzdHVmZmluZ0JpdHMgKz0gb3Zlcl9iaXRzO1xuXHRcdH1cblxuXHRcdC8qXG5cdFx0ICogTk9URTogZW5hYmxpbmcgdGhlIE5FV19EUkFJTiBjb2RlIGZpeGVzIHNvbWUgcHJvYmxlbXMgd2l0aCBGaEdcblx0XHQgKiBkZWNvZGVyIHNoaXBwZWQgd2l0aCBNUyBXaW5kb3dzIG9wZXJhdGluZyBzeXN0ZW1zLiBVc2luZyB0aGlzLCBpdCBpc1xuXHRcdCAqIGV2ZW4gcG9zc2libGUgdG8gdXNlIEdhYnJpZWwncyBsYXggYnVmZmVyIGNvbnNpZGVyYXRpb24gYWdhaW4sIHdoaWNoXG5cdFx0ICogYXNzdW1lcywgYW55IGRlY29kZXIgc2hvdWxkIGhhdmUgYSBidWZmZXIgbGFyZ2UgZW5vdWdoIGZvciBhIDMyMCBrYnBzXG5cdFx0ICogZnJhbWUgYXQgMzIga0h6IHNhbXBsZSByYXRlLlxuXHRcdCAqIFxuXHRcdCAqIG9sZCBkcmFpbiBjb2RlOiBsYW1lIC1iMzIwIEJsYWNrQmlyZC53YXYgLS0uIGRvZXMgbm90IHBsYXkgd2l0aFxuXHRcdCAqIEdyYXBoRWRpdC5leGUgdXNpbmcgRmhHIGRlY29kZXIgVjEuNSBCdWlsZCA1MFxuXHRcdCAqIFxuXHRcdCAqIG5ldyBkcmFpbiBjb2RlOiBsYW1lIC1iMzIwIEJsYWNrQmlyZC53YXYgLS0uIHBsYXlzIGZpbmUgd2l0aFxuXHRcdCAqIEdyYXBoRWRpdC5leGUgdXNpbmcgRmhHIGRlY29kZXIgVjEuNSBCdWlsZCA1MFxuXHRcdCAqIFxuXHRcdCAqIFJvYmVydCBIZWdlbWFubiwgMjAxMC0wMi0xMy5cblx0XHQgKi9cblx0XHQvKlxuXHRcdCAqIGRyYWluIGFzIG1hbnkgYml0cyBhcyBwb3NzaWJsZSBpbnRvIHByZXZpb3VzIGZyYW1lIGFuY2lsbGFyeSBkYXRhIEluXG5cdFx0ICogcGFydGljdWxhciwgaW4gVkJSIG1vZGUgUmVzdk1heCBtYXkgaGF2ZSBjaGFuZ2VkLCBhbmQgd2UgaGF2ZSB0byBtYWtlXG5cdFx0ICogc3VyZSBtYWluX2RhdGFfYmVnaW4gZG9lcyBub3QgY3JlYXRlIGEgcmVzZXJ2b2lyIGJpZ2dlciB0aGFuIFJlc3ZNYXhcblx0XHQgKiBtdCA0LzAwXG5cdFx0ICovXG5cdFx0e1xuXHRcdFx0dmFyIG1kYl9ieXRlcyA9IE1hdGgubWluKGwzX3NpZGUubWFpbl9kYXRhX2JlZ2luICogOCwgc3R1ZmZpbmdCaXRzKSAvIDg7XG5cdFx0XHRsM19zaWRlLnJlc3ZEcmFpbl9wcmUgKz0gOCAqIG1kYl9ieXRlcztcblx0XHRcdHN0dWZmaW5nQml0cyAtPSA4ICogbWRiX2J5dGVzO1xuXHRcdFx0Z2ZjLlJlc3ZTaXplIC09IDggKiBtZGJfYnl0ZXM7XG5cdFx0XHRsM19zaWRlLm1haW5fZGF0YV9iZWdpbiAtPSBtZGJfYnl0ZXM7XG5cdFx0fVxuXHRcdC8qIGRyYWluIHRoZSByZXN0IGludG8gdGhpcyBmcmFtZXMgYW5jaWxsYXJ5IGRhdGEgKi9cblx0XHRsM19zaWRlLnJlc3ZEcmFpbl9wb3N0ICs9IHN0dWZmaW5nQml0cztcblx0XHRnZmMuUmVzdlNpemUgLT0gc3R1ZmZpbmdCaXRzO1xuXHR9XG59XG5cblxuLyoqXG4gKiBBIFZiciBoZWFkZXIgbWF5IGJlIHByZXNlbnQgaW4gdGhlIGFuY2lsbGFyeSBkYXRhIGZpZWxkIG9mIHRoZSBmaXJzdCBmcmFtZSBvZlxuICogYW4gbXAzIGJpdHN0cmVhbTxCUj5cbiAqIFRoZSBWYnIgaGVhZGVyIChvcHRpb25hbGx5KSBjb250YWluc1xuICogPFVMPlxuICogPExJPmZyYW1lcyB0b3RhbCBudW1iZXIgb2YgYXVkaW8gZnJhbWVzIGluIHRoZSBiaXRzdHJlYW1cbiAqIDxMST5ieXRlcyB0b3RhbCBudW1iZXIgb2YgYnl0ZXMgaW4gdGhlIGJpdHN0cmVhbVxuICogPExJPnRvYyB0YWJsZSBvZiBjb250ZW50c1xuICogPC9VTD5cbiAqXG4gKiB0b2MgKHRhYmxlIG9mIGNvbnRlbnRzKSBnaXZlcyBzZWVrIHBvaW50cyBmb3IgcmFuZG9tIGFjY2Vzcy48QlI+XG4gKiBUaGUgaXRoIGVudHJ5IGRldGVybWluZXMgdGhlIHNlZWsgcG9pbnQgZm9yIGktcGVyY2VudCBkdXJhdGlvbi48QlI+XG4gKiBzZWVrIHBvaW50IGluIGJ5dGVzID0gKHRvY1tpXS8yNTYuMCkgKiB0b3RhbF9iaXRzdHJlYW1fYnl0ZXM8QlI+XG4gKiBlLmcuIGhhbGYgZHVyYXRpb24gc2VlayBwb2ludCA9ICh0b2NbNTBdLzI1Ni4wKSAqIHRvdGFsX2JpdHN0cmVhbV9ieXRlc1xuICovXG5WQlJUYWcuTlVNVE9DRU5UUklFUyA9IDEwMDtcblZCUlRhZy5NQVhGUkFNRVNJWkUgPSAyODgwO1xuXG5mdW5jdGlvbiBWQlJUYWcoKSB7XG5cbiAgICB2YXIgbGFtZTtcbiAgICB2YXIgYnM7XG4gICAgdmFyIHY7XG5cbiAgICB0aGlzLnNldE1vZHVsZXMgPSBmdW5jdGlvbiAoX2xhbWUsIF9icywgX3YpIHtcbiAgICAgICAgbGFtZSA9IF9sYW1lO1xuICAgICAgICBicyA9IF9icztcbiAgICAgICAgdiA9IF92O1xuICAgIH07XG5cdFxuXHQvL2ZpeCDnsr7nroBcblx0XG4gICAgLyoqXG4gICAgICogTG9va3VwIHRhYmxlIGZvciBmYXN0IENSQy0xNiBjb21wdXRhdGlvbi4gVXNlcyB0aGUgcG9seW5vbWlhbFxuICAgICAqIHheMTYreF4xNSt4XjIrMVxuICAgICAqL1xuICAgIHZhciBjcmMxNkxvb2t1cCA9IFsweDAwMDAsIDB4QzBDMSwgMHhDMTgxLCAweDAxNDAsXG4gICAgICAgIDB4QzMwMSwgMHgwM0MwLCAweDAyODAsIDB4QzI0MSwgMHhDNjAxLCAweDA2QzAsIDB4MDc4MCwgMHhDNzQxLFxuICAgICAgICAweDA1MDAsIDB4QzVDMSwgMHhDNDgxLCAweDA0NDAsIDB4Q0MwMSwgMHgwQ0MwLCAweDBEODAsIDB4Q0Q0MSxcbiAgICAgICAgMHgwRjAwLCAweENGQzEsIDB4Q0U4MSwgMHgwRTQwLCAweDBBMDAsIDB4Q0FDMSwgMHhDQjgxLCAweDBCNDAsXG4gICAgICAgIDB4QzkwMSwgMHgwOUMwLCAweDA4ODAsIDB4Qzg0MSwgMHhEODAxLCAweDE4QzAsIDB4MTk4MCwgMHhEOTQxLFxuICAgICAgICAweDFCMDAsIDB4REJDMSwgMHhEQTgxLCAweDFBNDAsIDB4MUUwMCwgMHhERUMxLCAweERGODEsIDB4MUY0MCxcbiAgICAgICAgMHhERDAxLCAweDFEQzAsIDB4MUM4MCwgMHhEQzQxLCAweDE0MDAsIDB4RDRDMSwgMHhENTgxLCAweDE1NDAsXG4gICAgICAgIDB4RDcwMSwgMHgxN0MwLCAweDE2ODAsIDB4RDY0MSwgMHhEMjAxLCAweDEyQzAsIDB4MTM4MCwgMHhEMzQxLFxuICAgICAgICAweDExMDAsIDB4RDFDMSwgMHhEMDgxLCAweDEwNDAsIDB4RjAwMSwgMHgzMEMwLCAweDMxODAsIDB4RjE0MSxcbiAgICAgICAgMHgzMzAwLCAweEYzQzEsIDB4RjI4MSwgMHgzMjQwLCAweDM2MDAsIDB4RjZDMSwgMHhGNzgxLCAweDM3NDAsXG4gICAgICAgIDB4RjUwMSwgMHgzNUMwLCAweDM0ODAsIDB4RjQ0MSwgMHgzQzAwLCAweEZDQzEsIDB4RkQ4MSwgMHgzRDQwLFxuICAgICAgICAweEZGMDEsIDB4M0ZDMCwgMHgzRTgwLCAweEZFNDEsIDB4RkEwMSwgMHgzQUMwLCAweDNCODAsIDB4RkI0MSxcbiAgICAgICAgMHgzOTAwLCAweEY5QzEsIDB4Rjg4MSwgMHgzODQwLCAweDI4MDAsIDB4RThDMSwgMHhFOTgxLCAweDI5NDAsXG4gICAgICAgIDB4RUIwMSwgMHgyQkMwLCAweDJBODAsIDB4RUE0MSwgMHhFRTAxLCAweDJFQzAsIDB4MkY4MCwgMHhFRjQxLFxuICAgICAgICAweDJEMDAsIDB4RURDMSwgMHhFQzgxLCAweDJDNDAsIDB4RTQwMSwgMHgyNEMwLCAweDI1ODAsIDB4RTU0MSxcbiAgICAgICAgMHgyNzAwLCAweEU3QzEsIDB4RTY4MSwgMHgyNjQwLCAweDIyMDAsIDB4RTJDMSwgMHhFMzgxLCAweDIzNDAsXG4gICAgICAgIDB4RTEwMSwgMHgyMUMwLCAweDIwODAsIDB4RTA0MSwgMHhBMDAxLCAweDYwQzAsIDB4NjE4MCwgMHhBMTQxLFxuICAgICAgICAweDYzMDAsIDB4QTNDMSwgMHhBMjgxLCAweDYyNDAsIDB4NjYwMCwgMHhBNkMxLCAweEE3ODEsIDB4Njc0MCxcbiAgICAgICAgMHhBNTAxLCAweDY1QzAsIDB4NjQ4MCwgMHhBNDQxLCAweDZDMDAsIDB4QUNDMSwgMHhBRDgxLCAweDZENDAsXG4gICAgICAgIDB4QUYwMSwgMHg2RkMwLCAweDZFODAsIDB4QUU0MSwgMHhBQTAxLCAweDZBQzAsIDB4NkI4MCwgMHhBQjQxLFxuICAgICAgICAweDY5MDAsIDB4QTlDMSwgMHhBODgxLCAweDY4NDAsIDB4NzgwMCwgMHhCOEMxLCAweEI5ODEsIDB4Nzk0MCxcbiAgICAgICAgMHhCQjAxLCAweDdCQzAsIDB4N0E4MCwgMHhCQTQxLCAweEJFMDEsIDB4N0VDMCwgMHg3RjgwLCAweEJGNDEsXG4gICAgICAgIDB4N0QwMCwgMHhCREMxLCAweEJDODEsIDB4N0M0MCwgMHhCNDAxLCAweDc0QzAsIDB4NzU4MCwgMHhCNTQxLFxuICAgICAgICAweDc3MDAsIDB4QjdDMSwgMHhCNjgxLCAweDc2NDAsIDB4NzIwMCwgMHhCMkMxLCAweEIzODEsIDB4NzM0MCxcbiAgICAgICAgMHhCMTAxLCAweDcxQzAsIDB4NzA4MCwgMHhCMDQxLCAweDUwMDAsIDB4OTBDMSwgMHg5MTgxLCAweDUxNDAsXG4gICAgICAgIDB4OTMwMSwgMHg1M0MwLCAweDUyODAsIDB4OTI0MSwgMHg5NjAxLCAweDU2QzAsIDB4NTc4MCwgMHg5NzQxLFxuICAgICAgICAweDU1MDAsIDB4OTVDMSwgMHg5NDgxLCAweDU0NDAsIDB4OUMwMSwgMHg1Q0MwLCAweDVEODAsIDB4OUQ0MSxcbiAgICAgICAgMHg1RjAwLCAweDlGQzEsIDB4OUU4MSwgMHg1RTQwLCAweDVBMDAsIDB4OUFDMSwgMHg5QjgxLCAweDVCNDAsXG4gICAgICAgIDB4OTkwMSwgMHg1OUMwLCAweDU4ODAsIDB4OTg0MSwgMHg4ODAxLCAweDQ4QzAsIDB4NDk4MCwgMHg4OTQxLFxuICAgICAgICAweDRCMDAsIDB4OEJDMSwgMHg4QTgxLCAweDRBNDAsIDB4NEUwMCwgMHg4RUMxLCAweDhGODEsIDB4NEY0MCxcbiAgICAgICAgMHg4RDAxLCAweDREQzAsIDB4NEM4MCwgMHg4QzQxLCAweDQ0MDAsIDB4ODRDMSwgMHg4NTgxLCAweDQ1NDAsXG4gICAgICAgIDB4ODcwMSwgMHg0N0MwLCAweDQ2ODAsIDB4ODY0MSwgMHg4MjAxLCAweDQyQzAsIDB4NDM4MCwgMHg4MzQxLFxuICAgICAgICAweDQxMDAsIDB4ODFDMSwgMHg4MDgxLCAweDQwNDBdO1xuXHRcdFxuXHQvL2ZpeCDnsr7nroBcblx0XG4gICAgLyoqXG4gICAgICogRmFzdCBDUkMtMTYgY29tcHV0YXRpb24gKHVzZXMgdGFibGUgY3JjMTZMb29rdXApLlxuICAgICAqXG4gICAgICogQHBhcmFtIHZhbHVlXG4gICAgICogQHBhcmFtIGNyY1xuICAgICAqIEByZXR1cm5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjcmNVcGRhdGVMb29rdXAodmFsdWUsIGNyYykge1xuICAgICAgICB2YXIgdG1wID0gY3JjIF4gdmFsdWU7XG4gICAgICAgIGNyYyA9IChjcmMgPj4gOCkgXiBjcmMxNkxvb2t1cFt0bXAgJiAweGZmXTtcbiAgICAgICAgcmV0dXJuIGNyYztcbiAgICB9XG5cbiAgICB0aGlzLnVwZGF0ZU11c2ljQ1JDID0gZnVuY3Rpb24gKGNyYywgYnVmZmVyLCBidWZmZXJQb3MsIHNpemUpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyArK2kpXG4gICAgICAgICAgICBjcmNbMF0gPSBjcmNVcGRhdGVMb29rdXAoYnVmZmVyW2J1ZmZlclBvcyArIGldLCBjcmNbMF0pO1xuICAgIH1cblxuXHQvL2ZpeCDnsr7nroBcbn1cblxuXG5cbkJpdFN0cmVhbS5FUSA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgcmV0dXJuIChNYXRoLmFicyhhKSA+IE1hdGguYWJzKGIpKSA/IChNYXRoLmFicygoYSkgLSAoYikpIDw9IChNYXRoXG4gICAgICAgIC5hYnMoYSkgKiAxZS02KSlcbiAgICAgICAgOiAoTWF0aC5hYnMoKGEpIC0gKGIpKSA8PSAoTWF0aC5hYnMoYikgKiAxZS02KSk7XG59O1xuXG5CaXRTdHJlYW0uTkVRID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICByZXR1cm4gIUJpdFN0cmVhbS5FUShhLCBiKTtcbn07XG5cbmZ1bmN0aW9uIEJpdFN0cmVhbSgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIENSQzE2X1BPTFlOT01JQUwgPSAweDgwMDU7XG5cbiAgICAvKlxuICAgICAqIHdlIHdvcmsgd2l0aCBpbnRzLCBzbyB3aGVuIGRvaW5nIGJpdCBtYW5pcHVsYXRpb24sIHdlIGxpbWl0IG91cnNlbHZlcyB0b1xuICAgICAqIE1BWF9MRU5HVEgtMiBqdXN0IHRvIGJlIG9uIHRoZSBzYWZlIHNpZGVcbiAgICAgKi9cbiAgICB2YXIgTUFYX0xFTkdUSCA9IDMyO1xuXG4gICAgLy9HYWluQW5hbHlzaXMgZ2E7XG4gICAgLy9NUEdMaWIgbXBnO1xuICAgIC8vVmVyc2lvbiB2ZXI7XG4gICAgLy9WQlJUYWcgdmJyO1xuICAgIHZhciBnYSA9IG51bGw7XG4gICAgdmFyIG1wZyA9IG51bGw7XG4gICAgdmFyIHZlciA9IG51bGw7XG4gICAgdmFyIHZiciA9IG51bGw7XG5cbiAgICAvL3B1YmxpYyBmaW5hbCB2b2lkIHNldE1vZHVsZXMoR2FpbkFuYWx5c2lzIGdhLCBNUEdMaWIgbXBnLCBWZXJzaW9uIHZlcixcbiAgICAvL1x0VkJSVGFnIHZicikge1xuXG4gICAgdGhpcy5zZXRNb2R1bGVzID0gZnVuY3Rpb24gKF9nYSwgX21wZywgX3ZlciwgX3Zicikge1xuICAgICAgICBnYSA9IF9nYTtcbiAgICAgICAgbXBnID0gX21wZztcbiAgICAgICAgdmVyID0gX3ZlcjtcbiAgICAgICAgdmJyID0gX3ZicjtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQml0IHN0cmVhbSBidWZmZXIuXG4gICAgICovXG4gICAgLy9wcml2YXRlIGJ5dGVbXSBidWY7XG4gICAgdmFyIGJ1ZiA9IG51bGw7XG4gICAgLyoqXG4gICAgICogQml0IGNvdW50ZXIgb2YgYml0IHN0cmVhbS5cbiAgICAgKi9cbiAgICB2YXIgdG90Yml0ID0gMDtcbiAgICAvKipcbiAgICAgKiBQb2ludGVyIHRvIHRvcCBieXRlIGluIGJ1ZmZlci5cbiAgICAgKi9cbiAgICB2YXIgYnVmQnl0ZUlkeCA9IDA7XG4gICAgLyoqXG4gICAgICogUG9pbnRlciB0byB0b3AgYml0IG9mIHRvcCBieXRlIGluIGJ1ZmZlci5cbiAgICAgKi9cbiAgICB2YXIgYnVmQml0SWR4ID0gMDtcblxuICAgIC8qKlxuICAgICAqIGNvbXB1dGUgYml0c3BlcmZyYW1lIGFuZCBtZWFuX2JpdHMgZm9yIGEgbGF5ZXIgSUlJIGZyYW1lXG4gICAgICovXG4gICAgdGhpcy5nZXRmcmFtZWJpdHMgPSBmdW5jdGlvbiAoZ2ZwKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBiaXRfcmF0ZTtcblxuICAgICAgICAvKiBnZXQgYml0cmF0ZSBpbiBrYnBzIFs/XSAqL1xuICAgICAgICBpZiAoZ2ZjLmJpdHJhdGVfaW5kZXggIT0gMClcbiAgICAgICAgICAgIGJpdF9yYXRlID0gVGFibGVzLmJpdHJhdGVfdGFibGVbZ2ZwLnZlcnNpb25dW2dmYy5iaXRyYXRlX2luZGV4XTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgYml0X3JhdGUgPSBnZnAuYnJhdGU7XG5cbiAgICAgICAgLyogbWFpbiBlbmNvZGluZyByb3V0aW5lIHRvZ2dsZXMgcGFkZGluZyBvbiBhbmQgb2ZmICovXG4gICAgICAgIC8qIG9uZSBMYXllcjMgU2xvdCBjb25zaXN0cyBvZiA4IGJpdHMgKi9cbiAgICAgICAgdmFyIGJ5dGVzID0gMCB8IChnZnAudmVyc2lvbiArIDEpICogNzIwMDAgKiBiaXRfcmF0ZSAvIGdmcC5vdXRfc2FtcGxlcmF0ZSArIGdmYy5wYWRkaW5nO1xuICAgICAgICByZXR1cm4gOCAqIGJ5dGVzO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBwdXRoZWFkZXJfYml0cyhnZmMpIHtcbiAgICAgICAgU3lzdGVtLmFycmF5Y29weShnZmMuaGVhZGVyW2dmYy53X3B0cl0uYnVmLCAwLCBidWYsIGJ1ZkJ5dGVJZHgsIGdmYy5zaWRlaW5mb19sZW4pO1xuICAgICAgICBidWZCeXRlSWR4ICs9IGdmYy5zaWRlaW5mb19sZW47XG4gICAgICAgIHRvdGJpdCArPSBnZmMuc2lkZWluZm9fbGVuICogODtcbiAgICAgICAgZ2ZjLndfcHRyID0gKGdmYy53X3B0ciArIDEpICYgKExhbWVJbnRlcm5hbEZsYWdzLk1BWF9IRUFERVJfQlVGIC0gMSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogd3JpdGUgaiBiaXRzIGludG8gdGhlIGJpdCBzdHJlYW1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBwdXRiaXRzMihnZmMsIHZhbCwgaikge1xuXG5cbiAgICAgICAgd2hpbGUgKGogPiAwKSB7XG4gICAgICAgICAgICB2YXIgaztcbiAgICAgICAgICAgIGlmIChidWZCaXRJZHggPT0gMCkge1xuICAgICAgICAgICAgICAgIGJ1ZkJpdElkeCA9IDg7XG4gICAgICAgICAgICAgICAgYnVmQnl0ZUlkeCsrO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuaGVhZGVyW2dmYy53X3B0cl0ud3JpdGVfdGltaW5nID09IHRvdGJpdCkge1xuICAgICAgICAgICAgICAgICAgICBwdXRoZWFkZXJfYml0cyhnZmMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBidWZbYnVmQnl0ZUlkeF0gPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBrID0gTWF0aC5taW4oaiwgYnVmQml0SWR4KTtcbiAgICAgICAgICAgIGogLT0gaztcblxuICAgICAgICAgICAgYnVmQml0SWR4IC09IGs7XG5cbiAgICAgICAgICAgIC8qIDMyIHRvbyBsYXJnZSBvbiAzMiBiaXQgbWFjaGluZXMgKi9cblxuICAgICAgICAgICAgYnVmW2J1ZkJ5dGVJZHhdIHw9ICgodmFsID4+IGopIDw8IGJ1ZkJpdElkeCk7XG4gICAgICAgICAgICB0b3RiaXQgKz0gaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHdyaXRlIGogYml0cyBpbnRvIHRoZSBiaXQgc3RyZWFtLCBpZ25vcmluZyBmcmFtZSBoZWFkZXJzXG4gICAgICovXG4gICAgZnVuY3Rpb24gcHV0Yml0c19ub2hlYWRlcnMoZ2ZjLCB2YWwsIGopIHtcblxuICAgICAgICB3aGlsZSAoaiA+IDApIHtcbiAgICAgICAgICAgIHZhciBrO1xuICAgICAgICAgICAgaWYgKGJ1ZkJpdElkeCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgYnVmQml0SWR4ID0gODtcbiAgICAgICAgICAgICAgICBidWZCeXRlSWR4Kys7XG4gICAgICAgICAgICAgICAgYnVmW2J1ZkJ5dGVJZHhdID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgayA9IE1hdGgubWluKGosIGJ1ZkJpdElkeCk7XG4gICAgICAgICAgICBqIC09IGs7XG5cbiAgICAgICAgICAgIGJ1ZkJpdElkeCAtPSBrO1xuXG4gICAgICAgICAgICAvKiAzMiB0b28gbGFyZ2Ugb24gMzIgYml0IG1hY2hpbmVzICovXG5cbiAgICAgICAgICAgIGJ1ZltidWZCeXRlSWR4XSB8PSAoKHZhbCA+PiBqKSA8PCBidWZCaXRJZHgpO1xuICAgICAgICAgICAgdG90Yml0ICs9IGs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTb21lIGNvbWJpbmF0aW9ucyBvZiBiaXRyYXRlLCBGcywgYW5kIHN0ZXJlbyBtYWtlIGl0IGltcG9zc2libGUgdG8gc3R1ZmZcbiAgICAgKiBvdXQgYSBmcmFtZSB1c2luZyBqdXN0IG1haW5fZGF0YSwgZHVlIHRvIHRoZSBsaW1pdGVkIG51bWJlciBvZiBiaXRzIHRvXG4gICAgICogaW5kaWNhdGUgbWFpbl9kYXRhX2xlbmd0aC4gSW4gdGhlc2Ugc2l0dWF0aW9ucywgd2UgcHV0IHN0dWZmaW5nIGJpdHMgaW50b1xuICAgICAqIHRoZSBhbmNpbGxhcnkgZGF0YS4uLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGRyYWluX2ludG9fYW5jaWxsYXJ5KGdmcCwgcmVtYWluaW5nQml0cykge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgaTtcblxuICAgICAgICBpZiAocmVtYWluaW5nQml0cyA+PSA4KSB7XG4gICAgICAgICAgICBwdXRiaXRzMihnZmMsIDB4NGMsIDgpO1xuICAgICAgICAgICAgcmVtYWluaW5nQml0cyAtPSA4O1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZW1haW5pbmdCaXRzID49IDgpIHtcbiAgICAgICAgICAgIHB1dGJpdHMyKGdmYywgMHg0MSwgOCk7XG4gICAgICAgICAgICByZW1haW5pbmdCaXRzIC09IDg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlbWFpbmluZ0JpdHMgPj0gOCkge1xuICAgICAgICAgICAgcHV0Yml0czIoZ2ZjLCAweDRkLCA4KTtcbiAgICAgICAgICAgIHJlbWFpbmluZ0JpdHMgLT0gODtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVtYWluaW5nQml0cyA+PSA4KSB7XG4gICAgICAgICAgICBwdXRiaXRzMihnZmMsIDB4NDUsIDgpO1xuICAgICAgICAgICAgcmVtYWluaW5nQml0cyAtPSA4O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHJlbWFpbmluZ0JpdHMgPj0gMzIpIHtcbiAgICAgICAgICAgIHZhciB2ZXJzaW9uID0gdmVyLmdldExhbWVTaG9ydFZlcnNpb24oKTtcbiAgICAgICAgICAgIGlmIChyZW1haW5pbmdCaXRzID49IDMyKVxuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCB2ZXJzaW9uLmxlbmd0aCAmJiByZW1haW5pbmdCaXRzID49IDg7ICsraSkge1xuICAgICAgICAgICAgICAgICAgICByZW1haW5pbmdCaXRzIC09IDg7XG4gICAgICAgICAgICAgICAgICAgIHB1dGJpdHMyKGdmYywgdmVyc2lvbi5jaGFyQ29kZUF0KGkpLCA4KTsgLy9maXgg6ZSZ6K+v55qE5L2/55SoY2hhckF0XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yICg7IHJlbWFpbmluZ0JpdHMgPj0gMTsgcmVtYWluaW5nQml0cyAtPSAxKSB7XG4gICAgICAgICAgICBwdXRiaXRzMihnZmMsIGdmYy5hbmNpbGxhcnlfZmxhZywgMSk7XG4gICAgICAgICAgICBnZmMuYW5jaWxsYXJ5X2ZsYWcgXj0gKCFnZnAuZGlzYWJsZV9yZXNlcnZvaXIgPyAxIDogMCk7XG4gICAgICAgIH1cblxuXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogd3JpdGUgTiBiaXRzIGludG8gdGhlIGhlYWRlclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHdyaXRlaGVhZGVyKGdmYywgdmFsLCBqKSB7XG4gICAgICAgIHZhciBwdHIgPSBnZmMuaGVhZGVyW2dmYy5oX3B0cl0ucHRyO1xuXG4gICAgICAgIHdoaWxlIChqID4gMCkge1xuICAgICAgICAgICAgdmFyIGsgPSBNYXRoLm1pbihqLCA4IC0gKHB0ciAmIDcpKTtcbiAgICAgICAgICAgIGogLT0gaztcbiAgICAgICAgICAgIC8qID4+IDMyIHRvbyBsYXJnZSBmb3IgMzIgYml0IG1hY2hpbmVzICovXG5cbiAgICAgICAgICAgIGdmYy5oZWFkZXJbZ2ZjLmhfcHRyXS5idWZbcHRyID4+IDNdIHw9ICgodmFsID4+IGopKSA8PCAoOCAtIChwdHIgJiA3KSAtIGspO1xuICAgICAgICAgICAgcHRyICs9IGs7XG4gICAgICAgIH1cbiAgICAgICAgZ2ZjLmhlYWRlcltnZmMuaF9wdHJdLnB0ciA9IHB0cjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBDUkNfdXBkYXRlKHZhbHVlLCBjcmMpIHtcbiAgICAgICAgdmFsdWUgPDw9IDg7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgODsgaSsrKSB7XG4gICAgICAgICAgICB2YWx1ZSA8PD0gMTtcbiAgICAgICAgICAgIGNyYyA8PD0gMTtcblxuICAgICAgICAgICAgaWYgKCgoKGNyYyBeIHZhbHVlKSAmIDB4MTAwMDApICE9IDApKVxuICAgICAgICAgICAgICAgIGNyYyBePSBDUkMxNl9QT0xZTk9NSUFMO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjcmM7XG4gICAgfVxuXG4gICAgdGhpcy5DUkNfd3JpdGVoZWFkZXIgPSBmdW5jdGlvbiAoZ2ZjLCBoZWFkZXIpIHtcbiAgICAgICAgdmFyIGNyYyA9IDB4ZmZmZjtcbiAgICAgICAgLyogKGpvKSBpbml0IGNyYzE2IGZvciBlcnJvcl9wcm90ZWN0aW9uICovXG5cbiAgICAgICAgY3JjID0gQ1JDX3VwZGF0ZShoZWFkZXJbMl0gJiAweGZmLCBjcmMpO1xuICAgICAgICBjcmMgPSBDUkNfdXBkYXRlKGhlYWRlclszXSAmIDB4ZmYsIGNyYyk7XG4gICAgICAgIGZvciAodmFyIGkgPSA2OyBpIDwgZ2ZjLnNpZGVpbmZvX2xlbjsgaSsrKSB7XG4gICAgICAgICAgICBjcmMgPSBDUkNfdXBkYXRlKGhlYWRlcltpXSAmIDB4ZmYsIGNyYyk7XG4gICAgICAgIH1cblxuICAgICAgICBoZWFkZXJbNF0gPSAoYnl0ZSkoY3JjID4+IDgpO1xuICAgICAgICBoZWFkZXJbNV0gPSAoYnl0ZSkoY3JjICYgMjU1KTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gZW5jb2RlU2lkZUluZm8yKGdmcCwgYml0c1BlckZyYW1lKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBsM19zaWRlO1xuICAgICAgICB2YXIgZ3IsIGNoO1xuXG4gICAgICAgIGwzX3NpZGUgPSBnZmMubDNfc2lkZTtcbiAgICAgICAgZ2ZjLmhlYWRlcltnZmMuaF9wdHJdLnB0ciA9IDA7XG4gICAgICAgIEFycmF5cy5maWxsKGdmYy5oZWFkZXJbZ2ZjLmhfcHRyXS5idWYsIDAsIGdmYy5zaWRlaW5mb19sZW4sIDApO1xuICAgICAgICBpZiAoZ2ZwLm91dF9zYW1wbGVyYXRlIDwgMTYwMDApXG4gICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIDB4ZmZlLCAxMik7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgMHhmZmYsIDEyKTtcbiAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAoZ2ZwLnZlcnNpb24pLCAxKTtcbiAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCA0IC0gMywgMik7XG4gICAgICAgIHdyaXRlaGVhZGVyKGdmYywgKCFnZnAuZXJyb3JfcHJvdGVjdGlvbiA/IDEgOiAwKSwgMSk7XG4gICAgICAgIHdyaXRlaGVhZGVyKGdmYywgKGdmYy5iaXRyYXRlX2luZGV4KSwgNCk7XG4gICAgICAgIHdyaXRlaGVhZGVyKGdmYywgKGdmYy5zYW1wbGVyYXRlX2luZGV4KSwgMik7XG4gICAgICAgIHdyaXRlaGVhZGVyKGdmYywgKGdmYy5wYWRkaW5nKSwgMSk7XG4gICAgICAgIHdyaXRlaGVhZGVyKGdmYywgKGdmcC5leHRlbnNpb24pLCAxKTtcbiAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAoZ2ZwLm1vZGUub3JkaW5hbCgpKSwgMik7XG4gICAgICAgIHdyaXRlaGVhZGVyKGdmYywgKGdmYy5tb2RlX2V4dCksIDIpO1xuICAgICAgICB3cml0ZWhlYWRlcihnZmMsIChnZnAuY29weXJpZ2h0KSwgMSk7XG4gICAgICAgIHdyaXRlaGVhZGVyKGdmYywgKGdmcC5vcmlnaW5hbCksIDEpO1xuICAgICAgICB3cml0ZWhlYWRlcihnZmMsIChnZnAuZW1waGFzaXMpLCAyKTtcbiAgICAgICAgaWYgKGdmcC5lcnJvcl9wcm90ZWN0aW9uKSB7XG4gICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIDAsIDE2KTtcbiAgICAgICAgICAgIC8qIGR1bW15ICovXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ2ZwLnZlcnNpb24gPT0gMSkge1xuICAgICAgICAgICAgLyogTVBFRzEgKi9cbiAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgKGwzX3NpZGUubWFpbl9kYXRhX2JlZ2luKSwgOSk7XG5cbiAgICAgICAgICAgIGlmIChnZmMuY2hhbm5lbHNfb3V0ID09IDIpXG4gICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBsM19zaWRlLnByaXZhdGVfYml0cywgMyk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBsM19zaWRlLnByaXZhdGVfYml0cywgNSk7XG5cbiAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYmFuZDtcbiAgICAgICAgICAgICAgICBmb3IgKGJhbmQgPSAwOyBiYW5kIDwgNDsgYmFuZCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgbDNfc2lkZS5zY2ZzaVtjaF1bYmFuZF0sIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yIChnciA9IDA7IGdyIDwgMjsgZ3IrKykge1xuICAgICAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdpID0gbDNfc2lkZS50dFtncl1bY2hdO1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnBhcnQyXzNfbGVuZ3RoICsgZ2kucGFydDJfbGVuZ3RoLCAxMik7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuYmlnX3ZhbHVlcyAvIDIsIDkpO1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLmdsb2JhbF9nYWluLCA4KTtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5zY2FsZWZhY19jb21wcmVzcywgNCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGdpLmJsb2NrX3R5cGUgIT0gRW5jb2Rlci5OT1JNX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgMSwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKiB3aW5kb3dfc3dpdGNoaW5nX2ZsYWcgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuYmxvY2tfdHlwZSwgMik7XG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLm1peGVkX2Jsb2NrX2ZsYWcsIDEpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2kudGFibGVfc2VsZWN0WzBdID09IDE0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdpLnRhYmxlX3NlbGVjdFswXSA9IDE2O1xuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS50YWJsZV9zZWxlY3RbMF0sIDUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdpLnRhYmxlX3NlbGVjdFsxXSA9PSAxNClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnaS50YWJsZV9zZWxlY3RbMV0gPSAxNjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kudGFibGVfc2VsZWN0WzFdLCA1KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5zdWJibG9ja19nYWluWzBdLCAzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuc3ViYmxvY2tfZ2FpblsxXSwgMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnN1YmJsb2NrX2dhaW5bMl0sIDMpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAwLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIHdpbmRvd19zd2l0Y2hpbmdfZmxhZyAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdpLnRhYmxlX3NlbGVjdFswXSA9PSAxNClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnaS50YWJsZV9zZWxlY3RbMF0gPSAxNjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kudGFibGVfc2VsZWN0WzBdLCA1KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnaS50YWJsZV9zZWxlY3RbMV0gPT0gMTQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2kudGFibGVfc2VsZWN0WzFdID0gMTY7XG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnRhYmxlX3NlbGVjdFsxXSwgNSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2kudGFibGVfc2VsZWN0WzJdID09IDE0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdpLnRhYmxlX3NlbGVjdFsyXSA9IDE2O1xuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS50YWJsZV9zZWxlY3RbMl0sIDUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnJlZ2lvbjBfY291bnQsIDQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5yZWdpb24xX2NvdW50LCAzKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnByZWZsYWcsIDEpO1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnNjYWxlZmFjX3NjYWxlLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5jb3VudDF0YWJsZV9zZWxlY3QsIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8qIE1QRUcyICovXG4gICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIChsM19zaWRlLm1haW5fZGF0YV9iZWdpbiksIDgpO1xuICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBsM19zaWRlLnByaXZhdGVfYml0cywgZ2ZjLmNoYW5uZWxzX291dCk7XG5cbiAgICAgICAgICAgIGdyID0gMDtcbiAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZ2kgPSBsM19zaWRlLnR0W2dyXVtjaF07XG4gICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5wYXJ0Ml8zX2xlbmd0aCArIGdpLnBhcnQyX2xlbmd0aCwgMTIpO1xuICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuYmlnX3ZhbHVlcyAvIDIsIDkpO1xuICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuZ2xvYmFsX2dhaW4sIDgpO1xuICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuc2NhbGVmYWNfY29tcHJlc3MsIDkpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGdpLmJsb2NrX3R5cGUgIT0gRW5jb2Rlci5OT1JNX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAxLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgLyogd2luZG93X3N3aXRjaGluZ19mbGFnICovXG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuYmxvY2tfdHlwZSwgMik7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kubWl4ZWRfYmxvY2tfZmxhZywgMSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGdpLnRhYmxlX3NlbGVjdFswXSA9PSAxNClcbiAgICAgICAgICAgICAgICAgICAgICAgIGdpLnRhYmxlX3NlbGVjdFswXSA9IDE2O1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnRhYmxlX3NlbGVjdFswXSwgNSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChnaS50YWJsZV9zZWxlY3RbMV0gPT0gMTQpXG4gICAgICAgICAgICAgICAgICAgICAgICBnaS50YWJsZV9zZWxlY3RbMV0gPSAxNjtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS50YWJsZV9zZWxlY3RbMV0sIDUpO1xuXG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuc3ViYmxvY2tfZ2FpblswXSwgMyk7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuc3ViYmxvY2tfZ2FpblsxXSwgMyk7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuc3ViYmxvY2tfZ2FpblsyXSwgMyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAwLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgLyogd2luZG93X3N3aXRjaGluZ19mbGFnICovXG4gICAgICAgICAgICAgICAgICAgIGlmIChnaS50YWJsZV9zZWxlY3RbMF0gPT0gMTQpXG4gICAgICAgICAgICAgICAgICAgICAgICBnaS50YWJsZV9zZWxlY3RbMF0gPSAxNjtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS50YWJsZV9zZWxlY3RbMF0sIDUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2kudGFibGVfc2VsZWN0WzFdID09IDE0KVxuICAgICAgICAgICAgICAgICAgICAgICAgZ2kudGFibGVfc2VsZWN0WzFdID0gMTY7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kudGFibGVfc2VsZWN0WzFdLCA1KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdpLnRhYmxlX3NlbGVjdFsyXSA9PSAxNClcbiAgICAgICAgICAgICAgICAgICAgICAgIGdpLnRhYmxlX3NlbGVjdFsyXSA9IDE2O1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnRhYmxlX3NlbGVjdFsyXSwgNSk7XG5cbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5yZWdpb24wX2NvdW50LCA0KTtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5yZWdpb24xX2NvdW50LCAzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnNjYWxlZmFjX3NjYWxlLCAxKTtcbiAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLmNvdW50MXRhYmxlX3NlbGVjdCwgMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ2ZwLmVycm9yX3Byb3RlY3Rpb24pIHtcbiAgICAgICAgICAgIC8qIChqbykgZXJyb3JfcHJvdGVjdGlvbjogYWRkIGNyYzE2IGluZm9ybWF0aW9uIHRvIGhlYWRlciAqL1xuICAgICAgICAgICAgQ1JDX3dyaXRlaGVhZGVyKGdmYywgZ2ZjLmhlYWRlcltnZmMuaF9wdHJdLmJ1Zik7XG4gICAgICAgIH1cblxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgb2xkID0gZ2ZjLmhfcHRyO1xuXG4gICAgICAgICAgICBnZmMuaF9wdHIgPSAob2xkICsgMSkgJiAoTGFtZUludGVybmFsRmxhZ3MuTUFYX0hFQURFUl9CVUYgLSAxKTtcbiAgICAgICAgICAgIGdmYy5oZWFkZXJbZ2ZjLmhfcHRyXS53cml0ZV90aW1pbmcgPSBnZmMuaGVhZGVyW29sZF0ud3JpdGVfdGltaW5nXG4gICAgICAgICAgICAgICAgKyBiaXRzUGVyRnJhbWU7XG5cbiAgICAgICAgICAgIGlmIChnZmMuaF9wdHIgPT0gZ2ZjLndfcHRyKSB7XG4gICAgICAgICAgICAgICAgLyogeWlrZXMhIHdlIGFyZSBvdXQgb2YgaGVhZGVyIGJ1ZmZlciBzcGFjZSAqL1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnJcbiAgICAgICAgICAgICAgICAgICAgLnByaW50bG4oXCJFcnJvcjogTUFYX0hFQURFUl9CVUYgdG9vIHNtYWxsIGluIGJpdHN0cmVhbS5jIFxcblwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaHVmZm1hbl9jb2Rlcl9jb3VudDEoZ2ZjLCBnaSkge1xuICAgICAgICAvKiBXcml0ZSBjb3VudDEgYXJlYSAqL1xuICAgICAgICB2YXIgaCA9IFRhYmxlcy5odFtnaS5jb3VudDF0YWJsZV9zZWxlY3QgKyAzMl07XG4gICAgICAgIHZhciBpLCBiaXRzID0gMDtcblxuICAgICAgICB2YXIgaXggPSBnaS5iaWdfdmFsdWVzO1xuICAgICAgICB2YXIgeHIgPSBnaS5iaWdfdmFsdWVzO1xuXG4gICAgICAgIGZvciAoaSA9IChnaS5jb3VudDEgLSBnaS5iaWdfdmFsdWVzKSAvIDQ7IGkgPiAwOyAtLWkpIHtcbiAgICAgICAgICAgIHZhciBodWZmYml0cyA9IDA7XG4gICAgICAgICAgICB2YXIgcCA9IDAsIHY7XG5cbiAgICAgICAgICAgIHYgPSBnaS5sM19lbmNbaXggKyAwXTtcbiAgICAgICAgICAgIGlmICh2ICE9IDApIHtcbiAgICAgICAgICAgICAgICBwICs9IDg7XG4gICAgICAgICAgICAgICAgaWYgKGdpLnhyW3hyICsgMF0gPCAwKVxuICAgICAgICAgICAgICAgICAgICBodWZmYml0cysrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2ID0gZ2kubDNfZW5jW2l4ICsgMV07XG4gICAgICAgICAgICBpZiAodiAhPSAwKSB7XG4gICAgICAgICAgICAgICAgcCArPSA0O1xuICAgICAgICAgICAgICAgIGh1ZmZiaXRzICo9IDI7XG4gICAgICAgICAgICAgICAgaWYgKGdpLnhyW3hyICsgMV0gPCAwKVxuICAgICAgICAgICAgICAgICAgICBodWZmYml0cysrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2ID0gZ2kubDNfZW5jW2l4ICsgMl07XG4gICAgICAgICAgICBpZiAodiAhPSAwKSB7XG4gICAgICAgICAgICAgICAgcCArPSAyO1xuICAgICAgICAgICAgICAgIGh1ZmZiaXRzICo9IDI7XG4gICAgICAgICAgICAgICAgaWYgKGdpLnhyW3hyICsgMl0gPCAwKVxuICAgICAgICAgICAgICAgICAgICBodWZmYml0cysrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2ID0gZ2kubDNfZW5jW2l4ICsgM107XG4gICAgICAgICAgICBpZiAodiAhPSAwKSB7XG4gICAgICAgICAgICAgICAgcCsrO1xuICAgICAgICAgICAgICAgIGh1ZmZiaXRzICo9IDI7XG4gICAgICAgICAgICAgICAgaWYgKGdpLnhyW3hyICsgM10gPCAwKVxuICAgICAgICAgICAgICAgICAgICBodWZmYml0cysrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpeCArPSA0O1xuICAgICAgICAgICAgeHIgKz0gNDtcbiAgICAgICAgICAgIHB1dGJpdHMyKGdmYywgaHVmZmJpdHMgKyBoLnRhYmxlW3BdLCBoLmhsZW5bcF0pO1xuICAgICAgICAgICAgYml0cyArPSBoLmhsZW5bcF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJpdHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW1wbGVtZW50cyB0aGUgcHNldWRvY29kZSBvZiBwYWdlIDk4IG9mIHRoZSBJU1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIEh1ZmZtYW5jb2RlKGdmYywgdGFibGVpbmRleCwgc3RhcnQsIGVuZCwgZ2kpIHtcbiAgICAgICAgdmFyIGggPSBUYWJsZXMuaHRbdGFibGVpbmRleF07XG4gICAgICAgIHZhciBiaXRzID0gMDtcblxuICAgICAgICBpZiAoMCA9PSB0YWJsZWluZGV4KVxuICAgICAgICAgICAgcmV0dXJuIGJpdHM7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyBpICs9IDIpIHtcbiAgICAgICAgICAgIHZhciBjYml0cyA9IDA7XG4gICAgICAgICAgICB2YXIgeGJpdHMgPSAwO1xuICAgICAgICAgICAgdmFyIGxpbmJpdHMgPSBoLnhsZW47XG4gICAgICAgICAgICB2YXIgeGxlbiA9IGgueGxlbjtcbiAgICAgICAgICAgIHZhciBleHQgPSAwO1xuICAgICAgICAgICAgdmFyIHgxID0gZ2kubDNfZW5jW2ldO1xuICAgICAgICAgICAgdmFyIHgyID0gZ2kubDNfZW5jW2kgKyAxXTtcblxuICAgICAgICAgICAgaWYgKHgxICE9IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoZ2kueHJbaV0gPCAwKVxuICAgICAgICAgICAgICAgICAgICBleHQrKztcbiAgICAgICAgICAgICAgICBjYml0cy0tO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGFibGVpbmRleCA+IDE1KSB7XG4gICAgICAgICAgICAgICAgLyogdXNlIEVTQy13b3JkcyAqL1xuICAgICAgICAgICAgICAgIGlmICh4MSA+IDE0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsaW5iaXRzX3gxID0geDEgLSAxNTtcbiAgICAgICAgICAgICAgICAgICAgZXh0IHw9IGxpbmJpdHNfeDEgPDwgMTtcbiAgICAgICAgICAgICAgICAgICAgeGJpdHMgPSBsaW5iaXRzO1xuICAgICAgICAgICAgICAgICAgICB4MSA9IDE1O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh4MiA+IDE0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsaW5iaXRzX3gyID0geDIgLSAxNTtcbiAgICAgICAgICAgICAgICAgICAgZXh0IDw8PSBsaW5iaXRzO1xuICAgICAgICAgICAgICAgICAgICBleHQgfD0gbGluYml0c194MjtcbiAgICAgICAgICAgICAgICAgICAgeGJpdHMgKz0gbGluYml0cztcbiAgICAgICAgICAgICAgICAgICAgeDIgPSAxNTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgeGxlbiA9IDE2O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoeDIgIT0gMCkge1xuICAgICAgICAgICAgICAgIGV4dCA8PD0gMTtcbiAgICAgICAgICAgICAgICBpZiAoZ2kueHJbaSArIDFdIDwgMClcbiAgICAgICAgICAgICAgICAgICAgZXh0Kys7XG4gICAgICAgICAgICAgICAgY2JpdHMtLTtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICB4MSA9IHgxICogeGxlbiArIHgyO1xuICAgICAgICAgICAgeGJpdHMgLT0gY2JpdHM7XG4gICAgICAgICAgICBjYml0cyArPSBoLmhsZW5beDFdO1xuXG5cbiAgICAgICAgICAgIHB1dGJpdHMyKGdmYywgaC50YWJsZVt4MV0sIGNiaXRzKTtcbiAgICAgICAgICAgIHB1dGJpdHMyKGdmYywgZXh0LCB4Yml0cyk7XG4gICAgICAgICAgICBiaXRzICs9IGNiaXRzICsgeGJpdHM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJpdHM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTm90ZSB0aGUgZGlzY3Vzc2lvbiBvZiBodWZmbWFuY29kZWJpdHMoKSBvbiBwYWdlcyAyOCBhbmQgMjkgb2YgdGhlIElTLCBhc1xuICAgICAqIHdlbGwgYXMgdGhlIGRlZmluaXRpb25zIG9mIHRoZSBzaWRlIGluZm9ybWF0aW9uIG9uIHBhZ2VzIDI2IGFuZCAyNy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBTaG9ydEh1ZmZtYW5jb2RlYml0cyhnZmMsIGdpKSB7XG4gICAgICAgIHZhciByZWdpb24xU3RhcnQgPSAzICogZ2ZjLnNjYWxlZmFjX2JhbmQuc1szXTtcbiAgICAgICAgaWYgKHJlZ2lvbjFTdGFydCA+IGdpLmJpZ192YWx1ZXMpXG4gICAgICAgICAgICByZWdpb24xU3RhcnQgPSBnaS5iaWdfdmFsdWVzO1xuXG4gICAgICAgIC8qIHNob3J0IGJsb2NrcyBkbyBub3QgaGF2ZSBhIHJlZ2lvbjIgKi9cbiAgICAgICAgdmFyIGJpdHMgPSBIdWZmbWFuY29kZShnZmMsIGdpLnRhYmxlX3NlbGVjdFswXSwgMCwgcmVnaW9uMVN0YXJ0LCBnaSk7XG4gICAgICAgIGJpdHMgKz0gSHVmZm1hbmNvZGUoZ2ZjLCBnaS50YWJsZV9zZWxlY3RbMV0sIHJlZ2lvbjFTdGFydCxcbiAgICAgICAgICAgIGdpLmJpZ192YWx1ZXMsIGdpKTtcbiAgICAgICAgcmV0dXJuIGJpdHM7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gTG9uZ0h1ZmZtYW5jb2RlYml0cyhnZmMsIGdpKSB7XG4gICAgICAgIHZhciBiaWd2YWx1ZXMsIGJpdHM7XG4gICAgICAgIHZhciByZWdpb24xU3RhcnQsIHJlZ2lvbjJTdGFydDtcblxuICAgICAgICBiaWd2YWx1ZXMgPSBnaS5iaWdfdmFsdWVzO1xuXG4gICAgICAgIHZhciBpID0gZ2kucmVnaW9uMF9jb3VudCArIDE7XG4gICAgICAgIHJlZ2lvbjFTdGFydCA9IGdmYy5zY2FsZWZhY19iYW5kLmxbaV07XG4gICAgICAgIGkgKz0gZ2kucmVnaW9uMV9jb3VudCArIDE7XG4gICAgICAgIHJlZ2lvbjJTdGFydCA9IGdmYy5zY2FsZWZhY19iYW5kLmxbaV07XG5cbiAgICAgICAgaWYgKHJlZ2lvbjFTdGFydCA+IGJpZ3ZhbHVlcylcbiAgICAgICAgICAgIHJlZ2lvbjFTdGFydCA9IGJpZ3ZhbHVlcztcblxuICAgICAgICBpZiAocmVnaW9uMlN0YXJ0ID4gYmlndmFsdWVzKVxuICAgICAgICAgICAgcmVnaW9uMlN0YXJ0ID0gYmlndmFsdWVzO1xuXG4gICAgICAgIGJpdHMgPSBIdWZmbWFuY29kZShnZmMsIGdpLnRhYmxlX3NlbGVjdFswXSwgMCwgcmVnaW9uMVN0YXJ0LCBnaSk7XG4gICAgICAgIGJpdHMgKz0gSHVmZm1hbmNvZGUoZ2ZjLCBnaS50YWJsZV9zZWxlY3RbMV0sIHJlZ2lvbjFTdGFydCxcbiAgICAgICAgICAgIHJlZ2lvbjJTdGFydCwgZ2kpO1xuICAgICAgICBiaXRzICs9IEh1ZmZtYW5jb2RlKGdmYywgZ2kudGFibGVfc2VsZWN0WzJdLCByZWdpb24yU3RhcnQsIGJpZ3ZhbHVlcyxcbiAgICAgICAgICAgIGdpKTtcbiAgICAgICAgcmV0dXJuIGJpdHM7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gd3JpdGVNYWluRGF0YShnZnApIHtcbiAgICAgICAgdmFyIGdyLCBjaCwgc2ZiLCBkYXRhX2JpdHMsIHRvdF9iaXRzID0gMDtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGwzX3NpZGUgPSBnZmMubDNfc2lkZTtcblxuICAgICAgICBpZiAoZ2ZwLnZlcnNpb24gPT0gMSkge1xuICAgICAgICAgICAgLyogTVBFRyAxICovXG4gICAgICAgICAgICBmb3IgKGdyID0gMDsgZ3IgPCAyOyBncisrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ2kgPSBsM19zaWRlLnR0W2dyXVtjaF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBzbGVuMSA9IFRha2VoaXJvLnNsZW4xX3RhYltnaS5zY2FsZWZhY19jb21wcmVzc107XG4gICAgICAgICAgICAgICAgICAgIHZhciBzbGVuMiA9IFRha2VoaXJvLnNsZW4yX3RhYltnaS5zY2FsZWZhY19jb21wcmVzc107XG4gICAgICAgICAgICAgICAgICAgIGRhdGFfYml0cyA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoc2ZiID0gMDsgc2ZiIDwgZ2kuc2ZiZGl2aWRlOyBzZmIrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdpLnNjYWxlZmFjW3NmYl0gPT0gLTEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBzY2ZzaSBpcyB1c2VkICovXG4gICAgICAgICAgICAgICAgICAgICAgICBwdXRiaXRzMihnZmMsIGdpLnNjYWxlZmFjW3NmYl0sIHNsZW4xKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFfYml0cyArPSBzbGVuMTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb3IgKDsgc2ZiIDwgZ2kuc2ZibWF4OyBzZmIrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdpLnNjYWxlZmFjW3NmYl0gPT0gLTEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBzY2ZzaSBpcyB1c2VkICovXG4gICAgICAgICAgICAgICAgICAgICAgICBwdXRiaXRzMihnZmMsIGdpLnNjYWxlZmFjW3NmYl0sIHNsZW4yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFfYml0cyArPSBzbGVuMjtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChnaS5ibG9ja190eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YV9iaXRzICs9IFNob3J0SHVmZm1hbmNvZGViaXRzKGdmYywgZ2kpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YV9iaXRzICs9IExvbmdIdWZmbWFuY29kZWJpdHMoZ2ZjLCBnaSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZGF0YV9iaXRzICs9IGh1ZmZtYW5fY29kZXJfY291bnQxKGdmYywgZ2kpO1xuICAgICAgICAgICAgICAgICAgICAvKiBkb2VzIGJpdGNvdW50IGluIHF1YW50aXplLmMgYWdyZWUgd2l0aCBhY3R1YWwgYml0IGNvdW50PyAqL1xuICAgICAgICAgICAgICAgICAgICB0b3RfYml0cyArPSBkYXRhX2JpdHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qIGZvciBjaCAqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogZm9yIGdyICovXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvKiBNUEVHIDIgKi9cbiAgICAgICAgICAgIGdyID0gMDtcbiAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZ2kgPSBsM19zaWRlLnR0W2dyXVtjaF07XG4gICAgICAgICAgICAgICAgdmFyIGksIHNmYl9wYXJ0aXRpb24sIHNjYWxlX2JpdHMgPSAwO1xuICAgICAgICAgICAgICAgIGRhdGFfYml0cyA9IDA7XG4gICAgICAgICAgICAgICAgc2ZiID0gMDtcbiAgICAgICAgICAgICAgICBzZmJfcGFydGl0aW9uID0gMDtcblxuICAgICAgICAgICAgICAgIGlmIChnaS5ibG9ja190eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKDsgc2ZiX3BhcnRpdGlvbiA8IDQ7IHNmYl9wYXJ0aXRpb24rKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNmYnMgPSBnaS5zZmJfcGFydGl0aW9uX3RhYmxlW3NmYl9wYXJ0aXRpb25dIC8gMztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzbGVuID0gZ2kuc2xlbltzZmJfcGFydGl0aW9uXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzZmJzOyBpKyssIHNmYisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHV0Yml0czIoZ2ZjLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1heChnaS5zY2FsZWZhY1tzZmIgKiAzICsgMF0sIDApLCBzbGVuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdXRiaXRzMihnZmMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWF4KGdpLnNjYWxlZmFjW3NmYiAqIDMgKyAxXSwgMCksIHNsZW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1dGJpdHMyKGdmYyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5tYXgoZ2kuc2NhbGVmYWNbc2ZiICogMyArIDJdLCAwKSwgc2xlbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVfYml0cyArPSAzICogc2xlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkYXRhX2JpdHMgKz0gU2hvcnRIdWZmbWFuY29kZWJpdHMoZ2ZjLCBnaSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICg7IHNmYl9wYXJ0aXRpb24gPCA0OyBzZmJfcGFydGl0aW9uKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZmJzID0gZ2kuc2ZiX3BhcnRpdGlvbl90YWJsZVtzZmJfcGFydGl0aW9uXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzbGVuID0gZ2kuc2xlbltzZmJfcGFydGl0aW9uXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzZmJzOyBpKyssIHNmYisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHV0Yml0czIoZ2ZjLCBNYXRoLm1heChnaS5zY2FsZWZhY1tzZmJdLCAwKSwgc2xlbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVfYml0cyArPSBzbGVuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRhdGFfYml0cyArPSBMb25nSHVmZm1hbmNvZGViaXRzKGdmYywgZ2kpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkYXRhX2JpdHMgKz0gaHVmZm1hbl9jb2Rlcl9jb3VudDEoZ2ZjLCBnaSk7XG4gICAgICAgICAgICAgICAgLyogZG9lcyBiaXRjb3VudCBpbiBxdWFudGl6ZS5jIGFncmVlIHdpdGggYWN0dWFsIGJpdCBjb3VudD8gKi9cbiAgICAgICAgICAgICAgICB0b3RfYml0cyArPSBzY2FsZV9iaXRzICsgZGF0YV9iaXRzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogZm9yIGNoICovXG4gICAgICAgIH1cbiAgICAgICAgLyogZm9yIGdmICovXG4gICAgICAgIHJldHVybiB0b3RfYml0cztcbiAgICB9XG5cbiAgICAvKiBtYWluX2RhdGEgKi9cblxuICAgIGZ1bmN0aW9uIFRvdGFsQnl0ZXMoKSB7XG4gICAgICAgIHRoaXMudG90YWwgPSAwO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogY29tcHV0ZSB0aGUgbnVtYmVyIG9mIGJpdHMgcmVxdWlyZWQgdG8gZmx1c2ggYWxsIG1wMyBmcmFtZXMgY3VycmVudGx5IGluXG4gICAgICogdGhlIGJ1ZmZlci4gVGhpcyBzaG91bGQgYmUgdGhlIHNhbWUgYXMgdGhlIHJlc2Vydm9pciBzaXplLiBPbmx5IGNhbGwgdGhpc1xuICAgICAqIHJvdXRpbmUgYmV0d2VlbiBmcmFtZXMgLSBpLmUuIG9ubHkgYWZ0ZXIgYWxsIGhlYWRlcnMgYW5kIGRhdGEgaGF2ZSBiZWVuXG4gICAgICogYWRkZWQgdG8gdGhlIGJ1ZmZlciBieSBmb3JtYXRfYml0c3RyZWFtKCkuXG4gICAgICpcbiAgICAgKiBBbHNvIGNvbXB1dGUgdG90YWxfYml0c19vdXRwdXQgPSBzaXplIG9mIG1wMyBidWZmZXIgKGluY2x1ZGluZyBmcmFtZVxuICAgICAqIGhlYWRlcnMgd2hpY2ggbWF5IG5vdCBoYXZlIHlldCBiZWVuIHNlbmQgdG8gdGhlIG1wMyBidWZmZXIpICsgbnVtYmVyIG9mXG4gICAgICogYml0cyBuZWVkZWQgdG8gZmx1c2ggYWxsIG1wMyBmcmFtZXMuXG4gICAgICpcbiAgICAgKiB0b3RhbF9ieXRlc19vdXRwdXQgaXMgdGhlIHNpemUgb2YgdGhlIG1wMyBvdXRwdXQgYnVmZmVyIGlmXG4gICAgICogbGFtZV9lbmNvZGVfZmx1c2hfbm9nYXAoKSB3YXMgY2FsbGVkIHJpZ2h0IG5vdy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb21wdXRlX2ZsdXNoYml0cyhnZnAsIHRvdGFsX2J5dGVzX291dHB1dCkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgZmx1c2hiaXRzLCByZW1haW5pbmdfaGVhZGVycztcbiAgICAgICAgdmFyIGJpdHNQZXJGcmFtZTtcbiAgICAgICAgdmFyIGxhc3RfcHRyLCBmaXJzdF9wdHI7XG4gICAgICAgIGZpcnN0X3B0ciA9IGdmYy53X3B0cjtcbiAgICAgICAgLyogZmlyc3QgaGVhZGVyIHRvIGFkZCB0byBiaXRzdHJlYW0gKi9cbiAgICAgICAgbGFzdF9wdHIgPSBnZmMuaF9wdHIgLSAxO1xuICAgICAgICAvKiBsYXN0IGhlYWRlciB0byBhZGQgdG8gYml0c3RyZWFtICovXG4gICAgICAgIGlmIChsYXN0X3B0ciA9PSAtMSlcbiAgICAgICAgICAgIGxhc3RfcHRyID0gTGFtZUludGVybmFsRmxhZ3MuTUFYX0hFQURFUl9CVUYgLSAxO1xuXG4gICAgICAgIC8qIGFkZCB0aGlzIG1hbnkgYml0cyB0byBiaXRzdHJlYW0gc28gd2UgY2FuIGZsdXNoIGFsbCBoZWFkZXJzICovXG4gICAgICAgIGZsdXNoYml0cyA9IGdmYy5oZWFkZXJbbGFzdF9wdHJdLndyaXRlX3RpbWluZyAtIHRvdGJpdDtcbiAgICAgICAgdG90YWxfYnl0ZXNfb3V0cHV0LnRvdGFsID0gZmx1c2hiaXRzO1xuXG4gICAgICAgIGlmIChmbHVzaGJpdHMgPj0gMCkge1xuICAgICAgICAgICAgLyogaWYgZmx1c2hiaXRzID49IDAsIHNvbWUgaGVhZGVycyBoYXZlIG5vdCB5ZXQgYmVlbiB3cml0dGVuICovXG4gICAgICAgICAgICAvKiByZWR1Y2UgZmx1c2hiaXRzIGJ5IHRoZSBzaXplIG9mIHRoZSBoZWFkZXJzICovXG4gICAgICAgICAgICByZW1haW5pbmdfaGVhZGVycyA9IDEgKyBsYXN0X3B0ciAtIGZpcnN0X3B0cjtcbiAgICAgICAgICAgIGlmIChsYXN0X3B0ciA8IGZpcnN0X3B0cilcbiAgICAgICAgICAgICAgICByZW1haW5pbmdfaGVhZGVycyA9IDEgKyBsYXN0X3B0ciAtIGZpcnN0X3B0clxuICAgICAgICAgICAgICAgICAgICArIExhbWVJbnRlcm5hbEZsYWdzLk1BWF9IRUFERVJfQlVGO1xuICAgICAgICAgICAgZmx1c2hiaXRzIC09IHJlbWFpbmluZ19oZWFkZXJzICogOCAqIGdmYy5zaWRlaW5mb19sZW47XG4gICAgICAgIH1cblxuICAgICAgICAvKlxuICAgICAgICAgKiBmaW5hbGx5LCBhZGQgc29tZSBiaXRzIHNvIHRoYXQgdGhlIGxhc3QgZnJhbWUgaXMgY29tcGxldGUgdGhlc2UgYml0c1xuICAgICAgICAgKiBhcmUgbm90IG5lY2Vzc2FyeSB0byBkZWNvZGUgdGhlIGxhc3QgZnJhbWUsIGJ1dCBzb21lIGRlY29kZXJzIHdpbGxcbiAgICAgICAgICogaWdub3JlIGxhc3QgZnJhbWUgaWYgdGhlc2UgYml0cyBhcmUgbWlzc2luZ1xuICAgICAgICAgKi9cbiAgICAgICAgYml0c1BlckZyYW1lID0gc2VsZi5nZXRmcmFtZWJpdHMoZ2ZwKTtcbiAgICAgICAgZmx1c2hiaXRzICs9IGJpdHNQZXJGcmFtZTtcbiAgICAgICAgdG90YWxfYnl0ZXNfb3V0cHV0LnRvdGFsICs9IGJpdHNQZXJGcmFtZTtcbiAgICAgICAgLyogcm91bmQgdXA6ICovXG4gICAgICAgIGlmICgodG90YWxfYnl0ZXNfb3V0cHV0LnRvdGFsICUgOCkgIT0gMClcbiAgICAgICAgICAgIHRvdGFsX2J5dGVzX291dHB1dC50b3RhbCA9IDEgKyAodG90YWxfYnl0ZXNfb3V0cHV0LnRvdGFsIC8gOCk7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHRvdGFsX2J5dGVzX291dHB1dC50b3RhbCA9ICh0b3RhbF9ieXRlc19vdXRwdXQudG90YWwgLyA4KTtcbiAgICAgICAgdG90YWxfYnl0ZXNfb3V0cHV0LnRvdGFsICs9IGJ1ZkJ5dGVJZHggKyAxO1xuXG4gICAgICAgIGlmIChmbHVzaGJpdHMgPCAwKSB7XG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJzdHJhbmdlIGVycm9yIGZsdXNoaW5nIGJ1ZmZlciAuLi4gXFxuXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmbHVzaGJpdHM7XG4gICAgfVxuXG4gICAgdGhpcy5mbHVzaF9iaXRzdHJlYW0gPSBmdW5jdGlvbiAoZ2ZwKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBsM19zaWRlO1xuICAgICAgICB2YXIgZmx1c2hiaXRzO1xuICAgICAgICB2YXIgbGFzdF9wdHIgPSBnZmMuaF9wdHIgLSAxO1xuICAgICAgICAvKiBsYXN0IGhlYWRlciB0byBhZGQgdG8gYml0c3RyZWFtICovXG4gICAgICAgIGlmIChsYXN0X3B0ciA9PSAtMSlcbiAgICAgICAgICAgIGxhc3RfcHRyID0gTGFtZUludGVybmFsRmxhZ3MuTUFYX0hFQURFUl9CVUYgLSAxO1xuICAgICAgICBsM19zaWRlID0gZ2ZjLmwzX3NpZGU7XG5cbiAgICAgICAgaWYgKChmbHVzaGJpdHMgPSBjb21wdXRlX2ZsdXNoYml0cyhnZnAsIG5ldyBUb3RhbEJ5dGVzKCkpKSA8IDApXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIGRyYWluX2ludG9fYW5jaWxsYXJ5KGdmcCwgZmx1c2hiaXRzKTtcblxuICAgICAgICAvKiBjaGVjayB0aGF0IHRoZSAxMDAlIG9mIHRoZSBsYXN0IGZyYW1lIGhhcyBiZWVuIHdyaXR0ZW4gdG8gYml0c3RyZWFtICovXG5cbiAgICAgICAgLypcbiAgICAgICAgICogd2UgaGF2ZSBwYWRkZWQgb3V0IGFsbCBmcmFtZXMgd2l0aCBhbmNpbGxhcnkgZGF0YSwgd2hpY2ggaXMgdGhlIHNhbWVcbiAgICAgICAgICogYXMgZmlsbGluZyB0aGUgYml0cmVzZXJ2b2lyIHdpdGggYW5jaWxsYXJ5IGRhdGEsIHNvIDpcbiAgICAgICAgICovXG4gICAgICAgIGdmYy5SZXN2U2l6ZSA9IDA7XG4gICAgICAgIGwzX3NpZGUubWFpbl9kYXRhX2JlZ2luID0gMDtcblxuICAgICAgICAvKiBzYXZlIHRoZSBSZXBsYXlHYWluIHZhbHVlICovXG4gICAgICAgIGlmIChnZmMuZmluZFJlcGxheUdhaW4pIHtcbiAgICAgICAgICAgIHZhciBSYWRpb0dhaW4gPSBnYS5HZXRUaXRsZUdhaW4oZ2ZjLnJnZGF0YSk7XG4gICAgICAgICAgICBnZmMuUmFkaW9HYWluID0gTWF0aC5mbG9vcihSYWRpb0dhaW4gKiAxMC4wICsgMC41KSB8IDA7XG4gICAgICAgICAgICAvKiByb3VuZCB0byBuZWFyZXN0ICovXG4gICAgICAgIH1cblxuICAgICAgICAvKiBmaW5kIHRoZSBnYWluIGFuZCBzY2FsZSBjaGFuZ2UgcmVxdWlyZWQgZm9yIG5vIGNsaXBwaW5nICovXG4gICAgICAgIGlmIChnZmMuZmluZFBlYWtTYW1wbGUpIHtcbiAgICAgICAgICAgIGdmYy5ub2NsaXBHYWluQ2hhbmdlID0gTWF0aC5jZWlsKFxuICAgICAgICAgICAgICAgICAgICAgICAgTWF0aF9sb2cxMChnZmMuUGVha1NhbXBsZSAvIDMyNzY3LjApICogMjAuMCAqIDEwLjApIHwgMDtcbiAgICAgICAgICAgIC8qIHJvdW5kIHVwICovXG5cbiAgICAgICAgICAgIGlmIChnZmMubm9jbGlwR2FpbkNoYW5nZSA+IDApIHtcbiAgICAgICAgICAgICAgICAvKiBjbGlwcGluZyBvY2N1cnMgKi9cbiAgICAgICAgICAgICAgICBpZiAoRVEoZ2ZwLnNjYWxlLCAxLjApIHx8IEVRKGdmcC5zY2FsZSwgMC4wKSlcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLm5vY2xpcFNjYWxlID0gKE1hdGhcbiAgICAgICAgICAgICAgICAgICAgICAgIC5mbG9vcigoMzI3NjcuMCAvIGdmYy5QZWFrU2FtcGxlKSAqIDEwMC4wKSAvIDEwMC4wKTtcbiAgICAgICAgICAgICAgICAvKiByb3VuZCBkb3duICovXG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAqIHRoZSB1c2VyIHNwZWNpZmllZCBoaXMgb3duIHNjYWxpbmcgZmFjdG9yLiBXZSBjb3VsZFxuICAgICAgICAgICAgICAgICAgICAgKiBzdWdnZXN0IHRoZSBzY2FsaW5nIGZhY3RvciBvZlxuICAgICAgICAgICAgICAgICAgICAgKiAoMzI3NjcuMC9nZnAuUGVha1NhbXBsZSkqKGdmcC5zY2FsZSkgYnV0IGl0J3MgdXN1YWxseVxuICAgICAgICAgICAgICAgICAgICAgKiB2ZXJ5IGluYWNjdXJhdGUuIFNvIHdlJ2QgcmF0aGVyIG5vdCBhZHZpY2UgaGltIG9uIHRoZVxuICAgICAgICAgICAgICAgICAgICAgKiBzY2FsaW5nIGZhY3Rvci5cbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGdmYy5ub2NsaXBTY2FsZSA9IC0xO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgLyogbm8gY2xpcHBpbmcgKi9cbiAgICAgICAgICAgICAgICBnZmMubm9jbGlwU2NhbGUgPSAtMTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLmFkZF9kdW1teV9ieXRlID0gZnVuY3Rpb24gKGdmcCwgdmFsLCBuKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBpO1xuXG4gICAgICAgIHdoaWxlIChuLS0gPiAwKSB7XG4gICAgICAgICAgICBwdXRiaXRzX25vaGVhZGVycyhnZmMsIHZhbCwgOCk7XG5cbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBMYW1lSW50ZXJuYWxGbGFncy5NQVhfSEVBREVSX0JVRjsgKytpKVxuICAgICAgICAgICAgICAgIGdmYy5oZWFkZXJbaV0ud3JpdGVfdGltaW5nICs9IDg7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBpcyBjYWxsZWQgYWZ0ZXIgYSBmcmFtZSBvZiBhdWRpbyBoYXMgYmVlbiBxdWFudGl6ZWQgYW5kIGNvZGVkLiBJdFxuICAgICAqIHdpbGwgd3JpdGUgdGhlIGVuY29kZWQgYXVkaW8gdG8gdGhlIGJpdHN0cmVhbS4gTm90ZSB0aGF0IGZyb20gYSBsYXllcjNcbiAgICAgKiBlbmNvZGVyJ3MgcGVyc3BlY3RpdmUgdGhlIGJpdCBzdHJlYW0gaXMgcHJpbWFyaWx5IGEgc2VyaWVzIG9mIG1haW5fZGF0YSgpXG4gICAgICogYmxvY2tzLCB3aXRoIGhlYWRlciBhbmQgc2lkZSBpbmZvcm1hdGlvbiBpbnNlcnRlZCBhdCB0aGUgcHJvcGVyIGxvY2F0aW9uc1xuICAgICAqIHRvIG1haW50YWluIGZyYW1pbmcuIChTZWUgRmlndXJlIEEuNyBpbiB0aGUgSVMpLlxuICAgICAqL1xuICAgIHRoaXMuZm9ybWF0X2JpdHN0cmVhbSA9IGZ1bmN0aW9uIChnZnApIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGwzX3NpZGU7XG4gICAgICAgIGwzX3NpZGUgPSBnZmMubDNfc2lkZTtcblxuICAgICAgICB2YXIgYml0c1BlckZyYW1lID0gdGhpcy5nZXRmcmFtZWJpdHMoZ2ZwKTtcbiAgICAgICAgZHJhaW5faW50b19hbmNpbGxhcnkoZ2ZwLCBsM19zaWRlLnJlc3ZEcmFpbl9wcmUpO1xuXG4gICAgICAgIGVuY29kZVNpZGVJbmZvMihnZnAsIGJpdHNQZXJGcmFtZSk7XG4gICAgICAgIHZhciBiaXRzID0gOCAqIGdmYy5zaWRlaW5mb19sZW47XG4gICAgICAgIGJpdHMgKz0gd3JpdGVNYWluRGF0YShnZnApO1xuICAgICAgICBkcmFpbl9pbnRvX2FuY2lsbGFyeShnZnAsIGwzX3NpZGUucmVzdkRyYWluX3Bvc3QpO1xuICAgICAgICBiaXRzICs9IGwzX3NpZGUucmVzdkRyYWluX3Bvc3Q7XG5cbiAgICAgICAgbDNfc2lkZS5tYWluX2RhdGFfYmVnaW4gKz0gKGJpdHNQZXJGcmFtZSAtIGJpdHMpIC8gODtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBjb21wYXJlIG51bWJlciBvZiBiaXRzIG5lZWRlZCB0byBjbGVhciBhbGwgYnVmZmVyZWQgbXAzIGZyYW1lcyB3aXRoXG4gICAgICAgICAqIHdoYXQgd2UgdGhpbmsgdGhlIHJlc3ZzaXplIGlzOlxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGNvbXB1dGVfZmx1c2hiaXRzKGdmcCwgbmV3IFRvdGFsQnl0ZXMoKSkgIT0gZ2ZjLlJlc3ZTaXplKSB7XG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJJbnRlcm5hbCBidWZmZXIgaW5jb25zaXN0ZW5jeS4gZmx1c2hiaXRzIDw+IFJlc3ZTaXplXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgICogY29tcGFyZSBtYWluX2RhdGFfYmVnaW4gZm9yIHRoZSBuZXh0IGZyYW1lIHdpdGggd2hhdCB3ZSB0aGluayB0aGVcbiAgICAgICAgICogcmVzdnNpemUgaXM6XG4gICAgICAgICAqL1xuICAgICAgICBpZiAoKGwzX3NpZGUubWFpbl9kYXRhX2JlZ2luICogOCkgIT0gZ2ZjLlJlc3ZTaXplKSB7XG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50ZihcImJpdCByZXNlcnZvaXIgZXJyb3I6IFxcblwiXG4gICAgICAgICAgICAgICAgKyBcImwzX3NpZGUubWFpbl9kYXRhX2JlZ2luOiAlZCBcXG5cIlxuICAgICAgICAgICAgICAgICsgXCJSZXN2b2lyIHNpemU6ICAgICAgICAgICAgICVkIFxcblwiXG4gICAgICAgICAgICAgICAgKyBcInJlc3YgZHJhaW4gKHBvc3QpICAgICAgICAgJWQgXFxuXCJcbiAgICAgICAgICAgICAgICArIFwicmVzdiBkcmFpbiAocHJlKSAgICAgICAgICAlZCBcXG5cIlxuICAgICAgICAgICAgICAgICsgXCJoZWFkZXIgYW5kIHNpZGVpbmZvOiAgICAgICVkIFxcblwiXG4gICAgICAgICAgICAgICAgKyBcImRhdGEgYml0czogICAgICAgICAgICAgICAgJWQgXFxuXCJcbiAgICAgICAgICAgICAgICArIFwidG90YWwgYml0czogICAgICAgICAgICAgICAlZCAocmVtYWluZGVyOiAlZCkgXFxuXCJcbiAgICAgICAgICAgICAgICArIFwiYml0c3BlcmZyYW1lOiAgICAgICAgICAgICAlZCBcXG5cIixcbiAgICAgICAgICAgICAgICA4ICogbDNfc2lkZS5tYWluX2RhdGFfYmVnaW4sIGdmYy5SZXN2U2l6ZSxcbiAgICAgICAgICAgICAgICBsM19zaWRlLnJlc3ZEcmFpbl9wb3N0LCBsM19zaWRlLnJlc3ZEcmFpbl9wcmUsXG4gICAgICAgICAgICAgICAgOCAqIGdmYy5zaWRlaW5mb19sZW4sIGJpdHMgLSBsM19zaWRlLnJlc3ZEcmFpbl9wb3N0IC0gOFxuICAgICAgICAgICAgICAgICogZ2ZjLnNpZGVpbmZvX2xlbiwgYml0cywgYml0cyAlIDgsIGJpdHNQZXJGcmFtZSk7XG5cbiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIlRoaXMgaXMgYSBmYXRhbCBlcnJvci4gIEl0IGhhcyBzZXZlcmFsIHBvc3NpYmxlIGNhdXNlczpcIik7XG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCI5MCUlICBMQU1FIGNvbXBpbGVkIHdpdGggYnVnZ3kgdmVyc2lvbiBvZiBnY2MgdXNpbmcgYWR2YW5jZWQgb3B0aW1pemF0aW9uc1wiKTtcbiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIiA5JSUgIFlvdXIgc3lzdGVtIGlzIG92ZXJjbG9ja2VkXCIpO1xuICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiIDElJSAgYnVnIGluIExBTUUgZW5jb2RpbmcgbGlicmFyeVwiKTtcblxuICAgICAgICAgICAgZ2ZjLlJlc3ZTaXplID0gbDNfc2lkZS5tYWluX2RhdGFfYmVnaW4gKiA4O1xuICAgICAgICB9XG4gICAgICAgIC8vO1xuXG4gICAgICAgIGlmICh0b3RiaXQgPiAxMDAwMDAwMDAwKSB7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogdG8gYXZvaWQgdG90Yml0IG92ZXJmbG93LCAoYXQgOGggZW5jb2RpbmcgYXQgMTI4a2JzKSBsZXRzIHJlc2V0XG4gICAgICAgICAgICAgKiBiaXQgY291bnRlclxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YXIgaTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBMYW1lSW50ZXJuYWxGbGFncy5NQVhfSEVBREVSX0JVRjsgKytpKVxuICAgICAgICAgICAgICAgIGdmYy5oZWFkZXJbaV0ud3JpdGVfdGltaW5nIC09IHRvdGJpdDtcbiAgICAgICAgICAgIHRvdGJpdCA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogPFBSRT5cbiAgICAgKiBjb3B5IGRhdGEgb3V0IG9mIHRoZSBpbnRlcm5hbCBNUDMgYml0IGJ1ZmZlciBpbnRvIGEgdXNlciBzdXBwbGllZFxuICAgICAqICAgICAgIHVuc2lnbmVkIGNoYXIgYnVmZmVyLlxuICAgICAqXG4gICAgICogICAgICAgbXAzZGF0YT0wICAgICAgaW5kaWNhdGVzIGRhdGEgaW4gYnVmZmVyIGlzIGFuIGlkM3RhZ3MgYW5kIFZCUiB0YWdzXG4gICAgICogICAgICAgbXAzZGF0YT0xICAgICAgZGF0YSBpcyByZWFsIG1wMyBmcmFtZSBkYXRhLlxuICAgICAqIDwvUFJFPlxuICAgICAqL1xuICAgIHRoaXMuY29weV9idWZmZXIgPSBmdW5jdGlvbiAoZ2ZjLCBidWZmZXIsIGJ1ZmZlclBvcywgc2l6ZSwgbXAzZGF0YSkge1xuICAgICAgICB2YXIgbWluaW11bSA9IGJ1ZkJ5dGVJZHggKyAxO1xuICAgICAgICBpZiAobWluaW11bSA8PSAwKVxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIGlmIChzaXplICE9IDAgJiYgbWluaW11bSA+IHNpemUpIHtcbiAgICAgICAgICAgIC8qIGJ1ZmZlciBpcyB0b28gc21hbGwgKi9cbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KGJ1ZiwgMCwgYnVmZmVyLCBidWZmZXJQb3MsIG1pbmltdW0pO1xuICAgICAgICBidWZCeXRlSWR4ID0gLTE7XG4gICAgICAgIGJ1ZkJpdElkeCA9IDA7XG5cbiAgICAgICAgaWYgKG1wM2RhdGEgIT0gMCkge1xuICAgICAgICAgICAgdmFyIGNyYyA9IG5ld19pbnQoMSk7XG4gICAgICAgICAgICBjcmNbMF0gPSBnZmMubk11c2ljQ1JDO1xuICAgICAgICAgICAgdmJyLnVwZGF0ZU11c2ljQ1JDKGNyYywgYnVmZmVyLCBidWZmZXJQb3MsIG1pbmltdW0pO1xuICAgICAgICAgICAgZ2ZjLm5NdXNpY0NSQyA9IGNyY1swXTtcblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBzdW0gbnVtYmVyIG9mIGJ5dGVzIGJlbG9uZ2luZyB0byB0aGUgbXAzIHN0cmVhbSB0aGlzIGluZm8gd2lsbCBiZVxuICAgICAgICAgICAgICogd3JpdHRlbiBpbnRvIHRoZSBYaW5nL0xBTUUgaGVhZGVyIGZvciBzZWVraW5nXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGlmIChtaW5pbXVtID4gMCkge1xuICAgICAgICAgICAgICAgIGdmYy5WQlJfc2Vla190YWJsZS5uQnl0ZXNXcml0dGVuICs9IG1pbmltdW07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChnZmMuZGVjb2RlX29uX3RoZV9mbHkpIHsgLyogZGVjb2RlIHRoZSBmcmFtZSAqL1xuICAgICAgICAgICAgICAgIHZhciBwY21fYnVmID0gbmV3X2Zsb2F0X24oWzIsIDExNTJdKTtcbiAgICAgICAgICAgICAgICB2YXIgbXAzX2luID0gbWluaW11bTtcbiAgICAgICAgICAgICAgICB2YXIgc2FtcGxlc19vdXQgPSAtMTtcbiAgICAgICAgICAgICAgICB2YXIgaTtcblxuICAgICAgICAgICAgICAgIC8qIHJlLXN5bnRoZXNpcyB0byBwY20uIFJlcGVhdCB1bnRpbCB3ZSBnZXQgYSBzYW1wbGVzX291dD0wICovXG4gICAgICAgICAgICAgICAgd2hpbGUgKHNhbXBsZXNfb3V0ICE9IDApIHtcblxuICAgICAgICAgICAgICAgICAgICBzYW1wbGVzX291dCA9IG1wZy5oaXBfZGVjb2RlMV91bmNsaXBwZWQoZ2ZjLmhpcCwgYnVmZmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgYnVmZmVyUG9zLCBtcDNfaW4sIHBjbV9idWZbMF0sIHBjbV9idWZbMV0pO1xuICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgKiBzYW1wbGVzX291dCA9IDA6IG5lZWQgbW9yZSBkYXRhIHRvIGRlY29kZSBzYW1wbGVzX291dCA9XG4gICAgICAgICAgICAgICAgICAgICAqIC0xOiBlcnJvci4gTGV0cyBhc3N1bWUgMCBwY20gb3V0cHV0IHNhbXBsZXNfb3V0ID0gbnVtYmVyXG4gICAgICAgICAgICAgICAgICAgICAqIG9mIHNhbXBsZXMgb3V0cHV0XG4gICAgICAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAqIHNldCB0aGUgbGVuZ2h0IG9mIHRoZSBtcDMgaW5wdXQgYnVmZmVyIHRvIHplcm8sIHNvIHRoYXRcbiAgICAgICAgICAgICAgICAgICAgICogaW4gdGhlIG5leHQgaXRlcmF0aW9uIG9mIHRoZSBsb29wIHdlIHdpbGwgYmUgcXVlcnlpbmdcbiAgICAgICAgICAgICAgICAgICAgICogbXBnbGliIGFib3V0IGJ1ZmZlcmVkIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIG1wM19pbiA9IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNhbXBsZXNfb3V0ID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICogZXJyb3IgZGVjb2RpbmcuIE5vdCBmYXRhbCwgYnV0IG1pZ2h0IHNjcmV3IHVwIHRoZVxuICAgICAgICAgICAgICAgICAgICAgICAgICogUmVwbGF5R2FpbiB0YWcuIFdoYXQgc2hvdWxkIHdlIGRvPyBJZ25vcmUgZm9yIG5vd1xuICAgICAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVzX291dCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNhbXBsZXNfb3V0ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogcHJvY2VzcyB0aGUgUENNIGRhdGEgKi9cblxuICAgICAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICAgICAqIHRoaXMgc2hvdWxkIG5vdCBiZSBwb3NzaWJsZSwgYW5kIGluZGljYXRlcyB3ZSBoYXZlXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiBvdmVyZmxvd24gdGhlIHBjbV9idWYgYnVmZmVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdmYy5maW5kUGVha1NhbXBsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzYW1wbGVzX291dDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwY21fYnVmWzBdW2ldID4gZ2ZjLlBlYWtTYW1wbGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZmMuUGVha1NhbXBsZSA9IHBjbV9idWZbMF1baV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKC1wY21fYnVmWzBdW2ldID4gZ2ZjLlBlYWtTYW1wbGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZmMuUGVha1NhbXBsZSA9IC1wY21fYnVmWzBdW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2ZjLmNoYW5uZWxzX291dCA+IDEpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBzYW1wbGVzX291dDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGNtX2J1ZlsxXVtpXSA+IGdmYy5QZWFrU2FtcGxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdmYy5QZWFrU2FtcGxlID0gcGNtX2J1ZlsxXVtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKC1wY21fYnVmWzFdW2ldID4gZ2ZjLlBlYWtTYW1wbGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ZjLlBlYWtTYW1wbGUgPSAtcGNtX2J1ZlsxXVtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2ZjLmZpbmRSZXBsYXlHYWluKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnYS5BbmFseXplU2FtcGxlcyhnZmMucmdkYXRhLCBwY21fYnVmWzBdLCAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGNtX2J1ZlsxXSwgMCwgc2FtcGxlc19vdXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZmMuY2hhbm5lbHNfb3V0KSA9PSBHYWluQW5hbHlzaXMuR0FJTl9BTkFMWVNJU19FUlJPUilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC02O1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLyogaWYgKHNhbXBsZXNfb3V0PjApICovXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qIHdoaWxlIChzYW1wbGVzX291dCE9MCkgKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIGlmIChnZmMuZGVjb2RlX29uX3RoZV9mbHkpICovXG5cbiAgICAgICAgfVxuICAgICAgICAvKiBpZiAobXAzZGF0YSkgKi9cbiAgICAgICAgcmV0dXJuIG1pbmltdW07XG4gICAgfTtcblxuICAgIHRoaXMuaW5pdF9iaXRfc3RyZWFtX3cgPSBmdW5jdGlvbiAoZ2ZjKSB7XG4gICAgICAgIGJ1ZiA9IG5ld19ieXRlKExhbWUuTEFNRV9NQVhNUDNCVUZGRVIpO1xuXG4gICAgICAgIGdmYy5oX3B0ciA9IGdmYy53X3B0ciA9IDA7XG4gICAgICAgIGdmYy5oZWFkZXJbZ2ZjLmhfcHRyXS53cml0ZV90aW1pbmcgPSAwO1xuICAgICAgICBidWZCeXRlSWR4ID0gLTE7XG4gICAgICAgIGJ1ZkJpdElkeCA9IDA7XG4gICAgICAgIHRvdGJpdCA9IDA7XG4gICAgfTtcblxuICAgIC8vIEZyb20gbWFjaGluZS5oXG5cblxufVxuXG5mdW5jdGlvbiBIdWZmQ29kZVRhYihsZW4sIG1heCwgdGFiLCBobCkge1xuICAgIHRoaXMueGxlbiA9IGxlbjtcbiAgICB0aGlzLmxpbm1heCA9IG1heDtcbiAgICB0aGlzLnRhYmxlID0gdGFiO1xuICAgIHRoaXMuaGxlbiA9IGhsO1xufVxuXG52YXIgVGFibGVzID0ge307XG5cblxuVGFibGVzLnQxSEIgPSBbXG4gICAgMSwgMSxcbiAgICAxLCAwXG5dO1xuXG5UYWJsZXMudDJIQiA9IFtcbiAgICAxLCAyLCAxLFxuICAgIDMsIDEsIDEsXG4gICAgMywgMiwgMFxuXTtcblxuVGFibGVzLnQzSEIgPSBbXG4gICAgMywgMiwgMSxcbiAgICAxLCAxLCAxLFxuICAgIDMsIDIsIDBcbl07XG5cblRhYmxlcy50NUhCID0gW1xuICAgIDEsIDIsIDYsIDUsXG4gICAgMywgMSwgNCwgNCxcbiAgICA3LCA1LCA3LCAxLFxuICAgIDYsIDEsIDEsIDBcbl07XG5cblRhYmxlcy50NkhCID0gW1xuICAgIDcsIDMsIDUsIDEsXG4gICAgNiwgMiwgMywgMixcbiAgICA1LCA0LCA0LCAxLFxuICAgIDMsIDMsIDIsIDBcbl07XG5cblRhYmxlcy50N0hCID0gW1xuICAgIDEsIDIsIDEwLCAxOSwgMTYsIDEwLFxuICAgIDMsIDMsIDcsIDEwLCA1LCAzLFxuICAgIDExLCA0LCAxMywgMTcsIDgsIDQsXG4gICAgMTIsIDExLCAxOCwgMTUsIDExLCAyLFxuICAgIDcsIDYsIDksIDE0LCAzLCAxLFxuICAgIDYsIDQsIDUsIDMsIDIsIDBcbl07XG5cblRhYmxlcy50OEhCID0gW1xuICAgIDMsIDQsIDYsIDE4LCAxMiwgNSxcbiAgICA1LCAxLCAyLCAxNiwgOSwgMyxcbiAgICA3LCAzLCA1LCAxNCwgNywgMyxcbiAgICAxOSwgMTcsIDE1LCAxMywgMTAsIDQsXG4gICAgMTMsIDUsIDgsIDExLCA1LCAxLFxuICAgIDEyLCA0LCA0LCAxLCAxLCAwXG5dO1xuXG5UYWJsZXMudDlIQiA9IFtcbiAgICA3LCA1LCA5LCAxNCwgMTUsIDcsXG4gICAgNiwgNCwgNSwgNSwgNiwgNyxcbiAgICA3LCA2LCA4LCA4LCA4LCA1LFxuICAgIDE1LCA2LCA5LCAxMCwgNSwgMSxcbiAgICAxMSwgNywgOSwgNiwgNCwgMSxcbiAgICAxNCwgNCwgNiwgMiwgNiwgMFxuXTtcblxuVGFibGVzLnQxMEhCID0gW1xuICAgIDEsIDIsIDEwLCAyMywgMzUsIDMwLCAxMiwgMTcsXG4gICAgMywgMywgOCwgMTIsIDE4LCAyMSwgMTIsIDcsXG4gICAgMTEsIDksIDE1LCAyMSwgMzIsIDQwLCAxOSwgNixcbiAgICAxNCwgMTMsIDIyLCAzNCwgNDYsIDIzLCAxOCwgNyxcbiAgICAyMCwgMTksIDMzLCA0NywgMjcsIDIyLCA5LCAzLFxuICAgIDMxLCAyMiwgNDEsIDI2LCAyMSwgMjAsIDUsIDMsXG4gICAgMTQsIDEzLCAxMCwgMTEsIDE2LCA2LCA1LCAxLFxuICAgIDksIDgsIDcsIDgsIDQsIDQsIDIsIDBcbl07XG5cblRhYmxlcy50MTFIQiA9IFtcbiAgICAzLCA0LCAxMCwgMjQsIDM0LCAzMywgMjEsIDE1LFxuICAgIDUsIDMsIDQsIDEwLCAzMiwgMTcsIDExLCAxMCxcbiAgICAxMSwgNywgMTMsIDE4LCAzMCwgMzEsIDIwLCA1LFxuICAgIDI1LCAxMSwgMTksIDU5LCAyNywgMTgsIDEyLCA1LFxuICAgIDM1LCAzMywgMzEsIDU4LCAzMCwgMTYsIDcsIDUsXG4gICAgMjgsIDI2LCAzMiwgMTksIDE3LCAxNSwgOCwgMTQsXG4gICAgMTQsIDEyLCA5LCAxMywgMTQsIDksIDQsIDEsXG4gICAgMTEsIDQsIDYsIDYsIDYsIDMsIDIsIDBcbl07XG5cblRhYmxlcy50MTJIQiA9IFtcbiAgICA5LCA2LCAxNiwgMzMsIDQxLCAzOSwgMzgsIDI2LFxuICAgIDcsIDUsIDYsIDksIDIzLCAxNiwgMjYsIDExLFxuICAgIDE3LCA3LCAxMSwgMTQsIDIxLCAzMCwgMTAsIDcsXG4gICAgMTcsIDEwLCAxNSwgMTIsIDE4LCAyOCwgMTQsIDUsXG4gICAgMzIsIDEzLCAyMiwgMTksIDE4LCAxNiwgOSwgNSxcbiAgICA0MCwgMTcsIDMxLCAyOSwgMTcsIDEzLCA0LCAyLFxuICAgIDI3LCAxMiwgMTEsIDE1LCAxMCwgNywgNCwgMSxcbiAgICAyNywgMTIsIDgsIDEyLCA2LCAzLCAxLCAwXG5dO1xuXG5UYWJsZXMudDEzSEIgPSBbXG4gICAgMSwgNSwgMTQsIDIxLCAzNCwgNTEsIDQ2LCA3MSwgNDIsIDUyLCA2OCwgNTIsIDY3LCA0NCwgNDMsIDE5LFxuICAgIDMsIDQsIDEyLCAxOSwgMzEsIDI2LCA0NCwgMzMsIDMxLCAyNCwgMzIsIDI0LCAzMSwgMzUsIDIyLCAxNCxcbiAgICAxNSwgMTMsIDIzLCAzNiwgNTksIDQ5LCA3NywgNjUsIDI5LCA0MCwgMzAsIDQwLCAyNywgMzMsIDQyLCAxNixcbiAgICAyMiwgMjAsIDM3LCA2MSwgNTYsIDc5LCA3MywgNjQsIDQzLCA3NiwgNTYsIDM3LCAyNiwgMzEsIDI1LCAxNCxcbiAgICAzNSwgMTYsIDYwLCA1NywgOTcsIDc1LCAxMTQsIDkxLCA1NCwgNzMsIDU1LCA0MSwgNDgsIDUzLCAyMywgMjQsXG4gICAgNTgsIDI3LCA1MCwgOTYsIDc2LCA3MCwgOTMsIDg0LCA3NywgNTgsIDc5LCAyOSwgNzQsIDQ5LCA0MSwgMTcsXG4gICAgNDcsIDQ1LCA3OCwgNzQsIDExNSwgOTQsIDkwLCA3OSwgNjksIDgzLCA3MSwgNTAsIDU5LCAzOCwgMzYsIDE1LFxuICAgIDcyLCAzNCwgNTYsIDk1LCA5MiwgODUsIDkxLCA5MCwgODYsIDczLCA3NywgNjUsIDUxLCA0NCwgNDMsIDQyLFxuICAgIDQzLCAyMCwgMzAsIDQ0LCA1NSwgNzgsIDcyLCA4NywgNzgsIDYxLCA0NiwgNTQsIDM3LCAzMCwgMjAsIDE2LFxuICAgIDUzLCAyNSwgNDEsIDM3LCA0NCwgNTksIDU0LCA4MSwgNjYsIDc2LCA1NywgNTQsIDM3LCAxOCwgMzksIDExLFxuICAgIDM1LCAzMywgMzEsIDU3LCA0MiwgODIsIDcyLCA4MCwgNDcsIDU4LCA1NSwgMjEsIDIyLCAyNiwgMzgsIDIyLFxuICAgIDUzLCAyNSwgMjMsIDM4LCA3MCwgNjAsIDUxLCAzNiwgNTUsIDI2LCAzNCwgMjMsIDI3LCAxNCwgOSwgNyxcbiAgICAzNCwgMzIsIDI4LCAzOSwgNDksIDc1LCAzMCwgNTIsIDQ4LCA0MCwgNTIsIDI4LCAxOCwgMTcsIDksIDUsXG4gICAgNDUsIDIxLCAzNCwgNjQsIDU2LCA1MCwgNDksIDQ1LCAzMSwgMTksIDEyLCAxNSwgMTAsIDcsIDYsIDMsXG4gICAgNDgsIDIzLCAyMCwgMzksIDM2LCAzNSwgNTMsIDIxLCAxNiwgMjMsIDEzLCAxMCwgNiwgMSwgNCwgMixcbiAgICAxNiwgMTUsIDE3LCAyNywgMjUsIDIwLCAyOSwgMTEsIDE3LCAxMiwgMTYsIDgsIDEsIDEsIDAsIDFcbl07XG5cblRhYmxlcy50MTVIQiA9IFtcbiAgICA3LCAxMiwgMTgsIDUzLCA0NywgNzYsIDEyNCwgMTA4LCA4OSwgMTIzLCAxMDgsIDExOSwgMTA3LCA4MSwgMTIyLCA2MyxcbiAgICAxMywgNSwgMTYsIDI3LCA0NiwgMzYsIDYxLCA1MSwgNDIsIDcwLCA1MiwgODMsIDY1LCA0MSwgNTksIDM2LFxuICAgIDE5LCAxNywgMTUsIDI0LCA0MSwgMzQsIDU5LCA0OCwgNDAsIDY0LCA1MCwgNzgsIDYyLCA4MCwgNTYsIDMzLFxuICAgIDI5LCAyOCwgMjUsIDQzLCAzOSwgNjMsIDU1LCA5MywgNzYsIDU5LCA5MywgNzIsIDU0LCA3NSwgNTAsIDI5LFxuICAgIDUyLCAyMiwgNDIsIDQwLCA2NywgNTcsIDk1LCA3OSwgNzIsIDU3LCA4OSwgNjksIDQ5LCA2NiwgNDYsIDI3LFxuICAgIDc3LCAzNywgMzUsIDY2LCA1OCwgNTIsIDkxLCA3NCwgNjIsIDQ4LCA3OSwgNjMsIDkwLCA2MiwgNDAsIDM4LFxuICAgIDEyNSwgMzIsIDYwLCA1NiwgNTAsIDkyLCA3OCwgNjUsIDU1LCA4NywgNzEsIDUxLCA3MywgNTEsIDcwLCAzMCxcbiAgICAxMDksIDUzLCA0OSwgOTQsIDg4LCA3NSwgNjYsIDEyMiwgOTEsIDczLCA1NiwgNDIsIDY0LCA0NCwgMjEsIDI1LFxuICAgIDkwLCA0MywgNDEsIDc3LCA3MywgNjMsIDU2LCA5MiwgNzcsIDY2LCA0NywgNjcsIDQ4LCA1MywgMzYsIDIwLFxuICAgIDcxLCAzNCwgNjcsIDYwLCA1OCwgNDksIDg4LCA3NiwgNjcsIDEwNiwgNzEsIDU0LCAzOCwgMzksIDIzLCAxNSxcbiAgICAxMDksIDUzLCA1MSwgNDcsIDkwLCA4MiwgNTgsIDU3LCA0OCwgNzIsIDU3LCA0MSwgMjMsIDI3LCA2MiwgOSxcbiAgICA4NiwgNDIsIDQwLCAzNywgNzAsIDY0LCA1MiwgNDMsIDcwLCA1NSwgNDIsIDI1LCAyOSwgMTgsIDExLCAxMSxcbiAgICAxMTgsIDY4LCAzMCwgNTUsIDUwLCA0NiwgNzQsIDY1LCA0OSwgMzksIDI0LCAxNiwgMjIsIDEzLCAxNCwgNyxcbiAgICA5MSwgNDQsIDM5LCAzOCwgMzQsIDYzLCA1MiwgNDUsIDMxLCA1MiwgMjgsIDE5LCAxNCwgOCwgOSwgMyxcbiAgICAxMjMsIDYwLCA1OCwgNTMsIDQ3LCA0MywgMzIsIDIyLCAzNywgMjQsIDE3LCAxMiwgMTUsIDEwLCAyLCAxLFxuICAgIDcxLCAzNywgMzQsIDMwLCAyOCwgMjAsIDE3LCAyNiwgMjEsIDE2LCAxMCwgNiwgOCwgNiwgMiwgMFxuXTtcblxuVGFibGVzLnQxNkhCID0gW1xuICAgIDEsIDUsIDE0LCA0NCwgNzQsIDYzLCAxMTAsIDkzLCAxNzIsIDE0OSwgMTM4LCAyNDIsIDIyNSwgMTk1LCAzNzYsIDE3LFxuICAgIDMsIDQsIDEyLCAyMCwgMzUsIDYyLCA1MywgNDcsIDgzLCA3NSwgNjgsIDExOSwgMjAxLCAxMDcsIDIwNywgOSxcbiAgICAxNSwgMTMsIDIzLCAzOCwgNjcsIDU4LCAxMDMsIDkwLCAxNjEsIDcyLCAxMjcsIDExNywgMTEwLCAyMDksIDIwNiwgMTYsXG4gICAgNDUsIDIxLCAzOSwgNjksIDY0LCAxMTQsIDk5LCA4NywgMTU4LCAxNDAsIDI1MiwgMjEyLCAxOTksIDM4NywgMzY1LCAyNixcbiAgICA3NSwgMzYsIDY4LCA2NSwgMTE1LCAxMDEsIDE3OSwgMTY0LCAxNTUsIDI2NCwgMjQ2LCAyMjYsIDM5NSwgMzgyLCAzNjIsIDksXG4gICAgNjYsIDMwLCA1OSwgNTYsIDEwMiwgMTg1LCAxNzMsIDI2NSwgMTQyLCAyNTMsIDIzMiwgNDAwLCAzODgsIDM3OCwgNDQ1LCAxNixcbiAgICAxMTEsIDU0LCA1MiwgMTAwLCAxODQsIDE3OCwgMTYwLCAxMzMsIDI1NywgMjQ0LCAyMjgsIDIxNywgMzg1LCAzNjYsIDcxNSwgMTAsXG4gICAgOTgsIDQ4LCA5MSwgODgsIDE2NSwgMTU3LCAxNDgsIDI2MSwgMjQ4LCA0MDcsIDM5NywgMzcyLCAzODAsIDg4OSwgODg0LCA4LFxuICAgIDg1LCA4NCwgODEsIDE1OSwgMTU2LCAxNDMsIDI2MCwgMjQ5LCA0MjcsIDQwMSwgMzkyLCAzODMsIDcyNywgNzEzLCA3MDgsIDcsXG4gICAgMTU0LCA3NiwgNzMsIDE0MSwgMTMxLCAyNTYsIDI0NSwgNDI2LCA0MDYsIDM5NCwgMzg0LCA3MzUsIDM1OSwgNzEwLCAzNTIsIDExLFxuICAgIDEzOSwgMTI5LCA2NywgMTI1LCAyNDcsIDIzMywgMjI5LCAyMTksIDM5MywgNzQzLCA3MzcsIDcyMCwgODg1LCA4ODIsIDQzOSwgNCxcbiAgICAyNDMsIDEyMCwgMTE4LCAxMTUsIDIyNywgMjIzLCAzOTYsIDc0NiwgNzQyLCA3MzYsIDcyMSwgNzEyLCA3MDYsIDIyMywgNDM2LCA2LFxuICAgIDIwMiwgMjI0LCAyMjIsIDIxOCwgMjE2LCAzODksIDM4NiwgMzgxLCAzNjQsIDg4OCwgNDQzLCA3MDcsIDQ0MCwgNDM3LCAxNzI4LCA0LFxuICAgIDc0NywgMjExLCAyMTAsIDIwOCwgMzcwLCAzNzksIDczNCwgNzIzLCA3MTQsIDE3MzUsIDg4MywgODc3LCA4NzYsIDM0NTksIDg2NSwgMixcbiAgICAzNzcsIDM2OSwgMTAyLCAxODcsIDcyNiwgNzIyLCAzNTgsIDcxMSwgNzA5LCA4NjYsIDE3MzQsIDg3MSwgMzQ1OCwgODcwLCA0MzQsIDAsXG4gICAgMTIsIDEwLCA3LCAxMSwgMTAsIDE3LCAxMSwgOSwgMTMsIDEyLCAxMCwgNywgNSwgMywgMSwgM1xuXTtcblxuVGFibGVzLnQyNEhCID0gW1xuICAgIDE1LCAxMywgNDYsIDgwLCAxNDYsIDI2MiwgMjQ4LCA0MzQsIDQyNiwgNjY5LCA2NTMsIDY0OSwgNjIxLCA1MTcsIDEwMzIsIDg4LFxuICAgIDE0LCAxMiwgMjEsIDM4LCA3MSwgMTMwLCAxMjIsIDIxNiwgMjA5LCAxOTgsIDMyNywgMzQ1LCAzMTksIDI5NywgMjc5LCA0MixcbiAgICA0NywgMjIsIDQxLCA3NCwgNjgsIDEyOCwgMTIwLCAyMjEsIDIwNywgMTk0LCAxODIsIDM0MCwgMzE1LCAyOTUsIDU0MSwgMTgsXG4gICAgODEsIDM5LCA3NSwgNzAsIDEzNCwgMTI1LCAxMTYsIDIyMCwgMjA0LCAxOTAsIDE3OCwgMzI1LCAzMTEsIDI5MywgMjcxLCAxNixcbiAgICAxNDcsIDcyLCA2OSwgMTM1LCAxMjcsIDExOCwgMTEyLCAyMTAsIDIwMCwgMTg4LCAzNTIsIDMyMywgMzA2LCAyODUsIDU0MCwgMTQsXG4gICAgMjYzLCA2NiwgMTI5LCAxMjYsIDExOSwgMTE0LCAyMTQsIDIwMiwgMTkyLCAxODAsIDM0MSwgMzE3LCAzMDEsIDI4MSwgMjYyLCAxMixcbiAgICAyNDksIDEyMywgMTIxLCAxMTcsIDExMywgMjE1LCAyMDYsIDE5NSwgMTg1LCAzNDcsIDMzMCwgMzA4LCAyOTEsIDI3MiwgNTIwLCAxMCxcbiAgICA0MzUsIDExNSwgMTExLCAxMDksIDIxMSwgMjAzLCAxOTYsIDE4NywgMzUzLCAzMzIsIDMxMywgMjk4LCAyODMsIDUzMSwgMzgxLCAxNyxcbiAgICA0MjcsIDIxMiwgMjA4LCAyMDUsIDIwMSwgMTkzLCAxODYsIDE3NywgMTY5LCAzMjAsIDMwMywgMjg2LCAyNjgsIDUxNCwgMzc3LCAxNixcbiAgICAzMzUsIDE5OSwgMTk3LCAxOTEsIDE4OSwgMTgxLCAxNzQsIDMzMywgMzIxLCAzMDUsIDI4OSwgMjc1LCA1MjEsIDM3OSwgMzcxLCAxMSxcbiAgICA2NjgsIDE4NCwgMTgzLCAxNzksIDE3NSwgMzQ0LCAzMzEsIDMxNCwgMzA0LCAyOTAsIDI3NywgNTMwLCAzODMsIDM3MywgMzY2LCAxMCxcbiAgICA2NTIsIDM0NiwgMTcxLCAxNjgsIDE2NCwgMzE4LCAzMDksIDI5OSwgMjg3LCAyNzYsIDI2MywgNTEzLCAzNzUsIDM2OCwgMzYyLCA2LFxuICAgIDY0OCwgMzIyLCAzMTYsIDMxMiwgMzA3LCAzMDIsIDI5MiwgMjg0LCAyNjksIDI2MSwgNTEyLCAzNzYsIDM3MCwgMzY0LCAzNTksIDQsXG4gICAgNjIwLCAzMDAsIDI5NiwgMjk0LCAyODgsIDI4MiwgMjczLCAyNjYsIDUxNSwgMzgwLCAzNzQsIDM2OSwgMzY1LCAzNjEsIDM1NywgMixcbiAgICAxMDMzLCAyODAsIDI3OCwgMjc0LCAyNjcsIDI2NCwgMjU5LCAzODIsIDM3OCwgMzcyLCAzNjcsIDM2MywgMzYwLCAzNTgsIDM1NiwgMCxcbiAgICA0MywgMjAsIDE5LCAxNywgMTUsIDEzLCAxMSwgOSwgNywgNiwgNCwgNywgNSwgMywgMSwgM1xuXTtcblxuVGFibGVzLnQzMkhCID0gW1xuICAgIDEgPDwgMCwgNSA8PCAxLCA0IDw8IDEsIDUgPDwgMiwgNiA8PCAxLCA1IDw8IDIsIDQgPDwgMiwgNCA8PCAzLFxuICAgIDcgPDwgMSwgMyA8PCAyLCA2IDw8IDIsIDAgPDwgMywgNyA8PCAyLCAyIDw8IDMsIDMgPDwgMywgMSA8PCA0XG5dO1xuXG5UYWJsZXMudDMzSEIgPSBbXG4gICAgMTUgPDwgMCwgMTQgPDwgMSwgMTMgPDwgMSwgMTIgPDwgMiwgMTEgPDwgMSwgMTAgPDwgMiwgOSA8PCAyLCA4IDw8IDMsXG4gICAgNyA8PCAxLCA2IDw8IDIsIDUgPDwgMiwgNCA8PCAzLCAzIDw8IDIsIDIgPDwgMywgMSA8PCAzLCAwIDw8IDRcbl07XG5cblRhYmxlcy50MWwgPSBbXG4gICAgMSwgNCxcbiAgICAzLCA1XG5dO1xuXG5UYWJsZXMudDJsID0gW1xuICAgIDEsIDQsIDcsXG4gICAgNCwgNSwgNyxcbiAgICA2LCA3LCA4XG5dO1xuXG5UYWJsZXMudDNsID0gW1xuICAgIDIsIDMsIDcsXG4gICAgNCwgNCwgNyxcbiAgICA2LCA3LCA4XG5dO1xuXG5UYWJsZXMudDVsID0gW1xuICAgIDEsIDQsIDcsIDgsXG4gICAgNCwgNSwgOCwgOSxcbiAgICA3LCA4LCA5LCAxMCxcbiAgICA4LCA4LCA5LCAxMFxuXTtcblxuVGFibGVzLnQ2bCA9IFtcbiAgICAzLCA0LCA2LCA4LFxuICAgIDQsIDQsIDYsIDcsXG4gICAgNSwgNiwgNywgOCxcbiAgICA3LCA3LCA4LCA5XG5dO1xuXG5UYWJsZXMudDdsID0gW1xuICAgIDEsIDQsIDcsIDksIDksIDEwLFxuICAgIDQsIDYsIDgsIDksIDksIDEwLFxuICAgIDcsIDcsIDksIDEwLCAxMCwgMTEsXG4gICAgOCwgOSwgMTAsIDExLCAxMSwgMTEsXG4gICAgOCwgOSwgMTAsIDExLCAxMSwgMTIsXG4gICAgOSwgMTAsIDExLCAxMiwgMTIsIDEyXG5dO1xuXG5UYWJsZXMudDhsID0gW1xuICAgIDIsIDQsIDcsIDksIDksIDEwLFxuICAgIDQsIDQsIDYsIDEwLCAxMCwgMTAsXG4gICAgNywgNiwgOCwgMTAsIDEwLCAxMSxcbiAgICA5LCAxMCwgMTAsIDExLCAxMSwgMTIsXG4gICAgOSwgOSwgMTAsIDExLCAxMiwgMTIsXG4gICAgMTAsIDEwLCAxMSwgMTEsIDEzLCAxM1xuXTtcblxuVGFibGVzLnQ5bCA9IFtcbiAgICAzLCA0LCA2LCA3LCA5LCAxMCxcbiAgICA0LCA1LCA2LCA3LCA4LCAxMCxcbiAgICA1LCA2LCA3LCA4LCA5LCAxMCxcbiAgICA3LCA3LCA4LCA5LCA5LCAxMCxcbiAgICA4LCA4LCA5LCA5LCAxMCwgMTEsXG4gICAgOSwgOSwgMTAsIDEwLCAxMSwgMTFcbl07XG5cblRhYmxlcy50MTBsID0gW1xuICAgIDEsIDQsIDcsIDksIDEwLCAxMCwgMTAsIDExLFxuICAgIDQsIDYsIDgsIDksIDEwLCAxMSwgMTAsIDEwLFxuICAgIDcsIDgsIDksIDEwLCAxMSwgMTIsIDExLCAxMSxcbiAgICA4LCA5LCAxMCwgMTEsIDEyLCAxMiwgMTEsIDEyLFxuICAgIDksIDEwLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDEyLFxuICAgIDEwLCAxMSwgMTIsIDEyLCAxMywgMTMsIDEyLCAxMyxcbiAgICA5LCAxMCwgMTEsIDEyLCAxMiwgMTIsIDEzLCAxMyxcbiAgICAxMCwgMTAsIDExLCAxMiwgMTIsIDEzLCAxMywgMTNcbl07XG5cblRhYmxlcy50MTFsID0gW1xuICAgIDIsIDQsIDYsIDgsIDksIDEwLCA5LCAxMCxcbiAgICA0LCA1LCA2LCA4LCAxMCwgMTAsIDksIDEwLFxuICAgIDYsIDcsIDgsIDksIDEwLCAxMSwgMTAsIDEwLFxuICAgIDgsIDgsIDksIDExLCAxMCwgMTIsIDEwLCAxMSxcbiAgICA5LCAxMCwgMTAsIDExLCAxMSwgMTIsIDExLCAxMixcbiAgICA5LCAxMCwgMTEsIDEyLCAxMiwgMTMsIDEyLCAxMyxcbiAgICA5LCA5LCA5LCAxMCwgMTEsIDEyLCAxMiwgMTIsXG4gICAgOSwgOSwgMTAsIDExLCAxMiwgMTIsIDEyLCAxMlxuXTtcblxuVGFibGVzLnQxMmwgPSBbXG4gICAgNCwgNCwgNiwgOCwgOSwgMTAsIDEwLCAxMCxcbiAgICA0LCA1LCA2LCA3LCA5LCA5LCAxMCwgMTAsXG4gICAgNiwgNiwgNywgOCwgOSwgMTAsIDksIDEwLFxuICAgIDcsIDcsIDgsIDgsIDksIDEwLCAxMCwgMTAsXG4gICAgOCwgOCwgOSwgOSwgMTAsIDEwLCAxMCwgMTEsXG4gICAgOSwgOSwgMTAsIDEwLCAxMCwgMTEsIDEwLCAxMSxcbiAgICA5LCA5LCA5LCAxMCwgMTAsIDExLCAxMSwgMTIsXG4gICAgMTAsIDEwLCAxMCwgMTEsIDExLCAxMSwgMTEsIDEyXG5dO1xuXG5UYWJsZXMudDEzbCA9IFtcbiAgICAxLCA1LCA3LCA4LCA5LCAxMCwgMTAsIDExLCAxMCwgMTEsIDEyLCAxMiwgMTMsIDEzLCAxNCwgMTQsXG4gICAgNCwgNiwgOCwgOSwgMTAsIDEwLCAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMywgMTQsIDE0LCAxNCxcbiAgICA3LCA4LCA5LCAxMCwgMTEsIDExLCAxMiwgMTIsIDExLCAxMiwgMTIsIDEzLCAxMywgMTQsIDE1LCAxNSxcbiAgICA4LCA5LCAxMCwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTMsIDE0LCAxNSwgMTUsXG4gICAgOSwgOSwgMTEsIDExLCAxMiwgMTIsIDEzLCAxMywgMTIsIDEzLCAxMywgMTQsIDE0LCAxNSwgMTUsIDE2LFxuICAgIDEwLCAxMCwgMTEsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDEzLCAxNCwgMTMsIDE1LCAxNSwgMTYsIDE2LFxuICAgIDEwLCAxMSwgMTIsIDEyLCAxMywgMTMsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTYsIDE2LFxuICAgIDExLCAxMSwgMTIsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTQsIDE0LCAxNSwgMTUsIDE1LCAxNiwgMTgsIDE4LFxuICAgIDEwLCAxMCwgMTEsIDEyLCAxMiwgMTMsIDEzLCAxNCwgMTQsIDE0LCAxNCwgMTUsIDE1LCAxNiwgMTcsIDE3LFxuICAgIDExLCAxMSwgMTIsIDEyLCAxMywgMTMsIDEzLCAxNSwgMTQsIDE1LCAxNSwgMTYsIDE2LCAxNiwgMTgsIDE3LFxuICAgIDExLCAxMiwgMTIsIDEzLCAxMywgMTQsIDE0LCAxNSwgMTQsIDE1LCAxNiwgMTUsIDE2LCAxNywgMTgsIDE5LFxuICAgIDEyLCAxMiwgMTIsIDEzLCAxNCwgMTQsIDE0LCAxNCwgMTUsIDE1LCAxNSwgMTYsIDE3LCAxNywgMTcsIDE4LFxuICAgIDEyLCAxMywgMTMsIDE0LCAxNCwgMTUsIDE0LCAxNSwgMTYsIDE2LCAxNywgMTcsIDE3LCAxOCwgMTgsIDE4LFxuICAgIDEzLCAxMywgMTQsIDE1LCAxNSwgMTUsIDE2LCAxNiwgMTYsIDE2LCAxNiwgMTcsIDE4LCAxNywgMTgsIDE4LFxuICAgIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTUsIDE3LCAxNiwgMTYsIDE5LCAxNywgMTcsIDE3LCAxOSwgMTgsIDE4LFxuICAgIDEzLCAxNCwgMTUsIDE2LCAxNiwgMTYsIDE3LCAxNiwgMTcsIDE3LCAxOCwgMTgsIDIxLCAyMCwgMjEsIDE4XG5dO1xuXG5UYWJsZXMudDE1bCA9IFtcbiAgICAzLCA1LCA2LCA4LCA4LCA5LCAxMCwgMTAsIDEwLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEzLCAxNCxcbiAgICA1LCA1LCA3LCA4LCA5LCA5LCAxMCwgMTAsIDEwLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEzLCAxMyxcbiAgICA2LCA3LCA3LCA4LCA5LCA5LCAxMCwgMTAsIDEwLCAxMSwgMTEsIDEyLCAxMiwgMTMsIDEzLCAxMyxcbiAgICA3LCA4LCA4LCA5LCA5LCAxMCwgMTAsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsXG4gICAgOCwgOCwgOSwgOSwgMTAsIDEwLCAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMyxcbiAgICA5LCA5LCA5LCAxMCwgMTAsIDEwLCAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMywgMTMsIDEzLCAxNCxcbiAgICAxMCwgOSwgMTAsIDEwLCAxMCwgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTQsIDE0LFxuICAgIDEwLCAxMCwgMTAsIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDE0LFxuICAgIDEwLCAxMCwgMTAsIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxNCwgMTQsIDE0LFxuICAgIDEwLCAxMCwgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE0LFxuICAgIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDEzLCAxNCwgMTUsIDE0LFxuICAgIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTQsIDE1LFxuICAgIDEyLCAxMiwgMTEsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTUsIDE1LFxuICAgIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTQsIDE0LCAxNCwgMTUsIDE1LFxuICAgIDEzLCAxMywgMTMsIDEzLCAxMywgMTMsIDEzLCAxMywgMTQsIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTQsIDE1LFxuICAgIDEzLCAxMywgMTMsIDEzLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTUsIDE1XG5dO1xuXG5UYWJsZXMudDE2XzVsID0gW1xuICAgIDEsIDUsIDcsIDksIDEwLCAxMCwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxNCwgMTEsXG4gICAgNCwgNiwgOCwgOSwgMTAsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEzLCAxNCwgMTMsIDE0LCAxMSxcbiAgICA3LCA4LCA5LCAxMCwgMTEsIDExLCAxMiwgMTIsIDEzLCAxMiwgMTMsIDEzLCAxMywgMTQsIDE0LCAxMixcbiAgICA5LCA5LCAxMCwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMywgMTMsIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTMsXG4gICAgMTAsIDEwLCAxMSwgMTEsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTQsIDE0LCAxNCwgMTUsIDE1LCAxNSwgMTIsXG4gICAgMTAsIDEwLCAxMSwgMTEsIDEyLCAxMywgMTMsIDE0LCAxMywgMTQsIDE0LCAxNSwgMTUsIDE1LCAxNiwgMTMsXG4gICAgMTEsIDExLCAxMSwgMTIsIDEzLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE0LCAxNCwgMTUsIDE1LCAxNiwgMTMsXG4gICAgMTEsIDExLCAxMiwgMTIsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTUsIDE1LCAxNSwgMTUsIDE3LCAxNywgMTMsXG4gICAgMTEsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTQsIDE0LCAxNSwgMTUsIDE1LCAxNSwgMTYsIDE2LCAxNiwgMTMsXG4gICAgMTIsIDEyLCAxMiwgMTMsIDEzLCAxNCwgMTQsIDE1LCAxNSwgMTUsIDE1LCAxNiwgMTUsIDE2LCAxNSwgMTQsXG4gICAgMTIsIDEzLCAxMiwgMTMsIDE0LCAxNCwgMTQsIDE0LCAxNSwgMTYsIDE2LCAxNiwgMTcsIDE3LCAxNiwgMTMsXG4gICAgMTMsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTUsIDE2LCAxNiwgMTYsIDE2LCAxNiwgMTYsIDE1LCAxNiwgMTQsXG4gICAgMTMsIDE0LCAxNCwgMTQsIDE0LCAxNSwgMTUsIDE1LCAxNSwgMTcsIDE2LCAxNiwgMTYsIDE2LCAxOCwgMTQsXG4gICAgMTUsIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTYsIDE2LCAxNiwgMTgsIDE3LCAxNywgMTcsIDE5LCAxNywgMTQsXG4gICAgMTQsIDE1LCAxMywgMTQsIDE2LCAxNiwgMTUsIDE2LCAxNiwgMTcsIDE4LCAxNywgMTksIDE3LCAxNiwgMTQsXG4gICAgMTEsIDExLCAxMSwgMTIsIDEyLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE0LCAxNCwgMTQsIDE0LCAxNCwgMTJcbl07XG5cblRhYmxlcy50MTZsID0gW1xuICAgIDEsIDUsIDcsIDksIDEwLCAxMCwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxNCwgMTAsXG4gICAgNCwgNiwgOCwgOSwgMTAsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEzLCAxNCwgMTMsIDE0LCAxMCxcbiAgICA3LCA4LCA5LCAxMCwgMTEsIDExLCAxMiwgMTIsIDEzLCAxMiwgMTMsIDEzLCAxMywgMTQsIDE0LCAxMSxcbiAgICA5LCA5LCAxMCwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMywgMTMsIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTIsXG4gICAgMTAsIDEwLCAxMSwgMTEsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTQsIDE0LCAxNCwgMTUsIDE1LCAxNSwgMTEsXG4gICAgMTAsIDEwLCAxMSwgMTEsIDEyLCAxMywgMTMsIDE0LCAxMywgMTQsIDE0LCAxNSwgMTUsIDE1LCAxNiwgMTIsXG4gICAgMTEsIDExLCAxMSwgMTIsIDEzLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE0LCAxNCwgMTUsIDE1LCAxNiwgMTIsXG4gICAgMTEsIDExLCAxMiwgMTIsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTUsIDE1LCAxNSwgMTUsIDE3LCAxNywgMTIsXG4gICAgMTEsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTQsIDE0LCAxNSwgMTUsIDE1LCAxNSwgMTYsIDE2LCAxNiwgMTIsXG4gICAgMTIsIDEyLCAxMiwgMTMsIDEzLCAxNCwgMTQsIDE1LCAxNSwgMTUsIDE1LCAxNiwgMTUsIDE2LCAxNSwgMTMsXG4gICAgMTIsIDEzLCAxMiwgMTMsIDE0LCAxNCwgMTQsIDE0LCAxNSwgMTYsIDE2LCAxNiwgMTcsIDE3LCAxNiwgMTIsXG4gICAgMTMsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTUsIDE2LCAxNiwgMTYsIDE2LCAxNiwgMTYsIDE1LCAxNiwgMTMsXG4gICAgMTMsIDE0LCAxNCwgMTQsIDE0LCAxNSwgMTUsIDE1LCAxNSwgMTcsIDE2LCAxNiwgMTYsIDE2LCAxOCwgMTMsXG4gICAgMTUsIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTYsIDE2LCAxNiwgMTgsIDE3LCAxNywgMTcsIDE5LCAxNywgMTMsXG4gICAgMTQsIDE1LCAxMywgMTQsIDE2LCAxNiwgMTUsIDE2LCAxNiwgMTcsIDE4LCAxNywgMTksIDE3LCAxNiwgMTMsXG4gICAgMTAsIDEwLCAxMCwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxMywgMTMsIDEzLCAxMywgMTBcbl07XG5cblRhYmxlcy50MjRsID0gW1xuICAgIDQsIDUsIDcsIDgsIDksIDEwLCAxMCwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEzLCAxMCxcbiAgICA1LCA2LCA3LCA4LCA5LCAxMCwgMTAsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTAsXG4gICAgNywgNywgOCwgOSwgOSwgMTAsIDEwLCAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDksXG4gICAgOCwgOCwgOSwgOSwgMTAsIDEwLCAxMCwgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEyLCA5LFxuICAgIDksIDksIDksIDEwLCAxMCwgMTAsIDEwLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDksXG4gICAgMTAsIDksIDEwLCAxMCwgMTAsIDEwLCAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDEyLCA5LFxuICAgIDEwLCAxMCwgMTAsIDEwLCAxMCwgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDksXG4gICAgMTEsIDEwLCAxMCwgMTAsIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTAsXG4gICAgMTEsIDExLCAxMSwgMTEsIDExLCAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTAsXG4gICAgMTEsIDExLCAxMSwgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTAsXG4gICAgMTIsIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxMywgMTAsXG4gICAgMTIsIDEyLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxMywgMTAsXG4gICAgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDEzLCAxMywgMTAsXG4gICAgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxMywgMTMsIDEzLCAxMywgMTAsXG4gICAgMTMsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDEzLCAxMywgMTMsIDEzLCAxMywgMTAsXG4gICAgOSwgOSwgOSwgOSwgOSwgOSwgOSwgOSwgOSwgOSwgOSwgMTAsIDEwLCAxMCwgMTAsIDZcbl07XG5cblRhYmxlcy50MzJsID0gW1xuICAgIDEgKyAwLCA0ICsgMSwgNCArIDEsIDUgKyAyLCA0ICsgMSwgNiArIDIsIDUgKyAyLCA2ICsgMyxcbiAgICA0ICsgMSwgNSArIDIsIDUgKyAyLCA2ICsgMywgNSArIDIsIDYgKyAzLCA2ICsgMywgNiArIDRcbl07XG5cblRhYmxlcy50MzNsID0gW1xuICAgIDQgKyAwLCA0ICsgMSwgNCArIDEsIDQgKyAyLCA0ICsgMSwgNCArIDIsIDQgKyAyLCA0ICsgMyxcbiAgICA0ICsgMSwgNCArIDIsIDQgKyAyLCA0ICsgMywgNCArIDIsIDQgKyAzLCA0ICsgMywgNCArIDRcbl07XG5cblRhYmxlcy5odCA9IFtcbiAgICAvKiB4bGVuLCBsaW5tYXgsIHRhYmxlLCBobGVuICovXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDAsIDAsIG51bGwsIG51bGwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYigyLCAwLCBUYWJsZXMudDFIQiwgVGFibGVzLnQxbCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDMsIDAsIFRhYmxlcy50MkhCLCBUYWJsZXMudDJsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoMywgMCwgVGFibGVzLnQzSEIsIFRhYmxlcy50M2wpLFxuICAgIG5ldyBIdWZmQ29kZVRhYigwLCAwLCBudWxsLCBudWxsKSwgLyogQXBwYXJlbnRseSBub3QgdXNlZCAqL1xuICAgIG5ldyBIdWZmQ29kZVRhYig0LCAwLCBUYWJsZXMudDVIQiwgVGFibGVzLnQ1bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDQsIDAsIFRhYmxlcy50NkhCLCBUYWJsZXMudDZsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoNiwgMCwgVGFibGVzLnQ3SEIsIFRhYmxlcy50N2wpLFxuICAgIG5ldyBIdWZmQ29kZVRhYig2LCAwLCBUYWJsZXMudDhIQiwgVGFibGVzLnQ4bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDYsIDAsIFRhYmxlcy50OUhCLCBUYWJsZXMudDlsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoOCwgMCwgVGFibGVzLnQxMEhCLCBUYWJsZXMudDEwbCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDgsIDAsIFRhYmxlcy50MTFIQiwgVGFibGVzLnQxMWwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYig4LCAwLCBUYWJsZXMudDEySEIsIFRhYmxlcy50MTJsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoMTYsIDAsIFRhYmxlcy50MTNIQiwgVGFibGVzLnQxM2wpLFxuICAgIG5ldyBIdWZmQ29kZVRhYigwLCAwLCBudWxsLCBUYWJsZXMudDE2XzVsKSwgLyogQXBwYXJlbnRseSBub3QgdXNlZCAqL1xuICAgIG5ldyBIdWZmQ29kZVRhYigxNiwgMCwgVGFibGVzLnQxNUhCLCBUYWJsZXMudDE1bCksXG5cbiAgICBuZXcgSHVmZkNvZGVUYWIoMSwgMSwgVGFibGVzLnQxNkhCLCBUYWJsZXMudDE2bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDIsIDMsIFRhYmxlcy50MTZIQiwgVGFibGVzLnQxNmwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYigzLCA3LCBUYWJsZXMudDE2SEIsIFRhYmxlcy50MTZsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoNCwgMTUsIFRhYmxlcy50MTZIQiwgVGFibGVzLnQxNmwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYig2LCA2MywgVGFibGVzLnQxNkhCLCBUYWJsZXMudDE2bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDgsIDI1NSwgVGFibGVzLnQxNkhCLCBUYWJsZXMudDE2bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDEwLCAxMDIzLCBUYWJsZXMudDE2SEIsIFRhYmxlcy50MTZsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoMTMsIDgxOTEsIFRhYmxlcy50MTZIQiwgVGFibGVzLnQxNmwpLFxuXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDQsIDE1LCBUYWJsZXMudDI0SEIsIFRhYmxlcy50MjRsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoNSwgMzEsIFRhYmxlcy50MjRIQiwgVGFibGVzLnQyNGwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYig2LCA2MywgVGFibGVzLnQyNEhCLCBUYWJsZXMudDI0bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDcsIDEyNywgVGFibGVzLnQyNEhCLCBUYWJsZXMudDI0bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDgsIDI1NSwgVGFibGVzLnQyNEhCLCBUYWJsZXMudDI0bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDksIDUxMSwgVGFibGVzLnQyNEhCLCBUYWJsZXMudDI0bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDExLCAyMDQ3LCBUYWJsZXMudDI0SEIsIFRhYmxlcy50MjRsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoMTMsIDgxOTEsIFRhYmxlcy50MjRIQiwgVGFibGVzLnQyNGwpLFxuXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDAsIDAsIFRhYmxlcy50MzJIQiwgVGFibGVzLnQzMmwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYigwLCAwLCBUYWJsZXMudDMzSEIsIFRhYmxlcy50MzNsKSxcbl07XG5cbi8qKlxuICogPENPREU+XG4gKiAgZm9yIChpID0gMDsgaSA8IDE2KjE2OyBpKyspIFtcbiAqICAgICAgbGFyZ2V0YmxbaV0gPSAoKGh0WzE2XS5obGVuW2ldKSA8PCAxNikgKyBodFsyNF0uaGxlbltpXTtcbiAqICBdXG4gKiA8L0NPREU+XG4gKlxuICovXG5UYWJsZXMubGFyZ2V0YmwgPSBbXG4gICAgMHgwMTAwMDQsIDB4MDUwMDA1LCAweDA3MDAwNywgMHgwOTAwMDgsIDB4MGEwMDA5LCAweDBhMDAwYSwgMHgwYjAwMGEsIDB4MGIwMDBiLFxuICAgIDB4MGMwMDBiLCAweDBjMDAwYywgMHgwYzAwMGMsIDB4MGQwMDBjLCAweDBkMDAwYywgMHgwZDAwMGMsIDB4MGUwMDBkLCAweDBhMDAwYSxcbiAgICAweDA0MDAwNSwgMHgwNjAwMDYsIDB4MDgwMDA3LCAweDA5MDAwOCwgMHgwYTAwMDksIDB4MGIwMDBhLCAweDBiMDAwYSwgMHgwYjAwMGIsXG4gICAgMHgwYzAwMGIsIDB4MGMwMDBiLCAweDBjMDAwYywgMHgwZDAwMGMsIDB4MGUwMDBjLCAweDBkMDAwYywgMHgwZTAwMGMsIDB4MGEwMDBhLFxuICAgIDB4MDcwMDA3LCAweDA4MDAwNywgMHgwOTAwMDgsIDB4MGEwMDA5LCAweDBiMDAwOSwgMHgwYjAwMGEsIDB4MGMwMDBhLCAweDBjMDAwYixcbiAgICAweDBkMDAwYiwgMHgwYzAwMGIsIDB4MGQwMDBiLCAweDBkMDAwYywgMHgwZDAwMGMsIDB4MGUwMDBjLCAweDBlMDAwZCwgMHgwYjAwMDksXG4gICAgMHgwOTAwMDgsIDB4MDkwMDA4LCAweDBhMDAwOSwgMHgwYjAwMDksIDB4MGIwMDBhLCAweDBjMDAwYSwgMHgwYzAwMGEsIDB4MGMwMDBiLFxuICAgIDB4MGQwMDBiLCAweDBkMDAwYiwgMHgwZTAwMGIsIDB4MGUwMDBjLCAweDBlMDAwYywgMHgwZjAwMGMsIDB4MGYwMDBjLCAweDBjMDAwOSxcbiAgICAweDBhMDAwOSwgMHgwYTAwMDksIDB4MGIwMDA5LCAweDBiMDAwYSwgMHgwYzAwMGEsIDB4MGMwMDBhLCAweDBkMDAwYSwgMHgwZDAwMGIsXG4gICAgMHgwZDAwMGIsIDB4MGUwMDBiLCAweDBlMDAwYywgMHgwZTAwMGMsIDB4MGYwMDBjLCAweDBmMDAwYywgMHgwZjAwMGQsIDB4MGIwMDA5LFxuICAgIDB4MGEwMDBhLCAweDBhMDAwOSwgMHgwYjAwMGEsIDB4MGIwMDBhLCAweDBjMDAwYSwgMHgwZDAwMGEsIDB4MGQwMDBiLCAweDBlMDAwYixcbiAgICAweDBkMDAwYiwgMHgwZTAwMGIsIDB4MGUwMDBjLCAweDBmMDAwYywgMHgwZjAwMGMsIDB4MGYwMDBjLCAweDEwMDAwYywgMHgwYzAwMDksXG4gICAgMHgwYjAwMGEsIDB4MGIwMDBhLCAweDBiMDAwYSwgMHgwYzAwMGEsIDB4MGQwMDBhLCAweDBkMDAwYiwgMHgwZDAwMGIsIDB4MGQwMDBiLFxuICAgIDB4MGUwMDBiLCAweDBlMDAwYywgMHgwZTAwMGMsIDB4MGUwMDBjLCAweDBmMDAwYywgMHgwZjAwMGMsIDB4MTAwMDBkLCAweDBjMDAwOSxcbiAgICAweDBiMDAwYiwgMHgwYjAwMGEsIDB4MGMwMDBhLCAweDBjMDAwYSwgMHgwZDAwMGIsIDB4MGQwMDBiLCAweDBkMDAwYiwgMHgwZTAwMGIsXG4gICAgMHgwZTAwMGMsIDB4MGYwMDBjLCAweDBmMDAwYywgMHgwZjAwMGMsIDB4MGYwMDBjLCAweDExMDAwZCwgMHgxMTAwMGQsIDB4MGMwMDBhLFxuICAgIDB4MGIwMDBiLCAweDBjMDAwYiwgMHgwYzAwMGIsIDB4MGQwMDBiLCAweDBkMDAwYiwgMHgwZDAwMGIsIDB4MGUwMDBiLCAweDBlMDAwYixcbiAgICAweDBmMDAwYiwgMHgwZjAwMGMsIDB4MGYwMDBjLCAweDBmMDAwYywgMHgxMDAwMGMsIDB4MTAwMDBkLCAweDEwMDAwZCwgMHgwYzAwMGEsXG4gICAgMHgwYzAwMGIsIDB4MGMwMDBiLCAweDBjMDAwYiwgMHgwZDAwMGIsIDB4MGQwMDBiLCAweDBlMDAwYiwgMHgwZTAwMGIsIDB4MGYwMDBjLFxuICAgIDB4MGYwMDBjLCAweDBmMDAwYywgMHgwZjAwMGMsIDB4MTAwMDBjLCAweDBmMDAwZCwgMHgxMDAwMGQsIDB4MGYwMDBkLCAweDBkMDAwYSxcbiAgICAweDBjMDAwYywgMHgwZDAwMGIsIDB4MGMwMDBiLCAweDBkMDAwYiwgMHgwZTAwMGIsIDB4MGUwMDBjLCAweDBlMDAwYywgMHgwZTAwMGMsXG4gICAgMHgwZjAwMGMsIDB4MTAwMDBjLCAweDEwMDAwYywgMHgxMDAwMGQsIDB4MTEwMDBkLCAweDExMDAwZCwgMHgxMDAwMGQsIDB4MGMwMDBhLFxuICAgIDB4MGQwMDBjLCAweDBkMDAwYywgMHgwZDAwMGIsIDB4MGQwMDBiLCAweDBlMDAwYiwgMHgwZTAwMGMsIDB4MGYwMDBjLCAweDEwMDAwYyxcbiAgICAweDEwMDAwYywgMHgxMDAwMGMsIDB4MTAwMDBjLCAweDEwMDAwZCwgMHgxMDAwMGQsIDB4MGYwMDBkLCAweDEwMDAwZCwgMHgwZDAwMGEsXG4gICAgMHgwZDAwMGMsIDB4MGUwMDBjLCAweDBlMDAwYywgMHgwZTAwMGMsIDB4MGUwMDBjLCAweDBmMDAwYywgMHgwZjAwMGMsIDB4MGYwMDBjLFxuICAgIDB4MGYwMDBjLCAweDExMDAwYywgMHgxMDAwMGQsIDB4MTAwMDBkLCAweDEwMDAwZCwgMHgxMDAwMGQsIDB4MTIwMDBkLCAweDBkMDAwYSxcbiAgICAweDBmMDAwYywgMHgwZTAwMGMsIDB4MGUwMDBjLCAweDBlMDAwYywgMHgwZjAwMGMsIDB4MGYwMDBjLCAweDEwMDAwYywgMHgxMDAwMGMsXG4gICAgMHgxMDAwMGQsIDB4MTIwMDBkLCAweDExMDAwZCwgMHgxMTAwMGQsIDB4MTEwMDBkLCAweDEzMDAwZCwgMHgxMTAwMGQsIDB4MGQwMDBhLFxuICAgIDB4MGUwMDBkLCAweDBmMDAwYywgMHgwZDAwMGMsIDB4MGUwMDBjLCAweDEwMDAwYywgMHgxMDAwMGMsIDB4MGYwMDBjLCAweDEwMDAwZCxcbiAgICAweDEwMDAwZCwgMHgxMTAwMGQsIDB4MTIwMDBkLCAweDExMDAwZCwgMHgxMzAwMGQsIDB4MTEwMDBkLCAweDEwMDAwZCwgMHgwZDAwMGEsXG4gICAgMHgwYTAwMDksIDB4MGEwMDA5LCAweDBhMDAwOSwgMHgwYjAwMDksIDB4MGIwMDA5LCAweDBjMDAwOSwgMHgwYzAwMDksIDB4MGMwMDA5LFxuICAgIDB4MGQwMDA5LCAweDBkMDAwOSwgMHgwZDAwMDksIDB4MGQwMDBhLCAweDBkMDAwYSwgMHgwZDAwMGEsIDB4MGQwMDBhLCAweDBhMDAwNlxuXTtcbi8qKlxuICogPENPREU+XG4gKiAgZm9yIChpID0gMDsgaSA8IDMqMzsgaSsrKSBbXG4gKiAgICAgIHRhYmxlMjNbaV0gPSAoKGh0WzJdLmhsZW5baV0pIDw8IDE2KSArIGh0WzNdLmhsZW5baV07XG4gKiAgXVxuICogPC9DT0RFPlxuICpcbiAqL1xuVGFibGVzLnRhYmxlMjMgPSBbXG4gICAgMHgwMTAwMDIsIDB4MDQwMDAzLCAweDA3MDAwNyxcbiAgICAweDA0MDAwNCwgMHgwNTAwMDQsIDB4MDcwMDA3LFxuICAgIDB4MDYwMDA2LCAweDA3MDAwNywgMHgwODAwMDhcbl07XG5cbi8qKlxuICogPENPREU+XG4gKiAgZm9yIChpID0gMDsgaSA8IDQqNDsgaSsrKSBbXG4gKiAgICAgICB0YWJsZTU2W2ldID0gKChodFs1XS5obGVuW2ldKSA8PCAxNikgKyBodFs2XS5obGVuW2ldO1xuICogICBdXG4gKiA8L0NPREU+XG4gKlxuICovXG5UYWJsZXMudGFibGU1NiA9IFtcbiAgICAweDAxMDAwMywgMHgwNDAwMDQsIDB4MDcwMDA2LCAweDA4MDAwOCwgMHgwNDAwMDQsIDB4MDUwMDA0LCAweDA4MDAwNiwgMHgwOTAwMDcsXG4gICAgMHgwNzAwMDUsIDB4MDgwMDA2LCAweDA5MDAwNywgMHgwYTAwMDgsIDB4MDgwMDA3LCAweDA4MDAwNywgMHgwOTAwMDgsIDB4MGEwMDA5XG5dO1xuXG5UYWJsZXMuYml0cmF0ZV90YWJsZSA9IFtcbiAgICBbMCwgOCwgMTYsIDI0LCAzMiwgNDAsIDQ4LCA1NiwgNjQsIDgwLCA5NiwgMTEyLCAxMjgsIDE0NCwgMTYwLCAtMV0sIC8qIE1QRUcgMiAqL1xuICAgIFswLCAzMiwgNDAsIDQ4LCA1NiwgNjQsIDgwLCA5NiwgMTEyLCAxMjgsIDE2MCwgMTkyLCAyMjQsIDI1NiwgMzIwLCAtMV0sIC8qIE1QRUcgMSAqL1xuICAgIFswLCA4LCAxNiwgMjQsIDMyLCA0MCwgNDgsIDU2LCA2NCwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTFdLCAvKiBNUEVHIDIuNSAqL1xuXTtcblxuLyoqXG4gKiBNUEVHIDIsIE1QRUcgMSwgTVBFRyAyLjUuXG4gKi9cblRhYmxlcy5zYW1wbGVyYXRlX3RhYmxlID0gW1xuICAgIFsyMjA1MCwgMjQwMDAsIDE2MDAwLCAtMV0sXG4gICAgWzQ0MTAwLCA0ODAwMCwgMzIwMDAsIC0xXSxcbiAgICBbMTEwMjUsIDEyMDAwLCA4MDAwLCAtMV0sXG5dO1xuXG4vKipcbiAqIFRoaXMgaXMgdGhlIHNjZnNpX2JhbmQgdGFibGUgZnJvbSAyLjQuMi43IG9mIHRoZSBJUy5cbiAqL1xuVGFibGVzLnNjZnNpX2JhbmQgPSBbMCwgNiwgMTEsIDE2LCAyMV07XG5cbmZ1bmN0aW9uIE1lYW5CaXRzKG1lYW5CaXRzKSB7XG4gICAgdGhpcy5iaXRzID0gbWVhbkJpdHM7XG59XG5cbi8vcGFja2FnZSBtcDM7XG5cbmZ1bmN0aW9uIENhbGNOb2lzZVJlc3VsdCgpIHtcbiAgICAvKipcbiAgICAgKiBzdW0gb2YgcXVhbnRpemF0aW9uIG5vaXNlID4gbWFza2luZ1xuICAgICAqL1xuICAgIHRoaXMub3Zlcl9ub2lzZSA9IDAuO1xuICAgIC8qKlxuICAgICAqIHN1bSBvZiBhbGwgcXVhbnRpemF0aW9uIG5vaXNlXG4gICAgICovXG4gICAgdGhpcy50b3Rfbm9pc2UgPSAwLjtcbiAgICAvKipcbiAgICAgKiBtYXggcXVhbnRpemF0aW9uIG5vaXNlXG4gICAgICovXG4gICAgdGhpcy5tYXhfbm9pc2UgPSAwLjtcbiAgICAvKipcbiAgICAgKiBudW1iZXIgb2YgcXVhbnRpemF0aW9uIG5vaXNlID4gbWFza2luZ1xuICAgICAqL1xuICAgIHRoaXMub3Zlcl9jb3VudCA9IDA7XG4gICAgLyoqXG4gICAgICogU1NELWxpa2UgY29zdCBvZiBkaXN0b3J0ZWQgYmFuZHNcbiAgICAgKi9cbiAgICB0aGlzLm92ZXJfU1NEID0gMDtcbiAgICB0aGlzLmJpdHMgPSAwO1xufVxuXG5mdW5jdGlvbiBWQlJRdWFudGl6ZSgpIHtcbiAgICB2YXIgcXVwdnQ7XG4gICAgdmFyIHRhaztcblxuICAgIHRoaXMuc2V0TW9kdWxlcyA9IGZ1bmN0aW9uIChfcXVwdnQsIF90aykge1xuICAgICAgICBxdXB2dCA9IF9xdXB2dDtcbiAgICAgICAgdGFrID0gX3RrO1xuICAgIH1cbiAgICAvL1RPRE9cblxufVxuXG5cblxuLyoqXG4gKiBBVEggcmVsYXRlZCBzdHVmZiwgaWYgc29tZXRoaW5nIG5ldyBBVEggcmVsYXRlZCBoYXMgdG8gYmUgYWRkZWQsIHBsZWFzZSBwbHVnXG4gKiBpdCBoZXJlIGludG8gdGhlIEFUSC5cbiAqL1xuZnVuY3Rpb24gQVRIKCkge1xuICAgIC8qKlxuICAgICAqIE1ldGhvZCBmb3IgdGhlIGF1dG8gYWRqdXN0bWVudC5cbiAgICAgKi9cbiAgICB0aGlzLnVzZUFkanVzdCA9IDA7XG4gICAgLyoqXG4gICAgICogZmFjdG9yIGZvciB0dW5pbmcgdGhlIChzYW1wbGUgcG93ZXIpIHBvaW50IGJlbG93IHdoaWNoIGFkYXB0aXZlIHRocmVzaG9sZFxuICAgICAqIG9mIGhlYXJpbmcgYWRqdXN0bWVudCBvY2N1cnNcbiAgICAgKi9cbiAgICB0aGlzLmFhU2Vuc2l0aXZpdHlQID0gMC47XG4gICAgLyoqXG4gICAgICogTG93ZXJpbmcgYmFzZWQgb24gcGVhayB2b2x1bWUsIDEgPSBubyBsb3dlcmluZy5cbiAgICAgKi9cbiAgICB0aGlzLmFkanVzdCA9IDAuO1xuICAgIC8qKlxuICAgICAqIExpbWl0IGZvciBkeW5hbWljIEFUSCBhZGp1c3QuXG4gICAgICovXG4gICAgdGhpcy5hZGp1c3RMaW1pdCA9IDAuO1xuICAgIC8qKlxuICAgICAqIERldGVybWluZWQgdG8gbG93ZXIgeCBkQiBlYWNoIHNlY29uZC5cbiAgICAgKi9cbiAgICB0aGlzLmRlY2F5ID0gMC47XG4gICAgLyoqXG4gICAgICogTG93ZXN0IEFUSCB2YWx1ZS5cbiAgICAgKi9cbiAgICB0aGlzLmZsb29yID0gMC47XG4gICAgLyoqXG4gICAgICogQVRIIGZvciBzZmJzIGluIGxvbmcgYmxvY2tzLlxuICAgICAqL1xuICAgIHRoaXMubCA9IG5ld19mbG9hdChFbmNvZGVyLlNCTUFYX2wpO1xuICAgIC8qKlxuICAgICAqIEFUSCBmb3Igc2ZicyBpbiBzaG9ydCBibG9ja3MuXG4gICAgICovXG4gICAgdGhpcy5zID0gbmV3X2Zsb2F0KEVuY29kZXIuU0JNQVhfcyk7XG4gICAgLyoqXG4gICAgICogQVRIIGZvciBwYXJ0aXRpb25lZCBzZmIyMSBpbiBsb25nIGJsb2Nrcy5cbiAgICAgKi9cbiAgICB0aGlzLnBzZmIyMSA9IG5ld19mbG9hdChFbmNvZGVyLlBTRkIyMSk7XG4gICAgLyoqXG4gICAgICogQVRIIGZvciBwYXJ0aXRpb25lZCBzZmIxMiBpbiBzaG9ydCBibG9ja3MuXG4gICAgICovXG4gICAgdGhpcy5wc2ZiMTIgPSBuZXdfZmxvYXQoRW5jb2Rlci5QU0ZCMTIpO1xuICAgIC8qKlxuICAgICAqIEFUSCBmb3IgbG9uZyBibG9jayBjb252b2x1dGlvbiBiYW5kcy5cbiAgICAgKi9cbiAgICB0aGlzLmNiX2wgPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMpO1xuICAgIC8qKlxuICAgICAqIEFUSCBmb3Igc2hvcnQgYmxvY2sgY29udm9sdXRpb24gYmFuZHMuXG4gICAgICovXG4gICAgdGhpcy5jYl9zID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTKTtcbiAgICAvKipcbiAgICAgKiBFcXVhbCBsb3VkbmVzcyB3ZWlnaHRzIChiYXNlZCBvbiBBVEgpLlxuICAgICAqL1xuICAgIHRoaXMuZXFsX3cgPSBuZXdfZmxvYXQoRW5jb2Rlci5CTEtTSVpFIC8gMik7XG59XG5cblxuZnVuY3Rpb24gTGFtZUdsb2JhbEZsYWdzKCkge1xuXG4gICAgdGhpcy5jbGFzc19pZCA9IDA7XG5cbiAgICAvKiBpbnB1dCBkZXNjcmlwdGlvbiAqL1xuXG4gICAgLyoqXG4gICAgICogbnVtYmVyIG9mIHNhbXBsZXMuIGRlZmF1bHQ9LTFcbiAgICAgKi9cbiAgICB0aGlzLm51bV9zYW1wbGVzID0gMDtcbiAgICAvKipcbiAgICAgKiBpbnB1dCBudW1iZXIgb2YgY2hhbm5lbHMuIGRlZmF1bHQ9MlxuICAgICAqL1xuICAgIHRoaXMubnVtX2NoYW5uZWxzID0gMDtcbiAgICAvKipcbiAgICAgKiBpbnB1dF9zYW1wX3JhdGUgaW4gSHouIGRlZmF1bHQ9NDQuMSBrSHpcbiAgICAgKi9cbiAgICB0aGlzLmluX3NhbXBsZXJhdGUgPSAwO1xuICAgIC8qKlxuICAgICAqIG91dHB1dF9zYW1wX3JhdGUuIGRlZmF1bHQ6IExBTUUgcGlja3MgYmVzdCB2YWx1ZSBhdCBsZWFzdCBub3QgdXNlZCBmb3JcbiAgICAgKiBNUDMgZGVjb2Rpbmc6IFJlbWVtYmVyIDQ0LjEga0h6IE1QM3MgYW5kIEFDOTdcbiAgICAgKi9cbiAgICB0aGlzLm91dF9zYW1wbGVyYXRlID0gMDtcbiAgICAvKipcbiAgICAgKiBzY2FsZSBpbnB1dCBieSB0aGlzIGFtb3VudCBiZWZvcmUgZW5jb2RpbmcgYXQgbGVhc3Qgbm90IHVzZWQgZm9yIE1QM1xuICAgICAqIGRlY29kaW5nXG4gICAgICovXG4gICAgdGhpcy5zY2FsZSA9IDAuO1xuICAgIC8qKlxuICAgICAqIHNjYWxlIGlucHV0IG9mIGNoYW5uZWwgMCAobGVmdCkgYnkgdGhpcyBhbW91bnQgYmVmb3JlIGVuY29kaW5nXG4gICAgICovXG4gICAgdGhpcy5zY2FsZV9sZWZ0ID0gMC47XG4gICAgLyoqXG4gICAgICogc2NhbGUgaW5wdXQgb2YgY2hhbm5lbCAxIChyaWdodCkgYnkgdGhpcyBhbW91bnQgYmVmb3JlIGVuY29kaW5nXG4gICAgICovXG4gICAgdGhpcy5zY2FsZV9yaWdodCA9IDAuO1xuXG4gICAgLyogZ2VuZXJhbCBjb250cm9sIHBhcmFtcyAqL1xuICAgIC8qKlxuICAgICAqIGNvbGxlY3QgZGF0YSBmb3IgYSBNUDMgZnJhbWUgYW5hbHl6ZXI/XG4gICAgICovXG4gICAgdGhpcy5hbmFseXNpcyA9IGZhbHNlO1xuICAgIC8qKlxuICAgICAqIGFkZCBYaW5nIFZCUiB0YWc/XG4gICAgICovXG4gICAgdGhpcy5iV3JpdGVWYnJUYWcgPSBmYWxzZTtcblxuICAgIC8qKlxuICAgICAqIHVzZSBsYW1lL21wZ2xpYiB0byBjb252ZXJ0IG1wMyB0byB3YXZcbiAgICAgKi9cbiAgICB0aGlzLmRlY29kZV9vbmx5ID0gZmFsc2U7XG4gICAgLyoqXG4gICAgICogcXVhbGl0eSBzZXR0aW5nIDA9YmVzdCwgOT13b3JzdCBkZWZhdWx0PTVcbiAgICAgKi9cbiAgICB0aGlzLnF1YWxpdHkgPSAwO1xuICAgIC8qKlxuICAgICAqIHNlZSBlbnVtIGRlZmF1bHQgPSBMQU1FIHBpY2tzIGJlc3QgdmFsdWVcbiAgICAgKi9cbiAgICB0aGlzLm1vZGUgPSBNUEVHTW9kZS5TVEVSRU87XG4gICAgLyoqXG4gICAgICogZm9yY2UgTS9TIG1vZGUuIHJlcXVpcmVzIG1vZGU9MVxuICAgICAqL1xuICAgIHRoaXMuZm9yY2VfbXMgPSBmYWxzZTtcbiAgICAvKipcbiAgICAgKiB1c2UgZnJlZSBmb3JtYXQ/IGRlZmF1bHQ9MFxuICAgICAqL1xuICAgIHRoaXMuZnJlZV9mb3JtYXQgPSBmYWxzZTtcbiAgICAvKipcbiAgICAgKiBmaW5kIHRoZSBSRyB2YWx1ZT8gZGVmYXVsdD0wXG4gICAgICovXG4gICAgdGhpcy5maW5kUmVwbGF5R2FpbiA9IGZhbHNlO1xuICAgIC8qKlxuICAgICAqIGRlY29kZSBvbiB0aGUgZmx5PyBkZWZhdWx0PTBcbiAgICAgKi9cbiAgICB0aGlzLmRlY29kZV9vbl90aGVfZmx5ID0gZmFsc2U7XG4gICAgLyoqXG4gICAgICogMSAoZGVmYXVsdCkgd3JpdGVzIElEMyB0YWdzLCAwIG5vdFxuICAgICAqL1xuICAgIHRoaXMud3JpdGVfaWQzdGFnX2F1dG9tYXRpYyA9IGZhbHNlO1xuXG4gICAgLypcbiAgICAgKiBzZXQgZWl0aGVyIGJyYXRlPjAgb3IgY29tcHJlc3Npb25fcmF0aW8+MCwgTEFNRSB3aWxsIGNvbXB1dGUgdGhlIHZhbHVlIG9mXG4gICAgICogdGhlIHZhcmlhYmxlIG5vdCBzZXQuIERlZmF1bHQgaXMgY29tcHJlc3Npb25fcmF0aW8gPSAxMS4wMjVcbiAgICAgKi9cbiAgICAvKipcbiAgICAgKiBiaXRyYXRlXG4gICAgICovXG4gICAgdGhpcy5icmF0ZSA9IDA7XG4gICAgLyoqXG4gICAgICogc2l6ZW9mKHdhdiBmaWxlKS9zaXplb2YobXAzIGZpbGUpXG4gICAgICovXG4gICAgdGhpcy5jb21wcmVzc2lvbl9yYXRpbyA9IDAuO1xuXG4gICAgLyogZnJhbWUgcGFyYW1zICovXG4gICAgLyoqXG4gICAgICogbWFyayBhcyBjb3B5cmlnaHQuIGRlZmF1bHQ9MFxuICAgICAqL1xuICAgIHRoaXMuY29weXJpZ2h0ID0gMDtcbiAgICAvKipcbiAgICAgKiBtYXJrIGFzIG9yaWdpbmFsLiBkZWZhdWx0PTFcbiAgICAgKi9cbiAgICB0aGlzLm9yaWdpbmFsID0gMDtcbiAgICAvKipcbiAgICAgKiB0aGUgTVAzICdwcml2YXRlIGV4dGVuc2lvbicgYml0LiBNZWFuaW5nbGVzc1xuICAgICAqL1xuICAgIHRoaXMuZXh0ZW5zaW9uID0gMDtcbiAgICAvKipcbiAgICAgKiBJbnB1dCBQQ00gaXMgZW1waGFzZWQgUENNIChmb3IgaW5zdGFuY2UgZnJvbSBvbmUgb2YgdGhlIHJhcmVseSBlbXBoYXNlZFxuICAgICAqIENEcyksIGl0IGlzIFNUUk9OR0xZIG5vdCByZWNvbW1lbmRlZCB0byB1c2UgdGhpcywgYmVjYXVzZSBwc3ljaG8gZG9lcyBub3RcbiAgICAgKiB0YWtlIGl0IGludG8gYWNjb3VudCwgYW5kIGxhc3QgYnV0IG5vdCBsZWFzdCBtYW55IGRlY29kZXJzIGRvbid0IGNhcmVcbiAgICAgKiBhYm91dCB0aGVzZSBiaXRzXG4gICAgICovXG4gICAgdGhpcy5lbXBoYXNpcyA9IDA7XG4gICAgLyoqXG4gICAgICogdXNlIDIgYnl0ZXMgcGVyIGZyYW1lIGZvciBhIENSQyBjaGVja3N1bS4gZGVmYXVsdD0wXG4gICAgICovXG4gICAgdGhpcy5lcnJvcl9wcm90ZWN0aW9uID0gMDtcbiAgICAvKipcbiAgICAgKiBlbmZvcmNlIElTTyBzcGVjIGFzIG11Y2ggYXMgcG9zc2libGVcbiAgICAgKi9cbiAgICB0aGlzLnN0cmljdF9JU08gPSBmYWxzZTtcblxuICAgIC8qKlxuICAgICAqIHVzZSBiaXQgcmVzZXJ2b2lyP1xuICAgICAqL1xuICAgIHRoaXMuZGlzYWJsZV9yZXNlcnZvaXIgPSBmYWxzZTtcblxuICAgIC8qIHF1YW50aXphdGlvbi9ub2lzZSBzaGFwaW5nICovXG4gICAgdGhpcy5xdWFudF9jb21wID0gMDtcbiAgICB0aGlzLnF1YW50X2NvbXBfc2hvcnQgPSAwO1xuICAgIHRoaXMuZXhwZXJpbWVudGFsWSA9IGZhbHNlO1xuICAgIHRoaXMuZXhwZXJpbWVudGFsWiA9IDA7XG4gICAgdGhpcy5leHBfbnNwc3l0dW5lID0gMDtcblxuICAgIHRoaXMucHJlc2V0ID0gMDtcblxuICAgIC8qIFZCUiBjb250cm9sICovXG4gICAgdGhpcy5WQlIgPSBudWxsO1xuICAgIC8qKlxuICAgICAqIFJhbmdlIFswLC4uLiwxW1xuICAgICAqL1xuICAgIHRoaXMuVkJSX3FfZnJhYyA9IDAuO1xuICAgIC8qKlxuICAgICAqIFJhbmdlIFswLC4uLiw5XVxuICAgICAqL1xuICAgIHRoaXMuVkJSX3EgPSAwO1xuICAgIHRoaXMuVkJSX21lYW5fYml0cmF0ZV9rYnBzID0gMDtcbiAgICB0aGlzLlZCUl9taW5fYml0cmF0ZV9rYnBzID0gMDtcbiAgICB0aGlzLlZCUl9tYXhfYml0cmF0ZV9rYnBzID0gMDtcbiAgICAvKipcbiAgICAgKiBzdHJpY3RseSBlbmZvcmNlIFZCUl9taW5fYml0cmF0ZSBub3JtYWx5LCBpdCB3aWxsIGJlIHZpb2xhdGVkIGZvciBhbmFsb2dcbiAgICAgKiBzaWxlbmNlXG4gICAgICovXG4gICAgdGhpcy5WQlJfaGFyZF9taW4gPSAwO1xuXG4gICAgLyogcmVzYW1wbGluZyBhbmQgZmlsdGVyaW5nICovXG5cbiAgICAvKipcbiAgICAgKiBmcmVxIGluIEh6LiAwPWxhbWUgY2hvc2VzLiAtMT1ubyBmaWx0ZXJcbiAgICAgKi9cbiAgICB0aGlzLmxvd3Bhc3NmcmVxID0gMDtcbiAgICAvKipcbiAgICAgKiBmcmVxIGluIEh6LiAwPWxhbWUgY2hvc2VzLiAtMT1ubyBmaWx0ZXJcbiAgICAgKi9cbiAgICB0aGlzLmhpZ2hwYXNzZnJlcSA9IDA7XG4gICAgLyoqXG4gICAgICogZnJlcSB3aWR0aCBvZiBmaWx0ZXIsIGluIEh6IChkZWZhdWx0PTE1JSlcbiAgICAgKi9cbiAgICB0aGlzLmxvd3Bhc3N3aWR0aCA9IDA7XG4gICAgLyoqXG4gICAgICogZnJlcSB3aWR0aCBvZiBmaWx0ZXIsIGluIEh6IChkZWZhdWx0PTE1JSlcbiAgICAgKi9cbiAgICB0aGlzLmhpZ2hwYXNzd2lkdGggPSAwO1xuXG4gICAgLypcbiAgICAgKiBwc3ljaG8gYWNvdXN0aWNzIGFuZCBvdGhlciBhcmd1bWVudHMgd2hpY2ggeW91IHNob3VsZCBub3QgY2hhbmdlIHVubGVzc1xuICAgICAqIHlvdSBrbm93IHdoYXQgeW91IGFyZSBkb2luZ1xuICAgICAqL1xuXG4gICAgdGhpcy5tYXNraW5nYWRqdXN0ID0gMC47XG4gICAgdGhpcy5tYXNraW5nYWRqdXN0X3Nob3J0ID0gMC47XG4gICAgLyoqXG4gICAgICogb25seSB1c2UgQVRIXG4gICAgICovXG4gICAgdGhpcy5BVEhvbmx5ID0gZmFsc2U7XG4gICAgLyoqXG4gICAgICogb25seSB1c2UgQVRIIGZvciBzaG9ydCBibG9ja3NcbiAgICAgKi9cbiAgICB0aGlzLkFUSHNob3J0ID0gZmFsc2U7XG4gICAgLyoqXG4gICAgICogZGlzYWJsZSBBVEhcbiAgICAgKi9cbiAgICB0aGlzLm5vQVRIID0gZmFsc2U7XG4gICAgLyoqXG4gICAgICogc2VsZWN0IEFUSCBmb3JtdWxhXG4gICAgICovXG4gICAgdGhpcy5BVEh0eXBlID0gMDtcbiAgICAvKipcbiAgICAgKiBjaGFuZ2UgQVRIIGZvcm11bGEgNCBzaGFwZVxuICAgICAqL1xuICAgIHRoaXMuQVRIY3VydmUgPSAwLjtcbiAgICAvKipcbiAgICAgKiBsb3dlciBBVEggYnkgdGhpcyBtYW55IGRiXG4gICAgICovXG4gICAgdGhpcy5BVEhsb3dlciA9IDAuO1xuICAgIC8qKlxuICAgICAqIHNlbGVjdCBBVEggYXV0by1hZGp1c3Qgc2NoZW1lXG4gICAgICovXG4gICAgdGhpcy5hdGhhYV90eXBlID0gMDtcbiAgICAvKipcbiAgICAgKiBzZWxlY3QgQVRIIGF1dG8tYWRqdXN0IGxvdWRuZXNzIGNhbGNcbiAgICAgKi9cbiAgICB0aGlzLmF0aGFhX2xvdWRhcHByb3ggPSAwO1xuICAgIC8qKlxuICAgICAqIGRCLCB0dW5lIGFjdGl2ZSByZWdpb24gb2YgYXV0by1sZXZlbFxuICAgICAqL1xuICAgIHRoaXMuYXRoYWFfc2Vuc2l0aXZpdHkgPSAwLjtcbiAgICB0aGlzLnNob3J0X2Jsb2NrcyA9IG51bGw7XG4gICAgLyoqXG4gICAgICogdXNlIHRlbXBvcmFsIG1hc2tpbmcgZWZmZWN0XG4gICAgICovXG4gICAgdGhpcy51c2VUZW1wb3JhbCA9IGZhbHNlO1xuICAgIHRoaXMuaW50ZXJDaFJhdGlvID0gMC47XG4gICAgLyoqXG4gICAgICogTmFva2kncyBhZGp1c3RtZW50IG9mIE1pZC9TaWRlIG1hc2tpbmdzXG4gICAgICovXG4gICAgdGhpcy5tc2ZpeCA9IDAuO1xuXG4gICAgLyoqXG4gICAgICogMCBvZmYsIDEgb25cbiAgICAgKi9cbiAgICB0aGlzLnR1bmUgPSBmYWxzZTtcbiAgICAvKipcbiAgICAgKiB1c2VkIHRvIHBhc3MgdmFsdWVzIGZvciBkZWJ1Z2dpbmcgYW5kIHN0dWZmXG4gICAgICovXG4gICAgdGhpcy50dW5lX3ZhbHVlX2EgPSAwLjtcblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgLyogaW50ZXJuYWwgdmFyaWFibGVzLCBkbyBub3Qgc2V0Li4uICovXG4gICAgLyogcHJvdmlkZWQgYmVjYXVzZSB0aGV5IG1heSBiZSBvZiB1c2UgdG8gY2FsbGluZyBhcHBsaWNhdGlvbiAqL1xuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAvKipcbiAgICAgKiAwPU1QRUctMi8yLjUgMT1NUEVHLTFcbiAgICAgKi9cbiAgICB0aGlzLnZlcnNpb24gPSAwO1xuICAgIHRoaXMuZW5jb2Rlcl9kZWxheSA9IDA7XG4gICAgLyoqXG4gICAgICogbnVtYmVyIG9mIHNhbXBsZXMgb2YgcGFkZGluZyBhcHBlbmRlZCB0byBpbnB1dFxuICAgICAqL1xuICAgIHRoaXMuZW5jb2Rlcl9wYWRkaW5nID0gMDtcbiAgICB0aGlzLmZyYW1lc2l6ZSA9IDA7XG4gICAgLyoqXG4gICAgICogbnVtYmVyIG9mIGZyYW1lcyBlbmNvZGVkXG4gICAgICovXG4gICAgdGhpcy5mcmFtZU51bSA9IDA7XG4gICAgLyoqXG4gICAgICogaXMgdGhpcyBzdHJ1Y3Qgb3duZWQgYnkgY2FsbGluZyBwcm9ncmFtIG9yIGxhbWU/XG4gICAgICovXG4gICAgdGhpcy5sYW1lX2FsbG9jYXRlZF9nZnAgPSAwO1xuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAvKiBtb3JlIGludGVybmFsIHZhcmlhYmxlcyBhcmUgc3RvcmVkIGluIHRoaXMgc3RydWN0dXJlOiAqL1xuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICB0aGlzLmludGVybmFsX2ZsYWdzID0gbnVsbDtcbn1cblxuXG5cbmZ1bmN0aW9uIENCUk5ld0l0ZXJhdGlvbkxvb3AoX3F1YW50aXplKSAge1xuICAgIHZhciBxdWFudGl6ZSA9IF9xdWFudGl6ZTtcbiAgICB0aGlzLnF1YW50aXplID0gcXVhbnRpemU7XG5cdHRoaXMuaXRlcmF0aW9uX2xvb3AgPSBmdW5jdGlvbihnZnAsIHBlLCBtc19lbmVyX3JhdGlvLCByYXRpbykge1xuXHRcdHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBsM194bWluID0gbmV3X2Zsb2F0KEwzU2lkZS5TRkJNQVgpO1xuXHRcdHZhciB4cnBvdyA9IG5ld19mbG9hdCg1NzYpO1xuXHRcdHZhciB0YXJnX2JpdHMgPSBuZXdfaW50KDIpO1xuXHRcdHZhciBtZWFuX2JpdHMgPSAwLCBtYXhfYml0cztcblx0XHR2YXIgbDNfc2lkZSA9IGdmYy5sM19zaWRlO1xuXG5cdFx0dmFyIG1iID0gbmV3IE1lYW5CaXRzKG1lYW5fYml0cyk7XG5cdFx0dGhpcy5xdWFudGl6ZS5ydi5SZXN2RnJhbWVCZWdpbihnZnAsIG1iKTtcblx0XHRtZWFuX2JpdHMgPSBtYi5iaXRzO1xuXG5cdFx0LyogcXVhbnRpemUhICovXG5cdFx0Zm9yICh2YXIgZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG5cblx0XHRcdC8qXG5cdFx0XHQgKiBjYWxjdWxhdGUgbmVlZGVkIGJpdHNcblx0XHRcdCAqL1xuXHRcdFx0bWF4X2JpdHMgPSB0aGlzLnF1YW50aXplLnF1cHZ0Lm9uX3BlKGdmcCwgcGUsIHRhcmdfYml0cywgbWVhbl9iaXRzLFxuXHRcdFx0XHRcdGdyLCBncik7XG5cblx0XHRcdGlmIChnZmMubW9kZV9leHQgPT0gRW5jb2Rlci5NUEdfTURfTVNfTFIpIHtcblx0XHRcdFx0dGhpcy5xdWFudGl6ZS5tc19jb252ZXJ0KGdmYy5sM19zaWRlLCBncik7XG5cdFx0XHRcdHRoaXMucXVhbnRpemUucXVwdnQucmVkdWNlX3NpZGUodGFyZ19iaXRzLCBtc19lbmVyX3JhdGlvW2dyXSxcblx0XHRcdFx0XHRcdG1lYW5fYml0cywgbWF4X2JpdHMpO1xuXHRcdFx0fVxuXG5cdFx0XHRmb3IgKHZhciBjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuXHRcdFx0XHR2YXIgYWRqdXN0LCBtYXNraW5nX2xvd2VyX2RiO1xuXHRcdFx0XHR2YXIgY29kX2luZm8gPSBsM19zaWRlLnR0W2dyXVtjaF07XG5cblx0XHRcdFx0aWYgKGNvZF9pbmZvLmJsb2NrX3R5cGUgIT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG5cdFx0XHRcdFx0Ly8gTk9STSwgU1RBUlQgb3IgU1RPUCB0eXBlXG5cdFx0XHRcdFx0YWRqdXN0ID0gMDtcblx0XHRcdFx0XHRtYXNraW5nX2xvd2VyX2RiID0gZ2ZjLlBTWS5tYXNrX2FkanVzdCAtIGFkanVzdDtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRhZGp1c3QgPSAwO1xuXHRcdFx0XHRcdG1hc2tpbmdfbG93ZXJfZGIgPSBnZmMuUFNZLm1hc2tfYWRqdXN0X3Nob3J0IC0gYWRqdXN0O1xuXHRcdFx0XHR9XG5cdFx0XHRcdGdmYy5tYXNraW5nX2xvd2VyID0gIE1hdGgucG93KDEwLjAsXG5cdFx0XHRcdFx0XHRtYXNraW5nX2xvd2VyX2RiICogMC4xKTtcblxuXHRcdFx0XHQvKlxuXHRcdFx0XHQgKiBpbml0X291dGVyX2xvb3Agc2V0cyB1cCBjb2RfaW5mbywgc2NhbGVmYWMgYW5kIHhycG93XG5cdFx0XHRcdCAqL1xuXHRcdFx0XHR0aGlzLnF1YW50aXplLmluaXRfb3V0ZXJfbG9vcChnZmMsIGNvZF9pbmZvKTtcblx0XHRcdFx0aWYgKHRoaXMucXVhbnRpemUuaW5pdF94cnBvdyhnZmMsIGNvZF9pbmZvLCB4cnBvdykpIHtcblx0XHRcdFx0XHQvKlxuXHRcdFx0XHRcdCAqIHhyIGNvbnRhaW5zIGVuZXJneSB3ZSB3aWxsIGhhdmUgdG8gZW5jb2RlIGNhbGN1bGF0ZSB0aGVcblx0XHRcdFx0XHQgKiBtYXNraW5nIGFiaWxpdGllcyBmaW5kIHNvbWUgZ29vZCBxdWFudGl6YXRpb24gaW5cblx0XHRcdFx0XHQgKiBvdXRlcl9sb29wXG5cdFx0XHRcdFx0ICovXG5cdFx0XHRcdFx0dGhpcy5xdWFudGl6ZS5xdXB2dC5jYWxjX3htaW4oZ2ZwLCByYXRpb1tncl1bY2hdLCBjb2RfaW5mbyxcblx0XHRcdFx0XHRcdFx0bDNfeG1pbik7XG5cdFx0XHRcdFx0dGhpcy5xdWFudGl6ZS5vdXRlcl9sb29wKGdmcCwgY29kX2luZm8sIGwzX3htaW4sIHhycG93LCBjaCxcblx0XHRcdFx0XHRcdFx0dGFyZ19iaXRzW2NoXSk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHR0aGlzLnF1YW50aXplLml0ZXJhdGlvbl9maW5pc2hfb25lKGdmYywgZ3IsIGNoKTtcblx0XHRcdH0gLyogZm9yIGNoICovXG5cdFx0fSAvKiBmb3IgZ3IgKi9cblxuXHRcdHRoaXMucXVhbnRpemUucnYuUmVzdkZyYW1lRW5kKGdmYywgbWVhbl9iaXRzKTtcblx0fVxufVxuXG5cbmZ1bmN0aW9uIFJlcGxheUdhaW4oKSB7XG5cdC8vZml4IOeyvueugFxufVxuXG4vL3BhY2thZ2UgbXAzO1xuXG4vKipcbiAqIExheWVyIElJSSBzaWRlIGluZm9ybWF0aW9uLlxuICpcbiAqIEBhdXRob3IgS2VuXG4gKlxuICovXG5cblxuXG5mdW5jdGlvbiBTY2FsZUZhYyhhcnJMLCBhcnJTLCBhcnIyMSwgYXJyMTIpIHtcblxuICAgIHRoaXMubCA9IG5ld19pbnQoMSArIEVuY29kZXIuU0JNQVhfbCk7XG4gICAgdGhpcy5zID0gbmV3X2ludCgxICsgRW5jb2Rlci5TQk1BWF9zKTtcbiAgICB0aGlzLnBzZmIyMSA9IG5ld19pbnQoMSArIEVuY29kZXIuUFNGQjIxKTtcbiAgICB0aGlzLnBzZmIxMiA9IG5ld19pbnQoMSArIEVuY29kZXIuUFNGQjEyKTtcbiAgICB2YXIgbCA9IHRoaXMubDtcbiAgICB2YXIgcyA9IHRoaXMucztcblxuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDQpIHtcbiAgICAgICAgLy9wdWJsaWMgU2NhbGVGYWMoZmluYWwgaW50W10gYXJyTCwgZmluYWwgaW50W10gYXJyUywgZmluYWwgaW50W10gYXJyMjEsXG4gICAgICAgIC8vICAgIGZpbmFsIGludFtdIGFycjEyKSB7XG4gICAgICAgIHRoaXMuYXJyTCA9IGFyZ3VtZW50c1swXTtcbiAgICAgICAgdGhpcy5hcnJTID0gYXJndW1lbnRzWzFdO1xuICAgICAgICB0aGlzLmFycjIxID0gYXJndW1lbnRzWzJdO1xuICAgICAgICB0aGlzLmFycjEyID0gYXJndW1lbnRzWzNdO1xuXG4gICAgICAgIFN5c3RlbS5hcnJheWNvcHkodGhpcy5hcnJMLCAwLCBsLCAwLCBNYXRoLm1pbih0aGlzLmFyckwubGVuZ3RoLCB0aGlzLmwubGVuZ3RoKSk7XG4gICAgICAgIFN5c3RlbS5hcnJheWNvcHkodGhpcy5hcnJTLCAwLCBzLCAwLCBNYXRoLm1pbih0aGlzLmFyclMubGVuZ3RoLCB0aGlzLnMubGVuZ3RoKSk7XG4gICAgICAgIFN5c3RlbS5hcnJheWNvcHkodGhpcy5hcnIyMSwgMCwgdGhpcy5wc2ZiMjEsIDAsIE1hdGgubWluKHRoaXMuYXJyMjEubGVuZ3RoLCB0aGlzLnBzZmIyMS5sZW5ndGgpKTtcbiAgICAgICAgU3lzdGVtLmFycmF5Y29weSh0aGlzLmFycjEyLCAwLCB0aGlzLnBzZmIxMiwgMCwgTWF0aC5taW4odGhpcy5hcnIxMi5sZW5ndGgsIHRoaXMucHNmYjEyLmxlbmd0aCkpO1xuICAgIH1cbn1cblxuLypcbiAqICAgICAgcXVhbnRpemVfcHZ0IHNvdXJjZSBmaWxlXG4gKlxuICogICAgICBDb3B5cmlnaHQgKGMpIDE5OTktMjAwMiBUYWtlaGlybyBUb21pbmFnYVxuICogICAgICBDb3B5cmlnaHQgKGMpIDIwMDAtMjAwMiBSb2JlcnQgSGVnZW1hbm5cbiAqICAgICAgQ29weXJpZ2h0IChjKSAyMDAxIE5hb2tpIFNoaWJhdGFcbiAqICAgICAgQ29weXJpZ2h0IChjKSAyMDAyLTIwMDUgR2FicmllbCBCb3V2aWduZVxuICpcbiAqIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3JcbiAqIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWNcbiAqIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlclxuICogdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLlxuICpcbiAqIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLFxuICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2ZcbiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VXG4gKiBMaWJyYXJ5IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cbiAqXG4gKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG4gKiBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHdyaXRlIHRvIHRoZVxuICogRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBJbmMuLCA1OSBUZW1wbGUgUGxhY2UgLSBTdWl0ZSAzMzAsXG4gKiBCb3N0b24sIE1BIDAyMTExLTEzMDcsIFVTQS5cbiAqL1xuXG4vKiAkSWQ6IFF1YW50aXplUFZULmphdmEsdiAxLjI0IDIwMTEvMDUvMjQgMjA6NDg6MDYga2VuY2hpcyBFeHAgJCAqL1xuXG5cblF1YW50aXplUFZULlFfTUFYID0gKDI1NiArIDEpO1xuUXVhbnRpemVQVlQuUV9NQVgyID0gMTE2O1xuUXVhbnRpemVQVlQuTEFSR0VfQklUUyA9IDEwMDAwMDtcblF1YW50aXplUFZULklYTUFYX1ZBTCA9IDgyMDY7XG5cbmZ1bmN0aW9uIFF1YW50aXplUFZUKCkge1xuXG4gICAgdmFyIHRhayA9IG51bGw7XG4gICAgdmFyIHJ2ID0gbnVsbDtcbiAgICB2YXIgcHN5ID0gbnVsbDtcblxuICAgIHRoaXMuc2V0TW9kdWxlcyA9IGZ1bmN0aW9uIChfdGssIF9ydiwgX3BzeSkge1xuICAgICAgICB0YWsgPSBfdGs7XG4gICAgICAgIHJ2ID0gX3J2O1xuICAgICAgICBwc3kgPSBfcHN5O1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBQT1cyMCh4KSB7XG4gICAgICAgIHJldHVybiBwb3cyMFt4ICsgUXVhbnRpemVQVlQuUV9NQVgyXTtcbiAgICB9XG5cbiAgICB0aGlzLklQT1cyMCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgICAgIHJldHVybiBpcG93MjBbeF07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogc21hbGxlc3Qgc3VjaCB0aGF0IDEuMCtEQkxfRVBTSUxPTiAhPSAxLjBcbiAgICAgKi9cbiAgICB2YXIgREJMX0VQU0lMT04gPSAyLjIyMDQ0NjA0OTI1MDMxMzFlLTAxNjtcblxuICAgIC8qKlxuICAgICAqIGl4IGFsd2F5cyA8PSA4MTkxKzE1LiBzZWUgY291bnRfYml0cygpXG4gICAgICovXG4gICAgdmFyIElYTUFYX1ZBTCA9IFF1YW50aXplUFZULklYTUFYX1ZBTDtcblxuICAgIHZhciBQUkVDQUxDX1NJWkUgPSAoSVhNQVhfVkFMICsgMik7XG5cbiAgICB2YXIgUV9NQVggPSBRdWFudGl6ZVBWVC5RX01BWDtcblxuXG4gICAgLyoqXG4gICAgICogPENPREU+XG4gICAgICogbWluaW11bSBwb3NzaWJsZSBudW1iZXIgb2ZcbiAgICAgKiAtY29kX2luZm8uZ2xvYmFsX2dhaW4gKyAoKHNjYWxlZmFjW10gKyAoY29kX2luZm8ucHJlZmxhZyA/IHByZXRhYltzZmJdIDogMCkpXG4gICAgICogPDwgKGNvZF9pbmZvLnNjYWxlZmFjX3NjYWxlICsgMSkpICsgY29kX2luZm8uc3ViYmxvY2tfZ2Fpbltjb2RfaW5mby53aW5kb3dbc2ZiXV0gKiA4O1xuICAgICAqXG4gICAgICogZm9yIGxvbmcgYmxvY2ssIDArKCgxNSszKTw8MikgPSAxOCo0ID0gNzJcbiAgICAgKiBmb3Igc2hvcnQgYmxvY2ssIDArKDE1PDwyKSs3KjggPSAxNSo0KzU2ID0gMTE2XG4gICAgICogPC9DT0RFPlxuICAgICAqL1xuICAgIHZhciBRX01BWDIgPSBRdWFudGl6ZVBWVC5RX01BWDI7XG5cbiAgICB2YXIgTEFSR0VfQklUUyA9IFF1YW50aXplUFZULkxBUkdFX0JJVFM7XG5cblxuICAgIC8qKlxuICAgICAqIEFzc3VtaW5nIGR5bmFtaWMgcmFuZ2U9OTZkQiwgdGhpcyB2YWx1ZSBzaG91bGQgYmUgOTJcbiAgICAgKi9cbiAgICB2YXIgTlNBVEhTQ0FMRSA9IDEwMDtcblxuICAgIC8qKlxuICAgICAqIFRoZSBmb2xsb3dpbmcgdGFibGUgaXMgdXNlZCB0byBpbXBsZW1lbnQgdGhlIHNjYWxlZmFjdG9yIHBhcnRpdGlvbmluZyBmb3JcbiAgICAgKiBNUEVHMiBhcyBkZXNjcmliZWQgaW4gc2VjdGlvbiAyLjQuMy4yIG9mIHRoZSBJUy4gVGhlIGluZGV4aW5nIGNvcnJlc3BvbmRzXG4gICAgICogdG8gdGhlIHdheSB0aGUgdGFibGVzIGFyZSBwcmVzZW50ZWQgaW4gdGhlIElTOlxuICAgICAqXG4gICAgICogW3RhYmxlX251bWJlcl1bcm93X2luX3RhYmxlXVtjb2x1bW4gb2YgbnJfb2Zfc2ZiXVxuICAgICAqL1xuICAgIHRoaXMubnJfb2Zfc2ZiX2Jsb2NrID0gW1xuICAgICAgICBbWzYsIDUsIDUsIDVdLCBbOSwgOSwgOSwgOV0sIFs2LCA5LCA5LCA5XV0sXG4gICAgICAgIFtbNiwgNSwgNywgM10sIFs5LCA5LCAxMiwgNl0sIFs2LCA5LCAxMiwgNl1dLFxuICAgICAgICBbWzExLCAxMCwgMCwgMF0sIFsxOCwgMTgsIDAsIDBdLCBbMTUsIDE4LCAwLCAwXV0sXG4gICAgICAgIFtbNywgNywgNywgMF0sIFsxMiwgMTIsIDEyLCAwXSwgWzYsIDE1LCAxMiwgMF1dLFxuICAgICAgICBbWzYsIDYsIDYsIDNdLCBbMTIsIDksIDksIDZdLCBbNiwgMTIsIDksIDZdXSxcbiAgICAgICAgW1s4LCA4LCA1LCAwXSwgWzE1LCAxMiwgOSwgMF0sIFs2LCAxOCwgOSwgMF1dXTtcblxuICAgIC8qKlxuICAgICAqIFRhYmxlIEIuNjogbGF5ZXIzIHByZWVtcGhhc2lzXG4gICAgICovXG4gICAgdmFyIHByZXRhYiA9IFswLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAwLCAxLCAxLCAxLCAxLFxuICAgICAgICAyLCAyLCAzLCAzLCAzLCAyLCAwXTtcbiAgICB0aGlzLnByZXRhYiA9IHByZXRhYjtcblxuICAgIC8qKlxuICAgICAqIEhlcmUgYXJlIE1QRUcxIFRhYmxlIEIuOCBhbmQgTVBFRzIgVGFibGUgQi4xIC0tIExheWVyIElJSSBzY2FsZWZhY3RvclxuICAgICAqIGJhbmRzLiA8QlI+XG4gICAgICogSW5kZXggaW50byB0aGlzIHVzaW5nIGEgbWV0aG9kIHN1Y2ggYXM6PEJSPlxuICAgICAqIGlkeCA9IGZyX3BzLmhlYWRlci5zYW1wbGluZ19mcmVxdWVuY3kgKyAoZnJfcHMuaGVhZGVyLnZlcnNpb24gKiAzKVxuICAgICAqL1xuICAgIHRoaXMuc2ZCYW5kSW5kZXggPSBbXG4gICAgICAgIC8vIFRhYmxlIEIuMi5iOiAyMi4wNSBrSHpcbiAgICAgICAgbmV3IFNjYWxlRmFjKFswLCA2LCAxMiwgMTgsIDI0LCAzMCwgMzYsIDQ0LCA1NCwgNjYsIDgwLCA5NiwgMTE2LCAxNDAsIDE2OCwgMjAwLCAyMzgsIDI4NCwgMzM2LCAzOTYsIDQ2NCxcbiAgICAgICAgICAgICAgICA1MjIsIDU3Nl0sXG4gICAgICAgICAgICBbMCwgNCwgOCwgMTIsIDE4LCAyNCwgMzIsIDQyLCA1NiwgNzQsIDEwMCwgMTMyLCAxNzQsIDE5Ml1cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8vICBzZmIyMSBwc2V1ZG8gc3ViIGJhbmRzXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvLyAgc2ZiMTIgcHNldWRvIHN1YiBiYW5kc1xuICAgICAgICApLFxuICAgICAgICAvKiBUYWJsZSBCLjIuYzogMjQga0h6ICovIC8qIGRvY3M6IDMzMi4gbXBnMTIzKGJyb2tlbik6IDMzMCAqL1xuICAgICAgICBuZXcgU2NhbGVGYWMoWzAsIDYsIDEyLCAxOCwgMjQsIDMwLCAzNiwgNDQsIDU0LCA2NiwgODAsIDk2LCAxMTQsIDEzNiwgMTYyLCAxOTQsIDIzMiwgMjc4LCAzMzIsIDM5NCwgNDY0LFxuICAgICAgICAgICAgICAgIDU0MCwgNTc2XSxcbiAgICAgICAgICAgIFswLCA0LCA4LCAxMiwgMTgsIDI2LCAzNiwgNDgsIDYyLCA4MCwgMTA0LCAxMzYsIDE4MCwgMTkyXVxuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLyogIHNmYjIxIHBzZXVkbyBzdWIgYmFuZHMgKi9cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8qICBzZmIxMiBwc2V1ZG8gc3ViIGJhbmRzICovXG4gICAgICAgICksXG4gICAgICAgIC8qIFRhYmxlIEIuMi5hOiAxNiBrSHogKi9cbiAgICAgICAgbmV3IFNjYWxlRmFjKFswLCA2LCAxMiwgMTgsIDI0LCAzMCwgMzYsIDQ0LCA1NCwgNjYsIDgwLCA5NiwgMTE2LCAxNDAsIDE2OCwgMjAwLCAyMzgsIDI4NCwgMzM2LCAzOTYsIDQ2NCxcbiAgICAgICAgICAgICAgICA1MjIsIDU3Nl0sXG4gICAgICAgICAgICBbMCwgNCwgOCwgMTIsIDE4LCAyNiwgMzYsIDQ4LCA2MiwgODAsIDEwNCwgMTM0LCAxNzQsIDE5Ml1cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8qICBzZmIyMSBwc2V1ZG8gc3ViIGJhbmRzICovXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvKiAgc2ZiMTIgcHNldWRvIHN1YiBiYW5kcyAqL1xuICAgICAgICApLFxuICAgICAgICAvKiBUYWJsZSBCLjguYjogNDQuMSBrSHogKi9cbiAgICAgICAgbmV3IFNjYWxlRmFjKFswLCA0LCA4LCAxMiwgMTYsIDIwLCAyNCwgMzAsIDM2LCA0NCwgNTIsIDYyLCA3NCwgOTAsIDExMCwgMTM0LCAxNjIsIDE5NiwgMjM4LCAyODgsIDM0MiwgNDE4LFxuICAgICAgICAgICAgICAgIDU3Nl0sXG4gICAgICAgICAgICBbMCwgNCwgOCwgMTIsIDE2LCAyMiwgMzAsIDQwLCA1MiwgNjYsIDg0LCAxMDYsIDEzNiwgMTkyXVxuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLyogIHNmYjIxIHBzZXVkbyBzdWIgYmFuZHMgKi9cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8qICBzZmIxMiBwc2V1ZG8gc3ViIGJhbmRzICovXG4gICAgICAgICksXG4gICAgICAgIC8qIFRhYmxlIEIuOC5jOiA0OCBrSHogKi9cbiAgICAgICAgbmV3IFNjYWxlRmFjKFswLCA0LCA4LCAxMiwgMTYsIDIwLCAyNCwgMzAsIDM2LCA0MiwgNTAsIDYwLCA3MiwgODgsIDEwNiwgMTI4LCAxNTYsIDE5MCwgMjMwLCAyNzYsIDMzMCwgMzg0LFxuICAgICAgICAgICAgICAgIDU3Nl0sXG4gICAgICAgICAgICBbMCwgNCwgOCwgMTIsIDE2LCAyMiwgMjgsIDM4LCA1MCwgNjQsIDgwLCAxMDAsIDEyNiwgMTkyXVxuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLyogIHNmYjIxIHBzZXVkbyBzdWIgYmFuZHMgKi9cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8qICBzZmIxMiBwc2V1ZG8gc3ViIGJhbmRzICovXG4gICAgICAgICksXG4gICAgICAgIC8qIFRhYmxlIEIuOC5hOiAzMiBrSHogKi9cbiAgICAgICAgbmV3IFNjYWxlRmFjKFswLCA0LCA4LCAxMiwgMTYsIDIwLCAyNCwgMzAsIDM2LCA0NCwgNTQsIDY2LCA4MiwgMTAyLCAxMjYsIDE1NiwgMTk0LCAyNDAsIDI5NiwgMzY0LCA0NDgsIDU1MCxcbiAgICAgICAgICAgICAgICA1NzZdLFxuICAgICAgICAgICAgWzAsIDQsIDgsIDEyLCAxNiwgMjIsIDMwLCA0MiwgNTgsIDc4LCAxMDQsIDEzOCwgMTgwLCAxOTJdXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvKiAgc2ZiMjEgcHNldWRvIHN1YiBiYW5kcyAqL1xuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLyogIHNmYjEyIHBzZXVkbyBzdWIgYmFuZHMgKi9cbiAgICAgICAgKSxcbiAgICAgICAgLyogTVBFRy0yLjUgMTEuMDI1IGtIeiAqL1xuICAgICAgICBuZXcgU2NhbGVGYWMoWzAsIDYsIDEyLCAxOCwgMjQsIDMwLCAzNiwgNDQsIDU0LCA2NiwgODAsIDk2LCAxMTYsIDE0MCwgMTY4LCAyMDAsIDIzOCwgMjg0LCAzMzYsIDM5NiwgNDY0LFxuICAgICAgICAgICAgICAgIDUyMiwgNTc2XSxcbiAgICAgICAgICAgIFswIC8gMywgMTIgLyAzLCAyNCAvIDMsIDM2IC8gMywgNTQgLyAzLCA3OCAvIDMsIDEwOCAvIDMsIDE0NCAvIDMsIDE4NiAvIDMsIDI0MCAvIDMsIDMxMiAvIDMsXG4gICAgICAgICAgICAgICAgNDAyIC8gMywgNTIyIC8gMywgNTc2IC8gM11cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8qICBzZmIyMSBwc2V1ZG8gc3ViIGJhbmRzICovXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvKiAgc2ZiMTIgcHNldWRvIHN1YiBiYW5kcyAqL1xuICAgICAgICApLFxuICAgICAgICAvKiBNUEVHLTIuNSAxMiBrSHogKi9cbiAgICAgICAgbmV3IFNjYWxlRmFjKFswLCA2LCAxMiwgMTgsIDI0LCAzMCwgMzYsIDQ0LCA1NCwgNjYsIDgwLCA5NiwgMTE2LCAxNDAsIDE2OCwgMjAwLCAyMzgsIDI4NCwgMzM2LCAzOTYsIDQ2NCxcbiAgICAgICAgICAgICAgICA1MjIsIDU3Nl0sXG4gICAgICAgICAgICBbMCAvIDMsIDEyIC8gMywgMjQgLyAzLCAzNiAvIDMsIDU0IC8gMywgNzggLyAzLCAxMDggLyAzLCAxNDQgLyAzLCAxODYgLyAzLCAyNDAgLyAzLCAzMTIgLyAzLFxuICAgICAgICAgICAgICAgIDQwMiAvIDMsIDUyMiAvIDMsIDU3NiAvIDNdXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvKiAgc2ZiMjEgcHNldWRvIHN1YiBiYW5kcyAqL1xuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLyogIHNmYjEyIHBzZXVkbyBzdWIgYmFuZHMgKi9cbiAgICAgICAgKSxcbiAgICAgICAgLyogTVBFRy0yLjUgOCBrSHogKi9cbiAgICAgICAgbmV3IFNjYWxlRmFjKFswLCAxMiwgMjQsIDM2LCA0OCwgNjAsIDcyLCA4OCwgMTA4LCAxMzIsIDE2MCwgMTkyLCAyMzIsIDI4MCwgMzM2LCA0MDAsIDQ3NiwgNTY2LCA1NjgsIDU3MCxcbiAgICAgICAgICAgICAgICA1NzIsIDU3NCwgNTc2XSxcbiAgICAgICAgICAgIFswIC8gMywgMjQgLyAzLCA0OCAvIDMsIDcyIC8gMywgMTA4IC8gMywgMTU2IC8gMywgMjE2IC8gMywgMjg4IC8gMywgMzcyIC8gMywgNDgwIC8gMywgNDg2IC8gMyxcbiAgICAgICAgICAgICAgICA0OTIgLyAzLCA0OTggLyAzLCA1NzYgLyAzXVxuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLyogIHNmYjIxIHBzZXVkbyBzdWIgYmFuZHMgKi9cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8qICBzZmIxMiBwc2V1ZG8gc3ViIGJhbmRzICovXG4gICAgICAgIClcbiAgICBdO1xuXG4gICAgdmFyIHBvdzIwID0gbmV3X2Zsb2F0KFFfTUFYICsgUV9NQVgyICsgMSk7XG4gICAgdmFyIGlwb3cyMCA9IG5ld19mbG9hdChRX01BWCk7XG4gICAgdmFyIHBvdzQzID0gbmV3X2Zsb2F0KFBSRUNBTENfU0laRSk7XG5cbiAgICB2YXIgYWRqNDMgPSBuZXdfZmxvYXQoUFJFQ0FMQ19TSVpFKTtcbiAgICB0aGlzLmFkajQzID0gYWRqNDM7XG5cbiAgICAvKipcbiAgICAgKiA8UFJFPlxuICAgICAqIGNvbXB1dGUgdGhlIEFUSCBmb3IgZWFjaCBzY2FsZWZhY3RvciBiYW5kIGNkIHJhbmdlOiAwLi45NmRiXG4gICAgICpcbiAgICAgKiBJbnB1dDogMy4za0h6IHNpZ25hbCAzMjc2NyBhbXBsaXR1ZGUgKDMuM2tIeiBpcyB3aGVyZSBBVEggaXMgc21hbGxlc3QgPVxuICAgICAqIC01ZGIpIGxvbmdibG9ja3M6IHNmYj0xMiBlbjAvYnc9LTExZGIgbWF4X2VuMCA9IDEuM2RiIHNob3J0YmxvY2tzOiBzZmI9NVxuICAgICAqIC05ZGIgMGRiXG4gICAgICpcbiAgICAgKiBJbnB1dDogMSAxIDEgMSAxIDEgMSAtMSAtMSAtMSAtMSAtMSAtMSAtMSAocmVwZWF0ZWQpIGxvbmdibG9ja3M6IGFtcD0xXG4gICAgICogc2ZiPTEyIGVuMC9idz0tMTAzIGRiIG1heF9lbjAgPSAtOTJkYiBhbXA9MzI3Njcgc2ZiPTEyIC0xMiBkYiAtMS40ZGJcbiAgICAgKlxuICAgICAqIElucHV0OiAxIDEgMSAxIDEgMSAxIC0xIC0xIC0xIC0xIC0xIC0xIC0xIChyZXBlYXRlZCkgc2hvcnRibG9ja3M6IGFtcD0xXG4gICAgICogc2ZiPTUgZW4wL2J3PSAtOTkgLTg2IGFtcD0zMjc2NyBzZmI9NSAtOSBkYiA0ZGJcbiAgICAgKlxuICAgICAqXG4gICAgICogTUFYIGVuZXJneSBvZiBsYXJnZXN0IHdhdmUgYXQgMy4za0h6ID0gMWRiIEFWRSBlbmVyZ3kgb2YgbGFyZ2VzdCB3YXZlIGF0XG4gICAgICogMy4za0h6ID0gLTExZGIgTGV0J3MgdGFrZSBBVkU6IC0xMWRiID0gbWF4aW11bSBzaWduYWwgaW4gc2ZiPTEyLiBEeW5hbWljXG4gICAgICogcmFuZ2Ugb2YgQ0Q6IDk2ZGIuIFRoZXJlZm9yIGVuZXJneSBvZiBzbWFsbGVzdCBhdWRpYmxlIHdhdmUgaW4gc2ZiPTEyID1cbiAgICAgKiAtMTEgLSA5NiA9IC0xMDdkYiA9IEFUSCBhdCAzLjNrSHouXG4gICAgICpcbiAgICAgKiBBVEggZm9ybXVsYSBmb3IgdGhpcyB3YXZlOiAtNWRiLiBUbyBhZGp1c3QgdG8gTEFNRSBzY2FsaW5nLCB3ZSBuZWVkIEFUSCA9XG4gICAgICogQVRIX2Zvcm11bGEgLSAxMDMgKGRiKSBBVEggPSBBVEggKiAyLjVlLTEwIChlbmVyKVxuICAgICAqIDwvUFJFPlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIEFUSG1kY3QoZ2ZwLCBmKSB7XG4gICAgICAgIHZhciBhdGggPSBwc3kuQVRIZm9ybXVsYShmLCBnZnApO1xuXG4gICAgICAgIGF0aCAtPSBOU0FUSFNDQUxFO1xuXG4gICAgICAgIC8qIG1vZGlmeSB0aGUgTURDVCBzY2FsaW5nIGZvciB0aGUgQVRIIGFuZCBjb252ZXJ0IHRvIGVuZXJneSAqL1xuICAgICAgICBhdGggPSBNYXRoLnBvdygxMC4wLCBhdGggLyAxMC4wICsgZ2ZwLkFUSGxvd2VyKTtcbiAgICAgICAgcmV0dXJuIGF0aDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb21wdXRlX2F0aChnZnApIHtcbiAgICAgICAgdmFyIEFUSF9sID0gZ2ZwLmludGVybmFsX2ZsYWdzLkFUSC5sO1xuICAgICAgICB2YXIgQVRIX3BzZmIyMSA9IGdmcC5pbnRlcm5hbF9mbGFncy5BVEgucHNmYjIxO1xuICAgICAgICB2YXIgQVRIX3MgPSBnZnAuaW50ZXJuYWxfZmxhZ3MuQVRILnM7XG4gICAgICAgIHZhciBBVEhfcHNmYjEyID0gZ2ZwLmludGVybmFsX2ZsYWdzLkFUSC5wc2ZiMTI7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBzYW1wX2ZyZXEgPSBnZnAub3V0X3NhbXBsZXJhdGU7XG5cbiAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgRW5jb2Rlci5TQk1BWF9sOyBzZmIrKykge1xuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFtzZmJdO1xuICAgICAgICAgICAgdmFyIGVuZCA9IGdmYy5zY2FsZWZhY19iYW5kLmxbc2ZiICsgMV07XG4gICAgICAgICAgICBBVEhfbFtzZmJdID0gRmxvYXQuTUFYX1ZBTFVFO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJlcSA9IGkgKiBzYW1wX2ZyZXEgLyAoMiAqIDU3Nik7XG4gICAgICAgICAgICAgICAgdmFyIEFUSF9mID0gQVRIbWRjdChnZnAsIGZyZXEpO1xuICAgICAgICAgICAgICAgIC8qIGZyZXEgaW4ga0h6ICovXG4gICAgICAgICAgICAgICAgQVRIX2xbc2ZiXSA9IE1hdGgubWluKEFUSF9sW3NmYl0sIEFUSF9mKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IEVuY29kZXIuUFNGQjIxOyBzZmIrKykge1xuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gZ2ZjLnNjYWxlZmFjX2JhbmQucHNmYjIxW3NmYl07XG4gICAgICAgICAgICB2YXIgZW5kID0gZ2ZjLnNjYWxlZmFjX2JhbmQucHNmYjIxW3NmYiArIDFdO1xuICAgICAgICAgICAgQVRIX3BzZmIyMVtzZmJdID0gRmxvYXQuTUFYX1ZBTFVFO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJlcSA9IGkgKiBzYW1wX2ZyZXEgLyAoMiAqIDU3Nik7XG4gICAgICAgICAgICAgICAgdmFyIEFUSF9mID0gQVRIbWRjdChnZnAsIGZyZXEpO1xuICAgICAgICAgICAgICAgIC8qIGZyZXEgaW4ga0h6ICovXG4gICAgICAgICAgICAgICAgQVRIX3BzZmIyMVtzZmJdID0gTWF0aC5taW4oQVRIX3BzZmIyMVtzZmJdLCBBVEhfZik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBFbmNvZGVyLlNCTUFYX3M7IHNmYisrKSB7XG4gICAgICAgICAgICB2YXIgc3RhcnQgPSBnZmMuc2NhbGVmYWNfYmFuZC5zW3NmYl07XG4gICAgICAgICAgICB2YXIgZW5kID0gZ2ZjLnNjYWxlZmFjX2JhbmQuc1tzZmIgKyAxXTtcbiAgICAgICAgICAgIEFUSF9zW3NmYl0gPSBGbG9hdC5NQVhfVkFMVUU7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBmcmVxID0gaSAqIHNhbXBfZnJlcSAvICgyICogMTkyKTtcbiAgICAgICAgICAgICAgICB2YXIgQVRIX2YgPSBBVEhtZGN0KGdmcCwgZnJlcSk7XG4gICAgICAgICAgICAgICAgLyogZnJlcSBpbiBrSHogKi9cbiAgICAgICAgICAgICAgICBBVEhfc1tzZmJdID0gTWF0aC5taW4oQVRIX3Nbc2ZiXSwgQVRIX2YpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgQVRIX3Nbc2ZiXSAqPSAoZ2ZjLnNjYWxlZmFjX2JhbmQuc1tzZmIgKyAxXSAtIGdmYy5zY2FsZWZhY19iYW5kLnNbc2ZiXSk7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBFbmNvZGVyLlBTRkIxMjsgc2ZiKyspIHtcbiAgICAgICAgICAgIHZhciBzdGFydCA9IGdmYy5zY2FsZWZhY19iYW5kLnBzZmIxMltzZmJdO1xuICAgICAgICAgICAgdmFyIGVuZCA9IGdmYy5zY2FsZWZhY19iYW5kLnBzZmIxMltzZmIgKyAxXTtcbiAgICAgICAgICAgIEFUSF9wc2ZiMTJbc2ZiXSA9IEZsb2F0Lk1BWF9WQUxVRTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyZXEgPSBpICogc2FtcF9mcmVxIC8gKDIgKiAxOTIpO1xuICAgICAgICAgICAgICAgIHZhciBBVEhfZiA9IEFUSG1kY3QoZ2ZwLCBmcmVxKTtcbiAgICAgICAgICAgICAgICAvKiBmcmVxIGluIGtIeiAqL1xuICAgICAgICAgICAgICAgIEFUSF9wc2ZiMTJbc2ZiXSA9IE1hdGgubWluKEFUSF9wc2ZiMTJbc2ZiXSwgQVRIX2YpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogbm90IHN1cmUgYWJvdXQgdGhlIGZvbGxvd2luZyAqL1xuICAgICAgICAgICAgQVRIX3BzZmIxMltzZmJdICo9IChnZmMuc2NhbGVmYWNfYmFuZC5zWzEzXSAtIGdmYy5zY2FsZWZhY19iYW5kLnNbMTJdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIG5vLUFUSCBtb2RlOiByZWR1Y2UgQVRIIHRvIC0yMDAgZEJcbiAgICAgICAgICovXG4gICAgICAgIGlmIChnZnAubm9BVEgpIHtcbiAgICAgICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IEVuY29kZXIuU0JNQVhfbDsgc2ZiKyspIHtcbiAgICAgICAgICAgICAgICBBVEhfbFtzZmJdID0gMUUtMjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBFbmNvZGVyLlBTRkIyMTsgc2ZiKyspIHtcbiAgICAgICAgICAgICAgICBBVEhfcHNmYjIxW3NmYl0gPSAxRS0yMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IEVuY29kZXIuU0JNQVhfczsgc2ZiKyspIHtcbiAgICAgICAgICAgICAgICBBVEhfc1tzZmJdID0gMUUtMjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBFbmNvZGVyLlBTRkIxMjsgc2ZiKyspIHtcbiAgICAgICAgICAgICAgICBBVEhfcHNmYjEyW3NmYl0gPSAxRS0yMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHdvcmsgaW4gcHJvZ3Jlc3MsIGRvbid0IHJlbHkgb24gaXQgdG9vIG11Y2hcbiAgICAgICAgICovXG4gICAgICAgIGdmYy5BVEguZmxvb3IgPSAxMC4gKiBNYXRoX2xvZzEwKEFUSG1kY3QoZ2ZwLCAtMS4pKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBpbml0aWFsaXphdGlvbiBmb3IgaXRlcmF0aW9uX2xvb3BcbiAgICAgKi9cbiAgICB0aGlzLml0ZXJhdGlvbl9pbml0ID0gZnVuY3Rpb24gKGdmcCkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgbDNfc2lkZSA9IGdmYy5sM19zaWRlO1xuICAgICAgICB2YXIgaTtcblxuICAgICAgICBpZiAoZ2ZjLml0ZXJhdGlvbl9pbml0X2luaXQgPT0gMCkge1xuICAgICAgICAgICAgZ2ZjLml0ZXJhdGlvbl9pbml0X2luaXQgPSAxO1xuXG4gICAgICAgICAgICBsM19zaWRlLm1haW5fZGF0YV9iZWdpbiA9IDA7XG4gICAgICAgICAgICBjb21wdXRlX2F0aChnZnApO1xuXG4gICAgICAgICAgICBwb3c0M1swXSA9IDAuMDtcbiAgICAgICAgICAgIGZvciAoaSA9IDE7IGkgPCBQUkVDQUxDX1NJWkU7IGkrKylcbiAgICAgICAgICAgICAgICBwb3c0M1tpXSA9IE1hdGgucG93KGksIDQuMCAvIDMuMCk7XG5cbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBQUkVDQUxDX1NJWkUgLSAxOyBpKyspXG4gICAgICAgICAgICAgICAgYWRqNDNbaV0gPSAoKGkgKyAxKSAtIE1hdGgucG93KFxuICAgICAgICAgICAgICAgICAgICAwLjUgKiAocG93NDNbaV0gKyBwb3c0M1tpICsgMV0pLCAwLjc1KSk7XG4gICAgICAgICAgICBhZGo0M1tpXSA9IDAuNTtcblxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IFFfTUFYOyBpKyspXG4gICAgICAgICAgICAgICAgaXBvdzIwW2ldID0gTWF0aC5wb3coMi4wLCAoaSAtIDIxMCkgKiAtMC4xODc1KTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPD0gUV9NQVggKyBRX01BWDI7IGkrKylcbiAgICAgICAgICAgICAgICBwb3cyMFtpXSA9IE1hdGgucG93KDIuMCwgKGkgLSAyMTAgLSBRX01BWDIpICogMC4yNSk7XG5cbiAgICAgICAgICAgIHRhay5odWZmbWFuX2luaXQoZ2ZjKTtcblxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhciBiYXNzLCBhbHRvLCB0cmVibGUsIHNmYjIxO1xuXG4gICAgICAgICAgICAgICAgaSA9IChnZnAuZXhwX25zcHN5dHVuZSA+PiAyKSAmIDYzO1xuICAgICAgICAgICAgICAgIGlmIChpID49IDMyKVxuICAgICAgICAgICAgICAgICAgICBpIC09IDY0O1xuICAgICAgICAgICAgICAgIGJhc3MgPSBNYXRoLnBvdygxMCwgaSAvIDQuMCAvIDEwLjApO1xuXG4gICAgICAgICAgICAgICAgaSA9IChnZnAuZXhwX25zcHN5dHVuZSA+PiA4KSAmIDYzO1xuICAgICAgICAgICAgICAgIGlmIChpID49IDMyKVxuICAgICAgICAgICAgICAgICAgICBpIC09IDY0O1xuICAgICAgICAgICAgICAgIGFsdG8gPSBNYXRoLnBvdygxMCwgaSAvIDQuMCAvIDEwLjApO1xuXG4gICAgICAgICAgICAgICAgaSA9IChnZnAuZXhwX25zcHN5dHVuZSA+PiAxNCkgJiA2MztcbiAgICAgICAgICAgICAgICBpZiAoaSA+PSAzMilcbiAgICAgICAgICAgICAgICAgICAgaSAtPSA2NDtcbiAgICAgICAgICAgICAgICB0cmVibGUgPSBNYXRoLnBvdygxMCwgaSAvIDQuMCAvIDEwLjApO1xuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiB0byBiZSBjb21wYXRpYmxlIHdpdGggTmFva2kncyBvcmlnaW5hbCBjb2RlLCB0aGUgbmV4dCA2IGJpdHNcbiAgICAgICAgICAgICAgICAgKiBkZWZpbmUgb25seSB0aGUgYW1vdW50IG9mIGNoYW5naW5nIHRyZWJsZSBmb3Igc2ZiMjFcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpID0gKGdmcC5leHBfbnNwc3l0dW5lID4+IDIwKSAmIDYzO1xuICAgICAgICAgICAgICAgIGlmIChpID49IDMyKVxuICAgICAgICAgICAgICAgICAgICBpIC09IDY0O1xuICAgICAgICAgICAgICAgIHNmYjIxID0gdHJlYmxlICogTWF0aC5wb3coMTAsIGkgLyA0LjAgLyAxMC4wKTtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgRW5jb2Rlci5TQk1BWF9sOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGY7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpIDw9IDYpXG4gICAgICAgICAgICAgICAgICAgICAgICBmID0gYmFzcztcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaSA8PSAxMylcbiAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBhbHRvO1xuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpIDw9IDIwKVxuICAgICAgICAgICAgICAgICAgICAgICAgZiA9IHRyZWJsZTtcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgZiA9IHNmYjIxO1xuXG4gICAgICAgICAgICAgICAgICAgIGdmYy5uc1BzeS5sb25nZmFjdFtpXSA9IGY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBFbmNvZGVyLlNCTUFYX3M7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPD0gNSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBiYXNzO1xuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpIDw9IDEwKVxuICAgICAgICAgICAgICAgICAgICAgICAgZiA9IGFsdG87XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGkgPD0gMTEpXG4gICAgICAgICAgICAgICAgICAgICAgICBmID0gdHJlYmxlO1xuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBmID0gc2ZiMjE7XG5cbiAgICAgICAgICAgICAgICAgICAgZ2ZjLm5zUHN5LnNob3J0ZmFjdFtpXSA9IGY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogYWxsb2NhdGUgYml0cyBhbW9uZyAyIGNoYW5uZWxzIGJhc2VkIG9uIFBFPEJSPlxuICAgICAqIG10IDYvOTk8QlI+XG4gICAgICogYnVnZml4ZXMgcmggOC8wMTogb2Z0ZW4gYWxsb2NhdGVkIG1vcmUgdGhhbiB0aGUgYWxsb3dlZCA0MDk1IGJpdHNcbiAgICAgKi9cbiAgICB0aGlzLm9uX3BlID0gZnVuY3Rpb24gKGdmcCwgcGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICB0YXJnX2JpdHMsIG1lYW5fYml0cywgZ3IsIGNicikge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgdGJpdHMgPSAwLCBiaXRzO1xuICAgICAgICB2YXIgYWRkX2JpdHMgPSBuZXdfaW50KDIpO1xuICAgICAgICB2YXIgY2g7XG5cbiAgICAgICAgLyogYWxsb2NhdGUgdGFyZ19iaXRzIGZvciBncmFudWxlICovXG4gICAgICAgIHZhciBtYiA9IG5ldyBNZWFuQml0cyh0Yml0cyk7XG4gICAgICAgIHZhciBleHRyYV9iaXRzID0gcnYuUmVzdk1heEJpdHMoZ2ZwLCBtZWFuX2JpdHMsIG1iLCBjYnIpO1xuICAgICAgICB0Yml0cyA9IG1iLmJpdHM7XG4gICAgICAgIC8qIG1heGltdW0gYWxsb3dlZCBiaXRzIGZvciB0aGlzIGdyYW51bGUgKi9cbiAgICAgICAgdmFyIG1heF9iaXRzID0gdGJpdHMgKyBleHRyYV9iaXRzO1xuICAgICAgICBpZiAobWF4X2JpdHMgPiBMYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfR1JBTlVMRSkge1xuICAgICAgICAgICAgLy8gaGFyZCBsaW1pdCBwZXIgZ3JhbnVsZVxuICAgICAgICAgICAgbWF4X2JpdHMgPSBMYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfR1JBTlVMRTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGJpdHMgPSAwLCBjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgKytjaCkge1xuICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgICAgICogYWxsb2NhdGUgYml0cyBmb3IgZWFjaCBjaGFubmVsXG4gICAgICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICAgICAgdGFyZ19iaXRzW2NoXSA9IE1hdGgubWluKExhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9DSEFOTkVMLFxuICAgICAgICAgICAgICAgIHRiaXRzIC8gZ2ZjLmNoYW5uZWxzX291dCk7XG5cbiAgICAgICAgICAgIGFkZF9iaXRzW2NoXSA9IDAgfCAodGFyZ19iaXRzW2NoXSAqIHBlW2dyXVtjaF0gLyA3MDAuMCAtIHRhcmdfYml0c1tjaF0pO1xuXG4gICAgICAgICAgICAvKiBhdCBtb3N0IGluY3JlYXNlIGJpdHMgYnkgMS41KmF2ZXJhZ2UgKi9cbiAgICAgICAgICAgIGlmIChhZGRfYml0c1tjaF0gPiBtZWFuX2JpdHMgKiAzIC8gNClcbiAgICAgICAgICAgICAgICBhZGRfYml0c1tjaF0gPSBtZWFuX2JpdHMgKiAzIC8gNDtcblxuICAgICAgICAgICAgaWYgKGFkZF9iaXRzW2NoXSA8IDApXG4gICAgICAgICAgICAgICAgYWRkX2JpdHNbY2hdID0gMDtcblxuICAgICAgICAgICAgaWYgKGFkZF9iaXRzW2NoXSArIHRhcmdfYml0c1tjaF0gPiBMYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfQ0hBTk5FTClcbiAgICAgICAgICAgICAgICBhZGRfYml0c1tjaF0gPSBNYXRoLm1heCgwLFxuICAgICAgICAgICAgICAgICAgICBMYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfQ0hBTk5FTCAtIHRhcmdfYml0c1tjaF0pO1xuXG4gICAgICAgICAgICBiaXRzICs9IGFkZF9iaXRzW2NoXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYml0cyA+IGV4dHJhX2JpdHMpIHtcbiAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7ICsrY2gpIHtcbiAgICAgICAgICAgICAgICBhZGRfYml0c1tjaF0gPSBleHRyYV9iaXRzICogYWRkX2JpdHNbY2hdIC8gYml0cztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7ICsrY2gpIHtcbiAgICAgICAgICAgIHRhcmdfYml0c1tjaF0gKz0gYWRkX2JpdHNbY2hdO1xuICAgICAgICAgICAgZXh0cmFfYml0cyAtPSBhZGRfYml0c1tjaF07XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGJpdHMgPSAwLCBjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgKytjaCkge1xuICAgICAgICAgICAgYml0cyArPSB0YXJnX2JpdHNbY2hdO1xuICAgICAgICB9XG4gICAgICAgIGlmIChiaXRzID4gTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0dSQU5VTEUpIHtcbiAgICAgICAgICAgIHZhciBzdW0gPSAwO1xuICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgKytjaCkge1xuICAgICAgICAgICAgICAgIHRhcmdfYml0c1tjaF0gKj0gTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0dSQU5VTEU7XG4gICAgICAgICAgICAgICAgdGFyZ19iaXRzW2NoXSAvPSBiaXRzO1xuICAgICAgICAgICAgICAgIHN1bSArPSB0YXJnX2JpdHNbY2hdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG1heF9iaXRzO1xuICAgIH1cblxuICAgIHRoaXMucmVkdWNlX3NpZGUgPSBmdW5jdGlvbiAodGFyZ19iaXRzLCBtc19lbmVyX3JhdGlvLCBtZWFuX2JpdHMsIG1heF9iaXRzKSB7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogbXNfZW5lcl9yYXRpbyA9IDA6IGFsbG9jYXRlIDY2LzMzIG1pZC9zaWRlIGZhYz0uMzMgbXNfZW5lcl9yYXRpbyA9LjU6XG4gICAgICAgICAqIGFsbG9jYXRlIDUwLzUwIG1pZC9zaWRlIGZhYz0gMFxuICAgICAgICAgKi9cbiAgICAgICAgLyogNzUvMjUgc3BsaXQgaXMgZmFjPS41ICovXG4gICAgICAgIHZhciBmYWMgPSAuMzMgKiAoLjUgLSBtc19lbmVyX3JhdGlvKSAvIC41O1xuICAgICAgICBpZiAoZmFjIDwgMClcbiAgICAgICAgICAgIGZhYyA9IDA7XG4gICAgICAgIGlmIChmYWMgPiAuNSlcbiAgICAgICAgICAgIGZhYyA9IC41O1xuXG4gICAgICAgIC8qIG51bWJlciBvZiBiaXRzIHRvIG1vdmUgZnJvbSBzaWRlIGNoYW5uZWwgdG8gbWlkIGNoYW5uZWwgKi9cbiAgICAgICAgLyogbW92ZV9iaXRzID0gZmFjKnRhcmdfYml0c1sxXTsgKi9cbiAgICAgICAgdmFyIG1vdmVfYml0cyA9IDAgfCAoZmFjICogLjUgKiAodGFyZ19iaXRzWzBdICsgdGFyZ19iaXRzWzFdKSk7XG5cbiAgICAgICAgaWYgKG1vdmVfYml0cyA+IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9DSEFOTkVMIC0gdGFyZ19iaXRzWzBdKSB7XG4gICAgICAgICAgICBtb3ZlX2JpdHMgPSBMYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfQ0hBTk5FTCAtIHRhcmdfYml0c1swXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobW92ZV9iaXRzIDwgMClcbiAgICAgICAgICAgIG1vdmVfYml0cyA9IDA7XG5cbiAgICAgICAgaWYgKHRhcmdfYml0c1sxXSA+PSAxMjUpIHtcbiAgICAgICAgICAgIC8qIGRvbnQgcmVkdWNlIHNpZGUgY2hhbm5lbCBiZWxvdyAxMjUgYml0cyAqL1xuICAgICAgICAgICAgaWYgKHRhcmdfYml0c1sxXSAtIG1vdmVfYml0cyA+IDEyNSkge1xuXG4gICAgICAgICAgICAgICAgLyogaWYgbWlkIGNoYW5uZWwgYWxyZWFkeSBoYXMgMnggbW9yZSB0aGFuIGF2ZXJhZ2UsIGRvbnQgYm90aGVyICovXG4gICAgICAgICAgICAgICAgLyogbWVhbl9iaXRzID0gYml0cyBwZXIgZ3JhbnVsZSAoZm9yIGJvdGggY2hhbm5lbHMpICovXG4gICAgICAgICAgICAgICAgaWYgKHRhcmdfYml0c1swXSA8IG1lYW5fYml0cylcbiAgICAgICAgICAgICAgICAgICAgdGFyZ19iaXRzWzBdICs9IG1vdmVfYml0cztcbiAgICAgICAgICAgICAgICB0YXJnX2JpdHNbMV0gLT0gbW92ZV9iaXRzO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0YXJnX2JpdHNbMF0gKz0gdGFyZ19iaXRzWzFdIC0gMTI1O1xuICAgICAgICAgICAgICAgIHRhcmdfYml0c1sxXSA9IDEyNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIG1vdmVfYml0cyA9IHRhcmdfYml0c1swXSArIHRhcmdfYml0c1sxXTtcbiAgICAgICAgaWYgKG1vdmVfYml0cyA+IG1heF9iaXRzKSB7XG4gICAgICAgICAgICB0YXJnX2JpdHNbMF0gPSAobWF4X2JpdHMgKiB0YXJnX2JpdHNbMF0pIC8gbW92ZV9iaXRzO1xuICAgICAgICAgICAgdGFyZ19iaXRzWzFdID0gKG1heF9iaXRzICogdGFyZ19iaXRzWzFdKSAvIG1vdmVfYml0cztcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiAgUm9iZXJ0IEhlZ2VtYW5uIDIwMDEtMDQtMjc6XG4gICAgICogIHRoaXMgYWRqdXN0cyB0aGUgQVRILCBrZWVwaW5nIHRoZSBvcmlnaW5hbCBub2lzZSBmbG9vclxuICAgICAqICBhZmZlY3RzIHRoZSBoaWdoZXIgZnJlcXVlbmNpZXMgbW9yZSB0aGFuIHRoZSBsb3dlciBvbmVzXG4gICAgICovXG4gICAgdGhpcy5hdGhBZGp1c3QgPSBmdW5jdGlvbiAoYSwgeCwgYXRoRmxvb3IpIHtcbiAgICAgICAgLypcbiAgICAgICAgICogd29yayBpbiBwcm9ncmVzc1xuICAgICAgICAgKi9cbiAgICAgICAgdmFyIG8gPSA5MC4zMDg3MzM2MjtcbiAgICAgICAgdmFyIHAgPSA5NC44MjQ0NDg2MztcbiAgICAgICAgdmFyIHUgPSBVdGlsLkZBU1RfTE9HMTBfWCh4LCAxMC4wKTtcbiAgICAgICAgdmFyIHYgPSBhICogYTtcbiAgICAgICAgdmFyIHcgPSAwLjA7XG4gICAgICAgIHUgLT0gYXRoRmxvb3I7XG4gICAgICAgIC8qIHVuZG8gc2NhbGluZyAqL1xuICAgICAgICBpZiAodiA+IDFFLTIwKVxuICAgICAgICAgICAgdyA9IDEuICsgVXRpbC5GQVNUX0xPRzEwX1godiwgMTAuMCAvIG8pO1xuICAgICAgICBpZiAodyA8IDApXG4gICAgICAgICAgICB3ID0gMC47XG4gICAgICAgIHUgKj0gdztcbiAgICAgICAgdSArPSBhdGhGbG9vciArIG8gLSBwO1xuICAgICAgICAvKiByZWRvIHNjYWxpbmcgKi9cblxuICAgICAgICByZXR1cm4gTWF0aC5wb3coMTAuLCAwLjEgKiB1KTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogQ2FsY3VsYXRlIHRoZSBhbGxvd2VkIGRpc3RvcnRpb24gZm9yIGVhY2ggc2NhbGVmYWN0b3IgYmFuZCwgYXMgZGV0ZXJtaW5lZFxuICAgICAqIGJ5IHRoZSBwc3ljaG9hY291c3RpYyBtb2RlbC4geG1pbihzYikgPSByYXRpbyhzYikgKiBlbihzYikgLyBidyhzYilcbiAgICAgKlxuICAgICAqIHJldHVybnMgbnVtYmVyIG9mIHNmYidzIHdpdGggZW5lcmd5ID4gQVRIXG4gICAgICovXG4gICAgdGhpcy5jYWxjX3htaW4gPSBmdW5jdGlvbiAoZ2ZwLCByYXRpbywgY29kX2luZm8sIHB4bWluKSB7XG4gICAgICAgIHZhciBweG1pblBvcyA9IDA7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBnc2ZiLCBqID0gMCwgYXRoX292ZXIgPSAwO1xuICAgICAgICB2YXIgQVRIID0gZ2ZjLkFUSDtcbiAgICAgICAgdmFyIHhyID0gY29kX2luZm8ueHI7XG4gICAgICAgIHZhciBlbmFibGVfYXRoYWFfZml4ID0gKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfbXRyaCkgPyAxIDogMDtcbiAgICAgICAgdmFyIG1hc2tpbmdfbG93ZXIgPSBnZmMubWFza2luZ19sb3dlcjtcblxuICAgICAgICBpZiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9tdHJoIHx8IGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfbXQpIHtcbiAgICAgICAgICAgIC8qIHdhcyBhbHJlYWR5IGRvbmUgaW4gUFNZLU1vZGVsICovXG4gICAgICAgICAgICBtYXNraW5nX2xvd2VyID0gMS4wO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChnc2ZiID0gMDsgZ3NmYiA8IGNvZF9pbmZvLnBzeV9sbWF4OyBnc2ZiKyspIHtcbiAgICAgICAgICAgIHZhciBlbjAsIHhtaW47XG4gICAgICAgICAgICB2YXIgcmgxLCByaDI7XG4gICAgICAgICAgICB2YXIgd2lkdGgsIGw7XG5cbiAgICAgICAgICAgIGlmIChnZnAuVkJSID09IFZick1vZGUudmJyX3JoIHx8IGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfbXRyaClcbiAgICAgICAgICAgICAgICB4bWluID0gYXRoQWRqdXN0KEFUSC5hZGp1c3QsIEFUSC5sW2dzZmJdLCBBVEguZmxvb3IpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHhtaW4gPSBBVEguYWRqdXN0ICogQVRILmxbZ3NmYl07XG5cbiAgICAgICAgICAgIHdpZHRoID0gY29kX2luZm8ud2lkdGhbZ3NmYl07XG4gICAgICAgICAgICByaDEgPSB4bWluIC8gd2lkdGg7XG4gICAgICAgICAgICByaDIgPSBEQkxfRVBTSUxPTjtcbiAgICAgICAgICAgIGwgPSB3aWR0aCA+PiAxO1xuICAgICAgICAgICAgZW4wID0gMC4wO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIHZhciB4YSwgeGI7XG4gICAgICAgICAgICAgICAgeGEgPSB4cltqXSAqIHhyW2pdO1xuICAgICAgICAgICAgICAgIGVuMCArPSB4YTtcbiAgICAgICAgICAgICAgICByaDIgKz0gKHhhIDwgcmgxKSA/IHhhIDogcmgxO1xuICAgICAgICAgICAgICAgIGorKztcbiAgICAgICAgICAgICAgICB4YiA9IHhyW2pdICogeHJbal07XG4gICAgICAgICAgICAgICAgZW4wICs9IHhiO1xuICAgICAgICAgICAgICAgIHJoMiArPSAoeGIgPCByaDEpID8geGIgOiByaDE7XG4gICAgICAgICAgICAgICAgaisrO1xuICAgICAgICAgICAgfSB3aGlsZSAoLS1sID4gMCk7XG4gICAgICAgICAgICBpZiAoZW4wID4geG1pbilcbiAgICAgICAgICAgICAgICBhdGhfb3ZlcisrO1xuXG4gICAgICAgICAgICBpZiAoZ3NmYiA9PSBFbmNvZGVyLlNCUFNZX2wpIHtcbiAgICAgICAgICAgICAgICB2YXIgeCA9IHhtaW4gKiBnZmMubnNQc3kubG9uZ2ZhY3RbZ3NmYl07XG4gICAgICAgICAgICAgICAgaWYgKHJoMiA8IHgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmgyID0geDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZW5hYmxlX2F0aGFhX2ZpeCAhPSAwKSB7XG4gICAgICAgICAgICAgICAgeG1pbiA9IHJoMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZ2ZwLkFUSG9ubHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZSA9IHJhdGlvLmVuLmxbZ3NmYl07XG4gICAgICAgICAgICAgICAgaWYgKGUgPiAwLjApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHg7XG4gICAgICAgICAgICAgICAgICAgIHggPSBlbjAgKiByYXRpby50aG0ubFtnc2ZiXSAqIG1hc2tpbmdfbG93ZXIgLyBlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZW5hYmxlX2F0aGFhX2ZpeCAhPSAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgeCAqPSBnZmMubnNQc3kubG9uZ2ZhY3RbZ3NmYl07XG4gICAgICAgICAgICAgICAgICAgIGlmICh4bWluIDwgeClcbiAgICAgICAgICAgICAgICAgICAgICAgIHhtaW4gPSB4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlbmFibGVfYXRoYWFfZml4ICE9IDApXG4gICAgICAgICAgICAgICAgcHhtaW5bcHhtaW5Qb3MrK10gPSB4bWluO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHB4bWluW3B4bWluUG9zKytdID0geG1pbiAqIGdmYy5uc1BzeS5sb25nZmFjdFtnc2ZiXTtcbiAgICAgICAgfVxuICAgICAgICAvKiBlbmQgb2YgbG9uZyBibG9jayBsb29wICovXG5cbiAgICAgICAgLyogdXNlIHRoaXMgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIHRoZSBoaWdoZXN0IG5vbi16ZXJvIGNvZWZmICovXG4gICAgICAgIHZhciBtYXhfbm9uemVybyA9IDU3NTtcbiAgICAgICAgaWYgKGNvZF9pbmZvLmJsb2NrX3R5cGUgIT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICAvLyBOT1JNLCBTVEFSVCBvciBTVE9QIHR5cGUsIGJ1dCBub3QgU0hPUlRcbiAgICAgICAgICAgIHZhciBrID0gNTc2O1xuICAgICAgICAgICAgd2hpbGUgKGstLSAhPSAwICYmIEJpdFN0cmVhbS5FUSh4cltrXSwgMCkpIHtcbiAgICAgICAgICAgICAgICBtYXhfbm9uemVybyA9IGs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29kX2luZm8ubWF4X25vbnplcm9fY29lZmYgPSBtYXhfbm9uemVybztcblxuICAgICAgICBmb3IgKHZhciBzZmIgPSBjb2RfaW5mby5zZmJfc21pbjsgZ3NmYiA8IGNvZF9pbmZvLnBzeW1heDsgc2ZiKyssIGdzZmIgKz0gMykge1xuICAgICAgICAgICAgdmFyIHdpZHRoLCBiO1xuICAgICAgICAgICAgdmFyIHRtcEFUSDtcbiAgICAgICAgICAgIGlmIChnZnAuVkJSID09IFZick1vZGUudmJyX3JoIHx8IGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfbXRyaClcbiAgICAgICAgICAgICAgICB0bXBBVEggPSBhdGhBZGp1c3QoQVRILmFkanVzdCwgQVRILnNbc2ZiXSwgQVRILmZsb29yKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB0bXBBVEggPSBBVEguYWRqdXN0ICogQVRILnNbc2ZiXTtcblxuICAgICAgICAgICAgd2lkdGggPSBjb2RfaW5mby53aWR0aFtnc2ZiXTtcbiAgICAgICAgICAgIGZvciAoYiA9IDA7IGIgPCAzOyBiKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZW4wID0gMC4wLCB4bWluO1xuICAgICAgICAgICAgICAgIHZhciByaDEsIHJoMjtcbiAgICAgICAgICAgICAgICB2YXIgbCA9IHdpZHRoID4+IDE7XG5cbiAgICAgICAgICAgICAgICByaDEgPSB0bXBBVEggLyB3aWR0aDtcbiAgICAgICAgICAgICAgICByaDIgPSBEQkxfRVBTSUxPTjtcbiAgICAgICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB4YSwgeGI7XG4gICAgICAgICAgICAgICAgICAgIHhhID0geHJbal0gKiB4cltqXTtcbiAgICAgICAgICAgICAgICAgICAgZW4wICs9IHhhO1xuICAgICAgICAgICAgICAgICAgICByaDIgKz0gKHhhIDwgcmgxKSA/IHhhIDogcmgxO1xuICAgICAgICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICAgICAgICAgIHhiID0geHJbal0gKiB4cltqXTtcbiAgICAgICAgICAgICAgICAgICAgZW4wICs9IHhiO1xuICAgICAgICAgICAgICAgICAgICByaDIgKz0gKHhiIDwgcmgxKSA/IHhiIDogcmgxO1xuICAgICAgICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICAgICAgfSB3aGlsZSAoLS1sID4gMCk7XG4gICAgICAgICAgICAgICAgaWYgKGVuMCA+IHRtcEFUSClcbiAgICAgICAgICAgICAgICAgICAgYXRoX292ZXIrKztcbiAgICAgICAgICAgICAgICBpZiAoc2ZiID09IEVuY29kZXIuU0JQU1lfcykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IHRtcEFUSCAqIGdmYy5uc1BzeS5zaG9ydGZhY3Rbc2ZiXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJoMiA8IHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJoMiA9IHg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGVuYWJsZV9hdGhhYV9maXggIT0gMClcbiAgICAgICAgICAgICAgICAgICAgeG1pbiA9IHJoMjtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHhtaW4gPSB0bXBBVEg7XG5cbiAgICAgICAgICAgICAgICBpZiAoIWdmcC5BVEhvbmx5ICYmICFnZnAuQVRIc2hvcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGUgPSByYXRpby5lbi5zW3NmYl1bYl07XG4gICAgICAgICAgICAgICAgICAgIGlmIChlID4gMC4wKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgeDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHggPSBlbjAgKiByYXRpby50aG0uc1tzZmJdW2JdICogbWFza2luZ19sb3dlciAvIGU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW5hYmxlX2F0aGFhX2ZpeCAhPSAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHggKj0gZ2ZjLm5zUHN5LnNob3J0ZmFjdFtzZmJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHhtaW4gPCB4KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhtaW4gPSB4O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChlbmFibGVfYXRoYWFfZml4ICE9IDApXG4gICAgICAgICAgICAgICAgICAgIHB4bWluW3B4bWluUG9zKytdID0geG1pbjtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHB4bWluW3B4bWluUG9zKytdID0geG1pbiAqIGdmYy5uc1BzeS5zaG9ydGZhY3Rbc2ZiXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIGIgKi9cbiAgICAgICAgICAgIGlmIChnZnAudXNlVGVtcG9yYWwpIHtcbiAgICAgICAgICAgICAgICBpZiAocHhtaW5bcHhtaW5Qb3MgLSAzXSA+IHB4bWluW3B4bWluUG9zIC0gMyArIDFdKVxuICAgICAgICAgICAgICAgICAgICBweG1pbltweG1pblBvcyAtIDMgKyAxXSArPSAocHhtaW5bcHhtaW5Qb3MgLSAzXSAtIHB4bWluW3B4bWluUG9zIC0gMyArIDFdKVxuICAgICAgICAgICAgICAgICAgICAgICAgKiBnZmMuZGVjYXk7XG4gICAgICAgICAgICAgICAgaWYgKHB4bWluW3B4bWluUG9zIC0gMyArIDFdID4gcHhtaW5bcHhtaW5Qb3MgLSAzICsgMl0pXG4gICAgICAgICAgICAgICAgICAgIHB4bWluW3B4bWluUG9zIC0gMyArIDJdICs9IChweG1pbltweG1pblBvcyAtIDMgKyAxXSAtIHB4bWluW3B4bWluUG9zIC0gMyArIDJdKVxuICAgICAgICAgICAgICAgICAgICAgICAgKiBnZmMuZGVjYXk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyogZW5kIG9mIHNob3J0IGJsb2NrIHNmYiBsb29wICovXG5cbiAgICAgICAgcmV0dXJuIGF0aF9vdmVyO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBTdGFydExpbmUoaikge1xuICAgICAgICB0aGlzLnMgPSBqO1xuICAgIH1cblxuICAgIHRoaXMuY2FsY19ub2lzZV9jb3JlID0gZnVuY3Rpb24gKGNvZF9pbmZvLCBzdGFydGxpbmUsIGwsIHN0ZXApIHtcbiAgICAgICAgdmFyIG5vaXNlID0gMDtcbiAgICAgICAgdmFyIGogPSBzdGFydGxpbmUucztcbiAgICAgICAgdmFyIGl4ID0gY29kX2luZm8ubDNfZW5jO1xuXG4gICAgICAgIGlmIChqID4gY29kX2luZm8uY291bnQxKSB7XG4gICAgICAgICAgICB3aGlsZSAoKGwtLSkgIT0gMCkge1xuICAgICAgICAgICAgICAgIHZhciB0ZW1wO1xuICAgICAgICAgICAgICAgIHRlbXAgPSBjb2RfaW5mby54cltqXTtcbiAgICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICAgICAgbm9pc2UgKz0gdGVtcCAqIHRlbXA7XG4gICAgICAgICAgICAgICAgdGVtcCA9IGNvZF9pbmZvLnhyW2pdO1xuICAgICAgICAgICAgICAgIGorKztcbiAgICAgICAgICAgICAgICBub2lzZSArPSB0ZW1wICogdGVtcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChqID4gY29kX2luZm8uYmlnX3ZhbHVlcykge1xuICAgICAgICAgICAgdmFyIGl4MDEgPSBuZXdfZmxvYXQoMik7XG4gICAgICAgICAgICBpeDAxWzBdID0gMDtcbiAgICAgICAgICAgIGl4MDFbMV0gPSBzdGVwO1xuICAgICAgICAgICAgd2hpbGUgKChsLS0pICE9IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgdGVtcDtcbiAgICAgICAgICAgICAgICB0ZW1wID0gTWF0aC5hYnMoY29kX2luZm8ueHJbal0pIC0gaXgwMVtpeFtqXV07XG4gICAgICAgICAgICAgICAgaisrO1xuICAgICAgICAgICAgICAgIG5vaXNlICs9IHRlbXAgKiB0ZW1wO1xuICAgICAgICAgICAgICAgIHRlbXAgPSBNYXRoLmFicyhjb2RfaW5mby54cltqXSkgLSBpeDAxW2l4W2pdXTtcbiAgICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICAgICAgbm9pc2UgKz0gdGVtcCAqIHRlbXA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB3aGlsZSAoKGwtLSkgIT0gMCkge1xuICAgICAgICAgICAgICAgIHZhciB0ZW1wO1xuICAgICAgICAgICAgICAgIHRlbXAgPSBNYXRoLmFicyhjb2RfaW5mby54cltqXSkgLSBwb3c0M1tpeFtqXV0gKiBzdGVwO1xuICAgICAgICAgICAgICAgIGorKztcbiAgICAgICAgICAgICAgICBub2lzZSArPSB0ZW1wICogdGVtcDtcbiAgICAgICAgICAgICAgICB0ZW1wID0gTWF0aC5hYnMoY29kX2luZm8ueHJbal0pIC0gcG93NDNbaXhbal1dICogc3RlcDtcbiAgICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICAgICAgbm9pc2UgKz0gdGVtcCAqIHRlbXA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBzdGFydGxpbmUucyA9IGo7XG4gICAgICAgIHJldHVybiBub2lzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiA8UFJFPlxuICAgICAqIC1vbyBkQiAgPT4gIC0xLjAwXG4gICAgICogLSA2IGRCICA9PiAgLTAuOTdcbiAgICAgKiAtIDMgZEIgID0+ICAtMC44MFxuICAgICAqIC0gMiBkQiAgPT4gIC0wLjY0XG4gICAgICogLSAxIGRCICA9PiAgLTAuMzhcbiAgICAgKiAgIDAgZEIgID0+ICAgMC4wMFxuICAgICAqICsgMSBkQiAgPT4gICswLjQ5XG4gICAgICogKyAyIGRCICA9PiAgKzEuMDZcbiAgICAgKiArIDMgZEIgID0+ICArMS42OFxuICAgICAqICsgNiBkQiAgPT4gICszLjY5XG4gICAgICogKzEwIGRCICA9PiAgKzYuNDVcbiAgICAgKiA8L1BSRT5cbiAgICAgKi9cbiAgICB0aGlzLmNhbGNfbm9pc2UgPSBmdW5jdGlvbiAoY29kX2luZm8sIGwzX3htaW4sIGRpc3RvcnQsIHJlcywgcHJldl9ub2lzZSkge1xuICAgICAgICB2YXIgZGlzdG9ydFBvcyA9IDA7XG4gICAgICAgIHZhciBsM194bWluUG9zID0gMDtcbiAgICAgICAgdmFyIHNmYiwgbCwgb3ZlciA9IDA7XG4gICAgICAgIHZhciBvdmVyX25vaXNlX2RiID0gMDtcbiAgICAgICAgLyogMCBkQiByZWxhdGl2ZSB0byBtYXNraW5nICovXG4gICAgICAgIHZhciB0b3Rfbm9pc2VfZGIgPSAwO1xuICAgICAgICAvKiAtMjAwIGRCIHJlbGF0aXZlIHRvIG1hc2tpbmcgKi9cbiAgICAgICAgdmFyIG1heF9ub2lzZSA9IC0yMC4wO1xuICAgICAgICB2YXIgaiA9IDA7XG4gICAgICAgIHZhciBzY2FsZWZhYyA9IGNvZF9pbmZvLnNjYWxlZmFjO1xuICAgICAgICB2YXIgc2NhbGVmYWNQb3MgPSAwO1xuXG4gICAgICAgIHJlcy5vdmVyX1NTRCA9IDA7XG5cbiAgICAgICAgZm9yIChzZmIgPSAwOyBzZmIgPCBjb2RfaW5mby5wc3ltYXg7IHNmYisrKSB7XG4gICAgICAgICAgICB2YXIgcyA9IGNvZF9pbmZvLmdsb2JhbF9nYWluXG4gICAgICAgICAgICAgICAgLSAoKChzY2FsZWZhY1tzY2FsZWZhY1BvcysrXSkgKyAoY29kX2luZm8ucHJlZmxhZyAhPSAwID8gcHJldGFiW3NmYl1cbiAgICAgICAgICAgICAgICAgICAgOiAwKSkgPDwgKGNvZF9pbmZvLnNjYWxlZmFjX3NjYWxlICsgMSkpXG4gICAgICAgICAgICAgICAgLSBjb2RfaW5mby5zdWJibG9ja19nYWluW2NvZF9pbmZvLndpbmRvd1tzZmJdXSAqIDg7XG4gICAgICAgICAgICB2YXIgbm9pc2UgPSAwLjA7XG5cbiAgICAgICAgICAgIGlmIChwcmV2X25vaXNlICE9IG51bGwgJiYgKHByZXZfbm9pc2Uuc3RlcFtzZmJdID09IHMpKSB7XG5cbiAgICAgICAgICAgICAgICAvKiB1c2UgcHJldmlvdXNseSBjb21wdXRlZCB2YWx1ZXMgKi9cbiAgICAgICAgICAgICAgICBub2lzZSA9IHByZXZfbm9pc2Uubm9pc2Vbc2ZiXTtcbiAgICAgICAgICAgICAgICBqICs9IGNvZF9pbmZvLndpZHRoW3NmYl07XG4gICAgICAgICAgICAgICAgZGlzdG9ydFtkaXN0b3J0UG9zKytdID0gbm9pc2UgLyBsM194bWluW2wzX3htaW5Qb3MrK107XG5cbiAgICAgICAgICAgICAgICBub2lzZSA9IHByZXZfbm9pc2Uubm9pc2VfbG9nW3NmYl07XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0ZXAgPSBQT1cyMChzKTtcbiAgICAgICAgICAgICAgICBsID0gY29kX2luZm8ud2lkdGhbc2ZiXSA+PiAxO1xuXG4gICAgICAgICAgICAgICAgaWYgKChqICsgY29kX2luZm8ud2lkdGhbc2ZiXSkgPiBjb2RfaW5mby5tYXhfbm9uemVyb19jb2VmZikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXNlZnVsbHNpemU7XG4gICAgICAgICAgICAgICAgICAgIHVzZWZ1bGxzaXplID0gY29kX2luZm8ubWF4X25vbnplcm9fY29lZmYgLSBqICsgMTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodXNlZnVsbHNpemUgPiAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgbCA9IHVzZWZ1bGxzaXplID4+IDE7XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGwgPSAwO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBzbCA9IG5ldyBTdGFydExpbmUoaik7XG4gICAgICAgICAgICAgICAgbm9pc2UgPSB0aGlzLmNhbGNfbm9pc2VfY29yZShjb2RfaW5mbywgc2wsIGwsIHN0ZXApO1xuICAgICAgICAgICAgICAgIGogPSBzbC5zO1xuXG4gICAgICAgICAgICAgICAgaWYgKHByZXZfbm9pc2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAvKiBzYXZlIG5vaXNlIHZhbHVlcyAqL1xuICAgICAgICAgICAgICAgICAgICBwcmV2X25vaXNlLnN0ZXBbc2ZiXSA9IHM7XG4gICAgICAgICAgICAgICAgICAgIHByZXZfbm9pc2Uubm9pc2Vbc2ZiXSA9IG5vaXNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG5vaXNlID0gZGlzdG9ydFtkaXN0b3J0UG9zKytdID0gbm9pc2UgLyBsM194bWluW2wzX3htaW5Qb3MrK107XG5cbiAgICAgICAgICAgICAgICAvKiBtdWx0aXBseWluZyBoZXJlIGlzIGFkZGluZyBpbiBkQiwgYnV0IGNhbiBvdmVyZmxvdyAqL1xuICAgICAgICAgICAgICAgIG5vaXNlID0gVXRpbC5GQVNUX0xPRzEwKE1hdGgubWF4KG5vaXNlLCAxRS0yMCkpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHByZXZfbm9pc2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAvKiBzYXZlIG5vaXNlIHZhbHVlcyAqL1xuICAgICAgICAgICAgICAgICAgICBwcmV2X25vaXNlLm5vaXNlX2xvZ1tzZmJdID0gbm9pc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAocHJldl9ub2lzZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgLyogc2F2ZSBub2lzZSB2YWx1ZXMgKi9cbiAgICAgICAgICAgICAgICBwcmV2X25vaXNlLmdsb2JhbF9nYWluID0gY29kX2luZm8uZ2xvYmFsX2dhaW47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRvdF9ub2lzZV9kYiArPSBub2lzZTtcblxuICAgICAgICAgICAgaWYgKG5vaXNlID4gMC4wKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRtcDtcblxuICAgICAgICAgICAgICAgIHRtcCA9IE1hdGgubWF4KDAgfCAobm9pc2UgKiAxMCArIC41KSwgMSk7XG4gICAgICAgICAgICAgICAgcmVzLm92ZXJfU1NEICs9IHRtcCAqIHRtcDtcblxuICAgICAgICAgICAgICAgIG92ZXIrKztcbiAgICAgICAgICAgICAgICAvKiBtdWx0aXBseWluZyBoZXJlIGlzIGFkZGluZyBpbiBkQiAtYnV0IGNhbiBvdmVyZmxvdyAqL1xuICAgICAgICAgICAgICAgIC8qIG92ZXJfbm9pc2UgKj0gbm9pc2U7ICovXG4gICAgICAgICAgICAgICAgb3Zlcl9ub2lzZV9kYiArPSBub2lzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1heF9ub2lzZSA9IE1hdGgubWF4KG1heF9ub2lzZSwgbm9pc2UpO1xuXG4gICAgICAgIH1cblxuICAgICAgICByZXMub3Zlcl9jb3VudCA9IG92ZXI7XG4gICAgICAgIHJlcy50b3Rfbm9pc2UgPSB0b3Rfbm9pc2VfZGI7XG4gICAgICAgIHJlcy5vdmVyX25vaXNlID0gb3Zlcl9ub2lzZV9kYjtcbiAgICAgICAgcmVzLm1heF9ub2lzZSA9IG1heF9ub2lzZTtcblxuICAgICAgICByZXR1cm4gb3ZlcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiB1cGRhdGVzIHBsb3R0aW5nIGRhdGFcbiAgICAgKlxuICAgICAqIE1hcmsgVGF5bG9yIDIwMDAtPz8tPz9cbiAgICAgKlxuICAgICAqIFJvYmVydCBIZWdlbWFubjogbW92ZWQgbm9pc2UvZGlzdG9ydGlvbiBjYWxjIGludG8gaXRcbiAgICAgKi9cbiAgICB0aGlzLnNldF9waW5mbyA9IGZ1bmN0aW9uIChnZnAsIGNvZF9pbmZvLCByYXRpbywgZ3IsIGNoKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBzZmIsIHNmYjI7XG4gICAgICAgIHZhciBsO1xuICAgICAgICB2YXIgZW4wLCBlbjE7XG4gICAgICAgIHZhciBpZnFzdGVwID0gKGNvZF9pbmZvLnNjYWxlZmFjX3NjYWxlID09IDApID8gLjUgOiAxLjA7XG4gICAgICAgIHZhciBzY2FsZWZhYyA9IGNvZF9pbmZvLnNjYWxlZmFjO1xuXG4gICAgICAgIHZhciBsM194bWluID0gbmV3X2Zsb2F0KEwzU2lkZS5TRkJNQVgpO1xuICAgICAgICB2YXIgeGZzZiA9IG5ld19mbG9hdChMM1NpZGUuU0ZCTUFYKTtcbiAgICAgICAgdmFyIG5vaXNlID0gbmV3IENhbGNOb2lzZVJlc3VsdCgpO1xuXG4gICAgICAgIGNhbGNfeG1pbihnZnAsIHJhdGlvLCBjb2RfaW5mbywgbDNfeG1pbik7XG4gICAgICAgIGNhbGNfbm9pc2UoY29kX2luZm8sIGwzX3htaW4sIHhmc2YsIG5vaXNlLCBudWxsKTtcblxuICAgICAgICB2YXIgaiA9IDA7XG4gICAgICAgIHNmYjIgPSBjb2RfaW5mby5zZmJfbG1heDtcbiAgICAgICAgaWYgKGNvZF9pbmZvLmJsb2NrX3R5cGUgIT0gRW5jb2Rlci5TSE9SVF9UWVBFXG4gICAgICAgICAgICAmJiAwID09IGNvZF9pbmZvLm1peGVkX2Jsb2NrX2ZsYWcpXG4gICAgICAgICAgICBzZmIyID0gMjI7XG4gICAgICAgIGZvciAoc2ZiID0gMDsgc2ZiIDwgc2ZiMjsgc2ZiKyspIHtcbiAgICAgICAgICAgIHZhciBzdGFydCA9IGdmYy5zY2FsZWZhY19iYW5kLmxbc2ZiXTtcbiAgICAgICAgICAgIHZhciBlbmQgPSBnZmMuc2NhbGVmYWNfYmFuZC5sW3NmYiArIDFdO1xuICAgICAgICAgICAgdmFyIGJ3ID0gZW5kIC0gc3RhcnQ7XG4gICAgICAgICAgICBmb3IgKGVuMCA9IDAuMDsgaiA8IGVuZDsgaisrKVxuICAgICAgICAgICAgICAgIGVuMCArPSBjb2RfaW5mby54cltqXSAqIGNvZF9pbmZvLnhyW2pdO1xuICAgICAgICAgICAgZW4wIC89IGJ3O1xuICAgICAgICAgICAgLyogY29udmVydCB0byBNRENUIHVuaXRzICovXG4gICAgICAgICAgICAvKiBzY2FsaW5nIHNvIGl0IHNob3dzIHVwIG9uIEZGVCBwbG90ICovXG4gICAgICAgICAgICBlbjEgPSAxZTE1O1xuICAgICAgICAgICAgZ2ZjLnBpbmZvLmVuW2dyXVtjaF1bc2ZiXSA9IGVuMSAqIGVuMDtcbiAgICAgICAgICAgIGdmYy5waW5mby54ZnNmW2dyXVtjaF1bc2ZiXSA9IGVuMSAqIGwzX3htaW5bc2ZiXSAqIHhmc2Zbc2ZiXSAvIGJ3O1xuXG4gICAgICAgICAgICBpZiAocmF0aW8uZW4ubFtzZmJdID4gMCAmJiAhZ2ZwLkFUSG9ubHkpXG4gICAgICAgICAgICAgICAgZW4wID0gZW4wIC8gcmF0aW8uZW4ubFtzZmJdO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGVuMCA9IDAuMDtcblxuICAgICAgICAgICAgZ2ZjLnBpbmZvLnRocltncl1bY2hdW3NmYl0gPSBlbjFcbiAgICAgICAgICAgICAgICAqIE1hdGgubWF4KGVuMCAqIHJhdGlvLnRobS5sW3NmYl0sIGdmYy5BVEgubFtzZmJdKTtcblxuICAgICAgICAgICAgLyogdGhlcmUgaXMgbm8gc2NhbGVmYWN0b3IgYmFuZHMgPj0gU0JQU1lfbCAqL1xuICAgICAgICAgICAgZ2ZjLnBpbmZvLkxBTUVzZmJbZ3JdW2NoXVtzZmJdID0gMDtcbiAgICAgICAgICAgIGlmIChjb2RfaW5mby5wcmVmbGFnICE9IDAgJiYgc2ZiID49IDExKVxuICAgICAgICAgICAgICAgIGdmYy5waW5mby5MQU1Fc2ZiW2dyXVtjaF1bc2ZiXSA9IC1pZnFzdGVwICogcHJldGFiW3NmYl07XG5cbiAgICAgICAgICAgIGlmIChzZmIgPCBFbmNvZGVyLlNCUFNZX2wpIHtcbiAgICAgICAgICAgICAgICAvKiBzY2ZzaSBzaG91bGQgYmUgZGVjb2RlZCBieSBjYWxsZXIgc2lkZSAqL1xuICAgICAgICAgICAgICAgIGdmYy5waW5mby5MQU1Fc2ZiW2dyXVtjaF1bc2ZiXSAtPSBpZnFzdGVwICogc2NhbGVmYWNbc2ZiXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiBmb3Igc2ZiICovXG5cbiAgICAgICAgaWYgKGNvZF9pbmZvLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICBzZmIyID0gc2ZiO1xuICAgICAgICAgICAgZm9yIChzZmIgPSBjb2RfaW5mby5zZmJfc21pbjsgc2ZiIDwgRW5jb2Rlci5TQk1BWF9zOyBzZmIrKykge1xuICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IGdmYy5zY2FsZWZhY19iYW5kLnNbc2ZiXTtcbiAgICAgICAgICAgICAgICB2YXIgZW5kID0gZ2ZjLnNjYWxlZmFjX2JhbmQuc1tzZmIgKyAxXTtcbiAgICAgICAgICAgICAgICB2YXIgYncgPSBlbmQgLSBzdGFydDtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDM7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGVuMCA9IDAuMCwgbCA9IHN0YXJ0OyBsIDwgZW5kOyBsKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuMCArPSBjb2RfaW5mby54cltqXSAqIGNvZF9pbmZvLnhyW2pdO1xuICAgICAgICAgICAgICAgICAgICAgICAgaisrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVuMCA9IE1hdGgubWF4KGVuMCAvIGJ3LCAxZS0yMCk7XG4gICAgICAgICAgICAgICAgICAgIC8qIGNvbnZlcnQgdG8gTURDVCB1bml0cyAqL1xuICAgICAgICAgICAgICAgICAgICAvKiBzY2FsaW5nIHNvIGl0IHNob3dzIHVwIG9uIEZGVCBwbG90ICovXG4gICAgICAgICAgICAgICAgICAgIGVuMSA9IDFlMTU7XG5cbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLmVuX3NbZ3JdW2NoXVszICogc2ZiICsgaV0gPSBlbjEgKiBlbjA7XG4gICAgICAgICAgICAgICAgICAgIGdmYy5waW5mby54ZnNmX3NbZ3JdW2NoXVszICogc2ZiICsgaV0gPSBlbjEgKiBsM194bWluW3NmYjJdXG4gICAgICAgICAgICAgICAgICAgICAgICAqIHhmc2Zbc2ZiMl0gLyBidztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJhdGlvLmVuLnNbc2ZiXVtpXSA+IDApXG4gICAgICAgICAgICAgICAgICAgICAgICBlbjAgPSBlbjAgLyByYXRpby5lbi5zW3NmYl1baV07XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuMCA9IDAuMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdmcC5BVEhvbmx5IHx8IGdmcC5BVEhzaG9ydClcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuMCA9IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLnRocl9zW2dyXVtjaF1bMyAqIHNmYiArIGldID0gZW4xXG4gICAgICAgICAgICAgICAgICAgICAgICAqIE1hdGgubWF4KGVuMCAqIHJhdGlvLnRobS5zW3NmYl1baV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ZjLkFUSC5zW3NmYl0pO1xuXG4gICAgICAgICAgICAgICAgICAgIC8qIHRoZXJlIGlzIG5vIHNjYWxlZmFjdG9yIGJhbmRzID49IFNCUFNZX3MgKi9cbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLkxBTUVzZmJfc1tncl1bY2hdWzMgKiBzZmIgKyBpXSA9IC0yLjBcbiAgICAgICAgICAgICAgICAgICAgICAgICogY29kX2luZm8uc3ViYmxvY2tfZ2FpbltpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNmYiA8IEVuY29kZXIuU0JQU1lfcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLkxBTUVzZmJfc1tncl1bY2hdWzMgKiBzZmIgKyBpXSAtPSBpZnFzdGVwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBzY2FsZWZhY1tzZmIyXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBzZmIyKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qIGJsb2NrIHR5cGUgc2hvcnQgKi9cbiAgICAgICAgZ2ZjLnBpbmZvLkxBTUVxc3NbZ3JdW2NoXSA9IGNvZF9pbmZvLmdsb2JhbF9nYWluO1xuICAgICAgICBnZmMucGluZm8uTEFNRW1haW5iaXRzW2dyXVtjaF0gPSBjb2RfaW5mby5wYXJ0Ml8zX2xlbmd0aFxuICAgICAgICAgICAgKyBjb2RfaW5mby5wYXJ0Ml9sZW5ndGg7XG4gICAgICAgIGdmYy5waW5mby5MQU1Fc2ZiaXRzW2dyXVtjaF0gPSBjb2RfaW5mby5wYXJ0Ml9sZW5ndGg7XG5cbiAgICAgICAgZ2ZjLnBpbmZvLm92ZXJbZ3JdW2NoXSA9IG5vaXNlLm92ZXJfY291bnQ7XG4gICAgICAgIGdmYy5waW5mby5tYXhfbm9pc2VbZ3JdW2NoXSA9IG5vaXNlLm1heF9ub2lzZSAqIDEwLjA7XG4gICAgICAgIGdmYy5waW5mby5vdmVyX25vaXNlW2dyXVtjaF0gPSBub2lzZS5vdmVyX25vaXNlICogMTAuMDtcbiAgICAgICAgZ2ZjLnBpbmZvLnRvdF9ub2lzZVtncl1bY2hdID0gbm9pc2UudG90X25vaXNlICogMTAuMDtcbiAgICAgICAgZ2ZjLnBpbmZvLm92ZXJfU1NEW2dyXVtjaF0gPSBub2lzZS5vdmVyX1NTRDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiB1cGRhdGVzIHBsb3R0aW5nIGRhdGEgZm9yIGEgd2hvbGUgZnJhbWVcbiAgICAgKlxuICAgICAqIFJvYmVydCBIZWdlbWFubiAyMDAwLTEwLTIxXG4gICAgICovXG4gICAgZnVuY3Rpb24gc2V0X2ZyYW1lX3BpbmZvKGdmcCwgcmF0aW8pIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblxuICAgICAgICBnZmMubWFza2luZ19sb3dlciA9IDEuMDtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBmb3IgZXZlcnkgZ3JhbnVsZSBhbmQgY2hhbm5lbCBwYXRjaCBsM19lbmMgYW5kIHNldCBpbmZvXG4gICAgICAgICAqL1xuICAgICAgICBmb3IgKHZhciBnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcbiAgICAgICAgICAgIGZvciAodmFyIGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvZF9pbmZvID0gZ2ZjLmwzX3NpZGUudHRbZ3JdW2NoXTtcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGVmYWNfc2F2ID0gbmV3X2ludChMM1NpZGUuU0ZCTUFYKTtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KGNvZF9pbmZvLnNjYWxlZmFjLCAwLCBzY2FsZWZhY19zYXYsIDAsXG4gICAgICAgICAgICAgICAgICAgIHNjYWxlZmFjX3Nhdi5sZW5ndGgpO1xuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiByZWNvbnN0cnVjdCB0aGUgc2NhbGVmYWN0b3JzIGluIGNhc2UgU0NGU0kgd2FzIHVzZWRcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAoZ3IgPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2ZiO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHNmYiA9IDA7IHNmYiA8IGNvZF9pbmZvLnNmYl9sbWF4OyBzZmIrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvZF9pbmZvLnNjYWxlZmFjW3NmYl0gPCAwKSAvKiBzY2ZzaSAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvLnNjYWxlZmFjW3NmYl0gPSBnZmMubDNfc2lkZS50dFswXVtjaF0uc2NhbGVmYWNbc2ZiXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHNldF9waW5mbyhnZnAsIGNvZF9pbmZvLCByYXRpb1tncl1bY2hdLCBnciwgY2gpO1xuICAgICAgICAgICAgICAgIFN5c3RlbS5hcnJheWNvcHkoc2NhbGVmYWNfc2F2LCAwLCBjb2RfaW5mby5zY2FsZWZhYywgMCxcbiAgICAgICAgICAgICAgICAgICAgc2NhbGVmYWNfc2F2Lmxlbmd0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBmb3IgY2ggKi9cbiAgICAgICAgfVxuICAgICAgICAvKiBmb3IgZ3IgKi9cbiAgICB9XG5cbn1cblxuXG5mdW5jdGlvbiBDYWxjTm9pc2VEYXRhKCkge1xuICAgIHRoaXMuZ2xvYmFsX2dhaW4gPSAwO1xuICAgIHRoaXMuc2ZiX2NvdW50MSA9IDA7XG4gICAgdGhpcy5zdGVwID0gbmV3X2ludCgzOSk7XG4gICAgdGhpcy5ub2lzZSA9IG5ld19mbG9hdCgzOSk7XG4gICAgdGhpcy5ub2lzZV9sb2cgPSBuZXdfZmxvYXQoMzkpO1xufVxuXG4vL3BhY2thZ2UgbXAzO1xuXG5cbmZ1bmN0aW9uIEdySW5mbygpIHtcbiAgICAvL2Zsb2F0IHhyW10gPSBuZXcgZmxvYXRbNTc2XTtcbiAgICB0aGlzLnhyID0gbmV3X2Zsb2F0KDU3Nik7XG4gICAgLy9pbnQgbDNfZW5jW10gPSBuZXcgaW50WzU3Nl07XG4gICAgdGhpcy5sM19lbmMgPSBuZXdfaW50KDU3Nik7XG4gICAgLy9pbnQgc2NhbGVmYWNbXSA9IG5ldyBpbnRbTDNTaWRlLlNGQk1BWF07XG4gICAgdGhpcy5zY2FsZWZhYyA9IG5ld19pbnQoTDNTaWRlLlNGQk1BWCk7XG4gICAgdGhpcy54cnBvd19tYXggPSAwLjtcblxuICAgIHRoaXMucGFydDJfM19sZW5ndGggPSAwO1xuICAgIHRoaXMuYmlnX3ZhbHVlcyA9IDA7XG4gICAgdGhpcy5jb3VudDEgPSAwO1xuICAgIHRoaXMuZ2xvYmFsX2dhaW4gPSAwO1xuICAgIHRoaXMuc2NhbGVmYWNfY29tcHJlc3MgPSAwO1xuICAgIHRoaXMuYmxvY2tfdHlwZSA9IDA7XG4gICAgdGhpcy5taXhlZF9ibG9ja19mbGFnID0gMDtcbiAgICB0aGlzLnRhYmxlX3NlbGVjdCA9IG5ld19pbnQoMyk7XG4gICAgdGhpcy5zdWJibG9ja19nYWluID0gbmV3X2ludCgzICsgMSk7XG4gICAgdGhpcy5yZWdpb24wX2NvdW50ID0gMDtcbiAgICB0aGlzLnJlZ2lvbjFfY291bnQgPSAwO1xuICAgIHRoaXMucHJlZmxhZyA9IDA7XG4gICAgdGhpcy5zY2FsZWZhY19zY2FsZSA9IDA7XG4gICAgdGhpcy5jb3VudDF0YWJsZV9zZWxlY3QgPSAwO1xuXG4gICAgdGhpcy5wYXJ0Ml9sZW5ndGggPSAwO1xuICAgIHRoaXMuc2ZiX2xtYXggPSAwO1xuICAgIHRoaXMuc2ZiX3NtaW4gPSAwO1xuICAgIHRoaXMucHN5X2xtYXggPSAwO1xuICAgIHRoaXMuc2ZibWF4ID0gMDtcbiAgICB0aGlzLnBzeW1heCA9IDA7XG4gICAgdGhpcy5zZmJkaXZpZGUgPSAwO1xuICAgIHRoaXMud2lkdGggPSBuZXdfaW50KEwzU2lkZS5TRkJNQVgpO1xuICAgIHRoaXMud2luZG93ID0gbmV3X2ludChMM1NpZGUuU0ZCTUFYKTtcbiAgICB0aGlzLmNvdW50MWJpdHMgPSAwO1xuICAgIC8qKlxuICAgICAqIGFkZGVkIGZvciBMU0ZcbiAgICAgKi9cbiAgICB0aGlzLnNmYl9wYXJ0aXRpb25fdGFibGUgPSBudWxsO1xuICAgIHRoaXMuc2xlbiA9IG5ld19pbnQoNCk7XG5cbiAgICB0aGlzLm1heF9ub256ZXJvX2NvZWZmID0gMDtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBmdW5jdGlvbiBjbG9uZV9pbnQoYXJyYXkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBJbnQzMkFycmF5KGFycmF5KTtcbiAgICB9XG4gICAgZnVuY3Rpb24gY2xvbmVfZmxvYXQoYXJyYXkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBGbG9hdDMyQXJyYXkoYXJyYXkpO1xuICAgIH1cbiAgICB0aGlzLmFzc2lnbiA9IGZ1bmN0aW9uIChvdGhlcikge1xuICAgICAgICBzZWxmLnhyID0gY2xvbmVfZmxvYXQob3RoZXIueHIpOyAvLy5zbGljZSgwKTsgLy9jbG9uZSgpO1xuICAgICAgICBzZWxmLmwzX2VuYyA9IGNsb25lX2ludChvdGhlci5sM19lbmMpOyAvLy5zbGljZSgwKTsgLy9jbG9uZSgpO1xuICAgICAgICBzZWxmLnNjYWxlZmFjID0gY2xvbmVfaW50KG90aGVyLnNjYWxlZmFjKTsvLy5zbGljZSgwKTsgLy9jbG9uZSgpO1xuICAgICAgICBzZWxmLnhycG93X21heCA9IG90aGVyLnhycG93X21heDtcblxuICAgICAgICBzZWxmLnBhcnQyXzNfbGVuZ3RoID0gb3RoZXIucGFydDJfM19sZW5ndGg7XG4gICAgICAgIHNlbGYuYmlnX3ZhbHVlcyA9IG90aGVyLmJpZ192YWx1ZXM7XG4gICAgICAgIHNlbGYuY291bnQxID0gb3RoZXIuY291bnQxO1xuICAgICAgICBzZWxmLmdsb2JhbF9nYWluID0gb3RoZXIuZ2xvYmFsX2dhaW47XG4gICAgICAgIHNlbGYuc2NhbGVmYWNfY29tcHJlc3MgPSBvdGhlci5zY2FsZWZhY19jb21wcmVzcztcbiAgICAgICAgc2VsZi5ibG9ja190eXBlID0gb3RoZXIuYmxvY2tfdHlwZTtcbiAgICAgICAgc2VsZi5taXhlZF9ibG9ja19mbGFnID0gb3RoZXIubWl4ZWRfYmxvY2tfZmxhZztcbiAgICAgICAgc2VsZi50YWJsZV9zZWxlY3QgPSBjbG9uZV9pbnQob3RoZXIudGFibGVfc2VsZWN0KTsvLy5zbGljZSgwKTsgLy9jbG9uZSgpO1xuICAgICAgICBzZWxmLnN1YmJsb2NrX2dhaW4gPSBjbG9uZV9pbnQob3RoZXIuc3ViYmxvY2tfZ2Fpbik7IC8vLnNsaWNlKDApOyAvLy5jbG9uZSgpO1xuICAgICAgICBzZWxmLnJlZ2lvbjBfY291bnQgPSBvdGhlci5yZWdpb24wX2NvdW50O1xuICAgICAgICBzZWxmLnJlZ2lvbjFfY291bnQgPSBvdGhlci5yZWdpb24xX2NvdW50O1xuICAgICAgICBzZWxmLnByZWZsYWcgPSBvdGhlci5wcmVmbGFnO1xuICAgICAgICBzZWxmLnNjYWxlZmFjX3NjYWxlID0gb3RoZXIuc2NhbGVmYWNfc2NhbGU7XG4gICAgICAgIHNlbGYuY291bnQxdGFibGVfc2VsZWN0ID0gb3RoZXIuY291bnQxdGFibGVfc2VsZWN0O1xuXG4gICAgICAgIHNlbGYucGFydDJfbGVuZ3RoID0gb3RoZXIucGFydDJfbGVuZ3RoO1xuICAgICAgICBzZWxmLnNmYl9sbWF4ID0gb3RoZXIuc2ZiX2xtYXg7XG4gICAgICAgIHNlbGYuc2ZiX3NtaW4gPSBvdGhlci5zZmJfc21pbjtcbiAgICAgICAgc2VsZi5wc3lfbG1heCA9IG90aGVyLnBzeV9sbWF4O1xuICAgICAgICBzZWxmLnNmYm1heCA9IG90aGVyLnNmYm1heDtcbiAgICAgICAgc2VsZi5wc3ltYXggPSBvdGhlci5wc3ltYXg7XG4gICAgICAgIHNlbGYuc2ZiZGl2aWRlID0gb3RoZXIuc2ZiZGl2aWRlO1xuICAgICAgICBzZWxmLndpZHRoID0gY2xvbmVfaW50KG90aGVyLndpZHRoKTsgLy8uc2xpY2UoMCk7IC8vLmNsb25lKCk7XG4gICAgICAgIHNlbGYud2luZG93ID0gY2xvbmVfaW50KG90aGVyLndpbmRvdyk7IC8vLnNsaWNlKDApOyAvLy5jbG9uZSgpO1xuICAgICAgICBzZWxmLmNvdW50MWJpdHMgPSBvdGhlci5jb3VudDFiaXRzO1xuXG4gICAgICAgIHNlbGYuc2ZiX3BhcnRpdGlvbl90YWJsZSA9IG90aGVyLnNmYl9wYXJ0aXRpb25fdGFibGUuc2xpY2UoMCk7IC8vLmNsb25lKCk7XG4gICAgICAgIHNlbGYuc2xlbiA9IGNsb25lX2ludChvdGhlci5zbGVuKTsgLy8uc2xpY2UoMCk7IC8vLmNsb25lKCk7XG4gICAgICAgIHNlbGYubWF4X25vbnplcm9fY29lZmYgPSBvdGhlci5tYXhfbm9uemVyb19jb2VmZjtcbiAgICB9XG59XG5cblxudmFyIEwzU2lkZSA9IHt9O1xuXG5cblx0LyoqXG5cdCAqIG1heCBzY2FsZWZhY3RvciBiYW5kLCBtYXgoU0JNQVhfbCwgU0JNQVhfcyozLCAoU0JNQVhfcy0zKSozKzgpXG5cdCAqL1xuTDNTaWRlLlNGQk1BWCA9IChFbmNvZGVyLlNCTUFYX3MgKiAzKTtcblxuLypcbiAqIE1QMyBxdWFudGl6YXRpb25cbiAqXG4gKiAgICAgIENvcHlyaWdodCAoYykgMTk5OS0yMDAwIE1hcmsgVGF5bG9yXG4gKiAgICAgIENvcHlyaWdodCAoYykgMTk5OS0yMDAzIFRha2VoaXJvIFRvbWluYWdhXG4gKiAgICAgIENvcHlyaWdodCAoYykgMjAwMC0yMDA3IFJvYmVydCBIZWdlbWFublxuICogICAgICBDb3B5cmlnaHQgKGMpIDIwMDEtMjAwNSBHYWJyaWVsIEJvdXZpZ25lXG4gKlxuICogVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vclxuICogbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpY1xuICogTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyXG4gKiB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG4gKlxuICogVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG4gKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgICAgU2VlIHRoZSBHTlVcbiAqIExpYnJhcnkgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLlxuICpcbiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWNcbiAqIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgd3JpdGUgdG8gdGhlXG4gKiBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIEluYy4sIDU5IFRlbXBsZSBQbGFjZSAtIFN1aXRlIDMzMCxcbiAqIEJvc3RvbiwgTUEgMDIxMTEtMTMwNywgVVNBLlxuICovXG5cbi8qICRJZDogUXVhbnRpemUuamF2YSx2IDEuMjQgMjAxMS8wNS8yNCAyMDo0ODowNiBrZW5jaGlzIEV4cCAkICovXG5cbi8vcGFja2FnZSBtcDM7XG5cbi8vaW1wb3J0IGphdmEudXRpbC5BcnJheXM7XG5cblxuZnVuY3Rpb24gUXVhbnRpemUoKSB7XG4gICAgdmFyIGJzO1xuICAgIHRoaXMucnYgPSBudWxsO1xuICAgIHZhciBydjtcbiAgICB0aGlzLnF1cHZ0ID0gbnVsbDtcbiAgICB2YXIgcXVwdnQ7XG5cbiAgICB2YXIgdmJyID0gbmV3IFZCUlF1YW50aXplKCk7XG4gICAgdmFyIHRrO1xuXG4gICAgdGhpcy5zZXRNb2R1bGVzID0gZnVuY3Rpb24gKF9icywgX3J2LCBfcXVwdnQsIF90aykge1xuICAgICAgICBicyA9IF9icztcbiAgICAgICAgcnYgPSBfcnY7XG4gICAgICAgIHRoaXMucnYgPSBfcnY7XG4gICAgICAgIHF1cHZ0ID0gX3F1cHZ0O1xuICAgICAgICB0aGlzLnF1cHZ0ID0gX3F1cHZ0O1xuICAgICAgICB0ayA9IF90aztcbiAgICAgICAgdmJyLnNldE1vZHVsZXMocXVwdnQsIHRrKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjb252ZXJ0IGZyb20gTC9SIDwuIE1pZC9TaWRlXG4gICAgICovXG4gICAgdGhpcy5tc19jb252ZXJ0ID0gZnVuY3Rpb24gKGwzX3NpZGUsIGdyKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTc2OyArK2kpIHtcbiAgICAgICAgICAgIHZhciBsID0gbDNfc2lkZS50dFtncl1bMF0ueHJbaV07XG4gICAgICAgICAgICB2YXIgciA9IGwzX3NpZGUudHRbZ3JdWzFdLnhyW2ldO1xuICAgICAgICAgICAgbDNfc2lkZS50dFtncl1bMF0ueHJbaV0gPSAobCArIHIpICogKFV0aWwuU1FSVDIgKiAwLjUpO1xuICAgICAgICAgICAgbDNfc2lkZS50dFtncl1bMV0ueHJbaV0gPSAobCAtIHIpICogKFV0aWwuU1FSVDIgKiAwLjUpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIG10IDYvOTlcbiAgICAgKlxuICAgICAqIGluaXRpYWxpemVzIGNvZF9pbmZvLCBzY2FsZWZhYyBhbmQgeHJwb3dcbiAgICAgKlxuICAgICAqIHJldHVybnMgMCBpZiBhbGwgZW5lcmdpZXMgaW4geHIgYXJlIHplcm8sIGVsc2UgMVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGluaXRfeHJwb3dfY29yZShjb2RfaW5mbywgeHJwb3csIHVwcGVyLCBzdW0pIHtcbiAgICAgICAgc3VtID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPD0gdXBwZXI7ICsraSkge1xuICAgICAgICAgICAgdmFyIHRtcCA9IE1hdGguYWJzKGNvZF9pbmZvLnhyW2ldKTtcbiAgICAgICAgICAgIHN1bSArPSB0bXA7XG4gICAgICAgICAgICB4cnBvd1tpXSA9IE1hdGguc3FydCh0bXAgKiBNYXRoLnNxcnQodG1wKSk7XG5cbiAgICAgICAgICAgIGlmICh4cnBvd1tpXSA+IGNvZF9pbmZvLnhycG93X21heClcbiAgICAgICAgICAgICAgICBjb2RfaW5mby54cnBvd19tYXggPSB4cnBvd1tpXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3VtO1xuICAgIH1cblxuICAgIHRoaXMuaW5pdF94cnBvdyA9IGZ1bmN0aW9uIChnZmMsIGNvZF9pbmZvLCB4cnBvdykge1xuICAgICAgICB2YXIgc3VtID0gMDtcbiAgICAgICAgdmFyIHVwcGVyID0gMCB8IGNvZF9pbmZvLm1heF9ub256ZXJvX2NvZWZmO1xuXG4gICAgICAgIGNvZF9pbmZvLnhycG93X21heCA9IDA7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogY2hlY2sgaWYgdGhlcmUgaXMgc29tZSBlbmVyZ3kgd2UgaGF2ZSB0byBxdWFudGl6ZSBhbmQgY2FsY3VsYXRlIHhycG93XG4gICAgICAgICAqIG1hdGNoaW5nIG91ciBmcmVzaCBzY2FsZWZhY3RvcnNcbiAgICAgICAgICovXG5cbiAgICAgICAgQXJyYXlzLmZpbGwoeHJwb3csIHVwcGVyLCA1NzYsIDApO1xuXG4gICAgICAgIHN1bSA9IGluaXRfeHJwb3dfY29yZShjb2RfaW5mbywgeHJwb3csIHVwcGVyLCBzdW0pO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHJldHVybiAxIGlmIHdlIGhhdmUgc29tZXRoaW5nIHRvIHF1YW50aXplLCBlbHNlIDBcbiAgICAgICAgICovXG4gICAgICAgIGlmIChzdW0gPiAxRS0yMCkge1xuICAgICAgICAgICAgdmFyIGogPSAwO1xuICAgICAgICAgICAgaWYgKChnZmMuc3Vic3RlcF9zaGFwaW5nICYgMikgIT0gMClcbiAgICAgICAgICAgICAgICBqID0gMTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb2RfaW5mby5wc3ltYXg7IGkrKylcbiAgICAgICAgICAgICAgICBnZmMucHNldWRvaGFsZltpXSA9IGo7XG5cbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgQXJyYXlzLmZpbGwoY29kX2luZm8ubDNfZW5jLCAwLCA1NzYsIDApO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2FicmllbCBCb3V2aWduZSBmZWIvYXByIDIwMDM8QlI+XG4gICAgICogQW5hbG9nIHNpbGVuY2UgZGV0ZWN0aW9uIGluIHBhcnRpdGlvbm5lZCBzZmIyMSBvciBzZmIxMiBmb3Igc2hvcnQgYmxvY2tzXG4gICAgICpcbiAgICAgKiBGcm9tIHRvcCB0byBib3R0b20gb2Ygc2ZiLCBjaGFuZ2VzIHRvIDAgY29lZmZzIHdoaWNoIGFyZSBiZWxvdyBhdGguIEl0XG4gICAgICogc3RvcHMgb24gdGhlIGZpcnN0IGNvZWZmIGhpZ2hlciB0aGFuIGF0aC5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBwc2ZiMjFfYW5hbG9nc2lsZW5jZShnZmMsIGNvZF9pbmZvKSB7XG4gICAgICAgIHZhciBhdGggPSBnZmMuQVRIO1xuICAgICAgICB2YXIgeHIgPSBjb2RfaW5mby54cjtcblxuICAgICAgICBpZiAoY29kX2luZm8uYmxvY2tfdHlwZSAhPSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgIC8qIE5PUk0sIFNUQVJUIG9yIFNUT1AgdHlwZSwgYnV0IG5vdCBTSE9SVCBibG9ja3MgKi9cbiAgICAgICAgICAgIHZhciBzdG9wID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKHZhciBnc2ZiID0gRW5jb2Rlci5QU0ZCMjEgLSAxOyBnc2ZiID49IDAgJiYgIXN0b3A7IGdzZmItLSkge1xuICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IGdmYy5zY2FsZWZhY19iYW5kLnBzZmIyMVtnc2ZiXTtcbiAgICAgICAgICAgICAgICB2YXIgZW5kID0gZ2ZjLnNjYWxlZmFjX2JhbmQucHNmYjIxW2dzZmIgKyAxXTtcbiAgICAgICAgICAgICAgICB2YXIgYXRoMjEgPSBxdXB2dC5hdGhBZGp1c3QoYXRoLmFkanVzdCwgYXRoLnBzZmIyMVtnc2ZiXSxcbiAgICAgICAgICAgICAgICAgICAgYXRoLmZsb29yKTtcblxuICAgICAgICAgICAgICAgIGlmIChnZmMubnNQc3kubG9uZ2ZhY3RbMjFdID4gMWUtMTIpXG4gICAgICAgICAgICAgICAgICAgIGF0aDIxICo9IGdmYy5uc1BzeS5sb25nZmFjdFsyMV07XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gZW5kIC0gMTsgaiA+PSBzdGFydDsgai0tKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyh4cltqXSkgPCBhdGgyMSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHhyW2pdID0gMDtcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9wID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLyogbm90ZTogc2hvcnQgYmxvY2tzIGNvZWZmcyBhcmUgcmVvcmRlcmVkICovXG4gICAgICAgICAgICBmb3IgKHZhciBibG9jayA9IDA7IGJsb2NrIDwgMzsgYmxvY2srKykge1xuICAgICAgICAgICAgICAgIHZhciBzdG9wID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgZ3NmYiA9IEVuY29kZXIuUFNGQjEyIC0gMTsgZ3NmYiA+PSAwICYmICFzdG9wOyBnc2ZiLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gZ2ZjLnNjYWxlZmFjX2JhbmQuc1sxMl1cbiAgICAgICAgICAgICAgICAgICAgICAgICogM1xuICAgICAgICAgICAgICAgICAgICAgICAgKyAoZ2ZjLnNjYWxlZmFjX2JhbmQuc1sxM10gLSBnZmMuc2NhbGVmYWNfYmFuZC5zWzEyXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICogYmxvY2tcbiAgICAgICAgICAgICAgICAgICAgICAgICsgKGdmYy5zY2FsZWZhY19iYW5kLnBzZmIxMltnc2ZiXSAtIGdmYy5zY2FsZWZhY19iYW5kLnBzZmIxMlswXSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbmQgPSBzdGFydFxuICAgICAgICAgICAgICAgICAgICAgICAgKyAoZ2ZjLnNjYWxlZmFjX2JhbmQucHNmYjEyW2dzZmIgKyAxXSAtIGdmYy5zY2FsZWZhY19iYW5kLnBzZmIxMltnc2ZiXSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhdGgxMiA9IHF1cHZ0LmF0aEFkanVzdChhdGguYWRqdXN0LCBhdGgucHNmYjEyW2dzZmJdLFxuICAgICAgICAgICAgICAgICAgICAgICAgYXRoLmZsb29yKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZ2ZjLm5zUHN5LnNob3J0ZmFjdFsxMl0gPiAxZS0xMilcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0aDEyICo9IGdmYy5uc1BzeS5zaG9ydGZhY3RbMTJdO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSBlbmQgLSAxOyBqID49IHN0YXJ0OyBqLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyh4cltqXSkgPCBhdGgxMilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4cltqXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdG9wID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgdGhpcy5pbml0X291dGVyX2xvb3AgPSBmdW5jdGlvbiAoZ2ZjLCBjb2RfaW5mbykge1xuICAgICAgICAvKlxuICAgICAgICAgKiBpbml0aWFsaXplIGZyZXNoIGNvZF9pbmZvXG4gICAgICAgICAqL1xuICAgICAgICBjb2RfaW5mby5wYXJ0Ml8zX2xlbmd0aCA9IDA7XG4gICAgICAgIGNvZF9pbmZvLmJpZ192YWx1ZXMgPSAwO1xuICAgICAgICBjb2RfaW5mby5jb3VudDEgPSAwO1xuICAgICAgICBjb2RfaW5mby5nbG9iYWxfZ2FpbiA9IDIxMDtcbiAgICAgICAgY29kX2luZm8uc2NhbGVmYWNfY29tcHJlc3MgPSAwO1xuICAgICAgICAvKiBtaXhlZF9ibG9ja19mbGFnLCBibG9ja190eXBlIHdhcyBzZXQgaW4gcHN5bW9kZWwuYyAqL1xuICAgICAgICBjb2RfaW5mby50YWJsZV9zZWxlY3RbMF0gPSAwO1xuICAgICAgICBjb2RfaW5mby50YWJsZV9zZWxlY3RbMV0gPSAwO1xuICAgICAgICBjb2RfaW5mby50YWJsZV9zZWxlY3RbMl0gPSAwO1xuICAgICAgICBjb2RfaW5mby5zdWJibG9ja19nYWluWzBdID0gMDtcbiAgICAgICAgY29kX2luZm8uc3ViYmxvY2tfZ2FpblsxXSA9IDA7XG4gICAgICAgIGNvZF9pbmZvLnN1YmJsb2NrX2dhaW5bMl0gPSAwO1xuICAgICAgICBjb2RfaW5mby5zdWJibG9ja19nYWluWzNdID0gMDtcbiAgICAgICAgLyogdGhpcyBvbmUgaXMgYWx3YXlzIDAgKi9cbiAgICAgICAgY29kX2luZm8ucmVnaW9uMF9jb3VudCA9IDA7XG4gICAgICAgIGNvZF9pbmZvLnJlZ2lvbjFfY291bnQgPSAwO1xuICAgICAgICBjb2RfaW5mby5wcmVmbGFnID0gMDtcbiAgICAgICAgY29kX2luZm8uc2NhbGVmYWNfc2NhbGUgPSAwO1xuICAgICAgICBjb2RfaW5mby5jb3VudDF0YWJsZV9zZWxlY3QgPSAwO1xuICAgICAgICBjb2RfaW5mby5wYXJ0Ml9sZW5ndGggPSAwO1xuICAgICAgICBjb2RfaW5mby5zZmJfbG1heCA9IEVuY29kZXIuU0JQU1lfbDtcbiAgICAgICAgY29kX2luZm8uc2ZiX3NtaW4gPSBFbmNvZGVyLlNCUFNZX3M7XG4gICAgICAgIGNvZF9pbmZvLnBzeV9sbWF4ID0gZ2ZjLnNmYjIxX2V4dHJhID8gRW5jb2Rlci5TQk1BWF9sIDogRW5jb2Rlci5TQlBTWV9sO1xuICAgICAgICBjb2RfaW5mby5wc3ltYXggPSBjb2RfaW5mby5wc3lfbG1heDtcbiAgICAgICAgY29kX2luZm8uc2ZibWF4ID0gY29kX2luZm8uc2ZiX2xtYXg7XG4gICAgICAgIGNvZF9pbmZvLnNmYmRpdmlkZSA9IDExO1xuICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBFbmNvZGVyLlNCTUFYX2w7IHNmYisrKSB7XG4gICAgICAgICAgICBjb2RfaW5mby53aWR0aFtzZmJdID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFtzZmIgKyAxXVxuICAgICAgICAgICAgICAgIC0gZ2ZjLnNjYWxlZmFjX2JhbmQubFtzZmJdO1xuICAgICAgICAgICAgLyogd2hpY2ggaXMgYWx3YXlzIDAuICovXG4gICAgICAgICAgICBjb2RfaW5mby53aW5kb3dbc2ZiXSA9IDM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNvZF9pbmZvLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICB2YXIgaXh3b3JrID0gbmV3X2Zsb2F0KDU3Nik7XG5cbiAgICAgICAgICAgIGNvZF9pbmZvLnNmYl9zbWluID0gMDtcbiAgICAgICAgICAgIGNvZF9pbmZvLnNmYl9sbWF4ID0gMDtcbiAgICAgICAgICAgIGlmIChjb2RfaW5mby5taXhlZF9ibG9ja19mbGFnICE9IDApIHtcbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIE1QRUctMTogc2ZicyAwLTcgbG9uZyBibG9jaywgMy0xMiBzaG9ydCBibG9ja3MgTVBFRy0yKC41KTpcbiAgICAgICAgICAgICAgICAgKiBzZmJzIDAtNSBsb25nIGJsb2NrLCAzLTEyIHNob3J0IGJsb2Nrc1xuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGNvZF9pbmZvLnNmYl9zbWluID0gMztcbiAgICAgICAgICAgICAgICBjb2RfaW5mby5zZmJfbG1heCA9IGdmYy5tb2RlX2dyICogMiArIDQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb2RfaW5mby5wc3ltYXggPSBjb2RfaW5mby5zZmJfbG1heFxuICAgICAgICAgICAgICAgICsgM1xuICAgICAgICAgICAgICAgICogKChnZmMuc2ZiMjFfZXh0cmEgPyBFbmNvZGVyLlNCTUFYX3MgOiBFbmNvZGVyLlNCUFNZX3MpIC0gY29kX2luZm8uc2ZiX3NtaW4pO1xuICAgICAgICAgICAgY29kX2luZm8uc2ZibWF4ID0gY29kX2luZm8uc2ZiX2xtYXggKyAzXG4gICAgICAgICAgICAgICAgKiAoRW5jb2Rlci5TQlBTWV9zIC0gY29kX2luZm8uc2ZiX3NtaW4pO1xuICAgICAgICAgICAgY29kX2luZm8uc2ZiZGl2aWRlID0gY29kX2luZm8uc2ZibWF4IC0gMTg7XG4gICAgICAgICAgICBjb2RfaW5mby5wc3lfbG1heCA9IGNvZF9pbmZvLnNmYl9sbWF4O1xuICAgICAgICAgICAgLyogcmUtb3JkZXIgdGhlIHNob3J0IGJsb2NrcywgZm9yIG1vcmUgZWZmaWNpZW50IGVuY29kaW5nIGJlbG93ICovXG4gICAgICAgICAgICAvKiBCeSBUYWtlaGlybyBUT01JTkFHQSAqL1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIFdpdGhpbiBlYWNoIHNjYWxlZmFjdG9yIGJhbmQsIGRhdGEgaXMgZ2l2ZW4gZm9yIHN1Y2Nlc3NpdmUgdGltZVxuICAgICAgICAgICAgICogd2luZG93cywgYmVnaW5uaW5nIHdpdGggd2luZG93IDAgYW5kIGVuZGluZyB3aXRoIHdpbmRvdyAyLiBXaXRoaW5cbiAgICAgICAgICAgICAqIGVhY2ggd2luZG93LCB0aGUgcXVhbnRpemVkIHZhbHVlcyBhcmUgdGhlbiBhcnJhbmdlZCBpbiBvcmRlciBvZlxuICAgICAgICAgICAgICogaW5jcmVhc2luZyBmcmVxdWVuY3kuLi5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFyIGl4ID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFtjb2RfaW5mby5zZmJfbG1heF07XG4gICAgICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KGNvZF9pbmZvLnhyLCAwLCBpeHdvcmssIDAsIDU3Nik7XG4gICAgICAgICAgICBmb3IgKHZhciBzZmIgPSBjb2RfaW5mby5zZmJfc21pbjsgc2ZiIDwgRW5jb2Rlci5TQk1BWF9zOyBzZmIrKykge1xuICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IGdmYy5zY2FsZWZhY19iYW5kLnNbc2ZiXTtcbiAgICAgICAgICAgICAgICB2YXIgZW5kID0gZ2ZjLnNjYWxlZmFjX2JhbmQuc1tzZmIgKyAxXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciB3aW5kb3cgPSAwOyB3aW5kb3cgPCAzOyB3aW5kb3crKykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBsID0gc3RhcnQ7IGwgPCBlbmQ7IGwrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29kX2luZm8ueHJbaXgrK10gPSBpeHdvcmtbMyAqIGwgKyB3aW5kb3ddO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgaiA9IGNvZF9pbmZvLnNmYl9sbWF4O1xuICAgICAgICAgICAgZm9yICh2YXIgc2ZiID0gY29kX2luZm8uc2ZiX3NtaW47IHNmYiA8IEVuY29kZXIuU0JNQVhfczsgc2ZiKyspIHtcbiAgICAgICAgICAgICAgICBjb2RfaW5mby53aWR0aFtqXSA9IGNvZF9pbmZvLndpZHRoW2ogKyAxXSA9IGNvZF9pbmZvLndpZHRoW2ogKyAyXSA9IGdmYy5zY2FsZWZhY19iYW5kLnNbc2ZiICsgMV1cbiAgICAgICAgICAgICAgICAgICAgLSBnZmMuc2NhbGVmYWNfYmFuZC5zW3NmYl07XG4gICAgICAgICAgICAgICAgY29kX2luZm8ud2luZG93W2pdID0gMDtcbiAgICAgICAgICAgICAgICBjb2RfaW5mby53aW5kb3dbaiArIDFdID0gMTtcbiAgICAgICAgICAgICAgICBjb2RfaW5mby53aW5kb3dbaiArIDJdID0gMjtcbiAgICAgICAgICAgICAgICBqICs9IDM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBjb2RfaW5mby5jb3VudDFiaXRzID0gMDtcbiAgICAgICAgY29kX2luZm8uc2ZiX3BhcnRpdGlvbl90YWJsZSA9IHF1cHZ0Lm5yX29mX3NmYl9ibG9ja1swXVswXTtcbiAgICAgICAgY29kX2luZm8uc2xlblswXSA9IDA7XG4gICAgICAgIGNvZF9pbmZvLnNsZW5bMV0gPSAwO1xuICAgICAgICBjb2RfaW5mby5zbGVuWzJdID0gMDtcbiAgICAgICAgY29kX2luZm8uc2xlblszXSA9IDA7XG5cbiAgICAgICAgY29kX2luZm8ubWF4X25vbnplcm9fY29lZmYgPSA1NzU7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogZnJlc2ggc2NhbGVmYWN0b3JzIGFyZSBhbGwgemVyb1xuICAgICAgICAgKi9cbiAgICAgICAgQXJyYXlzLmZpbGwoY29kX2luZm8uc2NhbGVmYWMsIDApO1xuXG4gICAgICAgIHBzZmIyMV9hbmFsb2dzaWxlbmNlKGdmYywgY29kX2luZm8pO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBCaW5TZWFyY2hEaXJlY3Rpb24ob3JkaW5hbCkge1xuICAgICAgICB0aGlzLm9yZGluYWwgPSBvcmRpbmFsO1xuICAgIH1cblxuICAgIEJpblNlYXJjaERpcmVjdGlvbi5CSU5TRUFSQ0hfTk9ORSA9IG5ldyBCaW5TZWFyY2hEaXJlY3Rpb24oMCk7XG4gICAgQmluU2VhcmNoRGlyZWN0aW9uLkJJTlNFQVJDSF9VUCA9IG5ldyBCaW5TZWFyY2hEaXJlY3Rpb24oMSk7XG4gICAgQmluU2VhcmNoRGlyZWN0aW9uLkJJTlNFQVJDSF9ET1dOID0gbmV3IEJpblNlYXJjaERpcmVjdGlvbigyKTtcblxuICAgIC8qKlxuICAgICAqIGF1dGhvci9kYXRlPz9cbiAgICAgKlxuICAgICAqIGJpbmFyeSBzdGVwIHNpemUgc2VhcmNoIHVzZWQgYnkgb3V0ZXJfbG9vcCB0byBnZXQgYSBxdWFudGl6ZXIgc3RlcCBzaXplXG4gICAgICogdG8gc3RhcnQgd2l0aFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJpbl9zZWFyY2hfU3RlcFNpemUoZ2ZjLCBjb2RfaW5mbywgZGVzaXJlZF9yYXRlLCBjaCwgeHJwb3cpIHtcbiAgICAgICAgdmFyIG5CaXRzO1xuICAgICAgICB2YXIgQ3VycmVudFN0ZXAgPSBnZmMuQ3VycmVudFN0ZXBbY2hdO1xuICAgICAgICB2YXIgZmxhZ0dvbmVPdmVyID0gZmFsc2U7XG4gICAgICAgIHZhciBzdGFydCA9IGdmYy5PbGRWYWx1ZVtjaF07XG4gICAgICAgIHZhciBEaXJlY3Rpb24gPSBCaW5TZWFyY2hEaXJlY3Rpb24uQklOU0VBUkNIX05PTkU7XG4gICAgICAgIGNvZF9pbmZvLmdsb2JhbF9nYWluID0gc3RhcnQ7XG4gICAgICAgIGRlc2lyZWRfcmF0ZSAtPSBjb2RfaW5mby5wYXJ0Ml9sZW5ndGg7XG5cbiAgICAgICAgZm9yICg7IDspIHtcbiAgICAgICAgICAgIHZhciBzdGVwO1xuICAgICAgICAgICAgbkJpdHMgPSB0ay5jb3VudF9iaXRzKGdmYywgeHJwb3csIGNvZF9pbmZvLCBudWxsKTtcblxuICAgICAgICAgICAgaWYgKEN1cnJlbnRTdGVwID09IDEgfHwgbkJpdHMgPT0gZGVzaXJlZF9yYXRlKVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgLyogbm90aGluZyB0byBhZGp1c3QgYW55bW9yZSAqL1xuXG4gICAgICAgICAgICBpZiAobkJpdHMgPiBkZXNpcmVkX3JhdGUpIHtcbiAgICAgICAgICAgICAgICAvKiBpbmNyZWFzZSBRdWFudGl6ZV9TdGVwU2l6ZSAqL1xuICAgICAgICAgICAgICAgIGlmIChEaXJlY3Rpb24gPT0gQmluU2VhcmNoRGlyZWN0aW9uLkJJTlNFQVJDSF9ET1dOKVxuICAgICAgICAgICAgICAgICAgICBmbGFnR29uZU92ZXIgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZsYWdHb25lT3ZlcilcbiAgICAgICAgICAgICAgICAgICAgQ3VycmVudFN0ZXAgLz0gMjtcbiAgICAgICAgICAgICAgICBEaXJlY3Rpb24gPSBCaW5TZWFyY2hEaXJlY3Rpb24uQklOU0VBUkNIX1VQO1xuICAgICAgICAgICAgICAgIHN0ZXAgPSBDdXJyZW50U3RlcDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLyogZGVjcmVhc2UgUXVhbnRpemVfU3RlcFNpemUgKi9cbiAgICAgICAgICAgICAgICBpZiAoRGlyZWN0aW9uID09IEJpblNlYXJjaERpcmVjdGlvbi5CSU5TRUFSQ0hfVVApXG4gICAgICAgICAgICAgICAgICAgIGZsYWdHb25lT3ZlciA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICBpZiAoZmxhZ0dvbmVPdmVyKVxuICAgICAgICAgICAgICAgICAgICBDdXJyZW50U3RlcCAvPSAyO1xuICAgICAgICAgICAgICAgIERpcmVjdGlvbiA9IEJpblNlYXJjaERpcmVjdGlvbi5CSU5TRUFSQ0hfRE9XTjtcbiAgICAgICAgICAgICAgICBzdGVwID0gLUN1cnJlbnRTdGVwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29kX2luZm8uZ2xvYmFsX2dhaW4gKz0gc3RlcDtcbiAgICAgICAgICAgIGlmIChjb2RfaW5mby5nbG9iYWxfZ2FpbiA8IDApIHtcbiAgICAgICAgICAgICAgICBjb2RfaW5mby5nbG9iYWxfZ2FpbiA9IDA7XG4gICAgICAgICAgICAgICAgZmxhZ0dvbmVPdmVyID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb2RfaW5mby5nbG9iYWxfZ2FpbiA+IDI1NSkge1xuICAgICAgICAgICAgICAgIGNvZF9pbmZvLmdsb2JhbF9nYWluID0gMjU1O1xuICAgICAgICAgICAgICAgIGZsYWdHb25lT3ZlciA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuXG4gICAgICAgIHdoaWxlIChuQml0cyA+IGRlc2lyZWRfcmF0ZSAmJiBjb2RfaW5mby5nbG9iYWxfZ2FpbiA8IDI1NSkge1xuICAgICAgICAgICAgY29kX2luZm8uZ2xvYmFsX2dhaW4rKztcbiAgICAgICAgICAgIG5CaXRzID0gdGsuY291bnRfYml0cyhnZmMsIHhycG93LCBjb2RfaW5mbywgbnVsbCk7XG4gICAgICAgIH1cbiAgICAgICAgZ2ZjLkN1cnJlbnRTdGVwW2NoXSA9IChzdGFydCAtIGNvZF9pbmZvLmdsb2JhbF9nYWluID49IDQpID8gNCA6IDI7XG4gICAgICAgIGdmYy5PbGRWYWx1ZVtjaF0gPSBjb2RfaW5mby5nbG9iYWxfZ2FpbjtcbiAgICAgICAgY29kX2luZm8ucGFydDJfM19sZW5ndGggPSBuQml0cztcbiAgICAgICAgcmV0dXJuIG5CaXRzO1xuICAgIH1cblxuICAgIHRoaXMudHJhbmNhdGVfc21hbGxzcGVjdHJ1bXMgPSBmdW5jdGlvbiAoZ2ZjLCBnaSwgbDNfeG1pbiwgd29yaykge1xuICAgICAgICB2YXIgZGlzdG9ydCA9IG5ld19mbG9hdChMM1NpZGUuU0ZCTUFYKTtcblxuICAgICAgICBpZiAoKDAgPT0gKGdmYy5zdWJzdGVwX3NoYXBpbmcgJiA0KSAmJiBnaS5ibG9ja190eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRSlcbiAgICAgICAgICAgIHx8IChnZmMuc3Vic3RlcF9zaGFwaW5nICYgMHg4MCkgIT0gMClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgcXVwdnQuY2FsY19ub2lzZShnaSwgbDNfeG1pbiwgZGlzdG9ydCwgbmV3IENhbGNOb2lzZVJlc3VsdCgpLCBudWxsKTtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA1NzY7IGorKykge1xuICAgICAgICAgICAgdmFyIHhyID0gMC4wO1xuICAgICAgICAgICAgaWYgKGdpLmwzX2VuY1tqXSAhPSAwKVxuICAgICAgICAgICAgICAgIHhyID0gTWF0aC5hYnMoZ2kueHJbal0pO1xuICAgICAgICAgICAgd29ya1tqXSA9IHhyO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGogPSAwO1xuICAgICAgICB2YXIgc2ZiID0gODtcbiAgICAgICAgaWYgKGdpLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFKVxuICAgICAgICAgICAgc2ZiID0gNjtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgdmFyIGFsbG93ZWROb2lzZSwgdHJhbmNhdGVUaHJlc2hvbGQ7XG4gICAgICAgICAgICB2YXIgbnNhbWUsIHN0YXJ0O1xuXG4gICAgICAgICAgICB2YXIgd2lkdGggPSBnaS53aWR0aFtzZmJdO1xuICAgICAgICAgICAgaiArPSB3aWR0aDtcbiAgICAgICAgICAgIGlmIChkaXN0b3J0W3NmYl0gPj0gMS4wKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICBBcnJheXMuc29ydCh3b3JrLCBqIC0gd2lkdGgsIHdpZHRoKTtcbiAgICAgICAgICAgIGlmIChCaXRTdHJlYW0uRVEod29ya1tqIC0gMV0sIDAuMCkpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAvKiBhbGwgemVybyBzZmIgKi9cblxuICAgICAgICAgICAgYWxsb3dlZE5vaXNlID0gKDEuMCAtIGRpc3RvcnRbc2ZiXSkgKiBsM194bWluW3NmYl07XG4gICAgICAgICAgICB0cmFuY2F0ZVRocmVzaG9sZCA9IDAuMDtcbiAgICAgICAgICAgIHN0YXJ0ID0gMDtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICB2YXIgbm9pc2U7XG4gICAgICAgICAgICAgICAgZm9yIChuc2FtZSA9IDE7IHN0YXJ0ICsgbnNhbWUgPCB3aWR0aDsgbnNhbWUrKylcbiAgICAgICAgICAgICAgICAgICAgaWYgKEJpdFN0cmVhbS5ORVEod29ya1tzdGFydCArIGogLSB3aWR0aF0sIHdvcmtbc3RhcnQgKyBqXG4gICAgICAgICAgICAgICAgICAgICAgICArIG5zYW1lIC0gd2lkdGhdKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgbm9pc2UgPSB3b3JrW3N0YXJ0ICsgaiAtIHdpZHRoXSAqIHdvcmtbc3RhcnQgKyBqIC0gd2lkdGhdXG4gICAgICAgICAgICAgICAgICAgICogbnNhbWU7XG4gICAgICAgICAgICAgICAgaWYgKGFsbG93ZWROb2lzZSA8IG5vaXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzdGFydCAhPSAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgdHJhbmNhdGVUaHJlc2hvbGQgPSB3b3JrW3N0YXJ0ICsgaiAtIHdpZHRoIC0gMV07XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhbGxvd2VkTm9pc2UgLT0gbm9pc2U7XG4gICAgICAgICAgICAgICAgc3RhcnQgKz0gbnNhbWU7XG4gICAgICAgICAgICB9IHdoaWxlIChzdGFydCA8IHdpZHRoKTtcbiAgICAgICAgICAgIGlmIChCaXRTdHJlYW0uRVEodHJhbmNhdGVUaHJlc2hvbGQsIDAuMCkpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoZ2kueHJbaiAtIHdpZHRoXSkgPD0gdHJhbmNhdGVUaHJlc2hvbGQpXG4gICAgICAgICAgICAgICAgICAgIGdpLmwzX2VuY1tqIC0gd2lkdGhdID0gMDtcbiAgICAgICAgICAgIH0gd2hpbGUgKC0td2lkdGggPiAwKTtcbiAgICAgICAgfSB3aGlsZSAoKytzZmIgPCBnaS5wc3ltYXgpO1xuXG4gICAgICAgIGdpLnBhcnQyXzNfbGVuZ3RoID0gdGsubm9xdWFudF9jb3VudF9iaXRzKGdmYywgZ2ksIG51bGwpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBhdXRob3IvZGF0ZT8/XG4gICAgICpcbiAgICAgKiBGdW5jdGlvbjogUmV0dXJucyB6ZXJvIGlmIHRoZXJlIGlzIGEgc2NhbGVmYWMgd2hpY2ggaGFzIG5vdCBiZWVuXG4gICAgICogYW1wbGlmaWVkLiBPdGhlcndpc2UgaXQgcmV0dXJucyBvbmUuXG4gICAgICovXG4gICAgZnVuY3Rpb24gbG9vcF9icmVhayhjb2RfaW5mbykge1xuICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBjb2RfaW5mby5zZmJtYXg7IHNmYisrKVxuICAgICAgICAgICAgaWYgKGNvZF9pbmZvLnNjYWxlZmFjW3NmYl1cbiAgICAgICAgICAgICAgICArIGNvZF9pbmZvLnN1YmJsb2NrX2dhaW5bY29kX2luZm8ud2luZG93W3NmYl1dID09IDApXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qIG10IDUvOTk6IEZ1bmN0aW9uOiBJbXByb3ZlZCBjYWxjX25vaXNlIGZvciBhIHNpbmdsZSBjaGFubmVsICovXG5cbiAgICBmdW5jdGlvbiBwZW5hbHRpZXMobm9pc2UpIHtcbiAgICAgICAgcmV0dXJuIFV0aWwuRkFTVF9MT0cxMCgoMC4zNjggKyAwLjYzMiAqIG5vaXNlICogbm9pc2UgKiBub2lzZSkpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGF1dGhvci9kYXRlPz9cbiAgICAgKlxuICAgICAqIHNldmVyYWwgZGlmZmVyZW50IGNvZGVzIHRvIGRlY2lkZSB3aGljaCBxdWFudGl6YXRpb24gaXMgYmV0dGVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0X2tsZW1tX25vaXNlKGRpc3RvcnQsIGdpKSB7XG4gICAgICAgIHZhciBrbGVtbV9ub2lzZSA9IDFFLTM3O1xuICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBnaS5wc3ltYXg7IHNmYisrKVxuICAgICAgICAgICAga2xlbW1fbm9pc2UgKz0gcGVuYWx0aWVzKGRpc3RvcnRbc2ZiXSk7XG5cbiAgICAgICAgcmV0dXJuIE1hdGgubWF4KDFlLTIwLCBrbGVtbV9ub2lzZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcXVhbnRfY29tcGFyZShxdWFudF9jb21wLCBiZXN0LCBjYWxjLCBnaSwgZGlzdG9ydCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogbm9pc2UgaXMgZ2l2ZW4gaW4gZGVjaWJlbHMgKGRCKSByZWxhdGl2ZSB0byBtYXNraW5nIHRoZXNob2xkcy48QlI+XG4gICAgICAgICAqXG4gICAgICAgICAqIG92ZXJfbm9pc2U6ID8/PyAodGhlIHByZXZpb3VzIGNvbW1lbnQgaXMgZnVsbHkgd3JvbmcpPEJSPlxuICAgICAgICAgKiB0b3Rfbm9pc2U6ID8/PyAodGhlIHByZXZpb3VzIGNvbW1lbnQgaXMgZnVsbHkgd3JvbmcpPEJSPlxuICAgICAgICAgKiBtYXhfbm9pc2U6IG1heCBxdWFudGl6YXRpb24gbm9pc2VcbiAgICAgICAgICovXG4gICAgICAgIHZhciBiZXR0ZXI7XG5cbiAgICAgICAgc3dpdGNoIChxdWFudF9jb21wKSB7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmIChiZXN0Lm92ZXJfY291bnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8qIHRoZXJlIGFyZSBkaXN0b3J0ZWQgc2ZiICovXG4gICAgICAgICAgICAgICAgICAgIGJldHRlciA9IGNhbGMub3Zlcl9TU0QgPD0gYmVzdC5vdmVyX1NTRDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNhbGMub3Zlcl9TU0QgPT0gYmVzdC5vdmVyX1NTRClcbiAgICAgICAgICAgICAgICAgICAgICAgIGJldHRlciA9IGNhbGMuYml0cyA8IGJlc3QuYml0cztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvKiBubyBkaXN0b3J0ZWQgc2ZiICovXG4gICAgICAgICAgICAgICAgICAgIGJldHRlciA9ICgoY2FsYy5tYXhfbm9pc2UgPCAwKSAmJiAoKGNhbGMubWF4X25vaXNlICogMTAgKyBjYWxjLmJpdHMpIDw9IChiZXN0Lm1heF9ub2lzZSAqIDEwICsgYmVzdC5iaXRzKSkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIGJldHRlciA9IGNhbGMub3Zlcl9jb3VudCA8IGJlc3Qub3Zlcl9jb3VudFxuICAgICAgICAgICAgICAgICAgICB8fCAoY2FsYy5vdmVyX2NvdW50ID09IGJlc3Qub3Zlcl9jb3VudCAmJiBjYWxjLm92ZXJfbm9pc2UgPCBiZXN0Lm92ZXJfbm9pc2UpXG4gICAgICAgICAgICAgICAgICAgIHx8IChjYWxjLm92ZXJfY291bnQgPT0gYmVzdC5vdmVyX2NvdW50XG4gICAgICAgICAgICAgICAgICAgICYmIEJpdFN0cmVhbS5FUShjYWxjLm92ZXJfbm9pc2UsIGJlc3Qub3Zlcl9ub2lzZSkgJiYgY2FsYy50b3Rfbm9pc2UgPCBiZXN0LnRvdF9ub2lzZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICBjYWxjLm1heF9ub2lzZSA9IGdldF9rbGVtbV9ub2lzZShkaXN0b3J0LCBnaSk7XG4gICAgICAgICAgICAvLyRGQUxMLVRIUk9VR0gkXG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgYmV0dGVyID0gY2FsYy5tYXhfbm9pc2UgPCBiZXN0Lm1heF9ub2lzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICBiZXR0ZXIgPSBjYWxjLnRvdF9ub2lzZSA8IGJlc3QudG90X25vaXNlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIGJldHRlciA9IChjYWxjLnRvdF9ub2lzZSA8IGJlc3QudG90X25vaXNlKVxuICAgICAgICAgICAgICAgICAgICAmJiAoY2FsYy5tYXhfbm9pc2UgPCBiZXN0Lm1heF9ub2lzZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgYmV0dGVyID0gKGNhbGMubWF4X25vaXNlIDw9IDAuMCAmJiBiZXN0Lm1heF9ub2lzZSA+IDAuMilcbiAgICAgICAgICAgICAgICAgICAgfHwgKGNhbGMubWF4X25vaXNlIDw9IDAuMCAmJiBiZXN0Lm1heF9ub2lzZSA8IDAuMFxuICAgICAgICAgICAgICAgICAgICAmJiBiZXN0Lm1heF9ub2lzZSA+IGNhbGMubWF4X25vaXNlIC0gMC4yICYmIGNhbGMudG90X25vaXNlIDwgYmVzdC50b3Rfbm9pc2UpXG4gICAgICAgICAgICAgICAgICAgIHx8IChjYWxjLm1heF9ub2lzZSA8PSAwLjAgJiYgYmVzdC5tYXhfbm9pc2UgPiAwLjBcbiAgICAgICAgICAgICAgICAgICAgJiYgYmVzdC5tYXhfbm9pc2UgPiBjYWxjLm1heF9ub2lzZSAtIDAuMiAmJiBjYWxjLnRvdF9ub2lzZSA8IGJlc3QudG90X25vaXNlXG4gICAgICAgICAgICAgICAgICAgICsgYmVzdC5vdmVyX25vaXNlKVxuICAgICAgICAgICAgICAgICAgICB8fCAoY2FsYy5tYXhfbm9pc2UgPiAwLjAgJiYgYmVzdC5tYXhfbm9pc2UgPiAtMC4wNVxuICAgICAgICAgICAgICAgICAgICAmJiBiZXN0Lm1heF9ub2lzZSA+IGNhbGMubWF4X25vaXNlIC0gMC4xICYmIGNhbGMudG90X25vaXNlXG4gICAgICAgICAgICAgICAgICAgICsgY2FsYy5vdmVyX25vaXNlIDwgYmVzdC50b3Rfbm9pc2VcbiAgICAgICAgICAgICAgICAgICAgKyBiZXN0Lm92ZXJfbm9pc2UpXG4gICAgICAgICAgICAgICAgICAgIHx8IChjYWxjLm1heF9ub2lzZSA+IDAuMCAmJiBiZXN0Lm1heF9ub2lzZSA+IC0wLjFcbiAgICAgICAgICAgICAgICAgICAgJiYgYmVzdC5tYXhfbm9pc2UgPiBjYWxjLm1heF9ub2lzZSAtIDAuMTUgJiYgY2FsYy50b3Rfbm9pc2VcbiAgICAgICAgICAgICAgICAgICAgKyBjYWxjLm92ZXJfbm9pc2UgKyBjYWxjLm92ZXJfbm9pc2UgPCBiZXN0LnRvdF9ub2lzZVxuICAgICAgICAgICAgICAgICAgICArIGJlc3Qub3Zlcl9ub2lzZSArIGJlc3Qub3Zlcl9ub2lzZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgYmV0dGVyID0gY2FsYy5vdmVyX25vaXNlIDwgYmVzdC5vdmVyX25vaXNlXG4gICAgICAgICAgICAgICAgICAgIHx8IChCaXRTdHJlYW0uRVEoY2FsYy5vdmVyX25vaXNlLCBiZXN0Lm92ZXJfbm9pc2UpICYmIGNhbGMudG90X25vaXNlIDwgYmVzdC50b3Rfbm9pc2UpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgIGJldHRlciA9IGNhbGMub3Zlcl9ub2lzZSA8IGJlc3Qub3Zlcl9ub2lzZVxuICAgICAgICAgICAgICAgICAgICB8fCAoQml0U3RyZWFtLkVRKGNhbGMub3Zlcl9ub2lzZSwgYmVzdC5vdmVyX25vaXNlKSAmJiAoY2FsYy5tYXhfbm9pc2UgPCBiZXN0Lm1heF9ub2lzZSB8fCAoQml0U3RyZWFtXG4gICAgICAgICAgICAgICAgICAgICAgICAuRVEoY2FsYy5tYXhfbm9pc2UsIGJlc3QubWF4X25vaXNlKSAmJiBjYWxjLnRvdF9ub2lzZSA8PSBiZXN0LnRvdF9ub2lzZSkpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICBiZXR0ZXIgPSBjYWxjLm92ZXJfY291bnQgPCBiZXN0Lm92ZXJfY291bnRcbiAgICAgICAgICAgICAgICAgICAgfHwgY2FsYy5vdmVyX25vaXNlIDwgYmVzdC5vdmVyX25vaXNlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGJlc3Qub3Zlcl9jb3VudCA9PSAwKSB7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogSWYgbm8gZGlzdG9ydGVkIGJhbmRzLCBvbmx5IHVzZSB0aGlzIHF1YW50aXphdGlvbiBpZiBpdCBpc1xuICAgICAgICAgICAgICogYmV0dGVyLCBhbmQgaWYgaXQgdXNlcyBsZXNzIGJpdHMuIFVuZm9ydHVuYXRlbHksIHBhcnQyXzNfbGVuZ3RoXG4gICAgICAgICAgICAgKiBpcyBzb21ldGltZXMgYSBwb29yIGVzdGltYXRvciBvZiB0aGUgZmluYWwgc2l6ZSBhdCBsb3cgYml0cmF0ZXMuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGJldHRlciA9IGJldHRlciAmJiBjYWxjLmJpdHMgPCBiZXN0LmJpdHM7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYmV0dGVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGF1dGhvci9kYXRlPz9cbiAgICAgKlxuICAgICAqIDxQUkU+XG4gICAgICogIEFtcGxpZnkgdGhlIHNjYWxlZmFjdG9yIGJhbmRzIHRoYXQgdmlvbGF0ZSB0aGUgbWFza2luZyB0aHJlc2hvbGQuXG4gICAgICogIFNlZSBJU08gMTExNzItMyBTZWN0aW9uIEMuMS41LjQuMy41XG4gICAgICpcbiAgICAgKiAgZGlzdG9ydFtdID0gbm9pc2UvbWFza2luZ1xuICAgICAqICBkaXN0b3J0W10gPiAxICAgPT0+IG5vaXNlIGlzIG5vdCBtYXNrZWRcbiAgICAgKiAgZGlzdG9ydFtdIDwgMSAgID09PiBub2lzZSBpcyBtYXNrZWRcbiAgICAgKiAgbWF4X2Rpc3QgPSBtYXhpbXVtIHZhbHVlIG9mIGRpc3RvcnRbXVxuICAgICAqXG4gICAgICogIFRocmVlIGFsZ29yaXRobXM6XG4gICAgICogIG5vaXNlX3NoYXBpbmdfYW1wXG4gICAgICogICAgICAgIDAgICAgICAgICAgICAgQW1wbGlmeSBhbGwgYmFuZHMgd2l0aCBkaXN0b3J0W10+MS5cbiAgICAgKlxuICAgICAqICAgICAgICAxICAgICAgICAgICAgIEFtcGxpZnkgYWxsIGJhbmRzIHdpdGggZGlzdG9ydFtdID49IG1heF9kaXN0XiguNSk7XG4gICAgICogICAgICAgICAgICAgICAgICAgICAoIDUwJSBpbiB0aGUgZGIgc2NhbGUpXG4gICAgICpcbiAgICAgKiAgICAgICAgMiAgICAgICAgICAgICBBbXBsaWZ5IGZpcnN0IGJhbmQgd2l0aCBkaXN0b3J0W10gPj0gbWF4X2Rpc3Q7XG4gICAgICpcbiAgICAgKlxuICAgICAqICBGb3IgYWxnb3JpdGhtcyAwIGFuZCAxLCBpZiBtYXhfZGlzdCA8IDEsIHRoZW4gYW1wbGlmeSBhbGwgYmFuZHNcbiAgICAgKiAgd2l0aCBkaXN0b3J0W10gPj0gLjk1Km1heF9kaXN0LiAgVGhpcyBpcyB0byBtYWtlIHN1cmUgd2UgYWx3YXlzXG4gICAgICogIGFtcGxpZnkgYXQgbGVhc3Qgb25lIGJhbmQuXG4gICAgICogPC9QUkU+XG4gICAgICovXG4gICAgZnVuY3Rpb24gYW1wX3NjYWxlZmFjX2JhbmRzKGdmcCwgY29kX2luZm8sIGRpc3RvcnQsIHhycG93LCBiUmVmaW5lKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBpZnFzdGVwMzQ7XG5cbiAgICAgICAgaWYgKGNvZF9pbmZvLnNjYWxlZmFjX3NjYWxlID09IDApIHtcbiAgICAgICAgICAgIGlmcXN0ZXAzNCA9IDEuMjk2ODM5NTU0NjUxMDA5NjQwNTU7XG4gICAgICAgICAgICAvKiAyKiooLjc1Ki41KSAqL1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWZxc3RlcDM0ID0gMS42ODE3OTI4MzA1MDc0MjkyMjYxMjtcbiAgICAgICAgICAgIC8qIDIqKiguNzUqMSkgKi9cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGNvbXB1dGUgbWF4aW11bSB2YWx1ZSBvZiBkaXN0b3J0W10gKi9cbiAgICAgICAgdmFyIHRyaWdnZXIgPSAwO1xuICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBjb2RfaW5mby5zZmJtYXg7IHNmYisrKSB7XG4gICAgICAgICAgICBpZiAodHJpZ2dlciA8IGRpc3RvcnRbc2ZiXSlcbiAgICAgICAgICAgICAgICB0cmlnZ2VyID0gZGlzdG9ydFtzZmJdO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIG5vaXNlX3NoYXBpbmdfYW1wID0gZ2ZjLm5vaXNlX3NoYXBpbmdfYW1wO1xuICAgICAgICBpZiAobm9pc2Vfc2hhcGluZ19hbXAgPT0gMykge1xuICAgICAgICAgICAgaWYgKGJSZWZpbmUpXG4gICAgICAgICAgICAgICAgbm9pc2Vfc2hhcGluZ19hbXAgPSAyO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIG5vaXNlX3NoYXBpbmdfYW1wID0gMTtcbiAgICAgICAgfVxuICAgICAgICBzd2l0Y2ggKG5vaXNlX3NoYXBpbmdfYW1wKSB7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgLyogYW1wbGlmeSBleGFjdGx5IDEgYmFuZCAqL1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgLyogYW1wbGlmeSBiYW5kcyB3aXRoaW4gNTAlIG9mIG1heCAob24gZGIgc2NhbGUpICovXG4gICAgICAgICAgICAgICAgaWYgKHRyaWdnZXIgPiAxLjApXG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXIgPSBNYXRoLnBvdyh0cmlnZ2VyLCAuNSk7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyICo9IC45NTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAvKiBJU08gYWxnb3JpdGhtLiBhbXBsaWZ5IGFsbCBiYW5kcyB3aXRoIGRpc3RvcnQ+MSAqL1xuICAgICAgICAgICAgICAgIGlmICh0cmlnZ2VyID4gMS4wKVxuICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyID0gMS4wO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlciAqPSAuOTU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgaiA9IDA7XG4gICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IGNvZF9pbmZvLnNmYm1heDsgc2ZiKyspIHtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IGNvZF9pbmZvLndpZHRoW3NmYl07XG4gICAgICAgICAgICB2YXIgbDtcbiAgICAgICAgICAgIGogKz0gd2lkdGg7XG4gICAgICAgICAgICBpZiAoZGlzdG9ydFtzZmJdIDwgdHJpZ2dlcilcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICAgICAgaWYgKChnZmMuc3Vic3RlcF9zaGFwaW5nICYgMikgIT0gMCkge1xuICAgICAgICAgICAgICAgIGdmYy5wc2V1ZG9oYWxmW3NmYl0gPSAoMCA9PSBnZmMucHNldWRvaGFsZltzZmJdKSA/IDEgOiAwO1xuICAgICAgICAgICAgICAgIGlmICgwID09IGdmYy5wc2V1ZG9oYWxmW3NmYl0gJiYgZ2ZjLm5vaXNlX3NoYXBpbmdfYW1wID09IDIpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvZF9pbmZvLnNjYWxlZmFjW3NmYl0rKztcbiAgICAgICAgICAgIGZvciAobCA9IC13aWR0aDsgbCA8IDA7IGwrKykge1xuICAgICAgICAgICAgICAgIHhycG93W2ogKyBsXSAqPSBpZnFzdGVwMzQ7XG4gICAgICAgICAgICAgICAgaWYgKHhycG93W2ogKyBsXSA+IGNvZF9pbmZvLnhycG93X21heClcbiAgICAgICAgICAgICAgICAgICAgY29kX2luZm8ueHJwb3dfbWF4ID0geHJwb3dbaiArIGxdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZ2ZjLm5vaXNlX3NoYXBpbmdfYW1wID09IDIpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGFrZWhpcm8gVG9taW5hZ2EgMjAwMC14eC14eFxuICAgICAqXG4gICAgICogdHVybnMgb24gc2NhbGVmYWMgc2NhbGUgYW5kIGFkanVzdHMgc2NhbGVmYWN0b3JzXG4gICAgICovXG4gICAgZnVuY3Rpb24gaW5jX3NjYWxlZmFjX3NjYWxlKGNvZF9pbmZvLCB4cnBvdykge1xuICAgICAgICB2YXIgaWZxc3RlcDM0ID0gMS4yOTY4Mzk1NTQ2NTEwMDk2NDA1NTtcblxuICAgICAgICB2YXIgaiA9IDA7XG4gICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IGNvZF9pbmZvLnNmYm1heDsgc2ZiKyspIHtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IGNvZF9pbmZvLndpZHRoW3NmYl07XG4gICAgICAgICAgICB2YXIgcyA9IGNvZF9pbmZvLnNjYWxlZmFjW3NmYl07XG4gICAgICAgICAgICBpZiAoY29kX2luZm8ucHJlZmxhZyAhPSAwKVxuICAgICAgICAgICAgICAgIHMgKz0gcXVwdnQucHJldGFiW3NmYl07XG4gICAgICAgICAgICBqICs9IHdpZHRoO1xuICAgICAgICAgICAgaWYgKChzICYgMSkgIT0gMCkge1xuICAgICAgICAgICAgICAgIHMrKztcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBsID0gLXdpZHRoOyBsIDwgMDsgbCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHhycG93W2ogKyBsXSAqPSBpZnFzdGVwMzQ7XG4gICAgICAgICAgICAgICAgICAgIGlmICh4cnBvd1tqICsgbF0gPiBjb2RfaW5mby54cnBvd19tYXgpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RfaW5mby54cnBvd19tYXggPSB4cnBvd1tqICsgbF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29kX2luZm8uc2NhbGVmYWNbc2ZiXSA9IHMgPj4gMTtcbiAgICAgICAgfVxuICAgICAgICBjb2RfaW5mby5wcmVmbGFnID0gMDtcbiAgICAgICAgY29kX2luZm8uc2NhbGVmYWNfc2NhbGUgPSAxO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRha2VoaXJvIFRvbWluYWdhIDIwMDAteHgteHhcbiAgICAgKlxuICAgICAqIGluY3JlYXNlcyB0aGUgc3ViYmxvY2sgZ2FpbiBhbmQgYWRqdXN0cyBzY2FsZWZhY3RvcnNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpbmNfc3ViYmxvY2tfZ2FpbihnZmMsIGNvZF9pbmZvLCB4cnBvdykge1xuICAgICAgICB2YXIgc2ZiO1xuICAgICAgICB2YXIgc2NhbGVmYWMgPSBjb2RfaW5mby5zY2FsZWZhYztcblxuICAgICAgICAvKiBzdWJibG9jX2dhaW4gY2FuJ3QgZG8gYW55dGhpbmcgaW4gdGhlIGxvbmcgYmxvY2sgcmVnaW9uICovXG4gICAgICAgIGZvciAoc2ZiID0gMDsgc2ZiIDwgY29kX2luZm8uc2ZiX2xtYXg7IHNmYisrKSB7XG4gICAgICAgICAgICBpZiAoc2NhbGVmYWNbc2ZiXSA+PSAxNilcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIHdpbmRvdyA9IDA7IHdpbmRvdyA8IDM7IHdpbmRvdysrKSB7XG4gICAgICAgICAgICB2YXIgczEgPSAwO1xuICAgICAgICAgICAgdmFyIHMyID0gMDtcblxuICAgICAgICAgICAgZm9yIChzZmIgPSBjb2RfaW5mby5zZmJfbG1heCArIHdpbmRvdzsgc2ZiIDwgY29kX2luZm8uc2ZiZGl2aWRlOyBzZmIgKz0gMykge1xuICAgICAgICAgICAgICAgIGlmIChzMSA8IHNjYWxlZmFjW3NmYl0pXG4gICAgICAgICAgICAgICAgICAgIHMxID0gc2NhbGVmYWNbc2ZiXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoOyBzZmIgPCBjb2RfaW5mby5zZmJtYXg7IHNmYiArPSAzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHMyIDwgc2NhbGVmYWNbc2ZiXSlcbiAgICAgICAgICAgICAgICAgICAgczIgPSBzY2FsZWZhY1tzZmJdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoczEgPCAxNiAmJiBzMiA8IDgpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgICAgIGlmIChjb2RfaW5mby5zdWJibG9ja19nYWluW3dpbmRvd10gPj0gNylcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIGV2ZW4gdGhvdWdoIHRoZXJlIGlzIG5vIHNjYWxlZmFjdG9yIGZvciBzZmIxMiBzdWJibG9jayBnYWluXG4gICAgICAgICAgICAgKiBhZmZlY3RzIHVwcGVyIGZyZXF1ZW5jaWVzIHRvbywgdGhhdCdzIHdoeSB3ZSBoYXZlIHRvIGdvIHVwIHRvXG4gICAgICAgICAgICAgKiBTQk1BWF9zXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNvZF9pbmZvLnN1YmJsb2NrX2dhaW5bd2luZG93XSsrO1xuICAgICAgICAgICAgdmFyIGogPSBnZmMuc2NhbGVmYWNfYmFuZC5sW2NvZF9pbmZvLnNmYl9sbWF4XTtcbiAgICAgICAgICAgIGZvciAoc2ZiID0gY29kX2luZm8uc2ZiX2xtYXggKyB3aW5kb3c7IHNmYiA8IGNvZF9pbmZvLnNmYm1heDsgc2ZiICs9IDMpIHtcbiAgICAgICAgICAgICAgICB2YXIgYW1wO1xuICAgICAgICAgICAgICAgIHZhciB3aWR0aCA9IGNvZF9pbmZvLndpZHRoW3NmYl07XG4gICAgICAgICAgICAgICAgdmFyIHMgPSBzY2FsZWZhY1tzZmJdO1xuICAgICAgICAgICAgICAgIHMgPSBzIC0gKDQgPj4gY29kX2luZm8uc2NhbGVmYWNfc2NhbGUpO1xuICAgICAgICAgICAgICAgIGlmIChzID49IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc2NhbGVmYWNbc2ZiXSA9IHM7XG4gICAgICAgICAgICAgICAgICAgIGogKz0gd2lkdGggKiAzO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzY2FsZWZhY1tzZmJdID0gMDtcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBnYWluID0gMjEwICsgKHMgPDwgKGNvZF9pbmZvLnNjYWxlZmFjX3NjYWxlICsgMSkpO1xuICAgICAgICAgICAgICAgICAgICBhbXAgPSBxdXB2dC5JUE9XMjAoZ2Fpbik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGogKz0gd2lkdGggKiAod2luZG93ICsgMSk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgbCA9IC13aWR0aDsgbCA8IDA7IGwrKykge1xuICAgICAgICAgICAgICAgICAgICB4cnBvd1tqICsgbF0gKj0gYW1wO1xuICAgICAgICAgICAgICAgICAgICBpZiAoeHJwb3dbaiArIGxdID4gY29kX2luZm8ueHJwb3dfbWF4KVxuICAgICAgICAgICAgICAgICAgICAgICAgY29kX2luZm8ueHJwb3dfbWF4ID0geHJwb3dbaiArIGxdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBqICs9IHdpZHRoICogKDMgLSB3aW5kb3cgLSAxKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhciBhbXAgPSBxdXB2dC5JUE9XMjAoMjAyKTtcbiAgICAgICAgICAgICAgICBqICs9IGNvZF9pbmZvLndpZHRoW3NmYl0gKiAod2luZG93ICsgMSk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgbCA9IC1jb2RfaW5mby53aWR0aFtzZmJdOyBsIDwgMDsgbCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHhycG93W2ogKyBsXSAqPSBhbXA7XG4gICAgICAgICAgICAgICAgICAgIGlmICh4cnBvd1tqICsgbF0gPiBjb2RfaW5mby54cnBvd19tYXgpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RfaW5mby54cnBvd19tYXggPSB4cnBvd1tqICsgbF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiA8UFJFPlxuICAgICAqICBUYWtlaGlybyBUb21pbmFnYSAvZGF0ZT8/XG4gICAgICogIFJvYmVydCBIZWdlbWFubiAyMDAwLTA5LTA2OiBtYWRlIGEgZnVuY3Rpb24gb2YgaXRcbiAgICAgKlxuICAgICAqICBhbXBsaWZpZXMgc2NhbGVmYWN0b3IgYmFuZHMsXG4gICAgICogICAtIGlmIGFsbCBhcmUgYWxyZWFkeSBhbXBsaWZpZWQgcmV0dXJucyAwXG4gICAgICogICAtIGlmIHNvbWUgYmFuZHMgYXJlIGFtcGxpZmllZCB0b28gbXVjaDpcbiAgICAgKiAgICAgICogdHJ5IHRvIGluY3JlYXNlIHNjYWxlZmFjX3NjYWxlXG4gICAgICogICAgICAqIGlmIGFscmVhZHkgc2NhbGVmYWNfc2NhbGUgd2FzIHNldFxuICAgICAqICAgICAgICAgIHRyeSBvbiBzaG9ydCBibG9ja3MgdG8gaW5jcmVhc2Ugc3ViYmxvY2sgZ2FpblxuICAgICAqIDwvUFJFPlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJhbGFuY2Vfbm9pc2UoZ2ZwLCBjb2RfaW5mbywgZGlzdG9ydCwgeHJwb3csIGJSZWZpbmUpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblxuICAgICAgICBhbXBfc2NhbGVmYWNfYmFuZHMoZ2ZwLCBjb2RfaW5mbywgZGlzdG9ydCwgeHJwb3csIGJSZWZpbmUpO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGNoZWNrIHRvIG1ha2Ugc3VyZSB3ZSBoYXZlIG5vdCBhbXBsaWZpZWQgdG9vIG11Y2ggbG9vcF9icmVhayByZXR1cm5zXG4gICAgICAgICAqIDAgaWYgdGhlcmUgaXMgYW4gdW5hbXBsaWZpZWQgc2NhbGVmYWMgc2NhbGVfYml0Y291bnQgcmV0dXJucyAwIGlmIG5vXG4gICAgICAgICAqIHNjYWxlZmFjdG9ycyBhcmUgdG9vIGxhcmdlXG4gICAgICAgICAqL1xuXG4gICAgICAgIHZhciBzdGF0dXMgPSBsb29wX2JyZWFrKGNvZF9pbmZvKTtcblxuICAgICAgICBpZiAoc3RhdHVzKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAvKiBhbGwgYmFuZHMgYW1wbGlmaWVkICovXG5cbiAgICAgICAgLypcbiAgICAgICAgICogbm90IGFsbCBzY2FsZWZhY3RvcnMgaGF2ZSBiZWVuIGFtcGxpZmllZC4gc28gdGhlc2Ugc2NhbGVmYWNzIGFyZVxuICAgICAgICAgKiBwb3NzaWJseSB2YWxpZC4gZW5jb2RlIHRoZW06XG4gICAgICAgICAqL1xuICAgICAgICBpZiAoZ2ZjLm1vZGVfZ3IgPT0gMilcbiAgICAgICAgICAgIHN0YXR1cyA9IHRrLnNjYWxlX2JpdGNvdW50KGNvZF9pbmZvKTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgc3RhdHVzID0gdGsuc2NhbGVfYml0Y291bnRfbHNmKGdmYywgY29kX2luZm8pO1xuXG4gICAgICAgIGlmICghc3RhdHVzKVxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIC8qIGFtcGxpZmllZCBzb21lIGJhbmRzIG5vdCBleGNlZWRpbmcgbGltaXRzICovXG5cbiAgICAgICAgLypcbiAgICAgICAgICogc29tZSBzY2FsZWZhY3RvcnMgYXJlIHRvbyBsYXJnZS4gbGV0cyB0cnkgc2V0dGluZyBzY2FsZWZhY19zY2FsZT0xXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoZ2ZjLm5vaXNlX3NoYXBpbmcgPiAxKSB7XG4gICAgICAgICAgICBBcnJheXMuZmlsbChnZmMucHNldWRvaGFsZiwgMCk7XG4gICAgICAgICAgICBpZiAoMCA9PSBjb2RfaW5mby5zY2FsZWZhY19zY2FsZSkge1xuICAgICAgICAgICAgICAgIGluY19zY2FsZWZhY19zY2FsZShjb2RfaW5mbywgeHJwb3cpO1xuICAgICAgICAgICAgICAgIHN0YXR1cyA9IGZhbHNlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoY29kX2luZm8uYmxvY2tfdHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEVcbiAgICAgICAgICAgICAgICAgICAgJiYgZ2ZjLnN1YmJsb2NrX2dhaW4gPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1cyA9IChpbmNfc3ViYmxvY2tfZ2FpbihnZmMsIGNvZF9pbmZvLCB4cnBvdykgfHwgbG9vcF9icmVhayhjb2RfaW5mbykpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghc3RhdHVzKSB7XG4gICAgICAgICAgICBpZiAoZ2ZjLm1vZGVfZ3IgPT0gMilcbiAgICAgICAgICAgICAgICBzdGF0dXMgPSB0ay5zY2FsZV9iaXRjb3VudChjb2RfaW5mbyk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgc3RhdHVzID0gdGsuc2NhbGVfYml0Y291bnRfbHNmKGdmYywgY29kX2luZm8pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhc3RhdHVzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIDxQUkU+XG4gICAgICogIEZ1bmN0aW9uOiBUaGUgb3V0ZXIgaXRlcmF0aW9uIGxvb3AgY29udHJvbHMgdGhlIG1hc2tpbmcgY29uZGl0aW9uc1xuICAgICAqICBvZiBhbGwgc2NhbGVmYWN0b3JiYW5kcy4gSXQgY29tcHV0ZXMgdGhlIGJlc3Qgc2NhbGVmYWMgYW5kXG4gICAgICogIGdsb2JhbCBnYWluLiBUaGlzIG1vZHVsZSBjYWxscyB0aGUgaW5uZXIgaXRlcmF0aW9uIGxvb3BcbiAgICAgKlxuICAgICAqICBtdCA1Lzk5IGNvbXBsZXRlbHkgcmV3cml0dGVuIHRvIGFsbG93IGZvciBiaXQgcmVzZXJ2b2lyIGNvbnRyb2wsXG4gICAgICogIG1pZC9zaWRlIGNoYW5uZWxzIHdpdGggTC9SIG9yIG1pZC9zaWRlIG1hc2tpbmcgdGhyZXNob2xkcyxcbiAgICAgKiAgYW5kIGNob29zZXMgYmVzdCBxdWFudGl6YXRpb24gaW5zdGVhZCBvZiBsYXN0IHF1YW50aXphdGlvbiB3aGVuXG4gICAgICogIG5vIGRpc3RvcnRpb24gZnJlZSBxdWFudGl6YXRpb24gY2FuIGJlIGZvdW5kLlxuICAgICAqXG4gICAgICogIGFkZGVkIFZCUiBzdXBwb3J0IG10IDUvOTlcblxuICAgICAqXG4gICAgICogIHNvbWUgY29kZSBzaHVmZmxlIHJoIDkvMDBcbiAgICAgKiA8L1BSRT5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBsM194bWluXG4gICAgICogICAgICAgICAgICBhbGxvd2VkIGRpc3RvcnRpb25cbiAgICAgKiBAcGFyYW0geHJwb3dcbiAgICAgKiAgICAgICAgICAgIGNvbG91cmVkIG1hZ25pdHVkZXMgb2Ygc3BlY3RyYWxcbiAgICAgKiBAcGFyYW0gdGFyZ19iaXRzXG4gICAgICogICAgICAgICAgICBtYXhpbXVtIGFsbG93ZWQgYml0c1xuICAgICAqL1xuICAgIHRoaXMub3V0ZXJfbG9vcCA9IGZ1bmN0aW9uIChnZnAsIGNvZF9pbmZvLCBsM194bWluLCB4cnBvdywgY2gsIHRhcmdfYml0cykge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgY29kX2luZm9fdyA9IG5ldyBHckluZm8oKTtcbiAgICAgICAgdmFyIHNhdmVfeHJwb3cgPSBuZXdfZmxvYXQoNTc2KTtcbiAgICAgICAgdmFyIGRpc3RvcnQgPSBuZXdfZmxvYXQoTDNTaWRlLlNGQk1BWCk7XG4gICAgICAgIHZhciBiZXN0X25vaXNlX2luZm8gPSBuZXcgQ2FsY05vaXNlUmVzdWx0KCk7XG4gICAgICAgIHZhciBiZXR0ZXI7XG4gICAgICAgIHZhciBwcmV2X25vaXNlID0gbmV3IENhbGNOb2lzZURhdGEoKTtcbiAgICAgICAgdmFyIGJlc3RfcGFydDJfM19sZW5ndGggPSA5OTk5OTk5O1xuICAgICAgICB2YXIgYkVuZE9mU2VhcmNoID0gZmFsc2U7XG4gICAgICAgIHZhciBiUmVmaW5lID0gZmFsc2U7XG4gICAgICAgIHZhciBiZXN0X2dnYWluX3Bhc3MxID0gMDtcblxuICAgICAgICBiaW5fc2VhcmNoX1N0ZXBTaXplKGdmYywgY29kX2luZm8sIHRhcmdfYml0cywgY2gsIHhycG93KTtcblxuICAgICAgICBpZiAoMCA9PSBnZmMubm9pc2Vfc2hhcGluZylcbiAgICAgICAgLyogZmFzdCBtb2RlLCBubyBub2lzZSBzaGFwaW5nLCB3ZSBhcmUgcmVhZHkgKi9cbiAgICAgICAgICAgIHJldHVybiAxMDA7XG4gICAgICAgIC8qIGRlZmF1bHQgbm9pc2VfaW5mby5vdmVyX2NvdW50ICovXG5cbiAgICAgICAgLyogY29tcHV0ZSB0aGUgZGlzdG9ydGlvbiBpbiB0aGlzIHF1YW50aXphdGlvbiAqL1xuICAgICAgICAvKiBjb2VmZmljaWVudHMgYW5kIHRocmVzaG9sZHMgYm90aCBsL3IgKG9yIGJvdGggbWlkL3NpZGUpICovXG4gICAgICAgIHF1cHZ0LmNhbGNfbm9pc2UoY29kX2luZm8sIGwzX3htaW4sIGRpc3RvcnQsIGJlc3Rfbm9pc2VfaW5mbyxcbiAgICAgICAgICAgIHByZXZfbm9pc2UpO1xuICAgICAgICBiZXN0X25vaXNlX2luZm8uYml0cyA9IGNvZF9pbmZvLnBhcnQyXzNfbGVuZ3RoO1xuXG4gICAgICAgIGNvZF9pbmZvX3cuYXNzaWduKGNvZF9pbmZvKTtcbiAgICAgICAgdmFyIGFnZSA9IDA7XG4gICAgICAgIFN5c3RlbS5hcnJheWNvcHkoeHJwb3csIDAsIHNhdmVfeHJwb3csIDAsIDU3Nik7XG5cbiAgICAgICAgd2hpbGUgKCFiRW5kT2ZTZWFyY2gpIHtcbiAgICAgICAgICAgIC8qIEJFR0lOIE1BSU4gTE9PUCAqL1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIHZhciBub2lzZV9pbmZvID0gbmV3IENhbGNOb2lzZVJlc3VsdCgpO1xuICAgICAgICAgICAgICAgIHZhciBzZWFyY2hfbGltaXQ7XG4gICAgICAgICAgICAgICAgdmFyIG1heGdnYWluID0gMjU1O1xuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBXaGVuIHF1YW50aXphdGlvbiB3aXRoIG5vIGRpc3RvcnRlZCBiYW5kcyBpcyBmb3VuZCwgYWxsb3cgdXBcbiAgICAgICAgICAgICAgICAgKiB0byBYIG5ldyB1bnN1Y2Nlc2Z1bCB0cmllcyBpbiBzZXJpYWwuIFRoaXMgZ2l2ZXMgdXMgbW9yZVxuICAgICAgICAgICAgICAgICAqIHBvc3NpYmlsaXRpZXMgZm9yIGRpZmZlcmVudCBxdWFudF9jb21wYXJlIG1vZGVzLiBNdWNoIG1vcmVcbiAgICAgICAgICAgICAgICAgKiB0aGFuIDMgbWFrZXMgbm90IGEgYmlnIGRpZmZlcmVuY2UsIGl0IGlzIG9ubHkgc2xvd2VyLlxuICAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgaWYgKChnZmMuc3Vic3RlcF9zaGFwaW5nICYgMikgIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBzZWFyY2hfbGltaXQgPSAyMDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzZWFyY2hfbGltaXQgPSAzO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogQ2hlY2sgaWYgdGhlIGxhc3Qgc2NhbGVmYWN0b3IgYmFuZCBpcyBkaXN0b3J0ZWQuIGluIFZCUiBtb2RlXG4gICAgICAgICAgICAgICAgICogd2UgY2FuJ3QgZ2V0IHJpZCBvZiB0aGUgZGlzdG9ydGlvbiwgc28gcXVpdCBub3cgYW5kIFZCUiBtb2RlXG4gICAgICAgICAgICAgICAgICogd2lsbCB0cnkgYWdhaW4gd2l0aCBtb3JlIGJpdHMuIChtYWtlcyBhIDEwJSBzcGVlZCBpbmNyZWFzZSxcbiAgICAgICAgICAgICAgICAgKiB0aGUgZmlsZXMgSSB0ZXN0ZWQgd2VyZSBiaW5hcnkgaWRlbnRpY2FsLCAyMDAwLzA1LzIwIFJvYmVydFxuICAgICAgICAgICAgICAgICAqIEhlZ2VtYW5uKSBkaXN0b3J0W10gPiAxIG1lYW5zIG5vaXNlID4gYWxsb3dlZCBub2lzZVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGlmIChnZmMuc2ZiMjFfZXh0cmEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRpc3RvcnRbY29kX2luZm9fdy5zZmJtYXhdID4gMS4wKVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2RfaW5mb193LmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiAoZGlzdG9ydFtjb2RfaW5mb193LnNmYm1heCArIDFdID4gMS4wIHx8IGRpc3RvcnRbY29kX2luZm9fdy5zZmJtYXggKyAyXSA+IDEuMCkpXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKiB0cnkgYSBuZXcgc2NhbGVmYWN0b3IgY29uYmluYXRpb24gb24gY29kX2luZm9fdyAqL1xuICAgICAgICAgICAgICAgIGlmICghYmFsYW5jZV9ub2lzZShnZnAsIGNvZF9pbmZvX3csIGRpc3RvcnQsIHhycG93LCBiUmVmaW5lKSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgaWYgKGNvZF9pbmZvX3cuc2NhbGVmYWNfc2NhbGUgIT0gMClcbiAgICAgICAgICAgICAgICAgICAgbWF4Z2dhaW4gPSAyNTQ7XG5cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIGlubmVyX2xvb3Agc3RhcnRzIHdpdGggdGhlIGluaXRpYWwgcXVhbnRpemF0aW9uIHN0ZXAgY29tcHV0ZWRcbiAgICAgICAgICAgICAgICAgKiBhYm92ZSBhbmQgc2xvd2x5IGluY3JlYXNlcyB1bnRpbCB0aGUgYml0cyA8IGh1ZmZfYml0cy4gVGh1c1xuICAgICAgICAgICAgICAgICAqIGl0IGlzIGltcG9ydGFudCBub3QgdG8gc3RhcnQgd2l0aCB0b28gbGFyZ2Ugb2YgYW4gaW5pdGFsXG4gICAgICAgICAgICAgICAgICogcXVhbnRpemF0aW9uIHN0ZXAuIFRvbyBzbWFsbCBpcyBvaywgYnV0IGlubmVyX2xvb3Agd2lsbCB0YWtlXG4gICAgICAgICAgICAgICAgICogbG9uZ2VyXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgdmFyIGh1ZmZfYml0cyA9IHRhcmdfYml0cyAtIGNvZF9pbmZvX3cucGFydDJfbGVuZ3RoO1xuICAgICAgICAgICAgICAgIGlmIChodWZmX2JpdHMgPD0gMClcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIGluY3JlYXNlIHF1YW50aXplciBzdGVwc2l6ZSB1bnRpbCBuZWVkZWQgYml0cyBhcmUgYmVsb3dcbiAgICAgICAgICAgICAgICAgKiBtYXhpbXVtXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgd2hpbGUgKChjb2RfaW5mb193LnBhcnQyXzNfbGVuZ3RoID0gdGsuY291bnRfYml0cyhnZmMsIHhycG93LFxuICAgICAgICAgICAgICAgICAgICBjb2RfaW5mb193LCBwcmV2X25vaXNlKSkgPiBodWZmX2JpdHNcbiAgICAgICAgICAgICAgICAmJiBjb2RfaW5mb193Lmdsb2JhbF9nYWluIDw9IG1heGdnYWluKVxuICAgICAgICAgICAgICAgICAgICBjb2RfaW5mb193Lmdsb2JhbF9nYWluKys7XG5cbiAgICAgICAgICAgICAgICBpZiAoY29kX2luZm9fdy5nbG9iYWxfZ2FpbiA+IG1heGdnYWluKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGlmIChiZXN0X25vaXNlX2luZm8ub3Zlcl9jb3VudCA9PSAwKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKChjb2RfaW5mb193LnBhcnQyXzNfbGVuZ3RoID0gdGsuY291bnRfYml0cyhnZmMsXG4gICAgICAgICAgICAgICAgICAgICAgICB4cnBvdywgY29kX2luZm9fdywgcHJldl9ub2lzZSkpID4gYmVzdF9wYXJ0Ml8zX2xlbmd0aFxuICAgICAgICAgICAgICAgICAgICAmJiBjb2RfaW5mb193Lmdsb2JhbF9nYWluIDw9IG1heGdnYWluKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29kX2luZm9fdy5nbG9iYWxfZ2FpbisrO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2RfaW5mb193Lmdsb2JhbF9nYWluID4gbWF4Z2dhaW4pXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKiBjb21wdXRlIHRoZSBkaXN0b3J0aW9uIGluIHRoaXMgcXVhbnRpemF0aW9uICovXG4gICAgICAgICAgICAgICAgcXVwdnQuY2FsY19ub2lzZShjb2RfaW5mb193LCBsM194bWluLCBkaXN0b3J0LCBub2lzZV9pbmZvLFxuICAgICAgICAgICAgICAgICAgICBwcmV2X25vaXNlKTtcbiAgICAgICAgICAgICAgICBub2lzZV9pbmZvLmJpdHMgPSBjb2RfaW5mb193LnBhcnQyXzNfbGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBjaGVjayBpZiB0aGlzIHF1YW50aXphdGlvbiBpcyBiZXR0ZXIgdGhhbiBvdXIgc2F2ZWRcbiAgICAgICAgICAgICAgICAgKiBxdWFudGl6YXRpb25cbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAoY29kX2luZm8uYmxvY2tfdHlwZSAhPSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTk9STSwgU1RBUlQgb3IgU1RPUCB0eXBlXG4gICAgICAgICAgICAgICAgICAgIGJldHRlciA9IGdmcC5xdWFudF9jb21wO1xuICAgICAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgICAgICBiZXR0ZXIgPSBnZnAucXVhbnRfY29tcF9zaG9ydDtcblxuICAgICAgICAgICAgICAgIGJldHRlciA9IHF1YW50X2NvbXBhcmUoYmV0dGVyLCBiZXN0X25vaXNlX2luZm8sIG5vaXNlX2luZm8sXG4gICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvX3csIGRpc3RvcnQpID8gMSA6IDA7XG5cbiAgICAgICAgICAgICAgICAvKiBzYXZlIGRhdGEgc28gd2UgY2FuIHJlc3RvcmUgdGhpcyBxdWFudGl6YXRpb24gbGF0ZXIgKi9cbiAgICAgICAgICAgICAgICBpZiAoYmV0dGVyICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgYmVzdF9wYXJ0Ml8zX2xlbmd0aCA9IGNvZF9pbmZvLnBhcnQyXzNfbGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICBiZXN0X25vaXNlX2luZm8gPSBub2lzZV9pbmZvO1xuICAgICAgICAgICAgICAgICAgICBjb2RfaW5mby5hc3NpZ24oY29kX2luZm9fdyk7XG4gICAgICAgICAgICAgICAgICAgIGFnZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIC8qIHNhdmUgZGF0YSBzbyB3ZSBjYW4gcmVzdG9yZSB0aGlzIHF1YW50aXphdGlvbiBsYXRlciAqL1xuICAgICAgICAgICAgICAgICAgICAvKiBzdG9yZSBmb3IgbGF0ZXIgcmV1c2UgKi9cbiAgICAgICAgICAgICAgICAgICAgU3lzdGVtLmFycmF5Y29weSh4cnBvdywgMCwgc2F2ZV94cnBvdywgMCwgNTc2KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvKiBlYXJseSBzdG9wPyAqL1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2ZjLmZ1bGxfb3V0ZXJfbG9vcCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKythZ2UgPiBzZWFyY2hfbGltaXRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiBiZXN0X25vaXNlX2luZm8ub3Zlcl9jb3VudCA9PSAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChnZmMubm9pc2Vfc2hhcGluZ19hbXAgPT0gMykgJiYgYlJlZmluZSAmJiBhZ2UgPiAzMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoZ2ZjLm5vaXNlX3NoYXBpbmdfYW1wID09IDMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgYlJlZmluZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIChjb2RfaW5mb193Lmdsb2JhbF9nYWluIC0gYmVzdF9nZ2Fpbl9wYXNzMSkgPiAxNSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gd2hpbGUgKChjb2RfaW5mb193Lmdsb2JhbF9nYWluICsgY29kX2luZm9fdy5zY2FsZWZhY19zY2FsZSkgPCAyNTUpO1xuXG4gICAgICAgICAgICBpZiAoZ2ZjLm5vaXNlX3NoYXBpbmdfYW1wID09IDMpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWJSZWZpbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgLyogcmVmaW5lIHNlYXJjaCAqL1xuICAgICAgICAgICAgICAgICAgICBjb2RfaW5mb193LmFzc2lnbihjb2RfaW5mbyk7XG4gICAgICAgICAgICAgICAgICAgIFN5c3RlbS5hcnJheWNvcHkoc2F2ZV94cnBvdywgMCwgeHJwb3csIDAsIDU3Nik7XG4gICAgICAgICAgICAgICAgICAgIGFnZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGJlc3RfZ2dhaW5fcGFzczEgPSBjb2RfaW5mb193Lmdsb2JhbF9nYWluO1xuXG4gICAgICAgICAgICAgICAgICAgIGJSZWZpbmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8qIHNlYXJjaCBhbHJlYWR5IHJlZmluZWQsIHN0b3AgKi9cbiAgICAgICAgICAgICAgICAgICAgYkVuZE9mU2VhcmNoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYkVuZE9mU2VhcmNoID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGZpbmlzaCB1cFxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfcmggfHwgZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9tdHJoKVxuICAgICAgICAvKiByZXN0b3JlIGZvciByZXVzZSBvbiBuZXh0IHRyeSAqL1xuICAgICAgICAgICAgU3lzdGVtLmFycmF5Y29weShzYXZlX3hycG93LCAwLCB4cnBvdywgMCwgNTc2KTtcbiAgICAgICAgLypcbiAgICAgICAgICogZG8gdGhlICdzdWJzdGVwIHNoYXBpbmcnXG4gICAgICAgICAqL1xuICAgICAgICBlbHNlIGlmICgoZ2ZjLnN1YnN0ZXBfc2hhcGluZyAmIDEpICE9IDApXG4gICAgICAgICAgICB0cmFuY2F0ZV9zbWFsbHNwZWN0cnVtcyhnZmMsIGNvZF9pbmZvLCBsM194bWluLCB4cnBvdyk7XG5cbiAgICAgICAgcmV0dXJuIGJlc3Rfbm9pc2VfaW5mby5vdmVyX2NvdW50O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJvYmVydCBIZWdlbWFubiAyMDAwLTA5LTA2XG4gICAgICpcbiAgICAgKiB1cGRhdGUgcmVzZXJ2b2lyIHN0YXR1cyBhZnRlciBGSU5BTCBxdWFudGl6YXRpb24vYml0cmF0ZVxuICAgICAqL1xuICAgIHRoaXMuaXRlcmF0aW9uX2ZpbmlzaF9vbmUgPSBmdW5jdGlvbiAoZ2ZjLCBnciwgY2gpIHtcbiAgICAgICAgdmFyIGwzX3NpZGUgPSBnZmMubDNfc2lkZTtcbiAgICAgICAgdmFyIGNvZF9pbmZvID0gbDNfc2lkZS50dFtncl1bY2hdO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHRyeSBzb21lIGJldHRlciBzY2FsZWZhYyBzdG9yYWdlXG4gICAgICAgICAqL1xuICAgICAgICB0ay5iZXN0X3NjYWxlZmFjX3N0b3JlKGdmYywgZ3IsIGNoLCBsM19zaWRlKTtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBiZXN0IGh1ZmZtYW5fZGl2aWRlIG1heSBzYXZlIHNvbWUgYml0cyB0b29cbiAgICAgICAgICovXG4gICAgICAgIGlmIChnZmMudXNlX2Jlc3RfaHVmZm1hbiA9PSAxKVxuICAgICAgICAgICAgdGsuYmVzdF9odWZmbWFuX2RpdmlkZShnZmMsIGNvZF9pbmZvKTtcblxuICAgICAgICAvKlxuICAgICAgICAgKiB1cGRhdGUgcmVzZXJ2b2lyIHN0YXR1cyBhZnRlciBGSU5BTCBxdWFudGl6YXRpb24vYml0cmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgcnYuUmVzdkFkanVzdChnZmMsIGNvZF9pbmZvKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiAyMDAwLTA5LTA0IFJvYmVydCBIZWdlbWFublxuICAgICAqXG4gICAgICogQHBhcmFtIGwzX3htaW5cbiAgICAgKiAgICAgICAgICAgIGFsbG93ZWQgZGlzdG9ydGlvbiBvZiB0aGUgc2NhbGVmYWN0b3JcbiAgICAgKiBAcGFyYW0geHJwb3dcbiAgICAgKiAgICAgICAgICAgIGNvbG91cmVkIG1hZ25pdHVkZXMgb2Ygc3BlY3RyYWwgdmFsdWVzXG4gICAgICovXG4gICAgdGhpcy5WQlJfZW5jb2RlX2dyYW51bGUgPSBmdW5jdGlvbiAoZ2ZwLCBjb2RfaW5mbywgbDNfeG1pbiwgeHJwb3csIGNoLCBtaW5fYml0cywgbWF4X2JpdHMpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGJzdF9jb2RfaW5mbyA9IG5ldyBHckluZm8oKTtcbiAgICAgICAgdmFyIGJzdF94cnBvdyA9IG5ld19mbG9hdCg1NzYpO1xuICAgICAgICB2YXIgTWF4X2JpdHMgPSBtYXhfYml0cztcbiAgICAgICAgdmFyIHJlYWxfYml0cyA9IG1heF9iaXRzICsgMTtcbiAgICAgICAgdmFyIHRoaXNfYml0cyA9IChtYXhfYml0cyArIG1pbl9iaXRzKSAvIDI7XG4gICAgICAgIHZhciBkYml0cywgb3ZlciwgZm91bmQgPSAwO1xuICAgICAgICB2YXIgc2ZiMjFfZXh0cmEgPSBnZmMuc2ZiMjFfZXh0cmE7XG5cbiAgICAgICAgQXJyYXlzLmZpbGwoYnN0X2NvZF9pbmZvLmwzX2VuYywgMCk7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogc2VhcmNoIHdpdGhpbiByb3VuZCBhYm91dCA0MCBiaXRzIG9mIG9wdGltYWxcbiAgICAgICAgICovXG4gICAgICAgIGRvIHtcblxuICAgICAgICAgICAgaWYgKHRoaXNfYml0cyA+IE1heF9iaXRzIC0gNDIpXG4gICAgICAgICAgICAgICAgZ2ZjLnNmYjIxX2V4dHJhID0gZmFsc2U7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgZ2ZjLnNmYjIxX2V4dHJhID0gc2ZiMjFfZXh0cmE7XG5cbiAgICAgICAgICAgIG92ZXIgPSBvdXRlcl9sb29wKGdmcCwgY29kX2luZm8sIGwzX3htaW4sIHhycG93LCBjaCwgdGhpc19iaXRzKTtcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIGlzIHF1YW50aXphdGlvbiBhcyBnb29kIGFzIHdlIGFyZSBsb29raW5nIGZvciA/IGluIHRoaXMgY2FzZTogaXNcbiAgICAgICAgICAgICAqIG5vIHNjYWxlZmFjdG9yIGJhbmQgZGlzdG9ydGVkP1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAob3ZlciA8PSAwKSB7XG4gICAgICAgICAgICAgICAgZm91bmQgPSAxO1xuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogbm93IHdlIGtub3cgaXQgY2FuIGJlIGRvbmUgd2l0aCBcInJlYWxfYml0c1wiIGFuZCBtYXliZSB3ZSBjYW5cbiAgICAgICAgICAgICAgICAgKiBza2lwIHNvbWUgaXRlcmF0aW9uc1xuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIHJlYWxfYml0cyA9IGNvZF9pbmZvLnBhcnQyXzNfbGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBzdG9yZSBiZXN0IHF1YW50aXphdGlvbiBzbyBmYXJcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBic3RfY29kX2luZm8uYXNzaWduKGNvZF9pbmZvKTtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KHhycG93LCAwLCBic3RfeHJwb3csIDAsIDU3Nik7XG5cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIHRyeSB3aXRoIGZld2VyIGJpdHNcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBtYXhfYml0cyA9IHJlYWxfYml0cyAtIDMyO1xuICAgICAgICAgICAgICAgIGRiaXRzID0gbWF4X2JpdHMgLSBtaW5fYml0cztcbiAgICAgICAgICAgICAgICB0aGlzX2JpdHMgPSAobWF4X2JpdHMgKyBtaW5fYml0cykgLyAyO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIHRyeSB3aXRoIG1vcmUgYml0c1xuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIG1pbl9iaXRzID0gdGhpc19iaXRzICsgMzI7XG4gICAgICAgICAgICAgICAgZGJpdHMgPSBtYXhfYml0cyAtIG1pbl9iaXRzO1xuICAgICAgICAgICAgICAgIHRoaXNfYml0cyA9IChtYXhfYml0cyArIG1pbl9iaXRzKSAvIDI7XG5cbiAgICAgICAgICAgICAgICBpZiAoZm91bmQgIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBmb3VuZCA9IDI7XG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAqIHN0YXJ0IGFnYWluIHdpdGggYmVzdCBxdWFudGl6YXRpb24gc28gZmFyXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICBjb2RfaW5mby5hc3NpZ24oYnN0X2NvZF9pbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgU3lzdGVtLmFycmF5Y29weShic3RfeHJwb3csIDAsIHhycG93LCAwLCA1NzYpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSB3aGlsZSAoZGJpdHMgPiAxMik7XG5cbiAgICAgICAgZ2ZjLnNmYjIxX2V4dHJhID0gc2ZiMjFfZXh0cmE7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogZm91bmQ9MCA9PiBub3RoaW5nIGZvdW5kLCB1c2UgbGFzdCBvbmUgZm91bmQ9MSA9PiB3ZSBqdXN0IGZvdW5kIHRoZVxuICAgICAgICAgKiBiZXN0IGFuZCBsZWZ0IHRoZSBsb29wIGZvdW5kPTIgPT4gd2UgcmVzdG9yZWQgYSBnb29kIG9uZSBhbmQgaGF2ZSBub3dcbiAgICAgICAgICogbDNfZW5jIHRvIHJlc3RvcmUgdG9vXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoZm91bmQgPT0gMikge1xuICAgICAgICAgICAgU3lzdGVtLmFycmF5Y29weShic3RfY29kX2luZm8ubDNfZW5jLCAwLCBjb2RfaW5mby5sM19lbmMsIDAsIDU3Nik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSb2JlcnQgSGVnZW1hbm4gMjAwMC0wOS0wNVxuICAgICAqXG4gICAgICogY2FsY3VsYXRlcyAqIGhvdyBtYW55IGJpdHMgYXJlIGF2YWlsYWJsZSBmb3IgYW5hbG9nIHNpbGVudCBncmFudWxlcyAqIGhvd1xuICAgICAqIG1hbnkgYml0cyB0byB1c2UgZm9yIHRoZSBsb3dlc3QgYWxsb3dlZCBiaXRyYXRlICogaG93IG1hbnkgYml0cyBlYWNoXG4gICAgICogYml0cmF0ZSB3b3VsZCBwcm92aWRlXG4gICAgICovXG4gICAgdGhpcy5nZXRfZnJhbWViaXRzID0gZnVuY3Rpb24gKGdmcCwgZnJhbWVCaXRzKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogYWx3YXlzIHVzZSBhdCBsZWFzdCB0aGlzIG1hbnkgYml0cyBwZXIgZ3JhbnVsZSBwZXIgY2hhbm5lbCB1bmxlc3Mgd2VcbiAgICAgICAgICogZGV0ZWN0IGFuYWxvZyBzaWxlbmNlLCBzZWUgYmVsb3dcbiAgICAgICAgICovXG4gICAgICAgIGdmYy5iaXRyYXRlX2luZGV4ID0gZ2ZjLlZCUl9taW5fYml0cmF0ZTtcbiAgICAgICAgdmFyIGJpdHNQZXJGcmFtZSA9IGJzLmdldGZyYW1lYml0cyhnZnApO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGJpdHMgZm9yIGFuYWxvZyBzaWxlbmNlXG4gICAgICAgICAqL1xuICAgICAgICBnZmMuYml0cmF0ZV9pbmRleCA9IDE7XG4gICAgICAgIGJpdHNQZXJGcmFtZSA9IGJzLmdldGZyYW1lYml0cyhnZnApO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDw9IGdmYy5WQlJfbWF4X2JpdHJhdGU7IGkrKykge1xuICAgICAgICAgICAgZ2ZjLmJpdHJhdGVfaW5kZXggPSBpO1xuICAgICAgICAgICAgdmFyIG1iID0gbmV3IE1lYW5CaXRzKGJpdHNQZXJGcmFtZSk7XG4gICAgICAgICAgICBmcmFtZUJpdHNbaV0gPSBydi5SZXN2RnJhbWVCZWdpbihnZnAsIG1iKTtcbiAgICAgICAgICAgIGJpdHNQZXJGcmFtZSA9IG1iLmJpdHM7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLyogUkg6IHRoaXMgb25lIG5lZWRzIHRvIGJlIG92ZXJoYXVsZWQgc29tZXRpbWUgKi9cblxuICAgIC8qKlxuICAgICAqIDxQUkU+XG4gICAgICogIDIwMDAtMDktMDQgUm9iZXJ0IEhlZ2VtYW5uXG4gICAgICpcbiAgICAgKiAgKiBjb252ZXJ0cyBMUiB0byBNUyBjb2Rpbmcgd2hlbiBuZWNlc3NhcnlcbiAgICAgKiAgKiBjYWxjdWxhdGVzIGFsbG93ZWQvYWRqdXN0ZWQgcXVhbnRpemF0aW9uIG5vaXNlIGFtb3VudHNcbiAgICAgKiAgKiBkZXRlY3RzIGFuYWxvZyBzaWxlbnQgZnJhbWVzXG4gICAgICpcbiAgICAgKiAgc29tZSByZW1hcmtzOlxuICAgICAqICAtIGxvd2VyIG1hc2tpbmcgZGVwZW5kaW5nIG9uIFF1YWxpdHkgc2V0dGluZ1xuICAgICAqICAtIHF1YWxpdHkgY29udHJvbCB0b2dldGhlciB3aXRoIGFkanVzdGVkIEFUSCBNRENUIHNjYWxpbmdcbiAgICAgKiAgICBvbiBsb3dlciBxdWFsaXR5IHNldHRpbmcgYWxsb2NhdGUgbW9yZSBub2lzZSBmcm9tXG4gICAgICogICAgQVRIIG1hc2tpbmcsIGFuZCBvbiBoaWdoZXIgcXVhbGl0eSBzZXR0aW5nIGFsbG9jYXRlXG4gICAgICogICAgbGVzcyBub2lzZSBmcm9tIEFUSCBtYXNraW5nLlxuICAgICAqICAtIGV4cGVyaW1lbnRzIHNob3cgdGhhdCBnb2luZyBtb3JlIHRoYW4gMmRCIG92ZXIgR1BTWUNITydzXG4gICAgICogICAgbGltaXRzIGVuZHMgdXAgaW4gdmVyeSBhbm5veWluZyBhcnRlZmFjdHNcbiAgICAgKiA8L1BSRT5cbiAgICAgKi9cbiAgICB0aGlzLlZCUl9vbGRfcHJlcGFyZSA9IGZ1bmN0aW9uIChnZnAsIHBlLCBtc19lbmVyX3JhdGlvLCByYXRpbywgbDNfeG1pbiwgZnJhbWVCaXRzLCBtaW5fYml0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhfYml0cywgYmFuZHMpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblxuICAgICAgICB2YXIgbWFza2luZ19sb3dlcl9kYiwgYWRqdXN0ID0gMC4wO1xuICAgICAgICB2YXIgYW5hbG9nX3NpbGVuY2UgPSAxO1xuICAgICAgICB2YXIgYml0cyA9IDA7XG5cbiAgICAgICAgZ2ZjLmJpdHJhdGVfaW5kZXggPSBnZmMuVkJSX21heF9iaXRyYXRlO1xuICAgICAgICB2YXIgYXZnID0gcnYuUmVzdkZyYW1lQmVnaW4oZ2ZwLCBuZXcgTWVhbkJpdHMoMCkpIC8gZ2ZjLm1vZGVfZ3I7XG5cbiAgICAgICAgZ2V0X2ZyYW1lYml0cyhnZnAsIGZyYW1lQml0cyk7XG5cbiAgICAgICAgZm9yICh2YXIgZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG4gICAgICAgICAgICB2YXIgbXhiID0gcXVwdnQub25fcGUoZ2ZwLCBwZSwgbWF4X2JpdHNbZ3JdLCBhdmcsIGdyLCAwKTtcbiAgICAgICAgICAgIGlmIChnZmMubW9kZV9leHQgPT0gRW5jb2Rlci5NUEdfTURfTVNfTFIpIHtcbiAgICAgICAgICAgICAgICBtc19jb252ZXJ0KGdmYy5sM19zaWRlLCBncik7XG4gICAgICAgICAgICAgICAgcXVwdnQucmVkdWNlX3NpZGUobWF4X2JpdHNbZ3JdLCBtc19lbmVyX3JhdGlvW2dyXSwgYXZnLCBteGIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7ICsrY2gpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29kX2luZm8gPSBnZmMubDNfc2lkZS50dFtncl1bY2hdO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNvZF9pbmZvLmJsb2NrX3R5cGUgIT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIE5PUk0sIFNUQVJUIG9yIFNUT1AgdHlwZVxuICAgICAgICAgICAgICAgICAgICBhZGp1c3QgPSAxLjI4IC8gKDEgKyBNYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmV4cCgzLjUgLSBwZVtncl1bY2hdIC8gMzAwLikpIC0gMC4wNTtcbiAgICAgICAgICAgICAgICAgICAgbWFza2luZ19sb3dlcl9kYiA9IGdmYy5QU1kubWFza19hZGp1c3QgLSBhZGp1c3Q7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgYWRqdXN0ID0gMi41NiAvICgxICsgTWF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5leHAoMy41IC0gcGVbZ3JdW2NoXSAvIDMwMC4pKSAtIDAuMTQ7XG4gICAgICAgICAgICAgICAgICAgIG1hc2tpbmdfbG93ZXJfZGIgPSBnZmMuUFNZLm1hc2tfYWRqdXN0X3Nob3J0IC0gYWRqdXN0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBnZmMubWFza2luZ19sb3dlciA9IE1hdGgucG93KDEwLjAsXG4gICAgICAgICAgICAgICAgICAgIG1hc2tpbmdfbG93ZXJfZGIgKiAwLjEpO1xuXG4gICAgICAgICAgICAgICAgaW5pdF9vdXRlcl9sb29wKGdmYywgY29kX2luZm8pO1xuICAgICAgICAgICAgICAgIGJhbmRzW2dyXVtjaF0gPSBxdXB2dC5jYWxjX3htaW4oZ2ZwLCByYXRpb1tncl1bY2hdLCBjb2RfaW5mbyxcbiAgICAgICAgICAgICAgICAgICAgbDNfeG1pbltncl1bY2hdKTtcbiAgICAgICAgICAgICAgICBpZiAoYmFuZHNbZ3JdW2NoXSAhPSAwKVxuICAgICAgICAgICAgICAgICAgICBhbmFsb2dfc2lsZW5jZSA9IDA7XG5cbiAgICAgICAgICAgICAgICBtaW5fYml0c1tncl1bY2hdID0gMTI2O1xuXG4gICAgICAgICAgICAgICAgYml0cyArPSBtYXhfYml0c1tncl1bY2hdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuICAgICAgICAgICAgZm9yICh2YXIgY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoYml0cyA+IGZyYW1lQml0c1tnZmMuVkJSX21heF9iaXRyYXRlXSkge1xuICAgICAgICAgICAgICAgICAgICBtYXhfYml0c1tncl1bY2hdICo9IGZyYW1lQml0c1tnZmMuVkJSX21heF9iaXRyYXRlXTtcbiAgICAgICAgICAgICAgICAgICAgbWF4X2JpdHNbZ3JdW2NoXSAvPSBiaXRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobWluX2JpdHNbZ3JdW2NoXSA+IG1heF9iaXRzW2dyXVtjaF0pXG4gICAgICAgICAgICAgICAgICAgIG1pbl9iaXRzW2dyXVtjaF0gPSBtYXhfYml0c1tncl1bY2hdO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBmb3IgY2ggKi9cbiAgICAgICAgfVxuICAgICAgICAvKiBmb3IgZ3IgKi9cblxuICAgICAgICByZXR1cm4gYW5hbG9nX3NpbGVuY2U7XG4gICAgfTtcblxuICAgIHRoaXMuYml0cHJlc3N1cmVfc3RyYXRlZ3kgPSBmdW5jdGlvbiAoZ2ZjLCBsM194bWluLCBtaW5fYml0cywgbWF4X2JpdHMpIHtcbiAgICAgICAgZm9yICh2YXIgZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgIHZhciBnaSA9IGdmYy5sM19zaWRlLnR0W2dyXVtjaF07XG4gICAgICAgICAgICAgICAgdmFyIHB4bWluID0gbDNfeG1pbltncl1bY2hdO1xuICAgICAgICAgICAgICAgIHZhciBweG1pblBvcyA9IDA7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgZ2kucHN5X2xtYXg7IHNmYisrKVxuICAgICAgICAgICAgICAgICAgICBweG1pbltweG1pblBvcysrXSAqPSAxLiArIC4wMjkgKiBzZmIgKiBzZmJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8gRW5jb2Rlci5TQk1BWF9sIC8gRW5jb2Rlci5TQk1BWF9sO1xuXG4gICAgICAgICAgICAgICAgaWYgKGdpLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHNmYiA9IGdpLnNmYl9zbWluOyBzZmIgPCBFbmNvZGVyLlNCTUFYX3M7IHNmYisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBweG1pbltweG1pblBvcysrXSAqPSAxLiArIC4wMjkgKiBzZmIgKiBzZmJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvIEVuY29kZXIuU0JNQVhfcyAvIEVuY29kZXIuU0JNQVhfcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHB4bWluW3B4bWluUG9zKytdICo9IDEuICsgLjAyOSAqIHNmYiAqIHNmYlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8gRW5jb2Rlci5TQk1BWF9zIC8gRW5jb2Rlci5TQk1BWF9zO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHhtaW5bcHhtaW5Qb3MrK10gKj0gMS4gKyAuMDI5ICogc2ZiICogc2ZiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLyBFbmNvZGVyLlNCTUFYX3MgLyBFbmNvZGVyLlNCTUFYX3M7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbWF4X2JpdHNbZ3JdW2NoXSA9IDAgfCBNYXRoLm1heChtaW5fYml0c1tncl1bY2hdLFxuICAgICAgICAgICAgICAgICAgICAgICAgMC45ICogbWF4X2JpdHNbZ3JdW2NoXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5WQlJfbmV3X3ByZXBhcmUgPSBmdW5jdGlvbiAoZ2ZwLCBwZSwgcmF0aW8sIGwzX3htaW4sIGZyYW1lQml0cywgbWF4X2JpdHMpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblxuICAgICAgICB2YXIgYW5hbG9nX3NpbGVuY2UgPSAxO1xuICAgICAgICB2YXIgYXZnID0gMCwgYml0cyA9IDA7XG4gICAgICAgIHZhciBtYXhpbXVtX2ZyYW1lYml0cztcblxuICAgICAgICBpZiAoIWdmcC5mcmVlX2Zvcm1hdCkge1xuICAgICAgICAgICAgZ2ZjLmJpdHJhdGVfaW5kZXggPSBnZmMuVkJSX21heF9iaXRyYXRlO1xuXG4gICAgICAgICAgICB2YXIgbWIgPSBuZXcgTWVhbkJpdHMoYXZnKTtcbiAgICAgICAgICAgIHJ2LlJlc3ZGcmFtZUJlZ2luKGdmcCwgbWIpO1xuICAgICAgICAgICAgYXZnID0gbWIuYml0cztcblxuICAgICAgICAgICAgZ2V0X2ZyYW1lYml0cyhnZnAsIGZyYW1lQml0cyk7XG4gICAgICAgICAgICBtYXhpbXVtX2ZyYW1lYml0cyA9IGZyYW1lQml0c1tnZmMuVkJSX21heF9iaXRyYXRlXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdmYy5iaXRyYXRlX2luZGV4ID0gMDtcbiAgICAgICAgICAgIHZhciBtYiA9IG5ldyBNZWFuQml0cyhhdmcpO1xuICAgICAgICAgICAgbWF4aW11bV9mcmFtZWJpdHMgPSBydi5SZXN2RnJhbWVCZWdpbihnZnAsIG1iKTtcbiAgICAgICAgICAgIGF2ZyA9IG1iLmJpdHM7XG4gICAgICAgICAgICBmcmFtZUJpdHNbMF0gPSBtYXhpbXVtX2ZyYW1lYml0cztcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuICAgICAgICAgICAgcXVwdnQub25fcGUoZ2ZwLCBwZSwgbWF4X2JpdHNbZ3JdLCBhdmcsIGdyLCAwKTtcbiAgICAgICAgICAgIGlmIChnZmMubW9kZV9leHQgPT0gRW5jb2Rlci5NUEdfTURfTVNfTFIpIHtcbiAgICAgICAgICAgICAgICBtc19jb252ZXJ0KGdmYy5sM19zaWRlLCBncik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgKytjaCkge1xuICAgICAgICAgICAgICAgIHZhciBjb2RfaW5mbyA9IGdmYy5sM19zaWRlLnR0W2dyXVtjaF07XG5cbiAgICAgICAgICAgICAgICBnZmMubWFza2luZ19sb3dlciA9IE1hdGgucG93KDEwLjAsXG4gICAgICAgICAgICAgICAgICAgIGdmYy5QU1kubWFza19hZGp1c3QgKiAwLjEpO1xuXG4gICAgICAgICAgICAgICAgaW5pdF9vdXRlcl9sb29wKGdmYywgY29kX2luZm8pO1xuICAgICAgICAgICAgICAgIGlmICgwICE9IHF1cHZ0LmNhbGNfeG1pbihnZnAsIHJhdGlvW2dyXVtjaF0sIGNvZF9pbmZvLFxuICAgICAgICAgICAgICAgICAgICAgICAgbDNfeG1pbltncl1bY2hdKSlcbiAgICAgICAgICAgICAgICAgICAgYW5hbG9nX3NpbGVuY2UgPSAwO1xuXG4gICAgICAgICAgICAgICAgYml0cyArPSBtYXhfYml0c1tncl1bY2hdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuICAgICAgICAgICAgZm9yICh2YXIgY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoYml0cyA+IG1heGltdW1fZnJhbWViaXRzKSB7XG4gICAgICAgICAgICAgICAgICAgIG1heF9iaXRzW2dyXVtjaF0gKj0gbWF4aW11bV9mcmFtZWJpdHM7XG4gICAgICAgICAgICAgICAgICAgIG1heF9iaXRzW2dyXVtjaF0gLz0gYml0cztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIGZvciBjaCAqL1xuICAgICAgICB9XG4gICAgICAgIC8qIGZvciBnciAqL1xuXG4gICAgICAgIHJldHVybiBhbmFsb2dfc2lsZW5jZTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogY2FsY3VsYXRlcyB0YXJnZXQgYml0cyBmb3IgQUJSIGVuY29kaW5nXG4gICAgICpcbiAgICAgKiBtdCAyMDAwLzA1LzMxXG4gICAgICovXG4gICAgdGhpcy5jYWxjX3RhcmdldF9iaXRzID0gZnVuY3Rpb24gKGdmcCwgcGUsIG1zX2VuZXJfcmF0aW8sIHRhcmdfYml0cywgYW5hbG9nX3NpbGVuY2VfYml0cywgbWF4X2ZyYW1lX2JpdHMpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGwzX3NpZGUgPSBnZmMubDNfc2lkZTtcbiAgICAgICAgdmFyIHJlc19mYWN0b3I7XG4gICAgICAgIHZhciBnciwgY2gsIHRvdGJpdHMsIG1lYW5fYml0cyA9IDA7XG5cbiAgICAgICAgZ2ZjLmJpdHJhdGVfaW5kZXggPSBnZmMuVkJSX21heF9iaXRyYXRlO1xuICAgICAgICB2YXIgbWIgPSBuZXcgTWVhbkJpdHMobWVhbl9iaXRzKTtcbiAgICAgICAgbWF4X2ZyYW1lX2JpdHNbMF0gPSBydi5SZXN2RnJhbWVCZWdpbihnZnAsIG1iKTtcbiAgICAgICAgbWVhbl9iaXRzID0gbWIuYml0cztcblxuICAgICAgICBnZmMuYml0cmF0ZV9pbmRleCA9IDE7XG4gICAgICAgIG1lYW5fYml0cyA9IGJzLmdldGZyYW1lYml0cyhnZnApIC0gZ2ZjLnNpZGVpbmZvX2xlbiAqIDg7XG4gICAgICAgIGFuYWxvZ19zaWxlbmNlX2JpdHNbMF0gPSBtZWFuX2JpdHMgLyAoZ2ZjLm1vZGVfZ3IgKiBnZmMuY2hhbm5lbHNfb3V0KTtcblxuICAgICAgICBtZWFuX2JpdHMgPSBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzICogZ2ZwLmZyYW1lc2l6ZSAqIDEwMDA7XG4gICAgICAgIGlmICgoZ2ZjLnN1YnN0ZXBfc2hhcGluZyAmIDEpICE9IDApXG4gICAgICAgICAgICBtZWFuX2JpdHMgKj0gMS4wOTtcbiAgICAgICAgbWVhbl9iaXRzIC89IGdmcC5vdXRfc2FtcGxlcmF0ZTtcbiAgICAgICAgbWVhbl9iaXRzIC09IGdmYy5zaWRlaW5mb19sZW4gKiA4O1xuICAgICAgICBtZWFuX2JpdHMgLz0gKGdmYy5tb2RlX2dyICogZ2ZjLmNoYW5uZWxzX291dCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIDxQUkU+XG4gICAgICAgICAqICAgICAgICAgICByZXNfZmFjdG9yIGlzIHRoZSBwZXJjZW50YWdlIG9mIHRoZSB0YXJnZXQgYml0cmF0ZSB0aGF0IHNob3VsZFxuICAgICAgICAgKiAgICAgICAgICAgYmUgdXNlZCBvbiBhdmVyYWdlLiAgdGhlIHJlbWFpbmluZyBiaXRzIGFyZSBhZGRlZCB0byB0aGVcbiAgICAgICAgICogICAgICAgICAgIGJpdHJlc2Vydm9pciBhbmQgdXNlZCBmb3IgZGlmZmljdWx0IHRvIGVuY29kZSBmcmFtZXMuXG4gICAgICAgICAqXG4gICAgICAgICAqICAgICAgICAgICBTaW5jZSB3ZSBhcmUgdHJhY2tpbmcgdGhlIGF2ZXJhZ2UgYml0cmF0ZSwgd2Ugc2hvdWxkIGFkanVzdFxuICAgICAgICAgKiAgICAgICAgICAgcmVzX2ZhY3RvciBcIm9uIHRoZSBmbHlcIiwgaW5jcmVhc2luZyBpdCBpZiB0aGUgYXZlcmFnZSBiaXRyYXRlXG4gICAgICAgICAqICAgICAgICAgICBpcyBncmVhdGVyIHRoYW4gdGhlIHJlcXVlc3RlZCBiaXRyYXRlLCBhbmQgZGVjcmVhc2luZyBpdFxuICAgICAgICAgKiAgICAgICAgICAgb3RoZXJ3aXNlLiAgUmVhc29uYWJsZSByYW5nZXMgYXJlIGZyb20gLjkgdG8gMS4wXG4gICAgICAgICAqXG4gICAgICAgICAqICAgICAgICAgICBVbnRpbCB3ZSBnZXQgdGhlIGFib3ZlIHN1Z2dlc3Rpb24gd29ya2luZywgd2UgdXNlIHRoZSBmb2xsb3dpbmdcbiAgICAgICAgICogICAgICAgICAgIHR1bmluZzpcbiAgICAgICAgICogICAgICAgICAgIGNvbXByZXNzaW9uIHJhdGlvICAgIHJlc19mYWN0b3JcbiAgICAgICAgICogICAgICAgICAgIDUuNSAgKDI1NmticHMpICAgICAgICAgMS4wICAgICAgbm8gbmVlZCBmb3IgYml0cmVzZXJ2b2lyXG4gICAgICAgICAqICAgICAgICAgICAxMSAgICgxMjhrYnBzKSAgICAgICAgIC45MyAgICAgIDclIGhlbGQgZm9yIHJlc2Vydm9pclxuICAgICAgICAgKlxuICAgICAgICAgKiAgICAgICAgICAgd2l0aCBsaW5lYXIgaW50ZXJwb2xhdGlvbiBmb3Igb3RoZXIgdmFsdWVzLlxuICAgICAgICAgKiA8L1BSRT5cbiAgICAgICAgICovXG4gICAgICAgIHJlc19mYWN0b3IgPSAuOTMgKyAuMDcgKiAoMTEuMCAtIGdmcC5jb21wcmVzc2lvbl9yYXRpbylcbiAgICAgICAgICAgIC8gKDExLjAgLSA1LjUpO1xuICAgICAgICBpZiAocmVzX2ZhY3RvciA8IC45MClcbiAgICAgICAgICAgIHJlc19mYWN0b3IgPSAuOTA7XG4gICAgICAgIGlmIChyZXNfZmFjdG9yID4gMS4wMClcbiAgICAgICAgICAgIHJlc19mYWN0b3IgPSAxLjAwO1xuXG4gICAgICAgIGZvciAoZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG4gICAgICAgICAgICB2YXIgc3VtID0gMDtcbiAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICB0YXJnX2JpdHNbZ3JdW2NoXSA9IChpbnQpKHJlc19mYWN0b3IgKiBtZWFuX2JpdHMpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHBlW2dyXVtjaF0gPiA3MDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFkZF9iaXRzID0gKGludCkoKHBlW2dyXVtjaF0gLSA3MDApIC8gMS40KTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY29kX2luZm8gPSBsM19zaWRlLnR0W2dyXVtjaF07XG4gICAgICAgICAgICAgICAgICAgIHRhcmdfYml0c1tncl1bY2hdID0gKGludCkocmVzX2ZhY3RvciAqIG1lYW5fYml0cyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLyogc2hvcnQgYmxvY2tzIHVzZSBhIGxpdHRsZSBleHRyYSwgbm8gbWF0dGVyIHdoYXQgdGhlIHBlICovXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb2RfaW5mby5ibG9ja190eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFkZF9iaXRzIDwgbWVhbl9iaXRzIC8gMilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGRfYml0cyA9IG1lYW5fYml0cyAvIDI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLyogYXQgbW9zdCBpbmNyZWFzZSBiaXRzIGJ5IDEuNSphdmVyYWdlICovXG4gICAgICAgICAgICAgICAgICAgIGlmIChhZGRfYml0cyA+IG1lYW5fYml0cyAqIDMgLyAyKVxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkX2JpdHMgPSBtZWFuX2JpdHMgKiAzIC8gMjtcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoYWRkX2JpdHMgPCAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgYWRkX2JpdHMgPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgIHRhcmdfYml0c1tncl1bY2hdICs9IGFkZF9iaXRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGFyZ19iaXRzW2dyXVtjaF0gPiBMYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfQ0hBTk5FTCkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnX2JpdHNbZ3JdW2NoXSA9IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9DSEFOTkVMO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdW0gKz0gdGFyZ19iaXRzW2dyXVtjaF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBmb3IgY2ggKi9cbiAgICAgICAgICAgIGlmIChzdW0gPiBMYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfR1JBTlVMRSkge1xuICAgICAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7ICsrY2gpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ19iaXRzW2dyXVtjaF0gKj0gTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0dSQU5VTEU7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdfYml0c1tncl1bY2hdIC89IHN1bTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyogZm9yIGdyICovXG5cbiAgICAgICAgaWYgKGdmYy5tb2RlX2V4dCA9PSBFbmNvZGVyLk1QR19NRF9NU19MUilcbiAgICAgICAgICAgIGZvciAoZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG4gICAgICAgICAgICAgICAgcXVwdnQucmVkdWNlX3NpZGUodGFyZ19iaXRzW2dyXSwgbXNfZW5lcl9yYXRpb1tncl0sIG1lYW5fYml0c1xuICAgICAgICAgICAgICAgICAgICAqIGdmYy5jaGFubmVsc19vdXQsXG4gICAgICAgICAgICAgICAgICAgIExhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9HUkFOVUxFKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAvKlxuICAgICAgICAgKiBzdW0gdGFyZ2V0IGJpdHNcbiAgICAgICAgICovXG4gICAgICAgIHRvdGJpdHMgPSAwO1xuICAgICAgICBmb3IgKGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgIGlmICh0YXJnX2JpdHNbZ3JdW2NoXSA+IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9DSEFOTkVMKVxuICAgICAgICAgICAgICAgICAgICB0YXJnX2JpdHNbZ3JdW2NoXSA9IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9DSEFOTkVMO1xuICAgICAgICAgICAgICAgIHRvdGJpdHMgKz0gdGFyZ19iaXRzW2dyXVtjaF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKlxuICAgICAgICAgKiByZXBhcnRpb24gdGFyZ2V0IGJpdHMgaWYgbmVlZGVkXG4gICAgICAgICAqL1xuICAgICAgICBpZiAodG90Yml0cyA+IG1heF9mcmFtZV9iaXRzWzBdKSB7XG4gICAgICAgICAgICBmb3IgKGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuICAgICAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ19iaXRzW2dyXVtjaF0gKj0gbWF4X2ZyYW1lX2JpdHNbMF07XG4gICAgICAgICAgICAgICAgICAgIHRhcmdfYml0c1tncl1bY2hdIC89IHRvdGJpdHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG59XG5cbi8qXG4gKiAgICAgIE1QMyB3aW5kb3cgc3ViYmFuZCAtPiBzdWJiYW5kIGZpbHRlcmluZyAtPiBtZGN0IHJvdXRpbmVcbiAqXG4gKiAgICAgIENvcHlyaWdodCAoYykgMTk5OS0yMDAwIFRha2VoaXJvIFRvbWluYWdhXG4gKlxuICpcbiAqIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3JcbiAqIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWNcbiAqIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlclxuICogdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLlxuICpcbiAqIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLFxuICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2ZcbiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VXG4gKiBMaWJyYXJ5IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cbiAqXG4gKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGlicmFyeSBHZW5lcmFsIFB1YmxpY1xuICogTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCB3cml0ZSB0byB0aGVcbiAqIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgSW5jLiwgNTkgVGVtcGxlIFBsYWNlIC0gU3VpdGUgMzMwLFxuICogQm9zdG9uLCBNQSAwMjExMS0xMzA3LCBVU0EuXG4gKi9cbi8qXG4gKiAgICAgICAgIFNwZWNpYWwgVGhhbmtzIHRvIFBhdHJpY2sgRGUgU21ldCBmb3IgeW91ciBhZHZpY2VzLlxuICovXG5cbi8qICRJZDogTmV3TURDVC5qYXZhLHYgMS4xMSAyMDExLzA1LzI0IDIwOjQ4OjA2IGtlbmNoaXMgRXhwICQgKi9cblxuLy9wYWNrYWdlIG1wMztcblxuLy9pbXBvcnQgamF2YS51dGlsLkFycmF5cztcblxuXG5cbmZ1bmN0aW9uIE5ld01EQ1QoKSB7XG5cblx0dmFyIGVud2luZG93ID0gW1xuXHRcdFx0LTQuNzdlLTA3ICogMC43NDA5NTExMjUzNTQ5NTkgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjAzOTUxZS0wNCAqIDAuNzQwOTUxMTI1MzU0OTU5IC8gMi4zODRlLTA2LFxuXHRcdFx0OS41MzY3NGUtMDQgKiAwLjc0MDk1MTEyNTM1NDk1OSAvIDIuMzg0ZS0wNixcblx0XHRcdDIuODQxNDczZS0wMyAqIDAuNzQwOTUxMTI1MzU0OTU5IC8gMi4zODRlLTA2LFxuXHRcdFx0My41NzU4OTcyZS0wMiAqIDAuNzQwOTUxMTI1MzU0OTU5IC8gMi4zODRlLTA2LFxuXHRcdFx0My40MDE3NTZlLTAzICogMC43NDA5NTExMjUzNTQ5NTkgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjgzNzE1ZS0wNCAqIDAuNzQwOTUxMTI1MzU0OTU5IC8gMi4zODRlLTA2LFxuXHRcdFx0OS45MTgyZS0wNSAqIDAuNzQwOTUxMTI1MzU0OTU5IC8gMi4zODRlLTA2LCAvKiAxNSAqL1xuXHRcdFx0MS4yMzk4ZS0wNSAqIDAuNzQwOTUxMTI1MzU0OTU5IC8gMi4zODRlLTA2LFxuXHRcdFx0MS45MTIxMmUtMDQgKiAwLjc0MDk1MTEyNTM1NDk1OSAvIDIuMzg0ZS0wNixcblx0XHRcdDIuMjgzMDk2ZS0wMyAqIDAuNzQwOTUxMTI1MzU0OTU5IC8gMi4zODRlLTA2LFxuXHRcdFx0MS42OTk0NDc2ZS0wMiAqIDAuNzQwOTUxMTI1MzU0OTU5IC8gMi4zODRlLTA2LFxuXHRcdFx0LTEuODc1Njg2NmUtMDIgKiAwLjc0MDk1MTEyNTM1NDk1OSAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjYzMDcxMWUtMDMgKiAwLjc0MDk1MTEyNTM1NDk1OSAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjQ3NDc4ZS0wNCAqIDAuNzQwOTUxMTI1MzU0OTU5IC8gMi4zODRlLTA2LFxuXHRcdFx0LTEuNDc4MmUtMDUgKiAwLjc0MDk1MTEyNTM1NDk1OSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuMDYzNDcxNjkwMTkxNDcxZS0wMSwgMS45NjAzNDI4MDY1OTEyMTNlLTAxLFxuXG5cdFx0XHQtNC43N2UtMDcgKiAwLjc3MzAxMDQ1MzM2MjczNyAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMDU4NThlLTA0ICogMC43NzMwMTA0NTMzNjI3MzcgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjMwNzg2ZS0wNCAqIDAuNzczMDEwNDUzMzYyNzM3IC8gMi4zODRlLTA2LFxuXHRcdFx0Mi41MjE1MTVlLTAzICogMC43NzMwMTA0NTMzNjI3MzcgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjU2OTQxMjJlLTAyICogMC43NzMwMTA0NTMzNjI3MzcgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjY0MzAzNmUtMDMgKiAwLjc3MzAxMDQ1MzM2MjczNyAvIDIuMzg0ZS0wNixcblx0XHRcdDkuOTE4MjFlLTA0ICogMC43NzMwMTA0NTMzNjI3MzcgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjYzMjFlLTA1ICogMC43NzMwMTA0NTMzNjI3MzcgLyAyLjM4NGUtMDYsIC8qIDE0ICovXG5cdFx0XHQxLjE0NDRlLTA1ICogMC43NzMwMTA0NTMzNjI3MzcgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjY1NDYyZS0wNCAqIDAuNzczMDEwNDUzMzYyNzM3IC8gMi4zODRlLTA2LFxuXHRcdFx0Mi4xMTAwMDRlLTAzICogMC43NzMwMTA0NTMzNjI3MzcgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjYxMTI4MDRlLTAyICogMC43NzMwMTA0NTMzNjI3MzcgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMS45NjM0MjQ3ZS0wMiAqIDAuNzczMDEwNDUzMzYyNzM3IC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuODAzMzI2ZS0wMyAqIDAuNzczMDEwNDUzMzYyNzM3IC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuNzcwNDJlLTA0ICogMC43NzMwMTA0NTMzNjI3MzcgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMS42Njg5ZS0wNSAqIDAuNzczMDEwNDUzMzYyNzM3IC8gMi4zODRlLTA2LFxuXHRcdFx0OC4yMDY3ODc5MDgyODY2MDJlLTAxLCAzLjkwMTgwNjQ0MDMyMjU2N2UtMDEsXG5cblx0XHRcdC00Ljc3ZS0wNyAqIDAuODAzMjA3NTMxNDgwNjQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0MS4wNzI4OGUtMDQgKiAwLjgwMzIwNzUzMTQ4MDY0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuMDI2NTNlLTA0ICogMC44MDMyMDc1MzE0ODA2NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQyLjE3NDg1NGUtMDMgKiAwLjgwMzIwNzUzMTQ4MDY0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDMuNTU4NjM1N2UtMDIgKiAwLjgwMzIwNzUzMTQ4MDY0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDMuODU4NTY2ZS0wMyAqIDAuODAzMjA3NTMxNDgwNjQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0OS45NTE1OWUtMDQgKiAwLjgwMzIwNzUzMTQ4MDY0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuMzQ2MGUtMDUgKiAwLjgwMzIwNzUzMTQ4MDY0NSAvIDIuMzg0ZS0wNiwgLyogMTMgKi9cblx0XHRcdDEuMDAxNGUtMDUgKiAwLjgwMzIwNzUzMTQ4MDY0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuNDAxOTBlLTA0ICogMC44MDMyMDc1MzE0ODA2NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjkzNzM4OWUtMDMgKiAwLjgwMzIwNzUzMTQ4MDY0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuNTIzMzUxN2UtMDIgKiAwLjgwMzIwNzUzMTQ4MDY0NSAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjA1MDY4NTllLTAyICogMC44MDMyMDc1MzE0ODA2NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi45NzQwMzNlLTAzICogMC44MDMyMDc1MzE0ODA2NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMy4wNzU2MGUtMDQgKiAwLjgwMzIwNzUzMTQ4MDY0NSAvIDIuMzg0ZS0wNixcblx0XHRcdC0xLjgxMjBlLTA1ICogMC44MDMyMDc1MzE0ODA2NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ3LjQxNjUwNTQ2MjcyMDM1M2UtMDEsIDUuODA1NjkzNTQ1MDg5MjQ5ZS0wMSxcblxuXHRcdFx0LTQuNzdlLTA3ICogMC44MzE0Njk2MTIzMDI1NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjA4MjQyZS0wNCAqIDAuODMxNDY5NjEyMzAyNTQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0OC42ODc5N2UtMDQgKiAwLjgzMTQ2OTYxMjMwMjU0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuODAwNTM3ZS0wMyAqIDAuODMxNDY5NjEyMzAyNTQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0My41NDM1MjAwZS0wMiAqIDAuODMxNDY5NjEyMzAyNTQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0NC4wNDkzMDFlLTAzICogMC44MzE0Njk2MTIzMDI1NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5Ljk0MjA1ZS0wNCAqIDAuODMxNDY5NjEyMzAyNTQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0OS4wNTk5ZS0wNSAqIDAuODMxNDY5NjEyMzAyNTQ1IC8gMi4zODRlLTA2LCAvKiAxMiAqL1xuXHRcdFx0OS4wNjBlLTA2ICogMC44MzE0Njk2MTIzMDI1NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjE2MzQ4ZS0wNCAqIDAuODMxNDY5NjEyMzAyNTQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0MS43NjY2ODJlLTAzICogMC44MzE0Njk2MTIzMDI1NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjQzNTg1MjFlLTAyICogMC44MzE0Njk2MTIzMDI1NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi4xMzcyMzE4ZS0wMiAqIDAuODMxNDY5NjEyMzAyNTQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0LTMuMTQxODhlLTAzICogMC44MzE0Njk2MTIzMDI1NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMy4zOTAzMWUtMDQgKiAwLjgzMTQ2OTYxMjMwMjU0NSAvIDIuMzg0ZS0wNixcblx0XHRcdC0xLjk1NTBlLTA1ICogMC44MzE0Njk2MTIzMDI1NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ2LjY4MTc4NjM3OTE5Mjk4OWUtMDEsIDcuNjUzNjY4NjQ3MzAxNzk3ZS0wMSxcblxuXHRcdFx0LTQuNzdlLTA3ICogMC44NTc3Mjg2MTAwMDAyNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjA4NzE5ZS0wNCAqIDAuODU3NzI4NjEwMDAwMjcyIC8gMi4zODRlLTA2LFxuXHRcdFx0OC4yOTIyMGUtMDQgKiAwLjg1NzcyODYxMDAwMDI3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMzk5NTE3ZS0wMyAqIDAuODU3NzI4NjEwMDAwMjcyIC8gMi4zODRlLTA2LFxuXHRcdFx0My41MjQyMDgxZS0wMiAqIDAuODU3NzI4NjEwMDAwMjcyIC8gMi4zODRlLTA2LFxuXHRcdFx0NC4yMTUyNDBlLTAzICogMC44NTc3Mjg2MTAwMDAyNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5Ljg5NDM3ZS0wNCAqIDAuODU3NzI4NjEwMDAwMjcyIC8gMi4zODRlLTA2LFxuXHRcdFx0OC43MjYxZS0wNSAqIDAuODU3NzI4NjEwMDAwMjcyIC8gMi4zODRlLTA2LCAvKiAxMSAqL1xuXHRcdFx0OC4xMDZlLTA2ICogMC44NTc3Mjg2MTAwMDAyNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjM5MzdlLTA1ICogMC44NTc3Mjg2MTAwMDAyNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjU5Nzg4MWUtMDMgKiAwLjg1NzcyODYxMDAwMDI3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMzQ4OTI0NmUtMDIgKiAwLjg1NzcyODYxMDAwMDI3MiAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjIyMjg3MThlLTAyICogMC44NTc3Mjg2MTAwMDAyNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMy4zMDY4NjZlLTAzICogMC44NTc3Mjg2MTAwMDAyNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMy43MTQ1NmUtMDQgKiAwLjg1NzcyODYxMDAwMDI3MiAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjE0NThlLTA1ICogMC44NTc3Mjg2MTAwMDAyNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQ1Ljk5Mzc2OTMzNjgxOTIzN2UtMDEsIDkuNDI3OTM0NzM2NTE5OTU0ZS0wMSxcblxuXHRcdFx0LTQuNzdlLTA3ICogMC44ODE5MjEyNjQzNDgzNTUgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjA4NzE5ZS0wNCAqIDAuODgxOTIxMjY0MzQ4MzU1IC8gMi4zODRlLTA2LFxuXHRcdFx0Ny44MzkyZS0wNCAqIDAuODgxOTIxMjY0MzQ4MzU1IC8gMi4zODRlLTA2LFxuXHRcdFx0OS43MTMxN2UtMDQgKiAwLjg4MTkyMTI2NDM0ODM1NSAvIDIuMzg0ZS0wNixcblx0XHRcdDMuNTAwNzAwMGUtMDIgKiAwLjg4MTkyMTI2NDM0ODM1NSAvIDIuMzg0ZS0wNixcblx0XHRcdDQuMzU3ODE1ZS0wMyAqIDAuODgxOTIxMjY0MzQ4MzU1IC8gMi4zODRlLTA2LFxuXHRcdFx0OS44MDg1NGUtMDQgKiAwLjg4MTkyMTI2NDM0ODM1NSAvIDIuMzg0ZS0wNixcblx0XHRcdDguMzkyM2UtMDUgKiAwLjg4MTkyMTI2NDM0ODM1NSAvIDIuMzg0ZS0wNiwgLyogMTAgKi9cblx0XHRcdDcuNjI5ZS0wNiAqIDAuODgxOTIxMjY0MzQ4MzU1IC8gMi4zODRlLTA2LFxuXHRcdFx0Ny4yOTU2ZS0wNSAqIDAuODgxOTIxMjY0MzQ4MzU1IC8gMi4zODRlLTA2LFxuXHRcdFx0MS40MzI0MTllLTAzICogMC44ODE5MjEyNjQzNDgzNTUgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjI2Mjc2MDJlLTAyICogMC44ODE5MjEyNjQzNDgzNTUgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi4zMDc0MTUwZS0wMiAqIDAuODgxOTIxMjY0MzQ4MzU1IC8gMi4zODRlLTA2LFxuXHRcdFx0LTMuNDY3MDgzZS0wMyAqIDAuODgxOTIxMjY0MzQ4MzU1IC8gMi4zODRlLTA2LFxuXHRcdFx0LTQuMDQzNThlLTA0ICogMC44ODE5MjEyNjQzNDgzNTUgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi4zMzY1ZS0wNSAqIDAuODgxOTIxMjY0MzQ4MzU1IC8gMi4zODRlLTA2LFxuXHRcdFx0NS4zNDUxMTEzNTk1MDc5MTZlLTAxLCAxLjExMTE0MDQ2NjAzOTIwNWUrMDAsXG5cblx0XHRcdC05LjU0ZS0wNyAqIDAuOTAzOTg5MjkzMTIzNDQzIC8gMi4zODRlLTA2LFxuXHRcdFx0MS4wODI0MmUtMDQgKiAwLjkwMzk4OTI5MzEyMzQ0MyAvIDIuMzg0ZS0wNixcblx0XHRcdDcuMzE5NDVlLTA0ICogMC45MDM5ODkyOTMxMjM0NDMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ1LjE1OTM4ZS0wNCAqIDAuOTAzOTg5MjkzMTIzNDQzIC8gMi4zODRlLTA2LFxuXHRcdFx0My40NzMwNDM0ZS0wMiAqIDAuOTAzOTg5MjkzMTIzNDQzIC8gMi4zODRlLTA2LFxuXHRcdFx0NC40NzcwMjRlLTAzICogMC45MDM5ODkyOTMxMjM0NDMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjY4OTMzZS0wNCAqIDAuOTAzOTg5MjkzMTIzNDQzIC8gMi4zODRlLTA2LFxuXHRcdFx0OC4wNTg1ZS0wNSAqIDAuOTAzOTg5MjkzMTIzNDQzIC8gMi4zODRlLTA2LCAvKiA5ICovXG5cdFx0XHQ2LjY3NmUtMDYgKiAwLjkwMzk4OTI5MzEyMzQ0MyAvIDIuMzg0ZS0wNixcblx0XHRcdDUuMjkyOWUtMDUgKiAwLjkwMzk4OTI5MzEyMzQ0MyAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMjY5ODE3ZS0wMyAqIDAuOTAzOTg5MjkzMTIzNDQzIC8gMi4zODRlLTA2LFxuXHRcdFx0MS4xNzc1MDE3ZS0wMiAqIDAuOTAzOTg5MjkzMTIzNDQzIC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuMzkwNzE4NWUtMDIgKiAwLjkwMzk4OTI5MzEyMzQ0MyAvIDIuMzg0ZS0wNixcblx0XHRcdC0zLjYyMjUzMmUtMDMgKiAwLjkwMzk4OTI5MzEyMzQ0MyAvIDIuMzg0ZS0wNixcblx0XHRcdC00LjM4MjEzZS0wNCAqIDAuOTAzOTg5MjkzMTIzNDQzIC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuNTI3MmUtMDUgKiAwLjkwMzk4OTI5MzEyMzQ0MyAvIDIuMzg0ZS0wNixcblx0XHRcdDQuNzI5NjQ3NzU4OTEzMTk5ZS0wMSwgMS4yNjg3ODY1NjgzMjcyOTFlKzAwLFxuXG5cdFx0XHQtOS41NGUtMDcgKiAwLjkyMzg3OTUzMjUxMTI4Njc1NjEzIC8gMi4zODRlLTA2LFxuXHRcdFx0MS4wNjgxMmUtMDQgKiAwLjkyMzg3OTUzMjUxMTI4Njc1NjEzIC8gMi4zODRlLTA2LFxuXHRcdFx0Ni43NDI0OGUtMDQgKiAwLjkyMzg3OTUzMjUxMTI4Njc1NjEzIC8gMi4zODRlLTA2LFxuXHRcdFx0My4zMzc5ZS0wNSAqIDAuOTIzODc5NTMyNTExMjg2NzU2MTMgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjQ0MTI4NjFlLTAyICogMC45MjM4Nzk1MzI1MTEyODY3NTYxMyAvIDIuMzg0ZS0wNixcblx0XHRcdDQuNTczODIyZS0wMyAqIDAuOTIzODc5NTMyNTExMjg2NzU2MTMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjU0MTUxZS0wNCAqIDAuOTIzODc5NTMyNTExMjg2NzU2MTMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ3LjY3NzFlLTA1ICogMC45MjM4Nzk1MzI1MTEyODY3NTYxMyAvIDIuMzg0ZS0wNixcblx0XHRcdDYuMTk5ZS0wNiAqIDAuOTIzODc5NTMyNTExMjg2NzU2MTMgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjQzMzJlLTA1ICogMC45MjM4Nzk1MzI1MTEyODY3NTYxMyAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMTExMDMxZS0wMyAqIDAuOTIzODc5NTMyNTExMjg2NzU2MTMgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjA5MzMzOTllLTAyICogMC45MjM4Nzk1MzI1MTEyODY3NTYxMyAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjQ3MjU0MzdlLTAyICogMC45MjM4Nzk1MzI1MTEyODY3NTYxMyAvIDIuMzg0ZS0wNixcblx0XHRcdC0zLjc3MTc4MmUtMDMgKiAwLjkyMzg3OTUzMjUxMTI4Njc1NjEzIC8gMi4zODRlLTA2LFxuXHRcdFx0LTQuNzI1NDZlLTA0ICogMC45MjM4Nzk1MzI1MTEyODY3NTYxMyAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjc2NTdlLTA1ICogMC45MjM4Nzk1MzI1MTEyODY3NTYxMyAvIDIuMzg0ZS0wNixcblx0XHRcdDQuMTQyMTM1NjIzNzMwOTUwNDg3OWUtMDEsIC8qIHRhbihQSS84KSAqL1xuXHRcdFx0MS40MTQyMTM1NjIzNzMwOTVlKzAwLFxuXG5cdFx0XHQtOS41NGUtMDcgKiAwLjk0MTU0NDA2NTE4MzAyMSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMDUzODFlLTA0ICogMC45NDE1NDQwNjUxODMwMjEgLyAyLjM4NGUtMDYsXG5cdFx0XHQ2LjEwMzUyZS0wNCAqIDAuOTQxNTQ0MDY1MTgzMDIxIC8gMi4zODRlLTA2LFxuXHRcdFx0LTQuNzU4ODNlLTA0ICogMC45NDE1NDQwNjUxODMwMjEgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjQwNTU3MTBlLTAyICogMC45NDE1NDQwNjUxODMwMjEgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0LjY0OTE2MmUtMDMgKiAwLjk0MTU0NDA2NTE4MzAyMSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuMzU1NTVlLTA0ICogMC45NDE1NDQwNjUxODMwMjEgLyAyLjM4NGUtMDYsXG5cdFx0XHQ3LjM0MzNlLTA1ICogMC45NDE1NDQwNjUxODMwMjEgLyAyLjM4NGUtMDYsIC8qIDcgKi9cblx0XHRcdDUuMjQ1ZS0wNiAqIDAuOTQxNTQ0MDY1MTgzMDIxIC8gMi4zODRlLTA2LFxuXHRcdFx0MS43MTY2ZS0wNSAqIDAuOTQxNTQ0MDY1MTgzMDIxIC8gMi4zODRlLTA2LFxuXHRcdFx0OS41NjUzNWUtMDQgKiAwLjk0MTU0NDA2NTE4MzAyMSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMDEwMzcwM2UtMDIgKiAwLjk0MTU0NDA2NTE4MzAyMSAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjU1MjcwMDBlLTAyICogMC45NDE1NDQwNjUxODMwMjEgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMy45MTQzNTZlLTAzICogMC45NDE1NDQwNjUxODMwMjEgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNS4wNzM1NWUtMDQgKiAwLjk0MTU0NDA2NTE4MzAyMSAvIDIuMzg0ZS0wNixcblx0XHRcdC0zLjAwNDFlLTA1ICogMC45NDE1NDQwNjUxODMwMjEgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjU3ODA1NzIxMzE0NTI0MWUtMDEsIDEuNTQ2MDIwOTA2NzI1NDc0ZSswMCxcblxuXHRcdFx0LTkuNTRlLTA3ICogMC45NTY5NDAzMzU3MzIyMDkgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjAyNTIwZS0wNCAqIDAuOTU2OTQwMzM1NzMyMjA5IC8gMi4zODRlLTA2LFxuXHRcdFx0NS4zOTMwM2UtMDQgKiAwLjk1Njk0MDMzNTczMjIwOSAvIDIuMzg0ZS0wNixcblx0XHRcdC0xLjAxMTg0OGUtMDMgKiAwLjk1Njk0MDMzNTczMjIwOSAvIDIuMzg0ZS0wNixcblx0XHRcdDMuMzY1OTkzNWUtMDIgKiAwLjk1Njk0MDMzNTczMjIwOSAvIDIuMzg0ZS0wNixcblx0XHRcdDQuNzAzMDQ1ZS0wMyAqIDAuOTU2OTQwMzM1NzMyMjA5IC8gMi4zODRlLTA2LFxuXHRcdFx0OS4xNTA1MWUtMDQgKiAwLjk1Njk0MDMzNTczMjIwOSAvIDIuMzg0ZS0wNixcblx0XHRcdDcuMDA5NWUtMDUgKiAwLjk1Njk0MDMzNTczMjIwOSAvIDIuMzg0ZS0wNiwgLyogNiAqL1xuXHRcdFx0NC43NjhlLTA2ICogMC45NTY5NDAzMzU3MzIyMDkgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjU0ZS0wNyAqIDAuOTU2OTQwMzM1NzMyMjA5IC8gMi4zODRlLTA2LFxuXHRcdFx0OC4wNjgwOGUtMDQgKiAwLjk1Njk0MDMzNTczMjIwOSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuMjg3ODM0ZS0wMyAqIDAuOTU2OTQwMzM1NzMyMjA5IC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuNjMxMDkyMWUtMDIgKiAwLjk1Njk0MDMzNTczMjIwOSAvIDIuMzg0ZS0wNixcblx0XHRcdC00LjA0ODgyNGUtMDMgKiAwLjk1Njk0MDMzNTczMjIwOSAvIDIuMzg0ZS0wNixcblx0XHRcdC01LjQyMTY0ZS0wNCAqIDAuOTU2OTQwMzM1NzMyMjA5IC8gMi4zODRlLTA2LFxuXHRcdFx0LTMuMjQyNWUtMDUgKiAwLjk1Njk0MDMzNTczMjIwOSAvIDIuMzg0ZS0wNixcblx0XHRcdDMuMDMzNDY2ODM2MDczNDI0ZS0wMSwgMS42NjI5MzkyMjQ2MDUwOTBlKzAwLFxuXG5cdFx0XHQtMS40MzFlLTA2ICogMC45NzAwMzEyNTMxOTQ1NDQgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjkxODJlLTA1ICogMC45NzAwMzEyNTMxOTQ1NDQgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0LjYyNTMyZS0wNCAqIDAuOTcwMDMxMjUzMTk0NTQ0IC8gMi4zODRlLTA2LFxuXHRcdFx0LTEuNTczNTYzZS0wMyAqIDAuOTcwMDMxMjUzMTk0NTQ0IC8gMi4zODRlLTA2LFxuXHRcdFx0My4zMjI1NTM2ZS0wMiAqIDAuOTcwMDMxMjUzMTk0NTQ0IC8gMi4zODRlLTA2LFxuXHRcdFx0NC43MzczNzdlLTAzICogMC45NzAwMzEyNTMxOTQ1NDQgLyAyLjM4NGUtMDYsXG5cdFx0XHQ4LjkxNjg1ZS0wNCAqIDAuOTcwMDMxMjUzMTk0NTQ0IC8gMi4zODRlLTA2LFxuXHRcdFx0Ni42MjgwZS0wNSAqIDAuOTcwMDMxMjUzMTk0NTQ0IC8gMi4zODRlLTA2LCAvKiA1ICovXG5cdFx0XHQ0LjI5MmUtMDYgKiAwLjk3MDAzMTI1MzE5NDU0NCAvIDIuMzg0ZS0wNixcblx0XHRcdC0xLjM4MjhlLTA1ICogMC45NzAwMzEyNTMxOTQ1NDQgLyAyLjM4NGUtMDYsXG5cdFx0XHQ2LjYxODUwZS0wNCAqIDAuOTcwMDMxMjUzMTk0NTQ0IC8gMi4zODRlLTA2LFxuXHRcdFx0OC40ODcyMjVlLTAzICogMC45NzAwMzEyNTMxOTQ1NDQgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi43MDczODYwZS0wMiAqIDAuOTcwMDMxMjUzMTk0NTQ0IC8gMi4zODRlLTA2LFxuXHRcdFx0LTQuMTc0NzA5ZS0wMyAqIDAuOTcwMDMxMjUzMTk0NTQ0IC8gMi4zODRlLTA2LFxuXHRcdFx0LTUuNzY5NzNlLTA0ICogMC45NzAwMzEyNTMxOTQ1NDQgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMy40ODA5ZS0wNSAqIDAuOTcwMDMxMjUzMTk0NTQ0IC8gMi4zODRlLTA2LFxuXHRcdFx0Mi41MDQ4Njk2MDE5MTMwNTVlLTAxLCAxLjc2Mzg0MjUyODY5NjcxMGUrMDAsXG5cblx0XHRcdC0xLjQzMWUtMDYgKiAwLjk4MDc4NTI4MDQwMzIzIC8gMi4zODRlLTA2LFxuXHRcdFx0OS41MzY3ZS0wNSAqIDAuOTgwNzg1MjgwNDAzMjMgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjc4NjA5ZS0wNCAqIDAuOTgwNzg1MjgwNDAzMjMgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi4xNjE1MDNlLTAzICogMC45ODA3ODUyODA0MDMyMyAvIDIuMzg0ZS0wNixcblx0XHRcdDMuMjc1NDg5OGUtMDIgKiAwLjk4MDc4NTI4MDQwMzIzIC8gMi4zODRlLTA2LFxuXHRcdFx0NC43NTIxNTllLTAzICogMC45ODA3ODUyODA0MDMyMyAvIDIuMzg0ZS0wNixcblx0XHRcdDguNjY0MTNlLTA0ICogMC45ODA3ODUyODA0MDMyMyAvIDIuMzg0ZS0wNixcblx0XHRcdDYuMjk0M2UtMDUgKiAwLjk4MDc4NTI4MDQwMzIzIC8gMi4zODRlLTA2LCAvKiA0ICovXG5cdFx0XHQzLjgxNWUtMDYgKiAwLjk4MDc4NTI4MDQwMzIzIC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuNzE4ZS0wNSAqIDAuOTgwNzg1MjgwNDAzMjMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ1LjIyMTM3ZS0wNCAqIDAuOTgwNzg1MjgwNDAzMjMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ3LjcwMzMwNGUtMDMgKiAwLjk4MDc4NTI4MDQwMzIzIC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuNzgxNTM0MmUtMDIgKiAwLjk4MDc4NTI4MDQwMzIzIC8gMi4zODRlLTA2LFxuXHRcdFx0LTQuMjkwNTgxZS0wMyAqIDAuOTgwNzg1MjgwNDAzMjMgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNi4xMTc4MmUtMDQgKiAwLjk4MDc4NTI4MDQwMzIzIC8gMi4zODRlLTA2LFxuXHRcdFx0LTMuNzY3MGUtMDUgKiAwLjk4MDc4NTI4MDQwMzIzIC8gMi4zODRlLTA2LFxuXHRcdFx0MS45ODkxMjM2NzM3OTY1ODBlLTAxLCAxLjg0Nzc1OTA2NTAyMjU3M2UrMDAsXG5cblx0XHRcdC0xLjkwN2UtMDYgKiAwLjk4OTE3NjUwOTk2NDc4MSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuMDEyMmUtMDUgKiAwLjk4OTE3NjUwOTk2NDc4MSAvIDIuMzg0ZS0wNixcblx0XHRcdDIuODg0ODZlLTA0ICogMC45ODkxNzY1MDk5NjQ3ODEgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi43NzQyMzllLTAzICogMC45ODkxNzY1MDk5NjQ3ODEgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjIyNDgwMjBlLTAyICogMC45ODkxNzY1MDk5NjQ3ODEgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0Ljc0ODgyMWUtMDMgKiAwLjk4OTE3NjUwOTk2NDc4MSAvIDIuMzg0ZS0wNixcblx0XHRcdDguMzg3NTdlLTA0ICogMC45ODkxNzY1MDk5NjQ3ODEgLyAyLjM4NGUtMDYsXG5cdFx0XHQ1Ljk2MDVlLTA1ICogMC45ODkxNzY1MDk5NjQ3ODEgLyAyLjM4NGUtMDYsIC8qIDMgKi9cblx0XHRcdDMuMzM4ZS0wNiAqIDAuOTg5MTc2NTA5OTY0NzgxIC8gMi4zODRlLTA2LFxuXHRcdFx0LTMuOTU3N2UtMDUgKiAwLjk4OTE3NjUwOTk2NDc4MSAvIDIuMzg0ZS0wNixcblx0XHRcdDMuODgxNDVlLTA0ICogMC45ODkxNzY1MDk5NjQ3ODEgLyAyLjM4NGUtMDYsXG5cdFx0XHQ2LjkzNzAyN2UtMDMgKiAwLjk4OTE3NjUwOTk2NDc4MSAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjg1MzI5ODJlLTAyICogMC45ODkxNzY1MDk5NjQ3ODEgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNC4zOTU5NjJlLTAzICogMC45ODkxNzY1MDk5NjQ3ODEgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNi40NjU5MWUtMDQgKiAwLjk4OTE3NjUwOTk2NDc4MSAvIDIuMzg0ZS0wNixcblx0XHRcdC00LjA1MzFlLTA1ICogMC45ODkxNzY1MDk5NjQ3ODEgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjQ4MzM1OTg3NTM4MzQ3NGUtMDEsIDEuOTEzODgwNjcxNDY0NDE4ZSswMCxcblxuXHRcdFx0LTEuOTA3ZS0wNiAqIDAuOTk1MTg0NzI2NjcyMTk3IC8gMi4zODRlLTA2LFxuXHRcdFx0OC40NDAwZS0wNSAqIDAuOTk1MTg0NzI2NjcyMTk3IC8gMi4zODRlLTA2LFxuXHRcdFx0MS45MTY4OWUtMDQgKiAwLjk5NTE4NDcyNjY3MjE5NyAvIDIuMzg0ZS0wNixcblx0XHRcdC0zLjQxMTI5M2UtMDMgKiAwLjk5NTE4NDcyNjY3MjE5NyAvIDIuMzg0ZS0wNixcblx0XHRcdDMuMTcwNjgxMGUtMDIgKiAwLjk5NTE4NDcyNjY3MjE5NyAvIDIuMzg0ZS0wNixcblx0XHRcdDQuNzI4MzE3ZS0wMyAqIDAuOTk1MTg0NzI2NjcyMTk3IC8gMi4zODRlLTA2LFxuXHRcdFx0OC4wOTY2OWUtMDQgKiAwLjk5NTE4NDcyNjY3MjE5NyAvIDIuMzg0ZS0wNixcblx0XHRcdDUuNTc5ZS0wNSAqIDAuOTk1MTg0NzI2NjcyMTk3IC8gMi4zODRlLTA2LFxuXHRcdFx0My4zMzhlLTA2ICogMC45OTUxODQ3MjY2NzIxOTcgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNS4wNTQ1ZS0wNSAqIDAuOTk1MTg0NzI2NjcyMTk3IC8gMi4zODRlLTA2LFxuXHRcdFx0Mi41OTg3NmUtMDQgKiAwLjk5NTE4NDcyNjY3MjE5NyAvIDIuMzg0ZS0wNixcblx0XHRcdDYuMTg5MzQ2ZS0wMyAqIDAuOTk1MTg0NzI2NjcyMTk3IC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuOTIyNDg3M2UtMDIgKiAwLjk5NTE4NDcyNjY3MjE5NyAvIDIuMzg0ZS0wNixcblx0XHRcdC00LjQ4OTg5OWUtMDMgKiAwLjk5NTE4NDcyNjY3MjE5NyAvIDIuMzg0ZS0wNixcblx0XHRcdC02LjgwOTIzZS0wNCAqIDAuOTk1MTg0NzI2NjcyMTk3IC8gMi4zODRlLTA2LFxuXHRcdFx0LTQuMzM5MmUtMDUgKiAwLjk5NTE4NDcyNjY3MjE5NyAvIDIuMzg0ZS0wNixcblx0XHRcdDkuODQ5MTQwMzM1NzE2NDI1ZS0wMiwgMS45NjE1NzA1NjA4MDY0NjFlKzAwLFxuXG5cdFx0XHQtMi4zODRlLTA2ICogMC45OTg3OTU0NTYyMDUxNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQ3Ljc3MjRlLTA1ICogMC45OTg3OTU0NTYyMDUxNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQ4LjgyMTVlLTA1ICogMC45OTg3OTU0NTYyMDUxNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNC4wNzIxODllLTAzICogMC45OTg3OTU0NTYyMDUxNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjExMzI2OThlLTAyICogMC45OTg3OTU0NTYyMDUxNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0LjY5MTEyNGUtMDMgKiAwLjk5ODc5NTQ1NjIwNTE3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDcuNzkxNTJlLTA0ICogMC45OTg3OTU0NTYyMDUxNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQ1LjI5MjllLTA1ICogMC45OTg3OTU0NTYyMDUxNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQyLjg2MWUtMDYgKiAwLjk5ODc5NTQ1NjIwNTE3MiAvIDIuMzg0ZS0wNixcblx0XHRcdC02LjA1NThlLTA1ICogMC45OTg3OTU0NTYyMDUxNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjM3MzI5ZS0wNCAqIDAuOTk4Nzk1NDU2MjA1MTcyIC8gMi4zODRlLTA2LFxuXHRcdFx0NS40NjIxNzBlLTAzICogMC45OTg3OTU0NTYyMDUxNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi45ODkwMDYwZS0wMiAqIDAuOTk4Nzk1NDU2MjA1MTcyIC8gMi4zODRlLTA2LFxuXHRcdFx0LTQuNTcwNDg0ZS0wMyAqIDAuOTk4Nzk1NDU2MjA1MTcyIC8gMi4zODRlLTA2LFxuXHRcdFx0LTcuMTQzMDJlLTA0ICogMC45OTg3OTU0NTYyMDUxNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNC42MjUzZS0wNSAqIDAuOTk4Nzk1NDU2MjA1MTcyIC8gMi4zODRlLTA2LFxuXHRcdFx0NC45MTI2ODQ5NzY5NDY3MjVlLTAyLCAxLjk5MDM2OTQ1MzM0NDM5NGUrMDAsXG5cblx0XHRcdDMuNTc4MDkwN2UtMDIgKiBVdGlsLlNRUlQyICogMC41IC8gMi4zODRlLTA2LFxuXHRcdFx0MS43ODc2MTQ4ZS0wMiAqIFV0aWwuU1FSVDIgKiAwLjUgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjEzNDcyN2UtMDMgKiBVdGlsLlNRUlQyICogMC41IC8gMi4zODRlLTA2LFxuXHRcdFx0Mi40NTcxNDJlLTAzICogVXRpbC5TUVJUMiAqIDAuNSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuNzEzMTdlLTA0ICogVXRpbC5TUVJUMiAqIDAuNSAvIDIuMzg0ZS0wNixcblx0XHRcdDIuMTg4NjhlLTA0ICogVXRpbC5TUVJUMiAqIDAuNSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMDE1NjZlLTA0ICogVXRpbC5TUVJUMiAqIDAuNSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMzgyOGUtMDUgKiBVdGlsLlNRUlQyICogMC41IC8gMi4zODRlLTA2LFxuXG5cdFx0XHQzLjA1MjY2MzhlLTAyIC8gMi4zODRlLTA2LCA0LjYzODE5NWUtMDMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ3LjQ3MjA0ZS0wNCAvIDIuMzg0ZS0wNiwgNC45NTkxZS0wNSAvIDIuMzg0ZS0wNixcblx0XHRcdDQuNzU2NDUxZS0wMyAvIDIuMzg0ZS0wNiwgMi4xNDU4ZS0wNSAvIDIuMzg0ZS0wNixcblx0XHRcdC02Ljk2MThlLTA1IC8gMi4zODRlLTA2LCAvKiAyLjM4NGUtMDYvMi4zODRlLTA2ICovXG5cdF07XG5cblx0dmFyIE5TID0gMTI7XG5cdHZhciBOTCA9IDM2O1xuXG5cdHZhciB3aW4gPSBbXG5cdCAgICBbXG5cdCAgICAgMi4zODIxOTE3MzkzNDc5MTNlLTEzLFxuXHQgICAgIDYuNDIzMzA1ODcyMTQ3ODM0ZS0xMyxcblx0ICAgICA5LjQwMDg0OTA5NDA0OTY4OGUtMTMsXG5cdCAgICAgMS4xMjI0MzUwMjYwOTY1NTZlLTEyLFxuXHQgICAgIDEuMTgzODQwMzIxMjY3NDgxZS0xMixcblx0ICAgICAxLjEyMjQzNTAyNjA5NjU1NmUtMTIsXG5cdCAgICAgOS40MDA4NDkwOTQwNDk2OTBlLTEzLFxuXHQgICAgIDYuNDIzMzA1ODcyMTQ3ODM5ZS0xMyxcblx0ICAgICAyLjM4MjE5MTczOTM0NzkxOGUtMTMsXG5cblx0ICAgICA1LjQ1NjExNjEwODk0MzQxMmUtMTIsXG5cdCAgICAgNC44Nzg5ODUxOTk1NjU4NTJlLTEyLFxuXHQgICAgIDQuMjQwNDQ4OTk1MDE3MzY3ZS0xMixcblx0ICAgICAzLjU1OTkwOTA5NDc1ODI1MmUtMTIsXG5cdCAgICAgMi44NTgwNDMzNTkyODgwNzVlLTEyLFxuXHQgICAgIDIuMTU2MTc3NjIzODE3ODk4ZS0xMixcblx0ICAgICAxLjQ3NTYzNzcyMzU1ODc4M2UtMTIsXG5cdCAgICAgOC4zNzEwMTUxOTAxMDI5NzRlLTEzLFxuXHQgICAgIDIuNTk5NzA2MDk2MzI3Mzc2ZS0xMyxcblxuXHQgICAgIC01LjQ1NjExNjEwODk0MzQxMmUtMTIsXG5cdCAgICAgLTQuODc4OTg1MTk5NTY1ODUyZS0xMixcblx0ICAgICAtNC4yNDA0NDg5OTUwMTczNjdlLTEyLFxuXHQgICAgIC0zLjU1OTkwOTA5NDc1ODI1MmUtMTIsXG5cdCAgICAgLTIuODU4MDQzMzU5Mjg4MDc2ZS0xMixcblx0ICAgICAtMi4xNTYxNzc2MjM4MTc4OThlLTEyLFxuXHQgICAgIC0xLjQ3NTYzNzcyMzU1ODc4M2UtMTIsXG5cdCAgICAgLTguMzcxMDE1MTkwMTAyOTc1ZS0xMyxcblx0ICAgICAtMi41OTk3MDYwOTYzMjczNzZlLTEzLFxuXG5cdCAgICAgLTIuMzgyMTkxNzM5MzQ3OTIzZS0xMyxcblx0ICAgICAtNi40MjMzMDU4NzIxNDc4NDNlLTEzLFxuXHQgICAgIC05LjQwMDg0OTA5NDA0OTY5NmUtMTMsXG5cdCAgICAgLTEuMTIyNDM1MDI2MDk2NTU2ZS0xMixcblx0ICAgICAtMS4xODM4NDAzMjEyNjc0ODFlLTEyLFxuXHQgICAgIC0xLjEyMjQzNTAyNjA5NjU1NmUtMTIsXG5cdCAgICAgLTkuNDAwODQ5MDk0MDQ5Njk0ZS0xMyxcblx0ICAgICAtNi40MjMzMDU4NzIxNDc4NDBlLTEzLFxuXHQgICAgIC0yLjM4MjE5MTczOTM0NzkxOGUtMTMsXG5cdCAgICAgXSxcblx0ICAgIFtcblx0ICAgICAyLjM4MjE5MTczOTM0NzkxM2UtMTMsXG5cdCAgICAgNi40MjMzMDU4NzIxNDc4MzRlLTEzLFxuXHQgICAgIDkuNDAwODQ5MDk0MDQ5Njg4ZS0xMyxcblx0ICAgICAxLjEyMjQzNTAyNjA5NjU1NmUtMTIsXG5cdCAgICAgMS4xODM4NDAzMjEyNjc0ODFlLTEyLFxuXHQgICAgIDEuMTIyNDM1MDI2MDk2NTU2ZS0xMixcblx0ICAgICA5LjQwMDg0OTA5NDA0OTY4OGUtMTMsXG5cdCAgICAgNi40MjMzMDU4NzIxNDc4NDFlLTEzLFxuXHQgICAgIDIuMzgyMTkxNzM5MzQ3OTE4ZS0xMyxcblxuXHQgICAgIDUuNDU2MTE2MTA4OTQzNDEzZS0xMixcblx0ICAgICA0Ljg3ODk4NTE5OTU2NTg1MmUtMTIsXG5cdCAgICAgNC4yNDA0NDg5OTUwMTczNjdlLTEyLFxuXHQgICAgIDMuNTU5OTA5MDk0NzU4MjUzZS0xMixcblx0ICAgICAyLjg1ODA0MzM1OTI4ODA3NWUtMTIsXG5cdCAgICAgMi4xNTYxNzc2MjM4MTc4OThlLTEyLFxuXHQgICAgIDEuNDc1NjM3NzIzNTU4NzgyZS0xMixcblx0ICAgICA4LjM3MTAxNTE5MDEwMjk3NWUtMTMsXG5cdCAgICAgMi41OTk3MDYwOTYzMjczNzZlLTEzLFxuXG5cdCAgICAgLTUuNDYxMzE0MDY5ODA5NzU1ZS0xMixcblx0ICAgICAtNC45MjEwODU3NzA1MjQwNTVlLTEyLFxuXHQgICAgIC00LjM0MzQwNTAzNzA5MTgzOGUtMTIsXG5cdCAgICAgLTMuNzMyNjY4MzY4NzA3Njg3ZS0xMixcblx0ICAgICAtMy4wOTM1MjM4NDAxOTA4ODVlLTEyLFxuXHQgICAgIC0yLjQzMDgzNTcyNzMyOTQ2NWUtMTIsXG5cdCAgICAgLTEuNzM0Njc5MDEwMDA3NzUxZS0xMixcblx0ICAgICAtOS43NDgyNTM2NTY2MDkyODFlLTEzLFxuXHQgICAgIC0yLjc5NzQzNTEyMDE2ODMyNmUtMTMsXG5cblx0ICAgICAwLjAwMDAwMDAwMDAwMDAwMGUrMDAsXG5cdCAgICAgMC4wMDAwMDAwMDAwMDAwMDBlKzAwLFxuXHQgICAgIDAuMDAwMDAwMDAwMDAwMDAwZSswMCxcblx0ICAgICAwLjAwMDAwMDAwMDAwMDAwMGUrMDAsXG5cdCAgICAgMC4wMDAwMDAwMDAwMDAwMDBlKzAwLFxuXHQgICAgIDAuMDAwMDAwMDAwMDAwMDAwZSswMCxcblx0ICAgICAtMi4yODM3NDgyNDE3OTk1MzFlLTEzLFxuXHQgICAgIC00LjAzNzg1ODg3NDAyMDY4NmUtMTMsXG5cdCAgICAgLTIuMTQ2NTQ3NDY0ODI1MzIzZS0xMyxcblx0ICAgICBdLFxuXHQgICAgW1xuXHQgICAgIDEuMzE2NTI0OTc1ODczOTU4ZS0wMSwgLyogd2luW1NIT1JUX1RZUEVdICovXG5cdCAgICAgNC4xNDIxMzU2MjM3MzA5NTBlLTAxLFxuXHQgICAgIDcuNjczMjY5ODc5Nzg5NjAyZS0wMSxcblxuXHQgICAgIDEuMDkxMzA4NTAxMDY5MjcxZSswMCwgLyogdGFudGFiX2wgKi9cblx0ICAgICAxLjMwMzIyNTM3Mjg0MTIwNmUrMDAsXG5cdCAgICAgMS41Njk2ODU1NzcxMTc0OTBlKzAwLFxuXHQgICAgIDEuOTIwOTgyMTI2OTcxMTY2ZSswMCxcblx0ICAgICAyLjQxNDIxMzU2MjM3MzA5NGUrMDAsXG5cdCAgICAgMy4xNzE1OTQ4MDIzNjMyMTJlKzAwLFxuXHQgICAgIDQuNTEwNzA4NTAzNjYyMDU1ZSswMCxcblx0ICAgICA3LjU5NTc1NDExMjcyNTE0NmUrMDAsXG5cdCAgICAgMi4yOTAzNzY1NTQ4NDMxMTVlKzAxLFxuXG5cdCAgICAgMC45ODQ4MDc3NTMwMTIyMDgwMjAzMiwgLyogY3ggKi9cblx0ICAgICAwLjY0Mjc4NzYwOTY4NjUzOTM2MjkyLFxuXHQgICAgIDAuMzQyMDIwMTQzMzI1NjY4ODIzOTMsXG5cdCAgICAgMC45Mzk2OTI2MjA3ODU5MDg0Mjc5MSxcblx0ICAgICAtMC4xNzM2NDgxNzc2NjY5MzAzMDM0Myxcblx0ICAgICAtMC43NjYwNDQ0NDMxMTg5Nzc5MDI0Myxcblx0ICAgICAwLjg2NjAyNTQwMzc4NDQzODcwNzYxLFxuXHQgICAgIDAuNTAwMDAwMDAwMDAwMDAwZSswMCxcblxuXHQgICAgIC01LjE0NDk1NzU1NDI3NTI2NWUtMDEsIC8qIGNhICovXG5cdCAgICAgLTQuNzE3MzE5Njg1NjQ5NzIzZS0wMSxcblx0ICAgICAtMy4xMzM3NzQ1NDIwMzkwMTllLTAxLFxuXHQgICAgIC0xLjgxOTEzMTk5NjEwOTgxMmUtMDEsXG5cdCAgICAgLTkuNDU3NDE5MjUyNjQyMDY0ZS0wMixcblx0ICAgICAtNC4wOTY1NTgyODg1MzA0MDVlLTAyLFxuXHQgICAgIC0xLjQxOTg1Njg1NzI0NzExNWUtMDIsXG5cdCAgICAgLTMuNjk5OTc0NjczNzYwMDM3ZS0wMyxcblxuXHQgICAgIDguNTc0OTI5MjU3MTI1NDQyZS0wMSwgLyogY3MgKi9cblx0ICAgICA4LjgxNzQxOTk3MzE3NzA1MmUtMDEsXG5cdCAgICAgOS40OTYyODY0OTEwMjczMjllLTAxLFxuXHQgICAgIDkuODMzMTQ1OTI0OTE3OTAxZS0wMSxcblx0ICAgICA5Ljk1NTE3ODE2MDY3NTg1N2UtMDEsXG5cdCAgICAgOS45OTE2MDU1ODE3ODE0NzVlLTAxLFxuXHQgICAgIDkuOTk4OTkxOTUyNDQ0NDcwZS0wMSxcblx0ICAgICA5Ljk5OTkzMTU1MDcwMjgwMmUtMDEsXG5cdCAgICAgXSxcblx0ICAgIFtcblx0ICAgICAwLjAwMDAwMDAwMDAwMDAwMGUrMDAsXG5cdCAgICAgMC4wMDAwMDAwMDAwMDAwMDBlKzAwLFxuXHQgICAgIDAuMDAwMDAwMDAwMDAwMDAwZSswMCxcblx0ICAgICAwLjAwMDAwMDAwMDAwMDAwMGUrMDAsXG5cdCAgICAgMC4wMDAwMDAwMDAwMDAwMDBlKzAwLFxuXHQgICAgIDAuMDAwMDAwMDAwMDAwMDAwZSswMCxcblx0ICAgICAyLjI4Mzc0ODI0MTc5OTUzMWUtMTMsXG5cdCAgICAgNC4wMzc4NTg4NzQwMjA2ODZlLTEzLFxuXHQgICAgIDIuMTQ2NTQ3NDY0ODI1MzIzZS0xMyxcblxuXHQgICAgIDUuNDYxMzE0MDY5ODA5NzU1ZS0xMixcblx0ICAgICA0LjkyMTA4NTc3MDUyNDA1NWUtMTIsXG5cdCAgICAgNC4zNDM0MDUwMzcwOTE4MzhlLTEyLFxuXHQgICAgIDMuNzMyNjY4MzY4NzA3Njg3ZS0xMixcblx0ICAgICAzLjA5MzUyMzg0MDE5MDg4NWUtMTIsXG5cdCAgICAgMi40MzA4MzU3MjczMjk0NjZlLTEyLFxuXHQgICAgIDEuNzM0Njc5MDEwMDA3NzUxZS0xMixcblx0ICAgICA5Ljc0ODI1MzY1NjYwOTI4MWUtMTMsXG5cdCAgICAgMi43OTc0MzUxMjAxNjgzMjZlLTEzLFxuXG5cdCAgICAgLTUuNDU2MTE2MTA4OTQzNDEzZS0xMixcblx0ICAgICAtNC44Nzg5ODUxOTk1NjU4NTJlLTEyLFxuXHQgICAgIC00LjI0MDQ0ODk5NTAxNzM2N2UtMTIsXG5cdCAgICAgLTMuNTU5OTA5MDk0NzU4MjUzZS0xMixcblx0ICAgICAtMi44NTgwNDMzNTkyODgwNzVlLTEyLFxuXHQgICAgIC0yLjE1NjE3NzYyMzgxNzg5OGUtMTIsXG5cdCAgICAgLTEuNDc1NjM3NzIzNTU4NzgyZS0xMixcblx0ICAgICAtOC4zNzEwMTUxOTAxMDI5NzVlLTEzLFxuXHQgICAgIC0yLjU5OTcwNjA5NjMyNzM3NmUtMTMsXG5cblx0ICAgICAtMi4zODIxOTE3MzkzNDc5MTNlLTEzLFxuXHQgICAgIC02LjQyMzMwNTg3MjE0NzgzNGUtMTMsXG5cdCAgICAgLTkuNDAwODQ5MDk0MDQ5Njg4ZS0xMyxcblx0ICAgICAtMS4xMjI0MzUwMjYwOTY1NTZlLTEyLFxuXHQgICAgIC0xLjE4Mzg0MDMyMTI2NzQ4MWUtMTIsXG5cdCAgICAgLTEuMTIyNDM1MDI2MDk2NTU2ZS0xMixcblx0ICAgICAtOS40MDA4NDkwOTQwNDk2ODhlLTEzLFxuXHQgICAgIC02LjQyMzMwNTg3MjE0Nzg0MWUtMTMsXG5cdCAgICAgLTIuMzgyMTkxNzM5MzQ3OTE4ZS0xMyxcblx0ICAgICBdXG5cdF07XG5cblx0dmFyIHRhbnRhYl9sID0gd2luW0VuY29kZXIuU0hPUlRfVFlQRV07XG5cdHZhciBjeCA9IHdpbltFbmNvZGVyLlNIT1JUX1RZUEVdO1xuXHR2YXIgY2EgPSB3aW5bRW5jb2Rlci5TSE9SVF9UWVBFXTtcblx0dmFyIGNzID0gd2luW0VuY29kZXIuU0hPUlRfVFlQRV07XG5cblx0LyoqXG5cdCAqIG5ldyBJRENUIHJvdXRpbmUgd3JpdHRlbiBieSBUYWtlaGlybyBUT01JTkFHQVxuXHQgKlxuXHQgKiBQVVJQT1NFOiBPdmVybGFwcGluZyB3aW5kb3cgb24gUENNIHNhbXBsZXM8QlI+XG5cdCAqXG5cdCAqIFNFTUFOVElDUzo8QlI+XG5cdCAqIDMyIDE2LWJpdCBwY20gc2FtcGxlcyBhcmUgc2NhbGVkIHRvIGZyYWN0aW9uYWwgMidzIGNvbXBsZW1lbnQgYW5kXG5cdCAqIGNvbmNhdGVuYXRlZCB0byB0aGUgZW5kIG9mIHRoZSB3aW5kb3cgYnVmZmVyICN4Iy4gVGhlIHVwZGF0ZWQgd2luZG93XG5cdCAqIGJ1ZmZlciAjeCMgaXMgdGhlbiB3aW5kb3dlZCBieSB0aGUgYW5hbHlzaXMgd2luZG93ICNjIyB0byBwcm9kdWNlIHRoZVxuXHQgKiB3aW5kb3dlZCBzYW1wbGUgI3ojXG5cdCAqL1xuXHR2YXIgb3JkZXIgPSBbXG5cdCAgICAwLCAxLCAxNiwgMTcsIDgsIDksIDI0LCAyNSwgNCwgNSwgMjAsIDIxLCAxMiwgMTMsIDI4LCAyOSxcblx0ICAgIDIsIDMsIDE4LCAxOSwgMTAsIDExLCAyNiwgMjcsIDYsIDcsIDIyLCAyMywgMTQsIDE1LCAzMCwgMzFcblx0XTtcblxuXHQvKipcblx0ICogcmV0dXJucyBzdW1faj0wXjMxIGFbal0qY29zKFBJKmoqKGsrMS8yKS8zMiksIDA8PWs8MzJcblx0ICovXG5cdGZ1bmN0aW9uIHdpbmRvd19zdWJiYW5kKHgxLCB4MVBvcywgYSkge1xuXHRcdHZhciB3cCA9IDEwO1xuXG5cdFx0dmFyIHgyID0geDFQb3MgKyAyMzggLSAxNCAtIDI4NjtcblxuXHRcdGZvciAodmFyIGkgPSAtMTU7IGkgPCAwOyBpKyspIHtcblx0XHRcdHZhciB3LCBzLCB0O1xuXG5cdFx0XHR3ID0gZW53aW5kb3dbd3AgKyAtMTBdO1xuXHRcdFx0cyA9IHgxW3gyICsgLTIyNF0gKiB3O1xuXHRcdFx0dCA9IHgxW3gxUG9zICsgMjI0XSAqIHc7XG5cdFx0XHR3ID0gZW53aW5kb3dbd3AgKyAtOV07XG5cdFx0XHRzICs9IHgxW3gyICsgLTE2MF0gKiB3O1xuXHRcdFx0dCArPSB4MVt4MVBvcyArIDE2MF0gKiB3O1xuXHRcdFx0dyA9IGVud2luZG93W3dwICsgLThdO1xuXHRcdFx0cyArPSB4MVt4MiArIC05Nl0gKiB3O1xuXHRcdFx0dCArPSB4MVt4MVBvcyArIDk2XSAqIHc7XG5cdFx0XHR3ID0gZW53aW5kb3dbd3AgKyAtN107XG5cdFx0XHRzICs9IHgxW3gyICsgLTMyXSAqIHc7XG5cdFx0XHR0ICs9IHgxW3gxUG9zICsgMzJdICogdztcblx0XHRcdHcgPSBlbndpbmRvd1t3cCArIC02XTtcblx0XHRcdHMgKz0geDFbeDIgKyAzMl0gKiB3O1xuXHRcdFx0dCArPSB4MVt4MVBvcyArIC0zMl0gKiB3O1xuXHRcdFx0dyA9IGVud2luZG93W3dwICsgLTVdO1xuXHRcdFx0cyArPSB4MVt4MiArIDk2XSAqIHc7XG5cdFx0XHR0ICs9IHgxW3gxUG9zICsgLTk2XSAqIHc7XG5cdFx0XHR3ID0gZW53aW5kb3dbd3AgKyAtNF07XG5cdFx0XHRzICs9IHgxW3gyICsgMTYwXSAqIHc7XG5cdFx0XHR0ICs9IHgxW3gxUG9zICsgLTE2MF0gKiB3O1xuXHRcdFx0dyA9IGVud2luZG93W3dwICsgLTNdO1xuXHRcdFx0cyArPSB4MVt4MiArIDIyNF0gKiB3O1xuXHRcdFx0dCArPSB4MVt4MVBvcyArIC0yMjRdICogdztcblxuXHRcdFx0dyA9IGVud2luZG93W3dwICsgLTJdO1xuXHRcdFx0cyArPSB4MVt4MVBvcyArIC0yNTZdICogdztcblx0XHRcdHQgLT0geDFbeDIgKyAyNTZdICogdztcblx0XHRcdHcgPSBlbndpbmRvd1t3cCArIC0xXTtcblx0XHRcdHMgKz0geDFbeDFQb3MgKyAtMTkyXSAqIHc7XG5cdFx0XHR0IC09IHgxW3gyICsgMTkyXSAqIHc7XG5cdFx0XHR3ID0gZW53aW5kb3dbd3AgKyAwXTtcblx0XHRcdHMgKz0geDFbeDFQb3MgKyAtMTI4XSAqIHc7XG5cdFx0XHR0IC09IHgxW3gyICsgMTI4XSAqIHc7XG5cdFx0XHR3ID0gZW53aW5kb3dbd3AgKyAxXTtcblx0XHRcdHMgKz0geDFbeDFQb3MgKyAtNjRdICogdztcblx0XHRcdHQgLT0geDFbeDIgKyA2NF0gKiB3O1xuXHRcdFx0dyA9IGVud2luZG93W3dwICsgMl07XG5cdFx0XHRzICs9IHgxW3gxUG9zICsgMF0gKiB3O1xuXHRcdFx0dCAtPSB4MVt4MiArIDBdICogdztcblx0XHRcdHcgPSBlbndpbmRvd1t3cCArIDNdO1xuXHRcdFx0cyArPSB4MVt4MVBvcyArIDY0XSAqIHc7XG5cdFx0XHR0IC09IHgxW3gyICsgLTY0XSAqIHc7XG5cdFx0XHR3ID0gZW53aW5kb3dbd3AgKyA0XTtcblx0XHRcdHMgKz0geDFbeDFQb3MgKyAxMjhdICogdztcblx0XHRcdHQgLT0geDFbeDIgKyAtMTI4XSAqIHc7XG5cdFx0XHR3ID0gZW53aW5kb3dbd3AgKyA1XTtcblx0XHRcdHMgKz0geDFbeDFQb3MgKyAxOTJdICogdztcblx0XHRcdHQgLT0geDFbeDIgKyAtMTkyXSAqIHc7XG5cblx0XHRcdC8qXG5cdFx0XHQgKiB0aGlzIG11bHRpcGx5ZXIgY291bGQgYmUgcmVtb3ZlZCwgYnV0IGl0IG5lZWRzIG1vcmUgMjU2IEZMT0FUXG5cdFx0XHQgKiBkYXRhLiB0aGlua2luZyBhYm91dCB0aGUgZGF0YSBjYWNoZSBwZXJmb3JtYW5jZSwgSSB0aGluayB3ZVxuXHRcdFx0ICogc2hvdWxkIG5vdCB1c2Ugc3VjaCBhIGh1Z2UgdGFibGUuIHR0IDIwMDAvT2N0LzI1XG5cdFx0XHQgKi9cblx0XHRcdHMgKj0gZW53aW5kb3dbd3AgKyA2XTtcblx0XHRcdHcgPSB0IC0gcztcblx0XHRcdGFbMzAgKyBpICogMl0gPSB0ICsgcztcblx0XHRcdGFbMzEgKyBpICogMl0gPSBlbndpbmRvd1t3cCArIDddICogdztcblx0XHRcdHdwICs9IDE4O1xuXHRcdFx0eDFQb3MtLTtcblx0XHRcdHgyKys7XG5cdFx0fVxuXHRcdHtcblx0XHRcdHZhciBzLCB0LCB1LCB2O1xuXHRcdFx0dCA9IHgxW3gxUG9zICsgLTE2XSAqIGVud2luZG93W3dwICsgLTEwXTtcblx0XHRcdHMgPSB4MVt4MVBvcyArIC0zMl0gKiBlbndpbmRvd1t3cCArIC0yXTtcblx0XHRcdHQgKz0gKHgxW3gxUG9zICsgLTQ4XSAtIHgxW3gxUG9zICsgMTZdKSAqIGVud2luZG93W3dwICsgLTldO1xuXHRcdFx0cyArPSB4MVt4MVBvcyArIC05Nl0gKiBlbndpbmRvd1t3cCArIC0xXTtcblx0XHRcdHQgKz0gKHgxW3gxUG9zICsgLTgwXSArIHgxW3gxUG9zICsgNDhdKSAqIGVud2luZG93W3dwICsgLThdO1xuXHRcdFx0cyArPSB4MVt4MVBvcyArIC0xNjBdICogZW53aW5kb3dbd3AgKyAwXTtcblx0XHRcdHQgKz0gKHgxW3gxUG9zICsgLTExMl0gLSB4MVt4MVBvcyArIDgwXSkgKiBlbndpbmRvd1t3cCArIC03XTtcblx0XHRcdHMgKz0geDFbeDFQb3MgKyAtMjI0XSAqIGVud2luZG93W3dwICsgMV07XG5cdFx0XHR0ICs9ICh4MVt4MVBvcyArIC0xNDRdICsgeDFbeDFQb3MgKyAxMTJdKSAqIGVud2luZG93W3dwICsgLTZdO1xuXHRcdFx0cyAtPSB4MVt4MVBvcyArIDMyXSAqIGVud2luZG93W3dwICsgMl07XG5cdFx0XHR0ICs9ICh4MVt4MVBvcyArIC0xNzZdIC0geDFbeDFQb3MgKyAxNDRdKSAqIGVud2luZG93W3dwICsgLTVdO1xuXHRcdFx0cyAtPSB4MVt4MVBvcyArIDk2XSAqIGVud2luZG93W3dwICsgM107XG5cdFx0XHR0ICs9ICh4MVt4MVBvcyArIC0yMDhdICsgeDFbeDFQb3MgKyAxNzZdKSAqIGVud2luZG93W3dwICsgLTRdO1xuXHRcdFx0cyAtPSB4MVt4MVBvcyArIDE2MF0gKiBlbndpbmRvd1t3cCArIDRdO1xuXHRcdFx0dCArPSAoeDFbeDFQb3MgKyAtMjQwXSAtIHgxW3gxUG9zICsgMjA4XSkgKiBlbndpbmRvd1t3cCArIC0zXTtcblx0XHRcdHMgLT0geDFbeDFQb3MgKyAyMjRdO1xuXG5cdFx0XHR1ID0gcyAtIHQ7XG5cdFx0XHR2ID0gcyArIHQ7XG5cblx0XHRcdHQgPSBhWzE0XTtcblx0XHRcdHMgPSBhWzE1XSAtIHQ7XG5cblx0XHRcdGFbMzFdID0gdiArIHQ7IC8qIEEwICovXG5cdFx0XHRhWzMwXSA9IHUgKyBzOyAvKiBBMSAqL1xuXHRcdFx0YVsxNV0gPSB1IC0gczsgLyogQTIgKi9cblx0XHRcdGFbMTRdID0gdiAtIHQ7IC8qIEEzICovXG5cdFx0fVxuXHRcdHtcblx0XHRcdHZhciB4cjtcblx0XHRcdHhyID0gYVsyOF0gLSBhWzBdO1xuXHRcdFx0YVswXSArPSBhWzI4XTtcblx0XHRcdGFbMjhdID0geHIgKiBlbndpbmRvd1t3cCArIC0yICogMTggKyA3XTtcblx0XHRcdHhyID0gYVsyOV0gLSBhWzFdO1xuXHRcdFx0YVsxXSArPSBhWzI5XTtcblx0XHRcdGFbMjldID0geHIgKiBlbndpbmRvd1t3cCArIC0yICogMTggKyA3XTtcblxuXHRcdFx0eHIgPSBhWzI2XSAtIGFbMl07XG5cdFx0XHRhWzJdICs9IGFbMjZdO1xuXHRcdFx0YVsyNl0gPSB4ciAqIGVud2luZG93W3dwICsgLTQgKiAxOCArIDddO1xuXHRcdFx0eHIgPSBhWzI3XSAtIGFbM107XG5cdFx0XHRhWzNdICs9IGFbMjddO1xuXHRcdFx0YVsyN10gPSB4ciAqIGVud2luZG93W3dwICsgLTQgKiAxOCArIDddO1xuXG5cdFx0XHR4ciA9IGFbMjRdIC0gYVs0XTtcblx0XHRcdGFbNF0gKz0gYVsyNF07XG5cdFx0XHRhWzI0XSA9IHhyICogZW53aW5kb3dbd3AgKyAtNiAqIDE4ICsgN107XG5cdFx0XHR4ciA9IGFbMjVdIC0gYVs1XTtcblx0XHRcdGFbNV0gKz0gYVsyNV07XG5cdFx0XHRhWzI1XSA9IHhyICogZW53aW5kb3dbd3AgKyAtNiAqIDE4ICsgN107XG5cblx0XHRcdHhyID0gYVsyMl0gLSBhWzZdO1xuXHRcdFx0YVs2XSArPSBhWzIyXTtcblx0XHRcdGFbMjJdID0geHIgKiBVdGlsLlNRUlQyO1xuXHRcdFx0eHIgPSBhWzIzXSAtIGFbN107XG5cdFx0XHRhWzddICs9IGFbMjNdO1xuXHRcdFx0YVsyM10gPSB4ciAqIFV0aWwuU1FSVDIgLSBhWzddO1xuXHRcdFx0YVs3XSAtPSBhWzZdO1xuXHRcdFx0YVsyMl0gLT0gYVs3XTtcblx0XHRcdGFbMjNdIC09IGFbMjJdO1xuXG5cdFx0XHR4ciA9IGFbNl07XG5cdFx0XHRhWzZdID0gYVszMV0gLSB4cjtcblx0XHRcdGFbMzFdID0gYVszMV0gKyB4cjtcblx0XHRcdHhyID0gYVs3XTtcblx0XHRcdGFbN10gPSBhWzMwXSAtIHhyO1xuXHRcdFx0YVszMF0gPSBhWzMwXSArIHhyO1xuXHRcdFx0eHIgPSBhWzIyXTtcblx0XHRcdGFbMjJdID0gYVsxNV0gLSB4cjtcblx0XHRcdGFbMTVdID0gYVsxNV0gKyB4cjtcblx0XHRcdHhyID0gYVsyM107XG5cdFx0XHRhWzIzXSA9IGFbMTRdIC0geHI7XG5cdFx0XHRhWzE0XSA9IGFbMTRdICsgeHI7XG5cblx0XHRcdHhyID0gYVsyMF0gLSBhWzhdO1xuXHRcdFx0YVs4XSArPSBhWzIwXTtcblx0XHRcdGFbMjBdID0geHIgKiBlbndpbmRvd1t3cCArIC0xMCAqIDE4ICsgN107XG5cdFx0XHR4ciA9IGFbMjFdIC0gYVs5XTtcblx0XHRcdGFbOV0gKz0gYVsyMV07XG5cdFx0XHRhWzIxXSA9IHhyICogZW53aW5kb3dbd3AgKyAtMTAgKiAxOCArIDddO1xuXG5cdFx0XHR4ciA9IGFbMThdIC0gYVsxMF07XG5cdFx0XHRhWzEwXSArPSBhWzE4XTtcblx0XHRcdGFbMThdID0geHIgKiBlbndpbmRvd1t3cCArIC0xMiAqIDE4ICsgN107XG5cdFx0XHR4ciA9IGFbMTldIC0gYVsxMV07XG5cdFx0XHRhWzExXSArPSBhWzE5XTtcblx0XHRcdGFbMTldID0geHIgKiBlbndpbmRvd1t3cCArIC0xMiAqIDE4ICsgN107XG5cblx0XHRcdHhyID0gYVsxNl0gLSBhWzEyXTtcblx0XHRcdGFbMTJdICs9IGFbMTZdO1xuXHRcdFx0YVsxNl0gPSB4ciAqIGVud2luZG93W3dwICsgLTE0ICogMTggKyA3XTtcblx0XHRcdHhyID0gYVsxN10gLSBhWzEzXTtcblx0XHRcdGFbMTNdICs9IGFbMTddO1xuXHRcdFx0YVsxN10gPSB4ciAqIGVud2luZG93W3dwICsgLTE0ICogMTggKyA3XTtcblxuXHRcdFx0eHIgPSAtYVsyMF0gKyBhWzI0XTtcblx0XHRcdGFbMjBdICs9IGFbMjRdO1xuXHRcdFx0YVsyNF0gPSB4ciAqIGVud2luZG93W3dwICsgLTEyICogMTggKyA3XTtcblx0XHRcdHhyID0gLWFbMjFdICsgYVsyNV07XG5cdFx0XHRhWzIxXSArPSBhWzI1XTtcblx0XHRcdGFbMjVdID0geHIgKiBlbndpbmRvd1t3cCArIC0xMiAqIDE4ICsgN107XG5cblx0XHRcdHhyID0gYVs0XSAtIGFbOF07XG5cdFx0XHRhWzRdICs9IGFbOF07XG5cdFx0XHRhWzhdID0geHIgKiBlbndpbmRvd1t3cCArIC0xMiAqIDE4ICsgN107XG5cdFx0XHR4ciA9IGFbNV0gLSBhWzldO1xuXHRcdFx0YVs1XSArPSBhWzldO1xuXHRcdFx0YVs5XSA9IHhyICogZW53aW5kb3dbd3AgKyAtMTIgKiAxOCArIDddO1xuXG5cdFx0XHR4ciA9IGFbMF0gLSBhWzEyXTtcblx0XHRcdGFbMF0gKz0gYVsxMl07XG5cdFx0XHRhWzEyXSA9IHhyICogZW53aW5kb3dbd3AgKyAtNCAqIDE4ICsgN107XG5cdFx0XHR4ciA9IGFbMV0gLSBhWzEzXTtcblx0XHRcdGFbMV0gKz0gYVsxM107XG5cdFx0XHRhWzEzXSA9IHhyICogZW53aW5kb3dbd3AgKyAtNCAqIDE4ICsgN107XG5cdFx0XHR4ciA9IGFbMTZdIC0gYVsyOF07XG5cdFx0XHRhWzE2XSArPSBhWzI4XTtcblx0XHRcdGFbMjhdID0geHIgKiBlbndpbmRvd1t3cCArIC00ICogMTggKyA3XTtcblx0XHRcdHhyID0gLWFbMTddICsgYVsyOV07XG5cdFx0XHRhWzE3XSArPSBhWzI5XTtcblx0XHRcdGFbMjldID0geHIgKiBlbndpbmRvd1t3cCArIC00ICogMTggKyA3XTtcblxuXHRcdFx0eHIgPSBVdGlsLlNRUlQyICogKGFbMl0gLSBhWzEwXSk7XG5cdFx0XHRhWzJdICs9IGFbMTBdO1xuXHRcdFx0YVsxMF0gPSB4cjtcblx0XHRcdHhyID0gVXRpbC5TUVJUMiAqIChhWzNdIC0gYVsxMV0pO1xuXHRcdFx0YVszXSArPSBhWzExXTtcblx0XHRcdGFbMTFdID0geHI7XG5cdFx0XHR4ciA9IFV0aWwuU1FSVDIgKiAoLWFbMThdICsgYVsyNl0pO1xuXHRcdFx0YVsxOF0gKz0gYVsyNl07XG5cdFx0XHRhWzI2XSA9IHhyIC0gYVsxOF07XG5cdFx0XHR4ciA9IFV0aWwuU1FSVDIgKiAoLWFbMTldICsgYVsyN10pO1xuXHRcdFx0YVsxOV0gKz0gYVsyN107XG5cdFx0XHRhWzI3XSA9IHhyIC0gYVsxOV07XG5cblx0XHRcdHhyID0gYVsyXTtcblx0XHRcdGFbMTldIC09IGFbM107XG5cdFx0XHRhWzNdIC09IHhyO1xuXHRcdFx0YVsyXSA9IGFbMzFdIC0geHI7XG5cdFx0XHRhWzMxXSArPSB4cjtcblx0XHRcdHhyID0gYVszXTtcblx0XHRcdGFbMTFdIC09IGFbMTldO1xuXHRcdFx0YVsxOF0gLT0geHI7XG5cdFx0XHRhWzNdID0gYVszMF0gLSB4cjtcblx0XHRcdGFbMzBdICs9IHhyO1xuXHRcdFx0eHIgPSBhWzE4XTtcblx0XHRcdGFbMjddIC09IGFbMTFdO1xuXHRcdFx0YVsxOV0gLT0geHI7XG5cdFx0XHRhWzE4XSA9IGFbMTVdIC0geHI7XG5cdFx0XHRhWzE1XSArPSB4cjtcblxuXHRcdFx0eHIgPSBhWzE5XTtcblx0XHRcdGFbMTBdIC09IHhyO1xuXHRcdFx0YVsxOV0gPSBhWzE0XSAtIHhyO1xuXHRcdFx0YVsxNF0gKz0geHI7XG5cdFx0XHR4ciA9IGFbMTBdO1xuXHRcdFx0YVsxMV0gLT0geHI7XG5cdFx0XHRhWzEwXSA9IGFbMjNdIC0geHI7XG5cdFx0XHRhWzIzXSArPSB4cjtcblx0XHRcdHhyID0gYVsxMV07XG5cdFx0XHRhWzI2XSAtPSB4cjtcblx0XHRcdGFbMTFdID0gYVsyMl0gLSB4cjtcblx0XHRcdGFbMjJdICs9IHhyO1xuXHRcdFx0eHIgPSBhWzI2XTtcblx0XHRcdGFbMjddIC09IHhyO1xuXHRcdFx0YVsyNl0gPSBhWzddIC0geHI7XG5cdFx0XHRhWzddICs9IHhyO1xuXG5cdFx0XHR4ciA9IGFbMjddO1xuXHRcdFx0YVsyN10gPSBhWzZdIC0geHI7XG5cdFx0XHRhWzZdICs9IHhyO1xuXG5cdFx0XHR4ciA9IFV0aWwuU1FSVDIgKiAoYVswXSAtIGFbNF0pO1xuXHRcdFx0YVswXSArPSBhWzRdO1xuXHRcdFx0YVs0XSA9IHhyO1xuXHRcdFx0eHIgPSBVdGlsLlNRUlQyICogKGFbMV0gLSBhWzVdKTtcblx0XHRcdGFbMV0gKz0gYVs1XTtcblx0XHRcdGFbNV0gPSB4cjtcblx0XHRcdHhyID0gVXRpbC5TUVJUMiAqIChhWzE2XSAtIGFbMjBdKTtcblx0XHRcdGFbMTZdICs9IGFbMjBdO1xuXHRcdFx0YVsyMF0gPSB4cjtcblx0XHRcdHhyID0gVXRpbC5TUVJUMiAqIChhWzE3XSAtIGFbMjFdKTtcblx0XHRcdGFbMTddICs9IGFbMjFdO1xuXHRcdFx0YVsyMV0gPSB4cjtcblxuXHRcdFx0eHIgPSAtVXRpbC5TUVJUMiAqIChhWzhdIC0gYVsxMl0pO1xuXHRcdFx0YVs4XSArPSBhWzEyXTtcblx0XHRcdGFbMTJdID0geHIgLSBhWzhdO1xuXHRcdFx0eHIgPSAtVXRpbC5TUVJUMiAqIChhWzldIC0gYVsxM10pO1xuXHRcdFx0YVs5XSArPSBhWzEzXTtcblx0XHRcdGFbMTNdID0geHIgLSBhWzldO1xuXHRcdFx0eHIgPSAtVXRpbC5TUVJUMiAqIChhWzI1XSAtIGFbMjldKTtcblx0XHRcdGFbMjVdICs9IGFbMjldO1xuXHRcdFx0YVsyOV0gPSB4ciAtIGFbMjVdO1xuXHRcdFx0eHIgPSAtVXRpbC5TUVJUMiAqIChhWzI0XSArIGFbMjhdKTtcblx0XHRcdGFbMjRdIC09IGFbMjhdO1xuXHRcdFx0YVsyOF0gPSB4ciAtIGFbMjRdO1xuXG5cdFx0XHR4ciA9IGFbMjRdIC0gYVsxNl07XG5cdFx0XHRhWzI0XSA9IHhyO1xuXHRcdFx0eHIgPSBhWzIwXSAtIHhyO1xuXHRcdFx0YVsyMF0gPSB4cjtcblx0XHRcdHhyID0gYVsyOF0gLSB4cjtcblx0XHRcdGFbMjhdID0geHI7XG5cblx0XHRcdHhyID0gYVsyNV0gLSBhWzE3XTtcblx0XHRcdGFbMjVdID0geHI7XG5cdFx0XHR4ciA9IGFbMjFdIC0geHI7XG5cdFx0XHRhWzIxXSA9IHhyO1xuXHRcdFx0eHIgPSBhWzI5XSAtIHhyO1xuXHRcdFx0YVsyOV0gPSB4cjtcblxuXHRcdFx0eHIgPSBhWzE3XSAtIGFbMV07XG5cdFx0XHRhWzE3XSA9IHhyO1xuXHRcdFx0eHIgPSBhWzldIC0geHI7XG5cdFx0XHRhWzldID0geHI7XG5cdFx0XHR4ciA9IGFbMjVdIC0geHI7XG5cdFx0XHRhWzI1XSA9IHhyO1xuXHRcdFx0eHIgPSBhWzVdIC0geHI7XG5cdFx0XHRhWzVdID0geHI7XG5cdFx0XHR4ciA9IGFbMjFdIC0geHI7XG5cdFx0XHRhWzIxXSA9IHhyO1xuXHRcdFx0eHIgPSBhWzEzXSAtIHhyO1xuXHRcdFx0YVsxM10gPSB4cjtcblx0XHRcdHhyID0gYVsyOV0gLSB4cjtcblx0XHRcdGFbMjldID0geHI7XG5cblx0XHRcdHhyID0gYVsxXSAtIGFbMF07XG5cdFx0XHRhWzFdID0geHI7XG5cdFx0XHR4ciA9IGFbMTZdIC0geHI7XG5cdFx0XHRhWzE2XSA9IHhyO1xuXHRcdFx0eHIgPSBhWzE3XSAtIHhyO1xuXHRcdFx0YVsxN10gPSB4cjtcblx0XHRcdHhyID0gYVs4XSAtIHhyO1xuXHRcdFx0YVs4XSA9IHhyO1xuXHRcdFx0eHIgPSBhWzldIC0geHI7XG5cdFx0XHRhWzldID0geHI7XG5cdFx0XHR4ciA9IGFbMjRdIC0geHI7XG5cdFx0XHRhWzI0XSA9IHhyO1xuXHRcdFx0eHIgPSBhWzI1XSAtIHhyO1xuXHRcdFx0YVsyNV0gPSB4cjtcblx0XHRcdHhyID0gYVs0XSAtIHhyO1xuXHRcdFx0YVs0XSA9IHhyO1xuXHRcdFx0eHIgPSBhWzVdIC0geHI7XG5cdFx0XHRhWzVdID0geHI7XG5cdFx0XHR4ciA9IGFbMjBdIC0geHI7XG5cdFx0XHRhWzIwXSA9IHhyO1xuXHRcdFx0eHIgPSBhWzIxXSAtIHhyO1xuXHRcdFx0YVsyMV0gPSB4cjtcblx0XHRcdHhyID0gYVsxMl0gLSB4cjtcblx0XHRcdGFbMTJdID0geHI7XG5cdFx0XHR4ciA9IGFbMTNdIC0geHI7XG5cdFx0XHRhWzEzXSA9IHhyO1xuXHRcdFx0eHIgPSBhWzI4XSAtIHhyO1xuXHRcdFx0YVsyOF0gPSB4cjtcblx0XHRcdHhyID0gYVsyOV0gLSB4cjtcblx0XHRcdGFbMjldID0geHI7XG5cblx0XHRcdHhyID0gYVswXTtcblx0XHRcdGFbMF0gKz0gYVszMV07XG5cdFx0XHRhWzMxXSAtPSB4cjtcblx0XHRcdHhyID0gYVsxXTtcblx0XHRcdGFbMV0gKz0gYVszMF07XG5cdFx0XHRhWzMwXSAtPSB4cjtcblx0XHRcdHhyID0gYVsxNl07XG5cdFx0XHRhWzE2XSArPSBhWzE1XTtcblx0XHRcdGFbMTVdIC09IHhyO1xuXHRcdFx0eHIgPSBhWzE3XTtcblx0XHRcdGFbMTddICs9IGFbMTRdO1xuXHRcdFx0YVsxNF0gLT0geHI7XG5cdFx0XHR4ciA9IGFbOF07XG5cdFx0XHRhWzhdICs9IGFbMjNdO1xuXHRcdFx0YVsyM10gLT0geHI7XG5cdFx0XHR4ciA9IGFbOV07XG5cdFx0XHRhWzldICs9IGFbMjJdO1xuXHRcdFx0YVsyMl0gLT0geHI7XG5cdFx0XHR4ciA9IGFbMjRdO1xuXHRcdFx0YVsyNF0gKz0gYVs3XTtcblx0XHRcdGFbN10gLT0geHI7XG5cdFx0XHR4ciA9IGFbMjVdO1xuXHRcdFx0YVsyNV0gKz0gYVs2XTtcblx0XHRcdGFbNl0gLT0geHI7XG5cdFx0XHR4ciA9IGFbNF07XG5cdFx0XHRhWzRdICs9IGFbMjddO1xuXHRcdFx0YVsyN10gLT0geHI7XG5cdFx0XHR4ciA9IGFbNV07XG5cdFx0XHRhWzVdICs9IGFbMjZdO1xuXHRcdFx0YVsyNl0gLT0geHI7XG5cdFx0XHR4ciA9IGFbMjBdO1xuXHRcdFx0YVsyMF0gKz0gYVsxMV07XG5cdFx0XHRhWzExXSAtPSB4cjtcblx0XHRcdHhyID0gYVsyMV07XG5cdFx0XHRhWzIxXSArPSBhWzEwXTtcblx0XHRcdGFbMTBdIC09IHhyO1xuXHRcdFx0eHIgPSBhWzEyXTtcblx0XHRcdGFbMTJdICs9IGFbMTldO1xuXHRcdFx0YVsxOV0gLT0geHI7XG5cdFx0XHR4ciA9IGFbMTNdO1xuXHRcdFx0YVsxM10gKz0gYVsxOF07XG5cdFx0XHRhWzE4XSAtPSB4cjtcblx0XHRcdHhyID0gYVsyOF07XG5cdFx0XHRhWzI4XSArPSBhWzNdO1xuXHRcdFx0YVszXSAtPSB4cjtcblx0XHRcdHhyID0gYVsyOV07XG5cdFx0XHRhWzI5XSArPSBhWzJdO1xuXHRcdFx0YVsyXSAtPSB4cjtcblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogRnVuY3Rpb246IENhbGN1bGF0aW9uIG9mIHRoZSBNRENUIEluIHRoZSBjYXNlIG9mIGxvbmcgYmxvY2tzICh0eXBlIDAsMSwzKVxuXHQgKiB0aGVyZSBhcmUgMzYgY29lZmZpY2VudHMgaW4gdGhlIHRpbWUgZG9tYWluIGFuZCAxOCBpbiB0aGUgZnJlcXVlbmN5XG5cdCAqIGRvbWFpbi48QlI+XG5cdCAqIEluIHRoZSBjYXNlIG9mIHNob3J0IGJsb2NrcyAodHlwZSAyKSB0aGVyZSBhcmUgMyB0cmFuc2Zvcm1hdGlvbnMgd2l0aFxuXHQgKiBzaG9ydCBsZW5ndGguIFRoaXMgbGVhZHMgdG8gMTIgY29lZmZpY2VudHMgaW4gdGhlIHRpbWUgYW5kIDYgaW4gdGhlXG5cdCAqIGZyZXF1ZW5jeSBkb21haW4uIEluIHRoaXMgY2FzZSB0aGUgcmVzdWx0cyBhcmUgc3RvcmVkIHNpZGUgYnkgc2lkZSBpbiB0aGVcblx0ICogdmVjdG9yIG91dFtdLlxuXHQgKlxuXHQgKiBOZXcgbGF5ZXIzXG5cdCAqL1xuXHRmdW5jdGlvbiBtZGN0X3Nob3J0KGlub3V0LCBpbm91dFBvcykge1xuXHRcdGZvciAodmFyIGwgPSAwOyBsIDwgMzsgbCsrKSB7XG5cdFx0XHR2YXIgdGMwLCB0YzEsIHRjMiwgdHMwLCB0czEsIHRzMjtcblxuXHRcdFx0dHMwID0gaW5vdXRbaW5vdXRQb3MgKyAyICogM10gKiB3aW5bRW5jb2Rlci5TSE9SVF9UWVBFXVswXVxuXHRcdFx0XHRcdC0gaW5vdXRbaW5vdXRQb3MgKyA1ICogM107XG5cdFx0XHR0YzAgPSBpbm91dFtpbm91dFBvcyArIDAgKiAzXSAqIHdpbltFbmNvZGVyLlNIT1JUX1RZUEVdWzJdXG5cdFx0XHRcdFx0LSBpbm91dFtpbm91dFBvcyArIDMgKiAzXTtcblx0XHRcdHRjMSA9IHRzMCArIHRjMDtcblx0XHRcdHRjMiA9IHRzMCAtIHRjMDtcblxuXHRcdFx0dHMwID0gaW5vdXRbaW5vdXRQb3MgKyA1ICogM10gKiB3aW5bRW5jb2Rlci5TSE9SVF9UWVBFXVswXVxuXHRcdFx0XHRcdCsgaW5vdXRbaW5vdXRQb3MgKyAyICogM107XG5cdFx0XHR0YzAgPSBpbm91dFtpbm91dFBvcyArIDMgKiAzXSAqIHdpbltFbmNvZGVyLlNIT1JUX1RZUEVdWzJdXG5cdFx0XHRcdFx0KyBpbm91dFtpbm91dFBvcyArIDAgKiAzXTtcblx0XHRcdHRzMSA9IHRzMCArIHRjMDtcblx0XHRcdHRzMiA9IC10czAgKyB0YzA7XG5cblx0XHRcdHRjMCA9IChpbm91dFtpbm91dFBvcyArIDEgKiAzXSAqIHdpbltFbmNvZGVyLlNIT1JUX1RZUEVdWzFdIC0gaW5vdXRbaW5vdXRQb3MgKyA0ICogM10pICogMi4wNjk5NzgxMTE5NTMwODllLTExO1xuXHRcdFx0Lypcblx0XHRcdCAqIHRyaXRhYl9zIFsgMSBdXG5cdFx0XHQgKi9cblx0XHRcdHRzMCA9IChpbm91dFtpbm91dFBvcyArIDQgKiAzXSAqIHdpbltFbmNvZGVyLlNIT1JUX1RZUEVdWzFdICsgaW5vdXRbaW5vdXRQb3MgKyAxICogM10pICogMi4wNjk5NzgxMTE5NTMwODllLTExO1xuXHRcdFx0Lypcblx0XHRcdCAqIHRyaXRhYl9zIFsgMSBdXG5cdFx0XHQgKi9cblx0XHRcdGlub3V0W2lub3V0UG9zICsgMyAqIDBdID0gdGMxICogMS45MDc1MjUxOTE3MzcyODBlLTExICsgdGMwO1xuXHRcdFx0Lypcblx0XHRcdCAqIHRyaXRhYl9zWyAyIF1cblx0XHRcdCAqL1xuXHRcdFx0aW5vdXRbaW5vdXRQb3MgKyAzICogNV0gPSAtdHMxICogMS45MDc1MjUxOTE3MzcyODBlLTExICsgdHMwO1xuXHRcdFx0Lypcblx0XHRcdCAqIHRyaXRhYl9zWzAgXVxuXHRcdFx0ICovXG5cdFx0XHR0YzIgPSB0YzIgKiAwLjg2NjAyNTQwMzc4NDQzODcwNzYxICogMS45MDc1MjUxOTE3MzcyODFlLTExO1xuXHRcdFx0Lypcblx0XHRcdCAqIHRyaXRhYl9zWyAyXVxuXHRcdFx0ICovXG5cdFx0XHR0czEgPSB0czEgKiAwLjUgKiAxLjkwNzUyNTE5MTczNzI4MWUtMTEgKyB0czA7XG5cdFx0XHRpbm91dFtpbm91dFBvcyArIDMgKiAxXSA9IHRjMiAtIHRzMTtcblx0XHRcdGlub3V0W2lub3V0UG9zICsgMyAqIDJdID0gdGMyICsgdHMxO1xuXG5cdFx0XHR0YzEgPSB0YzEgKiAwLjUgKiAxLjkwNzUyNTE5MTczNzI4MWUtMTEgLSB0YzA7XG5cdFx0XHR0czIgPSB0czIgKiAwLjg2NjAyNTQwMzc4NDQzODcwNzYxICogMS45MDc1MjUxOTE3MzcyODFlLTExO1xuXHRcdFx0Lypcblx0XHRcdCAqIHRyaXRhYl9zWyAwXVxuXHRcdFx0ICovXG5cdFx0XHRpbm91dFtpbm91dFBvcyArIDMgKiAzXSA9IHRjMSArIHRzMjtcblx0XHRcdGlub3V0W2lub3V0UG9zICsgMyAqIDRdID0gdGMxIC0gdHMyO1xuXG5cdFx0XHRpbm91dFBvcysrO1xuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIG1kY3RfbG9uZyhvdXQsIG91dFBvcywgX2luKSB7XG5cdFx0dmFyIGN0LCBzdDtcblx0XHR7XG5cdFx0XHR2YXIgdGMxLCB0YzIsIHRjMywgdGM0LCB0czUsIHRzNiwgdHM3LCB0czg7XG5cdFx0XHQvKiAxLDIsIDUsNiwgOSwxMCwgMTMsMTQsIDE3ICovXG5cdFx0XHR0YzEgPSBfaW5bMTddIC0gX2luWzldO1xuXHRcdFx0dGMzID0gX2luWzE1XSAtIF9pblsxMV07XG5cdFx0XHR0YzQgPSBfaW5bMTRdIC0gX2luWzEyXTtcblx0XHRcdHRzNSA9IF9pblswXSArIF9pbls4XTtcblx0XHRcdHRzNiA9IF9pblsxXSArIF9pbls3XTtcblx0XHRcdHRzNyA9IF9pblsyXSArIF9pbls2XTtcblx0XHRcdHRzOCA9IF9pblszXSArIF9pbls1XTtcblxuXHRcdFx0b3V0W291dFBvcyArIDE3XSA9ICh0czUgKyB0czcgLSB0czgpIC0gKHRzNiAtIF9pbls0XSk7XG5cdFx0XHRzdCA9ICh0czUgKyB0czcgLSB0czgpICogY3hbMTIgKyA3XSArICh0czYgLSBfaW5bNF0pO1xuXHRcdFx0Y3QgPSAodGMxIC0gdGMzIC0gdGM0KSAqIGN4WzEyICsgNl07XG5cdFx0XHRvdXRbb3V0UG9zICsgNV0gPSBjdCArIHN0O1xuXHRcdFx0b3V0W291dFBvcyArIDZdID0gY3QgLSBzdDtcblxuXHRcdFx0dGMyID0gKF9pblsxNl0gLSBfaW5bMTBdKSAqIGN4WzEyICsgNl07XG5cdFx0XHR0czYgPSB0czYgKiBjeFsxMiArIDddICsgX2luWzRdO1xuXHRcdFx0Y3QgPSB0YzEgKiBjeFsxMiArIDBdICsgdGMyICsgdGMzICogY3hbMTIgKyAxXSArIHRjNCAqIGN4WzEyICsgMl07XG5cdFx0XHRzdCA9IC10czUgKiBjeFsxMiArIDRdICsgdHM2IC0gdHM3ICogY3hbMTIgKyA1XSArIHRzOCAqIGN4WzEyICsgM107XG5cdFx0XHRvdXRbb3V0UG9zICsgMV0gPSBjdCArIHN0O1xuXHRcdFx0b3V0W291dFBvcyArIDJdID0gY3QgLSBzdDtcblxuXHRcdFx0Y3QgPSB0YzEgKiBjeFsxMiArIDFdIC0gdGMyIC0gdGMzICogY3hbMTIgKyAyXSArIHRjNCAqIGN4WzEyICsgMF07XG5cdFx0XHRzdCA9IC10czUgKiBjeFsxMiArIDVdICsgdHM2IC0gdHM3ICogY3hbMTIgKyAzXSArIHRzOCAqIGN4WzEyICsgNF07XG5cdFx0XHRvdXRbb3V0UG9zICsgOV0gPSBjdCArIHN0O1xuXHRcdFx0b3V0W291dFBvcyArIDEwXSA9IGN0IC0gc3Q7XG5cblx0XHRcdGN0ID0gdGMxICogY3hbMTIgKyAyXSAtIHRjMiArIHRjMyAqIGN4WzEyICsgMF0gLSB0YzQgKiBjeFsxMiArIDFdO1xuXHRcdFx0c3QgPSB0czUgKiBjeFsxMiArIDNdIC0gdHM2ICsgdHM3ICogY3hbMTIgKyA0XSAtIHRzOCAqIGN4WzEyICsgNV07XG5cdFx0XHRvdXRbb3V0UG9zICsgMTNdID0gY3QgKyBzdDtcblx0XHRcdG91dFtvdXRQb3MgKyAxNF0gPSBjdCAtIHN0O1xuXHRcdH1cblx0XHR7XG5cdFx0XHR2YXIgdHMxLCB0czIsIHRzMywgdHM0LCB0YzUsIHRjNiwgdGM3LCB0Yzg7XG5cblx0XHRcdHRzMSA9IF9pbls4XSAtIF9pblswXTtcblx0XHRcdHRzMyA9IF9pbls2XSAtIF9pblsyXTtcblx0XHRcdHRzNCA9IF9pbls1XSAtIF9pblszXTtcblx0XHRcdHRjNSA9IF9pblsxN10gKyBfaW5bOV07XG5cdFx0XHR0YzYgPSBfaW5bMTZdICsgX2luWzEwXTtcblx0XHRcdHRjNyA9IF9pblsxNV0gKyBfaW5bMTFdO1xuXHRcdFx0dGM4ID0gX2luWzE0XSArIF9pblsxMl07XG5cblx0XHRcdG91dFtvdXRQb3MgKyAwXSA9ICh0YzUgKyB0YzcgKyB0YzgpICsgKHRjNiArIF9pblsxM10pO1xuXHRcdFx0Y3QgPSAodGM1ICsgdGM3ICsgdGM4KSAqIGN4WzEyICsgN10gLSAodGM2ICsgX2luWzEzXSk7XG5cdFx0XHRzdCA9ICh0czEgLSB0czMgKyB0czQpICogY3hbMTIgKyA2XTtcblx0XHRcdG91dFtvdXRQb3MgKyAxMV0gPSBjdCArIHN0O1xuXHRcdFx0b3V0W291dFBvcyArIDEyXSA9IGN0IC0gc3Q7XG5cblx0XHRcdHRzMiA9IChfaW5bN10gLSBfaW5bMV0pICogY3hbMTIgKyA2XTtcblx0XHRcdHRjNiA9IF9pblsxM10gLSB0YzYgKiBjeFsxMiArIDddO1xuXHRcdFx0Y3QgPSB0YzUgKiBjeFsxMiArIDNdIC0gdGM2ICsgdGM3ICogY3hbMTIgKyA0XSArIHRjOCAqIGN4WzEyICsgNV07XG5cdFx0XHRzdCA9IHRzMSAqIGN4WzEyICsgMl0gKyB0czIgKyB0czMgKiBjeFsxMiArIDBdICsgdHM0ICogY3hbMTIgKyAxXTtcblx0XHRcdG91dFtvdXRQb3MgKyAzXSA9IGN0ICsgc3Q7XG5cdFx0XHRvdXRbb3V0UG9zICsgNF0gPSBjdCAtIHN0O1xuXG5cdFx0XHRjdCA9IC10YzUgKiBjeFsxMiArIDVdICsgdGM2IC0gdGM3ICogY3hbMTIgKyAzXSAtIHRjOCAqIGN4WzEyICsgNF07XG5cdFx0XHRzdCA9IHRzMSAqIGN4WzEyICsgMV0gKyB0czIgLSB0czMgKiBjeFsxMiArIDJdIC0gdHM0ICogY3hbMTIgKyAwXTtcblx0XHRcdG91dFtvdXRQb3MgKyA3XSA9IGN0ICsgc3Q7XG5cdFx0XHRvdXRbb3V0UG9zICsgOF0gPSBjdCAtIHN0O1xuXG5cdFx0XHRjdCA9IC10YzUgKiBjeFsxMiArIDRdICsgdGM2IC0gdGM3ICogY3hbMTIgKyA1XSAtIHRjOCAqIGN4WzEyICsgM107XG5cdFx0XHRzdCA9IHRzMSAqIGN4WzEyICsgMF0gLSB0czIgKyB0czMgKiBjeFsxMiArIDFdIC0gdHM0ICogY3hbMTIgKyAyXTtcblx0XHRcdG91dFtvdXRQb3MgKyAxNV0gPSBjdCArIHN0O1xuXHRcdFx0b3V0W291dFBvcyArIDE2XSA9IGN0IC0gc3Q7XG5cdFx0fVxuXHR9XG5cblx0dGhpcy5tZGN0X3N1YjQ4ID0gZnVuY3Rpb24oZ2ZjLCB3MCwgdzEpIHtcblx0XHR2YXIgd2sgPSB3MDtcblx0XHR2YXIgd2tQb3MgPSAyODY7XG5cdFx0LyogdGhpbmtpbmcgY2FjaGUgcGVyZm9ybWFuY2UsIGNoLT5nciBsb29wIGlzIGJldHRlciB0aGFuIGdyLT5jaCBsb29wICovXG5cdFx0Zm9yICh2YXIgY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcblx0XHRcdGZvciAodmFyIGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuXHRcdFx0XHR2YXIgYmFuZDtcblx0XHRcdFx0dmFyIGdpID0gKGdmYy5sM19zaWRlLnR0W2dyXVtjaF0pO1xuXHRcdFx0XHR2YXIgbWRjdF9lbmMgPSBnaS54cjtcblx0XHRcdFx0dmFyIG1kY3RfZW5jUG9zID0gMDtcblx0XHRcdFx0dmFyIHNhbXAgPSBnZmMuc2Jfc2FtcGxlW2NoXVsxIC0gZ3JdO1xuXHRcdFx0XHR2YXIgc2FtcFBvcyA9IDA7XG5cblx0XHRcdFx0Zm9yICh2YXIgayA9IDA7IGsgPCAxOCAvIDI7IGsrKykge1xuXHRcdFx0XHRcdHdpbmRvd19zdWJiYW5kKHdrLCB3a1Bvcywgc2FtcFtzYW1wUG9zXSk7XG5cdFx0XHRcdFx0d2luZG93X3N1YmJhbmQod2ssIHdrUG9zICsgMzIsIHNhbXBbc2FtcFBvcyArIDFdKTtcblx0XHRcdFx0XHRzYW1wUG9zICs9IDI7XG5cdFx0XHRcdFx0d2tQb3MgKz0gNjQ7XG5cdFx0XHRcdFx0Lypcblx0XHRcdFx0XHQgKiBDb21wZW5zYXRlIGZvciBpbnZlcnNpb24gaW4gdGhlIGFuYWx5c2lzIGZpbHRlclxuXHRcdFx0XHRcdCAqL1xuXHRcdFx0XHRcdGZvciAoYmFuZCA9IDE7IGJhbmQgPCAzMjsgYmFuZCArPSAyKSB7XG5cdFx0XHRcdFx0XHRzYW1wW3NhbXBQb3MgLSAxXVtiYW5kXSAqPSAtMTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvKlxuXHRcdFx0XHQgKiBQZXJmb3JtIGltZGN0IG9mIDE4IHByZXZpb3VzIHN1YmJhbmQgc2FtcGxlcyArIDE4IGN1cnJlbnRcblx0XHRcdFx0ICogc3ViYmFuZCBzYW1wbGVzXG5cdFx0XHRcdCAqL1xuXHRcdFx0XHRmb3IgKGJhbmQgPSAwOyBiYW5kIDwgMzI7IGJhbmQrKywgbWRjdF9lbmNQb3MgKz0gMTgpIHtcblx0XHRcdFx0XHR2YXIgdHlwZSA9IGdpLmJsb2NrX3R5cGU7XG5cdFx0XHRcdFx0dmFyIGJhbmQwID0gZ2ZjLnNiX3NhbXBsZVtjaF1bZ3JdO1xuXHRcdFx0XHRcdHZhciBiYW5kMSA9IGdmYy5zYl9zYW1wbGVbY2hdWzEgLSBncl07XG5cdFx0XHRcdFx0aWYgKGdpLm1peGVkX2Jsb2NrX2ZsYWcgIT0gMCAmJiBiYW5kIDwgMilcblx0XHRcdFx0XHRcdHR5cGUgPSAwO1xuXHRcdFx0XHRcdGlmIChnZmMuYW1wX2ZpbHRlcltiYW5kXSA8IDFlLTEyKSB7XG5cdFx0XHRcdFx0XHRBcnJheXMuZmlsbChtZGN0X2VuYywgbWRjdF9lbmNQb3MgKyAwLFxuXHRcdFx0XHRcdFx0XHRcdG1kY3RfZW5jUG9zICsgMTgsIDApO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRpZiAoZ2ZjLmFtcF9maWx0ZXJbYmFuZF0gPCAxLjApIHtcblx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgayA9IDA7IGsgPCAxODsgaysrKVxuXHRcdFx0XHRcdFx0XHRcdGJhbmQxW2tdW29yZGVyW2JhbmRdXSAqPSBnZmMuYW1wX2ZpbHRlcltiYW5kXTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGlmICh0eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuXHRcdFx0XHRcdFx0XHRmb3IgKHZhciBrID0gLU5TIC8gNDsgayA8IDA7IGsrKykge1xuXHRcdFx0XHRcdFx0XHRcdHZhciB3ID0gd2luW0VuY29kZXIuU0hPUlRfVFlQRV1bayArIDNdO1xuXHRcdFx0XHRcdFx0XHRcdG1kY3RfZW5jW21kY3RfZW5jUG9zICsgayAqIDMgKyA5XSA9IGJhbmQwWzkgKyBrXVtvcmRlcltiYW5kXV1cblx0XHRcdFx0XHRcdFx0XHRcdFx0KiB3IC0gYmFuZDBbOCAtIGtdW29yZGVyW2JhbmRdXTtcblx0XHRcdFx0XHRcdFx0XHRtZGN0X2VuY1ttZGN0X2VuY1BvcyArIGsgKiAzICsgMThdID0gYmFuZDBbMTQgLSBrXVtvcmRlcltiYW5kXV1cblx0XHRcdFx0XHRcdFx0XHRcdFx0KiB3ICsgYmFuZDBbMTUgKyBrXVtvcmRlcltiYW5kXV07XG5cdFx0XHRcdFx0XHRcdFx0bWRjdF9lbmNbbWRjdF9lbmNQb3MgKyBrICogMyArIDEwXSA9IGJhbmQwWzE1ICsga11bb3JkZXJbYmFuZF1dXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCogdyAtIGJhbmQwWzE0IC0ga11bb3JkZXJbYmFuZF1dO1xuXHRcdFx0XHRcdFx0XHRcdG1kY3RfZW5jW21kY3RfZW5jUG9zICsgayAqIDMgKyAxOV0gPSBiYW5kMVsyIC0ga11bb3JkZXJbYmFuZF1dXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCogdyArIGJhbmQxWzMgKyBrXVtvcmRlcltiYW5kXV07XG5cdFx0XHRcdFx0XHRcdFx0bWRjdF9lbmNbbWRjdF9lbmNQb3MgKyBrICogMyArIDExXSA9IGJhbmQxWzMgKyBrXVtvcmRlcltiYW5kXV1cblx0XHRcdFx0XHRcdFx0XHRcdFx0KiB3IC0gYmFuZDFbMiAtIGtdW29yZGVyW2JhbmRdXTtcblx0XHRcdFx0XHRcdFx0XHRtZGN0X2VuY1ttZGN0X2VuY1BvcyArIGsgKiAzICsgMjBdID0gYmFuZDFbOCAtIGtdW29yZGVyW2JhbmRdXVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQqIHcgKyBiYW5kMVs5ICsga11bb3JkZXJbYmFuZF1dO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdG1kY3Rfc2hvcnQobWRjdF9lbmMsIG1kY3RfZW5jUG9zKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHZhciB3b3JrID0gbmV3X2Zsb2F0KDE4KTtcblx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgayA9IC1OTCAvIDQ7IGsgPCAwOyBrKyspIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgYSwgYjtcblx0XHRcdFx0XHRcdFx0XHRhID0gd2luW3R5cGVdW2sgKyAyN11cblx0XHRcdFx0XHRcdFx0XHRcdFx0KiBiYW5kMVtrICsgOV1bb3JkZXJbYmFuZF1dXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCsgd2luW3R5cGVdW2sgKyAzNl1cblx0XHRcdFx0XHRcdFx0XHRcdFx0KiBiYW5kMVs4IC0ga11bb3JkZXJbYmFuZF1dO1xuXHRcdFx0XHRcdFx0XHRcdGIgPSB3aW5bdHlwZV1bayArIDldXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCogYmFuZDBbayArIDldW29yZGVyW2JhbmRdXVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQtIHdpblt0eXBlXVtrICsgMThdXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCogYmFuZDBbOCAtIGtdW29yZGVyW2JhbmRdXTtcblx0XHRcdFx0XHRcdFx0XHR3b3JrW2sgKyA5XSA9IGEgLSBiICogdGFudGFiX2xbMyArIGsgKyA5XTtcblx0XHRcdFx0XHRcdFx0XHR3b3JrW2sgKyAxOF0gPSBhICogdGFudGFiX2xbMyArIGsgKyA5XSArIGI7XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRtZGN0X2xvbmcobWRjdF9lbmMsIG1kY3RfZW5jUG9zLCB3b3JrKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Lypcblx0XHRcdFx0XHQgKiBQZXJmb3JtIGFsaWFzaW5nIHJlZHVjdGlvbiBidXR0ZXJmbHlcblx0XHRcdFx0XHQgKi9cblx0XHRcdFx0XHRpZiAodHlwZSAhPSBFbmNvZGVyLlNIT1JUX1RZUEUgJiYgYmFuZCAhPSAwKSB7XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBrID0gNzsgayA+PSAwOyAtLWspIHtcblx0XHRcdFx0XHRcdFx0dmFyIGJ1LCBiZDtcblx0XHRcdFx0XHRcdFx0YnUgPSBtZGN0X2VuY1ttZGN0X2VuY1BvcyArIGtdICogY2FbMjAgKyBrXVxuXHRcdFx0XHRcdFx0XHRcdFx0KyBtZGN0X2VuY1ttZGN0X2VuY1BvcyArIC0xIC0ga11cblx0XHRcdFx0XHRcdFx0XHRcdCogY3NbMjggKyBrXTtcblx0XHRcdFx0XHRcdFx0YmQgPSBtZGN0X2VuY1ttZGN0X2VuY1BvcyArIGtdICogY3NbMjggKyBrXVxuXHRcdFx0XHRcdFx0XHRcdFx0LSBtZGN0X2VuY1ttZGN0X2VuY1BvcyArIC0xIC0ga11cblx0XHRcdFx0XHRcdFx0XHRcdCogY2FbMjAgKyBrXTtcblxuXHRcdFx0XHRcdFx0XHRtZGN0X2VuY1ttZGN0X2VuY1BvcyArIC0xIC0ga10gPSBidTtcblx0XHRcdFx0XHRcdFx0bWRjdF9lbmNbbWRjdF9lbmNQb3MgKyBrXSA9IGJkO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0d2sgPSB3MTtcblx0XHRcdHdrUG9zID0gMjg2O1xuXHRcdFx0aWYgKGdmYy5tb2RlX2dyID09IDEpIHtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCAxODsgaSsrKSB7XG5cdFx0XHRcdFx0U3lzdGVtLmFycmF5Y29weShnZmMuc2Jfc2FtcGxlW2NoXVsxXVtpXSwgMCxcblx0XHRcdFx0XHRcdFx0Z2ZjLnNiX3NhbXBsZVtjaF1bMF1baV0sIDAsIDMyKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxufVxuXG4vL3BhY2thZ2UgbXAzO1xuXG5cbmZ1bmN0aW9uIElJSV9wc3lfcmF0aW8oKSB7XG5cdHRoaXMudGhtID0gbmV3IElJSV9wc3lfeG1pbigpO1xuXHR0aGlzLmVuID0gbmV3IElJSV9wc3lfeG1pbigpO1xufVxuXG5cbi8qKlxuICogRU5DREVMQVkgVGhlIGVuY29kZXIgZGVsYXkuXG4gKlxuICogTWluaW11bSBhbGxvd2VkIGlzIE1EQ1RERUxBWSAoc2VlIGJlbG93KVxuICpcbiAqIFRoZSBmaXJzdCA5NiBzYW1wbGVzIHdpbGwgYmUgYXR0ZW51YXRlZCwgc28gdXNpbmcgYSB2YWx1ZSBsZXNzIHRoYW4gOTZcbiAqIHdpbGwgcmVzdWx0IGluIGNvcnJ1cHQgZGF0YSBmb3IgdGhlIGZpcnN0IDk2LUVOQ0RFTEFZIHNhbXBsZXMuXG4gKlxuICogc3VnZ2VzdGVkOiA1NzYgc2V0IHRvIDExNjAgdG8gc3luYyB3aXRoIEZoRy5cbiAqL1xuRW5jb2Rlci5FTkNERUxBWSA9IDU3Njtcbi8qKlxuICogbWFrZSBzdXJlIHRoZXJlIGlzIGF0IGxlYXN0IG9uZSBjb21wbGV0ZSBmcmFtZSBhZnRlciB0aGUgbGFzdCBmcmFtZVxuICogY29udGFpbmluZyByZWFsIGRhdGFcbiAqXG4gKiBVc2luZyBhIHZhbHVlIG9mIDI4OCB3b3VsZCBiZSBzdWZmaWNpZW50IGZvciBhIGEgdmVyeSBzb3BoaXN0aWNhdGVkXG4gKiBkZWNvZGVyIHRoYXQgY2FuIGRlY29kZSBncmFudWxlLWJ5LWdyYW51bGUgaW5zdGVhZCBvZiBmcmFtZSBieSBmcmFtZS4gQnV0XG4gKiBsZXRzIG5vdCBhc3N1bWUgdGhpcywgYW5kIGFzc3VtZSB0aGUgZGVjb2RlciB3aWxsIG5vdCBkZWNvZGUgZnJhbWUgTlxuICogdW5sZXNzIGl0IGFsc28gaGFzIGRhdGEgZm9yIGZyYW1lIE4rMVxuICovXG5FbmNvZGVyLlBPU1RERUxBWSA9IDExNTI7XG5cbi8qKlxuICogZGVsYXkgb2YgdGhlIE1EQ1QgdXNlZCBpbiBtZGN0LmMgb3JpZ2luYWwgSVNPIHJvdXRpbmVzIGhhZCBhIGRlbGF5IG9mXG4gKiA1MjghIFRha2VoaXJvJ3Mgcm91dGluZXM6XG4gKi9cbkVuY29kZXIuTURDVERFTEFZID0gNDg7XG5FbmNvZGVyLkZGVE9GRlNFVCA9ICgyMjQgKyBFbmNvZGVyLk1EQ1RERUxBWSk7XG5cbi8qKlxuICogTW9zdCBkZWNvZGVycywgaW5jbHVkaW5nIHRoZSBvbmUgd2UgdXNlLCBoYXZlIGEgZGVsYXkgb2YgNTI4IHNhbXBsZXMuXG4gKi9cbkVuY29kZXIuREVDREVMQVkgPSA1Mjg7XG5cbi8qKlxuICogbnVtYmVyIG9mIHN1YmJhbmRzXG4gKi9cbkVuY29kZXIuU0JMSU1JVCA9IDMyO1xuXG4vKipcbiAqIHBhcml0aW9uIGJhbmRzIGJhbmRzXG4gKi9cbkVuY29kZXIuQ0JBTkRTID0gNjQ7XG5cbi8qKlxuICogbnVtYmVyIG9mIGNyaXRpY2FsIGJhbmRzL3NjYWxlIGZhY3RvciBiYW5kcyB3aGVyZSBtYXNraW5nIGlzIGNvbXB1dGVkXG4gKi9cbkVuY29kZXIuU0JQU1lfbCA9IDIxO1xuRW5jb2Rlci5TQlBTWV9zID0gMTI7XG5cbi8qKlxuICogdG90YWwgbnVtYmVyIG9mIHNjYWxlZmFjdG9yIGJhbmRzIGVuY29kZWRcbiAqL1xuRW5jb2Rlci5TQk1BWF9sID0gMjI7XG5FbmNvZGVyLlNCTUFYX3MgPSAxMztcbkVuY29kZXIuUFNGQjIxID0gNjtcbkVuY29kZXIuUFNGQjEyID0gNjtcblxuLyoqXG4gKiBGRlQgc2l6ZXNcbiAqL1xuRW5jb2Rlci5CTEtTSVpFID0gMTAyNDtcbkVuY29kZXIuSEJMS1NJWkUgPSAoRW5jb2Rlci5CTEtTSVpFIC8gMiArIDEpO1xuRW5jb2Rlci5CTEtTSVpFX3MgPSAyNTY7XG5FbmNvZGVyLkhCTEtTSVpFX3MgPSAoRW5jb2Rlci5CTEtTSVpFX3MgLyAyICsgMSk7XG5cbkVuY29kZXIuTk9STV9UWVBFID0gMDtcbkVuY29kZXIuU1RBUlRfVFlQRSA9IDE7XG5FbmNvZGVyLlNIT1JUX1RZUEUgPSAyO1xuRW5jb2Rlci5TVE9QX1RZUEUgPSAzO1xuXG4vKipcbiAqIDxQUkU+XG4gKiBNb2RlIEV4dGVudGlvbjpcbiAqIFdoZW4gd2UgYXJlIGluIHN0ZXJlbyBtb2RlLCB0aGVyZSBhcmUgNCBwb3NzaWJsZSBtZXRob2RzIHRvIHN0b3JlIHRoZXNlXG4gKiB0d28gY2hhbm5lbHMuIFRoZSBzdGVyZW8gbW9kZXMgLW0/IGFyZSB1c2luZyBhIHN1YnNldCBvZiB0aGVtLlxuICpcbiAqICAtbXM6IE1QR19NRF9MUl9MUlxuICogIC1tajogTVBHX01EX0xSX0xSIGFuZCBNUEdfTURfTVNfTFJcbiAqICAtbWY6IE1QR19NRF9NU19MUlxuICogIC1taTogYWxsXG4gKiA8L1BSRT5cbiAqL1xuRW5jb2Rlci5NUEdfTURfTFJfTFIgPSAwO1xuRW5jb2Rlci5NUEdfTURfTFJfSSA9IDE7XG5FbmNvZGVyLk1QR19NRF9NU19MUiA9IDI7XG5FbmNvZGVyLk1QR19NRF9NU19JID0gMztcblxuRW5jb2Rlci5maXJjb2VmID0gWy0wLjAyMDc4ODcgKiA1LCAtMC4wMzc4NDEzICogNSxcbiAgICAtMC4wNDMyNDcyICogNSwgLTAuMDMxMTgzICogNSwgNy43OTYwOWUtMTggKiA1LCAwLjA0Njc3NDUgKiA1LFxuICAgIDAuMTAwOTEgKiA1LCAwLjE1MTM2NSAqIDUsIDAuMTg3MDk4ICogNV07XG5cbmZ1bmN0aW9uIEVuY29kZXIoKSB7XG5cbiAgICB2YXIgRkZUT0ZGU0VUID0gRW5jb2Rlci5GRlRPRkZTRVQ7XG4gICAgdmFyIE1QR19NRF9NU19MUiA9IEVuY29kZXIuTVBHX01EX01TX0xSO1xuICAgIC8vQml0U3RyZWFtIGJzO1xuICAgIC8vUHN5TW9kZWwgcHN5O1xuICAgIC8vVkJSVGFnIHZicjtcbiAgICAvL1F1YW50aXplUFZUIHF1cHZ0O1xuICAgIHZhciBicyA9IG51bGw7XG4gICAgdGhpcy5wc3kgPSBudWxsO1xuICAgIHZhciBwc3kgPSBudWxsO1xuICAgIHZhciB2YnIgPSBudWxsO1xuICAgIHZhciBxdXB2dCA9IG51bGw7XG5cbiAgICAvL3B1YmxpYyBmaW5hbCB2b2lkIHNldE1vZHVsZXMoQml0U3RyZWFtIGJzLCBQc3lNb2RlbCBwc3ksIFF1YW50aXplUFZUIHF1cHZ0LFxuICAgIC8vICAgIFZCUlRhZyB2YnIpIHtcbiAgICB0aGlzLnNldE1vZHVsZXMgPSBmdW5jdGlvbiAoX2JzLCBfcHN5LCBfcXVwdnQsIF92YnIpIHtcbiAgICAgICAgYnMgPSBfYnM7XG4gICAgICAgIHRoaXMucHN5ID0gX3BzeTtcbiAgICAgICAgcHN5ID0gX3BzeTtcbiAgICAgICAgdmJyID0gX3ZicjtcbiAgICAgICAgcXVwdnQgPSBfcXVwdnQ7XG4gICAgfTtcblxuICAgIHZhciBuZXdNRENUID0gbmV3IE5ld01EQ1QoKTtcblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAqXG4gICAgICogZW5jb2RlciBhbmQgZGVjb2RlciBkZWxheXNcbiAgICAgKlxuICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIC8qKlxuICAgICAqIDxQUkU+XG4gICAgICogbGF5ZXIgSUlJIGVuYy0+ZGVjIGRlbGF5OiAgMTA1NiAoMTA1Nz8pICAgKG9ic2VydmVkKVxuICAgICAqIGxheWVyICBJSSBlbmMtPmRlYyBkZWxheTogICA0ODAgICg0ODE/KSAgIChvYnNlcnZlZClcbiAgICAgKlxuICAgICAqIHBvbHlwaGFzZSAyNTYtMTYgICAgICAgICAgICAgKGRlYyBvciBlbmMpICAgICAgICA9IDI0MFxuICAgICAqIG1kY3QgICAgICAyNTYrMzIgICg5KjMyKSAgICAgKGRlYyBvciBlbmMpICAgICAgICA9IDI4OFxuICAgICAqIHRvdGFsOiAgICA1MTIrMTZcbiAgICAgKlxuICAgICAqIE15IGd1ZXNzIGlzIHRoYXQgZGVsYXkgb2YgcG9seXBoYXNlIGZpbHRlcmJhbmsgaXMgYWN0dWFseSAyNDAuNVxuICAgICAqICh0aGVyZSBhcmUgdGVjaG5pY2FsIHJlYXNvbnMgZm9yIHRoaXMsIHNlZSBwb3N0aW5ncyBpbiBtcDNlbmNvZGVyKS5cbiAgICAgKiBTbyB0b3RhbCBFbmNvZGUrRGVjb2RlIGRlbGF5ID0gRU5DREVMQVkgKyA1MjggKyAxXG4gICAgICogPC9QUkU+XG4gICAgICovXG5cblxuICAgIC8qKlxuICAgICAqIGF1dG8tYWRqdXN0IG9mIEFUSCwgdXNlZnVsIGZvciBsb3cgdm9sdW1lIEdhYnJpZWwgQm91dmlnbmUgMyBmZWIgMjAwMVxuICAgICAqXG4gICAgICogbW9kaWZpZXMgc29tZSB2YWx1ZXMgaW4gZ2ZwLmludGVybmFsX2ZsYWdzLkFUSCAoZ2ZjLkFUSClcbiAgICAgKi9cbi8vcHJpdmF0ZSB2b2lkIGFkanVzdF9BVEgoZmluYWwgTGFtZUludGVybmFsRmxhZ3MgZ2ZjKSB7XG4gICAgZnVuY3Rpb24gYWRqdXN0X0FUSChnZmMpIHtcbiAgICAgICAgdmFyIGdyMl9tYXgsIG1heF9wb3c7XG5cbiAgICAgICAgaWYgKGdmYy5BVEgudXNlQWRqdXN0ID09IDApIHtcbiAgICAgICAgICAgIGdmYy5BVEguYWRqdXN0ID0gMS4wO1xuICAgICAgICAgICAgLyogbm8gYWRqdXN0bWVudCAqL1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogamQgLSAyMDAxIG1hciAxMiwgMjcsIGp1biAzMCAqL1xuICAgICAgICAvKiBsb3VkbmVzcyBiYXNlZCBvbiBlcXVhbCBsb3VkbmVzcyBjdXJ2ZTsgKi9cbiAgICAgICAgLyogdXNlIGdyYW51bGUgd2l0aCBtYXhpbXVtIGNvbWJpbmVkIGxvdWRuZXNzICovXG4gICAgICAgIG1heF9wb3cgPSBnZmMubG91ZG5lc3Nfc3FbMF1bMF07XG4gICAgICAgIGdyMl9tYXggPSBnZmMubG91ZG5lc3Nfc3FbMV1bMF07XG4gICAgICAgIGlmIChnZmMuY2hhbm5lbHNfb3V0ID09IDIpIHtcbiAgICAgICAgICAgIG1heF9wb3cgKz0gZ2ZjLmxvdWRuZXNzX3NxWzBdWzFdO1xuICAgICAgICAgICAgZ3IyX21heCArPSBnZmMubG91ZG5lc3Nfc3FbMV1bMV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtYXhfcG93ICs9IG1heF9wb3c7XG4gICAgICAgICAgICBncjJfbWF4ICs9IGdyMl9tYXg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGdmYy5tb2RlX2dyID09IDIpIHtcbiAgICAgICAgICAgIG1heF9wb3cgPSBNYXRoLm1heChtYXhfcG93LCBncjJfbWF4KTtcbiAgICAgICAgfVxuICAgICAgICBtYXhfcG93ICo9IDAuNTtcbiAgICAgICAgLyogbWF4X3BvdyBhcHByb2FjaGVzIDEuMCBmb3IgZnVsbCBiYW5kIG5vaXNlICovXG5cbiAgICAgICAgLyogamQgLSAyMDAxIG1hciAzMSwganVuIDMwICovXG4gICAgICAgIC8qIHVzZXIgdHVuaW5nIG9mIEFUSCBhZGp1c3RtZW50IHJlZ2lvbiAqL1xuICAgICAgICBtYXhfcG93ICo9IGdmYy5BVEguYWFTZW5zaXRpdml0eVA7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogYWRqdXN0IEFUSCBkZXBlbmRpbmcgb24gcmFuZ2Ugb2YgbWF4aW11bSB2YWx1ZVxuICAgICAgICAgKi9cblxuICAgICAgICAvKiBqZCAtIDIwMDEgZmViMjcsIG1hcjEyLDIwLCBqdW4zMCwganVsMjIgKi9cbiAgICAgICAgLyogY29udGludW91cyBjdXJ2ZXMgYmFzZWQgb24gYXBwcm94aW1hdGlvbiAqL1xuICAgICAgICAvKiB0byBHQidzIG9yaWdpbmFsIHZhbHVlcy4gKi9cbiAgICAgICAgLyogRm9yIGFuIGluY3JlYXNlIGluIGFwcHJveGltYXRlIGxvdWRuZXNzLCAqL1xuICAgICAgICAvKiBzZXQgQVRIIGFkanVzdCB0byBhZGp1c3RfbGltaXQgaW1tZWRpYXRlbHkgKi9cbiAgICAgICAgLyogYWZ0ZXIgYSBkZWxheSBvZiBvbmUgZnJhbWUuICovXG4gICAgICAgIC8qIEZvciBhIGxvdWRuZXNzIGRlY3JlYXNlLCByZWR1Y2UgQVRIIGFkanVzdCAqL1xuICAgICAgICAvKiB0b3dhcmRzIGFkanVzdF9saW1pdCBncmFkdWFsbHkuICovXG4gICAgICAgIC8qIG1heF9wb3cgaXMgYSBsb3VkbmVzcyBzcXVhcmVkIG9yIGEgcG93ZXIuICovXG4gICAgICAgIGlmIChtYXhfcG93ID4gMC4wMzEyNSkgeyAvKiAoKDEgLSAwLjAwMDYyNSkvIDMxLjk4KSBmcm9tIGN1cnZlIGJlbG93ICovXG4gICAgICAgICAgICBpZiAoZ2ZjLkFUSC5hZGp1c3QgPj0gMS4wKSB7XG4gICAgICAgICAgICAgICAgZ2ZjLkFUSC5hZGp1c3QgPSAxLjA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8qIHByZWNlZGluZyBmcmFtZSBoYXMgbG93ZXIgQVRIIGFkanVzdDsgKi9cbiAgICAgICAgICAgICAgICAvKiBhc2NlbmQgb25seSB0byB0aGUgcHJlY2VkaW5nIGFkanVzdF9saW1pdCAqL1xuICAgICAgICAgICAgICAgIC8qIGluIGNhc2UgdGhlcmUgaXMgbGVhZGluZyBsb3cgdm9sdW1lICovXG4gICAgICAgICAgICAgICAgaWYgKGdmYy5BVEguYWRqdXN0IDwgZ2ZjLkFUSC5hZGp1c3RMaW1pdCkge1xuICAgICAgICAgICAgICAgICAgICBnZmMuQVRILmFkanVzdCA9IGdmYy5BVEguYWRqdXN0TGltaXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLkFUSC5hZGp1c3RMaW1pdCA9IDEuMDtcbiAgICAgICAgfSBlbHNlIHsgLyogYWRqdXN0bWVudCBjdXJ2ZSAqL1xuICAgICAgICAgICAgLyogYWJvdXQgMzIgZEIgbWF4aW11bSBhZGp1c3QgKDAuMDAwNjI1KSAqL1xuICAgICAgICAgICAgdmFyIGFkal9saW1fbmV3ID0gMzEuOTggKiBtYXhfcG93ICsgMC4wMDA2MjU7XG4gICAgICAgICAgICBpZiAoZ2ZjLkFUSC5hZGp1c3QgPj0gYWRqX2xpbV9uZXcpIHsgLyogZGVzY2VuZCBncmFkdWFsbHkgKi9cbiAgICAgICAgICAgICAgICBnZmMuQVRILmFkanVzdCAqPSBhZGpfbGltX25ldyAqIDAuMDc1ICsgMC45MjU7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5BVEguYWRqdXN0IDwgYWRqX2xpbV9uZXcpIHsgLyogc3RvcCBkZXNjZW50ICovXG4gICAgICAgICAgICAgICAgICAgIGdmYy5BVEguYWRqdXN0ID0gYWRqX2xpbV9uZXc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHsgLyogYXNjZW5kICovXG4gICAgICAgICAgICAgICAgaWYgKGdmYy5BVEguYWRqdXN0TGltaXQgPj0gYWRqX2xpbV9uZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLkFUSC5hZGp1c3QgPSBhZGpfbGltX25ldztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvKiBwcmVjZWRpbmcgZnJhbWUgaGFzIGxvd2VyIEFUSCBhZGp1c3Q7ICovXG4gICAgICAgICAgICAgICAgICAgIC8qIGFzY2VuZCBvbmx5IHRvIHRoZSBwcmVjZWRpbmcgYWRqdXN0X2xpbWl0ICovXG4gICAgICAgICAgICAgICAgICAgIGlmIChnZmMuQVRILmFkanVzdCA8IGdmYy5BVEguYWRqdXN0TGltaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdmYy5BVEguYWRqdXN0ID0gZ2ZjLkFUSC5hZGp1c3RMaW1pdDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy5BVEguYWRqdXN0TGltaXQgPSBhZGpfbGltX25ldztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIDxQUkU+XG4gICAgICogIHNvbWUgc2ltcGxlIHN0YXRpc3RpY3NcbiAgICAgKlxuICAgICAqICBiaXRyYXRlIGluZGV4IDA6IGZyZWUgYml0cmF0ZSAuIG5vdCBhbGxvd2VkIGluIFZCUiBtb2RlXG4gICAgICogIDogYml0cmF0ZXMsIGticHMgZGVwZW5kaW5nIG9uIE1QRUcgdmVyc2lvblxuICAgICAqICBiaXRyYXRlIGluZGV4IDE1OiBmb3JiaWRkZW5cbiAgICAgKlxuICAgICAqICBtb2RlX2V4dDpcbiAgICAgKiAgMDogIExSXG4gICAgICogIDE6ICBMUi1pXG4gICAgICogIDI6ICBNU1xuICAgICAqICAzOiAgTVMtaVxuICAgICAqIDwvUFJFPlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHVwZGF0ZVN0YXRzKGdmYykge1xuICAgICAgICB2YXIgZ3IsIGNoO1xuXG4gICAgICAgIC8qIGNvdW50IGJpdHJhdGUgaW5kaWNlcyAqL1xuICAgICAgICBnZmMuYml0cmF0ZV9zdGVyZW9Nb2RlX0hpc3RbZ2ZjLmJpdHJhdGVfaW5kZXhdWzRdKys7XG4gICAgICAgIGdmYy5iaXRyYXRlX3N0ZXJlb01vZGVfSGlzdFsxNV1bNF0rKztcblxuICAgICAgICAvKiBjb3VudCAnZW0gZm9yIGV2ZXJ5IG1vZGUgZXh0ZW5zaW9uIGluIGNhc2Ugb2YgMiBjaGFubmVsIGVuY29kaW5nICovXG4gICAgICAgIGlmIChnZmMuY2hhbm5lbHNfb3V0ID09IDIpIHtcbiAgICAgICAgICAgIGdmYy5iaXRyYXRlX3N0ZXJlb01vZGVfSGlzdFtnZmMuYml0cmF0ZV9pbmRleF1bZ2ZjLm1vZGVfZXh0XSsrO1xuICAgICAgICAgICAgZ2ZjLmJpdHJhdGVfc3RlcmVvTW9kZV9IaXN0WzE1XVtnZmMubW9kZV9leHRdKys7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7ICsrZ3IpIHtcbiAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7ICsrY2gpIHtcbiAgICAgICAgICAgICAgICB2YXIgYnQgPSBnZmMubDNfc2lkZS50dFtncl1bY2hdLmJsb2NrX3R5cGUgfCAwO1xuICAgICAgICAgICAgICAgIGlmIChnZmMubDNfc2lkZS50dFtncl1bY2hdLm1peGVkX2Jsb2NrX2ZsYWcgIT0gMClcbiAgICAgICAgICAgICAgICAgICAgYnQgPSA0O1xuICAgICAgICAgICAgICAgIGdmYy5iaXRyYXRlX2Jsb2NrVHlwZV9IaXN0W2dmYy5iaXRyYXRlX2luZGV4XVtidF0rKztcbiAgICAgICAgICAgICAgICBnZmMuYml0cmF0ZV9ibG9ja1R5cGVfSGlzdFtnZmMuYml0cmF0ZV9pbmRleF1bNV0rKztcbiAgICAgICAgICAgICAgICBnZmMuYml0cmF0ZV9ibG9ja1R5cGVfSGlzdFsxNV1bYnRdKys7XG4gICAgICAgICAgICAgICAgZ2ZjLmJpdHJhdGVfYmxvY2tUeXBlX0hpc3RbMTVdWzVdKys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsYW1lX2VuY29kZV9mcmFtZV9pbml0KGdmcCwgaW5idWYpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblxuICAgICAgICB2YXIgY2gsIGdyO1xuXG4gICAgICAgIGlmIChnZmMubGFtZV9lbmNvZGVfZnJhbWVfaW5pdCA9PSAwKSB7XG4gICAgICAgICAgICAvKiBwcmltZSB0aGUgTURDVC9wb2x5cGhhc2UgZmlsdGVyYmFuayB3aXRoIGEgc2hvcnQgYmxvY2sgKi9cbiAgICAgICAgICAgIHZhciBpLCBqO1xuICAgICAgICAgICAgdmFyIHByaW1lYnVmZjAgPSBuZXdfZmxvYXQoMjg2ICsgMTE1MiArIDU3Nik7XG4gICAgICAgICAgICB2YXIgcHJpbWVidWZmMSA9IG5ld19mbG9hdCgyODYgKyAxMTUyICsgNTc2KTtcbiAgICAgICAgICAgIGdmYy5sYW1lX2VuY29kZV9mcmFtZV9pbml0ID0gMTtcbiAgICAgICAgICAgIGZvciAoaSA9IDAsIGogPSAwOyBpIDwgMjg2ICsgNTc2ICogKDEgKyBnZmMubW9kZV9ncik7ICsraSkge1xuICAgICAgICAgICAgICAgIGlmIChpIDwgNTc2ICogZ2ZjLm1vZGVfZ3IpIHtcbiAgICAgICAgICAgICAgICAgICAgcHJpbWVidWZmMFtpXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGlmIChnZmMuY2hhbm5lbHNfb3V0ID09IDIpXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmltZWJ1ZmYxW2ldID0gMDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwcmltZWJ1ZmYwW2ldID0gaW5idWZbMF1bal07XG4gICAgICAgICAgICAgICAgICAgIGlmIChnZmMuY2hhbm5lbHNfb3V0ID09IDIpXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmltZWJ1ZmYxW2ldID0gaW5idWZbMV1bal07XG4gICAgICAgICAgICAgICAgICAgICsrajtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBwb2x5cGhhc2UgZmlsdGVyaW5nIC8gbWRjdCAqL1xuICAgICAgICAgICAgZm9yIChnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGdmYy5sM19zaWRlLnR0W2dyXVtjaF0uYmxvY2tfdHlwZSA9IEVuY29kZXIuU0hPUlRfVFlQRTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZXdNRENULm1kY3Rfc3ViNDgoZ2ZjLCBwcmltZWJ1ZmYwLCBwcmltZWJ1ZmYxKTtcblxuICAgICAgICAgICAgLyogY2hlY2sgRkZUIHdpbGwgbm90IHVzZSBhIG5lZ2F0aXZlIHN0YXJ0aW5nIG9mZnNldCAqL1xuICAgICAgICAgICAgLyogY2hlY2sgaWYgd2UgaGF2ZSBlbm91Z2ggZGF0YSBmb3IgRkZUICovXG4gICAgICAgICAgICAvKiBjaGVjayBpZiB3ZSBoYXZlIGVub3VnaCBkYXRhIGZvciBwb2x5cGhhc2UgZmlsdGVyYmFuayAqL1xuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiA8UFJFPlxuICAgICAqIGVuY29kZWZyYW1lKCkgICAgICAgICAgIExheWVyIDNcbiAgICAgKlxuICAgICAqIGVuY29kZSBhIHNpbmdsZSBmcmFtZVxuICAgICAqXG4gICAgICpcbiAgICAgKiAgICBsYW1lX2VuY29kZV9mcmFtZSgpXG4gICAgICpcbiAgICAgKlxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3IgMCAgICAgICAgICAgIGdyIDFcbiAgICAgKiAgICBpbmJ1ZjogICAgICAgICAgIHwtLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLXxcbiAgICAgKlxuICAgICAqXG4gICAgICogICAgUG9seXBoYXNlICgxOCB3aW5kb3dzLCBlYWNoIHNoaWZ0ZWQgMzIpXG4gICAgICogICAgZ3IgMDpcbiAgICAgKiAgICB3aW5kb3cxICAgICAgICAgIDwtLS0tNTEyLS0tLlxuICAgICAqICAgIHdpbmRvdzE4ICAgICAgICAgICAgICAgICA8LS0tLTUxMi0tLS5cbiAgICAgKlxuICAgICAqICAgIGdyIDE6XG4gICAgICogICAgd2luZG93MSAgICAgICAgICAgICAgICAgICAgICAgICA8LS0tLTUxMi0tLS5cbiAgICAgKiAgICB3aW5kb3cxOCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC0tLS01MTItLS0uXG4gICAgICpcbiAgICAgKlxuICAgICAqXG4gICAgICogICAgTURDVCBvdXRwdXQ6ICB8LS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS18XG4gICAgICpcbiAgICAgKiAgICBGRlQncyAgICAgICAgICAgICAgICAgICAgPC0tLS0tLS0tLTEwMjQtLS0tLS0tLS0uXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8LS0tLS0tLS0tMTAyNC0tLS0tLS0uXG4gICAgICpcbiAgICAgKlxuICAgICAqXG4gICAgICogICAgICAgIGluYnVmID0gYnVmZmVyIG9mIFBDTSBkYXRhIHNpemU9TVAzIGZyYW1lc2l6ZVxuICAgICAqICAgICAgICBlbmNvZGVyIGFjdHMgb24gaW5idWZbY2hdWzBdLCBidXQgb3V0cHV0IGlzIGRlbGF5ZWQgYnkgTURDVERFTEFZXG4gICAgICogICAgICAgIHNvIHRoZSBNRENUIGNvZWZmaWNpbnRzIGFyZSBmcm9tIGluYnVmW2NoXVstTURDVERFTEFZXVxuICAgICAqXG4gICAgICogICAgICAgIHBzeS1tb2RlbCBGRlQgaGFzIGEgMSBncmFudWxlIGRlbGF5LCBzbyB3ZSBmZWVkIGl0IGRhdGEgZm9yIHRoZVxuICAgICAqICAgICAgICBuZXh0IGdyYW51bGUuXG4gICAgICogICAgICAgIEZGVCBpcyBjZW50ZXJlZCBvdmVyIGdyYW51bGU6ICAyMjQrNTc2KzIyNFxuICAgICAqICAgICAgICBTbyBGRlQgc3RhcnRzIGF0OiAgIDU3Ni0yMjQtTURDVERFTEFZXG4gICAgICpcbiAgICAgKiAgICAgICAgTVBFRzI6ICBGRlQgZW5kcyBhdDogIEJMS1NJWkUrNTc2LTIyNC1NRENUREVMQVkgICAgICAoMTMyOClcbiAgICAgKiAgICAgICAgTVBFRzE6ICBGRlQgZW5kcyBhdDogIEJMS1NJWkUrMio1NzYtMjI0LU1EQ1RERUxBWSAgICAoMTkwNClcbiAgICAgKlxuICAgICAqICAgICAgICBNUEVHMjogIHBvbHlwaGFzZSBmaXJzdCB3aW5kb3c6ICBbMC4uNTExXVxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAxOHRoIHdpbmRvdzogICBbNTQ0Li4xMDU1XSAgICAgICAgICAoMTA1NilcbiAgICAgKiAgICAgICAgTVBFRzE6ICAgICAgICAgICAgMzZ0aCB3aW5kb3c6ICAgWzExMjAuLjE2MzFdICAgICAgICAgKDE2MzIpXG4gICAgICogICAgICAgICAgICAgICAgZGF0YSBuZWVkZWQ6ICA1MTIrZnJhbWVzaXplLTMyXG4gICAgICpcbiAgICAgKiAgICAgICAgQSBjbG9zZSBsb29rIG5ld21kY3QuYyBzaG93cyB0aGF0IHRoZSBwb2x5cGhhc2UgZmlsdGVyYmFua1xuICAgICAqICAgICAgICBvbmx5IHVzZXMgZGF0YSBmcm9tIFswLi41MTBdIGZvciBlYWNoIHdpbmRvdy4gIFBlcmhhcHMgYmVjYXVzZSB0aGUgd2luZG93XG4gICAgICogICAgICAgIHVzZWQgYnkgdGhlIGZpbHRlcmJhbmsgaXMgemVybyBmb3IgdGhlIGxhc3QgcG9pbnQsIHNvIFRha2VoaXJvJ3NcbiAgICAgKiAgICAgICAgY29kZSBkb2Vzbid0IGJvdGhlciB0byBjb21wdXRlIHdpdGggaXQuXG4gICAgICpcbiAgICAgKiAgICAgICAgRkZUIHN0YXJ0cyBhdCA1NzYtMjI0LU1EQ1RERUxBWSAoMzA0KSAgPSA1NzYtRkZUT0ZGU0VUXG4gICAgICpcbiAgICAgKiA8L1BSRT5cbiAgICAgKi9cblxuXG4gICAgdGhpcy5sYW1lX2VuY29kZV9tcDNfZnJhbWUgPSBmdW5jdGlvbiAoZ2ZwLCBpbmJ1Zl9sLCBpbmJ1Zl9yLCBtcDNidWYsIG1wM2J1ZlBvcywgbXAzYnVmX3NpemUpIHtcbiAgICAgICAgdmFyIG1wM2NvdW50O1xuICAgICAgICB2YXIgbWFza2luZ19MUiA9IG5ld19hcnJheV9uKFsyLCAyXSk7XG4gICAgICAgIC8qXG4gICAgICAgICAqIExSIG1hc2tpbmcgJlxuICAgICAgICAgKiBlbmVyZ3lcbiAgICAgICAgICovXG4gICAgICAgIG1hc2tpbmdfTFJbMF1bMF0gPSBuZXcgSUlJX3BzeV9yYXRpbygpO1xuICAgICAgICBtYXNraW5nX0xSWzBdWzFdID0gbmV3IElJSV9wc3lfcmF0aW8oKTtcbiAgICAgICAgbWFza2luZ19MUlsxXVswXSA9IG5ldyBJSUlfcHN5X3JhdGlvKCk7XG4gICAgICAgIG1hc2tpbmdfTFJbMV1bMV0gPSBuZXcgSUlJX3BzeV9yYXRpbygpO1xuICAgICAgICB2YXIgbWFza2luZ19NUyA9IG5ld19hcnJheV9uKFsyLCAyXSk7XG4gICAgICAgIC8qIE1TIG1hc2tpbmcgJiBlbmVyZ3kgKi9cbiAgICAgICAgbWFza2luZ19NU1swXVswXSA9IG5ldyBJSUlfcHN5X3JhdGlvKCk7XG4gICAgICAgIG1hc2tpbmdfTVNbMF1bMV0gPSBuZXcgSUlJX3BzeV9yYXRpbygpO1xuICAgICAgICBtYXNraW5nX01TWzFdWzBdID0gbmV3IElJSV9wc3lfcmF0aW8oKTtcbiAgICAgICAgbWFza2luZ19NU1sxXVsxXSA9IG5ldyBJSUlfcHN5X3JhdGlvKCk7XG4gICAgICAgIC8vSUlJX3BzeV9yYXRpbyBtYXNraW5nW11bXTtcbiAgICAgICAgdmFyIG1hc2tpbmc7XG4gICAgICAgIC8qIHBvaW50ZXIgdG8gc2VsZWN0ZWQgbWFza2luZ3MgKi9cbiAgICAgICAgdmFyIGluYnVmID0gW251bGwsIG51bGxdO1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXG4gICAgICAgIHZhciB0b3RfZW5lciA9IG5ld19mbG9hdF9uKFsyLCA0XSk7XG4gICAgICAgIHZhciBtc19lbmVyX3JhdGlvID0gWy41LCAuNV07XG4gICAgICAgIHZhciBwZSA9IFtbMC4sIDAuXSwgWzAuLCAwLl1dO1xuICAgICAgICB2YXIgcGVfTVMgPSBbWzAuLCAwLl0sIFswLiwgMC5dXTtcblxuLy9mbG9hdFtdW10gcGVfdXNlO1xuICAgICAgICB2YXIgcGVfdXNlO1xuXG4gICAgICAgIHZhciBjaCwgZ3I7XG5cbiAgICAgICAgaW5idWZbMF0gPSBpbmJ1Zl9sO1xuICAgICAgICBpbmJ1ZlsxXSA9IGluYnVmX3I7XG5cbiAgICAgICAgaWYgKGdmYy5sYW1lX2VuY29kZV9mcmFtZV9pbml0ID09IDApIHtcbiAgICAgICAgICAgIC8qIGZpcnN0IHJ1bj8gKi9cbiAgICAgICAgICAgIGxhbWVfZW5jb2RlX2ZyYW1lX2luaXQoZ2ZwLCBpbmJ1Zik7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqIHBhZGRpbmcgKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIC8qKlxuICAgICAgICAgKiA8UFJFPlxuICAgICAgICAgKiBwYWRkaW5nIG1ldGhvZCBhcyBkZXNjcmliZWQgaW5cbiAgICAgICAgICogXCJNUEVHLUxheWVyMyAvIEJpdHN0cmVhbSBTeW50YXggYW5kIERlY29kaW5nXCJcbiAgICAgICAgICogYnkgTWFydGluIFNpZWxlciwgUmFscGggU3BlcnNjaG5laWRlclxuICAgICAgICAgKlxuICAgICAgICAgKiBub3RlOiB0aGVyZSBpcyBubyBwYWRkaW5nIGZvciB0aGUgdmVyeSBmaXJzdCBmcmFtZVxuICAgICAgICAgKlxuICAgICAgICAgKiBSb2JlcnQgSGVnZW1hbm4gMjAwMC0wNi0yMlxuICAgICAgICAgKiA8L1BSRT5cbiAgICAgICAgICovXG4gICAgICAgIGdmYy5wYWRkaW5nID0gMDtcbiAgICAgICAgaWYgKChnZmMuc2xvdF9sYWcgLT0gZ2ZjLmZyYWNfU3BGKSA8IDApIHtcbiAgICAgICAgICAgIGdmYy5zbG90X2xhZyArPSBnZnAub3V0X3NhbXBsZXJhdGU7XG4gICAgICAgICAgICBnZmMucGFkZGluZyA9IDE7XG4gICAgICAgIH1cblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBTdGFnZSAxOiBwc3ljaG9hY291c3RpYyBtb2RlbCAqXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIGlmIChnZmMucHN5bW9kZWwgIT0gMCkge1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIHBzeWNob2Fjb3VzdGljIG1vZGVsIHBzeSBtb2RlbCBoYXMgYSAxIGdyYW51bGUgKDU3NikgZGVsYXkgdGhhdFxuICAgICAgICAgICAgICogd2UgbXVzdCBjb21wZW5zYXRlIGZvciAobXQgNi85OSkuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhciByZXQ7XG4gICAgICAgICAgICB2YXIgYnVmcCA9IFtudWxsLCBudWxsXTtcbiAgICAgICAgICAgIC8qIGFkZHJlc3Mgb2YgYmVnaW5uaW5nIG9mIGxlZnQgJiByaWdodCBncmFudWxlICovXG4gICAgICAgICAgICB2YXIgYnVmcFBvcyA9IDA7XG4gICAgICAgICAgICAvKiBhZGRyZXNzIG9mIGJlZ2lubmluZyBvZiBsZWZ0ICYgcmlnaHQgZ3JhbnVsZSAqL1xuICAgICAgICAgICAgdmFyIGJsb2NrdHlwZSA9IG5ld19pbnQoMik7XG5cbiAgICAgICAgICAgIGZvciAoZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGJ1ZnBbY2hdID0gaW5idWZbY2hdO1xuICAgICAgICAgICAgICAgICAgICBidWZwUG9zID0gNTc2ICsgZ3IgKiA1NzYgLSBFbmNvZGVyLkZGVE9GRlNFVDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfbXRyaCB8fCBnZnAuVkJSID09IFZick1vZGUudmJyX210KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldCA9IHBzeS5MM3BzeWNob19hbmFsX3ZicihnZnAsIGJ1ZnAsIGJ1ZnBQb3MsIGdyLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFza2luZ19MUiwgbWFza2luZ19NUywgcGVbZ3JdLCBwZV9NU1tncl0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RfZW5lcltncl0sIGJsb2NrdHlwZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0ID0gcHN5LkwzcHN5Y2hvX2FuYWxfbnMoZ2ZwLCBidWZwLCBidWZwUG9zLCBncixcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hc2tpbmdfTFIsIG1hc2tpbmdfTVMsIHBlW2dyXSwgcGVfTVNbZ3JdLFxuICAgICAgICAgICAgICAgICAgICAgICAgdG90X2VuZXJbZ3JdLCBibG9ja3R5cGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocmV0ICE9IDApXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtNDtcblxuICAgICAgICAgICAgICAgIGlmIChnZnAubW9kZSA9PSBNUEVHTW9kZS5KT0lOVF9TVEVSRU8pIHtcbiAgICAgICAgICAgICAgICAgICAgbXNfZW5lcl9yYXRpb1tncl0gPSB0b3RfZW5lcltncl1bMl0gKyB0b3RfZW5lcltncl1bM107XG4gICAgICAgICAgICAgICAgICAgIGlmIChtc19lbmVyX3JhdGlvW2dyXSA+IDApXG4gICAgICAgICAgICAgICAgICAgICAgICBtc19lbmVyX3JhdGlvW2dyXSA9IHRvdF9lbmVyW2dyXVszXSAvIG1zX2VuZXJfcmF0aW9bZ3JdO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qIGJsb2NrIHR5cGUgZmxhZ3MgKi9cbiAgICAgICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2RfaW5mbyA9IGdmYy5sM19zaWRlLnR0W2dyXVtjaF07XG4gICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvLmJsb2NrX3R5cGUgPSBibG9ja3R5cGVbY2hdO1xuICAgICAgICAgICAgICAgICAgICBjb2RfaW5mby5taXhlZF9ibG9ja19mbGFnID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvKiBubyBwc3kgbW9kZWwgKi9cbiAgICAgICAgICAgIGZvciAoZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKVxuICAgICAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLmwzX3NpZGUudHRbZ3JdW2NoXS5ibG9ja190eXBlID0gRW5jb2Rlci5OT1JNX1RZUEU7XG4gICAgICAgICAgICAgICAgICAgIGdmYy5sM19zaWRlLnR0W2dyXVtjaF0ubWl4ZWRfYmxvY2tfZmxhZyA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHBlX01TW2dyXVtjaF0gPSBwZVtncl1bY2hdID0gNzAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGF1dG8tYWRqdXN0IG9mIEFUSCwgdXNlZnVsIGZvciBsb3cgdm9sdW1lICovXG4gICAgICAgIGFkanVzdF9BVEgoZ2ZjKTtcblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBTdGFnZSAyOiBNRENUICpcbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyogcG9seXBoYXNlIGZpbHRlcmluZyAvIG1kY3QgKi9cbiAgICAgICAgbmV3TURDVC5tZGN0X3N1YjQ4KGdmYywgaW5idWZbMF0sIGluYnVmWzFdKTtcblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBTdGFnZSAzOiBNUy9MUiBkZWNpc2lvbiAqXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qIEhlcmUgd2lsbCBiZSBzZWxlY3RlZCBNUyBvciBMUiBjb2Rpbmcgb2YgdGhlIDIgc3RlcmVvIGNoYW5uZWxzICovXG4gICAgICAgIGdmYy5tb2RlX2V4dCA9IEVuY29kZXIuTVBHX01EX0xSX0xSO1xuXG4gICAgICAgIGlmIChnZnAuZm9yY2VfbXMpIHtcbiAgICAgICAgICAgIGdmYy5tb2RlX2V4dCA9IEVuY29kZXIuTVBHX01EX01TX0xSO1xuICAgICAgICB9IGVsc2UgaWYgKGdmcC5tb2RlID09IE1QRUdNb2RlLkpPSU5UX1NURVJFTykge1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIG1zX3JhdGlvID0gaXMgc2NhbGVkLCBmb3IgaGlzdG9yaWNhbCByZWFzb25zLCB0byBsb29rIGxpa2UgYVxuICAgICAgICAgICAgICogcmF0aW8gb2Ygc2lkZV9jaGFubmVsIC8gdG90YWwuIDAgPSBzaWduYWwgaXMgMTAwJSBtb25vIC41ID0gTCAmIFJcbiAgICAgICAgICAgICAqIHVuY29ycmVsYXRlZFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogPFBSRT5cbiAgICAgICAgICAgICAqIFswXSBhbmQgWzFdIGFyZSB0aGUgcmVzdWx0cyBmb3IgdGhlIHR3byBncmFudWxlcyBpbiBNUEVHLTEsXG4gICAgICAgICAgICAgKiBpbiBNUEVHLTIgaXQncyBvbmx5IGEgZmFrZWQgYXZlcmFnaW5nIG9mIHRoZSBzYW1lIHZhbHVlXG4gICAgICAgICAgICAgKiBfcHJldiBpcyB0aGUgdmFsdWUgb2YgdGhlIGxhc3QgZ3JhbnVsZSBvZiB0aGUgcHJldmlvdXMgZnJhbWVcbiAgICAgICAgICAgICAqIF9uZXh0IGlzIHRoZSB2YWx1ZSBvZiB0aGUgZmlyc3QgZ3JhbnVsZSBvZiB0aGUgbmV4dCBmcmFtZVxuICAgICAgICAgICAgICogPC9QUkU+XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgdmFyIHN1bV9wZV9NUyA9IDAuO1xuICAgICAgICAgICAgdmFyIHN1bV9wZV9MUiA9IDAuO1xuICAgICAgICAgICAgZm9yIChnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1bV9wZV9NUyArPSBwZV9NU1tncl1bY2hdO1xuICAgICAgICAgICAgICAgICAgICBzdW1fcGVfTFIgKz0gcGVbZ3JdW2NoXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qIGJhc2VkIG9uIFBFOiBNL1MgY29kaW5nIHdvdWxkIG5vdCB1c2UgbXVjaCBtb3JlIGJpdHMgdGhhbiBML1IgKi9cbiAgICAgICAgICAgIGlmIChzdW1fcGVfTVMgPD0gMS4wMCAqIHN1bV9wZV9MUikge1xuXG4gICAgICAgICAgICAgICAgdmFyIGdpMCA9IGdmYy5sM19zaWRlLnR0WzBdO1xuICAgICAgICAgICAgICAgIHZhciBnaTEgPSBnZmMubDNfc2lkZS50dFtnZmMubW9kZV9nciAtIDFdO1xuXG4gICAgICAgICAgICAgICAgaWYgKGdpMFswXS5ibG9ja190eXBlID09IGdpMFsxXS5ibG9ja190eXBlXG4gICAgICAgICAgICAgICAgICAgICYmIGdpMVswXS5ibG9ja190eXBlID09IGdpMVsxXS5ibG9ja190eXBlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgZ2ZjLm1vZGVfZXh0ID0gRW5jb2Rlci5NUEdfTURfTVNfTFI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogYml0IGFuZCBub2lzZSBhbGxvY2F0aW9uICovXG4gICAgICAgIGlmIChnZmMubW9kZV9leHQgPT0gTVBHX01EX01TX0xSKSB7XG4gICAgICAgICAgICBtYXNraW5nID0gbWFza2luZ19NUztcbiAgICAgICAgICAgIC8qIHVzZSBNUyBtYXNraW5nICovXG4gICAgICAgICAgICBwZV91c2UgPSBwZV9NUztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1hc2tpbmcgPSBtYXNraW5nX0xSO1xuICAgICAgICAgICAgLyogdXNlIExSIG1hc2tpbmcgKi9cbiAgICAgICAgICAgIHBlX3VzZSA9IHBlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogY29weSBkYXRhIGZvciBNUDMgZnJhbWUgYW5hbHl6ZXIgKi9cbiAgICAgICAgaWYgKGdmcC5hbmFseXNpcyAmJiBnZmMucGluZm8gIT0gbnVsbCkge1xuICAgICAgICAgICAgZm9yIChnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGdmYy5waW5mby5tc19yYXRpb1tncl0gPSBnZmMubXNfcmF0aW9bZ3JdO1xuICAgICAgICAgICAgICAgICAgICBnZmMucGluZm8ubXNfZW5lcl9yYXRpb1tncl0gPSBtc19lbmVyX3JhdGlvW2dyXTtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLmJsb2NrdHlwZVtncl1bY2hdID0gZ2ZjLmwzX3NpZGUudHRbZ3JdW2NoXS5ibG9ja190eXBlO1xuICAgICAgICAgICAgICAgICAgICBnZmMucGluZm8ucGVbZ3JdW2NoXSA9IHBlX3VzZVtncl1bY2hdO1xuICAgICAgICAgICAgICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KGdmYy5sM19zaWRlLnR0W2dyXVtjaF0ueHIsIDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBnZmMucGluZm8ueHJbZ3JdW2NoXSwgMCwgNTc2KTtcbiAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICogaW4gcHN5bW9kZWwsIExSIGFuZCBNUyBkYXRhIHdhcyBzdG9yZWQgaW4gcGluZm8uIHN3aXRjaFxuICAgICAgICAgICAgICAgICAgICAgKiB0byBNUyBkYXRhOlxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgaWYgKGdmYy5tb2RlX2V4dCA9PSBNUEdfTURfTVNfTFIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdmYy5waW5mby5lcnNbZ3JdW2NoXSA9IGdmYy5waW5mby5lcnNbZ3JdW2NoICsgMl07XG4gICAgICAgICAgICAgICAgICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KGdmYy5waW5mby5lbmVyZ3lbZ3JdW2NoICsgMl0sIDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLmVuZXJneVtncl1bY2hdLCAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdmYy5waW5mby5lbmVyZ3lbZ3JdW2NoXS5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogU3RhZ2UgNDogcXVhbnRpemF0aW9uIGxvb3AgKlxuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICBpZiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9vZmYgfHwgZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9hYnIpIHtcblxuICAgICAgICAgICAgdmFyIGk7XG4gICAgICAgICAgICB2YXIgZjtcblxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDE4OyBpKyspXG4gICAgICAgICAgICAgICAgZ2ZjLm5zUHN5LnBlZmlyYnVmW2ldID0gZ2ZjLm5zUHN5LnBlZmlyYnVmW2kgKyAxXTtcblxuICAgICAgICAgICAgZiA9IDAuMDtcbiAgICAgICAgICAgIGZvciAoZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKVxuICAgICAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspXG4gICAgICAgICAgICAgICAgICAgIGYgKz0gcGVfdXNlW2dyXVtjaF07XG4gICAgICAgICAgICBnZmMubnNQc3kucGVmaXJidWZbMThdID0gZjtcblxuICAgICAgICAgICAgZiA9IGdmYy5uc1BzeS5wZWZpcmJ1Zls5XTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCA5OyBpKyspXG4gICAgICAgICAgICAgICAgZiArPSAoZ2ZjLm5zUHN5LnBlZmlyYnVmW2ldICsgZ2ZjLm5zUHN5LnBlZmlyYnVmWzE4IC0gaV0pXG4gICAgICAgICAgICAgICAgICAgICogRW5jb2Rlci5maXJjb2VmW2ldO1xuXG4gICAgICAgICAgICBmID0gKDY3MCAqIDUgKiBnZmMubW9kZV9nciAqIGdmYy5jaGFubmVsc19vdXQpIC8gZjtcbiAgICAgICAgICAgIGZvciAoZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgICAgICBwZV91c2VbZ3JdW2NoXSAqPSBmO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBnZmMuaXRlcmF0aW9uX2xvb3AuaXRlcmF0aW9uX2xvb3AoZ2ZwLCBwZV91c2UsIG1zX2VuZXJfcmF0aW8sIG1hc2tpbmcpO1xuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIFN0YWdlIDU6IGJpdHN0cmVhbSBmb3JtYXR0aW5nICpcbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyogd3JpdGUgdGhlIGZyYW1lIHRvIHRoZSBiaXRzdHJlYW0gKi9cbiAgICAgICAgYnMuZm9ybWF0X2JpdHN0cmVhbShnZnApO1xuXG4gICAgICAgIC8qIGNvcHkgbXAzIGJpdCBidWZmZXIgaW50byBhcnJheSAqL1xuICAgICAgICBtcDNjb3VudCA9IGJzLmNvcHlfYnVmZmVyKGdmYywgbXAzYnVmLCBtcDNidWZQb3MsIG1wM2J1Zl9zaXplLCAxKTtcblxuICAgICAgICBpZiAoZ2ZwLmJXcml0ZVZiclRhZylcbiAgICAgICAgICAgIHZici5hZGRWYnJGcmFtZShnZnApO1xuXG4gICAgICAgIGlmIChnZnAuYW5hbHlzaXMgJiYgZ2ZjLnBpbmZvICE9IG51bGwpIHtcbiAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgajtcbiAgICAgICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgRkZUT0ZGU0VUOyBqKyspXG4gICAgICAgICAgICAgICAgICAgIGdmYy5waW5mby5wY21kYXRhW2NoXVtqXSA9IGdmYy5waW5mby5wY21kYXRhW2NoXVtqXG4gICAgICAgICAgICAgICAgICAgICsgZ2ZwLmZyYW1lc2l6ZV07XG4gICAgICAgICAgICAgICAgZm9yIChqID0gRkZUT0ZGU0VUOyBqIDwgMTYwMDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGdmYy5waW5mby5wY21kYXRhW2NoXVtqXSA9IGluYnVmW2NoXVtqIC0gRkZUT0ZGU0VUXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBxdXB2dC5zZXRfZnJhbWVfcGluZm8oZ2ZwLCBtYXNraW5nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHVwZGF0ZVN0YXRzKGdmYyk7XG5cbiAgICAgICAgcmV0dXJuIG1wM2NvdW50O1xuICAgIH1cbn1cblxuXG4vL3BhY2thZ2UgbXAzO1xuXG5mdW5jdGlvbiBWQlJTZWVrSW5mbygpIHtcbiAgICAvKipcbiAgICAgKiBXaGF0IHdlIGhhdmUgc2VlbiBzbyBmYXIuXG4gICAgICovXG4gICAgdGhpcy5zdW0gPSAwO1xuICAgIC8qKlxuICAgICAqIEhvdyBtYW55IGZyYW1lcyB3ZSBoYXZlIHNlZW4gaW4gdGhpcyBjaHVuay5cbiAgICAgKi9cbiAgICB0aGlzLnNlZW4gPSAwO1xuICAgIC8qKlxuICAgICAqIEhvdyBtYW55IGZyYW1lcyB3ZSB3YW50IHRvIGNvbGxlY3QgaW50byBvbmUgY2h1bmsuXG4gICAgICovXG4gICAgdGhpcy53YW50ID0gMDtcbiAgICAvKipcbiAgICAgKiBBY3R1YWwgcG9zaXRpb24gaW4gb3VyIGJhZy5cbiAgICAgKi9cbiAgICB0aGlzLnBvcyA9IDA7XG4gICAgLyoqXG4gICAgICogU2l6ZSBvZiBvdXIgYmFnLlxuICAgICAqL1xuICAgIHRoaXMuc2l6ZSA9IDA7XG4gICAgLyoqXG4gICAgICogUG9pbnRlciB0byBvdXIgYmFnLlxuICAgICAqL1xuICAgIHRoaXMuYmFnID0gbnVsbDtcbiAgICB0aGlzLm5WYnJOdW1GcmFtZXMgPSAwO1xuICAgIHRoaXMubkJ5dGVzV3JpdHRlbiA9IDA7XG4gICAgLyogVkJSIHRhZyBkYXRhICovXG4gICAgdGhpcy5Ub3RhbEZyYW1lU2l6ZSA9IDA7XG59XG5cblxuXG5mdW5jdGlvbiBJSUlTaWRlSW5mbygpIHtcbiAgICB0aGlzLnR0ID0gW1tudWxsLCBudWxsXSwgW251bGwsIG51bGxdXTtcbiAgICB0aGlzLm1haW5fZGF0YV9iZWdpbiA9IDA7XG4gICAgdGhpcy5wcml2YXRlX2JpdHMgPSAwO1xuICAgIHRoaXMucmVzdkRyYWluX3ByZSA9IDA7XG4gICAgdGhpcy5yZXN2RHJhaW5fcG9zdCA9IDA7XG4gICAgdGhpcy5zY2ZzaSA9IFtuZXdfaW50KDQpLCBuZXdfaW50KDQpXTtcblxuICAgIGZvciAodmFyIGdyID0gMDsgZ3IgPCAyOyBncisrKSB7XG4gICAgICAgIGZvciAodmFyIGNoID0gMDsgY2ggPCAyOyBjaCsrKSB7XG4gICAgICAgICAgICB0aGlzLnR0W2dyXVtjaF0gPSBuZXcgR3JJbmZvKCk7XG4gICAgICAgIH1cbiAgICB9XG59XG5cblxuZnVuY3Rpb24gSUlJX3BzeV94bWluKCkge1xuICAgIHRoaXMubCA9IG5ld19mbG9hdChFbmNvZGVyLlNCTUFYX2wpO1xuICAgIHRoaXMucyA9IG5ld19mbG9hdF9uKFtFbmNvZGVyLlNCTUFYX3MsIDNdKTtcblxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLmFzc2lnbiA9IGZ1bmN0aW9uIChpaWlfcHN5X3htaW4pIHtcbiAgICAgICAgU3lzdGVtLmFycmF5Y29weShpaWlfcHN5X3htaW4ubCwgMCwgc2VsZi5sLCAwLCBFbmNvZGVyLlNCTUFYX2wpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEVuY29kZXIuU0JNQVhfczsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IDM7IGorKykge1xuICAgICAgICAgICAgICAgIHNlbGYuc1tpXVtqXSA9IGlpaV9wc3lfeG1pbi5zW2ldW2pdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuXG5cblxuLy9wYWNrYWdlIG1wMztcblxuLyoqXG4gKiBWYXJpYWJsZXMgdXNlZCBmb3IgLS1uc3BzeXR1bmVcbiAqXG4gKiBAYXV0aG9yIEtlblxuICpcbiAqL1xuZnVuY3Rpb24gTnNQc3koKSB7XG4gICAgdGhpcy5sYXN0X2VuX3N1YnNob3J0ID0gbmV3X2Zsb2F0X24oWzQsIDldKTtcbiAgICB0aGlzLmxhc3RBdHRhY2tzID0gbmV3X2ludCg0KTtcbiAgICB0aGlzLnBlZmlyYnVmID0gbmV3X2Zsb2F0KDE5KTtcbiAgICB0aGlzLmxvbmdmYWN0ID0gbmV3X2Zsb2F0KEVuY29kZXIuU0JNQVhfbCk7XG4gICAgdGhpcy5zaG9ydGZhY3QgPSBuZXdfZmxvYXQoRW5jb2Rlci5TQk1BWF9zKTtcblxuICAgIC8qKlxuICAgICAqIHNob3J0IGJsb2NrIHR1bmluZ1xuICAgICAqL1xuICAgIHRoaXMuYXR0YWNrdGhyZSA9IDAuO1xuICAgIHRoaXMuYXR0YWNrdGhyZV9zID0gMC47XG59XG5cblxuXG5cbkxhbWVJbnRlcm5hbEZsYWdzLk1GU0laRSA9ICgzICogMTE1MiArIEVuY29kZXIuRU5DREVMQVkgLSBFbmNvZGVyLk1EQ1RERUxBWSk7XG5MYW1lSW50ZXJuYWxGbGFncy5NQVhfSEVBREVSX0JVRiA9IDI1NjtcbkxhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9DSEFOTkVMID0gNDA5NTtcbkxhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9HUkFOVUxFID0gNzY4MDtcbkxhbWVJbnRlcm5hbEZsYWdzLkJQQyA9IDMyMDtcblxuZnVuY3Rpb24gTGFtZUludGVybmFsRmxhZ3MoKSB7XG4gICAgdmFyIE1BWF9IRUFERVJfTEVOID0gNDA7XG5cblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAqIGludGVybmFsIHZhcmlhYmxlcyBOT1Qgc2V0IGJ5IGNhbGxpbmcgcHJvZ3JhbSwgYW5kIHNob3VsZCBub3QgYmUgKlxuICAgICAqIG1vZGlmaWVkIGJ5IHRoZSBjYWxsaW5nIHByb2dyYW0gKlxuICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIC8qKlxuICAgICAqIFNvbWUgcmVtYXJrcyB0byB0aGUgQ2xhc3NfSUQgZmllbGQ6IFRoZSBDbGFzcyBJRCBpcyBhbiBJZGVudGlmaWVyIGZvciBhXG4gICAgICogcG9pbnRlciB0byB0aGlzIHN0cnVjdC4gSXQgaXMgdmVyeSB1bmxpa2VseSB0aGF0IGEgcG9pbnRlciB0b1xuICAgICAqIGxhbWVfZ2xvYmFsX2ZsYWdzIGhhcyB0aGUgc2FtZSAzMiBiaXRzIGluIGl0J3Mgc3RydWN0dXJlIChsYXJnZSBhbmQgb3RoZXJcbiAgICAgKiBzcGVjaWFsIHByb3BlcnRpZXMsIGZvciBpbnN0YW5jZSBwcmltZSkuXG4gICAgICpcbiAgICAgKiBUbyB0ZXN0IHRoYXQgdGhlIHN0cnVjdHVyZSBpcyByaWdodCBhbmQgaW5pdGlhbGl6ZWQsIHVzZTogaWYgKCBnZmMgLlxuICAgICAqIENsYXNzX0lEID09IExBTUVfSUQgKSAuLi4gT3RoZXIgcmVtYXJrOiBJZiB5b3Ugc2V0IGEgZmxhZyB0byAwIGZvciB1bmluaXRcbiAgICAgKiBkYXRhIGFuZCAxIGZvciBpbml0IGRhdGEsIHRoZSByaWdodCB0ZXN0IHNob3VsZCBiZSBcImlmIChmbGFnID09IDEpXCIgYW5kXG4gICAgICogTk9UIFwiaWYgKGZsYWcpXCIuIFVuaW50ZW5kZWQgbW9kaWZpY2F0aW9uIG9mIHRoaXMgZWxlbWVudCB3aWxsIGJlXG4gICAgICogb3RoZXJ3aXNlIG1pc2ludGVycHJldGVkIGFzIGFuIGluaXQuXG4gICAgICovXG4gICAgdGhpcy5DbGFzc19JRCA9IDA7XG5cbiAgICB0aGlzLmxhbWVfZW5jb2RlX2ZyYW1lX2luaXQgPSAwO1xuICAgIHRoaXMuaXRlcmF0aW9uX2luaXRfaW5pdCA9IDA7XG4gICAgdGhpcy5maWxsX2J1ZmZlcl9yZXNhbXBsZV9pbml0ID0gMDtcblxuICAgIC8vcHVibGljIGZsb2F0IG1mYnVmW11bXSA9IG5ldyBmbG9hdFsyXVtNRlNJWkVdO1xuICAgIHRoaXMubWZidWYgPSBuZXdfZmxvYXRfbihbMiwgTGFtZUludGVybmFsRmxhZ3MuTUZTSVpFXSk7XG5cbiAgICAvKipcbiAgICAgKiBncmFudWxlcyBwZXIgZnJhbWVcbiAgICAgKi9cbiAgICB0aGlzLm1vZGVfZ3IgPSAwO1xuICAgIC8qKlxuICAgICAqIG51bWJlciBvZiBjaGFubmVscyBpbiB0aGUgaW5wdXQgZGF0YSBzdHJlYW0gKFBDTSBvciBkZWNvZGVkIFBDTSlcbiAgICAgKi9cbiAgICB0aGlzLmNoYW5uZWxzX2luID0gMDtcbiAgICAvKipcbiAgICAgKiBudW1iZXIgb2YgY2hhbm5lbHMgaW4gdGhlIG91dHB1dCBkYXRhIHN0cmVhbSAobm90IHVzZWQgZm9yIGRlY29kaW5nKVxuICAgICAqL1xuICAgIHRoaXMuY2hhbm5lbHNfb3V0ID0gMDtcbiAgICAvKipcbiAgICAgKiBpbnB1dF9zYW1wX3JhdGUvb3V0cHV0X3NhbXBfcmF0ZVxuICAgICAqL1xuICAgICAgICAvL3B1YmxpYyBkb3VibGUgcmVzYW1wbGVfcmF0aW87XG4gICAgdGhpcy5yZXNhbXBsZV9yYXRpbyA9IDAuO1xuXG4gICAgdGhpcy5tZl9zYW1wbGVzX3RvX2VuY29kZSA9IDA7XG4gICAgdGhpcy5tZl9zaXplID0gMDtcbiAgICAvKipcbiAgICAgKiBtaW4gYml0cmF0ZSBpbmRleFxuICAgICAqL1xuICAgIHRoaXMuVkJSX21pbl9iaXRyYXRlID0gMDtcbiAgICAvKipcbiAgICAgKiBtYXggYml0cmF0ZSBpbmRleFxuICAgICAqL1xuICAgIHRoaXMuVkJSX21heF9iaXRyYXRlID0gMDtcbiAgICB0aGlzLmJpdHJhdGVfaW5kZXggPSAwO1xuICAgIHRoaXMuc2FtcGxlcmF0ZV9pbmRleCA9IDA7XG4gICAgdGhpcy5tb2RlX2V4dCA9IDA7XG5cbiAgICAvKiBsb3dwYXNzIGFuZCBoaWdocGFzcyBmaWx0ZXIgY29udHJvbCAqL1xuICAgIC8qKlxuICAgICAqIG5vcm1hbGl6ZWQgZnJlcXVlbmN5IGJvdW5kcyBvZiBwYXNzYmFuZFxuICAgICAqL1xuICAgIHRoaXMubG93cGFzczEgPSAwLjtcbiAgICB0aGlzLmxvd3Bhc3MyID0gMC47XG4gICAgLyoqXG4gICAgICogbm9ybWFsaXplZCBmcmVxdWVuY3kgYm91bmRzIG9mIHBhc3NiYW5kXG4gICAgICovXG4gICAgdGhpcy5oaWdocGFzczEgPSAwLjtcbiAgICB0aGlzLmhpZ2hwYXNzMiA9IDAuO1xuXG4gICAgLyoqXG4gICAgICogMCA9IG5vbmUgMSA9IElTTyBBQUMgbW9kZWwgMiA9IGFsbG93IHNjYWxlZmFjX3NlbGVjdD0xXG4gICAgICovXG4gICAgdGhpcy5ub2lzZV9zaGFwaW5nID0gMDtcblxuICAgIC8qKlxuICAgICAqIDAgPSBJU08gbW9kZWw6IGFtcGxpZnkgYWxsIGRpc3RvcnRlZCBiYW5kczxCUj5cbiAgICAgKiAxID0gYW1wbGlmeSB3aXRoaW4gNTAlIG9mIG1heCAob24gZGIgc2NhbGUpPEJSPlxuICAgICAqIDIgPSBhbXBsaWZ5IG9ubHkgbW9zdCBkaXN0b3J0ZWQgYmFuZDxCUj5cbiAgICAgKiAzID0gbWV0aG9kIDEgYW5kIHJlZmluZSB3aXRoIG1ldGhvZCAyPEJSPlxuICAgICAqL1xuICAgIHRoaXMubm9pc2Vfc2hhcGluZ19hbXAgPSAwO1xuICAgIC8qKlxuICAgICAqIDAgPSBubyBzdWJzdGVwPEJSPlxuICAgICAqIDEgPSB1c2Ugc3Vic3RlcCBzaGFwaW5nIGF0IGxhc3Qgc3RlcChWQlIgb25seSk8QlI+XG4gICAgICogKG5vdCBpbXBsZW1lbnRlZCB5ZXQpPEJSPlxuICAgICAqIDIgPSB1c2Ugc3Vic3RlcCBpbnNpZGUgbG9vcDxCUj5cbiAgICAgKiAzID0gdXNlIHN1YnN0ZXAgaW5zaWRlIGxvb3AgYW5kIGxhc3Qgc3RlcDxCUj5cbiAgICAgKi9cbiAgICB0aGlzLnN1YnN0ZXBfc2hhcGluZyA9IDA7XG5cbiAgICAvKipcbiAgICAgKiAxID0gZ3BzeWNoby4gMCA9IG5vbmVcbiAgICAgKi9cbiAgICB0aGlzLnBzeW1vZGVsID0gMDtcbiAgICAvKipcbiAgICAgKiAwID0gc3RvcCBhdCBvdmVyPTAsIGFsbCBzY2FsZWZhY3MgYW1wbGlmaWVkIG9yPEJSPlxuICAgICAqIGEgc2NhbGVmYWMgaGFzIHJlYWNoZWQgbWF4IHZhbHVlPEJSPlxuICAgICAqIDEgPSBzdG9wIHdoZW4gYWxsIHNjYWxlZmFjcyBhbXBsaWZpZWQgb3IgYSBzY2FsZWZhYyBoYXMgcmVhY2hlZCBtYXggdmFsdWU8QlI+XG4gICAgICogMiA9IHN0b3Agd2hlbiBhbGwgc2NhbGVmYWNzIGFtcGxpZmllZFxuICAgICAqL1xuICAgIHRoaXMubm9pc2Vfc2hhcGluZ19zdG9wID0gMDtcblxuICAgIC8qKlxuICAgICAqIDAgPSBubywgMSA9IHllc1xuICAgICAqL1xuICAgIHRoaXMuc3ViYmxvY2tfZ2FpbiA9IDA7XG4gICAgLyoqXG4gICAgICogMCA9IG5vLiAxPW91dHNpZGUgbG9vcCAyPWluc2lkZSBsb29wKHNsb3cpXG4gICAgICovXG4gICAgdGhpcy51c2VfYmVzdF9odWZmbWFuID0gMDtcblxuICAgIC8qKlxuICAgICAqIDAgPSBzdG9wIGVhcmx5IGFmdGVyIDAgZGlzdG9ydGlvbiBmb3VuZC4gMSA9IGZ1bGwgc2VhcmNoXG4gICAgICovXG4gICAgdGhpcy5mdWxsX291dGVyX2xvb3AgPSAwO1xuXG4gICAgLy9wdWJsaWMgSUlJU2lkZUluZm8gbDNfc2lkZSA9IG5ldyBJSUlTaWRlSW5mbygpO1xuICAgIHRoaXMubDNfc2lkZSA9IG5ldyBJSUlTaWRlSW5mbygpO1xuICAgIHRoaXMubXNfcmF0aW8gPSBuZXdfZmxvYXQoMik7XG5cbiAgICAvKiB1c2VkIGZvciBwYWRkaW5nICovXG4gICAgLyoqXG4gICAgICogcGFkZGluZyBmb3IgdGhlIGN1cnJlbnQgZnJhbWU/XG4gICAgICovXG4gICAgdGhpcy5wYWRkaW5nID0gMDtcbiAgICB0aGlzLmZyYWNfU3BGID0gMDtcbiAgICB0aGlzLnNsb3RfbGFnID0gMDtcblxuICAgIC8qKlxuICAgICAqIG9wdGlvbmFsIElEMyB0YWdzXG4gICAgICovXG4gICAgICAgIC8vcHVibGljIElEM1RhZ1NwZWMgdGFnX3NwZWM7XG4gICAgdGhpcy50YWdfc3BlYyA9IG51bGw7XG4gICAgdGhpcy5uTXVzaWNDUkMgPSAwO1xuXG4gICAgLyogdmFyaWFibGVzIHVzZWQgYnkgUXVhbnRpemUgKi9cbiAgICAvL3B1YmxpYyBpbnQgT2xkVmFsdWVbXSA9IG5ldyBpbnRbMl07XG4gICAgdGhpcy5PbGRWYWx1ZSA9IG5ld19pbnQoMik7XG4gICAgLy9wdWJsaWMgaW50IEN1cnJlbnRTdGVwW10gPSBuZXcgaW50WzJdO1xuICAgIHRoaXMuQ3VycmVudFN0ZXAgPSBuZXdfaW50KDIpO1xuXG4gICAgdGhpcy5tYXNraW5nX2xvd2VyID0gMC47XG4gICAgLy9wdWJsaWMgaW50IGJ2X3NjZltdID0gbmV3IGludFs1NzZdO1xuICAgIHRoaXMuYnZfc2NmID0gbmV3X2ludCg1NzYpO1xuICAgIC8vcHVibGljIGludCBwc2V1ZG9oYWxmW10gPSBuZXcgaW50W0wzU2lkZS5TRkJNQVhdO1xuICAgIHRoaXMucHNldWRvaGFsZiA9IG5ld19pbnQoTDNTaWRlLlNGQk1BWCk7XG5cbiAgICAvKipcbiAgICAgKiB3aWxsIGJlIHNldCBpbiBsYW1lX2luaXRfcGFyYW1zXG4gICAgICovXG4gICAgdGhpcy5zZmIyMV9leHRyYSA9IGZhbHNlO1xuXG4gICAgLyogQlBDID0gbWF4aW11bSBudW1iZXIgb2YgZmlsdGVyIGNvbnZvbHV0aW9uIHdpbmRvd3MgdG8gcHJlY29tcHV0ZSAqL1xuICAgIC8vcHVibGljIGZsb2F0W11bXSBpbmJ1Zl9vbGQgPSBuZXcgZmxvYXRbMl1bXTtcbiAgICB0aGlzLmluYnVmX29sZCA9IG5ldyBBcnJheSgyKTtcbiAgICAvL3B1YmxpYyBmbG9hdFtdW10gYmxhY2tmaWx0ID0gbmV3IGZsb2F0WzIgKiBCUEMgKyAxXVtdO1xuICAgIHRoaXMuYmxhY2tmaWx0ID0gbmV3IEFycmF5KDIgKiBMYW1lSW50ZXJuYWxGbGFncy5CUEMgKyAxKTtcbiAgICAvL3B1YmxpYyBkb3VibGUgaXRpbWVbXSA9IG5ldyBkb3VibGVbMl07XG4gICAgdGhpcy5pdGltZSA9IG5ld19kb3VibGUoMik7XG4gICAgdGhpcy5zaWRlaW5mb19sZW4gPSAwO1xuXG4gICAgLyogdmFyaWFibGVzIGZvciBuZXdtZGN0LmMgKi9cbiAgICAvL3B1YmxpYyBmbG9hdCBzYl9zYW1wbGVbXVtdW11bXSA9IG5ldyBmbG9hdFsyXVsyXVsxOF1bRW5jb2Rlci5TQkxJTUlUXTtcbiAgICB0aGlzLnNiX3NhbXBsZSA9IG5ld19mbG9hdF9uKFsyLCAyLCAxOCwgRW5jb2Rlci5TQkxJTUlUXSk7XG4gICAgdGhpcy5hbXBfZmlsdGVyID0gbmV3X2Zsb2F0KDMyKTtcblxuICAgIC8qIHZhcmlhYmxlcyBmb3IgQml0U3RyZWFtICovXG5cbiAgICAvKipcbiAgICAgKiA8UFJFPlxuICAgICAqIG1wZWcxOiBidWZmZXI9NTExIGJ5dGVzICBzbWFsbGVzdCBmcmFtZTogOTYtMzgoc2lkZWluZm8pPTU4XG4gICAgICogbWF4IG51bWJlciBvZiBmcmFtZXMgaW4gcmVzZXJ2b2lyOiAgOFxuICAgICAqIG1wZWcyOiBidWZmZXI9MjU1IGJ5dGVzLiAgc21hbGxlc3QgZnJhbWU6IDI0LTIzYnl0ZXM9MVxuICAgICAqIHdpdGggVkJSLCBpZiB5b3UgYXJlIGVuY29kaW5nIGFsbCBzaWxlbmNlLCBpdCBpcyBwb3NzaWJsZSB0b1xuICAgICAqIGhhdmUgOGticy8yNGtoeiBmcmFtZXMgd2l0aCAxYnl0ZSBvZiBkYXRhIGVhY2gsIHdoaWNoIG1lYW5zIHdlIG5lZWRcbiAgICAgKiB0byBidWZmZXIgdXAgdG8gMjU1IGhlYWRlcnMhXG4gICAgICogPC9QUkU+XG4gICAgICovXG4gICAgLyoqXG4gICAgICogYWxzbywgbWF4X2hlYWRlcl9idWYgaGFzIHRvIGJlIGEgcG93ZXIgb2YgdHdvXG4gICAgICovXG4gICAgLyoqXG4gICAgICogbWF4IHNpemUgb2YgaGVhZGVyIGlzIDM4XG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBIZWFkZXIoKSB7XG4gICAgICAgIHRoaXMud3JpdGVfdGltaW5nID0gMDtcbiAgICAgICAgdGhpcy5wdHIgPSAwO1xuICAgICAgICAvL3B1YmxpYyBieXRlIGJ1ZltdID0gbmV3IGJ5dGVbTUFYX0hFQURFUl9MRU5dO1xuICAgICAgICB0aGlzLmJ1ZiA9IG5ld19ieXRlKE1BWF9IRUFERVJfTEVOKTtcbiAgICB9XG5cbiAgICB0aGlzLmhlYWRlciA9IG5ldyBBcnJheShMYW1lSW50ZXJuYWxGbGFncy5NQVhfSEVBREVSX0JVRik7XG5cbiAgICB0aGlzLmhfcHRyID0gMDtcbiAgICB0aGlzLndfcHRyID0gMDtcbiAgICB0aGlzLmFuY2lsbGFyeV9mbGFnID0gMDtcblxuICAgIC8qIHZhcmlhYmxlcyBmb3IgUmVzZXJ2b2lyICovXG4gICAgLyoqXG4gICAgICogaW4gYml0c1xuICAgICAqL1xuICAgIHRoaXMuUmVzdlNpemUgPSAwO1xuICAgIC8qKlxuICAgICAqIGluIGJpdHNcbiAgICAgKi9cbiAgICB0aGlzLlJlc3ZNYXggPSAwO1xuXG4gICAgLy9wdWJsaWMgU2NhbGVGYWMgc2NhbGVmYWNfYmFuZCA9IG5ldyBTY2FsZUZhYygpO1xuICAgIHRoaXMuc2NhbGVmYWNfYmFuZCA9IG5ldyBTY2FsZUZhYygpO1xuXG4gICAgLyogZGFhIGZyb20gUHN5TW9kZWwgKi9cbiAgICAvKiBUaGUgc3RhdGljIHZhcmlhYmxlcyBcInJcIiwgXCJwaGlfc2F2XCIsIFwibmV3XCIsIFwib2xkXCIgYW5kIFwib2xkZXN0XCIgaGF2ZSAqL1xuICAgIC8qIHRvIGJlIHJlbWVtYmVyZWQgZm9yIHRoZSB1bnByZWRpY3RhYmlsaXR5IG1lYXN1cmUuIEZvciBcInJcIiBhbmQgKi9cbiAgICAvKiBcInBoaV9zYXZcIiwgdGhlIGZpcnN0IGluZGV4IGZyb20gdGhlIGxlZnQgaXMgdGhlIGNoYW5uZWwgc2VsZWN0IGFuZCAqL1xuICAgIC8qIHRoZSBzZWNvbmQgaW5kZXggaXMgdGhlIFwiYWdlXCIgb2YgdGhlIGRhdGEuICovXG4gICAgdGhpcy5taW52YWxfbCA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyk7XG4gICAgdGhpcy5taW52YWxfcyA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyk7XG4gICAgdGhpcy5uYl8xID0gbmV3X2Zsb2F0X24oWzQsIEVuY29kZXIuQ0JBTkRTXSk7XG4gICAgdGhpcy5uYl8yID0gbmV3X2Zsb2F0X24oWzQsIEVuY29kZXIuQ0JBTkRTXSk7XG4gICAgdGhpcy5uYl9zMSA9IG5ld19mbG9hdF9uKFs0LCBFbmNvZGVyLkNCQU5EU10pO1xuICAgIHRoaXMubmJfczIgPSBuZXdfZmxvYXRfbihbNCwgRW5jb2Rlci5DQkFORFNdKTtcbiAgICB0aGlzLnMzX3NzID0gbnVsbDtcbiAgICB0aGlzLnMzX2xsID0gbnVsbDtcbiAgICB0aGlzLmRlY2F5ID0gMC47XG5cbiAgICAvL3B1YmxpYyBJSUlfcHN5X3htaW5bXSB0aG0gPSBuZXcgSUlJX3BzeV94bWluWzRdO1xuICAgIC8vcHVibGljIElJSV9wc3lfeG1pbltdIGVuID0gbmV3IElJSV9wc3lfeG1pbls0XTtcbiAgICB0aGlzLnRobSA9IG5ldyBBcnJheSg0KTtcbiAgICB0aGlzLmVuID0gbmV3IEFycmF5KDQpO1xuXG4gICAgLyoqXG4gICAgICogZmZ0IGFuZCBlbmVyZ3kgY2FsY3VsYXRpb25cbiAgICAgKi9cbiAgICB0aGlzLnRvdF9lbmVyID0gbmV3X2Zsb2F0KDQpO1xuXG4gICAgLyogbG91ZG5lc3MgY2FsY3VsYXRpb24gKGZvciBhZGFwdGl2ZSB0aHJlc2hvbGQgb2YgaGVhcmluZykgKi9cbiAgICAvKipcbiAgICAgKiBsb3VkbmVzc14yIGFwcHJveC4gcGVyIGdyYW51bGUgYW5kIGNoYW5uZWxcbiAgICAgKi9cbiAgICB0aGlzLmxvdWRuZXNzX3NxID0gbmV3X2Zsb2F0X24oWzIsIDJdKTtcbiAgICAvKipcbiAgICAgKiBhY2NvdW50IGZvciBncmFudWxlIGRlbGF5IG9mIEwzcHN5Y2hvX2FuYWxcbiAgICAgKi9cbiAgICB0aGlzLmxvdWRuZXNzX3NxX3NhdmUgPSBuZXdfZmxvYXQoMik7XG5cbiAgICAvKipcbiAgICAgKiBTY2FsZSBGYWN0b3IgQmFuZHNcbiAgICAgKi9cbiAgICB0aGlzLm1sZF9sID0gbmV3X2Zsb2F0KEVuY29kZXIuU0JNQVhfbCk7XG4gICAgdGhpcy5tbGRfcyA9IG5ld19mbG9hdChFbmNvZGVyLlNCTUFYX3MpO1xuICAgIHRoaXMuYm1fbCA9IG5ld19pbnQoRW5jb2Rlci5TQk1BWF9sKTtcbiAgICB0aGlzLmJvX2wgPSBuZXdfaW50KEVuY29kZXIuU0JNQVhfbCk7XG4gICAgdGhpcy5ibV9zID0gbmV3X2ludChFbmNvZGVyLlNCTUFYX3MpO1xuICAgIHRoaXMuYm9fcyA9IG5ld19pbnQoRW5jb2Rlci5TQk1BWF9zKTtcbiAgICB0aGlzLm5wYXJ0X2wgPSAwO1xuICAgIHRoaXMubnBhcnRfcyA9IDA7XG5cbiAgICB0aGlzLnMzaW5kID0gbmV3X2ludF9uKFtFbmNvZGVyLkNCQU5EUywgMl0pO1xuICAgIHRoaXMuczNpbmRfcyA9IG5ld19pbnRfbihbRW5jb2Rlci5DQkFORFMsIDJdKTtcblxuICAgIHRoaXMubnVtbGluZXNfcyA9IG5ld19pbnQoRW5jb2Rlci5DQkFORFMpO1xuICAgIHRoaXMubnVtbGluZXNfbCA9IG5ld19pbnQoRW5jb2Rlci5DQkFORFMpO1xuICAgIHRoaXMucm51bWxpbmVzX2wgPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMpO1xuICAgIHRoaXMubWxkX2NiX2wgPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMpO1xuICAgIHRoaXMubWxkX2NiX3MgPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMpO1xuICAgIHRoaXMubnVtbGluZXNfc19udW0xID0gMDtcbiAgICB0aGlzLm51bWxpbmVzX2xfbnVtMSA9IDA7XG5cbiAgICAvKiByYXRpb3MgKi9cbiAgICB0aGlzLnBlID0gbmV3X2Zsb2F0KDQpO1xuICAgIHRoaXMubXNfcmF0aW9fc19vbGQgPSAwLjtcbiAgICB0aGlzLm1zX3JhdGlvX2xfb2xkID0gMC47XG4gICAgdGhpcy5tc19lbmVyX3JhdGlvX29sZCA9IDAuO1xuXG4gICAgLyoqXG4gICAgICogYmxvY2sgdHlwZVxuICAgICAqL1xuICAgIHRoaXMuYmxvY2t0eXBlX29sZCA9IG5ld19pbnQoMik7XG5cbiAgICAvKipcbiAgICAgKiB2YXJpYWJsZXMgdXNlZCBmb3IgLS1uc3BzeXR1bmVcbiAgICAgKi9cbiAgICB0aGlzLm5zUHN5ID0gbmV3IE5zUHN5KCk7XG5cbiAgICAvKipcbiAgICAgKiB1c2VkIGZvciBYaW5nIFZCUiBoZWFkZXJcbiAgICAgKi9cbiAgICB0aGlzLlZCUl9zZWVrX3RhYmxlID0gbmV3IFZCUlNlZWtJbmZvKCk7XG5cbiAgICAvKipcbiAgICAgKiBhbGwgQVRIIHJlbGF0ZWQgc3R1ZmZcbiAgICAgKi9cbiAgICAgICAgLy9wdWJsaWMgQVRIIEFUSDtcbiAgICB0aGlzLkFUSCA9IG51bGw7XG5cbiAgICB0aGlzLlBTWSA9IG51bGw7XG5cbiAgICB0aGlzLm5vZ2FwX3RvdGFsID0gMDtcbiAgICB0aGlzLm5vZ2FwX2N1cnJlbnQgPSAwO1xuXG4gICAgLyogUmVwbGF5R2FpbiAqL1xuICAgIHRoaXMuZGVjb2RlX29uX3RoZV9mbHkgPSB0cnVlO1xuICAgIHRoaXMuZmluZFJlcGxheUdhaW4gPSB0cnVlO1xuICAgIHRoaXMuZmluZFBlYWtTYW1wbGUgPSB0cnVlO1xuICAgIHRoaXMuUGVha1NhbXBsZSA9IDAuO1xuICAgIHRoaXMuUmFkaW9HYWluID0gMDtcbiAgICB0aGlzLkF1ZGlvcGhpbGVHYWluID0gMDtcbiAgICAvL3B1YmxpYyBSZXBsYXlHYWluIHJnZGF0YTtcbiAgICB0aGlzLnJnZGF0YSA9IG51bGw7XG5cbiAgICAvKipcbiAgICAgKiBnYWluIGNoYW5nZSByZXF1aXJlZCBmb3IgcHJldmVudGluZyBjbGlwcGluZ1xuICAgICAqL1xuICAgIHRoaXMubm9jbGlwR2FpbkNoYW5nZSA9IDA7XG4gICAgLyoqXG4gICAgICogdXNlci1zcGVjaWZpZWQgc2NhbGUgZmFjdG9yIHJlcXVpcmVkIGZvciBwcmV2ZW50aW5nIGNsaXBwaW5nXG4gICAgICovXG4gICAgdGhpcy5ub2NsaXBTY2FsZSA9IDAuO1xuXG4gICAgLyogc2ltcGxlIHN0YXRpc3RpY3MgKi9cbiAgICB0aGlzLmJpdHJhdGVfc3RlcmVvTW9kZV9IaXN0ID0gbmV3X2ludF9uKFsxNiwgNCArIDFdKTtcbiAgICAvKipcbiAgICAgKiBub3JtL3N0YXJ0L3Nob3J0L3N0b3AvbWl4ZWQoc2hvcnQpL3N1bVxuICAgICAqL1xuICAgIHRoaXMuYml0cmF0ZV9ibG9ja1R5cGVfSGlzdCA9IG5ld19pbnRfbihbMTYsIDQgKyAxICsgMV0pO1xuXG4gICAgLy9wdWJsaWMgUGxvdHRpbmdEYXRhIHBpbmZvO1xuICAgIC8vcHVibGljIE1QR0xpYi5tcHN0cl90YWcgaGlwO1xuICAgIHRoaXMucGluZm8gPSBudWxsO1xuICAgIHRoaXMuaGlwID0gbnVsbDtcblxuICAgIHRoaXMuaW5fYnVmZmVyX25zYW1wbGVzID0gMDtcbiAgICAvL3B1YmxpYyBmbG9hdFtdIGluX2J1ZmZlcl8wO1xuICAgIC8vcHVibGljIGZsb2F0W10gaW5fYnVmZmVyXzE7XG4gICAgdGhpcy5pbl9idWZmZXJfMCA9IG51bGw7XG4gICAgdGhpcy5pbl9idWZmZXJfMSA9IG51bGw7XG5cbiAgICAvL3B1YmxpYyBJSXRlcmF0aW9uTG9vcCBpdGVyYXRpb25fbG9vcDtcbiAgICB0aGlzLml0ZXJhdGlvbl9sb29wID0gbnVsbDtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5lbi5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLmVuW2ldID0gbmV3IElJSV9wc3lfeG1pbigpO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMudGhtLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMudGhtW2ldID0gbmV3IElJSV9wc3lfeG1pbigpO1xuICAgIH1cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuaGVhZGVyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMuaGVhZGVyW2ldID0gbmV3IEhlYWRlcigpO1xuICAgIH1cblxufVxuXG5cblxuZnVuY3Rpb24gRkZUKCkge1xuXG4gICAgdmFyIHdpbmRvdyA9IG5ld19mbG9hdChFbmNvZGVyLkJMS1NJWkUpO1xuICAgIHZhciB3aW5kb3dfcyA9IG5ld19mbG9hdChFbmNvZGVyLkJMS1NJWkVfcyAvIDIpO1xuXG4gICAgdmFyIGNvc3RhYiA9IFtcbiAgICAgICAgOS4yMzg3OTUzMjUxMTI4NjdlLTAxLCAzLjgyNjgzNDMyMzY1MDg5OGUtMDEsXG4gICAgICAgIDkuOTUxODQ3MjY2NzIxOTY5ZS0wMSwgOS44MDE3MTQwMzI5NTYwNjBlLTAyLFxuICAgICAgICA5Ljk5Njk4ODE4Njk2MjA0MmUtMDEsIDIuNDU0MTIyODUyMjkxMjI5ZS0wMixcbiAgICAgICAgOS45OTk4MTE3NTI4MjYwMTFlLTAxLCA2LjEzNTg4NDY0OTE1NDQ3NWUtMDNcbiAgICBdO1xuXG4gICAgZnVuY3Rpb24gZmh0KGZ6LCBmelBvcywgbikge1xuICAgICAgICB2YXIgdHJpID0gMDtcbiAgICAgICAgdmFyIGs0O1xuICAgICAgICB2YXIgZmk7XG4gICAgICAgIHZhciBnaTtcblxuICAgICAgICBuIDw8PSAxO1xuICAgICAgICAvKiB0byBnZXQgQkxLU0laRSwgYmVjYXVzZSBvZiAzRE5vdyEgQVNNIHJvdXRpbmUgKi9cbiAgICAgICAgdmFyIGZuID0gZnpQb3MgKyBuO1xuICAgICAgICBrNCA9IDQ7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIHZhciBzMSwgYzE7XG4gICAgICAgICAgICB2YXIgaSwgazEsIGsyLCBrMywga3g7XG4gICAgICAgICAgICBreCA9IGs0ID4+IDE7XG4gICAgICAgICAgICBrMSA9IGs0O1xuICAgICAgICAgICAgazIgPSBrNCA8PCAxO1xuICAgICAgICAgICAgazMgPSBrMiArIGsxO1xuICAgICAgICAgICAgazQgPSBrMiA8PCAxO1xuICAgICAgICAgICAgZmkgPSBmelBvcztcbiAgICAgICAgICAgIGdpID0gZmkgKyBreDtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICB2YXIgZjAsIGYxLCBmMiwgZjM7XG4gICAgICAgICAgICAgICAgZjEgPSBmeltmaSArIDBdIC0gZnpbZmkgKyBrMV07XG4gICAgICAgICAgICAgICAgZjAgPSBmeltmaSArIDBdICsgZnpbZmkgKyBrMV07XG4gICAgICAgICAgICAgICAgZjMgPSBmeltmaSArIGsyXSAtIGZ6W2ZpICsgazNdO1xuICAgICAgICAgICAgICAgIGYyID0gZnpbZmkgKyBrMl0gKyBmeltmaSArIGszXTtcbiAgICAgICAgICAgICAgICBmeltmaSArIGsyXSA9IGYwIC0gZjI7XG4gICAgICAgICAgICAgICAgZnpbZmkgKyAwXSA9IGYwICsgZjI7XG4gICAgICAgICAgICAgICAgZnpbZmkgKyBrM10gPSBmMSAtIGYzO1xuICAgICAgICAgICAgICAgIGZ6W2ZpICsgazFdID0gZjEgKyBmMztcbiAgICAgICAgICAgICAgICBmMSA9IGZ6W2dpICsgMF0gLSBmeltnaSArIGsxXTtcbiAgICAgICAgICAgICAgICBmMCA9IGZ6W2dpICsgMF0gKyBmeltnaSArIGsxXTtcbiAgICAgICAgICAgICAgICBmMyA9IChVdGlsLlNRUlQyICogZnpbZ2kgKyBrM10pO1xuICAgICAgICAgICAgICAgIGYyID0gKFV0aWwuU1FSVDIgKiBmeltnaSArIGsyXSk7XG4gICAgICAgICAgICAgICAgZnpbZ2kgKyBrMl0gPSBmMCAtIGYyO1xuICAgICAgICAgICAgICAgIGZ6W2dpICsgMF0gPSBmMCArIGYyO1xuICAgICAgICAgICAgICAgIGZ6W2dpICsgazNdID0gZjEgLSBmMztcbiAgICAgICAgICAgICAgICBmeltnaSArIGsxXSA9IGYxICsgZjM7XG4gICAgICAgICAgICAgICAgZ2kgKz0gazQ7XG4gICAgICAgICAgICAgICAgZmkgKz0gazQ7XG4gICAgICAgICAgICB9IHdoaWxlIChmaSA8IGZuKTtcbiAgICAgICAgICAgIGMxID0gY29zdGFiW3RyaSArIDBdO1xuICAgICAgICAgICAgczEgPSBjb3N0YWJbdHJpICsgMV07XG4gICAgICAgICAgICBmb3IgKGkgPSAxOyBpIDwga3g7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBjMiwgczI7XG4gICAgICAgICAgICAgICAgYzIgPSAxIC0gKDIgKiBzMSkgKiBzMTtcbiAgICAgICAgICAgICAgICBzMiA9ICgyICogczEpICogYzE7XG4gICAgICAgICAgICAgICAgZmkgPSBmelBvcyArIGk7XG4gICAgICAgICAgICAgICAgZ2kgPSBmelBvcyArIGsxIC0gaTtcbiAgICAgICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhLCBiLCBnMCwgZjAsIGYxLCBnMSwgZjIsIGcyLCBmMywgZzM7XG4gICAgICAgICAgICAgICAgICAgIGIgPSBzMiAqIGZ6W2ZpICsgazFdIC0gYzIgKiBmeltnaSArIGsxXTtcbiAgICAgICAgICAgICAgICAgICAgYSA9IGMyICogZnpbZmkgKyBrMV0gKyBzMiAqIGZ6W2dpICsgazFdO1xuICAgICAgICAgICAgICAgICAgICBmMSA9IGZ6W2ZpICsgMF0gLSBhO1xuICAgICAgICAgICAgICAgICAgICBmMCA9IGZ6W2ZpICsgMF0gKyBhO1xuICAgICAgICAgICAgICAgICAgICBnMSA9IGZ6W2dpICsgMF0gLSBiO1xuICAgICAgICAgICAgICAgICAgICBnMCA9IGZ6W2dpICsgMF0gKyBiO1xuICAgICAgICAgICAgICAgICAgICBiID0gczIgKiBmeltmaSArIGszXSAtIGMyICogZnpbZ2kgKyBrM107XG4gICAgICAgICAgICAgICAgICAgIGEgPSBjMiAqIGZ6W2ZpICsgazNdICsgczIgKiBmeltnaSArIGszXTtcbiAgICAgICAgICAgICAgICAgICAgZjMgPSBmeltmaSArIGsyXSAtIGE7XG4gICAgICAgICAgICAgICAgICAgIGYyID0gZnpbZmkgKyBrMl0gKyBhO1xuICAgICAgICAgICAgICAgICAgICBnMyA9IGZ6W2dpICsgazJdIC0gYjtcbiAgICAgICAgICAgICAgICAgICAgZzIgPSBmeltnaSArIGsyXSArIGI7XG4gICAgICAgICAgICAgICAgICAgIGIgPSBzMSAqIGYyIC0gYzEgKiBnMztcbiAgICAgICAgICAgICAgICAgICAgYSA9IGMxICogZjIgKyBzMSAqIGczO1xuICAgICAgICAgICAgICAgICAgICBmeltmaSArIGsyXSA9IGYwIC0gYTtcbiAgICAgICAgICAgICAgICAgICAgZnpbZmkgKyAwXSA9IGYwICsgYTtcbiAgICAgICAgICAgICAgICAgICAgZnpbZ2kgKyBrM10gPSBnMSAtIGI7XG4gICAgICAgICAgICAgICAgICAgIGZ6W2dpICsgazFdID0gZzEgKyBiO1xuICAgICAgICAgICAgICAgICAgICBiID0gYzEgKiBnMiAtIHMxICogZjM7XG4gICAgICAgICAgICAgICAgICAgIGEgPSBzMSAqIGcyICsgYzEgKiBmMztcbiAgICAgICAgICAgICAgICAgICAgZnpbZ2kgKyBrMl0gPSBnMCAtIGE7XG4gICAgICAgICAgICAgICAgICAgIGZ6W2dpICsgMF0gPSBnMCArIGE7XG4gICAgICAgICAgICAgICAgICAgIGZ6W2ZpICsgazNdID0gZjEgLSBiO1xuICAgICAgICAgICAgICAgICAgICBmeltmaSArIGsxXSA9IGYxICsgYjtcbiAgICAgICAgICAgICAgICAgICAgZ2kgKz0gazQ7XG4gICAgICAgICAgICAgICAgICAgIGZpICs9IGs0O1xuICAgICAgICAgICAgICAgIH0gd2hpbGUgKGZpIDwgZm4pO1xuICAgICAgICAgICAgICAgIGMyID0gYzE7XG4gICAgICAgICAgICAgICAgYzEgPSBjMiAqIGNvc3RhYlt0cmkgKyAwXSAtIHMxICogY29zdGFiW3RyaSArIDFdO1xuICAgICAgICAgICAgICAgIHMxID0gYzIgKiBjb3N0YWJbdHJpICsgMV0gKyBzMSAqIGNvc3RhYlt0cmkgKyAwXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRyaSArPSAyO1xuICAgICAgICB9IHdoaWxlIChrNCA8IG4pO1xuICAgIH1cblxuICAgIHZhciBydl90YmwgPSBbMHgwMCwgMHg4MCwgMHg0MCxcbiAgICAgICAgMHhjMCwgMHgyMCwgMHhhMCwgMHg2MCwgMHhlMCwgMHgxMCxcbiAgICAgICAgMHg5MCwgMHg1MCwgMHhkMCwgMHgzMCwgMHhiMCwgMHg3MCxcbiAgICAgICAgMHhmMCwgMHgwOCwgMHg4OCwgMHg0OCwgMHhjOCwgMHgyOCxcbiAgICAgICAgMHhhOCwgMHg2OCwgMHhlOCwgMHgxOCwgMHg5OCwgMHg1OCxcbiAgICAgICAgMHhkOCwgMHgzOCwgMHhiOCwgMHg3OCwgMHhmOCwgMHgwNCxcbiAgICAgICAgMHg4NCwgMHg0NCwgMHhjNCwgMHgyNCwgMHhhNCwgMHg2NCxcbiAgICAgICAgMHhlNCwgMHgxNCwgMHg5NCwgMHg1NCwgMHhkNCwgMHgzNCxcbiAgICAgICAgMHhiNCwgMHg3NCwgMHhmNCwgMHgwYywgMHg4YywgMHg0YyxcbiAgICAgICAgMHhjYywgMHgyYywgMHhhYywgMHg2YywgMHhlYywgMHgxYyxcbiAgICAgICAgMHg5YywgMHg1YywgMHhkYywgMHgzYywgMHhiYywgMHg3YyxcbiAgICAgICAgMHhmYywgMHgwMiwgMHg4MiwgMHg0MiwgMHhjMiwgMHgyMixcbiAgICAgICAgMHhhMiwgMHg2MiwgMHhlMiwgMHgxMiwgMHg5MiwgMHg1MixcbiAgICAgICAgMHhkMiwgMHgzMiwgMHhiMiwgMHg3MiwgMHhmMiwgMHgwYSxcbiAgICAgICAgMHg4YSwgMHg0YSwgMHhjYSwgMHgyYSwgMHhhYSwgMHg2YSxcbiAgICAgICAgMHhlYSwgMHgxYSwgMHg5YSwgMHg1YSwgMHhkYSwgMHgzYSxcbiAgICAgICAgMHhiYSwgMHg3YSwgMHhmYSwgMHgwNiwgMHg4NiwgMHg0NixcbiAgICAgICAgMHhjNiwgMHgyNiwgMHhhNiwgMHg2NiwgMHhlNiwgMHgxNixcbiAgICAgICAgMHg5NiwgMHg1NiwgMHhkNiwgMHgzNiwgMHhiNiwgMHg3NixcbiAgICAgICAgMHhmNiwgMHgwZSwgMHg4ZSwgMHg0ZSwgMHhjZSwgMHgyZSxcbiAgICAgICAgMHhhZSwgMHg2ZSwgMHhlZSwgMHgxZSwgMHg5ZSwgMHg1ZSxcbiAgICAgICAgMHhkZSwgMHgzZSwgMHhiZSwgMHg3ZSwgMHhmZV07XG5cbiAgICB0aGlzLmZmdF9zaG9ydCA9IGZ1bmN0aW9uIChnZmMsIHhfcmVhbCwgY2huLCBidWZmZXIsIGJ1ZlBvcykge1xuICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IDM7IGIrKykge1xuICAgICAgICAgICAgdmFyIHggPSBFbmNvZGVyLkJMS1NJWkVfcyAvIDI7XG4gICAgICAgICAgICB2YXIgayA9IDB4ZmZmZiAmICgoNTc2IC8gMykgKiAoYiArIDEpKTtcbiAgICAgICAgICAgIHZhciBqID0gRW5jb2Rlci5CTEtTSVpFX3MgLyA4IC0gMTtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICB2YXIgZjAsIGYxLCBmMiwgZjMsIHc7XG4gICAgICAgICAgICAgICAgdmFyIGkgPSBydl90YmxbaiA8PCAyXSAmIDB4ZmY7XG5cbiAgICAgICAgICAgICAgICBmMCA9IHdpbmRvd19zW2ldICogYnVmZmVyW2Nobl1bYnVmUG9zICsgaSArIGtdO1xuICAgICAgICAgICAgICAgIHcgPSB3aW5kb3dfc1sweDdmIC0gaV0gKiBidWZmZXJbY2huXVtidWZQb3MgKyBpICsgayArIDB4ODBdO1xuICAgICAgICAgICAgICAgIGYxID0gZjAgLSB3O1xuICAgICAgICAgICAgICAgIGYwID0gZjAgKyB3O1xuICAgICAgICAgICAgICAgIGYyID0gd2luZG93X3NbaSArIDB4NDBdICogYnVmZmVyW2Nobl1bYnVmUG9zICsgaSArIGsgKyAweDQwXTtcbiAgICAgICAgICAgICAgICB3ID0gd2luZG93X3NbMHgzZiAtIGldICogYnVmZmVyW2Nobl1bYnVmUG9zICsgaSArIGsgKyAweGMwXTtcbiAgICAgICAgICAgICAgICBmMyA9IGYyIC0gdztcbiAgICAgICAgICAgICAgICBmMiA9IGYyICsgdztcblxuICAgICAgICAgICAgICAgIHggLT0gNDtcbiAgICAgICAgICAgICAgICB4X3JlYWxbYl1beCArIDBdID0gZjAgKyBmMjtcbiAgICAgICAgICAgICAgICB4X3JlYWxbYl1beCArIDJdID0gZjAgLSBmMjtcbiAgICAgICAgICAgICAgICB4X3JlYWxbYl1beCArIDFdID0gZjEgKyBmMztcbiAgICAgICAgICAgICAgICB4X3JlYWxbYl1beCArIDNdID0gZjEgLSBmMztcblxuICAgICAgICAgICAgICAgIGYwID0gd2luZG93X3NbaSArIDB4MDFdICogYnVmZmVyW2Nobl1bYnVmUG9zICsgaSArIGsgKyAweDAxXTtcbiAgICAgICAgICAgICAgICB3ID0gd2luZG93X3NbMHg3ZSAtIGldICogYnVmZmVyW2Nobl1bYnVmUG9zICsgaSArIGsgKyAweDgxXTtcbiAgICAgICAgICAgICAgICBmMSA9IGYwIC0gdztcbiAgICAgICAgICAgICAgICBmMCA9IGYwICsgdztcbiAgICAgICAgICAgICAgICBmMiA9IHdpbmRvd19zW2kgKyAweDQxXSAqIGJ1ZmZlcltjaG5dW2J1ZlBvcyArIGkgKyBrICsgMHg0MV07XG4gICAgICAgICAgICAgICAgdyA9IHdpbmRvd19zWzB4M2UgLSBpXSAqIGJ1ZmZlcltjaG5dW2J1ZlBvcyArIGkgKyBrICsgMHhjMV07XG4gICAgICAgICAgICAgICAgZjMgPSBmMiAtIHc7XG4gICAgICAgICAgICAgICAgZjIgPSBmMiArIHc7XG5cbiAgICAgICAgICAgICAgICB4X3JlYWxbYl1beCArIEVuY29kZXIuQkxLU0laRV9zIC8gMiArIDBdID0gZjAgKyBmMjtcbiAgICAgICAgICAgICAgICB4X3JlYWxbYl1beCArIEVuY29kZXIuQkxLU0laRV9zIC8gMiArIDJdID0gZjAgLSBmMjtcbiAgICAgICAgICAgICAgICB4X3JlYWxbYl1beCArIEVuY29kZXIuQkxLU0laRV9zIC8gMiArIDFdID0gZjEgKyBmMztcbiAgICAgICAgICAgICAgICB4X3JlYWxbYl1beCArIEVuY29kZXIuQkxLU0laRV9zIC8gMiArIDNdID0gZjEgLSBmMztcbiAgICAgICAgICAgIH0gd2hpbGUgKC0taiA+PSAwKTtcblxuICAgICAgICAgICAgZmh0KHhfcmVhbFtiXSwgeCwgRW5jb2Rlci5CTEtTSVpFX3MgLyAyKTtcbiAgICAgICAgICAgIC8qIEJMS1NJWkVfcy8yIGJlY2F1c2Ugb2YgM0ROb3chIEFTTSByb3V0aW5lICovXG4gICAgICAgICAgICAvKiBCTEtTSVpFLzIgYmVjYXVzZSBvZiAzRE5vdyEgQVNNIHJvdXRpbmUgKi9cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuZmZ0X2xvbmcgPSBmdW5jdGlvbiAoZ2ZjLCB5LCBjaG4sIGJ1ZmZlciwgYnVmUG9zKSB7XG4gICAgICAgIHZhciBqaiA9IEVuY29kZXIuQkxLU0laRSAvIDggLSAxO1xuICAgICAgICB2YXIgeCA9IEVuY29kZXIuQkxLU0laRSAvIDI7XG5cbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgdmFyIGYwLCBmMSwgZjIsIGYzLCB3O1xuICAgICAgICAgICAgdmFyIGkgPSBydl90YmxbampdICYgMHhmZjtcbiAgICAgICAgICAgIGYwID0gd2luZG93W2ldICogYnVmZmVyW2Nobl1bYnVmUG9zICsgaV07XG4gICAgICAgICAgICB3ID0gd2luZG93W2kgKyAweDIwMF0gKiBidWZmZXJbY2huXVtidWZQb3MgKyBpICsgMHgyMDBdO1xuICAgICAgICAgICAgZjEgPSBmMCAtIHc7XG4gICAgICAgICAgICBmMCA9IGYwICsgdztcbiAgICAgICAgICAgIGYyID0gd2luZG93W2kgKyAweDEwMF0gKiBidWZmZXJbY2huXVtidWZQb3MgKyBpICsgMHgxMDBdO1xuICAgICAgICAgICAgdyA9IHdpbmRvd1tpICsgMHgzMDBdICogYnVmZmVyW2Nobl1bYnVmUG9zICsgaSArIDB4MzAwXTtcbiAgICAgICAgICAgIGYzID0gZjIgLSB3O1xuICAgICAgICAgICAgZjIgPSBmMiArIHc7XG5cbiAgICAgICAgICAgIHggLT0gNDtcbiAgICAgICAgICAgIHlbeCArIDBdID0gZjAgKyBmMjtcbiAgICAgICAgICAgIHlbeCArIDJdID0gZjAgLSBmMjtcbiAgICAgICAgICAgIHlbeCArIDFdID0gZjEgKyBmMztcbiAgICAgICAgICAgIHlbeCArIDNdID0gZjEgLSBmMztcblxuICAgICAgICAgICAgZjAgPSB3aW5kb3dbaSArIDB4MDAxXSAqIGJ1ZmZlcltjaG5dW2J1ZlBvcyArIGkgKyAweDAwMV07XG4gICAgICAgICAgICB3ID0gd2luZG93W2kgKyAweDIwMV0gKiBidWZmZXJbY2huXVtidWZQb3MgKyBpICsgMHgyMDFdO1xuICAgICAgICAgICAgZjEgPSBmMCAtIHc7XG4gICAgICAgICAgICBmMCA9IGYwICsgdztcbiAgICAgICAgICAgIGYyID0gd2luZG93W2kgKyAweDEwMV0gKiBidWZmZXJbY2huXVtidWZQb3MgKyBpICsgMHgxMDFdO1xuICAgICAgICAgICAgdyA9IHdpbmRvd1tpICsgMHgzMDFdICogYnVmZmVyW2Nobl1bYnVmUG9zICsgaSArIDB4MzAxXTtcbiAgICAgICAgICAgIGYzID0gZjIgLSB3O1xuICAgICAgICAgICAgZjIgPSBmMiArIHc7XG5cbiAgICAgICAgICAgIHlbeCArIEVuY29kZXIuQkxLU0laRSAvIDIgKyAwXSA9IGYwICsgZjI7XG4gICAgICAgICAgICB5W3ggKyBFbmNvZGVyLkJMS1NJWkUgLyAyICsgMl0gPSBmMCAtIGYyO1xuICAgICAgICAgICAgeVt4ICsgRW5jb2Rlci5CTEtTSVpFIC8gMiArIDFdID0gZjEgKyBmMztcbiAgICAgICAgICAgIHlbeCArIEVuY29kZXIuQkxLU0laRSAvIDIgKyAzXSA9IGYxIC0gZjM7XG4gICAgICAgIH0gd2hpbGUgKC0tamogPj0gMCk7XG5cbiAgICAgICAgZmh0KHksIHgsIEVuY29kZXIuQkxLU0laRSAvIDIpO1xuICAgICAgICAvKiBCTEtTSVpFLzIgYmVjYXVzZSBvZiAzRE5vdyEgQVNNIHJvdXRpbmUgKi9cbiAgICB9XG5cbiAgICB0aGlzLmluaXRfZmZ0ID0gZnVuY3Rpb24gKGdmYykge1xuICAgICAgICAvKiBUaGUgdHlwZSBvZiB3aW5kb3cgdXNlZCBoZXJlIHdpbGwgbWFrZSBubyByZWFsIGRpZmZlcmVuY2UsIGJ1dCAqL1xuICAgICAgICAvKlxuICAgICAgICAgKiBpbiB0aGUgaW50ZXJlc3Qgb2YgbWVyZ2luZyBuc3BzeXR1bmUgc3R1ZmYgLSBzd2l0Y2ggdG8gYmxhY2ttYW5cbiAgICAgICAgICogd2luZG93XG4gICAgICAgICAqL1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEVuY29kZXIuQkxLU0laRTsgaSsrKVxuICAgICAgICAgICAgLyogYmxhY2ttYW4gd2luZG93ICovXG4gICAgICAgICAgICB3aW5kb3dbaV0gPSAoMC40MiAtIDAuNSAqIE1hdGguY29zKDIgKiBNYXRoLlBJICogKGkgKyAuNSlcbiAgICAgICAgICAgICAgICAvIEVuY29kZXIuQkxLU0laRSkgKyAwLjA4ICogTWF0aC5jb3MoNCAqIE1hdGguUEkgKiAoaSArIC41KVxuICAgICAgICAgICAgICAgIC8gRW5jb2Rlci5CTEtTSVpFKSk7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBFbmNvZGVyLkJMS1NJWkVfcyAvIDI7IGkrKylcbiAgICAgICAgICAgIHdpbmRvd19zW2ldID0gKDAuNSAqICgxLjAgLSBNYXRoLmNvcygyLjAgKiBNYXRoLlBJXG4gICAgICAgICAgICAgICAgKiAoaSArIDAuNSkgLyBFbmNvZGVyLkJMS1NJWkVfcykpKTtcblxuICAgIH1cblxufVxuXG4vKlxuICogICAgICBwc3ltb2RlbC5jXG4gKlxuICogICAgICBDb3B5cmlnaHQgKGMpIDE5OTktMjAwMCBNYXJrIFRheWxvclxuICogICAgICBDb3B5cmlnaHQgKGMpIDIwMDEtMjAwMiBOYW9raSBTaGliYXRhXG4gKiAgICAgIENvcHlyaWdodCAoYykgMjAwMC0yMDAzIFRha2VoaXJvIFRvbWluYWdhXG4gKiAgICAgIENvcHlyaWdodCAoYykgMjAwMC0yMDA4IFJvYmVydCBIZWdlbWFublxuICogICAgICBDb3B5cmlnaHQgKGMpIDIwMDAtMjAwNSBHYWJyaWVsIEJvdXZpZ25lXG4gKiAgICAgIENvcHlyaWdodCAoYykgMjAwMC0yMDA1IEFsZXhhbmRlciBMZWlkaW5nZXJcbiAqXG4gKiBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yXG4gKiBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG4gKiBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXJcbiAqIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCxcbiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mXG4gKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVVxuICogTGlicmFyeSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuXG4gKlxuICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpY1xuICogTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCB3cml0ZSB0byB0aGVcbiAqIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgSW5jLiwgNTkgVGVtcGxlIFBsYWNlIC0gU3VpdGUgMzMwLFxuICogQm9zdG9uLCBNQSAwMjExMS0xMzA3LCBVU0EuXG4gKi9cblxuLyogJElkOiBQc3lNb2RlbC5qYXZhLHYgMS4yNyAyMDExLzA1LzI0IDIwOjQ4OjA2IGtlbmNoaXMgRXhwICQgKi9cblxuXG4vKlxuIFBTWUNITyBBQ09VU1RJQ1NcblxuXG4gVGhpcyByb3V0aW5lIGNvbXB1dGVzIHRoZSBwc3ljaG8gYWNvdXN0aWNzLCBkZWxheWVkIGJ5IG9uZSBncmFudWxlLlxuXG4gSW5wdXQ6IGJ1ZmZlciBvZiBQQ00gZGF0YSAoMTAyNCBzYW1wbGVzKS5cblxuIFRoaXMgd2luZG93IHNob3VsZCBiZSBjZW50ZXJlZCBvdmVyIHRoZSA1NzYgc2FtcGxlIGdyYW51bGUgd2luZG93LlxuIFRoZSByb3V0aW5lIHdpbGwgY29tcHV0ZSB0aGUgcHN5Y2hvIGFjb3VzdGljcyBmb3JcbiB0aGlzIGdyYW51bGUsIGJ1dCByZXR1cm4gdGhlIHBzeWNobyBhY291c3RpY3MgY29tcHV0ZWRcbiBmb3IgdGhlICpwcmV2aW91cyogZ3JhbnVsZS4gIFRoaXMgaXMgYmVjYXVzZSB0aGUgYmxvY2tcbiB0eXBlIG9mIHRoZSBwcmV2aW91cyBncmFudWxlIGNhbiBvbmx5IGJlIGRldGVybWluZWRcbiBhZnRlciB3ZSBoYXZlIGNvbXB1dGVkIHRoZSBwc3ljaG8gYWNvdXN0aWNzIGZvciB0aGUgZm9sbG93aW5nXG4gZ3JhbnVsZS5cblxuIE91dHB1dDogIG1hc2tpbmdzIGFuZCBlbmVyZ2llcyBmb3IgZWFjaCBzY2FsZWZhY3RvciBiYW5kLlxuIGJsb2NrIHR5cGUsIFBFLCBhbmQgc29tZSBjb3JyZWxhdGlvbiBtZWFzdXJlcy5cbiBUaGUgUEUgaXMgdXNlZCBieSBDQlIgbW9kZXMgdG8gZGV0ZXJtaW5lIGlmIGV4dHJhIGJpdHNcbiBmcm9tIHRoZSBiaXQgcmVzZXJ2b2lyIHNob3VsZCBiZSB1c2VkLiAgVGhlIGNvcnJlbGF0aW9uXG4gbWVhc3VyZXMgYXJlIHVzZWQgdG8gZGV0ZXJtaW5lIG1pZC9zaWRlIG9yIHJlZ3VsYXIgc3RlcmVvLlxuICovXG4vKlxuIE5vdGF0aW9uOlxuXG4gYmFya3M6ICBhIG5vbi1saW5lYXIgZnJlcXVlbmN5IHNjYWxlLiAgTWFwcGluZyBmcm9tIGZyZXF1ZW5jeSB0b1xuIGJhcmtzIGlzIGdpdmVuIGJ5IGZyZXEyYmFyaygpXG5cbiBzY2FsZWZhY3RvciBiYW5kczogVGhlIHNwZWN0cnVtIChmcmVxdWVuY2llcykgYXJlIGJyb2tlbiBpbnRvXG4gU0JNQVggXCJzY2FsZWZhY3RvciBiYW5kc1wiLiAgVGhlcyBiYW5kc1xuIGFyZSBkZXRlcm1pbmVkIGJ5IHRoZSBNUEVHIElTTyBzcGVjLiAgSW5cbiB0aGUgbm9pc2Ugc2hhcGluZy9xdWFudGl6YXRpb24gY29kZSwgd2UgYWxsb2NhdGVcbiBiaXRzIGFtb25nIHRoZSBwYXJ0aXRpb24gYmFuZHMgdG8gYWNoaWV2ZSB0aGVcbiBiZXN0IHBvc3NpYmxlIHF1YWxpdHlcblxuIHBhcnRpdGlvbiBiYW5kczogICBUaGUgc3BlY3RydW0gaXMgYWxzbyBicm9rZW4gaW50byBhYm91dFxuIDY0IFwicGFydGl0aW9uIGJhbmRzXCIuICBFYWNoIHBhcnRpdGlvblxuIGJhbmQgaXMgYWJvdXQgLjM0IGJhcmtzIHdpZGUuICBUaGVyZSBhcmUgYWJvdXQgMi01XG4gcGFydGl0aW9uIGJhbmRzIGZvciBlYWNoIHNjYWxlZmFjdG9yIGJhbmQuXG5cbiBMQU1FIGNvbXB1dGVzIGFsbCBwc3ljaG8gYWNvdXN0aWMgaW5mb3JtYXRpb24gZm9yIGVhY2ggcGFydGl0aW9uXG4gYmFuZC4gIFRoZW4gYXQgdGhlIGVuZCBvZiB0aGUgY29tcHV0YXRpb25zLCB0aGlzIGluZm9ybWF0aW9uXG4gaXMgbWFwcGVkIHRvIHNjYWxlZmFjdG9yIGJhbmRzLiAgVGhlIGVuZXJneSBpbiBlYWNoIHNjYWxlZmFjdG9yXG4gYmFuZCBpcyB0YWtlbiBhcyB0aGUgc3VtIG9mIHRoZSBlbmVyZ3kgaW4gYWxsIHBhcnRpdGlvbiBiYW5kc1xuIHdoaWNoIG92ZXJsYXAgdGhlIHNjYWxlZmFjdG9yIGJhbmQuICBUaGUgbWFza2luZ3MgY2FuIGJlIGNvbXB1dGVkXG4gaW4gdGhlIHNhbWUgd2F5IChhbmQgdGh1cyByZXByZXNlbnQgdGhlIGF2ZXJhZ2UgbWFza2luZyBpbiB0aGF0IGJhbmQpXG4gb3IgYnkgdGFraW5nIHRoZSBtaW5tdW0gdmFsdWUgbXVsdGlwbGllZCBieSB0aGUgbnVtYmVyIG9mXG4gcGFydGl0aW9uIGJhbmRzIHVzZWQgKHdoaWNoIHJlcHJlc2VudHMgYSBtaW5pbXVtIG1hc2tpbmcgaW4gdGhhdCBiYW5kKS5cbiAqL1xuLypcbiBUaGUgZ2VuZXJhbCBvdXRsaW5lIGlzIGFzIGZvbGxvd3M6XG5cbiAxLiBjb21wdXRlIHRoZSBlbmVyZ3kgaW4gZWFjaCBwYXJ0aXRpb24gYmFuZFxuIDIuIGNvbXB1dGUgdGhlIHRvbmFsaXR5IGluIGVhY2ggcGFydGl0aW9uIGJhbmRcbiAzLiBjb21wdXRlIHRoZSBzdHJlbmd0aCBvZiBlYWNoIHBhcnRpb24gYmFuZCBcIm1hc2tlclwiXG4gNC4gY29tcHV0ZSB0aGUgbWFza2luZyAodmlhIHRoZSBzcHJlYWRpbmcgZnVuY3Rpb24gYXBwbGllZCB0byBlYWNoIG1hc2tlcilcbiA1LiBNb2RpZmljYXRpb25zIGZvciBtaWQvc2lkZSBtYXNraW5nLlxuXG4gRWFjaCBwYXJ0aXRpb24gYmFuZCBpcyBjb25zaWRpZXJlZCBhIFwibWFza2VyXCIuICBUaGUgc3RyZW5ndGhcbiBvZiB0aGUgaSd0aCBtYXNrZXIgaW4gYmFuZCBqIGlzIGdpdmVuIGJ5OlxuXG4gczMoYmFyayhpKS1iYXJrKGopKSpzdHJlbmd0aChpKVxuXG4gVGhlIHN0cmVuZ3RoIG9mIHRoZSBtYXNrZXIgaXMgYSBmdW5jdGlvbiBvZiB0aGUgZW5lcmd5IGFuZCB0b25hbGl0eS5cbiBUaGUgbW9yZSB0b25hbCwgdGhlIGxlc3MgbWFza2luZy4gIExBTUUgdXNlcyBhIHNpbXBsZSBsaW5lYXIgZm9ybXVsYVxuIChjb250cm9sbGVkIGJ5IE5NVCBhbmQgVE1OKSB3aGljaCBzYXlzIHRoZSBzdHJlbmd0aCBpcyBnaXZlbiBieSB0aGVcbiBlbmVyZ3kgZGl2aWRlZCBieSBhIGxpbmVhciBmdW5jdGlvbiBvZiB0aGUgdG9uYWxpdHkuXG4gKi9cbi8qXG4gczMoKSBpcyB0aGUgXCJzcHJlYWRpbmcgZnVuY3Rpb25cIi4gIEl0IGlzIGdpdmVuIGJ5IGEgZm9ybXVsYVxuIGRldGVybWluZWQgdmlhIGxpc3RlbmluZyB0ZXN0cy5cblxuIFRoZSB0b3RhbCBtYXNraW5nIGluIHRoZSBqJ3RoIHBhcnRpdGlvbiBiYW5kIGlzIHRoZSBzdW0gb3ZlclxuIGFsbCBtYXNraW5ncyBpLiAgSXQgaXMgdGh1cyBnaXZlbiBieSB0aGUgY29udm9sdXRpb24gb2ZcbiB0aGUgc3RyZW5ndGggd2l0aCBzMygpLCB0aGUgXCJzcHJlYWRpbmcgZnVuY3Rpb24uXCJcblxuIG1hc2tpbmcoaikgPSBzdW1fb3Zlcl9pICBzMyhpLWopKnN0cmVuZ3RoKGkpICA9IHMzIG8gc3RyZW5ndGhcblxuIHdoZXJlIFwib1wiID0gY29udm9sdXRpb24gb3BlcmF0b3IuICBzMyBpcyBnaXZlbiBieSBhIGZvcm11bGEgZGV0ZXJtaW5lZFxuIHZpYSBsaXN0ZW5pbmcgdGVzdHMuICBJdCBpcyBub3JtYWxpemVkIHNvIHRoYXQgczMgbyAxID0gMS5cblxuIE5vdGU6IGluc3RlYWQgb2YgYSBzaW1wbGUgY29udm9sdXRpb24sIExBTUUgYWxzbyBoYXMgdGhlXG4gb3B0aW9uIG9mIHVzaW5nIFwiYWRkaXRpdmUgbWFza2luZ1wiXG5cbiBUaGUgbW9zdCBjcml0aWNhbCBwYXJ0IGlzIHN0ZXAgMiwgY29tcHV0aW5nIHRoZSB0b25hbGl0eSBvZiBlYWNoXG4gcGFydGl0aW9uIGJhbmQuICBMQU1FIGhhcyB0d28gdG9uYWxpdHkgZXN0aW1hdG9ycy4gIFRoZSBmaXJzdFxuIGlzIGJhc2VkIG9uIHRoZSBJU08gc3BlYywgYW5kIG1lYXN1cmVzIGhvdyBwcmVkaWN0aWFibGUgdGhlXG4gc2lnbmFsIGlzIG92ZXIgdGltZS4gIFRoZSBtb3JlIHByZWRpY3RhYmxlLCB0aGUgbW9yZSB0b25hbC5cbiBUaGUgc2Vjb25kIG1lYXN1cmUgaXMgYmFzZWQgb24gbG9va2luZyBhdCB0aGUgc3BlY3RydW0gb2ZcbiBhIHNpbmdsZSBncmFudWxlLiAgVGhlIG1vcmUgcGVha3kgdGhlIHNwZWN0cnVtLCB0aGUgbW9yZVxuIHRvbmFsLiAgQnkgbW9zdCBpbmRpY2F0aW9ucywgdGhlIGxhdHRlciBhcHByb2FjaCBpcyBiZXR0ZXIuXG5cbiBGaW5hbGx5LCBpbiBzdGVwIDUsIHRoZSBtYXNraW5ncyBmb3IgdGhlIG1pZCBhbmQgc2lkZVxuIGNoYW5uZWwgYXJlIHBvc3NpYmx5IGluY3JlYXNlZC4gIFVuZGVyIGNlcnRhaW4gY2lyY3Vtc3RhbmNlcyxcbiBub2lzZSBpbiB0aGUgbWlkICYgc2lkZSBjaGFubmVscyBpcyBhc3N1bWVkIHRvIGFsc29cbiBiZSBtYXNrZWQgYnkgc3Ryb25nIG1hc2tlcnMgaW4gdGhlIEwgb3IgUiBjaGFubmVscy5cblxuXG4gT3RoZXIgZGF0YSBjb21wdXRlZCBieSB0aGUgcHN5LW1vZGVsOlxuXG4gbXNfcmF0aW8gICAgICAgIHNpZGUtY2hhbm5lbCAvIG1pZC1jaGFubmVsIG1hc2tpbmcgcmF0aW8gKGZvciBwcmV2aW91cyBncmFudWxlKVxuIG1zX3JhdGlvX25leHQgICBzaWRlLWNoYW5uZWwgLyBtaWQtY2hhbm5lbCBtYXNraW5nIHJhdGlvIGZvciB0aGlzIGdyYW51bGVcblxuIHBlcmNlcF9lbnRyb3B5WzJdICAgICBMIGFuZCBSIHZhbHVlcyAocHJldiBncmFudWxlKSBvZiBQRSAtIEEgbWVhc3VyZSBvZiBob3dcbiBtdWNoIHByZS1lY2hvIGlzIGluIHRoZSBwcmV2aW91cyBncmFudWxlXG4gcGVyY2VwX2VudHJvcHlfTVNbMl0gIG1pZCBhbmQgc2lkZSBjaGFubmVsIHZhbHVlcyAocHJldiBncmFudWxlKSBvZiBwZXJjZXBfZW50cm9weVxuIGVuZXJneVs0XSAgICAgICAgICAgICBMLFIsTSxTIGVuZXJneSBpbiBlYWNoIGNoYW5uZWwsIHByZXYgZ3JhbnVsZVxuIGJsb2NrdHlwZV9kWzJdICAgICAgICBibG9jayB0eXBlIHRvIHVzZSBmb3IgcHJldmlvdXMgZ3JhbnVsZVxuICovXG4vL3BhY2thZ2UgbXAzO1xuXG4vL2ltcG9ydCBqYXZhLnV0aWwuQXJyYXlzO1xuXG5cbmZ1bmN0aW9uIFBzeU1vZGVsKCkge1xuXG4gICAgdmFyIGZmdCA9IG5ldyBGRlQoKTtcblxuICAgIHZhciBMT0cxMCA9IDIuMzAyNTg1MDkyOTk0MDQ1Njg0MDI7XG5cbiAgICB2YXIgcnBlbGV2ID0gMjtcbiAgICB2YXIgcnBlbGV2MiA9IDE2O1xuICAgIHZhciBycGVsZXZfcyA9IDI7XG4gICAgdmFyIHJwZWxldjJfcyA9IDE2O1xuXG4gICAgLyogc2l6ZSBvZiBlYWNoIHBhcnRpdGlvbiBiYW5kLCBpbiBiYXJrczogKi9cbiAgICB2YXIgREVMQkFSSyA9IC4zNDtcblxuICAgIC8qIHR1bmVkIGZvciBvdXRwdXQgbGV2ZWwgKHNlbnNpdGl2ZSB0byBlbmVyZ3kgc2NhbGUpICovXG4gICAgdmFyIFZPX1NDQUxFID0gKDEuIC8gKDE0NzUyICogMTQ3NTIpIC8gKEVuY29kZXIuQkxLU0laRSAvIDIpKTtcblxuICAgIHZhciB0ZW1wb3JhbG1hc2tfc3VzdGFpbl9zZWMgPSAwLjAxO1xuXG4gICAgdmFyIE5TX1BSRUVDSE9fQVRUMCA9IDAuODtcbiAgICB2YXIgTlNfUFJFRUNIT19BVFQxID0gMC42O1xuICAgIHZhciBOU19QUkVFQ0hPX0FUVDIgPSAwLjM7XG5cbiAgICB2YXIgTlNfTVNGSVggPSAzLjU7XG5cbiAgICB2YXIgTlNBVFRBQ0tUSFJFID0gNC40O1xuICAgIHZhciBOU0FUVEFDS1RIUkVfUyA9IDI1O1xuXG4gICAgdmFyIE5TRklSTEVOID0gMjE7XG5cbiAgICAvKiBzaXplIG9mIGVhY2ggcGFydGl0aW9uIGJhbmQsIGluIGJhcmtzOiAqL1xuICAgIHZhciBMTl9UT19MT0cxMCA9IDAuMjMwMjU4NTA5MztcblxuICAgIGZ1bmN0aW9uIE5PTl9MSU5FQVJfU0NBTEVfRU5FUkdZKHgpIHtcbiAgICAgICAgcmV0dXJuIHg7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogPFBSRT5cbiAgICAgKiAgICAgICBMM3BzeWNob19hbmFsLiAgQ29tcHV0ZSBwc3ljaG8gYWNvdXN0aWNzLlxuICAgICAqXG4gICAgICogICAgICAgRGF0YSByZXR1cm5lZCB0byB0aGUgY2FsbGluZyBwcm9ncmFtIG11c3QgYmUgZGVsYXllZCBieSBvbmVcbiAgICAgKiAgICAgICBncmFudWxlLlxuICAgICAqXG4gICAgICogICAgICAgVGhpcyBpcyBkb25lIGluIHR3byBwbGFjZXMuXG4gICAgICogICAgICAgSWYgd2UgZG8gbm90IG5lZWQgdG8ga25vdyB0aGUgYmxvY2t0eXBlLCB0aGUgY29weWluZ1xuICAgICAqICAgICAgIGNhbiBiZSBkb25lIGhlcmUgYXQgdGhlIHRvcCBvZiB0aGUgcHJvZ3JhbTogd2UgY29weSB0aGUgZGF0YSBmb3JcbiAgICAgKiAgICAgICB0aGUgbGFzdCBncmFudWxlIChjb21wdXRlZCBkdXJpbmcgdGhlIGxhc3QgY2FsbCkgYmVmb3JlIGl0IGlzXG4gICAgICogICAgICAgb3ZlcndyaXR0ZW4gd2l0aCB0aGUgbmV3IGRhdGEuICBJdCBsb29rcyBsaWtlIHRoaXM6XG4gICAgICpcbiAgICAgKiAgICAgICAwLiBzdGF0aWMgcHN5bW9kZWxfZGF0YVxuICAgICAqICAgICAgIDEuIGNhbGxpbmdfcHJvZ3JhbV9kYXRhID0gcHN5bW9kZWxfZGF0YVxuICAgICAqICAgICAgIDIuIGNvbXB1dGUgcHN5bW9kZWxfZGF0YVxuICAgICAqXG4gICAgICogICAgICAgRm9yIGRhdGEgd2hpY2ggbmVlZHMgdG8ga25vdyB0aGUgYmxvY2t0eXBlLCB0aGUgY29weWluZyBtdXN0IGJlXG4gICAgICogICAgICAgZG9uZSBhdCB0aGUgZW5kIG9mIHRoaXMgbG9vcCwgYW5kIHRoZSBvbGQgdmFsdWVzIG11c3QgYmUgc2F2ZWQ6XG4gICAgICpcbiAgICAgKiAgICAgICAwLiBzdGF0aWMgcHN5bW9kZWxfZGF0YV9vbGRcbiAgICAgKiAgICAgICAxLiBjb21wdXRlIHBzeW1vZGVsX2RhdGFcbiAgICAgKiAgICAgICAyLiBjb21wdXRlIHBvc3NpYmxlIGJsb2NrIHR5cGUgb2YgdGhpcyBncmFudWxlXG4gICAgICogICAgICAgMy4gY29tcHV0ZSBmaW5hbCBibG9jayB0eXBlIG9mIHByZXZpb3VzIGdyYW51bGUgYmFzZWQgb24gIzIuXG4gICAgICogICAgICAgNC4gY2FsbGluZ19wcm9ncmFtX2RhdGEgPSBwc3ltb2RlbF9kYXRhX29sZFxuICAgICAqICAgICAgIDUuIHBzeW1vZGVsX2RhdGFfb2xkID0gcHN5bW9kZWxfZGF0YVxuICAgICAqICAgICBwc3ljaG9fbG91ZG5lc3NfYXBwcm94XG4gICAgICogICAgICAgamQgLSAyMDAxIG1hciAxMlxuICAgICAqICAgIGluOiAgZW5lcmd5ICAgLSBCTEtTSVpFLzIgZWxlbWVudHMgb2YgZnJlcXVlbmN5IG1hZ25pdHVkZXMgXiAyXG4gICAgICogICAgICAgICBnZnAgICAgICAtIHVzZXMgb3V0X3NhbXBsZXJhdGUsIEFUSHR5cGUgKGFsc28gbmVlZGVkIGZvciBBVEhmb3JtdWxhKVxuICAgICAqICAgIHJldHVybnM6IGxvdWRuZXNzXjIgYXBwcm94aW1hdGlvbiwgYSBwb3NpdGl2ZSB2YWx1ZSByb3VnaGx5IHR1bmVkIGZvciBhIHZhbHVlXG4gICAgICogICAgICAgICAgICAgb2YgMS4wIGZvciBzaWduYWxzIG5lYXIgY2xpcHBpbmcuXG4gICAgICogICAgbm90ZXM6ICAgV2hlbiBjYWxpYnJhdGVkLCBmZWVkaW5nIHRoaXMgZnVuY3Rpb24gYmluYXJ5IHdoaXRlIG5vaXNlIGF0IHNhbXBsZVxuICAgICAqICAgICAgICAgICAgIHZhbHVlcyArMzI3Njcgb3IgLTMyNzY4IHNob3VsZCByZXR1cm4gdmFsdWVzIHRoYXQgYXBwcm9hY2ggMy5cbiAgICAgKiAgICAgICAgICAgICBBVEhmb3JtdWxhIGlzIHVzZWQgdG8gYXBwcm94aW1hdGUgYW4gZXF1YWwgbG91ZG5lc3MgY3VydmUuXG4gICAgICogICAgZnV0dXJlOiAgRGF0YSBpbmRpY2F0ZXMgdGhhdCB0aGUgc2hhcGUgb2YgdGhlIGVxdWFsIGxvdWRuZXNzIGN1cnZlIHZhcmllc1xuICAgICAqICAgICAgICAgICAgIHdpdGggaW50ZW5zaXR5LiAgVGhpcyBmdW5jdGlvbiBtaWdodCBiZSBpbXByb3ZlZCBieSB1c2luZyBhbiBlcXVhbFxuICAgICAqICAgICAgICAgICAgIGxvdWRuZXNzIGN1cnZlIHNoYXBlZCBmb3IgdHlwaWNhbCBwbGF5YmFjayBsZXZlbHMgKGluc3RlYWQgb2YgdGhlXG4gICAgICogICAgICAgICAgICAgQVRILCB0aGF0IGlzIHNoYXBlZCBmb3IgdGhlIHRocmVzaG9sZCkuICBBIGZsZXhpYmxlIHJlYWxpemF0aW9uIG1pZ2h0XG4gICAgICogICAgICAgICAgICAgc2ltcGx5IGJlbmQgdGhlIGV4aXN0aW5nIEFUSCBjdXJ2ZSB0byBhY2hpZXZlIHRoZSBkZXNpcmVkIHNoYXBlLlxuICAgICAqICAgICAgICAgICAgIEhvd2V2ZXIsIHRoZSBwb3RlbnRpYWwgZ2FpbiBtYXkgbm90IGJlIGVub3VnaCB0byBqdXN0aWZ5IGFuIGVmZm9ydC5cbiAgICAgKiA8L1BSRT5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBwc3ljaG9fbG91ZG5lc3NfYXBwcm94KGVuZXJneSwgZ2ZjKSB7XG4gICAgICAgIHZhciBsb3VkbmVzc19wb3dlciA9IDAuMDtcbiAgICAgICAgLyogYXBwbHkgd2VpZ2h0cyB0byBwb3dlciBpbiBmcmVxLiBiYW5kcyAqL1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEVuY29kZXIuQkxLU0laRSAvIDI7ICsraSlcbiAgICAgICAgICAgIGxvdWRuZXNzX3Bvd2VyICs9IGVuZXJneVtpXSAqIGdmYy5BVEguZXFsX3dbaV07XG4gICAgICAgIGxvdWRuZXNzX3Bvd2VyICo9IFZPX1NDQUxFO1xuXG4gICAgICAgIHJldHVybiBsb3VkbmVzc19wb3dlcjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb21wdXRlX2ZmdHMoZ2ZwLCBmZnRlbmVyZ3ksIGZmdGVuZXJneV9zLCB3c2FtcF9sLCB3c2FtcF9sUG9zLCB3c2FtcF9zLCB3c2FtcF9zUG9zLCBncl9vdXQsIGNobiwgYnVmZmVyLCBidWZQb3MpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgaWYgKGNobiA8IDIpIHtcbiAgICAgICAgICAgIGZmdC5mZnRfbG9uZyhnZmMsIHdzYW1wX2xbd3NhbXBfbFBvc10sIGNobiwgYnVmZmVyLCBidWZQb3MpO1xuICAgICAgICAgICAgZmZ0LmZmdF9zaG9ydChnZmMsIHdzYW1wX3Nbd3NhbXBfc1Bvc10sIGNobiwgYnVmZmVyLCBidWZQb3MpO1xuICAgICAgICB9XG4gICAgICAgIC8qIEZGVCBkYXRhIGZvciBtaWQgYW5kIHNpZGUgY2hhbm5lbCBpcyBkZXJpdmVkIGZyb20gTCAmIFIgKi9cbiAgICAgICAgZWxzZSBpZiAoY2huID09IDIpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSBFbmNvZGVyLkJMS1NJWkUgLSAxOyBqID49IDA7IC0taikge1xuICAgICAgICAgICAgICAgIHZhciBsID0gd3NhbXBfbFt3c2FtcF9sUG9zICsgMF1bal07XG4gICAgICAgICAgICAgICAgdmFyIHIgPSB3c2FtcF9sW3dzYW1wX2xQb3MgKyAxXVtqXTtcbiAgICAgICAgICAgICAgICB3c2FtcF9sW3dzYW1wX2xQb3MgKyAwXVtqXSA9IChsICsgcikgKiBVdGlsLlNRUlQyICogMC41O1xuICAgICAgICAgICAgICAgIHdzYW1wX2xbd3NhbXBfbFBvcyArIDFdW2pdID0gKGwgLSByKSAqIFV0aWwuU1FSVDIgKiAwLjU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBiID0gMjsgYiA+PSAwOyAtLWIpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gRW5jb2Rlci5CTEtTSVpFX3MgLSAxOyBqID49IDA7IC0taikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbCA9IHdzYW1wX3Nbd3NhbXBfc1BvcyArIDBdW2JdW2pdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgciA9IHdzYW1wX3Nbd3NhbXBfc1BvcyArIDFdW2JdW2pdO1xuICAgICAgICAgICAgICAgICAgICB3c2FtcF9zW3dzYW1wX3NQb3MgKyAwXVtiXVtqXSA9IChsICsgcikgKiBVdGlsLlNRUlQyICogMC41O1xuICAgICAgICAgICAgICAgICAgICB3c2FtcF9zW3dzYW1wX3NQb3MgKyAxXVtiXVtqXSA9IChsIC0gcikgKiBVdGlsLlNRUlQyICogMC41O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogY29tcHV0ZSBlbmVyZ2llc1xuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICBmZnRlbmVyZ3lbMF0gPSBOT05fTElORUFSX1NDQUxFX0VORVJHWSh3c2FtcF9sW3dzYW1wX2xQb3MgKyAwXVswXSk7XG4gICAgICAgIGZmdGVuZXJneVswXSAqPSBmZnRlbmVyZ3lbMF07XG5cbiAgICAgICAgZm9yICh2YXIgaiA9IEVuY29kZXIuQkxLU0laRSAvIDIgLSAxOyBqID49IDA7IC0taikge1xuICAgICAgICAgICAgdmFyIHJlID0gKHdzYW1wX2xbd3NhbXBfbFBvcyArIDBdKVtFbmNvZGVyLkJMS1NJWkUgLyAyIC0gal07XG4gICAgICAgICAgICB2YXIgaW0gPSAod3NhbXBfbFt3c2FtcF9sUG9zICsgMF0pW0VuY29kZXIuQkxLU0laRSAvIDIgKyBqXTtcbiAgICAgICAgICAgIGZmdGVuZXJneVtFbmNvZGVyLkJMS1NJWkUgLyAyIC0gal0gPSBOT05fTElORUFSX1NDQUxFX0VORVJHWSgocmVcbiAgICAgICAgICAgICAgICAqIHJlICsgaW0gKiBpbSkgKiAwLjUpO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGIgPSAyOyBiID49IDA7IC0tYikge1xuICAgICAgICAgICAgZmZ0ZW5lcmd5X3NbYl1bMF0gPSAod3NhbXBfc1t3c2FtcF9zUG9zICsgMF0pW2JdWzBdO1xuICAgICAgICAgICAgZmZ0ZW5lcmd5X3NbYl1bMF0gKj0gZmZ0ZW5lcmd5X3NbYl1bMF07XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gRW5jb2Rlci5CTEtTSVpFX3MgLyAyIC0gMTsgaiA+PSAwOyAtLWopIHtcbiAgICAgICAgICAgICAgICB2YXIgcmUgPSAod3NhbXBfc1t3c2FtcF9zUG9zICsgMF0pW2JdW0VuY29kZXIuQkxLU0laRV9zXG4gICAgICAgICAgICAgICAgLyAyIC0gal07XG4gICAgICAgICAgICAgICAgdmFyIGltID0gKHdzYW1wX3Nbd3NhbXBfc1BvcyArIDBdKVtiXVtFbmNvZGVyLkJMS1NJWkVfc1xuICAgICAgICAgICAgICAgIC8gMiArIGpdO1xuICAgICAgICAgICAgICAgIGZmdGVuZXJneV9zW2JdW0VuY29kZXIuQkxLU0laRV9zIC8gMiAtIGpdID0gTk9OX0xJTkVBUl9TQ0FMRV9FTkVSR1koKHJlXG4gICAgICAgICAgICAgICAgICAgICogcmUgKyBpbSAqIGltKSAqIDAuNSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyogdG90YWwgZW5lcmd5ICovXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciB0b3RhbGVuZXJneSA9IDAuMDtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAxMTsgaiA8IEVuY29kZXIuSEJMS1NJWkU7IGorKylcbiAgICAgICAgICAgICAgICB0b3RhbGVuZXJneSArPSBmZnRlbmVyZ3lbal07XG5cbiAgICAgICAgICAgIGdmYy50b3RfZW5lcltjaG5dID0gdG90YWxlbmVyZ3k7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ2ZwLmFuYWx5c2lzKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IEVuY29kZXIuSEJMS1NJWkU7IGorKykge1xuICAgICAgICAgICAgICAgIGdmYy5waW5mby5lbmVyZ3lbZ3Jfb3V0XVtjaG5dW2pdID0gZ2ZjLnBpbmZvLmVuZXJneV9zYXZlW2Nobl1bal07XG4gICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLmVuZXJneV9zYXZlW2Nobl1bal0gPSBmZnRlbmVyZ3lbal07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMucGluZm8ucGVbZ3Jfb3V0XVtjaG5dID0gZ2ZjLnBlW2Nobl07XG4gICAgICAgIH1cblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIGNvbXB1dGUgbG91ZG5lc3MgYXBwcm94aW1hdGlvbiAodXNlZCBmb3IgQVRIIGF1dG8tbGV2ZWwgYWRqdXN0bWVudClcbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgaWYgKGdmcC5hdGhhYV9sb3VkYXBwcm94ID09IDIgJiYgY2huIDwgMikge1xuICAgICAgICAgICAgLy8gbm8gbG91ZG5lc3MgZm9yIG1pZC9zaWRlIGNoXG4gICAgICAgICAgICBnZmMubG91ZG5lc3Nfc3FbZ3Jfb3V0XVtjaG5dID0gZ2ZjLmxvdWRuZXNzX3NxX3NhdmVbY2huXTtcbiAgICAgICAgICAgIGdmYy5sb3VkbmVzc19zcV9zYXZlW2Nobl0gPSBwc3ljaG9fbG91ZG5lc3NfYXBwcm94KGZmdGVuZXJneSwgZ2ZjKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qIG1hc2tfYWRkIG9wdGltaXphdGlvbiAqL1xuICAgIC8qIGluaXQgdGhlIGxpbWl0IHZhbHVlcyB1c2VkIHRvIGF2b2lkIGNvbXB1dGluZyBsb2cgaW4gbWFza19hZGQgd2hlbiBpdCBpcyBub3QgbmVjZXNzYXJ5ICovXG5cbiAgICAvKipcbiAgICAgKiA8UFJFPlxuICAgICAqICBGb3IgZXhhbXBsZSwgd2l0aCBpID0gMTAqbG9nMTAobTIvbTEpLzEwKjE2ICAgICAgICAgKD0gbG9nMTAobTIvbTEpKjE2KVxuICAgICAqXG4gICAgICogYWJzKGkpPjggaXMgZXF1aXZhbGVudCAoYXMgaSBpcyBhbiBpbnRlZ2VyKSB0b1xuICAgICAqIGFicyhpKT49OVxuICAgICAqIGk+PTkgfHwgaTw9LTlcbiAgICAgKiBlcXVpdmFsZW50IHRvIChhcyBpIGlzIHRoZSBiaWdnZXN0IGludGVnZXIgc21hbGxlciB0aGFuIGxvZzEwKG0yL20xKSoxNlxuICAgICAqIG9yIHRoZSBzbWFsbGVzdCBpbnRlZ2VyIGJpZ2dlciB0aGFuIGxvZzEwKG0yL20xKSoxNiBkZXBlbmRpbmcgb24gdGhlIHNpZ24gb2YgbG9nMTAobTIvbTEpKjE2KVxuICAgICAqIGxvZzEwKG0yL20xKT49OS8xNiB8fCBsb2cxMChtMi9tMSk8PS05LzE2XG4gICAgICogZXhwMTAgaXMgc3RyaWN0bHkgaW5jcmVhc2luZyB0aHVzIHRoaXMgaXMgZXF1aXZhbGVudCB0b1xuICAgICAqIG0yL20xID49IDEwXig5LzE2KSB8fCBtMi9tMTw9MTBeKC05LzE2KSB3aGljaCBhcmUgY29tcGFyaXNvbnMgdG8gY29uc3RhbnRzXG4gICAgICogPC9QUkU+XG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBhcyBpbiBpZihpPjgpXG4gICAgICovXG4gICAgdmFyIEkxTElNSVQgPSA4O1xuICAgIC8qKlxuICAgICAqIGFzIGluIGlmKGk+MjQpIC4gY2hhbmdlZCAyM1xuICAgICAqL1xuICAgIHZhciBJMkxJTUlUID0gMjM7XG4gICAgLyoqXG4gICAgICogYXMgaW4gaWYobTwxNSlcbiAgICAgKi9cbiAgICB2YXIgTUxJTUlUID0gMTU7XG5cbiAgICB2YXIgbWFfbWF4X2kxO1xuICAgIHZhciBtYV9tYXhfaTI7XG4gICAgdmFyIG1hX21heF9tO1xuXG4gICAgLyoqXG4gICAgICogVGhpcyBpcyB0aGUgbWFza2luZyB0YWJsZTo8QlI+XG4gICAgICogQWNjb3JkaW5nIHRvIHRvbmFsaXR5LCB2YWx1ZXMgYXJlIGdvaW5nIGZyb20gMGRCIChUTU4pIHRvIDkuM2RCIChOTVQpLjxCUj5cbiAgICAgKiBBZnRlciBhZGRpdGl2ZSBtYXNraW5nIGNvbXB1dGF0aW9uLCA4ZEIgYXJlIGFkZGVkLCBzbyBmaW5hbCB2YWx1ZXMgYXJlXG4gICAgICogZ29pbmcgZnJvbSA4ZEIgdG8gMTcuM2RCXG4gICAgICpcbiAgICAgKiBwb3coMTAsIC0wLjAuLi0wLjYpXG4gICAgICovXG4gICAgdmFyIHRhYiA9IFsxLjAsIDAuNzk0MzMsIDAuNjMwOTYsIDAuNjMwOTYsXG4gICAgICAgIDAuNjMwOTYsIDAuNjMwOTYsIDAuNjMwOTYsIDAuMjUxMTksIDAuMTE3NDldO1xuXG4gICAgZnVuY3Rpb24gaW5pdF9tYXNrX2FkZF9tYXhfdmFsdWVzKCkge1xuICAgICAgICBtYV9tYXhfaTEgPSBNYXRoLnBvdygxMCwgKEkxTElNSVQgKyAxKSAvIDE2LjApO1xuICAgICAgICBtYV9tYXhfaTIgPSBNYXRoLnBvdygxMCwgKEkyTElNSVQgKyAxKSAvIDE2LjApO1xuICAgICAgICBtYV9tYXhfbSA9IE1hdGgucG93KDEwLCAoTUxJTUlUKSAvIDEwLjApO1xuICAgIH1cblxuICAgIHZhciB0YWJsZTEgPSBbMy4zMjQ2ICogMy4zMjQ2LFxuICAgICAgICAzLjIzODM3ICogMy4yMzgzNywgMy4xNTQzNyAqIDMuMTU0MzcsIDMuMDA0MTIgKiAzLjAwNDEyLFxuICAgICAgICAyLjg2MTAzICogMi44NjEwMywgMi42NTQwNyAqIDIuNjU0MDcsIDIuNDYyMDkgKiAyLjQ2MjA5LFxuICAgICAgICAyLjI4NCAqIDIuMjg0LCAyLjExODc5ICogMi4xMTg3OSwgMS45NjU1MiAqIDEuOTY1NTIsXG4gICAgICAgIDEuODIzMzUgKiAxLjgyMzM1LCAxLjY5MTQ2ICogMS42OTE0NiwgMS41NjkxMSAqIDEuNTY5MTEsXG4gICAgICAgIDEuNDY2NTggKiAxLjQ2NjU4LCAxLjM3MDc0ICogMS4zNzA3NCwgMS4zMTAzNiAqIDEuMzEwMzYsXG4gICAgICAgIDEuMjUyNjQgKiAxLjI1MjY0LCAxLjIwNjQ4ICogMS4yMDY0OCwgMS4xNjIwMyAqIDEuMTYyMDMsXG4gICAgICAgIDEuMTI3NjUgKiAxLjEyNzY1LCAxLjA5NDI4ICogMS4wOTQyOCwgMS4wNjU5ICogMS4wNjU5LFxuICAgICAgICAxLjAzODI2ICogMS4wMzgyNiwgMS4wMTg5NSAqIDEuMDE4OTUsIDFdO1xuXG4gICAgdmFyIHRhYmxlMiA9IFsxLjMzMzUyICogMS4zMzM1MixcbiAgICAgICAgMS4zNTg3OSAqIDEuMzU4NzksIDEuMzg0NTQgKiAxLjM4NDU0LCAxLjM5NDk3ICogMS4zOTQ5NyxcbiAgICAgICAgMS40MDU0OCAqIDEuNDA1NDgsIDEuMzUzNyAqIDEuMzUzNywgMS4zMDM4MiAqIDEuMzAzODIsXG4gICAgICAgIDEuMjIzMjEgKiAxLjIyMzIxLCAxLjE0NzU4ICogMS4xNDc1OCwgMV07XG5cbiAgICB2YXIgdGFibGUzID0gWzIuMzUzNjQgKiAyLjM1MzY0LFxuICAgICAgICAyLjI5MjU5ICogMi4yOTI1OSwgMi4yMzMxMyAqIDIuMjMzMTMsIDIuMTI2NzUgKiAyLjEyNjc1LFxuICAgICAgICAyLjAyNTQ1ICogMi4wMjU0NSwgMS44Nzg5NCAqIDEuODc4OTQsIDEuNzQzMDMgKiAxLjc0MzAzLFxuICAgICAgICAxLjYxNjk1ICogMS42MTY5NSwgMS40OTk5OSAqIDEuNDk5OTksIDEuMzkxNDggKiAxLjM5MTQ4LFxuICAgICAgICAxLjI5MDgzICogMS4yOTA4MywgMS4xOTc0NiAqIDEuMTk3NDYsIDEuMTEwODQgKiAxLjExMDg0LFxuICAgICAgICAxLjAzODI2ICogMS4wMzgyNl07XG5cbiAgICAvKipcbiAgICAgKiBhZGRpdGlvbiBvZiBzaW11bHRhbmVvdXMgbWFza2luZyBOYW9raSBTaGliYXRhIDIwMDAvN1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIG1hc2tfYWRkKG0xLCBtMiwga2ssIGIsIGdmYywgc2hvcnRibG9jaykge1xuICAgICAgICB2YXIgcmF0aW87XG5cbiAgICAgICAgaWYgKG0yID4gbTEpIHtcbiAgICAgICAgICAgIGlmIChtMiA8IChtMSAqIG1hX21heF9pMikpXG4gICAgICAgICAgICAgICAgcmF0aW8gPSBtMiAvIG0xO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHJldHVybiAobTEgKyBtMik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAobTEgPj0gKG0yICogbWFfbWF4X2kyKSlcbiAgICAgICAgICAgICAgICByZXR1cm4gKG0xICsgbTIpO1xuICAgICAgICAgICAgcmF0aW8gPSBtMSAvIG0yO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogU2hvdWxkIGFsd2F5cyBiZSB0cnVlLCBqdXN0IGNoZWNraW5nICovXG5cbiAgICAgICAgbTEgKz0gbTI7XG4gICAgICAgIC8vaWYgKCgobG9uZykoYiArIDMpICYgMHhmZmZmZmZmZikgPD0gMyArIDMpIHtcbiAgICAgICAgaWYgKChiICsgMykgPD0gMyArIDMpIHtcbiAgICAgICAgICAgIC8qIGFwcHJveGltYXRlbHksIDEgYmFyayA9IDMgcGFydGl0aW9ucyAqL1xuICAgICAgICAgICAgLyogNjUlIG9mIHRoZSBjYXNlcyAqL1xuICAgICAgICAgICAgLyogb3JpZ2luYWxseSAnaWYoaSA+IDgpJyAqL1xuICAgICAgICAgICAgaWYgKHJhdGlvID49IG1hX21heF9pMSkge1xuICAgICAgICAgICAgICAgIC8qIDQzJSBvZiB0aGUgdG90YWwgKi9cbiAgICAgICAgICAgICAgICByZXR1cm4gbTE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qIDIyJSBvZiB0aGUgdG90YWwgKi9cbiAgICAgICAgICAgIHZhciBpID0gMCB8IChVdGlsLkZBU1RfTE9HMTBfWChyYXRpbywgMTYuMCkpO1xuICAgICAgICAgICAgcmV0dXJuIG0xICogdGFibGUyW2ldO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIDxQUkU+XG4gICAgICAgICAqIG08MTUgZXF1IGxvZzEwKChtMSttMikvZ2ZjLkFUSC5jYltrXSk8MS41XG4gICAgICAgICAqIGVxdSAobTErbTIpL2dmYy5BVEguY2Jba108MTBeMS41XG4gICAgICAgICAqIGVxdSAobTErbTIpPDEwXjEuNSAqIGdmYy5BVEguY2Jba11cbiAgICAgICAgICogPC9QUkU+XG4gICAgICAgICAqL1xuICAgICAgICB2YXIgaSA9IDAgfCBVdGlsLkZBU1RfTE9HMTBfWChyYXRpbywgMTYuMCk7XG4gICAgICAgIGlmIChzaG9ydGJsb2NrICE9IDApIHtcbiAgICAgICAgICAgIG0yID0gZ2ZjLkFUSC5jYl9zW2trXSAqIGdmYy5BVEguYWRqdXN0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbTIgPSBnZmMuQVRILmNiX2xba2tdICogZ2ZjLkFUSC5hZGp1c3Q7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG0xIDwgbWFfbWF4X20gKiBtMikge1xuICAgICAgICAgICAgLyogMyUgb2YgdGhlIHRvdGFsICovXG4gICAgICAgICAgICAvKiBPcmlnaW5hbGx5IGlmIChtID4gMCkgeyAqL1xuICAgICAgICAgICAgaWYgKG0xID4gbTIpIHtcbiAgICAgICAgICAgICAgICB2YXIgZiwgcjtcblxuICAgICAgICAgICAgICAgIGYgPSAxLjA7XG4gICAgICAgICAgICAgICAgaWYgKGkgPD0gMTMpXG4gICAgICAgICAgICAgICAgICAgIGYgPSB0YWJsZTNbaV07XG5cbiAgICAgICAgICAgICAgICByID0gVXRpbC5GQVNUX0xPRzEwX1gobTEgLyBtMiwgMTAuMCAvIDE1LjApO1xuICAgICAgICAgICAgICAgIHJldHVybiBtMSAqICgodGFibGUxW2ldIC0gZikgKiByICsgZik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChpID4gMTMpXG4gICAgICAgICAgICAgICAgcmV0dXJuIG0xO1xuXG4gICAgICAgICAgICByZXR1cm4gbTEgKiB0YWJsZTNbaV07XG4gICAgICAgIH1cblxuICAgICAgICAvKiAxMCUgb2YgdG90YWwgKi9cbiAgICAgICAgcmV0dXJuIG0xICogdGFibGUxW2ldO1xuICAgIH1cblxuICAgIHZhciB0YWJsZTJfID0gWzEuMzMzNTIgKiAxLjMzMzUyLFxuICAgICAgICAxLjM1ODc5ICogMS4zNTg3OSwgMS4zODQ1NCAqIDEuMzg0NTQsIDEuMzk0OTcgKiAxLjM5NDk3LFxuICAgICAgICAxLjQwNTQ4ICogMS40MDU0OCwgMS4zNTM3ICogMS4zNTM3LCAxLjMwMzgyICogMS4zMDM4MixcbiAgICAgICAgMS4yMjMyMSAqIDEuMjIzMjEsIDEuMTQ3NTggKiAxLjE0NzU4LCAxXTtcblxuICAgIC8qKlxuICAgICAqIGFkZGl0aW9uIG9mIHNpbXVsdGFuZW91cyBtYXNraW5nIE5hb2tpIFNoaWJhdGEgMjAwMC83XG4gICAgICovXG4gICAgZnVuY3Rpb24gdmJycHN5X21hc2tfYWRkKG0xLCBtMiwgYikge1xuICAgICAgICB2YXIgcmF0aW87XG5cbiAgICAgICAgaWYgKG0xIDwgMCkge1xuICAgICAgICAgICAgbTEgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtMiA8IDApIHtcbiAgICAgICAgICAgIG0yID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAobTEgPD0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG0yO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtMiA8PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gbTE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG0yID4gbTEpIHtcbiAgICAgICAgICAgIHJhdGlvID0gbTIgLyBtMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJhdGlvID0gbTEgLyBtMjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoLTIgPD0gYiAmJiBiIDw9IDIpIHtcbiAgICAgICAgICAgIC8qIGFwcHJveGltYXRlbHksIDEgYmFyayA9IDMgcGFydGl0aW9ucyAqL1xuICAgICAgICAgICAgLyogb3JpZ2luYWxseSAnaWYoaSA+IDgpJyAqL1xuICAgICAgICAgICAgaWYgKHJhdGlvID49IG1hX21heF9pMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBtMSArIG0yO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgaSA9IDAgfCAoVXRpbC5GQVNUX0xPRzEwX1gocmF0aW8sIDE2LjApKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKG0xICsgbTIpICogdGFibGUyX1tpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAocmF0aW8gPCBtYV9tYXhfaTIpIHtcbiAgICAgICAgICAgIHJldHVybiBtMSArIG0yO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtMSA8IG0yKSB7XG4gICAgICAgICAgICBtMSA9IG0yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtMTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjb21wdXRlIGludGVyY2hhbm5lbCBtYXNraW5nIGVmZmVjdHNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjYWxjX2ludGVyY2hhbm5lbF9tYXNraW5nKGdmcCwgcmF0aW8pIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgaWYgKGdmYy5jaGFubmVsc19vdXQgPiAxKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBzYiA9IDA7IHNiIDwgRW5jb2Rlci5TQk1BWF9sOyBzYisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGwgPSBnZmMudGhtWzBdLmxbc2JdO1xuICAgICAgICAgICAgICAgIHZhciByID0gZ2ZjLnRobVsxXS5sW3NiXTtcbiAgICAgICAgICAgICAgICBnZmMudGhtWzBdLmxbc2JdICs9IHIgKiByYXRpbztcbiAgICAgICAgICAgICAgICBnZmMudGhtWzFdLmxbc2JdICs9IGwgKiByYXRpbztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIHNiID0gMDsgc2IgPCBFbmNvZGVyLlNCTUFYX3M7IHNiKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBzYmxvY2sgPSAwOyBzYmxvY2sgPCAzOyBzYmxvY2srKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbCA9IGdmYy50aG1bMF0uc1tzYl1bc2Jsb2NrXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBnZmMudGhtWzFdLnNbc2JdW3NibG9ja107XG4gICAgICAgICAgICAgICAgICAgIGdmYy50aG1bMF0uc1tzYl1bc2Jsb2NrXSArPSByICogcmF0aW87XG4gICAgICAgICAgICAgICAgICAgIGdmYy50aG1bMV0uc1tzYl1bc2Jsb2NrXSArPSBsICogcmF0aW87XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY29tcHV0ZSBNL1MgdGhyZXNob2xkcyBmcm9tIEpvaG5zdG9uICYgRmVycmVpcmEgMTk5MiBJQ0FTU1AgcGFwZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtc2ZpeDEoZ2ZjKSB7XG4gICAgICAgIGZvciAodmFyIHNiID0gMDsgc2IgPCBFbmNvZGVyLlNCTUFYX2w7IHNiKyspIHtcbiAgICAgICAgICAgIC8qIHVzZSB0aGlzIGZpeCBpZiBMICYgUiBtYXNraW5nIGRpZmZlcnMgYnkgMmRiIG9yIGxlc3MgKi9cbiAgICAgICAgICAgIC8qIGlmIGRiID0gMTAqbG9nMTAoeDIveDEpIDwgMiAqL1xuICAgICAgICAgICAgLyogaWYgKHgyIDwgMS41OCp4MSkgeyAqL1xuICAgICAgICAgICAgaWYgKGdmYy50aG1bMF0ubFtzYl0gPiAxLjU4ICogZ2ZjLnRobVsxXS5sW3NiXVxuICAgICAgICAgICAgICAgIHx8IGdmYy50aG1bMV0ubFtzYl0gPiAxLjU4ICogZ2ZjLnRobVswXS5sW3NiXSlcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIHZhciBtbGQgPSBnZmMubWxkX2xbc2JdICogZ2ZjLmVuWzNdLmxbc2JdO1xuICAgICAgICAgICAgdmFyIHJtaWQgPSBNYXRoLm1heChnZmMudGhtWzJdLmxbc2JdLFxuICAgICAgICAgICAgICAgIE1hdGgubWluKGdmYy50aG1bM10ubFtzYl0sIG1sZCkpO1xuXG4gICAgICAgICAgICBtbGQgPSBnZmMubWxkX2xbc2JdICogZ2ZjLmVuWzJdLmxbc2JdO1xuICAgICAgICAgICAgdmFyIHJzaWRlID0gTWF0aC5tYXgoZ2ZjLnRobVszXS5sW3NiXSxcbiAgICAgICAgICAgICAgICBNYXRoLm1pbihnZmMudGhtWzJdLmxbc2JdLCBtbGQpKTtcbiAgICAgICAgICAgIGdmYy50aG1bMl0ubFtzYl0gPSBybWlkO1xuICAgICAgICAgICAgZ2ZjLnRobVszXS5sW3NiXSA9IHJzaWRlO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgc2IgPSAwOyBzYiA8IEVuY29kZXIuU0JNQVhfczsgc2IrKykge1xuICAgICAgICAgICAgZm9yICh2YXIgc2Jsb2NrID0gMDsgc2Jsb2NrIDwgMzsgc2Jsb2NrKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLnRobVswXS5zW3NiXVtzYmxvY2tdID4gMS41OCAqIGdmYy50aG1bMV0uc1tzYl1bc2Jsb2NrXVxuICAgICAgICAgICAgICAgICAgICB8fCBnZmMudGhtWzFdLnNbc2JdW3NibG9ja10gPiAxLjU4ICogZ2ZjLnRobVswXS5zW3NiXVtzYmxvY2tdKVxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB2YXIgbWxkID0gZ2ZjLm1sZF9zW3NiXSAqIGdmYy5lblszXS5zW3NiXVtzYmxvY2tdO1xuICAgICAgICAgICAgICAgIHZhciBybWlkID0gTWF0aC5tYXgoZ2ZjLnRobVsyXS5zW3NiXVtzYmxvY2tdLFxuICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihnZmMudGhtWzNdLnNbc2JdW3NibG9ja10sIG1sZCkpO1xuXG4gICAgICAgICAgICAgICAgbWxkID0gZ2ZjLm1sZF9zW3NiXSAqIGdmYy5lblsyXS5zW3NiXVtzYmxvY2tdO1xuICAgICAgICAgICAgICAgIHZhciByc2lkZSA9IE1hdGgubWF4KGdmYy50aG1bM10uc1tzYl1bc2Jsb2NrXSxcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oZ2ZjLnRobVsyXS5zW3NiXVtzYmxvY2tdLCBtbGQpKTtcblxuICAgICAgICAgICAgICAgIGdmYy50aG1bMl0uc1tzYl1bc2Jsb2NrXSA9IHJtaWQ7XG4gICAgICAgICAgICAgICAgZ2ZjLnRobVszXS5zW3NiXVtzYmxvY2tdID0gcnNpZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGp1c3QgTS9TIG1hc2tpbmdzIGlmIHVzZXIgc2V0IFwibXNmaXhcIlxuICAgICAqXG4gICAgICogTmFva2kgU2hpYmF0YSAyMDAwXG4gICAgICovXG4gICAgZnVuY3Rpb24gbnNfbXNmaXgoZ2ZjLCBtc2ZpeCwgYXRoYWRqdXN0KSB7XG4gICAgICAgIHZhciBtc2ZpeDIgPSBtc2ZpeDtcbiAgICAgICAgdmFyIGF0aGxvd2VyID0gTWF0aC5wb3coMTAsIGF0aGFkanVzdCk7XG5cbiAgICAgICAgbXNmaXggKj0gMi4wO1xuICAgICAgICBtc2ZpeDIgKj0gMi4wO1xuICAgICAgICBmb3IgKHZhciBzYiA9IDA7IHNiIDwgRW5jb2Rlci5TQk1BWF9sOyBzYisrKSB7XG4gICAgICAgICAgICB2YXIgdGhtTFIsIHRobU0sIHRobVMsIGF0aDtcbiAgICAgICAgICAgIGF0aCA9IChnZmMuQVRILmNiX2xbZ2ZjLmJtX2xbc2JdXSkgKiBhdGhsb3dlcjtcbiAgICAgICAgICAgIHRobUxSID0gTWF0aC5taW4oTWF0aC5tYXgoZ2ZjLnRobVswXS5sW3NiXSwgYXRoKSxcbiAgICAgICAgICAgICAgICBNYXRoLm1heChnZmMudGhtWzFdLmxbc2JdLCBhdGgpKTtcbiAgICAgICAgICAgIHRobU0gPSBNYXRoLm1heChnZmMudGhtWzJdLmxbc2JdLCBhdGgpO1xuICAgICAgICAgICAgdGhtUyA9IE1hdGgubWF4KGdmYy50aG1bM10ubFtzYl0sIGF0aCk7XG4gICAgICAgICAgICBpZiAodGhtTFIgKiBtc2ZpeCA8IHRobU0gKyB0aG1TKSB7XG4gICAgICAgICAgICAgICAgdmFyIGYgPSB0aG1MUiAqIG1zZml4MiAvICh0aG1NICsgdGhtUyk7XG4gICAgICAgICAgICAgICAgdGhtTSAqPSBmO1xuICAgICAgICAgICAgICAgIHRobVMgKj0gZjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy50aG1bMl0ubFtzYl0gPSBNYXRoLm1pbih0aG1NLCBnZmMudGhtWzJdLmxbc2JdKTtcbiAgICAgICAgICAgIGdmYy50aG1bM10ubFtzYl0gPSBNYXRoLm1pbih0aG1TLCBnZmMudGhtWzNdLmxbc2JdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGF0aGxvd2VyICo9ICggRW5jb2Rlci5CTEtTSVpFX3MgLyBFbmNvZGVyLkJMS1NJWkUpO1xuICAgICAgICBmb3IgKHZhciBzYiA9IDA7IHNiIDwgRW5jb2Rlci5TQk1BWF9zOyBzYisrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBzYmxvY2sgPSAwOyBzYmxvY2sgPCAzOyBzYmxvY2srKykge1xuICAgICAgICAgICAgICAgIHZhciB0aG1MUiwgdGhtTSwgdGhtUywgYXRoO1xuICAgICAgICAgICAgICAgIGF0aCA9IChnZmMuQVRILmNiX3NbZ2ZjLmJtX3Nbc2JdXSkgKiBhdGhsb3dlcjtcbiAgICAgICAgICAgICAgICB0aG1MUiA9IE1hdGgubWluKE1hdGgubWF4KGdmYy50aG1bMF0uc1tzYl1bc2Jsb2NrXSwgYXRoKSxcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5tYXgoZ2ZjLnRobVsxXS5zW3NiXVtzYmxvY2tdLCBhdGgpKTtcbiAgICAgICAgICAgICAgICB0aG1NID0gTWF0aC5tYXgoZ2ZjLnRobVsyXS5zW3NiXVtzYmxvY2tdLCBhdGgpO1xuICAgICAgICAgICAgICAgIHRobVMgPSBNYXRoLm1heChnZmMudGhtWzNdLnNbc2JdW3NibG9ja10sIGF0aCk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhtTFIgKiBtc2ZpeCA8IHRobU0gKyB0aG1TKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmID0gdGhtTFIgKiBtc2ZpeCAvICh0aG1NICsgdGhtUyk7XG4gICAgICAgICAgICAgICAgICAgIHRobU0gKj0gZjtcbiAgICAgICAgICAgICAgICAgICAgdGhtUyAqPSBmO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBnZmMudGhtWzJdLnNbc2JdW3NibG9ja10gPSBNYXRoLm1pbihnZmMudGhtWzJdLnNbc2JdW3NibG9ja10sXG4gICAgICAgICAgICAgICAgICAgIHRobU0pO1xuICAgICAgICAgICAgICAgIGdmYy50aG1bM10uc1tzYl1bc2Jsb2NrXSA9IE1hdGgubWluKGdmYy50aG1bM10uc1tzYl1bc2Jsb2NrXSxcbiAgICAgICAgICAgICAgICAgICAgdGhtUyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBzaG9ydCBibG9jayB0aHJlc2hvbGQgY2FsY3VsYXRpb24gKHBhcnQgMilcbiAgICAgKlxuICAgICAqIHBhcnRpdGlvbiBiYW5kIGJvX3Nbc2ZiXSBpcyBhdCB0aGUgdHJhbnNpdGlvbiBmcm9tIHNjYWxlZmFjdG9yIGJhbmQgc2ZiXG4gICAgICogdG8gdGhlIG5leHQgb25lIHNmYisxOyBlbm4gYW5kIHRobW0gaGF2ZSB0byBiZSBzcGxpdCBiZXR3ZWVuIHRoZW1cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb252ZXJ0X3BhcnRpdGlvbjJzY2FsZWZhY19zKGdmYywgZWIsIHRociwgY2huLCBzYmxvY2spIHtcbiAgICAgICAgdmFyIHNiLCBiO1xuICAgICAgICB2YXIgZW5uID0gMC4wO1xuICAgICAgICB2YXIgdGhtbSA9IDAuMDtcbiAgICAgICAgZm9yIChzYiA9IGIgPSAwOyBzYiA8IEVuY29kZXIuU0JNQVhfczsgKytiLCArK3NiKSB7XG4gICAgICAgICAgICB2YXIgYm9fc19zYiA9IGdmYy5ib19zW3NiXTtcbiAgICAgICAgICAgIHZhciBucGFydF9zID0gZ2ZjLm5wYXJ0X3M7XG4gICAgICAgICAgICB2YXIgYl9saW0gPSBib19zX3NiIDwgbnBhcnRfcyA/IGJvX3Nfc2IgOiBucGFydF9zO1xuICAgICAgICAgICAgd2hpbGUgKGIgPCBiX2xpbSkge1xuICAgICAgICAgICAgICAgIC8vIGlmZiBmYWlsZWQsIGl0IG1heSBpbmRpY2F0ZSBzb21lIGluZGV4IGVycm9yIGVsc2V3aGVyZVxuICAgICAgICAgICAgICAgIGVubiArPSBlYltiXTtcbiAgICAgICAgICAgICAgICB0aG1tICs9IHRocltiXTtcbiAgICAgICAgICAgICAgICBiKys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMuZW5bY2huXS5zW3NiXVtzYmxvY2tdID0gZW5uO1xuICAgICAgICAgICAgZ2ZjLnRobVtjaG5dLnNbc2JdW3NibG9ja10gPSB0aG1tO1xuXG4gICAgICAgICAgICBpZiAoYiA+PSBucGFydF9zKSB7XG4gICAgICAgICAgICAgICAgKytzYjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGlmZiBmYWlsZWQsIGl0IG1heSBpbmRpY2F0ZSBzb21lIGluZGV4IGVycm9yIGVsc2V3aGVyZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8qIGF0IHRyYW5zaXRpb24gc2ZiIC4gc2ZiKzEgKi9cbiAgICAgICAgICAgICAgICB2YXIgd19jdXJyID0gZ2ZjLlBTWS5ib19zX3dlaWdodFtzYl07XG4gICAgICAgICAgICAgICAgdmFyIHdfbmV4dCA9IDEuMCAtIHdfY3VycjtcbiAgICAgICAgICAgICAgICBlbm4gPSB3X2N1cnIgKiBlYltiXTtcbiAgICAgICAgICAgICAgICB0aG1tID0gd19jdXJyICogdGhyW2JdO1xuICAgICAgICAgICAgICAgIGdmYy5lbltjaG5dLnNbc2JdW3NibG9ja10gKz0gZW5uO1xuICAgICAgICAgICAgICAgIGdmYy50aG1bY2huXS5zW3NiXVtzYmxvY2tdICs9IHRobW07XG4gICAgICAgICAgICAgICAgZW5uID0gd19uZXh0ICogZWJbYl07XG4gICAgICAgICAgICAgICAgdGhtbSA9IHdfbmV4dCAqIHRocltiXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiB6ZXJvIGluaXRpYWxpemUgdGhlIHJlc3QgKi9cbiAgICAgICAgZm9yICg7IHNiIDwgRW5jb2Rlci5TQk1BWF9zOyArK3NiKSB7XG4gICAgICAgICAgICBnZmMuZW5bY2huXS5zW3NiXVtzYmxvY2tdID0gMDtcbiAgICAgICAgICAgIGdmYy50aG1bY2huXS5zW3NiXVtzYmxvY2tdID0gMDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGxvbmdibG9jayB0aHJlc2hvbGQgY2FsY3VsYXRpb24gKHBhcnQgMilcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb252ZXJ0X3BhcnRpdGlvbjJzY2FsZWZhY19sKGdmYywgZWIsIHRociwgY2huKSB7XG4gICAgICAgIHZhciBzYiwgYjtcbiAgICAgICAgdmFyIGVubiA9IDAuMDtcbiAgICAgICAgdmFyIHRobW0gPSAwLjA7XG4gICAgICAgIGZvciAoc2IgPSBiID0gMDsgc2IgPCBFbmNvZGVyLlNCTUFYX2w7ICsrYiwgKytzYikge1xuICAgICAgICAgICAgdmFyIGJvX2xfc2IgPSBnZmMuYm9fbFtzYl07XG4gICAgICAgICAgICB2YXIgbnBhcnRfbCA9IGdmYy5ucGFydF9sO1xuICAgICAgICAgICAgdmFyIGJfbGltID0gYm9fbF9zYiA8IG5wYXJ0X2wgPyBib19sX3NiIDogbnBhcnRfbDtcbiAgICAgICAgICAgIHdoaWxlIChiIDwgYl9saW0pIHtcbiAgICAgICAgICAgICAgICAvLyBpZmYgZmFpbGVkLCBpdCBtYXkgaW5kaWNhdGUgc29tZSBpbmRleCBlcnJvciBlbHNld2hlcmVcbiAgICAgICAgICAgICAgICBlbm4gKz0gZWJbYl07XG4gICAgICAgICAgICAgICAgdGhtbSArPSB0aHJbYl07XG4gICAgICAgICAgICAgICAgYisrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLmVuW2Nobl0ubFtzYl0gPSBlbm47XG4gICAgICAgICAgICBnZmMudGhtW2Nobl0ubFtzYl0gPSB0aG1tO1xuXG4gICAgICAgICAgICBpZiAoYiA+PSBucGFydF9sKSB7XG4gICAgICAgICAgICAgICAgKytzYjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvKiBhdCB0cmFuc2l0aW9uIHNmYiAuIHNmYisxICovXG4gICAgICAgICAgICAgICAgdmFyIHdfY3VyciA9IGdmYy5QU1kuYm9fbF93ZWlnaHRbc2JdO1xuICAgICAgICAgICAgICAgIHZhciB3X25leHQgPSAxLjAgLSB3X2N1cnI7XG4gICAgICAgICAgICAgICAgZW5uID0gd19jdXJyICogZWJbYl07XG4gICAgICAgICAgICAgICAgdGhtbSA9IHdfY3VyciAqIHRocltiXTtcbiAgICAgICAgICAgICAgICBnZmMuZW5bY2huXS5sW3NiXSArPSBlbm47XG4gICAgICAgICAgICAgICAgZ2ZjLnRobVtjaG5dLmxbc2JdICs9IHRobW07XG4gICAgICAgICAgICAgICAgZW5uID0gd19uZXh0ICogZWJbYl07XG4gICAgICAgICAgICAgICAgdGhtbSA9IHdfbmV4dCAqIHRocltiXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiB6ZXJvIGluaXRpYWxpemUgdGhlIHJlc3QgKi9cbiAgICAgICAgZm9yICg7IHNiIDwgRW5jb2Rlci5TQk1BWF9sOyArK3NiKSB7XG4gICAgICAgICAgICBnZmMuZW5bY2huXS5sW3NiXSA9IDA7XG4gICAgICAgICAgICBnZmMudGhtW2Nobl0ubFtzYl0gPSAwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29tcHV0ZV9tYXNraW5nX3MoZ2ZwLCBmZnRlbmVyZ3lfcywgZWIsIHRociwgY2huLCBzYmxvY2spIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGosIGI7XG5cbiAgICAgICAgZm9yIChiID0gaiA9IDA7IGIgPCBnZmMubnBhcnRfczsgKytiKSB7XG4gICAgICAgICAgICB2YXIgZWJiID0gMCwgbSA9IDA7XG4gICAgICAgICAgICB2YXIgbiA9IGdmYy5udW1saW5lc19zW2JdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyArK2ksICsraikge1xuICAgICAgICAgICAgICAgIHZhciBlbCA9IGZmdGVuZXJneV9zW3NibG9ja11bal07XG4gICAgICAgICAgICAgICAgZWJiICs9IGVsO1xuICAgICAgICAgICAgICAgIGlmIChtIDwgZWwpXG4gICAgICAgICAgICAgICAgICAgIG0gPSBlbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGViW2JdID0gZWJiO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoaiA9IGIgPSAwOyBiIDwgZ2ZjLm5wYXJ0X3M7IGIrKykge1xuICAgICAgICAgICAgdmFyIGtrID0gZ2ZjLnMzaW5kX3NbYl1bMF07XG4gICAgICAgICAgICB2YXIgZWNiID0gZ2ZjLnMzX3NzW2orK10gKiBlYltra107XG4gICAgICAgICAgICArK2trO1xuICAgICAgICAgICAgd2hpbGUgKGtrIDw9IGdmYy5zM2luZF9zW2JdWzFdKSB7XG4gICAgICAgICAgICAgICAgZWNiICs9IGdmYy5zM19zc1tqXSAqIGViW2trXTtcbiAgICAgICAgICAgICAgICArK2o7XG4gICAgICAgICAgICAgICAgKytraztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgeyAvKiBsaW1pdCBjYWxjdWxhdGVkIHRocmVzaG9sZCBieSBwcmV2aW91cyBncmFudWxlICovXG4gICAgICAgICAgICAgICAgdmFyIHggPSBycGVsZXZfcyAqIGdmYy5uYl9zMVtjaG5dW2JdO1xuICAgICAgICAgICAgICAgIHRocltiXSA9IE1hdGgubWluKGVjYiwgeCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ2ZjLmJsb2NrdHlwZV9vbGRbY2huICYgMV0gPT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgLyogbGltaXQgY2FsY3VsYXRlZCB0aHJlc2hvbGQgYnkgZXZlbiBvbGRlciBncmFudWxlICovXG4gICAgICAgICAgICAgICAgdmFyIHggPSBycGVsZXYyX3MgKiBnZmMubmJfczJbY2huXVtiXTtcbiAgICAgICAgICAgICAgICB2YXIgeSA9IHRocltiXTtcbiAgICAgICAgICAgICAgICB0aHJbYl0gPSBNYXRoLm1pbih4LCB5KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZ2ZjLm5iX3MyW2Nobl1bYl0gPSBnZmMubmJfczFbY2huXVtiXTtcbiAgICAgICAgICAgIGdmYy5uYl9zMVtjaG5dW2JdID0gZWNiO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoOyBiIDw9IEVuY29kZXIuQ0JBTkRTOyArK2IpIHtcbiAgICAgICAgICAgIGViW2JdID0gMDtcbiAgICAgICAgICAgIHRocltiXSA9IDA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBibG9ja190eXBlX3NldChnZnAsIHVzZWxvbmdibG9jaywgYmxvY2t0eXBlX2QsIGJsb2NrdHlwZSkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXG4gICAgICAgIGlmIChnZnAuc2hvcnRfYmxvY2tzID09IFNob3J0QmxvY2suc2hvcnRfYmxvY2tfY291cGxlZFxuICAgICAgICAgICAgICAgIC8qIGZvcmNlIGJvdGggY2hhbm5lbHMgdG8gdXNlIHRoZSBzYW1lIGJsb2NrIHR5cGUgKi9cbiAgICAgICAgICAgICAgICAvKiB0aGlzIGlzIG5lY2Vzc2FyeSBpZiB0aGUgZnJhbWUgaXMgdG8gYmUgZW5jb2RlZCBpbiBtc19zdGVyZW8uICovXG4gICAgICAgICAgICAgICAgLyogQnV0IGV2ZW4gd2l0aG91dCBtc19zdGVyZW8sIEZoRyBkb2VzIHRoaXMgKi9cbiAgICAgICAgICAgICYmICEodXNlbG9uZ2Jsb2NrWzBdICE9IDAgJiYgdXNlbG9uZ2Jsb2NrWzFdICE9IDApKVxuICAgICAgICAgICAgdXNlbG9uZ2Jsb2NrWzBdID0gdXNlbG9uZ2Jsb2NrWzFdID0gMDtcblxuICAgICAgICAvKlxuICAgICAgICAgKiB1cGRhdGUgdGhlIGJsb2NrdHlwZSBvZiB0aGUgcHJldmlvdXMgZ3JhbnVsZSwgc2luY2UgaXQgZGVwZW5kcyBvblxuICAgICAgICAgKiB3aGF0IGhhcHBlbmQgaW4gdGhpcyBncmFudWxlXG4gICAgICAgICAqL1xuICAgICAgICBmb3IgKHZhciBjaG4gPSAwOyBjaG4gPCBnZmMuY2hhbm5lbHNfb3V0OyBjaG4rKykge1xuICAgICAgICAgICAgYmxvY2t0eXBlW2Nobl0gPSBFbmNvZGVyLk5PUk1fVFlQRTtcbiAgICAgICAgICAgIC8qIGRpc2FibGUgc2hvcnQgYmxvY2tzICovXG4gICAgICAgICAgICBpZiAoZ2ZwLnNob3J0X2Jsb2NrcyA9PSBTaG9ydEJsb2NrLnNob3J0X2Jsb2NrX2Rpc3BlbnNlZClcbiAgICAgICAgICAgICAgICB1c2Vsb25nYmxvY2tbY2huXSA9IDE7XG4gICAgICAgICAgICBpZiAoZ2ZwLnNob3J0X2Jsb2NrcyA9PSBTaG9ydEJsb2NrLnNob3J0X2Jsb2NrX2ZvcmNlZClcbiAgICAgICAgICAgICAgICB1c2Vsb25nYmxvY2tbY2huXSA9IDA7XG5cbiAgICAgICAgICAgIGlmICh1c2Vsb25nYmxvY2tbY2huXSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgLyogbm8gYXR0YWNrIDogdXNlIGxvbmcgYmxvY2tzICovXG4gICAgICAgICAgICAgICAgaWYgKGdmYy5ibG9ja3R5cGVfb2xkW2Nobl0gPT0gRW5jb2Rlci5TSE9SVF9UWVBFKVxuICAgICAgICAgICAgICAgICAgICBibG9ja3R5cGVbY2huXSA9IEVuY29kZXIuU1RPUF9UWVBFO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvKiBhdHRhY2sgOiB1c2Ugc2hvcnQgYmxvY2tzICovXG4gICAgICAgICAgICAgICAgYmxvY2t0eXBlW2Nobl0gPSBFbmNvZGVyLlNIT1JUX1RZUEU7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5ibG9ja3R5cGVfb2xkW2Nobl0gPT0gRW5jb2Rlci5OT1JNX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLmJsb2NrdHlwZV9vbGRbY2huXSA9IEVuY29kZXIuU1RBUlRfVFlQRTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5ibG9ja3R5cGVfb2xkW2Nobl0gPT0gRW5jb2Rlci5TVE9QX1RZUEUpXG4gICAgICAgICAgICAgICAgICAgIGdmYy5ibG9ja3R5cGVfb2xkW2Nobl0gPSBFbmNvZGVyLlNIT1JUX1RZUEU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJsb2NrdHlwZV9kW2Nobl0gPSBnZmMuYmxvY2t0eXBlX29sZFtjaG5dO1xuICAgICAgICAgICAgLy8gdmFsdWUgcmV0dXJuZWQgdG8gY2FsbGluZyBwcm9ncmFtXG4gICAgICAgICAgICBnZmMuYmxvY2t0eXBlX29sZFtjaG5dID0gYmxvY2t0eXBlW2Nobl07XG4gICAgICAgICAgICAvLyBzYXZlIGZvciBuZXh0IGNhbGwgdG8gbDNwc3lfYW5hbFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gTlNfSU5URVJQKHgsIHksIHIpIHtcbiAgICAgICAgLyogd2FzIHBvdygoeCksKHIpKSpwb3coKHkpLDEtKHIpKSAqL1xuICAgICAgICBpZiAociA+PSAxLjApIHtcbiAgICAgICAgICAgIC8qIDk5LjclIG9mIHRoZSB0aW1lICovXG4gICAgICAgICAgICByZXR1cm4geDtcbiAgICAgICAgfVxuICAgICAgICBpZiAociA8PSAwLjApXG4gICAgICAgICAgICByZXR1cm4geTtcbiAgICAgICAgaWYgKHkgPiAwLjApIHtcbiAgICAgICAgICAgIC8qIHJlc3Qgb2YgdGhlIHRpbWUgKi9cbiAgICAgICAgICAgIHJldHVybiAoTWF0aC5wb3coeCAvIHksIHIpICogeSk7XG4gICAgICAgIH1cbiAgICAgICAgLyogbmV2ZXIgaGFwcGVucyAqL1xuICAgICAgICByZXR1cm4gMC4wO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHRoZXNlIHZhbHVlcyBhcmUgdHVuZWQgb25seSBmb3IgNDQuMWtIei4uLlxuICAgICAqL1xuICAgIHZhciByZWdjb2VmX3MgPSBbMTEuOCwgMTMuNiwgMTcuMiwgMzIsIDQ2LjUsXG4gICAgICAgIDUxLjMsIDU3LjUsIDY3LjEsIDcxLjUsIDg0LjYsIDk3LjYsIDEzMCxcbiAgICAgICAgLyogMjU1LjggKi9cbiAgICBdO1xuXG4gICAgZnVuY3Rpb24gcGVjYWxjX3MobXIsIG1hc2tpbmdfbG93ZXIpIHtcbiAgICAgICAgdmFyIHBlX3MgPSAxMjM2LjI4IC8gNDtcbiAgICAgICAgZm9yICh2YXIgc2IgPSAwOyBzYiA8IEVuY29kZXIuU0JNQVhfcyAtIDE7IHNiKyspIHtcbiAgICAgICAgICAgIGZvciAodmFyIHNibG9jayA9IDA7IHNibG9jayA8IDM7IHNibG9jaysrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRobSA9IG1yLnRobS5zW3NiXVtzYmxvY2tdO1xuICAgICAgICAgICAgICAgIGlmICh0aG0gPiAwLjApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHggPSB0aG0gKiBtYXNraW5nX2xvd2VyO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZW4gPSBtci5lbi5zW3NiXVtzYmxvY2tdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZW4gPiB4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW4gPiB4ICogMWUxMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlX3MgKz0gcmVnY29lZl9zW3NiXSAqICgxMC4wICogTE9HMTApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZV9zICs9IHJlZ2NvZWZfc1tzYl0gKiBVdGlsLkZBU1RfTE9HMTAoZW4gLyB4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBwZV9zO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHRoZXNlIHZhbHVlcyBhcmUgdHVuZWQgb25seSBmb3IgNDQuMWtIei4uLlxuICAgICAqL1xuICAgIHZhciByZWdjb2VmX2wgPSBbNi44LCA1LjgsIDUuOCwgNi40LCA2LjUsIDkuOSxcbiAgICAgICAgMTIuMSwgMTQuNCwgMTUsIDE4LjksIDIxLjYsIDI2LjksIDM0LjIsIDQwLjIsIDQ2LjgsIDU2LjUsXG4gICAgICAgIDYwLjcsIDczLjksIDg1LjcsIDkzLjQsIDEyNi4xLFxuICAgICAgICAvKiAyNDEuMyAqL1xuICAgIF07XG5cbiAgICBmdW5jdGlvbiBwZWNhbGNfbChtciwgbWFza2luZ19sb3dlcikge1xuICAgICAgICB2YXIgcGVfbCA9IDExMjQuMjMgLyA0O1xuICAgICAgICBmb3IgKHZhciBzYiA9IDA7IHNiIDwgRW5jb2Rlci5TQk1BWF9sIC0gMTsgc2IrKykge1xuICAgICAgICAgICAgdmFyIHRobSA9IG1yLnRobS5sW3NiXTtcbiAgICAgICAgICAgIGlmICh0aG0gPiAwLjApIHtcbiAgICAgICAgICAgICAgICB2YXIgeCA9IHRobSAqIG1hc2tpbmdfbG93ZXI7XG4gICAgICAgICAgICAgICAgdmFyIGVuID0gbXIuZW4ubFtzYl07XG4gICAgICAgICAgICAgICAgaWYgKGVuID4geCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZW4gPiB4ICogMWUxMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGVfbCArPSByZWdjb2VmX2xbc2JdICogKDEwLjAgKiBMT0cxMCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwZV9sICs9IHJlZ2NvZWZfbFtzYl0gKiBVdGlsLkZBU1RfTE9HMTAoZW4gLyB4KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcGVfbDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjYWxjX2VuZXJneShnZmMsIGZmdGVuZXJneSwgZWIsIG1heCwgYXZnKSB7XG4gICAgICAgIHZhciBiLCBqO1xuXG4gICAgICAgIGZvciAoYiA9IGogPSAwOyBiIDwgZ2ZjLm5wYXJ0X2w7ICsrYikge1xuICAgICAgICAgICAgdmFyIGViYiA9IDAsIG0gPSAwO1xuICAgICAgICAgICAgdmFyIGk7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZ2ZjLm51bWxpbmVzX2xbYl07ICsraSwgKytqKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsID0gZmZ0ZW5lcmd5W2pdO1xuICAgICAgICAgICAgICAgIGViYiArPSBlbDtcbiAgICAgICAgICAgICAgICBpZiAobSA8IGVsKVxuICAgICAgICAgICAgICAgICAgICBtID0gZWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlYltiXSA9IGViYjtcbiAgICAgICAgICAgIG1heFtiXSA9IG07XG4gICAgICAgICAgICBhdmdbYl0gPSBlYmIgKiBnZmMucm51bWxpbmVzX2xbYl07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjYWxjX21hc2tfaW5kZXhfbChnZmMsIG1heCwgYXZnLCBtYXNrX2lkeCkge1xuICAgICAgICB2YXIgbGFzdF90YWJfZW50cnkgPSB0YWIubGVuZ3RoIC0gMTtcbiAgICAgICAgdmFyIGIgPSAwO1xuICAgICAgICB2YXIgYSA9IGF2Z1tiXSArIGF2Z1tiICsgMV07XG4gICAgICAgIGlmIChhID4gMC4wKSB7XG4gICAgICAgICAgICB2YXIgbSA9IG1heFtiXTtcbiAgICAgICAgICAgIGlmIChtIDwgbWF4W2IgKyAxXSlcbiAgICAgICAgICAgICAgICBtID0gbWF4W2IgKyAxXTtcbiAgICAgICAgICAgIGEgPSAyMC4wICogKG0gKiAyLjAgLSBhKVxuICAgICAgICAgICAgICAgIC8gKGEgKiAoZ2ZjLm51bWxpbmVzX2xbYl0gKyBnZmMubnVtbGluZXNfbFtiICsgMV0gLSAxKSk7XG4gICAgICAgICAgICB2YXIgayA9IDAgfCBhO1xuICAgICAgICAgICAgaWYgKGsgPiBsYXN0X3RhYl9lbnRyeSlcbiAgICAgICAgICAgICAgICBrID0gbGFzdF90YWJfZW50cnk7XG4gICAgICAgICAgICBtYXNrX2lkeFtiXSA9IGs7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtYXNrX2lkeFtiXSA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGIgPSAxOyBiIDwgZ2ZjLm5wYXJ0X2wgLSAxOyBiKyspIHtcbiAgICAgICAgICAgIGEgPSBhdmdbYiAtIDFdICsgYXZnW2JdICsgYXZnW2IgKyAxXTtcbiAgICAgICAgICAgIGlmIChhID4gMC4wKSB7XG4gICAgICAgICAgICAgICAgdmFyIG0gPSBtYXhbYiAtIDFdO1xuICAgICAgICAgICAgICAgIGlmIChtIDwgbWF4W2JdKVxuICAgICAgICAgICAgICAgICAgICBtID0gbWF4W2JdO1xuICAgICAgICAgICAgICAgIGlmIChtIDwgbWF4W2IgKyAxXSlcbiAgICAgICAgICAgICAgICAgICAgbSA9IG1heFtiICsgMV07XG4gICAgICAgICAgICAgICAgYSA9IDIwLjBcbiAgICAgICAgICAgICAgICAgICAgKiAobSAqIDMuMCAtIGEpXG4gICAgICAgICAgICAgICAgICAgIC8gKGEgKiAoZ2ZjLm51bWxpbmVzX2xbYiAtIDFdICsgZ2ZjLm51bWxpbmVzX2xbYl1cbiAgICAgICAgICAgICAgICAgICAgKyBnZmMubnVtbGluZXNfbFtiICsgMV0gLSAxKSk7XG4gICAgICAgICAgICAgICAgdmFyIGsgPSAwIHwgYTtcbiAgICAgICAgICAgICAgICBpZiAoayA+IGxhc3RfdGFiX2VudHJ5KVxuICAgICAgICAgICAgICAgICAgICBrID0gbGFzdF90YWJfZW50cnk7XG4gICAgICAgICAgICAgICAgbWFza19pZHhbYl0gPSBrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtYXNrX2lkeFtiXSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBhID0gYXZnW2IgLSAxXSArIGF2Z1tiXTtcbiAgICAgICAgaWYgKGEgPiAwLjApIHtcbiAgICAgICAgICAgIHZhciBtID0gbWF4W2IgLSAxXTtcbiAgICAgICAgICAgIGlmIChtIDwgbWF4W2JdKVxuICAgICAgICAgICAgICAgIG0gPSBtYXhbYl07XG4gICAgICAgICAgICBhID0gMjAuMCAqIChtICogMi4wIC0gYSlcbiAgICAgICAgICAgICAgICAvIChhICogKGdmYy5udW1saW5lc19sW2IgLSAxXSArIGdmYy5udW1saW5lc19sW2JdIC0gMSkpO1xuICAgICAgICAgICAgdmFyIGsgPSAwIHwgYTtcbiAgICAgICAgICAgIGlmIChrID4gbGFzdF90YWJfZW50cnkpXG4gICAgICAgICAgICAgICAgayA9IGxhc3RfdGFiX2VudHJ5O1xuICAgICAgICAgICAgbWFza19pZHhbYl0gPSBrO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbWFza19pZHhbYl0gPSAwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFyIGZpcmNvZWYgPSBbXG4gICAgICAgIC04LjY1MTYzZS0xOCAqIDIsIC0wLjAwODUxNTg2ICogMiwgLTYuNzQ3NjRlLTE4ICogMiwgMC4wMjA5MDM2ICogMixcbiAgICAgICAgLTMuMzY2MzllLTE3ICogMiwgLTAuMDQzODE2MiAqIDIsIC0xLjU0MTc1ZS0xNyAqIDIsIDAuMDkzMTczOCAqIDIsXG4gICAgICAgIC01LjUyMjEyZS0xNyAqIDIsIC0wLjMxMzgxOSAqIDJcbiAgICBdO1xuXG4gICAgdGhpcy5MM3BzeWNob19hbmFsX25zID0gZnVuY3Rpb24gKGdmcCwgYnVmZmVyLCBidWZQb3MsIGdyX291dCwgbWFza2luZ19yYXRpbywgbWFza2luZ19NU19yYXRpbywgcGVyY2VwX2VudHJvcHksIHBlcmNlcF9NU19lbnRyb3B5LCBlbmVyZ3ksIGJsb2NrdHlwZV9kKSB7XG4gICAgICAgIC8qXG4gICAgICAgICAqIHRvIGdldCBhIGdvb2QgY2FjaGUgcGVyZm9ybWFuY2UsIG9uZSBoYXMgdG8gdGhpbmsgYWJvdXQgdGhlIHNlcXVlbmNlLFxuICAgICAgICAgKiBpbiB3aGljaCB0aGUgdmFyaWFibGVzIGFyZSB1c2VkLlxuICAgICAgICAgKi9cbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblxuICAgICAgICAvKiBmZnQgYW5kIGVuZXJneSBjYWxjdWxhdGlvbiAqL1xuICAgICAgICB2YXIgd3NhbXBfTCA9IG5ld19mbG9hdF9uKFsyLCBFbmNvZGVyLkJMS1NJWkVdKTtcbiAgICAgICAgdmFyIHdzYW1wX1MgPSBuZXdfZmxvYXRfbihbMiwgMywgRW5jb2Rlci5CTEtTSVpFX3NdKTtcblxuICAgICAgICAvKiBjb252b2x1dGlvbiAqL1xuICAgICAgICB2YXIgZWJfbCA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyArIDEpO1xuICAgICAgICB2YXIgZWJfcyA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyArIDEpO1xuICAgICAgICB2YXIgdGhyID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTICsgMik7XG5cbiAgICAgICAgLyogYmxvY2sgdHlwZSAqL1xuICAgICAgICB2YXIgYmxvY2t0eXBlID0gbmV3X2ludCgyKSwgdXNlbG9uZ2Jsb2NrID0gbmV3X2ludCgyKTtcblxuICAgICAgICAvKiB1c3VhbCB2YXJpYWJsZXMgbGlrZSBsb29wIGluZGljZXMsIGV0Yy4uICovXG4gICAgICAgIHZhciBudW1jaG4sIGNobjtcbiAgICAgICAgdmFyIGIsIGksIGosIGs7XG4gICAgICAgIHZhciBzYiwgc2Jsb2NrO1xuXG4gICAgICAgIC8qIHZhcmlhYmxlcyB1c2VkIGZvciAtLW5zcHN5dHVuZSAqL1xuICAgICAgICB2YXIgbnNfaHBmc21wbCA9IG5ld19mbG9hdF9uKFsyLCA1NzZdKTtcbiAgICAgICAgdmFyIHBjZmFjdDtcbiAgICAgICAgdmFyIG1hc2tfaWR4X2wgPSBuZXdfaW50KEVuY29kZXIuQ0JBTkRTICsgMiksIG1hc2tfaWR4X3MgPSBuZXdfaW50KEVuY29kZXIuQ0JBTkRTICsgMik7XG5cbiAgICAgICAgQXJyYXlzLmZpbGwobWFza19pZHhfcywgMCk7XG5cbiAgICAgICAgbnVtY2huID0gZ2ZjLmNoYW5uZWxzX291dDtcbiAgICAgICAgLyogY2huPTIgYW5kIDMgPSBNaWQgYW5kIFNpZGUgY2hhbm5lbHMgKi9cbiAgICAgICAgaWYgKGdmcC5tb2RlID09IE1QRUdNb2RlLkpPSU5UX1NURVJFTylcbiAgICAgICAgICAgIG51bWNobiA9IDQ7XG5cbiAgICAgICAgaWYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfb2ZmKVxuICAgICAgICAgICAgcGNmYWN0ID0gZ2ZjLlJlc3ZNYXggPT0gMCA/IDAgOiAoIGdmYy5SZXN2U2l6ZSlcbiAgICAgICAgICAgIC8gZ2ZjLlJlc3ZNYXggKiAwLjU7XG4gICAgICAgIGVsc2UgaWYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfcmggfHwgZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9tdHJoXG4gICAgICAgICAgICB8fCBnZnAuVkJSID09IFZick1vZGUudmJyX210KSB7XG4gICAgICAgICAgICBwY2ZhY3QgPSAwLjY7XG4gICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgcGNmYWN0ID0gMS4wO1xuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIEFwcGx5IEhQRiBvZiBmcy80IHRvIHRoZSBpbnB1dCBzaWduYWwuIFRoaXMgaXMgdXNlZCBmb3IgYXR0YWNrXG4gICAgICAgICAqIGRldGVjdGlvbiAvIGhhbmRsaW5nLlxuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgLyogRG9uJ3QgY29weSB0aGUgaW5wdXQgYnVmZmVyIGludG8gYSB0ZW1wb3JhcnkgYnVmZmVyICovXG4gICAgICAgIC8qIHVucm9sbCB0aGUgbG9vcCAyIHRpbWVzICovXG4gICAgICAgIGZvciAoY2huID0gMDsgY2huIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2huKyspIHtcbiAgICAgICAgICAgIC8qIGFwcGx5IGhpZ2ggcGFzcyBmaWx0ZXIgb2YgZnMvNCAqL1xuICAgICAgICAgICAgdmFyIGZpcmJ1ZiA9IGJ1ZmZlcltjaG5dO1xuICAgICAgICAgICAgdmFyIGZpcmJ1ZlBvcyA9IGJ1ZlBvcyArIDU3NiAtIDM1MCAtIE5TRklSTEVOICsgMTkyO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDU3NjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN1bTEsIHN1bTI7XG4gICAgICAgICAgICAgICAgc3VtMSA9IGZpcmJ1ZltmaXJidWZQb3MgKyBpICsgMTBdO1xuICAgICAgICAgICAgICAgIHN1bTIgPSAwLjA7XG4gICAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8ICgoTlNGSVJMRU4gLSAxKSAvIDIpIC0gMTsgaiArPSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1bTEgKz0gZmlyY29lZltqXVxuICAgICAgICAgICAgICAgICAgICAgICAgKiAoZmlyYnVmW2ZpcmJ1ZlBvcyArIGkgKyBqXSArIGZpcmJ1ZltmaXJidWZQb3MgKyBpXG4gICAgICAgICAgICAgICAgICAgICAgICArIE5TRklSTEVOIC0gal0pO1xuICAgICAgICAgICAgICAgICAgICBzdW0yICs9IGZpcmNvZWZbaiArIDFdXG4gICAgICAgICAgICAgICAgICAgICAgICAqIChmaXJidWZbZmlyYnVmUG9zICsgaSArIGogKyAxXSArIGZpcmJ1ZltmaXJidWZQb3NcbiAgICAgICAgICAgICAgICAgICAgICAgICsgaSArIE5TRklSTEVOIC0gaiAtIDFdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbnNfaHBmc21wbFtjaG5dW2ldID0gc3VtMSArIHN1bTI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtYXNraW5nX3JhdGlvW2dyX291dF1bY2huXS5lbi5hc3NpZ24oZ2ZjLmVuW2Nobl0pO1xuICAgICAgICAgICAgbWFza2luZ19yYXRpb1tncl9vdXRdW2Nobl0udGhtLmFzc2lnbihnZmMudGhtW2Nobl0pO1xuICAgICAgICAgICAgaWYgKG51bWNobiA+IDIpIHtcbiAgICAgICAgICAgICAgICAvKiBNUyBtYXNraW5ncyAqL1xuICAgICAgICAgICAgICAgIC8qIHBlcmNlcF9NU19lbnRyb3B5IFtjaG4tMl0gPSBnZmMgLiBwZSBbY2huXTsgKi9cbiAgICAgICAgICAgICAgICBtYXNraW5nX01TX3JhdGlvW2dyX291dF1bY2huXS5lbi5hc3NpZ24oZ2ZjLmVuW2NobiArIDJdKTtcbiAgICAgICAgICAgICAgICBtYXNraW5nX01TX3JhdGlvW2dyX291dF1bY2huXS50aG0uYXNzaWduKGdmYy50aG1bY2huICsgMl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChjaG4gPSAwOyBjaG4gPCBudW1jaG47IGNobisrKSB7XG4gICAgICAgICAgICB2YXIgd3NhbXBfbDtcbiAgICAgICAgICAgIHZhciB3c2FtcF9zO1xuICAgICAgICAgICAgdmFyIGVuX3N1YnNob3J0ID0gbmV3X2Zsb2F0KDEyKTtcbiAgICAgICAgICAgIHZhciBlbl9zaG9ydCA9IFswLCAwLCAwLCAwXTtcbiAgICAgICAgICAgIHZhciBhdHRhY2tfaW50ZW5zaXR5ID0gbmV3X2Zsb2F0KDEyKTtcbiAgICAgICAgICAgIHZhciBuc191c2Vsb25nYmxvY2sgPSAxO1xuICAgICAgICAgICAgdmFyIGF0dGFja1RocmVzaG9sZDtcbiAgICAgICAgICAgIHZhciBtYXggPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMpLCBhdmcgPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMpO1xuICAgICAgICAgICAgdmFyIG5zX2F0dGFja3MgPSBbMCwgMCwgMCwgMF07XG4gICAgICAgICAgICB2YXIgZmZ0ZW5lcmd5ID0gbmV3X2Zsb2F0KEVuY29kZXIuSEJMS1NJWkUpO1xuICAgICAgICAgICAgdmFyIGZmdGVuZXJneV9zID0gbmV3X2Zsb2F0X24oWzMsIEVuY29kZXIuSEJMS1NJWkVfc10pO1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogcmggMjAwNDAzMDE6IHRoZSBmb2xsb3dpbmcgbG9vcHMgZG8gYWNjZXNzIG9uZSBvZmYgdGhlIGxpbWl0cyBzb1xuICAgICAgICAgICAgICogSSBpbmNyZWFzZSB0aGUgYXJyYXkgZGltZW5zaW9ucyBieSBvbmUgYW5kIGluaXRpYWxpemUgdGhlXG4gICAgICAgICAgICAgKiBhY2Nlc3NlZCB2YWx1ZXMgdG8gemVyb1xuICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICAgICAqIGRldGVybWluZSB0aGUgYmxvY2sgdHlwZSAod2luZG93IHR5cGUpXG4gICAgICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICAgICAgLyogY2FsY3VsYXRlIGVuZXJnaWVzIG9mIGVhY2ggc3ViLXNob3J0YmxvY2tzICovXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMzsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZW5fc3Vic2hvcnRbaV0gPSBnZmMubnNQc3kubGFzdF9lbl9zdWJzaG9ydFtjaG5dW2kgKyA2XTtcbiAgICAgICAgICAgICAgICBhdHRhY2tfaW50ZW5zaXR5W2ldID0gZW5fc3Vic2hvcnRbaV1cbiAgICAgICAgICAgICAgICAgICAgLyBnZmMubnNQc3kubGFzdF9lbl9zdWJzaG9ydFtjaG5dW2kgKyA0XTtcbiAgICAgICAgICAgICAgICBlbl9zaG9ydFswXSArPSBlbl9zdWJzaG9ydFtpXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNobiA9PSAyKSB7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDU3NjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsLCByO1xuICAgICAgICAgICAgICAgICAgICBsID0gbnNfaHBmc21wbFswXVtpXTtcbiAgICAgICAgICAgICAgICAgICAgciA9IG5zX2hwZnNtcGxbMV1baV07XG4gICAgICAgICAgICAgICAgICAgIG5zX2hwZnNtcGxbMF1baV0gPSBsICsgcjtcbiAgICAgICAgICAgICAgICAgICAgbnNfaHBmc21wbFsxXVtpXSA9IGwgLSByO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXIgcGYgPSBuc19ocGZzbXBsW2NobiAmIDFdO1xuICAgICAgICAgICAgICAgIHZhciBwZlBvcyA9IDA7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDk7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGZlID0gcGZQb3MgKyA1NzYgLyA5O1xuICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IDEuO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKDsgcGZQb3MgPCBwZmU7IHBmUG9zKyspXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocCA8IE1hdGguYWJzKHBmW3BmUG9zXSkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcCA9IE1hdGguYWJzKHBmW3BmUG9zXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgZ2ZjLm5zUHN5Lmxhc3RfZW5fc3Vic2hvcnRbY2huXVtpXSA9IGVuX3N1YnNob3J0W2kgKyAzXSA9IHA7XG4gICAgICAgICAgICAgICAgICAgIGVuX3Nob3J0WzEgKyBpIC8gM10gKz0gcDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHAgPiBlbl9zdWJzaG9ydFtpICsgMyAtIDJdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwID0gcCAvIGVuX3N1YnNob3J0W2kgKyAzIC0gMl07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZW5fc3Vic2hvcnRbaSArIDMgLSAyXSA+IHAgKiAxMC4wKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwID0gZW5fc3Vic2hvcnRbaSArIDMgLSAyXSAvIChwICogMTAuMCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgcCA9IDAuMDtcbiAgICAgICAgICAgICAgICAgICAgYXR0YWNrX2ludGVuc2l0eVtpICsgM10gPSBwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGdmcC5hbmFseXNpcykge1xuICAgICAgICAgICAgICAgIHZhciB4ID0gYXR0YWNrX2ludGVuc2l0eVswXTtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAxOyBpIDwgMTI7IGkrKylcbiAgICAgICAgICAgICAgICAgICAgaWYgKHggPCBhdHRhY2tfaW50ZW5zaXR5W2ldKVxuICAgICAgICAgICAgICAgICAgICAgICAgeCA9IGF0dGFja19pbnRlbnNpdHlbaV07XG4gICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLmVyc1tncl9vdXRdW2Nobl0gPSBnZmMucGluZm8uZXJzX3NhdmVbY2huXTtcbiAgICAgICAgICAgICAgICBnZmMucGluZm8uZXJzX3NhdmVbY2huXSA9IHg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qIGNvbXBhcmUgZW5lcmdpZXMgYmV0d2VlbiBzdWItc2hvcnRibG9ja3MgKi9cbiAgICAgICAgICAgIGF0dGFja1RocmVzaG9sZCA9IChjaG4gPT0gMykgPyBnZmMubnNQc3kuYXR0YWNrdGhyZV9zXG4gICAgICAgICAgICAgICAgOiBnZmMubnNQc3kuYXR0YWNrdGhyZTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCAxMjsgaSsrKVxuICAgICAgICAgICAgICAgIGlmICgwID09IG5zX2F0dGFja3NbaSAvIDNdXG4gICAgICAgICAgICAgICAgICAgICYmIGF0dGFja19pbnRlbnNpdHlbaV0gPiBhdHRhY2tUaHJlc2hvbGQpXG4gICAgICAgICAgICAgICAgICAgIG5zX2F0dGFja3NbaSAvIDNdID0gKGkgJSAzKSArIDE7XG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBzaG91bGQgaGF2ZSBlbmVyZ3kgY2hhbmdlIGJldHdlZW4gc2hvcnQgYmxvY2tzLCBpbiBvcmRlciB0byBhdm9pZFxuICAgICAgICAgICAgICogcGVyaW9kaWMgc2lnbmFsc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmb3IgKGkgPSAxOyBpIDwgNDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJhdGlvO1xuICAgICAgICAgICAgICAgIGlmIChlbl9zaG9ydFtpIC0gMV0gPiBlbl9zaG9ydFtpXSkge1xuICAgICAgICAgICAgICAgICAgICByYXRpbyA9IGVuX3Nob3J0W2kgLSAxXSAvIGVuX3Nob3J0W2ldO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJhdGlvID0gZW5fc2hvcnRbaV0gLyBlbl9zaG9ydFtpIC0gMV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyYXRpbyA8IDEuNykge1xuICAgICAgICAgICAgICAgICAgICBuc19hdHRhY2tzW2ldID0gMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT0gMSlcbiAgICAgICAgICAgICAgICAgICAgICAgIG5zX2F0dGFja3NbMF0gPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG5zX2F0dGFja3NbMF0gIT0gMCAmJiBnZmMubnNQc3kubGFzdEF0dGFja3NbY2huXSAhPSAwKVxuICAgICAgICAgICAgICAgIG5zX2F0dGFja3NbMF0gPSAwO1xuXG4gICAgICAgICAgICBpZiAoZ2ZjLm5zUHN5Lmxhc3RBdHRhY2tzW2Nobl0gPT0gM1xuICAgICAgICAgICAgICAgIHx8IChuc19hdHRhY2tzWzBdICsgbnNfYXR0YWNrc1sxXSArIG5zX2F0dGFja3NbMl0gKyBuc19hdHRhY2tzWzNdKSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgbnNfdXNlbG9uZ2Jsb2NrID0gMDtcblxuICAgICAgICAgICAgICAgIGlmIChuc19hdHRhY2tzWzFdICE9IDAgJiYgbnNfYXR0YWNrc1swXSAhPSAwKVxuICAgICAgICAgICAgICAgICAgICBuc19hdHRhY2tzWzFdID0gMDtcbiAgICAgICAgICAgICAgICBpZiAobnNfYXR0YWNrc1syXSAhPSAwICYmIG5zX2F0dGFja3NbMV0gIT0gMClcbiAgICAgICAgICAgICAgICAgICAgbnNfYXR0YWNrc1syXSA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKG5zX2F0dGFja3NbM10gIT0gMCAmJiBuc19hdHRhY2tzWzJdICE9IDApXG4gICAgICAgICAgICAgICAgICAgIG5zX2F0dGFja3NbM10gPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY2huIDwgMikge1xuICAgICAgICAgICAgICAgIHVzZWxvbmdibG9ja1tjaG5dID0gbnNfdXNlbG9uZ2Jsb2NrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAobnNfdXNlbG9uZ2Jsb2NrID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdXNlbG9uZ2Jsb2NrWzBdID0gdXNlbG9uZ2Jsb2NrWzFdID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiB0aGVyZSBpcyBhIG9uZSBncmFudWxlIGRlbGF5LiBDb3B5IG1hc2tpbmdzIGNvbXB1dGVkIGxhc3QgY2FsbFxuICAgICAgICAgICAgICogaW50byBtYXNraW5nX3JhdGlvIHRvIHJldHVybiB0byBjYWxsaW5nIHByb2dyYW0uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGVuZXJneVtjaG5dID0gZ2ZjLnRvdF9lbmVyW2Nobl07XG5cbiAgICAgICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICAgICAqIGNvbXB1dGUgRkZUc1xuICAgICAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgICAgIHdzYW1wX3MgPSB3c2FtcF9TO1xuICAgICAgICAgICAgd3NhbXBfbCA9IHdzYW1wX0w7XG4gICAgICAgICAgICBjb21wdXRlX2ZmdHMoZ2ZwLCBmZnRlbmVyZ3ksIGZmdGVuZXJneV9zLCB3c2FtcF9sLCAoY2huICYgMSksXG4gICAgICAgICAgICAgICAgd3NhbXBfcywgKGNobiAmIDEpLCBncl9vdXQsIGNobiwgYnVmZmVyLCBidWZQb3MpO1xuXG4gICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAgICAgKiBDYWxjdWxhdGUgdGhlIGVuZXJneSBhbmQgdGhlIHRvbmFsaXR5IG9mIGVhY2ggcGFydGl0aW9uLlxuICAgICAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgICAgIGNhbGNfZW5lcmd5KGdmYywgZmZ0ZW5lcmd5LCBlYl9sLCBtYXgsIGF2Zyk7XG4gICAgICAgICAgICBjYWxjX21hc2tfaW5kZXhfbChnZmMsIG1heCwgYXZnLCBtYXNrX2lkeF9sKTtcbiAgICAgICAgICAgIC8qIGNvbXB1dGUgbWFza2luZyB0aHJlc2hvbGRzIGZvciBzaG9ydCBibG9ja3MgKi9cbiAgICAgICAgICAgIGZvciAoc2Jsb2NrID0gMDsgc2Jsb2NrIDwgMzsgc2Jsb2NrKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZW5uLCB0aG1tO1xuICAgICAgICAgICAgICAgIGNvbXB1dGVfbWFza2luZ19zKGdmcCwgZmZ0ZW5lcmd5X3MsIGViX3MsIHRociwgY2huLCBzYmxvY2spO1xuICAgICAgICAgICAgICAgIGNvbnZlcnRfcGFydGl0aW9uMnNjYWxlZmFjX3MoZ2ZjLCBlYl9zLCB0aHIsIGNobiwgc2Jsb2NrKTtcbiAgICAgICAgICAgICAgICAvKioqKiBzaG9ydCBibG9jayBwcmUtZWNobyBjb250cm9sICoqKiovXG4gICAgICAgICAgICAgICAgZm9yIChzYiA9IDA7IHNiIDwgRW5jb2Rlci5TQk1BWF9zOyBzYisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRobW0gPSBnZmMudGhtW2Nobl0uc1tzYl1bc2Jsb2NrXTtcblxuICAgICAgICAgICAgICAgICAgICB0aG1tICo9IE5TX1BSRUVDSE9fQVRUMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5zX2F0dGFja3Nbc2Jsb2NrXSA+PSAyIHx8IG5zX2F0dGFja3Nbc2Jsb2NrICsgMV0gPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IChzYmxvY2sgIT0gMCkgPyBzYmxvY2sgLSAxIDogMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwID0gTlNfSU5URVJQKGdmYy50aG1bY2huXS5zW3NiXVtpZHhdLCB0aG1tLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5TX1BSRUVDSE9fQVRUMSAqIHBjZmFjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aG1tID0gTWF0aC5taW4odGhtbSwgcCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAobnNfYXR0YWNrc1tzYmxvY2tdID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSAoc2Jsb2NrICE9IDApID8gc2Jsb2NrIC0gMSA6IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IE5TX0lOVEVSUChnZmMudGhtW2Nobl0uc1tzYl1baWR4XSwgdGhtbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBOU19QUkVFQ0hPX0FUVDIgKiBwY2ZhY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhtbSA9IE1hdGgubWluKHRobW0sIHApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKChzYmxvY2sgIT0gMCAmJiBuc19hdHRhY2tzW3NibG9jayAtIDFdID09IDMpXG4gICAgICAgICAgICAgICAgICAgICAgICB8fCAoc2Jsb2NrID09IDAgJiYgZ2ZjLm5zUHN5Lmxhc3RBdHRhY2tzW2Nobl0gPT0gMykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSAoc2Jsb2NrICE9IDIpID8gc2Jsb2NrICsgMSA6IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IE5TX0lOVEVSUChnZmMudGhtW2Nobl0uc1tzYl1baWR4XSwgdGhtbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBOU19QUkVFQ0hPX0FUVDIgKiBwY2ZhY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhtbSA9IE1hdGgubWluKHRobW0sIHApO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLyogcHVsc2UgbGlrZSBzaWduYWwgZGV0ZWN0aW9uIGZvciBmYXRib3kud2F2IGFuZCBzbyBvbiAqL1xuICAgICAgICAgICAgICAgICAgICBlbm4gPSBlbl9zdWJzaG9ydFtzYmxvY2sgKiAzICsgM11cbiAgICAgICAgICAgICAgICAgICAgICAgICsgZW5fc3Vic2hvcnRbc2Jsb2NrICogMyArIDRdXG4gICAgICAgICAgICAgICAgICAgICAgICArIGVuX3N1YnNob3J0W3NibG9jayAqIDMgKyA1XTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVuX3N1YnNob3J0W3NibG9jayAqIDMgKyA1XSAqIDYgPCBlbm4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRobW0gKj0gMC41O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuX3N1YnNob3J0W3NibG9jayAqIDMgKyA0XSAqIDYgPCBlbm4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhtbSAqPSAwLjU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBnZmMudGhtW2Nobl0uc1tzYl1bc2Jsb2NrXSA9IHRobW07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLm5zUHN5Lmxhc3RBdHRhY2tzW2Nobl0gPSBuc19hdHRhY2tzWzJdO1xuXG4gICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAgICAgKiBjb252b2x2ZSB0aGUgcGFydGl0aW9uZWQgZW5lcmd5IGFuZCB1bnByZWRpY3RhYmlsaXR5IHdpdGggdGhlXG4gICAgICAgICAgICAgKiBzcHJlYWRpbmcgZnVuY3Rpb24sIHMzX2xbYl1ba11cbiAgICAgICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgICAgIGsgPSAwO1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGZvciAoYiA9IDA7IGIgPCBnZmMubnBhcnRfbDsgYisrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAqIGNvbnZvbHZlIHRoZSBwYXJ0aXRpb25lZCBlbmVyZ3kgd2l0aCB0aGUgc3ByZWFkaW5nXG4gICAgICAgICAgICAgICAgICAgICAqIGZ1bmN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICB2YXIga2sgPSBnZmMuczNpbmRbYl1bMF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBlYjIgPSBlYl9sW2trXSAqIHRhYlttYXNrX2lkeF9sW2trXV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBlY2IgPSBnZmMuczNfbGxbaysrXSAqIGViMjtcbiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKCsra2sgPD0gZ2ZjLnMzaW5kW2JdWzFdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlYjIgPSBlYl9sW2trXSAqIHRhYlttYXNrX2lkeF9sW2trXV07XG4gICAgICAgICAgICAgICAgICAgICAgICBlY2IgPSBtYXNrX2FkZChlY2IsIGdmYy5zM19sbFtrKytdICogZWIyLCBraywga2sgLSBiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdmYywgMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWNiICo9IDAuMTU4NDg5MzE5MjQ2MTExO1xuICAgICAgICAgICAgICAgICAgICAvKiBwb3coMTAsLTAuOCkgKi9cblxuICAgICAgICAgICAgICAgICAgICAvKioqKiBsb25nIGJsb2NrIHByZS1lY2hvIGNvbnRyb2wgKioqKi9cbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqIDxQUkU+XG4gICAgICAgICAgICAgICAgICAgICAqIGRvbnQgdXNlIGxvbmcgYmxvY2sgcHJlLWVjaG8gY29udHJvbCBpZiBwcmV2aW91cyBncmFudWxlIHdhc1xuICAgICAgICAgICAgICAgICAgICAgKiBhIHNob3J0IGJsb2NrLiAgVGhpcyBpcyB0byBhdm9pZCB0aGUgc2l0dWF0aW9uOlxuICAgICAgICAgICAgICAgICAgICAgKiBmcmFtZTA6ICBxdWlldCAodmVyeSBsb3cgbWFza2luZylcbiAgICAgICAgICAgICAgICAgICAgICogZnJhbWUxOiAgc3VyZ2UgICh0cmlnZ2VycyBzaG9ydCBibG9ja3MpXG4gICAgICAgICAgICAgICAgICAgICAqIGZyYW1lMjogIHJlZ3VsYXIgZnJhbWUuICBsb29rcyBsaWtlIHByZS1lY2hvIHdoZW4gY29tcGFyZWQgdG9cbiAgICAgICAgICAgICAgICAgICAgICogICAgICAgICAgZnJhbWUwLCBidXQgYWxsIHByZS1lY2hvIHdhcyBpbiBmcmFtZTEuXG4gICAgICAgICAgICAgICAgICAgICAqIDwvUFJFPlxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICogY2huPTAsMSBMIGFuZCBSIGNoYW5uZWxzXG4gICAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgICAqIGNobj0yLDMgUyBhbmQgTSBjaGFubmVscy5cbiAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGdmYy5ibG9ja3R5cGVfb2xkW2NobiAmIDFdID09IEVuY29kZXIuU0hPUlRfVFlQRSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocltiXSA9IGVjYjtcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyW2JdID0gTlNfSU5URVJQKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWluKGVjYiwgTWF0aC5taW4ocnBlbGV2XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZ2ZjLm5iXzFbY2huXVtiXSwgcnBlbGV2MlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGdmYy5uYl8yW2Nobl1bYl0pKSwgZWNiLCBwY2ZhY3QpO1xuXG4gICAgICAgICAgICAgICAgICAgIGdmYy5uYl8yW2Nobl1bYl0gPSBnZmMubmJfMVtjaG5dW2JdO1xuICAgICAgICAgICAgICAgICAgICBnZmMubmJfMVtjaG5dW2JdID0gZWNiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoOyBiIDw9IEVuY29kZXIuQ0JBTkRTOyArK2IpIHtcbiAgICAgICAgICAgICAgICBlYl9sW2JdID0gMDtcbiAgICAgICAgICAgICAgICB0aHJbYl0gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogY29tcHV0ZSBtYXNraW5nIHRocmVzaG9sZHMgZm9yIGxvbmcgYmxvY2tzICovXG4gICAgICAgICAgICBjb252ZXJ0X3BhcnRpdGlvbjJzY2FsZWZhY19sKGdmYywgZWJfbCwgdGhyLCBjaG4pO1xuICAgICAgICB9XG4gICAgICAgIC8qIGVuZCBsb29wIG92ZXIgY2huICovXG5cbiAgICAgICAgaWYgKGdmcC5tb2RlID09IE1QRUdNb2RlLlNURVJFTyB8fCBnZnAubW9kZSA9PSBNUEVHTW9kZS5KT0lOVF9TVEVSRU8pIHtcbiAgICAgICAgICAgIGlmIChnZnAuaW50ZXJDaFJhdGlvID4gMC4wKSB7XG4gICAgICAgICAgICAgICAgY2FsY19pbnRlcmNoYW5uZWxfbWFza2luZyhnZnAsIGdmcC5pbnRlckNoUmF0aW8pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGdmcC5tb2RlID09IE1QRUdNb2RlLkpPSU5UX1NURVJFTykge1xuICAgICAgICAgICAgdmFyIG1zZml4O1xuICAgICAgICAgICAgbXNmaXgxKGdmYyk7XG4gICAgICAgICAgICBtc2ZpeCA9IGdmcC5tc2ZpeDtcbiAgICAgICAgICAgIGlmIChNYXRoLmFicyhtc2ZpeCkgPiAwLjApXG4gICAgICAgICAgICAgICAgbnNfbXNmaXgoZ2ZjLCBtc2ZpeCwgZ2ZwLkFUSGxvd2VyICogZ2ZjLkFUSC5hZGp1c3QpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBkZXRlcm1pbmUgZmluYWwgYmxvY2sgdHlwZVxuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICBibG9ja190eXBlX3NldChnZnAsIHVzZWxvbmdibG9jaywgYmxvY2t0eXBlX2QsIGJsb2NrdHlwZSk7XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBjb21wdXRlIHRoZSB2YWx1ZSBvZiBQRSB0byByZXR1cm4gLi4uIG5vIGRlbGF5IGFuZCBhZHZhbmNlXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIGZvciAoY2huID0gMDsgY2huIDwgbnVtY2huOyBjaG4rKykge1xuICAgICAgICAgICAgdmFyIHBwZTtcbiAgICAgICAgICAgIHZhciBwcGVQb3MgPSAwO1xuICAgICAgICAgICAgdmFyIHR5cGU7XG4gICAgICAgICAgICB2YXIgbXI7XG5cbiAgICAgICAgICAgIGlmIChjaG4gPiAxKSB7XG4gICAgICAgICAgICAgICAgcHBlID0gcGVyY2VwX01TX2VudHJvcHk7XG4gICAgICAgICAgICAgICAgcHBlUG9zID0gLTI7XG4gICAgICAgICAgICAgICAgdHlwZSA9IEVuY29kZXIuTk9STV9UWVBFO1xuICAgICAgICAgICAgICAgIGlmIChibG9ja3R5cGVfZFswXSA9PSBFbmNvZGVyLlNIT1JUX1RZUEVcbiAgICAgICAgICAgICAgICAgICAgfHwgYmxvY2t0eXBlX2RbMV0gPT0gRW5jb2Rlci5TSE9SVF9UWVBFKVxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gRW5jb2Rlci5TSE9SVF9UWVBFO1xuICAgICAgICAgICAgICAgIG1yID0gbWFza2luZ19NU19yYXRpb1tncl9vdXRdW2NobiAtIDJdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcGUgPSBwZXJjZXBfZW50cm9weTtcbiAgICAgICAgICAgICAgICBwcGVQb3MgPSAwO1xuICAgICAgICAgICAgICAgIHR5cGUgPSBibG9ja3R5cGVfZFtjaG5dO1xuICAgICAgICAgICAgICAgIG1yID0gbWFza2luZ19yYXRpb1tncl9vdXRdW2Nobl07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRSlcbiAgICAgICAgICAgICAgICBwcGVbcHBlUG9zICsgY2huXSA9IHBlY2FsY19zKG1yLCBnZmMubWFza2luZ19sb3dlcik7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgcHBlW3BwZVBvcyArIGNobl0gPSBwZWNhbGNfbChtciwgZ2ZjLm1hc2tpbmdfbG93ZXIpO1xuXG4gICAgICAgICAgICBpZiAoZ2ZwLmFuYWx5c2lzKVxuICAgICAgICAgICAgICAgIGdmYy5waW5mby5wZVtncl9vdXRdW2Nobl0gPSBwcGVbcHBlUG9zICsgY2huXTtcblxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHZicnBzeV9jb21wdXRlX2ZmdF9sKGdmcCwgYnVmZmVyLCBidWZQb3MsIGNobiwgZ3Jfb3V0LCBmZnRlbmVyZ3ksIHdzYW1wX2wsIHdzYW1wX2xQb3MpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgaWYgKGNobiA8IDIpIHtcbiAgICAgICAgICAgIGZmdC5mZnRfbG9uZyhnZmMsIHdzYW1wX2xbd3NhbXBfbFBvc10sIGNobiwgYnVmZmVyLCBidWZQb3MpO1xuICAgICAgICB9IGVsc2UgaWYgKGNobiA9PSAyKSB7XG4gICAgICAgICAgICAvKiBGRlQgZGF0YSBmb3IgbWlkIGFuZCBzaWRlIGNoYW5uZWwgaXMgZGVyaXZlZCBmcm9tIEwgJiBSICovXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gRW5jb2Rlci5CTEtTSVpFIC0gMTsgaiA+PSAwOyAtLWopIHtcbiAgICAgICAgICAgICAgICB2YXIgbCA9IHdzYW1wX2xbd3NhbXBfbFBvcyArIDBdW2pdO1xuICAgICAgICAgICAgICAgIHZhciByID0gd3NhbXBfbFt3c2FtcF9sUG9zICsgMV1bal07XG4gICAgICAgICAgICAgICAgd3NhbXBfbFt3c2FtcF9sUG9zICsgMF1bal0gPSAobCArIHIpICogVXRpbC5TUVJUMiAqIDAuNTtcbiAgICAgICAgICAgICAgICB3c2FtcF9sW3dzYW1wX2xQb3MgKyAxXVtqXSA9IChsIC0gcikgKiBVdGlsLlNRUlQyICogMC41O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBjb21wdXRlIGVuZXJnaWVzXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIGZmdGVuZXJneVswXSA9IE5PTl9MSU5FQVJfU0NBTEVfRU5FUkdZKHdzYW1wX2xbd3NhbXBfbFBvcyArIDBdWzBdKTtcbiAgICAgICAgZmZ0ZW5lcmd5WzBdICo9IGZmdGVuZXJneVswXTtcblxuICAgICAgICBmb3IgKHZhciBqID0gRW5jb2Rlci5CTEtTSVpFIC8gMiAtIDE7IGogPj0gMDsgLS1qKSB7XG4gICAgICAgICAgICB2YXIgcmUgPSB3c2FtcF9sW3dzYW1wX2xQb3MgKyAwXVtFbmNvZGVyLkJMS1NJWkUgLyAyIC0gal07XG4gICAgICAgICAgICB2YXIgaW0gPSB3c2FtcF9sW3dzYW1wX2xQb3MgKyAwXVtFbmNvZGVyLkJMS1NJWkUgLyAyICsgal07XG4gICAgICAgICAgICBmZnRlbmVyZ3lbRW5jb2Rlci5CTEtTSVpFIC8gMiAtIGpdID0gTk9OX0xJTkVBUl9TQ0FMRV9FTkVSR1koKHJlXG4gICAgICAgICAgICAgICAgKiByZSArIGltICogaW0pICogMC41KTtcbiAgICAgICAgfVxuICAgICAgICAvKiB0b3RhbCBlbmVyZ3kgKi9cbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIHRvdGFsZW5lcmd5ID0gMC4wO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDExOyBqIDwgRW5jb2Rlci5IQkxLU0laRTsgaisrKVxuICAgICAgICAgICAgICAgIHRvdGFsZW5lcmd5ICs9IGZmdGVuZXJneVtqXTtcblxuICAgICAgICAgICAgZ2ZjLnRvdF9lbmVyW2Nobl0gPSB0b3RhbGVuZXJneTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChnZnAuYW5hbHlzaXMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgRW5jb2Rlci5IQkxLU0laRTsgaisrKSB7XG4gICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLmVuZXJneVtncl9vdXRdW2Nobl1bal0gPSBnZmMucGluZm8uZW5lcmd5X3NhdmVbY2huXVtqXTtcbiAgICAgICAgICAgICAgICBnZmMucGluZm8uZW5lcmd5X3NhdmVbY2huXVtqXSA9IGZmdGVuZXJneVtqXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy5waW5mby5wZVtncl9vdXRdW2Nobl0gPSBnZmMucGVbY2huXTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHZicnBzeV9jb21wdXRlX2ZmdF9zKGdmcCwgYnVmZmVyLCBidWZQb3MsIGNobiwgc2Jsb2NrLCBmZnRlbmVyZ3lfcywgd3NhbXBfcywgd3NhbXBfc1Bvcykge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXG4gICAgICAgIGlmIChzYmxvY2sgPT0gMCAmJiBjaG4gPCAyKSB7XG4gICAgICAgICAgICBmZnQuZmZ0X3Nob3J0KGdmYywgd3NhbXBfc1t3c2FtcF9zUG9zXSwgY2huLCBidWZmZXIsIGJ1ZlBvcyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNobiA9PSAyKSB7XG4gICAgICAgICAgICAvKiBGRlQgZGF0YSBmb3IgbWlkIGFuZCBzaWRlIGNoYW5uZWwgaXMgZGVyaXZlZCBmcm9tIEwgJiBSICovXG4gICAgICAgICAgICBmb3IgKHZhciBqID0gRW5jb2Rlci5CTEtTSVpFX3MgLSAxOyBqID49IDA7IC0taikge1xuICAgICAgICAgICAgICAgIHZhciBsID0gd3NhbXBfc1t3c2FtcF9zUG9zICsgMF1bc2Jsb2NrXVtqXTtcbiAgICAgICAgICAgICAgICB2YXIgciA9IHdzYW1wX3Nbd3NhbXBfc1BvcyArIDFdW3NibG9ja11bal07XG4gICAgICAgICAgICAgICAgd3NhbXBfc1t3c2FtcF9zUG9zICsgMF1bc2Jsb2NrXVtqXSA9IChsICsgcikgKiBVdGlsLlNRUlQyICogMC41O1xuICAgICAgICAgICAgICAgIHdzYW1wX3Nbd3NhbXBfc1BvcyArIDFdW3NibG9ja11bal0gPSAobCAtIHIpICogVXRpbC5TUVJUMiAqIDAuNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogY29tcHV0ZSBlbmVyZ2llc1xuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICBmZnRlbmVyZ3lfc1tzYmxvY2tdWzBdID0gd3NhbXBfc1t3c2FtcF9zUG9zICsgMF1bc2Jsb2NrXVswXTtcbiAgICAgICAgZmZ0ZW5lcmd5X3Nbc2Jsb2NrXVswXSAqPSBmZnRlbmVyZ3lfc1tzYmxvY2tdWzBdO1xuICAgICAgICBmb3IgKHZhciBqID0gRW5jb2Rlci5CTEtTSVpFX3MgLyAyIC0gMTsgaiA+PSAwOyAtLWopIHtcbiAgICAgICAgICAgIHZhciByZSA9IHdzYW1wX3Nbd3NhbXBfc1BvcyArIDBdW3NibG9ja11bRW5jb2Rlci5CTEtTSVpFX3MgLyAyIC0gal07XG4gICAgICAgICAgICB2YXIgaW0gPSB3c2FtcF9zW3dzYW1wX3NQb3MgKyAwXVtzYmxvY2tdW0VuY29kZXIuQkxLU0laRV9zIC8gMiArIGpdO1xuICAgICAgICAgICAgZmZ0ZW5lcmd5X3Nbc2Jsb2NrXVtFbmNvZGVyLkJMS1NJWkVfcyAvIDIgLSBqXSA9IE5PTl9MSU5FQVJfU0NBTEVfRU5FUkdZKChyZVxuICAgICAgICAgICAgICAgICogcmUgKyBpbSAqIGltKSAqIDAuNSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjb21wdXRlIGxvdWRuZXNzIGFwcHJveGltYXRpb24gKHVzZWQgZm9yIEFUSCBhdXRvLWxldmVsIGFkanVzdG1lbnQpXG4gICAgICovXG4gICAgZnVuY3Rpb24gdmJycHN5X2NvbXB1dGVfbG91ZG5lc3NfYXBwcm94aW1hdGlvbl9sKGdmcCwgZ3Jfb3V0LCBjaG4sIGZmdGVuZXJneSkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICBpZiAoZ2ZwLmF0aGFhX2xvdWRhcHByb3ggPT0gMiAmJiBjaG4gPCAyKSB7XG4gICAgICAgICAgICAvLyBubyBsb3VkbmVzcyBmb3IgbWlkL3NpZGUgY2hcbiAgICAgICAgICAgIGdmYy5sb3VkbmVzc19zcVtncl9vdXRdW2Nobl0gPSBnZmMubG91ZG5lc3Nfc3Ffc2F2ZVtjaG5dO1xuICAgICAgICAgICAgZ2ZjLmxvdWRuZXNzX3NxX3NhdmVbY2huXSA9IHBzeWNob19sb3VkbmVzc19hcHByb3goZmZ0ZW5lcmd5LCBnZmMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFyIGZpcmNvZWZfID0gWy04LjY1MTYzZS0xOCAqIDIsXG4gICAgICAgIC0wLjAwODUxNTg2ICogMiwgLTYuNzQ3NjRlLTE4ICogMiwgMC4wMjA5MDM2ICogMixcbiAgICAgICAgLTMuMzY2MzllLTE3ICogMiwgLTAuMDQzODE2MiAqIDIsIC0xLjU0MTc1ZS0xNyAqIDIsXG4gICAgICAgIDAuMDkzMTczOCAqIDIsIC01LjUyMjEyZS0xNyAqIDIsIC0wLjMxMzgxOSAqIDJdO1xuXG4gICAgLyoqXG4gICAgICogQXBwbHkgSFBGIG9mIGZzLzQgdG8gdGhlIGlucHV0IHNpZ25hbC4gVGhpcyBpcyB1c2VkIGZvciBhdHRhY2sgZGV0ZWN0aW9uXG4gICAgICogLyBoYW5kbGluZy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB2YnJwc3lfYXR0YWNrX2RldGVjdGlvbihnZnAsIGJ1ZmZlciwgYnVmUG9zLCBncl9vdXQsIG1hc2tpbmdfcmF0aW8sIG1hc2tpbmdfTVNfcmF0aW8sIGVuZXJneSwgc3ViX3Nob3J0X2ZhY3RvciwgbnNfYXR0YWNrcywgdXNlbG9uZ2Jsb2NrKSB7XG4gICAgICAgIHZhciBuc19ocGZzbXBsID0gbmV3X2Zsb2F0X24oWzIsIDU3Nl0pO1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgbl9jaG5fb3V0ID0gZ2ZjLmNoYW5uZWxzX291dDtcbiAgICAgICAgLyogY2huPTIgYW5kIDMgPSBNaWQgYW5kIFNpZGUgY2hhbm5lbHMgKi9cbiAgICAgICAgdmFyIG5fY2huX3BzeSA9IChnZnAubW9kZSA9PSBNUEVHTW9kZS5KT0lOVF9TVEVSRU8pID8gNCA6IG5fY2huX291dDtcbiAgICAgICAgLyogRG9uJ3QgY29weSB0aGUgaW5wdXQgYnVmZmVyIGludG8gYSB0ZW1wb3JhcnkgYnVmZmVyICovXG4gICAgICAgIC8qIHVucm9sbCB0aGUgbG9vcCAyIHRpbWVzICovXG4gICAgICAgIGZvciAodmFyIGNobiA9IDA7IGNobiA8IG5fY2huX291dDsgY2huKyspIHtcbiAgICAgICAgICAgIC8qIGFwcGx5IGhpZ2ggcGFzcyBmaWx0ZXIgb2YgZnMvNCAqL1xuICAgICAgICAgICAgZmlyYnVmID0gYnVmZmVyW2Nobl07XG4gICAgICAgICAgICB2YXIgZmlyYnVmUG9zID0gYnVmUG9zICsgNTc2IC0gMzUwIC0gTlNGSVJMRU4gKyAxOTI7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU3NjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN1bTEsIHN1bTI7XG4gICAgICAgICAgICAgICAgc3VtMSA9IGZpcmJ1ZltmaXJidWZQb3MgKyBpICsgMTBdO1xuICAgICAgICAgICAgICAgIHN1bTIgPSAwLjA7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCAoKE5TRklSTEVOIC0gMSkgLyAyKSAtIDE7IGogKz0gMikge1xuICAgICAgICAgICAgICAgICAgICBzdW0xICs9IGZpcmNvZWZfW2pdXG4gICAgICAgICAgICAgICAgICAgICAgICAqIChmaXJidWZbZmlyYnVmUG9zICsgaSArIGpdICsgZmlyYnVmW2ZpcmJ1ZlBvcyArIGlcbiAgICAgICAgICAgICAgICAgICAgICAgICsgTlNGSVJMRU4gLSBqXSk7XG4gICAgICAgICAgICAgICAgICAgIHN1bTIgKz0gZmlyY29lZl9baiArIDFdXG4gICAgICAgICAgICAgICAgICAgICAgICAqIChmaXJidWZbZmlyYnVmUG9zICsgaSArIGogKyAxXSArIGZpcmJ1ZltmaXJidWZQb3NcbiAgICAgICAgICAgICAgICAgICAgICAgICsgaSArIE5TRklSTEVOIC0gaiAtIDFdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbnNfaHBmc21wbFtjaG5dW2ldID0gc3VtMSArIHN1bTI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtYXNraW5nX3JhdGlvW2dyX291dF1bY2huXS5lbi5hc3NpZ24oZ2ZjLmVuW2Nobl0pO1xuICAgICAgICAgICAgbWFza2luZ19yYXRpb1tncl9vdXRdW2Nobl0udGhtLmFzc2lnbihnZmMudGhtW2Nobl0pO1xuICAgICAgICAgICAgaWYgKG5fY2huX3BzeSA+IDIpIHtcbiAgICAgICAgICAgICAgICAvKiBNUyBtYXNraW5ncyAqL1xuICAgICAgICAgICAgICAgIC8qIHBlcmNlcF9NU19lbnRyb3B5IFtjaG4tMl0gPSBnZmMgLiBwZSBbY2huXTsgKi9cbiAgICAgICAgICAgICAgICBtYXNraW5nX01TX3JhdGlvW2dyX291dF1bY2huXS5lbi5hc3NpZ24oZ2ZjLmVuW2NobiArIDJdKTtcbiAgICAgICAgICAgICAgICBtYXNraW5nX01TX3JhdGlvW2dyX291dF1bY2huXS50aG0uYXNzaWduKGdmYy50aG1bY2huICsgMl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGNobiA9IDA7IGNobiA8IG5fY2huX3BzeTsgY2huKyspIHtcbiAgICAgICAgICAgIHZhciBhdHRhY2tfaW50ZW5zaXR5ID0gbmV3X2Zsb2F0KDEyKTtcbiAgICAgICAgICAgIHZhciBlbl9zdWJzaG9ydCA9IG5ld19mbG9hdCgxMik7XG4gICAgICAgICAgICB2YXIgZW5fc2hvcnQgPSBbMCwgMCwgMCwgMF07XG4gICAgICAgICAgICB2YXIgcGYgPSBuc19ocGZzbXBsW2NobiAmIDFdO1xuICAgICAgICAgICAgdmFyIHBmUG9zID0gMDtcbiAgICAgICAgICAgIHZhciBhdHRhY2tUaHJlc2hvbGQgPSAoY2huID09IDMpID8gZ2ZjLm5zUHN5LmF0dGFja3RocmVfc1xuICAgICAgICAgICAgICAgIDogZ2ZjLm5zUHN5LmF0dGFja3RocmU7XG4gICAgICAgICAgICB2YXIgbnNfdXNlbG9uZ2Jsb2NrID0gMTtcblxuICAgICAgICAgICAgaWYgKGNobiA9PSAyKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAsIGogPSA1NzY7IGogPiAwOyArK2ksIC0taikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbCA9IG5zX2hwZnNtcGxbMF1baV07XG4gICAgICAgICAgICAgICAgICAgIHZhciByID0gbnNfaHBmc21wbFsxXVtpXTtcbiAgICAgICAgICAgICAgICAgICAgbnNfaHBmc21wbFswXVtpXSA9IGwgKyByO1xuICAgICAgICAgICAgICAgICAgICBuc19ocGZzbXBsWzFdW2ldID0gbCAtIHI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgICAgICogZGV0ZXJtaW5lIHRoZSBibG9jayB0eXBlICh3aW5kb3cgdHlwZSlcbiAgICAgICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgICAgICAvKiBjYWxjdWxhdGUgZW5lcmdpZXMgb2YgZWFjaCBzdWItc2hvcnRibG9ja3MgKi9cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMzsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZW5fc3Vic2hvcnRbaV0gPSBnZmMubnNQc3kubGFzdF9lbl9zdWJzaG9ydFtjaG5dW2kgKyA2XTtcbiAgICAgICAgICAgICAgICBhdHRhY2tfaW50ZW5zaXR5W2ldID0gZW5fc3Vic2hvcnRbaV1cbiAgICAgICAgICAgICAgICAgICAgLyBnZmMubnNQc3kubGFzdF9lbl9zdWJzaG9ydFtjaG5dW2kgKyA0XTtcbiAgICAgICAgICAgICAgICBlbl9zaG9ydFswXSArPSBlbl9zdWJzaG9ydFtpXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA5OyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgcGZlID0gcGZQb3MgKyA1NzYgLyA5O1xuICAgICAgICAgICAgICAgIHZhciBwID0gMS47XG4gICAgICAgICAgICAgICAgZm9yICg7IHBmUG9zIDwgcGZlOyBwZlBvcysrKVxuICAgICAgICAgICAgICAgICAgICBpZiAocCA8IE1hdGguYWJzKHBmW3BmUG9zXSkpXG4gICAgICAgICAgICAgICAgICAgICAgICBwID0gTWF0aC5hYnMocGZbcGZQb3NdKTtcblxuICAgICAgICAgICAgICAgIGdmYy5uc1BzeS5sYXN0X2VuX3N1YnNob3J0W2Nobl1baV0gPSBlbl9zdWJzaG9ydFtpICsgM10gPSBwO1xuICAgICAgICAgICAgICAgIGVuX3Nob3J0WzEgKyBpIC8gM10gKz0gcDtcbiAgICAgICAgICAgICAgICBpZiAocCA+IGVuX3N1YnNob3J0W2kgKyAzIC0gMl0pIHtcbiAgICAgICAgICAgICAgICAgICAgcCA9IHAgLyBlbl9zdWJzaG9ydFtpICsgMyAtIDJdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZW5fc3Vic2hvcnRbaSArIDMgLSAyXSA+IHAgKiAxMC4wKSB7XG4gICAgICAgICAgICAgICAgICAgIHAgPSBlbl9zdWJzaG9ydFtpICsgMyAtIDJdIC8gKHAgKiAxMC4wKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwID0gMC4wO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBhdHRhY2tfaW50ZW5zaXR5W2kgKyAzXSA9IHA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBwdWxzZSBsaWtlIHNpZ25hbCBkZXRlY3Rpb24gZm9yIGZhdGJveS53YXYgYW5kIHNvIG9uICovXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDM7ICsraSkge1xuICAgICAgICAgICAgICAgIHZhciBlbm4gPSBlbl9zdWJzaG9ydFtpICogMyArIDNdXG4gICAgICAgICAgICAgICAgICAgICsgZW5fc3Vic2hvcnRbaSAqIDMgKyA0XSArIGVuX3N1YnNob3J0W2kgKiAzICsgNV07XG4gICAgICAgICAgICAgICAgdmFyIGZhY3RvciA9IDEuO1xuICAgICAgICAgICAgICAgIGlmIChlbl9zdWJzaG9ydFtpICogMyArIDVdICogNiA8IGVubikge1xuICAgICAgICAgICAgICAgICAgICBmYWN0b3IgKj0gMC41O1xuICAgICAgICAgICAgICAgICAgICBpZiAoZW5fc3Vic2hvcnRbaSAqIDMgKyA0XSAqIDYgPCBlbm4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvciAqPSAwLjU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3ViX3Nob3J0X2ZhY3RvcltjaG5dW2ldID0gZmFjdG9yO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZ2ZwLmFuYWx5c2lzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHggPSBhdHRhY2tfaW50ZW5zaXR5WzBdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgMTI7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoeCA8IGF0dGFja19pbnRlbnNpdHlbaV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHggPSBhdHRhY2tfaW50ZW5zaXR5W2ldO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGdmYy5waW5mby5lcnNbZ3Jfb3V0XVtjaG5dID0gZ2ZjLnBpbmZvLmVyc19zYXZlW2Nobl07XG4gICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLmVyc19zYXZlW2Nobl0gPSB4O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBjb21wYXJlIGVuZXJnaWVzIGJldHdlZW4gc3ViLXNob3J0YmxvY2tzICovXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDEyOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoMCA9PSBuc19hdHRhY2tzW2Nobl1baSAvIDNdXG4gICAgICAgICAgICAgICAgICAgICYmIGF0dGFja19pbnRlbnNpdHlbaV0gPiBhdHRhY2tUaHJlc2hvbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgbnNfYXR0YWNrc1tjaG5dW2kgLyAzXSA9IChpICUgMykgKyAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIHNob3VsZCBoYXZlIGVuZXJneSBjaGFuZ2UgYmV0d2VlbiBzaG9ydCBibG9ja3MsIGluIG9yZGVyIHRvIGF2b2lkXG4gICAgICAgICAgICAgKiBwZXJpb2RpYyBzaWduYWxzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIC8qIEdvb2Qgc2FtcGxlcyB0byBzaG93IHRoZSBlZmZlY3QgYXJlIFRydW1wZXQgdGVzdCBzb25ncyAqL1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIEdCOiB0dW5lZCAoMSkgdG8gYXZvaWQgdG9vIG1hbnkgc2hvcnQgYmxvY2tzIGZvciB0ZXN0IHNhbXBsZVxuICAgICAgICAgICAgICogVFJVTVBFVFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogUkg6IHR1bmVkICgyKSB0byBsZXQgZW5vdWdoIHNob3J0IGJsb2NrcyB0aHJvdWdoIGZvciB0ZXN0IHNhbXBsZVxuICAgICAgICAgICAgICogRlNPTCBhbmQgU05BUFNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgdSA9IGVuX3Nob3J0W2kgLSAxXTtcbiAgICAgICAgICAgICAgICB2YXIgdiA9IGVuX3Nob3J0W2ldO1xuICAgICAgICAgICAgICAgIHZhciBtID0gTWF0aC5tYXgodSwgdik7XG4gICAgICAgICAgICAgICAgaWYgKG0gPCA0MDAwMCkgeyAvKiAoMikgKi9cbiAgICAgICAgICAgICAgICAgICAgaWYgKHUgPCAxLjcgKiB2ICYmIHYgPCAxLjcgKiB1KSB7IC8qICgxKSAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT0gMSAmJiBuc19hdHRhY2tzW2Nobl1bMF0gPD0gbnNfYXR0YWNrc1tjaG5dW2ldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnNfYXR0YWNrc1tjaG5dWzBdID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIG5zX2F0dGFja3NbY2huXVtpXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChuc19hdHRhY2tzW2Nobl1bMF0gPD0gZ2ZjLm5zUHN5Lmxhc3RBdHRhY2tzW2Nobl0pIHtcbiAgICAgICAgICAgICAgICBuc19hdHRhY2tzW2Nobl1bMF0gPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZ2ZjLm5zUHN5Lmxhc3RBdHRhY2tzW2Nobl0gPT0gM1xuICAgICAgICAgICAgICAgIHx8IChuc19hdHRhY2tzW2Nobl1bMF0gKyBuc19hdHRhY2tzW2Nobl1bMV1cbiAgICAgICAgICAgICAgICArIG5zX2F0dGFja3NbY2huXVsyXSArIG5zX2F0dGFja3NbY2huXVszXSkgIT0gMCkge1xuICAgICAgICAgICAgICAgIG5zX3VzZWxvbmdibG9jayA9IDA7XG5cbiAgICAgICAgICAgICAgICBpZiAobnNfYXR0YWNrc1tjaG5dWzFdICE9IDAgJiYgbnNfYXR0YWNrc1tjaG5dWzBdICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbnNfYXR0YWNrc1tjaG5dWzFdID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5zX2F0dGFja3NbY2huXVsyXSAhPSAwICYmIG5zX2F0dGFja3NbY2huXVsxXSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIG5zX2F0dGFja3NbY2huXVsyXSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChuc19hdHRhY2tzW2Nobl1bM10gIT0gMCAmJiBuc19hdHRhY2tzW2Nobl1bMl0gIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBuc19hdHRhY2tzW2Nobl1bM10gPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjaG4gPCAyKSB7XG4gICAgICAgICAgICAgICAgdXNlbG9uZ2Jsb2NrW2Nobl0gPSBuc191c2Vsb25nYmxvY2s7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChuc191c2Vsb25nYmxvY2sgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB1c2Vsb25nYmxvY2tbMF0gPSB1c2Vsb25nYmxvY2tbMV0gPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIHRoZXJlIGlzIGEgb25lIGdyYW51bGUgZGVsYXkuIENvcHkgbWFza2luZ3MgY29tcHV0ZWQgbGFzdCBjYWxsXG4gICAgICAgICAgICAgKiBpbnRvIG1hc2tpbmdfcmF0aW8gdG8gcmV0dXJuIHRvIGNhbGxpbmcgcHJvZ3JhbS5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZW5lcmd5W2Nobl0gPSBnZmMudG90X2VuZXJbY2huXTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHZicnBzeV9za2lwX21hc2tpbmdfcyhnZmMsIGNobiwgc2Jsb2NrKSB7XG4gICAgICAgIGlmIChzYmxvY2sgPT0gMCkge1xuICAgICAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCBnZmMubnBhcnRfczsgYisrKSB7XG4gICAgICAgICAgICAgICAgZ2ZjLm5iX3MyW2Nobl1bYl0gPSBnZmMubmJfczFbY2huXVtiXTtcbiAgICAgICAgICAgICAgICBnZmMubmJfczFbY2huXVtiXSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiB2YnJwc3lfc2tpcF9tYXNraW5nX2woZ2ZjLCBjaG4pIHtcbiAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCBnZmMubnBhcnRfbDsgYisrKSB7XG4gICAgICAgICAgICBnZmMubmJfMltjaG5dW2JdID0gZ2ZjLm5iXzFbY2huXVtiXTtcbiAgICAgICAgICAgIGdmYy5uYl8xW2Nobl1bYl0gPSAwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcHN5dmJyX2NhbGNfbWFza19pbmRleF9zKGdmYywgbWF4LCBhdmcsIG1hc2tfaWR4KSB7XG4gICAgICAgIHZhciBsYXN0X3RhYl9lbnRyeSA9IHRhYi5sZW5ndGggLSAxO1xuICAgICAgICB2YXIgYiA9IDA7XG4gICAgICAgIHZhciBhID0gYXZnW2JdICsgYXZnW2IgKyAxXTtcbiAgICAgICAgaWYgKGEgPiAwLjApIHtcbiAgICAgICAgICAgIHZhciBtID0gbWF4W2JdO1xuICAgICAgICAgICAgaWYgKG0gPCBtYXhbYiArIDFdKVxuICAgICAgICAgICAgICAgIG0gPSBtYXhbYiArIDFdO1xuICAgICAgICAgICAgYSA9IDIwLjAgKiAobSAqIDIuMCAtIGEpXG4gICAgICAgICAgICAgICAgLyAoYSAqIChnZmMubnVtbGluZXNfc1tiXSArIGdmYy5udW1saW5lc19zW2IgKyAxXSAtIDEpKTtcbiAgICAgICAgICAgIHZhciBrID0gMCB8IGE7XG4gICAgICAgICAgICBpZiAoayA+IGxhc3RfdGFiX2VudHJ5KVxuICAgICAgICAgICAgICAgIGsgPSBsYXN0X3RhYl9lbnRyeTtcbiAgICAgICAgICAgIG1hc2tfaWR4W2JdID0gaztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1hc2tfaWR4W2JdID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoYiA9IDE7IGIgPCBnZmMubnBhcnRfcyAtIDE7IGIrKykge1xuICAgICAgICAgICAgYSA9IGF2Z1tiIC0gMV0gKyBhdmdbYl0gKyBhdmdbYiArIDFdO1xuICAgICAgICAgICAgaWYgKGEgPiAwLjApIHtcbiAgICAgICAgICAgICAgICB2YXIgbSA9IG1heFtiIC0gMV07XG4gICAgICAgICAgICAgICAgaWYgKG0gPCBtYXhbYl0pXG4gICAgICAgICAgICAgICAgICAgIG0gPSBtYXhbYl07XG4gICAgICAgICAgICAgICAgaWYgKG0gPCBtYXhbYiArIDFdKVxuICAgICAgICAgICAgICAgICAgICBtID0gbWF4W2IgKyAxXTtcbiAgICAgICAgICAgICAgICBhID0gMjAuMFxuICAgICAgICAgICAgICAgICAgICAqIChtICogMy4wIC0gYSlcbiAgICAgICAgICAgICAgICAgICAgLyAoYSAqIChnZmMubnVtbGluZXNfc1tiIC0gMV0gKyBnZmMubnVtbGluZXNfc1tiXVxuICAgICAgICAgICAgICAgICAgICArIGdmYy5udW1saW5lc19zW2IgKyAxXSAtIDEpKTtcbiAgICAgICAgICAgICAgICB2YXIgayA9IDAgfCBhO1xuICAgICAgICAgICAgICAgIGlmIChrID4gbGFzdF90YWJfZW50cnkpXG4gICAgICAgICAgICAgICAgICAgIGsgPSBsYXN0X3RhYl9lbnRyeTtcbiAgICAgICAgICAgICAgICBtYXNrX2lkeFtiXSA9IGs7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1hc2tfaWR4W2JdID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGEgPSBhdmdbYiAtIDFdICsgYXZnW2JdO1xuICAgICAgICBpZiAoYSA+IDAuMCkge1xuICAgICAgICAgICAgdmFyIG0gPSBtYXhbYiAtIDFdO1xuICAgICAgICAgICAgaWYgKG0gPCBtYXhbYl0pXG4gICAgICAgICAgICAgICAgbSA9IG1heFtiXTtcbiAgICAgICAgICAgIGEgPSAyMC4wICogKG0gKiAyLjAgLSBhKVxuICAgICAgICAgICAgICAgIC8gKGEgKiAoZ2ZjLm51bWxpbmVzX3NbYiAtIDFdICsgZ2ZjLm51bWxpbmVzX3NbYl0gLSAxKSk7XG4gICAgICAgICAgICB2YXIgayA9IDAgfCBhO1xuICAgICAgICAgICAgaWYgKGsgPiBsYXN0X3RhYl9lbnRyeSlcbiAgICAgICAgICAgICAgICBrID0gbGFzdF90YWJfZW50cnk7XG4gICAgICAgICAgICBtYXNrX2lkeFtiXSA9IGs7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtYXNrX2lkeFtiXSA9IDA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiB2YnJwc3lfY29tcHV0ZV9tYXNraW5nX3MoZ2ZwLCBmZnRlbmVyZ3lfcywgZWIsIHRociwgY2huLCBzYmxvY2spIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIG1heCA9IG5ldyBmbG9hdFtFbmNvZGVyLkNCQU5EU10sIGF2ZyA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyk7XG4gICAgICAgIHZhciBpLCBqLCBiO1xuICAgICAgICB2YXIgbWFza19pZHhfcyA9IG5ldyBpbnRbRW5jb2Rlci5DQkFORFNdO1xuXG4gICAgICAgIGZvciAoYiA9IGogPSAwOyBiIDwgZ2ZjLm5wYXJ0X3M7ICsrYikge1xuICAgICAgICAgICAgdmFyIGViYiA9IDAsIG0gPSAwO1xuICAgICAgICAgICAgdmFyIG4gPSBnZmMubnVtbGluZXNfc1tiXTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBuOyArK2ksICsraikge1xuICAgICAgICAgICAgICAgIHZhciBlbCA9IGZmdGVuZXJneV9zW3NibG9ja11bal07XG4gICAgICAgICAgICAgICAgZWJiICs9IGVsO1xuICAgICAgICAgICAgICAgIGlmIChtIDwgZWwpXG4gICAgICAgICAgICAgICAgICAgIG0gPSBlbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGViW2JdID0gZWJiO1xuICAgICAgICAgICAgbWF4W2JdID0gbTtcbiAgICAgICAgICAgIGF2Z1tiXSA9IGViYiAvIG47XG4gICAgICAgIH1cbiAgICAgICAgZm9yICg7IGIgPCBFbmNvZGVyLkNCQU5EUzsgKytiKSB7XG4gICAgICAgICAgICBtYXhbYl0gPSAwO1xuICAgICAgICAgICAgYXZnW2JdID0gMDtcbiAgICAgICAgfVxuICAgICAgICBwc3l2YnJfY2FsY19tYXNrX2luZGV4X3MoZ2ZjLCBtYXgsIGF2ZywgbWFza19pZHhfcyk7XG4gICAgICAgIGZvciAoaiA9IGIgPSAwOyBiIDwgZ2ZjLm5wYXJ0X3M7IGIrKykge1xuICAgICAgICAgICAgdmFyIGtrID0gZ2ZjLnMzaW5kX3NbYl1bMF07XG4gICAgICAgICAgICB2YXIgbGFzdCA9IGdmYy5zM2luZF9zW2JdWzFdO1xuICAgICAgICAgICAgdmFyIGRkLCBkZF9uO1xuICAgICAgICAgICAgdmFyIHgsIGVjYiwgYXZnX21hc2s7XG4gICAgICAgICAgICBkZCA9IG1hc2tfaWR4X3Nba2tdO1xuICAgICAgICAgICAgZGRfbiA9IDE7XG4gICAgICAgICAgICBlY2IgPSBnZmMuczNfc3Nbal0gKiBlYltra10gKiB0YWJbbWFza19pZHhfc1tra11dO1xuICAgICAgICAgICAgKytqO1xuICAgICAgICAgICAgKytraztcbiAgICAgICAgICAgIHdoaWxlIChrayA8PSBsYXN0KSB7XG4gICAgICAgICAgICAgICAgZGQgKz0gbWFza19pZHhfc1tra107XG4gICAgICAgICAgICAgICAgZGRfbiArPSAxO1xuICAgICAgICAgICAgICAgIHggPSBnZmMuczNfc3Nbal0gKiBlYltra10gKiB0YWJbbWFza19pZHhfc1tra11dO1xuICAgICAgICAgICAgICAgIGVjYiA9IHZicnBzeV9tYXNrX2FkZChlY2IsIHgsIGtrIC0gYik7XG4gICAgICAgICAgICAgICAgKytqO1xuICAgICAgICAgICAgICAgICsra2s7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZCA9ICgxICsgMiAqIGRkKSAvICgyICogZGRfbik7XG4gICAgICAgICAgICBhdmdfbWFzayA9IHRhYltkZF0gKiAwLjU7XG4gICAgICAgICAgICBlY2IgKj0gYXZnX21hc2s7XG4gICAgICAgICAgICB0aHJbYl0gPSBlY2I7XG4gICAgICAgICAgICBnZmMubmJfczJbY2huXVtiXSA9IGdmYy5uYl9zMVtjaG5dW2JdO1xuICAgICAgICAgICAgZ2ZjLm5iX3MxW2Nobl1bYl0gPSBlY2I7XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBpZiBUSFIgZXhjZWVkcyBFQiwgdGhlIHF1YW50aXphdGlvbiByb3V0aW5lcyB3aWxsIHRha2UgdGhlXG4gICAgICAgICAgICAgICAgICogZGlmZmVyZW5jZSBmcm9tIG90aGVyIGJhbmRzLiBpbiBjYXNlIG9mIHN0cm9uZyB0b25hbCBzYW1wbGVzXG4gICAgICAgICAgICAgICAgICogKHRvbmFsdGVzdC53YXYpIHRoaXMgbGVhZHMgdG8gaGVhdnkgZGlzdG9ydGlvbnMuIHRoYXQncyB3aHlcbiAgICAgICAgICAgICAgICAgKiB3ZSBsaW1pdCBUSFIgaGVyZS5cbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICB4ID0gbWF4W2JdO1xuICAgICAgICAgICAgICAgIHggKj0gZ2ZjLm1pbnZhbF9zW2JdO1xuICAgICAgICAgICAgICAgIHggKj0gYXZnX21hc2s7XG4gICAgICAgICAgICAgICAgaWYgKHRocltiXSA+IHgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyW2JdID0geDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ2ZjLm1hc2tpbmdfbG93ZXIgPiAxKSB7XG4gICAgICAgICAgICAgICAgdGhyW2JdICo9IGdmYy5tYXNraW5nX2xvd2VyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRocltiXSA+IGViW2JdKSB7XG4gICAgICAgICAgICAgICAgdGhyW2JdID0gZWJbYl07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ2ZjLm1hc2tpbmdfbG93ZXIgPCAxKSB7XG4gICAgICAgICAgICAgICAgdGhyW2JdICo9IGdmYy5tYXNraW5nX2xvd2VyO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgICAgZm9yICg7IGIgPCBFbmNvZGVyLkNCQU5EUzsgKytiKSB7XG4gICAgICAgICAgICBlYltiXSA9IDA7XG4gICAgICAgICAgICB0aHJbYl0gPSAwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdmJycHN5X2NvbXB1dGVfbWFza2luZ19sKGdmYywgZmZ0ZW5lcmd5LCBlYl9sLCB0aHIsIGNobikge1xuICAgICAgICB2YXIgbWF4ID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTKSwgYXZnID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTKTtcbiAgICAgICAgdmFyIG1hc2tfaWR4X2wgPSBuZXdfaW50KEVuY29kZXIuQ0JBTkRTICsgMik7XG4gICAgICAgIHZhciBiO1xuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogQ2FsY3VsYXRlIHRoZSBlbmVyZ3kgYW5kIHRoZSB0b25hbGl0eSBvZiBlYWNoIHBhcnRpdGlvbi5cbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgY2FsY19lbmVyZ3koZ2ZjLCBmZnRlbmVyZ3ksIGViX2wsIG1heCwgYXZnKTtcbiAgICAgICAgY2FsY19tYXNrX2luZGV4X2woZ2ZjLCBtYXgsIGF2ZywgbWFza19pZHhfbCk7XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBjb252b2x2ZSB0aGUgcGFydGl0aW9uZWQgZW5lcmd5IGFuZCB1bnByZWRpY3RhYmlsaXR5IHdpdGggdGhlXG4gICAgICAgICAqIHNwcmVhZGluZyBmdW5jdGlvbiwgczNfbFtiXVtrXVxuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIHZhciBrID0gMDtcbiAgICAgICAgZm9yIChiID0gMDsgYiA8IGdmYy5ucGFydF9sOyBiKyspIHtcbiAgICAgICAgICAgIHZhciB4LCBlY2IsIGF2Z19tYXNrLCB0O1xuICAgICAgICAgICAgLyogY29udm9sdmUgdGhlIHBhcnRpdGlvbmVkIGVuZXJneSB3aXRoIHRoZSBzcHJlYWRpbmcgZnVuY3Rpb24gKi9cbiAgICAgICAgICAgIHZhciBrayA9IGdmYy5zM2luZFtiXVswXTtcbiAgICAgICAgICAgIHZhciBsYXN0ID0gZ2ZjLnMzaW5kW2JdWzFdO1xuICAgICAgICAgICAgdmFyIGRkID0gMCwgZGRfbiA9IDA7XG4gICAgICAgICAgICBkZCA9IG1hc2tfaWR4X2xba2tdO1xuICAgICAgICAgICAgZGRfbiArPSAxO1xuICAgICAgICAgICAgZWNiID0gZ2ZjLnMzX2xsW2tdICogZWJfbFtra10gKiB0YWJbbWFza19pZHhfbFtra11dO1xuICAgICAgICAgICAgKytrO1xuICAgICAgICAgICAgKytraztcbiAgICAgICAgICAgIHdoaWxlIChrayA8PSBsYXN0KSB7XG4gICAgICAgICAgICAgICAgZGQgKz0gbWFza19pZHhfbFtra107XG4gICAgICAgICAgICAgICAgZGRfbiArPSAxO1xuICAgICAgICAgICAgICAgIHggPSBnZmMuczNfbGxba10gKiBlYl9sW2trXSAqIHRhYlttYXNrX2lkeF9sW2trXV07XG4gICAgICAgICAgICAgICAgdCA9IHZicnBzeV9tYXNrX2FkZChlY2IsIHgsIGtrIC0gYik7XG4gICAgICAgICAgICAgICAgZWNiID0gdDtcbiAgICAgICAgICAgICAgICArK2s7XG4gICAgICAgICAgICAgICAgKytraztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRkID0gKDEgKyAyICogZGQpIC8gKDIgKiBkZF9uKTtcbiAgICAgICAgICAgIGF2Z19tYXNrID0gdGFiW2RkXSAqIDAuNTtcbiAgICAgICAgICAgIGVjYiAqPSBhdmdfbWFzaztcblxuICAgICAgICAgICAgLyoqKiogbG9uZyBibG9jayBwcmUtZWNobyBjb250cm9sICoqKiovXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIDxQUkU+XG4gICAgICAgICAgICAgKiBkb250IHVzZSBsb25nIGJsb2NrIHByZS1lY2hvIGNvbnRyb2wgaWYgcHJldmlvdXMgZ3JhbnVsZSB3YXNcbiAgICAgICAgICAgICAqIGEgc2hvcnQgYmxvY2suICBUaGlzIGlzIHRvIGF2b2lkIHRoZSBzaXR1YXRpb246XG4gICAgICAgICAgICAgKiBmcmFtZTA6ICBxdWlldCAodmVyeSBsb3cgbWFza2luZylcbiAgICAgICAgICAgICAqIGZyYW1lMTogIHN1cmdlICAodHJpZ2dlcnMgc2hvcnQgYmxvY2tzKVxuICAgICAgICAgICAgICogZnJhbWUyOiAgcmVndWxhciBmcmFtZS4gIGxvb2tzIGxpa2UgcHJlLWVjaG8gd2hlbiBjb21wYXJlZCB0b1xuICAgICAgICAgICAgICogICAgICAgICAgZnJhbWUwLCBidXQgYWxsIHByZS1lY2hvIHdhcyBpbiBmcmFtZTEuXG4gICAgICAgICAgICAgKiA8L1BSRT5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIGNobj0wLDEgTCBhbmQgUiBjaGFubmVscyBjaG49MiwzIFMgYW5kIE0gY2hhbm5lbHMuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGlmIChnZmMuYmxvY2t0eXBlX29sZFtjaG4gJiAweDAxXSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgICAgICB2YXIgZWNiX2xpbWl0ID0gcnBlbGV2ICogZ2ZjLm5iXzFbY2huXVtiXTtcbiAgICAgICAgICAgICAgICBpZiAoZWNiX2xpbWl0ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJbYl0gPSBNYXRoLm1pbihlY2IsIGVjYl9saW1pdCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICAgICAqIDxQUkU+XG4gICAgICAgICAgICAgICAgICAgICAqIFJvYmVydCAwNzEyMDk6XG4gICAgICAgICAgICAgICAgICAgICAqIEJlY2F1c2Ugd2UgZG9uJ3QgY2FsY3VsYXRlIGxvbmcgYmxvY2sgcHN5IHdoZW4gd2Uga25vdyBhIGdyYW51bGVcbiAgICAgICAgICAgICAgICAgICAgICogc2hvdWxkIGJlIG9mIHNob3J0IGJsb2Nrcywgd2UgZG9uJ3QgaGF2ZSBhbnkgY2x1ZSBob3cgdGhlIGdyYW51bGVcbiAgICAgICAgICAgICAgICAgICAgICogYmVmb3JlIHdvdWxkIGhhdmUgbG9va2VkIGxpa2UgYXMgYSBsb25nIGJsb2NrLiBTbyB3ZSBoYXZlIHRvIGd1ZXNzXG4gICAgICAgICAgICAgICAgICAgICAqIGEgbGl0dGxlIGJpdCBmb3IgdGhpcyBFTkRfVFlQRSBibG9jay5cbiAgICAgICAgICAgICAgICAgICAgICogTW9zdCBvZiB0aGUgdGltZSB3ZSBnZXQgYXdheSB3aXRoIHRoaXMgc2xvcHB5bmVzcy4gKGZpbmdlcnMgY3Jvc3NlZCA6KVxuICAgICAgICAgICAgICAgICAgICAgKiBUaGUgc3BlZWQgaW5jcmVhc2UgaXMgd29ydGggaXQuXG4gICAgICAgICAgICAgICAgICAgICAqIDwvUFJFPlxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgdGhyW2JdID0gTWF0aC5taW4oZWNiLCBlYl9sW2JdICogTlNfUFJFRUNIT19BVFQyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBlY2JfbGltaXRfMiA9IHJwZWxldjIgKiBnZmMubmJfMltjaG5dW2JdO1xuICAgICAgICAgICAgICAgIHZhciBlY2JfbGltaXRfMSA9IHJwZWxldiAqIGdmYy5uYl8xW2Nobl1bYl07XG4gICAgICAgICAgICAgICAgdmFyIGVjYl9saW1pdDtcbiAgICAgICAgICAgICAgICBpZiAoZWNiX2xpbWl0XzIgPD0gMCkge1xuICAgICAgICAgICAgICAgICAgICBlY2JfbGltaXRfMiA9IGVjYjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGVjYl9saW1pdF8xIDw9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZWNiX2xpbWl0XzEgPSBlY2I7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnZmMuYmxvY2t0eXBlX29sZFtjaG4gJiAweDAxXSA9PSBFbmNvZGVyLk5PUk1fVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICBlY2JfbGltaXQgPSBNYXRoLm1pbihlY2JfbGltaXRfMSwgZWNiX2xpbWl0XzIpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVjYl9saW1pdCA9IGVjYl9saW1pdF8xO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aHJbYl0gPSBNYXRoLm1pbihlY2IsIGVjYl9saW1pdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMubmJfMltjaG5dW2JdID0gZ2ZjLm5iXzFbY2huXVtiXTtcbiAgICAgICAgICAgIGdmYy5uYl8xW2Nobl1bYl0gPSBlY2I7XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBpZiBUSFIgZXhjZWVkcyBFQiwgdGhlIHF1YW50aXphdGlvbiByb3V0aW5lcyB3aWxsIHRha2UgdGhlXG4gICAgICAgICAgICAgICAgICogZGlmZmVyZW5jZSBmcm9tIG90aGVyIGJhbmRzLiBpbiBjYXNlIG9mIHN0cm9uZyB0b25hbCBzYW1wbGVzXG4gICAgICAgICAgICAgICAgICogKHRvbmFsdGVzdC53YXYpIHRoaXMgbGVhZHMgdG8gaGVhdnkgZGlzdG9ydGlvbnMuIHRoYXQncyB3aHlcbiAgICAgICAgICAgICAgICAgKiB3ZSBsaW1pdCBUSFIgaGVyZS5cbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICB4ID0gbWF4W2JdO1xuICAgICAgICAgICAgICAgIHggKj0gZ2ZjLm1pbnZhbF9sW2JdO1xuICAgICAgICAgICAgICAgIHggKj0gYXZnX21hc2s7XG4gICAgICAgICAgICAgICAgaWYgKHRocltiXSA+IHgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyW2JdID0geDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ2ZjLm1hc2tpbmdfbG93ZXIgPiAxKSB7XG4gICAgICAgICAgICAgICAgdGhyW2JdICo9IGdmYy5tYXNraW5nX2xvd2VyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRocltiXSA+IGViX2xbYl0pIHtcbiAgICAgICAgICAgICAgICB0aHJbYl0gPSBlYl9sW2JdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGdmYy5tYXNraW5nX2xvd2VyIDwgMSkge1xuICAgICAgICAgICAgICAgIHRocltiXSAqPSBnZmMubWFza2luZ19sb3dlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKDsgYiA8IEVuY29kZXIuQ0JBTkRTOyArK2IpIHtcbiAgICAgICAgICAgIGViX2xbYl0gPSAwO1xuICAgICAgICAgICAgdGhyW2JdID0gMDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHZicnBzeV9jb21wdXRlX2Jsb2NrX3R5cGUoZ2ZwLCB1c2Vsb25nYmxvY2spIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblxuICAgICAgICBpZiAoZ2ZwLnNob3J0X2Jsb2NrcyA9PSBTaG9ydEJsb2NrLnNob3J0X2Jsb2NrX2NvdXBsZWRcbiAgICAgICAgICAgICAgICAvKiBmb3JjZSBib3RoIGNoYW5uZWxzIHRvIHVzZSB0aGUgc2FtZSBibG9jayB0eXBlICovXG4gICAgICAgICAgICAgICAgLyogdGhpcyBpcyBuZWNlc3NhcnkgaWYgdGhlIGZyYW1lIGlzIHRvIGJlIGVuY29kZWQgaW4gbXNfc3RlcmVvLiAqL1xuICAgICAgICAgICAgICAgIC8qIEJ1dCBldmVuIHdpdGhvdXQgbXNfc3RlcmVvLCBGaEcgZG9lcyB0aGlzICovXG4gICAgICAgICAgICAmJiAhKHVzZWxvbmdibG9ja1swXSAhPSAwICYmIHVzZWxvbmdibG9ja1sxXSAhPSAwKSlcbiAgICAgICAgICAgIHVzZWxvbmdibG9ja1swXSA9IHVzZWxvbmdibG9ja1sxXSA9IDA7XG5cbiAgICAgICAgZm9yICh2YXIgY2huID0gMDsgY2huIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2huKyspIHtcbiAgICAgICAgICAgIC8qIGRpc2FibGUgc2hvcnQgYmxvY2tzICovXG4gICAgICAgICAgICBpZiAoZ2ZwLnNob3J0X2Jsb2NrcyA9PSBTaG9ydEJsb2NrLnNob3J0X2Jsb2NrX2Rpc3BlbnNlZCkge1xuICAgICAgICAgICAgICAgIHVzZWxvbmdibG9ja1tjaG5dID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChnZnAuc2hvcnRfYmxvY2tzID09IFNob3J0QmxvY2suc2hvcnRfYmxvY2tfZm9yY2VkKSB7XG4gICAgICAgICAgICAgICAgdXNlbG9uZ2Jsb2NrW2Nobl0gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdmJycHN5X2FwcGx5X2Jsb2NrX3R5cGUoZ2ZwLCB1c2Vsb25nYmxvY2ssIGJsb2NrdHlwZV9kKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogdXBkYXRlIHRoZSBibG9ja3R5cGUgb2YgdGhlIHByZXZpb3VzIGdyYW51bGUsIHNpbmNlIGl0IGRlcGVuZHMgb25cbiAgICAgICAgICogd2hhdCBoYXBwZW5kIGluIHRoaXMgZ3JhbnVsZVxuICAgICAgICAgKi9cbiAgICAgICAgZm9yICh2YXIgY2huID0gMDsgY2huIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2huKyspIHtcbiAgICAgICAgICAgIHZhciBibG9ja3R5cGUgPSBFbmNvZGVyLk5PUk1fVFlQRTtcbiAgICAgICAgICAgIC8qIGRpc2FibGUgc2hvcnQgYmxvY2tzICovXG5cbiAgICAgICAgICAgIGlmICh1c2Vsb25nYmxvY2tbY2huXSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgLyogbm8gYXR0YWNrIDogdXNlIGxvbmcgYmxvY2tzICovXG4gICAgICAgICAgICAgICAgaWYgKGdmYy5ibG9ja3R5cGVfb2xkW2Nobl0gPT0gRW5jb2Rlci5TSE9SVF9UWVBFKVxuICAgICAgICAgICAgICAgICAgICBibG9ja3R5cGUgPSBFbmNvZGVyLlNUT1BfVFlQRTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLyogYXR0YWNrIDogdXNlIHNob3J0IGJsb2NrcyAqL1xuICAgICAgICAgICAgICAgIGJsb2NrdHlwZSA9IEVuY29kZXIuU0hPUlRfVFlQRTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLmJsb2NrdHlwZV9vbGRbY2huXSA9PSBFbmNvZGVyLk5PUk1fVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICBnZmMuYmxvY2t0eXBlX29sZFtjaG5dID0gRW5jb2Rlci5TVEFSVF9UWVBFO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLmJsb2NrdHlwZV9vbGRbY2huXSA9PSBFbmNvZGVyLlNUT1BfVFlQRSlcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLmJsb2NrdHlwZV9vbGRbY2huXSA9IEVuY29kZXIuU0hPUlRfVFlQRTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYmxvY2t0eXBlX2RbY2huXSA9IGdmYy5ibG9ja3R5cGVfb2xkW2Nobl07XG4gICAgICAgICAgICAvLyB2YWx1ZSByZXR1cm5lZCB0byBjYWxsaW5nIHByb2dyYW1cbiAgICAgICAgICAgIGdmYy5ibG9ja3R5cGVfb2xkW2Nobl0gPSBibG9ja3R5cGU7XG4gICAgICAgICAgICAvLyBzYXZlIGZvciBuZXh0IGNhbGwgdG8gbDNwc3lfYW5hbFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY29tcHV0ZSBNL1MgdGhyZXNob2xkcyBmcm9tIEpvaG5zdG9uICYgRmVycmVpcmEgMTk5MiBJQ0FTU1AgcGFwZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB2YnJwc3lfY29tcHV0ZV9NU190aHJlc2hvbGRzKGViLCB0aHIsIGNiX21sZCwgYXRoX2NiLCBhdGhhZGp1c3QsIG1zZml4LCBuKSB7XG4gICAgICAgIHZhciBtc2ZpeDIgPSBtc2ZpeCAqIDI7XG4gICAgICAgIHZhciBhdGhsb3dlciA9IG1zZml4ID4gMCA/IE1hdGgucG93KDEwLCBhdGhhZGp1c3QpIDogMTtcbiAgICAgICAgdmFyIHJzaWRlLCBybWlkO1xuICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IG47ICsrYikge1xuICAgICAgICAgICAgdmFyIGViTSA9IGViWzJdW2JdO1xuICAgICAgICAgICAgdmFyIGViUyA9IGViWzNdW2JdO1xuICAgICAgICAgICAgdmFyIHRobUwgPSB0aHJbMF1bYl07XG4gICAgICAgICAgICB2YXIgdGhtUiA9IHRoclsxXVtiXTtcbiAgICAgICAgICAgIHZhciB0aG1NID0gdGhyWzJdW2JdO1xuICAgICAgICAgICAgdmFyIHRobVMgPSB0aHJbM11bYl07XG5cbiAgICAgICAgICAgIC8qIHVzZSB0aGlzIGZpeCBpZiBMICYgUiBtYXNraW5nIGRpZmZlcnMgYnkgMmRiIG9yIGxlc3MgKi9cbiAgICAgICAgICAgIGlmICh0aG1MIDw9IDEuNTggKiB0aG1SICYmIHRobVIgPD0gMS41OCAqIHRobUwpIHtcbiAgICAgICAgICAgICAgICB2YXIgbWxkX20gPSBjYl9tbGRbYl0gKiBlYlM7XG4gICAgICAgICAgICAgICAgdmFyIG1sZF9zID0gY2JfbWxkW2JdICogZWJNO1xuICAgICAgICAgICAgICAgIHJtaWQgPSBNYXRoLm1heCh0aG1NLCBNYXRoLm1pbih0aG1TLCBtbGRfbSkpO1xuICAgICAgICAgICAgICAgIHJzaWRlID0gTWF0aC5tYXgodGhtUywgTWF0aC5taW4odGhtTSwgbWxkX3MpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcm1pZCA9IHRobU07XG4gICAgICAgICAgICAgICAgcnNpZGUgPSB0aG1TO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKG1zZml4ID4gMCkge1xuICAgICAgICAgICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgICAgICAgICAgLyogQWRqdXN0IE0vUyBtYXNraW5ncyBpZiB1c2VyIHNldCBcIm1zZml4XCIgKi9cbiAgICAgICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICAgICAgICAgIC8qIE5hb2tpIFNoaWJhdGEgMjAwMCAqL1xuICAgICAgICAgICAgICAgIHZhciB0aG1MUiwgdGhtTVM7XG4gICAgICAgICAgICAgICAgdmFyIGF0aCA9IGF0aF9jYltiXSAqIGF0aGxvd2VyO1xuICAgICAgICAgICAgICAgIHRobUxSID0gTWF0aC5taW4oTWF0aC5tYXgodGhtTCwgYXRoKSwgTWF0aC5tYXgodGhtUiwgYXRoKSk7XG4gICAgICAgICAgICAgICAgdGhtTSA9IE1hdGgubWF4KHJtaWQsIGF0aCk7XG4gICAgICAgICAgICAgICAgdGhtUyA9IE1hdGgubWF4KHJzaWRlLCBhdGgpO1xuICAgICAgICAgICAgICAgIHRobU1TID0gdGhtTSArIHRobVM7XG4gICAgICAgICAgICAgICAgaWYgKHRobU1TID4gMCAmJiAodGhtTFIgKiBtc2ZpeDIpIDwgdGhtTVMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSB0aG1MUiAqIG1zZml4MiAvIHRobU1TO1xuICAgICAgICAgICAgICAgICAgICB0aG1NICo9IGY7XG4gICAgICAgICAgICAgICAgICAgIHRobVMgKj0gZjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcm1pZCA9IE1hdGgubWluKHRobU0sIHJtaWQpO1xuICAgICAgICAgICAgICAgIHJzaWRlID0gTWF0aC5taW4odGhtUywgcnNpZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJtaWQgPiBlYk0pIHtcbiAgICAgICAgICAgICAgICBybWlkID0gZWJNO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJzaWRlID4gZWJTKSB7XG4gICAgICAgICAgICAgICAgcnNpZGUgPSBlYlM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJbMl1bYl0gPSBybWlkO1xuICAgICAgICAgICAgdGhyWzNdW2JdID0gcnNpZGU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLkwzcHN5Y2hvX2FuYWxfdmJyID0gZnVuY3Rpb24gKGdmcCwgYnVmZmVyLCBidWZQb3MsIGdyX291dCwgbWFza2luZ19yYXRpbywgbWFza2luZ19NU19yYXRpbywgcGVyY2VwX2VudHJvcHksIHBlcmNlcF9NU19lbnRyb3B5LCBlbmVyZ3ksIGJsb2NrdHlwZV9kKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cbiAgICAgICAgLyogZmZ0IGFuZCBlbmVyZ3kgY2FsY3VsYXRpb24gKi9cbiAgICAgICAgdmFyIHdzYW1wX2w7XG4gICAgICAgIHZhciB3c2FtcF9zO1xuICAgICAgICB2YXIgZmZ0ZW5lcmd5ID0gbmV3X2Zsb2F0KEVuY29kZXIuSEJMS1NJWkUpO1xuICAgICAgICB2YXIgZmZ0ZW5lcmd5X3MgPSBuZXdfZmxvYXRfbihbMywgRW5jb2Rlci5IQkxLU0laRV9zXSk7XG4gICAgICAgIHZhciB3c2FtcF9MID0gbmV3X2Zsb2F0X24oWzIsIEVuY29kZXIuQkxLU0laRV0pO1xuICAgICAgICB2YXIgd3NhbXBfUyA9IG5ld19mbG9hdF9uKFsyLCAzLCBFbmNvZGVyLkJMS1NJWkVfc10pO1xuICAgICAgICB2YXIgZWIgPSBuZXdfZmxvYXRfbihbNCwgRW5jb2Rlci5DQkFORFNdKSwgdGhyID0gbmV3X2Zsb2F0X24oWzQsIEVuY29kZXIuQ0JBTkRTXSk7XG4gICAgICAgIHZhciBzdWJfc2hvcnRfZmFjdG9yID0gbmV3X2Zsb2F0X24oWzQsIDNdKTtcbiAgICAgICAgdmFyIHBjZmFjdCA9IDAuNjtcblxuICAgICAgICAvKiBibG9jayB0eXBlICovXG4gICAgICAgIHZhciBuc19hdHRhY2tzID0gW1swLCAwLCAwLCAwXSwgWzAsIDAsIDAsIDBdLCBbMCwgMCwgMCwgMF0sXG4gICAgICAgICAgICBbMCwgMCwgMCwgMF1dO1xuICAgICAgICB2YXIgdXNlbG9uZ2Jsb2NrID0gbmV3X2ludCgyKTtcblxuICAgICAgICAvKiB1c3VhbCB2YXJpYWJsZXMgbGlrZSBsb29wIGluZGljZXMsIGV0Yy4uICovXG5cbiAgICAgICAgLyogY2huPTIgYW5kIDMgPSBNaWQgYW5kIFNpZGUgY2hhbm5lbHMgKi9cbiAgICAgICAgdmFyIG5fY2huX3BzeSA9IChnZnAubW9kZSA9PSBNUEVHTW9kZS5KT0lOVF9TVEVSRU8pID8gNFxuICAgICAgICAgICAgOiBnZmMuY2hhbm5lbHNfb3V0O1xuXG4gICAgICAgIHZicnBzeV9hdHRhY2tfZGV0ZWN0aW9uKGdmcCwgYnVmZmVyLCBidWZQb3MsIGdyX291dCwgbWFza2luZ19yYXRpbyxcbiAgICAgICAgICAgIG1hc2tpbmdfTVNfcmF0aW8sIGVuZXJneSwgc3ViX3Nob3J0X2ZhY3RvciwgbnNfYXR0YWNrcyxcbiAgICAgICAgICAgIHVzZWxvbmdibG9jayk7XG5cbiAgICAgICAgdmJycHN5X2NvbXB1dGVfYmxvY2tfdHlwZShnZnAsIHVzZWxvbmdibG9jayk7XG5cbiAgICAgICAgLyogTE9ORyBCTE9DSyBDQVNFICovXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZvciAodmFyIGNobiA9IDA7IGNobiA8IG5fY2huX3BzeTsgY2huKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgY2gwMSA9IGNobiAmIDB4MDE7XG4gICAgICAgICAgICAgICAgd3NhbXBfbCA9IHdzYW1wX0w7XG4gICAgICAgICAgICAgICAgdmJycHN5X2NvbXB1dGVfZmZ0X2woZ2ZwLCBidWZmZXIsIGJ1ZlBvcywgY2huLCBncl9vdXQsXG4gICAgICAgICAgICAgICAgICAgIGZmdGVuZXJneSwgd3NhbXBfbCwgY2gwMSk7XG5cbiAgICAgICAgICAgICAgICB2YnJwc3lfY29tcHV0ZV9sb3VkbmVzc19hcHByb3hpbWF0aW9uX2woZ2ZwLCBncl9vdXQsIGNobixcbiAgICAgICAgICAgICAgICAgICAgZmZ0ZW5lcmd5KTtcblxuICAgICAgICAgICAgICAgIGlmICh1c2Vsb25nYmxvY2tbY2gwMV0gIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB2YnJwc3lfY29tcHV0ZV9tYXNraW5nX2woZ2ZjLCBmZnRlbmVyZ3ksIGViW2Nobl0sIHRocltjaG5dLFxuICAgICAgICAgICAgICAgICAgICAgICAgY2huKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YnJwc3lfc2tpcF9tYXNraW5nX2woZ2ZjLCBjaG4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICgodXNlbG9uZ2Jsb2NrWzBdICsgdXNlbG9uZ2Jsb2NrWzFdKSA9PSAyKSB7XG4gICAgICAgICAgICAgICAgLyogTS9TIGNoYW5uZWwgKi9cbiAgICAgICAgICAgICAgICBpZiAoZ2ZwLm1vZGUgPT0gTVBFR01vZGUuSk9JTlRfU1RFUkVPKSB7XG4gICAgICAgICAgICAgICAgICAgIHZicnBzeV9jb21wdXRlX01TX3RocmVzaG9sZHMoZWIsIHRociwgZ2ZjLm1sZF9jYl9sLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2ZjLkFUSC5jYl9sLCBnZnAuQVRIbG93ZXIgKiBnZmMuQVRILmFkanVzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdmcC5tc2ZpeCwgZ2ZjLm5wYXJ0X2wpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIFRPRE86IGFwcGx5IGFkYXB0aXZlIEFUSCBtYXNraW5nIGhlcmUgPz8gKi9cbiAgICAgICAgICAgIGZvciAodmFyIGNobiA9IDA7IGNobiA8IG5fY2huX3BzeTsgY2huKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgY2gwMSA9IGNobiAmIDB4MDE7XG4gICAgICAgICAgICAgICAgaWYgKHVzZWxvbmdibG9ja1tjaDAxXSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnZlcnRfcGFydGl0aW9uMnNjYWxlZmFjX2woZ2ZjLCBlYltjaG5dLCB0aHJbY2huXSwgY2huKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBTSE9SVCBCTE9DS1MgQ0FTRSAqL1xuICAgICAgICB7XG4gICAgICAgICAgICBmb3IgKHZhciBzYmxvY2sgPSAwOyBzYmxvY2sgPCAzOyBzYmxvY2srKykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGNobiA9IDA7IGNobiA8IG5fY2huX3BzeTsgKytjaG4pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoMDEgPSBjaG4gJiAweDAxO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2Vsb25nYmxvY2tbY2gwMV0gIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmJycHN5X3NraXBfbWFza2luZ19zKGdmYywgY2huLCBzYmxvY2spO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogY29tcHV0ZSBtYXNraW5nIHRocmVzaG9sZHMgZm9yIHNob3J0IGJsb2NrcyAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgd3NhbXBfcyA9IHdzYW1wX1M7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YnJwc3lfY29tcHV0ZV9mZnRfcyhnZnAsIGJ1ZmZlciwgYnVmUG9zLCBjaG4sIHNibG9jayxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmZnRlbmVyZ3lfcywgd3NhbXBfcywgY2gwMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YnJwc3lfY29tcHV0ZV9tYXNraW5nX3MoZ2ZwLCBmZnRlbmVyZ3lfcywgZWJbY2huXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJbY2huXSwgY2huLCBzYmxvY2spO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICgodXNlbG9uZ2Jsb2NrWzBdICsgdXNlbG9uZ2Jsb2NrWzFdKSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8qIE0vUyBjaGFubmVsICovXG4gICAgICAgICAgICAgICAgICAgIGlmIChnZnAubW9kZSA9PSBNUEVHTW9kZS5KT0lOVF9TVEVSRU8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZicnBzeV9jb21wdXRlX01TX3RocmVzaG9sZHMoZWIsIHRociwgZ2ZjLm1sZF9jYl9zLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdmYy5BVEguY2JfcywgZ2ZwLkFUSGxvd2VyICogZ2ZjLkFUSC5hZGp1c3QsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ZwLm1zZml4LCBnZmMubnBhcnRfcyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLyogTC9SIGNoYW5uZWwgKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLyogVE9ETzogYXBwbHkgYWRhcHRpdmUgQVRIIG1hc2tpbmcgaGVyZSA/PyAqL1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGNobiA9IDA7IGNobiA8IG5fY2huX3BzeTsgKytjaG4pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoMDEgPSBjaG4gJiAweDAxO1xuICAgICAgICAgICAgICAgICAgICBpZiAoMCA9PSB1c2Vsb25nYmxvY2tbY2gwMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnZlcnRfcGFydGl0aW9uMnNjYWxlZmFjX3MoZ2ZjLCBlYltjaG5dLCB0aHJbY2huXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaG4sIHNibG9jayk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qKioqIHNob3J0IGJsb2NrIHByZS1lY2hvIGNvbnRyb2wgKioqKi9cbiAgICAgICAgICAgIGZvciAodmFyIGNobiA9IDA7IGNobiA8IG5fY2huX3BzeTsgY2huKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgY2gwMSA9IGNobiAmIDB4MDE7XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlbG9uZ2Jsb2NrW2NoMDFdICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGZvciAodmFyIHNiID0gMDsgc2IgPCBFbmNvZGVyLlNCTUFYX3M7IHNiKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld190aG1tID0gbmV3X2Zsb2F0KDMpO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBzYmxvY2sgPSAwOyBzYmxvY2sgPCAzOyBzYmxvY2srKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRobW0gPSBnZmMudGhtW2Nobl0uc1tzYl1bc2Jsb2NrXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRobW0gKj0gTlNfUFJFRUNIT19BVFQwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobnNfYXR0YWNrc1tjaG5dW3NibG9ja10gPj0gMlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IG5zX2F0dGFja3NbY2huXVtzYmxvY2sgKyAxXSA9PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IChzYmxvY2sgIT0gMCkgPyBzYmxvY2sgLSAxIDogMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IE5TX0lOVEVSUChnZmMudGhtW2Nobl0uc1tzYl1baWR4XSwgdGhtbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlNfUFJFRUNIT19BVFQxICogcGNmYWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aG1tID0gTWF0aC5taW4odGhtbSwgcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5zX2F0dGFja3NbY2huXVtzYmxvY2tdID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gKHNibG9jayAhPSAwKSA/IHNibG9jayAtIDEgOiAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwID0gTlNfSU5URVJQKGdmYy50aG1bY2huXS5zW3NiXVtpZHhdLCB0aG1tLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOU19QUkVFQ0hPX0FUVDIgKiBwY2ZhY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRobW0gPSBNYXRoLm1pbih0aG1tLCBwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKHNibG9jayAhPSAwICYmIG5zX2F0dGFja3NbY2huXVtzYmxvY2sgLSAxXSA9PSAzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8IChzYmxvY2sgPT0gMCAmJiBnZmMubnNQc3kubGFzdEF0dGFja3NbY2huXSA9PSAzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSAoc2Jsb2NrICE9IDIpID8gc2Jsb2NrICsgMSA6IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBOU19JTlRFUlAoZ2ZjLnRobVtjaG5dLnNbc2JdW2lkeF0sIHRobW0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5TX1BSRUVDSE9fQVRUMiAqIHBjZmFjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhtbSA9IE1hdGgubWluKHRobW0sIHApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBwdWxzZSBsaWtlIHNpZ25hbCBkZXRlY3Rpb24gZm9yIGZhdGJveS53YXYgYW5kIHNvIG9uICovXG4gICAgICAgICAgICAgICAgICAgICAgICB0aG1tICo9IHN1Yl9zaG9ydF9mYWN0b3JbY2huXVtzYmxvY2tdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdfdGhtbVtzYmxvY2tdID0gdGhtbTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBzYmxvY2sgPSAwOyBzYmxvY2sgPCAzOyBzYmxvY2srKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2ZjLnRobVtjaG5dLnNbc2JdW3NibG9ja10gPSBuZXdfdGhtbVtzYmxvY2tdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGNobiA9IDA7IGNobiA8IG5fY2huX3BzeTsgY2huKyspIHtcbiAgICAgICAgICAgIGdmYy5uc1BzeS5sYXN0QXR0YWNrc1tjaG5dID0gbnNfYXR0YWNrc1tjaG5dWzJdO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBkZXRlcm1pbmUgZmluYWwgYmxvY2sgdHlwZVxuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICB2YnJwc3lfYXBwbHlfYmxvY2tfdHlwZShnZnAsIHVzZWxvbmdibG9jaywgYmxvY2t0eXBlX2QpO1xuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogY29tcHV0ZSB0aGUgdmFsdWUgb2YgUEUgdG8gcmV0dXJuIC4uLiBubyBkZWxheSBhbmQgYWR2YW5jZVxuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICBmb3IgKHZhciBjaG4gPSAwOyBjaG4gPCBuX2Nobl9wc3k7IGNobisrKSB7XG4gICAgICAgICAgICB2YXIgcHBlO1xuICAgICAgICAgICAgdmFyIHBwZVBvcztcbiAgICAgICAgICAgIHZhciB0eXBlO1xuICAgICAgICAgICAgdmFyIG1yO1xuXG4gICAgICAgICAgICBpZiAoY2huID4gMSkge1xuICAgICAgICAgICAgICAgIHBwZSA9IHBlcmNlcF9NU19lbnRyb3B5O1xuICAgICAgICAgICAgICAgIHBwZVBvcyA9IC0yO1xuICAgICAgICAgICAgICAgIHR5cGUgPSBFbmNvZGVyLk5PUk1fVFlQRTtcbiAgICAgICAgICAgICAgICBpZiAoYmxvY2t0eXBlX2RbMF0gPT0gRW5jb2Rlci5TSE9SVF9UWVBFXG4gICAgICAgICAgICAgICAgICAgIHx8IGJsb2NrdHlwZV9kWzFdID09IEVuY29kZXIuU0hPUlRfVFlQRSlcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9IEVuY29kZXIuU0hPUlRfVFlQRTtcbiAgICAgICAgICAgICAgICBtciA9IG1hc2tpbmdfTVNfcmF0aW9bZ3Jfb3V0XVtjaG4gLSAyXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcHBlID0gcGVyY2VwX2VudHJvcHk7XG4gICAgICAgICAgICAgICAgcHBlUG9zID0gMDtcbiAgICAgICAgICAgICAgICB0eXBlID0gYmxvY2t0eXBlX2RbY2huXTtcbiAgICAgICAgICAgICAgICBtciA9IG1hc2tpbmdfcmF0aW9bZ3Jfb3V0XVtjaG5dO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgICAgICBwcGVbcHBlUG9zICsgY2huXSA9IHBlY2FsY19zKG1yLCBnZmMubWFza2luZ19sb3dlcik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBwZVtwcGVQb3MgKyBjaG5dID0gcGVjYWxjX2wobXIsIGdmYy5tYXNraW5nX2xvd2VyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGdmcC5hbmFseXNpcykge1xuICAgICAgICAgICAgICAgIGdmYy5waW5mby5wZVtncl9vdXRdW2Nobl0gPSBwcGVbcHBlUG9zICsgY2huXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzM19mdW5jX3goYmFyaywgaGZfc2xvcGUpIHtcbiAgICAgICAgdmFyIHRlbXB4ID0gYmFyaywgdGVtcHk7XG5cbiAgICAgICAgaWYgKHRlbXB4ID49IDApIHtcbiAgICAgICAgICAgIHRlbXB5ID0gLXRlbXB4ICogMjc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0ZW1weSA9IHRlbXB4ICogaGZfc2xvcGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRlbXB5IDw9IC03Mi4wKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gTWF0aC5leHAodGVtcHkgKiBMTl9UT19MT0cxMCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbm9ybV9zM19mdW5jX3goaGZfc2xvcGUpIHtcbiAgICAgICAgdmFyIGxpbV9hID0gMCwgbGltX2IgPSAwO1xuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgeCA9IDAsIGwsIGg7XG4gICAgICAgICAgICBmb3IgKHggPSAwOyBzM19mdW5jX3goeCwgaGZfc2xvcGUpID4gMWUtMjA7IHggLT0gMSlcbiAgICAgICAgICAgICAgICA7XG4gICAgICAgICAgICBsID0geDtcbiAgICAgICAgICAgIGggPSAwO1xuICAgICAgICAgICAgd2hpbGUgKE1hdGguYWJzKGggLSBsKSA+IDFlLTEyKSB7XG4gICAgICAgICAgICAgICAgeCA9IChoICsgbCkgLyAyO1xuICAgICAgICAgICAgICAgIGlmIChzM19mdW5jX3goeCwgaGZfc2xvcGUpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBoID0geDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBsID0geDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsaW1fYSA9IGw7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIHggPSAwLCBsLCBoO1xuICAgICAgICAgICAgZm9yICh4ID0gMDsgczNfZnVuY194KHgsIGhmX3Nsb3BlKSA+IDFlLTIwOyB4ICs9IDEpXG4gICAgICAgICAgICAgICAgO1xuICAgICAgICAgICAgbCA9IDA7XG4gICAgICAgICAgICBoID0geDtcbiAgICAgICAgICAgIHdoaWxlIChNYXRoLmFicyhoIC0gbCkgPiAxZS0xMikge1xuICAgICAgICAgICAgICAgIHggPSAoaCArIGwpIC8gMjtcbiAgICAgICAgICAgICAgICBpZiAoczNfZnVuY194KHgsIGhmX3Nsb3BlKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbCA9IHg7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaCA9IHg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGltX2IgPSBoO1xuICAgICAgICB9XG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBzdW0gPSAwO1xuICAgICAgICAgICAgdmFyIG0gPSAxMDAwO1xuICAgICAgICAgICAgdmFyIGk7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDw9IG07ICsraSkge1xuICAgICAgICAgICAgICAgIHZhciB4ID0gbGltX2EgKyBpICogKGxpbV9iIC0gbGltX2EpIC8gbTtcbiAgICAgICAgICAgICAgICB2YXIgeSA9IHMzX2Z1bmNfeCh4LCBoZl9zbG9wZSk7XG4gICAgICAgICAgICAgICAgc3VtICs9IHk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIG5vcm0gPSAobSArIDEpIC8gKHN1bSAqIChsaW1fYiAtIGxpbV9hKSk7XG4gICAgICAgICAgICAgICAgLyogcHJpbnRmKCBcIm5vcm0gPSAlbGZcXG5cIixub3JtKTsgKi9cbiAgICAgICAgICAgICAgICByZXR1cm4gbm9ybTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqICAgVGhlIHNwcmVhZGluZyBmdW5jdGlvbi4gIFZhbHVlcyByZXR1cm5lZCBpbiB1bml0cyBvZiBlbmVyZ3lcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzM19mdW5jKGJhcmspIHtcbiAgICAgICAgdmFyIHRlbXB4LCB4LCB0ZW1weSwgdGVtcDtcbiAgICAgICAgdGVtcHggPSBiYXJrO1xuICAgICAgICBpZiAodGVtcHggPj0gMClcbiAgICAgICAgICAgIHRlbXB4ICo9IDM7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHRlbXB4ICo9IDEuNTtcblxuICAgICAgICBpZiAodGVtcHggPj0gMC41ICYmIHRlbXB4IDw9IDIuNSkge1xuICAgICAgICAgICAgdGVtcCA9IHRlbXB4IC0gMC41O1xuICAgICAgICAgICAgeCA9IDguMCAqICh0ZW1wICogdGVtcCAtIDIuMCAqIHRlbXApO1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgIHggPSAwLjA7XG4gICAgICAgIHRlbXB4ICs9IDAuNDc0O1xuICAgICAgICB0ZW1weSA9IDE1LjgxMTM4OSArIDcuNSAqIHRlbXB4IC0gMTcuNVxuICAgICAgICAgICAgKiBNYXRoLnNxcnQoMS4wICsgdGVtcHggKiB0ZW1weCk7XG5cbiAgICAgICAgaWYgKHRlbXB5IDw9IC02MC4wKVxuICAgICAgICAgICAgcmV0dXJuIDAuMDtcblxuICAgICAgICB0ZW1weCA9IE1hdGguZXhwKCh4ICsgdGVtcHkpICogTE5fVE9fTE9HMTApO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiA8UFJFPlxuICAgICAgICAgKiBOb3JtYWxpemF0aW9uLiAgVGhlIHNwcmVhZGluZyBmdW5jdGlvbiBzaG91bGQgYmUgbm9ybWFsaXplZCBzbyB0aGF0OlxuICAgICAgICAgKiAraW5mXG4gICAgICAgICAqIC9cbiAgICAgICAgICogfCAgczMgWyBiYXJrIF0gIGQoYmFyaykgICA9ICAxXG4gICAgICAgICAqIC9cbiAgICAgICAgICogLWluZlxuICAgICAgICAgKiA8L1BSRT5cbiAgICAgICAgICovXG4gICAgICAgIHRlbXB4IC89IC42NjA5MTkzO1xuICAgICAgICByZXR1cm4gdGVtcHg7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogc2VlIGZvciBleGFtcGxlIFwiWndpY2tlcjogUHN5Y2hvYWt1c3RpaywgMTk4MjsgSVNCTiAzLTU0MC0xMTQwMS03XG4gICAgICovXG4gICAgZnVuY3Rpb24gZnJlcTJiYXJrKGZyZXEpIHtcbiAgICAgICAgLyogaW5wdXQ6IGZyZXEgaW4gaHogb3V0cHV0OiBiYXJrcyAqL1xuICAgICAgICBpZiAoZnJlcSA8IDApXG4gICAgICAgICAgICBmcmVxID0gMDtcbiAgICAgICAgZnJlcSA9IGZyZXEgKiAwLjAwMTtcbiAgICAgICAgcmV0dXJuIDEzLjAgKiBNYXRoLmF0YW4oLjc2ICogZnJlcSkgKyAzLjVcbiAgICAgICAgICAgICogTWF0aC5hdGFuKGZyZXEgKiBmcmVxIC8gKDcuNSAqIDcuNSkpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXRfbnVtbGluZShudW1saW5lcywgYm8sIGJtLCBidmFsLCBidmFsX3dpZHRoLCBtbGQsIGJvX3csIHNmcmVxLCBibGtzaXplLCBzY2FsZXBvcywgZGVsdGFmcmVxLCBzYm1heCkge1xuICAgICAgICB2YXIgYl9mcnEgPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMgKyAxKTtcbiAgICAgICAgdmFyIHNhbXBsZV9mcmVxX2ZyYWMgPSBzZnJlcSAvIChzYm1heCA+IDE1ID8gMiAqIDU3NiA6IDIgKiAxOTIpO1xuICAgICAgICB2YXIgcGFydGl0aW9uID0gbmV3X2ludChFbmNvZGVyLkhCTEtTSVpFKTtcbiAgICAgICAgdmFyIGk7XG4gICAgICAgIHNmcmVxIC89IGJsa3NpemU7XG4gICAgICAgIHZhciBqID0gMDtcbiAgICAgICAgdmFyIG5pID0gMDtcbiAgICAgICAgLyogY29tcHV0ZSBudW1saW5lcywgdGhlIG51bWJlciBvZiBzcGVjdHJhbCBsaW5lcyBpbiBlYWNoIHBhcnRpdGlvbiBiYW5kICovXG4gICAgICAgIC8qIGVhY2ggcGFydGl0aW9uIGJhbmQgc2hvdWxkIGJlIGFib3V0IERFTEJBUksgd2lkZS4gKi9cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IEVuY29kZXIuQ0JBTkRTOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBiYXJrMTtcbiAgICAgICAgICAgIHZhciBqMjtcbiAgICAgICAgICAgIGJhcmsxID0gZnJlcTJiYXJrKHNmcmVxICogaik7XG5cbiAgICAgICAgICAgIGJfZnJxW2ldID0gc2ZyZXEgKiBqO1xuXG4gICAgICAgICAgICBmb3IgKGoyID0gajsgZnJlcTJiYXJrKHNmcmVxICogajIpIC0gYmFyazEgPCBERUxCQVJLXG4gICAgICAgICAgICAmJiBqMiA8PSBibGtzaXplIC8gMjsgajIrKylcbiAgICAgICAgICAgICAgICA7XG5cbiAgICAgICAgICAgIG51bWxpbmVzW2ldID0gajIgLSBqO1xuICAgICAgICAgICAgbmkgPSBpICsgMTtcblxuICAgICAgICAgICAgd2hpbGUgKGogPCBqMikge1xuICAgICAgICAgICAgICAgIHBhcnRpdGlvbltqKytdID0gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChqID4gYmxrc2l6ZSAvIDIpIHtcbiAgICAgICAgICAgICAgICBqID0gYmxrc2l6ZSAvIDI7XG4gICAgICAgICAgICAgICAgKytpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGJfZnJxW2ldID0gc2ZyZXEgKiBqO1xuXG4gICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IHNibWF4OyBzZmIrKykge1xuICAgICAgICAgICAgdmFyIGkxLCBpMiwgc3RhcnQsIGVuZDtcbiAgICAgICAgICAgIHZhciBhcmc7XG4gICAgICAgICAgICBzdGFydCA9IHNjYWxlcG9zW3NmYl07XG4gICAgICAgICAgICBlbmQgPSBzY2FsZXBvc1tzZmIgKyAxXTtcblxuICAgICAgICAgICAgaTEgPSAwIHwgTWF0aC5mbG9vciguNSArIGRlbHRhZnJlcSAqIChzdGFydCAtIC41KSk7XG4gICAgICAgICAgICBpZiAoaTEgPCAwKVxuICAgICAgICAgICAgICAgIGkxID0gMDtcbiAgICAgICAgICAgIGkyID0gMCB8IE1hdGguZmxvb3IoLjUgKyBkZWx0YWZyZXEgKiAoZW5kIC0gLjUpKTtcblxuICAgICAgICAgICAgaWYgKGkyID4gYmxrc2l6ZSAvIDIpXG4gICAgICAgICAgICAgICAgaTIgPSBibGtzaXplIC8gMjtcblxuICAgICAgICAgICAgYm1bc2ZiXSA9IChwYXJ0aXRpb25baTFdICsgcGFydGl0aW9uW2kyXSkgLyAyO1xuICAgICAgICAgICAgYm9bc2ZiXSA9IHBhcnRpdGlvbltpMl07XG4gICAgICAgICAgICB2YXIgZl90bXAgPSBzYW1wbGVfZnJlcV9mcmFjICogZW5kO1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIGNhbGN1bGF0ZSBob3cgbXVjaCBvZiB0aGlzIGJhbmQgYmVsb25ncyB0byBjdXJyZW50IHNjYWxlZmFjdG9yXG4gICAgICAgICAgICAgKiBiYW5kXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGJvX3dbc2ZiXSA9IChmX3RtcCAtIGJfZnJxW2JvW3NmYl1dKVxuICAgICAgICAgICAgICAgIC8gKGJfZnJxW2JvW3NmYl0gKyAxXSAtIGJfZnJxW2JvW3NmYl1dKTtcbiAgICAgICAgICAgIGlmIChib193W3NmYl0gPCAwKSB7XG4gICAgICAgICAgICAgICAgYm9fd1tzZmJdID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGJvX3dbc2ZiXSA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgYm9fd1tzZmJdID0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBzZXR1cCBzdGVyZW8gZGVtYXNraW5nIHRocmVzaG9sZHMgKi9cbiAgICAgICAgICAgIC8qIGZvcm11bGEgcmV2ZXJzZSBlbmdpbmVycmVkIGZyb20gcGxvdCBpbiBwYXBlciAqL1xuICAgICAgICAgICAgYXJnID0gZnJlcTJiYXJrKHNmcmVxICogc2NhbGVwb3Nbc2ZiXSAqIGRlbHRhZnJlcSk7XG4gICAgICAgICAgICBhcmcgPSAoIE1hdGgubWluKGFyZywgMTUuNSkgLyAxNS41KTtcblxuICAgICAgICAgICAgbWxkW3NmYl0gPSBNYXRoLnBvdygxMC4wLFxuICAgICAgICAgICAgICAgIDEuMjUgKiAoMSAtIE1hdGguY29zKE1hdGguUEkgKiBhcmcpKSAtIDIuNSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBjb21wdXRlIGJhcmsgdmFsdWVzIG9mIGVhY2ggY3JpdGljYWwgYmFuZCAqL1xuICAgICAgICBqID0gMDtcbiAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBuaTsgaysrKSB7XG4gICAgICAgICAgICB2YXIgdyA9IG51bWxpbmVzW2tdO1xuICAgICAgICAgICAgdmFyIGJhcmsxLCBiYXJrMjtcblxuICAgICAgICAgICAgYmFyazEgPSBmcmVxMmJhcmsoc2ZyZXEgKiAoaikpO1xuICAgICAgICAgICAgYmFyazIgPSBmcmVxMmJhcmsoc2ZyZXEgKiAoaiArIHcgLSAxKSk7XG4gICAgICAgICAgICBidmFsW2tdID0gLjUgKiAoYmFyazEgKyBiYXJrMik7XG5cbiAgICAgICAgICAgIGJhcmsxID0gZnJlcTJiYXJrKHNmcmVxICogKGogLSAuNSkpO1xuICAgICAgICAgICAgYmFyazIgPSBmcmVxMmJhcmsoc2ZyZXEgKiAoaiArIHcgLSAuNSkpO1xuICAgICAgICAgICAgYnZhbF93aWR0aFtrXSA9IGJhcmsyIC0gYmFyazE7XG4gICAgICAgICAgICBqICs9IHc7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbmk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5pdF9zM192YWx1ZXMoczNpbmQsIG5wYXJ0LCBidmFsLCBidmFsX3dpZHRoLCBub3JtLCB1c2Vfb2xkX3MzKSB7XG4gICAgICAgIHZhciBzMyA9IG5ld19mbG9hdF9uKFtFbmNvZGVyLkNCQU5EUywgRW5jb2Rlci5DQkFORFNdKTtcbiAgICAgICAgLypcbiAgICAgICAgICogVGhlIHMzIGFycmF5IGlzIG5vdCBsaW5lYXIgaW4gdGhlIGJhcmsgc2NhbGUuXG4gICAgICAgICAqXG4gICAgICAgICAqIGJ2YWxbeF0gc2hvdWxkIGJlIHVzZWQgdG8gZ2V0IHRoZSBiYXJrIHZhbHVlLlxuICAgICAgICAgKi9cbiAgICAgICAgdmFyIGo7XG4gICAgICAgIHZhciBudW1iZXJPZk5vbmVaZXJvID0gMDtcblxuICAgICAgICAvKipcbiAgICAgICAgICogPFBSRT5cbiAgICAgICAgICogc1tpXVtqXSwgdGhlIHZhbHVlIG9mIHRoZSBzcHJlYWRpbmcgZnVuY3Rpb24sXG4gICAgICAgICAqIGNlbnRlcmVkIGF0IGJhbmQgaiAobWFza2VyKSwgZm9yIGJhbmQgaSAobWFza2VlKVxuICAgICAgICAgKlxuICAgICAgICAgKiBpLmUuOiBzdW0gb3ZlciBqIHRvIHNwcmVhZCBpbnRvIHNpZ25hbCBiYXJrdmFsPWlcbiAgICAgICAgICogTk9URTogaSBhbmQgaiBhcmUgdXNlZCBvcHBvc2l0ZSBhcyBpbiB0aGUgSVNPIGRvY3NcbiAgICAgICAgICogPC9QUkU+XG4gICAgICAgICAqL1xuICAgICAgICBpZiAodXNlX29sZF9zMykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBucGFydDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IG5wYXJ0OyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHYgPSBzM19mdW5jKGJ2YWxbaV0gLSBidmFsW2pdKSAqIGJ2YWxfd2lkdGhbal07XG4gICAgICAgICAgICAgICAgICAgIHMzW2ldW2pdID0gdiAqIG5vcm1baV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IG5wYXJ0OyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgaGZfc2xvcGUgPSAxNSArIE1hdGgubWluKDIxIC8gYnZhbFtqXSwgMTIpO1xuICAgICAgICAgICAgICAgIHZhciBzM194X25vcm0gPSBub3JtX3MzX2Z1bmNfeChoZl9zbG9wZSk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBucGFydDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2ID0gczNfeF9ub3JtXG4gICAgICAgICAgICAgICAgICAgICAgICAqIHMzX2Z1bmNfeChidmFsW2ldIC0gYnZhbFtqXSwgaGZfc2xvcGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAqIGJ2YWxfd2lkdGhbal07XG4gICAgICAgICAgICAgICAgICAgIHMzW2ldW2pdID0gdiAqIG5vcm1baV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnBhcnQ7IGkrKykge1xuICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IG5wYXJ0OyBqKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoczNbaV1bal0gPiAwLjApXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgczNpbmRbaV1bMF0gPSBqO1xuXG4gICAgICAgICAgICBmb3IgKGogPSBucGFydCAtIDE7IGogPiAwOyBqLS0pIHtcbiAgICAgICAgICAgICAgICBpZiAoczNbaV1bal0gPiAwLjApXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgczNpbmRbaV1bMV0gPSBqO1xuICAgICAgICAgICAgbnVtYmVyT2ZOb25lWmVybyArPSAoczNpbmRbaV1bMV0gLSBzM2luZFtpXVswXSArIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHAgPSBuZXdfZmxvYXQobnVtYmVyT2ZOb25lWmVybyk7XG4gICAgICAgIHZhciBrID0gMDtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBucGFydDsgaSsrKVxuICAgICAgICAgICAgZm9yIChqID0gczNpbmRbaV1bMF07IGogPD0gczNpbmRbaV1bMV07IGorKylcbiAgICAgICAgICAgICAgICBwW2srK10gPSBzM1tpXVtqXTtcblxuICAgICAgICByZXR1cm4gcDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBzdGVyZW9fZGVtYXNrKGYpIHtcbiAgICAgICAgLyogc2V0dXAgc3RlcmVvIGRlbWFza2luZyB0aHJlc2hvbGRzICovXG4gICAgICAgIC8qIGZvcm11bGEgcmV2ZXJzZSBlbmdpbmVycmVkIGZyb20gcGxvdCBpbiBwYXBlciAqL1xuICAgICAgICB2YXIgYXJnID0gZnJlcTJiYXJrKGYpO1xuICAgICAgICBhcmcgPSAoTWF0aC5taW4oYXJnLCAxNS41KSAvIDE1LjUpO1xuXG4gICAgICAgIHJldHVybiBNYXRoLnBvdygxMC4wLFxuICAgICAgICAgICAgMS4yNSAqICgxIC0gTWF0aC5jb3MoTWF0aC5QSSAqIGFyZykpIC0gMi41KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBOT1RFOiB0aGUgYml0cmF0ZSByZWR1Y3Rpb24gZnJvbSB0aGUgaW50ZXItY2hhbm5lbCBtYXNraW5nIGVmZmVjdCBpcyBsb3dcbiAgICAgKiBjb21wYXJlZCB0byB0aGUgY2hhbmNlIG9mIGdldHRpbmcgYW5ueW9pbmcgYXJ0ZWZhY3RzLiBMM3BzeWNob19hbmFsX3ZiclxuICAgICAqIGRvZXMgbm90IHVzZSB0aGlzIGZlYXR1cmUuIChSb2JlcnQgMDcxMjE2KVxuICAgICAqL1xuICAgIHRoaXMucHN5bW9kZWxfaW5pdCA9IGZ1bmN0aW9uIChnZnApIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGk7XG4gICAgICAgIHZhciB1c2VPbGRTMyA9IHRydWU7XG4gICAgICAgIHZhciBidmxfYSA9IDEzLCBidmxfYiA9IDI0O1xuICAgICAgICB2YXIgc25yX2xfYSA9IDAsIHNucl9sX2IgPSAwO1xuICAgICAgICB2YXIgc25yX3NfYSA9IC04LjI1LCBzbnJfc19iID0gLTQuNTtcbiAgICAgICAgdmFyIGJ2YWwgPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMpO1xuICAgICAgICB2YXIgYnZhbF93aWR0aCA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyk7XG4gICAgICAgIHZhciBub3JtID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTKTtcbiAgICAgICAgdmFyIHNmcmVxID0gZ2ZwLm91dF9zYW1wbGVyYXRlO1xuXG4gICAgICAgIHN3aXRjaCAoZ2ZwLmV4cGVyaW1lbnRhbFopIHtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgdXNlT2xkUzMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHVzZU9sZFMzID0gKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfbXRyaCB8fCBnZnAuVkJSID09IFZick1vZGUudmJyX210KSA/IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIDogdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICB1c2VPbGRTMyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIGJ2bF9hID0gODtcbiAgICAgICAgICAgICAgICBzbnJfbF9hID0gLTEuNzU7XG4gICAgICAgICAgICAgICAgc25yX2xfYiA9IC0wLjAxMjU7XG4gICAgICAgICAgICAgICAgc25yX3NfYSA9IC04LjI1O1xuICAgICAgICAgICAgICAgIHNucl9zX2IgPSAtMi4yNTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBnZmMubXNfZW5lcl9yYXRpb19vbGQgPSAuMjU7XG4gICAgICAgIGdmYy5ibG9ja3R5cGVfb2xkWzBdID0gZ2ZjLmJsb2NrdHlwZV9vbGRbMV0gPSBFbmNvZGVyLk5PUk1fVFlQRTtcbiAgICAgICAgLy8gdGhlIHZiciBoZWFkZXIgaXMgbG9uZyBibG9ja3NcblxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgNDsgKytpKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IEVuY29kZXIuQ0JBTkRTOyArK2opIHtcbiAgICAgICAgICAgICAgICBnZmMubmJfMVtpXVtqXSA9IDFlMjA7XG4gICAgICAgICAgICAgICAgZ2ZjLm5iXzJbaV1bal0gPSAxZTIwO1xuICAgICAgICAgICAgICAgIGdmYy5uYl9zMVtpXVtqXSA9IGdmYy5uYl9zMltpXVtqXSA9IDEuMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIHNiID0gMDsgc2IgPCBFbmNvZGVyLlNCTUFYX2w7IHNiKyspIHtcbiAgICAgICAgICAgICAgICBnZmMuZW5baV0ubFtzYl0gPSAxZTIwO1xuICAgICAgICAgICAgICAgIGdmYy50aG1baV0ubFtzYl0gPSAxZTIwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCAzOyArK2opIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBzYiA9IDA7IHNiIDwgRW5jb2Rlci5TQk1BWF9zOyBzYisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGdmYy5lbltpXS5zW3NiXVtqXSA9IDFlMjA7XG4gICAgICAgICAgICAgICAgICAgIGdmYy50aG1baV0uc1tzYl1bal0gPSAxZTIwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBnZmMubnNQc3kubGFzdEF0dGFja3NbaV0gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA5OyBqKyspXG4gICAgICAgICAgICAgICAgZ2ZjLm5zUHN5Lmxhc3RfZW5fc3Vic2hvcnRbaV1bal0gPSAxMC47XG4gICAgICAgIH1cblxuICAgICAgICAvKiBpbml0LiBmb3IgbG91ZG5lc3MgYXBwcm94LiAtamQgMjAwMSBtYXIgMjcgKi9cbiAgICAgICAgZ2ZjLmxvdWRuZXNzX3NxX3NhdmVbMF0gPSBnZmMubG91ZG5lc3Nfc3Ffc2F2ZVsxXSA9IDAuMDtcblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBub3cgY29tcHV0ZSB0aGUgcHN5Y2hvYWNvdXN0aWMgbW9kZWwgc3BlY2lmaWMgY29uc3RhbnRzXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIC8qIGNvbXB1dGUgbnVtbGluZXMsIGJvLCBibSwgYnZhbCwgYnZhbF93aWR0aCwgbWxkICovXG5cbiAgICAgICAgZ2ZjLm5wYXJ0X2wgPSBpbml0X251bWxpbmUoZ2ZjLm51bWxpbmVzX2wsIGdmYy5ib19sLCBnZmMuYm1fbCwgYnZhbCxcbiAgICAgICAgICAgIGJ2YWxfd2lkdGgsIGdmYy5tbGRfbCwgZ2ZjLlBTWS5ib19sX3dlaWdodCwgc2ZyZXEsXG4gICAgICAgICAgICBFbmNvZGVyLkJMS1NJWkUsIGdmYy5zY2FsZWZhY19iYW5kLmwsIEVuY29kZXIuQkxLU0laRVxuICAgICAgICAgICAgLyAoMi4wICogNTc2KSwgRW5jb2Rlci5TQk1BWF9sKTtcbiAgICAgICAgLyogY29tcHV0ZSB0aGUgc3ByZWFkaW5nIGZ1bmN0aW9uICovXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBnZmMubnBhcnRfbDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgc25yID0gc25yX2xfYTtcbiAgICAgICAgICAgIGlmIChidmFsW2ldID49IGJ2bF9hKSB7XG4gICAgICAgICAgICAgICAgc25yID0gc25yX2xfYiAqIChidmFsW2ldIC0gYnZsX2EpIC8gKGJ2bF9iIC0gYnZsX2EpICsgc25yX2xfYVxuICAgICAgICAgICAgICAgICAgICAqIChidmxfYiAtIGJ2YWxbaV0pIC8gKGJ2bF9iIC0gYnZsX2EpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbm9ybVtpXSA9IE1hdGgucG93KDEwLjAsIHNuciAvIDEwLjApO1xuICAgICAgICAgICAgaWYgKGdmYy5udW1saW5lc19sW2ldID4gMCkge1xuICAgICAgICAgICAgICAgIGdmYy5ybnVtbGluZXNfbFtpXSA9IDEuMCAvIGdmYy5udW1saW5lc19sW2ldO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBnZmMucm51bWxpbmVzX2xbaV0gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGdmYy5zM19sbCA9IGluaXRfczNfdmFsdWVzKGdmYy5zM2luZCwgZ2ZjLm5wYXJ0X2wsIGJ2YWwsIGJ2YWxfd2lkdGgsXG4gICAgICAgICAgICBub3JtLCB1c2VPbGRTMyk7XG5cbiAgICAgICAgLyogY29tcHV0ZSBsb25nIGJsb2NrIHNwZWNpZmljIHZhbHVlcywgQVRIIGFuZCBNSU5WQUwgKi9cbiAgICAgICAgdmFyIGogPSAwO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZ2ZjLm5wYXJ0X2w7IGkrKykge1xuICAgICAgICAgICAgdmFyIHg7XG5cbiAgICAgICAgICAgIC8qIEFUSCAqL1xuICAgICAgICAgICAgeCA9IEZsb2F0Lk1BWF9WQUxVRTtcbiAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZ2ZjLm51bWxpbmVzX2xbaV07IGsrKywgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyZXEgPSBzZnJlcSAqIGogLyAoMTAwMC4wICogRW5jb2Rlci5CTEtTSVpFKTtcbiAgICAgICAgICAgICAgICB2YXIgbGV2ZWw7XG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBBVEggYmVsb3cgMTAwIEh6IGNvbnN0YW50LCBub3QgZnVydGhlciBjbGltYmluZ1xuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGxldmVsID0gdGhpcy5BVEhmb3JtdWxhKGZyZXEgKiAxMDAwLCBnZnApIC0gMjA7XG4gICAgICAgICAgICAgICAgLy8gc2NhbGUgdG8gRkZUIHVuaXRzOyByZXR1cm5lZCB2YWx1ZSBpcyBpbiBkQlxuICAgICAgICAgICAgICAgIGxldmVsID0gTWF0aC5wb3coMTAuLCAwLjEgKiBsZXZlbCk7XG4gICAgICAgICAgICAgICAgLy8gY29udmVydCBmcm9tIGRCIC4gZW5lcmd5XG4gICAgICAgICAgICAgICAgbGV2ZWwgKj0gZ2ZjLm51bWxpbmVzX2xbaV07XG4gICAgICAgICAgICAgICAgaWYgKHggPiBsZXZlbClcbiAgICAgICAgICAgICAgICAgICAgeCA9IGxldmVsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLkFUSC5jYl9sW2ldID0geDtcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIE1JTlZBTC4gRm9yIGxvdyBmcmVxLCB0aGUgc3RyZW5ndGggb2YgdGhlIG1hc2tpbmcgaXMgbGltaXRlZCBieVxuICAgICAgICAgICAgICogbWludmFsIHRoaXMgaXMgYW4gSVNPIE1QRUcxIHRoaW5nLCBkb250IGtub3cgaWYgaXQgaXMgcmVhbGx5XG4gICAgICAgICAgICAgKiBuZWVkZWRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIEZJWE1FOiBpdCBkb2VzIHdvcmsgdG8gcmVkdWNlIGxvdy1mcmVxIHByb2JsZW1zIGluIFM1My1XaW5kLVNheFxuICAgICAgICAgICAgICogYW5kIGxlYWQtdm9pY2Ugc2FtcGxlcywgYnV0IGludHJvZHVjZXMgc29tZSAzIGticHMgYml0IGJsb2F0IHRvby5cbiAgICAgICAgICAgICAqIFRPRE86IEZ1cnRoZXIgcmVmaW5lbWVudCBvZiB0aGUgc2hhcGUgb2YgdGhpcyBoYWNrLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB4ID0gLTIwICsgYnZhbFtpXSAqIDIwIC8gMTA7XG4gICAgICAgICAgICBpZiAoeCA+IDYpIHtcbiAgICAgICAgICAgICAgICB4ID0gMTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHggPCAtMTUpIHtcbiAgICAgICAgICAgICAgICB4ID0gLTE1O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeCAtPSA4LjtcbiAgICAgICAgICAgIGdmYy5taW52YWxfbFtpXSA9IChNYXRoLnBvdygxMC4wLCB4IC8gMTAuKSAqIGdmYy5udW1saW5lc19sW2ldKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogZG8gdGhlIHNhbWUgdGhpbmdzIGZvciBzaG9ydCBibG9ja3NcbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgZ2ZjLm5wYXJ0X3MgPSBpbml0X251bWxpbmUoZ2ZjLm51bWxpbmVzX3MsIGdmYy5ib19zLCBnZmMuYm1fcywgYnZhbCxcbiAgICAgICAgICAgIGJ2YWxfd2lkdGgsIGdmYy5tbGRfcywgZ2ZjLlBTWS5ib19zX3dlaWdodCwgc2ZyZXEsXG4gICAgICAgICAgICBFbmNvZGVyLkJMS1NJWkVfcywgZ2ZjLnNjYWxlZmFjX2JhbmQucywgRW5jb2Rlci5CTEtTSVpFX3NcbiAgICAgICAgICAgIC8gKDIuMCAqIDE5MiksIEVuY29kZXIuU0JNQVhfcyk7XG5cbiAgICAgICAgLyogU05SIGZvcm11bGEuIHNob3J0IGJsb2NrIGlzIG5vcm1hbGl6ZWQgYnkgU05SLiBpcyBpdCBzdGlsbCByaWdodCA/ICovXG4gICAgICAgIGogPSAwO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZ2ZjLm5wYXJ0X3M7IGkrKykge1xuICAgICAgICAgICAgdmFyIHg7XG4gICAgICAgICAgICB2YXIgc25yID0gc25yX3NfYTtcbiAgICAgICAgICAgIGlmIChidmFsW2ldID49IGJ2bF9hKSB7XG4gICAgICAgICAgICAgICAgc25yID0gc25yX3NfYiAqIChidmFsW2ldIC0gYnZsX2EpIC8gKGJ2bF9iIC0gYnZsX2EpICsgc25yX3NfYVxuICAgICAgICAgICAgICAgICAgICAqIChidmxfYiAtIGJ2YWxbaV0pIC8gKGJ2bF9iIC0gYnZsX2EpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbm9ybVtpXSA9IE1hdGgucG93KDEwLjAsIHNuciAvIDEwLjApO1xuXG4gICAgICAgICAgICAvKiBBVEggKi9cbiAgICAgICAgICAgIHggPSBGbG9hdC5NQVhfVkFMVUU7XG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGdmYy5udW1saW5lc19zW2ldOyBrKyssIGorKykge1xuICAgICAgICAgICAgICAgIHZhciBmcmVxID0gc2ZyZXEgKiBqIC8gKDEwMDAuMCAqIEVuY29kZXIuQkxLU0laRV9zKTtcbiAgICAgICAgICAgICAgICB2YXIgbGV2ZWw7XG4gICAgICAgICAgICAgICAgLyogZnJlcSA9IE1pbiguMSxmcmVxKTsgKi9cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIEFUSCBiZWxvdyAxMDAgSHogY29uc3RhbnQsIG5vdFxuICAgICAgICAgICAgICAgICAqIGZ1cnRoZXIgY2xpbWJpbmdcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBsZXZlbCA9IHRoaXMuQVRIZm9ybXVsYShmcmVxICogMTAwMCwgZ2ZwKSAtIDIwO1xuICAgICAgICAgICAgICAgIC8vIHNjYWxlIHRvIEZGVCB1bml0czsgcmV0dXJuZWQgdmFsdWUgaXMgaW4gZEJcbiAgICAgICAgICAgICAgICBsZXZlbCA9IE1hdGgucG93KDEwLiwgMC4xICogbGV2ZWwpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnZlcnQgZnJvbSBkQiAuIGVuZXJneVxuICAgICAgICAgICAgICAgIGxldmVsICo9IGdmYy5udW1saW5lc19zW2ldO1xuICAgICAgICAgICAgICAgIGlmICh4ID4gbGV2ZWwpXG4gICAgICAgICAgICAgICAgICAgIHggPSBsZXZlbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy5BVEguY2Jfc1tpXSA9IHg7XG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBNSU5WQUwuIEZvciBsb3cgZnJlcSwgdGhlIHN0cmVuZ3RoIG9mIHRoZSBtYXNraW5nIGlzIGxpbWl0ZWQgYnlcbiAgICAgICAgICAgICAqIG1pbnZhbCB0aGlzIGlzIGFuIElTTyBNUEVHMSB0aGluZywgZG9udCBrbm93IGlmIGl0IGlzIHJlYWxseVxuICAgICAgICAgICAgICogbmVlZGVkXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHggPSAoLTcuMCArIGJ2YWxbaV0gKiA3LjAgLyAxMi4wKTtcbiAgICAgICAgICAgIGlmIChidmFsW2ldID4gMTIpIHtcbiAgICAgICAgICAgICAgICB4ICo9IDEgKyBNYXRoLmxvZygxICsgeCkgKiAzLjE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYnZhbFtpXSA8IDEyKSB7XG4gICAgICAgICAgICAgICAgeCAqPSAxICsgTWF0aC5sb2coMSAtIHgpICogMi4zO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHggPCAtMTUpIHtcbiAgICAgICAgICAgICAgICB4ID0gLTE1O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeCAtPSA4O1xuICAgICAgICAgICAgZ2ZjLm1pbnZhbF9zW2ldID0gTWF0aC5wb3coMTAuMCwgeCAvIDEwKVxuICAgICAgICAgICAgICAgICogZ2ZjLm51bWxpbmVzX3NbaV07XG4gICAgICAgIH1cblxuICAgICAgICBnZmMuczNfc3MgPSBpbml0X3MzX3ZhbHVlcyhnZmMuczNpbmRfcywgZ2ZjLm5wYXJ0X3MsIGJ2YWwsIGJ2YWxfd2lkdGgsXG4gICAgICAgICAgICBub3JtLCB1c2VPbGRTMyk7XG5cbiAgICAgICAgaW5pdF9tYXNrX2FkZF9tYXhfdmFsdWVzKCk7XG4gICAgICAgIGZmdC5pbml0X2ZmdChnZmMpO1xuXG4gICAgICAgIC8qIHNldHVwIHRlbXBvcmFsIG1hc2tpbmcgKi9cbiAgICAgICAgZ2ZjLmRlY2F5ID0gTWF0aC5leHAoLTEuMCAqIExPRzEwXG4gICAgICAgICAgICAvICh0ZW1wb3JhbG1hc2tfc3VzdGFpbl9zZWMgKiBzZnJlcSAvIDE5Mi4wKSk7XG5cbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIG1zZml4O1xuICAgICAgICAgICAgbXNmaXggPSBOU19NU0ZJWDtcbiAgICAgICAgICAgIGlmICgoZ2ZwLmV4cF9uc3BzeXR1bmUgJiAyKSAhPSAwKVxuICAgICAgICAgICAgICAgIG1zZml4ID0gMS4wO1xuICAgICAgICAgICAgaWYgKE1hdGguYWJzKGdmcC5tc2ZpeCkgPiAwLjApXG4gICAgICAgICAgICAgICAgbXNmaXggPSBnZnAubXNmaXg7XG4gICAgICAgICAgICBnZnAubXNmaXggPSBtc2ZpeDtcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIHNwcmVhZCBvbmx5IGZyb20gbnBhcnRfbCBiYW5kcy4gTm9ybWFsbHksIHdlIHVzZSB0aGUgc3ByZWFkaW5nXG4gICAgICAgICAgICAgKiBmdW5jdGlvbiB0byBjb252b2x2ZSBmcm9tIG5wYXJ0X2wgZG93biB0byBucGFydF9sIGJhbmRzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZvciAodmFyIGIgPSAwOyBiIDwgZ2ZjLm5wYXJ0X2w7IGIrKylcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLnMzaW5kW2JdWzFdID4gZ2ZjLm5wYXJ0X2wgLSAxKVxuICAgICAgICAgICAgICAgICAgICBnZmMuczNpbmRbYl1bMV0gPSBnZmMubnBhcnRfbCAtIDE7XG4gICAgICAgIH1cblxuICAgICAgICAvKlxuICAgICAgICAgKiBwcmVwYXJlIGZvciBBVEggYXV0byBhZGp1c3RtZW50OiB3ZSB3YW50IHRvIGRlY3JlYXNlIHRoZSBBVEggYnkgMTIgZEJcbiAgICAgICAgICogcGVyIHNlY29uZFxuICAgICAgICAgKi9cbiAgICAgICAgdmFyIGZyYW1lX2R1cmF0aW9uID0gKDU3Ni4gKiBnZmMubW9kZV9nciAvIHNmcmVxKTtcbiAgICAgICAgZ2ZjLkFUSC5kZWNheSA9IE1hdGgucG93KDEwLiwgLTEyLiAvIDEwLiAqIGZyYW1lX2R1cmF0aW9uKTtcbiAgICAgICAgZ2ZjLkFUSC5hZGp1c3QgPSAwLjAxO1xuICAgICAgICAvKiBtaW5pbXVtLCBmb3IgbGVhZGluZyBsb3cgbG91ZG5lc3MgKi9cbiAgICAgICAgZ2ZjLkFUSC5hZGp1c3RMaW1pdCA9IDEuMDtcbiAgICAgICAgLyogb24gbGVhZCwgYWxsb3cgYWRqdXN0IHVwIHRvIG1heGltdW0gKi9cblxuXG4gICAgICAgIGlmIChnZnAuQVRIdHlwZSAhPSAtMSkge1xuICAgICAgICAgICAgLyogY29tcHV0ZSBlcXVhbCBsb3VkbmVzcyB3ZWlnaHRzIChlcWxfdykgKi9cbiAgICAgICAgICAgIHZhciBmcmVxO1xuICAgICAgICAgICAgdmFyIGZyZXFfaW5jID0gZ2ZwLm91dF9zYW1wbGVyYXRlXG4gICAgICAgICAgICAgICAgLyAoRW5jb2Rlci5CTEtTSVpFKTtcbiAgICAgICAgICAgIHZhciBlcWxfYmFsYW5jZSA9IDAuMDtcbiAgICAgICAgICAgIGZyZXEgPSAwLjA7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgRW5jb2Rlci5CTEtTSVpFIC8gMjsgKytpKSB7XG4gICAgICAgICAgICAgICAgLyogY29udmVydCBBVEggZEIgdG8gcmVsYXRpdmUgcG93ZXIgKG5vdCBkQikgKi9cbiAgICAgICAgICAgICAgICAvKiB0byBkZXRlcm1pbmUgZXFsX3cgKi9cbiAgICAgICAgICAgICAgICBmcmVxICs9IGZyZXFfaW5jO1xuICAgICAgICAgICAgICAgIGdmYy5BVEguZXFsX3dbaV0gPSAxLiAvIE1hdGgucG93KDEwLCB0aGlzLkFUSGZvcm11bGEoZnJlcSwgZ2ZwKSAvIDEwKTtcbiAgICAgICAgICAgICAgICBlcWxfYmFsYW5jZSArPSBnZmMuQVRILmVxbF93W2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZXFsX2JhbGFuY2UgPSAxLjAgLyBlcWxfYmFsYW5jZTtcbiAgICAgICAgICAgIGZvciAoaSA9IEVuY29kZXIuQkxLU0laRSAvIDI7IC0taSA+PSAwOykgeyAvKiBzY2FsZSB3ZWlnaHRzICovXG4gICAgICAgICAgICAgICAgZ2ZjLkFUSC5lcWxfd1tpXSAqPSBlcWxfYmFsYW5jZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB7XG4gICAgICAgICAgICBmb3IgKHZhciBiID0gaiA9IDA7IGIgPCBnZmMubnBhcnRfczsgKytiKSB7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGdmYy5udW1saW5lc19zW2JdOyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgKytqO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGIgPSBqID0gMDsgYiA8IGdmYy5ucGFydF9sOyArK2IpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZ2ZjLm51bWxpbmVzX2xbYl07ICsraSkge1xuICAgICAgICAgICAgICAgICAgICArK2o7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGogPSAwO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZ2ZjLm5wYXJ0X2w7IGkrKykge1xuICAgICAgICAgICAgdmFyIGZyZXEgPSBzZnJlcSAqIChqICsgZ2ZjLm51bWxpbmVzX2xbaV0gLyAyKSAvICgxLjAgKiBFbmNvZGVyLkJMS1NJWkUpO1xuICAgICAgICAgICAgZ2ZjLm1sZF9jYl9sW2ldID0gc3RlcmVvX2RlbWFzayhmcmVxKTtcbiAgICAgICAgICAgIGogKz0gZ2ZjLm51bWxpbmVzX2xbaV07XG4gICAgICAgIH1cbiAgICAgICAgZm9yICg7IGkgPCBFbmNvZGVyLkNCQU5EUzsgKytpKSB7XG4gICAgICAgICAgICBnZmMubWxkX2NiX2xbaV0gPSAxO1xuICAgICAgICB9XG4gICAgICAgIGogPSAwO1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZ2ZjLm5wYXJ0X3M7IGkrKykge1xuICAgICAgICAgICAgdmFyIGZyZXEgPSBzZnJlcSAqIChqICsgZ2ZjLm51bWxpbmVzX3NbaV0gLyAyKSAvICgxLjAgKiBFbmNvZGVyLkJMS1NJWkVfcyk7XG4gICAgICAgICAgICBnZmMubWxkX2NiX3NbaV0gPSBzdGVyZW9fZGVtYXNrKGZyZXEpO1xuICAgICAgICAgICAgaiArPSBnZmMubnVtbGluZXNfc1tpXTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKDsgaSA8IEVuY29kZXIuQ0JBTkRTOyArK2kpIHtcbiAgICAgICAgICAgIGdmYy5tbGRfY2Jfc1tpXSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhvc2UgQVRIIGZvcm11bGFzIGFyZSByZXR1cm5pbmcgdGhlaXIgbWluaW11bSB2YWx1ZSBmb3IgaW5wdXQgPSAtMVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIEFUSGZvcm11bGFfR0IoZiwgdmFsdWUpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIDxQUkU+XG4gICAgICAgICAqICBmcm9tIFBhaW50ZXIgJiBTcGFuaWFzXG4gICAgICAgICAqICAgICAgICAgICBtb2RpZmllZCBieSBHYWJyaWVsIEJvdXZpZ25lIHRvIGJldHRlciBmaXQgdGhlIHJlYWxpdHlcbiAgICAgICAgICogICAgICAgICAgIGF0aCA9ICAgIDMuNjQwICogcG93KGYsLTAuOClcbiAgICAgICAgICogICAgICAgICAgIC0gNi44MDAgKiBleHAoLTAuNipwb3coZi0zLjQsMi4wKSlcbiAgICAgICAgICogICAgICAgICAgICsgNi4wMDAgKiBleHAoLTAuMTUqcG93KGYtOC43LDIuMCkpXG4gICAgICAgICAqICAgICAgICAgICArIDAuNiogMC4wMDEgKiBwb3coZiw0LjApO1xuICAgICAgICAgKlxuICAgICAgICAgKlxuICAgICAgICAgKiAgICAgICAgICAgSW4gdGhlIHBhc3QgTEFNRSB3YXMgdXNpbmcgdGhlIFBhaW50ZXIgJlNwYW5pYXMgZm9ybXVsYS5cbiAgICAgICAgICogICAgICAgICAgIEJ1dCB3ZSBoYWQgc29tZSByZWN1cnJlbnQgcHJvYmxlbXMgd2l0aCBIRiBjb250ZW50LlxuICAgICAgICAgKiAgICAgICAgICAgV2UgbWVhc3VyZWQgcmVhbCBBVEggdmFsdWVzLCBhbmQgZm91bmQgdGhlIG9sZGVyIGZvcm11bGFcbiAgICAgICAgICogICAgICAgICAgIHRvIGJlIGluYWNjdXJhdGUgaW4gdGhlIGhpZ2hlciBwYXJ0LiBTbyB3ZSBtYWRlIHRoaXMgbmV3XG4gICAgICAgICAqICAgICAgICAgICBmb3JtdWxhIGFuZCB0aGlzIHNvbHZlZCBtb3N0IG9mIEhGIHByb2JsZW1hdGljIHRlc3QgY2FzZXMuXG4gICAgICAgICAqICAgICAgICAgICBUaGUgdHJhZGVvZmYgaXMgdGhhdCBpbiBWQlIgbW9kZSBpdCBpbmNyZWFzZXMgYSBsb3QgdGhlXG4gICAgICAgICAqICAgICAgICAgICBiaXRyYXRlLlxuICAgICAgICAgKiA8L1BSRT5cbiAgICAgICAgICovXG5cbiAgICAgICAgLypcbiAgICAgICAgICogVGhpcyBjdXJ2ZSBjYW4gYmUgYWRqdXN0ZWQgYWNjb3JkaW5nIHRvIHRoZSBWQlIgc2NhbGU6IGl0IGFkanVzdHNcbiAgICAgICAgICogZnJvbSBzb21ldGhpbmcgY2xvc2UgdG8gUGFpbnRlciAmIFNwYW5pYXMgb24gVjkgdXAgdG8gQm91dmlnbmUnc1xuICAgICAgICAgKiBmb3JtdWxhIGZvciBWMC4gVGhpcyB3YXkgdGhlIFZCUiBiaXRyYXRlIGlzIG1vcmUgYmFsYW5jZWQgYWNjb3JkaW5nXG4gICAgICAgICAqIHRvIHRoZSAtViB2YWx1ZS5cbiAgICAgICAgICovXG5cbiAgICAgICAgLy8gdGhlIGZvbGxvd2luZyBIYWNrIGFsbG93cyB0byBhc2sgZm9yIHRoZSBsb3dlc3QgdmFsdWVcbiAgICAgICAgaWYgKGYgPCAtLjMpXG4gICAgICAgICAgICBmID0gMzQxMDtcblxuICAgICAgICAvLyBjb252ZXJ0IHRvIGtoelxuICAgICAgICBmIC89IDEwMDA7XG4gICAgICAgIGYgPSBNYXRoLm1heCgwLjEsIGYpO1xuICAgICAgICB2YXIgYXRoID0gMy42NDAgKiBNYXRoLnBvdyhmLCAtMC44KSAtIDYuODAwXG4gICAgICAgICAgICAqIE1hdGguZXhwKC0wLjYgKiBNYXRoLnBvdyhmIC0gMy40LCAyLjApKSArIDYuMDAwXG4gICAgICAgICAgICAqIE1hdGguZXhwKC0wLjE1ICogTWF0aC5wb3coZiAtIDguNywgMi4wKSlcbiAgICAgICAgICAgICsgKDAuNiArIDAuMDQgKiB2YWx1ZSkgKiAwLjAwMSAqIE1hdGgucG93KGYsIDQuMCk7XG4gICAgICAgIHJldHVybiBhdGg7XG4gICAgfVxuXG4gICAgdGhpcy5BVEhmb3JtdWxhID0gZnVuY3Rpb24gKGYsIGdmcCkge1xuICAgICAgICB2YXIgYXRoO1xuICAgICAgICBzd2l0Y2ggKGdmcC5BVEh0eXBlKSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgYXRoID0gQVRIZm9ybXVsYV9HQihmLCA5KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAvLyBvdmVyIHNlbnNpdGl2ZSwgc2hvdWxkIHByb2JhYmx5IGJlIHJlbW92ZWRcbiAgICAgICAgICAgICAgICBhdGggPSBBVEhmb3JtdWxhX0dCKGYsIC0xKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICBhdGggPSBBVEhmb3JtdWxhX0dCKGYsIDApO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIC8vIG1vZGlmaWNhdGlvbiBvZiBHQiBmb3JtdWxhIGJ5IFJvZWxcbiAgICAgICAgICAgICAgICBhdGggPSBBVEhmb3JtdWxhX0dCKGYsIDEpICsgNjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICBhdGggPSBBVEhmb3JtdWxhX0dCKGYsIGdmcC5BVEhjdXJ2ZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGF0aCA9IEFUSGZvcm11bGFfR0IoZiwgMCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGF0aDtcbiAgICB9XG5cbn1cblxuXG5cbmZ1bmN0aW9uIExhbWUoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBMQU1FX01BWEFMQlVNQVJUID0gKDEyOCAqIDEwMjQpO1xuXG4gICAgTGFtZS5WOSA9IDQxMDtcbiAgICBMYW1lLlY4ID0gNDIwO1xuICAgIExhbWUuVjcgPSA0MzA7XG4gICAgTGFtZS5WNiA9IDQ0MDtcbiAgICBMYW1lLlY1ID0gNDUwO1xuICAgIExhbWUuVjQgPSA0NjA7XG4gICAgTGFtZS5WMyA9IDQ3MDtcbiAgICBMYW1lLlYyID0gNDgwO1xuICAgIExhbWUuVjEgPSA0OTA7XG4gICAgTGFtZS5WMCA9IDUwMDtcblxuICAgIC8qIHN0aWxsIHRoZXJlIGZvciBjb21wYXRpYmlsaXR5ICovXG5cbiAgICBMYW1lLlIzTUlYID0gMTAwMDtcbiAgICBMYW1lLlNUQU5EQVJEID0gMTAwMTtcbiAgICBMYW1lLkVYVFJFTUUgPSAxMDAyO1xuICAgIExhbWUuSU5TQU5FID0gMTAwMztcbiAgICBMYW1lLlNUQU5EQVJEX0ZBU1QgPSAxMDA0O1xuICAgIExhbWUuRVhUUkVNRV9GQVNUID0gMTAwNTtcbiAgICBMYW1lLk1FRElVTSA9IDEwMDY7XG4gICAgTGFtZS5NRURJVU1fRkFTVCA9IDEwMDc7XG5cbiAgICAvKipcbiAgICAgKiBtYXhpbXVtIHNpemUgb2YgbXAzYnVmZmVyIG5lZWRlZCBpZiB5b3UgZW5jb2RlIGF0IG1vc3QgMTE1MiBzYW1wbGVzIGZvclxuICAgICAqIGVhY2ggY2FsbCB0byBsYW1lX2VuY29kZV9idWZmZXIuIHNlZSBsYW1lX2VuY29kZV9idWZmZXIoKSBiZWxvd1xuICAgICAqIChMQU1FX01BWE1QM0JVRkZFUiBpcyBub3cgb2Jzb2xldGUpXG4gICAgICovXG4gICAgdmFyIExBTUVfTUFYTVAzQlVGRkVSID0gKDE2Mzg0ICsgTEFNRV9NQVhBTEJVTUFSVCk7XG4gICAgTGFtZS5MQU1FX01BWE1QM0JVRkZFUiA9IExBTUVfTUFYTVAzQlVGRkVSO1xuXG4gICAgdmFyIGdhO1xuICAgIHZhciBicztcbiAgICB2YXIgcDtcbiAgICB2YXIgcXVwdnQ7XG4gICAgdmFyIHF1O1xuICAgIHZhciBwc3kgPSBuZXcgUHN5TW9kZWwoKTtcbiAgICB2YXIgdmJyO1xuICAgIHZhciB2ZXI7XG4gICAgdmFyIGlkMztcbiAgICB2YXIgbXBnbGliO1xuICAgIHRoaXMuZW5jID0gbmV3IEVuY29kZXIoKTtcblxuICAgIHRoaXMuc2V0TW9kdWxlcyA9IGZ1bmN0aW9uIChfZ2EsIF9icywgX3AsIF9xdXB2dCwgX3F1LCBfdmJyLCBfdmVyLCBfaWQzLCBfbXBnbGliKSB7XG4gICAgICAgIGdhID0gX2dhO1xuICAgICAgICBicyA9IF9icztcbiAgICAgICAgcCA9IF9wO1xuICAgICAgICBxdXB2dCA9IF9xdXB2dDtcbiAgICAgICAgcXUgPSBfcXU7XG4gICAgICAgIHZiciA9IF92YnI7XG4gICAgICAgIHZlciA9IF92ZXI7XG4gICAgICAgIGlkMyA9IF9pZDM7XG4gICAgICAgIG1wZ2xpYiA9IF9tcGdsaWI7XG4gICAgICAgIHRoaXMuZW5jLnNldE1vZHVsZXMoYnMsIHBzeSwgcXVwdnQsIHZicik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUFNZIE1vZGVsIHJlbGF0ZWQgc3R1ZmZcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBQU1koKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgZGJRIHN0dWZmLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tYXNrX2FkanVzdCA9IDAuO1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGRiUSBzdHVmZi5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubWFza19hZGp1c3Rfc2hvcnQgPSAwLjtcbiAgICAgICAgLyogYXQgdHJhbnNpdGlvbiBmcm9tIG9uZSBzY2FsZWZhY3RvciBiYW5kIHRvIG5leHQgKi9cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEJhbmQgd2VpZ2h0IGxvbmcgc2NhbGVmYWN0b3IgYmFuZHMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJvX2xfd2VpZ2h0ID0gbmV3X2Zsb2F0KEVuY29kZXIuU0JNQVhfbCk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBCYW5kIHdlaWdodCBzaG9ydCBzY2FsZWZhY3RvciBiYW5kcy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYm9fc193ZWlnaHQgPSBuZXdfZmxvYXQoRW5jb2Rlci5TQk1BWF9zKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBMb3dQYXNzSGlnaFBhc3MoKSB7XG4gICAgICAgIHRoaXMubG93ZXJsaW1pdCA9IDAuO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIEJhbmRQYXNzKGJpdHJhdGUsIGxQYXNzKSB7XG4gICAgICAgIHRoaXMubG93cGFzcyA9IGxQYXNzO1xuICAgIH1cblxuICAgIHZhciBMQU1FX0lEID0gMHhGRkY4OEUzQjtcblxuICAgIGZ1bmN0aW9uIGxhbWVfaW5pdF9vbGQoZ2ZwKSB7XG4gICAgICAgIHZhciBnZmM7XG5cbiAgICAgICAgZ2ZwLmNsYXNzX2lkID0gTEFNRV9JRDtcblxuICAgICAgICBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3MgPSBuZXcgTGFtZUludGVybmFsRmxhZ3MoKTtcblxuICAgICAgICAvKiBHbG9iYWwgZmxhZ3MuIHNldCBkZWZhdWx0cyBoZXJlIGZvciBub24temVybyB2YWx1ZXMgKi9cbiAgICAgICAgLyogc2VlIGxhbWUuaCBmb3IgZGVzY3JpcHRpb24gKi9cbiAgICAgICAgLypcbiAgICAgICAgICogc2V0IGludGVnZXIgdmFsdWVzIHRvIC0xIHRvIG1lYW4gdGhhdCBMQU1FIHdpbGwgY29tcHV0ZSB0aGUgYmVzdFxuICAgICAgICAgKiB2YWx1ZSwgVU5MRVNTIHRoZSBjYWxsaW5nIHByb2dyYW0gYXMgc2V0IGl0IChhbmQgdGhlIHZhbHVlIGlzIG5vXG4gICAgICAgICAqIGxvbmdlciAtMSlcbiAgICAgICAgICovXG5cbiAgICAgICAgZ2ZwLm1vZGUgPSBNUEVHTW9kZS5OT1RfU0VUO1xuICAgICAgICBnZnAub3JpZ2luYWwgPSAxO1xuICAgICAgICBnZnAuaW5fc2FtcGxlcmF0ZSA9IDQ0MTAwO1xuICAgICAgICBnZnAubnVtX2NoYW5uZWxzID0gMjtcbiAgICAgICAgZ2ZwLm51bV9zYW1wbGVzID0gLTE7XG5cbiAgICAgICAgZ2ZwLmJXcml0ZVZiclRhZyA9IHRydWU7XG4gICAgICAgIGdmcC5xdWFsaXR5ID0gLTE7XG4gICAgICAgIGdmcC5zaG9ydF9ibG9ja3MgPSBudWxsO1xuICAgICAgICBnZmMuc3ViYmxvY2tfZ2FpbiA9IC0xO1xuXG4gICAgICAgIGdmcC5sb3dwYXNzZnJlcSA9IDA7XG4gICAgICAgIGdmcC5oaWdocGFzc2ZyZXEgPSAwO1xuICAgICAgICBnZnAubG93cGFzc3dpZHRoID0gLTE7XG4gICAgICAgIGdmcC5oaWdocGFzc3dpZHRoID0gLTE7XG5cbiAgICAgICAgZ2ZwLlZCUiA9IFZick1vZGUudmJyX29mZjtcbiAgICAgICAgZ2ZwLlZCUl9xID0gNDtcbiAgICAgICAgZ2ZwLkFUSGN1cnZlID0gLTE7XG4gICAgICAgIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMgPSAxMjg7XG4gICAgICAgIGdmcC5WQlJfbWluX2JpdHJhdGVfa2JwcyA9IDA7XG4gICAgICAgIGdmcC5WQlJfbWF4X2JpdHJhdGVfa2JwcyA9IDA7XG4gICAgICAgIGdmcC5WQlJfaGFyZF9taW4gPSAwO1xuICAgICAgICBnZmMuVkJSX21pbl9iaXRyYXRlID0gMTtcbiAgICAgICAgLyogbm90IDAgPz8/Pz8gKi9cbiAgICAgICAgZ2ZjLlZCUl9tYXhfYml0cmF0ZSA9IDEzO1xuICAgICAgICAvKiBub3QgMTQgPz8/Pz8gKi9cblxuICAgICAgICBnZnAucXVhbnRfY29tcCA9IC0xO1xuICAgICAgICBnZnAucXVhbnRfY29tcF9zaG9ydCA9IC0xO1xuXG4gICAgICAgIGdmcC5tc2ZpeCA9IC0xO1xuXG4gICAgICAgIGdmYy5yZXNhbXBsZV9yYXRpbyA9IDE7XG5cbiAgICAgICAgZ2ZjLk9sZFZhbHVlWzBdID0gMTgwO1xuICAgICAgICBnZmMuT2xkVmFsdWVbMV0gPSAxODA7XG4gICAgICAgIGdmYy5DdXJyZW50U3RlcFswXSA9IDQ7XG4gICAgICAgIGdmYy5DdXJyZW50U3RlcFsxXSA9IDQ7XG4gICAgICAgIGdmYy5tYXNraW5nX2xvd2VyID0gMTtcbiAgICAgICAgZ2ZjLm5zUHN5LmF0dGFja3RocmUgPSAtMTtcbiAgICAgICAgZ2ZjLm5zUHN5LmF0dGFja3RocmVfcyA9IC0xO1xuXG4gICAgICAgIGdmcC5zY2FsZSA9IC0xO1xuXG4gICAgICAgIGdmcC5hdGhhYV90eXBlID0gLTE7XG4gICAgICAgIGdmcC5BVEh0eXBlID0gLTE7XG4gICAgICAgIC8qIGRlZmF1bHQgPSAtMSA9IHNldCBpbiBsYW1lX2luaXRfcGFyYW1zICovXG4gICAgICAgIGdmcC5hdGhhYV9sb3VkYXBwcm94ID0gLTE7XG4gICAgICAgIC8qIDEgPSBmbGF0IGxvdWRuZXNzIGFwcHJveC4gKHRvdGFsIGVuZXJneSkgKi9cbiAgICAgICAgLyogMiA9IGVxdWFsIGxvdWRuZXNzIGN1cnZlICovXG4gICAgICAgIGdmcC5hdGhhYV9zZW5zaXRpdml0eSA9IDAuMDtcbiAgICAgICAgLyogbm8gb2Zmc2V0ICovXG4gICAgICAgIGdmcC51c2VUZW1wb3JhbCA9IG51bGw7XG4gICAgICAgIGdmcC5pbnRlckNoUmF0aW8gPSAtMTtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBUaGUgcmVhc29uIGZvciBpbnQgbWZfc2FtcGxlc190b19lbmNvZGUgPSBFTkNERUxBWSArIFBPU1RERUxBWTtcbiAgICAgICAgICogRU5DREVMQVkgPSBpbnRlcm5hbCBlbmNvZGVyIGRlbGF5LiBBbmQgdGhlbiB3ZSBoYXZlIHRvIGFkZFxuICAgICAgICAgKiBQT1NUREVMQVk9Mjg4IGJlY2F1c2Ugb2YgdGhlIDUwJSBNRENUIG92ZXJsYXAuIEEgNTc2IE1EQ1QgZ3JhbnVsZVxuICAgICAgICAgKiBkZWNvZGVzIHRvIDExNTIgc2FtcGxlcy4gVG8gc3ludGhlc2l6ZSB0aGUgNTc2IHNhbXBsZXMgY2VudGVyZWQgdW5kZXJcbiAgICAgICAgICogdGhpcyBncmFudWxlIHdlIG5lZWQgdGhlIHByZXZpb3VzIGdyYW51bGUgZm9yIHRoZSBmaXJzdCAyODggc2FtcGxlc1xuICAgICAgICAgKiAobm8gcHJvYmxlbSksIGFuZCB0aGUgbmV4dCBncmFudWxlIGZvciB0aGUgbmV4dCAyODggc2FtcGxlcyAobm90XG4gICAgICAgICAqIHBvc3NpYmxlIGlmIHRoaXMgaXMgbGFzdCBncmFudWxlKS4gU28gd2UgbmVlZCB0byBwYWQgd2l0aCAyODggc2FtcGxlc1xuICAgICAgICAgKiB0byBtYWtlIHN1cmUgd2UgY2FuIGVuY29kZSB0aGUgNTc2IHNhbXBsZXMgd2UgYXJlIGludGVyZXN0ZWQgaW4uXG4gICAgICAgICAqL1xuICAgICAgICBnZmMubWZfc2FtcGxlc190b19lbmNvZGUgPSBFbmNvZGVyLkVOQ0RFTEFZICsgRW5jb2Rlci5QT1NUREVMQVk7XG4gICAgICAgIGdmcC5lbmNvZGVyX3BhZGRpbmcgPSAwO1xuICAgICAgICBnZmMubWZfc2l6ZSA9IEVuY29kZXIuRU5DREVMQVkgLSBFbmNvZGVyLk1EQ1RERUxBWTtcbiAgICAgICAgLypcbiAgICAgICAgICogd2UgcGFkIGlucHV0IHdpdGggdGhpcyBtYW55IDAnc1xuICAgICAgICAgKi9cblxuICAgICAgICBnZnAuZmluZFJlcGxheUdhaW4gPSBmYWxzZTtcbiAgICAgICAgZ2ZwLmRlY29kZV9vbl90aGVfZmx5ID0gZmFsc2U7XG5cbiAgICAgICAgZ2ZjLmRlY29kZV9vbl90aGVfZmx5ID0gZmFsc2U7XG4gICAgICAgIGdmYy5maW5kUmVwbGF5R2FpbiA9IGZhbHNlO1xuICAgICAgICBnZmMuZmluZFBlYWtTYW1wbGUgPSBmYWxzZTtcblxuICAgICAgICBnZmMuUmFkaW9HYWluID0gMDtcbiAgICAgICAgZ2ZjLkF1ZGlvcGhpbGVHYWluID0gMDtcbiAgICAgICAgZ2ZjLm5vY2xpcEdhaW5DaGFuZ2UgPSAwO1xuICAgICAgICBnZmMubm9jbGlwU2NhbGUgPSAtMS4wO1xuXG4gICAgICAgIGdmcC5wcmVzZXQgPSAwO1xuXG4gICAgICAgIGdmcC53cml0ZV9pZDN0YWdfYXV0b21hdGljID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgdGhpcy5sYW1lX2luaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBnZnAgPSBuZXcgTGFtZUdsb2JhbEZsYWdzKCk7XG5cbiAgICAgICAgdmFyIHJldCA9IGxhbWVfaW5pdF9vbGQoZ2ZwKTtcbiAgICAgICAgaWYgKHJldCAhPSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIGdmcC5sYW1lX2FsbG9jYXRlZF9nZnAgPSAxO1xuICAgICAgICByZXR1cm4gZ2ZwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZpbHRlcl9jb2VmKHgpIHtcbiAgICAgICAgaWYgKHggPiAxLjApXG4gICAgICAgICAgICByZXR1cm4gMC4wO1xuICAgICAgICBpZiAoeCA8PSAwLjApXG4gICAgICAgICAgICByZXR1cm4gMS4wO1xuXG4gICAgICAgIHJldHVybiBNYXRoLmNvcyhNYXRoLlBJIC8gMiAqIHgpO1xuICAgIH1cblxuICAgIHRoaXMubmVhcmVzdEJpdHJhdGVGdWxsSW5kZXggPSBmdW5jdGlvbiAoYml0cmF0ZSkge1xuICAgICAgICAvKiBib3Jyb3dlZCBmcm9tIERNIGFiciBwcmVzZXRzICovXG5cbiAgICAgICAgdmFyIGZ1bGxfYml0cmF0ZV90YWJsZSA9IFs4LCAxNiwgMjQsIDMyLCA0MCwgNDgsIDU2LCA2NCwgODAsXG4gICAgICAgICAgICA5NiwgMTEyLCAxMjgsIDE2MCwgMTkyLCAyMjQsIDI1NiwgMzIwXTtcblxuICAgICAgICB2YXIgbG93ZXJfcmFuZ2UgPSAwLCBsb3dlcl9yYW5nZV9rYnBzID0gMCwgdXBwZXJfcmFuZ2UgPSAwLCB1cHBlcl9yYW5nZV9rYnBzID0gMDtcblxuICAgICAgICAvKiBXZSBhc3N1bWUgc3BlY2lmaWVkIGJpdHJhdGUgd2lsbCBiZSAzMjBrYnBzICovXG4gICAgICAgIHVwcGVyX3JhbmdlX2ticHMgPSBmdWxsX2JpdHJhdGVfdGFibGVbMTZdO1xuICAgICAgICB1cHBlcl9yYW5nZSA9IDE2O1xuICAgICAgICBsb3dlcl9yYW5nZV9rYnBzID0gZnVsbF9iaXRyYXRlX3RhYmxlWzE2XTtcbiAgICAgICAgbG93ZXJfcmFuZ2UgPSAxNjtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBEZXRlcm1pbmUgd2hpY2ggc2lnbmlmaWNhbnQgYml0cmF0ZXMgdGhlIHZhbHVlIHNwZWNpZmllZCBmYWxsc1xuICAgICAgICAgKiBiZXR3ZWVuLCBpZiBsb29wIGVuZHMgd2l0aG91dCBicmVha2luZyB0aGVuIHdlIHdlcmUgY29ycmVjdCBhYm92ZVxuICAgICAgICAgKiB0aGF0IHRoZSB2YWx1ZSB3YXMgMzIwXG4gICAgICAgICAqL1xuICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IDE2OyBiKyspIHtcbiAgICAgICAgICAgIGlmICgoTWF0aC5tYXgoYml0cmF0ZSwgZnVsbF9iaXRyYXRlX3RhYmxlW2IgKyAxXSkpICE9IGJpdHJhdGUpIHtcbiAgICAgICAgICAgICAgICB1cHBlcl9yYW5nZV9rYnBzID0gZnVsbF9iaXRyYXRlX3RhYmxlW2IgKyAxXTtcbiAgICAgICAgICAgICAgICB1cHBlcl9yYW5nZSA9IGIgKyAxO1xuICAgICAgICAgICAgICAgIGxvd2VyX3JhbmdlX2ticHMgPSBmdWxsX2JpdHJhdGVfdGFibGVbYl07XG4gICAgICAgICAgICAgICAgbG93ZXJfcmFuZ2UgPSAoYik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgLyogV2UgZm91bmQgdXBwZXIgcmFuZ2UgKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIERldGVybWluZSB3aGljaCByYW5nZSB0aGUgdmFsdWUgc3BlY2lmaWVkIGlzIGNsb3NlciB0byAqL1xuICAgICAgICBpZiAoKHVwcGVyX3JhbmdlX2ticHMgLSBiaXRyYXRlKSA+IChiaXRyYXRlIC0gbG93ZXJfcmFuZ2Vfa2JwcykpIHtcbiAgICAgICAgICAgIHJldHVybiBsb3dlcl9yYW5nZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdXBwZXJfcmFuZ2U7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb3B0aW11bV9zYW1wbGVmcmVxKGxvd3Bhc3NmcmVxLCBpbnB1dF9zYW1wbGVmcmVxKSB7XG4gICAgICAgIC8qXG4gICAgICAgICAqIFJ1bGVzOlxuICAgICAgICAgKlxuICAgICAgICAgKiAtIGlmIHBvc3NpYmxlLCBzZmIyMSBzaG91bGQgTk9UIGJlIHVzZWRcbiAgICAgICAgICovXG4gICAgICAgIHZhciBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDQ0MTAwO1xuXG4gICAgICAgIGlmIChpbnB1dF9zYW1wbGVmcmVxID49IDQ4MDAwKVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSA0ODAwMDtcbiAgICAgICAgZWxzZSBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+PSA0NDEwMClcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gNDQxMDA7XG4gICAgICAgIGVsc2UgaWYgKGlucHV0X3NhbXBsZWZyZXEgPj0gMzIwMDApXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDMyMDAwO1xuICAgICAgICBlbHNlIGlmIChpbnB1dF9zYW1wbGVmcmVxID49IDI0MDAwKVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSAyNDAwMDtcbiAgICAgICAgZWxzZSBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+PSAyMjA1MClcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gMjIwNTA7XG4gICAgICAgIGVsc2UgaWYgKGlucHV0X3NhbXBsZWZyZXEgPj0gMTYwMDApXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDE2MDAwO1xuICAgICAgICBlbHNlIGlmIChpbnB1dF9zYW1wbGVmcmVxID49IDEyMDAwKVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSAxMjAwMDtcbiAgICAgICAgZWxzZSBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+PSAxMTAyNSlcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gMTEwMjU7XG4gICAgICAgIGVsc2UgaWYgKGlucHV0X3NhbXBsZWZyZXEgPj0gODAwMClcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gODAwMDtcblxuICAgICAgICBpZiAobG93cGFzc2ZyZXEgPT0gLTEpXG4gICAgICAgICAgICByZXR1cm4gc3VnZ2VzdGVkX3NhbXBsZWZyZXE7XG5cbiAgICAgICAgaWYgKGxvd3Bhc3NmcmVxIDw9IDE1OTYwKVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSA0NDEwMDtcbiAgICAgICAgaWYgKGxvd3Bhc3NmcmVxIDw9IDE1MjUwKVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSAzMjAwMDtcbiAgICAgICAgaWYgKGxvd3Bhc3NmcmVxIDw9IDExMjIwKVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSAyNDAwMDtcbiAgICAgICAgaWYgKGxvd3Bhc3NmcmVxIDw9IDk5NzApXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDIyMDUwO1xuICAgICAgICBpZiAobG93cGFzc2ZyZXEgPD0gNzIzMClcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gMTYwMDA7XG4gICAgICAgIGlmIChsb3dwYXNzZnJlcSA8PSA1NDIwKVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSAxMjAwMDtcbiAgICAgICAgaWYgKGxvd3Bhc3NmcmVxIDw9IDQ1MTApXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDExMDI1O1xuICAgICAgICBpZiAobG93cGFzc2ZyZXEgPD0gMzk3MClcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gODAwMDtcblxuICAgICAgICBpZiAoaW5wdXRfc2FtcGxlZnJlcSA8IHN1Z2dlc3RlZF9zYW1wbGVmcmVxKSB7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogY2hvb3NlIGEgdmFsaWQgTVBFRyBzYW1wbGUgZnJlcXVlbmN5IGFib3ZlIHRoZSBpbnB1dCBzYW1wbGVcbiAgICAgICAgICAgICAqIGZyZXF1ZW5jeSB0byBhdm9pZCBTRkIyMS8xMiBiaXRyYXRlIGJsb2F0IHJoIDA2MTExNVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+IDQ0MTAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDQ4MDAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlucHV0X3NhbXBsZWZyZXEgPiAzMjAwMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiA0NDEwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbnB1dF9zYW1wbGVmcmVxID4gMjQwMDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMzIwMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+IDIyMDUwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDI0MDAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlucHV0X3NhbXBsZWZyZXEgPiAxNjAwMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAyMjA1MDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbnB1dF9zYW1wbGVmcmVxID4gMTIwMDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTYwMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+IDExMDI1KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDEyMDAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlucHV0X3NhbXBsZWZyZXEgPiA4MDAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDExMDI1O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIDgwMDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN1Z2dlc3RlZF9zYW1wbGVmcmVxO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNvbnZlcnQgc2FtcCBmcmVxIGluIEh6IHRvIGluZGV4XG4gICAgICovXG4gICAgZnVuY3Rpb24gU21wRnJxSW5kZXgoc2FtcGxlX2ZyZXEsIGdwZikge1xuICAgICAgICBzd2l0Y2ggKHNhbXBsZV9mcmVxKSB7XG4gICAgICAgICAgICBjYXNlIDQ0MTAwOlxuICAgICAgICAgICAgICAgIGdwZi52ZXJzaW9uID0gMTtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgNDgwMDA6XG4gICAgICAgICAgICAgICAgZ3BmLnZlcnNpb24gPSAxO1xuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgY2FzZSAzMjAwMDpcbiAgICAgICAgICAgICAgICBncGYudmVyc2lvbiA9IDE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7XG4gICAgICAgICAgICBjYXNlIDIyMDUwOlxuICAgICAgICAgICAgICAgIGdwZi52ZXJzaW9uID0gMDtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgMjQwMDA6XG4gICAgICAgICAgICAgICAgZ3BmLnZlcnNpb24gPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgY2FzZSAxNjAwMDpcbiAgICAgICAgICAgICAgICBncGYudmVyc2lvbiA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7XG4gICAgICAgICAgICBjYXNlIDExMDI1OlxuICAgICAgICAgICAgICAgIGdwZi52ZXJzaW9uID0gMDtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIGNhc2UgMTIwMDA6XG4gICAgICAgICAgICAgICAgZ3BmLnZlcnNpb24gPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgY2FzZSA4MDAwOlxuICAgICAgICAgICAgICAgIGdwZi52ZXJzaW9uID0gMDtcbiAgICAgICAgICAgICAgICByZXR1cm4gMjtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgZ3BmLnZlcnNpb24gPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSBiUmF0ZVxuICAgICAqICAgICAgICAgICAgbGVnYWwgcmF0ZXMgZnJvbSA4IHRvIDMyMFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIEZpbmROZWFyZXN0Qml0cmF0ZShiUmF0ZSwgdmVyc2lvbiwgc2FtcGxlcmF0ZSkge1xuICAgICAgICAvKiBNUEVHLTEgb3IgTVBFRy0yIExTRiAqL1xuICAgICAgICBpZiAoc2FtcGxlcmF0ZSA8IDE2MDAwKVxuICAgICAgICAgICAgdmVyc2lvbiA9IDI7XG5cbiAgICAgICAgdmFyIGJpdHJhdGUgPSBUYWJsZXMuYml0cmF0ZV90YWJsZVt2ZXJzaW9uXVsxXTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMjsgaSA8PSAxNDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoVGFibGVzLmJpdHJhdGVfdGFibGVbdmVyc2lvbl1baV0gPiAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKFRhYmxlcy5iaXRyYXRlX3RhYmxlW3ZlcnNpb25dW2ldIC0gYlJhdGUpIDwgTWF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgLmFicyhiaXRyYXRlIC0gYlJhdGUpKVxuICAgICAgICAgICAgICAgICAgICBiaXRyYXRlID0gVGFibGVzLmJpdHJhdGVfdGFibGVbdmVyc2lvbl1baV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGJpdHJhdGU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIGJSYXRlXG4gICAgICogICAgICAgICAgICBsZWdhbCByYXRlcyBmcm9tIDMyIHRvIDQ0OCBrYnBzXG4gICAgICogQHBhcmFtIHZlcnNpb25cbiAgICAgKiAgICAgICAgICAgIE1QRUctMSBvciBNUEVHLTIvMi41IExTRlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIEJpdHJhdGVJbmRleChiUmF0ZSwgdmVyc2lvbiwgc2FtcGxlcmF0ZSkge1xuICAgICAgICAvKiBjb252ZXJ0IGJpdHJhdGUgaW4ga2JwcyB0byBpbmRleCAqL1xuICAgICAgICBpZiAoc2FtcGxlcmF0ZSA8IDE2MDAwKVxuICAgICAgICAgICAgdmVyc2lvbiA9IDI7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IDE0OyBpKyspIHtcbiAgICAgICAgICAgIGlmIChUYWJsZXMuYml0cmF0ZV90YWJsZVt2ZXJzaW9uXVtpXSA+IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoVGFibGVzLmJpdHJhdGVfdGFibGVbdmVyc2lvbl1baV0gPT0gYlJhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAtMTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvcHRpbXVtX2JhbmR3aWR0aChsaCwgYml0cmF0ZSkge1xuICAgICAgICAvKipcbiAgICAgICAgICogPFBSRT5cbiAgICAgICAgICogIElucHV0OlxuICAgICAgICAgKiAgICAgIGJpdHJhdGUgICAgIHRvdGFsIGJpdHJhdGUgaW4ga2Jwc1xuICAgICAgICAgKlxuICAgICAgICAgKiAgIE91dHB1dDpcbiAgICAgICAgICogICAgICBsb3dlcmxpbWl0OiBiZXN0IGxvd3Bhc3MgZnJlcXVlbmN5IGxpbWl0IGZvciBpbnB1dCBmaWx0ZXIgaW4gSHpcbiAgICAgICAgICogICAgICB1cHBlcmxpbWl0OiBiZXN0IGhpZ2hwYXNzIGZyZXF1ZW5jeSBsaW1pdCBmb3IgaW5wdXQgZmlsdGVyIGluIEh6XG4gICAgICAgICAqIDwvUFJFPlxuICAgICAgICAgKi9cbiAgICAgICAgdmFyIGZyZXFfbWFwID0gW25ldyBCYW5kUGFzcyg4LCAyMDAwKSxcbiAgICAgICAgICAgIG5ldyBCYW5kUGFzcygxNiwgMzcwMCksIG5ldyBCYW5kUGFzcygyNCwgMzkwMCksXG4gICAgICAgICAgICBuZXcgQmFuZFBhc3MoMzIsIDU1MDApLCBuZXcgQmFuZFBhc3MoNDAsIDcwMDApLFxuICAgICAgICAgICAgbmV3IEJhbmRQYXNzKDQ4LCA3NTAwKSwgbmV3IEJhbmRQYXNzKDU2LCAxMDAwMCksXG4gICAgICAgICAgICBuZXcgQmFuZFBhc3MoNjQsIDExMDAwKSwgbmV3IEJhbmRQYXNzKDgwLCAxMzUwMCksXG4gICAgICAgICAgICBuZXcgQmFuZFBhc3MoOTYsIDE1MTAwKSwgbmV3IEJhbmRQYXNzKDExMiwgMTU2MDApLFxuICAgICAgICAgICAgbmV3IEJhbmRQYXNzKDEyOCwgMTcwMDApLCBuZXcgQmFuZFBhc3MoMTYwLCAxNzUwMCksXG4gICAgICAgICAgICBuZXcgQmFuZFBhc3MoMTkyLCAxODYwMCksIG5ldyBCYW5kUGFzcygyMjQsIDE5NDAwKSxcbiAgICAgICAgICAgIG5ldyBCYW5kUGFzcygyNTYsIDE5NzAwKSwgbmV3IEJhbmRQYXNzKDMyMCwgMjA1MDApXTtcblxuICAgICAgICB2YXIgdGFibGVfaW5kZXggPSBzZWxmLm5lYXJlc3RCaXRyYXRlRnVsbEluZGV4KGJpdHJhdGUpO1xuICAgICAgICBsaC5sb3dlcmxpbWl0ID0gZnJlcV9tYXBbdGFibGVfaW5kZXhdLmxvd3Bhc3M7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGFtZV9pbml0X3BhcmFtc19wcGZsdChnZnApIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgLyogY29tcHV0ZSBpbmZvIG5lZWRlZCBmb3IgcG9seXBoYXNlIGZpbHRlciAoZmlsdGVyIHR5cGU9PTAsIGRlZmF1bHQpICovXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgdmFyIGxvd3Bhc3NfYmFuZCA9IDMyO1xuICAgICAgICB2YXIgaGlnaHBhc3NfYmFuZCA9IC0xO1xuXG4gICAgICAgIGlmIChnZmMubG93cGFzczEgPiAwKSB7XG4gICAgICAgICAgICB2YXIgbWluYmFuZCA9IDk5OTtcbiAgICAgICAgICAgIGZvciAodmFyIGJhbmQgPSAwOyBiYW5kIDw9IDMxOyBiYW5kKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJlcSA9IChiYW5kIC8gMzEuMCk7XG4gICAgICAgICAgICAgICAgLyogdGhpcyBiYW5kIGFuZCBhYm92ZSB3aWxsIGJlIHplcm9lZDogKi9cbiAgICAgICAgICAgICAgICBpZiAoZnJlcSA+PSBnZmMubG93cGFzczIpIHtcbiAgICAgICAgICAgICAgICAgICAgbG93cGFzc19iYW5kID0gTWF0aC5taW4obG93cGFzc19iYW5kLCBiYW5kKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5sb3dwYXNzMSA8IGZyZXEgJiYgZnJlcSA8IGdmYy5sb3dwYXNzMikge1xuICAgICAgICAgICAgICAgICAgICBtaW5iYW5kID0gTWF0aC5taW4obWluYmFuZCwgYmFuZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogY29tcHV0ZSB0aGUgKmFjdHVhbCogdHJhbnNpdGlvbiBiYW5kIGltcGxlbWVudGVkIGJ5IHRoZSBwb2x5cGhhc2VcbiAgICAgICAgICAgICAqIGZpbHRlclxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAobWluYmFuZCA9PSA5OTkpIHtcbiAgICAgICAgICAgICAgICBnZmMubG93cGFzczEgPSAobG93cGFzc19iYW5kIC0gLjc1KSAvIDMxLjA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGdmYy5sb3dwYXNzMSA9IChtaW5iYW5kIC0gLjc1KSAvIDMxLjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMubG93cGFzczIgPSBsb3dwYXNzX2JhbmQgLyAzMS4wO1xuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgICogbWFrZSBzdXJlIGhpZ2hwYXNzIGZpbHRlciBpcyB3aXRoaW4gOTAlIG9mIHdoYXQgdGhlIGVmZmVjdGl2ZVxuICAgICAgICAgKiBoaWdocGFzcyBmcmVxdWVuY3kgd2lsbCBiZVxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGdmYy5oaWdocGFzczIgPiAwKSB7XG4gICAgICAgICAgICBpZiAoZ2ZjLmhpZ2hwYXNzMiA8IC45ICogKC43NSAvIDMxLjApKSB7XG4gICAgICAgICAgICAgICAgZ2ZjLmhpZ2hwYXNzMSA9IDA7XG4gICAgICAgICAgICAgICAgZ2ZjLmhpZ2hwYXNzMiA9IDA7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiV2FybmluZzogaGlnaHBhc3MgZmlsdGVyIGRpc2FibGVkLiAgXCJcbiAgICAgICAgICAgICAgICAgICAgKyBcImhpZ2hwYXNzIGZyZXF1ZW5jeSB0b28gc21hbGxcXG5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ2ZjLmhpZ2hwYXNzMiA+IDApIHtcbiAgICAgICAgICAgIHZhciBtYXhiYW5kID0gLTE7XG4gICAgICAgICAgICBmb3IgKHZhciBiYW5kID0gMDsgYmFuZCA8PSAzMTsgYmFuZCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyZXEgPSBiYW5kIC8gMzEuMDtcbiAgICAgICAgICAgICAgICAvKiB0aGlzIGJhbmQgYW5kIGJlbG93IHdpbGwgYmUgemVyZW9kICovXG4gICAgICAgICAgICAgICAgaWYgKGZyZXEgPD0gZ2ZjLmhpZ2hwYXNzMSkge1xuICAgICAgICAgICAgICAgICAgICBoaWdocGFzc19iYW5kID0gTWF0aC5tYXgoaGlnaHBhc3NfYmFuZCwgYmFuZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnZmMuaGlnaHBhc3MxIDwgZnJlcSAmJiBmcmVxIDwgZ2ZjLmhpZ2hwYXNzMikge1xuICAgICAgICAgICAgICAgICAgICBtYXhiYW5kID0gTWF0aC5tYXgobWF4YmFuZCwgYmFuZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIGNvbXB1dGUgdGhlICphY3R1YWwqIHRyYW5zaXRpb24gYmFuZCBpbXBsZW1lbnRlZCBieSB0aGUgcG9seXBoYXNlXG4gICAgICAgICAgICAgKiBmaWx0ZXJcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZ2ZjLmhpZ2hwYXNzMSA9IGhpZ2hwYXNzX2JhbmQgLyAzMS4wO1xuICAgICAgICAgICAgaWYgKG1heGJhbmQgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBnZmMuaGlnaHBhc3MyID0gKGhpZ2hwYXNzX2JhbmQgKyAuNzUpIC8gMzEuMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZ2ZjLmhpZ2hwYXNzMiA9IChtYXhiYW5kICsgLjc1KSAvIDMxLjA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBiYW5kID0gMDsgYmFuZCA8IDMyOyBiYW5kKyspIHtcbiAgICAgICAgICAgIHZhciBmYzEsIGZjMjtcbiAgICAgICAgICAgIHZhciBmcmVxID0gYmFuZCAvIDMxLjA7XG4gICAgICAgICAgICBpZiAoZ2ZjLmhpZ2hwYXNzMiA+IGdmYy5oaWdocGFzczEpIHtcbiAgICAgICAgICAgICAgICBmYzEgPSBmaWx0ZXJfY29lZigoZ2ZjLmhpZ2hwYXNzMiAtIGZyZXEpXG4gICAgICAgICAgICAgICAgICAgIC8gKGdmYy5oaWdocGFzczIgLSBnZmMuaGlnaHBhc3MxICsgMWUtMjApKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZmMxID0gMS4wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGdmYy5sb3dwYXNzMiA+IGdmYy5sb3dwYXNzMSkge1xuICAgICAgICAgICAgICAgIGZjMiA9IGZpbHRlcl9jb2VmKChmcmVxIC0gZ2ZjLmxvd3Bhc3MxKVxuICAgICAgICAgICAgICAgICAgICAvIChnZmMubG93cGFzczIgLSBnZmMubG93cGFzczEgKyAxZS0yMCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmYzIgPSAxLjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMuYW1wX2ZpbHRlcltiYW5kXSA9IChmYzEgKiBmYzIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGFtZV9pbml0X3F2YWwoZ2ZwKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cbiAgICAgICAgc3dpdGNoIChnZnAucXVhbGl0eSkge1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGNhc2UgOTogLyogbm8gcHN5bW9kZWwsIG5vIG5vaXNlIHNoYXBpbmcgKi9cbiAgICAgICAgICAgICAgICBnZmMucHN5bW9kZWwgPSAwO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nID0gMDtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19hbXAgPSAwO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX3N0b3AgPSAwO1xuICAgICAgICAgICAgICAgIGdmYy51c2VfYmVzdF9odWZmbWFuID0gMDtcbiAgICAgICAgICAgICAgICBnZmMuZnVsbF9vdXRlcl9sb29wID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgIGdmcC5xdWFsaXR5ID0gNztcbiAgICAgICAgICAgIC8vJEZBTEwtVEhST1VHSCRcbiAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIHVzZSBwc3ltb2RlbCAoZm9yIHNob3J0IGJsb2NrIGFuZCBtL3Mgc3dpdGNoaW5nKSwgYnV0IG5vIG5vaXNlXG4gICAgICAgICAgICAgICAgICogc2hhcHBpbmdcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBnZmMucHN5bW9kZWwgPSAxO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nID0gMDtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19hbXAgPSAwO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX3N0b3AgPSAwO1xuICAgICAgICAgICAgICAgIGdmYy51c2VfYmVzdF9odWZmbWFuID0gMDtcbiAgICAgICAgICAgICAgICBnZmMuZnVsbF9vdXRlcl9sb29wID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSA2OlxuICAgICAgICAgICAgICAgIGdmYy5wc3ltb2RlbCA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5ub2lzZV9zaGFwaW5nID09IDApXG4gICAgICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nID0gMTtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19hbXAgPSAwO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX3N0b3AgPSAwO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuc3ViYmxvY2tfZ2FpbiA9PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnN1YmJsb2NrX2dhaW4gPSAxO1xuICAgICAgICAgICAgICAgIGdmYy51c2VfYmVzdF9odWZmbWFuID0gMDtcbiAgICAgICAgICAgICAgICBnZmMuZnVsbF9vdXRlcl9sb29wID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgIGdmYy5wc3ltb2RlbCA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5ub2lzZV9zaGFwaW5nID09IDApXG4gICAgICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nID0gMTtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19hbXAgPSAwO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX3N0b3AgPSAwO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuc3ViYmxvY2tfZ2FpbiA9PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnN1YmJsb2NrX2dhaW4gPSAxO1xuICAgICAgICAgICAgICAgIGdmYy51c2VfYmVzdF9odWZmbWFuID0gMDtcbiAgICAgICAgICAgICAgICBnZmMuZnVsbF9vdXRlcl9sb29wID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgIGdmYy5wc3ltb2RlbCA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5ub2lzZV9zaGFwaW5nID09IDApXG4gICAgICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nID0gMTtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19hbXAgPSAwO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX3N0b3AgPSAwO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuc3ViYmxvY2tfZ2FpbiA9PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnN1YmJsb2NrX2dhaW4gPSAxO1xuICAgICAgICAgICAgICAgIGdmYy51c2VfYmVzdF9odWZmbWFuID0gMTtcbiAgICAgICAgICAgICAgICBnZmMuZnVsbF9vdXRlcl9sb29wID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIGdmYy5wc3ltb2RlbCA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5ub2lzZV9zaGFwaW5nID09IDApXG4gICAgICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nID0gMTtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19hbXAgPSAxO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX3N0b3AgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuc3ViYmxvY2tfZ2FpbiA9PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnN1YmJsb2NrX2dhaW4gPSAxO1xuICAgICAgICAgICAgICAgIGdmYy51c2VfYmVzdF9odWZmbWFuID0gMTtcbiAgICAgICAgICAgICAgICBnZmMuZnVsbF9vdXRlcl9sb29wID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIGdmYy5wc3ltb2RlbCA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5ub2lzZV9zaGFwaW5nID09IDApXG4gICAgICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nID0gMTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLnN1YnN0ZXBfc2hhcGluZyA9PSAwKVxuICAgICAgICAgICAgICAgICAgICBnZmMuc3Vic3RlcF9zaGFwaW5nID0gMjtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19hbXAgPSAxO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX3N0b3AgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuc3ViYmxvY2tfZ2FpbiA9PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnN1YmJsb2NrX2dhaW4gPSAxO1xuICAgICAgICAgICAgICAgIGdmYy51c2VfYmVzdF9odWZmbWFuID0gMTtcbiAgICAgICAgICAgICAgICAvKiBpbm5lciBsb29wICovXG4gICAgICAgICAgICAgICAgZ2ZjLmZ1bGxfb3V0ZXJfbG9vcCA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICBnZmMucHN5bW9kZWwgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChnZmMubm9pc2Vfc2hhcGluZyA9PSAwKVxuICAgICAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZyA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5zdWJzdGVwX3NoYXBpbmcgPT0gMClcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnN1YnN0ZXBfc2hhcGluZyA9IDI7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfYW1wID0gMjtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19zdG9wID0gMTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLnN1YmJsb2NrX2dhaW4gPT0gLTEpXG4gICAgICAgICAgICAgICAgICAgIGdmYy5zdWJibG9ja19nYWluID0gMTtcbiAgICAgICAgICAgICAgICBnZmMudXNlX2Jlc3RfaHVmZm1hbiA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLmZ1bGxfb3V0ZXJfbG9vcCA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBnZmMucHN5bW9kZWwgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChnZmMubm9pc2Vfc2hhcGluZyA9PSAwKVxuICAgICAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZyA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5zdWJzdGVwX3NoYXBpbmcgPT0gMClcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnN1YnN0ZXBfc2hhcGluZyA9IDI7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfYW1wID0gMjtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19zdG9wID0gMTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLnN1YmJsb2NrX2dhaW4gPT0gLTEpXG4gICAgICAgICAgICAgICAgICAgIGdmYy5zdWJibG9ja19nYWluID0gMTtcbiAgICAgICAgICAgICAgICBnZmMudXNlX2Jlc3RfaHVmZm1hbiA9IDE7XG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiB0eXBlIDIgZGlzYWJsZWQgYmVjYXVzZSBvZiBpdCBzbG93bmVzcywgaW4gZmF2b3Igb2YgZnVsbCBvdXRlclxuICAgICAgICAgICAgICAgICAqIGxvb3Agc2VhcmNoXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZ2ZjLmZ1bGxfb3V0ZXJfbG9vcCA9IDA7XG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBmdWxsIG91dGVyIGxvb3Agc2VhcmNoIGRpc2FibGVkIGJlY2F1c2Ugb2YgYXVkaWJsZSBkaXN0b3J0aW9ucyBpdFxuICAgICAgICAgICAgICAgICAqIG1heSBnZW5lcmF0ZSByaCAwNjA2MjlcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGFtZV9pbml0X2JpdHN0cmVhbShnZnApIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgZ2ZwLmZyYW1lTnVtID0gMDtcblxuICAgICAgICBpZiAoZ2ZwLndyaXRlX2lkM3RhZ19hdXRvbWF0aWMpIHtcbiAgICAgICAgICAgIGlkMy5pZDN0YWdfd3JpdGVfdjIoZ2ZwKTtcbiAgICAgICAgfVxuICAgICAgICAvKiBpbml0aWFsaXplIGhpc3RvZ3JhbSBkYXRhIG9wdGlvbmFsbHkgdXNlZCBieSBmcm9udGVuZCAqL1xuXG4gICAgICAgIGdmYy5iaXRyYXRlX3N0ZXJlb01vZGVfSGlzdCA9IG5ld19pbnRfbihbMTYsIDQgKyAxXSk7XG4gICAgICAgIGdmYy5iaXRyYXRlX2Jsb2NrVHlwZV9IaXN0ID0gbmV3X2ludF9uKFsxNiwgNCArIDEgKyAxXSk7XG5cbiAgICAgICAgZ2ZjLlBlYWtTYW1wbGUgPSAwLjA7XG5cbiAgICAgICAgLyogV3JpdGUgaW5pdGlhbCBWQlIgSGVhZGVyIHRvIGJpdHN0cmVhbSBhbmQgaW5pdCBWQlIgZGF0YSAqL1xuICAgICAgICBpZiAoZ2ZwLmJXcml0ZVZiclRhZylcbiAgICAgICAgICAgIHZici5Jbml0VmJyVGFnKGdmcCk7XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICogaW5pdGlhbGl6ZSBpbnRlcm5hbCBwYXJhbXMgYmFzZWQgb24gZGF0YSBpbiBnZiAoZ2xvYmFsZmxhZ3Mgc3RydWN0IGZpbGxlZFxuICAgICAqIGluIGJ5IGNhbGxpbmcgcHJvZ3JhbSlcbiAgICAgKlxuICAgICAqIE9VVExJTkU6XG4gICAgICpcbiAgICAgKiBXZSBmaXJzdCBoYXZlIHNvbWUgY29tcGxleCBjb2RlIHRvIGRldGVybWluZSBiaXRyYXRlLCBvdXRwdXQgc2FtcGxlcmF0ZVxuICAgICAqIGFuZCBtb2RlLiBJdCBpcyBjb21wbGljYXRlZCBieSB0aGUgZmFjdCB0aGF0IHdlIGFsbG93IHRoZSB1c2VyIHRvIHNldFxuICAgICAqIHNvbWUgb3IgYWxsIG9mIHRoZXNlIHBhcmFtZXRlcnMsIGFuZCBuZWVkIHRvIGRldGVybWluZSBiZXN0IHBvc3NpYmxlXG4gICAgICogdmFsdWVzIGZvciB0aGUgcmVzdCBvZiB0aGVtOlxuICAgICAqXG4gICAgICogMS4gc2V0IHNvbWUgQ1BVIHJlbGF0ZWQgZmxhZ3MgMi4gY2hlY2sgaWYgd2UgYXJlIG1vbm8ubW9ubywgc3RlcmVvLm1vbm9cbiAgICAgKiBvciBzdGVyZW8uc3RlcmVvIDMuIGNvbXB1dGUgYml0cmF0ZSBhbmQgb3V0cHV0IHNhbXBsZXJhdGU6IHVzZXIgbWF5IGhhdmVcbiAgICAgKiBzZXQgY29tcHJlc3Npb24gcmF0aW8gdXNlciBtYXkgaGF2ZSBzZXQgYSBiaXRyYXRlIHVzZXIgbWF5IGhhdmUgc2V0IGFcbiAgICAgKiBvdXRwdXQgc2FtcGxlcmF0ZSA0LiBzZXQgc29tZSBvcHRpb25zIHdoaWNoIGRlcGVuZCBvbiBvdXRwdXQgc2FtcGxlcmF0ZVxuICAgICAqIDUuIGNvbXB1dGUgdGhlIGFjdHVhbCBjb21wcmVzc2lvbiByYXRpbyA2LiBzZXQgbW9kZSBiYXNlZCBvbiBjb21wcmVzc2lvblxuICAgICAqIHJhdGlvXG4gICAgICpcbiAgICAgKiBUaGUgcmVtYWluaW5nIGNvZGUgaXMgbXVjaCBzaW1wbGVyIC0gaXQganVzdCBzZXRzIG9wdGlvbnMgYmFzZWQgb24gdGhlXG4gICAgICogbW9kZSAmIGNvbXByZXNzaW9uIHJhdGlvOlxuICAgICAqXG4gICAgICogc2V0IGFsbG93X2RpZmZfc2hvcnQgYmFzZWQgb24gbW9kZSBzZWxlY3QgbG93cGFzcyBmaWx0ZXIgYmFzZWQgb25cbiAgICAgKiBjb21wcmVzc2lvbiByYXRpbyAmIG1vZGUgc2V0IHRoZSBiaXRyYXRlIGluZGV4LCBhbmQgbWluL21heCBiaXRyYXRlcyBmb3JcbiAgICAgKiBWQlIgbW9kZXMgZGlzYWJsZSBWQlIgdGFnIGlmIGl0IGlzIG5vdCBhcHByb3ByaWF0ZSBpbml0aWFsaXplIHRoZVxuICAgICAqIGJpdHN0cmVhbSBpbml0aWFsaXplIHNjYWxlZmFjX2JhbmQgZGF0YSBzZXQgc2lkZWluZm9fbGVuIChiYXNlZCBvblxuICAgICAqIGNoYW5uZWxzLCBDUkMsIG91dF9zYW1wbGVyYXRlKSB3cml0ZSBhbiBpZDN2MiB0YWcgaW50byB0aGUgYml0c3RyZWFtXG4gICAgICogd3JpdGUgVkJSIHRhZyBpbnRvIHRoZSBiaXRzdHJlYW0gc2V0IG1wZWcxLzIgZmxhZyBlc3RpbWF0ZSB0aGUgbnVtYmVyIG9mXG4gICAgICogZnJhbWVzIChiYXNlZCBvbiBhIGxvdCBvZiBkYXRhKVxuICAgICAqXG4gICAgICogbm93IHdlIHNldCBtb3JlIGZsYWdzOiBuc3BzeXR1bmU6IHNlZSBjb2RlIFZCUiBtb2RlcyBzZWUgY29kZSBDQlIvQUJSIHNlZVxuICAgICAqIGNvZGVcbiAgICAgKlxuICAgICAqIEZpbmFsbHksIHdlIHNldCB0aGUgYWxnb3JpdGhtIGZsYWdzIGJhc2VkIG9uIHRoZSBnZnAucXVhbGl0eSB2YWx1ZVxuICAgICAqIGxhbWVfaW5pdF9xdmFsKGdmcCk7XG4gICAgICpcbiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgdGhpcy5sYW1lX2luaXRfcGFyYW1zID0gZnVuY3Rpb24gKGdmcCkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXG4gICAgICAgIGdmYy5DbGFzc19JRCA9IDA7XG4gICAgICAgIGlmIChnZmMuQVRIID09IG51bGwpXG4gICAgICAgICAgICBnZmMuQVRIID0gbmV3IEFUSCgpO1xuICAgICAgICBpZiAoZ2ZjLlBTWSA9PSBudWxsKVxuICAgICAgICAgICAgZ2ZjLlBTWSA9IG5ldyBQU1koKTtcbiAgICAgICAgaWYgKGdmYy5yZ2RhdGEgPT0gbnVsbClcbiAgICAgICAgICAgIGdmYy5yZ2RhdGEgPSBuZXcgUmVwbGF5R2FpbigpO1xuXG4gICAgICAgIGdmYy5jaGFubmVsc19pbiA9IGdmcC5udW1fY2hhbm5lbHM7XG4gICAgICAgIGlmIChnZmMuY2hhbm5lbHNfaW4gPT0gMSlcbiAgICAgICAgICAgIGdmcC5tb2RlID0gTVBFR01vZGUuTU9OTztcbiAgICAgICAgZ2ZjLmNoYW5uZWxzX291dCA9IChnZnAubW9kZSA9PSBNUEVHTW9kZS5NT05PKSA/IDEgOiAyO1xuICAgICAgICBnZmMubW9kZV9leHQgPSBFbmNvZGVyLk1QR19NRF9NU19MUjtcbiAgICAgICAgaWYgKGdmcC5tb2RlID09IE1QRUdNb2RlLk1PTk8pXG4gICAgICAgICAgICBnZnAuZm9yY2VfbXMgPSBmYWxzZTtcbiAgICAgICAgLypcbiAgICAgICAgICogZG9uJ3QgYWxsb3cgZm9yY2VkIG1pZC9zaWRlIHN0ZXJlbyBmb3IgbW9ubyBvdXRwdXRcbiAgICAgICAgICovXG5cbiAgICAgICAgaWYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfb2ZmICYmIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMgIT0gMTI4XG4gICAgICAgICAgICAmJiBnZnAuYnJhdGUgPT0gMClcbiAgICAgICAgICAgIGdmcC5icmF0ZSA9IGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHM7XG5cbiAgICAgICAgaWYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfb2ZmIHx8IGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfbXRyaFxuICAgICAgICAgICAgfHwgZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9tdCkge1xuICAgICAgICAgICAgLyogdGhlc2UgbW9kZXMgY2FuIGhhbmRsZSBmcmVlIGZvcm1hdCBjb25kaXRpb24gKi9cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdmcC5mcmVlX2Zvcm1hdCA9IGZhbHNlO1xuICAgICAgICAgICAgLyogbW9kZSBjYW4ndCBiZSBtaXhlZCB3aXRoIGZyZWUgZm9ybWF0ICovXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9vZmYgJiYgZ2ZwLmJyYXRlID09IDApIHtcbiAgICAgICAgICAgIC8qIG5vIGJpdHJhdGUgb3IgY29tcHJlc3Npb24gcmF0aW8gc3BlY2lmaWVkLCB1c2UgMTEuMDI1ICovXG4gICAgICAgICAgICBpZiAoQml0U3RyZWFtLkVRKGdmcC5jb21wcmVzc2lvbl9yYXRpbywgMCkpXG4gICAgICAgICAgICAgICAgZ2ZwLmNvbXByZXNzaW9uX3JhdGlvID0gMTEuMDI1O1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIHJhdGUgdG8gY29tcHJlc3MgYSBDRCBkb3duIHRvIGV4YWN0bHkgMTI4MDAwIGJwc1xuICAgICAgICAgICAgICovXG4gICAgICAgIH1cblxuICAgICAgICAvKiBmaW5kIGJpdHJhdGUgaWYgdXNlciBzcGVjaWZ5IGEgY29tcHJlc3Npb24gcmF0aW8gKi9cbiAgICAgICAgaWYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfb2ZmICYmIGdmcC5jb21wcmVzc2lvbl9yYXRpbyA+IDApIHtcblxuICAgICAgICAgICAgaWYgKGdmcC5vdXRfc2FtcGxlcmF0ZSA9PSAwKVxuICAgICAgICAgICAgICAgIGdmcC5vdXRfc2FtcGxlcmF0ZSA9IG1hcDJNUDNGcmVxdWVuY3koKGludCkoMC45NyAqIGdmcC5pbl9zYW1wbGVyYXRlKSk7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogcm91bmQgdXAgd2l0aCBhIG1hcmdpbiBvZiAzICVcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogY2hvb3NlIGEgYml0cmF0ZSBmb3IgdGhlIG91dHB1dCBzYW1wbGVyYXRlIHdoaWNoIGFjaGlldmVzXG4gICAgICAgICAgICAgKiBzcGVjaWZpZWQgY29tcHJlc3Npb24gcmF0aW9cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZ2ZwLmJyYXRlID0gMCB8IChnZnAub3V0X3NhbXBsZXJhdGUgKiAxNiAqIGdmYy5jaGFubmVsc19vdXQgLyAoMS5lMyAqIGdmcC5jb21wcmVzc2lvbl9yYXRpbykpO1xuXG4gICAgICAgICAgICAvKiB3ZSBuZWVkIHRoZSB2ZXJzaW9uIGZvciB0aGUgYml0cmF0ZSB0YWJsZSBsb29rIHVwICovXG4gICAgICAgICAgICBnZmMuc2FtcGxlcmF0ZV9pbmRleCA9IFNtcEZycUluZGV4KGdmcC5vdXRfc2FtcGxlcmF0ZSwgZ2ZwKTtcblxuICAgICAgICAgICAgaWYgKCFnZnAuZnJlZV9mb3JtYXQpIC8qXG4gICAgICAgICAgICAgKiBmb3Igbm9uIEZyZWUgRm9ybWF0IGZpbmQgdGhlIG5lYXJlc3QgYWxsb3dlZFxuICAgICAgICAgICAgICogYml0cmF0ZVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZ2ZwLmJyYXRlID0gRmluZE5lYXJlc3RCaXRyYXRlKGdmcC5icmF0ZSwgZ2ZwLnZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgIGdmcC5vdXRfc2FtcGxlcmF0ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ2ZwLm91dF9zYW1wbGVyYXRlICE9IDApIHtcbiAgICAgICAgICAgIGlmIChnZnAub3V0X3NhbXBsZXJhdGUgPCAxNjAwMCkge1xuICAgICAgICAgICAgICAgIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMgPSBNYXRoLm1heChnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzLFxuICAgICAgICAgICAgICAgICAgICA4KTtcbiAgICAgICAgICAgICAgICBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzID0gTWF0aC5taW4oZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyxcbiAgICAgICAgICAgICAgICAgICAgNjQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChnZnAub3V0X3NhbXBsZXJhdGUgPCAzMjAwMCkge1xuICAgICAgICAgICAgICAgIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMgPSBNYXRoLm1heChnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzLFxuICAgICAgICAgICAgICAgICAgICA4KTtcbiAgICAgICAgICAgICAgICBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzID0gTWF0aC5taW4oZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyxcbiAgICAgICAgICAgICAgICAgICAgMTYwKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyA9IE1hdGgubWF4KGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMsXG4gICAgICAgICAgICAgICAgICAgIDMyKTtcbiAgICAgICAgICAgICAgICBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzID0gTWF0aC5taW4oZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyxcbiAgICAgICAgICAgICAgICAgICAgMzIwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICAvKiBpZiBhIGZpbHRlciBoYXMgbm90IGJlZW4gZW5hYmxlZCwgc2VlIGlmIHdlIHNob3VsZCBhZGQgb25lOiAqL1xuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgaWYgKGdmcC5sb3dwYXNzZnJlcSA9PSAwKSB7XG4gICAgICAgICAgICB2YXIgbG93cGFzcyA9IDE2MDAwLjtcblxuICAgICAgICAgICAgc3dpdGNoIChnZnAuVkJSKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBWYnJNb2RlLnZicl9vZmY6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGggPSBuZXcgTG93UGFzc0hpZ2hQYXNzKCk7XG4gICAgICAgICAgICAgICAgICAgIG9wdGltdW1fYmFuZHdpZHRoKGxoLCBnZnAuYnJhdGUpO1xuICAgICAgICAgICAgICAgICAgICBsb3dwYXNzID0gbGgubG93ZXJsaW1pdDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgVmJyTW9kZS52YnJfYWJyOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxoID0gbmV3IExvd1Bhc3NIaWdoUGFzcygpO1xuICAgICAgICAgICAgICAgICAgICBvcHRpbXVtX2JhbmR3aWR0aChsaCwgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2Jwcyk7XG4gICAgICAgICAgICAgICAgICAgIGxvd3Bhc3MgPSBsaC5sb3dlcmxpbWl0O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBWYnJNb2RlLnZicl9yaDpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB4ID0gWzE5NTAwLCAxOTAwMCwgMTg2MDAsIDE4MDAwLCAxNzUwMCwgMTYwMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAxNTYwMCwgMTQ5MDAsIDEyNTAwLCAxMDAwMCwgMzk1MF07XG4gICAgICAgICAgICAgICAgICAgIGlmICgwIDw9IGdmcC5WQlJfcSAmJiBnZnAuVkJSX3EgPD0gOSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSB4W2dmcC5WQlJfcV0sIGIgPSB4W2dmcC5WQlJfcSArIDFdLCBtID0gZ2ZwLlZCUl9xX2ZyYWM7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dwYXNzID0gbGluZWFyX2ludChhLCBiLCBtKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd3Bhc3MgPSAxOTUwMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB4ID0gWzE5NTAwLCAxOTAwMCwgMTg1MDAsIDE4MDAwLCAxNzUwMCwgMTY1MDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAxNTUwMCwgMTQ1MDAsIDEyNTAwLCA5NTAwLCAzOTUwXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKDAgPD0gZ2ZwLlZCUl9xICYmIGdmcC5WQlJfcSA8PSA5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IHhbZ2ZwLlZCUl9xXSwgYiA9IHhbZ2ZwLlZCUl9xICsgMV0sIG0gPSBnZnAuVkJSX3FfZnJhYztcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd3Bhc3MgPSBsaW5lYXJfaW50KGEsIGIsIG0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG93cGFzcyA9IDE5NTAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGdmcC5tb2RlID09IE1QRUdNb2RlLk1PTk9cbiAgICAgICAgICAgICAgICAmJiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9vZmYgfHwgZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9hYnIpKVxuICAgICAgICAgICAgICAgIGxvd3Bhc3MgKj0gMS41O1xuXG4gICAgICAgICAgICBnZnAubG93cGFzc2ZyZXEgPSBsb3dwYXNzIHwgMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChnZnAub3V0X3NhbXBsZXJhdGUgPT0gMCkge1xuICAgICAgICAgICAgaWYgKDIgKiBnZnAubG93cGFzc2ZyZXEgPiBnZnAuaW5fc2FtcGxlcmF0ZSkge1xuICAgICAgICAgICAgICAgIGdmcC5sb3dwYXNzZnJlcSA9IGdmcC5pbl9zYW1wbGVyYXRlIC8gMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmcC5vdXRfc2FtcGxlcmF0ZSA9IG9wdGltdW1fc2FtcGxlZnJlcShnZnAubG93cGFzc2ZyZXEgfCAwLFxuICAgICAgICAgICAgICAgIGdmcC5pbl9zYW1wbGVyYXRlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdmcC5sb3dwYXNzZnJlcSA9IE1hdGgubWluKDIwNTAwLCBnZnAubG93cGFzc2ZyZXEpO1xuICAgICAgICBnZnAubG93cGFzc2ZyZXEgPSBNYXRoLm1pbihnZnAub3V0X3NhbXBsZXJhdGUgLyAyLCBnZnAubG93cGFzc2ZyZXEpO1xuXG4gICAgICAgIGlmIChnZnAuVkJSID09IFZick1vZGUudmJyX29mZikge1xuICAgICAgICAgICAgZ2ZwLmNvbXByZXNzaW9uX3JhdGlvID0gZ2ZwLm91dF9zYW1wbGVyYXRlICogMTYgKiBnZmMuY2hhbm5lbHNfb3V0XG4gICAgICAgICAgICAgICAgLyAoMS5lMyAqIGdmcC5icmF0ZSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfYWJyKSB7XG4gICAgICAgICAgICBnZnAuY29tcHJlc3Npb25fcmF0aW8gPSBnZnAub3V0X3NhbXBsZXJhdGUgKiAxNiAqIGdmYy5jaGFubmVsc19vdXRcbiAgICAgICAgICAgICAgICAvICgxLmUzICogZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2Jwcyk7XG4gICAgICAgIH1cblxuICAgICAgICAvKlxuICAgICAgICAgKiBkbyBub3QgY29tcHV0ZSBSZXBsYXlHYWluIHZhbHVlcyBhbmQgZG8gbm90IGZpbmQgdGhlIHBlYWsgc2FtcGxlIGlmXG4gICAgICAgICAqIHdlIGNhbid0IHN0b3JlIHRoZW1cbiAgICAgICAgICovXG4gICAgICAgIGlmICghZ2ZwLmJXcml0ZVZiclRhZykge1xuICAgICAgICAgICAgZ2ZwLmZpbmRSZXBsYXlHYWluID0gZmFsc2U7XG4gICAgICAgICAgICBnZnAuZGVjb2RlX29uX3RoZV9mbHkgPSBmYWxzZTtcbiAgICAgICAgICAgIGdmYy5maW5kUGVha1NhbXBsZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGdmYy5maW5kUmVwbGF5R2FpbiA9IGdmcC5maW5kUmVwbGF5R2FpbjtcbiAgICAgICAgZ2ZjLmRlY29kZV9vbl90aGVfZmx5ID0gZ2ZwLmRlY29kZV9vbl90aGVfZmx5O1xuXG4gICAgICAgIGlmIChnZmMuZGVjb2RlX29uX3RoZV9mbHkpXG4gICAgICAgICAgICBnZmMuZmluZFBlYWtTYW1wbGUgPSB0cnVlO1xuXG4gICAgICAgIGlmIChnZmMuZmluZFJlcGxheUdhaW4pIHtcbiAgICAgICAgICAgIGlmIChnYS5Jbml0R2FpbkFuYWx5c2lzKGdmYy5yZ2RhdGEsIGdmcC5vdXRfc2FtcGxlcmF0ZSkgPT0gR2FpbkFuYWx5c2lzLklOSVRfR0FJTl9BTkFMWVNJU19FUlJPUikge1xuICAgICAgICAgICAgICAgIGdmcC5pbnRlcm5hbF9mbGFncyA9IG51bGw7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC02O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGdmYy5kZWNvZGVfb25fdGhlX2ZseSAmJiAhZ2ZwLmRlY29kZV9vbmx5KSB7XG4gICAgICAgICAgICBpZiAoZ2ZjLmhpcCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgbXBnbGliLmhpcF9kZWNvZGVfZXhpdChnZmMuaGlwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy5oaXAgPSBtcGdsaWIuaGlwX2RlY29kZV9pbml0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBnZmMubW9kZV9nciA9IGdmcC5vdXRfc2FtcGxlcmF0ZSA8PSAyNDAwMCA/IDEgOiAyO1xuICAgICAgICAvKlxuICAgICAgICAgKiBOdW1iZXIgb2YgZ3JhbnVsZXMgcGVyIGZyYW1lXG4gICAgICAgICAqL1xuICAgICAgICBnZnAuZnJhbWVzaXplID0gNTc2ICogZ2ZjLm1vZGVfZ3I7XG4gICAgICAgIGdmcC5lbmNvZGVyX2RlbGF5ID0gRW5jb2Rlci5FTkNERUxBWTtcblxuICAgICAgICBnZmMucmVzYW1wbGVfcmF0aW8gPSBnZnAuaW5fc2FtcGxlcmF0ZSAvIGdmcC5vdXRfc2FtcGxlcmF0ZTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogPFBSRT5cbiAgICAgICAgICogIHNhbXBsZSBmcmVxICAgICAgIGJpdHJhdGUgICAgIGNvbXByZXNzaW9uIHJhdGlvXG4gICAgICAgICAqICAgICBba0h6XSAgICAgIFtrYnBzL2NoYW5uZWxdICAgZm9yIDE2IGJpdCBpbnB1dFxuICAgICAgICAgKiAgICAgNDQuMSAgICAgICAgICAgIDU2ICAgICAgICAgICAgICAgMTIuNlxuICAgICAgICAgKiAgICAgNDQuMSAgICAgICAgICAgIDY0ICAgICAgICAgICAgICAgMTEuMDI1XG4gICAgICAgICAqICAgICA0NC4xICAgICAgICAgICAgODAgICAgICAgICAgICAgICAgOC44MlxuICAgICAgICAgKiAgICAgMjIuMDUgICAgICAgICAgIDI0ICAgICAgICAgICAgICAgMTQuN1xuICAgICAgICAgKiAgICAgMjIuMDUgICAgICAgICAgIDMyICAgICAgICAgICAgICAgMTEuMDI1XG4gICAgICAgICAqICAgICAyMi4wNSAgICAgICAgICAgNDAgICAgICAgICAgICAgICAgOC44MlxuICAgICAgICAgKiAgICAgMTYgICAgICAgICAgICAgIDE2ICAgICAgICAgICAgICAgMTYuMFxuICAgICAgICAgKiAgICAgMTYgICAgICAgICAgICAgIDI0ICAgICAgICAgICAgICAgMTAuNjY3XG4gICAgICAgICAqIDwvUFJFPlxuICAgICAgICAgKi9cbiAgICAgICAgLyoqXG4gICAgICAgICAqIDxQUkU+XG4gICAgICAgICAqICBGb3IgVkJSLCB0YWtlIGEgZ3Vlc3MgYXQgdGhlIGNvbXByZXNzaW9uX3JhdGlvLlxuICAgICAgICAgKiAgRm9yIGV4YW1wbGU6XG4gICAgICAgICAqXG4gICAgICAgICAqICAgIFZCUl9xICAgIGNvbXByZXNzaW9uICAgICBsaWtlXG4gICAgICAgICAqICAgICAtICAgICAgICA0LjQgICAgICAgICAzMjAga2Jwcy80NCBrSHpcbiAgICAgICAgICogICAwLi4uMSAgICAgIDUuNSAgICAgICAgIDI1NiBrYnBzLzQ0IGtIelxuICAgICAgICAgKiAgICAgMiAgICAgICAgNy4zICAgICAgICAgMTkyIGticHMvNDQga0h6XG4gICAgICAgICAqICAgICA0ICAgICAgICA4LjggICAgICAgICAxNjAga2Jwcy80NCBrSHpcbiAgICAgICAgICogICAgIDYgICAgICAgMTEgICAgICAgICAgIDEyOCBrYnBzLzQ0IGtIelxuICAgICAgICAgKiAgICAgOSAgICAgICAxNC43ICAgICAgICAgIDk2IGticHNcbiAgICAgICAgICpcbiAgICAgICAgICogIGZvciBsb3dlciBiaXRyYXRlcywgZG93bnNhbXBsZSB3aXRoIC0tcmVzYW1wbGVcbiAgICAgICAgICogPC9QUkU+XG4gICAgICAgICAqL1xuICAgICAgICBzd2l0Y2ggKGdmcC5WQlIpIHtcbiAgICAgICAgICAgIGNhc2UgVmJyTW9kZS52YnJfbXQ6XG4gICAgICAgICAgICBjYXNlIFZick1vZGUudmJyX3JoOlxuICAgICAgICAgICAgY2FzZSBWYnJNb2RlLnZicl9tdHJoOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8qIG51bWJlcnMgYXJlIGEgYml0IHN0cmFuZ2UsIGJ1dCB0aGV5IGRldGVybWluZSB0aGUgbG93cGFzcyB2YWx1ZSAqL1xuICAgICAgICAgICAgICAgIHZhciBjbXAgPSBbNS43LCA2LjUsIDcuMywgOC4yLCAxMCwgMTEuOSwgMTMsIDE0LFxuICAgICAgICAgICAgICAgICAgICAxNSwgMTYuNV07XG4gICAgICAgICAgICAgICAgZ2ZwLmNvbXByZXNzaW9uX3JhdGlvID0gY21wW2dmcC5WQlJfcV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFZick1vZGUudmJyX2FicjpcbiAgICAgICAgICAgICAgICBnZnAuY29tcHJlc3Npb25fcmF0aW8gPSBnZnAub3V0X3NhbXBsZXJhdGUgKiAxNiAqIGdmYy5jaGFubmVsc19vdXRcbiAgICAgICAgICAgICAgICAgICAgLyAoMS5lMyAqIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBnZnAuY29tcHJlc3Npb25fcmF0aW8gPSBnZnAub3V0X3NhbXBsZXJhdGUgKiAxNiAqIGdmYy5jaGFubmVsc19vdXRcbiAgICAgICAgICAgICAgICAgICAgLyAoMS5lMyAqIGdmcC5icmF0ZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICAvKlxuICAgICAgICAgKiBtb2RlID0gLTEgKG5vdCBzZXQgYnkgdXNlcikgb3IgbW9kZSA9IE1PTk8gKGJlY2F1c2Ugb2Ygb25seSAxIGlucHV0XG4gICAgICAgICAqIGNoYW5uZWwpLiBJZiBtb2RlIGhhcyBub3QgYmVlbiBzZXQsIHRoZW4gc2VsZWN0IEotU1RFUkVPXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoZ2ZwLm1vZGUgPT0gTVBFR01vZGUuTk9UX1NFVCkge1xuICAgICAgICAgICAgZ2ZwLm1vZGUgPSBNUEVHTW9kZS5KT0lOVF9TVEVSRU87XG4gICAgICAgIH1cblxuICAgICAgICAvKiBhcHBseSB1c2VyIGRyaXZlbiBoaWdoIHBhc3MgZmlsdGVyICovXG4gICAgICAgIGlmIChnZnAuaGlnaHBhc3NmcmVxID4gMCkge1xuICAgICAgICAgICAgZ2ZjLmhpZ2hwYXNzMSA9IDIuICogZ2ZwLmhpZ2hwYXNzZnJlcTtcblxuICAgICAgICAgICAgaWYgKGdmcC5oaWdocGFzc3dpZHRoID49IDApXG4gICAgICAgICAgICAgICAgZ2ZjLmhpZ2hwYXNzMiA9IDIuICogKGdmcC5oaWdocGFzc2ZyZXEgKyBnZnAuaGlnaHBhc3N3aWR0aCk7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAvKiAwJSBhYm92ZSBvbiBkZWZhdWx0ICovXG4gICAgICAgICAgICAgICAgZ2ZjLmhpZ2hwYXNzMiA9ICgxICsgMC4wMCkgKiAyLiAqIGdmcC5oaWdocGFzc2ZyZXE7XG5cbiAgICAgICAgICAgIGdmYy5oaWdocGFzczEgLz0gZ2ZwLm91dF9zYW1wbGVyYXRlO1xuICAgICAgICAgICAgZ2ZjLmhpZ2hwYXNzMiAvPSBnZnAub3V0X3NhbXBsZXJhdGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBnZmMuaGlnaHBhc3MxID0gMDtcbiAgICAgICAgICAgIGdmYy5oaWdocGFzczIgPSAwO1xuICAgICAgICB9XG4gICAgICAgIC8qIGFwcGx5IHVzZXIgZHJpdmVuIGxvdyBwYXNzIGZpbHRlciAqL1xuICAgICAgICBpZiAoZ2ZwLmxvd3Bhc3NmcmVxID4gMCkge1xuICAgICAgICAgICAgZ2ZjLmxvd3Bhc3MyID0gMi4gKiBnZnAubG93cGFzc2ZyZXE7XG4gICAgICAgICAgICBpZiAoZ2ZwLmxvd3Bhc3N3aWR0aCA+PSAwKSB7XG4gICAgICAgICAgICAgICAgZ2ZjLmxvd3Bhc3MxID0gMi4gKiAoZ2ZwLmxvd3Bhc3NmcmVxIC0gZ2ZwLmxvd3Bhc3N3aWR0aCk7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5sb3dwYXNzMSA8IDApIC8qIGhhcyB0byBiZSA+PSAwICovXG4gICAgICAgICAgICAgICAgICAgIGdmYy5sb3dwYXNzMSA9IDA7XG4gICAgICAgICAgICB9IGVsc2UgeyAvKiAwJSBiZWxvdyBvbiBkZWZhdWx0ICovXG4gICAgICAgICAgICAgICAgZ2ZjLmxvd3Bhc3MxID0gKDEgLSAwLjAwKSAqIDIuICogZ2ZwLmxvd3Bhc3NmcmVxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLmxvd3Bhc3MxIC89IGdmcC5vdXRfc2FtcGxlcmF0ZTtcbiAgICAgICAgICAgIGdmYy5sb3dwYXNzMiAvPSBnZnAub3V0X3NhbXBsZXJhdGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBnZmMubG93cGFzczEgPSAwO1xuICAgICAgICAgICAgZ2ZjLmxvd3Bhc3MyID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICAvKiBjb21wdXRlIGluZm8gbmVlZGVkIGZvciBwb2x5cGhhc2UgZmlsdGVyIChmaWx0ZXIgdHlwZT09MCwgZGVmYXVsdCkgKi9cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIGxhbWVfaW5pdF9wYXJhbXNfcHBmbHQoZ2ZwKTtcbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogc2FtcGxlcmF0ZSBhbmQgYml0cmF0ZSBpbmRleFxuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgZ2ZjLnNhbXBsZXJhdGVfaW5kZXggPSBTbXBGcnFJbmRleChnZnAub3V0X3NhbXBsZXJhdGUsIGdmcCk7XG4gICAgICAgIGlmIChnZmMuc2FtcGxlcmF0ZV9pbmRleCA8IDApIHtcbiAgICAgICAgICAgIGdmcC5pbnRlcm5hbF9mbGFncyA9IG51bGw7XG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9vZmYpIHtcbiAgICAgICAgICAgIGlmIChnZnAuZnJlZV9mb3JtYXQpIHtcbiAgICAgICAgICAgICAgICBnZmMuYml0cmF0ZV9pbmRleCA9IDA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGdmcC5icmF0ZSA9IEZpbmROZWFyZXN0Qml0cmF0ZShnZnAuYnJhdGUsIGdmcC52ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICBnZnAub3V0X3NhbXBsZXJhdGUpO1xuICAgICAgICAgICAgICAgIGdmYy5iaXRyYXRlX2luZGV4ID0gQml0cmF0ZUluZGV4KGdmcC5icmF0ZSwgZ2ZwLnZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgIGdmcC5vdXRfc2FtcGxlcmF0ZSk7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5iaXRyYXRlX2luZGV4IDw9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLmludGVybmFsX2ZsYWdzID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdmYy5iaXRyYXRlX2luZGV4ID0gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGZvciBDQlIsIHdlIHdpbGwgd3JpdGUgYW4gXCJpbmZvXCIgdGFnLiAqL1xuXG4gICAgICAgIGlmIChnZnAuYW5hbHlzaXMpXG4gICAgICAgICAgICBnZnAuYldyaXRlVmJyVGFnID0gZmFsc2U7XG5cbiAgICAgICAgLyogc29tZSBmaWxlIG9wdGlvbnMgbm90IGFsbG93ZWQgaWYgb3V0cHV0IGlzOiBub3Qgc3BlY2lmaWVkIG9yIHN0ZG91dCAqL1xuICAgICAgICBpZiAoZ2ZjLnBpbmZvICE9IG51bGwpXG4gICAgICAgICAgICBnZnAuYldyaXRlVmJyVGFnID0gZmFsc2U7XG4gICAgICAgIC8qIGRpc2FibGUgWGluZyBWQlIgdGFnICovXG5cbiAgICAgICAgYnMuaW5pdF9iaXRfc3RyZWFtX3coZ2ZjKTtcblxuICAgICAgICB2YXIgaiA9IGdmYy5zYW1wbGVyYXRlX2luZGV4ICsgKDMgKiBnZnAudmVyc2lvbikgKyA2XG4gICAgICAgICAgICAqIChnZnAub3V0X3NhbXBsZXJhdGUgPCAxNjAwMCA/IDEgOiAwKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBFbmNvZGVyLlNCTUFYX2wgKyAxOyBpKyspXG4gICAgICAgICAgICBnZmMuc2NhbGVmYWNfYmFuZC5sW2ldID0gcXVwdnQuc2ZCYW5kSW5kZXhbal0ubFtpXTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEVuY29kZXIuUFNGQjIxICsgMTsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgc2l6ZSA9IChnZmMuc2NhbGVmYWNfYmFuZC5sWzIyXSAtIGdmYy5zY2FsZWZhY19iYW5kLmxbMjFdKVxuICAgICAgICAgICAgICAgIC8gRW5jb2Rlci5QU0ZCMjE7XG4gICAgICAgICAgICB2YXIgc3RhcnQgPSBnZmMuc2NhbGVmYWNfYmFuZC5sWzIxXSArIGkgKiBzaXplO1xuICAgICAgICAgICAgZ2ZjLnNjYWxlZmFjX2JhbmQucHNmYjIxW2ldID0gc3RhcnQ7XG4gICAgICAgIH1cbiAgICAgICAgZ2ZjLnNjYWxlZmFjX2JhbmQucHNmYjIxW0VuY29kZXIuUFNGQjIxXSA9IDU3NjtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEVuY29kZXIuU0JNQVhfcyArIDE7IGkrKylcbiAgICAgICAgICAgIGdmYy5zY2FsZWZhY19iYW5kLnNbaV0gPSBxdXB2dC5zZkJhbmRJbmRleFtqXS5zW2ldO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgRW5jb2Rlci5QU0ZCMTIgKyAxOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBzaXplID0gKGdmYy5zY2FsZWZhY19iYW5kLnNbMTNdIC0gZ2ZjLnNjYWxlZmFjX2JhbmQuc1sxMl0pXG4gICAgICAgICAgICAgICAgLyBFbmNvZGVyLlBTRkIxMjtcbiAgICAgICAgICAgIHZhciBzdGFydCA9IGdmYy5zY2FsZWZhY19iYW5kLnNbMTJdICsgaSAqIHNpemU7XG4gICAgICAgICAgICBnZmMuc2NhbGVmYWNfYmFuZC5wc2ZiMTJbaV0gPSBzdGFydDtcbiAgICAgICAgfVxuICAgICAgICBnZmMuc2NhbGVmYWNfYmFuZC5wc2ZiMTJbRW5jb2Rlci5QU0ZCMTJdID0gMTkyO1xuICAgICAgICAvKiBkZXRlcm1pbmUgdGhlIG1lYW4gYml0cmF0ZSBmb3IgbWFpbiBkYXRhICovXG4gICAgICAgIGlmIChnZnAudmVyc2lvbiA9PSAxKSAvKiBNUEVHIDEgKi9cbiAgICAgICAgICAgIGdmYy5zaWRlaW5mb19sZW4gPSAoZ2ZjLmNoYW5uZWxzX291dCA9PSAxKSA/IDQgKyAxNyA6IDQgKyAzMjtcbiAgICAgICAgZWxzZVxuICAgICAgICAvKiBNUEVHIDIgKi9cbiAgICAgICAgICAgIGdmYy5zaWRlaW5mb19sZW4gPSAoZ2ZjLmNoYW5uZWxzX291dCA9PSAxKSA/IDQgKyA5IDogNCArIDE3O1xuXG4gICAgICAgIGlmIChnZnAuZXJyb3JfcHJvdGVjdGlvbilcbiAgICAgICAgICAgIGdmYy5zaWRlaW5mb19sZW4gKz0gMjtcblxuICAgICAgICBsYW1lX2luaXRfYml0c3RyZWFtKGdmcCk7XG5cbiAgICAgICAgZ2ZjLkNsYXNzX0lEID0gTEFNRV9JRDtcblxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgaztcblxuICAgICAgICAgICAgZm9yIChrID0gMDsgayA8IDE5OyBrKyspXG4gICAgICAgICAgICAgICAgZ2ZjLm5zUHN5LnBlZmlyYnVmW2tdID0gNzAwICogZ2ZjLm1vZGVfZ3IgKiBnZmMuY2hhbm5lbHNfb3V0O1xuXG4gICAgICAgICAgICBpZiAoZ2ZwLkFUSHR5cGUgPT0gLTEpXG4gICAgICAgICAgICAgICAgZ2ZwLkFUSHR5cGUgPSA0O1xuICAgICAgICB9XG5cbiAgICAgICAgc3dpdGNoIChnZnAuVkJSKSB7XG5cbiAgICAgICAgICAgIGNhc2UgVmJyTW9kZS52YnJfbXQ6XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUiA9IFZick1vZGUudmJyX210cmg7XG4gICAgICAgICAgICAvLyRGQUxMLVRIUk9VR0gkXG4gICAgICAgICAgICBjYXNlIFZick1vZGUudmJyX210cmg6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKGdmcC51c2VUZW1wb3JhbCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGdmcC51c2VUZW1wb3JhbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAvKiBvZmYgYnkgZGVmYXVsdCBmb3IgdGhpcyBWQlIgbW9kZSAqL1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHAuYXBwbHlfcHJlc2V0KGdmcCwgNTAwIC0gKGdmcC5WQlJfcSAqIDEwKSwgMCk7XG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogPFBSRT5cbiAgICAgICAgICAgICAgICAgKiAgIFRoZSBuZXdlciBWQlIgY29kZSBzdXBwb3J0cyBvbmx5IGEgbGltaXRlZFxuICAgICAgICAgICAgICAgICAqICAgICBzdWJzZXQgb2YgcXVhbGl0eSBsZXZlbHM6XG4gICAgICAgICAgICAgICAgICogICAgIDktNT01IGFyZSB0aGUgc2FtZSwgdXNlcyB4XjMvNCBxdWFudGl6YXRpb25cbiAgICAgICAgICAgICAgICAgKiAgIDQtMD0wIGFyZSB0aGUgc2FtZSAgNSBwbHVzIGJlc3QgaHVmZm1hbiBkaXZpZGUgY29kZVxuICAgICAgICAgICAgICAgICAqIDwvUFJFPlxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGlmIChnZnAucXVhbGl0eSA8IDApXG4gICAgICAgICAgICAgICAgICAgIGdmcC5xdWFsaXR5ID0gTEFNRV9ERUZBVUxUX1FVQUxJVFk7XG4gICAgICAgICAgICAgICAgaWYgKGdmcC5xdWFsaXR5IDwgNSlcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLnF1YWxpdHkgPSAwO1xuICAgICAgICAgICAgICAgIGlmIChnZnAucXVhbGl0eSA+IDUpXG4gICAgICAgICAgICAgICAgICAgIGdmcC5xdWFsaXR5ID0gNTtcblxuICAgICAgICAgICAgICAgIGdmYy5QU1kubWFza19hZGp1c3QgPSBnZnAubWFza2luZ2FkanVzdDtcbiAgICAgICAgICAgICAgICBnZmMuUFNZLm1hc2tfYWRqdXN0X3Nob3J0ID0gZ2ZwLm1hc2tpbmdhZGp1c3Rfc2hvcnQ7XG5cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIHNmYjIxIGV4dHJhIG9ubHkgd2l0aCBNUEVHLTEgYXQgaGlnaGVyIHNhbXBsaW5nIHJhdGVzXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgaWYgKGdmcC5leHBlcmltZW50YWxZKVxuICAgICAgICAgICAgICAgICAgICBnZmMuc2ZiMjFfZXh0cmEgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGdmYy5zZmIyMV9leHRyYSA9IChnZnAub3V0X3NhbXBsZXJhdGUgPiA0NDAwMCk7XG5cbiAgICAgICAgICAgICAgICBnZmMuaXRlcmF0aW9uX2xvb3AgPSBuZXcgVkJSTmV3SXRlcmF0aW9uTG9vcChxdSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgVmJyTW9kZS52YnJfcmg6XG4gICAgICAgICAgICB7XG5cbiAgICAgICAgICAgICAgICBwLmFwcGx5X3ByZXNldChnZnAsIDUwMCAtIChnZnAuVkJSX3EgKiAxMCksIDApO1xuXG4gICAgICAgICAgICAgICAgZ2ZjLlBTWS5tYXNrX2FkanVzdCA9IGdmcC5tYXNraW5nYWRqdXN0O1xuICAgICAgICAgICAgICAgIGdmYy5QU1kubWFza19hZGp1c3Rfc2hvcnQgPSBnZnAubWFza2luZ2FkanVzdF9zaG9ydDtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogc2ZiMjEgZXh0cmEgb25seSB3aXRoIE1QRUctMSBhdCBoaWdoZXIgc2FtcGxpbmcgcmF0ZXNcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAoZ2ZwLmV4cGVyaW1lbnRhbFkpXG4gICAgICAgICAgICAgICAgICAgIGdmYy5zZmIyMV9leHRyYSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnNmYjIxX2V4dHJhID0gKGdmcC5vdXRfc2FtcGxlcmF0ZSA+IDQ0MDAwKTtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogVkJSIG5lZWRzIGF0IGxlYXN0IHRoZSBvdXRwdXQgb2YgR1BTWUNITywgc28gd2UgaGF2ZSB0byBnYXJhbnRlZVxuICAgICAgICAgICAgICAgICAqIHRoYXQgYnkgc2V0dGluZyBhIG1pbmltdW0gcXVhbGl0eSBsZXZlbCwgYWN0dWFsbHkgbGV2ZWwgNiBkb2VzXG4gICAgICAgICAgICAgICAgICogaXQuIGRvd24gdG8gbGV2ZWwgNlxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGlmIChnZnAucXVhbGl0eSA+IDYpXG4gICAgICAgICAgICAgICAgICAgIGdmcC5xdWFsaXR5ID0gNjtcblxuICAgICAgICAgICAgICAgIGlmIChnZnAucXVhbGl0eSA8IDApXG4gICAgICAgICAgICAgICAgICAgIGdmcC5xdWFsaXR5ID0gTEFNRV9ERUZBVUxUX1FVQUxJVFk7XG5cbiAgICAgICAgICAgICAgICBnZmMuaXRlcmF0aW9uX2xvb3AgPSBuZXcgVkJST2xkSXRlcmF0aW9uTG9vcChxdSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6IC8qIGNici9hYnIgKi9cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXIgdmJybW9kZTtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogbm8gc2ZiMjEgZXh0cmEgd2l0aCBDQlIgY29kZVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGdmYy5zZmIyMV9leHRyYSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgaWYgKGdmcC5xdWFsaXR5IDwgMClcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLnF1YWxpdHkgPSBMQU1FX0RFRkFVTFRfUVVBTElUWTtcblxuICAgICAgICAgICAgICAgIHZicm1vZGUgPSBnZnAuVkJSO1xuICAgICAgICAgICAgICAgIGlmICh2YnJtb2RlID09IFZick1vZGUudmJyX29mZilcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyA9IGdmcC5icmF0ZTtcbiAgICAgICAgICAgICAgICAvKiBzZWNvbmQsIHNldCBwYXJhbWV0ZXJzIGRlcGVuZGluZyBvbiBiaXRyYXRlICovXG4gICAgICAgICAgICAgICAgcC5hcHBseV9wcmVzZXQoZ2ZwLCBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzLCAwKTtcbiAgICAgICAgICAgICAgICBnZnAuVkJSID0gdmJybW9kZTtcblxuICAgICAgICAgICAgICAgIGdmYy5QU1kubWFza19hZGp1c3QgPSBnZnAubWFza2luZ2FkanVzdDtcbiAgICAgICAgICAgICAgICBnZmMuUFNZLm1hc2tfYWRqdXN0X3Nob3J0ID0gZ2ZwLm1hc2tpbmdhZGp1c3Rfc2hvcnQ7XG5cbiAgICAgICAgICAgICAgICBpZiAodmJybW9kZSA9PSBWYnJNb2RlLnZicl9vZmYpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLml0ZXJhdGlvbl9sb29wID0gbmV3IENCUk5ld0l0ZXJhdGlvbkxvb3AocXUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGdmYy5pdGVyYXRpb25fbG9vcCA9IG5ldyBBQlJJdGVyYXRpb25Mb29wKHF1KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyogaW5pdGlhbGl6ZSBkZWZhdWx0IHZhbHVlcyBjb21tb24gZm9yIGFsbCBtb2RlcyAqL1xuXG4gICAgICAgIGlmIChnZnAuVkJSICE9IFZick1vZGUudmJyX29mZikgeyAvKiBjaG9vc2UgYSBtaW4vbWF4IGJpdHJhdGUgZm9yIFZCUiAqL1xuICAgICAgICAgICAgLyogaWYgdGhlIHVzZXIgZGlkbid0IHNwZWNpZnkgVkJSX21heF9iaXRyYXRlOiAqL1xuICAgICAgICAgICAgZ2ZjLlZCUl9taW5fYml0cmF0ZSA9IDE7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogZGVmYXVsdDogYWxsb3cgOCBrYnBzIChNUEVHLTIpIG9yIDMyIGticHMgKE1QRUctMSlcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZ2ZjLlZCUl9tYXhfYml0cmF0ZSA9IDE0O1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIGRlZmF1bHQ6IGFsbG93IDE2MCBrYnBzIChNUEVHLTIpIG9yIDMyMCBrYnBzIChNUEVHLTEpXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGlmIChnZnAub3V0X3NhbXBsZXJhdGUgPCAxNjAwMClcbiAgICAgICAgICAgICAgICBnZmMuVkJSX21heF9iaXRyYXRlID0gODtcbiAgICAgICAgICAgIC8qIGRlZmF1bHQ6IGFsbG93IDY0IGticHMgKE1QRUctMi41KSAqL1xuICAgICAgICAgICAgaWYgKGdmcC5WQlJfbWluX2JpdHJhdGVfa2JwcyAhPSAwKSB7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUl9taW5fYml0cmF0ZV9rYnBzID0gRmluZE5lYXJlc3RCaXRyYXRlKFxuICAgICAgICAgICAgICAgICAgICBnZnAuVkJSX21pbl9iaXRyYXRlX2ticHMsIGdmcC52ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICBnZnAub3V0X3NhbXBsZXJhdGUpO1xuICAgICAgICAgICAgICAgIGdmYy5WQlJfbWluX2JpdHJhdGUgPSBCaXRyYXRlSW5kZXgoZ2ZwLlZCUl9taW5fYml0cmF0ZV9rYnBzLFxuICAgICAgICAgICAgICAgICAgICBnZnAudmVyc2lvbiwgZ2ZwLm91dF9zYW1wbGVyYXRlKTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLlZCUl9taW5fYml0cmF0ZSA8IDApXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChnZnAuVkJSX21heF9iaXRyYXRlX2ticHMgIT0gMCkge1xuICAgICAgICAgICAgICAgIGdmcC5WQlJfbWF4X2JpdHJhdGVfa2JwcyA9IEZpbmROZWFyZXN0Qml0cmF0ZShcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLlZCUl9tYXhfYml0cmF0ZV9rYnBzLCBnZnAudmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLm91dF9zYW1wbGVyYXRlKTtcbiAgICAgICAgICAgICAgICBnZmMuVkJSX21heF9iaXRyYXRlID0gQml0cmF0ZUluZGV4KGdmcC5WQlJfbWF4X2JpdHJhdGVfa2JwcyxcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLnZlcnNpb24sIGdmcC5vdXRfc2FtcGxlcmF0ZSk7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5WQlJfbWF4X2JpdHJhdGUgPCAwKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZnAuVkJSX21pbl9iaXRyYXRlX2ticHMgPSBUYWJsZXMuYml0cmF0ZV90YWJsZVtnZnAudmVyc2lvbl1bZ2ZjLlZCUl9taW5fYml0cmF0ZV07XG4gICAgICAgICAgICBnZnAuVkJSX21heF9iaXRyYXRlX2ticHMgPSBUYWJsZXMuYml0cmF0ZV90YWJsZVtnZnAudmVyc2lvbl1bZ2ZjLlZCUl9tYXhfYml0cmF0ZV07XG4gICAgICAgICAgICBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzID0gTWF0aC5taW4oXG4gICAgICAgICAgICAgICAgVGFibGVzLmJpdHJhdGVfdGFibGVbZ2ZwLnZlcnNpb25dW2dmYy5WQlJfbWF4X2JpdHJhdGVdLFxuICAgICAgICAgICAgICAgIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMpO1xuICAgICAgICAgICAgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyA9IE1hdGgubWF4KFxuICAgICAgICAgICAgICAgIFRhYmxlcy5iaXRyYXRlX3RhYmxlW2dmcC52ZXJzaW9uXVtnZmMuVkJSX21pbl9iaXRyYXRlXSxcbiAgICAgICAgICAgICAgICBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGp1c3QgYW5vdGhlciBkYWlseSBjaGFuZ2luZyBkZXZlbG9wZXIgc3dpdGNoICovXG4gICAgICAgIGlmIChnZnAudHVuZSkge1xuICAgICAgICAgICAgZ2ZjLlBTWS5tYXNrX2FkanVzdCArPSBnZnAudHVuZV92YWx1ZV9hO1xuICAgICAgICAgICAgZ2ZjLlBTWS5tYXNrX2FkanVzdF9zaG9ydCArPSBnZnAudHVuZV92YWx1ZV9hO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogaW5pdGlhbGl6ZSBpbnRlcm5hbCBxdmFsIHNldHRpbmdzICovXG4gICAgICAgIGxhbWVfaW5pdF9xdmFsKGdmcCk7XG4gICAgICAgIC8qXG4gICAgICAgICAqIGF1dG9tYXRpYyBBVEggYWRqdXN0bWVudCBvblxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGdmcC5hdGhhYV90eXBlIDwgMClcbiAgICAgICAgICAgIGdmYy5BVEgudXNlQWRqdXN0ID0gMztcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgZ2ZjLkFUSC51c2VBZGp1c3QgPSBnZnAuYXRoYWFfdHlwZTtcblxuICAgICAgICAvKiBpbml0aWFsaXplIGludGVybmFsIGFkYXB0aXZlIEFUSCBzZXR0aW5ncyAtamQgKi9cbiAgICAgICAgZ2ZjLkFUSC5hYVNlbnNpdGl2aXR5UCA9IE1hdGgucG93KDEwLjAsIGdmcC5hdGhhYV9zZW5zaXRpdml0eVxuICAgICAgICAgICAgLyAtMTAuMCk7XG5cbiAgICAgICAgaWYgKGdmcC5zaG9ydF9ibG9ja3MgPT0gbnVsbCkge1xuICAgICAgICAgICAgZ2ZwLnNob3J0X2Jsb2NrcyA9IFNob3J0QmxvY2suc2hvcnRfYmxvY2tfYWxsb3dlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIE5vdGUgSmFuLzIwMDM6IE1hbnkgaGFyZHdhcmUgZGVjb2RlcnMgY2Fubm90IGhhbmRsZSBzaG9ydCBibG9ja3MgaW5cbiAgICAgICAgICogcmVndWxhciBzdGVyZW8gbW9kZSB1bmxlc3MgdGhleSBhcmUgY291cGxlZCAoc2FtZSB0eXBlIGluIGJvdGhcbiAgICAgICAgICogY2hhbm5lbHMpIGl0IGlzIGEgcmFyZSBldmVudCAoMSBmcmFtZSBwZXIgbWluLiBvciBzbykgdGhhdCBMQU1FIHdvdWxkXG4gICAgICAgICAqIHVzZSB1bmNvdXBsZWQgc2hvcnQgYmxvY2tzLCBzbyBsZXRzIHR1cm4gdGhlbSBvZmYgdW50aWwgd2UgZGVjaWRlIGhvd1xuICAgICAgICAgKiB0byBoYW5kbGUgdGhpcy4gTm8gb3RoZXIgZW5jb2RlcnMgYWxsb3cgdW5jb3VwbGVkIHNob3J0IGJsb2NrcywgZXZlblxuICAgICAgICAgKiB0aG91Z2ggaXQgaXMgaW4gdGhlIHN0YW5kYXJkLlxuICAgICAgICAgKi9cbiAgICAgICAgLypcbiAgICAgICAgICogcmggMjAwNDAyMTc6IGNvdXBsaW5nIG1ha2VzIG5vIHNlbnNlIGZvciBtb25vIGFuZCBkdWFsLW1vbm8gc3RyZWFtc1xuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGdmcC5zaG9ydF9ibG9ja3MgPT0gU2hvcnRCbG9jay5zaG9ydF9ibG9ja19hbGxvd2VkXG4gICAgICAgICAgICAmJiAoZ2ZwLm1vZGUgPT0gTVBFR01vZGUuSk9JTlRfU1RFUkVPIHx8IGdmcC5tb2RlID09IE1QRUdNb2RlLlNURVJFTykpIHtcbiAgICAgICAgICAgIGdmcC5zaG9ydF9ibG9ja3MgPSBTaG9ydEJsb2NrLnNob3J0X2Jsb2NrX2NvdXBsZWQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ2ZwLnF1YW50X2NvbXAgPCAwKVxuICAgICAgICAgICAgZ2ZwLnF1YW50X2NvbXAgPSAxO1xuICAgICAgICBpZiAoZ2ZwLnF1YW50X2NvbXBfc2hvcnQgPCAwKVxuICAgICAgICAgICAgZ2ZwLnF1YW50X2NvbXBfc2hvcnQgPSAwO1xuXG4gICAgICAgIGlmIChnZnAubXNmaXggPCAwKVxuICAgICAgICAgICAgZ2ZwLm1zZml4ID0gMDtcblxuICAgICAgICAvKiBzZWxlY3QgcHN5Y2hvYWNvdXN0aWMgbW9kZWwgKi9cbiAgICAgICAgZ2ZwLmV4cF9uc3BzeXR1bmUgPSBnZnAuZXhwX25zcHN5dHVuZSB8IDE7XG5cbiAgICAgICAgaWYgKGdmcC5pbnRlcm5hbF9mbGFncy5uc1BzeS5hdHRhY2t0aHJlIDwgMClcbiAgICAgICAgICAgIGdmcC5pbnRlcm5hbF9mbGFncy5uc1BzeS5hdHRhY2t0aHJlID0gUHN5TW9kZWwuTlNBVFRBQ0tUSFJFO1xuICAgICAgICBpZiAoZ2ZwLmludGVybmFsX2ZsYWdzLm5zUHN5LmF0dGFja3RocmVfcyA8IDApXG4gICAgICAgICAgICBnZnAuaW50ZXJuYWxfZmxhZ3MubnNQc3kuYXR0YWNrdGhyZV9zID0gUHN5TW9kZWwuTlNBVFRBQ0tUSFJFX1M7XG5cblxuICAgICAgICBpZiAoZ2ZwLnNjYWxlIDwgMClcbiAgICAgICAgICAgIGdmcC5zY2FsZSA9IDE7XG5cbiAgICAgICAgaWYgKGdmcC5BVEh0eXBlIDwgMClcbiAgICAgICAgICAgIGdmcC5BVEh0eXBlID0gNDtcblxuICAgICAgICBpZiAoZ2ZwLkFUSGN1cnZlIDwgMClcbiAgICAgICAgICAgIGdmcC5BVEhjdXJ2ZSA9IDQ7XG5cbiAgICAgICAgaWYgKGdmcC5hdGhhYV9sb3VkYXBwcm94IDwgMClcbiAgICAgICAgICAgIGdmcC5hdGhhYV9sb3VkYXBwcm94ID0gMjtcblxuICAgICAgICBpZiAoZ2ZwLmludGVyQ2hSYXRpbyA8IDApXG4gICAgICAgICAgICBnZnAuaW50ZXJDaFJhdGlvID0gMDtcblxuICAgICAgICBpZiAoZ2ZwLnVzZVRlbXBvcmFsID09IG51bGwpXG4gICAgICAgICAgICBnZnAudXNlVGVtcG9yYWwgPSB0cnVlO1xuICAgICAgICAvKiBvbiBieSBkZWZhdWx0ICovXG5cbiAgICAgICAgLypcbiAgICAgICAgICogcGFkZGluZyBtZXRob2QgYXMgZGVzY3JpYmVkIGluXG4gICAgICAgICAqIFwiTVBFRy1MYXllcjMgLyBCaXRzdHJlYW0gU3ludGF4IGFuZCBEZWNvZGluZ1wiIGJ5IE1hcnRpbiBTaWVsZXIsIFJhbHBoXG4gICAgICAgICAqIFNwZXJzY2huZWlkZXJcbiAgICAgICAgICpcbiAgICAgICAgICogbm90ZTogdGhlcmUgaXMgbm8gcGFkZGluZyBmb3IgdGhlIHZlcnkgZmlyc3QgZnJhbWVcbiAgICAgICAgICpcbiAgICAgICAgICogUm9iZXJ0IEhlZ2VtYW5uIDIwMDAtMDYtMjJcbiAgICAgICAgICovXG4gICAgICAgIGdmYy5zbG90X2xhZyA9IGdmYy5mcmFjX1NwRiA9IDA7XG4gICAgICAgIGlmIChnZnAuVkJSID09IFZick1vZGUudmJyX29mZilcbiAgICAgICAgICAgIGdmYy5zbG90X2xhZyA9IGdmYy5mcmFjX1NwRiA9ICgoKGdmcC52ZXJzaW9uICsgMSkgKiA3MjAwMCAqIGdmcC5icmF0ZSkgJSBnZnAub3V0X3NhbXBsZXJhdGUpIHwgMDtcblxuICAgICAgICBxdXB2dC5pdGVyYXRpb25faW5pdChnZnApO1xuICAgICAgICBwc3kucHN5bW9kZWxfaW5pdChnZnApO1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB1cGRhdGVfaW5idWZmZXJfc2l6ZShnZmMsIG5zYW1wbGVzKSB7XG4gICAgICAgIGlmIChnZmMuaW5fYnVmZmVyXzAgPT0gbnVsbCB8fCBnZmMuaW5fYnVmZmVyX25zYW1wbGVzIDwgbnNhbXBsZXMpIHtcbiAgICAgICAgICAgIGdmYy5pbl9idWZmZXJfMCA9IG5ld19mbG9hdChuc2FtcGxlcyk7XG4gICAgICAgICAgICBnZmMuaW5fYnVmZmVyXzEgPSBuZXdfZmxvYXQobnNhbXBsZXMpO1xuICAgICAgICAgICAgZ2ZjLmluX2J1ZmZlcl9uc2FtcGxlcyA9IG5zYW1wbGVzO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5sYW1lX2VuY29kZV9mbHVzaCA9IGZ1bmN0aW9uIChnZnAsIG1wM2J1ZmZlciwgbXAzYnVmZmVyUG9zLCBtcDNidWZmZXJfc2l6ZSkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgYnVmZmVyID0gbmV3X3Nob3J0X24oWzIsIDExNTJdKTtcbiAgICAgICAgdmFyIGltcDMgPSAwLCBtcDNjb3VudCwgbXAzYnVmZmVyX3NpemVfcmVtYWluaW5nO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHdlIGFsd2F5cyBhZGQgUE9TVERFTEFZPTI4OCBwYWRkaW5nIHRvIG1ha2Ugc3VyZSBncmFudWxlIHdpdGggcmVhbFxuICAgICAgICAgKiBkYXRhIGNhbiBiZSBjb21wbGV0eSBkZWNvZGVkIChiZWNhdXNlIG9mIDUwJSBvdmVybGFwIHdpdGggbmV4dFxuICAgICAgICAgKiBncmFudWxlXG4gICAgICAgICAqL1xuICAgICAgICB2YXIgZW5kX3BhZGRpbmc7XG4gICAgICAgIHZhciBmcmFtZXNfbGVmdDtcbiAgICAgICAgdmFyIHNhbXBsZXNfdG9fZW5jb2RlID0gZ2ZjLm1mX3NhbXBsZXNfdG9fZW5jb2RlIC0gRW5jb2Rlci5QT1NUREVMQVk7XG4gICAgICAgIHZhciBtZl9uZWVkZWQgPSBjYWxjTmVlZGVkKGdmcCk7XG5cbiAgICAgICAgLyogV2FzIGZsdXNoIGFscmVhZHkgY2FsbGVkPyAqL1xuICAgICAgICBpZiAoZ2ZjLm1mX3NhbXBsZXNfdG9fZW5jb2RlIDwgMSkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgbXAzY291bnQgPSAwO1xuXG4gICAgICAgIGlmIChnZnAuaW5fc2FtcGxlcmF0ZSAhPSBnZnAub3V0X3NhbXBsZXJhdGUpIHtcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBkZWxheSBkdWUgdG8gcmVzYW1wbGluZzsgbmVlZHMgdG8gYmUgZml4ZWQsIGlmIHJlc2FtcGxpbmcgY29kZVxuICAgICAgICAgICAgICogZ2V0cyBjaGFuZ2VkXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHNhbXBsZXNfdG9fZW5jb2RlICs9IDE2LiAqIGdmcC5vdXRfc2FtcGxlcmF0ZSAvIGdmcC5pbl9zYW1wbGVyYXRlO1xuICAgICAgICB9XG4gICAgICAgIGVuZF9wYWRkaW5nID0gZ2ZwLmZyYW1lc2l6ZSAtIChzYW1wbGVzX3RvX2VuY29kZSAlIGdmcC5mcmFtZXNpemUpO1xuICAgICAgICBpZiAoZW5kX3BhZGRpbmcgPCA1NzYpXG4gICAgICAgICAgICBlbmRfcGFkZGluZyArPSBnZnAuZnJhbWVzaXplO1xuICAgICAgICBnZnAuZW5jb2Rlcl9wYWRkaW5nID0gZW5kX3BhZGRpbmc7XG5cbiAgICAgICAgZnJhbWVzX2xlZnQgPSAoc2FtcGxlc190b19lbmNvZGUgKyBlbmRfcGFkZGluZykgLyBnZnAuZnJhbWVzaXplO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHNlbmQgaW4gYSBmcmFtZSBvZiAwIHBhZGRpbmcgdW50aWwgYWxsIGludGVybmFsIHNhbXBsZSBidWZmZXJzIGFyZVxuICAgICAgICAgKiBmbHVzaGVkXG4gICAgICAgICAqL1xuICAgICAgICB3aGlsZSAoZnJhbWVzX2xlZnQgPiAwICYmIGltcDMgPj0gMCkge1xuICAgICAgICAgICAgdmFyIGJ1bmNoID0gbWZfbmVlZGVkIC0gZ2ZjLm1mX3NpemU7XG4gICAgICAgICAgICB2YXIgZnJhbWVfbnVtID0gZ2ZwLmZyYW1lTnVtO1xuXG4gICAgICAgICAgICBidW5jaCAqPSBnZnAuaW5fc2FtcGxlcmF0ZTtcbiAgICAgICAgICAgIGJ1bmNoIC89IGdmcC5vdXRfc2FtcGxlcmF0ZTtcbiAgICAgICAgICAgIGlmIChidW5jaCA+IDExNTIpXG4gICAgICAgICAgICAgICAgYnVuY2ggPSAxMTUyO1xuICAgICAgICAgICAgaWYgKGJ1bmNoIDwgMSlcbiAgICAgICAgICAgICAgICBidW5jaCA9IDE7XG5cbiAgICAgICAgICAgIG1wM2J1ZmZlcl9zaXplX3JlbWFpbmluZyA9IG1wM2J1ZmZlcl9zaXplIC0gbXAzY291bnQ7XG5cbiAgICAgICAgICAgIC8qIGlmIHVzZXIgc3BlY2lmZWQgYnVmZmVyIHNpemUgPSAwLCBkb250IGNoZWNrIHNpemUgKi9cbiAgICAgICAgICAgIGlmIChtcDNidWZmZXJfc2l6ZSA9PSAwKVxuICAgICAgICAgICAgICAgIG1wM2J1ZmZlcl9zaXplX3JlbWFpbmluZyA9IDA7XG5cbiAgICAgICAgICAgIGltcDMgPSB0aGlzLmxhbWVfZW5jb2RlX2J1ZmZlcihnZnAsIGJ1ZmZlclswXSwgYnVmZmVyWzFdLCBidW5jaCxcbiAgICAgICAgICAgICAgICBtcDNidWZmZXIsIG1wM2J1ZmZlclBvcywgbXAzYnVmZmVyX3NpemVfcmVtYWluaW5nKTtcblxuICAgICAgICAgICAgbXAzYnVmZmVyUG9zICs9IGltcDM7XG4gICAgICAgICAgICBtcDNjb3VudCArPSBpbXAzO1xuICAgICAgICAgICAgZnJhbWVzX2xlZnQgLT0gKGZyYW1lX251bSAhPSBnZnAuZnJhbWVOdW0pID8gMSA6IDA7XG4gICAgICAgIH1cbiAgICAgICAgLypcbiAgICAgICAgICogU2V0IGdmYy5tZl9zYW1wbGVzX3RvX2VuY29kZSB0byAwLCBzbyB3ZSBtYXkgZGV0ZWN0IGFuZCBicmVhayBsb29wc1xuICAgICAgICAgKiBjYWxsaW5nIGl0IG1vcmUgdGhhbiBvbmNlIGluIGEgcm93LlxuICAgICAgICAgKi9cbiAgICAgICAgZ2ZjLm1mX3NhbXBsZXNfdG9fZW5jb2RlID0gMDtcblxuICAgICAgICBpZiAoaW1wMyA8IDApIHtcbiAgICAgICAgICAgIC8qIHNvbWUgdHlwZSBvZiBmYXRhbCBlcnJvciAqL1xuICAgICAgICAgICAgcmV0dXJuIGltcDM7XG4gICAgICAgIH1cblxuICAgICAgICBtcDNidWZmZXJfc2l6ZV9yZW1haW5pbmcgPSBtcDNidWZmZXJfc2l6ZSAtIG1wM2NvdW50O1xuICAgICAgICAvKiBpZiB1c2VyIHNwZWNpZmVkIGJ1ZmZlciBzaXplID0gMCwgZG9udCBjaGVjayBzaXplICovXG4gICAgICAgIGlmIChtcDNidWZmZXJfc2l6ZSA9PSAwKVxuICAgICAgICAgICAgbXAzYnVmZmVyX3NpemVfcmVtYWluaW5nID0gMDtcblxuICAgICAgICAvKiBtcDMgcmVsYXRlZCBzdHVmZi4gYml0IGJ1ZmZlciBtaWdodCBzdGlsbCBjb250YWluIHNvbWUgbXAzIGRhdGEgKi9cbiAgICAgICAgYnMuZmx1c2hfYml0c3RyZWFtKGdmcCk7XG4gICAgICAgIGltcDMgPSBicy5jb3B5X2J1ZmZlcihnZmMsIG1wM2J1ZmZlciwgbXAzYnVmZmVyUG9zLFxuICAgICAgICAgICAgbXAzYnVmZmVyX3NpemVfcmVtYWluaW5nLCAxKTtcbiAgICAgICAgaWYgKGltcDMgPCAwKSB7XG4gICAgICAgICAgICAvKiBzb21lIHR5cGUgb2YgZmF0YWwgZXJyb3IgKi9cbiAgICAgICAgICAgIHJldHVybiBpbXAzO1xuICAgICAgICB9XG4gICAgICAgIG1wM2J1ZmZlclBvcyArPSBpbXAzO1xuICAgICAgICBtcDNjb3VudCArPSBpbXAzO1xuICAgICAgICBtcDNidWZmZXJfc2l6ZV9yZW1haW5pbmcgPSBtcDNidWZmZXJfc2l6ZSAtIG1wM2NvdW50O1xuICAgICAgICAvKiBpZiB1c2VyIHNwZWNpZmVkIGJ1ZmZlciBzaXplID0gMCwgZG9udCBjaGVjayBzaXplICovXG4gICAgICAgIGlmIChtcDNidWZmZXJfc2l6ZSA9PSAwKVxuICAgICAgICAgICAgbXAzYnVmZmVyX3NpemVfcmVtYWluaW5nID0gMDtcblxuICAgICAgICBpZiAoZ2ZwLndyaXRlX2lkM3RhZ19hdXRvbWF0aWMpIHtcbiAgICAgICAgICAgIC8qIHdyaXRlIGEgaWQzIHRhZyB0byB0aGUgYml0c3RyZWFtICovXG4gICAgICAgICAgICBpZDMuaWQzdGFnX3dyaXRlX3YxKGdmcCk7XG5cbiAgICAgICAgICAgIGltcDMgPSBicy5jb3B5X2J1ZmZlcihnZmMsIG1wM2J1ZmZlciwgbXAzYnVmZmVyUG9zLFxuICAgICAgICAgICAgICAgIG1wM2J1ZmZlcl9zaXplX3JlbWFpbmluZywgMCk7XG5cbiAgICAgICAgICAgIGlmIChpbXAzIDwgMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbXAzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbXAzY291bnQgKz0gaW1wMztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbXAzY291bnQ7XG4gICAgfTtcblxuICAgIHRoaXMubGFtZV9lbmNvZGVfYnVmZmVyID0gZnVuY3Rpb24gKGdmcCwgYnVmZmVyX2wsIGJ1ZmZlcl9yLCBuc2FtcGxlcywgbXAzYnVmLCBtcDNidWZQb3MsIG1wM2J1Zl9zaXplKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBpbl9idWZmZXIgPSBbbnVsbCwgbnVsbF07XG5cbiAgICAgICAgaWYgKGdmYy5DbGFzc19JRCAhPSBMQU1FX0lEKVxuICAgICAgICAgICAgcmV0dXJuIC0zO1xuXG4gICAgICAgIGlmIChuc2FtcGxlcyA9PSAwKVxuICAgICAgICAgICAgcmV0dXJuIDA7XG5cbiAgICAgICAgdXBkYXRlX2luYnVmZmVyX3NpemUoZ2ZjLCBuc2FtcGxlcyk7XG5cbiAgICAgICAgaW5fYnVmZmVyWzBdID0gZ2ZjLmluX2J1ZmZlcl8wO1xuICAgICAgICBpbl9idWZmZXJbMV0gPSBnZmMuaW5fYnVmZmVyXzE7XG5cbiAgICAgICAgLyogbWFrZSBhIGNvcHkgb2YgaW5wdXQgYnVmZmVyLCBjaGFuZ2luZyB0eXBlIHRvIHNhbXBsZV90ICovXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnNhbXBsZXM7IGkrKykge1xuICAgICAgICAgICAgaW5fYnVmZmVyWzBdW2ldID0gYnVmZmVyX2xbaV07XG4gICAgICAgICAgICBpZiAoZ2ZjLmNoYW5uZWxzX2luID4gMSlcbiAgICAgICAgICAgICAgICBpbl9idWZmZXJbMV1baV0gPSBidWZmZXJfcltpXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBsYW1lX2VuY29kZV9idWZmZXJfc2FtcGxlKGdmcCwgaW5fYnVmZmVyWzBdLCBpbl9idWZmZXJbMV0sXG4gICAgICAgICAgICBuc2FtcGxlcywgbXAzYnVmLCBtcDNidWZQb3MsIG1wM2J1Zl9zaXplKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjYWxjTmVlZGVkKGdmcCkge1xuICAgICAgICB2YXIgbWZfbmVlZGVkID0gRW5jb2Rlci5CTEtTSVpFICsgZ2ZwLmZyYW1lc2l6ZSAtIEVuY29kZXIuRkZUT0ZGU0VUO1xuICAgICAgICAvKlxuICAgICAgICAgKiBhbW91bnQgbmVlZGVkIGZvciBGRlRcbiAgICAgICAgICovXG4gICAgICAgIG1mX25lZWRlZCA9IE1hdGgubWF4KG1mX25lZWRlZCwgNTEyICsgZ2ZwLmZyYW1lc2l6ZSAtIDMyKTtcblxuICAgICAgICByZXR1cm4gbWZfbmVlZGVkO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxhbWVfZW5jb2RlX2J1ZmZlcl9zYW1wbGUoZ2ZwLCBidWZmZXJfbCwgYnVmZmVyX3IsIG5zYW1wbGVzLCBtcDNidWYsIG1wM2J1ZlBvcywgbXAzYnVmX3NpemUpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIG1wM3NpemUgPSAwLCByZXQsIGksIGNoLCBtZl9uZWVkZWQ7XG4gICAgICAgIHZhciBtcDNvdXQ7XG4gICAgICAgIHZhciBtZmJ1ZiA9IFtudWxsLCBudWxsXTtcbiAgICAgICAgdmFyIGluX2J1ZmZlciA9IFtudWxsLCBudWxsXTtcblxuICAgICAgICBpZiAoZ2ZjLkNsYXNzX0lEICE9IExBTUVfSUQpXG4gICAgICAgICAgICByZXR1cm4gLTM7XG5cbiAgICAgICAgaWYgKG5zYW1wbGVzID09IDApXG4gICAgICAgICAgICByZXR1cm4gMDtcblxuICAgICAgICAvKiBjb3B5IG91dCBhbnkgdGFncyB0aGF0IG1heSBoYXZlIGJlZW4gd3JpdHRlbiBpbnRvIGJpdHN0cmVhbSAqL1xuICAgICAgICBtcDNvdXQgPSBicy5jb3B5X2J1ZmZlcihnZmMsIG1wM2J1ZiwgbXAzYnVmUG9zLCBtcDNidWZfc2l6ZSwgMCk7XG4gICAgICAgIGlmIChtcDNvdXQgPCAwKVxuICAgICAgICAgICAgcmV0dXJuIG1wM291dDtcbiAgICAgICAgLyogbm90IGVub3VnaCBidWZmZXIgc3BhY2UgKi9cbiAgICAgICAgbXAzYnVmUG9zICs9IG1wM291dDtcbiAgICAgICAgbXAzc2l6ZSArPSBtcDNvdXQ7XG5cbiAgICAgICAgaW5fYnVmZmVyWzBdID0gYnVmZmVyX2w7XG4gICAgICAgIGluX2J1ZmZlclsxXSA9IGJ1ZmZlcl9yO1xuXG4gICAgICAgIC8qIEFwcGx5IHVzZXIgZGVmaW5lZCByZS1zY2FsaW5nICovXG5cbiAgICAgICAgLyogdXNlciBzZWxlY3RlZCBzY2FsaW5nIG9mIHRoZSBzYW1wbGVzICovXG4gICAgICAgIGlmIChCaXRTdHJlYW0uTkVRKGdmcC5zY2FsZSwgMCkgJiYgQml0U3RyZWFtLk5FUShnZnAuc2NhbGUsIDEuMCkpIHtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBuc2FtcGxlczsgKytpKSB7XG4gICAgICAgICAgICAgICAgaW5fYnVmZmVyWzBdW2ldICo9IGdmcC5zY2FsZTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLmNoYW5uZWxzX291dCA9PSAyKVxuICAgICAgICAgICAgICAgICAgICBpbl9idWZmZXJbMV1baV0gKj0gZ2ZwLnNjYWxlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogdXNlciBzZWxlY3RlZCBzY2FsaW5nIG9mIHRoZSBjaGFubmVsIDAgKGxlZnQpIHNhbXBsZXMgKi9cbiAgICAgICAgaWYgKEJpdFN0cmVhbS5ORVEoZ2ZwLnNjYWxlX2xlZnQsIDApXG4gICAgICAgICAgICAmJiBCaXRTdHJlYW0uTkVRKGdmcC5zY2FsZV9sZWZ0LCAxLjApKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbnNhbXBsZXM7ICsraSkge1xuICAgICAgICAgICAgICAgIGluX2J1ZmZlclswXVtpXSAqPSBnZnAuc2NhbGVfbGVmdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIHVzZXIgc2VsZWN0ZWQgc2NhbGluZyBvZiB0aGUgY2hhbm5lbCAxIChyaWdodCkgc2FtcGxlcyAqL1xuICAgICAgICBpZiAoQml0U3RyZWFtLk5FUShnZnAuc2NhbGVfcmlnaHQsIDApXG4gICAgICAgICAgICAmJiBCaXRTdHJlYW0uTkVRKGdmcC5zY2FsZV9yaWdodCwgMS4wKSkge1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG5zYW1wbGVzOyArK2kpIHtcbiAgICAgICAgICAgICAgICBpbl9idWZmZXJbMV1baV0gKj0gZ2ZwLnNjYWxlX3JpZ2h0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogRG93bnNhbXBsZSB0byBNb25vIGlmIDIgY2hhbm5lbHMgaW4gYW5kIDEgY2hhbm5lbCBvdXQgKi9cbiAgICAgICAgaWYgKGdmcC5udW1fY2hhbm5lbHMgPT0gMiAmJiBnZmMuY2hhbm5lbHNfb3V0ID09IDEpIHtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBuc2FtcGxlczsgKytpKSB7XG4gICAgICAgICAgICAgICAgaW5fYnVmZmVyWzBdW2ldID0gMC41ICogKCBpbl9idWZmZXJbMF1baV0gKyBpbl9idWZmZXJbMV1baV0pO1xuICAgICAgICAgICAgICAgIGluX2J1ZmZlclsxXVtpXSA9IDAuMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIG1mX25lZWRlZCA9IGNhbGNOZWVkZWQoZ2ZwKTtcblxuICAgICAgICBtZmJ1ZlswXSA9IGdmYy5tZmJ1ZlswXTtcbiAgICAgICAgbWZidWZbMV0gPSBnZmMubWZidWZbMV07XG5cbiAgICAgICAgdmFyIGluX2J1ZmZlclBvcyA9IDA7XG4gICAgICAgIHdoaWxlIChuc2FtcGxlcyA+IDApIHtcbiAgICAgICAgICAgIHZhciBpbl9idWZmZXJfcHRyID0gW251bGwsIG51bGxdO1xuICAgICAgICAgICAgdmFyIG5faW4gPSAwO1xuICAgICAgICAgICAgLyogbnVtYmVyIG9mIGlucHV0IHNhbXBsZXMgcHJvY2Vzc2VkIHdpdGggZmlsbF9idWZmZXIgKi9cbiAgICAgICAgICAgIHZhciBuX291dCA9IDA7XG4gICAgICAgICAgICAvKiBudW1iZXIgb2Ygc2FtcGxlcyBvdXRwdXQgd2l0aCBmaWxsX2J1ZmZlciAqL1xuICAgICAgICAgICAgLyogbl9pbiA8PiBuX291dCBpZiB3ZSBhcmUgcmVzYW1wbGluZyAqL1xuXG4gICAgICAgICAgICBpbl9idWZmZXJfcHRyWzBdID0gaW5fYnVmZmVyWzBdO1xuICAgICAgICAgICAgaW5fYnVmZmVyX3B0clsxXSA9IGluX2J1ZmZlclsxXTtcbiAgICAgICAgICAgIC8qIGNvcHkgaW4gbmV3IHNhbXBsZXMgaW50byBtZmJ1Ziwgd2l0aCByZXNhbXBsaW5nICovXG4gICAgICAgICAgICB2YXIgaW5PdXQgPSBuZXcgSW5PdXQoKTtcbiAgICAgICAgICAgIGZpbGxfYnVmZmVyKGdmcCwgbWZidWYsIGluX2J1ZmZlcl9wdHIsIGluX2J1ZmZlclBvcywgbnNhbXBsZXMsXG4gICAgICAgICAgICAgICAgaW5PdXQpO1xuICAgICAgICAgICAgbl9pbiA9IGluT3V0Lm5faW47XG4gICAgICAgICAgICBuX291dCA9IGluT3V0Lm5fb3V0O1xuXG4gICAgICAgICAgICAvKiBjb21wdXRlIFJlcGxheUdhaW4gb2YgcmVzYW1wbGVkIGlucHV0IGlmIHJlcXVlc3RlZCAqL1xuICAgICAgICAgICAgaWYgKGdmYy5maW5kUmVwbGF5R2FpbiAmJiAhZ2ZjLmRlY29kZV9vbl90aGVfZmx5KVxuICAgICAgICAgICAgICAgIGlmIChnYS5BbmFseXplU2FtcGxlcyhnZmMucmdkYXRhLCBtZmJ1ZlswXSwgZ2ZjLm1mX3NpemUsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZmJ1ZlsxXSwgZ2ZjLm1mX3NpemUsIG5fb3V0LCBnZmMuY2hhbm5lbHNfb3V0KSA9PSBHYWluQW5hbHlzaXMuR0FJTl9BTkFMWVNJU19FUlJPUilcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC02O1xuXG4gICAgICAgICAgICAvKiB1cGRhdGUgaW5fYnVmZmVyIGNvdW50ZXJzICovXG4gICAgICAgICAgICBuc2FtcGxlcyAtPSBuX2luO1xuICAgICAgICAgICAgaW5fYnVmZmVyUG9zICs9IG5faW47XG4gICAgICAgICAgICBpZiAoZ2ZjLmNoYW5uZWxzX291dCA9PSAyKVxuICAgICAgICAgICAgICAgIDsvLyBpbl9idWZmZXJQb3MgKz0gbl9pbjtcblxuICAgICAgICAgICAgLyogdXBkYXRlIG1mYnVmW10gY291bnRlcnMgKi9cbiAgICAgICAgICAgIGdmYy5tZl9zaXplICs9IG5fb3V0O1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogbGFtZV9lbmNvZGVfZmx1c2ggbWF5IGhhdmUgc2V0IGdmYy5tZl9zYW1wbGVfdG9fZW5jb2RlIHRvIDAgc28gd2VcbiAgICAgICAgICAgICAqIGhhdmUgdG8gcmVpbml0aWFsaXplIGl0IGhlcmUgd2hlbiB0aGF0IGhhcHBlbmVkLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAoZ2ZjLm1mX3NhbXBsZXNfdG9fZW5jb2RlIDwgMSkge1xuICAgICAgICAgICAgICAgIGdmYy5tZl9zYW1wbGVzX3RvX2VuY29kZSA9IEVuY29kZXIuRU5DREVMQVkgKyBFbmNvZGVyLlBPU1RERUxBWTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy5tZl9zYW1wbGVzX3RvX2VuY29kZSArPSBuX291dDtcblxuICAgICAgICAgICAgaWYgKGdmYy5tZl9zaXplID49IG1mX25lZWRlZCkge1xuICAgICAgICAgICAgICAgIC8qIGVuY29kZSB0aGUgZnJhbWUuICovXG4gICAgICAgICAgICAgICAgLyogbXAzYnVmID0gcG9pbnRlciB0byBjdXJyZW50IGxvY2F0aW9uIGluIGJ1ZmZlciAqL1xuICAgICAgICAgICAgICAgIC8qIG1wM2J1Zl9zaXplID0gc2l6ZSBvZiBvcmlnaW5hbCBtcDMgb3V0cHV0IGJ1ZmZlciAqL1xuICAgICAgICAgICAgICAgIC8qID0gMCBpZiB3ZSBzaG91bGQgbm90IHdvcnJ5IGFib3V0IHRoZSAqL1xuICAgICAgICAgICAgICAgIC8qIGJ1ZmZlciBzaXplIGJlY2F1c2UgY2FsbGluZyBwcm9ncmFtIGlzICovXG4gICAgICAgICAgICAgICAgLyogdG8gbGF6eSB0byBjb21wdXRlIGl0ICovXG4gICAgICAgICAgICAgICAgLyogbXAzc2l6ZSA9IHNpemUgb2YgZGF0YSB3cml0dGVuIHRvIGJ1ZmZlciBzbyBmYXIgKi9cbiAgICAgICAgICAgICAgICAvKiBtcDNidWZfc2l6ZS1tcDNzaXplID0gYW1vdW50IG9mIHNwYWNlIGF2YWxhYmxlICovXG5cbiAgICAgICAgICAgICAgICB2YXIgYnVmX3NpemUgPSBtcDNidWZfc2l6ZSAtIG1wM3NpemU7XG4gICAgICAgICAgICAgICAgaWYgKG1wM2J1Zl9zaXplID09IDApXG4gICAgICAgICAgICAgICAgICAgIGJ1Zl9zaXplID0gMDtcblxuICAgICAgICAgICAgICAgIHJldCA9IGxhbWVfZW5jb2RlX2ZyYW1lKGdmcCwgbWZidWZbMF0sIG1mYnVmWzFdLCBtcDNidWYsXG4gICAgICAgICAgICAgICAgICAgIG1wM2J1ZlBvcywgYnVmX3NpemUpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHJldCA8IDApXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXQ7XG4gICAgICAgICAgICAgICAgbXAzYnVmUG9zICs9IHJldDtcbiAgICAgICAgICAgICAgICBtcDNzaXplICs9IHJldDtcblxuICAgICAgICAgICAgICAgIC8qIHNoaWZ0IG91dCBvbGQgc2FtcGxlcyAqL1xuICAgICAgICAgICAgICAgIGdmYy5tZl9zaXplIC09IGdmcC5mcmFtZXNpemU7XG4gICAgICAgICAgICAgICAgZ2ZjLm1mX3NhbXBsZXNfdG9fZW5jb2RlIC09IGdmcC5mcmFtZXNpemU7XG4gICAgICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKylcbiAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGdmYy5tZl9zaXplOyBpKyspXG4gICAgICAgICAgICAgICAgICAgICAgICBtZmJ1ZltjaF1baV0gPSBtZmJ1ZltjaF1baSArIGdmcC5mcmFtZXNpemVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG1wM3NpemU7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGFtZV9lbmNvZGVfZnJhbWUoZ2ZwLCBpbmJ1Zl9sLCBpbmJ1Zl9yLCBtcDNidWYsIG1wM2J1ZlBvcywgbXAzYnVmX3NpemUpIHtcbiAgICAgICAgdmFyIHJldCA9IHNlbGYuZW5jLmxhbWVfZW5jb2RlX21wM19mcmFtZShnZnAsIGluYnVmX2wsIGluYnVmX3IsIG1wM2J1ZixcbiAgICAgICAgICAgIG1wM2J1ZlBvcywgbXAzYnVmX3NpemUpO1xuICAgICAgICBnZnAuZnJhbWVOdW0rKztcbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBJbk91dCgpIHtcbiAgICAgICAgdGhpcy5uX2luID0gMDtcbiAgICAgICAgdGhpcy5uX291dCA9IDA7XG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiBOdW1Vc2VkKCkge1xuICAgICAgICB0aGlzLm51bV91c2VkID0gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHcmVhdGVzdCBjb21tb24gZGl2aXNvci5cbiAgICAgKiA8cD5cbiAgICAgKiBKb2ludCB3b3JrIG9mIEV1Y2xpZCBhbmQgTS4gSGVuZHJ5XG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2NkKGksIGopIHtcbiAgICAgICAgcmV0dXJuIGogIT0gMCA/IGdjZChqLCBpICUgaikgOiBpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlc2FtcGxpbmcgdmlhIEZJUiBmaWx0ZXIsIGJsYWNrbWFuIHdpbmRvdy5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBibGFja21hbih4LCBmY24sIGwpIHtcbiAgICAgICAgLypcbiAgICAgICAgICogVGhpcyBhbGdvcml0aG0gZnJvbTogU0lHTkFMIFBST0NFU1NJTkcgQUxHT1JJVEhNUyBJTiBGT1JUUkFOIEFORCBDXG4gICAgICAgICAqIFMuRC4gU3RlYXJucyBhbmQgUi5BLiBEYXZpZCwgUHJlbnRpY2UtSGFsbCwgMTk5MlxuICAgICAgICAgKi9cbiAgICAgICAgdmFyIHdjbiA9IChNYXRoLlBJICogZmNuKTtcblxuICAgICAgICB4IC89IGw7XG4gICAgICAgIGlmICh4IDwgMClcbiAgICAgICAgICAgIHggPSAwO1xuICAgICAgICBpZiAoeCA+IDEpXG4gICAgICAgICAgICB4ID0gMTtcbiAgICAgICAgdmFyIHgyID0geCAtIC41O1xuXG4gICAgICAgIHZhciBia3duID0gMC40MiAtIDAuNSAqIE1hdGguY29zKDIgKiB4ICogTWF0aC5QSSkgKyAwLjA4ICogTWF0aC5jb3MoNCAqIHggKiBNYXRoLlBJKTtcbiAgICAgICAgaWYgKE1hdGguYWJzKHgyKSA8IDFlLTkpXG4gICAgICAgICAgICByZXR1cm4gKHdjbiAvIE1hdGguUEkpO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4gKGJrd24gKiBNYXRoLnNpbihsICogd2NuICogeDIpIC8gKE1hdGguUEkgKiBsICogeDIpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmaWxsX2J1ZmZlcl9yZXNhbXBsZShnZnAsIG91dGJ1Ziwgb3V0YnVmUG9zLCBkZXNpcmVkX2xlbiwgaW5idWYsIGluX2J1ZmZlclBvcywgbGVuLCBudW1fdXNlZCwgY2gpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGksIGogPSAwLCBrO1xuICAgICAgICAvKiBudW1iZXIgb2YgY29udm9sdXRpb24gZnVuY3Rpb25zIHRvIHByZS1jb21wdXRlICovXG4gICAgICAgIHZhciBicGMgPSBnZnAub3V0X3NhbXBsZXJhdGVcbiAgICAgICAgICAgIC8gZ2NkKGdmcC5vdXRfc2FtcGxlcmF0ZSwgZ2ZwLmluX3NhbXBsZXJhdGUpO1xuICAgICAgICBpZiAoYnBjID4gTGFtZUludGVybmFsRmxhZ3MuQlBDKVxuICAgICAgICAgICAgYnBjID0gTGFtZUludGVybmFsRmxhZ3MuQlBDO1xuXG4gICAgICAgIHZhciBpbnRyYXRpbyA9IChNYXRoLmFicyhnZmMucmVzYW1wbGVfcmF0aW9cbiAgICAgICAgICAgIC0gTWF0aC5mbG9vciguNSArIGdmYy5yZXNhbXBsZV9yYXRpbykpIDwgLjAwMDEpID8gMSA6IDA7XG4gICAgICAgIHZhciBmY24gPSAxLjAwIC8gZ2ZjLnJlc2FtcGxlX3JhdGlvO1xuICAgICAgICBpZiAoZmNuID4gMS4wMClcbiAgICAgICAgICAgIGZjbiA9IDEuMDA7XG4gICAgICAgIHZhciBmaWx0ZXJfbCA9IDMxO1xuICAgICAgICBpZiAoMCA9PSBmaWx0ZXJfbCAlIDIpXG4gICAgICAgICAgICAtLWZpbHRlcl9sO1xuICAgICAgICAvKiBtdXN0IGJlIG9kZCAqL1xuICAgICAgICBmaWx0ZXJfbCArPSBpbnRyYXRpbztcbiAgICAgICAgLyogdW5sZXNzIHJlc2FtcGxlX3JhdGlvPWludCwgaXQgbXVzdCBiZSBldmVuICovXG5cbiAgICAgICAgdmFyIEJMQUNLU0laRSA9IGZpbHRlcl9sICsgMTtcbiAgICAgICAgLyogc2l6ZSBvZiBkYXRhIG5lZWRlZCBmb3IgRklSICovXG5cbiAgICAgICAgaWYgKGdmYy5maWxsX2J1ZmZlcl9yZXNhbXBsZV9pbml0ID09IDApIHtcbiAgICAgICAgICAgIGdmYy5pbmJ1Zl9vbGRbMF0gPSBuZXdfZmxvYXQoQkxBQ0tTSVpFKTtcbiAgICAgICAgICAgIGdmYy5pbmJ1Zl9vbGRbMV0gPSBuZXdfZmxvYXQoQkxBQ0tTSVpFKTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPD0gMiAqIGJwYzsgKytpKVxuICAgICAgICAgICAgICAgIGdmYy5ibGFja2ZpbHRbaV0gPSBuZXdfZmxvYXQoQkxBQ0tTSVpFKTtcblxuICAgICAgICAgICAgZ2ZjLml0aW1lWzBdID0gMDtcbiAgICAgICAgICAgIGdmYy5pdGltZVsxXSA9IDA7XG5cbiAgICAgICAgICAgIC8qIHByZWNvbXB1dGUgYmxhY2ttYW4gZmlsdGVyIGNvZWZmaWNpZW50cyAqL1xuICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8PSAyICogYnBjOyBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgc3VtID0gMC47XG4gICAgICAgICAgICAgICAgdmFyIG9mZnNldCA9IChqIC0gYnBjKSAvICgyLiAqIGJwYyk7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8PSBmaWx0ZXJfbDsgaSsrKVxuICAgICAgICAgICAgICAgICAgICBzdW0gKz0gZ2ZjLmJsYWNrZmlsdFtqXVtpXSA9IGJsYWNrbWFuKGkgLSBvZmZzZXQsIGZjbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcl9sKTtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDw9IGZpbHRlcl9sOyBpKyspXG4gICAgICAgICAgICAgICAgICAgIGdmYy5ibGFja2ZpbHRbal1baV0gLz0gc3VtO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLmZpbGxfYnVmZmVyX3Jlc2FtcGxlX2luaXQgPSAxO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGluYnVmX29sZCA9IGdmYy5pbmJ1Zl9vbGRbY2hdO1xuXG4gICAgICAgIC8qIHRpbWUgb2Ygaid0aCBlbGVtZW50IGluIGluYnVmID0gaXRpbWUgKyBqL2lmcmVxOyAqL1xuICAgICAgICAvKiB0aW1lIG9mIGsndGggZWxlbWVudCBpbiBvdXRidWYgPSBqL29mcmVxICovXG4gICAgICAgIGZvciAoayA9IDA7IGsgPCBkZXNpcmVkX2xlbjsgaysrKSB7XG4gICAgICAgICAgICB2YXIgdGltZTA7XG4gICAgICAgICAgICB2YXIgam9mZjtcblxuICAgICAgICAgICAgdGltZTAgPSBrICogZ2ZjLnJlc2FtcGxlX3JhdGlvO1xuICAgICAgICAgICAgLyogdGltZSBvZiBrJ3RoIG91dHB1dCBzYW1wbGUgKi9cbiAgICAgICAgICAgIGogPSAwIHwgTWF0aC5mbG9vcih0aW1lMCAtIGdmYy5pdGltZVtjaF0pO1xuXG4gICAgICAgICAgICAvKiBjaGVjayBpZiB3ZSBuZWVkIG1vcmUgaW5wdXQgZGF0YSAqL1xuICAgICAgICAgICAgaWYgKChmaWx0ZXJfbCArIGogLSBmaWx0ZXJfbCAvIDIpID49IGxlbilcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgLyogYmxhY2ttYW4gZmlsdGVyLiBieSBkZWZhdWx0LCB3aW5kb3cgY2VudGVyZWQgYXQgaisuNShmaWx0ZXJfbCUyKSAqL1xuICAgICAgICAgICAgLyogYnV0IHdlIHdhbnQgYSB3aW5kb3cgY2VudGVyZWQgYXQgdGltZTAuICovXG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gKHRpbWUwIC0gZ2ZjLml0aW1lW2NoXSAtIChqICsgLjUgKiAoZmlsdGVyX2wgJSAyKSkpO1xuXG4gICAgICAgICAgICAvKiBmaW5kIHRoZSBjbG9zZXN0IHByZWNvbXB1dGVkIHdpbmRvdyBmb3IgdGhpcyBvZmZzZXQ6ICovXG4gICAgICAgICAgICBqb2ZmID0gMCB8IE1hdGguZmxvb3IoKG9mZnNldCAqIDIgKiBicGMpICsgYnBjICsgLjUpO1xuICAgICAgICAgICAgdmFyIHh2YWx1ZSA9IDAuO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8PSBmaWx0ZXJfbDsgKytpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGoyID0gaSArIGogLSBmaWx0ZXJfbCAvIDI7XG4gICAgICAgICAgICAgICAgdmFyIHk7XG4gICAgICAgICAgICAgICAgeSA9IChqMiA8IDApID8gaW5idWZfb2xkW0JMQUNLU0laRSArIGoyXSA6IGluYnVmW2luX2J1ZmZlclBvc1xuICAgICAgICAgICAgICAgICsgajJdO1xuICAgICAgICAgICAgICAgIHh2YWx1ZSArPSB5ICogZ2ZjLmJsYWNrZmlsdFtqb2ZmXVtpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG91dGJ1ZltvdXRidWZQb3MgKyBrXSA9IHh2YWx1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGsgPSBudW1iZXIgb2Ygc2FtcGxlcyBhZGRlZCB0byBvdXRidWYgKi9cbiAgICAgICAgLyogbGFzdCBrIHNhbXBsZSB1c2VkIGRhdGEgZnJvbSBbai1maWx0ZXJfbC8yLGorZmlsdGVyX2wtZmlsdGVyX2wvMl0gKi9cblxuICAgICAgICAvKiBob3cgbWFueSBzYW1wbGVzIG9mIGlucHV0IGRhdGEgd2VyZSB1c2VkOiAqL1xuICAgICAgICBudW1fdXNlZC5udW1fdXNlZCA9IE1hdGgubWluKGxlbiwgZmlsdGVyX2wgKyBqIC0gZmlsdGVyX2wgLyAyKTtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBhZGp1c3Qgb3VyIGlucHV0IHRpbWUgY291bnRlci4gSW5jcmltZW50IGJ5IHRoZSBudW1iZXIgb2Ygc2FtcGxlc1xuICAgICAgICAgKiB1c2VkLCB0aGVuIG5vcm1hbGl6ZSBzbyB0aGF0IG5leHQgb3V0cHV0IHNhbXBsZSBpcyBhdCB0aW1lIDAsIG5leHRcbiAgICAgICAgICogaW5wdXQgYnVmZmVyIGlzIGF0IHRpbWUgaXRpbWVbY2hdXG4gICAgICAgICAqL1xuICAgICAgICBnZmMuaXRpbWVbY2hdICs9IG51bV91c2VkLm51bV91c2VkIC0gayAqIGdmYy5yZXNhbXBsZV9yYXRpbztcblxuICAgICAgICAvKiBzYXZlIHRoZSBsYXN0IEJMQUNLU0laRSBzYW1wbGVzIGludG8gdGhlIGluYnVmX29sZCBidWZmZXIgKi9cbiAgICAgICAgaWYgKG51bV91c2VkLm51bV91c2VkID49IEJMQUNLU0laRSkge1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IEJMQUNLU0laRTsgaSsrKVxuICAgICAgICAgICAgICAgIGluYnVmX29sZFtpXSA9IGluYnVmW2luX2J1ZmZlclBvcyArIG51bV91c2VkLm51bV91c2VkICsgaVxuICAgICAgICAgICAgICAgIC0gQkxBQ0tTSVpFXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8qIHNoaWZ0IGluIG51bV91c2VkLm51bV91c2VkIHNhbXBsZXMgaW50byBpbmJ1Zl9vbGQgKi9cbiAgICAgICAgICAgIHZhciBuX3NoaWZ0ID0gQkxBQ0tTSVpFIC0gbnVtX3VzZWQubnVtX3VzZWQ7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogbnVtYmVyIG9mIHNhbXBsZXMgdG9cbiAgICAgICAgICAgICAqIHNoaWZ0XG4gICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIHNoaWZ0IG5fc2hpZnQgc2FtcGxlcyBieSBudW1fdXNlZC5udW1fdXNlZCwgdG8gbWFrZSByb29tIGZvciB0aGVcbiAgICAgICAgICAgICAqIG51bV91c2VkIG5ldyBzYW1wbGVzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBuX3NoaWZ0OyArK2kpXG4gICAgICAgICAgICAgICAgaW5idWZfb2xkW2ldID0gaW5idWZfb2xkW2kgKyBudW1fdXNlZC5udW1fdXNlZF07XG5cbiAgICAgICAgICAgIC8qIHNoaWZ0IGluIHRoZSBudW1fdXNlZC5udW1fdXNlZCBzYW1wbGVzICovXG4gICAgICAgICAgICBmb3IgKGogPSAwOyBpIDwgQkxBQ0tTSVpFOyArK2ksICsrailcbiAgICAgICAgICAgICAgICBpbmJ1Zl9vbGRbaV0gPSBpbmJ1Zltpbl9idWZmZXJQb3MgKyBqXTtcblxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBrO1xuICAgICAgICAvKiByZXR1cm4gdGhlIG51bWJlciBzYW1wbGVzIGNyZWF0ZWQgYXQgdGhlIG5ldyBzYW1wbGVyYXRlICovXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZmlsbF9idWZmZXIoZ2ZwLCBtZmJ1ZiwgaW5fYnVmZmVyLCBpbl9idWZmZXJQb3MsIG5zYW1wbGVzLCBpbykge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXG4gICAgICAgIC8qIGNvcHkgaW4gbmV3IHNhbXBsZXMgaW50byBtZmJ1Ziwgd2l0aCByZXNhbXBsaW5nIGlmIG5lY2Vzc2FyeSAqL1xuICAgICAgICBpZiAoKGdmYy5yZXNhbXBsZV9yYXRpbyA8IC45OTk5KSB8fCAoZ2ZjLnJlc2FtcGxlX3JhdGlvID4gMS4wMDAxKSkge1xuICAgICAgICAgICAgZm9yICh2YXIgY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgbnVtVXNlZCA9IG5ldyBOdW1Vc2VkKCk7XG4gICAgICAgICAgICAgICAgaW8ubl9vdXQgPSBmaWxsX2J1ZmZlcl9yZXNhbXBsZShnZnAsIG1mYnVmW2NoXSwgZ2ZjLm1mX3NpemUsXG4gICAgICAgICAgICAgICAgICAgIGdmcC5mcmFtZXNpemUsIGluX2J1ZmZlcltjaF0sIGluX2J1ZmZlclBvcywgbnNhbXBsZXMsXG4gICAgICAgICAgICAgICAgICAgIG51bVVzZWQsIGNoKTtcbiAgICAgICAgICAgICAgICBpby5uX2luID0gbnVtVXNlZC5udW1fdXNlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlvLm5fb3V0ID0gTWF0aC5taW4oZ2ZwLmZyYW1lc2l6ZSwgbnNhbXBsZXMpO1xuICAgICAgICAgICAgaW8ubl9pbiA9IGlvLm5fb3V0O1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpby5uX291dDsgKytpKSB7XG4gICAgICAgICAgICAgICAgbWZidWZbMF1bZ2ZjLm1mX3NpemUgKyBpXSA9IGluX2J1ZmZlclswXVtpbl9idWZmZXJQb3MgKyBpXTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLmNoYW5uZWxzX291dCA9PSAyKVxuICAgICAgICAgICAgICAgICAgICBtZmJ1ZlsxXVtnZmMubWZfc2l6ZSArIGldID0gaW5fYnVmZmVyWzFdW2luX2J1ZmZlclBvcyArIGldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG59XG5cblxuXG5mdW5jdGlvbiBHZXRBdWRpbygpIHtcbiAgICB2YXIgcGFyc2U7XG4gICAgdmFyIG1wZztcblxuICAgIHRoaXMuc2V0TW9kdWxlcyA9IGZ1bmN0aW9uIChwYXJzZTIsIG1wZzIpIHtcbiAgICAgICAgcGFyc2UgPSBwYXJzZTI7XG4gICAgICAgIG1wZyA9IG1wZzI7XG4gICAgfVxufVxuXG5cbmZ1bmN0aW9uIFBhcnNlKCkge1xuICAgIHZhciB2ZXI7XG4gICAgdmFyIGlkMztcbiAgICB2YXIgcHJlO1xuXG4gICAgdGhpcy5zZXRNb2R1bGVzID0gZnVuY3Rpb24gKHZlcjIsIGlkMzIsIHByZTIpIHtcbiAgICAgICAgdmVyID0gdmVyMjtcbiAgICAgICAgaWQzID0gaWQzMjtcbiAgICAgICAgcHJlID0gcHJlMjtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIE1QR0xpYigpIHtcbn1cblxuZnVuY3Rpb24gSUQzVGFnKCkge1xuICAgIHZhciBiaXRzO1xuICAgIHZhciB2ZXI7XG5cbiAgICB0aGlzLnNldE1vZHVsZXMgPSBmdW5jdGlvbiAoX2JpdHMsIF92ZXIpIHtcbiAgICAgICAgYml0cyA9IF9iaXRzO1xuICAgICAgICB2ZXIgPSBfdmVyO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gTXAzRW5jb2RlcihjaGFubmVscywgc2FtcGxlcmF0ZSwga2Jwcykge1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoICE9IDMpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignV0FSTjogTXAzRW5jb2RlcihjaGFubmVscywgc2FtcGxlcmF0ZSwga2Jwcykgbm90IHNwZWNpZmllZCcpO1xuICAgICAgICBjaGFubmVscyA9IDE7XG4gICAgICAgIHNhbXBsZXJhdGUgPSA0NDEwMDtcbiAgICAgICAga2JwcyA9IDEyODtcbiAgICB9XG4gICAgdmFyIGxhbWUgPSBuZXcgTGFtZSgpO1xuICAgIHZhciBnYXVkID0gbmV3IEdldEF1ZGlvKCk7XG4gICAgdmFyIGdhID0gbmV3IEdhaW5BbmFseXNpcygpO1xuICAgIHZhciBicyA9IG5ldyBCaXRTdHJlYW0oKTtcbiAgICB2YXIgcCA9IG5ldyBQcmVzZXRzKCk7XG4gICAgdmFyIHF1cHZ0ID0gbmV3IFF1YW50aXplUFZUKCk7XG4gICAgdmFyIHF1ID0gbmV3IFF1YW50aXplKCk7XG4gICAgdmFyIHZiciA9IG5ldyBWQlJUYWcoKTtcbiAgICB2YXIgdmVyID0gbmV3IFZlcnNpb24oKTtcbiAgICB2YXIgaWQzID0gbmV3IElEM1RhZygpO1xuICAgIHZhciBydiA9IG5ldyBSZXNlcnZvaXIoKTtcbiAgICB2YXIgdGFrID0gbmV3IFRha2VoaXJvKCk7XG4gICAgdmFyIHBhcnNlID0gbmV3IFBhcnNlKCk7XG4gICAgdmFyIG1wZyA9IG5ldyBNUEdMaWIoKTtcblxuICAgIGxhbWUuc2V0TW9kdWxlcyhnYSwgYnMsIHAsIHF1cHZ0LCBxdSwgdmJyLCB2ZXIsIGlkMywgbXBnKTtcbiAgICBicy5zZXRNb2R1bGVzKGdhLCBtcGcsIHZlciwgdmJyKTtcbiAgICBpZDMuc2V0TW9kdWxlcyhicywgdmVyKTtcbiAgICBwLnNldE1vZHVsZXMobGFtZSk7XG4gICAgcXUuc2V0TW9kdWxlcyhicywgcnYsIHF1cHZ0LCB0YWspO1xuICAgIHF1cHZ0LnNldE1vZHVsZXModGFrLCBydiwgbGFtZS5lbmMucHN5KTtcbiAgICBydi5zZXRNb2R1bGVzKGJzKTtcbiAgICB0YWsuc2V0TW9kdWxlcyhxdXB2dCk7XG4gICAgdmJyLnNldE1vZHVsZXMobGFtZSwgYnMsIHZlcik7XG4gICAgZ2F1ZC5zZXRNb2R1bGVzKHBhcnNlLCBtcGcpO1xuICAgIHBhcnNlLnNldE1vZHVsZXModmVyLCBpZDMsIHApO1xuXG4gICAgdmFyIGdmcCA9IGxhbWUubGFtZV9pbml0KCk7XG5cbiAgICBnZnAubnVtX2NoYW5uZWxzID0gY2hhbm5lbHM7XG4gICAgZ2ZwLmluX3NhbXBsZXJhdGUgPSBzYW1wbGVyYXRlO1xuICAgIGdmcC5vdXRfc2FtcGxlcmF0ZSA9IHNhbXBsZXJhdGU7Ly9maXggYnkgeGlhbmd5dWVjbiAyMDE4LTEyLTYgMDE6NDg6MTIgNjRrYnBz5Lul5LiL5Y+v6IO95peg5aOw6Z+z77yM5omL5Yqo5o6n5Yi26L6T5Ye656CB546HXG4gICAgZ2ZwLmJyYXRlID0ga2JwcztcbiAgICBnZnAubW9kZSA9IE1QRUdNb2RlLlNURVJFTztcbiAgICBnZnAucXVhbGl0eSA9IDM7XG4gICAgZ2ZwLmJXcml0ZVZiclRhZyA9IGZhbHNlO1xuICAgIGdmcC5kaXNhYmxlX3Jlc2Vydm9pciA9IHRydWU7XG4gICAgZ2ZwLndyaXRlX2lkM3RhZ19hdXRvbWF0aWMgPSBmYWxzZTtcblxuICAgIHZhciByZXRjb2RlID0gbGFtZS5sYW1lX2luaXRfcGFyYW1zKGdmcCk7XG4gICAgdmFyIG1heFNhbXBsZXMgPSAxMTUyO1xuICAgIHZhciBtcDNidWZfc2l6ZSA9IDAgfCAoMS4yNSAqIG1heFNhbXBsZXMgKyA3MjAwKTtcbiAgICB2YXIgbXAzYnVmID0gbmV3X2J5dGUobXAzYnVmX3NpemUpO1xuXG4gICAgdGhpcy5lbmNvZGVCdWZmZXIgPSBmdW5jdGlvbiAobGVmdCwgcmlnaHQpIHtcbiAgICAgICAgaWYgKGNoYW5uZWxzID09IDEpIHtcbiAgICAgICAgICAgIHJpZ2h0ID0gbGVmdDtcbiAgICAgICAgfVxuICAgICAgICBpZiAobGVmdC5sZW5ndGggPiBtYXhTYW1wbGVzKSB7XG4gICAgICAgICAgICBtYXhTYW1wbGVzID0gbGVmdC5sZW5ndGg7XG4gICAgICAgICAgICBtcDNidWZfc2l6ZSA9IDAgfCAoMS4yNSAqIG1heFNhbXBsZXMgKyA3MjAwKTtcbiAgICAgICAgICAgIG1wM2J1ZiA9IG5ld19ieXRlKG1wM2J1Zl9zaXplKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBfc3ogPSBsYW1lLmxhbWVfZW5jb2RlX2J1ZmZlcihnZnAsIGxlZnQsIHJpZ2h0LCBsZWZ0Lmxlbmd0aCwgbXAzYnVmLCAwLCBtcDNidWZfc2l6ZSk7XG4gICAgICAgIHJldHVybiBuZXcgSW50OEFycmF5KG1wM2J1Zi5zdWJhcnJheSgwLCBfc3opKTtcbiAgICB9O1xuXG4gICAgdGhpcy5mbHVzaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF9zeiA9IGxhbWUubGFtZV9lbmNvZGVfZmx1c2goZ2ZwLCBtcDNidWYsIDAsIG1wM2J1Zl9zaXplKTtcbiAgICAgICAgcmV0dXJuIG5ldyBJbnQ4QXJyYXkobXAzYnVmLnN1YmFycmF5KDAsIF9zeikpO1xuICAgIH07XG59XG5cbi8vZml4IOeyvueugFxuTDNTaWRlLlNGQk1BWCA9IChFbmNvZGVyLlNCTUFYX3MgKiAzKTtcbi8vdGVzdEZ1bGxMZW5ndGgoKTtcbmxhbWVqcy5NcDNFbmNvZGVyID0gTXAzRW5jb2Rlcjtcbn1cbi8vZnM9cmVxdWlyZSgnZnMnKTtcbmxhbWVqcygpO1xuXG5cblJlY29yZGVyLmxhbWVqcz1sYW1lanM7XG5cbi8vZW5kMyAqKioq57uT5p2fY29weSBsYW1lanMqKioqKlxufSkoKTsiLCIvKlxubXAz57yW56CB5Zmo77yM6ZyA5bim5LiKbXAzLWVuZ2luZS5qc+W8leaTjuS9v+eUqFxuaHR0cHM6Ly9naXRodWIuY29tL3hpYW5neXVlY24vUmVjb3JkZXJcblxu5b2T54S25pyA5L2z5o6o6I2Q5L2/55SobXAz44CBd2F25qC85byP77yM5Luj56CB5Lmf5piv5LyY5YWI54Wn6aG+6L+Z5Lik56eN5qC85byPXG7mtY/op4jlmajmlK/mjIHmg4XlhrVcbmh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0hUTUwvU3VwcG9ydGVkX21lZGlhX2Zvcm1hdHNcbiovXG4oZnVuY3Rpb24oKXtcblwidXNlIHN0cmljdFwiO1xuXG5SZWNvcmRlci5wcm90b3R5cGUuZW5jX21wMz17XG5cdHN0YWJsZTp0cnVlXG5cdCx0ZXN0bXNnOlwi6YeH5qC3546H6IyD5Zu0NDgwMDAsIDQ0MTAwLCAzMjAwMCwgMjQwMDAsIDIyMDUwLCAxNjAwMCwgMTIwMDAsIDExMDI1LCA4MDAwXCJcbn07XG5cblxuXG4vLyoqKioqKirmoIflh4ZVSee6v+eoi+i9rOeggeaUr+aMgeWHveaVsCoqKioqKioqKioqKlxuXG5SZWNvcmRlci5wcm90b3R5cGUubXAzPWZ1bmN0aW9uKHJlcyxUcnVlLEZhbHNlKXtcblx0XHR2YXIgVGhpcz10aGlzLHNldD1UaGlzLnNldCxzaXplPXJlcy5sZW5ndGg7XG5cdFx0XG5cdFx0Ly/kvJjlhYjph4fnlKh3b3JrZXLnvJbnoIHvvIzlpKrkvY7niYjmnKzkuIvpnaLnlKjogIHmlrnms5Xmj5Dkvpvlhbzlrrlcblx0XHR2YXIgY3R4PVRoaXMubXAzX3N0YXJ0KHNldCk7XG5cdFx0aWYoY3R4KXtcblx0XHRcdFRoaXMubXAzX2VuY29kZShjdHgscmVzKTtcblx0XHRcdFRoaXMubXAzX2NvbXBsZXRlKGN0eCxUcnVlLEZhbHNlLDEpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH07XG5cdFx0XG5cdFx0Ly9odHRwczovL2dpdGh1Yi5jb20vd2FuZ3BlbmdmZWkxNTk3NS9yZWNvcmRlci5qc1xuXHRcdC8vaHR0cHM6Ly9naXRodWIuY29tL3podWtlci9sYW1lanMgYnVnOumHh+agt+eOh+W/hemhu+WSjOa6kOS4gOiHtO+8jOS4jeeEtjhr5pe25rKh5pyJ5aOw6Z+z77yM5pyJ6Zeu6aKYZml477yaaHR0cHM6Ly9naXRodWIuY29tL3podWtlci9sYW1lanMvcHVsbC8xMVxuXHRcdHZhciBtcDM9bmV3IFJlY29yZGVyLmxhbWVqcy5NcDNFbmNvZGVyKDEsc2V0LnNhbXBsZVJhdGUsc2V0LmJpdFJhdGUpO1xuXHRcdFxuXHRcdHZhciBibG9ja1NpemU9NTc2MDA7XG5cdFx0dmFyIGRhdGE9W107XG5cdFx0XG5cdFx0dmFyIGlkeD0wLG1wM1NpemU9MDtcblx0XHR2YXIgcnVuPWZ1bmN0aW9uKCl7XG5cdFx0XHRpZihpZHg8c2l6ZSl7XG5cdFx0XHRcdHZhciBidWY9bXAzLmVuY29kZUJ1ZmZlcihyZXMuc3ViYXJyYXkoaWR4LGlkeCtibG9ja1NpemUpKTtcblx0XHRcdFx0aWYoYnVmLmxlbmd0aD4wKXtcblx0XHRcdFx0XHRtcDNTaXplKz1idWYuYnVmZmVyLmJ5dGVMZW5ndGg7XG5cdFx0XHRcdFx0ZGF0YS5wdXNoKGJ1Zi5idWZmZXIpO1xuXHRcdFx0XHR9O1xuXHRcdFx0XHRpZHgrPWJsb2NrU2l6ZTtcblx0XHRcdFx0c2V0VGltZW91dChydW4pOy8v5bC96YeP6YG/5YWN5Y2hdWlcblx0XHRcdH1lbHNle1xuXHRcdFx0XHR2YXIgYnVmPW1wMy5mbHVzaCgpO1xuXHRcdFx0XHRpZihidWYubGVuZ3RoPjApe1xuXHRcdFx0XHRcdG1wM1NpemUrPWJ1Zi5idWZmZXIuYnl0ZUxlbmd0aDtcblx0XHRcdFx0XHRkYXRhLnB1c2goYnVmLmJ1ZmZlcik7XG5cdFx0XHRcdH07XG5cdFx0XHRcdFxuXHRcdFx0XHQvL+WOu+aOieW8gOWktOeahOagh+iusOS/oeaBr+W4p1xuXHRcdFx0XHR2YXIgbWV0YT1tcDNUcmltRml4LmZuKGRhdGEsbXAzU2l6ZSxzaXplLHNldC5zYW1wbGVSYXRlKTtcblx0XHRcdFx0bXAzVHJpbUZpeFNldE1ldGEobWV0YSxzZXQpO1xuXHRcdFx0XHRcblx0XHRcdFx0VHJ1ZShuZXcgQmxvYihkYXRhLHt0eXBlOlwiYXVkaW8vbXAzXCJ9KSk7XG5cdFx0XHR9O1xuXHRcdH07XG5cdFx0cnVuKCk7XG5cdH1cblxuXG4vLyoqKioqKioq6L655b2V6L656L2s56CBKFdvcmtlcinmlK/mjIHlh73mlbDvvIzlpoLmnpzmj5DkvpvlsLHku6Pooajlj6/og73mlK/mjIHvvIzlkKbliJnlj6rmlK/mjIHmoIflh4bovaznoIEqKioqKioqKipcblxuLy/lhajlsYDlhbHkuqvkuIDkuKpXb3JrZXLvvIzlkI7lj7DkuLLooYzmiafooYzjgILlpoLmnpzmr4/mrKHpg73lvIDkuIDkuKrmlrDnmoTvvIznvJbnoIHpgJ/luqblj6/og73kvJrmhaLlvojlpJrvvIzlj6/og73mmK/mtY/op4jlmajov5DooYznvJPlrZjnmoTlm6DntKDvvIzlubbkuJTlj6/og73nnqzpl7TkuqfnlJ/lpJrkuKrlubbooYzmk43kvZzljaDnlKjlpKfph49jcHVcbnZhciBtcDNXb3JrZXI7XG5SZWNvcmRlci5CaW5kRGVzdHJveShcIm1wM1dvcmtlclwiLGZ1bmN0aW9uKCl7XG5cdGNvbnNvbGUubG9nKFwibXAzV29ya2VyIERlc3Ryb3lcIik7XG5cdG1wM1dvcmtlciYmbXAzV29ya2VyLnRlcm1pbmF0ZSgpO1xuXHRtcDNXb3JrZXI9bnVsbDtcbn0pO1xuXG5cblJlY29yZGVyLnByb3RvdHlwZS5tcDNfZW52Q2hlY2s9ZnVuY3Rpb24oZW52SW5mbyxzZXQpey8v5qOA5p+l546v5aKD5LiL6YWN572u5piv5ZCm5Y+v55SoXG5cdHZhciBlcnJNc2c9XCJcIjtcblx0Ly/pnIDopoHlrp7ml7bnvJbnoIHov5Tlm57mlbDmja7vvIzmraTml7bpnIDopoHmo4Dmn6Xnjq/looPmmK/lkKbmnInlrp7ml7bnibnmgKfjgIHlkozmmK/lkKblj6/lrp7ml7bnvJbnoIFcblx0aWYoc2V0LnRha2VvZmZFbmNvZGVDaHVuayl7XG5cdFx0aWYoIWVudkluZm8uY2FuUHJvY2Vzcyl7XG5cdFx0XHRlcnJNc2c9ZW52SW5mby5lbnZOYW1lK1wi546v5aKD5LiN5pSv5oyB5a6e5pe25aSE55CGXCI7XG5cdFx0fWVsc2UgaWYoIW5ld0NvbnRleHQoKSl7Ly/mtY/op4jlmajkuI3og73liJvlu7rlrp7ml7bnvJbnoIHnjq/looNcblx0XHRcdGVyck1zZz1cIuW9k+WJjea1j+iniOWZqOeJiOacrOWkquS9ju+8jOaXoOazleWunuaXtuWkhOeQhlwiO1xuXHRcdH07XG5cdH07XG5cdHJldHVybiBlcnJNc2c7XG59O1xuUmVjb3JkZXIucHJvdG90eXBlLm1wM19zdGFydD1mdW5jdGlvbihzZXQpey8v5aaC5p6c6L+U5ZuebnVsbOS7o+ihqOS4jeaUr+aMgVxuXHRyZXR1cm4gbmV3Q29udGV4dChzZXQpO1xufTtcbnZhciBvcGVuTGlzdD17aWQ6MH07XG52YXIgbmV3Q29udGV4dD1mdW5jdGlvbihzZXRPck51bGwpe1xuXHR2YXIgd29ya2VyPW1wM1dvcmtlcjtcblx0dHJ5e1xuXHRcdGlmKCF3b3JrZXIpe1xuXHRcdFx0dmFyIG9ubXNnPWZ1bmN0aW9uKGUpe1xuXHRcdFx0XHR2YXIgZWQ9ZS5kYXRhO1xuXHRcdFx0XHR2YXIgY3VyPXdrX2N0eHNbZWQuaWRdO1xuXHRcdFx0XHRpZihlZC5hY3Rpb249PVwiaW5pdFwiKXtcblx0XHRcdFx0XHR3a19jdHhzW2VkLmlkXT17XG5cdFx0XHRcdFx0XHRzYW1wbGVSYXRlOmVkLnNhbXBsZVJhdGVcblx0XHRcdFx0XHRcdCxiaXRSYXRlOmVkLmJpdFJhdGVcblx0XHRcdFx0XHRcdCx0YWtlb2ZmOmVkLnRha2VvZmZcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0LG1wM1NpemU6MFxuXHRcdFx0XHRcdFx0LHBjbVNpemU6MFxuXHRcdFx0XHRcdFx0LGVuY0FycjpbXVxuXHRcdFx0XHRcdFx0LGVuY09iajpuZXcgd2tfbGFtZS5NcDNFbmNvZGVyKDEsZWQuc2FtcGxlUmF0ZSxlZC5iaXRSYXRlKVxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1lbHNlIGlmKCFjdXIpe1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fTtcblx0XHRcdFx0XG5cdFx0XHRcdHN3aXRjaChlZC5hY3Rpb24pe1xuXHRcdFx0XHRjYXNlIFwic3RvcFwiOlxuXHRcdFx0XHRcdGN1ci5lbmNPYmo9bnVsbDtcblx0XHRcdFx0XHRkZWxldGUgd2tfY3R4c1tlZC5pZF07XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJlbmNvZGVcIjpcblx0XHRcdFx0XHRjdXIucGNtU2l6ZSs9ZWQucGNtLmxlbmd0aDtcblx0XHRcdFx0XHR2YXIgYnVmPWN1ci5lbmNPYmouZW5jb2RlQnVmZmVyKGVkLnBjbSk7XG5cdFx0XHRcdFx0aWYoYnVmLmxlbmd0aD4wKXtcblx0XHRcdFx0XHRcdGlmKGN1ci50YWtlb2ZmKXtcblx0XHRcdFx0XHRcdFx0c2VsZi5wb3N0TWVzc2FnZSh7YWN0aW9uOlwidGFrZW9mZlwiLGlkOmVkLmlkLGNodW5rOmJ1Zn0pO1xuXHRcdFx0XHRcdFx0fWVsc2V7XG5cdFx0XHRcdFx0XHRcdGN1ci5tcDNTaXplKz1idWYuYnVmZmVyLmJ5dGVMZW5ndGg7XG5cdFx0XHRcdFx0XHRcdGN1ci5lbmNBcnIucHVzaChidWYuYnVmZmVyKTtcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBcImNvbXBsZXRlXCI6XG5cdFx0XHRcdFx0dmFyIGJ1Zj1jdXIuZW5jT2JqLmZsdXNoKCk7XG5cdFx0XHRcdFx0aWYoYnVmLmxlbmd0aD4wKXtcblx0XHRcdFx0XHRcdGlmKGN1ci50YWtlb2ZmKXtcblx0XHRcdFx0XHRcdFx0c2VsZi5wb3N0TWVzc2FnZSh7YWN0aW9uOlwidGFrZW9mZlwiLGlkOmVkLmlkLGNodW5rOmJ1Zn0pO1xuXHRcdFx0XHRcdFx0fWVsc2V7XG5cdFx0XHRcdFx0XHRcdGN1ci5tcDNTaXplKz1idWYuYnVmZmVyLmJ5dGVMZW5ndGg7XG5cdFx0XHRcdFx0XHRcdGN1ci5lbmNBcnIucHVzaChidWYuYnVmZmVyKTtcblx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvL+WOu+aOieW8gOWktOeahOagh+iusOS/oeaBr+W4p1xuXHRcdFx0XHRcdHZhciBtZXRhPXdrX21wM1RyaW1GaXguZm4oY3VyLmVuY0FycixjdXIubXAzU2l6ZSxjdXIucGNtU2l6ZSxjdXIuc2FtcGxlUmF0ZSk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0c2VsZi5wb3N0TWVzc2FnZSh7XG5cdFx0XHRcdFx0XHRhY3Rpb246ZWQuYWN0aW9uXG5cdFx0XHRcdFx0XHQsaWQ6ZWQuaWRcblx0XHRcdFx0XHRcdCxibG9iOm5ldyBCbG9iKGN1ci5lbmNBcnIse3R5cGU6XCJhdWRpby9tcDNcIn0pXG5cdFx0XHRcdFx0XHQsbWV0YTptZXRhXG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdH07XG5cdFx0XHR9O1xuXHRcdFx0XG5cdFx0XHQvL+WIm+W7uuS4gOS4quaWsFdvcmtlclxuXHRcdFx0dmFyIGpzQ29kZT1cIik7d2tfbGFtZSgpO3ZhciB3a19jdHhzPXt9O3NlbGYub25tZXNzYWdlPVwiK29ubXNnO1xuXHRcdFx0anNDb2RlKz1cIjt2YXIgd2tfbXAzVHJpbUZpeD17cm06XCIrbXAzVHJpbUZpeC5ybStcIixmbjpcIittcDNUcmltRml4LmZuK1wifVwiO1xuXHRcdFx0XG5cdFx0XHR2YXIgbGFtZWpzQ29kZT1SZWNvcmRlci5sYW1lanMudG9TdHJpbmcoKTtcblx0XHRcdHZhciB1cmw9KHdpbmRvdy5VUkx8fHdlYmtpdFVSTCkuY3JlYXRlT2JqZWN0VVJMKG5ldyBCbG9iKFtcInZhciB3a19sYW1lPShcIixsYW1lanNDb2RlLGpzQ29kZV0sIHt0eXBlOlwidGV4dC9qYXZhc2NyaXB0XCJ9KSk7XG5cdFx0XHRcblx0XHRcdHdvcmtlcj1uZXcgV29ya2VyKHVybCk7XG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG5cdFx0XHRcdCh3aW5kb3cuVVJMfHx3ZWJraXRVUkwpLnJldm9rZU9iamVjdFVSTCh1cmwpOy8v5b+F6aG76KaB6YeK5pS+77yM5LiN54S25q+P5qyh6LCD55So5YaF5a2Y6YO95piO5pi+5rOE6Zyy5YaF5a2YXG5cdFx0XHR9LDEwMDAwKTsvL2Nocm9tZSA4MyBmaWxl5Y2P6K6u5LiL5aaC5p6c55u05o6l6YeK5pS+77yM5bCG5Lya5L2/V2ViV29ya2Vy5peg5rOV5ZCv5YqoXG5cdFx0XHRcblx0XHRcdHdvcmtlci5vbm1lc3NhZ2U9ZnVuY3Rpb24oZSl7XG5cdFx0XHRcdHZhciBkYXRhPWUuZGF0YTtcblx0XHRcdFx0dmFyIGN0eD1vcGVuTGlzdFtkYXRhLmlkXTtcblx0XHRcdFx0aWYoY3R4KXtcblx0XHRcdFx0XHRpZihkYXRhLmFjdGlvbj09XCJ0YWtlb2ZmXCIpe1xuXHRcdFx0XHRcdFx0Ly/lj5botbDlrp7ml7bnlJ/miJDnmoRtcDPmlbDmja5cblx0XHRcdFx0XHRcdGN0eC5zZXQudGFrZW9mZkVuY29kZUNodW5rKG5ldyBVaW50OEFycmF5KGRhdGEuY2h1bmsuYnVmZmVyKSk7XG5cdFx0XHRcdFx0fWVsc2V7XG5cdFx0XHRcdFx0XHQvL2NvbXBsZXRlXG5cdFx0XHRcdFx0XHRjdHguY2FsbCYmY3R4LmNhbGwoZGF0YSk7XG5cdFx0XHRcdFx0XHRjdHguY2FsbD1udWxsO1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH07XG5cdFx0XHR9O1xuXHRcdH07XG5cdFx0XG5cdFx0dmFyIGN0eD17d29ya2VyOndvcmtlcixzZXQ6c2V0T3JOdWxsLHRha2VvZmZRdWV1ZTpbXX07XG5cdFx0aWYoc2V0T3JOdWxsKXtcblx0XHRcdGN0eC5pZD0rK29wZW5MaXN0LmlkO1xuXHRcdFx0b3Blbkxpc3RbY3R4LmlkXT1jdHg7XG5cdFx0XHRcblx0XHRcdHdvcmtlci5wb3N0TWVzc2FnZSh7XG5cdFx0XHRcdGFjdGlvbjpcImluaXRcIlxuXHRcdFx0XHQsaWQ6Y3R4LmlkXG5cdFx0XHRcdCxzYW1wbGVSYXRlOnNldE9yTnVsbC5zYW1wbGVSYXRlXG5cdFx0XHRcdCxiaXRSYXRlOnNldE9yTnVsbC5iaXRSYXRlXG5cdFx0XHRcdCx0YWtlb2ZmOiEhc2V0T3JOdWxsLnRha2VvZmZFbmNvZGVDaHVua1xuXHRcdFx0XHRcblx0XHRcdFx0LHg6bmV3IEludDE2QXJyYXkoNSkvL+S9jueJiOacrOa1j+iniOWZqOS4jeaUr+aMgeW6j+WIl+WMllR5cGVkQXJyYXlcblx0XHRcdH0pO1xuXHRcdH1lbHNle1xuXHRcdFx0d29ya2VyLnBvc3RNZXNzYWdlKHtcblx0XHRcdFx0eDpuZXcgSW50MTZBcnJheSg1KS8v5L2O54mI5pys5rWP6KeI5Zmo5LiN5pSv5oyB5bqP5YiX5YyWVHlwZWRBcnJheVxuXHRcdFx0fSk7XG5cdFx0fTtcblx0XHRcblx0XHRcblx0XHRtcDNXb3JrZXI9d29ya2VyO1xuXHRcdHJldHVybiBjdHg7XG5cdH1jYXRjaChlKXsvL+WHuumUmeS6huWwseS4jeimgeaPkOS+m+S6hlxuXHRcdHdvcmtlciYmd29ya2VyLnRlcm1pbmF0ZSgpO1xuXHRcdFxuXHRcdGNvbnNvbGUuZXJyb3IoZSk7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH07XG59O1xuUmVjb3JkZXIucHJvdG90eXBlLm1wM19zdG9wPWZ1bmN0aW9uKHN0YXJ0Q3R4KXtcblx0aWYoc3RhcnRDdHgmJnN0YXJ0Q3R4Lndvcmtlcil7XG5cdFx0c3RhcnRDdHgud29ya2VyLnBvc3RNZXNzYWdlKHtcblx0XHRcdGFjdGlvbjpcInN0b3BcIlxuXHRcdFx0LGlkOnN0YXJ0Q3R4LmlkXG5cdFx0fSk7XG5cdFx0c3RhcnRDdHgud29ya2VyPW51bGw7XG5cdFx0ZGVsZXRlIG9wZW5MaXN0W3N0YXJ0Q3R4LmlkXTtcblx0XHRcblx0XHQvL+eWkeS8vOazhOmcsuajgOa1iyDmjpLpmaRpZFxuXHRcdHZhciBvcGVucz0tMTtcblx0XHRmb3IodmFyIGsgaW4gb3Blbkxpc3Qpe1xuXHRcdFx0b3BlbnMrKztcblx0XHR9O1xuXHRcdGlmKG9wZW5zKXtcblx0XHRcdGNvbnNvbGUud2FybihcIm1wMyB3b3JrZXLlialcIitvcGVucytcIuS4quWcqOS4suihjOetieW+hVwiKTtcblx0XHR9O1xuXHR9O1xufTtcblJlY29yZGVyLnByb3RvdHlwZS5tcDNfZW5jb2RlPWZ1bmN0aW9uKHN0YXJ0Q3R4LHBjbSl7XG5cdGlmKHN0YXJ0Q3R4JiZzdGFydEN0eC53b3JrZXIpe1xuXHRcdHN0YXJ0Q3R4Lndvcmtlci5wb3N0TWVzc2FnZSh7XG5cdFx0XHRhY3Rpb246XCJlbmNvZGVcIlxuXHRcdFx0LGlkOnN0YXJ0Q3R4LmlkXG5cdFx0XHQscGNtOnBjbVxuXHRcdH0pO1xuXHR9O1xufTtcblJlY29yZGVyLnByb3RvdHlwZS5tcDNfY29tcGxldGU9ZnVuY3Rpb24oc3RhcnRDdHgsVHJ1ZSxGYWxzZSxhdXRvU3RvcCl7XG5cdHZhciBUaGlzPXRoaXM7XG5cdGlmKHN0YXJ0Q3R4JiZzdGFydEN0eC53b3JrZXIpe1xuXHRcdHN0YXJ0Q3R4LmNhbGw9ZnVuY3Rpb24oZGF0YSl7XG5cdFx0XHRtcDNUcmltRml4U2V0TWV0YShkYXRhLm1ldGEsc3RhcnRDdHguc2V0KTtcblx0XHRcdFRydWUoZGF0YS5ibG9iKTtcblx0XHRcdFxuXHRcdFx0aWYoYXV0b1N0b3Ape1xuXHRcdFx0XHRUaGlzLm1wM19zdG9wKHN0YXJ0Q3R4KTtcblx0XHRcdH07XG5cdFx0fTtcblx0XHRzdGFydEN0eC53b3JrZXIucG9zdE1lc3NhZ2Uoe1xuXHRcdFx0YWN0aW9uOlwiY29tcGxldGVcIlxuXHRcdFx0LGlkOnN0YXJ0Q3R4LmlkXG5cdFx0fSk7XG5cdH1lbHNle1xuXHRcdEZhbHNlKFwibXAz57yW56CB5Zmo5pyq5omT5byAXCIpO1xuXHR9O1xufTtcblxuXG5cblxuXG5cblxuLy8qKioqKioq6L6F5Yqp5Ye95pWwKioqKioqKioqKioqXG5cbi8q6K+75Y+WbGFtZWpz57yW56CB5Ye65p2l55qEbXAz5L+h5oGv77yM5Y+q6IO96K+754m55a6a5qC85byP77yM5aaC5p6c6K+75Y+W5aSx6LSl6L+U5ZuebnVsbFxubXAzQnVmZmVycz1bQXJyYXlCdWZmZXIsLi4uXVxubGVuZ3RoPW1wM0J1ZmZlcnPnmoTmlbDmja7kuozov5vliLbmgLvplb/luqZcbiovXG5SZWNvcmRlci5tcDNSZWFkTWV0YT1mdW5jdGlvbihtcDNCdWZmZXJzLGxlbmd0aCl7XG5cdC8va2lsbCBiYWJlbC1wb2x5ZmlsbCBFUzYgTnVtYmVyLnBhcnNlSW50IOS4jeeEtuaUvuWIsFdvcmtlcumHjOmdouaJvuS4jeWIsOaWueazlVxuXHR2YXIgcGFyc2VJbnRfRVMzPXR5cGVvZih3aW5kb3cpPT1cIm9iamVjdFwiP3dpbmRvdy5wYXJzZUludDpzZWxmLnBhcnNlSW50O1xuXHRcblx0dmFyIHU4YXJyMD1uZXcgVWludDhBcnJheShtcDNCdWZmZXJzWzBdfHxbXSk7XG5cdGlmKHU4YXJyMC5sZW5ndGg8NCl7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH07XG5cdHZhciBieXRlQXQ9ZnVuY3Rpb24oaWR4LHU4KXtcblx0XHRyZXR1cm4gKFwiMDAwMDAwMFwiKygodTh8fHU4YXJyMClbaWR4XXx8MCkudG9TdHJpbmcoMikpLnN1YnN0cigtOCk7XG5cdH07XG5cdHZhciBiMj1ieXRlQXQoMCkrYnl0ZUF0KDEpO1xuXHR2YXIgYjQ9Ynl0ZUF0KDIpK2J5dGVBdCgzKTtcblx0XG5cdGlmKCEvXjF7MTF9Ly50ZXN0KGIyKSl7Ly/mnKrlj5HnjrDluKflkIzmraVcblx0XHRyZXR1cm4gbnVsbDtcblx0fTtcblx0dmFyIHZlcnNpb249KHtcIjAwXCI6Mi41LFwiMTBcIjoyLFwiMTFcIjoxfSlbYjIuc3Vic3RyKDExLDIpXTtcblx0dmFyIGxheWVyPSh7XCIwMVwiOjN9KVtiMi5zdWJzdHIoMTMsMildOy8v5LuF5pSv5oyBTGF5ZXIzXG5cdHZhciBzYW1wbGVSYXRlPSh7IC8vbGFtZWpzIC0+IFRhYmxlcy5zYW1wbGVyYXRlX3RhYmxlXG5cdFx0XCIxXCI6WzQ0MTAwLCA0ODAwMCwgMzIwMDBdXG5cdFx0LFwiMlwiOlsyMjA1MCwgMjQwMDAsIDE2MDAwXVxuXHRcdCxcIjIuNVwiOlsxMTAyNSwgMTIwMDAsIDgwMDBdXG5cdH0pW3ZlcnNpb25dO1xuXHRzYW1wbGVSYXRlJiYoc2FtcGxlUmF0ZT1zYW1wbGVSYXRlW3BhcnNlSW50X0VTMyhiNC5zdWJzdHIoNCwyKSwyKV0pO1xuXHR2YXIgYml0UmF0ZT1bIC8vbGFtZWpzIC0+IFRhYmxlcy5iaXRyYXRlX3RhYmxlXG5cdFx0WzAsIDgsIDE2LCAyNCwgMzIsIDQwLCA0OCwgNTYsIDY0LCA4MCwgOTYsIDExMiwgMTI4LCAxNDQsIDE2MF0gLy9NUEVHIDIgMi41XG5cdFx0LFswLCAzMiwgNDAsIDQ4LCA1NiwgNjQsIDgwLCA5NiwgMTEyLCAxMjgsIDE2MCwgMTkyLCAyMjQsIDI1NiwgMzIwXS8vTVBFRyAxXG5cdF1bdmVyc2lvbj09MT8xOjBdW3BhcnNlSW50X0VTMyhiNC5zdWJzdHIoMCw0KSwyKV07XG5cdFxuXHRpZighdmVyc2lvbiB8fCAhbGF5ZXIgfHwgIWJpdFJhdGUgfHwgIXNhbXBsZVJhdGUpe1xuXHRcdHJldHVybiBudWxsO1xuXHR9O1xuXHRcblx0dmFyIGR1cmF0aW9uPU1hdGgucm91bmQobGVuZ3RoKjgvYml0UmF0ZSk7XG5cdHZhciBmcmFtZT1sYXllcj09MT8zODQ6bGF5ZXI9PTI/MTE1Mjp2ZXJzaW9uPT0xPzExNTI6NTc2O1xuXHR2YXIgZnJhbWVEdXJhdGlvbkZsb2F0PWZyYW1lL3NhbXBsZVJhdGUqMTAwMDtcblx0dmFyIGZyYW1lU2l6ZT1NYXRoLmZsb29yKChmcmFtZSpiaXRSYXRlKS84L3NhbXBsZVJhdGUqMTAwMCk7XG5cdFxuXHQvL+ajgOa1i+aYr+WQpuWtmOWcqExheWVyM+W4p+Whq+WFhTHlrZfoioLjgILov5nph4zlj6rojrflj5bnrKzkuozluKfnmoTloavlhYXkv6Hmga/vvIzpppbluKfmsLjov5zmsqHmnInloavlhYXjgILlhbbku5bluKflj6/og73pmpTkuIDluKflh7rnjrDkuIDkuKrloavlhYXvvIzmiJbogIXpmpTlvojlpJrluKflh7rnjrDkuIDkuKrloavlhYXvvJvnm67mtYvmmK/lj5blhrPkuo5mcmFtZVNpemXmnKroiI3lhaXml7bnmoTlsI/mlbDpg6jliIbvvIzlm6DkuLrmnInkupvph4fmoLfnjofnmoRmcmFtZVNpemXkvJrlh7rnjrDlsI/mlbDvvIgxMTAyNeOAgTIyMDUw44CBNDQxMDAg5YW45Z6L55qE6Zmk5LiN5bC977yJ77yM54S25ZCO5a2X6IqC5pWw5peg5rOV6KGo56S66L+Z56eN5bCP5pWw77yM5bCx6YCa6L+H5LiA5a6a5q2l6ZW/5p2l5aGr5YWF5byl6KGl5bCP5pWw6YOo5YiG5Lii5aSxXG5cdHZhciBoYXNQYWRkaW5nPTAsc2Vlaz0wO1xuXHRmb3IodmFyIGk9MDtpPG1wM0J1ZmZlcnMubGVuZ3RoO2krKyl7XG5cdFx0Ly/lr7vmib7nrKzkuozluKdcblx0XHR2YXIgYnVmPW1wM0J1ZmZlcnNbaV07XG5cdFx0c2Vlays9YnVmLmJ5dGVMZW5ndGg7XG5cdFx0aWYoc2Vlaz49ZnJhbWVTaXplKzMpe1xuXHRcdFx0dmFyIGJ1Zjg9bmV3IFVpbnQ4QXJyYXkoYnVmKTtcblx0XHRcdHZhciBpZHg9YnVmLmJ5dGVMZW5ndGgtKHNlZWstKGZyYW1lU2l6ZSszKSsxKTtcblx0XHRcdHZhciBpYjQ9Ynl0ZUF0KGlkeCxidWY4KTtcblx0XHRcdGhhc1BhZGRpbmc9aWI0LmNoYXJBdCg2KT09XCIxXCI7XG5cdFx0XHRicmVhaztcblx0XHR9O1xuXHR9O1xuXHRpZihoYXNQYWRkaW5nKXtcblx0XHRmcmFtZVNpemUrKztcblx0fTtcblx0XG5cdFxuXHRyZXR1cm4ge1xuXHRcdHZlcnNpb246dmVyc2lvbiAvLzEgMiAyLjUgLT4gTVBFRzEgTVBFRzIgTVBFRzIuNVxuXHRcdCxsYXllcjpsYXllci8vMyAtPiBMYXllcjNcblx0XHQsc2FtcGxlUmF0ZTpzYW1wbGVSYXRlIC8v6YeH5qC3546HIGh6XG5cdFx0LGJpdFJhdGU6Yml0UmF0ZSAvL+avlOeJueeOhyBrYnBzXG5cdFx0XG5cdFx0LGR1cmF0aW9uOmR1cmF0aW9uIC8v6Z+z6aKR5pe26ZW/IG1zXG5cdFx0LHNpemU6bGVuZ3RoIC8v5oC76ZW/5bqmIGJ5dGVcblx0XHQsaGFzUGFkZGluZzpoYXNQYWRkaW5nIC8v5piv5ZCm5a2Y5ZyoMeWtl+iKguWhq+WFhe+8jOmmluW4p+awuOi/nOayoeacie+8jOi/meS4quWAvOWFtuWunuS7o+ihqOeahOesrOS6jOW4p+aYr+WQpuacieWhq+WFhe+8jOW5tuS4jeS7o+ihqOWFtuS7luW4p+eahFxuXHRcdCxmcmFtZVNpemU6ZnJhbWVTaXplIC8v5q+P5bin5pyA5aSn6ZW/5bqm77yM5ZCr5Y+v6IO95a2Y5Zyo55qEMeWtl+iKgnBhZGRpbmcgYnl0ZVxuXHRcdCxmcmFtZUR1cmF0aW9uRmxvYXQ6ZnJhbWVEdXJhdGlvbkZsb2F0IC8v5q+P5bin5pe26ZW/77yM5ZCr5bCP5pWwIG1zXG5cdH07XG59O1xuXG4vL+WOu+aOiWxhbWVqc+W8gOWktOeahOagh+iusOS/oeaBr+W4p++8jOWFjeW+l21wM+ino+eggeWHuuadpeeahOaXtumVv+avlHBjbeeahOmVv+WkquWkmlxudmFyIG1wM1RyaW1GaXg9ey8vbWluZml5IGtlZXAgbmFtZVxucm06UmVjb3JkZXIubXAzUmVhZE1ldGFcbixmbjpmdW5jdGlvbihtcDNCdWZmZXJzLGxlbmd0aCxwY21MZW5ndGgscGNtU2FtcGxlUmF0ZSl7XG5cdHZhciBtZXRhPXRoaXMucm0obXAzQnVmZmVycyxsZW5ndGgpO1xuXHRpZighbWV0YSl7XG5cdFx0cmV0dXJuIHtlcnI6XCJtcDPpnZ7pooTlrprmoLzlvI9cIn07XG5cdH07XG5cdHZhciBwY21EdXJhdGlvbj1NYXRoLnJvdW5kKHBjbUxlbmd0aC9wY21TYW1wbGVSYXRlKjEwMDApO1xuXHRcblx0Ly/lvIDlpLTlpJrlh7rov5nkuYjlpJrluKfvvIznp7vpmaTmjonvvJvmraPluLjmg4XlhrXkuIvmnIDlpJrkuLoy5binXG5cdHZhciBudW09TWF0aC5mbG9vcigobWV0YS5kdXJhdGlvbi1wY21EdXJhdGlvbikvbWV0YS5mcmFtZUR1cmF0aW9uRmxvYXQpO1xuXHRpZihudW0+MCl7XG5cdFx0dmFyIHNpemU9bnVtKm1ldGEuZnJhbWVTaXplLShtZXRhLmhhc1BhZGRpbmc/MTowKTsvL+mmluW4p+ayoeacieWhq+WFhe+8jOesrOS6jOW4p+WPr+iDveacieWhq+WFhe+8jOi/memHjOWBh+iuvuacgOWkmuS4ujLluKfvvIjmtYvor5XlubbmnKrlh7rnjrAz5bin5Lul5LiK5oOF5Ya177yJ77yM5YW25LuW5bin5LiN566h77yM5bCx566X5Ye6546w5LqG5bm25LiU5a+86Ie05LqG6ZSZ6K+v5ZCO6Z2i6Ieq5Yqo5a656ZSZXG5cdFx0bGVuZ3RoLT1zaXplO1xuXHRcdHZhciBhcnIwPTAsYXJycz1bXTtcblx0XHRmb3IodmFyIGk9MDtpPG1wM0J1ZmZlcnMubGVuZ3RoO2krKyl7XG5cdFx0XHR2YXIgYXJyPW1wM0J1ZmZlcnNbaV07XG5cdFx0XHRpZihzaXplPD0wKXtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9O1xuXHRcdFx0aWYoc2l6ZT49YXJyLmJ5dGVMZW5ndGgpe1xuXHRcdFx0XHRzaXplLT1hcnIuYnl0ZUxlbmd0aDtcblx0XHRcdFx0YXJycy5wdXNoKGFycik7XG5cdFx0XHRcdG1wM0J1ZmZlcnMuc3BsaWNlKGksMSk7XG5cdFx0XHRcdGktLTtcblx0XHRcdH1lbHNle1xuXHRcdFx0XHRtcDNCdWZmZXJzW2ldPWFyci5zbGljZShzaXplKTtcblx0XHRcdFx0YXJyMD1hcnI7XG5cdFx0XHRcdHNpemU9MDtcblx0XHRcdH07XG5cdFx0fTtcblx0XHR2YXIgY2hlY2tNZXRhPXRoaXMucm0obXAzQnVmZmVycyxsZW5ndGgpO1xuXHRcdGlmKCFjaGVja01ldGEpe1xuXHRcdFx0Ly/ov5jljp/lj5jmm7TvvIzlupTor6XkuI3lpKrlj6/og73kvJrlh7rnjrBcblx0XHRcdGFycjAmJihtcDNCdWZmZXJzWzBdPWFycjApO1xuXHRcdFx0Zm9yKHZhciBpPTA7aTxhcnJzLmxlbmd0aDtpKyspe1xuXHRcdFx0XHRtcDNCdWZmZXJzLnNwbGljZShpLDAsYXJyc1tpXSk7XG5cdFx0XHR9O1xuXHRcdFx0bWV0YS5lcnI9XCJmaXjlkI7mlbDmja7plJnor6/vvIzlt7Lov5jljp/vvIzplJnor6/ljp/lm6DkuI3mmI5cIjtcblx0XHR9O1xuXHRcdFxuXHRcdHZhciBmaXg9bWV0YS50cmltRml4PXt9O1xuXHRcdGZpeC5yZW1vdmU9bnVtO1xuXHRcdGZpeC5yZW1vdmVEdXJhdGlvbj1NYXRoLnJvdW5kKG51bSptZXRhLmZyYW1lRHVyYXRpb25GbG9hdCk7XG5cdFx0Zml4LmR1cmF0aW9uPU1hdGgucm91bmQobGVuZ3RoKjgvbWV0YS5iaXRSYXRlKTtcblx0fTtcblx0cmV0dXJuIG1ldGE7XG59XG59O1xudmFyIG1wM1RyaW1GaXhTZXRNZXRhPWZ1bmN0aW9uKG1ldGEsc2V0KXtcblx0dmFyIHRhZz1cIk1QM+S/oeaBryBcIjtcblx0aWYobWV0YS5zYW1wbGVSYXRlJiZtZXRhLnNhbXBsZVJhdGUhPXNldC5zYW1wbGVSYXRlIHx8IG1ldGEuYml0UmF0ZSYmbWV0YS5iaXRSYXRlIT1zZXQuYml0UmF0ZSl7XG5cdFx0Y29uc29sZS53YXJuKHRhZytcIuWSjOiuvue9rueahOS4jeWMuemFjXNldDpcIitzZXQuYml0UmF0ZStcImticHMgXCIrc2V0LnNhbXBsZVJhdGUrXCJoeu+8jOW3suabtOaWsHNldDpcIittZXRhLmJpdFJhdGUrXCJrYnBzIFwiK21ldGEuc2FtcGxlUmF0ZStcImh6XCIsc2V0KTtcblx0XHRzZXQuc2FtcGxlUmF0ZT1tZXRhLnNhbXBsZVJhdGU7XG5cdFx0c2V0LmJpdFJhdGU9bWV0YS5iaXRSYXRlO1xuXHR9O1xuXHRcblx0dmFyIHRyaW1GaXg9bWV0YS50cmltRml4O1xuXHRpZih0cmltRml4KXtcblx0XHR0YWcrPVwiRml456e76ZmkXCIrdHJpbUZpeC5yZW1vdmUrXCLluKdcIit0cmltRml4LnJlbW92ZUR1cmF0aW9uK1wibXMgLT4gXCIrdHJpbUZpeC5kdXJhdGlvbitcIm1zXCI7XG5cdFx0aWYodHJpbUZpeC5yZW1vdmU+Mil7XG5cdFx0XHRtZXRhLmVycj0obWV0YS5lcnI/bWV0YS5lcnIrXCIsIFwiOlwiXCIpK1wi56e76Zmk5bin5pWw6L+H5aSaXCI7XG5cdFx0fTtcblx0fWVsc2V7XG5cdFx0dGFnKz0obWV0YS5kdXJhdGlvbnx8XCItXCIpK1wibXNcIjtcblx0fTtcblx0XG5cdGlmKG1ldGEuZXJyKXtcblx0XHRjb25zb2xlLmVycm9yKHRhZyxtZXRhLmVycixtZXRhKTtcblx0fWVsc2V7XG5cdFx0Y29uc29sZS5sb2codGFnLG1ldGEpO1xuXHR9O1xufTtcblxuXG5cdFxufSkoKTsiLCIvKlxu5b2V6Z+zXG5odHRwczovL2dpdGh1Yi5jb20veGlhbmd5dWVjbi9SZWNvcmRlclxuKi9cbihmdW5jdGlvbihmYWN0b3J5KXtcblx0ZmFjdG9yeSh3aW5kb3cpO1xuXHQvL3VtZCByZXR1cm5FeHBvcnRzLmpzXG5cdGlmKHR5cGVvZihkZWZpbmUpPT0nZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpe1xuXHRcdGRlZmluZShmdW5jdGlvbigpe1xuXHRcdFx0cmV0dXJuIFJlY29yZGVyO1xuXHRcdH0pO1xuXHR9O1xuXHRpZih0eXBlb2YobW9kdWxlKT09J29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMpe1xuXHRcdG1vZHVsZS5leHBvcnRzPVJlY29yZGVyO1xuXHR9O1xufShmdW5jdGlvbih3aW5kb3cpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8v5YW85a65546v5aKDXG52YXIgTE09XCIyMDIwLTExLTE1IDIxOjM2OjExXCI7XG52YXIgTk9PUD1mdW5jdGlvbigpe307XG4vL2VuZCDlhbzlrrnnjq/looMgKioqKuS7juS7peS4i+W8gOWni2NvcHnmupDnoIEqKioqKlxuXG52YXIgUmVjb3JkZXI9ZnVuY3Rpb24oc2V0KXtcblx0cmV0dXJuIG5ldyBpbml0Rm4oc2V0KTtcbn07XG4vL+aYr+WQpuW3sue7j+aJk+W8gOS6huW9lemfs++8jOaJgOacieW3peS9nOmDveW3sue7j+WHhuWkh+WlveS6hu+8jOWwseetieaOpeaUtumfs+mikeaVsOaNruS6hlxuUmVjb3JkZXIuSXNPcGVuPWZ1bmN0aW9uKCl7XG5cdHZhciBzdHJlYW09UmVjb3JkZXIuU3RyZWFtO1xuXHRpZihzdHJlYW0pe1xuXHRcdHZhciB0cmFja3M9c3RyZWFtLmdldFRyYWNrcyYmc3RyZWFtLmdldFRyYWNrcygpfHxzdHJlYW0uYXVkaW9UcmFja3N8fFtdO1xuXHRcdHZhciB0cmFjaz10cmFja3NbMF07XG5cdFx0aWYodHJhY2spe1xuXHRcdFx0dmFyIHN0YXRlPXRyYWNrLnJlYWR5U3RhdGU7XG5cdFx0XHRyZXR1cm4gc3RhdGU9PVwibGl2ZVwifHxzdGF0ZT09dHJhY2suTElWRTtcblx0XHR9O1xuXHR9O1xuXHRyZXR1cm4gZmFsc2U7XG59O1xuLypINeW9lemfs+aXtueahEF1ZGlvQ29udGV4dOe8k+WGsuWkp+Wwj+OAguS8muW9seWTjUg15b2V6Z+z5pe255qEb25Qcm9jZXNz6LCD55So6YCf546H77yM55u45a+55LqOQXVkaW9Db250ZXh0LnNhbXBsZVJhdGU9NDgwMDDml7bvvIw0MDk25o6l6L+RMTLluKcvc++8jOiwg+iKguatpOWPguaVsOWPr+eUn+aIkOavlOi+g+a1geeVheeahOWbnuiwg+WKqOeUu+OAglxuXHTlj5blgLwyNTYsIDUxMiwgMTAyNCwgMjA0OCwgNDA5NiwgODE5Miwgb3IgMTYzODRcblx05rOo5oSP77yM5Y+W5YC85LiN6IO96L+H5L2O77yMMjA0OOW8gOWni+S4jeWQjOa1j+iniOWZqOWPr+iDveWbnuiwg+mAn+eOh+i3n+S4jeS4iumAoOaIkOmfs+i0qOmXrumimOOAglxuXHTkuIDoiKzml6DpnIDosIPmlbTvvIzosIPmlbTlkI7pnIDopoHlhYhjbG9zZeaOieW3suaJk+W8gOeahOW9lemfs++8jOWGjW9wZW7ml7bmiY3kvJrnlJ/mlYjjgIJcbiovXG5SZWNvcmRlci5CdWZmZXJTaXplPTQwOTY7XG4vL+mUgOavgeW3suaMgeacieeahOaJgOacieWFqOWxgOi1hOa6kO+8jOW9k+imgeW9u+W6leenu+mZpFJlY29yZGVy5pe26ZyA6KaB5pi+5byP55qE6LCD55So5q2k5pa55rOVXG5SZWNvcmRlci5EZXN0cm95PWZ1bmN0aW9uKCl7XG5cdENMb2coXCJSZWNvcmRlciBEZXN0cm95XCIpO1xuXHRmb3IodmFyIGsgaW4gRGVzdHJveUxpc3Qpe1xuXHRcdERlc3Ryb3lMaXN0W2tdKCk7XG5cdH07XG59O1xudmFyIERlc3Ryb3lMaXN0PXt9O1xuLy/nmbvorrDkuIDkuKrpnIDopoHplIDmr4HlhajlsYDotYTmupDnmoTlpITnkIbmlrnms5VcblJlY29yZGVyLkJpbmREZXN0cm95PWZ1bmN0aW9uKGtleSxjYWxsKXtcblx0RGVzdHJveUxpc3Rba2V5XT1jYWxsO1xufTtcbi8v5Yik5pat5rWP6KeI5Zmo5piv5ZCm5pSv5oyB5b2V6Z+z77yM6ZqP5pe25Y+v5Lul6LCD55So44CC5rOo5oSP77ya5LuF5LuF5piv5qOA5rWL5rWP6KeI5Zmo5pSv5oyB5oOF5Ya177yM5LiN5Lya5Yik5pat5ZKM6LCD6LW355So5oi35o6I5p2D77yM5LiN5Lya5Yik5pat5piv5ZCm5pSv5oyB54m55a6a5qC85byP5b2V6Z+z44CCXG5SZWNvcmRlci5TdXBwb3J0PWZ1bmN0aW9uKCl7XG5cdHZhciBBQz13aW5kb3cuQXVkaW9Db250ZXh0O1xuXHRpZighQUMpe1xuXHRcdEFDPXdpbmRvdy53ZWJraXRBdWRpb0NvbnRleHQ7XG5cdH07XG5cdGlmKCFBQyl7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9O1xuXHR2YXIgc2NvcGU9bmF2aWdhdG9yLm1lZGlhRGV2aWNlc3x8e307XG5cdGlmKCFzY29wZS5nZXRVc2VyTWVkaWEpe1xuXHRcdHNjb3BlPW5hdmlnYXRvcjtcblx0XHRzY29wZS5nZXRVc2VyTWVkaWF8fChzY29wZS5nZXRVc2VyTWVkaWE9c2NvcGUud2Via2l0R2V0VXNlck1lZGlhfHxzY29wZS5tb3pHZXRVc2VyTWVkaWF8fHNjb3BlLm1zR2V0VXNlck1lZGlhKTtcblx0fTtcblx0aWYoIXNjb3BlLmdldFVzZXJNZWRpYSl7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9O1xuXHRcblx0UmVjb3JkZXIuU2NvcGU9c2NvcGU7XG5cdGlmKCFSZWNvcmRlci5DdHh8fFJlY29yZGVyLkN0eC5zdGF0ZT09XCJjbG9zZWRcIil7XG5cdFx0Ly/kuI3og73lj43lpI3mnoTpgKDvvIzkvY7niYjmnKxudW1iZXIgb2YgaGFyZHdhcmUgY29udGV4dHMgcmVhY2hlZCBtYXhpbXVtICg2KVxuXHRcdFJlY29yZGVyLkN0eD1uZXcgQUMoKTtcblx0XHRcblx0XHRSZWNvcmRlci5CaW5kRGVzdHJveShcIkN0eFwiLGZ1bmN0aW9uKCl7XG5cdFx0XHR2YXIgY3R4PVJlY29yZGVyLkN0eDtcblx0XHRcdGN0eCYmY3R4LmNsb3NlJiZjdHguY2xvc2UoKTtcblx0XHR9KTtcblx0fTtcblx0cmV0dXJuIHRydWU7XG59O1xuLyrliJ3lp4vljJZINemfs+mikemHh+mbhui/nuaOpe+8jOWboOS4ulN0cmVhbeaYr+WFqOWxgOeahO+8jFNhZmFyaeS4iuaWreW8gOWQjuWwseaXoOazleWGjeasoei/m+ihjOi/nuaOpeS9v+eUqO+8jOihqOeOsOS4uumdmemfs++8jOWboOatpOS9v+eUqOWFqOmDqOS9v+eUqOWFqOWxgOWkhOeQhumBv+WFjeiwg+eUqOWIsGRpc2Nvbm5lY3TvvJvlhajlsYDlpITnkIbkuZ/mnInliKnkuo7lsY/olL3lupXlsYLnu4boioLvvIxzdGFydOaXtuaXoOmcgOWGjeiwg+eUqOW6leWxguaOpeWPo++8jOaPkOWNh+WFvOWuueOAgeWPr+mdoOaAp+OAgiovXG52YXIgQ29ubmVjdD1mdW5jdGlvbigpe1xuXHR2YXIgY3R4PVJlY29yZGVyLkN0eCxzdHJlYW09UmVjb3JkZXIuU3RyZWFtO1xuXHR2YXIgbWVkaWE9c3RyZWFtLl9tPWN0eC5jcmVhdGVNZWRpYVN0cmVhbVNvdXJjZShzdHJlYW0pO1xuXHR2YXIgcHJvY2Vzcz1zdHJlYW0uX3A9KGN0eC5jcmVhdGVTY3JpcHRQcm9jZXNzb3J8fGN0eC5jcmVhdGVKYXZhU2NyaXB0Tm9kZSkuY2FsbChjdHgsUmVjb3JkZXIuQnVmZmVyU2l6ZSwxLDEpOy8v5Y2V5aOw6YGT77yM55yB55qE5pWw5o2u5aSE55CG5aSN5p2CXG5cdFxuXHRtZWRpYS5jb25uZWN0KHByb2Nlc3MpO1xuXHRwcm9jZXNzLmNvbm5lY3QoY3R4LmRlc3RpbmF0aW9uKTtcblx0XG5cdHZhciBjYWxscz1zdHJlYW0uX2NhbGw7XG5cdHByb2Nlc3Mub25hdWRpb3Byb2Nlc3M9ZnVuY3Rpb24oZSl7XG5cdFx0Zm9yKHZhciBrMCBpbiBjYWxscyl7Ly9oYXMgaXRlbVxuXHRcdFx0dmFyIG89ZS5pbnB1dEJ1ZmZlci5nZXRDaGFubmVsRGF0YSgwKTsvL+Wdl+aYr+WFseS6q+eahO+8jOW/hemhu+WkjeWItuWHuuadpVxuXHRcdFx0dmFyIHNpemU9by5sZW5ndGg7XG5cdFx0XHRcblx0XHRcdHZhciBwY209bmV3IEludDE2QXJyYXkoc2l6ZSk7XG5cdFx0XHR2YXIgc3VtPTA7XG5cdFx0XHRmb3IodmFyIGo9MDtqPHNpemU7aisrKXsvL2Zsb2F0VG8xNkJpdFBDTSBcblx0XHRcdFx0dmFyIHM9TWF0aC5tYXgoLTEsTWF0aC5taW4oMSxvW2pdKSk7XG5cdFx0XHRcdHM9czwwP3MqMHg4MDAwOnMqMHg3RkZGO1xuXHRcdFx0XHRwY21bal09cztcblx0XHRcdFx0c3VtKz1NYXRoLmFicyhzKTtcblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdGZvcih2YXIgayBpbiBjYWxscyl7XG5cdFx0XHRcdGNhbGxzW2tdKHBjbSxzdW0pO1xuXHRcdFx0fTtcblx0XHRcdFxuXHRcdFx0cmV0dXJuO1xuXHRcdH07XG5cdH07XG59O1xudmFyIERpc2Nvbm5lY3Q9ZnVuY3Rpb24oKXtcblx0dmFyIHN0cmVhbT1SZWNvcmRlci5TdHJlYW07XG5cdGlmKHN0cmVhbS5fbSl7XG5cdFx0c3RyZWFtLl9tLmRpc2Nvbm5lY3QoKTtcblx0XHRzdHJlYW0uX3AuZGlzY29ubmVjdCgpO1xuXHRcdHN0cmVhbS5fcC5vbmF1ZGlvcHJvY2Vzcz1zdHJlYW0uX3A9c3RyZWFtLl9tPW51bGw7XG5cdH07XG59O1xuXG4vKuWvuXBjbeaVsOaNrueahOmHh+agt+eOh+i/m+ihjOi9rOaNolxucGNtRGF0YXM6IFtbSW50MTYsLi4uXV0gcGNt54mH5q615YiX6KGoXG5wY21TYW1wbGVSYXRlOjQ4MDAwIHBjbeaVsOaNrueahOmHh+agt+eOh1xubmV3U2FtcGxlUmF0ZToxNjAwMCDpnIDopoHovazmjaLmiJDnmoTph4fmoLfnjofvvIxuZXdTYW1wbGVSYXRlPj1wY21TYW1wbGVSYXRl5pe25LiN5Lya6L+b6KGM5Lu75L2V5aSE55CG77yM5bCP5LqO5pe25Lya6L+b6KGM6YeN5paw6YeH5qC3XG5wcmV2Q2h1bmtJbmZvOnt9IOWPr+mAie+8jOS4iuasoeiwg+eUqOaXtueahOi/lOWbnuWAvO+8jOeUqOS6jui/nue7rei9rOaNou+8jOacrOasoeiwg+eUqOWwhuS7juS4iuasoee7k+adn+S9jee9ruW8gOWni+i/m+ihjOWkhOeQhuOAguaIluWPr+iHquihjOWumuS5ieS4gOS4qkNodW5rSW5mb+S7jnBjbURhdGFz5oyH5a6a55qE5L2N572u5byA5aeL6L+b6KGM6L2s5o2iXG5vcHRpb246eyDlj6/pgInvvIzphY3nva7poblcblx0XHRmcmFtZVNpemU6MTIzNDU2IOW4p+Wkp+Wwj++8jOavj+W4p+eahFBDTSBJbnQxNueahOaVsOmHj++8jOmHh+agt+eOh+i9rOaNouWQjueahHBjbemVv+W6puS4umZyYW1lU2l6ZeeahOaVtOaVsOWAje+8jOeUqOS6jui/nue7rei9rOaNouOAguebruWJjeS7heWcqG1wM+agvOW8j+aXtuaJjeacieeUqO+8jGZyYW1lU2l6ZeWPluWAvOS4ujExNTLvvIzov5nmoLfnvJbnoIHlh7rmnaXnmoRtcDPml7bplb/lkoxwY23nmoTml7bplb/lrozlhajkuIDoh7TvvIzlkKbliJnkvJrlm6DkuLptcDPmnIDlkI7kuIDluKflvZXpn7PkuI3lpJ/loavmu6Hml7bmt7vliqDloavlhYXmlbDmja7lr7zoh7RtcDPnmoTml7bplb/lj5jplb/jgIJcblx0XHRmcmFtZVR5cGU6XCJcIiDluKfnsbvlnovvvIzkuIDoiKzkuLpyZWMuc2V0LnR5cGXvvIzmj5DkvpvmraTlj4LmlbDml7bml6DpnIDmj5DkvptmcmFtZVNpemXvvIzkvJroh6rliqjkvb/nlKjmnIDkvbPnmoTlgLznu5lmcmFtZVNpemXotYvlgLzvvIznm67liY3ku4XmlK/mjIFtcDM9MTE1MihNUEVHMSBMYXllcjPnmoTmr4/luKfph4fph4fmoLfmlbAp77yM5YW25LuW57G75Z6LPTHjgIJcblx0XHRcdOS7peS4iuS4pOS4quWPguaVsOeUqOS6jui/nue7rei9rOaNouaXtuS9v+eUqO+8jOacgOWkmuS9v+eUqOS4gOS4qu+8jOS4jeaPkOS+m+aXtuS4jei/m+ihjOW4p+eahOeJueauiuWkhOeQhu+8jOaPkOS+m+aXtuW/hemhu+WQjOaXtuaPkOS+m3ByZXZDaHVua0luZm/miY3mnInkvZznlKjjgILmnIDlkI7kuIDmrrXmlbDmja7lpITnkIbml7bml6DpnIDmj5DkvpvluKflpKflsI/ku6Xkvr/ovpPlh7rmnIDlkI7kuIDkuIHngrnmrovnlZnmlbDmja7jgIJcblx0fVxuXG7ov5Tlm55DaHVua0luZm86e1xuXHQvL+WPr+WumuS5ie+8jOS7juaMh+WumuS9jee9ruW8gOWni+i9rOaNouWIsOe7k+WwvlxuXHRpbmRleDowIHBjbURhdGFz5bey5aSE55CG5Yiw55qE57Si5byVXG5cdG9mZnNldDowLjAg5bey5aSE55CG5Yiw55qEaW5kZXjlr7nlupTnmoRwY23kuK3nmoTlgY/np7vnmoTkuIvkuIDkuKrkvY3nva5cblx0XG5cdC8v5LuF5L2c5Li66L+U5Zue5YC8XG5cdGZyYW1lTmV4dDpudWxsfHxbSW50MTYsLi4uXSDkuIvkuIDluKfnmoTpg6jliIbmlbDmja7vvIxmcmFtZVNpemXorr7nva7kuobnmoTml7blgJnmiY3lj6/og73kvJrmnIlcblx0c2FtcGxlUmF0ZToxNjAwMCDnu5PmnpznmoTph4fmoLfnjofvvIw8PW5ld1NhbXBsZVJhdGVcblx0ZGF0YTpbSW50MTYsLi4uXSDovazmjaLlkI7nmoRQQ03nu5PmnpzvvJvlpoLmnpzmmK/ov57nu63ovazmjaLvvIzlubbkuJRwY21EYXRhc+S4reW5tuayoeacieaWsOaVsOaNruaXtu+8jGRhdGHnmoTplb/luqblj6/og73kuLowXG59XG4qL1xuUmVjb3JkZXIuU2FtcGxlRGF0YT1mdW5jdGlvbihwY21EYXRhcyxwY21TYW1wbGVSYXRlLG5ld1NhbXBsZVJhdGUscHJldkNodW5rSW5mbyxvcHRpb24pe1xuXHRwcmV2Q2h1bmtJbmZvfHwocHJldkNodW5rSW5mbz17fSk7XG5cdHZhciBpbmRleD1wcmV2Q2h1bmtJbmZvLmluZGV4fHwwO1xuXHR2YXIgb2Zmc2V0PXByZXZDaHVua0luZm8ub2Zmc2V0fHwwO1xuXHRcblx0dmFyIGZyYW1lTmV4dD1wcmV2Q2h1bmtJbmZvLmZyYW1lTmV4dHx8W107XG5cdG9wdGlvbnx8KG9wdGlvbj17fSk7XG5cdHZhciBmcmFtZVNpemU9b3B0aW9uLmZyYW1lU2l6ZXx8MTtcblx0aWYob3B0aW9uLmZyYW1lVHlwZSl7XG5cdFx0ZnJhbWVTaXplPW9wdGlvbi5mcmFtZVR5cGU9PVwibXAzXCI/MTE1MjoxO1xuXHR9O1xuXHRcblx0dmFyIHNpemU9MDtcblx0Zm9yKHZhciBpPWluZGV4O2k8cGNtRGF0YXMubGVuZ3RoO2krKyl7XG5cdFx0c2l6ZSs9cGNtRGF0YXNbaV0ubGVuZ3RoO1xuXHR9O1xuXHRzaXplPU1hdGgubWF4KDAsc2l6ZS1NYXRoLmZsb29yKG9mZnNldCkpO1xuXHRcblx0Ly/ph4fmoLcgaHR0cHM6Ly93d3cuY25ibG9ncy5jb20vYmxxdy9wLzM3ODI0MjAuaHRtbFxuXHR2YXIgc3RlcD1wY21TYW1wbGVSYXRlL25ld1NhbXBsZVJhdGU7XG5cdGlmKHN0ZXA+MSl7Ly/mlrDph4fmoLfkvY7kuo7lvZXpn7Pph4fmoLfvvIzov5vooYzmir3moLdcblx0XHRzaXplPU1hdGguZmxvb3Ioc2l6ZS9zdGVwKTtcblx0fWVsc2V7Ly/mlrDph4fmoLfpq5jkuo7lvZXpn7Pph4fmoLfkuI3lpITnkIbvvIznnIHljrvkuobmj5LlgLzlpITnkIZcblx0XHRzdGVwPTE7XG5cdFx0bmV3U2FtcGxlUmF0ZT1wY21TYW1wbGVSYXRlO1xuXHR9O1xuXHRcblx0c2l6ZSs9ZnJhbWVOZXh0Lmxlbmd0aDtcblx0dmFyIHJlcz1uZXcgSW50MTZBcnJheShzaXplKTtcblx0dmFyIGlkeD0wO1xuXHQvL+a3u+WKoOS4iuS4gOasoeS4jeWkn+S4gOW4p+eahOWJqeS9meaVsOaNrlxuXHRmb3IodmFyIGk9MDtpPGZyYW1lTmV4dC5sZW5ndGg7aSsrKXtcblx0XHRyZXNbaWR4XT1mcmFtZU5leHRbaV07XG5cdFx0aWR4Kys7XG5cdH07XG5cdC8v5aSE55CG5pWw5o2uXG5cdGZvciAodmFyIG5sPXBjbURhdGFzLmxlbmd0aDtpbmRleDxubDtpbmRleCsrKSB7XG5cdFx0dmFyIG89cGNtRGF0YXNbaW5kZXhdO1xuXHRcdHZhciBpPW9mZnNldCxpbD1vLmxlbmd0aDtcblx0XHR3aGlsZShpPGlsKXtcblx0XHRcdC8vcmVzW2lkeF09b1tNYXRoLnJvdW5kKGkpXTsg55u05o6l566A5Y2V5oq95qC3XG5cdFx0XHRcblx0XHRcdC8vaHR0cHM6Ly93d3cuY25ibG9ncy5jb20veGlhb3FpL3AvNjk5MzkxMi5odG1sXG5cdFx0XHQvL+W9k+WJjeeCuT3lvZPliY3ngrkr5Yiw5ZCO6Z2i5LiA5Liq54K55LmL6Ze055qE5aKe6YeP77yM6Z+z6LSo5q+U55u05o6l566A5Y2V5oq95qC35aW95LqbXG5cdFx0XHR2YXIgYmVmb3JlID0gTWF0aC5mbG9vcihpKTtcblx0XHRcdHZhciBhZnRlciA9IE1hdGguY2VpbChpKTtcblx0XHRcdHZhciBhdFBvaW50ID0gaSAtIGJlZm9yZTtcblx0XHRcdFxuXHRcdFx0dmFyIGJlZm9yZVZhbD1vW2JlZm9yZV07XG5cdFx0XHR2YXIgYWZ0ZXJWYWw9YWZ0ZXI8aWwgPyBvW2FmdGVyXVxuXHRcdFx0XHQ6ICgvL+WQjuS4queCuei2iueVjOS6hu+8jOafpeaJvuS4i+S4gOS4quaVsOe7hFxuXHRcdFx0XHRcdChwY21EYXRhc1tpbmRleCsxXXx8W2JlZm9yZVZhbF0pWzBdfHwwXG5cdFx0XHRcdCk7XG5cdFx0XHRyZXNbaWR4XT1iZWZvcmVWYWwrKGFmdGVyVmFsLWJlZm9yZVZhbCkqYXRQb2ludDtcblx0XHRcdFxuXHRcdFx0aWR4Kys7XG5cdFx0XHRpKz1zdGVwOy8v5oq95qC3XG5cdFx0fTtcblx0XHRvZmZzZXQ9aS1pbDtcblx0fTtcblx0Ly/luKflpITnkIZcblx0ZnJhbWVOZXh0PW51bGw7XG5cdHZhciBmcmFtZU5leHRTaXplPXJlcy5sZW5ndGglZnJhbWVTaXplO1xuXHRpZihmcmFtZU5leHRTaXplPjApe1xuXHRcdHZhciB1OFBvcz0ocmVzLmxlbmd0aC1mcmFtZU5leHRTaXplKSoyO1xuXHRcdGZyYW1lTmV4dD1uZXcgSW50MTZBcnJheShyZXMuYnVmZmVyLnNsaWNlKHU4UG9zKSk7XG5cdFx0cmVzPW5ldyBJbnQxNkFycmF5KHJlcy5idWZmZXIuc2xpY2UoMCx1OFBvcykpO1xuXHR9O1xuXHRcblx0cmV0dXJuIHtcblx0XHRpbmRleDppbmRleFxuXHRcdCxvZmZzZXQ6b2Zmc2V0XG5cdFx0XG5cdFx0LGZyYW1lTmV4dDpmcmFtZU5leHRcblx0XHQsc2FtcGxlUmF0ZTpuZXdTYW1wbGVSYXRlXG5cdFx0LGRhdGE6cmVzXG5cdH07XG59O1xuXG5cbi8q6K6h566X6Z+z6YeP55m+5YiG5q+U55qE5LiA5Liq5pa55rOVXG5wY21BYnNTdW06IHBjbSBJbnQxNuaJgOaciemHh+agt+eahOe7neWvueWAvOeahOWSjFxucGNtTGVuZ3RoOiBwY23plb/luqZcbui/lOWbnuWAvO+8mjAtMTAw77yM5Li76KaB5b2T5YGa55m+5YiG5q+U55SoXG7ms6jmhI/vvJrov5nkuKrkuI3mmK/liIbotJ3vvIzlm6DmraTmsqHnlKh2b2x1bWXlvZPlgZrlkI3np7AqL1xuUmVjb3JkZXIuUG93ZXJMZXZlbD1mdW5jdGlvbihwY21BYnNTdW0scGNtTGVuZ3RoKXtcblx0LyrorqHnrpfpn7Pph48gaHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pvZHkxOTg5L2FydGljbGUvZGV0YWlscy83MzQ4MDI1OVxuXHTmm7Tpq5jngbXmlY/luqbnrpfms5U6XG5cdFx06ZmQ5a6a5pyA5aSn5oSf5bqU5YC8MTAwMDBcblx0XHRcdOe6v+aAp+absue6v++8muS9jumfs+mHj+S4jeWPi+WlvVxuXHRcdFx0XHRwb3dlci8xMDAwMCoxMDAgXG5cdFx0XHTlr7nmlbDmm7Lnur/vvJrkvY7pn7Pph4/lj4vlpb3vvIzkvYbpnIDpmZDlrprmnIDkvY7mhJ/lupTlgLxcblx0XHRcdFx0KDErTWF0aC5sb2cxMChwb3dlci8xMDAwMCkpKjEwMFxuXHQqL1xuXHR2YXIgcG93ZXI9KHBjbUFic1N1bS9wY21MZW5ndGgpIHx8IDA7Ly9OYU5cblx0dmFyIGxldmVsO1xuXHRpZihwb3dlcjwxMjUxKXsvLzEyNTDnmoTnu5PmnpwxMCXvvIzmm7TlsI/nmoTpn7Pph4/ph4fnlKjnur/mgKflj5blgLxcblx0XHRsZXZlbD1NYXRoLnJvdW5kKHBvd2VyLzEyNTAqMTApO1xuXHR9ZWxzZXtcblx0XHRsZXZlbD1NYXRoLnJvdW5kKE1hdGgubWluKDEwMCxNYXRoLm1heCgwLCgxK01hdGgubG9nKHBvd2VyLzEwMDAwKS9NYXRoLmxvZygxMCkpKjEwMCkpKTtcblx0fTtcblx0cmV0dXJuIGxldmVsO1xufTtcblxuXG5cblxuLy/luKbml7bpl7TnmoTml6Xlv5fovpPlh7rvvIxDTG9nKG1zZyxlcnJPckxvZ01zZywgbG9nTXNnLi4uKSBlcnLkuLrmlbDlrZfml7bku6Pooajml6Xlv5fnsbvlnosxOmVycm9yIDI6bG9n6buY6K6kIDM6d2Fybu+8jOWQpuWImeW9k+WBmuWGheWuuei+k+WHuu+8jOesrOS4gOS4quWPguaVsOS4jeiDveaYr+WvueixoeWboOS4uuimgeaLvOaOpeaXtumXtO+8jOWQjumdouWPr+S7peaOpeaXoOaVsOS4qui+k+WHuuWPguaVsFxudmFyIENMb2c9ZnVuY3Rpb24obXNnLGVycil7XG5cdHZhciBub3c9bmV3IERhdGUoKTtcblx0dmFyIHQ9KFwiMFwiK25vdy5nZXRNaW51dGVzKCkpLnN1YnN0cigtMilcblx0XHQrXCI6XCIrKFwiMFwiK25vdy5nZXRTZWNvbmRzKCkpLnN1YnN0cigtMilcblx0XHQrXCIuXCIrKFwiMDBcIitub3cuZ2V0TWlsbGlzZWNvbmRzKCkpLnN1YnN0cigtMyk7XG5cdHZhciBhcnI9W1wiW1wiK3QrXCIgUmVjb3JkZXJdXCIrbXNnXTtcblx0dmFyIGE9YXJndW1lbnRzO1xuXHR2YXIgaT0yLGZuPWNvbnNvbGUubG9nO1xuXHRpZih0eXBlb2YoZXJyKT09XCJudW1iZXJcIil7XG5cdFx0Zm49ZXJyPT0xP2NvbnNvbGUuZXJyb3I6ZXJyPT0zP2NvbnNvbGUud2Fybjpmbjtcblx0fWVsc2V7XG5cdFx0aT0xO1xuXHR9O1xuXHRmb3IoO2k8YS5sZW5ndGg7aSsrKXtcblx0XHRhcnIucHVzaChhW2ldKTtcblx0fTtcblx0Zm4uYXBwbHkoY29uc29sZSxhcnIpO1xufTtcblJlY29yZGVyLkNMb2c9Q0xvZztcblxuXG5cblxudmFyIElEPTA7XG5mdW5jdGlvbiBpbml0Rm4oc2V0KXtcblx0dGhpcy5pZD0rK0lEO1xuXHRcblx0Ly/lpoLmnpzlvIDlkK/kuobmtYHph4/nu5/orqHvvIzov5nph4zlsIblj5HpgIHkuIDkuKrlm77niYfor7fmsYJcblx0UmVjb3JkZXIuVHJhZmZpYyYmUmVjb3JkZXIuVHJhZmZpYygpO1xuXHRcblx0XG5cdHZhciBvPXtcblx0XHR0eXBlOlwibXAzXCIgLy/ovpPlh7rnsbvlnovvvJptcDMsd2F277yMd2F26L6T5Ye65paH5Lu25bC65a+46LaF5aSn5LiN5o6o6I2Q5L2/55So77yM5L2GbXAz57yW56CB5pSv5oyB5Lya5a+86Ie0anPmlofku7botoXlpKfvvIzlpoLmnpzkuI3pnIDmlK/mjIFtcDPlj6/ku6Xkvb9qc+aWh+S7tuWkp+W5heWHj+Wwj1xuXHRcdCxiaXRSYXRlOjE2IC8v5q+U54m5546HIHdhdjoxNuaIljjkvY3vvIxNUDPvvJo4a2JwcyAxay9z77yMOGticHMgMmsvcyDlvZXpn7Pmlofku7blvojlsI9cblx0XHRcblx0XHQsc2FtcGxlUmF0ZToxNjAwMCAvL+mHh+agt+eOh++8jHdhduagvOW8j+Wkp+Wwjz1zYW1wbGVSYXRlKuaXtumXtO+8m21wM+atpOmhueWvueS9juavlOeJueeOh+acieW9seWTje+8jOmrmOavlOeJueeOh+WHoOS5juaXoOW9seWTjeOAglxuXHRcdFx0XHRcdC8vd2F25Lu75oSP5YC877yMbXAz5Y+W5YC86IyD5Zu077yaNDgwMDAsIDQ0MTAwLCAzMjAwMCwgMjQwMDAsIDIyMDUwLCAxNjAwMCwgMTIwMDAsIDExMDI1LCA4MDAwXG5cdFx0XHRcdFx0Ly/ph4fmoLfnjoflj4LogINodHRwczovL3d3dy5jbmJsb2dzLmNvbS9kZXZpbjg3L3AvbXAzLXJlY29yZGVyLmh0bWxcblx0XHRcblx0XHQsb25Qcm9jZXNzOk5PT1AgLy9mbihidWZmZXJzLHBvd2VyTGV2ZWwsYnVmZmVyRHVyYXRpb24sYnVmZmVyU2FtcGxlUmF0ZSxuZXdCdWZmZXJJZHgsYXN5bmNFbmQpIGJ1ZmZlcnM9W1tJbnQxNiwuLi5dLC4uLl3vvJrnvJPlhrLnmoRQQ03mlbDmja7vvIzkuLrku47lvIDlp4vlvZXpn7PliLDnjrDlnKjnmoTmiYDmnIlwY23niYfmrrXvvJtwb3dlckxldmVs77ya5b2T5YmN57yT5Yay55qE6Z+z6YeP57qn5YirMC0xMDDvvIxidWZmZXJEdXJhdGlvbu+8muW3sue8k+WGsuaXtumVv++8jGJ1ZmZlclNhbXBsZVJhdGXvvJrnvJPlhrLkvb/nlKjnmoTph4fmoLfnjofvvIjlvZN0eXBl5pSv5oyB6L655b2V6L656L2s56CBKFdvcmtlcinml7bvvIzmraTph4fmoLfnjoflkozorr7nva7nmoTph4fmoLfnjofnm7jlkIzvvIzlkKbliJnkuI3kuIDlrprnm7jlkIzvvInvvJtuZXdCdWZmZXJJZHg65pys5qyh5Zue6LCD5paw5aKe55qEYnVmZmVy6LW35aeL57Si5byV77ybYXN5bmNFbmQ6Zm4oKSDlpoLmnpxvblByb2Nlc3PmmK/lvILmraXnmoQo6L+U5Zue5YC85Li6dHJ1ZeaXtinvvIzlpITnkIblrozmiJDml7bpnIDopoHosIPnlKjmraTlm57osIPvvIzlpoLmnpzkuI3mmK/lvILmraXnmoTor7flv73nlaXmraTlj4LmlbDvvIzmraTmlrnms5Xlm57osIPml7blv4XpobvmmK/nnJ/lvILmraXvvIjkuI3og73nnJ/lvILmraXml7bpnIDnlKhzZXRUaW1lb3V05YyF6KO577yJ44CCb25Qcm9jZXNz6L+U5Zue5YC877ya5aaC5p6c6L+U5ZuedHJ1ZeS7o+ihqOW8gOWQr+W8guatpeaooeW8j++8jOWcqOafkOS6m+Wkp+mHj+i/kOeul+eahOWcuuWQiOW8guatpeaYr+W/hemhu+eahO+8jOW/hemhu+WcqOW8guatpeWkhOeQhuWujOaIkOaXtuiwg+eUqGFzeW5jRW5kKOS4jeiDveecn+W8guatpeaXtumcgOeUqHNldFRpbWVvdXTljIXoo7kp77yM5Zyob25Qcm9jZXNz5omn6KGM5ZCO5paw5aKe55qEYnVmZmVy5Lya5YWo6YOo5pu/5o2i5oiQ56m65pWw57uE77yM5Zug5q2k5pys5Zue6LCD5byA5aS05bqU56uL5Y2z5bCGbmV3QnVmZmVySWR45Yiw5pys5qyh5Zue6LCD57uT5bC+5L2N572u55qEYnVmZmVy5YWo6YOo5L+d5a2Y5Yiw5Y+m5aSW5LiA5Liq5pWw57uE5YaF77yM5aSE55CG5a6M5oiQ5ZCO5YaZ5ZueYnVmZmVyc+S4reacrOasoeWbnuiwg+eahOe7k+WwvuS9jee9ruOAglxuXHRcdFxuXHRcdC8vKioqKioqKumrmOe6p+iuvue9rioqKioqKlxuXHRcdC8vLGRpc2FibGVFbnZJbkZpeDpmYWxzZSDlhoXpg6jlj4LmlbDvvIznpoHnlKjorr7lpIfljaHpob/ml7bpn7PpopHovpPlhaXkuKLlpLHooaXlgb/lip/og71cblx0XHRcblx0XHQvLyx0YWtlb2ZmRW5jb2RlQ2h1bms6Tk9PUCAvL2ZuKGNodW5rQnl0ZXMpIGNodW5rQnl0ZXM9W1VpbnQ4LC4uLl3vvJrlrp7ml7bnvJbnoIHnjq/looPkuIvmjqXnrqHnvJbnoIHlmajovpPlh7rvvIzlvZPnvJbnoIHlmajlrp7ml7bnvJbnoIHlh7rkuIDlnZfmnInmlYjnmoTkuozov5vliLbpn7PpopHmlbDmja7ml7blrp7ml7blm57osIPmraTmlrnms5XvvJvlj4LmlbDkuLrkuozov5vliLbnmoRVaW50OEFycmF577yM5bCx5piv57yW56CB5Ye65p2l55qE6Z+z6aKR5pWw5o2u54mH5q6177yM5omA5pyJ55qEY2h1bmtCeXRlc+aLvOaOpeWcqOS4gOi1t+WNs+S4uuWujOaVtOmfs+mikeOAguacrOWunueOsOeahOaDs+azleacgOWIneeUsVFRMjU0Mzc3NTA0OOaPkOWHulxuXHRcdFx0XHQvL+W9k+aPkOS+m+atpOWbnuiwg+aWueazleaXtu+8jOWwhuaOpeeuoee8lueggeWZqOeahOaVsOaNrui+k+WHuu+8jOe8lueggeWZqOWGhemDqOWwhuaUvuW8g+WtmOWCqOeUn+aIkOeahOmfs+mikeaVsOaNru+8m+eOr+Wig+imgeaxguavlOi+g+iLm+WIu++8muWmguaenOW9k+WJjeeOr+Wig+S4jeaUr+aMgeWunuaXtue8lueggeWkhOeQhu+8jOWwhuWcqG9wZW7ml7bnm7TmjqXotbBmYWls6YC76L6RXG5cdFx0XHRcdC8v5Zug5q2k5o+Q5L6b5q2k5Zue6LCD5ZCO6LCD55Soc3RvcOaWueazleWwhuaXoOazleiOt+W+l+acieaViOeahOmfs+mikeaVsOaNru+8jOWboOS4uue8lueggeWZqOWGheayoeaciemfs+mikeaVsOaNru+8jOWboOatpHN0b3Dml7bov5Tlm57nmoRibG9i5bCG5piv5LiA5Liq5a2X6IqC6ZW/5bqm5Li6MOeahGJsb2Jcblx0XHRcdFx0Ly/nm67liY3lj6rmnIltcDPmoLzlvI/lrp7njrDkuoblrp7ml7bnvJbnoIHvvIzlnKjmlK/mjIHlrp7ml7blpITnkIbnmoTnjq/looPkuK3lsIbkvJrlrp7ml7bnmoTlsIbnvJbnoIHlh7rmnaXnmoRtcDPniYfmrrXpgJrov4fmraTmlrnms5Xlm57osIPvvIzmiYDmnInnmoRjaHVua0J5dGVz5ou85o6l5Yiw5LiA6LW35Y2z5Li65a6M5pW055qEbXAz77yM5q2k56eN5ou85o6l55qE57uT5p6c5q+UbW9ja+aWueazleWunuaXtueUn+aIkOeahOmfs+i0qOabtOWKoO+8jOWboOS4uuWkqeeEtumBv+WFjeS6hummluWwvueahOmdmem7mFxuXHRcdFx0XHQvL+ebruWJjemZpG1wM+WkluWFtuS7luagvOW8j+S4jeWPr+S7peaPkOS+m+atpOWbnuiwg++8jOaPkOS+m+S6huWwhuWcqG9wZW7ml7bnm7TmjqXotbBmYWls6YC76L6RXG5cdH07XG5cdFxuXHRmb3IodmFyIGsgaW4gc2V0KXtcblx0XHRvW2tdPXNldFtrXTtcblx0fTtcblx0dGhpcy5zZXQ9bztcblx0XG5cdHRoaXMuX1M9OTsvL3N0b3DlkIzmraXplIHvvIxzdG9w5Y+v5Lul6Zi75q2ib3Blbui/h+eoi+S4rei/mOacqui/kOihjOeahHN0YXJ0XG59O1xuLy/lkIzmraXplIHvvIzmjqfliLblr7lTdHJlYW3nmoTnq57kuonvvJvnlKjkuo5jbG9zZeaXtuS4reaWreW8guatpeeahG9wZW7vvJvkuIDkuKrlr7nosaFvcGVu5aaC5p6c5Y+Y5YyW5LqG6YO96KaB6Zi75q2iY2xvc2XvvIxTdHJlYW3nmoTmjqfliLbmnYPkuqTkuKrmlrDnmoTlr7nosaFcblJlY29yZGVyLlN5bmM9ey8qb3BlbiovTzo5LC8qY2xvc2UqL0M6OX07XG5cblJlY29yZGVyLnByb3RvdHlwZT1pbml0Rm4ucHJvdG90eXBlPXtcblx0Ly/miZPlvIDlvZXpn7PotYTmupBUcnVlKCksRmFsc2UobXNnLGlzVXNlck5vdEFsbG93Ke+8jOmcgOimgeiwg+eUqGNsb3Nl44CC5rOo5oSP77ya5q2k5pa55rOV5piv5byC5q2l55qE77yb5LiA6Iis5L2/55So5pe25omT5byA77yM55So5a6M56uL5Y2z5YWz6Zet77yb5Y+v6YeN5aSN6LCD55So77yM5Y+v55So5p2l5rWL6K+V5piv5ZCm6IO95b2V6Z+zXG5cdG9wZW46ZnVuY3Rpb24oVHJ1ZSxGYWxzZSl7XG5cdFx0dmFyIFRoaXM9dGhpcztcblx0XHRUcnVlPVRydWV8fE5PT1A7XG5cdFx0dmFyIGZhaWxDYWxsPWZ1bmN0aW9uKGVyck1zZyxpc1VzZXJOb3RBbGxvdyl7XG5cdFx0XHRpc1VzZXJOb3RBbGxvdz0hIWlzVXNlck5vdEFsbG93O1xuXHRcdFx0Q0xvZyhcIuW9lemfs29wZW7lpLHotKXvvJpcIitlcnJNc2crXCIsaXNVc2VyTm90QWxsb3c6XCIraXNVc2VyTm90QWxsb3csMSk7XG5cdFx0XHRGYWxzZSYmRmFsc2UoZXJyTXNnLGlzVXNlck5vdEFsbG93KTtcblx0XHR9O1xuXHRcdFxuXHRcdHZhciBvaz1mdW5jdGlvbigpe1xuXHRcdFx0Q0xvZyhcIm9wZW7miJDlip9cIik7XG5cdFx0XHRUcnVlKCk7XG5cdFx0XHRcblx0XHRcdFRoaXMuX1NPPTA7Ly/op6PpmaRzdG9w5a+5b3BlbuS4reeahHN0YXJ06LCD55So55qE6Zi75q2iXG5cdFx0fTtcblx0XHR2YXIgY29kZUZhaWw9ZnVuY3Rpb24oY29kZSxtc2cpe1xuXHRcdFx0dHJ5ey8v6Leo5Z+f55qE5LyY5YWI5qOA5rWL5LiA5LiLXG5cdFx0XHRcdHdpbmRvdy50b3AuYTtcblx0XHRcdH1jYXRjaChlKXtcblx0XHRcdFx0ZmFpbENhbGwoJ+aXoOadg+W9lemfsyjot6jln5/vvIzor7flsJ3or5Xnu5lpZnJhbWXmt7vliqDpuqblhYvpo47orr/pl67nrZbnlaXvvIzlpoJhbGxvdz1cImNhbWVyYTttaWNyb3Bob25lXCIpJyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdGlmKC9QZXJtaXNzaW9ufEFsbG93L2kudGVzdChjb2RlKSl7XG5cdFx0XHRcdGZhaWxDYWxsKFwi55So5oi35ouS57ud5LqG5b2V6Z+z5p2D6ZmQXCIsdHJ1ZSk7XG5cdFx0XHR9ZWxzZSBpZih3aW5kb3cuaXNTZWN1cmVDb250ZXh0PT09ZmFsc2Upe1xuXHRcdFx0XHRmYWlsQ2FsbChcIuaXoOadg+W9lemfsyjpnIBodHRwcylcIik7XG5cdFx0XHR9ZWxzZSBpZigvRm91bmQvaS50ZXN0KGNvZGUpKXsvL+WPr+iDveaYr+mdnuWuieWFqOeOr+Wig+WvvOiHtOeahOayoeacieiuvuWkh1xuXHRcdFx0XHRmYWlsQ2FsbChtc2crXCLvvIzml6Dlj6/nlKjpuqblhYvpo45cIik7XG5cdFx0XHR9ZWxzZXtcblx0XHRcdFx0ZmFpbENhbGwobXNnKTtcblx0XHRcdH07XG5cdFx0fTtcblx0XHRcblx0XHQvL+WQjOatpemUgVxuXHRcdHZhciBMb2NrPVJlY29yZGVyLlN5bmM7XG5cdFx0dmFyIGxvY2tPcGVuPSsrTG9jay5PLGxvY2tDbG9zZT1Mb2NrLkM7XG5cdFx0VGhpcy5fTz1UaGlzLl9PXz1sb2NrT3BlbjsvL+iusOS9j+W9k+WJjeeahG9wZW7vvIzlpoLmnpzlj5jljJbkuobopoHpmLvmraJjbG9zZe+8jOi/memHjOWBh+WumuS6huaWsOWvueixoeW3suWPluS7o+W9k+WJjeWvueixoeW5tuS4lOS4jeWGjeS9v+eUqFxuXHRcdFRoaXMuX1NPPVRoaXMuX1M7Ly/orrDkvY9vcGVu6L+H56iL5Lit55qEc3RvcO+8jOS4remAlOS7u+S9lXN0b3DosIPnlKjlkI7pg73kuI3og73nu6fnu61vcGVu5Lit55qEc3RhcnRcblx0XHR2YXIgbG9ja0ZhaWw9ZnVuY3Rpb24oKXtcblx0XHRcdC8v5YWB6K645aSa5qyhb3Blbu+8jOS9huS4jeWFgeiuuOS7u+S9leS4gOasoWNsb3Nl77yM5oiW6ICF6Ieq6Lqr5bey57uP6LCD55So5LqG5YWz6ZetXG5cdFx0XHRpZihsb2NrQ2xvc2UhPUxvY2suQyB8fCAhVGhpcy5fTyl7XG5cdFx0XHRcdHZhciBlcnI9XCJvcGVu6KKr5Y+W5raIXCI7XG5cdFx0XHRcdGlmKGxvY2tPcGVuPT1Mb2NrLk8pe1xuXHRcdFx0XHRcdC8v5peg5paw55qEb3Blbu+8jOW3sue7j+iwg+eUqOS6hmNsb3Nl6L+b6KGM5Y+W5raI77yM5q2k5aSE5bqU6K6p5LiK5qyh55qEY2xvc2XmmI7noa7nlJ/mlYhcblx0XHRcdFx0XHRUaGlzLmNsb3NlKCk7XG5cdFx0XHRcdH1lbHNle1xuXHRcdFx0XHRcdGVycj1cIm9wZW7ooqvkuK3mlq1cIjtcblx0XHRcdFx0fTtcblx0XHRcdFx0ZmFpbENhbGwoZXJyKTtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9O1xuXHRcdH07XG5cdFx0XG5cdFx0XG5cdFx0Ly/lpoLmnpzlt7LmiZPlvIDlsLHkuI3opoHlho3miZPlvIDkuoZcblx0XHRpZihSZWNvcmRlci5Jc09wZW4oKSl7XG5cdFx0XHRvaygpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH07XG5cdFx0aWYoIVJlY29yZGVyLlN1cHBvcnQoKSl7XG5cdFx0XHRjb2RlRmFpbChcIlwiLFwi5q2k5rWP6KeI5Zmo5LiN5pSv5oyB5b2V6Z+zXCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH07XG5cdFx0XG5cdFx0Ly/njq/looPphY3nva7mo4Dmn6Vcblx0XHR2YXIgY2hlY2tNc2c9VGhpcy5lbnZDaGVjayh7ZW52TmFtZTpcIkg1XCIsY2FuUHJvY2Vzczp0cnVlfSk7XG5cdFx0aWYoY2hlY2tNc2cpe1xuXHRcdFx0ZmFpbENhbGwoXCLkuI3og73lvZXpn7PvvJpcIitjaGVja01zZyk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fTtcblx0XHRcblx0XHQvL+ivt+axguadg+mZkO+8jOWmguaenOS7juacquaOiOadg++8jOS4gOiIrOa1j+iniOWZqOS8muW8ueWHuuadg+mZkOivt+axguW8ueahhlxuXHRcdHZhciBmMT1mdW5jdGlvbihzdHJlYW0pe1xuXHRcdFx0UmVjb3JkZXIuU3RyZWFtPXN0cmVhbTtcblx0XHRcdHN0cmVhbS5fY2FsbD17fTsvL+atpOaXtmlzIG9wZW7vvIzkvYblubbmnKpjb25uZWN077yM5piv5YWB6K6457uR5a6a5o6l5pS25pWw5o2u55qEXG5cdFx0XHRpZihsb2NrRmFpbCgpKXJldHVybjtcblx0XHRcdFxuXHRcdFx0Ly9odHRwczovL2dpdGh1Yi5jb20veGlhbmd5dWVjbi9SZWNvcmRlci9pc3N1ZXMvMTQg6I635Y+W5Yiw55qEdHJhY2sucmVhZHlTdGF0ZSE9XCJsaXZlXCLvvIzliJrliJrlm57osIPml7blj6/og73mmK/mraPluLjnmoTvvIzkvYbov4fkuIDkuIvlj6/og73lsLHooqvlhbPmjonkuobvvIzljp/lm6DkuI3mmI7jgILlu7bov5/kuIDkuIvkv53or4HnnJ/lvILmraXjgILlr7nmraPluLjmtY/op4jlmajkuI3lvbHlk41cblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcblx0XHRcdFx0aWYobG9ja0ZhaWwoKSlyZXR1cm47XG5cdFx0XHRcdFxuXHRcdFx0XHRpZihSZWNvcmRlci5Jc09wZW4oKSl7XG5cdFx0XHRcdFx0Q29ubmVjdCgpO1xuXHRcdFx0XHRcdG9rKCk7XG5cdFx0XHRcdH1lbHNle1xuXHRcdFx0XHRcdGZhaWxDYWxsKFwi5b2V6Z+z5Yqf6IO95peg5pWI77ya5peg6Z+z6aKR5rWBXCIpO1xuXHRcdFx0XHR9O1xuXHRcdFx0fSwxMDApO1xuXHRcdH07XG5cdFx0dmFyIGYyPWZ1bmN0aW9uKGUpe1xuXHRcdFx0dmFyIGNvZGU9ZS5uYW1lfHxlLm1lc3NhZ2V8fGUuY29kZStcIjpcIitlO1xuXHRcdFx0Q0xvZyhcIuivt+axguW9lemfs+adg+mZkOmUmeivr1wiLDEsZSk7XG5cdFx0XHRcblx0XHRcdGNvZGVGYWlsKGNvZGUsXCLml6Dms5XlvZXpn7PvvJpcIitjb2RlKTtcblx0XHR9O1xuXHRcdHZhciBwcm89UmVjb3JkZXIuU2NvcGUuZ2V0VXNlck1lZGlhKHthdWRpbzp0cnVlfSxmMSxmMik7XG5cdFx0aWYocHJvJiZwcm8udGhlbil7XG5cdFx0XHRwcm8udGhlbihmMSlbVHJ1ZSYmXCJjYXRjaFwiXShmMik7IC8vZml4IOWFs+mUruWtl++8jOS/neivgWNhdGNo5Y6L57yp5pe25L+d5oyB5a2X56ym5Liy5b2i5byPXG5cdFx0fTtcblx0fVxuXHQvL+WFs+mXremHiuaUvuW9lemfs+i1hOa6kFxuXHQsY2xvc2U6ZnVuY3Rpb24oY2FsbCl7XG5cdFx0Y2FsbD1jYWxsfHxOT09QO1xuXHRcdFxuXHRcdHZhciBUaGlzPXRoaXM7XG5cdFx0VGhpcy5fc3RvcCgpO1xuXHRcdFxuXHRcdHZhciBMb2NrPVJlY29yZGVyLlN5bmM7XG5cdFx0VGhpcy5fTz0wO1xuXHRcdGlmKFRoaXMuX09fIT1Mb2NrLk8pe1xuXHRcdFx0Ly/llK/kuIDotYTmupBTdHJlYW3nmoTmjqfliLbmnYPlt7LkuqTnu5nmlrDlr7nosaHvvIzov5nph4zkuI3og73lhbPpl63jgILmraTlpITlnKjmr4/mrKHpg73lvLnmnYPpmZDnmoTmtY/op4jlmajlhoXlj6/og73lrZjlnKjms4TmvI/vvIzmlrDlr7nosaHooqvmi5Lnu53mnYPpmZDlj6/og73kuI3kvJrosIPnlKhjbG9zZe+8jOW/veeVpei/meenjeS4jeWkhOeQhlxuXHRcdFx0Q0xvZyhcImNsb3Nl6KKr5b+955WlXCIsMyk7XG5cdFx0XHRjYWxsKCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fTtcblx0XHRMb2NrLkMrKzsvL+iOt+W+l+aOp+WItuadg1xuXHRcdFxuXHRcdHZhciBzdHJlYW09UmVjb3JkZXIuU3RyZWFtO1xuXHRcdGlmKHN0cmVhbSl7XG5cdFx0XHREaXNjb25uZWN0KCk7XG5cdFx0XHRcblx0XHRcdHZhciB0cmFja3M9c3RyZWFtLmdldFRyYWNrcyYmc3RyZWFtLmdldFRyYWNrcygpfHxzdHJlYW0uYXVkaW9UcmFja3N8fFtdO1xuXHRcdFx0Zm9yKHZhciBpPTA7aTx0cmFja3MubGVuZ3RoO2krKyl7XG5cdFx0XHRcdHZhciB0cmFjaz10cmFja3NbaV07XG5cdFx0XHRcdHRyYWNrLnN0b3AmJnRyYWNrLnN0b3AoKTtcblx0XHRcdH07XG5cdFx0XHRzdHJlYW0uc3RvcCYmc3RyZWFtLnN0b3AoKTtcblx0XHR9O1xuXHRcdFxuXHRcdFJlY29yZGVyLlN0cmVhbT0wO1xuXHRcdENMb2coXCJjbG9zZVwiKTtcblx0XHRjYWxsKCk7XG5cdH1cblx0XG5cdFxuXHRcblx0XG5cdFxuXHQvKuaooeaLn+S4gOauteW9lemfs+aVsOaNru+8jOWQjumdouWPr+S7peiwg+eUqHN0b3Dov5vooYznvJbnoIHvvIzpnIDmj5DkvptwY23mlbDmja5bMSwyLDMuLi5d77yMcGNt55qE6YeH5qC3546HKi9cblx0LG1vY2s6ZnVuY3Rpb24ocGNtRGF0YSxwY21TYW1wbGVSYXRlKXtcblx0XHR2YXIgVGhpcz10aGlzO1xuXHRcdFRoaXMuX3N0b3AoKTsvL+a4heeQhuaOieW3suacieeahOi1hOa6kFxuXHRcdFxuXHRcdFRoaXMuaXNNb2NrPTE7XG5cdFx0VGhpcy5tb2NrRW52SW5mbz1udWxsO1xuXHRcdFRoaXMuYnVmZmVycz1bcGNtRGF0YV07XG5cdFx0VGhpcy5yZWNTaXplPXBjbURhdGEubGVuZ3RoO1xuXHRcdFRoaXMuc3JjU2FtcGxlUmF0ZT1wY21TYW1wbGVSYXRlO1xuXHRcdHJldHVybiBUaGlzO1xuXHR9XG5cdCxlbnZDaGVjazpmdW5jdGlvbihlbnZJbmZvKXsvL+W5s+WPsOeOr+Wig+S4i+eahOWPr+eUqOaAp+ajgOafpe+8jOS7u+S9leaXtuWAmemDveWPr+S7peiwg+eUqOajgOafpe+8jOi/lOWbnmVyck1zZzpcIlwi5q2j5bi477yMXCLlpLHotKXljp/lm6BcIlxuXHRcdC8vZW52SW5mbz17ZW52TmFtZTpcIkg1XCIsY2FuUHJvY2Vzczp0cnVlfVxuXHRcdHZhciBlcnJNc2csVGhpcz10aGlzLHNldD1UaGlzLnNldDtcblx0XHRcblx0XHQvL+e8lueggeWZqOajgOafpeeOr+Wig+S4i+mFjee9ruaYr+WQpuWPr+eUqFxuXHRcdGlmKCFlcnJNc2cpe1xuXHRcdFx0aWYoVGhpc1tzZXQudHlwZStcIl9lbnZDaGVja1wiXSl7Ly/nvJbnoIHlmajlt7Llrp7njrDnjq/looPmo4Dmn6Vcblx0XHRcdFx0ZXJyTXNnPVRoaXNbc2V0LnR5cGUrXCJfZW52Q2hlY2tcIl0oZW52SW5mbyxzZXQpO1xuXHRcdFx0fWVsc2V7Ly/mnKrlrp7njrDmo4Dmn6XnmoTmiYvliqjmo4Dmn6XphY3nva7mmK/lkKbmnInmlYhcblx0XHRcdFx0aWYoc2V0LnRha2VvZmZFbmNvZGVDaHVuayl7XG5cdFx0XHRcdFx0ZXJyTXNnPXNldC50eXBlK1wi57G75Z6L5LiN5pSv5oyB6K6+572udGFrZW9mZkVuY29kZUNodW5rXCI7XG5cdFx0XHRcdH07XG5cdFx0XHR9O1xuXHRcdH07XG5cdFx0XG5cdFx0cmV0dXJuIGVyck1zZ3x8XCJcIjtcblx0fVxuXHQsZW52U3RhcnQ6ZnVuY3Rpb24obW9ja0VudkluZm8sc2FtcGxlUmF0ZSl7Ly/lubPlj7Dnjq/looPnm7jlhbPnmoRzdGFydOiwg+eUqFxuXHRcdHZhciBUaGlzPXRoaXMsc2V0PVRoaXMuc2V0O1xuXHRcdFRoaXMuaXNNb2NrPW1vY2tFbnZJbmZvPzE6MDsvL+mdnkg1546v5aKD6ZyA6KaB5ZCv55SobW9ja++8jOW5tuaPkOS+m2VudkNoZWNr6ZyA6KaB55qE546v5aKD5L+h5oGvXG5cdFx0VGhpcy5tb2NrRW52SW5mbz1tb2NrRW52SW5mbztcblx0XHRUaGlzLmJ1ZmZlcnM9W107Ly/mlbDmja7nvJPlhrJcblx0XHRUaGlzLnJlY1NpemU9MDsvL+aVsOaNruWkp+Wwj1xuXHRcdFxuXHRcdFRoaXMuZW52SW5MYXN0PTA7Ly9lbnZJbuaOpeaUtuWIsOacgOWQjuW9lemfs+WGheWuueeahOaXtumXtFxuXHRcdFRoaXMuZW52SW5GaXJzdD0wOy8vZW52SW7mjqXmlLbliLDnmoTpppbkuKrlvZXpn7PlhoXlrrnnmoTlvZXliLbml7bpl7Rcblx0XHRUaGlzLmVudkluRml4PTA7Ly/ooaXlgb/nmoTmgLvml7bpl7Rcblx0XHRUaGlzLmVudkluRml4VHM9W107Ly/ooaXlgb/orqHmlbDliJfooahcblx0XHRcblx0XHRzZXQuc2FtcGxlUmF0ZT1NYXRoLm1pbihzYW1wbGVSYXRlLHNldC5zYW1wbGVSYXRlKTsvL2VuZ2luZUN0eOmcgOimgeaPkOWJjeehruWumuacgOe7iOeahOmHh+agt+eOh1xuXHRcdFRoaXMuc3JjU2FtcGxlUmF0ZT1zYW1wbGVSYXRlO1xuXHRcdFxuXHRcdFRoaXMuZW5naW5lQ3R4PTA7XG5cdFx0Ly/mraTnsbvlnovmnInovrnlvZXovrnovaznoIEoV29ya2VyKeaUr+aMgVxuXHRcdGlmKFRoaXNbc2V0LnR5cGUrXCJfc3RhcnRcIl0pe1xuXHRcdFx0dmFyIGVuZ2luZUN0eD1UaGlzLmVuZ2luZUN0eD1UaGlzW3NldC50eXBlK1wiX3N0YXJ0XCJdKHNldCk7XG5cdFx0XHRpZihlbmdpbmVDdHgpe1xuXHRcdFx0XHRlbmdpbmVDdHgucGNtRGF0YXM9W107XG5cdFx0XHRcdGVuZ2luZUN0eC5wY21TaXplPTA7XG5cdFx0XHR9O1xuXHRcdH07XG5cdH1cblx0LGVudlJlc3VtZTpmdW5jdGlvbigpey8v5ZKM5bmz5Y+w546v5aKD5peg5YWz55qE5oGi5aSN5b2V6Z+zXG5cdFx0Ly/ph43mlrDlvIDlp4vorqHmlbBcblx0XHR0aGlzLmVudkluRml4VHM9W107XG5cdH1cblx0LGVudkluOmZ1bmN0aW9uKHBjbSxzdW0pey8v5ZKM5bmz5Y+w546v5aKD5peg5YWz55qEcGNtW0ludDE2Xei+k+WFpVxuXHRcdHZhciBUaGlzPXRoaXMsc2V0PVRoaXMuc2V0LGVuZ2luZUN0eD1UaGlzLmVuZ2luZUN0eDtcblx0XHR2YXIgYnVmZmVyU2FtcGxlUmF0ZT1UaGlzLnNyY1NhbXBsZVJhdGU7XG5cdFx0dmFyIHNpemU9cGNtLmxlbmd0aDtcblx0XHR2YXIgcG93ZXJMZXZlbD1SZWNvcmRlci5Qb3dlckxldmVsKHN1bSxzaXplKTtcblx0XHRcblx0XHR2YXIgYnVmZmVycz1UaGlzLmJ1ZmZlcnM7XG5cdFx0dmFyIGJ1ZmZlckZpcnN0SWR4PWJ1ZmZlcnMubGVuZ3RoOy8v5LmL5YmN55qEYnVmZmVy6YO95piv57uP6L+Hb25Qcm9jZXNz5aSE55CG5aW955qE77yM5LiN5YWB6K645YaN5L+u5pS5XG5cdFx0YnVmZmVycy5wdXNoKHBjbSk7XG5cdFx0XG5cdFx0Ly/mnIllbmdpbmVDdHjml7bkvJrooqvopobnm5bvvIzov5nph4zkv53lrZjkuIDku71cblx0XHR2YXIgYnVmZmVyc1RoaXM9YnVmZmVycztcblx0XHR2YXIgYnVmZmVyRmlyc3RJZHhUaGlzPWJ1ZmZlckZpcnN0SWR4O1xuXHRcdFxuXHRcdC8v5Y2h6aG/5Lii5aSx6KGl5YG/77ya5Zug5Li66K6+5aSH5b6I5Y2h55qE5pe25YCZ5a+86Ie0SDXmjqXmlLbliLDnmoTmlbDmja7ph4/kuI3lpJ/pgKDmiJDmkq3mlL7ml7blgJnlj5jpgJ/vvIznu5Pmnpzmr5Tlrp7pmYXnmoTml7bplb/opoHnn63vvIzmraTlpITkv53or4HkuobkuI3kvJrlj5jnn63vvIzkvYbkuI3og73kv67lpI3kuKLlpLHnmoTpn7PpopHmlbDmja7pgKDmiJDpn7PotKjlj5jlt67jgILlvZPliY3nrpfms5Xph4fnlKjovpPlhaXml7bpl7TkvqbmtYvkuIvkuIDluKfmmK/lkKbpnIDopoHmt7vliqDooaXlgb/luKfvvIzpnIDopoEoNuasoei+k+WFpXx86LaF6L+HMeenkinku6XkuIrmiY3kvJrlvIDlp4vkvqbmtYvvvIzlpoLmnpzmu5Hliqjnqpflj6PlhoXkuKLlpLHotoXov4cxLzPlsLHkvJrov5vooYzooaXlgb9cblx0XHR2YXIgbm93PURhdGUubm93KCk7XG5cdFx0dmFyIHBjbVRpbWU9TWF0aC5yb3VuZChzaXplL2J1ZmZlclNhbXBsZVJhdGUqMTAwMCk7XG5cdFx0VGhpcy5lbnZJbkxhc3Q9bm93O1xuXHRcdGlmKFRoaXMuYnVmZmVycy5sZW5ndGg9PTEpey8v6K6w5LiL6aaW5Liq5b2V6Z+z5pWw5o2u55qE5b2V5Yi25pe26Ze0XG5cdFx0XHRUaGlzLmVudkluRmlyc3Q9bm93LXBjbVRpbWU7XG5cdFx0fTtcblx0XHR2YXIgZW52SW5GaXhUcz1UaGlzLmVudkluRml4VHM7XG5cdFx0ZW52SW5GaXhUcy5zcGxpY2UoMCwwLHt0Om5vdyxkOnBjbVRpbWV9KTtcblx0XHQvL+S/neeVmTPnp5LnmoTorqHmlbDmu5Hliqjnqpflj6PvvIzlj6blpJbotoXov4cz56eS55qE5YGc6aG/5LiN6KGl5YG/XG5cdFx0dmFyIHRzSW5TdGFydD1ub3csdHNQY209MDtcblx0XHRmb3IodmFyIGk9MDtpPGVudkluRml4VHMubGVuZ3RoO2krKyl7XG5cdFx0XHR2YXIgbz1lbnZJbkZpeFRzW2ldO1xuXHRcdFx0aWYobm93LW8udD4zMDAwKXtcblx0XHRcdFx0ZW52SW5GaXhUcy5sZW5ndGg9aTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9O1xuXHRcdFx0dHNJblN0YXJ0PW8udDtcblx0XHRcdHRzUGNtKz1vLmQ7XG5cdFx0fTtcblx0XHQvL+i+vuWIsOmcgOimgeeahOaVsOaNrumHj++8jOW8gOWni+S+pua1i+aYr+WQpumcgOimgeihpeWBv1xuXHRcdHZhciB0c0luUHJldj1lbnZJbkZpeFRzWzFdO1xuXHRcdHZhciB0c0luPW5vdy10c0luU3RhcnQ7XG5cdFx0dmFyIGxvc3Q9dHNJbi10c1BjbTtcblx0XHRpZiggbG9zdD50c0luLzMgJiYgKHRzSW5QcmV2JiZ0c0luPjEwMDAgfHwgZW52SW5GaXhUcy5sZW5ndGg+PTYpICl7XG5cdFx0XHQvL+S4ouWksei/h+Wkmu+8jOW8gOWni+aJp+ihjOihpeWBv1xuXHRcdFx0dmFyIGFkZFRpbWU9bm93LXRzSW5QcmV2LnQtcGNtVGltZTsvL+i3neemu+S4iuasoei+k+WFpeS4ouWksei/meS5iOWkmm1zXG5cdFx0XHRpZihhZGRUaW1lPnBjbVRpbWUvNSl7Ly/kuKLlpLHotoXov4fmnKzluKfnmoQxLzVcblx0XHRcdFx0dmFyIGZpeE9wZW49IXNldC5kaXNhYmxlRW52SW5GaXg7XG5cdFx0XHRcdENMb2coXCJbXCIrbm93K1wiXVwiKyhmaXhPcGVuP1wiXCI6XCLmnKpcIikrXCLooaXlgb9cIithZGRUaW1lK1wibXNcIiwzKTtcblx0XHRcdFx0VGhpcy5lbnZJbkZpeCs9YWRkVGltZTtcblx0XHRcdFx0XG5cdFx0XHRcdC8v55So6Z2Z6buY6L+b6KGM6KGl5YG/XG5cdFx0XHRcdGlmKGZpeE9wZW4pe1xuXHRcdFx0XHRcdHZhciBhZGRQY209bmV3IEludDE2QXJyYXkoYWRkVGltZSpidWZmZXJTYW1wbGVSYXRlLzEwMDApO1xuXHRcdFx0XHRcdHNpemUrPWFkZFBjbS5sZW5ndGg7XG5cdFx0XHRcdFx0YnVmZmVycy5wdXNoKGFkZFBjbSk7XG5cdFx0XHRcdH07XG5cdFx0XHR9O1xuXHRcdH07XG5cdFx0XG5cdFx0XG5cdFx0dmFyIHNpemVPbGQ9VGhpcy5yZWNTaXplLGFkZFNpemU9c2l6ZTtcblx0XHR2YXIgYnVmZmVyU2l6ZT1zaXplT2xkK2FkZFNpemU7XG5cdFx0VGhpcy5yZWNTaXplPWJ1ZmZlclNpemU7Ly/mraTlgLzlnKhvblByb2Nlc3PlkI7pnIDopoHkv67mraPvvIzlj6/og73mlrDmlbDmja7ooqvkv67mlLlcblx0XHRcblx0XHRcblx0XHQvL+atpOexu+Wei+aciei+ueW9lei+uei9rOeggShXb3JrZXIp5pSv5oyB77yM5byA5ZCv5a6e5pe26L2s56CBXG5cdFx0aWYoZW5naW5lQ3R4KXtcblx0XHRcdC8v6L2s5o2i5oiQc2V055qE6YeH5qC3546HXG5cdFx0XHR2YXIgY2h1bmtJbmZvPVJlY29yZGVyLlNhbXBsZURhdGEoYnVmZmVycyxidWZmZXJTYW1wbGVSYXRlLHNldC5zYW1wbGVSYXRlLGVuZ2luZUN0eC5jaHVua0luZm8pO1xuXHRcdFx0ZW5naW5lQ3R4LmNodW5rSW5mbz1jaHVua0luZm87XG5cdFx0XHRcblx0XHRcdHNpemVPbGQ9ZW5naW5lQ3R4LnBjbVNpemU7XG5cdFx0XHRhZGRTaXplPWNodW5rSW5mby5kYXRhLmxlbmd0aDtcblx0XHRcdGJ1ZmZlclNpemU9c2l6ZU9sZCthZGRTaXplO1xuXHRcdFx0ZW5naW5lQ3R4LnBjbVNpemU9YnVmZmVyU2l6ZTsvL+atpOWAvOWcqG9uUHJvY2Vzc+WQjumcgOimgeS/ruato++8jOWPr+iDveaWsOaVsOaNruiiq+S/ruaUuVxuXHRcdFx0XG5cdFx0XHRidWZmZXJzPWVuZ2luZUN0eC5wY21EYXRhcztcblx0XHRcdGJ1ZmZlckZpcnN0SWR4PWJ1ZmZlcnMubGVuZ3RoO1xuXHRcdFx0YnVmZmVycy5wdXNoKGNodW5rSW5mby5kYXRhKTtcblx0XHRcdGJ1ZmZlclNhbXBsZVJhdGU9Y2h1bmtJbmZvLnNhbXBsZVJhdGU7XG5cdFx0fTtcblx0XHRcblx0XHR2YXIgZHVyYXRpb249TWF0aC5yb3VuZChidWZmZXJTaXplL2J1ZmZlclNhbXBsZVJhdGUqMTAwMCk7XG5cdFx0dmFyIGJ1ZmZlck5leHRJZHg9YnVmZmVycy5sZW5ndGg7XG5cdFx0dmFyIGJ1ZmZlck5leHRJZHhUaGlzPWJ1ZmZlcnNUaGlzLmxlbmd0aDtcblx0XHRcblx0XHQvL+WFgeiuuOW8guatpeWkhOeQhmJ1ZmZlcuaVsOaNrlxuXHRcdHZhciBhc3luY0VuZD1mdW5jdGlvbigpe1xuXHRcdFx0Ly/ph43mlrDorqHnrpdzaXpl77yM5byC5q2l55qE5pep5bey5YeP5Y675re75Yqg55qE77yM5ZCM5q2l55qE6ZyA5Y675o6J5pys5qyh5re75Yqg55qE54S25ZCO6YeN5paw6K6h566XXG5cdFx0XHR2YXIgbnVtPWFzeW5jQmVnaW4/MDotYWRkU2l6ZTtcblx0XHRcdHZhciBoYXNDbGVhcj1idWZmZXJzWzBdPT1udWxsO1xuXHRcdFx0Zm9yKHZhciBpPWJ1ZmZlckZpcnN0SWR4O2k8YnVmZmVyTmV4dElkeDtpKyspe1xuXHRcdFx0XHR2YXIgYnVmZmVyPWJ1ZmZlcnNbaV07XG5cdFx0XHRcdGlmKGJ1ZmZlcj09bnVsbCl7Ly/lt7LooqvkuLvliqjph4rmlL7lhoXlrZjvvIzmr5TlpoLplb/ml7bpl7Tlrp7ml7bkvKDovpPlvZXpn7Pml7Zcblx0XHRcdFx0XHRoYXNDbGVhcj0xO1xuXHRcdFx0XHR9ZWxzZXtcblx0XHRcdFx0XHRudW0rPWJ1ZmZlci5sZW5ndGg7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly/mjqjlhaXlkI7lj7DovrnlvZXovrnovaznoIFcblx0XHRcdFx0XHRpZihlbmdpbmVDdHgmJmJ1ZmZlci5sZW5ndGgpe1xuXHRcdFx0XHRcdFx0VGhpc1tzZXQudHlwZStcIl9lbmNvZGVcIl0oZW5naW5lQ3R4LGJ1ZmZlcik7XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fTtcblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdC8v5ZCM5q2l5riF55CGVGhpcy5idWZmZXJz77yM5LiN566hYnVmZmVyc+WIsOW6lea4heS6huWkmuWwkeS4qu+8jGJ1ZmZlcnNUaGlz5piv5L2/55So5LiN5Yiw55qE6L+b6KGM5YWo5riFXG5cdFx0XHRpZihoYXNDbGVhciAmJiBlbmdpbmVDdHgpe1xuXHRcdFx0XHR2YXIgaT1idWZmZXJGaXJzdElkeFRoaXM7XG5cdFx0XHRcdGlmKGJ1ZmZlcnNUaGlzWzBdKXtcblx0XHRcdFx0XHRpPTA7XG5cdFx0XHRcdH07XG5cdFx0XHRcdGZvcig7aTxidWZmZXJOZXh0SWR4VGhpcztpKyspe1xuXHRcdFx0XHRcdGJ1ZmZlcnNUaGlzW2ldPW51bGw7XG5cdFx0XHRcdH07XG5cdFx0XHR9O1xuXHRcdFx0XG5cdFx0XHQvL+e7n+iuoeS/ruaUueWQjueahHNpemXvvIzlpoLmnpzlvILmraXlj5HnlJ9jbGVhcuimgeWOn+agt+WKoOWbnuadpe+8jOWQjOatpeeahOaXoOmcgOaTjeS9nFxuXHRcdFx0aWYoaGFzQ2xlYXIpe1xuXHRcdFx0XHRudW09YXN5bmNCZWdpbj9hZGRTaXplOjA7XG5cdFx0XHRcdFxuXHRcdFx0XHRidWZmZXJzWzBdPW51bGw7Ly/lvbvlupXooqvmuIXnkIZcblx0XHRcdH07XG5cdFx0XHRpZihlbmdpbmVDdHgpe1xuXHRcdFx0XHRlbmdpbmVDdHgucGNtU2l6ZSs9bnVtO1xuXHRcdFx0fWVsc2V7XG5cdFx0XHRcdFRoaXMucmVjU2l6ZSs9bnVtO1xuXHRcdFx0fTtcblx0XHR9O1xuXHRcdC8v5a6e5pe25Zue6LCD5aSE55CG5pWw5o2u77yM5YWB6K645L+u5pS55oiW5pu/5o2i5LiK5qyh5Zue6LCD5Lul5p2l5paw5aKe55qE5pWw5o2uIO+8jOS9huaYr+S4jeWFgeiuuOS/ruaUueW3suWkhOeQhui/h+eahO+8jOS4jeWFgeiuuOWinuWIoOesrOS4gOe7tOaVsOe7hCDvvIzlhYHorrjlsIbnrKzkuoznu7TmlbDnu4Tku7vmhI/kv67mlLnmm7/mjaLmiJDnqbrmlbDnu4TkuZ/lj6/ku6Vcblx0XHR2YXIgYXN5bmNCZWdpbj1zZXQub25Qcm9jZXNzKGJ1ZmZlcnMscG93ZXJMZXZlbCxkdXJhdGlvbixidWZmZXJTYW1wbGVSYXRlLGJ1ZmZlckZpcnN0SWR4LGFzeW5jRW5kKTtcblx0XHRcblx0XHRpZihhc3luY0JlZ2luPT09dHJ1ZSl7XG5cdFx0XHQvL+W8gOWQr+S6huW8guatpeaooeW8j++8jG9uUHJvY2Vzc+W3suaOpeeuoWJ1ZmZlcnPmlrDmlbDmja7vvIznq4vljbPmuIXnqbrvvIzpgb/lhY3lh7rnjrDmnKrlpITnkIbnmoTmlbDmja5cblx0XHRcdHZhciBoYXNDbGVhcj0wO1xuXHRcdFx0Zm9yKHZhciBpPWJ1ZmZlckZpcnN0SWR4O2k8YnVmZmVyTmV4dElkeDtpKyspe1xuXHRcdFx0XHRpZihidWZmZXJzW2ldPT1udWxsKXsvL+W3suiiq+S4u+WKqOmHiuaUvuWGheWtmO+8jOavlOWmgumVv+aXtumXtOWunuaXtuS8oOi+k+W9lemfs+aXtiDvvIzkvYblj4jopoHlvIDlkK/lvILmraXmqKHlvI/vvIzmraTnp43mg4XlhrXmmK/pnZ7ms5XnmoRcblx0XHRcdFx0XHRoYXNDbGVhcj0xO1xuXHRcdFx0XHR9ZWxzZXtcblx0XHRcdFx0XHRidWZmZXJzW2ldPW5ldyBJbnQxNkFycmF5KDApO1xuXHRcdFx0XHR9O1xuXHRcdFx0fTtcblx0XHRcdFxuXHRcdFx0aWYoaGFzQ2xlYXIpe1xuXHRcdFx0XHRDTG9nKFwi5pyq6L+b5YWl5byC5q2l5YmN5LiN6IO95riF6ZmkYnVmZmVyc1wiLDMpO1xuXHRcdFx0fWVsc2V7XG5cdFx0XHRcdC8v6L+Y5Y6fc2l6Ze+8jOW8guatpee7k+adn+WQjuWGjee7n+iuoeS7heS/ruaUueWQjueahHNpemXvvIzlpoLmnpzlj5HnlJ9jbGVhcuimgeWOn+agt+WKoOWbnuadpVxuXHRcdFx0XHRpZihlbmdpbmVDdHgpe1xuXHRcdFx0XHRcdGVuZ2luZUN0eC5wY21TaXplLT1hZGRTaXplO1xuXHRcdFx0XHR9ZWxzZXtcblx0XHRcdFx0XHRUaGlzLnJlY1NpemUtPWFkZFNpemU7XG5cdFx0XHRcdH07XG5cdFx0XHR9O1xuXHRcdH1lbHNle1xuXHRcdFx0YXN5bmNFbmQoKTtcblx0XHR9O1xuXHR9XG5cdFxuXHRcblx0XG5cdFxuXHQvL+W8gOWni+W9lemfs++8jOmcgOWFiOiwg+eUqG9wZW7vvJvlj6ropoFvcGVu5oiQ5Yqf5pe277yM6LCD55So5q2k5pa55rOV5piv5a6J5YWo55qE77yM5aaC5p6c5pyqb3BlbuW8uuihjOiwg+eUqOWvvOiHtOeahOWGhemDqOmUmeivr+WwhuS4jeS8muacieS7u+S9leaPkOekuu+8jHN0b3Dml7boh6rnhLbog73lvpfliLDplJnor69cblx0LHN0YXJ0OmZ1bmN0aW9uKCl7XG5cdFx0aWYoIVJlY29yZGVyLklzT3BlbigpKXtcblx0XHRcdENMb2coXCLmnKpvcGVuXCIsMSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fTtcblx0XHRDTG9nKFwi5byA5aeL5b2V6Z+zXCIpO1xuXHRcdFxuXHRcdHZhciBUaGlzPXRoaXMsc2V0PVRoaXMuc2V0LGN0eD1SZWNvcmRlci5DdHg7XG5cdFx0VGhpcy5fc3RvcCgpO1xuXHRcdFRoaXMuc3RhdGU9MDtcblx0XHRUaGlzLmVudlN0YXJ0KG51bGwsY3R4LnNhbXBsZVJhdGUpO1xuXHRcdFxuXHRcdC8v5qOA5p+lb3Blbui/h+eoi+S4rXN0b3DmmK/lkKblt7Lnu4/osIPnlKjov4dcblx0XHRpZihUaGlzLl9TTyYmVGhpcy5fU08rMSE9VGhpcy5fUyl7Ly/kuIrpnaLosIPnlKjov4fkuIDmrKEgX3N0b3Bcblx0XHRcdC8vb3BlbuacquWujOaIkOWwseiwg+eUqOS6hnN0b3DvvIzmraTnp43mg4XlhrXnu4jmraJzdGFydOOAguS5n+W6lOWwvemHj+mBv+WFjeWHuueOsOatpOaDheWGtVxuXHRcdFx0Q0xvZyhcInN0YXJ06KKr5Lit5patXCIsMyk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fTtcblx0XHRUaGlzLl9TTz0wO1xuXHRcdFxuXHRcdHZhciBlbmQ9ZnVuY3Rpb24oKXtcblx0XHRcdFRoaXMuc3RhdGU9MTtcblx0XHRcdFRoaXMucmVzdW1lKCk7XG5cdFx0fTtcblx0XHRpZihjdHguc3RhdGU9PVwic3VzcGVuZGVkXCIpe1xuXHRcdFx0Y3R4LnJlc3VtZSgpLnRoZW4oZnVuY3Rpb24oKXtcblx0XHRcdFx0Q0xvZyhcImN0eCByZXN1bWVcIik7XG5cdFx0XHRcdGVuZCgpO1xuXHRcdFx0fSk7XG5cdFx0fWVsc2V7XG5cdFx0XHRlbmQoKTtcblx0XHR9O1xuXHR9XG5cdC8q5pqC5YGc5b2V6Z+zKi9cblx0LHBhdXNlOmZ1bmN0aW9uKCl7XG5cdFx0dmFyIFRoaXM9dGhpcztcblx0XHRpZihUaGlzLnN0YXRlKXtcblx0XHRcdFRoaXMuc3RhdGU9Mjtcblx0XHRcdENMb2coXCJwYXVzZVwiKTtcblx0XHRcdGRlbGV0ZSBSZWNvcmRlci5TdHJlYW0uX2NhbGxbVGhpcy5pZF07XG5cdFx0fTtcblx0fVxuXHQvKuaBouWkjeW9lemfsyovXG5cdCxyZXN1bWU6ZnVuY3Rpb24oKXtcblx0XHR2YXIgVGhpcz10aGlzO1xuXHRcdGlmKFRoaXMuc3RhdGUpe1xuXHRcdFx0VGhpcy5zdGF0ZT0xO1xuXHRcdFx0Q0xvZyhcInJlc3VtZVwiKTtcblx0XHRcdFRoaXMuZW52UmVzdW1lKCk7XG5cdFx0XHRcblx0XHRcdFJlY29yZGVyLlN0cmVhbS5fY2FsbFtUaGlzLmlkXT1mdW5jdGlvbihwY20sc3VtKXtcblx0XHRcdFx0aWYoVGhpcy5zdGF0ZT09MSl7XG5cdFx0XHRcdFx0VGhpcy5lbnZJbihwY20sc3VtKTtcblx0XHRcdFx0fTtcblx0XHRcdH07XG5cdFx0fTtcblx0fVxuXHRcblx0XG5cdFxuXHRcblx0LF9zdG9wOmZ1bmN0aW9uKGtlZXBFbmdpbmUpe1xuXHRcdHZhciBUaGlzPXRoaXMsc2V0PVRoaXMuc2V0O1xuXHRcdGlmKCFUaGlzLmlzTW9jayl7XG5cdFx0XHRUaGlzLl9TKys7XG5cdFx0fTtcblx0XHRpZihUaGlzLnN0YXRlKXtcblx0XHRcdFRoaXMucGF1c2UoKTtcblx0XHRcdFRoaXMuc3RhdGU9MDtcblx0XHR9O1xuXHRcdGlmKCFrZWVwRW5naW5lICYmIFRoaXNbc2V0LnR5cGUrXCJfc3RvcFwiXSl7XG5cdFx0XHRUaGlzW3NldC50eXBlK1wiX3N0b3BcIl0oVGhpcy5lbmdpbmVDdHgpO1xuXHRcdFx0VGhpcy5lbmdpbmVDdHg9MDtcblx0XHR9O1xuXHR9XG5cdC8qXG5cdOe7k+adn+W9lemfs+W5tui/lOWbnuW9lemfs+aVsOaNrmJsb2Llr7nosaFcblx0XHRUcnVlKGJsb2IsZHVyYXRpb24pIGJsb2LvvJrlvZXpn7PmlbDmja5hdWRpby9tcDN8d2F25qC85byPXG5cdFx0XHRcdFx0XHRcdGR1cmF0aW9u77ya5b2V6Z+z5pe26ZW/77yM5Y2V5L2N5q+r56eSXG5cdFx0RmFsc2UobXNnKVxuXHRcdGF1dG9DbG9zZTpmYWxzZSDlj6/pgInvvIzmmK/lkKboh6rliqjosIPnlKhjbG9zZe+8jOm7mOiupOS4umZhbHNlXG5cdCovXG5cdCxzdG9wOmZ1bmN0aW9uKFRydWUsRmFsc2UsYXV0b0Nsb3NlKXtcblx0XHR2YXIgVGhpcz10aGlzLHNldD1UaGlzLnNldCx0MTtcblx0XHRDTG9nKFwiU3RvcCBcIisoVGhpcy5lbnZJbkxhc3Q/VGhpcy5lbnZJbkxhc3QtVGhpcy5lbnZJbkZpcnN0K1wibXMg6KGlXCIrVGhpcy5lbnZJbkZpeCtcIm1zXCI6XCItXCIpKTtcblx0XHRcblx0XHR2YXIgZW5kPWZ1bmN0aW9uKCl7XG5cdFx0XHRUaGlzLl9zdG9wKCk7Ly/lvbvlupXlhbPmjollbmdpbmVDdHhcblx0XHRcdGlmKGF1dG9DbG9zZSl7XG5cdFx0XHRcdFRoaXMuY2xvc2UoKTtcblx0XHRcdH07XG5cdFx0fTtcblx0XHR2YXIgZXJyPWZ1bmN0aW9uKG1zZyl7XG5cdFx0XHRDTG9nKFwi57uT5p2f5b2V6Z+z5aSx6LSl77yaXCIrbXNnLDEpO1xuXHRcdFx0RmFsc2UmJkZhbHNlKG1zZyk7XG5cdFx0XHRlbmQoKTtcblx0XHR9O1xuXHRcdHZhciBvaz1mdW5jdGlvbihibG9iLGR1cmF0aW9uKXtcblx0XHRcdENMb2coXCLnu5PmnZ/lvZXpn7Mg57yW56CBXCIrKERhdGUubm93KCktdDEpK1wibXMg6Z+z6aKRXCIrZHVyYXRpb24rXCJtcy9cIitibG9iLnNpemUrXCJiXCIpO1xuXHRcdFx0aWYoc2V0LnRha2VvZmZFbmNvZGVDaHVuayl7Ly/mjqXnrqHkuobovpPlh7rvvIzmraTml7ZibG9i6ZW/5bqm5Li6MFxuXHRcdFx0XHRDTG9nKFwi5ZCv55SodGFrZW9mZkVuY29kZUNodW5r5ZCOc3RvcOi/lOWbnueahGJsb2Lplb/luqbkuLow5LiN5o+Q5L6b6Z+z6aKR5pWw5o2uXCIsMyk7XG5cdFx0XHR9ZWxzZSBpZihibG9iLnNpemU8TWF0aC5tYXgoMTAwLGR1cmF0aW9uLzIpKXsvLzHnp5LlsI/kuo4wLjVr77yfXG5cdFx0XHRcdGVycihcIueUn+aIkOeahFwiK3NldC50eXBlK1wi5peg5pWIXCIpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9O1xuXHRcdFx0VHJ1ZSYmVHJ1ZShibG9iLGR1cmF0aW9uKTtcblx0XHRcdGVuZCgpO1xuXHRcdH07XG5cdFx0aWYoIVRoaXMuaXNNb2NrKXtcblx0XHRcdGlmKCFUaGlzLnN0YXRlKXtcblx0XHRcdFx0ZXJyKFwi5pyq5byA5aeL5b2V6Z+zXCIpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9O1xuXHRcdFx0VGhpcy5fc3RvcCh0cnVlKTtcblx0XHR9O1xuXHRcdHZhciBzaXplPVRoaXMucmVjU2l6ZTtcblx0XHRpZighc2l6ZSl7XG5cdFx0XHRlcnIoXCLmnKrph4fpm4bliLDlvZXpn7NcIik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fTtcblx0XHRpZighVGhpcy5idWZmZXJzWzBdKXtcblx0XHRcdGVycihcIumfs+mikeiiq+mHiuaUvlwiKTtcblx0XHRcdHJldHVybjtcblx0XHR9O1xuXHRcdGlmKCFUaGlzW3NldC50eXBlXSl7XG5cdFx0XHRlcnIoXCLmnKrliqDovb1cIitzZXQudHlwZStcIue8lueggeWZqFwiKTtcblx0XHRcdHJldHVybjtcblx0XHR9O1xuXHRcdFxuXHRcdC8v546v5aKD6YWN572u5qOA5p+l77yM5q2k5aSE5LuF6ZKI5a+5bW9ja+iwg+eUqO+8jOWboOS4um9wZW7lt7Lnu4/mo4Dmn6Xov4fkuoZcblx0XHRpZihUaGlzLmlzTW9jayl7XG5cdFx0XHR2YXIgY2hlY2tNc2c9VGhpcy5lbnZDaGVjayhUaGlzLm1vY2tFbnZJbmZvfHx7ZW52TmFtZTpcIm1vY2tcIixjYW5Qcm9jZXNzOmZhbHNlfSk7Ly/msqHmnInmj5Dkvpvnjq/looPkv6Hmga/nmoRtb2Nr5pe25rKh5pyJb25Qcm9jZXNz5Zue6LCDXG5cdFx0XHRpZihjaGVja01zZyl7XG5cdFx0XHRcdGVycihcIuW9lemfs+mUmeivr++8mlwiK2NoZWNrTXNnKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fTtcblx0XHR9O1xuXHRcdFxuXHRcdC8v5q2k57G75Z6L5pyJ6L655b2V6L656L2s56CBKFdvcmtlcinmlK/mjIFcblx0XHR2YXIgZW5naW5lQ3R4PVRoaXMuZW5naW5lQ3R4O1xuXHRcdGlmKFRoaXNbc2V0LnR5cGUrXCJfY29tcGxldGVcIl0mJmVuZ2luZUN0eCl7XG5cdFx0XHR2YXIgZHVyYXRpb249TWF0aC5yb3VuZChlbmdpbmVDdHgucGNtU2l6ZS9zZXQuc2FtcGxlUmF0ZSoxMDAwKTsvL+mHh+eUqOWQjueahOaVsOaNrumVv+W6puWSjGJ1ZmZlcnPnmoTplb/luqblj6/og73lvq7lsI/nmoTkuI3kuIDoh7TvvIzmmK/ph4fmoLfnjofov57nu63ovazmjaLnmoTnsr7luqbpl67pophcblx0XHRcdFxuXHRcdFx0dDE9RGF0ZS5ub3coKTtcblx0XHRcdFRoaXNbc2V0LnR5cGUrXCJfY29tcGxldGVcIl0oZW5naW5lQ3R4LGZ1bmN0aW9uKGJsb2Ipe1xuXHRcdFx0XHRvayhibG9iLGR1cmF0aW9uKTtcblx0XHRcdH0sZXJyKTtcblx0XHRcdHJldHVybjtcblx0XHR9O1xuXHRcdFxuXHRcdC8v5qCH5YeGVUnnur/nqIvovaznoIHvvIzosIPmlbTph4fmoLfnjodcblx0XHR0MT1EYXRlLm5vdygpO1xuXHRcdHZhciBjaHVuaz1SZWNvcmRlci5TYW1wbGVEYXRhKFRoaXMuYnVmZmVycyxUaGlzLnNyY1NhbXBsZVJhdGUsc2V0LnNhbXBsZVJhdGUpO1xuXHRcdFxuXHRcdHNldC5zYW1wbGVSYXRlPWNodW5rLnNhbXBsZVJhdGU7XG5cdFx0dmFyIHJlcz1jaHVuay5kYXRhO1xuXHRcdHZhciBkdXJhdGlvbj1NYXRoLnJvdW5kKHJlcy5sZW5ndGgvc2V0LnNhbXBsZVJhdGUqMTAwMCk7XG5cdFx0XG5cdFx0Q0xvZyhcIumHh+agt1wiK3NpemUrXCItPlwiK3Jlcy5sZW5ndGgrXCIg6IqxOlwiKyhEYXRlLm5vdygpLXQxKStcIm1zXCIpO1xuXHRcdFxuXHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcblx0XHRcdHQxPURhdGUubm93KCk7XG5cdFx0XHRUaGlzW3NldC50eXBlXShyZXMsZnVuY3Rpb24oYmxvYil7XG5cdFx0XHRcdG9rKGJsb2IsZHVyYXRpb24pO1xuXHRcdFx0fSxmdW5jdGlvbihtc2cpe1xuXHRcdFx0XHRlcnIobXNnKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9XG5cbn07XG5cbmlmKHdpbmRvdy5SZWNvcmRlcil7XG5cdHdpbmRvdy5SZWNvcmRlci5EZXN0cm95KCk7XG59O1xud2luZG93LlJlY29yZGVyPVJlY29yZGVyO1xuXG4vL2VuZCAqKioqY29weea6kOeggee7k+adnyoqKioqXG5SZWNvcmRlci5MTT1MTTtcblxuLy/mtYHph4/nu5/orqHnlKgx5YOP57Sg5Zu+54mH5Zyw5Z2A77yM6K6+572u5Li656m65bCG5LiN5Y+C5LiO57uf6K6hXG5SZWNvcmRlci5UcmFmZmljSW1nVXJsPVwiLy9pYS41MS5sYS9nbzE/aWQ9MjA0Njk5NzMmcHZGbGFnPTFcIjtcblJlY29yZGVyLlRyYWZmaWM9ZnVuY3Rpb24oKXtcblx0dmFyIGltZ1VybD1SZWNvcmRlci5UcmFmZmljSW1nVXJsO1xuXHRpZihpbWdVcmwpe1xuXHRcdHZhciBkYXRhPVJlY29yZGVyLlRyYWZmaWM7XG5cdFx0dmFyIGlkZj1sb2NhdGlvbi5ocmVmLnJlcGxhY2UoLyMuKi8sXCJcIik7XG5cdFx0XG5cdFx0aWYoaW1nVXJsLmluZGV4T2YoXCIvL1wiKT09MCl7XG5cdFx0XHQvL+e7mXVybOWKoOS4imh0dHDliY3nvIDvvIzlpoLmnpzmmK9maWxl5Y2P6K6u5LiL77yM5LiN5Yqg5YmN57yA5rKh5rOV55SoXG5cdFx0XHRpZigvXmh0dHBzOi9pLnRlc3QoaWRmKSl7XG5cdFx0XHRcdGltZ1VybD1cImh0dHBzOlwiK2ltZ1VybDtcblx0XHRcdH1lbHNle1xuXHRcdFx0XHRpbWdVcmw9XCJodHRwOlwiK2ltZ1VybDtcblx0XHRcdH07XG5cdFx0fTtcblx0XHRcblx0XHRpZighZGF0YVtpZGZdKXtcblx0XHRcdGRhdGFbaWRmXT0xO1xuXHRcdFx0XG5cdFx0XHR2YXIgaW1nPW5ldyBJbWFnZSgpO1xuXHRcdFx0aW1nLnNyYz1pbWdVcmw7XG5cdFx0XHRDTG9nKFwiVHJhZmZpYyBBbmFseXNpcyBJbWFnZTogUmVjb3JkZXIuVHJhZmZpY0ltZ1VybD1cIitSZWNvcmRlci5UcmFmZmljSW1nVXJsKTtcblx0XHR9O1xuXHR9O1xufTtcblxufSkpOyIsImV4cG9ydCBjbGFzcyBCeXRlQXJyYXkge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMubGlzdD1bXTtcclxuICAgICAgICB0aGlzLmJ5dGVPZmZzZXQ9MDtcclxuICAgICAgICB0aGlzLmxlbmd0aD0wO1xyXG4gICAgfVxyXG5cclxuICAgIHB1c2godW5pdDhBcnIpIHtcclxuICAgICAgICB0aGlzLmxpc3QucHVzaCh1bml0OEFycik7XHJcbiAgICAgICAgdGhpcy5sZW5ndGgrPXVuaXQ4QXJyLmxlbmd0aDtcclxuICAgIH1cclxuXHJcbiAgICByZWFkQnl0ZXMobGVuKSB7XHJcbiAgICAgICAgaWYobGVuPjApe1xyXG4gICAgICAgICAgICBsZXQgcmJ1Zj1uZXcgVWludDhBcnJheShsZW4pO1xyXG4gICAgICAgICAgICBsZXQgcmJ1Zl9pbmQ9MDtcclxuICAgICAgICAgICAgd2hpbGUocmJ1Zl9pbmQ8bGVuKXtcclxuICAgICAgICAgICAgICAgIGlmKHRoaXMubGlzdC5sZW5ndGg+MCl7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRtcGJ1Zj10aGlzLmxpc3Quc2hpZnQoKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdG1wbGVuPXRtcGJ1Zi5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGxhc3RfbGVuPWxlbi1yYnVmX2luZDtcclxuICAgICAgICAgICAgICAgICAgICBpZih0bXBsZW4+PWxhc3RfbGVuKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy/otrPlpKDkuoZcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRtcGJ1ZjIgPSB0bXBidWYuc3ViYXJyYXkoMCwgbGFzdF9sZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByYnVmLnNldCh0bXBidWYyLHJidWZfaW5kKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmJ1Zl9pbmQrPXRtcGJ1ZjIubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihsYXN0X2xlbjx0bXBsZW4pe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG5ld1VpbnQ4QXJyYXkgPSB0bXBidWYuc3ViYXJyYXkobGFzdF9sZW4sIHRtcGxlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmxpc3QudW5zaGlmdChuZXdVaW50OEFycmF5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmJ1Zi5zZXQodG1wYnVmLHJidWZfaW5kKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmJ1Zl9pbmQrPXRtcGxlbjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICByYnVmPXJidWYuc3ViYXJyYXkoMCwgcmJ1Zl9pbmQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMubGVuZ3RoLT1yYnVmLmxlbmd0aDtcclxuICAgICAgICAgICAgcmV0dXJuIHJidWY7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxufSIsIlxyXG5leHBvcnQgY2xhc3MgVXRpbCB7XHJcbiAgICBzdGF0aWMgaXNFbXB0eVN0cmluZyhzdHIpIHtcclxuICAgICAgICBpZiAoc3RyID09IHVuZGVmaW5lZCB8fCBzdHIgPT0gbnVsbCB8fCBzdHIgPT0gXCJcIikge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQge0dQbGF5ZXJFdmVudCwgR0Vycm9yVHlwZSwgR1BsYXliYWNrQ29udHJvbFN0YXR1c30gZnJvbSAnLi9wbGF5ZXIvZ3BsYXllci1ldmVudHMnO1xyXG5pbXBvcnQge0dUYWxrZXJFdmVudCwgR1RhbGtlckNvbm5lY3RTdGF0dXMsIEdUYWxrZXJDb25uZWN0RXJyb3JUeXBlfSBmcm9tICcuL3RhbGtlci9ndGFsa2VyLWV2ZW50cyc7XHJcbmltcG9ydCB7R0hlbHBlckV2ZW50fSBmcm9tIFwiLi9oZWxwZXIvZ2hlbHBlci1ldmVudHMuanNcIjtcclxuaW1wb3J0IHtHUGxheWVyfSBmcm9tICcuL3BsYXllci9ncGxheWVyLmpzJztcclxuaW1wb3J0IHsgSHR0cEZsdlBsYXllciB9IGZyb20gJy4vcGxheWVyL2h0dHBmbHYtcGxheWVyLmpzJztcclxuaW1wb3J0IHsgSHR0cEZsdlRhbGtlciB9IGZyb20gJy4vdGFsa2VyL2h0dHBmbHYtdGFsa2VyLmpzJztcclxuaW1wb3J0IHsgR0hlbHBlciB9IGZyb20gXCIuL2hlbHBlci9naGVscGVyLmpzXCI7XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVQbGF5ZXIodXJsLCBjb25maWcgPSBudWxsKSB7XHJcbiAgbGV0IHBsYXllciA9IG5ldyBIdHRwRmx2UGxheWVyKCk7XHJcbiAgcGxheWVyLmluaXQodXJsLCBjb25maWcpO1xyXG4gIHJldHVybiBwbGF5ZXI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZVRhbGtlcihkb3duVXJsLCB1cFVybCwgaW1laSwgY2hhbm5lbCwgY29uZmlnID0gbnVsbCkge1xyXG4gIGxldCB0YWxrZXIgPSBuZXcgSHR0cEZsdlRhbGtlcigpO1xyXG4gIGlmICghdGFsa2VyLmluaXQoZG93blVybCwgdXBVcmwsIGltZWksIGNoYW5uZWwsIGNvbmZpZykpIHtcclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuICByZXR1cm4gdGFsa2VyO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVIZWxwZXIodXJsKSB7XHJcbiAgbGV0IGhlbHBlciA9IG5ldyBHSGVscGVyKCk7XHJcbiAgaGVscGVyLmluaXQodXJsKTtcclxuICByZXR1cm4gaGVscGVyO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc0h0dHBGbHZTdXBwb3J0ZWQoKSB7XHJcbiAgcmV0dXJuIEh0dHBGbHZQbGF5ZXIuaXNTdXBwb3J0ZWQoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNUYWxrU3VwcG9ydGVkKCkge1xyXG4gIHJldHVybiBIdHRwRmx2VGFsa2VyLmlzU3VwcG9ydGVkKCk7XHJcbn1cclxuXHJcbmxldCBnbWVkaWFqcyA9IHt9O1xyXG5cclxuZ21lZGlhanMuY3JlYXRlUGxheWVyID0gY3JlYXRlUGxheWVyO1xyXG5nbWVkaWFqcy5pc0h0dHBGbHZTdXBwb3J0ZWQgPSBpc0h0dHBGbHZTdXBwb3J0ZWQ7XHJcbmdtZWRpYWpzLkh0dHBGbHZQbGF5ZXIgPSBIdHRwRmx2UGxheWVyO1xyXG5nbWVkaWFqcy5HUGxheWVyRXZlbnQgPSBHUGxheWVyRXZlbnQ7XHJcbmdtZWRpYWpzLkdFcnJvclR5cGUgPSBHRXJyb3JUeXBlO1xyXG5nbWVkaWFqcy5HUGxheWJhY2tDb250cm9sU3RhdHVzID0gR1BsYXliYWNrQ29udHJvbFN0YXR1cztcclxuXHJcbmdtZWRpYWpzLmNyZWF0ZVRhbGtlciA9IGNyZWF0ZVRhbGtlcjtcclxuZ21lZGlhanMuaXNUYWxrU3VwcG9ydGVkID0gaXNUYWxrU3VwcG9ydGVkO1xyXG5nbWVkaWFqcy5IdHRwRmx2VGFsa2VyID0gSHR0cEZsdlRhbGtlcjtcclxuZ21lZGlhanMuR1RhbGtlckV2ZW50ID0gR1RhbGtlckV2ZW50O1xyXG5nbWVkaWFqcy5HVGFsa2VyQ29ubmVjdFN0YXR1cyA9IEdUYWxrZXJDb25uZWN0U3RhdHVzO1xyXG5nbWVkaWFqcy5HVGFsa2VyQ29ubmVjdEVycm9yVHlwZSA9IEdUYWxrZXJDb25uZWN0RXJyb3JUeXBlO1xyXG5cclxuZ21lZGlhanMuY3JlYXRlSGVscGVyID0gY3JlYXRlSGVscGVyO1xyXG5nbWVkaWFqcy5HSGVscGVyID0gR0hlbHBlcjtcclxuZ21lZGlhanMuR0hlbHBlckV2ZW50ID0gR0hlbHBlckV2ZW50O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgZ21lZGlhanM7IiwiZXhwb3J0IGNvbnN0IEdIZWxwZXJFdmVudCA9IHtcclxuICAgIE1FRElBX1NUQVRFOiAnbWVkaWFfc3RhdGUnXHJcbn07IiwiaW1wb3J0IHtHSGVscGVyRXZlbnR9IGZyb20gXCIuL2doZWxwZXItZXZlbnRzLmpzXCJcclxuZXhwb3J0IGNsYXNzIEdIZWxwZXIge1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5jYWxsTWVkaWFTdGF0ZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jb25uZWN0ID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBpbml0KHVybCkge1xyXG4gICAgICAgIHRoaXMuY29ubmVjdCA9IG5ldyBXZWJTb2NrZXQodXJsKTtcclxuICAgICAgICB0aGlzLmNvbm5lY3Qub25vcGVuID0gdGhpcy5fb25Db25uZWN0T3Blbi5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuY29ubmVjdC5vbm1lc3NhZ2UgPSB0aGlzLl9vbkNvbm5lY3RNZXNzYWdlLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5jb25uZWN0Lm9uY2xvc2UgPSB0aGlzLl9vbkNvbm5lY3RDbG9zZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuY29ubmVjdC5vbmVycm9yID0gdGhpcy5fb25Db25uZWN0RXJyb3IuYmluZCh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBvbihldmVudCwgY2FsbCkge1xyXG4gICAgICAgIGlmIChldmVudCA9IEdIZWxwZXJFdmVudC5NRURJQV9TVEFURSkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxNZWRpYVN0YXRlID0gY2FsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb2ZmKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKGV2ZW50ID0gR0hlbHBlckV2ZW50Lk1FRElBX1NUQVRFKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbE1lZGlhU3RhdGUgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBkZXN0cm95KCkge1xyXG4gICAgICAgIHRoaXMuY2FsbE1lZGlhU3RhdGUgPSBudWxsO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5jb25uZWN0ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5jb25uZWN0LmNsb3NlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9vbkNvbm5lY3RPcGVuKCkge1xyXG4gICAgICAgIHRoaXMuX3NlbmRDb25zdW1lTWVkaWFTdGF0ZUNtZCgpO1xyXG4gICAgfVxyXG5cclxuICAgIF9vbkNvbm5lY3RNZXNzYWdlKGUpIHtcclxuICAgICAgICBsZXQgaGVhZCA9IEpTT04ucGFyc2UoZS5kYXRhKTtcclxuICAgICAgICBpZiAoaGVhZCA9PSBudWxsIHx8IGhlYWQudHlwZSA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChoZWFkLnR5cGUgPT0gXCJtZWRpYXN0YXRlXCIgJiYgdGhpcy5jYWxsTWVkaWFTdGF0ZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbE1lZGlhU3RhdGUoaGVhZC5kYXRhKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX29uQ29ubmVjdENsb3NlKCkge1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIF9vbkNvbm5lY3RFcnJvcigpIHtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBfc2VuZENvbnN1bWVNZWRpYVN0YXRlQ21kKCkge1xyXG4gICAgICAgIGxldCBoZWFkID0ge31cclxuICAgICAgICBoZWFkW1wiY21kXCJdID0gXCJjb25zdW1lXCI7XHJcbiAgICAgICAgaGVhZFtcInR5cGVcIl0gPSBcIm1lZGlhc3RhdGVcIjtcclxuICAgICAgICBoZWFkW1wiaWRcIl0gPSBcIlwiO1xyXG4gICAgICAgIGhlYWRbXCJkYXRhXCJdID0ge307XHJcblxyXG4gICAgICAgIGxldCBtc2cgPSBKU09OLnN0cmluZ2lmeShoZWFkKTtcclxuXHJcbiAgICAgICAgdGhpcy5jb25uZWN0LnNlbmQobXNnKTtcclxuICAgIH1cclxufSIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9nbWVkaWEuanMnKS5kZWZhdWx0OyIsImV4cG9ydCBjb25zdCBHUGxheWVyRXZlbnQgPSB7XHJcbiAgICBFUlJPUjogJ2Vycm9yJyxcclxuICAgIE1FRElBX1NPVVJDRV9FTkQ6ICdtZWRpYV9zb3VyY2VfZW5kJyxcclxuICAgIFRJTUVVUERBVEU6ICd0aW1ldXBkYXRlJyxcclxuICAgIFNUQVRJU1RJQ1NfSU5GTzogJ3N0YXRpc3RpY3NfaW5mbycsXHJcbiAgICBNRURJQV9TVEFURTogJ21lZGlhX3N0YXRlJyxcclxuICAgIFBMQVlCQUNLX0NPTlRST0xfRVZFTlQ6ICdwbGF5YmFja19jb250cm9sX2V2ZW50JyxcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBHRXJyb3JUeXBlID0ge1xyXG4gICAgTkVUV09SS19FUlJPUjogJ05ldHdvcmtFcnJvcicsXHJcbiAgICBNRURJQV9FUlJPUjogJ01lZGlhRXJyb3InLFxyXG4gICAgT1RIRVJfRVJST1I6ICdPdGhlckVycm9yJ1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IEdQbGF5YmFja0NvbnRyb2xTdGF0dXMgPSB7XHJcbiAgICBTZWVrU3RhcnQ6IDAsXHJcbiAgICBTZWVrRmFpbDogMSxcclxuICAgIFNlZWtTdWNjZXNzOiAyXHJcbn07XHJcbiIsImV4cG9ydCBjbGFzcyBHUGxheWVyIHtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcih0eXBlTmFtZSkge1xyXG4gICAgICAgIHRoaXMuX3R5cGUgPSB0eXBlTmFtZSB8fCAndW5kZWZpbmVkJztcclxuICAgIH1cclxuXHJcbiAgICBpbml0KHVybCwgY29uZmlnKSB7XHJcbiAgICB9XHJcblxyXG4gICAgb24oZXZlbnQsIGNhbGwpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgb2ZmKGV2ZW50KSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGF0dGFjaE1lZGlhRWxlbWVudChtZWRpYUVsZW1lbnQpIHsgIFxyXG4gICAgfVxyXG5cclxuICAgIGxvYWQoKSB7XHJcbiAgICB9XHJcblxyXG4gICAgcGxheSgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgY2FwdHVyZSgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcGF1c2UoKSB7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgcmVzdW1lKCkge1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHNlZWtUb05ld2VzdFRpbWUgKCkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBzZWVrKHRpbWUpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgZGVzdHJveSgpIHtcclxuXHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IHtHUGxheWVyRXZlbnQsIEdFcnJvclR5cGUsIEdQbGF5YmFja0NvbnRyb2xTdGF0dXN9IGZyb20gXCIuL2dwbGF5ZXItZXZlbnRzLmpzXCJcclxuaW1wb3J0IHtHUGxheWVyfSBmcm9tIFwiLi9ncGxheWVyLmpzXCJcclxuaW1wb3J0IGZsdmpzIGZyb20gXCJmbHYtZzcuanNcIjtcclxuXHJcbmltcG9ydCB7R0hlbHBlckV2ZW50fSBmcm9tIFwiLi4vaGVscGVyL2doZWxwZXItZXZlbnRzLmpzXCI7XHJcbmltcG9ydCB7IEdIZWxwZXIgfSBmcm9tIFwiLi4vaGVscGVyL2doZWxwZXIuanNcIjtcclxuXHJcbmNvbnN0IFBsYXliYWNrS2V5ID0gXCJnNy1mbHYtdmlkZW8tcGxheWJhY2tcIjtcclxuXHJcbmNvbnN0IFBsYXliYWNrQ29udHJvbCA9IHtcclxuICAgIE5vbmU6MCxcclxuICAgIEFjdGl2ZToxLFxyXG4gICAgUGFzc2l2ZToyXHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBIdHRwRmx2UGxheWVyIGV4dGVuZHMgR1BsYXllciB7XHJcblxyXG4gICAgY29uc3RydWN0b3IgKCkge1xyXG4gICAgICAgIHN1cGVyKCdodHRwZmx2LXBsYXllcicpO1xyXG4gICAgICAgIHRoaXMuVEFHID0gJ0h0dHBGbHZQbGF5ZXInO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMucGxheWVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaXNMaXZlID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdGhpcy5oZWxwVXJsID0gbnVsbDtcclxuICAgICAgICB0aGlzLmhlbHBlciA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMucGxheWJhY2tQbGFuID0gMTtcclxuICAgICAgICB0aGlzLnBsYXliYWNrQ29udHJvbCA9IFBsYXliYWNrQ29udHJvbC5Ob25lO1xyXG5cclxuICAgICAgICB0aGlzLnN0cmVhbUVuZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubmVlZFNlZWsgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnNlZWtpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnNlZWtUaW1lID0gMDtcclxuICAgICAgICB0aGlzLm5ld1BsYXlTdGFydFRpbWUgPSAwO1xyXG4gICAgICAgIHRoaXMubGFzdFNlbmRTZWVrVHMgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLmNhbGxiYWNrVGltZVVwZGF0ZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jYWxsYmFja1N0YXRpc3RpY3MgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tFcnJvciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jYWxsYmFja01lZGlhU291cmNlRW5kID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNhbGxiYWNrTWVkaWFTdGF0ZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50ID0gbnVsbDtcclxuXHJcbiAgICAgICAgdGhpcy5jaGVja2VyU2VlayA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMuZSA9IHtcclxuICAgICAgICAgICAgb25UaW1lVXBkYXRlIDogdGhpcy5fb25FbGVtZW50VGltZS5iaW5kKHRoaXMpXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgaXNTdXBwb3J0ZWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHdpbmRvdy5NZWRpYVNvdXJjZSAmJlxyXG4gICAgICAgICAgICB3aW5kb3cuTWVkaWFTb3VyY2UuaXNUeXBlU3VwcG9ydGVkKCd2aWRlby9tcDQ7IGNvZGVjcz1cImF2YzEuNDJFMDFFLG1wNGEuNDAuMlwiJyk7XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdCAodXJsLCBjb25maWcpIHtcclxuICAgICAgICB0aGlzLl9jaGVja0NvbmZpZyhjb25maWcpO1xyXG4gICAgICAgIHRoaXMuaXNMaXZlID0gdGhpcy5fY2hlY2tJZkxpdmUodXJsKTsgIFxyXG4gICAgICAgIHRoaXMucGxheWJhY2tDb250cm9sID0gdGhpcy5fY2hlY2tQbGF5YmFja0NvbnRyb2wodXJsKTsgIFxyXG5cclxuICAgICAgICB0aGlzLnBsYXllciA9IGZsdmpzLmNyZWF0ZVBsYXllcih7aXNMaXZlOnRoaXMuaXNMaXZlLCB0eXBlOidmbHYnLHVybDp1cmx9LCB7XHJcbiAgICAgICAgICAgIGxhenlMb2FkOiBmYWxzZSxcclxuICAgICAgICAgICAgZW5hYmxlU3Rhc2hCdWZmZXI6IGZhbHNlLFxyXG4gICAgICAgICAgICBkZWZlckxvYWRBZnRlclNvdXJjZU9wZW46dHJ1ZVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLnBsYXllci5vbihmbHZqcy5FdmVudHMuU1RBVElTVElDU19JTkZPLCB0aGlzLl9vblN0YXRpc3RpY3NJbmZvLmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMucGxheWVyLm9uKGZsdmpzLkV2ZW50cy5FUlJPUiwgdGhpcy5fb25FcnJvci5iaW5kKHRoaXMpKTtcclxuICAgICAgICB0aGlzLnBsYXllci5zZXRNZWRpYVNvdXJjZUVuZENhbGxiYWNrKHRoaXMuX29uTWVkaWFTb3VyY2VFbmQuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXIuc2V0U3RyZWFtVGltZUNhbGxiYWNrKHRoaXMuX29uU3RyZWFtVGltZS5iaW5kKHRoaXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBvbihldmVudCwgY2FsbCkge1xyXG4gICAgICAgIGlmIChldmVudCA9PT0gR1BsYXllckV2ZW50LlRJTUVVUERBVEUpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja1RpbWVVcGRhdGUgPSBjYWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChldmVudCA9PT0gR1BsYXllckV2ZW50LlNUQVRJU1RJQ1NfSU5GTykge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrU3RhdGlzdGljcyA9IGNhbGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50ID09PSBHUGxheWVyRXZlbnQuRVJST1IpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Vycm9yID0gY2FsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZXZlbnQgPT09IEdQbGF5ZXJFdmVudC5NRURJQV9TT1VSQ0VfRU5EKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tNZWRpYVNvdXJjZUVuZCA9IGNhbGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50ID09PSBHUGxheWVyRXZlbnQuTUVESUFfU1RBVEUpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja01lZGlhU3RhdGUgPSBjYWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChldmVudCA9PT0gR1BsYXllckV2ZW50LlBMQVlCQUNLX0NPTlRST0xfRVZFTlQpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50ID0gY2FsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb2ZmKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKGV2ZW50ID09PSBHUGxheWVyRXZlbnQuVElNRVVQREFURSkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrVGltZVVwZGF0ZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50ID09PSBHUGxheWVyRXZlbnQuU1RBVElTVElDU19JTkZPKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tTdGF0aXN0aWNzID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZXZlbnQgPT09IEdQbGF5ZXJFdmVudC5FUlJPUikge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrRXJyb3IgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChldmVudCA9PT0gR1BsYXllckV2ZW50Lk1FRElBX1NPVVJDRV9FTkQpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja01lZGlhU291cmNlRW5kID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZXZlbnQgPT09IEdQbGF5ZXJFdmVudC5NRURJQV9TVEFURSkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrTWVkaWFTdGF0ZSA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50ID09PSBHUGxheWVyRXZlbnQuUExBWUJBQ0tfQ09OVFJPTF9FVkVOVCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrUGxheWJhY2tDb250cm9sRXZlbnQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhdHRhY2hNZWRpYUVsZW1lbnQoZWwpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbDtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRpbWV1cGRhdGVcIiwgdGhpcy5lLm9uVGltZVVwZGF0ZSk7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXIuYXR0YWNoTWVkaWFFbGVtZW50KGVsKTtcclxuICAgIH1cclxuXHJcbiAgICBsb2FkKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmhlbHBVcmwgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmhlbHBlciA9IG5ldyBHSGVscGVyKCk7XHJcbiAgICAgICAgICAgIHRoaXMuaGVscGVyLmluaXQodGhpcy5oZWxwVXJsKTtcclxuICAgICAgICAgICAgdGhpcy5oZWxwZXIub24oR0hlbHBlckV2ZW50Lk1FRElBX1NUQVRFLHRoaXMuX29uTWVkaWFTdGF0ZS5iaW5kKHRoaXMpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucGxheWVyLmxvYWQoKTtcclxuICAgIH1cclxuXHJcbiAgICBwbGF5KCkge1xyXG4gICAgICAgIHRoaXMucGxheWVyLnBsYXkoKTtcclxuICAgIH1cclxuXHJcbiAgICBjYXB0dXJlKCkge1xyXG4gICAgICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gICAgICAgIGNhbnZhcy53aWR0aCA9IHRoaXMuZWxlbWVudC52aWRlb1dpZHRoO1xyXG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSB0aGlzLmVsZW1lbnQudmlkZW9IZWlnaHQ7XHJcbiAgICAgICAgY2FudmFzLmdldENvbnRleHQoJzJkJykuZHJhd0ltYWdlKHRoaXMuZWxlbWVudCwgMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcclxuICAgICAgICBsZXQgZGF0YXVybCA9IGNhbnZhcy50b0RhdGFVUkwoKTtcclxuICAgICAgICByZXR1cm4gZGF0YXVybDtcclxuICAgIH1cclxuXHJcbiAgICBwYXVzZSgpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucGF1c2UoKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzdW1lKCkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5wbGF5KCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHNlZWtUb05ld2VzdFRpbWUgKCkge1xyXG4gICAgICAgIGxldCBidWZmZXJlZCA9IHRoaXMuZWxlbWVudC5idWZmZXJlZDtcclxuICAgICAgICBpZiAoYnVmZmVyZWQubGVuZ3RoID4gMCkgeyBcclxuICAgICAgICAgICAgbGV0IGZyb20gPSBidWZmZXJlZC5zdGFydChidWZmZXJlZC5sZW5ndGggLTEpO1xyXG4gICAgICAgICAgICBsZXQgdG8gPSBidWZmZXJlZC5lbmQoYnVmZmVyZWQubGVuZ3RoIC0xKTtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmN1cnJlbnRUaW1lID0gdG87XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNlZWsodGltZSkge1xyXG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnNlZWtpbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBpZiAodGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50KEdQbGF5YmFja0NvbnRyb2xTdGF0dXMuU2Vla1N0YXJ0LCBcclxuICAgICAgICAgICAgICAgIFwi5byA5aeL5YiH5o2i5pKt5pS+5pe26Ze0XCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLl9zZWVrQnlDYWNoZWQodGltZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5wbGF5YmFja0NvbnRyb2wgPT0gUGxheWJhY2tDb250cm9sLkFjdGl2ZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9zZWVrQnlBY3RpdmUodGltZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9zZWVrQnlQYXNzaXZlKHRpbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBkZXN0cm95KCkge1xyXG4gICAgICAgIGlmICh0aGlzLmhlbHBlciAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGVscGVyLmRlc3Ryb3koKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLnBsYXllciAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWVyLnBhdXNlKCk7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWVyLnVubG9hZCgpO1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllci5kZXRhY2hNZWRpYUVsZW1lbnQoKTtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXIuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllciA9IG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5lbGVtZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0aW1ldXBkYXRlXCIsIHRoaXMuZS5vblRpbWVVcGRhdGUpO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfY2hlY2tDb25maWcoY29uZmlnKSB7XHJcbiAgICAgICAgaWYgKGNvbmZpZyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjb25maWcucGxheWJhY2tQbGFuICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5wbGF5YmFja1BsYW4gPSBjb25maWcucGxheWJhY2tQbGFuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNvbmZpZy5oZWxwVXJsICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5oZWxwVXJsID0gY29uZmlnLmhlbHBVcmw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja0lmTGl2ZSh1cmwpIHtcclxuICAgICAgICBpZiAodXJsLmluZGV4T2YoUGxheWJhY2tLZXkpICE9IC0xKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgX2NoZWNrUGxheWJhY2tDb250cm9sKHVybCkge1xyXG4gICAgICAgIGxldCBhcnIgPSB1cmwuc3BsaXQoJyZzdHJlYW09Jyk7XHJcbiAgICAgICAgaWYgKGFyci5sZW5ndGggPCAyIHx8IGFyclsxXS5sZW5ndGggPCAzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQbGF5YmFja0NvbnRyb2wuTm9uZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHN0cmVhbU5hbWUgPSBhcnJbMV07XHJcbiAgICAgICAgbGV0IGRldmljZVR5cGUgPSBzdHJlYW1OYW1lLnN1YnN0cmluZygwLDMpO1xyXG4gICAgICAgIGlmIChkZXZpY2VUeXBlID09ICcxMzEnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQbGF5YmFja0NvbnRyb2wuUGFzc2l2ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFBsYXliYWNrQ29udHJvbC5BY3RpdmU7XHJcbiAgICB9XHJcblxyXG4gICAgX3NlZWtCeUNhY2hlZCh0aW1lKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnN0cmVhbUVuZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2Vla2luZyA9IHRydWU7XHJcblxyXG4gICAgICAgIGxldCBiQ2FjaGVkID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IGJ1ZmZlcmVkID0gdGhpcy5lbGVtZW50LmJ1ZmZlcmVkO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYnVmZmVyZWQubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbGV0IGZyb20gPSBidWZmZXJlZC5zdGFydChpKTtcclxuICAgICAgICAgICAgbGV0IHRvID0gYnVmZmVyZWQuZW5kKGkpO1xyXG4gICAgICAgICAgICBpZiAodGltZSA+IGZyb20gJiYgdGltZSA8IHRvKSB7XHJcbiAgICAgICAgICAgICAgICBiQ2FjaGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGJDYWNoZWQgJiYgdGltZSA+IHRoaXMuZWxlbWVudC5jdXJyZW50VGltZSkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuY3VycmVudFRpbWUgPSB0aW1lO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tQbGF5YmFja0NvbnRyb2xFdmVudChHUGxheWJhY2tDb250cm9sU3RhdHVzLlNlZWtTdWNjZXNzLFxyXG4gICAgICAgICAgICAgICAgICAgIFwi5YiH5o2i5pKt5pS+5pe26Ze05oiQ5YqfXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tQbGF5YmFja0NvbnRyb2xFdmVudChHUGxheWJhY2tDb250cm9sU3RhdHVzLlNlZWtGYWlsLFxyXG4gICAgICAgICAgICAgICAgICAgIFwi57yT5Yay5rWB5bey57uT5p2f77yM5peg5rOV5YiH5o2i5Yiw5pyq57yT5Yay5Yy65Z+fXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnNlZWtpbmcgPSBmYWxzZTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgX3NlZWtCeUFjdGl2ZSh0aW1lKSB7XHJcbiAgICAgICAgdGhpcy5zZWVraW5nID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdGhpcy5sYXN0U2VuZFNlZWtUcyA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG5cclxuICAgICAgICB0aGlzLmNoZWNrZXJTZWVrID0gc2V0VGltZW91dCgoKT0+e1xyXG4gICAgICAgICAgICB0aGlzLm5lZWRTZWVrID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuc2Vla2luZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tQbGF5YmFja0NvbnRyb2xFdmVudChHUGxheWJhY2tDb250cm9sU3RhdHVzLlNlZWtGYWlsLFxyXG4gICAgICAgICAgICAgICAgICAgIFwi5YiH5o2i5pKt5pS+5pe26Ze05aSx6LSl77yM6K+36YeN5paw5bCd6K+VXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwxNSoxMDAwKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZWVrVGltZSA9IHRpbWU7XHJcbiAgICAgICAgdGhpcy5uZWVkU2VlayA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgX3NlZWtCeVBhc3NpdmUodGltZSkge1xyXG4gICAgICAgIHRoaXMuc2Vla2luZyA9IHRydWU7XHJcblxyXG4gICAgICAgIHRoaXMuc2Vla1RpbWUgPSB0aW1lO1xyXG4gICAgICAgIC8v6I635Y+W5b2T5YmNdmlkZW/moIfnrb7op6PnoIHnvJPlrZhcclxuICAgICAgICBsZXQgYnVmZmVyZWQgPSB0aGlzLmVsZW1lbnQuYnVmZmVyZWQ7XHJcbiAgICAgICAgaWYgKGJ1ZmZlcmVkLmxlbmd0aCA+IDApIHsgXHJcbiAgICAgICAgICAgIC8v55Sx6K6+5aSH56uv5o6n5Yi25Zue5pS+55qEYnVmZmVyZWTlj6rkvJrkuqfnlJ/kuIDmrrVcclxuICAgICAgICAgICAgbGV0IGZyb20gPSBidWZmZXJlZC5zdGFydCgwKTtcclxuICAgICAgICAgICAgbGV0IHRvID0gYnVmZmVyZWQuZW5kKDApO1xyXG4gICAgICAgICAgICB0aGlzLm5ld1BsYXlTdGFydFRpbWUgPSB0bztcclxuXHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jdXJyZW50VGltZSA9IHRoaXMubmV3UGxheVN0YXJ0VGltZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHNldFRpbWVvdXQoKCk9PntcclxuICAgICAgICAgICAgdGhpcy5zZWVraW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNhbGxiYWNrUGxheWJhY2tDb250cm9sRXZlbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50KEdQbGF5YmFja0NvbnRyb2xTdGF0dXMuU2Vla1N1Y2Nlc3MsXHJcbiAgICAgICAgICAgICAgICAgICAgXCLliIfmjaLmkq3mlL7ml7bpl7TmiJDlip9cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LDEwMDApO1xyXG4gICAgfVxyXG5cclxuICAgIF9vbk1lZGlhU3RhdGUoaW5mbykge1xyXG4gICAgICAgIGlmICh0aGlzLmNhbGxiYWNrTWVkaWFTdGF0ZSAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tNZWRpYVN0YXRlKGluZm8pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfb25TdGF0aXN0aWNzSW5mbyhkYXRhKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tTdGF0aXN0aWNzICE9IG51bGwpIHtcclxuICAgICAgICAgICAgbGV0IGluZm8gPSB7fTtcclxuICAgICAgICAgICAgaW5mby5zcGVlZCA9IGRhdGEuc3BlZWQ7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tTdGF0aXN0aWNzKGluZm8pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfb25FcnJvcih0eXBlLCBkZXRhaWwsIGVyck9iaikge1xyXG4gICAgICAgIGlmICh0aGlzLmNhbGxiYWNrRXJyb3IgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBsZXQgZ3R5cGUgPSB0eXBlO1xyXG4gICAgICAgICAgICBsZXQgZ3N1YnR5cGUgPSBkZXRhaWw7XHJcbiAgICAgICAgICAgIGxldCBpbmZvID0gdHlwZTtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Vycm9yKHR5cGUsIGdzdWJ0eXBlLCBpbmZvKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX29uTWVkaWFTb3VyY2VFbmQoaW5mbykge1xyXG4gICAgICAgIHRoaXMuc3RyZWFtRW5kID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy5jYWxsYmFja01lZGlhU291cmNlRW5kICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja01lZGlhU291cmNlRW5kKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9vbkVsZW1lbnRUaW1lKGV2ZW50KSB7XHJcbiAgICAgICAgLy/lm57mlL7mlrnmoYgxXHJcbiAgICAgICAgaWYgKHRoaXMucGxheWJhY2tQbGFuID09IDEpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tUaW1lVXBkYXRlICE9IG51bGwgJiYgdGhpcy5lbGVtZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tUaW1lVXBkYXRlKHRoaXMuZWxlbWVudC5jdXJyZW50VGltZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy/lm57mlL7mlrnmoYgyXHJcbiAgICAgICAgaWYgKHRoaXMucGxheWJhY2tDb250cm9sID09PSBQbGF5YmFja0NvbnRyb2wuQWN0aXZlKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5zZWVraW5nICYmIHRoaXMuY2FsbGJhY2tUaW1lVXBkYXRlICE9IG51bGwgJiYgdGhpcy5lbGVtZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tUaW1lVXBkYXRlKHRoaXMuZWxlbWVudC5jdXJyZW50VGltZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5wbGF5YmFja0NvbnRyb2wgPT09IFBsYXliYWNrQ29udHJvbC5QYXNzaXZlKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5zZWVraW5nICYmIHRoaXMuY2FsbGJhY2tUaW1lVXBkYXRlICE9IG51bGwgJiYgdGhpcy5lbGVtZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGxldCBjdXJQbGF5VGltZSA9IHRoaXMuc2Vla1RpbWUgKyAodGhpcy5lbGVtZW50LmN1cnJlbnRUaW1lIC0gdGhpcy5uZXdQbGF5U3RhcnRUaW1lKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tUaW1lVXBkYXRlKGN1clBsYXlUaW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfb25TdHJlYW1UaW1lKHRpbWUpIHtcclxuICAgICAgICBpZiAodGhpcy5uZWVkU2Vlaykge1xyXG4gICAgICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5zZWVrVGltZSoxMDAwIC0gdGltZSkgPj0gMTAwMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5jaGVja2VyU2VlayAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5jaGVja2VyU2Vlayk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZXJTZWVrID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5uZWVkU2VlayA9IGZhbHNlO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpPT57XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlZWtpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jdXJyZW50VGltZSA9IHRpbWUvMTAwMDtcclxuICAgICAgICAgICAgICAgIGxldCBvZmYgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIHRoaXMubGFzdFNlbmRTZWVrVHM7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIuWIh+aNouiAl+aXtjogXCIgKyBvZmYpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tQbGF5YmFja0NvbnRyb2xFdmVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50KEdQbGF5YmFja0NvbnRyb2xTdGF0dXMuU2Vla1N1Y2Nlc3MsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwi5YiH5o2i5pKt5pS+5pe26Ze05oiQ5YqfXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LDEwMDApO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4iLCJleHBvcnQgY29uc3QgR1RhbGtlckV2ZW50ID0ge1xyXG4gICAgQ09OTkVDVF9TVEFUVVM6ICdjb25uZWN0X3N0YXR1cydcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBHVGFsa2VyQ29ubmVjdFN0YXR1cyA9IHtcclxuICAgIENvbm5lY3RTdWNjZXNzOiAnQ29ubmVjdFN1Y2Nlc3MnLFxyXG4gICAgQ29ubmVjdEVycm9yOiAnQ29ubmVjdEVycm9yJ1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IEdUYWxrZXJDb25uZWN0RXJyb3JUeXBlID0ge1xyXG4gICAgRGV2aWNlTm90UmVzcG9uZGluZzogJ0RldmljZU5vdFJlc3BvbmRpbmcnLFxyXG4gICAgRGV2aWNlU3RvcGVkUmVzcG9uZGluZzogJ0RldmljZVN0b3BlZFJlc3BvbmRpbmcnLFxyXG4gICAgRG93bkxpbmtGYWlsOiAnRG93bkxpbmtGYWlsJyxcclxuICAgIFVwTGlua0ZhaWw6ICdVcExpbmtGYWlsJyxcclxuICAgIFdhaXRPcGVuTWljcm9waG9uZVRpbWVvdXQ6ICdXYWl0T3Blbk1pY3JvcGhvbmVUaW1lb3V0JyxcclxuICAgIE5vdEFsbG93T3Blbk1pY3JvcGhvbmU6ICdOb3RBbGxvd09wZW5NaWNyb3Bob25lJ1xyXG59OyIsImV4cG9ydCBjbGFzcyBHVGFsa2VyIHtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcih0eXBlTmFtZSkge1xyXG4gICAgICAgIHRoaXMuX3R5cGUgPSB0eXBlTmFtZSB8fCAndW5kZWZpbmVkJztcclxuICAgIH1cclxuXHJcbiAgICBpbml0KGRvd25VcmwsIHVwVXJsLCBpbWVpLCBjaGFubmVsLCBjb25maWcpIHtcclxuICAgIH1cclxuXHJcbiAgICBvbihldmVudCwgY2FsbCkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBvZmYoZXZlbnQpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgYXR0YWNoTWVkaWFFbGVtZW50KGVsZW1lbnQpIHsgIFxyXG4gICAgfVxyXG5cclxuICAgIGxvYWQoKSB7XHJcbiAgICB9XHJcblxyXG4gICAgZGVzdHJveSgpIHtcclxuXHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IHtHVGFsa2VyRXZlbnQsIEdUYWxrZXJDb25uZWN0U3RhdHVzLCBHVGFsa2VyQ29ubmVjdEVycm9yVHlwZX0gZnJvbSBcIi4vZ3RhbGtlci1ldmVudHMuanNcIlxyXG5pbXBvcnQge0dUYWxrZXJ9IGZyb20gXCIuL2d0YWxrZXIuanNcIlxyXG5pbXBvcnQge0J5dGVBcnJheX0gZnJvbSBcIi4uL2NvbW1vbi9ieXRlYXJyYXkuanNcIlxyXG5pbXBvcnQge1V0aWx9IGZyb20gXCIuLi9jb21tb24vdXRpbC5qc1wiXHJcblxyXG5pbXBvcnQgZmx2anMgZnJvbSBcImZsdi1nNy5qc1wiO1xyXG5cclxuaW1wb3J0IFJlY29yZGVyIGZyb20gJ3JlY29yZGVyLWNvcmUnXHJcbmltcG9ydCAncmVjb3JkZXItY29yZS9zcmMvZW5naW5lL21wMydcclxuaW1wb3J0ICdyZWNvcmRlci1jb3JlL3NyYy9lbmdpbmUvbXAzLWVuZ2luZSdcclxuXHJcbmNvbnN0IEF1ZGlvQnVmTGVuID0gNjQwO1xyXG5jb25zdCBEZWJ1Z0ZsYWcgPSBmYWxzZTtcclxuXHJcbmV4cG9ydCBjbGFzcyBIdHRwRmx2VGFsa2VyIGV4dGVuZHMgR1RhbGtlciB7XHJcblxyXG4gICAgY29uc3RydWN0b3IgKCkge1xyXG4gICAgICAgIHN1cGVyKCdodHRwZmx2LXRhbGtlcicpO1xyXG4gICAgICAgIHRoaXMuVEFHID0gJ0h0dHBGbHZUYWxrZXInO1xyXG5cclxuICAgICAgICB0aGlzLmRvd25VcmwgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudXBVcmwgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaW1laSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jaGFubmVsID0gbnVsbDtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnBsYXllciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5yZWNvcmRlciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5zZW5kZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzID0gbnVsbDtcclxuXHJcbiAgICAgICAgdGhpcy5ieXRlQXJyYXkgPSBuZXcgQnl0ZUFycmF5KCk7XHJcblxyXG4gICAgICAgIHRoaXMudGltZXJDaGVjayA9IG51bGw7XHJcbiAgICAgICAgdGhpcy50aW1lclNlbmQgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLmhhc1JlY2VpdmVTZXJ2ZXJEYXRhID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5oYXNTZW5kQ2xpZW50RGF0YSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaGFzV2FpdE9wZW5NaWNyb3Bob25lVGltZW91dCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaGFzRGVzdG9yeSA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBpc1N1cHBvcnRlZCgpIHtcclxuICAgICAgICByZXR1cm4gdHlwZW9mIFdlYlNvY2tldCAhPSAndW5kZWZpbmVkJyAmJiBSZWNvcmRlci5TdXBwb3J0KCkgJiYgd2luZG93Lk1lZGlhU291cmNlICYmXHJcbiAgICAgICAgICAgIHdpbmRvdy5NZWRpYVNvdXJjZS5pc1R5cGVTdXBwb3J0ZWQoJ3ZpZGVvL21wNDsgY29kZWNzPVwiYXZjMS40MkUwMUUsbXA0YS40MC4yXCInKTtcclxuICAgIH1cclxuXHJcbiAgICBpbml0KGRvd25VcmwsIHVwVXJsLCBpbWVpLCBjaGFubmVsLCBjb25maWcpIHtcclxuICAgICAgICB0aGlzLmRvd25VcmwgPSBkb3duVXJsO1xyXG4gICAgICAgIHRoaXMudXBVcmwgPSB1cFVybDtcclxuICAgICAgICB0aGlzLmltZWkgPSBpbWVpO1xyXG4gICAgICAgIHRoaXMuY2hhbm5lbCA9IGNoYW5uZWw7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9jaGVja0lucHV0UGFyYW0oKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9zdGFydFBsYXllcihkb3duVXJsKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBvbihldmVudCwgY2FsbCkge1xyXG4gICAgICAgIGlmIChldmVudCA9PT0gR1RhbGtlckV2ZW50LkNPTk5FQ1RfU1RBVFVTKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzID0gY2FsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb2ZmKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKGV2ZW50ID09PSBHVGFsa2VyRXZlbnQuQ09OTkVDVF9TVEFUVVMpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhdHRhY2hNZWRpYUVsZW1lbnQoZWxlbWVudCkgeyAgXHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuXHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkZWRkYXRhXCIsIHRoaXMuX29uUGxheWVyTG9hZGVkRGF0YS5iaW5kKHRoaXMpLCB7b25jZTogdHJ1ZX0pO1xyXG4gICAgICAgIHRoaXMucGxheWVyLm9uKGZsdmpzLkV2ZW50cy5FUlJPUiwgdGhpcy5fb25QbGF5ZXJFcnJvci5iaW5kKHRoaXMpKTtcclxuICAgICAgICB0aGlzLnBsYXllci5zZXRNZWRpYVNvdXJjZUVuZENhbGxiYWNrKHRoaXMuX29uUGxheWVyTWVkaWFTb3VyY2VFbmQuYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIHRoaXMucGxheWVyLmF0dGFjaE1lZGlhRWxlbWVudChlbGVtZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBsb2FkKCkge1xyXG4gICAgICAgIHRoaXMucGxheWVyLmxvYWQoKTtcclxuICAgICAgICB0aGlzLl9zdGFydFNlbmRlcih0aGlzLnVwVXJsKTtcclxuICAgIH1cclxuXHJcbiAgICBkZXN0cm95KCkge1xyXG4gICAgICAgIHRoaXMuaGFzRGVzdG9yeSA9IHRydWU7XHJcblxyXG4gICAgICAgIHRoaXMuX2Rlc3Ryb3lQbGF5ZXIoKTtcclxuICAgICAgICB0aGlzLl9kZXN0cm95U2VuZGVyKCk7XHJcbiAgICAgICAgdGhpcy5fZGVzdHJveVJlY29yZGVyKCk7XHJcbiAgICAgICAgdGhpcy5fZGVzdHJveVNlbmRQcm9jKCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2NoZWNrSW5wdXRQYXJhbSgpIHtcclxuICAgICAgICBpZiAoVXRpbC5pc0VtcHR5U3RyaW5nKHRoaXMuZG93blVybCkgfHwgVXRpbC5pc0VtcHR5U3RyaW5nKHRoaXMudXBVcmwpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKFV0aWwuaXNFbXB0eVN0cmluZyh0aGlzLmltZWkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuY2hhbm5lbCA8IDAgfHwgdGhpcy5jaGFubmVsID4gMjU1KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgX3N0YXJ0UGxheWVyKHVybCkge1xyXG4gICAgICAgIHRoaXMuX2Rlc3Ryb3lQbGF5ZXIoKTtcclxuXHJcbiAgICAgICAgdGhpcy5wbGF5ZXIgPSBmbHZqcy5jcmVhdGVQbGF5ZXIoe2lzTGl2ZTp0cnVlLCB0eXBlOidmbHYnLHVybDp1cmx9LCB7XHJcbiAgICAgICAgICAgIGxhenlMb2FkOiBmYWxzZSxcclxuICAgICAgICAgICAgZW5hYmxlU3Rhc2hCdWZmZXI6IGZhbHNlLFxyXG4gICAgICAgICAgICBkZWZlckxvYWRBZnRlclNvdXJjZU9wZW46dHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIF9vblBsYXllckxvYWRlZERhdGEoKSB7XHJcbiAgICAgICAgaWYgKERlYnVnRmxhZykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInBsYXllciBsb2FkZWREYXRhXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5oYXNSZWNlaXZlU2VydmVyRGF0YSA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMuaGFzU2VuZENsaWVudERhdGEgJiYgdGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrQ29ubmVjdFN0YXR1cyhHVGFsa2VyQ29ubmVjdFN0YXR1cy5Db25uZWN0U3VjY2VzcywgXCJcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9vblBsYXllckVycm9yKHR5cGUsIGRldGFpbCwgZXJyT2JqKSB7XHJcbiAgICAgICAgaWYgKERlYnVnRmxhZykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInBsYXllciBlcnJvclwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNhbGxiYWNrQ29ubmVjdFN0YXR1cyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmhhc1JlY2VpdmVTZXJ2ZXJEYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzKEdUYWxrZXJDb25uZWN0U3RhdHVzLkNvbm5lY3RFcnJvciwgXHJcbiAgICAgICAgICAgICAgICBHVGFsa2VyQ29ubmVjdEVycm9yVHlwZS5Eb3duTGlua0ZhaWwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMoR1RhbGtlckNvbm5lY3RTdGF0dXMuQ29ubmVjdEVycm9yLCBcclxuICAgICAgICAgICAgICAgIEdUYWxrZXJDb25uZWN0RXJyb3JUeXBlLkRldmljZU5vdFJlc3BvbmRpbmcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfb25QbGF5ZXJNZWRpYVNvdXJjZUVuZChpbmZvKSB7XHJcbiAgICAgICAgaWYgKERlYnVnRmxhZykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInBsYXllciBzb3VyY2UgZW5kXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMoR1RhbGtlckNvbm5lY3RTdGF0dXMuQ29ubmVjdEVycm9yLCBcclxuICAgICAgICAgICAgICAgIEdUYWxrZXJDb25uZWN0RXJyb3JUeXBlLkRldmljZVN0b3BlZFJlc3BvbmRpbmcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfZGVzdHJveVBsYXllcigpIHtcclxuICAgICAgICBpZiAodGhpcy5wbGF5ZXIgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllci5wYXVzZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllci51bmxvYWQoKTtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXIuZGV0YWNoTWVkaWFFbGVtZW50KCk7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWVyLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXIgPSBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9zdGFydFNlbmRlcih1cmwpIHtcclxuICAgICAgICB0aGlzLnNlbmRlciA9IG5ldyBXZWJTb2NrZXQodXJsKTtcclxuICAgICAgICB0aGlzLnNlbmRlci5vbm9wZW4gPSB0aGlzLl9vblNlbmRlck9wZW4uYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLnNlbmRlci5vbm1lc3NhZ2UgPSB0aGlzLl9vblNlbmRlck1zZy5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuc2VuZGVyLm9uY2xvc2UgPSB0aGlzLl9vblNlbmRlckNsb3NlLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5zZW5kZXIub25lcnJvciA9IHRoaXMuX29uU2VuZGVyRXJyb3IuYmluZCh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBfb25TZW5kZXJPcGVuKCkge1xyXG4gICAgICAgIGlmIChEZWJ1Z0ZsYWcpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ3ZWJzb2NrZXQgb3BlblwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5fc3RhcnRSZWNvcmRlcigpO1xyXG4gICAgfVxyXG5cclxuICAgIF9vblNlbmRlck1zZyhlKSB7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgX29uU2VuZGVyQ2xvc2UoZSkge1xyXG4gICAgICAgIGlmIChEZWJ1Z0ZsYWcpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ3ZWJzb2NrZXQgY2xvc2VcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrQ29ubmVjdFN0YXR1cyhHVGFsa2VyQ29ubmVjdFN0YXR1cy5Db25uZWN0RXJyb3IsIFxyXG4gICAgICAgICAgICAgICAgR1RhbGtlckNvbm5lY3RFcnJvclR5cGUuVXBMaW5rRmFpbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9vblNlbmRlckVycm9yKGUpIHtcclxuICAgICAgICBpZiAoRGVidWdGbGFnKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwid2Vic29ja2V0IGVycm9yXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfZGVzdHJveVNlbmRlcigpIHtcclxuICAgICAgICB0aGlzLnNlbmRlci5jbG9zZSgpO1xyXG4gICAgICAgIHRoaXMuc2VuZGVyID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBfc3RhcnRSZWNvcmRlcigpIHtcclxuICAgICAgICBpZiAodGhpcy5yZWNvcmRlcikge1xyXG4gICAgICAgICAgICB0aGlzLnJlY29yZGVyLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnJlY29yZGVyID0gUmVjb3JkZXIoe1xyXG4gICAgICAgICAgICB0eXBlOlwibXAzXCIsXHJcbiAgICAgICAgICAgIHNhbXBsZVJhdGU6ODAwMCxcclxuICAgICAgICAgICAgYml0UmF0ZToxNixcclxuICAgICAgICAgICAgb25Qcm9jZXNzOnRoaXMuX29uUmVjZWl2ZU1pY3JvcGhvbmVEYXRhLmJpbmQodGhpcylcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnRpbWVyQ2hlY2sgPSBzZXRUaW1lb3V0KHRoaXMuX3RpbWVvdXRDaGVja0lmQWxsb3dPcGVuTWljcm9waG9uZS5iaW5kKHRoaXMpLDEwMDAwKTtcclxuICAgICAgICB0aGlzLnJlY29yZGVyLm9wZW4odGhpcy5fb25BbGxvd09wZW5NaWNyb3Bob25lLmJpbmQodGhpcyksXHJcbiAgICAgICAgICAgIHRoaXMuX29uTm90QWxsb3dPcGVuTWljcm9waG9uZS5iaW5kKHRoaXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBfdGltZW91dENoZWNrSWZBbGxvd09wZW5NaWNyb3Bob25lKCkge1xyXG4gICAgICAgIGlmIChEZWJ1Z0ZsYWcpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1c2VyIFdhaXRPcGVuTWljcm9waG9uZSBUaW1lb3V0XCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5oYXNXYWl0T3Blbk1pY3JvcGhvbmVUaW1lb3V0ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMoR1RhbGtlckNvbm5lY3RTdGF0dXMuQ29ubmVjdEVycm9yLCBcclxuICAgICAgICAgICAgICAgIEdUYWxrZXJDb25uZWN0RXJyb3JUeXBlLldhaXRPcGVuTWljcm9waG9uZVRpbWVvdXQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfb25BbGxvd09wZW5NaWNyb3Bob25lKCkge1xyXG4gICAgICAgIGlmIChEZWJ1Z0ZsYWcpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1c2VyIEFsbG93T3Blbk1pY3JvcGhvbmVcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5oYXNXYWl0T3Blbk1pY3JvcGhvbmVUaW1lb3V0KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyQ2hlY2spO1xyXG5cclxuICAgICAgICB0aGlzLmhhc1NlbmRDbGllbnREYXRhID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy5oYXNSZWNlaXZlU2VydmVyRGF0YSAmJiB0aGlzLmNhbGxiYWNrQ29ubmVjdFN0YXR1cyAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzKEdUYWxrZXJDb25uZWN0U3RhdHVzLkNvbm5lY3RTdWNjZXNzLCBcIlwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucmVjb3JkZXIuc3RhcnQoKTtcclxuICAgICAgICB0aGlzLl9zZW5kUHJvYygpO1xyXG4gICAgfVxyXG5cclxuICAgIF9vbk5vdEFsbG93T3Blbk1pY3JvcGhvbmUobXNnLCBpc1VzZXJOb3RBbGxvdykge1xyXG4gICAgICAgIGlmIChEZWJ1Z0ZsYWcpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1c2VyIE5vdEFsbG93T3Blbk1pY3JvcGhvbmVcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lckNoZWNrKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMoR1RhbGtlckNvbm5lY3RTdGF0dXMuQ29ubmVjdEVycm9yLCBcclxuICAgICAgICAgICAgICAgIEdUYWxrZXJDb25uZWN0RXJyb3JUeXBlLk5vdEFsbG93T3Blbk1pY3JvcGhvbmUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfb25SZWNlaXZlTWljcm9waG9uZURhdGEoYnVmZmVycywgcG93ZXJMZXZlbCwgYnVmZmVyRHVyYXRpb24sIGJ1ZmZlclNhbXBsZVJhdGUpIHtcclxuICAgICAgICBsZXQgYXJyYXlCdWYgPSBidWZmZXJzW2J1ZmZlcnMubGVuZ3RoIC0gMV0uYnVmZmVyOyAvL1VpbnQxNkFycmF5IFRvIEFycmF5QnVmZmVyXHJcbiAgICAgICAgbGV0IHU4YnVmID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWYpOyAvL0FycmF5QnVmZmVyIFRvIFVpbnQ4QXJyYXlcclxuICAgICAgICB0aGlzLmJ5dGVBcnJheS5wdXNoKHU4YnVmKTtcclxuICAgIH1cclxuXHJcbiAgICBfZGVzdHJveVJlY29yZGVyKCkge1xyXG4gICAgICAgIHRoaXMucmVjb3JkZXIuY2xvc2UoKTtcclxuICAgICAgICB0aGlzLnJlY29yZGVyID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBfc2VuZFByb2MoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaGFzRGVzdG9yeSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5ieXRlQXJyYXkubGVuZ3RoIDwgQXVkaW9CdWZMZW4pIHtcclxuICAgICAgICAgICAgdGhpcy50aW1lclNlbmQgPSBzZXRUaW1lb3V0KHRoaXMuX3NlbmRQcm9jLmJpbmQodGhpcyksIDUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbGV0IGF1ZGlvQnVmID0gdGhpcy5ieXRlQXJyYXkucmVhZEJ5dGVzKEF1ZGlvQnVmTGVuKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBwYWNrZXIgPSBuZXcgQnl0ZUFycmF5KCk7XHJcbiAgICAgICAgICAgIHBhY2tlci5wdXNoKG5ldyBVaW50OEFycmF5KFsweDMxLDB4MzIsMHg2MywweDY0XSkpO1xyXG4gICAgICAgICAgICBsZXQgYXJySW1laUNoYXIgPSB0aGlzLmltZWkuc3BsaXQoJycpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFyckltZWlDaGFyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBwYWNrZXIucHVzaChuZXcgVWludDhBcnJheShbYXJySW1laUNoYXJbaV0uY2hhckNvZGVBdCgpXSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhY2tlci5wdXNoKG5ldyBVaW50OEFycmF5KFtwYXJzZUludCh0aGlzLmNoYW5uZWwpXSkpO1xyXG4gICAgICAgICAgICBwYWNrZXIucHVzaChuZXcgVWludDhBcnJheShbTWF0aC5mbG9vcihBdWRpb0J1Zkxlbi8yNTYpXSkpO1xyXG4gICAgICAgICAgICBwYWNrZXIucHVzaChuZXcgVWludDhBcnJheShbQXVkaW9CdWZMZW4lMjU2XSkpO1xyXG4gICAgICAgICAgICBwYWNrZXIucHVzaChhdWRpb0J1Zik7XHJcblxyXG4gICAgICAgICAgICBsZXQgdG90YWxMZW4gPSA0ICsgYXJySW1laUNoYXIubGVuZ3RoICsgMyArIEF1ZGlvQnVmTGVuO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zZW5kZXIgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZW5kZXIuc2VuZChwYWNrZXIucmVhZEJ5dGVzKHRvdGFsTGVuKSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3NlbmRQcm9jKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9kZXN0cm95U2VuZFByb2MoKSB7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJTZW5kKTtcclxuICAgIH1cclxufSJdfQ=="}