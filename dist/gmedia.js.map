{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/flv-g7.js/dist/flv.js","node_modules/recorder-core/src/engine/mp3-engine.js","node_modules/recorder-core/src/engine/mp3.js","node_modules/recorder-core/src/recorder-core.js","src/common/bytearray.js","src/common/util.js","src/gmedia.js","src/helper/ghelper-events.js","src/helper/ghelper.js","src/index.js","src/player/gplayer-events.js","src/player/gplayer.js","src/player/httpflv-player.js","src/talker/gtalker-events.js","src/talker/gtalker.js","src/talker/httpflv-talker.js"],"names":[],"mappings":"AAAA;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACr4XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC51bA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ICl3Ba,S,WAAA,S;AAET,yBAAc;AAAA;;AACV,aAAK,IAAL,GAAU,EAAV;AACA,aAAK,UAAL,GAAgB,CAAhB;AACA,aAAK,MAAL,GAAY,CAAZ;AACH;;;;6BAEI,Q,EAAU;AACX,iBAAK,IAAL,CAAU,IAAV,CAAe,QAAf;AACA,iBAAK,MAAL,IAAa,SAAS,MAAtB;AACH;;;kCAES,G,EAAK;AACX,gBAAG,MAAI,CAAP,EAAS;AACL,oBAAI,OAAK,IAAI,UAAJ,CAAe,GAAf,CAAT;AACA,oBAAI,WAAS,CAAb;AACA,uBAAM,WAAS,GAAf,EAAmB;AACf,wBAAG,KAAK,IAAL,CAAU,MAAV,GAAiB,CAApB,EAAsB;AAClB,4BAAI,SAAO,KAAK,IAAL,CAAU,KAAV,EAAX;AACA,4BAAI,SAAO,OAAO,MAAlB;AACA,4BAAI,WAAS,MAAI,QAAjB;AACA,4BAAG,UAAQ,QAAX,EAAoB;AAChB;AACA,gCAAI,UAAU,OAAO,QAAP,CAAgB,CAAhB,EAAmB,QAAnB,CAAd;AACA,iCAAK,GAAL,CAAS,OAAT,EAAiB,QAAjB;AACA,wCAAU,QAAQ,MAAlB;AACA,gCAAG,WAAS,MAAZ,EAAmB;AACf,oCAAI,gBAAgB,OAAO,QAAP,CAAgB,QAAhB,EAA0B,MAA1B,CAApB;AACA,qCAAK,IAAL,CAAU,OAAV,CAAkB,aAAlB;AACH;AACD;AACH,yBAVD,MAUK;AACD,iCAAK,GAAL,CAAS,MAAT,EAAgB,QAAhB;AACA,wCAAU,MAAV;AACH;AACJ,qBAlBD,MAkBK;AACD,+BAAK,KAAK,QAAL,CAAc,CAAd,EAAiB,QAAjB,CAAL;AACA;AACH;AACJ;AACD,qBAAK,MAAL,IAAa,KAAK,MAAlB;AACA,uBAAO,IAAP;AACH;AACD,mBAAO,IAAP;AACH;;;;;;;;;;;;;;;;;IC5CQ,I,WAAA,I;;;;;;;sCACY,G,EAAK;AACtB,gBAAI,OAAO,SAAP,IAAoB,OAAO,IAA3B,IAAmC,OAAO,EAA9C,EAAkD;AAC9C,uBAAO,IAAP;AACH,aAFD,MAGK;AACD,uBAAO,KAAP;AACH;AACJ;;;;;;;;;;;;;ACTL;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AAEA,SAAS,YAAT,CAAsB,GAAtB,EAA0C;AAAA,MAAf,MAAe,uEAAN,IAAM;;AACxC,MAAI,SAAS,IAAI,4BAAJ,EAAb;AACA,SAAO,IAAP,CAAY,GAAZ,EAAiB,MAAjB;AACA,SAAO,MAAP;AACD;;AAED,SAAS,YAAT,CAAsB,OAAtB,EAA+B,KAA/B,EAAsC,IAAtC,EAA4C,OAA5C,EAAoE;AAAA,MAAf,MAAe,uEAAN,IAAM;;AAClE,MAAI,SAAS,IAAI,4BAAJ,EAAb;AACA,MAAI,CAAC,OAAO,IAAP,CAAY,OAAZ,EAAqB,KAArB,EAA4B,IAA5B,EAAkC,OAAlC,EAA2C,MAA3C,CAAL,EAAyD;AACvD,WAAO,IAAP;AACD;AACD,SAAO,MAAP;AACD;;AAED,SAAS,YAAT,CAAsB,GAAtB,EAA2B;AACzB,MAAI,SAAS,IAAI,gBAAJ,EAAb;AACA,SAAO,IAAP,CAAY,GAAZ;AACA,SAAO,MAAP;AACD;;AAED,SAAS,kBAAT,GAA8B;AAC5B,SAAO,6BAAc,WAAd,EAAP;AACD;;AAED,SAAS,eAAT,GAA2B;AACzB,SAAO,6BAAc,WAAd,EAAP;AACD;;AAED,IAAI,WAAW,EAAf;;AAEA,SAAS,YAAT,GAAwB,YAAxB;AACA,SAAS,kBAAT,GAA8B,kBAA9B;AACA,SAAS,aAAT,GAAyB,4BAAzB;AACA,SAAS,YAAT,GAAwB,2BAAxB;AACA,SAAS,UAAT,GAAsB,yBAAtB;AACA,SAAS,sBAAT,GAAkC,qCAAlC;;AAEA,SAAS,YAAT,GAAwB,YAAxB;AACA,SAAS,eAAT,GAA2B,eAA3B;AACA,SAAS,aAAT,GAAyB,4BAAzB;AACA,SAAS,YAAT,GAAwB,2BAAxB;AACA,SAAS,oBAAT,GAAgC,mCAAhC;AACA,SAAS,uBAAT,GAAmC,sCAAnC;;AAEA,SAAS,YAAT,GAAwB,YAAxB;AACA,SAAS,OAAT,GAAmB,gBAAnB;AACA,SAAS,YAAT,GAAwB,2BAAxB;;kBAEe,Q;;;;;;;;ACxDR,IAAM,sCAAe;AACxB,iBAAa;AADW,CAArB;;;;;;;;;;;;ACAP;;;;IACa,O,WAAA,O;AACT,uBAAc;AAAA;;AACV,aAAK,cAAL,GAAsB,IAAtB;AACA,aAAK,OAAL,GAAe,IAAf;AACH;;;;6BAEI,G,EAAK;AACN,iBAAK,OAAL,GAAe,IAAI,SAAJ,CAAc,GAAd,CAAf;AACA,iBAAK,OAAL,CAAa,MAAb,GAAsB,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAAtB;AACA,iBAAK,OAAL,CAAa,SAAb,GAAyB,KAAK,iBAAL,CAAuB,IAAvB,CAA4B,IAA5B,CAAzB;AACA,iBAAK,OAAL,CAAa,OAAb,GAAuB,KAAK,eAAL,CAAqB,IAArB,CAA0B,IAA1B,CAAvB;AACA,iBAAK,OAAL,CAAa,OAAb,GAAuB,KAAK,eAAL,CAAqB,IAArB,CAA0B,IAA1B,CAAvB;AACH;;;2BAEE,K,EAAO,I,EAAM;AACZ,gBAAI,QAAQ,4BAAa,WAAzB,EAAsC;AAClC,qBAAK,cAAL,GAAsB,IAAtB;AACH;AACJ;;;4BAEG,K,EAAO;AACP,gBAAI,QAAQ,4BAAa,WAAzB,EAAsC;AAClC,qBAAK,cAAL,GAAsB,IAAtB;AACH;AACJ;;;kCAES;AACN,iBAAK,cAAL,GAAsB,IAAtB;;AAEA,gBAAI,KAAK,OAAL,IAAgB,IAApB,EAA0B;AACtB,qBAAK,OAAL,CAAa,KAAb;AACA,qBAAK,OAAL,GAAe,IAAf;AACH;AACJ;;;yCAEgB;AACb,iBAAK,yBAAL;AACH;;;0CAEiB,C,EAAG;AACjB,gBAAI,OAAO,KAAK,KAAL,CAAW,EAAE,IAAb,CAAX;AACA,gBAAI,QAAQ,IAAR,IAAgB,KAAK,IAAL,IAAa,IAAjC,EAAuC;AACnC;AACH;;AAED,gBAAI,KAAK,IAAL,IAAa,YAAb,IAA6B,KAAK,cAAL,IAAuB,IAAxD,EAA8D;AAC1D,qBAAK,cAAL,CAAoB,KAAK,IAAzB;AACH;AACJ;;;0CAEiB,CAEjB;;;0CAEiB,CAEjB;;;oDAE2B;AACxB,gBAAI,OAAO,EAAX;AACA,iBAAK,KAAL,IAAc,SAAd;AACA,iBAAK,MAAL,IAAe,YAAf;AACA,iBAAK,IAAL,IAAa,EAAb;AACA,iBAAK,MAAL,IAAe,EAAf;;AAEA,gBAAI,MAAM,KAAK,SAAL,CAAe,IAAf,CAAV;;AAEA,iBAAK,OAAL,CAAa,IAAb,CAAkB,GAAlB;AACH;;;;;;;;;ACrEL,OAAO,OAAP,GAAiB,QAAQ,aAAR,EAAuB,OAAxC;;;;;;;;ACAO,IAAM,sCAAe;AACxB,WAAO,OADiB;AAExB,sBAAkB,kBAFM;AAGxB,gBAAY,YAHY;AAIxB,qBAAiB,iBAJO;AAKxB,iBAAa,aALW;AAMxB,4BAAwB;AANA,CAArB;;AASA,IAAM,kCAAa;AACtB,mBAAe,cADO;AAEtB,iBAAa,YAFS;AAGtB,iBAAa;AAHS,CAAnB;;AAMA,IAAM,0DAAyB;AAClC,eAAW,CADuB;AAElC,cAAU,CAFwB;AAGlC,iBAAa;AAHqB,CAA/B;;;;;;;;;;;;;ICfM,O,WAAA,O;AAET,qBAAY,QAAZ,EAAsB;AAAA;;AAClB,aAAK,KAAL,GAAa,YAAY,WAAzB;AACH;;;;6BAEI,G,EAAK,M,EAAQ,CACjB;;;2BAEE,K,EAAO,I,EAAM,CAEf;;;4BAEG,K,EAAO,CAEV;;;2CAEkB,Y,EAAc,CAChC;;;+BAEM,CACN;;;+BAEM,CAEN;;;kCAES,CAET;;;gCAEO,CAEP;;;iCAEQ,CAER;;;2CAEmB,CAEnB;;;6BAEI,I,EAAM,CAEV;;;qCAEY,K,EAAO,CAEnB;;;kCAES,CAET;;;;;;;;;;;;;;;;ACrDL;;AACA;;AACA;;;;AAEA;;AACA;;;;;;;;;;AAEA,IAAM,cAAc,uBAApB;;AAEA,IAAM,kBAAkB;AACpB,UAAK,CADe;AAEpB,YAAO,CAFa;AAGpB,aAAQ;AAHY,CAAxB;;IAMa,a,WAAA,a;;;AAET,6BAAe;AAAA;;AAAA,kIACL,gBADK;;AAEX,cAAK,GAAL,GAAW,eAAX;;AAEA,cAAK,MAAL,GAAc,IAAd;AACA,cAAK,OAAL,GAAe,IAAf;AACA,cAAK,MAAL,GAAc,IAAd;;AAEA,cAAK,OAAL,GAAe,IAAf;AACA,cAAK,MAAL,GAAc,IAAd;;AAEA,cAAK,YAAL,GAAoB,CAApB;AACA,cAAK,eAAL,GAAuB,gBAAgB,IAAvC;;AAEA,cAAK,SAAL,GAAiB,KAAjB;AACA,cAAK,QAAL,GAAgB,KAAhB;AACA,cAAK,OAAL,GAAe,KAAf;AACA,cAAK,QAAL,GAAgB,CAAhB;AACA,cAAK,gBAAL,GAAwB,CAAxB;AACA,cAAK,cAAL,GAAsB,CAAtB;;AAEA,cAAK,kBAAL,GAA0B,IAA1B;AACA,cAAK,kBAAL,GAA0B,IAA1B;AACA,cAAK,aAAL,GAAqB,IAArB;AACA,cAAK,sBAAL,GAA8B,IAA9B;AACA,cAAK,kBAAL,GAA0B,IAA1B;AACA,cAAK,4BAAL,GAAoC,IAApC;;AAEA,cAAK,WAAL,GAAmB,IAAnB;;AAEA,cAAK,CAAL,GAAS;AACL,0BAAe,MAAK,cAAL,CAAoB,IAApB;AADV,SAAT;AA9BW;AAiCd;;;;6BAOK,G,EAAK,M,EAAQ;AACf,iBAAK,YAAL,CAAkB,MAAlB;AACA,iBAAK,MAAL,GAAc,KAAK,YAAL,CAAkB,GAAlB,CAAd;AACA,iBAAK,eAAL,GAAuB,KAAK,qBAAL,CAA2B,GAA3B,CAAvB;;AAEA,iBAAK,MAAL,GAAc,eAAM,YAAN,CAAmB,EAAC,QAAO,KAAK,MAAb,EAAqB,MAAK,KAA1B,EAAgC,KAAI,GAApC,EAAnB,EAA6D;AACvE,0BAAU,KAD6D;AAEvE,mCAAmB,KAFoD;AAGvE,0CAAyB;AAH8C,aAA7D,CAAd;;AAMA,iBAAK,MAAL,CAAY,EAAZ,CAAe,eAAM,MAAN,CAAa,eAA5B,EAA6C,KAAK,iBAAL,CAAuB,IAAvB,CAA4B,IAA5B,CAA7C;AACA,iBAAK,MAAL,CAAY,EAAZ,CAAe,eAAM,MAAN,CAAa,KAA5B,EAAmC,KAAK,QAAL,CAAc,IAAd,CAAmB,IAAnB,CAAnC;AACA,iBAAK,MAAL,CAAY,yBAAZ,CAAsC,KAAK,iBAAL,CAAuB,IAAvB,CAA4B,IAA5B,CAAtC;AACA,iBAAK,MAAL,CAAY,qBAAZ,CAAkC,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAAlC;AACH;;;2BAEE,K,EAAO,I,EAAM;AACZ,gBAAI,UAAU,4BAAa,UAA3B,EAAuC;AACnC,qBAAK,kBAAL,GAA0B,IAA1B;AACH,aAFD,MAGK,IAAI,UAAU,4BAAa,eAA3B,EAA4C;AAC7C,qBAAK,kBAAL,GAA0B,IAA1B;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,KAA3B,EAAkC;AACnC,qBAAK,aAAL,GAAqB,IAArB;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,gBAA3B,EAA6C;AAC9C,qBAAK,sBAAL,GAA8B,IAA9B;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,WAA3B,EAAwC;AACzC,qBAAK,kBAAL,GAA0B,IAA1B;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,sBAA3B,EAAmD;AACpD,qBAAK,4BAAL,GAAoC,IAApC;AACH;AACJ;;;4BAEG,K,EAAO;AACP,gBAAI,UAAU,4BAAa,UAA3B,EAAuC;AACnC,qBAAK,kBAAL,GAA0B,IAA1B;AACH,aAFD,MAGK,IAAI,UAAU,4BAAa,eAA3B,EAA4C;AAC7C,qBAAK,kBAAL,GAA0B,IAA1B;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,KAA3B,EAAkC;AACnC,qBAAK,aAAL,GAAqB,IAArB;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,gBAA3B,EAA6C;AAC9C,qBAAK,sBAAL,GAA8B,IAA9B;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,WAA3B,EAAwC;AACzC,qBAAK,kBAAL,GAA0B,IAA1B;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,sBAA3B,EAAmD;AACpD,qBAAK,4BAAL,GAAoC,IAApC;AACH;AACJ;;;2CAEkB,E,EAAI;AACnB,iBAAK,OAAL,GAAe,EAAf;AACA,iBAAK,OAAL,CAAa,gBAAb,CAA8B,YAA9B,EAA4C,KAAK,CAAL,CAAO,YAAnD;AACA,iBAAK,MAAL,CAAY,kBAAZ,CAA+B,EAA/B;AACH;;;+BAEM;AACH,gBAAI,KAAK,OAAL,IAAgB,IAApB,EAA0B;AACtB,qBAAK,MAAL,GAAc,IAAI,gBAAJ,EAAd;AACA,qBAAK,MAAL,CAAY,IAAZ,CAAiB,KAAK,OAAtB;AACA,qBAAK,MAAL,CAAY,EAAZ,CAAe,4BAAa,WAA5B,EAAwC,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAAxC;AACH;;AAED,iBAAK,MAAL,CAAY,IAAZ;AACH;;;+BAEM;AACH,iBAAK,MAAL,CAAY,IAAZ;AACH;;;kCAES;AACN,gBAAI,SAAS,SAAS,aAAT,CAAuB,QAAvB,CAAb;AACA,mBAAO,KAAP,GAAe,KAAK,OAAL,CAAa,UAA5B;AACA,mBAAO,MAAP,GAAgB,KAAK,OAAL,CAAa,WAA7B;AACA,mBAAO,UAAP,CAAkB,IAAlB,EAAwB,SAAxB,CAAkC,KAAK,OAAvC,EAAgD,CAAhD,EAAmD,CAAnD,EAAsD,OAAO,KAA7D,EAAoE,OAAO,MAA3E;AACA,gBAAI,UAAU,OAAO,SAAP,EAAd;AACA,mBAAO,OAAP;AACH;;;gCAEO;AACJ,iBAAK,OAAL,CAAa,KAAb;AACA,mBAAO,KAAP;AACH;;;iCAEQ;AACL,iBAAK,OAAL,CAAa,IAAb;AACA,mBAAO,KAAP;AACH;;;2CAEmB;AAChB,gBAAI,WAAW,KAAK,OAAL,CAAa,QAA5B;AACA,gBAAI,SAAS,MAAT,GAAkB,CAAtB,EAAyB;AACrB,oBAAI,OAAO,SAAS,KAAT,CAAe,SAAS,MAAT,GAAiB,CAAhC,CAAX;AACA,oBAAI,KAAK,SAAS,GAAT,CAAa,SAAS,MAAT,GAAiB,CAA9B,CAAT;AACA,qBAAK,OAAL,CAAa,WAAb,GAA2B,EAA3B;AACH;AACJ;;;6BAEI,I,EAAM;AACP,gBAAI,KAAK,OAAL,IAAgB,IAApB,EAA0B;AACtB,uBAAO,KAAP;AACH;AACD,gBAAI,KAAK,OAAT,EAAkB;AACd,uBAAO,KAAP;AACH;;AAED,gBAAI,KAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,qBAAK,4BAAL,CAAkC,sCAAuB,SAAzD,EACI,UADJ;AAEH;;AAED,gBAAI,CAAC,KAAK,aAAL,CAAmB,IAAnB,CAAL,EAA+B;AAC3B,uBAAO,KAAP;AACH;AACD,gBAAI,KAAK,eAAL,IAAwB,gBAAgB,MAA5C,EAAoD;AAChD,qBAAK,aAAL,CAAmB,IAAnB;AACH,aAFD,MAGK;AACD,qBAAK,cAAL,CAAoB,IAApB;AACH;AACD,mBAAO,IAAP;AACH;;;qCAEY,K,EAAO;AAChB,gBAAI,KAAK,OAAL,IAAgB,IAApB,EAA0B;AACtB;AACH;AACD,iBAAK,OAAL,CAAa,YAAb,GAA4B,KAA5B;AACH;;;kCAES;AACN,gBAAI,KAAK,MAAL,IAAe,IAAnB,EAAyB;AACrB,qBAAK,MAAL,CAAY,OAAZ;AACH;;AAED,gBAAI,KAAK,MAAL,IAAe,IAAnB,EAAyB;AACrB,qBAAK,MAAL,CAAY,KAAZ;AACA,qBAAK,MAAL,CAAY,MAAZ;AACA,qBAAK,MAAL,CAAY,kBAAZ;AACA,qBAAK,MAAL,CAAY,OAAZ;AACA,qBAAK,MAAL,GAAc,IAAd;AACH;;AAED,gBAAI,KAAK,OAAL,IAAgB,IAApB,EAA0B;AACtB,qBAAK,OAAL,CAAa,mBAAb,CAAiC,YAAjC,EAA+C,KAAK,CAAL,CAAO,YAAtD;AACA,qBAAK,OAAL,GAAe,IAAf;AACH;AACJ;;;qCAEY,M,EAAQ;AACjB,gBAAI,UAAU,IAAd,EAAoB;AAChB;AACH;;AAED,gBAAI,OAAO,YAAP,IAAuB,IAA3B,EAAiC;AAC7B,qBAAK,YAAL,GAAoB,OAAO,YAA3B;AACH;;AAED,gBAAI,OAAO,OAAP,IAAkB,IAAtB,EAA4B;AACxB,qBAAK,OAAL,GAAe,OAAO,OAAtB;AACH;AACJ;;;qCAEY,G,EAAK;AACd,gBAAI,IAAI,OAAJ,CAAY,WAAZ,KAA4B,CAAC,CAAjC,EAAoC;AAChC,uBAAO,KAAP;AACH;AACD,mBAAO,IAAP;AACH;;;8CAEqB,G,EAAK;AACvB,gBAAI,MAAM,IAAI,KAAJ,CAAU,UAAV,CAAV;AACA,gBAAI,IAAI,MAAJ,GAAa,CAAb,IAAkB,IAAI,CAAJ,EAAO,MAAP,GAAgB,CAAtC,EAAyC;AACrC,uBAAO,gBAAgB,IAAvB;AACH;AACD,gBAAI,aAAa,IAAI,CAAJ,CAAjB;AACA,gBAAI,aAAa,WAAW,SAAX,CAAqB,CAArB,EAAuB,CAAvB,CAAjB;AACA,gBAAI,cAAc,KAAlB,EAAyB;AACrB,uBAAO,gBAAgB,OAAvB;AACH;AACD,mBAAO,gBAAgB,MAAvB;AACH;;;sCAEa,I,EAAM;AAChB,gBAAI,CAAC,KAAK,SAAV,EAAqB;AACjB,uBAAO,IAAP;AACH;;AAED,iBAAK,OAAL,GAAe,IAAf;;AAEA,gBAAI,UAAU,KAAd;AACA,gBAAI,WAAW,KAAK,OAAL,CAAa,QAA5B;AACA,iBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,SAAS,MAA7B,EAAqC,GAArC,EAA0C;AACtC,oBAAI,OAAO,SAAS,KAAT,CAAe,CAAf,CAAX;AACA,oBAAI,KAAK,SAAS,GAAT,CAAa,CAAb,CAAT;AACA,oBAAI,OAAO,IAAP,IAAe,OAAO,EAA1B,EAA8B;AAC1B,8BAAU,IAAV;AACH;AACJ;;AAED,gBAAI,WAAW,OAAO,KAAK,OAAL,CAAa,WAAnC,EAAgD;AAC5C,qBAAK,OAAL,CAAa,WAAb,GAA2B,IAA3B;AACA,oBAAI,KAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,yBAAK,4BAAL,CAAkC,sCAAuB,WAAzD,EACI,UADJ;AAEH;AACJ,aAND,MAOK;AACD,oBAAI,KAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,yBAAK,4BAAL,CAAkC,sCAAuB,QAAzD,EACI,mBADJ;AAEH;AACJ;;AAED,iBAAK,OAAL,GAAe,KAAf;AACA,mBAAO,KAAP;AACH;;;sCAEa,I,EAAM;AAAA;;AAChB,iBAAK,OAAL,GAAe,IAAf;;AAEA,iBAAK,cAAL,GAAsB,IAAI,IAAJ,GAAW,OAAX,EAAtB;;AAEA,iBAAK,WAAL,GAAmB,WAAW,YAAI;AAC9B,uBAAK,QAAL,GAAgB,KAAhB;AACA,uBAAK,OAAL,GAAe,KAAf;AACA,oBAAI,OAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,2BAAK,4BAAL,CAAkC,sCAAuB,QAAzD,EACI,gBADJ;AAEH;AACJ,aAPkB,EAOjB,KAAG,IAPc,CAAnB;;AASA,iBAAK,QAAL,GAAgB,IAAhB;AACA,iBAAK,QAAL,GAAgB,IAAhB;AACH;;;uCAEc,I,EAAM;AAAA;;AACjB,iBAAK,OAAL,GAAe,IAAf;;AAEA,iBAAK,QAAL,GAAgB,IAAhB;AACA;AACA,gBAAI,WAAW,KAAK,OAAL,CAAa,QAA5B;AACA,gBAAI,SAAS,MAAT,GAAkB,CAAtB,EAAyB;AACrB;AACA,oBAAI,OAAO,SAAS,KAAT,CAAe,CAAf,CAAX;AACA,oBAAI,KAAK,SAAS,GAAT,CAAa,CAAb,CAAT;AACA,qBAAK,gBAAL,GAAwB,EAAxB;;AAEA,qBAAK,OAAL,CAAa,WAAb,GAA2B,KAAK,gBAAhC;AACH;;AAED,uBAAW,YAAI;AACX,uBAAK,OAAL,GAAe,KAAf;AACA,oBAAI,OAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,2BAAK,4BAAL,CAAkC,sCAAuB,WAAzD,EACI,UADJ;AAEH;AACJ,aAND,EAME,IANF;AAOH;;;sCAEa,I,EAAM;AAChB,gBAAI,KAAK,kBAAL,IAA2B,IAA/B,EAAqC;AACjC,qBAAK,kBAAL,CAAwB,IAAxB;AACH;AACJ;;;0CAEiB,I,EAAM;AACpB,gBAAI,KAAK,kBAAL,IAA2B,IAA/B,EAAqC;AACjC,oBAAI,OAAO,EAAX;AACA,qBAAK,KAAL,GAAa,KAAK,KAAlB;AACA,qBAAK,kBAAL,CAAwB,IAAxB;AACH;AACJ;;;iCAEQ,I,EAAM,M,EAAQ,M,EAAQ;AAC3B,gBAAI,KAAK,aAAL,IAAsB,IAA1B,EAAgC;AAC5B,oBAAI,QAAQ,IAAZ;AACA,oBAAI,WAAW,MAAf;AACA,oBAAI,OAAO,IAAX;AACA,qBAAK,aAAL,CAAmB,IAAnB,EAAyB,QAAzB,EAAmC,IAAnC;AACH;AACJ;;;0CAEiB,I,EAAM;AACpB,iBAAK,SAAL,GAAiB,IAAjB;AACA,gBAAI,KAAK,sBAAL,IAA+B,IAAnC,EAAyC;AACrC,qBAAK,sBAAL;AACH;AACJ;;;uCAEc,K,EAAO;AAClB;AACA,gBAAI,KAAK,YAAL,IAAqB,CAAzB,EAA4B;AACxB,oBAAI,KAAK,kBAAL,IAA2B,IAA3B,IAAmC,KAAK,OAAL,IAAgB,IAAvD,EAA6D;AACzD,yBAAK,kBAAL,CAAwB,KAAK,OAAL,CAAa,WAArC;AACH;AACD;AACH;;AAED;AACA,gBAAI,KAAK,eAAL,KAAyB,gBAAgB,MAA7C,EAAqD;AACjD,oBAAI,CAAC,KAAK,OAAN,IAAiB,KAAK,kBAAL,IAA2B,IAA5C,IAAoD,KAAK,OAAL,IAAgB,IAAxE,EAA8E;AAC1E,yBAAK,kBAAL,CAAwB,KAAK,OAAL,CAAa,WAArC;AACH;AACJ,aAJD,MAKK,IAAI,KAAK,eAAL,KAAyB,gBAAgB,OAA7C,EAAsD;AACvD,oBAAI,CAAC,KAAK,OAAN,IAAiB,KAAK,kBAAL,IAA2B,IAA5C,IAAoD,KAAK,OAAL,IAAgB,IAAxE,EAA8E;AAC1E,wBAAI,cAAc,KAAK,QAAL,IAAiB,KAAK,OAAL,CAAa,WAAb,GAA2B,KAAK,gBAAjD,CAAlB;AACA,yBAAK,kBAAL,CAAwB,WAAxB;AACH;AACJ;AACJ;;;sCAEa,I,EAAM;AAAA;;AAChB,gBAAI,KAAK,QAAT,EAAmB;AACf,oBAAI,KAAK,GAAL,CAAS,KAAK,QAAL,GAAc,IAAd,GAAqB,IAA9B,KAAuC,IAA3C,EAAiD;AAC7C;AACH;;AAED,oBAAI,KAAK,WAAL,IAAoB,IAAxB,EAA8B;AAC1B,iCAAa,KAAK,WAAlB;AACA,yBAAK,WAAL,GAAmB,IAAnB;AACH;;AAED,qBAAK,QAAL,GAAgB,KAAhB;AACA,2BAAW,YAAI;AACX,2BAAK,OAAL,GAAe,KAAf;AACA,2BAAK,OAAL,CAAa,WAAb,GAA2B,OAAK,IAAhC;AACA,wBAAI,MAAM,IAAI,IAAJ,GAAW,OAAX,KAAuB,OAAK,cAAtC;AACA,4BAAQ,GAAR,CAAY,WAAW,GAAvB;AACA,wBAAI,OAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,+BAAK,4BAAL,CAAkC,sCAAuB,WAAzD,EACI,UADJ;AAEH;AACJ,iBATD,EASE,IATF;AAUA;AACH;AACJ;;;sCA/VoB;AACjB,mBAAO,OAAO,WAAP,IACH,OAAO,WAAP,CAAmB,eAAnB,CAAmC,2CAAnC,CADJ;AAEH;;;;EAxC8B,gB;;;;;;;;ACf5B,IAAM,sCAAe;AACxB,oBAAgB;AADQ,CAArB;;AAIA,IAAM,sDAAuB;AAChC,oBAAgB,gBADgB;AAEhC,kBAAc;AAFkB,CAA7B;;AAKA,IAAM,4DAA0B;AACnC,yBAAqB,qBADc;AAEnC,4BAAwB,wBAFW;AAGnC,kBAAc,cAHqB;AAInC,gBAAY,YAJuB;AAKnC,+BAA2B,2BALQ;AAMnC,4BAAwB;AANW,CAAhC;;;;;;;;;;;;;ICTM,O,WAAA,O;AAET,qBAAY,QAAZ,EAAsB;AAAA;;AAClB,aAAK,KAAL,GAAa,YAAY,WAAzB;AACH;;;;6BAEI,O,EAAS,K,EAAO,I,EAAM,O,EAAS,M,EAAQ,CAC3C;;;2BAEE,K,EAAO,I,EAAM,CAEf;;;4BAEG,K,EAAO,CAEV;;;2CAEkB,O,EAAS,CAC3B;;;+BAEM,CACN;;;kCAES,CAET;;;;;;;;;;;;;;;;ACzBL;;AACA;;AACA;;AACA;;AAEA;;;;AAEA;;;;AACA;;AACA;;;;;;;;;;AAEA,IAAM,cAAc,GAApB;AACA,IAAM,YAAY,KAAlB;;IAEa,a,WAAA,a;;;AAET,6BAAe;AAAA;;AAAA,kIACL,gBADK;;AAEX,cAAK,GAAL,GAAW,eAAX;;AAEA,cAAK,OAAL,GAAe,IAAf;AACA,cAAK,KAAL,GAAa,IAAb;AACA,cAAK,IAAL,GAAY,IAAZ;AACA,cAAK,OAAL,GAAe,IAAf;;AAEA,cAAK,MAAL,GAAc,IAAd;AACA,cAAK,QAAL,GAAgB,IAAhB;AACA,cAAK,MAAL,GAAc,IAAd;AACA,cAAK,OAAL,GAAe,IAAf;;AAEA,cAAK,qBAAL,GAA6B,IAA7B;;AAEA,cAAK,SAAL,GAAiB,IAAI,oBAAJ,EAAjB;;AAEA,cAAK,UAAL,GAAkB,IAAlB;AACA,cAAK,SAAL,GAAiB,IAAjB;;AAEA,cAAK,oBAAL,GAA4B,KAA5B;AACA,cAAK,iBAAL,GAAyB,KAAzB;AACA,cAAK,4BAAL,GAAoC,KAApC;AACA,cAAK,UAAL,GAAkB,KAAlB;AAxBW;AAyBd;;;;6BAOI,O,EAAS,K,EAAO,I,EAAM,O,EAAS,M,EAAQ;AACxC,iBAAK,OAAL,GAAe,OAAf;AACA,iBAAK,KAAL,GAAa,KAAb;AACA,iBAAK,IAAL,GAAY,IAAZ;AACA,iBAAK,OAAL,GAAe,OAAf;AACA,gBAAI,CAAC,KAAK,gBAAL,EAAL,EAA8B;AAC1B,uBAAO,KAAP;AACH;;AAED,iBAAK,YAAL,CAAkB,OAAlB;AACA,mBAAO,IAAP;AACH;;;2BAEE,K,EAAO,I,EAAM;AACZ,gBAAI,UAAU,4BAAa,cAA3B,EAA2C;AACvC,qBAAK,qBAAL,GAA6B,IAA7B;AACH;AACJ;;;4BAEG,K,EAAO;AACP,gBAAI,UAAU,4BAAa,cAA3B,EAA2C;AACvC,qBAAK,qBAAL,GAA6B,IAA7B;AACH;AACJ;;;2CAEkB,O,EAAS;AACxB,iBAAK,OAAL,GAAe,OAAf;;AAEA,iBAAK,OAAL,CAAa,gBAAb,CAA8B,YAA9B,EAA4C,KAAK,mBAAL,CAAyB,IAAzB,CAA8B,IAA9B,CAA5C,EAAiF,EAAC,MAAM,IAAP,EAAjF;AACA,iBAAK,MAAL,CAAY,EAAZ,CAAe,eAAM,MAAN,CAAa,KAA5B,EAAmC,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAAnC;AACA,iBAAK,MAAL,CAAY,yBAAZ,CAAsC,KAAK,uBAAL,CAA6B,IAA7B,CAAkC,IAAlC,CAAtC;;AAEA,iBAAK,MAAL,CAAY,kBAAZ,CAA+B,OAA/B;AACH;;;+BAEM;AACH,iBAAK,MAAL,CAAY,IAAZ;AACA,iBAAK,YAAL,CAAkB,KAAK,KAAvB;AACH;;;kCAES;AACN,iBAAK,UAAL,GAAkB,IAAlB;;AAEA,iBAAK,cAAL;AACA,iBAAK,cAAL;AACA,iBAAK,gBAAL;AACA,iBAAK,gBAAL;AACH;;;2CAEkB;AACf,gBAAI,WAAK,aAAL,CAAmB,KAAK,OAAxB,KAAoC,WAAK,aAAL,CAAmB,KAAK,KAAxB,CAAxC,EAAwE;AACpE,uBAAO,KAAP;AACH;AACD,gBAAI,WAAK,aAAL,CAAmB,KAAK,IAAxB,CAAJ,EAAmC;AAC/B,uBAAO,KAAP;AACH;AACD,gBAAI,KAAK,OAAL,GAAe,CAAf,IAAoB,KAAK,OAAL,GAAe,GAAvC,EAA4C;AACxC,uBAAO,KAAP;AACH;AACD,mBAAO,IAAP;AACH;;;qCAEY,G,EAAK;AACd,iBAAK,cAAL;;AAEA,iBAAK,MAAL,GAAc,eAAM,YAAN,CAAmB,EAAC,QAAO,IAAR,EAAc,MAAK,KAAnB,EAAyB,KAAI,GAA7B,EAAnB,EAAsD;AAChE,0BAAU,KADsD;AAEhE,mCAAmB,KAF6C;AAGhE,0CAAyB;AAHuC,aAAtD,CAAd;AAKH;;;8CAEqB;AAClB,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,mBAAZ;AACH;;AAED,iBAAK,oBAAL,GAA4B,IAA5B;AACA,gBAAI,KAAK,iBAAL,IAA0B,KAAK,qBAAL,IAA8B,IAA5D,EAAkE;AAC9D,qBAAK,qBAAL,CAA2B,oCAAqB,cAAhD,EAAgE,EAAhE;AACH;AACJ;;;uCAEc,I,EAAM,M,EAAQ,M,EAAQ;AACjC,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,cAAZ;AACH;;AAED,gBAAI,KAAK,qBAAL,IAA8B,IAAlC,EAAwC;AACpC;AACH;;AAED,gBAAI,KAAK,oBAAT,EAA+B;AAC3B,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,YAD5B;AAEH,aAHD,MAIK;AACD,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,mBAD5B;AAEH;AACJ;;;gDAEuB,I,EAAM;AAC1B,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,mBAAZ;AACH;;AAED,gBAAI,KAAK,qBAAL,IAA8B,IAAlC,EAAwC;AACpC,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,sBAD5B;AAEH;AACJ;;;yCAEgB;AACb,gBAAI,KAAK,MAAL,IAAe,IAAnB,EAAyB;AACrB,qBAAK,MAAL,CAAY,KAAZ;AACA,qBAAK,MAAL,CAAY,MAAZ;AACA,qBAAK,MAAL,CAAY,kBAAZ;AACA,qBAAK,MAAL,CAAY,OAAZ;AACA,qBAAK,MAAL,GAAc,IAAd;AACH;;AAED,gBAAI,KAAK,OAAL,IAAgB,IAApB,EAA0B;AACtB,qBAAK,OAAL,GAAe,IAAf;AACH;AACJ;;;qCAEY,G,EAAK;AACd,iBAAK,MAAL,GAAc,IAAI,SAAJ,CAAc,GAAd,CAAd;AACA,iBAAK,MAAL,CAAY,MAAZ,GAAqB,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAArB;AACA,iBAAK,MAAL,CAAY,SAAZ,GAAwB,KAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,CAAxB;AACA,iBAAK,MAAL,CAAY,OAAZ,GAAsB,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAAtB;AACA,iBAAK,MAAL,CAAY,OAAZ,GAAsB,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAAtB;AACH;;;wCAEe;AACZ,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,gBAAZ;AACH;;AAED,iBAAK,cAAL;AACH;;;qCAEY,C,EAAG,CAEf;;;uCAEc,C,EAAG;AACd,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,iBAAZ;AACH;;AAED,gBAAI,KAAK,qBAAL,IAA8B,IAAlC,EAAwC;AACpC,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,UAD5B;AAEH;AACJ;;;uCAEc,C,EAAG;AACd,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,iBAAZ;AACH;AACJ;;;yCAEgB;AACb,iBAAK,MAAL,CAAY,KAAZ;AACA,iBAAK,MAAL,GAAc,IAAd;AACH;;;yCAEgB;AACb,gBAAI,KAAK,QAAT,EAAmB;AACf,qBAAK,QAAL,CAAc,KAAd;AACH;;AAED,iBAAK,QAAL,GAAgB,4BAAS;AACrB,sBAAK,KADgB;AAErB,4BAAW,IAFU;AAGrB,yBAAQ,EAHa;AAIrB,2BAAU,KAAK,wBAAL,CAA8B,IAA9B,CAAmC,IAAnC;AAJW,aAAT,CAAhB;AAMA,iBAAK,UAAL,GAAkB,WAAW,KAAK,kCAAL,CAAwC,IAAxC,CAA6C,IAA7C,CAAX,EAA8D,KAA9D,CAAlB;AACA,iBAAK,QAAL,CAAc,IAAd,CAAmB,KAAK,sBAAL,CAA4B,IAA5B,CAAiC,IAAjC,CAAnB,EACI,KAAK,yBAAL,CAA+B,IAA/B,CAAoC,IAApC,CADJ;AAEH;;;6DAEoC;AACjC,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,iCAAZ;AACH;;AAED,iBAAK,4BAAL,GAAoC,IAApC;;AAEA,gBAAI,KAAK,qBAAL,IAA8B,IAAlC,EAAwC;AACpC,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,yBAD5B;AAEH;AACJ;;;iDAEwB;AACrB,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,0BAAZ;AACH;;AAED,gBAAI,KAAK,4BAAT,EAAuC;AACnC;AACH;;AAED,yBAAa,KAAK,UAAlB;;AAEA,iBAAK,iBAAL,GAAyB,IAAzB;AACA,gBAAI,KAAK,oBAAL,IAA6B,KAAK,qBAAL,IAA8B,IAA/D,EAAqE;AACjE,qBAAK,qBAAL,CAA2B,oCAAqB,cAAhD,EAAgE,EAAhE;AACH;;AAED,iBAAK,QAAL,CAAc,KAAd;AACA,iBAAK,SAAL;AACH;;;kDAEyB,G,EAAK,c,EAAgB;AAC3C,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,6BAAZ;AACH;;AAED,yBAAa,KAAK,UAAlB;;AAEA,gBAAI,KAAK,qBAAL,IAA8B,IAAlC,EAAwC;AACpC,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,sBAD5B;AAEH;AACJ;;;iDAEwB,O,EAAS,U,EAAY,c,EAAgB,gB,EAAkB;AAC5E,gBAAI,WAAW,QAAQ,QAAQ,MAAR,GAAiB,CAAzB,EAA4B,MAA3C,CAD4E,CACzB;AACnD,gBAAI,QAAQ,IAAI,UAAJ,CAAe,QAAf,CAAZ,CAF4E,CAEtC;AACtC,iBAAK,SAAL,CAAe,IAAf,CAAoB,KAApB;AACH;;;2CAEkB;AACf,iBAAK,QAAL,CAAc,KAAd;AACA,iBAAK,QAAL,GAAgB,IAAhB;AACH;;;oCAEW;AACR,gBAAI,KAAK,UAAT,EAAqB;AACjB;AACH;;AAED,gBAAI,KAAK,SAAL,CAAe,MAAf,GAAwB,WAA5B,EAAyC;AACrC,qBAAK,SAAL,GAAiB,WAAW,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,CAAX,EAAsC,CAAtC,CAAjB;AACH,aAFD,MAGK;AACD,oBAAI,WAAW,KAAK,SAAL,CAAe,SAAf,CAAyB,WAAzB,CAAf;;AAEA,oBAAI,SAAS,IAAI,oBAAJ,EAAb;AACA,uBAAO,IAAP,CAAY,IAAI,UAAJ,CAAe,CAAC,IAAD,EAAM,IAAN,EAAW,IAAX,EAAgB,IAAhB,CAAf,CAAZ;AACA,oBAAI,cAAc,KAAK,IAAL,CAAU,KAAV,CAAgB,EAAhB,CAAlB;AACA,qBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,YAAY,MAAhC,EAAwC,GAAxC,EAA6C;AACzC,2BAAO,IAAP,CAAY,IAAI,UAAJ,CAAe,CAAC,YAAY,CAAZ,EAAe,UAAf,EAAD,CAAf,CAAZ;AACH;AACD,uBAAO,IAAP,CAAY,IAAI,UAAJ,CAAe,CAAC,SAAS,KAAK,OAAd,CAAD,CAAf,CAAZ;AACA,uBAAO,IAAP,CAAY,IAAI,UAAJ,CAAe,CAAC,KAAK,KAAL,CAAW,cAAY,GAAvB,CAAD,CAAf,CAAZ;AACA,uBAAO,IAAP,CAAY,IAAI,UAAJ,CAAe,CAAC,cAAY,GAAb,CAAf,CAAZ;AACA,uBAAO,IAAP,CAAY,QAAZ;;AAEA,oBAAI,WAAW,IAAI,YAAY,MAAhB,GAAyB,CAAzB,GAA6B,WAA5C;AACA,oBAAI,KAAK,MAAL,IAAe,IAAnB,EAAyB;AACrB,yBAAK,MAAL,CAAY,IAAZ,CAAiB,OAAO,SAAP,CAAiB,QAAjB,CAAjB;AACH;;AAED,qBAAK,SAAL;AACH;AACJ;;;2CAEkB;AACf,yBAAa,KAAK,SAAlB;AACH;;;sCAxRoB;AACjB,mBAAO,OAAO,SAAP,IAAoB,WAApB,IAAmC,uBAAS,OAAT,EAAnC,IAAyD,OAAO,WAAhE,IACH,OAAO,WAAP,CAAmB,eAAnB,CAAmC,2CAAnC,CADJ;AAEH;;;;EAhC8B,gB","file":"gmedia.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.flvjs = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n(function (process,global){\n/*!\n * @overview es6-promise - a tiny implementation of Promises/A+.\n * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)\n * @license   Licensed under MIT license\n *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE\n * @version   v4.2.5+7f2b526d\n */\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.ES6Promise = factory());\n}(this, (function () { 'use strict';\n\nfunction objectOrFunction(x) {\n  var type = typeof x;\n  return x !== null && (type === 'object' || type === 'function');\n}\n\nfunction isFunction(x) {\n  return typeof x === 'function';\n}\n\n\n\nvar _isArray = void 0;\nif (Array.isArray) {\n  _isArray = Array.isArray;\n} else {\n  _isArray = function (x) {\n    return Object.prototype.toString.call(x) === '[object Array]';\n  };\n}\n\nvar isArray = _isArray;\n\nvar len = 0;\nvar vertxNext = void 0;\nvar customSchedulerFn = void 0;\n\nvar asap = function asap(callback, arg) {\n  queue[len] = callback;\n  queue[len + 1] = arg;\n  len += 2;\n  if (len === 2) {\n    // If len is 2, that means that we need to schedule an async flush.\n    // If additional callbacks are queued before the queue is flushed, they\n    // will be processed by this flush that we are scheduling.\n    if (customSchedulerFn) {\n      customSchedulerFn(flush);\n    } else {\n      scheduleFlush();\n    }\n  }\n};\n\nfunction setScheduler(scheduleFn) {\n  customSchedulerFn = scheduleFn;\n}\n\nfunction setAsap(asapFn) {\n  asap = asapFn;\n}\n\nvar browserWindow = typeof window !== 'undefined' ? window : undefined;\nvar browserGlobal = browserWindow || {};\nvar BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;\nvar isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';\n\n// test for web worker but not in IE10\nvar isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined';\n\n// node\nfunction useNextTick() {\n  // node version 0.10.x displays a deprecation warning when nextTick is used recursively\n  // see https://github.com/cujojs/when/issues/410 for details\n  return function () {\n    return process.nextTick(flush);\n  };\n}\n\n// vertx\nfunction useVertxTimer() {\n  if (typeof vertxNext !== 'undefined') {\n    return function () {\n      vertxNext(flush);\n    };\n  }\n\n  return useSetTimeout();\n}\n\nfunction useMutationObserver() {\n  var iterations = 0;\n  var observer = new BrowserMutationObserver(flush);\n  var node = document.createTextNode('');\n  observer.observe(node, { characterData: true });\n\n  return function () {\n    node.data = iterations = ++iterations % 2;\n  };\n}\n\n// web worker\nfunction useMessageChannel() {\n  var channel = new MessageChannel();\n  channel.port1.onmessage = flush;\n  return function () {\n    return channel.port2.postMessage(0);\n  };\n}\n\nfunction useSetTimeout() {\n  // Store setTimeout reference so es6-promise will be unaffected by\n  // other code modifying setTimeout (like sinon.useFakeTimers())\n  var globalSetTimeout = setTimeout;\n  return function () {\n    return globalSetTimeout(flush, 1);\n  };\n}\n\nvar queue = new Array(1000);\nfunction flush() {\n  for (var i = 0; i < len; i += 2) {\n    var callback = queue[i];\n    var arg = queue[i + 1];\n\n    callback(arg);\n\n    queue[i] = undefined;\n    queue[i + 1] = undefined;\n  }\n\n  len = 0;\n}\n\nfunction attemptVertx() {\n  try {\n    var vertx = Function('return this')().require('vertx');\n    vertxNext = vertx.runOnLoop || vertx.runOnContext;\n    return useVertxTimer();\n  } catch (e) {\n    return useSetTimeout();\n  }\n}\n\nvar scheduleFlush = void 0;\n// Decide what async method to use to triggering processing of queued callbacks:\nif (isNode) {\n  scheduleFlush = useNextTick();\n} else if (BrowserMutationObserver) {\n  scheduleFlush = useMutationObserver();\n} else if (isWorker) {\n  scheduleFlush = useMessageChannel();\n} else if (browserWindow === undefined && typeof _dereq_ === 'function') {\n  scheduleFlush = attemptVertx();\n} else {\n  scheduleFlush = useSetTimeout();\n}\n\nfunction then(onFulfillment, onRejection) {\n  var parent = this;\n\n  var child = new this.constructor(noop);\n\n  if (child[PROMISE_ID] === undefined) {\n    makePromise(child);\n  }\n\n  var _state = parent._state;\n\n\n  if (_state) {\n    var callback = arguments[_state - 1];\n    asap(function () {\n      return invokeCallback(_state, child, callback, parent._result);\n    });\n  } else {\n    subscribe(parent, child, onFulfillment, onRejection);\n  }\n\n  return child;\n}\n\n/**\n  `Promise.resolve` returns a promise that will become resolved with the\n  passed `value`. It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    resolve(1);\n  });\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.resolve(1);\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  @method resolve\n  @static\n  @param {Any} value value that the returned promise will be resolved with\n  Useful for tooling.\n  @return {Promise} a promise that will become fulfilled with the given\n  `value`\n*/\nfunction resolve$1(object) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (object && typeof object === 'object' && object.constructor === Constructor) {\n    return object;\n  }\n\n  var promise = new Constructor(noop);\n  resolve(promise, object);\n  return promise;\n}\n\nvar PROMISE_ID = Math.random().toString(36).substring(2);\n\nfunction noop() {}\n\nvar PENDING = void 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\n\nvar TRY_CATCH_ERROR = { error: null };\n\nfunction selfFulfillment() {\n  return new TypeError(\"You cannot resolve a promise with itself\");\n}\n\nfunction cannotReturnOwn() {\n  return new TypeError('A promises callback cannot return that same promise.');\n}\n\nfunction getThen(promise) {\n  try {\n    return promise.then;\n  } catch (error) {\n    TRY_CATCH_ERROR.error = error;\n    return TRY_CATCH_ERROR;\n  }\n}\n\nfunction tryThen(then$$1, value, fulfillmentHandler, rejectionHandler) {\n  try {\n    then$$1.call(value, fulfillmentHandler, rejectionHandler);\n  } catch (e) {\n    return e;\n  }\n}\n\nfunction handleForeignThenable(promise, thenable, then$$1) {\n  asap(function (promise) {\n    var sealed = false;\n    var error = tryThen(then$$1, thenable, function (value) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n      if (thenable !== value) {\n        resolve(promise, value);\n      } else {\n        fulfill(promise, value);\n      }\n    }, function (reason) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n\n      reject(promise, reason);\n    }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n    if (!sealed && error) {\n      sealed = true;\n      reject(promise, error);\n    }\n  }, promise);\n}\n\nfunction handleOwnThenable(promise, thenable) {\n  if (thenable._state === FULFILLED) {\n    fulfill(promise, thenable._result);\n  } else if (thenable._state === REJECTED) {\n    reject(promise, thenable._result);\n  } else {\n    subscribe(thenable, undefined, function (value) {\n      return resolve(promise, value);\n    }, function (reason) {\n      return reject(promise, reason);\n    });\n  }\n}\n\nfunction handleMaybeThenable(promise, maybeThenable, then$$1) {\n  if (maybeThenable.constructor === promise.constructor && then$$1 === then && maybeThenable.constructor.resolve === resolve$1) {\n    handleOwnThenable(promise, maybeThenable);\n  } else {\n    if (then$$1 === TRY_CATCH_ERROR) {\n      reject(promise, TRY_CATCH_ERROR.error);\n      TRY_CATCH_ERROR.error = null;\n    } else if (then$$1 === undefined) {\n      fulfill(promise, maybeThenable);\n    } else if (isFunction(then$$1)) {\n      handleForeignThenable(promise, maybeThenable, then$$1);\n    } else {\n      fulfill(promise, maybeThenable);\n    }\n  }\n}\n\nfunction resolve(promise, value) {\n  if (promise === value) {\n    reject(promise, selfFulfillment());\n  } else if (objectOrFunction(value)) {\n    handleMaybeThenable(promise, value, getThen(value));\n  } else {\n    fulfill(promise, value);\n  }\n}\n\nfunction publishRejection(promise) {\n  if (promise._onerror) {\n    promise._onerror(promise._result);\n  }\n\n  publish(promise);\n}\n\nfunction fulfill(promise, value) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n\n  promise._result = value;\n  promise._state = FULFILLED;\n\n  if (promise._subscribers.length !== 0) {\n    asap(publish, promise);\n  }\n}\n\nfunction reject(promise, reason) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n  promise._state = REJECTED;\n  promise._result = reason;\n\n  asap(publishRejection, promise);\n}\n\nfunction subscribe(parent, child, onFulfillment, onRejection) {\n  var _subscribers = parent._subscribers;\n  var length = _subscribers.length;\n\n\n  parent._onerror = null;\n\n  _subscribers[length] = child;\n  _subscribers[length + FULFILLED] = onFulfillment;\n  _subscribers[length + REJECTED] = onRejection;\n\n  if (length === 0 && parent._state) {\n    asap(publish, parent);\n  }\n}\n\nfunction publish(promise) {\n  var subscribers = promise._subscribers;\n  var settled = promise._state;\n\n  if (subscribers.length === 0) {\n    return;\n  }\n\n  var child = void 0,\n      callback = void 0,\n      detail = promise._result;\n\n  for (var i = 0; i < subscribers.length; i += 3) {\n    child = subscribers[i];\n    callback = subscribers[i + settled];\n\n    if (child) {\n      invokeCallback(settled, child, callback, detail);\n    } else {\n      callback(detail);\n    }\n  }\n\n  promise._subscribers.length = 0;\n}\n\nfunction tryCatch(callback, detail) {\n  try {\n    return callback(detail);\n  } catch (e) {\n    TRY_CATCH_ERROR.error = e;\n    return TRY_CATCH_ERROR;\n  }\n}\n\nfunction invokeCallback(settled, promise, callback, detail) {\n  var hasCallback = isFunction(callback),\n      value = void 0,\n      error = void 0,\n      succeeded = void 0,\n      failed = void 0;\n\n  if (hasCallback) {\n    value = tryCatch(callback, detail);\n\n    if (value === TRY_CATCH_ERROR) {\n      failed = true;\n      error = value.error;\n      value.error = null;\n    } else {\n      succeeded = true;\n    }\n\n    if (promise === value) {\n      reject(promise, cannotReturnOwn());\n      return;\n    }\n  } else {\n    value = detail;\n    succeeded = true;\n  }\n\n  if (promise._state !== PENDING) {\n    // noop\n  } else if (hasCallback && succeeded) {\n    resolve(promise, value);\n  } else if (failed) {\n    reject(promise, error);\n  } else if (settled === FULFILLED) {\n    fulfill(promise, value);\n  } else if (settled === REJECTED) {\n    reject(promise, value);\n  }\n}\n\nfunction initializePromise(promise, resolver) {\n  try {\n    resolver(function resolvePromise(value) {\n      resolve(promise, value);\n    }, function rejectPromise(reason) {\n      reject(promise, reason);\n    });\n  } catch (e) {\n    reject(promise, e);\n  }\n}\n\nvar id = 0;\nfunction nextId() {\n  return id++;\n}\n\nfunction makePromise(promise) {\n  promise[PROMISE_ID] = id++;\n  promise._state = undefined;\n  promise._result = undefined;\n  promise._subscribers = [];\n}\n\nfunction validationError() {\n  return new Error('Array Methods must be provided an Array');\n}\n\nvar Enumerator = function () {\n  function Enumerator(Constructor, input) {\n    this._instanceConstructor = Constructor;\n    this.promise = new Constructor(noop);\n\n    if (!this.promise[PROMISE_ID]) {\n      makePromise(this.promise);\n    }\n\n    if (isArray(input)) {\n      this.length = input.length;\n      this._remaining = input.length;\n\n      this._result = new Array(this.length);\n\n      if (this.length === 0) {\n        fulfill(this.promise, this._result);\n      } else {\n        this.length = this.length || 0;\n        this._enumerate(input);\n        if (this._remaining === 0) {\n          fulfill(this.promise, this._result);\n        }\n      }\n    } else {\n      reject(this.promise, validationError());\n    }\n  }\n\n  Enumerator.prototype._enumerate = function _enumerate(input) {\n    for (var i = 0; this._state === PENDING && i < input.length; i++) {\n      this._eachEntry(input[i], i);\n    }\n  };\n\n  Enumerator.prototype._eachEntry = function _eachEntry(entry, i) {\n    var c = this._instanceConstructor;\n    var resolve$$1 = c.resolve;\n\n\n    if (resolve$$1 === resolve$1) {\n      var _then = getThen(entry);\n\n      if (_then === then && entry._state !== PENDING) {\n        this._settledAt(entry._state, i, entry._result);\n      } else if (typeof _then !== 'function') {\n        this._remaining--;\n        this._result[i] = entry;\n      } else if (c === Promise$1) {\n        var promise = new c(noop);\n        handleMaybeThenable(promise, entry, _then);\n        this._willSettleAt(promise, i);\n      } else {\n        this._willSettleAt(new c(function (resolve$$1) {\n          return resolve$$1(entry);\n        }), i);\n      }\n    } else {\n      this._willSettleAt(resolve$$1(entry), i);\n    }\n  };\n\n  Enumerator.prototype._settledAt = function _settledAt(state, i, value) {\n    var promise = this.promise;\n\n\n    if (promise._state === PENDING) {\n      this._remaining--;\n\n      if (state === REJECTED) {\n        reject(promise, value);\n      } else {\n        this._result[i] = value;\n      }\n    }\n\n    if (this._remaining === 0) {\n      fulfill(promise, this._result);\n    }\n  };\n\n  Enumerator.prototype._willSettleAt = function _willSettleAt(promise, i) {\n    var enumerator = this;\n\n    subscribe(promise, undefined, function (value) {\n      return enumerator._settledAt(FULFILLED, i, value);\n    }, function (reason) {\n      return enumerator._settledAt(REJECTED, i, reason);\n    });\n  };\n\n  return Enumerator;\n}();\n\n/**\n  `Promise.all` accepts an array of promises, and returns a new promise which\n  is fulfilled with an array of fulfillment values for the passed promises, or\n  rejected with the reason of the first passed promise to be rejected. It casts all\n  elements of the passed iterable to promises as it runs this algorithm.\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = resolve(2);\n  let promise3 = resolve(3);\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // The array here would be [ 1, 2, 3 ];\n  });\n  ```\n\n  If any of the `promises` given to `all` are rejected, the first promise\n  that is rejected will be given as an argument to the returned promises's\n  rejection handler. For example:\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = reject(new Error(\"2\"));\n  let promise3 = reject(new Error(\"3\"));\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // Code here never runs because there are rejected promises!\n  }, function(error) {\n    // error.message === \"2\"\n  });\n  ```\n\n  @method all\n  @static\n  @param {Array} entries array of promises\n  @param {String} label optional string for labeling the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled when all `promises` have been\n  fulfilled, or rejected if any of them become rejected.\n  @static\n*/\nfunction all(entries) {\n  return new Enumerator(this, entries).promise;\n}\n\n/**\n  `Promise.race` returns a new promise which is settled in the same way as the\n  first passed promise to settle.\n\n  Example:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 2');\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // result === 'promise 2' because it was resolved before promise1\n    // was resolved.\n  });\n  ```\n\n  `Promise.race` is deterministic in that only the state of the first\n  settled promise matters. For example, even if other promises given to the\n  `promises` array argument are resolved, but the first settled promise has\n  become rejected before the other promises became fulfilled, the returned\n  promise will become rejected:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      reject(new Error('promise 2'));\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // Code here never runs\n  }, function(reason){\n    // reason.message === 'promise 2' because promise 2 became rejected before\n    // promise 1 became fulfilled\n  });\n  ```\n\n  An example real-world use case is implementing timeouts:\n\n  ```javascript\n  Promise.race([ajax('foo.json'), timeout(5000)])\n  ```\n\n  @method race\n  @static\n  @param {Array} promises array of promises to observe\n  Useful for tooling.\n  @return {Promise} a promise which settles in the same way as the first passed\n  promise to settle.\n*/\nfunction race(entries) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (!isArray(entries)) {\n    return new Constructor(function (_, reject) {\n      return reject(new TypeError('You must pass an array to race.'));\n    });\n  } else {\n    return new Constructor(function (resolve, reject) {\n      var length = entries.length;\n      for (var i = 0; i < length; i++) {\n        Constructor.resolve(entries[i]).then(resolve, reject);\n      }\n    });\n  }\n}\n\n/**\n  `Promise.reject` returns a promise rejected with the passed `reason`.\n  It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    reject(new Error('WHOOPS'));\n  });\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.reject(new Error('WHOOPS'));\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  @method reject\n  @static\n  @param {Any} reason value that the returned promise will be rejected with.\n  Useful for tooling.\n  @return {Promise} a promise rejected with the given `reason`.\n*/\nfunction reject$1(reason) {\n  /*jshint validthis:true */\n  var Constructor = this;\n  var promise = new Constructor(noop);\n  reject(promise, reason);\n  return promise;\n}\n\nfunction needsResolver() {\n  throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n}\n\nfunction needsNew() {\n  throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n}\n\n/**\n  Promise objects represent the eventual result of an asynchronous operation. The\n  primary way of interacting with a promise is through its `then` method, which\n  registers callbacks to receive either a promise's eventual value or the reason\n  why the promise cannot be fulfilled.\n\n  Terminology\n  -----------\n\n  - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\n  - `thenable` is an object or function that defines a `then` method.\n  - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\n  - `exception` is a value that is thrown using the throw statement.\n  - `reason` is a value that indicates why a promise was rejected.\n  - `settled` the final resting state of a promise, fulfilled or rejected.\n\n  A promise can be in one of three states: pending, fulfilled, or rejected.\n\n  Promises that are fulfilled have a fulfillment value and are in the fulfilled\n  state.  Promises that are rejected have a rejection reason and are in the\n  rejected state.  A fulfillment value is never a thenable.\n\n  Promises can also be said to *resolve* a value.  If this value is also a\n  promise, then the original promise's settled state will match the value's\n  settled state.  So a promise that *resolves* a promise that rejects will\n  itself reject, and a promise that *resolves* a promise that fulfills will\n  itself fulfill.\n\n\n  Basic Usage:\n  ------------\n\n  ```js\n  let promise = new Promise(function(resolve, reject) {\n    // on success\n    resolve(value);\n\n    // on failure\n    reject(reason);\n  });\n\n  promise.then(function(value) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Advanced Usage:\n  ---------------\n\n  Promises shine when abstracting away asynchronous interactions such as\n  `XMLHttpRequest`s.\n\n  ```js\n  function getJSON(url) {\n    return new Promise(function(resolve, reject){\n      let xhr = new XMLHttpRequest();\n\n      xhr.open('GET', url);\n      xhr.onreadystatechange = handler;\n      xhr.responseType = 'json';\n      xhr.setRequestHeader('Accept', 'application/json');\n      xhr.send();\n\n      function handler() {\n        if (this.readyState === this.DONE) {\n          if (this.status === 200) {\n            resolve(this.response);\n          } else {\n            reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\n          }\n        }\n      };\n    });\n  }\n\n  getJSON('/posts.json').then(function(json) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Unlike callbacks, promises are great composable primitives.\n\n  ```js\n  Promise.all([\n    getJSON('/posts'),\n    getJSON('/comments')\n  ]).then(function(values){\n    values[0] // => postsJSON\n    values[1] // => commentsJSON\n\n    return values;\n  });\n  ```\n\n  @class Promise\n  @param {Function} resolver\n  Useful for tooling.\n  @constructor\n*/\n\nvar Promise$1 = function () {\n  function Promise(resolver) {\n    this[PROMISE_ID] = nextId();\n    this._result = this._state = undefined;\n    this._subscribers = [];\n\n    if (noop !== resolver) {\n      typeof resolver !== 'function' && needsResolver();\n      this instanceof Promise ? initializePromise(this, resolver) : needsNew();\n    }\n  }\n\n  /**\n  The primary way of interacting with a promise is through its `then` method,\n  which registers callbacks to receive either a promise's eventual value or the\n  reason why the promise cannot be fulfilled.\n   ```js\n  findUser().then(function(user){\n    // user is available\n  }, function(reason){\n    // user is unavailable, and you are given the reason why\n  });\n  ```\n   Chaining\n  --------\n   The return value of `then` is itself a promise.  This second, 'downstream'\n  promise is resolved with the return value of the first promise's fulfillment\n  or rejection handler, or rejected if the handler throws an exception.\n   ```js\n  findUser().then(function (user) {\n    return user.name;\n  }, function (reason) {\n    return 'default name';\n  }).then(function (userName) {\n    // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\n    // will be `'default name'`\n  });\n   findUser().then(function (user) {\n    throw new Error('Found user, but still unhappy');\n  }, function (reason) {\n    throw new Error('`findUser` rejected and we're unhappy');\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\n    // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.\n  });\n  ```\n  If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\n   ```js\n  findUser().then(function (user) {\n    throw new PedagogicalException('Upstream error');\n  }).then(function (value) {\n    // never reached\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // The `PedgagocialException` is propagated all the way down to here\n  });\n  ```\n   Assimilation\n  ------------\n   Sometimes the value you want to propagate to a downstream promise can only be\n  retrieved asynchronously. This can be achieved by returning a promise in the\n  fulfillment or rejection handler. The downstream promise will then be pending\n  until the returned promise is settled. This is called *assimilation*.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // The user's comments are now available\n  });\n  ```\n   If the assimliated promise rejects, then the downstream promise will also reject.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // If `findCommentsByAuthor` fulfills, we'll have the value here\n  }, function (reason) {\n    // If `findCommentsByAuthor` rejects, we'll have the reason here\n  });\n  ```\n   Simple Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let result;\n   try {\n    result = findResult();\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n  findResult(function(result, err){\n    if (err) {\n      // failure\n    } else {\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findResult().then(function(result){\n    // success\n  }, function(reason){\n    // failure\n  });\n  ```\n   Advanced Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let author, books;\n   try {\n    author = findAuthor();\n    books  = findBooksByAuthor(author);\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n   function foundBooks(books) {\n   }\n   function failure(reason) {\n   }\n   findAuthor(function(author, err){\n    if (err) {\n      failure(err);\n      // failure\n    } else {\n      try {\n        findBoooksByAuthor(author, function(books, err) {\n          if (err) {\n            failure(err);\n          } else {\n            try {\n              foundBooks(books);\n            } catch(reason) {\n              failure(reason);\n            }\n          }\n        });\n      } catch(error) {\n        failure(err);\n      }\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findAuthor().\n    then(findBooksByAuthor).\n    then(function(books){\n      // found books\n  }).catch(function(reason){\n    // something went wrong\n  });\n  ```\n   @method then\n  @param {Function} onFulfilled\n  @param {Function} onRejected\n  Useful for tooling.\n  @return {Promise}\n  */\n\n  /**\n  `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\n  as the catch block of a try/catch statement.\n  ```js\n  function findAuthor(){\n  throw new Error('couldn't find that author');\n  }\n  // synchronous\n  try {\n  findAuthor();\n  } catch(reason) {\n  // something went wrong\n  }\n  // async with promises\n  findAuthor().catch(function(reason){\n  // something went wrong\n  });\n  ```\n  @method catch\n  @param {Function} onRejection\n  Useful for tooling.\n  @return {Promise}\n  */\n\n\n  Promise.prototype.catch = function _catch(onRejection) {\n    return this.then(null, onRejection);\n  };\n\n  /**\n    `finally` will be invoked regardless of the promise's fate just as native\n    try/catch/finally behaves\n  \n    Synchronous example:\n  \n    ```js\n    findAuthor() {\n      if (Math.random() > 0.5) {\n        throw new Error();\n      }\n      return new Author();\n    }\n  \n    try {\n      return findAuthor(); // succeed or fail\n    } catch(error) {\n      return findOtherAuther();\n    } finally {\n      // always runs\n      // doesn't affect the return value\n    }\n    ```\n  \n    Asynchronous example:\n  \n    ```js\n    findAuthor().catch(function(reason){\n      return findOtherAuther();\n    }).finally(function(){\n      // author was either found, or not\n    });\n    ```\n  \n    @method finally\n    @param {Function} callback\n    @return {Promise}\n  */\n\n\n  Promise.prototype.finally = function _finally(callback) {\n    var promise = this;\n    var constructor = promise.constructor;\n\n    if (isFunction(callback)) {\n      return promise.then(function (value) {\n        return constructor.resolve(callback()).then(function () {\n          return value;\n        });\n      }, function (reason) {\n        return constructor.resolve(callback()).then(function () {\n          throw reason;\n        });\n      });\n    }\n\n    return promise.then(callback, callback);\n  };\n\n  return Promise;\n}();\n\nPromise$1.prototype.then = then;\nPromise$1.all = all;\nPromise$1.race = race;\nPromise$1.resolve = resolve$1;\nPromise$1.reject = reject$1;\nPromise$1._setScheduler = setScheduler;\nPromise$1._setAsap = setAsap;\nPromise$1._asap = asap;\n\n/*global self*/\nfunction polyfill() {\n  var local = void 0;\n\n  if (typeof global !== 'undefined') {\n    local = global;\n  } else if (typeof self !== 'undefined') {\n    local = self;\n  } else {\n    try {\n      local = Function('return this')();\n    } catch (e) {\n      throw new Error('polyfill failed because global object is unavailable in this environment');\n    }\n  }\n\n  var P = local.Promise;\n\n  if (P) {\n    var promiseToString = null;\n    try {\n      promiseToString = Object.prototype.toString.call(P.resolve());\n    } catch (e) {\n      // silently ignored\n    }\n\n    if (promiseToString === '[object Promise]' && !P.cast) {\n      return;\n    }\n  }\n\n  local.Promise = Promise$1;\n}\n\n// Strange compat..\nPromise$1.polyfill = polyfill;\nPromise$1.Promise = Promise$1;\n\nreturn Promise$1;\n\n})));\n\n\n\n\n\n}).call(this,_dereq_('_process'),typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n\n},{\"_process\":3}],2:[function(_dereq_,module,exports){\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n},{}],3:[function(_dereq_,module,exports){\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n},{}],4:[function(_dereq_,module,exports){\nvar bundleFn = arguments[3];\nvar sources = arguments[4];\nvar cache = arguments[5];\n\nvar stringify = JSON.stringify;\n\nmodule.exports = function (fn, options) {\n    var wkey;\n    var cacheKeys = Object.keys(cache);\n\n    for (var i = 0, l = cacheKeys.length; i < l; i++) {\n        var key = cacheKeys[i];\n        var exp = cache[key].exports;\n        // Using babel as a transpiler to use esmodule, the export will always\n        // be an object with the default export as a property of it. To ensure\n        // the existing api and babel esmodule exports are both supported we\n        // check for both\n        if (exp === fn || exp && exp.default === fn) {\n            wkey = key;\n            break;\n        }\n    }\n\n    if (!wkey) {\n        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n        var wcache = {};\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\n            var key = cacheKeys[i];\n            wcache[key] = key;\n        }\n        sources[wkey] = [\n            'function(require,module,exports){' + fn + '(self); }',\n            wcache\n        ];\n    }\n    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n\n    var scache = {}; scache[wkey] = wkey;\n    sources[skey] = [\n        'function(require,module,exports){' +\n            // try to call default if defined to also support babel esmodule exports\n            'var f = require(' + stringify(wkey) + ');' +\n            '(f.default ? f.default : f)(self);' +\n        '}',\n        scache\n    ];\n\n    var workerSources = {};\n    resolveSources(skey);\n\n    function resolveSources(key) {\n        workerSources[key] = true;\n\n        for (var depPath in sources[key][1]) {\n            var depKey = sources[key][1][depPath];\n            if (!workerSources[depKey]) {\n                resolveSources(depKey);\n            }\n        }\n    }\n\n    var src = '(' + bundleFn + ')({'\n        + Object.keys(workerSources).map(function (key) {\n            return stringify(key) + ':['\n                + sources[key][0]\n                + ',' + stringify(sources[key][1]) + ']'\n            ;\n        }).join(',')\n        + '},{},[' + stringify(skey) + '])'\n    ;\n\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    var blob = new Blob([src], { type: 'text/javascript' });\n    if (options && options.bare) { return blob; }\n    var workerUrl = URL.createObjectURL(blob);\n    var worker = new Worker(workerUrl);\n    worker.objectURL = workerUrl;\n    return worker;\n};\n\n},{}],5:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.createDefaultConfig = createDefaultConfig;\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar defaultConfig = exports.defaultConfig = {\n    enableWorker: false,\n    enableStashBuffer: true,\n    stashInitialSize: undefined,\n\n    isLive: false,\n\n    lazyLoad: true,\n    lazyLoadMaxDuration: 3 * 60,\n    lazyLoadRecoverDuration: 30,\n    deferLoadAfterSourceOpen: true,\n\n    // autoCleanupSourceBuffer: default as false, leave unspecified\n    autoCleanupMaxBackwardDuration: 3 * 60,\n    autoCleanupMinBackwardDuration: 2 * 60,\n\n    statisticsInfoReportInterval: 600,\n\n    fixAudioTimestampGap: true,\n\n    accurateSeek: false,\n    seekType: 'range', // [range, param, custom]\n    seekParamStart: 'bstart',\n    seekParamEnd: 'bend',\n    rangeLoadZeroStart: false,\n    customSeekHandler: undefined,\n    reuseRedirectedURL: false,\n    // referrerPolicy: leave as unspecified\n\n    headers: undefined,\n    customLoader: undefined\n};\n\nfunction createDefaultConfig() {\n    return Object.assign({}, defaultConfig);\n}\n\n},{}],6:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _ioController = _dereq_('../io/io-controller.js');\n\nvar _ioController2 = _interopRequireDefault(_ioController);\n\nvar _config = _dereq_('../config.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Features = function () {\n    function Features() {\n        _classCallCheck(this, Features);\n    }\n\n    _createClass(Features, null, [{\n        key: 'supportMSEH264Playback',\n        value: function supportMSEH264Playback() {\n            return window.MediaSource && window.MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"');\n        }\n    }, {\n        key: 'supportNetworkStreamIO',\n        value: function supportNetworkStreamIO() {\n            var ioctl = new _ioController2.default({}, (0, _config.createDefaultConfig)());\n            var loaderType = ioctl.loaderType;\n            ioctl.destroy();\n            return loaderType == 'fetch-stream-loader' || loaderType == 'xhr-moz-chunked-loader';\n        }\n    }, {\n        key: 'getNetworkLoaderTypeName',\n        value: function getNetworkLoaderTypeName() {\n            var ioctl = new _ioController2.default({}, (0, _config.createDefaultConfig)());\n            var loaderType = ioctl.loaderType;\n            ioctl.destroy();\n            return loaderType;\n        }\n    }, {\n        key: 'supportNativeMediaPlayback',\n        value: function supportNativeMediaPlayback(mimeType) {\n            if (Features.videoElement == undefined) {\n                Features.videoElement = window.document.createElement('video');\n            }\n            var canPlay = Features.videoElement.canPlayType(mimeType);\n            return canPlay === 'probably' || canPlay == 'maybe';\n        }\n    }, {\n        key: 'getFeatureList',\n        value: function getFeatureList() {\n            var features = {\n                mseFlvPlayback: false,\n                mseLiveFlvPlayback: false,\n                networkStreamIO: false,\n                networkLoaderName: '',\n                nativeMP4H264Playback: false,\n                nativeWebmVP8Playback: false,\n                nativeWebmVP9Playback: false\n            };\n\n            features.mseFlvPlayback = Features.supportMSEH264Playback();\n            features.networkStreamIO = Features.supportNetworkStreamIO();\n            features.networkLoaderName = Features.getNetworkLoaderTypeName();\n            features.mseLiveFlvPlayback = features.mseFlvPlayback && features.networkStreamIO;\n            features.nativeMP4H264Playback = Features.supportNativeMediaPlayback('video/mp4; codecs=\"avc1.42001E, mp4a.40.2\"');\n            features.nativeWebmVP8Playback = Features.supportNativeMediaPlayback('video/webm; codecs=\"vp8.0, vorbis\"');\n            features.nativeWebmVP9Playback = Features.supportNativeMediaPlayback('video/webm; codecs=\"vp9\"');\n\n            return features;\n        }\n    }]);\n\n    return Features;\n}();\n\nexports.default = Features;\n\n},{\"../config.js\":5,\"../io/io-controller.js\":23}],7:[function(_dereq_,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar MediaInfo = function () {\n    function MediaInfo() {\n        _classCallCheck(this, MediaInfo);\n\n        this.mimeType = null;\n        this.duration = null;\n\n        this.hasAudio = null;\n        this.hasVideo = null;\n        this.audioCodec = null;\n        this.videoCodec = null;\n        this.audioDataRate = null;\n        this.videoDataRate = null;\n\n        this.audioSampleRate = null;\n        this.audioChannelCount = null;\n\n        this.width = null;\n        this.height = null;\n        this.fps = null;\n        this.profile = null;\n        this.level = null;\n        this.refFrames = null;\n        this.chromaFormat = null;\n        this.sarNum = null;\n        this.sarDen = null;\n\n        this.metadata = null;\n        this.segments = null; // MediaInfo[]\n        this.segmentCount = null;\n        this.hasKeyframesIndex = null;\n        this.keyframesIndex = null;\n    }\n\n    _createClass(MediaInfo, [{\n        key: \"isComplete\",\n        value: function isComplete() {\n            var audioInfoComplete = this.hasAudio === false || this.hasAudio === true && this.audioCodec != null && this.audioSampleRate != null && this.audioChannelCount != null;\n\n            var videoInfoComplete = this.hasVideo === false || this.hasVideo === true && this.videoCodec != null && this.width != null && this.height != null && this.fps != null && this.profile != null && this.level != null && this.refFrames != null && this.chromaFormat != null && this.sarNum != null && this.sarDen != null;\n\n            // keyframesIndex may not be present\n            return this.mimeType != null && this.duration != null && this.metadata != null && this.hasKeyframesIndex != null && audioInfoComplete && videoInfoComplete;\n        }\n    }, {\n        key: \"isSeekable\",\n        value: function isSeekable() {\n            return this.hasKeyframesIndex === true;\n        }\n    }, {\n        key: \"getNearestKeyframe\",\n        value: function getNearestKeyframe(milliseconds) {\n            if (this.keyframesIndex == null) {\n                return null;\n            }\n\n            var table = this.keyframesIndex;\n            var keyframeIdx = this._search(table.times, milliseconds);\n\n            return {\n                index: keyframeIdx,\n                milliseconds: table.times[keyframeIdx],\n                fileposition: table.filepositions[keyframeIdx]\n            };\n        }\n    }, {\n        key: \"_search\",\n        value: function _search(list, value) {\n            var idx = 0;\n\n            var last = list.length - 1;\n            var mid = 0;\n            var lbound = 0;\n            var ubound = last;\n\n            if (value < list[0]) {\n                idx = 0;\n                lbound = ubound + 1; // skip search\n            }\n\n            while (lbound <= ubound) {\n                mid = lbound + Math.floor((ubound - lbound) / 2);\n                if (mid === last || value >= list[mid] && value < list[mid + 1]) {\n                    idx = mid;\n                    break;\n                } else if (list[mid] < value) {\n                    lbound = mid + 1;\n                } else {\n                    ubound = mid - 1;\n                }\n            }\n\n            return idx;\n        }\n    }]);\n\n    return MediaInfo;\n}();\n\nexports.default = MediaInfo;\n\n},{}],8:[function(_dereq_,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n// Represents an media sample (audio / video)\nvar SampleInfo = exports.SampleInfo = function SampleInfo(dts, pts, duration, originalDts, isSync) {\n    _classCallCheck(this, SampleInfo);\n\n    this.dts = dts;\n    this.pts = pts;\n    this.duration = duration;\n    this.originalDts = originalDts;\n    this.isSyncPoint = isSync;\n    this.fileposition = null;\n};\n\n// Media Segment concept is defined in Media Source Extensions spec.\n// Particularly in ISO BMFF format, an Media Segment contains a moof box followed by a mdat box.\n\n\nvar MediaSegmentInfo = exports.MediaSegmentInfo = function () {\n    function MediaSegmentInfo() {\n        _classCallCheck(this, MediaSegmentInfo);\n\n        this.beginDts = 0;\n        this.endDts = 0;\n        this.beginPts = 0;\n        this.endPts = 0;\n        this.originalBeginDts = 0;\n        this.originalEndDts = 0;\n        this.syncPoints = []; // SampleInfo[n], for video IDR frames only\n        this.firstSample = null; // SampleInfo\n        this.lastSample = null; // SampleInfo\n    }\n\n    _createClass(MediaSegmentInfo, [{\n        key: \"appendSyncPoint\",\n        value: function appendSyncPoint(sampleInfo) {\n            // also called Random Access Point\n            sampleInfo.isSyncPoint = true;\n            this.syncPoints.push(sampleInfo);\n        }\n    }]);\n\n    return MediaSegmentInfo;\n}();\n\n// Ordered list for recording video IDR frames, sorted by originalDts\n\n\nvar IDRSampleList = exports.IDRSampleList = function () {\n    function IDRSampleList() {\n        _classCallCheck(this, IDRSampleList);\n\n        this._list = [];\n    }\n\n    _createClass(IDRSampleList, [{\n        key: \"clear\",\n        value: function clear() {\n            this._list = [];\n        }\n    }, {\n        key: \"appendArray\",\n        value: function appendArray(syncPoints) {\n            var list = this._list;\n\n            if (syncPoints.length === 0) {\n                return;\n            }\n\n            if (list.length > 0 && syncPoints[0].originalDts < list[list.length - 1].originalDts) {\n                this.clear();\n            }\n\n            Array.prototype.push.apply(list, syncPoints);\n        }\n    }, {\n        key: \"getLastSyncPointBeforeDts\",\n        value: function getLastSyncPointBeforeDts(dts) {\n            if (this._list.length == 0) {\n                return null;\n            }\n\n            var list = this._list;\n            var idx = 0;\n            var last = list.length - 1;\n            var mid = 0;\n            var lbound = 0;\n            var ubound = last;\n\n            if (dts < list[0].dts) {\n                idx = 0;\n                lbound = ubound + 1;\n            }\n\n            while (lbound <= ubound) {\n                mid = lbound + Math.floor((ubound - lbound) / 2);\n                if (mid === last || dts >= list[mid].dts && dts < list[mid + 1].dts) {\n                    idx = mid;\n                    break;\n                } else if (list[mid].dts < dts) {\n                    lbound = mid + 1;\n                } else {\n                    ubound = mid - 1;\n                }\n            }\n            return this._list[idx];\n        }\n    }]);\n\n    return IDRSampleList;\n}();\n\n// Data structure for recording information of media segments in single track.\n\n\nvar MediaSegmentInfoList = exports.MediaSegmentInfoList = function () {\n    function MediaSegmentInfoList(type) {\n        _classCallCheck(this, MediaSegmentInfoList);\n\n        this._type = type;\n        this._list = [];\n        this._lastAppendLocation = -1; // cached last insert location\n    }\n\n    _createClass(MediaSegmentInfoList, [{\n        key: \"isEmpty\",\n        value: function isEmpty() {\n            return this._list.length === 0;\n        }\n    }, {\n        key: \"clear\",\n        value: function clear() {\n            this._list = [];\n            this._lastAppendLocation = -1;\n        }\n    }, {\n        key: \"_searchNearestSegmentBefore\",\n        value: function _searchNearestSegmentBefore(originalBeginDts) {\n            var list = this._list;\n            if (list.length === 0) {\n                return -2;\n            }\n            var last = list.length - 1;\n            var mid = 0;\n            var lbound = 0;\n            var ubound = last;\n\n            var idx = 0;\n\n            if (originalBeginDts < list[0].originalBeginDts) {\n                idx = -1;\n                return idx;\n            }\n\n            while (lbound <= ubound) {\n                mid = lbound + Math.floor((ubound - lbound) / 2);\n                if (mid === last || originalBeginDts > list[mid].lastSample.originalDts && originalBeginDts < list[mid + 1].originalBeginDts) {\n                    idx = mid;\n                    break;\n                } else if (list[mid].originalBeginDts < originalBeginDts) {\n                    lbound = mid + 1;\n                } else {\n                    ubound = mid - 1;\n                }\n            }\n            return idx;\n        }\n    }, {\n        key: \"_searchNearestSegmentAfter\",\n        value: function _searchNearestSegmentAfter(originalBeginDts) {\n            return this._searchNearestSegmentBefore(originalBeginDts) + 1;\n        }\n    }, {\n        key: \"append\",\n        value: function append(mediaSegmentInfo) {\n            var list = this._list;\n            var msi = mediaSegmentInfo;\n            var lastAppendIdx = this._lastAppendLocation;\n            var insertIdx = 0;\n\n            if (lastAppendIdx !== -1 && lastAppendIdx < list.length && msi.originalBeginDts >= list[lastAppendIdx].lastSample.originalDts && (lastAppendIdx === list.length - 1 || lastAppendIdx < list.length - 1 && msi.originalBeginDts < list[lastAppendIdx + 1].originalBeginDts)) {\n                insertIdx = lastAppendIdx + 1; // use cached location idx\n            } else {\n                if (list.length > 0) {\n                    insertIdx = this._searchNearestSegmentBefore(msi.originalBeginDts) + 1;\n                }\n            }\n\n            this._lastAppendLocation = insertIdx;\n            this._list.splice(insertIdx, 0, msi);\n        }\n    }, {\n        key: \"getLastSegmentBefore\",\n        value: function getLastSegmentBefore(originalBeginDts) {\n            var idx = this._searchNearestSegmentBefore(originalBeginDts);\n            if (idx >= 0) {\n                return this._list[idx];\n            } else {\n                // -1\n                return null;\n            }\n        }\n    }, {\n        key: \"getLastSampleBefore\",\n        value: function getLastSampleBefore(originalBeginDts) {\n            var segment = this.getLastSegmentBefore(originalBeginDts);\n            if (segment != null) {\n                return segment.lastSample;\n            } else {\n                return null;\n            }\n        }\n    }, {\n        key: \"getLastSyncPointBefore\",\n        value: function getLastSyncPointBefore(originalBeginDts) {\n            var segmentIdx = this._searchNearestSegmentBefore(originalBeginDts);\n            var syncPoints = this._list[segmentIdx].syncPoints;\n            while (syncPoints.length === 0 && segmentIdx > 0) {\n                segmentIdx--;\n                syncPoints = this._list[segmentIdx].syncPoints;\n            }\n            if (syncPoints.length > 0) {\n                return syncPoints[syncPoints.length - 1];\n            } else {\n                return null;\n            }\n        }\n    }, {\n        key: \"type\",\n        get: function get() {\n            return this._type;\n        }\n    }, {\n        key: \"length\",\n        get: function get() {\n            return this._list.length;\n        }\n    }]);\n\n    return MediaSegmentInfoList;\n}();\n\n},{}],9:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _browser = _dereq_('../utils/browser.js');\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _mseEvents = _dereq_('./mse-events.js');\n\nvar _mseEvents2 = _interopRequireDefault(_mseEvents);\n\nvar _mediaSegmentInfo = _dereq_('./media-segment-info.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Media Source Extensions controller\nvar MSEController = function () {\n    function MSEController(config) {\n        _classCallCheck(this, MSEController);\n\n        this.TAG = 'MSEController';\n\n        this._config = config;\n        this._emitter = new _events2.default();\n\n        if (this._config.isLive && this._config.autoCleanupSourceBuffer == undefined) {\n            // For live stream, do auto cleanup by default\n            this._config.autoCleanupSourceBuffer = true;\n        }\n\n        this.e = {\n            onSourceOpen: this._onSourceOpen.bind(this),\n            onSourceEnded: this._onSourceEnded.bind(this),\n            onSourceClose: this._onSourceClose.bind(this),\n            onSourceBufferError: this._onSourceBufferError.bind(this),\n            onSourceBufferUpdateEnd: this._onSourceBufferUpdateEnd.bind(this)\n        };\n\n        this._mediaSource = null;\n        this._mediaSourceObjectURL = null;\n        this._mediaElement = null;\n\n        this._isBufferFull = false;\n        this._hasPendingEos = false;\n\n        this._requireSetMediaDuration = false;\n        this._pendingMediaDuration = 0;\n\n        this._pendingSourceBufferInit = [];\n        this._mimeTypes = {\n            video: null,\n            audio: null\n        };\n        this._sourceBuffers = {\n            video: null,\n            audio: null\n        };\n        this._lastInitSegments = {\n            video: null,\n            audio: null\n        };\n        this._pendingSegments = {\n            video: [],\n            audio: []\n        };\n        this._pendingRemoveRanges = {\n            video: [],\n            audio: []\n        };\n        this._idrList = new _mediaSegmentInfo.IDRSampleList();\n    }\n\n    _createClass(MSEController, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._mediaElement || this._mediaSource) {\n                this.detachMediaElement();\n            }\n            this.e = null;\n            this._emitter.removeAllListeners();\n            this._emitter = null;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, listener) {\n            this._emitter.addListener(event, listener);\n        }\n    }, {\n        key: 'off',\n        value: function off(event, listener) {\n            this._emitter.removeListener(event, listener);\n        }\n    }, {\n        key: 'attachMediaElement',\n        value: function attachMediaElement(mediaElement) {\n            if (this._mediaSource) {\n                throw new _exception.IllegalStateException('MediaSource has been attached to an HTMLMediaElement!');\n            }\n            var ms = this._mediaSource = new window.MediaSource();\n            ms.addEventListener('sourceopen', this.e.onSourceOpen);\n            ms.addEventListener('sourceended', this.e.onSourceEnded);\n            ms.addEventListener('sourceclose', this.e.onSourceClose);\n\n            this._mediaElement = mediaElement;\n            this._mediaSourceObjectURL = window.URL.createObjectURL(this._mediaSource);\n            mediaElement.src = this._mediaSourceObjectURL;\n        }\n    }, {\n        key: 'detachMediaElement',\n        value: function detachMediaElement() {\n            if (this._mediaSource) {\n                var ms = this._mediaSource;\n                for (var type in this._sourceBuffers) {\n                    // pending segments should be discard\n                    var ps = this._pendingSegments[type];\n                    ps.splice(0, ps.length);\n                    this._pendingSegments[type] = null;\n                    this._pendingRemoveRanges[type] = null;\n                    this._lastInitSegments[type] = null;\n\n                    // remove all sourcebuffers\n                    var sb = this._sourceBuffers[type];\n                    if (sb) {\n                        if (ms.readyState !== 'closed') {\n                            // ms edge can throw an error: Unexpected call to method or property access\n                            try {\n                                ms.removeSourceBuffer(sb);\n                            } catch (error) {\n                                _logger2.default.e(this.TAG, error.message);\n                            }\n                            sb.removeEventListener('error', this.e.onSourceBufferError);\n                            sb.removeEventListener('updateend', this.e.onSourceBufferUpdateEnd);\n                        }\n                        this._mimeTypes[type] = null;\n                        this._sourceBuffers[type] = null;\n                    }\n                }\n                if (ms.readyState === 'open') {\n                    try {\n                        ms.endOfStream();\n                    } catch (error) {\n                        _logger2.default.e(this.TAG, error.message);\n                    }\n                }\n                ms.removeEventListener('sourceopen', this.e.onSourceOpen);\n                ms.removeEventListener('sourceended', this.e.onSourceEnded);\n                ms.removeEventListener('sourceclose', this.e.onSourceClose);\n                this._pendingSourceBufferInit = [];\n                this._isBufferFull = false;\n                this._idrList.clear();\n                this._mediaSource = null;\n            }\n\n            if (this._mediaElement) {\n                this._mediaElement.src = '';\n                this._mediaElement.removeAttribute('src');\n                this._mediaElement = null;\n            }\n            if (this._mediaSourceObjectURL) {\n                window.URL.revokeObjectURL(this._mediaSourceObjectURL);\n                this._mediaSourceObjectURL = null;\n            }\n        }\n    }, {\n        key: 'appendInitSegment',\n        value: function appendInitSegment(initSegment, deferred) {\n            if (!this._mediaSource || this._mediaSource.readyState !== 'open') {\n                // sourcebuffer creation requires mediaSource.readyState === 'open'\n                // so we defer the sourcebuffer creation, until sourceopen event triggered\n                this._pendingSourceBufferInit.push(initSegment);\n                // make sure that this InitSegment is in the front of pending segments queue\n                this._pendingSegments[initSegment.type].push(initSegment);\n                return;\n            }\n\n            var is = initSegment;\n            var mimeType = '' + is.container;\n            if (is.codec && is.codec.length > 0) {\n                mimeType += ';codecs=' + is.codec;\n            }\n\n            var firstInitSegment = false;\n\n            _logger2.default.v(this.TAG, 'Received Initialization Segment, mimeType: ' + mimeType);\n            this._lastInitSegments[is.type] = is;\n\n            if (mimeType !== this._mimeTypes[is.type]) {\n                if (!this._mimeTypes[is.type]) {\n                    // empty, first chance create sourcebuffer\n                    firstInitSegment = true;\n                    try {\n                        var sb = this._sourceBuffers[is.type] = this._mediaSource.addSourceBuffer(mimeType);\n                        sb.addEventListener('error', this.e.onSourceBufferError);\n                        sb.addEventListener('updateend', this.e.onSourceBufferUpdateEnd);\n                    } catch (error) {\n                        _logger2.default.e(this.TAG, error.message);\n                        this._emitter.emit(_mseEvents2.default.ERROR, { code: error.code, msg: error.message });\n                        return;\n                    }\n                } else {\n                    _logger2.default.v(this.TAG, 'Notice: ' + is.type + ' mimeType changed, origin: ' + this._mimeTypes[is.type] + ', target: ' + mimeType);\n                }\n                this._mimeTypes[is.type] = mimeType;\n            }\n\n            if (!deferred) {\n                // deferred means this InitSegment has been pushed to pendingSegments queue\n                this._pendingSegments[is.type].push(is);\n            }\n            if (!firstInitSegment) {\n                // append immediately only if init segment in subsequence\n                if (this._sourceBuffers[is.type] && !this._sourceBuffers[is.type].updating) {\n                    this._doAppendSegments();\n                }\n            }\n            if (_browser2.default.safari && is.container === 'audio/mpeg' && is.mediaDuration > 0) {\n                // 'audio/mpeg' track under Safari may cause MediaElement's duration to be NaN\n                // Manually correct MediaSource.duration to make progress bar seekable, and report right duration\n                this._requireSetMediaDuration = true;\n                this._pendingMediaDuration = is.mediaDuration / 1000; // in seconds\n                this._updateMediaSourceDuration();\n            }\n        }\n    }, {\n        key: 'appendMediaSegment',\n        value: function appendMediaSegment(mediaSegment) {\n            var ms = mediaSegment;\n            this._pendingSegments[ms.type].push(ms);\n\n            if (this._config.autoCleanupSourceBuffer && this._needCleanupSourceBuffer()) {\n                this._doCleanupSourceBuffer();\n            }\n\n            var sb = this._sourceBuffers[ms.type];\n            if (sb && !sb.updating && !this._hasPendingRemoveRanges()) {\n                this._doAppendSegments();\n            }\n        }\n    }, {\n        key: 'seek',\n        value: function seek(seconds) {\n            // remove all appended buffers\n            for (var type in this._sourceBuffers) {\n                if (!this._sourceBuffers[type]) {\n                    continue;\n                }\n\n                // abort current buffer append algorithm\n                var sb = this._sourceBuffers[type];\n                if (this._mediaSource.readyState === 'open') {\n                    try {\n                        // If range removal algorithm is running, InvalidStateError will be throwed\n                        // Ignore it.\n                        sb.abort();\n                    } catch (error) {\n                        _logger2.default.e(this.TAG, error.message);\n                    }\n                }\n\n                // IDRList should be clear\n                this._idrList.clear();\n\n                // pending segments should be discard\n                var ps = this._pendingSegments[type];\n                ps.splice(0, ps.length);\n\n                if (this._mediaSource.readyState === 'closed') {\n                    // Parent MediaSource object has been detached from HTMLMediaElement\n                    continue;\n                }\n\n                // record ranges to be remove from SourceBuffer\n                for (var i = 0; i < sb.buffered.length; i++) {\n                    var start = sb.buffered.start(i);\n                    var end = sb.buffered.end(i);\n                    this._pendingRemoveRanges[type].push({ start: start, end: end });\n                }\n\n                // if sb is not updating, let's remove ranges now!\n                if (!sb.updating) {\n                    this._doRemoveRanges();\n                }\n\n                // Safari 10 may get InvalidStateError in the later appendBuffer() after SourceBuffer.remove() call\n                // Internal parser's state may be invalid at this time. Re-append last InitSegment to workaround.\n                // Related issue: https://bugs.webkit.org/show_bug.cgi?id=159230\n                if (_browser2.default.safari) {\n                    var lastInitSegment = this._lastInitSegments[type];\n                    if (lastInitSegment) {\n                        this._pendingSegments[type].push(lastInitSegment);\n                        if (!sb.updating) {\n                            this._doAppendSegments();\n                        }\n                    }\n                }\n            }\n        }\n    }, {\n        key: 'endOfStream',\n        value: function endOfStream() {\n            var ms = this._mediaSource;\n            var sb = this._sourceBuffers;\n            if (!ms || ms.readyState !== 'open') {\n                if (ms && ms.readyState === 'closed' && this._hasPendingSegments()) {\n                    // If MediaSource hasn't turned into open state, and there're pending segments\n                    // Mark pending endOfStream, defer call until all pending segments appended complete\n                    this._hasPendingEos = true;\n                }\n                return;\n            }\n            if (sb.video && sb.video.updating || sb.audio && sb.audio.updating) {\n                // If any sourcebuffer is updating, defer endOfStream operation\n                // See _onSourceBufferUpdateEnd()\n                this._hasPendingEos = true;\n            } else {\n                this._hasPendingEos = false;\n                // Notify media data loading complete\n                // This is helpful for correcting total duration to match last media segment\n                // Otherwise MediaElement's ended event may not be triggered\n                ms.endOfStream();\n            }\n        }\n    }, {\n        key: 'getNearestKeyframe',\n        value: function getNearestKeyframe(dts) {\n            return this._idrList.getLastSyncPointBeforeDts(dts);\n        }\n    }, {\n        key: '_needCleanupSourceBuffer',\n        value: function _needCleanupSourceBuffer() {\n            if (!this._config.autoCleanupSourceBuffer) {\n                return false;\n            }\n\n            var currentTime = this._mediaElement.currentTime;\n\n            for (var type in this._sourceBuffers) {\n                var sb = this._sourceBuffers[type];\n                if (sb) {\n                    var buffered = sb.buffered;\n                    if (buffered.length >= 1) {\n                        if (currentTime - buffered.start(0) >= this._config.autoCleanupMaxBackwardDuration) {\n                            return true;\n                        }\n                    }\n                }\n            }\n\n            return false;\n        }\n    }, {\n        key: '_doCleanupSourceBuffer',\n        value: function _doCleanupSourceBuffer() {\n            var currentTime = this._mediaElement.currentTime;\n\n            for (var type in this._sourceBuffers) {\n                var sb = this._sourceBuffers[type];\n                if (sb) {\n                    var buffered = sb.buffered;\n                    var doRemove = false;\n\n                    for (var i = 0; i < buffered.length; i++) {\n                        var start = buffered.start(i);\n                        var end = buffered.end(i);\n\n                        if (start <= currentTime && currentTime < end + 3) {\n                            // padding 3 seconds\n                            if (currentTime - start >= this._config.autoCleanupMaxBackwardDuration) {\n                                doRemove = true;\n                                var removeEnd = currentTime - this._config.autoCleanupMinBackwardDuration;\n                                this._pendingRemoveRanges[type].push({ start: start, end: removeEnd });\n                            }\n                        } else if (end < currentTime) {\n                            doRemove = true;\n                            this._pendingRemoveRanges[type].push({ start: start, end: end });\n                        }\n                    }\n\n                    if (doRemove && !sb.updating) {\n                        this._doRemoveRanges();\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_updateMediaSourceDuration',\n        value: function _updateMediaSourceDuration() {\n            var sb = this._sourceBuffers;\n            if (this._mediaElement.readyState === 0 || this._mediaSource.readyState !== 'open') {\n                return;\n            }\n            if (sb.video && sb.video.updating || sb.audio && sb.audio.updating) {\n                return;\n            }\n\n            var current = this._mediaSource.duration;\n            var target = this._pendingMediaDuration;\n\n            if (target > 0 && (isNaN(current) || target > current)) {\n                _logger2.default.v(this.TAG, 'Update MediaSource duration from ' + current + ' to ' + target);\n                this._mediaSource.duration = target;\n            }\n\n            this._requireSetMediaDuration = false;\n            this._pendingMediaDuration = 0;\n        }\n    }, {\n        key: '_doRemoveRanges',\n        value: function _doRemoveRanges() {\n            for (var type in this._pendingRemoveRanges) {\n                if (!this._sourceBuffers[type] || this._sourceBuffers[type].updating) {\n                    continue;\n                }\n                var sb = this._sourceBuffers[type];\n                var ranges = this._pendingRemoveRanges[type];\n                while (ranges.length && !sb.updating) {\n                    var range = ranges.shift();\n                    sb.remove(range.start, range.end);\n                }\n            }\n        }\n    }, {\n        key: '_doAppendSegments',\n        value: function _doAppendSegments() {\n            var pendingSegments = this._pendingSegments;\n\n            for (var type in pendingSegments) {\n                if (!this._sourceBuffers[type] || this._sourceBuffers[type].updating) {\n                    continue;\n                }\n\n                if (pendingSegments[type].length > 0) {\n                    var segment = pendingSegments[type].shift();\n\n                    if (segment.timestampOffset) {\n                        // For MPEG audio stream in MSE, if unbuffered-seeking occurred\n                        // We need explicitly set timestampOffset to the desired point in timeline for mpeg SourceBuffer.\n                        var currentOffset = this._sourceBuffers[type].timestampOffset;\n                        var targetOffset = segment.timestampOffset / 1000; // in seconds\n\n                        var delta = Math.abs(currentOffset - targetOffset);\n                        if (delta > 0.1) {\n                            // If time delta > 100ms\n                            _logger2.default.v(this.TAG, 'Update MPEG audio timestampOffset from ' + currentOffset + ' to ' + targetOffset);\n                            this._sourceBuffers[type].timestampOffset = targetOffset;\n                        }\n                        delete segment.timestampOffset;\n                    }\n\n                    if (!segment.data || segment.data.byteLength === 0) {\n                        // Ignore empty buffer\n                        continue;\n                    }\n\n                    try {\n                        this._sourceBuffers[type].appendBuffer(segment.data);\n                        this._isBufferFull = false;\n                        if (type === 'video' && segment.hasOwnProperty('info')) {\n                            this._idrList.appendArray(segment.info.syncPoints);\n                        }\n                    } catch (error) {\n                        this._pendingSegments[type].unshift(segment);\n                        if (error.code === 22) {\n                            // QuotaExceededError\n                            /* Notice that FireFox may not throw QuotaExceededError if SourceBuffer is full\r\n                             * Currently we can only do lazy-load to avoid SourceBuffer become scattered.\r\n                             * SourceBuffer eviction policy may be changed in future version of FireFox.\r\n                             *\r\n                             * Related issues:\r\n                             * https://bugzilla.mozilla.org/show_bug.cgi?id=1279885\r\n                             * https://bugzilla.mozilla.org/show_bug.cgi?id=1280023\r\n                             */\n\n                            // report buffer full, abort network IO\n                            if (!this._isBufferFull) {\n                                this._emitter.emit(_mseEvents2.default.BUFFER_FULL);\n                            }\n                            this._isBufferFull = true;\n                        } else {\n                            _logger2.default.e(this.TAG, error.message);\n                            this._emitter.emit(_mseEvents2.default.ERROR, { code: error.code, msg: error.message });\n                        }\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_onSourceOpen',\n        value: function _onSourceOpen() {\n            _logger2.default.v(this.TAG, 'MediaSource onSourceOpen');\n            this._mediaSource.removeEventListener('sourceopen', this.e.onSourceOpen);\n            // deferred sourcebuffer creation / initialization\n            if (this._pendingSourceBufferInit.length > 0) {\n                var pendings = this._pendingSourceBufferInit;\n                while (pendings.length) {\n                    var segment = pendings.shift();\n                    this.appendInitSegment(segment, true);\n                }\n            }\n            // there may be some pending media segments, append them\n            if (this._hasPendingSegments()) {\n                this._doAppendSegments();\n            }\n            this._emitter.emit(_mseEvents2.default.SOURCE_OPEN);\n        }\n    }, {\n        key: '_onSourceEnded',\n        value: function _onSourceEnded() {\n            // fired on endOfStream\n            _logger2.default.v(this.TAG, 'MediaSource onSourceEnded');\n            this._emitter.emit(_mseEvents2.default.SOURCE_END, 'MediaSource onSourceEnded');\n        }\n    }, {\n        key: '_onSourceClose',\n        value: function _onSourceClose() {\n            // fired on detaching from media element\n            _logger2.default.v(this.TAG, 'MediaSource onSourceClose');\n            if (this._mediaSource && this.e != null) {\n                this._mediaSource.removeEventListener('sourceopen', this.e.onSourceOpen);\n                this._mediaSource.removeEventListener('sourceended', this.e.onSourceEnded);\n                this._mediaSource.removeEventListener('sourceclose', this.e.onSourceClose);\n            }\n        }\n    }, {\n        key: '_hasPendingSegments',\n        value: function _hasPendingSegments() {\n            var ps = this._pendingSegments;\n            return ps.video.length > 0 || ps.audio.length > 0;\n        }\n    }, {\n        key: '_hasPendingRemoveRanges',\n        value: function _hasPendingRemoveRanges() {\n            var prr = this._pendingRemoveRanges;\n            return prr.video.length > 0 || prr.audio.length > 0;\n        }\n    }, {\n        key: '_onSourceBufferUpdateEnd',\n        value: function _onSourceBufferUpdateEnd() {\n            if (this._requireSetMediaDuration) {\n                this._updateMediaSourceDuration();\n            } else if (this._hasPendingRemoveRanges()) {\n                this._doRemoveRanges();\n            } else if (this._hasPendingSegments()) {\n                this._doAppendSegments();\n            } else if (this._hasPendingEos) {\n                this.endOfStream();\n            }\n            this._emitter.emit(_mseEvents2.default.UPDATE_END);\n        }\n    }, {\n        key: '_onSourceBufferError',\n        value: function _onSourceBufferError(e) {\n            _logger2.default.e(this.TAG, 'SourceBuffer Error: ' + e);\n            // this error might not always be fatal, just ignore it\n        }\n    }]);\n\n    return MSEController;\n}();\n\nexports.default = MSEController;\n\n},{\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./media-segment-info.js\":8,\"./mse-events.js\":10,\"events\":2}],10:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar MSEEvents = {\n  ERROR: 'error',\n  SOURCE_OPEN: 'source_open',\n  UPDATE_END: 'update_end',\n  BUFFER_FULL: 'buffer_full',\n  SOURCE_END: 'source_end'\n};\n\nexports.default = MSEEvents;\n\n},{}],11:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _loggingControl = _dereq_('../utils/logging-control.js');\n\nvar _loggingControl2 = _interopRequireDefault(_loggingControl);\n\nvar _transmuxingController = _dereq_('./transmuxing-controller.js');\n\nvar _transmuxingController2 = _interopRequireDefault(_transmuxingController);\n\nvar _transmuxingEvents = _dereq_('./transmuxing-events.js');\n\nvar _transmuxingEvents2 = _interopRequireDefault(_transmuxingEvents);\n\nvar _transmuxingWorker = _dereq_('./transmuxing-worker.js');\n\nvar _transmuxingWorker2 = _interopRequireDefault(_transmuxingWorker);\n\nvar _mediaInfo = _dereq_('./media-info.js');\n\nvar _mediaInfo2 = _interopRequireDefault(_mediaInfo);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Transmuxer = function () {\n    function Transmuxer(mediaDataSource, config) {\n        _classCallCheck(this, Transmuxer);\n\n        this.TAG = 'Transmuxer';\n        this._emitter = new _events2.default();\n\n        if (config.enableWorker && typeof Worker !== 'undefined') {\n            try {\n                var work = _dereq_('webworkify');\n                this._worker = work(_transmuxingWorker2.default);\n                this._workerDestroying = false;\n                this._worker.addEventListener('message', this._onWorkerMessage.bind(this));\n                this._worker.postMessage({ cmd: 'init', param: [mediaDataSource, config] });\n                this.e = {\n                    onLoggingConfigChanged: this._onLoggingConfigChanged.bind(this)\n                };\n                _loggingControl2.default.registerListener(this.e.onLoggingConfigChanged);\n                this._worker.postMessage({ cmd: 'logging_config', param: _loggingControl2.default.getConfig() });\n            } catch (error) {\n                _logger2.default.e(this.TAG, 'Error while initialize transmuxing worker, fallback to inline transmuxing');\n                this._worker = null;\n                this._controller = new _transmuxingController2.default(mediaDataSource, config);\n            }\n        } else {\n            this._controller = new _transmuxingController2.default(mediaDataSource, config);\n        }\n\n        if (this._controller) {\n            var ctl = this._controller;\n            ctl.on(_transmuxingEvents2.default.IO_ERROR, this._onIOError.bind(this));\n            ctl.on(_transmuxingEvents2.default.DEMUX_ERROR, this._onDemuxError.bind(this));\n            ctl.on(_transmuxingEvents2.default.INIT_SEGMENT, this._onInitSegment.bind(this));\n            ctl.on(_transmuxingEvents2.default.MEDIA_SEGMENT, this._onMediaSegment.bind(this));\n            ctl.on(_transmuxingEvents2.default.LOADING_COMPLETE, this._onLoadingComplete.bind(this));\n            ctl.on(_transmuxingEvents2.default.RECOVERED_EARLY_EOF, this._onRecoveredEarlyEof.bind(this));\n            ctl.on(_transmuxingEvents2.default.MEDIA_INFO, this._onMediaInfo.bind(this));\n            ctl.on(_transmuxingEvents2.default.METADATA_ARRIVED, this._onMetaDataArrived.bind(this));\n            ctl.on(_transmuxingEvents2.default.SCRIPTDATA_ARRIVED, this._onScriptDataArrived.bind(this));\n            ctl.on(_transmuxingEvents2.default.STATISTICS_INFO, this._onStatisticsInfo.bind(this));\n            ctl.on(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, this._onRecommendSeekpoint.bind(this));\n            ctl.on(_transmuxingEvents2.default.STREAM_TIME, this._onStreamTime.bind(this));\n        }\n    }\n\n    _createClass(Transmuxer, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._worker) {\n                if (!this._workerDestroying) {\n                    this._workerDestroying = true;\n                    this._worker.postMessage({ cmd: 'destroy' });\n                    _loggingControl2.default.removeListener(this.e.onLoggingConfigChanged);\n                    this.e = null;\n                }\n            } else {\n                this._controller.destroy();\n                this._controller = null;\n            }\n            this._emitter.removeAllListeners();\n            this._emitter = null;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, listener) {\n            this._emitter.addListener(event, listener);\n        }\n    }, {\n        key: 'off',\n        value: function off(event, listener) {\n            this._emitter.removeListener(event, listener);\n        }\n    }, {\n        key: 'hasWorker',\n        value: function hasWorker() {\n            return this._worker != null;\n        }\n    }, {\n        key: 'open',\n        value: function open() {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'start' });\n            } else {\n                this._controller.start();\n            }\n        }\n    }, {\n        key: 'close',\n        value: function close() {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'stop' });\n            } else {\n                this._controller.stop();\n            }\n        }\n    }, {\n        key: 'seek',\n        value: function seek(milliseconds) {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'seek', param: milliseconds });\n            } else {\n                this._controller.seek(milliseconds);\n            }\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'pause' });\n            } else {\n                this._controller.pause();\n            }\n        }\n    }, {\n        key: 'resume',\n        value: function resume() {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'resume' });\n            } else {\n                this._controller.resume();\n            }\n        }\n    }, {\n        key: '_onInitSegment',\n        value: function _onInitSegment(type, initSegment) {\n            var _this = this;\n\n            // do async invoke\n            Promise.resolve().then(function () {\n                _this._emitter.emit(_transmuxingEvents2.default.INIT_SEGMENT, type, initSegment);\n            });\n        }\n    }, {\n        key: '_onMediaSegment',\n        value: function _onMediaSegment(type, mediaSegment) {\n            var _this2 = this;\n\n            Promise.resolve().then(function () {\n                _this2._emitter.emit(_transmuxingEvents2.default.MEDIA_SEGMENT, type, mediaSegment);\n            });\n        }\n    }, {\n        key: '_onLoadingComplete',\n        value: function _onLoadingComplete() {\n            var _this3 = this;\n\n            Promise.resolve().then(function () {\n                _this3._emitter.emit(_transmuxingEvents2.default.LOADING_COMPLETE);\n            });\n        }\n    }, {\n        key: '_onRecoveredEarlyEof',\n        value: function _onRecoveredEarlyEof() {\n            var _this4 = this;\n\n            Promise.resolve().then(function () {\n                _this4._emitter.emit(_transmuxingEvents2.default.RECOVERED_EARLY_EOF);\n            });\n        }\n    }, {\n        key: '_onMediaInfo',\n        value: function _onMediaInfo(mediaInfo) {\n            var _this5 = this;\n\n            Promise.resolve().then(function () {\n                _this5._emitter.emit(_transmuxingEvents2.default.MEDIA_INFO, mediaInfo);\n            });\n        }\n    }, {\n        key: '_onMetaDataArrived',\n        value: function _onMetaDataArrived(metadata) {\n            var _this6 = this;\n\n            Promise.resolve().then(function () {\n                _this6._emitter.emit(_transmuxingEvents2.default.METADATA_ARRIVED, metadata);\n            });\n        }\n    }, {\n        key: '_onScriptDataArrived',\n        value: function _onScriptDataArrived(data) {\n            var _this7 = this;\n\n            Promise.resolve().then(function () {\n                _this7._emitter.emit(_transmuxingEvents2.default.SCRIPTDATA_ARRIVED, data);\n            });\n        }\n    }, {\n        key: '_onStatisticsInfo',\n        value: function _onStatisticsInfo(statisticsInfo) {\n            var _this8 = this;\n\n            Promise.resolve().then(function () {\n                _this8._emitter.emit(_transmuxingEvents2.default.STATISTICS_INFO, statisticsInfo);\n            });\n        }\n    }, {\n        key: '_onIOError',\n        value: function _onIOError(type, info) {\n            var _this9 = this;\n\n            Promise.resolve().then(function () {\n                _this9._emitter.emit(_transmuxingEvents2.default.IO_ERROR, type, info);\n            });\n        }\n    }, {\n        key: '_onDemuxError',\n        value: function _onDemuxError(type, info) {\n            var _this10 = this;\n\n            Promise.resolve().then(function () {\n                _this10._emitter.emit(_transmuxingEvents2.default.DEMUX_ERROR, type, info);\n            });\n        }\n    }, {\n        key: '_onRecommendSeekpoint',\n        value: function _onRecommendSeekpoint(milliseconds) {\n            var _this11 = this;\n\n            Promise.resolve().then(function () {\n                _this11._emitter.emit(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, milliseconds);\n            });\n        }\n    }, {\n        key: '_onStreamTime',\n        value: function _onStreamTime(time) {\n            var _this12 = this;\n\n            Promise.resolve().then(function () {\n                _this12._emitter.emit(_transmuxingEvents2.default.STREAM_TIME, time);\n            });\n        }\n    }, {\n        key: '_onLoggingConfigChanged',\n        value: function _onLoggingConfigChanged(config) {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'logging_config', param: config });\n            }\n        }\n    }, {\n        key: '_onWorkerMessage',\n        value: function _onWorkerMessage(e) {\n            var message = e.data;\n            var data = message.data;\n\n            if (message.msg === 'destroyed' || this._workerDestroying) {\n                this._workerDestroying = false;\n                this._worker.terminate();\n                this._worker = null;\n                return;\n            }\n\n            switch (message.msg) {\n                case _transmuxingEvents2.default.INIT_SEGMENT:\n                case _transmuxingEvents2.default.MEDIA_SEGMENT:\n                    this._emitter.emit(message.msg, data.type, data.data);\n                    break;\n                case _transmuxingEvents2.default.LOADING_COMPLETE:\n                case _transmuxingEvents2.default.RECOVERED_EARLY_EOF:\n                    this._emitter.emit(message.msg);\n                    break;\n                case _transmuxingEvents2.default.MEDIA_INFO:\n                    Object.setPrototypeOf(data, _mediaInfo2.default.prototype);\n                    this._emitter.emit(message.msg, data);\n                    break;\n                case _transmuxingEvents2.default.METADATA_ARRIVED:\n                case _transmuxingEvents2.default.SCRIPTDATA_ARRIVED:\n                case _transmuxingEvents2.default.STATISTICS_INFO:\n                    this._emitter.emit(message.msg, data);\n                    break;\n                case _transmuxingEvents2.default.IO_ERROR:\n                case _transmuxingEvents2.default.DEMUX_ERROR:\n                    this._emitter.emit(message.msg, data.type, data.info);\n                    break;\n                case _transmuxingEvents2.default.RECOMMEND_SEEKPOINT:\n                    this._emitter.emit(message.msg, data);\n                    break;\n                case 'logcat_callback':\n                    _logger2.default.emitter.emit('log', data.type, data.logcat);\n                    break;\n                default:\n                    break;\n            }\n        }\n    }]);\n\n    return Transmuxer;\n}();\n\nexports.default = Transmuxer;\n\n},{\"../utils/logger.js\":41,\"../utils/logging-control.js\":42,\"./media-info.js\":7,\"./transmuxing-controller.js\":12,\"./transmuxing-events.js\":13,\"./transmuxing-worker.js\":14,\"events\":2,\"webworkify\":4}],12:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _browser = _dereq_('../utils/browser.js');\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _mediaInfo = _dereq_('./media-info.js');\n\nvar _mediaInfo2 = _interopRequireDefault(_mediaInfo);\n\nvar _flvDemuxer = _dereq_('../demux/flv-demuxer.js');\n\nvar _flvDemuxer2 = _interopRequireDefault(_flvDemuxer);\n\nvar _mp4Remuxer = _dereq_('../remux/mp4-remuxer.js');\n\nvar _mp4Remuxer2 = _interopRequireDefault(_mp4Remuxer);\n\nvar _demuxErrors = _dereq_('../demux/demux-errors.js');\n\nvar _demuxErrors2 = _interopRequireDefault(_demuxErrors);\n\nvar _ioController = _dereq_('../io/io-controller.js');\n\nvar _ioController2 = _interopRequireDefault(_ioController);\n\nvar _transmuxingEvents = _dereq_('./transmuxing-events.js');\n\nvar _transmuxingEvents2 = _interopRequireDefault(_transmuxingEvents);\n\nvar _loader = _dereq_('../io/loader.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Transmuxing (IO, Demuxing, Remuxing) controller, with multipart support\nvar TransmuxingController = function () {\n    function TransmuxingController(mediaDataSource, config) {\n        _classCallCheck(this, TransmuxingController);\n\n        this.TAG = 'TransmuxingController';\n        this._emitter = new _events2.default();\n\n        this._config = config;\n\n        // treat single part media as multipart media, which has only one segment\n        if (!mediaDataSource.segments) {\n            mediaDataSource.segments = [{\n                duration: mediaDataSource.duration,\n                filesize: mediaDataSource.filesize,\n                url: mediaDataSource.url\n            }];\n        }\n\n        // fill in default IO params if not exists\n        if (typeof mediaDataSource.cors !== 'boolean') {\n            mediaDataSource.cors = true;\n        }\n        if (typeof mediaDataSource.withCredentials !== 'boolean') {\n            mediaDataSource.withCredentials = false;\n        }\n\n        this._mediaDataSource = mediaDataSource;\n        this._currentSegmentIndex = 0;\n        var totalDuration = 0;\n\n        this._mediaDataSource.segments.forEach(function (segment) {\n            // timestampBase for each segment, and calculate total duration\n            segment.timestampBase = totalDuration;\n            totalDuration += segment.duration;\n            // params needed by IOController\n            segment.cors = mediaDataSource.cors;\n            segment.withCredentials = mediaDataSource.withCredentials;\n            // referrer policy control, if exist\n            if (config.referrerPolicy) {\n                segment.referrerPolicy = config.referrerPolicy;\n            }\n        });\n\n        if (!isNaN(totalDuration) && this._mediaDataSource.duration !== totalDuration) {\n            this._mediaDataSource.duration = totalDuration;\n        }\n\n        this._mediaInfo = null;\n        this._demuxer = null;\n        this._remuxer = null;\n        this._ioctl = null;\n\n        this._pendingSeekTime = null;\n        this._pendingResolveSeekPoint = null;\n\n        this._statisticsReporter = null;\n    }\n\n    _createClass(TransmuxingController, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._mediaInfo = null;\n            this._mediaDataSource = null;\n\n            if (this._statisticsReporter) {\n                this._disableStatisticsReporter();\n            }\n            if (this._ioctl) {\n                this._ioctl.destroy();\n                this._ioctl = null;\n            }\n            if (this._demuxer) {\n                this._demuxer.destroy();\n                this._demuxer = null;\n            }\n            if (this._remuxer) {\n                this._remuxer.destroy();\n                this._remuxer = null;\n            }\n\n            this._emitter.removeAllListeners();\n            this._emitter = null;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, listener) {\n            this._emitter.addListener(event, listener);\n        }\n    }, {\n        key: 'off',\n        value: function off(event, listener) {\n            this._emitter.removeListener(event, listener);\n        }\n    }, {\n        key: 'start',\n        value: function start() {\n            this._loadSegment(0);\n            this._enableStatisticsReporter();\n        }\n    }, {\n        key: '_loadSegment',\n        value: function _loadSegment(segmentIndex, optionalFrom) {\n            this._currentSegmentIndex = segmentIndex;\n            var dataSource = this._mediaDataSource.segments[segmentIndex];\n\n            var ioctl = this._ioctl = new _ioController2.default(dataSource, this._config, segmentIndex);\n            ioctl.onError = this._onIOException.bind(this);\n            ioctl.onSeeked = this._onIOSeeked.bind(this);\n            ioctl.onComplete = this._onIOComplete.bind(this);\n            ioctl.onRedirect = this._onIORedirect.bind(this);\n            ioctl.onRecoveredEarlyEof = this._onIORecoveredEarlyEof.bind(this);\n\n            if (optionalFrom) {\n                this._demuxer.bindDataSource(this._ioctl);\n            } else {\n                ioctl.onDataArrival = this._onInitChunkArrival.bind(this);\n            }\n\n            ioctl.open(optionalFrom);\n        }\n    }, {\n        key: 'stop',\n        value: function stop() {\n            this._internalAbort();\n            this._disableStatisticsReporter();\n        }\n    }, {\n        key: '_internalAbort',\n        value: function _internalAbort() {\n            if (this._ioctl) {\n                this._ioctl.destroy();\n                this._ioctl = null;\n            }\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            // take a rest\n            if (this._ioctl && this._ioctl.isWorking()) {\n                this._ioctl.pause();\n                this._disableStatisticsReporter();\n            }\n        }\n    }, {\n        key: 'resume',\n        value: function resume() {\n            if (this._ioctl && this._ioctl.isPaused()) {\n                this._ioctl.resume();\n                this._enableStatisticsReporter();\n            }\n        }\n    }, {\n        key: 'seek',\n        value: function seek(milliseconds) {\n            if (this._mediaInfo == null || !this._mediaInfo.isSeekable()) {\n                return;\n            }\n\n            var targetSegmentIndex = this._searchSegmentIndexContains(milliseconds);\n\n            if (targetSegmentIndex === this._currentSegmentIndex) {\n                // intra-segment seeking\n                var segmentInfo = this._mediaInfo.segments[targetSegmentIndex];\n\n                if (segmentInfo == undefined) {\n                    // current segment loading started, but mediainfo hasn't received yet\n                    // wait for the metadata loaded, then seek to expected position\n                    this._pendingSeekTime = milliseconds;\n                } else {\n                    var keyframe = segmentInfo.getNearestKeyframe(milliseconds);\n                    this._remuxer.seek(keyframe.milliseconds);\n                    this._ioctl.seek(keyframe.fileposition);\n                    // Will be resolved in _onRemuxerMediaSegmentArrival()\n                    this._pendingResolveSeekPoint = keyframe.milliseconds;\n                }\n            } else {\n                // cross-segment seeking\n                var targetSegmentInfo = this._mediaInfo.segments[targetSegmentIndex];\n\n                if (targetSegmentInfo == undefined) {\n                    // target segment hasn't been loaded. We need metadata then seek to expected time\n                    this._pendingSeekTime = milliseconds;\n                    this._internalAbort();\n                    this._remuxer.seek();\n                    this._remuxer.insertDiscontinuity();\n                    this._loadSegment(targetSegmentIndex);\n                    // Here we wait for the metadata loaded, then seek to expected position\n                } else {\n                    // We have target segment's metadata, direct seek to target position\n                    var _keyframe = targetSegmentInfo.getNearestKeyframe(milliseconds);\n                    this._internalAbort();\n                    this._remuxer.seek(milliseconds);\n                    this._remuxer.insertDiscontinuity();\n                    this._demuxer.resetMediaInfo();\n                    this._demuxer.timestampBase = this._mediaDataSource.segments[targetSegmentIndex].timestampBase;\n                    this._loadSegment(targetSegmentIndex, _keyframe.fileposition);\n                    this._pendingResolveSeekPoint = _keyframe.milliseconds;\n                    this._reportSegmentMediaInfo(targetSegmentIndex);\n                }\n            }\n\n            this._enableStatisticsReporter();\n        }\n    }, {\n        key: '_searchSegmentIndexContains',\n        value: function _searchSegmentIndexContains(milliseconds) {\n            var segments = this._mediaDataSource.segments;\n            var idx = segments.length - 1;\n\n            for (var i = 0; i < segments.length; i++) {\n                if (milliseconds < segments[i].timestampBase) {\n                    idx = i - 1;\n                    break;\n                }\n            }\n            return idx;\n        }\n    }, {\n        key: '_onInitChunkArrival',\n        value: function _onInitChunkArrival(data, byteStart) {\n            var _this = this;\n\n            var probeData = null;\n            var consumed = 0;\n\n            if (byteStart > 0) {\n                // IOController seeked immediately after opened, byteStart > 0 callback may received\n                this._demuxer.bindDataSource(this._ioctl);\n                this._demuxer.timestampBase = this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase;\n\n                consumed = this._demuxer.parseChunks(data, byteStart);\n            } else if ((probeData = _flvDemuxer2.default.probe(data)).match) {\n                // Always create new FLVDemuxer\n                this._demuxer = new _flvDemuxer2.default(probeData, this._config);\n\n                if (!this._remuxer) {\n                    this._remuxer = new _mp4Remuxer2.default(this._config);\n                }\n\n                var mds = this._mediaDataSource;\n                if (mds.duration != undefined && !isNaN(mds.duration)) {\n                    this._demuxer.overridedDuration = mds.duration;\n                }\n                if (typeof mds.hasAudio === 'boolean') {\n                    this._demuxer.overridedHasAudio = mds.hasAudio;\n                }\n                if (typeof mds.hasVideo === 'boolean') {\n                    this._demuxer.overridedHasVideo = mds.hasVideo;\n                }\n\n                this._demuxer.timestampBase = mds.segments[this._currentSegmentIndex].timestampBase;\n\n                this._demuxer.onError = this._onDemuxException.bind(this);\n                this._demuxer.onMediaInfo = this._onMediaInfo.bind(this);\n                this._demuxer.onMetaDataArrived = this._onMetaDataArrived.bind(this);\n                this._demuxer.onScriptDataArrived = this._onScriptDataArrived.bind(this);\n                this._demuxer.onStreamTime = this._onStreamTime.bind(this);\n\n                this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl));\n\n                this._remuxer.onInitSegment = this._onRemuxerInitSegmentArrival.bind(this);\n                this._remuxer.onMediaSegment = this._onRemuxerMediaSegmentArrival.bind(this);\n\n                consumed = this._demuxer.parseChunks(data, byteStart);\n            } else {\n                probeData = null;\n                _logger2.default.e(this.TAG, 'Non-FLV, Unsupported media type!');\n                Promise.resolve().then(function () {\n                    _this._internalAbort();\n                });\n                this._emitter.emit(_transmuxingEvents2.default.DEMUX_ERROR, _demuxErrors2.default.FORMAT_UNSUPPORTED, 'Non-FLV, Unsupported media type');\n\n                consumed = 0;\n            }\n\n            return consumed;\n        }\n    }, {\n        key: '_onMediaInfo',\n        value: function _onMediaInfo(mediaInfo) {\n            var _this2 = this;\n\n            if (this._mediaInfo == null) {\n                // Store first segment's mediainfo as global mediaInfo\n                this._mediaInfo = Object.assign({}, mediaInfo);\n                this._mediaInfo.keyframesIndex = null;\n                this._mediaInfo.segments = [];\n                this._mediaInfo.segmentCount = this._mediaDataSource.segments.length;\n                Object.setPrototypeOf(this._mediaInfo, _mediaInfo2.default.prototype);\n            }\n\n            var segmentInfo = Object.assign({}, mediaInfo);\n            Object.setPrototypeOf(segmentInfo, _mediaInfo2.default.prototype);\n            this._mediaInfo.segments[this._currentSegmentIndex] = segmentInfo;\n\n            // notify mediaInfo update\n            this._reportSegmentMediaInfo(this._currentSegmentIndex);\n\n            if (this._pendingSeekTime != null) {\n                Promise.resolve().then(function () {\n                    var target = _this2._pendingSeekTime;\n                    _this2._pendingSeekTime = null;\n                    _this2.seek(target);\n                });\n            }\n        }\n    }, {\n        key: '_onMetaDataArrived',\n        value: function _onMetaDataArrived(metadata) {\n            this._emitter.emit(_transmuxingEvents2.default.METADATA_ARRIVED, metadata);\n        }\n    }, {\n        key: '_onScriptDataArrived',\n        value: function _onScriptDataArrived(data) {\n            this._emitter.emit(_transmuxingEvents2.default.SCRIPTDATA_ARRIVED, data);\n        }\n    }, {\n        key: '_onStreamTime',\n        value: function _onStreamTime(time) {\n            this._emitter.emit(_transmuxingEvents2.default.STREAM_TIME, time);\n        }\n    }, {\n        key: '_onIOSeeked',\n        value: function _onIOSeeked() {\n            this._remuxer.insertDiscontinuity();\n        }\n    }, {\n        key: '_onIOComplete',\n        value: function _onIOComplete(extraData) {\n            var segmentIndex = extraData;\n            var nextSegmentIndex = segmentIndex + 1;\n\n            if (nextSegmentIndex < this._mediaDataSource.segments.length) {\n                this._internalAbort();\n                this._remuxer.flushStashedSamples();\n                this._loadSegment(nextSegmentIndex);\n            } else {\n                this._remuxer.flushStashedSamples();\n                this._emitter.emit(_transmuxingEvents2.default.LOADING_COMPLETE);\n                this._disableStatisticsReporter();\n            }\n        }\n    }, {\n        key: '_onIORedirect',\n        value: function _onIORedirect(redirectedURL) {\n            var segmentIndex = this._ioctl.extraData;\n            this._mediaDataSource.segments[segmentIndex].redirectedURL = redirectedURL;\n        }\n    }, {\n        key: '_onIORecoveredEarlyEof',\n        value: function _onIORecoveredEarlyEof() {\n            this._emitter.emit(_transmuxingEvents2.default.RECOVERED_EARLY_EOF);\n        }\n    }, {\n        key: '_onIOException',\n        value: function _onIOException(type, info) {\n            _logger2.default.e(this.TAG, 'IOException: type = ' + type + ', code = ' + info.code + ', msg = ' + info.msg);\n            this._emitter.emit(_transmuxingEvents2.default.IO_ERROR, type, info);\n            this._disableStatisticsReporter();\n        }\n    }, {\n        key: '_onDemuxException',\n        value: function _onDemuxException(type, info) {\n            _logger2.default.e(this.TAG, 'DemuxException: type = ' + type + ', info = ' + info);\n            this._emitter.emit(_transmuxingEvents2.default.DEMUX_ERROR, type, info);\n        }\n    }, {\n        key: '_onRemuxerInitSegmentArrival',\n        value: function _onRemuxerInitSegmentArrival(type, initSegment) {\n            this._emitter.emit(_transmuxingEvents2.default.INIT_SEGMENT, type, initSegment);\n        }\n    }, {\n        key: '_onRemuxerMediaSegmentArrival',\n        value: function _onRemuxerMediaSegmentArrival(type, mediaSegment) {\n            if (this._pendingSeekTime != null) {\n                // Media segments after new-segment cross-seeking should be dropped.\n                return;\n            }\n            this._emitter.emit(_transmuxingEvents2.default.MEDIA_SEGMENT, type, mediaSegment);\n\n            // Resolve pending seekPoint\n            if (this._pendingResolveSeekPoint != null && type === 'video') {\n                var syncPoints = mediaSegment.info.syncPoints;\n                var seekpoint = this._pendingResolveSeekPoint;\n                this._pendingResolveSeekPoint = null;\n\n                // Safari: Pass PTS for recommend_seekpoint\n                if (_browser2.default.safari && syncPoints.length > 0 && syncPoints[0].originalDts === seekpoint) {\n                    seekpoint = syncPoints[0].pts;\n                }\n                // else: use original DTS (keyframe.milliseconds)\n\n                this._emitter.emit(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, seekpoint);\n            }\n        }\n    }, {\n        key: '_enableStatisticsReporter',\n        value: function _enableStatisticsReporter() {\n            if (this._statisticsReporter == null) {\n                this._statisticsReporter = self.setInterval(this._reportStatisticsInfo.bind(this), this._config.statisticsInfoReportInterval);\n            }\n        }\n    }, {\n        key: '_disableStatisticsReporter',\n        value: function _disableStatisticsReporter() {\n            if (this._statisticsReporter) {\n                self.clearInterval(this._statisticsReporter);\n                this._statisticsReporter = null;\n            }\n        }\n    }, {\n        key: '_reportSegmentMediaInfo',\n        value: function _reportSegmentMediaInfo(segmentIndex) {\n            var segmentInfo = this._mediaInfo.segments[segmentIndex];\n            var exportInfo = Object.assign({}, segmentInfo);\n\n            exportInfo.duration = this._mediaInfo.duration;\n            exportInfo.segmentCount = this._mediaInfo.segmentCount;\n            delete exportInfo.segments;\n            delete exportInfo.keyframesIndex;\n\n            this._emitter.emit(_transmuxingEvents2.default.MEDIA_INFO, exportInfo);\n        }\n    }, {\n        key: '_reportStatisticsInfo',\n        value: function _reportStatisticsInfo() {\n            var info = {};\n\n            info.url = this._ioctl.currentURL;\n            info.hasRedirect = this._ioctl.hasRedirect;\n            if (info.hasRedirect) {\n                info.redirectedURL = this._ioctl.currentRedirectedURL;\n            }\n\n            info.speed = this._ioctl.currentSpeed;\n            info.loaderType = this._ioctl.loaderType;\n            info.currentSegmentIndex = this._currentSegmentIndex;\n            info.totalSegmentCount = this._mediaDataSource.segments.length;\n\n            this._emitter.emit(_transmuxingEvents2.default.STATISTICS_INFO, info);\n        }\n    }]);\n\n    return TransmuxingController;\n}();\n\nexports.default = TransmuxingController;\n\n},{\"../demux/demux-errors.js\":16,\"../demux/flv-demuxer.js\":18,\"../io/io-controller.js\":23,\"../io/loader.js\":24,\"../remux/mp4-remuxer.js\":38,\"../utils/browser.js\":39,\"../utils/logger.js\":41,\"./media-info.js\":7,\"./transmuxing-events.js\":13,\"events\":2}],13:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar TransmuxingEvents = {\n  IO_ERROR: 'io_error',\n  DEMUX_ERROR: 'demux_error',\n  INIT_SEGMENT: 'init_segment',\n  MEDIA_SEGMENT: 'media_segment',\n  LOADING_COMPLETE: 'loading_complete',\n  RECOVERED_EARLY_EOF: 'recovered_early_eof',\n  MEDIA_INFO: 'media_info',\n  METADATA_ARRIVED: 'metadata_arrived',\n  SCRIPTDATA_ARRIVED: 'scriptdata_arrived',\n  STATISTICS_INFO: 'statistics_info',\n  RECOMMEND_SEEKPOINT: 'recommend_seekpoint',\n  STREAM_TIME: 'stream_time'\n};\n\nexports.default = TransmuxingEvents;\n\n},{}],14:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _loggingControl = _dereq_('../utils/logging-control.js');\n\nvar _loggingControl2 = _interopRequireDefault(_loggingControl);\n\nvar _polyfill = _dereq_('../utils/polyfill.js');\n\nvar _polyfill2 = _interopRequireDefault(_polyfill);\n\nvar _transmuxingController = _dereq_('./transmuxing-controller.js');\n\nvar _transmuxingController2 = _interopRequireDefault(_transmuxingController);\n\nvar _transmuxingEvents = _dereq_('./transmuxing-events.js');\n\nvar _transmuxingEvents2 = _interopRequireDefault(_transmuxingEvents);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/* post message to worker:\r\n   data: {\r\n       cmd: string\r\n       param: any\r\n   }\r\n\r\n   receive message from worker:\r\n   data: {\r\n       msg: string,\r\n       data: any\r\n   }\r\n */\n\nvar TransmuxingWorker = function TransmuxingWorker(self) {\n\n    var TAG = 'TransmuxingWorker';\n    var controller = null;\n    var logcatListener = onLogcatCallback.bind(this);\n\n    _polyfill2.default.install();\n\n    self.addEventListener('message', function (e) {\n        switch (e.data.cmd) {\n            case 'init':\n                controller = new _transmuxingController2.default(e.data.param[0], e.data.param[1]);\n                controller.on(_transmuxingEvents2.default.IO_ERROR, onIOError.bind(this));\n                controller.on(_transmuxingEvents2.default.DEMUX_ERROR, onDemuxError.bind(this));\n                controller.on(_transmuxingEvents2.default.INIT_SEGMENT, onInitSegment.bind(this));\n                controller.on(_transmuxingEvents2.default.MEDIA_SEGMENT, onMediaSegment.bind(this));\n                controller.on(_transmuxingEvents2.default.LOADING_COMPLETE, onLoadingComplete.bind(this));\n                controller.on(_transmuxingEvents2.default.RECOVERED_EARLY_EOF, onRecoveredEarlyEof.bind(this));\n                controller.on(_transmuxingEvents2.default.MEDIA_INFO, onMediaInfo.bind(this));\n                controller.on(_transmuxingEvents2.default.METADATA_ARRIVED, onMetaDataArrived.bind(this));\n                controller.on(_transmuxingEvents2.default.SCRIPTDATA_ARRIVED, onScriptDataArrived.bind(this));\n                controller.on(_transmuxingEvents2.default.STATISTICS_INFO, onStatisticsInfo.bind(this));\n                controller.on(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, onRecommendSeekpoint.bind(this));\n                break;\n            case 'destroy':\n                if (controller) {\n                    controller.destroy();\n                    controller = null;\n                }\n                self.postMessage({ msg: 'destroyed' });\n                break;\n            case 'start':\n                controller.start();\n                break;\n            case 'stop':\n                controller.stop();\n                break;\n            case 'seek':\n                controller.seek(e.data.param);\n                break;\n            case 'pause':\n                controller.pause();\n                break;\n            case 'resume':\n                controller.resume();\n                break;\n            case 'logging_config':\n                {\n                    var config = e.data.param;\n                    _loggingControl2.default.applyConfig(config);\n\n                    if (config.enableCallback === true) {\n                        _loggingControl2.default.addLogListener(logcatListener);\n                    } else {\n                        _loggingControl2.default.removeLogListener(logcatListener);\n                    }\n                    break;\n                }\n        }\n    });\n\n    function onInitSegment(type, initSegment) {\n        var obj = {\n            msg: _transmuxingEvents2.default.INIT_SEGMENT,\n            data: {\n                type: type,\n                data: initSegment\n            }\n        };\n        self.postMessage(obj, [initSegment.data]); // data: ArrayBuffer\n    }\n\n    function onMediaSegment(type, mediaSegment) {\n        var obj = {\n            msg: _transmuxingEvents2.default.MEDIA_SEGMENT,\n            data: {\n                type: type,\n                data: mediaSegment\n            }\n        };\n        self.postMessage(obj, [mediaSegment.data]); // data: ArrayBuffer\n    }\n\n    function onLoadingComplete() {\n        var obj = {\n            msg: _transmuxingEvents2.default.LOADING_COMPLETE\n        };\n        self.postMessage(obj);\n    }\n\n    function onRecoveredEarlyEof() {\n        var obj = {\n            msg: _transmuxingEvents2.default.RECOVERED_EARLY_EOF\n        };\n        self.postMessage(obj);\n    }\n\n    function onMediaInfo(mediaInfo) {\n        var obj = {\n            msg: _transmuxingEvents2.default.MEDIA_INFO,\n            data: mediaInfo\n        };\n        self.postMessage(obj);\n    }\n\n    function onMetaDataArrived(metadata) {\n        var obj = {\n            msg: _transmuxingEvents2.default.METADATA_ARRIVED,\n            data: metadata\n        };\n        self.postMessage(obj);\n    }\n\n    function onScriptDataArrived(data) {\n        var obj = {\n            msg: _transmuxingEvents2.default.SCRIPTDATA_ARRIVED,\n            data: data\n        };\n        self.postMessage(obj);\n    }\n\n    function onStatisticsInfo(statInfo) {\n        var obj = {\n            msg: _transmuxingEvents2.default.STATISTICS_INFO,\n            data: statInfo\n        };\n        self.postMessage(obj);\n    }\n\n    function onIOError(type, info) {\n        self.postMessage({\n            msg: _transmuxingEvents2.default.IO_ERROR,\n            data: {\n                type: type,\n                info: info\n            }\n        });\n    }\n\n    function onDemuxError(type, info) {\n        self.postMessage({\n            msg: _transmuxingEvents2.default.DEMUX_ERROR,\n            data: {\n                type: type,\n                info: info\n            }\n        });\n    }\n\n    function onRecommendSeekpoint(milliseconds) {\n        self.postMessage({\n            msg: _transmuxingEvents2.default.RECOMMEND_SEEKPOINT,\n            data: milliseconds\n        });\n    }\n\n    function onLogcatCallback(type, str) {\n        self.postMessage({\n            msg: 'logcat_callback',\n            data: {\n                type: type,\n                logcat: str\n            }\n        });\n    }\n}; /*\r\n    * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n    *\r\n    * @author zheng qian <xqq@xqq.im>\r\n    *\r\n    * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n    * you may not use this file except in compliance with the License.\r\n    * You may obtain a copy of the License at\r\n    *\r\n    *     http://www.apache.org/licenses/LICENSE-2.0\r\n    *\r\n    * Unless required by applicable law or agreed to in writing, software\r\n    * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n    * See the License for the specific language governing permissions and\r\n    * limitations under the License.\r\n    */\n\nexports.default = TransmuxingWorker;\n\n},{\"../utils/logger.js\":41,\"../utils/logging-control.js\":42,\"../utils/polyfill.js\":43,\"./transmuxing-controller.js\":12,\"./transmuxing-events.js\":13}],15:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _utf8Conv = _dereq_('../utils/utf8-conv.js');\n\nvar _utf8Conv2 = _interopRequireDefault(_utf8Conv);\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar le = function () {\n    var buf = new ArrayBuffer(2);\n    new DataView(buf).setInt16(0, 256, true); // little-endian write\n    return new Int16Array(buf)[0] === 256; // platform-spec read, if equal then LE\n}();\n\nvar AMF = function () {\n    function AMF() {\n        _classCallCheck(this, AMF);\n    }\n\n    _createClass(AMF, null, [{\n        key: 'parseScriptData',\n        value: function parseScriptData(arrayBuffer, dataOffset, dataSize) {\n            var data = {};\n\n            try {\n                var name = AMF.parseValue(arrayBuffer, dataOffset, dataSize);\n                var value = AMF.parseValue(arrayBuffer, dataOffset + name.size, dataSize - name.size);\n\n                data[name.data] = value.data;\n            } catch (e) {\n                _logger2.default.e('AMF', e.toString());\n            }\n\n            return data;\n        }\n    }, {\n        key: 'parseObject',\n        value: function parseObject(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 3) {\n                throw new _exception.IllegalStateException('Data not enough when parse ScriptDataObject');\n            }\n            var name = AMF.parseString(arrayBuffer, dataOffset, dataSize);\n            var value = AMF.parseValue(arrayBuffer, dataOffset + name.size, dataSize - name.size);\n            var isObjectEnd = value.objectEnd;\n\n            return {\n                data: {\n                    name: name.data,\n                    value: value.data\n                },\n                size: name.size + value.size,\n                objectEnd: isObjectEnd\n            };\n        }\n    }, {\n        key: 'parseVariable',\n        value: function parseVariable(arrayBuffer, dataOffset, dataSize) {\n            return AMF.parseObject(arrayBuffer, dataOffset, dataSize);\n        }\n    }, {\n        key: 'parseString',\n        value: function parseString(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 2) {\n                throw new _exception.IllegalStateException('Data not enough when parse String');\n            }\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n            var length = v.getUint16(0, !le);\n\n            var str = void 0;\n            if (length > 0) {\n                str = (0, _utf8Conv2.default)(new Uint8Array(arrayBuffer, dataOffset + 2, length));\n            } else {\n                str = '';\n            }\n\n            return {\n                data: str,\n                size: 2 + length\n            };\n        }\n    }, {\n        key: 'parseLongString',\n        value: function parseLongString(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 4) {\n                throw new _exception.IllegalStateException('Data not enough when parse LongString');\n            }\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n            var length = v.getUint32(0, !le);\n\n            var str = void 0;\n            if (length > 0) {\n                str = (0, _utf8Conv2.default)(new Uint8Array(arrayBuffer, dataOffset + 4, length));\n            } else {\n                str = '';\n            }\n\n            return {\n                data: str,\n                size: 4 + length\n            };\n        }\n    }, {\n        key: 'parseDate',\n        value: function parseDate(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 10) {\n                throw new _exception.IllegalStateException('Data size invalid when parse Date');\n            }\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n            var timestamp = v.getFloat64(0, !le);\n            var localTimeOffset = v.getInt16(8, !le);\n            timestamp += localTimeOffset * 60 * 1000; // get UTC time\n\n            return {\n                data: new Date(timestamp),\n                size: 8 + 2\n            };\n        }\n    }, {\n        key: 'parseValue',\n        value: function parseValue(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 1) {\n                throw new _exception.IllegalStateException('Data not enough when parse Value');\n            }\n\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n            var offset = 1;\n            var type = v.getUint8(0);\n            var value = void 0;\n            var objectEnd = false;\n\n            try {\n                switch (type) {\n                    case 0:\n                        // Number(Double) type\n                        value = v.getFloat64(1, !le);\n                        offset += 8;\n                        break;\n                    case 1:\n                        {\n                            // Boolean type\n                            var b = v.getUint8(1);\n                            value = b ? true : false;\n                            offset += 1;\n                            break;\n                        }\n                    case 2:\n                        {\n                            // String type\n                            var amfstr = AMF.parseString(arrayBuffer, dataOffset + 1, dataSize - 1);\n                            value = amfstr.data;\n                            offset += amfstr.size;\n                            break;\n                        }\n                    case 3:\n                        {\n                            // Object(s) type\n                            value = {};\n                            var terminal = 0; // workaround for malformed Objects which has missing ScriptDataObjectEnd\n                            if ((v.getUint32(dataSize - 4, !le) & 0x00FFFFFF) === 9) {\n                                terminal = 3;\n                            }\n                            while (offset < dataSize - 4) {\n                                // 4 === type(UI8) + ScriptDataObjectEnd(UI24)\n                                var amfobj = AMF.parseObject(arrayBuffer, dataOffset + offset, dataSize - offset - terminal);\n                                if (amfobj.objectEnd) break;\n                                value[amfobj.data.name] = amfobj.data.value;\n                                offset += amfobj.size;\n                            }\n                            if (offset <= dataSize - 3) {\n                                var marker = v.getUint32(offset - 1, !le) & 0x00FFFFFF;\n                                if (marker === 9) {\n                                    offset += 3;\n                                }\n                            }\n                            break;\n                        }\n                    case 8:\n                        {\n                            // ECMA array type (Mixed array)\n                            value = {};\n                            offset += 4; // ECMAArrayLength(UI32)\n                            var _terminal = 0; // workaround for malformed MixedArrays which has missing ScriptDataObjectEnd\n                            if ((v.getUint32(dataSize - 4, !le) & 0x00FFFFFF) === 9) {\n                                _terminal = 3;\n                            }\n                            while (offset < dataSize - 8) {\n                                // 8 === type(UI8) + ECMAArrayLength(UI32) + ScriptDataVariableEnd(UI24)\n                                var amfvar = AMF.parseVariable(arrayBuffer, dataOffset + offset, dataSize - offset - _terminal);\n                                if (amfvar.objectEnd) break;\n                                value[amfvar.data.name] = amfvar.data.value;\n                                offset += amfvar.size;\n                            }\n                            if (offset <= dataSize - 3) {\n                                var _marker = v.getUint32(offset - 1, !le) & 0x00FFFFFF;\n                                if (_marker === 9) {\n                                    offset += 3;\n                                }\n                            }\n                            break;\n                        }\n                    case 9:\n                        // ScriptDataObjectEnd\n                        value = undefined;\n                        offset = 1;\n                        objectEnd = true;\n                        break;\n                    case 10:\n                        {\n                            // Strict array type\n                            // ScriptDataValue[n]. NOTE: according to video_file_format_spec_v10_1.pdf\n                            value = [];\n                            var strictArrayLength = v.getUint32(1, !le);\n                            offset += 4;\n                            for (var i = 0; i < strictArrayLength; i++) {\n                                var val = AMF.parseValue(arrayBuffer, dataOffset + offset, dataSize - offset);\n                                value.push(val.data);\n                                offset += val.size;\n                            }\n                            break;\n                        }\n                    case 11:\n                        {\n                            // Date type\n                            var date = AMF.parseDate(arrayBuffer, dataOffset + 1, dataSize - 1);\n                            value = date.data;\n                            offset += date.size;\n                            break;\n                        }\n                    case 12:\n                        {\n                            // Long string type\n                            var amfLongStr = AMF.parseString(arrayBuffer, dataOffset + 1, dataSize - 1);\n                            value = amfLongStr.data;\n                            offset += amfLongStr.size;\n                            break;\n                        }\n                    default:\n                        // ignore and skip\n                        offset = dataSize;\n                        _logger2.default.w('AMF', 'Unsupported AMF value type ' + type);\n                }\n            } catch (e) {\n                _logger2.default.e('AMF', e.toString());\n            }\n\n            return {\n                data: value,\n                size: offset,\n                objectEnd: objectEnd\n            };\n        }\n    }]);\n\n    return AMF;\n}();\n\nexports.default = AMF;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"../utils/utf8-conv.js\":44}],16:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar DemuxErrors = {\n  OK: 'OK',\n  FORMAT_ERROR: 'FormatError',\n  FORMAT_UNSUPPORTED: 'FormatUnsupported',\n  CODEC_UNSUPPORTED: 'CodecUnsupported'\n};\n\nexports.default = DemuxErrors;\n\n},{}],17:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Exponential-Golomb buffer decoder\nvar ExpGolomb = function () {\n    function ExpGolomb(uint8array) {\n        _classCallCheck(this, ExpGolomb);\n\n        this.TAG = 'ExpGolomb';\n\n        this._buffer = uint8array;\n        this._buffer_index = 0;\n        this._total_bytes = uint8array.byteLength;\n        this._total_bits = uint8array.byteLength * 8;\n        this._current_word = 0;\n        this._current_word_bits_left = 0;\n    }\n\n    _createClass(ExpGolomb, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._buffer = null;\n        }\n    }, {\n        key: '_fillCurrentWord',\n        value: function _fillCurrentWord() {\n            var buffer_bytes_left = this._total_bytes - this._buffer_index;\n            if (buffer_bytes_left <= 0) throw new _exception.IllegalStateException('ExpGolomb: _fillCurrentWord() but no bytes available');\n\n            var bytes_read = Math.min(4, buffer_bytes_left);\n            var word = new Uint8Array(4);\n            word.set(this._buffer.subarray(this._buffer_index, this._buffer_index + bytes_read));\n            this._current_word = new DataView(word.buffer).getUint32(0, false);\n\n            this._buffer_index += bytes_read;\n            this._current_word_bits_left = bytes_read * 8;\n        }\n    }, {\n        key: 'readBits',\n        value: function readBits(bits) {\n            if (bits > 32) throw new _exception.InvalidArgumentException('ExpGolomb: readBits() bits exceeded max 32bits!');\n\n            if (bits <= this._current_word_bits_left) {\n                var _result = this._current_word >>> 32 - bits;\n                this._current_word <<= bits;\n                this._current_word_bits_left -= bits;\n                return _result;\n            }\n\n            var result = this._current_word_bits_left ? this._current_word : 0;\n            result = result >>> 32 - this._current_word_bits_left;\n            var bits_need_left = bits - this._current_word_bits_left;\n\n            this._fillCurrentWord();\n            var bits_read_next = Math.min(bits_need_left, this._current_word_bits_left);\n\n            var result2 = this._current_word >>> 32 - bits_read_next;\n            this._current_word <<= bits_read_next;\n            this._current_word_bits_left -= bits_read_next;\n\n            result = result << bits_read_next | result2;\n            return result;\n        }\n    }, {\n        key: 'readBool',\n        value: function readBool() {\n            return this.readBits(1) === 1;\n        }\n    }, {\n        key: 'readByte',\n        value: function readByte() {\n            return this.readBits(8);\n        }\n    }, {\n        key: '_skipLeadingZero',\n        value: function _skipLeadingZero() {\n            var zero_count = void 0;\n            for (zero_count = 0; zero_count < this._current_word_bits_left; zero_count++) {\n                if (0 !== (this._current_word & 0x80000000 >>> zero_count)) {\n                    this._current_word <<= zero_count;\n                    this._current_word_bits_left -= zero_count;\n                    return zero_count;\n                }\n            }\n            this._fillCurrentWord();\n            return zero_count + this._skipLeadingZero();\n        }\n    }, {\n        key: 'readUEG',\n        value: function readUEG() {\n            // unsigned exponential golomb\n            var leading_zeros = this._skipLeadingZero();\n            return this.readBits(leading_zeros + 1) - 1;\n        }\n    }, {\n        key: 'readSEG',\n        value: function readSEG() {\n            // signed exponential golomb\n            var value = this.readUEG();\n            if (value & 0x01) {\n                return value + 1 >>> 1;\n            } else {\n                return -1 * (value >>> 1);\n            }\n        }\n    }]);\n\n    return ExpGolomb;\n}();\n\nexports.default = ExpGolomb;\n\n},{\"../utils/exception.js\":40}],18:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _amfParser = _dereq_('./amf-parser.js');\n\nvar _amfParser2 = _interopRequireDefault(_amfParser);\n\nvar _spsParser = _dereq_('./sps-parser.js');\n\nvar _spsParser2 = _interopRequireDefault(_spsParser);\n\nvar _demuxErrors = _dereq_('./demux-errors.js');\n\nvar _demuxErrors2 = _interopRequireDefault(_demuxErrors);\n\nvar _mediaInfo = _dereq_('../core/media-info.js');\n\nvar _mediaInfo2 = _interopRequireDefault(_mediaInfo);\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Swap16(src) {\n    return src >>> 8 & 0xFF | (src & 0xFF) << 8;\n}\n\nfunction Swap32(src) {\n    return (src & 0xFF000000) >>> 24 | (src & 0x00FF0000) >>> 8 | (src & 0x0000FF00) << 8 | (src & 0x000000FF) << 24;\n}\n\nfunction ReadBig32(array, index) {\n    return array[index] << 24 | array[index + 1] << 16 | array[index + 2] << 8 | array[index + 3];\n}\n\nvar FLVDemuxer = function () {\n    function FLVDemuxer(probeData, config) {\n        _classCallCheck(this, FLVDemuxer);\n\n        this.TAG = 'FLVDemuxer';\n\n        this._config = config;\n\n        this._onError = null;\n        this._onMediaInfo = null;\n        this._onMetaDataArrived = null;\n        this._onScriptDataArrived = null;\n        this._onTrackMetadata = null;\n        this._onDataAvailable = null;\n        this._onStreamTime = null;\n\n        this._dataOffset = probeData.dataOffset;\n        this._firstParse = true;\n        this._dispatch = false;\n\n        this._hasAudio = probeData.hasAudioTrack;\n        this._hasVideo = probeData.hasVideoTrack;\n\n        this._hasAudioFlagOverrided = false;\n        this._hasVideoFlagOverrided = false;\n\n        this._audioInitialMetadataDispatched = false;\n        this._videoInitialMetadataDispatched = false;\n\n        this._mediaInfo = new _mediaInfo2.default();\n        this._mediaInfo.hasAudio = this._hasAudio;\n        this._mediaInfo.hasVideo = this._hasVideo;\n        this._metadata = null;\n        this._audioMetadata = null;\n        this._videoMetadata = null;\n\n        this._naluLengthSize = 4;\n        this._timestampBase = 0; // int32, in milliseconds\n        this._timescale = 1000;\n        this._duration = 0; // int32, in milliseconds\n        this._durationOverrided = false;\n        this._referenceFrameRate = {\n            fixed: true,\n            fps: 23.976,\n            fps_num: 23976,\n            fps_den: 1000\n        };\n\n        this._flvSoundRateTable = [5500, 11025, 22050, 44100, 48000];\n\n        this._mpegSamplingRates = [96000, 88200, 64000, 48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000, 7350];\n\n        this._mpegAudioV10SampleRateTable = [44100, 48000, 32000, 0];\n        this._mpegAudioV20SampleRateTable = [22050, 24000, 16000, 0];\n        this._mpegAudioV25SampleRateTable = [11025, 12000, 8000, 0];\n\n        this._mpegAudioL1BitRateTable = [0, 32, 64, 96, 128, 160, 192, 224, 256, 288, 320, 352, 384, 416, 448, -1];\n        this._mpegAudioL2BitRateTable = [0, 32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 384, -1];\n        this._mpegAudioL3BitRateTable = [0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, -1];\n\n        this._videoTrack = { type: 'video', id: 1, sequenceNumber: 0, samples: [], length: 0 };\n        this._audioTrack = { type: 'audio', id: 2, sequenceNumber: 0, samples: [], length: 0 };\n\n        this._littleEndian = function () {\n            var buf = new ArrayBuffer(2);\n            new DataView(buf).setInt16(0, 256, true); // little-endian write\n            return new Int16Array(buf)[0] === 256; // platform-spec read, if equal then LE\n        }();\n    }\n\n    _createClass(FLVDemuxer, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._mediaInfo = null;\n            this._metadata = null;\n            this._audioMetadata = null;\n            this._videoMetadata = null;\n            this._videoTrack = null;\n            this._audioTrack = null;\n\n            this._onError = null;\n            this._onMediaInfo = null;\n            this._onMetaDataArrived = null;\n            this._onScriptDataArrived = null;\n            this._onTrackMetadata = null;\n            this._onDataAvailable = null;\n            this._onStreamTime = null;\n        }\n    }, {\n        key: 'bindDataSource',\n        value: function bindDataSource(loader) {\n            loader.onDataArrival = this.parseChunks.bind(this);\n            return this;\n        }\n\n        // prototype: function(type: string, metadata: any): void\n\n    }, {\n        key: 'resetMediaInfo',\n        value: function resetMediaInfo() {\n            this._mediaInfo = new _mediaInfo2.default();\n        }\n    }, {\n        key: '_isInitialMetadataDispatched',\n        value: function _isInitialMetadataDispatched() {\n            if (this._hasAudio && this._hasVideo) {\n                // both audio & video\n                return this._audioInitialMetadataDispatched && this._videoInitialMetadataDispatched;\n            }\n            if (this._hasAudio && !this._hasVideo) {\n                // audio only\n                return this._audioInitialMetadataDispatched;\n            }\n            if (!this._hasAudio && this._hasVideo) {\n                // video only\n                return this._videoInitialMetadataDispatched;\n            }\n            return false;\n        }\n\n        // function parseChunks(chunk: ArrayBuffer, byteStart: number): number;\n\n    }, {\n        key: 'parseChunks',\n        value: function parseChunks(chunk, byteStart) {\n            if (!this._onError || !this._onMediaInfo || !this._onTrackMetadata || !this._onDataAvailable) {\n                throw new _exception.IllegalStateException('Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified');\n            }\n\n            var offset = 0;\n            var le = this._littleEndian;\n\n            if (byteStart === 0) {\n                // buffer with FLV header\n                if (chunk.byteLength > 13) {\n                    var probeData = FLVDemuxer.probe(chunk);\n                    offset = probeData.dataOffset;\n                } else {\n                    return 0;\n                }\n            }\n\n            if (this._firstParse) {\n                // handle PreviousTagSize0 before Tag1\n                this._firstParse = false;\n                if (byteStart + offset !== this._dataOffset) {\n                    _logger2.default.w(this.TAG, 'First time parsing but chunk byteStart invalid!');\n                }\n\n                var v = new DataView(chunk, offset);\n                var prevTagSize0 = v.getUint32(0, !le);\n                if (prevTagSize0 !== 0) {\n                    _logger2.default.w(this.TAG, 'PrevTagSize0 !== 0 !!!');\n                }\n                offset += 4;\n            }\n\n            while (offset < chunk.byteLength) {\n                this._dispatch = true;\n\n                var _v = new DataView(chunk, offset);\n\n                if (offset + 11 + 4 > chunk.byteLength) {\n                    // data not enough for parsing an flv tag\n                    break;\n                }\n\n                var tagType = _v.getUint8(0);\n                var dataSize = _v.getUint32(0, !le) & 0x00FFFFFF;\n\n                if (offset + 11 + dataSize + 4 > chunk.byteLength) {\n                    // data not enough for parsing actual data body\n                    break;\n                }\n\n                if (tagType !== 8 && tagType !== 9 && tagType !== 18) {\n                    _logger2.default.w(this.TAG, 'Unsupported tag type ' + tagType + ', skipped');\n                    // consume the whole tag (skip it)\n                    offset += 11 + dataSize + 4;\n                    continue;\n                }\n\n                var ts2 = _v.getUint8(4);\n                var ts1 = _v.getUint8(5);\n                var ts0 = _v.getUint8(6);\n                var ts3 = _v.getUint8(7);\n\n                var timestamp = ts0 | ts1 << 8 | ts2 << 16 | ts3 << 24;\n\n                var streamId = _v.getUint32(7, !le) & 0x00FFFFFF;\n                if (streamId !== 0) {\n                    _logger2.default.w(this.TAG, 'Meet tag which has StreamID != 0!');\n                }\n\n                var dataOffset = offset + 11;\n\n                switch (tagType) {\n                    case 8:\n                        // Audio\n                        this._parseAudioData(chunk, dataOffset, dataSize, timestamp);\n                        break;\n                    case 9:\n                        // Video\n                        if (this._onStreamTime != null) {\n                            this._onStreamTime(timestamp);\n                        }\n                        this._parseVideoData(chunk, dataOffset, dataSize, timestamp, byteStart + offset);\n                        break;\n                    case 18:\n                        // ScriptDataObject\n                        this._parseScriptData(chunk, dataOffset, dataSize);\n                        break;\n                }\n\n                var prevTagSize = _v.getUint32(11 + dataSize, !le);\n                if (prevTagSize !== 11 + dataSize) {\n                    _logger2.default.w(this.TAG, 'Invalid PrevTagSize ' + prevTagSize);\n                }\n\n                offset += 11 + dataSize + 4; // tagBody + dataSize + prevTagSize\n            }\n\n            // dispatch parsed frames to consumer (typically, the remuxer)\n            if (this._isInitialMetadataDispatched()) {\n                if (this._dispatch && (this._audioTrack.length || this._videoTrack.length)) {\n                    this._onDataAvailable(this._audioTrack, this._videoTrack);\n                }\n            }\n\n            return offset; // consumed bytes, just equals latest offset index\n        }\n    }, {\n        key: '_parseScriptData',\n        value: function _parseScriptData(arrayBuffer, dataOffset, dataSize) {\n            var scriptData = _amfParser2.default.parseScriptData(arrayBuffer, dataOffset, dataSize);\n\n            if (scriptData.hasOwnProperty('onMetaData')) {\n                if (scriptData.onMetaData == null || _typeof(scriptData.onMetaData) !== 'object') {\n                    _logger2.default.w(this.TAG, 'Invalid onMetaData structure!');\n                    return;\n                }\n                if (this._metadata) {\n                    _logger2.default.w(this.TAG, 'Found another onMetaData tag!');\n                }\n                this._metadata = scriptData;\n                var onMetaData = this._metadata.onMetaData;\n\n                if (this._onMetaDataArrived) {\n                    this._onMetaDataArrived(Object.assign({}, onMetaData));\n                }\n\n                if (typeof onMetaData.hasAudio === 'boolean') {\n                    // hasAudio\n                    if (this._hasAudioFlagOverrided === false) {\n                        this._hasAudio = onMetaData.hasAudio;\n                        this._mediaInfo.hasAudio = this._hasAudio;\n                    }\n                }\n                if (typeof onMetaData.hasVideo === 'boolean') {\n                    // hasVideo\n                    if (this._hasVideoFlagOverrided === false) {\n                        this._hasVideo = onMetaData.hasVideo;\n                        this._mediaInfo.hasVideo = this._hasVideo;\n                    }\n                }\n                if (typeof onMetaData.audiodatarate === 'number') {\n                    // audiodatarate\n                    this._mediaInfo.audioDataRate = onMetaData.audiodatarate;\n                }\n                if (typeof onMetaData.videodatarate === 'number') {\n                    // videodatarate\n                    this._mediaInfo.videoDataRate = onMetaData.videodatarate;\n                }\n                if (typeof onMetaData.width === 'number') {\n                    // width\n                    this._mediaInfo.width = onMetaData.width;\n                }\n                if (typeof onMetaData.height === 'number') {\n                    // height\n                    this._mediaInfo.height = onMetaData.height;\n                }\n                if (typeof onMetaData.duration === 'number') {\n                    // duration\n                    if (!this._durationOverrided) {\n                        var duration = Math.floor(onMetaData.duration * this._timescale);\n                        this._duration = duration;\n                        this._mediaInfo.duration = duration;\n                    }\n                } else {\n                    this._mediaInfo.duration = 0;\n                }\n                if (typeof onMetaData.framerate === 'number') {\n                    // framerate\n                    var fps_num = Math.floor(onMetaData.framerate * 1000);\n                    if (fps_num > 0) {\n                        var fps = fps_num / 1000;\n                        this._referenceFrameRate.fixed = true;\n                        this._referenceFrameRate.fps = fps;\n                        this._referenceFrameRate.fps_num = fps_num;\n                        this._referenceFrameRate.fps_den = 1000;\n                        this._mediaInfo.fps = fps;\n                    }\n                }\n                if (_typeof(onMetaData.keyframes) === 'object') {\n                    // keyframes\n                    this._mediaInfo.hasKeyframesIndex = true;\n                    var keyframes = onMetaData.keyframes;\n                    this._mediaInfo.keyframesIndex = this._parseKeyframesIndex(keyframes);\n                    onMetaData.keyframes = null; // keyframes has been extracted, remove it\n                } else {\n                    this._mediaInfo.hasKeyframesIndex = false;\n                }\n                this._dispatch = false;\n                this._mediaInfo.metadata = onMetaData;\n                _logger2.default.v(this.TAG, 'Parsed onMetaData');\n                if (this._mediaInfo.isComplete()) {\n                    this._onMediaInfo(this._mediaInfo);\n                }\n            }\n\n            if (Object.keys(scriptData).length > 0) {\n                if (this._onScriptDataArrived) {\n                    this._onScriptDataArrived(Object.assign({}, scriptData));\n                }\n            }\n        }\n    }, {\n        key: '_parseKeyframesIndex',\n        value: function _parseKeyframesIndex(keyframes) {\n            var times = [];\n            var filepositions = [];\n\n            // ignore first keyframe which is actually AVC Sequence Header (AVCDecoderConfigurationRecord)\n            for (var i = 1; i < keyframes.times.length; i++) {\n                var time = this._timestampBase + Math.floor(keyframes.times[i] * 1000);\n                times.push(time);\n                filepositions.push(keyframes.filepositions[i]);\n            }\n\n            return {\n                times: times,\n                filepositions: filepositions\n            };\n        }\n    }, {\n        key: '_parseAudioData',\n        value: function _parseAudioData(arrayBuffer, dataOffset, dataSize, tagTimestamp) {\n            if (dataSize <= 1) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid audio packet, missing SoundData payload!');\n                return;\n            }\n\n            if (this._hasAudioFlagOverrided === true && this._hasAudio === false) {\n                // If hasAudio: false indicated explicitly in MediaDataSource,\n                // Ignore all the audio packets\n                return;\n            }\n\n            var le = this._littleEndian;\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n            var soundSpec = v.getUint8(0);\n\n            var soundFormat = soundSpec >>> 4;\n            if (soundFormat !== 2 && soundFormat !== 10) {\n                // MP3 or AAC\n                this._onError(_demuxErrors2.default.CODEC_UNSUPPORTED, 'Flv: Unsupported audio codec idx: ' + soundFormat);\n                return;\n            }\n\n            var soundRate = 0;\n            var soundRateIndex = (soundSpec & 12) >>> 2;\n            if (soundRateIndex >= 0 && soundRateIndex <= 4) {\n                soundRate = this._flvSoundRateTable[soundRateIndex];\n            } else {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid audio sample rate idx: ' + soundRateIndex);\n                return;\n            }\n\n            var soundSize = (soundSpec & 2) >>> 1; // unused\n            var soundType = soundSpec & 1;\n\n            var meta = this._audioMetadata;\n            var track = this._audioTrack;\n\n            if (!meta) {\n                if (this._hasAudio === false && this._hasAudioFlagOverrided === false) {\n                    this._hasAudio = true;\n                    this._mediaInfo.hasAudio = true;\n                }\n\n                // initial metadata\n                meta = this._audioMetadata = {};\n                meta.type = 'audio';\n                meta.id = track.id;\n                meta.timescale = this._timescale;\n                meta.duration = this._duration;\n                meta.audioSampleRate = soundRate;\n                meta.channelCount = soundType === 0 ? 1 : 2;\n            }\n\n            if (soundFormat === 10) {\n                // AAC\n                var aacData = this._parseAACAudioData(arrayBuffer, dataOffset + 1, dataSize - 1);\n                if (aacData == undefined) {\n                    return;\n                }\n\n                if (aacData.packetType === 0) {\n                    // AAC sequence header (AudioSpecificConfig)\n                    if (meta.config) {\n                        _logger2.default.w(this.TAG, 'Found another AudioSpecificConfig!');\n                    }\n                    var misc = aacData.data;\n                    meta.audioSampleRate = misc.samplingRate;\n                    meta.channelCount = misc.channelCount;\n                    meta.codec = misc.codec;\n                    meta.originalCodec = misc.originalCodec;\n                    meta.config = misc.config;\n                    // The decode result of an aac sample is 1024 PCM samples\n                    meta.refSampleDuration = 1024 / meta.audioSampleRate * meta.timescale;\n                    _logger2.default.v(this.TAG, 'Parsed AudioSpecificConfig');\n\n                    if (this._isInitialMetadataDispatched()) {\n                        // Non-initial metadata, force dispatch (or flush) parsed frames to remuxer\n                        if (this._dispatch && (this._audioTrack.length || this._videoTrack.length)) {\n                            this._onDataAvailable(this._audioTrack, this._videoTrack);\n                        }\n                    } else {\n                        this._audioInitialMetadataDispatched = true;\n                    }\n                    // then notify new metadata\n                    this._dispatch = false;\n                    this._onTrackMetadata('audio', meta);\n\n                    var mi = this._mediaInfo;\n                    mi.audioCodec = meta.originalCodec;\n                    mi.audioSampleRate = meta.audioSampleRate;\n                    mi.audioChannelCount = meta.channelCount;\n                    if (mi.hasVideo) {\n                        if (mi.videoCodec != null) {\n                            mi.mimeType = 'video/x-flv; codecs=\"' + mi.videoCodec + ',' + mi.audioCodec + '\"';\n                        }\n                    } else {\n                        mi.mimeType = 'video/x-flv; codecs=\"' + mi.audioCodec + '\"';\n                    }\n                    if (mi.isComplete()) {\n                        this._onMediaInfo(mi);\n                    }\n                } else if (aacData.packetType === 1) {\n                    // AAC raw frame data\n                    var dts = this._timestampBase + tagTimestamp;\n                    var aacSample = { unit: aacData.data, length: aacData.data.byteLength, dts: dts, pts: dts };\n                    track.samples.push(aacSample);\n                    track.length += aacData.data.length;\n                } else {\n                    _logger2.default.e(this.TAG, 'Flv: Unsupported AAC data type ' + aacData.packetType);\n                }\n            } else if (soundFormat === 2) {\n                // MP3\n                if (!meta.codec) {\n                    // We need metadata for mp3 audio track, extract info from frame header\n                    var _misc = this._parseMP3AudioData(arrayBuffer, dataOffset + 1, dataSize - 1, true);\n                    if (_misc == undefined) {\n                        return;\n                    }\n                    meta.audioSampleRate = _misc.samplingRate;\n                    meta.channelCount = _misc.channelCount;\n                    meta.codec = _misc.codec;\n                    meta.originalCodec = _misc.originalCodec;\n                    // The decode result of an mp3 sample is 1152 PCM samples\n                    meta.refSampleDuration = 1152 / meta.audioSampleRate * meta.timescale;\n                    _logger2.default.v(this.TAG, 'Parsed MPEG Audio Frame Header');\n\n                    this._audioInitialMetadataDispatched = true;\n                    this._onTrackMetadata('audio', meta);\n\n                    var _mi = this._mediaInfo;\n                    _mi.audioCodec = meta.codec;\n                    _mi.audioSampleRate = meta.audioSampleRate;\n                    _mi.audioChannelCount = meta.channelCount;\n                    _mi.audioDataRate = _misc.bitRate;\n                    if (_mi.hasVideo) {\n                        if (_mi.videoCodec != null) {\n                            _mi.mimeType = 'video/x-flv; codecs=\"' + _mi.videoCodec + ',' + _mi.audioCodec + '\"';\n                        }\n                    } else {\n                        _mi.mimeType = 'video/x-flv; codecs=\"' + _mi.audioCodec + '\"';\n                    }\n                    if (_mi.isComplete()) {\n                        this._onMediaInfo(_mi);\n                    }\n                }\n\n                // This packet is always a valid audio packet, extract it\n                var data = this._parseMP3AudioData(arrayBuffer, dataOffset + 1, dataSize - 1, false);\n                if (data == undefined) {\n                    return;\n                }\n                var _dts = this._timestampBase + tagTimestamp;\n                var mp3Sample = { unit: data, length: data.byteLength, dts: _dts, pts: _dts };\n                track.samples.push(mp3Sample);\n                track.length += data.length;\n            }\n        }\n    }, {\n        key: '_parseAACAudioData',\n        value: function _parseAACAudioData(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize <= 1) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid AAC packet, missing AACPacketType or/and Data!');\n                return;\n            }\n\n            var result = {};\n            var array = new Uint8Array(arrayBuffer, dataOffset, dataSize);\n\n            result.packetType = array[0];\n\n            if (array[0] === 0) {\n                result.data = this._parseAACAudioSpecificConfig(arrayBuffer, dataOffset + 1, dataSize - 1);\n            } else {\n                result.data = array.subarray(1);\n            }\n\n            return result;\n        }\n    }, {\n        key: '_parseAACAudioSpecificConfig',\n        value: function _parseAACAudioSpecificConfig(arrayBuffer, dataOffset, dataSize) {\n            var array = new Uint8Array(arrayBuffer, dataOffset, dataSize);\n            var config = null;\n\n            /* Audio Object Type:\r\n               0: Null\r\n               1: AAC Main\r\n               2: AAC LC\r\n               3: AAC SSR (Scalable Sample Rate)\r\n               4: AAC LTP (Long Term Prediction)\r\n               5: HE-AAC / SBR (Spectral Band Replication)\r\n               6: AAC Scalable\r\n            */\n\n            var audioObjectType = 0;\n            var originalAudioObjectType = 0;\n            var audioExtensionObjectType = null;\n            var samplingIndex = 0;\n            var extensionSamplingIndex = null;\n\n            // 5 bits\n            audioObjectType = originalAudioObjectType = array[0] >>> 3;\n            // 4 bits\n            samplingIndex = (array[0] & 0x07) << 1 | array[1] >>> 7;\n            if (samplingIndex < 0 || samplingIndex >= this._mpegSamplingRates.length) {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: AAC invalid sampling frequency index!');\n                return;\n            }\n\n            var samplingFrequence = this._mpegSamplingRates[samplingIndex];\n\n            // 4 bits\n            var channelConfig = (array[1] & 0x78) >>> 3;\n            if (channelConfig < 0 || channelConfig >= 8) {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: AAC invalid channel configuration');\n                return;\n            }\n\n            if (audioObjectType === 5) {\n                // HE-AAC?\n                // 4 bits\n                extensionSamplingIndex = (array[1] & 0x07) << 1 | array[2] >>> 7;\n                // 5 bits\n                audioExtensionObjectType = (array[2] & 0x7C) >>> 2;\n            }\n\n            // workarounds for various browsers\n            var userAgent = self.navigator.userAgent.toLowerCase();\n\n            if (userAgent.indexOf('firefox') !== -1) {\n                // firefox: use SBR (HE-AAC) if freq less than 24kHz\n                if (samplingIndex >= 6) {\n                    audioObjectType = 5;\n                    config = new Array(4);\n                    extensionSamplingIndex = samplingIndex - 3;\n                } else {\n                    // use LC-AAC\n                    audioObjectType = 2;\n                    config = new Array(2);\n                    extensionSamplingIndex = samplingIndex;\n                }\n            } else if (userAgent.indexOf('android') !== -1) {\n                // android: always use LC-AAC\n                audioObjectType = 2;\n                config = new Array(2);\n                extensionSamplingIndex = samplingIndex;\n            } else {\n                // for other browsers, e.g. chrome...\n                // Always use HE-AAC to make it easier to switch aac codec profile\n                audioObjectType = 5;\n                extensionSamplingIndex = samplingIndex;\n                config = new Array(4);\n\n                if (samplingIndex >= 6) {\n                    extensionSamplingIndex = samplingIndex - 3;\n                } else if (channelConfig === 1) {\n                    // Mono channel\n                    audioObjectType = 2;\n                    config = new Array(2);\n                    extensionSamplingIndex = samplingIndex;\n                }\n            }\n\n            config[0] = audioObjectType << 3;\n            config[0] |= (samplingIndex & 0x0F) >>> 1;\n            config[1] = (samplingIndex & 0x0F) << 7;\n            config[1] |= (channelConfig & 0x0F) << 3;\n            if (audioObjectType === 5) {\n                config[1] |= (extensionSamplingIndex & 0x0F) >>> 1;\n                config[2] = (extensionSamplingIndex & 0x01) << 7;\n                // extended audio object type: force to 2 (LC-AAC)\n                config[2] |= 2 << 2;\n                config[3] = 0;\n            }\n\n            return {\n                config: config,\n                samplingRate: samplingFrequence,\n                channelCount: channelConfig,\n                codec: 'mp4a.40.' + audioObjectType,\n                originalCodec: 'mp4a.40.' + originalAudioObjectType\n            };\n        }\n    }, {\n        key: '_parseMP3AudioData',\n        value: function _parseMP3AudioData(arrayBuffer, dataOffset, dataSize, requestHeader) {\n            if (dataSize < 4) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid MP3 packet, header missing!');\n                return;\n            }\n\n            var le = this._littleEndian;\n            var array = new Uint8Array(arrayBuffer, dataOffset, dataSize);\n            var result = null;\n\n            if (requestHeader) {\n                if (array[0] !== 0xFF) {\n                    return;\n                }\n                var ver = array[1] >>> 3 & 0x03;\n                var layer = (array[1] & 0x06) >> 1;\n\n                var bitrate_index = (array[2] & 0xF0) >>> 4;\n                var sampling_freq_index = (array[2] & 0x0C) >>> 2;\n\n                var channel_mode = array[3] >>> 6 & 0x03;\n                var channel_count = channel_mode !== 3 ? 2 : 1;\n\n                var sample_rate = 0;\n                var bit_rate = 0;\n                var object_type = 34; // Layer-3, listed in MPEG-4 Audio Object Types\n\n                var codec = 'mp3';\n\n                switch (ver) {\n                    case 0:\n                        // MPEG 2.5\n                        sample_rate = this._mpegAudioV25SampleRateTable[sampling_freq_index];\n                        break;\n                    case 2:\n                        // MPEG 2\n                        sample_rate = this._mpegAudioV20SampleRateTable[sampling_freq_index];\n                        break;\n                    case 3:\n                        // MPEG 1\n                        sample_rate = this._mpegAudioV10SampleRateTable[sampling_freq_index];\n                        break;\n                }\n\n                switch (layer) {\n                    case 1:\n                        // Layer 3\n                        object_type = 34;\n                        if (bitrate_index < this._mpegAudioL3BitRateTable.length) {\n                            bit_rate = this._mpegAudioL3BitRateTable[bitrate_index];\n                        }\n                        break;\n                    case 2:\n                        // Layer 2\n                        object_type = 33;\n                        if (bitrate_index < this._mpegAudioL2BitRateTable.length) {\n                            bit_rate = this._mpegAudioL2BitRateTable[bitrate_index];\n                        }\n                        break;\n                    case 3:\n                        // Layer 1\n                        object_type = 32;\n                        if (bitrate_index < this._mpegAudioL1BitRateTable.length) {\n                            bit_rate = this._mpegAudioL1BitRateTable[bitrate_index];\n                        }\n                        break;\n                }\n\n                result = {\n                    bitRate: bit_rate,\n                    samplingRate: sample_rate,\n                    channelCount: channel_count,\n                    codec: codec,\n                    originalCodec: codec\n                };\n            } else {\n                result = array;\n            }\n\n            return result;\n        }\n    }, {\n        key: '_parseVideoData',\n        value: function _parseVideoData(arrayBuffer, dataOffset, dataSize, tagTimestamp, tagPosition) {\n            if (dataSize <= 1) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid video packet, missing VideoData payload!');\n                return;\n            }\n\n            if (this._hasVideoFlagOverrided === true && this._hasVideo === false) {\n                // If hasVideo: false indicated explicitly in MediaDataSource,\n                // Ignore all the video packets\n                return;\n            }\n\n            var spec = new Uint8Array(arrayBuffer, dataOffset, dataSize)[0];\n\n            var frameType = (spec & 240) >>> 4;\n            var codecId = spec & 15;\n\n            if (codecId !== 7) {\n                this._onError(_demuxErrors2.default.CODEC_UNSUPPORTED, 'Flv: Unsupported codec in video frame: ' + codecId);\n                return;\n            }\n\n            this._parseAVCVideoPacket(arrayBuffer, dataOffset + 1, dataSize - 1, tagTimestamp, tagPosition, frameType);\n        }\n    }, {\n        key: '_parseAVCVideoPacket',\n        value: function _parseAVCVideoPacket(arrayBuffer, dataOffset, dataSize, tagTimestamp, tagPosition, frameType) {\n            if (dataSize < 4) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime');\n                return;\n            }\n\n            var le = this._littleEndian;\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n            var packetType = v.getUint8(0);\n            var cts_unsigned = v.getUint32(0, !le) & 0x00FFFFFF;\n            var cts = cts_unsigned << 8 >> 8; // convert to 24-bit signed int\n\n            if (packetType === 0) {\n                // AVCDecoderConfigurationRecord\n                this._parseAVCDecoderConfigurationRecord(arrayBuffer, dataOffset + 4, dataSize - 4);\n            } else if (packetType === 1) {\n                // One or more Nalus\n                this._parseAVCVideoData(arrayBuffer, dataOffset + 4, dataSize - 4, tagTimestamp, tagPosition, frameType, cts);\n            } else if (packetType === 2) {\n                // empty, AVC end of sequence\n            } else {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid video packet type ' + packetType);\n                return;\n            }\n        }\n    }, {\n        key: '_parseAVCDecoderConfigurationRecord',\n        value: function _parseAVCDecoderConfigurationRecord(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 7) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid AVCDecoderConfigurationRecord, lack of data!');\n                return;\n            }\n\n            var meta = this._videoMetadata;\n            var track = this._videoTrack;\n            var le = this._littleEndian;\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n            if (!meta) {\n                if (this._hasVideo === false && this._hasVideoFlagOverrided === false) {\n                    this._hasVideo = true;\n                    this._mediaInfo.hasVideo = true;\n                }\n\n                meta = this._videoMetadata = {};\n                meta.type = 'video';\n                meta.id = track.id;\n                meta.timescale = this._timescale;\n                meta.duration = this._duration;\n            } else {\n                if (typeof meta.avcc !== 'undefined') {\n                    _logger2.default.w(this.TAG, 'Found another AVCDecoderConfigurationRecord!');\n                }\n            }\n\n            var version = v.getUint8(0); // configurationVersion\n            var avcProfile = v.getUint8(1); // avcProfileIndication\n            var profileCompatibility = v.getUint8(2); // profile_compatibility\n            var avcLevel = v.getUint8(3); // AVCLevelIndication\n\n            if (version !== 1 || avcProfile === 0) {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid AVCDecoderConfigurationRecord');\n                return;\n            }\n\n            this._naluLengthSize = (v.getUint8(4) & 3) + 1; // lengthSizeMinusOne\n            if (this._naluLengthSize !== 3 && this._naluLengthSize !== 4) {\n                // holy shit!!!\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Strange NaluLengthSizeMinusOne: ' + (this._naluLengthSize - 1));\n                return;\n            }\n\n            var spsCount = v.getUint8(5) & 31; // numOfSequenceParameterSets\n            if (spsCount === 0) {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid AVCDecoderConfigurationRecord: No SPS');\n                return;\n            } else if (spsCount > 1) {\n                _logger2.default.w(this.TAG, 'Flv: Strange AVCDecoderConfigurationRecord: SPS Count = ' + spsCount);\n            }\n\n            var offset = 6;\n\n            for (var i = 0; i < spsCount; i++) {\n                var len = v.getUint16(offset, !le); // sequenceParameterSetLength\n                offset += 2;\n\n                if (len === 0) {\n                    continue;\n                }\n\n                // Notice: Nalu without startcode header (00 00 00 01)\n                var sps = new Uint8Array(arrayBuffer, dataOffset + offset, len);\n                offset += len;\n\n                var config = _spsParser2.default.parseSPS(sps);\n                if (i !== 0) {\n                    // ignore other sps's config\n                    continue;\n                }\n\n                meta.codecWidth = config.codec_size.width;\n                meta.codecHeight = config.codec_size.height;\n                meta.presentWidth = config.present_size.width;\n                meta.presentHeight = config.present_size.height;\n\n                meta.profile = config.profile_string;\n                meta.level = config.level_string;\n                meta.bitDepth = config.bit_depth;\n                meta.chromaFormat = config.chroma_format;\n                meta.sarRatio = config.sar_ratio;\n                meta.frameRate = config.frame_rate;\n\n                if (config.frame_rate.fixed === false || config.frame_rate.fps_num === 0 || config.frame_rate.fps_den === 0) {\n                    meta.frameRate = this._referenceFrameRate;\n                }\n\n                var fps_den = meta.frameRate.fps_den;\n                var fps_num = meta.frameRate.fps_num;\n                meta.refSampleDuration = meta.timescale * (fps_den / fps_num);\n\n                var codecArray = sps.subarray(1, 4);\n                var codecString = 'avc1.';\n                for (var j = 0; j < 3; j++) {\n                    var h = codecArray[j].toString(16);\n                    if (h.length < 2) {\n                        h = '0' + h;\n                    }\n                    codecString += h;\n                }\n                meta.codec = codecString;\n\n                var mi = this._mediaInfo;\n                mi.width = meta.codecWidth;\n                mi.height = meta.codecHeight;\n                mi.fps = meta.frameRate.fps;\n                mi.profile = meta.profile;\n                mi.level = meta.level;\n                mi.refFrames = config.ref_frames;\n                mi.chromaFormat = config.chroma_format_string;\n                mi.sarNum = meta.sarRatio.width;\n                mi.sarDen = meta.sarRatio.height;\n                mi.videoCodec = codecString;\n\n                if (mi.hasAudio) {\n                    if (mi.audioCodec != null) {\n                        mi.mimeType = 'video/x-flv; codecs=\"' + mi.videoCodec + ',' + mi.audioCodec + '\"';\n                    }\n                } else {\n                    mi.mimeType = 'video/x-flv; codecs=\"' + mi.videoCodec + '\"';\n                }\n                if (mi.isComplete()) {\n                    this._onMediaInfo(mi);\n                }\n            }\n\n            var ppsCount = v.getUint8(offset); // numOfPictureParameterSets\n            if (ppsCount === 0) {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid AVCDecoderConfigurationRecord: No PPS');\n                return;\n            } else if (ppsCount > 1) {\n                _logger2.default.w(this.TAG, 'Flv: Strange AVCDecoderConfigurationRecord: PPS Count = ' + ppsCount);\n            }\n\n            offset++;\n\n            for (var _i = 0; _i < ppsCount; _i++) {\n                var _len = v.getUint16(offset, !le); // pictureParameterSetLength\n                offset += 2;\n\n                if (_len === 0) {\n                    continue;\n                }\n\n                // pps is useless for extracting video information\n                offset += _len;\n            }\n\n            meta.avcc = new Uint8Array(dataSize);\n            meta.avcc.set(new Uint8Array(arrayBuffer, dataOffset, dataSize), 0);\n            _logger2.default.v(this.TAG, 'Parsed AVCDecoderConfigurationRecord');\n\n            if (this._isInitialMetadataDispatched()) {\n                // flush parsed frames\n                if (this._dispatch && (this._audioTrack.length || this._videoTrack.length)) {\n                    this._onDataAvailable(this._audioTrack, this._videoTrack);\n                }\n            } else {\n                this._videoInitialMetadataDispatched = true;\n            }\n            // notify new metadata\n            this._dispatch = false;\n            this._onTrackMetadata('video', meta);\n        }\n    }, {\n        key: '_parseAVCVideoData',\n        value: function _parseAVCVideoData(arrayBuffer, dataOffset, dataSize, tagTimestamp, tagPosition, frameType, cts) {\n            var le = this._littleEndian;\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n            var units = [],\n                length = 0;\n\n            var offset = 0;\n            var lengthSize = this._naluLengthSize;\n            var dts = this._timestampBase + tagTimestamp;\n            var keyframe = frameType === 1; // from FLV Frame Type constants\n\n            while (offset < dataSize) {\n                if (offset + 4 >= dataSize) {\n                    _logger2.default.w(this.TAG, 'Malformed Nalu near timestamp ' + dts + ', offset = ' + offset + ', dataSize = ' + dataSize);\n                    break; // data not enough for next Nalu\n                }\n                // Nalu with length-header (AVC1)\n                var naluSize = v.getUint32(offset, !le); // Big-Endian read\n                if (lengthSize === 3) {\n                    naluSize >>>= 8;\n                }\n                if (naluSize > dataSize - lengthSize) {\n                    _logger2.default.w(this.TAG, 'Malformed Nalus near timestamp ' + dts + ', NaluSize > DataSize!');\n                    return;\n                }\n\n                var unitType = v.getUint8(offset + lengthSize) & 0x1F;\n\n                if (unitType === 5) {\n                    // IDR\n                    keyframe = true;\n                }\n\n                var data = new Uint8Array(arrayBuffer, dataOffset + offset, lengthSize + naluSize);\n                var unit = { type: unitType, data: data };\n                units.push(unit);\n                length += data.byteLength;\n\n                offset += lengthSize + naluSize;\n            }\n\n            if (units.length) {\n                var track = this._videoTrack;\n                var avcSample = {\n                    units: units,\n                    length: length,\n                    isKeyframe: keyframe,\n                    dts: dts,\n                    cts: cts,\n                    pts: dts + cts\n                };\n                if (keyframe) {\n                    avcSample.fileposition = tagPosition;\n                }\n                track.samples.push(avcSample);\n                track.length += length;\n            }\n        }\n    }, {\n        key: 'onTrackMetadata',\n        get: function get() {\n            return this._onTrackMetadata;\n        },\n        set: function set(callback) {\n            this._onTrackMetadata = callback;\n        }\n\n        // prototype: function(mediaInfo: MediaInfo): void\n\n    }, {\n        key: 'onMediaInfo',\n        get: function get() {\n            return this._onMediaInfo;\n        },\n        set: function set(callback) {\n            this._onMediaInfo = callback;\n        }\n    }, {\n        key: 'onMetaDataArrived',\n        get: function get() {\n            return this._onMetaDataArrived;\n        },\n        set: function set(callback) {\n            this._onMetaDataArrived = callback;\n        }\n    }, {\n        key: 'onScriptDataArrived',\n        get: function get() {\n            return this._onScriptDataArrived;\n        },\n        set: function set(callback) {\n            this._onScriptDataArrived = callback;\n        }\n\n        // prototype: function(type: number, info: string): void\n\n    }, {\n        key: 'onError',\n        get: function get() {\n            return this._onError;\n        },\n        set: function set(callback) {\n            this._onError = callback;\n        }\n\n        // prototype: function(videoTrack: any, audioTrack: any): void\n\n    }, {\n        key: 'onDataAvailable',\n        get: function get() {\n            return this._onDataAvailable;\n        },\n        set: function set(callback) {\n            this._onDataAvailable = callback;\n        }\n    }, {\n        key: 'onStreamTime',\n        get: function get() {\n            return this._onStreamTime;\n        },\n        set: function set(callback) {\n            this._onStreamTime = callback;\n        }\n\n        // timestamp base for output samples, must be in milliseconds\n\n    }, {\n        key: 'timestampBase',\n        get: function get() {\n            return this._timestampBase;\n        },\n        set: function set(base) {\n            this._timestampBase = base;\n        }\n    }, {\n        key: 'overridedDuration',\n        get: function get() {\n            return this._duration;\n        }\n\n        // Force-override media duration. Must be in milliseconds, int32\n        ,\n        set: function set(duration) {\n            this._durationOverrided = true;\n            this._duration = duration;\n            this._mediaInfo.duration = duration;\n        }\n\n        // Force-override audio track present flag, boolean\n\n    }, {\n        key: 'overridedHasAudio',\n        set: function set(hasAudio) {\n            this._hasAudioFlagOverrided = true;\n            this._hasAudio = hasAudio;\n            this._mediaInfo.hasAudio = hasAudio;\n        }\n\n        // Force-override video track present flag, boolean\n\n    }, {\n        key: 'overridedHasVideo',\n        set: function set(hasVideo) {\n            this._hasVideoFlagOverrided = true;\n            this._hasVideo = hasVideo;\n            this._mediaInfo.hasVideo = hasVideo;\n        }\n    }], [{\n        key: 'probe',\n        value: function probe(buffer) {\n            var data = new Uint8Array(buffer);\n            var mismatch = { match: false };\n\n            if (data[0] !== 0x46 || data[1] !== 0x4C || data[2] !== 0x56 || data[3] !== 0x01) {\n                return mismatch;\n            }\n\n            var hasAudio = (data[4] & 4) >>> 2 !== 0;\n            var hasVideo = (data[4] & 1) !== 0;\n\n            var offset = ReadBig32(data, 5);\n\n            if (offset < 9) {\n                return mismatch;\n            }\n\n            return {\n                match: true,\n                consumed: offset,\n                dataOffset: offset,\n                hasAudioTrack: hasAudio,\n                hasVideoTrack: hasVideo\n            };\n        }\n    }]);\n\n    return FLVDemuxer;\n}();\n\nexports.default = FLVDemuxer;\n\n},{\"../core/media-info.js\":7,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./amf-parser.js\":15,\"./demux-errors.js\":16,\"./sps-parser.js\":19}],19:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _expGolomb = _dereq_('./exp-golomb.js');\n\nvar _expGolomb2 = _interopRequireDefault(_expGolomb);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar SPSParser = function () {\n    function SPSParser() {\n        _classCallCheck(this, SPSParser);\n    }\n\n    _createClass(SPSParser, null, [{\n        key: '_ebsp2rbsp',\n        value: function _ebsp2rbsp(uint8array) {\n            var src = uint8array;\n            var src_length = src.byteLength;\n            var dst = new Uint8Array(src_length);\n            var dst_idx = 0;\n\n            for (var i = 0; i < src_length; i++) {\n                if (i >= 2) {\n                    // Unescape: Skip 0x03 after 00 00\n                    if (src[i] === 0x03 && src[i - 1] === 0x00 && src[i - 2] === 0x00) {\n                        continue;\n                    }\n                }\n                dst[dst_idx] = src[i];\n                dst_idx++;\n            }\n\n            return new Uint8Array(dst.buffer, 0, dst_idx);\n        }\n    }, {\n        key: 'parseSPS',\n        value: function parseSPS(uint8array) {\n            var rbsp = SPSParser._ebsp2rbsp(uint8array);\n            var gb = new _expGolomb2.default(rbsp);\n\n            gb.readByte();\n            var profile_idc = gb.readByte(); // profile_idc\n            gb.readByte(); // constraint_set_flags[5] + reserved_zero[3]\n            var level_idc = gb.readByte(); // level_idc\n            gb.readUEG(); // seq_parameter_set_id\n\n            var profile_string = SPSParser.getProfileString(profile_idc);\n            var level_string = SPSParser.getLevelString(level_idc);\n            var chroma_format_idc = 1;\n            var chroma_format = 420;\n            var chroma_format_table = [0, 420, 422, 444];\n            var bit_depth = 8;\n\n            if (profile_idc === 100 || profile_idc === 110 || profile_idc === 122 || profile_idc === 244 || profile_idc === 44 || profile_idc === 83 || profile_idc === 86 || profile_idc === 118 || profile_idc === 128 || profile_idc === 138 || profile_idc === 144) {\n\n                chroma_format_idc = gb.readUEG();\n                if (chroma_format_idc === 3) {\n                    gb.readBits(1); // separate_colour_plane_flag\n                }\n                if (chroma_format_idc <= 3) {\n                    chroma_format = chroma_format_table[chroma_format_idc];\n                }\n\n                bit_depth = gb.readUEG() + 8; // bit_depth_luma_minus8\n                gb.readUEG(); // bit_depth_chroma_minus8\n                gb.readBits(1); // qpprime_y_zero_transform_bypass_flag\n                if (gb.readBool()) {\n                    // seq_scaling_matrix_present_flag\n                    var scaling_list_count = chroma_format_idc !== 3 ? 8 : 12;\n                    for (var i = 0; i < scaling_list_count; i++) {\n                        if (gb.readBool()) {\n                            // seq_scaling_list_present_flag\n                            if (i < 6) {\n                                SPSParser._skipScalingList(gb, 16);\n                            } else {\n                                SPSParser._skipScalingList(gb, 64);\n                            }\n                        }\n                    }\n                }\n            }\n            gb.readUEG(); // log2_max_frame_num_minus4\n            var pic_order_cnt_type = gb.readUEG();\n            if (pic_order_cnt_type === 0) {\n                gb.readUEG(); // log2_max_pic_order_cnt_lsb_minus_4\n            } else if (pic_order_cnt_type === 1) {\n                gb.readBits(1); // delta_pic_order_always_zero_flag\n                gb.readSEG(); // offset_for_non_ref_pic\n                gb.readSEG(); // offset_for_top_to_bottom_field\n                var num_ref_frames_in_pic_order_cnt_cycle = gb.readUEG();\n                for (var _i = 0; _i < num_ref_frames_in_pic_order_cnt_cycle; _i++) {\n                    gb.readSEG(); // offset_for_ref_frame\n                }\n            }\n            var ref_frames = gb.readUEG(); // max_num_ref_frames\n            gb.readBits(1); // gaps_in_frame_num_value_allowed_flag\n\n            var pic_width_in_mbs_minus1 = gb.readUEG();\n            var pic_height_in_map_units_minus1 = gb.readUEG();\n\n            var frame_mbs_only_flag = gb.readBits(1);\n            if (frame_mbs_only_flag === 0) {\n                gb.readBits(1); // mb_adaptive_frame_field_flag\n            }\n            gb.readBits(1); // direct_8x8_inference_flag\n\n            var frame_crop_left_offset = 0;\n            var frame_crop_right_offset = 0;\n            var frame_crop_top_offset = 0;\n            var frame_crop_bottom_offset = 0;\n\n            var frame_cropping_flag = gb.readBool();\n            if (frame_cropping_flag) {\n                frame_crop_left_offset = gb.readUEG();\n                frame_crop_right_offset = gb.readUEG();\n                frame_crop_top_offset = gb.readUEG();\n                frame_crop_bottom_offset = gb.readUEG();\n            }\n\n            var sar_width = 1,\n                sar_height = 1;\n            var fps = 0,\n                fps_fixed = true,\n                fps_num = 0,\n                fps_den = 0;\n\n            var vui_parameters_present_flag = gb.readBool();\n            if (vui_parameters_present_flag) {\n                if (gb.readBool()) {\n                    // aspect_ratio_info_present_flag\n                    var aspect_ratio_idc = gb.readByte();\n                    var sar_w_table = [1, 12, 10, 16, 40, 24, 20, 32, 80, 18, 15, 64, 160, 4, 3, 2];\n                    var sar_h_table = [1, 11, 11, 11, 33, 11, 11, 11, 33, 11, 11, 33, 99, 3, 2, 1];\n\n                    if (aspect_ratio_idc > 0 && aspect_ratio_idc < 16) {\n                        sar_width = sar_w_table[aspect_ratio_idc - 1];\n                        sar_height = sar_h_table[aspect_ratio_idc - 1];\n                    } else if (aspect_ratio_idc === 255) {\n                        sar_width = gb.readByte() << 8 | gb.readByte();\n                        sar_height = gb.readByte() << 8 | gb.readByte();\n                    }\n                }\n\n                if (gb.readBool()) {\n                    // overscan_info_present_flag\n                    gb.readBool(); // overscan_appropriate_flag\n                }\n                if (gb.readBool()) {\n                    // video_signal_type_present_flag\n                    gb.readBits(4); // video_format & video_full_range_flag\n                    if (gb.readBool()) {\n                        // colour_description_present_flag\n                        gb.readBits(24); // colour_primaries & transfer_characteristics & matrix_coefficients\n                    }\n                }\n                if (gb.readBool()) {\n                    // chroma_loc_info_present_flag\n                    gb.readUEG(); // chroma_sample_loc_type_top_field\n                    gb.readUEG(); // chroma_sample_loc_type_bottom_field\n                }\n                if (gb.readBool()) {\n                    // timing_info_present_flag\n                    var num_units_in_tick = gb.readBits(32);\n                    var time_scale = gb.readBits(32);\n                    fps_fixed = gb.readBool(); // fixed_frame_rate_flag\n\n                    fps_num = time_scale;\n                    fps_den = num_units_in_tick * 2;\n                    fps = fps_num / fps_den;\n                }\n            }\n\n            var sarScale = 1;\n            if (sar_width !== 1 || sar_height !== 1) {\n                sarScale = sar_width / sar_height;\n            }\n\n            var crop_unit_x = 0,\n                crop_unit_y = 0;\n            if (chroma_format_idc === 0) {\n                crop_unit_x = 1;\n                crop_unit_y = 2 - frame_mbs_only_flag;\n            } else {\n                var sub_wc = chroma_format_idc === 3 ? 1 : 2;\n                var sub_hc = chroma_format_idc === 1 ? 2 : 1;\n                crop_unit_x = sub_wc;\n                crop_unit_y = sub_hc * (2 - frame_mbs_only_flag);\n            }\n\n            var codec_width = (pic_width_in_mbs_minus1 + 1) * 16;\n            var codec_height = (2 - frame_mbs_only_flag) * ((pic_height_in_map_units_minus1 + 1) * 16);\n\n            codec_width -= (frame_crop_left_offset + frame_crop_right_offset) * crop_unit_x;\n            codec_height -= (frame_crop_top_offset + frame_crop_bottom_offset) * crop_unit_y;\n\n            var present_width = Math.ceil(codec_width * sarScale);\n\n            gb.destroy();\n            gb = null;\n\n            return {\n                profile_string: profile_string, // baseline, high, high10, ...\n                level_string: level_string, // 3, 3.1, 4, 4.1, 5, 5.1, ...\n                bit_depth: bit_depth, // 8bit, 10bit, ...\n                ref_frames: ref_frames,\n                chroma_format: chroma_format, // 4:2:0, 4:2:2, ...\n                chroma_format_string: SPSParser.getChromaFormatString(chroma_format),\n\n                frame_rate: {\n                    fixed: fps_fixed,\n                    fps: fps,\n                    fps_den: fps_den,\n                    fps_num: fps_num\n                },\n\n                sar_ratio: {\n                    width: sar_width,\n                    height: sar_height\n                },\n\n                codec_size: {\n                    width: codec_width,\n                    height: codec_height\n                },\n\n                present_size: {\n                    width: present_width,\n                    height: codec_height\n                }\n            };\n        }\n    }, {\n        key: '_skipScalingList',\n        value: function _skipScalingList(gb, count) {\n            var last_scale = 8,\n                next_scale = 8;\n            var delta_scale = 0;\n            for (var i = 0; i < count; i++) {\n                if (next_scale !== 0) {\n                    delta_scale = gb.readSEG();\n                    next_scale = (last_scale + delta_scale + 256) % 256;\n                }\n                last_scale = next_scale === 0 ? last_scale : next_scale;\n            }\n        }\n    }, {\n        key: 'getProfileString',\n        value: function getProfileString(profile_idc) {\n            switch (profile_idc) {\n                case 66:\n                    return 'Baseline';\n                case 77:\n                    return 'Main';\n                case 88:\n                    return 'Extended';\n                case 100:\n                    return 'High';\n                case 110:\n                    return 'High10';\n                case 122:\n                    return 'High422';\n                case 244:\n                    return 'High444';\n                default:\n                    return 'Unknown';\n            }\n        }\n    }, {\n        key: 'getLevelString',\n        value: function getLevelString(level_idc) {\n            return (level_idc / 10).toFixed(1);\n        }\n    }, {\n        key: 'getChromaFormatString',\n        value: function getChromaFormatString(chroma) {\n            switch (chroma) {\n                case 420:\n                    return '4:2:0';\n                case 422:\n                    return '4:2:2';\n                case 444:\n                    return '4:4:4';\n                default:\n                    return 'Unknown';\n            }\n        }\n    }]);\n\n    return SPSParser;\n}();\n\nexports.default = SPSParser;\n\n},{\"./exp-golomb.js\":17}],20:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; /*\r\n                                                                                                                                                                                                                                                                               * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                               *\r\n                                                                                                                                                                                                                                                                               * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                               *\r\n                                                                                                                                                                                                                                                                               * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                               * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                               * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                               *\r\n                                                                                                                                                                                                                                                                               *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                               *\r\n                                                                                                                                                                                                                                                                               * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                               * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                               * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                               * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                               * limitations under the License.\r\n                                                                                                                                                                                                                                                                               */\n\nvar _polyfill = _dereq_('./utils/polyfill.js');\n\nvar _polyfill2 = _interopRequireDefault(_polyfill);\n\nvar _features = _dereq_('./core/features.js');\n\nvar _features2 = _interopRequireDefault(_features);\n\nvar _loader = _dereq_('./io/loader.js');\n\nvar _flvPlayer = _dereq_('./player/flv-player.js');\n\nvar _flvPlayer2 = _interopRequireDefault(_flvPlayer);\n\nvar _nativePlayer = _dereq_('./player/native-player.js');\n\nvar _nativePlayer2 = _interopRequireDefault(_nativePlayer);\n\nvar _playerEvents = _dereq_('./player/player-events.js');\n\nvar _playerEvents2 = _interopRequireDefault(_playerEvents);\n\nvar _playerErrors = _dereq_('./player/player-errors.js');\n\nvar _loggingControl = _dereq_('./utils/logging-control.js');\n\nvar _loggingControl2 = _interopRequireDefault(_loggingControl);\n\nvar _exception = _dereq_('./utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// here are all the interfaces\n\n// install polyfills\n_polyfill2.default.install();\n\n// factory method\nfunction createPlayer(mediaDataSource, optionalConfig) {\n    var mds = mediaDataSource;\n    if (mds == null || (typeof mds === 'undefined' ? 'undefined' : _typeof(mds)) !== 'object') {\n        throw new _exception.InvalidArgumentException('MediaDataSource must be an javascript object!');\n    }\n\n    if (!mds.hasOwnProperty('type')) {\n        throw new _exception.InvalidArgumentException('MediaDataSource must has type field to indicate video file type!');\n    }\n\n    switch (mds.type) {\n        case 'flv':\n            return new _flvPlayer2.default(mds, optionalConfig);\n        default:\n            return new _nativePlayer2.default(mds, optionalConfig);\n    }\n}\n\n// feature detection\nfunction isSupported() {\n    return _features2.default.supportMSEH264Playback();\n}\n\nfunction getFeatureList() {\n    return _features2.default.getFeatureList();\n}\n\n// interfaces\nvar flvjs = {};\n\nflvjs.createPlayer = createPlayer;\nflvjs.isSupported = isSupported;\nflvjs.getFeatureList = getFeatureList;\n\nflvjs.BaseLoader = _loader.BaseLoader;\nflvjs.LoaderStatus = _loader.LoaderStatus;\nflvjs.LoaderErrors = _loader.LoaderErrors;\n\nflvjs.Events = _playerEvents2.default;\nflvjs.ErrorTypes = _playerErrors.ErrorTypes;\nflvjs.ErrorDetails = _playerErrors.ErrorDetails;\n\nflvjs.FlvPlayer = _flvPlayer2.default;\nflvjs.NativePlayer = _nativePlayer2.default;\nflvjs.LoggingControl = _loggingControl2.default;\n\nObject.defineProperty(flvjs, 'version', {\n    enumerable: true,\n    get: function get() {\n        // replaced by browserify-versionify transform\n        return '1.6.1';\n    }\n});\n\nexports.default = flvjs;\n\n},{\"./core/features.js\":6,\"./io/loader.js\":24,\"./player/flv-player.js\":32,\"./player/native-player.js\":33,\"./player/player-errors.js\":34,\"./player/player-events.js\":35,\"./utils/exception.js\":40,\"./utils/logging-control.js\":42,\"./utils/polyfill.js\":43}],21:[function(_dereq_,module,exports){\n'use strict';\n\n// entry/index file\n\n// make it compatible with browserify's umd wrapper\nmodule.exports = _dereq_('./flv.js').default;\n\n},{\"./flv.js\":20}],22:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _browser = _dereq_('../utils/browser.js');\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/* fetch + stream IO loader. Currently working on chrome 43+.\r\n * fetch provides a better alternative http API to XMLHttpRequest\r\n *\r\n * fetch spec   https://fetch.spec.whatwg.org/\r\n * stream spec  https://streams.spec.whatwg.org/\r\n */\nvar FetchStreamLoader = function (_BaseLoader) {\n    _inherits(FetchStreamLoader, _BaseLoader);\n\n    _createClass(FetchStreamLoader, null, [{\n        key: 'isSupported',\n        value: function isSupported() {\n            try {\n                // fetch + stream is broken on Microsoft Edge. Disable before build 15048.\n                // see https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8196907/\n                // Fixed in Jan 10, 2017. Build 15048+ removed from blacklist.\n                var isWorkWellEdge = _browser2.default.msedge && _browser2.default.version.minor >= 15048;\n                var browserNotBlacklisted = _browser2.default.msedge ? isWorkWellEdge : true;\n                return self.fetch && self.ReadableStream && browserNotBlacklisted;\n            } catch (e) {\n                return false;\n            }\n        }\n    }]);\n\n    function FetchStreamLoader(seekHandler, config) {\n        _classCallCheck(this, FetchStreamLoader);\n\n        var _this = _possibleConstructorReturn(this, (FetchStreamLoader.__proto__ || Object.getPrototypeOf(FetchStreamLoader)).call(this, 'fetch-stream-loader'));\n\n        _this.TAG = 'FetchStreamLoader';\n\n        _this._seekHandler = seekHandler;\n        _this._config = config;\n        _this._needStash = true;\n\n        _this._requestAbort = false;\n        _this._contentLength = null;\n        _this._receivedLength = 0;\n        return _this;\n    }\n\n    _createClass(FetchStreamLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this.isWorking()) {\n                this.abort();\n            }\n            _get(FetchStreamLoader.prototype.__proto__ || Object.getPrototypeOf(FetchStreamLoader.prototype), 'destroy', this).call(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(dataSource, range) {\n            var _this2 = this;\n\n            this._dataSource = dataSource;\n            this._range = range;\n\n            var sourceURL = dataSource.url;\n            if (this._config.reuseRedirectedURL && dataSource.redirectedURL != undefined) {\n                sourceURL = dataSource.redirectedURL;\n            }\n\n            var seekConfig = this._seekHandler.getConfig(sourceURL, range);\n\n            var headers = new self.Headers();\n\n            if (_typeof(seekConfig.headers) === 'object') {\n                var configHeaders = seekConfig.headers;\n                for (var key in configHeaders) {\n                    if (configHeaders.hasOwnProperty(key)) {\n                        headers.append(key, configHeaders[key]);\n                    }\n                }\n            }\n\n            var params = {\n                method: 'GET',\n                headers: headers,\n                mode: 'cors',\n                cache: 'default',\n                // The default policy of Fetch API in the whatwg standard\n                // Safari incorrectly indicates 'no-referrer' as default policy, fuck it\n                referrerPolicy: 'no-referrer-when-downgrade'\n            };\n\n            // add additional headers\n            if (_typeof(this._config.headers) === 'object') {\n                for (var _key in this._config.headers) {\n                    headers.append(_key, this._config.headers[_key]);\n                }\n            }\n\n            // cors is enabled by default\n            if (dataSource.cors === false) {\n                // no-cors means 'disregard cors policy', which can only be used in ServiceWorker\n                params.mode = 'same-origin';\n            }\n\n            // withCredentials is disabled by default\n            if (dataSource.withCredentials) {\n                params.credentials = 'include';\n            }\n\n            // referrerPolicy from config\n            if (dataSource.referrerPolicy) {\n                params.referrerPolicy = dataSource.referrerPolicy;\n            }\n\n            // add abort controller, by wmlgl 2019-5-10 12:21:27\n            if (self.AbortController) {\n                this._abortController = new self.AbortController();\n                params.signal = this._abortController.signal;\n            }\n\n            this._status = _loader.LoaderStatus.kConnecting;\n            self.fetch(seekConfig.url, params).then(function (res) {\n                if (_this2._requestAbort) {\n                    _this2._status = _loader.LoaderStatus.kIdle;\n                    res.body.cancel();\n                    return;\n                }\n                if (res.ok && res.status >= 200 && res.status <= 299) {\n                    if (res.url !== seekConfig.url) {\n                        if (_this2._onURLRedirect) {\n                            var redirectedURL = _this2._seekHandler.removeURLParameters(res.url);\n                            _this2._onURLRedirect(redirectedURL);\n                        }\n                    }\n\n                    var lengthHeader = res.headers.get('Content-Length');\n                    if (lengthHeader != null) {\n                        _this2._contentLength = parseInt(lengthHeader);\n                        if (_this2._contentLength !== 0) {\n                            if (_this2._onContentLengthKnown) {\n                                _this2._onContentLengthKnown(_this2._contentLength);\n                            }\n                        }\n                    }\n\n                    return _this2._pump.call(_this2, res.body.getReader());\n                } else {\n                    _this2._status = _loader.LoaderStatus.kError;\n                    if (_this2._onError) {\n                        _this2._onError(_loader.LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: res.status, msg: res.statusText });\n                    } else {\n                        throw new _exception.RuntimeException('FetchStreamLoader: Http code invalid, ' + res.status + ' ' + res.statusText);\n                    }\n                }\n            }).catch(function (e) {\n                if (_this2._abortController && _this2._abortController.signal.aborted) {\n                    return;\n                }\n\n                _this2._status = _loader.LoaderStatus.kError;\n                if (_this2._onError) {\n                    _this2._onError(_loader.LoaderErrors.EXCEPTION, { code: -1, msg: e.message });\n                } else {\n                    throw e;\n                }\n            });\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            this._requestAbort = true;\n\n            if (this._status !== _loader.LoaderStatus.kBuffering || !_browser2.default.chrome) {\n                // Chrome may throw Exception-like things here, avoid using if is buffering\n                if (this._abortController) {\n                    try {\n                        this._abortController.abort();\n                    } catch (e) {\n                        return;\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_pump',\n        value: function _pump(reader) {\n            var _this3 = this;\n\n            // ReadableStreamReader\n            return reader.read().then(function (result) {\n                if (result.done) {\n                    // First check received length\n                    if (_this3._contentLength !== null && _this3._receivedLength < _this3._contentLength) {\n                        // Report Early-EOF\n                        _this3._status = _loader.LoaderStatus.kError;\n                        var type = _loader.LoaderErrors.EARLY_EOF;\n                        var info = { code: -1, msg: 'Fetch stream meet Early-EOF' };\n                        if (_this3._onError) {\n                            _this3._onError(type, info);\n                        } else {\n                            throw new _exception.RuntimeException(info.msg);\n                        }\n                    } else {\n                        // OK. Download complete\n                        _this3._status = _loader.LoaderStatus.kComplete;\n                        if (_this3._onComplete) {\n                            _this3._onComplete(_this3._range.from, _this3._range.from + _this3._receivedLength - 1);\n                        }\n                    }\n                } else {\n                    if (_this3._abortController && _this3._abortController.signal.aborted) {\n                        _this3._status = _loader.LoaderStatus.kComplete;\n                        return;\n                    } else if (_this3._requestAbort === true) {\n                        _this3._status = _loader.LoaderStatus.kComplete;\n                        return reader.cancel();\n                    }\n\n                    _this3._status = _loader.LoaderStatus.kBuffering;\n\n                    var chunk = result.value.buffer;\n                    var byteStart = _this3._range.from + _this3._receivedLength;\n                    _this3._receivedLength += chunk.byteLength;\n\n                    if (_this3._onDataArrival) {\n                        _this3._onDataArrival(chunk, byteStart, _this3._receivedLength);\n                    }\n\n                    _this3._pump(reader);\n                }\n            }).catch(function (e) {\n                if (_this3._abortController && _this3._abortController.signal.aborted) {\n                    _this3._status = _loader.LoaderStatus.kComplete;\n                    return;\n                }\n\n                if (e.code === 11 && _browser2.default.msedge) {\n                    // InvalidStateError on Microsoft Edge\n                    // Workaround: Edge may throw InvalidStateError after ReadableStreamReader.cancel() call\n                    // Ignore the unknown exception.\n                    // Related issue: https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/11265202/\n                    return;\n                }\n\n                _this3._status = _loader.LoaderStatus.kError;\n                var type = 0;\n                var info = null;\n\n                if ((e.code === 19 || e.message === 'network error') && ( // NETWORK_ERR\n                _this3._contentLength === null || _this3._contentLength !== null && _this3._receivedLength < _this3._contentLength)) {\n                    type = _loader.LoaderErrors.EARLY_EOF;\n                    info = { code: e.code, msg: 'Fetch stream meet Early-EOF' };\n                } else {\n                    type = _loader.LoaderErrors.EXCEPTION;\n                    info = { code: e.code, msg: e.message };\n                }\n\n                if (_this3._onError) {\n                    _this3._onError(type, info);\n                } else {\n                    throw new _exception.RuntimeException(info.msg);\n                }\n            });\n        }\n    }]);\n\n    return FetchStreamLoader;\n}(_loader.BaseLoader);\n\nexports.default = FetchStreamLoader;\n\n},{\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],23:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _speedSampler = _dereq_('./speed-sampler.js');\n\nvar _speedSampler2 = _interopRequireDefault(_speedSampler);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _fetchStreamLoader = _dereq_('./fetch-stream-loader.js');\n\nvar _fetchStreamLoader2 = _interopRequireDefault(_fetchStreamLoader);\n\nvar _xhrMozChunkedLoader = _dereq_('./xhr-moz-chunked-loader.js');\n\nvar _xhrMozChunkedLoader2 = _interopRequireDefault(_xhrMozChunkedLoader);\n\nvar _xhrMsstreamLoader = _dereq_('./xhr-msstream-loader.js');\n\nvar _xhrMsstreamLoader2 = _interopRequireDefault(_xhrMsstreamLoader);\n\nvar _xhrRangeLoader = _dereq_('./xhr-range-loader.js');\n\nvar _xhrRangeLoader2 = _interopRequireDefault(_xhrRangeLoader);\n\nvar _websocketLoader = _dereq_('./websocket-loader.js');\n\nvar _websocketLoader2 = _interopRequireDefault(_websocketLoader);\n\nvar _rangeSeekHandler = _dereq_('./range-seek-handler.js');\n\nvar _rangeSeekHandler2 = _interopRequireDefault(_rangeSeekHandler);\n\nvar _paramSeekHandler = _dereq_('./param-seek-handler.js');\n\nvar _paramSeekHandler2 = _interopRequireDefault(_paramSeekHandler);\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * DataSource: {\r\n *     url: string,\r\n *     filesize: number,\r\n *     cors: boolean,\r\n *     withCredentials: boolean\r\n * }\r\n * \r\n */\n\n// Manage IO Loaders\nvar IOController = function () {\n    function IOController(dataSource, config, extraData) {\n        _classCallCheck(this, IOController);\n\n        this.TAG = 'IOController';\n\n        this._config = config;\n        this._extraData = extraData;\n\n        this._stashInitialSize = 1024 * 384; // default initial size: 384KB\n        if (config.stashInitialSize != undefined && config.stashInitialSize > 0) {\n            // apply from config\n            this._stashInitialSize = config.stashInitialSize;\n        }\n\n        this._stashUsed = 0;\n        this._stashSize = this._stashInitialSize;\n        this._bufferSize = 1024 * 1024 * 3; // initial size: 3MB\n        this._stashBuffer = new ArrayBuffer(this._bufferSize);\n        this._stashByteStart = 0;\n        this._enableStash = true;\n        if (config.enableStashBuffer === false) {\n            this._enableStash = false;\n        }\n\n        this._loader = null;\n        this._loaderClass = null;\n        this._seekHandler = null;\n\n        this._dataSource = dataSource;\n        this._isWebSocketURL = /wss?:\\/\\/(.+?)/.test(dataSource.url);\n        this._refTotalLength = dataSource.filesize ? dataSource.filesize : null;\n        this._totalLength = this._refTotalLength;\n        this._fullRequestFlag = false;\n        this._currentRange = null;\n        this._redirectedURL = null;\n\n        this._speedNormalized = 0;\n        this._speedSampler = new _speedSampler2.default();\n        this._speedNormalizeList = [64, 128, 256, 384, 512, 768, 1024, 1536, 2048, 3072, 4096];\n\n        this._isEarlyEofReconnecting = false;\n\n        this._paused = false;\n        this._resumeFrom = 0;\n\n        this._onDataArrival = null;\n        this._onSeeked = null;\n        this._onError = null;\n        this._onComplete = null;\n        this._onRedirect = null;\n        this._onRecoveredEarlyEof = null;\n\n        this._selectSeekHandler();\n        this._selectLoader();\n        this._createLoader();\n    }\n\n    _createClass(IOController, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._loader.isWorking()) {\n                this._loader.abort();\n            }\n            this._loader.destroy();\n            this._loader = null;\n            this._loaderClass = null;\n            this._dataSource = null;\n            this._stashBuffer = null;\n            this._stashUsed = this._stashSize = this._bufferSize = this._stashByteStart = 0;\n            this._currentRange = null;\n            this._speedSampler = null;\n\n            this._isEarlyEofReconnecting = false;\n\n            this._onDataArrival = null;\n            this._onSeeked = null;\n            this._onError = null;\n            this._onComplete = null;\n            this._onRedirect = null;\n            this._onRecoveredEarlyEof = null;\n\n            this._extraData = null;\n        }\n    }, {\n        key: 'isWorking',\n        value: function isWorking() {\n            return this._loader && this._loader.isWorking() && !this._paused;\n        }\n    }, {\n        key: 'isPaused',\n        value: function isPaused() {\n            return this._paused;\n        }\n    }, {\n        key: '_selectSeekHandler',\n        value: function _selectSeekHandler() {\n            var config = this._config;\n\n            if (config.seekType === 'range') {\n                this._seekHandler = new _rangeSeekHandler2.default(this._config.rangeLoadZeroStart);\n            } else if (config.seekType === 'param') {\n                var paramStart = config.seekParamStart || 'bstart';\n                var paramEnd = config.seekParamEnd || 'bend';\n\n                this._seekHandler = new _paramSeekHandler2.default(paramStart, paramEnd);\n            } else if (config.seekType === 'custom') {\n                if (typeof config.customSeekHandler !== 'function') {\n                    throw new _exception.InvalidArgumentException('Custom seekType specified in config but invalid customSeekHandler!');\n                }\n                this._seekHandler = new config.customSeekHandler();\n            } else {\n                throw new _exception.InvalidArgumentException('Invalid seekType in config: ' + config.seekType);\n            }\n        }\n    }, {\n        key: '_selectLoader',\n        value: function _selectLoader() {\n            if (this._config.customLoader != null) {\n                this._loaderClass = this._config.customLoader;\n            } else if (this._isWebSocketURL) {\n                this._loaderClass = _websocketLoader2.default;\n            } else if (_fetchStreamLoader2.default.isSupported()) {\n                this._loaderClass = _fetchStreamLoader2.default;\n            } else if (_xhrMozChunkedLoader2.default.isSupported()) {\n                this._loaderClass = _xhrMozChunkedLoader2.default;\n            } else if (_xhrRangeLoader2.default.isSupported()) {\n                this._loaderClass = _xhrRangeLoader2.default;\n            } else {\n                throw new _exception.RuntimeException('Your browser doesn\\'t support xhr with arraybuffer responseType!');\n            }\n        }\n    }, {\n        key: '_createLoader',\n        value: function _createLoader() {\n            this._loader = new this._loaderClass(this._seekHandler, this._config);\n            if (this._loader.needStashBuffer === false) {\n                this._enableStash = false;\n            }\n            this._loader.onContentLengthKnown = this._onContentLengthKnown.bind(this);\n            this._loader.onURLRedirect = this._onURLRedirect.bind(this);\n            this._loader.onDataArrival = this._onLoaderChunkArrival.bind(this);\n            this._loader.onComplete = this._onLoaderComplete.bind(this);\n            this._loader.onError = this._onLoaderError.bind(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(optionalFrom) {\n            this._currentRange = { from: 0, to: -1 };\n            if (optionalFrom) {\n                this._currentRange.from = optionalFrom;\n            }\n\n            this._speedSampler.reset();\n            if (!optionalFrom) {\n                this._fullRequestFlag = true;\n            }\n\n            this._loader.open(this._dataSource, Object.assign({}, this._currentRange));\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            this._loader.abort();\n\n            if (this._paused) {\n                this._paused = false;\n                this._resumeFrom = 0;\n            }\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            if (this.isWorking()) {\n                this._loader.abort();\n\n                if (this._stashUsed !== 0) {\n                    this._resumeFrom = this._stashByteStart;\n                    this._currentRange.to = this._stashByteStart - 1;\n                } else {\n                    this._resumeFrom = this._currentRange.to + 1;\n                }\n                this._stashUsed = 0;\n                this._stashByteStart = 0;\n                this._paused = true;\n            }\n        }\n    }, {\n        key: 'resume',\n        value: function resume() {\n            if (this._paused) {\n                this._paused = false;\n                var bytes = this._resumeFrom;\n                this._resumeFrom = 0;\n                this._internalSeek(bytes, true);\n            }\n        }\n    }, {\n        key: 'seek',\n        value: function seek(bytes) {\n            this._paused = false;\n            this._stashUsed = 0;\n            this._stashByteStart = 0;\n            this._internalSeek(bytes, true);\n        }\n\n        /**\r\n         * When seeking request is from media seeking, unconsumed stash data should be dropped\r\n         * However, stash data shouldn't be dropped if seeking requested from http reconnection\r\n         *\r\n         * @dropUnconsumed: Ignore and discard all unconsumed data in stash buffer\r\n         */\n\n    }, {\n        key: '_internalSeek',\n        value: function _internalSeek(bytes, dropUnconsumed) {\n            if (this._loader.isWorking()) {\n                this._loader.abort();\n            }\n\n            // dispatch & flush stash buffer before seek\n            this._flushStashBuffer(dropUnconsumed);\n\n            this._loader.destroy();\n            this._loader = null;\n\n            var requestRange = { from: bytes, to: -1 };\n            this._currentRange = { from: requestRange.from, to: -1 };\n\n            this._speedSampler.reset();\n            this._stashSize = this._stashInitialSize;\n            this._createLoader();\n            this._loader.open(this._dataSource, requestRange);\n\n            if (this._onSeeked) {\n                this._onSeeked();\n            }\n        }\n    }, {\n        key: 'updateUrl',\n        value: function updateUrl(url) {\n            if (!url || typeof url !== 'string' || url.length === 0) {\n                throw new _exception.InvalidArgumentException('Url must be a non-empty string!');\n            }\n\n            this._dataSource.url = url;\n\n            // TODO: replace with new url\n        }\n    }, {\n        key: '_expandBuffer',\n        value: function _expandBuffer(expectedBytes) {\n            var bufferNewSize = this._stashSize;\n            while (bufferNewSize + 1024 * 1024 * 1 < expectedBytes) {\n                bufferNewSize *= 2;\n            }\n\n            bufferNewSize += 1024 * 1024 * 1; // bufferSize = stashSize + 1MB\n            if (bufferNewSize === this._bufferSize) {\n                return;\n            }\n\n            var newBuffer = new ArrayBuffer(bufferNewSize);\n\n            if (this._stashUsed > 0) {\n                // copy existing data into new buffer\n                var stashOldArray = new Uint8Array(this._stashBuffer, 0, this._stashUsed);\n                var stashNewArray = new Uint8Array(newBuffer, 0, bufferNewSize);\n                stashNewArray.set(stashOldArray, 0);\n            }\n\n            this._stashBuffer = newBuffer;\n            this._bufferSize = bufferNewSize;\n        }\n    }, {\n        key: '_normalizeSpeed',\n        value: function _normalizeSpeed(input) {\n            var list = this._speedNormalizeList;\n            var last = list.length - 1;\n            var mid = 0;\n            var lbound = 0;\n            var ubound = last;\n\n            if (input < list[0]) {\n                return list[0];\n            }\n\n            // binary search\n            while (lbound <= ubound) {\n                mid = lbound + Math.floor((ubound - lbound) / 2);\n                if (mid === last || input >= list[mid] && input < list[mid + 1]) {\n                    return list[mid];\n                } else if (list[mid] < input) {\n                    lbound = mid + 1;\n                } else {\n                    ubound = mid - 1;\n                }\n            }\n        }\n    }, {\n        key: '_adjustStashSize',\n        value: function _adjustStashSize(normalized) {\n            var stashSizeKB = 0;\n\n            if (this._config.isLive) {\n                // live stream: always use single normalized speed for size of stashSizeKB\n                stashSizeKB = normalized;\n            } else {\n                if (normalized < 512) {\n                    stashSizeKB = normalized;\n                } else if (normalized >= 512 && normalized <= 1024) {\n                    stashSizeKB = Math.floor(normalized * 1.5);\n                } else {\n                    stashSizeKB = normalized * 2;\n                }\n            }\n\n            if (stashSizeKB > 8192) {\n                stashSizeKB = 8192;\n            }\n\n            var bufferSize = stashSizeKB * 1024 + 1024 * 1024 * 1; // stashSize + 1MB\n            if (this._bufferSize < bufferSize) {\n                this._expandBuffer(bufferSize);\n            }\n            this._stashSize = stashSizeKB * 1024;\n        }\n    }, {\n        key: '_dispatchChunks',\n        value: function _dispatchChunks(chunks, byteStart) {\n            this._currentRange.to = byteStart + chunks.byteLength - 1;\n            return this._onDataArrival(chunks, byteStart);\n        }\n    }, {\n        key: '_onURLRedirect',\n        value: function _onURLRedirect(redirectedURL) {\n            this._redirectedURL = redirectedURL;\n            if (this._onRedirect) {\n                this._onRedirect(redirectedURL);\n            }\n        }\n    }, {\n        key: '_onContentLengthKnown',\n        value: function _onContentLengthKnown(contentLength) {\n            if (contentLength && this._fullRequestFlag) {\n                this._totalLength = contentLength;\n                this._fullRequestFlag = false;\n            }\n        }\n    }, {\n        key: '_onLoaderChunkArrival',\n        value: function _onLoaderChunkArrival(chunk, byteStart, receivedLength) {\n            if (!this._onDataArrival) {\n                throw new _exception.IllegalStateException('IOController: No existing consumer (onDataArrival) callback!');\n            }\n            if (this._paused) {\n                return;\n            }\n            if (this._isEarlyEofReconnecting) {\n                // Auto-reconnect for EarlyEof succeed, notify to upper-layer by callback\n                this._isEarlyEofReconnecting = false;\n                if (this._onRecoveredEarlyEof) {\n                    this._onRecoveredEarlyEof();\n                }\n            }\n\n            this._speedSampler.addBytes(chunk.byteLength);\n\n            // adjust stash buffer size according to network speed dynamically\n            var KBps = this._speedSampler.lastSecondKBps;\n            if (KBps !== 0) {\n                var normalized = this._normalizeSpeed(KBps);\n                if (this._speedNormalized !== normalized) {\n                    this._speedNormalized = normalized;\n                    this._adjustStashSize(normalized);\n                }\n            }\n\n            if (!this._enableStash) {\n                // disable stash\n                if (this._stashUsed === 0) {\n                    // dispatch chunk directly to consumer;\n                    // check ret value (consumed bytes) and stash unconsumed to stashBuffer\n                    var consumed = this._dispatchChunks(chunk, byteStart);\n                    if (consumed < chunk.byteLength) {\n                        // unconsumed data remain.\n                        var remain = chunk.byteLength - consumed;\n                        if (remain > this._bufferSize) {\n                            this._expandBuffer(remain);\n                        }\n                        var stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                        stashArray.set(new Uint8Array(chunk, consumed), 0);\n                        this._stashUsed += remain;\n                        this._stashByteStart = byteStart + consumed;\n                    }\n                } else {\n                    // else: Merge chunk into stashBuffer, and dispatch stashBuffer to consumer.\n                    if (this._stashUsed + chunk.byteLength > this._bufferSize) {\n                        this._expandBuffer(this._stashUsed + chunk.byteLength);\n                    }\n                    var _stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                    _stashArray.set(new Uint8Array(chunk), this._stashUsed);\n                    this._stashUsed += chunk.byteLength;\n                    var _consumed = this._dispatchChunks(this._stashBuffer.slice(0, this._stashUsed), this._stashByteStart);\n                    if (_consumed < this._stashUsed && _consumed > 0) {\n                        // unconsumed data remain\n                        var remainArray = new Uint8Array(this._stashBuffer, _consumed);\n                        _stashArray.set(remainArray, 0);\n                    }\n                    this._stashUsed -= _consumed;\n                    this._stashByteStart += _consumed;\n                }\n            } else {\n                // enable stash\n                if (this._stashUsed === 0 && this._stashByteStart === 0) {\n                    // seeked? or init chunk?\n                    // This is the first chunk after seek action\n                    this._stashByteStart = byteStart;\n                }\n                if (this._stashUsed + chunk.byteLength <= this._stashSize) {\n                    // just stash\n                    var _stashArray2 = new Uint8Array(this._stashBuffer, 0, this._stashSize);\n                    _stashArray2.set(new Uint8Array(chunk), this._stashUsed);\n                    this._stashUsed += chunk.byteLength;\n                } else {\n                    // stashUsed + chunkSize > stashSize, size limit exceeded\n                    var _stashArray3 = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                    if (this._stashUsed > 0) {\n                        // There're stash datas in buffer\n                        // dispatch the whole stashBuffer, and stash remain data\n                        // then append chunk to stashBuffer (stash)\n                        var buffer = this._stashBuffer.slice(0, this._stashUsed);\n                        var _consumed2 = this._dispatchChunks(buffer, this._stashByteStart);\n                        if (_consumed2 < buffer.byteLength) {\n                            if (_consumed2 > 0) {\n                                var _remainArray = new Uint8Array(buffer, _consumed2);\n                                _stashArray3.set(_remainArray, 0);\n                                this._stashUsed = _remainArray.byteLength;\n                                this._stashByteStart += _consumed2;\n                            }\n                        } else {\n                            this._stashUsed = 0;\n                            this._stashByteStart += _consumed2;\n                        }\n                        if (this._stashUsed + chunk.byteLength > this._bufferSize) {\n                            this._expandBuffer(this._stashUsed + chunk.byteLength);\n                            _stashArray3 = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                        }\n                        _stashArray3.set(new Uint8Array(chunk), this._stashUsed);\n                        this._stashUsed += chunk.byteLength;\n                    } else {\n                        // stash buffer empty, but chunkSize > stashSize (oh, holy shit)\n                        // dispatch chunk directly and stash remain data\n                        var _consumed3 = this._dispatchChunks(chunk, byteStart);\n                        if (_consumed3 < chunk.byteLength) {\n                            var _remain = chunk.byteLength - _consumed3;\n                            if (_remain > this._bufferSize) {\n                                this._expandBuffer(_remain);\n                                _stashArray3 = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                            }\n                            _stashArray3.set(new Uint8Array(chunk, _consumed3), 0);\n                            this._stashUsed += _remain;\n                            this._stashByteStart = byteStart + _consumed3;\n                        }\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_flushStashBuffer',\n        value: function _flushStashBuffer(dropUnconsumed) {\n            if (this._stashUsed > 0) {\n                var buffer = this._stashBuffer.slice(0, this._stashUsed);\n                var consumed = this._dispatchChunks(buffer, this._stashByteStart);\n                var remain = buffer.byteLength - consumed;\n\n                if (consumed < buffer.byteLength) {\n                    if (dropUnconsumed) {\n                        _logger2.default.w(this.TAG, remain + ' bytes unconsumed data remain when flush buffer, dropped');\n                    } else {\n                        if (consumed > 0) {\n                            var stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                            var remainArray = new Uint8Array(buffer, consumed);\n                            stashArray.set(remainArray, 0);\n                            this._stashUsed = remainArray.byteLength;\n                            this._stashByteStart += consumed;\n                        }\n                        return 0;\n                    }\n                }\n                this._stashUsed = 0;\n                this._stashByteStart = 0;\n                return remain;\n            }\n            return 0;\n        }\n    }, {\n        key: '_onLoaderComplete',\n        value: function _onLoaderComplete(from, to) {\n            // Force-flush stash buffer, and drop unconsumed data\n            this._flushStashBuffer(true);\n\n            if (this._onComplete) {\n                this._onComplete(this._extraData);\n            }\n        }\n    }, {\n        key: '_onLoaderError',\n        value: function _onLoaderError(type, data) {\n            _logger2.default.e(this.TAG, 'Loader error, code = ' + data.code + ', msg = ' + data.msg);\n\n            this._flushStashBuffer(false);\n\n            if (this._isEarlyEofReconnecting) {\n                // Auto-reconnect for EarlyEof failed, throw UnrecoverableEarlyEof error to upper-layer\n                this._isEarlyEofReconnecting = false;\n                type = _loader.LoaderErrors.UNRECOVERABLE_EARLY_EOF;\n            }\n\n            switch (type) {\n                case _loader.LoaderErrors.EARLY_EOF:\n                    {\n                        if (!this._config.isLive) {\n                            // Do internal http reconnect if not live stream\n                            if (this._totalLength) {\n                                var nextFrom = this._currentRange.to + 1;\n                                if (nextFrom < this._totalLength) {\n                                    _logger2.default.w(this.TAG, 'Connection lost, trying reconnect...');\n                                    this._isEarlyEofReconnecting = true;\n                                    this._internalSeek(nextFrom, false);\n                                }\n                                return;\n                            }\n                            // else: We don't know totalLength, throw UnrecoverableEarlyEof\n                        }\n                        // live stream: throw UnrecoverableEarlyEof error to upper-layer\n                        type = _loader.LoaderErrors.UNRECOVERABLE_EARLY_EOF;\n                        break;\n                    }\n                case _loader.LoaderErrors.UNRECOVERABLE_EARLY_EOF:\n                case _loader.LoaderErrors.CONNECTING_TIMEOUT:\n                case _loader.LoaderErrors.HTTP_STATUS_CODE_INVALID:\n                case _loader.LoaderErrors.EXCEPTION:\n                    break;\n            }\n\n            if (this._onError) {\n                this._onError(type, data);\n            } else {\n                throw new _exception.RuntimeException('IOException: ' + data.msg);\n            }\n        }\n    }, {\n        key: 'status',\n        get: function get() {\n            return this._loader.status;\n        }\n    }, {\n        key: 'extraData',\n        get: function get() {\n            return this._extraData;\n        },\n        set: function set(data) {\n            this._extraData = data;\n        }\n\n        // prototype: function onDataArrival(chunks: ArrayBuffer, byteStart: number): number\n\n    }, {\n        key: 'onDataArrival',\n        get: function get() {\n            return this._onDataArrival;\n        },\n        set: function set(callback) {\n            this._onDataArrival = callback;\n        }\n    }, {\n        key: 'onSeeked',\n        get: function get() {\n            return this._onSeeked;\n        },\n        set: function set(callback) {\n            this._onSeeked = callback;\n        }\n\n        // prototype: function onError(type: number, info: {code: number, msg: string}): void\n\n    }, {\n        key: 'onError',\n        get: function get() {\n            return this._onError;\n        },\n        set: function set(callback) {\n            this._onError = callback;\n        }\n    }, {\n        key: 'onComplete',\n        get: function get() {\n            return this._onComplete;\n        },\n        set: function set(callback) {\n            this._onComplete = callback;\n        }\n    }, {\n        key: 'onRedirect',\n        get: function get() {\n            return this._onRedirect;\n        },\n        set: function set(callback) {\n            this._onRedirect = callback;\n        }\n    }, {\n        key: 'onRecoveredEarlyEof',\n        get: function get() {\n            return this._onRecoveredEarlyEof;\n        },\n        set: function set(callback) {\n            this._onRecoveredEarlyEof = callback;\n        }\n    }, {\n        key: 'currentURL',\n        get: function get() {\n            return this._dataSource.url;\n        }\n    }, {\n        key: 'hasRedirect',\n        get: function get() {\n            return this._redirectedURL != null || this._dataSource.redirectedURL != undefined;\n        }\n    }, {\n        key: 'currentRedirectedURL',\n        get: function get() {\n            return this._redirectedURL || this._dataSource.redirectedURL;\n        }\n\n        // in KB/s\n\n    }, {\n        key: 'currentSpeed',\n        get: function get() {\n            if (this._loaderClass === _xhrRangeLoader2.default) {\n                // SpeedSampler is inaccuracy if loader is RangeLoader\n                return this._loader.currentSpeed;\n            }\n            return this._speedSampler.lastSecondKBps;\n        }\n    }, {\n        key: 'loaderType',\n        get: function get() {\n            return this._loader.type;\n        }\n    }]);\n\n    return IOController;\n}();\n\nexports.default = IOController;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./fetch-stream-loader.js\":22,\"./loader.js\":24,\"./param-seek-handler.js\":25,\"./range-seek-handler.js\":26,\"./speed-sampler.js\":27,\"./websocket-loader.js\":28,\"./xhr-moz-chunked-loader.js\":29,\"./xhr-msstream-loader.js\":30,\"./xhr-range-loader.js\":31}],24:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.BaseLoader = exports.LoaderErrors = exports.LoaderStatus = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar LoaderStatus = exports.LoaderStatus = {\n    kIdle: 0,\n    kConnecting: 1,\n    kBuffering: 2,\n    kError: 3,\n    kComplete: 4\n};\n\nvar LoaderErrors = exports.LoaderErrors = {\n    OK: 'OK',\n    EXCEPTION: 'Exception',\n    HTTP_STATUS_CODE_INVALID: 'HttpStatusCodeInvalid',\n    CONNECTING_TIMEOUT: 'ConnectingTimeout',\n    EARLY_EOF: 'EarlyEof',\n    UNRECOVERABLE_EARLY_EOF: 'UnrecoverableEarlyEof'\n};\n\n/* Loader has callbacks which have following prototypes:\r\n *     function onContentLengthKnown(contentLength: number): void\r\n *     function onURLRedirect(url: string): void\r\n *     function onDataArrival(chunk: ArrayBuffer, byteStart: number, receivedLength: number): void\r\n *     function onError(errorType: number, errorInfo: {code: number, msg: string}): void\r\n *     function onComplete(rangeFrom: number, rangeTo: number): void\r\n */\n\nvar BaseLoader = exports.BaseLoader = function () {\n    function BaseLoader(typeName) {\n        _classCallCheck(this, BaseLoader);\n\n        this._type = typeName || 'undefined';\n        this._status = LoaderStatus.kIdle;\n        this._needStash = false;\n        // callbacks\n        this._onContentLengthKnown = null;\n        this._onURLRedirect = null;\n        this._onDataArrival = null;\n        this._onError = null;\n        this._onComplete = null;\n    }\n\n    _createClass(BaseLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._status = LoaderStatus.kIdle;\n            this._onContentLengthKnown = null;\n            this._onURLRedirect = null;\n            this._onDataArrival = null;\n            this._onError = null;\n            this._onComplete = null;\n        }\n    }, {\n        key: 'isWorking',\n        value: function isWorking() {\n            return this._status === LoaderStatus.kConnecting || this._status === LoaderStatus.kBuffering;\n        }\n    }, {\n        key: 'open',\n\n\n        // pure virtual\n        value: function open(dataSource, range) {\n            throw new _exception.NotImplementedException('Unimplemented abstract function!');\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            throw new _exception.NotImplementedException('Unimplemented abstract function!');\n        }\n    }, {\n        key: 'type',\n        get: function get() {\n            return this._type;\n        }\n    }, {\n        key: 'status',\n        get: function get() {\n            return this._status;\n        }\n    }, {\n        key: 'needStashBuffer',\n        get: function get() {\n            return this._needStash;\n        }\n    }, {\n        key: 'onContentLengthKnown',\n        get: function get() {\n            return this._onContentLengthKnown;\n        },\n        set: function set(callback) {\n            this._onContentLengthKnown = callback;\n        }\n    }, {\n        key: 'onURLRedirect',\n        get: function get() {\n            return this._onURLRedirect;\n        },\n        set: function set(callback) {\n            this._onURLRedirect = callback;\n        }\n    }, {\n        key: 'onDataArrival',\n        get: function get() {\n            return this._onDataArrival;\n        },\n        set: function set(callback) {\n            this._onDataArrival = callback;\n        }\n    }, {\n        key: 'onError',\n        get: function get() {\n            return this._onError;\n        },\n        set: function set(callback) {\n            this._onError = callback;\n        }\n    }, {\n        key: 'onComplete',\n        get: function get() {\n            return this._onComplete;\n        },\n        set: function set(callback) {\n            this._onComplete = callback;\n        }\n    }]);\n\n    return BaseLoader;\n}();\n\n},{\"../utils/exception.js\":40}],25:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar ParamSeekHandler = function () {\n    function ParamSeekHandler(paramStart, paramEnd) {\n        _classCallCheck(this, ParamSeekHandler);\n\n        this._startName = paramStart;\n        this._endName = paramEnd;\n    }\n\n    _createClass(ParamSeekHandler, [{\n        key: 'getConfig',\n        value: function getConfig(baseUrl, range) {\n            var url = baseUrl;\n\n            if (range.from !== 0 || range.to !== -1) {\n                var needAnd = true;\n                if (url.indexOf('?') === -1) {\n                    url += '?';\n                    needAnd = false;\n                }\n\n                if (needAnd) {\n                    url += '&';\n                }\n\n                url += this._startName + '=' + range.from.toString();\n\n                if (range.to !== -1) {\n                    url += '&' + this._endName + '=' + range.to.toString();\n                }\n            }\n\n            return {\n                url: url,\n                headers: {}\n            };\n        }\n    }, {\n        key: 'removeURLParameters',\n        value: function removeURLParameters(seekedURL) {\n            var baseURL = seekedURL.split('?')[0];\n            var params = undefined;\n\n            var queryIndex = seekedURL.indexOf('?');\n            if (queryIndex !== -1) {\n                params = seekedURL.substring(queryIndex + 1);\n            }\n\n            var resultParams = '';\n\n            if (params != undefined && params.length > 0) {\n                var pairs = params.split('&');\n\n                for (var i = 0; i < pairs.length; i++) {\n                    var pair = pairs[i].split('=');\n                    var requireAnd = i > 0;\n\n                    if (pair[0] !== this._startName && pair[0] !== this._endName) {\n                        if (requireAnd) {\n                            resultParams += '&';\n                        }\n                        resultParams += pairs[i];\n                    }\n                }\n            }\n\n            return resultParams.length === 0 ? baseURL : baseURL + '?' + resultParams;\n        }\n    }]);\n\n    return ParamSeekHandler;\n}();\n\nexports.default = ParamSeekHandler;\n\n},{}],26:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar RangeSeekHandler = function () {\n    function RangeSeekHandler(zeroStart) {\n        _classCallCheck(this, RangeSeekHandler);\n\n        this._zeroStart = zeroStart || false;\n    }\n\n    _createClass(RangeSeekHandler, [{\n        key: 'getConfig',\n        value: function getConfig(url, range) {\n            var headers = {};\n\n            if (range.from !== 0 || range.to !== -1) {\n                var param = void 0;\n                if (range.to !== -1) {\n                    param = 'bytes=' + range.from.toString() + '-' + range.to.toString();\n                } else {\n                    param = 'bytes=' + range.from.toString() + '-';\n                }\n                headers['Range'] = param;\n            } else if (this._zeroStart) {\n                headers['Range'] = 'bytes=0-';\n            }\n\n            return {\n                url: url,\n                headers: headers\n            };\n        }\n    }, {\n        key: 'removeURLParameters',\n        value: function removeURLParameters(seekedURL) {\n            return seekedURL;\n        }\n    }]);\n\n    return RangeSeekHandler;\n}();\n\nexports.default = RangeSeekHandler;\n\n},{}],27:[function(_dereq_,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n// Utility class to calculate realtime network I/O speed\nvar SpeedSampler = function () {\n    function SpeedSampler() {\n        _classCallCheck(this, SpeedSampler);\n\n        // milliseconds\n        this._firstCheckpoint = 0;\n        this._lastCheckpoint = 0;\n        this._intervalBytes = 0;\n        this._totalBytes = 0;\n        this._lastSecondBytes = 0;\n\n        // compatibility detection\n        if (self.performance && self.performance.now) {\n            this._now = self.performance.now.bind(self.performance);\n        } else {\n            this._now = Date.now;\n        }\n    }\n\n    _createClass(SpeedSampler, [{\n        key: \"reset\",\n        value: function reset() {\n            this._firstCheckpoint = this._lastCheckpoint = 0;\n            this._totalBytes = this._intervalBytes = 0;\n            this._lastSecondBytes = 0;\n        }\n    }, {\n        key: \"addBytes\",\n        value: function addBytes(bytes) {\n            if (this._firstCheckpoint === 0) {\n                this._firstCheckpoint = this._now();\n                this._lastCheckpoint = this._firstCheckpoint;\n                this._intervalBytes += bytes;\n                this._totalBytes += bytes;\n            } else if (this._now() - this._lastCheckpoint < 1000) {\n                this._intervalBytes += bytes;\n                this._totalBytes += bytes;\n            } else {\n                // duration >= 1000\n                this._lastSecondBytes = this._intervalBytes;\n                this._intervalBytes = bytes;\n                this._totalBytes += bytes;\n                this._lastCheckpoint = this._now();\n            }\n        }\n    }, {\n        key: \"currentKBps\",\n        get: function get() {\n            this.addBytes(0);\n\n            var durationSeconds = (this._now() - this._lastCheckpoint) / 1000;\n            if (durationSeconds == 0) durationSeconds = 1;\n            return this._intervalBytes / durationSeconds / 1024;\n        }\n    }, {\n        key: \"lastSecondKBps\",\n        get: function get() {\n            this.addBytes(0);\n\n            if (this._lastSecondBytes !== 0) {\n                return this._lastSecondBytes / 1024;\n            } else {\n                // lastSecondBytes === 0\n                if (this._now() - this._lastCheckpoint >= 500) {\n                    // if time interval since last checkpoint has exceeded 500ms\n                    // the speed is nearly accurate\n                    return this.currentKBps;\n                } else {\n                    // We don't know\n                    return 0;\n                }\n            }\n        }\n    }, {\n        key: \"averageKBps\",\n        get: function get() {\n            var durationSeconds = (this._now() - this._firstCheckpoint) / 1000;\n            return this._totalBytes / durationSeconds / 1024;\n        }\n    }]);\n\n    return SpeedSampler;\n}();\n\nexports.default = SpeedSampler;\n\n},{}],28:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n// For FLV over WebSocket live stream\nvar WebSocketLoader = function (_BaseLoader) {\n    _inherits(WebSocketLoader, _BaseLoader);\n\n    _createClass(WebSocketLoader, null, [{\n        key: 'isSupported',\n        value: function isSupported() {\n            try {\n                return typeof self.WebSocket !== 'undefined';\n            } catch (e) {\n                return false;\n            }\n        }\n    }]);\n\n    function WebSocketLoader() {\n        _classCallCheck(this, WebSocketLoader);\n\n        var _this = _possibleConstructorReturn(this, (WebSocketLoader.__proto__ || Object.getPrototypeOf(WebSocketLoader)).call(this, 'websocket-loader'));\n\n        _this.TAG = 'WebSocketLoader';\n\n        _this._needStash = true;\n\n        _this._ws = null;\n        _this._requestAbort = false;\n        _this._receivedLength = 0;\n        return _this;\n    }\n\n    _createClass(WebSocketLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._ws) {\n                this.abort();\n            }\n            _get(WebSocketLoader.prototype.__proto__ || Object.getPrototypeOf(WebSocketLoader.prototype), 'destroy', this).call(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(dataSource) {\n            try {\n                var ws = this._ws = new self.WebSocket(dataSource.url);\n                ws.binaryType = 'arraybuffer';\n                ws.onopen = this._onWebSocketOpen.bind(this);\n                ws.onclose = this._onWebSocketClose.bind(this);\n                ws.onmessage = this._onWebSocketMessage.bind(this);\n                ws.onerror = this._onWebSocketError.bind(this);\n\n                this._status = _loader.LoaderStatus.kConnecting;\n            } catch (e) {\n                this._status = _loader.LoaderStatus.kError;\n\n                var info = { code: e.code, msg: e.message };\n\n                if (this._onError) {\n                    this._onError(_loader.LoaderErrors.EXCEPTION, info);\n                } else {\n                    throw new _exception.RuntimeException(info.msg);\n                }\n            }\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            var ws = this._ws;\n            if (ws && (ws.readyState === 0 || ws.readyState === 1)) {\n                // CONNECTING || OPEN\n                this._requestAbort = true;\n                ws.close();\n            }\n\n            this._ws = null;\n            this._status = _loader.LoaderStatus.kComplete;\n        }\n    }, {\n        key: '_onWebSocketOpen',\n        value: function _onWebSocketOpen(e) {\n            this._status = _loader.LoaderStatus.kBuffering;\n        }\n    }, {\n        key: '_onWebSocketClose',\n        value: function _onWebSocketClose(e) {\n            if (this._requestAbort === true) {\n                this._requestAbort = false;\n                return;\n            }\n\n            this._status = _loader.LoaderStatus.kComplete;\n\n            if (this._onComplete) {\n                this._onComplete(0, this._receivedLength - 1);\n            }\n        }\n    }, {\n        key: '_onWebSocketMessage',\n        value: function _onWebSocketMessage(e) {\n            var _this2 = this;\n\n            if (e.data instanceof ArrayBuffer) {\n                this._dispatchArrayBuffer(e.data);\n            } else if (e.data instanceof Blob) {\n                var reader = new FileReader();\n                reader.onload = function () {\n                    _this2._dispatchArrayBuffer(reader.result);\n                };\n                reader.readAsArrayBuffer(e.data);\n            } else {\n                this._status = _loader.LoaderStatus.kError;\n                var info = { code: -1, msg: 'Unsupported WebSocket message type: ' + e.data.constructor.name };\n\n                if (this._onError) {\n                    this._onError(_loader.LoaderErrors.EXCEPTION, info);\n                } else {\n                    throw new _exception.RuntimeException(info.msg);\n                }\n            }\n        }\n    }, {\n        key: '_dispatchArrayBuffer',\n        value: function _dispatchArrayBuffer(arraybuffer) {\n            var chunk = arraybuffer;\n            var byteStart = this._receivedLength;\n            this._receivedLength += chunk.byteLength;\n\n            if (this._onDataArrival) {\n                this._onDataArrival(chunk, byteStart, this._receivedLength);\n            }\n        }\n    }, {\n        key: '_onWebSocketError',\n        value: function _onWebSocketError(e) {\n            this._status = _loader.LoaderStatus.kError;\n\n            var info = {\n                code: e.code,\n                msg: e.message\n            };\n\n            if (this._onError) {\n                this._onError(_loader.LoaderErrors.EXCEPTION, info);\n            } else {\n                throw new _exception.RuntimeException(info.msg);\n            }\n        }\n    }]);\n\n    return WebSocketLoader;\n}(_loader.BaseLoader);\n\nexports.default = WebSocketLoader;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],29:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n// For FireFox browser which supports `xhr.responseType = 'moz-chunked-arraybuffer'`\nvar MozChunkedLoader = function (_BaseLoader) {\n    _inherits(MozChunkedLoader, _BaseLoader);\n\n    _createClass(MozChunkedLoader, null, [{\n        key: 'isSupported',\n        value: function isSupported() {\n            try {\n                var xhr = new XMLHttpRequest();\n                // Firefox 37- requires .open() to be called before setting responseType\n                xhr.open('GET', 'https://example.com', true);\n                xhr.responseType = 'moz-chunked-arraybuffer';\n                return xhr.responseType === 'moz-chunked-arraybuffer';\n            } catch (e) {\n                _logger2.default.w('MozChunkedLoader', e.message);\n                return false;\n            }\n        }\n    }]);\n\n    function MozChunkedLoader(seekHandler, config) {\n        _classCallCheck(this, MozChunkedLoader);\n\n        var _this = _possibleConstructorReturn(this, (MozChunkedLoader.__proto__ || Object.getPrototypeOf(MozChunkedLoader)).call(this, 'xhr-moz-chunked-loader'));\n\n        _this.TAG = 'MozChunkedLoader';\n\n        _this._seekHandler = seekHandler;\n        _this._config = config;\n        _this._needStash = true;\n\n        _this._xhr = null;\n        _this._requestAbort = false;\n        _this._contentLength = null;\n        _this._receivedLength = 0;\n        return _this;\n    }\n\n    _createClass(MozChunkedLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this.isWorking()) {\n                this.abort();\n            }\n            if (this._xhr) {\n                this._xhr.onreadystatechange = null;\n                this._xhr.onprogress = null;\n                this._xhr.onloadend = null;\n                this._xhr.onerror = null;\n                this._xhr = null;\n            }\n            _get(MozChunkedLoader.prototype.__proto__ || Object.getPrototypeOf(MozChunkedLoader.prototype), 'destroy', this).call(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(dataSource, range) {\n            this._dataSource = dataSource;\n            this._range = range;\n\n            var sourceURL = dataSource.url;\n            if (this._config.reuseRedirectedURL && dataSource.redirectedURL != undefined) {\n                sourceURL = dataSource.redirectedURL;\n            }\n\n            var seekConfig = this._seekHandler.getConfig(sourceURL, range);\n            this._requestURL = seekConfig.url;\n\n            var xhr = this._xhr = new XMLHttpRequest();\n            xhr.open('GET', seekConfig.url, true);\n            xhr.responseType = 'moz-chunked-arraybuffer';\n            xhr.onreadystatechange = this._onReadyStateChange.bind(this);\n            xhr.onprogress = this._onProgress.bind(this);\n            xhr.onloadend = this._onLoadEnd.bind(this);\n            xhr.onerror = this._onXhrError.bind(this);\n\n            // cors is auto detected and enabled by xhr\n\n            // withCredentials is disabled by default\n            if (dataSource.withCredentials) {\n                xhr.withCredentials = true;\n            }\n\n            if (_typeof(seekConfig.headers) === 'object') {\n                var headers = seekConfig.headers;\n\n                for (var key in headers) {\n                    if (headers.hasOwnProperty(key)) {\n                        xhr.setRequestHeader(key, headers[key]);\n                    }\n                }\n            }\n\n            // add additional headers\n            if (_typeof(this._config.headers) === 'object') {\n                var _headers = this._config.headers;\n\n                for (var _key in _headers) {\n                    if (_headers.hasOwnProperty(_key)) {\n                        xhr.setRequestHeader(_key, _headers[_key]);\n                    }\n                }\n            }\n\n            this._status = _loader.LoaderStatus.kConnecting;\n            xhr.send();\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            this._requestAbort = true;\n            if (this._xhr) {\n                this._xhr.abort();\n            }\n            this._status = _loader.LoaderStatus.kComplete;\n        }\n    }, {\n        key: '_onReadyStateChange',\n        value: function _onReadyStateChange(e) {\n            var xhr = e.target;\n\n            if (xhr.readyState === 2) {\n                // HEADERS_RECEIVED\n                if (xhr.responseURL != undefined && xhr.responseURL !== this._requestURL) {\n                    if (this._onURLRedirect) {\n                        var redirectedURL = this._seekHandler.removeURLParameters(xhr.responseURL);\n                        this._onURLRedirect(redirectedURL);\n                    }\n                }\n\n                if (xhr.status !== 0 && (xhr.status < 200 || xhr.status > 299)) {\n                    this._status = _loader.LoaderStatus.kError;\n                    if (this._onError) {\n                        this._onError(_loader.LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: xhr.status, msg: xhr.statusText });\n                    } else {\n                        throw new _exception.RuntimeException('MozChunkedLoader: Http code invalid, ' + xhr.status + ' ' + xhr.statusText);\n                    }\n                } else {\n                    this._status = _loader.LoaderStatus.kBuffering;\n                }\n            }\n        }\n    }, {\n        key: '_onProgress',\n        value: function _onProgress(e) {\n            if (this._status === _loader.LoaderStatus.kError) {\n                // Ignore error response\n                return;\n            }\n\n            if (this._contentLength === null) {\n                if (e.total !== null && e.total !== 0) {\n                    this._contentLength = e.total;\n                    if (this._onContentLengthKnown) {\n                        this._onContentLengthKnown(this._contentLength);\n                    }\n                }\n            }\n\n            var chunk = e.target.response;\n            var byteStart = this._range.from + this._receivedLength;\n            this._receivedLength += chunk.byteLength;\n\n            if (this._onDataArrival) {\n                this._onDataArrival(chunk, byteStart, this._receivedLength);\n            }\n        }\n    }, {\n        key: '_onLoadEnd',\n        value: function _onLoadEnd(e) {\n            if (this._requestAbort === true) {\n                this._requestAbort = false;\n                return;\n            } else if (this._status === _loader.LoaderStatus.kError) {\n                return;\n            }\n\n            this._status = _loader.LoaderStatus.kComplete;\n            if (this._onComplete) {\n                this._onComplete(this._range.from, this._range.from + this._receivedLength - 1);\n            }\n        }\n    }, {\n        key: '_onXhrError',\n        value: function _onXhrError(e) {\n            this._status = _loader.LoaderStatus.kError;\n            var type = 0;\n            var info = null;\n\n            if (this._contentLength && e.loaded < this._contentLength) {\n                type = _loader.LoaderErrors.EARLY_EOF;\n                info = { code: -1, msg: 'Moz-Chunked stream meet Early-Eof' };\n            } else {\n                type = _loader.LoaderErrors.EXCEPTION;\n                info = { code: -1, msg: e.constructor.name + ' ' + e.type };\n            }\n\n            if (this._onError) {\n                this._onError(type, info);\n            } else {\n                throw new _exception.RuntimeException(info.msg);\n            }\n        }\n    }]);\n\n    return MozChunkedLoader;\n}(_loader.BaseLoader);\n\nexports.default = MozChunkedLoader;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],30:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/* Notice: ms-stream may cause IE/Edge browser crash if seek too frequently!!!\r\n * The browser may crash in wininet.dll. Disable for now.\r\n *\r\n * For IE11/Edge browser by microsoft which supports `xhr.responseType = 'ms-stream'`\r\n * Notice that ms-stream API sucks. The buffer is always expanding along with downloading.\r\n *\r\n * We need to abort the xhr if buffer size exceeded limit size (e.g. 16 MiB), then do reconnect.\r\n * in order to release previous ArrayBuffer to avoid memory leak\r\n *\r\n * Otherwise, the ArrayBuffer will increase to a terrible size that equals final file size.\r\n */\nvar MSStreamLoader = function (_BaseLoader) {\n    _inherits(MSStreamLoader, _BaseLoader);\n\n    _createClass(MSStreamLoader, null, [{\n        key: 'isSupported',\n        value: function isSupported() {\n            try {\n                if (typeof self.MSStream === 'undefined' || typeof self.MSStreamReader === 'undefined') {\n                    return false;\n                }\n\n                var xhr = new XMLHttpRequest();\n                xhr.open('GET', 'https://example.com', true);\n                xhr.responseType = 'ms-stream';\n                return xhr.responseType === 'ms-stream';\n            } catch (e) {\n                _logger2.default.w('MSStreamLoader', e.message);\n                return false;\n            }\n        }\n    }]);\n\n    function MSStreamLoader(seekHandler, config) {\n        _classCallCheck(this, MSStreamLoader);\n\n        var _this = _possibleConstructorReturn(this, (MSStreamLoader.__proto__ || Object.getPrototypeOf(MSStreamLoader)).call(this, 'xhr-msstream-loader'));\n\n        _this.TAG = 'MSStreamLoader';\n\n        _this._seekHandler = seekHandler;\n        _this._config = config;\n        _this._needStash = true;\n\n        _this._xhr = null;\n        _this._reader = null; // MSStreamReader\n\n        _this._totalRange = null;\n        _this._currentRange = null;\n\n        _this._currentRequestURL = null;\n        _this._currentRedirectedURL = null;\n\n        _this._contentLength = null;\n        _this._receivedLength = 0;\n\n        _this._bufferLimit = 16 * 1024 * 1024; // 16MB\n        _this._lastTimeBufferSize = 0;\n        _this._isReconnecting = false;\n        return _this;\n    }\n\n    _createClass(MSStreamLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this.isWorking()) {\n                this.abort();\n            }\n            if (this._reader) {\n                this._reader.onprogress = null;\n                this._reader.onload = null;\n                this._reader.onerror = null;\n                this._reader = null;\n            }\n            if (this._xhr) {\n                this._xhr.onreadystatechange = null;\n                this._xhr = null;\n            }\n            _get(MSStreamLoader.prototype.__proto__ || Object.getPrototypeOf(MSStreamLoader.prototype), 'destroy', this).call(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(dataSource, range) {\n            this._internalOpen(dataSource, range, false);\n        }\n    }, {\n        key: '_internalOpen',\n        value: function _internalOpen(dataSource, range, isSubrange) {\n            this._dataSource = dataSource;\n\n            if (!isSubrange) {\n                this._totalRange = range;\n            } else {\n                this._currentRange = range;\n            }\n\n            var sourceURL = dataSource.url;\n            if (this._config.reuseRedirectedURL) {\n                if (this._currentRedirectedURL != undefined) {\n                    sourceURL = this._currentRedirectedURL;\n                } else if (dataSource.redirectedURL != undefined) {\n                    sourceURL = dataSource.redirectedURL;\n                }\n            }\n\n            var seekConfig = this._seekHandler.getConfig(sourceURL, range);\n            this._currentRequestURL = seekConfig.url;\n\n            var reader = this._reader = new self.MSStreamReader();\n            reader.onprogress = this._msrOnProgress.bind(this);\n            reader.onload = this._msrOnLoad.bind(this);\n            reader.onerror = this._msrOnError.bind(this);\n\n            var xhr = this._xhr = new XMLHttpRequest();\n            xhr.open('GET', seekConfig.url, true);\n            xhr.responseType = 'ms-stream';\n            xhr.onreadystatechange = this._xhrOnReadyStateChange.bind(this);\n            xhr.onerror = this._xhrOnError.bind(this);\n\n            if (dataSource.withCredentials) {\n                xhr.withCredentials = true;\n            }\n\n            if (_typeof(seekConfig.headers) === 'object') {\n                var headers = seekConfig.headers;\n\n                for (var key in headers) {\n                    if (headers.hasOwnProperty(key)) {\n                        xhr.setRequestHeader(key, headers[key]);\n                    }\n                }\n            }\n\n            // add additional headers\n            if (_typeof(this._config.headers) === 'object') {\n                var _headers = this._config.headers;\n\n                for (var _key in _headers) {\n                    if (_headers.hasOwnProperty(_key)) {\n                        xhr.setRequestHeader(_key, _headers[_key]);\n                    }\n                }\n            }\n\n            if (this._isReconnecting) {\n                this._isReconnecting = false;\n            } else {\n                this._status = _loader.LoaderStatus.kConnecting;\n            }\n            xhr.send();\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            this._internalAbort();\n            this._status = _loader.LoaderStatus.kComplete;\n        }\n    }, {\n        key: '_internalAbort',\n        value: function _internalAbort() {\n            if (this._reader) {\n                if (this._reader.readyState === 1) {\n                    // LOADING\n                    this._reader.abort();\n                }\n                this._reader.onprogress = null;\n                this._reader.onload = null;\n                this._reader.onerror = null;\n                this._reader = null;\n            }\n            if (this._xhr) {\n                this._xhr.abort();\n                this._xhr.onreadystatechange = null;\n                this._xhr = null;\n            }\n        }\n    }, {\n        key: '_xhrOnReadyStateChange',\n        value: function _xhrOnReadyStateChange(e) {\n            var xhr = e.target;\n\n            if (xhr.readyState === 2) {\n                // HEADERS_RECEIVED\n                if (xhr.status >= 200 && xhr.status <= 299) {\n                    this._status = _loader.LoaderStatus.kBuffering;\n\n                    if (xhr.responseURL != undefined) {\n                        var redirectedURL = this._seekHandler.removeURLParameters(xhr.responseURL);\n                        if (xhr.responseURL !== this._currentRequestURL && redirectedURL !== this._currentRedirectedURL) {\n                            this._currentRedirectedURL = redirectedURL;\n                            if (this._onURLRedirect) {\n                                this._onURLRedirect(redirectedURL);\n                            }\n                        }\n                    }\n\n                    var lengthHeader = xhr.getResponseHeader('Content-Length');\n                    if (lengthHeader != null && this._contentLength == null) {\n                        var length = parseInt(lengthHeader);\n                        if (length > 0) {\n                            this._contentLength = length;\n                            if (this._onContentLengthKnown) {\n                                this._onContentLengthKnown(this._contentLength);\n                            }\n                        }\n                    }\n                } else {\n                    this._status = _loader.LoaderStatus.kError;\n                    if (this._onError) {\n                        this._onError(_loader.LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: xhr.status, msg: xhr.statusText });\n                    } else {\n                        throw new _exception.RuntimeException('MSStreamLoader: Http code invalid, ' + xhr.status + ' ' + xhr.statusText);\n                    }\n                }\n            } else if (xhr.readyState === 3) {\n                // LOADING\n                if (xhr.status >= 200 && xhr.status <= 299) {\n                    this._status = _loader.LoaderStatus.kBuffering;\n\n                    var msstream = xhr.response;\n                    this._reader.readAsArrayBuffer(msstream);\n                }\n            }\n        }\n    }, {\n        key: '_xhrOnError',\n        value: function _xhrOnError(e) {\n            this._status = _loader.LoaderStatus.kError;\n            var type = _loader.LoaderErrors.EXCEPTION;\n            var info = { code: -1, msg: e.constructor.name + ' ' + e.type };\n\n            if (this._onError) {\n                this._onError(type, info);\n            } else {\n                throw new _exception.RuntimeException(info.msg);\n            }\n        }\n    }, {\n        key: '_msrOnProgress',\n        value: function _msrOnProgress(e) {\n            var reader = e.target;\n            var bigbuffer = reader.result;\n            if (bigbuffer == null) {\n                // result may be null, workaround for buggy M$\n                this._doReconnectIfNeeded();\n                return;\n            }\n\n            var slice = bigbuffer.slice(this._lastTimeBufferSize);\n            this._lastTimeBufferSize = bigbuffer.byteLength;\n            var byteStart = this._totalRange.from + this._receivedLength;\n            this._receivedLength += slice.byteLength;\n\n            if (this._onDataArrival) {\n                this._onDataArrival(slice, byteStart, this._receivedLength);\n            }\n\n            if (bigbuffer.byteLength >= this._bufferLimit) {\n                _logger2.default.v(this.TAG, 'MSStream buffer exceeded max size near ' + (byteStart + slice.byteLength) + ', reconnecting...');\n                this._doReconnectIfNeeded();\n            }\n        }\n    }, {\n        key: '_doReconnectIfNeeded',\n        value: function _doReconnectIfNeeded() {\n            if (this._contentLength == null || this._receivedLength < this._contentLength) {\n                this._isReconnecting = true;\n                this._lastTimeBufferSize = 0;\n                this._internalAbort();\n\n                var range = {\n                    from: this._totalRange.from + this._receivedLength,\n                    to: -1\n                };\n                this._internalOpen(this._dataSource, range, true);\n            }\n        }\n    }, {\n        key: '_msrOnLoad',\n        value: function _msrOnLoad(e) {\n            // actually it is onComplete event\n            this._status = _loader.LoaderStatus.kComplete;\n            if (this._onComplete) {\n                this._onComplete(this._totalRange.from, this._totalRange.from + this._receivedLength - 1);\n            }\n        }\n    }, {\n        key: '_msrOnError',\n        value: function _msrOnError(e) {\n            this._status = _loader.LoaderStatus.kError;\n            var type = 0;\n            var info = null;\n\n            if (this._contentLength && this._receivedLength < this._contentLength) {\n                type = _loader.LoaderErrors.EARLY_EOF;\n                info = { code: -1, msg: 'MSStream meet Early-Eof' };\n            } else {\n                type = _loader.LoaderErrors.EARLY_EOF;\n                info = { code: -1, msg: e.constructor.name + ' ' + e.type };\n            }\n\n            if (this._onError) {\n                this._onError(type, info);\n            } else {\n                throw new _exception.RuntimeException(info.msg);\n            }\n        }\n    }]);\n\n    return MSStreamLoader;\n}(_loader.BaseLoader);\n\nexports.default = MSStreamLoader;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],31:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _speedSampler = _dereq_('./speed-sampler.js');\n\nvar _speedSampler2 = _interopRequireDefault(_speedSampler);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n// Universal IO Loader, implemented by adding Range header in xhr's request header\nvar RangeLoader = function (_BaseLoader) {\n    _inherits(RangeLoader, _BaseLoader);\n\n    _createClass(RangeLoader, null, [{\n        key: 'isSupported',\n        value: function isSupported() {\n            try {\n                var xhr = new XMLHttpRequest();\n                xhr.open('GET', 'https://example.com', true);\n                xhr.responseType = 'arraybuffer';\n                return xhr.responseType === 'arraybuffer';\n            } catch (e) {\n                _logger2.default.w('RangeLoader', e.message);\n                return false;\n            }\n        }\n    }]);\n\n    function RangeLoader(seekHandler, config) {\n        _classCallCheck(this, RangeLoader);\n\n        var _this = _possibleConstructorReturn(this, (RangeLoader.__proto__ || Object.getPrototypeOf(RangeLoader)).call(this, 'xhr-range-loader'));\n\n        _this.TAG = 'RangeLoader';\n\n        _this._seekHandler = seekHandler;\n        _this._config = config;\n        _this._needStash = false;\n\n        _this._chunkSizeKBList = [128, 256, 384, 512, 768, 1024, 1536, 2048, 3072, 4096, 5120, 6144, 7168, 8192];\n        _this._currentChunkSizeKB = 384;\n        _this._currentSpeedNormalized = 0;\n        _this._zeroSpeedChunkCount = 0;\n\n        _this._xhr = null;\n        _this._speedSampler = new _speedSampler2.default();\n\n        _this._requestAbort = false;\n        _this._waitForTotalLength = false;\n        _this._totalLengthReceived = false;\n\n        _this._currentRequestURL = null;\n        _this._currentRedirectedURL = null;\n        _this._currentRequestRange = null;\n        _this._totalLength = null; // size of the entire file\n        _this._contentLength = null; // Content-Length of entire request range\n        _this._receivedLength = 0; // total received bytes\n        _this._lastTimeLoaded = 0; // received bytes of current request sub-range\n        return _this;\n    }\n\n    _createClass(RangeLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this.isWorking()) {\n                this.abort();\n            }\n            if (this._xhr) {\n                this._xhr.onreadystatechange = null;\n                this._xhr.onprogress = null;\n                this._xhr.onload = null;\n                this._xhr.onerror = null;\n                this._xhr = null;\n            }\n            _get(RangeLoader.prototype.__proto__ || Object.getPrototypeOf(RangeLoader.prototype), 'destroy', this).call(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(dataSource, range) {\n            this._dataSource = dataSource;\n            this._range = range;\n            this._status = _loader.LoaderStatus.kConnecting;\n\n            var useRefTotalLength = false;\n            if (this._dataSource.filesize != undefined && this._dataSource.filesize !== 0) {\n                useRefTotalLength = true;\n                this._totalLength = this._dataSource.filesize;\n            }\n\n            if (!this._totalLengthReceived && !useRefTotalLength) {\n                // We need total filesize\n                this._waitForTotalLength = true;\n                this._internalOpen(this._dataSource, { from: 0, to: -1 });\n            } else {\n                // We have filesize, start loading\n                this._openSubRange();\n            }\n        }\n    }, {\n        key: '_openSubRange',\n        value: function _openSubRange() {\n            var chunkSize = this._currentChunkSizeKB * 1024;\n\n            var from = this._range.from + this._receivedLength;\n            var to = from + chunkSize;\n\n            if (this._contentLength != null) {\n                if (to - this._range.from >= this._contentLength) {\n                    to = this._range.from + this._contentLength - 1;\n                }\n            }\n\n            this._currentRequestRange = { from: from, to: to };\n            this._internalOpen(this._dataSource, this._currentRequestRange);\n        }\n    }, {\n        key: '_internalOpen',\n        value: function _internalOpen(dataSource, range) {\n            this._lastTimeLoaded = 0;\n\n            var sourceURL = dataSource.url;\n            if (this._config.reuseRedirectedURL) {\n                if (this._currentRedirectedURL != undefined) {\n                    sourceURL = this._currentRedirectedURL;\n                } else if (dataSource.redirectedURL != undefined) {\n                    sourceURL = dataSource.redirectedURL;\n                }\n            }\n\n            var seekConfig = this._seekHandler.getConfig(sourceURL, range);\n            this._currentRequestURL = seekConfig.url;\n\n            var xhr = this._xhr = new XMLHttpRequest();\n            xhr.open('GET', seekConfig.url, true);\n            xhr.responseType = 'arraybuffer';\n            xhr.onreadystatechange = this._onReadyStateChange.bind(this);\n            xhr.onprogress = this._onProgress.bind(this);\n            xhr.onload = this._onLoad.bind(this);\n            xhr.onerror = this._onXhrError.bind(this);\n\n            if (dataSource.withCredentials) {\n                xhr.withCredentials = true;\n            }\n\n            if (_typeof(seekConfig.headers) === 'object') {\n                var headers = seekConfig.headers;\n\n                for (var key in headers) {\n                    if (headers.hasOwnProperty(key)) {\n                        xhr.setRequestHeader(key, headers[key]);\n                    }\n                }\n            }\n\n            // add additional headers\n            if (_typeof(this._config.headers) === 'object') {\n                var _headers = this._config.headers;\n\n                for (var _key in _headers) {\n                    if (_headers.hasOwnProperty(_key)) {\n                        xhr.setRequestHeader(_key, _headers[_key]);\n                    }\n                }\n            }\n\n            xhr.send();\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            this._requestAbort = true;\n            this._internalAbort();\n            this._status = _loader.LoaderStatus.kComplete;\n        }\n    }, {\n        key: '_internalAbort',\n        value: function _internalAbort() {\n            if (this._xhr) {\n                this._xhr.onreadystatechange = null;\n                this._xhr.onprogress = null;\n                this._xhr.onload = null;\n                this._xhr.onerror = null;\n                this._xhr.abort();\n                this._xhr = null;\n            }\n        }\n    }, {\n        key: '_onReadyStateChange',\n        value: function _onReadyStateChange(e) {\n            var xhr = e.target;\n\n            if (xhr.readyState === 2) {\n                // HEADERS_RECEIVED\n                if (xhr.responseURL != undefined) {\n                    // if the browser support this property\n                    var redirectedURL = this._seekHandler.removeURLParameters(xhr.responseURL);\n                    if (xhr.responseURL !== this._currentRequestURL && redirectedURL !== this._currentRedirectedURL) {\n                        this._currentRedirectedURL = redirectedURL;\n                        if (this._onURLRedirect) {\n                            this._onURLRedirect(redirectedURL);\n                        }\n                    }\n                }\n\n                if (xhr.status >= 200 && xhr.status <= 299) {\n                    if (this._waitForTotalLength) {\n                        return;\n                    }\n                    this._status = _loader.LoaderStatus.kBuffering;\n                } else {\n                    this._status = _loader.LoaderStatus.kError;\n                    if (this._onError) {\n                        this._onError(_loader.LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: xhr.status, msg: xhr.statusText });\n                    } else {\n                        throw new _exception.RuntimeException('RangeLoader: Http code invalid, ' + xhr.status + ' ' + xhr.statusText);\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_onProgress',\n        value: function _onProgress(e) {\n            if (this._status === _loader.LoaderStatus.kError) {\n                // Ignore error response\n                return;\n            }\n\n            if (this._contentLength === null) {\n                var openNextRange = false;\n\n                if (this._waitForTotalLength) {\n                    this._waitForTotalLength = false;\n                    this._totalLengthReceived = true;\n                    openNextRange = true;\n\n                    var total = e.total;\n                    this._internalAbort();\n                    if (total != null & total !== 0) {\n                        this._totalLength = total;\n                    }\n                }\n\n                // calculate currrent request range's contentLength\n                if (this._range.to === -1) {\n                    this._contentLength = this._totalLength - this._range.from;\n                } else {\n                    // to !== -1\n                    this._contentLength = this._range.to - this._range.from + 1;\n                }\n\n                if (openNextRange) {\n                    this._openSubRange();\n                    return;\n                }\n                if (this._onContentLengthKnown) {\n                    this._onContentLengthKnown(this._contentLength);\n                }\n            }\n\n            var delta = e.loaded - this._lastTimeLoaded;\n            this._lastTimeLoaded = e.loaded;\n            this._speedSampler.addBytes(delta);\n        }\n    }, {\n        key: '_normalizeSpeed',\n        value: function _normalizeSpeed(input) {\n            var list = this._chunkSizeKBList;\n            var last = list.length - 1;\n            var mid = 0;\n            var lbound = 0;\n            var ubound = last;\n\n            if (input < list[0]) {\n                return list[0];\n            }\n\n            while (lbound <= ubound) {\n                mid = lbound + Math.floor((ubound - lbound) / 2);\n                if (mid === last || input >= list[mid] && input < list[mid + 1]) {\n                    return list[mid];\n                } else if (list[mid] < input) {\n                    lbound = mid + 1;\n                } else {\n                    ubound = mid - 1;\n                }\n            }\n        }\n    }, {\n        key: '_onLoad',\n        value: function _onLoad(e) {\n            if (this._status === _loader.LoaderStatus.kError) {\n                // Ignore error response\n                return;\n            }\n\n            if (this._waitForTotalLength) {\n                this._waitForTotalLength = false;\n                return;\n            }\n\n            this._lastTimeLoaded = 0;\n            var KBps = this._speedSampler.lastSecondKBps;\n            if (KBps === 0) {\n                this._zeroSpeedChunkCount++;\n                if (this._zeroSpeedChunkCount >= 3) {\n                    // Try get currentKBps after 3 chunks\n                    KBps = this._speedSampler.currentKBps;\n                }\n            }\n\n            if (KBps !== 0) {\n                var normalized = this._normalizeSpeed(KBps);\n                if (this._currentSpeedNormalized !== normalized) {\n                    this._currentSpeedNormalized = normalized;\n                    this._currentChunkSizeKB = normalized;\n                }\n            }\n\n            var chunk = e.target.response;\n            var byteStart = this._range.from + this._receivedLength;\n            this._receivedLength += chunk.byteLength;\n\n            var reportComplete = false;\n\n            if (this._contentLength != null && this._receivedLength < this._contentLength) {\n                // continue load next chunk\n                this._openSubRange();\n            } else {\n                reportComplete = true;\n            }\n\n            // dispatch received chunk\n            if (this._onDataArrival) {\n                this._onDataArrival(chunk, byteStart, this._receivedLength);\n            }\n\n            if (reportComplete) {\n                this._status = _loader.LoaderStatus.kComplete;\n                if (this._onComplete) {\n                    this._onComplete(this._range.from, this._range.from + this._receivedLength - 1);\n                }\n            }\n        }\n    }, {\n        key: '_onXhrError',\n        value: function _onXhrError(e) {\n            this._status = _loader.LoaderStatus.kError;\n            var type = 0;\n            var info = null;\n\n            if (this._contentLength && this._receivedLength > 0 && this._receivedLength < this._contentLength) {\n                type = _loader.LoaderErrors.EARLY_EOF;\n                info = { code: -1, msg: 'RangeLoader meet Early-Eof' };\n            } else {\n                type = _loader.LoaderErrors.EXCEPTION;\n                info = { code: -1, msg: e.constructor.name + ' ' + e.type };\n            }\n\n            if (this._onError) {\n                this._onError(type, info);\n            } else {\n                throw new _exception.RuntimeException(info.msg);\n            }\n        }\n    }, {\n        key: 'currentSpeed',\n        get: function get() {\n            return this._speedSampler.lastSecondKBps;\n        }\n    }]);\n\n    return RangeLoader;\n}(_loader.BaseLoader);\n\nexports.default = RangeLoader;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24,\"./speed-sampler.js\":27}],32:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _browser = _dereq_('../utils/browser.js');\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _playerEvents = _dereq_('./player-events.js');\n\nvar _playerEvents2 = _interopRequireDefault(_playerEvents);\n\nvar _transmuxer = _dereq_('../core/transmuxer.js');\n\nvar _transmuxer2 = _interopRequireDefault(_transmuxer);\n\nvar _transmuxingEvents = _dereq_('../core/transmuxing-events.js');\n\nvar _transmuxingEvents2 = _interopRequireDefault(_transmuxingEvents);\n\nvar _mseController = _dereq_('../core/mse-controller.js');\n\nvar _mseController2 = _interopRequireDefault(_mseController);\n\nvar _mseEvents = _dereq_('../core/mse-events.js');\n\nvar _mseEvents2 = _interopRequireDefault(_mseEvents);\n\nvar _playerErrors = _dereq_('./player-errors.js');\n\nvar _config = _dereq_('../config.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar FlvPlayer = function () {\n    function FlvPlayer(mediaDataSource, config) {\n        _classCallCheck(this, FlvPlayer);\n\n        this.TAG = 'FlvPlayer';\n        this._type = 'FlvPlayer';\n        this._emitter = new _events2.default();\n\n        this._config = (0, _config.createDefaultConfig)();\n        if ((typeof config === 'undefined' ? 'undefined' : _typeof(config)) === 'object') {\n            Object.assign(this._config, config);\n        }\n\n        if (mediaDataSource.type.toLowerCase() !== 'flv') {\n            throw new _exception.InvalidArgumentException('FlvPlayer requires an flv MediaDataSource input!');\n        }\n\n        if (mediaDataSource.isLive === true) {\n            this._config.isLive = true;\n        }\n\n        this.e = {\n            onvLoadedMetadata: this._onvLoadedMetadata.bind(this),\n            onvSeeking: this._onvSeeking.bind(this),\n            onvCanPlay: this._onvCanPlay.bind(this),\n            onvStalled: this._onvStalled.bind(this),\n            onvProgress: this._onvProgress.bind(this)\n        };\n\n        if (self.performance && self.performance.now) {\n            this._now = self.performance.now.bind(self.performance);\n        } else {\n            this._now = Date.now;\n        }\n\n        this._pendingSeekTime = null; // in seconds\n        this._requestSetTime = false;\n        this._seekpointRecord = null;\n        this._progressChecker = null;\n\n        this._mediaDataSource = mediaDataSource;\n        this._mediaElement = null;\n        this._msectl = null;\n        this._transmuxer = null;\n\n        this._mseSourceOpened = false;\n        this._hasPendingLoad = false;\n        this._receivedCanPlay = false;\n\n        this._mediaInfo = null;\n        this._statisticsInfo = null;\n\n        var chromeNeedIDRFix = _browser2.default.chrome && (_browser2.default.version.major < 50 || _browser2.default.version.major === 50 && _browser2.default.version.build < 2661);\n        this._alwaysSeekKeyframe = chromeNeedIDRFix || _browser2.default.msedge || _browser2.default.msie ? true : false;\n\n        if (this._alwaysSeekKeyframe) {\n            this._config.accurateSeek = false;\n        }\n\n        this.callbackStreamTime = null;\n        this._mediaSourceEndCallback = null;\n    }\n\n    _createClass(FlvPlayer, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._progressChecker != null) {\n                window.clearInterval(this._progressChecker);\n                this._progressChecker = null;\n            }\n            if (this._transmuxer) {\n                this.unload();\n            }\n            if (this._mediaElement) {\n                this.detachMediaElement();\n            }\n            this.e = null;\n            this._mediaDataSource = null;\n\n            this._emitter.removeAllListeners();\n            this._emitter = null;\n\n            this.callbackStreamTime = null;\n            this._mediaSourceEndCallback = null;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, listener) {\n            var _this = this;\n\n            if (event === _playerEvents2.default.MEDIA_INFO) {\n                if (this._mediaInfo != null) {\n                    Promise.resolve().then(function () {\n                        _this._emitter.emit(_playerEvents2.default.MEDIA_INFO, _this.mediaInfo);\n                    });\n                }\n            } else if (event === _playerEvents2.default.STATISTICS_INFO) {\n                if (this._statisticsInfo != null) {\n                    Promise.resolve().then(function () {\n                        _this._emitter.emit(_playerEvents2.default.STATISTICS_INFO, _this.statisticsInfo);\n                    });\n                }\n            }\n            this._emitter.addListener(event, listener);\n        }\n    }, {\n        key: 'off',\n        value: function off(event, listener) {\n            this._emitter.removeListener(event, listener);\n        }\n    }, {\n        key: 'attachMediaElement',\n        value: function attachMediaElement(mediaElement) {\n            var _this2 = this;\n\n            this._mediaElement = mediaElement;\n            mediaElement.addEventListener('loadedmetadata', this.e.onvLoadedMetadata);\n            //mediaElement.addEventListener('seeking', this.e.onvSeeking);\n            mediaElement.addEventListener('canplay', this.e.onvCanPlay);\n            mediaElement.addEventListener('stalled', this.e.onvStalled);\n            //mediaElement.addEventListener('progress', this.e.onvProgress);\n\n            this._msectl = new _mseController2.default(this._config);\n\n            this._msectl.on(_mseEvents2.default.UPDATE_END, this._onmseUpdateEnd.bind(this));\n            this._msectl.on(_mseEvents2.default.BUFFER_FULL, this._onmseBufferFull.bind(this));\n            this._msectl.on(_mseEvents2.default.SOURCE_OPEN, function () {\n                _this2._mseSourceOpened = true;\n                if (_this2._hasPendingLoad) {\n                    _this2._hasPendingLoad = false;\n                    _this2.load();\n                }\n            });\n            this._msectl.on(_mseEvents2.default.ERROR, function (info) {\n                _this2._emitter.emit(_playerEvents2.default.ERROR, _playerErrors.ErrorTypes.MEDIA_ERROR, _playerErrors.ErrorDetails.MEDIA_MSE_ERROR, info);\n            });\n            this._msectl.on(_mseEvents2.default.SOURCE_END, function (info) {\n                if (_this2._mediaSourceEndCallback != null) {\n                    _this2._mediaSourceEndCallback(info);\n                }\n            });\n\n            this._msectl.attachMediaElement(mediaElement);\n\n            if (this._pendingSeekTime != null) {\n                try {\n                    mediaElement.currentTime = this._pendingSeekTime;\n                    this._pendingSeekTime = null;\n                } catch (e) {\n                    // IE11 may throw InvalidStateError if readyState === 0\n                    // We can defer set currentTime operation after loadedmetadata\n                }\n            }\n        }\n    }, {\n        key: 'detachMediaElement',\n        value: function detachMediaElement() {\n            if (this._mediaElement) {\n                this._msectl.detachMediaElement();\n                this._mediaElement.removeEventListener('loadedmetadata', this.e.onvLoadedMetadata);\n                //this._mediaElement.removeEventListener('seeking', this.e.onvSeeking);\n                this._mediaElement.removeEventListener('canplay', this.e.onvCanPlay);\n                this._mediaElement.removeEventListener('stalled', this.e.onvStalled);\n                //this._mediaElement.removeEventListener('progress', this.e.onvProgress);\n                this._mediaElement = null;\n            }\n            if (this._msectl) {\n                this._msectl.destroy();\n                this._msectl = null;\n            }\n        }\n    }, {\n        key: 'load',\n        value: function load() {\n            var _this3 = this;\n\n            if (!this._mediaElement) {\n                throw new _exception.IllegalStateException('HTMLMediaElement must be attached before load()!');\n            }\n            if (this._transmuxer) {\n                throw new _exception.IllegalStateException('FlvPlayer.load() has been called, please call unload() first!');\n            }\n            if (this._hasPendingLoad) {\n                return;\n            }\n\n            if (this._config.deferLoadAfterSourceOpen && this._mseSourceOpened === false) {\n                this._hasPendingLoad = true;\n                return;\n            }\n\n            if (this._mediaElement.readyState > 0) {\n                this._requestSetTime = true;\n                // IE11 may throw InvalidStateError if readyState === 0\n                this._mediaElement.currentTime = 0;\n            }\n\n            this._transmuxer = new _transmuxer2.default(this._mediaDataSource, this._config);\n\n            this._transmuxer.on(_transmuxingEvents2.default.INIT_SEGMENT, function (type, is) {\n                _this3._msectl.appendInitSegment(is);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.MEDIA_SEGMENT, function (type, ms) {\n                _this3._msectl.appendMediaSegment(ms);\n\n                // lazyLoad check\n                if (_this3._config.lazyLoad && !_this3._config.isLive) {\n                    var currentTime = _this3._mediaElement.currentTime;\n                    if (ms.info.endDts >= (currentTime + _this3._config.lazyLoadMaxDuration) * 1000) {\n                        if (_this3._progressChecker == null) {\n                            _logger2.default.v(_this3.TAG, 'Maximum buffering duration exceeded, suspend transmuxing task');\n                            _this3._suspendTransmuxer();\n                        }\n                    }\n                }\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.LOADING_COMPLETE, function () {\n                _this3._msectl.endOfStream();\n                _this3._emitter.emit(_playerEvents2.default.LOADING_COMPLETE);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.RECOVERED_EARLY_EOF, function () {\n                _this3._emitter.emit(_playerEvents2.default.RECOVERED_EARLY_EOF);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.IO_ERROR, function (detail, info) {\n                _this3._emitter.emit(_playerEvents2.default.ERROR, _playerErrors.ErrorTypes.NETWORK_ERROR, detail, info);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.DEMUX_ERROR, function (detail, info) {\n                _this3._emitter.emit(_playerEvents2.default.ERROR, _playerErrors.ErrorTypes.MEDIA_ERROR, detail, { code: -1, msg: info });\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.MEDIA_INFO, function (mediaInfo) {\n                _this3._mediaInfo = mediaInfo;\n                _this3._emitter.emit(_playerEvents2.default.MEDIA_INFO, Object.assign({}, mediaInfo));\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.METADATA_ARRIVED, function (metadata) {\n                _this3._emitter.emit(_playerEvents2.default.METADATA_ARRIVED, metadata);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.SCRIPTDATA_ARRIVED, function (data) {\n                _this3._emitter.emit(_playerEvents2.default.SCRIPTDATA_ARRIVED, data);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.STATISTICS_INFO, function (statInfo) {\n                _this3._statisticsInfo = _this3._fillStatisticsInfo(statInfo);\n                _this3._emitter.emit(_playerEvents2.default.STATISTICS_INFO, Object.assign({}, _this3._statisticsInfo));\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, function (milliseconds) {\n                if (_this3._mediaElement && !_this3._config.accurateSeek) {\n                    _this3._requestSetTime = true;\n                    _this3._mediaElement.currentTime = milliseconds / 1000;\n                }\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.STREAM_TIME, function (ts) {\n                _this3._receiveStreamTime(ts);\n            });\n\n            this._transmuxer.open();\n        }\n    }, {\n        key: 'unload',\n        value: function unload() {\n            if (this._mediaElement) {\n                this._mediaElement.pause();\n            }\n            if (this._msectl) {\n                this._msectl.seek(0);\n            }\n            if (this._transmuxer) {\n                this._transmuxer.close();\n                this._transmuxer.destroy();\n                this._transmuxer = null;\n            }\n        }\n    }, {\n        key: 'play',\n        value: function play() {\n            return this._mediaElement.play();\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            this._mediaElement.pause();\n        }\n    }, {\n        key: '_fillStatisticsInfo',\n        value: function _fillStatisticsInfo(statInfo) {\n            statInfo.playerType = this._type;\n\n            if (!(this._mediaElement instanceof HTMLVideoElement)) {\n                return statInfo;\n            }\n\n            var hasQualityInfo = true;\n            var decoded = 0;\n            var dropped = 0;\n\n            if (this._mediaElement.getVideoPlaybackQuality) {\n                var quality = this._mediaElement.getVideoPlaybackQuality();\n                decoded = quality.totalVideoFrames;\n                dropped = quality.droppedVideoFrames;\n            } else if (this._mediaElement.webkitDecodedFrameCount != undefined) {\n                decoded = this._mediaElement.webkitDecodedFrameCount;\n                dropped = this._mediaElement.webkitDroppedFrameCount;\n            } else {\n                hasQualityInfo = false;\n            }\n\n            if (hasQualityInfo) {\n                statInfo.decodedFrames = decoded;\n                statInfo.droppedFrames = dropped;\n            }\n\n            return statInfo;\n        }\n    }, {\n        key: '_onmseUpdateEnd',\n        value: function _onmseUpdateEnd() {\n            if (!this._config.lazyLoad || this._config.isLive) {\n                return;\n            }\n\n            var buffered = this._mediaElement.buffered;\n            var currentTime = this._mediaElement.currentTime;\n            var currentRangeStart = 0;\n            var currentRangeEnd = 0;\n\n            for (var i = 0; i < buffered.length; i++) {\n                var start = buffered.start(i);\n                var end = buffered.end(i);\n                if (start <= currentTime && currentTime < end) {\n                    currentRangeStart = start;\n                    currentRangeEnd = end;\n                    break;\n                }\n            }\n\n            if (currentRangeEnd >= currentTime + this._config.lazyLoadMaxDuration && this._progressChecker == null) {\n                _logger2.default.v(this.TAG, 'Maximum buffering duration exceeded, suspend transmuxing task');\n                this._suspendTransmuxer();\n            }\n        }\n    }, {\n        key: '_onmseBufferFull',\n        value: function _onmseBufferFull() {\n            _logger2.default.v(this.TAG, 'MSE SourceBuffer is full, suspend transmuxing task');\n            if (this._progressChecker == null) {\n                this._suspendTransmuxer();\n            }\n        }\n    }, {\n        key: '_suspendTransmuxer',\n        value: function _suspendTransmuxer() {\n            if (this._transmuxer) {\n                this._transmuxer.pause();\n\n                if (this._progressChecker == null) {\n                    this._progressChecker = window.setInterval(this._checkProgressAndResume.bind(this), 1000);\n                }\n            }\n        }\n    }, {\n        key: '_checkProgressAndResume',\n        value: function _checkProgressAndResume() {\n            var currentTime = this._mediaElement.currentTime;\n            var buffered = this._mediaElement.buffered;\n\n            var needResume = false;\n\n            for (var i = 0; i < buffered.length; i++) {\n                var from = buffered.start(i);\n                var to = buffered.end(i);\n                if (currentTime >= from && currentTime < to) {\n                    if (currentTime >= to - this._config.lazyLoadRecoverDuration) {\n                        needResume = true;\n                    }\n                    break;\n                }\n            }\n\n            if (needResume) {\n                window.clearInterval(this._progressChecker);\n                this._progressChecker = null;\n                if (needResume) {\n                    _logger2.default.v(this.TAG, 'Continue loading from paused position');\n                    this._transmuxer.resume();\n                }\n            }\n        }\n    }, {\n        key: '_isTimepointBuffered',\n        value: function _isTimepointBuffered(seconds) {\n            var buffered = this._mediaElement.buffered;\n\n            for (var i = 0; i < buffered.length; i++) {\n                var from = buffered.start(i);\n                var to = buffered.end(i);\n                if (seconds >= from && seconds < to) {\n                    return true;\n                }\n            }\n            return false;\n        }\n    }, {\n        key: '_internalSeek',\n        value: function _internalSeek(seconds) {\n            var directSeek = this._isTimepointBuffered(seconds);\n\n            var directSeekBegin = false;\n            var directSeekBeginTime = 0;\n\n            if (seconds < 1.0 && this._mediaElement.buffered.length > 0) {\n                var videoBeginTime = this._mediaElement.buffered.start(0);\n                if (videoBeginTime < 1.0 && seconds < videoBeginTime || _browser2.default.safari) {\n                    directSeekBegin = true;\n                    // also workaround for Safari: Seek to 0 may cause video stuck, use 0.1 to avoid\n                    directSeekBeginTime = _browser2.default.safari ? 0.1 : videoBeginTime;\n                }\n            }\n\n            if (directSeekBegin) {\n                // seek to video begin, set currentTime directly if beginPTS buffered\n                this._requestSetTime = true;\n                this._mediaElement.currentTime = directSeekBeginTime;\n            } else if (directSeek) {\n                // buffered position\n                if (!this._alwaysSeekKeyframe) {\n                    this._requestSetTime = true;\n                    this._mediaElement.currentTime = seconds;\n                } else {\n                    var idr = this._msectl.getNearestKeyframe(Math.floor(seconds * 1000));\n                    this._requestSetTime = true;\n                    if (idr != null) {\n                        this._mediaElement.currentTime = idr.dts / 1000;\n                    } else {\n                        this._mediaElement.currentTime = seconds;\n                    }\n                }\n                if (this._progressChecker != null) {\n                    this._checkProgressAndResume();\n                }\n            } else {\n                if (this._progressChecker != null) {\n                    window.clearInterval(this._progressChecker);\n                    this._progressChecker = null;\n                }\n                this._msectl.seek(seconds);\n                this._transmuxer.seek(Math.floor(seconds * 1000)); // in milliseconds\n                // no need to set mediaElement.currentTime if non-accurateSeek,\n                // just wait for the recommend_seekpoint callback\n                if (this._config.accurateSeek) {\n                    this._requestSetTime = true;\n                    this._mediaElement.currentTime = seconds;\n                }\n            }\n        }\n    }, {\n        key: '_checkAndApplyUnbufferedSeekpoint',\n        value: function _checkAndApplyUnbufferedSeekpoint() {\n            if (this._seekpointRecord) {\n                if (this._seekpointRecord.recordTime <= this._now() - 100) {\n                    var target = this._mediaElement.currentTime;\n                    this._seekpointRecord = null;\n                    if (!this._isTimepointBuffered(target)) {\n                        if (this._progressChecker != null) {\n                            window.clearTimeout(this._progressChecker);\n                            this._progressChecker = null;\n                        }\n                        // .currentTime is consists with .buffered timestamp\n                        // Chrome/Edge use DTS, while FireFox/Safari use PTS\n                        this._msectl.seek(target);\n                        this._transmuxer.seek(Math.floor(target * 1000));\n                        // set currentTime if accurateSeek, or wait for recommend_seekpoint callback\n                        if (this._config.accurateSeek) {\n                            this._requestSetTime = true;\n                            this._mediaElement.currentTime = target;\n                        }\n                    }\n                } else {\n                    window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this), 50);\n                }\n            }\n        }\n    }, {\n        key: '_checkAndResumeStuckPlayback',\n        value: function _checkAndResumeStuckPlayback(stalled) {\n            var media = this._mediaElement;\n            if (stalled || !this._receivedCanPlay || media.readyState < 2) {\n                // HAVE_CURRENT_DATA\n                var buffered = media.buffered;\n                if (buffered.length > 0 && media.currentTime < buffered.start(0)) {\n                    _logger2.default.w(this.TAG, 'Playback seems stuck at ' + media.currentTime + ', seek to ' + buffered.start(0));\n                    this._requestSetTime = true;\n                    this._mediaElement.currentTime = buffered.start(0);\n                    this._mediaElement.removeEventListener('progress', this.e.onvProgress);\n                }\n            } else {\n                // Playback didn't stuck, remove progress event listener\n                this._mediaElement.removeEventListener('progress', this.e.onvProgress);\n            }\n        }\n    }, {\n        key: '_onvLoadedMetadata',\n        value: function _onvLoadedMetadata(e) {\n            if (this._pendingSeekTime != null) {\n                this._mediaElement.currentTime = this._pendingSeekTime;\n                this._pendingSeekTime = null;\n            }\n        }\n    }, {\n        key: '_onvSeeking',\n        value: function _onvSeeking(e) {\n            // handle seeking request from browser's progress bar\n            var target = this._mediaElement.currentTime;\n            var buffered = this._mediaElement.buffered;\n\n            if (this._requestSetTime) {\n                this._requestSetTime = false;\n                return;\n            }\n\n            if (target < 1.0 && buffered.length > 0) {\n                // seek to video begin, set currentTime directly if beginPTS buffered\n                var videoBeginTime = buffered.start(0);\n                if (videoBeginTime < 1.0 && target < videoBeginTime || _browser2.default.safari) {\n                    this._requestSetTime = true;\n                    // also workaround for Safari: Seek to 0 may cause video stuck, use 0.1 to avoid\n                    this._mediaElement.currentTime = _browser2.default.safari ? 0.1 : videoBeginTime;\n                    return;\n                }\n            }\n\n            if (this._isTimepointBuffered(target)) {\n                if (this._alwaysSeekKeyframe) {\n                    var idr = this._msectl.getNearestKeyframe(Math.floor(target * 1000));\n                    if (idr != null) {\n                        this._requestSetTime = true;\n                        this._mediaElement.currentTime = idr.dts / 1000;\n                    }\n                }\n                if (this._progressChecker != null) {\n                    this._checkProgressAndResume();\n                }\n                return;\n            }\n\n            this._seekpointRecord = {\n                seekPoint: target,\n                recordTime: this._now()\n            };\n            window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this), 50);\n        }\n    }, {\n        key: '_onvCanPlay',\n        value: function _onvCanPlay(e) {\n            this._receivedCanPlay = true;\n            this._mediaElement.removeEventListener('canplay', this.e.onvCanPlay);\n        }\n    }, {\n        key: '_onvStalled',\n        value: function _onvStalled(e) {\n            this._checkAndResumeStuckPlayback(true);\n        }\n    }, {\n        key: '_onvProgress',\n        value: function _onvProgress(e) {\n            this._checkAndResumeStuckPlayback();\n        }\n    }, {\n        key: 'setMediaSourceEndCallback',\n        value: function setMediaSourceEndCallback(call) {\n            this._mediaSourceEndCallback = call;\n        }\n    }, {\n        key: 'setStreamTimeCallback',\n        value: function setStreamTimeCallback(call) {\n            this.callbackStreamTime = call;\n        }\n    }, {\n        key: '_receiveStreamTime',\n        value: function _receiveStreamTime(ts) {\n            if (this.callbackStreamTime != null) {\n                this.callbackStreamTime(ts);\n            }\n        }\n    }, {\n        key: 'type',\n        get: function get() {\n            return this._type;\n        }\n    }, {\n        key: 'buffered',\n        get: function get() {\n            return this._mediaElement.buffered;\n        }\n    }, {\n        key: 'duration',\n        get: function get() {\n            return this._mediaElement.duration;\n        }\n    }, {\n        key: 'volume',\n        get: function get() {\n            return this._mediaElement.volume;\n        },\n        set: function set(value) {\n            this._mediaElement.volume = value;\n        }\n    }, {\n        key: 'muted',\n        get: function get() {\n            return this._mediaElement.muted;\n        },\n        set: function set(muted) {\n            this._mediaElement.muted = muted;\n        }\n    }, {\n        key: 'currentTime',\n        get: function get() {\n            if (this._mediaElement) {\n                return this._mediaElement.currentTime;\n            }\n            return 0;\n        },\n        set: function set(seconds) {\n            if (this._mediaElement) {\n                this._internalSeek(seconds);\n            } else {\n                this._pendingSeekTime = seconds;\n            }\n        }\n    }, {\n        key: 'mediaInfo',\n        get: function get() {\n            return Object.assign({}, this._mediaInfo);\n        }\n    }, {\n        key: 'statisticsInfo',\n        get: function get() {\n            if (this._statisticsInfo == null) {\n                this._statisticsInfo = {};\n            }\n            this._statisticsInfo = this._fillStatisticsInfo(this._statisticsInfo);\n            return Object.assign({}, this._statisticsInfo);\n        }\n    }]);\n\n    return FlvPlayer;\n}();\n\nexports.default = FlvPlayer;\n\n},{\"../config.js\":5,\"../core/mse-controller.js\":9,\"../core/mse-events.js\":10,\"../core/transmuxer.js\":11,\"../core/transmuxing-events.js\":13,\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./player-errors.js\":34,\"./player-events.js\":35,\"events\":2}],33:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _playerEvents = _dereq_('./player-events.js');\n\nvar _playerEvents2 = _interopRequireDefault(_playerEvents);\n\nvar _config = _dereq_('../config.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Player wrapper for browser's native player (HTMLVideoElement) without MediaSource src. \nvar NativePlayer = function () {\n    function NativePlayer(mediaDataSource, config) {\n        _classCallCheck(this, NativePlayer);\n\n        this.TAG = 'NativePlayer';\n        this._type = 'NativePlayer';\n        this._emitter = new _events2.default();\n\n        this._config = (0, _config.createDefaultConfig)();\n        if ((typeof config === 'undefined' ? 'undefined' : _typeof(config)) === 'object') {\n            Object.assign(this._config, config);\n        }\n\n        if (mediaDataSource.type.toLowerCase() === 'flv') {\n            throw new _exception.InvalidArgumentException('NativePlayer does\\'t support flv MediaDataSource input!');\n        }\n        if (mediaDataSource.hasOwnProperty('segments')) {\n            throw new _exception.InvalidArgumentException('NativePlayer(' + mediaDataSource.type + ') doesn\\'t support multipart playback!');\n        }\n\n        this.e = {\n            onvLoadedMetadata: this._onvLoadedMetadata.bind(this)\n        };\n\n        this._pendingSeekTime = null;\n        this._statisticsReporter = null;\n\n        this._mediaDataSource = mediaDataSource;\n        this._mediaElement = null;\n    }\n\n    _createClass(NativePlayer, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._mediaElement) {\n                this.unload();\n                this.detachMediaElement();\n            }\n            this.e = null;\n            this._mediaDataSource = null;\n            this._emitter.removeAllListeners();\n            this._emitter = null;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, listener) {\n            var _this = this;\n\n            if (event === _playerEvents2.default.MEDIA_INFO) {\n                if (this._mediaElement != null && this._mediaElement.readyState !== 0) {\n                    // HAVE_NOTHING\n                    Promise.resolve().then(function () {\n                        _this._emitter.emit(_playerEvents2.default.MEDIA_INFO, _this.mediaInfo);\n                    });\n                }\n            } else if (event === _playerEvents2.default.STATISTICS_INFO) {\n                if (this._mediaElement != null && this._mediaElement.readyState !== 0) {\n                    Promise.resolve().then(function () {\n                        _this._emitter.emit(_playerEvents2.default.STATISTICS_INFO, _this.statisticsInfo);\n                    });\n                }\n            }\n            this._emitter.addListener(event, listener);\n        }\n    }, {\n        key: 'off',\n        value: function off(event, listener) {\n            this._emitter.removeListener(event, listener);\n        }\n    }, {\n        key: 'attachMediaElement',\n        value: function attachMediaElement(mediaElement) {\n            this._mediaElement = mediaElement;\n            mediaElement.addEventListener('loadedmetadata', this.e.onvLoadedMetadata);\n\n            if (this._pendingSeekTime != null) {\n                try {\n                    mediaElement.currentTime = this._pendingSeekTime;\n                    this._pendingSeekTime = null;\n                } catch (e) {\n                    // IE11 may throw InvalidStateError if readyState === 0\n                    // Defer set currentTime operation after loadedmetadata\n                }\n            }\n        }\n    }, {\n        key: 'detachMediaElement',\n        value: function detachMediaElement() {\n            if (this._mediaElement) {\n                this._mediaElement.src = '';\n                this._mediaElement.removeAttribute('src');\n                this._mediaElement.removeEventListener('loadedmetadata', this.e.onvLoadedMetadata);\n                this._mediaElement = null;\n            }\n            if (this._statisticsReporter != null) {\n                window.clearInterval(this._statisticsReporter);\n                this._statisticsReporter = null;\n            }\n        }\n    }, {\n        key: 'load',\n        value: function load() {\n            if (!this._mediaElement) {\n                throw new _exception.IllegalStateException('HTMLMediaElement must be attached before load()!');\n            }\n            this._mediaElement.src = this._mediaDataSource.url;\n\n            if (this._mediaElement.readyState > 0) {\n                this._mediaElement.currentTime = 0;\n            }\n\n            this._mediaElement.preload = 'auto';\n            this._mediaElement.load();\n            this._statisticsReporter = window.setInterval(this._reportStatisticsInfo.bind(this), this._config.statisticsInfoReportInterval);\n        }\n    }, {\n        key: 'unload',\n        value: function unload() {\n            if (this._mediaElement) {\n                this._mediaElement.src = '';\n                this._mediaElement.removeAttribute('src');\n            }\n            if (this._statisticsReporter != null) {\n                window.clearInterval(this._statisticsReporter);\n                this._statisticsReporter = null;\n            }\n        }\n    }, {\n        key: 'play',\n        value: function play() {\n            return this._mediaElement.play();\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            this._mediaElement.pause();\n        }\n    }, {\n        key: '_onvLoadedMetadata',\n        value: function _onvLoadedMetadata(e) {\n            if (this._pendingSeekTime != null) {\n                this._mediaElement.currentTime = this._pendingSeekTime;\n                this._pendingSeekTime = null;\n            }\n            this._emitter.emit(_playerEvents2.default.MEDIA_INFO, this.mediaInfo);\n        }\n    }, {\n        key: '_reportStatisticsInfo',\n        value: function _reportStatisticsInfo() {\n            this._emitter.emit(_playerEvents2.default.STATISTICS_INFO, this.statisticsInfo);\n        }\n    }, {\n        key: 'type',\n        get: function get() {\n            return this._type;\n        }\n    }, {\n        key: 'buffered',\n        get: function get() {\n            return this._mediaElement.buffered;\n        }\n    }, {\n        key: 'duration',\n        get: function get() {\n            return this._mediaElement.duration;\n        }\n    }, {\n        key: 'volume',\n        get: function get() {\n            return this._mediaElement.volume;\n        },\n        set: function set(value) {\n            this._mediaElement.volume = value;\n        }\n    }, {\n        key: 'muted',\n        get: function get() {\n            return this._mediaElement.muted;\n        },\n        set: function set(muted) {\n            this._mediaElement.muted = muted;\n        }\n    }, {\n        key: 'currentTime',\n        get: function get() {\n            if (this._mediaElement) {\n                return this._mediaElement.currentTime;\n            }\n            return 0;\n        },\n        set: function set(seconds) {\n            if (this._mediaElement) {\n                this._mediaElement.currentTime = seconds;\n            } else {\n                this._pendingSeekTime = seconds;\n            }\n        }\n    }, {\n        key: 'mediaInfo',\n        get: function get() {\n            var mediaPrefix = this._mediaElement instanceof HTMLAudioElement ? 'audio/' : 'video/';\n            var info = {\n                mimeType: mediaPrefix + this._mediaDataSource.type\n            };\n            if (this._mediaElement) {\n                info.duration = Math.floor(this._mediaElement.duration * 1000);\n                if (this._mediaElement instanceof HTMLVideoElement) {\n                    info.width = this._mediaElement.videoWidth;\n                    info.height = this._mediaElement.videoHeight;\n                }\n            }\n            return info;\n        }\n    }, {\n        key: 'statisticsInfo',\n        get: function get() {\n            var info = {\n                playerType: this._type,\n                url: this._mediaDataSource.url\n            };\n\n            if (!(this._mediaElement instanceof HTMLVideoElement)) {\n                return info;\n            }\n\n            var hasQualityInfo = true;\n            var decoded = 0;\n            var dropped = 0;\n\n            if (this._mediaElement.getVideoPlaybackQuality) {\n                var quality = this._mediaElement.getVideoPlaybackQuality();\n                decoded = quality.totalVideoFrames;\n                dropped = quality.droppedVideoFrames;\n            } else if (this._mediaElement.webkitDecodedFrameCount != undefined) {\n                decoded = this._mediaElement.webkitDecodedFrameCount;\n                dropped = this._mediaElement.webkitDroppedFrameCount;\n            } else {\n                hasQualityInfo = false;\n            }\n\n            if (hasQualityInfo) {\n                info.decodedFrames = decoded;\n                info.droppedFrames = dropped;\n            }\n\n            return info;\n        }\n    }]);\n\n    return NativePlayer;\n}();\n\nexports.default = NativePlayer;\n\n},{\"../config.js\":5,\"../utils/exception.js\":40,\"./player-events.js\":35,\"events\":2}],34:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.ErrorDetails = exports.ErrorTypes = undefined;\n\nvar _loader = _dereq_('../io/loader.js');\n\nvar _demuxErrors = _dereq_('../demux/demux-errors.js');\n\nvar _demuxErrors2 = _interopRequireDefault(_demuxErrors);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar ErrorTypes = exports.ErrorTypes = {\n    NETWORK_ERROR: 'NetworkError',\n    MEDIA_ERROR: 'MediaError',\n    OTHER_ERROR: 'OtherError'\n};\n\nvar ErrorDetails = exports.ErrorDetails = {\n    NETWORK_EXCEPTION: _loader.LoaderErrors.EXCEPTION,\n    NETWORK_STATUS_CODE_INVALID: _loader.LoaderErrors.HTTP_STATUS_CODE_INVALID,\n    NETWORK_TIMEOUT: _loader.LoaderErrors.CONNECTING_TIMEOUT,\n    NETWORK_UNRECOVERABLE_EARLY_EOF: _loader.LoaderErrors.UNRECOVERABLE_EARLY_EOF,\n\n    MEDIA_MSE_ERROR: 'MediaMSEError',\n\n    MEDIA_FORMAT_ERROR: _demuxErrors2.default.FORMAT_ERROR,\n    MEDIA_FORMAT_UNSUPPORTED: _demuxErrors2.default.FORMAT_UNSUPPORTED,\n    MEDIA_CODEC_UNSUPPORTED: _demuxErrors2.default.CODEC_UNSUPPORTED\n};\n\n},{\"../demux/demux-errors.js\":16,\"../io/loader.js\":24}],35:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar PlayerEvents = {\n  ERROR: 'error',\n  LOADING_COMPLETE: 'loading_complete',\n  RECOVERED_EARLY_EOF: 'recovered_early_eof',\n  MEDIA_INFO: 'media_info',\n  METADATA_ARRIVED: 'metadata_arrived',\n  SCRIPTDATA_ARRIVED: 'scriptdata_arrived',\n  STATISTICS_INFO: 'statistics_info'\n};\n\nexports.default = PlayerEvents;\n\n},{}],36:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * This file is modified from dailymotion's hls.js library (hls.js/src/helper/aac.js)\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar AAC = function () {\n    function AAC() {\n        _classCallCheck(this, AAC);\n    }\n\n    _createClass(AAC, null, [{\n        key: 'getSilentFrame',\n        value: function getSilentFrame(codec, channelCount) {\n            if (codec === 'mp4a.40.2') {\n                // handle LC-AAC\n                if (channelCount === 1) {\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x23, 0x80]);\n                } else if (channelCount === 2) {\n                    return new Uint8Array([0x21, 0x00, 0x49, 0x90, 0x02, 0x19, 0x00, 0x23, 0x80]);\n                } else if (channelCount === 3) {\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x8e]);\n                } else if (channelCount === 4) {\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x80, 0x2c, 0x80, 0x08, 0x02, 0x38]);\n                } else if (channelCount === 5) {\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x38]);\n                } else if (channelCount === 6) {\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x00, 0xb2, 0x00, 0x20, 0x08, 0xe0]);\n                }\n            } else {\n                // handle HE-AAC (mp4a.40.5 / mp4a.40.29)\n                if (channelCount === 1) {\n                    // ffmpeg -y -f lavfi -i \"aevalsrc=0:d=0.05\" -c:a libfdk_aac -profile:a aac_he -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n                    return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x4e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x1c, 0x6, 0xf1, 0xc1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\n                } else if (channelCount === 2) {\n                    // ffmpeg -y -f lavfi -i \"aevalsrc=0|0:d=0.05\" -c:a libfdk_aac -profile:a aac_he_v2 -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n                    return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x5e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x0, 0x95, 0x0, 0x6, 0xf1, 0xa1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\n                } else if (channelCount === 3) {\n                    // ffmpeg -y -f lavfi -i \"aevalsrc=0|0|0:d=0.05\" -c:a libfdk_aac -profile:a aac_he_v2 -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n                    return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x5e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x0, 0x95, 0x0, 0x6, 0xf1, 0xa1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\n                }\n            }\n            return null;\n        }\n    }]);\n\n    return AAC;\n}();\n\nexports.default = AAC;\n\n},{}],37:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * This file is derived from dailymotion's hls.js library (hls.js/src/remux/mp4-generator.js)\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n//  MP4 boxes generator for ISO BMFF (ISO Base Media File Format, defined in ISO/IEC 14496-12)\nvar MP4 = function () {\n    function MP4() {\n        _classCallCheck(this, MP4);\n    }\n\n    _createClass(MP4, null, [{\n        key: 'init',\n        value: function init() {\n            MP4.types = {\n                avc1: [], avcC: [], btrt: [], dinf: [],\n                dref: [], esds: [], ftyp: [], hdlr: [],\n                mdat: [], mdhd: [], mdia: [], mfhd: [],\n                minf: [], moof: [], moov: [], mp4a: [],\n                mvex: [], mvhd: [], sdtp: [], stbl: [],\n                stco: [], stsc: [], stsd: [], stsz: [],\n                stts: [], tfdt: [], tfhd: [], traf: [],\n                trak: [], trun: [], trex: [], tkhd: [],\n                vmhd: [], smhd: [], '.mp3': []\n            };\n\n            for (var name in MP4.types) {\n                if (MP4.types.hasOwnProperty(name)) {\n                    MP4.types[name] = [name.charCodeAt(0), name.charCodeAt(1), name.charCodeAt(2), name.charCodeAt(3)];\n                }\n            }\n\n            var constants = MP4.constants = {};\n\n            constants.FTYP = new Uint8Array([0x69, 0x73, 0x6F, 0x6D, // major_brand: isom\n            0x0, 0x0, 0x0, 0x1, // minor_version: 0x01\n            0x69, 0x73, 0x6F, 0x6D, // isom\n            0x61, 0x76, 0x63, 0x31 // avc1\n            ]);\n\n            constants.STSD_PREFIX = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x01 // entry_count\n            ]);\n\n            constants.STTS = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00 // entry_count\n            ]);\n\n            constants.STSC = constants.STCO = constants.STTS;\n\n            constants.STSZ = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // sample_size\n            0x00, 0x00, 0x00, 0x00 // sample_count\n            ]);\n\n            constants.HDLR_VIDEO = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // pre_defined\n            0x76, 0x69, 0x64, 0x65, // handler_type: 'vide'\n            0x00, 0x00, 0x00, 0x00, // reserved: 3 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x56, 0x69, 0x64, 0x65, 0x6F, 0x48, 0x61, 0x6E, 0x64, 0x6C, 0x65, 0x72, 0x00 // name: VideoHandler\n            ]);\n\n            constants.HDLR_AUDIO = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // pre_defined\n            0x73, 0x6F, 0x75, 0x6E, // handler_type: 'soun'\n            0x00, 0x00, 0x00, 0x00, // reserved: 3 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x53, 0x6F, 0x75, 0x6E, 0x64, 0x48, 0x61, 0x6E, 0x64, 0x6C, 0x65, 0x72, 0x00 // name: SoundHandler\n            ]);\n\n            constants.DREF = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x01, // entry_count\n            0x00, 0x00, 0x00, 0x0C, // entry_size\n            0x75, 0x72, 0x6C, 0x20, // type 'url '\n            0x00, 0x00, 0x00, 0x01 // version(0) + flags\n            ]);\n\n            // Sound media header\n            constants.SMHD = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00 // balance(2) + reserved(2)\n            ]);\n\n            // video media header\n            constants.VMHD = new Uint8Array([0x00, 0x00, 0x00, 0x01, // version(0) + flags\n            0x00, 0x00, // graphicsmode: 2 bytes\n            0x00, 0x00, 0x00, 0x00, // opcolor: 3 * 2 bytes\n            0x00, 0x00]);\n        }\n\n        // Generate a box\n\n    }, {\n        key: 'box',\n        value: function box(type) {\n            var size = 8;\n            var result = null;\n            var datas = Array.prototype.slice.call(arguments, 1);\n            var arrayCount = datas.length;\n\n            for (var i = 0; i < arrayCount; i++) {\n                size += datas[i].byteLength;\n            }\n\n            result = new Uint8Array(size);\n            result[0] = size >>> 24 & 0xFF; // size\n            result[1] = size >>> 16 & 0xFF;\n            result[2] = size >>> 8 & 0xFF;\n            result[3] = size & 0xFF;\n\n            result.set(type, 4); // type\n\n            var offset = 8;\n            for (var _i = 0; _i < arrayCount; _i++) {\n                // data body\n                result.set(datas[_i], offset);\n                offset += datas[_i].byteLength;\n            }\n\n            return result;\n        }\n\n        // emit ftyp & moov\n\n    }, {\n        key: 'generateInitSegment',\n        value: function generateInitSegment(meta) {\n            var ftyp = MP4.box(MP4.types.ftyp, MP4.constants.FTYP);\n            var moov = MP4.moov(meta);\n\n            var result = new Uint8Array(ftyp.byteLength + moov.byteLength);\n            result.set(ftyp, 0);\n            result.set(moov, ftyp.byteLength);\n            return result;\n        }\n\n        // Movie metadata box\n\n    }, {\n        key: 'moov',\n        value: function moov(meta) {\n            var mvhd = MP4.mvhd(meta.timescale, meta.duration);\n            var trak = MP4.trak(meta);\n            var mvex = MP4.mvex(meta);\n            return MP4.box(MP4.types.moov, mvhd, trak, mvex);\n        }\n\n        // Movie header box\n\n    }, {\n        key: 'mvhd',\n        value: function mvhd(timescale, duration) {\n            return MP4.box(MP4.types.mvhd, new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // creation_time\n            0x00, 0x00, 0x00, 0x00, // modification_time\n            timescale >>> 24 & 0xFF, // timescale: 4 bytes\n            timescale >>> 16 & 0xFF, timescale >>> 8 & 0xFF, timescale & 0xFF, duration >>> 24 & 0xFF, // duration: 4 bytes\n            duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, 0x00, 0x01, 0x00, 0x00, // Preferred rate: 1.0\n            0x01, 0x00, 0x00, 0x00, // PreferredVolume(1.0, 2bytes) + reserved(2bytes)\n            0x00, 0x00, 0x00, 0x00, // reserved: 4 + 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, // ----begin composition matrix----\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, // ----end composition matrix----\n            0x00, 0x00, 0x00, 0x00, // ----begin pre_defined 6 * 4 bytes----\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // ----end pre_defined 6 * 4 bytes----\n            0xFF, 0xFF, 0xFF, 0xFF // next_track_ID\n            ]));\n        }\n\n        // Track box\n\n    }, {\n        key: 'trak',\n        value: function trak(meta) {\n            return MP4.box(MP4.types.trak, MP4.tkhd(meta), MP4.mdia(meta));\n        }\n\n        // Track header box\n\n    }, {\n        key: 'tkhd',\n        value: function tkhd(meta) {\n            var trackId = meta.id,\n                duration = meta.duration;\n            var width = meta.presentWidth,\n                height = meta.presentHeight;\n\n            return MP4.box(MP4.types.tkhd, new Uint8Array([0x00, 0x00, 0x00, 0x07, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // creation_time\n            0x00, 0x00, 0x00, 0x00, // modification_time\n            trackId >>> 24 & 0xFF, // track_ID: 4 bytes\n            trackId >>> 16 & 0xFF, trackId >>> 8 & 0xFF, trackId & 0xFF, 0x00, 0x00, 0x00, 0x00, // reserved: 4 bytes\n            duration >>> 24 & 0xFF, // duration: 4 bytes\n            duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, 0x00, 0x00, 0x00, 0x00, // reserved: 2 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // layer(2bytes) + alternate_group(2bytes)\n            0x00, 0x00, 0x00, 0x00, // volume(2bytes) + reserved(2bytes)\n            0x00, 0x01, 0x00, 0x00, // ----begin composition matrix----\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, // ----end composition matrix----\n            width >>> 8 & 0xFF, // width and height\n            width & 0xFF, 0x00, 0x00, height >>> 8 & 0xFF, height & 0xFF, 0x00, 0x00]));\n        }\n\n        // Media Box\n\n    }, {\n        key: 'mdia',\n        value: function mdia(meta) {\n            return MP4.box(MP4.types.mdia, MP4.mdhd(meta), MP4.hdlr(meta), MP4.minf(meta));\n        }\n\n        // Media header box\n\n    }, {\n        key: 'mdhd',\n        value: function mdhd(meta) {\n            var timescale = meta.timescale;\n            var duration = meta.duration;\n            return MP4.box(MP4.types.mdhd, new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // creation_time\n            0x00, 0x00, 0x00, 0x00, // modification_time\n            timescale >>> 24 & 0xFF, // timescale: 4 bytes\n            timescale >>> 16 & 0xFF, timescale >>> 8 & 0xFF, timescale & 0xFF, duration >>> 24 & 0xFF, // duration: 4 bytes\n            duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, 0x55, 0xC4, // language: und (undetermined)\n            0x00, 0x00 // pre_defined = 0\n            ]));\n        }\n\n        // Media handler reference box\n\n    }, {\n        key: 'hdlr',\n        value: function hdlr(meta) {\n            var data = null;\n            if (meta.type === 'audio') {\n                data = MP4.constants.HDLR_AUDIO;\n            } else {\n                data = MP4.constants.HDLR_VIDEO;\n            }\n            return MP4.box(MP4.types.hdlr, data);\n        }\n\n        // Media infomation box\n\n    }, {\n        key: 'minf',\n        value: function minf(meta) {\n            var xmhd = null;\n            if (meta.type === 'audio') {\n                xmhd = MP4.box(MP4.types.smhd, MP4.constants.SMHD);\n            } else {\n                xmhd = MP4.box(MP4.types.vmhd, MP4.constants.VMHD);\n            }\n            return MP4.box(MP4.types.minf, xmhd, MP4.dinf(), MP4.stbl(meta));\n        }\n\n        // Data infomation box\n\n    }, {\n        key: 'dinf',\n        value: function dinf() {\n            var result = MP4.box(MP4.types.dinf, MP4.box(MP4.types.dref, MP4.constants.DREF));\n            return result;\n        }\n\n        // Sample table box\n\n    }, {\n        key: 'stbl',\n        value: function stbl(meta) {\n            var result = MP4.box(MP4.types.stbl, // type: stbl\n            MP4.stsd(meta), // Sample Description Table\n            MP4.box(MP4.types.stts, MP4.constants.STTS), // Time-To-Sample\n            MP4.box(MP4.types.stsc, MP4.constants.STSC), // Sample-To-Chunk\n            MP4.box(MP4.types.stsz, MP4.constants.STSZ), // Sample size\n            MP4.box(MP4.types.stco, MP4.constants.STCO // Chunk offset\n            ));\n            return result;\n        }\n\n        // Sample description box\n\n    }, {\n        key: 'stsd',\n        value: function stsd(meta) {\n            if (meta.type === 'audio') {\n                if (meta.codec === 'mp3') {\n                    return MP4.box(MP4.types.stsd, MP4.constants.STSD_PREFIX, MP4.mp3(meta));\n                }\n                // else: aac -> mp4a\n                return MP4.box(MP4.types.stsd, MP4.constants.STSD_PREFIX, MP4.mp4a(meta));\n            } else {\n                return MP4.box(MP4.types.stsd, MP4.constants.STSD_PREFIX, MP4.avc1(meta));\n            }\n        }\n    }, {\n        key: 'mp3',\n        value: function mp3(meta) {\n            var channelCount = meta.channelCount;\n            var sampleRate = meta.audioSampleRate;\n\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // reserved(4)\n            0x00, 0x00, 0x00, 0x01, // reserved(2) + data_reference_index(2)\n            0x00, 0x00, 0x00, 0x00, // reserved: 2 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, channelCount, // channelCount(2)\n            0x00, 0x10, // sampleSize(2)\n            0x00, 0x00, 0x00, 0x00, // reserved(4)\n            sampleRate >>> 8 & 0xFF, // Audio sample rate\n            sampleRate & 0xFF, 0x00, 0x00]);\n\n            return MP4.box(MP4.types['.mp3'], data);\n        }\n    }, {\n        key: 'mp4a',\n        value: function mp4a(meta) {\n            var channelCount = meta.channelCount;\n            var sampleRate = meta.audioSampleRate;\n\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // reserved(4)\n            0x00, 0x00, 0x00, 0x01, // reserved(2) + data_reference_index(2)\n            0x00, 0x00, 0x00, 0x00, // reserved: 2 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, channelCount, // channelCount(2)\n            0x00, 0x10, // sampleSize(2)\n            0x00, 0x00, 0x00, 0x00, // reserved(4)\n            sampleRate >>> 8 & 0xFF, // Audio sample rate\n            sampleRate & 0xFF, 0x00, 0x00]);\n\n            return MP4.box(MP4.types.mp4a, data, MP4.esds(meta));\n        }\n    }, {\n        key: 'esds',\n        value: function esds(meta) {\n            var config = meta.config || [];\n            var configSize = config.length;\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version 0 + flags\n\n            0x03, // descriptor_type\n            0x17 + configSize, // length3\n            0x00, 0x01, // es_id\n            0x00, // stream_priority\n\n            0x04, // descriptor_type\n            0x0F + configSize, // length\n            0x40, // codec: mpeg4_audio\n            0x15, // stream_type: Audio\n            0x00, 0x00, 0x00, // buffer_size\n            0x00, 0x00, 0x00, 0x00, // maxBitrate\n            0x00, 0x00, 0x00, 0x00, // avgBitrate\n\n            0x05 // descriptor_type\n            ].concat([configSize]).concat(config).concat([0x06, 0x01, 0x02 // GASpecificConfig\n            ]));\n            return MP4.box(MP4.types.esds, data);\n        }\n    }, {\n        key: 'avc1',\n        value: function avc1(meta) {\n            var avcc = meta.avcc;\n            var width = meta.codecWidth,\n                height = meta.codecHeight;\n\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // reserved(4)\n            0x00, 0x00, 0x00, 0x01, // reserved(2) + data_reference_index(2)\n            0x00, 0x00, 0x00, 0x00, // pre_defined(2) + reserved(2)\n            0x00, 0x00, 0x00, 0x00, // pre_defined: 3 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, width >>> 8 & 0xFF, // width: 2 bytes\n            width & 0xFF, height >>> 8 & 0xFF, // height: 2 bytes\n            height & 0xFF, 0x00, 0x48, 0x00, 0x00, // horizresolution: 4 bytes\n            0x00, 0x48, 0x00, 0x00, // vertresolution: 4 bytes\n            0x00, 0x00, 0x00, 0x00, // reserved: 4 bytes\n            0x00, 0x01, // frame_count\n            0x0A, // strlen\n            0x78, 0x71, 0x71, 0x2F, // compressorname: 32 bytes\n            0x66, 0x6C, 0x76, 0x2E, 0x6A, 0x73, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, // depth\n            0xFF, 0xFF // pre_defined = -1\n            ]);\n            return MP4.box(MP4.types.avc1, data, MP4.box(MP4.types.avcC, avcc));\n        }\n\n        // Movie Extends box\n\n    }, {\n        key: 'mvex',\n        value: function mvex(meta) {\n            return MP4.box(MP4.types.mvex, MP4.trex(meta));\n        }\n\n        // Track Extends box\n\n    }, {\n        key: 'trex',\n        value: function trex(meta) {\n            var trackId = meta.id;\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            trackId >>> 24 & 0xFF, // track_ID\n            trackId >>> 16 & 0xFF, trackId >>> 8 & 0xFF, trackId & 0xFF, 0x00, 0x00, 0x00, 0x01, // default_sample_description_index\n            0x00, 0x00, 0x00, 0x00, // default_sample_duration\n            0x00, 0x00, 0x00, 0x00, // default_sample_size\n            0x00, 0x01, 0x00, 0x01 // default_sample_flags\n            ]);\n            return MP4.box(MP4.types.trex, data);\n        }\n\n        // Movie fragment box\n\n    }, {\n        key: 'moof',\n        value: function moof(track, baseMediaDecodeTime) {\n            return MP4.box(MP4.types.moof, MP4.mfhd(track.sequenceNumber), MP4.traf(track, baseMediaDecodeTime));\n        }\n    }, {\n        key: 'mfhd',\n        value: function mfhd(sequenceNumber) {\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, sequenceNumber >>> 24 & 0xFF, // sequence_number: int32\n            sequenceNumber >>> 16 & 0xFF, sequenceNumber >>> 8 & 0xFF, sequenceNumber & 0xFF]);\n            return MP4.box(MP4.types.mfhd, data);\n        }\n\n        // Track fragment box\n\n    }, {\n        key: 'traf',\n        value: function traf(track, baseMediaDecodeTime) {\n            var trackId = track.id;\n\n            // Track fragment header box\n            var tfhd = MP4.box(MP4.types.tfhd, new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) & flags\n            trackId >>> 24 & 0xFF, // track_ID\n            trackId >>> 16 & 0xFF, trackId >>> 8 & 0xFF, trackId & 0xFF]));\n            // Track Fragment Decode Time\n            var tfdt = MP4.box(MP4.types.tfdt, new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) & flags\n            baseMediaDecodeTime >>> 24 & 0xFF, // baseMediaDecodeTime: int32\n            baseMediaDecodeTime >>> 16 & 0xFF, baseMediaDecodeTime >>> 8 & 0xFF, baseMediaDecodeTime & 0xFF]));\n            var sdtp = MP4.sdtp(track);\n            var trun = MP4.trun(track, sdtp.byteLength + 16 + 16 + 8 + 16 + 8 + 8);\n\n            return MP4.box(MP4.types.traf, tfhd, tfdt, trun, sdtp);\n        }\n\n        // Sample Dependency Type box\n\n    }, {\n        key: 'sdtp',\n        value: function sdtp(track) {\n            var samples = track.samples || [];\n            var sampleCount = samples.length;\n            var data = new Uint8Array(4 + sampleCount);\n            // 0~4 bytes: version(0) & flags\n            for (var i = 0; i < sampleCount; i++) {\n                var flags = samples[i].flags;\n                data[i + 4] = flags.isLeading << 6 | // is_leading: 2 (bit)\n                flags.dependsOn << 4 // sample_depends_on\n                | flags.isDependedOn << 2 // sample_is_depended_on\n                | flags.hasRedundancy; // sample_has_redundancy\n            }\n            return MP4.box(MP4.types.sdtp, data);\n        }\n\n        // Track fragment run box\n\n    }, {\n        key: 'trun',\n        value: function trun(track, offset) {\n            var samples = track.samples || [];\n            var sampleCount = samples.length;\n            var dataSize = 12 + 16 * sampleCount;\n            var data = new Uint8Array(dataSize);\n            offset += 8 + dataSize;\n\n            data.set([0x00, 0x00, 0x0F, 0x01, // version(0) & flags\n            sampleCount >>> 24 & 0xFF, // sample_count\n            sampleCount >>> 16 & 0xFF, sampleCount >>> 8 & 0xFF, sampleCount & 0xFF, offset >>> 24 & 0xFF, // data_offset\n            offset >>> 16 & 0xFF, offset >>> 8 & 0xFF, offset & 0xFF], 0);\n\n            for (var i = 0; i < sampleCount; i++) {\n                var duration = samples[i].duration;\n                var size = samples[i].size;\n                var flags = samples[i].flags;\n                var cts = samples[i].cts;\n                data.set([duration >>> 24 & 0xFF, // sample_duration\n                duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, size >>> 24 & 0xFF, // sample_size\n                size >>> 16 & 0xFF, size >>> 8 & 0xFF, size & 0xFF, flags.isLeading << 2 | flags.dependsOn, // sample_flags\n                flags.isDependedOn << 6 | flags.hasRedundancy << 4 | flags.isNonSync, 0x00, 0x00, // sample_degradation_priority\n                cts >>> 24 & 0xFF, // sample_composition_time_offset\n                cts >>> 16 & 0xFF, cts >>> 8 & 0xFF, cts & 0xFF], 12 + 16 * i);\n            }\n            return MP4.box(MP4.types.trun, data);\n        }\n    }, {\n        key: 'mdat',\n        value: function mdat(data) {\n            return MP4.box(MP4.types.mdat, data);\n        }\n    }]);\n\n    return MP4;\n}();\n\nMP4.init();\n\nexports.default = MP4;\n\n},{}],38:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _mp4Generator = _dereq_('./mp4-generator.js');\n\nvar _mp4Generator2 = _interopRequireDefault(_mp4Generator);\n\nvar _aacSilent = _dereq_('./aac-silent.js');\n\nvar _aacSilent2 = _interopRequireDefault(_aacSilent);\n\nvar _browser = _dereq_('../utils/browser.js');\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _mediaSegmentInfo = _dereq_('../core/media-segment-info.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Fragmented mp4 remuxer\nvar MP4Remuxer = function () {\n    function MP4Remuxer(config) {\n        _classCallCheck(this, MP4Remuxer);\n\n        this.TAG = 'MP4Remuxer';\n\n        this._config = config;\n        this._isLive = config.isLive === true ? true : false;\n\n        this._dtsBase = -1;\n        this._dtsBaseInited = false;\n        this._audioDtsBase = Infinity;\n        this._videoDtsBase = Infinity;\n        this._audioNextDts = undefined;\n        this._videoNextDts = undefined;\n        this._audioStashedLastSample = null;\n        this._videoStashedLastSample = null;\n\n        this._audioMeta = null;\n        this._videoMeta = null;\n\n        this._audioSegmentInfoList = new _mediaSegmentInfo.MediaSegmentInfoList('audio');\n        this._videoSegmentInfoList = new _mediaSegmentInfo.MediaSegmentInfoList('video');\n\n        this._onInitSegment = null;\n        this._onMediaSegment = null;\n\n        // Workaround for chrome < 50: Always force first sample as a Random Access Point in media segment\n        // see https://bugs.chromium.org/p/chromium/issues/detail?id=229412\n        this._forceFirstIDR = _browser2.default.chrome && (_browser2.default.version.major < 50 || _browser2.default.version.major === 50 && _browser2.default.version.build < 2661) ? true : false;\n\n        // Workaround for IE11/Edge: Fill silent aac frame after keyframe-seeking\n        // Make audio beginDts equals with video beginDts, in order to fix seek freeze\n        this._fillSilentAfterSeek = _browser2.default.msedge || _browser2.default.msie;\n\n        // While only FireFox supports 'audio/mp4, codecs=\"mp3\"', use 'audio/mpeg' for chrome, safari, ...\n        this._mp3UseMpegAudio = !_browser2.default.firefox;\n\n        this._fillAudioTimestampGap = this._config.fixAudioTimestampGap;\n    }\n\n    _createClass(MP4Remuxer, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._dtsBase = -1;\n            this._dtsBaseInited = false;\n            this._audioMeta = null;\n            this._videoMeta = null;\n            this._audioSegmentInfoList.clear();\n            this._audioSegmentInfoList = null;\n            this._videoSegmentInfoList.clear();\n            this._videoSegmentInfoList = null;\n            this._onInitSegment = null;\n            this._onMediaSegment = null;\n        }\n    }, {\n        key: 'bindDataSource',\n        value: function bindDataSource(producer) {\n            producer.onDataAvailable = this.remux.bind(this);\n            producer.onTrackMetadata = this._onTrackMetadataReceived.bind(this);\n            return this;\n        }\n\n        /* prototype: function onInitSegment(type: string, initSegment: ArrayBuffer): void\r\n           InitSegment: {\r\n               type: string,\r\n               data: ArrayBuffer,\r\n               codec: string,\r\n               container: string\r\n           }\r\n        */\n\n    }, {\n        key: 'insertDiscontinuity',\n        value: function insertDiscontinuity() {\n            this._audioNextDts = this._videoNextDts = undefined;\n        }\n    }, {\n        key: 'seek',\n        value: function seek(originalDts) {\n            this._audioStashedLastSample = null;\n            this._videoStashedLastSample = null;\n            this._videoSegmentInfoList.clear();\n            this._audioSegmentInfoList.clear();\n        }\n    }, {\n        key: 'remux',\n        value: function remux(audioTrack, videoTrack) {\n            if (!this._onMediaSegment) {\n                throw new _exception.IllegalStateException('MP4Remuxer: onMediaSegment callback must be specificed!');\n            }\n            if (!this._dtsBaseInited) {\n                this._calculateDtsBase(audioTrack, videoTrack);\n            }\n            this._remuxVideo(videoTrack);\n            this._remuxAudio(audioTrack);\n        }\n    }, {\n        key: '_onTrackMetadataReceived',\n        value: function _onTrackMetadataReceived(type, metadata) {\n            var metabox = null;\n\n            var container = 'mp4';\n            var codec = metadata.codec;\n\n            if (type === 'audio') {\n                this._audioMeta = metadata;\n                if (metadata.codec === 'mp3' && this._mp3UseMpegAudio) {\n                    // 'audio/mpeg' for MP3 audio track\n                    container = 'mpeg';\n                    codec = '';\n                    metabox = new Uint8Array();\n                } else {\n                    // 'audio/mp4, codecs=\"codec\"'\n                    metabox = _mp4Generator2.default.generateInitSegment(metadata);\n                }\n            } else if (type === 'video') {\n                this._videoMeta = metadata;\n                metabox = _mp4Generator2.default.generateInitSegment(metadata);\n            } else {\n                return;\n            }\n\n            // dispatch metabox (Initialization Segment)\n            if (!this._onInitSegment) {\n                throw new _exception.IllegalStateException('MP4Remuxer: onInitSegment callback must be specified!');\n            }\n            this._onInitSegment(type, {\n                type: type,\n                data: metabox.buffer,\n                codec: codec,\n                container: type + '/' + container,\n                mediaDuration: metadata.duration // in timescale 1000 (milliseconds)\n            });\n        }\n    }, {\n        key: '_calculateDtsBase',\n        value: function _calculateDtsBase(audioTrack, videoTrack) {\n            if (this._dtsBaseInited) {\n                return;\n            }\n\n            if (audioTrack.samples && audioTrack.samples.length) {\n                this._audioDtsBase = audioTrack.samples[0].dts;\n            }\n            if (videoTrack.samples && videoTrack.samples.length) {\n                this._videoDtsBase = videoTrack.samples[0].dts;\n            }\n\n            this._dtsBase = Math.min(this._audioDtsBase, this._videoDtsBase);\n            this._dtsBaseInited = true;\n        }\n    }, {\n        key: 'flushStashedSamples',\n        value: function flushStashedSamples() {\n            var videoSample = this._videoStashedLastSample;\n            var audioSample = this._audioStashedLastSample;\n\n            var videoTrack = {\n                type: 'video',\n                id: 1,\n                sequenceNumber: 0,\n                samples: [],\n                length: 0\n            };\n\n            if (videoSample != null) {\n                videoTrack.samples.push(videoSample);\n                videoTrack.length = videoSample.length;\n            }\n\n            var audioTrack = {\n                type: 'audio',\n                id: 2,\n                sequenceNumber: 0,\n                samples: [],\n                length: 0\n            };\n\n            if (audioSample != null) {\n                audioTrack.samples.push(audioSample);\n                audioTrack.length = audioSample.length;\n            }\n\n            this._videoStashedLastSample = null;\n            this._audioStashedLastSample = null;\n\n            this._remuxVideo(videoTrack, true);\n            this._remuxAudio(audioTrack, true);\n        }\n    }, {\n        key: '_remuxAudio',\n        value: function _remuxAudio(audioTrack, force) {\n            if (this._audioMeta == null) {\n                return;\n            }\n\n            var track = audioTrack;\n            var samples = track.samples;\n            var dtsCorrection = undefined;\n            var firstDts = -1,\n                lastDts = -1,\n                lastPts = -1;\n            var refSampleDuration = this._audioMeta.refSampleDuration;\n\n            var mpegRawTrack = this._audioMeta.codec === 'mp3' && this._mp3UseMpegAudio;\n            var firstSegmentAfterSeek = this._dtsBaseInited && this._audioNextDts === undefined;\n\n            var insertPrefixSilentFrame = false;\n\n            if (!samples || samples.length === 0) {\n                return;\n            }\n            if (samples.length === 1 && !force) {\n                // If [sample count in current batch] === 1 && (force != true)\n                // Ignore and keep in demuxer's queue\n                return;\n            } // else if (force === true) do remux\n\n            var offset = 0;\n            var mdatbox = null;\n            var mdatBytes = 0;\n\n            // calculate initial mdat size\n            if (mpegRawTrack) {\n                // for raw mpeg buffer\n                offset = 0;\n                mdatBytes = track.length;\n            } else {\n                // for fmp4 mdat box\n                offset = 8; // size + type\n                mdatBytes = 8 + track.length;\n            }\n\n            var lastSample = null;\n\n            // Pop the lastSample and waiting for stash\n            if (samples.length > 1) {\n                lastSample = samples.pop();\n                mdatBytes -= lastSample.length;\n            }\n\n            // Insert [stashed lastSample in the previous batch] to the front\n            if (this._audioStashedLastSample != null) {\n                var sample = this._audioStashedLastSample;\n                this._audioStashedLastSample = null;\n                samples.unshift(sample);\n                mdatBytes += sample.length;\n            }\n\n            // Stash the lastSample of current batch, waiting for next batch\n            if (lastSample != null) {\n                this._audioStashedLastSample = lastSample;\n            }\n\n            var firstSampleOriginalDts = samples[0].dts - this._dtsBase;\n\n            // calculate dtsCorrection\n            if (this._audioNextDts) {\n                dtsCorrection = firstSampleOriginalDts - this._audioNextDts;\n            } else {\n                // this._audioNextDts == undefined\n                if (this._audioSegmentInfoList.isEmpty()) {\n                    dtsCorrection = 0;\n                    if (this._fillSilentAfterSeek && !this._videoSegmentInfoList.isEmpty()) {\n                        if (this._audioMeta.originalCodec !== 'mp3') {\n                            insertPrefixSilentFrame = true;\n                        }\n                    }\n                } else {\n                    var _lastSample = this._audioSegmentInfoList.getLastSampleBefore(firstSampleOriginalDts);\n                    if (_lastSample != null) {\n                        var distance = firstSampleOriginalDts - (_lastSample.originalDts + _lastSample.duration);\n                        if (distance <= 3) {\n                            distance = 0;\n                        }\n                        var expectedDts = _lastSample.dts + _lastSample.duration + distance;\n                        dtsCorrection = firstSampleOriginalDts - expectedDts;\n                    } else {\n                        // lastSample == null, cannot found\n                        dtsCorrection = 0;\n                    }\n                }\n            }\n\n            if (insertPrefixSilentFrame) {\n                // align audio segment beginDts to match with current video segment's beginDts\n                var firstSampleDts = firstSampleOriginalDts - dtsCorrection;\n                var videoSegment = this._videoSegmentInfoList.getLastSegmentBefore(firstSampleOriginalDts);\n                if (videoSegment != null && videoSegment.beginDts < firstSampleDts) {\n                    var silentUnit = _aacSilent2.default.getSilentFrame(this._audioMeta.originalCodec, this._audioMeta.channelCount);\n                    if (silentUnit) {\n                        var dts = videoSegment.beginDts;\n                        var silentFrameDuration = firstSampleDts - videoSegment.beginDts;\n                        _logger2.default.v(this.TAG, 'InsertPrefixSilentAudio: dts: ' + dts + ', duration: ' + silentFrameDuration);\n                        samples.unshift({ unit: silentUnit, dts: dts, pts: dts });\n                        mdatBytes += silentUnit.byteLength;\n                    } // silentUnit == null: Cannot generate, skip\n                } else {\n                    insertPrefixSilentFrame = false;\n                }\n            }\n\n            var mp4Samples = [];\n\n            // Correct dts for each sample, and calculate sample duration. Then output to mp4Samples\n            for (var i = 0; i < samples.length; i++) {\n                var _sample = samples[i];\n                var unit = _sample.unit;\n                var originalDts = _sample.dts - this._dtsBase;\n                var _dts = originalDts;\n                var needFillSilentFrames = false;\n                var silentFrames = null;\n                var sampleDuration = 0;\n\n                if (originalDts < -0.001) {\n                    continue; //pass the first sample with the invalid dts\n                }\n\n                if (this._audioMeta.codec !== 'mp3') {\n                    // for AAC codec, we need to keep dts increase based on refSampleDuration\n                    var curRefDts = originalDts;\n                    var maxAudioFramesDrift = 3;\n                    if (this._audioNextDts) {\n                        curRefDts = this._audioNextDts;\n                    }\n\n                    dtsCorrection = originalDts - curRefDts;\n                    if (dtsCorrection <= -maxAudioFramesDrift * refSampleDuration) {\n                        // If we're overlapping by more than maxAudioFramesDrift number of frame, drop this sample\n                        //Log.w(this.TAG, `Dropping 1 audio frame (originalDts: ${originalDts} ms ,curRefDts: ${curRefDts} ms)  due to dtsCorrection: ${dtsCorrection} ms overlap.`);\n                        continue;\n                    } else if (dtsCorrection >= maxAudioFramesDrift * refSampleDuration && this._fillAudioTimestampGap && !_browser2.default.safari) {\n                        // Silent frame generation, if large timestamp gap detected && config.fixAudioTimestampGap\n                        needFillSilentFrames = true;\n                        // We need to insert silent frames to fill timestamp gap\n                        var frameCount = Math.floor(dtsCorrection / refSampleDuration);\n                        _logger2.default.w(this.TAG, 'Large audio timestamp gap detected, may cause AV sync to drift. ' + 'Silent frames will be generated to avoid unsync.\\n' + ('originalDts: ' + originalDts + ' ms, curRefDts: ' + curRefDts + ' ms, ') + ('dtsCorrection: ' + Math.round(dtsCorrection) + ' ms, generate: ' + frameCount + ' frames'));\n\n                        _dts = Math.floor(curRefDts);\n                        sampleDuration = Math.floor(curRefDts + refSampleDuration) - _dts;\n\n                        var _silentUnit = _aacSilent2.default.getSilentFrame(this._audioMeta.originalCodec, this._audioMeta.channelCount);\n                        if (_silentUnit == null) {\n                            _logger2.default.w(this.TAG, 'Unable to generate silent frame for ' + (this._audioMeta.originalCodec + ' with ' + this._audioMeta.channelCount + ' channels, repeat last frame'));\n                            // Repeat last frame\n                            _silentUnit = unit;\n                        }\n                        silentFrames = [];\n\n                        for (var j = 0; j < frameCount; j++) {\n                            curRefDts = curRefDts + refSampleDuration;\n                            var intDts = Math.floor(curRefDts); // change to integer\n                            var intDuration = Math.floor(curRefDts + refSampleDuration) - intDts;\n                            var frame = {\n                                dts: intDts,\n                                pts: intDts,\n                                cts: 0,\n                                unit: _silentUnit,\n                                size: _silentUnit.byteLength,\n                                duration: intDuration, // wait for next sample\n                                originalDts: originalDts,\n                                flags: {\n                                    isLeading: 0,\n                                    dependsOn: 1,\n                                    isDependedOn: 0,\n                                    hasRedundancy: 0\n                                }\n                            };\n                            silentFrames.push(frame);\n                            mdatBytes += frame.size;\n                        }\n\n                        this._audioNextDts = curRefDts + refSampleDuration;\n                    } else {\n\n                        _dts = Math.floor(curRefDts);\n                        sampleDuration = Math.floor(curRefDts + refSampleDuration) - _dts;\n                        this._audioNextDts = curRefDts + refSampleDuration;\n                    }\n                } else {\n                    // keep the original dts calculate algorithm for mp3\n                    _dts = originalDts - dtsCorrection;\n\n                    if (i !== samples.length - 1) {\n                        var nextDts = samples[i + 1].dts - this._dtsBase - dtsCorrection;\n                        sampleDuration = nextDts - _dts;\n                    } else {\n                        // the last sample\n                        if (lastSample != null) {\n                            // use stashed sample's dts to calculate sample duration\n                            var _nextDts = lastSample.dts - this._dtsBase - dtsCorrection;\n                            sampleDuration = _nextDts - _dts;\n                        } else if (mp4Samples.length >= 1) {\n                            // use second last sample duration\n                            sampleDuration = mp4Samples[mp4Samples.length - 1].duration;\n                        } else {\n                            // the only one sample, use reference sample duration\n                            sampleDuration = Math.floor(refSampleDuration);\n                        }\n                    }\n                    this._audioNextDts = _dts + sampleDuration;\n                }\n\n                if (firstDts === -1) {\n                    firstDts = _dts;\n                }\n                mp4Samples.push({\n                    dts: _dts,\n                    pts: _dts,\n                    cts: 0,\n                    unit: _sample.unit,\n                    size: _sample.unit.byteLength,\n                    duration: sampleDuration,\n                    originalDts: originalDts,\n                    flags: {\n                        isLeading: 0,\n                        dependsOn: 1,\n                        isDependedOn: 0,\n                        hasRedundancy: 0\n                    }\n                });\n\n                if (needFillSilentFrames) {\n                    // Silent frames should be inserted after wrong-duration frame\n                    mp4Samples.push.apply(mp4Samples, silentFrames);\n                }\n            }\n\n            if (mp4Samples.length === 0) {\n                //no samples need to remux\n                track.samples = [];\n                track.length = 0;\n                return;\n            }\n\n            // allocate mdatbox\n            if (mpegRawTrack) {\n                // allocate for raw mpeg buffer\n                mdatbox = new Uint8Array(mdatBytes);\n            } else {\n                // allocate for fmp4 mdat box\n                mdatbox = new Uint8Array(mdatBytes);\n                // size field\n                mdatbox[0] = mdatBytes >>> 24 & 0xFF;\n                mdatbox[1] = mdatBytes >>> 16 & 0xFF;\n                mdatbox[2] = mdatBytes >>> 8 & 0xFF;\n                mdatbox[3] = mdatBytes & 0xFF;\n                // type field (fourCC)\n                mdatbox.set(_mp4Generator2.default.types.mdat, 4);\n            }\n\n            // Write samples into mdatbox\n            for (var _i = 0; _i < mp4Samples.length; _i++) {\n                var _unit = mp4Samples[_i].unit;\n                mdatbox.set(_unit, offset);\n                offset += _unit.byteLength;\n            }\n\n            var latest = mp4Samples[mp4Samples.length - 1];\n            lastDts = latest.dts + latest.duration;\n            //this._audioNextDts = lastDts;\n\n            // fill media segment info & add to info list\n            var info = new _mediaSegmentInfo.MediaSegmentInfo();\n            info.beginDts = firstDts;\n            info.endDts = lastDts;\n            info.beginPts = firstDts;\n            info.endPts = lastDts;\n            info.originalBeginDts = mp4Samples[0].originalDts;\n            info.originalEndDts = latest.originalDts + latest.duration;\n            info.firstSample = new _mediaSegmentInfo.SampleInfo(mp4Samples[0].dts, mp4Samples[0].pts, mp4Samples[0].duration, mp4Samples[0].originalDts, false);\n            info.lastSample = new _mediaSegmentInfo.SampleInfo(latest.dts, latest.pts, latest.duration, latest.originalDts, false);\n            if (!this._isLive) {\n                this._audioSegmentInfoList.append(info);\n            }\n\n            track.samples = mp4Samples;\n            track.sequenceNumber++;\n\n            var moofbox = null;\n\n            if (mpegRawTrack) {\n                // Generate empty buffer, because useless for raw mpeg\n                moofbox = new Uint8Array();\n            } else {\n                // Generate moof for fmp4 segment\n                moofbox = _mp4Generator2.default.moof(track, firstDts);\n            }\n\n            track.samples = [];\n            track.length = 0;\n\n            var segment = {\n                type: 'audio',\n                data: this._mergeBoxes(moofbox, mdatbox).buffer,\n                sampleCount: mp4Samples.length,\n                info: info\n            };\n\n            if (mpegRawTrack && firstSegmentAfterSeek) {\n                // For MPEG audio stream in MSE, if seeking occurred, before appending new buffer\n                // We need explicitly set timestampOffset to the desired point in timeline for mpeg SourceBuffer.\n                segment.timestampOffset = firstDts;\n            }\n\n            this._onMediaSegment('audio', segment);\n        }\n    }, {\n        key: '_remuxVideo',\n        value: function _remuxVideo(videoTrack, force) {\n            if (this._videoMeta == null) {\n                return;\n            }\n\n            var track = videoTrack;\n            var samples = track.samples;\n            var dtsCorrection = undefined;\n            var firstDts = -1,\n                lastDts = -1;\n            var firstPts = -1,\n                lastPts = -1;\n\n            if (!samples || samples.length === 0) {\n                return;\n            }\n            if (samples.length === 1 && !force) {\n                // If [sample count in current batch] === 1 && (force != true)\n                // Ignore and keep in demuxer's queue\n                return;\n            } // else if (force === true) do remux\n\n            var offset = 8;\n            var mdatbox = null;\n            var mdatBytes = 8 + videoTrack.length;\n\n            var lastSample = null;\n\n            // Pop the lastSample and waiting for stash\n            if (samples.length > 1) {\n                lastSample = samples.pop();\n                mdatBytes -= lastSample.length;\n            }\n\n            // Insert [stashed lastSample in the previous batch] to the front\n            if (this._videoStashedLastSample != null) {\n                var sample = this._videoStashedLastSample;\n                this._videoStashedLastSample = null;\n                samples.unshift(sample);\n                mdatBytes += sample.length;\n            }\n\n            // Stash the lastSample of current batch, waiting for next batch\n            if (lastSample != null) {\n                this._videoStashedLastSample = lastSample;\n            }\n\n            var firstSampleOriginalDts = samples[0].dts - this._dtsBase;\n\n            // calculate dtsCorrection\n            if (this._videoNextDts) {\n                dtsCorrection = firstSampleOriginalDts - this._videoNextDts;\n            } else {\n                // this._videoNextDts == undefined\n                if (this._videoSegmentInfoList.isEmpty()) {\n                    dtsCorrection = 0;\n                } else {\n                    var _lastSample2 = this._videoSegmentInfoList.getLastSampleBefore(firstSampleOriginalDts);\n                    if (_lastSample2 != null) {\n                        var distance = firstSampleOriginalDts - (_lastSample2.originalDts + _lastSample2.duration);\n                        if (distance <= 3) {\n                            distance = 0;\n                        }\n                        var expectedDts = _lastSample2.dts + _lastSample2.duration + distance;\n                        dtsCorrection = firstSampleOriginalDts - expectedDts;\n                    } else {\n                        // lastSample == null, cannot found\n                        dtsCorrection = 0;\n                    }\n                }\n            }\n\n            var info = new _mediaSegmentInfo.MediaSegmentInfo();\n            var mp4Samples = [];\n\n            // Correct dts for each sample, and calculate sample duration. Then output to mp4Samples\n            for (var i = 0; i < samples.length; i++) {\n                var _sample2 = samples[i];\n                var originalDts = _sample2.dts - this._dtsBase;\n                var isKeyframe = _sample2.isKeyframe;\n                var dts = originalDts - dtsCorrection;\n                var cts = _sample2.cts;\n                var pts = dts + cts;\n\n                if (firstDts === -1) {\n                    firstDts = dts;\n                    firstPts = pts;\n                }\n\n                var sampleDuration = 0;\n\n                if (i !== samples.length - 1) {\n                    var nextDts = samples[i + 1].dts - this._dtsBase - dtsCorrection;\n                    sampleDuration = nextDts - dts;\n                } else {\n                    // the last sample\n                    if (lastSample != null) {\n                        // use stashed sample's dts to calculate sample duration\n                        var _nextDts2 = lastSample.dts - this._dtsBase - dtsCorrection;\n                        sampleDuration = _nextDts2 - dts;\n                    } else if (mp4Samples.length >= 1) {\n                        // use second last sample duration\n                        sampleDuration = mp4Samples[mp4Samples.length - 1].duration;\n                    } else {\n                        // the only one sample, use reference sample duration\n                        sampleDuration = Math.floor(this._videoMeta.refSampleDuration);\n                    }\n                }\n\n                if (isKeyframe) {\n                    var syncPoint = new _mediaSegmentInfo.SampleInfo(dts, pts, sampleDuration, _sample2.dts, true);\n                    syncPoint.fileposition = _sample2.fileposition;\n                    info.appendSyncPoint(syncPoint);\n                }\n\n                mp4Samples.push({\n                    dts: dts,\n                    pts: pts,\n                    cts: cts,\n                    units: _sample2.units,\n                    size: _sample2.length,\n                    isKeyframe: isKeyframe,\n                    duration: sampleDuration,\n                    originalDts: originalDts,\n                    flags: {\n                        isLeading: 0,\n                        dependsOn: isKeyframe ? 2 : 1,\n                        isDependedOn: isKeyframe ? 1 : 0,\n                        hasRedundancy: 0,\n                        isNonSync: isKeyframe ? 0 : 1\n                    }\n                });\n            }\n\n            // allocate mdatbox\n            mdatbox = new Uint8Array(mdatBytes);\n            mdatbox[0] = mdatBytes >>> 24 & 0xFF;\n            mdatbox[1] = mdatBytes >>> 16 & 0xFF;\n            mdatbox[2] = mdatBytes >>> 8 & 0xFF;\n            mdatbox[3] = mdatBytes & 0xFF;\n            mdatbox.set(_mp4Generator2.default.types.mdat, 4);\n\n            // Write samples into mdatbox\n            for (var _i2 = 0; _i2 < mp4Samples.length; _i2++) {\n                var units = mp4Samples[_i2].units;\n                while (units.length) {\n                    var unit = units.shift();\n                    var data = unit.data;\n                    mdatbox.set(data, offset);\n                    offset += data.byteLength;\n                }\n            }\n\n            var latest = mp4Samples[mp4Samples.length - 1];\n            lastDts = latest.dts + latest.duration;\n            lastPts = latest.pts + latest.duration;\n            this._videoNextDts = lastDts;\n\n            // fill media segment info & add to info list\n            info.beginDts = firstDts;\n            info.endDts = lastDts;\n            info.beginPts = firstPts;\n            info.endPts = lastPts;\n            info.originalBeginDts = mp4Samples[0].originalDts;\n            info.originalEndDts = latest.originalDts + latest.duration;\n            info.firstSample = new _mediaSegmentInfo.SampleInfo(mp4Samples[0].dts, mp4Samples[0].pts, mp4Samples[0].duration, mp4Samples[0].originalDts, mp4Samples[0].isKeyframe);\n            info.lastSample = new _mediaSegmentInfo.SampleInfo(latest.dts, latest.pts, latest.duration, latest.originalDts, latest.isKeyframe);\n            if (!this._isLive) {\n                this._videoSegmentInfoList.append(info);\n            }\n\n            track.samples = mp4Samples;\n            track.sequenceNumber++;\n\n            // workaround for chrome < 50: force first sample as a random access point\n            // see https://bugs.chromium.org/p/chromium/issues/detail?id=229412\n            if (this._forceFirstIDR) {\n                var flags = mp4Samples[0].flags;\n                flags.dependsOn = 2;\n                flags.isNonSync = 0;\n            }\n\n            var moofbox = _mp4Generator2.default.moof(track, firstDts);\n            track.samples = [];\n            track.length = 0;\n\n            this._onMediaSegment('video', {\n                type: 'video',\n                data: this._mergeBoxes(moofbox, mdatbox).buffer,\n                sampleCount: mp4Samples.length,\n                info: info\n            });\n        }\n    }, {\n        key: '_mergeBoxes',\n        value: function _mergeBoxes(moof, mdat) {\n            var result = new Uint8Array(moof.byteLength + mdat.byteLength);\n            result.set(moof, 0);\n            result.set(mdat, moof.byteLength);\n            return result;\n        }\n    }, {\n        key: 'onInitSegment',\n        get: function get() {\n            return this._onInitSegment;\n        },\n        set: function set(callback) {\n            this._onInitSegment = callback;\n        }\n\n        /* prototype: function onMediaSegment(type: string, mediaSegment: MediaSegment): void\r\n           MediaSegment: {\r\n               type: string,\r\n               data: ArrayBuffer,\r\n               sampleCount: int32\r\n               info: MediaSegmentInfo\r\n           }\r\n        */\n\n    }, {\n        key: 'onMediaSegment',\n        get: function get() {\n            return this._onMediaSegment;\n        },\n        set: function set(callback) {\n            this._onMediaSegment = callback;\n        }\n    }]);\n\n    return MP4Remuxer;\n}();\n\nexports.default = MP4Remuxer;\n\n},{\"../core/media-segment-info.js\":8,\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./aac-silent.js\":36,\"./mp4-generator.js\":37}],39:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar Browser = {};\n\nfunction detect() {\n    // modified from jquery-browser-plugin\n\n    var ua = self.navigator.userAgent.toLowerCase();\n\n    var match = /(edge)\\/([\\w.]+)/.exec(ua) || /(opr)[\\/]([\\w.]+)/.exec(ua) || /(chrome)[ \\/]([\\w.]+)/.exec(ua) || /(iemobile)[\\/]([\\w.]+)/.exec(ua) || /(version)(applewebkit)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.exec(ua) || /(webkit)[ \\/]([\\w.]+).*(version)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.exec(ua) || /(webkit)[ \\/]([\\w.]+)/.exec(ua) || /(opera)(?:.*version|)[ \\/]([\\w.]+)/.exec(ua) || /(msie) ([\\w.]+)/.exec(ua) || ua.indexOf('trident') >= 0 && /(rv)(?::| )([\\w.]+)/.exec(ua) || ua.indexOf('compatible') < 0 && /(firefox)[ \\/]([\\w.]+)/.exec(ua) || [];\n\n    var platform_match = /(ipad)/.exec(ua) || /(ipod)/.exec(ua) || /(windows phone)/.exec(ua) || /(iphone)/.exec(ua) || /(kindle)/.exec(ua) || /(android)/.exec(ua) || /(windows)/.exec(ua) || /(mac)/.exec(ua) || /(linux)/.exec(ua) || /(cros)/.exec(ua) || [];\n\n    var matched = {\n        browser: match[5] || match[3] || match[1] || '',\n        version: match[2] || match[4] || '0',\n        majorVersion: match[4] || match[2] || '0',\n        platform: platform_match[0] || ''\n    };\n\n    var browser = {};\n    if (matched.browser) {\n        browser[matched.browser] = true;\n\n        var versionArray = matched.majorVersion.split('.');\n        browser.version = {\n            major: parseInt(matched.majorVersion, 10),\n            string: matched.version\n        };\n        if (versionArray.length > 1) {\n            browser.version.minor = parseInt(versionArray[1], 10);\n        }\n        if (versionArray.length > 2) {\n            browser.version.build = parseInt(versionArray[2], 10);\n        }\n    }\n\n    if (matched.platform) {\n        browser[matched.platform] = true;\n    }\n\n    if (browser.chrome || browser.opr || browser.safari) {\n        browser.webkit = true;\n    }\n\n    // MSIE. IE11 has 'rv' identifer\n    if (browser.rv || browser.iemobile) {\n        if (browser.rv) {\n            delete browser.rv;\n        }\n        var msie = 'msie';\n        matched.browser = msie;\n        browser[msie] = true;\n    }\n\n    // Microsoft Edge\n    if (browser.edge) {\n        delete browser.edge;\n        var msedge = 'msedge';\n        matched.browser = msedge;\n        browser[msedge] = true;\n    }\n\n    // Opera 15+\n    if (browser.opr) {\n        var opera = 'opera';\n        matched.browser = opera;\n        browser[opera] = true;\n    }\n\n    // Stock android browsers are marked as Safari\n    if (browser.safari && browser.android) {\n        var android = 'android';\n        matched.browser = android;\n        browser[android] = true;\n    }\n\n    browser.name = matched.browser;\n    browser.platform = matched.platform;\n\n    for (var key in Browser) {\n        if (Browser.hasOwnProperty(key)) {\n            delete Browser[key];\n        }\n    }\n    Object.assign(Browser, browser);\n}\n\ndetect();\n\nexports.default = Browser;\n\n},{}],40:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar RuntimeException = exports.RuntimeException = function () {\n    function RuntimeException(message) {\n        _classCallCheck(this, RuntimeException);\n\n        this._message = message;\n    }\n\n    _createClass(RuntimeException, [{\n        key: 'toString',\n        value: function toString() {\n            return this.name + ': ' + this.message;\n        }\n    }, {\n        key: 'name',\n        get: function get() {\n            return 'RuntimeException';\n        }\n    }, {\n        key: 'message',\n        get: function get() {\n            return this._message;\n        }\n    }]);\n\n    return RuntimeException;\n}();\n\nvar IllegalStateException = exports.IllegalStateException = function (_RuntimeException) {\n    _inherits(IllegalStateException, _RuntimeException);\n\n    function IllegalStateException(message) {\n        _classCallCheck(this, IllegalStateException);\n\n        return _possibleConstructorReturn(this, (IllegalStateException.__proto__ || Object.getPrototypeOf(IllegalStateException)).call(this, message));\n    }\n\n    _createClass(IllegalStateException, [{\n        key: 'name',\n        get: function get() {\n            return 'IllegalStateException';\n        }\n    }]);\n\n    return IllegalStateException;\n}(RuntimeException);\n\nvar InvalidArgumentException = exports.InvalidArgumentException = function (_RuntimeException2) {\n    _inherits(InvalidArgumentException, _RuntimeException2);\n\n    function InvalidArgumentException(message) {\n        _classCallCheck(this, InvalidArgumentException);\n\n        return _possibleConstructorReturn(this, (InvalidArgumentException.__proto__ || Object.getPrototypeOf(InvalidArgumentException)).call(this, message));\n    }\n\n    _createClass(InvalidArgumentException, [{\n        key: 'name',\n        get: function get() {\n            return 'InvalidArgumentException';\n        }\n    }]);\n\n    return InvalidArgumentException;\n}(RuntimeException);\n\nvar NotImplementedException = exports.NotImplementedException = function (_RuntimeException3) {\n    _inherits(NotImplementedException, _RuntimeException3);\n\n    function NotImplementedException(message) {\n        _classCallCheck(this, NotImplementedException);\n\n        return _possibleConstructorReturn(this, (NotImplementedException.__proto__ || Object.getPrototypeOf(NotImplementedException)).call(this, message));\n    }\n\n    _createClass(NotImplementedException, [{\n        key: 'name',\n        get: function get() {\n            return 'NotImplementedException';\n        }\n    }]);\n\n    return NotImplementedException;\n}(RuntimeException);\n\n},{}],41:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Log = function () {\n    function Log() {\n        _classCallCheck(this, Log);\n    }\n\n    _createClass(Log, null, [{\n        key: 'e',\n        value: function e(tag, msg) {\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\n\n            var str = '[' + tag + '] > ' + msg;\n\n            if (Log.ENABLE_CALLBACK) {\n                Log.emitter.emit('log', 'error', str);\n            }\n\n            if (!Log.ENABLE_ERROR) {\n                return;\n            }\n\n            if (console.error) {\n                console.error(str);\n            } else if (console.warn) {\n                console.warn(str);\n            } else {\n                console.log(str);\n            }\n        }\n    }, {\n        key: 'i',\n        value: function i(tag, msg) {\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\n\n            var str = '[' + tag + '] > ' + msg;\n\n            if (Log.ENABLE_CALLBACK) {\n                Log.emitter.emit('log', 'info', str);\n            }\n\n            if (!Log.ENABLE_INFO) {\n                return;\n            }\n\n            if (console.info) {\n                console.info(str);\n            } else {\n                console.log(str);\n            }\n        }\n    }, {\n        key: 'w',\n        value: function w(tag, msg) {\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\n\n            var str = '[' + tag + '] > ' + msg;\n\n            if (Log.ENABLE_CALLBACK) {\n                Log.emitter.emit('log', 'warn', str);\n            }\n\n            if (!Log.ENABLE_WARN) {\n                return;\n            }\n\n            if (console.warn) {\n                console.warn(str);\n            } else {\n                console.log(str);\n            }\n        }\n    }, {\n        key: 'd',\n        value: function d(tag, msg) {\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\n\n            var str = '[' + tag + '] > ' + msg;\n\n            if (Log.ENABLE_CALLBACK) {\n                Log.emitter.emit('log', 'debug', str);\n            }\n\n            if (!Log.ENABLE_DEBUG) {\n                return;\n            }\n\n            if (console.debug) {\n                console.debug(str);\n            } else {\n                console.log(str);\n            }\n        }\n    }, {\n        key: 'v',\n        value: function v(tag, msg) {\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\n\n            var str = '[' + tag + '] > ' + msg;\n\n            if (Log.ENABLE_CALLBACK) {\n                Log.emitter.emit('log', 'verbose', str);\n            }\n\n            if (!Log.ENABLE_VERBOSE) {\n                return;\n            }\n\n            console.log(str);\n        }\n    }]);\n\n    return Log;\n}();\n\nLog.GLOBAL_TAG = 'flv.js';\nLog.FORCE_GLOBAL_TAG = false;\nLog.ENABLE_ERROR = true;\nLog.ENABLE_INFO = true;\nLog.ENABLE_WARN = true;\nLog.ENABLE_DEBUG = true;\nLog.ENABLE_VERBOSE = true;\n\nLog.ENABLE_CALLBACK = false;\n\nLog.emitter = new _events2.default();\n\nexports.default = Log;\n\n},{\"events\":2}],42:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_('./logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar LoggingControl = function () {\n    function LoggingControl() {\n        _classCallCheck(this, LoggingControl);\n    }\n\n    _createClass(LoggingControl, null, [{\n        key: 'getConfig',\n        value: function getConfig() {\n            return {\n                globalTag: _logger2.default.GLOBAL_TAG,\n                forceGlobalTag: _logger2.default.FORCE_GLOBAL_TAG,\n                enableVerbose: _logger2.default.ENABLE_VERBOSE,\n                enableDebug: _logger2.default.ENABLE_DEBUG,\n                enableInfo: _logger2.default.ENABLE_INFO,\n                enableWarn: _logger2.default.ENABLE_WARN,\n                enableError: _logger2.default.ENABLE_ERROR,\n                enableCallback: _logger2.default.ENABLE_CALLBACK\n            };\n        }\n    }, {\n        key: 'applyConfig',\n        value: function applyConfig(config) {\n            _logger2.default.GLOBAL_TAG = config.globalTag;\n            _logger2.default.FORCE_GLOBAL_TAG = config.forceGlobalTag;\n            _logger2.default.ENABLE_VERBOSE = config.enableVerbose;\n            _logger2.default.ENABLE_DEBUG = config.enableDebug;\n            _logger2.default.ENABLE_INFO = config.enableInfo;\n            _logger2.default.ENABLE_WARN = config.enableWarn;\n            _logger2.default.ENABLE_ERROR = config.enableError;\n            _logger2.default.ENABLE_CALLBACK = config.enableCallback;\n        }\n    }, {\n        key: '_notifyChange',\n        value: function _notifyChange() {\n            var emitter = LoggingControl.emitter;\n\n            if (emitter.listenerCount('change') > 0) {\n                var config = LoggingControl.getConfig();\n                emitter.emit('change', config);\n            }\n        }\n    }, {\n        key: 'registerListener',\n        value: function registerListener(listener) {\n            LoggingControl.emitter.addListener('change', listener);\n        }\n    }, {\n        key: 'removeListener',\n        value: function removeListener(listener) {\n            LoggingControl.emitter.removeListener('change', listener);\n        }\n    }, {\n        key: 'addLogListener',\n        value: function addLogListener(listener) {\n            _logger2.default.emitter.addListener('log', listener);\n            if (_logger2.default.emitter.listenerCount('log') > 0) {\n                _logger2.default.ENABLE_CALLBACK = true;\n                LoggingControl._notifyChange();\n            }\n        }\n    }, {\n        key: 'removeLogListener',\n        value: function removeLogListener(listener) {\n            _logger2.default.emitter.removeListener('log', listener);\n            if (_logger2.default.emitter.listenerCount('log') === 0) {\n                _logger2.default.ENABLE_CALLBACK = false;\n                LoggingControl._notifyChange();\n            }\n        }\n    }, {\n        key: 'forceGlobalTag',\n        get: function get() {\n            return _logger2.default.FORCE_GLOBAL_TAG;\n        },\n        set: function set(enable) {\n            _logger2.default.FORCE_GLOBAL_TAG = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'globalTag',\n        get: function get() {\n            return _logger2.default.GLOBAL_TAG;\n        },\n        set: function set(tag) {\n            _logger2.default.GLOBAL_TAG = tag;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableAll',\n        get: function get() {\n            return _logger2.default.ENABLE_VERBOSE && _logger2.default.ENABLE_DEBUG && _logger2.default.ENABLE_INFO && _logger2.default.ENABLE_WARN && _logger2.default.ENABLE_ERROR;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_VERBOSE = enable;\n            _logger2.default.ENABLE_DEBUG = enable;\n            _logger2.default.ENABLE_INFO = enable;\n            _logger2.default.ENABLE_WARN = enable;\n            _logger2.default.ENABLE_ERROR = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableDebug',\n        get: function get() {\n            return _logger2.default.ENABLE_DEBUG;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_DEBUG = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableVerbose',\n        get: function get() {\n            return _logger2.default.ENABLE_VERBOSE;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_VERBOSE = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableInfo',\n        get: function get() {\n            return _logger2.default.ENABLE_INFO;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_INFO = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableWarn',\n        get: function get() {\n            return _logger2.default.ENABLE_WARN;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_WARN = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableError',\n        get: function get() {\n            return _logger2.default.ENABLE_ERROR;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_ERROR = enable;\n            LoggingControl._notifyChange();\n        }\n    }]);\n\n    return LoggingControl;\n}();\n\nLoggingControl.emitter = new _events2.default();\n\nexports.default = LoggingControl;\n\n},{\"./logger.js\":41,\"events\":2}],43:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar Polyfill = function () {\n    function Polyfill() {\n        _classCallCheck(this, Polyfill);\n    }\n\n    _createClass(Polyfill, null, [{\n        key: 'install',\n        value: function install() {\n            // ES6 Object.setPrototypeOf\n            Object.setPrototypeOf = Object.setPrototypeOf || function (obj, proto) {\n                obj.__proto__ = proto;\n                return obj;\n            };\n\n            // ES6 Object.assign\n            Object.assign = Object.assign || function (target) {\n                if (target === undefined || target === null) {\n                    throw new TypeError('Cannot convert undefined or null to object');\n                }\n\n                var output = Object(target);\n                for (var i = 1; i < arguments.length; i++) {\n                    var source = arguments[i];\n                    if (source !== undefined && source !== null) {\n                        for (var key in source) {\n                            if (source.hasOwnProperty(key)) {\n                                output[key] = source[key];\n                            }\n                        }\n                    }\n                }\n                return output;\n            };\n\n            // ES6 Promise (missing support in IE11)\n            if (typeof self.Promise !== 'function') {\n                _dereq_('es6-promise').polyfill();\n            }\n        }\n    }]);\n\n    return Polyfill;\n}();\n\nPolyfill.install();\n\nexports.default = Polyfill;\n\n},{\"es6-promise\":1}],44:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * This file is derived from C++ project libWinTF8 (https://github.com/m13253/libWinTF8)\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nfunction checkContinuation(uint8array, start, checkLength) {\n    var array = uint8array;\n    if (start + checkLength < array.length) {\n        while (checkLength--) {\n            if ((array[++start] & 0xC0) !== 0x80) return false;\n        }\n        return true;\n    } else {\n        return false;\n    }\n}\n\nfunction decodeUTF8(uint8array) {\n    var out = [];\n    var input = uint8array;\n    var i = 0;\n    var length = uint8array.length;\n\n    while (i < length) {\n        if (input[i] < 0x80) {\n            out.push(String.fromCharCode(input[i]));\n            ++i;\n            continue;\n        } else if (input[i] < 0xC0) {\n            // fallthrough\n        } else if (input[i] < 0xE0) {\n            if (checkContinuation(input, i, 1)) {\n                var ucs4 = (input[i] & 0x1F) << 6 | input[i + 1] & 0x3F;\n                if (ucs4 >= 0x80) {\n                    out.push(String.fromCharCode(ucs4 & 0xFFFF));\n                    i += 2;\n                    continue;\n                }\n            }\n        } else if (input[i] < 0xF0) {\n            if (checkContinuation(input, i, 2)) {\n                var _ucs = (input[i] & 0xF) << 12 | (input[i + 1] & 0x3F) << 6 | input[i + 2] & 0x3F;\n                if (_ucs >= 0x800 && (_ucs & 0xF800) !== 0xD800) {\n                    out.push(String.fromCharCode(_ucs & 0xFFFF));\n                    i += 3;\n                    continue;\n                }\n            }\n        } else if (input[i] < 0xF8) {\n            if (checkContinuation(input, i, 3)) {\n                var _ucs2 = (input[i] & 0x7) << 18 | (input[i + 1] & 0x3F) << 12 | (input[i + 2] & 0x3F) << 6 | input[i + 3] & 0x3F;\n                if (_ucs2 > 0x10000 && _ucs2 < 0x110000) {\n                    _ucs2 -= 0x10000;\n                    out.push(String.fromCharCode(_ucs2 >>> 10 | 0xD800));\n                    out.push(String.fromCharCode(_ucs2 & 0x3FF | 0xDC00));\n                    i += 4;\n                    continue;\n                }\n            }\n        }\n        out.push(String.fromCharCode(0xFFFD));\n        ++i;\n    }\n\n    return out.join('');\n}\n\nexports.default = decodeUTF8;\n\n},{}]},{},[21])(21)\n});\n\n//# sourceMappingURL=flv.js.map\n","/*\nmp3编码器用到的lamejs编码引擎，一般都用MP3格式，浏览器支持广泛，此引擎测试的也比较多，稳定\nhttps://github.com/xiangyuecn/Recorder\n*/\n(function(){\n\"use strict\";\n\n//end2 ****开始copy lamejs*****\n/*\nmp3编码依赖lamejs，如果无需mp3支持直接移除此代码\nhttps://github.com/zhuker/lamejs/blob/bfb7f6c6d7877e0fe1ad9e72697a871676119a0e/lame.all.js\n*/\n\nfunction lamejs() {\nvar Math_log10=function(s){//坚决不能用也不要报语言问题的错误\n\treturn Math.log(s)/Math.log(10);\n};\n\nfunction new_byte(count) {\n    return new Int8Array(count);\n}\n\nfunction new_short(count) {\n    return new Int16Array(count);\n}\n\nfunction new_int(count) {\n    return new Int32Array(count);\n}\n\nfunction new_float(count) {\n    return new Float32Array(count);\n}\n\nfunction new_double(count) {\n    return new Float64Array(count);\n}\n\nfunction new_float_n(args) {\n    if (args.length == 1) {\n        return new_float(args[0]);\n    }\n    var sz = args[0];\n    args = args.slice(1);\n    var A = [];\n    for (var i = 0; i < sz; i++) {\n        A.push(new_float_n(args));\n    }\n    return A;\n}\nfunction new_int_n(args) {\n    if (args.length == 1) {\n        return new_int(args[0]);\n    }\n    var sz = args[0];\n    args = args.slice(1);\n    var A = [];\n    for (var i = 0; i < sz; i++) {\n        A.push(new_int_n(args));\n    }\n    return A;\n}\n\nfunction new_short_n(args) {\n    if (args.length == 1) {\n        return new_short(args[0]);\n    }\n    var sz = args[0];\n    args = args.slice(1);\n    var A = [];\n    for (var i = 0; i < sz; i++) {\n        A.push(new_short_n(args));\n    }\n    return A;\n}\n\nfunction new_array_n(args) {\n    if (args.length == 1) {\n        return new Array(args[0]);\n    }\n    var sz = args[0];\n    args = args.slice(1);\n    var A = [];\n    for (var i = 0; i < sz; i++) {\n        A.push(new_array_n(args));\n    }\n    return A;\n}\n\n\nvar Arrays = {};\n\nArrays.fill = function (a, fromIndex, toIndex, val) {\n    if (arguments.length == 2) {\n        for (var i = 0; i < a.length; i++) {\n            a[i] = arguments[1];\n        }\n    } else {\n        for (var i = fromIndex; i < toIndex; i++) {\n            a[i] = val;\n        }\n    }\n};\n\nvar System = {};\n\nSystem.arraycopy = function (src, srcPos, dest, destPos, length) {\n    var srcEnd = srcPos + length;\n    while (srcPos < srcEnd)\n        dest[destPos++] = src[srcPos++];\n};\n\n\nvar Util = {};\nUtil.SQRT2 = 1.41421356237309504880;\nUtil.FAST_LOG10 = function (x) {\n    return Math_log10(x);\n};\n\nUtil.FAST_LOG10_X = function (x, y) {\n    return Math_log10(x) * y;\n};\n\nfunction ShortBlock(ordinal) {\n    this.ordinal = ordinal;\n}\n/**\n * LAME may use them, even different block types for L/R.\n */\nShortBlock.short_block_allowed = new ShortBlock(0);\n/**\n * LAME may use them, but always same block types in L/R.\n */\nShortBlock.short_block_coupled = new ShortBlock(1);\n/**\n * LAME will not use short blocks, long blocks only.\n */\nShortBlock.short_block_dispensed = new ShortBlock(2);\n/**\n * LAME will not use long blocks, short blocks only.\n */\nShortBlock.short_block_forced = new ShortBlock(3);\n\nvar Float = {};\nFloat.MAX_VALUE = 3.4028235e+38;\n\nfunction VbrMode(ordinal) {\n    this.ordinal = ordinal;\n}\nVbrMode.vbr_off = new VbrMode(0);\nVbrMode.vbr_mt = new VbrMode(1);\nVbrMode.vbr_rh = new VbrMode(2);\nVbrMode.vbr_abr = new VbrMode(3);\nVbrMode.vbr_mtrh = new VbrMode(4);\nVbrMode.vbr_default = VbrMode.vbr_mtrh;\n\nvar assert = function (x) {\n    //console.assert(x);\n};\n\nvar module_exports = {\n    \"System\": System,\n    \"VbrMode\": VbrMode,\n    \"Float\": Float,\n    \"ShortBlock\": ShortBlock,\n    \"Util\": Util,\n    \"Arrays\": Arrays,\n    \"new_array_n\": new_array_n,\n    \"new_byte\": new_byte,\n    \"new_double\": new_double,\n    \"new_float\": new_float,\n    \"new_float_n\": new_float_n,\n    \"new_int\": new_int,\n    \"new_int_n\": new_int_n,\n    \"new_short\": new_short,\n    \"new_short_n\": new_short_n,\n    \"assert\": assert\n};\n//package mp3;\n\n/* MPEG modes */\nfunction MPEGMode(ordinal) {\n    var _ordinal = ordinal;\n    this.ordinal = function () {\n        return _ordinal;\n    }\n}\n\nMPEGMode.STEREO = new MPEGMode(0);\nMPEGMode.JOINT_STEREO = new MPEGMode(1);\nMPEGMode.DUAL_CHANNEL = new MPEGMode(2);\nMPEGMode.MONO = new MPEGMode(3);\nMPEGMode.NOT_SET = new MPEGMode(4);\n\nfunction Version() {\n\n    /**\n     * URL for the LAME website.\n     */\n    var LAME_URL = \"http://www.mp3dev.org/\";\n\n    /**\n     * Major version number.\n     */\n    var LAME_MAJOR_VERSION = 3;\n    /**\n     * Minor version number.\n     */\n    var LAME_MINOR_VERSION = 98;\n    /**\n     * Patch level.\n     */\n    var LAME_PATCH_VERSION = 4;\n\n    /**\n     * Major version number.\n     */\n    var PSY_MAJOR_VERSION = 0;\n    /**\n     * Minor version number.\n     */\n    var PSY_MINOR_VERSION = 93;\n\n    /**\n     * A string which describes the version of LAME.\n     *\n     * @return string which describes the version of LAME\n     */\n    this.getLameVersion = function () {\n        // primary to write screen reports\n        return (LAME_MAJOR_VERSION + \".\" + LAME_MINOR_VERSION + \".\" + LAME_PATCH_VERSION);\n    }\n\n    /**\n     * The short version of the LAME version string.\n     *\n     * @return short version of the LAME version string\n     */\n    this.getLameShortVersion = function () {\n        // Adding date and time to version string makes it harder for output\n        // validation\n        return (LAME_MAJOR_VERSION + \".\" + LAME_MINOR_VERSION + \".\" + LAME_PATCH_VERSION);\n    }\n\n    /**\n     * The shortest version of the LAME version string.\n     *\n     * @return shortest version of the LAME version string\n     */\n    this.getLameVeryShortVersion = function () {\n        // Adding date and time to version string makes it harder for output\n        return (\"LAME\" + LAME_MAJOR_VERSION + \".\" + LAME_MINOR_VERSION + \"r\");\n    }\n\n    /**\n     * String which describes the version of GPSYCHO\n     *\n     * @return string which describes the version of GPSYCHO\n     */\n    this.getPsyVersion = function () {\n        return (PSY_MAJOR_VERSION + \".\" + PSY_MINOR_VERSION);\n    }\n\n    /**\n     * String which is a URL for the LAME website.\n     *\n     * @return string which is a URL for the LAME website\n     */\n    this.getLameUrl = function () {\n        return LAME_URL;\n    }\n\n    /**\n     * Quite useless for a java version, however we are compatible ;-)\n     *\n     * @return \"32bits\"\n     */\n    this.getLameOsBitness = function () {\n        return \"32bits\";\n    }\n\n}\n\n/*\n *\tMP3 huffman table selecting and bit counting\n *\n *\tCopyright (c) 1999-2005 Takehiro TOMINAGA\n *\tCopyright (c) 2002-2005 Gabriel Bouvigne\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\t See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n\n/* $Id: Takehiro.java,v 1.26 2011/05/24 20:48:06 kenchis Exp $ */\n\n//package mp3;\n\n//import java.util.Arrays;\n\n\n\nfunction Takehiro() {\n\n    var qupvt = null;\n    this.qupvt = null;\n\n    this.setModules = function (_qupvt) {\n        this.qupvt = _qupvt;\n        qupvt = _qupvt;\n    }\n\n    function Bits(b) {\n        this.bits = 0 | b;\n    }\n\n    var subdv_table = [[0, 0], /* 0 bands */\n        [0, 0], /* 1 bands */\n        [0, 0], /* 2 bands */\n        [0, 0], /* 3 bands */\n        [0, 0], /* 4 bands */\n        [0, 1], /* 5 bands */\n        [1, 1], /* 6 bands */\n        [1, 1], /* 7 bands */\n        [1, 2], /* 8 bands */\n        [2, 2], /* 9 bands */\n        [2, 3], /* 10 bands */\n        [2, 3], /* 11 bands */\n        [3, 4], /* 12 bands */\n        [3, 4], /* 13 bands */\n        [3, 4], /* 14 bands */\n        [4, 5], /* 15 bands */\n        [4, 5], /* 16 bands */\n        [4, 6], /* 17 bands */\n        [5, 6], /* 18 bands */\n        [5, 6], /* 19 bands */\n        [5, 7], /* 20 bands */\n        [6, 7], /* 21 bands */\n        [6, 7], /* 22 bands */\n    ];\n\n\n    /**\n     * nonlinear quantization of xr More accurate formula than the ISO formula.\n     * Takes into account the fact that we are quantizing xr . ix, but we want\n     * ix^4/3 to be as close as possible to x^4/3. (taking the nearest int would\n     * mean ix is as close as possible to xr, which is different.)\n     *\n     * From Segher Boessenkool <segher@eastsite.nl> 11/1999\n     *\n     * 09/2000: ASM code removed in favor of IEEE754 hack by Takehiro Tominaga.\n     * If you need the ASM code, check CVS circa Aug 2000.\n     *\n     * 01/2004: Optimizations by Gabriel Bouvigne\n     */\n    function quantize_lines_xrpow_01(l, istep, xr, xrPos, ix, ixPos) {\n        var compareval0 = (1.0 - 0.4054) / istep;\n\n        l = l >> 1;\n        while ((l--) != 0) {\n            ix[ixPos++] = (compareval0 > xr[xrPos++]) ? 0 : 1;\n            ix[ixPos++] = (compareval0 > xr[xrPos++]) ? 0 : 1;\n        }\n    }\n\n    /**\n     * XRPOW_FTOI is a macro to convert floats to ints.<BR>\n     * if XRPOW_FTOI(x) = nearest_int(x), then QUANTFAC(x)=adj43asm[x]<BR>\n     * ROUNDFAC= -0.0946<BR>\n     *\n     * if XRPOW_FTOI(x) = floor(x), then QUANTFAC(x)=asj43[x]<BR>\n     * ROUNDFAC=0.4054<BR>\n     *\n     * Note: using floor() or 0| is extremely slow. On machines where the\n     * TAKEHIRO_IEEE754_HACK code above does not work, it is worthwile to write\n     * some ASM for XRPOW_FTOI().\n     */\n    function quantize_lines_xrpow(l, istep, xr, xrPos, ix, ixPos) {\n\n        l = l >> 1;\n        var remaining = l % 2;\n        l = l >> 1;\n        while (l-- != 0) {\n            var x0, x1, x2, x3;\n            var rx0, rx1, rx2, rx3;\n\n            x0 = xr[xrPos++] * istep;\n            x1 = xr[xrPos++] * istep;\n            rx0 = 0 | x0;\n            x2 = xr[xrPos++] * istep;\n            rx1 = 0 | x1;\n            x3 = xr[xrPos++] * istep;\n            rx2 = 0 | x2;\n            x0 += qupvt.adj43[rx0];\n            rx3 = 0 | x3;\n            x1 += qupvt.adj43[rx1];\n            ix[ixPos++] = 0 | x0;\n            x2 += qupvt.adj43[rx2];\n            ix[ixPos++] = 0 | x1;\n            x3 += qupvt.adj43[rx3];\n            ix[ixPos++] = 0 | x2;\n            ix[ixPos++] = 0 | x3;\n        }\n        if (remaining != 0) {\n            var x0, x1;\n            var rx0, rx1;\n\n            x0 = xr[xrPos++] * istep;\n            x1 = xr[xrPos++] * istep;\n            rx0 = 0 | x0;\n            rx1 = 0 | x1;\n            x0 += qupvt.adj43[rx0];\n            x1 += qupvt.adj43[rx1];\n            ix[ixPos++] = 0 | x0;\n            ix[ixPos++] = 0 | x1;\n        }\n    }\n\n    /**\n     * Quantization function This function will select which lines to quantize\n     * and call the proper quantization function\n     */\n    function quantize_xrpow(xp, pi, istep, codInfo, prevNoise) {\n        /* quantize on xr^(3/4) instead of xr */\n        var sfb;\n        var sfbmax;\n        var j = 0;\n        var prev_data_use;\n        var accumulate = 0;\n        var accumulate01 = 0;\n        var xpPos = 0;\n        var iData = pi;\n        var iDataPos = 0;\n        var acc_iData = iData;\n        var acc_iDataPos = 0;\n        var acc_xp = xp;\n        var acc_xpPos = 0;\n\n        /*\n         * Reusing previously computed data does not seems to work if global\n         * gain is changed. Finding why it behaves this way would allow to use a\n         * cache of previously computed values (let's 10 cached values per sfb)\n         * that would probably provide a noticeable speedup\n         */\n        prev_data_use = (prevNoise != null && (codInfo.global_gain == prevNoise.global_gain));\n\n        if (codInfo.block_type == Encoder.SHORT_TYPE)\n            sfbmax = 38;\n        else\n            sfbmax = 21;\n\n        for (sfb = 0; sfb <= sfbmax; sfb++) {\n            var step = -1;\n\n            if (prev_data_use || codInfo.block_type == Encoder.NORM_TYPE) {\n                step = codInfo.global_gain\n                    - ((codInfo.scalefac[sfb] + (codInfo.preflag != 0 ? qupvt.pretab[sfb]\n                        : 0)) << (codInfo.scalefac_scale + 1))\n                    - codInfo.subblock_gain[codInfo.window[sfb]] * 8;\n            }\n            if (prev_data_use && (prevNoise.step[sfb] == step)) {\n                /*\n                 * do not recompute this part, but compute accumulated lines\n                 */\n                if (accumulate != 0) {\n                    quantize_lines_xrpow(accumulate, istep, acc_xp, acc_xpPos,\n                        acc_iData, acc_iDataPos);\n                    accumulate = 0;\n                }\n                if (accumulate01 != 0) {\n                    quantize_lines_xrpow_01(accumulate01, istep, acc_xp,\n                        acc_xpPos, acc_iData, acc_iDataPos);\n                    accumulate01 = 0;\n                }\n            } else { /* should compute this part */\n                var l = codInfo.width[sfb];\n\n                if ((j + codInfo.width[sfb]) > codInfo.max_nonzero_coeff) {\n                    /* do not compute upper zero part */\n                    var usefullsize;\n                    usefullsize = codInfo.max_nonzero_coeff - j + 1;\n                    Arrays.fill(pi, codInfo.max_nonzero_coeff, 576, 0);\n                    l = usefullsize;\n\n                    if (l < 0) {\n                        l = 0;\n                    }\n\n                    /* no need to compute higher sfb values */\n                    sfb = sfbmax + 1;\n                }\n\n                /* accumulate lines to quantize */\n                if (0 == accumulate && 0 == accumulate01) {\n                    acc_iData = iData;\n                    acc_iDataPos = iDataPos;\n                    acc_xp = xp;\n                    acc_xpPos = xpPos;\n                }\n                if (prevNoise != null && prevNoise.sfb_count1 > 0\n                    && sfb >= prevNoise.sfb_count1\n                    && prevNoise.step[sfb] > 0\n                    && step >= prevNoise.step[sfb]) {\n\n                    if (accumulate != 0) {\n                        quantize_lines_xrpow(accumulate, istep, acc_xp,\n                            acc_xpPos, acc_iData, acc_iDataPos);\n                        accumulate = 0;\n                        acc_iData = iData;\n                        acc_iDataPos = iDataPos;\n                        acc_xp = xp;\n                        acc_xpPos = xpPos;\n                    }\n                    accumulate01 += l;\n                } else {\n                    if (accumulate01 != 0) {\n                        quantize_lines_xrpow_01(accumulate01, istep, acc_xp,\n                            acc_xpPos, acc_iData, acc_iDataPos);\n                        accumulate01 = 0;\n                        acc_iData = iData;\n                        acc_iDataPos = iDataPos;\n                        acc_xp = xp;\n                        acc_xpPos = xpPos;\n                    }\n                    accumulate += l;\n                }\n\n                if (l <= 0) {\n                    /*\n                     * rh: 20040215 may happen due to \"prev_data_use\"\n                     * optimization\n                     */\n                    if (accumulate01 != 0) {\n                        quantize_lines_xrpow_01(accumulate01, istep, acc_xp,\n                            acc_xpPos, acc_iData, acc_iDataPos);\n                        accumulate01 = 0;\n                    }\n                    if (accumulate != 0) {\n                        quantize_lines_xrpow(accumulate, istep, acc_xp,\n                            acc_xpPos, acc_iData, acc_iDataPos);\n                        accumulate = 0;\n                    }\n\n                    break;\n                    /* ends for-loop */\n                }\n            }\n            if (sfb <= sfbmax) {\n                iDataPos += codInfo.width[sfb];\n                xpPos += codInfo.width[sfb];\n                j += codInfo.width[sfb];\n            }\n        }\n        if (accumulate != 0) { /* last data part */\n            quantize_lines_xrpow(accumulate, istep, acc_xp, acc_xpPos,\n                acc_iData, acc_iDataPos);\n            accumulate = 0;\n        }\n        if (accumulate01 != 0) { /* last data part */\n            quantize_lines_xrpow_01(accumulate01, istep, acc_xp, acc_xpPos,\n                acc_iData, acc_iDataPos);\n            accumulate01 = 0;\n        }\n\n    }\n\n    /**\n     * ix_max\n     */\n    function ix_max(ix, ixPos, endPos) {\n        var max1 = 0, max2 = 0;\n\n        do {\n            var x1 = ix[ixPos++];\n            var x2 = ix[ixPos++];\n            if (max1 < x1)\n                max1 = x1;\n\n            if (max2 < x2)\n                max2 = x2;\n        } while (ixPos < endPos);\n        if (max1 < max2)\n            max1 = max2;\n        return max1;\n    }\n\n    function count_bit_ESC(ix, ixPos, end, t1, t2, s) {\n        /* ESC-table is used */\n        var linbits = Tables.ht[t1].xlen * 65536 + Tables.ht[t2].xlen;\n        var sum = 0, sum2;\n\n        do {\n            var x = ix[ixPos++];\n            var y = ix[ixPos++];\n\n            if (x != 0) {\n                if (x > 14) {\n                    x = 15;\n                    sum += linbits;\n                }\n                x *= 16;\n            }\n\n            if (y != 0) {\n                if (y > 14) {\n                    y = 15;\n                    sum += linbits;\n                }\n                x += y;\n            }\n\n            sum += Tables.largetbl[x];\n        } while (ixPos < end);\n\n        sum2 = sum & 0xffff;\n        sum >>= 16;\n\n        if (sum > sum2) {\n            sum = sum2;\n            t1 = t2;\n        }\n\n        s.bits += sum;\n        return t1;\n    }\n\n    function count_bit_noESC(ix, ixPos, end, s) {\n        /* No ESC-words */\n        var sum1 = 0;\n        var hlen1 = Tables.ht[1].hlen;\n\n        do {\n            var x = ix[ixPos + 0] * 2 + ix[ixPos + 1];\n            ixPos += 2;\n            sum1 += hlen1[x];\n        } while (ixPos < end);\n\n        s.bits += sum1;\n        return 1;\n    }\n\n    function count_bit_noESC_from2(ix, ixPos, end, t1, s) {\n        /* No ESC-words */\n        var sum = 0, sum2;\n        var xlen = Tables.ht[t1].xlen;\n        var hlen;\n        if (t1 == 2)\n            hlen = Tables.table23;\n        else\n            hlen = Tables.table56;\n\n        do {\n            var x = ix[ixPos + 0] * xlen + ix[ixPos + 1];\n            ixPos += 2;\n            sum += hlen[x];\n        } while (ixPos < end);\n\n        sum2 = sum & 0xffff;\n        sum >>= 16;\n\n        if (sum > sum2) {\n            sum = sum2;\n            t1++;\n        }\n\n        s.bits += sum;\n        return t1;\n    }\n\n    function count_bit_noESC_from3(ix, ixPos, end, t1, s) {\n        /* No ESC-words */\n        var sum1 = 0;\n        var sum2 = 0;\n        var sum3 = 0;\n        var xlen = Tables.ht[t1].xlen;\n        var hlen1 = Tables.ht[t1].hlen;\n        var hlen2 = Tables.ht[t1 + 1].hlen;\n        var hlen3 = Tables.ht[t1 + 2].hlen;\n\n        do {\n            var x = ix[ixPos + 0] * xlen + ix[ixPos + 1];\n            ixPos += 2;\n            sum1 += hlen1[x];\n            sum2 += hlen2[x];\n            sum3 += hlen3[x];\n        } while (ixPos < end);\n        var t = t1;\n        if (sum1 > sum2) {\n            sum1 = sum2;\n            t++;\n        }\n        if (sum1 > sum3) {\n            sum1 = sum3;\n            t = t1 + 2;\n        }\n        s.bits += sum1;\n\n        return t;\n    }\n\n    /*************************************************************************/\n    /* choose table */\n    /*************************************************************************/\n\n    var huf_tbl_noESC = [1, 2, 5, 7, 7, 10, 10, 13, 13,\n        13, 13, 13, 13, 13, 13];\n\n    /**\n     * Choose the Huffman table that will encode ix[begin..end] with the fewest\n     * bits.\n     *\n     * Note: This code contains knowledge about the sizes and characteristics of\n     * the Huffman tables as defined in the IS (Table B.7), and will not work\n     * with any arbitrary tables.\n     */\n    function choose_table(ix, ixPos, endPos, s) {\n        var max = ix_max(ix, ixPos, endPos);\n\n        switch (max) {\n            case 0:\n                return max;\n\n            case 1:\n                return count_bit_noESC(ix, ixPos, endPos, s);\n\n            case 2:\n            case 3:\n                return count_bit_noESC_from2(ix, ixPos, endPos,\n                    huf_tbl_noESC[max - 1], s);\n\n            case 4:\n            case 5:\n            case 6:\n            case 7:\n            case 8:\n            case 9:\n            case 10:\n            case 11:\n            case 12:\n            case 13:\n            case 14:\n            case 15:\n                return count_bit_noESC_from3(ix, ixPos, endPos,\n                    huf_tbl_noESC[max - 1], s);\n\n            default:\n                /* try tables with linbits */\n                if (max > QuantizePVT.IXMAX_VAL) {\n                    s.bits = QuantizePVT.LARGE_BITS;\n                    return -1;\n                }\n                max -= 15;\n                var choice2;\n                for (choice2 = 24; choice2 < 32; choice2++) {\n                    if (Tables.ht[choice2].linmax >= max) {\n                        break;\n                    }\n                }\n                var choice;\n                for (choice = choice2 - 8; choice < 24; choice++) {\n                    if (Tables.ht[choice].linmax >= max) {\n                        break;\n                    }\n                }\n                return count_bit_ESC(ix, ixPos, endPos, choice, choice2, s);\n        }\n    }\n\n    /**\n     * count_bit\n     */\n    this.noquant_count_bits = function (gfc, gi, prev_noise) {\n        var ix = gi.l3_enc;\n        var i = Math.min(576, ((gi.max_nonzero_coeff + 2) >> 1) << 1);\n\n        if (prev_noise != null)\n            prev_noise.sfb_count1 = 0;\n\n        /* Determine count1 region */\n        for (; i > 1; i -= 2)\n            if ((ix[i - 1] | ix[i - 2]) != 0)\n                break;\n        gi.count1 = i;\n\n        /* Determines the number of bits to encode the quadruples. */\n        var a1 = 0;\n        var a2 = 0;\n        for (; i > 3; i -= 4) {\n            var p;\n            /* hack to check if all values <= 1 */\n            //throw \"TODO: HACK         if ((((long) ix[i - 1] | (long) ix[i - 2] | (long) ix[i - 3] | (long) ix[i - 4]) & 0xffffffffL) > 1L        \"\n            //if (true) {\n            if (((ix[i - 1] | ix[i - 2] | ix[i - 3] | ix[i - 4]) & 0x7fffffff) > 1) {\n                break;\n            }\n            p = ((ix[i - 4] * 2 + ix[i - 3]) * 2 + ix[i - 2]) * 2 + ix[i - 1];\n            a1 += Tables.t32l[p];\n            a2 += Tables.t33l[p];\n        }\n        var bits = a1;\n        gi.count1table_select = 0;\n        if (a1 > a2) {\n            bits = a2;\n            gi.count1table_select = 1;\n        }\n\n        gi.count1bits = bits;\n        gi.big_values = i;\n        if (i == 0)\n            return bits;\n\n        if (gi.block_type == Encoder.SHORT_TYPE) {\n            a1 = 3 * gfc.scalefac_band.s[3];\n            if (a1 > gi.big_values)\n                a1 = gi.big_values;\n            a2 = gi.big_values;\n\n        } else if (gi.block_type == Encoder.NORM_TYPE) {\n            /* bv_scf has 576 entries (0..575) */\n            a1 = gi.region0_count = gfc.bv_scf[i - 2];\n            a2 = gi.region1_count = gfc.bv_scf[i - 1];\n\n            a2 = gfc.scalefac_band.l[a1 + a2 + 2];\n            a1 = gfc.scalefac_band.l[a1 + 1];\n            if (a2 < i) {\n                var bi = new Bits(bits);\n                gi.table_select[2] = choose_table(ix, a2, i, bi);\n                bits = bi.bits;\n            }\n        } else {\n            gi.region0_count = 7;\n            /* gi.region1_count = SBPSY_l - 7 - 1; */\n            gi.region1_count = Encoder.SBMAX_l - 1 - 7 - 1;\n            a1 = gfc.scalefac_band.l[7 + 1];\n            a2 = i;\n            if (a1 > a2) {\n                a1 = a2;\n            }\n        }\n\n        /* have to allow for the case when bigvalues < region0 < region1 */\n        /* (and region0, region1 are ignored) */\n        a1 = Math.min(a1, i);\n        a2 = Math.min(a2, i);\n\n\n        /* Count the number of bits necessary to code the bigvalues region. */\n        if (0 < a1) {\n            var bi = new Bits(bits);\n            gi.table_select[0] = choose_table(ix, 0, a1, bi);\n            bits = bi.bits;\n        }\n        if (a1 < a2) {\n            var bi = new Bits(bits);\n            gi.table_select[1] = choose_table(ix, a1, a2, bi);\n            bits = bi.bits;\n        }\n        if (gfc.use_best_huffman == 2) {\n            gi.part2_3_length = bits;\n            best_huffman_divide(gfc, gi);\n            bits = gi.part2_3_length;\n        }\n\n        if (prev_noise != null) {\n            if (gi.block_type == Encoder.NORM_TYPE) {\n                var sfb = 0;\n                while (gfc.scalefac_band.l[sfb] < gi.big_values) {\n                    sfb++;\n                }\n                prev_noise.sfb_count1 = sfb;\n            }\n        }\n\n        return bits;\n    }\n\n    this.count_bits = function (gfc, xr, gi, prev_noise) {\n        var ix = gi.l3_enc;\n\n        /* since quantize_xrpow uses table lookup, we need to check this first: */\n        var w = (QuantizePVT.IXMAX_VAL) / qupvt.IPOW20(gi.global_gain);\n\n        if (gi.xrpow_max > w)\n            return QuantizePVT.LARGE_BITS;\n\n        quantize_xrpow(xr, ix, qupvt.IPOW20(gi.global_gain), gi, prev_noise);\n\n        if ((gfc.substep_shaping & 2) != 0) {\n            var j = 0;\n            /* 0.634521682242439 = 0.5946*2**(.5*0.1875) */\n            var gain = gi.global_gain + gi.scalefac_scale;\n            var roundfac = 0.634521682242439 / qupvt.IPOW20(gain);\n            for (var sfb = 0; sfb < gi.sfbmax; sfb++) {\n                var width = gi.width[sfb];\n                if (0 == gfc.pseudohalf[sfb]) {\n                    j += width;\n                } else {\n                    var k;\n                    for (k = j, j += width; k < j; ++k) {\n                        ix[k] = (xr[k] >= roundfac) ? ix[k] : 0;\n                    }\n                }\n            }\n        }\n        return this.noquant_count_bits(gfc, gi, prev_noise);\n    }\n\n    /**\n     * re-calculate the best scalefac_compress using scfsi the saved bits are\n     * kept in the bit reservoir.\n     */\n    function recalc_divide_init(gfc, cod_info, ix, r01_bits, r01_div, r0_tbl, r1_tbl) {\n        var bigv = cod_info.big_values;\n\n        for (var r0 = 0; r0 <= 7 + 15; r0++) {\n            r01_bits[r0] = QuantizePVT.LARGE_BITS;\n        }\n\n        for (var r0 = 0; r0 < 16; r0++) {\n            var a1 = gfc.scalefac_band.l[r0 + 1];\n            if (a1 >= bigv)\n                break;\n            var r0bits = 0;\n            var bi = new Bits(r0bits);\n            var r0t = choose_table(ix, 0, a1, bi);\n            r0bits = bi.bits;\n\n            for (var r1 = 0; r1 < 8; r1++) {\n                var a2 = gfc.scalefac_band.l[r0 + r1 + 2];\n                if (a2 >= bigv)\n                    break;\n                var bits = r0bits;\n                bi = new Bits(bits);\n                var r1t = choose_table(ix, a1, a2, bi);\n                bits = bi.bits;\n                if (r01_bits[r0 + r1] > bits) {\n                    r01_bits[r0 + r1] = bits;\n                    r01_div[r0 + r1] = r0;\n                    r0_tbl[r0 + r1] = r0t;\n                    r1_tbl[r0 + r1] = r1t;\n                }\n            }\n        }\n    }\n\n    function recalc_divide_sub(gfc, cod_info2, gi, ix, r01_bits, r01_div, r0_tbl, r1_tbl) {\n        var bigv = cod_info2.big_values;\n\n        for (var r2 = 2; r2 < Encoder.SBMAX_l + 1; r2++) {\n            var a2 = gfc.scalefac_band.l[r2];\n            if (a2 >= bigv)\n                break;\n            var bits = r01_bits[r2 - 2] + cod_info2.count1bits;\n            if (gi.part2_3_length <= bits)\n                break;\n\n            var bi = new Bits(bits);\n            var r2t = choose_table(ix, a2, bigv, bi);\n            bits = bi.bits;\n            if (gi.part2_3_length <= bits)\n                continue;\n\n            gi.assign(cod_info2);\n            gi.part2_3_length = bits;\n            gi.region0_count = r01_div[r2 - 2];\n            gi.region1_count = r2 - 2 - r01_div[r2 - 2];\n            gi.table_select[0] = r0_tbl[r2 - 2];\n            gi.table_select[1] = r1_tbl[r2 - 2];\n            gi.table_select[2] = r2t;\n        }\n    }\n\n    this.best_huffman_divide = function (gfc, gi) {\n        var cod_info2 = new GrInfo();\n        var ix = gi.l3_enc;\n        var r01_bits = new_int(7 + 15 + 1);\n        var r01_div = new_int(7 + 15 + 1);\n        var r0_tbl = new_int(7 + 15 + 1);\n        var r1_tbl = new_int(7 + 15 + 1);\n\n        /* SHORT BLOCK stuff fails for MPEG2 */\n        if (gi.block_type == Encoder.SHORT_TYPE && gfc.mode_gr == 1)\n            return;\n\n        cod_info2.assign(gi);\n        if (gi.block_type == Encoder.NORM_TYPE) {\n            recalc_divide_init(gfc, gi, ix, r01_bits, r01_div, r0_tbl, r1_tbl);\n            recalc_divide_sub(gfc, cod_info2, gi, ix, r01_bits, r01_div,\n                r0_tbl, r1_tbl);\n        }\n        var i = cod_info2.big_values;\n        if (i == 0 || (ix[i - 2] | ix[i - 1]) > 1)\n            return;\n\n        i = gi.count1 + 2;\n        if (i > 576)\n            return;\n\n        /* Determines the number of bits to encode the quadruples. */\n        cod_info2.assign(gi);\n        cod_info2.count1 = i;\n        var a1 = 0;\n        var a2 = 0;\n\n\n        for (; i > cod_info2.big_values; i -= 4) {\n            var p = ((ix[i - 4] * 2 + ix[i - 3]) * 2 + ix[i - 2]) * 2\n                + ix[i - 1];\n            a1 += Tables.t32l[p];\n            a2 += Tables.t33l[p];\n        }\n        cod_info2.big_values = i;\n\n        cod_info2.count1table_select = 0;\n        if (a1 > a2) {\n            a1 = a2;\n            cod_info2.count1table_select = 1;\n        }\n\n        cod_info2.count1bits = a1;\n\n        if (cod_info2.block_type == Encoder.NORM_TYPE)\n            recalc_divide_sub(gfc, cod_info2, gi, ix, r01_bits, r01_div,\n                r0_tbl, r1_tbl);\n        else {\n            /* Count the number of bits necessary to code the bigvalues region. */\n            cod_info2.part2_3_length = a1;\n            a1 = gfc.scalefac_band.l[7 + 1];\n            if (a1 > i) {\n                a1 = i;\n            }\n            if (a1 > 0) {\n                var bi = new Bits(cod_info2.part2_3_length);\n                cod_info2.table_select[0] = choose_table(ix, 0, a1, bi);\n                cod_info2.part2_3_length = bi.bits;\n            }\n            if (i > a1) {\n                var bi = new Bits(cod_info2.part2_3_length);\n                cod_info2.table_select[1] = choose_table(ix, a1, i, bi);\n                cod_info2.part2_3_length = bi.bits;\n            }\n            if (gi.part2_3_length > cod_info2.part2_3_length)\n                gi.assign(cod_info2);\n        }\n    }\n\n    var slen1_n = [1, 1, 1, 1, 8, 2, 2, 2, 4, 4, 4, 8, 8, 8, 16, 16];\n    var slen2_n = [1, 2, 4, 8, 1, 2, 4, 8, 2, 4, 8, 2, 4, 8, 4, 8];\n    var slen1_tab = [0, 0, 0, 0, 3, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4];\n    var slen2_tab = [0, 1, 2, 3, 0, 1, 2, 3, 1, 2, 3, 1, 2, 3, 2, 3];\n    Takehiro.slen1_tab = slen1_tab;\n    Takehiro.slen2_tab = slen2_tab;\n\n    function scfsi_calc(ch, l3_side) {\n        var sfb;\n        var gi = l3_side.tt[1][ch];\n        var g0 = l3_side.tt[0][ch];\n\n        for (var i = 0; i < Tables.scfsi_band.length - 1; i++) {\n            for (sfb = Tables.scfsi_band[i]; sfb < Tables.scfsi_band[i + 1]; sfb++) {\n                if (g0.scalefac[sfb] != gi.scalefac[sfb]\n                    && gi.scalefac[sfb] >= 0)\n                    break;\n            }\n            if (sfb == Tables.scfsi_band[i + 1]) {\n                for (sfb = Tables.scfsi_band[i]; sfb < Tables.scfsi_band[i + 1]; sfb++) {\n                    gi.scalefac[sfb] = -1;\n                }\n                l3_side.scfsi[ch][i] = 1;\n            }\n        }\n        var s1 = 0;\n        var c1 = 0;\n        for (sfb = 0; sfb < 11; sfb++) {\n            if (gi.scalefac[sfb] == -1)\n                continue;\n            c1++;\n            if (s1 < gi.scalefac[sfb])\n                s1 = gi.scalefac[sfb];\n        }\n        var s2 = 0;\n        var c2 = 0;\n        for (; sfb < Encoder.SBPSY_l; sfb++) {\n            if (gi.scalefac[sfb] == -1)\n                continue;\n            c2++;\n            if (s2 < gi.scalefac[sfb])\n                s2 = gi.scalefac[sfb];\n        }\n\n        for (var i = 0; i < 16; i++) {\n            if (s1 < slen1_n[i] && s2 < slen2_n[i]) {\n                var c = slen1_tab[i] * c1 + slen2_tab[i] * c2;\n                if (gi.part2_length > c) {\n                    gi.part2_length = c;\n                    gi.scalefac_compress = i;\n                }\n            }\n        }\n    }\n\n    /**\n     * Find the optimal way to store the scalefactors. Only call this routine\n     * after final scalefactors have been chosen and the channel/granule will\n     * not be re-encoded.\n     */\n    this.best_scalefac_store = function (gfc, gr, ch, l3_side) {\n        /* use scalefac_scale if we can */\n        var gi = l3_side.tt[gr][ch];\n        var sfb, i, j, l;\n        var recalc = 0;\n\n        /*\n         * remove scalefacs from bands with ix=0. This idea comes from the AAC\n         * ISO docs. added mt 3/00\n         */\n        /* check if l3_enc=0 */\n        j = 0;\n        for (sfb = 0; sfb < gi.sfbmax; sfb++) {\n            var width = gi.width[sfb];\n            j += width;\n            for (l = -width; l < 0; l++) {\n                if (gi.l3_enc[l + j] != 0)\n                    break;\n            }\n            if (l == 0)\n                gi.scalefac[sfb] = recalc = -2;\n            /* anything goes. */\n            /*\n             * only best_scalefac_store and calc_scfsi know--and only they\n             * should know--about the magic number -2.\n             */\n        }\n\n        if (0 == gi.scalefac_scale && 0 == gi.preflag) {\n            var s = 0;\n            for (sfb = 0; sfb < gi.sfbmax; sfb++)\n                if (gi.scalefac[sfb] > 0)\n                    s |= gi.scalefac[sfb];\n\n            if (0 == (s & 1) && s != 0) {\n                for (sfb = 0; sfb < gi.sfbmax; sfb++)\n                    if (gi.scalefac[sfb] > 0)\n                        gi.scalefac[sfb] >>= 1;\n\n                gi.scalefac_scale = recalc = 1;\n            }\n        }\n\n        if (0 == gi.preflag && gi.block_type != Encoder.SHORT_TYPE\n            && gfc.mode_gr == 2) {\n            for (sfb = 11; sfb < Encoder.SBPSY_l; sfb++)\n                if (gi.scalefac[sfb] < qupvt.pretab[sfb]\n                    && gi.scalefac[sfb] != -2)\n                    break;\n            if (sfb == Encoder.SBPSY_l) {\n                for (sfb = 11; sfb < Encoder.SBPSY_l; sfb++)\n                    if (gi.scalefac[sfb] > 0)\n                        gi.scalefac[sfb] -= qupvt.pretab[sfb];\n\n                gi.preflag = recalc = 1;\n            }\n        }\n\n        for (i = 0; i < 4; i++)\n            l3_side.scfsi[ch][i] = 0;\n\n        if (gfc.mode_gr == 2 && gr == 1\n            && l3_side.tt[0][ch].block_type != Encoder.SHORT_TYPE\n            && l3_side.tt[1][ch].block_type != Encoder.SHORT_TYPE) {\n            scfsi_calc(ch, l3_side);\n            recalc = 0;\n        }\n        for (sfb = 0; sfb < gi.sfbmax; sfb++) {\n            if (gi.scalefac[sfb] == -2) {\n                gi.scalefac[sfb] = 0;\n                /* if anything goes, then 0 is a good choice */\n            }\n        }\n        if (recalc != 0) {\n            if (gfc.mode_gr == 2) {\n                this.scale_bitcount(gi);\n            } else {\n                this.scale_bitcount_lsf(gfc, gi);\n            }\n        }\n    }\n\n    function all_scalefactors_not_negative(scalefac, n) {\n        for (var i = 0; i < n; ++i) {\n            if (scalefac[i] < 0)\n                return false;\n        }\n        return true;\n    }\n\n    /**\n     * number of bits used to encode scalefacs.\n     *\n     * 18*slen1_tab[i] + 18*slen2_tab[i]\n     */\n    var scale_short = [0, 18, 36, 54, 54, 36, 54, 72,\n        54, 72, 90, 72, 90, 108, 108, 126];\n\n    /**\n     * number of bits used to encode scalefacs.\n     *\n     * 17*slen1_tab[i] + 18*slen2_tab[i]\n     */\n    var scale_mixed = [0, 18, 36, 54, 51, 35, 53, 71,\n        52, 70, 88, 69, 87, 105, 104, 122];\n\n    /**\n     * number of bits used to encode scalefacs.\n     *\n     * 11*slen1_tab[i] + 10*slen2_tab[i]\n     */\n    var scale_long = [0, 10, 20, 30, 33, 21, 31, 41, 32, 42,\n        52, 43, 53, 63, 64, 74];\n\n    /**\n     * Also calculates the number of bits necessary to code the scalefactors.\n     */\n    this.scale_bitcount = function (cod_info) {\n        var k, sfb, max_slen1 = 0, max_slen2 = 0;\n\n        /* maximum values */\n        var tab;\n        var scalefac = cod_info.scalefac;\n\n\n        if (cod_info.block_type == Encoder.SHORT_TYPE) {\n            tab = scale_short;\n            if (cod_info.mixed_block_flag != 0)\n                tab = scale_mixed;\n        } else { /* block_type == 1,2,or 3 */\n            tab = scale_long;\n            if (0 == cod_info.preflag) {\n                for (sfb = 11; sfb < Encoder.SBPSY_l; sfb++)\n                    if (scalefac[sfb] < qupvt.pretab[sfb])\n                        break;\n\n                if (sfb == Encoder.SBPSY_l) {\n                    cod_info.preflag = 1;\n                    for (sfb = 11; sfb < Encoder.SBPSY_l; sfb++)\n                        scalefac[sfb] -= qupvt.pretab[sfb];\n                }\n            }\n        }\n\n        for (sfb = 0; sfb < cod_info.sfbdivide; sfb++)\n            if (max_slen1 < scalefac[sfb])\n                max_slen1 = scalefac[sfb];\n\n        for (; sfb < cod_info.sfbmax; sfb++)\n            if (max_slen2 < scalefac[sfb])\n                max_slen2 = scalefac[sfb];\n\n        /*\n         * from Takehiro TOMINAGA <tominaga@isoternet.org> 10/99 loop over *all*\n         * posible values of scalefac_compress to find the one which uses the\n         * smallest number of bits. ISO would stop at first valid index\n         */\n        cod_info.part2_length = QuantizePVT.LARGE_BITS;\n        for (k = 0; k < 16; k++) {\n            if (max_slen1 < slen1_n[k] && max_slen2 < slen2_n[k]\n                && cod_info.part2_length > tab[k]) {\n                cod_info.part2_length = tab[k];\n                cod_info.scalefac_compress = k;\n            }\n        }\n        return cod_info.part2_length == QuantizePVT.LARGE_BITS;\n    }\n\n    /**\n     * table of largest scalefactor values for MPEG2\n     */\n    var max_range_sfac_tab = [[15, 15, 7, 7],\n        [15, 15, 7, 0], [7, 3, 0, 0], [15, 31, 31, 0],\n        [7, 7, 7, 0], [3, 3, 0, 0]];\n\n    /**\n     * Also counts the number of bits to encode the scalefacs but for MPEG 2\n     * Lower sampling frequencies (24, 22.05 and 16 kHz.)\n     *\n     * This is reverse-engineered from section 2.4.3.2 of the MPEG2 IS,\n     * \"Audio Decoding Layer III\"\n     */\n    this.scale_bitcount_lsf = function (gfc, cod_info) {\n        var table_number, row_in_table, partition, nr_sfb, window;\n        var over;\n        var i, sfb;\n        var max_sfac = new_int(4);\n//var partition_table;\n        var scalefac = cod_info.scalefac;\n\n        /*\n         * Set partition table. Note that should try to use table one, but do\n         * not yet...\n         */\n        if (cod_info.preflag != 0)\n            table_number = 2;\n        else\n            table_number = 0;\n\n        for (i = 0; i < 4; i++)\n            max_sfac[i] = 0;\n\n        if (cod_info.block_type == Encoder.SHORT_TYPE) {\n            row_in_table = 1;\n            var partition_table = qupvt.nr_of_sfb_block[table_number][row_in_table];\n            for (sfb = 0, partition = 0; partition < 4; partition++) {\n                nr_sfb = partition_table[partition] / 3;\n                for (i = 0; i < nr_sfb; i++, sfb++)\n                    for (window = 0; window < 3; window++)\n                        if (scalefac[sfb * 3 + window] > max_sfac[partition])\n                            max_sfac[partition] = scalefac[sfb * 3 + window];\n            }\n        } else {\n            row_in_table = 0;\n            var partition_table = qupvt.nr_of_sfb_block[table_number][row_in_table];\n            for (sfb = 0, partition = 0; partition < 4; partition++) {\n                nr_sfb = partition_table[partition];\n                for (i = 0; i < nr_sfb; i++, sfb++)\n                    if (scalefac[sfb] > max_sfac[partition])\n                        max_sfac[partition] = scalefac[sfb];\n            }\n        }\n\n        for (over = false, partition = 0; partition < 4; partition++) {\n            if (max_sfac[partition] > max_range_sfac_tab[table_number][partition])\n                over = true;\n        }\n        if (!over) {\n            var slen1, slen2, slen3, slen4;\n\n            cod_info.sfb_partition_table = qupvt.nr_of_sfb_block[table_number][row_in_table];\n            for (partition = 0; partition < 4; partition++)\n                cod_info.slen[partition] = log2tab[max_sfac[partition]];\n\n            /* set scalefac_compress */\n            slen1 = cod_info.slen[0];\n            slen2 = cod_info.slen[1];\n            slen3 = cod_info.slen[2];\n            slen4 = cod_info.slen[3];\n\n            switch (table_number) {\n                case 0:\n                    cod_info.scalefac_compress = (((slen1 * 5) + slen2) << 4)\n                        + (slen3 << 2) + slen4;\n                    break;\n\n                case 1:\n                    cod_info.scalefac_compress = 400 + (((slen1 * 5) + slen2) << 2)\n                        + slen3;\n                    break;\n\n                case 2:\n                    cod_info.scalefac_compress = 500 + (slen1 * 3) + slen2;\n                    break;\n\n                default:\n                    System.err.printf(\"intensity stereo not implemented yet\\n\");\n                    break;\n            }\n        }\n        if (!over) {\n            cod_info.part2_length = 0;\n            for (partition = 0; partition < 4; partition++)\n                cod_info.part2_length += cod_info.slen[partition]\n                    * cod_info.sfb_partition_table[partition];\n        }\n        return over;\n    }\n\n    /*\n     * Since no bands have been over-amplified, we can set scalefac_compress and\n     * slen[] for the formatter\n     */\n    var log2tab = [0, 1, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4,\n        4, 4, 4, 4];\n\n    this.huffman_init = function (gfc) {\n        for (var i = 2; i <= 576; i += 2) {\n            var scfb_anz = 0, bv_index;\n            while (gfc.scalefac_band.l[++scfb_anz] < i)\n                ;\n\n            bv_index = subdv_table[scfb_anz][0]; // .region0_count\n            while (gfc.scalefac_band.l[bv_index + 1] > i)\n                bv_index--;\n\n            if (bv_index < 0) {\n                /*\n                 * this is an indication that everything is going to be encoded\n                 * as region0: bigvalues < region0 < region1 so lets set\n                 * region0, region1 to some value larger than bigvalues\n                 */\n                bv_index = subdv_table[scfb_anz][0]; // .region0_count\n            }\n\n            gfc.bv_scf[i - 2] = bv_index;\n\n            bv_index = subdv_table[scfb_anz][1]; // .region1_count\n            while (gfc.scalefac_band.l[bv_index + gfc.bv_scf[i - 2] + 2] > i)\n                bv_index--;\n\n            if (bv_index < 0) {\n                bv_index = subdv_table[scfb_anz][1]; // .region1_count\n            }\n\n            gfc.bv_scf[i - 1] = bv_index;\n        }\n    }\n}\n\n/*\n *  ReplayGainAnalysis - analyzes input samples and give the recommended dB change\n *  Copyright (C) 2001 David Robinson and Glen Sawyer\n *  Improvements and optimizations added by Frank Klemm, and by Marcel Muller \n *\n *  This library is free software; you can redistribute it and/or\n *  modify it under the terms of the GNU Lesser General Public\n *  License as published by the Free Software Foundation; either\n *  version 2.1 of the License, or (at your option) any later version.\n *\n *  This library is distributed in the hope that it will be useful,\n *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n *  Lesser General Public License for more details.\n *\n *  You should have received a copy of the GNU Lesser General Public\n *  License along with this library; if not, write to the Free Software\n *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n *\n *  concept and filter values by David Robinson (David@Robinson.org)\n *    -- blame him if you think the idea is flawed\n *  original coding by Glen Sawyer (mp3gain@hotmail.com)\n *    -- blame him if you think this runs too slowly, or the coding is otherwise flawed\n *\n *  lots of code improvements by Frank Klemm ( http://www.uni-jena.de/~pfk/mpp/ )\n *    -- credit him for all the _good_ programming ;)\n *\n *\n *  For an explanation of the concepts and the basic algorithms involved, go to:\n *    http://www.replaygain.org/\n */\n\n/*\n *  Here's the deal. Call\n *\n *    InitGainAnalysis ( long samplefreq );\n *\n *  to initialize everything. Call\n *\n *    AnalyzeSamples ( var Float_t*  left_samples,\n *                     var Float_t*  right_samples,\n *                     size_t          num_samples,\n *                     int             num_channels );\n *\n *  as many times as you want, with as many or as few samples as you want.\n *  If mono, pass the sample buffer in through left_samples, leave\n *  right_samples NULL, and make sure num_channels = 1.\n *\n *    GetTitleGain()\n *\n *  will return the recommended dB level change for all samples analyzed\n *  SINCE THE LAST TIME you called GetTitleGain() OR InitGainAnalysis().\n *\n *    GetAlbumGain()\n *\n *  will return the recommended dB level change for all samples analyzed\n *  since InitGainAnalysis() was called and finalized with GetTitleGain().\n *\n *  Pseudo-code to process an album:\n *\n *    Float_t       l_samples [4096];\n *    Float_t       r_samples [4096];\n *    size_t        num_samples;\n *    unsigned int  num_songs;\n *    unsigned int  i;\n *\n *    InitGainAnalysis ( 44100 );\n *    for ( i = 1; i <= num_songs; i++ ) {\n *        while ( ( num_samples = getSongSamples ( song[i], left_samples, right_samples ) ) > 0 )\n *            AnalyzeSamples ( left_samples, right_samples, num_samples, 2 );\n *        fprintf (\"Recommended dB change for song %2d: %+6.2 dB\\n\", i, GetTitleGain() );\n *    }\n *    fprintf (\"Recommended dB change for whole album: %+6.2 dB\\n\", GetAlbumGain() );\n */\n\n/*\n *  So here's the main source of potential code confusion:\n *\n *  The filters applied to the incoming samples are IIR filters,\n *  meaning they rely on up to <filter order> number of previous samples\n *  AND up to <filter order> number of previous filtered samples.\n *\n *  I set up the AnalyzeSamples routine to minimize memory usage and interface\n *  complexity. The speed isn't compromised too much (I don't think), but the\n *  internal complexity is higher than it should be for such a relatively\n *  simple routine.\n *\n *  Optimization/clarity suggestions are welcome.\n */\n\n/**\n * Table entries per dB\n */\nGainAnalysis.STEPS_per_dB = 100.;\n/**\n * Table entries for 0...MAX_dB (normal max. values are 70...80 dB)\n */\nGainAnalysis.MAX_dB = 120.;\nGainAnalysis.GAIN_NOT_ENOUGH_SAMPLES = -24601;\nGainAnalysis.GAIN_ANALYSIS_ERROR = 0;\nGainAnalysis.GAIN_ANALYSIS_OK = 1;\nGainAnalysis.INIT_GAIN_ANALYSIS_ERROR = 0;\nGainAnalysis.INIT_GAIN_ANALYSIS_OK = 1;\n\nGainAnalysis.YULE_ORDER = 10;\nGainAnalysis.MAX_ORDER = GainAnalysis.YULE_ORDER;\n\nGainAnalysis.MAX_SAMP_FREQ = 48000;\nGainAnalysis.RMS_WINDOW_TIME_NUMERATOR = 1;\nGainAnalysis.RMS_WINDOW_TIME_DENOMINATOR = 20;\nGainAnalysis.MAX_SAMPLES_PER_WINDOW = ((GainAnalysis.MAX_SAMP_FREQ * GainAnalysis.RMS_WINDOW_TIME_NUMERATOR) / GainAnalysis.RMS_WINDOW_TIME_DENOMINATOR + 1);\n\nfunction GainAnalysis() {\n\t//fix 精简\n}\n\n\nfunction Presets() {\n    function VBRPresets(qual, comp, compS,\n                        y, shThreshold, shThresholdS,\n                        adj, adjShort, lower,\n                        curve, sens, inter,\n                        joint, mod, fix) {\n        this.vbr_q = qual;\n        this.quant_comp = comp;\n        this.quant_comp_s = compS;\n        this.expY = y;\n        this.st_lrm = shThreshold;\n        this.st_s = shThresholdS;\n        this.masking_adj = adj;\n        this.masking_adj_short = adjShort;\n        this.ath_lower = lower;\n        this.ath_curve = curve;\n        this.ath_sensitivity = sens;\n        this.interch = inter;\n        this.safejoint = joint;\n        this.sfb21mod = mod;\n        this.msfix = fix;\n    }\n\n    function ABRPresets(kbps, comp, compS,\n                        joint, fix, shThreshold,\n                        shThresholdS, bass, sc,\n                        mask, lower, curve,\n                        interCh, sfScale) {\n        this.quant_comp = comp;\n        this.quant_comp_s = compS;\n        this.safejoint = joint;\n        this.nsmsfix = fix;\n        this.st_lrm = shThreshold;\n        this.st_s = shThresholdS;\n        this.nsbass = bass;\n        this.scale = sc;\n        this.masking_adj = mask;\n        this.ath_lower = lower;\n        this.ath_curve = curve;\n        this.interch = interCh;\n        this.sfscale = sfScale;\n    }\n\n    var lame;\n\n    this.setModules = function (_lame) {\n        lame = _lame;\n    };\n\n    /**\n     * <PRE>\n     * Switch mappings for VBR mode VBR_RH\n     *             vbr_q  qcomp_l  qcomp_s  expY  st_lrm   st_s  mask adj_l  adj_s  ath_lower  ath_curve  ath_sens  interChR  safejoint sfb21mod  msfix\n     * </PRE>\n     */\n    var vbr_old_switch_map = [\n        new VBRPresets(0, 9, 9, 0, 5.20, 125.0, -4.2, -6.3, 4.8, 1, 0, 0, 2, 21, 0.97),\n        new VBRPresets(1, 9, 9, 0, 5.30, 125.0, -3.6, -5.6, 4.5, 1.5, 0, 0, 2, 21, 1.35),\n        new VBRPresets(2, 9, 9, 0, 5.60, 125.0, -2.2, -3.5, 2.8, 2, 0, 0, 2, 21, 1.49),\n        new VBRPresets(3, 9, 9, 1, 5.80, 130.0, -1.8, -2.8, 2.6, 3, -4, 0, 2, 20, 1.64),\n        new VBRPresets(4, 9, 9, 1, 6.00, 135.0, -0.7, -1.1, 1.1, 3.5, -8, 0, 2, 0, 1.79),\n        new VBRPresets(5, 9, 9, 1, 6.40, 140.0, 0.5, 0.4, -7.5, 4, -12, 0.0002, 0, 0, 1.95),\n        new VBRPresets(6, 9, 9, 1, 6.60, 145.0, 0.67, 0.65, -14.7, 6.5, -19, 0.0004, 0, 0, 2.30),\n        new VBRPresets(7, 9, 9, 1, 6.60, 145.0, 0.8, 0.75, -19.7, 8, -22, 0.0006, 0, 0, 2.70),\n        new VBRPresets(8, 9, 9, 1, 6.60, 145.0, 1.2, 1.15, -27.5, 10, -23, 0.0007, 0, 0, 0),\n        new VBRPresets(9, 9, 9, 1, 6.60, 145.0, 1.6, 1.6, -36, 11, -25, 0.0008, 0, 0, 0),\n        new VBRPresets(10, 9, 9, 1, 6.60, 145.0, 2.0, 2.0, -36, 12, -25, 0.0008, 0, 0, 0)\n    ];\n\n    /**\n     * <PRE>\n     *                 vbr_q  qcomp_l  qcomp_s  expY  st_lrm   st_s  mask adj_l  adj_s  ath_lower  ath_curve  ath_sens  interChR  safejoint sfb21mod  msfix\n     * </PRE>\n     */\n    var vbr_psy_switch_map = [\n        new VBRPresets(0, 9, 9, 0, 4.20, 25.0, -7.0, -4.0, 7.5, 1, 0, 0, 2, 26, 0.97),\n        new VBRPresets(1, 9, 9, 0, 4.20, 25.0, -5.6, -3.6, 4.5, 1.5, 0, 0, 2, 21, 1.35),\n        new VBRPresets(2, 9, 9, 0, 4.20, 25.0, -4.4, -1.8, 2, 2, 0, 0, 2, 18, 1.49),\n        new VBRPresets(3, 9, 9, 1, 4.20, 25.0, -3.4, -1.25, 1.1, 3, -4, 0, 2, 15, 1.64),\n        new VBRPresets(4, 9, 9, 1, 4.20, 25.0, -2.2, 0.1, 0, 3.5, -8, 0, 2, 0, 1.79),\n        new VBRPresets(5, 9, 9, 1, 4.20, 25.0, -1.0, 1.65, -7.7, 4, -12, 0.0002, 0, 0, 1.95),\n        new VBRPresets(6, 9, 9, 1, 4.20, 25.0, -0.0, 2.47, -7.7, 6.5, -19, 0.0004, 0, 0, 2),\n        new VBRPresets(7, 9, 9, 1, 4.20, 25.0, 0.5, 2.0, -14.5, 8, -22, 0.0006, 0, 0, 2),\n        new VBRPresets(8, 9, 9, 1, 4.20, 25.0, 1.0, 2.4, -22.0, 10, -23, 0.0007, 0, 0, 2),\n        new VBRPresets(9, 9, 9, 1, 4.20, 25.0, 1.5, 2.95, -30.0, 11, -25, 0.0008, 0, 0, 2),\n        new VBRPresets(10, 9, 9, 1, 4.20, 25.0, 2.0, 2.95, -36.0, 12, -30, 0.0008, 0, 0, 2)\n    ];\n\n    function apply_vbr_preset(gfp, a, enforce) {\n        var vbr_preset = gfp.VBR == VbrMode.vbr_rh ? vbr_old_switch_map\n            : vbr_psy_switch_map;\n\n        var x = gfp.VBR_q_frac;\n        var p = vbr_preset[a];\n        var q = vbr_preset[a + 1];\n        var set = p;\n\n        // NOOP(vbr_q);\n        // NOOP(quant_comp);\n        // NOOP(quant_comp_s);\n        // NOOP(expY);\n        p.st_lrm = p.st_lrm + x * (q.st_lrm - p.st_lrm);\n        // LERP(st_lrm);\n        p.st_s = p.st_s + x * (q.st_s - p.st_s);\n        // LERP(st_s);\n        p.masking_adj = p.masking_adj + x * (q.masking_adj - p.masking_adj);\n        // LERP(masking_adj);\n        p.masking_adj_short = p.masking_adj_short + x\n            * (q.masking_adj_short - p.masking_adj_short);\n        // LERP(masking_adj_short);\n        p.ath_lower = p.ath_lower + x * (q.ath_lower - p.ath_lower);\n        // LERP(ath_lower);\n        p.ath_curve = p.ath_curve + x * (q.ath_curve - p.ath_curve);\n        // LERP(ath_curve);\n        p.ath_sensitivity = p.ath_sensitivity + x\n            * (q.ath_sensitivity - p.ath_sensitivity);\n        // LERP(ath_sensitivity);\n        p.interch = p.interch + x * (q.interch - p.interch);\n        // LERP(interch);\n        // NOOP(safejoint);\n        // NOOP(sfb21mod);\n        p.msfix = p.msfix + x * (q.msfix - p.msfix);\n        // LERP(msfix);\n\n        lame_set_VBR_q(gfp, set.vbr_q);\n\n        if (enforce != 0)\n            gfp.quant_comp = set.quant_comp;\n        else if (!(Math.abs(gfp.quant_comp - -1) > 0))\n            gfp.quant_comp = set.quant_comp;\n        // SET_OPTION(quant_comp, set.quant_comp, -1);\n        if (enforce != 0)\n            gfp.quant_comp_short = set.quant_comp_s;\n        else if (!(Math.abs(gfp.quant_comp_short - -1) > 0))\n            gfp.quant_comp_short = set.quant_comp_s;\n        // SET_OPTION(quant_comp_short, set.quant_comp_s, -1);\n        if (set.expY != 0) {\n            gfp.experimentalY = set.expY != 0;\n        }\n        if (enforce != 0)\n            gfp.internal_flags.nsPsy.attackthre = set.st_lrm;\n        else if (!(Math.abs(gfp.internal_flags.nsPsy.attackthre - -1) > 0))\n            gfp.internal_flags.nsPsy.attackthre = set.st_lrm;\n        // SET_OPTION(short_threshold_lrm, set.st_lrm, -1);\n        if (enforce != 0)\n            gfp.internal_flags.nsPsy.attackthre_s = set.st_s;\n        else if (!(Math.abs(gfp.internal_flags.nsPsy.attackthre_s - -1) > 0))\n            gfp.internal_flags.nsPsy.attackthre_s = set.st_s;\n        // SET_OPTION(short_threshold_s, set.st_s, -1);\n        if (enforce != 0)\n            gfp.maskingadjust = set.masking_adj;\n        else if (!(Math.abs(gfp.maskingadjust - 0) > 0))\n            gfp.maskingadjust = set.masking_adj;\n        // SET_OPTION(maskingadjust, set.masking_adj, 0);\n        if (enforce != 0)\n            gfp.maskingadjust_short = set.masking_adj_short;\n        else if (!(Math.abs(gfp.maskingadjust_short - 0) > 0))\n            gfp.maskingadjust_short = set.masking_adj_short;\n        // SET_OPTION(maskingadjust_short, set.masking_adj_short, 0);\n        if (enforce != 0)\n            gfp.ATHlower = -set.ath_lower / 10.0;\n        else if (!(Math.abs((-gfp.ATHlower * 10.0) - 0) > 0))\n            gfp.ATHlower = -set.ath_lower / 10.0;\n        // SET_OPTION(ATHlower, set.ath_lower, 0);\n        if (enforce != 0)\n            gfp.ATHcurve = set.ath_curve;\n        else if (!(Math.abs(gfp.ATHcurve - -1) > 0))\n            gfp.ATHcurve = set.ath_curve;\n        // SET_OPTION(ATHcurve, set.ath_curve, -1);\n        if (enforce != 0)\n            gfp.athaa_sensitivity = set.ath_sensitivity;\n        else if (!(Math.abs(gfp.athaa_sensitivity - -1) > 0))\n            gfp.athaa_sensitivity = set.ath_sensitivity;\n        // SET_OPTION(athaa_sensitivity, set.ath_sensitivity, 0);\n        if (set.interch > 0) {\n            if (enforce != 0)\n                gfp.interChRatio = set.interch;\n            else if (!(Math.abs(gfp.interChRatio - -1) > 0))\n                gfp.interChRatio = set.interch;\n            // SET_OPTION(interChRatio, set.interch, -1);\n        }\n\n        /* parameters for which there is no proper set/get interface */\n        if (set.safejoint > 0) {\n            gfp.exp_nspsytune = gfp.exp_nspsytune | set.safejoint;\n        }\n        if (set.sfb21mod > 0) {\n            gfp.exp_nspsytune = gfp.exp_nspsytune | (set.sfb21mod << 20);\n        }\n        if (enforce != 0)\n            gfp.msfix = set.msfix;\n        else if (!(Math.abs(gfp.msfix - -1) > 0))\n            gfp.msfix = set.msfix;\n        // SET_OPTION(msfix, set.msfix, -1);\n\n        if (enforce == 0) {\n            gfp.VBR_q = a;\n            gfp.VBR_q_frac = x;\n        }\n    }\n\n    /**\n     * <PRE>\n     *  Switch mappings for ABR mode\n     *\n     *              kbps  quant q_s safejoint nsmsfix st_lrm  st_s  ns-bass scale   msk ath_lwr ath_curve  interch , sfscale\n     * </PRE>\n     */\n    var abr_switch_map = [\n        new ABRPresets(8, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -30.0, 11, 0.0012, 1), /*   8, impossible to use in stereo */\n        new ABRPresets(16, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -25.0, 11, 0.0010, 1), /*  16 */\n        new ABRPresets(24, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -20.0, 11, 0.0010, 1), /*  24 */\n        new ABRPresets(32, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -15.0, 11, 0.0010, 1), /*  32 */\n        new ABRPresets(40, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -10.0, 11, 0.0009, 1), /*  40 */\n        new ABRPresets(48, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -10.0, 11, 0.0009, 1), /*  48 */\n        new ABRPresets(56, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -6.0, 11, 0.0008, 1), /*  56 */\n        new ABRPresets(64, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -2.0, 11, 0.0008, 1), /*  64 */\n        new ABRPresets(80, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, .0, 8, 0.0007, 1), /*  80 */\n        new ABRPresets(96, 9, 9, 0, 2.50, 6.60, 145, 0, 0.95, 0, 1.0, 5.5, 0.0006, 1), /*  96 */\n        new ABRPresets(112, 9, 9, 0, 2.25, 6.60, 145, 0, 0.95, 0, 2.0, 4.5, 0.0005, 1), /* 112 */\n        new ABRPresets(128, 9, 9, 0, 1.95, 6.40, 140, 0, 0.95, 0, 3.0, 4, 0.0002, 1), /* 128 */\n        new ABRPresets(160, 9, 9, 1, 1.79, 6.00, 135, 0, 0.95, -2, 5.0, 3.5, 0, 1), /* 160 */\n        new ABRPresets(192, 9, 9, 1, 1.49, 5.60, 125, 0, 0.97, -4, 7.0, 3, 0, 0), /* 192 */\n        new ABRPresets(224, 9, 9, 1, 1.25, 5.20, 125, 0, 0.98, -6, 9.0, 2, 0, 0), /* 224 */\n        new ABRPresets(256, 9, 9, 1, 0.97, 5.20, 125, 0, 1.00, -8, 10.0, 1, 0, 0), /* 256 */\n        new ABRPresets(320, 9, 9, 1, 0.90, 5.20, 125, 0, 1.00, -10, 12.0, 0, 0, 0)  /* 320 */\n    ];\n\n    function apply_abr_preset(gfp, preset, enforce) {\n        /* Variables for the ABR stuff */\n        var actual_bitrate = preset;\n\n        var r = lame.nearestBitrateFullIndex(preset);\n\n        gfp.VBR = VbrMode.vbr_abr;\n        gfp.VBR_mean_bitrate_kbps = actual_bitrate;\n        gfp.VBR_mean_bitrate_kbps = Math.min(gfp.VBR_mean_bitrate_kbps, 320);\n        gfp.VBR_mean_bitrate_kbps = Math.max(gfp.VBR_mean_bitrate_kbps, 8);\n        gfp.brate = gfp.VBR_mean_bitrate_kbps;\n        if (gfp.VBR_mean_bitrate_kbps > 320) {\n            gfp.disable_reservoir = true;\n        }\n\n        /* parameters for which there is no proper set/get interface */\n        if (abr_switch_map[r].safejoint > 0)\n            gfp.exp_nspsytune = gfp.exp_nspsytune | 2;\n        /* safejoint */\n\n        if (abr_switch_map[r].sfscale > 0) {\n            gfp.internal_flags.noise_shaping = 2;\n        }\n        /* ns-bass tweaks */\n        if (Math.abs(abr_switch_map[r].nsbass) > 0) {\n            var k = (int)(abr_switch_map[r].nsbass * 4);\n            if (k < 0)\n                k += 64;\n            gfp.exp_nspsytune = gfp.exp_nspsytune | (k << 2);\n        }\n\n        if (enforce != 0)\n            gfp.quant_comp = abr_switch_map[r].quant_comp;\n        else if (!(Math.abs(gfp.quant_comp - -1) > 0))\n            gfp.quant_comp = abr_switch_map[r].quant_comp;\n        // SET_OPTION(quant_comp, abr_switch_map[r].quant_comp, -1);\n        if (enforce != 0)\n            gfp.quant_comp_short = abr_switch_map[r].quant_comp_s;\n        else if (!(Math.abs(gfp.quant_comp_short - -1) > 0))\n            gfp.quant_comp_short = abr_switch_map[r].quant_comp_s;\n        // SET_OPTION(quant_comp_short, abr_switch_map[r].quant_comp_s, -1);\n\n        if (enforce != 0)\n            gfp.msfix = abr_switch_map[r].nsmsfix;\n        else if (!(Math.abs(gfp.msfix - -1) > 0))\n            gfp.msfix = abr_switch_map[r].nsmsfix;\n        // SET_OPTION(msfix, abr_switch_map[r].nsmsfix, -1);\n\n        if (enforce != 0)\n            gfp.internal_flags.nsPsy.attackthre = abr_switch_map[r].st_lrm;\n        else if (!(Math.abs(gfp.internal_flags.nsPsy.attackthre - -1) > 0))\n            gfp.internal_flags.nsPsy.attackthre = abr_switch_map[r].st_lrm;\n        // SET_OPTION(short_threshold_lrm, abr_switch_map[r].st_lrm, -1);\n        if (enforce != 0)\n            gfp.internal_flags.nsPsy.attackthre_s = abr_switch_map[r].st_s;\n        else if (!(Math.abs(gfp.internal_flags.nsPsy.attackthre_s - -1) > 0))\n            gfp.internal_flags.nsPsy.attackthre_s = abr_switch_map[r].st_s;\n        // SET_OPTION(short_threshold_s, abr_switch_map[r].st_s, -1);\n\n        /*\n         * ABR seems to have big problems with clipping, especially at low\n         * bitrates\n         */\n        /*\n         * so we compensate for that here by using a scale value depending on\n         * bitrate\n         */\n        if (enforce != 0)\n            gfp.scale = abr_switch_map[r].scale;\n        else if (!(Math.abs(gfp.scale - -1) > 0))\n            gfp.scale = abr_switch_map[r].scale;\n        // SET_OPTION(scale, abr_switch_map[r].scale, -1);\n\n        if (enforce != 0)\n            gfp.maskingadjust = abr_switch_map[r].masking_adj;\n        else if (!(Math.abs(gfp.maskingadjust - 0) > 0))\n            gfp.maskingadjust = abr_switch_map[r].masking_adj;\n        // SET_OPTION(maskingadjust, abr_switch_map[r].masking_adj, 0);\n        if (abr_switch_map[r].masking_adj > 0) {\n            if (enforce != 0)\n                gfp.maskingadjust_short = (abr_switch_map[r].masking_adj * .9);\n            else if (!(Math.abs(gfp.maskingadjust_short - 0) > 0))\n                gfp.maskingadjust_short = (abr_switch_map[r].masking_adj * .9);\n            // SET_OPTION(maskingadjust_short, abr_switch_map[r].masking_adj *\n            // .9, 0);\n        } else {\n            if (enforce != 0)\n                gfp.maskingadjust_short = (abr_switch_map[r].masking_adj * 1.1);\n            else if (!(Math.abs(gfp.maskingadjust_short - 0) > 0))\n                gfp.maskingadjust_short = (abr_switch_map[r].masking_adj * 1.1);\n            // SET_OPTION(maskingadjust_short, abr_switch_map[r].masking_adj *\n            // 1.1, 0);\n        }\n\n        if (enforce != 0)\n            gfp.ATHlower = -abr_switch_map[r].ath_lower / 10.;\n        else if (!(Math.abs((-gfp.ATHlower * 10.) - 0) > 0))\n            gfp.ATHlower = -abr_switch_map[r].ath_lower / 10.;\n        // SET_OPTION(ATHlower, abr_switch_map[r].ath_lower, 0);\n        if (enforce != 0)\n            gfp.ATHcurve = abr_switch_map[r].ath_curve;\n        else if (!(Math.abs(gfp.ATHcurve - -1) > 0))\n            gfp.ATHcurve = abr_switch_map[r].ath_curve;\n        // SET_OPTION(ATHcurve, abr_switch_map[r].ath_curve, -1);\n\n        if (enforce != 0)\n            gfp.interChRatio = abr_switch_map[r].interch;\n        else if (!(Math.abs(gfp.interChRatio - -1) > 0))\n            gfp.interChRatio = abr_switch_map[r].interch;\n        // SET_OPTION(interChRatio, abr_switch_map[r].interch, -1);\n\n        return preset;\n    }\n\n    this.apply_preset = function(gfp, preset, enforce) {\n        /* translate legacy presets */\n        switch (preset) {\n            case Lame.R3MIX:\n            {\n                preset = Lame.V3;\n                gfp.VBR = VbrMode.vbr_mtrh;\n                break;\n            }\n            case Lame.MEDIUM:\n            {\n                preset = Lame.V4;\n                gfp.VBR = VbrMode.vbr_rh;\n                break;\n            }\n            case Lame.MEDIUM_FAST:\n            {\n                preset = Lame.V4;\n                gfp.VBR = VbrMode.vbr_mtrh;\n                break;\n            }\n            case Lame.STANDARD:\n            {\n                preset = Lame.V2;\n                gfp.VBR = VbrMode.vbr_rh;\n                break;\n            }\n            case Lame.STANDARD_FAST:\n            {\n                preset = Lame.V2;\n                gfp.VBR = VbrMode.vbr_mtrh;\n                break;\n            }\n            case Lame.EXTREME:\n            {\n                preset = Lame.V0;\n                gfp.VBR = VbrMode.vbr_rh;\n                break;\n            }\n            case Lame.EXTREME_FAST:\n            {\n                preset = Lame.V0;\n                gfp.VBR = VbrMode.vbr_mtrh;\n                break;\n            }\n            case Lame.INSANE:\n            {\n                preset = 320;\n                gfp.preset = preset;\n                apply_abr_preset(gfp, preset, enforce);\n                gfp.VBR = VbrMode.vbr_off;\n                return preset;\n            }\n        }\n\n        gfp.preset = preset;\n        {\n            switch (preset) {\n                case Lame.V9:\n                    apply_vbr_preset(gfp, 9, enforce);\n                    return preset;\n                case Lame.V8:\n                    apply_vbr_preset(gfp, 8, enforce);\n                    return preset;\n                case Lame.V7:\n                    apply_vbr_preset(gfp, 7, enforce);\n                    return preset;\n                case Lame.V6:\n                    apply_vbr_preset(gfp, 6, enforce);\n                    return preset;\n                case Lame.V5:\n                    apply_vbr_preset(gfp, 5, enforce);\n                    return preset;\n                case Lame.V4:\n                    apply_vbr_preset(gfp, 4, enforce);\n                    return preset;\n                case Lame.V3:\n                    apply_vbr_preset(gfp, 3, enforce);\n                    return preset;\n                case Lame.V2:\n                    apply_vbr_preset(gfp, 2, enforce);\n                    return preset;\n                case Lame.V1:\n                    apply_vbr_preset(gfp, 1, enforce);\n                    return preset;\n                case Lame.V0:\n                    apply_vbr_preset(gfp, 0, enforce);\n                    return preset;\n                default:\n                    break;\n            }\n        }\n        if (8 <= preset && preset <= 320) {\n            return apply_abr_preset(gfp, preset, enforce);\n        }\n\n        /* no corresponding preset found */\n        gfp.preset = 0;\n        return preset;\n    }\n\n    // Rest from getset.c:\n\n    /**\n     * VBR quality level.<BR>\n     * 0 = highest<BR>\n     * 9 = lowest\n     */\n    function lame_set_VBR_q(gfp, VBR_q) {\n        var ret = 0;\n\n        if (0 > VBR_q) {\n            /* Unknown VBR quality level! */\n            ret = -1;\n            VBR_q = 0;\n        }\n        if (9 < VBR_q) {\n            ret = -1;\n            VBR_q = 9;\n        }\n\n        gfp.VBR_q = VBR_q;\n        gfp.VBR_q_frac = 0;\n        return ret;\n    }\n\n}\n\n/*\n *      bit reservoir source file\n *\n *      Copyright (c) 1999-2000 Mark Taylor\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n\n/* $Id: Reservoir.java,v 1.9 2011/05/24 20:48:06 kenchis Exp $ */\n\n//package mp3;\n\n/**\n * ResvFrameBegin:<BR>\n * Called (repeatedly) at the beginning of a frame. Updates the maximum size of\n * the reservoir, and checks to make sure main_data_begin was set properly by\n * the formatter<BR>\n * Background information:\n * \n * This is the original text from the ISO standard. Because of sooo many bugs\n * and irritations correcting comments are added in brackets []. A '^W' means\n * you should remove the last word.\n * \n * <PRE>\n *  1. The following rule can be used to calculate the maximum\n *     number of bits used for one granule [^W frame]:<BR>\n *     At the highest possible bitrate of Layer III (320 kbps\n *     per stereo signal [^W^W^W], 48 kHz) the frames must be of\n *     [^W^W^W are designed to have] constant length, i.e.\n *     one buffer [^W^W the frame] length is:<BR>\n * \n *         320 kbps * 1152/48 kHz = 7680 bit = 960 byte\n * \n *     This value is used as the maximum buffer per channel [^W^W] at\n *     lower bitrates [than 320 kbps]. At 64 kbps mono or 128 kbps\n *     stereo the main granule length is 64 kbps * 576/48 kHz = 768 bit\n *     [per granule and channel] at 48 kHz sampling frequency.\n *     This means that there is a maximum deviation (short time buffer\n *     [= reservoir]) of 7680 - 2*2*768 = 4608 bits is allowed at 64 kbps.\n *     The actual deviation is equal to the number of bytes [with the\n *     meaning of octets] denoted by the main_data_end offset pointer.\n *     The actual maximum deviation is (2^9-1)*8 bit = 4088 bits\n *     [for MPEG-1 and (2^8-1)*8 bit for MPEG-2, both are hard limits].\n *     ... The xchange of buffer bits between the left and right channel\n *     is allowed without restrictions [exception: dual channel].\n *     Because of the [constructed] constraint on the buffer size\n *     main_data_end is always set to 0 in the case of bit_rate_index==14,\n *     i.e. data rate 320 kbps per stereo signal [^W^W^W]. In this case\n *     all data are allocated between adjacent header [^W sync] words\n *     [, i.e. there is no buffering at all].\n * </PRE>\n */\n\n\nfunction Reservoir() {\n\tvar bs;\n\n\tthis.setModules  = function(_bs) {\n\t\tbs = _bs;\n\t}\n\n\tthis.ResvFrameBegin = function(gfp, mean_bits) {\n\t\tvar gfc = gfp.internal_flags;\n\t\tvar maxmp3buf;\n\t\tvar l3_side = gfc.l3_side;\n\n\t\tvar frameLength = bs.getframebits(gfp);\n\t\tmean_bits.bits = (frameLength - gfc.sideinfo_len * 8) / gfc.mode_gr;\n\n\t\t/**\n\t\t * <PRE>\n\t\t *  Meaning of the variables:\n\t\t *      resvLimit: (0, 8, ..., 8*255 (MPEG-2), 8*511 (MPEG-1))\n\t\t *          Number of bits can be stored in previous frame(s) due to\n\t\t *          counter size constaints\n\t\t *      maxmp3buf: ( ??? ... 8*1951 (MPEG-1 and 2), 8*2047 (MPEG-2.5))\n\t\t *          Number of bits allowed to encode one frame (you can take 8*511 bit\n\t\t *          from the bit reservoir and at most 8*1440 bit from the current\n\t\t *          frame (320 kbps, 32 kHz), so 8*1951 bit is the largest possible\n\t\t *          value for MPEG-1 and -2)\n\t\t * \n\t\t *          maximum allowed granule/channel size times 4 = 8*2047 bits.,\n\t\t *          so this is the absolute maximum supported by the format.\n\t\t * \n\t\t * \n\t\t *      fullFrameBits:  maximum number of bits available for encoding\n\t\t *                      the current frame.\n\t\t * \n\t\t *      mean_bits:      target number of bits per granule.\n\t\t * \n\t\t *      frameLength:\n\t\t * \n\t\t *      gfc.ResvMax:   maximum allowed reservoir\n\t\t * \n\t\t *      gfc.ResvSize:  current reservoir size\n\t\t * \n\t\t *      l3_side.resvDrain_pre:\n\t\t *         ancillary data to be added to previous frame:\n\t\t *         (only usefull in VBR modes if it is possible to have\n\t\t *         maxmp3buf < fullFrameBits)).  Currently disabled,\n\t\t *         see #define NEW_DRAIN\n\t\t *         2010-02-13: RH now enabled, it seems to be needed for CBR too,\n\t\t *                     as there exists one example, where the FhG decoder\n\t\t *                     can't decode a -b320 CBR file anymore.\n\t\t * \n\t\t *      l3_side.resvDrain_post:\n\t\t *         ancillary data to be added to this frame:\n\t\t * \n\t\t * </PRE>\n\t\t */\n\n\t\t/* main_data_begin has 9 bits in MPEG-1, 8 bits MPEG-2 */\n\t\tvar resvLimit = (8 * 256) * gfc.mode_gr - 8;\n\n\t\t/*\n\t\t * maximum allowed frame size. dont use more than this number of bits,\n\t\t * even if the frame has the space for them:\n\t\t */\n\t\tif (gfp.brate > 320) {\n\t\t\t/* in freeformat the buffer is constant */\n\t\t\tmaxmp3buf = 8 * ((int) ((gfp.brate * 1000)\n\t\t\t\t\t/ (gfp.out_samplerate / 1152) / 8 + .5));\n\t\t} else {\n\t\t\t/*\n\t\t\t * all mp3 decoders should have enough buffer to handle this value:\n\t\t\t * size of a 320kbps 32kHz frame\n\t\t\t */\n\t\t\tmaxmp3buf = 8 * 1440;\n\n\t\t\t/*\n\t\t\t * Bouvigne suggests this more lax interpretation of the ISO doc\n\t\t\t * instead of using 8*960.\n\t\t\t */\n\n\t\t\tif (gfp.strict_ISO) {\n\t\t\t\tmaxmp3buf = 8 * ((int) (320000 / (gfp.out_samplerate / 1152) / 8 + .5));\n\t\t\t}\n\t\t}\n\n\t\tgfc.ResvMax = maxmp3buf - frameLength;\n\t\tif (gfc.ResvMax > resvLimit)\n\t\t\tgfc.ResvMax = resvLimit;\n\t\tif (gfc.ResvMax < 0 || gfp.disable_reservoir)\n\t\t\tgfc.ResvMax = 0;\n\n\t\tvar fullFrameBits = mean_bits.bits * gfc.mode_gr\n\t\t\t\t+ Math.min(gfc.ResvSize, gfc.ResvMax);\n\n\t\tif (fullFrameBits > maxmp3buf)\n\t\t\tfullFrameBits = maxmp3buf;\n\n\n\t\tl3_side.resvDrain_pre = 0;\n\n\t\t// frame analyzer code\n\t\tif (gfc.pinfo != null) {\n\t\t\t/*\n\t\t\t * expected bits per channel per granule [is this also right for\n\t\t\t * mono/stereo, MPEG-1/2 ?]\n\t\t\t */\n\t\t\tgfc.pinfo.mean_bits = mean_bits.bits / 2;\n\t\t\tgfc.pinfo.resvsize = gfc.ResvSize;\n\t\t}\n\n\t\treturn fullFrameBits;\n\t}\n\n\t/**\n\t * returns targ_bits: target number of bits to use for 1 granule<BR>\n\t * extra_bits: amount extra available from reservoir<BR>\n\t * Mark Taylor 4/99\n\t */\n\tthis.ResvMaxBits = function(gfp, mean_bits, targ_bits, cbr) {\n\t\tvar gfc = gfp.internal_flags;\n\t\tvar add_bits;\n        var ResvSize = gfc.ResvSize, ResvMax = gfc.ResvMax;\n\n\t\t/* compensate the saved bits used in the 1st granule */\n\t\tif (cbr != 0)\n\t\t\tResvSize += mean_bits;\n\n\t\tif ((gfc.substep_shaping & 1) != 0)\n\t\t\tResvMax *= 0.9;\n\n\t\ttarg_bits.bits = mean_bits;\n\n\t\t/* extra bits if the reservoir is almost full */\n\t\tif (ResvSize * 10 > ResvMax * 9) {\n\t\t\tadd_bits = ResvSize - (ResvMax * 9) / 10;\n\t\t\ttarg_bits.bits += add_bits;\n\t\t\tgfc.substep_shaping |= 0x80;\n\t\t} else {\n\t\t\tadd_bits = 0;\n\t\t\tgfc.substep_shaping &= 0x7f;\n\t\t\t/*\n\t\t\t * build up reservoir. this builds the reservoir a little slower\n\t\t\t * than FhG. It could simple be mean_bits/15, but this was rigged to\n\t\t\t * always produce 100 (the old value) at 128kbs\n\t\t\t */\n\t\t\tif (!gfp.disable_reservoir && 0 == (gfc.substep_shaping & 1))\n\t\t\t\ttarg_bits.bits -= .1 * mean_bits;\n\t\t}\n\n\t\t/* amount from the reservoir we are allowed to use. ISO says 6/10 */\n\t\tvar extra_bits = (ResvSize < (gfc.ResvMax * 6) / 10 ? ResvSize\n\t\t\t\t: (gfc.ResvMax * 6) / 10);\n\t\textra_bits -= add_bits;\n\n\t\tif (extra_bits < 0)\n\t\t\textra_bits = 0;\n\t\treturn extra_bits;\n\t}\n\n\t/**\n\t * Called after a granule's bit allocation. Readjusts the size of the\n\t * reservoir to reflect the granule's usage.\n\t */\n\tthis.ResvAdjust = function(gfc, gi) {\n\t\tgfc.ResvSize -= gi.part2_3_length + gi.part2_length;\n\t}\n\n\t/**\n\t * Called after all granules in a frame have been allocated. Makes sure that\n\t * the reservoir size is within limits, possibly by adding stuffing bits.\n\t */\n\tthis.ResvFrameEnd = function(gfc, mean_bits) {\n\t\tvar over_bits;\n\t\tvar l3_side = gfc.l3_side;\n\n\t\tgfc.ResvSize += mean_bits * gfc.mode_gr;\n\t\tvar stuffingBits = 0;\n\t\tl3_side.resvDrain_post = 0;\n\t\tl3_side.resvDrain_pre = 0;\n\n\t\t/* we must be byte aligned */\n\t\tif ((over_bits = gfc.ResvSize % 8) != 0)\n\t\t\tstuffingBits += over_bits;\n\n\t\tover_bits = (gfc.ResvSize - stuffingBits) - gfc.ResvMax;\n\t\tif (over_bits > 0) {\n\t\t\tstuffingBits += over_bits;\n\t\t}\n\n\t\t/*\n\t\t * NOTE: enabling the NEW_DRAIN code fixes some problems with FhG\n\t\t * decoder shipped with MS Windows operating systems. Using this, it is\n\t\t * even possible to use Gabriel's lax buffer consideration again, which\n\t\t * assumes, any decoder should have a buffer large enough for a 320 kbps\n\t\t * frame at 32 kHz sample rate.\n\t\t * \n\t\t * old drain code: lame -b320 BlackBird.wav --. does not play with\n\t\t * GraphEdit.exe using FhG decoder V1.5 Build 50\n\t\t * \n\t\t * new drain code: lame -b320 BlackBird.wav --. plays fine with\n\t\t * GraphEdit.exe using FhG decoder V1.5 Build 50\n\t\t * \n\t\t * Robert Hegemann, 2010-02-13.\n\t\t */\n\t\t/*\n\t\t * drain as many bits as possible into previous frame ancillary data In\n\t\t * particular, in VBR mode ResvMax may have changed, and we have to make\n\t\t * sure main_data_begin does not create a reservoir bigger than ResvMax\n\t\t * mt 4/00\n\t\t */\n\t\t{\n\t\t\tvar mdb_bytes = Math.min(l3_side.main_data_begin * 8, stuffingBits) / 8;\n\t\t\tl3_side.resvDrain_pre += 8 * mdb_bytes;\n\t\t\tstuffingBits -= 8 * mdb_bytes;\n\t\t\tgfc.ResvSize -= 8 * mdb_bytes;\n\t\t\tl3_side.main_data_begin -= mdb_bytes;\n\t\t}\n\t\t/* drain the rest into this frames ancillary data */\n\t\tl3_side.resvDrain_post += stuffingBits;\n\t\tgfc.ResvSize -= stuffingBits;\n\t}\n}\n\n\n/**\n * A Vbr header may be present in the ancillary data field of the first frame of\n * an mp3 bitstream<BR>\n * The Vbr header (optionally) contains\n * <UL>\n * <LI>frames total number of audio frames in the bitstream\n * <LI>bytes total number of bytes in the bitstream\n * <LI>toc table of contents\n * </UL>\n *\n * toc (table of contents) gives seek points for random access.<BR>\n * The ith entry determines the seek point for i-percent duration.<BR>\n * seek point in bytes = (toc[i]/256.0) * total_bitstream_bytes<BR>\n * e.g. half duration seek point = (toc[50]/256.0) * total_bitstream_bytes\n */\nVBRTag.NUMTOCENTRIES = 100;\nVBRTag.MAXFRAMESIZE = 2880;\n\nfunction VBRTag() {\n\n    var lame;\n    var bs;\n    var v;\n\n    this.setModules = function (_lame, _bs, _v) {\n        lame = _lame;\n        bs = _bs;\n        v = _v;\n    };\n\t\n\t//fix 精简\n\t\n    /**\n     * Lookup table for fast CRC-16 computation. Uses the polynomial\n     * x^16+x^15+x^2+1\n     */\n    var crc16Lookup = [0x0000, 0xC0C1, 0xC181, 0x0140,\n        0xC301, 0x03C0, 0x0280, 0xC241, 0xC601, 0x06C0, 0x0780, 0xC741,\n        0x0500, 0xC5C1, 0xC481, 0x0440, 0xCC01, 0x0CC0, 0x0D80, 0xCD41,\n        0x0F00, 0xCFC1, 0xCE81, 0x0E40, 0x0A00, 0xCAC1, 0xCB81, 0x0B40,\n        0xC901, 0x09C0, 0x0880, 0xC841, 0xD801, 0x18C0, 0x1980, 0xD941,\n        0x1B00, 0xDBC1, 0xDA81, 0x1A40, 0x1E00, 0xDEC1, 0xDF81, 0x1F40,\n        0xDD01, 0x1DC0, 0x1C80, 0xDC41, 0x1400, 0xD4C1, 0xD581, 0x1540,\n        0xD701, 0x17C0, 0x1680, 0xD641, 0xD201, 0x12C0, 0x1380, 0xD341,\n        0x1100, 0xD1C1, 0xD081, 0x1040, 0xF001, 0x30C0, 0x3180, 0xF141,\n        0x3300, 0xF3C1, 0xF281, 0x3240, 0x3600, 0xF6C1, 0xF781, 0x3740,\n        0xF501, 0x35C0, 0x3480, 0xF441, 0x3C00, 0xFCC1, 0xFD81, 0x3D40,\n        0xFF01, 0x3FC0, 0x3E80, 0xFE41, 0xFA01, 0x3AC0, 0x3B80, 0xFB41,\n        0x3900, 0xF9C1, 0xF881, 0x3840, 0x2800, 0xE8C1, 0xE981, 0x2940,\n        0xEB01, 0x2BC0, 0x2A80, 0xEA41, 0xEE01, 0x2EC0, 0x2F80, 0xEF41,\n        0x2D00, 0xEDC1, 0xEC81, 0x2C40, 0xE401, 0x24C0, 0x2580, 0xE541,\n        0x2700, 0xE7C1, 0xE681, 0x2640, 0x2200, 0xE2C1, 0xE381, 0x2340,\n        0xE101, 0x21C0, 0x2080, 0xE041, 0xA001, 0x60C0, 0x6180, 0xA141,\n        0x6300, 0xA3C1, 0xA281, 0x6240, 0x6600, 0xA6C1, 0xA781, 0x6740,\n        0xA501, 0x65C0, 0x6480, 0xA441, 0x6C00, 0xACC1, 0xAD81, 0x6D40,\n        0xAF01, 0x6FC0, 0x6E80, 0xAE41, 0xAA01, 0x6AC0, 0x6B80, 0xAB41,\n        0x6900, 0xA9C1, 0xA881, 0x6840, 0x7800, 0xB8C1, 0xB981, 0x7940,\n        0xBB01, 0x7BC0, 0x7A80, 0xBA41, 0xBE01, 0x7EC0, 0x7F80, 0xBF41,\n        0x7D00, 0xBDC1, 0xBC81, 0x7C40, 0xB401, 0x74C0, 0x7580, 0xB541,\n        0x7700, 0xB7C1, 0xB681, 0x7640, 0x7200, 0xB2C1, 0xB381, 0x7340,\n        0xB101, 0x71C0, 0x7080, 0xB041, 0x5000, 0x90C1, 0x9181, 0x5140,\n        0x9301, 0x53C0, 0x5280, 0x9241, 0x9601, 0x56C0, 0x5780, 0x9741,\n        0x5500, 0x95C1, 0x9481, 0x5440, 0x9C01, 0x5CC0, 0x5D80, 0x9D41,\n        0x5F00, 0x9FC1, 0x9E81, 0x5E40, 0x5A00, 0x9AC1, 0x9B81, 0x5B40,\n        0x9901, 0x59C0, 0x5880, 0x9841, 0x8801, 0x48C0, 0x4980, 0x8941,\n        0x4B00, 0x8BC1, 0x8A81, 0x4A40, 0x4E00, 0x8EC1, 0x8F81, 0x4F40,\n        0x8D01, 0x4DC0, 0x4C80, 0x8C41, 0x4400, 0x84C1, 0x8581, 0x4540,\n        0x8701, 0x47C0, 0x4680, 0x8641, 0x8201, 0x42C0, 0x4380, 0x8341,\n        0x4100, 0x81C1, 0x8081, 0x4040];\n\t\t\n\t//fix 精简\n\t\n    /**\n     * Fast CRC-16 computation (uses table crc16Lookup).\n     *\n     * @param value\n     * @param crc\n     * @return\n     */\n    function crcUpdateLookup(value, crc) {\n        var tmp = crc ^ value;\n        crc = (crc >> 8) ^ crc16Lookup[tmp & 0xff];\n        return crc;\n    }\n\n    this.updateMusicCRC = function (crc, buffer, bufferPos, size) {\n        for (var i = 0; i < size; ++i)\n            crc[0] = crcUpdateLookup(buffer[bufferPos + i], crc[0]);\n    }\n\n\t//fix 精简\n}\n\n\n\nBitStream.EQ = function (a, b) {\n    return (Math.abs(a) > Math.abs(b)) ? (Math.abs((a) - (b)) <= (Math\n        .abs(a) * 1e-6))\n        : (Math.abs((a) - (b)) <= (Math.abs(b) * 1e-6));\n};\n\nBitStream.NEQ = function (a, b) {\n    return !BitStream.EQ(a, b);\n};\n\nfunction BitStream() {\n    var self = this;\n    var CRC16_POLYNOMIAL = 0x8005;\n\n    /*\n     * we work with ints, so when doing bit manipulation, we limit ourselves to\n     * MAX_LENGTH-2 just to be on the safe side\n     */\n    var MAX_LENGTH = 32;\n\n    //GainAnalysis ga;\n    //MPGLib mpg;\n    //Version ver;\n    //VBRTag vbr;\n    var ga = null;\n    var mpg = null;\n    var ver = null;\n    var vbr = null;\n\n    //public final void setModules(GainAnalysis ga, MPGLib mpg, Version ver,\n    //\tVBRTag vbr) {\n\n    this.setModules = function (_ga, _mpg, _ver, _vbr) {\n        ga = _ga;\n        mpg = _mpg;\n        ver = _ver;\n        vbr = _vbr;\n    };\n\n    /**\n     * Bit stream buffer.\n     */\n    //private byte[] buf;\n    var buf = null;\n    /**\n     * Bit counter of bit stream.\n     */\n    var totbit = 0;\n    /**\n     * Pointer to top byte in buffer.\n     */\n    var bufByteIdx = 0;\n    /**\n     * Pointer to top bit of top byte in buffer.\n     */\n    var bufBitIdx = 0;\n\n    /**\n     * compute bitsperframe and mean_bits for a layer III frame\n     */\n    this.getframebits = function (gfp) {\n        var gfc = gfp.internal_flags;\n        var bit_rate;\n\n        /* get bitrate in kbps [?] */\n        if (gfc.bitrate_index != 0)\n            bit_rate = Tables.bitrate_table[gfp.version][gfc.bitrate_index];\n        else\n            bit_rate = gfp.brate;\n\n        /* main encoding routine toggles padding on and off */\n        /* one Layer3 Slot consists of 8 bits */\n        var bytes = 0 | (gfp.version + 1) * 72000 * bit_rate / gfp.out_samplerate + gfc.padding;\n        return 8 * bytes;\n    };\n\n    function putheader_bits(gfc) {\n        System.arraycopy(gfc.header[gfc.w_ptr].buf, 0, buf, bufByteIdx, gfc.sideinfo_len);\n        bufByteIdx += gfc.sideinfo_len;\n        totbit += gfc.sideinfo_len * 8;\n        gfc.w_ptr = (gfc.w_ptr + 1) & (LameInternalFlags.MAX_HEADER_BUF - 1);\n    }\n\n    /**\n     * write j bits into the bit stream\n     */\n    function putbits2(gfc, val, j) {\n\n\n        while (j > 0) {\n            var k;\n            if (bufBitIdx == 0) {\n                bufBitIdx = 8;\n                bufByteIdx++;\n                if (gfc.header[gfc.w_ptr].write_timing == totbit) {\n                    putheader_bits(gfc);\n                }\n                buf[bufByteIdx] = 0;\n            }\n\n            k = Math.min(j, bufBitIdx);\n            j -= k;\n\n            bufBitIdx -= k;\n\n            /* 32 too large on 32 bit machines */\n\n            buf[bufByteIdx] |= ((val >> j) << bufBitIdx);\n            totbit += k;\n        }\n    }\n\n    /**\n     * write j bits into the bit stream, ignoring frame headers\n     */\n    function putbits_noheaders(gfc, val, j) {\n\n        while (j > 0) {\n            var k;\n            if (bufBitIdx == 0) {\n                bufBitIdx = 8;\n                bufByteIdx++;\n                buf[bufByteIdx] = 0;\n            }\n\n            k = Math.min(j, bufBitIdx);\n            j -= k;\n\n            bufBitIdx -= k;\n\n            /* 32 too large on 32 bit machines */\n\n            buf[bufByteIdx] |= ((val >> j) << bufBitIdx);\n            totbit += k;\n        }\n    }\n\n    /**\n     * Some combinations of bitrate, Fs, and stereo make it impossible to stuff\n     * out a frame using just main_data, due to the limited number of bits to\n     * indicate main_data_length. In these situations, we put stuffing bits into\n     * the ancillary data...\n     */\n    function drain_into_ancillary(gfp, remainingBits) {\n        var gfc = gfp.internal_flags;\n        var i;\n\n        if (remainingBits >= 8) {\n            putbits2(gfc, 0x4c, 8);\n            remainingBits -= 8;\n        }\n        if (remainingBits >= 8) {\n            putbits2(gfc, 0x41, 8);\n            remainingBits -= 8;\n        }\n        if (remainingBits >= 8) {\n            putbits2(gfc, 0x4d, 8);\n            remainingBits -= 8;\n        }\n        if (remainingBits >= 8) {\n            putbits2(gfc, 0x45, 8);\n            remainingBits -= 8;\n        }\n\n        if (remainingBits >= 32) {\n            var version = ver.getLameShortVersion();\n            if (remainingBits >= 32)\n                for (i = 0; i < version.length && remainingBits >= 8; ++i) {\n                    remainingBits -= 8;\n                    putbits2(gfc, version.charCodeAt(i), 8); //fix 错误的使用charAt\n                }\n        }\n\n        for (; remainingBits >= 1; remainingBits -= 1) {\n            putbits2(gfc, gfc.ancillary_flag, 1);\n            gfc.ancillary_flag ^= (!gfp.disable_reservoir ? 1 : 0);\n        }\n\n\n    }\n\n    /**\n     * write N bits into the header\n     */\n    function writeheader(gfc, val, j) {\n        var ptr = gfc.header[gfc.h_ptr].ptr;\n\n        while (j > 0) {\n            var k = Math.min(j, 8 - (ptr & 7));\n            j -= k;\n            /* >> 32 too large for 32 bit machines */\n\n            gfc.header[gfc.h_ptr].buf[ptr >> 3] |= ((val >> j)) << (8 - (ptr & 7) - k);\n            ptr += k;\n        }\n        gfc.header[gfc.h_ptr].ptr = ptr;\n    }\n\n    function CRC_update(value, crc) {\n        value <<= 8;\n        for (var i = 0; i < 8; i++) {\n            value <<= 1;\n            crc <<= 1;\n\n            if ((((crc ^ value) & 0x10000) != 0))\n                crc ^= CRC16_POLYNOMIAL;\n        }\n        return crc;\n    }\n\n    this.CRC_writeheader = function (gfc, header) {\n        var crc = 0xffff;\n        /* (jo) init crc16 for error_protection */\n\n        crc = CRC_update(header[2] & 0xff, crc);\n        crc = CRC_update(header[3] & 0xff, crc);\n        for (var i = 6; i < gfc.sideinfo_len; i++) {\n            crc = CRC_update(header[i] & 0xff, crc);\n        }\n\n        header[4] = (byte)(crc >> 8);\n        header[5] = (byte)(crc & 255);\n    };\n\n    function encodeSideInfo2(gfp, bitsPerFrame) {\n        var gfc = gfp.internal_flags;\n        var l3_side;\n        var gr, ch;\n\n        l3_side = gfc.l3_side;\n        gfc.header[gfc.h_ptr].ptr = 0;\n        Arrays.fill(gfc.header[gfc.h_ptr].buf, 0, gfc.sideinfo_len, 0);\n        if (gfp.out_samplerate < 16000)\n            writeheader(gfc, 0xffe, 12);\n        else\n            writeheader(gfc, 0xfff, 12);\n        writeheader(gfc, (gfp.version), 1);\n        writeheader(gfc, 4 - 3, 2);\n        writeheader(gfc, (!gfp.error_protection ? 1 : 0), 1);\n        writeheader(gfc, (gfc.bitrate_index), 4);\n        writeheader(gfc, (gfc.samplerate_index), 2);\n        writeheader(gfc, (gfc.padding), 1);\n        writeheader(gfc, (gfp.extension), 1);\n        writeheader(gfc, (gfp.mode.ordinal()), 2);\n        writeheader(gfc, (gfc.mode_ext), 2);\n        writeheader(gfc, (gfp.copyright), 1);\n        writeheader(gfc, (gfp.original), 1);\n        writeheader(gfc, (gfp.emphasis), 2);\n        if (gfp.error_protection) {\n            writeheader(gfc, 0, 16);\n            /* dummy */\n        }\n\n        if (gfp.version == 1) {\n            /* MPEG1 */\n            writeheader(gfc, (l3_side.main_data_begin), 9);\n\n            if (gfc.channels_out == 2)\n                writeheader(gfc, l3_side.private_bits, 3);\n            else\n                writeheader(gfc, l3_side.private_bits, 5);\n\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                var band;\n                for (band = 0; band < 4; band++) {\n                    writeheader(gfc, l3_side.scfsi[ch][band], 1);\n                }\n            }\n\n            for (gr = 0; gr < 2; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    var gi = l3_side.tt[gr][ch];\n                    writeheader(gfc, gi.part2_3_length + gi.part2_length, 12);\n                    writeheader(gfc, gi.big_values / 2, 9);\n                    writeheader(gfc, gi.global_gain, 8);\n                    writeheader(gfc, gi.scalefac_compress, 4);\n\n                    if (gi.block_type != Encoder.NORM_TYPE) {\n                        writeheader(gfc, 1, 1);\n                        /* window_switching_flag */\n                        writeheader(gfc, gi.block_type, 2);\n                        writeheader(gfc, gi.mixed_block_flag, 1);\n\n                        if (gi.table_select[0] == 14)\n                            gi.table_select[0] = 16;\n                        writeheader(gfc, gi.table_select[0], 5);\n                        if (gi.table_select[1] == 14)\n                            gi.table_select[1] = 16;\n                        writeheader(gfc, gi.table_select[1], 5);\n\n                        writeheader(gfc, gi.subblock_gain[0], 3);\n                        writeheader(gfc, gi.subblock_gain[1], 3);\n                        writeheader(gfc, gi.subblock_gain[2], 3);\n                    } else {\n                        writeheader(gfc, 0, 1);\n                        /* window_switching_flag */\n                        if (gi.table_select[0] == 14)\n                            gi.table_select[0] = 16;\n                        writeheader(gfc, gi.table_select[0], 5);\n                        if (gi.table_select[1] == 14)\n                            gi.table_select[1] = 16;\n                        writeheader(gfc, gi.table_select[1], 5);\n                        if (gi.table_select[2] == 14)\n                            gi.table_select[2] = 16;\n                        writeheader(gfc, gi.table_select[2], 5);\n\n                        writeheader(gfc, gi.region0_count, 4);\n                        writeheader(gfc, gi.region1_count, 3);\n                    }\n                    writeheader(gfc, gi.preflag, 1);\n                    writeheader(gfc, gi.scalefac_scale, 1);\n                    writeheader(gfc, gi.count1table_select, 1);\n                }\n            }\n        } else {\n            /* MPEG2 */\n            writeheader(gfc, (l3_side.main_data_begin), 8);\n            writeheader(gfc, l3_side.private_bits, gfc.channels_out);\n\n            gr = 0;\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                var gi = l3_side.tt[gr][ch];\n                writeheader(gfc, gi.part2_3_length + gi.part2_length, 12);\n                writeheader(gfc, gi.big_values / 2, 9);\n                writeheader(gfc, gi.global_gain, 8);\n                writeheader(gfc, gi.scalefac_compress, 9);\n\n                if (gi.block_type != Encoder.NORM_TYPE) {\n                    writeheader(gfc, 1, 1);\n                    /* window_switching_flag */\n                    writeheader(gfc, gi.block_type, 2);\n                    writeheader(gfc, gi.mixed_block_flag, 1);\n\n                    if (gi.table_select[0] == 14)\n                        gi.table_select[0] = 16;\n                    writeheader(gfc, gi.table_select[0], 5);\n                    if (gi.table_select[1] == 14)\n                        gi.table_select[1] = 16;\n                    writeheader(gfc, gi.table_select[1], 5);\n\n                    writeheader(gfc, gi.subblock_gain[0], 3);\n                    writeheader(gfc, gi.subblock_gain[1], 3);\n                    writeheader(gfc, gi.subblock_gain[2], 3);\n                } else {\n                    writeheader(gfc, 0, 1);\n                    /* window_switching_flag */\n                    if (gi.table_select[0] == 14)\n                        gi.table_select[0] = 16;\n                    writeheader(gfc, gi.table_select[0], 5);\n                    if (gi.table_select[1] == 14)\n                        gi.table_select[1] = 16;\n                    writeheader(gfc, gi.table_select[1], 5);\n                    if (gi.table_select[2] == 14)\n                        gi.table_select[2] = 16;\n                    writeheader(gfc, gi.table_select[2], 5);\n\n                    writeheader(gfc, gi.region0_count, 4);\n                    writeheader(gfc, gi.region1_count, 3);\n                }\n\n                writeheader(gfc, gi.scalefac_scale, 1);\n                writeheader(gfc, gi.count1table_select, 1);\n            }\n        }\n\n        if (gfp.error_protection) {\n            /* (jo) error_protection: add crc16 information to header */\n            CRC_writeheader(gfc, gfc.header[gfc.h_ptr].buf);\n        }\n\n        {\n            var old = gfc.h_ptr;\n\n            gfc.h_ptr = (old + 1) & (LameInternalFlags.MAX_HEADER_BUF - 1);\n            gfc.header[gfc.h_ptr].write_timing = gfc.header[old].write_timing\n                + bitsPerFrame;\n\n            if (gfc.h_ptr == gfc.w_ptr) {\n                /* yikes! we are out of header buffer space */\n                System.err\n                    .println(\"Error: MAX_HEADER_BUF too small in bitstream.c \\n\");\n            }\n\n        }\n    }\n\n    function huffman_coder_count1(gfc, gi) {\n        /* Write count1 area */\n        var h = Tables.ht[gi.count1table_select + 32];\n        var i, bits = 0;\n\n        var ix = gi.big_values;\n        var xr = gi.big_values;\n\n        for (i = (gi.count1 - gi.big_values) / 4; i > 0; --i) {\n            var huffbits = 0;\n            var p = 0, v;\n\n            v = gi.l3_enc[ix + 0];\n            if (v != 0) {\n                p += 8;\n                if (gi.xr[xr + 0] < 0)\n                    huffbits++;\n            }\n\n            v = gi.l3_enc[ix + 1];\n            if (v != 0) {\n                p += 4;\n                huffbits *= 2;\n                if (gi.xr[xr + 1] < 0)\n                    huffbits++;\n            }\n\n            v = gi.l3_enc[ix + 2];\n            if (v != 0) {\n                p += 2;\n                huffbits *= 2;\n                if (gi.xr[xr + 2] < 0)\n                    huffbits++;\n            }\n\n            v = gi.l3_enc[ix + 3];\n            if (v != 0) {\n                p++;\n                huffbits *= 2;\n                if (gi.xr[xr + 3] < 0)\n                    huffbits++;\n            }\n\n            ix += 4;\n            xr += 4;\n            putbits2(gfc, huffbits + h.table[p], h.hlen[p]);\n            bits += h.hlen[p];\n        }\n        return bits;\n    }\n\n    /**\n     * Implements the pseudocode of page 98 of the IS\n     */\n    function Huffmancode(gfc, tableindex, start, end, gi) {\n        var h = Tables.ht[tableindex];\n        var bits = 0;\n\n        if (0 == tableindex)\n            return bits;\n\n        for (var i = start; i < end; i += 2) {\n            var cbits = 0;\n            var xbits = 0;\n            var linbits = h.xlen;\n            var xlen = h.xlen;\n            var ext = 0;\n            var x1 = gi.l3_enc[i];\n            var x2 = gi.l3_enc[i + 1];\n\n            if (x1 != 0) {\n                if (gi.xr[i] < 0)\n                    ext++;\n                cbits--;\n            }\n\n            if (tableindex > 15) {\n                /* use ESC-words */\n                if (x1 > 14) {\n                    var linbits_x1 = x1 - 15;\n                    ext |= linbits_x1 << 1;\n                    xbits = linbits;\n                    x1 = 15;\n                }\n\n                if (x2 > 14) {\n                    var linbits_x2 = x2 - 15;\n                    ext <<= linbits;\n                    ext |= linbits_x2;\n                    xbits += linbits;\n                    x2 = 15;\n                }\n                xlen = 16;\n            }\n\n            if (x2 != 0) {\n                ext <<= 1;\n                if (gi.xr[i + 1] < 0)\n                    ext++;\n                cbits--;\n            }\n\n\n            x1 = x1 * xlen + x2;\n            xbits -= cbits;\n            cbits += h.hlen[x1];\n\n\n            putbits2(gfc, h.table[x1], cbits);\n            putbits2(gfc, ext, xbits);\n            bits += cbits + xbits;\n        }\n        return bits;\n    }\n\n    /**\n     * Note the discussion of huffmancodebits() on pages 28 and 29 of the IS, as\n     * well as the definitions of the side information on pages 26 and 27.\n     */\n    function ShortHuffmancodebits(gfc, gi) {\n        var region1Start = 3 * gfc.scalefac_band.s[3];\n        if (region1Start > gi.big_values)\n            region1Start = gi.big_values;\n\n        /* short blocks do not have a region2 */\n        var bits = Huffmancode(gfc, gi.table_select[0], 0, region1Start, gi);\n        bits += Huffmancode(gfc, gi.table_select[1], region1Start,\n            gi.big_values, gi);\n        return bits;\n    }\n\n    function LongHuffmancodebits(gfc, gi) {\n        var bigvalues, bits;\n        var region1Start, region2Start;\n\n        bigvalues = gi.big_values;\n\n        var i = gi.region0_count + 1;\n        region1Start = gfc.scalefac_band.l[i];\n        i += gi.region1_count + 1;\n        region2Start = gfc.scalefac_band.l[i];\n\n        if (region1Start > bigvalues)\n            region1Start = bigvalues;\n\n        if (region2Start > bigvalues)\n            region2Start = bigvalues;\n\n        bits = Huffmancode(gfc, gi.table_select[0], 0, region1Start, gi);\n        bits += Huffmancode(gfc, gi.table_select[1], region1Start,\n            region2Start, gi);\n        bits += Huffmancode(gfc, gi.table_select[2], region2Start, bigvalues,\n            gi);\n        return bits;\n    }\n\n    function writeMainData(gfp) {\n        var gr, ch, sfb, data_bits, tot_bits = 0;\n        var gfc = gfp.internal_flags;\n        var l3_side = gfc.l3_side;\n\n        if (gfp.version == 1) {\n            /* MPEG 1 */\n            for (gr = 0; gr < 2; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    var gi = l3_side.tt[gr][ch];\n                    var slen1 = Takehiro.slen1_tab[gi.scalefac_compress];\n                    var slen2 = Takehiro.slen2_tab[gi.scalefac_compress];\n                    data_bits = 0;\n                    for (sfb = 0; sfb < gi.sfbdivide; sfb++) {\n                        if (gi.scalefac[sfb] == -1)\n                            continue;\n                        /* scfsi is used */\n                        putbits2(gfc, gi.scalefac[sfb], slen1);\n                        data_bits += slen1;\n                    }\n                    for (; sfb < gi.sfbmax; sfb++) {\n                        if (gi.scalefac[sfb] == -1)\n                            continue;\n                        /* scfsi is used */\n                        putbits2(gfc, gi.scalefac[sfb], slen2);\n                        data_bits += slen2;\n                    }\n\n                    if (gi.block_type == Encoder.SHORT_TYPE) {\n                        data_bits += ShortHuffmancodebits(gfc, gi);\n                    } else {\n                        data_bits += LongHuffmancodebits(gfc, gi);\n                    }\n                    data_bits += huffman_coder_count1(gfc, gi);\n                    /* does bitcount in quantize.c agree with actual bit count? */\n                    tot_bits += data_bits;\n                }\n                /* for ch */\n            }\n            /* for gr */\n        } else {\n            /* MPEG 2 */\n            gr = 0;\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                var gi = l3_side.tt[gr][ch];\n                var i, sfb_partition, scale_bits = 0;\n                data_bits = 0;\n                sfb = 0;\n                sfb_partition = 0;\n\n                if (gi.block_type == Encoder.SHORT_TYPE) {\n                    for (; sfb_partition < 4; sfb_partition++) {\n                        var sfbs = gi.sfb_partition_table[sfb_partition] / 3;\n                        var slen = gi.slen[sfb_partition];\n                        for (i = 0; i < sfbs; i++, sfb++) {\n                            putbits2(gfc,\n                                Math.max(gi.scalefac[sfb * 3 + 0], 0), slen);\n                            putbits2(gfc,\n                                Math.max(gi.scalefac[sfb * 3 + 1], 0), slen);\n                            putbits2(gfc,\n                                Math.max(gi.scalefac[sfb * 3 + 2], 0), slen);\n                            scale_bits += 3 * slen;\n                        }\n                    }\n                    data_bits += ShortHuffmancodebits(gfc, gi);\n                } else {\n                    for (; sfb_partition < 4; sfb_partition++) {\n                        var sfbs = gi.sfb_partition_table[sfb_partition];\n                        var slen = gi.slen[sfb_partition];\n                        for (i = 0; i < sfbs; i++, sfb++) {\n                            putbits2(gfc, Math.max(gi.scalefac[sfb], 0), slen);\n                            scale_bits += slen;\n                        }\n                    }\n                    data_bits += LongHuffmancodebits(gfc, gi);\n                }\n                data_bits += huffman_coder_count1(gfc, gi);\n                /* does bitcount in quantize.c agree with actual bit count? */\n                tot_bits += scale_bits + data_bits;\n            }\n            /* for ch */\n        }\n        /* for gf */\n        return tot_bits;\n    }\n\n    /* main_data */\n\n    function TotalBytes() {\n        this.total = 0;\n    }\n\n    /*\n     * compute the number of bits required to flush all mp3 frames currently in\n     * the buffer. This should be the same as the reservoir size. Only call this\n     * routine between frames - i.e. only after all headers and data have been\n     * added to the buffer by format_bitstream().\n     *\n     * Also compute total_bits_output = size of mp3 buffer (including frame\n     * headers which may not have yet been send to the mp3 buffer) + number of\n     * bits needed to flush all mp3 frames.\n     *\n     * total_bytes_output is the size of the mp3 output buffer if\n     * lame_encode_flush_nogap() was called right now.\n     */\n    function compute_flushbits(gfp, total_bytes_output) {\n        var gfc = gfp.internal_flags;\n        var flushbits, remaining_headers;\n        var bitsPerFrame;\n        var last_ptr, first_ptr;\n        first_ptr = gfc.w_ptr;\n        /* first header to add to bitstream */\n        last_ptr = gfc.h_ptr - 1;\n        /* last header to add to bitstream */\n        if (last_ptr == -1)\n            last_ptr = LameInternalFlags.MAX_HEADER_BUF - 1;\n\n        /* add this many bits to bitstream so we can flush all headers */\n        flushbits = gfc.header[last_ptr].write_timing - totbit;\n        total_bytes_output.total = flushbits;\n\n        if (flushbits >= 0) {\n            /* if flushbits >= 0, some headers have not yet been written */\n            /* reduce flushbits by the size of the headers */\n            remaining_headers = 1 + last_ptr - first_ptr;\n            if (last_ptr < first_ptr)\n                remaining_headers = 1 + last_ptr - first_ptr\n                    + LameInternalFlags.MAX_HEADER_BUF;\n            flushbits -= remaining_headers * 8 * gfc.sideinfo_len;\n        }\n\n        /*\n         * finally, add some bits so that the last frame is complete these bits\n         * are not necessary to decode the last frame, but some decoders will\n         * ignore last frame if these bits are missing\n         */\n        bitsPerFrame = self.getframebits(gfp);\n        flushbits += bitsPerFrame;\n        total_bytes_output.total += bitsPerFrame;\n        /* round up: */\n        if ((total_bytes_output.total % 8) != 0)\n            total_bytes_output.total = 1 + (total_bytes_output.total / 8);\n        else\n            total_bytes_output.total = (total_bytes_output.total / 8);\n        total_bytes_output.total += bufByteIdx + 1;\n\n        if (flushbits < 0) {\n            System.err.println(\"strange error flushing buffer ... \\n\");\n        }\n        return flushbits;\n    }\n\n    this.flush_bitstream = function (gfp) {\n        var gfc = gfp.internal_flags;\n        var l3_side;\n        var flushbits;\n        var last_ptr = gfc.h_ptr - 1;\n        /* last header to add to bitstream */\n        if (last_ptr == -1)\n            last_ptr = LameInternalFlags.MAX_HEADER_BUF - 1;\n        l3_side = gfc.l3_side;\n\n        if ((flushbits = compute_flushbits(gfp, new TotalBytes())) < 0)\n            return;\n        drain_into_ancillary(gfp, flushbits);\n\n        /* check that the 100% of the last frame has been written to bitstream */\n\n        /*\n         * we have padded out all frames with ancillary data, which is the same\n         * as filling the bitreservoir with ancillary data, so :\n         */\n        gfc.ResvSize = 0;\n        l3_side.main_data_begin = 0;\n\n        /* save the ReplayGain value */\n        if (gfc.findReplayGain) {\n            var RadioGain = ga.GetTitleGain(gfc.rgdata);\n            gfc.RadioGain = Math.floor(RadioGain * 10.0 + 0.5) | 0;\n            /* round to nearest */\n        }\n\n        /* find the gain and scale change required for no clipping */\n        if (gfc.findPeakSample) {\n            gfc.noclipGainChange = Math.ceil(\n                        Math_log10(gfc.PeakSample / 32767.0) * 20.0 * 10.0) | 0;\n            /* round up */\n\n            if (gfc.noclipGainChange > 0) {\n                /* clipping occurs */\n                if (EQ(gfp.scale, 1.0) || EQ(gfp.scale, 0.0))\n                    gfc.noclipScale = (Math\n                        .floor((32767.0 / gfc.PeakSample) * 100.0) / 100.0);\n                /* round down */\n                else {\n                    /*\n                     * the user specified his own scaling factor. We could\n                     * suggest the scaling factor of\n                     * (32767.0/gfp.PeakSample)*(gfp.scale) but it's usually\n                     * very inaccurate. So we'd rather not advice him on the\n                     * scaling factor.\n                     */\n                    gfc.noclipScale = -1;\n                }\n            } else\n            /* no clipping */\n                gfc.noclipScale = -1;\n        }\n    };\n\n    this.add_dummy_byte = function (gfp, val, n) {\n        var gfc = gfp.internal_flags;\n        var i;\n\n        while (n-- > 0) {\n            putbits_noheaders(gfc, val, 8);\n\n            for (i = 0; i < LameInternalFlags.MAX_HEADER_BUF; ++i)\n                gfc.header[i].write_timing += 8;\n        }\n    };\n\n    /**\n     * This is called after a frame of audio has been quantized and coded. It\n     * will write the encoded audio to the bitstream. Note that from a layer3\n     * encoder's perspective the bit stream is primarily a series of main_data()\n     * blocks, with header and side information inserted at the proper locations\n     * to maintain framing. (See Figure A.7 in the IS).\n     */\n    this.format_bitstream = function (gfp) {\n        var gfc = gfp.internal_flags;\n        var l3_side;\n        l3_side = gfc.l3_side;\n\n        var bitsPerFrame = this.getframebits(gfp);\n        drain_into_ancillary(gfp, l3_side.resvDrain_pre);\n\n        encodeSideInfo2(gfp, bitsPerFrame);\n        var bits = 8 * gfc.sideinfo_len;\n        bits += writeMainData(gfp);\n        drain_into_ancillary(gfp, l3_side.resvDrain_post);\n        bits += l3_side.resvDrain_post;\n\n        l3_side.main_data_begin += (bitsPerFrame - bits) / 8;\n\n        /*\n         * compare number of bits needed to clear all buffered mp3 frames with\n         * what we think the resvsize is:\n         */\n        if (compute_flushbits(gfp, new TotalBytes()) != gfc.ResvSize) {\n            System.err.println(\"Internal buffer inconsistency. flushbits <> ResvSize\");\n        }\n\n        /*\n         * compare main_data_begin for the next frame with what we think the\n         * resvsize is:\n         */\n        if ((l3_side.main_data_begin * 8) != gfc.ResvSize) {\n            System.err.printf(\"bit reservoir error: \\n\"\n                + \"l3_side.main_data_begin: %d \\n\"\n                + \"Resvoir size:             %d \\n\"\n                + \"resv drain (post)         %d \\n\"\n                + \"resv drain (pre)          %d \\n\"\n                + \"header and sideinfo:      %d \\n\"\n                + \"data bits:                %d \\n\"\n                + \"total bits:               %d (remainder: %d) \\n\"\n                + \"bitsperframe:             %d \\n\",\n                8 * l3_side.main_data_begin, gfc.ResvSize,\n                l3_side.resvDrain_post, l3_side.resvDrain_pre,\n                8 * gfc.sideinfo_len, bits - l3_side.resvDrain_post - 8\n                * gfc.sideinfo_len, bits, bits % 8, bitsPerFrame);\n\n            System.err.println(\"This is a fatal error.  It has several possible causes:\");\n            System.err.println(\"90%%  LAME compiled with buggy version of gcc using advanced optimizations\");\n            System.err.println(\" 9%%  Your system is overclocked\");\n            System.err.println(\" 1%%  bug in LAME encoding library\");\n\n            gfc.ResvSize = l3_side.main_data_begin * 8;\n        }\n        //;\n\n        if (totbit > 1000000000) {\n            /*\n             * to avoid totbit overflow, (at 8h encoding at 128kbs) lets reset\n             * bit counter\n             */\n            var i;\n            for (i = 0; i < LameInternalFlags.MAX_HEADER_BUF; ++i)\n                gfc.header[i].write_timing -= totbit;\n            totbit = 0;\n        }\n\n        return 0;\n    };\n\n    /**\n     * <PRE>\n     * copy data out of the internal MP3 bit buffer into a user supplied\n     *       unsigned char buffer.\n     *\n     *       mp3data=0      indicates data in buffer is an id3tags and VBR tags\n     *       mp3data=1      data is real mp3 frame data.\n     * </PRE>\n     */\n    this.copy_buffer = function (gfc, buffer, bufferPos, size, mp3data) {\n        var minimum = bufByteIdx + 1;\n        if (minimum <= 0)\n            return 0;\n        if (size != 0 && minimum > size) {\n            /* buffer is too small */\n            return -1;\n        }\n        System.arraycopy(buf, 0, buffer, bufferPos, minimum);\n        bufByteIdx = -1;\n        bufBitIdx = 0;\n\n        if (mp3data != 0) {\n            var crc = new_int(1);\n            crc[0] = gfc.nMusicCRC;\n            vbr.updateMusicCRC(crc, buffer, bufferPos, minimum);\n            gfc.nMusicCRC = crc[0];\n\n            /**\n             * sum number of bytes belonging to the mp3 stream this info will be\n             * written into the Xing/LAME header for seeking\n             */\n            if (minimum > 0) {\n                gfc.VBR_seek_table.nBytesWritten += minimum;\n            }\n\n            if (gfc.decode_on_the_fly) { /* decode the frame */\n                var pcm_buf = new_float_n([2, 1152]);\n                var mp3_in = minimum;\n                var samples_out = -1;\n                var i;\n\n                /* re-synthesis to pcm. Repeat until we get a samples_out=0 */\n                while (samples_out != 0) {\n\n                    samples_out = mpg.hip_decode1_unclipped(gfc.hip, buffer,\n                        bufferPos, mp3_in, pcm_buf[0], pcm_buf[1]);\n                    /*\n                     * samples_out = 0: need more data to decode samples_out =\n                     * -1: error. Lets assume 0 pcm output samples_out = number\n                     * of samples output\n                     */\n\n                    /*\n                     * set the lenght of the mp3 input buffer to zero, so that\n                     * in the next iteration of the loop we will be querying\n                     * mpglib about buffered data\n                     */\n                    mp3_in = 0;\n\n                    if (samples_out == -1) {\n                        /*\n                         * error decoding. Not fatal, but might screw up the\n                         * ReplayGain tag. What should we do? Ignore for now\n                         */\n                        samples_out = 0;\n                    }\n                    if (samples_out > 0) {\n                        /* process the PCM data */\n\n                        /*\n                         * this should not be possible, and indicates we have\n                         * overflown the pcm_buf buffer\n                         */\n\n                        if (gfc.findPeakSample) {\n                            for (i = 0; i < samples_out; i++) {\n                                if (pcm_buf[0][i] > gfc.PeakSample)\n                                    gfc.PeakSample = pcm_buf[0][i];\n                                else if (-pcm_buf[0][i] > gfc.PeakSample)\n                                    gfc.PeakSample = -pcm_buf[0][i];\n                            }\n                            if (gfc.channels_out > 1)\n                                for (i = 0; i < samples_out; i++) {\n                                    if (pcm_buf[1][i] > gfc.PeakSample)\n                                        gfc.PeakSample = pcm_buf[1][i];\n                                    else if (-pcm_buf[1][i] > gfc.PeakSample)\n                                        gfc.PeakSample = -pcm_buf[1][i];\n                                }\n                        }\n\n                        if (gfc.findReplayGain)\n                            if (ga.AnalyzeSamples(gfc.rgdata, pcm_buf[0], 0,\n                                    pcm_buf[1], 0, samples_out,\n                                    gfc.channels_out) == GainAnalysis.GAIN_ANALYSIS_ERROR)\n                                return -6;\n\n                    }\n                    /* if (samples_out>0) */\n                }\n                /* while (samples_out!=0) */\n            }\n            /* if (gfc.decode_on_the_fly) */\n\n        }\n        /* if (mp3data) */\n        return minimum;\n    };\n\n    this.init_bit_stream_w = function (gfc) {\n        buf = new_byte(Lame.LAME_MAXMP3BUFFER);\n\n        gfc.h_ptr = gfc.w_ptr = 0;\n        gfc.header[gfc.h_ptr].write_timing = 0;\n        bufByteIdx = -1;\n        bufBitIdx = 0;\n        totbit = 0;\n    };\n\n    // From machine.h\n\n\n}\n\nfunction HuffCodeTab(len, max, tab, hl) {\n    this.xlen = len;\n    this.linmax = max;\n    this.table = tab;\n    this.hlen = hl;\n}\n\nvar Tables = {};\n\n\nTables.t1HB = [\n    1, 1,\n    1, 0\n];\n\nTables.t2HB = [\n    1, 2, 1,\n    3, 1, 1,\n    3, 2, 0\n];\n\nTables.t3HB = [\n    3, 2, 1,\n    1, 1, 1,\n    3, 2, 0\n];\n\nTables.t5HB = [\n    1, 2, 6, 5,\n    3, 1, 4, 4,\n    7, 5, 7, 1,\n    6, 1, 1, 0\n];\n\nTables.t6HB = [\n    7, 3, 5, 1,\n    6, 2, 3, 2,\n    5, 4, 4, 1,\n    3, 3, 2, 0\n];\n\nTables.t7HB = [\n    1, 2, 10, 19, 16, 10,\n    3, 3, 7, 10, 5, 3,\n    11, 4, 13, 17, 8, 4,\n    12, 11, 18, 15, 11, 2,\n    7, 6, 9, 14, 3, 1,\n    6, 4, 5, 3, 2, 0\n];\n\nTables.t8HB = [\n    3, 4, 6, 18, 12, 5,\n    5, 1, 2, 16, 9, 3,\n    7, 3, 5, 14, 7, 3,\n    19, 17, 15, 13, 10, 4,\n    13, 5, 8, 11, 5, 1,\n    12, 4, 4, 1, 1, 0\n];\n\nTables.t9HB = [\n    7, 5, 9, 14, 15, 7,\n    6, 4, 5, 5, 6, 7,\n    7, 6, 8, 8, 8, 5,\n    15, 6, 9, 10, 5, 1,\n    11, 7, 9, 6, 4, 1,\n    14, 4, 6, 2, 6, 0\n];\n\nTables.t10HB = [\n    1, 2, 10, 23, 35, 30, 12, 17,\n    3, 3, 8, 12, 18, 21, 12, 7,\n    11, 9, 15, 21, 32, 40, 19, 6,\n    14, 13, 22, 34, 46, 23, 18, 7,\n    20, 19, 33, 47, 27, 22, 9, 3,\n    31, 22, 41, 26, 21, 20, 5, 3,\n    14, 13, 10, 11, 16, 6, 5, 1,\n    9, 8, 7, 8, 4, 4, 2, 0\n];\n\nTables.t11HB = [\n    3, 4, 10, 24, 34, 33, 21, 15,\n    5, 3, 4, 10, 32, 17, 11, 10,\n    11, 7, 13, 18, 30, 31, 20, 5,\n    25, 11, 19, 59, 27, 18, 12, 5,\n    35, 33, 31, 58, 30, 16, 7, 5,\n    28, 26, 32, 19, 17, 15, 8, 14,\n    14, 12, 9, 13, 14, 9, 4, 1,\n    11, 4, 6, 6, 6, 3, 2, 0\n];\n\nTables.t12HB = [\n    9, 6, 16, 33, 41, 39, 38, 26,\n    7, 5, 6, 9, 23, 16, 26, 11,\n    17, 7, 11, 14, 21, 30, 10, 7,\n    17, 10, 15, 12, 18, 28, 14, 5,\n    32, 13, 22, 19, 18, 16, 9, 5,\n    40, 17, 31, 29, 17, 13, 4, 2,\n    27, 12, 11, 15, 10, 7, 4, 1,\n    27, 12, 8, 12, 6, 3, 1, 0\n];\n\nTables.t13HB = [\n    1, 5, 14, 21, 34, 51, 46, 71, 42, 52, 68, 52, 67, 44, 43, 19,\n    3, 4, 12, 19, 31, 26, 44, 33, 31, 24, 32, 24, 31, 35, 22, 14,\n    15, 13, 23, 36, 59, 49, 77, 65, 29, 40, 30, 40, 27, 33, 42, 16,\n    22, 20, 37, 61, 56, 79, 73, 64, 43, 76, 56, 37, 26, 31, 25, 14,\n    35, 16, 60, 57, 97, 75, 114, 91, 54, 73, 55, 41, 48, 53, 23, 24,\n    58, 27, 50, 96, 76, 70, 93, 84, 77, 58, 79, 29, 74, 49, 41, 17,\n    47, 45, 78, 74, 115, 94, 90, 79, 69, 83, 71, 50, 59, 38, 36, 15,\n    72, 34, 56, 95, 92, 85, 91, 90, 86, 73, 77, 65, 51, 44, 43, 42,\n    43, 20, 30, 44, 55, 78, 72, 87, 78, 61, 46, 54, 37, 30, 20, 16,\n    53, 25, 41, 37, 44, 59, 54, 81, 66, 76, 57, 54, 37, 18, 39, 11,\n    35, 33, 31, 57, 42, 82, 72, 80, 47, 58, 55, 21, 22, 26, 38, 22,\n    53, 25, 23, 38, 70, 60, 51, 36, 55, 26, 34, 23, 27, 14, 9, 7,\n    34, 32, 28, 39, 49, 75, 30, 52, 48, 40, 52, 28, 18, 17, 9, 5,\n    45, 21, 34, 64, 56, 50, 49, 45, 31, 19, 12, 15, 10, 7, 6, 3,\n    48, 23, 20, 39, 36, 35, 53, 21, 16, 23, 13, 10, 6, 1, 4, 2,\n    16, 15, 17, 27, 25, 20, 29, 11, 17, 12, 16, 8, 1, 1, 0, 1\n];\n\nTables.t15HB = [\n    7, 12, 18, 53, 47, 76, 124, 108, 89, 123, 108, 119, 107, 81, 122, 63,\n    13, 5, 16, 27, 46, 36, 61, 51, 42, 70, 52, 83, 65, 41, 59, 36,\n    19, 17, 15, 24, 41, 34, 59, 48, 40, 64, 50, 78, 62, 80, 56, 33,\n    29, 28, 25, 43, 39, 63, 55, 93, 76, 59, 93, 72, 54, 75, 50, 29,\n    52, 22, 42, 40, 67, 57, 95, 79, 72, 57, 89, 69, 49, 66, 46, 27,\n    77, 37, 35, 66, 58, 52, 91, 74, 62, 48, 79, 63, 90, 62, 40, 38,\n    125, 32, 60, 56, 50, 92, 78, 65, 55, 87, 71, 51, 73, 51, 70, 30,\n    109, 53, 49, 94, 88, 75, 66, 122, 91, 73, 56, 42, 64, 44, 21, 25,\n    90, 43, 41, 77, 73, 63, 56, 92, 77, 66, 47, 67, 48, 53, 36, 20,\n    71, 34, 67, 60, 58, 49, 88, 76, 67, 106, 71, 54, 38, 39, 23, 15,\n    109, 53, 51, 47, 90, 82, 58, 57, 48, 72, 57, 41, 23, 27, 62, 9,\n    86, 42, 40, 37, 70, 64, 52, 43, 70, 55, 42, 25, 29, 18, 11, 11,\n    118, 68, 30, 55, 50, 46, 74, 65, 49, 39, 24, 16, 22, 13, 14, 7,\n    91, 44, 39, 38, 34, 63, 52, 45, 31, 52, 28, 19, 14, 8, 9, 3,\n    123, 60, 58, 53, 47, 43, 32, 22, 37, 24, 17, 12, 15, 10, 2, 1,\n    71, 37, 34, 30, 28, 20, 17, 26, 21, 16, 10, 6, 8, 6, 2, 0\n];\n\nTables.t16HB = [\n    1, 5, 14, 44, 74, 63, 110, 93, 172, 149, 138, 242, 225, 195, 376, 17,\n    3, 4, 12, 20, 35, 62, 53, 47, 83, 75, 68, 119, 201, 107, 207, 9,\n    15, 13, 23, 38, 67, 58, 103, 90, 161, 72, 127, 117, 110, 209, 206, 16,\n    45, 21, 39, 69, 64, 114, 99, 87, 158, 140, 252, 212, 199, 387, 365, 26,\n    75, 36, 68, 65, 115, 101, 179, 164, 155, 264, 246, 226, 395, 382, 362, 9,\n    66, 30, 59, 56, 102, 185, 173, 265, 142, 253, 232, 400, 388, 378, 445, 16,\n    111, 54, 52, 100, 184, 178, 160, 133, 257, 244, 228, 217, 385, 366, 715, 10,\n    98, 48, 91, 88, 165, 157, 148, 261, 248, 407, 397, 372, 380, 889, 884, 8,\n    85, 84, 81, 159, 156, 143, 260, 249, 427, 401, 392, 383, 727, 713, 708, 7,\n    154, 76, 73, 141, 131, 256, 245, 426, 406, 394, 384, 735, 359, 710, 352, 11,\n    139, 129, 67, 125, 247, 233, 229, 219, 393, 743, 737, 720, 885, 882, 439, 4,\n    243, 120, 118, 115, 227, 223, 396, 746, 742, 736, 721, 712, 706, 223, 436, 6,\n    202, 224, 222, 218, 216, 389, 386, 381, 364, 888, 443, 707, 440, 437, 1728, 4,\n    747, 211, 210, 208, 370, 379, 734, 723, 714, 1735, 883, 877, 876, 3459, 865, 2,\n    377, 369, 102, 187, 726, 722, 358, 711, 709, 866, 1734, 871, 3458, 870, 434, 0,\n    12, 10, 7, 11, 10, 17, 11, 9, 13, 12, 10, 7, 5, 3, 1, 3\n];\n\nTables.t24HB = [\n    15, 13, 46, 80, 146, 262, 248, 434, 426, 669, 653, 649, 621, 517, 1032, 88,\n    14, 12, 21, 38, 71, 130, 122, 216, 209, 198, 327, 345, 319, 297, 279, 42,\n    47, 22, 41, 74, 68, 128, 120, 221, 207, 194, 182, 340, 315, 295, 541, 18,\n    81, 39, 75, 70, 134, 125, 116, 220, 204, 190, 178, 325, 311, 293, 271, 16,\n    147, 72, 69, 135, 127, 118, 112, 210, 200, 188, 352, 323, 306, 285, 540, 14,\n    263, 66, 129, 126, 119, 114, 214, 202, 192, 180, 341, 317, 301, 281, 262, 12,\n    249, 123, 121, 117, 113, 215, 206, 195, 185, 347, 330, 308, 291, 272, 520, 10,\n    435, 115, 111, 109, 211, 203, 196, 187, 353, 332, 313, 298, 283, 531, 381, 17,\n    427, 212, 208, 205, 201, 193, 186, 177, 169, 320, 303, 286, 268, 514, 377, 16,\n    335, 199, 197, 191, 189, 181, 174, 333, 321, 305, 289, 275, 521, 379, 371, 11,\n    668, 184, 183, 179, 175, 344, 331, 314, 304, 290, 277, 530, 383, 373, 366, 10,\n    652, 346, 171, 168, 164, 318, 309, 299, 287, 276, 263, 513, 375, 368, 362, 6,\n    648, 322, 316, 312, 307, 302, 292, 284, 269, 261, 512, 376, 370, 364, 359, 4,\n    620, 300, 296, 294, 288, 282, 273, 266, 515, 380, 374, 369, 365, 361, 357, 2,\n    1033, 280, 278, 274, 267, 264, 259, 382, 378, 372, 367, 363, 360, 358, 356, 0,\n    43, 20, 19, 17, 15, 13, 11, 9, 7, 6, 4, 7, 5, 3, 1, 3\n];\n\nTables.t32HB = [\n    1 << 0, 5 << 1, 4 << 1, 5 << 2, 6 << 1, 5 << 2, 4 << 2, 4 << 3,\n    7 << 1, 3 << 2, 6 << 2, 0 << 3, 7 << 2, 2 << 3, 3 << 3, 1 << 4\n];\n\nTables.t33HB = [\n    15 << 0, 14 << 1, 13 << 1, 12 << 2, 11 << 1, 10 << 2, 9 << 2, 8 << 3,\n    7 << 1, 6 << 2, 5 << 2, 4 << 3, 3 << 2, 2 << 3, 1 << 3, 0 << 4\n];\n\nTables.t1l = [\n    1, 4,\n    3, 5\n];\n\nTables.t2l = [\n    1, 4, 7,\n    4, 5, 7,\n    6, 7, 8\n];\n\nTables.t3l = [\n    2, 3, 7,\n    4, 4, 7,\n    6, 7, 8\n];\n\nTables.t5l = [\n    1, 4, 7, 8,\n    4, 5, 8, 9,\n    7, 8, 9, 10,\n    8, 8, 9, 10\n];\n\nTables.t6l = [\n    3, 4, 6, 8,\n    4, 4, 6, 7,\n    5, 6, 7, 8,\n    7, 7, 8, 9\n];\n\nTables.t7l = [\n    1, 4, 7, 9, 9, 10,\n    4, 6, 8, 9, 9, 10,\n    7, 7, 9, 10, 10, 11,\n    8, 9, 10, 11, 11, 11,\n    8, 9, 10, 11, 11, 12,\n    9, 10, 11, 12, 12, 12\n];\n\nTables.t8l = [\n    2, 4, 7, 9, 9, 10,\n    4, 4, 6, 10, 10, 10,\n    7, 6, 8, 10, 10, 11,\n    9, 10, 10, 11, 11, 12,\n    9, 9, 10, 11, 12, 12,\n    10, 10, 11, 11, 13, 13\n];\n\nTables.t9l = [\n    3, 4, 6, 7, 9, 10,\n    4, 5, 6, 7, 8, 10,\n    5, 6, 7, 8, 9, 10,\n    7, 7, 8, 9, 9, 10,\n    8, 8, 9, 9, 10, 11,\n    9, 9, 10, 10, 11, 11\n];\n\nTables.t10l = [\n    1, 4, 7, 9, 10, 10, 10, 11,\n    4, 6, 8, 9, 10, 11, 10, 10,\n    7, 8, 9, 10, 11, 12, 11, 11,\n    8, 9, 10, 11, 12, 12, 11, 12,\n    9, 10, 11, 12, 12, 12, 12, 12,\n    10, 11, 12, 12, 13, 13, 12, 13,\n    9, 10, 11, 12, 12, 12, 13, 13,\n    10, 10, 11, 12, 12, 13, 13, 13\n];\n\nTables.t11l = [\n    2, 4, 6, 8, 9, 10, 9, 10,\n    4, 5, 6, 8, 10, 10, 9, 10,\n    6, 7, 8, 9, 10, 11, 10, 10,\n    8, 8, 9, 11, 10, 12, 10, 11,\n    9, 10, 10, 11, 11, 12, 11, 12,\n    9, 10, 11, 12, 12, 13, 12, 13,\n    9, 9, 9, 10, 11, 12, 12, 12,\n    9, 9, 10, 11, 12, 12, 12, 12\n];\n\nTables.t12l = [\n    4, 4, 6, 8, 9, 10, 10, 10,\n    4, 5, 6, 7, 9, 9, 10, 10,\n    6, 6, 7, 8, 9, 10, 9, 10,\n    7, 7, 8, 8, 9, 10, 10, 10,\n    8, 8, 9, 9, 10, 10, 10, 11,\n    9, 9, 10, 10, 10, 11, 10, 11,\n    9, 9, 9, 10, 10, 11, 11, 12,\n    10, 10, 10, 11, 11, 11, 11, 12\n];\n\nTables.t13l = [\n    1, 5, 7, 8, 9, 10, 10, 11, 10, 11, 12, 12, 13, 13, 14, 14,\n    4, 6, 8, 9, 10, 10, 11, 11, 11, 11, 12, 12, 13, 14, 14, 14,\n    7, 8, 9, 10, 11, 11, 12, 12, 11, 12, 12, 13, 13, 14, 15, 15,\n    8, 9, 10, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 14, 15, 15,\n    9, 9, 11, 11, 12, 12, 13, 13, 12, 13, 13, 14, 14, 15, 15, 16,\n    10, 10, 11, 12, 12, 12, 13, 13, 13, 13, 14, 13, 15, 15, 16, 16,\n    10, 11, 12, 12, 13, 13, 13, 13, 13, 14, 14, 14, 15, 15, 16, 16,\n    11, 11, 12, 13, 13, 13, 14, 14, 14, 14, 15, 15, 15, 16, 18, 18,\n    10, 10, 11, 12, 12, 13, 13, 14, 14, 14, 14, 15, 15, 16, 17, 17,\n    11, 11, 12, 12, 13, 13, 13, 15, 14, 15, 15, 16, 16, 16, 18, 17,\n    11, 12, 12, 13, 13, 14, 14, 15, 14, 15, 16, 15, 16, 17, 18, 19,\n    12, 12, 12, 13, 14, 14, 14, 14, 15, 15, 15, 16, 17, 17, 17, 18,\n    12, 13, 13, 14, 14, 15, 14, 15, 16, 16, 17, 17, 17, 18, 18, 18,\n    13, 13, 14, 15, 15, 15, 16, 16, 16, 16, 16, 17, 18, 17, 18, 18,\n    14, 14, 14, 15, 15, 15, 17, 16, 16, 19, 17, 17, 17, 19, 18, 18,\n    13, 14, 15, 16, 16, 16, 17, 16, 17, 17, 18, 18, 21, 20, 21, 18\n];\n\nTables.t15l = [\n    3, 5, 6, 8, 8, 9, 10, 10, 10, 11, 11, 12, 12, 12, 13, 14,\n    5, 5, 7, 8, 9, 9, 10, 10, 10, 11, 11, 12, 12, 12, 13, 13,\n    6, 7, 7, 8, 9, 9, 10, 10, 10, 11, 11, 12, 12, 13, 13, 13,\n    7, 8, 8, 9, 9, 10, 10, 11, 11, 11, 12, 12, 12, 13, 13, 13,\n    8, 8, 9, 9, 10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 13, 13,\n    9, 9, 9, 10, 10, 10, 11, 11, 11, 11, 12, 12, 13, 13, 13, 14,\n    10, 9, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 13, 14, 14,\n    10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 13, 13, 14,\n    10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 13, 13, 14, 14, 14,\n    10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 13, 13, 13, 14, 14, 14,\n    11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 13, 13, 13, 14, 15, 14,\n    11, 11, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 14, 14, 14, 15,\n    12, 12, 11, 12, 12, 12, 13, 13, 13, 13, 13, 13, 14, 14, 15, 15,\n    12, 12, 12, 12, 12, 13, 13, 13, 13, 14, 14, 14, 14, 14, 15, 15,\n    13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 15, 15, 14, 15,\n    13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 15, 15, 15, 15\n];\n\nTables.t16_5l = [\n    1, 5, 7, 9, 10, 10, 11, 11, 12, 12, 12, 13, 13, 13, 14, 11,\n    4, 6, 8, 9, 10, 11, 11, 11, 12, 12, 12, 13, 14, 13, 14, 11,\n    7, 8, 9, 10, 11, 11, 12, 12, 13, 12, 13, 13, 13, 14, 14, 12,\n    9, 9, 10, 11, 11, 12, 12, 12, 13, 13, 14, 14, 14, 15, 15, 13,\n    10, 10, 11, 11, 12, 12, 13, 13, 13, 14, 14, 14, 15, 15, 15, 12,\n    10, 10, 11, 11, 12, 13, 13, 14, 13, 14, 14, 15, 15, 15, 16, 13,\n    11, 11, 11, 12, 13, 13, 13, 13, 14, 14, 14, 14, 15, 15, 16, 13,\n    11, 11, 12, 12, 13, 13, 13, 14, 14, 15, 15, 15, 15, 17, 17, 13,\n    11, 12, 12, 13, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 13,\n    12, 12, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 15, 16, 15, 14,\n    12, 13, 12, 13, 14, 14, 14, 14, 15, 16, 16, 16, 17, 17, 16, 13,\n    13, 13, 13, 13, 14, 14, 15, 16, 16, 16, 16, 16, 16, 15, 16, 14,\n    13, 14, 14, 14, 14, 15, 15, 15, 15, 17, 16, 16, 16, 16, 18, 14,\n    15, 14, 14, 14, 15, 15, 16, 16, 16, 18, 17, 17, 17, 19, 17, 14,\n    14, 15, 13, 14, 16, 16, 15, 16, 16, 17, 18, 17, 19, 17, 16, 14,\n    11, 11, 11, 12, 12, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 12\n];\n\nTables.t16l = [\n    1, 5, 7, 9, 10, 10, 11, 11, 12, 12, 12, 13, 13, 13, 14, 10,\n    4, 6, 8, 9, 10, 11, 11, 11, 12, 12, 12, 13, 14, 13, 14, 10,\n    7, 8, 9, 10, 11, 11, 12, 12, 13, 12, 13, 13, 13, 14, 14, 11,\n    9, 9, 10, 11, 11, 12, 12, 12, 13, 13, 14, 14, 14, 15, 15, 12,\n    10, 10, 11, 11, 12, 12, 13, 13, 13, 14, 14, 14, 15, 15, 15, 11,\n    10, 10, 11, 11, 12, 13, 13, 14, 13, 14, 14, 15, 15, 15, 16, 12,\n    11, 11, 11, 12, 13, 13, 13, 13, 14, 14, 14, 14, 15, 15, 16, 12,\n    11, 11, 12, 12, 13, 13, 13, 14, 14, 15, 15, 15, 15, 17, 17, 12,\n    11, 12, 12, 13, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 12,\n    12, 12, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 15, 16, 15, 13,\n    12, 13, 12, 13, 14, 14, 14, 14, 15, 16, 16, 16, 17, 17, 16, 12,\n    13, 13, 13, 13, 14, 14, 15, 16, 16, 16, 16, 16, 16, 15, 16, 13,\n    13, 14, 14, 14, 14, 15, 15, 15, 15, 17, 16, 16, 16, 16, 18, 13,\n    15, 14, 14, 14, 15, 15, 16, 16, 16, 18, 17, 17, 17, 19, 17, 13,\n    14, 15, 13, 14, 16, 16, 15, 16, 16, 17, 18, 17, 19, 17, 16, 13,\n    10, 10, 10, 11, 11, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 10\n];\n\nTables.t24l = [\n    4, 5, 7, 8, 9, 10, 10, 11, 11, 12, 12, 12, 12, 12, 13, 10,\n    5, 6, 7, 8, 9, 10, 10, 11, 11, 11, 12, 12, 12, 12, 12, 10,\n    7, 7, 8, 9, 9, 10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 9,\n    8, 8, 9, 9, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 9,\n    9, 9, 9, 10, 10, 10, 10, 11, 11, 11, 12, 12, 12, 12, 13, 9,\n    10, 9, 10, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 9,\n    10, 10, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 9,\n    11, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 13, 10,\n    11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 13, 13, 10,\n    11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 13, 13, 10,\n    12, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 10,\n    12, 12, 11, 11, 11, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 10,\n    12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 10,\n    12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 10,\n    13, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 10,\n    9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 6\n];\n\nTables.t32l = [\n    1 + 0, 4 + 1, 4 + 1, 5 + 2, 4 + 1, 6 + 2, 5 + 2, 6 + 3,\n    4 + 1, 5 + 2, 5 + 2, 6 + 3, 5 + 2, 6 + 3, 6 + 3, 6 + 4\n];\n\nTables.t33l = [\n    4 + 0, 4 + 1, 4 + 1, 4 + 2, 4 + 1, 4 + 2, 4 + 2, 4 + 3,\n    4 + 1, 4 + 2, 4 + 2, 4 + 3, 4 + 2, 4 + 3, 4 + 3, 4 + 4\n];\n\nTables.ht = [\n    /* xlen, linmax, table, hlen */\n    new HuffCodeTab(0, 0, null, null),\n    new HuffCodeTab(2, 0, Tables.t1HB, Tables.t1l),\n    new HuffCodeTab(3, 0, Tables.t2HB, Tables.t2l),\n    new HuffCodeTab(3, 0, Tables.t3HB, Tables.t3l),\n    new HuffCodeTab(0, 0, null, null), /* Apparently not used */\n    new HuffCodeTab(4, 0, Tables.t5HB, Tables.t5l),\n    new HuffCodeTab(4, 0, Tables.t6HB, Tables.t6l),\n    new HuffCodeTab(6, 0, Tables.t7HB, Tables.t7l),\n    new HuffCodeTab(6, 0, Tables.t8HB, Tables.t8l),\n    new HuffCodeTab(6, 0, Tables.t9HB, Tables.t9l),\n    new HuffCodeTab(8, 0, Tables.t10HB, Tables.t10l),\n    new HuffCodeTab(8, 0, Tables.t11HB, Tables.t11l),\n    new HuffCodeTab(8, 0, Tables.t12HB, Tables.t12l),\n    new HuffCodeTab(16, 0, Tables.t13HB, Tables.t13l),\n    new HuffCodeTab(0, 0, null, Tables.t16_5l), /* Apparently not used */\n    new HuffCodeTab(16, 0, Tables.t15HB, Tables.t15l),\n\n    new HuffCodeTab(1, 1, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(2, 3, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(3, 7, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(4, 15, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(6, 63, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(8, 255, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(10, 1023, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(13, 8191, Tables.t16HB, Tables.t16l),\n\n    new HuffCodeTab(4, 15, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(5, 31, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(6, 63, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(7, 127, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(8, 255, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(9, 511, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(11, 2047, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(13, 8191, Tables.t24HB, Tables.t24l),\n\n    new HuffCodeTab(0, 0, Tables.t32HB, Tables.t32l),\n    new HuffCodeTab(0, 0, Tables.t33HB, Tables.t33l),\n];\n\n/**\n * <CODE>\n *  for (i = 0; i < 16*16; i++) [\n *      largetbl[i] = ((ht[16].hlen[i]) << 16) + ht[24].hlen[i];\n *  ]\n * </CODE>\n *\n */\nTables.largetbl = [\n    0x010004, 0x050005, 0x070007, 0x090008, 0x0a0009, 0x0a000a, 0x0b000a, 0x0b000b,\n    0x0c000b, 0x0c000c, 0x0c000c, 0x0d000c, 0x0d000c, 0x0d000c, 0x0e000d, 0x0a000a,\n    0x040005, 0x060006, 0x080007, 0x090008, 0x0a0009, 0x0b000a, 0x0b000a, 0x0b000b,\n    0x0c000b, 0x0c000b, 0x0c000c, 0x0d000c, 0x0e000c, 0x0d000c, 0x0e000c, 0x0a000a,\n    0x070007, 0x080007, 0x090008, 0x0a0009, 0x0b0009, 0x0b000a, 0x0c000a, 0x0c000b,\n    0x0d000b, 0x0c000b, 0x0d000b, 0x0d000c, 0x0d000c, 0x0e000c, 0x0e000d, 0x0b0009,\n    0x090008, 0x090008, 0x0a0009, 0x0b0009, 0x0b000a, 0x0c000a, 0x0c000a, 0x0c000b,\n    0x0d000b, 0x0d000b, 0x0e000b, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x0c0009,\n    0x0a0009, 0x0a0009, 0x0b0009, 0x0b000a, 0x0c000a, 0x0c000a, 0x0d000a, 0x0d000b,\n    0x0d000b, 0x0e000b, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x0f000d, 0x0b0009,\n    0x0a000a, 0x0a0009, 0x0b000a, 0x0b000a, 0x0c000a, 0x0d000a, 0x0d000b, 0x0e000b,\n    0x0d000b, 0x0e000b, 0x0e000c, 0x0f000c, 0x0f000c, 0x0f000c, 0x10000c, 0x0c0009,\n    0x0b000a, 0x0b000a, 0x0b000a, 0x0c000a, 0x0d000a, 0x0d000b, 0x0d000b, 0x0d000b,\n    0x0e000b, 0x0e000c, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x10000d, 0x0c0009,\n    0x0b000b, 0x0b000a, 0x0c000a, 0x0c000a, 0x0d000b, 0x0d000b, 0x0d000b, 0x0e000b,\n    0x0e000c, 0x0f000c, 0x0f000c, 0x0f000c, 0x0f000c, 0x11000d, 0x11000d, 0x0c000a,\n    0x0b000b, 0x0c000b, 0x0c000b, 0x0d000b, 0x0d000b, 0x0d000b, 0x0e000b, 0x0e000b,\n    0x0f000b, 0x0f000c, 0x0f000c, 0x0f000c, 0x10000c, 0x10000d, 0x10000d, 0x0c000a,\n    0x0c000b, 0x0c000b, 0x0c000b, 0x0d000b, 0x0d000b, 0x0e000b, 0x0e000b, 0x0f000c,\n    0x0f000c, 0x0f000c, 0x0f000c, 0x10000c, 0x0f000d, 0x10000d, 0x0f000d, 0x0d000a,\n    0x0c000c, 0x0d000b, 0x0c000b, 0x0d000b, 0x0e000b, 0x0e000c, 0x0e000c, 0x0e000c,\n    0x0f000c, 0x10000c, 0x10000c, 0x10000d, 0x11000d, 0x11000d, 0x10000d, 0x0c000a,\n    0x0d000c, 0x0d000c, 0x0d000b, 0x0d000b, 0x0e000b, 0x0e000c, 0x0f000c, 0x10000c,\n    0x10000c, 0x10000c, 0x10000c, 0x10000d, 0x10000d, 0x0f000d, 0x10000d, 0x0d000a,\n    0x0d000c, 0x0e000c, 0x0e000c, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x0f000c,\n    0x0f000c, 0x11000c, 0x10000d, 0x10000d, 0x10000d, 0x10000d, 0x12000d, 0x0d000a,\n    0x0f000c, 0x0e000c, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x10000c, 0x10000c,\n    0x10000d, 0x12000d, 0x11000d, 0x11000d, 0x11000d, 0x13000d, 0x11000d, 0x0d000a,\n    0x0e000d, 0x0f000c, 0x0d000c, 0x0e000c, 0x10000c, 0x10000c, 0x0f000c, 0x10000d,\n    0x10000d, 0x11000d, 0x12000d, 0x11000d, 0x13000d, 0x11000d, 0x10000d, 0x0d000a,\n    0x0a0009, 0x0a0009, 0x0a0009, 0x0b0009, 0x0b0009, 0x0c0009, 0x0c0009, 0x0c0009,\n    0x0d0009, 0x0d0009, 0x0d0009, 0x0d000a, 0x0d000a, 0x0d000a, 0x0d000a, 0x0a0006\n];\n/**\n * <CODE>\n *  for (i = 0; i < 3*3; i++) [\n *      table23[i] = ((ht[2].hlen[i]) << 16) + ht[3].hlen[i];\n *  ]\n * </CODE>\n *\n */\nTables.table23 = [\n    0x010002, 0x040003, 0x070007,\n    0x040004, 0x050004, 0x070007,\n    0x060006, 0x070007, 0x080008\n];\n\n/**\n * <CODE>\n *  for (i = 0; i < 4*4; i++) [\n *       table56[i] = ((ht[5].hlen[i]) << 16) + ht[6].hlen[i];\n *   ]\n * </CODE>\n *\n */\nTables.table56 = [\n    0x010003, 0x040004, 0x070006, 0x080008, 0x040004, 0x050004, 0x080006, 0x090007,\n    0x070005, 0x080006, 0x090007, 0x0a0008, 0x080007, 0x080007, 0x090008, 0x0a0009\n];\n\nTables.bitrate_table = [\n    [0, 8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, -1], /* MPEG 2 */\n    [0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, -1], /* MPEG 1 */\n    [0, 8, 16, 24, 32, 40, 48, 56, 64, -1, -1, -1, -1, -1, -1, -1], /* MPEG 2.5 */\n];\n\n/**\n * MPEG 2, MPEG 1, MPEG 2.5.\n */\nTables.samplerate_table = [\n    [22050, 24000, 16000, -1],\n    [44100, 48000, 32000, -1],\n    [11025, 12000, 8000, -1],\n];\n\n/**\n * This is the scfsi_band table from 2.4.2.7 of the IS.\n */\nTables.scfsi_band = [0, 6, 11, 16, 21];\n\nfunction MeanBits(meanBits) {\n    this.bits = meanBits;\n}\n\n//package mp3;\n\nfunction CalcNoiseResult() {\n    /**\n     * sum of quantization noise > masking\n     */\n    this.over_noise = 0.;\n    /**\n     * sum of all quantization noise\n     */\n    this.tot_noise = 0.;\n    /**\n     * max quantization noise\n     */\n    this.max_noise = 0.;\n    /**\n     * number of quantization noise > masking\n     */\n    this.over_count = 0;\n    /**\n     * SSD-like cost of distorted bands\n     */\n    this.over_SSD = 0;\n    this.bits = 0;\n}\n\nfunction VBRQuantize() {\n    var qupvt;\n    var tak;\n\n    this.setModules = function (_qupvt, _tk) {\n        qupvt = _qupvt;\n        tak = _tk;\n    }\n    //TODO\n\n}\n\n\n\n/**\n * ATH related stuff, if something new ATH related has to be added, please plug\n * it here into the ATH.\n */\nfunction ATH() {\n    /**\n     * Method for the auto adjustment.\n     */\n    this.useAdjust = 0;\n    /**\n     * factor for tuning the (sample power) point below which adaptive threshold\n     * of hearing adjustment occurs\n     */\n    this.aaSensitivityP = 0.;\n    /**\n     * Lowering based on peak volume, 1 = no lowering.\n     */\n    this.adjust = 0.;\n    /**\n     * Limit for dynamic ATH adjust.\n     */\n    this.adjustLimit = 0.;\n    /**\n     * Determined to lower x dB each second.\n     */\n    this.decay = 0.;\n    /**\n     * Lowest ATH value.\n     */\n    this.floor = 0.;\n    /**\n     * ATH for sfbs in long blocks.\n     */\n    this.l = new_float(Encoder.SBMAX_l);\n    /**\n     * ATH for sfbs in short blocks.\n     */\n    this.s = new_float(Encoder.SBMAX_s);\n    /**\n     * ATH for partitioned sfb21 in long blocks.\n     */\n    this.psfb21 = new_float(Encoder.PSFB21);\n    /**\n     * ATH for partitioned sfb12 in short blocks.\n     */\n    this.psfb12 = new_float(Encoder.PSFB12);\n    /**\n     * ATH for long block convolution bands.\n     */\n    this.cb_l = new_float(Encoder.CBANDS);\n    /**\n     * ATH for short block convolution bands.\n     */\n    this.cb_s = new_float(Encoder.CBANDS);\n    /**\n     * Equal loudness weights (based on ATH).\n     */\n    this.eql_w = new_float(Encoder.BLKSIZE / 2);\n}\n\n\nfunction LameGlobalFlags() {\n\n    this.class_id = 0;\n\n    /* input description */\n\n    /**\n     * number of samples. default=-1\n     */\n    this.num_samples = 0;\n    /**\n     * input number of channels. default=2\n     */\n    this.num_channels = 0;\n    /**\n     * input_samp_rate in Hz. default=44.1 kHz\n     */\n    this.in_samplerate = 0;\n    /**\n     * output_samp_rate. default: LAME picks best value at least not used for\n     * MP3 decoding: Remember 44.1 kHz MP3s and AC97\n     */\n    this.out_samplerate = 0;\n    /**\n     * scale input by this amount before encoding at least not used for MP3\n     * decoding\n     */\n    this.scale = 0.;\n    /**\n     * scale input of channel 0 (left) by this amount before encoding\n     */\n    this.scale_left = 0.;\n    /**\n     * scale input of channel 1 (right) by this amount before encoding\n     */\n    this.scale_right = 0.;\n\n    /* general control params */\n    /**\n     * collect data for a MP3 frame analyzer?\n     */\n    this.analysis = false;\n    /**\n     * add Xing VBR tag?\n     */\n    this.bWriteVbrTag = false;\n\n    /**\n     * use lame/mpglib to convert mp3 to wav\n     */\n    this.decode_only = false;\n    /**\n     * quality setting 0=best, 9=worst default=5\n     */\n    this.quality = 0;\n    /**\n     * see enum default = LAME picks best value\n     */\n    this.mode = MPEGMode.STEREO;\n    /**\n     * force M/S mode. requires mode=1\n     */\n    this.force_ms = false;\n    /**\n     * use free format? default=0\n     */\n    this.free_format = false;\n    /**\n     * find the RG value? default=0\n     */\n    this.findReplayGain = false;\n    /**\n     * decode on the fly? default=0\n     */\n    this.decode_on_the_fly = false;\n    /**\n     * 1 (default) writes ID3 tags, 0 not\n     */\n    this.write_id3tag_automatic = false;\n\n    /*\n     * set either brate>0 or compression_ratio>0, LAME will compute the value of\n     * the variable not set. Default is compression_ratio = 11.025\n     */\n    /**\n     * bitrate\n     */\n    this.brate = 0;\n    /**\n     * sizeof(wav file)/sizeof(mp3 file)\n     */\n    this.compression_ratio = 0.;\n\n    /* frame params */\n    /**\n     * mark as copyright. default=0\n     */\n    this.copyright = 0;\n    /**\n     * mark as original. default=1\n     */\n    this.original = 0;\n    /**\n     * the MP3 'private extension' bit. Meaningless\n     */\n    this.extension = 0;\n    /**\n     * Input PCM is emphased PCM (for instance from one of the rarely emphased\n     * CDs), it is STRONGLY not recommended to use this, because psycho does not\n     * take it into account, and last but not least many decoders don't care\n     * about these bits\n     */\n    this.emphasis = 0;\n    /**\n     * use 2 bytes per frame for a CRC checksum. default=0\n     */\n    this.error_protection = 0;\n    /**\n     * enforce ISO spec as much as possible\n     */\n    this.strict_ISO = false;\n\n    /**\n     * use bit reservoir?\n     */\n    this.disable_reservoir = false;\n\n    /* quantization/noise shaping */\n    this.quant_comp = 0;\n    this.quant_comp_short = 0;\n    this.experimentalY = false;\n    this.experimentalZ = 0;\n    this.exp_nspsytune = 0;\n\n    this.preset = 0;\n\n    /* VBR control */\n    this.VBR = null;\n    /**\n     * Range [0,...,1[\n     */\n    this.VBR_q_frac = 0.;\n    /**\n     * Range [0,...,9]\n     */\n    this.VBR_q = 0;\n    this.VBR_mean_bitrate_kbps = 0;\n    this.VBR_min_bitrate_kbps = 0;\n    this.VBR_max_bitrate_kbps = 0;\n    /**\n     * strictly enforce VBR_min_bitrate normaly, it will be violated for analog\n     * silence\n     */\n    this.VBR_hard_min = 0;\n\n    /* resampling and filtering */\n\n    /**\n     * freq in Hz. 0=lame choses. -1=no filter\n     */\n    this.lowpassfreq = 0;\n    /**\n     * freq in Hz. 0=lame choses. -1=no filter\n     */\n    this.highpassfreq = 0;\n    /**\n     * freq width of filter, in Hz (default=15%)\n     */\n    this.lowpasswidth = 0;\n    /**\n     * freq width of filter, in Hz (default=15%)\n     */\n    this.highpasswidth = 0;\n\n    /*\n     * psycho acoustics and other arguments which you should not change unless\n     * you know what you are doing\n     */\n\n    this.maskingadjust = 0.;\n    this.maskingadjust_short = 0.;\n    /**\n     * only use ATH\n     */\n    this.ATHonly = false;\n    /**\n     * only use ATH for short blocks\n     */\n    this.ATHshort = false;\n    /**\n     * disable ATH\n     */\n    this.noATH = false;\n    /**\n     * select ATH formula\n     */\n    this.ATHtype = 0;\n    /**\n     * change ATH formula 4 shape\n     */\n    this.ATHcurve = 0.;\n    /**\n     * lower ATH by this many db\n     */\n    this.ATHlower = 0.;\n    /**\n     * select ATH auto-adjust scheme\n     */\n    this.athaa_type = 0;\n    /**\n     * select ATH auto-adjust loudness calc\n     */\n    this.athaa_loudapprox = 0;\n    /**\n     * dB, tune active region of auto-level\n     */\n    this.athaa_sensitivity = 0.;\n    this.short_blocks = null;\n    /**\n     * use temporal masking effect\n     */\n    this.useTemporal = false;\n    this.interChRatio = 0.;\n    /**\n     * Naoki's adjustment of Mid/Side maskings\n     */\n    this.msfix = 0.;\n\n    /**\n     * 0 off, 1 on\n     */\n    this.tune = false;\n    /**\n     * used to pass values for debugging and stuff\n     */\n    this.tune_value_a = 0.;\n\n    /************************************************************************/\n    /* internal variables, do not set... */\n    /* provided because they may be of use to calling application */\n    /************************************************************************/\n\n    /**\n     * 0=MPEG-2/2.5 1=MPEG-1\n     */\n    this.version = 0;\n    this.encoder_delay = 0;\n    /**\n     * number of samples of padding appended to input\n     */\n    this.encoder_padding = 0;\n    this.framesize = 0;\n    /**\n     * number of frames encoded\n     */\n    this.frameNum = 0;\n    /**\n     * is this struct owned by calling program or lame?\n     */\n    this.lame_allocated_gfp = 0;\n    /**************************************************************************/\n    /* more internal variables are stored in this structure: */\n    /**************************************************************************/\n    this.internal_flags = null;\n}\n\n\n\nfunction CBRNewIterationLoop(_quantize)  {\n    var quantize = _quantize;\n    this.quantize = quantize;\n\tthis.iteration_loop = function(gfp, pe, ms_ener_ratio, ratio) {\n\t\tvar gfc = gfp.internal_flags;\n        var l3_xmin = new_float(L3Side.SFBMAX);\n\t\tvar xrpow = new_float(576);\n\t\tvar targ_bits = new_int(2);\n\t\tvar mean_bits = 0, max_bits;\n\t\tvar l3_side = gfc.l3_side;\n\n\t\tvar mb = new MeanBits(mean_bits);\n\t\tthis.quantize.rv.ResvFrameBegin(gfp, mb);\n\t\tmean_bits = mb.bits;\n\n\t\t/* quantize! */\n\t\tfor (var gr = 0; gr < gfc.mode_gr; gr++) {\n\n\t\t\t/*\n\t\t\t * calculate needed bits\n\t\t\t */\n\t\t\tmax_bits = this.quantize.qupvt.on_pe(gfp, pe, targ_bits, mean_bits,\n\t\t\t\t\tgr, gr);\n\n\t\t\tif (gfc.mode_ext == Encoder.MPG_MD_MS_LR) {\n\t\t\t\tthis.quantize.ms_convert(gfc.l3_side, gr);\n\t\t\t\tthis.quantize.qupvt.reduce_side(targ_bits, ms_ener_ratio[gr],\n\t\t\t\t\t\tmean_bits, max_bits);\n\t\t\t}\n\n\t\t\tfor (var ch = 0; ch < gfc.channels_out; ch++) {\n\t\t\t\tvar adjust, masking_lower_db;\n\t\t\t\tvar cod_info = l3_side.tt[gr][ch];\n\n\t\t\t\tif (cod_info.block_type != Encoder.SHORT_TYPE) {\n\t\t\t\t\t// NORM, START or STOP type\n\t\t\t\t\tadjust = 0;\n\t\t\t\t\tmasking_lower_db = gfc.PSY.mask_adjust - adjust;\n\t\t\t\t} else {\n\t\t\t\t\tadjust = 0;\n\t\t\t\t\tmasking_lower_db = gfc.PSY.mask_adjust_short - adjust;\n\t\t\t\t}\n\t\t\t\tgfc.masking_lower =  Math.pow(10.0,\n\t\t\t\t\t\tmasking_lower_db * 0.1);\n\n\t\t\t\t/*\n\t\t\t\t * init_outer_loop sets up cod_info, scalefac and xrpow\n\t\t\t\t */\n\t\t\t\tthis.quantize.init_outer_loop(gfc, cod_info);\n\t\t\t\tif (this.quantize.init_xrpow(gfc, cod_info, xrpow)) {\n\t\t\t\t\t/*\n\t\t\t\t\t * xr contains energy we will have to encode calculate the\n\t\t\t\t\t * masking abilities find some good quantization in\n\t\t\t\t\t * outer_loop\n\t\t\t\t\t */\n\t\t\t\t\tthis.quantize.qupvt.calc_xmin(gfp, ratio[gr][ch], cod_info,\n\t\t\t\t\t\t\tl3_xmin);\n\t\t\t\t\tthis.quantize.outer_loop(gfp, cod_info, l3_xmin, xrpow, ch,\n\t\t\t\t\t\t\ttarg_bits[ch]);\n\t\t\t\t}\n\n\t\t\t\tthis.quantize.iteration_finish_one(gfc, gr, ch);\n\t\t\t} /* for ch */\n\t\t} /* for gr */\n\n\t\tthis.quantize.rv.ResvFrameEnd(gfc, mean_bits);\n\t}\n}\n\n\nfunction ReplayGain() {\n\t//fix 精简\n}\n\n//package mp3;\n\n/**\n * Layer III side information.\n *\n * @author Ken\n *\n */\n\n\n\nfunction ScaleFac(arrL, arrS, arr21, arr12) {\n\n    this.l = new_int(1 + Encoder.SBMAX_l);\n    this.s = new_int(1 + Encoder.SBMAX_s);\n    this.psfb21 = new_int(1 + Encoder.PSFB21);\n    this.psfb12 = new_int(1 + Encoder.PSFB12);\n    var l = this.l;\n    var s = this.s;\n\n    if (arguments.length == 4) {\n        //public ScaleFac(final int[] arrL, final int[] arrS, final int[] arr21,\n        //    final int[] arr12) {\n        this.arrL = arguments[0];\n        this.arrS = arguments[1];\n        this.arr21 = arguments[2];\n        this.arr12 = arguments[3];\n\n        System.arraycopy(this.arrL, 0, l, 0, Math.min(this.arrL.length, this.l.length));\n        System.arraycopy(this.arrS, 0, s, 0, Math.min(this.arrS.length, this.s.length));\n        System.arraycopy(this.arr21, 0, this.psfb21, 0, Math.min(this.arr21.length, this.psfb21.length));\n        System.arraycopy(this.arr12, 0, this.psfb12, 0, Math.min(this.arr12.length, this.psfb12.length));\n    }\n}\n\n/*\n *      quantize_pvt source file\n *\n *      Copyright (c) 1999-2002 Takehiro Tominaga\n *      Copyright (c) 2000-2002 Robert Hegemann\n *      Copyright (c) 2001 Naoki Shibata\n *      Copyright (c) 2002-2005 Gabriel Bouvigne\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n\n/* $Id: QuantizePVT.java,v 1.24 2011/05/24 20:48:06 kenchis Exp $ */\n\n\nQuantizePVT.Q_MAX = (256 + 1);\nQuantizePVT.Q_MAX2 = 116;\nQuantizePVT.LARGE_BITS = 100000;\nQuantizePVT.IXMAX_VAL = 8206;\n\nfunction QuantizePVT() {\n\n    var tak = null;\n    var rv = null;\n    var psy = null;\n\n    this.setModules = function (_tk, _rv, _psy) {\n        tak = _tk;\n        rv = _rv;\n        psy = _psy;\n    };\n\n    function POW20(x) {\n        return pow20[x + QuantizePVT.Q_MAX2];\n    }\n\n    this.IPOW20 = function (x) {\n        return ipow20[x];\n    }\n\n    /**\n     * smallest such that 1.0+DBL_EPSILON != 1.0\n     */\n    var DBL_EPSILON = 2.2204460492503131e-016;\n\n    /**\n     * ix always <= 8191+15. see count_bits()\n     */\n    var IXMAX_VAL = QuantizePVT.IXMAX_VAL;\n\n    var PRECALC_SIZE = (IXMAX_VAL + 2);\n\n    var Q_MAX = QuantizePVT.Q_MAX;\n\n\n    /**\n     * <CODE>\n     * minimum possible number of\n     * -cod_info.global_gain + ((scalefac[] + (cod_info.preflag ? pretab[sfb] : 0))\n     * << (cod_info.scalefac_scale + 1)) + cod_info.subblock_gain[cod_info.window[sfb]] * 8;\n     *\n     * for long block, 0+((15+3)<<2) = 18*4 = 72\n     * for short block, 0+(15<<2)+7*8 = 15*4+56 = 116\n     * </CODE>\n     */\n    var Q_MAX2 = QuantizePVT.Q_MAX2;\n\n    var LARGE_BITS = QuantizePVT.LARGE_BITS;\n\n\n    /**\n     * Assuming dynamic range=96dB, this value should be 92\n     */\n    var NSATHSCALE = 100;\n\n    /**\n     * The following table is used to implement the scalefactor partitioning for\n     * MPEG2 as described in section 2.4.3.2 of the IS. The indexing corresponds\n     * to the way the tables are presented in the IS:\n     *\n     * [table_number][row_in_table][column of nr_of_sfb]\n     */\n    this.nr_of_sfb_block = [\n        [[6, 5, 5, 5], [9, 9, 9, 9], [6, 9, 9, 9]],\n        [[6, 5, 7, 3], [9, 9, 12, 6], [6, 9, 12, 6]],\n        [[11, 10, 0, 0], [18, 18, 0, 0], [15, 18, 0, 0]],\n        [[7, 7, 7, 0], [12, 12, 12, 0], [6, 15, 12, 0]],\n        [[6, 6, 6, 3], [12, 9, 9, 6], [6, 12, 9, 6]],\n        [[8, 8, 5, 0], [15, 12, 9, 0], [6, 18, 9, 0]]];\n\n    /**\n     * Table B.6: layer3 preemphasis\n     */\n    var pretab = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1,\n        2, 2, 3, 3, 3, 2, 0];\n    this.pretab = pretab;\n\n    /**\n     * Here are MPEG1 Table B.8 and MPEG2 Table B.1 -- Layer III scalefactor\n     * bands. <BR>\n     * Index into this using a method such as:<BR>\n     * idx = fr_ps.header.sampling_frequency + (fr_ps.header.version * 3)\n     */\n    this.sfBandIndex = [\n        // Table B.2.b: 22.05 kHz\n        new ScaleFac([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 116, 140, 168, 200, 238, 284, 336, 396, 464,\n                522, 576],\n            [0, 4, 8, 12, 18, 24, 32, 42, 56, 74, 100, 132, 174, 192]\n            , [0, 0, 0, 0, 0, 0, 0] //  sfb21 pseudo sub bands\n            , [0, 0, 0, 0, 0, 0, 0] //  sfb12 pseudo sub bands\n        ),\n        /* Table B.2.c: 24 kHz */ /* docs: 332. mpg123(broken): 330 */\n        new ScaleFac([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 114, 136, 162, 194, 232, 278, 332, 394, 464,\n                540, 576],\n            [0, 4, 8, 12, 18, 26, 36, 48, 62, 80, 104, 136, 180, 192]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* Table B.2.a: 16 kHz */\n        new ScaleFac([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 116, 140, 168, 200, 238, 284, 336, 396, 464,\n                522, 576],\n            [0, 4, 8, 12, 18, 26, 36, 48, 62, 80, 104, 134, 174, 192]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* Table B.8.b: 44.1 kHz */\n        new ScaleFac([0, 4, 8, 12, 16, 20, 24, 30, 36, 44, 52, 62, 74, 90, 110, 134, 162, 196, 238, 288, 342, 418,\n                576],\n            [0, 4, 8, 12, 16, 22, 30, 40, 52, 66, 84, 106, 136, 192]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* Table B.8.c: 48 kHz */\n        new ScaleFac([0, 4, 8, 12, 16, 20, 24, 30, 36, 42, 50, 60, 72, 88, 106, 128, 156, 190, 230, 276, 330, 384,\n                576],\n            [0, 4, 8, 12, 16, 22, 28, 38, 50, 64, 80, 100, 126, 192]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* Table B.8.a: 32 kHz */\n        new ScaleFac([0, 4, 8, 12, 16, 20, 24, 30, 36, 44, 54, 66, 82, 102, 126, 156, 194, 240, 296, 364, 448, 550,\n                576],\n            [0, 4, 8, 12, 16, 22, 30, 42, 58, 78, 104, 138, 180, 192]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* MPEG-2.5 11.025 kHz */\n        new ScaleFac([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 116, 140, 168, 200, 238, 284, 336, 396, 464,\n                522, 576],\n            [0 / 3, 12 / 3, 24 / 3, 36 / 3, 54 / 3, 78 / 3, 108 / 3, 144 / 3, 186 / 3, 240 / 3, 312 / 3,\n                402 / 3, 522 / 3, 576 / 3]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* MPEG-2.5 12 kHz */\n        new ScaleFac([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 116, 140, 168, 200, 238, 284, 336, 396, 464,\n                522, 576],\n            [0 / 3, 12 / 3, 24 / 3, 36 / 3, 54 / 3, 78 / 3, 108 / 3, 144 / 3, 186 / 3, 240 / 3, 312 / 3,\n                402 / 3, 522 / 3, 576 / 3]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* MPEG-2.5 8 kHz */\n        new ScaleFac([0, 12, 24, 36, 48, 60, 72, 88, 108, 132, 160, 192, 232, 280, 336, 400, 476, 566, 568, 570,\n                572, 574, 576],\n            [0 / 3, 24 / 3, 48 / 3, 72 / 3, 108 / 3, 156 / 3, 216 / 3, 288 / 3, 372 / 3, 480 / 3, 486 / 3,\n                492 / 3, 498 / 3, 576 / 3]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        )\n    ];\n\n    var pow20 = new_float(Q_MAX + Q_MAX2 + 1);\n    var ipow20 = new_float(Q_MAX);\n    var pow43 = new_float(PRECALC_SIZE);\n\n    var adj43 = new_float(PRECALC_SIZE);\n    this.adj43 = adj43;\n\n    /**\n     * <PRE>\n     * compute the ATH for each scalefactor band cd range: 0..96db\n     *\n     * Input: 3.3kHz signal 32767 amplitude (3.3kHz is where ATH is smallest =\n     * -5db) longblocks: sfb=12 en0/bw=-11db max_en0 = 1.3db shortblocks: sfb=5\n     * -9db 0db\n     *\n     * Input: 1 1 1 1 1 1 1 -1 -1 -1 -1 -1 -1 -1 (repeated) longblocks: amp=1\n     * sfb=12 en0/bw=-103 db max_en0 = -92db amp=32767 sfb=12 -12 db -1.4db\n     *\n     * Input: 1 1 1 1 1 1 1 -1 -1 -1 -1 -1 -1 -1 (repeated) shortblocks: amp=1\n     * sfb=5 en0/bw= -99 -86 amp=32767 sfb=5 -9 db 4db\n     *\n     *\n     * MAX energy of largest wave at 3.3kHz = 1db AVE energy of largest wave at\n     * 3.3kHz = -11db Let's take AVE: -11db = maximum signal in sfb=12. Dynamic\n     * range of CD: 96db. Therefor energy of smallest audible wave in sfb=12 =\n     * -11 - 96 = -107db = ATH at 3.3kHz.\n     *\n     * ATH formula for this wave: -5db. To adjust to LAME scaling, we need ATH =\n     * ATH_formula - 103 (db) ATH = ATH * 2.5e-10 (ener)\n     * </PRE>\n     */\n    function ATHmdct(gfp, f) {\n        var ath = psy.ATHformula(f, gfp);\n\n        ath -= NSATHSCALE;\n\n        /* modify the MDCT scaling for the ATH and convert to energy */\n        ath = Math.pow(10.0, ath / 10.0 + gfp.ATHlower);\n        return ath;\n    }\n\n    function compute_ath(gfp) {\n        var ATH_l = gfp.internal_flags.ATH.l;\n        var ATH_psfb21 = gfp.internal_flags.ATH.psfb21;\n        var ATH_s = gfp.internal_flags.ATH.s;\n        var ATH_psfb12 = gfp.internal_flags.ATH.psfb12;\n        var gfc = gfp.internal_flags;\n        var samp_freq = gfp.out_samplerate;\n\n        for (var sfb = 0; sfb < Encoder.SBMAX_l; sfb++) {\n            var start = gfc.scalefac_band.l[sfb];\n            var end = gfc.scalefac_band.l[sfb + 1];\n            ATH_l[sfb] = Float.MAX_VALUE;\n            for (var i = start; i < end; i++) {\n                var freq = i * samp_freq / (2 * 576);\n                var ATH_f = ATHmdct(gfp, freq);\n                /* freq in kHz */\n                ATH_l[sfb] = Math.min(ATH_l[sfb], ATH_f);\n            }\n        }\n\n        for (var sfb = 0; sfb < Encoder.PSFB21; sfb++) {\n            var start = gfc.scalefac_band.psfb21[sfb];\n            var end = gfc.scalefac_band.psfb21[sfb + 1];\n            ATH_psfb21[sfb] = Float.MAX_VALUE;\n            for (var i = start; i < end; i++) {\n                var freq = i * samp_freq / (2 * 576);\n                var ATH_f = ATHmdct(gfp, freq);\n                /* freq in kHz */\n                ATH_psfb21[sfb] = Math.min(ATH_psfb21[sfb], ATH_f);\n            }\n        }\n\n        for (var sfb = 0; sfb < Encoder.SBMAX_s; sfb++) {\n            var start = gfc.scalefac_band.s[sfb];\n            var end = gfc.scalefac_band.s[sfb + 1];\n            ATH_s[sfb] = Float.MAX_VALUE;\n            for (var i = start; i < end; i++) {\n                var freq = i * samp_freq / (2 * 192);\n                var ATH_f = ATHmdct(gfp, freq);\n                /* freq in kHz */\n                ATH_s[sfb] = Math.min(ATH_s[sfb], ATH_f);\n            }\n            ATH_s[sfb] *= (gfc.scalefac_band.s[sfb + 1] - gfc.scalefac_band.s[sfb]);\n        }\n\n        for (var sfb = 0; sfb < Encoder.PSFB12; sfb++) {\n            var start = gfc.scalefac_band.psfb12[sfb];\n            var end = gfc.scalefac_band.psfb12[sfb + 1];\n            ATH_psfb12[sfb] = Float.MAX_VALUE;\n            for (var i = start; i < end; i++) {\n                var freq = i * samp_freq / (2 * 192);\n                var ATH_f = ATHmdct(gfp, freq);\n                /* freq in kHz */\n                ATH_psfb12[sfb] = Math.min(ATH_psfb12[sfb], ATH_f);\n            }\n            /* not sure about the following */\n            ATH_psfb12[sfb] *= (gfc.scalefac_band.s[13] - gfc.scalefac_band.s[12]);\n        }\n\n        /*\n         * no-ATH mode: reduce ATH to -200 dB\n         */\n        if (gfp.noATH) {\n            for (var sfb = 0; sfb < Encoder.SBMAX_l; sfb++) {\n                ATH_l[sfb] = 1E-20;\n            }\n            for (var sfb = 0; sfb < Encoder.PSFB21; sfb++) {\n                ATH_psfb21[sfb] = 1E-20;\n            }\n            for (var sfb = 0; sfb < Encoder.SBMAX_s; sfb++) {\n                ATH_s[sfb] = 1E-20;\n            }\n            for (var sfb = 0; sfb < Encoder.PSFB12; sfb++) {\n                ATH_psfb12[sfb] = 1E-20;\n            }\n        }\n\n        /*\n         * work in progress, don't rely on it too much\n         */\n        gfc.ATH.floor = 10. * Math_log10(ATHmdct(gfp, -1.));\n    }\n\n    /**\n     * initialization for iteration_loop\n     */\n    this.iteration_init = function (gfp) {\n        var gfc = gfp.internal_flags;\n        var l3_side = gfc.l3_side;\n        var i;\n\n        if (gfc.iteration_init_init == 0) {\n            gfc.iteration_init_init = 1;\n\n            l3_side.main_data_begin = 0;\n            compute_ath(gfp);\n\n            pow43[0] = 0.0;\n            for (i = 1; i < PRECALC_SIZE; i++)\n                pow43[i] = Math.pow(i, 4.0 / 3.0);\n\n            for (i = 0; i < PRECALC_SIZE - 1; i++)\n                adj43[i] = ((i + 1) - Math.pow(\n                    0.5 * (pow43[i] + pow43[i + 1]), 0.75));\n            adj43[i] = 0.5;\n\n            for (i = 0; i < Q_MAX; i++)\n                ipow20[i] = Math.pow(2.0, (i - 210) * -0.1875);\n            for (i = 0; i <= Q_MAX + Q_MAX2; i++)\n                pow20[i] = Math.pow(2.0, (i - 210 - Q_MAX2) * 0.25);\n\n            tak.huffman_init(gfc);\n\n            {\n                var bass, alto, treble, sfb21;\n\n                i = (gfp.exp_nspsytune >> 2) & 63;\n                if (i >= 32)\n                    i -= 64;\n                bass = Math.pow(10, i / 4.0 / 10.0);\n\n                i = (gfp.exp_nspsytune >> 8) & 63;\n                if (i >= 32)\n                    i -= 64;\n                alto = Math.pow(10, i / 4.0 / 10.0);\n\n                i = (gfp.exp_nspsytune >> 14) & 63;\n                if (i >= 32)\n                    i -= 64;\n                treble = Math.pow(10, i / 4.0 / 10.0);\n\n                /*\n                 * to be compatible with Naoki's original code, the next 6 bits\n                 * define only the amount of changing treble for sfb21\n                 */\n                i = (gfp.exp_nspsytune >> 20) & 63;\n                if (i >= 32)\n                    i -= 64;\n                sfb21 = treble * Math.pow(10, i / 4.0 / 10.0);\n                for (i = 0; i < Encoder.SBMAX_l; i++) {\n                    var f;\n                    if (i <= 6)\n                        f = bass;\n                    else if (i <= 13)\n                        f = alto;\n                    else if (i <= 20)\n                        f = treble;\n                    else\n                        f = sfb21;\n\n                    gfc.nsPsy.longfact[i] = f;\n                }\n                for (i = 0; i < Encoder.SBMAX_s; i++) {\n                    var f;\n                    if (i <= 5)\n                        f = bass;\n                    else if (i <= 10)\n                        f = alto;\n                    else if (i <= 11)\n                        f = treble;\n                    else\n                        f = sfb21;\n\n                    gfc.nsPsy.shortfact[i] = f;\n                }\n            }\n        }\n    }\n\n    /**\n     * allocate bits among 2 channels based on PE<BR>\n     * mt 6/99<BR>\n     * bugfixes rh 8/01: often allocated more than the allowed 4095 bits\n     */\n    this.on_pe = function (gfp, pe,\n                           targ_bits, mean_bits, gr, cbr) {\n        var gfc = gfp.internal_flags;\n        var tbits = 0, bits;\n        var add_bits = new_int(2);\n        var ch;\n\n        /* allocate targ_bits for granule */\n        var mb = new MeanBits(tbits);\n        var extra_bits = rv.ResvMaxBits(gfp, mean_bits, mb, cbr);\n        tbits = mb.bits;\n        /* maximum allowed bits for this granule */\n        var max_bits = tbits + extra_bits;\n        if (max_bits > LameInternalFlags.MAX_BITS_PER_GRANULE) {\n            // hard limit per granule\n            max_bits = LameInternalFlags.MAX_BITS_PER_GRANULE;\n        }\n        for (bits = 0, ch = 0; ch < gfc.channels_out; ++ch) {\n            /******************************************************************\n             * allocate bits for each channel\n             ******************************************************************/\n            targ_bits[ch] = Math.min(LameInternalFlags.MAX_BITS_PER_CHANNEL,\n                tbits / gfc.channels_out);\n\n            add_bits[ch] = 0 | (targ_bits[ch] * pe[gr][ch] / 700.0 - targ_bits[ch]);\n\n            /* at most increase bits by 1.5*average */\n            if (add_bits[ch] > mean_bits * 3 / 4)\n                add_bits[ch] = mean_bits * 3 / 4;\n\n            if (add_bits[ch] < 0)\n                add_bits[ch] = 0;\n\n            if (add_bits[ch] + targ_bits[ch] > LameInternalFlags.MAX_BITS_PER_CHANNEL)\n                add_bits[ch] = Math.max(0,\n                    LameInternalFlags.MAX_BITS_PER_CHANNEL - targ_bits[ch]);\n\n            bits += add_bits[ch];\n        }\n        if (bits > extra_bits) {\n            for (ch = 0; ch < gfc.channels_out; ++ch) {\n                add_bits[ch] = extra_bits * add_bits[ch] / bits;\n            }\n        }\n\n        for (ch = 0; ch < gfc.channels_out; ++ch) {\n            targ_bits[ch] += add_bits[ch];\n            extra_bits -= add_bits[ch];\n        }\n\n        for (bits = 0, ch = 0; ch < gfc.channels_out; ++ch) {\n            bits += targ_bits[ch];\n        }\n        if (bits > LameInternalFlags.MAX_BITS_PER_GRANULE) {\n            var sum = 0;\n            for (ch = 0; ch < gfc.channels_out; ++ch) {\n                targ_bits[ch] *= LameInternalFlags.MAX_BITS_PER_GRANULE;\n                targ_bits[ch] /= bits;\n                sum += targ_bits[ch];\n            }\n        }\n\n        return max_bits;\n    }\n\n    this.reduce_side = function (targ_bits, ms_ener_ratio, mean_bits, max_bits) {\n\n        /*\n         * ms_ener_ratio = 0: allocate 66/33 mid/side fac=.33 ms_ener_ratio =.5:\n         * allocate 50/50 mid/side fac= 0\n         */\n        /* 75/25 split is fac=.5 */\n        var fac = .33 * (.5 - ms_ener_ratio) / .5;\n        if (fac < 0)\n            fac = 0;\n        if (fac > .5)\n            fac = .5;\n\n        /* number of bits to move from side channel to mid channel */\n        /* move_bits = fac*targ_bits[1]; */\n        var move_bits = 0 | (fac * .5 * (targ_bits[0] + targ_bits[1]));\n\n        if (move_bits > LameInternalFlags.MAX_BITS_PER_CHANNEL - targ_bits[0]) {\n            move_bits = LameInternalFlags.MAX_BITS_PER_CHANNEL - targ_bits[0];\n        }\n        if (move_bits < 0)\n            move_bits = 0;\n\n        if (targ_bits[1] >= 125) {\n            /* dont reduce side channel below 125 bits */\n            if (targ_bits[1] - move_bits > 125) {\n\n                /* if mid channel already has 2x more than average, dont bother */\n                /* mean_bits = bits per granule (for both channels) */\n                if (targ_bits[0] < mean_bits)\n                    targ_bits[0] += move_bits;\n                targ_bits[1] -= move_bits;\n            } else {\n                targ_bits[0] += targ_bits[1] - 125;\n                targ_bits[1] = 125;\n            }\n        }\n\n        move_bits = targ_bits[0] + targ_bits[1];\n        if (move_bits > max_bits) {\n            targ_bits[0] = (max_bits * targ_bits[0]) / move_bits;\n            targ_bits[1] = (max_bits * targ_bits[1]) / move_bits;\n        }\n    };\n\n    /**\n     *  Robert Hegemann 2001-04-27:\n     *  this adjusts the ATH, keeping the original noise floor\n     *  affects the higher frequencies more than the lower ones\n     */\n    this.athAdjust = function (a, x, athFloor) {\n        /*\n         * work in progress\n         */\n        var o = 90.30873362;\n        var p = 94.82444863;\n        var u = Util.FAST_LOG10_X(x, 10.0);\n        var v = a * a;\n        var w = 0.0;\n        u -= athFloor;\n        /* undo scaling */\n        if (v > 1E-20)\n            w = 1. + Util.FAST_LOG10_X(v, 10.0 / o);\n        if (w < 0)\n            w = 0.;\n        u *= w;\n        u += athFloor + o - p;\n        /* redo scaling */\n\n        return Math.pow(10., 0.1 * u);\n    };\n\n    /**\n     * Calculate the allowed distortion for each scalefactor band, as determined\n     * by the psychoacoustic model. xmin(sb) = ratio(sb) * en(sb) / bw(sb)\n     *\n     * returns number of sfb's with energy > ATH\n     */\n    this.calc_xmin = function (gfp, ratio, cod_info, pxmin) {\n        var pxminPos = 0;\n        var gfc = gfp.internal_flags;\n        var gsfb, j = 0, ath_over = 0;\n        var ATH = gfc.ATH;\n        var xr = cod_info.xr;\n        var enable_athaa_fix = (gfp.VBR == VbrMode.vbr_mtrh) ? 1 : 0;\n        var masking_lower = gfc.masking_lower;\n\n        if (gfp.VBR == VbrMode.vbr_mtrh || gfp.VBR == VbrMode.vbr_mt) {\n            /* was already done in PSY-Model */\n            masking_lower = 1.0;\n        }\n\n        for (gsfb = 0; gsfb < cod_info.psy_lmax; gsfb++) {\n            var en0, xmin;\n            var rh1, rh2;\n            var width, l;\n\n            if (gfp.VBR == VbrMode.vbr_rh || gfp.VBR == VbrMode.vbr_mtrh)\n                xmin = athAdjust(ATH.adjust, ATH.l[gsfb], ATH.floor);\n            else\n                xmin = ATH.adjust * ATH.l[gsfb];\n\n            width = cod_info.width[gsfb];\n            rh1 = xmin / width;\n            rh2 = DBL_EPSILON;\n            l = width >> 1;\n            en0 = 0.0;\n            do {\n                var xa, xb;\n                xa = xr[j] * xr[j];\n                en0 += xa;\n                rh2 += (xa < rh1) ? xa : rh1;\n                j++;\n                xb = xr[j] * xr[j];\n                en0 += xb;\n                rh2 += (xb < rh1) ? xb : rh1;\n                j++;\n            } while (--l > 0);\n            if (en0 > xmin)\n                ath_over++;\n\n            if (gsfb == Encoder.SBPSY_l) {\n                var x = xmin * gfc.nsPsy.longfact[gsfb];\n                if (rh2 < x) {\n                    rh2 = x;\n                }\n            }\n            if (enable_athaa_fix != 0) {\n                xmin = rh2;\n            }\n            if (!gfp.ATHonly) {\n                var e = ratio.en.l[gsfb];\n                if (e > 0.0) {\n                    var x;\n                    x = en0 * ratio.thm.l[gsfb] * masking_lower / e;\n                    if (enable_athaa_fix != 0)\n                        x *= gfc.nsPsy.longfact[gsfb];\n                    if (xmin < x)\n                        xmin = x;\n                }\n            }\n            if (enable_athaa_fix != 0)\n                pxmin[pxminPos++] = xmin;\n            else\n                pxmin[pxminPos++] = xmin * gfc.nsPsy.longfact[gsfb];\n        }\n        /* end of long block loop */\n\n        /* use this function to determine the highest non-zero coeff */\n        var max_nonzero = 575;\n        if (cod_info.block_type != Encoder.SHORT_TYPE) {\n            // NORM, START or STOP type, but not SHORT\n            var k = 576;\n            while (k-- != 0 && BitStream.EQ(xr[k], 0)) {\n                max_nonzero = k;\n            }\n        }\n        cod_info.max_nonzero_coeff = max_nonzero;\n\n        for (var sfb = cod_info.sfb_smin; gsfb < cod_info.psymax; sfb++, gsfb += 3) {\n            var width, b;\n            var tmpATH;\n            if (gfp.VBR == VbrMode.vbr_rh || gfp.VBR == VbrMode.vbr_mtrh)\n                tmpATH = athAdjust(ATH.adjust, ATH.s[sfb], ATH.floor);\n            else\n                tmpATH = ATH.adjust * ATH.s[sfb];\n\n            width = cod_info.width[gsfb];\n            for (b = 0; b < 3; b++) {\n                var en0 = 0.0, xmin;\n                var rh1, rh2;\n                var l = width >> 1;\n\n                rh1 = tmpATH / width;\n                rh2 = DBL_EPSILON;\n                do {\n                    var xa, xb;\n                    xa = xr[j] * xr[j];\n                    en0 += xa;\n                    rh2 += (xa < rh1) ? xa : rh1;\n                    j++;\n                    xb = xr[j] * xr[j];\n                    en0 += xb;\n                    rh2 += (xb < rh1) ? xb : rh1;\n                    j++;\n                } while (--l > 0);\n                if (en0 > tmpATH)\n                    ath_over++;\n                if (sfb == Encoder.SBPSY_s) {\n                    var x = tmpATH * gfc.nsPsy.shortfact[sfb];\n                    if (rh2 < x) {\n                        rh2 = x;\n                    }\n                }\n                if (enable_athaa_fix != 0)\n                    xmin = rh2;\n                else\n                    xmin = tmpATH;\n\n                if (!gfp.ATHonly && !gfp.ATHshort) {\n                    var e = ratio.en.s[sfb][b];\n                    if (e > 0.0) {\n                        var x;\n                        x = en0 * ratio.thm.s[sfb][b] * masking_lower / e;\n                        if (enable_athaa_fix != 0)\n                            x *= gfc.nsPsy.shortfact[sfb];\n                        if (xmin < x)\n                            xmin = x;\n                    }\n                }\n                if (enable_athaa_fix != 0)\n                    pxmin[pxminPos++] = xmin;\n                else\n                    pxmin[pxminPos++] = xmin * gfc.nsPsy.shortfact[sfb];\n            }\n            /* b */\n            if (gfp.useTemporal) {\n                if (pxmin[pxminPos - 3] > pxmin[pxminPos - 3 + 1])\n                    pxmin[pxminPos - 3 + 1] += (pxmin[pxminPos - 3] - pxmin[pxminPos - 3 + 1])\n                        * gfc.decay;\n                if (pxmin[pxminPos - 3 + 1] > pxmin[pxminPos - 3 + 2])\n                    pxmin[pxminPos - 3 + 2] += (pxmin[pxminPos - 3 + 1] - pxmin[pxminPos - 3 + 2])\n                        * gfc.decay;\n            }\n        }\n        /* end of short block sfb loop */\n\n        return ath_over;\n    };\n\n    function StartLine(j) {\n        this.s = j;\n    }\n\n    this.calc_noise_core = function (cod_info, startline, l, step) {\n        var noise = 0;\n        var j = startline.s;\n        var ix = cod_info.l3_enc;\n\n        if (j > cod_info.count1) {\n            while ((l--) != 0) {\n                var temp;\n                temp = cod_info.xr[j];\n                j++;\n                noise += temp * temp;\n                temp = cod_info.xr[j];\n                j++;\n                noise += temp * temp;\n            }\n        } else if (j > cod_info.big_values) {\n            var ix01 = new_float(2);\n            ix01[0] = 0;\n            ix01[1] = step;\n            while ((l--) != 0) {\n                var temp;\n                temp = Math.abs(cod_info.xr[j]) - ix01[ix[j]];\n                j++;\n                noise += temp * temp;\n                temp = Math.abs(cod_info.xr[j]) - ix01[ix[j]];\n                j++;\n                noise += temp * temp;\n            }\n        } else {\n            while ((l--) != 0) {\n                var temp;\n                temp = Math.abs(cod_info.xr[j]) - pow43[ix[j]] * step;\n                j++;\n                noise += temp * temp;\n                temp = Math.abs(cod_info.xr[j]) - pow43[ix[j]] * step;\n                j++;\n                noise += temp * temp;\n            }\n        }\n\n        startline.s = j;\n        return noise;\n    }\n\n    /**\n     * <PRE>\n     * -oo dB  =>  -1.00\n     * - 6 dB  =>  -0.97\n     * - 3 dB  =>  -0.80\n     * - 2 dB  =>  -0.64\n     * - 1 dB  =>  -0.38\n     *   0 dB  =>   0.00\n     * + 1 dB  =>  +0.49\n     * + 2 dB  =>  +1.06\n     * + 3 dB  =>  +1.68\n     * + 6 dB  =>  +3.69\n     * +10 dB  =>  +6.45\n     * </PRE>\n     */\n    this.calc_noise = function (cod_info, l3_xmin, distort, res, prev_noise) {\n        var distortPos = 0;\n        var l3_xminPos = 0;\n        var sfb, l, over = 0;\n        var over_noise_db = 0;\n        /* 0 dB relative to masking */\n        var tot_noise_db = 0;\n        /* -200 dB relative to masking */\n        var max_noise = -20.0;\n        var j = 0;\n        var scalefac = cod_info.scalefac;\n        var scalefacPos = 0;\n\n        res.over_SSD = 0;\n\n        for (sfb = 0; sfb < cod_info.psymax; sfb++) {\n            var s = cod_info.global_gain\n                - (((scalefac[scalefacPos++]) + (cod_info.preflag != 0 ? pretab[sfb]\n                    : 0)) << (cod_info.scalefac_scale + 1))\n                - cod_info.subblock_gain[cod_info.window[sfb]] * 8;\n            var noise = 0.0;\n\n            if (prev_noise != null && (prev_noise.step[sfb] == s)) {\n\n                /* use previously computed values */\n                noise = prev_noise.noise[sfb];\n                j += cod_info.width[sfb];\n                distort[distortPos++] = noise / l3_xmin[l3_xminPos++];\n\n                noise = prev_noise.noise_log[sfb];\n\n            } else {\n                var step = POW20(s);\n                l = cod_info.width[sfb] >> 1;\n\n                if ((j + cod_info.width[sfb]) > cod_info.max_nonzero_coeff) {\n                    var usefullsize;\n                    usefullsize = cod_info.max_nonzero_coeff - j + 1;\n\n                    if (usefullsize > 0)\n                        l = usefullsize >> 1;\n                    else\n                        l = 0;\n                }\n\n                var sl = new StartLine(j);\n                noise = this.calc_noise_core(cod_info, sl, l, step);\n                j = sl.s;\n\n                if (prev_noise != null) {\n                    /* save noise values */\n                    prev_noise.step[sfb] = s;\n                    prev_noise.noise[sfb] = noise;\n                }\n\n                noise = distort[distortPos++] = noise / l3_xmin[l3_xminPos++];\n\n                /* multiplying here is adding in dB, but can overflow */\n                noise = Util.FAST_LOG10(Math.max(noise, 1E-20));\n\n                if (prev_noise != null) {\n                    /* save noise values */\n                    prev_noise.noise_log[sfb] = noise;\n                }\n            }\n\n            if (prev_noise != null) {\n                /* save noise values */\n                prev_noise.global_gain = cod_info.global_gain;\n            }\n\n            tot_noise_db += noise;\n\n            if (noise > 0.0) {\n                var tmp;\n\n                tmp = Math.max(0 | (noise * 10 + .5), 1);\n                res.over_SSD += tmp * tmp;\n\n                over++;\n                /* multiplying here is adding in dB -but can overflow */\n                /* over_noise *= noise; */\n                over_noise_db += noise;\n            }\n            max_noise = Math.max(max_noise, noise);\n\n        }\n\n        res.over_count = over;\n        res.tot_noise = tot_noise_db;\n        res.over_noise = over_noise_db;\n        res.max_noise = max_noise;\n\n        return over;\n    }\n\n    /**\n     * updates plotting data\n     *\n     * Mark Taylor 2000-??-??\n     *\n     * Robert Hegemann: moved noise/distortion calc into it\n     */\n    this.set_pinfo = function (gfp, cod_info, ratio, gr, ch) {\n        var gfc = gfp.internal_flags;\n        var sfb, sfb2;\n        var l;\n        var en0, en1;\n        var ifqstep = (cod_info.scalefac_scale == 0) ? .5 : 1.0;\n        var scalefac = cod_info.scalefac;\n\n        var l3_xmin = new_float(L3Side.SFBMAX);\n        var xfsf = new_float(L3Side.SFBMAX);\n        var noise = new CalcNoiseResult();\n\n        calc_xmin(gfp, ratio, cod_info, l3_xmin);\n        calc_noise(cod_info, l3_xmin, xfsf, noise, null);\n\n        var j = 0;\n        sfb2 = cod_info.sfb_lmax;\n        if (cod_info.block_type != Encoder.SHORT_TYPE\n            && 0 == cod_info.mixed_block_flag)\n            sfb2 = 22;\n        for (sfb = 0; sfb < sfb2; sfb++) {\n            var start = gfc.scalefac_band.l[sfb];\n            var end = gfc.scalefac_band.l[sfb + 1];\n            var bw = end - start;\n            for (en0 = 0.0; j < end; j++)\n                en0 += cod_info.xr[j] * cod_info.xr[j];\n            en0 /= bw;\n            /* convert to MDCT units */\n            /* scaling so it shows up on FFT plot */\n            en1 = 1e15;\n            gfc.pinfo.en[gr][ch][sfb] = en1 * en0;\n            gfc.pinfo.xfsf[gr][ch][sfb] = en1 * l3_xmin[sfb] * xfsf[sfb] / bw;\n\n            if (ratio.en.l[sfb] > 0 && !gfp.ATHonly)\n                en0 = en0 / ratio.en.l[sfb];\n            else\n                en0 = 0.0;\n\n            gfc.pinfo.thr[gr][ch][sfb] = en1\n                * Math.max(en0 * ratio.thm.l[sfb], gfc.ATH.l[sfb]);\n\n            /* there is no scalefactor bands >= SBPSY_l */\n            gfc.pinfo.LAMEsfb[gr][ch][sfb] = 0;\n            if (cod_info.preflag != 0 && sfb >= 11)\n                gfc.pinfo.LAMEsfb[gr][ch][sfb] = -ifqstep * pretab[sfb];\n\n            if (sfb < Encoder.SBPSY_l) {\n                /* scfsi should be decoded by caller side */\n                gfc.pinfo.LAMEsfb[gr][ch][sfb] -= ifqstep * scalefac[sfb];\n            }\n        }\n        /* for sfb */\n\n        if (cod_info.block_type == Encoder.SHORT_TYPE) {\n            sfb2 = sfb;\n            for (sfb = cod_info.sfb_smin; sfb < Encoder.SBMAX_s; sfb++) {\n                var start = gfc.scalefac_band.s[sfb];\n                var end = gfc.scalefac_band.s[sfb + 1];\n                var bw = end - start;\n                for (var i = 0; i < 3; i++) {\n                    for (en0 = 0.0, l = start; l < end; l++) {\n                        en0 += cod_info.xr[j] * cod_info.xr[j];\n                        j++;\n                    }\n                    en0 = Math.max(en0 / bw, 1e-20);\n                    /* convert to MDCT units */\n                    /* scaling so it shows up on FFT plot */\n                    en1 = 1e15;\n\n                    gfc.pinfo.en_s[gr][ch][3 * sfb + i] = en1 * en0;\n                    gfc.pinfo.xfsf_s[gr][ch][3 * sfb + i] = en1 * l3_xmin[sfb2]\n                        * xfsf[sfb2] / bw;\n                    if (ratio.en.s[sfb][i] > 0)\n                        en0 = en0 / ratio.en.s[sfb][i];\n                    else\n                        en0 = 0.0;\n                    if (gfp.ATHonly || gfp.ATHshort)\n                        en0 = 0;\n\n                    gfc.pinfo.thr_s[gr][ch][3 * sfb + i] = en1\n                        * Math.max(en0 * ratio.thm.s[sfb][i],\n                            gfc.ATH.s[sfb]);\n\n                    /* there is no scalefactor bands >= SBPSY_s */\n                    gfc.pinfo.LAMEsfb_s[gr][ch][3 * sfb + i] = -2.0\n                        * cod_info.subblock_gain[i];\n                    if (sfb < Encoder.SBPSY_s) {\n                        gfc.pinfo.LAMEsfb_s[gr][ch][3 * sfb + i] -= ifqstep\n                            * scalefac[sfb2];\n                    }\n                    sfb2++;\n                }\n            }\n        }\n        /* block type short */\n        gfc.pinfo.LAMEqss[gr][ch] = cod_info.global_gain;\n        gfc.pinfo.LAMEmainbits[gr][ch] = cod_info.part2_3_length\n            + cod_info.part2_length;\n        gfc.pinfo.LAMEsfbits[gr][ch] = cod_info.part2_length;\n\n        gfc.pinfo.over[gr][ch] = noise.over_count;\n        gfc.pinfo.max_noise[gr][ch] = noise.max_noise * 10.0;\n        gfc.pinfo.over_noise[gr][ch] = noise.over_noise * 10.0;\n        gfc.pinfo.tot_noise[gr][ch] = noise.tot_noise * 10.0;\n        gfc.pinfo.over_SSD[gr][ch] = noise.over_SSD;\n    }\n\n    /**\n     * updates plotting data for a whole frame\n     *\n     * Robert Hegemann 2000-10-21\n     */\n    function set_frame_pinfo(gfp, ratio) {\n        var gfc = gfp.internal_flags;\n\n        gfc.masking_lower = 1.0;\n\n        /*\n         * for every granule and channel patch l3_enc and set info\n         */\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            for (var ch = 0; ch < gfc.channels_out; ch++) {\n                var cod_info = gfc.l3_side.tt[gr][ch];\n                var scalefac_sav = new_int(L3Side.SFBMAX);\n                System.arraycopy(cod_info.scalefac, 0, scalefac_sav, 0,\n                    scalefac_sav.length);\n\n                /*\n                 * reconstruct the scalefactors in case SCFSI was used\n                 */\n                if (gr == 1) {\n                    var sfb;\n                    for (sfb = 0; sfb < cod_info.sfb_lmax; sfb++) {\n                        if (cod_info.scalefac[sfb] < 0) /* scfsi */\n                            cod_info.scalefac[sfb] = gfc.l3_side.tt[0][ch].scalefac[sfb];\n                    }\n                }\n\n                set_pinfo(gfp, cod_info, ratio[gr][ch], gr, ch);\n                System.arraycopy(scalefac_sav, 0, cod_info.scalefac, 0,\n                    scalefac_sav.length);\n            }\n            /* for ch */\n        }\n        /* for gr */\n    }\n\n}\n\n\nfunction CalcNoiseData() {\n    this.global_gain = 0;\n    this.sfb_count1 = 0;\n    this.step = new_int(39);\n    this.noise = new_float(39);\n    this.noise_log = new_float(39);\n}\n\n//package mp3;\n\n\nfunction GrInfo() {\n    //float xr[] = new float[576];\n    this.xr = new_float(576);\n    //int l3_enc[] = new int[576];\n    this.l3_enc = new_int(576);\n    //int scalefac[] = new int[L3Side.SFBMAX];\n    this.scalefac = new_int(L3Side.SFBMAX);\n    this.xrpow_max = 0.;\n\n    this.part2_3_length = 0;\n    this.big_values = 0;\n    this.count1 = 0;\n    this.global_gain = 0;\n    this.scalefac_compress = 0;\n    this.block_type = 0;\n    this.mixed_block_flag = 0;\n    this.table_select = new_int(3);\n    this.subblock_gain = new_int(3 + 1);\n    this.region0_count = 0;\n    this.region1_count = 0;\n    this.preflag = 0;\n    this.scalefac_scale = 0;\n    this.count1table_select = 0;\n\n    this.part2_length = 0;\n    this.sfb_lmax = 0;\n    this.sfb_smin = 0;\n    this.psy_lmax = 0;\n    this.sfbmax = 0;\n    this.psymax = 0;\n    this.sfbdivide = 0;\n    this.width = new_int(L3Side.SFBMAX);\n    this.window = new_int(L3Side.SFBMAX);\n    this.count1bits = 0;\n    /**\n     * added for LSF\n     */\n    this.sfb_partition_table = null;\n    this.slen = new_int(4);\n\n    this.max_nonzero_coeff = 0;\n\n    var self = this;\n    function clone_int(array) {\n        return new Int32Array(array);\n    }\n    function clone_float(array) {\n        return new Float32Array(array);\n    }\n    this.assign = function (other) {\n        self.xr = clone_float(other.xr); //.slice(0); //clone();\n        self.l3_enc = clone_int(other.l3_enc); //.slice(0); //clone();\n        self.scalefac = clone_int(other.scalefac);//.slice(0); //clone();\n        self.xrpow_max = other.xrpow_max;\n\n        self.part2_3_length = other.part2_3_length;\n        self.big_values = other.big_values;\n        self.count1 = other.count1;\n        self.global_gain = other.global_gain;\n        self.scalefac_compress = other.scalefac_compress;\n        self.block_type = other.block_type;\n        self.mixed_block_flag = other.mixed_block_flag;\n        self.table_select = clone_int(other.table_select);//.slice(0); //clone();\n        self.subblock_gain = clone_int(other.subblock_gain); //.slice(0); //.clone();\n        self.region0_count = other.region0_count;\n        self.region1_count = other.region1_count;\n        self.preflag = other.preflag;\n        self.scalefac_scale = other.scalefac_scale;\n        self.count1table_select = other.count1table_select;\n\n        self.part2_length = other.part2_length;\n        self.sfb_lmax = other.sfb_lmax;\n        self.sfb_smin = other.sfb_smin;\n        self.psy_lmax = other.psy_lmax;\n        self.sfbmax = other.sfbmax;\n        self.psymax = other.psymax;\n        self.sfbdivide = other.sfbdivide;\n        self.width = clone_int(other.width); //.slice(0); //.clone();\n        self.window = clone_int(other.window); //.slice(0); //.clone();\n        self.count1bits = other.count1bits;\n\n        self.sfb_partition_table = other.sfb_partition_table.slice(0); //.clone();\n        self.slen = clone_int(other.slen); //.slice(0); //.clone();\n        self.max_nonzero_coeff = other.max_nonzero_coeff;\n    }\n}\n\n\nvar L3Side = {};\n\n\n\t/**\n\t * max scalefactor band, max(SBMAX_l, SBMAX_s*3, (SBMAX_s-3)*3+8)\n\t */\nL3Side.SFBMAX = (Encoder.SBMAX_s * 3);\n\n/*\n * MP3 quantization\n *\n *      Copyright (c) 1999-2000 Mark Taylor\n *      Copyright (c) 1999-2003 Takehiro Tominaga\n *      Copyright (c) 2000-2007 Robert Hegemann\n *      Copyright (c) 2001-2005 Gabriel Bouvigne\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.     See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n\n/* $Id: Quantize.java,v 1.24 2011/05/24 20:48:06 kenchis Exp $ */\n\n//package mp3;\n\n//import java.util.Arrays;\n\n\nfunction Quantize() {\n    var bs;\n    this.rv = null;\n    var rv;\n    this.qupvt = null;\n    var qupvt;\n\n    var vbr = new VBRQuantize();\n    var tk;\n\n    this.setModules = function (_bs, _rv, _qupvt, _tk) {\n        bs = _bs;\n        rv = _rv;\n        this.rv = _rv;\n        qupvt = _qupvt;\n        this.qupvt = _qupvt;\n        tk = _tk;\n        vbr.setModules(qupvt, tk);\n    }\n\n    /**\n     * convert from L/R <. Mid/Side\n     */\n    this.ms_convert = function (l3_side, gr) {\n        for (var i = 0; i < 576; ++i) {\n            var l = l3_side.tt[gr][0].xr[i];\n            var r = l3_side.tt[gr][1].xr[i];\n            l3_side.tt[gr][0].xr[i] = (l + r) * (Util.SQRT2 * 0.5);\n            l3_side.tt[gr][1].xr[i] = (l - r) * (Util.SQRT2 * 0.5);\n        }\n    };\n\n    /**\n     * mt 6/99\n     *\n     * initializes cod_info, scalefac and xrpow\n     *\n     * returns 0 if all energies in xr are zero, else 1\n     */\n    function init_xrpow_core(cod_info, xrpow, upper, sum) {\n        sum = 0;\n        for (var i = 0; i <= upper; ++i) {\n            var tmp = Math.abs(cod_info.xr[i]);\n            sum += tmp;\n            xrpow[i] = Math.sqrt(tmp * Math.sqrt(tmp));\n\n            if (xrpow[i] > cod_info.xrpow_max)\n                cod_info.xrpow_max = xrpow[i];\n        }\n        return sum;\n    }\n\n    this.init_xrpow = function (gfc, cod_info, xrpow) {\n        var sum = 0;\n        var upper = 0 | cod_info.max_nonzero_coeff;\n\n        cod_info.xrpow_max = 0;\n\n        /*\n         * check if there is some energy we have to quantize and calculate xrpow\n         * matching our fresh scalefactors\n         */\n\n        Arrays.fill(xrpow, upper, 576, 0);\n\n        sum = init_xrpow_core(cod_info, xrpow, upper, sum);\n\n        /*\n         * return 1 if we have something to quantize, else 0\n         */\n        if (sum > 1E-20) {\n            var j = 0;\n            if ((gfc.substep_shaping & 2) != 0)\n                j = 1;\n\n            for (var i = 0; i < cod_info.psymax; i++)\n                gfc.pseudohalf[i] = j;\n\n            return true;\n        }\n\n        Arrays.fill(cod_info.l3_enc, 0, 576, 0);\n        return false;\n    }\n\n    /**\n     * Gabriel Bouvigne feb/apr 2003<BR>\n     * Analog silence detection in partitionned sfb21 or sfb12 for short blocks\n     *\n     * From top to bottom of sfb, changes to 0 coeffs which are below ath. It\n     * stops on the first coeff higher than ath.\n     */\n    function psfb21_analogsilence(gfc, cod_info) {\n        var ath = gfc.ATH;\n        var xr = cod_info.xr;\n\n        if (cod_info.block_type != Encoder.SHORT_TYPE) {\n            /* NORM, START or STOP type, but not SHORT blocks */\n            var stop = false;\n            for (var gsfb = Encoder.PSFB21 - 1; gsfb >= 0 && !stop; gsfb--) {\n                var start = gfc.scalefac_band.psfb21[gsfb];\n                var end = gfc.scalefac_band.psfb21[gsfb + 1];\n                var ath21 = qupvt.athAdjust(ath.adjust, ath.psfb21[gsfb],\n                    ath.floor);\n\n                if (gfc.nsPsy.longfact[21] > 1e-12)\n                    ath21 *= gfc.nsPsy.longfact[21];\n\n                for (var j = end - 1; j >= start; j--) {\n                    if (Math.abs(xr[j]) < ath21)\n                        xr[j] = 0;\n                    else {\n                        stop = true;\n                        break;\n                    }\n                }\n            }\n        } else {\n            /* note: short blocks coeffs are reordered */\n            for (var block = 0; block < 3; block++) {\n                var stop = false;\n                for (var gsfb = Encoder.PSFB12 - 1; gsfb >= 0 && !stop; gsfb--) {\n                    var start = gfc.scalefac_band.s[12]\n                        * 3\n                        + (gfc.scalefac_band.s[13] - gfc.scalefac_band.s[12])\n                        * block\n                        + (gfc.scalefac_band.psfb12[gsfb] - gfc.scalefac_band.psfb12[0]);\n                    var end = start\n                        + (gfc.scalefac_band.psfb12[gsfb + 1] - gfc.scalefac_band.psfb12[gsfb]);\n                    var ath12 = qupvt.athAdjust(ath.adjust, ath.psfb12[gsfb],\n                        ath.floor);\n\n                    if (gfc.nsPsy.shortfact[12] > 1e-12)\n                        ath12 *= gfc.nsPsy.shortfact[12];\n\n                    for (var j = end - 1; j >= start; j--) {\n                        if (Math.abs(xr[j]) < ath12)\n                            xr[j] = 0;\n                        else {\n                            stop = true;\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n\n    }\n\n    this.init_outer_loop = function (gfc, cod_info) {\n        /*\n         * initialize fresh cod_info\n         */\n        cod_info.part2_3_length = 0;\n        cod_info.big_values = 0;\n        cod_info.count1 = 0;\n        cod_info.global_gain = 210;\n        cod_info.scalefac_compress = 0;\n        /* mixed_block_flag, block_type was set in psymodel.c */\n        cod_info.table_select[0] = 0;\n        cod_info.table_select[1] = 0;\n        cod_info.table_select[2] = 0;\n        cod_info.subblock_gain[0] = 0;\n        cod_info.subblock_gain[1] = 0;\n        cod_info.subblock_gain[2] = 0;\n        cod_info.subblock_gain[3] = 0;\n        /* this one is always 0 */\n        cod_info.region0_count = 0;\n        cod_info.region1_count = 0;\n        cod_info.preflag = 0;\n        cod_info.scalefac_scale = 0;\n        cod_info.count1table_select = 0;\n        cod_info.part2_length = 0;\n        cod_info.sfb_lmax = Encoder.SBPSY_l;\n        cod_info.sfb_smin = Encoder.SBPSY_s;\n        cod_info.psy_lmax = gfc.sfb21_extra ? Encoder.SBMAX_l : Encoder.SBPSY_l;\n        cod_info.psymax = cod_info.psy_lmax;\n        cod_info.sfbmax = cod_info.sfb_lmax;\n        cod_info.sfbdivide = 11;\n        for (var sfb = 0; sfb < Encoder.SBMAX_l; sfb++) {\n            cod_info.width[sfb] = gfc.scalefac_band.l[sfb + 1]\n                - gfc.scalefac_band.l[sfb];\n            /* which is always 0. */\n            cod_info.window[sfb] = 3;\n        }\n        if (cod_info.block_type == Encoder.SHORT_TYPE) {\n            var ixwork = new_float(576);\n\n            cod_info.sfb_smin = 0;\n            cod_info.sfb_lmax = 0;\n            if (cod_info.mixed_block_flag != 0) {\n                /*\n                 * MPEG-1: sfbs 0-7 long block, 3-12 short blocks MPEG-2(.5):\n                 * sfbs 0-5 long block, 3-12 short blocks\n                 */\n                cod_info.sfb_smin = 3;\n                cod_info.sfb_lmax = gfc.mode_gr * 2 + 4;\n            }\n            cod_info.psymax = cod_info.sfb_lmax\n                + 3\n                * ((gfc.sfb21_extra ? Encoder.SBMAX_s : Encoder.SBPSY_s) - cod_info.sfb_smin);\n            cod_info.sfbmax = cod_info.sfb_lmax + 3\n                * (Encoder.SBPSY_s - cod_info.sfb_smin);\n            cod_info.sfbdivide = cod_info.sfbmax - 18;\n            cod_info.psy_lmax = cod_info.sfb_lmax;\n            /* re-order the short blocks, for more efficient encoding below */\n            /* By Takehiro TOMINAGA */\n            /*\n             * Within each scalefactor band, data is given for successive time\n             * windows, beginning with window 0 and ending with window 2. Within\n             * each window, the quantized values are then arranged in order of\n             * increasing frequency...\n             */\n            var ix = gfc.scalefac_band.l[cod_info.sfb_lmax];\n            System.arraycopy(cod_info.xr, 0, ixwork, 0, 576);\n            for (var sfb = cod_info.sfb_smin; sfb < Encoder.SBMAX_s; sfb++) {\n                var start = gfc.scalefac_band.s[sfb];\n                var end = gfc.scalefac_band.s[sfb + 1];\n                for (var window = 0; window < 3; window++) {\n                    for (var l = start; l < end; l++) {\n                        cod_info.xr[ix++] = ixwork[3 * l + window];\n                    }\n                }\n            }\n\n            var j = cod_info.sfb_lmax;\n            for (var sfb = cod_info.sfb_smin; sfb < Encoder.SBMAX_s; sfb++) {\n                cod_info.width[j] = cod_info.width[j + 1] = cod_info.width[j + 2] = gfc.scalefac_band.s[sfb + 1]\n                    - gfc.scalefac_band.s[sfb];\n                cod_info.window[j] = 0;\n                cod_info.window[j + 1] = 1;\n                cod_info.window[j + 2] = 2;\n                j += 3;\n            }\n        }\n\n        cod_info.count1bits = 0;\n        cod_info.sfb_partition_table = qupvt.nr_of_sfb_block[0][0];\n        cod_info.slen[0] = 0;\n        cod_info.slen[1] = 0;\n        cod_info.slen[2] = 0;\n        cod_info.slen[3] = 0;\n\n        cod_info.max_nonzero_coeff = 575;\n\n        /*\n         * fresh scalefactors are all zero\n         */\n        Arrays.fill(cod_info.scalefac, 0);\n\n        psfb21_analogsilence(gfc, cod_info);\n    };\n\n    function BinSearchDirection(ordinal) {\n        this.ordinal = ordinal;\n    }\n\n    BinSearchDirection.BINSEARCH_NONE = new BinSearchDirection(0);\n    BinSearchDirection.BINSEARCH_UP = new BinSearchDirection(1);\n    BinSearchDirection.BINSEARCH_DOWN = new BinSearchDirection(2);\n\n    /**\n     * author/date??\n     *\n     * binary step size search used by outer_loop to get a quantizer step size\n     * to start with\n     */\n    function bin_search_StepSize(gfc, cod_info, desired_rate, ch, xrpow) {\n        var nBits;\n        var CurrentStep = gfc.CurrentStep[ch];\n        var flagGoneOver = false;\n        var start = gfc.OldValue[ch];\n        var Direction = BinSearchDirection.BINSEARCH_NONE;\n        cod_info.global_gain = start;\n        desired_rate -= cod_info.part2_length;\n\n        for (; ;) {\n            var step;\n            nBits = tk.count_bits(gfc, xrpow, cod_info, null);\n\n            if (CurrentStep == 1 || nBits == desired_rate)\n                break;\n            /* nothing to adjust anymore */\n\n            if (nBits > desired_rate) {\n                /* increase Quantize_StepSize */\n                if (Direction == BinSearchDirection.BINSEARCH_DOWN)\n                    flagGoneOver = true;\n\n                if (flagGoneOver)\n                    CurrentStep /= 2;\n                Direction = BinSearchDirection.BINSEARCH_UP;\n                step = CurrentStep;\n            } else {\n                /* decrease Quantize_StepSize */\n                if (Direction == BinSearchDirection.BINSEARCH_UP)\n                    flagGoneOver = true;\n\n                if (flagGoneOver)\n                    CurrentStep /= 2;\n                Direction = BinSearchDirection.BINSEARCH_DOWN;\n                step = -CurrentStep;\n            }\n            cod_info.global_gain += step;\n            if (cod_info.global_gain < 0) {\n                cod_info.global_gain = 0;\n                flagGoneOver = true;\n            }\n            if (cod_info.global_gain > 255) {\n                cod_info.global_gain = 255;\n                flagGoneOver = true;\n            }\n        }\n\n\n        while (nBits > desired_rate && cod_info.global_gain < 255) {\n            cod_info.global_gain++;\n            nBits = tk.count_bits(gfc, xrpow, cod_info, null);\n        }\n        gfc.CurrentStep[ch] = (start - cod_info.global_gain >= 4) ? 4 : 2;\n        gfc.OldValue[ch] = cod_info.global_gain;\n        cod_info.part2_3_length = nBits;\n        return nBits;\n    }\n\n    this.trancate_smallspectrums = function (gfc, gi, l3_xmin, work) {\n        var distort = new_float(L3Side.SFBMAX);\n\n        if ((0 == (gfc.substep_shaping & 4) && gi.block_type == Encoder.SHORT_TYPE)\n            || (gfc.substep_shaping & 0x80) != 0)\n            return;\n        qupvt.calc_noise(gi, l3_xmin, distort, new CalcNoiseResult(), null);\n        for (var j = 0; j < 576; j++) {\n            var xr = 0.0;\n            if (gi.l3_enc[j] != 0)\n                xr = Math.abs(gi.xr[j]);\n            work[j] = xr;\n        }\n\n        var j = 0;\n        var sfb = 8;\n        if (gi.block_type == Encoder.SHORT_TYPE)\n            sfb = 6;\n        do {\n            var allowedNoise, trancateThreshold;\n            var nsame, start;\n\n            var width = gi.width[sfb];\n            j += width;\n            if (distort[sfb] >= 1.0)\n                continue;\n\n            Arrays.sort(work, j - width, width);\n            if (BitStream.EQ(work[j - 1], 0.0))\n                continue;\n            /* all zero sfb */\n\n            allowedNoise = (1.0 - distort[sfb]) * l3_xmin[sfb];\n            trancateThreshold = 0.0;\n            start = 0;\n            do {\n                var noise;\n                for (nsame = 1; start + nsame < width; nsame++)\n                    if (BitStream.NEQ(work[start + j - width], work[start + j\n                        + nsame - width]))\n                        break;\n\n                noise = work[start + j - width] * work[start + j - width]\n                    * nsame;\n                if (allowedNoise < noise) {\n                    if (start != 0)\n                        trancateThreshold = work[start + j - width - 1];\n                    break;\n                }\n                allowedNoise -= noise;\n                start += nsame;\n            } while (start < width);\n            if (BitStream.EQ(trancateThreshold, 0.0))\n                continue;\n\n            do {\n                if (Math.abs(gi.xr[j - width]) <= trancateThreshold)\n                    gi.l3_enc[j - width] = 0;\n            } while (--width > 0);\n        } while (++sfb < gi.psymax);\n\n        gi.part2_3_length = tk.noquant_count_bits(gfc, gi, null);\n    };\n\n    /**\n     * author/date??\n     *\n     * Function: Returns zero if there is a scalefac which has not been\n     * amplified. Otherwise it returns one.\n     */\n    function loop_break(cod_info) {\n        for (var sfb = 0; sfb < cod_info.sfbmax; sfb++)\n            if (cod_info.scalefac[sfb]\n                + cod_info.subblock_gain[cod_info.window[sfb]] == 0)\n                return false;\n\n        return true;\n    }\n\n    /* mt 5/99: Function: Improved calc_noise for a single channel */\n\n    function penalties(noise) {\n        return Util.FAST_LOG10((0.368 + 0.632 * noise * noise * noise));\n    }\n\n    /**\n     * author/date??\n     *\n     * several different codes to decide which quantization is better\n     */\n    function get_klemm_noise(distort, gi) {\n        var klemm_noise = 1E-37;\n        for (var sfb = 0; sfb < gi.psymax; sfb++)\n            klemm_noise += penalties(distort[sfb]);\n\n        return Math.max(1e-20, klemm_noise);\n    }\n\n    function quant_compare(quant_comp, best, calc, gi, distort) {\n        /**\n         * noise is given in decibels (dB) relative to masking thesholds.<BR>\n         *\n         * over_noise: ??? (the previous comment is fully wrong)<BR>\n         * tot_noise: ??? (the previous comment is fully wrong)<BR>\n         * max_noise: max quantization noise\n         */\n        var better;\n\n        switch (quant_comp) {\n            default:\n            case 9:\n            {\n                if (best.over_count > 0) {\n                    /* there are distorted sfb */\n                    better = calc.over_SSD <= best.over_SSD;\n                    if (calc.over_SSD == best.over_SSD)\n                        better = calc.bits < best.bits;\n                } else {\n                    /* no distorted sfb */\n                    better = ((calc.max_noise < 0) && ((calc.max_noise * 10 + calc.bits) <= (best.max_noise * 10 + best.bits)));\n                }\n                break;\n            }\n\n            case 0:\n                better = calc.over_count < best.over_count\n                    || (calc.over_count == best.over_count && calc.over_noise < best.over_noise)\n                    || (calc.over_count == best.over_count\n                    && BitStream.EQ(calc.over_noise, best.over_noise) && calc.tot_noise < best.tot_noise);\n                break;\n\n            case 8:\n                calc.max_noise = get_klemm_noise(distort, gi);\n            //$FALL-THROUGH$\n            case 1:\n                better = calc.max_noise < best.max_noise;\n                break;\n            case 2:\n                better = calc.tot_noise < best.tot_noise;\n                break;\n            case 3:\n                better = (calc.tot_noise < best.tot_noise)\n                    && (calc.max_noise < best.max_noise);\n                break;\n            case 4:\n                better = (calc.max_noise <= 0.0 && best.max_noise > 0.2)\n                    || (calc.max_noise <= 0.0 && best.max_noise < 0.0\n                    && best.max_noise > calc.max_noise - 0.2 && calc.tot_noise < best.tot_noise)\n                    || (calc.max_noise <= 0.0 && best.max_noise > 0.0\n                    && best.max_noise > calc.max_noise - 0.2 && calc.tot_noise < best.tot_noise\n                    + best.over_noise)\n                    || (calc.max_noise > 0.0 && best.max_noise > -0.05\n                    && best.max_noise > calc.max_noise - 0.1 && calc.tot_noise\n                    + calc.over_noise < best.tot_noise\n                    + best.over_noise)\n                    || (calc.max_noise > 0.0 && best.max_noise > -0.1\n                    && best.max_noise > calc.max_noise - 0.15 && calc.tot_noise\n                    + calc.over_noise + calc.over_noise < best.tot_noise\n                    + best.over_noise + best.over_noise);\n                break;\n            case 5:\n                better = calc.over_noise < best.over_noise\n                    || (BitStream.EQ(calc.over_noise, best.over_noise) && calc.tot_noise < best.tot_noise);\n                break;\n            case 6:\n                better = calc.over_noise < best.over_noise\n                    || (BitStream.EQ(calc.over_noise, best.over_noise) && (calc.max_noise < best.max_noise || (BitStream\n                        .EQ(calc.max_noise, best.max_noise) && calc.tot_noise <= best.tot_noise)));\n                break;\n            case 7:\n                better = calc.over_count < best.over_count\n                    || calc.over_noise < best.over_noise;\n                break;\n        }\n\n        if (best.over_count == 0) {\n            /*\n             * If no distorted bands, only use this quantization if it is\n             * better, and if it uses less bits. Unfortunately, part2_3_length\n             * is sometimes a poor estimator of the final size at low bitrates.\n             */\n            better = better && calc.bits < best.bits;\n        }\n\n        return better;\n    }\n\n    /**\n     * author/date??\n     *\n     * <PRE>\n     *  Amplify the scalefactor bands that violate the masking threshold.\n     *  See ISO 11172-3 Section C.1.5.4.3.5\n     *\n     *  distort[] = noise/masking\n     *  distort[] > 1   ==> noise is not masked\n     *  distort[] < 1   ==> noise is masked\n     *  max_dist = maximum value of distort[]\n     *\n     *  Three algorithms:\n     *  noise_shaping_amp\n     *        0             Amplify all bands with distort[]>1.\n     *\n     *        1             Amplify all bands with distort[] >= max_dist^(.5);\n     *                     ( 50% in the db scale)\n     *\n     *        2             Amplify first band with distort[] >= max_dist;\n     *\n     *\n     *  For algorithms 0 and 1, if max_dist < 1, then amplify all bands\n     *  with distort[] >= .95*max_dist.  This is to make sure we always\n     *  amplify at least one band.\n     * </PRE>\n     */\n    function amp_scalefac_bands(gfp, cod_info, distort, xrpow, bRefine) {\n        var gfc = gfp.internal_flags;\n        var ifqstep34;\n\n        if (cod_info.scalefac_scale == 0) {\n            ifqstep34 = 1.29683955465100964055;\n            /* 2**(.75*.5) */\n        } else {\n            ifqstep34 = 1.68179283050742922612;\n            /* 2**(.75*1) */\n        }\n\n        /* compute maximum value of distort[] */\n        var trigger = 0;\n        for (var sfb = 0; sfb < cod_info.sfbmax; sfb++) {\n            if (trigger < distort[sfb])\n                trigger = distort[sfb];\n        }\n\n        var noise_shaping_amp = gfc.noise_shaping_amp;\n        if (noise_shaping_amp == 3) {\n            if (bRefine)\n                noise_shaping_amp = 2;\n            else\n                noise_shaping_amp = 1;\n        }\n        switch (noise_shaping_amp) {\n            case 2:\n                /* amplify exactly 1 band */\n                break;\n\n            case 1:\n                /* amplify bands within 50% of max (on db scale) */\n                if (trigger > 1.0)\n                    trigger = Math.pow(trigger, .5);\n                else\n                    trigger *= .95;\n                break;\n\n            case 0:\n            default:\n                /* ISO algorithm. amplify all bands with distort>1 */\n                if (trigger > 1.0)\n                    trigger = 1.0;\n                else\n                    trigger *= .95;\n                break;\n        }\n\n        var j = 0;\n        for (var sfb = 0; sfb < cod_info.sfbmax; sfb++) {\n            var width = cod_info.width[sfb];\n            var l;\n            j += width;\n            if (distort[sfb] < trigger)\n                continue;\n\n            if ((gfc.substep_shaping & 2) != 0) {\n                gfc.pseudohalf[sfb] = (0 == gfc.pseudohalf[sfb]) ? 1 : 0;\n                if (0 == gfc.pseudohalf[sfb] && gfc.noise_shaping_amp == 2)\n                    return;\n            }\n            cod_info.scalefac[sfb]++;\n            for (l = -width; l < 0; l++) {\n                xrpow[j + l] *= ifqstep34;\n                if (xrpow[j + l] > cod_info.xrpow_max)\n                    cod_info.xrpow_max = xrpow[j + l];\n            }\n\n            if (gfc.noise_shaping_amp == 2)\n                return;\n        }\n    }\n\n    /**\n     * Takehiro Tominaga 2000-xx-xx\n     *\n     * turns on scalefac scale and adjusts scalefactors\n     */\n    function inc_scalefac_scale(cod_info, xrpow) {\n        var ifqstep34 = 1.29683955465100964055;\n\n        var j = 0;\n        for (var sfb = 0; sfb < cod_info.sfbmax; sfb++) {\n            var width = cod_info.width[sfb];\n            var s = cod_info.scalefac[sfb];\n            if (cod_info.preflag != 0)\n                s += qupvt.pretab[sfb];\n            j += width;\n            if ((s & 1) != 0) {\n                s++;\n                for (var l = -width; l < 0; l++) {\n                    xrpow[j + l] *= ifqstep34;\n                    if (xrpow[j + l] > cod_info.xrpow_max)\n                        cod_info.xrpow_max = xrpow[j + l];\n                }\n            }\n            cod_info.scalefac[sfb] = s >> 1;\n        }\n        cod_info.preflag = 0;\n        cod_info.scalefac_scale = 1;\n    }\n\n    /**\n     * Takehiro Tominaga 2000-xx-xx\n     *\n     * increases the subblock gain and adjusts scalefactors\n     */\n    function inc_subblock_gain(gfc, cod_info, xrpow) {\n        var sfb;\n        var scalefac = cod_info.scalefac;\n\n        /* subbloc_gain can't do anything in the long block region */\n        for (sfb = 0; sfb < cod_info.sfb_lmax; sfb++) {\n            if (scalefac[sfb] >= 16)\n                return true;\n        }\n\n        for (var window = 0; window < 3; window++) {\n            var s1 = 0;\n            var s2 = 0;\n\n            for (sfb = cod_info.sfb_lmax + window; sfb < cod_info.sfbdivide; sfb += 3) {\n                if (s1 < scalefac[sfb])\n                    s1 = scalefac[sfb];\n            }\n            for (; sfb < cod_info.sfbmax; sfb += 3) {\n                if (s2 < scalefac[sfb])\n                    s2 = scalefac[sfb];\n            }\n\n            if (s1 < 16 && s2 < 8)\n                continue;\n\n            if (cod_info.subblock_gain[window] >= 7)\n                return true;\n\n            /*\n             * even though there is no scalefactor for sfb12 subblock gain\n             * affects upper frequencies too, that's why we have to go up to\n             * SBMAX_s\n             */\n            cod_info.subblock_gain[window]++;\n            var j = gfc.scalefac_band.l[cod_info.sfb_lmax];\n            for (sfb = cod_info.sfb_lmax + window; sfb < cod_info.sfbmax; sfb += 3) {\n                var amp;\n                var width = cod_info.width[sfb];\n                var s = scalefac[sfb];\n                s = s - (4 >> cod_info.scalefac_scale);\n                if (s >= 0) {\n                    scalefac[sfb] = s;\n                    j += width * 3;\n                    continue;\n                }\n\n                scalefac[sfb] = 0;\n                {\n                    var gain = 210 + (s << (cod_info.scalefac_scale + 1));\n                    amp = qupvt.IPOW20(gain);\n                }\n                j += width * (window + 1);\n                for (var l = -width; l < 0; l++) {\n                    xrpow[j + l] *= amp;\n                    if (xrpow[j + l] > cod_info.xrpow_max)\n                        cod_info.xrpow_max = xrpow[j + l];\n                }\n                j += width * (3 - window - 1);\n            }\n\n            {\n                var amp = qupvt.IPOW20(202);\n                j += cod_info.width[sfb] * (window + 1);\n                for (var l = -cod_info.width[sfb]; l < 0; l++) {\n                    xrpow[j + l] *= amp;\n                    if (xrpow[j + l] > cod_info.xrpow_max)\n                        cod_info.xrpow_max = xrpow[j + l];\n                }\n            }\n        }\n        return false;\n    }\n\n    /**\n     * <PRE>\n     *  Takehiro Tominaga /date??\n     *  Robert Hegemann 2000-09-06: made a function of it\n     *\n     *  amplifies scalefactor bands,\n     *   - if all are already amplified returns 0\n     *   - if some bands are amplified too much:\n     *      * try to increase scalefac_scale\n     *      * if already scalefac_scale was set\n     *          try on short blocks to increase subblock gain\n     * </PRE>\n     */\n    function balance_noise(gfp, cod_info, distort, xrpow, bRefine) {\n        var gfc = gfp.internal_flags;\n\n        amp_scalefac_bands(gfp, cod_info, distort, xrpow, bRefine);\n\n        /*\n         * check to make sure we have not amplified too much loop_break returns\n         * 0 if there is an unamplified scalefac scale_bitcount returns 0 if no\n         * scalefactors are too large\n         */\n\n        var status = loop_break(cod_info);\n\n        if (status)\n            return false;\n        /* all bands amplified */\n\n        /*\n         * not all scalefactors have been amplified. so these scalefacs are\n         * possibly valid. encode them:\n         */\n        if (gfc.mode_gr == 2)\n            status = tk.scale_bitcount(cod_info);\n        else\n            status = tk.scale_bitcount_lsf(gfc, cod_info);\n\n        if (!status)\n            return true;\n        /* amplified some bands not exceeding limits */\n\n        /*\n         * some scalefactors are too large. lets try setting scalefac_scale=1\n         */\n        if (gfc.noise_shaping > 1) {\n            Arrays.fill(gfc.pseudohalf, 0);\n            if (0 == cod_info.scalefac_scale) {\n                inc_scalefac_scale(cod_info, xrpow);\n                status = false;\n            } else {\n                if (cod_info.block_type == Encoder.SHORT_TYPE\n                    && gfc.subblock_gain > 0) {\n                    status = (inc_subblock_gain(gfc, cod_info, xrpow) || loop_break(cod_info));\n                }\n            }\n        }\n\n        if (!status) {\n            if (gfc.mode_gr == 2)\n                status = tk.scale_bitcount(cod_info);\n            else\n                status = tk.scale_bitcount_lsf(gfc, cod_info);\n        }\n        return !status;\n    }\n\n    /**\n     * <PRE>\n     *  Function: The outer iteration loop controls the masking conditions\n     *  of all scalefactorbands. It computes the best scalefac and\n     *  global gain. This module calls the inner iteration loop\n     *\n     *  mt 5/99 completely rewritten to allow for bit reservoir control,\n     *  mid/side channels with L/R or mid/side masking thresholds,\n     *  and chooses best quantization instead of last quantization when\n     *  no distortion free quantization can be found.\n     *\n     *  added VBR support mt 5/99\n\n     *\n     *  some code shuffle rh 9/00\n     * </PRE>\n     *\n     * @param l3_xmin\n     *            allowed distortion\n     * @param xrpow\n     *            coloured magnitudes of spectral\n     * @param targ_bits\n     *            maximum allowed bits\n     */\n    this.outer_loop = function (gfp, cod_info, l3_xmin, xrpow, ch, targ_bits) {\n        var gfc = gfp.internal_flags;\n        var cod_info_w = new GrInfo();\n        var save_xrpow = new_float(576);\n        var distort = new_float(L3Side.SFBMAX);\n        var best_noise_info = new CalcNoiseResult();\n        var better;\n        var prev_noise = new CalcNoiseData();\n        var best_part2_3_length = 9999999;\n        var bEndOfSearch = false;\n        var bRefine = false;\n        var best_ggain_pass1 = 0;\n\n        bin_search_StepSize(gfc, cod_info, targ_bits, ch, xrpow);\n\n        if (0 == gfc.noise_shaping)\n        /* fast mode, no noise shaping, we are ready */\n            return 100;\n        /* default noise_info.over_count */\n\n        /* compute the distortion in this quantization */\n        /* coefficients and thresholds both l/r (or both mid/side) */\n        qupvt.calc_noise(cod_info, l3_xmin, distort, best_noise_info,\n            prev_noise);\n        best_noise_info.bits = cod_info.part2_3_length;\n\n        cod_info_w.assign(cod_info);\n        var age = 0;\n        System.arraycopy(xrpow, 0, save_xrpow, 0, 576);\n\n        while (!bEndOfSearch) {\n            /* BEGIN MAIN LOOP */\n            do {\n                var noise_info = new CalcNoiseResult();\n                var search_limit;\n                var maxggain = 255;\n\n                /*\n                 * When quantization with no distorted bands is found, allow up\n                 * to X new unsuccesful tries in serial. This gives us more\n                 * possibilities for different quant_compare modes. Much more\n                 * than 3 makes not a big difference, it is only slower.\n                 */\n\n                if ((gfc.substep_shaping & 2) != 0) {\n                    search_limit = 20;\n                } else {\n                    search_limit = 3;\n                }\n\n                /*\n                 * Check if the last scalefactor band is distorted. in VBR mode\n                 * we can't get rid of the distortion, so quit now and VBR mode\n                 * will try again with more bits. (makes a 10% speed increase,\n                 * the files I tested were binary identical, 2000/05/20 Robert\n                 * Hegemann) distort[] > 1 means noise > allowed noise\n                 */\n                if (gfc.sfb21_extra) {\n                    if (distort[cod_info_w.sfbmax] > 1.0)\n                        break;\n                    if (cod_info_w.block_type == Encoder.SHORT_TYPE\n                        && (distort[cod_info_w.sfbmax + 1] > 1.0 || distort[cod_info_w.sfbmax + 2] > 1.0))\n                        break;\n                }\n\n                /* try a new scalefactor conbination on cod_info_w */\n                if (!balance_noise(gfp, cod_info_w, distort, xrpow, bRefine))\n                    break;\n                if (cod_info_w.scalefac_scale != 0)\n                    maxggain = 254;\n\n                /*\n                 * inner_loop starts with the initial quantization step computed\n                 * above and slowly increases until the bits < huff_bits. Thus\n                 * it is important not to start with too large of an inital\n                 * quantization step. Too small is ok, but inner_loop will take\n                 * longer\n                 */\n                var huff_bits = targ_bits - cod_info_w.part2_length;\n                if (huff_bits <= 0)\n                    break;\n\n                /*\n                 * increase quantizer stepsize until needed bits are below\n                 * maximum\n                 */\n                while ((cod_info_w.part2_3_length = tk.count_bits(gfc, xrpow,\n                    cod_info_w, prev_noise)) > huff_bits\n                && cod_info_w.global_gain <= maxggain)\n                    cod_info_w.global_gain++;\n\n                if (cod_info_w.global_gain > maxggain)\n                    break;\n\n                if (best_noise_info.over_count == 0) {\n\n                    while ((cod_info_w.part2_3_length = tk.count_bits(gfc,\n                        xrpow, cod_info_w, prev_noise)) > best_part2_3_length\n                    && cod_info_w.global_gain <= maxggain)\n                        cod_info_w.global_gain++;\n\n                    if (cod_info_w.global_gain > maxggain)\n                        break;\n                }\n\n                /* compute the distortion in this quantization */\n                qupvt.calc_noise(cod_info_w, l3_xmin, distort, noise_info,\n                    prev_noise);\n                noise_info.bits = cod_info_w.part2_3_length;\n\n                /*\n                 * check if this quantization is better than our saved\n                 * quantization\n                 */\n                if (cod_info.block_type != Encoder.SHORT_TYPE) {\n                    // NORM, START or STOP type\n                    better = gfp.quant_comp;\n                } else\n                    better = gfp.quant_comp_short;\n\n                better = quant_compare(better, best_noise_info, noise_info,\n                    cod_info_w, distort) ? 1 : 0;\n\n                /* save data so we can restore this quantization later */\n                if (better != 0) {\n                    best_part2_3_length = cod_info.part2_3_length;\n                    best_noise_info = noise_info;\n                    cod_info.assign(cod_info_w);\n                    age = 0;\n                    /* save data so we can restore this quantization later */\n                    /* store for later reuse */\n                    System.arraycopy(xrpow, 0, save_xrpow, 0, 576);\n                } else {\n                    /* early stop? */\n                    if (gfc.full_outer_loop == 0) {\n                        if (++age > search_limit\n                            && best_noise_info.over_count == 0)\n                            break;\n                        if ((gfc.noise_shaping_amp == 3) && bRefine && age > 30)\n                            break;\n                        if ((gfc.noise_shaping_amp == 3)\n                            && bRefine\n                            && (cod_info_w.global_gain - best_ggain_pass1) > 15)\n                            break;\n                    }\n                }\n            } while ((cod_info_w.global_gain + cod_info_w.scalefac_scale) < 255);\n\n            if (gfc.noise_shaping_amp == 3) {\n                if (!bRefine) {\n                    /* refine search */\n                    cod_info_w.assign(cod_info);\n                    System.arraycopy(save_xrpow, 0, xrpow, 0, 576);\n                    age = 0;\n                    best_ggain_pass1 = cod_info_w.global_gain;\n\n                    bRefine = true;\n                } else {\n                    /* search already refined, stop */\n                    bEndOfSearch = true;\n                }\n\n            } else {\n                bEndOfSearch = true;\n            }\n        }\n\n        /*\n         * finish up\n         */\n        if (gfp.VBR == VbrMode.vbr_rh || gfp.VBR == VbrMode.vbr_mtrh)\n        /* restore for reuse on next try */\n            System.arraycopy(save_xrpow, 0, xrpow, 0, 576);\n        /*\n         * do the 'substep shaping'\n         */\n        else if ((gfc.substep_shaping & 1) != 0)\n            trancate_smallspectrums(gfc, cod_info, l3_xmin, xrpow);\n\n        return best_noise_info.over_count;\n    }\n\n    /**\n     * Robert Hegemann 2000-09-06\n     *\n     * update reservoir status after FINAL quantization/bitrate\n     */\n    this.iteration_finish_one = function (gfc, gr, ch) {\n        var l3_side = gfc.l3_side;\n        var cod_info = l3_side.tt[gr][ch];\n\n        /*\n         * try some better scalefac storage\n         */\n        tk.best_scalefac_store(gfc, gr, ch, l3_side);\n\n        /*\n         * best huffman_divide may save some bits too\n         */\n        if (gfc.use_best_huffman == 1)\n            tk.best_huffman_divide(gfc, cod_info);\n\n        /*\n         * update reservoir status after FINAL quantization/bitrate\n         */\n        rv.ResvAdjust(gfc, cod_info);\n    };\n\n    /**\n     *\n     * 2000-09-04 Robert Hegemann\n     *\n     * @param l3_xmin\n     *            allowed distortion of the scalefactor\n     * @param xrpow\n     *            coloured magnitudes of spectral values\n     */\n    this.VBR_encode_granule = function (gfp, cod_info, l3_xmin, xrpow, ch, min_bits, max_bits) {\n        var gfc = gfp.internal_flags;\n        var bst_cod_info = new GrInfo();\n        var bst_xrpow = new_float(576);\n        var Max_bits = max_bits;\n        var real_bits = max_bits + 1;\n        var this_bits = (max_bits + min_bits) / 2;\n        var dbits, over, found = 0;\n        var sfb21_extra = gfc.sfb21_extra;\n\n        Arrays.fill(bst_cod_info.l3_enc, 0);\n\n        /*\n         * search within round about 40 bits of optimal\n         */\n        do {\n\n            if (this_bits > Max_bits - 42)\n                gfc.sfb21_extra = false;\n            else\n                gfc.sfb21_extra = sfb21_extra;\n\n            over = outer_loop(gfp, cod_info, l3_xmin, xrpow, ch, this_bits);\n\n            /*\n             * is quantization as good as we are looking for ? in this case: is\n             * no scalefactor band distorted?\n             */\n            if (over <= 0) {\n                found = 1;\n                /*\n                 * now we know it can be done with \"real_bits\" and maybe we can\n                 * skip some iterations\n                 */\n                real_bits = cod_info.part2_3_length;\n\n                /*\n                 * store best quantization so far\n                 */\n                bst_cod_info.assign(cod_info);\n                System.arraycopy(xrpow, 0, bst_xrpow, 0, 576);\n\n                /*\n                 * try with fewer bits\n                 */\n                max_bits = real_bits - 32;\n                dbits = max_bits - min_bits;\n                this_bits = (max_bits + min_bits) / 2;\n            } else {\n                /*\n                 * try with more bits\n                 */\n                min_bits = this_bits + 32;\n                dbits = max_bits - min_bits;\n                this_bits = (max_bits + min_bits) / 2;\n\n                if (found != 0) {\n                    found = 2;\n                    /*\n                     * start again with best quantization so far\n                     */\n                    cod_info.assign(bst_cod_info);\n                    System.arraycopy(bst_xrpow, 0, xrpow, 0, 576);\n                }\n            }\n        } while (dbits > 12);\n\n        gfc.sfb21_extra = sfb21_extra;\n\n        /*\n         * found=0 => nothing found, use last one found=1 => we just found the\n         * best and left the loop found=2 => we restored a good one and have now\n         * l3_enc to restore too\n         */\n        if (found == 2) {\n            System.arraycopy(bst_cod_info.l3_enc, 0, cod_info.l3_enc, 0, 576);\n        }\n    }\n\n    /**\n     * Robert Hegemann 2000-09-05\n     *\n     * calculates * how many bits are available for analog silent granules * how\n     * many bits to use for the lowest allowed bitrate * how many bits each\n     * bitrate would provide\n     */\n    this.get_framebits = function (gfp, frameBits) {\n        var gfc = gfp.internal_flags;\n\n        /*\n         * always use at least this many bits per granule per channel unless we\n         * detect analog silence, see below\n         */\n        gfc.bitrate_index = gfc.VBR_min_bitrate;\n        var bitsPerFrame = bs.getframebits(gfp);\n\n        /*\n         * bits for analog silence\n         */\n        gfc.bitrate_index = 1;\n        bitsPerFrame = bs.getframebits(gfp);\n\n        for (var i = 1; i <= gfc.VBR_max_bitrate; i++) {\n            gfc.bitrate_index = i;\n            var mb = new MeanBits(bitsPerFrame);\n            frameBits[i] = rv.ResvFrameBegin(gfp, mb);\n            bitsPerFrame = mb.bits;\n        }\n    };\n\n    /* RH: this one needs to be overhauled sometime */\n\n    /**\n     * <PRE>\n     *  2000-09-04 Robert Hegemann\n     *\n     *  * converts LR to MS coding when necessary\n     *  * calculates allowed/adjusted quantization noise amounts\n     *  * detects analog silent frames\n     *\n     *  some remarks:\n     *  - lower masking depending on Quality setting\n     *  - quality control together with adjusted ATH MDCT scaling\n     *    on lower quality setting allocate more noise from\n     *    ATH masking, and on higher quality setting allocate\n     *    less noise from ATH masking.\n     *  - experiments show that going more than 2dB over GPSYCHO's\n     *    limits ends up in very annoying artefacts\n     * </PRE>\n     */\n    this.VBR_old_prepare = function (gfp, pe, ms_ener_ratio, ratio, l3_xmin, frameBits, min_bits,\n                                     max_bits, bands) {\n        var gfc = gfp.internal_flags;\n\n        var masking_lower_db, adjust = 0.0;\n        var analog_silence = 1;\n        var bits = 0;\n\n        gfc.bitrate_index = gfc.VBR_max_bitrate;\n        var avg = rv.ResvFrameBegin(gfp, new MeanBits(0)) / gfc.mode_gr;\n\n        get_framebits(gfp, frameBits);\n\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            var mxb = qupvt.on_pe(gfp, pe, max_bits[gr], avg, gr, 0);\n            if (gfc.mode_ext == Encoder.MPG_MD_MS_LR) {\n                ms_convert(gfc.l3_side, gr);\n                qupvt.reduce_side(max_bits[gr], ms_ener_ratio[gr], avg, mxb);\n            }\n            for (var ch = 0; ch < gfc.channels_out; ++ch) {\n                var cod_info = gfc.l3_side.tt[gr][ch];\n\n                if (cod_info.block_type != Encoder.SHORT_TYPE) {\n                    // NORM, START or STOP type\n                    adjust = 1.28 / (1 + Math\n                            .exp(3.5 - pe[gr][ch] / 300.)) - 0.05;\n                    masking_lower_db = gfc.PSY.mask_adjust - adjust;\n                } else {\n                    adjust = 2.56 / (1 + Math\n                            .exp(3.5 - pe[gr][ch] / 300.)) - 0.14;\n                    masking_lower_db = gfc.PSY.mask_adjust_short - adjust;\n                }\n                gfc.masking_lower = Math.pow(10.0,\n                    masking_lower_db * 0.1);\n\n                init_outer_loop(gfc, cod_info);\n                bands[gr][ch] = qupvt.calc_xmin(gfp, ratio[gr][ch], cod_info,\n                    l3_xmin[gr][ch]);\n                if (bands[gr][ch] != 0)\n                    analog_silence = 0;\n\n                min_bits[gr][ch] = 126;\n\n                bits += max_bits[gr][ch];\n            }\n        }\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            for (var ch = 0; ch < gfc.channels_out; ch++) {\n                if (bits > frameBits[gfc.VBR_max_bitrate]) {\n                    max_bits[gr][ch] *= frameBits[gfc.VBR_max_bitrate];\n                    max_bits[gr][ch] /= bits;\n                }\n                if (min_bits[gr][ch] > max_bits[gr][ch])\n                    min_bits[gr][ch] = max_bits[gr][ch];\n\n            }\n            /* for ch */\n        }\n        /* for gr */\n\n        return analog_silence;\n    };\n\n    this.bitpressure_strategy = function (gfc, l3_xmin, min_bits, max_bits) {\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            for (var ch = 0; ch < gfc.channels_out; ch++) {\n                var gi = gfc.l3_side.tt[gr][ch];\n                var pxmin = l3_xmin[gr][ch];\n                var pxminPos = 0;\n                for (var sfb = 0; sfb < gi.psy_lmax; sfb++)\n                    pxmin[pxminPos++] *= 1. + .029 * sfb * sfb\n                        / Encoder.SBMAX_l / Encoder.SBMAX_l;\n\n                if (gi.block_type == Encoder.SHORT_TYPE) {\n                    for (var sfb = gi.sfb_smin; sfb < Encoder.SBMAX_s; sfb++) {\n                        pxmin[pxminPos++] *= 1. + .029 * sfb * sfb\n                            / Encoder.SBMAX_s / Encoder.SBMAX_s;\n                        pxmin[pxminPos++] *= 1. + .029 * sfb * sfb\n                            / Encoder.SBMAX_s / Encoder.SBMAX_s;\n                        pxmin[pxminPos++] *= 1. + .029 * sfb * sfb\n                            / Encoder.SBMAX_s / Encoder.SBMAX_s;\n                    }\n                }\n                max_bits[gr][ch] = 0 | Math.max(min_bits[gr][ch],\n                        0.9 * max_bits[gr][ch]);\n            }\n        }\n    };\n\n    this.VBR_new_prepare = function (gfp, pe, ratio, l3_xmin, frameBits, max_bits) {\n        var gfc = gfp.internal_flags;\n\n        var analog_silence = 1;\n        var avg = 0, bits = 0;\n        var maximum_framebits;\n\n        if (!gfp.free_format) {\n            gfc.bitrate_index = gfc.VBR_max_bitrate;\n\n            var mb = new MeanBits(avg);\n            rv.ResvFrameBegin(gfp, mb);\n            avg = mb.bits;\n\n            get_framebits(gfp, frameBits);\n            maximum_framebits = frameBits[gfc.VBR_max_bitrate];\n        } else {\n            gfc.bitrate_index = 0;\n            var mb = new MeanBits(avg);\n            maximum_framebits = rv.ResvFrameBegin(gfp, mb);\n            avg = mb.bits;\n            frameBits[0] = maximum_framebits;\n        }\n\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            qupvt.on_pe(gfp, pe, max_bits[gr], avg, gr, 0);\n            if (gfc.mode_ext == Encoder.MPG_MD_MS_LR) {\n                ms_convert(gfc.l3_side, gr);\n            }\n            for (var ch = 0; ch < gfc.channels_out; ++ch) {\n                var cod_info = gfc.l3_side.tt[gr][ch];\n\n                gfc.masking_lower = Math.pow(10.0,\n                    gfc.PSY.mask_adjust * 0.1);\n\n                init_outer_loop(gfc, cod_info);\n                if (0 != qupvt.calc_xmin(gfp, ratio[gr][ch], cod_info,\n                        l3_xmin[gr][ch]))\n                    analog_silence = 0;\n\n                bits += max_bits[gr][ch];\n            }\n        }\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            for (var ch = 0; ch < gfc.channels_out; ch++) {\n                if (bits > maximum_framebits) {\n                    max_bits[gr][ch] *= maximum_framebits;\n                    max_bits[gr][ch] /= bits;\n                }\n\n            }\n            /* for ch */\n        }\n        /* for gr */\n\n        return analog_silence;\n    };\n\n    /**\n     * calculates target bits for ABR encoding\n     *\n     * mt 2000/05/31\n     */\n    this.calc_target_bits = function (gfp, pe, ms_ener_ratio, targ_bits, analog_silence_bits, max_frame_bits) {\n        var gfc = gfp.internal_flags;\n        var l3_side = gfc.l3_side;\n        var res_factor;\n        var gr, ch, totbits, mean_bits = 0;\n\n        gfc.bitrate_index = gfc.VBR_max_bitrate;\n        var mb = new MeanBits(mean_bits);\n        max_frame_bits[0] = rv.ResvFrameBegin(gfp, mb);\n        mean_bits = mb.bits;\n\n        gfc.bitrate_index = 1;\n        mean_bits = bs.getframebits(gfp) - gfc.sideinfo_len * 8;\n        analog_silence_bits[0] = mean_bits / (gfc.mode_gr * gfc.channels_out);\n\n        mean_bits = gfp.VBR_mean_bitrate_kbps * gfp.framesize * 1000;\n        if ((gfc.substep_shaping & 1) != 0)\n            mean_bits *= 1.09;\n        mean_bits /= gfp.out_samplerate;\n        mean_bits -= gfc.sideinfo_len * 8;\n        mean_bits /= (gfc.mode_gr * gfc.channels_out);\n\n        /**\n         * <PRE>\n         *           res_factor is the percentage of the target bitrate that should\n         *           be used on average.  the remaining bits are added to the\n         *           bitreservoir and used for difficult to encode frames.\n         *\n         *           Since we are tracking the average bitrate, we should adjust\n         *           res_factor \"on the fly\", increasing it if the average bitrate\n         *           is greater than the requested bitrate, and decreasing it\n         *           otherwise.  Reasonable ranges are from .9 to 1.0\n         *\n         *           Until we get the above suggestion working, we use the following\n         *           tuning:\n         *           compression ratio    res_factor\n         *           5.5  (256kbps)         1.0      no need for bitreservoir\n         *           11   (128kbps)         .93      7% held for reservoir\n         *\n         *           with linear interpolation for other values.\n         * </PRE>\n         */\n        res_factor = .93 + .07 * (11.0 - gfp.compression_ratio)\n            / (11.0 - 5.5);\n        if (res_factor < .90)\n            res_factor = .90;\n        if (res_factor > 1.00)\n            res_factor = 1.00;\n\n        for (gr = 0; gr < gfc.mode_gr; gr++) {\n            var sum = 0;\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                targ_bits[gr][ch] = (int)(res_factor * mean_bits);\n\n                if (pe[gr][ch] > 700) {\n                    var add_bits = (int)((pe[gr][ch] - 700) / 1.4);\n\n                    var cod_info = l3_side.tt[gr][ch];\n                    targ_bits[gr][ch] = (int)(res_factor * mean_bits);\n\n                    /* short blocks use a little extra, no matter what the pe */\n                    if (cod_info.block_type == Encoder.SHORT_TYPE) {\n                        if (add_bits < mean_bits / 2)\n                            add_bits = mean_bits / 2;\n                    }\n                    /* at most increase bits by 1.5*average */\n                    if (add_bits > mean_bits * 3 / 2)\n                        add_bits = mean_bits * 3 / 2;\n                    else if (add_bits < 0)\n                        add_bits = 0;\n\n                    targ_bits[gr][ch] += add_bits;\n                }\n                if (targ_bits[gr][ch] > LameInternalFlags.MAX_BITS_PER_CHANNEL) {\n                    targ_bits[gr][ch] = LameInternalFlags.MAX_BITS_PER_CHANNEL;\n                }\n                sum += targ_bits[gr][ch];\n            }\n            /* for ch */\n            if (sum > LameInternalFlags.MAX_BITS_PER_GRANULE) {\n                for (ch = 0; ch < gfc.channels_out; ++ch) {\n                    targ_bits[gr][ch] *= LameInternalFlags.MAX_BITS_PER_GRANULE;\n                    targ_bits[gr][ch] /= sum;\n                }\n            }\n        }\n        /* for gr */\n\n        if (gfc.mode_ext == Encoder.MPG_MD_MS_LR)\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                qupvt.reduce_side(targ_bits[gr], ms_ener_ratio[gr], mean_bits\n                    * gfc.channels_out,\n                    LameInternalFlags.MAX_BITS_PER_GRANULE);\n            }\n\n        /*\n         * sum target bits\n         */\n        totbits = 0;\n        for (gr = 0; gr < gfc.mode_gr; gr++) {\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                if (targ_bits[gr][ch] > LameInternalFlags.MAX_BITS_PER_CHANNEL)\n                    targ_bits[gr][ch] = LameInternalFlags.MAX_BITS_PER_CHANNEL;\n                totbits += targ_bits[gr][ch];\n            }\n        }\n\n        /*\n         * repartion target bits if needed\n         */\n        if (totbits > max_frame_bits[0]) {\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    targ_bits[gr][ch] *= max_frame_bits[0];\n                    targ_bits[gr][ch] /= totbits;\n                }\n            }\n        }\n    }\n\n}\n\n/*\n *      MP3 window subband -> subband filtering -> mdct routine\n *\n *      Copyright (c) 1999-2000 Takehiro Tominaga\n *\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Library General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n/*\n *         Special Thanks to Patrick De Smet for your advices.\n */\n\n/* $Id: NewMDCT.java,v 1.11 2011/05/24 20:48:06 kenchis Exp $ */\n\n//package mp3;\n\n//import java.util.Arrays;\n\n\n\nfunction NewMDCT() {\n\n\tvar enwindow = [\n\t\t\t-4.77e-07 * 0.740951125354959 / 2.384e-06,\n\t\t\t1.03951e-04 * 0.740951125354959 / 2.384e-06,\n\t\t\t9.53674e-04 * 0.740951125354959 / 2.384e-06,\n\t\t\t2.841473e-03 * 0.740951125354959 / 2.384e-06,\n\t\t\t3.5758972e-02 * 0.740951125354959 / 2.384e-06,\n\t\t\t3.401756e-03 * 0.740951125354959 / 2.384e-06,\n\t\t\t9.83715e-04 * 0.740951125354959 / 2.384e-06,\n\t\t\t9.9182e-05 * 0.740951125354959 / 2.384e-06, /* 15 */\n\t\t\t1.2398e-05 * 0.740951125354959 / 2.384e-06,\n\t\t\t1.91212e-04 * 0.740951125354959 / 2.384e-06,\n\t\t\t2.283096e-03 * 0.740951125354959 / 2.384e-06,\n\t\t\t1.6994476e-02 * 0.740951125354959 / 2.384e-06,\n\t\t\t-1.8756866e-02 * 0.740951125354959 / 2.384e-06,\n\t\t\t-2.630711e-03 * 0.740951125354959 / 2.384e-06,\n\t\t\t-2.47478e-04 * 0.740951125354959 / 2.384e-06,\n\t\t\t-1.4782e-05 * 0.740951125354959 / 2.384e-06,\n\t\t\t9.063471690191471e-01, 1.960342806591213e-01,\n\n\t\t\t-4.77e-07 * 0.773010453362737 / 2.384e-06,\n\t\t\t1.05858e-04 * 0.773010453362737 / 2.384e-06,\n\t\t\t9.30786e-04 * 0.773010453362737 / 2.384e-06,\n\t\t\t2.521515e-03 * 0.773010453362737 / 2.384e-06,\n\t\t\t3.5694122e-02 * 0.773010453362737 / 2.384e-06,\n\t\t\t3.643036e-03 * 0.773010453362737 / 2.384e-06,\n\t\t\t9.91821e-04 * 0.773010453362737 / 2.384e-06,\n\t\t\t9.6321e-05 * 0.773010453362737 / 2.384e-06, /* 14 */\n\t\t\t1.1444e-05 * 0.773010453362737 / 2.384e-06,\n\t\t\t1.65462e-04 * 0.773010453362737 / 2.384e-06,\n\t\t\t2.110004e-03 * 0.773010453362737 / 2.384e-06,\n\t\t\t1.6112804e-02 * 0.773010453362737 / 2.384e-06,\n\t\t\t-1.9634247e-02 * 0.773010453362737 / 2.384e-06,\n\t\t\t-2.803326e-03 * 0.773010453362737 / 2.384e-06,\n\t\t\t-2.77042e-04 * 0.773010453362737 / 2.384e-06,\n\t\t\t-1.6689e-05 * 0.773010453362737 / 2.384e-06,\n\t\t\t8.206787908286602e-01, 3.901806440322567e-01,\n\n\t\t\t-4.77e-07 * 0.803207531480645 / 2.384e-06,\n\t\t\t1.07288e-04 * 0.803207531480645 / 2.384e-06,\n\t\t\t9.02653e-04 * 0.803207531480645 / 2.384e-06,\n\t\t\t2.174854e-03 * 0.803207531480645 / 2.384e-06,\n\t\t\t3.5586357e-02 * 0.803207531480645 / 2.384e-06,\n\t\t\t3.858566e-03 * 0.803207531480645 / 2.384e-06,\n\t\t\t9.95159e-04 * 0.803207531480645 / 2.384e-06,\n\t\t\t9.3460e-05 * 0.803207531480645 / 2.384e-06, /* 13 */\n\t\t\t1.0014e-05 * 0.803207531480645 / 2.384e-06,\n\t\t\t1.40190e-04 * 0.803207531480645 / 2.384e-06,\n\t\t\t1.937389e-03 * 0.803207531480645 / 2.384e-06,\n\t\t\t1.5233517e-02 * 0.803207531480645 / 2.384e-06,\n\t\t\t-2.0506859e-02 * 0.803207531480645 / 2.384e-06,\n\t\t\t-2.974033e-03 * 0.803207531480645 / 2.384e-06,\n\t\t\t-3.07560e-04 * 0.803207531480645 / 2.384e-06,\n\t\t\t-1.8120e-05 * 0.803207531480645 / 2.384e-06,\n\t\t\t7.416505462720353e-01, 5.805693545089249e-01,\n\n\t\t\t-4.77e-07 * 0.831469612302545 / 2.384e-06,\n\t\t\t1.08242e-04 * 0.831469612302545 / 2.384e-06,\n\t\t\t8.68797e-04 * 0.831469612302545 / 2.384e-06,\n\t\t\t1.800537e-03 * 0.831469612302545 / 2.384e-06,\n\t\t\t3.5435200e-02 * 0.831469612302545 / 2.384e-06,\n\t\t\t4.049301e-03 * 0.831469612302545 / 2.384e-06,\n\t\t\t9.94205e-04 * 0.831469612302545 / 2.384e-06,\n\t\t\t9.0599e-05 * 0.831469612302545 / 2.384e-06, /* 12 */\n\t\t\t9.060e-06 * 0.831469612302545 / 2.384e-06,\n\t\t\t1.16348e-04 * 0.831469612302545 / 2.384e-06,\n\t\t\t1.766682e-03 * 0.831469612302545 / 2.384e-06,\n\t\t\t1.4358521e-02 * 0.831469612302545 / 2.384e-06,\n\t\t\t-2.1372318e-02 * 0.831469612302545 / 2.384e-06,\n\t\t\t-3.14188e-03 * 0.831469612302545 / 2.384e-06,\n\t\t\t-3.39031e-04 * 0.831469612302545 / 2.384e-06,\n\t\t\t-1.9550e-05 * 0.831469612302545 / 2.384e-06,\n\t\t\t6.681786379192989e-01, 7.653668647301797e-01,\n\n\t\t\t-4.77e-07 * 0.857728610000272 / 2.384e-06,\n\t\t\t1.08719e-04 * 0.857728610000272 / 2.384e-06,\n\t\t\t8.29220e-04 * 0.857728610000272 / 2.384e-06,\n\t\t\t1.399517e-03 * 0.857728610000272 / 2.384e-06,\n\t\t\t3.5242081e-02 * 0.857728610000272 / 2.384e-06,\n\t\t\t4.215240e-03 * 0.857728610000272 / 2.384e-06,\n\t\t\t9.89437e-04 * 0.857728610000272 / 2.384e-06,\n\t\t\t8.7261e-05 * 0.857728610000272 / 2.384e-06, /* 11 */\n\t\t\t8.106e-06 * 0.857728610000272 / 2.384e-06,\n\t\t\t9.3937e-05 * 0.857728610000272 / 2.384e-06,\n\t\t\t1.597881e-03 * 0.857728610000272 / 2.384e-06,\n\t\t\t1.3489246e-02 * 0.857728610000272 / 2.384e-06,\n\t\t\t-2.2228718e-02 * 0.857728610000272 / 2.384e-06,\n\t\t\t-3.306866e-03 * 0.857728610000272 / 2.384e-06,\n\t\t\t-3.71456e-04 * 0.857728610000272 / 2.384e-06,\n\t\t\t-2.1458e-05 * 0.857728610000272 / 2.384e-06,\n\t\t\t5.993769336819237e-01, 9.427934736519954e-01,\n\n\t\t\t-4.77e-07 * 0.881921264348355 / 2.384e-06,\n\t\t\t1.08719e-04 * 0.881921264348355 / 2.384e-06,\n\t\t\t7.8392e-04 * 0.881921264348355 / 2.384e-06,\n\t\t\t9.71317e-04 * 0.881921264348355 / 2.384e-06,\n\t\t\t3.5007000e-02 * 0.881921264348355 / 2.384e-06,\n\t\t\t4.357815e-03 * 0.881921264348355 / 2.384e-06,\n\t\t\t9.80854e-04 * 0.881921264348355 / 2.384e-06,\n\t\t\t8.3923e-05 * 0.881921264348355 / 2.384e-06, /* 10 */\n\t\t\t7.629e-06 * 0.881921264348355 / 2.384e-06,\n\t\t\t7.2956e-05 * 0.881921264348355 / 2.384e-06,\n\t\t\t1.432419e-03 * 0.881921264348355 / 2.384e-06,\n\t\t\t1.2627602e-02 * 0.881921264348355 / 2.384e-06,\n\t\t\t-2.3074150e-02 * 0.881921264348355 / 2.384e-06,\n\t\t\t-3.467083e-03 * 0.881921264348355 / 2.384e-06,\n\t\t\t-4.04358e-04 * 0.881921264348355 / 2.384e-06,\n\t\t\t-2.3365e-05 * 0.881921264348355 / 2.384e-06,\n\t\t\t5.345111359507916e-01, 1.111140466039205e+00,\n\n\t\t\t-9.54e-07 * 0.903989293123443 / 2.384e-06,\n\t\t\t1.08242e-04 * 0.903989293123443 / 2.384e-06,\n\t\t\t7.31945e-04 * 0.903989293123443 / 2.384e-06,\n\t\t\t5.15938e-04 * 0.903989293123443 / 2.384e-06,\n\t\t\t3.4730434e-02 * 0.903989293123443 / 2.384e-06,\n\t\t\t4.477024e-03 * 0.903989293123443 / 2.384e-06,\n\t\t\t9.68933e-04 * 0.903989293123443 / 2.384e-06,\n\t\t\t8.0585e-05 * 0.903989293123443 / 2.384e-06, /* 9 */\n\t\t\t6.676e-06 * 0.903989293123443 / 2.384e-06,\n\t\t\t5.2929e-05 * 0.903989293123443 / 2.384e-06,\n\t\t\t1.269817e-03 * 0.903989293123443 / 2.384e-06,\n\t\t\t1.1775017e-02 * 0.903989293123443 / 2.384e-06,\n\t\t\t-2.3907185e-02 * 0.903989293123443 / 2.384e-06,\n\t\t\t-3.622532e-03 * 0.903989293123443 / 2.384e-06,\n\t\t\t-4.38213e-04 * 0.903989293123443 / 2.384e-06,\n\t\t\t-2.5272e-05 * 0.903989293123443 / 2.384e-06,\n\t\t\t4.729647758913199e-01, 1.268786568327291e+00,\n\n\t\t\t-9.54e-07 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t1.06812e-04 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t6.74248e-04 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t3.3379e-05 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t3.4412861e-02 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t4.573822e-03 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t9.54151e-04 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t7.6771e-05 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t6.199e-06 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t3.4332e-05 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t1.111031e-03 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t1.0933399e-02 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t-2.4725437e-02 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t-3.771782e-03 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t-4.72546e-04 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t-2.7657e-05 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t4.1421356237309504879e-01, /* tan(PI/8) */\n\t\t\t1.414213562373095e+00,\n\n\t\t\t-9.54e-07 * 0.941544065183021 / 2.384e-06,\n\t\t\t1.05381e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t6.10352e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t-4.75883e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t3.4055710e-02 * 0.941544065183021 / 2.384e-06,\n\t\t\t4.649162e-03 * 0.941544065183021 / 2.384e-06,\n\t\t\t9.35555e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t7.3433e-05 * 0.941544065183021 / 2.384e-06, /* 7 */\n\t\t\t5.245e-06 * 0.941544065183021 / 2.384e-06,\n\t\t\t1.7166e-05 * 0.941544065183021 / 2.384e-06,\n\t\t\t9.56535e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t1.0103703e-02 * 0.941544065183021 / 2.384e-06,\n\t\t\t-2.5527000e-02 * 0.941544065183021 / 2.384e-06,\n\t\t\t-3.914356e-03 * 0.941544065183021 / 2.384e-06,\n\t\t\t-5.07355e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t-3.0041e-05 * 0.941544065183021 / 2.384e-06,\n\t\t\t3.578057213145241e-01, 1.546020906725474e+00,\n\n\t\t\t-9.54e-07 * 0.956940335732209 / 2.384e-06,\n\t\t\t1.02520e-04 * 0.956940335732209 / 2.384e-06,\n\t\t\t5.39303e-04 * 0.956940335732209 / 2.384e-06,\n\t\t\t-1.011848e-03 * 0.956940335732209 / 2.384e-06,\n\t\t\t3.3659935e-02 * 0.956940335732209 / 2.384e-06,\n\t\t\t4.703045e-03 * 0.956940335732209 / 2.384e-06,\n\t\t\t9.15051e-04 * 0.956940335732209 / 2.384e-06,\n\t\t\t7.0095e-05 * 0.956940335732209 / 2.384e-06, /* 6 */\n\t\t\t4.768e-06 * 0.956940335732209 / 2.384e-06,\n\t\t\t9.54e-07 * 0.956940335732209 / 2.384e-06,\n\t\t\t8.06808e-04 * 0.956940335732209 / 2.384e-06,\n\t\t\t9.287834e-03 * 0.956940335732209 / 2.384e-06,\n\t\t\t-2.6310921e-02 * 0.956940335732209 / 2.384e-06,\n\t\t\t-4.048824e-03 * 0.956940335732209 / 2.384e-06,\n\t\t\t-5.42164e-04 * 0.956940335732209 / 2.384e-06,\n\t\t\t-3.2425e-05 * 0.956940335732209 / 2.384e-06,\n\t\t\t3.033466836073424e-01, 1.662939224605090e+00,\n\n\t\t\t-1.431e-06 * 0.970031253194544 / 2.384e-06,\n\t\t\t9.9182e-05 * 0.970031253194544 / 2.384e-06,\n\t\t\t4.62532e-04 * 0.970031253194544 / 2.384e-06,\n\t\t\t-1.573563e-03 * 0.970031253194544 / 2.384e-06,\n\t\t\t3.3225536e-02 * 0.970031253194544 / 2.384e-06,\n\t\t\t4.737377e-03 * 0.970031253194544 / 2.384e-06,\n\t\t\t8.91685e-04 * 0.970031253194544 / 2.384e-06,\n\t\t\t6.6280e-05 * 0.970031253194544 / 2.384e-06, /* 5 */\n\t\t\t4.292e-06 * 0.970031253194544 / 2.384e-06,\n\t\t\t-1.3828e-05 * 0.970031253194544 / 2.384e-06,\n\t\t\t6.61850e-04 * 0.970031253194544 / 2.384e-06,\n\t\t\t8.487225e-03 * 0.970031253194544 / 2.384e-06,\n\t\t\t-2.7073860e-02 * 0.970031253194544 / 2.384e-06,\n\t\t\t-4.174709e-03 * 0.970031253194544 / 2.384e-06,\n\t\t\t-5.76973e-04 * 0.970031253194544 / 2.384e-06,\n\t\t\t-3.4809e-05 * 0.970031253194544 / 2.384e-06,\n\t\t\t2.504869601913055e-01, 1.763842528696710e+00,\n\n\t\t\t-1.431e-06 * 0.98078528040323 / 2.384e-06,\n\t\t\t9.5367e-05 * 0.98078528040323 / 2.384e-06,\n\t\t\t3.78609e-04 * 0.98078528040323 / 2.384e-06,\n\t\t\t-2.161503e-03 * 0.98078528040323 / 2.384e-06,\n\t\t\t3.2754898e-02 * 0.98078528040323 / 2.384e-06,\n\t\t\t4.752159e-03 * 0.98078528040323 / 2.384e-06,\n\t\t\t8.66413e-04 * 0.98078528040323 / 2.384e-06,\n\t\t\t6.2943e-05 * 0.98078528040323 / 2.384e-06, /* 4 */\n\t\t\t3.815e-06 * 0.98078528040323 / 2.384e-06,\n\t\t\t-2.718e-05 * 0.98078528040323 / 2.384e-06,\n\t\t\t5.22137e-04 * 0.98078528040323 / 2.384e-06,\n\t\t\t7.703304e-03 * 0.98078528040323 / 2.384e-06,\n\t\t\t-2.7815342e-02 * 0.98078528040323 / 2.384e-06,\n\t\t\t-4.290581e-03 * 0.98078528040323 / 2.384e-06,\n\t\t\t-6.11782e-04 * 0.98078528040323 / 2.384e-06,\n\t\t\t-3.7670e-05 * 0.98078528040323 / 2.384e-06,\n\t\t\t1.989123673796580e-01, 1.847759065022573e+00,\n\n\t\t\t-1.907e-06 * 0.989176509964781 / 2.384e-06,\n\t\t\t9.0122e-05 * 0.989176509964781 / 2.384e-06,\n\t\t\t2.88486e-04 * 0.989176509964781 / 2.384e-06,\n\t\t\t-2.774239e-03 * 0.989176509964781 / 2.384e-06,\n\t\t\t3.2248020e-02 * 0.989176509964781 / 2.384e-06,\n\t\t\t4.748821e-03 * 0.989176509964781 / 2.384e-06,\n\t\t\t8.38757e-04 * 0.989176509964781 / 2.384e-06,\n\t\t\t5.9605e-05 * 0.989176509964781 / 2.384e-06, /* 3 */\n\t\t\t3.338e-06 * 0.989176509964781 / 2.384e-06,\n\t\t\t-3.9577e-05 * 0.989176509964781 / 2.384e-06,\n\t\t\t3.88145e-04 * 0.989176509964781 / 2.384e-06,\n\t\t\t6.937027e-03 * 0.989176509964781 / 2.384e-06,\n\t\t\t-2.8532982e-02 * 0.989176509964781 / 2.384e-06,\n\t\t\t-4.395962e-03 * 0.989176509964781 / 2.384e-06,\n\t\t\t-6.46591e-04 * 0.989176509964781 / 2.384e-06,\n\t\t\t-4.0531e-05 * 0.989176509964781 / 2.384e-06,\n\t\t\t1.483359875383474e-01, 1.913880671464418e+00,\n\n\t\t\t-1.907e-06 * 0.995184726672197 / 2.384e-06,\n\t\t\t8.4400e-05 * 0.995184726672197 / 2.384e-06,\n\t\t\t1.91689e-04 * 0.995184726672197 / 2.384e-06,\n\t\t\t-3.411293e-03 * 0.995184726672197 / 2.384e-06,\n\t\t\t3.1706810e-02 * 0.995184726672197 / 2.384e-06,\n\t\t\t4.728317e-03 * 0.995184726672197 / 2.384e-06,\n\t\t\t8.09669e-04 * 0.995184726672197 / 2.384e-06,\n\t\t\t5.579e-05 * 0.995184726672197 / 2.384e-06,\n\t\t\t3.338e-06 * 0.995184726672197 / 2.384e-06,\n\t\t\t-5.0545e-05 * 0.995184726672197 / 2.384e-06,\n\t\t\t2.59876e-04 * 0.995184726672197 / 2.384e-06,\n\t\t\t6.189346e-03 * 0.995184726672197 / 2.384e-06,\n\t\t\t-2.9224873e-02 * 0.995184726672197 / 2.384e-06,\n\t\t\t-4.489899e-03 * 0.995184726672197 / 2.384e-06,\n\t\t\t-6.80923e-04 * 0.995184726672197 / 2.384e-06,\n\t\t\t-4.3392e-05 * 0.995184726672197 / 2.384e-06,\n\t\t\t9.849140335716425e-02, 1.961570560806461e+00,\n\n\t\t\t-2.384e-06 * 0.998795456205172 / 2.384e-06,\n\t\t\t7.7724e-05 * 0.998795456205172 / 2.384e-06,\n\t\t\t8.8215e-05 * 0.998795456205172 / 2.384e-06,\n\t\t\t-4.072189e-03 * 0.998795456205172 / 2.384e-06,\n\t\t\t3.1132698e-02 * 0.998795456205172 / 2.384e-06,\n\t\t\t4.691124e-03 * 0.998795456205172 / 2.384e-06,\n\t\t\t7.79152e-04 * 0.998795456205172 / 2.384e-06,\n\t\t\t5.2929e-05 * 0.998795456205172 / 2.384e-06,\n\t\t\t2.861e-06 * 0.998795456205172 / 2.384e-06,\n\t\t\t-6.0558e-05 * 0.998795456205172 / 2.384e-06,\n\t\t\t1.37329e-04 * 0.998795456205172 / 2.384e-06,\n\t\t\t5.462170e-03 * 0.998795456205172 / 2.384e-06,\n\t\t\t-2.9890060e-02 * 0.998795456205172 / 2.384e-06,\n\t\t\t-4.570484e-03 * 0.998795456205172 / 2.384e-06,\n\t\t\t-7.14302e-04 * 0.998795456205172 / 2.384e-06,\n\t\t\t-4.6253e-05 * 0.998795456205172 / 2.384e-06,\n\t\t\t4.912684976946725e-02, 1.990369453344394e+00,\n\n\t\t\t3.5780907e-02 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t1.7876148e-02 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t3.134727e-03 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t2.457142e-03 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t9.71317e-04 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t2.18868e-04 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t1.01566e-04 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t1.3828e-05 * Util.SQRT2 * 0.5 / 2.384e-06,\n\n\t\t\t3.0526638e-02 / 2.384e-06, 4.638195e-03 / 2.384e-06,\n\t\t\t7.47204e-04 / 2.384e-06, 4.9591e-05 / 2.384e-06,\n\t\t\t4.756451e-03 / 2.384e-06, 2.1458e-05 / 2.384e-06,\n\t\t\t-6.9618e-05 / 2.384e-06, /* 2.384e-06/2.384e-06 */\n\t];\n\n\tvar NS = 12;\n\tvar NL = 36;\n\n\tvar win = [\n\t    [\n\t     2.382191739347913e-13,\n\t     6.423305872147834e-13,\n\t     9.400849094049688e-13,\n\t     1.122435026096556e-12,\n\t     1.183840321267481e-12,\n\t     1.122435026096556e-12,\n\t     9.400849094049690e-13,\n\t     6.423305872147839e-13,\n\t     2.382191739347918e-13,\n\n\t     5.456116108943412e-12,\n\t     4.878985199565852e-12,\n\t     4.240448995017367e-12,\n\t     3.559909094758252e-12,\n\t     2.858043359288075e-12,\n\t     2.156177623817898e-12,\n\t     1.475637723558783e-12,\n\t     8.371015190102974e-13,\n\t     2.599706096327376e-13,\n\n\t     -5.456116108943412e-12,\n\t     -4.878985199565852e-12,\n\t     -4.240448995017367e-12,\n\t     -3.559909094758252e-12,\n\t     -2.858043359288076e-12,\n\t     -2.156177623817898e-12,\n\t     -1.475637723558783e-12,\n\t     -8.371015190102975e-13,\n\t     -2.599706096327376e-13,\n\n\t     -2.382191739347923e-13,\n\t     -6.423305872147843e-13,\n\t     -9.400849094049696e-13,\n\t     -1.122435026096556e-12,\n\t     -1.183840321267481e-12,\n\t     -1.122435026096556e-12,\n\t     -9.400849094049694e-13,\n\t     -6.423305872147840e-13,\n\t     -2.382191739347918e-13,\n\t     ],\n\t    [\n\t     2.382191739347913e-13,\n\t     6.423305872147834e-13,\n\t     9.400849094049688e-13,\n\t     1.122435026096556e-12,\n\t     1.183840321267481e-12,\n\t     1.122435026096556e-12,\n\t     9.400849094049688e-13,\n\t     6.423305872147841e-13,\n\t     2.382191739347918e-13,\n\n\t     5.456116108943413e-12,\n\t     4.878985199565852e-12,\n\t     4.240448995017367e-12,\n\t     3.559909094758253e-12,\n\t     2.858043359288075e-12,\n\t     2.156177623817898e-12,\n\t     1.475637723558782e-12,\n\t     8.371015190102975e-13,\n\t     2.599706096327376e-13,\n\n\t     -5.461314069809755e-12,\n\t     -4.921085770524055e-12,\n\t     -4.343405037091838e-12,\n\t     -3.732668368707687e-12,\n\t     -3.093523840190885e-12,\n\t     -2.430835727329465e-12,\n\t     -1.734679010007751e-12,\n\t     -9.748253656609281e-13,\n\t     -2.797435120168326e-13,\n\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     -2.283748241799531e-13,\n\t     -4.037858874020686e-13,\n\t     -2.146547464825323e-13,\n\t     ],\n\t    [\n\t     1.316524975873958e-01, /* win[SHORT_TYPE] */\n\t     4.142135623730950e-01,\n\t     7.673269879789602e-01,\n\n\t     1.091308501069271e+00, /* tantab_l */\n\t     1.303225372841206e+00,\n\t     1.569685577117490e+00,\n\t     1.920982126971166e+00,\n\t     2.414213562373094e+00,\n\t     3.171594802363212e+00,\n\t     4.510708503662055e+00,\n\t     7.595754112725146e+00,\n\t     2.290376554843115e+01,\n\n\t     0.98480775301220802032, /* cx */\n\t     0.64278760968653936292,\n\t     0.34202014332566882393,\n\t     0.93969262078590842791,\n\t     -0.17364817766693030343,\n\t     -0.76604444311897790243,\n\t     0.86602540378443870761,\n\t     0.500000000000000e+00,\n\n\t     -5.144957554275265e-01, /* ca */\n\t     -4.717319685649723e-01,\n\t     -3.133774542039019e-01,\n\t     -1.819131996109812e-01,\n\t     -9.457419252642064e-02,\n\t     -4.096558288530405e-02,\n\t     -1.419856857247115e-02,\n\t     -3.699974673760037e-03,\n\n\t     8.574929257125442e-01, /* cs */\n\t     8.817419973177052e-01,\n\t     9.496286491027329e-01,\n\t     9.833145924917901e-01,\n\t     9.955178160675857e-01,\n\t     9.991605581781475e-01,\n\t     9.998991952444470e-01,\n\t     9.999931550702802e-01,\n\t     ],\n\t    [\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     2.283748241799531e-13,\n\t     4.037858874020686e-13,\n\t     2.146547464825323e-13,\n\n\t     5.461314069809755e-12,\n\t     4.921085770524055e-12,\n\t     4.343405037091838e-12,\n\t     3.732668368707687e-12,\n\t     3.093523840190885e-12,\n\t     2.430835727329466e-12,\n\t     1.734679010007751e-12,\n\t     9.748253656609281e-13,\n\t     2.797435120168326e-13,\n\n\t     -5.456116108943413e-12,\n\t     -4.878985199565852e-12,\n\t     -4.240448995017367e-12,\n\t     -3.559909094758253e-12,\n\t     -2.858043359288075e-12,\n\t     -2.156177623817898e-12,\n\t     -1.475637723558782e-12,\n\t     -8.371015190102975e-13,\n\t     -2.599706096327376e-13,\n\n\t     -2.382191739347913e-13,\n\t     -6.423305872147834e-13,\n\t     -9.400849094049688e-13,\n\t     -1.122435026096556e-12,\n\t     -1.183840321267481e-12,\n\t     -1.122435026096556e-12,\n\t     -9.400849094049688e-13,\n\t     -6.423305872147841e-13,\n\t     -2.382191739347918e-13,\n\t     ]\n\t];\n\n\tvar tantab_l = win[Encoder.SHORT_TYPE];\n\tvar cx = win[Encoder.SHORT_TYPE];\n\tvar ca = win[Encoder.SHORT_TYPE];\n\tvar cs = win[Encoder.SHORT_TYPE];\n\n\t/**\n\t * new IDCT routine written by Takehiro TOMINAGA\n\t *\n\t * PURPOSE: Overlapping window on PCM samples<BR>\n\t *\n\t * SEMANTICS:<BR>\n\t * 32 16-bit pcm samples are scaled to fractional 2's complement and\n\t * concatenated to the end of the window buffer #x#. The updated window\n\t * buffer #x# is then windowed by the analysis window #c# to produce the\n\t * windowed sample #z#\n\t */\n\tvar order = [\n\t    0, 1, 16, 17, 8, 9, 24, 25, 4, 5, 20, 21, 12, 13, 28, 29,\n\t    2, 3, 18, 19, 10, 11, 26, 27, 6, 7, 22, 23, 14, 15, 30, 31\n\t];\n\n\t/**\n\t * returns sum_j=0^31 a[j]*cos(PI*j*(k+1/2)/32), 0<=k<32\n\t */\n\tfunction window_subband(x1, x1Pos, a) {\n\t\tvar wp = 10;\n\n\t\tvar x2 = x1Pos + 238 - 14 - 286;\n\n\t\tfor (var i = -15; i < 0; i++) {\n\t\t\tvar w, s, t;\n\n\t\t\tw = enwindow[wp + -10];\n\t\t\ts = x1[x2 + -224] * w;\n\t\t\tt = x1[x1Pos + 224] * w;\n\t\t\tw = enwindow[wp + -9];\n\t\t\ts += x1[x2 + -160] * w;\n\t\t\tt += x1[x1Pos + 160] * w;\n\t\t\tw = enwindow[wp + -8];\n\t\t\ts += x1[x2 + -96] * w;\n\t\t\tt += x1[x1Pos + 96] * w;\n\t\t\tw = enwindow[wp + -7];\n\t\t\ts += x1[x2 + -32] * w;\n\t\t\tt += x1[x1Pos + 32] * w;\n\t\t\tw = enwindow[wp + -6];\n\t\t\ts += x1[x2 + 32] * w;\n\t\t\tt += x1[x1Pos + -32] * w;\n\t\t\tw = enwindow[wp + -5];\n\t\t\ts += x1[x2 + 96] * w;\n\t\t\tt += x1[x1Pos + -96] * w;\n\t\t\tw = enwindow[wp + -4];\n\t\t\ts += x1[x2 + 160] * w;\n\t\t\tt += x1[x1Pos + -160] * w;\n\t\t\tw = enwindow[wp + -3];\n\t\t\ts += x1[x2 + 224] * w;\n\t\t\tt += x1[x1Pos + -224] * w;\n\n\t\t\tw = enwindow[wp + -2];\n\t\t\ts += x1[x1Pos + -256] * w;\n\t\t\tt -= x1[x2 + 256] * w;\n\t\t\tw = enwindow[wp + -1];\n\t\t\ts += x1[x1Pos + -192] * w;\n\t\t\tt -= x1[x2 + 192] * w;\n\t\t\tw = enwindow[wp + 0];\n\t\t\ts += x1[x1Pos + -128] * w;\n\t\t\tt -= x1[x2 + 128] * w;\n\t\t\tw = enwindow[wp + 1];\n\t\t\ts += x1[x1Pos + -64] * w;\n\t\t\tt -= x1[x2 + 64] * w;\n\t\t\tw = enwindow[wp + 2];\n\t\t\ts += x1[x1Pos + 0] * w;\n\t\t\tt -= x1[x2 + 0] * w;\n\t\t\tw = enwindow[wp + 3];\n\t\t\ts += x1[x1Pos + 64] * w;\n\t\t\tt -= x1[x2 + -64] * w;\n\t\t\tw = enwindow[wp + 4];\n\t\t\ts += x1[x1Pos + 128] * w;\n\t\t\tt -= x1[x2 + -128] * w;\n\t\t\tw = enwindow[wp + 5];\n\t\t\ts += x1[x1Pos + 192] * w;\n\t\t\tt -= x1[x2 + -192] * w;\n\n\t\t\t/*\n\t\t\t * this multiplyer could be removed, but it needs more 256 FLOAT\n\t\t\t * data. thinking about the data cache performance, I think we\n\t\t\t * should not use such a huge table. tt 2000/Oct/25\n\t\t\t */\n\t\t\ts *= enwindow[wp + 6];\n\t\t\tw = t - s;\n\t\t\ta[30 + i * 2] = t + s;\n\t\t\ta[31 + i * 2] = enwindow[wp + 7] * w;\n\t\t\twp += 18;\n\t\t\tx1Pos--;\n\t\t\tx2++;\n\t\t}\n\t\t{\n\t\t\tvar s, t, u, v;\n\t\t\tt = x1[x1Pos + -16] * enwindow[wp + -10];\n\t\t\ts = x1[x1Pos + -32] * enwindow[wp + -2];\n\t\t\tt += (x1[x1Pos + -48] - x1[x1Pos + 16]) * enwindow[wp + -9];\n\t\t\ts += x1[x1Pos + -96] * enwindow[wp + -1];\n\t\t\tt += (x1[x1Pos + -80] + x1[x1Pos + 48]) * enwindow[wp + -8];\n\t\t\ts += x1[x1Pos + -160] * enwindow[wp + 0];\n\t\t\tt += (x1[x1Pos + -112] - x1[x1Pos + 80]) * enwindow[wp + -7];\n\t\t\ts += x1[x1Pos + -224] * enwindow[wp + 1];\n\t\t\tt += (x1[x1Pos + -144] + x1[x1Pos + 112]) * enwindow[wp + -6];\n\t\t\ts -= x1[x1Pos + 32] * enwindow[wp + 2];\n\t\t\tt += (x1[x1Pos + -176] - x1[x1Pos + 144]) * enwindow[wp + -5];\n\t\t\ts -= x1[x1Pos + 96] * enwindow[wp + 3];\n\t\t\tt += (x1[x1Pos + -208] + x1[x1Pos + 176]) * enwindow[wp + -4];\n\t\t\ts -= x1[x1Pos + 160] * enwindow[wp + 4];\n\t\t\tt += (x1[x1Pos + -240] - x1[x1Pos + 208]) * enwindow[wp + -3];\n\t\t\ts -= x1[x1Pos + 224];\n\n\t\t\tu = s - t;\n\t\t\tv = s + t;\n\n\t\t\tt = a[14];\n\t\t\ts = a[15] - t;\n\n\t\t\ta[31] = v + t; /* A0 */\n\t\t\ta[30] = u + s; /* A1 */\n\t\t\ta[15] = u - s; /* A2 */\n\t\t\ta[14] = v - t; /* A3 */\n\t\t}\n\t\t{\n\t\t\tvar xr;\n\t\t\txr = a[28] - a[0];\n\t\t\ta[0] += a[28];\n\t\t\ta[28] = xr * enwindow[wp + -2 * 18 + 7];\n\t\t\txr = a[29] - a[1];\n\t\t\ta[1] += a[29];\n\t\t\ta[29] = xr * enwindow[wp + -2 * 18 + 7];\n\n\t\t\txr = a[26] - a[2];\n\t\t\ta[2] += a[26];\n\t\t\ta[26] = xr * enwindow[wp + -4 * 18 + 7];\n\t\t\txr = a[27] - a[3];\n\t\t\ta[3] += a[27];\n\t\t\ta[27] = xr * enwindow[wp + -4 * 18 + 7];\n\n\t\t\txr = a[24] - a[4];\n\t\t\ta[4] += a[24];\n\t\t\ta[24] = xr * enwindow[wp + -6 * 18 + 7];\n\t\t\txr = a[25] - a[5];\n\t\t\ta[5] += a[25];\n\t\t\ta[25] = xr * enwindow[wp + -6 * 18 + 7];\n\n\t\t\txr = a[22] - a[6];\n\t\t\ta[6] += a[22];\n\t\t\ta[22] = xr * Util.SQRT2;\n\t\t\txr = a[23] - a[7];\n\t\t\ta[7] += a[23];\n\t\t\ta[23] = xr * Util.SQRT2 - a[7];\n\t\t\ta[7] -= a[6];\n\t\t\ta[22] -= a[7];\n\t\t\ta[23] -= a[22];\n\n\t\t\txr = a[6];\n\t\t\ta[6] = a[31] - xr;\n\t\t\ta[31] = a[31] + xr;\n\t\t\txr = a[7];\n\t\t\ta[7] = a[30] - xr;\n\t\t\ta[30] = a[30] + xr;\n\t\t\txr = a[22];\n\t\t\ta[22] = a[15] - xr;\n\t\t\ta[15] = a[15] + xr;\n\t\t\txr = a[23];\n\t\t\ta[23] = a[14] - xr;\n\t\t\ta[14] = a[14] + xr;\n\n\t\t\txr = a[20] - a[8];\n\t\t\ta[8] += a[20];\n\t\t\ta[20] = xr * enwindow[wp + -10 * 18 + 7];\n\t\t\txr = a[21] - a[9];\n\t\t\ta[9] += a[21];\n\t\t\ta[21] = xr * enwindow[wp + -10 * 18 + 7];\n\n\t\t\txr = a[18] - a[10];\n\t\t\ta[10] += a[18];\n\t\t\ta[18] = xr * enwindow[wp + -12 * 18 + 7];\n\t\t\txr = a[19] - a[11];\n\t\t\ta[11] += a[19];\n\t\t\ta[19] = xr * enwindow[wp + -12 * 18 + 7];\n\n\t\t\txr = a[16] - a[12];\n\t\t\ta[12] += a[16];\n\t\t\ta[16] = xr * enwindow[wp + -14 * 18 + 7];\n\t\t\txr = a[17] - a[13];\n\t\t\ta[13] += a[17];\n\t\t\ta[17] = xr * enwindow[wp + -14 * 18 + 7];\n\n\t\t\txr = -a[20] + a[24];\n\t\t\ta[20] += a[24];\n\t\t\ta[24] = xr * enwindow[wp + -12 * 18 + 7];\n\t\t\txr = -a[21] + a[25];\n\t\t\ta[21] += a[25];\n\t\t\ta[25] = xr * enwindow[wp + -12 * 18 + 7];\n\n\t\t\txr = a[4] - a[8];\n\t\t\ta[4] += a[8];\n\t\t\ta[8] = xr * enwindow[wp + -12 * 18 + 7];\n\t\t\txr = a[5] - a[9];\n\t\t\ta[5] += a[9];\n\t\t\ta[9] = xr * enwindow[wp + -12 * 18 + 7];\n\n\t\t\txr = a[0] - a[12];\n\t\t\ta[0] += a[12];\n\t\t\ta[12] = xr * enwindow[wp + -4 * 18 + 7];\n\t\t\txr = a[1] - a[13];\n\t\t\ta[1] += a[13];\n\t\t\ta[13] = xr * enwindow[wp + -4 * 18 + 7];\n\t\t\txr = a[16] - a[28];\n\t\t\ta[16] += a[28];\n\t\t\ta[28] = xr * enwindow[wp + -4 * 18 + 7];\n\t\t\txr = -a[17] + a[29];\n\t\t\ta[17] += a[29];\n\t\t\ta[29] = xr * enwindow[wp + -4 * 18 + 7];\n\n\t\t\txr = Util.SQRT2 * (a[2] - a[10]);\n\t\t\ta[2] += a[10];\n\t\t\ta[10] = xr;\n\t\t\txr = Util.SQRT2 * (a[3] - a[11]);\n\t\t\ta[3] += a[11];\n\t\t\ta[11] = xr;\n\t\t\txr = Util.SQRT2 * (-a[18] + a[26]);\n\t\t\ta[18] += a[26];\n\t\t\ta[26] = xr - a[18];\n\t\t\txr = Util.SQRT2 * (-a[19] + a[27]);\n\t\t\ta[19] += a[27];\n\t\t\ta[27] = xr - a[19];\n\n\t\t\txr = a[2];\n\t\t\ta[19] -= a[3];\n\t\t\ta[3] -= xr;\n\t\t\ta[2] = a[31] - xr;\n\t\t\ta[31] += xr;\n\t\t\txr = a[3];\n\t\t\ta[11] -= a[19];\n\t\t\ta[18] -= xr;\n\t\t\ta[3] = a[30] - xr;\n\t\t\ta[30] += xr;\n\t\t\txr = a[18];\n\t\t\ta[27] -= a[11];\n\t\t\ta[19] -= xr;\n\t\t\ta[18] = a[15] - xr;\n\t\t\ta[15] += xr;\n\n\t\t\txr = a[19];\n\t\t\ta[10] -= xr;\n\t\t\ta[19] = a[14] - xr;\n\t\t\ta[14] += xr;\n\t\t\txr = a[10];\n\t\t\ta[11] -= xr;\n\t\t\ta[10] = a[23] - xr;\n\t\t\ta[23] += xr;\n\t\t\txr = a[11];\n\t\t\ta[26] -= xr;\n\t\t\ta[11] = a[22] - xr;\n\t\t\ta[22] += xr;\n\t\t\txr = a[26];\n\t\t\ta[27] -= xr;\n\t\t\ta[26] = a[7] - xr;\n\t\t\ta[7] += xr;\n\n\t\t\txr = a[27];\n\t\t\ta[27] = a[6] - xr;\n\t\t\ta[6] += xr;\n\n\t\t\txr = Util.SQRT2 * (a[0] - a[4]);\n\t\t\ta[0] += a[4];\n\t\t\ta[4] = xr;\n\t\t\txr = Util.SQRT2 * (a[1] - a[5]);\n\t\t\ta[1] += a[5];\n\t\t\ta[5] = xr;\n\t\t\txr = Util.SQRT2 * (a[16] - a[20]);\n\t\t\ta[16] += a[20];\n\t\t\ta[20] = xr;\n\t\t\txr = Util.SQRT2 * (a[17] - a[21]);\n\t\t\ta[17] += a[21];\n\t\t\ta[21] = xr;\n\n\t\t\txr = -Util.SQRT2 * (a[8] - a[12]);\n\t\t\ta[8] += a[12];\n\t\t\ta[12] = xr - a[8];\n\t\t\txr = -Util.SQRT2 * (a[9] - a[13]);\n\t\t\ta[9] += a[13];\n\t\t\ta[13] = xr - a[9];\n\t\t\txr = -Util.SQRT2 * (a[25] - a[29]);\n\t\t\ta[25] += a[29];\n\t\t\ta[29] = xr - a[25];\n\t\t\txr = -Util.SQRT2 * (a[24] + a[28]);\n\t\t\ta[24] -= a[28];\n\t\t\ta[28] = xr - a[24];\n\n\t\t\txr = a[24] - a[16];\n\t\t\ta[24] = xr;\n\t\t\txr = a[20] - xr;\n\t\t\ta[20] = xr;\n\t\t\txr = a[28] - xr;\n\t\t\ta[28] = xr;\n\n\t\t\txr = a[25] - a[17];\n\t\t\ta[25] = xr;\n\t\t\txr = a[21] - xr;\n\t\t\ta[21] = xr;\n\t\t\txr = a[29] - xr;\n\t\t\ta[29] = xr;\n\n\t\t\txr = a[17] - a[1];\n\t\t\ta[17] = xr;\n\t\t\txr = a[9] - xr;\n\t\t\ta[9] = xr;\n\t\t\txr = a[25] - xr;\n\t\t\ta[25] = xr;\n\t\t\txr = a[5] - xr;\n\t\t\ta[5] = xr;\n\t\t\txr = a[21] - xr;\n\t\t\ta[21] = xr;\n\t\t\txr = a[13] - xr;\n\t\t\ta[13] = xr;\n\t\t\txr = a[29] - xr;\n\t\t\ta[29] = xr;\n\n\t\t\txr = a[1] - a[0];\n\t\t\ta[1] = xr;\n\t\t\txr = a[16] - xr;\n\t\t\ta[16] = xr;\n\t\t\txr = a[17] - xr;\n\t\t\ta[17] = xr;\n\t\t\txr = a[8] - xr;\n\t\t\ta[8] = xr;\n\t\t\txr = a[9] - xr;\n\t\t\ta[9] = xr;\n\t\t\txr = a[24] - xr;\n\t\t\ta[24] = xr;\n\t\t\txr = a[25] - xr;\n\t\t\ta[25] = xr;\n\t\t\txr = a[4] - xr;\n\t\t\ta[4] = xr;\n\t\t\txr = a[5] - xr;\n\t\t\ta[5] = xr;\n\t\t\txr = a[20] - xr;\n\t\t\ta[20] = xr;\n\t\t\txr = a[21] - xr;\n\t\t\ta[21] = xr;\n\t\t\txr = a[12] - xr;\n\t\t\ta[12] = xr;\n\t\t\txr = a[13] - xr;\n\t\t\ta[13] = xr;\n\t\t\txr = a[28] - xr;\n\t\t\ta[28] = xr;\n\t\t\txr = a[29] - xr;\n\t\t\ta[29] = xr;\n\n\t\t\txr = a[0];\n\t\t\ta[0] += a[31];\n\t\t\ta[31] -= xr;\n\t\t\txr = a[1];\n\t\t\ta[1] += a[30];\n\t\t\ta[30] -= xr;\n\t\t\txr = a[16];\n\t\t\ta[16] += a[15];\n\t\t\ta[15] -= xr;\n\t\t\txr = a[17];\n\t\t\ta[17] += a[14];\n\t\t\ta[14] -= xr;\n\t\t\txr = a[8];\n\t\t\ta[8] += a[23];\n\t\t\ta[23] -= xr;\n\t\t\txr = a[9];\n\t\t\ta[9] += a[22];\n\t\t\ta[22] -= xr;\n\t\t\txr = a[24];\n\t\t\ta[24] += a[7];\n\t\t\ta[7] -= xr;\n\t\t\txr = a[25];\n\t\t\ta[25] += a[6];\n\t\t\ta[6] -= xr;\n\t\t\txr = a[4];\n\t\t\ta[4] += a[27];\n\t\t\ta[27] -= xr;\n\t\t\txr = a[5];\n\t\t\ta[5] += a[26];\n\t\t\ta[26] -= xr;\n\t\t\txr = a[20];\n\t\t\ta[20] += a[11];\n\t\t\ta[11] -= xr;\n\t\t\txr = a[21];\n\t\t\ta[21] += a[10];\n\t\t\ta[10] -= xr;\n\t\t\txr = a[12];\n\t\t\ta[12] += a[19];\n\t\t\ta[19] -= xr;\n\t\t\txr = a[13];\n\t\t\ta[13] += a[18];\n\t\t\ta[18] -= xr;\n\t\t\txr = a[28];\n\t\t\ta[28] += a[3];\n\t\t\ta[3] -= xr;\n\t\t\txr = a[29];\n\t\t\ta[29] += a[2];\n\t\t\ta[2] -= xr;\n\t\t}\n\t}\n\n\t/**\n\t * Function: Calculation of the MDCT In the case of long blocks (type 0,1,3)\n\t * there are 36 coefficents in the time domain and 18 in the frequency\n\t * domain.<BR>\n\t * In the case of short blocks (type 2) there are 3 transformations with\n\t * short length. This leads to 12 coefficents in the time and 6 in the\n\t * frequency domain. In this case the results are stored side by side in the\n\t * vector out[].\n\t *\n\t * New layer3\n\t */\n\tfunction mdct_short(inout, inoutPos) {\n\t\tfor (var l = 0; l < 3; l++) {\n\t\t\tvar tc0, tc1, tc2, ts0, ts1, ts2;\n\n\t\t\tts0 = inout[inoutPos + 2 * 3] * win[Encoder.SHORT_TYPE][0]\n\t\t\t\t\t- inout[inoutPos + 5 * 3];\n\t\t\ttc0 = inout[inoutPos + 0 * 3] * win[Encoder.SHORT_TYPE][2]\n\t\t\t\t\t- inout[inoutPos + 3 * 3];\n\t\t\ttc1 = ts0 + tc0;\n\t\t\ttc2 = ts0 - tc0;\n\n\t\t\tts0 = inout[inoutPos + 5 * 3] * win[Encoder.SHORT_TYPE][0]\n\t\t\t\t\t+ inout[inoutPos + 2 * 3];\n\t\t\ttc0 = inout[inoutPos + 3 * 3] * win[Encoder.SHORT_TYPE][2]\n\t\t\t\t\t+ inout[inoutPos + 0 * 3];\n\t\t\tts1 = ts0 + tc0;\n\t\t\tts2 = -ts0 + tc0;\n\n\t\t\ttc0 = (inout[inoutPos + 1 * 3] * win[Encoder.SHORT_TYPE][1] - inout[inoutPos + 4 * 3]) * 2.069978111953089e-11;\n\t\t\t/*\n\t\t\t * tritab_s [ 1 ]\n\t\t\t */\n\t\t\tts0 = (inout[inoutPos + 4 * 3] * win[Encoder.SHORT_TYPE][1] + inout[inoutPos + 1 * 3]) * 2.069978111953089e-11;\n\t\t\t/*\n\t\t\t * tritab_s [ 1 ]\n\t\t\t */\n\t\t\tinout[inoutPos + 3 * 0] = tc1 * 1.907525191737280e-11 + tc0;\n\t\t\t/*\n\t\t\t * tritab_s[ 2 ]\n\t\t\t */\n\t\t\tinout[inoutPos + 3 * 5] = -ts1 * 1.907525191737280e-11 + ts0;\n\t\t\t/*\n\t\t\t * tritab_s[0 ]\n\t\t\t */\n\t\t\ttc2 = tc2 * 0.86602540378443870761 * 1.907525191737281e-11;\n\t\t\t/*\n\t\t\t * tritab_s[ 2]\n\t\t\t */\n\t\t\tts1 = ts1 * 0.5 * 1.907525191737281e-11 + ts0;\n\t\t\tinout[inoutPos + 3 * 1] = tc2 - ts1;\n\t\t\tinout[inoutPos + 3 * 2] = tc2 + ts1;\n\n\t\t\ttc1 = tc1 * 0.5 * 1.907525191737281e-11 - tc0;\n\t\t\tts2 = ts2 * 0.86602540378443870761 * 1.907525191737281e-11;\n\t\t\t/*\n\t\t\t * tritab_s[ 0]\n\t\t\t */\n\t\t\tinout[inoutPos + 3 * 3] = tc1 + ts2;\n\t\t\tinout[inoutPos + 3 * 4] = tc1 - ts2;\n\n\t\t\tinoutPos++;\n\t\t}\n\t}\n\n\tfunction mdct_long(out, outPos, _in) {\n\t\tvar ct, st;\n\t\t{\n\t\t\tvar tc1, tc2, tc3, tc4, ts5, ts6, ts7, ts8;\n\t\t\t/* 1,2, 5,6, 9,10, 13,14, 17 */\n\t\t\ttc1 = _in[17] - _in[9];\n\t\t\ttc3 = _in[15] - _in[11];\n\t\t\ttc4 = _in[14] - _in[12];\n\t\t\tts5 = _in[0] + _in[8];\n\t\t\tts6 = _in[1] + _in[7];\n\t\t\tts7 = _in[2] + _in[6];\n\t\t\tts8 = _in[3] + _in[5];\n\n\t\t\tout[outPos + 17] = (ts5 + ts7 - ts8) - (ts6 - _in[4]);\n\t\t\tst = (ts5 + ts7 - ts8) * cx[12 + 7] + (ts6 - _in[4]);\n\t\t\tct = (tc1 - tc3 - tc4) * cx[12 + 6];\n\t\t\tout[outPos + 5] = ct + st;\n\t\t\tout[outPos + 6] = ct - st;\n\n\t\t\ttc2 = (_in[16] - _in[10]) * cx[12 + 6];\n\t\t\tts6 = ts6 * cx[12 + 7] + _in[4];\n\t\t\tct = tc1 * cx[12 + 0] + tc2 + tc3 * cx[12 + 1] + tc4 * cx[12 + 2];\n\t\t\tst = -ts5 * cx[12 + 4] + ts6 - ts7 * cx[12 + 5] + ts8 * cx[12 + 3];\n\t\t\tout[outPos + 1] = ct + st;\n\t\t\tout[outPos + 2] = ct - st;\n\n\t\t\tct = tc1 * cx[12 + 1] - tc2 - tc3 * cx[12 + 2] + tc4 * cx[12 + 0];\n\t\t\tst = -ts5 * cx[12 + 5] + ts6 - ts7 * cx[12 + 3] + ts8 * cx[12 + 4];\n\t\t\tout[outPos + 9] = ct + st;\n\t\t\tout[outPos + 10] = ct - st;\n\n\t\t\tct = tc1 * cx[12 + 2] - tc2 + tc3 * cx[12 + 0] - tc4 * cx[12 + 1];\n\t\t\tst = ts5 * cx[12 + 3] - ts6 + ts7 * cx[12 + 4] - ts8 * cx[12 + 5];\n\t\t\tout[outPos + 13] = ct + st;\n\t\t\tout[outPos + 14] = ct - st;\n\t\t}\n\t\t{\n\t\t\tvar ts1, ts2, ts3, ts4, tc5, tc6, tc7, tc8;\n\n\t\t\tts1 = _in[8] - _in[0];\n\t\t\tts3 = _in[6] - _in[2];\n\t\t\tts4 = _in[5] - _in[3];\n\t\t\ttc5 = _in[17] + _in[9];\n\t\t\ttc6 = _in[16] + _in[10];\n\t\t\ttc7 = _in[15] + _in[11];\n\t\t\ttc8 = _in[14] + _in[12];\n\n\t\t\tout[outPos + 0] = (tc5 + tc7 + tc8) + (tc6 + _in[13]);\n\t\t\tct = (tc5 + tc7 + tc8) * cx[12 + 7] - (tc6 + _in[13]);\n\t\t\tst = (ts1 - ts3 + ts4) * cx[12 + 6];\n\t\t\tout[outPos + 11] = ct + st;\n\t\t\tout[outPos + 12] = ct - st;\n\n\t\t\tts2 = (_in[7] - _in[1]) * cx[12 + 6];\n\t\t\ttc6 = _in[13] - tc6 * cx[12 + 7];\n\t\t\tct = tc5 * cx[12 + 3] - tc6 + tc7 * cx[12 + 4] + tc8 * cx[12 + 5];\n\t\t\tst = ts1 * cx[12 + 2] + ts2 + ts3 * cx[12 + 0] + ts4 * cx[12 + 1];\n\t\t\tout[outPos + 3] = ct + st;\n\t\t\tout[outPos + 4] = ct - st;\n\n\t\t\tct = -tc5 * cx[12 + 5] + tc6 - tc7 * cx[12 + 3] - tc8 * cx[12 + 4];\n\t\t\tst = ts1 * cx[12 + 1] + ts2 - ts3 * cx[12 + 2] - ts4 * cx[12 + 0];\n\t\t\tout[outPos + 7] = ct + st;\n\t\t\tout[outPos + 8] = ct - st;\n\n\t\t\tct = -tc5 * cx[12 + 4] + tc6 - tc7 * cx[12 + 5] - tc8 * cx[12 + 3];\n\t\t\tst = ts1 * cx[12 + 0] - ts2 + ts3 * cx[12 + 1] - ts4 * cx[12 + 2];\n\t\t\tout[outPos + 15] = ct + st;\n\t\t\tout[outPos + 16] = ct - st;\n\t\t}\n\t}\n\n\tthis.mdct_sub48 = function(gfc, w0, w1) {\n\t\tvar wk = w0;\n\t\tvar wkPos = 286;\n\t\t/* thinking cache performance, ch->gr loop is better than gr->ch loop */\n\t\tfor (var ch = 0; ch < gfc.channels_out; ch++) {\n\t\t\tfor (var gr = 0; gr < gfc.mode_gr; gr++) {\n\t\t\t\tvar band;\n\t\t\t\tvar gi = (gfc.l3_side.tt[gr][ch]);\n\t\t\t\tvar mdct_enc = gi.xr;\n\t\t\t\tvar mdct_encPos = 0;\n\t\t\t\tvar samp = gfc.sb_sample[ch][1 - gr];\n\t\t\t\tvar sampPos = 0;\n\n\t\t\t\tfor (var k = 0; k < 18 / 2; k++) {\n\t\t\t\t\twindow_subband(wk, wkPos, samp[sampPos]);\n\t\t\t\t\twindow_subband(wk, wkPos + 32, samp[sampPos + 1]);\n\t\t\t\t\tsampPos += 2;\n\t\t\t\t\twkPos += 64;\n\t\t\t\t\t/*\n\t\t\t\t\t * Compensate for inversion in the analysis filter\n\t\t\t\t\t */\n\t\t\t\t\tfor (band = 1; band < 32; band += 2) {\n\t\t\t\t\t\tsamp[sampPos - 1][band] *= -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/*\n\t\t\t\t * Perform imdct of 18 previous subband samples + 18 current\n\t\t\t\t * subband samples\n\t\t\t\t */\n\t\t\t\tfor (band = 0; band < 32; band++, mdct_encPos += 18) {\n\t\t\t\t\tvar type = gi.block_type;\n\t\t\t\t\tvar band0 = gfc.sb_sample[ch][gr];\n\t\t\t\t\tvar band1 = gfc.sb_sample[ch][1 - gr];\n\t\t\t\t\tif (gi.mixed_block_flag != 0 && band < 2)\n\t\t\t\t\t\ttype = 0;\n\t\t\t\t\tif (gfc.amp_filter[band] < 1e-12) {\n\t\t\t\t\t\tArrays.fill(mdct_enc, mdct_encPos + 0,\n\t\t\t\t\t\t\t\tmdct_encPos + 18, 0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (gfc.amp_filter[band] < 1.0) {\n\t\t\t\t\t\t\tfor (var k = 0; k < 18; k++)\n\t\t\t\t\t\t\t\tband1[k][order[band]] *= gfc.amp_filter[band];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (type == Encoder.SHORT_TYPE) {\n\t\t\t\t\t\t\tfor (var k = -NS / 4; k < 0; k++) {\n\t\t\t\t\t\t\t\tvar w = win[Encoder.SHORT_TYPE][k + 3];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 9] = band0[9 + k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w - band0[8 - k][order[band]];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 18] = band0[14 - k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w + band0[15 + k][order[band]];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 10] = band0[15 + k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w - band0[14 - k][order[band]];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 19] = band1[2 - k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w + band1[3 + k][order[band]];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 11] = band1[3 + k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w - band1[2 - k][order[band]];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 20] = band1[8 - k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w + band1[9 + k][order[band]];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tmdct_short(mdct_enc, mdct_encPos);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar work = new_float(18);\n\t\t\t\t\t\t\tfor (var k = -NL / 4; k < 0; k++) {\n\t\t\t\t\t\t\t\tvar a, b;\n\t\t\t\t\t\t\t\ta = win[type][k + 27]\n\t\t\t\t\t\t\t\t\t\t* band1[k + 9][order[band]]\n\t\t\t\t\t\t\t\t\t\t+ win[type][k + 36]\n\t\t\t\t\t\t\t\t\t\t* band1[8 - k][order[band]];\n\t\t\t\t\t\t\t\tb = win[type][k + 9]\n\t\t\t\t\t\t\t\t\t\t* band0[k + 9][order[band]]\n\t\t\t\t\t\t\t\t\t\t- win[type][k + 18]\n\t\t\t\t\t\t\t\t\t\t* band0[8 - k][order[band]];\n\t\t\t\t\t\t\t\twork[k + 9] = a - b * tantab_l[3 + k + 9];\n\t\t\t\t\t\t\t\twork[k + 18] = a * tantab_l[3 + k + 9] + b;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tmdct_long(mdct_enc, mdct_encPos, work);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t/*\n\t\t\t\t\t * Perform aliasing reduction butterfly\n\t\t\t\t\t */\n\t\t\t\t\tif (type != Encoder.SHORT_TYPE && band != 0) {\n\t\t\t\t\t\tfor (var k = 7; k >= 0; --k) {\n\t\t\t\t\t\t\tvar bu, bd;\n\t\t\t\t\t\t\tbu = mdct_enc[mdct_encPos + k] * ca[20 + k]\n\t\t\t\t\t\t\t\t\t+ mdct_enc[mdct_encPos + -1 - k]\n\t\t\t\t\t\t\t\t\t* cs[28 + k];\n\t\t\t\t\t\t\tbd = mdct_enc[mdct_encPos + k] * cs[28 + k]\n\t\t\t\t\t\t\t\t\t- mdct_enc[mdct_encPos + -1 - k]\n\t\t\t\t\t\t\t\t\t* ca[20 + k];\n\n\t\t\t\t\t\t\tmdct_enc[mdct_encPos + -1 - k] = bu;\n\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k] = bd;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\twk = w1;\n\t\t\twkPos = 286;\n\t\t\tif (gfc.mode_gr == 1) {\n\t\t\t\tfor (var i = 0; i < 18; i++) {\n\t\t\t\t\tSystem.arraycopy(gfc.sb_sample[ch][1][i], 0,\n\t\t\t\t\t\t\tgfc.sb_sample[ch][0][i], 0, 32);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n//package mp3;\n\n\nfunction III_psy_ratio() {\n\tthis.thm = new III_psy_xmin();\n\tthis.en = new III_psy_xmin();\n}\n\n\n/**\n * ENCDELAY The encoder delay.\n *\n * Minimum allowed is MDCTDELAY (see below)\n *\n * The first 96 samples will be attenuated, so using a value less than 96\n * will result in corrupt data for the first 96-ENCDELAY samples.\n *\n * suggested: 576 set to 1160 to sync with FhG.\n */\nEncoder.ENCDELAY = 576;\n/**\n * make sure there is at least one complete frame after the last frame\n * containing real data\n *\n * Using a value of 288 would be sufficient for a a very sophisticated\n * decoder that can decode granule-by-granule instead of frame by frame. But\n * lets not assume this, and assume the decoder will not decode frame N\n * unless it also has data for frame N+1\n */\nEncoder.POSTDELAY = 1152;\n\n/**\n * delay of the MDCT used in mdct.c original ISO routines had a delay of\n * 528! Takehiro's routines:\n */\nEncoder.MDCTDELAY = 48;\nEncoder.FFTOFFSET = (224 + Encoder.MDCTDELAY);\n\n/**\n * Most decoders, including the one we use, have a delay of 528 samples.\n */\nEncoder.DECDELAY = 528;\n\n/**\n * number of subbands\n */\nEncoder.SBLIMIT = 32;\n\n/**\n * parition bands bands\n */\nEncoder.CBANDS = 64;\n\n/**\n * number of critical bands/scale factor bands where masking is computed\n */\nEncoder.SBPSY_l = 21;\nEncoder.SBPSY_s = 12;\n\n/**\n * total number of scalefactor bands encoded\n */\nEncoder.SBMAX_l = 22;\nEncoder.SBMAX_s = 13;\nEncoder.PSFB21 = 6;\nEncoder.PSFB12 = 6;\n\n/**\n * FFT sizes\n */\nEncoder.BLKSIZE = 1024;\nEncoder.HBLKSIZE = (Encoder.BLKSIZE / 2 + 1);\nEncoder.BLKSIZE_s = 256;\nEncoder.HBLKSIZE_s = (Encoder.BLKSIZE_s / 2 + 1);\n\nEncoder.NORM_TYPE = 0;\nEncoder.START_TYPE = 1;\nEncoder.SHORT_TYPE = 2;\nEncoder.STOP_TYPE = 3;\n\n/**\n * <PRE>\n * Mode Extention:\n * When we are in stereo mode, there are 4 possible methods to store these\n * two channels. The stereo modes -m? are using a subset of them.\n *\n *  -ms: MPG_MD_LR_LR\n *  -mj: MPG_MD_LR_LR and MPG_MD_MS_LR\n *  -mf: MPG_MD_MS_LR\n *  -mi: all\n * </PRE>\n */\nEncoder.MPG_MD_LR_LR = 0;\nEncoder.MPG_MD_LR_I = 1;\nEncoder.MPG_MD_MS_LR = 2;\nEncoder.MPG_MD_MS_I = 3;\n\nEncoder.fircoef = [-0.0207887 * 5, -0.0378413 * 5,\n    -0.0432472 * 5, -0.031183 * 5, 7.79609e-18 * 5, 0.0467745 * 5,\n    0.10091 * 5, 0.151365 * 5, 0.187098 * 5];\n\nfunction Encoder() {\n\n    var FFTOFFSET = Encoder.FFTOFFSET;\n    var MPG_MD_MS_LR = Encoder.MPG_MD_MS_LR;\n    //BitStream bs;\n    //PsyModel psy;\n    //VBRTag vbr;\n    //QuantizePVT qupvt;\n    var bs = null;\n    this.psy = null;\n    var psy = null;\n    var vbr = null;\n    var qupvt = null;\n\n    //public final void setModules(BitStream bs, PsyModel psy, QuantizePVT qupvt,\n    //    VBRTag vbr) {\n    this.setModules = function (_bs, _psy, _qupvt, _vbr) {\n        bs = _bs;\n        this.psy = _psy;\n        psy = _psy;\n        vbr = _vbr;\n        qupvt = _qupvt;\n    };\n\n    var newMDCT = new NewMDCT();\n\n    /***********************************************************************\n     *\n     * encoder and decoder delays\n     *\n     ***********************************************************************/\n\n    /**\n     * <PRE>\n     * layer III enc->dec delay:  1056 (1057?)   (observed)\n     * layer  II enc->dec delay:   480  (481?)   (observed)\n     *\n     * polyphase 256-16             (dec or enc)        = 240\n     * mdct      256+32  (9*32)     (dec or enc)        = 288\n     * total:    512+16\n     *\n     * My guess is that delay of polyphase filterbank is actualy 240.5\n     * (there are technical reasons for this, see postings in mp3encoder).\n     * So total Encode+Decode delay = ENCDELAY + 528 + 1\n     * </PRE>\n     */\n\n\n    /**\n     * auto-adjust of ATH, useful for low volume Gabriel Bouvigne 3 feb 2001\n     *\n     * modifies some values in gfp.internal_flags.ATH (gfc.ATH)\n     */\n//private void adjust_ATH(final LameInternalFlags gfc) {\n    function adjust_ATH(gfc) {\n        var gr2_max, max_pow;\n\n        if (gfc.ATH.useAdjust == 0) {\n            gfc.ATH.adjust = 1.0;\n            /* no adjustment */\n            return;\n        }\n\n        /* jd - 2001 mar 12, 27, jun 30 */\n        /* loudness based on equal loudness curve; */\n        /* use granule with maximum combined loudness */\n        max_pow = gfc.loudness_sq[0][0];\n        gr2_max = gfc.loudness_sq[1][0];\n        if (gfc.channels_out == 2) {\n            max_pow += gfc.loudness_sq[0][1];\n            gr2_max += gfc.loudness_sq[1][1];\n        } else {\n            max_pow += max_pow;\n            gr2_max += gr2_max;\n        }\n        if (gfc.mode_gr == 2) {\n            max_pow = Math.max(max_pow, gr2_max);\n        }\n        max_pow *= 0.5;\n        /* max_pow approaches 1.0 for full band noise */\n\n        /* jd - 2001 mar 31, jun 30 */\n        /* user tuning of ATH adjustment region */\n        max_pow *= gfc.ATH.aaSensitivityP;\n\n        /*\n         * adjust ATH depending on range of maximum value\n         */\n\n        /* jd - 2001 feb27, mar12,20, jun30, jul22 */\n        /* continuous curves based on approximation */\n        /* to GB's original values. */\n        /* For an increase in approximate loudness, */\n        /* set ATH adjust to adjust_limit immediately */\n        /* after a delay of one frame. */\n        /* For a loudness decrease, reduce ATH adjust */\n        /* towards adjust_limit gradually. */\n        /* max_pow is a loudness squared or a power. */\n        if (max_pow > 0.03125) { /* ((1 - 0.000625)/ 31.98) from curve below */\n            if (gfc.ATH.adjust >= 1.0) {\n                gfc.ATH.adjust = 1.0;\n            } else {\n                /* preceding frame has lower ATH adjust; */\n                /* ascend only to the preceding adjust_limit */\n                /* in case there is leading low volume */\n                if (gfc.ATH.adjust < gfc.ATH.adjustLimit) {\n                    gfc.ATH.adjust = gfc.ATH.adjustLimit;\n                }\n            }\n            gfc.ATH.adjustLimit = 1.0;\n        } else { /* adjustment curve */\n            /* about 32 dB maximum adjust (0.000625) */\n            var adj_lim_new = 31.98 * max_pow + 0.000625;\n            if (gfc.ATH.adjust >= adj_lim_new) { /* descend gradually */\n                gfc.ATH.adjust *= adj_lim_new * 0.075 + 0.925;\n                if (gfc.ATH.adjust < adj_lim_new) { /* stop descent */\n                    gfc.ATH.adjust = adj_lim_new;\n                }\n            } else { /* ascend */\n                if (gfc.ATH.adjustLimit >= adj_lim_new) {\n                    gfc.ATH.adjust = adj_lim_new;\n                } else {\n                    /* preceding frame has lower ATH adjust; */\n                    /* ascend only to the preceding adjust_limit */\n                    if (gfc.ATH.adjust < gfc.ATH.adjustLimit) {\n                        gfc.ATH.adjust = gfc.ATH.adjustLimit;\n                    }\n                }\n            }\n            gfc.ATH.adjustLimit = adj_lim_new;\n        }\n    }\n\n    /**\n     * <PRE>\n     *  some simple statistics\n     *\n     *  bitrate index 0: free bitrate . not allowed in VBR mode\n     *  : bitrates, kbps depending on MPEG version\n     *  bitrate index 15: forbidden\n     *\n     *  mode_ext:\n     *  0:  LR\n     *  1:  LR-i\n     *  2:  MS\n     *  3:  MS-i\n     * </PRE>\n     */\n    function updateStats(gfc) {\n        var gr, ch;\n\n        /* count bitrate indices */\n        gfc.bitrate_stereoMode_Hist[gfc.bitrate_index][4]++;\n        gfc.bitrate_stereoMode_Hist[15][4]++;\n\n        /* count 'em for every mode extension in case of 2 channel encoding */\n        if (gfc.channels_out == 2) {\n            gfc.bitrate_stereoMode_Hist[gfc.bitrate_index][gfc.mode_ext]++;\n            gfc.bitrate_stereoMode_Hist[15][gfc.mode_ext]++;\n        }\n        for (gr = 0; gr < gfc.mode_gr; ++gr) {\n            for (ch = 0; ch < gfc.channels_out; ++ch) {\n                var bt = gfc.l3_side.tt[gr][ch].block_type | 0;\n                if (gfc.l3_side.tt[gr][ch].mixed_block_flag != 0)\n                    bt = 4;\n                gfc.bitrate_blockType_Hist[gfc.bitrate_index][bt]++;\n                gfc.bitrate_blockType_Hist[gfc.bitrate_index][5]++;\n                gfc.bitrate_blockType_Hist[15][bt]++;\n                gfc.bitrate_blockType_Hist[15][5]++;\n            }\n        }\n    }\n\n    function lame_encode_frame_init(gfp, inbuf) {\n        var gfc = gfp.internal_flags;\n\n        var ch, gr;\n\n        if (gfc.lame_encode_frame_init == 0) {\n            /* prime the MDCT/polyphase filterbank with a short block */\n            var i, j;\n            var primebuff0 = new_float(286 + 1152 + 576);\n            var primebuff1 = new_float(286 + 1152 + 576);\n            gfc.lame_encode_frame_init = 1;\n            for (i = 0, j = 0; i < 286 + 576 * (1 + gfc.mode_gr); ++i) {\n                if (i < 576 * gfc.mode_gr) {\n                    primebuff0[i] = 0;\n                    if (gfc.channels_out == 2)\n                        primebuff1[i] = 0;\n                } else {\n                    primebuff0[i] = inbuf[0][j];\n                    if (gfc.channels_out == 2)\n                        primebuff1[i] = inbuf[1][j];\n                    ++j;\n                }\n            }\n            /* polyphase filtering / mdct */\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    gfc.l3_side.tt[gr][ch].block_type = Encoder.SHORT_TYPE;\n                }\n            }\n            newMDCT.mdct_sub48(gfc, primebuff0, primebuff1);\n\n            /* check FFT will not use a negative starting offset */\n            /* check if we have enough data for FFT */\n            /* check if we have enough data for polyphase filterbank */\n        }\n\n    }\n\n    /**\n     * <PRE>\n     * encodeframe()           Layer 3\n     *\n     * encode a single frame\n     *\n     *\n     *    lame_encode_frame()\n     *\n     *\n     *                           gr 0            gr 1\n     *    inbuf:           |--------------|--------------|--------------|\n     *\n     *\n     *    Polyphase (18 windows, each shifted 32)\n     *    gr 0:\n     *    window1          <----512---.\n     *    window18                 <----512---.\n     *\n     *    gr 1:\n     *    window1                         <----512---.\n     *    window18                                <----512---.\n     *\n     *\n     *\n     *    MDCT output:  |--------------|--------------|--------------|\n     *\n     *    FFT's                    <---------1024---------.\n     *                                             <---------1024-------.\n     *\n     *\n     *\n     *        inbuf = buffer of PCM data size=MP3 framesize\n     *        encoder acts on inbuf[ch][0], but output is delayed by MDCTDELAY\n     *        so the MDCT coefficints are from inbuf[ch][-MDCTDELAY]\n     *\n     *        psy-model FFT has a 1 granule delay, so we feed it data for the\n     *        next granule.\n     *        FFT is centered over granule:  224+576+224\n     *        So FFT starts at:   576-224-MDCTDELAY\n     *\n     *        MPEG2:  FFT ends at:  BLKSIZE+576-224-MDCTDELAY      (1328)\n     *        MPEG1:  FFT ends at:  BLKSIZE+2*576-224-MDCTDELAY    (1904)\n     *\n     *        MPEG2:  polyphase first window:  [0..511]\n     *                          18th window:   [544..1055]          (1056)\n     *        MPEG1:            36th window:   [1120..1631]         (1632)\n     *                data needed:  512+framesize-32\n     *\n     *        A close look newmdct.c shows that the polyphase filterbank\n     *        only uses data from [0..510] for each window.  Perhaps because the window\n     *        used by the filterbank is zero for the last point, so Takehiro's\n     *        code doesn't bother to compute with it.\n     *\n     *        FFT starts at 576-224-MDCTDELAY (304)  = 576-FFTOFFSET\n     *\n     * </PRE>\n     */\n\n\n    this.lame_encode_mp3_frame = function (gfp, inbuf_l, inbuf_r, mp3buf, mp3bufPos, mp3buf_size) {\n        var mp3count;\n        var masking_LR = new_array_n([2, 2]);\n        /*\n         * LR masking &\n         * energy\n         */\n        masking_LR[0][0] = new III_psy_ratio();\n        masking_LR[0][1] = new III_psy_ratio();\n        masking_LR[1][0] = new III_psy_ratio();\n        masking_LR[1][1] = new III_psy_ratio();\n        var masking_MS = new_array_n([2, 2]);\n        /* MS masking & energy */\n        masking_MS[0][0] = new III_psy_ratio();\n        masking_MS[0][1] = new III_psy_ratio();\n        masking_MS[1][0] = new III_psy_ratio();\n        masking_MS[1][1] = new III_psy_ratio();\n        //III_psy_ratio masking[][];\n        var masking;\n        /* pointer to selected maskings */\n        var inbuf = [null, null];\n        var gfc = gfp.internal_flags;\n\n        var tot_ener = new_float_n([2, 4]);\n        var ms_ener_ratio = [.5, .5];\n        var pe = [[0., 0.], [0., 0.]];\n        var pe_MS = [[0., 0.], [0., 0.]];\n\n//float[][] pe_use;\n        var pe_use;\n\n        var ch, gr;\n\n        inbuf[0] = inbuf_l;\n        inbuf[1] = inbuf_r;\n\n        if (gfc.lame_encode_frame_init == 0) {\n            /* first run? */\n            lame_encode_frame_init(gfp, inbuf);\n\n        }\n\n        /********************** padding *****************************/\n        /**\n         * <PRE>\n         * padding method as described in\n         * \"MPEG-Layer3 / Bitstream Syntax and Decoding\"\n         * by Martin Sieler, Ralph Sperschneider\n         *\n         * note: there is no padding for the very first frame\n         *\n         * Robert Hegemann 2000-06-22\n         * </PRE>\n         */\n        gfc.padding = 0;\n        if ((gfc.slot_lag -= gfc.frac_SpF) < 0) {\n            gfc.slot_lag += gfp.out_samplerate;\n            gfc.padding = 1;\n        }\n\n        /****************************************\n         * Stage 1: psychoacoustic model *\n         ****************************************/\n\n        if (gfc.psymodel != 0) {\n            /*\n             * psychoacoustic model psy model has a 1 granule (576) delay that\n             * we must compensate for (mt 6/99).\n             */\n            var ret;\n            var bufp = [null, null];\n            /* address of beginning of left & right granule */\n            var bufpPos = 0;\n            /* address of beginning of left & right granule */\n            var blocktype = new_int(2);\n\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    bufp[ch] = inbuf[ch];\n                    bufpPos = 576 + gr * 576 - Encoder.FFTOFFSET;\n                }\n                if (gfp.VBR == VbrMode.vbr_mtrh || gfp.VBR == VbrMode.vbr_mt) {\n                    ret = psy.L3psycho_anal_vbr(gfp, bufp, bufpPos, gr,\n                        masking_LR, masking_MS, pe[gr], pe_MS[gr],\n                        tot_ener[gr], blocktype);\n                } else {\n                    ret = psy.L3psycho_anal_ns(gfp, bufp, bufpPos, gr,\n                        masking_LR, masking_MS, pe[gr], pe_MS[gr],\n                        tot_ener[gr], blocktype);\n                }\n                if (ret != 0)\n                    return -4;\n\n                if (gfp.mode == MPEGMode.JOINT_STEREO) {\n                    ms_ener_ratio[gr] = tot_ener[gr][2] + tot_ener[gr][3];\n                    if (ms_ener_ratio[gr] > 0)\n                        ms_ener_ratio[gr] = tot_ener[gr][3] / ms_ener_ratio[gr];\n                }\n\n                /* block type flags */\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    var cod_info = gfc.l3_side.tt[gr][ch];\n                    cod_info.block_type = blocktype[ch];\n                    cod_info.mixed_block_flag = 0;\n                }\n            }\n        } else {\n            /* no psy model */\n            for (gr = 0; gr < gfc.mode_gr; gr++)\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    gfc.l3_side.tt[gr][ch].block_type = Encoder.NORM_TYPE;\n                    gfc.l3_side.tt[gr][ch].mixed_block_flag = 0;\n                    pe_MS[gr][ch] = pe[gr][ch] = 700;\n                }\n        }\n\n        /* auto-adjust of ATH, useful for low volume */\n        adjust_ATH(gfc);\n\n        /****************************************\n         * Stage 2: MDCT *\n         ****************************************/\n\n        /* polyphase filtering / mdct */\n        newMDCT.mdct_sub48(gfc, inbuf[0], inbuf[1]);\n\n        /****************************************\n         * Stage 3: MS/LR decision *\n         ****************************************/\n\n        /* Here will be selected MS or LR coding of the 2 stereo channels */\n        gfc.mode_ext = Encoder.MPG_MD_LR_LR;\n\n        if (gfp.force_ms) {\n            gfc.mode_ext = Encoder.MPG_MD_MS_LR;\n        } else if (gfp.mode == MPEGMode.JOINT_STEREO) {\n            /*\n             * ms_ratio = is scaled, for historical reasons, to look like a\n             * ratio of side_channel / total. 0 = signal is 100% mono .5 = L & R\n             * uncorrelated\n             */\n\n            /**\n             * <PRE>\n             * [0] and [1] are the results for the two granules in MPEG-1,\n             * in MPEG-2 it's only a faked averaging of the same value\n             * _prev is the value of the last granule of the previous frame\n             * _next is the value of the first granule of the next frame\n             * </PRE>\n             */\n\n            var sum_pe_MS = 0.;\n            var sum_pe_LR = 0.;\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    sum_pe_MS += pe_MS[gr][ch];\n                    sum_pe_LR += pe[gr][ch];\n                }\n            }\n\n            /* based on PE: M/S coding would not use much more bits than L/R */\n            if (sum_pe_MS <= 1.00 * sum_pe_LR) {\n\n                var gi0 = gfc.l3_side.tt[0];\n                var gi1 = gfc.l3_side.tt[gfc.mode_gr - 1];\n\n                if (gi0[0].block_type == gi0[1].block_type\n                    && gi1[0].block_type == gi1[1].block_type) {\n\n                    gfc.mode_ext = Encoder.MPG_MD_MS_LR;\n                }\n            }\n        }\n\n        /* bit and noise allocation */\n        if (gfc.mode_ext == MPG_MD_MS_LR) {\n            masking = masking_MS;\n            /* use MS masking */\n            pe_use = pe_MS;\n        } else {\n            masking = masking_LR;\n            /* use LR masking */\n            pe_use = pe;\n        }\n\n        /* copy data for MP3 frame analyzer */\n        if (gfp.analysis && gfc.pinfo != null) {\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    gfc.pinfo.ms_ratio[gr] = gfc.ms_ratio[gr];\n                    gfc.pinfo.ms_ener_ratio[gr] = ms_ener_ratio[gr];\n                    gfc.pinfo.blocktype[gr][ch] = gfc.l3_side.tt[gr][ch].block_type;\n                    gfc.pinfo.pe[gr][ch] = pe_use[gr][ch];\n                    System.arraycopy(gfc.l3_side.tt[gr][ch].xr, 0,\n                        gfc.pinfo.xr[gr][ch], 0, 576);\n                    /*\n                     * in psymodel, LR and MS data was stored in pinfo. switch\n                     * to MS data:\n                     */\n                    if (gfc.mode_ext == MPG_MD_MS_LR) {\n                        gfc.pinfo.ers[gr][ch] = gfc.pinfo.ers[gr][ch + 2];\n                        System.arraycopy(gfc.pinfo.energy[gr][ch + 2], 0,\n                            gfc.pinfo.energy[gr][ch], 0,\n                            gfc.pinfo.energy[gr][ch].length);\n                    }\n                }\n            }\n        }\n\n        /****************************************\n         * Stage 4: quantization loop *\n         ****************************************/\n\n        if (gfp.VBR == VbrMode.vbr_off || gfp.VBR == VbrMode.vbr_abr) {\n\n            var i;\n            var f;\n\n            for (i = 0; i < 18; i++)\n                gfc.nsPsy.pefirbuf[i] = gfc.nsPsy.pefirbuf[i + 1];\n\n            f = 0.0;\n            for (gr = 0; gr < gfc.mode_gr; gr++)\n                for (ch = 0; ch < gfc.channels_out; ch++)\n                    f += pe_use[gr][ch];\n            gfc.nsPsy.pefirbuf[18] = f;\n\n            f = gfc.nsPsy.pefirbuf[9];\n            for (i = 0; i < 9; i++)\n                f += (gfc.nsPsy.pefirbuf[i] + gfc.nsPsy.pefirbuf[18 - i])\n                    * Encoder.fircoef[i];\n\n            f = (670 * 5 * gfc.mode_gr * gfc.channels_out) / f;\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    pe_use[gr][ch] *= f;\n                }\n            }\n        }\n        gfc.iteration_loop.iteration_loop(gfp, pe_use, ms_ener_ratio, masking);\n\n        /****************************************\n         * Stage 5: bitstream formatting *\n         ****************************************/\n\n        /* write the frame to the bitstream */\n        bs.format_bitstream(gfp);\n\n        /* copy mp3 bit buffer into array */\n        mp3count = bs.copy_buffer(gfc, mp3buf, mp3bufPos, mp3buf_size, 1);\n\n        if (gfp.bWriteVbrTag)\n            vbr.addVbrFrame(gfp);\n\n        if (gfp.analysis && gfc.pinfo != null) {\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                var j;\n                for (j = 0; j < FFTOFFSET; j++)\n                    gfc.pinfo.pcmdata[ch][j] = gfc.pinfo.pcmdata[ch][j\n                    + gfp.framesize];\n                for (j = FFTOFFSET; j < 1600; j++) {\n                    gfc.pinfo.pcmdata[ch][j] = inbuf[ch][j - FFTOFFSET];\n                }\n            }\n            qupvt.set_frame_pinfo(gfp, masking);\n        }\n\n        updateStats(gfc);\n\n        return mp3count;\n    }\n}\n\n\n//package mp3;\n\nfunction VBRSeekInfo() {\n    /**\n     * What we have seen so far.\n     */\n    this.sum = 0;\n    /**\n     * How many frames we have seen in this chunk.\n     */\n    this.seen = 0;\n    /**\n     * How many frames we want to collect into one chunk.\n     */\n    this.want = 0;\n    /**\n     * Actual position in our bag.\n     */\n    this.pos = 0;\n    /**\n     * Size of our bag.\n     */\n    this.size = 0;\n    /**\n     * Pointer to our bag.\n     */\n    this.bag = null;\n    this.nVbrNumFrames = 0;\n    this.nBytesWritten = 0;\n    /* VBR tag data */\n    this.TotalFrameSize = 0;\n}\n\n\n\nfunction IIISideInfo() {\n    this.tt = [[null, null], [null, null]];\n    this.main_data_begin = 0;\n    this.private_bits = 0;\n    this.resvDrain_pre = 0;\n    this.resvDrain_post = 0;\n    this.scfsi = [new_int(4), new_int(4)];\n\n    for (var gr = 0; gr < 2; gr++) {\n        for (var ch = 0; ch < 2; ch++) {\n            this.tt[gr][ch] = new GrInfo();\n        }\n    }\n}\n\n\nfunction III_psy_xmin() {\n    this.l = new_float(Encoder.SBMAX_l);\n    this.s = new_float_n([Encoder.SBMAX_s, 3]);\n\n    var self = this;\n    this.assign = function (iii_psy_xmin) {\n        System.arraycopy(iii_psy_xmin.l, 0, self.l, 0, Encoder.SBMAX_l);\n        for (var i = 0; i < Encoder.SBMAX_s; i++) {\n            for (var j = 0; j < 3; j++) {\n                self.s[i][j] = iii_psy_xmin.s[i][j];\n            }\n        }\n    }\n}\n\n\n\n//package mp3;\n\n/**\n * Variables used for --nspsytune\n *\n * @author Ken\n *\n */\nfunction NsPsy() {\n    this.last_en_subshort = new_float_n([4, 9]);\n    this.lastAttacks = new_int(4);\n    this.pefirbuf = new_float(19);\n    this.longfact = new_float(Encoder.SBMAX_l);\n    this.shortfact = new_float(Encoder.SBMAX_s);\n\n    /**\n     * short block tuning\n     */\n    this.attackthre = 0.;\n    this.attackthre_s = 0.;\n}\n\n\n\n\nLameInternalFlags.MFSIZE = (3 * 1152 + Encoder.ENCDELAY - Encoder.MDCTDELAY);\nLameInternalFlags.MAX_HEADER_BUF = 256;\nLameInternalFlags.MAX_BITS_PER_CHANNEL = 4095;\nLameInternalFlags.MAX_BITS_PER_GRANULE = 7680;\nLameInternalFlags.BPC = 320;\n\nfunction LameInternalFlags() {\n    var MAX_HEADER_LEN = 40;\n\n\n    /********************************************************************\n     * internal variables NOT set by calling program, and should not be *\n     * modified by the calling program *\n     ********************************************************************/\n\n    /**\n     * Some remarks to the Class_ID field: The Class ID is an Identifier for a\n     * pointer to this struct. It is very unlikely that a pointer to\n     * lame_global_flags has the same 32 bits in it's structure (large and other\n     * special properties, for instance prime).\n     *\n     * To test that the structure is right and initialized, use: if ( gfc .\n     * Class_ID == LAME_ID ) ... Other remark: If you set a flag to 0 for uninit\n     * data and 1 for init data, the right test should be \"if (flag == 1)\" and\n     * NOT \"if (flag)\". Unintended modification of this element will be\n     * otherwise misinterpreted as an init.\n     */\n    this.Class_ID = 0;\n\n    this.lame_encode_frame_init = 0;\n    this.iteration_init_init = 0;\n    this.fill_buffer_resample_init = 0;\n\n    //public float mfbuf[][] = new float[2][MFSIZE];\n    this.mfbuf = new_float_n([2, LameInternalFlags.MFSIZE]);\n\n    /**\n     * granules per frame\n     */\n    this.mode_gr = 0;\n    /**\n     * number of channels in the input data stream (PCM or decoded PCM)\n     */\n    this.channels_in = 0;\n    /**\n     * number of channels in the output data stream (not used for decoding)\n     */\n    this.channels_out = 0;\n    /**\n     * input_samp_rate/output_samp_rate\n     */\n        //public double resample_ratio;\n    this.resample_ratio = 0.;\n\n    this.mf_samples_to_encode = 0;\n    this.mf_size = 0;\n    /**\n     * min bitrate index\n     */\n    this.VBR_min_bitrate = 0;\n    /**\n     * max bitrate index\n     */\n    this.VBR_max_bitrate = 0;\n    this.bitrate_index = 0;\n    this.samplerate_index = 0;\n    this.mode_ext = 0;\n\n    /* lowpass and highpass filter control */\n    /**\n     * normalized frequency bounds of passband\n     */\n    this.lowpass1 = 0.;\n    this.lowpass2 = 0.;\n    /**\n     * normalized frequency bounds of passband\n     */\n    this.highpass1 = 0.;\n    this.highpass2 = 0.;\n\n    /**\n     * 0 = none 1 = ISO AAC model 2 = allow scalefac_select=1\n     */\n    this.noise_shaping = 0;\n\n    /**\n     * 0 = ISO model: amplify all distorted bands<BR>\n     * 1 = amplify within 50% of max (on db scale)<BR>\n     * 2 = amplify only most distorted band<BR>\n     * 3 = method 1 and refine with method 2<BR>\n     */\n    this.noise_shaping_amp = 0;\n    /**\n     * 0 = no substep<BR>\n     * 1 = use substep shaping at last step(VBR only)<BR>\n     * (not implemented yet)<BR>\n     * 2 = use substep inside loop<BR>\n     * 3 = use substep inside loop and last step<BR>\n     */\n    this.substep_shaping = 0;\n\n    /**\n     * 1 = gpsycho. 0 = none\n     */\n    this.psymodel = 0;\n    /**\n     * 0 = stop at over=0, all scalefacs amplified or<BR>\n     * a scalefac has reached max value<BR>\n     * 1 = stop when all scalefacs amplified or a scalefac has reached max value<BR>\n     * 2 = stop when all scalefacs amplified\n     */\n    this.noise_shaping_stop = 0;\n\n    /**\n     * 0 = no, 1 = yes\n     */\n    this.subblock_gain = 0;\n    /**\n     * 0 = no. 1=outside loop 2=inside loop(slow)\n     */\n    this.use_best_huffman = 0;\n\n    /**\n     * 0 = stop early after 0 distortion found. 1 = full search\n     */\n    this.full_outer_loop = 0;\n\n    //public IIISideInfo l3_side = new IIISideInfo();\n    this.l3_side = new IIISideInfo();\n    this.ms_ratio = new_float(2);\n\n    /* used for padding */\n    /**\n     * padding for the current frame?\n     */\n    this.padding = 0;\n    this.frac_SpF = 0;\n    this.slot_lag = 0;\n\n    /**\n     * optional ID3 tags\n     */\n        //public ID3TagSpec tag_spec;\n    this.tag_spec = null;\n    this.nMusicCRC = 0;\n\n    /* variables used by Quantize */\n    //public int OldValue[] = new int[2];\n    this.OldValue = new_int(2);\n    //public int CurrentStep[] = new int[2];\n    this.CurrentStep = new_int(2);\n\n    this.masking_lower = 0.;\n    //public int bv_scf[] = new int[576];\n    this.bv_scf = new_int(576);\n    //public int pseudohalf[] = new int[L3Side.SFBMAX];\n    this.pseudohalf = new_int(L3Side.SFBMAX);\n\n    /**\n     * will be set in lame_init_params\n     */\n    this.sfb21_extra = false;\n\n    /* BPC = maximum number of filter convolution windows to precompute */\n    //public float[][] inbuf_old = new float[2][];\n    this.inbuf_old = new Array(2);\n    //public float[][] blackfilt = new float[2 * BPC + 1][];\n    this.blackfilt = new Array(2 * LameInternalFlags.BPC + 1);\n    //public double itime[] = new double[2];\n    this.itime = new_double(2);\n    this.sideinfo_len = 0;\n\n    /* variables for newmdct.c */\n    //public float sb_sample[][][][] = new float[2][2][18][Encoder.SBLIMIT];\n    this.sb_sample = new_float_n([2, 2, 18, Encoder.SBLIMIT]);\n    this.amp_filter = new_float(32);\n\n    /* variables for BitStream */\n\n    /**\n     * <PRE>\n     * mpeg1: buffer=511 bytes  smallest frame: 96-38(sideinfo)=58\n     * max number of frames in reservoir:  8\n     * mpeg2: buffer=255 bytes.  smallest frame: 24-23bytes=1\n     * with VBR, if you are encoding all silence, it is possible to\n     * have 8kbs/24khz frames with 1byte of data each, which means we need\n     * to buffer up to 255 headers!\n     * </PRE>\n     */\n    /**\n     * also, max_header_buf has to be a power of two\n     */\n    /**\n     * max size of header is 38\n     */\n\n    function Header() {\n        this.write_timing = 0;\n        this.ptr = 0;\n        //public byte buf[] = new byte[MAX_HEADER_LEN];\n        this.buf = new_byte(MAX_HEADER_LEN);\n    }\n\n    this.header = new Array(LameInternalFlags.MAX_HEADER_BUF);\n\n    this.h_ptr = 0;\n    this.w_ptr = 0;\n    this.ancillary_flag = 0;\n\n    /* variables for Reservoir */\n    /**\n     * in bits\n     */\n    this.ResvSize = 0;\n    /**\n     * in bits\n     */\n    this.ResvMax = 0;\n\n    //public ScaleFac scalefac_band = new ScaleFac();\n    this.scalefac_band = new ScaleFac();\n\n    /* daa from PsyModel */\n    /* The static variables \"r\", \"phi_sav\", \"new\", \"old\" and \"oldest\" have */\n    /* to be remembered for the unpredictability measure. For \"r\" and */\n    /* \"phi_sav\", the first index from the left is the channel select and */\n    /* the second index is the \"age\" of the data. */\n    this.minval_l = new_float(Encoder.CBANDS);\n    this.minval_s = new_float(Encoder.CBANDS);\n    this.nb_1 = new_float_n([4, Encoder.CBANDS]);\n    this.nb_2 = new_float_n([4, Encoder.CBANDS]);\n    this.nb_s1 = new_float_n([4, Encoder.CBANDS]);\n    this.nb_s2 = new_float_n([4, Encoder.CBANDS]);\n    this.s3_ss = null;\n    this.s3_ll = null;\n    this.decay = 0.;\n\n    //public III_psy_xmin[] thm = new III_psy_xmin[4];\n    //public III_psy_xmin[] en = new III_psy_xmin[4];\n    this.thm = new Array(4);\n    this.en = new Array(4);\n\n    /**\n     * fft and energy calculation\n     */\n    this.tot_ener = new_float(4);\n\n    /* loudness calculation (for adaptive threshold of hearing) */\n    /**\n     * loudness^2 approx. per granule and channel\n     */\n    this.loudness_sq = new_float_n([2, 2]);\n    /**\n     * account for granule delay of L3psycho_anal\n     */\n    this.loudness_sq_save = new_float(2);\n\n    /**\n     * Scale Factor Bands\n     */\n    this.mld_l = new_float(Encoder.SBMAX_l);\n    this.mld_s = new_float(Encoder.SBMAX_s);\n    this.bm_l = new_int(Encoder.SBMAX_l);\n    this.bo_l = new_int(Encoder.SBMAX_l);\n    this.bm_s = new_int(Encoder.SBMAX_s);\n    this.bo_s = new_int(Encoder.SBMAX_s);\n    this.npart_l = 0;\n    this.npart_s = 0;\n\n    this.s3ind = new_int_n([Encoder.CBANDS, 2]);\n    this.s3ind_s = new_int_n([Encoder.CBANDS, 2]);\n\n    this.numlines_s = new_int(Encoder.CBANDS);\n    this.numlines_l = new_int(Encoder.CBANDS);\n    this.rnumlines_l = new_float(Encoder.CBANDS);\n    this.mld_cb_l = new_float(Encoder.CBANDS);\n    this.mld_cb_s = new_float(Encoder.CBANDS);\n    this.numlines_s_num1 = 0;\n    this.numlines_l_num1 = 0;\n\n    /* ratios */\n    this.pe = new_float(4);\n    this.ms_ratio_s_old = 0.;\n    this.ms_ratio_l_old = 0.;\n    this.ms_ener_ratio_old = 0.;\n\n    /**\n     * block type\n     */\n    this.blocktype_old = new_int(2);\n\n    /**\n     * variables used for --nspsytune\n     */\n    this.nsPsy = new NsPsy();\n\n    /**\n     * used for Xing VBR header\n     */\n    this.VBR_seek_table = new VBRSeekInfo();\n\n    /**\n     * all ATH related stuff\n     */\n        //public ATH ATH;\n    this.ATH = null;\n\n    this.PSY = null;\n\n    this.nogap_total = 0;\n    this.nogap_current = 0;\n\n    /* ReplayGain */\n    this.decode_on_the_fly = true;\n    this.findReplayGain = true;\n    this.findPeakSample = true;\n    this.PeakSample = 0.;\n    this.RadioGain = 0;\n    this.AudiophileGain = 0;\n    //public ReplayGain rgdata;\n    this.rgdata = null;\n\n    /**\n     * gain change required for preventing clipping\n     */\n    this.noclipGainChange = 0;\n    /**\n     * user-specified scale factor required for preventing clipping\n     */\n    this.noclipScale = 0.;\n\n    /* simple statistics */\n    this.bitrate_stereoMode_Hist = new_int_n([16, 4 + 1]);\n    /**\n     * norm/start/short/stop/mixed(short)/sum\n     */\n    this.bitrate_blockType_Hist = new_int_n([16, 4 + 1 + 1]);\n\n    //public PlottingData pinfo;\n    //public MPGLib.mpstr_tag hip;\n    this.pinfo = null;\n    this.hip = null;\n\n    this.in_buffer_nsamples = 0;\n    //public float[] in_buffer_0;\n    //public float[] in_buffer_1;\n    this.in_buffer_0 = null;\n    this.in_buffer_1 = null;\n\n    //public IIterationLoop iteration_loop;\n    this.iteration_loop = null;\n\n    for (var i = 0; i < this.en.length; i++) {\n        this.en[i] = new III_psy_xmin();\n    }\n    for (var i = 0; i < this.thm.length; i++) {\n        this.thm[i] = new III_psy_xmin();\n    }\n    for (var i = 0; i < this.header.length; i++) {\n        this.header[i] = new Header();\n    }\n\n}\n\n\n\nfunction FFT() {\n\n    var window = new_float(Encoder.BLKSIZE);\n    var window_s = new_float(Encoder.BLKSIZE_s / 2);\n\n    var costab = [\n        9.238795325112867e-01, 3.826834323650898e-01,\n        9.951847266721969e-01, 9.801714032956060e-02,\n        9.996988186962042e-01, 2.454122852291229e-02,\n        9.999811752826011e-01, 6.135884649154475e-03\n    ];\n\n    function fht(fz, fzPos, n) {\n        var tri = 0;\n        var k4;\n        var fi;\n        var gi;\n\n        n <<= 1;\n        /* to get BLKSIZE, because of 3DNow! ASM routine */\n        var fn = fzPos + n;\n        k4 = 4;\n        do {\n            var s1, c1;\n            var i, k1, k2, k3, kx;\n            kx = k4 >> 1;\n            k1 = k4;\n            k2 = k4 << 1;\n            k3 = k2 + k1;\n            k4 = k2 << 1;\n            fi = fzPos;\n            gi = fi + kx;\n            do {\n                var f0, f1, f2, f3;\n                f1 = fz[fi + 0] - fz[fi + k1];\n                f0 = fz[fi + 0] + fz[fi + k1];\n                f3 = fz[fi + k2] - fz[fi + k3];\n                f2 = fz[fi + k2] + fz[fi + k3];\n                fz[fi + k2] = f0 - f2;\n                fz[fi + 0] = f0 + f2;\n                fz[fi + k3] = f1 - f3;\n                fz[fi + k1] = f1 + f3;\n                f1 = fz[gi + 0] - fz[gi + k1];\n                f0 = fz[gi + 0] + fz[gi + k1];\n                f3 = (Util.SQRT2 * fz[gi + k3]);\n                f2 = (Util.SQRT2 * fz[gi + k2]);\n                fz[gi + k2] = f0 - f2;\n                fz[gi + 0] = f0 + f2;\n                fz[gi + k3] = f1 - f3;\n                fz[gi + k1] = f1 + f3;\n                gi += k4;\n                fi += k4;\n            } while (fi < fn);\n            c1 = costab[tri + 0];\n            s1 = costab[tri + 1];\n            for (i = 1; i < kx; i++) {\n                var c2, s2;\n                c2 = 1 - (2 * s1) * s1;\n                s2 = (2 * s1) * c1;\n                fi = fzPos + i;\n                gi = fzPos + k1 - i;\n                do {\n                    var a, b, g0, f0, f1, g1, f2, g2, f3, g3;\n                    b = s2 * fz[fi + k1] - c2 * fz[gi + k1];\n                    a = c2 * fz[fi + k1] + s2 * fz[gi + k1];\n                    f1 = fz[fi + 0] - a;\n                    f0 = fz[fi + 0] + a;\n                    g1 = fz[gi + 0] - b;\n                    g0 = fz[gi + 0] + b;\n                    b = s2 * fz[fi + k3] - c2 * fz[gi + k3];\n                    a = c2 * fz[fi + k3] + s2 * fz[gi + k3];\n                    f3 = fz[fi + k2] - a;\n                    f2 = fz[fi + k2] + a;\n                    g3 = fz[gi + k2] - b;\n                    g2 = fz[gi + k2] + b;\n                    b = s1 * f2 - c1 * g3;\n                    a = c1 * f2 + s1 * g3;\n                    fz[fi + k2] = f0 - a;\n                    fz[fi + 0] = f0 + a;\n                    fz[gi + k3] = g1 - b;\n                    fz[gi + k1] = g1 + b;\n                    b = c1 * g2 - s1 * f3;\n                    a = s1 * g2 + c1 * f3;\n                    fz[gi + k2] = g0 - a;\n                    fz[gi + 0] = g0 + a;\n                    fz[fi + k3] = f1 - b;\n                    fz[fi + k1] = f1 + b;\n                    gi += k4;\n                    fi += k4;\n                } while (fi < fn);\n                c2 = c1;\n                c1 = c2 * costab[tri + 0] - s1 * costab[tri + 1];\n                s1 = c2 * costab[tri + 1] + s1 * costab[tri + 0];\n            }\n            tri += 2;\n        } while (k4 < n);\n    }\n\n    var rv_tbl = [0x00, 0x80, 0x40,\n        0xc0, 0x20, 0xa0, 0x60, 0xe0, 0x10,\n        0x90, 0x50, 0xd0, 0x30, 0xb0, 0x70,\n        0xf0, 0x08, 0x88, 0x48, 0xc8, 0x28,\n        0xa8, 0x68, 0xe8, 0x18, 0x98, 0x58,\n        0xd8, 0x38, 0xb8, 0x78, 0xf8, 0x04,\n        0x84, 0x44, 0xc4, 0x24, 0xa4, 0x64,\n        0xe4, 0x14, 0x94, 0x54, 0xd4, 0x34,\n        0xb4, 0x74, 0xf4, 0x0c, 0x8c, 0x4c,\n        0xcc, 0x2c, 0xac, 0x6c, 0xec, 0x1c,\n        0x9c, 0x5c, 0xdc, 0x3c, 0xbc, 0x7c,\n        0xfc, 0x02, 0x82, 0x42, 0xc2, 0x22,\n        0xa2, 0x62, 0xe2, 0x12, 0x92, 0x52,\n        0xd2, 0x32, 0xb2, 0x72, 0xf2, 0x0a,\n        0x8a, 0x4a, 0xca, 0x2a, 0xaa, 0x6a,\n        0xea, 0x1a, 0x9a, 0x5a, 0xda, 0x3a,\n        0xba, 0x7a, 0xfa, 0x06, 0x86, 0x46,\n        0xc6, 0x26, 0xa6, 0x66, 0xe6, 0x16,\n        0x96, 0x56, 0xd6, 0x36, 0xb6, 0x76,\n        0xf6, 0x0e, 0x8e, 0x4e, 0xce, 0x2e,\n        0xae, 0x6e, 0xee, 0x1e, 0x9e, 0x5e,\n        0xde, 0x3e, 0xbe, 0x7e, 0xfe];\n\n    this.fft_short = function (gfc, x_real, chn, buffer, bufPos) {\n        for (var b = 0; b < 3; b++) {\n            var x = Encoder.BLKSIZE_s / 2;\n            var k = 0xffff & ((576 / 3) * (b + 1));\n            var j = Encoder.BLKSIZE_s / 8 - 1;\n            do {\n                var f0, f1, f2, f3, w;\n                var i = rv_tbl[j << 2] & 0xff;\n\n                f0 = window_s[i] * buffer[chn][bufPos + i + k];\n                w = window_s[0x7f - i] * buffer[chn][bufPos + i + k + 0x80];\n                f1 = f0 - w;\n                f0 = f0 + w;\n                f2 = window_s[i + 0x40] * buffer[chn][bufPos + i + k + 0x40];\n                w = window_s[0x3f - i] * buffer[chn][bufPos + i + k + 0xc0];\n                f3 = f2 - w;\n                f2 = f2 + w;\n\n                x -= 4;\n                x_real[b][x + 0] = f0 + f2;\n                x_real[b][x + 2] = f0 - f2;\n                x_real[b][x + 1] = f1 + f3;\n                x_real[b][x + 3] = f1 - f3;\n\n                f0 = window_s[i + 0x01] * buffer[chn][bufPos + i + k + 0x01];\n                w = window_s[0x7e - i] * buffer[chn][bufPos + i + k + 0x81];\n                f1 = f0 - w;\n                f0 = f0 + w;\n                f2 = window_s[i + 0x41] * buffer[chn][bufPos + i + k + 0x41];\n                w = window_s[0x3e - i] * buffer[chn][bufPos + i + k + 0xc1];\n                f3 = f2 - w;\n                f2 = f2 + w;\n\n                x_real[b][x + Encoder.BLKSIZE_s / 2 + 0] = f0 + f2;\n                x_real[b][x + Encoder.BLKSIZE_s / 2 + 2] = f0 - f2;\n                x_real[b][x + Encoder.BLKSIZE_s / 2 + 1] = f1 + f3;\n                x_real[b][x + Encoder.BLKSIZE_s / 2 + 3] = f1 - f3;\n            } while (--j >= 0);\n\n            fht(x_real[b], x, Encoder.BLKSIZE_s / 2);\n            /* BLKSIZE_s/2 because of 3DNow! ASM routine */\n            /* BLKSIZE/2 because of 3DNow! ASM routine */\n        }\n    }\n\n    this.fft_long = function (gfc, y, chn, buffer, bufPos) {\n        var jj = Encoder.BLKSIZE / 8 - 1;\n        var x = Encoder.BLKSIZE / 2;\n\n        do {\n            var f0, f1, f2, f3, w;\n            var i = rv_tbl[jj] & 0xff;\n            f0 = window[i] * buffer[chn][bufPos + i];\n            w = window[i + 0x200] * buffer[chn][bufPos + i + 0x200];\n            f1 = f0 - w;\n            f0 = f0 + w;\n            f2 = window[i + 0x100] * buffer[chn][bufPos + i + 0x100];\n            w = window[i + 0x300] * buffer[chn][bufPos + i + 0x300];\n            f3 = f2 - w;\n            f2 = f2 + w;\n\n            x -= 4;\n            y[x + 0] = f0 + f2;\n            y[x + 2] = f0 - f2;\n            y[x + 1] = f1 + f3;\n            y[x + 3] = f1 - f3;\n\n            f0 = window[i + 0x001] * buffer[chn][bufPos + i + 0x001];\n            w = window[i + 0x201] * buffer[chn][bufPos + i + 0x201];\n            f1 = f0 - w;\n            f0 = f0 + w;\n            f2 = window[i + 0x101] * buffer[chn][bufPos + i + 0x101];\n            w = window[i + 0x301] * buffer[chn][bufPos + i + 0x301];\n            f3 = f2 - w;\n            f2 = f2 + w;\n\n            y[x + Encoder.BLKSIZE / 2 + 0] = f0 + f2;\n            y[x + Encoder.BLKSIZE / 2 + 2] = f0 - f2;\n            y[x + Encoder.BLKSIZE / 2 + 1] = f1 + f3;\n            y[x + Encoder.BLKSIZE / 2 + 3] = f1 - f3;\n        } while (--jj >= 0);\n\n        fht(y, x, Encoder.BLKSIZE / 2);\n        /* BLKSIZE/2 because of 3DNow! ASM routine */\n    }\n\n    this.init_fft = function (gfc) {\n        /* The type of window used here will make no real difference, but */\n        /*\n         * in the interest of merging nspsytune stuff - switch to blackman\n         * window\n         */\n        for (var i = 0; i < Encoder.BLKSIZE; i++)\n            /* blackman window */\n            window[i] = (0.42 - 0.5 * Math.cos(2 * Math.PI * (i + .5)\n                / Encoder.BLKSIZE) + 0.08 * Math.cos(4 * Math.PI * (i + .5)\n                / Encoder.BLKSIZE));\n\n        for (var i = 0; i < Encoder.BLKSIZE_s / 2; i++)\n            window_s[i] = (0.5 * (1.0 - Math.cos(2.0 * Math.PI\n                * (i + 0.5) / Encoder.BLKSIZE_s)));\n\n    }\n\n}\n\n/*\n *      psymodel.c\n *\n *      Copyright (c) 1999-2000 Mark Taylor\n *      Copyright (c) 2001-2002 Naoki Shibata\n *      Copyright (c) 2000-2003 Takehiro Tominaga\n *      Copyright (c) 2000-2008 Robert Hegemann\n *      Copyright (c) 2000-2005 Gabriel Bouvigne\n *      Copyright (c) 2000-2005 Alexander Leidinger\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n\n/* $Id: PsyModel.java,v 1.27 2011/05/24 20:48:06 kenchis Exp $ */\n\n\n/*\n PSYCHO ACOUSTICS\n\n\n This routine computes the psycho acoustics, delayed by one granule.\n\n Input: buffer of PCM data (1024 samples).\n\n This window should be centered over the 576 sample granule window.\n The routine will compute the psycho acoustics for\n this granule, but return the psycho acoustics computed\n for the *previous* granule.  This is because the block\n type of the previous granule can only be determined\n after we have computed the psycho acoustics for the following\n granule.\n\n Output:  maskings and energies for each scalefactor band.\n block type, PE, and some correlation measures.\n The PE is used by CBR modes to determine if extra bits\n from the bit reservoir should be used.  The correlation\n measures are used to determine mid/side or regular stereo.\n */\n/*\n Notation:\n\n barks:  a non-linear frequency scale.  Mapping from frequency to\n barks is given by freq2bark()\n\n scalefactor bands: The spectrum (frequencies) are broken into\n SBMAX \"scalefactor bands\".  Thes bands\n are determined by the MPEG ISO spec.  In\n the noise shaping/quantization code, we allocate\n bits among the partition bands to achieve the\n best possible quality\n\n partition bands:   The spectrum is also broken into about\n 64 \"partition bands\".  Each partition\n band is about .34 barks wide.  There are about 2-5\n partition bands for each scalefactor band.\n\n LAME computes all psycho acoustic information for each partition\n band.  Then at the end of the computations, this information\n is mapped to scalefactor bands.  The energy in each scalefactor\n band is taken as the sum of the energy in all partition bands\n which overlap the scalefactor band.  The maskings can be computed\n in the same way (and thus represent the average masking in that band)\n or by taking the minmum value multiplied by the number of\n partition bands used (which represents a minimum masking in that band).\n */\n/*\n The general outline is as follows:\n\n 1. compute the energy in each partition band\n 2. compute the tonality in each partition band\n 3. compute the strength of each partion band \"masker\"\n 4. compute the masking (via the spreading function applied to each masker)\n 5. Modifications for mid/side masking.\n\n Each partition band is considiered a \"masker\".  The strength\n of the i'th masker in band j is given by:\n\n s3(bark(i)-bark(j))*strength(i)\n\n The strength of the masker is a function of the energy and tonality.\n The more tonal, the less masking.  LAME uses a simple linear formula\n (controlled by NMT and TMN) which says the strength is given by the\n energy divided by a linear function of the tonality.\n */\n/*\n s3() is the \"spreading function\".  It is given by a formula\n determined via listening tests.\n\n The total masking in the j'th partition band is the sum over\n all maskings i.  It is thus given by the convolution of\n the strength with s3(), the \"spreading function.\"\n\n masking(j) = sum_over_i  s3(i-j)*strength(i)  = s3 o strength\n\n where \"o\" = convolution operator.  s3 is given by a formula determined\n via listening tests.  It is normalized so that s3 o 1 = 1.\n\n Note: instead of a simple convolution, LAME also has the\n option of using \"additive masking\"\n\n The most critical part is step 2, computing the tonality of each\n partition band.  LAME has two tonality estimators.  The first\n is based on the ISO spec, and measures how predictiable the\n signal is over time.  The more predictable, the more tonal.\n The second measure is based on looking at the spectrum of\n a single granule.  The more peaky the spectrum, the more\n tonal.  By most indications, the latter approach is better.\n\n Finally, in step 5, the maskings for the mid and side\n channel are possibly increased.  Under certain circumstances,\n noise in the mid & side channels is assumed to also\n be masked by strong maskers in the L or R channels.\n\n\n Other data computed by the psy-model:\n\n ms_ratio        side-channel / mid-channel masking ratio (for previous granule)\n ms_ratio_next   side-channel / mid-channel masking ratio for this granule\n\n percep_entropy[2]     L and R values (prev granule) of PE - A measure of how\n much pre-echo is in the previous granule\n percep_entropy_MS[2]  mid and side channel values (prev granule) of percep_entropy\n energy[4]             L,R,M,S energy in each channel, prev granule\n blocktype_d[2]        block type to use for previous granule\n */\n//package mp3;\n\n//import java.util.Arrays;\n\n\nfunction PsyModel() {\n\n    var fft = new FFT();\n\n    var LOG10 = 2.30258509299404568402;\n\n    var rpelev = 2;\n    var rpelev2 = 16;\n    var rpelev_s = 2;\n    var rpelev2_s = 16;\n\n    /* size of each partition band, in barks: */\n    var DELBARK = .34;\n\n    /* tuned for output level (sensitive to energy scale) */\n    var VO_SCALE = (1. / (14752 * 14752) / (Encoder.BLKSIZE / 2));\n\n    var temporalmask_sustain_sec = 0.01;\n\n    var NS_PREECHO_ATT0 = 0.8;\n    var NS_PREECHO_ATT1 = 0.6;\n    var NS_PREECHO_ATT2 = 0.3;\n\n    var NS_MSFIX = 3.5;\n\n    var NSATTACKTHRE = 4.4;\n    var NSATTACKTHRE_S = 25;\n\n    var NSFIRLEN = 21;\n\n    /* size of each partition band, in barks: */\n    var LN_TO_LOG10 = 0.2302585093;\n\n    function NON_LINEAR_SCALE_ENERGY(x) {\n        return x;\n    }\n\n    /**\n     * <PRE>\n     *       L3psycho_anal.  Compute psycho acoustics.\n     *\n     *       Data returned to the calling program must be delayed by one\n     *       granule.\n     *\n     *       This is done in two places.\n     *       If we do not need to know the blocktype, the copying\n     *       can be done here at the top of the program: we copy the data for\n     *       the last granule (computed during the last call) before it is\n     *       overwritten with the new data.  It looks like this:\n     *\n     *       0. static psymodel_data\n     *       1. calling_program_data = psymodel_data\n     *       2. compute psymodel_data\n     *\n     *       For data which needs to know the blocktype, the copying must be\n     *       done at the end of this loop, and the old values must be saved:\n     *\n     *       0. static psymodel_data_old\n     *       1. compute psymodel_data\n     *       2. compute possible block type of this granule\n     *       3. compute final block type of previous granule based on #2.\n     *       4. calling_program_data = psymodel_data_old\n     *       5. psymodel_data_old = psymodel_data\n     *     psycho_loudness_approx\n     *       jd - 2001 mar 12\n     *    in:  energy   - BLKSIZE/2 elements of frequency magnitudes ^ 2\n     *         gfp      - uses out_samplerate, ATHtype (also needed for ATHformula)\n     *    returns: loudness^2 approximation, a positive value roughly tuned for a value\n     *             of 1.0 for signals near clipping.\n     *    notes:   When calibrated, feeding this function binary white noise at sample\n     *             values +32767 or -32768 should return values that approach 3.\n     *             ATHformula is used to approximate an equal loudness curve.\n     *    future:  Data indicates that the shape of the equal loudness curve varies\n     *             with intensity.  This function might be improved by using an equal\n     *             loudness curve shaped for typical playback levels (instead of the\n     *             ATH, that is shaped for the threshold).  A flexible realization might\n     *             simply bend the existing ATH curve to achieve the desired shape.\n     *             However, the potential gain may not be enough to justify an effort.\n     * </PRE>\n     */\n    function psycho_loudness_approx(energy, gfc) {\n        var loudness_power = 0.0;\n        /* apply weights to power in freq. bands */\n        for (var i = 0; i < Encoder.BLKSIZE / 2; ++i)\n            loudness_power += energy[i] * gfc.ATH.eql_w[i];\n        loudness_power *= VO_SCALE;\n\n        return loudness_power;\n    }\n\n    function compute_ffts(gfp, fftenergy, fftenergy_s, wsamp_l, wsamp_lPos, wsamp_s, wsamp_sPos, gr_out, chn, buffer, bufPos) {\n        var gfc = gfp.internal_flags;\n        if (chn < 2) {\n            fft.fft_long(gfc, wsamp_l[wsamp_lPos], chn, buffer, bufPos);\n            fft.fft_short(gfc, wsamp_s[wsamp_sPos], chn, buffer, bufPos);\n        }\n        /* FFT data for mid and side channel is derived from L & R */\n        else if (chn == 2) {\n            for (var j = Encoder.BLKSIZE - 1; j >= 0; --j) {\n                var l = wsamp_l[wsamp_lPos + 0][j];\n                var r = wsamp_l[wsamp_lPos + 1][j];\n                wsamp_l[wsamp_lPos + 0][j] = (l + r) * Util.SQRT2 * 0.5;\n                wsamp_l[wsamp_lPos + 1][j] = (l - r) * Util.SQRT2 * 0.5;\n            }\n            for (var b = 2; b >= 0; --b) {\n                for (var j = Encoder.BLKSIZE_s - 1; j >= 0; --j) {\n                    var l = wsamp_s[wsamp_sPos + 0][b][j];\n                    var r = wsamp_s[wsamp_sPos + 1][b][j];\n                    wsamp_s[wsamp_sPos + 0][b][j] = (l + r) * Util.SQRT2 * 0.5;\n                    wsamp_s[wsamp_sPos + 1][b][j] = (l - r) * Util.SQRT2 * 0.5;\n                }\n            }\n        }\n\n        /*********************************************************************\n         * compute energies\n         *********************************************************************/\n        fftenergy[0] = NON_LINEAR_SCALE_ENERGY(wsamp_l[wsamp_lPos + 0][0]);\n        fftenergy[0] *= fftenergy[0];\n\n        for (var j = Encoder.BLKSIZE / 2 - 1; j >= 0; --j) {\n            var re = (wsamp_l[wsamp_lPos + 0])[Encoder.BLKSIZE / 2 - j];\n            var im = (wsamp_l[wsamp_lPos + 0])[Encoder.BLKSIZE / 2 + j];\n            fftenergy[Encoder.BLKSIZE / 2 - j] = NON_LINEAR_SCALE_ENERGY((re\n                * re + im * im) * 0.5);\n        }\n        for (var b = 2; b >= 0; --b) {\n            fftenergy_s[b][0] = (wsamp_s[wsamp_sPos + 0])[b][0];\n            fftenergy_s[b][0] *= fftenergy_s[b][0];\n            for (var j = Encoder.BLKSIZE_s / 2 - 1; j >= 0; --j) {\n                var re = (wsamp_s[wsamp_sPos + 0])[b][Encoder.BLKSIZE_s\n                / 2 - j];\n                var im = (wsamp_s[wsamp_sPos + 0])[b][Encoder.BLKSIZE_s\n                / 2 + j];\n                fftenergy_s[b][Encoder.BLKSIZE_s / 2 - j] = NON_LINEAR_SCALE_ENERGY((re\n                    * re + im * im) * 0.5);\n            }\n        }\n        /* total energy */\n        {\n            var totalenergy = 0.0;\n            for (var j = 11; j < Encoder.HBLKSIZE; j++)\n                totalenergy += fftenergy[j];\n\n            gfc.tot_ener[chn] = totalenergy;\n        }\n\n        if (gfp.analysis) {\n            for (var j = 0; j < Encoder.HBLKSIZE; j++) {\n                gfc.pinfo.energy[gr_out][chn][j] = gfc.pinfo.energy_save[chn][j];\n                gfc.pinfo.energy_save[chn][j] = fftenergy[j];\n            }\n            gfc.pinfo.pe[gr_out][chn] = gfc.pe[chn];\n        }\n\n        /*********************************************************************\n         * compute loudness approximation (used for ATH auto-level adjustment)\n         *********************************************************************/\n        if (gfp.athaa_loudapprox == 2 && chn < 2) {\n            // no loudness for mid/side ch\n            gfc.loudness_sq[gr_out][chn] = gfc.loudness_sq_save[chn];\n            gfc.loudness_sq_save[chn] = psycho_loudness_approx(fftenergy, gfc);\n        }\n    }\n\n    /* mask_add optimization */\n    /* init the limit values used to avoid computing log in mask_add when it is not necessary */\n\n    /**\n     * <PRE>\n     *  For example, with i = 10*log10(m2/m1)/10*16         (= log10(m2/m1)*16)\n     *\n     * abs(i)>8 is equivalent (as i is an integer) to\n     * abs(i)>=9\n     * i>=9 || i<=-9\n     * equivalent to (as i is the biggest integer smaller than log10(m2/m1)*16\n     * or the smallest integer bigger than log10(m2/m1)*16 depending on the sign of log10(m2/m1)*16)\n     * log10(m2/m1)>=9/16 || log10(m2/m1)<=-9/16\n     * exp10 is strictly increasing thus this is equivalent to\n     * m2/m1 >= 10^(9/16) || m2/m1<=10^(-9/16) which are comparisons to constants\n     * </PRE>\n     */\n\n    /**\n     * as in if(i>8)\n     */\n    var I1LIMIT = 8;\n    /**\n     * as in if(i>24) . changed 23\n     */\n    var I2LIMIT = 23;\n    /**\n     * as in if(m<15)\n     */\n    var MLIMIT = 15;\n\n    var ma_max_i1;\n    var ma_max_i2;\n    var ma_max_m;\n\n    /**\n     * This is the masking table:<BR>\n     * According to tonality, values are going from 0dB (TMN) to 9.3dB (NMT).<BR>\n     * After additive masking computation, 8dB are added, so final values are\n     * going from 8dB to 17.3dB\n     *\n     * pow(10, -0.0..-0.6)\n     */\n    var tab = [1.0, 0.79433, 0.63096, 0.63096,\n        0.63096, 0.63096, 0.63096, 0.25119, 0.11749];\n\n    function init_mask_add_max_values() {\n        ma_max_i1 = Math.pow(10, (I1LIMIT + 1) / 16.0);\n        ma_max_i2 = Math.pow(10, (I2LIMIT + 1) / 16.0);\n        ma_max_m = Math.pow(10, (MLIMIT) / 10.0);\n    }\n\n    var table1 = [3.3246 * 3.3246,\n        3.23837 * 3.23837, 3.15437 * 3.15437, 3.00412 * 3.00412,\n        2.86103 * 2.86103, 2.65407 * 2.65407, 2.46209 * 2.46209,\n        2.284 * 2.284, 2.11879 * 2.11879, 1.96552 * 1.96552,\n        1.82335 * 1.82335, 1.69146 * 1.69146, 1.56911 * 1.56911,\n        1.46658 * 1.46658, 1.37074 * 1.37074, 1.31036 * 1.31036,\n        1.25264 * 1.25264, 1.20648 * 1.20648, 1.16203 * 1.16203,\n        1.12765 * 1.12765, 1.09428 * 1.09428, 1.0659 * 1.0659,\n        1.03826 * 1.03826, 1.01895 * 1.01895, 1];\n\n    var table2 = [1.33352 * 1.33352,\n        1.35879 * 1.35879, 1.38454 * 1.38454, 1.39497 * 1.39497,\n        1.40548 * 1.40548, 1.3537 * 1.3537, 1.30382 * 1.30382,\n        1.22321 * 1.22321, 1.14758 * 1.14758, 1];\n\n    var table3 = [2.35364 * 2.35364,\n        2.29259 * 2.29259, 2.23313 * 2.23313, 2.12675 * 2.12675,\n        2.02545 * 2.02545, 1.87894 * 1.87894, 1.74303 * 1.74303,\n        1.61695 * 1.61695, 1.49999 * 1.49999, 1.39148 * 1.39148,\n        1.29083 * 1.29083, 1.19746 * 1.19746, 1.11084 * 1.11084,\n        1.03826 * 1.03826];\n\n    /**\n     * addition of simultaneous masking Naoki Shibata 2000/7\n     */\n    function mask_add(m1, m2, kk, b, gfc, shortblock) {\n        var ratio;\n\n        if (m2 > m1) {\n            if (m2 < (m1 * ma_max_i2))\n                ratio = m2 / m1;\n            else\n                return (m1 + m2);\n        } else {\n            if (m1 >= (m2 * ma_max_i2))\n                return (m1 + m2);\n            ratio = m1 / m2;\n        }\n\n        /* Should always be true, just checking */\n\n        m1 += m2;\n        //if (((long)(b + 3) & 0xffffffff) <= 3 + 3) {\n        if ((b + 3) <= 3 + 3) {\n            /* approximately, 1 bark = 3 partitions */\n            /* 65% of the cases */\n            /* originally 'if(i > 8)' */\n            if (ratio >= ma_max_i1) {\n                /* 43% of the total */\n                return m1;\n            }\n\n            /* 22% of the total */\n            var i = 0 | (Util.FAST_LOG10_X(ratio, 16.0));\n            return m1 * table2[i];\n        }\n\n        /**\n         * <PRE>\n         * m<15 equ log10((m1+m2)/gfc.ATH.cb[k])<1.5\n         * equ (m1+m2)/gfc.ATH.cb[k]<10^1.5\n         * equ (m1+m2)<10^1.5 * gfc.ATH.cb[k]\n         * </PRE>\n         */\n        var i = 0 | Util.FAST_LOG10_X(ratio, 16.0);\n        if (shortblock != 0) {\n            m2 = gfc.ATH.cb_s[kk] * gfc.ATH.adjust;\n        } else {\n            m2 = gfc.ATH.cb_l[kk] * gfc.ATH.adjust;\n        }\n        if (m1 < ma_max_m * m2) {\n            /* 3% of the total */\n            /* Originally if (m > 0) { */\n            if (m1 > m2) {\n                var f, r;\n\n                f = 1.0;\n                if (i <= 13)\n                    f = table3[i];\n\n                r = Util.FAST_LOG10_X(m1 / m2, 10.0 / 15.0);\n                return m1 * ((table1[i] - f) * r + f);\n            }\n\n            if (i > 13)\n                return m1;\n\n            return m1 * table3[i];\n        }\n\n        /* 10% of total */\n        return m1 * table1[i];\n    }\n\n    var table2_ = [1.33352 * 1.33352,\n        1.35879 * 1.35879, 1.38454 * 1.38454, 1.39497 * 1.39497,\n        1.40548 * 1.40548, 1.3537 * 1.3537, 1.30382 * 1.30382,\n        1.22321 * 1.22321, 1.14758 * 1.14758, 1];\n\n    /**\n     * addition of simultaneous masking Naoki Shibata 2000/7\n     */\n    function vbrpsy_mask_add(m1, m2, b) {\n        var ratio;\n\n        if (m1 < 0) {\n            m1 = 0;\n        }\n        if (m2 < 0) {\n            m2 = 0;\n        }\n        if (m1 <= 0) {\n            return m2;\n        }\n        if (m2 <= 0) {\n            return m1;\n        }\n        if (m2 > m1) {\n            ratio = m2 / m1;\n        } else {\n            ratio = m1 / m2;\n        }\n        if (-2 <= b && b <= 2) {\n            /* approximately, 1 bark = 3 partitions */\n            /* originally 'if(i > 8)' */\n            if (ratio >= ma_max_i1) {\n                return m1 + m2;\n            } else {\n                var i = 0 | (Util.FAST_LOG10_X(ratio, 16.0));\n                return (m1 + m2) * table2_[i];\n            }\n        }\n        if (ratio < ma_max_i2) {\n            return m1 + m2;\n        }\n        if (m1 < m2) {\n            m1 = m2;\n        }\n        return m1;\n    }\n\n    /**\n     * compute interchannel masking effects\n     */\n    function calc_interchannel_masking(gfp, ratio) {\n        var gfc = gfp.internal_flags;\n        if (gfc.channels_out > 1) {\n            for (var sb = 0; sb < Encoder.SBMAX_l; sb++) {\n                var l = gfc.thm[0].l[sb];\n                var r = gfc.thm[1].l[sb];\n                gfc.thm[0].l[sb] += r * ratio;\n                gfc.thm[1].l[sb] += l * ratio;\n            }\n            for (var sb = 0; sb < Encoder.SBMAX_s; sb++) {\n                for (var sblock = 0; sblock < 3; sblock++) {\n                    var l = gfc.thm[0].s[sb][sblock];\n                    var r = gfc.thm[1].s[sb][sblock];\n                    gfc.thm[0].s[sb][sblock] += r * ratio;\n                    gfc.thm[1].s[sb][sblock] += l * ratio;\n                }\n            }\n        }\n    }\n\n    /**\n     * compute M/S thresholds from Johnston & Ferreira 1992 ICASSP paper\n     */\n    function msfix1(gfc) {\n        for (var sb = 0; sb < Encoder.SBMAX_l; sb++) {\n            /* use this fix if L & R masking differs by 2db or less */\n            /* if db = 10*log10(x2/x1) < 2 */\n            /* if (x2 < 1.58*x1) { */\n            if (gfc.thm[0].l[sb] > 1.58 * gfc.thm[1].l[sb]\n                || gfc.thm[1].l[sb] > 1.58 * gfc.thm[0].l[sb])\n                continue;\n            var mld = gfc.mld_l[sb] * gfc.en[3].l[sb];\n            var rmid = Math.max(gfc.thm[2].l[sb],\n                Math.min(gfc.thm[3].l[sb], mld));\n\n            mld = gfc.mld_l[sb] * gfc.en[2].l[sb];\n            var rside = Math.max(gfc.thm[3].l[sb],\n                Math.min(gfc.thm[2].l[sb], mld));\n            gfc.thm[2].l[sb] = rmid;\n            gfc.thm[3].l[sb] = rside;\n        }\n\n        for (var sb = 0; sb < Encoder.SBMAX_s; sb++) {\n            for (var sblock = 0; sblock < 3; sblock++) {\n                if (gfc.thm[0].s[sb][sblock] > 1.58 * gfc.thm[1].s[sb][sblock]\n                    || gfc.thm[1].s[sb][sblock] > 1.58 * gfc.thm[0].s[sb][sblock])\n                    continue;\n                var mld = gfc.mld_s[sb] * gfc.en[3].s[sb][sblock];\n                var rmid = Math.max(gfc.thm[2].s[sb][sblock],\n                    Math.min(gfc.thm[3].s[sb][sblock], mld));\n\n                mld = gfc.mld_s[sb] * gfc.en[2].s[sb][sblock];\n                var rside = Math.max(gfc.thm[3].s[sb][sblock],\n                    Math.min(gfc.thm[2].s[sb][sblock], mld));\n\n                gfc.thm[2].s[sb][sblock] = rmid;\n                gfc.thm[3].s[sb][sblock] = rside;\n            }\n        }\n    }\n\n    /**\n     * Adjust M/S maskings if user set \"msfix\"\n     *\n     * Naoki Shibata 2000\n     */\n    function ns_msfix(gfc, msfix, athadjust) {\n        var msfix2 = msfix;\n        var athlower = Math.pow(10, athadjust);\n\n        msfix *= 2.0;\n        msfix2 *= 2.0;\n        for (var sb = 0; sb < Encoder.SBMAX_l; sb++) {\n            var thmLR, thmM, thmS, ath;\n            ath = (gfc.ATH.cb_l[gfc.bm_l[sb]]) * athlower;\n            thmLR = Math.min(Math.max(gfc.thm[0].l[sb], ath),\n                Math.max(gfc.thm[1].l[sb], ath));\n            thmM = Math.max(gfc.thm[2].l[sb], ath);\n            thmS = Math.max(gfc.thm[3].l[sb], ath);\n            if (thmLR * msfix < thmM + thmS) {\n                var f = thmLR * msfix2 / (thmM + thmS);\n                thmM *= f;\n                thmS *= f;\n            }\n            gfc.thm[2].l[sb] = Math.min(thmM, gfc.thm[2].l[sb]);\n            gfc.thm[3].l[sb] = Math.min(thmS, gfc.thm[3].l[sb]);\n        }\n\n        athlower *= ( Encoder.BLKSIZE_s / Encoder.BLKSIZE);\n        for (var sb = 0; sb < Encoder.SBMAX_s; sb++) {\n            for (var sblock = 0; sblock < 3; sblock++) {\n                var thmLR, thmM, thmS, ath;\n                ath = (gfc.ATH.cb_s[gfc.bm_s[sb]]) * athlower;\n                thmLR = Math.min(Math.max(gfc.thm[0].s[sb][sblock], ath),\n                    Math.max(gfc.thm[1].s[sb][sblock], ath));\n                thmM = Math.max(gfc.thm[2].s[sb][sblock], ath);\n                thmS = Math.max(gfc.thm[3].s[sb][sblock], ath);\n\n                if (thmLR * msfix < thmM + thmS) {\n                    var f = thmLR * msfix / (thmM + thmS);\n                    thmM *= f;\n                    thmS *= f;\n                }\n                gfc.thm[2].s[sb][sblock] = Math.min(gfc.thm[2].s[sb][sblock],\n                    thmM);\n                gfc.thm[3].s[sb][sblock] = Math.min(gfc.thm[3].s[sb][sblock],\n                    thmS);\n            }\n        }\n    }\n\n    /**\n     * short block threshold calculation (part 2)\n     *\n     * partition band bo_s[sfb] is at the transition from scalefactor band sfb\n     * to the next one sfb+1; enn and thmm have to be split between them\n     */\n    function convert_partition2scalefac_s(gfc, eb, thr, chn, sblock) {\n        var sb, b;\n        var enn = 0.0;\n        var thmm = 0.0;\n        for (sb = b = 0; sb < Encoder.SBMAX_s; ++b, ++sb) {\n            var bo_s_sb = gfc.bo_s[sb];\n            var npart_s = gfc.npart_s;\n            var b_lim = bo_s_sb < npart_s ? bo_s_sb : npart_s;\n            while (b < b_lim) {\n                // iff failed, it may indicate some index error elsewhere\n                enn += eb[b];\n                thmm += thr[b];\n                b++;\n            }\n            gfc.en[chn].s[sb][sblock] = enn;\n            gfc.thm[chn].s[sb][sblock] = thmm;\n\n            if (b >= npart_s) {\n                ++sb;\n                break;\n            }\n            // iff failed, it may indicate some index error elsewhere\n            {\n                /* at transition sfb . sfb+1 */\n                var w_curr = gfc.PSY.bo_s_weight[sb];\n                var w_next = 1.0 - w_curr;\n                enn = w_curr * eb[b];\n                thmm = w_curr * thr[b];\n                gfc.en[chn].s[sb][sblock] += enn;\n                gfc.thm[chn].s[sb][sblock] += thmm;\n                enn = w_next * eb[b];\n                thmm = w_next * thr[b];\n            }\n        }\n        /* zero initialize the rest */\n        for (; sb < Encoder.SBMAX_s; ++sb) {\n            gfc.en[chn].s[sb][sblock] = 0;\n            gfc.thm[chn].s[sb][sblock] = 0;\n        }\n    }\n\n    /**\n     * longblock threshold calculation (part 2)\n     */\n    function convert_partition2scalefac_l(gfc, eb, thr, chn) {\n        var sb, b;\n        var enn = 0.0;\n        var thmm = 0.0;\n        for (sb = b = 0; sb < Encoder.SBMAX_l; ++b, ++sb) {\n            var bo_l_sb = gfc.bo_l[sb];\n            var npart_l = gfc.npart_l;\n            var b_lim = bo_l_sb < npart_l ? bo_l_sb : npart_l;\n            while (b < b_lim) {\n                // iff failed, it may indicate some index error elsewhere\n                enn += eb[b];\n                thmm += thr[b];\n                b++;\n            }\n            gfc.en[chn].l[sb] = enn;\n            gfc.thm[chn].l[sb] = thmm;\n\n            if (b >= npart_l) {\n                ++sb;\n                break;\n            }\n            {\n                /* at transition sfb . sfb+1 */\n                var w_curr = gfc.PSY.bo_l_weight[sb];\n                var w_next = 1.0 - w_curr;\n                enn = w_curr * eb[b];\n                thmm = w_curr * thr[b];\n                gfc.en[chn].l[sb] += enn;\n                gfc.thm[chn].l[sb] += thmm;\n                enn = w_next * eb[b];\n                thmm = w_next * thr[b];\n            }\n        }\n        /* zero initialize the rest */\n        for (; sb < Encoder.SBMAX_l; ++sb) {\n            gfc.en[chn].l[sb] = 0;\n            gfc.thm[chn].l[sb] = 0;\n        }\n    }\n\n    function compute_masking_s(gfp, fftenergy_s, eb, thr, chn, sblock) {\n        var gfc = gfp.internal_flags;\n        var j, b;\n\n        for (b = j = 0; b < gfc.npart_s; ++b) {\n            var ebb = 0, m = 0;\n            var n = gfc.numlines_s[b];\n            for (var i = 0; i < n; ++i, ++j) {\n                var el = fftenergy_s[sblock][j];\n                ebb += el;\n                if (m < el)\n                    m = el;\n            }\n            eb[b] = ebb;\n        }\n        for (j = b = 0; b < gfc.npart_s; b++) {\n            var kk = gfc.s3ind_s[b][0];\n            var ecb = gfc.s3_ss[j++] * eb[kk];\n            ++kk;\n            while (kk <= gfc.s3ind_s[b][1]) {\n                ecb += gfc.s3_ss[j] * eb[kk];\n                ++j;\n                ++kk;\n            }\n\n            { /* limit calculated threshold by previous granule */\n                var x = rpelev_s * gfc.nb_s1[chn][b];\n                thr[b] = Math.min(ecb, x);\n            }\n            if (gfc.blocktype_old[chn & 1] == Encoder.SHORT_TYPE) {\n                /* limit calculated threshold by even older granule */\n                var x = rpelev2_s * gfc.nb_s2[chn][b];\n                var y = thr[b];\n                thr[b] = Math.min(x, y);\n            }\n\n            gfc.nb_s2[chn][b] = gfc.nb_s1[chn][b];\n            gfc.nb_s1[chn][b] = ecb;\n        }\n        for (; b <= Encoder.CBANDS; ++b) {\n            eb[b] = 0;\n            thr[b] = 0;\n        }\n    }\n\n    function block_type_set(gfp, uselongblock, blocktype_d, blocktype) {\n        var gfc = gfp.internal_flags;\n\n        if (gfp.short_blocks == ShortBlock.short_block_coupled\n                /* force both channels to use the same block type */\n                /* this is necessary if the frame is to be encoded in ms_stereo. */\n                /* But even without ms_stereo, FhG does this */\n            && !(uselongblock[0] != 0 && uselongblock[1] != 0))\n            uselongblock[0] = uselongblock[1] = 0;\n\n        /*\n         * update the blocktype of the previous granule, since it depends on\n         * what happend in this granule\n         */\n        for (var chn = 0; chn < gfc.channels_out; chn++) {\n            blocktype[chn] = Encoder.NORM_TYPE;\n            /* disable short blocks */\n            if (gfp.short_blocks == ShortBlock.short_block_dispensed)\n                uselongblock[chn] = 1;\n            if (gfp.short_blocks == ShortBlock.short_block_forced)\n                uselongblock[chn] = 0;\n\n            if (uselongblock[chn] != 0) {\n                /* no attack : use long blocks */\n                if (gfc.blocktype_old[chn] == Encoder.SHORT_TYPE)\n                    blocktype[chn] = Encoder.STOP_TYPE;\n            } else {\n                /* attack : use short blocks */\n                blocktype[chn] = Encoder.SHORT_TYPE;\n                if (gfc.blocktype_old[chn] == Encoder.NORM_TYPE) {\n                    gfc.blocktype_old[chn] = Encoder.START_TYPE;\n                }\n                if (gfc.blocktype_old[chn] == Encoder.STOP_TYPE)\n                    gfc.blocktype_old[chn] = Encoder.SHORT_TYPE;\n            }\n\n            blocktype_d[chn] = gfc.blocktype_old[chn];\n            // value returned to calling program\n            gfc.blocktype_old[chn] = blocktype[chn];\n            // save for next call to l3psy_anal\n        }\n    }\n\n    function NS_INTERP(x, y, r) {\n        /* was pow((x),(r))*pow((y),1-(r)) */\n        if (r >= 1.0) {\n            /* 99.7% of the time */\n            return x;\n        }\n        if (r <= 0.0)\n            return y;\n        if (y > 0.0) {\n            /* rest of the time */\n            return (Math.pow(x / y, r) * y);\n        }\n        /* never happens */\n        return 0.0;\n    }\n\n    /**\n     * these values are tuned only for 44.1kHz...\n     */\n    var regcoef_s = [11.8, 13.6, 17.2, 32, 46.5,\n        51.3, 57.5, 67.1, 71.5, 84.6, 97.6, 130,\n        /* 255.8 */\n    ];\n\n    function pecalc_s(mr, masking_lower) {\n        var pe_s = 1236.28 / 4;\n        for (var sb = 0; sb < Encoder.SBMAX_s - 1; sb++) {\n            for (var sblock = 0; sblock < 3; sblock++) {\n                var thm = mr.thm.s[sb][sblock];\n                if (thm > 0.0) {\n                    var x = thm * masking_lower;\n                    var en = mr.en.s[sb][sblock];\n                    if (en > x) {\n                        if (en > x * 1e10) {\n                            pe_s += regcoef_s[sb] * (10.0 * LOG10);\n                        } else {\n                            pe_s += regcoef_s[sb] * Util.FAST_LOG10(en / x);\n                        }\n                    }\n                }\n            }\n        }\n\n        return pe_s;\n    }\n\n    /**\n     * these values are tuned only for 44.1kHz...\n     */\n    var regcoef_l = [6.8, 5.8, 5.8, 6.4, 6.5, 9.9,\n        12.1, 14.4, 15, 18.9, 21.6, 26.9, 34.2, 40.2, 46.8, 56.5,\n        60.7, 73.9, 85.7, 93.4, 126.1,\n        /* 241.3 */\n    ];\n\n    function pecalc_l(mr, masking_lower) {\n        var pe_l = 1124.23 / 4;\n        for (var sb = 0; sb < Encoder.SBMAX_l - 1; sb++) {\n            var thm = mr.thm.l[sb];\n            if (thm > 0.0) {\n                var x = thm * masking_lower;\n                var en = mr.en.l[sb];\n                if (en > x) {\n                    if (en > x * 1e10) {\n                        pe_l += regcoef_l[sb] * (10.0 * LOG10);\n                    } else {\n                        pe_l += regcoef_l[sb] * Util.FAST_LOG10(en / x);\n                    }\n                }\n            }\n        }\n        return pe_l;\n    }\n\n    function calc_energy(gfc, fftenergy, eb, max, avg) {\n        var b, j;\n\n        for (b = j = 0; b < gfc.npart_l; ++b) {\n            var ebb = 0, m = 0;\n            var i;\n            for (i = 0; i < gfc.numlines_l[b]; ++i, ++j) {\n                var el = fftenergy[j];\n                ebb += el;\n                if (m < el)\n                    m = el;\n            }\n            eb[b] = ebb;\n            max[b] = m;\n            avg[b] = ebb * gfc.rnumlines_l[b];\n        }\n    }\n\n    function calc_mask_index_l(gfc, max, avg, mask_idx) {\n        var last_tab_entry = tab.length - 1;\n        var b = 0;\n        var a = avg[b] + avg[b + 1];\n        if (a > 0.0) {\n            var m = max[b];\n            if (m < max[b + 1])\n                m = max[b + 1];\n            a = 20.0 * (m * 2.0 - a)\n                / (a * (gfc.numlines_l[b] + gfc.numlines_l[b + 1] - 1));\n            var k = 0 | a;\n            if (k > last_tab_entry)\n                k = last_tab_entry;\n            mask_idx[b] = k;\n        } else {\n            mask_idx[b] = 0;\n        }\n\n        for (b = 1; b < gfc.npart_l - 1; b++) {\n            a = avg[b - 1] + avg[b] + avg[b + 1];\n            if (a > 0.0) {\n                var m = max[b - 1];\n                if (m < max[b])\n                    m = max[b];\n                if (m < max[b + 1])\n                    m = max[b + 1];\n                a = 20.0\n                    * (m * 3.0 - a)\n                    / (a * (gfc.numlines_l[b - 1] + gfc.numlines_l[b]\n                    + gfc.numlines_l[b + 1] - 1));\n                var k = 0 | a;\n                if (k > last_tab_entry)\n                    k = last_tab_entry;\n                mask_idx[b] = k;\n            } else {\n                mask_idx[b] = 0;\n            }\n        }\n\n        a = avg[b - 1] + avg[b];\n        if (a > 0.0) {\n            var m = max[b - 1];\n            if (m < max[b])\n                m = max[b];\n            a = 20.0 * (m * 2.0 - a)\n                / (a * (gfc.numlines_l[b - 1] + gfc.numlines_l[b] - 1));\n            var k = 0 | a;\n            if (k > last_tab_entry)\n                k = last_tab_entry;\n            mask_idx[b] = k;\n        } else {\n            mask_idx[b] = 0;\n        }\n    }\n\n    var fircoef = [\n        -8.65163e-18 * 2, -0.00851586 * 2, -6.74764e-18 * 2, 0.0209036 * 2,\n        -3.36639e-17 * 2, -0.0438162 * 2, -1.54175e-17 * 2, 0.0931738 * 2,\n        -5.52212e-17 * 2, -0.313819 * 2\n    ];\n\n    this.L3psycho_anal_ns = function (gfp, buffer, bufPos, gr_out, masking_ratio, masking_MS_ratio, percep_entropy, percep_MS_entropy, energy, blocktype_d) {\n        /*\n         * to get a good cache performance, one has to think about the sequence,\n         * in which the variables are used.\n         */\n        var gfc = gfp.internal_flags;\n\n        /* fft and energy calculation */\n        var wsamp_L = new_float_n([2, Encoder.BLKSIZE]);\n        var wsamp_S = new_float_n([2, 3, Encoder.BLKSIZE_s]);\n\n        /* convolution */\n        var eb_l = new_float(Encoder.CBANDS + 1);\n        var eb_s = new_float(Encoder.CBANDS + 1);\n        var thr = new_float(Encoder.CBANDS + 2);\n\n        /* block type */\n        var blocktype = new_int(2), uselongblock = new_int(2);\n\n        /* usual variables like loop indices, etc.. */\n        var numchn, chn;\n        var b, i, j, k;\n        var sb, sblock;\n\n        /* variables used for --nspsytune */\n        var ns_hpfsmpl = new_float_n([2, 576]);\n        var pcfact;\n        var mask_idx_l = new_int(Encoder.CBANDS + 2), mask_idx_s = new_int(Encoder.CBANDS + 2);\n\n        Arrays.fill(mask_idx_s, 0);\n\n        numchn = gfc.channels_out;\n        /* chn=2 and 3 = Mid and Side channels */\n        if (gfp.mode == MPEGMode.JOINT_STEREO)\n            numchn = 4;\n\n        if (gfp.VBR == VbrMode.vbr_off)\n            pcfact = gfc.ResvMax == 0 ? 0 : ( gfc.ResvSize)\n            / gfc.ResvMax * 0.5;\n        else if (gfp.VBR == VbrMode.vbr_rh || gfp.VBR == VbrMode.vbr_mtrh\n            || gfp.VBR == VbrMode.vbr_mt) {\n            pcfact = 0.6;\n        } else\n            pcfact = 1.0;\n\n        /**********************************************************************\n         * Apply HPF of fs/4 to the input signal. This is used for attack\n         * detection / handling.\n         **********************************************************************/\n        /* Don't copy the input buffer into a temporary buffer */\n        /* unroll the loop 2 times */\n        for (chn = 0; chn < gfc.channels_out; chn++) {\n            /* apply high pass filter of fs/4 */\n            var firbuf = buffer[chn];\n            var firbufPos = bufPos + 576 - 350 - NSFIRLEN + 192;\n            for (i = 0; i < 576; i++) {\n                var sum1, sum2;\n                sum1 = firbuf[firbufPos + i + 10];\n                sum2 = 0.0;\n                for (j = 0; j < ((NSFIRLEN - 1) / 2) - 1; j += 2) {\n                    sum1 += fircoef[j]\n                        * (firbuf[firbufPos + i + j] + firbuf[firbufPos + i\n                        + NSFIRLEN - j]);\n                    sum2 += fircoef[j + 1]\n                        * (firbuf[firbufPos + i + j + 1] + firbuf[firbufPos\n                        + i + NSFIRLEN - j - 1]);\n                }\n                ns_hpfsmpl[chn][i] = sum1 + sum2;\n            }\n            masking_ratio[gr_out][chn].en.assign(gfc.en[chn]);\n            masking_ratio[gr_out][chn].thm.assign(gfc.thm[chn]);\n            if (numchn > 2) {\n                /* MS maskings */\n                /* percep_MS_entropy [chn-2] = gfc . pe [chn]; */\n                masking_MS_ratio[gr_out][chn].en.assign(gfc.en[chn + 2]);\n                masking_MS_ratio[gr_out][chn].thm.assign(gfc.thm[chn + 2]);\n            }\n        }\n\n        for (chn = 0; chn < numchn; chn++) {\n            var wsamp_l;\n            var wsamp_s;\n            var en_subshort = new_float(12);\n            var en_short = [0, 0, 0, 0];\n            var attack_intensity = new_float(12);\n            var ns_uselongblock = 1;\n            var attackThreshold;\n            var max = new_float(Encoder.CBANDS), avg = new_float(Encoder.CBANDS);\n            var ns_attacks = [0, 0, 0, 0];\n            var fftenergy = new_float(Encoder.HBLKSIZE);\n            var fftenergy_s = new_float_n([3, Encoder.HBLKSIZE_s]);\n\n            /*\n             * rh 20040301: the following loops do access one off the limits so\n             * I increase the array dimensions by one and initialize the\n             * accessed values to zero\n             */\n\n            /***************************************************************\n             * determine the block type (window type)\n             ***************************************************************/\n            /* calculate energies of each sub-shortblocks */\n            for (i = 0; i < 3; i++) {\n                en_subshort[i] = gfc.nsPsy.last_en_subshort[chn][i + 6];\n                attack_intensity[i] = en_subshort[i]\n                    / gfc.nsPsy.last_en_subshort[chn][i + 4];\n                en_short[0] += en_subshort[i];\n            }\n\n            if (chn == 2) {\n                for (i = 0; i < 576; i++) {\n                    var l, r;\n                    l = ns_hpfsmpl[0][i];\n                    r = ns_hpfsmpl[1][i];\n                    ns_hpfsmpl[0][i] = l + r;\n                    ns_hpfsmpl[1][i] = l - r;\n                }\n            }\n            {\n                var pf = ns_hpfsmpl[chn & 1];\n                var pfPos = 0;\n                for (i = 0; i < 9; i++) {\n                    var pfe = pfPos + 576 / 9;\n                    var p = 1.;\n                    for (; pfPos < pfe; pfPos++)\n                        if (p < Math.abs(pf[pfPos]))\n                            p = Math.abs(pf[pfPos]);\n\n                    gfc.nsPsy.last_en_subshort[chn][i] = en_subshort[i + 3] = p;\n                    en_short[1 + i / 3] += p;\n                    if (p > en_subshort[i + 3 - 2]) {\n                        p = p / en_subshort[i + 3 - 2];\n                    } else if (en_subshort[i + 3 - 2] > p * 10.0) {\n                        p = en_subshort[i + 3 - 2] / (p * 10.0);\n                    } else\n                        p = 0.0;\n                    attack_intensity[i + 3] = p;\n                }\n            }\n\n            if (gfp.analysis) {\n                var x = attack_intensity[0];\n                for (i = 1; i < 12; i++)\n                    if (x < attack_intensity[i])\n                        x = attack_intensity[i];\n                gfc.pinfo.ers[gr_out][chn] = gfc.pinfo.ers_save[chn];\n                gfc.pinfo.ers_save[chn] = x;\n            }\n\n            /* compare energies between sub-shortblocks */\n            attackThreshold = (chn == 3) ? gfc.nsPsy.attackthre_s\n                : gfc.nsPsy.attackthre;\n            for (i = 0; i < 12; i++)\n                if (0 == ns_attacks[i / 3]\n                    && attack_intensity[i] > attackThreshold)\n                    ns_attacks[i / 3] = (i % 3) + 1;\n\n            /*\n             * should have energy change between short blocks, in order to avoid\n             * periodic signals\n             */\n            for (i = 1; i < 4; i++) {\n                var ratio;\n                if (en_short[i - 1] > en_short[i]) {\n                    ratio = en_short[i - 1] / en_short[i];\n                } else {\n                    ratio = en_short[i] / en_short[i - 1];\n                }\n                if (ratio < 1.7) {\n                    ns_attacks[i] = 0;\n                    if (i == 1)\n                        ns_attacks[0] = 0;\n                }\n            }\n\n            if (ns_attacks[0] != 0 && gfc.nsPsy.lastAttacks[chn] != 0)\n                ns_attacks[0] = 0;\n\n            if (gfc.nsPsy.lastAttacks[chn] == 3\n                || (ns_attacks[0] + ns_attacks[1] + ns_attacks[2] + ns_attacks[3]) != 0) {\n                ns_uselongblock = 0;\n\n                if (ns_attacks[1] != 0 && ns_attacks[0] != 0)\n                    ns_attacks[1] = 0;\n                if (ns_attacks[2] != 0 && ns_attacks[1] != 0)\n                    ns_attacks[2] = 0;\n                if (ns_attacks[3] != 0 && ns_attacks[2] != 0)\n                    ns_attacks[3] = 0;\n            }\n\n            if (chn < 2) {\n                uselongblock[chn] = ns_uselongblock;\n            } else {\n                if (ns_uselongblock == 0) {\n                    uselongblock[0] = uselongblock[1] = 0;\n                }\n            }\n\n            /*\n             * there is a one granule delay. Copy maskings computed last call\n             * into masking_ratio to return to calling program.\n             */\n            energy[chn] = gfc.tot_ener[chn];\n\n            /*********************************************************************\n             * compute FFTs\n             *********************************************************************/\n            wsamp_s = wsamp_S;\n            wsamp_l = wsamp_L;\n            compute_ffts(gfp, fftenergy, fftenergy_s, wsamp_l, (chn & 1),\n                wsamp_s, (chn & 1), gr_out, chn, buffer, bufPos);\n\n            /*********************************************************************\n             * Calculate the energy and the tonality of each partition.\n             *********************************************************************/\n            calc_energy(gfc, fftenergy, eb_l, max, avg);\n            calc_mask_index_l(gfc, max, avg, mask_idx_l);\n            /* compute masking thresholds for short blocks */\n            for (sblock = 0; sblock < 3; sblock++) {\n                var enn, thmm;\n                compute_masking_s(gfp, fftenergy_s, eb_s, thr, chn, sblock);\n                convert_partition2scalefac_s(gfc, eb_s, thr, chn, sblock);\n                /**** short block pre-echo control ****/\n                for (sb = 0; sb < Encoder.SBMAX_s; sb++) {\n                    thmm = gfc.thm[chn].s[sb][sblock];\n\n                    thmm *= NS_PREECHO_ATT0;\n                    if (ns_attacks[sblock] >= 2 || ns_attacks[sblock + 1] == 1) {\n                        var idx = (sblock != 0) ? sblock - 1 : 2;\n                        var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                            NS_PREECHO_ATT1 * pcfact);\n                        thmm = Math.min(thmm, p);\n                    }\n\n                    if (ns_attacks[sblock] == 1) {\n                        var idx = (sblock != 0) ? sblock - 1 : 2;\n                        var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                            NS_PREECHO_ATT2 * pcfact);\n                        thmm = Math.min(thmm, p);\n                    } else if ((sblock != 0 && ns_attacks[sblock - 1] == 3)\n                        || (sblock == 0 && gfc.nsPsy.lastAttacks[chn] == 3)) {\n                        var idx = (sblock != 2) ? sblock + 1 : 0;\n                        var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                            NS_PREECHO_ATT2 * pcfact);\n                        thmm = Math.min(thmm, p);\n                    }\n\n                    /* pulse like signal detection for fatboy.wav and so on */\n                    enn = en_subshort[sblock * 3 + 3]\n                        + en_subshort[sblock * 3 + 4]\n                        + en_subshort[sblock * 3 + 5];\n                    if (en_subshort[sblock * 3 + 5] * 6 < enn) {\n                        thmm *= 0.5;\n                        if (en_subshort[sblock * 3 + 4] * 6 < enn)\n                            thmm *= 0.5;\n                    }\n\n                    gfc.thm[chn].s[sb][sblock] = thmm;\n                }\n            }\n            gfc.nsPsy.lastAttacks[chn] = ns_attacks[2];\n\n            /*********************************************************************\n             * convolve the partitioned energy and unpredictability with the\n             * spreading function, s3_l[b][k]\n             ********************************************************************/\n            k = 0;\n            {\n                for (b = 0; b < gfc.npart_l; b++) {\n                    /*\n                     * convolve the partitioned energy with the spreading\n                     * function\n                     */\n                    var kk = gfc.s3ind[b][0];\n                    var eb2 = eb_l[kk] * tab[mask_idx_l[kk]];\n                    var ecb = gfc.s3_ll[k++] * eb2;\n                    while (++kk <= gfc.s3ind[b][1]) {\n                        eb2 = eb_l[kk] * tab[mask_idx_l[kk]];\n                        ecb = mask_add(ecb, gfc.s3_ll[k++] * eb2, kk, kk - b,\n                            gfc, 0);\n                    }\n                    ecb *= 0.158489319246111;\n                    /* pow(10,-0.8) */\n\n                    /**** long block pre-echo control ****/\n                    /**\n                     * <PRE>\n                     * dont use long block pre-echo control if previous granule was\n                     * a short block.  This is to avoid the situation:\n                     * frame0:  quiet (very low masking)\n                     * frame1:  surge  (triggers short blocks)\n                     * frame2:  regular frame.  looks like pre-echo when compared to\n                     *          frame0, but all pre-echo was in frame1.\n                     * </PRE>\n                     */\n                    /*\n                     * chn=0,1 L and R channels\n                     *\n                     * chn=2,3 S and M channels.\n                     */\n\n                    if (gfc.blocktype_old[chn & 1] == Encoder.SHORT_TYPE)\n                        thr[b] = ecb;\n                    else\n                        thr[b] = NS_INTERP(\n                            Math.min(ecb, Math.min(rpelev\n                                * gfc.nb_1[chn][b], rpelev2\n                                * gfc.nb_2[chn][b])), ecb, pcfact);\n\n                    gfc.nb_2[chn][b] = gfc.nb_1[chn][b];\n                    gfc.nb_1[chn][b] = ecb;\n                }\n            }\n            for (; b <= Encoder.CBANDS; ++b) {\n                eb_l[b] = 0;\n                thr[b] = 0;\n            }\n            /* compute masking thresholds for long blocks */\n            convert_partition2scalefac_l(gfc, eb_l, thr, chn);\n        }\n        /* end loop over chn */\n\n        if (gfp.mode == MPEGMode.STEREO || gfp.mode == MPEGMode.JOINT_STEREO) {\n            if (gfp.interChRatio > 0.0) {\n                calc_interchannel_masking(gfp, gfp.interChRatio);\n            }\n        }\n\n        if (gfp.mode == MPEGMode.JOINT_STEREO) {\n            var msfix;\n            msfix1(gfc);\n            msfix = gfp.msfix;\n            if (Math.abs(msfix) > 0.0)\n                ns_msfix(gfc, msfix, gfp.ATHlower * gfc.ATH.adjust);\n        }\n\n        /***************************************************************\n         * determine final block type\n         ***************************************************************/\n        block_type_set(gfp, uselongblock, blocktype_d, blocktype);\n\n        /*********************************************************************\n         * compute the value of PE to return ... no delay and advance\n         *********************************************************************/\n        for (chn = 0; chn < numchn; chn++) {\n            var ppe;\n            var ppePos = 0;\n            var type;\n            var mr;\n\n            if (chn > 1) {\n                ppe = percep_MS_entropy;\n                ppePos = -2;\n                type = Encoder.NORM_TYPE;\n                if (blocktype_d[0] == Encoder.SHORT_TYPE\n                    || blocktype_d[1] == Encoder.SHORT_TYPE)\n                    type = Encoder.SHORT_TYPE;\n                mr = masking_MS_ratio[gr_out][chn - 2];\n            } else {\n                ppe = percep_entropy;\n                ppePos = 0;\n                type = blocktype_d[chn];\n                mr = masking_ratio[gr_out][chn];\n            }\n\n            if (type == Encoder.SHORT_TYPE)\n                ppe[ppePos + chn] = pecalc_s(mr, gfc.masking_lower);\n            else\n                ppe[ppePos + chn] = pecalc_l(mr, gfc.masking_lower);\n\n            if (gfp.analysis)\n                gfc.pinfo.pe[gr_out][chn] = ppe[ppePos + chn];\n\n        }\n        return 0;\n    }\n\n    function vbrpsy_compute_fft_l(gfp, buffer, bufPos, chn, gr_out, fftenergy, wsamp_l, wsamp_lPos) {\n        var gfc = gfp.internal_flags;\n        if (chn < 2) {\n            fft.fft_long(gfc, wsamp_l[wsamp_lPos], chn, buffer, bufPos);\n        } else if (chn == 2) {\n            /* FFT data for mid and side channel is derived from L & R */\n            for (var j = Encoder.BLKSIZE - 1; j >= 0; --j) {\n                var l = wsamp_l[wsamp_lPos + 0][j];\n                var r = wsamp_l[wsamp_lPos + 1][j];\n                wsamp_l[wsamp_lPos + 0][j] = (l + r) * Util.SQRT2 * 0.5;\n                wsamp_l[wsamp_lPos + 1][j] = (l - r) * Util.SQRT2 * 0.5;\n            }\n        }\n\n        /*********************************************************************\n         * compute energies\n         *********************************************************************/\n        fftenergy[0] = NON_LINEAR_SCALE_ENERGY(wsamp_l[wsamp_lPos + 0][0]);\n        fftenergy[0] *= fftenergy[0];\n\n        for (var j = Encoder.BLKSIZE / 2 - 1; j >= 0; --j) {\n            var re = wsamp_l[wsamp_lPos + 0][Encoder.BLKSIZE / 2 - j];\n            var im = wsamp_l[wsamp_lPos + 0][Encoder.BLKSIZE / 2 + j];\n            fftenergy[Encoder.BLKSIZE / 2 - j] = NON_LINEAR_SCALE_ENERGY((re\n                * re + im * im) * 0.5);\n        }\n        /* total energy */\n        {\n            var totalenergy = 0.0;\n            for (var j = 11; j < Encoder.HBLKSIZE; j++)\n                totalenergy += fftenergy[j];\n\n            gfc.tot_ener[chn] = totalenergy;\n        }\n\n        if (gfp.analysis) {\n            for (var j = 0; j < Encoder.HBLKSIZE; j++) {\n                gfc.pinfo.energy[gr_out][chn][j] = gfc.pinfo.energy_save[chn][j];\n                gfc.pinfo.energy_save[chn][j] = fftenergy[j];\n            }\n            gfc.pinfo.pe[gr_out][chn] = gfc.pe[chn];\n        }\n    }\n\n    function vbrpsy_compute_fft_s(gfp, buffer, bufPos, chn, sblock, fftenergy_s, wsamp_s, wsamp_sPos) {\n        var gfc = gfp.internal_flags;\n\n        if (sblock == 0 && chn < 2) {\n            fft.fft_short(gfc, wsamp_s[wsamp_sPos], chn, buffer, bufPos);\n        }\n        if (chn == 2) {\n            /* FFT data for mid and side channel is derived from L & R */\n            for (var j = Encoder.BLKSIZE_s - 1; j >= 0; --j) {\n                var l = wsamp_s[wsamp_sPos + 0][sblock][j];\n                var r = wsamp_s[wsamp_sPos + 1][sblock][j];\n                wsamp_s[wsamp_sPos + 0][sblock][j] = (l + r) * Util.SQRT2 * 0.5;\n                wsamp_s[wsamp_sPos + 1][sblock][j] = (l - r) * Util.SQRT2 * 0.5;\n            }\n        }\n\n        /*********************************************************************\n         * compute energies\n         *********************************************************************/\n        fftenergy_s[sblock][0] = wsamp_s[wsamp_sPos + 0][sblock][0];\n        fftenergy_s[sblock][0] *= fftenergy_s[sblock][0];\n        for (var j = Encoder.BLKSIZE_s / 2 - 1; j >= 0; --j) {\n            var re = wsamp_s[wsamp_sPos + 0][sblock][Encoder.BLKSIZE_s / 2 - j];\n            var im = wsamp_s[wsamp_sPos + 0][sblock][Encoder.BLKSIZE_s / 2 + j];\n            fftenergy_s[sblock][Encoder.BLKSIZE_s / 2 - j] = NON_LINEAR_SCALE_ENERGY((re\n                * re + im * im) * 0.5);\n        }\n    }\n\n    /**\n     * compute loudness approximation (used for ATH auto-level adjustment)\n     */\n    function vbrpsy_compute_loudness_approximation_l(gfp, gr_out, chn, fftenergy) {\n        var gfc = gfp.internal_flags;\n        if (gfp.athaa_loudapprox == 2 && chn < 2) {\n            // no loudness for mid/side ch\n            gfc.loudness_sq[gr_out][chn] = gfc.loudness_sq_save[chn];\n            gfc.loudness_sq_save[chn] = psycho_loudness_approx(fftenergy, gfc);\n        }\n    }\n\n    var fircoef_ = [-8.65163e-18 * 2,\n        -0.00851586 * 2, -6.74764e-18 * 2, 0.0209036 * 2,\n        -3.36639e-17 * 2, -0.0438162 * 2, -1.54175e-17 * 2,\n        0.0931738 * 2, -5.52212e-17 * 2, -0.313819 * 2];\n\n    /**\n     * Apply HPF of fs/4 to the input signal. This is used for attack detection\n     * / handling.\n     */\n    function vbrpsy_attack_detection(gfp, buffer, bufPos, gr_out, masking_ratio, masking_MS_ratio, energy, sub_short_factor, ns_attacks, uselongblock) {\n        var ns_hpfsmpl = new_float_n([2, 576]);\n        var gfc = gfp.internal_flags;\n        var n_chn_out = gfc.channels_out;\n        /* chn=2 and 3 = Mid and Side channels */\n        var n_chn_psy = (gfp.mode == MPEGMode.JOINT_STEREO) ? 4 : n_chn_out;\n        /* Don't copy the input buffer into a temporary buffer */\n        /* unroll the loop 2 times */\n        for (var chn = 0; chn < n_chn_out; chn++) {\n            /* apply high pass filter of fs/4 */\n            firbuf = buffer[chn];\n            var firbufPos = bufPos + 576 - 350 - NSFIRLEN + 192;\n            for (var i = 0; i < 576; i++) {\n                var sum1, sum2;\n                sum1 = firbuf[firbufPos + i + 10];\n                sum2 = 0.0;\n                for (var j = 0; j < ((NSFIRLEN - 1) / 2) - 1; j += 2) {\n                    sum1 += fircoef_[j]\n                        * (firbuf[firbufPos + i + j] + firbuf[firbufPos + i\n                        + NSFIRLEN - j]);\n                    sum2 += fircoef_[j + 1]\n                        * (firbuf[firbufPos + i + j + 1] + firbuf[firbufPos\n                        + i + NSFIRLEN - j - 1]);\n                }\n                ns_hpfsmpl[chn][i] = sum1 + sum2;\n            }\n            masking_ratio[gr_out][chn].en.assign(gfc.en[chn]);\n            masking_ratio[gr_out][chn].thm.assign(gfc.thm[chn]);\n            if (n_chn_psy > 2) {\n                /* MS maskings */\n                /* percep_MS_entropy [chn-2] = gfc . pe [chn]; */\n                masking_MS_ratio[gr_out][chn].en.assign(gfc.en[chn + 2]);\n                masking_MS_ratio[gr_out][chn].thm.assign(gfc.thm[chn + 2]);\n            }\n        }\n        for (var chn = 0; chn < n_chn_psy; chn++) {\n            var attack_intensity = new_float(12);\n            var en_subshort = new_float(12);\n            var en_short = [0, 0, 0, 0];\n            var pf = ns_hpfsmpl[chn & 1];\n            var pfPos = 0;\n            var attackThreshold = (chn == 3) ? gfc.nsPsy.attackthre_s\n                : gfc.nsPsy.attackthre;\n            var ns_uselongblock = 1;\n\n            if (chn == 2) {\n                for (var i = 0, j = 576; j > 0; ++i, --j) {\n                    var l = ns_hpfsmpl[0][i];\n                    var r = ns_hpfsmpl[1][i];\n                    ns_hpfsmpl[0][i] = l + r;\n                    ns_hpfsmpl[1][i] = l - r;\n                }\n            }\n            /***************************************************************\n             * determine the block type (window type)\n             ***************************************************************/\n            /* calculate energies of each sub-shortblocks */\n            for (var i = 0; i < 3; i++) {\n                en_subshort[i] = gfc.nsPsy.last_en_subshort[chn][i + 6];\n                attack_intensity[i] = en_subshort[i]\n                    / gfc.nsPsy.last_en_subshort[chn][i + 4];\n                en_short[0] += en_subshort[i];\n            }\n\n            for (var i = 0; i < 9; i++) {\n                var pfe = pfPos + 576 / 9;\n                var p = 1.;\n                for (; pfPos < pfe; pfPos++)\n                    if (p < Math.abs(pf[pfPos]))\n                        p = Math.abs(pf[pfPos]);\n\n                gfc.nsPsy.last_en_subshort[chn][i] = en_subshort[i + 3] = p;\n                en_short[1 + i / 3] += p;\n                if (p > en_subshort[i + 3 - 2]) {\n                    p = p / en_subshort[i + 3 - 2];\n                } else if (en_subshort[i + 3 - 2] > p * 10.0) {\n                    p = en_subshort[i + 3 - 2] / (p * 10.0);\n                } else {\n                    p = 0.0;\n                }\n                attack_intensity[i + 3] = p;\n            }\n            /* pulse like signal detection for fatboy.wav and so on */\n            for (var i = 0; i < 3; ++i) {\n                var enn = en_subshort[i * 3 + 3]\n                    + en_subshort[i * 3 + 4] + en_subshort[i * 3 + 5];\n                var factor = 1.;\n                if (en_subshort[i * 3 + 5] * 6 < enn) {\n                    factor *= 0.5;\n                    if (en_subshort[i * 3 + 4] * 6 < enn) {\n                        factor *= 0.5;\n                    }\n                }\n                sub_short_factor[chn][i] = factor;\n            }\n\n            if (gfp.analysis) {\n                var x = attack_intensity[0];\n                for (var i = 1; i < 12; i++) {\n                    if (x < attack_intensity[i]) {\n                        x = attack_intensity[i];\n                    }\n                }\n                gfc.pinfo.ers[gr_out][chn] = gfc.pinfo.ers_save[chn];\n                gfc.pinfo.ers_save[chn] = x;\n            }\n\n            /* compare energies between sub-shortblocks */\n            for (var i = 0; i < 12; i++) {\n                if (0 == ns_attacks[chn][i / 3]\n                    && attack_intensity[i] > attackThreshold) {\n                    ns_attacks[chn][i / 3] = (i % 3) + 1;\n                }\n            }\n\n            /*\n             * should have energy change between short blocks, in order to avoid\n             * periodic signals\n             */\n            /* Good samples to show the effect are Trumpet test songs */\n            /*\n             * GB: tuned (1) to avoid too many short blocks for test sample\n             * TRUMPET\n             */\n            /*\n             * RH: tuned (2) to let enough short blocks through for test sample\n             * FSOL and SNAPS\n             */\n            for (var i = 1; i < 4; i++) {\n                var u = en_short[i - 1];\n                var v = en_short[i];\n                var m = Math.max(u, v);\n                if (m < 40000) { /* (2) */\n                    if (u < 1.7 * v && v < 1.7 * u) { /* (1) */\n                        if (i == 1 && ns_attacks[chn][0] <= ns_attacks[chn][i]) {\n                            ns_attacks[chn][0] = 0;\n                        }\n                        ns_attacks[chn][i] = 0;\n                    }\n                }\n            }\n\n            if (ns_attacks[chn][0] <= gfc.nsPsy.lastAttacks[chn]) {\n                ns_attacks[chn][0] = 0;\n            }\n\n            if (gfc.nsPsy.lastAttacks[chn] == 3\n                || (ns_attacks[chn][0] + ns_attacks[chn][1]\n                + ns_attacks[chn][2] + ns_attacks[chn][3]) != 0) {\n                ns_uselongblock = 0;\n\n                if (ns_attacks[chn][1] != 0 && ns_attacks[chn][0] != 0) {\n                    ns_attacks[chn][1] = 0;\n                }\n                if (ns_attacks[chn][2] != 0 && ns_attacks[chn][1] != 0) {\n                    ns_attacks[chn][2] = 0;\n                }\n                if (ns_attacks[chn][3] != 0 && ns_attacks[chn][2] != 0) {\n                    ns_attacks[chn][3] = 0;\n                }\n            }\n            if (chn < 2) {\n                uselongblock[chn] = ns_uselongblock;\n            } else {\n                if (ns_uselongblock == 0) {\n                    uselongblock[0] = uselongblock[1] = 0;\n                }\n            }\n\n            /*\n             * there is a one granule delay. Copy maskings computed last call\n             * into masking_ratio to return to calling program.\n             */\n            energy[chn] = gfc.tot_ener[chn];\n        }\n    }\n\n    function vbrpsy_skip_masking_s(gfc, chn, sblock) {\n        if (sblock == 0) {\n            for (var b = 0; b < gfc.npart_s; b++) {\n                gfc.nb_s2[chn][b] = gfc.nb_s1[chn][b];\n                gfc.nb_s1[chn][b] = 0;\n            }\n        }\n    }\n\n    function vbrpsy_skip_masking_l(gfc, chn) {\n        for (var b = 0; b < gfc.npart_l; b++) {\n            gfc.nb_2[chn][b] = gfc.nb_1[chn][b];\n            gfc.nb_1[chn][b] = 0;\n        }\n    }\n\n    function psyvbr_calc_mask_index_s(gfc, max, avg, mask_idx) {\n        var last_tab_entry = tab.length - 1;\n        var b = 0;\n        var a = avg[b] + avg[b + 1];\n        if (a > 0.0) {\n            var m = max[b];\n            if (m < max[b + 1])\n                m = max[b + 1];\n            a = 20.0 * (m * 2.0 - a)\n                / (a * (gfc.numlines_s[b] + gfc.numlines_s[b + 1] - 1));\n            var k = 0 | a;\n            if (k > last_tab_entry)\n                k = last_tab_entry;\n            mask_idx[b] = k;\n        } else {\n            mask_idx[b] = 0;\n        }\n\n        for (b = 1; b < gfc.npart_s - 1; b++) {\n            a = avg[b - 1] + avg[b] + avg[b + 1];\n            if (a > 0.0) {\n                var m = max[b - 1];\n                if (m < max[b])\n                    m = max[b];\n                if (m < max[b + 1])\n                    m = max[b + 1];\n                a = 20.0\n                    * (m * 3.0 - a)\n                    / (a * (gfc.numlines_s[b - 1] + gfc.numlines_s[b]\n                    + gfc.numlines_s[b + 1] - 1));\n                var k = 0 | a;\n                if (k > last_tab_entry)\n                    k = last_tab_entry;\n                mask_idx[b] = k;\n            } else {\n                mask_idx[b] = 0;\n            }\n        }\n\n        a = avg[b - 1] + avg[b];\n        if (a > 0.0) {\n            var m = max[b - 1];\n            if (m < max[b])\n                m = max[b];\n            a = 20.0 * (m * 2.0 - a)\n                / (a * (gfc.numlines_s[b - 1] + gfc.numlines_s[b] - 1));\n            var k = 0 | a;\n            if (k > last_tab_entry)\n                k = last_tab_entry;\n            mask_idx[b] = k;\n        } else {\n            mask_idx[b] = 0;\n        }\n    }\n\n    function vbrpsy_compute_masking_s(gfp, fftenergy_s, eb, thr, chn, sblock) {\n        var gfc = gfp.internal_flags;\n        var max = new float[Encoder.CBANDS], avg = new_float(Encoder.CBANDS);\n        var i, j, b;\n        var mask_idx_s = new int[Encoder.CBANDS];\n\n        for (b = j = 0; b < gfc.npart_s; ++b) {\n            var ebb = 0, m = 0;\n            var n = gfc.numlines_s[b];\n            for (i = 0; i < n; ++i, ++j) {\n                var el = fftenergy_s[sblock][j];\n                ebb += el;\n                if (m < el)\n                    m = el;\n            }\n            eb[b] = ebb;\n            max[b] = m;\n            avg[b] = ebb / n;\n        }\n        for (; b < Encoder.CBANDS; ++b) {\n            max[b] = 0;\n            avg[b] = 0;\n        }\n        psyvbr_calc_mask_index_s(gfc, max, avg, mask_idx_s);\n        for (j = b = 0; b < gfc.npart_s; b++) {\n            var kk = gfc.s3ind_s[b][0];\n            var last = gfc.s3ind_s[b][1];\n            var dd, dd_n;\n            var x, ecb, avg_mask;\n            dd = mask_idx_s[kk];\n            dd_n = 1;\n            ecb = gfc.s3_ss[j] * eb[kk] * tab[mask_idx_s[kk]];\n            ++j;\n            ++kk;\n            while (kk <= last) {\n                dd += mask_idx_s[kk];\n                dd_n += 1;\n                x = gfc.s3_ss[j] * eb[kk] * tab[mask_idx_s[kk]];\n                ecb = vbrpsy_mask_add(ecb, x, kk - b);\n                ++j;\n                ++kk;\n            }\n            dd = (1 + 2 * dd) / (2 * dd_n);\n            avg_mask = tab[dd] * 0.5;\n            ecb *= avg_mask;\n            thr[b] = ecb;\n            gfc.nb_s2[chn][b] = gfc.nb_s1[chn][b];\n            gfc.nb_s1[chn][b] = ecb;\n            {\n                /*\n                 * if THR exceeds EB, the quantization routines will take the\n                 * difference from other bands. in case of strong tonal samples\n                 * (tonaltest.wav) this leads to heavy distortions. that's why\n                 * we limit THR here.\n                 */\n                x = max[b];\n                x *= gfc.minval_s[b];\n                x *= avg_mask;\n                if (thr[b] > x) {\n                    thr[b] = x;\n                }\n            }\n            if (gfc.masking_lower > 1) {\n                thr[b] *= gfc.masking_lower;\n            }\n            if (thr[b] > eb[b]) {\n                thr[b] = eb[b];\n            }\n            if (gfc.masking_lower < 1) {\n                thr[b] *= gfc.masking_lower;\n            }\n\n        }\n        for (; b < Encoder.CBANDS; ++b) {\n            eb[b] = 0;\n            thr[b] = 0;\n        }\n    }\n\n    function vbrpsy_compute_masking_l(gfc, fftenergy, eb_l, thr, chn) {\n        var max = new_float(Encoder.CBANDS), avg = new_float(Encoder.CBANDS);\n        var mask_idx_l = new_int(Encoder.CBANDS + 2);\n        var b;\n\n        /*********************************************************************\n         * Calculate the energy and the tonality of each partition.\n         *********************************************************************/\n        calc_energy(gfc, fftenergy, eb_l, max, avg);\n        calc_mask_index_l(gfc, max, avg, mask_idx_l);\n\n        /*********************************************************************\n         * convolve the partitioned energy and unpredictability with the\n         * spreading function, s3_l[b][k]\n         ********************************************************************/\n        var k = 0;\n        for (b = 0; b < gfc.npart_l; b++) {\n            var x, ecb, avg_mask, t;\n            /* convolve the partitioned energy with the spreading function */\n            var kk = gfc.s3ind[b][0];\n            var last = gfc.s3ind[b][1];\n            var dd = 0, dd_n = 0;\n            dd = mask_idx_l[kk];\n            dd_n += 1;\n            ecb = gfc.s3_ll[k] * eb_l[kk] * tab[mask_idx_l[kk]];\n            ++k;\n            ++kk;\n            while (kk <= last) {\n                dd += mask_idx_l[kk];\n                dd_n += 1;\n                x = gfc.s3_ll[k] * eb_l[kk] * tab[mask_idx_l[kk]];\n                t = vbrpsy_mask_add(ecb, x, kk - b);\n                ecb = t;\n                ++k;\n                ++kk;\n            }\n            dd = (1 + 2 * dd) / (2 * dd_n);\n            avg_mask = tab[dd] * 0.5;\n            ecb *= avg_mask;\n\n            /**** long block pre-echo control ****/\n            /**\n             * <PRE>\n             * dont use long block pre-echo control if previous granule was\n             * a short block.  This is to avoid the situation:\n             * frame0:  quiet (very low masking)\n             * frame1:  surge  (triggers short blocks)\n             * frame2:  regular frame.  looks like pre-echo when compared to\n             *          frame0, but all pre-echo was in frame1.\n             * </PRE>\n             */\n            /*\n             * chn=0,1 L and R channels chn=2,3 S and M channels.\n             */\n            if (gfc.blocktype_old[chn & 0x01] == Encoder.SHORT_TYPE) {\n                var ecb_limit = rpelev * gfc.nb_1[chn][b];\n                if (ecb_limit > 0) {\n                    thr[b] = Math.min(ecb, ecb_limit);\n                } else {\n                    /**\n                     * <PRE>\n                     * Robert 071209:\n                     * Because we don't calculate long block psy when we know a granule\n                     * should be of short blocks, we don't have any clue how the granule\n                     * before would have looked like as a long block. So we have to guess\n                     * a little bit for this END_TYPE block.\n                     * Most of the time we get away with this sloppyness. (fingers crossed :)\n                     * The speed increase is worth it.\n                     * </PRE>\n                     */\n                    thr[b] = Math.min(ecb, eb_l[b] * NS_PREECHO_ATT2);\n                }\n            } else {\n                var ecb_limit_2 = rpelev2 * gfc.nb_2[chn][b];\n                var ecb_limit_1 = rpelev * gfc.nb_1[chn][b];\n                var ecb_limit;\n                if (ecb_limit_2 <= 0) {\n                    ecb_limit_2 = ecb;\n                }\n                if (ecb_limit_1 <= 0) {\n                    ecb_limit_1 = ecb;\n                }\n                if (gfc.blocktype_old[chn & 0x01] == Encoder.NORM_TYPE) {\n                    ecb_limit = Math.min(ecb_limit_1, ecb_limit_2);\n                } else {\n                    ecb_limit = ecb_limit_1;\n                }\n                thr[b] = Math.min(ecb, ecb_limit);\n            }\n            gfc.nb_2[chn][b] = gfc.nb_1[chn][b];\n            gfc.nb_1[chn][b] = ecb;\n            {\n                /*\n                 * if THR exceeds EB, the quantization routines will take the\n                 * difference from other bands. in case of strong tonal samples\n                 * (tonaltest.wav) this leads to heavy distortions. that's why\n                 * we limit THR here.\n                 */\n                x = max[b];\n                x *= gfc.minval_l[b];\n                x *= avg_mask;\n                if (thr[b] > x) {\n                    thr[b] = x;\n                }\n            }\n            if (gfc.masking_lower > 1) {\n                thr[b] *= gfc.masking_lower;\n            }\n            if (thr[b] > eb_l[b]) {\n                thr[b] = eb_l[b];\n            }\n            if (gfc.masking_lower < 1) {\n                thr[b] *= gfc.masking_lower;\n            }\n        }\n        for (; b < Encoder.CBANDS; ++b) {\n            eb_l[b] = 0;\n            thr[b] = 0;\n        }\n    }\n\n    function vbrpsy_compute_block_type(gfp, uselongblock) {\n        var gfc = gfp.internal_flags;\n\n        if (gfp.short_blocks == ShortBlock.short_block_coupled\n                /* force both channels to use the same block type */\n                /* this is necessary if the frame is to be encoded in ms_stereo. */\n                /* But even without ms_stereo, FhG does this */\n            && !(uselongblock[0] != 0 && uselongblock[1] != 0))\n            uselongblock[0] = uselongblock[1] = 0;\n\n        for (var chn = 0; chn < gfc.channels_out; chn++) {\n            /* disable short blocks */\n            if (gfp.short_blocks == ShortBlock.short_block_dispensed) {\n                uselongblock[chn] = 1;\n            }\n            if (gfp.short_blocks == ShortBlock.short_block_forced) {\n                uselongblock[chn] = 0;\n            }\n        }\n    }\n\n    function vbrpsy_apply_block_type(gfp, uselongblock, blocktype_d) {\n        var gfc = gfp.internal_flags;\n\n        /*\n         * update the blocktype of the previous granule, since it depends on\n         * what happend in this granule\n         */\n        for (var chn = 0; chn < gfc.channels_out; chn++) {\n            var blocktype = Encoder.NORM_TYPE;\n            /* disable short blocks */\n\n            if (uselongblock[chn] != 0) {\n                /* no attack : use long blocks */\n                if (gfc.blocktype_old[chn] == Encoder.SHORT_TYPE)\n                    blocktype = Encoder.STOP_TYPE;\n            } else {\n                /* attack : use short blocks */\n                blocktype = Encoder.SHORT_TYPE;\n                if (gfc.blocktype_old[chn] == Encoder.NORM_TYPE) {\n                    gfc.blocktype_old[chn] = Encoder.START_TYPE;\n                }\n                if (gfc.blocktype_old[chn] == Encoder.STOP_TYPE)\n                    gfc.blocktype_old[chn] = Encoder.SHORT_TYPE;\n            }\n\n            blocktype_d[chn] = gfc.blocktype_old[chn];\n            // value returned to calling program\n            gfc.blocktype_old[chn] = blocktype;\n            // save for next call to l3psy_anal\n        }\n    }\n\n    /**\n     * compute M/S thresholds from Johnston & Ferreira 1992 ICASSP paper\n     */\n    function vbrpsy_compute_MS_thresholds(eb, thr, cb_mld, ath_cb, athadjust, msfix, n) {\n        var msfix2 = msfix * 2;\n        var athlower = msfix > 0 ? Math.pow(10, athadjust) : 1;\n        var rside, rmid;\n        for (var b = 0; b < n; ++b) {\n            var ebM = eb[2][b];\n            var ebS = eb[3][b];\n            var thmL = thr[0][b];\n            var thmR = thr[1][b];\n            var thmM = thr[2][b];\n            var thmS = thr[3][b];\n\n            /* use this fix if L & R masking differs by 2db or less */\n            if (thmL <= 1.58 * thmR && thmR <= 1.58 * thmL) {\n                var mld_m = cb_mld[b] * ebS;\n                var mld_s = cb_mld[b] * ebM;\n                rmid = Math.max(thmM, Math.min(thmS, mld_m));\n                rside = Math.max(thmS, Math.min(thmM, mld_s));\n            } else {\n                rmid = thmM;\n                rside = thmS;\n            }\n            if (msfix > 0) {\n                /***************************************************************/\n                /* Adjust M/S maskings if user set \"msfix\" */\n                /***************************************************************/\n                /* Naoki Shibata 2000 */\n                var thmLR, thmMS;\n                var ath = ath_cb[b] * athlower;\n                thmLR = Math.min(Math.max(thmL, ath), Math.max(thmR, ath));\n                thmM = Math.max(rmid, ath);\n                thmS = Math.max(rside, ath);\n                thmMS = thmM + thmS;\n                if (thmMS > 0 && (thmLR * msfix2) < thmMS) {\n                    var f = thmLR * msfix2 / thmMS;\n                    thmM *= f;\n                    thmS *= f;\n                }\n                rmid = Math.min(thmM, rmid);\n                rside = Math.min(thmS, rside);\n            }\n            if (rmid > ebM) {\n                rmid = ebM;\n            }\n            if (rside > ebS) {\n                rside = ebS;\n            }\n            thr[2][b] = rmid;\n            thr[3][b] = rside;\n        }\n    }\n\n    this.L3psycho_anal_vbr = function (gfp, buffer, bufPos, gr_out, masking_ratio, masking_MS_ratio, percep_entropy, percep_MS_entropy, energy, blocktype_d) {\n        var gfc = gfp.internal_flags;\n\n        /* fft and energy calculation */\n        var wsamp_l;\n        var wsamp_s;\n        var fftenergy = new_float(Encoder.HBLKSIZE);\n        var fftenergy_s = new_float_n([3, Encoder.HBLKSIZE_s]);\n        var wsamp_L = new_float_n([2, Encoder.BLKSIZE]);\n        var wsamp_S = new_float_n([2, 3, Encoder.BLKSIZE_s]);\n        var eb = new_float_n([4, Encoder.CBANDS]), thr = new_float_n([4, Encoder.CBANDS]);\n        var sub_short_factor = new_float_n([4, 3]);\n        var pcfact = 0.6;\n\n        /* block type */\n        var ns_attacks = [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0],\n            [0, 0, 0, 0]];\n        var uselongblock = new_int(2);\n\n        /* usual variables like loop indices, etc.. */\n\n        /* chn=2 and 3 = Mid and Side channels */\n        var n_chn_psy = (gfp.mode == MPEGMode.JOINT_STEREO) ? 4\n            : gfc.channels_out;\n\n        vbrpsy_attack_detection(gfp, buffer, bufPos, gr_out, masking_ratio,\n            masking_MS_ratio, energy, sub_short_factor, ns_attacks,\n            uselongblock);\n\n        vbrpsy_compute_block_type(gfp, uselongblock);\n\n        /* LONG BLOCK CASE */\n        {\n            for (var chn = 0; chn < n_chn_psy; chn++) {\n                var ch01 = chn & 0x01;\n                wsamp_l = wsamp_L;\n                vbrpsy_compute_fft_l(gfp, buffer, bufPos, chn, gr_out,\n                    fftenergy, wsamp_l, ch01);\n\n                vbrpsy_compute_loudness_approximation_l(gfp, gr_out, chn,\n                    fftenergy);\n\n                if (uselongblock[ch01] != 0) {\n                    vbrpsy_compute_masking_l(gfc, fftenergy, eb[chn], thr[chn],\n                        chn);\n                } else {\n                    vbrpsy_skip_masking_l(gfc, chn);\n                }\n            }\n            if ((uselongblock[0] + uselongblock[1]) == 2) {\n                /* M/S channel */\n                if (gfp.mode == MPEGMode.JOINT_STEREO) {\n                    vbrpsy_compute_MS_thresholds(eb, thr, gfc.mld_cb_l,\n                        gfc.ATH.cb_l, gfp.ATHlower * gfc.ATH.adjust,\n                        gfp.msfix, gfc.npart_l);\n                }\n            }\n            /* TODO: apply adaptive ATH masking here ?? */\n            for (var chn = 0; chn < n_chn_psy; chn++) {\n                var ch01 = chn & 0x01;\n                if (uselongblock[ch01] != 0) {\n                    convert_partition2scalefac_l(gfc, eb[chn], thr[chn], chn);\n                }\n            }\n        }\n\n        /* SHORT BLOCKS CASE */\n        {\n            for (var sblock = 0; sblock < 3; sblock++) {\n                for (var chn = 0; chn < n_chn_psy; ++chn) {\n                    var ch01 = chn & 0x01;\n\n                    if (uselongblock[ch01] != 0) {\n                        vbrpsy_skip_masking_s(gfc, chn, sblock);\n                    } else {\n                        /* compute masking thresholds for short blocks */\n                        wsamp_s = wsamp_S;\n                        vbrpsy_compute_fft_s(gfp, buffer, bufPos, chn, sblock,\n                            fftenergy_s, wsamp_s, ch01);\n                        vbrpsy_compute_masking_s(gfp, fftenergy_s, eb[chn],\n                            thr[chn], chn, sblock);\n                    }\n                }\n                if ((uselongblock[0] + uselongblock[1]) == 0) {\n                    /* M/S channel */\n                    if (gfp.mode == MPEGMode.JOINT_STEREO) {\n                        vbrpsy_compute_MS_thresholds(eb, thr, gfc.mld_cb_s,\n                            gfc.ATH.cb_s, gfp.ATHlower * gfc.ATH.adjust,\n                            gfp.msfix, gfc.npart_s);\n                    }\n                    /* L/R channel */\n                }\n                /* TODO: apply adaptive ATH masking here ?? */\n                for (var chn = 0; chn < n_chn_psy; ++chn) {\n                    var ch01 = chn & 0x01;\n                    if (0 == uselongblock[ch01]) {\n                        convert_partition2scalefac_s(gfc, eb[chn], thr[chn],\n                            chn, sblock);\n                    }\n                }\n            }\n\n            /**** short block pre-echo control ****/\n            for (var chn = 0; chn < n_chn_psy; chn++) {\n                var ch01 = chn & 0x01;\n\n                if (uselongblock[ch01] != 0) {\n                    continue;\n                }\n                for (var sb = 0; sb < Encoder.SBMAX_s; sb++) {\n                    var new_thmm = new_float(3);\n                    for (var sblock = 0; sblock < 3; sblock++) {\n                        var thmm = gfc.thm[chn].s[sb][sblock];\n                        thmm *= NS_PREECHO_ATT0;\n\n                        if (ns_attacks[chn][sblock] >= 2\n                            || ns_attacks[chn][sblock + 1] == 1) {\n                            var idx = (sblock != 0) ? sblock - 1 : 2;\n                            var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                                NS_PREECHO_ATT1 * pcfact);\n                            thmm = Math.min(thmm, p);\n                        } else if (ns_attacks[chn][sblock] == 1) {\n                            var idx = (sblock != 0) ? sblock - 1 : 2;\n                            var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                                NS_PREECHO_ATT2 * pcfact);\n                            thmm = Math.min(thmm, p);\n                        } else if ((sblock != 0 && ns_attacks[chn][sblock - 1] == 3)\n                            || (sblock == 0 && gfc.nsPsy.lastAttacks[chn] == 3)) {\n                            var idx = (sblock != 2) ? sblock + 1 : 0;\n                            var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                                NS_PREECHO_ATT2 * pcfact);\n                            thmm = Math.min(thmm, p);\n                        }\n\n                        /* pulse like signal detection for fatboy.wav and so on */\n                        thmm *= sub_short_factor[chn][sblock];\n\n                        new_thmm[sblock] = thmm;\n                    }\n                    for (var sblock = 0; sblock < 3; sblock++) {\n                        gfc.thm[chn].s[sb][sblock] = new_thmm[sblock];\n                    }\n                }\n            }\n        }\n        for (var chn = 0; chn < n_chn_psy; chn++) {\n            gfc.nsPsy.lastAttacks[chn] = ns_attacks[chn][2];\n        }\n\n        /***************************************************************\n         * determine final block type\n         ***************************************************************/\n        vbrpsy_apply_block_type(gfp, uselongblock, blocktype_d);\n\n        /*********************************************************************\n         * compute the value of PE to return ... no delay and advance\n         *********************************************************************/\n        for (var chn = 0; chn < n_chn_psy; chn++) {\n            var ppe;\n            var ppePos;\n            var type;\n            var mr;\n\n            if (chn > 1) {\n                ppe = percep_MS_entropy;\n                ppePos = -2;\n                type = Encoder.NORM_TYPE;\n                if (blocktype_d[0] == Encoder.SHORT_TYPE\n                    || blocktype_d[1] == Encoder.SHORT_TYPE)\n                    type = Encoder.SHORT_TYPE;\n                mr = masking_MS_ratio[gr_out][chn - 2];\n            } else {\n                ppe = percep_entropy;\n                ppePos = 0;\n                type = blocktype_d[chn];\n                mr = masking_ratio[gr_out][chn];\n            }\n\n            if (type == Encoder.SHORT_TYPE) {\n                ppe[ppePos + chn] = pecalc_s(mr, gfc.masking_lower);\n            } else {\n                ppe[ppePos + chn] = pecalc_l(mr, gfc.masking_lower);\n            }\n\n            if (gfp.analysis) {\n                gfc.pinfo.pe[gr_out][chn] = ppe[ppePos + chn];\n            }\n        }\n        return 0;\n    }\n\n    function s3_func_x(bark, hf_slope) {\n        var tempx = bark, tempy;\n\n        if (tempx >= 0) {\n            tempy = -tempx * 27;\n        } else {\n            tempy = tempx * hf_slope;\n        }\n        if (tempy <= -72.0) {\n            return 0;\n        }\n        return Math.exp(tempy * LN_TO_LOG10);\n    }\n\n    function norm_s3_func_x(hf_slope) {\n        var lim_a = 0, lim_b = 0;\n        {\n            var x = 0, l, h;\n            for (x = 0; s3_func_x(x, hf_slope) > 1e-20; x -= 1)\n                ;\n            l = x;\n            h = 0;\n            while (Math.abs(h - l) > 1e-12) {\n                x = (h + l) / 2;\n                if (s3_func_x(x, hf_slope) > 0) {\n                    h = x;\n                } else {\n                    l = x;\n                }\n            }\n            lim_a = l;\n        }\n        {\n            var x = 0, l, h;\n            for (x = 0; s3_func_x(x, hf_slope) > 1e-20; x += 1)\n                ;\n            l = 0;\n            h = x;\n            while (Math.abs(h - l) > 1e-12) {\n                x = (h + l) / 2;\n                if (s3_func_x(x, hf_slope) > 0) {\n                    l = x;\n                } else {\n                    h = x;\n                }\n            }\n            lim_b = h;\n        }\n        {\n            var sum = 0;\n            var m = 1000;\n            var i;\n            for (i = 0; i <= m; ++i) {\n                var x = lim_a + i * (lim_b - lim_a) / m;\n                var y = s3_func_x(x, hf_slope);\n                sum += y;\n            }\n            {\n                var norm = (m + 1) / (sum * (lim_b - lim_a));\n                /* printf( \"norm = %lf\\n\",norm); */\n                return norm;\n            }\n        }\n    }\n\n    /**\n     *   The spreading function.  Values returned in units of energy\n     */\n    function s3_func(bark) {\n        var tempx, x, tempy, temp;\n        tempx = bark;\n        if (tempx >= 0)\n            tempx *= 3;\n        else\n            tempx *= 1.5;\n\n        if (tempx >= 0.5 && tempx <= 2.5) {\n            temp = tempx - 0.5;\n            x = 8.0 * (temp * temp - 2.0 * temp);\n        } else\n            x = 0.0;\n        tempx += 0.474;\n        tempy = 15.811389 + 7.5 * tempx - 17.5\n            * Math.sqrt(1.0 + tempx * tempx);\n\n        if (tempy <= -60.0)\n            return 0.0;\n\n        tempx = Math.exp((x + tempy) * LN_TO_LOG10);\n\n        /**\n         * <PRE>\n         * Normalization.  The spreading function should be normalized so that:\n         * +inf\n         * /\n         * |  s3 [ bark ]  d(bark)   =  1\n         * /\n         * -inf\n         * </PRE>\n         */\n        tempx /= .6609193;\n        return tempx;\n    }\n\n    /**\n     * see for example \"Zwicker: Psychoakustik, 1982; ISBN 3-540-11401-7\n     */\n    function freq2bark(freq) {\n        /* input: freq in hz output: barks */\n        if (freq < 0)\n            freq = 0;\n        freq = freq * 0.001;\n        return 13.0 * Math.atan(.76 * freq) + 3.5\n            * Math.atan(freq * freq / (7.5 * 7.5));\n    }\n\n    function init_numline(numlines, bo, bm, bval, bval_width, mld, bo_w, sfreq, blksize, scalepos, deltafreq, sbmax) {\n        var b_frq = new_float(Encoder.CBANDS + 1);\n        var sample_freq_frac = sfreq / (sbmax > 15 ? 2 * 576 : 2 * 192);\n        var partition = new_int(Encoder.HBLKSIZE);\n        var i;\n        sfreq /= blksize;\n        var j = 0;\n        var ni = 0;\n        /* compute numlines, the number of spectral lines in each partition band */\n        /* each partition band should be about DELBARK wide. */\n        for (i = 0; i < Encoder.CBANDS; i++) {\n            var bark1;\n            var j2;\n            bark1 = freq2bark(sfreq * j);\n\n            b_frq[i] = sfreq * j;\n\n            for (j2 = j; freq2bark(sfreq * j2) - bark1 < DELBARK\n            && j2 <= blksize / 2; j2++)\n                ;\n\n            numlines[i] = j2 - j;\n            ni = i + 1;\n\n            while (j < j2) {\n                partition[j++] = i;\n            }\n            if (j > blksize / 2) {\n                j = blksize / 2;\n                ++i;\n                break;\n            }\n        }\n        b_frq[i] = sfreq * j;\n\n        for (var sfb = 0; sfb < sbmax; sfb++) {\n            var i1, i2, start, end;\n            var arg;\n            start = scalepos[sfb];\n            end = scalepos[sfb + 1];\n\n            i1 = 0 | Math.floor(.5 + deltafreq * (start - .5));\n            if (i1 < 0)\n                i1 = 0;\n            i2 = 0 | Math.floor(.5 + deltafreq * (end - .5));\n\n            if (i2 > blksize / 2)\n                i2 = blksize / 2;\n\n            bm[sfb] = (partition[i1] + partition[i2]) / 2;\n            bo[sfb] = partition[i2];\n            var f_tmp = sample_freq_frac * end;\n            /*\n             * calculate how much of this band belongs to current scalefactor\n             * band\n             */\n            bo_w[sfb] = (f_tmp - b_frq[bo[sfb]])\n                / (b_frq[bo[sfb] + 1] - b_frq[bo[sfb]]);\n            if (bo_w[sfb] < 0) {\n                bo_w[sfb] = 0;\n            } else {\n                if (bo_w[sfb] > 1) {\n                    bo_w[sfb] = 1;\n                }\n            }\n            /* setup stereo demasking thresholds */\n            /* formula reverse enginerred from plot in paper */\n            arg = freq2bark(sfreq * scalepos[sfb] * deltafreq);\n            arg = ( Math.min(arg, 15.5) / 15.5);\n\n            mld[sfb] = Math.pow(10.0,\n                1.25 * (1 - Math.cos(Math.PI * arg)) - 2.5);\n        }\n\n        /* compute bark values of each critical band */\n        j = 0;\n        for (var k = 0; k < ni; k++) {\n            var w = numlines[k];\n            var bark1, bark2;\n\n            bark1 = freq2bark(sfreq * (j));\n            bark2 = freq2bark(sfreq * (j + w - 1));\n            bval[k] = .5 * (bark1 + bark2);\n\n            bark1 = freq2bark(sfreq * (j - .5));\n            bark2 = freq2bark(sfreq * (j + w - .5));\n            bval_width[k] = bark2 - bark1;\n            j += w;\n        }\n\n        return ni;\n    }\n\n    function init_s3_values(s3ind, npart, bval, bval_width, norm, use_old_s3) {\n        var s3 = new_float_n([Encoder.CBANDS, Encoder.CBANDS]);\n        /*\n         * The s3 array is not linear in the bark scale.\n         *\n         * bval[x] should be used to get the bark value.\n         */\n        var j;\n        var numberOfNoneZero = 0;\n\n        /**\n         * <PRE>\n         * s[i][j], the value of the spreading function,\n         * centered at band j (masker), for band i (maskee)\n         *\n         * i.e.: sum over j to spread into signal barkval=i\n         * NOTE: i and j are used opposite as in the ISO docs\n         * </PRE>\n         */\n        if (use_old_s3) {\n            for (var i = 0; i < npart; i++) {\n                for (j = 0; j < npart; j++) {\n                    var v = s3_func(bval[i] - bval[j]) * bval_width[j];\n                    s3[i][j] = v * norm[i];\n                }\n            }\n        } else {\n            for (j = 0; j < npart; j++) {\n                var hf_slope = 15 + Math.min(21 / bval[j], 12);\n                var s3_x_norm = norm_s3_func_x(hf_slope);\n                for (var i = 0; i < npart; i++) {\n                    var v = s3_x_norm\n                        * s3_func_x(bval[i] - bval[j], hf_slope)\n                        * bval_width[j];\n                    s3[i][j] = v * norm[i];\n                }\n            }\n        }\n        for (var i = 0; i < npart; i++) {\n            for (j = 0; j < npart; j++) {\n                if (s3[i][j] > 0.0)\n                    break;\n            }\n            s3ind[i][0] = j;\n\n            for (j = npart - 1; j > 0; j--) {\n                if (s3[i][j] > 0.0)\n                    break;\n            }\n            s3ind[i][1] = j;\n            numberOfNoneZero += (s3ind[i][1] - s3ind[i][0] + 1);\n        }\n\n        var p = new_float(numberOfNoneZero);\n        var k = 0;\n        for (var i = 0; i < npart; i++)\n            for (j = s3ind[i][0]; j <= s3ind[i][1]; j++)\n                p[k++] = s3[i][j];\n\n        return p;\n    }\n\n    function stereo_demask(f) {\n        /* setup stereo demasking thresholds */\n        /* formula reverse enginerred from plot in paper */\n        var arg = freq2bark(f);\n        arg = (Math.min(arg, 15.5) / 15.5);\n\n        return Math.pow(10.0,\n            1.25 * (1 - Math.cos(Math.PI * arg)) - 2.5);\n    }\n\n    /**\n     * NOTE: the bitrate reduction from the inter-channel masking effect is low\n     * compared to the chance of getting annyoing artefacts. L3psycho_anal_vbr\n     * does not use this feature. (Robert 071216)\n     */\n    this.psymodel_init = function (gfp) {\n        var gfc = gfp.internal_flags;\n        var i;\n        var useOldS3 = true;\n        var bvl_a = 13, bvl_b = 24;\n        var snr_l_a = 0, snr_l_b = 0;\n        var snr_s_a = -8.25, snr_s_b = -4.5;\n        var bval = new_float(Encoder.CBANDS);\n        var bval_width = new_float(Encoder.CBANDS);\n        var norm = new_float(Encoder.CBANDS);\n        var sfreq = gfp.out_samplerate;\n\n        switch (gfp.experimentalZ) {\n            default:\n            case 0:\n                useOldS3 = true;\n                break;\n            case 1:\n                useOldS3 = (gfp.VBR == VbrMode.vbr_mtrh || gfp.VBR == VbrMode.vbr_mt) ? false\n                    : true;\n                break;\n            case 2:\n                useOldS3 = false;\n                break;\n            case 3:\n                bvl_a = 8;\n                snr_l_a = -1.75;\n                snr_l_b = -0.0125;\n                snr_s_a = -8.25;\n                snr_s_b = -2.25;\n                break;\n        }\n        gfc.ms_ener_ratio_old = .25;\n        gfc.blocktype_old[0] = gfc.blocktype_old[1] = Encoder.NORM_TYPE;\n        // the vbr header is long blocks\n\n        for (i = 0; i < 4; ++i) {\n            for (var j = 0; j < Encoder.CBANDS; ++j) {\n                gfc.nb_1[i][j] = 1e20;\n                gfc.nb_2[i][j] = 1e20;\n                gfc.nb_s1[i][j] = gfc.nb_s2[i][j] = 1.0;\n            }\n            for (var sb = 0; sb < Encoder.SBMAX_l; sb++) {\n                gfc.en[i].l[sb] = 1e20;\n                gfc.thm[i].l[sb] = 1e20;\n            }\n            for (var j = 0; j < 3; ++j) {\n                for (var sb = 0; sb < Encoder.SBMAX_s; sb++) {\n                    gfc.en[i].s[sb][j] = 1e20;\n                    gfc.thm[i].s[sb][j] = 1e20;\n                }\n                gfc.nsPsy.lastAttacks[i] = 0;\n            }\n            for (var j = 0; j < 9; j++)\n                gfc.nsPsy.last_en_subshort[i][j] = 10.;\n        }\n\n        /* init. for loudness approx. -jd 2001 mar 27 */\n        gfc.loudness_sq_save[0] = gfc.loudness_sq_save[1] = 0.0;\n\n        /*************************************************************************\n         * now compute the psychoacoustic model specific constants\n         ************************************************************************/\n        /* compute numlines, bo, bm, bval, bval_width, mld */\n\n        gfc.npart_l = init_numline(gfc.numlines_l, gfc.bo_l, gfc.bm_l, bval,\n            bval_width, gfc.mld_l, gfc.PSY.bo_l_weight, sfreq,\n            Encoder.BLKSIZE, gfc.scalefac_band.l, Encoder.BLKSIZE\n            / (2.0 * 576), Encoder.SBMAX_l);\n        /* compute the spreading function */\n        for (i = 0; i < gfc.npart_l; i++) {\n            var snr = snr_l_a;\n            if (bval[i] >= bvl_a) {\n                snr = snr_l_b * (bval[i] - bvl_a) / (bvl_b - bvl_a) + snr_l_a\n                    * (bvl_b - bval[i]) / (bvl_b - bvl_a);\n            }\n            norm[i] = Math.pow(10.0, snr / 10.0);\n            if (gfc.numlines_l[i] > 0) {\n                gfc.rnumlines_l[i] = 1.0 / gfc.numlines_l[i];\n            } else {\n                gfc.rnumlines_l[i] = 0;\n            }\n        }\n        gfc.s3_ll = init_s3_values(gfc.s3ind, gfc.npart_l, bval, bval_width,\n            norm, useOldS3);\n\n        /* compute long block specific values, ATH and MINVAL */\n        var j = 0;\n        for (i = 0; i < gfc.npart_l; i++) {\n            var x;\n\n            /* ATH */\n            x = Float.MAX_VALUE;\n            for (var k = 0; k < gfc.numlines_l[i]; k++, j++) {\n                var freq = sfreq * j / (1000.0 * Encoder.BLKSIZE);\n                var level;\n                /*\n                 * ATH below 100 Hz constant, not further climbing\n                 */\n                level = this.ATHformula(freq * 1000, gfp) - 20;\n                // scale to FFT units; returned value is in dB\n                level = Math.pow(10., 0.1 * level);\n                // convert from dB . energy\n                level *= gfc.numlines_l[i];\n                if (x > level)\n                    x = level;\n            }\n            gfc.ATH.cb_l[i] = x;\n\n            /*\n             * MINVAL. For low freq, the strength of the masking is limited by\n             * minval this is an ISO MPEG1 thing, dont know if it is really\n             * needed\n             */\n            /*\n             * FIXME: it does work to reduce low-freq problems in S53-Wind-Sax\n             * and lead-voice samples, but introduces some 3 kbps bit bloat too.\n             * TODO: Further refinement of the shape of this hack.\n             */\n            x = -20 + bval[i] * 20 / 10;\n            if (x > 6) {\n                x = 100;\n            }\n            if (x < -15) {\n                x = -15;\n            }\n            x -= 8.;\n            gfc.minval_l[i] = (Math.pow(10.0, x / 10.) * gfc.numlines_l[i]);\n        }\n\n        /************************************************************************\n         * do the same things for short blocks\n         ************************************************************************/\n        gfc.npart_s = init_numline(gfc.numlines_s, gfc.bo_s, gfc.bm_s, bval,\n            bval_width, gfc.mld_s, gfc.PSY.bo_s_weight, sfreq,\n            Encoder.BLKSIZE_s, gfc.scalefac_band.s, Encoder.BLKSIZE_s\n            / (2.0 * 192), Encoder.SBMAX_s);\n\n        /* SNR formula. short block is normalized by SNR. is it still right ? */\n        j = 0;\n        for (i = 0; i < gfc.npart_s; i++) {\n            var x;\n            var snr = snr_s_a;\n            if (bval[i] >= bvl_a) {\n                snr = snr_s_b * (bval[i] - bvl_a) / (bvl_b - bvl_a) + snr_s_a\n                    * (bvl_b - bval[i]) / (bvl_b - bvl_a);\n            }\n            norm[i] = Math.pow(10.0, snr / 10.0);\n\n            /* ATH */\n            x = Float.MAX_VALUE;\n            for (var k = 0; k < gfc.numlines_s[i]; k++, j++) {\n                var freq = sfreq * j / (1000.0 * Encoder.BLKSIZE_s);\n                var level;\n                /* freq = Min(.1,freq); */\n                /*\n                 * ATH below 100 Hz constant, not\n                 * further climbing\n                 */\n                level = this.ATHformula(freq * 1000, gfp) - 20;\n                // scale to FFT units; returned value is in dB\n                level = Math.pow(10., 0.1 * level);\n                // convert from dB . energy\n                level *= gfc.numlines_s[i];\n                if (x > level)\n                    x = level;\n            }\n            gfc.ATH.cb_s[i] = x;\n\n            /*\n             * MINVAL. For low freq, the strength of the masking is limited by\n             * minval this is an ISO MPEG1 thing, dont know if it is really\n             * needed\n             */\n            x = (-7.0 + bval[i] * 7.0 / 12.0);\n            if (bval[i] > 12) {\n                x *= 1 + Math.log(1 + x) * 3.1;\n            }\n            if (bval[i] < 12) {\n                x *= 1 + Math.log(1 - x) * 2.3;\n            }\n            if (x < -15) {\n                x = -15;\n            }\n            x -= 8;\n            gfc.minval_s[i] = Math.pow(10.0, x / 10)\n                * gfc.numlines_s[i];\n        }\n\n        gfc.s3_ss = init_s3_values(gfc.s3ind_s, gfc.npart_s, bval, bval_width,\n            norm, useOldS3);\n\n        init_mask_add_max_values();\n        fft.init_fft(gfc);\n\n        /* setup temporal masking */\n        gfc.decay = Math.exp(-1.0 * LOG10\n            / (temporalmask_sustain_sec * sfreq / 192.0));\n\n        {\n            var msfix;\n            msfix = NS_MSFIX;\n            if ((gfp.exp_nspsytune & 2) != 0)\n                msfix = 1.0;\n            if (Math.abs(gfp.msfix) > 0.0)\n                msfix = gfp.msfix;\n            gfp.msfix = msfix;\n\n            /*\n             * spread only from npart_l bands. Normally, we use the spreading\n             * function to convolve from npart_l down to npart_l bands\n             */\n            for (var b = 0; b < gfc.npart_l; b++)\n                if (gfc.s3ind[b][1] > gfc.npart_l - 1)\n                    gfc.s3ind[b][1] = gfc.npart_l - 1;\n        }\n\n        /*\n         * prepare for ATH auto adjustment: we want to decrease the ATH by 12 dB\n         * per second\n         */\n        var frame_duration = (576. * gfc.mode_gr / sfreq);\n        gfc.ATH.decay = Math.pow(10., -12. / 10. * frame_duration);\n        gfc.ATH.adjust = 0.01;\n        /* minimum, for leading low loudness */\n        gfc.ATH.adjustLimit = 1.0;\n        /* on lead, allow adjust up to maximum */\n\n\n        if (gfp.ATHtype != -1) {\n            /* compute equal loudness weights (eql_w) */\n            var freq;\n            var freq_inc = gfp.out_samplerate\n                / (Encoder.BLKSIZE);\n            var eql_balance = 0.0;\n            freq = 0.0;\n            for (i = 0; i < Encoder.BLKSIZE / 2; ++i) {\n                /* convert ATH dB to relative power (not dB) */\n                /* to determine eql_w */\n                freq += freq_inc;\n                gfc.ATH.eql_w[i] = 1. / Math.pow(10, this.ATHformula(freq, gfp) / 10);\n                eql_balance += gfc.ATH.eql_w[i];\n            }\n            eql_balance = 1.0 / eql_balance;\n            for (i = Encoder.BLKSIZE / 2; --i >= 0;) { /* scale weights */\n                gfc.ATH.eql_w[i] *= eql_balance;\n            }\n        }\n        {\n            for (var b = j = 0; b < gfc.npart_s; ++b) {\n                for (i = 0; i < gfc.numlines_s[b]; ++i) {\n                    ++j;\n                }\n            }\n            for (var b = j = 0; b < gfc.npart_l; ++b) {\n                for (i = 0; i < gfc.numlines_l[b]; ++i) {\n                    ++j;\n                }\n            }\n        }\n        j = 0;\n        for (i = 0; i < gfc.npart_l; i++) {\n            var freq = sfreq * (j + gfc.numlines_l[i] / 2) / (1.0 * Encoder.BLKSIZE);\n            gfc.mld_cb_l[i] = stereo_demask(freq);\n            j += gfc.numlines_l[i];\n        }\n        for (; i < Encoder.CBANDS; ++i) {\n            gfc.mld_cb_l[i] = 1;\n        }\n        j = 0;\n        for (i = 0; i < gfc.npart_s; i++) {\n            var freq = sfreq * (j + gfc.numlines_s[i] / 2) / (1.0 * Encoder.BLKSIZE_s);\n            gfc.mld_cb_s[i] = stereo_demask(freq);\n            j += gfc.numlines_s[i];\n        }\n        for (; i < Encoder.CBANDS; ++i) {\n            gfc.mld_cb_s[i] = 1;\n        }\n        return 0;\n    }\n\n    /**\n     * Those ATH formulas are returning their minimum value for input = -1\n     */\n    function ATHformula_GB(f, value) {\n        /**\n         * <PRE>\n         *  from Painter & Spanias\n         *           modified by Gabriel Bouvigne to better fit the reality\n         *           ath =    3.640 * pow(f,-0.8)\n         *           - 6.800 * exp(-0.6*pow(f-3.4,2.0))\n         *           + 6.000 * exp(-0.15*pow(f-8.7,2.0))\n         *           + 0.6* 0.001 * pow(f,4.0);\n         *\n         *\n         *           In the past LAME was using the Painter &Spanias formula.\n         *           But we had some recurrent problems with HF content.\n         *           We measured real ATH values, and found the older formula\n         *           to be inaccurate in the higher part. So we made this new\n         *           formula and this solved most of HF problematic test cases.\n         *           The tradeoff is that in VBR mode it increases a lot the\n         *           bitrate.\n         * </PRE>\n         */\n\n        /*\n         * This curve can be adjusted according to the VBR scale: it adjusts\n         * from something close to Painter & Spanias on V9 up to Bouvigne's\n         * formula for V0. This way the VBR bitrate is more balanced according\n         * to the -V value.\n         */\n\n        // the following Hack allows to ask for the lowest value\n        if (f < -.3)\n            f = 3410;\n\n        // convert to khz\n        f /= 1000;\n        f = Math.max(0.1, f);\n        var ath = 3.640 * Math.pow(f, -0.8) - 6.800\n            * Math.exp(-0.6 * Math.pow(f - 3.4, 2.0)) + 6.000\n            * Math.exp(-0.15 * Math.pow(f - 8.7, 2.0))\n            + (0.6 + 0.04 * value) * 0.001 * Math.pow(f, 4.0);\n        return ath;\n    }\n\n    this.ATHformula = function (f, gfp) {\n        var ath;\n        switch (gfp.ATHtype) {\n            case 0:\n                ath = ATHformula_GB(f, 9);\n                break;\n            case 1:\n                // over sensitive, should probably be removed\n                ath = ATHformula_GB(f, -1);\n                break;\n            case 2:\n                ath = ATHformula_GB(f, 0);\n                break;\n            case 3:\n                // modification of GB formula by Roel\n                ath = ATHformula_GB(f, 1) + 6;\n                break;\n            case 4:\n                ath = ATHformula_GB(f, gfp.ATHcurve);\n                break;\n            default:\n                ath = ATHformula_GB(f, 0);\n                break;\n        }\n        return ath;\n    }\n\n}\n\n\n\nfunction Lame() {\n    var self = this;\n    var LAME_MAXALBUMART = (128 * 1024);\n\n    Lame.V9 = 410;\n    Lame.V8 = 420;\n    Lame.V7 = 430;\n    Lame.V6 = 440;\n    Lame.V5 = 450;\n    Lame.V4 = 460;\n    Lame.V3 = 470;\n    Lame.V2 = 480;\n    Lame.V1 = 490;\n    Lame.V0 = 500;\n\n    /* still there for compatibility */\n\n    Lame.R3MIX = 1000;\n    Lame.STANDARD = 1001;\n    Lame.EXTREME = 1002;\n    Lame.INSANE = 1003;\n    Lame.STANDARD_FAST = 1004;\n    Lame.EXTREME_FAST = 1005;\n    Lame.MEDIUM = 1006;\n    Lame.MEDIUM_FAST = 1007;\n\n    /**\n     * maximum size of mp3buffer needed if you encode at most 1152 samples for\n     * each call to lame_encode_buffer. see lame_encode_buffer() below\n     * (LAME_MAXMP3BUFFER is now obsolete)\n     */\n    var LAME_MAXMP3BUFFER = (16384 + LAME_MAXALBUMART);\n    Lame.LAME_MAXMP3BUFFER = LAME_MAXMP3BUFFER;\n\n    var ga;\n    var bs;\n    var p;\n    var qupvt;\n    var qu;\n    var psy = new PsyModel();\n    var vbr;\n    var ver;\n    var id3;\n    var mpglib;\n    this.enc = new Encoder();\n\n    this.setModules = function (_ga, _bs, _p, _qupvt, _qu, _vbr, _ver, _id3, _mpglib) {\n        ga = _ga;\n        bs = _bs;\n        p = _p;\n        qupvt = _qupvt;\n        qu = _qu;\n        vbr = _vbr;\n        ver = _ver;\n        id3 = _id3;\n        mpglib = _mpglib;\n        this.enc.setModules(bs, psy, qupvt, vbr);\n    }\n\n    /**\n     * PSY Model related stuff\n     */\n    function PSY() {\n        /**\n         * The dbQ stuff.\n         */\n        this.mask_adjust = 0.;\n        /**\n         * The dbQ stuff.\n         */\n        this.mask_adjust_short = 0.;\n        /* at transition from one scalefactor band to next */\n        /**\n         * Band weight long scalefactor bands.\n         */\n        this.bo_l_weight = new_float(Encoder.SBMAX_l);\n        /**\n         * Band weight short scalefactor bands.\n         */\n        this.bo_s_weight = new_float(Encoder.SBMAX_s);\n    }\n\n    function LowPassHighPass() {\n        this.lowerlimit = 0.;\n    }\n\n    function BandPass(bitrate, lPass) {\n        this.lowpass = lPass;\n    }\n\n    var LAME_ID = 0xFFF88E3B;\n\n    function lame_init_old(gfp) {\n        var gfc;\n\n        gfp.class_id = LAME_ID;\n\n        gfc = gfp.internal_flags = new LameInternalFlags();\n\n        /* Global flags. set defaults here for non-zero values */\n        /* see lame.h for description */\n        /*\n         * set integer values to -1 to mean that LAME will compute the best\n         * value, UNLESS the calling program as set it (and the value is no\n         * longer -1)\n         */\n\n        gfp.mode = MPEGMode.NOT_SET;\n        gfp.original = 1;\n        gfp.in_samplerate = 44100;\n        gfp.num_channels = 2;\n        gfp.num_samples = -1;\n\n        gfp.bWriteVbrTag = true;\n        gfp.quality = -1;\n        gfp.short_blocks = null;\n        gfc.subblock_gain = -1;\n\n        gfp.lowpassfreq = 0;\n        gfp.highpassfreq = 0;\n        gfp.lowpasswidth = -1;\n        gfp.highpasswidth = -1;\n\n        gfp.VBR = VbrMode.vbr_off;\n        gfp.VBR_q = 4;\n        gfp.ATHcurve = -1;\n        gfp.VBR_mean_bitrate_kbps = 128;\n        gfp.VBR_min_bitrate_kbps = 0;\n        gfp.VBR_max_bitrate_kbps = 0;\n        gfp.VBR_hard_min = 0;\n        gfc.VBR_min_bitrate = 1;\n        /* not 0 ????? */\n        gfc.VBR_max_bitrate = 13;\n        /* not 14 ????? */\n\n        gfp.quant_comp = -1;\n        gfp.quant_comp_short = -1;\n\n        gfp.msfix = -1;\n\n        gfc.resample_ratio = 1;\n\n        gfc.OldValue[0] = 180;\n        gfc.OldValue[1] = 180;\n        gfc.CurrentStep[0] = 4;\n        gfc.CurrentStep[1] = 4;\n        gfc.masking_lower = 1;\n        gfc.nsPsy.attackthre = -1;\n        gfc.nsPsy.attackthre_s = -1;\n\n        gfp.scale = -1;\n\n        gfp.athaa_type = -1;\n        gfp.ATHtype = -1;\n        /* default = -1 = set in lame_init_params */\n        gfp.athaa_loudapprox = -1;\n        /* 1 = flat loudness approx. (total energy) */\n        /* 2 = equal loudness curve */\n        gfp.athaa_sensitivity = 0.0;\n        /* no offset */\n        gfp.useTemporal = null;\n        gfp.interChRatio = -1;\n\n        /*\n         * The reason for int mf_samples_to_encode = ENCDELAY + POSTDELAY;\n         * ENCDELAY = internal encoder delay. And then we have to add\n         * POSTDELAY=288 because of the 50% MDCT overlap. A 576 MDCT granule\n         * decodes to 1152 samples. To synthesize the 576 samples centered under\n         * this granule we need the previous granule for the first 288 samples\n         * (no problem), and the next granule for the next 288 samples (not\n         * possible if this is last granule). So we need to pad with 288 samples\n         * to make sure we can encode the 576 samples we are interested in.\n         */\n        gfc.mf_samples_to_encode = Encoder.ENCDELAY + Encoder.POSTDELAY;\n        gfp.encoder_padding = 0;\n        gfc.mf_size = Encoder.ENCDELAY - Encoder.MDCTDELAY;\n        /*\n         * we pad input with this many 0's\n         */\n\n        gfp.findReplayGain = false;\n        gfp.decode_on_the_fly = false;\n\n        gfc.decode_on_the_fly = false;\n        gfc.findReplayGain = false;\n        gfc.findPeakSample = false;\n\n        gfc.RadioGain = 0;\n        gfc.AudiophileGain = 0;\n        gfc.noclipGainChange = 0;\n        gfc.noclipScale = -1.0;\n\n        gfp.preset = 0;\n\n        gfp.write_id3tag_automatic = true;\n        return 0;\n    }\n\n    this.lame_init = function () {\n        var gfp = new LameGlobalFlags();\n\n        var ret = lame_init_old(gfp);\n        if (ret != 0) {\n            return null;\n        }\n\n        gfp.lame_allocated_gfp = 1;\n        return gfp;\n    }\n\n    function filter_coef(x) {\n        if (x > 1.0)\n            return 0.0;\n        if (x <= 0.0)\n            return 1.0;\n\n        return Math.cos(Math.PI / 2 * x);\n    }\n\n    this.nearestBitrateFullIndex = function (bitrate) {\n        /* borrowed from DM abr presets */\n\n        var full_bitrate_table = [8, 16, 24, 32, 40, 48, 56, 64, 80,\n            96, 112, 128, 160, 192, 224, 256, 320];\n\n        var lower_range = 0, lower_range_kbps = 0, upper_range = 0, upper_range_kbps = 0;\n\n        /* We assume specified bitrate will be 320kbps */\n        upper_range_kbps = full_bitrate_table[16];\n        upper_range = 16;\n        lower_range_kbps = full_bitrate_table[16];\n        lower_range = 16;\n\n        /*\n         * Determine which significant bitrates the value specified falls\n         * between, if loop ends without breaking then we were correct above\n         * that the value was 320\n         */\n        for (var b = 0; b < 16; b++) {\n            if ((Math.max(bitrate, full_bitrate_table[b + 1])) != bitrate) {\n                upper_range_kbps = full_bitrate_table[b + 1];\n                upper_range = b + 1;\n                lower_range_kbps = full_bitrate_table[b];\n                lower_range = (b);\n                break;\n                /* We found upper range */\n            }\n        }\n\n        /* Determine which range the value specified is closer to */\n        if ((upper_range_kbps - bitrate) > (bitrate - lower_range_kbps)) {\n            return lower_range;\n        }\n        return upper_range;\n    }\n\n    function optimum_samplefreq(lowpassfreq, input_samplefreq) {\n        /*\n         * Rules:\n         *\n         * - if possible, sfb21 should NOT be used\n         */\n        var suggested_samplefreq = 44100;\n\n        if (input_samplefreq >= 48000)\n            suggested_samplefreq = 48000;\n        else if (input_samplefreq >= 44100)\n            suggested_samplefreq = 44100;\n        else if (input_samplefreq >= 32000)\n            suggested_samplefreq = 32000;\n        else if (input_samplefreq >= 24000)\n            suggested_samplefreq = 24000;\n        else if (input_samplefreq >= 22050)\n            suggested_samplefreq = 22050;\n        else if (input_samplefreq >= 16000)\n            suggested_samplefreq = 16000;\n        else if (input_samplefreq >= 12000)\n            suggested_samplefreq = 12000;\n        else if (input_samplefreq >= 11025)\n            suggested_samplefreq = 11025;\n        else if (input_samplefreq >= 8000)\n            suggested_samplefreq = 8000;\n\n        if (lowpassfreq == -1)\n            return suggested_samplefreq;\n\n        if (lowpassfreq <= 15960)\n            suggested_samplefreq = 44100;\n        if (lowpassfreq <= 15250)\n            suggested_samplefreq = 32000;\n        if (lowpassfreq <= 11220)\n            suggested_samplefreq = 24000;\n        if (lowpassfreq <= 9970)\n            suggested_samplefreq = 22050;\n        if (lowpassfreq <= 7230)\n            suggested_samplefreq = 16000;\n        if (lowpassfreq <= 5420)\n            suggested_samplefreq = 12000;\n        if (lowpassfreq <= 4510)\n            suggested_samplefreq = 11025;\n        if (lowpassfreq <= 3970)\n            suggested_samplefreq = 8000;\n\n        if (input_samplefreq < suggested_samplefreq) {\n            /*\n             * choose a valid MPEG sample frequency above the input sample\n             * frequency to avoid SFB21/12 bitrate bloat rh 061115\n             */\n            if (input_samplefreq > 44100) {\n                return 48000;\n            }\n            if (input_samplefreq > 32000) {\n                return 44100;\n            }\n            if (input_samplefreq > 24000) {\n                return 32000;\n            }\n            if (input_samplefreq > 22050) {\n                return 24000;\n            }\n            if (input_samplefreq > 16000) {\n                return 22050;\n            }\n            if (input_samplefreq > 12000) {\n                return 16000;\n            }\n            if (input_samplefreq > 11025) {\n                return 12000;\n            }\n            if (input_samplefreq > 8000) {\n                return 11025;\n            }\n            return 8000;\n        }\n        return suggested_samplefreq;\n    }\n\n    /**\n     * convert samp freq in Hz to index\n     */\n    function SmpFrqIndex(sample_freq, gpf) {\n        switch (sample_freq) {\n            case 44100:\n                gpf.version = 1;\n                return 0;\n            case 48000:\n                gpf.version = 1;\n                return 1;\n            case 32000:\n                gpf.version = 1;\n                return 2;\n            case 22050:\n                gpf.version = 0;\n                return 0;\n            case 24000:\n                gpf.version = 0;\n                return 1;\n            case 16000:\n                gpf.version = 0;\n                return 2;\n            case 11025:\n                gpf.version = 0;\n                return 0;\n            case 12000:\n                gpf.version = 0;\n                return 1;\n            case 8000:\n                gpf.version = 0;\n                return 2;\n            default:\n                gpf.version = 0;\n                return -1;\n        }\n    }\n\n    /**\n     * @param bRate\n     *            legal rates from 8 to 320\n     */\n    function FindNearestBitrate(bRate, version, samplerate) {\n        /* MPEG-1 or MPEG-2 LSF */\n        if (samplerate < 16000)\n            version = 2;\n\n        var bitrate = Tables.bitrate_table[version][1];\n\n        for (var i = 2; i <= 14; i++) {\n            if (Tables.bitrate_table[version][i] > 0) {\n                if (Math.abs(Tables.bitrate_table[version][i] - bRate) < Math\n                        .abs(bitrate - bRate))\n                    bitrate = Tables.bitrate_table[version][i];\n            }\n        }\n        return bitrate;\n    }\n\n    /**\n     * @param bRate\n     *            legal rates from 32 to 448 kbps\n     * @param version\n     *            MPEG-1 or MPEG-2/2.5 LSF\n     */\n    function BitrateIndex(bRate, version, samplerate) {\n        /* convert bitrate in kbps to index */\n        if (samplerate < 16000)\n            version = 2;\n        for (var i = 0; i <= 14; i++) {\n            if (Tables.bitrate_table[version][i] > 0) {\n                if (Tables.bitrate_table[version][i] == bRate) {\n                    return i;\n                }\n            }\n        }\n        return -1;\n    }\n\n    function optimum_bandwidth(lh, bitrate) {\n        /**\n         * <PRE>\n         *  Input:\n         *      bitrate     total bitrate in kbps\n         *\n         *   Output:\n         *      lowerlimit: best lowpass frequency limit for input filter in Hz\n         *      upperlimit: best highpass frequency limit for input filter in Hz\n         * </PRE>\n         */\n        var freq_map = [new BandPass(8, 2000),\n            new BandPass(16, 3700), new BandPass(24, 3900),\n            new BandPass(32, 5500), new BandPass(40, 7000),\n            new BandPass(48, 7500), new BandPass(56, 10000),\n            new BandPass(64, 11000), new BandPass(80, 13500),\n            new BandPass(96, 15100), new BandPass(112, 15600),\n            new BandPass(128, 17000), new BandPass(160, 17500),\n            new BandPass(192, 18600), new BandPass(224, 19400),\n            new BandPass(256, 19700), new BandPass(320, 20500)];\n\n        var table_index = self.nearestBitrateFullIndex(bitrate);\n        lh.lowerlimit = freq_map[table_index].lowpass;\n    }\n\n    function lame_init_params_ppflt(gfp) {\n        var gfc = gfp.internal_flags;\n        /***************************************************************/\n        /* compute info needed for polyphase filter (filter type==0, default) */\n        /***************************************************************/\n\n        var lowpass_band = 32;\n        var highpass_band = -1;\n\n        if (gfc.lowpass1 > 0) {\n            var minband = 999;\n            for (var band = 0; band <= 31; band++) {\n                var freq = (band / 31.0);\n                /* this band and above will be zeroed: */\n                if (freq >= gfc.lowpass2) {\n                    lowpass_band = Math.min(lowpass_band, band);\n                }\n                if (gfc.lowpass1 < freq && freq < gfc.lowpass2) {\n                    minband = Math.min(minband, band);\n                }\n            }\n\n            /*\n             * compute the *actual* transition band implemented by the polyphase\n             * filter\n             */\n            if (minband == 999) {\n                gfc.lowpass1 = (lowpass_band - .75) / 31.0;\n            } else {\n                gfc.lowpass1 = (minband - .75) / 31.0;\n            }\n            gfc.lowpass2 = lowpass_band / 31.0;\n        }\n\n        /*\n         * make sure highpass filter is within 90% of what the effective\n         * highpass frequency will be\n         */\n        if (gfc.highpass2 > 0) {\n            if (gfc.highpass2 < .9 * (.75 / 31.0)) {\n                gfc.highpass1 = 0;\n                gfc.highpass2 = 0;\n                System.err.println(\"Warning: highpass filter disabled.  \"\n                    + \"highpass frequency too small\\n\");\n            }\n        }\n\n        if (gfc.highpass2 > 0) {\n            var maxband = -1;\n            for (var band = 0; band <= 31; band++) {\n                var freq = band / 31.0;\n                /* this band and below will be zereod */\n                if (freq <= gfc.highpass1) {\n                    highpass_band = Math.max(highpass_band, band);\n                }\n                if (gfc.highpass1 < freq && freq < gfc.highpass2) {\n                    maxband = Math.max(maxband, band);\n                }\n            }\n            /*\n             * compute the *actual* transition band implemented by the polyphase\n             * filter\n             */\n            gfc.highpass1 = highpass_band / 31.0;\n            if (maxband == -1) {\n                gfc.highpass2 = (highpass_band + .75) / 31.0;\n            } else {\n                gfc.highpass2 = (maxband + .75) / 31.0;\n            }\n        }\n\n        for (var band = 0; band < 32; band++) {\n            var fc1, fc2;\n            var freq = band / 31.0;\n            if (gfc.highpass2 > gfc.highpass1) {\n                fc1 = filter_coef((gfc.highpass2 - freq)\n                    / (gfc.highpass2 - gfc.highpass1 + 1e-20));\n            } else {\n                fc1 = 1.0;\n            }\n            if (gfc.lowpass2 > gfc.lowpass1) {\n                fc2 = filter_coef((freq - gfc.lowpass1)\n                    / (gfc.lowpass2 - gfc.lowpass1 + 1e-20));\n            } else {\n                fc2 = 1.0;\n            }\n            gfc.amp_filter[band] = (fc1 * fc2);\n        }\n    }\n\n    function lame_init_qval(gfp) {\n        var gfc = gfp.internal_flags;\n\n        switch (gfp.quality) {\n            default:\n            case 9: /* no psymodel, no noise shaping */\n                gfc.psymodel = 0;\n                gfc.noise_shaping = 0;\n                gfc.noise_shaping_amp = 0;\n                gfc.noise_shaping_stop = 0;\n                gfc.use_best_huffman = 0;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 8:\n                gfp.quality = 7;\n            //$FALL-THROUGH$\n            case 7:\n                /*\n                 * use psymodel (for short block and m/s switching), but no noise\n                 * shapping\n                 */\n                gfc.psymodel = 1;\n                gfc.noise_shaping = 0;\n                gfc.noise_shaping_amp = 0;\n                gfc.noise_shaping_stop = 0;\n                gfc.use_best_huffman = 0;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 6:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                gfc.noise_shaping_amp = 0;\n                gfc.noise_shaping_stop = 0;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 0;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 5:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                gfc.noise_shaping_amp = 0;\n                gfc.noise_shaping_stop = 0;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 0;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 4:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                gfc.noise_shaping_amp = 0;\n                gfc.noise_shaping_stop = 0;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 1;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 3:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                gfc.noise_shaping_amp = 1;\n                gfc.noise_shaping_stop = 1;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 1;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 2:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                if (gfc.substep_shaping == 0)\n                    gfc.substep_shaping = 2;\n                gfc.noise_shaping_amp = 1;\n                gfc.noise_shaping_stop = 1;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 1;\n                /* inner loop */\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 1:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                if (gfc.substep_shaping == 0)\n                    gfc.substep_shaping = 2;\n                gfc.noise_shaping_amp = 2;\n                gfc.noise_shaping_stop = 1;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 1;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 0:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                if (gfc.substep_shaping == 0)\n                    gfc.substep_shaping = 2;\n                gfc.noise_shaping_amp = 2;\n                gfc.noise_shaping_stop = 1;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 1;\n                /*\n                 * type 2 disabled because of it slowness, in favor of full outer\n                 * loop search\n                 */\n                gfc.full_outer_loop = 0;\n                /*\n                 * full outer loop search disabled because of audible distortions it\n                 * may generate rh 060629\n                 */\n                break;\n        }\n\n    }\n\n    function lame_init_bitstream(gfp) {\n        var gfc = gfp.internal_flags;\n        gfp.frameNum = 0;\n\n        if (gfp.write_id3tag_automatic) {\n            id3.id3tag_write_v2(gfp);\n        }\n        /* initialize histogram data optionally used by frontend */\n\n        gfc.bitrate_stereoMode_Hist = new_int_n([16, 4 + 1]);\n        gfc.bitrate_blockType_Hist = new_int_n([16, 4 + 1 + 1]);\n\n        gfc.PeakSample = 0.0;\n\n        /* Write initial VBR Header to bitstream and init VBR data */\n        if (gfp.bWriteVbrTag)\n            vbr.InitVbrTag(gfp);\n    }\n\n    /********************************************************************\n     * initialize internal params based on data in gf (globalflags struct filled\n     * in by calling program)\n     *\n     * OUTLINE:\n     *\n     * We first have some complex code to determine bitrate, output samplerate\n     * and mode. It is complicated by the fact that we allow the user to set\n     * some or all of these parameters, and need to determine best possible\n     * values for the rest of them:\n     *\n     * 1. set some CPU related flags 2. check if we are mono.mono, stereo.mono\n     * or stereo.stereo 3. compute bitrate and output samplerate: user may have\n     * set compression ratio user may have set a bitrate user may have set a\n     * output samplerate 4. set some options which depend on output samplerate\n     * 5. compute the actual compression ratio 6. set mode based on compression\n     * ratio\n     *\n     * The remaining code is much simpler - it just sets options based on the\n     * mode & compression ratio:\n     *\n     * set allow_diff_short based on mode select lowpass filter based on\n     * compression ratio & mode set the bitrate index, and min/max bitrates for\n     * VBR modes disable VBR tag if it is not appropriate initialize the\n     * bitstream initialize scalefac_band data set sideinfo_len (based on\n     * channels, CRC, out_samplerate) write an id3v2 tag into the bitstream\n     * write VBR tag into the bitstream set mpeg1/2 flag estimate the number of\n     * frames (based on a lot of data)\n     *\n     * now we set more flags: nspsytune: see code VBR modes see code CBR/ABR see\n     * code\n     *\n     * Finally, we set the algorithm flags based on the gfp.quality value\n     * lame_init_qval(gfp);\n     *\n     ********************************************************************/\n    this.lame_init_params = function (gfp) {\n        var gfc = gfp.internal_flags;\n\n        gfc.Class_ID = 0;\n        if (gfc.ATH == null)\n            gfc.ATH = new ATH();\n        if (gfc.PSY == null)\n            gfc.PSY = new PSY();\n        if (gfc.rgdata == null)\n            gfc.rgdata = new ReplayGain();\n\n        gfc.channels_in = gfp.num_channels;\n        if (gfc.channels_in == 1)\n            gfp.mode = MPEGMode.MONO;\n        gfc.channels_out = (gfp.mode == MPEGMode.MONO) ? 1 : 2;\n        gfc.mode_ext = Encoder.MPG_MD_MS_LR;\n        if (gfp.mode == MPEGMode.MONO)\n            gfp.force_ms = false;\n        /*\n         * don't allow forced mid/side stereo for mono output\n         */\n\n        if (gfp.VBR == VbrMode.vbr_off && gfp.VBR_mean_bitrate_kbps != 128\n            && gfp.brate == 0)\n            gfp.brate = gfp.VBR_mean_bitrate_kbps;\n\n        if (gfp.VBR == VbrMode.vbr_off || gfp.VBR == VbrMode.vbr_mtrh\n            || gfp.VBR == VbrMode.vbr_mt) {\n            /* these modes can handle free format condition */\n        } else {\n            gfp.free_format = false;\n            /* mode can't be mixed with free format */\n        }\n\n        if (gfp.VBR == VbrMode.vbr_off && gfp.brate == 0) {\n            /* no bitrate or compression ratio specified, use 11.025 */\n            if (BitStream.EQ(gfp.compression_ratio, 0))\n                gfp.compression_ratio = 11.025;\n            /*\n             * rate to compress a CD down to exactly 128000 bps\n             */\n        }\n\n        /* find bitrate if user specify a compression ratio */\n        if (gfp.VBR == VbrMode.vbr_off && gfp.compression_ratio > 0) {\n\n            if (gfp.out_samplerate == 0)\n                gfp.out_samplerate = map2MP3Frequency((int)(0.97 * gfp.in_samplerate));\n            /*\n             * round up with a margin of 3 %\n             */\n\n            /*\n             * choose a bitrate for the output samplerate which achieves\n             * specified compression ratio\n             */\n            gfp.brate = 0 | (gfp.out_samplerate * 16 * gfc.channels_out / (1.e3 * gfp.compression_ratio));\n\n            /* we need the version for the bitrate table look up */\n            gfc.samplerate_index = SmpFrqIndex(gfp.out_samplerate, gfp);\n\n            if (!gfp.free_format) /*\n             * for non Free Format find the nearest allowed\n             * bitrate\n             */\n                gfp.brate = FindNearestBitrate(gfp.brate, gfp.version,\n                    gfp.out_samplerate);\n        }\n\n        if (gfp.out_samplerate != 0) {\n            if (gfp.out_samplerate < 16000) {\n                gfp.VBR_mean_bitrate_kbps = Math.max(gfp.VBR_mean_bitrate_kbps,\n                    8);\n                gfp.VBR_mean_bitrate_kbps = Math.min(gfp.VBR_mean_bitrate_kbps,\n                    64);\n            } else if (gfp.out_samplerate < 32000) {\n                gfp.VBR_mean_bitrate_kbps = Math.max(gfp.VBR_mean_bitrate_kbps,\n                    8);\n                gfp.VBR_mean_bitrate_kbps = Math.min(gfp.VBR_mean_bitrate_kbps,\n                    160);\n            } else {\n                gfp.VBR_mean_bitrate_kbps = Math.max(gfp.VBR_mean_bitrate_kbps,\n                    32);\n                gfp.VBR_mean_bitrate_kbps = Math.min(gfp.VBR_mean_bitrate_kbps,\n                    320);\n            }\n        }\n\n        /****************************************************************/\n        /* if a filter has not been enabled, see if we should add one: */\n        /****************************************************************/\n        if (gfp.lowpassfreq == 0) {\n            var lowpass = 16000.;\n\n            switch (gfp.VBR) {\n                case VbrMode.vbr_off:\n                {\n                    var lh = new LowPassHighPass();\n                    optimum_bandwidth(lh, gfp.brate);\n                    lowpass = lh.lowerlimit;\n                    break;\n                }\n                case VbrMode.vbr_abr:\n                {\n                    var lh = new LowPassHighPass();\n                    optimum_bandwidth(lh, gfp.VBR_mean_bitrate_kbps);\n                    lowpass = lh.lowerlimit;\n                    break;\n                }\n                case VbrMode.vbr_rh:\n                {\n                    var x = [19500, 19000, 18600, 18000, 17500, 16000,\n                        15600, 14900, 12500, 10000, 3950];\n                    if (0 <= gfp.VBR_q && gfp.VBR_q <= 9) {\n                        var a = x[gfp.VBR_q], b = x[gfp.VBR_q + 1], m = gfp.VBR_q_frac;\n                        lowpass = linear_int(a, b, m);\n                    } else {\n                        lowpass = 19500;\n                    }\n                    break;\n                }\n                default:\n                {\n                    var x = [19500, 19000, 18500, 18000, 17500, 16500,\n                        15500, 14500, 12500, 9500, 3950];\n                    if (0 <= gfp.VBR_q && gfp.VBR_q <= 9) {\n                        var a = x[gfp.VBR_q], b = x[gfp.VBR_q + 1], m = gfp.VBR_q_frac;\n                        lowpass = linear_int(a, b, m);\n                    } else {\n                        lowpass = 19500;\n                    }\n                }\n            }\n            if (gfp.mode == MPEGMode.MONO\n                && (gfp.VBR == VbrMode.vbr_off || gfp.VBR == VbrMode.vbr_abr))\n                lowpass *= 1.5;\n\n            gfp.lowpassfreq = lowpass | 0;\n        }\n\n        if (gfp.out_samplerate == 0) {\n            if (2 * gfp.lowpassfreq > gfp.in_samplerate) {\n                gfp.lowpassfreq = gfp.in_samplerate / 2;\n            }\n            gfp.out_samplerate = optimum_samplefreq(gfp.lowpassfreq | 0,\n                gfp.in_samplerate);\n        }\n\n        gfp.lowpassfreq = Math.min(20500, gfp.lowpassfreq);\n        gfp.lowpassfreq = Math.min(gfp.out_samplerate / 2, gfp.lowpassfreq);\n\n        if (gfp.VBR == VbrMode.vbr_off) {\n            gfp.compression_ratio = gfp.out_samplerate * 16 * gfc.channels_out\n                / (1.e3 * gfp.brate);\n        }\n        if (gfp.VBR == VbrMode.vbr_abr) {\n            gfp.compression_ratio = gfp.out_samplerate * 16 * gfc.channels_out\n                / (1.e3 * gfp.VBR_mean_bitrate_kbps);\n        }\n\n        /*\n         * do not compute ReplayGain values and do not find the peak sample if\n         * we can't store them\n         */\n        if (!gfp.bWriteVbrTag) {\n            gfp.findReplayGain = false;\n            gfp.decode_on_the_fly = false;\n            gfc.findPeakSample = false;\n        }\n        gfc.findReplayGain = gfp.findReplayGain;\n        gfc.decode_on_the_fly = gfp.decode_on_the_fly;\n\n        if (gfc.decode_on_the_fly)\n            gfc.findPeakSample = true;\n\n        if (gfc.findReplayGain) {\n            if (ga.InitGainAnalysis(gfc.rgdata, gfp.out_samplerate) == GainAnalysis.INIT_GAIN_ANALYSIS_ERROR) {\n                gfp.internal_flags = null;\n                return -6;\n            }\n        }\n\n        if (gfc.decode_on_the_fly && !gfp.decode_only) {\n            if (gfc.hip != null) {\n                mpglib.hip_decode_exit(gfc.hip);\n            }\n            gfc.hip = mpglib.hip_decode_init();\n        }\n\n        gfc.mode_gr = gfp.out_samplerate <= 24000 ? 1 : 2;\n        /*\n         * Number of granules per frame\n         */\n        gfp.framesize = 576 * gfc.mode_gr;\n        gfp.encoder_delay = Encoder.ENCDELAY;\n\n        gfc.resample_ratio = gfp.in_samplerate / gfp.out_samplerate;\n\n        /**\n         * <PRE>\n         *  sample freq       bitrate     compression ratio\n         *     [kHz]      [kbps/channel]   for 16 bit input\n         *     44.1            56               12.6\n         *     44.1            64               11.025\n         *     44.1            80                8.82\n         *     22.05           24               14.7\n         *     22.05           32               11.025\n         *     22.05           40                8.82\n         *     16              16               16.0\n         *     16              24               10.667\n         * </PRE>\n         */\n        /**\n         * <PRE>\n         *  For VBR, take a guess at the compression_ratio.\n         *  For example:\n         *\n         *    VBR_q    compression     like\n         *     -        4.4         320 kbps/44 kHz\n         *   0...1      5.5         256 kbps/44 kHz\n         *     2        7.3         192 kbps/44 kHz\n         *     4        8.8         160 kbps/44 kHz\n         *     6       11           128 kbps/44 kHz\n         *     9       14.7          96 kbps\n         *\n         *  for lower bitrates, downsample with --resample\n         * </PRE>\n         */\n        switch (gfp.VBR) {\n            case VbrMode.vbr_mt:\n            case VbrMode.vbr_rh:\n            case VbrMode.vbr_mtrh:\n            {\n                /* numbers are a bit strange, but they determine the lowpass value */\n                var cmp = [5.7, 6.5, 7.3, 8.2, 10, 11.9, 13, 14,\n                    15, 16.5];\n                gfp.compression_ratio = cmp[gfp.VBR_q];\n            }\n                break;\n            case VbrMode.vbr_abr:\n                gfp.compression_ratio = gfp.out_samplerate * 16 * gfc.channels_out\n                    / (1.e3 * gfp.VBR_mean_bitrate_kbps);\n                break;\n            default:\n                gfp.compression_ratio = gfp.out_samplerate * 16 * gfc.channels_out\n                    / (1.e3 * gfp.brate);\n                break;\n        }\n\n        /*\n         * mode = -1 (not set by user) or mode = MONO (because of only 1 input\n         * channel). If mode has not been set, then select J-STEREO\n         */\n        if (gfp.mode == MPEGMode.NOT_SET) {\n            gfp.mode = MPEGMode.JOINT_STEREO;\n        }\n\n        /* apply user driven high pass filter */\n        if (gfp.highpassfreq > 0) {\n            gfc.highpass1 = 2. * gfp.highpassfreq;\n\n            if (gfp.highpasswidth >= 0)\n                gfc.highpass2 = 2. * (gfp.highpassfreq + gfp.highpasswidth);\n            else\n            /* 0% above on default */\n                gfc.highpass2 = (1 + 0.00) * 2. * gfp.highpassfreq;\n\n            gfc.highpass1 /= gfp.out_samplerate;\n            gfc.highpass2 /= gfp.out_samplerate;\n        } else {\n            gfc.highpass1 = 0;\n            gfc.highpass2 = 0;\n        }\n        /* apply user driven low pass filter */\n        if (gfp.lowpassfreq > 0) {\n            gfc.lowpass2 = 2. * gfp.lowpassfreq;\n            if (gfp.lowpasswidth >= 0) {\n                gfc.lowpass1 = 2. * (gfp.lowpassfreq - gfp.lowpasswidth);\n                if (gfc.lowpass1 < 0) /* has to be >= 0 */\n                    gfc.lowpass1 = 0;\n            } else { /* 0% below on default */\n                gfc.lowpass1 = (1 - 0.00) * 2. * gfp.lowpassfreq;\n            }\n            gfc.lowpass1 /= gfp.out_samplerate;\n            gfc.lowpass2 /= gfp.out_samplerate;\n        } else {\n            gfc.lowpass1 = 0;\n            gfc.lowpass2 = 0;\n        }\n\n        /**********************************************************************/\n        /* compute info needed for polyphase filter (filter type==0, default) */\n        /**********************************************************************/\n        lame_init_params_ppflt(gfp);\n        /*******************************************************\n         * samplerate and bitrate index\n         *******************************************************/\n        gfc.samplerate_index = SmpFrqIndex(gfp.out_samplerate, gfp);\n        if (gfc.samplerate_index < 0) {\n            gfp.internal_flags = null;\n            return -1;\n        }\n\n        if (gfp.VBR == VbrMode.vbr_off) {\n            if (gfp.free_format) {\n                gfc.bitrate_index = 0;\n            } else {\n                gfp.brate = FindNearestBitrate(gfp.brate, gfp.version,\n                    gfp.out_samplerate);\n                gfc.bitrate_index = BitrateIndex(gfp.brate, gfp.version,\n                    gfp.out_samplerate);\n                if (gfc.bitrate_index <= 0) {\n                    gfp.internal_flags = null;\n                    return -1;\n                }\n            }\n        } else {\n            gfc.bitrate_index = 1;\n        }\n\n        /* for CBR, we will write an \"info\" tag. */\n\n        if (gfp.analysis)\n            gfp.bWriteVbrTag = false;\n\n        /* some file options not allowed if output is: not specified or stdout */\n        if (gfc.pinfo != null)\n            gfp.bWriteVbrTag = false;\n        /* disable Xing VBR tag */\n\n        bs.init_bit_stream_w(gfc);\n\n        var j = gfc.samplerate_index + (3 * gfp.version) + 6\n            * (gfp.out_samplerate < 16000 ? 1 : 0);\n        for (var i = 0; i < Encoder.SBMAX_l + 1; i++)\n            gfc.scalefac_band.l[i] = qupvt.sfBandIndex[j].l[i];\n\n        for (var i = 0; i < Encoder.PSFB21 + 1; i++) {\n            var size = (gfc.scalefac_band.l[22] - gfc.scalefac_band.l[21])\n                / Encoder.PSFB21;\n            var start = gfc.scalefac_band.l[21] + i * size;\n            gfc.scalefac_band.psfb21[i] = start;\n        }\n        gfc.scalefac_band.psfb21[Encoder.PSFB21] = 576;\n\n        for (var i = 0; i < Encoder.SBMAX_s + 1; i++)\n            gfc.scalefac_band.s[i] = qupvt.sfBandIndex[j].s[i];\n\n        for (var i = 0; i < Encoder.PSFB12 + 1; i++) {\n            var size = (gfc.scalefac_band.s[13] - gfc.scalefac_band.s[12])\n                / Encoder.PSFB12;\n            var start = gfc.scalefac_band.s[12] + i * size;\n            gfc.scalefac_band.psfb12[i] = start;\n        }\n        gfc.scalefac_band.psfb12[Encoder.PSFB12] = 192;\n        /* determine the mean bitrate for main data */\n        if (gfp.version == 1) /* MPEG 1 */\n            gfc.sideinfo_len = (gfc.channels_out == 1) ? 4 + 17 : 4 + 32;\n        else\n        /* MPEG 2 */\n            gfc.sideinfo_len = (gfc.channels_out == 1) ? 4 + 9 : 4 + 17;\n\n        if (gfp.error_protection)\n            gfc.sideinfo_len += 2;\n\n        lame_init_bitstream(gfp);\n\n        gfc.Class_ID = LAME_ID;\n\n        {\n            var k;\n\n            for (k = 0; k < 19; k++)\n                gfc.nsPsy.pefirbuf[k] = 700 * gfc.mode_gr * gfc.channels_out;\n\n            if (gfp.ATHtype == -1)\n                gfp.ATHtype = 4;\n        }\n\n        switch (gfp.VBR) {\n\n            case VbrMode.vbr_mt:\n                gfp.VBR = VbrMode.vbr_mtrh;\n            //$FALL-THROUGH$\n            case VbrMode.vbr_mtrh:\n            {\n                if (gfp.useTemporal == null) {\n                    gfp.useTemporal = false;\n                    /* off by default for this VBR mode */\n                }\n\n                p.apply_preset(gfp, 500 - (gfp.VBR_q * 10), 0);\n                /**\n                 * <PRE>\n                 *   The newer VBR code supports only a limited\n                 *     subset of quality levels:\n                 *     9-5=5 are the same, uses x^3/4 quantization\n                 *   4-0=0 are the same  5 plus best huffman divide code\n                 * </PRE>\n                 */\n                if (gfp.quality < 0)\n                    gfp.quality = LAME_DEFAULT_QUALITY;\n                if (gfp.quality < 5)\n                    gfp.quality = 0;\n                if (gfp.quality > 5)\n                    gfp.quality = 5;\n\n                gfc.PSY.mask_adjust = gfp.maskingadjust;\n                gfc.PSY.mask_adjust_short = gfp.maskingadjust_short;\n\n                /*\n                 * sfb21 extra only with MPEG-1 at higher sampling rates\n                 */\n                if (gfp.experimentalY)\n                    gfc.sfb21_extra = false;\n                else\n                    gfc.sfb21_extra = (gfp.out_samplerate > 44000);\n\n                gfc.iteration_loop = new VBRNewIterationLoop(qu);\n                break;\n\n            }\n            case VbrMode.vbr_rh:\n            {\n\n                p.apply_preset(gfp, 500 - (gfp.VBR_q * 10), 0);\n\n                gfc.PSY.mask_adjust = gfp.maskingadjust;\n                gfc.PSY.mask_adjust_short = gfp.maskingadjust_short;\n\n                /*\n                 * sfb21 extra only with MPEG-1 at higher sampling rates\n                 */\n                if (gfp.experimentalY)\n                    gfc.sfb21_extra = false;\n                else\n                    gfc.sfb21_extra = (gfp.out_samplerate > 44000);\n\n                /*\n                 * VBR needs at least the output of GPSYCHO, so we have to garantee\n                 * that by setting a minimum quality level, actually level 6 does\n                 * it. down to level 6\n                 */\n                if (gfp.quality > 6)\n                    gfp.quality = 6;\n\n                if (gfp.quality < 0)\n                    gfp.quality = LAME_DEFAULT_QUALITY;\n\n                gfc.iteration_loop = new VBROldIterationLoop(qu);\n                break;\n            }\n\n            default: /* cbr/abr */\n            {\n                var vbrmode;\n\n                /*\n                 * no sfb21 extra with CBR code\n                 */\n                gfc.sfb21_extra = false;\n\n                if (gfp.quality < 0)\n                    gfp.quality = LAME_DEFAULT_QUALITY;\n\n                vbrmode = gfp.VBR;\n                if (vbrmode == VbrMode.vbr_off)\n                    gfp.VBR_mean_bitrate_kbps = gfp.brate;\n                /* second, set parameters depending on bitrate */\n                p.apply_preset(gfp, gfp.VBR_mean_bitrate_kbps, 0);\n                gfp.VBR = vbrmode;\n\n                gfc.PSY.mask_adjust = gfp.maskingadjust;\n                gfc.PSY.mask_adjust_short = gfp.maskingadjust_short;\n\n                if (vbrmode == VbrMode.vbr_off) {\n                    gfc.iteration_loop = new CBRNewIterationLoop(qu);\n                } else {\n                    gfc.iteration_loop = new ABRIterationLoop(qu);\n                }\n                break;\n            }\n        }\n        /* initialize default values common for all modes */\n\n        if (gfp.VBR != VbrMode.vbr_off) { /* choose a min/max bitrate for VBR */\n            /* if the user didn't specify VBR_max_bitrate: */\n            gfc.VBR_min_bitrate = 1;\n            /*\n             * default: allow 8 kbps (MPEG-2) or 32 kbps (MPEG-1)\n             */\n            gfc.VBR_max_bitrate = 14;\n            /*\n             * default: allow 160 kbps (MPEG-2) or 320 kbps (MPEG-1)\n             */\n            if (gfp.out_samplerate < 16000)\n                gfc.VBR_max_bitrate = 8;\n            /* default: allow 64 kbps (MPEG-2.5) */\n            if (gfp.VBR_min_bitrate_kbps != 0) {\n                gfp.VBR_min_bitrate_kbps = FindNearestBitrate(\n                    gfp.VBR_min_bitrate_kbps, gfp.version,\n                    gfp.out_samplerate);\n                gfc.VBR_min_bitrate = BitrateIndex(gfp.VBR_min_bitrate_kbps,\n                    gfp.version, gfp.out_samplerate);\n                if (gfc.VBR_min_bitrate < 0)\n                    return -1;\n            }\n            if (gfp.VBR_max_bitrate_kbps != 0) {\n                gfp.VBR_max_bitrate_kbps = FindNearestBitrate(\n                    gfp.VBR_max_bitrate_kbps, gfp.version,\n                    gfp.out_samplerate);\n                gfc.VBR_max_bitrate = BitrateIndex(gfp.VBR_max_bitrate_kbps,\n                    gfp.version, gfp.out_samplerate);\n                if (gfc.VBR_max_bitrate < 0)\n                    return -1;\n            }\n            gfp.VBR_min_bitrate_kbps = Tables.bitrate_table[gfp.version][gfc.VBR_min_bitrate];\n            gfp.VBR_max_bitrate_kbps = Tables.bitrate_table[gfp.version][gfc.VBR_max_bitrate];\n            gfp.VBR_mean_bitrate_kbps = Math.min(\n                Tables.bitrate_table[gfp.version][gfc.VBR_max_bitrate],\n                gfp.VBR_mean_bitrate_kbps);\n            gfp.VBR_mean_bitrate_kbps = Math.max(\n                Tables.bitrate_table[gfp.version][gfc.VBR_min_bitrate],\n                gfp.VBR_mean_bitrate_kbps);\n        }\n\n        /* just another daily changing developer switch */\n        if (gfp.tune) {\n            gfc.PSY.mask_adjust += gfp.tune_value_a;\n            gfc.PSY.mask_adjust_short += gfp.tune_value_a;\n        }\n\n        /* initialize internal qval settings */\n        lame_init_qval(gfp);\n        /*\n         * automatic ATH adjustment on\n         */\n        if (gfp.athaa_type < 0)\n            gfc.ATH.useAdjust = 3;\n        else\n            gfc.ATH.useAdjust = gfp.athaa_type;\n\n        /* initialize internal adaptive ATH settings -jd */\n        gfc.ATH.aaSensitivityP = Math.pow(10.0, gfp.athaa_sensitivity\n            / -10.0);\n\n        if (gfp.short_blocks == null) {\n            gfp.short_blocks = ShortBlock.short_block_allowed;\n        }\n\n        /*\n         * Note Jan/2003: Many hardware decoders cannot handle short blocks in\n         * regular stereo mode unless they are coupled (same type in both\n         * channels) it is a rare event (1 frame per min. or so) that LAME would\n         * use uncoupled short blocks, so lets turn them off until we decide how\n         * to handle this. No other encoders allow uncoupled short blocks, even\n         * though it is in the standard.\n         */\n        /*\n         * rh 20040217: coupling makes no sense for mono and dual-mono streams\n         */\n        if (gfp.short_blocks == ShortBlock.short_block_allowed\n            && (gfp.mode == MPEGMode.JOINT_STEREO || gfp.mode == MPEGMode.STEREO)) {\n            gfp.short_blocks = ShortBlock.short_block_coupled;\n        }\n\n        if (gfp.quant_comp < 0)\n            gfp.quant_comp = 1;\n        if (gfp.quant_comp_short < 0)\n            gfp.quant_comp_short = 0;\n\n        if (gfp.msfix < 0)\n            gfp.msfix = 0;\n\n        /* select psychoacoustic model */\n        gfp.exp_nspsytune = gfp.exp_nspsytune | 1;\n\n        if (gfp.internal_flags.nsPsy.attackthre < 0)\n            gfp.internal_flags.nsPsy.attackthre = PsyModel.NSATTACKTHRE;\n        if (gfp.internal_flags.nsPsy.attackthre_s < 0)\n            gfp.internal_flags.nsPsy.attackthre_s = PsyModel.NSATTACKTHRE_S;\n\n\n        if (gfp.scale < 0)\n            gfp.scale = 1;\n\n        if (gfp.ATHtype < 0)\n            gfp.ATHtype = 4;\n\n        if (gfp.ATHcurve < 0)\n            gfp.ATHcurve = 4;\n\n        if (gfp.athaa_loudapprox < 0)\n            gfp.athaa_loudapprox = 2;\n\n        if (gfp.interChRatio < 0)\n            gfp.interChRatio = 0;\n\n        if (gfp.useTemporal == null)\n            gfp.useTemporal = true;\n        /* on by default */\n\n        /*\n         * padding method as described in\n         * \"MPEG-Layer3 / Bitstream Syntax and Decoding\" by Martin Sieler, Ralph\n         * Sperschneider\n         *\n         * note: there is no padding for the very first frame\n         *\n         * Robert Hegemann 2000-06-22\n         */\n        gfc.slot_lag = gfc.frac_SpF = 0;\n        if (gfp.VBR == VbrMode.vbr_off)\n            gfc.slot_lag = gfc.frac_SpF = (((gfp.version + 1) * 72000 * gfp.brate) % gfp.out_samplerate) | 0;\n\n        qupvt.iteration_init(gfp);\n        psy.psymodel_init(gfp);\n        return 0;\n    }\n\n    function update_inbuffer_size(gfc, nsamples) {\n        if (gfc.in_buffer_0 == null || gfc.in_buffer_nsamples < nsamples) {\n            gfc.in_buffer_0 = new_float(nsamples);\n            gfc.in_buffer_1 = new_float(nsamples);\n            gfc.in_buffer_nsamples = nsamples;\n        }\n    }\n\n    this.lame_encode_flush = function (gfp, mp3buffer, mp3bufferPos, mp3buffer_size) {\n        var gfc = gfp.internal_flags;\n        var buffer = new_short_n([2, 1152]);\n        var imp3 = 0, mp3count, mp3buffer_size_remaining;\n\n        /*\n         * we always add POSTDELAY=288 padding to make sure granule with real\n         * data can be complety decoded (because of 50% overlap with next\n         * granule\n         */\n        var end_padding;\n        var frames_left;\n        var samples_to_encode = gfc.mf_samples_to_encode - Encoder.POSTDELAY;\n        var mf_needed = calcNeeded(gfp);\n\n        /* Was flush already called? */\n        if (gfc.mf_samples_to_encode < 1) {\n            return 0;\n        }\n        mp3count = 0;\n\n        if (gfp.in_samplerate != gfp.out_samplerate) {\n            /*\n             * delay due to resampling; needs to be fixed, if resampling code\n             * gets changed\n             */\n            samples_to_encode += 16. * gfp.out_samplerate / gfp.in_samplerate;\n        }\n        end_padding = gfp.framesize - (samples_to_encode % gfp.framesize);\n        if (end_padding < 576)\n            end_padding += gfp.framesize;\n        gfp.encoder_padding = end_padding;\n\n        frames_left = (samples_to_encode + end_padding) / gfp.framesize;\n\n        /*\n         * send in a frame of 0 padding until all internal sample buffers are\n         * flushed\n         */\n        while (frames_left > 0 && imp3 >= 0) {\n            var bunch = mf_needed - gfc.mf_size;\n            var frame_num = gfp.frameNum;\n\n            bunch *= gfp.in_samplerate;\n            bunch /= gfp.out_samplerate;\n            if (bunch > 1152)\n                bunch = 1152;\n            if (bunch < 1)\n                bunch = 1;\n\n            mp3buffer_size_remaining = mp3buffer_size - mp3count;\n\n            /* if user specifed buffer size = 0, dont check size */\n            if (mp3buffer_size == 0)\n                mp3buffer_size_remaining = 0;\n\n            imp3 = this.lame_encode_buffer(gfp, buffer[0], buffer[1], bunch,\n                mp3buffer, mp3bufferPos, mp3buffer_size_remaining);\n\n            mp3bufferPos += imp3;\n            mp3count += imp3;\n            frames_left -= (frame_num != gfp.frameNum) ? 1 : 0;\n        }\n        /*\n         * Set gfc.mf_samples_to_encode to 0, so we may detect and break loops\n         * calling it more than once in a row.\n         */\n        gfc.mf_samples_to_encode = 0;\n\n        if (imp3 < 0) {\n            /* some type of fatal error */\n            return imp3;\n        }\n\n        mp3buffer_size_remaining = mp3buffer_size - mp3count;\n        /* if user specifed buffer size = 0, dont check size */\n        if (mp3buffer_size == 0)\n            mp3buffer_size_remaining = 0;\n\n        /* mp3 related stuff. bit buffer might still contain some mp3 data */\n        bs.flush_bitstream(gfp);\n        imp3 = bs.copy_buffer(gfc, mp3buffer, mp3bufferPos,\n            mp3buffer_size_remaining, 1);\n        if (imp3 < 0) {\n            /* some type of fatal error */\n            return imp3;\n        }\n        mp3bufferPos += imp3;\n        mp3count += imp3;\n        mp3buffer_size_remaining = mp3buffer_size - mp3count;\n        /* if user specifed buffer size = 0, dont check size */\n        if (mp3buffer_size == 0)\n            mp3buffer_size_remaining = 0;\n\n        if (gfp.write_id3tag_automatic) {\n            /* write a id3 tag to the bitstream */\n            id3.id3tag_write_v1(gfp);\n\n            imp3 = bs.copy_buffer(gfc, mp3buffer, mp3bufferPos,\n                mp3buffer_size_remaining, 0);\n\n            if (imp3 < 0) {\n                return imp3;\n            }\n            mp3count += imp3;\n        }\n        return mp3count;\n    };\n\n    this.lame_encode_buffer = function (gfp, buffer_l, buffer_r, nsamples, mp3buf, mp3bufPos, mp3buf_size) {\n        var gfc = gfp.internal_flags;\n        var in_buffer = [null, null];\n\n        if (gfc.Class_ID != LAME_ID)\n            return -3;\n\n        if (nsamples == 0)\n            return 0;\n\n        update_inbuffer_size(gfc, nsamples);\n\n        in_buffer[0] = gfc.in_buffer_0;\n        in_buffer[1] = gfc.in_buffer_1;\n\n        /* make a copy of input buffer, changing type to sample_t */\n        for (var i = 0; i < nsamples; i++) {\n            in_buffer[0][i] = buffer_l[i];\n            if (gfc.channels_in > 1)\n                in_buffer[1][i] = buffer_r[i];\n        }\n\n        return lame_encode_buffer_sample(gfp, in_buffer[0], in_buffer[1],\n            nsamples, mp3buf, mp3bufPos, mp3buf_size);\n    }\n\n    function calcNeeded(gfp) {\n        var mf_needed = Encoder.BLKSIZE + gfp.framesize - Encoder.FFTOFFSET;\n        /*\n         * amount needed for FFT\n         */\n        mf_needed = Math.max(mf_needed, 512 + gfp.framesize - 32);\n\n        return mf_needed;\n    }\n\n    function lame_encode_buffer_sample(gfp, buffer_l, buffer_r, nsamples, mp3buf, mp3bufPos, mp3buf_size) {\n        var gfc = gfp.internal_flags;\n        var mp3size = 0, ret, i, ch, mf_needed;\n        var mp3out;\n        var mfbuf = [null, null];\n        var in_buffer = [null, null];\n\n        if (gfc.Class_ID != LAME_ID)\n            return -3;\n\n        if (nsamples == 0)\n            return 0;\n\n        /* copy out any tags that may have been written into bitstream */\n        mp3out = bs.copy_buffer(gfc, mp3buf, mp3bufPos, mp3buf_size, 0);\n        if (mp3out < 0)\n            return mp3out;\n        /* not enough buffer space */\n        mp3bufPos += mp3out;\n        mp3size += mp3out;\n\n        in_buffer[0] = buffer_l;\n        in_buffer[1] = buffer_r;\n\n        /* Apply user defined re-scaling */\n\n        /* user selected scaling of the samples */\n        if (BitStream.NEQ(gfp.scale, 0) && BitStream.NEQ(gfp.scale, 1.0)) {\n            for (i = 0; i < nsamples; ++i) {\n                in_buffer[0][i] *= gfp.scale;\n                if (gfc.channels_out == 2)\n                    in_buffer[1][i] *= gfp.scale;\n            }\n        }\n\n        /* user selected scaling of the channel 0 (left) samples */\n        if (BitStream.NEQ(gfp.scale_left, 0)\n            && BitStream.NEQ(gfp.scale_left, 1.0)) {\n            for (i = 0; i < nsamples; ++i) {\n                in_buffer[0][i] *= gfp.scale_left;\n            }\n        }\n\n        /* user selected scaling of the channel 1 (right) samples */\n        if (BitStream.NEQ(gfp.scale_right, 0)\n            && BitStream.NEQ(gfp.scale_right, 1.0)) {\n            for (i = 0; i < nsamples; ++i) {\n                in_buffer[1][i] *= gfp.scale_right;\n            }\n        }\n\n        /* Downsample to Mono if 2 channels in and 1 channel out */\n        if (gfp.num_channels == 2 && gfc.channels_out == 1) {\n            for (i = 0; i < nsamples; ++i) {\n                in_buffer[0][i] = 0.5 * ( in_buffer[0][i] + in_buffer[1][i]);\n                in_buffer[1][i] = 0.0;\n            }\n        }\n\n        mf_needed = calcNeeded(gfp);\n\n        mfbuf[0] = gfc.mfbuf[0];\n        mfbuf[1] = gfc.mfbuf[1];\n\n        var in_bufferPos = 0;\n        while (nsamples > 0) {\n            var in_buffer_ptr = [null, null];\n            var n_in = 0;\n            /* number of input samples processed with fill_buffer */\n            var n_out = 0;\n            /* number of samples output with fill_buffer */\n            /* n_in <> n_out if we are resampling */\n\n            in_buffer_ptr[0] = in_buffer[0];\n            in_buffer_ptr[1] = in_buffer[1];\n            /* copy in new samples into mfbuf, with resampling */\n            var inOut = new InOut();\n            fill_buffer(gfp, mfbuf, in_buffer_ptr, in_bufferPos, nsamples,\n                inOut);\n            n_in = inOut.n_in;\n            n_out = inOut.n_out;\n\n            /* compute ReplayGain of resampled input if requested */\n            if (gfc.findReplayGain && !gfc.decode_on_the_fly)\n                if (ga.AnalyzeSamples(gfc.rgdata, mfbuf[0], gfc.mf_size,\n                        mfbuf[1], gfc.mf_size, n_out, gfc.channels_out) == GainAnalysis.GAIN_ANALYSIS_ERROR)\n                    return -6;\n\n            /* update in_buffer counters */\n            nsamples -= n_in;\n            in_bufferPos += n_in;\n            if (gfc.channels_out == 2)\n                ;// in_bufferPos += n_in;\n\n            /* update mfbuf[] counters */\n            gfc.mf_size += n_out;\n\n            /*\n             * lame_encode_flush may have set gfc.mf_sample_to_encode to 0 so we\n             * have to reinitialize it here when that happened.\n             */\n            if (gfc.mf_samples_to_encode < 1) {\n                gfc.mf_samples_to_encode = Encoder.ENCDELAY + Encoder.POSTDELAY;\n            }\n            gfc.mf_samples_to_encode += n_out;\n\n            if (gfc.mf_size >= mf_needed) {\n                /* encode the frame. */\n                /* mp3buf = pointer to current location in buffer */\n                /* mp3buf_size = size of original mp3 output buffer */\n                /* = 0 if we should not worry about the */\n                /* buffer size because calling program is */\n                /* to lazy to compute it */\n                /* mp3size = size of data written to buffer so far */\n                /* mp3buf_size-mp3size = amount of space avalable */\n\n                var buf_size = mp3buf_size - mp3size;\n                if (mp3buf_size == 0)\n                    buf_size = 0;\n\n                ret = lame_encode_frame(gfp, mfbuf[0], mfbuf[1], mp3buf,\n                    mp3bufPos, buf_size);\n\n                if (ret < 0)\n                    return ret;\n                mp3bufPos += ret;\n                mp3size += ret;\n\n                /* shift out old samples */\n                gfc.mf_size -= gfp.framesize;\n                gfc.mf_samples_to_encode -= gfp.framesize;\n                for (ch = 0; ch < gfc.channels_out; ch++)\n                    for (i = 0; i < gfc.mf_size; i++)\n                        mfbuf[ch][i] = mfbuf[ch][i + gfp.framesize];\n            }\n        }\n\n        return mp3size;\n    }\n\n    function lame_encode_frame(gfp, inbuf_l, inbuf_r, mp3buf, mp3bufPos, mp3buf_size) {\n        var ret = self.enc.lame_encode_mp3_frame(gfp, inbuf_l, inbuf_r, mp3buf,\n            mp3bufPos, mp3buf_size);\n        gfp.frameNum++;\n        return ret;\n    }\n\n    function InOut() {\n        this.n_in = 0;\n        this.n_out = 0;\n    }\n\n\n    function NumUsed() {\n        this.num_used = 0;\n    }\n\n    /**\n     * Greatest common divisor.\n     * <p>\n     * Joint work of Euclid and M. Hendry\n     */\n    function gcd(i, j) {\n        return j != 0 ? gcd(j, i % j) : i;\n    }\n\n    /**\n     * Resampling via FIR filter, blackman window.\n     */\n    function blackman(x, fcn, l) {\n        /*\n         * This algorithm from: SIGNAL PROCESSING ALGORITHMS IN FORTRAN AND C\n         * S.D. Stearns and R.A. David, Prentice-Hall, 1992\n         */\n        var wcn = (Math.PI * fcn);\n\n        x /= l;\n        if (x < 0)\n            x = 0;\n        if (x > 1)\n            x = 1;\n        var x2 = x - .5;\n\n        var bkwn = 0.42 - 0.5 * Math.cos(2 * x * Math.PI) + 0.08 * Math.cos(4 * x * Math.PI);\n        if (Math.abs(x2) < 1e-9)\n            return (wcn / Math.PI);\n        else\n            return (bkwn * Math.sin(l * wcn * x2) / (Math.PI * l * x2));\n    }\n\n    function fill_buffer_resample(gfp, outbuf, outbufPos, desired_len, inbuf, in_bufferPos, len, num_used, ch) {\n        var gfc = gfp.internal_flags;\n        var i, j = 0, k;\n        /* number of convolution functions to pre-compute */\n        var bpc = gfp.out_samplerate\n            / gcd(gfp.out_samplerate, gfp.in_samplerate);\n        if (bpc > LameInternalFlags.BPC)\n            bpc = LameInternalFlags.BPC;\n\n        var intratio = (Math.abs(gfc.resample_ratio\n            - Math.floor(.5 + gfc.resample_ratio)) < .0001) ? 1 : 0;\n        var fcn = 1.00 / gfc.resample_ratio;\n        if (fcn > 1.00)\n            fcn = 1.00;\n        var filter_l = 31;\n        if (0 == filter_l % 2)\n            --filter_l;\n        /* must be odd */\n        filter_l += intratio;\n        /* unless resample_ratio=int, it must be even */\n\n        var BLACKSIZE = filter_l + 1;\n        /* size of data needed for FIR */\n\n        if (gfc.fill_buffer_resample_init == 0) {\n            gfc.inbuf_old[0] = new_float(BLACKSIZE);\n            gfc.inbuf_old[1] = new_float(BLACKSIZE);\n            for (i = 0; i <= 2 * bpc; ++i)\n                gfc.blackfilt[i] = new_float(BLACKSIZE);\n\n            gfc.itime[0] = 0;\n            gfc.itime[1] = 0;\n\n            /* precompute blackman filter coefficients */\n            for (j = 0; j <= 2 * bpc; j++) {\n                var sum = 0.;\n                var offset = (j - bpc) / (2. * bpc);\n                for (i = 0; i <= filter_l; i++)\n                    sum += gfc.blackfilt[j][i] = blackman(i - offset, fcn,\n                        filter_l);\n                for (i = 0; i <= filter_l; i++)\n                    gfc.blackfilt[j][i] /= sum;\n            }\n            gfc.fill_buffer_resample_init = 1;\n        }\n\n        var inbuf_old = gfc.inbuf_old[ch];\n\n        /* time of j'th element in inbuf = itime + j/ifreq; */\n        /* time of k'th element in outbuf = j/ofreq */\n        for (k = 0; k < desired_len; k++) {\n            var time0;\n            var joff;\n\n            time0 = k * gfc.resample_ratio;\n            /* time of k'th output sample */\n            j = 0 | Math.floor(time0 - gfc.itime[ch]);\n\n            /* check if we need more input data */\n            if ((filter_l + j - filter_l / 2) >= len)\n                break;\n\n            /* blackman filter. by default, window centered at j+.5(filter_l%2) */\n            /* but we want a window centered at time0. */\n            var offset = (time0 - gfc.itime[ch] - (j + .5 * (filter_l % 2)));\n\n            /* find the closest precomputed window for this offset: */\n            joff = 0 | Math.floor((offset * 2 * bpc) + bpc + .5);\n            var xvalue = 0.;\n            for (i = 0; i <= filter_l; ++i) {\n                var j2 = i + j - filter_l / 2;\n                var y;\n                y = (j2 < 0) ? inbuf_old[BLACKSIZE + j2] : inbuf[in_bufferPos\n                + j2];\n                xvalue += y * gfc.blackfilt[joff][i];\n            }\n            outbuf[outbufPos + k] = xvalue;\n        }\n\n        /* k = number of samples added to outbuf */\n        /* last k sample used data from [j-filter_l/2,j+filter_l-filter_l/2] */\n\n        /* how many samples of input data were used: */\n        num_used.num_used = Math.min(len, filter_l + j - filter_l / 2);\n\n        /*\n         * adjust our input time counter. Incriment by the number of samples\n         * used, then normalize so that next output sample is at time 0, next\n         * input buffer is at time itime[ch]\n         */\n        gfc.itime[ch] += num_used.num_used - k * gfc.resample_ratio;\n\n        /* save the last BLACKSIZE samples into the inbuf_old buffer */\n        if (num_used.num_used >= BLACKSIZE) {\n            for (i = 0; i < BLACKSIZE; i++)\n                inbuf_old[i] = inbuf[in_bufferPos + num_used.num_used + i\n                - BLACKSIZE];\n        } else {\n            /* shift in num_used.num_used samples into inbuf_old */\n            var n_shift = BLACKSIZE - num_used.num_used;\n            /*\n             * number of samples to\n             * shift\n             */\n\n            /*\n             * shift n_shift samples by num_used.num_used, to make room for the\n             * num_used new samples\n             */\n            for (i = 0; i < n_shift; ++i)\n                inbuf_old[i] = inbuf_old[i + num_used.num_used];\n\n            /* shift in the num_used.num_used samples */\n            for (j = 0; i < BLACKSIZE; ++i, ++j)\n                inbuf_old[i] = inbuf[in_bufferPos + j];\n\n        }\n        return k;\n        /* return the number samples created at the new samplerate */\n    }\n\n    function fill_buffer(gfp, mfbuf, in_buffer, in_bufferPos, nsamples, io) {\n        var gfc = gfp.internal_flags;\n\n        /* copy in new samples into mfbuf, with resampling if necessary */\n        if ((gfc.resample_ratio < .9999) || (gfc.resample_ratio > 1.0001)) {\n            for (var ch = 0; ch < gfc.channels_out; ch++) {\n                var numUsed = new NumUsed();\n                io.n_out = fill_buffer_resample(gfp, mfbuf[ch], gfc.mf_size,\n                    gfp.framesize, in_buffer[ch], in_bufferPos, nsamples,\n                    numUsed, ch);\n                io.n_in = numUsed.num_used;\n            }\n        } else {\n            io.n_out = Math.min(gfp.framesize, nsamples);\n            io.n_in = io.n_out;\n            for (var i = 0; i < io.n_out; ++i) {\n                mfbuf[0][gfc.mf_size + i] = in_buffer[0][in_bufferPos + i];\n                if (gfc.channels_out == 2)\n                    mfbuf[1][gfc.mf_size + i] = in_buffer[1][in_bufferPos + i];\n            }\n        }\n    }\n\n}\n\n\n\nfunction GetAudio() {\n    var parse;\n    var mpg;\n\n    this.setModules = function (parse2, mpg2) {\n        parse = parse2;\n        mpg = mpg2;\n    }\n}\n\n\nfunction Parse() {\n    var ver;\n    var id3;\n    var pre;\n\n    this.setModules = function (ver2, id32, pre2) {\n        ver = ver2;\n        id3 = id32;\n        pre = pre2;\n    }\n}\n\nfunction MPGLib() {\n}\n\nfunction ID3Tag() {\n    var bits;\n    var ver;\n\n    this.setModules = function (_bits, _ver) {\n        bits = _bits;\n        ver = _ver;\n    }\n}\n\nfunction Mp3Encoder(channels, samplerate, kbps) {\n    if (arguments.length != 3) {\n        console.error('WARN: Mp3Encoder(channels, samplerate, kbps) not specified');\n        channels = 1;\n        samplerate = 44100;\n        kbps = 128;\n    }\n    var lame = new Lame();\n    var gaud = new GetAudio();\n    var ga = new GainAnalysis();\n    var bs = new BitStream();\n    var p = new Presets();\n    var qupvt = new QuantizePVT();\n    var qu = new Quantize();\n    var vbr = new VBRTag();\n    var ver = new Version();\n    var id3 = new ID3Tag();\n    var rv = new Reservoir();\n    var tak = new Takehiro();\n    var parse = new Parse();\n    var mpg = new MPGLib();\n\n    lame.setModules(ga, bs, p, qupvt, qu, vbr, ver, id3, mpg);\n    bs.setModules(ga, mpg, ver, vbr);\n    id3.setModules(bs, ver);\n    p.setModules(lame);\n    qu.setModules(bs, rv, qupvt, tak);\n    qupvt.setModules(tak, rv, lame.enc.psy);\n    rv.setModules(bs);\n    tak.setModules(qupvt);\n    vbr.setModules(lame, bs, ver);\n    gaud.setModules(parse, mpg);\n    parse.setModules(ver, id3, p);\n\n    var gfp = lame.lame_init();\n\n    gfp.num_channels = channels;\n    gfp.in_samplerate = samplerate;\n    gfp.out_samplerate = samplerate;//fix by xiangyuecn 2018-12-6 01:48:12 64kbps以下可能无声音，手动控制输出码率\n    gfp.brate = kbps;\n    gfp.mode = MPEGMode.STEREO;\n    gfp.quality = 3;\n    gfp.bWriteVbrTag = false;\n    gfp.disable_reservoir = true;\n    gfp.write_id3tag_automatic = false;\n\n    var retcode = lame.lame_init_params(gfp);\n    var maxSamples = 1152;\n    var mp3buf_size = 0 | (1.25 * maxSamples + 7200);\n    var mp3buf = new_byte(mp3buf_size);\n\n    this.encodeBuffer = function (left, right) {\n        if (channels == 1) {\n            right = left;\n        }\n        if (left.length > maxSamples) {\n            maxSamples = left.length;\n            mp3buf_size = 0 | (1.25 * maxSamples + 7200);\n            mp3buf = new_byte(mp3buf_size);\n        }\n\n        var _sz = lame.lame_encode_buffer(gfp, left, right, left.length, mp3buf, 0, mp3buf_size);\n        return new Int8Array(mp3buf.subarray(0, _sz));\n    };\n\n    this.flush = function () {\n        var _sz = lame.lame_encode_flush(gfp, mp3buf, 0, mp3buf_size);\n        return new Int8Array(mp3buf.subarray(0, _sz));\n    };\n}\n\n//fix 精简\nL3Side.SFBMAX = (Encoder.SBMAX_s * 3);\n//testFullLength();\nlamejs.Mp3Encoder = Mp3Encoder;\n}\n//fs=require('fs');\nlamejs();\n\n\nRecorder.lamejs=lamejs;\n\n//end3 ****结束copy lamejs*****\n})();","/*\nmp3编码器，需带上mp3-engine.js引擎使用\nhttps://github.com/xiangyuecn/Recorder\n\n当然最佳推荐使用mp3、wav格式，代码也是优先照顾这两种格式\n浏览器支持情况\nhttps://developer.mozilla.org/en-US/docs/Web/HTML/Supported_media_formats\n*/\n(function(){\n\"use strict\";\n\nRecorder.prototype.enc_mp3={\n\tstable:true\n\t,testmsg:\"采样率范围48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000\"\n};\n\n\n\n//*******标准UI线程转码支持函数************\n\nRecorder.prototype.mp3=function(res,True,False){\n\t\tvar This=this,set=This.set,size=res.length;\n\t\t\n\t\t//优先采用worker编码，太低版本下面用老方法提供兼容\n\t\tvar ctx=This.mp3_start(set);\n\t\tif(ctx){\n\t\t\tThis.mp3_encode(ctx,res);\n\t\t\tThis.mp3_complete(ctx,True,False,1);\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//https://github.com/wangpengfei15975/recorder.js\n\t\t//https://github.com/zhuker/lamejs bug:采样率必须和源一致，不然8k时没有声音，有问题fix：https://github.com/zhuker/lamejs/pull/11\n\t\tvar mp3=new Recorder.lamejs.Mp3Encoder(1,set.sampleRate,set.bitRate);\n\t\t\n\t\tvar blockSize=57600;\n\t\tvar data=[];\n\t\t\n\t\tvar idx=0,mp3Size=0;\n\t\tvar run=function(){\n\t\t\tif(idx<size){\n\t\t\t\tvar buf=mp3.encodeBuffer(res.subarray(idx,idx+blockSize));\n\t\t\t\tif(buf.length>0){\n\t\t\t\t\tmp3Size+=buf.buffer.byteLength;\n\t\t\t\t\tdata.push(buf.buffer);\n\t\t\t\t};\n\t\t\t\tidx+=blockSize;\n\t\t\t\tsetTimeout(run);//尽量避免卡ui\n\t\t\t}else{\n\t\t\t\tvar buf=mp3.flush();\n\t\t\t\tif(buf.length>0){\n\t\t\t\t\tmp3Size+=buf.buffer.byteLength;\n\t\t\t\t\tdata.push(buf.buffer);\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t//去掉开头的标记信息帧\n\t\t\t\tvar meta=mp3TrimFix.fn(data,mp3Size,size,set.sampleRate);\n\t\t\t\tmp3TrimFixSetMeta(meta,set);\n\t\t\t\t\n\t\t\t\tTrue(new Blob(data,{type:\"audio/mp3\"}));\n\t\t\t};\n\t\t};\n\t\trun();\n\t}\n\n\n//********边录边转码(Worker)支持函数，如果提供就代表可能支持，否则只支持标准转码*********\n\n//全局共享一个Worker，后台串行执行。如果每次都开一个新的，编码速度可能会慢很多，可能是浏览器运行缓存的因素，并且可能瞬间产生多个并行操作占用大量cpu\nvar mp3Worker;\nRecorder.BindDestroy(\"mp3Worker\",function(){\n\tconsole.log(\"mp3Worker Destroy\");\n\tmp3Worker&&mp3Worker.terminate();\n\tmp3Worker=null;\n});\n\n\nRecorder.prototype.mp3_envCheck=function(envInfo,set){//检查环境下配置是否可用\n\tvar errMsg=\"\";\n\t//需要实时编码返回数据，此时需要检查环境是否有实时特性、和是否可实时编码\n\tif(set.takeoffEncodeChunk){\n\t\tif(!envInfo.canProcess){\n\t\t\terrMsg=envInfo.envName+\"环境不支持实时处理\";\n\t\t}else if(!newContext()){//浏览器不能创建实时编码环境\n\t\t\terrMsg=\"当前浏览器版本太低，无法实时处理\";\n\t\t};\n\t};\n\treturn errMsg;\n};\nRecorder.prototype.mp3_start=function(set){//如果返回null代表不支持\n\treturn newContext(set);\n};\nvar openList={id:0};\nvar newContext=function(setOrNull){\n\tvar worker=mp3Worker;\n\ttry{\n\t\tif(!worker){\n\t\t\tvar onmsg=function(e){\n\t\t\t\tvar ed=e.data;\n\t\t\t\tvar cur=wk_ctxs[ed.id];\n\t\t\t\tif(ed.action==\"init\"){\n\t\t\t\t\twk_ctxs[ed.id]={\n\t\t\t\t\t\tsampleRate:ed.sampleRate\n\t\t\t\t\t\t,bitRate:ed.bitRate\n\t\t\t\t\t\t,takeoff:ed.takeoff\n\t\t\t\t\t\t\n\t\t\t\t\t\t,mp3Size:0\n\t\t\t\t\t\t,pcmSize:0\n\t\t\t\t\t\t,encArr:[]\n\t\t\t\t\t\t,encObj:new wk_lame.Mp3Encoder(1,ed.sampleRate,ed.bitRate)\n\t\t\t\t\t};\n\t\t\t\t}else if(!cur){\n\t\t\t\t\treturn;\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tswitch(ed.action){\n\t\t\t\tcase \"stop\":\n\t\t\t\t\tcur.encObj=null;\n\t\t\t\t\tdelete wk_ctxs[ed.id];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"encode\":\n\t\t\t\t\tcur.pcmSize+=ed.pcm.length;\n\t\t\t\t\tvar buf=cur.encObj.encodeBuffer(ed.pcm);\n\t\t\t\t\tif(buf.length>0){\n\t\t\t\t\t\tif(cur.takeoff){\n\t\t\t\t\t\t\tself.postMessage({action:\"takeoff\",id:ed.id,chunk:buf});\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tcur.mp3Size+=buf.buffer.byteLength;\n\t\t\t\t\t\t\tcur.encArr.push(buf.buffer);\n\t\t\t\t\t\t};\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"complete\":\n\t\t\t\t\tvar buf=cur.encObj.flush();\n\t\t\t\t\tif(buf.length>0){\n\t\t\t\t\t\tif(cur.takeoff){\n\t\t\t\t\t\t\tself.postMessage({action:\"takeoff\",id:ed.id,chunk:buf});\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tcur.mp3Size+=buf.buffer.byteLength;\n\t\t\t\t\t\t\tcur.encArr.push(buf.buffer);\n\t\t\t\t\t\t};\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\t//去掉开头的标记信息帧\n\t\t\t\t\tvar meta=wk_mp3TrimFix.fn(cur.encArr,cur.mp3Size,cur.pcmSize,cur.sampleRate);\n\t\t\t\t\t\n\t\t\t\t\tself.postMessage({\n\t\t\t\t\t\taction:ed.action\n\t\t\t\t\t\t,id:ed.id\n\t\t\t\t\t\t,blob:new Blob(cur.encArr,{type:\"audio/mp3\"})\n\t\t\t\t\t\t,meta:meta\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\t};\n\t\t\t};\n\t\t\t\n\t\t\t//创建一个新Worker\n\t\t\tvar jsCode=\");wk_lame();var wk_ctxs={};self.onmessage=\"+onmsg;\n\t\t\tjsCode+=\";var wk_mp3TrimFix={rm:\"+mp3TrimFix.rm+\",fn:\"+mp3TrimFix.fn+\"}\";\n\t\t\t\n\t\t\tvar lamejsCode=Recorder.lamejs.toString();\n\t\t\tvar url=(window.URL||webkitURL).createObjectURL(new Blob([\"var wk_lame=(\",lamejsCode,jsCode], {type:\"text/javascript\"}));\n\t\t\t\n\t\t\tworker=new Worker(url);\n\t\t\tsetTimeout(function(){\n\t\t\t\t(window.URL||webkitURL).revokeObjectURL(url);//必须要释放，不然每次调用内存都明显泄露内存\n\t\t\t},10000);//chrome 83 file协议下如果直接释放，将会使WebWorker无法启动\n\t\t\t\n\t\t\tworker.onmessage=function(e){\n\t\t\t\tvar data=e.data;\n\t\t\t\tvar ctx=openList[data.id];\n\t\t\t\tif(ctx){\n\t\t\t\t\tif(data.action==\"takeoff\"){\n\t\t\t\t\t\t//取走实时生成的mp3数据\n\t\t\t\t\t\tctx.set.takeoffEncodeChunk(new Uint8Array(data.chunk.buffer));\n\t\t\t\t\t}else{\n\t\t\t\t\t\t//complete\n\t\t\t\t\t\tctx.call&&ctx.call(data);\n\t\t\t\t\t\tctx.call=null;\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t\t\n\t\tvar ctx={worker:worker,set:setOrNull,takeoffQueue:[]};\n\t\tif(setOrNull){\n\t\t\tctx.id=++openList.id;\n\t\t\topenList[ctx.id]=ctx;\n\t\t\t\n\t\t\tworker.postMessage({\n\t\t\t\taction:\"init\"\n\t\t\t\t,id:ctx.id\n\t\t\t\t,sampleRate:setOrNull.sampleRate\n\t\t\t\t,bitRate:setOrNull.bitRate\n\t\t\t\t,takeoff:!!setOrNull.takeoffEncodeChunk\n\t\t\t\t\n\t\t\t\t,x:new Int16Array(5)//低版本浏览器不支持序列化TypedArray\n\t\t\t});\n\t\t}else{\n\t\t\tworker.postMessage({\n\t\t\t\tx:new Int16Array(5)//低版本浏览器不支持序列化TypedArray\n\t\t\t});\n\t\t};\n\t\t\n\t\t\n\t\tmp3Worker=worker;\n\t\treturn ctx;\n\t}catch(e){//出错了就不要提供了\n\t\tworker&&worker.terminate();\n\t\t\n\t\tconsole.error(e);\n\t\treturn null;\n\t};\n};\nRecorder.prototype.mp3_stop=function(startCtx){\n\tif(startCtx&&startCtx.worker){\n\t\tstartCtx.worker.postMessage({\n\t\t\taction:\"stop\"\n\t\t\t,id:startCtx.id\n\t\t});\n\t\tstartCtx.worker=null;\n\t\tdelete openList[startCtx.id];\n\t\t\n\t\t//疑似泄露检测 排除id\n\t\tvar opens=-1;\n\t\tfor(var k in openList){\n\t\t\topens++;\n\t\t};\n\t\tif(opens){\n\t\t\tconsole.warn(\"mp3 worker剩\"+opens+\"个在串行等待\");\n\t\t};\n\t};\n};\nRecorder.prototype.mp3_encode=function(startCtx,pcm){\n\tif(startCtx&&startCtx.worker){\n\t\tstartCtx.worker.postMessage({\n\t\t\taction:\"encode\"\n\t\t\t,id:startCtx.id\n\t\t\t,pcm:pcm\n\t\t});\n\t};\n};\nRecorder.prototype.mp3_complete=function(startCtx,True,False,autoStop){\n\tvar This=this;\n\tif(startCtx&&startCtx.worker){\n\t\tstartCtx.call=function(data){\n\t\t\tmp3TrimFixSetMeta(data.meta,startCtx.set);\n\t\t\tTrue(data.blob);\n\t\t\t\n\t\t\tif(autoStop){\n\t\t\t\tThis.mp3_stop(startCtx);\n\t\t\t};\n\t\t};\n\t\tstartCtx.worker.postMessage({\n\t\t\taction:\"complete\"\n\t\t\t,id:startCtx.id\n\t\t});\n\t}else{\n\t\tFalse(\"mp3编码器未打开\");\n\t};\n};\n\n\n\n\n\n\n\n//*******辅助函数************\n\n/*读取lamejs编码出来的mp3信息，只能读特定格式，如果读取失败返回null\nmp3Buffers=[ArrayBuffer,...]\nlength=mp3Buffers的数据二进制总长度\n*/\nRecorder.mp3ReadMeta=function(mp3Buffers,length){\n\t//kill babel-polyfill ES6 Number.parseInt 不然放到Worker里面找不到方法\n\tvar parseInt_ES3=typeof(window)==\"object\"?window.parseInt:self.parseInt;\n\t\n\tvar u8arr0=new Uint8Array(mp3Buffers[0]||[]);\n\tif(u8arr0.length<4){\n\t\treturn null;\n\t};\n\tvar byteAt=function(idx,u8){\n\t\treturn (\"0000000\"+((u8||u8arr0)[idx]||0).toString(2)).substr(-8);\n\t};\n\tvar b2=byteAt(0)+byteAt(1);\n\tvar b4=byteAt(2)+byteAt(3);\n\t\n\tif(!/^1{11}/.test(b2)){//未发现帧同步\n\t\treturn null;\n\t};\n\tvar version=({\"00\":2.5,\"10\":2,\"11\":1})[b2.substr(11,2)];\n\tvar layer=({\"01\":3})[b2.substr(13,2)];//仅支持Layer3\n\tvar sampleRate=({ //lamejs -> Tables.samplerate_table\n\t\t\"1\":[44100, 48000, 32000]\n\t\t,\"2\":[22050, 24000, 16000]\n\t\t,\"2.5\":[11025, 12000, 8000]\n\t})[version];\n\tsampleRate&&(sampleRate=sampleRate[parseInt_ES3(b4.substr(4,2),2)]);\n\tvar bitRate=[ //lamejs -> Tables.bitrate_table\n\t\t[0, 8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160] //MPEG 2 2.5\n\t\t,[0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320]//MPEG 1\n\t][version==1?1:0][parseInt_ES3(b4.substr(0,4),2)];\n\t\n\tif(!version || !layer || !bitRate || !sampleRate){\n\t\treturn null;\n\t};\n\t\n\tvar duration=Math.round(length*8/bitRate);\n\tvar frame=layer==1?384:layer==2?1152:version==1?1152:576;\n\tvar frameDurationFloat=frame/sampleRate*1000;\n\tvar frameSize=Math.floor((frame*bitRate)/8/sampleRate*1000);\n\t\n\t//检测是否存在Layer3帧填充1字节。这里只获取第二帧的填充信息，首帧永远没有填充。其他帧可能隔一帧出现一个填充，或者隔很多帧出现一个填充；目测是取决于frameSize未舍入时的小数部分，因为有些采样率的frameSize会出现小数（11025、22050、44100 典型的除不尽），然后字节数无法表示这种小数，就通过一定步长来填充弥补小数部分丢失\n\tvar hasPadding=0,seek=0;\n\tfor(var i=0;i<mp3Buffers.length;i++){\n\t\t//寻找第二帧\n\t\tvar buf=mp3Buffers[i];\n\t\tseek+=buf.byteLength;\n\t\tif(seek>=frameSize+3){\n\t\t\tvar buf8=new Uint8Array(buf);\n\t\t\tvar idx=buf.byteLength-(seek-(frameSize+3)+1);\n\t\t\tvar ib4=byteAt(idx,buf8);\n\t\t\thasPadding=ib4.charAt(6)==\"1\";\n\t\t\tbreak;\n\t\t};\n\t};\n\tif(hasPadding){\n\t\tframeSize++;\n\t};\n\t\n\t\n\treturn {\n\t\tversion:version //1 2 2.5 -> MPEG1 MPEG2 MPEG2.5\n\t\t,layer:layer//3 -> Layer3\n\t\t,sampleRate:sampleRate //采样率 hz\n\t\t,bitRate:bitRate //比特率 kbps\n\t\t\n\t\t,duration:duration //音频时长 ms\n\t\t,size:length //总长度 byte\n\t\t,hasPadding:hasPadding //是否存在1字节填充，首帧永远没有，这个值其实代表的第二帧是否有填充，并不代表其他帧的\n\t\t,frameSize:frameSize //每帧最大长度，含可能存在的1字节padding byte\n\t\t,frameDurationFloat:frameDurationFloat //每帧时长，含小数 ms\n\t};\n};\n\n//去掉lamejs开头的标记信息帧，免得mp3解码出来的时长比pcm的长太多\nvar mp3TrimFix={//minfiy keep name\nrm:Recorder.mp3ReadMeta\n,fn:function(mp3Buffers,length,pcmLength,pcmSampleRate){\n\tvar meta=this.rm(mp3Buffers,length);\n\tif(!meta){\n\t\treturn {err:\"mp3非预定格式\"};\n\t};\n\tvar pcmDuration=Math.round(pcmLength/pcmSampleRate*1000);\n\t\n\t//开头多出这么多帧，移除掉；正常情况下最多为2帧\n\tvar num=Math.floor((meta.duration-pcmDuration)/meta.frameDurationFloat);\n\tif(num>0){\n\t\tvar size=num*meta.frameSize-(meta.hasPadding?1:0);//首帧没有填充，第二帧可能有填充，这里假设最多为2帧（测试并未出现3帧以上情况），其他帧不管，就算出现了并且导致了错误后面自动容错\n\t\tlength-=size;\n\t\tvar arr0=0,arrs=[];\n\t\tfor(var i=0;i<mp3Buffers.length;i++){\n\t\t\tvar arr=mp3Buffers[i];\n\t\t\tif(size<=0){\n\t\t\t\tbreak;\n\t\t\t};\n\t\t\tif(size>=arr.byteLength){\n\t\t\t\tsize-=arr.byteLength;\n\t\t\t\tarrs.push(arr);\n\t\t\t\tmp3Buffers.splice(i,1);\n\t\t\t\ti--;\n\t\t\t}else{\n\t\t\t\tmp3Buffers[i]=arr.slice(size);\n\t\t\t\tarr0=arr;\n\t\t\t\tsize=0;\n\t\t\t};\n\t\t};\n\t\tvar checkMeta=this.rm(mp3Buffers,length);\n\t\tif(!checkMeta){\n\t\t\t//还原变更，应该不太可能会出现\n\t\t\tarr0&&(mp3Buffers[0]=arr0);\n\t\t\tfor(var i=0;i<arrs.length;i++){\n\t\t\t\tmp3Buffers.splice(i,0,arrs[i]);\n\t\t\t};\n\t\t\tmeta.err=\"fix后数据错误，已还原，错误原因不明\";\n\t\t};\n\t\t\n\t\tvar fix=meta.trimFix={};\n\t\tfix.remove=num;\n\t\tfix.removeDuration=Math.round(num*meta.frameDurationFloat);\n\t\tfix.duration=Math.round(length*8/meta.bitRate);\n\t};\n\treturn meta;\n}\n};\nvar mp3TrimFixSetMeta=function(meta,set){\n\tvar tag=\"MP3信息 \";\n\tif(meta.sampleRate&&meta.sampleRate!=set.sampleRate || meta.bitRate&&meta.bitRate!=set.bitRate){\n\t\tconsole.warn(tag+\"和设置的不匹配set:\"+set.bitRate+\"kbps \"+set.sampleRate+\"hz，已更新set:\"+meta.bitRate+\"kbps \"+meta.sampleRate+\"hz\",set);\n\t\tset.sampleRate=meta.sampleRate;\n\t\tset.bitRate=meta.bitRate;\n\t};\n\t\n\tvar trimFix=meta.trimFix;\n\tif(trimFix){\n\t\ttag+=\"Fix移除\"+trimFix.remove+\"帧\"+trimFix.removeDuration+\"ms -> \"+trimFix.duration+\"ms\";\n\t\tif(trimFix.remove>2){\n\t\t\tmeta.err=(meta.err?meta.err+\", \":\"\")+\"移除帧数过多\";\n\t\t};\n\t}else{\n\t\ttag+=(meta.duration||\"-\")+\"ms\";\n\t};\n\t\n\tif(meta.err){\n\t\tconsole.error(tag,meta.err,meta);\n\t}else{\n\t\tconsole.log(tag,meta);\n\t};\n};\n\n\n\t\n})();","/*\n录音\nhttps://github.com/xiangyuecn/Recorder\n*/\n(function(factory){\n\tfactory(window);\n\t//umd returnExports.js\n\tif(typeof(define)=='function' && define.amd){\n\t\tdefine(function(){\n\t\t\treturn Recorder;\n\t\t});\n\t};\n\tif(typeof(module)=='object' && module.exports){\n\t\tmodule.exports=Recorder;\n\t};\n}(function(window){\n\"use strict\";\n\n//兼容环境\nvar LM=\"2020-11-15 21:36:11\";\nvar NOOP=function(){};\n//end 兼容环境 ****从以下开始copy源码*****\n\nvar Recorder=function(set){\n\treturn new initFn(set);\n};\n//是否已经打开了录音，所有工作都已经准备好了，就等接收音频数据了\nRecorder.IsOpen=function(){\n\tvar stream=Recorder.Stream;\n\tif(stream){\n\t\tvar tracks=stream.getTracks&&stream.getTracks()||stream.audioTracks||[];\n\t\tvar track=tracks[0];\n\t\tif(track){\n\t\t\tvar state=track.readyState;\n\t\t\treturn state==\"live\"||state==track.LIVE;\n\t\t};\n\t};\n\treturn false;\n};\n/*H5录音时的AudioContext缓冲大小。会影响H5录音时的onProcess调用速率，相对于AudioContext.sampleRate=48000时，4096接近12帧/s，调节此参数可生成比较流畅的回调动画。\n\t取值256, 512, 1024, 2048, 4096, 8192, or 16384\n\t注意，取值不能过低，2048开始不同浏览器可能回调速率跟不上造成音质问题。\n\t一般无需调整，调整后需要先close掉已打开的录音，再open时才会生效。\n*/\nRecorder.BufferSize=4096;\n//销毁已持有的所有全局资源，当要彻底移除Recorder时需要显式的调用此方法\nRecorder.Destroy=function(){\n\tCLog(\"Recorder Destroy\");\n\tfor(var k in DestroyList){\n\t\tDestroyList[k]();\n\t};\n};\nvar DestroyList={};\n//登记一个需要销毁全局资源的处理方法\nRecorder.BindDestroy=function(key,call){\n\tDestroyList[key]=call;\n};\n//判断浏览器是否支持录音，随时可以调用。注意：仅仅是检测浏览器支持情况，不会判断和调起用户授权，不会判断是否支持特定格式录音。\nRecorder.Support=function(){\n\tvar AC=window.AudioContext;\n\tif(!AC){\n\t\tAC=window.webkitAudioContext;\n\t};\n\tif(!AC){\n\t\treturn false;\n\t};\n\tvar scope=navigator.mediaDevices||{};\n\tif(!scope.getUserMedia){\n\t\tscope=navigator;\n\t\tscope.getUserMedia||(scope.getUserMedia=scope.webkitGetUserMedia||scope.mozGetUserMedia||scope.msGetUserMedia);\n\t};\n\tif(!scope.getUserMedia){\n\t\treturn false;\n\t};\n\t\n\tRecorder.Scope=scope;\n\tif(!Recorder.Ctx||Recorder.Ctx.state==\"closed\"){\n\t\t//不能反复构造，低版本number of hardware contexts reached maximum (6)\n\t\tRecorder.Ctx=new AC();\n\t\t\n\t\tRecorder.BindDestroy(\"Ctx\",function(){\n\t\t\tvar ctx=Recorder.Ctx;\n\t\t\tctx&&ctx.close&&ctx.close();\n\t\t});\n\t};\n\treturn true;\n};\n/*初始化H5音频采集连接，因为Stream是全局的，Safari上断开后就无法再次进行连接使用，表现为静音，因此使用全部使用全局处理避免调用到disconnect；全局处理也有利于屏蔽底层细节，start时无需再调用底层接口，提升兼容、可靠性。*/\nvar Connect=function(){\n\tvar ctx=Recorder.Ctx,stream=Recorder.Stream;\n\tvar media=stream._m=ctx.createMediaStreamSource(stream);\n\tvar process=stream._p=(ctx.createScriptProcessor||ctx.createJavaScriptNode).call(ctx,Recorder.BufferSize,1,1);//单声道，省的数据处理复杂\n\t\n\tmedia.connect(process);\n\tprocess.connect(ctx.destination);\n\t\n\tvar calls=stream._call;\n\tprocess.onaudioprocess=function(e){\n\t\tfor(var k0 in calls){//has item\n\t\t\tvar o=e.inputBuffer.getChannelData(0);//块是共享的，必须复制出来\n\t\t\tvar size=o.length;\n\t\t\t\n\t\t\tvar pcm=new Int16Array(size);\n\t\t\tvar sum=0;\n\t\t\tfor(var j=0;j<size;j++){//floatTo16BitPCM \n\t\t\t\tvar s=Math.max(-1,Math.min(1,o[j]));\n\t\t\t\ts=s<0?s*0x8000:s*0x7FFF;\n\t\t\t\tpcm[j]=s;\n\t\t\t\tsum+=Math.abs(s);\n\t\t\t};\n\t\t\t\n\t\t\tfor(var k in calls){\n\t\t\t\tcalls[k](pcm,sum);\n\t\t\t};\n\t\t\t\n\t\t\treturn;\n\t\t};\n\t};\n};\nvar Disconnect=function(){\n\tvar stream=Recorder.Stream;\n\tif(stream._m){\n\t\tstream._m.disconnect();\n\t\tstream._p.disconnect();\n\t\tstream._p.onaudioprocess=stream._p=stream._m=null;\n\t};\n};\n\n/*对pcm数据的采样率进行转换\npcmDatas: [[Int16,...]] pcm片段列表\npcmSampleRate:48000 pcm数据的采样率\nnewSampleRate:16000 需要转换成的采样率，newSampleRate>=pcmSampleRate时不会进行任何处理，小于时会进行重新采样\nprevChunkInfo:{} 可选，上次调用时的返回值，用于连续转换，本次调用将从上次结束位置开始进行处理。或可自行定义一个ChunkInfo从pcmDatas指定的位置开始进行转换\noption:{ 可选，配置项\n\t\tframeSize:123456 帧大小，每帧的PCM Int16的数量，采样率转换后的pcm长度为frameSize的整数倍，用于连续转换。目前仅在mp3格式时才有用，frameSize取值为1152，这样编码出来的mp3时长和pcm的时长完全一致，否则会因为mp3最后一帧录音不够填满时添加填充数据导致mp3的时长变长。\n\t\tframeType:\"\" 帧类型，一般为rec.set.type，提供此参数时无需提供frameSize，会自动使用最佳的值给frameSize赋值，目前仅支持mp3=1152(MPEG1 Layer3的每帧采采样数)，其他类型=1。\n\t\t\t以上两个参数用于连续转换时使用，最多使用一个，不提供时不进行帧的特殊处理，提供时必须同时提供prevChunkInfo才有作用。最后一段数据处理时无需提供帧大小以便输出最后一丁点残留数据。\n\t}\n\n返回ChunkInfo:{\n\t//可定义，从指定位置开始转换到结尾\n\tindex:0 pcmDatas已处理到的索引\n\toffset:0.0 已处理到的index对应的pcm中的偏移的下一个位置\n\t\n\t//仅作为返回值\n\tframeNext:null||[Int16,...] 下一帧的部分数据，frameSize设置了的时候才可能会有\n\tsampleRate:16000 结果的采样率，<=newSampleRate\n\tdata:[Int16,...] 转换后的PCM结果；如果是连续转换，并且pcmDatas中并没有新数据时，data的长度可能为0\n}\n*/\nRecorder.SampleData=function(pcmDatas,pcmSampleRate,newSampleRate,prevChunkInfo,option){\n\tprevChunkInfo||(prevChunkInfo={});\n\tvar index=prevChunkInfo.index||0;\n\tvar offset=prevChunkInfo.offset||0;\n\t\n\tvar frameNext=prevChunkInfo.frameNext||[];\n\toption||(option={});\n\tvar frameSize=option.frameSize||1;\n\tif(option.frameType){\n\t\tframeSize=option.frameType==\"mp3\"?1152:1;\n\t};\n\t\n\tvar size=0;\n\tfor(var i=index;i<pcmDatas.length;i++){\n\t\tsize+=pcmDatas[i].length;\n\t};\n\tsize=Math.max(0,size-Math.floor(offset));\n\t\n\t//采样 https://www.cnblogs.com/blqw/p/3782420.html\n\tvar step=pcmSampleRate/newSampleRate;\n\tif(step>1){//新采样低于录音采样，进行抽样\n\t\tsize=Math.floor(size/step);\n\t}else{//新采样高于录音采样不处理，省去了插值处理\n\t\tstep=1;\n\t\tnewSampleRate=pcmSampleRate;\n\t};\n\t\n\tsize+=frameNext.length;\n\tvar res=new Int16Array(size);\n\tvar idx=0;\n\t//添加上一次不够一帧的剩余数据\n\tfor(var i=0;i<frameNext.length;i++){\n\t\tres[idx]=frameNext[i];\n\t\tidx++;\n\t};\n\t//处理数据\n\tfor (var nl=pcmDatas.length;index<nl;index++) {\n\t\tvar o=pcmDatas[index];\n\t\tvar i=offset,il=o.length;\n\t\twhile(i<il){\n\t\t\t//res[idx]=o[Math.round(i)]; 直接简单抽样\n\t\t\t\n\t\t\t//https://www.cnblogs.com/xiaoqi/p/6993912.html\n\t\t\t//当前点=当前点+到后面一个点之间的增量，音质比直接简单抽样好些\n\t\t\tvar before = Math.floor(i);\n\t\t\tvar after = Math.ceil(i);\n\t\t\tvar atPoint = i - before;\n\t\t\t\n\t\t\tvar beforeVal=o[before];\n\t\t\tvar afterVal=after<il ? o[after]\n\t\t\t\t: (//后个点越界了，查找下一个数组\n\t\t\t\t\t(pcmDatas[index+1]||[beforeVal])[0]||0\n\t\t\t\t);\n\t\t\tres[idx]=beforeVal+(afterVal-beforeVal)*atPoint;\n\t\t\t\n\t\t\tidx++;\n\t\t\ti+=step;//抽样\n\t\t};\n\t\toffset=i-il;\n\t};\n\t//帧处理\n\tframeNext=null;\n\tvar frameNextSize=res.length%frameSize;\n\tif(frameNextSize>0){\n\t\tvar u8Pos=(res.length-frameNextSize)*2;\n\t\tframeNext=new Int16Array(res.buffer.slice(u8Pos));\n\t\tres=new Int16Array(res.buffer.slice(0,u8Pos));\n\t};\n\t\n\treturn {\n\t\tindex:index\n\t\t,offset:offset\n\t\t\n\t\t,frameNext:frameNext\n\t\t,sampleRate:newSampleRate\n\t\t,data:res\n\t};\n};\n\n\n/*计算音量百分比的一个方法\npcmAbsSum: pcm Int16所有采样的绝对值的和\npcmLength: pcm长度\n返回值：0-100，主要当做百分比用\n注意：这个不是分贝，因此没用volume当做名称*/\nRecorder.PowerLevel=function(pcmAbsSum,pcmLength){\n\t/*计算音量 https://blog.csdn.net/jody1989/article/details/73480259\n\t更高灵敏度算法:\n\t\t限定最大感应值10000\n\t\t\t线性曲线：低音量不友好\n\t\t\t\tpower/10000*100 \n\t\t\t对数曲线：低音量友好，但需限定最低感应值\n\t\t\t\t(1+Math.log10(power/10000))*100\n\t*/\n\tvar power=(pcmAbsSum/pcmLength) || 0;//NaN\n\tvar level;\n\tif(power<1251){//1250的结果10%，更小的音量采用线性取值\n\t\tlevel=Math.round(power/1250*10);\n\t}else{\n\t\tlevel=Math.round(Math.min(100,Math.max(0,(1+Math.log(power/10000)/Math.log(10))*100)));\n\t};\n\treturn level;\n};\n\n\n\n\n//带时间的日志输出，CLog(msg,errOrLogMsg, logMsg...) err为数字时代表日志类型1:error 2:log默认 3:warn，否则当做内容输出，第一个参数不能是对象因为要拼接时间，后面可以接无数个输出参数\nvar CLog=function(msg,err){\n\tvar now=new Date();\n\tvar t=(\"0\"+now.getMinutes()).substr(-2)\n\t\t+\":\"+(\"0\"+now.getSeconds()).substr(-2)\n\t\t+\".\"+(\"00\"+now.getMilliseconds()).substr(-3);\n\tvar arr=[\"[\"+t+\" Recorder]\"+msg];\n\tvar a=arguments;\n\tvar i=2,fn=console.log;\n\tif(typeof(err)==\"number\"){\n\t\tfn=err==1?console.error:err==3?console.warn:fn;\n\t}else{\n\t\ti=1;\n\t};\n\tfor(;i<a.length;i++){\n\t\tarr.push(a[i]);\n\t};\n\tfn.apply(console,arr);\n};\nRecorder.CLog=CLog;\n\n\n\n\nvar ID=0;\nfunction initFn(set){\n\tthis.id=++ID;\n\t\n\t//如果开启了流量统计，这里将发送一个图片请求\n\tRecorder.Traffic&&Recorder.Traffic();\n\t\n\t\n\tvar o={\n\t\ttype:\"mp3\" //输出类型：mp3,wav，wav输出文件尺寸超大不推荐使用，但mp3编码支持会导致js文件超大，如果不需支持mp3可以使js文件大幅减小\n\t\t,bitRate:16 //比特率 wav:16或8位，MP3：8kbps 1k/s，8kbps 2k/s 录音文件很小\n\t\t\n\t\t,sampleRate:16000 //采样率，wav格式大小=sampleRate*时间；mp3此项对低比特率有影响，高比特率几乎无影响。\n\t\t\t\t\t//wav任意值，mp3取值范围：48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000\n\t\t\t\t\t//采样率参考https://www.cnblogs.com/devin87/p/mp3-recorder.html\n\t\t\n\t\t,onProcess:NOOP //fn(buffers,powerLevel,bufferDuration,bufferSampleRate,newBufferIdx,asyncEnd) buffers=[[Int16,...],...]：缓冲的PCM数据，为从开始录音到现在的所有pcm片段；powerLevel：当前缓冲的音量级别0-100，bufferDuration：已缓冲时长，bufferSampleRate：缓冲使用的采样率（当type支持边录边转码(Worker)时，此采样率和设置的采样率相同，否则不一定相同）；newBufferIdx:本次回调新增的buffer起始索引；asyncEnd:fn() 如果onProcess是异步的(返回值为true时)，处理完成时需要调用此回调，如果不是异步的请忽略此参数，此方法回调时必须是真异步（不能真异步时需用setTimeout包裹）。onProcess返回值：如果返回true代表开启异步模式，在某些大量运算的场合异步是必须的，必须在异步处理完成时调用asyncEnd(不能真异步时需用setTimeout包裹)，在onProcess执行后新增的buffer会全部替换成空数组，因此本回调开头应立即将newBufferIdx到本次回调结尾位置的buffer全部保存到另外一个数组内，处理完成后写回buffers中本次回调的结尾位置。\n\t\t\n\t\t//*******高级设置******\n\t\t//,disableEnvInFix:false 内部参数，禁用设备卡顿时音频输入丢失补偿功能\n\t\t\n\t\t//,takeoffEncodeChunk:NOOP //fn(chunkBytes) chunkBytes=[Uint8,...]：实时编码环境下接管编码器输出，当编码器实时编码出一块有效的二进制音频数据时实时回调此方法；参数为二进制的Uint8Array，就是编码出来的音频数据片段，所有的chunkBytes拼接在一起即为完整音频。本实现的想法最初由QQ2543775048提出\n\t\t\t\t//当提供此回调方法时，将接管编码器的数据输出，编码器内部将放弃存储生成的音频数据；环境要求比较苛刻：如果当前环境不支持实时编码处理，将在open时直接走fail逻辑\n\t\t\t\t//因此提供此回调后调用stop方法将无法获得有效的音频数据，因为编码器内没有音频数据，因此stop时返回的blob将是一个字节长度为0的blob\n\t\t\t\t//目前只有mp3格式实现了实时编码，在支持实时处理的环境中将会实时的将编码出来的mp3片段通过此方法回调，所有的chunkBytes拼接到一起即为完整的mp3，此种拼接的结果比mock方法实时生成的音质更加，因为天然避免了首尾的静默\n\t\t\t\t//目前除mp3外其他格式不可以提供此回调，提供了将在open时直接走fail逻辑\n\t};\n\t\n\tfor(var k in set){\n\t\to[k]=set[k];\n\t};\n\tthis.set=o;\n\t\n\tthis._S=9;//stop同步锁，stop可以阻止open过程中还未运行的start\n};\n//同步锁，控制对Stream的竞争；用于close时中断异步的open；一个对象open如果变化了都要阻止close，Stream的控制权交个新的对象\nRecorder.Sync={/*open*/O:9,/*close*/C:9};\n\nRecorder.prototype=initFn.prototype={\n\t//打开录音资源True(),False(msg,isUserNotAllow)，需要调用close。注意：此方法是异步的；一般使用时打开，用完立即关闭；可重复调用，可用来测试是否能录音\n\topen:function(True,False){\n\t\tvar This=this;\n\t\tTrue=True||NOOP;\n\t\tvar failCall=function(errMsg,isUserNotAllow){\n\t\t\tisUserNotAllow=!!isUserNotAllow;\n\t\t\tCLog(\"录音open失败：\"+errMsg+\",isUserNotAllow:\"+isUserNotAllow,1);\n\t\t\tFalse&&False(errMsg,isUserNotAllow);\n\t\t};\n\t\t\n\t\tvar ok=function(){\n\t\t\tCLog(\"open成功\");\n\t\t\tTrue();\n\t\t\t\n\t\t\tThis._SO=0;//解除stop对open中的start调用的阻止\n\t\t};\n\t\tvar codeFail=function(code,msg){\n\t\t\ttry{//跨域的优先检测一下\n\t\t\t\twindow.top.a;\n\t\t\t}catch(e){\n\t\t\t\tfailCall('无权录音(跨域，请尝试给iframe添加麦克风访问策略，如allow=\"camera;microphone\")');\n\t\t\t\treturn;\n\t\t\t};\n\t\t\t\n\t\t\tif(/Permission|Allow/i.test(code)){\n\t\t\t\tfailCall(\"用户拒绝了录音权限\",true);\n\t\t\t}else if(window.isSecureContext===false){\n\t\t\t\tfailCall(\"无权录音(需https)\");\n\t\t\t}else if(/Found/i.test(code)){//可能是非安全环境导致的没有设备\n\t\t\t\tfailCall(msg+\"，无可用麦克风\");\n\t\t\t}else{\n\t\t\t\tfailCall(msg);\n\t\t\t};\n\t\t};\n\t\t\n\t\t//同步锁\n\t\tvar Lock=Recorder.Sync;\n\t\tvar lockOpen=++Lock.O,lockClose=Lock.C;\n\t\tThis._O=This._O_=lockOpen;//记住当前的open，如果变化了要阻止close，这里假定了新对象已取代当前对象并且不再使用\n\t\tThis._SO=This._S;//记住open过程中的stop，中途任何stop调用后都不能继续open中的start\n\t\tvar lockFail=function(){\n\t\t\t//允许多次open，但不允许任何一次close，或者自身已经调用了关闭\n\t\t\tif(lockClose!=Lock.C || !This._O){\n\t\t\t\tvar err=\"open被取消\";\n\t\t\t\tif(lockOpen==Lock.O){\n\t\t\t\t\t//无新的open，已经调用了close进行取消，此处应让上次的close明确生效\n\t\t\t\t\tThis.close();\n\t\t\t\t}else{\n\t\t\t\t\terr=\"open被中断\";\n\t\t\t\t};\n\t\t\t\tfailCall(err);\n\t\t\t\treturn true;\n\t\t\t};\n\t\t};\n\t\t\n\t\t\n\t\t//如果已打开就不要再打开了\n\t\tif(Recorder.IsOpen()){\n\t\t\tok();\n\t\t\treturn;\n\t\t};\n\t\tif(!Recorder.Support()){\n\t\t\tcodeFail(\"\",\"此浏览器不支持录音\");\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//环境配置检查\n\t\tvar checkMsg=This.envCheck({envName:\"H5\",canProcess:true});\n\t\tif(checkMsg){\n\t\t\tfailCall(\"不能录音：\"+checkMsg);\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//请求权限，如果从未授权，一般浏览器会弹出权限请求弹框\n\t\tvar f1=function(stream){\n\t\t\tRecorder.Stream=stream;\n\t\t\tstream._call={};//此时is open，但并未connect，是允许绑定接收数据的\n\t\t\tif(lockFail())return;\n\t\t\t\n\t\t\t//https://github.com/xiangyuecn/Recorder/issues/14 获取到的track.readyState!=\"live\"，刚刚回调时可能是正常的，但过一下可能就被关掉了，原因不明。延迟一下保证真异步。对正常浏览器不影响\n\t\t\tsetTimeout(function(){\n\t\t\t\tif(lockFail())return;\n\t\t\t\t\n\t\t\t\tif(Recorder.IsOpen()){\n\t\t\t\t\tConnect();\n\t\t\t\t\tok();\n\t\t\t\t}else{\n\t\t\t\t\tfailCall(\"录音功能无效：无音频流\");\n\t\t\t\t};\n\t\t\t},100);\n\t\t};\n\t\tvar f2=function(e){\n\t\t\tvar code=e.name||e.message||e.code+\":\"+e;\n\t\t\tCLog(\"请求录音权限错误\",1,e);\n\t\t\t\n\t\t\tcodeFail(code,\"无法录音：\"+code);\n\t\t};\n\t\tvar pro=Recorder.Scope.getUserMedia({audio:true},f1,f2);\n\t\tif(pro&&pro.then){\n\t\t\tpro.then(f1)[True&&\"catch\"](f2); //fix 关键字，保证catch压缩时保持字符串形式\n\t\t};\n\t}\n\t//关闭释放录音资源\n\t,close:function(call){\n\t\tcall=call||NOOP;\n\t\t\n\t\tvar This=this;\n\t\tThis._stop();\n\t\t\n\t\tvar Lock=Recorder.Sync;\n\t\tThis._O=0;\n\t\tif(This._O_!=Lock.O){\n\t\t\t//唯一资源Stream的控制权已交给新对象，这里不能关闭。此处在每次都弹权限的浏览器内可能存在泄漏，新对象被拒绝权限可能不会调用close，忽略这种不处理\n\t\t\tCLog(\"close被忽略\",3);\n\t\t\tcall();\n\t\t\treturn;\n\t\t};\n\t\tLock.C++;//获得控制权\n\t\t\n\t\tvar stream=Recorder.Stream;\n\t\tif(stream){\n\t\t\tDisconnect();\n\t\t\t\n\t\t\tvar tracks=stream.getTracks&&stream.getTracks()||stream.audioTracks||[];\n\t\t\tfor(var i=0;i<tracks.length;i++){\n\t\t\t\tvar track=tracks[i];\n\t\t\t\ttrack.stop&&track.stop();\n\t\t\t};\n\t\t\tstream.stop&&stream.stop();\n\t\t};\n\t\t\n\t\tRecorder.Stream=0;\n\t\tCLog(\"close\");\n\t\tcall();\n\t}\n\t\n\t\n\t\n\t\n\t\n\t/*模拟一段录音数据，后面可以调用stop进行编码，需提供pcm数据[1,2,3...]，pcm的采样率*/\n\t,mock:function(pcmData,pcmSampleRate){\n\t\tvar This=this;\n\t\tThis._stop();//清理掉已有的资源\n\t\t\n\t\tThis.isMock=1;\n\t\tThis.mockEnvInfo=null;\n\t\tThis.buffers=[pcmData];\n\t\tThis.recSize=pcmData.length;\n\t\tThis.srcSampleRate=pcmSampleRate;\n\t\treturn This;\n\t}\n\t,envCheck:function(envInfo){//平台环境下的可用性检查，任何时候都可以调用检查，返回errMsg:\"\"正常，\"失败原因\"\n\t\t//envInfo={envName:\"H5\",canProcess:true}\n\t\tvar errMsg,This=this,set=This.set;\n\t\t\n\t\t//编码器检查环境下配置是否可用\n\t\tif(!errMsg){\n\t\t\tif(This[set.type+\"_envCheck\"]){//编码器已实现环境检查\n\t\t\t\terrMsg=This[set.type+\"_envCheck\"](envInfo,set);\n\t\t\t}else{//未实现检查的手动检查配置是否有效\n\t\t\t\tif(set.takeoffEncodeChunk){\n\t\t\t\t\terrMsg=set.type+\"类型不支持设置takeoffEncodeChunk\";\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t\t\n\t\treturn errMsg||\"\";\n\t}\n\t,envStart:function(mockEnvInfo,sampleRate){//平台环境相关的start调用\n\t\tvar This=this,set=This.set;\n\t\tThis.isMock=mockEnvInfo?1:0;//非H5环境需要启用mock，并提供envCheck需要的环境信息\n\t\tThis.mockEnvInfo=mockEnvInfo;\n\t\tThis.buffers=[];//数据缓冲\n\t\tThis.recSize=0;//数据大小\n\t\t\n\t\tThis.envInLast=0;//envIn接收到最后录音内容的时间\n\t\tThis.envInFirst=0;//envIn接收到的首个录音内容的录制时间\n\t\tThis.envInFix=0;//补偿的总时间\n\t\tThis.envInFixTs=[];//补偿计数列表\n\t\t\n\t\tset.sampleRate=Math.min(sampleRate,set.sampleRate);//engineCtx需要提前确定最终的采样率\n\t\tThis.srcSampleRate=sampleRate;\n\t\t\n\t\tThis.engineCtx=0;\n\t\t//此类型有边录边转码(Worker)支持\n\t\tif(This[set.type+\"_start\"]){\n\t\t\tvar engineCtx=This.engineCtx=This[set.type+\"_start\"](set);\n\t\t\tif(engineCtx){\n\t\t\t\tengineCtx.pcmDatas=[];\n\t\t\t\tengineCtx.pcmSize=0;\n\t\t\t};\n\t\t};\n\t}\n\t,envResume:function(){//和平台环境无关的恢复录音\n\t\t//重新开始计数\n\t\tthis.envInFixTs=[];\n\t}\n\t,envIn:function(pcm,sum){//和平台环境无关的pcm[Int16]输入\n\t\tvar This=this,set=This.set,engineCtx=This.engineCtx;\n\t\tvar bufferSampleRate=This.srcSampleRate;\n\t\tvar size=pcm.length;\n\t\tvar powerLevel=Recorder.PowerLevel(sum,size);\n\t\t\n\t\tvar buffers=This.buffers;\n\t\tvar bufferFirstIdx=buffers.length;//之前的buffer都是经过onProcess处理好的，不允许再修改\n\t\tbuffers.push(pcm);\n\t\t\n\t\t//有engineCtx时会被覆盖，这里保存一份\n\t\tvar buffersThis=buffers;\n\t\tvar bufferFirstIdxThis=bufferFirstIdx;\n\t\t\n\t\t//卡顿丢失补偿：因为设备很卡的时候导致H5接收到的数据量不够造成播放时候变速，结果比实际的时长要短，此处保证了不会变短，但不能修复丢失的音频数据造成音质变差。当前算法采用输入时间侦测下一帧是否需要添加补偿帧，需要(6次输入||超过1秒)以上才会开始侦测，如果滑动窗口内丢失超过1/3就会进行补偿\n\t\tvar now=Date.now();\n\t\tvar pcmTime=Math.round(size/bufferSampleRate*1000);\n\t\tThis.envInLast=now;\n\t\tif(This.buffers.length==1){//记下首个录音数据的录制时间\n\t\t\tThis.envInFirst=now-pcmTime;\n\t\t};\n\t\tvar envInFixTs=This.envInFixTs;\n\t\tenvInFixTs.splice(0,0,{t:now,d:pcmTime});\n\t\t//保留3秒的计数滑动窗口，另外超过3秒的停顿不补偿\n\t\tvar tsInStart=now,tsPcm=0;\n\t\tfor(var i=0;i<envInFixTs.length;i++){\n\t\t\tvar o=envInFixTs[i];\n\t\t\tif(now-o.t>3000){\n\t\t\t\tenvInFixTs.length=i;\n\t\t\t\tbreak;\n\t\t\t};\n\t\t\ttsInStart=o.t;\n\t\t\ttsPcm+=o.d;\n\t\t};\n\t\t//达到需要的数据量，开始侦测是否需要补偿\n\t\tvar tsInPrev=envInFixTs[1];\n\t\tvar tsIn=now-tsInStart;\n\t\tvar lost=tsIn-tsPcm;\n\t\tif( lost>tsIn/3 && (tsInPrev&&tsIn>1000 || envInFixTs.length>=6) ){\n\t\t\t//丢失过多，开始执行补偿\n\t\t\tvar addTime=now-tsInPrev.t-pcmTime;//距离上次输入丢失这么多ms\n\t\t\tif(addTime>pcmTime/5){//丢失超过本帧的1/5\n\t\t\t\tvar fixOpen=!set.disableEnvInFix;\n\t\t\t\tCLog(\"[\"+now+\"]\"+(fixOpen?\"\":\"未\")+\"补偿\"+addTime+\"ms\",3);\n\t\t\t\tThis.envInFix+=addTime;\n\t\t\t\t\n\t\t\t\t//用静默进行补偿\n\t\t\t\tif(fixOpen){\n\t\t\t\t\tvar addPcm=new Int16Array(addTime*bufferSampleRate/1000);\n\t\t\t\t\tsize+=addPcm.length;\n\t\t\t\t\tbuffers.push(addPcm);\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t\t\n\t\t\n\t\tvar sizeOld=This.recSize,addSize=size;\n\t\tvar bufferSize=sizeOld+addSize;\n\t\tThis.recSize=bufferSize;//此值在onProcess后需要修正，可能新数据被修改\n\t\t\n\t\t\n\t\t//此类型有边录边转码(Worker)支持，开启实时转码\n\t\tif(engineCtx){\n\t\t\t//转换成set的采样率\n\t\t\tvar chunkInfo=Recorder.SampleData(buffers,bufferSampleRate,set.sampleRate,engineCtx.chunkInfo);\n\t\t\tengineCtx.chunkInfo=chunkInfo;\n\t\t\t\n\t\t\tsizeOld=engineCtx.pcmSize;\n\t\t\taddSize=chunkInfo.data.length;\n\t\t\tbufferSize=sizeOld+addSize;\n\t\t\tengineCtx.pcmSize=bufferSize;//此值在onProcess后需要修正，可能新数据被修改\n\t\t\t\n\t\t\tbuffers=engineCtx.pcmDatas;\n\t\t\tbufferFirstIdx=buffers.length;\n\t\t\tbuffers.push(chunkInfo.data);\n\t\t\tbufferSampleRate=chunkInfo.sampleRate;\n\t\t};\n\t\t\n\t\tvar duration=Math.round(bufferSize/bufferSampleRate*1000);\n\t\tvar bufferNextIdx=buffers.length;\n\t\tvar bufferNextIdxThis=buffersThis.length;\n\t\t\n\t\t//允许异步处理buffer数据\n\t\tvar asyncEnd=function(){\n\t\t\t//重新计算size，异步的早已减去添加的，同步的需去掉本次添加的然后重新计算\n\t\t\tvar num=asyncBegin?0:-addSize;\n\t\t\tvar hasClear=buffers[0]==null;\n\t\t\tfor(var i=bufferFirstIdx;i<bufferNextIdx;i++){\n\t\t\t\tvar buffer=buffers[i];\n\t\t\t\tif(buffer==null){//已被主动释放内存，比如长时间实时传输录音时\n\t\t\t\t\thasClear=1;\n\t\t\t\t}else{\n\t\t\t\t\tnum+=buffer.length;\n\t\t\t\t\t\n\t\t\t\t\t//推入后台边录边转码\n\t\t\t\t\tif(engineCtx&&buffer.length){\n\t\t\t\t\t\tThis[set.type+\"_encode\"](engineCtx,buffer);\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t};\n\t\t\t\n\t\t\t//同步清理This.buffers，不管buffers到底清了多少个，buffersThis是使用不到的进行全清\n\t\t\tif(hasClear && engineCtx){\n\t\t\t\tvar i=bufferFirstIdxThis;\n\t\t\t\tif(buffersThis[0]){\n\t\t\t\t\ti=0;\n\t\t\t\t};\n\t\t\t\tfor(;i<bufferNextIdxThis;i++){\n\t\t\t\t\tbuffersThis[i]=null;\n\t\t\t\t};\n\t\t\t};\n\t\t\t\n\t\t\t//统计修改后的size，如果异步发生clear要原样加回来，同步的无需操作\n\t\t\tif(hasClear){\n\t\t\t\tnum=asyncBegin?addSize:0;\n\t\t\t\t\n\t\t\t\tbuffers[0]=null;//彻底被清理\n\t\t\t};\n\t\t\tif(engineCtx){\n\t\t\t\tengineCtx.pcmSize+=num;\n\t\t\t}else{\n\t\t\t\tThis.recSize+=num;\n\t\t\t};\n\t\t};\n\t\t//实时回调处理数据，允许修改或替换上次回调以来新增的数据 ，但是不允许修改已处理过的，不允许增删第一维数组 ，允许将第二维数组任意修改替换成空数组也可以\n\t\tvar asyncBegin=set.onProcess(buffers,powerLevel,duration,bufferSampleRate,bufferFirstIdx,asyncEnd);\n\t\t\n\t\tif(asyncBegin===true){\n\t\t\t//开启了异步模式，onProcess已接管buffers新数据，立即清空，避免出现未处理的数据\n\t\t\tvar hasClear=0;\n\t\t\tfor(var i=bufferFirstIdx;i<bufferNextIdx;i++){\n\t\t\t\tif(buffers[i]==null){//已被主动释放内存，比如长时间实时传输录音时 ，但又要开启异步模式，此种情况是非法的\n\t\t\t\t\thasClear=1;\n\t\t\t\t}else{\n\t\t\t\t\tbuffers[i]=new Int16Array(0);\n\t\t\t\t};\n\t\t\t};\n\t\t\t\n\t\t\tif(hasClear){\n\t\t\t\tCLog(\"未进入异步前不能清除buffers\",3);\n\t\t\t}else{\n\t\t\t\t//还原size，异步结束后再统计仅修改后的size，如果发生clear要原样加回来\n\t\t\t\tif(engineCtx){\n\t\t\t\t\tengineCtx.pcmSize-=addSize;\n\t\t\t\t}else{\n\t\t\t\t\tThis.recSize-=addSize;\n\t\t\t\t};\n\t\t\t};\n\t\t}else{\n\t\t\tasyncEnd();\n\t\t};\n\t}\n\t\n\t\n\t\n\t\n\t//开始录音，需先调用open；只要open成功时，调用此方法是安全的，如果未open强行调用导致的内部错误将不会有任何提示，stop时自然能得到错误\n\t,start:function(){\n\t\tif(!Recorder.IsOpen()){\n\t\t\tCLog(\"未open\",1);\n\t\t\treturn;\n\t\t};\n\t\tCLog(\"开始录音\");\n\t\t\n\t\tvar This=this,set=This.set,ctx=Recorder.Ctx;\n\t\tThis._stop();\n\t\tThis.state=0;\n\t\tThis.envStart(null,ctx.sampleRate);\n\t\t\n\t\t//检查open过程中stop是否已经调用过\n\t\tif(This._SO&&This._SO+1!=This._S){//上面调用过一次 _stop\n\t\t\t//open未完成就调用了stop，此种情况终止start。也应尽量避免出现此情况\n\t\t\tCLog(\"start被中断\",3);\n\t\t\treturn;\n\t\t};\n\t\tThis._SO=0;\n\t\t\n\t\tvar end=function(){\n\t\t\tThis.state=1;\n\t\t\tThis.resume();\n\t\t};\n\t\tif(ctx.state==\"suspended\"){\n\t\t\tctx.resume().then(function(){\n\t\t\t\tCLog(\"ctx resume\");\n\t\t\t\tend();\n\t\t\t});\n\t\t}else{\n\t\t\tend();\n\t\t};\n\t}\n\t/*暂停录音*/\n\t,pause:function(){\n\t\tvar This=this;\n\t\tif(This.state){\n\t\t\tThis.state=2;\n\t\t\tCLog(\"pause\");\n\t\t\tdelete Recorder.Stream._call[This.id];\n\t\t};\n\t}\n\t/*恢复录音*/\n\t,resume:function(){\n\t\tvar This=this;\n\t\tif(This.state){\n\t\t\tThis.state=1;\n\t\t\tCLog(\"resume\");\n\t\t\tThis.envResume();\n\t\t\t\n\t\t\tRecorder.Stream._call[This.id]=function(pcm,sum){\n\t\t\t\tif(This.state==1){\n\t\t\t\t\tThis.envIn(pcm,sum);\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t}\n\t\n\t\n\t\n\t\n\t,_stop:function(keepEngine){\n\t\tvar This=this,set=This.set;\n\t\tif(!This.isMock){\n\t\t\tThis._S++;\n\t\t};\n\t\tif(This.state){\n\t\t\tThis.pause();\n\t\t\tThis.state=0;\n\t\t};\n\t\tif(!keepEngine && This[set.type+\"_stop\"]){\n\t\t\tThis[set.type+\"_stop\"](This.engineCtx);\n\t\t\tThis.engineCtx=0;\n\t\t};\n\t}\n\t/*\n\t结束录音并返回录音数据blob对象\n\t\tTrue(blob,duration) blob：录音数据audio/mp3|wav格式\n\t\t\t\t\t\t\tduration：录音时长，单位毫秒\n\t\tFalse(msg)\n\t\tautoClose:false 可选，是否自动调用close，默认为false\n\t*/\n\t,stop:function(True,False,autoClose){\n\t\tvar This=this,set=This.set,t1;\n\t\tCLog(\"Stop \"+(This.envInLast?This.envInLast-This.envInFirst+\"ms 补\"+This.envInFix+\"ms\":\"-\"));\n\t\t\n\t\tvar end=function(){\n\t\t\tThis._stop();//彻底关掉engineCtx\n\t\t\tif(autoClose){\n\t\t\t\tThis.close();\n\t\t\t};\n\t\t};\n\t\tvar err=function(msg){\n\t\t\tCLog(\"结束录音失败：\"+msg,1);\n\t\t\tFalse&&False(msg);\n\t\t\tend();\n\t\t};\n\t\tvar ok=function(blob,duration){\n\t\t\tCLog(\"结束录音 编码\"+(Date.now()-t1)+\"ms 音频\"+duration+\"ms/\"+blob.size+\"b\");\n\t\t\tif(set.takeoffEncodeChunk){//接管了输出，此时blob长度为0\n\t\t\t\tCLog(\"启用takeoffEncodeChunk后stop返回的blob长度为0不提供音频数据\",3);\n\t\t\t}else if(blob.size<Math.max(100,duration/2)){//1秒小于0.5k？\n\t\t\t\terr(\"生成的\"+set.type+\"无效\");\n\t\t\t\treturn;\n\t\t\t};\n\t\t\tTrue&&True(blob,duration);\n\t\t\tend();\n\t\t};\n\t\tif(!This.isMock){\n\t\t\tif(!This.state){\n\t\t\t\terr(\"未开始录音\");\n\t\t\t\treturn;\n\t\t\t};\n\t\t\tThis._stop(true);\n\t\t};\n\t\tvar size=This.recSize;\n\t\tif(!size){\n\t\t\terr(\"未采集到录音\");\n\t\t\treturn;\n\t\t};\n\t\tif(!This.buffers[0]){\n\t\t\terr(\"音频被释放\");\n\t\t\treturn;\n\t\t};\n\t\tif(!This[set.type]){\n\t\t\terr(\"未加载\"+set.type+\"编码器\");\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//环境配置检查，此处仅针对mock调用，因为open已经检查过了\n\t\tif(This.isMock){\n\t\t\tvar checkMsg=This.envCheck(This.mockEnvInfo||{envName:\"mock\",canProcess:false});//没有提供环境信息的mock时没有onProcess回调\n\t\t\tif(checkMsg){\n\t\t\t\terr(\"录音错误：\"+checkMsg);\n\t\t\t\treturn;\n\t\t\t};\n\t\t};\n\t\t\n\t\t//此类型有边录边转码(Worker)支持\n\t\tvar engineCtx=This.engineCtx;\n\t\tif(This[set.type+\"_complete\"]&&engineCtx){\n\t\t\tvar duration=Math.round(engineCtx.pcmSize/set.sampleRate*1000);//采用后的数据长度和buffers的长度可能微小的不一致，是采样率连续转换的精度问题\n\t\t\t\n\t\t\tt1=Date.now();\n\t\t\tThis[set.type+\"_complete\"](engineCtx,function(blob){\n\t\t\t\tok(blob,duration);\n\t\t\t},err);\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//标准UI线程转码，调整采样率\n\t\tt1=Date.now();\n\t\tvar chunk=Recorder.SampleData(This.buffers,This.srcSampleRate,set.sampleRate);\n\t\t\n\t\tset.sampleRate=chunk.sampleRate;\n\t\tvar res=chunk.data;\n\t\tvar duration=Math.round(res.length/set.sampleRate*1000);\n\t\t\n\t\tCLog(\"采样\"+size+\"->\"+res.length+\" 花:\"+(Date.now()-t1)+\"ms\");\n\t\t\n\t\tsetTimeout(function(){\n\t\t\tt1=Date.now();\n\t\t\tThis[set.type](res,function(blob){\n\t\t\t\tok(blob,duration);\n\t\t\t},function(msg){\n\t\t\t\terr(msg);\n\t\t\t});\n\t\t});\n\t}\n\n};\n\nif(window.Recorder){\n\twindow.Recorder.Destroy();\n};\nwindow.Recorder=Recorder;\n\n//end ****copy源码结束*****\nRecorder.LM=LM;\n\n//流量统计用1像素图片地址，设置为空将不参与统计\nRecorder.TrafficImgUrl=\"//ia.51.la/go1?id=20469973&pvFlag=1\";\nRecorder.Traffic=function(){\n\tvar imgUrl=Recorder.TrafficImgUrl;\n\tif(imgUrl){\n\t\tvar data=Recorder.Traffic;\n\t\tvar idf=location.href.replace(/#.*/,\"\");\n\t\t\n\t\tif(imgUrl.indexOf(\"//\")==0){\n\t\t\t//给url加上http前缀，如果是file协议下，不加前缀没法用\n\t\t\tif(/^https:/i.test(idf)){\n\t\t\t\timgUrl=\"https:\"+imgUrl;\n\t\t\t}else{\n\t\t\t\timgUrl=\"http:\"+imgUrl;\n\t\t\t};\n\t\t};\n\t\t\n\t\tif(!data[idf]){\n\t\t\tdata[idf]=1;\n\t\t\t\n\t\t\tvar img=new Image();\n\t\t\timg.src=imgUrl;\n\t\t\tCLog(\"Traffic Analysis Image: Recorder.TrafficImgUrl=\"+Recorder.TrafficImgUrl);\n\t\t};\n\t};\n};\n\n}));","export class ByteArray {\r\n\r\n    constructor() {\r\n        this.list=[];\r\n        this.byteOffset=0;\r\n        this.length=0;\r\n    }\r\n\r\n    push(unit8Arr) {\r\n        this.list.push(unit8Arr);\r\n        this.length+=unit8Arr.length;\r\n    }\r\n\r\n    readBytes(len) {\r\n        if(len>0){\r\n            let rbuf=new Uint8Array(len);\r\n            let rbuf_ind=0;\r\n            while(rbuf_ind<len){\r\n                if(this.list.length>0){\r\n                    let tmpbuf=this.list.shift();\r\n                    let tmplen=tmpbuf.length;\r\n                    let last_len=len-rbuf_ind;\r\n                    if(tmplen>=last_len){\r\n                        //足夠了\r\n                        let tmpbuf2 = tmpbuf.subarray(0, last_len);\r\n                        rbuf.set(tmpbuf2,rbuf_ind);\r\n                        rbuf_ind+=tmpbuf2.length;\r\n                        if(last_len<tmplen){\r\n                            let newUint8Array = tmpbuf.subarray(last_len, tmplen);\r\n                            this.list.unshift(newUint8Array);\r\n                        }\r\n                        break;\r\n                    }else{\r\n                        rbuf.set(tmpbuf,rbuf_ind);\r\n                        rbuf_ind+=tmplen;\r\n                    }\r\n                }else{\r\n                    rbuf=rbuf.subarray(0, rbuf_ind);\r\n                    break;\r\n                }\r\n            }\r\n            this.length-=rbuf.length;\r\n            return rbuf;\r\n        }\r\n        return null;\r\n    }\r\n\r\n}","\r\nexport class Util {\r\n    static isEmptyString(str) {\r\n        if (str == undefined || str == null || str == \"\") {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n}","import {GPlayerEvent, GErrorType, GPlaybackControlStatus} from './player/gplayer-events';\r\nimport {GTalkerEvent, GTalkerConnectStatus, GTalkerConnectErrorType} from './talker/gtalker-events';\r\nimport {GHelperEvent} from \"./helper/ghelper-events.js\";\r\nimport {GPlayer} from './player/gplayer.js';\r\nimport { HttpFlvPlayer } from './player/httpflv-player.js';\r\nimport { HttpFlvTalker } from './talker/httpflv-talker.js';\r\nimport { GHelper } from \"./helper/ghelper.js\";\r\n\r\nfunction createPlayer(url, config = null) {\r\n  let player = new HttpFlvPlayer();\r\n  player.init(url, config);\r\n  return player;\r\n}\r\n\r\nfunction createTalker(downUrl, upUrl, imei, channel, config = null) {\r\n  let talker = new HttpFlvTalker();\r\n  if (!talker.init(downUrl, upUrl, imei, channel, config)) {\r\n    return null;\r\n  }\r\n  return talker;\r\n}\r\n\r\nfunction createHelper(url) {\r\n  let helper = new GHelper();\r\n  helper.init(url);\r\n  return helper;\r\n}\r\n\r\nfunction isHttpFlvSupported() {\r\n  return HttpFlvPlayer.isSupported();\r\n}\r\n\r\nfunction isTalkSupported() {\r\n  return HttpFlvTalker.isSupported();\r\n}\r\n\r\nlet gmediajs = {};\r\n\r\ngmediajs.createPlayer = createPlayer;\r\ngmediajs.isHttpFlvSupported = isHttpFlvSupported;\r\ngmediajs.HttpFlvPlayer = HttpFlvPlayer;\r\ngmediajs.GPlayerEvent = GPlayerEvent;\r\ngmediajs.GErrorType = GErrorType;\r\ngmediajs.GPlaybackControlStatus = GPlaybackControlStatus;\r\n\r\ngmediajs.createTalker = createTalker;\r\ngmediajs.isTalkSupported = isTalkSupported;\r\ngmediajs.HttpFlvTalker = HttpFlvTalker;\r\ngmediajs.GTalkerEvent = GTalkerEvent;\r\ngmediajs.GTalkerConnectStatus = GTalkerConnectStatus;\r\ngmediajs.GTalkerConnectErrorType = GTalkerConnectErrorType;\r\n\r\ngmediajs.createHelper = createHelper;\r\ngmediajs.GHelper = GHelper;\r\ngmediajs.GHelperEvent = GHelperEvent;\r\n\r\nexport default gmediajs;","export const GHelperEvent = {\r\n    MEDIA_STATE: 'media_state'\r\n};","import {GHelperEvent} from \"./ghelper-events.js\"\r\nexport class GHelper {\r\n    constructor() {\r\n        this.callMediaState = null;\r\n        this.connect = null;\r\n    }\r\n\r\n    init(url) {\r\n        this.connect = new WebSocket(url);\r\n        this.connect.onopen = this._onConnectOpen.bind(this);\r\n        this.connect.onmessage = this._onConnectMessage.bind(this);\r\n        this.connect.onclose = this._onConnectClose.bind(this);\r\n        this.connect.onerror = this._onConnectError.bind(this);\r\n    }\r\n\r\n    on(event, call) {\r\n        if (event = GHelperEvent.MEDIA_STATE) {\r\n            this.callMediaState = call;\r\n        }\r\n    }\r\n\r\n    off(event) {\r\n        if (event = GHelperEvent.MEDIA_STATE) {\r\n            this.callMediaState = null;\r\n        }\r\n    }\r\n\r\n    destroy() {\r\n        this.callMediaState = null;\r\n\r\n        if (this.connect != null) {\r\n            this.connect.close();\r\n            this.connect = null;\r\n        }\r\n    }\r\n\r\n    _onConnectOpen() {\r\n        this._sendConsumeMediaStateCmd();\r\n    }\r\n\r\n    _onConnectMessage(e) {\r\n        let head = JSON.parse(e.data);\r\n        if (head == null || head.type == null) {\r\n            return;\r\n        }\r\n\r\n        if (head.type == \"mediastate\" && this.callMediaState != null) {\r\n            this.callMediaState(head.data);\r\n        }\r\n    }\r\n\r\n    _onConnectClose() {\r\n        \r\n    }\r\n\r\n    _onConnectError() {\r\n        \r\n    }\r\n\r\n    _sendConsumeMediaStateCmd() {\r\n        let head = {}\r\n        head[\"cmd\"] = \"consume\";\r\n        head[\"type\"] = \"mediastate\";\r\n        head[\"id\"] = \"\";\r\n        head[\"data\"] = {};\r\n\r\n        let msg = JSON.stringify(head);\r\n\r\n        this.connect.send(msg);\r\n    }\r\n}","module.exports = require('./gmedia.js').default;","export const GPlayerEvent = {\r\n    ERROR: 'error',\r\n    MEDIA_SOURCE_END: 'media_source_end',\r\n    TIMEUPDATE: 'timeupdate',\r\n    STATISTICS_INFO: 'statistics_info',\r\n    MEDIA_STATE: 'media_state',\r\n    PLAYBACK_CONTROL_EVENT: 'playback_control_event',\r\n};\r\n\r\nexport const GErrorType = {\r\n    NETWORK_ERROR: 'NetworkError',\r\n    MEDIA_ERROR: 'MediaError',\r\n    OTHER_ERROR: 'OtherError'\r\n};\r\n\r\nexport const GPlaybackControlStatus = {\r\n    SeekStart: 0,\r\n    SeekFail: 1,\r\n    SeekSuccess: 2\r\n};\r\n","export class GPlayer {\r\n\r\n    constructor(typeName) {\r\n        this._type = typeName || 'undefined';\r\n    }\r\n\r\n    init(url, config) {\r\n    }\r\n\r\n    on(event, call) {\r\n\r\n    }\r\n\r\n    off(event) {\r\n\r\n    }\r\n\r\n    attachMediaElement(mediaElement) {  \r\n    }\r\n\r\n    load() {\r\n    }\r\n\r\n    play() {\r\n\r\n    }\r\n\r\n    capture() {\r\n\r\n    }\r\n\r\n    pause() {\r\n        \r\n    }\r\n\r\n    resume() {\r\n        \r\n    }\r\n\r\n    seekToNewestTime () {\r\n\r\n    }\r\n\r\n    seek(time) {\r\n\r\n    }\r\n\r\n    setPlaySpeed(speed) {\r\n        \r\n    }\r\n\r\n    destroy() {\r\n\r\n    }\r\n\r\n}","import {GPlayerEvent, GErrorType, GPlaybackControlStatus} from \"./gplayer-events.js\"\r\nimport {GPlayer} from \"./gplayer.js\"\r\nimport flvjs from \"flv-g7.js\";\r\n\r\nimport {GHelperEvent} from \"../helper/ghelper-events.js\";\r\nimport { GHelper } from \"../helper/ghelper.js\";\r\n\r\nconst PlaybackKey = \"g7-flv-video-playback\";\r\n\r\nconst PlaybackControl = {\r\n    None:0,\r\n    Active:1,\r\n    Passive:2\r\n}\r\n\r\nexport class HttpFlvPlayer extends GPlayer {\r\n\r\n    constructor () {\r\n        super('httpflv-player');\r\n        this.TAG = 'HttpFlvPlayer';\r\n        \r\n        this.player = null;\r\n        this.element = null;\r\n        this.isLive = true;\r\n\r\n        this.helpUrl = null;\r\n        this.helper = null;\r\n\r\n        this.playbackPlan = 1;\r\n        this.playbackControl = PlaybackControl.None;\r\n\r\n        this.streamEnd = false;\r\n        this.needSeek = false;\r\n        this.seeking = false;\r\n        this.seekTime = 0;\r\n        this.newPlayStartTime = 0;\r\n        this.lastSendSeekTs = 0;\r\n\r\n        this.callbackTimeUpdate = null;\r\n        this.callbackStatistics = null;\r\n        this.callbackError = null;\r\n        this.callbackMediaSourceEnd = null;\r\n        this.callbackMediaState = null;\r\n        this.callbackPlaybackControlEvent = null;\r\n\r\n        this.checkerSeek = null;\r\n\r\n        this.e = {\r\n            onTimeUpdate : this._onElementTime.bind(this)\r\n        };\r\n    }\r\n\r\n    static isSupported() {\r\n        return window.MediaSource &&\r\n            window.MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"');\r\n    }\r\n\r\n    init (url, config) {\r\n        this._checkConfig(config);\r\n        this.isLive = this._checkIfLive(url);  \r\n        this.playbackControl = this._checkPlaybackControl(url);  \r\n\r\n        this.player = flvjs.createPlayer({isLive:this.isLive, type:'flv',url:url}, {\r\n            lazyLoad: false,\r\n            enableStashBuffer: false,\r\n            deferLoadAfterSourceOpen:true\r\n        });\r\n\r\n        this.player.on(flvjs.Events.STATISTICS_INFO, this._onStatisticsInfo.bind(this));\r\n        this.player.on(flvjs.Events.ERROR, this._onError.bind(this));\r\n        this.player.setMediaSourceEndCallback(this._onMediaSourceEnd.bind(this));\r\n        this.player.setStreamTimeCallback(this._onStreamTime.bind(this));\r\n    }\r\n\r\n    on(event, call) {\r\n        if (event === GPlayerEvent.TIMEUPDATE) {\r\n            this.callbackTimeUpdate = call;\r\n        }\r\n        else if (event === GPlayerEvent.STATISTICS_INFO) {\r\n            this.callbackStatistics = call;\r\n        }\r\n        else if (event === GPlayerEvent.ERROR) {\r\n            this.callbackError = call;\r\n        }\r\n        else if (event === GPlayerEvent.MEDIA_SOURCE_END) {\r\n            this.callbackMediaSourceEnd = call;\r\n        }\r\n        else if (event === GPlayerEvent.MEDIA_STATE) {\r\n            this.callbackMediaState = call;\r\n        }\r\n        else if (event === GPlayerEvent.PLAYBACK_CONTROL_EVENT) {\r\n            this.callbackPlaybackControlEvent = call;\r\n        }\r\n    }\r\n\r\n    off(event) {\r\n        if (event === GPlayerEvent.TIMEUPDATE) {\r\n            this.callbackTimeUpdate = null;\r\n        }\r\n        else if (event === GPlayerEvent.STATISTICS_INFO) {\r\n            this.callbackStatistics = null;\r\n        }\r\n        else if (event === GPlayerEvent.ERROR) {\r\n            this.callbackError = null;\r\n        }\r\n        else if (event === GPlayerEvent.MEDIA_SOURCE_END) {\r\n            this.callbackMediaSourceEnd = null;\r\n        }\r\n        else if (event === GPlayerEvent.MEDIA_STATE) {\r\n            this.callbackMediaState = null;\r\n        }\r\n        else if (event === GPlayerEvent.PLAYBACK_CONTROL_EVENT) {\r\n            this.callbackPlaybackControlEvent = null;\r\n        }\r\n    }\r\n\r\n    attachMediaElement(el) {\r\n        this.element = el;\r\n        this.element.addEventListener(\"timeupdate\", this.e.onTimeUpdate);\r\n        this.player.attachMediaElement(el);\r\n    }\r\n\r\n    load() {\r\n        if (this.helpUrl != null) {\r\n            this.helper = new GHelper();\r\n            this.helper.init(this.helpUrl);\r\n            this.helper.on(GHelperEvent.MEDIA_STATE,this._onMediaState.bind(this));\r\n        }\r\n\r\n        this.player.load();\r\n    }\r\n\r\n    play() {\r\n        this.player.play();\r\n    }\r\n\r\n    capture() {\r\n        let canvas = document.createElement(\"canvas\");\r\n        canvas.width = this.element.videoWidth;\r\n        canvas.height = this.element.videoHeight;\r\n        canvas.getContext('2d').drawImage(this.element, 0, 0, canvas.width, canvas.height);\r\n        let dataurl = canvas.toDataURL();\r\n        return dataurl;\r\n    }\r\n\r\n    pause() {\r\n        this.element.pause();\r\n        return false;\r\n    }\r\n\r\n    resume() {\r\n        this.element.play();\r\n        return false;\r\n    }\r\n\r\n    seekToNewestTime () {\r\n        let buffered = this.element.buffered;\r\n        if (buffered.length > 0) { \r\n            let from = buffered.start(buffered.length -1);\r\n            let to = buffered.end(buffered.length -1);\r\n            this.element.currentTime = to;\r\n        }\r\n    }\r\n\r\n    seek(time) {\r\n        if (this.element == null) {\r\n            return false;\r\n        }\r\n        if (this.seeking) {\r\n            return false;\r\n        }\r\n        \r\n        if (this.callbackPlaybackControlEvent != null) {\r\n            this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekStart, \r\n                \"开始切换播放时间\");\r\n        }\r\n\r\n        if (!this._seekByCached(time)) {\r\n            return false;\r\n        }\r\n        if (this.playbackControl == PlaybackControl.Active) {\r\n            this._seekByActive(time);\r\n        }\r\n        else {\r\n            this._seekByPassive(time);\r\n        }\r\n        return true;\r\n    }\r\n\r\n    setPlaySpeed(speed) {\r\n        if (this.element == null) {\r\n            return;\r\n        }\r\n        this.element.playbackRate = speed;\r\n    }\r\n\r\n    destroy() {\r\n        if (this.helper != null) {\r\n            this.helper.destroy();\r\n        }\r\n\r\n        if (this.player != null) {\r\n            this.player.pause();\r\n            this.player.unload();\r\n            this.player.detachMediaElement();\r\n            this.player.destroy();\r\n            this.player = null;\r\n        }\r\n\r\n        if (this.element != null) {\r\n            this.element.removeEventListener(\"timeupdate\", this.e.onTimeUpdate);\r\n            this.element = null;\r\n        }\r\n    }\r\n\r\n    _checkConfig(config) {\r\n        if (config == null) {\r\n            return;\r\n        }\r\n\r\n        if (config.playbackPlan != null) {\r\n            this.playbackPlan = config.playbackPlan;\r\n        }\r\n\r\n        if (config.helpUrl != null) {\r\n            this.helpUrl = config.helpUrl;\r\n        }\r\n    }\r\n\r\n    _checkIfLive(url) {\r\n        if (url.indexOf(PlaybackKey) != -1) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    _checkPlaybackControl(url) {\r\n        let arr = url.split('&stream=');\r\n        if (arr.length < 2 || arr[1].length < 3) {\r\n            return PlaybackControl.None;\r\n        }\r\n        let streamName = arr[1];\r\n        let deviceType = streamName.substring(0,3);\r\n        if (deviceType == '131') {\r\n            return PlaybackControl.Passive;\r\n        }\r\n        return PlaybackControl.Active;\r\n    }\r\n\r\n    _seekByCached(time) {\r\n        if (!this.streamEnd) {\r\n            return true;\r\n        }\r\n\r\n        this.seeking = true;\r\n\r\n        let bCached = false;\r\n        let buffered = this.element.buffered;\r\n        for (let i = 0; i < buffered.length; i++) {\r\n            let from = buffered.start(i);\r\n            let to = buffered.end(i);\r\n            if (time > from && time < to) {\r\n                bCached = true;\r\n            }\r\n        }\r\n\r\n        if (bCached && time > this.element.currentTime) {\r\n            this.element.currentTime = time;\r\n            if (this.callbackPlaybackControlEvent != null) {\r\n                this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekSuccess,\r\n                    \"切换播放时间成功\");\r\n            }\r\n        }\r\n        else {\r\n            if (this.callbackPlaybackControlEvent != null) {\r\n                this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekFail,\r\n                    \"缓冲流已结束，无法切换到未缓冲区域\");\r\n            }\r\n        }\r\n\r\n        this.seeking = false;\r\n        return false;\r\n    }\r\n\r\n    _seekByActive(time) {\r\n        this.seeking = true;\r\n\r\n        this.lastSendSeekTs = new Date().getTime();\r\n\r\n        this.checkerSeek = setTimeout(()=>{\r\n            this.needSeek = false;\r\n            this.seeking = false;\r\n            if (this.callbackPlaybackControlEvent != null) {\r\n                this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekFail,\r\n                    \"切换播放时间失败，请重新尝试\");\r\n            }\r\n        },15*1000);\r\n\r\n        this.seekTime = time;\r\n        this.needSeek = true;\r\n    }\r\n\r\n    _seekByPassive(time) {\r\n        this.seeking = true;\r\n\r\n        this.seekTime = time;\r\n        //获取当前video标签解码缓存\r\n        let buffered = this.element.buffered;\r\n        if (buffered.length > 0) { \r\n            //由设备端控制回放的buffered只会产生一段\r\n            let from = buffered.start(0);\r\n            let to = buffered.end(0);\r\n            this.newPlayStartTime = to;\r\n\r\n            this.element.currentTime = this.newPlayStartTime;\r\n        }\r\n\r\n        setTimeout(()=>{\r\n            this.seeking = false;\r\n            if (this.callbackPlaybackControlEvent != null) {\r\n                this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekSuccess,\r\n                    \"切换播放时间成功\");\r\n            }\r\n        },1000);\r\n    }\r\n\r\n    _onMediaState(info) {\r\n        if (this.callbackMediaState != null) {\r\n            this.callbackMediaState(info);\r\n        }\r\n    }\r\n\r\n    _onStatisticsInfo(data) {\r\n        if (this.callbackStatistics != null) {\r\n            let info = {};\r\n            info.speed = data.speed;\r\n            this.callbackStatistics(info);\r\n        }\r\n    }\r\n\r\n    _onError(type, detail, errObj) {\r\n        if (this.callbackError != null) {\r\n            let gtype = type;\r\n            let gsubtype = detail;\r\n            let info = type;\r\n            this.callbackError(type, gsubtype, info);\r\n        }\r\n    }\r\n\r\n    _onMediaSourceEnd(info) {\r\n        this.streamEnd = true;\r\n        if (this.callbackMediaSourceEnd != null) {\r\n            this.callbackMediaSourceEnd();\r\n        }\r\n    }\r\n\r\n    _onElementTime(event) {\r\n        //回放方案1\r\n        if (this.playbackPlan == 1) {\r\n            if (this.callbackTimeUpdate != null && this.element != null) {\r\n                this.callbackTimeUpdate(this.element.currentTime);\r\n            }\r\n            return;\r\n        }\r\n\r\n        //回放方案2\r\n        if (this.playbackControl === PlaybackControl.Active) {\r\n            if (!this.seeking && this.callbackTimeUpdate != null && this.element != null) {\r\n                this.callbackTimeUpdate(this.element.currentTime);\r\n            }\r\n        }\r\n        else if (this.playbackControl === PlaybackControl.Passive) {\r\n            if (!this.seeking && this.callbackTimeUpdate != null && this.element != null) {\r\n                let curPlayTime = this.seekTime + (this.element.currentTime - this.newPlayStartTime);\r\n                this.callbackTimeUpdate(curPlayTime);\r\n            }\r\n        }\r\n    }\r\n\r\n    _onStreamTime(time) {\r\n        if (this.needSeek) {\r\n            if (Math.abs(this.seekTime*1000 - time) >= 1000) {\r\n                return;\r\n            }\r\n\r\n            if (this.checkerSeek != null) {\r\n                clearTimeout(this.checkerSeek);\r\n                this.checkerSeek = null;\r\n            }\r\n\r\n            this.needSeek = false;\r\n            setTimeout(()=>{\r\n                this.seeking = false;\r\n                this.element.currentTime = time/1000;\r\n                let off = new Date().getTime() - this.lastSendSeekTs;\r\n                console.log(\"切换耗时: \" + off);\r\n                if (this.callbackPlaybackControlEvent != null) {\r\n                    this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekSuccess,\r\n                        \"切换播放时间成功\");\r\n                }\r\n            },1000);\r\n            return;\r\n        }\r\n    }\r\n}\r\n\r\n","export const GTalkerEvent = {\r\n    CONNECT_STATUS: 'connect_status'\r\n};\r\n\r\nexport const GTalkerConnectStatus = {\r\n    ConnectSuccess: 'ConnectSuccess',\r\n    ConnectError: 'ConnectError'\r\n};\r\n\r\nexport const GTalkerConnectErrorType = {\r\n    DeviceNotResponding: 'DeviceNotResponding',\r\n    DeviceStopedResponding: 'DeviceStopedResponding',\r\n    DownLinkFail: 'DownLinkFail',\r\n    UpLinkFail: 'UpLinkFail',\r\n    WaitOpenMicrophoneTimeout: 'WaitOpenMicrophoneTimeout',\r\n    NotAllowOpenMicrophone: 'NotAllowOpenMicrophone'\r\n};","export class GTalker {\r\n\r\n    constructor(typeName) {\r\n        this._type = typeName || 'undefined';\r\n    }\r\n\r\n    init(downUrl, upUrl, imei, channel, config) {\r\n    }\r\n\r\n    on(event, call) {\r\n\r\n    }\r\n\r\n    off(event) {\r\n\r\n    }\r\n\r\n    attachMediaElement(element) {  \r\n    }\r\n\r\n    load() {\r\n    }\r\n\r\n    destroy() {\r\n\r\n    }\r\n\r\n}","import {GTalkerEvent, GTalkerConnectStatus, GTalkerConnectErrorType} from \"./gtalker-events.js\"\r\nimport {GTalker} from \"./gtalker.js\"\r\nimport {ByteArray} from \"../common/bytearray.js\"\r\nimport {Util} from \"../common/util.js\"\r\n\r\nimport flvjs from \"flv-g7.js\";\r\n\r\nimport Recorder from 'recorder-core'\r\nimport 'recorder-core/src/engine/mp3'\r\nimport 'recorder-core/src/engine/mp3-engine'\r\n\r\nconst AudioBufLen = 640;\r\nconst DebugFlag = false;\r\n\r\nexport class HttpFlvTalker extends GTalker {\r\n\r\n    constructor () {\r\n        super('httpflv-talker');\r\n        this.TAG = 'HttpFlvTalker';\r\n\r\n        this.downUrl = null;\r\n        this.upUrl = null;\r\n        this.imei = null;\r\n        this.channel = null;\r\n        \r\n        this.player = null;\r\n        this.recorder = null;\r\n        this.sender = null;\r\n        this.element = null;\r\n\r\n        this.callbackConnectStatus = null;\r\n\r\n        this.byteArray = new ByteArray();\r\n\r\n        this.timerCheck = null;\r\n        this.timerSend = null;\r\n\r\n        this.hasReceiveServerData = false;\r\n        this.hasSendClientData = false;\r\n        this.hasWaitOpenMicrophoneTimeout = false;\r\n        this.hasDestory = false;\r\n    }\r\n\r\n    static isSupported() {\r\n        return typeof WebSocket != 'undefined' && Recorder.Support() && window.MediaSource &&\r\n            window.MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"');\r\n    }\r\n\r\n    init(downUrl, upUrl, imei, channel, config) {\r\n        this.downUrl = downUrl;\r\n        this.upUrl = upUrl;\r\n        this.imei = imei;\r\n        this.channel = channel;\r\n        if (!this._checkInputParam()) {\r\n            return false;\r\n        }\r\n\r\n        this._startPlayer(downUrl);\r\n        return true;\r\n    }\r\n\r\n    on(event, call) {\r\n        if (event === GTalkerEvent.CONNECT_STATUS) {\r\n            this.callbackConnectStatus = call;\r\n        }\r\n    }\r\n\r\n    off(event) {\r\n        if (event === GTalkerEvent.CONNECT_STATUS) {\r\n            this.callbackConnectStatus = null;\r\n        }\r\n    }\r\n\r\n    attachMediaElement(element) {  \r\n        this.element = element;\r\n\r\n        this.element.addEventListener(\"loadeddata\", this._onPlayerLoadedData.bind(this), {once: true});\r\n        this.player.on(flvjs.Events.ERROR, this._onPlayerError.bind(this));\r\n        this.player.setMediaSourceEndCallback(this._onPlayerMediaSourceEnd.bind(this));\r\n\r\n        this.player.attachMediaElement(element);\r\n    }\r\n\r\n    load() {\r\n        this.player.load();\r\n        this._startSender(this.upUrl);\r\n    }\r\n\r\n    destroy() {\r\n        this.hasDestory = true;\r\n\r\n        this._destroyPlayer();\r\n        this._destroySender();\r\n        this._destroyRecorder();\r\n        this._destroySendProc();\r\n    }\r\n\r\n    _checkInputParam() {\r\n        if (Util.isEmptyString(this.downUrl) || Util.isEmptyString(this.upUrl)) {\r\n            return false;\r\n        }\r\n        if (Util.isEmptyString(this.imei)) {\r\n            return false;\r\n        }\r\n        if (this.channel < 0 || this.channel > 255) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    _startPlayer(url) {\r\n        this._destroyPlayer();\r\n\r\n        this.player = flvjs.createPlayer({isLive:true, type:'flv',url:url}, {\r\n            lazyLoad: false,\r\n            enableStashBuffer: false,\r\n            deferLoadAfterSourceOpen:true\r\n        });\r\n    }\r\n\r\n    _onPlayerLoadedData() {\r\n        if (DebugFlag) {\r\n            console.log(\"player loadedData\");\r\n        }\r\n\r\n        this.hasReceiveServerData = true;\r\n        if (this.hasSendClientData && this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectSuccess, \"\");\r\n        }\r\n    }\r\n\r\n    _onPlayerError(type, detail, errObj) {\r\n        if (DebugFlag) {\r\n            console.log(\"player error\");\r\n        }\r\n\r\n        if (this.callbackConnectStatus == null) {\r\n            return;\r\n        }\r\n\r\n        if (this.hasReceiveServerData) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.DownLinkFail);\r\n        }\r\n        else {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.DeviceNotResponding);\r\n        }\r\n    }\r\n\r\n    _onPlayerMediaSourceEnd(info) {\r\n        if (DebugFlag) {\r\n            console.log(\"player source end\");\r\n        }\r\n\r\n        if (this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.DeviceStopedResponding);\r\n        }\r\n    }\r\n\r\n    _destroyPlayer() {\r\n        if (this.player != null) {\r\n            this.player.pause();\r\n            this.player.unload();\r\n            this.player.detachMediaElement();\r\n            this.player.destroy();\r\n            this.player = null;\r\n        }\r\n\r\n        if (this.element != null) {\r\n            this.element = null;\r\n        }\r\n    }\r\n\r\n    _startSender(url) {\r\n        this.sender = new WebSocket(url);\r\n        this.sender.onopen = this._onSenderOpen.bind(this);\r\n        this.sender.onmessage = this._onSenderMsg.bind(this);\r\n        this.sender.onclose = this._onSenderClose.bind(this);\r\n        this.sender.onerror = this._onSenderError.bind(this);\r\n    }\r\n\r\n    _onSenderOpen() {\r\n        if (DebugFlag) {\r\n            console.log(\"websocket open\");\r\n        }\r\n        \r\n        this._startRecorder();\r\n    }\r\n\r\n    _onSenderMsg(e) {\r\n        \r\n    }\r\n\r\n    _onSenderClose(e) {\r\n        if (DebugFlag) {\r\n            console.log(\"websocket close\");\r\n        }\r\n\r\n        if (this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.UpLinkFail);\r\n        }\r\n    }\r\n\r\n    _onSenderError(e) {\r\n        if (DebugFlag) {\r\n            console.log(\"websocket error\");\r\n        }\r\n    }\r\n\r\n    _destroySender() {\r\n        this.sender.close();\r\n        this.sender = null;\r\n    }\r\n\r\n    _startRecorder() {\r\n        if (this.recorder) {\r\n            this.recorder.close();\r\n        }\r\n\r\n        this.recorder = Recorder({\r\n            type:\"mp3\",\r\n            sampleRate:8000,\r\n            bitRate:16,\r\n            onProcess:this._onReceiveMicrophoneData.bind(this)\r\n        });\r\n        this.timerCheck = setTimeout(this._timeoutCheckIfAllowOpenMicrophone.bind(this),10000);\r\n        this.recorder.open(this._onAllowOpenMicrophone.bind(this),\r\n            this._onNotAllowOpenMicrophone.bind(this));\r\n    }\r\n\r\n    _timeoutCheckIfAllowOpenMicrophone() {\r\n        if (DebugFlag) {\r\n            console.log(\"user WaitOpenMicrophone Timeout\");\r\n        }\r\n\r\n        this.hasWaitOpenMicrophoneTimeout = true;\r\n\r\n        if (this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.WaitOpenMicrophoneTimeout);\r\n        }\r\n    }\r\n\r\n    _onAllowOpenMicrophone() {\r\n        if (DebugFlag) {\r\n            console.log(\"user AllowOpenMicrophone\");\r\n        }\r\n\r\n        if (this.hasWaitOpenMicrophoneTimeout) {\r\n            return;\r\n        }\r\n\r\n        clearTimeout(this.timerCheck);\r\n\r\n        this.hasSendClientData = true;\r\n        if (this.hasReceiveServerData && this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectSuccess, \"\");\r\n        }\r\n\r\n        this.recorder.start();\r\n        this._sendProc();\r\n    }\r\n\r\n    _onNotAllowOpenMicrophone(msg, isUserNotAllow) {\r\n        if (DebugFlag) {\r\n            console.log(\"user NotAllowOpenMicrophone\");\r\n        }\r\n\r\n        clearTimeout(this.timerCheck);\r\n\r\n        if (this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.NotAllowOpenMicrophone);\r\n        }\r\n    }\r\n\r\n    _onReceiveMicrophoneData(buffers, powerLevel, bufferDuration, bufferSampleRate) {\r\n        let arrayBuf = buffers[buffers.length - 1].buffer; //Uint16Array To ArrayBuffer\r\n        let u8buf = new Uint8Array(arrayBuf); //ArrayBuffer To Uint8Array\r\n        this.byteArray.push(u8buf);\r\n    }\r\n\r\n    _destroyRecorder() {\r\n        this.recorder.close();\r\n        this.recorder = null;\r\n    }\r\n\r\n    _sendProc() {\r\n        if (this.hasDestory) {\r\n            return;\r\n        }\r\n\r\n        if (this.byteArray.length < AudioBufLen) {\r\n            this.timerSend = setTimeout(this._sendProc.bind(this), 5);\r\n        }\r\n        else {\r\n            let audioBuf = this.byteArray.readBytes(AudioBufLen);\r\n\r\n            let packer = new ByteArray();\r\n            packer.push(new Uint8Array([0x31,0x32,0x63,0x64]));\r\n            let arrImeiChar = this.imei.split('');\r\n            for (let i = 0; i < arrImeiChar.length; i++) {\r\n                packer.push(new Uint8Array([arrImeiChar[i].charCodeAt()]));\r\n            }\r\n            packer.push(new Uint8Array([parseInt(this.channel)]));\r\n            packer.push(new Uint8Array([Math.floor(AudioBufLen/256)]));\r\n            packer.push(new Uint8Array([AudioBufLen%256]));\r\n            packer.push(audioBuf);\r\n\r\n            let totalLen = 4 + arrImeiChar.length + 3 + AudioBufLen;\r\n            if (this.sender != null) {\r\n                this.sender.send(packer.readBytes(totalLen));\r\n            }\r\n\r\n            this._sendProc();\r\n        }\r\n    }\r\n\r\n    _destroySendProc() {\r\n        clearTimeout(this.timerSend);\r\n    }\r\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvZmx2LWc3LmpzL2Rpc3QvZmx2LmpzIiwibm9kZV9tb2R1bGVzL3JlY29yZGVyLWNvcmUvc3JjL2VuZ2luZS9tcDMtZW5naW5lLmpzIiwibm9kZV9tb2R1bGVzL3JlY29yZGVyLWNvcmUvc3JjL2VuZ2luZS9tcDMuanMiLCJub2RlX21vZHVsZXMvcmVjb3JkZXItY29yZS9zcmMvcmVjb3JkZXItY29yZS5qcyIsInNyYy9jb21tb24vYnl0ZWFycmF5LmpzIiwic3JjL2NvbW1vbi91dGlsLmpzIiwic3JjL2dtZWRpYS5qcyIsInNyYy9oZWxwZXIvZ2hlbHBlci1ldmVudHMuanMiLCJzcmMvaGVscGVyL2doZWxwZXIuanMiLCJzcmMvaW5kZXguanMiLCJzcmMvcGxheWVyL2dwbGF5ZXItZXZlbnRzLmpzIiwic3JjL3BsYXllci9ncGxheWVyLmpzIiwic3JjL3BsYXllci9odHRwZmx2LXBsYXllci5qcyIsInNyYy90YWxrZXIvZ3RhbGtlci1ldmVudHMuanMiLCJzcmMvdGFsa2VyL2d0YWxrZXIuanMiLCJzcmMvdGFsa2VyL2h0dHBmbHYtdGFsa2VyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOztBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDcjRYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1MWJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZhQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7Ozs7Ozs7O0lDbDNCYSxTLFdBQUEsUztBQUVULHlCQUFjO0FBQUE7O0FBQ1YsYUFBSyxJQUFMLEdBQVUsRUFBVjtBQUNBLGFBQUssVUFBTCxHQUFnQixDQUFoQjtBQUNBLGFBQUssTUFBTCxHQUFZLENBQVo7QUFDSDs7Ozs2QkFFSSxRLEVBQVU7QUFDWCxpQkFBSyxJQUFMLENBQVUsSUFBVixDQUFlLFFBQWY7QUFDQSxpQkFBSyxNQUFMLElBQWEsU0FBUyxNQUF0QjtBQUNIOzs7a0NBRVMsRyxFQUFLO0FBQ1gsZ0JBQUcsTUFBSSxDQUFQLEVBQVM7QUFDTCxvQkFBSSxPQUFLLElBQUksVUFBSixDQUFlLEdBQWYsQ0FBVDtBQUNBLG9CQUFJLFdBQVMsQ0FBYjtBQUNBLHVCQUFNLFdBQVMsR0FBZixFQUFtQjtBQUNmLHdCQUFHLEtBQUssSUFBTCxDQUFVLE1BQVYsR0FBaUIsQ0FBcEIsRUFBc0I7QUFDbEIsNEJBQUksU0FBTyxLQUFLLElBQUwsQ0FBVSxLQUFWLEVBQVg7QUFDQSw0QkFBSSxTQUFPLE9BQU8sTUFBbEI7QUFDQSw0QkFBSSxXQUFTLE1BQUksUUFBakI7QUFDQSw0QkFBRyxVQUFRLFFBQVgsRUFBb0I7QUFDaEI7QUFDQSxnQ0FBSSxVQUFVLE9BQU8sUUFBUCxDQUFnQixDQUFoQixFQUFtQixRQUFuQixDQUFkO0FBQ0EsaUNBQUssR0FBTCxDQUFTLE9BQVQsRUFBaUIsUUFBakI7QUFDQSx3Q0FBVSxRQUFRLE1BQWxCO0FBQ0EsZ0NBQUcsV0FBUyxNQUFaLEVBQW1CO0FBQ2Ysb0NBQUksZ0JBQWdCLE9BQU8sUUFBUCxDQUFnQixRQUFoQixFQUEwQixNQUExQixDQUFwQjtBQUNBLHFDQUFLLElBQUwsQ0FBVSxPQUFWLENBQWtCLGFBQWxCO0FBQ0g7QUFDRDtBQUNILHlCQVZELE1BVUs7QUFDRCxpQ0FBSyxHQUFMLENBQVMsTUFBVCxFQUFnQixRQUFoQjtBQUNBLHdDQUFVLE1BQVY7QUFDSDtBQUNKLHFCQWxCRCxNQWtCSztBQUNELCtCQUFLLEtBQUssUUFBTCxDQUFjLENBQWQsRUFBaUIsUUFBakIsQ0FBTDtBQUNBO0FBQ0g7QUFDSjtBQUNELHFCQUFLLE1BQUwsSUFBYSxLQUFLLE1BQWxCO0FBQ0EsdUJBQU8sSUFBUDtBQUNIO0FBQ0QsbUJBQU8sSUFBUDtBQUNIOzs7Ozs7Ozs7Ozs7Ozs7OztJQzVDUSxJLFdBQUEsSTs7Ozs7OztzQ0FDWSxHLEVBQUs7QUFDdEIsZ0JBQUksT0FBTyxTQUFQLElBQW9CLE9BQU8sSUFBM0IsSUFBbUMsT0FBTyxFQUE5QyxFQUFrRDtBQUM5Qyx1QkFBTyxJQUFQO0FBQ0gsYUFGRCxNQUdLO0FBQ0QsdUJBQU8sS0FBUDtBQUNIO0FBQ0o7Ozs7Ozs7Ozs7Ozs7QUNUTDs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQSxTQUFTLFlBQVQsQ0FBc0IsR0FBdEIsRUFBMEM7QUFBQSxNQUFmLE1BQWUsdUVBQU4sSUFBTTs7QUFDeEMsTUFBSSxTQUFTLElBQUksNEJBQUosRUFBYjtBQUNBLFNBQU8sSUFBUCxDQUFZLEdBQVosRUFBaUIsTUFBakI7QUFDQSxTQUFPLE1BQVA7QUFDRDs7QUFFRCxTQUFTLFlBQVQsQ0FBc0IsT0FBdEIsRUFBK0IsS0FBL0IsRUFBc0MsSUFBdEMsRUFBNEMsT0FBNUMsRUFBb0U7QUFBQSxNQUFmLE1BQWUsdUVBQU4sSUFBTTs7QUFDbEUsTUFBSSxTQUFTLElBQUksNEJBQUosRUFBYjtBQUNBLE1BQUksQ0FBQyxPQUFPLElBQVAsQ0FBWSxPQUFaLEVBQXFCLEtBQXJCLEVBQTRCLElBQTVCLEVBQWtDLE9BQWxDLEVBQTJDLE1BQTNDLENBQUwsRUFBeUQ7QUFDdkQsV0FBTyxJQUFQO0FBQ0Q7QUFDRCxTQUFPLE1BQVA7QUFDRDs7QUFFRCxTQUFTLFlBQVQsQ0FBc0IsR0FBdEIsRUFBMkI7QUFDekIsTUFBSSxTQUFTLElBQUksZ0JBQUosRUFBYjtBQUNBLFNBQU8sSUFBUCxDQUFZLEdBQVo7QUFDQSxTQUFPLE1BQVA7QUFDRDs7QUFFRCxTQUFTLGtCQUFULEdBQThCO0FBQzVCLFNBQU8sNkJBQWMsV0FBZCxFQUFQO0FBQ0Q7O0FBRUQsU0FBUyxlQUFULEdBQTJCO0FBQ3pCLFNBQU8sNkJBQWMsV0FBZCxFQUFQO0FBQ0Q7O0FBRUQsSUFBSSxXQUFXLEVBQWY7O0FBRUEsU0FBUyxZQUFULEdBQXdCLFlBQXhCO0FBQ0EsU0FBUyxrQkFBVCxHQUE4QixrQkFBOUI7QUFDQSxTQUFTLGFBQVQsR0FBeUIsNEJBQXpCO0FBQ0EsU0FBUyxZQUFULEdBQXdCLDJCQUF4QjtBQUNBLFNBQVMsVUFBVCxHQUFzQix5QkFBdEI7QUFDQSxTQUFTLHNCQUFULEdBQWtDLHFDQUFsQzs7QUFFQSxTQUFTLFlBQVQsR0FBd0IsWUFBeEI7QUFDQSxTQUFTLGVBQVQsR0FBMkIsZUFBM0I7QUFDQSxTQUFTLGFBQVQsR0FBeUIsNEJBQXpCO0FBQ0EsU0FBUyxZQUFULEdBQXdCLDJCQUF4QjtBQUNBLFNBQVMsb0JBQVQsR0FBZ0MsbUNBQWhDO0FBQ0EsU0FBUyx1QkFBVCxHQUFtQyxzQ0FBbkM7O0FBRUEsU0FBUyxZQUFULEdBQXdCLFlBQXhCO0FBQ0EsU0FBUyxPQUFULEdBQW1CLGdCQUFuQjtBQUNBLFNBQVMsWUFBVCxHQUF3QiwyQkFBeEI7O2tCQUVlLFE7Ozs7Ozs7O0FDeERSLElBQU0sc0NBQWU7QUFDeEIsaUJBQWE7QUFEVyxDQUFyQjs7Ozs7Ozs7Ozs7O0FDQVA7Ozs7SUFDYSxPLFdBQUEsTztBQUNULHVCQUFjO0FBQUE7O0FBQ1YsYUFBSyxjQUFMLEdBQXNCLElBQXRCO0FBQ0EsYUFBSyxPQUFMLEdBQWUsSUFBZjtBQUNIOzs7OzZCQUVJLEcsRUFBSztBQUNOLGlCQUFLLE9BQUwsR0FBZSxJQUFJLFNBQUosQ0FBYyxHQUFkLENBQWY7QUFDQSxpQkFBSyxPQUFMLENBQWEsTUFBYixHQUFzQixLQUFLLGNBQUwsQ0FBb0IsSUFBcEIsQ0FBeUIsSUFBekIsQ0FBdEI7QUFDQSxpQkFBSyxPQUFMLENBQWEsU0FBYixHQUF5QixLQUFLLGlCQUFMLENBQXVCLElBQXZCLENBQTRCLElBQTVCLENBQXpCO0FBQ0EsaUJBQUssT0FBTCxDQUFhLE9BQWIsR0FBdUIsS0FBSyxlQUFMLENBQXFCLElBQXJCLENBQTBCLElBQTFCLENBQXZCO0FBQ0EsaUJBQUssT0FBTCxDQUFhLE9BQWIsR0FBdUIsS0FBSyxlQUFMLENBQXFCLElBQXJCLENBQTBCLElBQTFCLENBQXZCO0FBQ0g7OzsyQkFFRSxLLEVBQU8sSSxFQUFNO0FBQ1osZ0JBQUksUUFBUSw0QkFBYSxXQUF6QixFQUFzQztBQUNsQyxxQkFBSyxjQUFMLEdBQXNCLElBQXRCO0FBQ0g7QUFDSjs7OzRCQUVHLEssRUFBTztBQUNQLGdCQUFJLFFBQVEsNEJBQWEsV0FBekIsRUFBc0M7QUFDbEMscUJBQUssY0FBTCxHQUFzQixJQUF0QjtBQUNIO0FBQ0o7OztrQ0FFUztBQUNOLGlCQUFLLGNBQUwsR0FBc0IsSUFBdEI7O0FBRUEsZ0JBQUksS0FBSyxPQUFMLElBQWdCLElBQXBCLEVBQTBCO0FBQ3RCLHFCQUFLLE9BQUwsQ0FBYSxLQUFiO0FBQ0EscUJBQUssT0FBTCxHQUFlLElBQWY7QUFDSDtBQUNKOzs7eUNBRWdCO0FBQ2IsaUJBQUsseUJBQUw7QUFDSDs7OzBDQUVpQixDLEVBQUc7QUFDakIsZ0JBQUksT0FBTyxLQUFLLEtBQUwsQ0FBVyxFQUFFLElBQWIsQ0FBWDtBQUNBLGdCQUFJLFFBQVEsSUFBUixJQUFnQixLQUFLLElBQUwsSUFBYSxJQUFqQyxFQUF1QztBQUNuQztBQUNIOztBQUVELGdCQUFJLEtBQUssSUFBTCxJQUFhLFlBQWIsSUFBNkIsS0FBSyxjQUFMLElBQXVCLElBQXhELEVBQThEO0FBQzFELHFCQUFLLGNBQUwsQ0FBb0IsS0FBSyxJQUF6QjtBQUNIO0FBQ0o7OzswQ0FFaUIsQ0FFakI7OzswQ0FFaUIsQ0FFakI7OztvREFFMkI7QUFDeEIsZ0JBQUksT0FBTyxFQUFYO0FBQ0EsaUJBQUssS0FBTCxJQUFjLFNBQWQ7QUFDQSxpQkFBSyxNQUFMLElBQWUsWUFBZjtBQUNBLGlCQUFLLElBQUwsSUFBYSxFQUFiO0FBQ0EsaUJBQUssTUFBTCxJQUFlLEVBQWY7O0FBRUEsZ0JBQUksTUFBTSxLQUFLLFNBQUwsQ0FBZSxJQUFmLENBQVY7O0FBRUEsaUJBQUssT0FBTCxDQUFhLElBQWIsQ0FBa0IsR0FBbEI7QUFDSDs7Ozs7Ozs7O0FDckVMLE9BQU8sT0FBUCxHQUFpQixRQUFRLGFBQVIsRUFBdUIsT0FBeEM7Ozs7Ozs7O0FDQU8sSUFBTSxzQ0FBZTtBQUN4QixXQUFPLE9BRGlCO0FBRXhCLHNCQUFrQixrQkFGTTtBQUd4QixnQkFBWSxZQUhZO0FBSXhCLHFCQUFpQixpQkFKTztBQUt4QixpQkFBYSxhQUxXO0FBTXhCLDRCQUF3QjtBQU5BLENBQXJCOztBQVNBLElBQU0sa0NBQWE7QUFDdEIsbUJBQWUsY0FETztBQUV0QixpQkFBYSxZQUZTO0FBR3RCLGlCQUFhO0FBSFMsQ0FBbkI7O0FBTUEsSUFBTSwwREFBeUI7QUFDbEMsZUFBVyxDQUR1QjtBQUVsQyxjQUFVLENBRndCO0FBR2xDLGlCQUFhO0FBSHFCLENBQS9COzs7Ozs7Ozs7Ozs7O0lDZk0sTyxXQUFBLE87QUFFVCxxQkFBWSxRQUFaLEVBQXNCO0FBQUE7O0FBQ2xCLGFBQUssS0FBTCxHQUFhLFlBQVksV0FBekI7QUFDSDs7Ozs2QkFFSSxHLEVBQUssTSxFQUFRLENBQ2pCOzs7MkJBRUUsSyxFQUFPLEksRUFBTSxDQUVmOzs7NEJBRUcsSyxFQUFPLENBRVY7OzsyQ0FFa0IsWSxFQUFjLENBQ2hDOzs7K0JBRU0sQ0FDTjs7OytCQUVNLENBRU47OztrQ0FFUyxDQUVUOzs7Z0NBRU8sQ0FFUDs7O2lDQUVRLENBRVI7OzsyQ0FFbUIsQ0FFbkI7Ozs2QkFFSSxJLEVBQU0sQ0FFVjs7O3FDQUVZLEssRUFBTyxDQUVuQjs7O2tDQUVTLENBRVQ7Ozs7Ozs7Ozs7Ozs7Ozs7QUNyREw7O0FBQ0E7O0FBQ0E7Ozs7QUFFQTs7QUFDQTs7Ozs7Ozs7OztBQUVBLElBQU0sY0FBYyx1QkFBcEI7O0FBRUEsSUFBTSxrQkFBa0I7QUFDcEIsVUFBSyxDQURlO0FBRXBCLFlBQU8sQ0FGYTtBQUdwQixhQUFRO0FBSFksQ0FBeEI7O0lBTWEsYSxXQUFBLGE7OztBQUVULDZCQUFlO0FBQUE7O0FBQUEsa0lBQ0wsZ0JBREs7O0FBRVgsY0FBSyxHQUFMLEdBQVcsZUFBWDs7QUFFQSxjQUFLLE1BQUwsR0FBYyxJQUFkO0FBQ0EsY0FBSyxPQUFMLEdBQWUsSUFBZjtBQUNBLGNBQUssTUFBTCxHQUFjLElBQWQ7O0FBRUEsY0FBSyxPQUFMLEdBQWUsSUFBZjtBQUNBLGNBQUssTUFBTCxHQUFjLElBQWQ7O0FBRUEsY0FBSyxZQUFMLEdBQW9CLENBQXBCO0FBQ0EsY0FBSyxlQUFMLEdBQXVCLGdCQUFnQixJQUF2Qzs7QUFFQSxjQUFLLFNBQUwsR0FBaUIsS0FBakI7QUFDQSxjQUFLLFFBQUwsR0FBZ0IsS0FBaEI7QUFDQSxjQUFLLE9BQUwsR0FBZSxLQUFmO0FBQ0EsY0FBSyxRQUFMLEdBQWdCLENBQWhCO0FBQ0EsY0FBSyxnQkFBTCxHQUF3QixDQUF4QjtBQUNBLGNBQUssY0FBTCxHQUFzQixDQUF0Qjs7QUFFQSxjQUFLLGtCQUFMLEdBQTBCLElBQTFCO0FBQ0EsY0FBSyxrQkFBTCxHQUEwQixJQUExQjtBQUNBLGNBQUssYUFBTCxHQUFxQixJQUFyQjtBQUNBLGNBQUssc0JBQUwsR0FBOEIsSUFBOUI7QUFDQSxjQUFLLGtCQUFMLEdBQTBCLElBQTFCO0FBQ0EsY0FBSyw0QkFBTCxHQUFvQyxJQUFwQzs7QUFFQSxjQUFLLFdBQUwsR0FBbUIsSUFBbkI7O0FBRUEsY0FBSyxDQUFMLEdBQVM7QUFDTCwwQkFBZSxNQUFLLGNBQUwsQ0FBb0IsSUFBcEI7QUFEVixTQUFUO0FBOUJXO0FBaUNkOzs7OzZCQU9LLEcsRUFBSyxNLEVBQVE7QUFDZixpQkFBSyxZQUFMLENBQWtCLE1BQWxCO0FBQ0EsaUJBQUssTUFBTCxHQUFjLEtBQUssWUFBTCxDQUFrQixHQUFsQixDQUFkO0FBQ0EsaUJBQUssZUFBTCxHQUF1QixLQUFLLHFCQUFMLENBQTJCLEdBQTNCLENBQXZCOztBQUVBLGlCQUFLLE1BQUwsR0FBYyxlQUFNLFlBQU4sQ0FBbUIsRUFBQyxRQUFPLEtBQUssTUFBYixFQUFxQixNQUFLLEtBQTFCLEVBQWdDLEtBQUksR0FBcEMsRUFBbkIsRUFBNkQ7QUFDdkUsMEJBQVUsS0FENkQ7QUFFdkUsbUNBQW1CLEtBRm9EO0FBR3ZFLDBDQUF5QjtBQUg4QyxhQUE3RCxDQUFkOztBQU1BLGlCQUFLLE1BQUwsQ0FBWSxFQUFaLENBQWUsZUFBTSxNQUFOLENBQWEsZUFBNUIsRUFBNkMsS0FBSyxpQkFBTCxDQUF1QixJQUF2QixDQUE0QixJQUE1QixDQUE3QztBQUNBLGlCQUFLLE1BQUwsQ0FBWSxFQUFaLENBQWUsZUFBTSxNQUFOLENBQWEsS0FBNUIsRUFBbUMsS0FBSyxRQUFMLENBQWMsSUFBZCxDQUFtQixJQUFuQixDQUFuQztBQUNBLGlCQUFLLE1BQUwsQ0FBWSx5QkFBWixDQUFzQyxLQUFLLGlCQUFMLENBQXVCLElBQXZCLENBQTRCLElBQTVCLENBQXRDO0FBQ0EsaUJBQUssTUFBTCxDQUFZLHFCQUFaLENBQWtDLEtBQUssYUFBTCxDQUFtQixJQUFuQixDQUF3QixJQUF4QixDQUFsQztBQUNIOzs7MkJBRUUsSyxFQUFPLEksRUFBTTtBQUNaLGdCQUFJLFVBQVUsNEJBQWEsVUFBM0IsRUFBdUM7QUFDbkMscUJBQUssa0JBQUwsR0FBMEIsSUFBMUI7QUFDSCxhQUZELE1BR0ssSUFBSSxVQUFVLDRCQUFhLGVBQTNCLEVBQTRDO0FBQzdDLHFCQUFLLGtCQUFMLEdBQTBCLElBQTFCO0FBQ0gsYUFGSSxNQUdBLElBQUksVUFBVSw0QkFBYSxLQUEzQixFQUFrQztBQUNuQyxxQkFBSyxhQUFMLEdBQXFCLElBQXJCO0FBQ0gsYUFGSSxNQUdBLElBQUksVUFBVSw0QkFBYSxnQkFBM0IsRUFBNkM7QUFDOUMscUJBQUssc0JBQUwsR0FBOEIsSUFBOUI7QUFDSCxhQUZJLE1BR0EsSUFBSSxVQUFVLDRCQUFhLFdBQTNCLEVBQXdDO0FBQ3pDLHFCQUFLLGtCQUFMLEdBQTBCLElBQTFCO0FBQ0gsYUFGSSxNQUdBLElBQUksVUFBVSw0QkFBYSxzQkFBM0IsRUFBbUQ7QUFDcEQscUJBQUssNEJBQUwsR0FBb0MsSUFBcEM7QUFDSDtBQUNKOzs7NEJBRUcsSyxFQUFPO0FBQ1AsZ0JBQUksVUFBVSw0QkFBYSxVQUEzQixFQUF1QztBQUNuQyxxQkFBSyxrQkFBTCxHQUEwQixJQUExQjtBQUNILGFBRkQsTUFHSyxJQUFJLFVBQVUsNEJBQWEsZUFBM0IsRUFBNEM7QUFDN0MscUJBQUssa0JBQUwsR0FBMEIsSUFBMUI7QUFDSCxhQUZJLE1BR0EsSUFBSSxVQUFVLDRCQUFhLEtBQTNCLEVBQWtDO0FBQ25DLHFCQUFLLGFBQUwsR0FBcUIsSUFBckI7QUFDSCxhQUZJLE1BR0EsSUFBSSxVQUFVLDRCQUFhLGdCQUEzQixFQUE2QztBQUM5QyxxQkFBSyxzQkFBTCxHQUE4QixJQUE5QjtBQUNILGFBRkksTUFHQSxJQUFJLFVBQVUsNEJBQWEsV0FBM0IsRUFBd0M7QUFDekMscUJBQUssa0JBQUwsR0FBMEIsSUFBMUI7QUFDSCxhQUZJLE1BR0EsSUFBSSxVQUFVLDRCQUFhLHNCQUEzQixFQUFtRDtBQUNwRCxxQkFBSyw0QkFBTCxHQUFvQyxJQUFwQztBQUNIO0FBQ0o7OzsyQ0FFa0IsRSxFQUFJO0FBQ25CLGlCQUFLLE9BQUwsR0FBZSxFQUFmO0FBQ0EsaUJBQUssT0FBTCxDQUFhLGdCQUFiLENBQThCLFlBQTlCLEVBQTRDLEtBQUssQ0FBTCxDQUFPLFlBQW5EO0FBQ0EsaUJBQUssTUFBTCxDQUFZLGtCQUFaLENBQStCLEVBQS9CO0FBQ0g7OzsrQkFFTTtBQUNILGdCQUFJLEtBQUssT0FBTCxJQUFnQixJQUFwQixFQUEwQjtBQUN0QixxQkFBSyxNQUFMLEdBQWMsSUFBSSxnQkFBSixFQUFkO0FBQ0EscUJBQUssTUFBTCxDQUFZLElBQVosQ0FBaUIsS0FBSyxPQUF0QjtBQUNBLHFCQUFLLE1BQUwsQ0FBWSxFQUFaLENBQWUsNEJBQWEsV0FBNUIsRUFBd0MsS0FBSyxhQUFMLENBQW1CLElBQW5CLENBQXdCLElBQXhCLENBQXhDO0FBQ0g7O0FBRUQsaUJBQUssTUFBTCxDQUFZLElBQVo7QUFDSDs7OytCQUVNO0FBQ0gsaUJBQUssTUFBTCxDQUFZLElBQVo7QUFDSDs7O2tDQUVTO0FBQ04sZ0JBQUksU0FBUyxTQUFTLGFBQVQsQ0FBdUIsUUFBdkIsQ0FBYjtBQUNBLG1CQUFPLEtBQVAsR0FBZSxLQUFLLE9BQUwsQ0FBYSxVQUE1QjtBQUNBLG1CQUFPLE1BQVAsR0FBZ0IsS0FBSyxPQUFMLENBQWEsV0FBN0I7QUFDQSxtQkFBTyxVQUFQLENBQWtCLElBQWxCLEVBQXdCLFNBQXhCLENBQWtDLEtBQUssT0FBdkMsRUFBZ0QsQ0FBaEQsRUFBbUQsQ0FBbkQsRUFBc0QsT0FBTyxLQUE3RCxFQUFvRSxPQUFPLE1BQTNFO0FBQ0EsZ0JBQUksVUFBVSxPQUFPLFNBQVAsRUFBZDtBQUNBLG1CQUFPLE9BQVA7QUFDSDs7O2dDQUVPO0FBQ0osaUJBQUssT0FBTCxDQUFhLEtBQWI7QUFDQSxtQkFBTyxLQUFQO0FBQ0g7OztpQ0FFUTtBQUNMLGlCQUFLLE9BQUwsQ0FBYSxJQUFiO0FBQ0EsbUJBQU8sS0FBUDtBQUNIOzs7MkNBRW1CO0FBQ2hCLGdCQUFJLFdBQVcsS0FBSyxPQUFMLENBQWEsUUFBNUI7QUFDQSxnQkFBSSxTQUFTLE1BQVQsR0FBa0IsQ0FBdEIsRUFBeUI7QUFDckIsb0JBQUksT0FBTyxTQUFTLEtBQVQsQ0FBZSxTQUFTLE1BQVQsR0FBaUIsQ0FBaEMsQ0FBWDtBQUNBLG9CQUFJLEtBQUssU0FBUyxHQUFULENBQWEsU0FBUyxNQUFULEdBQWlCLENBQTlCLENBQVQ7QUFDQSxxQkFBSyxPQUFMLENBQWEsV0FBYixHQUEyQixFQUEzQjtBQUNIO0FBQ0o7Ozs2QkFFSSxJLEVBQU07QUFDUCxnQkFBSSxLQUFLLE9BQUwsSUFBZ0IsSUFBcEIsRUFBMEI7QUFDdEIsdUJBQU8sS0FBUDtBQUNIO0FBQ0QsZ0JBQUksS0FBSyxPQUFULEVBQWtCO0FBQ2QsdUJBQU8sS0FBUDtBQUNIOztBQUVELGdCQUFJLEtBQUssNEJBQUwsSUFBcUMsSUFBekMsRUFBK0M7QUFDM0MscUJBQUssNEJBQUwsQ0FBa0Msc0NBQXVCLFNBQXpELEVBQ0ksVUFESjtBQUVIOztBQUVELGdCQUFJLENBQUMsS0FBSyxhQUFMLENBQW1CLElBQW5CLENBQUwsRUFBK0I7QUFDM0IsdUJBQU8sS0FBUDtBQUNIO0FBQ0QsZ0JBQUksS0FBSyxlQUFMLElBQXdCLGdCQUFnQixNQUE1QyxFQUFvRDtBQUNoRCxxQkFBSyxhQUFMLENBQW1CLElBQW5CO0FBQ0gsYUFGRCxNQUdLO0FBQ0QscUJBQUssY0FBTCxDQUFvQixJQUFwQjtBQUNIO0FBQ0QsbUJBQU8sSUFBUDtBQUNIOzs7cUNBRVksSyxFQUFPO0FBQ2hCLGdCQUFJLEtBQUssT0FBTCxJQUFnQixJQUFwQixFQUEwQjtBQUN0QjtBQUNIO0FBQ0QsaUJBQUssT0FBTCxDQUFhLFlBQWIsR0FBNEIsS0FBNUI7QUFDSDs7O2tDQUVTO0FBQ04sZ0JBQUksS0FBSyxNQUFMLElBQWUsSUFBbkIsRUFBeUI7QUFDckIscUJBQUssTUFBTCxDQUFZLE9BQVo7QUFDSDs7QUFFRCxnQkFBSSxLQUFLLE1BQUwsSUFBZSxJQUFuQixFQUF5QjtBQUNyQixxQkFBSyxNQUFMLENBQVksS0FBWjtBQUNBLHFCQUFLLE1BQUwsQ0FBWSxNQUFaO0FBQ0EscUJBQUssTUFBTCxDQUFZLGtCQUFaO0FBQ0EscUJBQUssTUFBTCxDQUFZLE9BQVo7QUFDQSxxQkFBSyxNQUFMLEdBQWMsSUFBZDtBQUNIOztBQUVELGdCQUFJLEtBQUssT0FBTCxJQUFnQixJQUFwQixFQUEwQjtBQUN0QixxQkFBSyxPQUFMLENBQWEsbUJBQWIsQ0FBaUMsWUFBakMsRUFBK0MsS0FBSyxDQUFMLENBQU8sWUFBdEQ7QUFDQSxxQkFBSyxPQUFMLEdBQWUsSUFBZjtBQUNIO0FBQ0o7OztxQ0FFWSxNLEVBQVE7QUFDakIsZ0JBQUksVUFBVSxJQUFkLEVBQW9CO0FBQ2hCO0FBQ0g7O0FBRUQsZ0JBQUksT0FBTyxZQUFQLElBQXVCLElBQTNCLEVBQWlDO0FBQzdCLHFCQUFLLFlBQUwsR0FBb0IsT0FBTyxZQUEzQjtBQUNIOztBQUVELGdCQUFJLE9BQU8sT0FBUCxJQUFrQixJQUF0QixFQUE0QjtBQUN4QixxQkFBSyxPQUFMLEdBQWUsT0FBTyxPQUF0QjtBQUNIO0FBQ0o7OztxQ0FFWSxHLEVBQUs7QUFDZCxnQkFBSSxJQUFJLE9BQUosQ0FBWSxXQUFaLEtBQTRCLENBQUMsQ0FBakMsRUFBb0M7QUFDaEMsdUJBQU8sS0FBUDtBQUNIO0FBQ0QsbUJBQU8sSUFBUDtBQUNIOzs7OENBRXFCLEcsRUFBSztBQUN2QixnQkFBSSxNQUFNLElBQUksS0FBSixDQUFVLFVBQVYsQ0FBVjtBQUNBLGdCQUFJLElBQUksTUFBSixHQUFhLENBQWIsSUFBa0IsSUFBSSxDQUFKLEVBQU8sTUFBUCxHQUFnQixDQUF0QyxFQUF5QztBQUNyQyx1QkFBTyxnQkFBZ0IsSUFBdkI7QUFDSDtBQUNELGdCQUFJLGFBQWEsSUFBSSxDQUFKLENBQWpCO0FBQ0EsZ0JBQUksYUFBYSxXQUFXLFNBQVgsQ0FBcUIsQ0FBckIsRUFBdUIsQ0FBdkIsQ0FBakI7QUFDQSxnQkFBSSxjQUFjLEtBQWxCLEVBQXlCO0FBQ3JCLHVCQUFPLGdCQUFnQixPQUF2QjtBQUNIO0FBQ0QsbUJBQU8sZ0JBQWdCLE1BQXZCO0FBQ0g7OztzQ0FFYSxJLEVBQU07QUFDaEIsZ0JBQUksQ0FBQyxLQUFLLFNBQVYsRUFBcUI7QUFDakIsdUJBQU8sSUFBUDtBQUNIOztBQUVELGlCQUFLLE9BQUwsR0FBZSxJQUFmOztBQUVBLGdCQUFJLFVBQVUsS0FBZDtBQUNBLGdCQUFJLFdBQVcsS0FBSyxPQUFMLENBQWEsUUFBNUI7QUFDQSxpQkFBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLFNBQVMsTUFBN0IsRUFBcUMsR0FBckMsRUFBMEM7QUFDdEMsb0JBQUksT0FBTyxTQUFTLEtBQVQsQ0FBZSxDQUFmLENBQVg7QUFDQSxvQkFBSSxLQUFLLFNBQVMsR0FBVCxDQUFhLENBQWIsQ0FBVDtBQUNBLG9CQUFJLE9BQU8sSUFBUCxJQUFlLE9BQU8sRUFBMUIsRUFBOEI7QUFDMUIsOEJBQVUsSUFBVjtBQUNIO0FBQ0o7O0FBRUQsZ0JBQUksV0FBVyxPQUFPLEtBQUssT0FBTCxDQUFhLFdBQW5DLEVBQWdEO0FBQzVDLHFCQUFLLE9BQUwsQ0FBYSxXQUFiLEdBQTJCLElBQTNCO0FBQ0Esb0JBQUksS0FBSyw0QkFBTCxJQUFxQyxJQUF6QyxFQUErQztBQUMzQyx5QkFBSyw0QkFBTCxDQUFrQyxzQ0FBdUIsV0FBekQsRUFDSSxVQURKO0FBRUg7QUFDSixhQU5ELE1BT0s7QUFDRCxvQkFBSSxLQUFLLDRCQUFMLElBQXFDLElBQXpDLEVBQStDO0FBQzNDLHlCQUFLLDRCQUFMLENBQWtDLHNDQUF1QixRQUF6RCxFQUNJLG1CQURKO0FBRUg7QUFDSjs7QUFFRCxpQkFBSyxPQUFMLEdBQWUsS0FBZjtBQUNBLG1CQUFPLEtBQVA7QUFDSDs7O3NDQUVhLEksRUFBTTtBQUFBOztBQUNoQixpQkFBSyxPQUFMLEdBQWUsSUFBZjs7QUFFQSxpQkFBSyxjQUFMLEdBQXNCLElBQUksSUFBSixHQUFXLE9BQVgsRUFBdEI7O0FBRUEsaUJBQUssV0FBTCxHQUFtQixXQUFXLFlBQUk7QUFDOUIsdUJBQUssUUFBTCxHQUFnQixLQUFoQjtBQUNBLHVCQUFLLE9BQUwsR0FBZSxLQUFmO0FBQ0Esb0JBQUksT0FBSyw0QkFBTCxJQUFxQyxJQUF6QyxFQUErQztBQUMzQywyQkFBSyw0QkFBTCxDQUFrQyxzQ0FBdUIsUUFBekQsRUFDSSxnQkFESjtBQUVIO0FBQ0osYUFQa0IsRUFPakIsS0FBRyxJQVBjLENBQW5COztBQVNBLGlCQUFLLFFBQUwsR0FBZ0IsSUFBaEI7QUFDQSxpQkFBSyxRQUFMLEdBQWdCLElBQWhCO0FBQ0g7Ozt1Q0FFYyxJLEVBQU07QUFBQTs7QUFDakIsaUJBQUssT0FBTCxHQUFlLElBQWY7O0FBRUEsaUJBQUssUUFBTCxHQUFnQixJQUFoQjtBQUNBO0FBQ0EsZ0JBQUksV0FBVyxLQUFLLE9BQUwsQ0FBYSxRQUE1QjtBQUNBLGdCQUFJLFNBQVMsTUFBVCxHQUFrQixDQUF0QixFQUF5QjtBQUNyQjtBQUNBLG9CQUFJLE9BQU8sU0FBUyxLQUFULENBQWUsQ0FBZixDQUFYO0FBQ0Esb0JBQUksS0FBSyxTQUFTLEdBQVQsQ0FBYSxDQUFiLENBQVQ7QUFDQSxxQkFBSyxnQkFBTCxHQUF3QixFQUF4Qjs7QUFFQSxxQkFBSyxPQUFMLENBQWEsV0FBYixHQUEyQixLQUFLLGdCQUFoQztBQUNIOztBQUVELHVCQUFXLFlBQUk7QUFDWCx1QkFBSyxPQUFMLEdBQWUsS0FBZjtBQUNBLG9CQUFJLE9BQUssNEJBQUwsSUFBcUMsSUFBekMsRUFBK0M7QUFDM0MsMkJBQUssNEJBQUwsQ0FBa0Msc0NBQXVCLFdBQXpELEVBQ0ksVUFESjtBQUVIO0FBQ0osYUFORCxFQU1FLElBTkY7QUFPSDs7O3NDQUVhLEksRUFBTTtBQUNoQixnQkFBSSxLQUFLLGtCQUFMLElBQTJCLElBQS9CLEVBQXFDO0FBQ2pDLHFCQUFLLGtCQUFMLENBQXdCLElBQXhCO0FBQ0g7QUFDSjs7OzBDQUVpQixJLEVBQU07QUFDcEIsZ0JBQUksS0FBSyxrQkFBTCxJQUEyQixJQUEvQixFQUFxQztBQUNqQyxvQkFBSSxPQUFPLEVBQVg7QUFDQSxxQkFBSyxLQUFMLEdBQWEsS0FBSyxLQUFsQjtBQUNBLHFCQUFLLGtCQUFMLENBQXdCLElBQXhCO0FBQ0g7QUFDSjs7O2lDQUVRLEksRUFBTSxNLEVBQVEsTSxFQUFRO0FBQzNCLGdCQUFJLEtBQUssYUFBTCxJQUFzQixJQUExQixFQUFnQztBQUM1QixvQkFBSSxRQUFRLElBQVo7QUFDQSxvQkFBSSxXQUFXLE1BQWY7QUFDQSxvQkFBSSxPQUFPLElBQVg7QUFDQSxxQkFBSyxhQUFMLENBQW1CLElBQW5CLEVBQXlCLFFBQXpCLEVBQW1DLElBQW5DO0FBQ0g7QUFDSjs7OzBDQUVpQixJLEVBQU07QUFDcEIsaUJBQUssU0FBTCxHQUFpQixJQUFqQjtBQUNBLGdCQUFJLEtBQUssc0JBQUwsSUFBK0IsSUFBbkMsRUFBeUM7QUFDckMscUJBQUssc0JBQUw7QUFDSDtBQUNKOzs7dUNBRWMsSyxFQUFPO0FBQ2xCO0FBQ0EsZ0JBQUksS0FBSyxZQUFMLElBQXFCLENBQXpCLEVBQTRCO0FBQ3hCLG9CQUFJLEtBQUssa0JBQUwsSUFBMkIsSUFBM0IsSUFBbUMsS0FBSyxPQUFMLElBQWdCLElBQXZELEVBQTZEO0FBQ3pELHlCQUFLLGtCQUFMLENBQXdCLEtBQUssT0FBTCxDQUFhLFdBQXJDO0FBQ0g7QUFDRDtBQUNIOztBQUVEO0FBQ0EsZ0JBQUksS0FBSyxlQUFMLEtBQXlCLGdCQUFnQixNQUE3QyxFQUFxRDtBQUNqRCxvQkFBSSxDQUFDLEtBQUssT0FBTixJQUFpQixLQUFLLGtCQUFMLElBQTJCLElBQTVDLElBQW9ELEtBQUssT0FBTCxJQUFnQixJQUF4RSxFQUE4RTtBQUMxRSx5QkFBSyxrQkFBTCxDQUF3QixLQUFLLE9BQUwsQ0FBYSxXQUFyQztBQUNIO0FBQ0osYUFKRCxNQUtLLElBQUksS0FBSyxlQUFMLEtBQXlCLGdCQUFnQixPQUE3QyxFQUFzRDtBQUN2RCxvQkFBSSxDQUFDLEtBQUssT0FBTixJQUFpQixLQUFLLGtCQUFMLElBQTJCLElBQTVDLElBQW9ELEtBQUssT0FBTCxJQUFnQixJQUF4RSxFQUE4RTtBQUMxRSx3QkFBSSxjQUFjLEtBQUssUUFBTCxJQUFpQixLQUFLLE9BQUwsQ0FBYSxXQUFiLEdBQTJCLEtBQUssZ0JBQWpELENBQWxCO0FBQ0EseUJBQUssa0JBQUwsQ0FBd0IsV0FBeEI7QUFDSDtBQUNKO0FBQ0o7OztzQ0FFYSxJLEVBQU07QUFBQTs7QUFDaEIsZ0JBQUksS0FBSyxRQUFULEVBQW1CO0FBQ2Ysb0JBQUksS0FBSyxHQUFMLENBQVMsS0FBSyxRQUFMLEdBQWMsSUFBZCxHQUFxQixJQUE5QixLQUF1QyxJQUEzQyxFQUFpRDtBQUM3QztBQUNIOztBQUVELG9CQUFJLEtBQUssV0FBTCxJQUFvQixJQUF4QixFQUE4QjtBQUMxQixpQ0FBYSxLQUFLLFdBQWxCO0FBQ0EseUJBQUssV0FBTCxHQUFtQixJQUFuQjtBQUNIOztBQUVELHFCQUFLLFFBQUwsR0FBZ0IsS0FBaEI7QUFDQSwyQkFBVyxZQUFJO0FBQ1gsMkJBQUssT0FBTCxHQUFlLEtBQWY7QUFDQSwyQkFBSyxPQUFMLENBQWEsV0FBYixHQUEyQixPQUFLLElBQWhDO0FBQ0Esd0JBQUksTUFBTSxJQUFJLElBQUosR0FBVyxPQUFYLEtBQXVCLE9BQUssY0FBdEM7QUFDQSw0QkFBUSxHQUFSLENBQVksV0FBVyxHQUF2QjtBQUNBLHdCQUFJLE9BQUssNEJBQUwsSUFBcUMsSUFBekMsRUFBK0M7QUFDM0MsK0JBQUssNEJBQUwsQ0FBa0Msc0NBQXVCLFdBQXpELEVBQ0ksVUFESjtBQUVIO0FBQ0osaUJBVEQsRUFTRSxJQVRGO0FBVUE7QUFDSDtBQUNKOzs7c0NBL1ZvQjtBQUNqQixtQkFBTyxPQUFPLFdBQVAsSUFDSCxPQUFPLFdBQVAsQ0FBbUIsZUFBbkIsQ0FBbUMsMkNBQW5DLENBREo7QUFFSDs7OztFQXhDOEIsZ0I7Ozs7Ozs7O0FDZjVCLElBQU0sc0NBQWU7QUFDeEIsb0JBQWdCO0FBRFEsQ0FBckI7O0FBSUEsSUFBTSxzREFBdUI7QUFDaEMsb0JBQWdCLGdCQURnQjtBQUVoQyxrQkFBYztBQUZrQixDQUE3Qjs7QUFLQSxJQUFNLDREQUEwQjtBQUNuQyx5QkFBcUIscUJBRGM7QUFFbkMsNEJBQXdCLHdCQUZXO0FBR25DLGtCQUFjLGNBSHFCO0FBSW5DLGdCQUFZLFlBSnVCO0FBS25DLCtCQUEyQiwyQkFMUTtBQU1uQyw0QkFBd0I7QUFOVyxDQUFoQzs7Ozs7Ozs7Ozs7OztJQ1RNLE8sV0FBQSxPO0FBRVQscUJBQVksUUFBWixFQUFzQjtBQUFBOztBQUNsQixhQUFLLEtBQUwsR0FBYSxZQUFZLFdBQXpCO0FBQ0g7Ozs7NkJBRUksTyxFQUFTLEssRUFBTyxJLEVBQU0sTyxFQUFTLE0sRUFBUSxDQUMzQzs7OzJCQUVFLEssRUFBTyxJLEVBQU0sQ0FFZjs7OzRCQUVHLEssRUFBTyxDQUVWOzs7MkNBRWtCLE8sRUFBUyxDQUMzQjs7OytCQUVNLENBQ047OztrQ0FFUyxDQUVUOzs7Ozs7Ozs7Ozs7Ozs7O0FDekJMOztBQUNBOztBQUNBOztBQUNBOztBQUVBOzs7O0FBRUE7Ozs7QUFDQTs7QUFDQTs7Ozs7Ozs7OztBQUVBLElBQU0sY0FBYyxHQUFwQjtBQUNBLElBQU0sWUFBWSxLQUFsQjs7SUFFYSxhLFdBQUEsYTs7O0FBRVQsNkJBQWU7QUFBQTs7QUFBQSxrSUFDTCxnQkFESzs7QUFFWCxjQUFLLEdBQUwsR0FBVyxlQUFYOztBQUVBLGNBQUssT0FBTCxHQUFlLElBQWY7QUFDQSxjQUFLLEtBQUwsR0FBYSxJQUFiO0FBQ0EsY0FBSyxJQUFMLEdBQVksSUFBWjtBQUNBLGNBQUssT0FBTCxHQUFlLElBQWY7O0FBRUEsY0FBSyxNQUFMLEdBQWMsSUFBZDtBQUNBLGNBQUssUUFBTCxHQUFnQixJQUFoQjtBQUNBLGNBQUssTUFBTCxHQUFjLElBQWQ7QUFDQSxjQUFLLE9BQUwsR0FBZSxJQUFmOztBQUVBLGNBQUsscUJBQUwsR0FBNkIsSUFBN0I7O0FBRUEsY0FBSyxTQUFMLEdBQWlCLElBQUksb0JBQUosRUFBakI7O0FBRUEsY0FBSyxVQUFMLEdBQWtCLElBQWxCO0FBQ0EsY0FBSyxTQUFMLEdBQWlCLElBQWpCOztBQUVBLGNBQUssb0JBQUwsR0FBNEIsS0FBNUI7QUFDQSxjQUFLLGlCQUFMLEdBQXlCLEtBQXpCO0FBQ0EsY0FBSyw0QkFBTCxHQUFvQyxLQUFwQztBQUNBLGNBQUssVUFBTCxHQUFrQixLQUFsQjtBQXhCVztBQXlCZDs7Ozs2QkFPSSxPLEVBQVMsSyxFQUFPLEksRUFBTSxPLEVBQVMsTSxFQUFRO0FBQ3hDLGlCQUFLLE9BQUwsR0FBZSxPQUFmO0FBQ0EsaUJBQUssS0FBTCxHQUFhLEtBQWI7QUFDQSxpQkFBSyxJQUFMLEdBQVksSUFBWjtBQUNBLGlCQUFLLE9BQUwsR0FBZSxPQUFmO0FBQ0EsZ0JBQUksQ0FBQyxLQUFLLGdCQUFMLEVBQUwsRUFBOEI7QUFDMUIsdUJBQU8sS0FBUDtBQUNIOztBQUVELGlCQUFLLFlBQUwsQ0FBa0IsT0FBbEI7QUFDQSxtQkFBTyxJQUFQO0FBQ0g7OzsyQkFFRSxLLEVBQU8sSSxFQUFNO0FBQ1osZ0JBQUksVUFBVSw0QkFBYSxjQUEzQixFQUEyQztBQUN2QyxxQkFBSyxxQkFBTCxHQUE2QixJQUE3QjtBQUNIO0FBQ0o7Ozs0QkFFRyxLLEVBQU87QUFDUCxnQkFBSSxVQUFVLDRCQUFhLGNBQTNCLEVBQTJDO0FBQ3ZDLHFCQUFLLHFCQUFMLEdBQTZCLElBQTdCO0FBQ0g7QUFDSjs7OzJDQUVrQixPLEVBQVM7QUFDeEIsaUJBQUssT0FBTCxHQUFlLE9BQWY7O0FBRUEsaUJBQUssT0FBTCxDQUFhLGdCQUFiLENBQThCLFlBQTlCLEVBQTRDLEtBQUssbUJBQUwsQ0FBeUIsSUFBekIsQ0FBOEIsSUFBOUIsQ0FBNUMsRUFBaUYsRUFBQyxNQUFNLElBQVAsRUFBakY7QUFDQSxpQkFBSyxNQUFMLENBQVksRUFBWixDQUFlLGVBQU0sTUFBTixDQUFhLEtBQTVCLEVBQW1DLEtBQUssY0FBTCxDQUFvQixJQUFwQixDQUF5QixJQUF6QixDQUFuQztBQUNBLGlCQUFLLE1BQUwsQ0FBWSx5QkFBWixDQUFzQyxLQUFLLHVCQUFMLENBQTZCLElBQTdCLENBQWtDLElBQWxDLENBQXRDOztBQUVBLGlCQUFLLE1BQUwsQ0FBWSxrQkFBWixDQUErQixPQUEvQjtBQUNIOzs7K0JBRU07QUFDSCxpQkFBSyxNQUFMLENBQVksSUFBWjtBQUNBLGlCQUFLLFlBQUwsQ0FBa0IsS0FBSyxLQUF2QjtBQUNIOzs7a0NBRVM7QUFDTixpQkFBSyxVQUFMLEdBQWtCLElBQWxCOztBQUVBLGlCQUFLLGNBQUw7QUFDQSxpQkFBSyxjQUFMO0FBQ0EsaUJBQUssZ0JBQUw7QUFDQSxpQkFBSyxnQkFBTDtBQUNIOzs7MkNBRWtCO0FBQ2YsZ0JBQUksV0FBSyxhQUFMLENBQW1CLEtBQUssT0FBeEIsS0FBb0MsV0FBSyxhQUFMLENBQW1CLEtBQUssS0FBeEIsQ0FBeEMsRUFBd0U7QUFDcEUsdUJBQU8sS0FBUDtBQUNIO0FBQ0QsZ0JBQUksV0FBSyxhQUFMLENBQW1CLEtBQUssSUFBeEIsQ0FBSixFQUFtQztBQUMvQix1QkFBTyxLQUFQO0FBQ0g7QUFDRCxnQkFBSSxLQUFLLE9BQUwsR0FBZSxDQUFmLElBQW9CLEtBQUssT0FBTCxHQUFlLEdBQXZDLEVBQTRDO0FBQ3hDLHVCQUFPLEtBQVA7QUFDSDtBQUNELG1CQUFPLElBQVA7QUFDSDs7O3FDQUVZLEcsRUFBSztBQUNkLGlCQUFLLGNBQUw7O0FBRUEsaUJBQUssTUFBTCxHQUFjLGVBQU0sWUFBTixDQUFtQixFQUFDLFFBQU8sSUFBUixFQUFjLE1BQUssS0FBbkIsRUFBeUIsS0FBSSxHQUE3QixFQUFuQixFQUFzRDtBQUNoRSwwQkFBVSxLQURzRDtBQUVoRSxtQ0FBbUIsS0FGNkM7QUFHaEUsMENBQXlCO0FBSHVDLGFBQXRELENBQWQ7QUFLSDs7OzhDQUVxQjtBQUNsQixnQkFBSSxTQUFKLEVBQWU7QUFDWCx3QkFBUSxHQUFSLENBQVksbUJBQVo7QUFDSDs7QUFFRCxpQkFBSyxvQkFBTCxHQUE0QixJQUE1QjtBQUNBLGdCQUFJLEtBQUssaUJBQUwsSUFBMEIsS0FBSyxxQkFBTCxJQUE4QixJQUE1RCxFQUFrRTtBQUM5RCxxQkFBSyxxQkFBTCxDQUEyQixvQ0FBcUIsY0FBaEQsRUFBZ0UsRUFBaEU7QUFDSDtBQUNKOzs7dUNBRWMsSSxFQUFNLE0sRUFBUSxNLEVBQVE7QUFDakMsZ0JBQUksU0FBSixFQUFlO0FBQ1gsd0JBQVEsR0FBUixDQUFZLGNBQVo7QUFDSDs7QUFFRCxnQkFBSSxLQUFLLHFCQUFMLElBQThCLElBQWxDLEVBQXdDO0FBQ3BDO0FBQ0g7O0FBRUQsZ0JBQUksS0FBSyxvQkFBVCxFQUErQjtBQUMzQixxQkFBSyxxQkFBTCxDQUEyQixvQ0FBcUIsWUFBaEQsRUFDSSx1Q0FBd0IsWUFENUI7QUFFSCxhQUhELE1BSUs7QUFDRCxxQkFBSyxxQkFBTCxDQUEyQixvQ0FBcUIsWUFBaEQsRUFDSSx1Q0FBd0IsbUJBRDVCO0FBRUg7QUFDSjs7O2dEQUV1QixJLEVBQU07QUFDMUIsZ0JBQUksU0FBSixFQUFlO0FBQ1gsd0JBQVEsR0FBUixDQUFZLG1CQUFaO0FBQ0g7O0FBRUQsZ0JBQUksS0FBSyxxQkFBTCxJQUE4QixJQUFsQyxFQUF3QztBQUNwQyxxQkFBSyxxQkFBTCxDQUEyQixvQ0FBcUIsWUFBaEQsRUFDSSx1Q0FBd0Isc0JBRDVCO0FBRUg7QUFDSjs7O3lDQUVnQjtBQUNiLGdCQUFJLEtBQUssTUFBTCxJQUFlLElBQW5CLEVBQXlCO0FBQ3JCLHFCQUFLLE1BQUwsQ0FBWSxLQUFaO0FBQ0EscUJBQUssTUFBTCxDQUFZLE1BQVo7QUFDQSxxQkFBSyxNQUFMLENBQVksa0JBQVo7QUFDQSxxQkFBSyxNQUFMLENBQVksT0FBWjtBQUNBLHFCQUFLLE1BQUwsR0FBYyxJQUFkO0FBQ0g7O0FBRUQsZ0JBQUksS0FBSyxPQUFMLElBQWdCLElBQXBCLEVBQTBCO0FBQ3RCLHFCQUFLLE9BQUwsR0FBZSxJQUFmO0FBQ0g7QUFDSjs7O3FDQUVZLEcsRUFBSztBQUNkLGlCQUFLLE1BQUwsR0FBYyxJQUFJLFNBQUosQ0FBYyxHQUFkLENBQWQ7QUFDQSxpQkFBSyxNQUFMLENBQVksTUFBWixHQUFxQixLQUFLLGFBQUwsQ0FBbUIsSUFBbkIsQ0FBd0IsSUFBeEIsQ0FBckI7QUFDQSxpQkFBSyxNQUFMLENBQVksU0FBWixHQUF3QixLQUFLLFlBQUwsQ0FBa0IsSUFBbEIsQ0FBdUIsSUFBdkIsQ0FBeEI7QUFDQSxpQkFBSyxNQUFMLENBQVksT0FBWixHQUFzQixLQUFLLGNBQUwsQ0FBb0IsSUFBcEIsQ0FBeUIsSUFBekIsQ0FBdEI7QUFDQSxpQkFBSyxNQUFMLENBQVksT0FBWixHQUFzQixLQUFLLGNBQUwsQ0FBb0IsSUFBcEIsQ0FBeUIsSUFBekIsQ0FBdEI7QUFDSDs7O3dDQUVlO0FBQ1osZ0JBQUksU0FBSixFQUFlO0FBQ1gsd0JBQVEsR0FBUixDQUFZLGdCQUFaO0FBQ0g7O0FBRUQsaUJBQUssY0FBTDtBQUNIOzs7cUNBRVksQyxFQUFHLENBRWY7Ozt1Q0FFYyxDLEVBQUc7QUFDZCxnQkFBSSxTQUFKLEVBQWU7QUFDWCx3QkFBUSxHQUFSLENBQVksaUJBQVo7QUFDSDs7QUFFRCxnQkFBSSxLQUFLLHFCQUFMLElBQThCLElBQWxDLEVBQXdDO0FBQ3BDLHFCQUFLLHFCQUFMLENBQTJCLG9DQUFxQixZQUFoRCxFQUNJLHVDQUF3QixVQUQ1QjtBQUVIO0FBQ0o7Ozt1Q0FFYyxDLEVBQUc7QUFDZCxnQkFBSSxTQUFKLEVBQWU7QUFDWCx3QkFBUSxHQUFSLENBQVksaUJBQVo7QUFDSDtBQUNKOzs7eUNBRWdCO0FBQ2IsaUJBQUssTUFBTCxDQUFZLEtBQVo7QUFDQSxpQkFBSyxNQUFMLEdBQWMsSUFBZDtBQUNIOzs7eUNBRWdCO0FBQ2IsZ0JBQUksS0FBSyxRQUFULEVBQW1CO0FBQ2YscUJBQUssUUFBTCxDQUFjLEtBQWQ7QUFDSDs7QUFFRCxpQkFBSyxRQUFMLEdBQWdCLDRCQUFTO0FBQ3JCLHNCQUFLLEtBRGdCO0FBRXJCLDRCQUFXLElBRlU7QUFHckIseUJBQVEsRUFIYTtBQUlyQiwyQkFBVSxLQUFLLHdCQUFMLENBQThCLElBQTlCLENBQW1DLElBQW5DO0FBSlcsYUFBVCxDQUFoQjtBQU1BLGlCQUFLLFVBQUwsR0FBa0IsV0FBVyxLQUFLLGtDQUFMLENBQXdDLElBQXhDLENBQTZDLElBQTdDLENBQVgsRUFBOEQsS0FBOUQsQ0FBbEI7QUFDQSxpQkFBSyxRQUFMLENBQWMsSUFBZCxDQUFtQixLQUFLLHNCQUFMLENBQTRCLElBQTVCLENBQWlDLElBQWpDLENBQW5CLEVBQ0ksS0FBSyx5QkFBTCxDQUErQixJQUEvQixDQUFvQyxJQUFwQyxDQURKO0FBRUg7Ozs2REFFb0M7QUFDakMsZ0JBQUksU0FBSixFQUFlO0FBQ1gsd0JBQVEsR0FBUixDQUFZLGlDQUFaO0FBQ0g7O0FBRUQsaUJBQUssNEJBQUwsR0FBb0MsSUFBcEM7O0FBRUEsZ0JBQUksS0FBSyxxQkFBTCxJQUE4QixJQUFsQyxFQUF3QztBQUNwQyxxQkFBSyxxQkFBTCxDQUEyQixvQ0FBcUIsWUFBaEQsRUFDSSx1Q0FBd0IseUJBRDVCO0FBRUg7QUFDSjs7O2lEQUV3QjtBQUNyQixnQkFBSSxTQUFKLEVBQWU7QUFDWCx3QkFBUSxHQUFSLENBQVksMEJBQVo7QUFDSDs7QUFFRCxnQkFBSSxLQUFLLDRCQUFULEVBQXVDO0FBQ25DO0FBQ0g7O0FBRUQseUJBQWEsS0FBSyxVQUFsQjs7QUFFQSxpQkFBSyxpQkFBTCxHQUF5QixJQUF6QjtBQUNBLGdCQUFJLEtBQUssb0JBQUwsSUFBNkIsS0FBSyxxQkFBTCxJQUE4QixJQUEvRCxFQUFxRTtBQUNqRSxxQkFBSyxxQkFBTCxDQUEyQixvQ0FBcUIsY0FBaEQsRUFBZ0UsRUFBaEU7QUFDSDs7QUFFRCxpQkFBSyxRQUFMLENBQWMsS0FBZDtBQUNBLGlCQUFLLFNBQUw7QUFDSDs7O2tEQUV5QixHLEVBQUssYyxFQUFnQjtBQUMzQyxnQkFBSSxTQUFKLEVBQWU7QUFDWCx3QkFBUSxHQUFSLENBQVksNkJBQVo7QUFDSDs7QUFFRCx5QkFBYSxLQUFLLFVBQWxCOztBQUVBLGdCQUFJLEtBQUsscUJBQUwsSUFBOEIsSUFBbEMsRUFBd0M7QUFDcEMscUJBQUsscUJBQUwsQ0FBMkIsb0NBQXFCLFlBQWhELEVBQ0ksdUNBQXdCLHNCQUQ1QjtBQUVIO0FBQ0o7OztpREFFd0IsTyxFQUFTLFUsRUFBWSxjLEVBQWdCLGdCLEVBQWtCO0FBQzVFLGdCQUFJLFdBQVcsUUFBUSxRQUFRLE1BQVIsR0FBaUIsQ0FBekIsRUFBNEIsTUFBM0MsQ0FENEUsQ0FDekI7QUFDbkQsZ0JBQUksUUFBUSxJQUFJLFVBQUosQ0FBZSxRQUFmLENBQVosQ0FGNEUsQ0FFdEM7QUFDdEMsaUJBQUssU0FBTCxDQUFlLElBQWYsQ0FBb0IsS0FBcEI7QUFDSDs7OzJDQUVrQjtBQUNmLGlCQUFLLFFBQUwsQ0FBYyxLQUFkO0FBQ0EsaUJBQUssUUFBTCxHQUFnQixJQUFoQjtBQUNIOzs7b0NBRVc7QUFDUixnQkFBSSxLQUFLLFVBQVQsRUFBcUI7QUFDakI7QUFDSDs7QUFFRCxnQkFBSSxLQUFLLFNBQUwsQ0FBZSxNQUFmLEdBQXdCLFdBQTVCLEVBQXlDO0FBQ3JDLHFCQUFLLFNBQUwsR0FBaUIsV0FBVyxLQUFLLFNBQUwsQ0FBZSxJQUFmLENBQW9CLElBQXBCLENBQVgsRUFBc0MsQ0FBdEMsQ0FBakI7QUFDSCxhQUZELE1BR0s7QUFDRCxvQkFBSSxXQUFXLEtBQUssU0FBTCxDQUFlLFNBQWYsQ0FBeUIsV0FBekIsQ0FBZjs7QUFFQSxvQkFBSSxTQUFTLElBQUksb0JBQUosRUFBYjtBQUNBLHVCQUFPLElBQVAsQ0FBWSxJQUFJLFVBQUosQ0FBZSxDQUFDLElBQUQsRUFBTSxJQUFOLEVBQVcsSUFBWCxFQUFnQixJQUFoQixDQUFmLENBQVo7QUFDQSxvQkFBSSxjQUFjLEtBQUssSUFBTCxDQUFVLEtBQVYsQ0FBZ0IsRUFBaEIsQ0FBbEI7QUFDQSxxQkFBSyxJQUFJLElBQUksQ0FBYixFQUFnQixJQUFJLFlBQVksTUFBaEMsRUFBd0MsR0FBeEMsRUFBNkM7QUFDekMsMkJBQU8sSUFBUCxDQUFZLElBQUksVUFBSixDQUFlLENBQUMsWUFBWSxDQUFaLEVBQWUsVUFBZixFQUFELENBQWYsQ0FBWjtBQUNIO0FBQ0QsdUJBQU8sSUFBUCxDQUFZLElBQUksVUFBSixDQUFlLENBQUMsU0FBUyxLQUFLLE9BQWQsQ0FBRCxDQUFmLENBQVo7QUFDQSx1QkFBTyxJQUFQLENBQVksSUFBSSxVQUFKLENBQWUsQ0FBQyxLQUFLLEtBQUwsQ0FBVyxjQUFZLEdBQXZCLENBQUQsQ0FBZixDQUFaO0FBQ0EsdUJBQU8sSUFBUCxDQUFZLElBQUksVUFBSixDQUFlLENBQUMsY0FBWSxHQUFiLENBQWYsQ0FBWjtBQUNBLHVCQUFPLElBQVAsQ0FBWSxRQUFaOztBQUVBLG9CQUFJLFdBQVcsSUFBSSxZQUFZLE1BQWhCLEdBQXlCLENBQXpCLEdBQTZCLFdBQTVDO0FBQ0Esb0JBQUksS0FBSyxNQUFMLElBQWUsSUFBbkIsRUFBeUI7QUFDckIseUJBQUssTUFBTCxDQUFZLElBQVosQ0FBaUIsT0FBTyxTQUFQLENBQWlCLFFBQWpCLENBQWpCO0FBQ0g7O0FBRUQscUJBQUssU0FBTDtBQUNIO0FBQ0o7OzsyQ0FFa0I7QUFDZix5QkFBYSxLQUFLLFNBQWxCO0FBQ0g7OztzQ0F4Um9CO0FBQ2pCLG1CQUFPLE9BQU8sU0FBUCxJQUFvQixXQUFwQixJQUFtQyx1QkFBUyxPQUFULEVBQW5DLElBQXlELE9BQU8sV0FBaEUsSUFDSCxPQUFPLFdBQVAsQ0FBbUIsZUFBbkIsQ0FBbUMsMkNBQW5DLENBREo7QUFFSDs7OztFQWhDOEIsZ0IiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCIoZnVuY3Rpb24oZil7aWYodHlwZW9mIGV4cG9ydHM9PT1cIm9iamVjdFwiJiZ0eXBlb2YgbW9kdWxlIT09XCJ1bmRlZmluZWRcIil7bW9kdWxlLmV4cG9ydHM9ZigpfWVsc2UgaWYodHlwZW9mIGRlZmluZT09PVwiZnVuY3Rpb25cIiYmZGVmaW5lLmFtZCl7ZGVmaW5lKFtdLGYpfWVsc2V7dmFyIGc7aWYodHlwZW9mIHdpbmRvdyE9PVwidW5kZWZpbmVkXCIpe2c9d2luZG93fWVsc2UgaWYodHlwZW9mIGdsb2JhbCE9PVwidW5kZWZpbmVkXCIpe2c9Z2xvYmFsfWVsc2UgaWYodHlwZW9mIHNlbGYhPT1cInVuZGVmaW5lZFwiKXtnPXNlbGZ9ZWxzZXtnPXRoaXN9Zy5mbHZqcyA9IGYoKX19KShmdW5jdGlvbigpe3ZhciBkZWZpbmUsbW9kdWxlLGV4cG9ydHM7cmV0dXJuIChmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbihmdW5jdGlvbiAocHJvY2VzcyxnbG9iYWwpe1xuLyohXG4gKiBAb3ZlcnZpZXcgZXM2LXByb21pc2UgLSBhIHRpbnkgaW1wbGVtZW50YXRpb24gb2YgUHJvbWlzZXMvQSsuXG4gKiBAY29weXJpZ2h0IENvcHlyaWdodCAoYykgMjAxNCBZZWh1ZGEgS2F0eiwgVG9tIERhbGUsIFN0ZWZhbiBQZW5uZXIgYW5kIGNvbnRyaWJ1dG9ycyAoQ29udmVyc2lvbiB0byBFUzYgQVBJIGJ5IEpha2UgQXJjaGliYWxkKVxuICogQGxpY2Vuc2UgICBMaWNlbnNlZCB1bmRlciBNSVQgbGljZW5zZVxuICogICAgICAgICAgICBTZWUgaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3N0ZWZhbnBlbm5lci9lczYtcHJvbWlzZS9tYXN0ZXIvTElDRU5TRVxuICogQHZlcnNpb24gICB2NC4yLjUrN2YyYjUyNmRcbiAqL1xuXG4oZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuXHR0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKSA6XG5cdHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShmYWN0b3J5KSA6XG5cdChnbG9iYWwuRVM2UHJvbWlzZSA9IGZhY3RvcnkoKSk7XG59KHRoaXMsIChmdW5jdGlvbiAoKSB7ICd1c2Ugc3RyaWN0JztcblxuZnVuY3Rpb24gb2JqZWN0T3JGdW5jdGlvbih4KSB7XG4gIHZhciB0eXBlID0gdHlwZW9mIHg7XG4gIHJldHVybiB4ICE9PSBudWxsICYmICh0eXBlID09PSAnb2JqZWN0JyB8fCB0eXBlID09PSAnZnVuY3Rpb24nKTtcbn1cblxuZnVuY3Rpb24gaXNGdW5jdGlvbih4KSB7XG4gIHJldHVybiB0eXBlb2YgeCA9PT0gJ2Z1bmN0aW9uJztcbn1cblxuXG5cbnZhciBfaXNBcnJheSA9IHZvaWQgMDtcbmlmIChBcnJheS5pc0FycmF5KSB7XG4gIF9pc0FycmF5ID0gQXJyYXkuaXNBcnJheTtcbn0gZWxzZSB7XG4gIF9pc0FycmF5ID0gZnVuY3Rpb24gKHgpIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHgpID09PSAnW29iamVjdCBBcnJheV0nO1xuICB9O1xufVxuXG52YXIgaXNBcnJheSA9IF9pc0FycmF5O1xuXG52YXIgbGVuID0gMDtcbnZhciB2ZXJ0eE5leHQgPSB2b2lkIDA7XG52YXIgY3VzdG9tU2NoZWR1bGVyRm4gPSB2b2lkIDA7XG5cbnZhciBhc2FwID0gZnVuY3Rpb24gYXNhcChjYWxsYmFjaywgYXJnKSB7XG4gIHF1ZXVlW2xlbl0gPSBjYWxsYmFjaztcbiAgcXVldWVbbGVuICsgMV0gPSBhcmc7XG4gIGxlbiArPSAyO1xuICBpZiAobGVuID09PSAyKSB7XG4gICAgLy8gSWYgbGVuIGlzIDIsIHRoYXQgbWVhbnMgdGhhdCB3ZSBuZWVkIHRvIHNjaGVkdWxlIGFuIGFzeW5jIGZsdXNoLlxuICAgIC8vIElmIGFkZGl0aW9uYWwgY2FsbGJhY2tzIGFyZSBxdWV1ZWQgYmVmb3JlIHRoZSBxdWV1ZSBpcyBmbHVzaGVkLCB0aGV5XG4gICAgLy8gd2lsbCBiZSBwcm9jZXNzZWQgYnkgdGhpcyBmbHVzaCB0aGF0IHdlIGFyZSBzY2hlZHVsaW5nLlxuICAgIGlmIChjdXN0b21TY2hlZHVsZXJGbikge1xuICAgICAgY3VzdG9tU2NoZWR1bGVyRm4oZmx1c2gpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzY2hlZHVsZUZsdXNoKCk7XG4gICAgfVxuICB9XG59O1xuXG5mdW5jdGlvbiBzZXRTY2hlZHVsZXIoc2NoZWR1bGVGbikge1xuICBjdXN0b21TY2hlZHVsZXJGbiA9IHNjaGVkdWxlRm47XG59XG5cbmZ1bmN0aW9uIHNldEFzYXAoYXNhcEZuKSB7XG4gIGFzYXAgPSBhc2FwRm47XG59XG5cbnZhciBicm93c2VyV2luZG93ID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB1bmRlZmluZWQ7XG52YXIgYnJvd3Nlckdsb2JhbCA9IGJyb3dzZXJXaW5kb3cgfHwge307XG52YXIgQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIgPSBicm93c2VyR2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgYnJvd3Nlckdsb2JhbC5XZWJLaXRNdXRhdGlvbk9ic2VydmVyO1xudmFyIGlzTm9kZSA9IHR5cGVvZiBzZWxmID09PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYge30udG9TdHJpbmcuY2FsbChwcm9jZXNzKSA9PT0gJ1tvYmplY3QgcHJvY2Vzc10nO1xuXG4vLyB0ZXN0IGZvciB3ZWIgd29ya2VyIGJ1dCBub3QgaW4gSUUxMFxudmFyIGlzV29ya2VyID0gdHlwZW9mIFVpbnQ4Q2xhbXBlZEFycmF5ICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgaW1wb3J0U2NyaXB0cyAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIE1lc3NhZ2VDaGFubmVsICE9PSAndW5kZWZpbmVkJztcblxuLy8gbm9kZVxuZnVuY3Rpb24gdXNlTmV4dFRpY2soKSB7XG4gIC8vIG5vZGUgdmVyc2lvbiAwLjEwLnggZGlzcGxheXMgYSBkZXByZWNhdGlvbiB3YXJuaW5nIHdoZW4gbmV4dFRpY2sgaXMgdXNlZCByZWN1cnNpdmVseVxuICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2N1am9qcy93aGVuL2lzc3Vlcy80MTAgZm9yIGRldGFpbHNcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gcHJvY2Vzcy5uZXh0VGljayhmbHVzaCk7XG4gIH07XG59XG5cbi8vIHZlcnR4XG5mdW5jdGlvbiB1c2VWZXJ0eFRpbWVyKCkge1xuICBpZiAodHlwZW9mIHZlcnR4TmV4dCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgdmVydHhOZXh0KGZsdXNoKTtcbiAgICB9O1xuICB9XG5cbiAgcmV0dXJuIHVzZVNldFRpbWVvdXQoKTtcbn1cblxuZnVuY3Rpb24gdXNlTXV0YXRpb25PYnNlcnZlcigpIHtcbiAgdmFyIGl0ZXJhdGlvbnMgPSAwO1xuICB2YXIgb2JzZXJ2ZXIgPSBuZXcgQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIoZmx1c2gpO1xuICB2YXIgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCcnKTtcbiAgb2JzZXJ2ZXIub2JzZXJ2ZShub2RlLCB7IGNoYXJhY3RlckRhdGE6IHRydWUgfSk7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICBub2RlLmRhdGEgPSBpdGVyYXRpb25zID0gKytpdGVyYXRpb25zICUgMjtcbiAgfTtcbn1cblxuLy8gd2ViIHdvcmtlclxuZnVuY3Rpb24gdXNlTWVzc2FnZUNoYW5uZWwoKSB7XG4gIHZhciBjaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsKCk7XG4gIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gZmx1c2g7XG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIGNoYW5uZWwucG9ydDIucG9zdE1lc3NhZ2UoMCk7XG4gIH07XG59XG5cbmZ1bmN0aW9uIHVzZVNldFRpbWVvdXQoKSB7XG4gIC8vIFN0b3JlIHNldFRpbWVvdXQgcmVmZXJlbmNlIHNvIGVzNi1wcm9taXNlIHdpbGwgYmUgdW5hZmZlY3RlZCBieVxuICAvLyBvdGhlciBjb2RlIG1vZGlmeWluZyBzZXRUaW1lb3V0IChsaWtlIHNpbm9uLnVzZUZha2VUaW1lcnMoKSlcbiAgdmFyIGdsb2JhbFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBnbG9iYWxTZXRUaW1lb3V0KGZsdXNoLCAxKTtcbiAgfTtcbn1cblxudmFyIHF1ZXVlID0gbmV3IEFycmF5KDEwMDApO1xuZnVuY3Rpb24gZmx1c2goKSB7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpICs9IDIpIHtcbiAgICB2YXIgY2FsbGJhY2sgPSBxdWV1ZVtpXTtcbiAgICB2YXIgYXJnID0gcXVldWVbaSArIDFdO1xuXG4gICAgY2FsbGJhY2soYXJnKTtcblxuICAgIHF1ZXVlW2ldID0gdW5kZWZpbmVkO1xuICAgIHF1ZXVlW2kgKyAxXSA9IHVuZGVmaW5lZDtcbiAgfVxuXG4gIGxlbiA9IDA7XG59XG5cbmZ1bmN0aW9uIGF0dGVtcHRWZXJ0eCgpIHtcbiAgdHJ5IHtcbiAgICB2YXIgdmVydHggPSBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpLnJlcXVpcmUoJ3ZlcnR4Jyk7XG4gICAgdmVydHhOZXh0ID0gdmVydHgucnVuT25Mb29wIHx8IHZlcnR4LnJ1bk9uQ29udGV4dDtcbiAgICByZXR1cm4gdXNlVmVydHhUaW1lcigpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIHVzZVNldFRpbWVvdXQoKTtcbiAgfVxufVxuXG52YXIgc2NoZWR1bGVGbHVzaCA9IHZvaWQgMDtcbi8vIERlY2lkZSB3aGF0IGFzeW5jIG1ldGhvZCB0byB1c2UgdG8gdHJpZ2dlcmluZyBwcm9jZXNzaW5nIG9mIHF1ZXVlZCBjYWxsYmFja3M6XG5pZiAoaXNOb2RlKSB7XG4gIHNjaGVkdWxlRmx1c2ggPSB1c2VOZXh0VGljaygpO1xufSBlbHNlIGlmIChCcm93c2VyTXV0YXRpb25PYnNlcnZlcikge1xuICBzY2hlZHVsZUZsdXNoID0gdXNlTXV0YXRpb25PYnNlcnZlcigpO1xufSBlbHNlIGlmIChpc1dvcmtlcikge1xuICBzY2hlZHVsZUZsdXNoID0gdXNlTWVzc2FnZUNoYW5uZWwoKTtcbn0gZWxzZSBpZiAoYnJvd3NlcldpbmRvdyA9PT0gdW5kZWZpbmVkICYmIHR5cGVvZiBfZGVyZXFfID09PSAnZnVuY3Rpb24nKSB7XG4gIHNjaGVkdWxlRmx1c2ggPSBhdHRlbXB0VmVydHgoKTtcbn0gZWxzZSB7XG4gIHNjaGVkdWxlRmx1c2ggPSB1c2VTZXRUaW1lb3V0KCk7XG59XG5cbmZ1bmN0aW9uIHRoZW4ob25GdWxmaWxsbWVudCwgb25SZWplY3Rpb24pIHtcbiAgdmFyIHBhcmVudCA9IHRoaXM7XG5cbiAgdmFyIGNoaWxkID0gbmV3IHRoaXMuY29uc3RydWN0b3Iobm9vcCk7XG5cbiAgaWYgKGNoaWxkW1BST01JU0VfSURdID09PSB1bmRlZmluZWQpIHtcbiAgICBtYWtlUHJvbWlzZShjaGlsZCk7XG4gIH1cblxuICB2YXIgX3N0YXRlID0gcGFyZW50Ll9zdGF0ZTtcblxuXG4gIGlmIChfc3RhdGUpIHtcbiAgICB2YXIgY2FsbGJhY2sgPSBhcmd1bWVudHNbX3N0YXRlIC0gMV07XG4gICAgYXNhcChmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gaW52b2tlQ2FsbGJhY2soX3N0YXRlLCBjaGlsZCwgY2FsbGJhY2ssIHBhcmVudC5fcmVzdWx0KTtcbiAgICB9KTtcbiAgfSBlbHNlIHtcbiAgICBzdWJzY3JpYmUocGFyZW50LCBjaGlsZCwgb25GdWxmaWxsbWVudCwgb25SZWplY3Rpb24pO1xuICB9XG5cbiAgcmV0dXJuIGNoaWxkO1xufVxuXG4vKipcbiAgYFByb21pc2UucmVzb2x2ZWAgcmV0dXJucyBhIHByb21pc2UgdGhhdCB3aWxsIGJlY29tZSByZXNvbHZlZCB3aXRoIHRoZVxuICBwYXNzZWQgYHZhbHVlYC4gSXQgaXMgc2hvcnRoYW5kIGZvciB0aGUgZm9sbG93aW5nOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgIHJlc29sdmUoMSk7XG4gIH0pO1xuXG4gIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgLy8gdmFsdWUgPT09IDFcbiAgfSk7XG4gIGBgYFxuXG4gIEluc3RlYWQgb2Ygd3JpdGluZyB0aGUgYWJvdmUsIHlvdXIgY29kZSBub3cgc2ltcGx5IGJlY29tZXMgdGhlIGZvbGxvd2luZzpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKDEpO1xuXG4gIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgLy8gdmFsdWUgPT09IDFcbiAgfSk7XG4gIGBgYFxuXG4gIEBtZXRob2QgcmVzb2x2ZVxuICBAc3RhdGljXG4gIEBwYXJhbSB7QW55fSB2YWx1ZSB2YWx1ZSB0aGF0IHRoZSByZXR1cm5lZCBwcm9taXNlIHdpbGwgYmUgcmVzb2x2ZWQgd2l0aFxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEByZXR1cm4ge1Byb21pc2V9IGEgcHJvbWlzZSB0aGF0IHdpbGwgYmVjb21lIGZ1bGZpbGxlZCB3aXRoIHRoZSBnaXZlblxuICBgdmFsdWVgXG4qL1xuZnVuY3Rpb24gcmVzb2x2ZSQxKG9iamVjdCkge1xuICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuXG4gIGlmIChvYmplY3QgJiYgdHlwZW9mIG9iamVjdCA9PT0gJ29iamVjdCcgJiYgb2JqZWN0LmNvbnN0cnVjdG9yID09PSBDb25zdHJ1Y3Rvcikge1xuICAgIHJldHVybiBvYmplY3Q7XG4gIH1cblxuICB2YXIgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3Rvcihub29wKTtcbiAgcmVzb2x2ZShwcm9taXNlLCBvYmplY3QpO1xuICByZXR1cm4gcHJvbWlzZTtcbn1cblxudmFyIFBST01JU0VfSUQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMik7XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG52YXIgUEVORElORyA9IHZvaWQgMDtcbnZhciBGVUxGSUxMRUQgPSAxO1xudmFyIFJFSkVDVEVEID0gMjtcblxudmFyIFRSWV9DQVRDSF9FUlJPUiA9IHsgZXJyb3I6IG51bGwgfTtcblxuZnVuY3Rpb24gc2VsZkZ1bGZpbGxtZW50KCkge1xuICByZXR1cm4gbmV3IFR5cGVFcnJvcihcIllvdSBjYW5ub3QgcmVzb2x2ZSBhIHByb21pc2Ugd2l0aCBpdHNlbGZcIik7XG59XG5cbmZ1bmN0aW9uIGNhbm5vdFJldHVybk93bigpIHtcbiAgcmV0dXJuIG5ldyBUeXBlRXJyb3IoJ0EgcHJvbWlzZXMgY2FsbGJhY2sgY2Fubm90IHJldHVybiB0aGF0IHNhbWUgcHJvbWlzZS4nKTtcbn1cblxuZnVuY3Rpb24gZ2V0VGhlbihwcm9taXNlKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHByb21pc2UudGhlbjtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBUUllfQ0FUQ0hfRVJST1IuZXJyb3IgPSBlcnJvcjtcbiAgICByZXR1cm4gVFJZX0NBVENIX0VSUk9SO1xuICB9XG59XG5cbmZ1bmN0aW9uIHRyeVRoZW4odGhlbiQkMSwgdmFsdWUsIGZ1bGZpbGxtZW50SGFuZGxlciwgcmVqZWN0aW9uSGFuZGxlcikge1xuICB0cnkge1xuICAgIHRoZW4kJDEuY2FsbCh2YWx1ZSwgZnVsZmlsbG1lbnRIYW5kbGVyLCByZWplY3Rpb25IYW5kbGVyKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBlO1xuICB9XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUZvcmVpZ25UaGVuYWJsZShwcm9taXNlLCB0aGVuYWJsZSwgdGhlbiQkMSkge1xuICBhc2FwKGZ1bmN0aW9uIChwcm9taXNlKSB7XG4gICAgdmFyIHNlYWxlZCA9IGZhbHNlO1xuICAgIHZhciBlcnJvciA9IHRyeVRoZW4odGhlbiQkMSwgdGhlbmFibGUsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgaWYgKHNlYWxlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBzZWFsZWQgPSB0cnVlO1xuICAgICAgaWYgKHRoZW5hYmxlICE9PSB2YWx1ZSkge1xuICAgICAgICByZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpO1xuICAgICAgfVxuICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIGlmIChzZWFsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgc2VhbGVkID0gdHJ1ZTtcblxuICAgICAgcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG4gICAgfSwgJ1NldHRsZTogJyArIChwcm9taXNlLl9sYWJlbCB8fCAnIHVua25vd24gcHJvbWlzZScpKTtcblxuICAgIGlmICghc2VhbGVkICYmIGVycm9yKSB7XG4gICAgICBzZWFsZWQgPSB0cnVlO1xuICAgICAgcmVqZWN0KHByb21pc2UsIGVycm9yKTtcbiAgICB9XG4gIH0sIHByb21pc2UpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVPd25UaGVuYWJsZShwcm9taXNlLCB0aGVuYWJsZSkge1xuICBpZiAodGhlbmFibGUuX3N0YXRlID09PSBGVUxGSUxMRUQpIHtcbiAgICBmdWxmaWxsKHByb21pc2UsIHRoZW5hYmxlLl9yZXN1bHQpO1xuICB9IGVsc2UgaWYgKHRoZW5hYmxlLl9zdGF0ZSA9PT0gUkVKRUNURUQpIHtcbiAgICByZWplY3QocHJvbWlzZSwgdGhlbmFibGUuX3Jlc3VsdCk7XG4gIH0gZWxzZSB7XG4gICAgc3Vic2NyaWJlKHRoZW5hYmxlLCB1bmRlZmluZWQsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgcmV0dXJuIHJlc29sdmUocHJvbWlzZSwgdmFsdWUpO1xuICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIHJldHVybiByZWplY3QocHJvbWlzZSwgcmVhc29uKTtcbiAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVNYXliZVRoZW5hYmxlKHByb21pc2UsIG1heWJlVGhlbmFibGUsIHRoZW4kJDEpIHtcbiAgaWYgKG1heWJlVGhlbmFibGUuY29uc3RydWN0b3IgPT09IHByb21pc2UuY29uc3RydWN0b3IgJiYgdGhlbiQkMSA9PT0gdGhlbiAmJiBtYXliZVRoZW5hYmxlLmNvbnN0cnVjdG9yLnJlc29sdmUgPT09IHJlc29sdmUkMSkge1xuICAgIGhhbmRsZU93blRoZW5hYmxlKHByb21pc2UsIG1heWJlVGhlbmFibGUpO1xuICB9IGVsc2Uge1xuICAgIGlmICh0aGVuJCQxID09PSBUUllfQ0FUQ0hfRVJST1IpIHtcbiAgICAgIHJlamVjdChwcm9taXNlLCBUUllfQ0FUQ0hfRVJST1IuZXJyb3IpO1xuICAgICAgVFJZX0NBVENIX0VSUk9SLmVycm9yID0gbnVsbDtcbiAgICB9IGVsc2UgaWYgKHRoZW4kJDEgPT09IHVuZGVmaW5lZCkge1xuICAgICAgZnVsZmlsbChwcm9taXNlLCBtYXliZVRoZW5hYmxlKTtcbiAgICB9IGVsc2UgaWYgKGlzRnVuY3Rpb24odGhlbiQkMSkpIHtcbiAgICAgIGhhbmRsZUZvcmVpZ25UaGVuYWJsZShwcm9taXNlLCBtYXliZVRoZW5hYmxlLCB0aGVuJCQxKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZnVsZmlsbChwcm9taXNlLCBtYXliZVRoZW5hYmxlKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSkge1xuICBpZiAocHJvbWlzZSA9PT0gdmFsdWUpIHtcbiAgICByZWplY3QocHJvbWlzZSwgc2VsZkZ1bGZpbGxtZW50KCkpO1xuICB9IGVsc2UgaWYgKG9iamVjdE9yRnVuY3Rpb24odmFsdWUpKSB7XG4gICAgaGFuZGxlTWF5YmVUaGVuYWJsZShwcm9taXNlLCB2YWx1ZSwgZ2V0VGhlbih2YWx1ZSkpO1xuICB9IGVsc2Uge1xuICAgIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHB1Ymxpc2hSZWplY3Rpb24ocHJvbWlzZSkge1xuICBpZiAocHJvbWlzZS5fb25lcnJvcikge1xuICAgIHByb21pc2UuX29uZXJyb3IocHJvbWlzZS5fcmVzdWx0KTtcbiAgfVxuXG4gIHB1Ymxpc2gocHJvbWlzZSk7XG59XG5cbmZ1bmN0aW9uIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpIHtcbiAgaWYgKHByb21pc2UuX3N0YXRlICE9PSBQRU5ESU5HKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcHJvbWlzZS5fcmVzdWx0ID0gdmFsdWU7XG4gIHByb21pc2UuX3N0YXRlID0gRlVMRklMTEVEO1xuXG4gIGlmIChwcm9taXNlLl9zdWJzY3JpYmVycy5sZW5ndGggIT09IDApIHtcbiAgICBhc2FwKHB1Ymxpc2gsIHByb21pc2UpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHJlamVjdChwcm9taXNlLCByZWFzb24pIHtcbiAgaWYgKHByb21pc2UuX3N0YXRlICE9PSBQRU5ESU5HKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIHByb21pc2UuX3N0YXRlID0gUkVKRUNURUQ7XG4gIHByb21pc2UuX3Jlc3VsdCA9IHJlYXNvbjtcblxuICBhc2FwKHB1Ymxpc2hSZWplY3Rpb24sIHByb21pc2UpO1xufVxuXG5mdW5jdGlvbiBzdWJzY3JpYmUocGFyZW50LCBjaGlsZCwgb25GdWxmaWxsbWVudCwgb25SZWplY3Rpb24pIHtcbiAgdmFyIF9zdWJzY3JpYmVycyA9IHBhcmVudC5fc3Vic2NyaWJlcnM7XG4gIHZhciBsZW5ndGggPSBfc3Vic2NyaWJlcnMubGVuZ3RoO1xuXG5cbiAgcGFyZW50Ll9vbmVycm9yID0gbnVsbDtcblxuICBfc3Vic2NyaWJlcnNbbGVuZ3RoXSA9IGNoaWxkO1xuICBfc3Vic2NyaWJlcnNbbGVuZ3RoICsgRlVMRklMTEVEXSA9IG9uRnVsZmlsbG1lbnQ7XG4gIF9zdWJzY3JpYmVyc1tsZW5ndGggKyBSRUpFQ1RFRF0gPSBvblJlamVjdGlvbjtcblxuICBpZiAobGVuZ3RoID09PSAwICYmIHBhcmVudC5fc3RhdGUpIHtcbiAgICBhc2FwKHB1Ymxpc2gsIHBhcmVudCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gcHVibGlzaChwcm9taXNlKSB7XG4gIHZhciBzdWJzY3JpYmVycyA9IHByb21pc2UuX3N1YnNjcmliZXJzO1xuICB2YXIgc2V0dGxlZCA9IHByb21pc2UuX3N0YXRlO1xuXG4gIGlmIChzdWJzY3JpYmVycy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgY2hpbGQgPSB2b2lkIDAsXG4gICAgICBjYWxsYmFjayA9IHZvaWQgMCxcbiAgICAgIGRldGFpbCA9IHByb21pc2UuX3Jlc3VsdDtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHN1YnNjcmliZXJzLmxlbmd0aDsgaSArPSAzKSB7XG4gICAgY2hpbGQgPSBzdWJzY3JpYmVyc1tpXTtcbiAgICBjYWxsYmFjayA9IHN1YnNjcmliZXJzW2kgKyBzZXR0bGVkXTtcblxuICAgIGlmIChjaGlsZCkge1xuICAgICAgaW52b2tlQ2FsbGJhY2soc2V0dGxlZCwgY2hpbGQsIGNhbGxiYWNrLCBkZXRhaWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjYWxsYmFjayhkZXRhaWwpO1xuICAgIH1cbiAgfVxuXG4gIHByb21pc2UuX3N1YnNjcmliZXJzLmxlbmd0aCA9IDA7XG59XG5cbmZ1bmN0aW9uIHRyeUNhdGNoKGNhbGxiYWNrLCBkZXRhaWwpIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gY2FsbGJhY2soZGV0YWlsKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIFRSWV9DQVRDSF9FUlJPUi5lcnJvciA9IGU7XG4gICAgcmV0dXJuIFRSWV9DQVRDSF9FUlJPUjtcbiAgfVxufVxuXG5mdW5jdGlvbiBpbnZva2VDYWxsYmFjayhzZXR0bGVkLCBwcm9taXNlLCBjYWxsYmFjaywgZGV0YWlsKSB7XG4gIHZhciBoYXNDYWxsYmFjayA9IGlzRnVuY3Rpb24oY2FsbGJhY2spLFxuICAgICAgdmFsdWUgPSB2b2lkIDAsXG4gICAgICBlcnJvciA9IHZvaWQgMCxcbiAgICAgIHN1Y2NlZWRlZCA9IHZvaWQgMCxcbiAgICAgIGZhaWxlZCA9IHZvaWQgMDtcblxuICBpZiAoaGFzQ2FsbGJhY2spIHtcbiAgICB2YWx1ZSA9IHRyeUNhdGNoKGNhbGxiYWNrLCBkZXRhaWwpO1xuXG4gICAgaWYgKHZhbHVlID09PSBUUllfQ0FUQ0hfRVJST1IpIHtcbiAgICAgIGZhaWxlZCA9IHRydWU7XG4gICAgICBlcnJvciA9IHZhbHVlLmVycm9yO1xuICAgICAgdmFsdWUuZXJyb3IgPSBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdWNjZWVkZWQgPSB0cnVlO1xuICAgIH1cblxuICAgIGlmIChwcm9taXNlID09PSB2YWx1ZSkge1xuICAgICAgcmVqZWN0KHByb21pc2UsIGNhbm5vdFJldHVybk93bigpKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgdmFsdWUgPSBkZXRhaWw7XG4gICAgc3VjY2VlZGVkID0gdHJ1ZTtcbiAgfVxuXG4gIGlmIChwcm9taXNlLl9zdGF0ZSAhPT0gUEVORElORykge1xuICAgIC8vIG5vb3BcbiAgfSBlbHNlIGlmIChoYXNDYWxsYmFjayAmJiBzdWNjZWVkZWQpIHtcbiAgICByZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcbiAgfSBlbHNlIGlmIChmYWlsZWQpIHtcbiAgICByZWplY3QocHJvbWlzZSwgZXJyb3IpO1xuICB9IGVsc2UgaWYgKHNldHRsZWQgPT09IEZVTEZJTExFRCkge1xuICAgIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpO1xuICB9IGVsc2UgaWYgKHNldHRsZWQgPT09IFJFSkVDVEVEKSB7XG4gICAgcmVqZWN0KHByb21pc2UsIHZhbHVlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBpbml0aWFsaXplUHJvbWlzZShwcm9taXNlLCByZXNvbHZlcikge1xuICB0cnkge1xuICAgIHJlc29sdmVyKGZ1bmN0aW9uIHJlc29sdmVQcm9taXNlKHZhbHVlKSB7XG4gICAgICByZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcbiAgICB9LCBmdW5jdGlvbiByZWplY3RQcm9taXNlKHJlYXNvbikge1xuICAgICAgcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZWplY3QocHJvbWlzZSwgZSk7XG4gIH1cbn1cblxudmFyIGlkID0gMDtcbmZ1bmN0aW9uIG5leHRJZCgpIHtcbiAgcmV0dXJuIGlkKys7XG59XG5cbmZ1bmN0aW9uIG1ha2VQcm9taXNlKHByb21pc2UpIHtcbiAgcHJvbWlzZVtQUk9NSVNFX0lEXSA9IGlkKys7XG4gIHByb21pc2UuX3N0YXRlID0gdW5kZWZpbmVkO1xuICBwcm9taXNlLl9yZXN1bHQgPSB1bmRlZmluZWQ7XG4gIHByb21pc2UuX3N1YnNjcmliZXJzID0gW107XG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRpb25FcnJvcigpIHtcbiAgcmV0dXJuIG5ldyBFcnJvcignQXJyYXkgTWV0aG9kcyBtdXN0IGJlIHByb3ZpZGVkIGFuIEFycmF5Jyk7XG59XG5cbnZhciBFbnVtZXJhdG9yID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBFbnVtZXJhdG9yKENvbnN0cnVjdG9yLCBpbnB1dCkge1xuICAgIHRoaXMuX2luc3RhbmNlQ29uc3RydWN0b3IgPSBDb25zdHJ1Y3RvcjtcbiAgICB0aGlzLnByb21pc2UgPSBuZXcgQ29uc3RydWN0b3Iobm9vcCk7XG5cbiAgICBpZiAoIXRoaXMucHJvbWlzZVtQUk9NSVNFX0lEXSkge1xuICAgICAgbWFrZVByb21pc2UodGhpcy5wcm9taXNlKTtcbiAgICB9XG5cbiAgICBpZiAoaXNBcnJheShpbnB1dCkpIHtcbiAgICAgIHRoaXMubGVuZ3RoID0gaW5wdXQubGVuZ3RoO1xuICAgICAgdGhpcy5fcmVtYWluaW5nID0gaW5wdXQubGVuZ3RoO1xuXG4gICAgICB0aGlzLl9yZXN1bHQgPSBuZXcgQXJyYXkodGhpcy5sZW5ndGgpO1xuXG4gICAgICBpZiAodGhpcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgZnVsZmlsbCh0aGlzLnByb21pc2UsIHRoaXMuX3Jlc3VsdCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmxlbmd0aCA9IHRoaXMubGVuZ3RoIHx8IDA7XG4gICAgICAgIHRoaXMuX2VudW1lcmF0ZShpbnB1dCk7XG4gICAgICAgIGlmICh0aGlzLl9yZW1haW5pbmcgPT09IDApIHtcbiAgICAgICAgICBmdWxmaWxsKHRoaXMucHJvbWlzZSwgdGhpcy5fcmVzdWx0KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZWplY3QodGhpcy5wcm9taXNlLCB2YWxpZGF0aW9uRXJyb3IoKSk7XG4gICAgfVxuICB9XG5cbiAgRW51bWVyYXRvci5wcm90b3R5cGUuX2VudW1lcmF0ZSA9IGZ1bmN0aW9uIF9lbnVtZXJhdGUoaW5wdXQpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgdGhpcy5fc3RhdGUgPT09IFBFTkRJTkcgJiYgaSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLl9lYWNoRW50cnkoaW5wdXRbaV0sIGkpO1xuICAgIH1cbiAgfTtcblxuICBFbnVtZXJhdG9yLnByb3RvdHlwZS5fZWFjaEVudHJ5ID0gZnVuY3Rpb24gX2VhY2hFbnRyeShlbnRyeSwgaSkge1xuICAgIHZhciBjID0gdGhpcy5faW5zdGFuY2VDb25zdHJ1Y3RvcjtcbiAgICB2YXIgcmVzb2x2ZSQkMSA9IGMucmVzb2x2ZTtcblxuXG4gICAgaWYgKHJlc29sdmUkJDEgPT09IHJlc29sdmUkMSkge1xuICAgICAgdmFyIF90aGVuID0gZ2V0VGhlbihlbnRyeSk7XG5cbiAgICAgIGlmIChfdGhlbiA9PT0gdGhlbiAmJiBlbnRyeS5fc3RhdGUgIT09IFBFTkRJTkcpIHtcbiAgICAgICAgdGhpcy5fc2V0dGxlZEF0KGVudHJ5Ll9zdGF0ZSwgaSwgZW50cnkuX3Jlc3VsdCk7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBfdGhlbiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aGlzLl9yZW1haW5pbmctLTtcbiAgICAgICAgdGhpcy5fcmVzdWx0W2ldID0gZW50cnk7XG4gICAgICB9IGVsc2UgaWYgKGMgPT09IFByb21pc2UkMSkge1xuICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBjKG5vb3ApO1xuICAgICAgICBoYW5kbGVNYXliZVRoZW5hYmxlKHByb21pc2UsIGVudHJ5LCBfdGhlbik7XG4gICAgICAgIHRoaXMuX3dpbGxTZXR0bGVBdChwcm9taXNlLCBpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3dpbGxTZXR0bGVBdChuZXcgYyhmdW5jdGlvbiAocmVzb2x2ZSQkMSkge1xuICAgICAgICAgIHJldHVybiByZXNvbHZlJCQxKGVudHJ5KTtcbiAgICAgICAgfSksIGkpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl93aWxsU2V0dGxlQXQocmVzb2x2ZSQkMShlbnRyeSksIGkpO1xuICAgIH1cbiAgfTtcblxuICBFbnVtZXJhdG9yLnByb3RvdHlwZS5fc2V0dGxlZEF0ID0gZnVuY3Rpb24gX3NldHRsZWRBdChzdGF0ZSwgaSwgdmFsdWUpIHtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXMucHJvbWlzZTtcblxuXG4gICAgaWYgKHByb21pc2UuX3N0YXRlID09PSBQRU5ESU5HKSB7XG4gICAgICB0aGlzLl9yZW1haW5pbmctLTtcblxuICAgICAgaWYgKHN0YXRlID09PSBSRUpFQ1RFRCkge1xuICAgICAgICByZWplY3QocHJvbWlzZSwgdmFsdWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fcmVzdWx0W2ldID0gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX3JlbWFpbmluZyA9PT0gMCkge1xuICAgICAgZnVsZmlsbChwcm9taXNlLCB0aGlzLl9yZXN1bHQpO1xuICAgIH1cbiAgfTtcblxuICBFbnVtZXJhdG9yLnByb3RvdHlwZS5fd2lsbFNldHRsZUF0ID0gZnVuY3Rpb24gX3dpbGxTZXR0bGVBdChwcm9taXNlLCBpKSB7XG4gICAgdmFyIGVudW1lcmF0b3IgPSB0aGlzO1xuXG4gICAgc3Vic2NyaWJlKHByb21pc2UsIHVuZGVmaW5lZCwgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICByZXR1cm4gZW51bWVyYXRvci5fc2V0dGxlZEF0KEZVTEZJTExFRCwgaSwgdmFsdWUpO1xuICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgIHJldHVybiBlbnVtZXJhdG9yLl9zZXR0bGVkQXQoUkVKRUNURUQsIGksIHJlYXNvbik7XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIEVudW1lcmF0b3I7XG59KCk7XG5cbi8qKlxuICBgUHJvbWlzZS5hbGxgIGFjY2VwdHMgYW4gYXJyYXkgb2YgcHJvbWlzZXMsIGFuZCByZXR1cm5zIGEgbmV3IHByb21pc2Ugd2hpY2hcbiAgaXMgZnVsZmlsbGVkIHdpdGggYW4gYXJyYXkgb2YgZnVsZmlsbG1lbnQgdmFsdWVzIGZvciB0aGUgcGFzc2VkIHByb21pc2VzLCBvclxuICByZWplY3RlZCB3aXRoIHRoZSByZWFzb24gb2YgdGhlIGZpcnN0IHBhc3NlZCBwcm9taXNlIHRvIGJlIHJlamVjdGVkLiBJdCBjYXN0cyBhbGxcbiAgZWxlbWVudHMgb2YgdGhlIHBhc3NlZCBpdGVyYWJsZSB0byBwcm9taXNlcyBhcyBpdCBydW5zIHRoaXMgYWxnb3JpdGhtLlxuXG4gIEV4YW1wbGU6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZTEgPSByZXNvbHZlKDEpO1xuICBsZXQgcHJvbWlzZTIgPSByZXNvbHZlKDIpO1xuICBsZXQgcHJvbWlzZTMgPSByZXNvbHZlKDMpO1xuICBsZXQgcHJvbWlzZXMgPSBbIHByb21pc2UxLCBwcm9taXNlMiwgcHJvbWlzZTMgXTtcblxuICBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbihmdW5jdGlvbihhcnJheSl7XG4gICAgLy8gVGhlIGFycmF5IGhlcmUgd291bGQgYmUgWyAxLCAyLCAzIF07XG4gIH0pO1xuICBgYGBcblxuICBJZiBhbnkgb2YgdGhlIGBwcm9taXNlc2AgZ2l2ZW4gdG8gYGFsbGAgYXJlIHJlamVjdGVkLCB0aGUgZmlyc3QgcHJvbWlzZVxuICB0aGF0IGlzIHJlamVjdGVkIHdpbGwgYmUgZ2l2ZW4gYXMgYW4gYXJndW1lbnQgdG8gdGhlIHJldHVybmVkIHByb21pc2VzJ3NcbiAgcmVqZWN0aW9uIGhhbmRsZXIuIEZvciBleGFtcGxlOlxuXG4gIEV4YW1wbGU6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZTEgPSByZXNvbHZlKDEpO1xuICBsZXQgcHJvbWlzZTIgPSByZWplY3QobmV3IEVycm9yKFwiMlwiKSk7XG4gIGxldCBwcm9taXNlMyA9IHJlamVjdChuZXcgRXJyb3IoXCIzXCIpKTtcbiAgbGV0IHByb21pc2VzID0gWyBwcm9taXNlMSwgcHJvbWlzZTIsIHByb21pc2UzIF07XG5cbiAgUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24oYXJyYXkpe1xuICAgIC8vIENvZGUgaGVyZSBuZXZlciBydW5zIGJlY2F1c2UgdGhlcmUgYXJlIHJlamVjdGVkIHByb21pc2VzIVxuICB9LCBmdW5jdGlvbihlcnJvcikge1xuICAgIC8vIGVycm9yLm1lc3NhZ2UgPT09IFwiMlwiXG4gIH0pO1xuICBgYGBcblxuICBAbWV0aG9kIGFsbFxuICBAc3RhdGljXG4gIEBwYXJhbSB7QXJyYXl9IGVudHJpZXMgYXJyYXkgb2YgcHJvbWlzZXNcbiAgQHBhcmFtIHtTdHJpbmd9IGxhYmVsIG9wdGlvbmFsIHN0cmluZyBmb3IgbGFiZWxpbmcgdGhlIHByb21pc2UuXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQHJldHVybiB7UHJvbWlzZX0gcHJvbWlzZSB0aGF0IGlzIGZ1bGZpbGxlZCB3aGVuIGFsbCBgcHJvbWlzZXNgIGhhdmUgYmVlblxuICBmdWxmaWxsZWQsIG9yIHJlamVjdGVkIGlmIGFueSBvZiB0aGVtIGJlY29tZSByZWplY3RlZC5cbiAgQHN0YXRpY1xuKi9cbmZ1bmN0aW9uIGFsbChlbnRyaWVzKSB7XG4gIHJldHVybiBuZXcgRW51bWVyYXRvcih0aGlzLCBlbnRyaWVzKS5wcm9taXNlO1xufVxuXG4vKipcbiAgYFByb21pc2UucmFjZWAgcmV0dXJucyBhIG5ldyBwcm9taXNlIHdoaWNoIGlzIHNldHRsZWQgaW4gdGhlIHNhbWUgd2F5IGFzIHRoZVxuICBmaXJzdCBwYXNzZWQgcHJvbWlzZSB0byBzZXR0bGUuXG5cbiAgRXhhbXBsZTpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlMSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgcmVzb2x2ZSgncHJvbWlzZSAxJyk7XG4gICAgfSwgMjAwKTtcbiAgfSk7XG5cbiAgbGV0IHByb21pc2UyID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICByZXNvbHZlKCdwcm9taXNlIDInKTtcbiAgICB9LCAxMDApO1xuICB9KTtcblxuICBQcm9taXNlLnJhY2UoW3Byb21pc2UxLCBwcm9taXNlMl0pLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcbiAgICAvLyByZXN1bHQgPT09ICdwcm9taXNlIDInIGJlY2F1c2UgaXQgd2FzIHJlc29sdmVkIGJlZm9yZSBwcm9taXNlMVxuICAgIC8vIHdhcyByZXNvbHZlZC5cbiAgfSk7XG4gIGBgYFxuXG4gIGBQcm9taXNlLnJhY2VgIGlzIGRldGVybWluaXN0aWMgaW4gdGhhdCBvbmx5IHRoZSBzdGF0ZSBvZiB0aGUgZmlyc3RcbiAgc2V0dGxlZCBwcm9taXNlIG1hdHRlcnMuIEZvciBleGFtcGxlLCBldmVuIGlmIG90aGVyIHByb21pc2VzIGdpdmVuIHRvIHRoZVxuICBgcHJvbWlzZXNgIGFycmF5IGFyZ3VtZW50IGFyZSByZXNvbHZlZCwgYnV0IHRoZSBmaXJzdCBzZXR0bGVkIHByb21pc2UgaGFzXG4gIGJlY29tZSByZWplY3RlZCBiZWZvcmUgdGhlIG90aGVyIHByb21pc2VzIGJlY2FtZSBmdWxmaWxsZWQsIHRoZSByZXR1cm5lZFxuICBwcm9taXNlIHdpbGwgYmVjb21lIHJlamVjdGVkOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UxID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICByZXNvbHZlKCdwcm9taXNlIDEnKTtcbiAgICB9LCAyMDApO1xuICB9KTtcblxuICBsZXQgcHJvbWlzZTIgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIHJlamVjdChuZXcgRXJyb3IoJ3Byb21pc2UgMicpKTtcbiAgICB9LCAxMDApO1xuICB9KTtcblxuICBQcm9taXNlLnJhY2UoW3Byb21pc2UxLCBwcm9taXNlMl0pLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcbiAgICAvLyBDb2RlIGhlcmUgbmV2ZXIgcnVuc1xuICB9LCBmdW5jdGlvbihyZWFzb24pe1xuICAgIC8vIHJlYXNvbi5tZXNzYWdlID09PSAncHJvbWlzZSAyJyBiZWNhdXNlIHByb21pc2UgMiBiZWNhbWUgcmVqZWN0ZWQgYmVmb3JlXG4gICAgLy8gcHJvbWlzZSAxIGJlY2FtZSBmdWxmaWxsZWRcbiAgfSk7XG4gIGBgYFxuXG4gIEFuIGV4YW1wbGUgcmVhbC13b3JsZCB1c2UgY2FzZSBpcyBpbXBsZW1lbnRpbmcgdGltZW91dHM6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBQcm9taXNlLnJhY2UoW2FqYXgoJ2Zvby5qc29uJyksIHRpbWVvdXQoNTAwMCldKVxuICBgYGBcblxuICBAbWV0aG9kIHJhY2VcbiAgQHN0YXRpY1xuICBAcGFyYW0ge0FycmF5fSBwcm9taXNlcyBhcnJheSBvZiBwcm9taXNlcyB0byBvYnNlcnZlXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQHJldHVybiB7UHJvbWlzZX0gYSBwcm9taXNlIHdoaWNoIHNldHRsZXMgaW4gdGhlIHNhbWUgd2F5IGFzIHRoZSBmaXJzdCBwYXNzZWRcbiAgcHJvbWlzZSB0byBzZXR0bGUuXG4qL1xuZnVuY3Rpb24gcmFjZShlbnRyaWVzKSB7XG4gIC8qanNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gIHZhciBDb25zdHJ1Y3RvciA9IHRoaXM7XG5cbiAgaWYgKCFpc0FycmF5KGVudHJpZXMpKSB7XG4gICAgcmV0dXJuIG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbiAoXywgcmVqZWN0KSB7XG4gICAgICByZXR1cm4gcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ1lvdSBtdXN0IHBhc3MgYW4gYXJyYXkgdG8gcmFjZS4nKSk7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB2YXIgbGVuZ3RoID0gZW50cmllcy5sZW5ndGg7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgIENvbnN0cnVjdG9yLnJlc29sdmUoZW50cmllc1tpXSkudGhlbihyZXNvbHZlLCByZWplY3QpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbi8qKlxuICBgUHJvbWlzZS5yZWplY3RgIHJldHVybnMgYSBwcm9taXNlIHJlamVjdGVkIHdpdGggdGhlIHBhc3NlZCBgcmVhc29uYC5cbiAgSXQgaXMgc2hvcnRoYW5kIGZvciB0aGUgZm9sbG93aW5nOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgIHJlamVjdChuZXcgRXJyb3IoJ1dIT09QUycpKTtcbiAgfSk7XG5cbiAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAvLyBDb2RlIGhlcmUgZG9lc24ndCBydW4gYmVjYXVzZSB0aGUgcHJvbWlzZSBpcyByZWplY3RlZCFcbiAgfSwgZnVuY3Rpb24ocmVhc29uKXtcbiAgICAvLyByZWFzb24ubWVzc2FnZSA9PT0gJ1dIT09QUydcbiAgfSk7XG4gIGBgYFxuXG4gIEluc3RlYWQgb2Ygd3JpdGluZyB0aGUgYWJvdmUsIHlvdXIgY29kZSBub3cgc2ltcGx5IGJlY29tZXMgdGhlIGZvbGxvd2luZzpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlID0gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdXSE9PUFMnKSk7XG5cbiAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcbiAgICAvLyBDb2RlIGhlcmUgZG9lc24ndCBydW4gYmVjYXVzZSB0aGUgcHJvbWlzZSBpcyByZWplY3RlZCFcbiAgfSwgZnVuY3Rpb24ocmVhc29uKXtcbiAgICAvLyByZWFzb24ubWVzc2FnZSA9PT0gJ1dIT09QUydcbiAgfSk7XG4gIGBgYFxuXG4gIEBtZXRob2QgcmVqZWN0XG4gIEBzdGF0aWNcbiAgQHBhcmFtIHtBbnl9IHJlYXNvbiB2YWx1ZSB0aGF0IHRoZSByZXR1cm5lZCBwcm9taXNlIHdpbGwgYmUgcmVqZWN0ZWQgd2l0aC5cbiAgVXNlZnVsIGZvciB0b29saW5nLlxuICBAcmV0dXJuIHtQcm9taXNlfSBhIHByb21pc2UgcmVqZWN0ZWQgd2l0aCB0aGUgZ2l2ZW4gYHJlYXNvbmAuXG4qL1xuZnVuY3Rpb24gcmVqZWN0JDEocmVhc29uKSB7XG4gIC8qanNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gIHZhciBDb25zdHJ1Y3RvciA9IHRoaXM7XG4gIHZhciBwcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKG5vb3ApO1xuICByZWplY3QocHJvbWlzZSwgcmVhc29uKTtcbiAgcmV0dXJuIHByb21pc2U7XG59XG5cbmZ1bmN0aW9uIG5lZWRzUmVzb2x2ZXIoKSB7XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoJ1lvdSBtdXN0IHBhc3MgYSByZXNvbHZlciBmdW5jdGlvbiBhcyB0aGUgZmlyc3QgYXJndW1lbnQgdG8gdGhlIHByb21pc2UgY29uc3RydWN0b3InKTtcbn1cblxuZnVuY3Rpb24gbmVlZHNOZXcoKSB7XG4gIHRocm93IG5ldyBUeXBlRXJyb3IoXCJGYWlsZWQgdG8gY29uc3RydWN0ICdQcm9taXNlJzogUGxlYXNlIHVzZSB0aGUgJ25ldycgb3BlcmF0b3IsIHRoaXMgb2JqZWN0IGNvbnN0cnVjdG9yIGNhbm5vdCBiZSBjYWxsZWQgYXMgYSBmdW5jdGlvbi5cIik7XG59XG5cbi8qKlxuICBQcm9taXNlIG9iamVjdHMgcmVwcmVzZW50IHRoZSBldmVudHVhbCByZXN1bHQgb2YgYW4gYXN5bmNocm9ub3VzIG9wZXJhdGlvbi4gVGhlXG4gIHByaW1hcnkgd2F5IG9mIGludGVyYWN0aW5nIHdpdGggYSBwcm9taXNlIGlzIHRocm91Z2ggaXRzIGB0aGVuYCBtZXRob2QsIHdoaWNoXG4gIHJlZ2lzdGVycyBjYWxsYmFja3MgdG8gcmVjZWl2ZSBlaXRoZXIgYSBwcm9taXNlJ3MgZXZlbnR1YWwgdmFsdWUgb3IgdGhlIHJlYXNvblxuICB3aHkgdGhlIHByb21pc2UgY2Fubm90IGJlIGZ1bGZpbGxlZC5cblxuICBUZXJtaW5vbG9neVxuICAtLS0tLS0tLS0tLVxuXG4gIC0gYHByb21pc2VgIGlzIGFuIG9iamVjdCBvciBmdW5jdGlvbiB3aXRoIGEgYHRoZW5gIG1ldGhvZCB3aG9zZSBiZWhhdmlvciBjb25mb3JtcyB0byB0aGlzIHNwZWNpZmljYXRpb24uXG4gIC0gYHRoZW5hYmxlYCBpcyBhbiBvYmplY3Qgb3IgZnVuY3Rpb24gdGhhdCBkZWZpbmVzIGEgYHRoZW5gIG1ldGhvZC5cbiAgLSBgdmFsdWVgIGlzIGFueSBsZWdhbCBKYXZhU2NyaXB0IHZhbHVlIChpbmNsdWRpbmcgdW5kZWZpbmVkLCBhIHRoZW5hYmxlLCBvciBhIHByb21pc2UpLlxuICAtIGBleGNlcHRpb25gIGlzIGEgdmFsdWUgdGhhdCBpcyB0aHJvd24gdXNpbmcgdGhlIHRocm93IHN0YXRlbWVudC5cbiAgLSBgcmVhc29uYCBpcyBhIHZhbHVlIHRoYXQgaW5kaWNhdGVzIHdoeSBhIHByb21pc2Ugd2FzIHJlamVjdGVkLlxuICAtIGBzZXR0bGVkYCB0aGUgZmluYWwgcmVzdGluZyBzdGF0ZSBvZiBhIHByb21pc2UsIGZ1bGZpbGxlZCBvciByZWplY3RlZC5cblxuICBBIHByb21pc2UgY2FuIGJlIGluIG9uZSBvZiB0aHJlZSBzdGF0ZXM6IHBlbmRpbmcsIGZ1bGZpbGxlZCwgb3IgcmVqZWN0ZWQuXG5cbiAgUHJvbWlzZXMgdGhhdCBhcmUgZnVsZmlsbGVkIGhhdmUgYSBmdWxmaWxsbWVudCB2YWx1ZSBhbmQgYXJlIGluIHRoZSBmdWxmaWxsZWRcbiAgc3RhdGUuICBQcm9taXNlcyB0aGF0IGFyZSByZWplY3RlZCBoYXZlIGEgcmVqZWN0aW9uIHJlYXNvbiBhbmQgYXJlIGluIHRoZVxuICByZWplY3RlZCBzdGF0ZS4gIEEgZnVsZmlsbG1lbnQgdmFsdWUgaXMgbmV2ZXIgYSB0aGVuYWJsZS5cblxuICBQcm9taXNlcyBjYW4gYWxzbyBiZSBzYWlkIHRvICpyZXNvbHZlKiBhIHZhbHVlLiAgSWYgdGhpcyB2YWx1ZSBpcyBhbHNvIGFcbiAgcHJvbWlzZSwgdGhlbiB0aGUgb3JpZ2luYWwgcHJvbWlzZSdzIHNldHRsZWQgc3RhdGUgd2lsbCBtYXRjaCB0aGUgdmFsdWUnc1xuICBzZXR0bGVkIHN0YXRlLiAgU28gYSBwcm9taXNlIHRoYXQgKnJlc29sdmVzKiBhIHByb21pc2UgdGhhdCByZWplY3RzIHdpbGxcbiAgaXRzZWxmIHJlamVjdCwgYW5kIGEgcHJvbWlzZSB0aGF0ICpyZXNvbHZlcyogYSBwcm9taXNlIHRoYXQgZnVsZmlsbHMgd2lsbFxuICBpdHNlbGYgZnVsZmlsbC5cblxuXG4gIEJhc2ljIFVzYWdlOlxuICAtLS0tLS0tLS0tLS1cblxuICBgYGBqc1xuICBsZXQgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgIC8vIG9uIHN1Y2Nlc3NcbiAgICByZXNvbHZlKHZhbHVlKTtcblxuICAgIC8vIG9uIGZhaWx1cmVcbiAgICByZWplY3QocmVhc29uKTtcbiAgfSk7XG5cbiAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgLy8gb24gZnVsZmlsbG1lbnRcbiAgfSwgZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgLy8gb24gcmVqZWN0aW9uXG4gIH0pO1xuICBgYGBcblxuICBBZHZhbmNlZCBVc2FnZTpcbiAgLS0tLS0tLS0tLS0tLS0tXG5cbiAgUHJvbWlzZXMgc2hpbmUgd2hlbiBhYnN0cmFjdGluZyBhd2F5IGFzeW5jaHJvbm91cyBpbnRlcmFjdGlvbnMgc3VjaCBhc1xuICBgWE1MSHR0cFJlcXVlc3Rgcy5cblxuICBgYGBqc1xuICBmdW5jdGlvbiBnZXRKU09OKHVybCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgICAgbGV0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuXG4gICAgICB4aHIub3BlbignR0VUJywgdXJsKTtcbiAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBoYW5kbGVyO1xuICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdqc29uJztcbiAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKCdBY2NlcHQnLCAnYXBwbGljYXRpb24vanNvbicpO1xuICAgICAgeGhyLnNlbmQoKTtcblxuICAgICAgZnVuY3Rpb24gaGFuZGxlcigpIHtcbiAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gdGhpcy5ET05FKSB7XG4gICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAgIHJlc29sdmUodGhpcy5yZXNwb25zZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ2dldEpTT046IGAnICsgdXJsICsgJ2AgZmFpbGVkIHdpdGggc3RhdHVzOiBbJyArIHRoaXMuc3RhdHVzICsgJ10nKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0SlNPTignL3Bvc3RzLmpzb24nKS50aGVuKGZ1bmN0aW9uKGpzb24pIHtcbiAgICAvLyBvbiBmdWxmaWxsbWVudFxuICB9LCBmdW5jdGlvbihyZWFzb24pIHtcbiAgICAvLyBvbiByZWplY3Rpb25cbiAgfSk7XG4gIGBgYFxuXG4gIFVubGlrZSBjYWxsYmFja3MsIHByb21pc2VzIGFyZSBncmVhdCBjb21wb3NhYmxlIHByaW1pdGl2ZXMuXG5cbiAgYGBganNcbiAgUHJvbWlzZS5hbGwoW1xuICAgIGdldEpTT04oJy9wb3N0cycpLFxuICAgIGdldEpTT04oJy9jb21tZW50cycpXG4gIF0pLnRoZW4oZnVuY3Rpb24odmFsdWVzKXtcbiAgICB2YWx1ZXNbMF0gLy8gPT4gcG9zdHNKU09OXG4gICAgdmFsdWVzWzFdIC8vID0+IGNvbW1lbnRzSlNPTlxuXG4gICAgcmV0dXJuIHZhbHVlcztcbiAgfSk7XG4gIGBgYFxuXG4gIEBjbGFzcyBQcm9taXNlXG4gIEBwYXJhbSB7RnVuY3Rpb259IHJlc29sdmVyXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQGNvbnN0cnVjdG9yXG4qL1xuXG52YXIgUHJvbWlzZSQxID0gZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBQcm9taXNlKHJlc29sdmVyKSB7XG4gICAgdGhpc1tQUk9NSVNFX0lEXSA9IG5leHRJZCgpO1xuICAgIHRoaXMuX3Jlc3VsdCA9IHRoaXMuX3N0YXRlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuX3N1YnNjcmliZXJzID0gW107XG5cbiAgICBpZiAobm9vcCAhPT0gcmVzb2x2ZXIpIHtcbiAgICAgIHR5cGVvZiByZXNvbHZlciAhPT0gJ2Z1bmN0aW9uJyAmJiBuZWVkc1Jlc29sdmVyKCk7XG4gICAgICB0aGlzIGluc3RhbmNlb2YgUHJvbWlzZSA/IGluaXRpYWxpemVQcm9taXNlKHRoaXMsIHJlc29sdmVyKSA6IG5lZWRzTmV3KCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gIFRoZSBwcmltYXJ5IHdheSBvZiBpbnRlcmFjdGluZyB3aXRoIGEgcHJvbWlzZSBpcyB0aHJvdWdoIGl0cyBgdGhlbmAgbWV0aG9kLFxuICB3aGljaCByZWdpc3RlcnMgY2FsbGJhY2tzIHRvIHJlY2VpdmUgZWl0aGVyIGEgcHJvbWlzZSdzIGV2ZW50dWFsIHZhbHVlIG9yIHRoZVxuICByZWFzb24gd2h5IHRoZSBwcm9taXNlIGNhbm5vdCBiZSBmdWxmaWxsZWQuXG4gICBgYGBqc1xuICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24odXNlcil7XG4gICAgLy8gdXNlciBpcyBhdmFpbGFibGVcbiAgfSwgZnVuY3Rpb24ocmVhc29uKXtcbiAgICAvLyB1c2VyIGlzIHVuYXZhaWxhYmxlLCBhbmQgeW91IGFyZSBnaXZlbiB0aGUgcmVhc29uIHdoeVxuICB9KTtcbiAgYGBgXG4gICBDaGFpbmluZ1xuICAtLS0tLS0tLVxuICAgVGhlIHJldHVybiB2YWx1ZSBvZiBgdGhlbmAgaXMgaXRzZWxmIGEgcHJvbWlzZS4gIFRoaXMgc2Vjb25kLCAnZG93bnN0cmVhbSdcbiAgcHJvbWlzZSBpcyByZXNvbHZlZCB3aXRoIHRoZSByZXR1cm4gdmFsdWUgb2YgdGhlIGZpcnN0IHByb21pc2UncyBmdWxmaWxsbWVudFxuICBvciByZWplY3Rpb24gaGFuZGxlciwgb3IgcmVqZWN0ZWQgaWYgdGhlIGhhbmRsZXIgdGhyb3dzIGFuIGV4Y2VwdGlvbi5cbiAgIGBgYGpzXG4gIGZpbmRVc2VyKCkudGhlbihmdW5jdGlvbiAodXNlcikge1xuICAgIHJldHVybiB1c2VyLm5hbWU7XG4gIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICByZXR1cm4gJ2RlZmF1bHQgbmFtZSc7XG4gIH0pLnRoZW4oZnVuY3Rpb24gKHVzZXJOYW1lKSB7XG4gICAgLy8gSWYgYGZpbmRVc2VyYCBmdWxmaWxsZWQsIGB1c2VyTmFtZWAgd2lsbCBiZSB0aGUgdXNlcidzIG5hbWUsIG90aGVyd2lzZSBpdFxuICAgIC8vIHdpbGwgYmUgYCdkZWZhdWx0IG5hbWUnYFxuICB9KTtcbiAgIGZpbmRVc2VyKCkudGhlbihmdW5jdGlvbiAodXNlcikge1xuICAgIHRocm93IG5ldyBFcnJvcignRm91bmQgdXNlciwgYnV0IHN0aWxsIHVuaGFwcHknKTtcbiAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgIHRocm93IG5ldyBFcnJvcignYGZpbmRVc2VyYCByZWplY3RlZCBhbmQgd2UncmUgdW5oYXBweScpO1xuICB9KS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIC8vIG5ldmVyIHJlYWNoZWRcbiAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgIC8vIGlmIGBmaW5kVXNlcmAgZnVsZmlsbGVkLCBgcmVhc29uYCB3aWxsIGJlICdGb3VuZCB1c2VyLCBidXQgc3RpbGwgdW5oYXBweScuXG4gICAgLy8gSWYgYGZpbmRVc2VyYCByZWplY3RlZCwgYHJlYXNvbmAgd2lsbCBiZSAnYGZpbmRVc2VyYCByZWplY3RlZCBhbmQgd2UncmUgdW5oYXBweScuXG4gIH0pO1xuICBgYGBcbiAgSWYgdGhlIGRvd25zdHJlYW0gcHJvbWlzZSBkb2VzIG5vdCBzcGVjaWZ5IGEgcmVqZWN0aW9uIGhhbmRsZXIsIHJlamVjdGlvbiByZWFzb25zIHdpbGwgYmUgcHJvcGFnYXRlZCBmdXJ0aGVyIGRvd25zdHJlYW0uXG4gICBgYGBqc1xuICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICB0aHJvdyBuZXcgUGVkYWdvZ2ljYWxFeGNlcHRpb24oJ1Vwc3RyZWFtIGVycm9yJyk7XG4gIH0pLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgLy8gbmV2ZXIgcmVhY2hlZFxuICB9KS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIC8vIG5ldmVyIHJlYWNoZWRcbiAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuICAgIC8vIFRoZSBgUGVkZ2Fnb2NpYWxFeGNlcHRpb25gIGlzIHByb3BhZ2F0ZWQgYWxsIHRoZSB3YXkgZG93biB0byBoZXJlXG4gIH0pO1xuICBgYGBcbiAgIEFzc2ltaWxhdGlvblxuICAtLS0tLS0tLS0tLS1cbiAgIFNvbWV0aW1lcyB0aGUgdmFsdWUgeW91IHdhbnQgdG8gcHJvcGFnYXRlIHRvIGEgZG93bnN0cmVhbSBwcm9taXNlIGNhbiBvbmx5IGJlXG4gIHJldHJpZXZlZCBhc3luY2hyb25vdXNseS4gVGhpcyBjYW4gYmUgYWNoaWV2ZWQgYnkgcmV0dXJuaW5nIGEgcHJvbWlzZSBpbiB0aGVcbiAgZnVsZmlsbG1lbnQgb3IgcmVqZWN0aW9uIGhhbmRsZXIuIFRoZSBkb3duc3RyZWFtIHByb21pc2Ugd2lsbCB0aGVuIGJlIHBlbmRpbmdcbiAgdW50aWwgdGhlIHJldHVybmVkIHByb21pc2UgaXMgc2V0dGxlZC4gVGhpcyBpcyBjYWxsZWQgKmFzc2ltaWxhdGlvbiouXG4gICBgYGBqc1xuICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICByZXR1cm4gZmluZENvbW1lbnRzQnlBdXRob3IodXNlcik7XG4gIH0pLnRoZW4oZnVuY3Rpb24gKGNvbW1lbnRzKSB7XG4gICAgLy8gVGhlIHVzZXIncyBjb21tZW50cyBhcmUgbm93IGF2YWlsYWJsZVxuICB9KTtcbiAgYGBgXG4gICBJZiB0aGUgYXNzaW1saWF0ZWQgcHJvbWlzZSByZWplY3RzLCB0aGVuIHRoZSBkb3duc3RyZWFtIHByb21pc2Ugd2lsbCBhbHNvIHJlamVjdC5cbiAgIGBgYGpzXG4gIGZpbmRVc2VyKCkudGhlbihmdW5jdGlvbiAodXNlcikge1xuICAgIHJldHVybiBmaW5kQ29tbWVudHNCeUF1dGhvcih1c2VyKTtcbiAgfSkudGhlbihmdW5jdGlvbiAoY29tbWVudHMpIHtcbiAgICAvLyBJZiBgZmluZENvbW1lbnRzQnlBdXRob3JgIGZ1bGZpbGxzLCB3ZSdsbCBoYXZlIHRoZSB2YWx1ZSBoZXJlXG4gIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAvLyBJZiBgZmluZENvbW1lbnRzQnlBdXRob3JgIHJlamVjdHMsIHdlJ2xsIGhhdmUgdGhlIHJlYXNvbiBoZXJlXG4gIH0pO1xuICBgYGBcbiAgIFNpbXBsZSBFeGFtcGxlXG4gIC0tLS0tLS0tLS0tLS0tXG4gICBTeW5jaHJvbm91cyBFeGFtcGxlXG4gICBgYGBqYXZhc2NyaXB0XG4gIGxldCByZXN1bHQ7XG4gICB0cnkge1xuICAgIHJlc3VsdCA9IGZpbmRSZXN1bHQoKTtcbiAgICAvLyBzdWNjZXNzXG4gIH0gY2F0Y2gocmVhc29uKSB7XG4gICAgLy8gZmFpbHVyZVxuICB9XG4gIGBgYFxuICAgRXJyYmFjayBFeGFtcGxlXG4gICBgYGBqc1xuICBmaW5kUmVzdWx0KGZ1bmN0aW9uKHJlc3VsdCwgZXJyKXtcbiAgICBpZiAoZXJyKSB7XG4gICAgICAvLyBmYWlsdXJlXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIHN1Y2Nlc3NcbiAgICB9XG4gIH0pO1xuICBgYGBcbiAgIFByb21pc2UgRXhhbXBsZTtcbiAgIGBgYGphdmFzY3JpcHRcbiAgZmluZFJlc3VsdCgpLnRoZW4oZnVuY3Rpb24ocmVzdWx0KXtcbiAgICAvLyBzdWNjZXNzXG4gIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgLy8gZmFpbHVyZVxuICB9KTtcbiAgYGBgXG4gICBBZHZhbmNlZCBFeGFtcGxlXG4gIC0tLS0tLS0tLS0tLS0tXG4gICBTeW5jaHJvbm91cyBFeGFtcGxlXG4gICBgYGBqYXZhc2NyaXB0XG4gIGxldCBhdXRob3IsIGJvb2tzO1xuICAgdHJ5IHtcbiAgICBhdXRob3IgPSBmaW5kQXV0aG9yKCk7XG4gICAgYm9va3MgID0gZmluZEJvb2tzQnlBdXRob3IoYXV0aG9yKTtcbiAgICAvLyBzdWNjZXNzXG4gIH0gY2F0Y2gocmVhc29uKSB7XG4gICAgLy8gZmFpbHVyZVxuICB9XG4gIGBgYFxuICAgRXJyYmFjayBFeGFtcGxlXG4gICBgYGBqc1xuICAgZnVuY3Rpb24gZm91bmRCb29rcyhib29rcykge1xuICAgfVxuICAgZnVuY3Rpb24gZmFpbHVyZShyZWFzb24pIHtcbiAgIH1cbiAgIGZpbmRBdXRob3IoZnVuY3Rpb24oYXV0aG9yLCBlcnIpe1xuICAgIGlmIChlcnIpIHtcbiAgICAgIGZhaWx1cmUoZXJyKTtcbiAgICAgIC8vIGZhaWx1cmVcbiAgICB9IGVsc2Uge1xuICAgICAgdHJ5IHtcbiAgICAgICAgZmluZEJvb29rc0J5QXV0aG9yKGF1dGhvciwgZnVuY3Rpb24oYm9va3MsIGVycikge1xuICAgICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICAgIGZhaWx1cmUoZXJyKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgZm91bmRCb29rcyhib29rcyk7XG4gICAgICAgICAgICB9IGNhdGNoKHJlYXNvbikge1xuICAgICAgICAgICAgICBmYWlsdXJlKHJlYXNvbik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2goZXJyb3IpIHtcbiAgICAgICAgZmFpbHVyZShlcnIpO1xuICAgICAgfVxuICAgICAgLy8gc3VjY2Vzc1xuICAgIH1cbiAgfSk7XG4gIGBgYFxuICAgUHJvbWlzZSBFeGFtcGxlO1xuICAgYGBgamF2YXNjcmlwdFxuICBmaW5kQXV0aG9yKCkuXG4gICAgdGhlbihmaW5kQm9va3NCeUF1dGhvcikuXG4gICAgdGhlbihmdW5jdGlvbihib29rcyl7XG4gICAgICAvLyBmb3VuZCBib29rc1xuICB9KS5jYXRjaChmdW5jdGlvbihyZWFzb24pe1xuICAgIC8vIHNvbWV0aGluZyB3ZW50IHdyb25nXG4gIH0pO1xuICBgYGBcbiAgIEBtZXRob2QgdGhlblxuICBAcGFyYW0ge0Z1bmN0aW9ufSBvbkZ1bGZpbGxlZFxuICBAcGFyYW0ge0Z1bmN0aW9ufSBvblJlamVjdGVkXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQHJldHVybiB7UHJvbWlzZX1cbiAgKi9cblxuICAvKipcbiAgYGNhdGNoYCBpcyBzaW1wbHkgc3VnYXIgZm9yIGB0aGVuKHVuZGVmaW5lZCwgb25SZWplY3Rpb24pYCB3aGljaCBtYWtlcyBpdCB0aGUgc2FtZVxuICBhcyB0aGUgY2F0Y2ggYmxvY2sgb2YgYSB0cnkvY2F0Y2ggc3RhdGVtZW50LlxuICBgYGBqc1xuICBmdW5jdGlvbiBmaW5kQXV0aG9yKCl7XG4gIHRocm93IG5ldyBFcnJvcignY291bGRuJ3QgZmluZCB0aGF0IGF1dGhvcicpO1xuICB9XG4gIC8vIHN5bmNocm9ub3VzXG4gIHRyeSB7XG4gIGZpbmRBdXRob3IoKTtcbiAgfSBjYXRjaChyZWFzb24pIHtcbiAgLy8gc29tZXRoaW5nIHdlbnQgd3JvbmdcbiAgfVxuICAvLyBhc3luYyB3aXRoIHByb21pc2VzXG4gIGZpbmRBdXRob3IoKS5jYXRjaChmdW5jdGlvbihyZWFzb24pe1xuICAvLyBzb21ldGhpbmcgd2VudCB3cm9uZ1xuICB9KTtcbiAgYGBgXG4gIEBtZXRob2QgY2F0Y2hcbiAgQHBhcmFtIHtGdW5jdGlvbn0gb25SZWplY3Rpb25cbiAgVXNlZnVsIGZvciB0b29saW5nLlxuICBAcmV0dXJuIHtQcm9taXNlfVxuICAqL1xuXG5cbiAgUHJvbWlzZS5wcm90b3R5cGUuY2F0Y2ggPSBmdW5jdGlvbiBfY2F0Y2gob25SZWplY3Rpb24pIHtcbiAgICByZXR1cm4gdGhpcy50aGVuKG51bGwsIG9uUmVqZWN0aW9uKTtcbiAgfTtcblxuICAvKipcbiAgICBgZmluYWxseWAgd2lsbCBiZSBpbnZva2VkIHJlZ2FyZGxlc3Mgb2YgdGhlIHByb21pc2UncyBmYXRlIGp1c3QgYXMgbmF0aXZlXG4gICAgdHJ5L2NhdGNoL2ZpbmFsbHkgYmVoYXZlc1xuICBcbiAgICBTeW5jaHJvbm91cyBleGFtcGxlOlxuICBcbiAgICBgYGBqc1xuICAgIGZpbmRBdXRob3IoKSB7XG4gICAgICBpZiAoTWF0aC5yYW5kb20oKSA+IDAuNSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBuZXcgQXV0aG9yKCk7XG4gICAgfVxuICBcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGZpbmRBdXRob3IoKTsgLy8gc3VjY2VlZCBvciBmYWlsXG4gICAgfSBjYXRjaChlcnJvcikge1xuICAgICAgcmV0dXJuIGZpbmRPdGhlckF1dGhlcigpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICAvLyBhbHdheXMgcnVuc1xuICAgICAgLy8gZG9lc24ndCBhZmZlY3QgdGhlIHJldHVybiB2YWx1ZVxuICAgIH1cbiAgICBgYGBcbiAgXG4gICAgQXN5bmNocm9ub3VzIGV4YW1wbGU6XG4gIFxuICAgIGBgYGpzXG4gICAgZmluZEF1dGhvcigpLmNhdGNoKGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgICByZXR1cm4gZmluZE90aGVyQXV0aGVyKCk7XG4gICAgfSkuZmluYWxseShmdW5jdGlvbigpe1xuICAgICAgLy8gYXV0aG9yIHdhcyBlaXRoZXIgZm91bmQsIG9yIG5vdFxuICAgIH0pO1xuICAgIGBgYFxuICBcbiAgICBAbWV0aG9kIGZpbmFsbHlcbiAgICBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuICAgIEByZXR1cm4ge1Byb21pc2V9XG4gICovXG5cblxuICBQcm9taXNlLnByb3RvdHlwZS5maW5hbGx5ID0gZnVuY3Rpb24gX2ZpbmFsbHkoY2FsbGJhY2spIHtcbiAgICB2YXIgcHJvbWlzZSA9IHRoaXM7XG4gICAgdmFyIGNvbnN0cnVjdG9yID0gcHJvbWlzZS5jb25zdHJ1Y3RvcjtcblxuICAgIGlmIChpc0Z1bmN0aW9uKGNhbGxiYWNrKSkge1xuICAgICAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yLnJlc29sdmUoY2FsbGJhY2soKSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9KTtcbiAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yLnJlc29sdmUoY2FsbGJhY2soKSkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgdGhyb3cgcmVhc29uO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBwcm9taXNlLnRoZW4oY2FsbGJhY2ssIGNhbGxiYWNrKTtcbiAgfTtcblxuICByZXR1cm4gUHJvbWlzZTtcbn0oKTtcblxuUHJvbWlzZSQxLnByb3RvdHlwZS50aGVuID0gdGhlbjtcblByb21pc2UkMS5hbGwgPSBhbGw7XG5Qcm9taXNlJDEucmFjZSA9IHJhY2U7XG5Qcm9taXNlJDEucmVzb2x2ZSA9IHJlc29sdmUkMTtcblByb21pc2UkMS5yZWplY3QgPSByZWplY3QkMTtcblByb21pc2UkMS5fc2V0U2NoZWR1bGVyID0gc2V0U2NoZWR1bGVyO1xuUHJvbWlzZSQxLl9zZXRBc2FwID0gc2V0QXNhcDtcblByb21pc2UkMS5fYXNhcCA9IGFzYXA7XG5cbi8qZ2xvYmFsIHNlbGYqL1xuZnVuY3Rpb24gcG9seWZpbGwoKSB7XG4gIHZhciBsb2NhbCA9IHZvaWQgMDtcblxuICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBsb2NhbCA9IGdsb2JhbDtcbiAgfSBlbHNlIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBsb2NhbCA9IHNlbGY7XG4gIH0gZWxzZSB7XG4gICAgdHJ5IHtcbiAgICAgIGxvY2FsID0gRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ3BvbHlmaWxsIGZhaWxlZCBiZWNhdXNlIGdsb2JhbCBvYmplY3QgaXMgdW5hdmFpbGFibGUgaW4gdGhpcyBlbnZpcm9ubWVudCcpO1xuICAgIH1cbiAgfVxuXG4gIHZhciBQID0gbG9jYWwuUHJvbWlzZTtcblxuICBpZiAoUCkge1xuICAgIHZhciBwcm9taXNlVG9TdHJpbmcgPSBudWxsO1xuICAgIHRyeSB7XG4gICAgICBwcm9taXNlVG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoUC5yZXNvbHZlKCkpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIC8vIHNpbGVudGx5IGlnbm9yZWRcbiAgICB9XG5cbiAgICBpZiAocHJvbWlzZVRvU3RyaW5nID09PSAnW29iamVjdCBQcm9taXNlXScgJiYgIVAuY2FzdCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgfVxuXG4gIGxvY2FsLlByb21pc2UgPSBQcm9taXNlJDE7XG59XG5cbi8vIFN0cmFuZ2UgY29tcGF0Li5cblByb21pc2UkMS5wb2x5ZmlsbCA9IHBvbHlmaWxsO1xuUHJvbWlzZSQxLlByb21pc2UgPSBQcm9taXNlJDE7XG5cbnJldHVybiBQcm9taXNlJDE7XG5cbn0pKSk7XG5cblxuXG5cblxufSkuY2FsbCh0aGlzLF9kZXJlcV8oJ19wcm9jZXNzJyksdHlwZW9mIGdsb2JhbCAhPT0gXCJ1bmRlZmluZWRcIiA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSBcInVuZGVmaW5lZFwiID8gc2VsZiA6IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cgOiB7fSlcblxufSx7XCJfcHJvY2Vzc1wiOjN9XSwyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbi8vIENvcHlyaWdodCBKb3llbnQsIEluYy4gYW5kIG90aGVyIE5vZGUgY29udHJpYnV0b3JzLlxuLy9cbi8vIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhXG4vLyBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlXG4vLyBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmdcbi8vIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCxcbi8vIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0byBwZXJtaXRcbi8vIHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZVxuLy8gZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWRcbi8vIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1Ncbi8vIE9SIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0Zcbi8vIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU5cbi8vIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SXG4vLyBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFXG4vLyBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG5mdW5jdGlvbiBFdmVudEVtaXR0ZXIoKSB7XG4gIHRoaXMuX2V2ZW50cyA9IHRoaXMuX2V2ZW50cyB8fCB7fTtcbiAgdGhpcy5fbWF4TGlzdGVuZXJzID0gdGhpcy5fbWF4TGlzdGVuZXJzIHx8IHVuZGVmaW5lZDtcbn1cbm1vZHVsZS5leHBvcnRzID0gRXZlbnRFbWl0dGVyO1xuXG4vLyBCYWNrd2FyZHMtY29tcGF0IHdpdGggbm9kZSAwLjEwLnhcbkV2ZW50RW1pdHRlci5FdmVudEVtaXR0ZXIgPSBFdmVudEVtaXR0ZXI7XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX2V2ZW50cyA9IHVuZGVmaW5lZDtcbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuX21heExpc3RlbmVycyA9IHVuZGVmaW5lZDtcblxuLy8gQnkgZGVmYXVsdCBFdmVudEVtaXR0ZXJzIHdpbGwgcHJpbnQgYSB3YXJuaW5nIGlmIG1vcmUgdGhhbiAxMCBsaXN0ZW5lcnMgYXJlXG4vLyBhZGRlZCB0byBpdC4gVGhpcyBpcyBhIHVzZWZ1bCBkZWZhdWx0IHdoaWNoIGhlbHBzIGZpbmRpbmcgbWVtb3J5IGxlYWtzLlxuRXZlbnRFbWl0dGVyLmRlZmF1bHRNYXhMaXN0ZW5lcnMgPSAxMDtcblxuLy8gT2J2aW91c2x5IG5vdCBhbGwgRW1pdHRlcnMgc2hvdWxkIGJlIGxpbWl0ZWQgdG8gMTAuIFRoaXMgZnVuY3Rpb24gYWxsb3dzXG4vLyB0aGF0IHRvIGJlIGluY3JlYXNlZC4gU2V0IHRvIHplcm8gZm9yIHVubGltaXRlZC5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuc2V0TWF4TGlzdGVuZXJzID0gZnVuY3Rpb24obikge1xuICBpZiAoIWlzTnVtYmVyKG4pIHx8IG4gPCAwIHx8IGlzTmFOKG4pKVxuICAgIHRocm93IFR5cGVFcnJvcignbiBtdXN0IGJlIGEgcG9zaXRpdmUgbnVtYmVyJyk7XG4gIHRoaXMuX21heExpc3RlbmVycyA9IG47XG4gIHJldHVybiB0aGlzO1xufTtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5lbWl0ID0gZnVuY3Rpb24odHlwZSkge1xuICB2YXIgZXIsIGhhbmRsZXIsIGxlbiwgYXJncywgaSwgbGlzdGVuZXJzO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzKVxuICAgIHRoaXMuX2V2ZW50cyA9IHt9O1xuXG4gIC8vIElmIHRoZXJlIGlzIG5vICdlcnJvcicgZXZlbnQgbGlzdGVuZXIgdGhlbiB0aHJvdy5cbiAgaWYgKHR5cGUgPT09ICdlcnJvcicpIHtcbiAgICBpZiAoIXRoaXMuX2V2ZW50cy5lcnJvciB8fFxuICAgICAgICAoaXNPYmplY3QodGhpcy5fZXZlbnRzLmVycm9yKSAmJiAhdGhpcy5fZXZlbnRzLmVycm9yLmxlbmd0aCkpIHtcbiAgICAgIGVyID0gYXJndW1lbnRzWzFdO1xuICAgICAgaWYgKGVyIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgdGhyb3cgZXI7IC8vIFVuaGFuZGxlZCAnZXJyb3InIGV2ZW50XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBBdCBsZWFzdCBnaXZlIHNvbWUga2luZCBvZiBjb250ZXh0IHRvIHRoZSB1c2VyXG4gICAgICAgIHZhciBlcnIgPSBuZXcgRXJyb3IoJ1VuY2F1Z2h0LCB1bnNwZWNpZmllZCBcImVycm9yXCIgZXZlbnQuICgnICsgZXIgKyAnKScpO1xuICAgICAgICBlcnIuY29udGV4dCA9IGVyO1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlciA9IHRoaXMuX2V2ZW50c1t0eXBlXTtcblxuICBpZiAoaXNVbmRlZmluZWQoaGFuZGxlcikpXG4gICAgcmV0dXJuIGZhbHNlO1xuXG4gIGlmIChpc0Z1bmN0aW9uKGhhbmRsZXIpKSB7XG4gICAgc3dpdGNoIChhcmd1bWVudHMubGVuZ3RoKSB7XG4gICAgICAvLyBmYXN0IGNhc2VzXG4gICAgICBjYXNlIDE6XG4gICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDI6XG4gICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzLCBhcmd1bWVudHNbMV0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMzpcbiAgICAgICAgaGFuZGxlci5jYWxsKHRoaXMsIGFyZ3VtZW50c1sxXSwgYXJndW1lbnRzWzJdKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICAvLyBzbG93ZXJcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuICAgICAgICBoYW5kbGVyLmFwcGx5KHRoaXMsIGFyZ3MpO1xuICAgIH1cbiAgfSBlbHNlIGlmIChpc09iamVjdChoYW5kbGVyKSkge1xuICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuICAgIGxpc3RlbmVycyA9IGhhbmRsZXIuc2xpY2UoKTtcbiAgICBsZW4gPSBsaXN0ZW5lcnMubGVuZ3RoO1xuICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKylcbiAgICAgIGxpc3RlbmVyc1tpXS5hcHBseSh0aGlzLCBhcmdzKTtcbiAgfVxuXG4gIHJldHVybiB0cnVlO1xufTtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5hZGRMaXN0ZW5lciA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7XG4gIHZhciBtO1xuXG4gIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpXG4gICAgdGhyb3cgVHlwZUVycm9yKCdsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcblxuICBpZiAoIXRoaXMuX2V2ZW50cylcbiAgICB0aGlzLl9ldmVudHMgPSB7fTtcblxuICAvLyBUbyBhdm9pZCByZWN1cnNpb24gaW4gdGhlIGNhc2UgdGhhdCB0eXBlID09PSBcIm5ld0xpc3RlbmVyXCIhIEJlZm9yZVxuICAvLyBhZGRpbmcgaXQgdG8gdGhlIGxpc3RlbmVycywgZmlyc3QgZW1pdCBcIm5ld0xpc3RlbmVyXCIuXG4gIGlmICh0aGlzLl9ldmVudHMubmV3TGlzdGVuZXIpXG4gICAgdGhpcy5lbWl0KCduZXdMaXN0ZW5lcicsIHR5cGUsXG4gICAgICAgICAgICAgIGlzRnVuY3Rpb24obGlzdGVuZXIubGlzdGVuZXIpID9cbiAgICAgICAgICAgICAgbGlzdGVuZXIubGlzdGVuZXIgOiBsaXN0ZW5lcik7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHNbdHlwZV0pXG4gICAgLy8gT3B0aW1pemUgdGhlIGNhc2Ugb2Ygb25lIGxpc3RlbmVyLiBEb24ndCBuZWVkIHRoZSBleHRyYSBhcnJheSBvYmplY3QuXG4gICAgdGhpcy5fZXZlbnRzW3R5cGVdID0gbGlzdGVuZXI7XG4gIGVsc2UgaWYgKGlzT2JqZWN0KHRoaXMuX2V2ZW50c1t0eXBlXSkpXG4gICAgLy8gSWYgd2UndmUgYWxyZWFkeSBnb3QgYW4gYXJyYXksIGp1c3QgYXBwZW5kLlxuICAgIHRoaXMuX2V2ZW50c1t0eXBlXS5wdXNoKGxpc3RlbmVyKTtcbiAgZWxzZVxuICAgIC8vIEFkZGluZyB0aGUgc2Vjb25kIGVsZW1lbnQsIG5lZWQgdG8gY2hhbmdlIHRvIGFycmF5LlxuICAgIHRoaXMuX2V2ZW50c1t0eXBlXSA9IFt0aGlzLl9ldmVudHNbdHlwZV0sIGxpc3RlbmVyXTtcblxuICAvLyBDaGVjayBmb3IgbGlzdGVuZXIgbGVha1xuICBpZiAoaXNPYmplY3QodGhpcy5fZXZlbnRzW3R5cGVdKSAmJiAhdGhpcy5fZXZlbnRzW3R5cGVdLndhcm5lZCkge1xuICAgIGlmICghaXNVbmRlZmluZWQodGhpcy5fbWF4TGlzdGVuZXJzKSkge1xuICAgICAgbSA9IHRoaXMuX21heExpc3RlbmVycztcbiAgICB9IGVsc2Uge1xuICAgICAgbSA9IEV2ZW50RW1pdHRlci5kZWZhdWx0TWF4TGlzdGVuZXJzO1xuICAgIH1cblxuICAgIGlmIChtICYmIG0gPiAwICYmIHRoaXMuX2V2ZW50c1t0eXBlXS5sZW5ndGggPiBtKSB7XG4gICAgICB0aGlzLl9ldmVudHNbdHlwZV0ud2FybmVkID0gdHJ1ZTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJyhub2RlKSB3YXJuaW5nOiBwb3NzaWJsZSBFdmVudEVtaXR0ZXIgbWVtb3J5ICcgK1xuICAgICAgICAgICAgICAgICAgICAnbGVhayBkZXRlY3RlZC4gJWQgbGlzdGVuZXJzIGFkZGVkLiAnICtcbiAgICAgICAgICAgICAgICAgICAgJ1VzZSBlbWl0dGVyLnNldE1heExpc3RlbmVycygpIHRvIGluY3JlYXNlIGxpbWl0LicsXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2V2ZW50c1t0eXBlXS5sZW5ndGgpO1xuICAgICAgaWYgKHR5cGVvZiBjb25zb2xlLnRyYWNlID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIC8vIG5vdCBzdXBwb3J0ZWQgaW4gSUUgMTBcbiAgICAgICAgY29uc29sZS50cmFjZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB0aGlzO1xufTtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5vbiA9IEV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXI7XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUub25jZSA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7XG4gIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpXG4gICAgdGhyb3cgVHlwZUVycm9yKCdsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcblxuICB2YXIgZmlyZWQgPSBmYWxzZTtcblxuICBmdW5jdGlvbiBnKCkge1xuICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgZyk7XG5cbiAgICBpZiAoIWZpcmVkKSB7XG4gICAgICBmaXJlZCA9IHRydWU7XG4gICAgICBsaXN0ZW5lci5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH1cbiAgfVxuXG4gIGcubGlzdGVuZXIgPSBsaXN0ZW5lcjtcbiAgdGhpcy5vbih0eXBlLCBnKTtcblxuICByZXR1cm4gdGhpcztcbn07XG5cbi8vIGVtaXRzIGEgJ3JlbW92ZUxpc3RlbmVyJyBldmVudCBpZmYgdGhlIGxpc3RlbmVyIHdhcyByZW1vdmVkXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnJlbW92ZUxpc3RlbmVyID0gZnVuY3Rpb24odHlwZSwgbGlzdGVuZXIpIHtcbiAgdmFyIGxpc3QsIHBvc2l0aW9uLCBsZW5ndGgsIGk7XG5cbiAgaWYgKCFpc0Z1bmN0aW9uKGxpc3RlbmVyKSlcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ2xpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvbicpO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzIHx8ICF0aGlzLl9ldmVudHNbdHlwZV0pXG4gICAgcmV0dXJuIHRoaXM7XG5cbiAgbGlzdCA9IHRoaXMuX2V2ZW50c1t0eXBlXTtcbiAgbGVuZ3RoID0gbGlzdC5sZW5ndGg7XG4gIHBvc2l0aW9uID0gLTE7XG5cbiAgaWYgKGxpc3QgPT09IGxpc3RlbmVyIHx8XG4gICAgICAoaXNGdW5jdGlvbihsaXN0Lmxpc3RlbmVyKSAmJiBsaXN0Lmxpc3RlbmVyID09PSBsaXN0ZW5lcikpIHtcbiAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdO1xuICAgIGlmICh0aGlzLl9ldmVudHMucmVtb3ZlTGlzdGVuZXIpXG4gICAgICB0aGlzLmVtaXQoJ3JlbW92ZUxpc3RlbmVyJywgdHlwZSwgbGlzdGVuZXIpO1xuXG4gIH0gZWxzZSBpZiAoaXNPYmplY3QobGlzdCkpIHtcbiAgICBmb3IgKGkgPSBsZW5ndGg7IGktLSA+IDA7KSB7XG4gICAgICBpZiAobGlzdFtpXSA9PT0gbGlzdGVuZXIgfHxcbiAgICAgICAgICAobGlzdFtpXS5saXN0ZW5lciAmJiBsaXN0W2ldLmxpc3RlbmVyID09PSBsaXN0ZW5lcikpIHtcbiAgICAgICAgcG9zaXRpb24gPSBpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocG9zaXRpb24gPCAwKVxuICAgICAgcmV0dXJuIHRoaXM7XG5cbiAgICBpZiAobGlzdC5sZW5ndGggPT09IDEpIHtcbiAgICAgIGxpc3QubGVuZ3RoID0gMDtcbiAgICAgIGRlbGV0ZSB0aGlzLl9ldmVudHNbdHlwZV07XG4gICAgfSBlbHNlIHtcbiAgICAgIGxpc3Quc3BsaWNlKHBvc2l0aW9uLCAxKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5fZXZlbnRzLnJlbW92ZUxpc3RlbmVyKVxuICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyKTtcbiAgfVxuXG4gIHJldHVybiB0aGlzO1xufTtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBmdW5jdGlvbih0eXBlKSB7XG4gIHZhciBrZXksIGxpc3RlbmVycztcblxuICBpZiAoIXRoaXMuX2V2ZW50cylcbiAgICByZXR1cm4gdGhpcztcblxuICAvLyBub3QgbGlzdGVuaW5nIGZvciByZW1vdmVMaXN0ZW5lciwgbm8gbmVlZCB0byBlbWl0XG4gIGlmICghdGhpcy5fZXZlbnRzLnJlbW92ZUxpc3RlbmVyKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApXG4gICAgICB0aGlzLl9ldmVudHMgPSB7fTtcbiAgICBlbHNlIGlmICh0aGlzLl9ldmVudHNbdHlwZV0pXG4gICAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLy8gZW1pdCByZW1vdmVMaXN0ZW5lciBmb3IgYWxsIGxpc3RlbmVycyBvbiBhbGwgZXZlbnRzXG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKSB7XG4gICAgZm9yIChrZXkgaW4gdGhpcy5fZXZlbnRzKSB7XG4gICAgICBpZiAoa2V5ID09PSAncmVtb3ZlTGlzdGVuZXInKSBjb250aW51ZTtcbiAgICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKGtleSk7XG4gICAgfVxuICAgIHRoaXMucmVtb3ZlQWxsTGlzdGVuZXJzKCdyZW1vdmVMaXN0ZW5lcicpO1xuICAgIHRoaXMuX2V2ZW50cyA9IHt9O1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgbGlzdGVuZXJzID0gdGhpcy5fZXZlbnRzW3R5cGVdO1xuXG4gIGlmIChpc0Z1bmN0aW9uKGxpc3RlbmVycykpIHtcbiAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGxpc3RlbmVycyk7XG4gIH0gZWxzZSBpZiAobGlzdGVuZXJzKSB7XG4gICAgLy8gTElGTyBvcmRlclxuICAgIHdoaWxlIChsaXN0ZW5lcnMubGVuZ3RoKVxuICAgICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnNbbGlzdGVuZXJzLmxlbmd0aCAtIDFdKTtcbiAgfVxuICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdO1xuXG4gIHJldHVybiB0aGlzO1xufTtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lcnMgPSBmdW5jdGlvbih0eXBlKSB7XG4gIHZhciByZXQ7XG4gIGlmICghdGhpcy5fZXZlbnRzIHx8ICF0aGlzLl9ldmVudHNbdHlwZV0pXG4gICAgcmV0ID0gW107XG4gIGVsc2UgaWYgKGlzRnVuY3Rpb24odGhpcy5fZXZlbnRzW3R5cGVdKSlcbiAgICByZXQgPSBbdGhpcy5fZXZlbnRzW3R5cGVdXTtcbiAgZWxzZVxuICAgIHJldCA9IHRoaXMuX2V2ZW50c1t0eXBlXS5zbGljZSgpO1xuICByZXR1cm4gcmV0O1xufTtcblxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5saXN0ZW5lckNvdW50ID0gZnVuY3Rpb24odHlwZSkge1xuICBpZiAodGhpcy5fZXZlbnRzKSB7XG4gICAgdmFyIGV2bGlzdGVuZXIgPSB0aGlzLl9ldmVudHNbdHlwZV07XG5cbiAgICBpZiAoaXNGdW5jdGlvbihldmxpc3RlbmVyKSlcbiAgICAgIHJldHVybiAxO1xuICAgIGVsc2UgaWYgKGV2bGlzdGVuZXIpXG4gICAgICByZXR1cm4gZXZsaXN0ZW5lci5sZW5ndGg7XG4gIH1cbiAgcmV0dXJuIDA7XG59O1xuXG5FdmVudEVtaXR0ZXIubGlzdGVuZXJDb3VudCA9IGZ1bmN0aW9uKGVtaXR0ZXIsIHR5cGUpIHtcbiAgcmV0dXJuIGVtaXR0ZXIubGlzdGVuZXJDb3VudCh0eXBlKTtcbn07XG5cbmZ1bmN0aW9uIGlzRnVuY3Rpb24oYXJnKSB7XG4gIHJldHVybiB0eXBlb2YgYXJnID09PSAnZnVuY3Rpb24nO1xufVxuXG5mdW5jdGlvbiBpc051bWJlcihhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdudW1iZXInO1xufVxuXG5mdW5jdGlvbiBpc09iamVjdChhcmcpIHtcbiAgcmV0dXJuIHR5cGVvZiBhcmcgPT09ICdvYmplY3QnICYmIGFyZyAhPT0gbnVsbDtcbn1cblxuZnVuY3Rpb24gaXNVbmRlZmluZWQoYXJnKSB7XG4gIHJldHVybiBhcmcgPT09IHZvaWQgMDtcbn1cblxufSx7fV0sMzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4vLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuLy8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0XG4vLyBkb24ndCBicmVhayB0aGluZ3MuICBCdXQgd2UgbmVlZCB0byB3cmFwIGl0IGluIGEgdHJ5IGNhdGNoIGluIGNhc2UgaXQgaXNcbi8vIHdyYXBwZWQgaW4gc3RyaWN0IG1vZGUgY29kZSB3aGljaCBkb2Vzbid0IGRlZmluZSBhbnkgZ2xvYmFscy4gIEl0J3MgaW5zaWRlIGFcbi8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuXG5cbnZhciBjYWNoZWRTZXRUaW1lb3V0O1xudmFyIGNhY2hlZENsZWFyVGltZW91dDtcblxuZnVuY3Rpb24gZGVmYXVsdFNldFRpbW91dCgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbmZ1bmN0aW9uIGRlZmF1bHRDbGVhclRpbWVvdXQgKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG4oZnVuY3Rpb24gKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2V0VGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2xlYXJUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgIH1cbn0gKCkpXG5mdW5jdGlvbiBydW5UaW1lb3V0KGZ1bikge1xuICAgIGlmIChjYWNoZWRTZXRUaW1lb3V0ID09PSBzZXRUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICAvLyBpZiBzZXRUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkU2V0VGltZW91dCA9PT0gZGVmYXVsdFNldFRpbW91dCB8fCAhY2FjaGVkU2V0VGltZW91dCkgJiYgc2V0VGltZW91dCkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dChmdW4sIDApO1xuICAgIH0gY2F0Y2goZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwobnVsbCwgZnVuLCAwKTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKHRoaXMsIGZ1biwgMCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxufVxuZnVuY3Rpb24gcnVuQ2xlYXJUaW1lb3V0KG1hcmtlcikge1xuICAgIGlmIChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGNsZWFyVGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICAvLyBpZiBjbGVhclRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGRlZmF1bHRDbGVhclRpbWVvdXQgfHwgIWNhY2hlZENsZWFyVGltZW91dCkgJiYgY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCAgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbChudWxsLCBtYXJrZXIpO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yLlxuICAgICAgICAgICAgLy8gU29tZSB2ZXJzaW9ucyBvZiBJLkUuIGhhdmUgZGlmZmVyZW50IHJ1bGVzIGZvciBjbGVhclRpbWVvdXQgdnMgc2V0VGltZW91dFxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKHRoaXMsIG1hcmtlcik7XG4gICAgICAgIH1cbiAgICB9XG5cblxuXG59XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBpZiAoIWRyYWluaW5nIHx8ICFjdXJyZW50UXVldWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBydW5UaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBydW5DbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBydW5UaW1lb3V0KGRyYWluUXVldWUpO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBub29wO1xuXG5wcm9jZXNzLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChuYW1lKSB7IHJldHVybiBbXSB9XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuXG59LHt9XSw0OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbnZhciBidW5kbGVGbiA9IGFyZ3VtZW50c1szXTtcbnZhciBzb3VyY2VzID0gYXJndW1lbnRzWzRdO1xudmFyIGNhY2hlID0gYXJndW1lbnRzWzVdO1xuXG52YXIgc3RyaW5naWZ5ID0gSlNPTi5zdHJpbmdpZnk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGZuLCBvcHRpb25zKSB7XG4gICAgdmFyIHdrZXk7XG4gICAgdmFyIGNhY2hlS2V5cyA9IE9iamVjdC5rZXlzKGNhY2hlKTtcblxuICAgIGZvciAodmFyIGkgPSAwLCBsID0gY2FjaGVLZXlzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgICB2YXIga2V5ID0gY2FjaGVLZXlzW2ldO1xuICAgICAgICB2YXIgZXhwID0gY2FjaGVba2V5XS5leHBvcnRzO1xuICAgICAgICAvLyBVc2luZyBiYWJlbCBhcyBhIHRyYW5zcGlsZXIgdG8gdXNlIGVzbW9kdWxlLCB0aGUgZXhwb3J0IHdpbGwgYWx3YXlzXG4gICAgICAgIC8vIGJlIGFuIG9iamVjdCB3aXRoIHRoZSBkZWZhdWx0IGV4cG9ydCBhcyBhIHByb3BlcnR5IG9mIGl0LiBUbyBlbnN1cmVcbiAgICAgICAgLy8gdGhlIGV4aXN0aW5nIGFwaSBhbmQgYmFiZWwgZXNtb2R1bGUgZXhwb3J0cyBhcmUgYm90aCBzdXBwb3J0ZWQgd2VcbiAgICAgICAgLy8gY2hlY2sgZm9yIGJvdGhcbiAgICAgICAgaWYgKGV4cCA9PT0gZm4gfHwgZXhwICYmIGV4cC5kZWZhdWx0ID09PSBmbikge1xuICAgICAgICAgICAgd2tleSA9IGtleTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCF3a2V5KSB7XG4gICAgICAgIHdrZXkgPSBNYXRoLmZsb29yKE1hdGgucG93KDE2LCA4KSAqIE1hdGgucmFuZG9tKCkpLnRvU3RyaW5nKDE2KTtcbiAgICAgICAgdmFyIHdjYWNoZSA9IHt9O1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGNhY2hlS2V5cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSBjYWNoZUtleXNbaV07XG4gICAgICAgICAgICB3Y2FjaGVba2V5XSA9IGtleTtcbiAgICAgICAgfVxuICAgICAgICBzb3VyY2VzW3drZXldID0gW1xuICAgICAgICAgICAgJ2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpeycgKyBmbiArICcoc2VsZik7IH0nLFxuICAgICAgICAgICAgd2NhY2hlXG4gICAgICAgIF07XG4gICAgfVxuICAgIHZhciBza2V5ID0gTWF0aC5mbG9vcihNYXRoLnBvdygxNiwgOCkgKiBNYXRoLnJhbmRvbSgpKS50b1N0cmluZygxNik7XG5cbiAgICB2YXIgc2NhY2hlID0ge307IHNjYWNoZVt3a2V5XSA9IHdrZXk7XG4gICAgc291cmNlc1tza2V5XSA9IFtcbiAgICAgICAgJ2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpeycgK1xuICAgICAgICAgICAgLy8gdHJ5IHRvIGNhbGwgZGVmYXVsdCBpZiBkZWZpbmVkIHRvIGFsc28gc3VwcG9ydCBiYWJlbCBlc21vZHVsZSBleHBvcnRzXG4gICAgICAgICAgICAndmFyIGYgPSByZXF1aXJlKCcgKyBzdHJpbmdpZnkod2tleSkgKyAnKTsnICtcbiAgICAgICAgICAgICcoZi5kZWZhdWx0ID8gZi5kZWZhdWx0IDogZikoc2VsZik7JyArXG4gICAgICAgICd9JyxcbiAgICAgICAgc2NhY2hlXG4gICAgXTtcblxuICAgIHZhciB3b3JrZXJTb3VyY2VzID0ge307XG4gICAgcmVzb2x2ZVNvdXJjZXMoc2tleSk7XG5cbiAgICBmdW5jdGlvbiByZXNvbHZlU291cmNlcyhrZXkpIHtcbiAgICAgICAgd29ya2VyU291cmNlc1trZXldID0gdHJ1ZTtcblxuICAgICAgICBmb3IgKHZhciBkZXBQYXRoIGluIHNvdXJjZXNba2V5XVsxXSkge1xuICAgICAgICAgICAgdmFyIGRlcEtleSA9IHNvdXJjZXNba2V5XVsxXVtkZXBQYXRoXTtcbiAgICAgICAgICAgIGlmICghd29ya2VyU291cmNlc1tkZXBLZXldKSB7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZVNvdXJjZXMoZGVwS2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciBzcmMgPSAnKCcgKyBidW5kbGVGbiArICcpKHsnXG4gICAgICAgICsgT2JqZWN0LmtleXMod29ya2VyU291cmNlcykubWFwKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgIHJldHVybiBzdHJpbmdpZnkoa2V5KSArICc6WydcbiAgICAgICAgICAgICAgICArIHNvdXJjZXNba2V5XVswXVxuICAgICAgICAgICAgICAgICsgJywnICsgc3RyaW5naWZ5KHNvdXJjZXNba2V5XVsxXSkgKyAnXSdcbiAgICAgICAgICAgIDtcbiAgICAgICAgfSkuam9pbignLCcpXG4gICAgICAgICsgJ30se30sWycgKyBzdHJpbmdpZnkoc2tleSkgKyAnXSknXG4gICAgO1xuXG4gICAgdmFyIFVSTCA9IHdpbmRvdy5VUkwgfHwgd2luZG93LndlYmtpdFVSTCB8fCB3aW5kb3cubW96VVJMIHx8IHdpbmRvdy5tc1VSTDtcblxuICAgIHZhciBibG9iID0gbmV3IEJsb2IoW3NyY10sIHsgdHlwZTogJ3RleHQvamF2YXNjcmlwdCcgfSk7XG4gICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5iYXJlKSB7IHJldHVybiBibG9iOyB9XG4gICAgdmFyIHdvcmtlclVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7XG4gICAgdmFyIHdvcmtlciA9IG5ldyBXb3JrZXIod29ya2VyVXJsKTtcbiAgICB3b3JrZXIub2JqZWN0VVJMID0gd29ya2VyVXJsO1xuICAgIHJldHVybiB3b3JrZXI7XG59O1xuXG59LHt9XSw1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5jcmVhdGVEZWZhdWx0Q29uZmlnID0gY3JlYXRlRGVmYXVsdENvbmZpZztcbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbnZhciBkZWZhdWx0Q29uZmlnID0gZXhwb3J0cy5kZWZhdWx0Q29uZmlnID0ge1xuICAgIGVuYWJsZVdvcmtlcjogZmFsc2UsXG4gICAgZW5hYmxlU3Rhc2hCdWZmZXI6IHRydWUsXG4gICAgc3Rhc2hJbml0aWFsU2l6ZTogdW5kZWZpbmVkLFxuXG4gICAgaXNMaXZlOiBmYWxzZSxcblxuICAgIGxhenlMb2FkOiB0cnVlLFxuICAgIGxhenlMb2FkTWF4RHVyYXRpb246IDMgKiA2MCxcbiAgICBsYXp5TG9hZFJlY292ZXJEdXJhdGlvbjogMzAsXG4gICAgZGVmZXJMb2FkQWZ0ZXJTb3VyY2VPcGVuOiB0cnVlLFxuXG4gICAgLy8gYXV0b0NsZWFudXBTb3VyY2VCdWZmZXI6IGRlZmF1bHQgYXMgZmFsc2UsIGxlYXZlIHVuc3BlY2lmaWVkXG4gICAgYXV0b0NsZWFudXBNYXhCYWNrd2FyZER1cmF0aW9uOiAzICogNjAsXG4gICAgYXV0b0NsZWFudXBNaW5CYWNrd2FyZER1cmF0aW9uOiAyICogNjAsXG5cbiAgICBzdGF0aXN0aWNzSW5mb1JlcG9ydEludGVydmFsOiA2MDAsXG5cbiAgICBmaXhBdWRpb1RpbWVzdGFtcEdhcDogdHJ1ZSxcblxuICAgIGFjY3VyYXRlU2VlazogZmFsc2UsXG4gICAgc2Vla1R5cGU6ICdyYW5nZScsIC8vIFtyYW5nZSwgcGFyYW0sIGN1c3RvbV1cbiAgICBzZWVrUGFyYW1TdGFydDogJ2JzdGFydCcsXG4gICAgc2Vla1BhcmFtRW5kOiAnYmVuZCcsXG4gICAgcmFuZ2VMb2FkWmVyb1N0YXJ0OiBmYWxzZSxcbiAgICBjdXN0b21TZWVrSGFuZGxlcjogdW5kZWZpbmVkLFxuICAgIHJldXNlUmVkaXJlY3RlZFVSTDogZmFsc2UsXG4gICAgLy8gcmVmZXJyZXJQb2xpY3k6IGxlYXZlIGFzIHVuc3BlY2lmaWVkXG5cbiAgICBoZWFkZXJzOiB1bmRlZmluZWQsXG4gICAgY3VzdG9tTG9hZGVyOiB1bmRlZmluZWRcbn07XG5cbmZ1bmN0aW9uIGNyZWF0ZURlZmF1bHRDb25maWcoKSB7XG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRDb25maWcpO1xufVxuXG59LHt9XSw2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9pb0NvbnRyb2xsZXIgPSBfZGVyZXFfKCcuLi9pby9pby1jb250cm9sbGVyLmpzJyk7XG5cbnZhciBfaW9Db250cm9sbGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2lvQ29udHJvbGxlcik7XG5cbnZhciBfY29uZmlnID0gX2RlcmVxXygnLi4vY29uZmlnLmpzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBGZWF0dXJlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGZWF0dXJlcygpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZlYXR1cmVzKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoRmVhdHVyZXMsIG51bGwsIFt7XG4gICAgICAgIGtleTogJ3N1cHBvcnRNU0VIMjY0UGxheWJhY2snLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3VwcG9ydE1TRUgyNjRQbGF5YmFjaygpIHtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3cuTWVkaWFTb3VyY2UgJiYgd2luZG93Lk1lZGlhU291cmNlLmlzVHlwZVN1cHBvcnRlZCgndmlkZW8vbXA0OyBjb2RlY3M9XCJhdmMxLjQyRTAxRSxtcDRhLjQwLjJcIicpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzdXBwb3J0TmV0d29ya1N0cmVhbUlPJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN1cHBvcnROZXR3b3JrU3RyZWFtSU8oKSB7XG4gICAgICAgICAgICB2YXIgaW9jdGwgPSBuZXcgX2lvQ29udHJvbGxlcjIuZGVmYXVsdCh7fSwgKDAsIF9jb25maWcuY3JlYXRlRGVmYXVsdENvbmZpZykoKSk7XG4gICAgICAgICAgICB2YXIgbG9hZGVyVHlwZSA9IGlvY3RsLmxvYWRlclR5cGU7XG4gICAgICAgICAgICBpb2N0bC5kZXN0cm95KCk7XG4gICAgICAgICAgICByZXR1cm4gbG9hZGVyVHlwZSA9PSAnZmV0Y2gtc3RyZWFtLWxvYWRlcicgfHwgbG9hZGVyVHlwZSA9PSAneGhyLW1vei1jaHVua2VkLWxvYWRlcic7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2dldE5ldHdvcmtMb2FkZXJUeXBlTmFtZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROZXR3b3JrTG9hZGVyVHlwZU5hbWUoKSB7XG4gICAgICAgICAgICB2YXIgaW9jdGwgPSBuZXcgX2lvQ29udHJvbGxlcjIuZGVmYXVsdCh7fSwgKDAsIF9jb25maWcuY3JlYXRlRGVmYXVsdENvbmZpZykoKSk7XG4gICAgICAgICAgICB2YXIgbG9hZGVyVHlwZSA9IGlvY3RsLmxvYWRlclR5cGU7XG4gICAgICAgICAgICBpb2N0bC5kZXN0cm95KCk7XG4gICAgICAgICAgICByZXR1cm4gbG9hZGVyVHlwZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc3VwcG9ydE5hdGl2ZU1lZGlhUGxheWJhY2snLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3VwcG9ydE5hdGl2ZU1lZGlhUGxheWJhY2sobWltZVR5cGUpIHtcbiAgICAgICAgICAgIGlmIChGZWF0dXJlcy52aWRlb0VsZW1lbnQgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgRmVhdHVyZXMudmlkZW9FbGVtZW50ID0gd2luZG93LmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3ZpZGVvJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY2FuUGxheSA9IEZlYXR1cmVzLnZpZGVvRWxlbWVudC5jYW5QbGF5VHlwZShtaW1lVHlwZSk7XG4gICAgICAgICAgICByZXR1cm4gY2FuUGxheSA9PT0gJ3Byb2JhYmx5JyB8fCBjYW5QbGF5ID09ICdtYXliZSc7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2dldEZlYXR1cmVMaXN0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEZlYXR1cmVMaXN0KCkge1xuICAgICAgICAgICAgdmFyIGZlYXR1cmVzID0ge1xuICAgICAgICAgICAgICAgIG1zZUZsdlBsYXliYWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBtc2VMaXZlRmx2UGxheWJhY2s6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG5ldHdvcmtTdHJlYW1JTzogZmFsc2UsXG4gICAgICAgICAgICAgICAgbmV0d29ya0xvYWRlck5hbWU6ICcnLFxuICAgICAgICAgICAgICAgIG5hdGl2ZU1QNEgyNjRQbGF5YmFjazogZmFsc2UsXG4gICAgICAgICAgICAgICAgbmF0aXZlV2VibVZQOFBsYXliYWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBuYXRpdmVXZWJtVlA5UGxheWJhY2s6IGZhbHNlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBmZWF0dXJlcy5tc2VGbHZQbGF5YmFjayA9IEZlYXR1cmVzLnN1cHBvcnRNU0VIMjY0UGxheWJhY2soKTtcbiAgICAgICAgICAgIGZlYXR1cmVzLm5ldHdvcmtTdHJlYW1JTyA9IEZlYXR1cmVzLnN1cHBvcnROZXR3b3JrU3RyZWFtSU8oKTtcbiAgICAgICAgICAgIGZlYXR1cmVzLm5ldHdvcmtMb2FkZXJOYW1lID0gRmVhdHVyZXMuZ2V0TmV0d29ya0xvYWRlclR5cGVOYW1lKCk7XG4gICAgICAgICAgICBmZWF0dXJlcy5tc2VMaXZlRmx2UGxheWJhY2sgPSBmZWF0dXJlcy5tc2VGbHZQbGF5YmFjayAmJiBmZWF0dXJlcy5uZXR3b3JrU3RyZWFtSU87XG4gICAgICAgICAgICBmZWF0dXJlcy5uYXRpdmVNUDRIMjY0UGxheWJhY2sgPSBGZWF0dXJlcy5zdXBwb3J0TmF0aXZlTWVkaWFQbGF5YmFjaygndmlkZW8vbXA0OyBjb2RlY3M9XCJhdmMxLjQyMDAxRSwgbXA0YS40MC4yXCInKTtcbiAgICAgICAgICAgIGZlYXR1cmVzLm5hdGl2ZVdlYm1WUDhQbGF5YmFjayA9IEZlYXR1cmVzLnN1cHBvcnROYXRpdmVNZWRpYVBsYXliYWNrKCd2aWRlby93ZWJtOyBjb2RlY3M9XCJ2cDguMCwgdm9yYmlzXCInKTtcbiAgICAgICAgICAgIGZlYXR1cmVzLm5hdGl2ZVdlYm1WUDlQbGF5YmFjayA9IEZlYXR1cmVzLnN1cHBvcnROYXRpdmVNZWRpYVBsYXliYWNrKCd2aWRlby93ZWJtOyBjb2RlY3M9XCJ2cDlcIicpO1xuXG4gICAgICAgICAgICByZXR1cm4gZmVhdHVyZXM7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gRmVhdHVyZXM7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEZlYXR1cmVzO1xuXG59LHtcIi4uL2NvbmZpZy5qc1wiOjUsXCIuLi9pby9pby1jb250cm9sbGVyLmpzXCI6MjN9XSw3OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbnZhciBNZWRpYUluZm8gPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTWVkaWFJbmZvKCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTWVkaWFJbmZvKTtcblxuICAgICAgICB0aGlzLm1pbWVUeXBlID0gbnVsbDtcbiAgICAgICAgdGhpcy5kdXJhdGlvbiA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5oYXNBdWRpbyA9IG51bGw7XG4gICAgICAgIHRoaXMuaGFzVmlkZW8gPSBudWxsO1xuICAgICAgICB0aGlzLmF1ZGlvQ29kZWMgPSBudWxsO1xuICAgICAgICB0aGlzLnZpZGVvQ29kZWMgPSBudWxsO1xuICAgICAgICB0aGlzLmF1ZGlvRGF0YVJhdGUgPSBudWxsO1xuICAgICAgICB0aGlzLnZpZGVvRGF0YVJhdGUgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuYXVkaW9TYW1wbGVSYXRlID0gbnVsbDtcbiAgICAgICAgdGhpcy5hdWRpb0NoYW5uZWxDb3VudCA9IG51bGw7XG5cbiAgICAgICAgdGhpcy53aWR0aCA9IG51bGw7XG4gICAgICAgIHRoaXMuaGVpZ2h0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5mcHMgPSBudWxsO1xuICAgICAgICB0aGlzLnByb2ZpbGUgPSBudWxsO1xuICAgICAgICB0aGlzLmxldmVsID0gbnVsbDtcbiAgICAgICAgdGhpcy5yZWZGcmFtZXMgPSBudWxsO1xuICAgICAgICB0aGlzLmNocm9tYUZvcm1hdCA9IG51bGw7XG4gICAgICAgIHRoaXMuc2FyTnVtID0gbnVsbDtcbiAgICAgICAgdGhpcy5zYXJEZW4gPSBudWxsO1xuXG4gICAgICAgIHRoaXMubWV0YWRhdGEgPSBudWxsO1xuICAgICAgICB0aGlzLnNlZ21lbnRzID0gbnVsbDsgLy8gTWVkaWFJbmZvW11cbiAgICAgICAgdGhpcy5zZWdtZW50Q291bnQgPSBudWxsO1xuICAgICAgICB0aGlzLmhhc0tleWZyYW1lc0luZGV4ID0gbnVsbDtcbiAgICAgICAgdGhpcy5rZXlmcmFtZXNJbmRleCA9IG51bGw7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKE1lZGlhSW5mbywgW3tcbiAgICAgICAga2V5OiBcImlzQ29tcGxldGVcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzQ29tcGxldGUoKSB7XG4gICAgICAgICAgICB2YXIgYXVkaW9JbmZvQ29tcGxldGUgPSB0aGlzLmhhc0F1ZGlvID09PSBmYWxzZSB8fCB0aGlzLmhhc0F1ZGlvID09PSB0cnVlICYmIHRoaXMuYXVkaW9Db2RlYyAhPSBudWxsICYmIHRoaXMuYXVkaW9TYW1wbGVSYXRlICE9IG51bGwgJiYgdGhpcy5hdWRpb0NoYW5uZWxDb3VudCAhPSBudWxsO1xuXG4gICAgICAgICAgICB2YXIgdmlkZW9JbmZvQ29tcGxldGUgPSB0aGlzLmhhc1ZpZGVvID09PSBmYWxzZSB8fCB0aGlzLmhhc1ZpZGVvID09PSB0cnVlICYmIHRoaXMudmlkZW9Db2RlYyAhPSBudWxsICYmIHRoaXMud2lkdGggIT0gbnVsbCAmJiB0aGlzLmhlaWdodCAhPSBudWxsICYmIHRoaXMuZnBzICE9IG51bGwgJiYgdGhpcy5wcm9maWxlICE9IG51bGwgJiYgdGhpcy5sZXZlbCAhPSBudWxsICYmIHRoaXMucmVmRnJhbWVzICE9IG51bGwgJiYgdGhpcy5jaHJvbWFGb3JtYXQgIT0gbnVsbCAmJiB0aGlzLnNhck51bSAhPSBudWxsICYmIHRoaXMuc2FyRGVuICE9IG51bGw7XG5cbiAgICAgICAgICAgIC8vIGtleWZyYW1lc0luZGV4IG1heSBub3QgYmUgcHJlc2VudFxuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWltZVR5cGUgIT0gbnVsbCAmJiB0aGlzLmR1cmF0aW9uICE9IG51bGwgJiYgdGhpcy5tZXRhZGF0YSAhPSBudWxsICYmIHRoaXMuaGFzS2V5ZnJhbWVzSW5kZXggIT0gbnVsbCAmJiBhdWRpb0luZm9Db21wbGV0ZSAmJiB2aWRlb0luZm9Db21wbGV0ZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImlzU2Vla2FibGVcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzU2Vla2FibGUoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5oYXNLZXlmcmFtZXNJbmRleCA9PT0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImdldE5lYXJlc3RLZXlmcmFtZVwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TmVhcmVzdEtleWZyYW1lKG1pbGxpc2Vjb25kcykge1xuICAgICAgICAgICAgaWYgKHRoaXMua2V5ZnJhbWVzSW5kZXggPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdGFibGUgPSB0aGlzLmtleWZyYW1lc0luZGV4O1xuICAgICAgICAgICAgdmFyIGtleWZyYW1lSWR4ID0gdGhpcy5fc2VhcmNoKHRhYmxlLnRpbWVzLCBtaWxsaXNlY29uZHMpO1xuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGluZGV4OiBrZXlmcmFtZUlkeCxcbiAgICAgICAgICAgICAgICBtaWxsaXNlY29uZHM6IHRhYmxlLnRpbWVzW2tleWZyYW1lSWR4XSxcbiAgICAgICAgICAgICAgICBmaWxlcG9zaXRpb246IHRhYmxlLmZpbGVwb3NpdGlvbnNba2V5ZnJhbWVJZHhdXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiX3NlYXJjaFwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3NlYXJjaChsaXN0LCB2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIGlkeCA9IDA7XG5cbiAgICAgICAgICAgIHZhciBsYXN0ID0gbGlzdC5sZW5ndGggLSAxO1xuICAgICAgICAgICAgdmFyIG1pZCA9IDA7XG4gICAgICAgICAgICB2YXIgbGJvdW5kID0gMDtcbiAgICAgICAgICAgIHZhciB1Ym91bmQgPSBsYXN0O1xuXG4gICAgICAgICAgICBpZiAodmFsdWUgPCBsaXN0WzBdKSB7XG4gICAgICAgICAgICAgICAgaWR4ID0gMDtcbiAgICAgICAgICAgICAgICBsYm91bmQgPSB1Ym91bmQgKyAxOyAvLyBza2lwIHNlYXJjaFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3aGlsZSAobGJvdW5kIDw9IHVib3VuZCkge1xuICAgICAgICAgICAgICAgIG1pZCA9IGxib3VuZCArIE1hdGguZmxvb3IoKHVib3VuZCAtIGxib3VuZCkgLyAyKTtcbiAgICAgICAgICAgICAgICBpZiAobWlkID09PSBsYXN0IHx8IHZhbHVlID49IGxpc3RbbWlkXSAmJiB2YWx1ZSA8IGxpc3RbbWlkICsgMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWR4ID0gbWlkO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpc3RbbWlkXSA8IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGxib3VuZCA9IG1pZCArIDE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdWJvdW5kID0gbWlkIC0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBpZHg7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gTWVkaWFJbmZvO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBNZWRpYUluZm87XG5cbn0se31dLDg6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxuLy8gUmVwcmVzZW50cyBhbiBtZWRpYSBzYW1wbGUgKGF1ZGlvIC8gdmlkZW8pXG52YXIgU2FtcGxlSW5mbyA9IGV4cG9ydHMuU2FtcGxlSW5mbyA9IGZ1bmN0aW9uIFNhbXBsZUluZm8oZHRzLCBwdHMsIGR1cmF0aW9uLCBvcmlnaW5hbER0cywgaXNTeW5jKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNhbXBsZUluZm8pO1xuXG4gICAgdGhpcy5kdHMgPSBkdHM7XG4gICAgdGhpcy5wdHMgPSBwdHM7XG4gICAgdGhpcy5kdXJhdGlvbiA9IGR1cmF0aW9uO1xuICAgIHRoaXMub3JpZ2luYWxEdHMgPSBvcmlnaW5hbER0cztcbiAgICB0aGlzLmlzU3luY1BvaW50ID0gaXNTeW5jO1xuICAgIHRoaXMuZmlsZXBvc2l0aW9uID0gbnVsbDtcbn07XG5cbi8vIE1lZGlhIFNlZ21lbnQgY29uY2VwdCBpcyBkZWZpbmVkIGluIE1lZGlhIFNvdXJjZSBFeHRlbnNpb25zIHNwZWMuXG4vLyBQYXJ0aWN1bGFybHkgaW4gSVNPIEJNRkYgZm9ybWF0LCBhbiBNZWRpYSBTZWdtZW50IGNvbnRhaW5zIGEgbW9vZiBib3ggZm9sbG93ZWQgYnkgYSBtZGF0IGJveC5cblxuXG52YXIgTWVkaWFTZWdtZW50SW5mbyA9IGV4cG9ydHMuTWVkaWFTZWdtZW50SW5mbyA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBNZWRpYVNlZ21lbnRJbmZvKCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTWVkaWFTZWdtZW50SW5mbyk7XG5cbiAgICAgICAgdGhpcy5iZWdpbkR0cyA9IDA7XG4gICAgICAgIHRoaXMuZW5kRHRzID0gMDtcbiAgICAgICAgdGhpcy5iZWdpblB0cyA9IDA7XG4gICAgICAgIHRoaXMuZW5kUHRzID0gMDtcbiAgICAgICAgdGhpcy5vcmlnaW5hbEJlZ2luRHRzID0gMDtcbiAgICAgICAgdGhpcy5vcmlnaW5hbEVuZER0cyA9IDA7XG4gICAgICAgIHRoaXMuc3luY1BvaW50cyA9IFtdOyAvLyBTYW1wbGVJbmZvW25dLCBmb3IgdmlkZW8gSURSIGZyYW1lcyBvbmx5XG4gICAgICAgIHRoaXMuZmlyc3RTYW1wbGUgPSBudWxsOyAvLyBTYW1wbGVJbmZvXG4gICAgICAgIHRoaXMubGFzdFNhbXBsZSA9IG51bGw7IC8vIFNhbXBsZUluZm9cbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoTWVkaWFTZWdtZW50SW5mbywgW3tcbiAgICAgICAga2V5OiBcImFwcGVuZFN5bmNQb2ludFwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXBwZW5kU3luY1BvaW50KHNhbXBsZUluZm8pIHtcbiAgICAgICAgICAgIC8vIGFsc28gY2FsbGVkIFJhbmRvbSBBY2Nlc3MgUG9pbnRcbiAgICAgICAgICAgIHNhbXBsZUluZm8uaXNTeW5jUG9pbnQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5zeW5jUG9pbnRzLnB1c2goc2FtcGxlSW5mbyk7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gTWVkaWFTZWdtZW50SW5mbztcbn0oKTtcblxuLy8gT3JkZXJlZCBsaXN0IGZvciByZWNvcmRpbmcgdmlkZW8gSURSIGZyYW1lcywgc29ydGVkIGJ5IG9yaWdpbmFsRHRzXG5cblxudmFyIElEUlNhbXBsZUxpc3QgPSBleHBvcnRzLklEUlNhbXBsZUxpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gSURSU2FtcGxlTGlzdCgpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIElEUlNhbXBsZUxpc3QpO1xuXG4gICAgICAgIHRoaXMuX2xpc3QgPSBbXTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoSURSU2FtcGxlTGlzdCwgW3tcbiAgICAgICAga2V5OiBcImNsZWFyXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbGVhcigpIHtcbiAgICAgICAgICAgIHRoaXMuX2xpc3QgPSBbXTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImFwcGVuZEFycmF5XCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBlbmRBcnJheShzeW5jUG9pbnRzKSB7XG4gICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXMuX2xpc3Q7XG5cbiAgICAgICAgICAgIGlmIChzeW5jUG9pbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGxpc3QubGVuZ3RoID4gMCAmJiBzeW5jUG9pbnRzWzBdLm9yaWdpbmFsRHRzIDwgbGlzdFtsaXN0Lmxlbmd0aCAtIDFdLm9yaWdpbmFsRHRzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhcigpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBBcnJheS5wcm90b3R5cGUucHVzaC5hcHBseShsaXN0LCBzeW5jUG9pbnRzKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImdldExhc3RTeW5jUG9pbnRCZWZvcmVEdHNcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldExhc3RTeW5jUG9pbnRCZWZvcmVEdHMoZHRzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbGlzdC5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXMuX2xpc3Q7XG4gICAgICAgICAgICB2YXIgaWR4ID0gMDtcbiAgICAgICAgICAgIHZhciBsYXN0ID0gbGlzdC5sZW5ndGggLSAxO1xuICAgICAgICAgICAgdmFyIG1pZCA9IDA7XG4gICAgICAgICAgICB2YXIgbGJvdW5kID0gMDtcbiAgICAgICAgICAgIHZhciB1Ym91bmQgPSBsYXN0O1xuXG4gICAgICAgICAgICBpZiAoZHRzIDwgbGlzdFswXS5kdHMpIHtcbiAgICAgICAgICAgICAgICBpZHggPSAwO1xuICAgICAgICAgICAgICAgIGxib3VuZCA9IHVib3VuZCArIDE7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHdoaWxlIChsYm91bmQgPD0gdWJvdW5kKSB7XG4gICAgICAgICAgICAgICAgbWlkID0gbGJvdW5kICsgTWF0aC5mbG9vcigodWJvdW5kIC0gbGJvdW5kKSAvIDIpO1xuICAgICAgICAgICAgICAgIGlmIChtaWQgPT09IGxhc3QgfHwgZHRzID49IGxpc3RbbWlkXS5kdHMgJiYgZHRzIDwgbGlzdFttaWQgKyAxXS5kdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWR4ID0gbWlkO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpc3RbbWlkXS5kdHMgPCBkdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgbGJvdW5kID0gbWlkICsgMTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB1Ym91bmQgPSBtaWQgLSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9saXN0W2lkeF07XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gSURSU2FtcGxlTGlzdDtcbn0oKTtcblxuLy8gRGF0YSBzdHJ1Y3R1cmUgZm9yIHJlY29yZGluZyBpbmZvcm1hdGlvbiBvZiBtZWRpYSBzZWdtZW50cyBpbiBzaW5nbGUgdHJhY2suXG5cblxudmFyIE1lZGlhU2VnbWVudEluZm9MaXN0ID0gZXhwb3J0cy5NZWRpYVNlZ21lbnRJbmZvTGlzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBNZWRpYVNlZ21lbnRJbmZvTGlzdCh0eXBlKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNZWRpYVNlZ21lbnRJbmZvTGlzdCk7XG5cbiAgICAgICAgdGhpcy5fdHlwZSA9IHR5cGU7XG4gICAgICAgIHRoaXMuX2xpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5fbGFzdEFwcGVuZExvY2F0aW9uID0gLTE7IC8vIGNhY2hlZCBsYXN0IGluc2VydCBsb2NhdGlvblxuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhNZWRpYVNlZ21lbnRJbmZvTGlzdCwgW3tcbiAgICAgICAga2V5OiBcImlzRW1wdHlcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzRW1wdHkoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbGlzdC5sZW5ndGggPT09IDA7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJjbGVhclwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYXIoKSB7XG4gICAgICAgICAgICB0aGlzLl9saXN0ID0gW107XG4gICAgICAgICAgICB0aGlzLl9sYXN0QXBwZW5kTG9jYXRpb24gPSAtMTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcIl9zZWFyY2hOZWFyZXN0U2VnbWVudEJlZm9yZVwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3NlYXJjaE5lYXJlc3RTZWdtZW50QmVmb3JlKG9yaWdpbmFsQmVnaW5EdHMpIHtcbiAgICAgICAgICAgIHZhciBsaXN0ID0gdGhpcy5fbGlzdDtcbiAgICAgICAgICAgIGlmIChsaXN0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAtMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBsYXN0ID0gbGlzdC5sZW5ndGggLSAxO1xuICAgICAgICAgICAgdmFyIG1pZCA9IDA7XG4gICAgICAgICAgICB2YXIgbGJvdW5kID0gMDtcbiAgICAgICAgICAgIHZhciB1Ym91bmQgPSBsYXN0O1xuXG4gICAgICAgICAgICB2YXIgaWR4ID0gMDtcblxuICAgICAgICAgICAgaWYgKG9yaWdpbmFsQmVnaW5EdHMgPCBsaXN0WzBdLm9yaWdpbmFsQmVnaW5EdHMpIHtcbiAgICAgICAgICAgICAgICBpZHggPSAtMTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaWR4O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3aGlsZSAobGJvdW5kIDw9IHVib3VuZCkge1xuICAgICAgICAgICAgICAgIG1pZCA9IGxib3VuZCArIE1hdGguZmxvb3IoKHVib3VuZCAtIGxib3VuZCkgLyAyKTtcbiAgICAgICAgICAgICAgICBpZiAobWlkID09PSBsYXN0IHx8IG9yaWdpbmFsQmVnaW5EdHMgPiBsaXN0W21pZF0ubGFzdFNhbXBsZS5vcmlnaW5hbER0cyAmJiBvcmlnaW5hbEJlZ2luRHRzIDwgbGlzdFttaWQgKyAxXS5vcmlnaW5hbEJlZ2luRHRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlkeCA9IG1pZDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaXN0W21pZF0ub3JpZ2luYWxCZWdpbkR0cyA8IG9yaWdpbmFsQmVnaW5EdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgbGJvdW5kID0gbWlkICsgMTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB1Ym91bmQgPSBtaWQgLSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBpZHg7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJfc2VhcmNoTmVhcmVzdFNlZ21lbnRBZnRlclwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3NlYXJjaE5lYXJlc3RTZWdtZW50QWZ0ZXIob3JpZ2luYWxCZWdpbkR0cykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NlYXJjaE5lYXJlc3RTZWdtZW50QmVmb3JlKG9yaWdpbmFsQmVnaW5EdHMpICsgMTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImFwcGVuZFwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXBwZW5kKG1lZGlhU2VnbWVudEluZm8pIHtcbiAgICAgICAgICAgIHZhciBsaXN0ID0gdGhpcy5fbGlzdDtcbiAgICAgICAgICAgIHZhciBtc2kgPSBtZWRpYVNlZ21lbnRJbmZvO1xuICAgICAgICAgICAgdmFyIGxhc3RBcHBlbmRJZHggPSB0aGlzLl9sYXN0QXBwZW5kTG9jYXRpb247XG4gICAgICAgICAgICB2YXIgaW5zZXJ0SWR4ID0gMDtcblxuICAgICAgICAgICAgaWYgKGxhc3RBcHBlbmRJZHggIT09IC0xICYmIGxhc3RBcHBlbmRJZHggPCBsaXN0Lmxlbmd0aCAmJiBtc2kub3JpZ2luYWxCZWdpbkR0cyA+PSBsaXN0W2xhc3RBcHBlbmRJZHhdLmxhc3RTYW1wbGUub3JpZ2luYWxEdHMgJiYgKGxhc3RBcHBlbmRJZHggPT09IGxpc3QubGVuZ3RoIC0gMSB8fCBsYXN0QXBwZW5kSWR4IDwgbGlzdC5sZW5ndGggLSAxICYmIG1zaS5vcmlnaW5hbEJlZ2luRHRzIDwgbGlzdFtsYXN0QXBwZW5kSWR4ICsgMV0ub3JpZ2luYWxCZWdpbkR0cykpIHtcbiAgICAgICAgICAgICAgICBpbnNlcnRJZHggPSBsYXN0QXBwZW5kSWR4ICsgMTsgLy8gdXNlIGNhY2hlZCBsb2NhdGlvbiBpZHhcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGxpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBpbnNlcnRJZHggPSB0aGlzLl9zZWFyY2hOZWFyZXN0U2VnbWVudEJlZm9yZShtc2kub3JpZ2luYWxCZWdpbkR0cykgKyAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fbGFzdEFwcGVuZExvY2F0aW9uID0gaW5zZXJ0SWR4O1xuICAgICAgICAgICAgdGhpcy5fbGlzdC5zcGxpY2UoaW5zZXJ0SWR4LCAwLCBtc2kpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiZ2V0TGFzdFNlZ21lbnRCZWZvcmVcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldExhc3RTZWdtZW50QmVmb3JlKG9yaWdpbmFsQmVnaW5EdHMpIHtcbiAgICAgICAgICAgIHZhciBpZHggPSB0aGlzLl9zZWFyY2hOZWFyZXN0U2VnbWVudEJlZm9yZShvcmlnaW5hbEJlZ2luRHRzKTtcbiAgICAgICAgICAgIGlmIChpZHggPj0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9saXN0W2lkeF07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIC0xXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJnZXRMYXN0U2FtcGxlQmVmb3JlXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRMYXN0U2FtcGxlQmVmb3JlKG9yaWdpbmFsQmVnaW5EdHMpIHtcbiAgICAgICAgICAgIHZhciBzZWdtZW50ID0gdGhpcy5nZXRMYXN0U2VnbWVudEJlZm9yZShvcmlnaW5hbEJlZ2luRHRzKTtcbiAgICAgICAgICAgIGlmIChzZWdtZW50ICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VnbWVudC5sYXN0U2FtcGxlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImdldExhc3RTeW5jUG9pbnRCZWZvcmVcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldExhc3RTeW5jUG9pbnRCZWZvcmUob3JpZ2luYWxCZWdpbkR0cykge1xuICAgICAgICAgICAgdmFyIHNlZ21lbnRJZHggPSB0aGlzLl9zZWFyY2hOZWFyZXN0U2VnbWVudEJlZm9yZShvcmlnaW5hbEJlZ2luRHRzKTtcbiAgICAgICAgICAgIHZhciBzeW5jUG9pbnRzID0gdGhpcy5fbGlzdFtzZWdtZW50SWR4XS5zeW5jUG9pbnRzO1xuICAgICAgICAgICAgd2hpbGUgKHN5bmNQb2ludHMubGVuZ3RoID09PSAwICYmIHNlZ21lbnRJZHggPiAwKSB7XG4gICAgICAgICAgICAgICAgc2VnbWVudElkeC0tO1xuICAgICAgICAgICAgICAgIHN5bmNQb2ludHMgPSB0aGlzLl9saXN0W3NlZ21lbnRJZHhdLnN5bmNQb2ludHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3luY1BvaW50cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN5bmNQb2ludHNbc3luY1BvaW50cy5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJ0eXBlXCIsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3R5cGU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJsZW5ndGhcIixcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbGlzdC5sZW5ndGg7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gTWVkaWFTZWdtZW50SW5mb0xpc3Q7XG59KCk7XG5cbn0se31dLDk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgX2V2ZW50cyA9IF9kZXJlcV8oJ2V2ZW50cycpO1xuXG52YXIgX2V2ZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ldmVudHMpO1xuXG52YXIgX2xvZ2dlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZ2dlci5qcycpO1xuXG52YXIgX2xvZ2dlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnZXIpO1xuXG52YXIgX2Jyb3dzZXIgPSBfZGVyZXFfKCcuLi91dGlscy9icm93c2VyLmpzJyk7XG5cbnZhciBfYnJvd3NlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9icm93c2VyKTtcblxudmFyIF9tc2VFdmVudHMgPSBfZGVyZXFfKCcuL21zZS1ldmVudHMuanMnKTtcblxudmFyIF9tc2VFdmVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbXNlRXZlbnRzKTtcblxudmFyIF9tZWRpYVNlZ21lbnRJbmZvID0gX2RlcmVxXygnLi9tZWRpYS1zZWdtZW50LWluZm8uanMnKTtcblxudmFyIF9leGNlcHRpb24gPSBfZGVyZXFfKCcuLi91dGlscy9leGNlcHRpb24uanMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLy8gTWVkaWEgU291cmNlIEV4dGVuc2lvbnMgY29udHJvbGxlclxudmFyIE1TRUNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTVNFQ29udHJvbGxlcihjb25maWcpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1TRUNvbnRyb2xsZXIpO1xuXG4gICAgICAgIHRoaXMuVEFHID0gJ01TRUNvbnRyb2xsZXInO1xuXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgdGhpcy5fZW1pdHRlciA9IG5ldyBfZXZlbnRzMi5kZWZhdWx0KCk7XG5cbiAgICAgICAgaWYgKHRoaXMuX2NvbmZpZy5pc0xpdmUgJiYgdGhpcy5fY29uZmlnLmF1dG9DbGVhbnVwU291cmNlQnVmZmVyID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgLy8gRm9yIGxpdmUgc3RyZWFtLCBkbyBhdXRvIGNsZWFudXAgYnkgZGVmYXVsdFxuICAgICAgICAgICAgdGhpcy5fY29uZmlnLmF1dG9DbGVhbnVwU291cmNlQnVmZmVyID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZSA9IHtcbiAgICAgICAgICAgIG9uU291cmNlT3BlbjogdGhpcy5fb25Tb3VyY2VPcGVuLmJpbmQodGhpcyksXG4gICAgICAgICAgICBvblNvdXJjZUVuZGVkOiB0aGlzLl9vblNvdXJjZUVuZGVkLmJpbmQodGhpcyksXG4gICAgICAgICAgICBvblNvdXJjZUNsb3NlOiB0aGlzLl9vblNvdXJjZUNsb3NlLmJpbmQodGhpcyksXG4gICAgICAgICAgICBvblNvdXJjZUJ1ZmZlckVycm9yOiB0aGlzLl9vblNvdXJjZUJ1ZmZlckVycm9yLmJpbmQodGhpcyksXG4gICAgICAgICAgICBvblNvdXJjZUJ1ZmZlclVwZGF0ZUVuZDogdGhpcy5fb25Tb3VyY2VCdWZmZXJVcGRhdGVFbmQuYmluZCh0aGlzKVxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuX21lZGlhU291cmNlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fbWVkaWFTb3VyY2VPYmplY3RVUkwgPSBudWxsO1xuICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuX2lzQnVmZmVyRnVsbCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9oYXNQZW5kaW5nRW9zID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5fcmVxdWlyZVNldE1lZGlhRHVyYXRpb24gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fcGVuZGluZ01lZGlhRHVyYXRpb24gPSAwO1xuXG4gICAgICAgIHRoaXMuX3BlbmRpbmdTb3VyY2VCdWZmZXJJbml0ID0gW107XG4gICAgICAgIHRoaXMuX21pbWVUeXBlcyA9IHtcbiAgICAgICAgICAgIHZpZGVvOiBudWxsLFxuICAgICAgICAgICAgYXVkaW86IG51bGxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5fc291cmNlQnVmZmVycyA9IHtcbiAgICAgICAgICAgIHZpZGVvOiBudWxsLFxuICAgICAgICAgICAgYXVkaW86IG51bGxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5fbGFzdEluaXRTZWdtZW50cyA9IHtcbiAgICAgICAgICAgIHZpZGVvOiBudWxsLFxuICAgICAgICAgICAgYXVkaW86IG51bGxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5fcGVuZGluZ1NlZ21lbnRzID0ge1xuICAgICAgICAgICAgdmlkZW86IFtdLFxuICAgICAgICAgICAgYXVkaW86IFtdXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX3BlbmRpbmdSZW1vdmVSYW5nZXMgPSB7XG4gICAgICAgICAgICB2aWRlbzogW10sXG4gICAgICAgICAgICBhdWRpbzogW11cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5faWRyTGlzdCA9IG5ldyBfbWVkaWFTZWdtZW50SW5mby5JRFJTYW1wbGVMaXN0KCk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKE1TRUNvbnRyb2xsZXIsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQgfHwgdGhpcy5fbWVkaWFTb3VyY2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmRldGFjaE1lZGlhRWxlbWVudCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5lID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb24nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb24oZXZlbnQsIGxpc3RlbmVyKSB7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmFkZExpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29mZicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvZmYoZXZlbnQsIGxpc3RlbmVyKSB7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLnJlbW92ZUxpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2F0dGFjaE1lZGlhRWxlbWVudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhdHRhY2hNZWRpYUVsZW1lbnQobWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFTb3VyY2UpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbGxlZ2FsU3RhdGVFeGNlcHRpb24oJ01lZGlhU291cmNlIGhhcyBiZWVuIGF0dGFjaGVkIHRvIGFuIEhUTUxNZWRpYUVsZW1lbnQhJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbXMgPSB0aGlzLl9tZWRpYVNvdXJjZSA9IG5ldyB3aW5kb3cuTWVkaWFTb3VyY2UoKTtcbiAgICAgICAgICAgIG1zLmFkZEV2ZW50TGlzdGVuZXIoJ3NvdXJjZW9wZW4nLCB0aGlzLmUub25Tb3VyY2VPcGVuKTtcbiAgICAgICAgICAgIG1zLmFkZEV2ZW50TGlzdGVuZXIoJ3NvdXJjZWVuZGVkJywgdGhpcy5lLm9uU291cmNlRW5kZWQpO1xuICAgICAgICAgICAgbXMuYWRkRXZlbnRMaXN0ZW5lcignc291cmNlY2xvc2UnLCB0aGlzLmUub25Tb3VyY2VDbG9zZSk7XG5cbiAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudCA9IG1lZGlhRWxlbWVudDtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhU291cmNlT2JqZWN0VVJMID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwodGhpcy5fbWVkaWFTb3VyY2UpO1xuICAgICAgICAgICAgbWVkaWFFbGVtZW50LnNyYyA9IHRoaXMuX21lZGlhU291cmNlT2JqZWN0VVJMO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdkZXRhY2hNZWRpYUVsZW1lbnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGV0YWNoTWVkaWFFbGVtZW50KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhU291cmNlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1zID0gdGhpcy5fbWVkaWFTb3VyY2U7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgdHlwZSBpbiB0aGlzLl9zb3VyY2VCdWZmZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHBlbmRpbmcgc2VnbWVudHMgc2hvdWxkIGJlIGRpc2NhcmRcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBzID0gdGhpcy5fcGVuZGluZ1NlZ21lbnRzW3R5cGVdO1xuICAgICAgICAgICAgICAgICAgICBwcy5zcGxpY2UoMCwgcHMubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1NlZ21lbnRzW3R5cGVdID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1JlbW92ZVJhbmdlc1t0eXBlXSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2xhc3RJbml0U2VnbWVudHNbdHlwZV0gPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBhbGwgc291cmNlYnVmZmVyc1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2IgPSB0aGlzLl9zb3VyY2VCdWZmZXJzW3R5cGVdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtcy5yZWFkeVN0YXRlICE9PSAnY2xvc2VkJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1zIGVkZ2UgY2FuIHRocm93IGFuIGVycm9yOiBVbmV4cGVjdGVkIGNhbGwgdG8gbWV0aG9kIG9yIHByb3BlcnR5IGFjY2Vzc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zLnJlbW92ZVNvdXJjZUJ1ZmZlcihzYik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lKHRoaXMuVEFHLCBlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2IucmVtb3ZlRXZlbnRMaXN0ZW5lcignZXJyb3InLCB0aGlzLmUub25Tb3VyY2VCdWZmZXJFcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2IucmVtb3ZlRXZlbnRMaXN0ZW5lcigndXBkYXRlZW5kJywgdGhpcy5lLm9uU291cmNlQnVmZmVyVXBkYXRlRW5kKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21pbWVUeXBlc1t0eXBlXSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zb3VyY2VCdWZmZXJzW3R5cGVdID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobXMucmVhZHlTdGF0ZSA9PT0gJ29wZW4nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtcy5lbmRPZlN0cmVhbSgpO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lKHRoaXMuVEFHLCBlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtcy5yZW1vdmVFdmVudExpc3RlbmVyKCdzb3VyY2VvcGVuJywgdGhpcy5lLm9uU291cmNlT3Blbik7XG4gICAgICAgICAgICAgICAgbXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignc291cmNlZW5kZWQnLCB0aGlzLmUub25Tb3VyY2VFbmRlZCk7XG4gICAgICAgICAgICAgICAgbXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignc291cmNlY2xvc2UnLCB0aGlzLmUub25Tb3VyY2VDbG9zZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1NvdXJjZUJ1ZmZlckluaXQgPSBbXTtcbiAgICAgICAgICAgICAgICB0aGlzLl9pc0J1ZmZlckZ1bGwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9pZHJMaXN0LmNsZWFyKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFTb3VyY2UgPSBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnNyYyA9ICcnO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ3NyYycpO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFTb3VyY2VPYmplY3RVUkwpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuVVJMLnJldm9rZU9iamVjdFVSTCh0aGlzLl9tZWRpYVNvdXJjZU9iamVjdFVSTCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFTb3VyY2VPYmplY3RVUkwgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhcHBlbmRJbml0U2VnbWVudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBlbmRJbml0U2VnbWVudChpbml0U2VnbWVudCwgZGVmZXJyZWQpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fbWVkaWFTb3VyY2UgfHwgdGhpcy5fbWVkaWFTb3VyY2UucmVhZHlTdGF0ZSAhPT0gJ29wZW4nKSB7XG4gICAgICAgICAgICAgICAgLy8gc291cmNlYnVmZmVyIGNyZWF0aW9uIHJlcXVpcmVzIG1lZGlhU291cmNlLnJlYWR5U3RhdGUgPT09ICdvcGVuJ1xuICAgICAgICAgICAgICAgIC8vIHNvIHdlIGRlZmVyIHRoZSBzb3VyY2VidWZmZXIgY3JlYXRpb24sIHVudGlsIHNvdXJjZW9wZW4gZXZlbnQgdHJpZ2dlcmVkXG4gICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1NvdXJjZUJ1ZmZlckluaXQucHVzaChpbml0U2VnbWVudCk7XG4gICAgICAgICAgICAgICAgLy8gbWFrZSBzdXJlIHRoYXQgdGhpcyBJbml0U2VnbWVudCBpcyBpbiB0aGUgZnJvbnQgb2YgcGVuZGluZyBzZWdtZW50cyBxdWV1ZVxuICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTZWdtZW50c1tpbml0U2VnbWVudC50eXBlXS5wdXNoKGluaXRTZWdtZW50KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBpcyA9IGluaXRTZWdtZW50O1xuICAgICAgICAgICAgdmFyIG1pbWVUeXBlID0gJycgKyBpcy5jb250YWluZXI7XG4gICAgICAgICAgICBpZiAoaXMuY29kZWMgJiYgaXMuY29kZWMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIG1pbWVUeXBlICs9ICc7Y29kZWNzPScgKyBpcy5jb2RlYztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGZpcnN0SW5pdFNlZ21lbnQgPSBmYWxzZTtcblxuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KHRoaXMuVEFHLCAnUmVjZWl2ZWQgSW5pdGlhbGl6YXRpb24gU2VnbWVudCwgbWltZVR5cGU6ICcgKyBtaW1lVHlwZSk7XG4gICAgICAgICAgICB0aGlzLl9sYXN0SW5pdFNlZ21lbnRzW2lzLnR5cGVdID0gaXM7XG5cbiAgICAgICAgICAgIGlmIChtaW1lVHlwZSAhPT0gdGhpcy5fbWltZVR5cGVzW2lzLnR5cGVdKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9taW1lVHlwZXNbaXMudHlwZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZW1wdHksIGZpcnN0IGNoYW5jZSBjcmVhdGUgc291cmNlYnVmZmVyXG4gICAgICAgICAgICAgICAgICAgIGZpcnN0SW5pdFNlZ21lbnQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNiID0gdGhpcy5fc291cmNlQnVmZmVyc1tpcy50eXBlXSA9IHRoaXMuX21lZGlhU291cmNlLmFkZFNvdXJjZUJ1ZmZlcihtaW1lVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzYi5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIHRoaXMuZS5vblNvdXJjZUJ1ZmZlckVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNiLmFkZEV2ZW50TGlzdGVuZXIoJ3VwZGF0ZWVuZCcsIHRoaXMuZS5vblNvdXJjZUJ1ZmZlclVwZGF0ZUVuZCk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmUodGhpcy5UQUcsIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF9tc2VFdmVudHMyLmRlZmF1bHQuRVJST1IsIHsgY29kZTogZXJyb3IuY29kZSwgbXNnOiBlcnJvci5tZXNzYWdlIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KHRoaXMuVEFHLCAnTm90aWNlOiAnICsgaXMudHlwZSArICcgbWltZVR5cGUgY2hhbmdlZCwgb3JpZ2luOiAnICsgdGhpcy5fbWltZVR5cGVzW2lzLnR5cGVdICsgJywgdGFyZ2V0OiAnICsgbWltZVR5cGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9taW1lVHlwZXNbaXMudHlwZV0gPSBtaW1lVHlwZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFkZWZlcnJlZCkge1xuICAgICAgICAgICAgICAgIC8vIGRlZmVycmVkIG1lYW5zIHRoaXMgSW5pdFNlZ21lbnQgaGFzIGJlZW4gcHVzaGVkIHRvIHBlbmRpbmdTZWdtZW50cyBxdWV1ZVxuICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTZWdtZW50c1tpcy50eXBlXS5wdXNoKGlzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZmlyc3RJbml0U2VnbWVudCkge1xuICAgICAgICAgICAgICAgIC8vIGFwcGVuZCBpbW1lZGlhdGVseSBvbmx5IGlmIGluaXQgc2VnbWVudCBpbiBzdWJzZXF1ZW5jZVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zb3VyY2VCdWZmZXJzW2lzLnR5cGVdICYmICF0aGlzLl9zb3VyY2VCdWZmZXJzW2lzLnR5cGVdLnVwZGF0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RvQXBwZW5kU2VnbWVudHMoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoX2Jyb3dzZXIyLmRlZmF1bHQuc2FmYXJpICYmIGlzLmNvbnRhaW5lciA9PT0gJ2F1ZGlvL21wZWcnICYmIGlzLm1lZGlhRHVyYXRpb24gPiAwKSB7XG4gICAgICAgICAgICAgICAgLy8gJ2F1ZGlvL21wZWcnIHRyYWNrIHVuZGVyIFNhZmFyaSBtYXkgY2F1c2UgTWVkaWFFbGVtZW50J3MgZHVyYXRpb24gdG8gYmUgTmFOXG4gICAgICAgICAgICAgICAgLy8gTWFudWFsbHkgY29ycmVjdCBNZWRpYVNvdXJjZS5kdXJhdGlvbiB0byBtYWtlIHByb2dyZXNzIGJhciBzZWVrYWJsZSwgYW5kIHJlcG9ydCByaWdodCBkdXJhdGlvblxuICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVpcmVTZXRNZWRpYUR1cmF0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nTWVkaWFEdXJhdGlvbiA9IGlzLm1lZGlhRHVyYXRpb24gLyAxMDAwOyAvLyBpbiBzZWNvbmRzXG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlTWVkaWFTb3VyY2VEdXJhdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhcHBlbmRNZWRpYVNlZ21lbnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXBwZW5kTWVkaWFTZWdtZW50KG1lZGlhU2VnbWVudCkge1xuICAgICAgICAgICAgdmFyIG1zID0gbWVkaWFTZWdtZW50O1xuICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1NlZ21lbnRzW21zLnR5cGVdLnB1c2gobXMpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fY29uZmlnLmF1dG9DbGVhbnVwU291cmNlQnVmZmVyICYmIHRoaXMuX25lZWRDbGVhbnVwU291cmNlQnVmZmVyKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kb0NsZWFudXBTb3VyY2VCdWZmZXIoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHNiID0gdGhpcy5fc291cmNlQnVmZmVyc1ttcy50eXBlXTtcbiAgICAgICAgICAgIGlmIChzYiAmJiAhc2IudXBkYXRpbmcgJiYgIXRoaXMuX2hhc1BlbmRpbmdSZW1vdmVSYW5nZXMoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2RvQXBwZW5kU2VnbWVudHMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc2VlaycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZWVrKHNlY29uZHMpIHtcbiAgICAgICAgICAgIC8vIHJlbW92ZSBhbGwgYXBwZW5kZWQgYnVmZmVyc1xuICAgICAgICAgICAgZm9yICh2YXIgdHlwZSBpbiB0aGlzLl9zb3VyY2VCdWZmZXJzKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9zb3VyY2VCdWZmZXJzW3R5cGVdKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGFib3J0IGN1cnJlbnQgYnVmZmVyIGFwcGVuZCBhbGdvcml0aG1cbiAgICAgICAgICAgICAgICB2YXIgc2IgPSB0aGlzLl9zb3VyY2VCdWZmZXJzW3R5cGVdO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYVNvdXJjZS5yZWFkeVN0YXRlID09PSAnb3BlbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHJhbmdlIHJlbW92YWwgYWxnb3JpdGhtIGlzIHJ1bm5pbmcsIEludmFsaWRTdGF0ZUVycm9yIHdpbGwgYmUgdGhyb3dlZFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWdub3JlIGl0LlxuICAgICAgICAgICAgICAgICAgICAgICAgc2IuYWJvcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZSh0aGlzLlRBRywgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBJRFJMaXN0IHNob3VsZCBiZSBjbGVhclxuICAgICAgICAgICAgICAgIHRoaXMuX2lkckxpc3QuY2xlYXIoKTtcblxuICAgICAgICAgICAgICAgIC8vIHBlbmRpbmcgc2VnbWVudHMgc2hvdWxkIGJlIGRpc2NhcmRcbiAgICAgICAgICAgICAgICB2YXIgcHMgPSB0aGlzLl9wZW5kaW5nU2VnbWVudHNbdHlwZV07XG4gICAgICAgICAgICAgICAgcHMuc3BsaWNlKDAsIHBzLmxlbmd0aCk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFTb3VyY2UucmVhZHlTdGF0ZSA9PT0gJ2Nsb3NlZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUGFyZW50IE1lZGlhU291cmNlIG9iamVjdCBoYXMgYmVlbiBkZXRhY2hlZCBmcm9tIEhUTUxNZWRpYUVsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gcmVjb3JkIHJhbmdlcyB0byBiZSByZW1vdmUgZnJvbSBTb3VyY2VCdWZmZXJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNiLmJ1ZmZlcmVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IHNiLmJ1ZmZlcmVkLnN0YXJ0KGkpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZW5kID0gc2IuYnVmZmVyZWQuZW5kKGkpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nUmVtb3ZlUmFuZ2VzW3R5cGVdLnB1c2goeyBzdGFydDogc3RhcnQsIGVuZDogZW5kIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGlmIHNiIGlzIG5vdCB1cGRhdGluZywgbGV0J3MgcmVtb3ZlIHJhbmdlcyBub3chXG4gICAgICAgICAgICAgICAgaWYgKCFzYi51cGRhdGluZykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kb1JlbW92ZVJhbmdlcygpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFNhZmFyaSAxMCBtYXkgZ2V0IEludmFsaWRTdGF0ZUVycm9yIGluIHRoZSBsYXRlciBhcHBlbmRCdWZmZXIoKSBhZnRlciBTb3VyY2VCdWZmZXIucmVtb3ZlKCkgY2FsbFxuICAgICAgICAgICAgICAgIC8vIEludGVybmFsIHBhcnNlcidzIHN0YXRlIG1heSBiZSBpbnZhbGlkIGF0IHRoaXMgdGltZS4gUmUtYXBwZW5kIGxhc3QgSW5pdFNlZ21lbnQgdG8gd29ya2Fyb3VuZC5cbiAgICAgICAgICAgICAgICAvLyBSZWxhdGVkIGlzc3VlOiBodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTU5MjMwXG4gICAgICAgICAgICAgICAgaWYgKF9icm93c2VyMi5kZWZhdWx0LnNhZmFyaSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGFzdEluaXRTZWdtZW50ID0gdGhpcy5fbGFzdEluaXRTZWdtZW50c1t0eXBlXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxhc3RJbml0U2VnbWVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1NlZ21lbnRzW3R5cGVdLnB1c2gobGFzdEluaXRTZWdtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2IudXBkYXRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kb0FwcGVuZFNlZ21lbnRzKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2VuZE9mU3RyZWFtJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGVuZE9mU3RyZWFtKCkge1xuICAgICAgICAgICAgdmFyIG1zID0gdGhpcy5fbWVkaWFTb3VyY2U7XG4gICAgICAgICAgICB2YXIgc2IgPSB0aGlzLl9zb3VyY2VCdWZmZXJzO1xuICAgICAgICAgICAgaWYgKCFtcyB8fCBtcy5yZWFkeVN0YXRlICE9PSAnb3BlbicpIHtcbiAgICAgICAgICAgICAgICBpZiAobXMgJiYgbXMucmVhZHlTdGF0ZSA9PT0gJ2Nsb3NlZCcgJiYgdGhpcy5faGFzUGVuZGluZ1NlZ21lbnRzKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgTWVkaWFTb3VyY2UgaGFzbid0IHR1cm5lZCBpbnRvIG9wZW4gc3RhdGUsIGFuZCB0aGVyZSdyZSBwZW5kaW5nIHNlZ21lbnRzXG4gICAgICAgICAgICAgICAgICAgIC8vIE1hcmsgcGVuZGluZyBlbmRPZlN0cmVhbSwgZGVmZXIgY2FsbCB1bnRpbCBhbGwgcGVuZGluZyBzZWdtZW50cyBhcHBlbmRlZCBjb21wbGV0ZVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYXNQZW5kaW5nRW9zID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNiLnZpZGVvICYmIHNiLnZpZGVvLnVwZGF0aW5nIHx8IHNiLmF1ZGlvICYmIHNiLmF1ZGlvLnVwZGF0aW5nKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgYW55IHNvdXJjZWJ1ZmZlciBpcyB1cGRhdGluZywgZGVmZXIgZW5kT2ZTdHJlYW0gb3BlcmF0aW9uXG4gICAgICAgICAgICAgICAgLy8gU2VlIF9vblNvdXJjZUJ1ZmZlclVwZGF0ZUVuZCgpXG4gICAgICAgICAgICAgICAgdGhpcy5faGFzUGVuZGluZ0VvcyA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX2hhc1BlbmRpbmdFb3MgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAvLyBOb3RpZnkgbWVkaWEgZGF0YSBsb2FkaW5nIGNvbXBsZXRlXG4gICAgICAgICAgICAgICAgLy8gVGhpcyBpcyBoZWxwZnVsIGZvciBjb3JyZWN0aW5nIHRvdGFsIGR1cmF0aW9uIHRvIG1hdGNoIGxhc3QgbWVkaWEgc2VnbWVudFxuICAgICAgICAgICAgICAgIC8vIE90aGVyd2lzZSBNZWRpYUVsZW1lbnQncyBlbmRlZCBldmVudCBtYXkgbm90IGJlIHRyaWdnZXJlZFxuICAgICAgICAgICAgICAgIG1zLmVuZE9mU3RyZWFtKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2dldE5lYXJlc3RLZXlmcmFtZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXROZWFyZXN0S2V5ZnJhbWUoZHRzKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faWRyTGlzdC5nZXRMYXN0U3luY1BvaW50QmVmb3JlRHRzKGR0cyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19uZWVkQ2xlYW51cFNvdXJjZUJ1ZmZlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfbmVlZENsZWFudXBTb3VyY2VCdWZmZXIoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2NvbmZpZy5hdXRvQ2xlYW51cFNvdXJjZUJ1ZmZlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lID0gdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lO1xuXG4gICAgICAgICAgICBmb3IgKHZhciB0eXBlIGluIHRoaXMuX3NvdXJjZUJ1ZmZlcnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2IgPSB0aGlzLl9zb3VyY2VCdWZmZXJzW3R5cGVdO1xuICAgICAgICAgICAgICAgIGlmIChzYikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYnVmZmVyZWQgPSBzYi5idWZmZXJlZDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGJ1ZmZlcmVkLmxlbmd0aCA+PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFRpbWUgLSBidWZmZXJlZC5zdGFydCgwKSA+PSB0aGlzLl9jb25maWcuYXV0b0NsZWFudXBNYXhCYWNrd2FyZER1cmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2RvQ2xlYW51cFNvdXJjZUJ1ZmZlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZG9DbGVhbnVwU291cmNlQnVmZmVyKCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lID0gdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lO1xuXG4gICAgICAgICAgICBmb3IgKHZhciB0eXBlIGluIHRoaXMuX3NvdXJjZUJ1ZmZlcnMpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2IgPSB0aGlzLl9zb3VyY2VCdWZmZXJzW3R5cGVdO1xuICAgICAgICAgICAgICAgIGlmIChzYikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYnVmZmVyZWQgPSBzYi5idWZmZXJlZDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRvUmVtb3ZlID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBidWZmZXJlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gYnVmZmVyZWQuc3RhcnQoaSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW5kID0gYnVmZmVyZWQuZW5kKGkpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhcnQgPD0gY3VycmVudFRpbWUgJiYgY3VycmVudFRpbWUgPCBlbmQgKyAzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGFkZGluZyAzIHNlY29uZHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFRpbWUgLSBzdGFydCA+PSB0aGlzLl9jb25maWcuYXV0b0NsZWFudXBNYXhCYWNrd2FyZER1cmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvUmVtb3ZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbW92ZUVuZCA9IGN1cnJlbnRUaW1lIC0gdGhpcy5fY29uZmlnLmF1dG9DbGVhbnVwTWluQmFja3dhcmREdXJhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1JlbW92ZVJhbmdlc1t0eXBlXS5wdXNoKHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IHJlbW92ZUVuZCB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVuZCA8IGN1cnJlbnRUaW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9SZW1vdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdSZW1vdmVSYW5nZXNbdHlwZV0ucHVzaCh7IHN0YXJ0OiBzdGFydCwgZW5kOiBlbmQgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoZG9SZW1vdmUgJiYgIXNiLnVwZGF0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kb1JlbW92ZVJhbmdlcygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfdXBkYXRlTWVkaWFTb3VyY2VEdXJhdGlvbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfdXBkYXRlTWVkaWFTb3VyY2VEdXJhdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBzYiA9IHRoaXMuX3NvdXJjZUJ1ZmZlcnM7XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50LnJlYWR5U3RhdGUgPT09IDAgfHwgdGhpcy5fbWVkaWFTb3VyY2UucmVhZHlTdGF0ZSAhPT0gJ29wZW4nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNiLnZpZGVvICYmIHNiLnZpZGVvLnVwZGF0aW5nIHx8IHNiLmF1ZGlvICYmIHNiLmF1ZGlvLnVwZGF0aW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgY3VycmVudCA9IHRoaXMuX21lZGlhU291cmNlLmR1cmF0aW9uO1xuICAgICAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMuX3BlbmRpbmdNZWRpYUR1cmF0aW9uO1xuXG4gICAgICAgICAgICBpZiAodGFyZ2V0ID4gMCAmJiAoaXNOYU4oY3VycmVudCkgfHwgdGFyZ2V0ID4gY3VycmVudCkpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYodGhpcy5UQUcsICdVcGRhdGUgTWVkaWFTb3VyY2UgZHVyYXRpb24gZnJvbSAnICsgY3VycmVudCArICcgdG8gJyArIHRhcmdldCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFTb3VyY2UuZHVyYXRpb24gPSB0YXJnZXQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3JlcXVpcmVTZXRNZWRpYUR1cmF0aW9uID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9wZW5kaW5nTWVkaWFEdXJhdGlvbiA9IDA7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19kb1JlbW92ZVJhbmdlcycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZG9SZW1vdmVSYW5nZXMoKSB7XG4gICAgICAgICAgICBmb3IgKHZhciB0eXBlIGluIHRoaXMuX3BlbmRpbmdSZW1vdmVSYW5nZXMpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3NvdXJjZUJ1ZmZlcnNbdHlwZV0gfHwgdGhpcy5fc291cmNlQnVmZmVyc1t0eXBlXS51cGRhdGluZykge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHNiID0gdGhpcy5fc291cmNlQnVmZmVyc1t0eXBlXTtcbiAgICAgICAgICAgICAgICB2YXIgcmFuZ2VzID0gdGhpcy5fcGVuZGluZ1JlbW92ZVJhbmdlc1t0eXBlXTtcbiAgICAgICAgICAgICAgICB3aGlsZSAocmFuZ2VzLmxlbmd0aCAmJiAhc2IudXBkYXRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlID0gcmFuZ2VzLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgIHNiLnJlbW92ZShyYW5nZS5zdGFydCwgcmFuZ2UuZW5kKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19kb0FwcGVuZFNlZ21lbnRzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9kb0FwcGVuZFNlZ21lbnRzKCkge1xuICAgICAgICAgICAgdmFyIHBlbmRpbmdTZWdtZW50cyA9IHRoaXMuX3BlbmRpbmdTZWdtZW50cztcblxuICAgICAgICAgICAgZm9yICh2YXIgdHlwZSBpbiBwZW5kaW5nU2VnbWVudHMpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3NvdXJjZUJ1ZmZlcnNbdHlwZV0gfHwgdGhpcy5fc291cmNlQnVmZmVyc1t0eXBlXS51cGRhdGluZykge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAocGVuZGluZ1NlZ21lbnRzW3R5cGVdLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlZ21lbnQgPSBwZW5kaW5nU2VnbWVudHNbdHlwZV0uc2hpZnQoKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoc2VnbWVudC50aW1lc3RhbXBPZmZzZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvciBNUEVHIGF1ZGlvIHN0cmVhbSBpbiBNU0UsIGlmIHVuYnVmZmVyZWQtc2Vla2luZyBvY2N1cnJlZFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2UgbmVlZCBleHBsaWNpdGx5IHNldCB0aW1lc3RhbXBPZmZzZXQgdG8gdGhlIGRlc2lyZWQgcG9pbnQgaW4gdGltZWxpbmUgZm9yIG1wZWcgU291cmNlQnVmZmVyLlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRPZmZzZXQgPSB0aGlzLl9zb3VyY2VCdWZmZXJzW3R5cGVdLnRpbWVzdGFtcE9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRPZmZzZXQgPSBzZWdtZW50LnRpbWVzdGFtcE9mZnNldCAvIDEwMDA7IC8vIGluIHNlY29uZHNcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRlbHRhID0gTWF0aC5hYnMoY3VycmVudE9mZnNldCAtIHRhcmdldE9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVsdGEgPiAwLjEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aW1lIGRlbHRhID4gMTAwbXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYodGhpcy5UQUcsICdVcGRhdGUgTVBFRyBhdWRpbyB0aW1lc3RhbXBPZmZzZXQgZnJvbSAnICsgY3VycmVudE9mZnNldCArICcgdG8gJyArIHRhcmdldE9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc291cmNlQnVmZmVyc1t0eXBlXS50aW1lc3RhbXBPZmZzZXQgPSB0YXJnZXRPZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxldGUgc2VnbWVudC50aW1lc3RhbXBPZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoIXNlZ21lbnQuZGF0YSB8fCBzZWdtZW50LmRhdGEuYnl0ZUxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWdub3JlIGVtcHR5IGJ1ZmZlclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc291cmNlQnVmZmVyc1t0eXBlXS5hcHBlbmRCdWZmZXIoc2VnbWVudC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2lzQnVmZmVyRnVsbCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGUgPT09ICd2aWRlbycgJiYgc2VnbWVudC5oYXNPd25Qcm9wZXJ0eSgnaW5mbycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faWRyTGlzdC5hcHBlbmRBcnJheShzZWdtZW50LmluZm8uc3luY1BvaW50cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nU2VnbWVudHNbdHlwZV0udW5zaGlmdChzZWdtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlcnJvci5jb2RlID09PSAyMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFF1b3RhRXhjZWVkZWRFcnJvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIE5vdGljZSB0aGF0IEZpcmVGb3ggbWF5IG5vdCB0aHJvdyBRdW90YUV4Y2VlZGVkRXJyb3IgaWYgU291cmNlQnVmZmVyIGlzIGZ1bGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEN1cnJlbnRseSB3ZSBjYW4gb25seSBkbyBsYXp5LWxvYWQgdG8gYXZvaWQgU291cmNlQnVmZmVyIGJlY29tZSBzY2F0dGVyZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTb3VyY2VCdWZmZXIgZXZpY3Rpb24gcG9saWN5IG1heSBiZSBjaGFuZ2VkIGluIGZ1dHVyZSB2ZXJzaW9uIG9mIEZpcmVGb3guXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICogUmVsYXRlZCBpc3N1ZXM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD0xMjc5ODg1XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBodHRwczovL2J1Z3ppbGxhLm1vemlsbGEub3JnL3Nob3dfYnVnLmNnaT9pZD0xMjgwMDIzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlcG9ydCBidWZmZXIgZnVsbCwgYWJvcnQgbmV0d29yayBJT1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5faXNCdWZmZXJGdWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfbXNlRXZlbnRzMi5kZWZhdWx0LkJVRkZFUl9GVUxMKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faXNCdWZmZXJGdWxsID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lKHRoaXMuVEFHLCBlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX21zZUV2ZW50czIuZGVmYXVsdC5FUlJPUiwgeyBjb2RlOiBlcnJvci5jb2RlLCBtc2c6IGVycm9yLm1lc3NhZ2UgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblNvdXJjZU9wZW4nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uU291cmNlT3BlbigpIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudih0aGlzLlRBRywgJ01lZGlhU291cmNlIG9uU291cmNlT3BlbicpO1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFTb3VyY2UucmVtb3ZlRXZlbnRMaXN0ZW5lcignc291cmNlb3BlbicsIHRoaXMuZS5vblNvdXJjZU9wZW4pO1xuICAgICAgICAgICAgLy8gZGVmZXJyZWQgc291cmNlYnVmZmVyIGNyZWF0aW9uIC8gaW5pdGlhbGl6YXRpb25cbiAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nU291cmNlQnVmZmVySW5pdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBlbmRpbmdzID0gdGhpcy5fcGVuZGluZ1NvdXJjZUJ1ZmZlckluaXQ7XG4gICAgICAgICAgICAgICAgd2hpbGUgKHBlbmRpbmdzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2VnbWVudCA9IHBlbmRpbmdzLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYXBwZW5kSW5pdFNlZ21lbnQoc2VnbWVudCwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gdGhlcmUgbWF5IGJlIHNvbWUgcGVuZGluZyBtZWRpYSBzZWdtZW50cywgYXBwZW5kIHRoZW1cbiAgICAgICAgICAgIGlmICh0aGlzLl9oYXNQZW5kaW5nU2VnbWVudHMoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2RvQXBwZW5kU2VnbWVudHMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfbXNlRXZlbnRzMi5kZWZhdWx0LlNPVVJDRV9PUEVOKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uU291cmNlRW5kZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uU291cmNlRW5kZWQoKSB7XG4gICAgICAgICAgICAvLyBmaXJlZCBvbiBlbmRPZlN0cmVhbVxuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KHRoaXMuVEFHLCAnTWVkaWFTb3VyY2Ugb25Tb3VyY2VFbmRlZCcpO1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF9tc2VFdmVudHMyLmRlZmF1bHQuU09VUkNFX0VORCwgJ01lZGlhU291cmNlIG9uU291cmNlRW5kZWQnKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uU291cmNlQ2xvc2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uU291cmNlQ2xvc2UoKSB7XG4gICAgICAgICAgICAvLyBmaXJlZCBvbiBkZXRhY2hpbmcgZnJvbSBtZWRpYSBlbGVtZW50XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYodGhpcy5UQUcsICdNZWRpYVNvdXJjZSBvblNvdXJjZUNsb3NlJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFTb3VyY2UgJiYgdGhpcy5lICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYVNvdXJjZS5yZW1vdmVFdmVudExpc3RlbmVyKCdzb3VyY2VvcGVuJywgdGhpcy5lLm9uU291cmNlT3Blbik7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFTb3VyY2UucmVtb3ZlRXZlbnRMaXN0ZW5lcignc291cmNlZW5kZWQnLCB0aGlzLmUub25Tb3VyY2VFbmRlZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFTb3VyY2UucmVtb3ZlRXZlbnRMaXN0ZW5lcignc291cmNlY2xvc2UnLCB0aGlzLmUub25Tb3VyY2VDbG9zZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19oYXNQZW5kaW5nU2VnbWVudHMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2hhc1BlbmRpbmdTZWdtZW50cygpIHtcbiAgICAgICAgICAgIHZhciBwcyA9IHRoaXMuX3BlbmRpbmdTZWdtZW50cztcbiAgICAgICAgICAgIHJldHVybiBwcy52aWRlby5sZW5ndGggPiAwIHx8IHBzLmF1ZGlvLmxlbmd0aCA+IDA7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19oYXNQZW5kaW5nUmVtb3ZlUmFuZ2VzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9oYXNQZW5kaW5nUmVtb3ZlUmFuZ2VzKCkge1xuICAgICAgICAgICAgdmFyIHByciA9IHRoaXMuX3BlbmRpbmdSZW1vdmVSYW5nZXM7XG4gICAgICAgICAgICByZXR1cm4gcHJyLnZpZGVvLmxlbmd0aCA+IDAgfHwgcHJyLmF1ZGlvLmxlbmd0aCA+IDA7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblNvdXJjZUJ1ZmZlclVwZGF0ZUVuZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Tb3VyY2VCdWZmZXJVcGRhdGVFbmQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fcmVxdWlyZVNldE1lZGlhRHVyYXRpb24pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl91cGRhdGVNZWRpYVNvdXJjZUR1cmF0aW9uKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2hhc1BlbmRpbmdSZW1vdmVSYW5nZXMoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2RvUmVtb3ZlUmFuZ2VzKCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2hhc1BlbmRpbmdTZWdtZW50cygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZG9BcHBlbmRTZWdtZW50cygpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9oYXNQZW5kaW5nRW9zKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbmRPZlN0cmVhbSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF9tc2VFdmVudHMyLmRlZmF1bHQuVVBEQVRFX0VORCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblNvdXJjZUJ1ZmZlckVycm9yJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblNvdXJjZUJ1ZmZlckVycm9yKGUpIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZSh0aGlzLlRBRywgJ1NvdXJjZUJ1ZmZlciBFcnJvcjogJyArIGUpO1xuICAgICAgICAgICAgLy8gdGhpcyBlcnJvciBtaWdodCBub3QgYWx3YXlzIGJlIGZhdGFsLCBqdXN0IGlnbm9yZSBpdFxuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIE1TRUNvbnRyb2xsZXI7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IE1TRUNvbnRyb2xsZXI7XG5cbn0se1wiLi4vdXRpbHMvYnJvd3Nlci5qc1wiOjM5LFwiLi4vdXRpbHMvZXhjZXB0aW9uLmpzXCI6NDAsXCIuLi91dGlscy9sb2dnZXIuanNcIjo0MSxcIi4vbWVkaWEtc2VnbWVudC1pbmZvLmpzXCI6OCxcIi4vbXNlLWV2ZW50cy5qc1wiOjEwLFwiZXZlbnRzXCI6Mn1dLDEwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbnZhciBNU0VFdmVudHMgPSB7XG4gIEVSUk9SOiAnZXJyb3InLFxuICBTT1VSQ0VfT1BFTjogJ3NvdXJjZV9vcGVuJyxcbiAgVVBEQVRFX0VORDogJ3VwZGF0ZV9lbmQnLFxuICBCVUZGRVJfRlVMTDogJ2J1ZmZlcl9mdWxsJyxcbiAgU09VUkNFX0VORDogJ3NvdXJjZV9lbmQnXG59O1xuXG5leHBvcnRzLmRlZmF1bHQgPSBNU0VFdmVudHM7XG5cbn0se31dLDExOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9ldmVudHMgPSBfZGVyZXFfKCdldmVudHMnKTtcblxudmFyIF9ldmVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXZlbnRzKTtcblxudmFyIF9sb2dnZXIgPSBfZGVyZXFfKCcuLi91dGlscy9sb2dnZXIuanMnKTtcblxudmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTtcblxudmFyIF9sb2dnaW5nQ29udHJvbCA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZ2dpbmctY29udHJvbC5qcycpO1xuXG52YXIgX2xvZ2dpbmdDb250cm9sMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dpbmdDb250cm9sKTtcblxudmFyIF90cmFuc211eGluZ0NvbnRyb2xsZXIgPSBfZGVyZXFfKCcuL3RyYW5zbXV4aW5nLWNvbnRyb2xsZXIuanMnKTtcblxudmFyIF90cmFuc211eGluZ0NvbnRyb2xsZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHJhbnNtdXhpbmdDb250cm9sbGVyKTtcblxudmFyIF90cmFuc211eGluZ0V2ZW50cyA9IF9kZXJlcV8oJy4vdHJhbnNtdXhpbmctZXZlbnRzLmpzJyk7XG5cbnZhciBfdHJhbnNtdXhpbmdFdmVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHJhbnNtdXhpbmdFdmVudHMpO1xuXG52YXIgX3RyYW5zbXV4aW5nV29ya2VyID0gX2RlcmVxXygnLi90cmFuc211eGluZy13b3JrZXIuanMnKTtcblxudmFyIF90cmFuc211eGluZ1dvcmtlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90cmFuc211eGluZ1dvcmtlcik7XG5cbnZhciBfbWVkaWFJbmZvID0gX2RlcmVxXygnLi9tZWRpYS1pbmZvLmpzJyk7XG5cbnZhciBfbWVkaWFJbmZvMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21lZGlhSW5mbyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBUcmFuc211eGVyID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFRyYW5zbXV4ZXIobWVkaWFEYXRhU291cmNlLCBjb25maWcpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRyYW5zbXV4ZXIpO1xuXG4gICAgICAgIHRoaXMuVEFHID0gJ1RyYW5zbXV4ZXInO1xuICAgICAgICB0aGlzLl9lbWl0dGVyID0gbmV3IF9ldmVudHMyLmRlZmF1bHQoKTtcblxuICAgICAgICBpZiAoY29uZmlnLmVuYWJsZVdvcmtlciAmJiB0eXBlb2YgV29ya2VyICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgd29yayA9IF9kZXJlcV8oJ3dlYndvcmtpZnknKTtcbiAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXIgPSB3b3JrKF90cmFuc211eGluZ1dvcmtlcjIuZGVmYXVsdCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyRGVzdHJveWluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlci5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5fb25Xb3JrZXJNZXNzYWdlLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlci5wb3N0TWVzc2FnZSh7IGNtZDogJ2luaXQnLCBwYXJhbTogW21lZGlhRGF0YVNvdXJjZSwgY29uZmlnXSB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLmUgPSB7XG4gICAgICAgICAgICAgICAgICAgIG9uTG9nZ2luZ0NvbmZpZ0NoYW5nZWQ6IHRoaXMuX29uTG9nZ2luZ0NvbmZpZ0NoYW5nZWQuYmluZCh0aGlzKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgX2xvZ2dpbmdDb250cm9sMi5kZWZhdWx0LnJlZ2lzdGVyTGlzdGVuZXIodGhpcy5lLm9uTG9nZ2luZ0NvbmZpZ0NoYW5nZWQpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlci5wb3N0TWVzc2FnZSh7IGNtZDogJ2xvZ2dpbmdfY29uZmlnJywgcGFyYW06IF9sb2dnaW5nQ29udHJvbDIuZGVmYXVsdC5nZXRDb25maWcoKSB9KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lKHRoaXMuVEFHLCAnRXJyb3Igd2hpbGUgaW5pdGlhbGl6ZSB0cmFuc211eGluZyB3b3JrZXIsIGZhbGxiYWNrIHRvIGlubGluZSB0cmFuc211eGluZycpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29udHJvbGxlciA9IG5ldyBfdHJhbnNtdXhpbmdDb250cm9sbGVyMi5kZWZhdWx0KG1lZGlhRGF0YVNvdXJjZSwgY29uZmlnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xsZXIgPSBuZXcgX3RyYW5zbXV4aW5nQ29udHJvbGxlcjIuZGVmYXVsdChtZWRpYURhdGFTb3VyY2UsIGNvbmZpZyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5fY29udHJvbGxlcikge1xuICAgICAgICAgICAgdmFyIGN0bCA9IHRoaXMuX2NvbnRyb2xsZXI7XG4gICAgICAgICAgICBjdGwub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LklPX0VSUk9SLCB0aGlzLl9vbklPRXJyb3IuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICBjdGwub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LkRFTVVYX0VSUk9SLCB0aGlzLl9vbkRlbXV4RXJyb3IuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICBjdGwub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LklOSVRfU0VHTUVOVCwgdGhpcy5fb25Jbml0U2VnbWVudC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGN0bC5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVESUFfU0VHTUVOVCwgdGhpcy5fb25NZWRpYVNlZ21lbnQuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICBjdGwub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LkxPQURJTkdfQ09NUExFVEUsIHRoaXMuX29uTG9hZGluZ0NvbXBsZXRlLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgY3RsLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5SRUNPVkVSRURfRUFSTFlfRU9GLCB0aGlzLl9vblJlY292ZXJlZEVhcmx5RW9mLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgY3RsLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRURJQV9JTkZPLCB0aGlzLl9vbk1lZGlhSW5mby5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGN0bC5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVUQURBVEFfQVJSSVZFRCwgdGhpcy5fb25NZXRhRGF0YUFycml2ZWQuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICBjdGwub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNDUklQVERBVEFfQVJSSVZFRCwgdGhpcy5fb25TY3JpcHREYXRhQXJyaXZlZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGN0bC5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU1RBVElTVElDU19JTkZPLCB0aGlzLl9vblN0YXRpc3RpY3NJbmZvLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgY3RsLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5SRUNPTU1FTkRfU0VFS1BPSU5ULCB0aGlzLl9vblJlY29tbWVuZFNlZWtwb2ludC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGN0bC5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU1RSRUFNX1RJTUUsIHRoaXMuX29uU3RyZWFtVGltZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhUcmFuc211eGVyLCBbe1xuICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fd29ya2VyKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl93b3JrZXJEZXN0cm95aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlckRlc3Ryb3lpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXIucG9zdE1lc3NhZ2UoeyBjbWQ6ICdkZXN0cm95JyB9KTtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dpbmdDb250cm9sMi5kZWZhdWx0LnJlbW92ZUxpc3RlbmVyKHRoaXMuZS5vbkxvZ2dpbmdDb25maWdDaGFuZ2VkKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xsZXIuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xsZXIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIgPSBudWxsO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbihldmVudCwgbGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuYWRkTGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb2ZmJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9mZihldmVudCwgbGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIucmVtb3ZlTGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnaGFzV29ya2VyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGhhc1dvcmtlcigpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl93b3JrZXIgIT0gbnVsbDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb3BlbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3dvcmtlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlci5wb3N0TWVzc2FnZSh7IGNtZDogJ3N0YXJ0JyB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29udHJvbGxlci5zdGFydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdjbG9zZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9zZSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl93b3JrZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXIucG9zdE1lc3NhZ2UoeyBjbWQ6ICdzdG9wJyB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29udHJvbGxlci5zdG9wKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3NlZWsnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2VlayhtaWxsaXNlY29uZHMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl93b3JrZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXIucG9zdE1lc3NhZ2UoeyBjbWQ6ICdzZWVrJywgcGFyYW06IG1pbGxpc2Vjb25kcyB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29udHJvbGxlci5zZWVrKG1pbGxpc2Vjb25kcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3BhdXNlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3dvcmtlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlci5wb3N0TWVzc2FnZSh7IGNtZDogJ3BhdXNlJyB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY29udHJvbGxlci5wYXVzZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZXN1bWUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVzdW1lKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3dvcmtlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlci5wb3N0TWVzc2FnZSh7IGNtZDogJ3Jlc3VtZScgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xsZXIucmVzdW1lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbkluaXRTZWdtZW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkluaXRTZWdtZW50KHR5cGUsIGluaXRTZWdtZW50KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICAgICAgICAvLyBkbyBhc3luYyBpbnZva2VcbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LklOSVRfU0VHTUVOVCwgdHlwZSwgaW5pdFNlZ21lbnQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbk1lZGlhU2VnbWVudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25NZWRpYVNlZ21lbnQodHlwZSwgbWVkaWFTZWdtZW50KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMyLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FRElBX1NFR01FTlQsIHR5cGUsIG1lZGlhU2VnbWVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uTG9hZGluZ0NvbXBsZXRlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkxvYWRpbmdDb21wbGV0ZSgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpczMuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTE9BRElOR19DT01QTEVURSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uUmVjb3ZlcmVkRWFybHlFb2YnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVjb3ZlcmVkRWFybHlFb2YoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXM0ID0gdGhpcztcblxuICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXM0Ll9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlJFQ09WRVJFRF9FQVJMWV9FT0YpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbk1lZGlhSW5mbycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25NZWRpYUluZm8obWVkaWFJbmZvKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXM1ID0gdGhpcztcblxuICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXM1Ll9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FRElBX0lORk8sIG1lZGlhSW5mbyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uTWV0YURhdGFBcnJpdmVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbk1ldGFEYXRhQXJyaXZlZChtZXRhZGF0YSkge1xuICAgICAgICAgICAgdmFyIF90aGlzNiA9IHRoaXM7XG5cbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzNi5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRVRBREFUQV9BUlJJVkVELCBtZXRhZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uU2NyaXB0RGF0YUFycml2ZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uU2NyaXB0RGF0YUFycml2ZWQoZGF0YSkge1xuICAgICAgICAgICAgdmFyIF90aGlzNyA9IHRoaXM7XG5cbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzNy5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TQ1JJUFREQVRBX0FSUklWRUQsIGRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblN0YXRpc3RpY3NJbmZvJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblN0YXRpc3RpY3NJbmZvKHN0YXRpc3RpY3NJbmZvKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXM4ID0gdGhpcztcblxuICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXM4Ll9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNUQVRJU1RJQ1NfSU5GTywgc3RhdGlzdGljc0luZm8pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbklPRXJyb3InLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uSU9FcnJvcih0eXBlLCBpbmZvKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXM5ID0gdGhpcztcblxuICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXM5Ll9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LklPX0VSUk9SLCB0eXBlLCBpbmZvKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25EZW11eEVycm9yJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkRlbXV4RXJyb3IodHlwZSwgaW5mbykge1xuICAgICAgICAgICAgdmFyIF90aGlzMTAgPSB0aGlzO1xuXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpczEwLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LkRFTVVYX0VSUk9SLCB0eXBlLCBpbmZvKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25SZWNvbW1lbmRTZWVrcG9pbnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVjb21tZW5kU2Vla3BvaW50KG1pbGxpc2Vjb25kcykge1xuICAgICAgICAgICAgdmFyIF90aGlzMTEgPSB0aGlzO1xuXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpczExLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlJFQ09NTUVORF9TRUVLUE9JTlQsIG1pbGxpc2Vjb25kcyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uU3RyZWFtVGltZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25TdHJlYW1UaW1lKHRpbWUpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczEyID0gdGhpcztcblxuICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMxMi5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TVFJFQU1fVElNRSwgdGltZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uTG9nZ2luZ0NvbmZpZ0NoYW5nZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uTG9nZ2luZ0NvbmZpZ0NoYW5nZWQoY29uZmlnKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fd29ya2VyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyLnBvc3RNZXNzYWdlKHsgY21kOiAnbG9nZ2luZ19jb25maWcnLCBwYXJhbTogY29uZmlnIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Xb3JrZXJNZXNzYWdlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbldvcmtlck1lc3NhZ2UoZSkge1xuICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBlLmRhdGE7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IG1lc3NhZ2UuZGF0YTtcblxuICAgICAgICAgICAgaWYgKG1lc3NhZ2UubXNnID09PSAnZGVzdHJveWVkJyB8fCB0aGlzLl93b3JrZXJEZXN0cm95aW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyRGVzdHJveWluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlci50ZXJtaW5hdGUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgc3dpdGNoIChtZXNzYWdlLm1zZykge1xuICAgICAgICAgICAgICAgIGNhc2UgX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LklOSVRfU0VHTUVOVDpcbiAgICAgICAgICAgICAgICBjYXNlIF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRURJQV9TRUdNRU5UOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQobWVzc2FnZS5tc2csIGRhdGEudHlwZSwgZGF0YS5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTE9BRElOR19DT01QTEVURTpcbiAgICAgICAgICAgICAgICBjYXNlIF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5SRUNPVkVSRURfRUFSTFlfRU9GOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQobWVzc2FnZS5tc2cpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRURJQV9JTkZPOlxuICAgICAgICAgICAgICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YoZGF0YSwgX21lZGlhSW5mbzIuZGVmYXVsdC5wcm90b3R5cGUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQobWVzc2FnZS5tc2csIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRVRBREFUQV9BUlJJVkVEOlxuICAgICAgICAgICAgICAgIGNhc2UgX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNDUklQVERBVEFfQVJSSVZFRDpcbiAgICAgICAgICAgICAgICBjYXNlIF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TVEFUSVNUSUNTX0lORk86XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChtZXNzYWdlLm1zZywgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LklPX0VSUk9SOlxuICAgICAgICAgICAgICAgIGNhc2UgX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LkRFTVVYX0VSUk9SOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQobWVzc2FnZS5tc2csIGRhdGEudHlwZSwgZGF0YS5pbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuUkVDT01NRU5EX1NFRUtQT0lOVDpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KG1lc3NhZ2UubXNnLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnbG9nY2F0X2NhbGxiYWNrJzpcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lbWl0dGVyLmVtaXQoJ2xvZycsIGRhdGEudHlwZSwgZGF0YS5sb2djYXQpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBUcmFuc211eGVyO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBUcmFuc211eGVyO1xuXG59LHtcIi4uL3V0aWxzL2xvZ2dlci5qc1wiOjQxLFwiLi4vdXRpbHMvbG9nZ2luZy1jb250cm9sLmpzXCI6NDIsXCIuL21lZGlhLWluZm8uanNcIjo3LFwiLi90cmFuc211eGluZy1jb250cm9sbGVyLmpzXCI6MTIsXCIuL3RyYW5zbXV4aW5nLWV2ZW50cy5qc1wiOjEzLFwiLi90cmFuc211eGluZy13b3JrZXIuanNcIjoxNCxcImV2ZW50c1wiOjIsXCJ3ZWJ3b3JraWZ5XCI6NH1dLDEyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9ldmVudHMgPSBfZGVyZXFfKCdldmVudHMnKTtcblxudmFyIF9ldmVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXZlbnRzKTtcblxudmFyIF9sb2dnZXIgPSBfZGVyZXFfKCcuLi91dGlscy9sb2dnZXIuanMnKTtcblxudmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTtcblxudmFyIF9icm93c2VyID0gX2RlcmVxXygnLi4vdXRpbHMvYnJvd3Nlci5qcycpO1xuXG52YXIgX2Jyb3dzZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYnJvd3Nlcik7XG5cbnZhciBfbWVkaWFJbmZvID0gX2RlcmVxXygnLi9tZWRpYS1pbmZvLmpzJyk7XG5cbnZhciBfbWVkaWFJbmZvMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21lZGlhSW5mbyk7XG5cbnZhciBfZmx2RGVtdXhlciA9IF9kZXJlcV8oJy4uL2RlbXV4L2Zsdi1kZW11eGVyLmpzJyk7XG5cbnZhciBfZmx2RGVtdXhlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9mbHZEZW11eGVyKTtcblxudmFyIF9tcDRSZW11eGVyID0gX2RlcmVxXygnLi4vcmVtdXgvbXA0LXJlbXV4ZXIuanMnKTtcblxudmFyIF9tcDRSZW11eGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21wNFJlbXV4ZXIpO1xuXG52YXIgX2RlbXV4RXJyb3JzID0gX2RlcmVxXygnLi4vZGVtdXgvZGVtdXgtZXJyb3JzLmpzJyk7XG5cbnZhciBfZGVtdXhFcnJvcnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZGVtdXhFcnJvcnMpO1xuXG52YXIgX2lvQ29udHJvbGxlciA9IF9kZXJlcV8oJy4uL2lvL2lvLWNvbnRyb2xsZXIuanMnKTtcblxudmFyIF9pb0NvbnRyb2xsZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaW9Db250cm9sbGVyKTtcblxudmFyIF90cmFuc211eGluZ0V2ZW50cyA9IF9kZXJlcV8oJy4vdHJhbnNtdXhpbmctZXZlbnRzLmpzJyk7XG5cbnZhciBfdHJhbnNtdXhpbmdFdmVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHJhbnNtdXhpbmdFdmVudHMpO1xuXG52YXIgX2xvYWRlciA9IF9kZXJlcV8oJy4uL2lvL2xvYWRlci5qcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vLyBUcmFuc211eGluZyAoSU8sIERlbXV4aW5nLCBSZW11eGluZykgY29udHJvbGxlciwgd2l0aCBtdWx0aXBhcnQgc3VwcG9ydFxudmFyIFRyYW5zbXV4aW5nQ29udHJvbGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBUcmFuc211eGluZ0NvbnRyb2xsZXIobWVkaWFEYXRhU291cmNlLCBjb25maWcpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRyYW5zbXV4aW5nQ29udHJvbGxlcik7XG5cbiAgICAgICAgdGhpcy5UQUcgPSAnVHJhbnNtdXhpbmdDb250cm9sbGVyJztcbiAgICAgICAgdGhpcy5fZW1pdHRlciA9IG5ldyBfZXZlbnRzMi5kZWZhdWx0KCk7XG5cbiAgICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuXG4gICAgICAgIC8vIHRyZWF0IHNpbmdsZSBwYXJ0IG1lZGlhIGFzIG11bHRpcGFydCBtZWRpYSwgd2hpY2ggaGFzIG9ubHkgb25lIHNlZ21lbnRcbiAgICAgICAgaWYgKCFtZWRpYURhdGFTb3VyY2Uuc2VnbWVudHMpIHtcbiAgICAgICAgICAgIG1lZGlhRGF0YVNvdXJjZS5zZWdtZW50cyA9IFt7XG4gICAgICAgICAgICAgICAgZHVyYXRpb246IG1lZGlhRGF0YVNvdXJjZS5kdXJhdGlvbixcbiAgICAgICAgICAgICAgICBmaWxlc2l6ZTogbWVkaWFEYXRhU291cmNlLmZpbGVzaXplLFxuICAgICAgICAgICAgICAgIHVybDogbWVkaWFEYXRhU291cmNlLnVybFxuICAgICAgICAgICAgfV07XG4gICAgICAgIH1cblxuICAgICAgICAvLyBmaWxsIGluIGRlZmF1bHQgSU8gcGFyYW1zIGlmIG5vdCBleGlzdHNcbiAgICAgICAgaWYgKHR5cGVvZiBtZWRpYURhdGFTb3VyY2UuY29ycyAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICBtZWRpYURhdGFTb3VyY2UuY29ycyA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBtZWRpYURhdGFTb3VyY2Uud2l0aENyZWRlbnRpYWxzICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgIG1lZGlhRGF0YVNvdXJjZS53aXRoQ3JlZGVudGlhbHMgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX21lZGlhRGF0YVNvdXJjZSA9IG1lZGlhRGF0YVNvdXJjZTtcbiAgICAgICAgdGhpcy5fY3VycmVudFNlZ21lbnRJbmRleCA9IDA7XG4gICAgICAgIHZhciB0b3RhbER1cmF0aW9uID0gMDtcblxuICAgICAgICB0aGlzLl9tZWRpYURhdGFTb3VyY2Uuc2VnbWVudHMuZm9yRWFjaChmdW5jdGlvbiAoc2VnbWVudCkge1xuICAgICAgICAgICAgLy8gdGltZXN0YW1wQmFzZSBmb3IgZWFjaCBzZWdtZW50LCBhbmQgY2FsY3VsYXRlIHRvdGFsIGR1cmF0aW9uXG4gICAgICAgICAgICBzZWdtZW50LnRpbWVzdGFtcEJhc2UgPSB0b3RhbER1cmF0aW9uO1xuICAgICAgICAgICAgdG90YWxEdXJhdGlvbiArPSBzZWdtZW50LmR1cmF0aW9uO1xuICAgICAgICAgICAgLy8gcGFyYW1zIG5lZWRlZCBieSBJT0NvbnRyb2xsZXJcbiAgICAgICAgICAgIHNlZ21lbnQuY29ycyA9IG1lZGlhRGF0YVNvdXJjZS5jb3JzO1xuICAgICAgICAgICAgc2VnbWVudC53aXRoQ3JlZGVudGlhbHMgPSBtZWRpYURhdGFTb3VyY2Uud2l0aENyZWRlbnRpYWxzO1xuICAgICAgICAgICAgLy8gcmVmZXJyZXIgcG9saWN5IGNvbnRyb2wsIGlmIGV4aXN0XG4gICAgICAgICAgICBpZiAoY29uZmlnLnJlZmVycmVyUG9saWN5KSB7XG4gICAgICAgICAgICAgICAgc2VnbWVudC5yZWZlcnJlclBvbGljeSA9IGNvbmZpZy5yZWZlcnJlclBvbGljeTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFpc05hTih0b3RhbER1cmF0aW9uKSAmJiB0aGlzLl9tZWRpYURhdGFTb3VyY2UuZHVyYXRpb24gIT09IHRvdGFsRHVyYXRpb24pIHtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhRGF0YVNvdXJjZS5kdXJhdGlvbiA9IHRvdGFsRHVyYXRpb247XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9tZWRpYUluZm8gPSBudWxsO1xuICAgICAgICB0aGlzLl9kZW11eGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcmVtdXhlciA9IG51bGw7XG4gICAgICAgIHRoaXMuX2lvY3RsID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9wZW5kaW5nU2Vla1RpbWUgPSBudWxsO1xuICAgICAgICB0aGlzLl9wZW5kaW5nUmVzb2x2ZVNlZWtQb2ludCA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5fc3RhdGlzdGljc1JlcG9ydGVyID0gbnVsbDtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoVHJhbnNtdXhpbmdDb250cm9sbGVyLCBbe1xuICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8gPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFEYXRhU291cmNlID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXRpc3RpY3NSZXBvcnRlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Rpc2FibGVTdGF0aXN0aWNzUmVwb3J0ZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9pb2N0bCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2lvY3RsLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9pb2N0bCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fZGVtdXhlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX3JlbXV4ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW11eGVyLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW11eGVyID0gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIgPSBudWxsO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbihldmVudCwgbGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuYWRkTGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb2ZmJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9mZihldmVudCwgbGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIucmVtb3ZlTGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc3RhcnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3RhcnQoKSB7XG4gICAgICAgICAgICB0aGlzLl9sb2FkU2VnbWVudCgwKTtcbiAgICAgICAgICAgIHRoaXMuX2VuYWJsZVN0YXRpc3RpY3NSZXBvcnRlcigpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfbG9hZFNlZ21lbnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2xvYWRTZWdtZW50KHNlZ21lbnRJbmRleCwgb3B0aW9uYWxGcm9tKSB7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50U2VnbWVudEluZGV4ID0gc2VnbWVudEluZGV4O1xuICAgICAgICAgICAgdmFyIGRhdGFTb3VyY2UgPSB0aGlzLl9tZWRpYURhdGFTb3VyY2Uuc2VnbWVudHNbc2VnbWVudEluZGV4XTtcblxuICAgICAgICAgICAgdmFyIGlvY3RsID0gdGhpcy5faW9jdGwgPSBuZXcgX2lvQ29udHJvbGxlcjIuZGVmYXVsdChkYXRhU291cmNlLCB0aGlzLl9jb25maWcsIHNlZ21lbnRJbmRleCk7XG4gICAgICAgICAgICBpb2N0bC5vbkVycm9yID0gdGhpcy5fb25JT0V4Y2VwdGlvbi5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgaW9jdGwub25TZWVrZWQgPSB0aGlzLl9vbklPU2Vla2VkLmJpbmQodGhpcyk7XG4gICAgICAgICAgICBpb2N0bC5vbkNvbXBsZXRlID0gdGhpcy5fb25JT0NvbXBsZXRlLmJpbmQodGhpcyk7XG4gICAgICAgICAgICBpb2N0bC5vblJlZGlyZWN0ID0gdGhpcy5fb25JT1JlZGlyZWN0LmJpbmQodGhpcyk7XG4gICAgICAgICAgICBpb2N0bC5vblJlY292ZXJlZEVhcmx5RW9mID0gdGhpcy5fb25JT1JlY292ZXJlZEVhcmx5RW9mLmJpbmQodGhpcyk7XG5cbiAgICAgICAgICAgIGlmIChvcHRpb25hbEZyb20pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyLmJpbmREYXRhU291cmNlKHRoaXMuX2lvY3RsKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaW9jdGwub25EYXRhQXJyaXZhbCA9IHRoaXMuX29uSW5pdENodW5rQXJyaXZhbC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpb2N0bC5vcGVuKG9wdGlvbmFsRnJvbSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3N0b3AnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3RvcCgpIHtcbiAgICAgICAgICAgIHRoaXMuX2ludGVybmFsQWJvcnQoKTtcbiAgICAgICAgICAgIHRoaXMuX2Rpc2FibGVTdGF0aXN0aWNzUmVwb3J0ZXIoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2ludGVybmFsQWJvcnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2ludGVybmFsQWJvcnQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5faW9jdGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pb2N0bC5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5faW9jdGwgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwYXVzZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICAgICAgICAgIC8vIHRha2UgYSByZXN0XG4gICAgICAgICAgICBpZiAodGhpcy5faW9jdGwgJiYgdGhpcy5faW9jdGwuaXNXb3JraW5nKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pb2N0bC5wYXVzZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2Rpc2FibGVTdGF0aXN0aWNzUmVwb3J0ZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVzdW1lJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlc3VtZSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9pb2N0bCAmJiB0aGlzLl9pb2N0bC5pc1BhdXNlZCgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faW9jdGwucmVzdW1lKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZW5hYmxlU3RhdGlzdGljc1JlcG9ydGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3NlZWsnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2VlayhtaWxsaXNlY29uZHMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUluZm8gPT0gbnVsbCB8fCAhdGhpcy5fbWVkaWFJbmZvLmlzU2Vla2FibGUoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHRhcmdldFNlZ21lbnRJbmRleCA9IHRoaXMuX3NlYXJjaFNlZ21lbnRJbmRleENvbnRhaW5zKG1pbGxpc2Vjb25kcyk7XG5cbiAgICAgICAgICAgIGlmICh0YXJnZXRTZWdtZW50SW5kZXggPT09IHRoaXMuX2N1cnJlbnRTZWdtZW50SW5kZXgpIHtcbiAgICAgICAgICAgICAgICAvLyBpbnRyYS1zZWdtZW50IHNlZWtpbmdcbiAgICAgICAgICAgICAgICB2YXIgc2VnbWVudEluZm8gPSB0aGlzLl9tZWRpYUluZm8uc2VnbWVudHNbdGFyZ2V0U2VnbWVudEluZGV4XTtcblxuICAgICAgICAgICAgICAgIGlmIChzZWdtZW50SW5mbyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY3VycmVudCBzZWdtZW50IGxvYWRpbmcgc3RhcnRlZCwgYnV0IG1lZGlhaW5mbyBoYXNuJ3QgcmVjZWl2ZWQgeWV0XG4gICAgICAgICAgICAgICAgICAgIC8vIHdhaXQgZm9yIHRoZSBtZXRhZGF0YSBsb2FkZWQsIHRoZW4gc2VlayB0byBleHBlY3RlZCBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nU2Vla1RpbWUgPSBtaWxsaXNlY29uZHM7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGtleWZyYW1lID0gc2VnbWVudEluZm8uZ2V0TmVhcmVzdEtleWZyYW1lKG1pbGxpc2Vjb25kcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbXV4ZXIuc2VlayhrZXlmcmFtZS5taWxsaXNlY29uZHMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9pb2N0bC5zZWVrKGtleWZyYW1lLmZpbGVwb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdpbGwgYmUgcmVzb2x2ZWQgaW4gX29uUmVtdXhlck1lZGlhU2VnbWVudEFycml2YWwoKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nUmVzb2x2ZVNlZWtQb2ludCA9IGtleWZyYW1lLm1pbGxpc2Vjb25kcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGNyb3NzLXNlZ21lbnQgc2Vla2luZ1xuICAgICAgICAgICAgICAgIHZhciB0YXJnZXRTZWdtZW50SW5mbyA9IHRoaXMuX21lZGlhSW5mby5zZWdtZW50c1t0YXJnZXRTZWdtZW50SW5kZXhdO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRhcmdldFNlZ21lbnRJbmZvID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyB0YXJnZXQgc2VnbWVudCBoYXNuJ3QgYmVlbiBsb2FkZWQuIFdlIG5lZWQgbWV0YWRhdGEgdGhlbiBzZWVrIHRvIGV4cGVjdGVkIHRpbWVcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1NlZWtUaW1lID0gbWlsbGlzZWNvbmRzO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbnRlcm5hbEFib3J0KCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbXV4ZXIuc2VlaygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW11eGVyLmluc2VydERpc2NvbnRpbnVpdHkoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbG9hZFNlZ21lbnQodGFyZ2V0U2VnbWVudEluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgLy8gSGVyZSB3ZSB3YWl0IGZvciB0aGUgbWV0YWRhdGEgbG9hZGVkLCB0aGVuIHNlZWsgdG8gZXhwZWN0ZWQgcG9zaXRpb25cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIHRhcmdldCBzZWdtZW50J3MgbWV0YWRhdGEsIGRpcmVjdCBzZWVrIHRvIHRhcmdldCBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICB2YXIgX2tleWZyYW1lID0gdGFyZ2V0U2VnbWVudEluZm8uZ2V0TmVhcmVzdEtleWZyYW1lKG1pbGxpc2Vjb25kcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2ludGVybmFsQWJvcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtdXhlci5zZWVrKG1pbGxpc2Vjb25kcyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbXV4ZXIuaW5zZXJ0RGlzY29udGludWl0eSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyLnJlc2V0TWVkaWFJbmZvKCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIudGltZXN0YW1wQmFzZSA9IHRoaXMuX21lZGlhRGF0YVNvdXJjZS5zZWdtZW50c1t0YXJnZXRTZWdtZW50SW5kZXhdLnRpbWVzdGFtcEJhc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRTZWdtZW50KHRhcmdldFNlZ21lbnRJbmRleCwgX2tleWZyYW1lLmZpbGVwb3NpdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdSZXNvbHZlU2Vla1BvaW50ID0gX2tleWZyYW1lLm1pbGxpc2Vjb25kcztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVwb3J0U2VnbWVudE1lZGlhSW5mbyh0YXJnZXRTZWdtZW50SW5kZXgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fZW5hYmxlU3RhdGlzdGljc1JlcG9ydGVyKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19zZWFyY2hTZWdtZW50SW5kZXhDb250YWlucycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfc2VhcmNoU2VnbWVudEluZGV4Q29udGFpbnMobWlsbGlzZWNvbmRzKSB7XG4gICAgICAgICAgICB2YXIgc2VnbWVudHMgPSB0aGlzLl9tZWRpYURhdGFTb3VyY2Uuc2VnbWVudHM7XG4gICAgICAgICAgICB2YXIgaWR4ID0gc2VnbWVudHMubGVuZ3RoIC0gMTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWdtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChtaWxsaXNlY29uZHMgPCBzZWdtZW50c1tpXS50aW1lc3RhbXBCYXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlkeCA9IGkgLSAxO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaWR4O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Jbml0Q2h1bmtBcnJpdmFsJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkluaXRDaHVua0Fycml2YWwoZGF0YSwgYnl0ZVN0YXJ0KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICAgICAgICB2YXIgcHJvYmVEYXRhID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBjb25zdW1lZCA9IDA7XG5cbiAgICAgICAgICAgIGlmIChieXRlU3RhcnQgPiAwKSB7XG4gICAgICAgICAgICAgICAgLy8gSU9Db250cm9sbGVyIHNlZWtlZCBpbW1lZGlhdGVseSBhZnRlciBvcGVuZWQsIGJ5dGVTdGFydCA+IDAgY2FsbGJhY2sgbWF5IHJlY2VpdmVkXG4gICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlci5iaW5kRGF0YVNvdXJjZSh0aGlzLl9pb2N0bCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlci50aW1lc3RhbXBCYXNlID0gdGhpcy5fbWVkaWFEYXRhU291cmNlLnNlZ21lbnRzW3RoaXMuX2N1cnJlbnRTZWdtZW50SW5kZXhdLnRpbWVzdGFtcEJhc2U7XG5cbiAgICAgICAgICAgICAgICBjb25zdW1lZCA9IHRoaXMuX2RlbXV4ZXIucGFyc2VDaHVua3MoZGF0YSwgYnl0ZVN0YXJ0KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoKHByb2JlRGF0YSA9IF9mbHZEZW11eGVyMi5kZWZhdWx0LnByb2JlKGRhdGEpKS5tYXRjaCkge1xuICAgICAgICAgICAgICAgIC8vIEFsd2F5cyBjcmVhdGUgbmV3IEZMVkRlbXV4ZXJcbiAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyID0gbmV3IF9mbHZEZW11eGVyMi5kZWZhdWx0KHByb2JlRGF0YSwgdGhpcy5fY29uZmlnKTtcblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fcmVtdXhlcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW11eGVyID0gbmV3IF9tcDRSZW11eGVyMi5kZWZhdWx0KHRoaXMuX2NvbmZpZyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIG1kcyA9IHRoaXMuX21lZGlhRGF0YVNvdXJjZTtcbiAgICAgICAgICAgICAgICBpZiAobWRzLmR1cmF0aW9uICE9IHVuZGVmaW5lZCAmJiAhaXNOYU4obWRzLmR1cmF0aW9uKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyLm92ZXJyaWRlZER1cmF0aW9uID0gbWRzLmR1cmF0aW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG1kcy5oYXNBdWRpbyA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIub3ZlcnJpZGVkSGFzQXVkaW8gPSBtZHMuaGFzQXVkaW87XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbWRzLmhhc1ZpZGVvID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlci5vdmVycmlkZWRIYXNWaWRlbyA9IG1kcy5oYXNWaWRlbztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyLnRpbWVzdGFtcEJhc2UgPSBtZHMuc2VnbWVudHNbdGhpcy5fY3VycmVudFNlZ21lbnRJbmRleF0udGltZXN0YW1wQmFzZTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIub25FcnJvciA9IHRoaXMuX29uRGVtdXhFeGNlcHRpb24uYmluZCh0aGlzKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyLm9uTWVkaWFJbmZvID0gdGhpcy5fb25NZWRpYUluZm8uYmluZCh0aGlzKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyLm9uTWV0YURhdGFBcnJpdmVkID0gdGhpcy5fb25NZXRhRGF0YUFycml2ZWQuYmluZCh0aGlzKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyLm9uU2NyaXB0RGF0YUFycml2ZWQgPSB0aGlzLl9vblNjcmlwdERhdGFBcnJpdmVkLmJpbmQodGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlci5vblN0cmVhbVRpbWUgPSB0aGlzLl9vblN0cmVhbVRpbWUuYmluZCh0aGlzKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbXV4ZXIuYmluZERhdGFTb3VyY2UodGhpcy5fZGVtdXhlci5iaW5kRGF0YVNvdXJjZSh0aGlzLl9pb2N0bCkpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVtdXhlci5vbkluaXRTZWdtZW50ID0gdGhpcy5fb25SZW11eGVySW5pdFNlZ21lbnRBcnJpdmFsLmJpbmQodGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVtdXhlci5vbk1lZGlhU2VnbWVudCA9IHRoaXMuX29uUmVtdXhlck1lZGlhU2VnbWVudEFycml2YWwuYmluZCh0aGlzKTtcblxuICAgICAgICAgICAgICAgIGNvbnN1bWVkID0gdGhpcy5fZGVtdXhlci5wYXJzZUNodW5rcyhkYXRhLCBieXRlU3RhcnQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcm9iZURhdGEgPSBudWxsO1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZSh0aGlzLlRBRywgJ05vbi1GTFYsIFVuc3VwcG9ydGVkIG1lZGlhIHR5cGUhJyk7XG4gICAgICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLl9pbnRlcm5hbEFib3J0KCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5ERU1VWF9FUlJPUiwgX2RlbXV4RXJyb3JzMi5kZWZhdWx0LkZPUk1BVF9VTlNVUFBPUlRFRCwgJ05vbi1GTFYsIFVuc3VwcG9ydGVkIG1lZGlhIHR5cGUnKTtcblxuICAgICAgICAgICAgICAgIGNvbnN1bWVkID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGNvbnN1bWVkO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25NZWRpYUluZm8nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uTWVkaWFJbmZvKG1lZGlhSW5mbykge1xuICAgICAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUluZm8gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIC8vIFN0b3JlIGZpcnN0IHNlZ21lbnQncyBtZWRpYWluZm8gYXMgZ2xvYmFsIG1lZGlhSW5mb1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mbyA9IE9iamVjdC5hc3NpZ24oe30sIG1lZGlhSW5mbyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmtleWZyYW1lc0luZGV4ID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uc2VnbWVudHMgPSBbXTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uc2VnbWVudENvdW50ID0gdGhpcy5fbWVkaWFEYXRhU291cmNlLnNlZ21lbnRzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcy5fbWVkaWFJbmZvLCBfbWVkaWFJbmZvMi5kZWZhdWx0LnByb3RvdHlwZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzZWdtZW50SW5mbyA9IE9iamVjdC5hc3NpZ24oe30sIG1lZGlhSW5mbyk7XG4gICAgICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc2VnbWVudEluZm8sIF9tZWRpYUluZm8yLmRlZmF1bHQucHJvdG90eXBlKTtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5zZWdtZW50c1t0aGlzLl9jdXJyZW50U2VnbWVudEluZGV4XSA9IHNlZ21lbnRJbmZvO1xuXG4gICAgICAgICAgICAvLyBub3RpZnkgbWVkaWFJbmZvIHVwZGF0ZVxuICAgICAgICAgICAgdGhpcy5fcmVwb3J0U2VnbWVudE1lZGlhSW5mbyh0aGlzLl9jdXJyZW50U2VnbWVudEluZGV4KTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX3BlbmRpbmdTZWVrVGltZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBfdGhpczIuX3BlbmRpbmdTZWVrVGltZTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLl9wZW5kaW5nU2Vla1RpbWUgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBfdGhpczIuc2Vlayh0YXJnZXQpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25NZXRhRGF0YUFycml2ZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uTWV0YURhdGFBcnJpdmVkKG1ldGFkYXRhKSB7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FVEFEQVRBX0FSUklWRUQsIG1ldGFkYXRhKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uU2NyaXB0RGF0YUFycml2ZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uU2NyaXB0RGF0YUFycml2ZWQoZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TQ1JJUFREQVRBX0FSUklWRUQsIGRhdGEpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25TdHJlYW1UaW1lJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblN0cmVhbVRpbWUodGltZSkge1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TVFJFQU1fVElNRSwgdGltZSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbklPU2Vla2VkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbklPU2Vla2VkKCkge1xuICAgICAgICAgICAgdGhpcy5fcmVtdXhlci5pbnNlcnREaXNjb250aW51aXR5KCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbklPQ29tcGxldGUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uSU9Db21wbGV0ZShleHRyYURhdGEpIHtcbiAgICAgICAgICAgIHZhciBzZWdtZW50SW5kZXggPSBleHRyYURhdGE7XG4gICAgICAgICAgICB2YXIgbmV4dFNlZ21lbnRJbmRleCA9IHNlZ21lbnRJbmRleCArIDE7XG5cbiAgICAgICAgICAgIGlmIChuZXh0U2VnbWVudEluZGV4IDwgdGhpcy5fbWVkaWFEYXRhU291cmNlLnNlZ21lbnRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2ludGVybmFsQWJvcnQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZW11eGVyLmZsdXNoU3Rhc2hlZFNhbXBsZXMoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9sb2FkU2VnbWVudChuZXh0U2VnbWVudEluZGV4KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVtdXhlci5mbHVzaFN0YXNoZWRTYW1wbGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5MT0FESU5HX0NPTVBMRVRFKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXNhYmxlU3RhdGlzdGljc1JlcG9ydGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbklPUmVkaXJlY3QnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uSU9SZWRpcmVjdChyZWRpcmVjdGVkVVJMKSB7XG4gICAgICAgICAgICB2YXIgc2VnbWVudEluZGV4ID0gdGhpcy5faW9jdGwuZXh0cmFEYXRhO1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFEYXRhU291cmNlLnNlZ21lbnRzW3NlZ21lbnRJbmRleF0ucmVkaXJlY3RlZFVSTCA9IHJlZGlyZWN0ZWRVUkw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbklPUmVjb3ZlcmVkRWFybHlFb2YnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uSU9SZWNvdmVyZWRFYXJseUVvZigpIHtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuUkVDT1ZFUkVEX0VBUkxZX0VPRik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbklPRXhjZXB0aW9uJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbklPRXhjZXB0aW9uKHR5cGUsIGluZm8pIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZSh0aGlzLlRBRywgJ0lPRXhjZXB0aW9uOiB0eXBlID0gJyArIHR5cGUgKyAnLCBjb2RlID0gJyArIGluZm8uY29kZSArICcsIG1zZyA9ICcgKyBpbmZvLm1zZyk7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LklPX0VSUk9SLCB0eXBlLCBpbmZvKTtcbiAgICAgICAgICAgIHRoaXMuX2Rpc2FibGVTdGF0aXN0aWNzUmVwb3J0ZXIoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uRGVtdXhFeGNlcHRpb24nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uRGVtdXhFeGNlcHRpb24odHlwZSwgaW5mbykge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lKHRoaXMuVEFHLCAnRGVtdXhFeGNlcHRpb246IHR5cGUgPSAnICsgdHlwZSArICcsIGluZm8gPSAnICsgaW5mbyk7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LkRFTVVYX0VSUk9SLCB0eXBlLCBpbmZvKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uUmVtdXhlckluaXRTZWdtZW50QXJyaXZhbCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZW11eGVySW5pdFNlZ21lbnRBcnJpdmFsKHR5cGUsIGluaXRTZWdtZW50KSB7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LklOSVRfU0VHTUVOVCwgdHlwZSwgaW5pdFNlZ21lbnQpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25SZW11eGVyTWVkaWFTZWdtZW50QXJyaXZhbCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZW11eGVyTWVkaWFTZWdtZW50QXJyaXZhbCh0eXBlLCBtZWRpYVNlZ21lbnQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nU2Vla1RpbWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIC8vIE1lZGlhIHNlZ21lbnRzIGFmdGVyIG5ldy1zZWdtZW50IGNyb3NzLXNlZWtpbmcgc2hvdWxkIGJlIGRyb3BwZWQuXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRURJQV9TRUdNRU5ULCB0eXBlLCBtZWRpYVNlZ21lbnQpO1xuXG4gICAgICAgICAgICAvLyBSZXNvbHZlIHBlbmRpbmcgc2Vla1BvaW50XG4gICAgICAgICAgICBpZiAodGhpcy5fcGVuZGluZ1Jlc29sdmVTZWVrUG9pbnQgIT0gbnVsbCAmJiB0eXBlID09PSAndmlkZW8nKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN5bmNQb2ludHMgPSBtZWRpYVNlZ21lbnQuaW5mby5zeW5jUG9pbnRzO1xuICAgICAgICAgICAgICAgIHZhciBzZWVrcG9pbnQgPSB0aGlzLl9wZW5kaW5nUmVzb2x2ZVNlZWtQb2ludDtcbiAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nUmVzb2x2ZVNlZWtQb2ludCA9IG51bGw7XG5cbiAgICAgICAgICAgICAgICAvLyBTYWZhcmk6IFBhc3MgUFRTIGZvciByZWNvbW1lbmRfc2Vla3BvaW50XG4gICAgICAgICAgICAgICAgaWYgKF9icm93c2VyMi5kZWZhdWx0LnNhZmFyaSAmJiBzeW5jUG9pbnRzLmxlbmd0aCA+IDAgJiYgc3luY1BvaW50c1swXS5vcmlnaW5hbER0cyA9PT0gc2Vla3BvaW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHNlZWtwb2ludCA9IHN5bmNQb2ludHNbMF0ucHRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBlbHNlOiB1c2Ugb3JpZ2luYWwgRFRTIChrZXlmcmFtZS5taWxsaXNlY29uZHMpXG5cbiAgICAgICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlJFQ09NTUVORF9TRUVLUE9JTlQsIHNlZWtwb2ludCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19lbmFibGVTdGF0aXN0aWNzUmVwb3J0ZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2VuYWJsZVN0YXRpc3RpY3NSZXBvcnRlcigpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGF0aXN0aWNzUmVwb3J0ZXIgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRpc3RpY3NSZXBvcnRlciA9IHNlbGYuc2V0SW50ZXJ2YWwodGhpcy5fcmVwb3J0U3RhdGlzdGljc0luZm8uYmluZCh0aGlzKSwgdGhpcy5fY29uZmlnLnN0YXRpc3RpY3NJbmZvUmVwb3J0SW50ZXJ2YWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfZGlzYWJsZVN0YXRpc3RpY3NSZXBvcnRlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZGlzYWJsZVN0YXRpc3RpY3NSZXBvcnRlcigpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGF0aXN0aWNzUmVwb3J0ZXIpIHtcbiAgICAgICAgICAgICAgICBzZWxmLmNsZWFySW50ZXJ2YWwodGhpcy5fc3RhdGlzdGljc1JlcG9ydGVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0aXN0aWNzUmVwb3J0ZXIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcmVwb3J0U2VnbWVudE1lZGlhSW5mbycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVwb3J0U2VnbWVudE1lZGlhSW5mbyhzZWdtZW50SW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBzZWdtZW50SW5mbyA9IHRoaXMuX21lZGlhSW5mby5zZWdtZW50c1tzZWdtZW50SW5kZXhdO1xuICAgICAgICAgICAgdmFyIGV4cG9ydEluZm8gPSBPYmplY3QuYXNzaWduKHt9LCBzZWdtZW50SW5mbyk7XG5cbiAgICAgICAgICAgIGV4cG9ydEluZm8uZHVyYXRpb24gPSB0aGlzLl9tZWRpYUluZm8uZHVyYXRpb247XG4gICAgICAgICAgICBleHBvcnRJbmZvLnNlZ21lbnRDb3VudCA9IHRoaXMuX21lZGlhSW5mby5zZWdtZW50Q291bnQ7XG4gICAgICAgICAgICBkZWxldGUgZXhwb3J0SW5mby5zZWdtZW50cztcbiAgICAgICAgICAgIGRlbGV0ZSBleHBvcnRJbmZvLmtleWZyYW1lc0luZGV4O1xuXG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FRElBX0lORk8sIGV4cG9ydEluZm8pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcmVwb3J0U3RhdGlzdGljc0luZm8nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3JlcG9ydFN0YXRpc3RpY3NJbmZvKCkge1xuICAgICAgICAgICAgdmFyIGluZm8gPSB7fTtcblxuICAgICAgICAgICAgaW5mby51cmwgPSB0aGlzLl9pb2N0bC5jdXJyZW50VVJMO1xuICAgICAgICAgICAgaW5mby5oYXNSZWRpcmVjdCA9IHRoaXMuX2lvY3RsLmhhc1JlZGlyZWN0O1xuICAgICAgICAgICAgaWYgKGluZm8uaGFzUmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICBpbmZvLnJlZGlyZWN0ZWRVUkwgPSB0aGlzLl9pb2N0bC5jdXJyZW50UmVkaXJlY3RlZFVSTDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaW5mby5zcGVlZCA9IHRoaXMuX2lvY3RsLmN1cnJlbnRTcGVlZDtcbiAgICAgICAgICAgIGluZm8ubG9hZGVyVHlwZSA9IHRoaXMuX2lvY3RsLmxvYWRlclR5cGU7XG4gICAgICAgICAgICBpbmZvLmN1cnJlbnRTZWdtZW50SW5kZXggPSB0aGlzLl9jdXJyZW50U2VnbWVudEluZGV4O1xuICAgICAgICAgICAgaW5mby50b3RhbFNlZ21lbnRDb3VudCA9IHRoaXMuX21lZGlhRGF0YVNvdXJjZS5zZWdtZW50cy5sZW5ndGg7XG5cbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU1RBVElTVElDU19JTkZPLCBpbmZvKTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBUcmFuc211eGluZ0NvbnRyb2xsZXI7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFRyYW5zbXV4aW5nQ29udHJvbGxlcjtcblxufSx7XCIuLi9kZW11eC9kZW11eC1lcnJvcnMuanNcIjoxNixcIi4uL2RlbXV4L2Zsdi1kZW11eGVyLmpzXCI6MTgsXCIuLi9pby9pby1jb250cm9sbGVyLmpzXCI6MjMsXCIuLi9pby9sb2FkZXIuanNcIjoyNCxcIi4uL3JlbXV4L21wNC1yZW11eGVyLmpzXCI6MzgsXCIuLi91dGlscy9icm93c2VyLmpzXCI6MzksXCIuLi91dGlscy9sb2dnZXIuanNcIjo0MSxcIi4vbWVkaWEtaW5mby5qc1wiOjcsXCIuL3RyYW5zbXV4aW5nLWV2ZW50cy5qc1wiOjEzLFwiZXZlbnRzXCI6Mn1dLDEzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbnZhciBUcmFuc211eGluZ0V2ZW50cyA9IHtcbiAgSU9fRVJST1I6ICdpb19lcnJvcicsXG4gIERFTVVYX0VSUk9SOiAnZGVtdXhfZXJyb3InLFxuICBJTklUX1NFR01FTlQ6ICdpbml0X3NlZ21lbnQnLFxuICBNRURJQV9TRUdNRU5UOiAnbWVkaWFfc2VnbWVudCcsXG4gIExPQURJTkdfQ09NUExFVEU6ICdsb2FkaW5nX2NvbXBsZXRlJyxcbiAgUkVDT1ZFUkVEX0VBUkxZX0VPRjogJ3JlY292ZXJlZF9lYXJseV9lb2YnLFxuICBNRURJQV9JTkZPOiAnbWVkaWFfaW5mbycsXG4gIE1FVEFEQVRBX0FSUklWRUQ6ICdtZXRhZGF0YV9hcnJpdmVkJyxcbiAgU0NSSVBUREFUQV9BUlJJVkVEOiAnc2NyaXB0ZGF0YV9hcnJpdmVkJyxcbiAgU1RBVElTVElDU19JTkZPOiAnc3RhdGlzdGljc19pbmZvJyxcbiAgUkVDT01NRU5EX1NFRUtQT0lOVDogJ3JlY29tbWVuZF9zZWVrcG9pbnQnLFxuICBTVFJFQU1fVElNRTogJ3N0cmVhbV90aW1lJ1xufTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gVHJhbnNtdXhpbmdFdmVudHM7XG5cbn0se31dLDE0OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2xvZ2dlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZ2dlci5qcycpO1xuXG52YXIgX2xvZ2dlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnZXIpO1xuXG52YXIgX2xvZ2dpbmdDb250cm9sID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nZ2luZy1jb250cm9sLmpzJyk7XG5cbnZhciBfbG9nZ2luZ0NvbnRyb2wyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2luZ0NvbnRyb2wpO1xuXG52YXIgX3BvbHlmaWxsID0gX2RlcmVxXygnLi4vdXRpbHMvcG9seWZpbGwuanMnKTtcblxudmFyIF9wb2x5ZmlsbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wb2x5ZmlsbCk7XG5cbnZhciBfdHJhbnNtdXhpbmdDb250cm9sbGVyID0gX2RlcmVxXygnLi90cmFuc211eGluZy1jb250cm9sbGVyLmpzJyk7XG5cbnZhciBfdHJhbnNtdXhpbmdDb250cm9sbGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RyYW5zbXV4aW5nQ29udHJvbGxlcik7XG5cbnZhciBfdHJhbnNtdXhpbmdFdmVudHMgPSBfZGVyZXFfKCcuL3RyYW5zbXV4aW5nLWV2ZW50cy5qcycpO1xuXG52YXIgX3RyYW5zbXV4aW5nRXZlbnRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RyYW5zbXV4aW5nRXZlbnRzKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuLyogcG9zdCBtZXNzYWdlIHRvIHdvcmtlcjpcclxuICAgZGF0YToge1xyXG4gICAgICAgY21kOiBzdHJpbmdcclxuICAgICAgIHBhcmFtOiBhbnlcclxuICAgfVxyXG5cclxuICAgcmVjZWl2ZSBtZXNzYWdlIGZyb20gd29ya2VyOlxyXG4gICBkYXRhOiB7XHJcbiAgICAgICBtc2c6IHN0cmluZyxcclxuICAgICAgIGRhdGE6IGFueVxyXG4gICB9XHJcbiAqL1xuXG52YXIgVHJhbnNtdXhpbmdXb3JrZXIgPSBmdW5jdGlvbiBUcmFuc211eGluZ1dvcmtlcihzZWxmKSB7XG5cbiAgICB2YXIgVEFHID0gJ1RyYW5zbXV4aW5nV29ya2VyJztcbiAgICB2YXIgY29udHJvbGxlciA9IG51bGw7XG4gICAgdmFyIGxvZ2NhdExpc3RlbmVyID0gb25Mb2djYXRDYWxsYmFjay5iaW5kKHRoaXMpO1xuXG4gICAgX3BvbHlmaWxsMi5kZWZhdWx0Lmluc3RhbGwoKTtcblxuICAgIHNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgIHN3aXRjaCAoZS5kYXRhLmNtZCkge1xuICAgICAgICAgICAgY2FzZSAnaW5pdCc6XG4gICAgICAgICAgICAgICAgY29udHJvbGxlciA9IG5ldyBfdHJhbnNtdXhpbmdDb250cm9sbGVyMi5kZWZhdWx0KGUuZGF0YS5wYXJhbVswXSwgZS5kYXRhLnBhcmFtWzFdKTtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5JT19FUlJPUiwgb25JT0Vycm9yLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LkRFTVVYX0VSUk9SLCBvbkRlbXV4RXJyb3IuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuSU5JVF9TRUdNRU5ULCBvbkluaXRTZWdtZW50LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FRElBX1NFR01FTlQsIG9uTWVkaWFTZWdtZW50LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LkxPQURJTkdfQ09NUExFVEUsIG9uTG9hZGluZ0NvbXBsZXRlLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlJFQ09WRVJFRF9FQVJMWV9FT0YsIG9uUmVjb3ZlcmVkRWFybHlFb2YuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVESUFfSU5GTywgb25NZWRpYUluZm8uYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVUQURBVEFfQVJSSVZFRCwgb25NZXRhRGF0YUFycml2ZWQuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU0NSSVBUREFUQV9BUlJJVkVELCBvblNjcmlwdERhdGFBcnJpdmVkLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNUQVRJU1RJQ1NfSU5GTywgb25TdGF0aXN0aWNzSW5mby5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5SRUNPTU1FTkRfU0VFS1BPSU5ULCBvblJlY29tbWVuZFNlZWtwb2ludC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2Rlc3Ryb3knOlxuICAgICAgICAgICAgICAgIGlmIChjb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7IG1zZzogJ2Rlc3Ryb3llZCcgfSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdzdGFydCc6XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5zdGFydCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnc3RvcCc6XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5zdG9wKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdzZWVrJzpcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLnNlZWsoZS5kYXRhLnBhcmFtKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3BhdXNlJzpcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLnBhdXNlKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdyZXN1bWUnOlxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIucmVzdW1lKCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdsb2dnaW5nX2NvbmZpZyc6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlnID0gZS5kYXRhLnBhcmFtO1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2luZ0NvbnRyb2wyLmRlZmF1bHQuYXBwbHlDb25maWcoY29uZmlnKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlnLmVuYWJsZUNhbGxiYWNrID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfbG9nZ2luZ0NvbnRyb2wyLmRlZmF1bHQuYWRkTG9nTGlzdGVuZXIobG9nY2F0TGlzdGVuZXIpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2xvZ2dpbmdDb250cm9sMi5kZWZhdWx0LnJlbW92ZUxvZ0xpc3RlbmVyKGxvZ2NhdExpc3RlbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIG9uSW5pdFNlZ21lbnQodHlwZSwgaW5pdFNlZ21lbnQpIHtcbiAgICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAgICAgIG1zZzogX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LklOSVRfU0VHTUVOVCxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgICAgICAgIGRhdGE6IGluaXRTZWdtZW50XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHNlbGYucG9zdE1lc3NhZ2Uob2JqLCBbaW5pdFNlZ21lbnQuZGF0YV0pOyAvLyBkYXRhOiBBcnJheUJ1ZmZlclxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uTWVkaWFTZWdtZW50KHR5cGUsIG1lZGlhU2VnbWVudCkge1xuICAgICAgICB2YXIgb2JqID0ge1xuICAgICAgICAgICAgbXNnOiBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVESUFfU0VHTUVOVCxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgICAgICAgIGRhdGE6IG1lZGlhU2VnbWVudFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKG9iaiwgW21lZGlhU2VnbWVudC5kYXRhXSk7IC8vIGRhdGE6IEFycmF5QnVmZmVyXG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25Mb2FkaW5nQ29tcGxldGUoKSB7XG4gICAgICAgIHZhciBvYmogPSB7XG4gICAgICAgICAgICBtc2c6IF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5MT0FESU5HX0NPTVBMRVRFXG4gICAgICAgIH07XG4gICAgICAgIHNlbGYucG9zdE1lc3NhZ2Uob2JqKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvblJlY292ZXJlZEVhcmx5RW9mKCkge1xuICAgICAgICB2YXIgb2JqID0ge1xuICAgICAgICAgICAgbXNnOiBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuUkVDT1ZFUkVEX0VBUkxZX0VPRlxuICAgICAgICB9O1xuICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKG9iaik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25NZWRpYUluZm8obWVkaWFJbmZvKSB7XG4gICAgICAgIHZhciBvYmogPSB7XG4gICAgICAgICAgICBtc2c6IF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRURJQV9JTkZPLFxuICAgICAgICAgICAgZGF0YTogbWVkaWFJbmZvXG4gICAgICAgIH07XG4gICAgICAgIHNlbGYucG9zdE1lc3NhZ2Uob2JqKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbk1ldGFEYXRhQXJyaXZlZChtZXRhZGF0YSkge1xuICAgICAgICB2YXIgb2JqID0ge1xuICAgICAgICAgICAgbXNnOiBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVUQURBVEFfQVJSSVZFRCxcbiAgICAgICAgICAgIGRhdGE6IG1ldGFkYXRhXG4gICAgICAgIH07XG4gICAgICAgIHNlbGYucG9zdE1lc3NhZ2Uob2JqKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvblNjcmlwdERhdGFBcnJpdmVkKGRhdGEpIHtcbiAgICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAgICAgIG1zZzogX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNDUklQVERBVEFfQVJSSVZFRCxcbiAgICAgICAgICAgIGRhdGE6IGRhdGFcbiAgICAgICAgfTtcbiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZShvYmopO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uU3RhdGlzdGljc0luZm8oc3RhdEluZm8pIHtcbiAgICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAgICAgIG1zZzogX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNUQVRJU1RJQ1NfSU5GTyxcbiAgICAgICAgICAgIGRhdGE6IHN0YXRJbmZvXG4gICAgICAgIH07XG4gICAgICAgIHNlbGYucG9zdE1lc3NhZ2Uob2JqKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbklPRXJyb3IodHlwZSwgaW5mbykge1xuICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgIG1zZzogX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LklPX0VSUk9SLFxuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgICAgICAgaW5mbzogaW5mb1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbkRlbXV4RXJyb3IodHlwZSwgaW5mbykge1xuICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgIG1zZzogX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LkRFTVVYX0VSUk9SLFxuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgICAgICAgaW5mbzogaW5mb1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvblJlY29tbWVuZFNlZWtwb2ludChtaWxsaXNlY29uZHMpIHtcbiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICBtc2c6IF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5SRUNPTU1FTkRfU0VFS1BPSU5ULFxuICAgICAgICAgICAgZGF0YTogbWlsbGlzZWNvbmRzXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uTG9nY2F0Q2FsbGJhY2sodHlwZSwgc3RyKSB7XG4gICAgICAgIHNlbGYucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgbXNnOiAnbG9nY2F0X2NhbGxiYWNrJyxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgICAgICAgIGxvZ2NhdDogc3RyXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbn07IC8qXHJcbiAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICpcclxuICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgKlxyXG4gICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgKlxyXG4gICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAqXHJcbiAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICovXG5cbmV4cG9ydHMuZGVmYXVsdCA9IFRyYW5zbXV4aW5nV29ya2VyO1xuXG59LHtcIi4uL3V0aWxzL2xvZ2dlci5qc1wiOjQxLFwiLi4vdXRpbHMvbG9nZ2luZy1jb250cm9sLmpzXCI6NDIsXCIuLi91dGlscy9wb2x5ZmlsbC5qc1wiOjQzLFwiLi90cmFuc211eGluZy1jb250cm9sbGVyLmpzXCI6MTIsXCIuL3RyYW5zbXV4aW5nLWV2ZW50cy5qc1wiOjEzfV0sMTU6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgX2xvZ2dlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZ2dlci5qcycpO1xuXG52YXIgX2xvZ2dlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnZXIpO1xuXG52YXIgX3V0ZjhDb252ID0gX2RlcmVxXygnLi4vdXRpbHMvdXRmOC1jb252LmpzJyk7XG5cbnZhciBfdXRmOENvbnYyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdXRmOENvbnYpO1xuXG52YXIgX2V4Y2VwdGlvbiA9IF9kZXJlcV8oJy4uL3V0aWxzL2V4Y2VwdGlvbi5qcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgbGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGJ1ZiA9IG5ldyBBcnJheUJ1ZmZlcigyKTtcbiAgICBuZXcgRGF0YVZpZXcoYnVmKS5zZXRJbnQxNigwLCAyNTYsIHRydWUpOyAvLyBsaXR0bGUtZW5kaWFuIHdyaXRlXG4gICAgcmV0dXJuIG5ldyBJbnQxNkFycmF5KGJ1ZilbMF0gPT09IDI1NjsgLy8gcGxhdGZvcm0tc3BlYyByZWFkLCBpZiBlcXVhbCB0aGVuIExFXG59KCk7XG5cbnZhciBBTUYgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQU1GKCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQU1GKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoQU1GLCBudWxsLCBbe1xuICAgICAgICBrZXk6ICdwYXJzZVNjcmlwdERhdGEnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGFyc2VTY3JpcHREYXRhKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSkge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB7fTtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IEFNRi5wYXJzZVZhbHVlKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSk7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gQU1GLnBhcnNlVmFsdWUoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyBuYW1lLnNpemUsIGRhdGFTaXplIC0gbmFtZS5zaXplKTtcblxuICAgICAgICAgICAgICAgIGRhdGFbbmFtZS5kYXRhXSA9IHZhbHVlLmRhdGE7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lKCdBTUYnLCBlLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncGFyc2VPYmplY3QnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGFyc2VPYmplY3QoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKSB7XG4gICAgICAgICAgICBpZiAoZGF0YVNpemUgPCAzKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCdEYXRhIG5vdCBlbm91Z2ggd2hlbiBwYXJzZSBTY3JpcHREYXRhT2JqZWN0Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbmFtZSA9IEFNRi5wYXJzZVN0cmluZyhhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpO1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gQU1GLnBhcnNlVmFsdWUoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyBuYW1lLnNpemUsIGRhdGFTaXplIC0gbmFtZS5zaXplKTtcbiAgICAgICAgICAgIHZhciBpc09iamVjdEVuZCA9IHZhbHVlLm9iamVjdEVuZDtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUuZGF0YSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHZhbHVlLmRhdGFcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHNpemU6IG5hbWUuc2l6ZSArIHZhbHVlLnNpemUsXG4gICAgICAgICAgICAgICAgb2JqZWN0RW5kOiBpc09iamVjdEVuZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncGFyc2VWYXJpYWJsZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXJzZVZhcmlhYmxlKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSkge1xuICAgICAgICAgICAgcmV0dXJuIEFNRi5wYXJzZU9iamVjdChhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwYXJzZVN0cmluZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXJzZVN0cmluZyhhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpIHtcbiAgICAgICAgICAgIGlmIChkYXRhU2l6ZSA8IDIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbGxlZ2FsU3RhdGVFeGNlcHRpb24oJ0RhdGEgbm90IGVub3VnaCB3aGVuIHBhcnNlIFN0cmluZycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHYgPSBuZXcgRGF0YVZpZXcoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKTtcbiAgICAgICAgICAgIHZhciBsZW5ndGggPSB2LmdldFVpbnQxNigwLCAhbGUpO1xuXG4gICAgICAgICAgICB2YXIgc3RyID0gdm9pZCAwO1xuICAgICAgICAgICAgaWYgKGxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBzdHIgPSAoMCwgX3V0ZjhDb252Mi5kZWZhdWx0KShuZXcgVWludDhBcnJheShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIDIsIGxlbmd0aCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdHIgPSAnJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkYXRhOiBzdHIsXG4gICAgICAgICAgICAgICAgc2l6ZTogMiArIGxlbmd0aFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncGFyc2VMb25nU3RyaW5nJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBhcnNlTG9uZ1N0cmluZyhhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpIHtcbiAgICAgICAgICAgIGlmIChkYXRhU2l6ZSA8IDQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbGxlZ2FsU3RhdGVFeGNlcHRpb24oJ0RhdGEgbm90IGVub3VnaCB3aGVuIHBhcnNlIExvbmdTdHJpbmcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2ID0gbmV3IERhdGFWaWV3KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSk7XG4gICAgICAgICAgICB2YXIgbGVuZ3RoID0gdi5nZXRVaW50MzIoMCwgIWxlKTtcblxuICAgICAgICAgICAgdmFyIHN0ciA9IHZvaWQgMDtcbiAgICAgICAgICAgIGlmIChsZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgc3RyID0gKDAsIF91dGY4Q29udjIuZGVmYXVsdCkobmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyA0LCBsZW5ndGgpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RyID0gJyc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZGF0YTogc3RyLFxuICAgICAgICAgICAgICAgIHNpemU6IDQgKyBsZW5ndGhcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3BhcnNlRGF0ZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXJzZURhdGUoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKSB7XG4gICAgICAgICAgICBpZiAoZGF0YVNpemUgPCAxMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbignRGF0YSBzaXplIGludmFsaWQgd2hlbiBwYXJzZSBEYXRlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdiA9IG5ldyBEYXRhVmlldyhhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpO1xuICAgICAgICAgICAgdmFyIHRpbWVzdGFtcCA9IHYuZ2V0RmxvYXQ2NCgwLCAhbGUpO1xuICAgICAgICAgICAgdmFyIGxvY2FsVGltZU9mZnNldCA9IHYuZ2V0SW50MTYoOCwgIWxlKTtcbiAgICAgICAgICAgIHRpbWVzdGFtcCArPSBsb2NhbFRpbWVPZmZzZXQgKiA2MCAqIDEwMDA7IC8vIGdldCBVVEMgdGltZVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGRhdGE6IG5ldyBEYXRlKHRpbWVzdGFtcCksXG4gICAgICAgICAgICAgICAgc2l6ZTogOCArIDJcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3BhcnNlVmFsdWUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGFyc2VWYWx1ZShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpIHtcbiAgICAgICAgICAgIGlmIChkYXRhU2l6ZSA8IDEpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbGxlZ2FsU3RhdGVFeGNlcHRpb24oJ0RhdGEgbm90IGVub3VnaCB3aGVuIHBhcnNlIFZhbHVlJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciB2ID0gbmV3IERhdGFWaWV3KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSk7XG5cbiAgICAgICAgICAgIHZhciBvZmZzZXQgPSAxO1xuICAgICAgICAgICAgdmFyIHR5cGUgPSB2LmdldFVpbnQ4KDApO1xuICAgICAgICAgICAgdmFyIHZhbHVlID0gdm9pZCAwO1xuICAgICAgICAgICAgdmFyIG9iamVjdEVuZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOdW1iZXIoRG91YmxlKSB0eXBlXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHYuZ2V0RmxvYXQ2NCgxLCAhbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDg7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJvb2xlYW4gdHlwZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gdi5nZXRVaW50OCgxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGIgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTdHJpbmcgdHlwZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbWZzdHIgPSBBTUYucGFyc2VTdHJpbmcoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyAxLCBkYXRhU2l6ZSAtIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gYW1mc3RyLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IGFtZnN0ci5zaXplO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gT2JqZWN0KHMpIHR5cGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXJtaW5hbCA9IDA7IC8vIHdvcmthcm91bmQgZm9yIG1hbGZvcm1lZCBPYmplY3RzIHdoaWNoIGhhcyBtaXNzaW5nIFNjcmlwdERhdGFPYmplY3RFbmRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoKHYuZ2V0VWludDMyKGRhdGFTaXplIC0gNCwgIWxlKSAmIDB4MDBGRkZGRkYpID09PSA5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlcm1pbmFsID0gMztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKG9mZnNldCA8IGRhdGFTaXplIC0gNCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyA0ID09PSB0eXBlKFVJOCkgKyBTY3JpcHREYXRhT2JqZWN0RW5kKFVJMjQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbWZvYmogPSBBTUYucGFyc2VPYmplY3QoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyBvZmZzZXQsIGRhdGFTaXplIC0gb2Zmc2V0IC0gdGVybWluYWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYW1mb2JqLm9iamVjdEVuZCkgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlW2FtZm9iai5kYXRhLm5hbWVdID0gYW1mb2JqLmRhdGEudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSBhbWZvYmouc2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9mZnNldCA8PSBkYXRhU2l6ZSAtIDMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hcmtlciA9IHYuZ2V0VWludDMyKG9mZnNldCAtIDEsICFsZSkgJiAweDAwRkZGRkZGO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFya2VyID09PSA5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gMztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEVDTUEgYXJyYXkgdHlwZSAoTWl4ZWQgYXJyYXkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gNDsgLy8gRUNNQUFycmF5TGVuZ3RoKFVJMzIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF90ZXJtaW5hbCA9IDA7IC8vIHdvcmthcm91bmQgZm9yIG1hbGZvcm1lZCBNaXhlZEFycmF5cyB3aGljaCBoYXMgbWlzc2luZyBTY3JpcHREYXRhT2JqZWN0RW5kXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh2LmdldFVpbnQzMihkYXRhU2l6ZSAtIDQsICFsZSkgJiAweDAwRkZGRkZGKSA9PT0gOSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGVybWluYWwgPSAzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSAob2Zmc2V0IDwgZGF0YVNpemUgLSA4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDggPT09IHR5cGUoVUk4KSArIEVDTUFBcnJheUxlbmd0aChVSTMyKSArIFNjcmlwdERhdGFWYXJpYWJsZUVuZChVSTI0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYW1mdmFyID0gQU1GLnBhcnNlVmFyaWFibGUoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyBvZmZzZXQsIGRhdGFTaXplIC0gb2Zmc2V0IC0gX3Rlcm1pbmFsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFtZnZhci5vYmplY3RFbmQpIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZVthbWZ2YXIuZGF0YS5uYW1lXSA9IGFtZnZhci5kYXRhLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gYW1mdmFyLnNpemU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvZmZzZXQgPD0gZGF0YVNpemUgLSAzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfbWFya2VyID0gdi5nZXRVaW50MzIob2Zmc2V0IC0gMSwgIWxlKSAmIDB4MDBGRkZGRkY7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfbWFya2VyID09PSA5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gMztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2NyaXB0RGF0YU9iamVjdEVuZFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0RW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0cmljdCBhcnJheSB0eXBlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2NyaXB0RGF0YVZhbHVlW25dLiBOT1RFOiBhY2NvcmRpbmcgdG8gdmlkZW9fZmlsZV9mb3JtYXRfc3BlY192MTBfMS5wZGZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdHJpY3RBcnJheUxlbmd0aCA9IHYuZ2V0VWludDMyKDEsICFsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHJpY3RBcnJheUxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2YWwgPSBBTUYucGFyc2VWYWx1ZShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIG9mZnNldCwgZGF0YVNpemUgLSBvZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZS5wdXNoKHZhbC5kYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IHZhbC5zaXplO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEYXRlIHR5cGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGF0ZSA9IEFNRi5wYXJzZURhdGUoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyAxLCBkYXRhU2l6ZSAtIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZGF0ZS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSBkYXRlLnNpemU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTG9uZyBzdHJpbmcgdHlwZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhbWZMb25nU3RyID0gQU1GLnBhcnNlU3RyaW5nKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgMSwgZGF0YVNpemUgLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGFtZkxvbmdTdHIuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gYW1mTG9uZ1N0ci5zaXplO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlIGFuZCBza2lwXG4gICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBkYXRhU2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudygnQU1GJywgJ1Vuc3VwcG9ydGVkIEFNRiB2YWx1ZSB0eXBlICcgKyB0eXBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lKCdBTUYnLCBlLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGRhdGE6IHZhbHVlLFxuICAgICAgICAgICAgICAgIHNpemU6IG9mZnNldCxcbiAgICAgICAgICAgICAgICBvYmplY3RFbmQ6IG9iamVjdEVuZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBBTUY7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEFNRjtcblxufSx7XCIuLi91dGlscy9leGNlcHRpb24uanNcIjo0MCxcIi4uL3V0aWxzL2xvZ2dlci5qc1wiOjQxLFwiLi4vdXRpbHMvdXRmOC1jb252LmpzXCI6NDR9XSwxNjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG52YXIgRGVtdXhFcnJvcnMgPSB7XG4gIE9LOiAnT0snLFxuICBGT1JNQVRfRVJST1I6ICdGb3JtYXRFcnJvcicsXG4gIEZPUk1BVF9VTlNVUFBPUlRFRDogJ0Zvcm1hdFVuc3VwcG9ydGVkJyxcbiAgQ09ERUNfVU5TVVBQT1JURUQ6ICdDb2RlY1Vuc3VwcG9ydGVkJ1xufTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gRGVtdXhFcnJvcnM7XG5cbn0se31dLDE3OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9leGNlcHRpb24gPSBfZGVyZXFfKCcuLi91dGlscy9leGNlcHRpb24uanMnKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLy8gRXhwb25lbnRpYWwtR29sb21iIGJ1ZmZlciBkZWNvZGVyXG52YXIgRXhwR29sb21iID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEV4cEdvbG9tYih1aW50OGFycmF5KSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBFeHBHb2xvbWIpO1xuXG4gICAgICAgIHRoaXMuVEFHID0gJ0V4cEdvbG9tYic7XG5cbiAgICAgICAgdGhpcy5fYnVmZmVyID0gdWludDhhcnJheTtcbiAgICAgICAgdGhpcy5fYnVmZmVyX2luZGV4ID0gMDtcbiAgICAgICAgdGhpcy5fdG90YWxfYnl0ZXMgPSB1aW50OGFycmF5LmJ5dGVMZW5ndGg7XG4gICAgICAgIHRoaXMuX3RvdGFsX2JpdHMgPSB1aW50OGFycmF5LmJ5dGVMZW5ndGggKiA4O1xuICAgICAgICB0aGlzLl9jdXJyZW50X3dvcmQgPSAwO1xuICAgICAgICB0aGlzLl9jdXJyZW50X3dvcmRfYml0c19sZWZ0ID0gMDtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoRXhwR29sb21iLCBbe1xuICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICB0aGlzLl9idWZmZXIgPSBudWxsO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfZmlsbEN1cnJlbnRXb3JkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9maWxsQ3VycmVudFdvcmQoKSB7XG4gICAgICAgICAgICB2YXIgYnVmZmVyX2J5dGVzX2xlZnQgPSB0aGlzLl90b3RhbF9ieXRlcyAtIHRoaXMuX2J1ZmZlcl9pbmRleDtcbiAgICAgICAgICAgIGlmIChidWZmZXJfYnl0ZXNfbGVmdCA8PSAwKSB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbGxlZ2FsU3RhdGVFeGNlcHRpb24oJ0V4cEdvbG9tYjogX2ZpbGxDdXJyZW50V29yZCgpIGJ1dCBubyBieXRlcyBhdmFpbGFibGUnKTtcblxuICAgICAgICAgICAgdmFyIGJ5dGVzX3JlYWQgPSBNYXRoLm1pbig0LCBidWZmZXJfYnl0ZXNfbGVmdCk7XG4gICAgICAgICAgICB2YXIgd29yZCA9IG5ldyBVaW50OEFycmF5KDQpO1xuICAgICAgICAgICAgd29yZC5zZXQodGhpcy5fYnVmZmVyLnN1YmFycmF5KHRoaXMuX2J1ZmZlcl9pbmRleCwgdGhpcy5fYnVmZmVyX2luZGV4ICsgYnl0ZXNfcmVhZCkpO1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudF93b3JkID0gbmV3IERhdGFWaWV3KHdvcmQuYnVmZmVyKS5nZXRVaW50MzIoMCwgZmFsc2UpO1xuXG4gICAgICAgICAgICB0aGlzLl9idWZmZXJfaW5kZXggKz0gYnl0ZXNfcmVhZDtcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRfd29yZF9iaXRzX2xlZnQgPSBieXRlc19yZWFkICogODtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVhZEJpdHMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVhZEJpdHMoYml0cykge1xuICAgICAgICAgICAgaWYgKGJpdHMgPiAzMikgdGhyb3cgbmV3IF9leGNlcHRpb24uSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uKCdFeHBHb2xvbWI6IHJlYWRCaXRzKCkgYml0cyBleGNlZWRlZCBtYXggMzJiaXRzIScpO1xuXG4gICAgICAgICAgICBpZiAoYml0cyA8PSB0aGlzLl9jdXJyZW50X3dvcmRfYml0c19sZWZ0KSB7XG4gICAgICAgICAgICAgICAgdmFyIF9yZXN1bHQgPSB0aGlzLl9jdXJyZW50X3dvcmQgPj4+IDMyIC0gYml0cztcbiAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50X3dvcmQgPDw9IGJpdHM7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudF93b3JkX2JpdHNfbGVmdCAtPSBiaXRzO1xuICAgICAgICAgICAgICAgIHJldHVybiBfcmVzdWx0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5fY3VycmVudF93b3JkX2JpdHNfbGVmdCA/IHRoaXMuX2N1cnJlbnRfd29yZCA6IDA7XG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQgPj4+IDMyIC0gdGhpcy5fY3VycmVudF93b3JkX2JpdHNfbGVmdDtcbiAgICAgICAgICAgIHZhciBiaXRzX25lZWRfbGVmdCA9IGJpdHMgLSB0aGlzLl9jdXJyZW50X3dvcmRfYml0c19sZWZ0O1xuXG4gICAgICAgICAgICB0aGlzLl9maWxsQ3VycmVudFdvcmQoKTtcbiAgICAgICAgICAgIHZhciBiaXRzX3JlYWRfbmV4dCA9IE1hdGgubWluKGJpdHNfbmVlZF9sZWZ0LCB0aGlzLl9jdXJyZW50X3dvcmRfYml0c19sZWZ0KTtcblxuICAgICAgICAgICAgdmFyIHJlc3VsdDIgPSB0aGlzLl9jdXJyZW50X3dvcmQgPj4+IDMyIC0gYml0c19yZWFkX25leHQ7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50X3dvcmQgPDw9IGJpdHNfcmVhZF9uZXh0O1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudF93b3JkX2JpdHNfbGVmdCAtPSBiaXRzX3JlYWRfbmV4dDtcblxuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0IDw8IGJpdHNfcmVhZF9uZXh0IHwgcmVzdWx0MjtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlYWRCb29sJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlYWRCb29sKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVhZEJpdHMoMSkgPT09IDE7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlYWRCeXRlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlYWRCeXRlKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVhZEJpdHMoOCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19za2lwTGVhZGluZ1plcm8nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3NraXBMZWFkaW5nWmVybygpIHtcbiAgICAgICAgICAgIHZhciB6ZXJvX2NvdW50ID0gdm9pZCAwO1xuICAgICAgICAgICAgZm9yICh6ZXJvX2NvdW50ID0gMDsgemVyb19jb3VudCA8IHRoaXMuX2N1cnJlbnRfd29yZF9iaXRzX2xlZnQ7IHplcm9fY291bnQrKykge1xuICAgICAgICAgICAgICAgIGlmICgwICE9PSAodGhpcy5fY3VycmVudF93b3JkICYgMHg4MDAwMDAwMCA+Pj4gemVyb19jb3VudCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudF93b3JkIDw8PSB6ZXJvX2NvdW50O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50X3dvcmRfYml0c19sZWZ0IC09IHplcm9fY291bnQ7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB6ZXJvX2NvdW50O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2ZpbGxDdXJyZW50V29yZCgpO1xuICAgICAgICAgICAgcmV0dXJuIHplcm9fY291bnQgKyB0aGlzLl9za2lwTGVhZGluZ1plcm8oKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVhZFVFRycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWFkVUVHKCkge1xuICAgICAgICAgICAgLy8gdW5zaWduZWQgZXhwb25lbnRpYWwgZ29sb21iXG4gICAgICAgICAgICB2YXIgbGVhZGluZ196ZXJvcyA9IHRoaXMuX3NraXBMZWFkaW5nWmVybygpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVhZEJpdHMobGVhZGluZ196ZXJvcyArIDEpIC0gMTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVhZFNFRycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWFkU0VHKCkge1xuICAgICAgICAgICAgLy8gc2lnbmVkIGV4cG9uZW50aWFsIGdvbG9tYlxuICAgICAgICAgICAgdmFyIHZhbHVlID0gdGhpcy5yZWFkVUVHKCk7XG4gICAgICAgICAgICBpZiAodmFsdWUgJiAweDAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlICsgMSA+Pj4gMTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xICogKHZhbHVlID4+PiAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBFeHBHb2xvbWI7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEV4cEdvbG9tYjtcblxufSx7XCIuLi91dGlscy9leGNlcHRpb24uanNcIjo0MH1dLDE4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgX2xvZ2dlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZ2dlci5qcycpO1xuXG52YXIgX2xvZ2dlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnZXIpO1xuXG52YXIgX2FtZlBhcnNlciA9IF9kZXJlcV8oJy4vYW1mLXBhcnNlci5qcycpO1xuXG52YXIgX2FtZlBhcnNlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hbWZQYXJzZXIpO1xuXG52YXIgX3Nwc1BhcnNlciA9IF9kZXJlcV8oJy4vc3BzLXBhcnNlci5qcycpO1xuXG52YXIgX3Nwc1BhcnNlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zcHNQYXJzZXIpO1xuXG52YXIgX2RlbXV4RXJyb3JzID0gX2RlcmVxXygnLi9kZW11eC1lcnJvcnMuanMnKTtcblxudmFyIF9kZW11eEVycm9yczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9kZW11eEVycm9ycyk7XG5cbnZhciBfbWVkaWFJbmZvID0gX2RlcmVxXygnLi4vY29yZS9tZWRpYS1pbmZvLmpzJyk7XG5cbnZhciBfbWVkaWFJbmZvMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21lZGlhSW5mbyk7XG5cbnZhciBfZXhjZXB0aW9uID0gX2RlcmVxXygnLi4vdXRpbHMvZXhjZXB0aW9uLmpzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIFN3YXAxNihzcmMpIHtcbiAgICByZXR1cm4gc3JjID4+PiA4ICYgMHhGRiB8IChzcmMgJiAweEZGKSA8PCA4O1xufVxuXG5mdW5jdGlvbiBTd2FwMzIoc3JjKSB7XG4gICAgcmV0dXJuIChzcmMgJiAweEZGMDAwMDAwKSA+Pj4gMjQgfCAoc3JjICYgMHgwMEZGMDAwMCkgPj4+IDggfCAoc3JjICYgMHgwMDAwRkYwMCkgPDwgOCB8IChzcmMgJiAweDAwMDAwMEZGKSA8PCAyNDtcbn1cblxuZnVuY3Rpb24gUmVhZEJpZzMyKGFycmF5LCBpbmRleCkge1xuICAgIHJldHVybiBhcnJheVtpbmRleF0gPDwgMjQgfCBhcnJheVtpbmRleCArIDFdIDw8IDE2IHwgYXJyYXlbaW5kZXggKyAyXSA8PCA4IHwgYXJyYXlbaW5kZXggKyAzXTtcbn1cblxudmFyIEZMVkRlbXV4ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRkxWRGVtdXhlcihwcm9iZURhdGEsIGNvbmZpZykge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRkxWRGVtdXhlcik7XG5cbiAgICAgICAgdGhpcy5UQUcgPSAnRkxWRGVtdXhlcic7XG5cbiAgICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuXG4gICAgICAgIHRoaXMuX29uRXJyb3IgPSBudWxsO1xuICAgICAgICB0aGlzLl9vbk1lZGlhSW5mbyA9IG51bGw7XG4gICAgICAgIHRoaXMuX29uTWV0YURhdGFBcnJpdmVkID0gbnVsbDtcbiAgICAgICAgdGhpcy5fb25TY3JpcHREYXRhQXJyaXZlZCA9IG51bGw7XG4gICAgICAgIHRoaXMuX29uVHJhY2tNZXRhZGF0YSA9IG51bGw7XG4gICAgICAgIHRoaXMuX29uRGF0YUF2YWlsYWJsZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX29uU3RyZWFtVGltZSA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5fZGF0YU9mZnNldCA9IHByb2JlRGF0YS5kYXRhT2Zmc2V0O1xuICAgICAgICB0aGlzLl9maXJzdFBhcnNlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5fZGlzcGF0Y2ggPSBmYWxzZTtcblxuICAgICAgICB0aGlzLl9oYXNBdWRpbyA9IHByb2JlRGF0YS5oYXNBdWRpb1RyYWNrO1xuICAgICAgICB0aGlzLl9oYXNWaWRlbyA9IHByb2JlRGF0YS5oYXNWaWRlb1RyYWNrO1xuXG4gICAgICAgIHRoaXMuX2hhc0F1ZGlvRmxhZ092ZXJyaWRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9oYXNWaWRlb0ZsYWdPdmVycmlkZWQgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLl9hdWRpb0luaXRpYWxNZXRhZGF0YURpc3BhdGNoZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fdmlkZW9Jbml0aWFsTWV0YWRhdGFEaXNwYXRjaGVkID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5fbWVkaWFJbmZvID0gbmV3IF9tZWRpYUluZm8yLmRlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmhhc0F1ZGlvID0gdGhpcy5faGFzQXVkaW87XG4gICAgICAgIHRoaXMuX21lZGlhSW5mby5oYXNWaWRlbyA9IHRoaXMuX2hhc1ZpZGVvO1xuICAgICAgICB0aGlzLl9tZXRhZGF0YSA9IG51bGw7XG4gICAgICAgIHRoaXMuX2F1ZGlvTWV0YWRhdGEgPSBudWxsO1xuICAgICAgICB0aGlzLl92aWRlb01ldGFkYXRhID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9uYWx1TGVuZ3RoU2l6ZSA9IDQ7XG4gICAgICAgIHRoaXMuX3RpbWVzdGFtcEJhc2UgPSAwOyAvLyBpbnQzMiwgaW4gbWlsbGlzZWNvbmRzXG4gICAgICAgIHRoaXMuX3RpbWVzY2FsZSA9IDEwMDA7XG4gICAgICAgIHRoaXMuX2R1cmF0aW9uID0gMDsgLy8gaW50MzIsIGluIG1pbGxpc2Vjb25kc1xuICAgICAgICB0aGlzLl9kdXJhdGlvbk92ZXJyaWRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9yZWZlcmVuY2VGcmFtZVJhdGUgPSB7XG4gICAgICAgICAgICBmaXhlZDogdHJ1ZSxcbiAgICAgICAgICAgIGZwczogMjMuOTc2LFxuICAgICAgICAgICAgZnBzX251bTogMjM5NzYsXG4gICAgICAgICAgICBmcHNfZGVuOiAxMDAwXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5fZmx2U291bmRSYXRlVGFibGUgPSBbNTUwMCwgMTEwMjUsIDIyMDUwLCA0NDEwMCwgNDgwMDBdO1xuXG4gICAgICAgIHRoaXMuX21wZWdTYW1wbGluZ1JhdGVzID0gWzk2MDAwLCA4ODIwMCwgNjQwMDAsIDQ4MDAwLCA0NDEwMCwgMzIwMDAsIDI0MDAwLCAyMjA1MCwgMTYwMDAsIDEyMDAwLCAxMTAyNSwgODAwMCwgNzM1MF07XG5cbiAgICAgICAgdGhpcy5fbXBlZ0F1ZGlvVjEwU2FtcGxlUmF0ZVRhYmxlID0gWzQ0MTAwLCA0ODAwMCwgMzIwMDAsIDBdO1xuICAgICAgICB0aGlzLl9tcGVnQXVkaW9WMjBTYW1wbGVSYXRlVGFibGUgPSBbMjIwNTAsIDI0MDAwLCAxNjAwMCwgMF07XG4gICAgICAgIHRoaXMuX21wZWdBdWRpb1YyNVNhbXBsZVJhdGVUYWJsZSA9IFsxMTAyNSwgMTIwMDAsIDgwMDAsIDBdO1xuXG4gICAgICAgIHRoaXMuX21wZWdBdWRpb0wxQml0UmF0ZVRhYmxlID0gWzAsIDMyLCA2NCwgOTYsIDEyOCwgMTYwLCAxOTIsIDIyNCwgMjU2LCAyODgsIDMyMCwgMzUyLCAzODQsIDQxNiwgNDQ4LCAtMV07XG4gICAgICAgIHRoaXMuX21wZWdBdWRpb0wyQml0UmF0ZVRhYmxlID0gWzAsIDMyLCA0OCwgNTYsIDY0LCA4MCwgOTYsIDExMiwgMTI4LCAxNjAsIDE5MiwgMjI0LCAyNTYsIDMyMCwgMzg0LCAtMV07XG4gICAgICAgIHRoaXMuX21wZWdBdWRpb0wzQml0UmF0ZVRhYmxlID0gWzAsIDMyLCA0MCwgNDgsIDU2LCA2NCwgODAsIDk2LCAxMTIsIDEyOCwgMTYwLCAxOTIsIDIyNCwgMjU2LCAzMjAsIC0xXTtcblxuICAgICAgICB0aGlzLl92aWRlb1RyYWNrID0geyB0eXBlOiAndmlkZW8nLCBpZDogMSwgc2VxdWVuY2VOdW1iZXI6IDAsIHNhbXBsZXM6IFtdLCBsZW5ndGg6IDAgfTtcbiAgICAgICAgdGhpcy5fYXVkaW9UcmFjayA9IHsgdHlwZTogJ2F1ZGlvJywgaWQ6IDIsIHNlcXVlbmNlTnVtYmVyOiAwLCBzYW1wbGVzOiBbXSwgbGVuZ3RoOiAwIH07XG5cbiAgICAgICAgdGhpcy5fbGl0dGxlRW5kaWFuID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGJ1ZiA9IG5ldyBBcnJheUJ1ZmZlcigyKTtcbiAgICAgICAgICAgIG5ldyBEYXRhVmlldyhidWYpLnNldEludDE2KDAsIDI1NiwgdHJ1ZSk7IC8vIGxpdHRsZS1lbmRpYW4gd3JpdGVcbiAgICAgICAgICAgIHJldHVybiBuZXcgSW50MTZBcnJheShidWYpWzBdID09PSAyNTY7IC8vIHBsYXRmb3JtLXNwZWMgcmVhZCwgaWYgZXF1YWwgdGhlbiBMRVxuICAgICAgICB9KCk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKEZMVkRlbXV4ZXIsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mbyA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9tZXRhZGF0YSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9hdWRpb01ldGFkYXRhID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX3ZpZGVvTWV0YWRhdGEgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fdmlkZW9UcmFjayA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9hdWRpb1RyYWNrID0gbnVsbDtcblxuICAgICAgICAgICAgdGhpcy5fb25FcnJvciA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vbk1lZGlhSW5mbyA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vbk1ldGFEYXRhQXJyaXZlZCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vblNjcmlwdERhdGFBcnJpdmVkID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uVHJhY2tNZXRhZGF0YSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vbkRhdGFBdmFpbGFibGUgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25TdHJlYW1UaW1lID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYmluZERhdGFTb3VyY2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYmluZERhdGFTb3VyY2UobG9hZGVyKSB7XG4gICAgICAgICAgICBsb2FkZXIub25EYXRhQXJyaXZhbCA9IHRoaXMucGFyc2VDaHVua3MuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcHJvdG90eXBlOiBmdW5jdGlvbih0eXBlOiBzdHJpbmcsIG1ldGFkYXRhOiBhbnkpOiB2b2lkXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3Jlc2V0TWVkaWFJbmZvJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2V0TWVkaWFJbmZvKCkge1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvID0gbmV3IF9tZWRpYUluZm8yLmRlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2lzSW5pdGlhbE1ldGFkYXRhRGlzcGF0Y2hlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfaXNJbml0aWFsTWV0YWRhdGFEaXNwYXRjaGVkKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2hhc0F1ZGlvICYmIHRoaXMuX2hhc1ZpZGVvKSB7XG4gICAgICAgICAgICAgICAgLy8gYm90aCBhdWRpbyAmIHZpZGVvXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2F1ZGlvSW5pdGlhbE1ldGFkYXRhRGlzcGF0Y2hlZCAmJiB0aGlzLl92aWRlb0luaXRpYWxNZXRhZGF0YURpc3BhdGNoZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5faGFzQXVkaW8gJiYgIXRoaXMuX2hhc1ZpZGVvKSB7XG4gICAgICAgICAgICAgICAgLy8gYXVkaW8gb25seVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9hdWRpb0luaXRpYWxNZXRhZGF0YURpc3BhdGNoZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2hhc0F1ZGlvICYmIHRoaXMuX2hhc1ZpZGVvKSB7XG4gICAgICAgICAgICAgICAgLy8gdmlkZW8gb25seVxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl92aWRlb0luaXRpYWxNZXRhZGF0YURpc3BhdGNoZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBmdW5jdGlvbiBwYXJzZUNodW5rcyhjaHVuazogQXJyYXlCdWZmZXIsIGJ5dGVTdGFydDogbnVtYmVyKTogbnVtYmVyO1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwYXJzZUNodW5rcycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXJzZUNodW5rcyhjaHVuaywgYnl0ZVN0YXJ0KSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX29uRXJyb3IgfHwgIXRoaXMuX29uTWVkaWFJbmZvIHx8ICF0aGlzLl9vblRyYWNrTWV0YWRhdGEgfHwgIXRoaXMuX29uRGF0YUF2YWlsYWJsZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbignRmx2OiBvbkVycm9yICYgb25NZWRpYUluZm8gJiBvblRyYWNrTWV0YWRhdGEgJiBvbkRhdGFBdmFpbGFibGUgY2FsbGJhY2sgbXVzdCBiZSBzcGVjaWZpZWQnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIG9mZnNldCA9IDA7XG4gICAgICAgICAgICB2YXIgbGUgPSB0aGlzLl9saXR0bGVFbmRpYW47XG5cbiAgICAgICAgICAgIGlmIChieXRlU3RhcnQgPT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyBidWZmZXIgd2l0aCBGTFYgaGVhZGVyXG4gICAgICAgICAgICAgICAgaWYgKGNodW5rLmJ5dGVMZW5ndGggPiAxMykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvYmVEYXRhID0gRkxWRGVtdXhlci5wcm9iZShjaHVuayk7XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCA9IHByb2JlRGF0YS5kYXRhT2Zmc2V0O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX2ZpcnN0UGFyc2UpIHtcbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgUHJldmlvdXNUYWdTaXplMCBiZWZvcmUgVGFnMVxuICAgICAgICAgICAgICAgIHRoaXMuX2ZpcnN0UGFyc2UgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAoYnl0ZVN0YXJ0ICsgb2Zmc2V0ICE9PSB0aGlzLl9kYXRhT2Zmc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ0ZpcnN0IHRpbWUgcGFyc2luZyBidXQgY2h1bmsgYnl0ZVN0YXJ0IGludmFsaWQhJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHYgPSBuZXcgRGF0YVZpZXcoY2h1bmssIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgdmFyIHByZXZUYWdTaXplMCA9IHYuZ2V0VWludDMyKDAsICFsZSk7XG4gICAgICAgICAgICAgICAgaWYgKHByZXZUYWdTaXplMCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdQcmV2VGFnU2l6ZTAgIT09IDAgISEhJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG9mZnNldCArPSA0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3aGlsZSAob2Zmc2V0IDwgY2h1bmsuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Rpc3BhdGNoID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgIHZhciBfdiA9IG5ldyBEYXRhVmlldyhjaHVuaywgb2Zmc2V0KTtcblxuICAgICAgICAgICAgICAgIGlmIChvZmZzZXQgKyAxMSArIDQgPiBjaHVuay5ieXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGRhdGEgbm90IGVub3VnaCBmb3IgcGFyc2luZyBhbiBmbHYgdGFnXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB0YWdUeXBlID0gX3YuZ2V0VWludDgoMCk7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGFTaXplID0gX3YuZ2V0VWludDMyKDAsICFsZSkgJiAweDAwRkZGRkZGO1xuXG4gICAgICAgICAgICAgICAgaWYgKG9mZnNldCArIDExICsgZGF0YVNpemUgKyA0ID4gY2h1bmsuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBkYXRhIG5vdCBlbm91Z2ggZm9yIHBhcnNpbmcgYWN0dWFsIGRhdGEgYm9keVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGFnVHlwZSAhPT0gOCAmJiB0YWdUeXBlICE9PSA5ICYmIHRhZ1R5cGUgIT09IDE4KSB7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ1Vuc3VwcG9ydGVkIHRhZyB0eXBlICcgKyB0YWdUeXBlICsgJywgc2tpcHBlZCcpO1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zdW1lIHRoZSB3aG9sZSB0YWcgKHNraXAgaXQpXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSAxMSArIGRhdGFTaXplICsgNDtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHRzMiA9IF92LmdldFVpbnQ4KDQpO1xuICAgICAgICAgICAgICAgIHZhciB0czEgPSBfdi5nZXRVaW50OCg1KTtcbiAgICAgICAgICAgICAgICB2YXIgdHMwID0gX3YuZ2V0VWludDgoNik7XG4gICAgICAgICAgICAgICAgdmFyIHRzMyA9IF92LmdldFVpbnQ4KDcpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHRpbWVzdGFtcCA9IHRzMCB8IHRzMSA8PCA4IHwgdHMyIDw8IDE2IHwgdHMzIDw8IDI0O1xuXG4gICAgICAgICAgICAgICAgdmFyIHN0cmVhbUlkID0gX3YuZ2V0VWludDMyKDcsICFsZSkgJiAweDAwRkZGRkZGO1xuICAgICAgICAgICAgICAgIGlmIChzdHJlYW1JZCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdNZWV0IHRhZyB3aGljaCBoYXMgU3RyZWFtSUQgIT0gMCEnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgZGF0YU9mZnNldCA9IG9mZnNldCArIDExO1xuXG4gICAgICAgICAgICAgICAgc3dpdGNoICh0YWdUeXBlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEF1ZGlvXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wYXJzZUF1ZGlvRGF0YShjaHVuaywgZGF0YU9mZnNldCwgZGF0YVNpemUsIHRpbWVzdGFtcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSA5OlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gVmlkZW9cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vblN0cmVhbVRpbWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uU3RyZWFtVGltZSh0aW1lc3RhbXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGFyc2VWaWRlb0RhdGEoY2h1bmssIGRhdGFPZmZzZXQsIGRhdGFTaXplLCB0aW1lc3RhbXAsIGJ5dGVTdGFydCArIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxODpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNjcmlwdERhdGFPYmplY3RcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BhcnNlU2NyaXB0RGF0YShjaHVuaywgZGF0YU9mZnNldCwgZGF0YVNpemUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHByZXZUYWdTaXplID0gX3YuZ2V0VWludDMyKDExICsgZGF0YVNpemUsICFsZSk7XG4gICAgICAgICAgICAgICAgaWYgKHByZXZUYWdTaXplICE9PSAxMSArIGRhdGFTaXplKSB7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ0ludmFsaWQgUHJldlRhZ1NpemUgJyArIHByZXZUYWdTaXplKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gMTEgKyBkYXRhU2l6ZSArIDQ7IC8vIHRhZ0JvZHkgKyBkYXRhU2l6ZSArIHByZXZUYWdTaXplXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGRpc3BhdGNoIHBhcnNlZCBmcmFtZXMgdG8gY29uc3VtZXIgKHR5cGljYWxseSwgdGhlIHJlbXV4ZXIpXG4gICAgICAgICAgICBpZiAodGhpcy5faXNJbml0aWFsTWV0YWRhdGFEaXNwYXRjaGVkKCkpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fZGlzcGF0Y2ggJiYgKHRoaXMuX2F1ZGlvVHJhY2subGVuZ3RoIHx8IHRoaXMuX3ZpZGVvVHJhY2subGVuZ3RoKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkRhdGFBdmFpbGFibGUodGhpcy5fYXVkaW9UcmFjaywgdGhpcy5fdmlkZW9UcmFjayk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gb2Zmc2V0OyAvLyBjb25zdW1lZCBieXRlcywganVzdCBlcXVhbHMgbGF0ZXN0IG9mZnNldCBpbmRleFxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcGFyc2VTY3JpcHREYXRhJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9wYXJzZVNjcmlwdERhdGEoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKSB7XG4gICAgICAgICAgICB2YXIgc2NyaXB0RGF0YSA9IF9hbWZQYXJzZXIyLmRlZmF1bHQucGFyc2VTY3JpcHREYXRhKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSk7XG5cbiAgICAgICAgICAgIGlmIChzY3JpcHREYXRhLmhhc093blByb3BlcnR5KCdvbk1ldGFEYXRhJykpIHtcbiAgICAgICAgICAgICAgICBpZiAoc2NyaXB0RGF0YS5vbk1ldGFEYXRhID09IG51bGwgfHwgX3R5cGVvZihzY3JpcHREYXRhLm9uTWV0YURhdGEpICE9PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdJbnZhbGlkIG9uTWV0YURhdGEgc3RydWN0dXJlIScpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tZXRhZGF0YSkge1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdGb3VuZCBhbm90aGVyIG9uTWV0YURhdGEgdGFnIScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9tZXRhZGF0YSA9IHNjcmlwdERhdGE7XG4gICAgICAgICAgICAgICAgdmFyIG9uTWV0YURhdGEgPSB0aGlzLl9tZXRhZGF0YS5vbk1ldGFEYXRhO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uTWV0YURhdGFBcnJpdmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uTWV0YURhdGFBcnJpdmVkKE9iamVjdC5hc3NpZ24oe30sIG9uTWV0YURhdGEpKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9uTWV0YURhdGEuaGFzQXVkaW8gPT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBoYXNBdWRpb1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5faGFzQXVkaW9GbGFnT3ZlcnJpZGVkID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faGFzQXVkaW8gPSBvbk1ldGFEYXRhLmhhc0F1ZGlvO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmhhc0F1ZGlvID0gdGhpcy5faGFzQXVkaW87XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvbk1ldGFEYXRhLmhhc1ZpZGVvID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaGFzVmlkZW9cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2hhc1ZpZGVvRmxhZ092ZXJyaWRlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhc1ZpZGVvID0gb25NZXRhRGF0YS5oYXNWaWRlbztcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5oYXNWaWRlbyA9IHRoaXMuX2hhc1ZpZGVvO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb25NZXRhRGF0YS5hdWRpb2RhdGFyYXRlID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBhdWRpb2RhdGFyYXRlXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5hdWRpb0RhdGFSYXRlID0gb25NZXRhRGF0YS5hdWRpb2RhdGFyYXRlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9uTWV0YURhdGEudmlkZW9kYXRhcmF0ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdmlkZW9kYXRhcmF0ZVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8udmlkZW9EYXRhUmF0ZSA9IG9uTWV0YURhdGEudmlkZW9kYXRhcmF0ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvbk1ldGFEYXRhLndpZHRoID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICAvLyB3aWR0aFxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8ud2lkdGggPSBvbk1ldGFEYXRhLndpZHRoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9uTWV0YURhdGEuaGVpZ2h0ID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBoZWlnaHRcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmhlaWdodCA9IG9uTWV0YURhdGEuaGVpZ2h0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9uTWV0YURhdGEuZHVyYXRpb24gPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGR1cmF0aW9uXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5fZHVyYXRpb25PdmVycmlkZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkdXJhdGlvbiA9IE1hdGguZmxvb3Iob25NZXRhRGF0YS5kdXJhdGlvbiAqIHRoaXMuX3RpbWVzY2FsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kdXJhdGlvbiA9IGR1cmF0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmR1cmF0aW9uID0gZHVyYXRpb247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uZHVyYXRpb24gPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9uTWV0YURhdGEuZnJhbWVyYXRlID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBmcmFtZXJhdGVcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZwc19udW0gPSBNYXRoLmZsb29yKG9uTWV0YURhdGEuZnJhbWVyYXRlICogMTAwMCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmcHNfbnVtID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZwcyA9IGZwc19udW0gLyAxMDAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVmZXJlbmNlRnJhbWVSYXRlLmZpeGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlZmVyZW5jZUZyYW1lUmF0ZS5mcHMgPSBmcHM7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZWZlcmVuY2VGcmFtZVJhdGUuZnBzX251bSA9IGZwc19udW07XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZWZlcmVuY2VGcmFtZVJhdGUuZnBzX2RlbiA9IDEwMDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uZnBzID0gZnBzO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChfdHlwZW9mKG9uTWV0YURhdGEua2V5ZnJhbWVzKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8ga2V5ZnJhbWVzXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5oYXNLZXlmcmFtZXNJbmRleCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXlmcmFtZXMgPSBvbk1ldGFEYXRhLmtleWZyYW1lcztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmtleWZyYW1lc0luZGV4ID0gdGhpcy5fcGFyc2VLZXlmcmFtZXNJbmRleChrZXlmcmFtZXMpO1xuICAgICAgICAgICAgICAgICAgICBvbk1ldGFEYXRhLmtleWZyYW1lcyA9IG51bGw7IC8vIGtleWZyYW1lcyBoYXMgYmVlbiBleHRyYWN0ZWQsIHJlbW92ZSBpdFxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5oYXNLZXlmcmFtZXNJbmRleCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9kaXNwYXRjaCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5tZXRhZGF0YSA9IG9uTWV0YURhdGE7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KHRoaXMuVEFHLCAnUGFyc2VkIG9uTWV0YURhdGEnKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFJbmZvLmlzQ29tcGxldGUoKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbk1lZGlhSW5mbyh0aGlzLl9tZWRpYUluZm8pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKHNjcmlwdERhdGEpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25TY3JpcHREYXRhQXJyaXZlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vblNjcmlwdERhdGFBcnJpdmVkKE9iamVjdC5hc3NpZ24oe30sIHNjcmlwdERhdGEpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19wYXJzZUtleWZyYW1lc0luZGV4JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9wYXJzZUtleWZyYW1lc0luZGV4KGtleWZyYW1lcykge1xuICAgICAgICAgICAgdmFyIHRpbWVzID0gW107XG4gICAgICAgICAgICB2YXIgZmlsZXBvc2l0aW9ucyA9IFtdO1xuXG4gICAgICAgICAgICAvLyBpZ25vcmUgZmlyc3Qga2V5ZnJhbWUgd2hpY2ggaXMgYWN0dWFsbHkgQVZDIFNlcXVlbmNlIEhlYWRlciAoQVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQpXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGtleWZyYW1lcy50aW1lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciB0aW1lID0gdGhpcy5fdGltZXN0YW1wQmFzZSArIE1hdGguZmxvb3Ioa2V5ZnJhbWVzLnRpbWVzW2ldICogMTAwMCk7XG4gICAgICAgICAgICAgICAgdGltZXMucHVzaCh0aW1lKTtcbiAgICAgICAgICAgICAgICBmaWxlcG9zaXRpb25zLnB1c2goa2V5ZnJhbWVzLmZpbGVwb3NpdGlvbnNbaV0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHRpbWVzOiB0aW1lcyxcbiAgICAgICAgICAgICAgICBmaWxlcG9zaXRpb25zOiBmaWxlcG9zaXRpb25zXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcGFyc2VBdWRpb0RhdGEnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3BhcnNlQXVkaW9EYXRhKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSwgdGFnVGltZXN0YW1wKSB7XG4gICAgICAgICAgICBpZiAoZGF0YVNpemUgPD0gMSkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ0ZsdjogSW52YWxpZCBhdWRpbyBwYWNrZXQsIG1pc3NpbmcgU291bmREYXRhIHBheWxvYWQhJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5faGFzQXVkaW9GbGFnT3ZlcnJpZGVkID09PSB0cnVlICYmIHRoaXMuX2hhc0F1ZGlvID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIC8vIElmIGhhc0F1ZGlvOiBmYWxzZSBpbmRpY2F0ZWQgZXhwbGljaXRseSBpbiBNZWRpYURhdGFTb3VyY2UsXG4gICAgICAgICAgICAgICAgLy8gSWdub3JlIGFsbCB0aGUgYXVkaW8gcGFja2V0c1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGxlID0gdGhpcy5fbGl0dGxlRW5kaWFuO1xuICAgICAgICAgICAgdmFyIHYgPSBuZXcgRGF0YVZpZXcoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKTtcblxuICAgICAgICAgICAgdmFyIHNvdW5kU3BlYyA9IHYuZ2V0VWludDgoMCk7XG5cbiAgICAgICAgICAgIHZhciBzb3VuZEZvcm1hdCA9IHNvdW5kU3BlYyA+Pj4gNDtcbiAgICAgICAgICAgIGlmIChzb3VuZEZvcm1hdCAhPT0gMiAmJiBzb3VuZEZvcm1hdCAhPT0gMTApIHtcbiAgICAgICAgICAgICAgICAvLyBNUDMgb3IgQUFDXG4gICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcihfZGVtdXhFcnJvcnMyLmRlZmF1bHQuQ09ERUNfVU5TVVBQT1JURUQsICdGbHY6IFVuc3VwcG9ydGVkIGF1ZGlvIGNvZGVjIGlkeDogJyArIHNvdW5kRm9ybWF0KTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzb3VuZFJhdGUgPSAwO1xuICAgICAgICAgICAgdmFyIHNvdW5kUmF0ZUluZGV4ID0gKHNvdW5kU3BlYyAmIDEyKSA+Pj4gMjtcbiAgICAgICAgICAgIGlmIChzb3VuZFJhdGVJbmRleCA+PSAwICYmIHNvdW5kUmF0ZUluZGV4IDw9IDQpIHtcbiAgICAgICAgICAgICAgICBzb3VuZFJhdGUgPSB0aGlzLl9mbHZTb3VuZFJhdGVUYWJsZVtzb3VuZFJhdGVJbmRleF07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoX2RlbXV4RXJyb3JzMi5kZWZhdWx0LkZPUk1BVF9FUlJPUiwgJ0ZsdjogSW52YWxpZCBhdWRpbyBzYW1wbGUgcmF0ZSBpZHg6ICcgKyBzb3VuZFJhdGVJbmRleCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc291bmRTaXplID0gKHNvdW5kU3BlYyAmIDIpID4+PiAxOyAvLyB1bnVzZWRcbiAgICAgICAgICAgIHZhciBzb3VuZFR5cGUgPSBzb3VuZFNwZWMgJiAxO1xuXG4gICAgICAgICAgICB2YXIgbWV0YSA9IHRoaXMuX2F1ZGlvTWV0YWRhdGE7XG4gICAgICAgICAgICB2YXIgdHJhY2sgPSB0aGlzLl9hdWRpb1RyYWNrO1xuXG4gICAgICAgICAgICBpZiAoIW1ldGEpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faGFzQXVkaW8gPT09IGZhbHNlICYmIHRoaXMuX2hhc0F1ZGlvRmxhZ092ZXJyaWRlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGFzQXVkaW8gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uaGFzQXVkaW8gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGluaXRpYWwgbWV0YWRhdGFcbiAgICAgICAgICAgICAgICBtZXRhID0gdGhpcy5fYXVkaW9NZXRhZGF0YSA9IHt9O1xuICAgICAgICAgICAgICAgIG1ldGEudHlwZSA9ICdhdWRpbyc7XG4gICAgICAgICAgICAgICAgbWV0YS5pZCA9IHRyYWNrLmlkO1xuICAgICAgICAgICAgICAgIG1ldGEudGltZXNjYWxlID0gdGhpcy5fdGltZXNjYWxlO1xuICAgICAgICAgICAgICAgIG1ldGEuZHVyYXRpb24gPSB0aGlzLl9kdXJhdGlvbjtcbiAgICAgICAgICAgICAgICBtZXRhLmF1ZGlvU2FtcGxlUmF0ZSA9IHNvdW5kUmF0ZTtcbiAgICAgICAgICAgICAgICBtZXRhLmNoYW5uZWxDb3VudCA9IHNvdW5kVHlwZSA9PT0gMCA/IDEgOiAyO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoc291bmRGb3JtYXQgPT09IDEwKSB7XG4gICAgICAgICAgICAgICAgLy8gQUFDXG4gICAgICAgICAgICAgICAgdmFyIGFhY0RhdGEgPSB0aGlzLl9wYXJzZUFBQ0F1ZGlvRGF0YShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIDEsIGRhdGFTaXplIC0gMSk7XG4gICAgICAgICAgICAgICAgaWYgKGFhY0RhdGEgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoYWFjRGF0YS5wYWNrZXRUeXBlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFBQyBzZXF1ZW5jZSBoZWFkZXIgKEF1ZGlvU3BlY2lmaWNDb25maWcpXG4gICAgICAgICAgICAgICAgICAgIGlmIChtZXRhLmNvbmZpZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnRm91bmQgYW5vdGhlciBBdWRpb1NwZWNpZmljQ29uZmlnIScpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBtaXNjID0gYWFjRGF0YS5kYXRhO1xuICAgICAgICAgICAgICAgICAgICBtZXRhLmF1ZGlvU2FtcGxlUmF0ZSA9IG1pc2Muc2FtcGxpbmdSYXRlO1xuICAgICAgICAgICAgICAgICAgICBtZXRhLmNoYW5uZWxDb3VudCA9IG1pc2MuY2hhbm5lbENvdW50O1xuICAgICAgICAgICAgICAgICAgICBtZXRhLmNvZGVjID0gbWlzYy5jb2RlYztcbiAgICAgICAgICAgICAgICAgICAgbWV0YS5vcmlnaW5hbENvZGVjID0gbWlzYy5vcmlnaW5hbENvZGVjO1xuICAgICAgICAgICAgICAgICAgICBtZXRhLmNvbmZpZyA9IG1pc2MuY29uZmlnO1xuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZGVjb2RlIHJlc3VsdCBvZiBhbiBhYWMgc2FtcGxlIGlzIDEwMjQgUENNIHNhbXBsZXNcbiAgICAgICAgICAgICAgICAgICAgbWV0YS5yZWZTYW1wbGVEdXJhdGlvbiA9IDEwMjQgLyBtZXRhLmF1ZGlvU2FtcGxlUmF0ZSAqIG1ldGEudGltZXNjYWxlO1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYodGhpcy5UQUcsICdQYXJzZWQgQXVkaW9TcGVjaWZpY0NvbmZpZycpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pc0luaXRpYWxNZXRhZGF0YURpc3BhdGNoZWQoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm9uLWluaXRpYWwgbWV0YWRhdGEsIGZvcmNlIGRpc3BhdGNoIChvciBmbHVzaCkgcGFyc2VkIGZyYW1lcyB0byByZW11eGVyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fZGlzcGF0Y2ggJiYgKHRoaXMuX2F1ZGlvVHJhY2subGVuZ3RoIHx8IHRoaXMuX3ZpZGVvVHJhY2subGVuZ3RoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uRGF0YUF2YWlsYWJsZSh0aGlzLl9hdWRpb1RyYWNrLCB0aGlzLl92aWRlb1RyYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2F1ZGlvSW5pdGlhbE1ldGFkYXRhRGlzcGF0Y2hlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlbiBub3RpZnkgbmV3IG1ldGFkYXRhXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2Rpc3BhdGNoID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uVHJhY2tNZXRhZGF0YSgnYXVkaW8nLCBtZXRhKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbWkgPSB0aGlzLl9tZWRpYUluZm87XG4gICAgICAgICAgICAgICAgICAgIG1pLmF1ZGlvQ29kZWMgPSBtZXRhLm9yaWdpbmFsQ29kZWM7XG4gICAgICAgICAgICAgICAgICAgIG1pLmF1ZGlvU2FtcGxlUmF0ZSA9IG1ldGEuYXVkaW9TYW1wbGVSYXRlO1xuICAgICAgICAgICAgICAgICAgICBtaS5hdWRpb0NoYW5uZWxDb3VudCA9IG1ldGEuY2hhbm5lbENvdW50O1xuICAgICAgICAgICAgICAgICAgICBpZiAobWkuaGFzVmlkZW8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaS52aWRlb0NvZGVjICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaS5taW1lVHlwZSA9ICd2aWRlby94LWZsdjsgY29kZWNzPVwiJyArIG1pLnZpZGVvQ29kZWMgKyAnLCcgKyBtaS5hdWRpb0NvZGVjICsgJ1wiJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pLm1pbWVUeXBlID0gJ3ZpZGVvL3gtZmx2OyBjb2RlY3M9XCInICsgbWkuYXVkaW9Db2RlYyArICdcIic7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKG1pLmlzQ29tcGxldGUoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25NZWRpYUluZm8obWkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhYWNEYXRhLnBhY2tldFR5cGUgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQUFDIHJhdyBmcmFtZSBkYXRhXG4gICAgICAgICAgICAgICAgICAgIHZhciBkdHMgPSB0aGlzLl90aW1lc3RhbXBCYXNlICsgdGFnVGltZXN0YW1wO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWFjU2FtcGxlID0geyB1bml0OiBhYWNEYXRhLmRhdGEsIGxlbmd0aDogYWFjRGF0YS5kYXRhLmJ5dGVMZW5ndGgsIGR0czogZHRzLCBwdHM6IGR0cyB9O1xuICAgICAgICAgICAgICAgICAgICB0cmFjay5zYW1wbGVzLnB1c2goYWFjU2FtcGxlKTtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2subGVuZ3RoICs9IGFhY0RhdGEuZGF0YS5sZW5ndGg7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lKHRoaXMuVEFHLCAnRmx2OiBVbnN1cHBvcnRlZCBBQUMgZGF0YSB0eXBlICcgKyBhYWNEYXRhLnBhY2tldFR5cGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc291bmRGb3JtYXQgPT09IDIpIHtcbiAgICAgICAgICAgICAgICAvLyBNUDNcbiAgICAgICAgICAgICAgICBpZiAoIW1ldGEuY29kZWMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgbmVlZCBtZXRhZGF0YSBmb3IgbXAzIGF1ZGlvIHRyYWNrLCBleHRyYWN0IGluZm8gZnJvbSBmcmFtZSBoZWFkZXJcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9taXNjID0gdGhpcy5fcGFyc2VNUDNBdWRpb0RhdGEoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyAxLCBkYXRhU2l6ZSAtIDEsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoX21pc2MgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbWV0YS5hdWRpb1NhbXBsZVJhdGUgPSBfbWlzYy5zYW1wbGluZ1JhdGU7XG4gICAgICAgICAgICAgICAgICAgIG1ldGEuY2hhbm5lbENvdW50ID0gX21pc2MuY2hhbm5lbENvdW50O1xuICAgICAgICAgICAgICAgICAgICBtZXRhLmNvZGVjID0gX21pc2MuY29kZWM7XG4gICAgICAgICAgICAgICAgICAgIG1ldGEub3JpZ2luYWxDb2RlYyA9IF9taXNjLm9yaWdpbmFsQ29kZWM7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoZSBkZWNvZGUgcmVzdWx0IG9mIGFuIG1wMyBzYW1wbGUgaXMgMTE1MiBQQ00gc2FtcGxlc1xuICAgICAgICAgICAgICAgICAgICBtZXRhLnJlZlNhbXBsZUR1cmF0aW9uID0gMTE1MiAvIG1ldGEuYXVkaW9TYW1wbGVSYXRlICogbWV0YS50aW1lc2NhbGU7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudih0aGlzLlRBRywgJ1BhcnNlZCBNUEVHIEF1ZGlvIEZyYW1lIEhlYWRlcicpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2F1ZGlvSW5pdGlhbE1ldGFkYXRhRGlzcGF0Y2hlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uVHJhY2tNZXRhZGF0YSgnYXVkaW8nLCBtZXRhKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgX21pID0gdGhpcy5fbWVkaWFJbmZvO1xuICAgICAgICAgICAgICAgICAgICBfbWkuYXVkaW9Db2RlYyA9IG1ldGEuY29kZWM7XG4gICAgICAgICAgICAgICAgICAgIF9taS5hdWRpb1NhbXBsZVJhdGUgPSBtZXRhLmF1ZGlvU2FtcGxlUmF0ZTtcbiAgICAgICAgICAgICAgICAgICAgX21pLmF1ZGlvQ2hhbm5lbENvdW50ID0gbWV0YS5jaGFubmVsQ291bnQ7XG4gICAgICAgICAgICAgICAgICAgIF9taS5hdWRpb0RhdGFSYXRlID0gX21pc2MuYml0UmF0ZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9taS5oYXNWaWRlbykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9taS52aWRlb0NvZGVjICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbWkubWltZVR5cGUgPSAndmlkZW8veC1mbHY7IGNvZGVjcz1cIicgKyBfbWkudmlkZW9Db2RlYyArICcsJyArIF9taS5hdWRpb0NvZGVjICsgJ1wiJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9taS5taW1lVHlwZSA9ICd2aWRlby94LWZsdjsgY29kZWNzPVwiJyArIF9taS5hdWRpb0NvZGVjICsgJ1wiJztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoX21pLmlzQ29tcGxldGUoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25NZWRpYUluZm8oX21pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFRoaXMgcGFja2V0IGlzIGFsd2F5cyBhIHZhbGlkIGF1ZGlvIHBhY2tldCwgZXh0cmFjdCBpdFxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gdGhpcy5fcGFyc2VNUDNBdWRpb0RhdGEoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyAxLCBkYXRhU2l6ZSAtIDEsIGZhbHNlKTtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YSA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgX2R0cyA9IHRoaXMuX3RpbWVzdGFtcEJhc2UgKyB0YWdUaW1lc3RhbXA7XG4gICAgICAgICAgICAgICAgdmFyIG1wM1NhbXBsZSA9IHsgdW5pdDogZGF0YSwgbGVuZ3RoOiBkYXRhLmJ5dGVMZW5ndGgsIGR0czogX2R0cywgcHRzOiBfZHRzIH07XG4gICAgICAgICAgICAgICAgdHJhY2suc2FtcGxlcy5wdXNoKG1wM1NhbXBsZSk7XG4gICAgICAgICAgICAgICAgdHJhY2subGVuZ3RoICs9IGRhdGEubGVuZ3RoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcGFyc2VBQUNBdWRpb0RhdGEnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3BhcnNlQUFDQXVkaW9EYXRhKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSkge1xuICAgICAgICAgICAgaWYgKGRhdGFTaXplIDw9IDEpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdGbHY6IEludmFsaWQgQUFDIHBhY2tldCwgbWlzc2luZyBBQUNQYWNrZXRUeXBlIG9yL2FuZCBEYXRhIScpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHt9O1xuICAgICAgICAgICAgdmFyIGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKTtcblxuICAgICAgICAgICAgcmVzdWx0LnBhY2tldFR5cGUgPSBhcnJheVswXTtcblxuICAgICAgICAgICAgaWYgKGFycmF5WzBdID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LmRhdGEgPSB0aGlzLl9wYXJzZUFBQ0F1ZGlvU3BlY2lmaWNDb25maWcoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyAxLCBkYXRhU2l6ZSAtIDEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXN1bHQuZGF0YSA9IGFycmF5LnN1YmFycmF5KDEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcGFyc2VBQUNBdWRpb1NwZWNpZmljQ29uZmlnJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9wYXJzZUFBQ0F1ZGlvU3BlY2lmaWNDb25maWcoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKSB7XG4gICAgICAgICAgICB2YXIgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpO1xuICAgICAgICAgICAgdmFyIGNvbmZpZyA9IG51bGw7XG5cbiAgICAgICAgICAgIC8qIEF1ZGlvIE9iamVjdCBUeXBlOlxyXG4gICAgICAgICAgICAgICAwOiBOdWxsXHJcbiAgICAgICAgICAgICAgIDE6IEFBQyBNYWluXHJcbiAgICAgICAgICAgICAgIDI6IEFBQyBMQ1xyXG4gICAgICAgICAgICAgICAzOiBBQUMgU1NSIChTY2FsYWJsZSBTYW1wbGUgUmF0ZSlcclxuICAgICAgICAgICAgICAgNDogQUFDIExUUCAoTG9uZyBUZXJtIFByZWRpY3Rpb24pXHJcbiAgICAgICAgICAgICAgIDU6IEhFLUFBQyAvIFNCUiAoU3BlY3RyYWwgQmFuZCBSZXBsaWNhdGlvbilcclxuICAgICAgICAgICAgICAgNjogQUFDIFNjYWxhYmxlXHJcbiAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIHZhciBhdWRpb09iamVjdFR5cGUgPSAwO1xuICAgICAgICAgICAgdmFyIG9yaWdpbmFsQXVkaW9PYmplY3RUeXBlID0gMDtcbiAgICAgICAgICAgIHZhciBhdWRpb0V4dGVuc2lvbk9iamVjdFR5cGUgPSBudWxsO1xuICAgICAgICAgICAgdmFyIHNhbXBsaW5nSW5kZXggPSAwO1xuICAgICAgICAgICAgdmFyIGV4dGVuc2lvblNhbXBsaW5nSW5kZXggPSBudWxsO1xuXG4gICAgICAgICAgICAvLyA1IGJpdHNcbiAgICAgICAgICAgIGF1ZGlvT2JqZWN0VHlwZSA9IG9yaWdpbmFsQXVkaW9PYmplY3RUeXBlID0gYXJyYXlbMF0gPj4+IDM7XG4gICAgICAgICAgICAvLyA0IGJpdHNcbiAgICAgICAgICAgIHNhbXBsaW5nSW5kZXggPSAoYXJyYXlbMF0gJiAweDA3KSA8PCAxIHwgYXJyYXlbMV0gPj4+IDc7XG4gICAgICAgICAgICBpZiAoc2FtcGxpbmdJbmRleCA8IDAgfHwgc2FtcGxpbmdJbmRleCA+PSB0aGlzLl9tcGVnU2FtcGxpbmdSYXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKF9kZW11eEVycm9yczIuZGVmYXVsdC5GT1JNQVRfRVJST1IsICdGbHY6IEFBQyBpbnZhbGlkIHNhbXBsaW5nIGZyZXF1ZW5jeSBpbmRleCEnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzYW1wbGluZ0ZyZXF1ZW5jZSA9IHRoaXMuX21wZWdTYW1wbGluZ1JhdGVzW3NhbXBsaW5nSW5kZXhdO1xuXG4gICAgICAgICAgICAvLyA0IGJpdHNcbiAgICAgICAgICAgIHZhciBjaGFubmVsQ29uZmlnID0gKGFycmF5WzFdICYgMHg3OCkgPj4+IDM7XG4gICAgICAgICAgICBpZiAoY2hhbm5lbENvbmZpZyA8IDAgfHwgY2hhbm5lbENvbmZpZyA+PSA4KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcihfZGVtdXhFcnJvcnMyLmRlZmF1bHQuRk9STUFUX0VSUk9SLCAnRmx2OiBBQUMgaW52YWxpZCBjaGFubmVsIGNvbmZpZ3VyYXRpb24nKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChhdWRpb09iamVjdFR5cGUgPT09IDUpIHtcbiAgICAgICAgICAgICAgICAvLyBIRS1BQUM/XG4gICAgICAgICAgICAgICAgLy8gNCBiaXRzXG4gICAgICAgICAgICAgICAgZXh0ZW5zaW9uU2FtcGxpbmdJbmRleCA9IChhcnJheVsxXSAmIDB4MDcpIDw8IDEgfCBhcnJheVsyXSA+Pj4gNztcbiAgICAgICAgICAgICAgICAvLyA1IGJpdHNcbiAgICAgICAgICAgICAgICBhdWRpb0V4dGVuc2lvbk9iamVjdFR5cGUgPSAoYXJyYXlbMl0gJiAweDdDKSA+Pj4gMjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gd29ya2Fyb3VuZHMgZm9yIHZhcmlvdXMgYnJvd3NlcnNcbiAgICAgICAgICAgIHZhciB1c2VyQWdlbnQgPSBzZWxmLm5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICAgICAgaWYgKHVzZXJBZ2VudC5pbmRleE9mKCdmaXJlZm94JykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgLy8gZmlyZWZveDogdXNlIFNCUiAoSEUtQUFDKSBpZiBmcmVxIGxlc3MgdGhhbiAyNGtIelxuICAgICAgICAgICAgICAgIGlmIChzYW1wbGluZ0luZGV4ID49IDYpIHtcbiAgICAgICAgICAgICAgICAgICAgYXVkaW9PYmplY3RUeXBlID0gNTtcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnID0gbmV3IEFycmF5KDQpO1xuICAgICAgICAgICAgICAgICAgICBleHRlbnNpb25TYW1wbGluZ0luZGV4ID0gc2FtcGxpbmdJbmRleCAtIDM7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdXNlIExDLUFBQ1xuICAgICAgICAgICAgICAgICAgICBhdWRpb09iamVjdFR5cGUgPSAyO1xuICAgICAgICAgICAgICAgICAgICBjb25maWcgPSBuZXcgQXJyYXkoMik7XG4gICAgICAgICAgICAgICAgICAgIGV4dGVuc2lvblNhbXBsaW5nSW5kZXggPSBzYW1wbGluZ0luZGV4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodXNlckFnZW50LmluZGV4T2YoJ2FuZHJvaWQnKSAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAvLyBhbmRyb2lkOiBhbHdheXMgdXNlIExDLUFBQ1xuICAgICAgICAgICAgICAgIGF1ZGlvT2JqZWN0VHlwZSA9IDI7XG4gICAgICAgICAgICAgICAgY29uZmlnID0gbmV3IEFycmF5KDIpO1xuICAgICAgICAgICAgICAgIGV4dGVuc2lvblNhbXBsaW5nSW5kZXggPSBzYW1wbGluZ0luZGV4O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBmb3Igb3RoZXIgYnJvd3NlcnMsIGUuZy4gY2hyb21lLi4uXG4gICAgICAgICAgICAgICAgLy8gQWx3YXlzIHVzZSBIRS1BQUMgdG8gbWFrZSBpdCBlYXNpZXIgdG8gc3dpdGNoIGFhYyBjb2RlYyBwcm9maWxlXG4gICAgICAgICAgICAgICAgYXVkaW9PYmplY3RUeXBlID0gNTtcbiAgICAgICAgICAgICAgICBleHRlbnNpb25TYW1wbGluZ0luZGV4ID0gc2FtcGxpbmdJbmRleDtcbiAgICAgICAgICAgICAgICBjb25maWcgPSBuZXcgQXJyYXkoNCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoc2FtcGxpbmdJbmRleCA+PSA2KSB7XG4gICAgICAgICAgICAgICAgICAgIGV4dGVuc2lvblNhbXBsaW5nSW5kZXggPSBzYW1wbGluZ0luZGV4IC0gMztcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5uZWxDb25maWcgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTW9ubyBjaGFubmVsXG4gICAgICAgICAgICAgICAgICAgIGF1ZGlvT2JqZWN0VHlwZSA9IDI7XG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZyA9IG5ldyBBcnJheSgyKTtcbiAgICAgICAgICAgICAgICAgICAgZXh0ZW5zaW9uU2FtcGxpbmdJbmRleCA9IHNhbXBsaW5nSW5kZXg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25maWdbMF0gPSBhdWRpb09iamVjdFR5cGUgPDwgMztcbiAgICAgICAgICAgIGNvbmZpZ1swXSB8PSAoc2FtcGxpbmdJbmRleCAmIDB4MEYpID4+PiAxO1xuICAgICAgICAgICAgY29uZmlnWzFdID0gKHNhbXBsaW5nSW5kZXggJiAweDBGKSA8PCA3O1xuICAgICAgICAgICAgY29uZmlnWzFdIHw9IChjaGFubmVsQ29uZmlnICYgMHgwRikgPDwgMztcbiAgICAgICAgICAgIGlmIChhdWRpb09iamVjdFR5cGUgPT09IDUpIHtcbiAgICAgICAgICAgICAgICBjb25maWdbMV0gfD0gKGV4dGVuc2lvblNhbXBsaW5nSW5kZXggJiAweDBGKSA+Pj4gMTtcbiAgICAgICAgICAgICAgICBjb25maWdbMl0gPSAoZXh0ZW5zaW9uU2FtcGxpbmdJbmRleCAmIDB4MDEpIDw8IDc7XG4gICAgICAgICAgICAgICAgLy8gZXh0ZW5kZWQgYXVkaW8gb2JqZWN0IHR5cGU6IGZvcmNlIHRvIDIgKExDLUFBQylcbiAgICAgICAgICAgICAgICBjb25maWdbMl0gfD0gMiA8PCAyO1xuICAgICAgICAgICAgICAgIGNvbmZpZ1szXSA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgY29uZmlnOiBjb25maWcsXG4gICAgICAgICAgICAgICAgc2FtcGxpbmdSYXRlOiBzYW1wbGluZ0ZyZXF1ZW5jZSxcbiAgICAgICAgICAgICAgICBjaGFubmVsQ291bnQ6IGNoYW5uZWxDb25maWcsXG4gICAgICAgICAgICAgICAgY29kZWM6ICdtcDRhLjQwLicgKyBhdWRpb09iamVjdFR5cGUsXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxDb2RlYzogJ21wNGEuNDAuJyArIG9yaWdpbmFsQXVkaW9PYmplY3RUeXBlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcGFyc2VNUDNBdWRpb0RhdGEnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3BhcnNlTVAzQXVkaW9EYXRhKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSwgcmVxdWVzdEhlYWRlcikge1xuICAgICAgICAgICAgaWYgKGRhdGFTaXplIDwgNCkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ0ZsdjogSW52YWxpZCBNUDMgcGFja2V0LCBoZWFkZXIgbWlzc2luZyEnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBsZSA9IHRoaXMuX2xpdHRsZUVuZGlhbjtcbiAgICAgICAgICAgIHZhciBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSk7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKHJlcXVlc3RIZWFkZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAoYXJyYXlbMF0gIT09IDB4RkYpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB2YXIgdmVyID0gYXJyYXlbMV0gPj4+IDMgJiAweDAzO1xuICAgICAgICAgICAgICAgIHZhciBsYXllciA9IChhcnJheVsxXSAmIDB4MDYpID4+IDE7XG5cbiAgICAgICAgICAgICAgICB2YXIgYml0cmF0ZV9pbmRleCA9IChhcnJheVsyXSAmIDB4RjApID4+PiA0O1xuICAgICAgICAgICAgICAgIHZhciBzYW1wbGluZ19mcmVxX2luZGV4ID0gKGFycmF5WzJdICYgMHgwQykgPj4+IDI7XG5cbiAgICAgICAgICAgICAgICB2YXIgY2hhbm5lbF9tb2RlID0gYXJyYXlbM10gPj4+IDYgJiAweDAzO1xuICAgICAgICAgICAgICAgIHZhciBjaGFubmVsX2NvdW50ID0gY2hhbm5lbF9tb2RlICE9PSAzID8gMiA6IDE7XG5cbiAgICAgICAgICAgICAgICB2YXIgc2FtcGxlX3JhdGUgPSAwO1xuICAgICAgICAgICAgICAgIHZhciBiaXRfcmF0ZSA9IDA7XG4gICAgICAgICAgICAgICAgdmFyIG9iamVjdF90eXBlID0gMzQ7IC8vIExheWVyLTMsIGxpc3RlZCBpbiBNUEVHLTQgQXVkaW8gT2JqZWN0IFR5cGVzXG5cbiAgICAgICAgICAgICAgICB2YXIgY29kZWMgPSAnbXAzJztcblxuICAgICAgICAgICAgICAgIHN3aXRjaCAodmVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1QRUcgMi41XG4gICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVfcmF0ZSA9IHRoaXMuX21wZWdBdWRpb1YyNVNhbXBsZVJhdGVUYWJsZVtzYW1wbGluZ19mcmVxX2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBNUEVHIDJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhbXBsZV9yYXRlID0gdGhpcy5fbXBlZ0F1ZGlvVjIwU2FtcGxlUmF0ZVRhYmxlW3NhbXBsaW5nX2ZyZXFfaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1QRUcgMVxuICAgICAgICAgICAgICAgICAgICAgICAgc2FtcGxlX3JhdGUgPSB0aGlzLl9tcGVnQXVkaW9WMTBTYW1wbGVSYXRlVGFibGVbc2FtcGxpbmdfZnJlcV9pbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzd2l0Y2ggKGxheWVyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIExheWVyIDNcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdF90eXBlID0gMzQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYml0cmF0ZV9pbmRleCA8IHRoaXMuX21wZWdBdWRpb0wzQml0UmF0ZVRhYmxlLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdF9yYXRlID0gdGhpcy5fbXBlZ0F1ZGlvTDNCaXRSYXRlVGFibGVbYml0cmF0ZV9pbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTGF5ZXIgMlxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0X3R5cGUgPSAzMztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXRyYXRlX2luZGV4IDwgdGhpcy5fbXBlZ0F1ZGlvTDJCaXRSYXRlVGFibGUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYml0X3JhdGUgPSB0aGlzLl9tcGVnQXVkaW9MMkJpdFJhdGVUYWJsZVtiaXRyYXRlX2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBMYXllciAxXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RfdHlwZSA9IDMyO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpdHJhdGVfaW5kZXggPCB0aGlzLl9tcGVnQXVkaW9MMUJpdFJhdGVUYWJsZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRfcmF0ZSA9IHRoaXMuX21wZWdBdWRpb0wxQml0UmF0ZVRhYmxlW2JpdHJhdGVfaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuICAgICAgICAgICAgICAgICAgICBiaXRSYXRlOiBiaXRfcmF0ZSxcbiAgICAgICAgICAgICAgICAgICAgc2FtcGxpbmdSYXRlOiBzYW1wbGVfcmF0ZSxcbiAgICAgICAgICAgICAgICAgICAgY2hhbm5lbENvdW50OiBjaGFubmVsX2NvdW50LFxuICAgICAgICAgICAgICAgICAgICBjb2RlYzogY29kZWMsXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsQ29kZWM6IGNvZGVjXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gYXJyYXk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19wYXJzZVZpZGVvRGF0YScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcGFyc2VWaWRlb0RhdGEoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplLCB0YWdUaW1lc3RhbXAsIHRhZ1Bvc2l0aW9uKSB7XG4gICAgICAgICAgICBpZiAoZGF0YVNpemUgPD0gMSkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ0ZsdjogSW52YWxpZCB2aWRlbyBwYWNrZXQsIG1pc3NpbmcgVmlkZW9EYXRhIHBheWxvYWQhJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5faGFzVmlkZW9GbGFnT3ZlcnJpZGVkID09PSB0cnVlICYmIHRoaXMuX2hhc1ZpZGVvID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIC8vIElmIGhhc1ZpZGVvOiBmYWxzZSBpbmRpY2F0ZWQgZXhwbGljaXRseSBpbiBNZWRpYURhdGFTb3VyY2UsXG4gICAgICAgICAgICAgICAgLy8gSWdub3JlIGFsbCB0aGUgdmlkZW8gcGFja2V0c1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHNwZWMgPSBuZXcgVWludDhBcnJheShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpWzBdO1xuXG4gICAgICAgICAgICB2YXIgZnJhbWVUeXBlID0gKHNwZWMgJiAyNDApID4+PiA0O1xuICAgICAgICAgICAgdmFyIGNvZGVjSWQgPSBzcGVjICYgMTU7XG5cbiAgICAgICAgICAgIGlmIChjb2RlY0lkICE9PSA3KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcihfZGVtdXhFcnJvcnMyLmRlZmF1bHQuQ09ERUNfVU5TVVBQT1JURUQsICdGbHY6IFVuc3VwcG9ydGVkIGNvZGVjIGluIHZpZGVvIGZyYW1lOiAnICsgY29kZWNJZCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9wYXJzZUFWQ1ZpZGVvUGFja2V0KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgMSwgZGF0YVNpemUgLSAxLCB0YWdUaW1lc3RhbXAsIHRhZ1Bvc2l0aW9uLCBmcmFtZVR5cGUpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcGFyc2VBVkNWaWRlb1BhY2tldCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcGFyc2VBVkNWaWRlb1BhY2tldChhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUsIHRhZ1RpbWVzdGFtcCwgdGFnUG9zaXRpb24sIGZyYW1lVHlwZSkge1xuICAgICAgICAgICAgaWYgKGRhdGFTaXplIDwgNCkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ0ZsdjogSW52YWxpZCBBVkMgcGFja2V0LCBtaXNzaW5nIEFWQ1BhY2tldFR5cGUgb3IvYW5kIENvbXBvc2l0aW9uVGltZScpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGxlID0gdGhpcy5fbGl0dGxlRW5kaWFuO1xuICAgICAgICAgICAgdmFyIHYgPSBuZXcgRGF0YVZpZXcoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKTtcblxuICAgICAgICAgICAgdmFyIHBhY2tldFR5cGUgPSB2LmdldFVpbnQ4KDApO1xuICAgICAgICAgICAgdmFyIGN0c191bnNpZ25lZCA9IHYuZ2V0VWludDMyKDAsICFsZSkgJiAweDAwRkZGRkZGO1xuICAgICAgICAgICAgdmFyIGN0cyA9IGN0c191bnNpZ25lZCA8PCA4ID4+IDg7IC8vIGNvbnZlcnQgdG8gMjQtYml0IHNpZ25lZCBpbnRcblxuICAgICAgICAgICAgaWYgKHBhY2tldFR5cGUgPT09IDApIHtcbiAgICAgICAgICAgICAgICAvLyBBVkNEZWNvZGVyQ29uZmlndXJhdGlvblJlY29yZFxuICAgICAgICAgICAgICAgIHRoaXMuX3BhcnNlQVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyA0LCBkYXRhU2l6ZSAtIDQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwYWNrZXRUeXBlID09PSAxKSB7XG4gICAgICAgICAgICAgICAgLy8gT25lIG9yIG1vcmUgTmFsdXNcbiAgICAgICAgICAgICAgICB0aGlzLl9wYXJzZUFWQ1ZpZGVvRGF0YShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIDQsIGRhdGFTaXplIC0gNCwgdGFnVGltZXN0YW1wLCB0YWdQb3NpdGlvbiwgZnJhbWVUeXBlLCBjdHMpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwYWNrZXRUeXBlID09PSAyKSB7XG4gICAgICAgICAgICAgICAgLy8gZW1wdHksIEFWQyBlbmQgb2Ygc2VxdWVuY2VcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcihfZGVtdXhFcnJvcnMyLmRlZmF1bHQuRk9STUFUX0VSUk9SLCAnRmx2OiBJbnZhbGlkIHZpZGVvIHBhY2tldCB0eXBlICcgKyBwYWNrZXRUeXBlKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19wYXJzZUFWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9wYXJzZUFWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSkge1xuICAgICAgICAgICAgaWYgKGRhdGFTaXplIDwgNykge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ0ZsdjogSW52YWxpZCBBVkNEZWNvZGVyQ29uZmlndXJhdGlvblJlY29yZCwgbGFjayBvZiBkYXRhIScpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIG1ldGEgPSB0aGlzLl92aWRlb01ldGFkYXRhO1xuICAgICAgICAgICAgdmFyIHRyYWNrID0gdGhpcy5fdmlkZW9UcmFjaztcbiAgICAgICAgICAgIHZhciBsZSA9IHRoaXMuX2xpdHRsZUVuZGlhbjtcbiAgICAgICAgICAgIHZhciB2ID0gbmV3IERhdGFWaWV3KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSk7XG5cbiAgICAgICAgICAgIGlmICghbWV0YSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9oYXNWaWRlbyA9PT0gZmFsc2UgJiYgdGhpcy5faGFzVmlkZW9GbGFnT3ZlcnJpZGVkID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYXNWaWRlbyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5oYXNWaWRlbyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbWV0YSA9IHRoaXMuX3ZpZGVvTWV0YWRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICBtZXRhLnR5cGUgPSAndmlkZW8nO1xuICAgICAgICAgICAgICAgIG1ldGEuaWQgPSB0cmFjay5pZDtcbiAgICAgICAgICAgICAgICBtZXRhLnRpbWVzY2FsZSA9IHRoaXMuX3RpbWVzY2FsZTtcbiAgICAgICAgICAgICAgICBtZXRhLmR1cmF0aW9uID0gdGhpcy5fZHVyYXRpb247XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbWV0YS5hdmNjICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdGb3VuZCBhbm90aGVyIEFWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkIScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHZlcnNpb24gPSB2LmdldFVpbnQ4KDApOyAvLyBjb25maWd1cmF0aW9uVmVyc2lvblxuICAgICAgICAgICAgdmFyIGF2Y1Byb2ZpbGUgPSB2LmdldFVpbnQ4KDEpOyAvLyBhdmNQcm9maWxlSW5kaWNhdGlvblxuICAgICAgICAgICAgdmFyIHByb2ZpbGVDb21wYXRpYmlsaXR5ID0gdi5nZXRVaW50OCgyKTsgLy8gcHJvZmlsZV9jb21wYXRpYmlsaXR5XG4gICAgICAgICAgICB2YXIgYXZjTGV2ZWwgPSB2LmdldFVpbnQ4KDMpOyAvLyBBVkNMZXZlbEluZGljYXRpb25cblxuICAgICAgICAgICAgaWYgKHZlcnNpb24gIT09IDEgfHwgYXZjUHJvZmlsZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoX2RlbXV4RXJyb3JzMi5kZWZhdWx0LkZPUk1BVF9FUlJPUiwgJ0ZsdjogSW52YWxpZCBBVkNEZWNvZGVyQ29uZmlndXJhdGlvblJlY29yZCcpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fbmFsdUxlbmd0aFNpemUgPSAodi5nZXRVaW50OCg0KSAmIDMpICsgMTsgLy8gbGVuZ3RoU2l6ZU1pbnVzT25lXG4gICAgICAgICAgICBpZiAodGhpcy5fbmFsdUxlbmd0aFNpemUgIT09IDMgJiYgdGhpcy5fbmFsdUxlbmd0aFNpemUgIT09IDQpIHtcbiAgICAgICAgICAgICAgICAvLyBob2x5IHNoaXQhISFcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKF9kZW11eEVycm9yczIuZGVmYXVsdC5GT1JNQVRfRVJST1IsICdGbHY6IFN0cmFuZ2UgTmFsdUxlbmd0aFNpemVNaW51c09uZTogJyArICh0aGlzLl9uYWx1TGVuZ3RoU2l6ZSAtIDEpKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzcHNDb3VudCA9IHYuZ2V0VWludDgoNSkgJiAzMTsgLy8gbnVtT2ZTZXF1ZW5jZVBhcmFtZXRlclNldHNcbiAgICAgICAgICAgIGlmIChzcHNDb3VudCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoX2RlbXV4RXJyb3JzMi5kZWZhdWx0LkZPUk1BVF9FUlJPUiwgJ0ZsdjogSW52YWxpZCBBVkNEZWNvZGVyQ29uZmlndXJhdGlvblJlY29yZDogTm8gU1BTJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChzcHNDb3VudCA+IDEpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdGbHY6IFN0cmFuZ2UgQVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQ6IFNQUyBDb3VudCA9ICcgKyBzcHNDb3VudCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBvZmZzZXQgPSA2O1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNwc0NvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgbGVuID0gdi5nZXRVaW50MTYob2Zmc2V0LCAhbGUpOyAvLyBzZXF1ZW5jZVBhcmFtZXRlclNldExlbmd0aFxuICAgICAgICAgICAgICAgIG9mZnNldCArPSAyO1xuXG4gICAgICAgICAgICAgICAgaWYgKGxlbiA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBOb3RpY2U6IE5hbHUgd2l0aG91dCBzdGFydGNvZGUgaGVhZGVyICgwMCAwMCAwMCAwMSlcbiAgICAgICAgICAgICAgICB2YXIgc3BzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyBvZmZzZXQsIGxlbik7XG4gICAgICAgICAgICAgICAgb2Zmc2V0ICs9IGxlbjtcblxuICAgICAgICAgICAgICAgIHZhciBjb25maWcgPSBfc3BzUGFyc2VyMi5kZWZhdWx0LnBhcnNlU1BTKHNwcyk7XG4gICAgICAgICAgICAgICAgaWYgKGkgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlIG90aGVyIHNwcydzIGNvbmZpZ1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBtZXRhLmNvZGVjV2lkdGggPSBjb25maWcuY29kZWNfc2l6ZS53aWR0aDtcbiAgICAgICAgICAgICAgICBtZXRhLmNvZGVjSGVpZ2h0ID0gY29uZmlnLmNvZGVjX3NpemUuaGVpZ2h0O1xuICAgICAgICAgICAgICAgIG1ldGEucHJlc2VudFdpZHRoID0gY29uZmlnLnByZXNlbnRfc2l6ZS53aWR0aDtcbiAgICAgICAgICAgICAgICBtZXRhLnByZXNlbnRIZWlnaHQgPSBjb25maWcucHJlc2VudF9zaXplLmhlaWdodDtcblxuICAgICAgICAgICAgICAgIG1ldGEucHJvZmlsZSA9IGNvbmZpZy5wcm9maWxlX3N0cmluZztcbiAgICAgICAgICAgICAgICBtZXRhLmxldmVsID0gY29uZmlnLmxldmVsX3N0cmluZztcbiAgICAgICAgICAgICAgICBtZXRhLmJpdERlcHRoID0gY29uZmlnLmJpdF9kZXB0aDtcbiAgICAgICAgICAgICAgICBtZXRhLmNocm9tYUZvcm1hdCA9IGNvbmZpZy5jaHJvbWFfZm9ybWF0O1xuICAgICAgICAgICAgICAgIG1ldGEuc2FyUmF0aW8gPSBjb25maWcuc2FyX3JhdGlvO1xuICAgICAgICAgICAgICAgIG1ldGEuZnJhbWVSYXRlID0gY29uZmlnLmZyYW1lX3JhdGU7XG5cbiAgICAgICAgICAgICAgICBpZiAoY29uZmlnLmZyYW1lX3JhdGUuZml4ZWQgPT09IGZhbHNlIHx8IGNvbmZpZy5mcmFtZV9yYXRlLmZwc19udW0gPT09IDAgfHwgY29uZmlnLmZyYW1lX3JhdGUuZnBzX2RlbiA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBtZXRhLmZyYW1lUmF0ZSA9IHRoaXMuX3JlZmVyZW5jZUZyYW1lUmF0ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgZnBzX2RlbiA9IG1ldGEuZnJhbWVSYXRlLmZwc19kZW47XG4gICAgICAgICAgICAgICAgdmFyIGZwc19udW0gPSBtZXRhLmZyYW1lUmF0ZS5mcHNfbnVtO1xuICAgICAgICAgICAgICAgIG1ldGEucmVmU2FtcGxlRHVyYXRpb24gPSBtZXRhLnRpbWVzY2FsZSAqIChmcHNfZGVuIC8gZnBzX251bSk7XG5cbiAgICAgICAgICAgICAgICB2YXIgY29kZWNBcnJheSA9IHNwcy5zdWJhcnJheSgxLCA0KTtcbiAgICAgICAgICAgICAgICB2YXIgY29kZWNTdHJpbmcgPSAnYXZjMS4nO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMzsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBoID0gY29kZWNBcnJheVtqXS50b1N0cmluZygxNik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChoLmxlbmd0aCA8IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGggPSAnMCcgKyBoO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvZGVjU3RyaW5nICs9IGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG1ldGEuY29kZWMgPSBjb2RlY1N0cmluZztcblxuICAgICAgICAgICAgICAgIHZhciBtaSA9IHRoaXMuX21lZGlhSW5mbztcbiAgICAgICAgICAgICAgICBtaS53aWR0aCA9IG1ldGEuY29kZWNXaWR0aDtcbiAgICAgICAgICAgICAgICBtaS5oZWlnaHQgPSBtZXRhLmNvZGVjSGVpZ2h0O1xuICAgICAgICAgICAgICAgIG1pLmZwcyA9IG1ldGEuZnJhbWVSYXRlLmZwcztcbiAgICAgICAgICAgICAgICBtaS5wcm9maWxlID0gbWV0YS5wcm9maWxlO1xuICAgICAgICAgICAgICAgIG1pLmxldmVsID0gbWV0YS5sZXZlbDtcbiAgICAgICAgICAgICAgICBtaS5yZWZGcmFtZXMgPSBjb25maWcucmVmX2ZyYW1lcztcbiAgICAgICAgICAgICAgICBtaS5jaHJvbWFGb3JtYXQgPSBjb25maWcuY2hyb21hX2Zvcm1hdF9zdHJpbmc7XG4gICAgICAgICAgICAgICAgbWkuc2FyTnVtID0gbWV0YS5zYXJSYXRpby53aWR0aDtcbiAgICAgICAgICAgICAgICBtaS5zYXJEZW4gPSBtZXRhLnNhclJhdGlvLmhlaWdodDtcbiAgICAgICAgICAgICAgICBtaS52aWRlb0NvZGVjID0gY29kZWNTdHJpbmc7XG5cbiAgICAgICAgICAgICAgICBpZiAobWkuaGFzQXVkaW8pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1pLmF1ZGlvQ29kZWMgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWkubWltZVR5cGUgPSAndmlkZW8veC1mbHY7IGNvZGVjcz1cIicgKyBtaS52aWRlb0NvZGVjICsgJywnICsgbWkuYXVkaW9Db2RlYyArICdcIic7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBtaS5taW1lVHlwZSA9ICd2aWRlby94LWZsdjsgY29kZWNzPVwiJyArIG1pLnZpZGVvQ29kZWMgKyAnXCInO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobWkuaXNDb21wbGV0ZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uTWVkaWFJbmZvKG1pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBwcHNDb3VudCA9IHYuZ2V0VWludDgob2Zmc2V0KTsgLy8gbnVtT2ZQaWN0dXJlUGFyYW1ldGVyU2V0c1xuICAgICAgICAgICAgaWYgKHBwc0NvdW50ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcihfZGVtdXhFcnJvcnMyLmRlZmF1bHQuRk9STUFUX0VSUk9SLCAnRmx2OiBJbnZhbGlkIEFWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkOiBObyBQUFMnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBwc0NvdW50ID4gMSkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ0ZsdjogU3RyYW5nZSBBVkNEZWNvZGVyQ29uZmlndXJhdGlvblJlY29yZDogUFBTIENvdW50ID0gJyArIHBwc0NvdW50KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgb2Zmc2V0Kys7XG5cbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBwcHNDb3VudDsgX2krKykge1xuICAgICAgICAgICAgICAgIHZhciBfbGVuID0gdi5nZXRVaW50MTYob2Zmc2V0LCAhbGUpOyAvLyBwaWN0dXJlUGFyYW1ldGVyU2V0TGVuZ3RoXG4gICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDI7XG5cbiAgICAgICAgICAgICAgICBpZiAoX2xlbiA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBwcHMgaXMgdXNlbGVzcyBmb3IgZXh0cmFjdGluZyB2aWRlbyBpbmZvcm1hdGlvblxuICAgICAgICAgICAgICAgIG9mZnNldCArPSBfbGVuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBtZXRhLmF2Y2MgPSBuZXcgVWludDhBcnJheShkYXRhU2l6ZSk7XG4gICAgICAgICAgICBtZXRhLmF2Y2Muc2V0KG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSksIDApO1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KHRoaXMuVEFHLCAnUGFyc2VkIEFWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkJyk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9pc0luaXRpYWxNZXRhZGF0YURpc3BhdGNoZWQoKSkge1xuICAgICAgICAgICAgICAgIC8vIGZsdXNoIHBhcnNlZCBmcmFtZXNcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fZGlzcGF0Y2ggJiYgKHRoaXMuX2F1ZGlvVHJhY2subGVuZ3RoIHx8IHRoaXMuX3ZpZGVvVHJhY2subGVuZ3RoKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkRhdGFBdmFpbGFibGUodGhpcy5fYXVkaW9UcmFjaywgdGhpcy5fdmlkZW9UcmFjayk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl92aWRlb0luaXRpYWxNZXRhZGF0YURpc3BhdGNoZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gbm90aWZ5IG5ldyBtZXRhZGF0YVxuICAgICAgICAgICAgdGhpcy5fZGlzcGF0Y2ggPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX29uVHJhY2tNZXRhZGF0YSgndmlkZW8nLCBtZXRhKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3BhcnNlQVZDVmlkZW9EYXRhJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9wYXJzZUFWQ1ZpZGVvRGF0YShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUsIHRhZ1RpbWVzdGFtcCwgdGFnUG9zaXRpb24sIGZyYW1lVHlwZSwgY3RzKSB7XG4gICAgICAgICAgICB2YXIgbGUgPSB0aGlzLl9saXR0bGVFbmRpYW47XG4gICAgICAgICAgICB2YXIgdiA9IG5ldyBEYXRhVmlldyhhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpO1xuXG4gICAgICAgICAgICB2YXIgdW5pdHMgPSBbXSxcbiAgICAgICAgICAgICAgICBsZW5ndGggPSAwO1xuXG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gMDtcbiAgICAgICAgICAgIHZhciBsZW5ndGhTaXplID0gdGhpcy5fbmFsdUxlbmd0aFNpemU7XG4gICAgICAgICAgICB2YXIgZHRzID0gdGhpcy5fdGltZXN0YW1wQmFzZSArIHRhZ1RpbWVzdGFtcDtcbiAgICAgICAgICAgIHZhciBrZXlmcmFtZSA9IGZyYW1lVHlwZSA9PT0gMTsgLy8gZnJvbSBGTFYgRnJhbWUgVHlwZSBjb25zdGFudHNcblxuICAgICAgICAgICAgd2hpbGUgKG9mZnNldCA8IGRhdGFTaXplKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9mZnNldCArIDQgPj0gZGF0YVNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnTWFsZm9ybWVkIE5hbHUgbmVhciB0aW1lc3RhbXAgJyArIGR0cyArICcsIG9mZnNldCA9ICcgKyBvZmZzZXQgKyAnLCBkYXRhU2l6ZSA9ICcgKyBkYXRhU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrOyAvLyBkYXRhIG5vdCBlbm91Z2ggZm9yIG5leHQgTmFsdVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyBOYWx1IHdpdGggbGVuZ3RoLWhlYWRlciAoQVZDMSlcbiAgICAgICAgICAgICAgICB2YXIgbmFsdVNpemUgPSB2LmdldFVpbnQzMihvZmZzZXQsICFsZSk7IC8vIEJpZy1FbmRpYW4gcmVhZFxuICAgICAgICAgICAgICAgIGlmIChsZW5ndGhTaXplID09PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgIG5hbHVTaXplID4+Pj0gODtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5hbHVTaXplID4gZGF0YVNpemUgLSBsZW5ndGhTaXplKSB7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ01hbGZvcm1lZCBOYWx1cyBuZWFyIHRpbWVzdGFtcCAnICsgZHRzICsgJywgTmFsdVNpemUgPiBEYXRhU2l6ZSEnKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB1bml0VHlwZSA9IHYuZ2V0VWludDgob2Zmc2V0ICsgbGVuZ3RoU2l6ZSkgJiAweDFGO1xuXG4gICAgICAgICAgICAgICAgaWYgKHVuaXRUeXBlID09PSA1KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElEUlxuICAgICAgICAgICAgICAgICAgICBrZXlmcmFtZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBuZXcgVWludDhBcnJheShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIG9mZnNldCwgbGVuZ3RoU2l6ZSArIG5hbHVTaXplKTtcbiAgICAgICAgICAgICAgICB2YXIgdW5pdCA9IHsgdHlwZTogdW5pdFR5cGUsIGRhdGE6IGRhdGEgfTtcbiAgICAgICAgICAgICAgICB1bml0cy5wdXNoKHVuaXQpO1xuICAgICAgICAgICAgICAgIGxlbmd0aCArPSBkYXRhLmJ5dGVMZW5ndGg7XG5cbiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gbGVuZ3RoU2l6ZSArIG5hbHVTaXplO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodW5pdHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRyYWNrID0gdGhpcy5fdmlkZW9UcmFjaztcbiAgICAgICAgICAgICAgICB2YXIgYXZjU2FtcGxlID0ge1xuICAgICAgICAgICAgICAgICAgICB1bml0czogdW5pdHMsXG4gICAgICAgICAgICAgICAgICAgIGxlbmd0aDogbGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICBpc0tleWZyYW1lOiBrZXlmcmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZHRzOiBkdHMsXG4gICAgICAgICAgICAgICAgICAgIGN0czogY3RzLFxuICAgICAgICAgICAgICAgICAgICBwdHM6IGR0cyArIGN0c1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaWYgKGtleWZyYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGF2Y1NhbXBsZS5maWxlcG9zaXRpb24gPSB0YWdQb3NpdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdHJhY2suc2FtcGxlcy5wdXNoKGF2Y1NhbXBsZSk7XG4gICAgICAgICAgICAgICAgdHJhY2subGVuZ3RoICs9IGxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25UcmFja01ldGFkYXRhJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25UcmFja01ldGFkYXRhO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25UcmFja01ldGFkYXRhID0gY2FsbGJhY2s7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBwcm90b3R5cGU6IGZ1bmN0aW9uKG1lZGlhSW5mbzogTWVkaWFJbmZvKTogdm9pZFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbk1lZGlhSW5mbycsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uTWVkaWFJbmZvO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25NZWRpYUluZm8gPSBjYWxsYmFjaztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25NZXRhRGF0YUFycml2ZWQnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vbk1ldGFEYXRhQXJyaXZlZDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uTWV0YURhdGFBcnJpdmVkID0gY2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uU2NyaXB0RGF0YUFycml2ZWQnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vblNjcmlwdERhdGFBcnJpdmVkO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25TY3JpcHREYXRhQXJyaXZlZCA9IGNhbGxiYWNrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcHJvdG90eXBlOiBmdW5jdGlvbih0eXBlOiBudW1iZXIsIGluZm86IHN0cmluZyk6IHZvaWRcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25FcnJvcicsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uRXJyb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vbkVycm9yID0gY2FsbGJhY2s7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBwcm90b3R5cGU6IGZ1bmN0aW9uKHZpZGVvVHJhY2s6IGFueSwgYXVkaW9UcmFjazogYW55KTogdm9pZFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbkRhdGFBdmFpbGFibGUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vbkRhdGFBdmFpbGFibGU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vbkRhdGFBdmFpbGFibGUgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25TdHJlYW1UaW1lJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25TdHJlYW1UaW1lO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25TdHJlYW1UaW1lID0gY2FsbGJhY2s7XG4gICAgICAgIH1cblxuICAgICAgICAvLyB0aW1lc3RhbXAgYmFzZSBmb3Igb3V0cHV0IHNhbXBsZXMsIG11c3QgYmUgaW4gbWlsbGlzZWNvbmRzXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3RpbWVzdGFtcEJhc2UnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90aW1lc3RhbXBCYXNlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChiYXNlKSB7XG4gICAgICAgICAgICB0aGlzLl90aW1lc3RhbXBCYXNlID0gYmFzZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb3ZlcnJpZGVkRHVyYXRpb24nLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kdXJhdGlvbjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZvcmNlLW92ZXJyaWRlIG1lZGlhIGR1cmF0aW9uLiBNdXN0IGJlIGluIG1pbGxpc2Vjb25kcywgaW50MzJcbiAgICAgICAgLFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChkdXJhdGlvbikge1xuICAgICAgICAgICAgdGhpcy5fZHVyYXRpb25PdmVycmlkZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5fZHVyYXRpb24gPSBkdXJhdGlvbjtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5kdXJhdGlvbiA9IGR1cmF0aW9uO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRm9yY2Utb3ZlcnJpZGUgYXVkaW8gdHJhY2sgcHJlc2VudCBmbGFnLCBib29sZWFuXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ292ZXJyaWRlZEhhc0F1ZGlvJyxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoaGFzQXVkaW8pIHtcbiAgICAgICAgICAgIHRoaXMuX2hhc0F1ZGlvRmxhZ092ZXJyaWRlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl9oYXNBdWRpbyA9IGhhc0F1ZGlvO1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmhhc0F1ZGlvID0gaGFzQXVkaW87XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGb3JjZS1vdmVycmlkZSB2aWRlbyB0cmFjayBwcmVzZW50IGZsYWcsIGJvb2xlYW5cblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb3ZlcnJpZGVkSGFzVmlkZW8nLFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChoYXNWaWRlbykge1xuICAgICAgICAgICAgdGhpcy5faGFzVmlkZW9GbGFnT3ZlcnJpZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuX2hhc1ZpZGVvID0gaGFzVmlkZW87XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uaGFzVmlkZW8gPSBoYXNWaWRlbztcbiAgICAgICAgfVxuICAgIH1dLCBbe1xuICAgICAgICBrZXk6ICdwcm9iZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwcm9iZShidWZmZXIpIHtcbiAgICAgICAgICAgIHZhciBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyKTtcbiAgICAgICAgICAgIHZhciBtaXNtYXRjaCA9IHsgbWF0Y2g6IGZhbHNlIH07XG5cbiAgICAgICAgICAgIGlmIChkYXRhWzBdICE9PSAweDQ2IHx8IGRhdGFbMV0gIT09IDB4NEMgfHwgZGF0YVsyXSAhPT0gMHg1NiB8fCBkYXRhWzNdICE9PSAweDAxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1pc21hdGNoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgaGFzQXVkaW8gPSAoZGF0YVs0XSAmIDQpID4+PiAyICE9PSAwO1xuICAgICAgICAgICAgdmFyIGhhc1ZpZGVvID0gKGRhdGFbNF0gJiAxKSAhPT0gMDtcblxuICAgICAgICAgICAgdmFyIG9mZnNldCA9IFJlYWRCaWczMihkYXRhLCA1KTtcblxuICAgICAgICAgICAgaWYgKG9mZnNldCA8IDkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWlzbWF0Y2g7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbWF0Y2g6IHRydWUsXG4gICAgICAgICAgICAgICAgY29uc3VtZWQ6IG9mZnNldCxcbiAgICAgICAgICAgICAgICBkYXRhT2Zmc2V0OiBvZmZzZXQsXG4gICAgICAgICAgICAgICAgaGFzQXVkaW9UcmFjazogaGFzQXVkaW8sXG4gICAgICAgICAgICAgICAgaGFzVmlkZW9UcmFjazogaGFzVmlkZW9cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gRkxWRGVtdXhlcjtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gRkxWRGVtdXhlcjtcblxufSx7XCIuLi9jb3JlL21lZGlhLWluZm8uanNcIjo3LFwiLi4vdXRpbHMvZXhjZXB0aW9uLmpzXCI6NDAsXCIuLi91dGlscy9sb2dnZXIuanNcIjo0MSxcIi4vYW1mLXBhcnNlci5qc1wiOjE1LFwiLi9kZW11eC1lcnJvcnMuanNcIjoxNixcIi4vc3BzLXBhcnNlci5qc1wiOjE5fV0sMTk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgX2V4cEdvbG9tYiA9IF9kZXJlcV8oJy4vZXhwLWdvbG9tYi5qcycpO1xuXG52YXIgX2V4cEdvbG9tYjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9leHBHb2xvbWIpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgU1BTUGFyc2VyID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNQU1BhcnNlcigpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNQU1BhcnNlcik7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFNQU1BhcnNlciwgbnVsbCwgW3tcbiAgICAgICAga2V5OiAnX2Vic3AycmJzcCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZWJzcDJyYnNwKHVpbnQ4YXJyYXkpIHtcbiAgICAgICAgICAgIHZhciBzcmMgPSB1aW50OGFycmF5O1xuICAgICAgICAgICAgdmFyIHNyY19sZW5ndGggPSBzcmMuYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgIHZhciBkc3QgPSBuZXcgVWludDhBcnJheShzcmNfbGVuZ3RoKTtcbiAgICAgICAgICAgIHZhciBkc3RfaWR4ID0gMDtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzcmNfbGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoaSA+PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFVuZXNjYXBlOiBTa2lwIDB4MDMgYWZ0ZXIgMDAgMDBcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNyY1tpXSA9PT0gMHgwMyAmJiBzcmNbaSAtIDFdID09PSAweDAwICYmIHNyY1tpIC0gMl0gPT09IDB4MDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRzdFtkc3RfaWR4XSA9IHNyY1tpXTtcbiAgICAgICAgICAgICAgICBkc3RfaWR4Kys7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShkc3QuYnVmZmVyLCAwLCBkc3RfaWR4KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncGFyc2VTUFMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGFyc2VTUFModWludDhhcnJheSkge1xuICAgICAgICAgICAgdmFyIHJic3AgPSBTUFNQYXJzZXIuX2Vic3AycmJzcCh1aW50OGFycmF5KTtcbiAgICAgICAgICAgIHZhciBnYiA9IG5ldyBfZXhwR29sb21iMi5kZWZhdWx0KHJic3ApO1xuXG4gICAgICAgICAgICBnYi5yZWFkQnl0ZSgpO1xuICAgICAgICAgICAgdmFyIHByb2ZpbGVfaWRjID0gZ2IucmVhZEJ5dGUoKTsgLy8gcHJvZmlsZV9pZGNcbiAgICAgICAgICAgIGdiLnJlYWRCeXRlKCk7IC8vIGNvbnN0cmFpbnRfc2V0X2ZsYWdzWzVdICsgcmVzZXJ2ZWRfemVyb1szXVxuICAgICAgICAgICAgdmFyIGxldmVsX2lkYyA9IGdiLnJlYWRCeXRlKCk7IC8vIGxldmVsX2lkY1xuICAgICAgICAgICAgZ2IucmVhZFVFRygpOyAvLyBzZXFfcGFyYW1ldGVyX3NldF9pZFxuXG4gICAgICAgICAgICB2YXIgcHJvZmlsZV9zdHJpbmcgPSBTUFNQYXJzZXIuZ2V0UHJvZmlsZVN0cmluZyhwcm9maWxlX2lkYyk7XG4gICAgICAgICAgICB2YXIgbGV2ZWxfc3RyaW5nID0gU1BTUGFyc2VyLmdldExldmVsU3RyaW5nKGxldmVsX2lkYyk7XG4gICAgICAgICAgICB2YXIgY2hyb21hX2Zvcm1hdF9pZGMgPSAxO1xuICAgICAgICAgICAgdmFyIGNocm9tYV9mb3JtYXQgPSA0MjA7XG4gICAgICAgICAgICB2YXIgY2hyb21hX2Zvcm1hdF90YWJsZSA9IFswLCA0MjAsIDQyMiwgNDQ0XTtcbiAgICAgICAgICAgIHZhciBiaXRfZGVwdGggPSA4O1xuXG4gICAgICAgICAgICBpZiAocHJvZmlsZV9pZGMgPT09IDEwMCB8fCBwcm9maWxlX2lkYyA9PT0gMTEwIHx8IHByb2ZpbGVfaWRjID09PSAxMjIgfHwgcHJvZmlsZV9pZGMgPT09IDI0NCB8fCBwcm9maWxlX2lkYyA9PT0gNDQgfHwgcHJvZmlsZV9pZGMgPT09IDgzIHx8IHByb2ZpbGVfaWRjID09PSA4NiB8fCBwcm9maWxlX2lkYyA9PT0gMTE4IHx8IHByb2ZpbGVfaWRjID09PSAxMjggfHwgcHJvZmlsZV9pZGMgPT09IDEzOCB8fCBwcm9maWxlX2lkYyA9PT0gMTQ0KSB7XG5cbiAgICAgICAgICAgICAgICBjaHJvbWFfZm9ybWF0X2lkYyA9IGdiLnJlYWRVRUcoKTtcbiAgICAgICAgICAgICAgICBpZiAoY2hyb21hX2Zvcm1hdF9pZGMgPT09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2IucmVhZEJpdHMoMSk7IC8vIHNlcGFyYXRlX2NvbG91cl9wbGFuZV9mbGFnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChjaHJvbWFfZm9ybWF0X2lkYyA8PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgIGNocm9tYV9mb3JtYXQgPSBjaHJvbWFfZm9ybWF0X3RhYmxlW2Nocm9tYV9mb3JtYXRfaWRjXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBiaXRfZGVwdGggPSBnYi5yZWFkVUVHKCkgKyA4OyAvLyBiaXRfZGVwdGhfbHVtYV9taW51czhcbiAgICAgICAgICAgICAgICBnYi5yZWFkVUVHKCk7IC8vIGJpdF9kZXB0aF9jaHJvbWFfbWludXM4XG4gICAgICAgICAgICAgICAgZ2IucmVhZEJpdHMoMSk7IC8vIHFwcHJpbWVfeV96ZXJvX3RyYW5zZm9ybV9ieXBhc3NfZmxhZ1xuICAgICAgICAgICAgICAgIGlmIChnYi5yZWFkQm9vbCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHNlcV9zY2FsaW5nX21hdHJpeF9wcmVzZW50X2ZsYWdcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNjYWxpbmdfbGlzdF9jb3VudCA9IGNocm9tYV9mb3JtYXRfaWRjICE9PSAzID8gOCA6IDEyO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNjYWxpbmdfbGlzdF9jb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2IucmVhZEJvb2woKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlcV9zY2FsaW5nX2xpc3RfcHJlc2VudF9mbGFnXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPCA2KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQU1BhcnNlci5fc2tpcFNjYWxpbmdMaXN0KGdiLCAxNik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU1BTUGFyc2VyLl9za2lwU2NhbGluZ0xpc3QoZ2IsIDY0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnYi5yZWFkVUVHKCk7IC8vIGxvZzJfbWF4X2ZyYW1lX251bV9taW51czRcbiAgICAgICAgICAgIHZhciBwaWNfb3JkZXJfY250X3R5cGUgPSBnYi5yZWFkVUVHKCk7XG4gICAgICAgICAgICBpZiAocGljX29yZGVyX2NudF90eXBlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgZ2IucmVhZFVFRygpOyAvLyBsb2cyX21heF9waWNfb3JkZXJfY250X2xzYl9taW51c180XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBpY19vcmRlcl9jbnRfdHlwZSA9PT0gMSkge1xuICAgICAgICAgICAgICAgIGdiLnJlYWRCaXRzKDEpOyAvLyBkZWx0YV9waWNfb3JkZXJfYWx3YXlzX3plcm9fZmxhZ1xuICAgICAgICAgICAgICAgIGdiLnJlYWRTRUcoKTsgLy8gb2Zmc2V0X2Zvcl9ub25fcmVmX3BpY1xuICAgICAgICAgICAgICAgIGdiLnJlYWRTRUcoKTsgLy8gb2Zmc2V0X2Zvcl90b3BfdG9fYm90dG9tX2ZpZWxkXG4gICAgICAgICAgICAgICAgdmFyIG51bV9yZWZfZnJhbWVzX2luX3BpY19vcmRlcl9jbnRfY3ljbGUgPSBnYi5yZWFkVUVHKCk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IG51bV9yZWZfZnJhbWVzX2luX3BpY19vcmRlcl9jbnRfY3ljbGU7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZ2IucmVhZFNFRygpOyAvLyBvZmZzZXRfZm9yX3JlZl9mcmFtZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciByZWZfZnJhbWVzID0gZ2IucmVhZFVFRygpOyAvLyBtYXhfbnVtX3JlZl9mcmFtZXNcbiAgICAgICAgICAgIGdiLnJlYWRCaXRzKDEpOyAvLyBnYXBzX2luX2ZyYW1lX251bV92YWx1ZV9hbGxvd2VkX2ZsYWdcblxuICAgICAgICAgICAgdmFyIHBpY193aWR0aF9pbl9tYnNfbWludXMxID0gZ2IucmVhZFVFRygpO1xuICAgICAgICAgICAgdmFyIHBpY19oZWlnaHRfaW5fbWFwX3VuaXRzX21pbnVzMSA9IGdiLnJlYWRVRUcoKTtcblxuICAgICAgICAgICAgdmFyIGZyYW1lX21ic19vbmx5X2ZsYWcgPSBnYi5yZWFkQml0cygxKTtcbiAgICAgICAgICAgIGlmIChmcmFtZV9tYnNfb25seV9mbGFnID09PSAwKSB7XG4gICAgICAgICAgICAgICAgZ2IucmVhZEJpdHMoMSk7IC8vIG1iX2FkYXB0aXZlX2ZyYW1lX2ZpZWxkX2ZsYWdcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdiLnJlYWRCaXRzKDEpOyAvLyBkaXJlY3RfOHg4X2luZmVyZW5jZV9mbGFnXG5cbiAgICAgICAgICAgIHZhciBmcmFtZV9jcm9wX2xlZnRfb2Zmc2V0ID0gMDtcbiAgICAgICAgICAgIHZhciBmcmFtZV9jcm9wX3JpZ2h0X29mZnNldCA9IDA7XG4gICAgICAgICAgICB2YXIgZnJhbWVfY3JvcF90b3Bfb2Zmc2V0ID0gMDtcbiAgICAgICAgICAgIHZhciBmcmFtZV9jcm9wX2JvdHRvbV9vZmZzZXQgPSAwO1xuXG4gICAgICAgICAgICB2YXIgZnJhbWVfY3JvcHBpbmdfZmxhZyA9IGdiLnJlYWRCb29sKCk7XG4gICAgICAgICAgICBpZiAoZnJhbWVfY3JvcHBpbmdfZmxhZykge1xuICAgICAgICAgICAgICAgIGZyYW1lX2Nyb3BfbGVmdF9vZmZzZXQgPSBnYi5yZWFkVUVHKCk7XG4gICAgICAgICAgICAgICAgZnJhbWVfY3JvcF9yaWdodF9vZmZzZXQgPSBnYi5yZWFkVUVHKCk7XG4gICAgICAgICAgICAgICAgZnJhbWVfY3JvcF90b3Bfb2Zmc2V0ID0gZ2IucmVhZFVFRygpO1xuICAgICAgICAgICAgICAgIGZyYW1lX2Nyb3BfYm90dG9tX29mZnNldCA9IGdiLnJlYWRVRUcoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHNhcl93aWR0aCA9IDEsXG4gICAgICAgICAgICAgICAgc2FyX2hlaWdodCA9IDE7XG4gICAgICAgICAgICB2YXIgZnBzID0gMCxcbiAgICAgICAgICAgICAgICBmcHNfZml4ZWQgPSB0cnVlLFxuICAgICAgICAgICAgICAgIGZwc19udW0gPSAwLFxuICAgICAgICAgICAgICAgIGZwc19kZW4gPSAwO1xuXG4gICAgICAgICAgICB2YXIgdnVpX3BhcmFtZXRlcnNfcHJlc2VudF9mbGFnID0gZ2IucmVhZEJvb2woKTtcbiAgICAgICAgICAgIGlmICh2dWlfcGFyYW1ldGVyc19wcmVzZW50X2ZsYWcpIHtcbiAgICAgICAgICAgICAgICBpZiAoZ2IucmVhZEJvb2woKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBhc3BlY3RfcmF0aW9faW5mb19wcmVzZW50X2ZsYWdcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFzcGVjdF9yYXRpb19pZGMgPSBnYi5yZWFkQnl0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2FyX3dfdGFibGUgPSBbMSwgMTIsIDEwLCAxNiwgNDAsIDI0LCAyMCwgMzIsIDgwLCAxOCwgMTUsIDY0LCAxNjAsIDQsIDMsIDJdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2FyX2hfdGFibGUgPSBbMSwgMTEsIDExLCAxMSwgMzMsIDExLCAxMSwgMTEsIDMzLCAxMSwgMTEsIDMzLCA5OSwgMywgMiwgMV07XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGFzcGVjdF9yYXRpb19pZGMgPiAwICYmIGFzcGVjdF9yYXRpb19pZGMgPCAxNikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2FyX3dpZHRoID0gc2FyX3dfdGFibGVbYXNwZWN0X3JhdGlvX2lkYyAtIDFdO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2FyX2hlaWdodCA9IHNhcl9oX3RhYmxlW2FzcGVjdF9yYXRpb19pZGMgLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhc3BlY3RfcmF0aW9faWRjID09PSAyNTUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhcl93aWR0aCA9IGdiLnJlYWRCeXRlKCkgPDwgOCB8IGdiLnJlYWRCeXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzYXJfaGVpZ2h0ID0gZ2IucmVhZEJ5dGUoKSA8PCA4IHwgZ2IucmVhZEJ5dGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChnYi5yZWFkQm9vbCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIG92ZXJzY2FuX2luZm9fcHJlc2VudF9mbGFnXG4gICAgICAgICAgICAgICAgICAgIGdiLnJlYWRCb29sKCk7IC8vIG92ZXJzY2FuX2FwcHJvcHJpYXRlX2ZsYWdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGdiLnJlYWRCb29sKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdmlkZW9fc2lnbmFsX3R5cGVfcHJlc2VudF9mbGFnXG4gICAgICAgICAgICAgICAgICAgIGdiLnJlYWRCaXRzKDQpOyAvLyB2aWRlb19mb3JtYXQgJiB2aWRlb19mdWxsX3JhbmdlX2ZsYWdcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdiLnJlYWRCb29sKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbG91cl9kZXNjcmlwdGlvbl9wcmVzZW50X2ZsYWdcbiAgICAgICAgICAgICAgICAgICAgICAgIGdiLnJlYWRCaXRzKDI0KTsgLy8gY29sb3VyX3ByaW1hcmllcyAmIHRyYW5zZmVyX2NoYXJhY3RlcmlzdGljcyAmIG1hdHJpeF9jb2VmZmljaWVudHNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZ2IucmVhZEJvb2woKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjaHJvbWFfbG9jX2luZm9fcHJlc2VudF9mbGFnXG4gICAgICAgICAgICAgICAgICAgIGdiLnJlYWRVRUcoKTsgLy8gY2hyb21hX3NhbXBsZV9sb2NfdHlwZV90b3BfZmllbGRcbiAgICAgICAgICAgICAgICAgICAgZ2IucmVhZFVFRygpOyAvLyBjaHJvbWFfc2FtcGxlX2xvY190eXBlX2JvdHRvbV9maWVsZFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZ2IucmVhZEJvb2woKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyB0aW1pbmdfaW5mb19wcmVzZW50X2ZsYWdcbiAgICAgICAgICAgICAgICAgICAgdmFyIG51bV91bml0c19pbl90aWNrID0gZ2IucmVhZEJpdHMoMzIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGltZV9zY2FsZSA9IGdiLnJlYWRCaXRzKDMyKTtcbiAgICAgICAgICAgICAgICAgICAgZnBzX2ZpeGVkID0gZ2IucmVhZEJvb2woKTsgLy8gZml4ZWRfZnJhbWVfcmF0ZV9mbGFnXG5cbiAgICAgICAgICAgICAgICAgICAgZnBzX251bSA9IHRpbWVfc2NhbGU7XG4gICAgICAgICAgICAgICAgICAgIGZwc19kZW4gPSBudW1fdW5pdHNfaW5fdGljayAqIDI7XG4gICAgICAgICAgICAgICAgICAgIGZwcyA9IGZwc19udW0gLyBmcHNfZGVuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHNhclNjYWxlID0gMTtcbiAgICAgICAgICAgIGlmIChzYXJfd2lkdGggIT09IDEgfHwgc2FyX2hlaWdodCAhPT0gMSkge1xuICAgICAgICAgICAgICAgIHNhclNjYWxlID0gc2FyX3dpZHRoIC8gc2FyX2hlaWdodDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGNyb3BfdW5pdF94ID0gMCxcbiAgICAgICAgICAgICAgICBjcm9wX3VuaXRfeSA9IDA7XG4gICAgICAgICAgICBpZiAoY2hyb21hX2Zvcm1hdF9pZGMgPT09IDApIHtcbiAgICAgICAgICAgICAgICBjcm9wX3VuaXRfeCA9IDE7XG4gICAgICAgICAgICAgICAgY3JvcF91bml0X3kgPSAyIC0gZnJhbWVfbWJzX29ubHlfZmxhZztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHN1Yl93YyA9IGNocm9tYV9mb3JtYXRfaWRjID09PSAzID8gMSA6IDI7XG4gICAgICAgICAgICAgICAgdmFyIHN1Yl9oYyA9IGNocm9tYV9mb3JtYXRfaWRjID09PSAxID8gMiA6IDE7XG4gICAgICAgICAgICAgICAgY3JvcF91bml0X3ggPSBzdWJfd2M7XG4gICAgICAgICAgICAgICAgY3JvcF91bml0X3kgPSBzdWJfaGMgKiAoMiAtIGZyYW1lX21ic19vbmx5X2ZsYWcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgY29kZWNfd2lkdGggPSAocGljX3dpZHRoX2luX21ic19taW51czEgKyAxKSAqIDE2O1xuICAgICAgICAgICAgdmFyIGNvZGVjX2hlaWdodCA9ICgyIC0gZnJhbWVfbWJzX29ubHlfZmxhZykgKiAoKHBpY19oZWlnaHRfaW5fbWFwX3VuaXRzX21pbnVzMSArIDEpICogMTYpO1xuXG4gICAgICAgICAgICBjb2RlY193aWR0aCAtPSAoZnJhbWVfY3JvcF9sZWZ0X29mZnNldCArIGZyYW1lX2Nyb3BfcmlnaHRfb2Zmc2V0KSAqIGNyb3BfdW5pdF94O1xuICAgICAgICAgICAgY29kZWNfaGVpZ2h0IC09IChmcmFtZV9jcm9wX3RvcF9vZmZzZXQgKyBmcmFtZV9jcm9wX2JvdHRvbV9vZmZzZXQpICogY3JvcF91bml0X3k7XG5cbiAgICAgICAgICAgIHZhciBwcmVzZW50X3dpZHRoID0gTWF0aC5jZWlsKGNvZGVjX3dpZHRoICogc2FyU2NhbGUpO1xuXG4gICAgICAgICAgICBnYi5kZXN0cm95KCk7XG4gICAgICAgICAgICBnYiA9IG51bGw7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcHJvZmlsZV9zdHJpbmc6IHByb2ZpbGVfc3RyaW5nLCAvLyBiYXNlbGluZSwgaGlnaCwgaGlnaDEwLCAuLi5cbiAgICAgICAgICAgICAgICBsZXZlbF9zdHJpbmc6IGxldmVsX3N0cmluZywgLy8gMywgMy4xLCA0LCA0LjEsIDUsIDUuMSwgLi4uXG4gICAgICAgICAgICAgICAgYml0X2RlcHRoOiBiaXRfZGVwdGgsIC8vIDhiaXQsIDEwYml0LCAuLi5cbiAgICAgICAgICAgICAgICByZWZfZnJhbWVzOiByZWZfZnJhbWVzLFxuICAgICAgICAgICAgICAgIGNocm9tYV9mb3JtYXQ6IGNocm9tYV9mb3JtYXQsIC8vIDQ6MjowLCA0OjI6MiwgLi4uXG4gICAgICAgICAgICAgICAgY2hyb21hX2Zvcm1hdF9zdHJpbmc6IFNQU1BhcnNlci5nZXRDaHJvbWFGb3JtYXRTdHJpbmcoY2hyb21hX2Zvcm1hdCksXG5cbiAgICAgICAgICAgICAgICBmcmFtZV9yYXRlOiB7XG4gICAgICAgICAgICAgICAgICAgIGZpeGVkOiBmcHNfZml4ZWQsXG4gICAgICAgICAgICAgICAgICAgIGZwczogZnBzLFxuICAgICAgICAgICAgICAgICAgICBmcHNfZGVuOiBmcHNfZGVuLFxuICAgICAgICAgICAgICAgICAgICBmcHNfbnVtOiBmcHNfbnVtXG4gICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgIHNhcl9yYXRpbzoge1xuICAgICAgICAgICAgICAgICAgICB3aWR0aDogc2FyX3dpZHRoLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHNhcl9oZWlnaHRcbiAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgY29kZWNfc2l6ZToge1xuICAgICAgICAgICAgICAgICAgICB3aWR0aDogY29kZWNfd2lkdGgsXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogY29kZWNfaGVpZ2h0XG4gICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgIHByZXNlbnRfc2l6ZToge1xuICAgICAgICAgICAgICAgICAgICB3aWR0aDogcHJlc2VudF93aWR0aCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBjb2RlY19oZWlnaHRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfc2tpcFNjYWxpbmdMaXN0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9za2lwU2NhbGluZ0xpc3QoZ2IsIGNvdW50KSB7XG4gICAgICAgICAgICB2YXIgbGFzdF9zY2FsZSA9IDgsXG4gICAgICAgICAgICAgICAgbmV4dF9zY2FsZSA9IDg7XG4gICAgICAgICAgICB2YXIgZGVsdGFfc2NhbGUgPSAwO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5leHRfc2NhbGUgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsdGFfc2NhbGUgPSBnYi5yZWFkU0VHKCk7XG4gICAgICAgICAgICAgICAgICAgIG5leHRfc2NhbGUgPSAobGFzdF9zY2FsZSArIGRlbHRhX3NjYWxlICsgMjU2KSAlIDI1NjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbGFzdF9zY2FsZSA9IG5leHRfc2NhbGUgPT09IDAgPyBsYXN0X3NjYWxlIDogbmV4dF9zY2FsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZ2V0UHJvZmlsZVN0cmluZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRQcm9maWxlU3RyaW5nKHByb2ZpbGVfaWRjKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHByb2ZpbGVfaWRjKSB7XG4gICAgICAgICAgICAgICAgY2FzZSA2NjpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdCYXNlbGluZSc7XG4gICAgICAgICAgICAgICAgY2FzZSA3NzpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdNYWluJztcbiAgICAgICAgICAgICAgICBjYXNlIDg4OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ0V4dGVuZGVkJztcbiAgICAgICAgICAgICAgICBjYXNlIDEwMDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdIaWdoJztcbiAgICAgICAgICAgICAgICBjYXNlIDExMDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdIaWdoMTAnO1xuICAgICAgICAgICAgICAgIGNhc2UgMTIyOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ0hpZ2g0MjInO1xuICAgICAgICAgICAgICAgIGNhc2UgMjQ0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ0hpZ2g0NDQnO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnVW5rbm93bic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2dldExldmVsU3RyaW5nJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldExldmVsU3RyaW5nKGxldmVsX2lkYykge1xuICAgICAgICAgICAgcmV0dXJuIChsZXZlbF9pZGMgLyAxMCkudG9GaXhlZCgxKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZ2V0Q2hyb21hRm9ybWF0U3RyaW5nJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENocm9tYUZvcm1hdFN0cmluZyhjaHJvbWEpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoY2hyb21hKSB7XG4gICAgICAgICAgICAgICAgY2FzZSA0MjA6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnNDoyOjAnO1xuICAgICAgICAgICAgICAgIGNhc2UgNDIyOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzQ6MjoyJztcbiAgICAgICAgICAgICAgICBjYXNlIDQ0NDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc0OjQ6NCc7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdVbmtub3duJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBTUFNQYXJzZXI7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFNQU1BhcnNlcjtcblxufSx7XCIuL2V4cC1nb2xvbWIuanNcIjoxN31dLDIwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfcG9seWZpbGwgPSBfZGVyZXFfKCcuL3V0aWxzL3BvbHlmaWxsLmpzJyk7XG5cbnZhciBfcG9seWZpbGwyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcG9seWZpbGwpO1xuXG52YXIgX2ZlYXR1cmVzID0gX2RlcmVxXygnLi9jb3JlL2ZlYXR1cmVzLmpzJyk7XG5cbnZhciBfZmVhdHVyZXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmVhdHVyZXMpO1xuXG52YXIgX2xvYWRlciA9IF9kZXJlcV8oJy4vaW8vbG9hZGVyLmpzJyk7XG5cbnZhciBfZmx2UGxheWVyID0gX2RlcmVxXygnLi9wbGF5ZXIvZmx2LXBsYXllci5qcycpO1xuXG52YXIgX2ZsdlBsYXllcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9mbHZQbGF5ZXIpO1xuXG52YXIgX25hdGl2ZVBsYXllciA9IF9kZXJlcV8oJy4vcGxheWVyL25hdGl2ZS1wbGF5ZXIuanMnKTtcblxudmFyIF9uYXRpdmVQbGF5ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbmF0aXZlUGxheWVyKTtcblxudmFyIF9wbGF5ZXJFdmVudHMgPSBfZGVyZXFfKCcuL3BsYXllci9wbGF5ZXItZXZlbnRzLmpzJyk7XG5cbnZhciBfcGxheWVyRXZlbnRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BsYXllckV2ZW50cyk7XG5cbnZhciBfcGxheWVyRXJyb3JzID0gX2RlcmVxXygnLi9wbGF5ZXIvcGxheWVyLWVycm9ycy5qcycpO1xuXG52YXIgX2xvZ2dpbmdDb250cm9sID0gX2RlcmVxXygnLi91dGlscy9sb2dnaW5nLWNvbnRyb2wuanMnKTtcblxudmFyIF9sb2dnaW5nQ29udHJvbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnaW5nQ29udHJvbCk7XG5cbnZhciBfZXhjZXB0aW9uID0gX2RlcmVxXygnLi91dGlscy9leGNlcHRpb24uanMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuLy8gaGVyZSBhcmUgYWxsIHRoZSBpbnRlcmZhY2VzXG5cbi8vIGluc3RhbGwgcG9seWZpbGxzXG5fcG9seWZpbGwyLmRlZmF1bHQuaW5zdGFsbCgpO1xuXG4vLyBmYWN0b3J5IG1ldGhvZFxuZnVuY3Rpb24gY3JlYXRlUGxheWVyKG1lZGlhRGF0YVNvdXJjZSwgb3B0aW9uYWxDb25maWcpIHtcbiAgICB2YXIgbWRzID0gbWVkaWFEYXRhU291cmNlO1xuICAgIGlmIChtZHMgPT0gbnVsbCB8fCAodHlwZW9mIG1kcyA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YobWRzKSkgIT09ICdvYmplY3QnKSB7XG4gICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLkludmFsaWRBcmd1bWVudEV4Y2VwdGlvbignTWVkaWFEYXRhU291cmNlIG11c3QgYmUgYW4gamF2YXNjcmlwdCBvYmplY3QhJyk7XG4gICAgfVxuXG4gICAgaWYgKCFtZHMuaGFzT3duUHJvcGVydHkoJ3R5cGUnKSkge1xuICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbnZhbGlkQXJndW1lbnRFeGNlcHRpb24oJ01lZGlhRGF0YVNvdXJjZSBtdXN0IGhhcyB0eXBlIGZpZWxkIHRvIGluZGljYXRlIHZpZGVvIGZpbGUgdHlwZSEnKTtcbiAgICB9XG5cbiAgICBzd2l0Y2ggKG1kcy50eXBlKSB7XG4gICAgICAgIGNhc2UgJ2Zsdic6XG4gICAgICAgICAgICByZXR1cm4gbmV3IF9mbHZQbGF5ZXIyLmRlZmF1bHQobWRzLCBvcHRpb25hbENvbmZpZyk7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gbmV3IF9uYXRpdmVQbGF5ZXIyLmRlZmF1bHQobWRzLCBvcHRpb25hbENvbmZpZyk7XG4gICAgfVxufVxuXG4vLyBmZWF0dXJlIGRldGVjdGlvblxuZnVuY3Rpb24gaXNTdXBwb3J0ZWQoKSB7XG4gICAgcmV0dXJuIF9mZWF0dXJlczIuZGVmYXVsdC5zdXBwb3J0TVNFSDI2NFBsYXliYWNrKCk7XG59XG5cbmZ1bmN0aW9uIGdldEZlYXR1cmVMaXN0KCkge1xuICAgIHJldHVybiBfZmVhdHVyZXMyLmRlZmF1bHQuZ2V0RmVhdHVyZUxpc3QoKTtcbn1cblxuLy8gaW50ZXJmYWNlc1xudmFyIGZsdmpzID0ge307XG5cbmZsdmpzLmNyZWF0ZVBsYXllciA9IGNyZWF0ZVBsYXllcjtcbmZsdmpzLmlzU3VwcG9ydGVkID0gaXNTdXBwb3J0ZWQ7XG5mbHZqcy5nZXRGZWF0dXJlTGlzdCA9IGdldEZlYXR1cmVMaXN0O1xuXG5mbHZqcy5CYXNlTG9hZGVyID0gX2xvYWRlci5CYXNlTG9hZGVyO1xuZmx2anMuTG9hZGVyU3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXM7XG5mbHZqcy5Mb2FkZXJFcnJvcnMgPSBfbG9hZGVyLkxvYWRlckVycm9ycztcblxuZmx2anMuRXZlbnRzID0gX3BsYXllckV2ZW50czIuZGVmYXVsdDtcbmZsdmpzLkVycm9yVHlwZXMgPSBfcGxheWVyRXJyb3JzLkVycm9yVHlwZXM7XG5mbHZqcy5FcnJvckRldGFpbHMgPSBfcGxheWVyRXJyb3JzLkVycm9yRGV0YWlscztcblxuZmx2anMuRmx2UGxheWVyID0gX2ZsdlBsYXllcjIuZGVmYXVsdDtcbmZsdmpzLk5hdGl2ZVBsYXllciA9IF9uYXRpdmVQbGF5ZXIyLmRlZmF1bHQ7XG5mbHZqcy5Mb2dnaW5nQ29udHJvbCA9IF9sb2dnaW5nQ29udHJvbDIuZGVmYXVsdDtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGZsdmpzLCAndmVyc2lvbicsIHtcbiAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAvLyByZXBsYWNlZCBieSBicm93c2VyaWZ5LXZlcnNpb25pZnkgdHJhbnNmb3JtXG4gICAgICAgIHJldHVybiAnMS42LjEnO1xuICAgIH1cbn0pO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBmbHZqcztcblxufSx7XCIuL2NvcmUvZmVhdHVyZXMuanNcIjo2LFwiLi9pby9sb2FkZXIuanNcIjoyNCxcIi4vcGxheWVyL2Zsdi1wbGF5ZXIuanNcIjozMixcIi4vcGxheWVyL25hdGl2ZS1wbGF5ZXIuanNcIjozMyxcIi4vcGxheWVyL3BsYXllci1lcnJvcnMuanNcIjozNCxcIi4vcGxheWVyL3BsYXllci1ldmVudHMuanNcIjozNSxcIi4vdXRpbHMvZXhjZXB0aW9uLmpzXCI6NDAsXCIuL3V0aWxzL2xvZ2dpbmctY29udHJvbC5qc1wiOjQyLFwiLi91dGlscy9wb2x5ZmlsbC5qc1wiOjQzfV0sMjE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG4vLyBlbnRyeS9pbmRleCBmaWxlXG5cbi8vIG1ha2UgaXQgY29tcGF0aWJsZSB3aXRoIGJyb3dzZXJpZnkncyB1bWQgd3JhcHBlclxubW9kdWxlLmV4cG9ydHMgPSBfZGVyZXFfKCcuL2Zsdi5qcycpLmRlZmF1bHQ7XG5cbn0se1wiLi9mbHYuanNcIjoyMH1dLDIyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9sb2dnZXIgPSBfZGVyZXFfKCcuLi91dGlscy9sb2dnZXIuanMnKTtcblxudmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTtcblxudmFyIF9icm93c2VyID0gX2RlcmVxXygnLi4vdXRpbHMvYnJvd3Nlci5qcycpO1xuXG52YXIgX2Jyb3dzZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYnJvd3Nlcik7XG5cbnZhciBfbG9hZGVyID0gX2RlcmVxXygnLi9sb2FkZXIuanMnKTtcblxudmFyIF9leGNlcHRpb24gPSBfZGVyZXFfKCcuLi91dGlscy9leGNlcHRpb24uanMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfSAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG4vKiBmZXRjaCArIHN0cmVhbSBJTyBsb2FkZXIuIEN1cnJlbnRseSB3b3JraW5nIG9uIGNocm9tZSA0MysuXHJcbiAqIGZldGNoIHByb3ZpZGVzIGEgYmV0dGVyIGFsdGVybmF0aXZlIGh0dHAgQVBJIHRvIFhNTEh0dHBSZXF1ZXN0XHJcbiAqXHJcbiAqIGZldGNoIHNwZWMgICBodHRwczovL2ZldGNoLnNwZWMud2hhdHdnLm9yZy9cclxuICogc3RyZWFtIHNwZWMgIGh0dHBzOi8vc3RyZWFtcy5zcGVjLndoYXR3Zy5vcmcvXHJcbiAqL1xudmFyIEZldGNoU3RyZWFtTG9hZGVyID0gZnVuY3Rpb24gKF9CYXNlTG9hZGVyKSB7XG4gICAgX2luaGVyaXRzKEZldGNoU3RyZWFtTG9hZGVyLCBfQmFzZUxvYWRlcik7XG5cbiAgICBfY3JlYXRlQ2xhc3MoRmV0Y2hTdHJlYW1Mb2FkZXIsIG51bGwsIFt7XG4gICAgICAgIGtleTogJ2lzU3VwcG9ydGVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzU3VwcG9ydGVkKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAvLyBmZXRjaCArIHN0cmVhbSBpcyBicm9rZW4gb24gTWljcm9zb2Z0IEVkZ2UuIERpc2FibGUgYmVmb3JlIGJ1aWxkIDE1MDQ4LlxuICAgICAgICAgICAgICAgIC8vIHNlZSBodHRwczovL2RldmVsb3Blci5taWNyb3NvZnQuY29tL2VuLXVzL21pY3Jvc29mdC1lZGdlL3BsYXRmb3JtL2lzc3Vlcy84MTk2OTA3L1xuICAgICAgICAgICAgICAgIC8vIEZpeGVkIGluIEphbiAxMCwgMjAxNy4gQnVpbGQgMTUwNDgrIHJlbW92ZWQgZnJvbSBibGFja2xpc3QuXG4gICAgICAgICAgICAgICAgdmFyIGlzV29ya1dlbGxFZGdlID0gX2Jyb3dzZXIyLmRlZmF1bHQubXNlZGdlICYmIF9icm93c2VyMi5kZWZhdWx0LnZlcnNpb24ubWlub3IgPj0gMTUwNDg7XG4gICAgICAgICAgICAgICAgdmFyIGJyb3dzZXJOb3RCbGFja2xpc3RlZCA9IF9icm93c2VyMi5kZWZhdWx0Lm1zZWRnZSA/IGlzV29ya1dlbGxFZGdlIDogdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5mZXRjaCAmJiBzZWxmLlJlYWRhYmxlU3RyZWFtICYmIGJyb3dzZXJOb3RCbGFja2xpc3RlZDtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICBmdW5jdGlvbiBGZXRjaFN0cmVhbUxvYWRlcihzZWVrSGFuZGxlciwgY29uZmlnKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBGZXRjaFN0cmVhbUxvYWRlcik7XG5cbiAgICAgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKEZldGNoU3RyZWFtTG9hZGVyLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoRmV0Y2hTdHJlYW1Mb2FkZXIpKS5jYWxsKHRoaXMsICdmZXRjaC1zdHJlYW0tbG9hZGVyJykpO1xuXG4gICAgICAgIF90aGlzLlRBRyA9ICdGZXRjaFN0cmVhbUxvYWRlcic7XG5cbiAgICAgICAgX3RoaXMuX3NlZWtIYW5kbGVyID0gc2Vla0hhbmRsZXI7XG4gICAgICAgIF90aGlzLl9jb25maWcgPSBjb25maWc7XG4gICAgICAgIF90aGlzLl9uZWVkU3Rhc2ggPSB0cnVlO1xuXG4gICAgICAgIF90aGlzLl9yZXF1ZXN0QWJvcnQgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMuX2NvbnRlbnRMZW5ndGggPSBudWxsO1xuICAgICAgICBfdGhpcy5fcmVjZWl2ZWRMZW5ndGggPSAwO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKEZldGNoU3RyZWFtTG9hZGVyLCBbe1xuICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1dvcmtpbmcoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9nZXQoRmV0Y2hTdHJlYW1Mb2FkZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoRmV0Y2hTdHJlYW1Mb2FkZXIucHJvdG90eXBlKSwgJ2Rlc3Ryb3knLCB0aGlzKS5jYWxsKHRoaXMpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvcGVuJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW4oZGF0YVNvdXJjZSwgcmFuZ2UpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICAgICAgICB0aGlzLl9kYXRhU291cmNlID0gZGF0YVNvdXJjZTtcbiAgICAgICAgICAgIHRoaXMuX3JhbmdlID0gcmFuZ2U7XG5cbiAgICAgICAgICAgIHZhciBzb3VyY2VVUkwgPSBkYXRhU291cmNlLnVybDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9jb25maWcucmV1c2VSZWRpcmVjdGVkVVJMICYmIGRhdGFTb3VyY2UucmVkaXJlY3RlZFVSTCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBzb3VyY2VVUkwgPSBkYXRhU291cmNlLnJlZGlyZWN0ZWRVUkw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzZWVrQ29uZmlnID0gdGhpcy5fc2Vla0hhbmRsZXIuZ2V0Q29uZmlnKHNvdXJjZVVSTCwgcmFuZ2UpO1xuXG4gICAgICAgICAgICB2YXIgaGVhZGVycyA9IG5ldyBzZWxmLkhlYWRlcnMoKTtcblxuICAgICAgICAgICAgaWYgKF90eXBlb2Yoc2Vla0NvbmZpZy5oZWFkZXJzKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29uZmlnSGVhZGVycyA9IHNlZWtDb25maWcuaGVhZGVycztcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gY29uZmlnSGVhZGVycykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29uZmlnSGVhZGVycy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzLmFwcGVuZChrZXksIGNvbmZpZ0hlYWRlcnNba2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzLFxuICAgICAgICAgICAgICAgIG1vZGU6ICdjb3JzJyxcbiAgICAgICAgICAgICAgICBjYWNoZTogJ2RlZmF1bHQnLFxuICAgICAgICAgICAgICAgIC8vIFRoZSBkZWZhdWx0IHBvbGljeSBvZiBGZXRjaCBBUEkgaW4gdGhlIHdoYXR3ZyBzdGFuZGFyZFxuICAgICAgICAgICAgICAgIC8vIFNhZmFyaSBpbmNvcnJlY3RseSBpbmRpY2F0ZXMgJ25vLXJlZmVycmVyJyBhcyBkZWZhdWx0IHBvbGljeSwgZnVjayBpdFxuICAgICAgICAgICAgICAgIHJlZmVycmVyUG9saWN5OiAnbm8tcmVmZXJyZXItd2hlbi1kb3duZ3JhZGUnXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBhZGQgYWRkaXRpb25hbCBoZWFkZXJzXG4gICAgICAgICAgICBpZiAoX3R5cGVvZih0aGlzLl9jb25maWcuaGVhZGVycykgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2tleSBpbiB0aGlzLl9jb25maWcuaGVhZGVycykge1xuICAgICAgICAgICAgICAgICAgICBoZWFkZXJzLmFwcGVuZChfa2V5LCB0aGlzLl9jb25maWcuaGVhZGVyc1tfa2V5XSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBjb3JzIGlzIGVuYWJsZWQgYnkgZGVmYXVsdFxuICAgICAgICAgICAgaWYgKGRhdGFTb3VyY2UuY29ycyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAvLyBuby1jb3JzIG1lYW5zICdkaXNyZWdhcmQgY29ycyBwb2xpY3knLCB3aGljaCBjYW4gb25seSBiZSB1c2VkIGluIFNlcnZpY2VXb3JrZXJcbiAgICAgICAgICAgICAgICBwYXJhbXMubW9kZSA9ICdzYW1lLW9yaWdpbic7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHdpdGhDcmVkZW50aWFscyBpcyBkaXNhYmxlZCBieSBkZWZhdWx0XG4gICAgICAgICAgICBpZiAoZGF0YVNvdXJjZS53aXRoQ3JlZGVudGlhbHMpIHtcbiAgICAgICAgICAgICAgICBwYXJhbXMuY3JlZGVudGlhbHMgPSAnaW5jbHVkZSc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHJlZmVycmVyUG9saWN5IGZyb20gY29uZmlnXG4gICAgICAgICAgICBpZiAoZGF0YVNvdXJjZS5yZWZlcnJlclBvbGljeSkge1xuICAgICAgICAgICAgICAgIHBhcmFtcy5yZWZlcnJlclBvbGljeSA9IGRhdGFTb3VyY2UucmVmZXJyZXJQb2xpY3k7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFkZCBhYm9ydCBjb250cm9sbGVyLCBieSB3bWxnbCAyMDE5LTUtMTAgMTI6MjE6MjdcbiAgICAgICAgICAgIGlmIChzZWxmLkFib3J0Q29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Fib3J0Q29udHJvbGxlciA9IG5ldyBzZWxmLkFib3J0Q29udHJvbGxlcigpO1xuICAgICAgICAgICAgICAgIHBhcmFtcy5zaWduYWwgPSB0aGlzLl9hYm9ydENvbnRyb2xsZXIuc2lnbmFsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29ubmVjdGluZztcbiAgICAgICAgICAgIHNlbGYuZmV0Y2goc2Vla0NvbmZpZy51cmwsIHBhcmFtcykudGhlbihmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzMi5fcmVxdWVzdEFib3J0KSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMi5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0lkbGU7XG4gICAgICAgICAgICAgICAgICAgIHJlcy5ib2R5LmNhbmNlbCgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyZXMub2sgJiYgcmVzLnN0YXR1cyA+PSAyMDAgJiYgcmVzLnN0YXR1cyA8PSAyOTkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy51cmwgIT09IHNlZWtDb25maWcudXJsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLl9vblVSTFJlZGlyZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlZGlyZWN0ZWRVUkwgPSBfdGhpczIuX3NlZWtIYW5kbGVyLnJlbW92ZVVSTFBhcmFtZXRlcnMocmVzLnVybCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMyLl9vblVSTFJlZGlyZWN0KHJlZGlyZWN0ZWRVUkwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGxlbmd0aEhlYWRlciA9IHJlcy5oZWFkZXJzLmdldCgnQ29udGVudC1MZW5ndGgnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxlbmd0aEhlYWRlciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpczIuX2NvbnRlbnRMZW5ndGggPSBwYXJzZUludChsZW5ndGhIZWFkZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMi5fY29udGVudExlbmd0aCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpczIuX29uQ29udGVudExlbmd0aEtub3duKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMi5fb25Db250ZW50TGVuZ3RoS25vd24oX3RoaXMyLl9jb250ZW50TGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLl9wdW1wLmNhbGwoX3RoaXMyLCByZXMuYm9keS5nZXRSZWFkZXIoKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpczIuX29uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMi5fb25FcnJvcihfbG9hZGVyLkxvYWRlckVycm9ycy5IVFRQX1NUQVRVU19DT0RFX0lOVkFMSUQsIHsgY29kZTogcmVzLnN0YXR1cywgbXNnOiByZXMuc3RhdHVzVGV4dCB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLlJ1bnRpbWVFeGNlcHRpb24oJ0ZldGNoU3RyZWFtTG9hZGVyOiBIdHRwIGNvZGUgaW52YWxpZCwgJyArIHJlcy5zdGF0dXMgKyAnICcgKyByZXMuc3RhdHVzVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpczIuX2Fib3J0Q29udHJvbGxlciAmJiBfdGhpczIuX2Fib3J0Q29udHJvbGxlci5zaWduYWwuYWJvcnRlZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX3RoaXMyLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3I7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzMi5fb25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczIuX29uRXJyb3IoX2xvYWRlci5Mb2FkZXJFcnJvcnMuRVhDRVBUSU9OLCB7IGNvZGU6IC0xLCBtc2c6IGUubWVzc2FnZSB9KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhYm9ydCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhYm9ydCgpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RBYm9ydCA9IHRydWU7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGF0dXMgIT09IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtCdWZmZXJpbmcgfHwgIV9icm93c2VyMi5kZWZhdWx0LmNocm9tZSkge1xuICAgICAgICAgICAgICAgIC8vIENocm9tZSBtYXkgdGhyb3cgRXhjZXB0aW9uLWxpa2UgdGhpbmdzIGhlcmUsIGF2b2lkIHVzaW5nIGlmIGlzIGJ1ZmZlcmluZ1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hYm9ydENvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2Fib3J0Q29udHJvbGxlci5hYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19wdW1wJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9wdW1wKHJlYWRlcikge1xuICAgICAgICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgICAgICAgIC8vIFJlYWRhYmxlU3RyZWFtUmVhZGVyXG4gICAgICAgICAgICByZXR1cm4gcmVhZGVyLnJlYWQoKS50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LmRvbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gRmlyc3QgY2hlY2sgcmVjZWl2ZWQgbGVuZ3RoXG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpczMuX2NvbnRlbnRMZW5ndGggIT09IG51bGwgJiYgX3RoaXMzLl9yZWNlaXZlZExlbmd0aCA8IF90aGlzMy5fY29udGVudExlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVwb3J0IEVhcmx5LUVPRlxuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3I7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVBUkxZX0VPRjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmZvID0geyBjb2RlOiAtMSwgbXNnOiAnRmV0Y2ggc3RyZWFtIG1lZXQgRWFybHktRU9GJyB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMy5fb25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMy5fb25FcnJvcih0eXBlLCBpbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uUnVudGltZUV4Y2VwdGlvbihpbmZvLm1zZyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPSy4gRG93bmxvYWQgY29tcGxldGVcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0NvbXBsZXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMy5fb25Db21wbGV0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMy5fb25Db21wbGV0ZShfdGhpczMuX3JhbmdlLmZyb20sIF90aGlzMy5fcmFuZ2UuZnJvbSArIF90aGlzMy5fcmVjZWl2ZWRMZW5ndGggLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpczMuX2Fib3J0Q29udHJvbGxlciAmJiBfdGhpczMuX2Fib3J0Q29udHJvbGxlci5zaWduYWwuYWJvcnRlZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29tcGxldGU7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoX3RoaXMzLl9yZXF1ZXN0QWJvcnQgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0NvbXBsZXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlYWRlci5jYW5jZWwoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIF90aGlzMy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0J1ZmZlcmluZztcblxuICAgICAgICAgICAgICAgICAgICB2YXIgY2h1bmsgPSByZXN1bHQudmFsdWUuYnVmZmVyO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYnl0ZVN0YXJ0ID0gX3RoaXMzLl9yYW5nZS5mcm9tICsgX3RoaXMzLl9yZWNlaXZlZExlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMzLl9yZWNlaXZlZExlbmd0aCArPSBjaHVuay5ieXRlTGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpczMuX29uRGF0YUFycml2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMy5fb25EYXRhQXJyaXZhbChjaHVuaywgYnl0ZVN0YXJ0LCBfdGhpczMuX3JlY2VpdmVkTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIF90aGlzMy5fcHVtcChyZWFkZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzMy5fYWJvcnRDb250cm9sbGVyICYmIF90aGlzMy5fYWJvcnRDb250cm9sbGVyLnNpZ25hbC5hYm9ydGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0NvbXBsZXRlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGUuY29kZSA9PT0gMTEgJiYgX2Jyb3dzZXIyLmRlZmF1bHQubXNlZGdlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEludmFsaWRTdGF0ZUVycm9yIG9uIE1pY3Jvc29mdCBFZGdlXG4gICAgICAgICAgICAgICAgICAgIC8vIFdvcmthcm91bmQ6IEVkZ2UgbWF5IHRocm93IEludmFsaWRTdGF0ZUVycm9yIGFmdGVyIFJlYWRhYmxlU3RyZWFtUmVhZGVyLmNhbmNlbCgpIGNhbGxcbiAgICAgICAgICAgICAgICAgICAgLy8gSWdub3JlIHRoZSB1bmtub3duIGV4Y2VwdGlvbi5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVsYXRlZCBpc3N1ZTogaHR0cHM6Ly9kZXZlbG9wZXIubWljcm9zb2Z0LmNvbS9lbi11cy9taWNyb3NvZnQtZWRnZS9wbGF0Zm9ybS9pc3N1ZXMvMTEyNjUyMDIvXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfdGhpczMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcjtcbiAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IDA7XG4gICAgICAgICAgICAgICAgdmFyIGluZm8gPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgaWYgKChlLmNvZGUgPT09IDE5IHx8IGUubWVzc2FnZSA9PT0gJ25ldHdvcmsgZXJyb3InKSAmJiAoIC8vIE5FVFdPUktfRVJSXG4gICAgICAgICAgICAgICAgX3RoaXMzLl9jb250ZW50TGVuZ3RoID09PSBudWxsIHx8IF90aGlzMy5fY29udGVudExlbmd0aCAhPT0gbnVsbCAmJiBfdGhpczMuX3JlY2VpdmVkTGVuZ3RoIDwgX3RoaXMzLl9jb250ZW50TGVuZ3RoKSkge1xuICAgICAgICAgICAgICAgICAgICB0eXBlID0gX2xvYWRlci5Mb2FkZXJFcnJvcnMuRUFSTFlfRU9GO1xuICAgICAgICAgICAgICAgICAgICBpbmZvID0geyBjb2RlOiBlLmNvZGUsIG1zZzogJ0ZldGNoIHN0cmVhbSBtZWV0IEVhcmx5LUVPRicgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0eXBlID0gX2xvYWRlci5Mb2FkZXJFcnJvcnMuRVhDRVBUSU9OO1xuICAgICAgICAgICAgICAgICAgICBpbmZvID0geyBjb2RlOiBlLmNvZGUsIG1zZzogZS5tZXNzYWdlIH07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzMy5fb25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczMuX29uRXJyb3IodHlwZSwgaW5mbyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uUnVudGltZUV4Y2VwdGlvbihpbmZvLm1zZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gRmV0Y2hTdHJlYW1Mb2FkZXI7XG59KF9sb2FkZXIuQmFzZUxvYWRlcik7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEZldGNoU3RyZWFtTG9hZGVyO1xuXG59LHtcIi4uL3V0aWxzL2Jyb3dzZXIuanNcIjozOSxcIi4uL3V0aWxzL2V4Y2VwdGlvbi5qc1wiOjQwLFwiLi4vdXRpbHMvbG9nZ2VyLmpzXCI6NDEsXCIuL2xvYWRlci5qc1wiOjI0fV0sMjM6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgX2xvZ2dlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZ2dlci5qcycpO1xuXG52YXIgX2xvZ2dlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnZXIpO1xuXG52YXIgX3NwZWVkU2FtcGxlciA9IF9kZXJlcV8oJy4vc3BlZWQtc2FtcGxlci5qcycpO1xuXG52YXIgX3NwZWVkU2FtcGxlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zcGVlZFNhbXBsZXIpO1xuXG52YXIgX2xvYWRlciA9IF9kZXJlcV8oJy4vbG9hZGVyLmpzJyk7XG5cbnZhciBfZmV0Y2hTdHJlYW1Mb2FkZXIgPSBfZGVyZXFfKCcuL2ZldGNoLXN0cmVhbS1sb2FkZXIuanMnKTtcblxudmFyIF9mZXRjaFN0cmVhbUxvYWRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9mZXRjaFN0cmVhbUxvYWRlcik7XG5cbnZhciBfeGhyTW96Q2h1bmtlZExvYWRlciA9IF9kZXJlcV8oJy4veGhyLW1vei1jaHVua2VkLWxvYWRlci5qcycpO1xuXG52YXIgX3hock1vekNodW5rZWRMb2FkZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfeGhyTW96Q2h1bmtlZExvYWRlcik7XG5cbnZhciBfeGhyTXNzdHJlYW1Mb2FkZXIgPSBfZGVyZXFfKCcuL3hoci1tc3N0cmVhbS1sb2FkZXIuanMnKTtcblxudmFyIF94aHJNc3N0cmVhbUxvYWRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF94aHJNc3N0cmVhbUxvYWRlcik7XG5cbnZhciBfeGhyUmFuZ2VMb2FkZXIgPSBfZGVyZXFfKCcuL3hoci1yYW5nZS1sb2FkZXIuanMnKTtcblxudmFyIF94aHJSYW5nZUxvYWRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF94aHJSYW5nZUxvYWRlcik7XG5cbnZhciBfd2Vic29ja2V0TG9hZGVyID0gX2RlcmVxXygnLi93ZWJzb2NrZXQtbG9hZGVyLmpzJyk7XG5cbnZhciBfd2Vic29ja2V0TG9hZGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3dlYnNvY2tldExvYWRlcik7XG5cbnZhciBfcmFuZ2VTZWVrSGFuZGxlciA9IF9kZXJlcV8oJy4vcmFuZ2Utc2Vlay1oYW5kbGVyLmpzJyk7XG5cbnZhciBfcmFuZ2VTZWVrSGFuZGxlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yYW5nZVNlZWtIYW5kbGVyKTtcblxudmFyIF9wYXJhbVNlZWtIYW5kbGVyID0gX2RlcmVxXygnLi9wYXJhbS1zZWVrLWhhbmRsZXIuanMnKTtcblxudmFyIF9wYXJhbVNlZWtIYW5kbGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BhcmFtU2Vla0hhbmRsZXIpO1xuXG52YXIgX2V4Y2VwdGlvbiA9IF9kZXJlcV8oJy4uL3V0aWxzL2V4Y2VwdGlvbi5qcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKipcclxuICogRGF0YVNvdXJjZToge1xyXG4gKiAgICAgdXJsOiBzdHJpbmcsXHJcbiAqICAgICBmaWxlc2l6ZTogbnVtYmVyLFxyXG4gKiAgICAgY29yczogYm9vbGVhbixcclxuICogICAgIHdpdGhDcmVkZW50aWFsczogYm9vbGVhblxyXG4gKiB9XHJcbiAqIFxyXG4gKi9cblxuLy8gTWFuYWdlIElPIExvYWRlcnNcbnZhciBJT0NvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gSU9Db250cm9sbGVyKGRhdGFTb3VyY2UsIGNvbmZpZywgZXh0cmFEYXRhKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJT0NvbnRyb2xsZXIpO1xuXG4gICAgICAgIHRoaXMuVEFHID0gJ0lPQ29udHJvbGxlcic7XG5cbiAgICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgICAgICB0aGlzLl9leHRyYURhdGEgPSBleHRyYURhdGE7XG5cbiAgICAgICAgdGhpcy5fc3Rhc2hJbml0aWFsU2l6ZSA9IDEwMjQgKiAzODQ7IC8vIGRlZmF1bHQgaW5pdGlhbCBzaXplOiAzODRLQlxuICAgICAgICBpZiAoY29uZmlnLnN0YXNoSW5pdGlhbFNpemUgIT0gdW5kZWZpbmVkICYmIGNvbmZpZy5zdGFzaEluaXRpYWxTaXplID4gMCkge1xuICAgICAgICAgICAgLy8gYXBwbHkgZnJvbSBjb25maWdcbiAgICAgICAgICAgIHRoaXMuX3N0YXNoSW5pdGlhbFNpemUgPSBjb25maWcuc3Rhc2hJbml0aWFsU2l6ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3N0YXNoVXNlZCA9IDA7XG4gICAgICAgIHRoaXMuX3N0YXNoU2l6ZSA9IHRoaXMuX3N0YXNoSW5pdGlhbFNpemU7XG4gICAgICAgIHRoaXMuX2J1ZmZlclNpemUgPSAxMDI0ICogMTAyNCAqIDM7IC8vIGluaXRpYWwgc2l6ZTogM01CXG4gICAgICAgIHRoaXMuX3N0YXNoQnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKHRoaXMuX2J1ZmZlclNpemUpO1xuICAgICAgICB0aGlzLl9zdGFzaEJ5dGVTdGFydCA9IDA7XG4gICAgICAgIHRoaXMuX2VuYWJsZVN0YXNoID0gdHJ1ZTtcbiAgICAgICAgaWYgKGNvbmZpZy5lbmFibGVTdGFzaEJ1ZmZlciA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHRoaXMuX2VuYWJsZVN0YXNoID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9sb2FkZXIgPSBudWxsO1xuICAgICAgICB0aGlzLl9sb2FkZXJDbGFzcyA9IG51bGw7XG4gICAgICAgIHRoaXMuX3NlZWtIYW5kbGVyID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9kYXRhU291cmNlID0gZGF0YVNvdXJjZTtcbiAgICAgICAgdGhpcy5faXNXZWJTb2NrZXRVUkwgPSAvd3NzPzpcXC9cXC8oLis/KS8udGVzdChkYXRhU291cmNlLnVybCk7XG4gICAgICAgIHRoaXMuX3JlZlRvdGFsTGVuZ3RoID0gZGF0YVNvdXJjZS5maWxlc2l6ZSA/IGRhdGFTb3VyY2UuZmlsZXNpemUgOiBudWxsO1xuICAgICAgICB0aGlzLl90b3RhbExlbmd0aCA9IHRoaXMuX3JlZlRvdGFsTGVuZ3RoO1xuICAgICAgICB0aGlzLl9mdWxsUmVxdWVzdEZsYWcgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fY3VycmVudFJhbmdlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcmVkaXJlY3RlZFVSTCA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5fc3BlZWROb3JtYWxpemVkID0gMDtcbiAgICAgICAgdGhpcy5fc3BlZWRTYW1wbGVyID0gbmV3IF9zcGVlZFNhbXBsZXIyLmRlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5fc3BlZWROb3JtYWxpemVMaXN0ID0gWzY0LCAxMjgsIDI1NiwgMzg0LCA1MTIsIDc2OCwgMTAyNCwgMTUzNiwgMjA0OCwgMzA3MiwgNDA5Nl07XG5cbiAgICAgICAgdGhpcy5faXNFYXJseUVvZlJlY29ubmVjdGluZyA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuX3BhdXNlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9yZXN1bWVGcm9tID0gMDtcblxuICAgICAgICB0aGlzLl9vbkRhdGFBcnJpdmFsID0gbnVsbDtcbiAgICAgICAgdGhpcy5fb25TZWVrZWQgPSBudWxsO1xuICAgICAgICB0aGlzLl9vbkVycm9yID0gbnVsbDtcbiAgICAgICAgdGhpcy5fb25Db21wbGV0ZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX29uUmVkaXJlY3QgPSBudWxsO1xuICAgICAgICB0aGlzLl9vblJlY292ZXJlZEVhcmx5RW9mID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9zZWxlY3RTZWVrSGFuZGxlcigpO1xuICAgICAgICB0aGlzLl9zZWxlY3RMb2FkZXIoKTtcbiAgICAgICAgdGhpcy5fY3JlYXRlTG9hZGVyKCk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKElPQ29udHJvbGxlciwgW3tcbiAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2xvYWRlci5pc1dvcmtpbmcoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRlci5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fbG9hZGVyLmRlc3Ryb3koKTtcbiAgICAgICAgICAgIHRoaXMuX2xvYWRlciA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9sb2FkZXJDbGFzcyA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9kYXRhU291cmNlID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX3N0YXNoQnVmZmVyID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX3N0YXNoVXNlZCA9IHRoaXMuX3N0YXNoU2l6ZSA9IHRoaXMuX2J1ZmZlclNpemUgPSB0aGlzLl9zdGFzaEJ5dGVTdGFydCA9IDA7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50UmFuZ2UgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fc3BlZWRTYW1wbGVyID0gbnVsbDtcblxuICAgICAgICAgICAgdGhpcy5faXNFYXJseUVvZlJlY29ubmVjdGluZyA9IGZhbHNlO1xuXG4gICAgICAgICAgICB0aGlzLl9vbkRhdGFBcnJpdmFsID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uU2Vla2VkID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uRXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25Db21wbGV0ZSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vblJlZGlyZWN0ID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uUmVjb3ZlcmVkRWFybHlFb2YgPSBudWxsO1xuXG4gICAgICAgICAgICB0aGlzLl9leHRyYURhdGEgPSBudWxsO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdpc1dvcmtpbmcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaXNXb3JraW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xvYWRlciAmJiB0aGlzLl9sb2FkZXIuaXNXb3JraW5nKCkgJiYgIXRoaXMuX3BhdXNlZDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnaXNQYXVzZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaXNQYXVzZWQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcGF1c2VkO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfc2VsZWN0U2Vla0hhbmRsZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbGVjdFNlZWtIYW5kbGVyKCkge1xuICAgICAgICAgICAgdmFyIGNvbmZpZyA9IHRoaXMuX2NvbmZpZztcblxuICAgICAgICAgICAgaWYgKGNvbmZpZy5zZWVrVHlwZSA9PT0gJ3JhbmdlJykge1xuICAgICAgICAgICAgICAgIHRoaXMuX3NlZWtIYW5kbGVyID0gbmV3IF9yYW5nZVNlZWtIYW5kbGVyMi5kZWZhdWx0KHRoaXMuX2NvbmZpZy5yYW5nZUxvYWRaZXJvU3RhcnQpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjb25maWcuc2Vla1R5cGUgPT09ICdwYXJhbScpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFyYW1TdGFydCA9IGNvbmZpZy5zZWVrUGFyYW1TdGFydCB8fCAnYnN0YXJ0JztcbiAgICAgICAgICAgICAgICB2YXIgcGFyYW1FbmQgPSBjb25maWcuc2Vla1BhcmFtRW5kIHx8ICdiZW5kJztcblxuICAgICAgICAgICAgICAgIHRoaXMuX3NlZWtIYW5kbGVyID0gbmV3IF9wYXJhbVNlZWtIYW5kbGVyMi5kZWZhdWx0KHBhcmFtU3RhcnQsIHBhcmFtRW5kKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnNlZWtUeXBlID09PSAnY3VzdG9tJykge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgY29uZmlnLmN1c3RvbVNlZWtIYW5kbGVyICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLkludmFsaWRBcmd1bWVudEV4Y2VwdGlvbignQ3VzdG9tIHNlZWtUeXBlIHNwZWNpZmllZCBpbiBjb25maWcgYnV0IGludmFsaWQgY3VzdG9tU2Vla0hhbmRsZXIhJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX3NlZWtIYW5kbGVyID0gbmV3IGNvbmZpZy5jdXN0b21TZWVrSGFuZGxlcigpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbnZhbGlkQXJndW1lbnRFeGNlcHRpb24oJ0ludmFsaWQgc2Vla1R5cGUgaW4gY29uZmlnOiAnICsgY29uZmlnLnNlZWtUeXBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3NlbGVjdExvYWRlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfc2VsZWN0TG9hZGVyKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbmZpZy5jdXN0b21Mb2FkZXIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRlckNsYXNzID0gdGhpcy5fY29uZmlnLmN1c3RvbUxvYWRlcjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5faXNXZWJTb2NrZXRVUkwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9sb2FkZXJDbGFzcyA9IF93ZWJzb2NrZXRMb2FkZXIyLmRlZmF1bHQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKF9mZXRjaFN0cmVhbUxvYWRlcjIuZGVmYXVsdC5pc1N1cHBvcnRlZCgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZGVyQ2xhc3MgPSBfZmV0Y2hTdHJlYW1Mb2FkZXIyLmRlZmF1bHQ7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKF94aHJNb3pDaHVua2VkTG9hZGVyMi5kZWZhdWx0LmlzU3VwcG9ydGVkKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9sb2FkZXJDbGFzcyA9IF94aHJNb3pDaHVua2VkTG9hZGVyMi5kZWZhdWx0O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChfeGhyUmFuZ2VMb2FkZXIyLmRlZmF1bHQuaXNTdXBwb3J0ZWQoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRlckNsYXNzID0gX3hoclJhbmdlTG9hZGVyMi5kZWZhdWx0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5SdW50aW1lRXhjZXB0aW9uKCdZb3VyIGJyb3dzZXIgZG9lc25cXCd0IHN1cHBvcnQgeGhyIHdpdGggYXJyYXlidWZmZXIgcmVzcG9uc2VUeXBlIScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfY3JlYXRlTG9hZGVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9jcmVhdGVMb2FkZXIoKSB7XG4gICAgICAgICAgICB0aGlzLl9sb2FkZXIgPSBuZXcgdGhpcy5fbG9hZGVyQ2xhc3ModGhpcy5fc2Vla0hhbmRsZXIsIHRoaXMuX2NvbmZpZyk7XG4gICAgICAgICAgICBpZiAodGhpcy5fbG9hZGVyLm5lZWRTdGFzaEJ1ZmZlciA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9lbmFibGVTdGFzaCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fbG9hZGVyLm9uQ29udGVudExlbmd0aEtub3duID0gdGhpcy5fb25Db250ZW50TGVuZ3RoS25vd24uYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuX2xvYWRlci5vblVSTFJlZGlyZWN0ID0gdGhpcy5fb25VUkxSZWRpcmVjdC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5fbG9hZGVyLm9uRGF0YUFycml2YWwgPSB0aGlzLl9vbkxvYWRlckNodW5rQXJyaXZhbC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5fbG9hZGVyLm9uQ29tcGxldGUgPSB0aGlzLl9vbkxvYWRlckNvbXBsZXRlLmJpbmQodGhpcyk7XG4gICAgICAgICAgICB0aGlzLl9sb2FkZXIub25FcnJvciA9IHRoaXMuX29uTG9hZGVyRXJyb3IuYmluZCh0aGlzKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb3BlbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuKG9wdGlvbmFsRnJvbSkge1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFJhbmdlID0geyBmcm9tOiAwLCB0bzogLTEgfTtcbiAgICAgICAgICAgIGlmIChvcHRpb25hbEZyb20pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50UmFuZ2UuZnJvbSA9IG9wdGlvbmFsRnJvbTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fc3BlZWRTYW1wbGVyLnJlc2V0KCk7XG4gICAgICAgICAgICBpZiAoIW9wdGlvbmFsRnJvbSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Z1bGxSZXF1ZXN0RmxhZyA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX2xvYWRlci5vcGVuKHRoaXMuX2RhdGFTb3VyY2UsIE9iamVjdC5hc3NpZ24oe30sIHRoaXMuX2N1cnJlbnRSYW5nZSkpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhYm9ydCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhYm9ydCgpIHtcbiAgICAgICAgICAgIHRoaXMuX2xvYWRlci5hYm9ydCgpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fcGF1c2VkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGF1c2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVzdW1lRnJvbSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3BhdXNlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNXb3JraW5nKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9sb2FkZXIuYWJvcnQoKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdGFzaFVzZWQgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVzdW1lRnJvbSA9IHRoaXMuX3N0YXNoQnl0ZVN0YXJ0O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50UmFuZ2UudG8gPSB0aGlzLl9zdGFzaEJ5dGVTdGFydCAtIDE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVzdW1lRnJvbSA9IHRoaXMuX2N1cnJlbnRSYW5nZS50byArIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoVXNlZCA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hCeXRlU3RhcnQgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuX3BhdXNlZCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3Jlc3VtZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWUoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fcGF1c2VkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGF1c2VkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFyIGJ5dGVzID0gdGhpcy5fcmVzdW1lRnJvbTtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXN1bWVGcm9tID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnRlcm5hbFNlZWsoYnl0ZXMsIHRydWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzZWVrJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNlZWsoYnl0ZXMpIHtcbiAgICAgICAgICAgIHRoaXMuX3BhdXNlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fc3Rhc2hVc2VkID0gMDtcbiAgICAgICAgICAgIHRoaXMuX3N0YXNoQnl0ZVN0YXJ0ID0gMDtcbiAgICAgICAgICAgIHRoaXMuX2ludGVybmFsU2VlayhieXRlcywgdHJ1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcclxuICAgICAgICAgKiBXaGVuIHNlZWtpbmcgcmVxdWVzdCBpcyBmcm9tIG1lZGlhIHNlZWtpbmcsIHVuY29uc3VtZWQgc3Rhc2ggZGF0YSBzaG91bGQgYmUgZHJvcHBlZFxyXG4gICAgICAgICAqIEhvd2V2ZXIsIHN0YXNoIGRhdGEgc2hvdWxkbid0IGJlIGRyb3BwZWQgaWYgc2Vla2luZyByZXF1ZXN0ZWQgZnJvbSBodHRwIHJlY29ubmVjdGlvblxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQGRyb3BVbmNvbnN1bWVkOiBJZ25vcmUgYW5kIGRpc2NhcmQgYWxsIHVuY29uc3VtZWQgZGF0YSBpbiBzdGFzaCBidWZmZXJcclxuICAgICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2ludGVybmFsU2VlaycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfaW50ZXJuYWxTZWVrKGJ5dGVzLCBkcm9wVW5jb25zdW1lZCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2xvYWRlci5pc1dvcmtpbmcoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRlci5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBkaXNwYXRjaCAmIGZsdXNoIHN0YXNoIGJ1ZmZlciBiZWZvcmUgc2Vla1xuICAgICAgICAgICAgdGhpcy5fZmx1c2hTdGFzaEJ1ZmZlcihkcm9wVW5jb25zdW1lZCk7XG5cbiAgICAgICAgICAgIHRoaXMuX2xvYWRlci5kZXN0cm95KCk7XG4gICAgICAgICAgICB0aGlzLl9sb2FkZXIgPSBudWxsO1xuXG4gICAgICAgICAgICB2YXIgcmVxdWVzdFJhbmdlID0geyBmcm9tOiBieXRlcywgdG86IC0xIH07XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50UmFuZ2UgPSB7IGZyb206IHJlcXVlc3RSYW5nZS5mcm9tLCB0bzogLTEgfTtcblxuICAgICAgICAgICAgdGhpcy5fc3BlZWRTYW1wbGVyLnJlc2V0KCk7XG4gICAgICAgICAgICB0aGlzLl9zdGFzaFNpemUgPSB0aGlzLl9zdGFzaEluaXRpYWxTaXplO1xuICAgICAgICAgICAgdGhpcy5fY3JlYXRlTG9hZGVyKCk7XG4gICAgICAgICAgICB0aGlzLl9sb2FkZXIub3Blbih0aGlzLl9kYXRhU291cmNlLCByZXF1ZXN0UmFuZ2UpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fb25TZWVrZWQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vblNlZWtlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICd1cGRhdGVVcmwnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlVXJsKHVybCkge1xuICAgICAgICAgICAgaWYgKCF1cmwgfHwgdHlwZW9mIHVybCAhPT0gJ3N0cmluZycgfHwgdXJsLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLkludmFsaWRBcmd1bWVudEV4Y2VwdGlvbignVXJsIG11c3QgYmUgYSBub24tZW1wdHkgc3RyaW5nIScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9kYXRhU291cmNlLnVybCA9IHVybDtcblxuICAgICAgICAgICAgLy8gVE9ETzogcmVwbGFjZSB3aXRoIG5ldyB1cmxcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2V4cGFuZEJ1ZmZlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZXhwYW5kQnVmZmVyKGV4cGVjdGVkQnl0ZXMpIHtcbiAgICAgICAgICAgIHZhciBidWZmZXJOZXdTaXplID0gdGhpcy5fc3Rhc2hTaXplO1xuICAgICAgICAgICAgd2hpbGUgKGJ1ZmZlck5ld1NpemUgKyAxMDI0ICogMTAyNCAqIDEgPCBleHBlY3RlZEJ5dGVzKSB7XG4gICAgICAgICAgICAgICAgYnVmZmVyTmV3U2l6ZSAqPSAyO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBidWZmZXJOZXdTaXplICs9IDEwMjQgKiAxMDI0ICogMTsgLy8gYnVmZmVyU2l6ZSA9IHN0YXNoU2l6ZSArIDFNQlxuICAgICAgICAgICAgaWYgKGJ1ZmZlck5ld1NpemUgPT09IHRoaXMuX2J1ZmZlclNpemUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBuZXdCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoYnVmZmVyTmV3U2l6ZSk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGFzaFVzZWQgPiAwKSB7XG4gICAgICAgICAgICAgICAgLy8gY29weSBleGlzdGluZyBkYXRhIGludG8gbmV3IGJ1ZmZlclxuICAgICAgICAgICAgICAgIHZhciBzdGFzaE9sZEFycmF5ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5fc3Rhc2hCdWZmZXIsIDAsIHRoaXMuX3N0YXNoVXNlZCk7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXNoTmV3QXJyYXkgPSBuZXcgVWludDhBcnJheShuZXdCdWZmZXIsIDAsIGJ1ZmZlck5ld1NpemUpO1xuICAgICAgICAgICAgICAgIHN0YXNoTmV3QXJyYXkuc2V0KHN0YXNoT2xkQXJyYXksIDApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9zdGFzaEJ1ZmZlciA9IG5ld0J1ZmZlcjtcbiAgICAgICAgICAgIHRoaXMuX2J1ZmZlclNpemUgPSBidWZmZXJOZXdTaXplO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfbm9ybWFsaXplU3BlZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX25vcm1hbGl6ZVNwZWVkKGlucHV0KSB7XG4gICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXMuX3NwZWVkTm9ybWFsaXplTGlzdDtcbiAgICAgICAgICAgIHZhciBsYXN0ID0gbGlzdC5sZW5ndGggLSAxO1xuICAgICAgICAgICAgdmFyIG1pZCA9IDA7XG4gICAgICAgICAgICB2YXIgbGJvdW5kID0gMDtcbiAgICAgICAgICAgIHZhciB1Ym91bmQgPSBsYXN0O1xuXG4gICAgICAgICAgICBpZiAoaW5wdXQgPCBsaXN0WzBdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxpc3RbMF07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGJpbmFyeSBzZWFyY2hcbiAgICAgICAgICAgIHdoaWxlIChsYm91bmQgPD0gdWJvdW5kKSB7XG4gICAgICAgICAgICAgICAgbWlkID0gbGJvdW5kICsgTWF0aC5mbG9vcigodWJvdW5kIC0gbGJvdW5kKSAvIDIpO1xuICAgICAgICAgICAgICAgIGlmIChtaWQgPT09IGxhc3QgfHwgaW5wdXQgPj0gbGlzdFttaWRdICYmIGlucHV0IDwgbGlzdFttaWQgKyAxXSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGlzdFttaWRdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGlzdFttaWRdIDwgaW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGJvdW5kID0gbWlkICsgMTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB1Ym91bmQgPSBtaWQgLSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2FkanVzdFN0YXNoU2l6ZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfYWRqdXN0U3Rhc2hTaXplKG5vcm1hbGl6ZWQpIHtcbiAgICAgICAgICAgIHZhciBzdGFzaFNpemVLQiA9IDA7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9jb25maWcuaXNMaXZlKSB7XG4gICAgICAgICAgICAgICAgLy8gbGl2ZSBzdHJlYW06IGFsd2F5cyB1c2Ugc2luZ2xlIG5vcm1hbGl6ZWQgc3BlZWQgZm9yIHNpemUgb2Ygc3Rhc2hTaXplS0JcbiAgICAgICAgICAgICAgICBzdGFzaFNpemVLQiA9IG5vcm1hbGl6ZWQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChub3JtYWxpemVkIDwgNTEyKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXNoU2l6ZUtCID0gbm9ybWFsaXplZDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vcm1hbGl6ZWQgPj0gNTEyICYmIG5vcm1hbGl6ZWQgPD0gMTAyNCkge1xuICAgICAgICAgICAgICAgICAgICBzdGFzaFNpemVLQiA9IE1hdGguZmxvb3Iobm9ybWFsaXplZCAqIDEuNSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3Rhc2hTaXplS0IgPSBub3JtYWxpemVkICogMjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzdGFzaFNpemVLQiA+IDgxOTIpIHtcbiAgICAgICAgICAgICAgICBzdGFzaFNpemVLQiA9IDgxOTI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBidWZmZXJTaXplID0gc3Rhc2hTaXplS0IgKiAxMDI0ICsgMTAyNCAqIDEwMjQgKiAxOyAvLyBzdGFzaFNpemUgKyAxTUJcbiAgICAgICAgICAgIGlmICh0aGlzLl9idWZmZXJTaXplIDwgYnVmZmVyU2l6ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2V4cGFuZEJ1ZmZlcihidWZmZXJTaXplKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3N0YXNoU2l6ZSA9IHN0YXNoU2l6ZUtCICogMTAyNDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2Rpc3BhdGNoQ2h1bmtzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9kaXNwYXRjaENodW5rcyhjaHVua3MsIGJ5dGVTdGFydCkge1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFJhbmdlLnRvID0gYnl0ZVN0YXJ0ICsgY2h1bmtzLmJ5dGVMZW5ndGggLSAxO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uRGF0YUFycml2YWwoY2h1bmtzLCBieXRlU3RhcnQpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25VUkxSZWRpcmVjdCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25VUkxSZWRpcmVjdChyZWRpcmVjdGVkVVJMKSB7XG4gICAgICAgICAgICB0aGlzLl9yZWRpcmVjdGVkVVJMID0gcmVkaXJlY3RlZFVSTDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9vblJlZGlyZWN0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25SZWRpcmVjdChyZWRpcmVjdGVkVVJMKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uQ29udGVudExlbmd0aEtub3duJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkNvbnRlbnRMZW5ndGhLbm93bihjb250ZW50TGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAoY29udGVudExlbmd0aCAmJiB0aGlzLl9mdWxsUmVxdWVzdEZsYWcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl90b3RhbExlbmd0aCA9IGNvbnRlbnRMZW5ndGg7XG4gICAgICAgICAgICAgICAgdGhpcy5fZnVsbFJlcXVlc3RGbGFnID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbkxvYWRlckNodW5rQXJyaXZhbCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Mb2FkZXJDaHVua0Fycml2YWwoY2h1bmssIGJ5dGVTdGFydCwgcmVjZWl2ZWRMZW5ndGgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fb25EYXRhQXJyaXZhbCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbignSU9Db250cm9sbGVyOiBObyBleGlzdGluZyBjb25zdW1lciAob25EYXRhQXJyaXZhbCkgY2FsbGJhY2shJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fcGF1c2VkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzRWFybHlFb2ZSZWNvbm5lY3RpbmcpIHtcbiAgICAgICAgICAgICAgICAvLyBBdXRvLXJlY29ubmVjdCBmb3IgRWFybHlFb2Ygc3VjY2VlZCwgbm90aWZ5IHRvIHVwcGVyLWxheWVyIGJ5IGNhbGxiYWNrXG4gICAgICAgICAgICAgICAgdGhpcy5faXNFYXJseUVvZlJlY29ubmVjdGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vblJlY292ZXJlZEVhcmx5RW9mKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uUmVjb3ZlcmVkRWFybHlFb2YoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3NwZWVkU2FtcGxlci5hZGRCeXRlcyhjaHVuay5ieXRlTGVuZ3RoKTtcblxuICAgICAgICAgICAgLy8gYWRqdXN0IHN0YXNoIGJ1ZmZlciBzaXplIGFjY29yZGluZyB0byBuZXR3b3JrIHNwZWVkIGR5bmFtaWNhbGx5XG4gICAgICAgICAgICB2YXIgS0JwcyA9IHRoaXMuX3NwZWVkU2FtcGxlci5sYXN0U2Vjb25kS0JwcztcbiAgICAgICAgICAgIGlmIChLQnBzICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vcm1hbGl6ZWQgPSB0aGlzLl9ub3JtYWxpemVTcGVlZChLQnBzKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3BlZWROb3JtYWxpemVkICE9PSBub3JtYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NwZWVkTm9ybWFsaXplZCA9IG5vcm1hbGl6ZWQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2FkanVzdFN0YXNoU2l6ZShub3JtYWxpemVkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5fZW5hYmxlU3Rhc2gpIHtcbiAgICAgICAgICAgICAgICAvLyBkaXNhYmxlIHN0YXNoXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXNoVXNlZCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBkaXNwYXRjaCBjaHVuayBkaXJlY3RseSB0byBjb25zdW1lcjtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgcmV0IHZhbHVlIChjb25zdW1lZCBieXRlcykgYW5kIHN0YXNoIHVuY29uc3VtZWQgdG8gc3Rhc2hCdWZmZXJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnN1bWVkID0gdGhpcy5fZGlzcGF0Y2hDaHVua3MoY2h1bmssIGJ5dGVTdGFydCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb25zdW1lZCA8IGNodW5rLmJ5dGVMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVuY29uc3VtZWQgZGF0YSByZW1haW4uXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtYWluID0gY2h1bmsuYnl0ZUxlbmd0aCAtIGNvbnN1bWVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlbWFpbiA+IHRoaXMuX2J1ZmZlclNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9leHBhbmRCdWZmZXIocmVtYWluKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGFzaEFycmF5ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5fc3Rhc2hCdWZmZXIsIDAsIHRoaXMuX2J1ZmZlclNpemUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc3Rhc2hBcnJheS5zZXQobmV3IFVpbnQ4QXJyYXkoY2h1bmssIGNvbnN1bWVkKSwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaFVzZWQgKz0gcmVtYWluO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hCeXRlU3RhcnQgPSBieXRlU3RhcnQgKyBjb25zdW1lZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVsc2U6IE1lcmdlIGNodW5rIGludG8gc3Rhc2hCdWZmZXIsIGFuZCBkaXNwYXRjaCBzdGFzaEJ1ZmZlciB0byBjb25zdW1lci5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXNoVXNlZCArIGNodW5rLmJ5dGVMZW5ndGggPiB0aGlzLl9idWZmZXJTaXplKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9leHBhbmRCdWZmZXIodGhpcy5fc3Rhc2hVc2VkICsgY2h1bmsuYnl0ZUxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdmFyIF9zdGFzaEFycmF5ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5fc3Rhc2hCdWZmZXIsIDAsIHRoaXMuX2J1ZmZlclNpemUpO1xuICAgICAgICAgICAgICAgICAgICBfc3Rhc2hBcnJheS5zZXQobmV3IFVpbnQ4QXJyYXkoY2h1bmspLCB0aGlzLl9zdGFzaFVzZWQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaFVzZWQgKz0gY2h1bmsuYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9jb25zdW1lZCA9IHRoaXMuX2Rpc3BhdGNoQ2h1bmtzKHRoaXMuX3N0YXNoQnVmZmVyLnNsaWNlKDAsIHRoaXMuX3N0YXNoVXNlZCksIHRoaXMuX3N0YXNoQnl0ZVN0YXJ0KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9jb25zdW1lZCA8IHRoaXMuX3N0YXNoVXNlZCAmJiBfY29uc3VtZWQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB1bmNvbnN1bWVkIGRhdGEgcmVtYWluXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtYWluQXJyYXkgPSBuZXcgVWludDhBcnJheSh0aGlzLl9zdGFzaEJ1ZmZlciwgX2NvbnN1bWVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9zdGFzaEFycmF5LnNldChyZW1haW5BcnJheSwgMCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hVc2VkIC09IF9jb25zdW1lZDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hCeXRlU3RhcnQgKz0gX2NvbnN1bWVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gZW5hYmxlIHN0YXNoXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXNoVXNlZCA9PT0gMCAmJiB0aGlzLl9zdGFzaEJ5dGVTdGFydCA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBzZWVrZWQ/IG9yIGluaXQgY2h1bms/XG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGZpcnN0IGNodW5rIGFmdGVyIHNlZWsgYWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoQnl0ZVN0YXJ0ID0gYnl0ZVN0YXJ0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3Rhc2hVc2VkICsgY2h1bmsuYnl0ZUxlbmd0aCA8PSB0aGlzLl9zdGFzaFNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8ganVzdCBzdGFzaFxuICAgICAgICAgICAgICAgICAgICB2YXIgX3N0YXNoQXJyYXkyID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5fc3Rhc2hCdWZmZXIsIDAsIHRoaXMuX3N0YXNoU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgIF9zdGFzaEFycmF5Mi5zZXQobmV3IFVpbnQ4QXJyYXkoY2h1bmspLCB0aGlzLl9zdGFzaFVzZWQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaFVzZWQgKz0gY2h1bmsuYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBzdGFzaFVzZWQgKyBjaHVua1NpemUgPiBzdGFzaFNpemUsIHNpemUgbGltaXQgZXhjZWVkZWRcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9zdGFzaEFycmF5MyA9IG5ldyBVaW50OEFycmF5KHRoaXMuX3N0YXNoQnVmZmVyLCAwLCB0aGlzLl9idWZmZXJTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXNoVXNlZCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZXJlJ3JlIHN0YXNoIGRhdGFzIGluIGJ1ZmZlclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZGlzcGF0Y2ggdGhlIHdob2xlIHN0YXNoQnVmZmVyLCBhbmQgc3Rhc2ggcmVtYWluIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZW4gYXBwZW5kIGNodW5rIHRvIHN0YXNoQnVmZmVyIChzdGFzaClcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBidWZmZXIgPSB0aGlzLl9zdGFzaEJ1ZmZlci5zbGljZSgwLCB0aGlzLl9zdGFzaFVzZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9jb25zdW1lZDIgPSB0aGlzLl9kaXNwYXRjaENodW5rcyhidWZmZXIsIHRoaXMuX3N0YXNoQnl0ZVN0YXJ0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfY29uc3VtZWQyIDwgYnVmZmVyLmJ5dGVMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2NvbnN1bWVkMiA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9yZW1haW5BcnJheSA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlciwgX2NvbnN1bWVkMik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zdGFzaEFycmF5My5zZXQoX3JlbWFpbkFycmF5LCAwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hVc2VkID0gX3JlbWFpbkFycmF5LmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoQnl0ZVN0YXJ0ICs9IF9jb25zdW1lZDI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaFVzZWQgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoQnl0ZVN0YXJ0ICs9IF9jb25zdW1lZDI7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3Rhc2hVc2VkICsgY2h1bmsuYnl0ZUxlbmd0aCA+IHRoaXMuX2J1ZmZlclNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9leHBhbmRCdWZmZXIodGhpcy5fc3Rhc2hVc2VkICsgY2h1bmsuYnl0ZUxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3N0YXNoQXJyYXkzID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5fc3Rhc2hCdWZmZXIsIDAsIHRoaXMuX2J1ZmZlclNpemUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgX3N0YXNoQXJyYXkzLnNldChuZXcgVWludDhBcnJheShjaHVuayksIHRoaXMuX3N0YXNoVXNlZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaFVzZWQgKz0gY2h1bmsuYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0YXNoIGJ1ZmZlciBlbXB0eSwgYnV0IGNodW5rU2l6ZSA+IHN0YXNoU2l6ZSAob2gsIGhvbHkgc2hpdClcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpc3BhdGNoIGNodW5rIGRpcmVjdGx5IGFuZCBzdGFzaCByZW1haW4gZGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIF9jb25zdW1lZDMgPSB0aGlzLl9kaXNwYXRjaENodW5rcyhjaHVuaywgYnl0ZVN0YXJ0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfY29uc3VtZWQzIDwgY2h1bmsuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVtYWluID0gY2h1bmsuYnl0ZUxlbmd0aCAtIF9jb25zdW1lZDM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9yZW1haW4gPiB0aGlzLl9idWZmZXJTaXplKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2V4cGFuZEJ1ZmZlcihfcmVtYWluKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3N0YXNoQXJyYXkzID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5fc3Rhc2hCdWZmZXIsIDAsIHRoaXMuX2J1ZmZlclNpemUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc3Rhc2hBcnJheTMuc2V0KG5ldyBVaW50OEFycmF5KGNodW5rLCBfY29uc3VtZWQzKSwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hVc2VkICs9IF9yZW1haW47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hCeXRlU3RhcnQgPSBieXRlU3RhcnQgKyBfY29uc3VtZWQzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfZmx1c2hTdGFzaEJ1ZmZlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZmx1c2hTdGFzaEJ1ZmZlcihkcm9wVW5jb25zdW1lZCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXNoVXNlZCA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgYnVmZmVyID0gdGhpcy5fc3Rhc2hCdWZmZXIuc2xpY2UoMCwgdGhpcy5fc3Rhc2hVc2VkKTtcbiAgICAgICAgICAgICAgICB2YXIgY29uc3VtZWQgPSB0aGlzLl9kaXNwYXRjaENodW5rcyhidWZmZXIsIHRoaXMuX3N0YXNoQnl0ZVN0YXJ0KTtcbiAgICAgICAgICAgICAgICB2YXIgcmVtYWluID0gYnVmZmVyLmJ5dGVMZW5ndGggLSBjb25zdW1lZDtcblxuICAgICAgICAgICAgICAgIGlmIChjb25zdW1lZCA8IGJ1ZmZlci5ieXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkcm9wVW5jb25zdW1lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCByZW1haW4gKyAnIGJ5dGVzIHVuY29uc3VtZWQgZGF0YSByZW1haW4gd2hlbiBmbHVzaCBidWZmZXIsIGRyb3BwZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25zdW1lZCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3Rhc2hBcnJheSA9IG5ldyBVaW50OEFycmF5KHRoaXMuX3N0YXNoQnVmZmVyLCAwLCB0aGlzLl9idWZmZXJTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVtYWluQXJyYXkgPSBuZXcgVWludDhBcnJheShidWZmZXIsIGNvbnN1bWVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFzaEFycmF5LnNldChyZW1haW5BcnJheSwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hVc2VkID0gcmVtYWluQXJyYXkuYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaEJ5dGVTdGFydCArPSBjb25zdW1lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoVXNlZCA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hCeXRlU3RhcnQgPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybiByZW1haW47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uTG9hZGVyQ29tcGxldGUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uTG9hZGVyQ29tcGxldGUoZnJvbSwgdG8pIHtcbiAgICAgICAgICAgIC8vIEZvcmNlLWZsdXNoIHN0YXNoIGJ1ZmZlciwgYW5kIGRyb3AgdW5jb25zdW1lZCBkYXRhXG4gICAgICAgICAgICB0aGlzLl9mbHVzaFN0YXNoQnVmZmVyKHRydWUpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fb25Db21wbGV0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uQ29tcGxldGUodGhpcy5fZXh0cmFEYXRhKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uTG9hZGVyRXJyb3InLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uTG9hZGVyRXJyb3IodHlwZSwgZGF0YSkge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lKHRoaXMuVEFHLCAnTG9hZGVyIGVycm9yLCBjb2RlID0gJyArIGRhdGEuY29kZSArICcsIG1zZyA9ICcgKyBkYXRhLm1zZyk7XG5cbiAgICAgICAgICAgIHRoaXMuX2ZsdXNoU3Rhc2hCdWZmZXIoZmFsc2UpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5faXNFYXJseUVvZlJlY29ubmVjdGluZykge1xuICAgICAgICAgICAgICAgIC8vIEF1dG8tcmVjb25uZWN0IGZvciBFYXJseUVvZiBmYWlsZWQsIHRocm93IFVucmVjb3ZlcmFibGVFYXJseUVvZiBlcnJvciB0byB1cHBlci1sYXllclxuICAgICAgICAgICAgICAgIHRoaXMuX2lzRWFybHlFb2ZSZWNvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0eXBlID0gX2xvYWRlci5Mb2FkZXJFcnJvcnMuVU5SRUNPVkVSQUJMRV9FQVJMWV9FT0Y7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgX2xvYWRlci5Mb2FkZXJFcnJvcnMuRUFSTFlfRU9GOlxuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2NvbmZpZy5pc0xpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBEbyBpbnRlcm5hbCBodHRwIHJlY29ubmVjdCBpZiBub3QgbGl2ZSBzdHJlYW1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fdG90YWxMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5leHRGcm9tID0gdGhpcy5fY3VycmVudFJhbmdlLnRvICsgMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRGcm9tIDwgdGhpcy5fdG90YWxMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ0Nvbm5lY3Rpb24gbG9zdCwgdHJ5aW5nIHJlY29ubmVjdC4uLicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faXNFYXJseUVvZlJlY29ubmVjdGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbnRlcm5hbFNlZWsobmV4dEZyb20sIGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVsc2U6IFdlIGRvbid0IGtub3cgdG90YWxMZW5ndGgsIHRocm93IFVucmVjb3ZlcmFibGVFYXJseUVvZlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbGl2ZSBzdHJlYW06IHRocm93IFVucmVjb3ZlcmFibGVFYXJseUVvZiBlcnJvciB0byB1cHBlci1sYXllclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9IF9sb2FkZXIuTG9hZGVyRXJyb3JzLlVOUkVDT1ZFUkFCTEVfRUFSTFlfRU9GO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIF9sb2FkZXIuTG9hZGVyRXJyb3JzLlVOUkVDT1ZFUkFCTEVfRUFSTFlfRU9GOlxuICAgICAgICAgICAgICAgIGNhc2UgX2xvYWRlci5Mb2FkZXJFcnJvcnMuQ09OTkVDVElOR19USU1FT1VUOlxuICAgICAgICAgICAgICAgIGNhc2UgX2xvYWRlci5Mb2FkZXJFcnJvcnMuSFRUUF9TVEFUVVNfQ09ERV9JTlZBTElEOlxuICAgICAgICAgICAgICAgIGNhc2UgX2xvYWRlci5Mb2FkZXJFcnJvcnMuRVhDRVBUSU9OOlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX29uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKHR5cGUsIGRhdGEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5SdW50aW1lRXhjZXB0aW9uKCdJT0V4Y2VwdGlvbjogJyArIGRhdGEubXNnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc3RhdHVzJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbG9hZGVyLnN0YXR1cztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZXh0cmFEYXRhJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZXh0cmFEYXRhO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChkYXRhKSB7XG4gICAgICAgICAgICB0aGlzLl9leHRyYURhdGEgPSBkYXRhO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcHJvdG90eXBlOiBmdW5jdGlvbiBvbkRhdGFBcnJpdmFsKGNodW5rczogQXJyYXlCdWZmZXIsIGJ5dGVTdGFydDogbnVtYmVyKTogbnVtYmVyXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uRGF0YUFycml2YWwnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vbkRhdGFBcnJpdmFsO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25EYXRhQXJyaXZhbCA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvblNlZWtlZCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uU2Vla2VkO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25TZWVrZWQgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHByb3RvdHlwZTogZnVuY3Rpb24gb25FcnJvcih0eXBlOiBudW1iZXIsIGluZm86IHtjb2RlOiBudW1iZXIsIG1zZzogc3RyaW5nfSk6IHZvaWRcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25FcnJvcicsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uRXJyb3I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vbkVycm9yID0gY2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uQ29tcGxldGUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vbkNvbXBsZXRlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25Db21wbGV0ZSA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvblJlZGlyZWN0JyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25SZWRpcmVjdDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uUmVkaXJlY3QgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25SZWNvdmVyZWRFYXJseUVvZicsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uUmVjb3ZlcmVkRWFybHlFb2Y7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vblJlY292ZXJlZEVhcmx5RW9mID0gY2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2N1cnJlbnRVUkwnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9kYXRhU291cmNlLnVybDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnaGFzUmVkaXJlY3QnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWRpcmVjdGVkVVJMICE9IG51bGwgfHwgdGhpcy5fZGF0YVNvdXJjZS5yZWRpcmVjdGVkVVJMICE9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnY3VycmVudFJlZGlyZWN0ZWRVUkwnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9yZWRpcmVjdGVkVVJMIHx8IHRoaXMuX2RhdGFTb3VyY2UucmVkaXJlY3RlZFVSTDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluIEtCL3NcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnY3VycmVudFNwZWVkJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbG9hZGVyQ2xhc3MgPT09IF94aHJSYW5nZUxvYWRlcjIuZGVmYXVsdCkge1xuICAgICAgICAgICAgICAgIC8vIFNwZWVkU2FtcGxlciBpcyBpbmFjY3VyYWN5IGlmIGxvYWRlciBpcyBSYW5nZUxvYWRlclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2FkZXIuY3VycmVudFNwZWVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NwZWVkU2FtcGxlci5sYXN0U2Vjb25kS0JwcztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbG9hZGVyVHlwZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xvYWRlci50eXBlO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIElPQ29udHJvbGxlcjtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gSU9Db250cm9sbGVyO1xuXG59LHtcIi4uL3V0aWxzL2V4Y2VwdGlvbi5qc1wiOjQwLFwiLi4vdXRpbHMvbG9nZ2VyLmpzXCI6NDEsXCIuL2ZldGNoLXN0cmVhbS1sb2FkZXIuanNcIjoyMixcIi4vbG9hZGVyLmpzXCI6MjQsXCIuL3BhcmFtLXNlZWstaGFuZGxlci5qc1wiOjI1LFwiLi9yYW5nZS1zZWVrLWhhbmRsZXIuanNcIjoyNixcIi4vc3BlZWQtc2FtcGxlci5qc1wiOjI3LFwiLi93ZWJzb2NrZXQtbG9hZGVyLmpzXCI6MjgsXCIuL3hoci1tb3otY2h1bmtlZC1sb2FkZXIuanNcIjoyOSxcIi4veGhyLW1zc3RyZWFtLWxvYWRlci5qc1wiOjMwLFwiLi94aHItcmFuZ2UtbG9hZGVyLmpzXCI6MzF9XSwyNDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuQmFzZUxvYWRlciA9IGV4cG9ydHMuTG9hZGVyRXJyb3JzID0gZXhwb3J0cy5Mb2FkZXJTdGF0dXMgPSB1bmRlZmluZWQ7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgX2V4Y2VwdGlvbiA9IF9kZXJlcV8oJy4uL3V0aWxzL2V4Y2VwdGlvbi5qcycpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgTG9hZGVyU3RhdHVzID0gZXhwb3J0cy5Mb2FkZXJTdGF0dXMgPSB7XG4gICAga0lkbGU6IDAsXG4gICAga0Nvbm5lY3Rpbmc6IDEsXG4gICAga0J1ZmZlcmluZzogMixcbiAgICBrRXJyb3I6IDMsXG4gICAga0NvbXBsZXRlOiA0XG59O1xuXG52YXIgTG9hZGVyRXJyb3JzID0gZXhwb3J0cy5Mb2FkZXJFcnJvcnMgPSB7XG4gICAgT0s6ICdPSycsXG4gICAgRVhDRVBUSU9OOiAnRXhjZXB0aW9uJyxcbiAgICBIVFRQX1NUQVRVU19DT0RFX0lOVkFMSUQ6ICdIdHRwU3RhdHVzQ29kZUludmFsaWQnLFxuICAgIENPTk5FQ1RJTkdfVElNRU9VVDogJ0Nvbm5lY3RpbmdUaW1lb3V0JyxcbiAgICBFQVJMWV9FT0Y6ICdFYXJseUVvZicsXG4gICAgVU5SRUNPVkVSQUJMRV9FQVJMWV9FT0Y6ICdVbnJlY292ZXJhYmxlRWFybHlFb2YnXG59O1xuXG4vKiBMb2FkZXIgaGFzIGNhbGxiYWNrcyB3aGljaCBoYXZlIGZvbGxvd2luZyBwcm90b3R5cGVzOlxyXG4gKiAgICAgZnVuY3Rpb24gb25Db250ZW50TGVuZ3RoS25vd24oY29udGVudExlbmd0aDogbnVtYmVyKTogdm9pZFxyXG4gKiAgICAgZnVuY3Rpb24gb25VUkxSZWRpcmVjdCh1cmw6IHN0cmluZyk6IHZvaWRcclxuICogICAgIGZ1bmN0aW9uIG9uRGF0YUFycml2YWwoY2h1bms6IEFycmF5QnVmZmVyLCBieXRlU3RhcnQ6IG51bWJlciwgcmVjZWl2ZWRMZW5ndGg6IG51bWJlcik6IHZvaWRcclxuICogICAgIGZ1bmN0aW9uIG9uRXJyb3IoZXJyb3JUeXBlOiBudW1iZXIsIGVycm9ySW5mbzoge2NvZGU6IG51bWJlciwgbXNnOiBzdHJpbmd9KTogdm9pZFxyXG4gKiAgICAgZnVuY3Rpb24gb25Db21wbGV0ZShyYW5nZUZyb206IG51bWJlciwgcmFuZ2VUbzogbnVtYmVyKTogdm9pZFxyXG4gKi9cblxudmFyIEJhc2VMb2FkZXIgPSBleHBvcnRzLkJhc2VMb2FkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQmFzZUxvYWRlcih0eXBlTmFtZSkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQmFzZUxvYWRlcik7XG5cbiAgICAgICAgdGhpcy5fdHlwZSA9IHR5cGVOYW1lIHx8ICd1bmRlZmluZWQnO1xuICAgICAgICB0aGlzLl9zdGF0dXMgPSBMb2FkZXJTdGF0dXMua0lkbGU7XG4gICAgICAgIHRoaXMuX25lZWRTdGFzaCA9IGZhbHNlO1xuICAgICAgICAvLyBjYWxsYmFja3NcbiAgICAgICAgdGhpcy5fb25Db250ZW50TGVuZ3RoS25vd24gPSBudWxsO1xuICAgICAgICB0aGlzLl9vblVSTFJlZGlyZWN0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5fb25EYXRhQXJyaXZhbCA9IG51bGw7XG4gICAgICAgIHRoaXMuX29uRXJyb3IgPSBudWxsO1xuICAgICAgICB0aGlzLl9vbkNvbXBsZXRlID0gbnVsbDtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoQmFzZUxvYWRlciwgW3tcbiAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gTG9hZGVyU3RhdHVzLmtJZGxlO1xuICAgICAgICAgICAgdGhpcy5fb25Db250ZW50TGVuZ3RoS25vd24gPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25VUkxSZWRpcmVjdCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vbkRhdGFBcnJpdmFsID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uRXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25Db21wbGV0ZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2lzV29ya2luZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpc1dvcmtpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3RhdHVzID09PSBMb2FkZXJTdGF0dXMua0Nvbm5lY3RpbmcgfHwgdGhpcy5fc3RhdHVzID09PSBMb2FkZXJTdGF0dXMua0J1ZmZlcmluZztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb3BlbicsXG5cblxuICAgICAgICAvLyBwdXJlIHZpcnR1YWxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW4oZGF0YVNvdXJjZSwgcmFuZ2UpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLk5vdEltcGxlbWVudGVkRXhjZXB0aW9uKCdVbmltcGxlbWVudGVkIGFic3RyYWN0IGZ1bmN0aW9uIScpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhYm9ydCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhYm9ydCgpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLk5vdEltcGxlbWVudGVkRXhjZXB0aW9uKCdVbmltcGxlbWVudGVkIGFic3RyYWN0IGZ1bmN0aW9uIScpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICd0eXBlJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdHlwZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc3RhdHVzJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fc3RhdHVzO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICduZWVkU3Rhc2hCdWZmZXInLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9uZWVkU3Rhc2g7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uQ29udGVudExlbmd0aEtub3duJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25Db250ZW50TGVuZ3RoS25vd247XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vbkNvbnRlbnRMZW5ndGhLbm93biA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvblVSTFJlZGlyZWN0JyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25VUkxSZWRpcmVjdDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uVVJMUmVkaXJlY3QgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25EYXRhQXJyaXZhbCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uRGF0YUFycml2YWw7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vbkRhdGFBcnJpdmFsID0gY2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uRXJyb3InLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vbkVycm9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25FcnJvciA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbkNvbXBsZXRlJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25Db21wbGV0ZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uQ29tcGxldGUgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBCYXNlTG9hZGVyO1xufSgpO1xuXG59LHtcIi4uL3V0aWxzL2V4Y2VwdGlvbi5qc1wiOjQwfV0sMjU6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbnZhciBQYXJhbVNlZWtIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFBhcmFtU2Vla0hhbmRsZXIocGFyYW1TdGFydCwgcGFyYW1FbmQpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFBhcmFtU2Vla0hhbmRsZXIpO1xuXG4gICAgICAgIHRoaXMuX3N0YXJ0TmFtZSA9IHBhcmFtU3RhcnQ7XG4gICAgICAgIHRoaXMuX2VuZE5hbWUgPSBwYXJhbUVuZDtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoUGFyYW1TZWVrSGFuZGxlciwgW3tcbiAgICAgICAga2V5OiAnZ2V0Q29uZmlnJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvbmZpZyhiYXNlVXJsLCByYW5nZSkge1xuICAgICAgICAgICAgdmFyIHVybCA9IGJhc2VVcmw7XG5cbiAgICAgICAgICAgIGlmIChyYW5nZS5mcm9tICE9PSAwIHx8IHJhbmdlLnRvICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHZhciBuZWVkQW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAodXJsLmluZGV4T2YoJz8nKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsICs9ICc/JztcbiAgICAgICAgICAgICAgICAgICAgbmVlZEFuZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChuZWVkQW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIHVybCArPSAnJic7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdXJsICs9IHRoaXMuX3N0YXJ0TmFtZSArICc9JyArIHJhbmdlLmZyb20udG9TdHJpbmcoKTtcblxuICAgICAgICAgICAgICAgIGlmIChyYW5nZS50byAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsICs9ICcmJyArIHRoaXMuX2VuZE5hbWUgKyAnPScgKyByYW5nZS50by50b1N0cmluZygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7fVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVtb3ZlVVJMUGFyYW1ldGVycycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVVUkxQYXJhbWV0ZXJzKHNlZWtlZFVSTCkge1xuICAgICAgICAgICAgdmFyIGJhc2VVUkwgPSBzZWVrZWRVUkwuc3BsaXQoJz8nKVswXTtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgICAgIHZhciBxdWVyeUluZGV4ID0gc2Vla2VkVVJMLmluZGV4T2YoJz8nKTtcbiAgICAgICAgICAgIGlmIChxdWVyeUluZGV4ICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIHBhcmFtcyA9IHNlZWtlZFVSTC5zdWJzdHJpbmcocXVlcnlJbmRleCArIDEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcmVzdWx0UGFyYW1zID0gJyc7XG5cbiAgICAgICAgICAgIGlmIChwYXJhbXMgIT0gdW5kZWZpbmVkICYmIHBhcmFtcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhaXJzID0gcGFyYW1zLnNwbGl0KCcmJyk7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBhaXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYWlyID0gcGFpcnNbaV0uc3BsaXQoJz0nKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcXVpcmVBbmQgPSBpID4gMDtcblxuICAgICAgICAgICAgICAgICAgICBpZiAocGFpclswXSAhPT0gdGhpcy5fc3RhcnROYW1lICYmIHBhaXJbMF0gIT09IHRoaXMuX2VuZE5hbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXF1aXJlQW5kKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0UGFyYW1zICs9ICcmJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFBhcmFtcyArPSBwYWlyc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdFBhcmFtcy5sZW5ndGggPT09IDAgPyBiYXNlVVJMIDogYmFzZVVSTCArICc/JyArIHJlc3VsdFBhcmFtcztcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBQYXJhbVNlZWtIYW5kbGVyO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBQYXJhbVNlZWtIYW5kbGVyO1xuXG59LHt9XSwyNjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxudmFyIFJhbmdlU2Vla0hhbmRsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUmFuZ2VTZWVrSGFuZGxlcih6ZXJvU3RhcnQpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJhbmdlU2Vla0hhbmRsZXIpO1xuXG4gICAgICAgIHRoaXMuX3plcm9TdGFydCA9IHplcm9TdGFydCB8fCBmYWxzZTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoUmFuZ2VTZWVrSGFuZGxlciwgW3tcbiAgICAgICAga2V5OiAnZ2V0Q29uZmlnJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvbmZpZyh1cmwsIHJhbmdlKSB7XG4gICAgICAgICAgICB2YXIgaGVhZGVycyA9IHt9O1xuXG4gICAgICAgICAgICBpZiAocmFuZ2UuZnJvbSAhPT0gMCB8fCByYW5nZS50byAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFyYW0gPSB2b2lkIDA7XG4gICAgICAgICAgICAgICAgaWYgKHJhbmdlLnRvICE9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBwYXJhbSA9ICdieXRlcz0nICsgcmFuZ2UuZnJvbS50b1N0cmluZygpICsgJy0nICsgcmFuZ2UudG8udG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwYXJhbSA9ICdieXRlcz0nICsgcmFuZ2UuZnJvbS50b1N0cmluZygpICsgJy0nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBoZWFkZXJzWydSYW5nZSddID0gcGFyYW07XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX3plcm9TdGFydCkge1xuICAgICAgICAgICAgICAgIGhlYWRlcnNbJ1JhbmdlJ10gPSAnYnl0ZXM9MC0nO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnNcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlbW92ZVVSTFBhcmFtZXRlcnMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlVVJMUGFyYW1ldGVycyhzZWVrZWRVUkwpIHtcbiAgICAgICAgICAgIHJldHVybiBzZWVrZWRVUkw7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gUmFuZ2VTZWVrSGFuZGxlcjtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gUmFuZ2VTZWVrSGFuZGxlcjtcblxufSx7fV0sMjc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxuLy8gVXRpbGl0eSBjbGFzcyB0byBjYWxjdWxhdGUgcmVhbHRpbWUgbmV0d29yayBJL08gc3BlZWRcbnZhciBTcGVlZFNhbXBsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU3BlZWRTYW1wbGVyKCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU3BlZWRTYW1wbGVyKTtcblxuICAgICAgICAvLyBtaWxsaXNlY29uZHNcbiAgICAgICAgdGhpcy5fZmlyc3RDaGVja3BvaW50ID0gMDtcbiAgICAgICAgdGhpcy5fbGFzdENoZWNrcG9pbnQgPSAwO1xuICAgICAgICB0aGlzLl9pbnRlcnZhbEJ5dGVzID0gMDtcbiAgICAgICAgdGhpcy5fdG90YWxCeXRlcyA9IDA7XG4gICAgICAgIHRoaXMuX2xhc3RTZWNvbmRCeXRlcyA9IDA7XG5cbiAgICAgICAgLy8gY29tcGF0aWJpbGl0eSBkZXRlY3Rpb25cbiAgICAgICAgaWYgKHNlbGYucGVyZm9ybWFuY2UgJiYgc2VsZi5wZXJmb3JtYW5jZS5ub3cpIHtcbiAgICAgICAgICAgIHRoaXMuX25vdyA9IHNlbGYucGVyZm9ybWFuY2Uubm93LmJpbmQoc2VsZi5wZXJmb3JtYW5jZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9ub3cgPSBEYXRlLm5vdztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhTcGVlZFNhbXBsZXIsIFt7XG4gICAgICAgIGtleTogXCJyZXNldFwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVzZXQoKSB7XG4gICAgICAgICAgICB0aGlzLl9maXJzdENoZWNrcG9pbnQgPSB0aGlzLl9sYXN0Q2hlY2twb2ludCA9IDA7XG4gICAgICAgICAgICB0aGlzLl90b3RhbEJ5dGVzID0gdGhpcy5faW50ZXJ2YWxCeXRlcyA9IDA7XG4gICAgICAgICAgICB0aGlzLl9sYXN0U2Vjb25kQnl0ZXMgPSAwO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiYWRkQnl0ZXNcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZEJ5dGVzKGJ5dGVzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fZmlyc3RDaGVja3BvaW50ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZmlyc3RDaGVja3BvaW50ID0gdGhpcy5fbm93KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbGFzdENoZWNrcG9pbnQgPSB0aGlzLl9maXJzdENoZWNrcG9pbnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5faW50ZXJ2YWxCeXRlcyArPSBieXRlcztcbiAgICAgICAgICAgICAgICB0aGlzLl90b3RhbEJ5dGVzICs9IGJ5dGVzO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9ub3coKSAtIHRoaXMuX2xhc3RDaGVja3BvaW50IDwgMTAwMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2ludGVydmFsQnl0ZXMgKz0gYnl0ZXM7XG4gICAgICAgICAgICAgICAgdGhpcy5fdG90YWxCeXRlcyArPSBieXRlcztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gZHVyYXRpb24gPj0gMTAwMFxuICAgICAgICAgICAgICAgIHRoaXMuX2xhc3RTZWNvbmRCeXRlcyA9IHRoaXMuX2ludGVydmFsQnl0ZXM7XG4gICAgICAgICAgICAgICAgdGhpcy5faW50ZXJ2YWxCeXRlcyA9IGJ5dGVzO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RvdGFsQnl0ZXMgKz0gYnl0ZXM7XG4gICAgICAgICAgICAgICAgdGhpcy5fbGFzdENoZWNrcG9pbnQgPSB0aGlzLl9ub3coKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImN1cnJlbnRLQnBzXCIsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgdGhpcy5hZGRCeXRlcygwKTtcblxuICAgICAgICAgICAgdmFyIGR1cmF0aW9uU2Vjb25kcyA9ICh0aGlzLl9ub3coKSAtIHRoaXMuX2xhc3RDaGVja3BvaW50KSAvIDEwMDA7XG4gICAgICAgICAgICBpZiAoZHVyYXRpb25TZWNvbmRzID09IDApIGR1cmF0aW9uU2Vjb25kcyA9IDE7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faW50ZXJ2YWxCeXRlcyAvIGR1cmF0aW9uU2Vjb25kcyAvIDEwMjQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJsYXN0U2Vjb25kS0Jwc1wiLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkQnl0ZXMoMCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9sYXN0U2Vjb25kQnl0ZXMgIT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbGFzdFNlY29uZEJ5dGVzIC8gMTAyNDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gbGFzdFNlY29uZEJ5dGVzID09PSAwXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX25vdygpIC0gdGhpcy5fbGFzdENoZWNrcG9pbnQgPj0gNTAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRpbWUgaW50ZXJ2YWwgc2luY2UgbGFzdCBjaGVja3BvaW50IGhhcyBleGNlZWRlZCA1MDBtc1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgc3BlZWQgaXMgbmVhcmx5IGFjY3VyYXRlXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRLQnBzO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIGRvbid0IGtub3dcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiYXZlcmFnZUtCcHNcIixcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICB2YXIgZHVyYXRpb25TZWNvbmRzID0gKHRoaXMuX25vdygpIC0gdGhpcy5fZmlyc3RDaGVja3BvaW50KSAvIDEwMDA7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdG90YWxCeXRlcyAvIGR1cmF0aW9uU2Vjb25kcyAvIDEwMjQ7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gU3BlZWRTYW1wbGVyO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBTcGVlZFNhbXBsZXI7XG5cbn0se31dLDI4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfbG9nZ2VyID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nZ2VyLmpzJyk7XG5cbnZhciBfbG9nZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dlcik7XG5cbnZhciBfbG9hZGVyID0gX2RlcmVxXygnLi9sb2FkZXIuanMnKTtcblxudmFyIF9leGNlcHRpb24gPSBfZGVyZXFfKCcuLi91dGlscy9leGNlcHRpb24uanMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfSAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG4vLyBGb3IgRkxWIG92ZXIgV2ViU29ja2V0IGxpdmUgc3RyZWFtXG52YXIgV2ViU29ja2V0TG9hZGVyID0gZnVuY3Rpb24gKF9CYXNlTG9hZGVyKSB7XG4gICAgX2luaGVyaXRzKFdlYlNvY2tldExvYWRlciwgX0Jhc2VMb2FkZXIpO1xuXG4gICAgX2NyZWF0ZUNsYXNzKFdlYlNvY2tldExvYWRlciwgbnVsbCwgW3tcbiAgICAgICAga2V5OiAnaXNTdXBwb3J0ZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaXNTdXBwb3J0ZWQoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0eXBlb2Ygc2VsZi5XZWJTb2NrZXQgIT09ICd1bmRlZmluZWQnO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIGZ1bmN0aW9uIFdlYlNvY2tldExvYWRlcigpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFdlYlNvY2tldExvYWRlcik7XG5cbiAgICAgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKFdlYlNvY2tldExvYWRlci5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFdlYlNvY2tldExvYWRlcikpLmNhbGwodGhpcywgJ3dlYnNvY2tldC1sb2FkZXInKSk7XG5cbiAgICAgICAgX3RoaXMuVEFHID0gJ1dlYlNvY2tldExvYWRlcic7XG5cbiAgICAgICAgX3RoaXMuX25lZWRTdGFzaCA9IHRydWU7XG5cbiAgICAgICAgX3RoaXMuX3dzID0gbnVsbDtcbiAgICAgICAgX3RoaXMuX3JlcXVlc3RBYm9ydCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5fcmVjZWl2ZWRMZW5ndGggPSAwO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFdlYlNvY2tldExvYWRlciwgW3tcbiAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3dzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX2dldChXZWJTb2NrZXRMb2FkZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoV2ViU29ja2V0TG9hZGVyLnByb3RvdHlwZSksICdkZXN0cm95JywgdGhpcykuY2FsbCh0aGlzKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb3BlbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuKGRhdGFTb3VyY2UpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIHdzID0gdGhpcy5fd3MgPSBuZXcgc2VsZi5XZWJTb2NrZXQoZGF0YVNvdXJjZS51cmwpO1xuICAgICAgICAgICAgICAgIHdzLmJpbmFyeVR5cGUgPSAnYXJyYXlidWZmZXInO1xuICAgICAgICAgICAgICAgIHdzLm9ub3BlbiA9IHRoaXMuX29uV2ViU29ja2V0T3Blbi5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgICAgIHdzLm9uY2xvc2UgPSB0aGlzLl9vbldlYlNvY2tldENsb3NlLmJpbmQodGhpcyk7XG4gICAgICAgICAgICAgICAgd3Mub25tZXNzYWdlID0gdGhpcy5fb25XZWJTb2NrZXRNZXNzYWdlLmJpbmQodGhpcyk7XG4gICAgICAgICAgICAgICAgd3Mub25lcnJvciA9IHRoaXMuX29uV2ViU29ja2V0RXJyb3IuYmluZCh0aGlzKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb25uZWN0aW5nO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcjtcblxuICAgICAgICAgICAgICAgIHZhciBpbmZvID0geyBjb2RlOiBlLmNvZGUsIG1zZzogZS5tZXNzYWdlIH07XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVYQ0VQVElPTiwgaW5mbyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uUnVudGltZUV4Y2VwdGlvbihpbmZvLm1zZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhYm9ydCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhYm9ydCgpIHtcbiAgICAgICAgICAgIHZhciB3cyA9IHRoaXMuX3dzO1xuICAgICAgICAgICAgaWYgKHdzICYmICh3cy5yZWFkeVN0YXRlID09PSAwIHx8IHdzLnJlYWR5U3RhdGUgPT09IDEpKSB7XG4gICAgICAgICAgICAgICAgLy8gQ09OTkVDVElORyB8fCBPUEVOXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdEFib3J0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB3cy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl93cyA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29tcGxldGU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbldlYlNvY2tldE9wZW4nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uV2ViU29ja2V0T3BlbihlKSB7XG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQnVmZmVyaW5nO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25XZWJTb2NrZXRDbG9zZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25XZWJTb2NrZXRDbG9zZShlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fcmVxdWVzdEFib3J0ID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdEFib3J0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29tcGxldGU7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9vbkNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25Db21wbGV0ZSgwLCB0aGlzLl9yZWNlaXZlZExlbmd0aCAtIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25XZWJTb2NrZXRNZXNzYWdlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbldlYlNvY2tldE1lc3NhZ2UoZSkge1xuICAgICAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgICAgICAgIGlmIChlLmRhdGEgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX2Rpc3BhdGNoQXJyYXlCdWZmZXIoZS5kYXRhKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5kYXRhIGluc3RhbmNlb2YgQmxvYikge1xuICAgICAgICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMi5fZGlzcGF0Y2hBcnJheUJ1ZmZlcihyZWFkZXIucmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihlLmRhdGEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3I7XG4gICAgICAgICAgICAgICAgdmFyIGluZm8gPSB7IGNvZGU6IC0xLCBtc2c6ICdVbnN1cHBvcnRlZCBXZWJTb2NrZXQgbWVzc2FnZSB0eXBlOiAnICsgZS5kYXRhLmNvbnN0cnVjdG9yLm5hbWUgfTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoX2xvYWRlci5Mb2FkZXJFcnJvcnMuRVhDRVBUSU9OLCBpbmZvKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5SdW50aW1lRXhjZXB0aW9uKGluZm8ubXNnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19kaXNwYXRjaEFycmF5QnVmZmVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9kaXNwYXRjaEFycmF5QnVmZmVyKGFycmF5YnVmZmVyKSB7XG4gICAgICAgICAgICB2YXIgY2h1bmsgPSBhcnJheWJ1ZmZlcjtcbiAgICAgICAgICAgIHZhciBieXRlU3RhcnQgPSB0aGlzLl9yZWNlaXZlZExlbmd0aDtcbiAgICAgICAgICAgIHRoaXMuX3JlY2VpdmVkTGVuZ3RoICs9IGNodW5rLmJ5dGVMZW5ndGg7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9vbkRhdGFBcnJpdmFsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25EYXRhQXJyaXZhbChjaHVuaywgYnl0ZVN0YXJ0LCB0aGlzLl9yZWNlaXZlZExlbmd0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbldlYlNvY2tldEVycm9yJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbldlYlNvY2tldEVycm9yKGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcjtcblxuICAgICAgICAgICAgdmFyIGluZm8gPSB7XG4gICAgICAgICAgICAgICAgY29kZTogZS5jb2RlLFxuICAgICAgICAgICAgICAgIG1zZzogZS5tZXNzYWdlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fb25FcnJvcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoX2xvYWRlci5Mb2FkZXJFcnJvcnMuRVhDRVBUSU9OLCBpbmZvKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uUnVudGltZUV4Y2VwdGlvbihpbmZvLm1zZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gV2ViU29ja2V0TG9hZGVyO1xufShfbG9hZGVyLkJhc2VMb2FkZXIpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBXZWJTb2NrZXRMb2FkZXI7XG5cbn0se1wiLi4vdXRpbHMvZXhjZXB0aW9uLmpzXCI6NDAsXCIuLi91dGlscy9sb2dnZXIuanNcIjo0MSxcIi4vbG9hZGVyLmpzXCI6MjR9XSwyOTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfbG9nZ2VyID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nZ2VyLmpzJyk7XG5cbnZhciBfbG9nZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dlcik7XG5cbnZhciBfbG9hZGVyID0gX2RlcmVxXygnLi9sb2FkZXIuanMnKTtcblxudmFyIF9leGNlcHRpb24gPSBfZGVyZXFfKCcuLi91dGlscy9leGNlcHRpb24uanMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfSAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG4vLyBGb3IgRmlyZUZveCBicm93c2VyIHdoaWNoIHN1cHBvcnRzIGB4aHIucmVzcG9uc2VUeXBlID0gJ21vei1jaHVua2VkLWFycmF5YnVmZmVyJ2BcbnZhciBNb3pDaHVua2VkTG9hZGVyID0gZnVuY3Rpb24gKF9CYXNlTG9hZGVyKSB7XG4gICAgX2luaGVyaXRzKE1vekNodW5rZWRMb2FkZXIsIF9CYXNlTG9hZGVyKTtcblxuICAgIF9jcmVhdGVDbGFzcyhNb3pDaHVua2VkTG9hZGVyLCBudWxsLCBbe1xuICAgICAgICBrZXk6ICdpc1N1cHBvcnRlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpc1N1cHBvcnRlZCgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICAgICAgICAgIC8vIEZpcmVmb3ggMzctIHJlcXVpcmVzIC5vcGVuKCkgdG8gYmUgY2FsbGVkIGJlZm9yZSBzZXR0aW5nIHJlc3BvbnNlVHlwZVxuICAgICAgICAgICAgICAgIHhoci5vcGVuKCdHRVQnLCAnaHR0cHM6Ly9leGFtcGxlLmNvbScsIHRydWUpO1xuICAgICAgICAgICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnbW96LWNodW5rZWQtYXJyYXlidWZmZXInO1xuICAgICAgICAgICAgICAgIHJldHVybiB4aHIucmVzcG9uc2VUeXBlID09PSAnbW96LWNodW5rZWQtYXJyYXlidWZmZXInO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudygnTW96Q2h1bmtlZExvYWRlcicsIGUubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgZnVuY3Rpb24gTW96Q2h1bmtlZExvYWRlcihzZWVrSGFuZGxlciwgY29uZmlnKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNb3pDaHVua2VkTG9hZGVyKTtcblxuICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoTW96Q2h1bmtlZExvYWRlci5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE1vekNodW5rZWRMb2FkZXIpKS5jYWxsKHRoaXMsICd4aHItbW96LWNodW5rZWQtbG9hZGVyJykpO1xuXG4gICAgICAgIF90aGlzLlRBRyA9ICdNb3pDaHVua2VkTG9hZGVyJztcblxuICAgICAgICBfdGhpcy5fc2Vla0hhbmRsZXIgPSBzZWVrSGFuZGxlcjtcbiAgICAgICAgX3RoaXMuX2NvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgX3RoaXMuX25lZWRTdGFzaCA9IHRydWU7XG5cbiAgICAgICAgX3RoaXMuX3hociA9IG51bGw7XG4gICAgICAgIF90aGlzLl9yZXF1ZXN0QWJvcnQgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMuX2NvbnRlbnRMZW5ndGggPSBudWxsO1xuICAgICAgICBfdGhpcy5fcmVjZWl2ZWRMZW5ndGggPSAwO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKE1vekNodW5rZWRMb2FkZXIsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzV29ya2luZygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX3hocikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5vbnByb2dyZXNzID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIub25sb2FkZW5kID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIub25lcnJvciA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9nZXQoTW96Q2h1bmtlZExvYWRlci5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihNb3pDaHVua2VkTG9hZGVyLnByb3RvdHlwZSksICdkZXN0cm95JywgdGhpcykuY2FsbCh0aGlzKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb3BlbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuKGRhdGFTb3VyY2UsIHJhbmdlKSB7XG4gICAgICAgICAgICB0aGlzLl9kYXRhU291cmNlID0gZGF0YVNvdXJjZTtcbiAgICAgICAgICAgIHRoaXMuX3JhbmdlID0gcmFuZ2U7XG5cbiAgICAgICAgICAgIHZhciBzb3VyY2VVUkwgPSBkYXRhU291cmNlLnVybDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9jb25maWcucmV1c2VSZWRpcmVjdGVkVVJMICYmIGRhdGFTb3VyY2UucmVkaXJlY3RlZFVSTCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBzb3VyY2VVUkwgPSBkYXRhU291cmNlLnJlZGlyZWN0ZWRVUkw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzZWVrQ29uZmlnID0gdGhpcy5fc2Vla0hhbmRsZXIuZ2V0Q29uZmlnKHNvdXJjZVVSTCwgcmFuZ2UpO1xuICAgICAgICAgICAgdGhpcy5fcmVxdWVzdFVSTCA9IHNlZWtDb25maWcudXJsO1xuXG4gICAgICAgICAgICB2YXIgeGhyID0gdGhpcy5feGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgICAgICB4aHIub3BlbignR0VUJywgc2Vla0NvbmZpZy51cmwsIHRydWUpO1xuICAgICAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdtb3otY2h1bmtlZC1hcnJheWJ1ZmZlcic7XG4gICAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gdGhpcy5fb25SZWFkeVN0YXRlQ2hhbmdlLmJpbmQodGhpcyk7XG4gICAgICAgICAgICB4aHIub25wcm9ncmVzcyA9IHRoaXMuX29uUHJvZ3Jlc3MuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHhoci5vbmxvYWRlbmQgPSB0aGlzLl9vbkxvYWRFbmQuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHhoci5vbmVycm9yID0gdGhpcy5fb25YaHJFcnJvci5iaW5kKHRoaXMpO1xuXG4gICAgICAgICAgICAvLyBjb3JzIGlzIGF1dG8gZGV0ZWN0ZWQgYW5kIGVuYWJsZWQgYnkgeGhyXG5cbiAgICAgICAgICAgIC8vIHdpdGhDcmVkZW50aWFscyBpcyBkaXNhYmxlZCBieSBkZWZhdWx0XG4gICAgICAgICAgICBpZiAoZGF0YVNvdXJjZS53aXRoQ3JlZGVudGlhbHMpIHtcbiAgICAgICAgICAgICAgICB4aHIud2l0aENyZWRlbnRpYWxzID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKF90eXBlb2Yoc2Vla0NvbmZpZy5oZWFkZXJzKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICB2YXIgaGVhZGVycyA9IHNlZWtDb25maWcuaGVhZGVycztcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBoZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChoZWFkZXJzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKGtleSwgaGVhZGVyc1trZXldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYWRkIGFkZGl0aW9uYWwgaGVhZGVyc1xuICAgICAgICAgICAgaWYgKF90eXBlb2YodGhpcy5fY29uZmlnLmhlYWRlcnMpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIHZhciBfaGVhZGVycyA9IHRoaXMuX2NvbmZpZy5oZWFkZXJzO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2tleSBpbiBfaGVhZGVycykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX2hlYWRlcnMuaGFzT3duUHJvcGVydHkoX2tleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKF9rZXksIF9oZWFkZXJzW19rZXldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Nvbm5lY3Rpbmc7XG4gICAgICAgICAgICB4aHIuc2VuZCgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhYm9ydCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhYm9ydCgpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RBYm9ydCA9IHRydWU7XG4gICAgICAgICAgICBpZiAodGhpcy5feGhyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLmFib3J0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29tcGxldGU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblJlYWR5U3RhdGVDaGFuZ2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVhZHlTdGF0ZUNoYW5nZShlKSB7XG4gICAgICAgICAgICB2YXIgeGhyID0gZS50YXJnZXQ7XG5cbiAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gMikge1xuICAgICAgICAgICAgICAgIC8vIEhFQURFUlNfUkVDRUlWRURcbiAgICAgICAgICAgICAgICBpZiAoeGhyLnJlc3BvbnNlVVJMICE9IHVuZGVmaW5lZCAmJiB4aHIucmVzcG9uc2VVUkwgIT09IHRoaXMuX3JlcXVlc3RVUkwpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uVVJMUmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWRpcmVjdGVkVVJMID0gdGhpcy5fc2Vla0hhbmRsZXIucmVtb3ZlVVJMUGFyYW1ldGVycyh4aHIucmVzcG9uc2VVUkwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25VUkxSZWRpcmVjdChyZWRpcmVjdGVkVVJMKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzICE9PSAwICYmICh4aHIuc3RhdHVzIDwgMjAwIHx8IHhoci5zdGF0dXMgPiAyOTkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoX2xvYWRlci5Mb2FkZXJFcnJvcnMuSFRUUF9TVEFUVVNfQ09ERV9JTlZBTElELCB7IGNvZGU6IHhoci5zdGF0dXMsIG1zZzogeGhyLnN0YXR1c1RleHQgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5SdW50aW1lRXhjZXB0aW9uKCdNb3pDaHVua2VkTG9hZGVyOiBIdHRwIGNvZGUgaW52YWxpZCwgJyArIHhoci5zdGF0dXMgKyAnICcgKyB4aHIuc3RhdHVzVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQnVmZmVyaW5nO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uUHJvZ3Jlc3MnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uUHJvZ3Jlc3MoZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXR1cyA9PT0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgLy8gSWdub3JlIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5fY29udGVudExlbmd0aCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGlmIChlLnRvdGFsICE9PSBudWxsICYmIGUudG90YWwgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29udGVudExlbmd0aCA9IGUudG90YWw7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vbkNvbnRlbnRMZW5ndGhLbm93bikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25Db250ZW50TGVuZ3RoS25vd24odGhpcy5fY29udGVudExlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBjaHVuayA9IGUudGFyZ2V0LnJlc3BvbnNlO1xuICAgICAgICAgICAgdmFyIGJ5dGVTdGFydCA9IHRoaXMuX3JhbmdlLmZyb20gKyB0aGlzLl9yZWNlaXZlZExlbmd0aDtcbiAgICAgICAgICAgIHRoaXMuX3JlY2VpdmVkTGVuZ3RoICs9IGNodW5rLmJ5dGVMZW5ndGg7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9vbkRhdGFBcnJpdmFsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25EYXRhQXJyaXZhbChjaHVuaywgYnl0ZVN0YXJ0LCB0aGlzLl9yZWNlaXZlZExlbmd0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbkxvYWRFbmQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uTG9hZEVuZChlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fcmVxdWVzdEFib3J0ID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdEFib3J0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9zdGF0dXMgPT09IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0NvbXBsZXRlO1xuICAgICAgICAgICAgaWYgKHRoaXMuX29uQ29tcGxldGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkNvbXBsZXRlKHRoaXMuX3JhbmdlLmZyb20sIHRoaXMuX3JhbmdlLmZyb20gKyB0aGlzLl9yZWNlaXZlZExlbmd0aCAtIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25YaHJFcnJvcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25YaHJFcnJvcihlKSB7XG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3I7XG4gICAgICAgICAgICB2YXIgdHlwZSA9IDA7XG4gICAgICAgICAgICB2YXIgaW5mbyA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9jb250ZW50TGVuZ3RoICYmIGUubG9hZGVkIDwgdGhpcy5fY29udGVudExlbmd0aCkge1xuICAgICAgICAgICAgICAgIHR5cGUgPSBfbG9hZGVyLkxvYWRlckVycm9ycy5FQVJMWV9FT0Y7XG4gICAgICAgICAgICAgICAgaW5mbyA9IHsgY29kZTogLTEsIG1zZzogJ01vei1DaHVua2VkIHN0cmVhbSBtZWV0IEVhcmx5LUVvZicgfTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdHlwZSA9IF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVYQ0VQVElPTjtcbiAgICAgICAgICAgICAgICBpbmZvID0geyBjb2RlOiAtMSwgbXNnOiBlLmNvbnN0cnVjdG9yLm5hbWUgKyAnICcgKyBlLnR5cGUgfTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX29uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKHR5cGUsIGluZm8pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5SdW50aW1lRXhjZXB0aW9uKGluZm8ubXNnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBNb3pDaHVua2VkTG9hZGVyO1xufShfbG9hZGVyLkJhc2VMb2FkZXIpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBNb3pDaHVua2VkTG9hZGVyO1xuXG59LHtcIi4uL3V0aWxzL2V4Y2VwdGlvbi5qc1wiOjQwLFwiLi4vdXRpbHMvbG9nZ2VyLmpzXCI6NDEsXCIuL2xvYWRlci5qc1wiOjI0fV0sMzA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9O1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2xvZ2dlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZ2dlci5qcycpO1xuXG52YXIgX2xvZ2dlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnZXIpO1xuXG52YXIgX2xvYWRlciA9IF9kZXJlcV8oJy4vbG9hZGVyLmpzJyk7XG5cbnZhciBfZXhjZXB0aW9uID0gX2RlcmVxXygnLi4vdXRpbHMvZXhjZXB0aW9uLmpzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0gLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuLyogTm90aWNlOiBtcy1zdHJlYW0gbWF5IGNhdXNlIElFL0VkZ2UgYnJvd3NlciBjcmFzaCBpZiBzZWVrIHRvbyBmcmVxdWVudGx5ISEhXHJcbiAqIFRoZSBicm93c2VyIG1heSBjcmFzaCBpbiB3aW5pbmV0LmRsbC4gRGlzYWJsZSBmb3Igbm93LlxyXG4gKlxyXG4gKiBGb3IgSUUxMS9FZGdlIGJyb3dzZXIgYnkgbWljcm9zb2Z0IHdoaWNoIHN1cHBvcnRzIGB4aHIucmVzcG9uc2VUeXBlID0gJ21zLXN0cmVhbSdgXHJcbiAqIE5vdGljZSB0aGF0IG1zLXN0cmVhbSBBUEkgc3Vja3MuIFRoZSBidWZmZXIgaXMgYWx3YXlzIGV4cGFuZGluZyBhbG9uZyB3aXRoIGRvd25sb2FkaW5nLlxyXG4gKlxyXG4gKiBXZSBuZWVkIHRvIGFib3J0IHRoZSB4aHIgaWYgYnVmZmVyIHNpemUgZXhjZWVkZWQgbGltaXQgc2l6ZSAoZS5nLiAxNiBNaUIpLCB0aGVuIGRvIHJlY29ubmVjdC5cclxuICogaW4gb3JkZXIgdG8gcmVsZWFzZSBwcmV2aW91cyBBcnJheUJ1ZmZlciB0byBhdm9pZCBtZW1vcnkgbGVha1xyXG4gKlxyXG4gKiBPdGhlcndpc2UsIHRoZSBBcnJheUJ1ZmZlciB3aWxsIGluY3JlYXNlIHRvIGEgdGVycmlibGUgc2l6ZSB0aGF0IGVxdWFscyBmaW5hbCBmaWxlIHNpemUuXHJcbiAqL1xudmFyIE1TU3RyZWFtTG9hZGVyID0gZnVuY3Rpb24gKF9CYXNlTG9hZGVyKSB7XG4gICAgX2luaGVyaXRzKE1TU3RyZWFtTG9hZGVyLCBfQmFzZUxvYWRlcik7XG5cbiAgICBfY3JlYXRlQ2xhc3MoTVNTdHJlYW1Mb2FkZXIsIG51bGwsIFt7XG4gICAgICAgIGtleTogJ2lzU3VwcG9ydGVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzU3VwcG9ydGVkKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHNlbGYuTVNTdHJlYW0gPT09ICd1bmRlZmluZWQnIHx8IHR5cGVvZiBzZWxmLk1TU3RyZWFtUmVhZGVyID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICAgICAgICAgIHhoci5vcGVuKCdHRVQnLCAnaHR0cHM6Ly9leGFtcGxlLmNvbScsIHRydWUpO1xuICAgICAgICAgICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnbXMtc3RyZWFtJztcbiAgICAgICAgICAgICAgICByZXR1cm4geGhyLnJlc3BvbnNlVHlwZSA9PT0gJ21zLXN0cmVhbSc7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KCdNU1N0cmVhbUxvYWRlcicsIGUubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgZnVuY3Rpb24gTVNTdHJlYW1Mb2FkZXIoc2Vla0hhbmRsZXIsIGNvbmZpZykge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTVNTdHJlYW1Mb2FkZXIpO1xuXG4gICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChNU1N0cmVhbUxvYWRlci5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE1TU3RyZWFtTG9hZGVyKSkuY2FsbCh0aGlzLCAneGhyLW1zc3RyZWFtLWxvYWRlcicpKTtcblxuICAgICAgICBfdGhpcy5UQUcgPSAnTVNTdHJlYW1Mb2FkZXInO1xuXG4gICAgICAgIF90aGlzLl9zZWVrSGFuZGxlciA9IHNlZWtIYW5kbGVyO1xuICAgICAgICBfdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgICAgICBfdGhpcy5fbmVlZFN0YXNoID0gdHJ1ZTtcblxuICAgICAgICBfdGhpcy5feGhyID0gbnVsbDtcbiAgICAgICAgX3RoaXMuX3JlYWRlciA9IG51bGw7IC8vIE1TU3RyZWFtUmVhZGVyXG5cbiAgICAgICAgX3RoaXMuX3RvdGFsUmFuZ2UgPSBudWxsO1xuICAgICAgICBfdGhpcy5fY3VycmVudFJhbmdlID0gbnVsbDtcblxuICAgICAgICBfdGhpcy5fY3VycmVudFJlcXVlc3RVUkwgPSBudWxsO1xuICAgICAgICBfdGhpcy5fY3VycmVudFJlZGlyZWN0ZWRVUkwgPSBudWxsO1xuXG4gICAgICAgIF90aGlzLl9jb250ZW50TGVuZ3RoID0gbnVsbDtcbiAgICAgICAgX3RoaXMuX3JlY2VpdmVkTGVuZ3RoID0gMDtcblxuICAgICAgICBfdGhpcy5fYnVmZmVyTGltaXQgPSAxNiAqIDEwMjQgKiAxMDI0OyAvLyAxNk1CXG4gICAgICAgIF90aGlzLl9sYXN0VGltZUJ1ZmZlclNpemUgPSAwO1xuICAgICAgICBfdGhpcy5faXNSZWNvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhNU1N0cmVhbUxvYWRlciwgW3tcbiAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNXb3JraW5nKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFib3J0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fcmVhZGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVhZGVyLm9ucHJvZ3Jlc3MgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlYWRlci5vbmxvYWQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlYWRlci5vbmVycm9yID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWFkZXIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX3hocikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3hociA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfZ2V0KE1TU3RyZWFtTG9hZGVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKE1TU3RyZWFtTG9hZGVyLnByb3RvdHlwZSksICdkZXN0cm95JywgdGhpcykuY2FsbCh0aGlzKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb3BlbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuKGRhdGFTb3VyY2UsIHJhbmdlKSB7XG4gICAgICAgICAgICB0aGlzLl9pbnRlcm5hbE9wZW4oZGF0YVNvdXJjZSwgcmFuZ2UsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2ludGVybmFsT3BlbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfaW50ZXJuYWxPcGVuKGRhdGFTb3VyY2UsIHJhbmdlLCBpc1N1YnJhbmdlKSB7XG4gICAgICAgICAgICB0aGlzLl9kYXRhU291cmNlID0gZGF0YVNvdXJjZTtcblxuICAgICAgICAgICAgaWYgKCFpc1N1YnJhbmdlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdG90YWxSYW5nZSA9IHJhbmdlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50UmFuZ2UgPSByYW5nZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHNvdXJjZVVSTCA9IGRhdGFTb3VyY2UudXJsO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbmZpZy5yZXVzZVJlZGlyZWN0ZWRVUkwpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fY3VycmVudFJlZGlyZWN0ZWRVUkwgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZVVSTCA9IHRoaXMuX2N1cnJlbnRSZWRpcmVjdGVkVVJMO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YVNvdXJjZS5yZWRpcmVjdGVkVVJMICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VVUkwgPSBkYXRhU291cmNlLnJlZGlyZWN0ZWRVUkw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc2Vla0NvbmZpZyA9IHRoaXMuX3NlZWtIYW5kbGVyLmdldENvbmZpZyhzb3VyY2VVUkwsIHJhbmdlKTtcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRSZXF1ZXN0VVJMID0gc2Vla0NvbmZpZy51cmw7XG5cbiAgICAgICAgICAgIHZhciByZWFkZXIgPSB0aGlzLl9yZWFkZXIgPSBuZXcgc2VsZi5NU1N0cmVhbVJlYWRlcigpO1xuICAgICAgICAgICAgcmVhZGVyLm9ucHJvZ3Jlc3MgPSB0aGlzLl9tc3JPblByb2dyZXNzLmJpbmQodGhpcyk7XG4gICAgICAgICAgICByZWFkZXIub25sb2FkID0gdGhpcy5fbXNyT25Mb2FkLmJpbmQodGhpcyk7XG4gICAgICAgICAgICByZWFkZXIub25lcnJvciA9IHRoaXMuX21zck9uRXJyb3IuYmluZCh0aGlzKTtcblxuICAgICAgICAgICAgdmFyIHhociA9IHRoaXMuX3hociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICAgICAgeGhyLm9wZW4oJ0dFVCcsIHNlZWtDb25maWcudXJsLCB0cnVlKTtcbiAgICAgICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnbXMtc3RyZWFtJztcbiAgICAgICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSB0aGlzLl94aHJPblJlYWR5U3RhdGVDaGFuZ2UuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHhoci5vbmVycm9yID0gdGhpcy5feGhyT25FcnJvci5iaW5kKHRoaXMpO1xuXG4gICAgICAgICAgICBpZiAoZGF0YVNvdXJjZS53aXRoQ3JlZGVudGlhbHMpIHtcbiAgICAgICAgICAgICAgICB4aHIud2l0aENyZWRlbnRpYWxzID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKF90eXBlb2Yoc2Vla0NvbmZpZy5oZWFkZXJzKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICB2YXIgaGVhZGVycyA9IHNlZWtDb25maWcuaGVhZGVycztcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBoZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChoZWFkZXJzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKGtleSwgaGVhZGVyc1trZXldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYWRkIGFkZGl0aW9uYWwgaGVhZGVyc1xuICAgICAgICAgICAgaWYgKF90eXBlb2YodGhpcy5fY29uZmlnLmhlYWRlcnMpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIHZhciBfaGVhZGVycyA9IHRoaXMuX2NvbmZpZy5oZWFkZXJzO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2tleSBpbiBfaGVhZGVycykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX2hlYWRlcnMuaGFzT3duUHJvcGVydHkoX2tleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKF9rZXksIF9oZWFkZXJzW19rZXldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzUmVjb25uZWN0aW5nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faXNSZWNvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Nvbm5lY3Rpbmc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB4aHIuc2VuZCgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhYm9ydCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhYm9ydCgpIHtcbiAgICAgICAgICAgIHRoaXMuX2ludGVybmFsQWJvcnQoKTtcbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb21wbGV0ZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2ludGVybmFsQWJvcnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2ludGVybmFsQWJvcnQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fcmVhZGVyKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3JlYWRlci5yZWFkeVN0YXRlID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIExPQURJTkdcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVhZGVyLmFib3J0KCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX3JlYWRlci5vbnByb2dyZXNzID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWFkZXIub25sb2FkID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWFkZXIub25lcnJvciA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVhZGVyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl94aHIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIuYWJvcnQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfeGhyT25SZWFkeVN0YXRlQ2hhbmdlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF94aHJPblJlYWR5U3RhdGVDaGFuZ2UoZSkge1xuICAgICAgICAgICAgdmFyIHhociA9IGUudGFyZ2V0O1xuXG4gICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDIpIHtcbiAgICAgICAgICAgICAgICAvLyBIRUFERVJTX1JFQ0VJVkVEXG4gICAgICAgICAgICAgICAgaWYgKHhoci5zdGF0dXMgPj0gMjAwICYmIHhoci5zdGF0dXMgPD0gMjk5KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtCdWZmZXJpbmc7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZVVSTCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWRpcmVjdGVkVVJMID0gdGhpcy5fc2Vla0hhbmRsZXIucmVtb3ZlVVJMUGFyYW1ldGVycyh4aHIucmVzcG9uc2VVUkwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZVVSTCAhPT0gdGhpcy5fY3VycmVudFJlcXVlc3RVUkwgJiYgcmVkaXJlY3RlZFVSTCAhPT0gdGhpcy5fY3VycmVudFJlZGlyZWN0ZWRVUkwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50UmVkaXJlY3RlZFVSTCA9IHJlZGlyZWN0ZWRVUkw7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uVVJMUmVkaXJlY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25VUkxSZWRpcmVjdChyZWRpcmVjdGVkVVJMKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB2YXIgbGVuZ3RoSGVhZGVyID0geGhyLmdldFJlc3BvbnNlSGVhZGVyKCdDb250ZW50LUxlbmd0aCcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAobGVuZ3RoSGVhZGVyICE9IG51bGwgJiYgdGhpcy5fY29udGVudExlbmd0aCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGVuZ3RoID0gcGFyc2VJbnQobGVuZ3RoSGVhZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29udGVudExlbmd0aCA9IGxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25Db250ZW50TGVuZ3RoS25vd24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25Db250ZW50TGVuZ3RoS25vd24odGhpcy5fY29udGVudExlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcihfbG9hZGVyLkxvYWRlckVycm9ycy5IVFRQX1NUQVRVU19DT0RFX0lOVkFMSUQsIHsgY29kZTogeGhyLnN0YXR1cywgbXNnOiB4aHIuc3RhdHVzVGV4dCB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLlJ1bnRpbWVFeGNlcHRpb24oJ01TU3RyZWFtTG9hZGVyOiBIdHRwIGNvZGUgaW52YWxpZCwgJyArIHhoci5zdGF0dXMgKyAnICcgKyB4aHIuc3RhdHVzVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHhoci5yZWFkeVN0YXRlID09PSAzKSB7XG4gICAgICAgICAgICAgICAgLy8gTE9BRElOR1xuICAgICAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzID49IDIwMCAmJiB4aHIuc3RhdHVzIDw9IDI5OSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQnVmZmVyaW5nO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBtc3N0cmVhbSA9IHhoci5yZXNwb25zZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVhZGVyLnJlYWRBc0FycmF5QnVmZmVyKG1zc3RyZWFtKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ194aHJPbkVycm9yJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF94aHJPbkVycm9yKGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcjtcbiAgICAgICAgICAgIHZhciB0eXBlID0gX2xvYWRlci5Mb2FkZXJFcnJvcnMuRVhDRVBUSU9OO1xuICAgICAgICAgICAgdmFyIGluZm8gPSB7IGNvZGU6IC0xLCBtc2c6IGUuY29uc3RydWN0b3IubmFtZSArICcgJyArIGUudHlwZSB9O1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fb25FcnJvcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IodHlwZSwgaW5mbyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLlJ1bnRpbWVFeGNlcHRpb24oaW5mby5tc2cpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfbXNyT25Qcm9ncmVzcycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfbXNyT25Qcm9ncmVzcyhlKSB7XG4gICAgICAgICAgICB2YXIgcmVhZGVyID0gZS50YXJnZXQ7XG4gICAgICAgICAgICB2YXIgYmlnYnVmZmVyID0gcmVhZGVyLnJlc3VsdDtcbiAgICAgICAgICAgIGlmIChiaWdidWZmZXIgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIC8vIHJlc3VsdCBtYXkgYmUgbnVsbCwgd29ya2Fyb3VuZCBmb3IgYnVnZ3kgTSRcbiAgICAgICAgICAgICAgICB0aGlzLl9kb1JlY29ubmVjdElmTmVlZGVkKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc2xpY2UgPSBiaWdidWZmZXIuc2xpY2UodGhpcy5fbGFzdFRpbWVCdWZmZXJTaXplKTtcbiAgICAgICAgICAgIHRoaXMuX2xhc3RUaW1lQnVmZmVyU2l6ZSA9IGJpZ2J1ZmZlci5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGJ5dGVTdGFydCA9IHRoaXMuX3RvdGFsUmFuZ2UuZnJvbSArIHRoaXMuX3JlY2VpdmVkTGVuZ3RoO1xuICAgICAgICAgICAgdGhpcy5fcmVjZWl2ZWRMZW5ndGggKz0gc2xpY2UuYnl0ZUxlbmd0aDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX29uRGF0YUFycml2YWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkRhdGFBcnJpdmFsKHNsaWNlLCBieXRlU3RhcnQsIHRoaXMuX3JlY2VpdmVkTGVuZ3RoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGJpZ2J1ZmZlci5ieXRlTGVuZ3RoID49IHRoaXMuX2J1ZmZlckxpbWl0KSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KHRoaXMuVEFHLCAnTVNTdHJlYW0gYnVmZmVyIGV4Y2VlZGVkIG1heCBzaXplIG5lYXIgJyArIChieXRlU3RhcnQgKyBzbGljZS5ieXRlTGVuZ3RoKSArICcsIHJlY29ubmVjdGluZy4uLicpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2RvUmVjb25uZWN0SWZOZWVkZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2RvUmVjb25uZWN0SWZOZWVkZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2RvUmVjb25uZWN0SWZOZWVkZWQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29udGVudExlbmd0aCA9PSBudWxsIHx8IHRoaXMuX3JlY2VpdmVkTGVuZ3RoIDwgdGhpcy5fY29udGVudExlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2lzUmVjb25uZWN0aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9sYXN0VGltZUJ1ZmZlclNpemUgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuX2ludGVybmFsQWJvcnQoKTtcblxuICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgZnJvbTogdGhpcy5fdG90YWxSYW5nZS5mcm9tICsgdGhpcy5fcmVjZWl2ZWRMZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgIHRvOiAtMVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5faW50ZXJuYWxPcGVuKHRoaXMuX2RhdGFTb3VyY2UsIHJhbmdlLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX21zck9uTG9hZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfbXNyT25Mb2FkKGUpIHtcbiAgICAgICAgICAgIC8vIGFjdHVhbGx5IGl0IGlzIG9uQ29tcGxldGUgZXZlbnRcbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb21wbGV0ZTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9vbkNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25Db21wbGV0ZSh0aGlzLl90b3RhbFJhbmdlLmZyb20sIHRoaXMuX3RvdGFsUmFuZ2UuZnJvbSArIHRoaXMuX3JlY2VpdmVkTGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19tc3JPbkVycm9yJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9tc3JPbkVycm9yKGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcjtcbiAgICAgICAgICAgIHZhciB0eXBlID0gMDtcbiAgICAgICAgICAgIHZhciBpbmZvID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbnRlbnRMZW5ndGggJiYgdGhpcy5fcmVjZWl2ZWRMZW5ndGggPCB0aGlzLl9jb250ZW50TGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdHlwZSA9IF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVBUkxZX0VPRjtcbiAgICAgICAgICAgICAgICBpbmZvID0geyBjb2RlOiAtMSwgbXNnOiAnTVNTdHJlYW0gbWVldCBFYXJseS1Fb2YnIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHR5cGUgPSBfbG9hZGVyLkxvYWRlckVycm9ycy5FQVJMWV9FT0Y7XG4gICAgICAgICAgICAgICAgaW5mbyA9IHsgY29kZTogLTEsIG1zZzogZS5jb25zdHJ1Y3Rvci5uYW1lICsgJyAnICsgZS50eXBlIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcih0eXBlLCBpbmZvKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uUnVudGltZUV4Y2VwdGlvbihpbmZvLm1zZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gTVNTdHJlYW1Mb2FkZXI7XG59KF9sb2FkZXIuQmFzZUxvYWRlcik7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IE1TU3RyZWFtTG9hZGVyO1xuXG59LHtcIi4uL3V0aWxzL2V4Y2VwdGlvbi5qc1wiOjQwLFwiLi4vdXRpbHMvbG9nZ2VyLmpzXCI6NDEsXCIuL2xvYWRlci5qc1wiOjI0fV0sMzE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9O1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2xvZ2dlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZ2dlci5qcycpO1xuXG52YXIgX2xvZ2dlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnZXIpO1xuXG52YXIgX3NwZWVkU2FtcGxlciA9IF9kZXJlcV8oJy4vc3BlZWQtc2FtcGxlci5qcycpO1xuXG52YXIgX3NwZWVkU2FtcGxlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zcGVlZFNhbXBsZXIpO1xuXG52YXIgX2xvYWRlciA9IF9kZXJlcV8oJy4vbG9hZGVyLmpzJyk7XG5cbnZhciBfZXhjZXB0aW9uID0gX2RlcmVxXygnLi4vdXRpbHMvZXhjZXB0aW9uLmpzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0gLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuLy8gVW5pdmVyc2FsIElPIExvYWRlciwgaW1wbGVtZW50ZWQgYnkgYWRkaW5nIFJhbmdlIGhlYWRlciBpbiB4aHIncyByZXF1ZXN0IGhlYWRlclxudmFyIFJhbmdlTG9hZGVyID0gZnVuY3Rpb24gKF9CYXNlTG9hZGVyKSB7XG4gICAgX2luaGVyaXRzKFJhbmdlTG9hZGVyLCBfQmFzZUxvYWRlcik7XG5cbiAgICBfY3JlYXRlQ2xhc3MoUmFuZ2VMb2FkZXIsIG51bGwsIFt7XG4gICAgICAgIGtleTogJ2lzU3VwcG9ydGVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzU3VwcG9ydGVkKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgICAgICAgICAgeGhyLm9wZW4oJ0dFVCcsICdodHRwczovL2V4YW1wbGUuY29tJywgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdhcnJheWJ1ZmZlcic7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHhoci5yZXNwb25zZVR5cGUgPT09ICdhcnJheWJ1ZmZlcic7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KCdSYW5nZUxvYWRlcicsIGUubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgZnVuY3Rpb24gUmFuZ2VMb2FkZXIoc2Vla0hhbmRsZXIsIGNvbmZpZykge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUmFuZ2VMb2FkZXIpO1xuXG4gICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChSYW5nZUxvYWRlci5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFJhbmdlTG9hZGVyKSkuY2FsbCh0aGlzLCAneGhyLXJhbmdlLWxvYWRlcicpKTtcblxuICAgICAgICBfdGhpcy5UQUcgPSAnUmFuZ2VMb2FkZXInO1xuXG4gICAgICAgIF90aGlzLl9zZWVrSGFuZGxlciA9IHNlZWtIYW5kbGVyO1xuICAgICAgICBfdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgICAgICBfdGhpcy5fbmVlZFN0YXNoID0gZmFsc2U7XG5cbiAgICAgICAgX3RoaXMuX2NodW5rU2l6ZUtCTGlzdCA9IFsxMjgsIDI1NiwgMzg0LCA1MTIsIDc2OCwgMTAyNCwgMTUzNiwgMjA0OCwgMzA3MiwgNDA5NiwgNTEyMCwgNjE0NCwgNzE2OCwgODE5Ml07XG4gICAgICAgIF90aGlzLl9jdXJyZW50Q2h1bmtTaXplS0IgPSAzODQ7XG4gICAgICAgIF90aGlzLl9jdXJyZW50U3BlZWROb3JtYWxpemVkID0gMDtcbiAgICAgICAgX3RoaXMuX3plcm9TcGVlZENodW5rQ291bnQgPSAwO1xuXG4gICAgICAgIF90aGlzLl94aHIgPSBudWxsO1xuICAgICAgICBfdGhpcy5fc3BlZWRTYW1wbGVyID0gbmV3IF9zcGVlZFNhbXBsZXIyLmRlZmF1bHQoKTtcblxuICAgICAgICBfdGhpcy5fcmVxdWVzdEFib3J0ID0gZmFsc2U7XG4gICAgICAgIF90aGlzLl93YWl0Rm9yVG90YWxMZW5ndGggPSBmYWxzZTtcbiAgICAgICAgX3RoaXMuX3RvdGFsTGVuZ3RoUmVjZWl2ZWQgPSBmYWxzZTtcblxuICAgICAgICBfdGhpcy5fY3VycmVudFJlcXVlc3RVUkwgPSBudWxsO1xuICAgICAgICBfdGhpcy5fY3VycmVudFJlZGlyZWN0ZWRVUkwgPSBudWxsO1xuICAgICAgICBfdGhpcy5fY3VycmVudFJlcXVlc3RSYW5nZSA9IG51bGw7XG4gICAgICAgIF90aGlzLl90b3RhbExlbmd0aCA9IG51bGw7IC8vIHNpemUgb2YgdGhlIGVudGlyZSBmaWxlXG4gICAgICAgIF90aGlzLl9jb250ZW50TGVuZ3RoID0gbnVsbDsgLy8gQ29udGVudC1MZW5ndGggb2YgZW50aXJlIHJlcXVlc3QgcmFuZ2VcbiAgICAgICAgX3RoaXMuX3JlY2VpdmVkTGVuZ3RoID0gMDsgLy8gdG90YWwgcmVjZWl2ZWQgYnl0ZXNcbiAgICAgICAgX3RoaXMuX2xhc3RUaW1lTG9hZGVkID0gMDsgLy8gcmVjZWl2ZWQgYnl0ZXMgb2YgY3VycmVudCByZXF1ZXN0IHN1Yi1yYW5nZVxuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFJhbmdlTG9hZGVyLCBbe1xuICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1dvcmtpbmcoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl94aHIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIub25wcm9ncmVzcyA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLm9ubG9hZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLm9uZXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3hociA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfZ2V0KFJhbmdlTG9hZGVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFJhbmdlTG9hZGVyLnByb3RvdHlwZSksICdkZXN0cm95JywgdGhpcykuY2FsbCh0aGlzKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb3BlbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuKGRhdGFTb3VyY2UsIHJhbmdlKSB7XG4gICAgICAgICAgICB0aGlzLl9kYXRhU291cmNlID0gZGF0YVNvdXJjZTtcbiAgICAgICAgICAgIHRoaXMuX3JhbmdlID0gcmFuZ2U7XG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29ubmVjdGluZztcblxuICAgICAgICAgICAgdmFyIHVzZVJlZlRvdGFsTGVuZ3RoID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAodGhpcy5fZGF0YVNvdXJjZS5maWxlc2l6ZSAhPSB1bmRlZmluZWQgJiYgdGhpcy5fZGF0YVNvdXJjZS5maWxlc2l6ZSAhPT0gMCkge1xuICAgICAgICAgICAgICAgIHVzZVJlZlRvdGFsTGVuZ3RoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLl90b3RhbExlbmd0aCA9IHRoaXMuX2RhdGFTb3VyY2UuZmlsZXNpemU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5fdG90YWxMZW5ndGhSZWNlaXZlZCAmJiAhdXNlUmVmVG90YWxMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvdGFsIGZpbGVzaXplXG4gICAgICAgICAgICAgICAgdGhpcy5fd2FpdEZvclRvdGFsTGVuZ3RoID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnRlcm5hbE9wZW4odGhpcy5fZGF0YVNvdXJjZSwgeyBmcm9tOiAwLCB0bzogLTEgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFdlIGhhdmUgZmlsZXNpemUsIHN0YXJ0IGxvYWRpbmdcbiAgICAgICAgICAgICAgICB0aGlzLl9vcGVuU3ViUmFuZ2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29wZW5TdWJSYW5nZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb3BlblN1YlJhbmdlKCkge1xuICAgICAgICAgICAgdmFyIGNodW5rU2l6ZSA9IHRoaXMuX2N1cnJlbnRDaHVua1NpemVLQiAqIDEwMjQ7XG5cbiAgICAgICAgICAgIHZhciBmcm9tID0gdGhpcy5fcmFuZ2UuZnJvbSArIHRoaXMuX3JlY2VpdmVkTGVuZ3RoO1xuICAgICAgICAgICAgdmFyIHRvID0gZnJvbSArIGNodW5rU2l6ZTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbnRlbnRMZW5ndGggIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIGlmICh0byAtIHRoaXMuX3JhbmdlLmZyb20gPj0gdGhpcy5fY29udGVudExlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB0byA9IHRoaXMuX3JhbmdlLmZyb20gKyB0aGlzLl9jb250ZW50TGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRSZXF1ZXN0UmFuZ2UgPSB7IGZyb206IGZyb20sIHRvOiB0byB9O1xuICAgICAgICAgICAgdGhpcy5faW50ZXJuYWxPcGVuKHRoaXMuX2RhdGFTb3VyY2UsIHRoaXMuX2N1cnJlbnRSZXF1ZXN0UmFuZ2UpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfaW50ZXJuYWxPcGVuJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9pbnRlcm5hbE9wZW4oZGF0YVNvdXJjZSwgcmFuZ2UpIHtcbiAgICAgICAgICAgIHRoaXMuX2xhc3RUaW1lTG9hZGVkID0gMDtcblxuICAgICAgICAgICAgdmFyIHNvdXJjZVVSTCA9IGRhdGFTb3VyY2UudXJsO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbmZpZy5yZXVzZVJlZGlyZWN0ZWRVUkwpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fY3VycmVudFJlZGlyZWN0ZWRVUkwgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZVVSTCA9IHRoaXMuX2N1cnJlbnRSZWRpcmVjdGVkVVJMO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZGF0YVNvdXJjZS5yZWRpcmVjdGVkVVJMICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VVUkwgPSBkYXRhU291cmNlLnJlZGlyZWN0ZWRVUkw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc2Vla0NvbmZpZyA9IHRoaXMuX3NlZWtIYW5kbGVyLmdldENvbmZpZyhzb3VyY2VVUkwsIHJhbmdlKTtcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRSZXF1ZXN0VVJMID0gc2Vla0NvbmZpZy51cmw7XG5cbiAgICAgICAgICAgIHZhciB4aHIgPSB0aGlzLl94aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgIHhoci5vcGVuKCdHRVQnLCBzZWVrQ29uZmlnLnVybCwgdHJ1ZSk7XG4gICAgICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2FycmF5YnVmZmVyJztcbiAgICAgICAgICAgIHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSB0aGlzLl9vblJlYWR5U3RhdGVDaGFuZ2UuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHhoci5vbnByb2dyZXNzID0gdGhpcy5fb25Qcm9ncmVzcy5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgeGhyLm9ubG9hZCA9IHRoaXMuX29uTG9hZC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgeGhyLm9uZXJyb3IgPSB0aGlzLl9vblhockVycm9yLmJpbmQodGhpcyk7XG5cbiAgICAgICAgICAgIGlmIChkYXRhU291cmNlLndpdGhDcmVkZW50aWFscykge1xuICAgICAgICAgICAgICAgIHhoci53aXRoQ3JlZGVudGlhbHMgPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoX3R5cGVvZihzZWVrQ29uZmlnLmhlYWRlcnMpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIHZhciBoZWFkZXJzID0gc2Vla0NvbmZpZy5oZWFkZXJzO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGhlYWRlcnMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoa2V5LCBoZWFkZXJzW2tleV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBhZGQgYWRkaXRpb25hbCBoZWFkZXJzXG4gICAgICAgICAgICBpZiAoX3R5cGVvZih0aGlzLl9jb25maWcuaGVhZGVycykgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9oZWFkZXJzID0gdGhpcy5fY29uZmlnLmhlYWRlcnM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfa2V5IGluIF9oZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfaGVhZGVycy5oYXNPd25Qcm9wZXJ0eShfa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoX2tleSwgX2hlYWRlcnNbX2tleV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB4aHIuc2VuZCgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhYm9ydCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhYm9ydCgpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RBYm9ydCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl9pbnRlcm5hbEFib3J0KCk7XG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29tcGxldGU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19pbnRlcm5hbEFib3J0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9pbnRlcm5hbEFib3J0KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3hocikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5vbnByb2dyZXNzID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIub25sb2FkID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIub25lcnJvciA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLmFib3J0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uUmVhZHlTdGF0ZUNoYW5nZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25SZWFkeVN0YXRlQ2hhbmdlKGUpIHtcbiAgICAgICAgICAgIHZhciB4aHIgPSBlLnRhcmdldDtcblxuICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSAyKSB7XG4gICAgICAgICAgICAgICAgLy8gSEVBREVSU19SRUNFSVZFRFxuICAgICAgICAgICAgICAgIGlmICh4aHIucmVzcG9uc2VVUkwgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlmIHRoZSBicm93c2VyIHN1cHBvcnQgdGhpcyBwcm9wZXJ0eVxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVkaXJlY3RlZFVSTCA9IHRoaXMuX3NlZWtIYW5kbGVyLnJlbW92ZVVSTFBhcmFtZXRlcnMoeGhyLnJlc3BvbnNlVVJMKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZVVSTCAhPT0gdGhpcy5fY3VycmVudFJlcXVlc3RVUkwgJiYgcmVkaXJlY3RlZFVSTCAhPT0gdGhpcy5fY3VycmVudFJlZGlyZWN0ZWRVUkwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRSZWRpcmVjdGVkVVJMID0gcmVkaXJlY3RlZFVSTDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vblVSTFJlZGlyZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25VUkxSZWRpcmVjdChyZWRpcmVjdGVkVVJMKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzID49IDIwMCAmJiB4aHIuc3RhdHVzIDw9IDI5OSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fd2FpdEZvclRvdGFsTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0J1ZmZlcmluZztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKF9sb2FkZXIuTG9hZGVyRXJyb3JzLkhUVFBfU1RBVFVTX0NPREVfSU5WQUxJRCwgeyBjb2RlOiB4aHIuc3RhdHVzLCBtc2c6IHhoci5zdGF0dXNUZXh0IH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uUnVudGltZUV4Y2VwdGlvbignUmFuZ2VMb2FkZXI6IEh0dHAgY29kZSBpbnZhbGlkLCAnICsgeGhyLnN0YXR1cyArICcgJyArIHhoci5zdGF0dXNUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uUHJvZ3Jlc3MnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uUHJvZ3Jlc3MoZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXR1cyA9PT0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgLy8gSWdub3JlIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5fY29udGVudExlbmd0aCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHZhciBvcGVuTmV4dFJhbmdlID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fd2FpdEZvclRvdGFsTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3dhaXRGb3JUb3RhbExlbmd0aCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90b3RhbExlbmd0aFJlY2VpdmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgb3Blbk5leHRSYW5nZSA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHRvdGFsID0gZS50b3RhbDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faW50ZXJuYWxBYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodG90YWwgIT0gbnVsbCAmIHRvdGFsICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90b3RhbExlbmd0aCA9IHRvdGFsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gY2FsY3VsYXRlIGN1cnJyZW50IHJlcXVlc3QgcmFuZ2UncyBjb250ZW50TGVuZ3RoXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3JhbmdlLnRvID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb250ZW50TGVuZ3RoID0gdGhpcy5fdG90YWxMZW5ndGggLSB0aGlzLl9yYW5nZS5mcm9tO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRvICE9PSAtMVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jb250ZW50TGVuZ3RoID0gdGhpcy5fcmFuZ2UudG8gLSB0aGlzLl9yYW5nZS5mcm9tICsgMTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAob3Blbk5leHRSYW5nZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vcGVuU3ViUmFuZ2UoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25Db250ZW50TGVuZ3RoS25vd24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25Db250ZW50TGVuZ3RoS25vd24odGhpcy5fY29udGVudExlbmd0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgZGVsdGEgPSBlLmxvYWRlZCAtIHRoaXMuX2xhc3RUaW1lTG9hZGVkO1xuICAgICAgICAgICAgdGhpcy5fbGFzdFRpbWVMb2FkZWQgPSBlLmxvYWRlZDtcbiAgICAgICAgICAgIHRoaXMuX3NwZWVkU2FtcGxlci5hZGRCeXRlcyhkZWx0YSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19ub3JtYWxpemVTcGVlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfbm9ybWFsaXplU3BlZWQoaW5wdXQpIHtcbiAgICAgICAgICAgIHZhciBsaXN0ID0gdGhpcy5fY2h1bmtTaXplS0JMaXN0O1xuICAgICAgICAgICAgdmFyIGxhc3QgPSBsaXN0Lmxlbmd0aCAtIDE7XG4gICAgICAgICAgICB2YXIgbWlkID0gMDtcbiAgICAgICAgICAgIHZhciBsYm91bmQgPSAwO1xuICAgICAgICAgICAgdmFyIHVib3VuZCA9IGxhc3Q7XG5cbiAgICAgICAgICAgIGlmIChpbnB1dCA8IGxpc3RbMF0pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbGlzdFswXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgd2hpbGUgKGxib3VuZCA8PSB1Ym91bmQpIHtcbiAgICAgICAgICAgICAgICBtaWQgPSBsYm91bmQgKyBNYXRoLmZsb29yKCh1Ym91bmQgLSBsYm91bmQpIC8gMik7XG4gICAgICAgICAgICAgICAgaWYgKG1pZCA9PT0gbGFzdCB8fCBpbnB1dCA+PSBsaXN0W21pZF0gJiYgaW5wdXQgPCBsaXN0W21pZCArIDFdKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBsaXN0W21pZF07XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaXN0W21pZF0gPCBpbnB1dCkge1xuICAgICAgICAgICAgICAgICAgICBsYm91bmQgPSBtaWQgKyAxO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHVib3VuZCA9IG1pZCAtIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Mb2FkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkxvYWQoZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXR1cyA9PT0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yKSB7XG4gICAgICAgICAgICAgICAgLy8gSWdub3JlIGVycm9yIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5fd2FpdEZvclRvdGFsTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fd2FpdEZvclRvdGFsTGVuZ3RoID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9sYXN0VGltZUxvYWRlZCA9IDA7XG4gICAgICAgICAgICB2YXIgS0JwcyA9IHRoaXMuX3NwZWVkU2FtcGxlci5sYXN0U2Vjb25kS0JwcztcbiAgICAgICAgICAgIGlmIChLQnBzID09PSAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5femVyb1NwZWVkQ2h1bmtDb3VudCsrO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl96ZXJvU3BlZWRDaHVua0NvdW50ID49IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVHJ5IGdldCBjdXJyZW50S0JwcyBhZnRlciAzIGNodW5rc1xuICAgICAgICAgICAgICAgICAgICBLQnBzID0gdGhpcy5fc3BlZWRTYW1wbGVyLmN1cnJlbnRLQnBzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKEtCcHMgIT09IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgbm9ybWFsaXplZCA9IHRoaXMuX25vcm1hbGl6ZVNwZWVkKEtCcHMpO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9jdXJyZW50U3BlZWROb3JtYWxpemVkICE9PSBub3JtYWxpemVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRTcGVlZE5vcm1hbGl6ZWQgPSBub3JtYWxpemVkO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50Q2h1bmtTaXplS0IgPSBub3JtYWxpemVkO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGNodW5rID0gZS50YXJnZXQucmVzcG9uc2U7XG4gICAgICAgICAgICB2YXIgYnl0ZVN0YXJ0ID0gdGhpcy5fcmFuZ2UuZnJvbSArIHRoaXMuX3JlY2VpdmVkTGVuZ3RoO1xuICAgICAgICAgICAgdGhpcy5fcmVjZWl2ZWRMZW5ndGggKz0gY2h1bmsuYnl0ZUxlbmd0aDtcblxuICAgICAgICAgICAgdmFyIHJlcG9ydENvbXBsZXRlID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9jb250ZW50TGVuZ3RoICE9IG51bGwgJiYgdGhpcy5fcmVjZWl2ZWRMZW5ndGggPCB0aGlzLl9jb250ZW50TGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgLy8gY29udGludWUgbG9hZCBuZXh0IGNodW5rXG4gICAgICAgICAgICAgICAgdGhpcy5fb3BlblN1YlJhbmdlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlcG9ydENvbXBsZXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gZGlzcGF0Y2ggcmVjZWl2ZWQgY2h1bmtcbiAgICAgICAgICAgIGlmICh0aGlzLl9vbkRhdGFBcnJpdmFsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25EYXRhQXJyaXZhbChjaHVuaywgYnl0ZVN0YXJ0LCB0aGlzLl9yZWNlaXZlZExlbmd0aCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChyZXBvcnRDb21wbGV0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb21wbGV0ZTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25Db21wbGV0ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkNvbXBsZXRlKHRoaXMuX3JhbmdlLmZyb20sIHRoaXMuX3JhbmdlLmZyb20gKyB0aGlzLl9yZWNlaXZlZExlbmd0aCAtIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uWGhyRXJyb3InLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uWGhyRXJyb3IoZSkge1xuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yO1xuICAgICAgICAgICAgdmFyIHR5cGUgPSAwO1xuICAgICAgICAgICAgdmFyIGluZm8gPSBudWxsO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fY29udGVudExlbmd0aCAmJiB0aGlzLl9yZWNlaXZlZExlbmd0aCA+IDAgJiYgdGhpcy5fcmVjZWl2ZWRMZW5ndGggPCB0aGlzLl9jb250ZW50TGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdHlwZSA9IF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVBUkxZX0VPRjtcbiAgICAgICAgICAgICAgICBpbmZvID0geyBjb2RlOiAtMSwgbXNnOiAnUmFuZ2VMb2FkZXIgbWVldCBFYXJseS1Fb2YnIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHR5cGUgPSBfbG9hZGVyLkxvYWRlckVycm9ycy5FWENFUFRJT047XG4gICAgICAgICAgICAgICAgaW5mbyA9IHsgY29kZTogLTEsIG1zZzogZS5jb25zdHJ1Y3Rvci5uYW1lICsgJyAnICsgZS50eXBlIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcih0eXBlLCBpbmZvKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uUnVudGltZUV4Y2VwdGlvbihpbmZvLm1zZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2N1cnJlbnRTcGVlZCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3NwZWVkU2FtcGxlci5sYXN0U2Vjb25kS0JwcztcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBSYW5nZUxvYWRlcjtcbn0oX2xvYWRlci5CYXNlTG9hZGVyKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gUmFuZ2VMb2FkZXI7XG5cbn0se1wiLi4vdXRpbHMvZXhjZXB0aW9uLmpzXCI6NDAsXCIuLi91dGlscy9sb2dnZXIuanNcIjo0MSxcIi4vbG9hZGVyLmpzXCI6MjQsXCIuL3NwZWVkLXNhbXBsZXIuanNcIjoyN31dLDMyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgX2V2ZW50cyA9IF9kZXJlcV8oJ2V2ZW50cycpO1xuXG52YXIgX2V2ZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ldmVudHMpO1xuXG52YXIgX2xvZ2dlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZ2dlci5qcycpO1xuXG52YXIgX2xvZ2dlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnZXIpO1xuXG52YXIgX2Jyb3dzZXIgPSBfZGVyZXFfKCcuLi91dGlscy9icm93c2VyLmpzJyk7XG5cbnZhciBfYnJvd3NlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9icm93c2VyKTtcblxudmFyIF9wbGF5ZXJFdmVudHMgPSBfZGVyZXFfKCcuL3BsYXllci1ldmVudHMuanMnKTtcblxudmFyIF9wbGF5ZXJFdmVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcGxheWVyRXZlbnRzKTtcblxudmFyIF90cmFuc211eGVyID0gX2RlcmVxXygnLi4vY29yZS90cmFuc211eGVyLmpzJyk7XG5cbnZhciBfdHJhbnNtdXhlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90cmFuc211eGVyKTtcblxudmFyIF90cmFuc211eGluZ0V2ZW50cyA9IF9kZXJlcV8oJy4uL2NvcmUvdHJhbnNtdXhpbmctZXZlbnRzLmpzJyk7XG5cbnZhciBfdHJhbnNtdXhpbmdFdmVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHJhbnNtdXhpbmdFdmVudHMpO1xuXG52YXIgX21zZUNvbnRyb2xsZXIgPSBfZGVyZXFfKCcuLi9jb3JlL21zZS1jb250cm9sbGVyLmpzJyk7XG5cbnZhciBfbXNlQ29udHJvbGxlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tc2VDb250cm9sbGVyKTtcblxudmFyIF9tc2VFdmVudHMgPSBfZGVyZXFfKCcuLi9jb3JlL21zZS1ldmVudHMuanMnKTtcblxudmFyIF9tc2VFdmVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbXNlRXZlbnRzKTtcblxudmFyIF9wbGF5ZXJFcnJvcnMgPSBfZGVyZXFfKCcuL3BsYXllci1lcnJvcnMuanMnKTtcblxudmFyIF9jb25maWcgPSBfZGVyZXFfKCcuLi9jb25maWcuanMnKTtcblxudmFyIF9leGNlcHRpb24gPSBfZGVyZXFfKCcuLi91dGlscy9leGNlcHRpb24uanMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIEZsdlBsYXllciA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBGbHZQbGF5ZXIobWVkaWFEYXRhU291cmNlLCBjb25maWcpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZsdlBsYXllcik7XG5cbiAgICAgICAgdGhpcy5UQUcgPSAnRmx2UGxheWVyJztcbiAgICAgICAgdGhpcy5fdHlwZSA9ICdGbHZQbGF5ZXInO1xuICAgICAgICB0aGlzLl9lbWl0dGVyID0gbmV3IF9ldmVudHMyLmRlZmF1bHQoKTtcblxuICAgICAgICB0aGlzLl9jb25maWcgPSAoMCwgX2NvbmZpZy5jcmVhdGVEZWZhdWx0Q29uZmlnKSgpO1xuICAgICAgICBpZiAoKHR5cGVvZiBjb25maWcgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKGNvbmZpZykpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLl9jb25maWcsIGNvbmZpZyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobWVkaWFEYXRhU291cmNlLnR5cGUudG9Mb3dlckNhc2UoKSAhPT0gJ2ZsdicpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLkludmFsaWRBcmd1bWVudEV4Y2VwdGlvbignRmx2UGxheWVyIHJlcXVpcmVzIGFuIGZsdiBNZWRpYURhdGFTb3VyY2UgaW5wdXQhJyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobWVkaWFEYXRhU291cmNlLmlzTGl2ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgdGhpcy5fY29uZmlnLmlzTGl2ZSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmUgPSB7XG4gICAgICAgICAgICBvbnZMb2FkZWRNZXRhZGF0YTogdGhpcy5fb252TG9hZGVkTWV0YWRhdGEuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIG9udlNlZWtpbmc6IHRoaXMuX29udlNlZWtpbmcuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIG9udkNhblBsYXk6IHRoaXMuX29udkNhblBsYXkuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIG9udlN0YWxsZWQ6IHRoaXMuX29udlN0YWxsZWQuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIG9udlByb2dyZXNzOiB0aGlzLl9vbnZQcm9ncmVzcy5iaW5kKHRoaXMpXG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHNlbGYucGVyZm9ybWFuY2UgJiYgc2VsZi5wZXJmb3JtYW5jZS5ub3cpIHtcbiAgICAgICAgICAgIHRoaXMuX25vdyA9IHNlbGYucGVyZm9ybWFuY2Uubm93LmJpbmQoc2VsZi5wZXJmb3JtYW5jZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9ub3cgPSBEYXRlLm5vdztcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX3BlbmRpbmdTZWVrVGltZSA9IG51bGw7IC8vIGluIHNlY29uZHNcbiAgICAgICAgdGhpcy5fcmVxdWVzdFNldFRpbWUgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fc2Vla3BvaW50UmVjb3JkID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcHJvZ3Jlc3NDaGVja2VyID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9tZWRpYURhdGFTb3VyY2UgPSBtZWRpYURhdGFTb3VyY2U7XG4gICAgICAgIHRoaXMuX21lZGlhRWxlbWVudCA9IG51bGw7XG4gICAgICAgIHRoaXMuX21zZWN0bCA9IG51bGw7XG4gICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuX21zZVNvdXJjZU9wZW5lZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9oYXNQZW5kaW5nTG9hZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9yZWNlaXZlZENhblBsYXkgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLl9tZWRpYUluZm8gPSBudWxsO1xuICAgICAgICB0aGlzLl9zdGF0aXN0aWNzSW5mbyA9IG51bGw7XG5cbiAgICAgICAgdmFyIGNocm9tZU5lZWRJRFJGaXggPSBfYnJvd3NlcjIuZGVmYXVsdC5jaHJvbWUgJiYgKF9icm93c2VyMi5kZWZhdWx0LnZlcnNpb24ubWFqb3IgPCA1MCB8fCBfYnJvd3NlcjIuZGVmYXVsdC52ZXJzaW9uLm1ham9yID09PSA1MCAmJiBfYnJvd3NlcjIuZGVmYXVsdC52ZXJzaW9uLmJ1aWxkIDwgMjY2MSk7XG4gICAgICAgIHRoaXMuX2Fsd2F5c1NlZWtLZXlmcmFtZSA9IGNocm9tZU5lZWRJRFJGaXggfHwgX2Jyb3dzZXIyLmRlZmF1bHQubXNlZGdlIHx8IF9icm93c2VyMi5kZWZhdWx0Lm1zaWUgPyB0cnVlIDogZmFsc2U7XG5cbiAgICAgICAgaWYgKHRoaXMuX2Fsd2F5c1NlZWtLZXlmcmFtZSkge1xuICAgICAgICAgICAgdGhpcy5fY29uZmlnLmFjY3VyYXRlU2VlayA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jYWxsYmFja1N0cmVhbVRpbWUgPSBudWxsO1xuICAgICAgICB0aGlzLl9tZWRpYVNvdXJjZUVuZENhbGxiYWNrID0gbnVsbDtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoRmx2UGxheWVyLCBbe1xuICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fcHJvZ3Jlc3NDaGVja2VyICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLl9wcm9ncmVzc0NoZWNrZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2dyZXNzQ2hlY2tlciA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fdHJhbnNtdXhlcikge1xuICAgICAgICAgICAgICAgIHRoaXMudW5sb2FkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZXRhY2hNZWRpYUVsZW1lbnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYURhdGFTb3VyY2UgPSBudWxsO1xuXG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLnJlbW92ZUFsbExpc3RlbmVycygpO1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlciA9IG51bGw7XG5cbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tTdHJlYW1UaW1lID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhU291cmNlRW5kQ2FsbGJhY2sgPSBudWxsO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbihldmVudCwgbGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgICAgIGlmIChldmVudCA9PT0gX3BsYXllckV2ZW50czIuZGVmYXVsdC5NRURJQV9JTkZPKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhSW5mbyAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2VtaXR0ZXIuZW1pdChfcGxheWVyRXZlbnRzMi5kZWZhdWx0Lk1FRElBX0lORk8sIF90aGlzLm1lZGlhSW5mbyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZlbnQgPT09IF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuU1RBVElTVElDU19JTkZPKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXRpc3RpY3NJbmZvICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fZW1pdHRlci5lbWl0KF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuU1RBVElTVElDU19JTkZPLCBfdGhpcy5zdGF0aXN0aWNzSW5mbyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuYWRkTGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb2ZmJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9mZihldmVudCwgbGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIucmVtb3ZlTGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYXR0YWNoTWVkaWFFbGVtZW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGF0dGFjaE1lZGlhRWxlbWVudChtZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQgPSBtZWRpYUVsZW1lbnQ7XG4gICAgICAgICAgICBtZWRpYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbG9hZGVkbWV0YWRhdGEnLCB0aGlzLmUub252TG9hZGVkTWV0YWRhdGEpO1xuICAgICAgICAgICAgLy9tZWRpYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc2Vla2luZycsIHRoaXMuZS5vbnZTZWVraW5nKTtcbiAgICAgICAgICAgIG1lZGlhRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjYW5wbGF5JywgdGhpcy5lLm9udkNhblBsYXkpO1xuICAgICAgICAgICAgbWVkaWFFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N0YWxsZWQnLCB0aGlzLmUub252U3RhbGxlZCk7XG4gICAgICAgICAgICAvL21lZGlhRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIHRoaXMuZS5vbnZQcm9ncmVzcyk7XG5cbiAgICAgICAgICAgIHRoaXMuX21zZWN0bCA9IG5ldyBfbXNlQ29udHJvbGxlcjIuZGVmYXVsdCh0aGlzLl9jb25maWcpO1xuXG4gICAgICAgICAgICB0aGlzLl9tc2VjdGwub24oX21zZUV2ZW50czIuZGVmYXVsdC5VUERBVEVfRU5ELCB0aGlzLl9vbm1zZVVwZGF0ZUVuZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIHRoaXMuX21zZWN0bC5vbihfbXNlRXZlbnRzMi5kZWZhdWx0LkJVRkZFUl9GVUxMLCB0aGlzLl9vbm1zZUJ1ZmZlckZ1bGwuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB0aGlzLl9tc2VjdGwub24oX21zZUV2ZW50czIuZGVmYXVsdC5TT1VSQ0VfT1BFTiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzMi5fbXNlU291cmNlT3BlbmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLl9oYXNQZW5kaW5nTG9hZCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczIuX2hhc1BlbmRpbmdMb2FkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMi5sb2FkKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl9tc2VjdGwub24oX21zZUV2ZW50czIuZGVmYXVsdC5FUlJPUiwgZnVuY3Rpb24gKGluZm8pIHtcbiAgICAgICAgICAgICAgICBfdGhpczIuX2VtaXR0ZXIuZW1pdChfcGxheWVyRXZlbnRzMi5kZWZhdWx0LkVSUk9SLCBfcGxheWVyRXJyb3JzLkVycm9yVHlwZXMuTUVESUFfRVJST1IsIF9wbGF5ZXJFcnJvcnMuRXJyb3JEZXRhaWxzLk1FRElBX01TRV9FUlJPUiwgaW5mbyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX21zZWN0bC5vbihfbXNlRXZlbnRzMi5kZWZhdWx0LlNPVVJDRV9FTkQsIGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzMi5fbWVkaWFTb3VyY2VFbmRDYWxsYmFjayAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMi5fbWVkaWFTb3VyY2VFbmRDYWxsYmFjayhpbmZvKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5fbXNlY3RsLmF0dGFjaE1lZGlhRWxlbWVudChtZWRpYUVsZW1lbnQpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fcGVuZGluZ1NlZWtUaW1lICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBtZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSB0aGlzLl9wZW5kaW5nU2Vla1RpbWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTZWVrVGltZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJRTExIG1heSB0aHJvdyBJbnZhbGlkU3RhdGVFcnJvciBpZiByZWFkeVN0YXRlID09PSAwXG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIGNhbiBkZWZlciBzZXQgY3VycmVudFRpbWUgb3BlcmF0aW9uIGFmdGVyIGxvYWRlZG1ldGFkYXRhXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdkZXRhY2hNZWRpYUVsZW1lbnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGV0YWNoTWVkaWFFbGVtZW50KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX21zZWN0bC5kZXRhY2hNZWRpYUVsZW1lbnQoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbG9hZGVkbWV0YWRhdGEnLCB0aGlzLmUub252TG9hZGVkTWV0YWRhdGEpO1xuICAgICAgICAgICAgICAgIC8vdGhpcy5fbWVkaWFFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3NlZWtpbmcnLCB0aGlzLmUub252U2Vla2luZyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NhbnBsYXknLCB0aGlzLmUub252Q2FuUGxheSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3N0YWxsZWQnLCB0aGlzLmUub252U3RhbGxlZCk7XG4gICAgICAgICAgICAgICAgLy90aGlzLl9tZWRpYUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCB0aGlzLmUub252UHJvZ3Jlc3MpO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fbXNlY3RsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbXNlY3RsLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tc2VjdGwgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdsb2FkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWQoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgICAgICAgICAgaWYgKCF0aGlzLl9tZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbGxlZ2FsU3RhdGVFeGNlcHRpb24oJ0hUTUxNZWRpYUVsZW1lbnQgbXVzdCBiZSBhdHRhY2hlZCBiZWZvcmUgbG9hZCgpIScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX3RyYW5zbXV4ZXIpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbGxlZ2FsU3RhdGVFeGNlcHRpb24oJ0ZsdlBsYXllci5sb2FkKCkgaGFzIGJlZW4gY2FsbGVkLCBwbGVhc2UgY2FsbCB1bmxvYWQoKSBmaXJzdCEnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9oYXNQZW5kaW5nTG9hZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbmZpZy5kZWZlckxvYWRBZnRlclNvdXJjZU9wZW4gJiYgdGhpcy5fbXNlU291cmNlT3BlbmVkID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2hhc1BlbmRpbmdMb2FkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQucmVhZHlTdGF0ZSA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0U2V0VGltZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgLy8gSUUxMSBtYXkgdGhyb3cgSW52YWxpZFN0YXRlRXJyb3IgaWYgcmVhZHlTdGF0ZSA9PT0gMFxuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIgPSBuZXcgX3RyYW5zbXV4ZXIyLmRlZmF1bHQodGhpcy5fbWVkaWFEYXRhU291cmNlLCB0aGlzLl9jb25maWcpO1xuXG4gICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5JTklUX1NFR01FTlQsIGZ1bmN0aW9uICh0eXBlLCBpcykge1xuICAgICAgICAgICAgICAgIF90aGlzMy5fbXNlY3RsLmFwcGVuZEluaXRTZWdtZW50KGlzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVESUFfU0VHTUVOVCwgZnVuY3Rpb24gKHR5cGUsIG1zKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMzLl9tc2VjdGwuYXBwZW5kTWVkaWFTZWdtZW50KG1zKTtcblxuICAgICAgICAgICAgICAgIC8vIGxhenlMb2FkIGNoZWNrXG4gICAgICAgICAgICAgICAgaWYgKF90aGlzMy5fY29uZmlnLmxhenlMb2FkICYmICFfdGhpczMuX2NvbmZpZy5pc0xpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lID0gX3RoaXMzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtcy5pbmZvLmVuZER0cyA+PSAoY3VycmVudFRpbWUgKyBfdGhpczMuX2NvbmZpZy5sYXp5TG9hZE1heER1cmF0aW9uKSAqIDEwMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpczMuX3Byb2dyZXNzQ2hlY2tlciA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KF90aGlzMy5UQUcsICdNYXhpbXVtIGJ1ZmZlcmluZyBkdXJhdGlvbiBleGNlZWRlZCwgc3VzcGVuZCB0cmFuc211eGluZyB0YXNrJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMzLl9zdXNwZW5kVHJhbnNtdXhlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5MT0FESU5HX0NPTVBMRVRFLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMzLl9tc2VjdGwuZW5kT2ZTdHJlYW0oKTtcbiAgICAgICAgICAgICAgICBfdGhpczMuX2VtaXR0ZXIuZW1pdChfcGxheWVyRXZlbnRzMi5kZWZhdWx0LkxPQURJTkdfQ09NUExFVEUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5SRUNPVkVSRURfRUFSTFlfRU9GLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMzLl9lbWl0dGVyLmVtaXQoX3BsYXllckV2ZW50czIuZGVmYXVsdC5SRUNPVkVSRURfRUFSTFlfRU9GKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuSU9fRVJST1IsIGZ1bmN0aW9uIChkZXRhaWwsIGluZm8pIHtcbiAgICAgICAgICAgICAgICBfdGhpczMuX2VtaXR0ZXIuZW1pdChfcGxheWVyRXZlbnRzMi5kZWZhdWx0LkVSUk9SLCBfcGxheWVyRXJyb3JzLkVycm9yVHlwZXMuTkVUV09SS19FUlJPUiwgZGV0YWlsLCBpbmZvKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuREVNVVhfRVJST1IsIGZ1bmN0aW9uIChkZXRhaWwsIGluZm8pIHtcbiAgICAgICAgICAgICAgICBfdGhpczMuX2VtaXR0ZXIuZW1pdChfcGxheWVyRXZlbnRzMi5kZWZhdWx0LkVSUk9SLCBfcGxheWVyRXJyb3JzLkVycm9yVHlwZXMuTUVESUFfRVJST1IsIGRldGFpbCwgeyBjb2RlOiAtMSwgbXNnOiBpbmZvIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRURJQV9JTkZPLCBmdW5jdGlvbiAobWVkaWFJbmZvKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMzLl9tZWRpYUluZm8gPSBtZWRpYUluZm87XG4gICAgICAgICAgICAgICAgX3RoaXMzLl9lbWl0dGVyLmVtaXQoX3BsYXllckV2ZW50czIuZGVmYXVsdC5NRURJQV9JTkZPLCBPYmplY3QuYXNzaWduKHt9LCBtZWRpYUluZm8pKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVUQURBVEFfQVJSSVZFRCwgZnVuY3Rpb24gKG1ldGFkYXRhKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMzLl9lbWl0dGVyLmVtaXQoX3BsYXllckV2ZW50czIuZGVmYXVsdC5NRVRBREFUQV9BUlJJVkVELCBtZXRhZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNDUklQVERBVEFfQVJSSVZFRCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBfdGhpczMuX2VtaXR0ZXIuZW1pdChfcGxheWVyRXZlbnRzMi5kZWZhdWx0LlNDUklQVERBVEFfQVJSSVZFRCwgZGF0YSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNUQVRJU1RJQ1NfSU5GTywgZnVuY3Rpb24gKHN0YXRJbmZvKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMzLl9zdGF0aXN0aWNzSW5mbyA9IF90aGlzMy5fZmlsbFN0YXRpc3RpY3NJbmZvKHN0YXRJbmZvKTtcbiAgICAgICAgICAgICAgICBfdGhpczMuX2VtaXR0ZXIuZW1pdChfcGxheWVyRXZlbnRzMi5kZWZhdWx0LlNUQVRJU1RJQ1NfSU5GTywgT2JqZWN0LmFzc2lnbih7fSwgX3RoaXMzLl9zdGF0aXN0aWNzSW5mbykpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5SRUNPTU1FTkRfU0VFS1BPSU5ULCBmdW5jdGlvbiAobWlsbGlzZWNvbmRzKSB7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzMy5fbWVkaWFFbGVtZW50ICYmICFfdGhpczMuX2NvbmZpZy5hY2N1cmF0ZVNlZWspIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMzLl9yZXF1ZXN0U2V0VGltZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gbWlsbGlzZWNvbmRzIC8gMTAwMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNUUkVBTV9USU1FLCBmdW5jdGlvbiAodHMpIHtcbiAgICAgICAgICAgICAgICBfdGhpczMuX3JlY2VpdmVTdHJlYW1UaW1lKHRzKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLm9wZW4oKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndW5sb2FkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVubG9hZCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQucGF1c2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9tc2VjdGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tc2VjdGwuc2VlaygwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl90cmFuc211eGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwbGF5JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWVkaWFFbGVtZW50LnBsYXkoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncGF1c2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQucGF1c2UoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2ZpbGxTdGF0aXN0aWNzSW5mbycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZmlsbFN0YXRpc3RpY3NJbmZvKHN0YXRJbmZvKSB7XG4gICAgICAgICAgICBzdGF0SW5mby5wbGF5ZXJUeXBlID0gdGhpcy5fdHlwZTtcblxuICAgICAgICAgICAgaWYgKCEodGhpcy5fbWVkaWFFbGVtZW50IGluc3RhbmNlb2YgSFRNTFZpZGVvRWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3RhdEluZm87XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBoYXNRdWFsaXR5SW5mbyA9IHRydWU7XG4gICAgICAgICAgICB2YXIgZGVjb2RlZCA9IDA7XG4gICAgICAgICAgICB2YXIgZHJvcHBlZCA9IDA7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQuZ2V0VmlkZW9QbGF5YmFja1F1YWxpdHkpIHtcbiAgICAgICAgICAgICAgICB2YXIgcXVhbGl0eSA9IHRoaXMuX21lZGlhRWxlbWVudC5nZXRWaWRlb1BsYXliYWNrUXVhbGl0eSgpO1xuICAgICAgICAgICAgICAgIGRlY29kZWQgPSBxdWFsaXR5LnRvdGFsVmlkZW9GcmFtZXM7XG4gICAgICAgICAgICAgICAgZHJvcHBlZCA9IHF1YWxpdHkuZHJvcHBlZFZpZGVvRnJhbWVzO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQud2Via2l0RGVjb2RlZEZyYW1lQ291bnQgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgZGVjb2RlZCA9IHRoaXMuX21lZGlhRWxlbWVudC53ZWJraXREZWNvZGVkRnJhbWVDb3VudDtcbiAgICAgICAgICAgICAgICBkcm9wcGVkID0gdGhpcy5fbWVkaWFFbGVtZW50LndlYmtpdERyb3BwZWRGcmFtZUNvdW50O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBoYXNRdWFsaXR5SW5mbyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaGFzUXVhbGl0eUluZm8pIHtcbiAgICAgICAgICAgICAgICBzdGF0SW5mby5kZWNvZGVkRnJhbWVzID0gZGVjb2RlZDtcbiAgICAgICAgICAgICAgICBzdGF0SW5mby5kcm9wcGVkRnJhbWVzID0gZHJvcHBlZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHN0YXRJbmZvO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25tc2VVcGRhdGVFbmQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29ubXNlVXBkYXRlRW5kKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9jb25maWcubGF6eUxvYWQgfHwgdGhpcy5fY29uZmlnLmlzTGl2ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGJ1ZmZlcmVkID0gdGhpcy5fbWVkaWFFbGVtZW50LmJ1ZmZlcmVkO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lID0gdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRSYW5nZVN0YXJ0ID0gMDtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmFuZ2VFbmQgPSAwO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJ1ZmZlcmVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gYnVmZmVyZWQuc3RhcnQoaSk7XG4gICAgICAgICAgICAgICAgdmFyIGVuZCA9IGJ1ZmZlcmVkLmVuZChpKTtcbiAgICAgICAgICAgICAgICBpZiAoc3RhcnQgPD0gY3VycmVudFRpbWUgJiYgY3VycmVudFRpbWUgPCBlbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFJhbmdlU3RhcnQgPSBzdGFydDtcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFJhbmdlRW5kID0gZW5kO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjdXJyZW50UmFuZ2VFbmQgPj0gY3VycmVudFRpbWUgKyB0aGlzLl9jb25maWcubGF6eUxvYWRNYXhEdXJhdGlvbiAmJiB0aGlzLl9wcm9ncmVzc0NoZWNrZXIgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudih0aGlzLlRBRywgJ01heGltdW0gYnVmZmVyaW5nIGR1cmF0aW9uIGV4Y2VlZGVkLCBzdXNwZW5kIHRyYW5zbXV4aW5nIHRhc2snKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdXNwZW5kVHJhbnNtdXhlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25tc2VCdWZmZXJGdWxsJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbm1zZUJ1ZmZlckZ1bGwoKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYodGhpcy5UQUcsICdNU0UgU291cmNlQnVmZmVyIGlzIGZ1bGwsIHN1c3BlbmQgdHJhbnNtdXhpbmcgdGFzaycpO1xuICAgICAgICAgICAgaWYgKHRoaXMuX3Byb2dyZXNzQ2hlY2tlciA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3VzcGVuZFRyYW5zbXV4ZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3N1c3BlbmRUcmFuc211eGVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9zdXNwZW5kVHJhbnNtdXhlcigpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl90cmFuc211eGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5wYXVzZSgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Byb2dyZXNzQ2hlY2tlciA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Byb2dyZXNzQ2hlY2tlciA9IHdpbmRvdy5zZXRJbnRlcnZhbCh0aGlzLl9jaGVja1Byb2dyZXNzQW5kUmVzdW1lLmJpbmQodGhpcyksIDEwMDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2NoZWNrUHJvZ3Jlc3NBbmRSZXN1bWUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2NoZWNrUHJvZ3Jlc3NBbmRSZXN1bWUoKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFRpbWUgPSB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWU7XG4gICAgICAgICAgICB2YXIgYnVmZmVyZWQgPSB0aGlzLl9tZWRpYUVsZW1lbnQuYnVmZmVyZWQ7XG5cbiAgICAgICAgICAgIHZhciBuZWVkUmVzdW1lID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnVmZmVyZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJvbSA9IGJ1ZmZlcmVkLnN0YXJ0KGkpO1xuICAgICAgICAgICAgICAgIHZhciB0byA9IGJ1ZmZlcmVkLmVuZChpKTtcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudFRpbWUgPj0gZnJvbSAmJiBjdXJyZW50VGltZSA8IHRvKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50VGltZSA+PSB0byAtIHRoaXMuX2NvbmZpZy5sYXp5TG9hZFJlY292ZXJEdXJhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmVlZFJlc3VtZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobmVlZFJlc3VtZSkge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuX3Byb2dyZXNzQ2hlY2tlcik7XG4gICAgICAgICAgICAgICAgdGhpcy5fcHJvZ3Jlc3NDaGVja2VyID0gbnVsbDtcbiAgICAgICAgICAgICAgICBpZiAobmVlZFJlc3VtZSkge1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYodGhpcy5UQUcsICdDb250aW51ZSBsb2FkaW5nIGZyb20gcGF1c2VkIHBvc2l0aW9uJyk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIucmVzdW1lKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfaXNUaW1lcG9pbnRCdWZmZXJlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfaXNUaW1lcG9pbnRCdWZmZXJlZChzZWNvbmRzKSB7XG4gICAgICAgICAgICB2YXIgYnVmZmVyZWQgPSB0aGlzLl9tZWRpYUVsZW1lbnQuYnVmZmVyZWQ7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnVmZmVyZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJvbSA9IGJ1ZmZlcmVkLnN0YXJ0KGkpO1xuICAgICAgICAgICAgICAgIHZhciB0byA9IGJ1ZmZlcmVkLmVuZChpKTtcbiAgICAgICAgICAgICAgICBpZiAoc2Vjb25kcyA+PSBmcm9tICYmIHNlY29uZHMgPCB0bykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19pbnRlcm5hbFNlZWsnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2ludGVybmFsU2VlayhzZWNvbmRzKSB7XG4gICAgICAgICAgICB2YXIgZGlyZWN0U2VlayA9IHRoaXMuX2lzVGltZXBvaW50QnVmZmVyZWQoc2Vjb25kcyk7XG5cbiAgICAgICAgICAgIHZhciBkaXJlY3RTZWVrQmVnaW4gPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBkaXJlY3RTZWVrQmVnaW5UaW1lID0gMDtcblxuICAgICAgICAgICAgaWYgKHNlY29uZHMgPCAxLjAgJiYgdGhpcy5fbWVkaWFFbGVtZW50LmJ1ZmZlcmVkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgdmlkZW9CZWdpblRpbWUgPSB0aGlzLl9tZWRpYUVsZW1lbnQuYnVmZmVyZWQuc3RhcnQoMCk7XG4gICAgICAgICAgICAgICAgaWYgKHZpZGVvQmVnaW5UaW1lIDwgMS4wICYmIHNlY29uZHMgPCB2aWRlb0JlZ2luVGltZSB8fCBfYnJvd3NlcjIuZGVmYXVsdC5zYWZhcmkpIHtcbiAgICAgICAgICAgICAgICAgICAgZGlyZWN0U2Vla0JlZ2luID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgLy8gYWxzbyB3b3JrYXJvdW5kIGZvciBTYWZhcmk6IFNlZWsgdG8gMCBtYXkgY2F1c2UgdmlkZW8gc3R1Y2ssIHVzZSAwLjEgdG8gYXZvaWRcbiAgICAgICAgICAgICAgICAgICAgZGlyZWN0U2Vla0JlZ2luVGltZSA9IF9icm93c2VyMi5kZWZhdWx0LnNhZmFyaSA/IDAuMSA6IHZpZGVvQmVnaW5UaW1lO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGRpcmVjdFNlZWtCZWdpbikge1xuICAgICAgICAgICAgICAgIC8vIHNlZWsgdG8gdmlkZW8gYmVnaW4sIHNldCBjdXJyZW50VGltZSBkaXJlY3RseSBpZiBiZWdpblBUUyBidWZmZXJlZFxuICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RTZXRUaW1lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSBkaXJlY3RTZWVrQmVnaW5UaW1lO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChkaXJlY3RTZWVrKSB7XG4gICAgICAgICAgICAgICAgLy8gYnVmZmVyZWQgcG9zaXRpb25cbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2Fsd2F5c1NlZWtLZXlmcmFtZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0U2V0VGltZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IHNlY29uZHM7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkciA9IHRoaXMuX21zZWN0bC5nZXROZWFyZXN0S2V5ZnJhbWUoTWF0aC5mbG9vcihzZWNvbmRzICogMTAwMCkpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0U2V0VGltZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpZHIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gaWRyLmR0cyAvIDEwMDA7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSBzZWNvbmRzO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9wcm9ncmVzc0NoZWNrZXIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jaGVja1Byb2dyZXNzQW5kUmVzdW1lKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcHJvZ3Jlc3NDaGVja2VyICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5fcHJvZ3Jlc3NDaGVja2VyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcHJvZ3Jlc3NDaGVja2VyID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fbXNlY3RsLnNlZWsoc2Vjb25kcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5zZWVrKE1hdGguZmxvb3Ioc2Vjb25kcyAqIDEwMDApKTsgLy8gaW4gbWlsbGlzZWNvbmRzXG4gICAgICAgICAgICAgICAgLy8gbm8gbmVlZCB0byBzZXQgbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lIGlmIG5vbi1hY2N1cmF0ZVNlZWssXG4gICAgICAgICAgICAgICAgLy8ganVzdCB3YWl0IGZvciB0aGUgcmVjb21tZW5kX3NlZWtwb2ludCBjYWxsYmFja1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9jb25maWcuYWNjdXJhdGVTZWVrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RTZXRUaW1lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gc2Vjb25kcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19jaGVja0FuZEFwcGx5VW5idWZmZXJlZFNlZWtwb2ludCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfY2hlY2tBbmRBcHBseVVuYnVmZmVyZWRTZWVrcG9pbnQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fc2Vla3BvaW50UmVjb3JkKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3NlZWtwb2ludFJlY29yZC5yZWNvcmRUaW1lIDw9IHRoaXMuX25vdygpIC0gMTAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NlZWtwb2ludFJlY29yZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5faXNUaW1lcG9pbnRCdWZmZXJlZCh0YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fcHJvZ3Jlc3NDaGVja2VyICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMuX3Byb2dyZXNzQ2hlY2tlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcHJvZ3Jlc3NDaGVja2VyID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIC5jdXJyZW50VGltZSBpcyBjb25zaXN0cyB3aXRoIC5idWZmZXJlZCB0aW1lc3RhbXBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENocm9tZS9FZGdlIHVzZSBEVFMsIHdoaWxlIEZpcmVGb3gvU2FmYXJpIHVzZSBQVFNcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21zZWN0bC5zZWVrKHRhcmdldCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLnNlZWsoTWF0aC5mbG9vcih0YXJnZXQgKiAxMDAwKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXQgY3VycmVudFRpbWUgaWYgYWNjdXJhdGVTZWVrLCBvciB3YWl0IGZvciByZWNvbW1lbmRfc2Vla3BvaW50IGNhbGxiYWNrXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fY29uZmlnLmFjY3VyYXRlU2Vlaykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RTZXRUaW1lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSB0YXJnZXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dCh0aGlzLl9jaGVja0FuZEFwcGx5VW5idWZmZXJlZFNlZWtwb2ludC5iaW5kKHRoaXMpLCA1MCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfY2hlY2tBbmRSZXN1bWVTdHVja1BsYXliYWNrJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGVja0FuZFJlc3VtZVN0dWNrUGxheWJhY2soc3RhbGxlZCkge1xuICAgICAgICAgICAgdmFyIG1lZGlhID0gdGhpcy5fbWVkaWFFbGVtZW50O1xuICAgICAgICAgICAgaWYgKHN0YWxsZWQgfHwgIXRoaXMuX3JlY2VpdmVkQ2FuUGxheSB8fCBtZWRpYS5yZWFkeVN0YXRlIDwgMikge1xuICAgICAgICAgICAgICAgIC8vIEhBVkVfQ1VSUkVOVF9EQVRBXG4gICAgICAgICAgICAgICAgdmFyIGJ1ZmZlcmVkID0gbWVkaWEuYnVmZmVyZWQ7XG4gICAgICAgICAgICAgICAgaWYgKGJ1ZmZlcmVkLmxlbmd0aCA+IDAgJiYgbWVkaWEuY3VycmVudFRpbWUgPCBidWZmZXJlZC5zdGFydCgwKSkge1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdQbGF5YmFjayBzZWVtcyBzdHVjayBhdCAnICsgbWVkaWEuY3VycmVudFRpbWUgKyAnLCBzZWVrIHRvICcgKyBidWZmZXJlZC5zdGFydCgwKSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RTZXRUaW1lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gYnVmZmVyZWQuc3RhcnQoMCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIHRoaXMuZS5vbnZQcm9ncmVzcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBQbGF5YmFjayBkaWRuJ3Qgc3R1Y2ssIHJlbW92ZSBwcm9ncmVzcyBldmVudCBsaXN0ZW5lclxuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIHRoaXMuZS5vbnZQcm9ncmVzcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbnZMb2FkZWRNZXRhZGF0YScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb252TG9hZGVkTWV0YWRhdGEoZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3BlbmRpbmdTZWVrVGltZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gdGhpcy5fcGVuZGluZ1NlZWtUaW1lO1xuICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTZWVrVGltZSA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbnZTZWVraW5nJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbnZTZWVraW5nKGUpIHtcbiAgICAgICAgICAgIC8vIGhhbmRsZSBzZWVraW5nIHJlcXVlc3QgZnJvbSBicm93c2VyJ3MgcHJvZ3Jlc3MgYmFyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lO1xuICAgICAgICAgICAgdmFyIGJ1ZmZlcmVkID0gdGhpcy5fbWVkaWFFbGVtZW50LmJ1ZmZlcmVkO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fcmVxdWVzdFNldFRpbWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0U2V0VGltZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRhcmdldCA8IDEuMCAmJiBidWZmZXJlZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgLy8gc2VlayB0byB2aWRlbyBiZWdpbiwgc2V0IGN1cnJlbnRUaW1lIGRpcmVjdGx5IGlmIGJlZ2luUFRTIGJ1ZmZlcmVkXG4gICAgICAgICAgICAgICAgdmFyIHZpZGVvQmVnaW5UaW1lID0gYnVmZmVyZWQuc3RhcnQoMCk7XG4gICAgICAgICAgICAgICAgaWYgKHZpZGVvQmVnaW5UaW1lIDwgMS4wICYmIHRhcmdldCA8IHZpZGVvQmVnaW5UaW1lIHx8IF9icm93c2VyMi5kZWZhdWx0LnNhZmFyaSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0U2V0VGltZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFsc28gd29ya2Fyb3VuZCBmb3IgU2FmYXJpOiBTZWVrIHRvIDAgbWF5IGNhdXNlIHZpZGVvIHN0dWNrLCB1c2UgMC4xIHRvIGF2b2lkXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IF9icm93c2VyMi5kZWZhdWx0LnNhZmFyaSA/IDAuMSA6IHZpZGVvQmVnaW5UaW1lO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5faXNUaW1lcG9pbnRCdWZmZXJlZCh0YXJnZXQpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2Fsd2F5c1NlZWtLZXlmcmFtZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaWRyID0gdGhpcy5fbXNlY3RsLmdldE5lYXJlc3RLZXlmcmFtZShNYXRoLmZsb29yKHRhcmdldCAqIDEwMDApKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGlkciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0U2V0VGltZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSBpZHIuZHRzIC8gMTAwMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcHJvZ3Jlc3NDaGVja2VyICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tQcm9ncmVzc0FuZFJlc3VtZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3NlZWtwb2ludFJlY29yZCA9IHtcbiAgICAgICAgICAgICAgICBzZWVrUG9pbnQ6IHRhcmdldCxcbiAgICAgICAgICAgICAgICByZWNvcmRUaW1lOiB0aGlzLl9ub3coKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KHRoaXMuX2NoZWNrQW5kQXBwbHlVbmJ1ZmZlcmVkU2Vla3BvaW50LmJpbmQodGhpcyksIDUwKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29udkNhblBsYXknLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29udkNhblBsYXkoZSkge1xuICAgICAgICAgICAgdGhpcy5fcmVjZWl2ZWRDYW5QbGF5ID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjYW5wbGF5JywgdGhpcy5lLm9udkNhblBsYXkpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb252U3RhbGxlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb252U3RhbGxlZChlKSB7XG4gICAgICAgICAgICB0aGlzLl9jaGVja0FuZFJlc3VtZVN0dWNrUGxheWJhY2sodHJ1ZSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbnZQcm9ncmVzcycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb252UHJvZ3Jlc3MoZSkge1xuICAgICAgICAgICAgdGhpcy5fY2hlY2tBbmRSZXN1bWVTdHVja1BsYXliYWNrKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3NldE1lZGlhU291cmNlRW5kQ2FsbGJhY2snLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2V0TWVkaWFTb3VyY2VFbmRDYWxsYmFjayhjYWxsKSB7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYVNvdXJjZUVuZENhbGxiYWNrID0gY2FsbDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc2V0U3RyZWFtVGltZUNhbGxiYWNrJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldFN0cmVhbVRpbWVDYWxsYmFjayhjYWxsKSB7XG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrU3RyZWFtVGltZSA9IGNhbGw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19yZWNlaXZlU3RyZWFtVGltZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVjZWl2ZVN0cmVhbVRpbWUodHMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmNhbGxiYWNrU3RyZWFtVGltZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFja1N0cmVhbVRpbWUodHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICd0eXBlJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdHlwZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYnVmZmVyZWQnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tZWRpYUVsZW1lbnQuYnVmZmVyZWQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2R1cmF0aW9uJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWVkaWFFbGVtZW50LmR1cmF0aW9uO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICd2b2x1bWUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tZWRpYUVsZW1lbnQudm9sdW1lO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldCh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnZvbHVtZSA9IHZhbHVlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdtdXRlZCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21lZGlhRWxlbWVudC5tdXRlZDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQobXV0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5tdXRlZCA9IG11dGVkO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdjdXJyZW50VGltZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoc2Vjb25kcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2ludGVybmFsU2VlayhzZWNvbmRzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1NlZWtUaW1lID0gc2Vjb25kcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbWVkaWFJbmZvJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5fbWVkaWFJbmZvKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc3RhdGlzdGljc0luZm8nLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGF0aXN0aWNzSW5mbyA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGlzdGljc0luZm8gPSB7fTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3N0YXRpc3RpY3NJbmZvID0gdGhpcy5fZmlsbFN0YXRpc3RpY3NJbmZvKHRoaXMuX3N0YXRpc3RpY3NJbmZvKTtcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCB0aGlzLl9zdGF0aXN0aWNzSW5mbyk7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gRmx2UGxheWVyO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBGbHZQbGF5ZXI7XG5cbn0se1wiLi4vY29uZmlnLmpzXCI6NSxcIi4uL2NvcmUvbXNlLWNvbnRyb2xsZXIuanNcIjo5LFwiLi4vY29yZS9tc2UtZXZlbnRzLmpzXCI6MTAsXCIuLi9jb3JlL3RyYW5zbXV4ZXIuanNcIjoxMSxcIi4uL2NvcmUvdHJhbnNtdXhpbmctZXZlbnRzLmpzXCI6MTMsXCIuLi91dGlscy9icm93c2VyLmpzXCI6MzksXCIuLi91dGlscy9leGNlcHRpb24uanNcIjo0MCxcIi4uL3V0aWxzL2xvZ2dlci5qc1wiOjQxLFwiLi9wbGF5ZXItZXJyb3JzLmpzXCI6MzQsXCIuL3BsYXllci1ldmVudHMuanNcIjozNSxcImV2ZW50c1wiOjJ9XSwzMzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9ldmVudHMgPSBfZGVyZXFfKCdldmVudHMnKTtcblxudmFyIF9ldmVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXZlbnRzKTtcblxudmFyIF9wbGF5ZXJFdmVudHMgPSBfZGVyZXFfKCcuL3BsYXllci1ldmVudHMuanMnKTtcblxudmFyIF9wbGF5ZXJFdmVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcGxheWVyRXZlbnRzKTtcblxudmFyIF9jb25maWcgPSBfZGVyZXFfKCcuLi9jb25maWcuanMnKTtcblxudmFyIF9leGNlcHRpb24gPSBfZGVyZXFfKCcuLi91dGlscy9leGNlcHRpb24uanMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLy8gUGxheWVyIHdyYXBwZXIgZm9yIGJyb3dzZXIncyBuYXRpdmUgcGxheWVyIChIVE1MVmlkZW9FbGVtZW50KSB3aXRob3V0IE1lZGlhU291cmNlIHNyYy4gXG52YXIgTmF0aXZlUGxheWVyID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE5hdGl2ZVBsYXllcihtZWRpYURhdGFTb3VyY2UsIGNvbmZpZykge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTmF0aXZlUGxheWVyKTtcblxuICAgICAgICB0aGlzLlRBRyA9ICdOYXRpdmVQbGF5ZXInO1xuICAgICAgICB0aGlzLl90eXBlID0gJ05hdGl2ZVBsYXllcic7XG4gICAgICAgIHRoaXMuX2VtaXR0ZXIgPSBuZXcgX2V2ZW50czIuZGVmYXVsdCgpO1xuXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9ICgwLCBfY29uZmlnLmNyZWF0ZURlZmF1bHRDb25maWcpKCk7XG4gICAgICAgIGlmICgodHlwZW9mIGNvbmZpZyA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoY29uZmlnKSkgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuX2NvbmZpZywgY29uZmlnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtZWRpYURhdGFTb3VyY2UudHlwZS50b0xvd2VyQ2FzZSgpID09PSAnZmx2Jykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uKCdOYXRpdmVQbGF5ZXIgZG9lc1xcJ3Qgc3VwcG9ydCBmbHYgTWVkaWFEYXRhU291cmNlIGlucHV0IScpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtZWRpYURhdGFTb3VyY2UuaGFzT3duUHJvcGVydHkoJ3NlZ21lbnRzJykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLkludmFsaWRBcmd1bWVudEV4Y2VwdGlvbignTmF0aXZlUGxheWVyKCcgKyBtZWRpYURhdGFTb3VyY2UudHlwZSArICcpIGRvZXNuXFwndCBzdXBwb3J0IG11bHRpcGFydCBwbGF5YmFjayEnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuZSA9IHtcbiAgICAgICAgICAgIG9udkxvYWRlZE1ldGFkYXRhOiB0aGlzLl9vbnZMb2FkZWRNZXRhZGF0YS5iaW5kKHRoaXMpXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5fcGVuZGluZ1NlZWtUaW1lID0gbnVsbDtcbiAgICAgICAgdGhpcy5fc3RhdGlzdGljc1JlcG9ydGVyID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9tZWRpYURhdGFTb3VyY2UgPSBtZWRpYURhdGFTb3VyY2U7XG4gICAgICAgIHRoaXMuX21lZGlhRWxlbWVudCA9IG51bGw7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKE5hdGl2ZVBsYXllciwgW3tcbiAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMudW5sb2FkKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5kZXRhY2hNZWRpYUVsZW1lbnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYURhdGFTb3VyY2UgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIgPSBudWxsO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvbihldmVudCwgbGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgICAgIGlmIChldmVudCA9PT0gX3BsYXllckV2ZW50czIuZGVmYXVsdC5NRURJQV9JTkZPKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudCAhPSBudWxsICYmIHRoaXMuX21lZGlhRWxlbWVudC5yZWFkeVN0YXRlICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEhBVkVfTk9USElOR1xuICAgICAgICAgICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9lbWl0dGVyLmVtaXQoX3BsYXllckV2ZW50czIuZGVmYXVsdC5NRURJQV9JTkZPLCBfdGhpcy5tZWRpYUluZm8pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50ID09PSBfcGxheWVyRXZlbnRzMi5kZWZhdWx0LlNUQVRJU1RJQ1NfSU5GTykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQgIT0gbnVsbCAmJiB0aGlzLl9tZWRpYUVsZW1lbnQucmVhZHlTdGF0ZSAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9lbWl0dGVyLmVtaXQoX3BsYXllckV2ZW50czIuZGVmYXVsdC5TVEFUSVNUSUNTX0lORk8sIF90aGlzLnN0YXRpc3RpY3NJbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5hZGRMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvZmYnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb2ZmKGV2ZW50LCBsaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5yZW1vdmVMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhdHRhY2hNZWRpYUVsZW1lbnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXR0YWNoTWVkaWFFbGVtZW50KG1lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50ID0gbWVkaWFFbGVtZW50O1xuICAgICAgICAgICAgbWVkaWFFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlZG1ldGFkYXRhJywgdGhpcy5lLm9udkxvYWRlZE1ldGFkYXRhKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX3BlbmRpbmdTZWVrVGltZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gdGhpcy5fcGVuZGluZ1NlZWtUaW1lO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nU2Vla1RpbWUgPSBudWxsO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSUUxMSBtYXkgdGhyb3cgSW52YWxpZFN0YXRlRXJyb3IgaWYgcmVhZHlTdGF0ZSA9PT0gMFxuICAgICAgICAgICAgICAgICAgICAvLyBEZWZlciBzZXQgY3VycmVudFRpbWUgb3BlcmF0aW9uIGFmdGVyIGxvYWRlZG1ldGFkYXRhXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdkZXRhY2hNZWRpYUVsZW1lbnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGV0YWNoTWVkaWFFbGVtZW50KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5zcmMgPSAnJztcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdzcmMnKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbG9hZGVkbWV0YWRhdGEnLCB0aGlzLmUub252TG9hZGVkTWV0YWRhdGEpO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudCA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhdGlzdGljc1JlcG9ydGVyICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLl9zdGF0aXN0aWNzUmVwb3J0ZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRpc3RpY3NSZXBvcnRlciA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2xvYWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbG9hZCgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fbWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCdIVE1MTWVkaWFFbGVtZW50IG11c3QgYmUgYXR0YWNoZWQgYmVmb3JlIGxvYWQoKSEnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5zcmMgPSB0aGlzLl9tZWRpYURhdGFTb3VyY2UudXJsO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50LnJlYWR5U3RhdGUgPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnByZWxvYWQgPSAnYXV0byc7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQubG9hZCgpO1xuICAgICAgICAgICAgdGhpcy5fc3RhdGlzdGljc1JlcG9ydGVyID0gd2luZG93LnNldEludGVydmFsKHRoaXMuX3JlcG9ydFN0YXRpc3RpY3NJbmZvLmJpbmQodGhpcyksIHRoaXMuX2NvbmZpZy5zdGF0aXN0aWNzSW5mb1JlcG9ydEludGVydmFsKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndW5sb2FkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVubG9hZCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuc3JjID0gJyc7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnc3JjJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhdGlzdGljc1JlcG9ydGVyICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLl9zdGF0aXN0aWNzUmVwb3J0ZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRpc3RpY3NSZXBvcnRlciA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3BsYXknLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGxheSgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tZWRpYUVsZW1lbnQucGxheSgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwYXVzZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5wYXVzZSgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb252TG9hZGVkTWV0YWRhdGEnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29udkxvYWRlZE1ldGFkYXRhKGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nU2Vla1RpbWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IHRoaXMuX3BlbmRpbmdTZWVrVGltZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nU2Vla1RpbWUgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuTUVESUFfSU5GTywgdGhpcy5tZWRpYUluZm8pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcmVwb3J0U3RhdGlzdGljc0luZm8nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3JlcG9ydFN0YXRpc3RpY3NJbmZvKCkge1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuU1RBVElTVElDU19JTkZPLCB0aGlzLnN0YXRpc3RpY3NJbmZvKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndHlwZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3R5cGU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2J1ZmZlcmVkJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWVkaWFFbGVtZW50LmJ1ZmZlcmVkO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdkdXJhdGlvbicsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21lZGlhRWxlbWVudC5kdXJhdGlvbjtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndm9sdW1lJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWVkaWFFbGVtZW50LnZvbHVtZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC52b2x1bWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbXV0ZWQnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tZWRpYUVsZW1lbnQubXV0ZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KG11dGVkKSB7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQubXV0ZWQgPSBtdXRlZDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnY3VycmVudFRpbWUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHNlY29uZHMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSBzZWNvbmRzO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nU2Vla1RpbWUgPSBzZWNvbmRzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdtZWRpYUluZm8nLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHZhciBtZWRpYVByZWZpeCA9IHRoaXMuX21lZGlhRWxlbWVudCBpbnN0YW5jZW9mIEhUTUxBdWRpb0VsZW1lbnQgPyAnYXVkaW8vJyA6ICd2aWRlby8nO1xuICAgICAgICAgICAgdmFyIGluZm8gPSB7XG4gICAgICAgICAgICAgICAgbWltZVR5cGU6IG1lZGlhUHJlZml4ICsgdGhpcy5fbWVkaWFEYXRhU291cmNlLnR5cGVcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgaW5mby5kdXJhdGlvbiA9IE1hdGguZmxvb3IodGhpcy5fbWVkaWFFbGVtZW50LmR1cmF0aW9uICogMTAwMCk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudCBpbnN0YW5jZW9mIEhUTUxWaWRlb0VsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgaW5mby53aWR0aCA9IHRoaXMuX21lZGlhRWxlbWVudC52aWRlb1dpZHRoO1xuICAgICAgICAgICAgICAgICAgICBpbmZvLmhlaWdodCA9IHRoaXMuX21lZGlhRWxlbWVudC52aWRlb0hlaWdodDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaW5mbztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc3RhdGlzdGljc0luZm8nLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHZhciBpbmZvID0ge1xuICAgICAgICAgICAgICAgIHBsYXllclR5cGU6IHRoaXMuX3R5cGUsXG4gICAgICAgICAgICAgICAgdXJsOiB0aGlzLl9tZWRpYURhdGFTb3VyY2UudXJsXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAoISh0aGlzLl9tZWRpYUVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MVmlkZW9FbGVtZW50KSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbmZvO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgaGFzUXVhbGl0eUluZm8gPSB0cnVlO1xuICAgICAgICAgICAgdmFyIGRlY29kZWQgPSAwO1xuICAgICAgICAgICAgdmFyIGRyb3BwZWQgPSAwO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50LmdldFZpZGVvUGxheWJhY2tRdWFsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHF1YWxpdHkgPSB0aGlzLl9tZWRpYUVsZW1lbnQuZ2V0VmlkZW9QbGF5YmFja1F1YWxpdHkoKTtcbiAgICAgICAgICAgICAgICBkZWNvZGVkID0gcXVhbGl0eS50b3RhbFZpZGVvRnJhbWVzO1xuICAgICAgICAgICAgICAgIGRyb3BwZWQgPSBxdWFsaXR5LmRyb3BwZWRWaWRlb0ZyYW1lcztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5fbWVkaWFFbGVtZW50LndlYmtpdERlY29kZWRGcmFtZUNvdW50ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGRlY29kZWQgPSB0aGlzLl9tZWRpYUVsZW1lbnQud2Via2l0RGVjb2RlZEZyYW1lQ291bnQ7XG4gICAgICAgICAgICAgICAgZHJvcHBlZCA9IHRoaXMuX21lZGlhRWxlbWVudC53ZWJraXREcm9wcGVkRnJhbWVDb3VudDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaGFzUXVhbGl0eUluZm8gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGhhc1F1YWxpdHlJbmZvKSB7XG4gICAgICAgICAgICAgICAgaW5mby5kZWNvZGVkRnJhbWVzID0gZGVjb2RlZDtcbiAgICAgICAgICAgICAgICBpbmZvLmRyb3BwZWRGcmFtZXMgPSBkcm9wcGVkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gaW5mbztcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBOYXRpdmVQbGF5ZXI7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IE5hdGl2ZVBsYXllcjtcblxufSx7XCIuLi9jb25maWcuanNcIjo1LFwiLi4vdXRpbHMvZXhjZXB0aW9uLmpzXCI6NDAsXCIuL3BsYXllci1ldmVudHMuanNcIjozNSxcImV2ZW50c1wiOjJ9XSwzNDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuRXJyb3JEZXRhaWxzID0gZXhwb3J0cy5FcnJvclR5cGVzID0gdW5kZWZpbmVkO1xuXG52YXIgX2xvYWRlciA9IF9kZXJlcV8oJy4uL2lvL2xvYWRlci5qcycpO1xuXG52YXIgX2RlbXV4RXJyb3JzID0gX2RlcmVxXygnLi4vZGVtdXgvZGVtdXgtZXJyb3JzLmpzJyk7XG5cbnZhciBfZGVtdXhFcnJvcnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZGVtdXhFcnJvcnMpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG52YXIgRXJyb3JUeXBlcyA9IGV4cG9ydHMuRXJyb3JUeXBlcyA9IHtcbiAgICBORVRXT1JLX0VSUk9SOiAnTmV0d29ya0Vycm9yJyxcbiAgICBNRURJQV9FUlJPUjogJ01lZGlhRXJyb3InLFxuICAgIE9USEVSX0VSUk9SOiAnT3RoZXJFcnJvcidcbn07XG5cbnZhciBFcnJvckRldGFpbHMgPSBleHBvcnRzLkVycm9yRGV0YWlscyA9IHtcbiAgICBORVRXT1JLX0VYQ0VQVElPTjogX2xvYWRlci5Mb2FkZXJFcnJvcnMuRVhDRVBUSU9OLFxuICAgIE5FVFdPUktfU1RBVFVTX0NPREVfSU5WQUxJRDogX2xvYWRlci5Mb2FkZXJFcnJvcnMuSFRUUF9TVEFUVVNfQ09ERV9JTlZBTElELFxuICAgIE5FVFdPUktfVElNRU9VVDogX2xvYWRlci5Mb2FkZXJFcnJvcnMuQ09OTkVDVElOR19USU1FT1VULFxuICAgIE5FVFdPUktfVU5SRUNPVkVSQUJMRV9FQVJMWV9FT0Y6IF9sb2FkZXIuTG9hZGVyRXJyb3JzLlVOUkVDT1ZFUkFCTEVfRUFSTFlfRU9GLFxuXG4gICAgTUVESUFfTVNFX0VSUk9SOiAnTWVkaWFNU0VFcnJvcicsXG5cbiAgICBNRURJQV9GT1JNQVRfRVJST1I6IF9kZW11eEVycm9yczIuZGVmYXVsdC5GT1JNQVRfRVJST1IsXG4gICAgTUVESUFfRk9STUFUX1VOU1VQUE9SVEVEOiBfZGVtdXhFcnJvcnMyLmRlZmF1bHQuRk9STUFUX1VOU1VQUE9SVEVELFxuICAgIE1FRElBX0NPREVDX1VOU1VQUE9SVEVEOiBfZGVtdXhFcnJvcnMyLmRlZmF1bHQuQ09ERUNfVU5TVVBQT1JURURcbn07XG5cbn0se1wiLi4vZGVtdXgvZGVtdXgtZXJyb3JzLmpzXCI6MTYsXCIuLi9pby9sb2FkZXIuanNcIjoyNH1dLDM1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbnZhciBQbGF5ZXJFdmVudHMgPSB7XG4gIEVSUk9SOiAnZXJyb3InLFxuICBMT0FESU5HX0NPTVBMRVRFOiAnbG9hZGluZ19jb21wbGV0ZScsXG4gIFJFQ09WRVJFRF9FQVJMWV9FT0Y6ICdyZWNvdmVyZWRfZWFybHlfZW9mJyxcbiAgTUVESUFfSU5GTzogJ21lZGlhX2luZm8nLFxuICBNRVRBREFUQV9BUlJJVkVEOiAnbWV0YWRhdGFfYXJyaXZlZCcsXG4gIFNDUklQVERBVEFfQVJSSVZFRDogJ3NjcmlwdGRhdGFfYXJyaXZlZCcsXG4gIFNUQVRJU1RJQ1NfSU5GTzogJ3N0YXRpc3RpY3NfaW5mbydcbn07XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFBsYXllckV2ZW50cztcblxufSx7fV0sMzY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogVGhpcyBmaWxlIGlzIG1vZGlmaWVkIGZyb20gZGFpbHltb3Rpb24ncyBobHMuanMgbGlicmFyeSAoaGxzLmpzL3NyYy9oZWxwZXIvYWFjLmpzKVxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxudmFyIEFBQyA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBBQUMoKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBQUMpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhBQUMsIG51bGwsIFt7XG4gICAgICAgIGtleTogJ2dldFNpbGVudEZyYW1lJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFNpbGVudEZyYW1lKGNvZGVjLCBjaGFubmVsQ291bnQpIHtcbiAgICAgICAgICAgIGlmIChjb2RlYyA9PT0gJ21wNGEuNDAuMicpIHtcbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgTEMtQUFDXG4gICAgICAgICAgICAgICAgaWYgKGNoYW5uZWxDb3VudCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4YzgsIDB4MDAsIDB4ODAsIDB4MjMsIDB4ODBdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5uZWxDb3VudCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzB4MjEsIDB4MDAsIDB4NDksIDB4OTAsIDB4MDIsIDB4MTksIDB4MDAsIDB4MjMsIDB4ODBdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5uZWxDb3VudCA9PT0gMykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4YzgsIDB4MDAsIDB4ODAsIDB4MjAsIDB4ODQsIDB4MDEsIDB4MjYsIDB4NDAsIDB4MDgsIDB4NjQsIDB4MDAsIDB4OGVdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5uZWxDb3VudCA9PT0gNCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4YzgsIDB4MDAsIDB4ODAsIDB4MjAsIDB4ODQsIDB4MDEsIDB4MjYsIDB4NDAsIDB4MDgsIDB4NjQsIDB4MDAsIDB4ODAsIDB4MmMsIDB4ODAsIDB4MDgsIDB4MDIsIDB4MzhdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5uZWxDb3VudCA9PT0gNSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4YzgsIDB4MDAsIDB4ODAsIDB4MjAsIDB4ODQsIDB4MDEsIDB4MjYsIDB4NDAsIDB4MDgsIDB4NjQsIDB4MDAsIDB4ODIsIDB4MzAsIDB4MDQsIDB4OTksIDB4MDAsIDB4MjEsIDB4OTAsIDB4MDIsIDB4MzhdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5uZWxDb3VudCA9PT0gNikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4YzgsIDB4MDAsIDB4ODAsIDB4MjAsIDB4ODQsIDB4MDEsIDB4MjYsIDB4NDAsIDB4MDgsIDB4NjQsIDB4MDAsIDB4ODIsIDB4MzAsIDB4MDQsIDB4OTksIDB4MDAsIDB4MjEsIDB4OTAsIDB4MDIsIDB4MDAsIDB4YjIsIDB4MDAsIDB4MjAsIDB4MDgsIDB4ZTBdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGhhbmRsZSBIRS1BQUMgKG1wNGEuNDAuNSAvIG1wNGEuNDAuMjkpXG4gICAgICAgICAgICAgICAgaWYgKGNoYW5uZWxDb3VudCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBmZm1wZWcgLXkgLWYgbGF2ZmkgLWkgXCJhZXZhbHNyYz0wOmQ9MC4wNVwiIC1jOmEgbGliZmRrX2FhYyAtcHJvZmlsZTphIGFhY19oZSAtYjphIDRrIG91dHB1dC5hYWMgJiYgaGV4ZHVtcCAtdiAtZSAnMTYvMSBcIjB4JXgsXCIgXCJcXG5cIicgLXYgb3V0cHV0LmFhY1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzB4MSwgMHg0MCwgMHgyMiwgMHg4MCwgMHhhMywgMHg0ZSwgMHhlNiwgMHg4MCwgMHhiYSwgMHg4LCAweDAsIDB4MCwgMHgwLCAweDFjLCAweDYsIDB4ZjEsIDB4YzEsIDB4YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1ZV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hhbm5lbENvdW50ID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGZmbXBlZyAteSAtZiBsYXZmaSAtaSBcImFldmFsc3JjPTB8MDpkPTAuMDVcIiAtYzphIGxpYmZka19hYWMgLXByb2ZpbGU6YSBhYWNfaGVfdjIgLWI6YSA0ayBvdXRwdXQuYWFjICYmIGhleGR1bXAgLXYgLWUgJzE2LzEgXCIweCV4LFwiIFwiXFxuXCInIC12IG91dHB1dC5hYWNcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KFsweDEsIDB4NDAsIDB4MjIsIDB4ODAsIDB4YTMsIDB4NWUsIDB4ZTYsIDB4ODAsIDB4YmEsIDB4OCwgMHgwLCAweDAsIDB4MCwgMHgwLCAweDk1LCAweDAsIDB4NiwgMHhmMSwgMHhhMSwgMHhhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVhLCAweDVlXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFubmVsQ291bnQgPT09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZmZtcGVnIC15IC1mIGxhdmZpIC1pIFwiYWV2YWxzcmM9MHwwfDA6ZD0wLjA1XCIgLWM6YSBsaWJmZGtfYWFjIC1wcm9maWxlOmEgYWFjX2hlX3YyIC1iOmEgNGsgb3V0cHV0LmFhYyAmJiBoZXhkdW1wIC12IC1lICcxNi8xIFwiMHgleCxcIiBcIlxcblwiJyAtdiBvdXRwdXQuYWFjXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShbMHgxLCAweDQwLCAweDIyLCAweDgwLCAweGEzLCAweDVlLCAweGU2LCAweDgwLCAweGJhLCAweDgsIDB4MCwgMHgwLCAweDAsIDB4MCwgMHg5NSwgMHgwLCAweDYsIDB4ZjEsIDB4YTEsIDB4YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1ZV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIEFBQztcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gQUFDO1xuXG59LHt9XSwzNzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBUaGlzIGZpbGUgaXMgZGVyaXZlZCBmcm9tIGRhaWx5bW90aW9uJ3MgaGxzLmpzIGxpYnJhcnkgKGhscy5qcy9zcmMvcmVtdXgvbXA0LWdlbmVyYXRvci5qcylcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbi8vICBNUDQgYm94ZXMgZ2VuZXJhdG9yIGZvciBJU08gQk1GRiAoSVNPIEJhc2UgTWVkaWEgRmlsZSBGb3JtYXQsIGRlZmluZWQgaW4gSVNPL0lFQyAxNDQ5Ni0xMilcbnZhciBNUDQgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTVA0KCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTVA0KTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoTVA0LCBudWxsLCBbe1xuICAgICAgICBrZXk6ICdpbml0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICBNUDQudHlwZXMgPSB7XG4gICAgICAgICAgICAgICAgYXZjMTogW10sIGF2Y0M6IFtdLCBidHJ0OiBbXSwgZGluZjogW10sXG4gICAgICAgICAgICAgICAgZHJlZjogW10sIGVzZHM6IFtdLCBmdHlwOiBbXSwgaGRscjogW10sXG4gICAgICAgICAgICAgICAgbWRhdDogW10sIG1kaGQ6IFtdLCBtZGlhOiBbXSwgbWZoZDogW10sXG4gICAgICAgICAgICAgICAgbWluZjogW10sIG1vb2Y6IFtdLCBtb292OiBbXSwgbXA0YTogW10sXG4gICAgICAgICAgICAgICAgbXZleDogW10sIG12aGQ6IFtdLCBzZHRwOiBbXSwgc3RibDogW10sXG4gICAgICAgICAgICAgICAgc3RjbzogW10sIHN0c2M6IFtdLCBzdHNkOiBbXSwgc3RzejogW10sXG4gICAgICAgICAgICAgICAgc3R0czogW10sIHRmZHQ6IFtdLCB0ZmhkOiBbXSwgdHJhZjogW10sXG4gICAgICAgICAgICAgICAgdHJhazogW10sIHRydW46IFtdLCB0cmV4OiBbXSwgdGtoZDogW10sXG4gICAgICAgICAgICAgICAgdm1oZDogW10sIHNtaGQ6IFtdLCAnLm1wMyc6IFtdXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIE1QNC50eXBlcykge1xuICAgICAgICAgICAgICAgIGlmIChNUDQudHlwZXMuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgTVA0LnR5cGVzW25hbWVdID0gW25hbWUuY2hhckNvZGVBdCgwKSwgbmFtZS5jaGFyQ29kZUF0KDEpLCBuYW1lLmNoYXJDb2RlQXQoMiksIG5hbWUuY2hhckNvZGVBdCgzKV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgY29uc3RhbnRzID0gTVA0LmNvbnN0YW50cyA9IHt9O1xuXG4gICAgICAgICAgICBjb25zdGFudHMuRlRZUCA9IG5ldyBVaW50OEFycmF5KFsweDY5LCAweDczLCAweDZGLCAweDZELCAvLyBtYWpvcl9icmFuZDogaXNvbVxuICAgICAgICAgICAgMHgwLCAweDAsIDB4MCwgMHgxLCAvLyBtaW5vcl92ZXJzaW9uOiAweDAxXG4gICAgICAgICAgICAweDY5LCAweDczLCAweDZGLCAweDZELCAvLyBpc29tXG4gICAgICAgICAgICAweDYxLCAweDc2LCAweDYzLCAweDMxIC8vIGF2YzFcbiAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICBjb25zdGFudHMuU1RTRF9QUkVGSVggPSBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gdmVyc2lvbigwKSArIGZsYWdzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAxIC8vIGVudHJ5X2NvdW50XG4gICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgY29uc3RhbnRzLlNUVFMgPSBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gdmVyc2lvbigwKSArIGZsYWdzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwIC8vIGVudHJ5X2NvdW50XG4gICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgY29uc3RhbnRzLlNUU0MgPSBjb25zdGFudHMuU1RDTyA9IGNvbnN0YW50cy5TVFRTO1xuXG4gICAgICAgICAgICBjb25zdGFudHMuU1RTWiA9IG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyB2ZXJzaW9uKDApICsgZmxhZ3NcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHNhbXBsZV9zaXplXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwIC8vIHNhbXBsZV9jb3VudFxuICAgICAgICAgICAgXSk7XG5cbiAgICAgICAgICAgIGNvbnN0YW50cy5IRExSX1ZJREVPID0gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHZlcnNpb24oMCkgKyBmbGFnc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcHJlX2RlZmluZWRcbiAgICAgICAgICAgIDB4NzYsIDB4NjksIDB4NjQsIDB4NjUsIC8vIGhhbmRsZXJfdHlwZTogJ3ZpZGUnXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyByZXNlcnZlZDogMyAqIDQgYnl0ZXNcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4NTYsIDB4NjksIDB4NjQsIDB4NjUsIDB4NkYsIDB4NDgsIDB4NjEsIDB4NkUsIDB4NjQsIDB4NkMsIDB4NjUsIDB4NzIsIDB4MDAgLy8gbmFtZTogVmlkZW9IYW5kbGVyXG4gICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgY29uc3RhbnRzLkhETFJfQVVESU8gPSBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gdmVyc2lvbigwKSArIGZsYWdzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBwcmVfZGVmaW5lZFxuICAgICAgICAgICAgMHg3MywgMHg2RiwgMHg3NSwgMHg2RSwgLy8gaGFuZGxlcl90eXBlOiAnc291bidcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHJlc2VydmVkOiAzICogNCBieXRlc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHg1MywgMHg2RiwgMHg3NSwgMHg2RSwgMHg2NCwgMHg0OCwgMHg2MSwgMHg2RSwgMHg2NCwgMHg2QywgMHg2NSwgMHg3MiwgMHgwMCAvLyBuYW1lOiBTb3VuZEhhbmRsZXJcbiAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICBjb25zdGFudHMuRFJFRiA9IG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyB2ZXJzaW9uKDApICsgZmxhZ3NcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDEsIC8vIGVudHJ5X2NvdW50XG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDBDLCAvLyBlbnRyeV9zaXplXG4gICAgICAgICAgICAweDc1LCAweDcyLCAweDZDLCAweDIwLCAvLyB0eXBlICd1cmwgJ1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMSAvLyB2ZXJzaW9uKDApICsgZmxhZ3NcbiAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICAvLyBTb3VuZCBtZWRpYSBoZWFkZXJcbiAgICAgICAgICAgIGNvbnN0YW50cy5TTUhEID0gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHZlcnNpb24oMCkgKyBmbGFnc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCAvLyBiYWxhbmNlKDIpICsgcmVzZXJ2ZWQoMilcbiAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICAvLyB2aWRlbyBtZWRpYSBoZWFkZXJcbiAgICAgICAgICAgIGNvbnN0YW50cy5WTUhEID0gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDEsIC8vIHZlcnNpb24oMCkgKyBmbGFnc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgLy8gZ3JhcGhpY3Ntb2RlOiAyIGJ5dGVzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBvcGNvbG9yOiAzICogMiBieXRlc1xuICAgICAgICAgICAgMHgwMCwgMHgwMF0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gR2VuZXJhdGUgYSBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYm94JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGJveCh0eXBlKSB7XG4gICAgICAgICAgICB2YXIgc2l6ZSA9IDg7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBkYXRhcyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG4gICAgICAgICAgICB2YXIgYXJyYXlDb3VudCA9IGRhdGFzLmxlbmd0aDtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnJheUNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICBzaXplICs9IGRhdGFzW2ldLmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlc3VsdCA9IG5ldyBVaW50OEFycmF5KHNpemUpO1xuICAgICAgICAgICAgcmVzdWx0WzBdID0gc2l6ZSA+Pj4gMjQgJiAweEZGOyAvLyBzaXplXG4gICAgICAgICAgICByZXN1bHRbMV0gPSBzaXplID4+PiAxNiAmIDB4RkY7XG4gICAgICAgICAgICByZXN1bHRbMl0gPSBzaXplID4+PiA4ICYgMHhGRjtcbiAgICAgICAgICAgIHJlc3VsdFszXSA9IHNpemUgJiAweEZGO1xuXG4gICAgICAgICAgICByZXN1bHQuc2V0KHR5cGUsIDQpOyAvLyB0eXBlXG5cbiAgICAgICAgICAgIHZhciBvZmZzZXQgPSA4O1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFycmF5Q291bnQ7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAvLyBkYXRhIGJvZHlcbiAgICAgICAgICAgICAgICByZXN1bHQuc2V0KGRhdGFzW19pXSwgb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gZGF0YXNbX2ldLmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBlbWl0IGZ0eXAgJiBtb292XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2dlbmVyYXRlSW5pdFNlZ21lbnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2VuZXJhdGVJbml0U2VnbWVudChtZXRhKSB7XG4gICAgICAgICAgICB2YXIgZnR5cCA9IE1QNC5ib3goTVA0LnR5cGVzLmZ0eXAsIE1QNC5jb25zdGFudHMuRlRZUCk7XG4gICAgICAgICAgICB2YXIgbW9vdiA9IE1QNC5tb292KG1ldGEpO1xuXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkoZnR5cC5ieXRlTGVuZ3RoICsgbW9vdi5ieXRlTGVuZ3RoKTtcbiAgICAgICAgICAgIHJlc3VsdC5zZXQoZnR5cCwgMCk7XG4gICAgICAgICAgICByZXN1bHQuc2V0KG1vb3YsIGZ0eXAuYnl0ZUxlbmd0aCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTW92aWUgbWV0YWRhdGEgYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ21vb3YnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbW9vdihtZXRhKSB7XG4gICAgICAgICAgICB2YXIgbXZoZCA9IE1QNC5tdmhkKG1ldGEudGltZXNjYWxlLCBtZXRhLmR1cmF0aW9uKTtcbiAgICAgICAgICAgIHZhciB0cmFrID0gTVA0LnRyYWsobWV0YSk7XG4gICAgICAgICAgICB2YXIgbXZleCA9IE1QNC5tdmV4KG1ldGEpO1xuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLm1vb3YsIG12aGQsIHRyYWssIG12ZXgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTW92aWUgaGVhZGVyIGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdtdmhkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG12aGQodGltZXNjYWxlLCBkdXJhdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLm12aGQsIG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyB2ZXJzaW9uKDApICsgZmxhZ3NcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIGNyZWF0aW9uX3RpbWVcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIG1vZGlmaWNhdGlvbl90aW1lXG4gICAgICAgICAgICB0aW1lc2NhbGUgPj4+IDI0ICYgMHhGRiwgLy8gdGltZXNjYWxlOiA0IGJ5dGVzXG4gICAgICAgICAgICB0aW1lc2NhbGUgPj4+IDE2ICYgMHhGRiwgdGltZXNjYWxlID4+PiA4ICYgMHhGRiwgdGltZXNjYWxlICYgMHhGRiwgZHVyYXRpb24gPj4+IDI0ICYgMHhGRiwgLy8gZHVyYXRpb246IDQgYnl0ZXNcbiAgICAgICAgICAgIGR1cmF0aW9uID4+PiAxNiAmIDB4RkYsIGR1cmF0aW9uID4+PiA4ICYgMHhGRiwgZHVyYXRpb24gJiAweEZGLCAweDAwLCAweDAxLCAweDAwLCAweDAwLCAvLyBQcmVmZXJyZWQgcmF0ZTogMS4wXG4gICAgICAgICAgICAweDAxLCAweDAwLCAweDAwLCAweDAwLCAvLyBQcmVmZXJyZWRWb2x1bWUoMS4wLCAyYnl0ZXMpICsgcmVzZXJ2ZWQoMmJ5dGVzKVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcmVzZXJ2ZWQ6IDQgKyA0IGJ5dGVzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAxLCAweDAwLCAweDAwLCAvLyAtLS0tYmVnaW4gY29tcG9zaXRpb24gbWF0cml4LS0tLVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMSwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHg0MCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gLS0tLWVuZCBjb21wb3NpdGlvbiBtYXRyaXgtLS0tXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyAtLS0tYmVnaW4gcHJlX2RlZmluZWQgNiAqIDQgYnl0ZXMtLS0tXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyAtLS0tZW5kIHByZV9kZWZpbmVkIDYgKiA0IGJ5dGVzLS0tLVxuICAgICAgICAgICAgMHhGRiwgMHhGRiwgMHhGRiwgMHhGRiAvLyBuZXh0X3RyYWNrX0lEXG4gICAgICAgICAgICBdKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUcmFjayBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndHJhaycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0cmFrKG1ldGEpIHtcbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy50cmFrLCBNUDQudGtoZChtZXRhKSwgTVA0Lm1kaWEobWV0YSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVHJhY2sgaGVhZGVyIGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICd0a2hkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRraGQobWV0YSkge1xuICAgICAgICAgICAgdmFyIHRyYWNrSWQgPSBtZXRhLmlkLFxuICAgICAgICAgICAgICAgIGR1cmF0aW9uID0gbWV0YS5kdXJhdGlvbjtcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IG1ldGEucHJlc2VudFdpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodCA9IG1ldGEucHJlc2VudEhlaWdodDtcblxuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLnRraGQsIG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDA3LCAvLyB2ZXJzaW9uKDApICsgZmxhZ3NcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIGNyZWF0aW9uX3RpbWVcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIG1vZGlmaWNhdGlvbl90aW1lXG4gICAgICAgICAgICB0cmFja0lkID4+PiAyNCAmIDB4RkYsIC8vIHRyYWNrX0lEOiA0IGJ5dGVzXG4gICAgICAgICAgICB0cmFja0lkID4+PiAxNiAmIDB4RkYsIHRyYWNrSWQgPj4+IDggJiAweEZGLCB0cmFja0lkICYgMHhGRiwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcmVzZXJ2ZWQ6IDQgYnl0ZXNcbiAgICAgICAgICAgIGR1cmF0aW9uID4+PiAyNCAmIDB4RkYsIC8vIGR1cmF0aW9uOiA0IGJ5dGVzXG4gICAgICAgICAgICBkdXJhdGlvbiA+Pj4gMTYgJiAweEZGLCBkdXJhdGlvbiA+Pj4gOCAmIDB4RkYsIGR1cmF0aW9uICYgMHhGRiwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcmVzZXJ2ZWQ6IDIgKiA0IGJ5dGVzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBsYXllcigyYnl0ZXMpICsgYWx0ZXJuYXRlX2dyb3VwKDJieXRlcylcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHZvbHVtZSgyYnl0ZXMpICsgcmVzZXJ2ZWQoMmJ5dGVzKVxuICAgICAgICAgICAgMHgwMCwgMHgwMSwgMHgwMCwgMHgwMCwgLy8gLS0tLWJlZ2luIGNvbXBvc2l0aW9uIG1hdHJpeC0tLS1cbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDEsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4NDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIC0tLS1lbmQgY29tcG9zaXRpb24gbWF0cml4LS0tLVxuICAgICAgICAgICAgd2lkdGggPj4+IDggJiAweEZGLCAvLyB3aWR0aCBhbmQgaGVpZ2h0XG4gICAgICAgICAgICB3aWR0aCAmIDB4RkYsIDB4MDAsIDB4MDAsIGhlaWdodCA+Pj4gOCAmIDB4RkYsIGhlaWdodCAmIDB4RkYsIDB4MDAsIDB4MDBdKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNZWRpYSBCb3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbWRpYScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtZGlhKG1ldGEpIHtcbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5tZGlhLCBNUDQubWRoZChtZXRhKSwgTVA0LmhkbHIobWV0YSksIE1QNC5taW5mKG1ldGEpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1lZGlhIGhlYWRlciBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbWRoZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtZGhkKG1ldGEpIHtcbiAgICAgICAgICAgIHZhciB0aW1lc2NhbGUgPSBtZXRhLnRpbWVzY2FsZTtcbiAgICAgICAgICAgIHZhciBkdXJhdGlvbiA9IG1ldGEuZHVyYXRpb247XG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMubWRoZCwgbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHZlcnNpb24oMCkgKyBmbGFnc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gY3JlYXRpb25fdGltZVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gbW9kaWZpY2F0aW9uX3RpbWVcbiAgICAgICAgICAgIHRpbWVzY2FsZSA+Pj4gMjQgJiAweEZGLCAvLyB0aW1lc2NhbGU6IDQgYnl0ZXNcbiAgICAgICAgICAgIHRpbWVzY2FsZSA+Pj4gMTYgJiAweEZGLCB0aW1lc2NhbGUgPj4+IDggJiAweEZGLCB0aW1lc2NhbGUgJiAweEZGLCBkdXJhdGlvbiA+Pj4gMjQgJiAweEZGLCAvLyBkdXJhdGlvbjogNCBieXRlc1xuICAgICAgICAgICAgZHVyYXRpb24gPj4+IDE2ICYgMHhGRiwgZHVyYXRpb24gPj4+IDggJiAweEZGLCBkdXJhdGlvbiAmIDB4RkYsIDB4NTUsIDB4QzQsIC8vIGxhbmd1YWdlOiB1bmQgKHVuZGV0ZXJtaW5lZClcbiAgICAgICAgICAgIDB4MDAsIDB4MDAgLy8gcHJlX2RlZmluZWQgPSAwXG4gICAgICAgICAgICBdKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNZWRpYSBoYW5kbGVyIHJlZmVyZW5jZSBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnaGRscicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoZGxyKG1ldGEpIHtcbiAgICAgICAgICAgIHZhciBkYXRhID0gbnVsbDtcbiAgICAgICAgICAgIGlmIChtZXRhLnR5cGUgPT09ICdhdWRpbycpIHtcbiAgICAgICAgICAgICAgICBkYXRhID0gTVA0LmNvbnN0YW50cy5IRExSX0FVRElPO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkYXRhID0gTVA0LmNvbnN0YW50cy5IRExSX1ZJREVPO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLmhkbHIsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTWVkaWEgaW5mb21hdGlvbiBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbWluZicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtaW5mKG1ldGEpIHtcbiAgICAgICAgICAgIHZhciB4bWhkID0gbnVsbDtcbiAgICAgICAgICAgIGlmIChtZXRhLnR5cGUgPT09ICdhdWRpbycpIHtcbiAgICAgICAgICAgICAgICB4bWhkID0gTVA0LmJveChNUDQudHlwZXMuc21oZCwgTVA0LmNvbnN0YW50cy5TTUhEKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgeG1oZCA9IE1QNC5ib3goTVA0LnR5cGVzLnZtaGQsIE1QNC5jb25zdGFudHMuVk1IRCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMubWluZiwgeG1oZCwgTVA0LmRpbmYoKSwgTVA0LnN0YmwobWV0YSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGF0YSBpbmZvbWF0aW9uIGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdkaW5mJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRpbmYoKSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gTVA0LmJveChNUDQudHlwZXMuZGluZiwgTVA0LmJveChNUDQudHlwZXMuZHJlZiwgTVA0LmNvbnN0YW50cy5EUkVGKSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2FtcGxlIHRhYmxlIGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzdGJsJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN0YmwobWV0YSkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IE1QNC5ib3goTVA0LnR5cGVzLnN0YmwsIC8vIHR5cGU6IHN0YmxcbiAgICAgICAgICAgIE1QNC5zdHNkKG1ldGEpLCAvLyBTYW1wbGUgRGVzY3JpcHRpb24gVGFibGVcbiAgICAgICAgICAgIE1QNC5ib3goTVA0LnR5cGVzLnN0dHMsIE1QNC5jb25zdGFudHMuU1RUUyksIC8vIFRpbWUtVG8tU2FtcGxlXG4gICAgICAgICAgICBNUDQuYm94KE1QNC50eXBlcy5zdHNjLCBNUDQuY29uc3RhbnRzLlNUU0MpLCAvLyBTYW1wbGUtVG8tQ2h1bmtcbiAgICAgICAgICAgIE1QNC5ib3goTVA0LnR5cGVzLnN0c3osIE1QNC5jb25zdGFudHMuU1RTWiksIC8vIFNhbXBsZSBzaXplXG4gICAgICAgICAgICBNUDQuYm94KE1QNC50eXBlcy5zdGNvLCBNUDQuY29uc3RhbnRzLlNUQ08gLy8gQ2h1bmsgb2Zmc2V0XG4gICAgICAgICAgICApKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTYW1wbGUgZGVzY3JpcHRpb24gYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3N0c2QnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc3RzZChtZXRhKSB7XG4gICAgICAgICAgICBpZiAobWV0YS50eXBlID09PSAnYXVkaW8nKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1ldGEuY29kZWMgPT09ICdtcDMnKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5zdHNkLCBNUDQuY29uc3RhbnRzLlNUU0RfUFJFRklYLCBNUDQubXAzKG1ldGEpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gZWxzZTogYWFjIC0+IG1wNGFcbiAgICAgICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMuc3RzZCwgTVA0LmNvbnN0YW50cy5TVFNEX1BSRUZJWCwgTVA0Lm1wNGEobWV0YSkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMuc3RzZCwgTVA0LmNvbnN0YW50cy5TVFNEX1BSRUZJWCwgTVA0LmF2YzEobWV0YSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdtcDMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbXAzKG1ldGEpIHtcbiAgICAgICAgICAgIHZhciBjaGFubmVsQ291bnQgPSBtZXRhLmNoYW5uZWxDb3VudDtcbiAgICAgICAgICAgIHZhciBzYW1wbGVSYXRlID0gbWV0YS5hdWRpb1NhbXBsZVJhdGU7XG5cbiAgICAgICAgICAgIHZhciBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHJlc2VydmVkKDQpXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAxLCAvLyByZXNlcnZlZCgyKSArIGRhdGFfcmVmZXJlbmNlX2luZGV4KDIpXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyByZXNlcnZlZDogMiAqIDQgYnl0ZXNcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIGNoYW5uZWxDb3VudCwgLy8gY2hhbm5lbENvdW50KDIpXG4gICAgICAgICAgICAweDAwLCAweDEwLCAvLyBzYW1wbGVTaXplKDIpXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyByZXNlcnZlZCg0KVxuICAgICAgICAgICAgc2FtcGxlUmF0ZSA+Pj4gOCAmIDB4RkYsIC8vIEF1ZGlvIHNhbXBsZSByYXRlXG4gICAgICAgICAgICBzYW1wbGVSYXRlICYgMHhGRiwgMHgwMCwgMHgwMF0pO1xuXG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXNbJy5tcDMnXSwgZGF0YSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ21wNGEnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbXA0YShtZXRhKSB7XG4gICAgICAgICAgICB2YXIgY2hhbm5lbENvdW50ID0gbWV0YS5jaGFubmVsQ291bnQ7XG4gICAgICAgICAgICB2YXIgc2FtcGxlUmF0ZSA9IG1ldGEuYXVkaW9TYW1wbGVSYXRlO1xuXG4gICAgICAgICAgICB2YXIgZGF0YSA9IG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyByZXNlcnZlZCg0KVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMSwgLy8gcmVzZXJ2ZWQoMikgKyBkYXRhX3JlZmVyZW5jZV9pbmRleCgyKVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcmVzZXJ2ZWQ6IDIgKiA0IGJ5dGVzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCBjaGFubmVsQ291bnQsIC8vIGNoYW5uZWxDb3VudCgyKVxuICAgICAgICAgICAgMHgwMCwgMHgxMCwgLy8gc2FtcGxlU2l6ZSgyKVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcmVzZXJ2ZWQoNClcbiAgICAgICAgICAgIHNhbXBsZVJhdGUgPj4+IDggJiAweEZGLCAvLyBBdWRpbyBzYW1wbGUgcmF0ZVxuICAgICAgICAgICAgc2FtcGxlUmF0ZSAmIDB4RkYsIDB4MDAsIDB4MDBdKTtcblxuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLm1wNGEsIGRhdGEsIE1QNC5lc2RzKG1ldGEpKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZXNkcycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBlc2RzKG1ldGEpIHtcbiAgICAgICAgICAgIHZhciBjb25maWcgPSBtZXRhLmNvbmZpZyB8fCBbXTtcbiAgICAgICAgICAgIHZhciBjb25maWdTaXplID0gY29uZmlnLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHZlcnNpb24gMCArIGZsYWdzXG5cbiAgICAgICAgICAgIDB4MDMsIC8vIGRlc2NyaXB0b3JfdHlwZVxuICAgICAgICAgICAgMHgxNyArIGNvbmZpZ1NpemUsIC8vIGxlbmd0aDNcbiAgICAgICAgICAgIDB4MDAsIDB4MDEsIC8vIGVzX2lkXG4gICAgICAgICAgICAweDAwLCAvLyBzdHJlYW1fcHJpb3JpdHlcblxuICAgICAgICAgICAgMHgwNCwgLy8gZGVzY3JpcHRvcl90eXBlXG4gICAgICAgICAgICAweDBGICsgY29uZmlnU2l6ZSwgLy8gbGVuZ3RoXG4gICAgICAgICAgICAweDQwLCAvLyBjb2RlYzogbXBlZzRfYXVkaW9cbiAgICAgICAgICAgIDB4MTUsIC8vIHN0cmVhbV90eXBlOiBBdWRpb1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgLy8gYnVmZmVyX3NpemVcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIG1heEJpdHJhdGVcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIGF2Z0JpdHJhdGVcblxuICAgICAgICAgICAgMHgwNSAvLyBkZXNjcmlwdG9yX3R5cGVcbiAgICAgICAgICAgIF0uY29uY2F0KFtjb25maWdTaXplXSkuY29uY2F0KGNvbmZpZykuY29uY2F0KFsweDA2LCAweDAxLCAweDAyIC8vIEdBU3BlY2lmaWNDb25maWdcbiAgICAgICAgICAgIF0pKTtcbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5lc2RzLCBkYXRhKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYXZjMScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhdmMxKG1ldGEpIHtcbiAgICAgICAgICAgIHZhciBhdmNjID0gbWV0YS5hdmNjO1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gbWV0YS5jb2RlY1dpZHRoLFxuICAgICAgICAgICAgICAgIGhlaWdodCA9IG1ldGEuY29kZWNIZWlnaHQ7XG5cbiAgICAgICAgICAgIHZhciBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHJlc2VydmVkKDQpXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAxLCAvLyByZXNlcnZlZCgyKSArIGRhdGFfcmVmZXJlbmNlX2luZGV4KDIpXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBwcmVfZGVmaW5lZCgyKSArIHJlc2VydmVkKDIpXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBwcmVfZGVmaW5lZDogMyAqIDQgYnl0ZXNcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIHdpZHRoID4+PiA4ICYgMHhGRiwgLy8gd2lkdGg6IDIgYnl0ZXNcbiAgICAgICAgICAgIHdpZHRoICYgMHhGRiwgaGVpZ2h0ID4+PiA4ICYgMHhGRiwgLy8gaGVpZ2h0OiAyIGJ5dGVzXG4gICAgICAgICAgICBoZWlnaHQgJiAweEZGLCAweDAwLCAweDQ4LCAweDAwLCAweDAwLCAvLyBob3JpenJlc29sdXRpb246IDQgYnl0ZXNcbiAgICAgICAgICAgIDB4MDAsIDB4NDgsIDB4MDAsIDB4MDAsIC8vIHZlcnRyZXNvbHV0aW9uOiA0IGJ5dGVzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyByZXNlcnZlZDogNCBieXRlc1xuICAgICAgICAgICAgMHgwMCwgMHgwMSwgLy8gZnJhbWVfY291bnRcbiAgICAgICAgICAgIDB4MEEsIC8vIHN0cmxlblxuICAgICAgICAgICAgMHg3OCwgMHg3MSwgMHg3MSwgMHgyRiwgLy8gY29tcHJlc3Nvcm5hbWU6IDMyIGJ5dGVzXG4gICAgICAgICAgICAweDY2LCAweDZDLCAweDc2LCAweDJFLCAweDZBLCAweDczLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDE4LCAvLyBkZXB0aFxuICAgICAgICAgICAgMHhGRiwgMHhGRiAvLyBwcmVfZGVmaW5lZCA9IC0xXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5hdmMxLCBkYXRhLCBNUDQuYm94KE1QNC50eXBlcy5hdmNDLCBhdmNjKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNb3ZpZSBFeHRlbmRzIGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdtdmV4JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG12ZXgobWV0YSkge1xuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLm12ZXgsIE1QNC50cmV4KG1ldGEpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRyYWNrIEV4dGVuZHMgYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3RyZXgnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdHJleChtZXRhKSB7XG4gICAgICAgICAgICB2YXIgdHJhY2tJZCA9IG1ldGEuaWQ7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyB2ZXJzaW9uKDApICsgZmxhZ3NcbiAgICAgICAgICAgIHRyYWNrSWQgPj4+IDI0ICYgMHhGRiwgLy8gdHJhY2tfSURcbiAgICAgICAgICAgIHRyYWNrSWQgPj4+IDE2ICYgMHhGRiwgdHJhY2tJZCA+Pj4gOCAmIDB4RkYsIHRyYWNrSWQgJiAweEZGLCAweDAwLCAweDAwLCAweDAwLCAweDAxLCAvLyBkZWZhdWx0X3NhbXBsZV9kZXNjcmlwdGlvbl9pbmRleFxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gZGVmYXVsdF9zYW1wbGVfZHVyYXRpb25cbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIGRlZmF1bHRfc2FtcGxlX3NpemVcbiAgICAgICAgICAgIDB4MDAsIDB4MDEsIDB4MDAsIDB4MDEgLy8gZGVmYXVsdF9zYW1wbGVfZmxhZ3NcbiAgICAgICAgICAgIF0pO1xuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLnRyZXgsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTW92aWUgZnJhZ21lbnQgYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ21vb2YnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbW9vZih0cmFjaywgYmFzZU1lZGlhRGVjb2RlVGltZSkge1xuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLm1vb2YsIE1QNC5tZmhkKHRyYWNrLnNlcXVlbmNlTnVtYmVyKSwgTVA0LnRyYWYodHJhY2ssIGJhc2VNZWRpYURlY29kZVRpbWUpKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbWZoZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtZmhkKHNlcXVlbmNlTnVtYmVyKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCBzZXF1ZW5jZU51bWJlciA+Pj4gMjQgJiAweEZGLCAvLyBzZXF1ZW5jZV9udW1iZXI6IGludDMyXG4gICAgICAgICAgICBzZXF1ZW5jZU51bWJlciA+Pj4gMTYgJiAweEZGLCBzZXF1ZW5jZU51bWJlciA+Pj4gOCAmIDB4RkYsIHNlcXVlbmNlTnVtYmVyICYgMHhGRl0pO1xuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLm1maGQsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVHJhY2sgZnJhZ21lbnQgYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3RyYWYnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdHJhZih0cmFjaywgYmFzZU1lZGlhRGVjb2RlVGltZSkge1xuICAgICAgICAgICAgdmFyIHRyYWNrSWQgPSB0cmFjay5pZDtcblxuICAgICAgICAgICAgLy8gVHJhY2sgZnJhZ21lbnQgaGVhZGVyIGJveFxuICAgICAgICAgICAgdmFyIHRmaGQgPSBNUDQuYm94KE1QNC50eXBlcy50ZmhkLCBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gdmVyc2lvbigwKSAmIGZsYWdzXG4gICAgICAgICAgICB0cmFja0lkID4+PiAyNCAmIDB4RkYsIC8vIHRyYWNrX0lEXG4gICAgICAgICAgICB0cmFja0lkID4+PiAxNiAmIDB4RkYsIHRyYWNrSWQgPj4+IDggJiAweEZGLCB0cmFja0lkICYgMHhGRl0pKTtcbiAgICAgICAgICAgIC8vIFRyYWNrIEZyYWdtZW50IERlY29kZSBUaW1lXG4gICAgICAgICAgICB2YXIgdGZkdCA9IE1QNC5ib3goTVA0LnR5cGVzLnRmZHQsIG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyB2ZXJzaW9uKDApICYgZmxhZ3NcbiAgICAgICAgICAgIGJhc2VNZWRpYURlY29kZVRpbWUgPj4+IDI0ICYgMHhGRiwgLy8gYmFzZU1lZGlhRGVjb2RlVGltZTogaW50MzJcbiAgICAgICAgICAgIGJhc2VNZWRpYURlY29kZVRpbWUgPj4+IDE2ICYgMHhGRiwgYmFzZU1lZGlhRGVjb2RlVGltZSA+Pj4gOCAmIDB4RkYsIGJhc2VNZWRpYURlY29kZVRpbWUgJiAweEZGXSkpO1xuICAgICAgICAgICAgdmFyIHNkdHAgPSBNUDQuc2R0cCh0cmFjayk7XG4gICAgICAgICAgICB2YXIgdHJ1biA9IE1QNC50cnVuKHRyYWNrLCBzZHRwLmJ5dGVMZW5ndGggKyAxNiArIDE2ICsgOCArIDE2ICsgOCArIDgpO1xuXG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMudHJhZiwgdGZoZCwgdGZkdCwgdHJ1biwgc2R0cCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTYW1wbGUgRGVwZW5kZW5jeSBUeXBlIGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzZHRwJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNkdHAodHJhY2spIHtcbiAgICAgICAgICAgIHZhciBzYW1wbGVzID0gdHJhY2suc2FtcGxlcyB8fCBbXTtcbiAgICAgICAgICAgIHZhciBzYW1wbGVDb3VudCA9IHNhbXBsZXMubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBuZXcgVWludDhBcnJheSg0ICsgc2FtcGxlQ291bnQpO1xuICAgICAgICAgICAgLy8gMH40IGJ5dGVzOiB2ZXJzaW9uKDApICYgZmxhZ3NcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2FtcGxlQ291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBmbGFncyA9IHNhbXBsZXNbaV0uZmxhZ3M7XG4gICAgICAgICAgICAgICAgZGF0YVtpICsgNF0gPSBmbGFncy5pc0xlYWRpbmcgPDwgNiB8IC8vIGlzX2xlYWRpbmc6IDIgKGJpdClcbiAgICAgICAgICAgICAgICBmbGFncy5kZXBlbmRzT24gPDwgNCAvLyBzYW1wbGVfZGVwZW5kc19vblxuICAgICAgICAgICAgICAgIHwgZmxhZ3MuaXNEZXBlbmRlZE9uIDw8IDIgLy8gc2FtcGxlX2lzX2RlcGVuZGVkX29uXG4gICAgICAgICAgICAgICAgfCBmbGFncy5oYXNSZWR1bmRhbmN5OyAvLyBzYW1wbGVfaGFzX3JlZHVuZGFuY3lcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5zZHRwLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRyYWNrIGZyYWdtZW50IHJ1biBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndHJ1bicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0cnVuKHRyYWNrLCBvZmZzZXQpIHtcbiAgICAgICAgICAgIHZhciBzYW1wbGVzID0gdHJhY2suc2FtcGxlcyB8fCBbXTtcbiAgICAgICAgICAgIHZhciBzYW1wbGVDb3VudCA9IHNhbXBsZXMubGVuZ3RoO1xuICAgICAgICAgICAgdmFyIGRhdGFTaXplID0gMTIgKyAxNiAqIHNhbXBsZUNvdW50O1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBuZXcgVWludDhBcnJheShkYXRhU2l6ZSk7XG4gICAgICAgICAgICBvZmZzZXQgKz0gOCArIGRhdGFTaXplO1xuXG4gICAgICAgICAgICBkYXRhLnNldChbMHgwMCwgMHgwMCwgMHgwRiwgMHgwMSwgLy8gdmVyc2lvbigwKSAmIGZsYWdzXG4gICAgICAgICAgICBzYW1wbGVDb3VudCA+Pj4gMjQgJiAweEZGLCAvLyBzYW1wbGVfY291bnRcbiAgICAgICAgICAgIHNhbXBsZUNvdW50ID4+PiAxNiAmIDB4RkYsIHNhbXBsZUNvdW50ID4+PiA4ICYgMHhGRiwgc2FtcGxlQ291bnQgJiAweEZGLCBvZmZzZXQgPj4+IDI0ICYgMHhGRiwgLy8gZGF0YV9vZmZzZXRcbiAgICAgICAgICAgIG9mZnNldCA+Pj4gMTYgJiAweEZGLCBvZmZzZXQgPj4+IDggJiAweEZGLCBvZmZzZXQgJiAweEZGXSwgMCk7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2FtcGxlQ291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBkdXJhdGlvbiA9IHNhbXBsZXNbaV0uZHVyYXRpb247XG4gICAgICAgICAgICAgICAgdmFyIHNpemUgPSBzYW1wbGVzW2ldLnNpemU7XG4gICAgICAgICAgICAgICAgdmFyIGZsYWdzID0gc2FtcGxlc1tpXS5mbGFncztcbiAgICAgICAgICAgICAgICB2YXIgY3RzID0gc2FtcGxlc1tpXS5jdHM7XG4gICAgICAgICAgICAgICAgZGF0YS5zZXQoW2R1cmF0aW9uID4+PiAyNCAmIDB4RkYsIC8vIHNhbXBsZV9kdXJhdGlvblxuICAgICAgICAgICAgICAgIGR1cmF0aW9uID4+PiAxNiAmIDB4RkYsIGR1cmF0aW9uID4+PiA4ICYgMHhGRiwgZHVyYXRpb24gJiAweEZGLCBzaXplID4+PiAyNCAmIDB4RkYsIC8vIHNhbXBsZV9zaXplXG4gICAgICAgICAgICAgICAgc2l6ZSA+Pj4gMTYgJiAweEZGLCBzaXplID4+PiA4ICYgMHhGRiwgc2l6ZSAmIDB4RkYsIGZsYWdzLmlzTGVhZGluZyA8PCAyIHwgZmxhZ3MuZGVwZW5kc09uLCAvLyBzYW1wbGVfZmxhZ3NcbiAgICAgICAgICAgICAgICBmbGFncy5pc0RlcGVuZGVkT24gPDwgNiB8IGZsYWdzLmhhc1JlZHVuZGFuY3kgPDwgNCB8IGZsYWdzLmlzTm9uU3luYywgMHgwMCwgMHgwMCwgLy8gc2FtcGxlX2RlZ3JhZGF0aW9uX3ByaW9yaXR5XG4gICAgICAgICAgICAgICAgY3RzID4+PiAyNCAmIDB4RkYsIC8vIHNhbXBsZV9jb21wb3NpdGlvbl90aW1lX29mZnNldFxuICAgICAgICAgICAgICAgIGN0cyA+Pj4gMTYgJiAweEZGLCBjdHMgPj4+IDggJiAweEZGLCBjdHMgJiAweEZGXSwgMTIgKyAxNiAqIGkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLnRydW4sIGRhdGEpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdtZGF0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1kYXQoZGF0YSkge1xuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLm1kYXQsIGRhdGEpO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIE1QNDtcbn0oKTtcblxuTVA0LmluaXQoKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gTVA0O1xuXG59LHt9XSwzODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfbG9nZ2VyID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nZ2VyLmpzJyk7XG5cbnZhciBfbG9nZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dlcik7XG5cbnZhciBfbXA0R2VuZXJhdG9yID0gX2RlcmVxXygnLi9tcDQtZ2VuZXJhdG9yLmpzJyk7XG5cbnZhciBfbXA0R2VuZXJhdG9yMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21wNEdlbmVyYXRvcik7XG5cbnZhciBfYWFjU2lsZW50ID0gX2RlcmVxXygnLi9hYWMtc2lsZW50LmpzJyk7XG5cbnZhciBfYWFjU2lsZW50MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2FhY1NpbGVudCk7XG5cbnZhciBfYnJvd3NlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2Jyb3dzZXIuanMnKTtcblxudmFyIF9icm93c2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2Jyb3dzZXIpO1xuXG52YXIgX21lZGlhU2VnbWVudEluZm8gPSBfZGVyZXFfKCcuLi9jb3JlL21lZGlhLXNlZ21lbnQtaW5mby5qcycpO1xuXG52YXIgX2V4Y2VwdGlvbiA9IF9kZXJlcV8oJy4uL3V0aWxzL2V4Y2VwdGlvbi5qcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vLyBGcmFnbWVudGVkIG1wNCByZW11eGVyXG52YXIgTVA0UmVtdXhlciA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBNUDRSZW11eGVyKGNvbmZpZykge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTVA0UmVtdXhlcik7XG5cbiAgICAgICAgdGhpcy5UQUcgPSAnTVA0UmVtdXhlcic7XG5cbiAgICAgICAgdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgICAgICB0aGlzLl9pc0xpdmUgPSBjb25maWcuaXNMaXZlID09PSB0cnVlID8gdHJ1ZSA6IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuX2R0c0Jhc2UgPSAtMTtcbiAgICAgICAgdGhpcy5fZHRzQmFzZUluaXRlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLl9hdWRpb0R0c0Jhc2UgPSBJbmZpbml0eTtcbiAgICAgICAgdGhpcy5fdmlkZW9EdHNCYXNlID0gSW5maW5pdHk7XG4gICAgICAgIHRoaXMuX2F1ZGlvTmV4dER0cyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fdmlkZW9OZXh0RHRzID0gdW5kZWZpbmVkO1xuICAgICAgICB0aGlzLl9hdWRpb1N0YXNoZWRMYXN0U2FtcGxlID0gbnVsbDtcbiAgICAgICAgdGhpcy5fdmlkZW9TdGFzaGVkTGFzdFNhbXBsZSA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5fYXVkaW9NZXRhID0gbnVsbDtcbiAgICAgICAgdGhpcy5fdmlkZW9NZXRhID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9hdWRpb1NlZ21lbnRJbmZvTGlzdCA9IG5ldyBfbWVkaWFTZWdtZW50SW5mby5NZWRpYVNlZ21lbnRJbmZvTGlzdCgnYXVkaW8nKTtcbiAgICAgICAgdGhpcy5fdmlkZW9TZWdtZW50SW5mb0xpc3QgPSBuZXcgX21lZGlhU2VnbWVudEluZm8uTWVkaWFTZWdtZW50SW5mb0xpc3QoJ3ZpZGVvJyk7XG5cbiAgICAgICAgdGhpcy5fb25Jbml0U2VnbWVudCA9IG51bGw7XG4gICAgICAgIHRoaXMuX29uTWVkaWFTZWdtZW50ID0gbnVsbDtcblxuICAgICAgICAvLyBXb3JrYXJvdW5kIGZvciBjaHJvbWUgPCA1MDogQWx3YXlzIGZvcmNlIGZpcnN0IHNhbXBsZSBhcyBhIFJhbmRvbSBBY2Nlc3MgUG9pbnQgaW4gbWVkaWEgc2VnbWVudFxuICAgICAgICAvLyBzZWUgaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9MjI5NDEyXG4gICAgICAgIHRoaXMuX2ZvcmNlRmlyc3RJRFIgPSBfYnJvd3NlcjIuZGVmYXVsdC5jaHJvbWUgJiYgKF9icm93c2VyMi5kZWZhdWx0LnZlcnNpb24ubWFqb3IgPCA1MCB8fCBfYnJvd3NlcjIuZGVmYXVsdC52ZXJzaW9uLm1ham9yID09PSA1MCAmJiBfYnJvd3NlcjIuZGVmYXVsdC52ZXJzaW9uLmJ1aWxkIDwgMjY2MSkgPyB0cnVlIDogZmFsc2U7XG5cbiAgICAgICAgLy8gV29ya2Fyb3VuZCBmb3IgSUUxMS9FZGdlOiBGaWxsIHNpbGVudCBhYWMgZnJhbWUgYWZ0ZXIga2V5ZnJhbWUtc2Vla2luZ1xuICAgICAgICAvLyBNYWtlIGF1ZGlvIGJlZ2luRHRzIGVxdWFscyB3aXRoIHZpZGVvIGJlZ2luRHRzLCBpbiBvcmRlciB0byBmaXggc2VlayBmcmVlemVcbiAgICAgICAgdGhpcy5fZmlsbFNpbGVudEFmdGVyU2VlayA9IF9icm93c2VyMi5kZWZhdWx0Lm1zZWRnZSB8fCBfYnJvd3NlcjIuZGVmYXVsdC5tc2llO1xuXG4gICAgICAgIC8vIFdoaWxlIG9ubHkgRmlyZUZveCBzdXBwb3J0cyAnYXVkaW8vbXA0LCBjb2RlY3M9XCJtcDNcIicsIHVzZSAnYXVkaW8vbXBlZycgZm9yIGNocm9tZSwgc2FmYXJpLCAuLi5cbiAgICAgICAgdGhpcy5fbXAzVXNlTXBlZ0F1ZGlvID0gIV9icm93c2VyMi5kZWZhdWx0LmZpcmVmb3g7XG5cbiAgICAgICAgdGhpcy5fZmlsbEF1ZGlvVGltZXN0YW1wR2FwID0gdGhpcy5fY29uZmlnLmZpeEF1ZGlvVGltZXN0YW1wR2FwO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhNUDRSZW11eGVyLCBbe1xuICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICB0aGlzLl9kdHNCYXNlID0gLTE7XG4gICAgICAgICAgICB0aGlzLl9kdHNCYXNlSW5pdGVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9hdWRpb01ldGEgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fdmlkZW9NZXRhID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX2F1ZGlvU2VnbWVudEluZm9MaXN0LmNsZWFyKCk7XG4gICAgICAgICAgICB0aGlzLl9hdWRpb1NlZ21lbnRJbmZvTGlzdCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl92aWRlb1NlZ21lbnRJbmZvTGlzdC5jbGVhcigpO1xuICAgICAgICAgICAgdGhpcy5fdmlkZW9TZWdtZW50SW5mb0xpc3QgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25Jbml0U2VnbWVudCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vbk1lZGlhU2VnbWVudCA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2JpbmREYXRhU291cmNlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGJpbmREYXRhU291cmNlKHByb2R1Y2VyKSB7XG4gICAgICAgICAgICBwcm9kdWNlci5vbkRhdGFBdmFpbGFibGUgPSB0aGlzLnJlbXV4LmJpbmQodGhpcyk7XG4gICAgICAgICAgICBwcm9kdWNlci5vblRyYWNrTWV0YWRhdGEgPSB0aGlzLl9vblRyYWNrTWV0YWRhdGFSZWNlaXZlZC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBwcm90b3R5cGU6IGZ1bmN0aW9uIG9uSW5pdFNlZ21lbnQodHlwZTogc3RyaW5nLCBpbml0U2VnbWVudDogQXJyYXlCdWZmZXIpOiB2b2lkXHJcbiAgICAgICAgICAgSW5pdFNlZ21lbnQ6IHtcclxuICAgICAgICAgICAgICAgdHlwZTogc3RyaW5nLFxyXG4gICAgICAgICAgICAgICBkYXRhOiBBcnJheUJ1ZmZlcixcclxuICAgICAgICAgICAgICAgY29kZWM6IHN0cmluZyxcclxuICAgICAgICAgICAgICAgY29udGFpbmVyOiBzdHJpbmdcclxuICAgICAgICAgICB9XHJcbiAgICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnaW5zZXJ0RGlzY29udGludWl0eScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnNlcnREaXNjb250aW51aXR5KCkge1xuICAgICAgICAgICAgdGhpcy5fYXVkaW9OZXh0RHRzID0gdGhpcy5fdmlkZW9OZXh0RHRzID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzZWVrJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNlZWsob3JpZ2luYWxEdHMpIHtcbiAgICAgICAgICAgIHRoaXMuX2F1ZGlvU3Rhc2hlZExhc3RTYW1wbGUgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fdmlkZW9TdGFzaGVkTGFzdFNhbXBsZSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl92aWRlb1NlZ21lbnRJbmZvTGlzdC5jbGVhcigpO1xuICAgICAgICAgICAgdGhpcy5fYXVkaW9TZWdtZW50SW5mb0xpc3QuY2xlYXIoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVtdXgnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtdXgoYXVkaW9UcmFjaywgdmlkZW9UcmFjaykge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9vbk1lZGlhU2VnbWVudCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbignTVA0UmVtdXhlcjogb25NZWRpYVNlZ21lbnQgY2FsbGJhY2sgbXVzdCBiZSBzcGVjaWZpY2VkIScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0aGlzLl9kdHNCYXNlSW5pdGVkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY2FsY3VsYXRlRHRzQmFzZShhdWRpb1RyYWNrLCB2aWRlb1RyYWNrKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX3JlbXV4VmlkZW8odmlkZW9UcmFjayk7XG4gICAgICAgICAgICB0aGlzLl9yZW11eEF1ZGlvKGF1ZGlvVHJhY2spO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25UcmFja01ldGFkYXRhUmVjZWl2ZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uVHJhY2tNZXRhZGF0YVJlY2VpdmVkKHR5cGUsIG1ldGFkYXRhKSB7XG4gICAgICAgICAgICB2YXIgbWV0YWJveCA9IG51bGw7XG5cbiAgICAgICAgICAgIHZhciBjb250YWluZXIgPSAnbXA0JztcbiAgICAgICAgICAgIHZhciBjb2RlYyA9IG1ldGFkYXRhLmNvZGVjO1xuXG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gJ2F1ZGlvJykge1xuICAgICAgICAgICAgICAgIHRoaXMuX2F1ZGlvTWV0YSA9IG1ldGFkYXRhO1xuICAgICAgICAgICAgICAgIGlmIChtZXRhZGF0YS5jb2RlYyA9PT0gJ21wMycgJiYgdGhpcy5fbXAzVXNlTXBlZ0F1ZGlvKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vICdhdWRpby9tcGVnJyBmb3IgTVAzIGF1ZGlvIHRyYWNrXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lciA9ICdtcGVnJztcbiAgICAgICAgICAgICAgICAgICAgY29kZWMgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgbWV0YWJveCA9IG5ldyBVaW50OEFycmF5KCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gJ2F1ZGlvL21wNCwgY29kZWNzPVwiY29kZWNcIidcbiAgICAgICAgICAgICAgICAgICAgbWV0YWJveCA9IF9tcDRHZW5lcmF0b3IyLmRlZmF1bHQuZ2VuZXJhdGVJbml0U2VnbWVudChtZXRhZGF0YSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAndmlkZW8nKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdmlkZW9NZXRhID0gbWV0YWRhdGE7XG4gICAgICAgICAgICAgICAgbWV0YWJveCA9IF9tcDRHZW5lcmF0b3IyLmRlZmF1bHQuZ2VuZXJhdGVJbml0U2VnbWVudChtZXRhZGF0YSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gZGlzcGF0Y2ggbWV0YWJveCAoSW5pdGlhbGl6YXRpb24gU2VnbWVudClcbiAgICAgICAgICAgIGlmICghdGhpcy5fb25Jbml0U2VnbWVudCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbignTVA0UmVtdXhlcjogb25Jbml0U2VnbWVudCBjYWxsYmFjayBtdXN0IGJlIHNwZWNpZmllZCEnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX29uSW5pdFNlZ21lbnQodHlwZSwge1xuICAgICAgICAgICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgICAgICAgICAgZGF0YTogbWV0YWJveC5idWZmZXIsXG4gICAgICAgICAgICAgICAgY29kZWM6IGNvZGVjLFxuICAgICAgICAgICAgICAgIGNvbnRhaW5lcjogdHlwZSArICcvJyArIGNvbnRhaW5lcixcbiAgICAgICAgICAgICAgICBtZWRpYUR1cmF0aW9uOiBtZXRhZGF0YS5kdXJhdGlvbiAvLyBpbiB0aW1lc2NhbGUgMTAwMCAobWlsbGlzZWNvbmRzKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19jYWxjdWxhdGVEdHNCYXNlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9jYWxjdWxhdGVEdHNCYXNlKGF1ZGlvVHJhY2ssIHZpZGVvVHJhY2spIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9kdHNCYXNlSW5pdGVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoYXVkaW9UcmFjay5zYW1wbGVzICYmIGF1ZGlvVHJhY2suc2FtcGxlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hdWRpb0R0c0Jhc2UgPSBhdWRpb1RyYWNrLnNhbXBsZXNbMF0uZHRzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHZpZGVvVHJhY2suc2FtcGxlcyAmJiB2aWRlb1RyYWNrLnNhbXBsZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdmlkZW9EdHNCYXNlID0gdmlkZW9UcmFjay5zYW1wbGVzWzBdLmR0cztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fZHRzQmFzZSA9IE1hdGgubWluKHRoaXMuX2F1ZGlvRHRzQmFzZSwgdGhpcy5fdmlkZW9EdHNCYXNlKTtcbiAgICAgICAgICAgIHRoaXMuX2R0c0Jhc2VJbml0ZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdmbHVzaFN0YXNoZWRTYW1wbGVzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGZsdXNoU3Rhc2hlZFNhbXBsZXMoKSB7XG4gICAgICAgICAgICB2YXIgdmlkZW9TYW1wbGUgPSB0aGlzLl92aWRlb1N0YXNoZWRMYXN0U2FtcGxlO1xuICAgICAgICAgICAgdmFyIGF1ZGlvU2FtcGxlID0gdGhpcy5fYXVkaW9TdGFzaGVkTGFzdFNhbXBsZTtcblxuICAgICAgICAgICAgdmFyIHZpZGVvVHJhY2sgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3ZpZGVvJyxcbiAgICAgICAgICAgICAgICBpZDogMSxcbiAgICAgICAgICAgICAgICBzZXF1ZW5jZU51bWJlcjogMCxcbiAgICAgICAgICAgICAgICBzYW1wbGVzOiBbXSxcbiAgICAgICAgICAgICAgICBsZW5ndGg6IDBcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmICh2aWRlb1NhbXBsZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdmlkZW9UcmFjay5zYW1wbGVzLnB1c2godmlkZW9TYW1wbGUpO1xuICAgICAgICAgICAgICAgIHZpZGVvVHJhY2subGVuZ3RoID0gdmlkZW9TYW1wbGUubGVuZ3RoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgYXVkaW9UcmFjayA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnYXVkaW8nLFxuICAgICAgICAgICAgICAgIGlkOiAyLFxuICAgICAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyOiAwLFxuICAgICAgICAgICAgICAgIHNhbXBsZXM6IFtdLFxuICAgICAgICAgICAgICAgIGxlbmd0aDogMFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKGF1ZGlvU2FtcGxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBhdWRpb1RyYWNrLnNhbXBsZXMucHVzaChhdWRpb1NhbXBsZSk7XG4gICAgICAgICAgICAgICAgYXVkaW9UcmFjay5sZW5ndGggPSBhdWRpb1NhbXBsZS5sZW5ndGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3ZpZGVvU3Rhc2hlZExhc3RTYW1wbGUgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fYXVkaW9TdGFzaGVkTGFzdFNhbXBsZSA9IG51bGw7XG5cbiAgICAgICAgICAgIHRoaXMuX3JlbXV4VmlkZW8odmlkZW9UcmFjaywgdHJ1ZSk7XG4gICAgICAgICAgICB0aGlzLl9yZW11eEF1ZGlvKGF1ZGlvVHJhY2ssIHRydWUpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcmVtdXhBdWRpbycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcmVtdXhBdWRpbyhhdWRpb1RyYWNrLCBmb3JjZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2F1ZGlvTWV0YSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdHJhY2sgPSBhdWRpb1RyYWNrO1xuICAgICAgICAgICAgdmFyIHNhbXBsZXMgPSB0cmFjay5zYW1wbGVzO1xuICAgICAgICAgICAgdmFyIGR0c0NvcnJlY3Rpb24gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB2YXIgZmlyc3REdHMgPSAtMSxcbiAgICAgICAgICAgICAgICBsYXN0RHRzID0gLTEsXG4gICAgICAgICAgICAgICAgbGFzdFB0cyA9IC0xO1xuICAgICAgICAgICAgdmFyIHJlZlNhbXBsZUR1cmF0aW9uID0gdGhpcy5fYXVkaW9NZXRhLnJlZlNhbXBsZUR1cmF0aW9uO1xuXG4gICAgICAgICAgICB2YXIgbXBlZ1Jhd1RyYWNrID0gdGhpcy5fYXVkaW9NZXRhLmNvZGVjID09PSAnbXAzJyAmJiB0aGlzLl9tcDNVc2VNcGVnQXVkaW87XG4gICAgICAgICAgICB2YXIgZmlyc3RTZWdtZW50QWZ0ZXJTZWVrID0gdGhpcy5fZHRzQmFzZUluaXRlZCAmJiB0aGlzLl9hdWRpb05leHREdHMgPT09IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgdmFyIGluc2VydFByZWZpeFNpbGVudEZyYW1lID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGlmICghc2FtcGxlcyB8fCBzYW1wbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzYW1wbGVzLmxlbmd0aCA9PT0gMSAmJiAhZm9yY2UpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiBbc2FtcGxlIGNvdW50IGluIGN1cnJlbnQgYmF0Y2hdID09PSAxICYmIChmb3JjZSAhPSB0cnVlKVxuICAgICAgICAgICAgICAgIC8vIElnbm9yZSBhbmQga2VlcCBpbiBkZW11eGVyJ3MgcXVldWVcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9IC8vIGVsc2UgaWYgKGZvcmNlID09PSB0cnVlKSBkbyByZW11eFxuXG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gMDtcbiAgICAgICAgICAgIHZhciBtZGF0Ym94ID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBtZGF0Qnl0ZXMgPSAwO1xuXG4gICAgICAgICAgICAvLyBjYWxjdWxhdGUgaW5pdGlhbCBtZGF0IHNpemVcbiAgICAgICAgICAgIGlmIChtcGVnUmF3VHJhY2spIHtcbiAgICAgICAgICAgICAgICAvLyBmb3IgcmF3IG1wZWcgYnVmZmVyXG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gMDtcbiAgICAgICAgICAgICAgICBtZGF0Qnl0ZXMgPSB0cmFjay5sZW5ndGg7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGZvciBmbXA0IG1kYXQgYm94XG4gICAgICAgICAgICAgICAgb2Zmc2V0ID0gODsgLy8gc2l6ZSArIHR5cGVcbiAgICAgICAgICAgICAgICBtZGF0Qnl0ZXMgPSA4ICsgdHJhY2subGVuZ3RoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbGFzdFNhbXBsZSA9IG51bGw7XG5cbiAgICAgICAgICAgIC8vIFBvcCB0aGUgbGFzdFNhbXBsZSBhbmQgd2FpdGluZyBmb3Igc3Rhc2hcbiAgICAgICAgICAgIGlmIChzYW1wbGVzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICBsYXN0U2FtcGxlID0gc2FtcGxlcy5wb3AoKTtcbiAgICAgICAgICAgICAgICBtZGF0Qnl0ZXMgLT0gbGFzdFNhbXBsZS5sZW5ndGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEluc2VydCBbc3Rhc2hlZCBsYXN0U2FtcGxlIGluIHRoZSBwcmV2aW91cyBiYXRjaF0gdG8gdGhlIGZyb250XG4gICAgICAgICAgICBpZiAodGhpcy5fYXVkaW9TdGFzaGVkTGFzdFNhbXBsZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNhbXBsZSA9IHRoaXMuX2F1ZGlvU3Rhc2hlZExhc3RTYW1wbGU7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXVkaW9TdGFzaGVkTGFzdFNhbXBsZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgc2FtcGxlcy51bnNoaWZ0KHNhbXBsZSk7XG4gICAgICAgICAgICAgICAgbWRhdEJ5dGVzICs9IHNhbXBsZS5sZW5ndGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFN0YXNoIHRoZSBsYXN0U2FtcGxlIG9mIGN1cnJlbnQgYmF0Y2gsIHdhaXRpbmcgZm9yIG5leHQgYmF0Y2hcbiAgICAgICAgICAgIGlmIChsYXN0U2FtcGxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hdWRpb1N0YXNoZWRMYXN0U2FtcGxlID0gbGFzdFNhbXBsZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGZpcnN0U2FtcGxlT3JpZ2luYWxEdHMgPSBzYW1wbGVzWzBdLmR0cyAtIHRoaXMuX2R0c0Jhc2U7XG5cbiAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSBkdHNDb3JyZWN0aW9uXG4gICAgICAgICAgICBpZiAodGhpcy5fYXVkaW9OZXh0RHRzKSB7XG4gICAgICAgICAgICAgICAgZHRzQ29ycmVjdGlvbiA9IGZpcnN0U2FtcGxlT3JpZ2luYWxEdHMgLSB0aGlzLl9hdWRpb05leHREdHM7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIHRoaXMuX2F1ZGlvTmV4dER0cyA9PSB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYXVkaW9TZWdtZW50SW5mb0xpc3QuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGR0c0NvcnJlY3Rpb24gPSAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fZmlsbFNpbGVudEFmdGVyU2VlayAmJiAhdGhpcy5fdmlkZW9TZWdtZW50SW5mb0xpc3QuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fYXVkaW9NZXRhLm9yaWdpbmFsQ29kZWMgIT09ICdtcDMnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zZXJ0UHJlZml4U2lsZW50RnJhbWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9sYXN0U2FtcGxlID0gdGhpcy5fYXVkaW9TZWdtZW50SW5mb0xpc3QuZ2V0TGFzdFNhbXBsZUJlZm9yZShmaXJzdFNhbXBsZU9yaWdpbmFsRHRzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9sYXN0U2FtcGxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaXN0YW5jZSA9IGZpcnN0U2FtcGxlT3JpZ2luYWxEdHMgLSAoX2xhc3RTYW1wbGUub3JpZ2luYWxEdHMgKyBfbGFzdFNhbXBsZS5kdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGlzdGFuY2UgPD0gMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3RhbmNlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBleHBlY3RlZER0cyA9IF9sYXN0U2FtcGxlLmR0cyArIF9sYXN0U2FtcGxlLmR1cmF0aW9uICsgZGlzdGFuY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBkdHNDb3JyZWN0aW9uID0gZmlyc3RTYW1wbGVPcmlnaW5hbER0cyAtIGV4cGVjdGVkRHRzO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbGFzdFNhbXBsZSA9PSBudWxsLCBjYW5ub3QgZm91bmRcbiAgICAgICAgICAgICAgICAgICAgICAgIGR0c0NvcnJlY3Rpb24gPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaW5zZXJ0UHJlZml4U2lsZW50RnJhbWUpIHtcbiAgICAgICAgICAgICAgICAvLyBhbGlnbiBhdWRpbyBzZWdtZW50IGJlZ2luRHRzIHRvIG1hdGNoIHdpdGggY3VycmVudCB2aWRlbyBzZWdtZW50J3MgYmVnaW5EdHNcbiAgICAgICAgICAgICAgICB2YXIgZmlyc3RTYW1wbGVEdHMgPSBmaXJzdFNhbXBsZU9yaWdpbmFsRHRzIC0gZHRzQ29ycmVjdGlvbjtcbiAgICAgICAgICAgICAgICB2YXIgdmlkZW9TZWdtZW50ID0gdGhpcy5fdmlkZW9TZWdtZW50SW5mb0xpc3QuZ2V0TGFzdFNlZ21lbnRCZWZvcmUoZmlyc3RTYW1wbGVPcmlnaW5hbER0cyk7XG4gICAgICAgICAgICAgICAgaWYgKHZpZGVvU2VnbWVudCAhPSBudWxsICYmIHZpZGVvU2VnbWVudC5iZWdpbkR0cyA8IGZpcnN0U2FtcGxlRHRzKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaWxlbnRVbml0ID0gX2FhY1NpbGVudDIuZGVmYXVsdC5nZXRTaWxlbnRGcmFtZSh0aGlzLl9hdWRpb01ldGEub3JpZ2luYWxDb2RlYywgdGhpcy5fYXVkaW9NZXRhLmNoYW5uZWxDb3VudCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzaWxlbnRVbml0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHRzID0gdmlkZW9TZWdtZW50LmJlZ2luRHRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNpbGVudEZyYW1lRHVyYXRpb24gPSBmaXJzdFNhbXBsZUR0cyAtIHZpZGVvU2VnbWVudC5iZWdpbkR0cztcbiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudih0aGlzLlRBRywgJ0luc2VydFByZWZpeFNpbGVudEF1ZGlvOiBkdHM6ICcgKyBkdHMgKyAnLCBkdXJhdGlvbjogJyArIHNpbGVudEZyYW1lRHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2FtcGxlcy51bnNoaWZ0KHsgdW5pdDogc2lsZW50VW5pdCwgZHRzOiBkdHMsIHB0czogZHRzIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWRhdEJ5dGVzICs9IHNpbGVudFVuaXQuYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgfSAvLyBzaWxlbnRVbml0ID09IG51bGw6IENhbm5vdCBnZW5lcmF0ZSwgc2tpcFxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGluc2VydFByZWZpeFNpbGVudEZyYW1lID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbXA0U2FtcGxlcyA9IFtdO1xuXG4gICAgICAgICAgICAvLyBDb3JyZWN0IGR0cyBmb3IgZWFjaCBzYW1wbGUsIGFuZCBjYWxjdWxhdGUgc2FtcGxlIGR1cmF0aW9uLiBUaGVuIG91dHB1dCB0byBtcDRTYW1wbGVzXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNhbXBsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgX3NhbXBsZSA9IHNhbXBsZXNbaV07XG4gICAgICAgICAgICAgICAgdmFyIHVuaXQgPSBfc2FtcGxlLnVuaXQ7XG4gICAgICAgICAgICAgICAgdmFyIG9yaWdpbmFsRHRzID0gX3NhbXBsZS5kdHMgLSB0aGlzLl9kdHNCYXNlO1xuICAgICAgICAgICAgICAgIHZhciBfZHRzID0gb3JpZ2luYWxEdHM7XG4gICAgICAgICAgICAgICAgdmFyIG5lZWRGaWxsU2lsZW50RnJhbWVzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdmFyIHNpbGVudEZyYW1lcyA9IG51bGw7XG4gICAgICAgICAgICAgICAgdmFyIHNhbXBsZUR1cmF0aW9uID0gMDtcblxuICAgICAgICAgICAgICAgIGlmIChvcmlnaW5hbER0cyA8IC0wLjAwMSkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsgLy9wYXNzIHRoZSBmaXJzdCBzYW1wbGUgd2l0aCB0aGUgaW52YWxpZCBkdHNcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYXVkaW9NZXRhLmNvZGVjICE9PSAnbXAzJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBmb3IgQUFDIGNvZGVjLCB3ZSBuZWVkIHRvIGtlZXAgZHRzIGluY3JlYXNlIGJhc2VkIG9uIHJlZlNhbXBsZUR1cmF0aW9uXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJSZWZEdHMgPSBvcmlnaW5hbER0cztcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1heEF1ZGlvRnJhbWVzRHJpZnQgPSAzO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fYXVkaW9OZXh0RHRzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJSZWZEdHMgPSB0aGlzLl9hdWRpb05leHREdHM7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBkdHNDb3JyZWN0aW9uID0gb3JpZ2luYWxEdHMgLSBjdXJSZWZEdHM7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkdHNDb3JyZWN0aW9uIDw9IC1tYXhBdWRpb0ZyYW1lc0RyaWZ0ICogcmVmU2FtcGxlRHVyYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHdlJ3JlIG92ZXJsYXBwaW5nIGJ5IG1vcmUgdGhhbiBtYXhBdWRpb0ZyYW1lc0RyaWZ0IG51bWJlciBvZiBmcmFtZSwgZHJvcCB0aGlzIHNhbXBsZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy9Mb2cudyh0aGlzLlRBRywgYERyb3BwaW5nIDEgYXVkaW8gZnJhbWUgKG9yaWdpbmFsRHRzOiAke29yaWdpbmFsRHRzfSBtcyAsY3VyUmVmRHRzOiAke2N1clJlZkR0c30gbXMpICBkdWUgdG8gZHRzQ29ycmVjdGlvbjogJHtkdHNDb3JyZWN0aW9ufSBtcyBvdmVybGFwLmApO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZHRzQ29ycmVjdGlvbiA+PSBtYXhBdWRpb0ZyYW1lc0RyaWZ0ICogcmVmU2FtcGxlRHVyYXRpb24gJiYgdGhpcy5fZmlsbEF1ZGlvVGltZXN0YW1wR2FwICYmICFfYnJvd3NlcjIuZGVmYXVsdC5zYWZhcmkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNpbGVudCBmcmFtZSBnZW5lcmF0aW9uLCBpZiBsYXJnZSB0aW1lc3RhbXAgZ2FwIGRldGVjdGVkICYmIGNvbmZpZy5maXhBdWRpb1RpbWVzdGFtcEdhcFxuICAgICAgICAgICAgICAgICAgICAgICAgbmVlZEZpbGxTaWxlbnRGcmFtZXMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byBpbnNlcnQgc2lsZW50IGZyYW1lcyB0byBmaWxsIHRpbWVzdGFtcCBnYXBcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmcmFtZUNvdW50ID0gTWF0aC5mbG9vcihkdHNDb3JyZWN0aW9uIC8gcmVmU2FtcGxlRHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnTGFyZ2UgYXVkaW8gdGltZXN0YW1wIGdhcCBkZXRlY3RlZCwgbWF5IGNhdXNlIEFWIHN5bmMgdG8gZHJpZnQuICcgKyAnU2lsZW50IGZyYW1lcyB3aWxsIGJlIGdlbmVyYXRlZCB0byBhdm9pZCB1bnN5bmMuXFxuJyArICgnb3JpZ2luYWxEdHM6ICcgKyBvcmlnaW5hbER0cyArICcgbXMsIGN1clJlZkR0czogJyArIGN1clJlZkR0cyArICcgbXMsICcpICsgKCdkdHNDb3JyZWN0aW9uOiAnICsgTWF0aC5yb3VuZChkdHNDb3JyZWN0aW9uKSArICcgbXMsIGdlbmVyYXRlOiAnICsgZnJhbWVDb3VudCArICcgZnJhbWVzJykpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBfZHRzID0gTWF0aC5mbG9vcihjdXJSZWZEdHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2FtcGxlRHVyYXRpb24gPSBNYXRoLmZsb29yKGN1clJlZkR0cyArIHJlZlNhbXBsZUR1cmF0aW9uKSAtIF9kdHM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfc2lsZW50VW5pdCA9IF9hYWNTaWxlbnQyLmRlZmF1bHQuZ2V0U2lsZW50RnJhbWUodGhpcy5fYXVkaW9NZXRhLm9yaWdpbmFsQ29kZWMsIHRoaXMuX2F1ZGlvTWV0YS5jaGFubmVsQ291bnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9zaWxlbnRVbml0ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdVbmFibGUgdG8gZ2VuZXJhdGUgc2lsZW50IGZyYW1lIGZvciAnICsgKHRoaXMuX2F1ZGlvTWV0YS5vcmlnaW5hbENvZGVjICsgJyB3aXRoICcgKyB0aGlzLl9hdWRpb01ldGEuY2hhbm5lbENvdW50ICsgJyBjaGFubmVscywgcmVwZWF0IGxhc3QgZnJhbWUnKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVwZWF0IGxhc3QgZnJhbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc2lsZW50VW5pdCA9IHVuaXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBzaWxlbnRGcmFtZXMgPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBmcmFtZUNvdW50OyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJSZWZEdHMgPSBjdXJSZWZEdHMgKyByZWZTYW1wbGVEdXJhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW50RHRzID0gTWF0aC5mbG9vcihjdXJSZWZEdHMpOyAvLyBjaGFuZ2UgdG8gaW50ZWdlclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbnREdXJhdGlvbiA9IE1hdGguZmxvb3IoY3VyUmVmRHRzICsgcmVmU2FtcGxlRHVyYXRpb24pIC0gaW50RHRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmcmFtZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHRzOiBpbnREdHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB0czogaW50RHRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHM6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVuaXQ6IF9zaWxlbnRVbml0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBfc2lsZW50VW5pdC5ieXRlTGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogaW50RHVyYXRpb24sIC8vIHdhaXQgZm9yIG5leHQgc2FtcGxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsRHRzOiBvcmlnaW5hbER0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmxhZ3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzTGVhZGluZzogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlcGVuZHNPbjogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzRGVwZW5kZWRPbjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc1JlZHVuZGFuY3k6IDBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2lsZW50RnJhbWVzLnB1c2goZnJhbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1kYXRCeXRlcyArPSBmcmFtZS5zaXplO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hdWRpb05leHREdHMgPSBjdXJSZWZEdHMgKyByZWZTYW1wbGVEdXJhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2R0cyA9IE1hdGguZmxvb3IoY3VyUmVmRHRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhbXBsZUR1cmF0aW9uID0gTWF0aC5mbG9vcihjdXJSZWZEdHMgKyByZWZTYW1wbGVEdXJhdGlvbikgLSBfZHRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXVkaW9OZXh0RHRzID0gY3VyUmVmRHRzICsgcmVmU2FtcGxlRHVyYXRpb247XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBrZWVwIHRoZSBvcmlnaW5hbCBkdHMgY2FsY3VsYXRlIGFsZ29yaXRobSBmb3IgbXAzXG4gICAgICAgICAgICAgICAgICAgIF9kdHMgPSBvcmlnaW5hbER0cyAtIGR0c0NvcnJlY3Rpb247XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgIT09IHNhbXBsZXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5leHREdHMgPSBzYW1wbGVzW2kgKyAxXS5kdHMgLSB0aGlzLl9kdHNCYXNlIC0gZHRzQ29ycmVjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhbXBsZUR1cmF0aW9uID0gbmV4dER0cyAtIF9kdHM7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbGFzdCBzYW1wbGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsYXN0U2FtcGxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB1c2Ugc3Rhc2hlZCBzYW1wbGUncyBkdHMgdG8gY2FsY3VsYXRlIHNhbXBsZSBkdXJhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfbmV4dER0cyA9IGxhc3RTYW1wbGUuZHRzIC0gdGhpcy5fZHRzQmFzZSAtIGR0c0NvcnJlY3Rpb247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FtcGxlRHVyYXRpb24gPSBfbmV4dER0cyAtIF9kdHM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1wNFNhbXBsZXMubGVuZ3RoID49IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB1c2Ugc2Vjb25kIGxhc3Qgc2FtcGxlIGR1cmF0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FtcGxlRHVyYXRpb24gPSBtcDRTYW1wbGVzW21wNFNhbXBsZXMubGVuZ3RoIC0gMV0uZHVyYXRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBvbmx5IG9uZSBzYW1wbGUsIHVzZSByZWZlcmVuY2Ugc2FtcGxlIGR1cmF0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2FtcGxlRHVyYXRpb24gPSBNYXRoLmZsb29yKHJlZlNhbXBsZUR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hdWRpb05leHREdHMgPSBfZHRzICsgc2FtcGxlRHVyYXRpb247XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGZpcnN0RHRzID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBmaXJzdER0cyA9IF9kdHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG1wNFNhbXBsZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGR0czogX2R0cyxcbiAgICAgICAgICAgICAgICAgICAgcHRzOiBfZHRzLFxuICAgICAgICAgICAgICAgICAgICBjdHM6IDAsXG4gICAgICAgICAgICAgICAgICAgIHVuaXQ6IF9zYW1wbGUudW5pdCxcbiAgICAgICAgICAgICAgICAgICAgc2l6ZTogX3NhbXBsZS51bml0LmJ5dGVMZW5ndGgsXG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBzYW1wbGVEdXJhdGlvbixcbiAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxEdHM6IG9yaWdpbmFsRHRzLFxuICAgICAgICAgICAgICAgICAgICBmbGFnczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXNMZWFkaW5nOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVwZW5kc09uOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNEZXBlbmRlZE9uOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGFzUmVkdW5kYW5jeTogMFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBpZiAobmVlZEZpbGxTaWxlbnRGcmFtZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gU2lsZW50IGZyYW1lcyBzaG91bGQgYmUgaW5zZXJ0ZWQgYWZ0ZXIgd3JvbmctZHVyYXRpb24gZnJhbWVcbiAgICAgICAgICAgICAgICAgICAgbXA0U2FtcGxlcy5wdXNoLmFwcGx5KG1wNFNhbXBsZXMsIHNpbGVudEZyYW1lcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobXA0U2FtcGxlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAvL25vIHNhbXBsZXMgbmVlZCB0byByZW11eFxuICAgICAgICAgICAgICAgIHRyYWNrLnNhbXBsZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB0cmFjay5sZW5ndGggPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYWxsb2NhdGUgbWRhdGJveFxuICAgICAgICAgICAgaWYgKG1wZWdSYXdUcmFjaykge1xuICAgICAgICAgICAgICAgIC8vIGFsbG9jYXRlIGZvciByYXcgbXBlZyBidWZmZXJcbiAgICAgICAgICAgICAgICBtZGF0Ym94ID0gbmV3IFVpbnQ4QXJyYXkobWRhdEJ5dGVzKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gYWxsb2NhdGUgZm9yIGZtcDQgbWRhdCBib3hcbiAgICAgICAgICAgICAgICBtZGF0Ym94ID0gbmV3IFVpbnQ4QXJyYXkobWRhdEJ5dGVzKTtcbiAgICAgICAgICAgICAgICAvLyBzaXplIGZpZWxkXG4gICAgICAgICAgICAgICAgbWRhdGJveFswXSA9IG1kYXRCeXRlcyA+Pj4gMjQgJiAweEZGO1xuICAgICAgICAgICAgICAgIG1kYXRib3hbMV0gPSBtZGF0Qnl0ZXMgPj4+IDE2ICYgMHhGRjtcbiAgICAgICAgICAgICAgICBtZGF0Ym94WzJdID0gbWRhdEJ5dGVzID4+PiA4ICYgMHhGRjtcbiAgICAgICAgICAgICAgICBtZGF0Ym94WzNdID0gbWRhdEJ5dGVzICYgMHhGRjtcbiAgICAgICAgICAgICAgICAvLyB0eXBlIGZpZWxkIChmb3VyQ0MpXG4gICAgICAgICAgICAgICAgbWRhdGJveC5zZXQoX21wNEdlbmVyYXRvcjIuZGVmYXVsdC50eXBlcy5tZGF0LCA0KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gV3JpdGUgc2FtcGxlcyBpbnRvIG1kYXRib3hcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBtcDRTYW1wbGVzLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIHZhciBfdW5pdCA9IG1wNFNhbXBsZXNbX2ldLnVuaXQ7XG4gICAgICAgICAgICAgICAgbWRhdGJveC5zZXQoX3VuaXQsIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgb2Zmc2V0ICs9IF91bml0LmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBsYXRlc3QgPSBtcDRTYW1wbGVzW21wNFNhbXBsZXMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICBsYXN0RHRzID0gbGF0ZXN0LmR0cyArIGxhdGVzdC5kdXJhdGlvbjtcbiAgICAgICAgICAgIC8vdGhpcy5fYXVkaW9OZXh0RHRzID0gbGFzdER0cztcblxuICAgICAgICAgICAgLy8gZmlsbCBtZWRpYSBzZWdtZW50IGluZm8gJiBhZGQgdG8gaW5mbyBsaXN0XG4gICAgICAgICAgICB2YXIgaW5mbyA9IG5ldyBfbWVkaWFTZWdtZW50SW5mby5NZWRpYVNlZ21lbnRJbmZvKCk7XG4gICAgICAgICAgICBpbmZvLmJlZ2luRHRzID0gZmlyc3REdHM7XG4gICAgICAgICAgICBpbmZvLmVuZER0cyA9IGxhc3REdHM7XG4gICAgICAgICAgICBpbmZvLmJlZ2luUHRzID0gZmlyc3REdHM7XG4gICAgICAgICAgICBpbmZvLmVuZFB0cyA9IGxhc3REdHM7XG4gICAgICAgICAgICBpbmZvLm9yaWdpbmFsQmVnaW5EdHMgPSBtcDRTYW1wbGVzWzBdLm9yaWdpbmFsRHRzO1xuICAgICAgICAgICAgaW5mby5vcmlnaW5hbEVuZER0cyA9IGxhdGVzdC5vcmlnaW5hbER0cyArIGxhdGVzdC5kdXJhdGlvbjtcbiAgICAgICAgICAgIGluZm8uZmlyc3RTYW1wbGUgPSBuZXcgX21lZGlhU2VnbWVudEluZm8uU2FtcGxlSW5mbyhtcDRTYW1wbGVzWzBdLmR0cywgbXA0U2FtcGxlc1swXS5wdHMsIG1wNFNhbXBsZXNbMF0uZHVyYXRpb24sIG1wNFNhbXBsZXNbMF0ub3JpZ2luYWxEdHMsIGZhbHNlKTtcbiAgICAgICAgICAgIGluZm8ubGFzdFNhbXBsZSA9IG5ldyBfbWVkaWFTZWdtZW50SW5mby5TYW1wbGVJbmZvKGxhdGVzdC5kdHMsIGxhdGVzdC5wdHMsIGxhdGVzdC5kdXJhdGlvbiwgbGF0ZXN0Lm9yaWdpbmFsRHRzLCBmYWxzZSk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX2lzTGl2ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2F1ZGlvU2VnbWVudEluZm9MaXN0LmFwcGVuZChpbmZvKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdHJhY2suc2FtcGxlcyA9IG1wNFNhbXBsZXM7XG4gICAgICAgICAgICB0cmFjay5zZXF1ZW5jZU51bWJlcisrO1xuXG4gICAgICAgICAgICB2YXIgbW9vZmJveCA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmIChtcGVnUmF3VHJhY2spIHtcbiAgICAgICAgICAgICAgICAvLyBHZW5lcmF0ZSBlbXB0eSBidWZmZXIsIGJlY2F1c2UgdXNlbGVzcyBmb3IgcmF3IG1wZWdcbiAgICAgICAgICAgICAgICBtb29mYm94ID0gbmV3IFVpbnQ4QXJyYXkoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gR2VuZXJhdGUgbW9vZiBmb3IgZm1wNCBzZWdtZW50XG4gICAgICAgICAgICAgICAgbW9vZmJveCA9IF9tcDRHZW5lcmF0b3IyLmRlZmF1bHQubW9vZih0cmFjaywgZmlyc3REdHMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0cmFjay5zYW1wbGVzID0gW107XG4gICAgICAgICAgICB0cmFjay5sZW5ndGggPSAwO1xuXG4gICAgICAgICAgICB2YXIgc2VnbWVudCA9IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnYXVkaW8nLFxuICAgICAgICAgICAgICAgIGRhdGE6IHRoaXMuX21lcmdlQm94ZXMobW9vZmJveCwgbWRhdGJveCkuYnVmZmVyLFxuICAgICAgICAgICAgICAgIHNhbXBsZUNvdW50OiBtcDRTYW1wbGVzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBpbmZvOiBpbmZvXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAobXBlZ1Jhd1RyYWNrICYmIGZpcnN0U2VnbWVudEFmdGVyU2Vlaykge1xuICAgICAgICAgICAgICAgIC8vIEZvciBNUEVHIGF1ZGlvIHN0cmVhbSBpbiBNU0UsIGlmIHNlZWtpbmcgb2NjdXJyZWQsIGJlZm9yZSBhcHBlbmRpbmcgbmV3IGJ1ZmZlclxuICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgZXhwbGljaXRseSBzZXQgdGltZXN0YW1wT2Zmc2V0IHRvIHRoZSBkZXNpcmVkIHBvaW50IGluIHRpbWVsaW5lIGZvciBtcGVnIFNvdXJjZUJ1ZmZlci5cbiAgICAgICAgICAgICAgICBzZWdtZW50LnRpbWVzdGFtcE9mZnNldCA9IGZpcnN0RHRzO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9vbk1lZGlhU2VnbWVudCgnYXVkaW8nLCBzZWdtZW50KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3JlbXV4VmlkZW8nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbXV4VmlkZW8odmlkZW9UcmFjaywgZm9yY2UpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl92aWRlb01ldGEgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHRyYWNrID0gdmlkZW9UcmFjaztcbiAgICAgICAgICAgIHZhciBzYW1wbGVzID0gdHJhY2suc2FtcGxlcztcbiAgICAgICAgICAgIHZhciBkdHNDb3JyZWN0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdmFyIGZpcnN0RHRzID0gLTEsXG4gICAgICAgICAgICAgICAgbGFzdER0cyA9IC0xO1xuICAgICAgICAgICAgdmFyIGZpcnN0UHRzID0gLTEsXG4gICAgICAgICAgICAgICAgbGFzdFB0cyA9IC0xO1xuXG4gICAgICAgICAgICBpZiAoIXNhbXBsZXMgfHwgc2FtcGxlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2FtcGxlcy5sZW5ndGggPT09IDEgJiYgIWZvcmNlKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgW3NhbXBsZSBjb3VudCBpbiBjdXJyZW50IGJhdGNoXSA9PT0gMSAmJiAoZm9yY2UgIT0gdHJ1ZSlcbiAgICAgICAgICAgICAgICAvLyBJZ25vcmUgYW5kIGtlZXAgaW4gZGVtdXhlcidzIHF1ZXVlXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSAvLyBlbHNlIGlmIChmb3JjZSA9PT0gdHJ1ZSkgZG8gcmVtdXhcblxuICAgICAgICAgICAgdmFyIG9mZnNldCA9IDg7XG4gICAgICAgICAgICB2YXIgbWRhdGJveCA9IG51bGw7XG4gICAgICAgICAgICB2YXIgbWRhdEJ5dGVzID0gOCArIHZpZGVvVHJhY2subGVuZ3RoO1xuXG4gICAgICAgICAgICB2YXIgbGFzdFNhbXBsZSA9IG51bGw7XG5cbiAgICAgICAgICAgIC8vIFBvcCB0aGUgbGFzdFNhbXBsZSBhbmQgd2FpdGluZyBmb3Igc3Rhc2hcbiAgICAgICAgICAgIGlmIChzYW1wbGVzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICBsYXN0U2FtcGxlID0gc2FtcGxlcy5wb3AoKTtcbiAgICAgICAgICAgICAgICBtZGF0Qnl0ZXMgLT0gbGFzdFNhbXBsZS5sZW5ndGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIEluc2VydCBbc3Rhc2hlZCBsYXN0U2FtcGxlIGluIHRoZSBwcmV2aW91cyBiYXRjaF0gdG8gdGhlIGZyb250XG4gICAgICAgICAgICBpZiAodGhpcy5fdmlkZW9TdGFzaGVkTGFzdFNhbXBsZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNhbXBsZSA9IHRoaXMuX3ZpZGVvU3Rhc2hlZExhc3RTYW1wbGU7XG4gICAgICAgICAgICAgICAgdGhpcy5fdmlkZW9TdGFzaGVkTGFzdFNhbXBsZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgc2FtcGxlcy51bnNoaWZ0KHNhbXBsZSk7XG4gICAgICAgICAgICAgICAgbWRhdEJ5dGVzICs9IHNhbXBsZS5sZW5ndGg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFN0YXNoIHRoZSBsYXN0U2FtcGxlIG9mIGN1cnJlbnQgYmF0Y2gsIHdhaXRpbmcgZm9yIG5leHQgYmF0Y2hcbiAgICAgICAgICAgIGlmIChsYXN0U2FtcGxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl92aWRlb1N0YXNoZWRMYXN0U2FtcGxlID0gbGFzdFNhbXBsZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGZpcnN0U2FtcGxlT3JpZ2luYWxEdHMgPSBzYW1wbGVzWzBdLmR0cyAtIHRoaXMuX2R0c0Jhc2U7XG5cbiAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSBkdHNDb3JyZWN0aW9uXG4gICAgICAgICAgICBpZiAodGhpcy5fdmlkZW9OZXh0RHRzKSB7XG4gICAgICAgICAgICAgICAgZHRzQ29ycmVjdGlvbiA9IGZpcnN0U2FtcGxlT3JpZ2luYWxEdHMgLSB0aGlzLl92aWRlb05leHREdHM7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIHRoaXMuX3ZpZGVvTmV4dER0cyA9PSB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fdmlkZW9TZWdtZW50SW5mb0xpc3QuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGR0c0NvcnJlY3Rpb24gPSAwO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfbGFzdFNhbXBsZTIgPSB0aGlzLl92aWRlb1NlZ21lbnRJbmZvTGlzdC5nZXRMYXN0U2FtcGxlQmVmb3JlKGZpcnN0U2FtcGxlT3JpZ2luYWxEdHMpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoX2xhc3RTYW1wbGUyICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaXN0YW5jZSA9IGZpcnN0U2FtcGxlT3JpZ2luYWxEdHMgLSAoX2xhc3RTYW1wbGUyLm9yaWdpbmFsRHRzICsgX2xhc3RTYW1wbGUyLmR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkaXN0YW5jZSA8PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzdGFuY2UgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV4cGVjdGVkRHRzID0gX2xhc3RTYW1wbGUyLmR0cyArIF9sYXN0U2FtcGxlMi5kdXJhdGlvbiArIGRpc3RhbmNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZHRzQ29ycmVjdGlvbiA9IGZpcnN0U2FtcGxlT3JpZ2luYWxEdHMgLSBleHBlY3RlZER0cztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxhc3RTYW1wbGUgPT0gbnVsbCwgY2Fubm90IGZvdW5kXG4gICAgICAgICAgICAgICAgICAgICAgICBkdHNDb3JyZWN0aW9uID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGluZm8gPSBuZXcgX21lZGlhU2VnbWVudEluZm8uTWVkaWFTZWdtZW50SW5mbygpO1xuICAgICAgICAgICAgdmFyIG1wNFNhbXBsZXMgPSBbXTtcblxuICAgICAgICAgICAgLy8gQ29ycmVjdCBkdHMgZm9yIGVhY2ggc2FtcGxlLCBhbmQgY2FsY3VsYXRlIHNhbXBsZSBkdXJhdGlvbi4gVGhlbiBvdXRwdXQgdG8gbXA0U2FtcGxlc1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzYW1wbGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9zYW1wbGUyID0gc2FtcGxlc1tpXTtcbiAgICAgICAgICAgICAgICB2YXIgb3JpZ2luYWxEdHMgPSBfc2FtcGxlMi5kdHMgLSB0aGlzLl9kdHNCYXNlO1xuICAgICAgICAgICAgICAgIHZhciBpc0tleWZyYW1lID0gX3NhbXBsZTIuaXNLZXlmcmFtZTtcbiAgICAgICAgICAgICAgICB2YXIgZHRzID0gb3JpZ2luYWxEdHMgLSBkdHNDb3JyZWN0aW9uO1xuICAgICAgICAgICAgICAgIHZhciBjdHMgPSBfc2FtcGxlMi5jdHM7XG4gICAgICAgICAgICAgICAgdmFyIHB0cyA9IGR0cyArIGN0cztcblxuICAgICAgICAgICAgICAgIGlmIChmaXJzdER0cyA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgZmlyc3REdHMgPSBkdHM7XG4gICAgICAgICAgICAgICAgICAgIGZpcnN0UHRzID0gcHRzO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBzYW1wbGVEdXJhdGlvbiA9IDA7XG5cbiAgICAgICAgICAgICAgICBpZiAoaSAhPT0gc2FtcGxlcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXh0RHRzID0gc2FtcGxlc1tpICsgMV0uZHRzIC0gdGhpcy5fZHRzQmFzZSAtIGR0c0NvcnJlY3Rpb247XG4gICAgICAgICAgICAgICAgICAgIHNhbXBsZUR1cmF0aW9uID0gbmV4dER0cyAtIGR0cztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbGFzdCBzYW1wbGVcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxhc3RTYW1wbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXNlIHN0YXNoZWQgc2FtcGxlJ3MgZHRzIHRvIGNhbGN1bGF0ZSBzYW1wbGUgZHVyYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfbmV4dER0czIgPSBsYXN0U2FtcGxlLmR0cyAtIHRoaXMuX2R0c0Jhc2UgLSBkdHNDb3JyZWN0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2FtcGxlRHVyYXRpb24gPSBfbmV4dER0czIgLSBkdHM7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobXA0U2FtcGxlcy5sZW5ndGggPj0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXNlIHNlY29uZCBsYXN0IHNhbXBsZSBkdXJhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgc2FtcGxlRHVyYXRpb24gPSBtcDRTYW1wbGVzW21wNFNhbXBsZXMubGVuZ3RoIC0gMV0uZHVyYXRpb247XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgb25seSBvbmUgc2FtcGxlLCB1c2UgcmVmZXJlbmNlIHNhbXBsZSBkdXJhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgc2FtcGxlRHVyYXRpb24gPSBNYXRoLmZsb29yKHRoaXMuX3ZpZGVvTWV0YS5yZWZTYW1wbGVEdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoaXNLZXlmcmFtZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3luY1BvaW50ID0gbmV3IF9tZWRpYVNlZ21lbnRJbmZvLlNhbXBsZUluZm8oZHRzLCBwdHMsIHNhbXBsZUR1cmF0aW9uLCBfc2FtcGxlMi5kdHMsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICBzeW5jUG9pbnQuZmlsZXBvc2l0aW9uID0gX3NhbXBsZTIuZmlsZXBvc2l0aW9uO1xuICAgICAgICAgICAgICAgICAgICBpbmZvLmFwcGVuZFN5bmNQb2ludChzeW5jUG9pbnQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG1wNFNhbXBsZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGR0czogZHRzLFxuICAgICAgICAgICAgICAgICAgICBwdHM6IHB0cyxcbiAgICAgICAgICAgICAgICAgICAgY3RzOiBjdHMsXG4gICAgICAgICAgICAgICAgICAgIHVuaXRzOiBfc2FtcGxlMi51bml0cyxcbiAgICAgICAgICAgICAgICAgICAgc2l6ZTogX3NhbXBsZTIubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICBpc0tleWZyYW1lOiBpc0tleWZyYW1lLFxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogc2FtcGxlRHVyYXRpb24sXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsRHRzOiBvcmlnaW5hbER0cyxcbiAgICAgICAgICAgICAgICAgICAgZmxhZ3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzTGVhZGluZzogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlcGVuZHNPbjogaXNLZXlmcmFtZSA/IDIgOiAxLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNEZXBlbmRlZE9uOiBpc0tleWZyYW1lID8gMSA6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBoYXNSZWR1bmRhbmN5OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXNOb25TeW5jOiBpc0tleWZyYW1lID8gMCA6IDFcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBhbGxvY2F0ZSBtZGF0Ym94XG4gICAgICAgICAgICBtZGF0Ym94ID0gbmV3IFVpbnQ4QXJyYXkobWRhdEJ5dGVzKTtcbiAgICAgICAgICAgIG1kYXRib3hbMF0gPSBtZGF0Qnl0ZXMgPj4+IDI0ICYgMHhGRjtcbiAgICAgICAgICAgIG1kYXRib3hbMV0gPSBtZGF0Qnl0ZXMgPj4+IDE2ICYgMHhGRjtcbiAgICAgICAgICAgIG1kYXRib3hbMl0gPSBtZGF0Qnl0ZXMgPj4+IDggJiAweEZGO1xuICAgICAgICAgICAgbWRhdGJveFszXSA9IG1kYXRCeXRlcyAmIDB4RkY7XG4gICAgICAgICAgICBtZGF0Ym94LnNldChfbXA0R2VuZXJhdG9yMi5kZWZhdWx0LnR5cGVzLm1kYXQsIDQpO1xuXG4gICAgICAgICAgICAvLyBXcml0ZSBzYW1wbGVzIGludG8gbWRhdGJveFxuICAgICAgICAgICAgZm9yICh2YXIgX2kyID0gMDsgX2kyIDwgbXA0U2FtcGxlcy5sZW5ndGg7IF9pMisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHVuaXRzID0gbXA0U2FtcGxlc1tfaTJdLnVuaXRzO1xuICAgICAgICAgICAgICAgIHdoaWxlICh1bml0cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVuaXQgPSB1bml0cy5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHVuaXQuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgbWRhdGJveC5zZXQoZGF0YSwgb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IGRhdGEuYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBsYXRlc3QgPSBtcDRTYW1wbGVzW21wNFNhbXBsZXMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICBsYXN0RHRzID0gbGF0ZXN0LmR0cyArIGxhdGVzdC5kdXJhdGlvbjtcbiAgICAgICAgICAgIGxhc3RQdHMgPSBsYXRlc3QucHRzICsgbGF0ZXN0LmR1cmF0aW9uO1xuICAgICAgICAgICAgdGhpcy5fdmlkZW9OZXh0RHRzID0gbGFzdER0cztcblxuICAgICAgICAgICAgLy8gZmlsbCBtZWRpYSBzZWdtZW50IGluZm8gJiBhZGQgdG8gaW5mbyBsaXN0XG4gICAgICAgICAgICBpbmZvLmJlZ2luRHRzID0gZmlyc3REdHM7XG4gICAgICAgICAgICBpbmZvLmVuZER0cyA9IGxhc3REdHM7XG4gICAgICAgICAgICBpbmZvLmJlZ2luUHRzID0gZmlyc3RQdHM7XG4gICAgICAgICAgICBpbmZvLmVuZFB0cyA9IGxhc3RQdHM7XG4gICAgICAgICAgICBpbmZvLm9yaWdpbmFsQmVnaW5EdHMgPSBtcDRTYW1wbGVzWzBdLm9yaWdpbmFsRHRzO1xuICAgICAgICAgICAgaW5mby5vcmlnaW5hbEVuZER0cyA9IGxhdGVzdC5vcmlnaW5hbER0cyArIGxhdGVzdC5kdXJhdGlvbjtcbiAgICAgICAgICAgIGluZm8uZmlyc3RTYW1wbGUgPSBuZXcgX21lZGlhU2VnbWVudEluZm8uU2FtcGxlSW5mbyhtcDRTYW1wbGVzWzBdLmR0cywgbXA0U2FtcGxlc1swXS5wdHMsIG1wNFNhbXBsZXNbMF0uZHVyYXRpb24sIG1wNFNhbXBsZXNbMF0ub3JpZ2luYWxEdHMsIG1wNFNhbXBsZXNbMF0uaXNLZXlmcmFtZSk7XG4gICAgICAgICAgICBpbmZvLmxhc3RTYW1wbGUgPSBuZXcgX21lZGlhU2VnbWVudEluZm8uU2FtcGxlSW5mbyhsYXRlc3QuZHRzLCBsYXRlc3QucHRzLCBsYXRlc3QuZHVyYXRpb24sIGxhdGVzdC5vcmlnaW5hbER0cywgbGF0ZXN0LmlzS2V5ZnJhbWUpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9pc0xpdmUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl92aWRlb1NlZ21lbnRJbmZvTGlzdC5hcHBlbmQoaW5mbyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRyYWNrLnNhbXBsZXMgPSBtcDRTYW1wbGVzO1xuICAgICAgICAgICAgdHJhY2suc2VxdWVuY2VOdW1iZXIrKztcblxuICAgICAgICAgICAgLy8gd29ya2Fyb3VuZCBmb3IgY2hyb21lIDwgNTA6IGZvcmNlIGZpcnN0IHNhbXBsZSBhcyBhIHJhbmRvbSBhY2Nlc3MgcG9pbnRcbiAgICAgICAgICAgIC8vIHNlZSBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0yMjk0MTJcbiAgICAgICAgICAgIGlmICh0aGlzLl9mb3JjZUZpcnN0SURSKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZsYWdzID0gbXA0U2FtcGxlc1swXS5mbGFncztcbiAgICAgICAgICAgICAgICBmbGFncy5kZXBlbmRzT24gPSAyO1xuICAgICAgICAgICAgICAgIGZsYWdzLmlzTm9uU3luYyA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBtb29mYm94ID0gX21wNEdlbmVyYXRvcjIuZGVmYXVsdC5tb29mKHRyYWNrLCBmaXJzdER0cyk7XG4gICAgICAgICAgICB0cmFjay5zYW1wbGVzID0gW107XG4gICAgICAgICAgICB0cmFjay5sZW5ndGggPSAwO1xuXG4gICAgICAgICAgICB0aGlzLl9vbk1lZGlhU2VnbWVudCgndmlkZW8nLCB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ3ZpZGVvJyxcbiAgICAgICAgICAgICAgICBkYXRhOiB0aGlzLl9tZXJnZUJveGVzKG1vb2Zib3gsIG1kYXRib3gpLmJ1ZmZlcixcbiAgICAgICAgICAgICAgICBzYW1wbGVDb3VudDogbXA0U2FtcGxlcy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgaW5mbzogaW5mb1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19tZXJnZUJveGVzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9tZXJnZUJveGVzKG1vb2YsIG1kYXQpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBuZXcgVWludDhBcnJheShtb29mLmJ5dGVMZW5ndGggKyBtZGF0LmJ5dGVMZW5ndGgpO1xuICAgICAgICAgICAgcmVzdWx0LnNldChtb29mLCAwKTtcbiAgICAgICAgICAgIHJlc3VsdC5zZXQobWRhdCwgbW9vZi5ieXRlTGVuZ3RoKTtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uSW5pdFNlZ21lbnQnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vbkluaXRTZWdtZW50O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25Jbml0U2VnbWVudCA9IGNhbGxiYWNrO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogcHJvdG90eXBlOiBmdW5jdGlvbiBvbk1lZGlhU2VnbWVudCh0eXBlOiBzdHJpbmcsIG1lZGlhU2VnbWVudDogTWVkaWFTZWdtZW50KTogdm9pZFxyXG4gICAgICAgICAgIE1lZGlhU2VnbWVudDoge1xyXG4gICAgICAgICAgICAgICB0eXBlOiBzdHJpbmcsXHJcbiAgICAgICAgICAgICAgIGRhdGE6IEFycmF5QnVmZmVyLFxyXG4gICAgICAgICAgICAgICBzYW1wbGVDb3VudDogaW50MzJcclxuICAgICAgICAgICAgICAgaW5mbzogTWVkaWFTZWdtZW50SW5mb1xyXG4gICAgICAgICAgIH1cclxuICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbk1lZGlhU2VnbWVudCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uTWVkaWFTZWdtZW50O1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25NZWRpYVNlZ21lbnQgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBNUDRSZW11eGVyO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBNUDRSZW11eGVyO1xuXG59LHtcIi4uL2NvcmUvbWVkaWEtc2VnbWVudC1pbmZvLmpzXCI6OCxcIi4uL3V0aWxzL2Jyb3dzZXIuanNcIjozOSxcIi4uL3V0aWxzL2V4Y2VwdGlvbi5qc1wiOjQwLFwiLi4vdXRpbHMvbG9nZ2VyLmpzXCI6NDEsXCIuL2FhYy1zaWxlbnQuanNcIjozNixcIi4vbXA0LWdlbmVyYXRvci5qc1wiOjM3fV0sMzk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG52YXIgQnJvd3NlciA9IHt9O1xuXG5mdW5jdGlvbiBkZXRlY3QoKSB7XG4gICAgLy8gbW9kaWZpZWQgZnJvbSBqcXVlcnktYnJvd3Nlci1wbHVnaW5cblxuICAgIHZhciB1YSA9IHNlbGYubmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpO1xuXG4gICAgdmFyIG1hdGNoID0gLyhlZGdlKVxcLyhbXFx3Ll0rKS8uZXhlYyh1YSkgfHwgLyhvcHIpW1xcL10oW1xcdy5dKykvLmV4ZWModWEpIHx8IC8oY2hyb21lKVsgXFwvXShbXFx3Ll0rKS8uZXhlYyh1YSkgfHwgLyhpZW1vYmlsZSlbXFwvXShbXFx3Ll0rKS8uZXhlYyh1YSkgfHwgLyh2ZXJzaW9uKShhcHBsZXdlYmtpdClbIFxcL10oW1xcdy5dKykuKihzYWZhcmkpWyBcXC9dKFtcXHcuXSspLy5leGVjKHVhKSB8fCAvKHdlYmtpdClbIFxcL10oW1xcdy5dKykuKih2ZXJzaW9uKVsgXFwvXShbXFx3Ll0rKS4qKHNhZmFyaSlbIFxcL10oW1xcdy5dKykvLmV4ZWModWEpIHx8IC8od2Via2l0KVsgXFwvXShbXFx3Ll0rKS8uZXhlYyh1YSkgfHwgLyhvcGVyYSkoPzouKnZlcnNpb258KVsgXFwvXShbXFx3Ll0rKS8uZXhlYyh1YSkgfHwgLyhtc2llKSAoW1xcdy5dKykvLmV4ZWModWEpIHx8IHVhLmluZGV4T2YoJ3RyaWRlbnQnKSA+PSAwICYmIC8ocnYpKD86OnwgKShbXFx3Ll0rKS8uZXhlYyh1YSkgfHwgdWEuaW5kZXhPZignY29tcGF0aWJsZScpIDwgMCAmJiAvKGZpcmVmb3gpWyBcXC9dKFtcXHcuXSspLy5leGVjKHVhKSB8fCBbXTtcblxuICAgIHZhciBwbGF0Zm9ybV9tYXRjaCA9IC8oaXBhZCkvLmV4ZWModWEpIHx8IC8oaXBvZCkvLmV4ZWModWEpIHx8IC8od2luZG93cyBwaG9uZSkvLmV4ZWModWEpIHx8IC8oaXBob25lKS8uZXhlYyh1YSkgfHwgLyhraW5kbGUpLy5leGVjKHVhKSB8fCAvKGFuZHJvaWQpLy5leGVjKHVhKSB8fCAvKHdpbmRvd3MpLy5leGVjKHVhKSB8fCAvKG1hYykvLmV4ZWModWEpIHx8IC8obGludXgpLy5leGVjKHVhKSB8fCAvKGNyb3MpLy5leGVjKHVhKSB8fCBbXTtcblxuICAgIHZhciBtYXRjaGVkID0ge1xuICAgICAgICBicm93c2VyOiBtYXRjaFs1XSB8fCBtYXRjaFszXSB8fCBtYXRjaFsxXSB8fCAnJyxcbiAgICAgICAgdmVyc2lvbjogbWF0Y2hbMl0gfHwgbWF0Y2hbNF0gfHwgJzAnLFxuICAgICAgICBtYWpvclZlcnNpb246IG1hdGNoWzRdIHx8IG1hdGNoWzJdIHx8ICcwJyxcbiAgICAgICAgcGxhdGZvcm06IHBsYXRmb3JtX21hdGNoWzBdIHx8ICcnXG4gICAgfTtcblxuICAgIHZhciBicm93c2VyID0ge307XG4gICAgaWYgKG1hdGNoZWQuYnJvd3Nlcikge1xuICAgICAgICBicm93c2VyW21hdGNoZWQuYnJvd3Nlcl0gPSB0cnVlO1xuXG4gICAgICAgIHZhciB2ZXJzaW9uQXJyYXkgPSBtYXRjaGVkLm1ham9yVmVyc2lvbi5zcGxpdCgnLicpO1xuICAgICAgICBicm93c2VyLnZlcnNpb24gPSB7XG4gICAgICAgICAgICBtYWpvcjogcGFyc2VJbnQobWF0Y2hlZC5tYWpvclZlcnNpb24sIDEwKSxcbiAgICAgICAgICAgIHN0cmluZzogbWF0Y2hlZC52ZXJzaW9uXG4gICAgICAgIH07XG4gICAgICAgIGlmICh2ZXJzaW9uQXJyYXkubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgYnJvd3Nlci52ZXJzaW9uLm1pbm9yID0gcGFyc2VJbnQodmVyc2lvbkFycmF5WzFdLCAxMCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZlcnNpb25BcnJheS5sZW5ndGggPiAyKSB7XG4gICAgICAgICAgICBicm93c2VyLnZlcnNpb24uYnVpbGQgPSBwYXJzZUludCh2ZXJzaW9uQXJyYXlbMl0sIDEwKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChtYXRjaGVkLnBsYXRmb3JtKSB7XG4gICAgICAgIGJyb3dzZXJbbWF0Y2hlZC5wbGF0Zm9ybV0gPSB0cnVlO1xuICAgIH1cblxuICAgIGlmIChicm93c2VyLmNocm9tZSB8fCBicm93c2VyLm9wciB8fCBicm93c2VyLnNhZmFyaSkge1xuICAgICAgICBicm93c2VyLndlYmtpdCA9IHRydWU7XG4gICAgfVxuXG4gICAgLy8gTVNJRS4gSUUxMSBoYXMgJ3J2JyBpZGVudGlmZXJcbiAgICBpZiAoYnJvd3Nlci5ydiB8fCBicm93c2VyLmllbW9iaWxlKSB7XG4gICAgICAgIGlmIChicm93c2VyLnJ2KSB7XG4gICAgICAgICAgICBkZWxldGUgYnJvd3Nlci5ydjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbXNpZSA9ICdtc2llJztcbiAgICAgICAgbWF0Y2hlZC5icm93c2VyID0gbXNpZTtcbiAgICAgICAgYnJvd3Nlclttc2llXSA9IHRydWU7XG4gICAgfVxuXG4gICAgLy8gTWljcm9zb2Z0IEVkZ2VcbiAgICBpZiAoYnJvd3Nlci5lZGdlKSB7XG4gICAgICAgIGRlbGV0ZSBicm93c2VyLmVkZ2U7XG4gICAgICAgIHZhciBtc2VkZ2UgPSAnbXNlZGdlJztcbiAgICAgICAgbWF0Y2hlZC5icm93c2VyID0gbXNlZGdlO1xuICAgICAgICBicm93c2VyW21zZWRnZV0gPSB0cnVlO1xuICAgIH1cblxuICAgIC8vIE9wZXJhIDE1K1xuICAgIGlmIChicm93c2VyLm9wcikge1xuICAgICAgICB2YXIgb3BlcmEgPSAnb3BlcmEnO1xuICAgICAgICBtYXRjaGVkLmJyb3dzZXIgPSBvcGVyYTtcbiAgICAgICAgYnJvd3NlcltvcGVyYV0gPSB0cnVlO1xuICAgIH1cblxuICAgIC8vIFN0b2NrIGFuZHJvaWQgYnJvd3NlcnMgYXJlIG1hcmtlZCBhcyBTYWZhcmlcbiAgICBpZiAoYnJvd3Nlci5zYWZhcmkgJiYgYnJvd3Nlci5hbmRyb2lkKSB7XG4gICAgICAgIHZhciBhbmRyb2lkID0gJ2FuZHJvaWQnO1xuICAgICAgICBtYXRjaGVkLmJyb3dzZXIgPSBhbmRyb2lkO1xuICAgICAgICBicm93c2VyW2FuZHJvaWRdID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBicm93c2VyLm5hbWUgPSBtYXRjaGVkLmJyb3dzZXI7XG4gICAgYnJvd3Nlci5wbGF0Zm9ybSA9IG1hdGNoZWQucGxhdGZvcm07XG5cbiAgICBmb3IgKHZhciBrZXkgaW4gQnJvd3Nlcikge1xuICAgICAgICBpZiAoQnJvd3Nlci5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICBkZWxldGUgQnJvd3NlcltrZXldO1xuICAgICAgICB9XG4gICAgfVxuICAgIE9iamVjdC5hc3NpZ24oQnJvd3NlciwgYnJvd3Nlcik7XG59XG5cbmRldGVjdCgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBCcm93c2VyO1xuXG59LHt9XSw0MDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG52YXIgUnVudGltZUV4Y2VwdGlvbiA9IGV4cG9ydHMuUnVudGltZUV4Y2VwdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBSdW50aW1lRXhjZXB0aW9uKG1lc3NhZ2UpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJ1bnRpbWVFeGNlcHRpb24pO1xuXG4gICAgICAgIHRoaXMuX21lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhSdW50aW1lRXhjZXB0aW9uLCBbe1xuICAgICAgICBrZXk6ICd0b1N0cmluZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hbWUgKyAnOiAnICsgdGhpcy5tZXNzYWdlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICduYW1lJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ1J1bnRpbWVFeGNlcHRpb24nO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdtZXNzYWdlJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWVzc2FnZTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBSdW50aW1lRXhjZXB0aW9uO1xufSgpO1xuXG52YXIgSWxsZWdhbFN0YXRlRXhjZXB0aW9uID0gZXhwb3J0cy5JbGxlZ2FsU3RhdGVFeGNlcHRpb24gPSBmdW5jdGlvbiAoX1J1bnRpbWVFeGNlcHRpb24pIHtcbiAgICBfaW5oZXJpdHMoSWxsZWdhbFN0YXRlRXhjZXB0aW9uLCBfUnVudGltZUV4Y2VwdGlvbik7XG5cbiAgICBmdW5jdGlvbiBJbGxlZ2FsU3RhdGVFeGNlcHRpb24obWVzc2FnZSkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSWxsZWdhbFN0YXRlRXhjZXB0aW9uKTtcblxuICAgICAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKElsbGVnYWxTdGF0ZUV4Y2VwdGlvbi5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKElsbGVnYWxTdGF0ZUV4Y2VwdGlvbikpLmNhbGwodGhpcywgbWVzc2FnZSkpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhJbGxlZ2FsU3RhdGVFeGNlcHRpb24sIFt7XG4gICAgICAgIGtleTogJ25hbWUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiAnSWxsZWdhbFN0YXRlRXhjZXB0aW9uJztcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBJbGxlZ2FsU3RhdGVFeGNlcHRpb247XG59KFJ1bnRpbWVFeGNlcHRpb24pO1xuXG52YXIgSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uID0gZXhwb3J0cy5JbnZhbGlkQXJndW1lbnRFeGNlcHRpb24gPSBmdW5jdGlvbiAoX1J1bnRpbWVFeGNlcHRpb24yKSB7XG4gICAgX2luaGVyaXRzKEludmFsaWRBcmd1bWVudEV4Y2VwdGlvbiwgX1J1bnRpbWVFeGNlcHRpb24yKTtcblxuICAgIGZ1bmN0aW9uIEludmFsaWRBcmd1bWVudEV4Y2VwdGlvbihtZXNzYWdlKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJbnZhbGlkQXJndW1lbnRFeGNlcHRpb24pO1xuXG4gICAgICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uKSkuY2FsbCh0aGlzLCBtZXNzYWdlKSk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKEludmFsaWRBcmd1bWVudEV4Y2VwdGlvbiwgW3tcbiAgICAgICAga2V5OiAnbmFtZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuICdJbnZhbGlkQXJndW1lbnRFeGNlcHRpb24nO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIEludmFsaWRBcmd1bWVudEV4Y2VwdGlvbjtcbn0oUnVudGltZUV4Y2VwdGlvbik7XG5cbnZhciBOb3RJbXBsZW1lbnRlZEV4Y2VwdGlvbiA9IGV4cG9ydHMuTm90SW1wbGVtZW50ZWRFeGNlcHRpb24gPSBmdW5jdGlvbiAoX1J1bnRpbWVFeGNlcHRpb24zKSB7XG4gICAgX2luaGVyaXRzKE5vdEltcGxlbWVudGVkRXhjZXB0aW9uLCBfUnVudGltZUV4Y2VwdGlvbjMpO1xuXG4gICAgZnVuY3Rpb24gTm90SW1wbGVtZW50ZWRFeGNlcHRpb24obWVzc2FnZSkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTm90SW1wbGVtZW50ZWRFeGNlcHRpb24pO1xuXG4gICAgICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoTm90SW1wbGVtZW50ZWRFeGNlcHRpb24uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihOb3RJbXBsZW1lbnRlZEV4Y2VwdGlvbikpLmNhbGwodGhpcywgbWVzc2FnZSkpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhOb3RJbXBsZW1lbnRlZEV4Y2VwdGlvbiwgW3tcbiAgICAgICAga2V5OiAnbmFtZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuICdOb3RJbXBsZW1lbnRlZEV4Y2VwdGlvbic7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gTm90SW1wbGVtZW50ZWRFeGNlcHRpb247XG59KFJ1bnRpbWVFeGNlcHRpb24pO1xuXG59LHt9XSw0MTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfZXZlbnRzID0gX2RlcmVxXygnZXZlbnRzJyk7XG5cbnZhciBfZXZlbnRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V2ZW50cyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBMb2cgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTG9nKCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTG9nKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoTG9nLCBudWxsLCBbe1xuICAgICAgICBrZXk6ICdlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGUodGFnLCBtc2cpIHtcbiAgICAgICAgICAgIGlmICghdGFnIHx8IExvZy5GT1JDRV9HTE9CQUxfVEFHKSB0YWcgPSBMb2cuR0xPQkFMX1RBRztcblxuICAgICAgICAgICAgdmFyIHN0ciA9ICdbJyArIHRhZyArICddID4gJyArIG1zZztcblxuICAgICAgICAgICAgaWYgKExvZy5FTkFCTEVfQ0FMTEJBQ0spIHtcbiAgICAgICAgICAgICAgICBMb2cuZW1pdHRlci5lbWl0KCdsb2cnLCAnZXJyb3InLCBzdHIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIUxvZy5FTkFCTEVfRVJST1IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjb25zb2xlLmVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihzdHIpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChjb25zb2xlLndhcm4pIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oc3RyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coc3RyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnaScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpKHRhZywgbXNnKSB7XG4gICAgICAgICAgICBpZiAoIXRhZyB8fCBMb2cuRk9SQ0VfR0xPQkFMX1RBRykgdGFnID0gTG9nLkdMT0JBTF9UQUc7XG5cbiAgICAgICAgICAgIHZhciBzdHIgPSAnWycgKyB0YWcgKyAnXSA+ICcgKyBtc2c7XG5cbiAgICAgICAgICAgIGlmIChMb2cuRU5BQkxFX0NBTExCQUNLKSB7XG4gICAgICAgICAgICAgICAgTG9nLmVtaXR0ZXIuZW1pdCgnbG9nJywgJ2luZm8nLCBzdHIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIUxvZy5FTkFCTEVfSU5GTykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNvbnNvbGUuaW5mbykge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhzdHIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzdHIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICd3JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHcodGFnLCBtc2cpIHtcbiAgICAgICAgICAgIGlmICghdGFnIHx8IExvZy5GT1JDRV9HTE9CQUxfVEFHKSB0YWcgPSBMb2cuR0xPQkFMX1RBRztcblxuICAgICAgICAgICAgdmFyIHN0ciA9ICdbJyArIHRhZyArICddID4gJyArIG1zZztcblxuICAgICAgICAgICAgaWYgKExvZy5FTkFCTEVfQ0FMTEJBQ0spIHtcbiAgICAgICAgICAgICAgICBMb2cuZW1pdHRlci5lbWl0KCdsb2cnLCAnd2FybicsIHN0cik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghTG9nLkVOQUJMRV9XQVJOKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY29uc29sZS53YXJuKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKHN0cik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0cik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2QnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZCh0YWcsIG1zZykge1xuICAgICAgICAgICAgaWYgKCF0YWcgfHwgTG9nLkZPUkNFX0dMT0JBTF9UQUcpIHRhZyA9IExvZy5HTE9CQUxfVEFHO1xuXG4gICAgICAgICAgICB2YXIgc3RyID0gJ1snICsgdGFnICsgJ10gPiAnICsgbXNnO1xuXG4gICAgICAgICAgICBpZiAoTG9nLkVOQUJMRV9DQUxMQkFDSykge1xuICAgICAgICAgICAgICAgIExvZy5lbWl0dGVyLmVtaXQoJ2xvZycsICdkZWJ1ZycsIHN0cik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghTG9nLkVOQUJMRV9ERUJVRykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNvbnNvbGUuZGVidWcpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKHN0cik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0cik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3YnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdih0YWcsIG1zZykge1xuICAgICAgICAgICAgaWYgKCF0YWcgfHwgTG9nLkZPUkNFX0dMT0JBTF9UQUcpIHRhZyA9IExvZy5HTE9CQUxfVEFHO1xuXG4gICAgICAgICAgICB2YXIgc3RyID0gJ1snICsgdGFnICsgJ10gPiAnICsgbXNnO1xuXG4gICAgICAgICAgICBpZiAoTG9nLkVOQUJMRV9DQUxMQkFDSykge1xuICAgICAgICAgICAgICAgIExvZy5lbWl0dGVyLmVtaXQoJ2xvZycsICd2ZXJib3NlJywgc3RyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFMb2cuRU5BQkxFX1ZFUkJPU0UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0cik7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gTG9nO1xufSgpO1xuXG5Mb2cuR0xPQkFMX1RBRyA9ICdmbHYuanMnO1xuTG9nLkZPUkNFX0dMT0JBTF9UQUcgPSBmYWxzZTtcbkxvZy5FTkFCTEVfRVJST1IgPSB0cnVlO1xuTG9nLkVOQUJMRV9JTkZPID0gdHJ1ZTtcbkxvZy5FTkFCTEVfV0FSTiA9IHRydWU7XG5Mb2cuRU5BQkxFX0RFQlVHID0gdHJ1ZTtcbkxvZy5FTkFCTEVfVkVSQk9TRSA9IHRydWU7XG5cbkxvZy5FTkFCTEVfQ0FMTEJBQ0sgPSBmYWxzZTtcblxuTG9nLmVtaXR0ZXIgPSBuZXcgX2V2ZW50czIuZGVmYXVsdCgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBMb2c7XG5cbn0se1wiZXZlbnRzXCI6Mn1dLDQyOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9ldmVudHMgPSBfZGVyZXFfKCdldmVudHMnKTtcblxudmFyIF9ldmVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXZlbnRzKTtcblxudmFyIF9sb2dnZXIgPSBfZGVyZXFfKCcuL2xvZ2dlci5qcycpO1xuXG52YXIgX2xvZ2dlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnZXIpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgTG9nZ2luZ0NvbnRyb2wgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTG9nZ2luZ0NvbnRyb2woKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMb2dnaW5nQ29udHJvbCk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKExvZ2dpbmdDb250cm9sLCBudWxsLCBbe1xuICAgICAgICBrZXk6ICdnZXRDb25maWcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29uZmlnKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBnbG9iYWxUYWc6IF9sb2dnZXIyLmRlZmF1bHQuR0xPQkFMX1RBRyxcbiAgICAgICAgICAgICAgICBmb3JjZUdsb2JhbFRhZzogX2xvZ2dlcjIuZGVmYXVsdC5GT1JDRV9HTE9CQUxfVEFHLFxuICAgICAgICAgICAgICAgIGVuYWJsZVZlcmJvc2U6IF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX1ZFUkJPU0UsXG4gICAgICAgICAgICAgICAgZW5hYmxlRGVidWc6IF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0RFQlVHLFxuICAgICAgICAgICAgICAgIGVuYWJsZUluZm86IF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0lORk8sXG4gICAgICAgICAgICAgICAgZW5hYmxlV2FybjogX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfV0FSTixcbiAgICAgICAgICAgICAgICBlbmFibGVFcnJvcjogX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfRVJST1IsXG4gICAgICAgICAgICAgICAgZW5hYmxlQ2FsbGJhY2s6IF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0NBTExCQUNLXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhcHBseUNvbmZpZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhcHBseUNvbmZpZyhjb25maWcpIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuR0xPQkFMX1RBRyA9IGNvbmZpZy5nbG9iYWxUYWc7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkZPUkNFX0dMT0JBTF9UQUcgPSBjb25maWcuZm9yY2VHbG9iYWxUYWc7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9WRVJCT1NFID0gY29uZmlnLmVuYWJsZVZlcmJvc2U7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9ERUJVRyA9IGNvbmZpZy5lbmFibGVEZWJ1ZztcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0lORk8gPSBjb25maWcuZW5hYmxlSW5mbztcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX1dBUk4gPSBjb25maWcuZW5hYmxlV2FybjtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0VSUk9SID0gY29uZmlnLmVuYWJsZUVycm9yO1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfQ0FMTEJBQ0sgPSBjb25maWcuZW5hYmxlQ2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19ub3RpZnlDaGFuZ2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX25vdGlmeUNoYW5nZSgpIHtcbiAgICAgICAgICAgIHZhciBlbWl0dGVyID0gTG9nZ2luZ0NvbnRyb2wuZW1pdHRlcjtcblxuICAgICAgICAgICAgaWYgKGVtaXR0ZXIubGlzdGVuZXJDb3VudCgnY2hhbmdlJykgPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbmZpZyA9IExvZ2dpbmdDb250cm9sLmdldENvbmZpZygpO1xuICAgICAgICAgICAgICAgIGVtaXR0ZXIuZW1pdCgnY2hhbmdlJywgY29uZmlnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVnaXN0ZXJMaXN0ZW5lcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWdpc3Rlckxpc3RlbmVyKGxpc3RlbmVyKSB7XG4gICAgICAgICAgICBMb2dnaW5nQ29udHJvbC5lbWl0dGVyLmFkZExpc3RlbmVyKCdjaGFuZ2UnLCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlbW92ZUxpc3RlbmVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUxpc3RlbmVyKGxpc3RlbmVyKSB7XG4gICAgICAgICAgICBMb2dnaW5nQ29udHJvbC5lbWl0dGVyLnJlbW92ZUxpc3RlbmVyKCdjaGFuZ2UnLCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2FkZExvZ0xpc3RlbmVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZExvZ0xpc3RlbmVyKGxpc3RlbmVyKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmVtaXR0ZXIuYWRkTGlzdGVuZXIoJ2xvZycsIGxpc3RlbmVyKTtcbiAgICAgICAgICAgIGlmIChfbG9nZ2VyMi5kZWZhdWx0LmVtaXR0ZXIubGlzdGVuZXJDb3VudCgnbG9nJykgPiAwKSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfQ0FMTEJBQ0sgPSB0cnVlO1xuICAgICAgICAgICAgICAgIExvZ2dpbmdDb250cm9sLl9ub3RpZnlDaGFuZ2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVtb3ZlTG9nTGlzdGVuZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlTG9nTGlzdGVuZXIobGlzdGVuZXIpIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZW1pdHRlci5yZW1vdmVMaXN0ZW5lcignbG9nJywgbGlzdGVuZXIpO1xuICAgICAgICAgICAgaWYgKF9sb2dnZXIyLmRlZmF1bHQuZW1pdHRlci5saXN0ZW5lckNvdW50KCdsb2cnKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0NBTExCQUNLID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgTG9nZ2luZ0NvbnRyb2wuX25vdGlmeUNoYW5nZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdmb3JjZUdsb2JhbFRhZycsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIF9sb2dnZXIyLmRlZmF1bHQuRk9SQ0VfR0xPQkFMX1RBRztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZW5hYmxlKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkZPUkNFX0dMT0JBTF9UQUcgPSBlbmFibGU7XG4gICAgICAgICAgICBMb2dnaW5nQ29udHJvbC5fbm90aWZ5Q2hhbmdlKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2dsb2JhbFRhZycsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIF9sb2dnZXIyLmRlZmF1bHQuR0xPQkFMX1RBRztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodGFnKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkdMT0JBTF9UQUcgPSB0YWc7XG4gICAgICAgICAgICBMb2dnaW5nQ29udHJvbC5fbm90aWZ5Q2hhbmdlKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2VuYWJsZUFsbCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX1ZFUkJPU0UgJiYgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfREVCVUcgJiYgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfSU5GTyAmJiBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9XQVJOICYmIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0VSUk9SO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChlbmFibGUpIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX1ZFUkJPU0UgPSBlbmFibGU7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9ERUJVRyA9IGVuYWJsZTtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0lORk8gPSBlbmFibGU7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9XQVJOID0gZW5hYmxlO1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfRVJST1IgPSBlbmFibGU7XG4gICAgICAgICAgICBMb2dnaW5nQ29udHJvbC5fbm90aWZ5Q2hhbmdlKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2VuYWJsZURlYnVnJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfREVCVUc7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGVuYWJsZSkge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfREVCVUcgPSBlbmFibGU7XG4gICAgICAgICAgICBMb2dnaW5nQ29udHJvbC5fbm90aWZ5Q2hhbmdlKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2VuYWJsZVZlcmJvc2UnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9WRVJCT1NFO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChlbmFibGUpIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX1ZFUkJPU0UgPSBlbmFibGU7XG4gICAgICAgICAgICBMb2dnaW5nQ29udHJvbC5fbm90aWZ5Q2hhbmdlKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2VuYWJsZUluZm8nLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9JTkZPO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChlbmFibGUpIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0lORk8gPSBlbmFibGU7XG4gICAgICAgICAgICBMb2dnaW5nQ29udHJvbC5fbm90aWZ5Q2hhbmdlKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2VuYWJsZVdhcm4nLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9XQVJOO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChlbmFibGUpIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX1dBUk4gPSBlbmFibGU7XG4gICAgICAgICAgICBMb2dnaW5nQ29udHJvbC5fbm90aWZ5Q2hhbmdlKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2VuYWJsZUVycm9yJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfRVJST1I7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGVuYWJsZSkge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfRVJST1IgPSBlbmFibGU7XG4gICAgICAgICAgICBMb2dnaW5nQ29udHJvbC5fbm90aWZ5Q2hhbmdlKCk7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gTG9nZ2luZ0NvbnRyb2w7XG59KCk7XG5cbkxvZ2dpbmdDb250cm9sLmVtaXR0ZXIgPSBuZXcgX2V2ZW50czIuZGVmYXVsdCgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBMb2dnaW5nQ29udHJvbDtcblxufSx7XCIuL2xvZ2dlci5qc1wiOjQxLFwiZXZlbnRzXCI6Mn1dLDQzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG52YXIgUG9seWZpbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUG9seWZpbGwoKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQb2x5ZmlsbCk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFBvbHlmaWxsLCBudWxsLCBbe1xuICAgICAgICBrZXk6ICdpbnN0YWxsJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGluc3RhbGwoKSB7XG4gICAgICAgICAgICAvLyBFUzYgT2JqZWN0LnNldFByb3RvdHlwZU9mXG4gICAgICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gKG9iaiwgcHJvdG8pIHtcbiAgICAgICAgICAgICAgICBvYmouX19wcm90b19fID0gcHJvdG87XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIEVTNiBPYmplY3QuYXNzaWduXG4gICAgICAgICAgICBPYmplY3QuYXNzaWduID0gT2JqZWN0LmFzc2lnbiB8fCBmdW5jdGlvbiAodGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRhcmdldCA9PT0gdW5kZWZpbmVkIHx8IHRhcmdldCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY29udmVydCB1bmRlZmluZWQgb3IgbnVsbCB0byBvYmplY3QnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgb3V0cHV0ID0gT2JqZWN0KHRhcmdldCk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNvdXJjZSAhPT0gdW5kZWZpbmVkICYmIHNvdXJjZSAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHNvdXJjZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2UuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRba2V5XSA9IHNvdXJjZVtrZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gRVM2IFByb21pc2UgKG1pc3Npbmcgc3VwcG9ydCBpbiBJRTExKVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWxmLlByb21pc2UgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBfZGVyZXFfKCdlczYtcHJvbWlzZScpLnBvbHlmaWxsKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gUG9seWZpbGw7XG59KCk7XG5cblBvbHlmaWxsLmluc3RhbGwoKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gUG9seWZpbGw7XG5cbn0se1wiZXM2LXByb21pc2VcIjoxfV0sNDQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIFRoaXMgZmlsZSBpcyBkZXJpdmVkIGZyb20gQysrIHByb2plY3QgbGliV2luVEY4IChodHRwczovL2dpdGh1Yi5jb20vbTEzMjUzL2xpYldpblRGOClcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbmZ1bmN0aW9uIGNoZWNrQ29udGludWF0aW9uKHVpbnQ4YXJyYXksIHN0YXJ0LCBjaGVja0xlbmd0aCkge1xuICAgIHZhciBhcnJheSA9IHVpbnQ4YXJyYXk7XG4gICAgaWYgKHN0YXJ0ICsgY2hlY2tMZW5ndGggPCBhcnJheS5sZW5ndGgpIHtcbiAgICAgICAgd2hpbGUgKGNoZWNrTGVuZ3RoLS0pIHtcbiAgICAgICAgICAgIGlmICgoYXJyYXlbKytzdGFydF0gJiAweEMwKSAhPT0gMHg4MCkgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRlY29kZVVURjgodWludDhhcnJheSkge1xuICAgIHZhciBvdXQgPSBbXTtcbiAgICB2YXIgaW5wdXQgPSB1aW50OGFycmF5O1xuICAgIHZhciBpID0gMDtcbiAgICB2YXIgbGVuZ3RoID0gdWludDhhcnJheS5sZW5ndGg7XG5cbiAgICB3aGlsZSAoaSA8IGxlbmd0aCkge1xuICAgICAgICBpZiAoaW5wdXRbaV0gPCAweDgwKSB7XG4gICAgICAgICAgICBvdXQucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKGlucHV0W2ldKSk7XG4gICAgICAgICAgICArK2k7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfSBlbHNlIGlmIChpbnB1dFtpXSA8IDB4QzApIHtcbiAgICAgICAgICAgIC8vIGZhbGx0aHJvdWdoXG4gICAgICAgIH0gZWxzZSBpZiAoaW5wdXRbaV0gPCAweEUwKSB7XG4gICAgICAgICAgICBpZiAoY2hlY2tDb250aW51YXRpb24oaW5wdXQsIGksIDEpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHVjczQgPSAoaW5wdXRbaV0gJiAweDFGKSA8PCA2IHwgaW5wdXRbaSArIDFdICYgMHgzRjtcbiAgICAgICAgICAgICAgICBpZiAodWNzNCA+PSAweDgwKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dC5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUodWNzNCAmIDB4RkZGRikpO1xuICAgICAgICAgICAgICAgICAgICBpICs9IDI7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChpbnB1dFtpXSA8IDB4RjApIHtcbiAgICAgICAgICAgIGlmIChjaGVja0NvbnRpbnVhdGlvbihpbnB1dCwgaSwgMikpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3VjcyA9IChpbnB1dFtpXSAmIDB4RikgPDwgMTIgfCAoaW5wdXRbaSArIDFdICYgMHgzRikgPDwgNiB8IGlucHV0W2kgKyAyXSAmIDB4M0Y7XG4gICAgICAgICAgICAgICAgaWYgKF91Y3MgPj0gMHg4MDAgJiYgKF91Y3MgJiAweEY4MDApICE9PSAweEQ4MDApIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0LnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShfdWNzICYgMHhGRkZGKSk7XG4gICAgICAgICAgICAgICAgICAgIGkgKz0gMztcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGlucHV0W2ldIDwgMHhGOCkge1xuICAgICAgICAgICAgaWYgKGNoZWNrQ29udGludWF0aW9uKGlucHV0LCBpLCAzKSkge1xuICAgICAgICAgICAgICAgIHZhciBfdWNzMiA9IChpbnB1dFtpXSAmIDB4NykgPDwgMTggfCAoaW5wdXRbaSArIDFdICYgMHgzRikgPDwgMTIgfCAoaW5wdXRbaSArIDJdICYgMHgzRikgPDwgNiB8IGlucHV0W2kgKyAzXSAmIDB4M0Y7XG4gICAgICAgICAgICAgICAgaWYgKF91Y3MyID4gMHgxMDAwMCAmJiBfdWNzMiA8IDB4MTEwMDAwKSB7XG4gICAgICAgICAgICAgICAgICAgIF91Y3MyIC09IDB4MTAwMDA7XG4gICAgICAgICAgICAgICAgICAgIG91dC5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoX3VjczIgPj4+IDEwIHwgMHhEODAwKSk7XG4gICAgICAgICAgICAgICAgICAgIG91dC5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoX3VjczIgJiAweDNGRiB8IDB4REMwMCkpO1xuICAgICAgICAgICAgICAgICAgICBpICs9IDQ7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBvdXQucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKDB4RkZGRCkpO1xuICAgICAgICArK2k7XG4gICAgfVxuXG4gICAgcmV0dXJuIG91dC5qb2luKCcnKTtcbn1cblxuZXhwb3J0cy5kZWZhdWx0ID0gZGVjb2RlVVRGODtcblxufSx7fV19LHt9LFsyMV0pKDIxKVxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZsdi5qcy5tYXBcbiIsIi8qXG5tcDPnvJbnoIHlmajnlKjliLDnmoRsYW1lanPnvJbnoIHlvJXmk47vvIzkuIDoiKzpg73nlKhNUDPmoLzlvI/vvIzmtY/op4jlmajmlK/mjIHlub/ms5vvvIzmraTlvJXmk47mtYvor5XnmoTkuZ/mr5TovoPlpJrvvIznqLPlrppcbmh0dHBzOi8vZ2l0aHViLmNvbS94aWFuZ3l1ZWNuL1JlY29yZGVyXG4qL1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuLy9lbmQyICoqKirlvIDlp4tjb3B5IGxhbWVqcyoqKioqXG4vKlxubXAz57yW56CB5L6d6LWWbGFtZWpz77yM5aaC5p6c5peg6ZyAbXAz5pSv5oyB55u05o6l56e76Zmk5q2k5Luj56CBXG5odHRwczovL2dpdGh1Yi5jb20vemh1a2VyL2xhbWVqcy9ibG9iL2JmYjdmNmM2ZDc4NzdlMGZlMWFkOWU3MjY5N2E4NzE2NzYxMTlhMGUvbGFtZS5hbGwuanNcbiovXG5cbmZ1bmN0aW9uIGxhbWVqcygpIHtcbnZhciBNYXRoX2xvZzEwPWZ1bmN0aW9uKHMpey8v5Z2a5Yaz5LiN6IO955So5Lmf5LiN6KaB5oql6K+t6KiA6Zeu6aKY55qE6ZSZ6K+vXG5cdHJldHVybiBNYXRoLmxvZyhzKS9NYXRoLmxvZygxMCk7XG59O1xuXG5mdW5jdGlvbiBuZXdfYnl0ZShjb3VudCkge1xuICAgIHJldHVybiBuZXcgSW50OEFycmF5KGNvdW50KTtcbn1cblxuZnVuY3Rpb24gbmV3X3Nob3J0KGNvdW50KSB7XG4gICAgcmV0dXJuIG5ldyBJbnQxNkFycmF5KGNvdW50KTtcbn1cblxuZnVuY3Rpb24gbmV3X2ludChjb3VudCkge1xuICAgIHJldHVybiBuZXcgSW50MzJBcnJheShjb3VudCk7XG59XG5cbmZ1bmN0aW9uIG5ld19mbG9hdChjb3VudCkge1xuICAgIHJldHVybiBuZXcgRmxvYXQzMkFycmF5KGNvdW50KTtcbn1cblxuZnVuY3Rpb24gbmV3X2RvdWJsZShjb3VudCkge1xuICAgIHJldHVybiBuZXcgRmxvYXQ2NEFycmF5KGNvdW50KTtcbn1cblxuZnVuY3Rpb24gbmV3X2Zsb2F0X24oYXJncykge1xuICAgIGlmIChhcmdzLmxlbmd0aCA9PSAxKSB7XG4gICAgICAgIHJldHVybiBuZXdfZmxvYXQoYXJnc1swXSk7XG4gICAgfVxuICAgIHZhciBzeiA9IGFyZ3NbMF07XG4gICAgYXJncyA9IGFyZ3Muc2xpY2UoMSk7XG4gICAgdmFyIEEgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN6OyBpKyspIHtcbiAgICAgICAgQS5wdXNoKG5ld19mbG9hdF9uKGFyZ3MpKTtcbiAgICB9XG4gICAgcmV0dXJuIEE7XG59XG5mdW5jdGlvbiBuZXdfaW50X24oYXJncykge1xuICAgIGlmIChhcmdzLmxlbmd0aCA9PSAxKSB7XG4gICAgICAgIHJldHVybiBuZXdfaW50KGFyZ3NbMF0pO1xuICAgIH1cbiAgICB2YXIgc3ogPSBhcmdzWzBdO1xuICAgIGFyZ3MgPSBhcmdzLnNsaWNlKDEpO1xuICAgIHZhciBBID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzejsgaSsrKSB7XG4gICAgICAgIEEucHVzaChuZXdfaW50X24oYXJncykpO1xuICAgIH1cbiAgICByZXR1cm4gQTtcbn1cblxuZnVuY3Rpb24gbmV3X3Nob3J0X24oYXJncykge1xuICAgIGlmIChhcmdzLmxlbmd0aCA9PSAxKSB7XG4gICAgICAgIHJldHVybiBuZXdfc2hvcnQoYXJnc1swXSk7XG4gICAgfVxuICAgIHZhciBzeiA9IGFyZ3NbMF07XG4gICAgYXJncyA9IGFyZ3Muc2xpY2UoMSk7XG4gICAgdmFyIEEgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN6OyBpKyspIHtcbiAgICAgICAgQS5wdXNoKG5ld19zaG9ydF9uKGFyZ3MpKTtcbiAgICB9XG4gICAgcmV0dXJuIEE7XG59XG5cbmZ1bmN0aW9uIG5ld19hcnJheV9uKGFyZ3MpIHtcbiAgICBpZiAoYXJncy5sZW5ndGggPT0gMSkge1xuICAgICAgICByZXR1cm4gbmV3IEFycmF5KGFyZ3NbMF0pO1xuICAgIH1cbiAgICB2YXIgc3ogPSBhcmdzWzBdO1xuICAgIGFyZ3MgPSBhcmdzLnNsaWNlKDEpO1xuICAgIHZhciBBID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzejsgaSsrKSB7XG4gICAgICAgIEEucHVzaChuZXdfYXJyYXlfbihhcmdzKSk7XG4gICAgfVxuICAgIHJldHVybiBBO1xufVxuXG5cbnZhciBBcnJheXMgPSB7fTtcblxuQXJyYXlzLmZpbGwgPSBmdW5jdGlvbiAoYSwgZnJvbUluZGV4LCB0b0luZGV4LCB2YWwpIHtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSAyKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYVtpXSA9IGFyZ3VtZW50c1sxXTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciAodmFyIGkgPSBmcm9tSW5kZXg7IGkgPCB0b0luZGV4OyBpKyspIHtcbiAgICAgICAgICAgIGFbaV0gPSB2YWw7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG52YXIgU3lzdGVtID0ge307XG5cblN5c3RlbS5hcnJheWNvcHkgPSBmdW5jdGlvbiAoc3JjLCBzcmNQb3MsIGRlc3QsIGRlc3RQb3MsIGxlbmd0aCkge1xuICAgIHZhciBzcmNFbmQgPSBzcmNQb3MgKyBsZW5ndGg7XG4gICAgd2hpbGUgKHNyY1BvcyA8IHNyY0VuZClcbiAgICAgICAgZGVzdFtkZXN0UG9zKytdID0gc3JjW3NyY1BvcysrXTtcbn07XG5cblxudmFyIFV0aWwgPSB7fTtcblV0aWwuU1FSVDIgPSAxLjQxNDIxMzU2MjM3MzA5NTA0ODgwO1xuVXRpbC5GQVNUX0xPRzEwID0gZnVuY3Rpb24gKHgpIHtcbiAgICByZXR1cm4gTWF0aF9sb2cxMCh4KTtcbn07XG5cblV0aWwuRkFTVF9MT0cxMF9YID0gZnVuY3Rpb24gKHgsIHkpIHtcbiAgICByZXR1cm4gTWF0aF9sb2cxMCh4KSAqIHk7XG59O1xuXG5mdW5jdGlvbiBTaG9ydEJsb2NrKG9yZGluYWwpIHtcbiAgICB0aGlzLm9yZGluYWwgPSBvcmRpbmFsO1xufVxuLyoqXG4gKiBMQU1FIG1heSB1c2UgdGhlbSwgZXZlbiBkaWZmZXJlbnQgYmxvY2sgdHlwZXMgZm9yIEwvUi5cbiAqL1xuU2hvcnRCbG9jay5zaG9ydF9ibG9ja19hbGxvd2VkID0gbmV3IFNob3J0QmxvY2soMCk7XG4vKipcbiAqIExBTUUgbWF5IHVzZSB0aGVtLCBidXQgYWx3YXlzIHNhbWUgYmxvY2sgdHlwZXMgaW4gTC9SLlxuICovXG5TaG9ydEJsb2NrLnNob3J0X2Jsb2NrX2NvdXBsZWQgPSBuZXcgU2hvcnRCbG9jaygxKTtcbi8qKlxuICogTEFNRSB3aWxsIG5vdCB1c2Ugc2hvcnQgYmxvY2tzLCBsb25nIGJsb2NrcyBvbmx5LlxuICovXG5TaG9ydEJsb2NrLnNob3J0X2Jsb2NrX2Rpc3BlbnNlZCA9IG5ldyBTaG9ydEJsb2NrKDIpO1xuLyoqXG4gKiBMQU1FIHdpbGwgbm90IHVzZSBsb25nIGJsb2Nrcywgc2hvcnQgYmxvY2tzIG9ubHkuXG4gKi9cblNob3J0QmxvY2suc2hvcnRfYmxvY2tfZm9yY2VkID0gbmV3IFNob3J0QmxvY2soMyk7XG5cbnZhciBGbG9hdCA9IHt9O1xuRmxvYXQuTUFYX1ZBTFVFID0gMy40MDI4MjM1ZSszODtcblxuZnVuY3Rpb24gVmJyTW9kZShvcmRpbmFsKSB7XG4gICAgdGhpcy5vcmRpbmFsID0gb3JkaW5hbDtcbn1cblZick1vZGUudmJyX29mZiA9IG5ldyBWYnJNb2RlKDApO1xuVmJyTW9kZS52YnJfbXQgPSBuZXcgVmJyTW9kZSgxKTtcblZick1vZGUudmJyX3JoID0gbmV3IFZick1vZGUoMik7XG5WYnJNb2RlLnZicl9hYnIgPSBuZXcgVmJyTW9kZSgzKTtcblZick1vZGUudmJyX210cmggPSBuZXcgVmJyTW9kZSg0KTtcblZick1vZGUudmJyX2RlZmF1bHQgPSBWYnJNb2RlLnZicl9tdHJoO1xuXG52YXIgYXNzZXJ0ID0gZnVuY3Rpb24gKHgpIHtcbiAgICAvL2NvbnNvbGUuYXNzZXJ0KHgpO1xufTtcblxudmFyIG1vZHVsZV9leHBvcnRzID0ge1xuICAgIFwiU3lzdGVtXCI6IFN5c3RlbSxcbiAgICBcIlZick1vZGVcIjogVmJyTW9kZSxcbiAgICBcIkZsb2F0XCI6IEZsb2F0LFxuICAgIFwiU2hvcnRCbG9ja1wiOiBTaG9ydEJsb2NrLFxuICAgIFwiVXRpbFwiOiBVdGlsLFxuICAgIFwiQXJyYXlzXCI6IEFycmF5cyxcbiAgICBcIm5ld19hcnJheV9uXCI6IG5ld19hcnJheV9uLFxuICAgIFwibmV3X2J5dGVcIjogbmV3X2J5dGUsXG4gICAgXCJuZXdfZG91YmxlXCI6IG5ld19kb3VibGUsXG4gICAgXCJuZXdfZmxvYXRcIjogbmV3X2Zsb2F0LFxuICAgIFwibmV3X2Zsb2F0X25cIjogbmV3X2Zsb2F0X24sXG4gICAgXCJuZXdfaW50XCI6IG5ld19pbnQsXG4gICAgXCJuZXdfaW50X25cIjogbmV3X2ludF9uLFxuICAgIFwibmV3X3Nob3J0XCI6IG5ld19zaG9ydCxcbiAgICBcIm5ld19zaG9ydF9uXCI6IG5ld19zaG9ydF9uLFxuICAgIFwiYXNzZXJ0XCI6IGFzc2VydFxufTtcbi8vcGFja2FnZSBtcDM7XG5cbi8qIE1QRUcgbW9kZXMgKi9cbmZ1bmN0aW9uIE1QRUdNb2RlKG9yZGluYWwpIHtcbiAgICB2YXIgX29yZGluYWwgPSBvcmRpbmFsO1xuICAgIHRoaXMub3JkaW5hbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9vcmRpbmFsO1xuICAgIH1cbn1cblxuTVBFR01vZGUuU1RFUkVPID0gbmV3IE1QRUdNb2RlKDApO1xuTVBFR01vZGUuSk9JTlRfU1RFUkVPID0gbmV3IE1QRUdNb2RlKDEpO1xuTVBFR01vZGUuRFVBTF9DSEFOTkVMID0gbmV3IE1QRUdNb2RlKDIpO1xuTVBFR01vZGUuTU9OTyA9IG5ldyBNUEVHTW9kZSgzKTtcbk1QRUdNb2RlLk5PVF9TRVQgPSBuZXcgTVBFR01vZGUoNCk7XG5cbmZ1bmN0aW9uIFZlcnNpb24oKSB7XG5cbiAgICAvKipcbiAgICAgKiBVUkwgZm9yIHRoZSBMQU1FIHdlYnNpdGUuXG4gICAgICovXG4gICAgdmFyIExBTUVfVVJMID0gXCJodHRwOi8vd3d3Lm1wM2Rldi5vcmcvXCI7XG5cbiAgICAvKipcbiAgICAgKiBNYWpvciB2ZXJzaW9uIG51bWJlci5cbiAgICAgKi9cbiAgICB2YXIgTEFNRV9NQUpPUl9WRVJTSU9OID0gMztcbiAgICAvKipcbiAgICAgKiBNaW5vciB2ZXJzaW9uIG51bWJlci5cbiAgICAgKi9cbiAgICB2YXIgTEFNRV9NSU5PUl9WRVJTSU9OID0gOTg7XG4gICAgLyoqXG4gICAgICogUGF0Y2ggbGV2ZWwuXG4gICAgICovXG4gICAgdmFyIExBTUVfUEFUQ0hfVkVSU0lPTiA9IDQ7XG5cbiAgICAvKipcbiAgICAgKiBNYWpvciB2ZXJzaW9uIG51bWJlci5cbiAgICAgKi9cbiAgICB2YXIgUFNZX01BSk9SX1ZFUlNJT04gPSAwO1xuICAgIC8qKlxuICAgICAqIE1pbm9yIHZlcnNpb24gbnVtYmVyLlxuICAgICAqL1xuICAgIHZhciBQU1lfTUlOT1JfVkVSU0lPTiA9IDkzO1xuXG4gICAgLyoqXG4gICAgICogQSBzdHJpbmcgd2hpY2ggZGVzY3JpYmVzIHRoZSB2ZXJzaW9uIG9mIExBTUUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHN0cmluZyB3aGljaCBkZXNjcmliZXMgdGhlIHZlcnNpb24gb2YgTEFNRVxuICAgICAqL1xuICAgIHRoaXMuZ2V0TGFtZVZlcnNpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIHByaW1hcnkgdG8gd3JpdGUgc2NyZWVuIHJlcG9ydHNcbiAgICAgICAgcmV0dXJuIChMQU1FX01BSk9SX1ZFUlNJT04gKyBcIi5cIiArIExBTUVfTUlOT1JfVkVSU0lPTiArIFwiLlwiICsgTEFNRV9QQVRDSF9WRVJTSU9OKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgc2hvcnQgdmVyc2lvbiBvZiB0aGUgTEFNRSB2ZXJzaW9uIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEByZXR1cm4gc2hvcnQgdmVyc2lvbiBvZiB0aGUgTEFNRSB2ZXJzaW9uIHN0cmluZ1xuICAgICAqL1xuICAgIHRoaXMuZ2V0TGFtZVNob3J0VmVyc2lvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gQWRkaW5nIGRhdGUgYW5kIHRpbWUgdG8gdmVyc2lvbiBzdHJpbmcgbWFrZXMgaXQgaGFyZGVyIGZvciBvdXRwdXRcbiAgICAgICAgLy8gdmFsaWRhdGlvblxuICAgICAgICByZXR1cm4gKExBTUVfTUFKT1JfVkVSU0lPTiArIFwiLlwiICsgTEFNRV9NSU5PUl9WRVJTSU9OICsgXCIuXCIgKyBMQU1FX1BBVENIX1ZFUlNJT04pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBzaG9ydGVzdCB2ZXJzaW9uIG9mIHRoZSBMQU1FIHZlcnNpb24gc3RyaW5nLlxuICAgICAqXG4gICAgICogQHJldHVybiBzaG9ydGVzdCB2ZXJzaW9uIG9mIHRoZSBMQU1FIHZlcnNpb24gc3RyaW5nXG4gICAgICovXG4gICAgdGhpcy5nZXRMYW1lVmVyeVNob3J0VmVyc2lvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gQWRkaW5nIGRhdGUgYW5kIHRpbWUgdG8gdmVyc2lvbiBzdHJpbmcgbWFrZXMgaXQgaGFyZGVyIGZvciBvdXRwdXRcbiAgICAgICAgcmV0dXJuIChcIkxBTUVcIiArIExBTUVfTUFKT1JfVkVSU0lPTiArIFwiLlwiICsgTEFNRV9NSU5PUl9WRVJTSU9OICsgXCJyXCIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFN0cmluZyB3aGljaCBkZXNjcmliZXMgdGhlIHZlcnNpb24gb2YgR1BTWUNIT1xuICAgICAqXG4gICAgICogQHJldHVybiBzdHJpbmcgd2hpY2ggZGVzY3JpYmVzIHRoZSB2ZXJzaW9uIG9mIEdQU1lDSE9cbiAgICAgKi9cbiAgICB0aGlzLmdldFBzeVZlcnNpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoUFNZX01BSk9SX1ZFUlNJT04gKyBcIi5cIiArIFBTWV9NSU5PUl9WRVJTSU9OKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdHJpbmcgd2hpY2ggaXMgYSBVUkwgZm9yIHRoZSBMQU1FIHdlYnNpdGUuXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHN0cmluZyB3aGljaCBpcyBhIFVSTCBmb3IgdGhlIExBTUUgd2Vic2l0ZVxuICAgICAqL1xuICAgIHRoaXMuZ2V0TGFtZVVybCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIExBTUVfVVJMO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFF1aXRlIHVzZWxlc3MgZm9yIGEgamF2YSB2ZXJzaW9uLCBob3dldmVyIHdlIGFyZSBjb21wYXRpYmxlIDstKVxuICAgICAqXG4gICAgICogQHJldHVybiBcIjMyYml0c1wiXG4gICAgICovXG4gICAgdGhpcy5nZXRMYW1lT3NCaXRuZXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCIzMmJpdHNcIjtcbiAgICB9XG5cbn1cblxuLypcbiAqXHRNUDMgaHVmZm1hbiB0YWJsZSBzZWxlY3RpbmcgYW5kIGJpdCBjb3VudGluZ1xuICpcbiAqXHRDb3B5cmlnaHQgKGMpIDE5OTktMjAwNSBUYWtlaGlybyBUT01JTkFHQVxuICpcdENvcHlyaWdodCAoYykgMjAwMi0yMDA1IEdhYnJpZWwgQm91dmlnbmVcbiAqXG4gKiBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yXG4gKiBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG4gKiBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXJcbiAqIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCxcbiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mXG4gKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuXHQgU2VlIHRoZSBHTlVcbiAqIExpYnJhcnkgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLlxuICpcbiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWNcbiAqIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgd3JpdGUgdG8gdGhlXG4gKiBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIEluYy4sIDU5IFRlbXBsZSBQbGFjZSAtIFN1aXRlIDMzMCxcbiAqIEJvc3RvbiwgTUEgMDIxMTEtMTMwNywgVVNBLlxuICovXG5cbi8qICRJZDogVGFrZWhpcm8uamF2YSx2IDEuMjYgMjAxMS8wNS8yNCAyMDo0ODowNiBrZW5jaGlzIEV4cCAkICovXG5cbi8vcGFja2FnZSBtcDM7XG5cbi8vaW1wb3J0IGphdmEudXRpbC5BcnJheXM7XG5cblxuXG5mdW5jdGlvbiBUYWtlaGlybygpIHtcblxuICAgIHZhciBxdXB2dCA9IG51bGw7XG4gICAgdGhpcy5xdXB2dCA9IG51bGw7XG5cbiAgICB0aGlzLnNldE1vZHVsZXMgPSBmdW5jdGlvbiAoX3F1cHZ0KSB7XG4gICAgICAgIHRoaXMucXVwdnQgPSBfcXVwdnQ7XG4gICAgICAgIHF1cHZ0ID0gX3F1cHZ0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIEJpdHMoYikge1xuICAgICAgICB0aGlzLmJpdHMgPSAwIHwgYjtcbiAgICB9XG5cbiAgICB2YXIgc3ViZHZfdGFibGUgPSBbWzAsIDBdLCAvKiAwIGJhbmRzICovXG4gICAgICAgIFswLCAwXSwgLyogMSBiYW5kcyAqL1xuICAgICAgICBbMCwgMF0sIC8qIDIgYmFuZHMgKi9cbiAgICAgICAgWzAsIDBdLCAvKiAzIGJhbmRzICovXG4gICAgICAgIFswLCAwXSwgLyogNCBiYW5kcyAqL1xuICAgICAgICBbMCwgMV0sIC8qIDUgYmFuZHMgKi9cbiAgICAgICAgWzEsIDFdLCAvKiA2IGJhbmRzICovXG4gICAgICAgIFsxLCAxXSwgLyogNyBiYW5kcyAqL1xuICAgICAgICBbMSwgMl0sIC8qIDggYmFuZHMgKi9cbiAgICAgICAgWzIsIDJdLCAvKiA5IGJhbmRzICovXG4gICAgICAgIFsyLCAzXSwgLyogMTAgYmFuZHMgKi9cbiAgICAgICAgWzIsIDNdLCAvKiAxMSBiYW5kcyAqL1xuICAgICAgICBbMywgNF0sIC8qIDEyIGJhbmRzICovXG4gICAgICAgIFszLCA0XSwgLyogMTMgYmFuZHMgKi9cbiAgICAgICAgWzMsIDRdLCAvKiAxNCBiYW5kcyAqL1xuICAgICAgICBbNCwgNV0sIC8qIDE1IGJhbmRzICovXG4gICAgICAgIFs0LCA1XSwgLyogMTYgYmFuZHMgKi9cbiAgICAgICAgWzQsIDZdLCAvKiAxNyBiYW5kcyAqL1xuICAgICAgICBbNSwgNl0sIC8qIDE4IGJhbmRzICovXG4gICAgICAgIFs1LCA2XSwgLyogMTkgYmFuZHMgKi9cbiAgICAgICAgWzUsIDddLCAvKiAyMCBiYW5kcyAqL1xuICAgICAgICBbNiwgN10sIC8qIDIxIGJhbmRzICovXG4gICAgICAgIFs2LCA3XSwgLyogMjIgYmFuZHMgKi9cbiAgICBdO1xuXG5cbiAgICAvKipcbiAgICAgKiBub25saW5lYXIgcXVhbnRpemF0aW9uIG9mIHhyIE1vcmUgYWNjdXJhdGUgZm9ybXVsYSB0aGFuIHRoZSBJU08gZm9ybXVsYS5cbiAgICAgKiBUYWtlcyBpbnRvIGFjY291bnQgdGhlIGZhY3QgdGhhdCB3ZSBhcmUgcXVhbnRpemluZyB4ciAuIGl4LCBidXQgd2Ugd2FudFxuICAgICAqIGl4XjQvMyB0byBiZSBhcyBjbG9zZSBhcyBwb3NzaWJsZSB0byB4XjQvMy4gKHRha2luZyB0aGUgbmVhcmVzdCBpbnQgd291bGRcbiAgICAgKiBtZWFuIGl4IGlzIGFzIGNsb3NlIGFzIHBvc3NpYmxlIHRvIHhyLCB3aGljaCBpcyBkaWZmZXJlbnQuKVxuICAgICAqXG4gICAgICogRnJvbSBTZWdoZXIgQm9lc3Nlbmtvb2wgPHNlZ2hlckBlYXN0c2l0ZS5ubD4gMTEvMTk5OVxuICAgICAqXG4gICAgICogMDkvMjAwMDogQVNNIGNvZGUgcmVtb3ZlZCBpbiBmYXZvciBvZiBJRUVFNzU0IGhhY2sgYnkgVGFrZWhpcm8gVG9taW5hZ2EuXG4gICAgICogSWYgeW91IG5lZWQgdGhlIEFTTSBjb2RlLCBjaGVjayBDVlMgY2lyY2EgQXVnIDIwMDAuXG4gICAgICpcbiAgICAgKiAwMS8yMDA0OiBPcHRpbWl6YXRpb25zIGJ5IEdhYnJpZWwgQm91dmlnbmVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBxdWFudGl6ZV9saW5lc194cnBvd18wMShsLCBpc3RlcCwgeHIsIHhyUG9zLCBpeCwgaXhQb3MpIHtcbiAgICAgICAgdmFyIGNvbXBhcmV2YWwwID0gKDEuMCAtIDAuNDA1NCkgLyBpc3RlcDtcblxuICAgICAgICBsID0gbCA+PiAxO1xuICAgICAgICB3aGlsZSAoKGwtLSkgIT0gMCkge1xuICAgICAgICAgICAgaXhbaXhQb3MrK10gPSAoY29tcGFyZXZhbDAgPiB4clt4clBvcysrXSkgPyAwIDogMTtcbiAgICAgICAgICAgIGl4W2l4UG9zKytdID0gKGNvbXBhcmV2YWwwID4geHJbeHJQb3MrK10pID8gMCA6IDE7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBYUlBPV19GVE9JIGlzIGEgbWFjcm8gdG8gY29udmVydCBmbG9hdHMgdG8gaW50cy48QlI+XG4gICAgICogaWYgWFJQT1dfRlRPSSh4KSA9IG5lYXJlc3RfaW50KHgpLCB0aGVuIFFVQU5URkFDKHgpPWFkajQzYXNtW3hdPEJSPlxuICAgICAqIFJPVU5ERkFDPSAtMC4wOTQ2PEJSPlxuICAgICAqXG4gICAgICogaWYgWFJQT1dfRlRPSSh4KSA9IGZsb29yKHgpLCB0aGVuIFFVQU5URkFDKHgpPWFzajQzW3hdPEJSPlxuICAgICAqIFJPVU5ERkFDPTAuNDA1NDxCUj5cbiAgICAgKlxuICAgICAqIE5vdGU6IHVzaW5nIGZsb29yKCkgb3IgMHwgaXMgZXh0cmVtZWx5IHNsb3cuIE9uIG1hY2hpbmVzIHdoZXJlIHRoZVxuICAgICAqIFRBS0VISVJPX0lFRUU3NTRfSEFDSyBjb2RlIGFib3ZlIGRvZXMgbm90IHdvcmssIGl0IGlzIHdvcnRod2lsZSB0byB3cml0ZVxuICAgICAqIHNvbWUgQVNNIGZvciBYUlBPV19GVE9JKCkuXG4gICAgICovXG4gICAgZnVuY3Rpb24gcXVhbnRpemVfbGluZXNfeHJwb3cobCwgaXN0ZXAsIHhyLCB4clBvcywgaXgsIGl4UG9zKSB7XG5cbiAgICAgICAgbCA9IGwgPj4gMTtcbiAgICAgICAgdmFyIHJlbWFpbmluZyA9IGwgJSAyO1xuICAgICAgICBsID0gbCA+PiAxO1xuICAgICAgICB3aGlsZSAobC0tICE9IDApIHtcbiAgICAgICAgICAgIHZhciB4MCwgeDEsIHgyLCB4MztcbiAgICAgICAgICAgIHZhciByeDAsIHJ4MSwgcngyLCByeDM7XG5cbiAgICAgICAgICAgIHgwID0geHJbeHJQb3MrK10gKiBpc3RlcDtcbiAgICAgICAgICAgIHgxID0geHJbeHJQb3MrK10gKiBpc3RlcDtcbiAgICAgICAgICAgIHJ4MCA9IDAgfCB4MDtcbiAgICAgICAgICAgIHgyID0geHJbeHJQb3MrK10gKiBpc3RlcDtcbiAgICAgICAgICAgIHJ4MSA9IDAgfCB4MTtcbiAgICAgICAgICAgIHgzID0geHJbeHJQb3MrK10gKiBpc3RlcDtcbiAgICAgICAgICAgIHJ4MiA9IDAgfCB4MjtcbiAgICAgICAgICAgIHgwICs9IHF1cHZ0LmFkajQzW3J4MF07XG4gICAgICAgICAgICByeDMgPSAwIHwgeDM7XG4gICAgICAgICAgICB4MSArPSBxdXB2dC5hZGo0M1tyeDFdO1xuICAgICAgICAgICAgaXhbaXhQb3MrK10gPSAwIHwgeDA7XG4gICAgICAgICAgICB4MiArPSBxdXB2dC5hZGo0M1tyeDJdO1xuICAgICAgICAgICAgaXhbaXhQb3MrK10gPSAwIHwgeDE7XG4gICAgICAgICAgICB4MyArPSBxdXB2dC5hZGo0M1tyeDNdO1xuICAgICAgICAgICAgaXhbaXhQb3MrK10gPSAwIHwgeDI7XG4gICAgICAgICAgICBpeFtpeFBvcysrXSA9IDAgfCB4MztcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVtYWluaW5nICE9IDApIHtcbiAgICAgICAgICAgIHZhciB4MCwgeDE7XG4gICAgICAgICAgICB2YXIgcngwLCByeDE7XG5cbiAgICAgICAgICAgIHgwID0geHJbeHJQb3MrK10gKiBpc3RlcDtcbiAgICAgICAgICAgIHgxID0geHJbeHJQb3MrK10gKiBpc3RlcDtcbiAgICAgICAgICAgIHJ4MCA9IDAgfCB4MDtcbiAgICAgICAgICAgIHJ4MSA9IDAgfCB4MTtcbiAgICAgICAgICAgIHgwICs9IHF1cHZ0LmFkajQzW3J4MF07XG4gICAgICAgICAgICB4MSArPSBxdXB2dC5hZGo0M1tyeDFdO1xuICAgICAgICAgICAgaXhbaXhQb3MrK10gPSAwIHwgeDA7XG4gICAgICAgICAgICBpeFtpeFBvcysrXSA9IDAgfCB4MTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFF1YW50aXphdGlvbiBmdW5jdGlvbiBUaGlzIGZ1bmN0aW9uIHdpbGwgc2VsZWN0IHdoaWNoIGxpbmVzIHRvIHF1YW50aXplXG4gICAgICogYW5kIGNhbGwgdGhlIHByb3BlciBxdWFudGl6YXRpb24gZnVuY3Rpb25cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBxdWFudGl6ZV94cnBvdyh4cCwgcGksIGlzdGVwLCBjb2RJbmZvLCBwcmV2Tm9pc2UpIHtcbiAgICAgICAgLyogcXVhbnRpemUgb24geHJeKDMvNCkgaW5zdGVhZCBvZiB4ciAqL1xuICAgICAgICB2YXIgc2ZiO1xuICAgICAgICB2YXIgc2ZibWF4O1xuICAgICAgICB2YXIgaiA9IDA7XG4gICAgICAgIHZhciBwcmV2X2RhdGFfdXNlO1xuICAgICAgICB2YXIgYWNjdW11bGF0ZSA9IDA7XG4gICAgICAgIHZhciBhY2N1bXVsYXRlMDEgPSAwO1xuICAgICAgICB2YXIgeHBQb3MgPSAwO1xuICAgICAgICB2YXIgaURhdGEgPSBwaTtcbiAgICAgICAgdmFyIGlEYXRhUG9zID0gMDtcbiAgICAgICAgdmFyIGFjY19pRGF0YSA9IGlEYXRhO1xuICAgICAgICB2YXIgYWNjX2lEYXRhUG9zID0gMDtcbiAgICAgICAgdmFyIGFjY194cCA9IHhwO1xuICAgICAgICB2YXIgYWNjX3hwUG9zID0gMDtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBSZXVzaW5nIHByZXZpb3VzbHkgY29tcHV0ZWQgZGF0YSBkb2VzIG5vdCBzZWVtcyB0byB3b3JrIGlmIGdsb2JhbFxuICAgICAgICAgKiBnYWluIGlzIGNoYW5nZWQuIEZpbmRpbmcgd2h5IGl0IGJlaGF2ZXMgdGhpcyB3YXkgd291bGQgYWxsb3cgdG8gdXNlIGFcbiAgICAgICAgICogY2FjaGUgb2YgcHJldmlvdXNseSBjb21wdXRlZCB2YWx1ZXMgKGxldCdzIDEwIGNhY2hlZCB2YWx1ZXMgcGVyIHNmYilcbiAgICAgICAgICogdGhhdCB3b3VsZCBwcm9iYWJseSBwcm92aWRlIGEgbm90aWNlYWJsZSBzcGVlZHVwXG4gICAgICAgICAqL1xuICAgICAgICBwcmV2X2RhdGFfdXNlID0gKHByZXZOb2lzZSAhPSBudWxsICYmIChjb2RJbmZvLmdsb2JhbF9nYWluID09IHByZXZOb2lzZS5nbG9iYWxfZ2FpbikpO1xuXG4gICAgICAgIGlmIChjb2RJbmZvLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFKVxuICAgICAgICAgICAgc2ZibWF4ID0gMzg7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHNmYm1heCA9IDIxO1xuXG4gICAgICAgIGZvciAoc2ZiID0gMDsgc2ZiIDw9IHNmYm1heDsgc2ZiKyspIHtcbiAgICAgICAgICAgIHZhciBzdGVwID0gLTE7XG5cbiAgICAgICAgICAgIGlmIChwcmV2X2RhdGFfdXNlIHx8IGNvZEluZm8uYmxvY2tfdHlwZSA9PSBFbmNvZGVyLk5PUk1fVFlQRSkge1xuICAgICAgICAgICAgICAgIHN0ZXAgPSBjb2RJbmZvLmdsb2JhbF9nYWluXG4gICAgICAgICAgICAgICAgICAgIC0gKChjb2RJbmZvLnNjYWxlZmFjW3NmYl0gKyAoY29kSW5mby5wcmVmbGFnICE9IDAgPyBxdXB2dC5wcmV0YWJbc2ZiXVxuICAgICAgICAgICAgICAgICAgICAgICAgOiAwKSkgPDwgKGNvZEluZm8uc2NhbGVmYWNfc2NhbGUgKyAxKSlcbiAgICAgICAgICAgICAgICAgICAgLSBjb2RJbmZvLnN1YmJsb2NrX2dhaW5bY29kSW5mby53aW5kb3dbc2ZiXV0gKiA4O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHByZXZfZGF0YV91c2UgJiYgKHByZXZOb2lzZS5zdGVwW3NmYl0gPT0gc3RlcCkpIHtcbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIGRvIG5vdCByZWNvbXB1dGUgdGhpcyBwYXJ0LCBidXQgY29tcHV0ZSBhY2N1bXVsYXRlZCBsaW5lc1xuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGlmIChhY2N1bXVsYXRlICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgcXVhbnRpemVfbGluZXNfeHJwb3coYWNjdW11bGF0ZSwgaXN0ZXAsIGFjY194cCwgYWNjX3hwUG9zLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWNjX2lEYXRhLCBhY2NfaURhdGFQb3MpO1xuICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGFjY3VtdWxhdGUwMSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHF1YW50aXplX2xpbmVzX3hycG93XzAxKGFjY3VtdWxhdGUwMSwgaXN0ZXAsIGFjY194cCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY194cFBvcywgYWNjX2lEYXRhLCBhY2NfaURhdGFQb3MpO1xuICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlMDEgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7IC8qIHNob3VsZCBjb21wdXRlIHRoaXMgcGFydCAqL1xuICAgICAgICAgICAgICAgIHZhciBsID0gY29kSW5mby53aWR0aFtzZmJdO1xuXG4gICAgICAgICAgICAgICAgaWYgKChqICsgY29kSW5mby53aWR0aFtzZmJdKSA+IGNvZEluZm8ubWF4X25vbnplcm9fY29lZmYpIHtcbiAgICAgICAgICAgICAgICAgICAgLyogZG8gbm90IGNvbXB1dGUgdXBwZXIgemVybyBwYXJ0ICovXG4gICAgICAgICAgICAgICAgICAgIHZhciB1c2VmdWxsc2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgdXNlZnVsbHNpemUgPSBjb2RJbmZvLm1heF9ub256ZXJvX2NvZWZmIC0gaiArIDE7XG4gICAgICAgICAgICAgICAgICAgIEFycmF5cy5maWxsKHBpLCBjb2RJbmZvLm1heF9ub256ZXJvX2NvZWZmLCA1NzYsIDApO1xuICAgICAgICAgICAgICAgICAgICBsID0gdXNlZnVsbHNpemU7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGwgPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8qIG5vIG5lZWQgdG8gY29tcHV0ZSBoaWdoZXIgc2ZiIHZhbHVlcyAqL1xuICAgICAgICAgICAgICAgICAgICBzZmIgPSBzZmJtYXggKyAxO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qIGFjY3VtdWxhdGUgbGluZXMgdG8gcXVhbnRpemUgKi9cbiAgICAgICAgICAgICAgICBpZiAoMCA9PSBhY2N1bXVsYXRlICYmIDAgPT0gYWNjdW11bGF0ZTAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGFjY19pRGF0YSA9IGlEYXRhO1xuICAgICAgICAgICAgICAgICAgICBhY2NfaURhdGFQb3MgPSBpRGF0YVBvcztcbiAgICAgICAgICAgICAgICAgICAgYWNjX3hwID0geHA7XG4gICAgICAgICAgICAgICAgICAgIGFjY194cFBvcyA9IHhwUG9zO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocHJldk5vaXNlICE9IG51bGwgJiYgcHJldk5vaXNlLnNmYl9jb3VudDEgPiAwXG4gICAgICAgICAgICAgICAgICAgICYmIHNmYiA+PSBwcmV2Tm9pc2Uuc2ZiX2NvdW50MVxuICAgICAgICAgICAgICAgICAgICAmJiBwcmV2Tm9pc2Uuc3RlcFtzZmJdID4gMFxuICAgICAgICAgICAgICAgICAgICAmJiBzdGVwID49IHByZXZOb2lzZS5zdGVwW3NmYl0pIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoYWNjdW11bGF0ZSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl6ZV9saW5lc194cnBvdyhhY2N1bXVsYXRlLCBpc3RlcCwgYWNjX3hwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY194cFBvcywgYWNjX2lEYXRhLCBhY2NfaURhdGFQb3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NfaURhdGEgPSBpRGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY19pRGF0YVBvcyA9IGlEYXRhUG9zO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjX3hwID0geHA7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NfeHBQb3MgPSB4cFBvcztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlMDEgKz0gbDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWNjdW11bGF0ZTAxICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXplX2xpbmVzX3hycG93XzAxKGFjY3VtdWxhdGUwMSwgaXN0ZXAsIGFjY194cCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NfeHBQb3MsIGFjY19pRGF0YSwgYWNjX2lEYXRhUG9zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY3VtdWxhdGUwMSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NfaURhdGEgPSBpRGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY19pRGF0YVBvcyA9IGlEYXRhUG9zO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjX3hwID0geHA7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NfeHBQb3MgPSB4cFBvcztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlICs9IGw7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGwgPD0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgKiByaDogMjAwNDAyMTUgbWF5IGhhcHBlbiBkdWUgdG8gXCJwcmV2X2RhdGFfdXNlXCJcbiAgICAgICAgICAgICAgICAgICAgICogb3B0aW1pemF0aW9uXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWNjdW11bGF0ZTAxICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXplX2xpbmVzX3hycG93XzAxKGFjY3VtdWxhdGUwMSwgaXN0ZXAsIGFjY194cCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NfeHBQb3MsIGFjY19pRGF0YSwgYWNjX2lEYXRhUG9zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY3VtdWxhdGUwMSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKGFjY3VtdWxhdGUgIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpemVfbGluZXNfeHJwb3coYWNjdW11bGF0ZSwgaXN0ZXAsIGFjY194cCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NfeHBQb3MsIGFjY19pRGF0YSwgYWNjX2lEYXRhUG9zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY3VtdWxhdGUgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIC8qIGVuZHMgZm9yLWxvb3AgKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2ZiIDw9IHNmYm1heCkge1xuICAgICAgICAgICAgICAgIGlEYXRhUG9zICs9IGNvZEluZm8ud2lkdGhbc2ZiXTtcbiAgICAgICAgICAgICAgICB4cFBvcyArPSBjb2RJbmZvLndpZHRoW3NmYl07XG4gICAgICAgICAgICAgICAgaiArPSBjb2RJbmZvLndpZHRoW3NmYl07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFjY3VtdWxhdGUgIT0gMCkgeyAvKiBsYXN0IGRhdGEgcGFydCAqL1xuICAgICAgICAgICAgcXVhbnRpemVfbGluZXNfeHJwb3coYWNjdW11bGF0ZSwgaXN0ZXAsIGFjY194cCwgYWNjX3hwUG9zLFxuICAgICAgICAgICAgICAgIGFjY19pRGF0YSwgYWNjX2lEYXRhUG9zKTtcbiAgICAgICAgICAgIGFjY3VtdWxhdGUgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhY2N1bXVsYXRlMDEgIT0gMCkgeyAvKiBsYXN0IGRhdGEgcGFydCAqL1xuICAgICAgICAgICAgcXVhbnRpemVfbGluZXNfeHJwb3dfMDEoYWNjdW11bGF0ZTAxLCBpc3RlcCwgYWNjX3hwLCBhY2NfeHBQb3MsXG4gICAgICAgICAgICAgICAgYWNjX2lEYXRhLCBhY2NfaURhdGFQb3MpO1xuICAgICAgICAgICAgYWNjdW11bGF0ZTAxID0gMDtcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogaXhfbWF4XG4gICAgICovXG4gICAgZnVuY3Rpb24gaXhfbWF4KGl4LCBpeFBvcywgZW5kUG9zKSB7XG4gICAgICAgIHZhciBtYXgxID0gMCwgbWF4MiA9IDA7XG5cbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgdmFyIHgxID0gaXhbaXhQb3MrK107XG4gICAgICAgICAgICB2YXIgeDIgPSBpeFtpeFBvcysrXTtcbiAgICAgICAgICAgIGlmIChtYXgxIDwgeDEpXG4gICAgICAgICAgICAgICAgbWF4MSA9IHgxO1xuXG4gICAgICAgICAgICBpZiAobWF4MiA8IHgyKVxuICAgICAgICAgICAgICAgIG1heDIgPSB4MjtcbiAgICAgICAgfSB3aGlsZSAoaXhQb3MgPCBlbmRQb3MpO1xuICAgICAgICBpZiAobWF4MSA8IG1heDIpXG4gICAgICAgICAgICBtYXgxID0gbWF4MjtcbiAgICAgICAgcmV0dXJuIG1heDE7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY291bnRfYml0X0VTQyhpeCwgaXhQb3MsIGVuZCwgdDEsIHQyLCBzKSB7XG4gICAgICAgIC8qIEVTQy10YWJsZSBpcyB1c2VkICovXG4gICAgICAgIHZhciBsaW5iaXRzID0gVGFibGVzLmh0W3QxXS54bGVuICogNjU1MzYgKyBUYWJsZXMuaHRbdDJdLnhsZW47XG4gICAgICAgIHZhciBzdW0gPSAwLCBzdW0yO1xuXG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIHZhciB4ID0gaXhbaXhQb3MrK107XG4gICAgICAgICAgICB2YXIgeSA9IGl4W2l4UG9zKytdO1xuXG4gICAgICAgICAgICBpZiAoeCAhPSAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKHggPiAxNCkge1xuICAgICAgICAgICAgICAgICAgICB4ID0gMTU7XG4gICAgICAgICAgICAgICAgICAgIHN1bSArPSBsaW5iaXRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB4ICo9IDE2O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoeSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKHkgPiAxNCkge1xuICAgICAgICAgICAgICAgICAgICB5ID0gMTU7XG4gICAgICAgICAgICAgICAgICAgIHN1bSArPSBsaW5iaXRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB4ICs9IHk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHN1bSArPSBUYWJsZXMubGFyZ2V0YmxbeF07XG4gICAgICAgIH0gd2hpbGUgKGl4UG9zIDwgZW5kKTtcblxuICAgICAgICBzdW0yID0gc3VtICYgMHhmZmZmO1xuICAgICAgICBzdW0gPj49IDE2O1xuXG4gICAgICAgIGlmIChzdW0gPiBzdW0yKSB7XG4gICAgICAgICAgICBzdW0gPSBzdW0yO1xuICAgICAgICAgICAgdDEgPSB0MjtcbiAgICAgICAgfVxuXG4gICAgICAgIHMuYml0cyArPSBzdW07XG4gICAgICAgIHJldHVybiB0MTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb3VudF9iaXRfbm9FU0MoaXgsIGl4UG9zLCBlbmQsIHMpIHtcbiAgICAgICAgLyogTm8gRVNDLXdvcmRzICovXG4gICAgICAgIHZhciBzdW0xID0gMDtcbiAgICAgICAgdmFyIGhsZW4xID0gVGFibGVzLmh0WzFdLmhsZW47XG5cbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgdmFyIHggPSBpeFtpeFBvcyArIDBdICogMiArIGl4W2l4UG9zICsgMV07XG4gICAgICAgICAgICBpeFBvcyArPSAyO1xuICAgICAgICAgICAgc3VtMSArPSBobGVuMVt4XTtcbiAgICAgICAgfSB3aGlsZSAoaXhQb3MgPCBlbmQpO1xuXG4gICAgICAgIHMuYml0cyArPSBzdW0xO1xuICAgICAgICByZXR1cm4gMTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb3VudF9iaXRfbm9FU0NfZnJvbTIoaXgsIGl4UG9zLCBlbmQsIHQxLCBzKSB7XG4gICAgICAgIC8qIE5vIEVTQy13b3JkcyAqL1xuICAgICAgICB2YXIgc3VtID0gMCwgc3VtMjtcbiAgICAgICAgdmFyIHhsZW4gPSBUYWJsZXMuaHRbdDFdLnhsZW47XG4gICAgICAgIHZhciBobGVuO1xuICAgICAgICBpZiAodDEgPT0gMilcbiAgICAgICAgICAgIGhsZW4gPSBUYWJsZXMudGFibGUyMztcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgaGxlbiA9IFRhYmxlcy50YWJsZTU2O1xuXG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIHZhciB4ID0gaXhbaXhQb3MgKyAwXSAqIHhsZW4gKyBpeFtpeFBvcyArIDFdO1xuICAgICAgICAgICAgaXhQb3MgKz0gMjtcbiAgICAgICAgICAgIHN1bSArPSBobGVuW3hdO1xuICAgICAgICB9IHdoaWxlIChpeFBvcyA8IGVuZCk7XG5cbiAgICAgICAgc3VtMiA9IHN1bSAmIDB4ZmZmZjtcbiAgICAgICAgc3VtID4+PSAxNjtcblxuICAgICAgICBpZiAoc3VtID4gc3VtMikge1xuICAgICAgICAgICAgc3VtID0gc3VtMjtcbiAgICAgICAgICAgIHQxKys7XG4gICAgICAgIH1cblxuICAgICAgICBzLmJpdHMgKz0gc3VtO1xuICAgICAgICByZXR1cm4gdDE7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY291bnRfYml0X25vRVNDX2Zyb20zKGl4LCBpeFBvcywgZW5kLCB0MSwgcykge1xuICAgICAgICAvKiBObyBFU0Mtd29yZHMgKi9cbiAgICAgICAgdmFyIHN1bTEgPSAwO1xuICAgICAgICB2YXIgc3VtMiA9IDA7XG4gICAgICAgIHZhciBzdW0zID0gMDtcbiAgICAgICAgdmFyIHhsZW4gPSBUYWJsZXMuaHRbdDFdLnhsZW47XG4gICAgICAgIHZhciBobGVuMSA9IFRhYmxlcy5odFt0MV0uaGxlbjtcbiAgICAgICAgdmFyIGhsZW4yID0gVGFibGVzLmh0W3QxICsgMV0uaGxlbjtcbiAgICAgICAgdmFyIGhsZW4zID0gVGFibGVzLmh0W3QxICsgMl0uaGxlbjtcblxuICAgICAgICBkbyB7XG4gICAgICAgICAgICB2YXIgeCA9IGl4W2l4UG9zICsgMF0gKiB4bGVuICsgaXhbaXhQb3MgKyAxXTtcbiAgICAgICAgICAgIGl4UG9zICs9IDI7XG4gICAgICAgICAgICBzdW0xICs9IGhsZW4xW3hdO1xuICAgICAgICAgICAgc3VtMiArPSBobGVuMlt4XTtcbiAgICAgICAgICAgIHN1bTMgKz0gaGxlbjNbeF07XG4gICAgICAgIH0gd2hpbGUgKGl4UG9zIDwgZW5kKTtcbiAgICAgICAgdmFyIHQgPSB0MTtcbiAgICAgICAgaWYgKHN1bTEgPiBzdW0yKSB7XG4gICAgICAgICAgICBzdW0xID0gc3VtMjtcbiAgICAgICAgICAgIHQrKztcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3VtMSA+IHN1bTMpIHtcbiAgICAgICAgICAgIHN1bTEgPSBzdW0zO1xuICAgICAgICAgICAgdCA9IHQxICsgMjtcbiAgICAgICAgfVxuICAgICAgICBzLmJpdHMgKz0gc3VtMTtcblxuICAgICAgICByZXR1cm4gdDtcbiAgICB9XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAvKiBjaG9vc2UgdGFibGUgKi9cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIHZhciBodWZfdGJsX25vRVNDID0gWzEsIDIsIDUsIDcsIDcsIDEwLCAxMCwgMTMsIDEzLFxuICAgICAgICAxMywgMTMsIDEzLCAxMywgMTMsIDEzXTtcblxuICAgIC8qKlxuICAgICAqIENob29zZSB0aGUgSHVmZm1hbiB0YWJsZSB0aGF0IHdpbGwgZW5jb2RlIGl4W2JlZ2luLi5lbmRdIHdpdGggdGhlIGZld2VzdFxuICAgICAqIGJpdHMuXG4gICAgICpcbiAgICAgKiBOb3RlOiBUaGlzIGNvZGUgY29udGFpbnMga25vd2xlZGdlIGFib3V0IHRoZSBzaXplcyBhbmQgY2hhcmFjdGVyaXN0aWNzIG9mXG4gICAgICogdGhlIEh1ZmZtYW4gdGFibGVzIGFzIGRlZmluZWQgaW4gdGhlIElTIChUYWJsZSBCLjcpLCBhbmQgd2lsbCBub3Qgd29ya1xuICAgICAqIHdpdGggYW55IGFyYml0cmFyeSB0YWJsZXMuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY2hvb3NlX3RhYmxlKGl4LCBpeFBvcywgZW5kUG9zLCBzKSB7XG4gICAgICAgIHZhciBtYXggPSBpeF9tYXgoaXgsIGl4UG9zLCBlbmRQb3MpO1xuXG4gICAgICAgIHN3aXRjaCAobWF4KSB7XG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1heDtcblxuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIHJldHVybiBjb3VudF9iaXRfbm9FU0MoaXgsIGl4UG9zLCBlbmRQb3MsIHMpO1xuXG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvdW50X2JpdF9ub0VTQ19mcm9tMihpeCwgaXhQb3MsIGVuZFBvcyxcbiAgICAgICAgICAgICAgICAgICAgaHVmX3RibF9ub0VTQ1ttYXggLSAxXSwgcyk7XG5cbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgIGNhc2UgNzpcbiAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgIGNhc2UgMTA6XG4gICAgICAgICAgICBjYXNlIDExOlxuICAgICAgICAgICAgY2FzZSAxMjpcbiAgICAgICAgICAgIGNhc2UgMTM6XG4gICAgICAgICAgICBjYXNlIDE0OlxuICAgICAgICAgICAgY2FzZSAxNTpcbiAgICAgICAgICAgICAgICByZXR1cm4gY291bnRfYml0X25vRVNDX2Zyb20zKGl4LCBpeFBvcywgZW5kUG9zLFxuICAgICAgICAgICAgICAgICAgICBodWZfdGJsX25vRVNDW21heCAtIDFdLCBzKTtcblxuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAvKiB0cnkgdGFibGVzIHdpdGggbGluYml0cyAqL1xuICAgICAgICAgICAgICAgIGlmIChtYXggPiBRdWFudGl6ZVBWVC5JWE1BWF9WQUwpIHtcbiAgICAgICAgICAgICAgICAgICAgcy5iaXRzID0gUXVhbnRpemVQVlQuTEFSR0VfQklUUztcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtYXggLT0gMTU7XG4gICAgICAgICAgICAgICAgdmFyIGNob2ljZTI7XG4gICAgICAgICAgICAgICAgZm9yIChjaG9pY2UyID0gMjQ7IGNob2ljZTIgPCAzMjsgY2hvaWNlMisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChUYWJsZXMuaHRbY2hvaWNlMl0ubGlubWF4ID49IG1heCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIGNob2ljZTtcbiAgICAgICAgICAgICAgICBmb3IgKGNob2ljZSA9IGNob2ljZTIgLSA4OyBjaG9pY2UgPCAyNDsgY2hvaWNlKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKFRhYmxlcy5odFtjaG9pY2VdLmxpbm1heCA+PSBtYXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBjb3VudF9iaXRfRVNDKGl4LCBpeFBvcywgZW5kUG9zLCBjaG9pY2UsIGNob2ljZTIsIHMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY291bnRfYml0XG4gICAgICovXG4gICAgdGhpcy5ub3F1YW50X2NvdW50X2JpdHMgPSBmdW5jdGlvbiAoZ2ZjLCBnaSwgcHJldl9ub2lzZSkge1xuICAgICAgICB2YXIgaXggPSBnaS5sM19lbmM7XG4gICAgICAgIHZhciBpID0gTWF0aC5taW4oNTc2LCAoKGdpLm1heF9ub256ZXJvX2NvZWZmICsgMikgPj4gMSkgPDwgMSk7XG5cbiAgICAgICAgaWYgKHByZXZfbm9pc2UgIT0gbnVsbClcbiAgICAgICAgICAgIHByZXZfbm9pc2Uuc2ZiX2NvdW50MSA9IDA7XG5cbiAgICAgICAgLyogRGV0ZXJtaW5lIGNvdW50MSByZWdpb24gKi9cbiAgICAgICAgZm9yICg7IGkgPiAxOyBpIC09IDIpXG4gICAgICAgICAgICBpZiAoKGl4W2kgLSAxXSB8IGl4W2kgLSAyXSkgIT0gMClcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgZ2kuY291bnQxID0gaTtcblxuICAgICAgICAvKiBEZXRlcm1pbmVzIHRoZSBudW1iZXIgb2YgYml0cyB0byBlbmNvZGUgdGhlIHF1YWRydXBsZXMuICovXG4gICAgICAgIHZhciBhMSA9IDA7XG4gICAgICAgIHZhciBhMiA9IDA7XG4gICAgICAgIGZvciAoOyBpID4gMzsgaSAtPSA0KSB7XG4gICAgICAgICAgICB2YXIgcDtcbiAgICAgICAgICAgIC8qIGhhY2sgdG8gY2hlY2sgaWYgYWxsIHZhbHVlcyA8PSAxICovXG4gICAgICAgICAgICAvL3Rocm93IFwiVE9ETzogSEFDSyAgICAgICAgIGlmICgoKChsb25nKSBpeFtpIC0gMV0gfCAobG9uZykgaXhbaSAtIDJdIHwgKGxvbmcpIGl4W2kgLSAzXSB8IChsb25nKSBpeFtpIC0gNF0pICYgMHhmZmZmZmZmZkwpID4gMUwgICAgICAgIFwiXG4gICAgICAgICAgICAvL2lmICh0cnVlKSB7XG4gICAgICAgICAgICBpZiAoKChpeFtpIC0gMV0gfCBpeFtpIC0gMl0gfCBpeFtpIC0gM10gfCBpeFtpIC0gNF0pICYgMHg3ZmZmZmZmZikgPiAxKSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwID0gKChpeFtpIC0gNF0gKiAyICsgaXhbaSAtIDNdKSAqIDIgKyBpeFtpIC0gMl0pICogMiArIGl4W2kgLSAxXTtcbiAgICAgICAgICAgIGExICs9IFRhYmxlcy50MzJsW3BdO1xuICAgICAgICAgICAgYTIgKz0gVGFibGVzLnQzM2xbcF07XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJpdHMgPSBhMTtcbiAgICAgICAgZ2kuY291bnQxdGFibGVfc2VsZWN0ID0gMDtcbiAgICAgICAgaWYgKGExID4gYTIpIHtcbiAgICAgICAgICAgIGJpdHMgPSBhMjtcbiAgICAgICAgICAgIGdpLmNvdW50MXRhYmxlX3NlbGVjdCA9IDE7XG4gICAgICAgIH1cblxuICAgICAgICBnaS5jb3VudDFiaXRzID0gYml0cztcbiAgICAgICAgZ2kuYmlnX3ZhbHVlcyA9IGk7XG4gICAgICAgIGlmIChpID09IDApXG4gICAgICAgICAgICByZXR1cm4gYml0cztcblxuICAgICAgICBpZiAoZ2kuYmxvY2tfdHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgIGExID0gMyAqIGdmYy5zY2FsZWZhY19iYW5kLnNbM107XG4gICAgICAgICAgICBpZiAoYTEgPiBnaS5iaWdfdmFsdWVzKVxuICAgICAgICAgICAgICAgIGExID0gZ2kuYmlnX3ZhbHVlcztcbiAgICAgICAgICAgIGEyID0gZ2kuYmlnX3ZhbHVlcztcblxuICAgICAgICB9IGVsc2UgaWYgKGdpLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5OT1JNX1RZUEUpIHtcbiAgICAgICAgICAgIC8qIGJ2X3NjZiBoYXMgNTc2IGVudHJpZXMgKDAuLjU3NSkgKi9cbiAgICAgICAgICAgIGExID0gZ2kucmVnaW9uMF9jb3VudCA9IGdmYy5idl9zY2ZbaSAtIDJdO1xuICAgICAgICAgICAgYTIgPSBnaS5yZWdpb24xX2NvdW50ID0gZ2ZjLmJ2X3NjZltpIC0gMV07XG5cbiAgICAgICAgICAgIGEyID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFthMSArIGEyICsgMl07XG4gICAgICAgICAgICBhMSA9IGdmYy5zY2FsZWZhY19iYW5kLmxbYTEgKyAxXTtcbiAgICAgICAgICAgIGlmIChhMiA8IGkpIHtcbiAgICAgICAgICAgICAgICB2YXIgYmkgPSBuZXcgQml0cyhiaXRzKTtcbiAgICAgICAgICAgICAgICBnaS50YWJsZV9zZWxlY3RbMl0gPSBjaG9vc2VfdGFibGUoaXgsIGEyLCBpLCBiaSk7XG4gICAgICAgICAgICAgICAgYml0cyA9IGJpLmJpdHM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBnaS5yZWdpb24wX2NvdW50ID0gNztcbiAgICAgICAgICAgIC8qIGdpLnJlZ2lvbjFfY291bnQgPSBTQlBTWV9sIC0gNyAtIDE7ICovXG4gICAgICAgICAgICBnaS5yZWdpb24xX2NvdW50ID0gRW5jb2Rlci5TQk1BWF9sIC0gMSAtIDcgLSAxO1xuICAgICAgICAgICAgYTEgPSBnZmMuc2NhbGVmYWNfYmFuZC5sWzcgKyAxXTtcbiAgICAgICAgICAgIGEyID0gaTtcbiAgICAgICAgICAgIGlmIChhMSA+IGEyKSB7XG4gICAgICAgICAgICAgICAgYTEgPSBhMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGhhdmUgdG8gYWxsb3cgZm9yIHRoZSBjYXNlIHdoZW4gYmlndmFsdWVzIDwgcmVnaW9uMCA8IHJlZ2lvbjEgKi9cbiAgICAgICAgLyogKGFuZCByZWdpb24wLCByZWdpb24xIGFyZSBpZ25vcmVkKSAqL1xuICAgICAgICBhMSA9IE1hdGgubWluKGExLCBpKTtcbiAgICAgICAgYTIgPSBNYXRoLm1pbihhMiwgaSk7XG5cblxuICAgICAgICAvKiBDb3VudCB0aGUgbnVtYmVyIG9mIGJpdHMgbmVjZXNzYXJ5IHRvIGNvZGUgdGhlIGJpZ3ZhbHVlcyByZWdpb24uICovXG4gICAgICAgIGlmICgwIDwgYTEpIHtcbiAgICAgICAgICAgIHZhciBiaSA9IG5ldyBCaXRzKGJpdHMpO1xuICAgICAgICAgICAgZ2kudGFibGVfc2VsZWN0WzBdID0gY2hvb3NlX3RhYmxlKGl4LCAwLCBhMSwgYmkpO1xuICAgICAgICAgICAgYml0cyA9IGJpLmJpdHM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGExIDwgYTIpIHtcbiAgICAgICAgICAgIHZhciBiaSA9IG5ldyBCaXRzKGJpdHMpO1xuICAgICAgICAgICAgZ2kudGFibGVfc2VsZWN0WzFdID0gY2hvb3NlX3RhYmxlKGl4LCBhMSwgYTIsIGJpKTtcbiAgICAgICAgICAgIGJpdHMgPSBiaS5iaXRzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChnZmMudXNlX2Jlc3RfaHVmZm1hbiA9PSAyKSB7XG4gICAgICAgICAgICBnaS5wYXJ0Ml8zX2xlbmd0aCA9IGJpdHM7XG4gICAgICAgICAgICBiZXN0X2h1ZmZtYW5fZGl2aWRlKGdmYywgZ2kpO1xuICAgICAgICAgICAgYml0cyA9IGdpLnBhcnQyXzNfbGVuZ3RoO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHByZXZfbm9pc2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgaWYgKGdpLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5OT1JNX1RZUEUpIHtcbiAgICAgICAgICAgICAgICB2YXIgc2ZiID0gMDtcbiAgICAgICAgICAgICAgICB3aGlsZSAoZ2ZjLnNjYWxlZmFjX2JhbmQubFtzZmJdIDwgZ2kuYmlnX3ZhbHVlcykge1xuICAgICAgICAgICAgICAgICAgICBzZmIrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJldl9ub2lzZS5zZmJfY291bnQxID0gc2ZiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGJpdHM7XG4gICAgfVxuXG4gICAgdGhpcy5jb3VudF9iaXRzID0gZnVuY3Rpb24gKGdmYywgeHIsIGdpLCBwcmV2X25vaXNlKSB7XG4gICAgICAgIHZhciBpeCA9IGdpLmwzX2VuYztcblxuICAgICAgICAvKiBzaW5jZSBxdWFudGl6ZV94cnBvdyB1c2VzIHRhYmxlIGxvb2t1cCwgd2UgbmVlZCB0byBjaGVjayB0aGlzIGZpcnN0OiAqL1xuICAgICAgICB2YXIgdyA9IChRdWFudGl6ZVBWVC5JWE1BWF9WQUwpIC8gcXVwdnQuSVBPVzIwKGdpLmdsb2JhbF9nYWluKTtcblxuICAgICAgICBpZiAoZ2kueHJwb3dfbWF4ID4gdylcbiAgICAgICAgICAgIHJldHVybiBRdWFudGl6ZVBWVC5MQVJHRV9CSVRTO1xuXG4gICAgICAgIHF1YW50aXplX3hycG93KHhyLCBpeCwgcXVwdnQuSVBPVzIwKGdpLmdsb2JhbF9nYWluKSwgZ2ksIHByZXZfbm9pc2UpO1xuXG4gICAgICAgIGlmICgoZ2ZjLnN1YnN0ZXBfc2hhcGluZyAmIDIpICE9IDApIHtcbiAgICAgICAgICAgIHZhciBqID0gMDtcbiAgICAgICAgICAgIC8qIDAuNjM0NTIxNjgyMjQyNDM5ID0gMC41OTQ2KjIqKiguNSowLjE4NzUpICovXG4gICAgICAgICAgICB2YXIgZ2FpbiA9IGdpLmdsb2JhbF9nYWluICsgZ2kuc2NhbGVmYWNfc2NhbGU7XG4gICAgICAgICAgICB2YXIgcm91bmRmYWMgPSAwLjYzNDUyMTY4MjI0MjQzOSAvIHF1cHZ0LklQT1cyMChnYWluKTtcbiAgICAgICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IGdpLnNmYm1heDsgc2ZiKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBnaS53aWR0aFtzZmJdO1xuICAgICAgICAgICAgICAgIGlmICgwID09IGdmYy5wc2V1ZG9oYWxmW3NmYl0pIHtcbiAgICAgICAgICAgICAgICAgICAgaiArPSB3aWR0aDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaztcbiAgICAgICAgICAgICAgICAgICAgZm9yIChrID0gaiwgaiArPSB3aWR0aDsgayA8IGo7ICsraykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXhba10gPSAoeHJba10gPj0gcm91bmRmYWMpID8gaXhba10gOiAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLm5vcXVhbnRfY291bnRfYml0cyhnZmMsIGdpLCBwcmV2X25vaXNlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiByZS1jYWxjdWxhdGUgdGhlIGJlc3Qgc2NhbGVmYWNfY29tcHJlc3MgdXNpbmcgc2Nmc2kgdGhlIHNhdmVkIGJpdHMgYXJlXG4gICAgICoga2VwdCBpbiB0aGUgYml0IHJlc2Vydm9pci5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZWNhbGNfZGl2aWRlX2luaXQoZ2ZjLCBjb2RfaW5mbywgaXgsIHIwMV9iaXRzLCByMDFfZGl2LCByMF90YmwsIHIxX3RibCkge1xuICAgICAgICB2YXIgYmlndiA9IGNvZF9pbmZvLmJpZ192YWx1ZXM7XG5cbiAgICAgICAgZm9yICh2YXIgcjAgPSAwOyByMCA8PSA3ICsgMTU7IHIwKyspIHtcbiAgICAgICAgICAgIHIwMV9iaXRzW3IwXSA9IFF1YW50aXplUFZULkxBUkdFX0JJVFM7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciByMCA9IDA7IHIwIDwgMTY7IHIwKyspIHtcbiAgICAgICAgICAgIHZhciBhMSA9IGdmYy5zY2FsZWZhY19iYW5kLmxbcjAgKyAxXTtcbiAgICAgICAgICAgIGlmIChhMSA+PSBiaWd2KVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgdmFyIHIwYml0cyA9IDA7XG4gICAgICAgICAgICB2YXIgYmkgPSBuZXcgQml0cyhyMGJpdHMpO1xuICAgICAgICAgICAgdmFyIHIwdCA9IGNob29zZV90YWJsZShpeCwgMCwgYTEsIGJpKTtcbiAgICAgICAgICAgIHIwYml0cyA9IGJpLmJpdHM7XG5cbiAgICAgICAgICAgIGZvciAodmFyIHIxID0gMDsgcjEgPCA4OyByMSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGEyID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFtyMCArIHIxICsgMl07XG4gICAgICAgICAgICAgICAgaWYgKGEyID49IGJpZ3YpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIHZhciBiaXRzID0gcjBiaXRzO1xuICAgICAgICAgICAgICAgIGJpID0gbmV3IEJpdHMoYml0cyk7XG4gICAgICAgICAgICAgICAgdmFyIHIxdCA9IGNob29zZV90YWJsZShpeCwgYTEsIGEyLCBiaSk7XG4gICAgICAgICAgICAgICAgYml0cyA9IGJpLmJpdHM7XG4gICAgICAgICAgICAgICAgaWYgKHIwMV9iaXRzW3IwICsgcjFdID4gYml0cykge1xuICAgICAgICAgICAgICAgICAgICByMDFfYml0c1tyMCArIHIxXSA9IGJpdHM7XG4gICAgICAgICAgICAgICAgICAgIHIwMV9kaXZbcjAgKyByMV0gPSByMDtcbiAgICAgICAgICAgICAgICAgICAgcjBfdGJsW3IwICsgcjFdID0gcjB0O1xuICAgICAgICAgICAgICAgICAgICByMV90YmxbcjAgKyByMV0gPSByMXQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVjYWxjX2RpdmlkZV9zdWIoZ2ZjLCBjb2RfaW5mbzIsIGdpLCBpeCwgcjAxX2JpdHMsIHIwMV9kaXYsIHIwX3RibCwgcjFfdGJsKSB7XG4gICAgICAgIHZhciBiaWd2ID0gY29kX2luZm8yLmJpZ192YWx1ZXM7XG5cbiAgICAgICAgZm9yICh2YXIgcjIgPSAyOyByMiA8IEVuY29kZXIuU0JNQVhfbCArIDE7IHIyKyspIHtcbiAgICAgICAgICAgIHZhciBhMiA9IGdmYy5zY2FsZWZhY19iYW5kLmxbcjJdO1xuICAgICAgICAgICAgaWYgKGEyID49IGJpZ3YpXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB2YXIgYml0cyA9IHIwMV9iaXRzW3IyIC0gMl0gKyBjb2RfaW5mbzIuY291bnQxYml0cztcbiAgICAgICAgICAgIGlmIChnaS5wYXJ0Ml8zX2xlbmd0aCA8PSBiaXRzKVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICB2YXIgYmkgPSBuZXcgQml0cyhiaXRzKTtcbiAgICAgICAgICAgIHZhciByMnQgPSBjaG9vc2VfdGFibGUoaXgsIGEyLCBiaWd2LCBiaSk7XG4gICAgICAgICAgICBiaXRzID0gYmkuYml0cztcbiAgICAgICAgICAgIGlmIChnaS5wYXJ0Ml8zX2xlbmd0aCA8PSBiaXRzKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICBnaS5hc3NpZ24oY29kX2luZm8yKTtcbiAgICAgICAgICAgIGdpLnBhcnQyXzNfbGVuZ3RoID0gYml0cztcbiAgICAgICAgICAgIGdpLnJlZ2lvbjBfY291bnQgPSByMDFfZGl2W3IyIC0gMl07XG4gICAgICAgICAgICBnaS5yZWdpb24xX2NvdW50ID0gcjIgLSAyIC0gcjAxX2RpdltyMiAtIDJdO1xuICAgICAgICAgICAgZ2kudGFibGVfc2VsZWN0WzBdID0gcjBfdGJsW3IyIC0gMl07XG4gICAgICAgICAgICBnaS50YWJsZV9zZWxlY3RbMV0gPSByMV90YmxbcjIgLSAyXTtcbiAgICAgICAgICAgIGdpLnRhYmxlX3NlbGVjdFsyXSA9IHIydDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuYmVzdF9odWZmbWFuX2RpdmlkZSA9IGZ1bmN0aW9uIChnZmMsIGdpKSB7XG4gICAgICAgIHZhciBjb2RfaW5mbzIgPSBuZXcgR3JJbmZvKCk7XG4gICAgICAgIHZhciBpeCA9IGdpLmwzX2VuYztcbiAgICAgICAgdmFyIHIwMV9iaXRzID0gbmV3X2ludCg3ICsgMTUgKyAxKTtcbiAgICAgICAgdmFyIHIwMV9kaXYgPSBuZXdfaW50KDcgKyAxNSArIDEpO1xuICAgICAgICB2YXIgcjBfdGJsID0gbmV3X2ludCg3ICsgMTUgKyAxKTtcbiAgICAgICAgdmFyIHIxX3RibCA9IG5ld19pbnQoNyArIDE1ICsgMSk7XG5cbiAgICAgICAgLyogU0hPUlQgQkxPQ0sgc3R1ZmYgZmFpbHMgZm9yIE1QRUcyICovXG4gICAgICAgIGlmIChnaS5ibG9ja190eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRSAmJiBnZmMubW9kZV9nciA9PSAxKVxuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIGNvZF9pbmZvMi5hc3NpZ24oZ2kpO1xuICAgICAgICBpZiAoZ2kuYmxvY2tfdHlwZSA9PSBFbmNvZGVyLk5PUk1fVFlQRSkge1xuICAgICAgICAgICAgcmVjYWxjX2RpdmlkZV9pbml0KGdmYywgZ2ksIGl4LCByMDFfYml0cywgcjAxX2RpdiwgcjBfdGJsLCByMV90YmwpO1xuICAgICAgICAgICAgcmVjYWxjX2RpdmlkZV9zdWIoZ2ZjLCBjb2RfaW5mbzIsIGdpLCBpeCwgcjAxX2JpdHMsIHIwMV9kaXYsXG4gICAgICAgICAgICAgICAgcjBfdGJsLCByMV90YmwpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBpID0gY29kX2luZm8yLmJpZ192YWx1ZXM7XG4gICAgICAgIGlmIChpID09IDAgfHwgKGl4W2kgLSAyXSB8IGl4W2kgLSAxXSkgPiAxKVxuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIGkgPSBnaS5jb3VudDEgKyAyO1xuICAgICAgICBpZiAoaSA+IDU3NilcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAvKiBEZXRlcm1pbmVzIHRoZSBudW1iZXIgb2YgYml0cyB0byBlbmNvZGUgdGhlIHF1YWRydXBsZXMuICovXG4gICAgICAgIGNvZF9pbmZvMi5hc3NpZ24oZ2kpO1xuICAgICAgICBjb2RfaW5mbzIuY291bnQxID0gaTtcbiAgICAgICAgdmFyIGExID0gMDtcbiAgICAgICAgdmFyIGEyID0gMDtcblxuXG4gICAgICAgIGZvciAoOyBpID4gY29kX2luZm8yLmJpZ192YWx1ZXM7IGkgLT0gNCkge1xuICAgICAgICAgICAgdmFyIHAgPSAoKGl4W2kgLSA0XSAqIDIgKyBpeFtpIC0gM10pICogMiArIGl4W2kgLSAyXSkgKiAyXG4gICAgICAgICAgICAgICAgKyBpeFtpIC0gMV07XG4gICAgICAgICAgICBhMSArPSBUYWJsZXMudDMybFtwXTtcbiAgICAgICAgICAgIGEyICs9IFRhYmxlcy50MzNsW3BdO1xuICAgICAgICB9XG4gICAgICAgIGNvZF9pbmZvMi5iaWdfdmFsdWVzID0gaTtcblxuICAgICAgICBjb2RfaW5mbzIuY291bnQxdGFibGVfc2VsZWN0ID0gMDtcbiAgICAgICAgaWYgKGExID4gYTIpIHtcbiAgICAgICAgICAgIGExID0gYTI7XG4gICAgICAgICAgICBjb2RfaW5mbzIuY291bnQxdGFibGVfc2VsZWN0ID0gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvZF9pbmZvMi5jb3VudDFiaXRzID0gYTE7XG5cbiAgICAgICAgaWYgKGNvZF9pbmZvMi5ibG9ja190eXBlID09IEVuY29kZXIuTk9STV9UWVBFKVxuICAgICAgICAgICAgcmVjYWxjX2RpdmlkZV9zdWIoZ2ZjLCBjb2RfaW5mbzIsIGdpLCBpeCwgcjAxX2JpdHMsIHIwMV9kaXYsXG4gICAgICAgICAgICAgICAgcjBfdGJsLCByMV90YmwpO1xuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8qIENvdW50IHRoZSBudW1iZXIgb2YgYml0cyBuZWNlc3NhcnkgdG8gY29kZSB0aGUgYmlndmFsdWVzIHJlZ2lvbi4gKi9cbiAgICAgICAgICAgIGNvZF9pbmZvMi5wYXJ0Ml8zX2xlbmd0aCA9IGExO1xuICAgICAgICAgICAgYTEgPSBnZmMuc2NhbGVmYWNfYmFuZC5sWzcgKyAxXTtcbiAgICAgICAgICAgIGlmIChhMSA+IGkpIHtcbiAgICAgICAgICAgICAgICBhMSA9IGk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoYTEgPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJpID0gbmV3IEJpdHMoY29kX2luZm8yLnBhcnQyXzNfbGVuZ3RoKTtcbiAgICAgICAgICAgICAgICBjb2RfaW5mbzIudGFibGVfc2VsZWN0WzBdID0gY2hvb3NlX3RhYmxlKGl4LCAwLCBhMSwgYmkpO1xuICAgICAgICAgICAgICAgIGNvZF9pbmZvMi5wYXJ0Ml8zX2xlbmd0aCA9IGJpLmJpdHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaSA+IGExKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJpID0gbmV3IEJpdHMoY29kX2luZm8yLnBhcnQyXzNfbGVuZ3RoKTtcbiAgICAgICAgICAgICAgICBjb2RfaW5mbzIudGFibGVfc2VsZWN0WzFdID0gY2hvb3NlX3RhYmxlKGl4LCBhMSwgaSwgYmkpO1xuICAgICAgICAgICAgICAgIGNvZF9pbmZvMi5wYXJ0Ml8zX2xlbmd0aCA9IGJpLmJpdHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ2kucGFydDJfM19sZW5ndGggPiBjb2RfaW5mbzIucGFydDJfM19sZW5ndGgpXG4gICAgICAgICAgICAgICAgZ2kuYXNzaWduKGNvZF9pbmZvMik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgc2xlbjFfbiA9IFsxLCAxLCAxLCAxLCA4LCAyLCAyLCAyLCA0LCA0LCA0LCA4LCA4LCA4LCAxNiwgMTZdO1xuICAgIHZhciBzbGVuMl9uID0gWzEsIDIsIDQsIDgsIDEsIDIsIDQsIDgsIDIsIDQsIDgsIDIsIDQsIDgsIDQsIDhdO1xuICAgIHZhciBzbGVuMV90YWIgPSBbMCwgMCwgMCwgMCwgMywgMSwgMSwgMSwgMiwgMiwgMiwgMywgMywgMywgNCwgNF07XG4gICAgdmFyIHNsZW4yX3RhYiA9IFswLCAxLCAyLCAzLCAwLCAxLCAyLCAzLCAxLCAyLCAzLCAxLCAyLCAzLCAyLCAzXTtcbiAgICBUYWtlaGlyby5zbGVuMV90YWIgPSBzbGVuMV90YWI7XG4gICAgVGFrZWhpcm8uc2xlbjJfdGFiID0gc2xlbjJfdGFiO1xuXG4gICAgZnVuY3Rpb24gc2Nmc2lfY2FsYyhjaCwgbDNfc2lkZSkge1xuICAgICAgICB2YXIgc2ZiO1xuICAgICAgICB2YXIgZ2kgPSBsM19zaWRlLnR0WzFdW2NoXTtcbiAgICAgICAgdmFyIGcwID0gbDNfc2lkZS50dFswXVtjaF07XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBUYWJsZXMuc2Nmc2lfYmFuZC5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICAgIGZvciAoc2ZiID0gVGFibGVzLnNjZnNpX2JhbmRbaV07IHNmYiA8IFRhYmxlcy5zY2ZzaV9iYW5kW2kgKyAxXTsgc2ZiKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoZzAuc2NhbGVmYWNbc2ZiXSAhPSBnaS5zY2FsZWZhY1tzZmJdXG4gICAgICAgICAgICAgICAgICAgICYmIGdpLnNjYWxlZmFjW3NmYl0gPj0gMClcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2ZiID09IFRhYmxlcy5zY2ZzaV9iYW5kW2kgKyAxXSkge1xuICAgICAgICAgICAgICAgIGZvciAoc2ZiID0gVGFibGVzLnNjZnNpX2JhbmRbaV07IHNmYiA8IFRhYmxlcy5zY2ZzaV9iYW5kW2kgKyAxXTsgc2ZiKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZ2kuc2NhbGVmYWNbc2ZiXSA9IC0xO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBsM19zaWRlLnNjZnNpW2NoXVtpXSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHMxID0gMDtcbiAgICAgICAgdmFyIGMxID0gMDtcbiAgICAgICAgZm9yIChzZmIgPSAwOyBzZmIgPCAxMTsgc2ZiKyspIHtcbiAgICAgICAgICAgIGlmIChnaS5zY2FsZWZhY1tzZmJdID09IC0xKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgYzErKztcbiAgICAgICAgICAgIGlmIChzMSA8IGdpLnNjYWxlZmFjW3NmYl0pXG4gICAgICAgICAgICAgICAgczEgPSBnaS5zY2FsZWZhY1tzZmJdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBzMiA9IDA7XG4gICAgICAgIHZhciBjMiA9IDA7XG4gICAgICAgIGZvciAoOyBzZmIgPCBFbmNvZGVyLlNCUFNZX2w7IHNmYisrKSB7XG4gICAgICAgICAgICBpZiAoZ2kuc2NhbGVmYWNbc2ZiXSA9PSAtMSlcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIGMyKys7XG4gICAgICAgICAgICBpZiAoczIgPCBnaS5zY2FsZWZhY1tzZmJdKVxuICAgICAgICAgICAgICAgIHMyID0gZ2kuc2NhbGVmYWNbc2ZiXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTY7IGkrKykge1xuICAgICAgICAgICAgaWYgKHMxIDwgc2xlbjFfbltpXSAmJiBzMiA8IHNsZW4yX25baV0pIHtcbiAgICAgICAgICAgICAgICB2YXIgYyA9IHNsZW4xX3RhYltpXSAqIGMxICsgc2xlbjJfdGFiW2ldICogYzI7XG4gICAgICAgICAgICAgICAgaWYgKGdpLnBhcnQyX2xlbmd0aCA+IGMpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2kucGFydDJfbGVuZ3RoID0gYztcbiAgICAgICAgICAgICAgICAgICAgZ2kuc2NhbGVmYWNfY29tcHJlc3MgPSBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEZpbmQgdGhlIG9wdGltYWwgd2F5IHRvIHN0b3JlIHRoZSBzY2FsZWZhY3RvcnMuIE9ubHkgY2FsbCB0aGlzIHJvdXRpbmVcbiAgICAgKiBhZnRlciBmaW5hbCBzY2FsZWZhY3RvcnMgaGF2ZSBiZWVuIGNob3NlbiBhbmQgdGhlIGNoYW5uZWwvZ3JhbnVsZSB3aWxsXG4gICAgICogbm90IGJlIHJlLWVuY29kZWQuXG4gICAgICovXG4gICAgdGhpcy5iZXN0X3NjYWxlZmFjX3N0b3JlID0gZnVuY3Rpb24gKGdmYywgZ3IsIGNoLCBsM19zaWRlKSB7XG4gICAgICAgIC8qIHVzZSBzY2FsZWZhY19zY2FsZSBpZiB3ZSBjYW4gKi9cbiAgICAgICAgdmFyIGdpID0gbDNfc2lkZS50dFtncl1bY2hdO1xuICAgICAgICB2YXIgc2ZiLCBpLCBqLCBsO1xuICAgICAgICB2YXIgcmVjYWxjID0gMDtcblxuICAgICAgICAvKlxuICAgICAgICAgKiByZW1vdmUgc2NhbGVmYWNzIGZyb20gYmFuZHMgd2l0aCBpeD0wLiBUaGlzIGlkZWEgY29tZXMgZnJvbSB0aGUgQUFDXG4gICAgICAgICAqIElTTyBkb2NzLiBhZGRlZCBtdCAzLzAwXG4gICAgICAgICAqL1xuICAgICAgICAvKiBjaGVjayBpZiBsM19lbmM9MCAqL1xuICAgICAgICBqID0gMDtcbiAgICAgICAgZm9yIChzZmIgPSAwOyBzZmIgPCBnaS5zZmJtYXg7IHNmYisrKSB7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSBnaS53aWR0aFtzZmJdO1xuICAgICAgICAgICAgaiArPSB3aWR0aDtcbiAgICAgICAgICAgIGZvciAobCA9IC13aWR0aDsgbCA8IDA7IGwrKykge1xuICAgICAgICAgICAgICAgIGlmIChnaS5sM19lbmNbbCArIGpdICE9IDApXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGwgPT0gMClcbiAgICAgICAgICAgICAgICBnaS5zY2FsZWZhY1tzZmJdID0gcmVjYWxjID0gLTI7XG4gICAgICAgICAgICAvKiBhbnl0aGluZyBnb2VzLiAqL1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIG9ubHkgYmVzdF9zY2FsZWZhY19zdG9yZSBhbmQgY2FsY19zY2ZzaSBrbm93LS1hbmQgb25seSB0aGV5XG4gICAgICAgICAgICAgKiBzaG91bGQga25vdy0tYWJvdXQgdGhlIG1hZ2ljIG51bWJlciAtMi5cbiAgICAgICAgICAgICAqL1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKDAgPT0gZ2kuc2NhbGVmYWNfc2NhbGUgJiYgMCA9PSBnaS5wcmVmbGFnKSB7XG4gICAgICAgICAgICB2YXIgcyA9IDA7XG4gICAgICAgICAgICBmb3IgKHNmYiA9IDA7IHNmYiA8IGdpLnNmYm1heDsgc2ZiKyspXG4gICAgICAgICAgICAgICAgaWYgKGdpLnNjYWxlZmFjW3NmYl0gPiAwKVxuICAgICAgICAgICAgICAgICAgICBzIHw9IGdpLnNjYWxlZmFjW3NmYl07XG5cbiAgICAgICAgICAgIGlmICgwID09IChzICYgMSkgJiYgcyAhPSAwKSB7XG4gICAgICAgICAgICAgICAgZm9yIChzZmIgPSAwOyBzZmIgPCBnaS5zZmJtYXg7IHNmYisrKVxuICAgICAgICAgICAgICAgICAgICBpZiAoZ2kuc2NhbGVmYWNbc2ZiXSA+IDApXG4gICAgICAgICAgICAgICAgICAgICAgICBnaS5zY2FsZWZhY1tzZmJdID4+PSAxO1xuXG4gICAgICAgICAgICAgICAgZ2kuc2NhbGVmYWNfc2NhbGUgPSByZWNhbGMgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKDAgPT0gZ2kucHJlZmxhZyAmJiBnaS5ibG9ja190eXBlICE9IEVuY29kZXIuU0hPUlRfVFlQRVxuICAgICAgICAgICAgJiYgZ2ZjLm1vZGVfZ3IgPT0gMikge1xuICAgICAgICAgICAgZm9yIChzZmIgPSAxMTsgc2ZiIDwgRW5jb2Rlci5TQlBTWV9sOyBzZmIrKylcbiAgICAgICAgICAgICAgICBpZiAoZ2kuc2NhbGVmYWNbc2ZiXSA8IHF1cHZ0LnByZXRhYltzZmJdXG4gICAgICAgICAgICAgICAgICAgICYmIGdpLnNjYWxlZmFjW3NmYl0gIT0gLTIpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgaWYgKHNmYiA9PSBFbmNvZGVyLlNCUFNZX2wpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHNmYiA9IDExOyBzZmIgPCBFbmNvZGVyLlNCUFNZX2w7IHNmYisrKVxuICAgICAgICAgICAgICAgICAgICBpZiAoZ2kuc2NhbGVmYWNbc2ZiXSA+IDApXG4gICAgICAgICAgICAgICAgICAgICAgICBnaS5zY2FsZWZhY1tzZmJdIC09IHF1cHZ0LnByZXRhYltzZmJdO1xuXG4gICAgICAgICAgICAgICAgZ2kucHJlZmxhZyA9IHJlY2FsYyA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgNDsgaSsrKVxuICAgICAgICAgICAgbDNfc2lkZS5zY2ZzaVtjaF1baV0gPSAwO1xuXG4gICAgICAgIGlmIChnZmMubW9kZV9nciA9PSAyICYmIGdyID09IDFcbiAgICAgICAgICAgICYmIGwzX3NpZGUudHRbMF1bY2hdLmJsb2NrX3R5cGUgIT0gRW5jb2Rlci5TSE9SVF9UWVBFXG4gICAgICAgICAgICAmJiBsM19zaWRlLnR0WzFdW2NoXS5ibG9ja190eXBlICE9IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgc2Nmc2lfY2FsYyhjaCwgbDNfc2lkZSk7XG4gICAgICAgICAgICByZWNhbGMgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoc2ZiID0gMDsgc2ZiIDwgZ2kuc2ZibWF4OyBzZmIrKykge1xuICAgICAgICAgICAgaWYgKGdpLnNjYWxlZmFjW3NmYl0gPT0gLTIpIHtcbiAgICAgICAgICAgICAgICBnaS5zY2FsZWZhY1tzZmJdID0gMDtcbiAgICAgICAgICAgICAgICAvKiBpZiBhbnl0aGluZyBnb2VzLCB0aGVuIDAgaXMgYSBnb29kIGNob2ljZSAqL1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChyZWNhbGMgIT0gMCkge1xuICAgICAgICAgICAgaWYgKGdmYy5tb2RlX2dyID09IDIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNjYWxlX2JpdGNvdW50KGdpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zY2FsZV9iaXRjb3VudF9sc2YoZ2ZjLCBnaSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBhbGxfc2NhbGVmYWN0b3JzX25vdF9uZWdhdGl2ZShzY2FsZWZhYywgbikge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG47ICsraSkge1xuICAgICAgICAgICAgaWYgKHNjYWxlZmFjW2ldIDwgMClcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogbnVtYmVyIG9mIGJpdHMgdXNlZCB0byBlbmNvZGUgc2NhbGVmYWNzLlxuICAgICAqXG4gICAgICogMTgqc2xlbjFfdGFiW2ldICsgMTgqc2xlbjJfdGFiW2ldXG4gICAgICovXG4gICAgdmFyIHNjYWxlX3Nob3J0ID0gWzAsIDE4LCAzNiwgNTQsIDU0LCAzNiwgNTQsIDcyLFxuICAgICAgICA1NCwgNzIsIDkwLCA3MiwgOTAsIDEwOCwgMTA4LCAxMjZdO1xuXG4gICAgLyoqXG4gICAgICogbnVtYmVyIG9mIGJpdHMgdXNlZCB0byBlbmNvZGUgc2NhbGVmYWNzLlxuICAgICAqXG4gICAgICogMTcqc2xlbjFfdGFiW2ldICsgMTgqc2xlbjJfdGFiW2ldXG4gICAgICovXG4gICAgdmFyIHNjYWxlX21peGVkID0gWzAsIDE4LCAzNiwgNTQsIDUxLCAzNSwgNTMsIDcxLFxuICAgICAgICA1MiwgNzAsIDg4LCA2OSwgODcsIDEwNSwgMTA0LCAxMjJdO1xuXG4gICAgLyoqXG4gICAgICogbnVtYmVyIG9mIGJpdHMgdXNlZCB0byBlbmNvZGUgc2NhbGVmYWNzLlxuICAgICAqXG4gICAgICogMTEqc2xlbjFfdGFiW2ldICsgMTAqc2xlbjJfdGFiW2ldXG4gICAgICovXG4gICAgdmFyIHNjYWxlX2xvbmcgPSBbMCwgMTAsIDIwLCAzMCwgMzMsIDIxLCAzMSwgNDEsIDMyLCA0MixcbiAgICAgICAgNTIsIDQzLCA1MywgNjMsIDY0LCA3NF07XG5cbiAgICAvKipcbiAgICAgKiBBbHNvIGNhbGN1bGF0ZXMgdGhlIG51bWJlciBvZiBiaXRzIG5lY2Vzc2FyeSB0byBjb2RlIHRoZSBzY2FsZWZhY3RvcnMuXG4gICAgICovXG4gICAgdGhpcy5zY2FsZV9iaXRjb3VudCA9IGZ1bmN0aW9uIChjb2RfaW5mbykge1xuICAgICAgICB2YXIgaywgc2ZiLCBtYXhfc2xlbjEgPSAwLCBtYXhfc2xlbjIgPSAwO1xuXG4gICAgICAgIC8qIG1heGltdW0gdmFsdWVzICovXG4gICAgICAgIHZhciB0YWI7XG4gICAgICAgIHZhciBzY2FsZWZhYyA9IGNvZF9pbmZvLnNjYWxlZmFjO1xuXG5cbiAgICAgICAgaWYgKGNvZF9pbmZvLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICB0YWIgPSBzY2FsZV9zaG9ydDtcbiAgICAgICAgICAgIGlmIChjb2RfaW5mby5taXhlZF9ibG9ja19mbGFnICE9IDApXG4gICAgICAgICAgICAgICAgdGFiID0gc2NhbGVfbWl4ZWQ7XG4gICAgICAgIH0gZWxzZSB7IC8qIGJsb2NrX3R5cGUgPT0gMSwyLG9yIDMgKi9cbiAgICAgICAgICAgIHRhYiA9IHNjYWxlX2xvbmc7XG4gICAgICAgICAgICBpZiAoMCA9PSBjb2RfaW5mby5wcmVmbGFnKSB7XG4gICAgICAgICAgICAgICAgZm9yIChzZmIgPSAxMTsgc2ZiIDwgRW5jb2Rlci5TQlBTWV9sOyBzZmIrKylcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNjYWxlZmFjW3NmYl0gPCBxdXB2dC5wcmV0YWJbc2ZiXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgaWYgKHNmYiA9PSBFbmNvZGVyLlNCUFNZX2wpIHtcbiAgICAgICAgICAgICAgICAgICAgY29kX2luZm8ucHJlZmxhZyA9IDE7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoc2ZiID0gMTE7IHNmYiA8IEVuY29kZXIuU0JQU1lfbDsgc2ZiKyspXG4gICAgICAgICAgICAgICAgICAgICAgICBzY2FsZWZhY1tzZmJdIC09IHF1cHZ0LnByZXRhYltzZmJdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoc2ZiID0gMDsgc2ZiIDwgY29kX2luZm8uc2ZiZGl2aWRlOyBzZmIrKylcbiAgICAgICAgICAgIGlmIChtYXhfc2xlbjEgPCBzY2FsZWZhY1tzZmJdKVxuICAgICAgICAgICAgICAgIG1heF9zbGVuMSA9IHNjYWxlZmFjW3NmYl07XG5cbiAgICAgICAgZm9yICg7IHNmYiA8IGNvZF9pbmZvLnNmYm1heDsgc2ZiKyspXG4gICAgICAgICAgICBpZiAobWF4X3NsZW4yIDwgc2NhbGVmYWNbc2ZiXSlcbiAgICAgICAgICAgICAgICBtYXhfc2xlbjIgPSBzY2FsZWZhY1tzZmJdO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGZyb20gVGFrZWhpcm8gVE9NSU5BR0EgPHRvbWluYWdhQGlzb3Rlcm5ldC5vcmc+IDEwLzk5IGxvb3Agb3ZlciAqYWxsKlxuICAgICAgICAgKiBwb3NpYmxlIHZhbHVlcyBvZiBzY2FsZWZhY19jb21wcmVzcyB0byBmaW5kIHRoZSBvbmUgd2hpY2ggdXNlcyB0aGVcbiAgICAgICAgICogc21hbGxlc3QgbnVtYmVyIG9mIGJpdHMuIElTTyB3b3VsZCBzdG9wIGF0IGZpcnN0IHZhbGlkIGluZGV4XG4gICAgICAgICAqL1xuICAgICAgICBjb2RfaW5mby5wYXJ0Ml9sZW5ndGggPSBRdWFudGl6ZVBWVC5MQVJHRV9CSVRTO1xuICAgICAgICBmb3IgKGsgPSAwOyBrIDwgMTY7IGsrKykge1xuICAgICAgICAgICAgaWYgKG1heF9zbGVuMSA8IHNsZW4xX25ba10gJiYgbWF4X3NsZW4yIDwgc2xlbjJfbltrXVxuICAgICAgICAgICAgICAgICYmIGNvZF9pbmZvLnBhcnQyX2xlbmd0aCA+IHRhYltrXSkge1xuICAgICAgICAgICAgICAgIGNvZF9pbmZvLnBhcnQyX2xlbmd0aCA9IHRhYltrXTtcbiAgICAgICAgICAgICAgICBjb2RfaW5mby5zY2FsZWZhY19jb21wcmVzcyA9IGs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvZF9pbmZvLnBhcnQyX2xlbmd0aCA9PSBRdWFudGl6ZVBWVC5MQVJHRV9CSVRTO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHRhYmxlIG9mIGxhcmdlc3Qgc2NhbGVmYWN0b3IgdmFsdWVzIGZvciBNUEVHMlxuICAgICAqL1xuICAgIHZhciBtYXhfcmFuZ2Vfc2ZhY190YWIgPSBbWzE1LCAxNSwgNywgN10sXG4gICAgICAgIFsxNSwgMTUsIDcsIDBdLCBbNywgMywgMCwgMF0sIFsxNSwgMzEsIDMxLCAwXSxcbiAgICAgICAgWzcsIDcsIDcsIDBdLCBbMywgMywgMCwgMF1dO1xuXG4gICAgLyoqXG4gICAgICogQWxzbyBjb3VudHMgdGhlIG51bWJlciBvZiBiaXRzIHRvIGVuY29kZSB0aGUgc2NhbGVmYWNzIGJ1dCBmb3IgTVBFRyAyXG4gICAgICogTG93ZXIgc2FtcGxpbmcgZnJlcXVlbmNpZXMgKDI0LCAyMi4wNSBhbmQgMTYga0h6LilcbiAgICAgKlxuICAgICAqIFRoaXMgaXMgcmV2ZXJzZS1lbmdpbmVlcmVkIGZyb20gc2VjdGlvbiAyLjQuMy4yIG9mIHRoZSBNUEVHMiBJUyxcbiAgICAgKiBcIkF1ZGlvIERlY29kaW5nIExheWVyIElJSVwiXG4gICAgICovXG4gICAgdGhpcy5zY2FsZV9iaXRjb3VudF9sc2YgPSBmdW5jdGlvbiAoZ2ZjLCBjb2RfaW5mbykge1xuICAgICAgICB2YXIgdGFibGVfbnVtYmVyLCByb3dfaW5fdGFibGUsIHBhcnRpdGlvbiwgbnJfc2ZiLCB3aW5kb3c7XG4gICAgICAgIHZhciBvdmVyO1xuICAgICAgICB2YXIgaSwgc2ZiO1xuICAgICAgICB2YXIgbWF4X3NmYWMgPSBuZXdfaW50KDQpO1xuLy92YXIgcGFydGl0aW9uX3RhYmxlO1xuICAgICAgICB2YXIgc2NhbGVmYWMgPSBjb2RfaW5mby5zY2FsZWZhYztcblxuICAgICAgICAvKlxuICAgICAgICAgKiBTZXQgcGFydGl0aW9uIHRhYmxlLiBOb3RlIHRoYXQgc2hvdWxkIHRyeSB0byB1c2UgdGFibGUgb25lLCBidXQgZG9cbiAgICAgICAgICogbm90IHlldC4uLlxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGNvZF9pbmZvLnByZWZsYWcgIT0gMClcbiAgICAgICAgICAgIHRhYmxlX251bWJlciA9IDI7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHRhYmxlX251bWJlciA9IDA7XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IDQ7IGkrKylcbiAgICAgICAgICAgIG1heF9zZmFjW2ldID0gMDtcblxuICAgICAgICBpZiAoY29kX2luZm8uYmxvY2tfdHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgIHJvd19pbl90YWJsZSA9IDE7XG4gICAgICAgICAgICB2YXIgcGFydGl0aW9uX3RhYmxlID0gcXVwdnQubnJfb2Zfc2ZiX2Jsb2NrW3RhYmxlX251bWJlcl1bcm93X2luX3RhYmxlXTtcbiAgICAgICAgICAgIGZvciAoc2ZiID0gMCwgcGFydGl0aW9uID0gMDsgcGFydGl0aW9uIDwgNDsgcGFydGl0aW9uKyspIHtcbiAgICAgICAgICAgICAgICBucl9zZmIgPSBwYXJ0aXRpb25fdGFibGVbcGFydGl0aW9uXSAvIDM7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG5yX3NmYjsgaSsrLCBzZmIrKylcbiAgICAgICAgICAgICAgICAgICAgZm9yICh3aW5kb3cgPSAwOyB3aW5kb3cgPCAzOyB3aW5kb3crKylcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzY2FsZWZhY1tzZmIgKiAzICsgd2luZG93XSA+IG1heF9zZmFjW3BhcnRpdGlvbl0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4X3NmYWNbcGFydGl0aW9uXSA9IHNjYWxlZmFjW3NmYiAqIDMgKyB3aW5kb3ddO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcm93X2luX3RhYmxlID0gMDtcbiAgICAgICAgICAgIHZhciBwYXJ0aXRpb25fdGFibGUgPSBxdXB2dC5ucl9vZl9zZmJfYmxvY2tbdGFibGVfbnVtYmVyXVtyb3dfaW5fdGFibGVdO1xuICAgICAgICAgICAgZm9yIChzZmIgPSAwLCBwYXJ0aXRpb24gPSAwOyBwYXJ0aXRpb24gPCA0OyBwYXJ0aXRpb24rKykge1xuICAgICAgICAgICAgICAgIG5yX3NmYiA9IHBhcnRpdGlvbl90YWJsZVtwYXJ0aXRpb25dO1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBucl9zZmI7IGkrKywgc2ZiKyspXG4gICAgICAgICAgICAgICAgICAgIGlmIChzY2FsZWZhY1tzZmJdID4gbWF4X3NmYWNbcGFydGl0aW9uXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heF9zZmFjW3BhcnRpdGlvbl0gPSBzY2FsZWZhY1tzZmJdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChvdmVyID0gZmFsc2UsIHBhcnRpdGlvbiA9IDA7IHBhcnRpdGlvbiA8IDQ7IHBhcnRpdGlvbisrKSB7XG4gICAgICAgICAgICBpZiAobWF4X3NmYWNbcGFydGl0aW9uXSA+IG1heF9yYW5nZV9zZmFjX3RhYlt0YWJsZV9udW1iZXJdW3BhcnRpdGlvbl0pXG4gICAgICAgICAgICAgICAgb3ZlciA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFvdmVyKSB7XG4gICAgICAgICAgICB2YXIgc2xlbjEsIHNsZW4yLCBzbGVuMywgc2xlbjQ7XG5cbiAgICAgICAgICAgIGNvZF9pbmZvLnNmYl9wYXJ0aXRpb25fdGFibGUgPSBxdXB2dC5ucl9vZl9zZmJfYmxvY2tbdGFibGVfbnVtYmVyXVtyb3dfaW5fdGFibGVdO1xuICAgICAgICAgICAgZm9yIChwYXJ0aXRpb24gPSAwOyBwYXJ0aXRpb24gPCA0OyBwYXJ0aXRpb24rKylcbiAgICAgICAgICAgICAgICBjb2RfaW5mby5zbGVuW3BhcnRpdGlvbl0gPSBsb2cydGFiW21heF9zZmFjW3BhcnRpdGlvbl1dO1xuXG4gICAgICAgICAgICAvKiBzZXQgc2NhbGVmYWNfY29tcHJlc3MgKi9cbiAgICAgICAgICAgIHNsZW4xID0gY29kX2luZm8uc2xlblswXTtcbiAgICAgICAgICAgIHNsZW4yID0gY29kX2luZm8uc2xlblsxXTtcbiAgICAgICAgICAgIHNsZW4zID0gY29kX2luZm8uc2xlblsyXTtcbiAgICAgICAgICAgIHNsZW40ID0gY29kX2luZm8uc2xlblszXTtcblxuICAgICAgICAgICAgc3dpdGNoICh0YWJsZV9udW1iZXIpIHtcbiAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvLnNjYWxlZmFjX2NvbXByZXNzID0gKCgoc2xlbjEgKiA1KSArIHNsZW4yKSA8PCA0KVxuICAgICAgICAgICAgICAgICAgICAgICAgKyAoc2xlbjMgPDwgMikgKyBzbGVuNDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvLnNjYWxlZmFjX2NvbXByZXNzID0gNDAwICsgKCgoc2xlbjEgKiA1KSArIHNsZW4yKSA8PCAyKVxuICAgICAgICAgICAgICAgICAgICAgICAgKyBzbGVuMztcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvLnNjYWxlZmFjX2NvbXByZXNzID0gNTAwICsgKHNsZW4xICogMykgKyBzbGVuMjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50ZihcImludGVuc2l0eSBzdGVyZW8gbm90IGltcGxlbWVudGVkIHlldFxcblwiKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFvdmVyKSB7XG4gICAgICAgICAgICBjb2RfaW5mby5wYXJ0Ml9sZW5ndGggPSAwO1xuICAgICAgICAgICAgZm9yIChwYXJ0aXRpb24gPSAwOyBwYXJ0aXRpb24gPCA0OyBwYXJ0aXRpb24rKylcbiAgICAgICAgICAgICAgICBjb2RfaW5mby5wYXJ0Ml9sZW5ndGggKz0gY29kX2luZm8uc2xlbltwYXJ0aXRpb25dXG4gICAgICAgICAgICAgICAgICAgICogY29kX2luZm8uc2ZiX3BhcnRpdGlvbl90YWJsZVtwYXJ0aXRpb25dO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdmVyO1xuICAgIH1cblxuICAgIC8qXG4gICAgICogU2luY2Ugbm8gYmFuZHMgaGF2ZSBiZWVuIG92ZXItYW1wbGlmaWVkLCB3ZSBjYW4gc2V0IHNjYWxlZmFjX2NvbXByZXNzIGFuZFxuICAgICAqIHNsZW5bXSBmb3IgdGhlIGZvcm1hdHRlclxuICAgICAqL1xuICAgIHZhciBsb2cydGFiID0gWzAsIDEsIDIsIDIsIDMsIDMsIDMsIDMsIDQsIDQsIDQsIDQsXG4gICAgICAgIDQsIDQsIDQsIDRdO1xuXG4gICAgdGhpcy5odWZmbWFuX2luaXQgPSBmdW5jdGlvbiAoZ2ZjKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAyOyBpIDw9IDU3NjsgaSArPSAyKSB7XG4gICAgICAgICAgICB2YXIgc2NmYl9hbnogPSAwLCBidl9pbmRleDtcbiAgICAgICAgICAgIHdoaWxlIChnZmMuc2NhbGVmYWNfYmFuZC5sWysrc2NmYl9hbnpdIDwgaSlcbiAgICAgICAgICAgICAgICA7XG5cbiAgICAgICAgICAgIGJ2X2luZGV4ID0gc3ViZHZfdGFibGVbc2NmYl9hbnpdWzBdOyAvLyAucmVnaW9uMF9jb3VudFxuICAgICAgICAgICAgd2hpbGUgKGdmYy5zY2FsZWZhY19iYW5kLmxbYnZfaW5kZXggKyAxXSA+IGkpXG4gICAgICAgICAgICAgICAgYnZfaW5kZXgtLTtcblxuICAgICAgICAgICAgaWYgKGJ2X2luZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogdGhpcyBpcyBhbiBpbmRpY2F0aW9uIHRoYXQgZXZlcnl0aGluZyBpcyBnb2luZyB0byBiZSBlbmNvZGVkXG4gICAgICAgICAgICAgICAgICogYXMgcmVnaW9uMDogYmlndmFsdWVzIDwgcmVnaW9uMCA8IHJlZ2lvbjEgc28gbGV0cyBzZXRcbiAgICAgICAgICAgICAgICAgKiByZWdpb24wLCByZWdpb24xIHRvIHNvbWUgdmFsdWUgbGFyZ2VyIHRoYW4gYmlndmFsdWVzXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYnZfaW5kZXggPSBzdWJkdl90YWJsZVtzY2ZiX2Fuel1bMF07IC8vIC5yZWdpb24wX2NvdW50XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGdmYy5idl9zY2ZbaSAtIDJdID0gYnZfaW5kZXg7XG5cbiAgICAgICAgICAgIGJ2X2luZGV4ID0gc3ViZHZfdGFibGVbc2NmYl9hbnpdWzFdOyAvLyAucmVnaW9uMV9jb3VudFxuICAgICAgICAgICAgd2hpbGUgKGdmYy5zY2FsZWZhY19iYW5kLmxbYnZfaW5kZXggKyBnZmMuYnZfc2NmW2kgLSAyXSArIDJdID4gaSlcbiAgICAgICAgICAgICAgICBidl9pbmRleC0tO1xuXG4gICAgICAgICAgICBpZiAoYnZfaW5kZXggPCAwKSB7XG4gICAgICAgICAgICAgICAgYnZfaW5kZXggPSBzdWJkdl90YWJsZVtzY2ZiX2Fuel1bMV07IC8vIC5yZWdpb24xX2NvdW50XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGdmYy5idl9zY2ZbaSAtIDFdID0gYnZfaW5kZXg7XG4gICAgICAgIH1cbiAgICB9XG59XG5cbi8qXG4gKiAgUmVwbGF5R2FpbkFuYWx5c2lzIC0gYW5hbHl6ZXMgaW5wdXQgc2FtcGxlcyBhbmQgZ2l2ZSB0aGUgcmVjb21tZW5kZWQgZEIgY2hhbmdlXG4gKiAgQ29weXJpZ2h0IChDKSAyMDAxIERhdmlkIFJvYmluc29uIGFuZCBHbGVuIFNhd3llclxuICogIEltcHJvdmVtZW50cyBhbmQgb3B0aW1pemF0aW9ucyBhZGRlZCBieSBGcmFuayBLbGVtbSwgYW5kIGJ5IE1hcmNlbCBNdWxsZXIgXG4gKlxuICogIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3JcbiAqICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG4gKiAgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyXG4gKiAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG4gKlxuICogIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLFxuICogIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mXG4gKiAgTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlVcbiAqICBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLlxuICpcbiAqICBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG4gKiAgTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZVxuICogIEZvdW5kYXRpb24sIEluYy4sIDU5IFRlbXBsZSBQbGFjZSwgU3VpdGUgMzMwLCBCb3N0b24sIE1BICAwMjExMS0xMzA3ICBVU0FcbiAqXG4gKiAgY29uY2VwdCBhbmQgZmlsdGVyIHZhbHVlcyBieSBEYXZpZCBSb2JpbnNvbiAoRGF2aWRAUm9iaW5zb24ub3JnKVxuICogICAgLS0gYmxhbWUgaGltIGlmIHlvdSB0aGluayB0aGUgaWRlYSBpcyBmbGF3ZWRcbiAqICBvcmlnaW5hbCBjb2RpbmcgYnkgR2xlbiBTYXd5ZXIgKG1wM2dhaW5AaG90bWFpbC5jb20pXG4gKiAgICAtLSBibGFtZSBoaW0gaWYgeW91IHRoaW5rIHRoaXMgcnVucyB0b28gc2xvd2x5LCBvciB0aGUgY29kaW5nIGlzIG90aGVyd2lzZSBmbGF3ZWRcbiAqXG4gKiAgbG90cyBvZiBjb2RlIGltcHJvdmVtZW50cyBieSBGcmFuayBLbGVtbSAoIGh0dHA6Ly93d3cudW5pLWplbmEuZGUvfnBmay9tcHAvIClcbiAqICAgIC0tIGNyZWRpdCBoaW0gZm9yIGFsbCB0aGUgX2dvb2RfIHByb2dyYW1taW5nIDspXG4gKlxuICpcbiAqICBGb3IgYW4gZXhwbGFuYXRpb24gb2YgdGhlIGNvbmNlcHRzIGFuZCB0aGUgYmFzaWMgYWxnb3JpdGhtcyBpbnZvbHZlZCwgZ28gdG86XG4gKiAgICBodHRwOi8vd3d3LnJlcGxheWdhaW4ub3JnL1xuICovXG5cbi8qXG4gKiAgSGVyZSdzIHRoZSBkZWFsLiBDYWxsXG4gKlxuICogICAgSW5pdEdhaW5BbmFseXNpcyAoIGxvbmcgc2FtcGxlZnJlcSApO1xuICpcbiAqICB0byBpbml0aWFsaXplIGV2ZXJ5dGhpbmcuIENhbGxcbiAqXG4gKiAgICBBbmFseXplU2FtcGxlcyAoIHZhciBGbG9hdF90KiAgbGVmdF9zYW1wbGVzLFxuICogICAgICAgICAgICAgICAgICAgICB2YXIgRmxvYXRfdCogIHJpZ2h0X3NhbXBsZXMsXG4gKiAgICAgICAgICAgICAgICAgICAgIHNpemVfdCAgICAgICAgICBudW1fc2FtcGxlcyxcbiAqICAgICAgICAgICAgICAgICAgICAgaW50ICAgICAgICAgICAgIG51bV9jaGFubmVscyApO1xuICpcbiAqICBhcyBtYW55IHRpbWVzIGFzIHlvdSB3YW50LCB3aXRoIGFzIG1hbnkgb3IgYXMgZmV3IHNhbXBsZXMgYXMgeW91IHdhbnQuXG4gKiAgSWYgbW9ubywgcGFzcyB0aGUgc2FtcGxlIGJ1ZmZlciBpbiB0aHJvdWdoIGxlZnRfc2FtcGxlcywgbGVhdmVcbiAqICByaWdodF9zYW1wbGVzIE5VTEwsIGFuZCBtYWtlIHN1cmUgbnVtX2NoYW5uZWxzID0gMS5cbiAqXG4gKiAgICBHZXRUaXRsZUdhaW4oKVxuICpcbiAqICB3aWxsIHJldHVybiB0aGUgcmVjb21tZW5kZWQgZEIgbGV2ZWwgY2hhbmdlIGZvciBhbGwgc2FtcGxlcyBhbmFseXplZFxuICogIFNJTkNFIFRIRSBMQVNUIFRJTUUgeW91IGNhbGxlZCBHZXRUaXRsZUdhaW4oKSBPUiBJbml0R2FpbkFuYWx5c2lzKCkuXG4gKlxuICogICAgR2V0QWxidW1HYWluKClcbiAqXG4gKiAgd2lsbCByZXR1cm4gdGhlIHJlY29tbWVuZGVkIGRCIGxldmVsIGNoYW5nZSBmb3IgYWxsIHNhbXBsZXMgYW5hbHl6ZWRcbiAqICBzaW5jZSBJbml0R2FpbkFuYWx5c2lzKCkgd2FzIGNhbGxlZCBhbmQgZmluYWxpemVkIHdpdGggR2V0VGl0bGVHYWluKCkuXG4gKlxuICogIFBzZXVkby1jb2RlIHRvIHByb2Nlc3MgYW4gYWxidW06XG4gKlxuICogICAgRmxvYXRfdCAgICAgICBsX3NhbXBsZXMgWzQwOTZdO1xuICogICAgRmxvYXRfdCAgICAgICByX3NhbXBsZXMgWzQwOTZdO1xuICogICAgc2l6ZV90ICAgICAgICBudW1fc2FtcGxlcztcbiAqICAgIHVuc2lnbmVkIGludCAgbnVtX3NvbmdzO1xuICogICAgdW5zaWduZWQgaW50ICBpO1xuICpcbiAqICAgIEluaXRHYWluQW5hbHlzaXMgKCA0NDEwMCApO1xuICogICAgZm9yICggaSA9IDE7IGkgPD0gbnVtX3NvbmdzOyBpKysgKSB7XG4gKiAgICAgICAgd2hpbGUgKCAoIG51bV9zYW1wbGVzID0gZ2V0U29uZ1NhbXBsZXMgKCBzb25nW2ldLCBsZWZ0X3NhbXBsZXMsIHJpZ2h0X3NhbXBsZXMgKSApID4gMCApXG4gKiAgICAgICAgICAgIEFuYWx5emVTYW1wbGVzICggbGVmdF9zYW1wbGVzLCByaWdodF9zYW1wbGVzLCBudW1fc2FtcGxlcywgMiApO1xuICogICAgICAgIGZwcmludGYgKFwiUmVjb21tZW5kZWQgZEIgY2hhbmdlIGZvciBzb25nICUyZDogJSs2LjIgZEJcXG5cIiwgaSwgR2V0VGl0bGVHYWluKCkgKTtcbiAqICAgIH1cbiAqICAgIGZwcmludGYgKFwiUmVjb21tZW5kZWQgZEIgY2hhbmdlIGZvciB3aG9sZSBhbGJ1bTogJSs2LjIgZEJcXG5cIiwgR2V0QWxidW1HYWluKCkgKTtcbiAqL1xuXG4vKlxuICogIFNvIGhlcmUncyB0aGUgbWFpbiBzb3VyY2Ugb2YgcG90ZW50aWFsIGNvZGUgY29uZnVzaW9uOlxuICpcbiAqICBUaGUgZmlsdGVycyBhcHBsaWVkIHRvIHRoZSBpbmNvbWluZyBzYW1wbGVzIGFyZSBJSVIgZmlsdGVycyxcbiAqICBtZWFuaW5nIHRoZXkgcmVseSBvbiB1cCB0byA8ZmlsdGVyIG9yZGVyPiBudW1iZXIgb2YgcHJldmlvdXMgc2FtcGxlc1xuICogIEFORCB1cCB0byA8ZmlsdGVyIG9yZGVyPiBudW1iZXIgb2YgcHJldmlvdXMgZmlsdGVyZWQgc2FtcGxlcy5cbiAqXG4gKiAgSSBzZXQgdXAgdGhlIEFuYWx5emVTYW1wbGVzIHJvdXRpbmUgdG8gbWluaW1pemUgbWVtb3J5IHVzYWdlIGFuZCBpbnRlcmZhY2VcbiAqICBjb21wbGV4aXR5LiBUaGUgc3BlZWQgaXNuJ3QgY29tcHJvbWlzZWQgdG9vIG11Y2ggKEkgZG9uJ3QgdGhpbmspLCBidXQgdGhlXG4gKiAgaW50ZXJuYWwgY29tcGxleGl0eSBpcyBoaWdoZXIgdGhhbiBpdCBzaG91bGQgYmUgZm9yIHN1Y2ggYSByZWxhdGl2ZWx5XG4gKiAgc2ltcGxlIHJvdXRpbmUuXG4gKlxuICogIE9wdGltaXphdGlvbi9jbGFyaXR5IHN1Z2dlc3Rpb25zIGFyZSB3ZWxjb21lLlxuICovXG5cbi8qKlxuICogVGFibGUgZW50cmllcyBwZXIgZEJcbiAqL1xuR2FpbkFuYWx5c2lzLlNURVBTX3Blcl9kQiA9IDEwMC47XG4vKipcbiAqIFRhYmxlIGVudHJpZXMgZm9yIDAuLi5NQVhfZEIgKG5vcm1hbCBtYXguIHZhbHVlcyBhcmUgNzAuLi44MCBkQilcbiAqL1xuR2FpbkFuYWx5c2lzLk1BWF9kQiA9IDEyMC47XG5HYWluQW5hbHlzaXMuR0FJTl9OT1RfRU5PVUdIX1NBTVBMRVMgPSAtMjQ2MDE7XG5HYWluQW5hbHlzaXMuR0FJTl9BTkFMWVNJU19FUlJPUiA9IDA7XG5HYWluQW5hbHlzaXMuR0FJTl9BTkFMWVNJU19PSyA9IDE7XG5HYWluQW5hbHlzaXMuSU5JVF9HQUlOX0FOQUxZU0lTX0VSUk9SID0gMDtcbkdhaW5BbmFseXNpcy5JTklUX0dBSU5fQU5BTFlTSVNfT0sgPSAxO1xuXG5HYWluQW5hbHlzaXMuWVVMRV9PUkRFUiA9IDEwO1xuR2FpbkFuYWx5c2lzLk1BWF9PUkRFUiA9IEdhaW5BbmFseXNpcy5ZVUxFX09SREVSO1xuXG5HYWluQW5hbHlzaXMuTUFYX1NBTVBfRlJFUSA9IDQ4MDAwO1xuR2FpbkFuYWx5c2lzLlJNU19XSU5ET1dfVElNRV9OVU1FUkFUT1IgPSAxO1xuR2FpbkFuYWx5c2lzLlJNU19XSU5ET1dfVElNRV9ERU5PTUlOQVRPUiA9IDIwO1xuR2FpbkFuYWx5c2lzLk1BWF9TQU1QTEVTX1BFUl9XSU5ET1cgPSAoKEdhaW5BbmFseXNpcy5NQVhfU0FNUF9GUkVRICogR2FpbkFuYWx5c2lzLlJNU19XSU5ET1dfVElNRV9OVU1FUkFUT1IpIC8gR2FpbkFuYWx5c2lzLlJNU19XSU5ET1dfVElNRV9ERU5PTUlOQVRPUiArIDEpO1xuXG5mdW5jdGlvbiBHYWluQW5hbHlzaXMoKSB7XG5cdC8vZml4IOeyvueugFxufVxuXG5cbmZ1bmN0aW9uIFByZXNldHMoKSB7XG4gICAgZnVuY3Rpb24gVkJSUHJlc2V0cyhxdWFsLCBjb21wLCBjb21wUyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHksIHNoVGhyZXNob2xkLCBzaFRocmVzaG9sZFMsXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGosIGFkalNob3J0LCBsb3dlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnZlLCBzZW5zLCBpbnRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIGpvaW50LCBtb2QsIGZpeCkge1xuICAgICAgICB0aGlzLnZicl9xID0gcXVhbDtcbiAgICAgICAgdGhpcy5xdWFudF9jb21wID0gY29tcDtcbiAgICAgICAgdGhpcy5xdWFudF9jb21wX3MgPSBjb21wUztcbiAgICAgICAgdGhpcy5leHBZID0geTtcbiAgICAgICAgdGhpcy5zdF9scm0gPSBzaFRocmVzaG9sZDtcbiAgICAgICAgdGhpcy5zdF9zID0gc2hUaHJlc2hvbGRTO1xuICAgICAgICB0aGlzLm1hc2tpbmdfYWRqID0gYWRqO1xuICAgICAgICB0aGlzLm1hc2tpbmdfYWRqX3Nob3J0ID0gYWRqU2hvcnQ7XG4gICAgICAgIHRoaXMuYXRoX2xvd2VyID0gbG93ZXI7XG4gICAgICAgIHRoaXMuYXRoX2N1cnZlID0gY3VydmU7XG4gICAgICAgIHRoaXMuYXRoX3NlbnNpdGl2aXR5ID0gc2VucztcbiAgICAgICAgdGhpcy5pbnRlcmNoID0gaW50ZXI7XG4gICAgICAgIHRoaXMuc2FmZWpvaW50ID0gam9pbnQ7XG4gICAgICAgIHRoaXMuc2ZiMjFtb2QgPSBtb2Q7XG4gICAgICAgIHRoaXMubXNmaXggPSBmaXg7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gQUJSUHJlc2V0cyhrYnBzLCBjb21wLCBjb21wUyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGpvaW50LCBmaXgsIHNoVGhyZXNob2xkLFxuICAgICAgICAgICAgICAgICAgICAgICAgc2hUaHJlc2hvbGRTLCBiYXNzLCBzYyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hc2ssIGxvd2VyLCBjdXJ2ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGludGVyQ2gsIHNmU2NhbGUpIHtcbiAgICAgICAgdGhpcy5xdWFudF9jb21wID0gY29tcDtcbiAgICAgICAgdGhpcy5xdWFudF9jb21wX3MgPSBjb21wUztcbiAgICAgICAgdGhpcy5zYWZlam9pbnQgPSBqb2ludDtcbiAgICAgICAgdGhpcy5uc21zZml4ID0gZml4O1xuICAgICAgICB0aGlzLnN0X2xybSA9IHNoVGhyZXNob2xkO1xuICAgICAgICB0aGlzLnN0X3MgPSBzaFRocmVzaG9sZFM7XG4gICAgICAgIHRoaXMubnNiYXNzID0gYmFzcztcbiAgICAgICAgdGhpcy5zY2FsZSA9IHNjO1xuICAgICAgICB0aGlzLm1hc2tpbmdfYWRqID0gbWFzaztcbiAgICAgICAgdGhpcy5hdGhfbG93ZXIgPSBsb3dlcjtcbiAgICAgICAgdGhpcy5hdGhfY3VydmUgPSBjdXJ2ZTtcbiAgICAgICAgdGhpcy5pbnRlcmNoID0gaW50ZXJDaDtcbiAgICAgICAgdGhpcy5zZnNjYWxlID0gc2ZTY2FsZTtcbiAgICB9XG5cbiAgICB2YXIgbGFtZTtcblxuICAgIHRoaXMuc2V0TW9kdWxlcyA9IGZ1bmN0aW9uIChfbGFtZSkge1xuICAgICAgICBsYW1lID0gX2xhbWU7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIDxQUkU+XG4gICAgICogU3dpdGNoIG1hcHBpbmdzIGZvciBWQlIgbW9kZSBWQlJfUkhcbiAgICAgKiAgICAgICAgICAgICB2YnJfcSAgcWNvbXBfbCAgcWNvbXBfcyAgZXhwWSAgc3RfbHJtICAgc3RfcyAgbWFzayBhZGpfbCAgYWRqX3MgIGF0aF9sb3dlciAgYXRoX2N1cnZlICBhdGhfc2VucyAgaW50ZXJDaFIgIHNhZmVqb2ludCBzZmIyMW1vZCAgbXNmaXhcbiAgICAgKiA8L1BSRT5cbiAgICAgKi9cbiAgICB2YXIgdmJyX29sZF9zd2l0Y2hfbWFwID0gW1xuICAgICAgICBuZXcgVkJSUHJlc2V0cygwLCA5LCA5LCAwLCA1LjIwLCAxMjUuMCwgLTQuMiwgLTYuMywgNC44LCAxLCAwLCAwLCAyLCAyMSwgMC45NyksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDEsIDksIDksIDAsIDUuMzAsIDEyNS4wLCAtMy42LCAtNS42LCA0LjUsIDEuNSwgMCwgMCwgMiwgMjEsIDEuMzUpLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cygyLCA5LCA5LCAwLCA1LjYwLCAxMjUuMCwgLTIuMiwgLTMuNSwgMi44LCAyLCAwLCAwLCAyLCAyMSwgMS40OSksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDMsIDksIDksIDEsIDUuODAsIDEzMC4wLCAtMS44LCAtMi44LCAyLjYsIDMsIC00LCAwLCAyLCAyMCwgMS42NCksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDQsIDksIDksIDEsIDYuMDAsIDEzNS4wLCAtMC43LCAtMS4xLCAxLjEsIDMuNSwgLTgsIDAsIDIsIDAsIDEuNzkpLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cyg1LCA5LCA5LCAxLCA2LjQwLCAxNDAuMCwgMC41LCAwLjQsIC03LjUsIDQsIC0xMiwgMC4wMDAyLCAwLCAwLCAxLjk1KSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoNiwgOSwgOSwgMSwgNi42MCwgMTQ1LjAsIDAuNjcsIDAuNjUsIC0xNC43LCA2LjUsIC0xOSwgMC4wMDA0LCAwLCAwLCAyLjMwKSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoNywgOSwgOSwgMSwgNi42MCwgMTQ1LjAsIDAuOCwgMC43NSwgLTE5LjcsIDgsIC0yMiwgMC4wMDA2LCAwLCAwLCAyLjcwKSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoOCwgOSwgOSwgMSwgNi42MCwgMTQ1LjAsIDEuMiwgMS4xNSwgLTI3LjUsIDEwLCAtMjMsIDAuMDAwNywgMCwgMCwgMCksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDksIDksIDksIDEsIDYuNjAsIDE0NS4wLCAxLjYsIDEuNiwgLTM2LCAxMSwgLTI1LCAwLjAwMDgsIDAsIDAsIDApLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cygxMCwgOSwgOSwgMSwgNi42MCwgMTQ1LjAsIDIuMCwgMi4wLCAtMzYsIDEyLCAtMjUsIDAuMDAwOCwgMCwgMCwgMClcbiAgICBdO1xuXG4gICAgLyoqXG4gICAgICogPFBSRT5cbiAgICAgKiAgICAgICAgICAgICAgICAgdmJyX3EgIHFjb21wX2wgIHFjb21wX3MgIGV4cFkgIHN0X2xybSAgIHN0X3MgIG1hc2sgYWRqX2wgIGFkal9zICBhdGhfbG93ZXIgIGF0aF9jdXJ2ZSAgYXRoX3NlbnMgIGludGVyQ2hSICBzYWZlam9pbnQgc2ZiMjFtb2QgIG1zZml4XG4gICAgICogPC9QUkU+XG4gICAgICovXG4gICAgdmFyIHZicl9wc3lfc3dpdGNoX21hcCA9IFtcbiAgICAgICAgbmV3IFZCUlByZXNldHMoMCwgOSwgOSwgMCwgNC4yMCwgMjUuMCwgLTcuMCwgLTQuMCwgNy41LCAxLCAwLCAwLCAyLCAyNiwgMC45NyksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDEsIDksIDksIDAsIDQuMjAsIDI1LjAsIC01LjYsIC0zLjYsIDQuNSwgMS41LCAwLCAwLCAyLCAyMSwgMS4zNSksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDIsIDksIDksIDAsIDQuMjAsIDI1LjAsIC00LjQsIC0xLjgsIDIsIDIsIDAsIDAsIDIsIDE4LCAxLjQ5KSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoMywgOSwgOSwgMSwgNC4yMCwgMjUuMCwgLTMuNCwgLTEuMjUsIDEuMSwgMywgLTQsIDAsIDIsIDE1LCAxLjY0KSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoNCwgOSwgOSwgMSwgNC4yMCwgMjUuMCwgLTIuMiwgMC4xLCAwLCAzLjUsIC04LCAwLCAyLCAwLCAxLjc5KSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoNSwgOSwgOSwgMSwgNC4yMCwgMjUuMCwgLTEuMCwgMS42NSwgLTcuNywgNCwgLTEyLCAwLjAwMDIsIDAsIDAsIDEuOTUpLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cyg2LCA5LCA5LCAxLCA0LjIwLCAyNS4wLCAtMC4wLCAyLjQ3LCAtNy43LCA2LjUsIC0xOSwgMC4wMDA0LCAwLCAwLCAyKSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoNywgOSwgOSwgMSwgNC4yMCwgMjUuMCwgMC41LCAyLjAsIC0xNC41LCA4LCAtMjIsIDAuMDAwNiwgMCwgMCwgMiksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDgsIDksIDksIDEsIDQuMjAsIDI1LjAsIDEuMCwgMi40LCAtMjIuMCwgMTAsIC0yMywgMC4wMDA3LCAwLCAwLCAyKSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoOSwgOSwgOSwgMSwgNC4yMCwgMjUuMCwgMS41LCAyLjk1LCAtMzAuMCwgMTEsIC0yNSwgMC4wMDA4LCAwLCAwLCAyKSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoMTAsIDksIDksIDEsIDQuMjAsIDI1LjAsIDIuMCwgMi45NSwgLTM2LjAsIDEyLCAtMzAsIDAuMDAwOCwgMCwgMCwgMilcbiAgICBdO1xuXG4gICAgZnVuY3Rpb24gYXBwbHlfdmJyX3ByZXNldChnZnAsIGEsIGVuZm9yY2UpIHtcbiAgICAgICAgdmFyIHZicl9wcmVzZXQgPSBnZnAuVkJSID09IFZick1vZGUudmJyX3JoID8gdmJyX29sZF9zd2l0Y2hfbWFwXG4gICAgICAgICAgICA6IHZicl9wc3lfc3dpdGNoX21hcDtcblxuICAgICAgICB2YXIgeCA9IGdmcC5WQlJfcV9mcmFjO1xuICAgICAgICB2YXIgcCA9IHZicl9wcmVzZXRbYV07XG4gICAgICAgIHZhciBxID0gdmJyX3ByZXNldFthICsgMV07XG4gICAgICAgIHZhciBzZXQgPSBwO1xuXG4gICAgICAgIC8vIE5PT1AodmJyX3EpO1xuICAgICAgICAvLyBOT09QKHF1YW50X2NvbXApO1xuICAgICAgICAvLyBOT09QKHF1YW50X2NvbXBfcyk7XG4gICAgICAgIC8vIE5PT1AoZXhwWSk7XG4gICAgICAgIHAuc3RfbHJtID0gcC5zdF9scm0gKyB4ICogKHEuc3RfbHJtIC0gcC5zdF9scm0pO1xuICAgICAgICAvLyBMRVJQKHN0X2xybSk7XG4gICAgICAgIHAuc3RfcyA9IHAuc3RfcyArIHggKiAocS5zdF9zIC0gcC5zdF9zKTtcbiAgICAgICAgLy8gTEVSUChzdF9zKTtcbiAgICAgICAgcC5tYXNraW5nX2FkaiA9IHAubWFza2luZ19hZGogKyB4ICogKHEubWFza2luZ19hZGogLSBwLm1hc2tpbmdfYWRqKTtcbiAgICAgICAgLy8gTEVSUChtYXNraW5nX2Fkaik7XG4gICAgICAgIHAubWFza2luZ19hZGpfc2hvcnQgPSBwLm1hc2tpbmdfYWRqX3Nob3J0ICsgeFxuICAgICAgICAgICAgKiAocS5tYXNraW5nX2Fkal9zaG9ydCAtIHAubWFza2luZ19hZGpfc2hvcnQpO1xuICAgICAgICAvLyBMRVJQKG1hc2tpbmdfYWRqX3Nob3J0KTtcbiAgICAgICAgcC5hdGhfbG93ZXIgPSBwLmF0aF9sb3dlciArIHggKiAocS5hdGhfbG93ZXIgLSBwLmF0aF9sb3dlcik7XG4gICAgICAgIC8vIExFUlAoYXRoX2xvd2VyKTtcbiAgICAgICAgcC5hdGhfY3VydmUgPSBwLmF0aF9jdXJ2ZSArIHggKiAocS5hdGhfY3VydmUgLSBwLmF0aF9jdXJ2ZSk7XG4gICAgICAgIC8vIExFUlAoYXRoX2N1cnZlKTtcbiAgICAgICAgcC5hdGhfc2Vuc2l0aXZpdHkgPSBwLmF0aF9zZW5zaXRpdml0eSArIHhcbiAgICAgICAgICAgICogKHEuYXRoX3NlbnNpdGl2aXR5IC0gcC5hdGhfc2Vuc2l0aXZpdHkpO1xuICAgICAgICAvLyBMRVJQKGF0aF9zZW5zaXRpdml0eSk7XG4gICAgICAgIHAuaW50ZXJjaCA9IHAuaW50ZXJjaCArIHggKiAocS5pbnRlcmNoIC0gcC5pbnRlcmNoKTtcbiAgICAgICAgLy8gTEVSUChpbnRlcmNoKTtcbiAgICAgICAgLy8gTk9PUChzYWZlam9pbnQpO1xuICAgICAgICAvLyBOT09QKHNmYjIxbW9kKTtcbiAgICAgICAgcC5tc2ZpeCA9IHAubXNmaXggKyB4ICogKHEubXNmaXggLSBwLm1zZml4KTtcbiAgICAgICAgLy8gTEVSUChtc2ZpeCk7XG5cbiAgICAgICAgbGFtZV9zZXRfVkJSX3EoZ2ZwLCBzZXQudmJyX3EpO1xuXG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAucXVhbnRfY29tcCA9IHNldC5xdWFudF9jb21wO1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5xdWFudF9jb21wIC0gLTEpID4gMCkpXG4gICAgICAgICAgICBnZnAucXVhbnRfY29tcCA9IHNldC5xdWFudF9jb21wO1xuICAgICAgICAvLyBTRVRfT1BUSU9OKHF1YW50X2NvbXAsIHNldC5xdWFudF9jb21wLCAtMSk7XG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAucXVhbnRfY29tcF9zaG9ydCA9IHNldC5xdWFudF9jb21wX3M7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLnF1YW50X2NvbXBfc2hvcnQgLSAtMSkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5xdWFudF9jb21wX3Nob3J0ID0gc2V0LnF1YW50X2NvbXBfcztcbiAgICAgICAgLy8gU0VUX09QVElPTihxdWFudF9jb21wX3Nob3J0LCBzZXQucXVhbnRfY29tcF9zLCAtMSk7XG4gICAgICAgIGlmIChzZXQuZXhwWSAhPSAwKSB7XG4gICAgICAgICAgICBnZnAuZXhwZXJpbWVudGFsWSA9IHNldC5leHBZICE9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5pbnRlcm5hbF9mbGFncy5uc1BzeS5hdHRhY2t0aHJlID0gc2V0LnN0X2xybTtcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAuaW50ZXJuYWxfZmxhZ3MubnNQc3kuYXR0YWNrdGhyZSAtIC0xKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLmludGVybmFsX2ZsYWdzLm5zUHN5LmF0dGFja3RocmUgPSBzZXQuc3RfbHJtO1xuICAgICAgICAvLyBTRVRfT1BUSU9OKHNob3J0X3RocmVzaG9sZF9scm0sIHNldC5zdF9scm0sIC0xKTtcbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5pbnRlcm5hbF9mbGFncy5uc1BzeS5hdHRhY2t0aHJlX3MgPSBzZXQuc3RfcztcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAuaW50ZXJuYWxfZmxhZ3MubnNQc3kuYXR0YWNrdGhyZV9zIC0gLTEpID4gMCkpXG4gICAgICAgICAgICBnZnAuaW50ZXJuYWxfZmxhZ3MubnNQc3kuYXR0YWNrdGhyZV9zID0gc2V0LnN0X3M7XG4gICAgICAgIC8vIFNFVF9PUFRJT04oc2hvcnRfdGhyZXNob2xkX3MsIHNldC5zdF9zLCAtMSk7XG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAubWFza2luZ2FkanVzdCA9IHNldC5tYXNraW5nX2FkajtcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAubWFza2luZ2FkanVzdCAtIDApID4gMCkpXG4gICAgICAgICAgICBnZnAubWFza2luZ2FkanVzdCA9IHNldC5tYXNraW5nX2FkajtcbiAgICAgICAgLy8gU0VUX09QVElPTihtYXNraW5nYWRqdXN0LCBzZXQubWFza2luZ19hZGosIDApO1xuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLm1hc2tpbmdhZGp1c3Rfc2hvcnQgPSBzZXQubWFza2luZ19hZGpfc2hvcnQ7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLm1hc2tpbmdhZGp1c3Rfc2hvcnQgLSAwKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLm1hc2tpbmdhZGp1c3Rfc2hvcnQgPSBzZXQubWFza2luZ19hZGpfc2hvcnQ7XG4gICAgICAgIC8vIFNFVF9PUFRJT04obWFza2luZ2FkanVzdF9zaG9ydCwgc2V0Lm1hc2tpbmdfYWRqX3Nob3J0LCAwKTtcbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5BVEhsb3dlciA9IC1zZXQuYXRoX2xvd2VyIC8gMTAuMDtcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicygoLWdmcC5BVEhsb3dlciAqIDEwLjApIC0gMCkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5BVEhsb3dlciA9IC1zZXQuYXRoX2xvd2VyIC8gMTAuMDtcbiAgICAgICAgLy8gU0VUX09QVElPTihBVEhsb3dlciwgc2V0LmF0aF9sb3dlciwgMCk7XG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAuQVRIY3VydmUgPSBzZXQuYXRoX2N1cnZlO1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5BVEhjdXJ2ZSAtIC0xKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLkFUSGN1cnZlID0gc2V0LmF0aF9jdXJ2ZTtcbiAgICAgICAgLy8gU0VUX09QVElPTihBVEhjdXJ2ZSwgc2V0LmF0aF9jdXJ2ZSwgLTEpO1xuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLmF0aGFhX3NlbnNpdGl2aXR5ID0gc2V0LmF0aF9zZW5zaXRpdml0eTtcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAuYXRoYWFfc2Vuc2l0aXZpdHkgLSAtMSkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5hdGhhYV9zZW5zaXRpdml0eSA9IHNldC5hdGhfc2Vuc2l0aXZpdHk7XG4gICAgICAgIC8vIFNFVF9PUFRJT04oYXRoYWFfc2Vuc2l0aXZpdHksIHNldC5hdGhfc2Vuc2l0aXZpdHksIDApO1xuICAgICAgICBpZiAoc2V0LmludGVyY2ggPiAwKSB7XG4gICAgICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgICAgIGdmcC5pbnRlckNoUmF0aW8gPSBzZXQuaW50ZXJjaDtcbiAgICAgICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLmludGVyQ2hSYXRpbyAtIC0xKSA+IDApKVxuICAgICAgICAgICAgICAgIGdmcC5pbnRlckNoUmF0aW8gPSBzZXQuaW50ZXJjaDtcbiAgICAgICAgICAgIC8vIFNFVF9PUFRJT04oaW50ZXJDaFJhdGlvLCBzZXQuaW50ZXJjaCwgLTEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogcGFyYW1ldGVycyBmb3Igd2hpY2ggdGhlcmUgaXMgbm8gcHJvcGVyIHNldC9nZXQgaW50ZXJmYWNlICovXG4gICAgICAgIGlmIChzZXQuc2FmZWpvaW50ID4gMCkge1xuICAgICAgICAgICAgZ2ZwLmV4cF9uc3BzeXR1bmUgPSBnZnAuZXhwX25zcHN5dHVuZSB8IHNldC5zYWZlam9pbnQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNldC5zZmIyMW1vZCA+IDApIHtcbiAgICAgICAgICAgIGdmcC5leHBfbnNwc3l0dW5lID0gZ2ZwLmV4cF9uc3BzeXR1bmUgfCAoc2V0LnNmYjIxbW9kIDw8IDIwKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLm1zZml4ID0gc2V0Lm1zZml4O1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5tc2ZpeCAtIC0xKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLm1zZml4ID0gc2V0Lm1zZml4O1xuICAgICAgICAvLyBTRVRfT1BUSU9OKG1zZml4LCBzZXQubXNmaXgsIC0xKTtcblxuICAgICAgICBpZiAoZW5mb3JjZSA9PSAwKSB7XG4gICAgICAgICAgICBnZnAuVkJSX3EgPSBhO1xuICAgICAgICAgICAgZ2ZwLlZCUl9xX2ZyYWMgPSB4O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogPFBSRT5cbiAgICAgKiAgU3dpdGNoIG1hcHBpbmdzIGZvciBBQlIgbW9kZVxuICAgICAqXG4gICAgICogICAgICAgICAgICAgIGticHMgIHF1YW50IHFfcyBzYWZlam9pbnQgbnNtc2ZpeCBzdF9scm0gIHN0X3MgIG5zLWJhc3Mgc2NhbGUgICBtc2sgYXRoX2x3ciBhdGhfY3VydmUgIGludGVyY2ggLCBzZnNjYWxlXG4gICAgICogPC9QUkU+XG4gICAgICovXG4gICAgdmFyIGFicl9zd2l0Y2hfbWFwID0gW1xuICAgICAgICBuZXcgQUJSUHJlc2V0cyg4LCA5LCA5LCAwLCAwLCA2LjYwLCAxNDUsIDAsIDAuOTUsIDAsIC0zMC4wLCAxMSwgMC4wMDEyLCAxKSwgLyogICA4LCBpbXBvc3NpYmxlIHRvIHVzZSBpbiBzdGVyZW8gKi9cbiAgICAgICAgbmV3IEFCUlByZXNldHMoMTYsIDksIDksIDAsIDAsIDYuNjAsIDE0NSwgMCwgMC45NSwgMCwgLTI1LjAsIDExLCAwLjAwMTAsIDEpLCAvKiAgMTYgKi9cbiAgICAgICAgbmV3IEFCUlByZXNldHMoMjQsIDksIDksIDAsIDAsIDYuNjAsIDE0NSwgMCwgMC45NSwgMCwgLTIwLjAsIDExLCAwLjAwMTAsIDEpLCAvKiAgMjQgKi9cbiAgICAgICAgbmV3IEFCUlByZXNldHMoMzIsIDksIDksIDAsIDAsIDYuNjAsIDE0NSwgMCwgMC45NSwgMCwgLTE1LjAsIDExLCAwLjAwMTAsIDEpLCAvKiAgMzIgKi9cbiAgICAgICAgbmV3IEFCUlByZXNldHMoNDAsIDksIDksIDAsIDAsIDYuNjAsIDE0NSwgMCwgMC45NSwgMCwgLTEwLjAsIDExLCAwLjAwMDksIDEpLCAvKiAgNDAgKi9cbiAgICAgICAgbmV3IEFCUlByZXNldHMoNDgsIDksIDksIDAsIDAsIDYuNjAsIDE0NSwgMCwgMC45NSwgMCwgLTEwLjAsIDExLCAwLjAwMDksIDEpLCAvKiAgNDggKi9cbiAgICAgICAgbmV3IEFCUlByZXNldHMoNTYsIDksIDksIDAsIDAsIDYuNjAsIDE0NSwgMCwgMC45NSwgMCwgLTYuMCwgMTEsIDAuMDAwOCwgMSksIC8qICA1NiAqL1xuICAgICAgICBuZXcgQUJSUHJlc2V0cyg2NCwgOSwgOSwgMCwgMCwgNi42MCwgMTQ1LCAwLCAwLjk1LCAwLCAtMi4wLCAxMSwgMC4wMDA4LCAxKSwgLyogIDY0ICovXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDgwLCA5LCA5LCAwLCAwLCA2LjYwLCAxNDUsIDAsIDAuOTUsIDAsIC4wLCA4LCAwLjAwMDcsIDEpLCAvKiAgODAgKi9cbiAgICAgICAgbmV3IEFCUlByZXNldHMoOTYsIDksIDksIDAsIDIuNTAsIDYuNjAsIDE0NSwgMCwgMC45NSwgMCwgMS4wLCA1LjUsIDAuMDAwNiwgMSksIC8qICA5NiAqL1xuICAgICAgICBuZXcgQUJSUHJlc2V0cygxMTIsIDksIDksIDAsIDIuMjUsIDYuNjAsIDE0NSwgMCwgMC45NSwgMCwgMi4wLCA0LjUsIDAuMDAwNSwgMSksIC8qIDExMiAqL1xuICAgICAgICBuZXcgQUJSUHJlc2V0cygxMjgsIDksIDksIDAsIDEuOTUsIDYuNDAsIDE0MCwgMCwgMC45NSwgMCwgMy4wLCA0LCAwLjAwMDIsIDEpLCAvKiAxMjggKi9cbiAgICAgICAgbmV3IEFCUlByZXNldHMoMTYwLCA5LCA5LCAxLCAxLjc5LCA2LjAwLCAxMzUsIDAsIDAuOTUsIC0yLCA1LjAsIDMuNSwgMCwgMSksIC8qIDE2MCAqL1xuICAgICAgICBuZXcgQUJSUHJlc2V0cygxOTIsIDksIDksIDEsIDEuNDksIDUuNjAsIDEyNSwgMCwgMC45NywgLTQsIDcuMCwgMywgMCwgMCksIC8qIDE5MiAqL1xuICAgICAgICBuZXcgQUJSUHJlc2V0cygyMjQsIDksIDksIDEsIDEuMjUsIDUuMjAsIDEyNSwgMCwgMC45OCwgLTYsIDkuMCwgMiwgMCwgMCksIC8qIDIyNCAqL1xuICAgICAgICBuZXcgQUJSUHJlc2V0cygyNTYsIDksIDksIDEsIDAuOTcsIDUuMjAsIDEyNSwgMCwgMS4wMCwgLTgsIDEwLjAsIDEsIDAsIDApLCAvKiAyNTYgKi9cbiAgICAgICAgbmV3IEFCUlByZXNldHMoMzIwLCA5LCA5LCAxLCAwLjkwLCA1LjIwLCAxMjUsIDAsIDEuMDAsIC0xMCwgMTIuMCwgMCwgMCwgMCkgIC8qIDMyMCAqL1xuICAgIF07XG5cbiAgICBmdW5jdGlvbiBhcHBseV9hYnJfcHJlc2V0KGdmcCwgcHJlc2V0LCBlbmZvcmNlKSB7XG4gICAgICAgIC8qIFZhcmlhYmxlcyBmb3IgdGhlIEFCUiBzdHVmZiAqL1xuICAgICAgICB2YXIgYWN0dWFsX2JpdHJhdGUgPSBwcmVzZXQ7XG5cbiAgICAgICAgdmFyIHIgPSBsYW1lLm5lYXJlc3RCaXRyYXRlRnVsbEluZGV4KHByZXNldCk7XG5cbiAgICAgICAgZ2ZwLlZCUiA9IFZick1vZGUudmJyX2FicjtcbiAgICAgICAgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyA9IGFjdHVhbF9iaXRyYXRlO1xuICAgICAgICBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzID0gTWF0aC5taW4oZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcywgMzIwKTtcbiAgICAgICAgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyA9IE1hdGgubWF4KGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMsIDgpO1xuICAgICAgICBnZnAuYnJhdGUgPSBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzO1xuICAgICAgICBpZiAoZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyA+IDMyMCkge1xuICAgICAgICAgICAgZ2ZwLmRpc2FibGVfcmVzZXJ2b2lyID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIHBhcmFtZXRlcnMgZm9yIHdoaWNoIHRoZXJlIGlzIG5vIHByb3BlciBzZXQvZ2V0IGludGVyZmFjZSAqL1xuICAgICAgICBpZiAoYWJyX3N3aXRjaF9tYXBbcl0uc2FmZWpvaW50ID4gMClcbiAgICAgICAgICAgIGdmcC5leHBfbnNwc3l0dW5lID0gZ2ZwLmV4cF9uc3BzeXR1bmUgfCAyO1xuICAgICAgICAvKiBzYWZlam9pbnQgKi9cblxuICAgICAgICBpZiAoYWJyX3N3aXRjaF9tYXBbcl0uc2ZzY2FsZSA+IDApIHtcbiAgICAgICAgICAgIGdmcC5pbnRlcm5hbF9mbGFncy5ub2lzZV9zaGFwaW5nID0gMjtcbiAgICAgICAgfVxuICAgICAgICAvKiBucy1iYXNzIHR3ZWFrcyAqL1xuICAgICAgICBpZiAoTWF0aC5hYnMoYWJyX3N3aXRjaF9tYXBbcl0ubnNiYXNzKSA+IDApIHtcbiAgICAgICAgICAgIHZhciBrID0gKGludCkoYWJyX3N3aXRjaF9tYXBbcl0ubnNiYXNzICogNCk7XG4gICAgICAgICAgICBpZiAoayA8IDApXG4gICAgICAgICAgICAgICAgayArPSA2NDtcbiAgICAgICAgICAgIGdmcC5leHBfbnNwc3l0dW5lID0gZ2ZwLmV4cF9uc3BzeXR1bmUgfCAoayA8PCAyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAucXVhbnRfY29tcCA9IGFicl9zd2l0Y2hfbWFwW3JdLnF1YW50X2NvbXA7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLnF1YW50X2NvbXAgLSAtMSkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5xdWFudF9jb21wID0gYWJyX3N3aXRjaF9tYXBbcl0ucXVhbnRfY29tcDtcbiAgICAgICAgLy8gU0VUX09QVElPTihxdWFudF9jb21wLCBhYnJfc3dpdGNoX21hcFtyXS5xdWFudF9jb21wLCAtMSk7XG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAucXVhbnRfY29tcF9zaG9ydCA9IGFicl9zd2l0Y2hfbWFwW3JdLnF1YW50X2NvbXBfcztcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAucXVhbnRfY29tcF9zaG9ydCAtIC0xKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLnF1YW50X2NvbXBfc2hvcnQgPSBhYnJfc3dpdGNoX21hcFtyXS5xdWFudF9jb21wX3M7XG4gICAgICAgIC8vIFNFVF9PUFRJT04ocXVhbnRfY29tcF9zaG9ydCwgYWJyX3N3aXRjaF9tYXBbcl0ucXVhbnRfY29tcF9zLCAtMSk7XG5cbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5tc2ZpeCA9IGFicl9zd2l0Y2hfbWFwW3JdLm5zbXNmaXg7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLm1zZml4IC0gLTEpID4gMCkpXG4gICAgICAgICAgICBnZnAubXNmaXggPSBhYnJfc3dpdGNoX21hcFtyXS5uc21zZml4O1xuICAgICAgICAvLyBTRVRfT1BUSU9OKG1zZml4LCBhYnJfc3dpdGNoX21hcFtyXS5uc21zZml4LCAtMSk7XG5cbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5pbnRlcm5hbF9mbGFncy5uc1BzeS5hdHRhY2t0aHJlID0gYWJyX3N3aXRjaF9tYXBbcl0uc3RfbHJtO1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5pbnRlcm5hbF9mbGFncy5uc1BzeS5hdHRhY2t0aHJlIC0gLTEpID4gMCkpXG4gICAgICAgICAgICBnZnAuaW50ZXJuYWxfZmxhZ3MubnNQc3kuYXR0YWNrdGhyZSA9IGFicl9zd2l0Y2hfbWFwW3JdLnN0X2xybTtcbiAgICAgICAgLy8gU0VUX09QVElPTihzaG9ydF90aHJlc2hvbGRfbHJtLCBhYnJfc3dpdGNoX21hcFtyXS5zdF9scm0sIC0xKTtcbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5pbnRlcm5hbF9mbGFncy5uc1BzeS5hdHRhY2t0aHJlX3MgPSBhYnJfc3dpdGNoX21hcFtyXS5zdF9zO1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5pbnRlcm5hbF9mbGFncy5uc1BzeS5hdHRhY2t0aHJlX3MgLSAtMSkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5pbnRlcm5hbF9mbGFncy5uc1BzeS5hdHRhY2t0aHJlX3MgPSBhYnJfc3dpdGNoX21hcFtyXS5zdF9zO1xuICAgICAgICAvLyBTRVRfT1BUSU9OKHNob3J0X3RocmVzaG9sZF9zLCBhYnJfc3dpdGNoX21hcFtyXS5zdF9zLCAtMSk7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogQUJSIHNlZW1zIHRvIGhhdmUgYmlnIHByb2JsZW1zIHdpdGggY2xpcHBpbmcsIGVzcGVjaWFsbHkgYXQgbG93XG4gICAgICAgICAqIGJpdHJhdGVzXG4gICAgICAgICAqL1xuICAgICAgICAvKlxuICAgICAgICAgKiBzbyB3ZSBjb21wZW5zYXRlIGZvciB0aGF0IGhlcmUgYnkgdXNpbmcgYSBzY2FsZSB2YWx1ZSBkZXBlbmRpbmcgb25cbiAgICAgICAgICogYml0cmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5zY2FsZSA9IGFicl9zd2l0Y2hfbWFwW3JdLnNjYWxlO1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5zY2FsZSAtIC0xKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLnNjYWxlID0gYWJyX3N3aXRjaF9tYXBbcl0uc2NhbGU7XG4gICAgICAgIC8vIFNFVF9PUFRJT04oc2NhbGUsIGFicl9zd2l0Y2hfbWFwW3JdLnNjYWxlLCAtMSk7XG5cbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5tYXNraW5nYWRqdXN0ID0gYWJyX3N3aXRjaF9tYXBbcl0ubWFza2luZ19hZGo7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLm1hc2tpbmdhZGp1c3QgLSAwKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLm1hc2tpbmdhZGp1c3QgPSBhYnJfc3dpdGNoX21hcFtyXS5tYXNraW5nX2FkajtcbiAgICAgICAgLy8gU0VUX09QVElPTihtYXNraW5nYWRqdXN0LCBhYnJfc3dpdGNoX21hcFtyXS5tYXNraW5nX2FkaiwgMCk7XG4gICAgICAgIGlmIChhYnJfc3dpdGNoX21hcFtyXS5tYXNraW5nX2FkaiA+IDApIHtcbiAgICAgICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICAgICAgZ2ZwLm1hc2tpbmdhZGp1c3Rfc2hvcnQgPSAoYWJyX3N3aXRjaF9tYXBbcl0ubWFza2luZ19hZGogKiAuOSk7XG4gICAgICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5tYXNraW5nYWRqdXN0X3Nob3J0IC0gMCkgPiAwKSlcbiAgICAgICAgICAgICAgICBnZnAubWFza2luZ2FkanVzdF9zaG9ydCA9IChhYnJfc3dpdGNoX21hcFtyXS5tYXNraW5nX2FkaiAqIC45KTtcbiAgICAgICAgICAgIC8vIFNFVF9PUFRJT04obWFza2luZ2FkanVzdF9zaG9ydCwgYWJyX3N3aXRjaF9tYXBbcl0ubWFza2luZ19hZGogKlxuICAgICAgICAgICAgLy8gLjksIDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgICAgICBnZnAubWFza2luZ2FkanVzdF9zaG9ydCA9IChhYnJfc3dpdGNoX21hcFtyXS5tYXNraW5nX2FkaiAqIDEuMSk7XG4gICAgICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5tYXNraW5nYWRqdXN0X3Nob3J0IC0gMCkgPiAwKSlcbiAgICAgICAgICAgICAgICBnZnAubWFza2luZ2FkanVzdF9zaG9ydCA9IChhYnJfc3dpdGNoX21hcFtyXS5tYXNraW5nX2FkaiAqIDEuMSk7XG4gICAgICAgICAgICAvLyBTRVRfT1BUSU9OKG1hc2tpbmdhZGp1c3Rfc2hvcnQsIGFicl9zd2l0Y2hfbWFwW3JdLm1hc2tpbmdfYWRqICpcbiAgICAgICAgICAgIC8vIDEuMSwgMCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLkFUSGxvd2VyID0gLWFicl9zd2l0Y2hfbWFwW3JdLmF0aF9sb3dlciAvIDEwLjtcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicygoLWdmcC5BVEhsb3dlciAqIDEwLikgLSAwKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLkFUSGxvd2VyID0gLWFicl9zd2l0Y2hfbWFwW3JdLmF0aF9sb3dlciAvIDEwLjtcbiAgICAgICAgLy8gU0VUX09QVElPTihBVEhsb3dlciwgYWJyX3N3aXRjaF9tYXBbcl0uYXRoX2xvd2VyLCAwKTtcbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5BVEhjdXJ2ZSA9IGFicl9zd2l0Y2hfbWFwW3JdLmF0aF9jdXJ2ZTtcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAuQVRIY3VydmUgLSAtMSkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5BVEhjdXJ2ZSA9IGFicl9zd2l0Y2hfbWFwW3JdLmF0aF9jdXJ2ZTtcbiAgICAgICAgLy8gU0VUX09QVElPTihBVEhjdXJ2ZSwgYWJyX3N3aXRjaF9tYXBbcl0uYXRoX2N1cnZlLCAtMSk7XG5cbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5pbnRlckNoUmF0aW8gPSBhYnJfc3dpdGNoX21hcFtyXS5pbnRlcmNoO1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5pbnRlckNoUmF0aW8gLSAtMSkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5pbnRlckNoUmF0aW8gPSBhYnJfc3dpdGNoX21hcFtyXS5pbnRlcmNoO1xuICAgICAgICAvLyBTRVRfT1BUSU9OKGludGVyQ2hSYXRpbywgYWJyX3N3aXRjaF9tYXBbcl0uaW50ZXJjaCwgLTEpO1xuXG4gICAgICAgIHJldHVybiBwcmVzZXQ7XG4gICAgfVxuXG4gICAgdGhpcy5hcHBseV9wcmVzZXQgPSBmdW5jdGlvbihnZnAsIHByZXNldCwgZW5mb3JjZSkge1xuICAgICAgICAvKiB0cmFuc2xhdGUgbGVnYWN5IHByZXNldHMgKi9cbiAgICAgICAgc3dpdGNoIChwcmVzZXQpIHtcbiAgICAgICAgICAgIGNhc2UgTGFtZS5SM01JWDpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcmVzZXQgPSBMYW1lLlYzO1xuICAgICAgICAgICAgICAgIGdmcC5WQlIgPSBWYnJNb2RlLnZicl9tdHJoO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBMYW1lLk1FRElVTTpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcmVzZXQgPSBMYW1lLlY0O1xuICAgICAgICAgICAgICAgIGdmcC5WQlIgPSBWYnJNb2RlLnZicl9yaDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgTGFtZS5NRURJVU1fRkFTVDpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcmVzZXQgPSBMYW1lLlY0O1xuICAgICAgICAgICAgICAgIGdmcC5WQlIgPSBWYnJNb2RlLnZicl9tdHJoO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBMYW1lLlNUQU5EQVJEOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHByZXNldCA9IExhbWUuVjI7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUiA9IFZick1vZGUudmJyX3JoO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBMYW1lLlNUQU5EQVJEX0ZBU1Q6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJlc2V0ID0gTGFtZS5WMjtcbiAgICAgICAgICAgICAgICBnZnAuVkJSID0gVmJyTW9kZS52YnJfbXRyaDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgTGFtZS5FWFRSRU1FOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHByZXNldCA9IExhbWUuVjA7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUiA9IFZick1vZGUudmJyX3JoO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBMYW1lLkVYVFJFTUVfRkFTVDpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcmVzZXQgPSBMYW1lLlYwO1xuICAgICAgICAgICAgICAgIGdmcC5WQlIgPSBWYnJNb2RlLnZicl9tdHJoO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBMYW1lLklOU0FORTpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcmVzZXQgPSAzMjA7XG4gICAgICAgICAgICAgICAgZ2ZwLnByZXNldCA9IHByZXNldDtcbiAgICAgICAgICAgICAgICBhcHBseV9hYnJfcHJlc2V0KGdmcCwgcHJlc2V0LCBlbmZvcmNlKTtcbiAgICAgICAgICAgICAgICBnZnAuVkJSID0gVmJyTW9kZS52YnJfb2ZmO1xuICAgICAgICAgICAgICAgIHJldHVybiBwcmVzZXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBnZnAucHJlc2V0ID0gcHJlc2V0O1xuICAgICAgICB7XG4gICAgICAgICAgICBzd2l0Y2ggKHByZXNldCkge1xuICAgICAgICAgICAgICAgIGNhc2UgTGFtZS5WOTpcbiAgICAgICAgICAgICAgICAgICAgYXBwbHlfdmJyX3ByZXNldChnZnAsIDksIGVuZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJlc2V0O1xuICAgICAgICAgICAgICAgIGNhc2UgTGFtZS5WODpcbiAgICAgICAgICAgICAgICAgICAgYXBwbHlfdmJyX3ByZXNldChnZnAsIDgsIGVuZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJlc2V0O1xuICAgICAgICAgICAgICAgIGNhc2UgTGFtZS5WNzpcbiAgICAgICAgICAgICAgICAgICAgYXBwbHlfdmJyX3ByZXNldChnZnAsIDcsIGVuZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJlc2V0O1xuICAgICAgICAgICAgICAgIGNhc2UgTGFtZS5WNjpcbiAgICAgICAgICAgICAgICAgICAgYXBwbHlfdmJyX3ByZXNldChnZnAsIDYsIGVuZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJlc2V0O1xuICAgICAgICAgICAgICAgIGNhc2UgTGFtZS5WNTpcbiAgICAgICAgICAgICAgICAgICAgYXBwbHlfdmJyX3ByZXNldChnZnAsIDUsIGVuZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJlc2V0O1xuICAgICAgICAgICAgICAgIGNhc2UgTGFtZS5WNDpcbiAgICAgICAgICAgICAgICAgICAgYXBwbHlfdmJyX3ByZXNldChnZnAsIDQsIGVuZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJlc2V0O1xuICAgICAgICAgICAgICAgIGNhc2UgTGFtZS5WMzpcbiAgICAgICAgICAgICAgICAgICAgYXBwbHlfdmJyX3ByZXNldChnZnAsIDMsIGVuZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJlc2V0O1xuICAgICAgICAgICAgICAgIGNhc2UgTGFtZS5WMjpcbiAgICAgICAgICAgICAgICAgICAgYXBwbHlfdmJyX3ByZXNldChnZnAsIDIsIGVuZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJlc2V0O1xuICAgICAgICAgICAgICAgIGNhc2UgTGFtZS5WMTpcbiAgICAgICAgICAgICAgICAgICAgYXBwbHlfdmJyX3ByZXNldChnZnAsIDEsIGVuZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJlc2V0O1xuICAgICAgICAgICAgICAgIGNhc2UgTGFtZS5WMDpcbiAgICAgICAgICAgICAgICAgICAgYXBwbHlfdmJyX3ByZXNldChnZnAsIDAsIGVuZm9yY2UpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJlc2V0O1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICg4IDw9IHByZXNldCAmJiBwcmVzZXQgPD0gMzIwKSB7XG4gICAgICAgICAgICByZXR1cm4gYXBwbHlfYWJyX3ByZXNldChnZnAsIHByZXNldCwgZW5mb3JjZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBubyBjb3JyZXNwb25kaW5nIHByZXNldCBmb3VuZCAqL1xuICAgICAgICBnZnAucHJlc2V0ID0gMDtcbiAgICAgICAgcmV0dXJuIHByZXNldDtcbiAgICB9XG5cbiAgICAvLyBSZXN0IGZyb20gZ2V0c2V0LmM6XG5cbiAgICAvKipcbiAgICAgKiBWQlIgcXVhbGl0eSBsZXZlbC48QlI+XG4gICAgICogMCA9IGhpZ2hlc3Q8QlI+XG4gICAgICogOSA9IGxvd2VzdFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGxhbWVfc2V0X1ZCUl9xKGdmcCwgVkJSX3EpIHtcbiAgICAgICAgdmFyIHJldCA9IDA7XG5cbiAgICAgICAgaWYgKDAgPiBWQlJfcSkge1xuICAgICAgICAgICAgLyogVW5rbm93biBWQlIgcXVhbGl0eSBsZXZlbCEgKi9cbiAgICAgICAgICAgIHJldCA9IC0xO1xuICAgICAgICAgICAgVkJSX3EgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICg5IDwgVkJSX3EpIHtcbiAgICAgICAgICAgIHJldCA9IC0xO1xuICAgICAgICAgICAgVkJSX3EgPSA5O1xuICAgICAgICB9XG5cbiAgICAgICAgZ2ZwLlZCUl9xID0gVkJSX3E7XG4gICAgICAgIGdmcC5WQlJfcV9mcmFjID0gMDtcbiAgICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG5cbn1cblxuLypcbiAqICAgICAgYml0IHJlc2Vydm9pciBzb3VyY2UgZmlsZVxuICpcbiAqICAgICAgQ29weXJpZ2h0IChjKSAxOTk5LTIwMDAgTWFyayBUYXlsb3JcbiAqXG4gKiBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yXG4gKiBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG4gKiBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXJcbiAqIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCxcbiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mXG4gKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVVxuICogTGlicmFyeSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuXG4gKlxuICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpY1xuICogTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCB3cml0ZSB0byB0aGVcbiAqIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgSW5jLiwgNTkgVGVtcGxlIFBsYWNlIC0gU3VpdGUgMzMwLFxuICogQm9zdG9uLCBNQSAwMjExMS0xMzA3LCBVU0EuXG4gKi9cblxuLyogJElkOiBSZXNlcnZvaXIuamF2YSx2IDEuOSAyMDExLzA1LzI0IDIwOjQ4OjA2IGtlbmNoaXMgRXhwICQgKi9cblxuLy9wYWNrYWdlIG1wMztcblxuLyoqXG4gKiBSZXN2RnJhbWVCZWdpbjo8QlI+XG4gKiBDYWxsZWQgKHJlcGVhdGVkbHkpIGF0IHRoZSBiZWdpbm5pbmcgb2YgYSBmcmFtZS4gVXBkYXRlcyB0aGUgbWF4aW11bSBzaXplIG9mXG4gKiB0aGUgcmVzZXJ2b2lyLCBhbmQgY2hlY2tzIHRvIG1ha2Ugc3VyZSBtYWluX2RhdGFfYmVnaW4gd2FzIHNldCBwcm9wZXJseSBieVxuICogdGhlIGZvcm1hdHRlcjxCUj5cbiAqIEJhY2tncm91bmQgaW5mb3JtYXRpb246XG4gKiBcbiAqIFRoaXMgaXMgdGhlIG9yaWdpbmFsIHRleHQgZnJvbSB0aGUgSVNPIHN0YW5kYXJkLiBCZWNhdXNlIG9mIHNvb28gbWFueSBidWdzXG4gKiBhbmQgaXJyaXRhdGlvbnMgY29ycmVjdGluZyBjb21tZW50cyBhcmUgYWRkZWQgaW4gYnJhY2tldHMgW10uIEEgJ15XJyBtZWFuc1xuICogeW91IHNob3VsZCByZW1vdmUgdGhlIGxhc3Qgd29yZC5cbiAqIFxuICogPFBSRT5cbiAqICAxLiBUaGUgZm9sbG93aW5nIHJ1bGUgY2FuIGJlIHVzZWQgdG8gY2FsY3VsYXRlIHRoZSBtYXhpbXVtXG4gKiAgICAgbnVtYmVyIG9mIGJpdHMgdXNlZCBmb3Igb25lIGdyYW51bGUgW15XIGZyYW1lXTo8QlI+XG4gKiAgICAgQXQgdGhlIGhpZ2hlc3QgcG9zc2libGUgYml0cmF0ZSBvZiBMYXllciBJSUkgKDMyMCBrYnBzXG4gKiAgICAgcGVyIHN0ZXJlbyBzaWduYWwgW15XXldeV10sIDQ4IGtIeikgdGhlIGZyYW1lcyBtdXN0IGJlIG9mXG4gKiAgICAgW15XXldeVyBhcmUgZGVzaWduZWQgdG8gaGF2ZV0gY29uc3RhbnQgbGVuZ3RoLCBpLmUuXG4gKiAgICAgb25lIGJ1ZmZlciBbXldeVyB0aGUgZnJhbWVdIGxlbmd0aCBpczo8QlI+XG4gKiBcbiAqICAgICAgICAgMzIwIGticHMgKiAxMTUyLzQ4IGtIeiA9IDc2ODAgYml0ID0gOTYwIGJ5dGVcbiAqIFxuICogICAgIFRoaXMgdmFsdWUgaXMgdXNlZCBhcyB0aGUgbWF4aW11bSBidWZmZXIgcGVyIGNoYW5uZWwgW15XXlddIGF0XG4gKiAgICAgbG93ZXIgYml0cmF0ZXMgW3RoYW4gMzIwIGticHNdLiBBdCA2NCBrYnBzIG1vbm8gb3IgMTI4IGticHNcbiAqICAgICBzdGVyZW8gdGhlIG1haW4gZ3JhbnVsZSBsZW5ndGggaXMgNjQga2JwcyAqIDU3Ni80OCBrSHogPSA3NjggYml0XG4gKiAgICAgW3BlciBncmFudWxlIGFuZCBjaGFubmVsXSBhdCA0OCBrSHogc2FtcGxpbmcgZnJlcXVlbmN5LlxuICogICAgIFRoaXMgbWVhbnMgdGhhdCB0aGVyZSBpcyBhIG1heGltdW0gZGV2aWF0aW9uIChzaG9ydCB0aW1lIGJ1ZmZlclxuICogICAgIFs9IHJlc2Vydm9pcl0pIG9mIDc2ODAgLSAyKjIqNzY4ID0gNDYwOCBiaXRzIGlzIGFsbG93ZWQgYXQgNjQga2Jwcy5cbiAqICAgICBUaGUgYWN0dWFsIGRldmlhdGlvbiBpcyBlcXVhbCB0byB0aGUgbnVtYmVyIG9mIGJ5dGVzIFt3aXRoIHRoZVxuICogICAgIG1lYW5pbmcgb2Ygb2N0ZXRzXSBkZW5vdGVkIGJ5IHRoZSBtYWluX2RhdGFfZW5kIG9mZnNldCBwb2ludGVyLlxuICogICAgIFRoZSBhY3R1YWwgbWF4aW11bSBkZXZpYXRpb24gaXMgKDJeOS0xKSo4IGJpdCA9IDQwODggYml0c1xuICogICAgIFtmb3IgTVBFRy0xIGFuZCAoMl44LTEpKjggYml0IGZvciBNUEVHLTIsIGJvdGggYXJlIGhhcmQgbGltaXRzXS5cbiAqICAgICAuLi4gVGhlIHhjaGFuZ2Ugb2YgYnVmZmVyIGJpdHMgYmV0d2VlbiB0aGUgbGVmdCBhbmQgcmlnaHQgY2hhbm5lbFxuICogICAgIGlzIGFsbG93ZWQgd2l0aG91dCByZXN0cmljdGlvbnMgW2V4Y2VwdGlvbjogZHVhbCBjaGFubmVsXS5cbiAqICAgICBCZWNhdXNlIG9mIHRoZSBbY29uc3RydWN0ZWRdIGNvbnN0cmFpbnQgb24gdGhlIGJ1ZmZlciBzaXplXG4gKiAgICAgbWFpbl9kYXRhX2VuZCBpcyBhbHdheXMgc2V0IHRvIDAgaW4gdGhlIGNhc2Ugb2YgYml0X3JhdGVfaW5kZXg9PTE0LFxuICogICAgIGkuZS4gZGF0YSByYXRlIDMyMCBrYnBzIHBlciBzdGVyZW8gc2lnbmFsIFteV15XXlddLiBJbiB0aGlzIGNhc2VcbiAqICAgICBhbGwgZGF0YSBhcmUgYWxsb2NhdGVkIGJldHdlZW4gYWRqYWNlbnQgaGVhZGVyIFteVyBzeW5jXSB3b3Jkc1xuICogICAgIFssIGkuZS4gdGhlcmUgaXMgbm8gYnVmZmVyaW5nIGF0IGFsbF0uXG4gKiA8L1BSRT5cbiAqL1xuXG5cbmZ1bmN0aW9uIFJlc2Vydm9pcigpIHtcblx0dmFyIGJzO1xuXG5cdHRoaXMuc2V0TW9kdWxlcyAgPSBmdW5jdGlvbihfYnMpIHtcblx0XHRicyA9IF9icztcblx0fVxuXG5cdHRoaXMuUmVzdkZyYW1lQmVnaW4gPSBmdW5jdGlvbihnZnAsIG1lYW5fYml0cykge1xuXHRcdHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cdFx0dmFyIG1heG1wM2J1Zjtcblx0XHR2YXIgbDNfc2lkZSA9IGdmYy5sM19zaWRlO1xuXG5cdFx0dmFyIGZyYW1lTGVuZ3RoID0gYnMuZ2V0ZnJhbWViaXRzKGdmcCk7XG5cdFx0bWVhbl9iaXRzLmJpdHMgPSAoZnJhbWVMZW5ndGggLSBnZmMuc2lkZWluZm9fbGVuICogOCkgLyBnZmMubW9kZV9ncjtcblxuXHRcdC8qKlxuXHRcdCAqIDxQUkU+XG5cdFx0ICogIE1lYW5pbmcgb2YgdGhlIHZhcmlhYmxlczpcblx0XHQgKiAgICAgIHJlc3ZMaW1pdDogKDAsIDgsIC4uLiwgOCoyNTUgKE1QRUctMiksIDgqNTExIChNUEVHLTEpKVxuXHRcdCAqICAgICAgICAgIE51bWJlciBvZiBiaXRzIGNhbiBiZSBzdG9yZWQgaW4gcHJldmlvdXMgZnJhbWUocykgZHVlIHRvXG5cdFx0ICogICAgICAgICAgY291bnRlciBzaXplIGNvbnN0YWludHNcblx0XHQgKiAgICAgIG1heG1wM2J1ZjogKCA/Pz8gLi4uIDgqMTk1MSAoTVBFRy0xIGFuZCAyKSwgOCoyMDQ3IChNUEVHLTIuNSkpXG5cdFx0ICogICAgICAgICAgTnVtYmVyIG9mIGJpdHMgYWxsb3dlZCB0byBlbmNvZGUgb25lIGZyYW1lICh5b3UgY2FuIHRha2UgOCo1MTEgYml0XG5cdFx0ICogICAgICAgICAgZnJvbSB0aGUgYml0IHJlc2Vydm9pciBhbmQgYXQgbW9zdCA4KjE0NDAgYml0IGZyb20gdGhlIGN1cnJlbnRcblx0XHQgKiAgICAgICAgICBmcmFtZSAoMzIwIGticHMsIDMyIGtIeiksIHNvIDgqMTk1MSBiaXQgaXMgdGhlIGxhcmdlc3QgcG9zc2libGVcblx0XHQgKiAgICAgICAgICB2YWx1ZSBmb3IgTVBFRy0xIGFuZCAtMilcblx0XHQgKiBcblx0XHQgKiAgICAgICAgICBtYXhpbXVtIGFsbG93ZWQgZ3JhbnVsZS9jaGFubmVsIHNpemUgdGltZXMgNCA9IDgqMjA0NyBiaXRzLixcblx0XHQgKiAgICAgICAgICBzbyB0aGlzIGlzIHRoZSBhYnNvbHV0ZSBtYXhpbXVtIHN1cHBvcnRlZCBieSB0aGUgZm9ybWF0LlxuXHRcdCAqIFxuXHRcdCAqIFxuXHRcdCAqICAgICAgZnVsbEZyYW1lQml0czogIG1heGltdW0gbnVtYmVyIG9mIGJpdHMgYXZhaWxhYmxlIGZvciBlbmNvZGluZ1xuXHRcdCAqICAgICAgICAgICAgICAgICAgICAgIHRoZSBjdXJyZW50IGZyYW1lLlxuXHRcdCAqIFxuXHRcdCAqICAgICAgbWVhbl9iaXRzOiAgICAgIHRhcmdldCBudW1iZXIgb2YgYml0cyBwZXIgZ3JhbnVsZS5cblx0XHQgKiBcblx0XHQgKiAgICAgIGZyYW1lTGVuZ3RoOlxuXHRcdCAqIFxuXHRcdCAqICAgICAgZ2ZjLlJlc3ZNYXg6ICAgbWF4aW11bSBhbGxvd2VkIHJlc2Vydm9pclxuXHRcdCAqIFxuXHRcdCAqICAgICAgZ2ZjLlJlc3ZTaXplOiAgY3VycmVudCByZXNlcnZvaXIgc2l6ZVxuXHRcdCAqIFxuXHRcdCAqICAgICAgbDNfc2lkZS5yZXN2RHJhaW5fcHJlOlxuXHRcdCAqICAgICAgICAgYW5jaWxsYXJ5IGRhdGEgdG8gYmUgYWRkZWQgdG8gcHJldmlvdXMgZnJhbWU6XG5cdFx0ICogICAgICAgICAob25seSB1c2VmdWxsIGluIFZCUiBtb2RlcyBpZiBpdCBpcyBwb3NzaWJsZSB0byBoYXZlXG5cdFx0ICogICAgICAgICBtYXhtcDNidWYgPCBmdWxsRnJhbWVCaXRzKSkuICBDdXJyZW50bHkgZGlzYWJsZWQsXG5cdFx0ICogICAgICAgICBzZWUgI2RlZmluZSBORVdfRFJBSU5cblx0XHQgKiAgICAgICAgIDIwMTAtMDItMTM6IFJIIG5vdyBlbmFibGVkLCBpdCBzZWVtcyB0byBiZSBuZWVkZWQgZm9yIENCUiB0b28sXG5cdFx0ICogICAgICAgICAgICAgICAgICAgICBhcyB0aGVyZSBleGlzdHMgb25lIGV4YW1wbGUsIHdoZXJlIHRoZSBGaEcgZGVjb2RlclxuXHRcdCAqICAgICAgICAgICAgICAgICAgICAgY2FuJ3QgZGVjb2RlIGEgLWIzMjAgQ0JSIGZpbGUgYW55bW9yZS5cblx0XHQgKiBcblx0XHQgKiAgICAgIGwzX3NpZGUucmVzdkRyYWluX3Bvc3Q6XG5cdFx0ICogICAgICAgICBhbmNpbGxhcnkgZGF0YSB0byBiZSBhZGRlZCB0byB0aGlzIGZyYW1lOlxuXHRcdCAqIFxuXHRcdCAqIDwvUFJFPlxuXHRcdCAqL1xuXG5cdFx0LyogbWFpbl9kYXRhX2JlZ2luIGhhcyA5IGJpdHMgaW4gTVBFRy0xLCA4IGJpdHMgTVBFRy0yICovXG5cdFx0dmFyIHJlc3ZMaW1pdCA9ICg4ICogMjU2KSAqIGdmYy5tb2RlX2dyIC0gODtcblxuXHRcdC8qXG5cdFx0ICogbWF4aW11bSBhbGxvd2VkIGZyYW1lIHNpemUuIGRvbnQgdXNlIG1vcmUgdGhhbiB0aGlzIG51bWJlciBvZiBiaXRzLFxuXHRcdCAqIGV2ZW4gaWYgdGhlIGZyYW1lIGhhcyB0aGUgc3BhY2UgZm9yIHRoZW06XG5cdFx0ICovXG5cdFx0aWYgKGdmcC5icmF0ZSA+IDMyMCkge1xuXHRcdFx0LyogaW4gZnJlZWZvcm1hdCB0aGUgYnVmZmVyIGlzIGNvbnN0YW50ICovXG5cdFx0XHRtYXhtcDNidWYgPSA4ICogKChpbnQpICgoZ2ZwLmJyYXRlICogMTAwMClcblx0XHRcdFx0XHQvIChnZnAub3V0X3NhbXBsZXJhdGUgLyAxMTUyKSAvIDggKyAuNSkpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvKlxuXHRcdFx0ICogYWxsIG1wMyBkZWNvZGVycyBzaG91bGQgaGF2ZSBlbm91Z2ggYnVmZmVyIHRvIGhhbmRsZSB0aGlzIHZhbHVlOlxuXHRcdFx0ICogc2l6ZSBvZiBhIDMyMGticHMgMzJrSHogZnJhbWVcblx0XHRcdCAqL1xuXHRcdFx0bWF4bXAzYnVmID0gOCAqIDE0NDA7XG5cblx0XHRcdC8qXG5cdFx0XHQgKiBCb3V2aWduZSBzdWdnZXN0cyB0aGlzIG1vcmUgbGF4IGludGVycHJldGF0aW9uIG9mIHRoZSBJU08gZG9jXG5cdFx0XHQgKiBpbnN0ZWFkIG9mIHVzaW5nIDgqOTYwLlxuXHRcdFx0ICovXG5cblx0XHRcdGlmIChnZnAuc3RyaWN0X0lTTykge1xuXHRcdFx0XHRtYXhtcDNidWYgPSA4ICogKChpbnQpICgzMjAwMDAgLyAoZ2ZwLm91dF9zYW1wbGVyYXRlIC8gMTE1MikgLyA4ICsgLjUpKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRnZmMuUmVzdk1heCA9IG1heG1wM2J1ZiAtIGZyYW1lTGVuZ3RoO1xuXHRcdGlmIChnZmMuUmVzdk1heCA+IHJlc3ZMaW1pdClcblx0XHRcdGdmYy5SZXN2TWF4ID0gcmVzdkxpbWl0O1xuXHRcdGlmIChnZmMuUmVzdk1heCA8IDAgfHwgZ2ZwLmRpc2FibGVfcmVzZXJ2b2lyKVxuXHRcdFx0Z2ZjLlJlc3ZNYXggPSAwO1xuXG5cdFx0dmFyIGZ1bGxGcmFtZUJpdHMgPSBtZWFuX2JpdHMuYml0cyAqIGdmYy5tb2RlX2dyXG5cdFx0XHRcdCsgTWF0aC5taW4oZ2ZjLlJlc3ZTaXplLCBnZmMuUmVzdk1heCk7XG5cblx0XHRpZiAoZnVsbEZyYW1lQml0cyA+IG1heG1wM2J1Zilcblx0XHRcdGZ1bGxGcmFtZUJpdHMgPSBtYXhtcDNidWY7XG5cblxuXHRcdGwzX3NpZGUucmVzdkRyYWluX3ByZSA9IDA7XG5cblx0XHQvLyBmcmFtZSBhbmFseXplciBjb2RlXG5cdFx0aWYgKGdmYy5waW5mbyAhPSBudWxsKSB7XG5cdFx0XHQvKlxuXHRcdFx0ICogZXhwZWN0ZWQgYml0cyBwZXIgY2hhbm5lbCBwZXIgZ3JhbnVsZSBbaXMgdGhpcyBhbHNvIHJpZ2h0IGZvclxuXHRcdFx0ICogbW9uby9zdGVyZW8sIE1QRUctMS8yID9dXG5cdFx0XHQgKi9cblx0XHRcdGdmYy5waW5mby5tZWFuX2JpdHMgPSBtZWFuX2JpdHMuYml0cyAvIDI7XG5cdFx0XHRnZmMucGluZm8ucmVzdnNpemUgPSBnZmMuUmVzdlNpemU7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGZ1bGxGcmFtZUJpdHM7XG5cdH1cblxuXHQvKipcblx0ICogcmV0dXJucyB0YXJnX2JpdHM6IHRhcmdldCBudW1iZXIgb2YgYml0cyB0byB1c2UgZm9yIDEgZ3JhbnVsZTxCUj5cblx0ICogZXh0cmFfYml0czogYW1vdW50IGV4dHJhIGF2YWlsYWJsZSBmcm9tIHJlc2Vydm9pcjxCUj5cblx0ICogTWFyayBUYXlsb3IgNC85OVxuXHQgKi9cblx0dGhpcy5SZXN2TWF4Qml0cyA9IGZ1bmN0aW9uKGdmcCwgbWVhbl9iaXRzLCB0YXJnX2JpdHMsIGNicikge1xuXHRcdHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cdFx0dmFyIGFkZF9iaXRzO1xuICAgICAgICB2YXIgUmVzdlNpemUgPSBnZmMuUmVzdlNpemUsIFJlc3ZNYXggPSBnZmMuUmVzdk1heDtcblxuXHRcdC8qIGNvbXBlbnNhdGUgdGhlIHNhdmVkIGJpdHMgdXNlZCBpbiB0aGUgMXN0IGdyYW51bGUgKi9cblx0XHRpZiAoY2JyICE9IDApXG5cdFx0XHRSZXN2U2l6ZSArPSBtZWFuX2JpdHM7XG5cblx0XHRpZiAoKGdmYy5zdWJzdGVwX3NoYXBpbmcgJiAxKSAhPSAwKVxuXHRcdFx0UmVzdk1heCAqPSAwLjk7XG5cblx0XHR0YXJnX2JpdHMuYml0cyA9IG1lYW5fYml0cztcblxuXHRcdC8qIGV4dHJhIGJpdHMgaWYgdGhlIHJlc2Vydm9pciBpcyBhbG1vc3QgZnVsbCAqL1xuXHRcdGlmIChSZXN2U2l6ZSAqIDEwID4gUmVzdk1heCAqIDkpIHtcblx0XHRcdGFkZF9iaXRzID0gUmVzdlNpemUgLSAoUmVzdk1heCAqIDkpIC8gMTA7XG5cdFx0XHR0YXJnX2JpdHMuYml0cyArPSBhZGRfYml0cztcblx0XHRcdGdmYy5zdWJzdGVwX3NoYXBpbmcgfD0gMHg4MDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0YWRkX2JpdHMgPSAwO1xuXHRcdFx0Z2ZjLnN1YnN0ZXBfc2hhcGluZyAmPSAweDdmO1xuXHRcdFx0Lypcblx0XHRcdCAqIGJ1aWxkIHVwIHJlc2Vydm9pci4gdGhpcyBidWlsZHMgdGhlIHJlc2Vydm9pciBhIGxpdHRsZSBzbG93ZXJcblx0XHRcdCAqIHRoYW4gRmhHLiBJdCBjb3VsZCBzaW1wbGUgYmUgbWVhbl9iaXRzLzE1LCBidXQgdGhpcyB3YXMgcmlnZ2VkIHRvXG5cdFx0XHQgKiBhbHdheXMgcHJvZHVjZSAxMDAgKHRoZSBvbGQgdmFsdWUpIGF0IDEyOGtic1xuXHRcdFx0ICovXG5cdFx0XHRpZiAoIWdmcC5kaXNhYmxlX3Jlc2Vydm9pciAmJiAwID09IChnZmMuc3Vic3RlcF9zaGFwaW5nICYgMSkpXG5cdFx0XHRcdHRhcmdfYml0cy5iaXRzIC09IC4xICogbWVhbl9iaXRzO1xuXHRcdH1cblxuXHRcdC8qIGFtb3VudCBmcm9tIHRoZSByZXNlcnZvaXIgd2UgYXJlIGFsbG93ZWQgdG8gdXNlLiBJU08gc2F5cyA2LzEwICovXG5cdFx0dmFyIGV4dHJhX2JpdHMgPSAoUmVzdlNpemUgPCAoZ2ZjLlJlc3ZNYXggKiA2KSAvIDEwID8gUmVzdlNpemVcblx0XHRcdFx0OiAoZ2ZjLlJlc3ZNYXggKiA2KSAvIDEwKTtcblx0XHRleHRyYV9iaXRzIC09IGFkZF9iaXRzO1xuXG5cdFx0aWYgKGV4dHJhX2JpdHMgPCAwKVxuXHRcdFx0ZXh0cmFfYml0cyA9IDA7XG5cdFx0cmV0dXJuIGV4dHJhX2JpdHM7XG5cdH1cblxuXHQvKipcblx0ICogQ2FsbGVkIGFmdGVyIGEgZ3JhbnVsZSdzIGJpdCBhbGxvY2F0aW9uLiBSZWFkanVzdHMgdGhlIHNpemUgb2YgdGhlXG5cdCAqIHJlc2Vydm9pciB0byByZWZsZWN0IHRoZSBncmFudWxlJ3MgdXNhZ2UuXG5cdCAqL1xuXHR0aGlzLlJlc3ZBZGp1c3QgPSBmdW5jdGlvbihnZmMsIGdpKSB7XG5cdFx0Z2ZjLlJlc3ZTaXplIC09IGdpLnBhcnQyXzNfbGVuZ3RoICsgZ2kucGFydDJfbGVuZ3RoO1xuXHR9XG5cblx0LyoqXG5cdCAqIENhbGxlZCBhZnRlciBhbGwgZ3JhbnVsZXMgaW4gYSBmcmFtZSBoYXZlIGJlZW4gYWxsb2NhdGVkLiBNYWtlcyBzdXJlIHRoYXRcblx0ICogdGhlIHJlc2Vydm9pciBzaXplIGlzIHdpdGhpbiBsaW1pdHMsIHBvc3NpYmx5IGJ5IGFkZGluZyBzdHVmZmluZyBiaXRzLlxuXHQgKi9cblx0dGhpcy5SZXN2RnJhbWVFbmQgPSBmdW5jdGlvbihnZmMsIG1lYW5fYml0cykge1xuXHRcdHZhciBvdmVyX2JpdHM7XG5cdFx0dmFyIGwzX3NpZGUgPSBnZmMubDNfc2lkZTtcblxuXHRcdGdmYy5SZXN2U2l6ZSArPSBtZWFuX2JpdHMgKiBnZmMubW9kZV9ncjtcblx0XHR2YXIgc3R1ZmZpbmdCaXRzID0gMDtcblx0XHRsM19zaWRlLnJlc3ZEcmFpbl9wb3N0ID0gMDtcblx0XHRsM19zaWRlLnJlc3ZEcmFpbl9wcmUgPSAwO1xuXG5cdFx0Lyogd2UgbXVzdCBiZSBieXRlIGFsaWduZWQgKi9cblx0XHRpZiAoKG92ZXJfYml0cyA9IGdmYy5SZXN2U2l6ZSAlIDgpICE9IDApXG5cdFx0XHRzdHVmZmluZ0JpdHMgKz0gb3Zlcl9iaXRzO1xuXG5cdFx0b3Zlcl9iaXRzID0gKGdmYy5SZXN2U2l6ZSAtIHN0dWZmaW5nQml0cykgLSBnZmMuUmVzdk1heDtcblx0XHRpZiAob3Zlcl9iaXRzID4gMCkge1xuXHRcdFx0c3R1ZmZpbmdCaXRzICs9IG92ZXJfYml0cztcblx0XHR9XG5cblx0XHQvKlxuXHRcdCAqIE5PVEU6IGVuYWJsaW5nIHRoZSBORVdfRFJBSU4gY29kZSBmaXhlcyBzb21lIHByb2JsZW1zIHdpdGggRmhHXG5cdFx0ICogZGVjb2RlciBzaGlwcGVkIHdpdGggTVMgV2luZG93cyBvcGVyYXRpbmcgc3lzdGVtcy4gVXNpbmcgdGhpcywgaXQgaXNcblx0XHQgKiBldmVuIHBvc3NpYmxlIHRvIHVzZSBHYWJyaWVsJ3MgbGF4IGJ1ZmZlciBjb25zaWRlcmF0aW9uIGFnYWluLCB3aGljaFxuXHRcdCAqIGFzc3VtZXMsIGFueSBkZWNvZGVyIHNob3VsZCBoYXZlIGEgYnVmZmVyIGxhcmdlIGVub3VnaCBmb3IgYSAzMjAga2Jwc1xuXHRcdCAqIGZyYW1lIGF0IDMyIGtIeiBzYW1wbGUgcmF0ZS5cblx0XHQgKiBcblx0XHQgKiBvbGQgZHJhaW4gY29kZTogbGFtZSAtYjMyMCBCbGFja0JpcmQud2F2IC0tLiBkb2VzIG5vdCBwbGF5IHdpdGhcblx0XHQgKiBHcmFwaEVkaXQuZXhlIHVzaW5nIEZoRyBkZWNvZGVyIFYxLjUgQnVpbGQgNTBcblx0XHQgKiBcblx0XHQgKiBuZXcgZHJhaW4gY29kZTogbGFtZSAtYjMyMCBCbGFja0JpcmQud2F2IC0tLiBwbGF5cyBmaW5lIHdpdGhcblx0XHQgKiBHcmFwaEVkaXQuZXhlIHVzaW5nIEZoRyBkZWNvZGVyIFYxLjUgQnVpbGQgNTBcblx0XHQgKiBcblx0XHQgKiBSb2JlcnQgSGVnZW1hbm4sIDIwMTAtMDItMTMuXG5cdFx0ICovXG5cdFx0Lypcblx0XHQgKiBkcmFpbiBhcyBtYW55IGJpdHMgYXMgcG9zc2libGUgaW50byBwcmV2aW91cyBmcmFtZSBhbmNpbGxhcnkgZGF0YSBJblxuXHRcdCAqIHBhcnRpY3VsYXIsIGluIFZCUiBtb2RlIFJlc3ZNYXggbWF5IGhhdmUgY2hhbmdlZCwgYW5kIHdlIGhhdmUgdG8gbWFrZVxuXHRcdCAqIHN1cmUgbWFpbl9kYXRhX2JlZ2luIGRvZXMgbm90IGNyZWF0ZSBhIHJlc2Vydm9pciBiaWdnZXIgdGhhbiBSZXN2TWF4XG5cdFx0ICogbXQgNC8wMFxuXHRcdCAqL1xuXHRcdHtcblx0XHRcdHZhciBtZGJfYnl0ZXMgPSBNYXRoLm1pbihsM19zaWRlLm1haW5fZGF0YV9iZWdpbiAqIDgsIHN0dWZmaW5nQml0cykgLyA4O1xuXHRcdFx0bDNfc2lkZS5yZXN2RHJhaW5fcHJlICs9IDggKiBtZGJfYnl0ZXM7XG5cdFx0XHRzdHVmZmluZ0JpdHMgLT0gOCAqIG1kYl9ieXRlcztcblx0XHRcdGdmYy5SZXN2U2l6ZSAtPSA4ICogbWRiX2J5dGVzO1xuXHRcdFx0bDNfc2lkZS5tYWluX2RhdGFfYmVnaW4gLT0gbWRiX2J5dGVzO1xuXHRcdH1cblx0XHQvKiBkcmFpbiB0aGUgcmVzdCBpbnRvIHRoaXMgZnJhbWVzIGFuY2lsbGFyeSBkYXRhICovXG5cdFx0bDNfc2lkZS5yZXN2RHJhaW5fcG9zdCArPSBzdHVmZmluZ0JpdHM7XG5cdFx0Z2ZjLlJlc3ZTaXplIC09IHN0dWZmaW5nQml0cztcblx0fVxufVxuXG5cbi8qKlxuICogQSBWYnIgaGVhZGVyIG1heSBiZSBwcmVzZW50IGluIHRoZSBhbmNpbGxhcnkgZGF0YSBmaWVsZCBvZiB0aGUgZmlyc3QgZnJhbWUgb2ZcbiAqIGFuIG1wMyBiaXRzdHJlYW08QlI+XG4gKiBUaGUgVmJyIGhlYWRlciAob3B0aW9uYWxseSkgY29udGFpbnNcbiAqIDxVTD5cbiAqIDxMST5mcmFtZXMgdG90YWwgbnVtYmVyIG9mIGF1ZGlvIGZyYW1lcyBpbiB0aGUgYml0c3RyZWFtXG4gKiA8TEk+Ynl0ZXMgdG90YWwgbnVtYmVyIG9mIGJ5dGVzIGluIHRoZSBiaXRzdHJlYW1cbiAqIDxMST50b2MgdGFibGUgb2YgY29udGVudHNcbiAqIDwvVUw+XG4gKlxuICogdG9jICh0YWJsZSBvZiBjb250ZW50cykgZ2l2ZXMgc2VlayBwb2ludHMgZm9yIHJhbmRvbSBhY2Nlc3MuPEJSPlxuICogVGhlIGl0aCBlbnRyeSBkZXRlcm1pbmVzIHRoZSBzZWVrIHBvaW50IGZvciBpLXBlcmNlbnQgZHVyYXRpb24uPEJSPlxuICogc2VlayBwb2ludCBpbiBieXRlcyA9ICh0b2NbaV0vMjU2LjApICogdG90YWxfYml0c3RyZWFtX2J5dGVzPEJSPlxuICogZS5nLiBoYWxmIGR1cmF0aW9uIHNlZWsgcG9pbnQgPSAodG9jWzUwXS8yNTYuMCkgKiB0b3RhbF9iaXRzdHJlYW1fYnl0ZXNcbiAqL1xuVkJSVGFnLk5VTVRPQ0VOVFJJRVMgPSAxMDA7XG5WQlJUYWcuTUFYRlJBTUVTSVpFID0gMjg4MDtcblxuZnVuY3Rpb24gVkJSVGFnKCkge1xuXG4gICAgdmFyIGxhbWU7XG4gICAgdmFyIGJzO1xuICAgIHZhciB2O1xuXG4gICAgdGhpcy5zZXRNb2R1bGVzID0gZnVuY3Rpb24gKF9sYW1lLCBfYnMsIF92KSB7XG4gICAgICAgIGxhbWUgPSBfbGFtZTtcbiAgICAgICAgYnMgPSBfYnM7XG4gICAgICAgIHYgPSBfdjtcbiAgICB9O1xuXHRcblx0Ly9maXgg57K+566AXG5cdFxuICAgIC8qKlxuICAgICAqIExvb2t1cCB0YWJsZSBmb3IgZmFzdCBDUkMtMTYgY29tcHV0YXRpb24uIFVzZXMgdGhlIHBvbHlub21pYWxcbiAgICAgKiB4XjE2K3heMTUreF4yKzFcbiAgICAgKi9cbiAgICB2YXIgY3JjMTZMb29rdXAgPSBbMHgwMDAwLCAweEMwQzEsIDB4QzE4MSwgMHgwMTQwLFxuICAgICAgICAweEMzMDEsIDB4MDNDMCwgMHgwMjgwLCAweEMyNDEsIDB4QzYwMSwgMHgwNkMwLCAweDA3ODAsIDB4Qzc0MSxcbiAgICAgICAgMHgwNTAwLCAweEM1QzEsIDB4QzQ4MSwgMHgwNDQwLCAweENDMDEsIDB4MENDMCwgMHgwRDgwLCAweENENDEsXG4gICAgICAgIDB4MEYwMCwgMHhDRkMxLCAweENFODEsIDB4MEU0MCwgMHgwQTAwLCAweENBQzEsIDB4Q0I4MSwgMHgwQjQwLFxuICAgICAgICAweEM5MDEsIDB4MDlDMCwgMHgwODgwLCAweEM4NDEsIDB4RDgwMSwgMHgxOEMwLCAweDE5ODAsIDB4RDk0MSxcbiAgICAgICAgMHgxQjAwLCAweERCQzEsIDB4REE4MSwgMHgxQTQwLCAweDFFMDAsIDB4REVDMSwgMHhERjgxLCAweDFGNDAsXG4gICAgICAgIDB4REQwMSwgMHgxREMwLCAweDFDODAsIDB4REM0MSwgMHgxNDAwLCAweEQ0QzEsIDB4RDU4MSwgMHgxNTQwLFxuICAgICAgICAweEQ3MDEsIDB4MTdDMCwgMHgxNjgwLCAweEQ2NDEsIDB4RDIwMSwgMHgxMkMwLCAweDEzODAsIDB4RDM0MSxcbiAgICAgICAgMHgxMTAwLCAweEQxQzEsIDB4RDA4MSwgMHgxMDQwLCAweEYwMDEsIDB4MzBDMCwgMHgzMTgwLCAweEYxNDEsXG4gICAgICAgIDB4MzMwMCwgMHhGM0MxLCAweEYyODEsIDB4MzI0MCwgMHgzNjAwLCAweEY2QzEsIDB4Rjc4MSwgMHgzNzQwLFxuICAgICAgICAweEY1MDEsIDB4MzVDMCwgMHgzNDgwLCAweEY0NDEsIDB4M0MwMCwgMHhGQ0MxLCAweEZEODEsIDB4M0Q0MCxcbiAgICAgICAgMHhGRjAxLCAweDNGQzAsIDB4M0U4MCwgMHhGRTQxLCAweEZBMDEsIDB4M0FDMCwgMHgzQjgwLCAweEZCNDEsXG4gICAgICAgIDB4MzkwMCwgMHhGOUMxLCAweEY4ODEsIDB4Mzg0MCwgMHgyODAwLCAweEU4QzEsIDB4RTk4MSwgMHgyOTQwLFxuICAgICAgICAweEVCMDEsIDB4MkJDMCwgMHgyQTgwLCAweEVBNDEsIDB4RUUwMSwgMHgyRUMwLCAweDJGODAsIDB4RUY0MSxcbiAgICAgICAgMHgyRDAwLCAweEVEQzEsIDB4RUM4MSwgMHgyQzQwLCAweEU0MDEsIDB4MjRDMCwgMHgyNTgwLCAweEU1NDEsXG4gICAgICAgIDB4MjcwMCwgMHhFN0MxLCAweEU2ODEsIDB4MjY0MCwgMHgyMjAwLCAweEUyQzEsIDB4RTM4MSwgMHgyMzQwLFxuICAgICAgICAweEUxMDEsIDB4MjFDMCwgMHgyMDgwLCAweEUwNDEsIDB4QTAwMSwgMHg2MEMwLCAweDYxODAsIDB4QTE0MSxcbiAgICAgICAgMHg2MzAwLCAweEEzQzEsIDB4QTI4MSwgMHg2MjQwLCAweDY2MDAsIDB4QTZDMSwgMHhBNzgxLCAweDY3NDAsXG4gICAgICAgIDB4QTUwMSwgMHg2NUMwLCAweDY0ODAsIDB4QTQ0MSwgMHg2QzAwLCAweEFDQzEsIDB4QUQ4MSwgMHg2RDQwLFxuICAgICAgICAweEFGMDEsIDB4NkZDMCwgMHg2RTgwLCAweEFFNDEsIDB4QUEwMSwgMHg2QUMwLCAweDZCODAsIDB4QUI0MSxcbiAgICAgICAgMHg2OTAwLCAweEE5QzEsIDB4QTg4MSwgMHg2ODQwLCAweDc4MDAsIDB4QjhDMSwgMHhCOTgxLCAweDc5NDAsXG4gICAgICAgIDB4QkIwMSwgMHg3QkMwLCAweDdBODAsIDB4QkE0MSwgMHhCRTAxLCAweDdFQzAsIDB4N0Y4MCwgMHhCRjQxLFxuICAgICAgICAweDdEMDAsIDB4QkRDMSwgMHhCQzgxLCAweDdDNDAsIDB4QjQwMSwgMHg3NEMwLCAweDc1ODAsIDB4QjU0MSxcbiAgICAgICAgMHg3NzAwLCAweEI3QzEsIDB4QjY4MSwgMHg3NjQwLCAweDcyMDAsIDB4QjJDMSwgMHhCMzgxLCAweDczNDAsXG4gICAgICAgIDB4QjEwMSwgMHg3MUMwLCAweDcwODAsIDB4QjA0MSwgMHg1MDAwLCAweDkwQzEsIDB4OTE4MSwgMHg1MTQwLFxuICAgICAgICAweDkzMDEsIDB4NTNDMCwgMHg1MjgwLCAweDkyNDEsIDB4OTYwMSwgMHg1NkMwLCAweDU3ODAsIDB4OTc0MSxcbiAgICAgICAgMHg1NTAwLCAweDk1QzEsIDB4OTQ4MSwgMHg1NDQwLCAweDlDMDEsIDB4NUNDMCwgMHg1RDgwLCAweDlENDEsXG4gICAgICAgIDB4NUYwMCwgMHg5RkMxLCAweDlFODEsIDB4NUU0MCwgMHg1QTAwLCAweDlBQzEsIDB4OUI4MSwgMHg1QjQwLFxuICAgICAgICAweDk5MDEsIDB4NTlDMCwgMHg1ODgwLCAweDk4NDEsIDB4ODgwMSwgMHg0OEMwLCAweDQ5ODAsIDB4ODk0MSxcbiAgICAgICAgMHg0QjAwLCAweDhCQzEsIDB4OEE4MSwgMHg0QTQwLCAweDRFMDAsIDB4OEVDMSwgMHg4RjgxLCAweDRGNDAsXG4gICAgICAgIDB4OEQwMSwgMHg0REMwLCAweDRDODAsIDB4OEM0MSwgMHg0NDAwLCAweDg0QzEsIDB4ODU4MSwgMHg0NTQwLFxuICAgICAgICAweDg3MDEsIDB4NDdDMCwgMHg0NjgwLCAweDg2NDEsIDB4ODIwMSwgMHg0MkMwLCAweDQzODAsIDB4ODM0MSxcbiAgICAgICAgMHg0MTAwLCAweDgxQzEsIDB4ODA4MSwgMHg0MDQwXTtcblx0XHRcblx0Ly9maXgg57K+566AXG5cdFxuICAgIC8qKlxuICAgICAqIEZhc3QgQ1JDLTE2IGNvbXB1dGF0aW9uICh1c2VzIHRhYmxlIGNyYzE2TG9va3VwKS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB2YWx1ZVxuICAgICAqIEBwYXJhbSBjcmNcbiAgICAgKiBAcmV0dXJuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JjVXBkYXRlTG9va3VwKHZhbHVlLCBjcmMpIHtcbiAgICAgICAgdmFyIHRtcCA9IGNyYyBeIHZhbHVlO1xuICAgICAgICBjcmMgPSAoY3JjID4+IDgpIF4gY3JjMTZMb29rdXBbdG1wICYgMHhmZl07XG4gICAgICAgIHJldHVybiBjcmM7XG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGVNdXNpY0NSQyA9IGZ1bmN0aW9uIChjcmMsIGJ1ZmZlciwgYnVmZmVyUG9zLCBzaXplKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2l6ZTsgKytpKVxuICAgICAgICAgICAgY3JjWzBdID0gY3JjVXBkYXRlTG9va3VwKGJ1ZmZlcltidWZmZXJQb3MgKyBpXSwgY3JjWzBdKTtcbiAgICB9XG5cblx0Ly9maXgg57K+566AXG59XG5cblxuXG5CaXRTdHJlYW0uRVEgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgIHJldHVybiAoTWF0aC5hYnMoYSkgPiBNYXRoLmFicyhiKSkgPyAoTWF0aC5hYnMoKGEpIC0gKGIpKSA8PSAoTWF0aFxuICAgICAgICAuYWJzKGEpICogMWUtNikpXG4gICAgICAgIDogKE1hdGguYWJzKChhKSAtIChiKSkgPD0gKE1hdGguYWJzKGIpICogMWUtNikpO1xufTtcblxuQml0U3RyZWFtLk5FUSA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgcmV0dXJuICFCaXRTdHJlYW0uRVEoYSwgYik7XG59O1xuXG5mdW5jdGlvbiBCaXRTdHJlYW0oKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciBDUkMxNl9QT0xZTk9NSUFMID0gMHg4MDA1O1xuXG4gICAgLypcbiAgICAgKiB3ZSB3b3JrIHdpdGggaW50cywgc28gd2hlbiBkb2luZyBiaXQgbWFuaXB1bGF0aW9uLCB3ZSBsaW1pdCBvdXJzZWx2ZXMgdG9cbiAgICAgKiBNQVhfTEVOR1RILTIganVzdCB0byBiZSBvbiB0aGUgc2FmZSBzaWRlXG4gICAgICovXG4gICAgdmFyIE1BWF9MRU5HVEggPSAzMjtcblxuICAgIC8vR2FpbkFuYWx5c2lzIGdhO1xuICAgIC8vTVBHTGliIG1wZztcbiAgICAvL1ZlcnNpb24gdmVyO1xuICAgIC8vVkJSVGFnIHZicjtcbiAgICB2YXIgZ2EgPSBudWxsO1xuICAgIHZhciBtcGcgPSBudWxsO1xuICAgIHZhciB2ZXIgPSBudWxsO1xuICAgIHZhciB2YnIgPSBudWxsO1xuXG4gICAgLy9wdWJsaWMgZmluYWwgdm9pZCBzZXRNb2R1bGVzKEdhaW5BbmFseXNpcyBnYSwgTVBHTGliIG1wZywgVmVyc2lvbiB2ZXIsXG4gICAgLy9cdFZCUlRhZyB2YnIpIHtcblxuICAgIHRoaXMuc2V0TW9kdWxlcyA9IGZ1bmN0aW9uIChfZ2EsIF9tcGcsIF92ZXIsIF92YnIpIHtcbiAgICAgICAgZ2EgPSBfZ2E7XG4gICAgICAgIG1wZyA9IF9tcGc7XG4gICAgICAgIHZlciA9IF92ZXI7XG4gICAgICAgIHZiciA9IF92YnI7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEJpdCBzdHJlYW0gYnVmZmVyLlxuICAgICAqL1xuICAgIC8vcHJpdmF0ZSBieXRlW10gYnVmO1xuICAgIHZhciBidWYgPSBudWxsO1xuICAgIC8qKlxuICAgICAqIEJpdCBjb3VudGVyIG9mIGJpdCBzdHJlYW0uXG4gICAgICovXG4gICAgdmFyIHRvdGJpdCA9IDA7XG4gICAgLyoqXG4gICAgICogUG9pbnRlciB0byB0b3AgYnl0ZSBpbiBidWZmZXIuXG4gICAgICovXG4gICAgdmFyIGJ1ZkJ5dGVJZHggPSAwO1xuICAgIC8qKlxuICAgICAqIFBvaW50ZXIgdG8gdG9wIGJpdCBvZiB0b3AgYnl0ZSBpbiBidWZmZXIuXG4gICAgICovXG4gICAgdmFyIGJ1ZkJpdElkeCA9IDA7XG5cbiAgICAvKipcbiAgICAgKiBjb21wdXRlIGJpdHNwZXJmcmFtZSBhbmQgbWVhbl9iaXRzIGZvciBhIGxheWVyIElJSSBmcmFtZVxuICAgICAqL1xuICAgIHRoaXMuZ2V0ZnJhbWViaXRzID0gZnVuY3Rpb24gKGdmcCkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgYml0X3JhdGU7XG5cbiAgICAgICAgLyogZ2V0IGJpdHJhdGUgaW4ga2JwcyBbP10gKi9cbiAgICAgICAgaWYgKGdmYy5iaXRyYXRlX2luZGV4ICE9IDApXG4gICAgICAgICAgICBiaXRfcmF0ZSA9IFRhYmxlcy5iaXRyYXRlX3RhYmxlW2dmcC52ZXJzaW9uXVtnZmMuYml0cmF0ZV9pbmRleF07XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGJpdF9yYXRlID0gZ2ZwLmJyYXRlO1xuXG4gICAgICAgIC8qIG1haW4gZW5jb2Rpbmcgcm91dGluZSB0b2dnbGVzIHBhZGRpbmcgb24gYW5kIG9mZiAqL1xuICAgICAgICAvKiBvbmUgTGF5ZXIzIFNsb3QgY29uc2lzdHMgb2YgOCBiaXRzICovXG4gICAgICAgIHZhciBieXRlcyA9IDAgfCAoZ2ZwLnZlcnNpb24gKyAxKSAqIDcyMDAwICogYml0X3JhdGUgLyBnZnAub3V0X3NhbXBsZXJhdGUgKyBnZmMucGFkZGluZztcbiAgICAgICAgcmV0dXJuIDggKiBieXRlcztcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gcHV0aGVhZGVyX2JpdHMoZ2ZjKSB7XG4gICAgICAgIFN5c3RlbS5hcnJheWNvcHkoZ2ZjLmhlYWRlcltnZmMud19wdHJdLmJ1ZiwgMCwgYnVmLCBidWZCeXRlSWR4LCBnZmMuc2lkZWluZm9fbGVuKTtcbiAgICAgICAgYnVmQnl0ZUlkeCArPSBnZmMuc2lkZWluZm9fbGVuO1xuICAgICAgICB0b3RiaXQgKz0gZ2ZjLnNpZGVpbmZvX2xlbiAqIDg7XG4gICAgICAgIGdmYy53X3B0ciA9IChnZmMud19wdHIgKyAxKSAmIChMYW1lSW50ZXJuYWxGbGFncy5NQVhfSEVBREVSX0JVRiAtIDEpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHdyaXRlIGogYml0cyBpbnRvIHRoZSBiaXQgc3RyZWFtXG4gICAgICovXG4gICAgZnVuY3Rpb24gcHV0Yml0czIoZ2ZjLCB2YWwsIGopIHtcblxuXG4gICAgICAgIHdoaWxlIChqID4gMCkge1xuICAgICAgICAgICAgdmFyIGs7XG4gICAgICAgICAgICBpZiAoYnVmQml0SWR4ID09IDApIHtcbiAgICAgICAgICAgICAgICBidWZCaXRJZHggPSA4O1xuICAgICAgICAgICAgICAgIGJ1ZkJ5dGVJZHgrKztcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLmhlYWRlcltnZmMud19wdHJdLndyaXRlX3RpbWluZyA9PSB0b3RiaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgcHV0aGVhZGVyX2JpdHMoZ2ZjKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnVmW2J1ZkJ5dGVJZHhdID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgayA9IE1hdGgubWluKGosIGJ1ZkJpdElkeCk7XG4gICAgICAgICAgICBqIC09IGs7XG5cbiAgICAgICAgICAgIGJ1ZkJpdElkeCAtPSBrO1xuXG4gICAgICAgICAgICAvKiAzMiB0b28gbGFyZ2Ugb24gMzIgYml0IG1hY2hpbmVzICovXG5cbiAgICAgICAgICAgIGJ1ZltidWZCeXRlSWR4XSB8PSAoKHZhbCA+PiBqKSA8PCBidWZCaXRJZHgpO1xuICAgICAgICAgICAgdG90Yml0ICs9IGs7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiB3cml0ZSBqIGJpdHMgaW50byB0aGUgYml0IHN0cmVhbSwgaWdub3JpbmcgZnJhbWUgaGVhZGVyc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIHB1dGJpdHNfbm9oZWFkZXJzKGdmYywgdmFsLCBqKSB7XG5cbiAgICAgICAgd2hpbGUgKGogPiAwKSB7XG4gICAgICAgICAgICB2YXIgaztcbiAgICAgICAgICAgIGlmIChidWZCaXRJZHggPT0gMCkge1xuICAgICAgICAgICAgICAgIGJ1ZkJpdElkeCA9IDg7XG4gICAgICAgICAgICAgICAgYnVmQnl0ZUlkeCsrO1xuICAgICAgICAgICAgICAgIGJ1ZltidWZCeXRlSWR4XSA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGsgPSBNYXRoLm1pbihqLCBidWZCaXRJZHgpO1xuICAgICAgICAgICAgaiAtPSBrO1xuXG4gICAgICAgICAgICBidWZCaXRJZHggLT0gaztcblxuICAgICAgICAgICAgLyogMzIgdG9vIGxhcmdlIG9uIDMyIGJpdCBtYWNoaW5lcyAqL1xuXG4gICAgICAgICAgICBidWZbYnVmQnl0ZUlkeF0gfD0gKCh2YWwgPj4gaikgPDwgYnVmQml0SWR4KTtcbiAgICAgICAgICAgIHRvdGJpdCArPSBrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU29tZSBjb21iaW5hdGlvbnMgb2YgYml0cmF0ZSwgRnMsIGFuZCBzdGVyZW8gbWFrZSBpdCBpbXBvc3NpYmxlIHRvIHN0dWZmXG4gICAgICogb3V0IGEgZnJhbWUgdXNpbmcganVzdCBtYWluX2RhdGEsIGR1ZSB0byB0aGUgbGltaXRlZCBudW1iZXIgb2YgYml0cyB0b1xuICAgICAqIGluZGljYXRlIG1haW5fZGF0YV9sZW5ndGguIEluIHRoZXNlIHNpdHVhdGlvbnMsIHdlIHB1dCBzdHVmZmluZyBiaXRzIGludG9cbiAgICAgKiB0aGUgYW5jaWxsYXJ5IGRhdGEuLi5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBkcmFpbl9pbnRvX2FuY2lsbGFyeShnZnAsIHJlbWFpbmluZ0JpdHMpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGk7XG5cbiAgICAgICAgaWYgKHJlbWFpbmluZ0JpdHMgPj0gOCkge1xuICAgICAgICAgICAgcHV0Yml0czIoZ2ZjLCAweDRjLCA4KTtcbiAgICAgICAgICAgIHJlbWFpbmluZ0JpdHMgLT0gODtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVtYWluaW5nQml0cyA+PSA4KSB7XG4gICAgICAgICAgICBwdXRiaXRzMihnZmMsIDB4NDEsIDgpO1xuICAgICAgICAgICAgcmVtYWluaW5nQml0cyAtPSA4O1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZW1haW5pbmdCaXRzID49IDgpIHtcbiAgICAgICAgICAgIHB1dGJpdHMyKGdmYywgMHg0ZCwgOCk7XG4gICAgICAgICAgICByZW1haW5pbmdCaXRzIC09IDg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlbWFpbmluZ0JpdHMgPj0gOCkge1xuICAgICAgICAgICAgcHV0Yml0czIoZ2ZjLCAweDQ1LCA4KTtcbiAgICAgICAgICAgIHJlbWFpbmluZ0JpdHMgLT0gODtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChyZW1haW5pbmdCaXRzID49IDMyKSB7XG4gICAgICAgICAgICB2YXIgdmVyc2lvbiA9IHZlci5nZXRMYW1lU2hvcnRWZXJzaW9uKCk7XG4gICAgICAgICAgICBpZiAocmVtYWluaW5nQml0cyA+PSAzMilcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdmVyc2lvbi5sZW5ndGggJiYgcmVtYWluaW5nQml0cyA+PSA4OyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVtYWluaW5nQml0cyAtPSA4O1xuICAgICAgICAgICAgICAgICAgICBwdXRiaXRzMihnZmMsIHZlcnNpb24uY2hhckNvZGVBdChpKSwgOCk7IC8vZml4IOmUmeivr+eahOS9v+eUqGNoYXJBdFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoOyByZW1haW5pbmdCaXRzID49IDE7IHJlbWFpbmluZ0JpdHMgLT0gMSkge1xuICAgICAgICAgICAgcHV0Yml0czIoZ2ZjLCBnZmMuYW5jaWxsYXJ5X2ZsYWcsIDEpO1xuICAgICAgICAgICAgZ2ZjLmFuY2lsbGFyeV9mbGFnIF49ICghZ2ZwLmRpc2FibGVfcmVzZXJ2b2lyID8gMSA6IDApO1xuICAgICAgICB9XG5cblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHdyaXRlIE4gYml0cyBpbnRvIHRoZSBoZWFkZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB3cml0ZWhlYWRlcihnZmMsIHZhbCwgaikge1xuICAgICAgICB2YXIgcHRyID0gZ2ZjLmhlYWRlcltnZmMuaF9wdHJdLnB0cjtcblxuICAgICAgICB3aGlsZSAoaiA+IDApIHtcbiAgICAgICAgICAgIHZhciBrID0gTWF0aC5taW4oaiwgOCAtIChwdHIgJiA3KSk7XG4gICAgICAgICAgICBqIC09IGs7XG4gICAgICAgICAgICAvKiA+PiAzMiB0b28gbGFyZ2UgZm9yIDMyIGJpdCBtYWNoaW5lcyAqL1xuXG4gICAgICAgICAgICBnZmMuaGVhZGVyW2dmYy5oX3B0cl0uYnVmW3B0ciA+PiAzXSB8PSAoKHZhbCA+PiBqKSkgPDwgKDggLSAocHRyICYgNykgLSBrKTtcbiAgICAgICAgICAgIHB0ciArPSBrO1xuICAgICAgICB9XG4gICAgICAgIGdmYy5oZWFkZXJbZ2ZjLmhfcHRyXS5wdHIgPSBwdHI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gQ1JDX3VwZGF0ZSh2YWx1ZSwgY3JjKSB7XG4gICAgICAgIHZhbHVlIDw8PSA4O1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDg7IGkrKykge1xuICAgICAgICAgICAgdmFsdWUgPDw9IDE7XG4gICAgICAgICAgICBjcmMgPDw9IDE7XG5cbiAgICAgICAgICAgIGlmICgoKChjcmMgXiB2YWx1ZSkgJiAweDEwMDAwKSAhPSAwKSlcbiAgICAgICAgICAgICAgICBjcmMgXj0gQ1JDMTZfUE9MWU5PTUlBTDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3JjO1xuICAgIH1cblxuICAgIHRoaXMuQ1JDX3dyaXRlaGVhZGVyID0gZnVuY3Rpb24gKGdmYywgaGVhZGVyKSB7XG4gICAgICAgIHZhciBjcmMgPSAweGZmZmY7XG4gICAgICAgIC8qIChqbykgaW5pdCBjcmMxNiBmb3IgZXJyb3JfcHJvdGVjdGlvbiAqL1xuXG4gICAgICAgIGNyYyA9IENSQ191cGRhdGUoaGVhZGVyWzJdICYgMHhmZiwgY3JjKTtcbiAgICAgICAgY3JjID0gQ1JDX3VwZGF0ZShoZWFkZXJbM10gJiAweGZmLCBjcmMpO1xuICAgICAgICBmb3IgKHZhciBpID0gNjsgaSA8IGdmYy5zaWRlaW5mb19sZW47IGkrKykge1xuICAgICAgICAgICAgY3JjID0gQ1JDX3VwZGF0ZShoZWFkZXJbaV0gJiAweGZmLCBjcmMpO1xuICAgICAgICB9XG5cbiAgICAgICAgaGVhZGVyWzRdID0gKGJ5dGUpKGNyYyA+PiA4KTtcbiAgICAgICAgaGVhZGVyWzVdID0gKGJ5dGUpKGNyYyAmIDI1NSk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGVuY29kZVNpZGVJbmZvMihnZnAsIGJpdHNQZXJGcmFtZSkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgbDNfc2lkZTtcbiAgICAgICAgdmFyIGdyLCBjaDtcblxuICAgICAgICBsM19zaWRlID0gZ2ZjLmwzX3NpZGU7XG4gICAgICAgIGdmYy5oZWFkZXJbZ2ZjLmhfcHRyXS5wdHIgPSAwO1xuICAgICAgICBBcnJheXMuZmlsbChnZmMuaGVhZGVyW2dmYy5oX3B0cl0uYnVmLCAwLCBnZmMuc2lkZWluZm9fbGVuLCAwKTtcbiAgICAgICAgaWYgKGdmcC5vdXRfc2FtcGxlcmF0ZSA8IDE2MDAwKVxuICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAweGZmZSwgMTIpO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIDB4ZmZmLCAxMik7XG4gICAgICAgIHdyaXRlaGVhZGVyKGdmYywgKGdmcC52ZXJzaW9uKSwgMSk7XG4gICAgICAgIHdyaXRlaGVhZGVyKGdmYywgNCAtIDMsIDIpO1xuICAgICAgICB3cml0ZWhlYWRlcihnZmMsICghZ2ZwLmVycm9yX3Byb3RlY3Rpb24gPyAxIDogMCksIDEpO1xuICAgICAgICB3cml0ZWhlYWRlcihnZmMsIChnZmMuYml0cmF0ZV9pbmRleCksIDQpO1xuICAgICAgICB3cml0ZWhlYWRlcihnZmMsIChnZmMuc2FtcGxlcmF0ZV9pbmRleCksIDIpO1xuICAgICAgICB3cml0ZWhlYWRlcihnZmMsIChnZmMucGFkZGluZyksIDEpO1xuICAgICAgICB3cml0ZWhlYWRlcihnZmMsIChnZnAuZXh0ZW5zaW9uKSwgMSk7XG4gICAgICAgIHdyaXRlaGVhZGVyKGdmYywgKGdmcC5tb2RlLm9yZGluYWwoKSksIDIpO1xuICAgICAgICB3cml0ZWhlYWRlcihnZmMsIChnZmMubW9kZV9leHQpLCAyKTtcbiAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAoZ2ZwLmNvcHlyaWdodCksIDEpO1xuICAgICAgICB3cml0ZWhlYWRlcihnZmMsIChnZnAub3JpZ2luYWwpLCAxKTtcbiAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAoZ2ZwLmVtcGhhc2lzKSwgMik7XG4gICAgICAgIGlmIChnZnAuZXJyb3JfcHJvdGVjdGlvbikge1xuICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAwLCAxNik7XG4gICAgICAgICAgICAvKiBkdW1teSAqL1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGdmcC52ZXJzaW9uID09IDEpIHtcbiAgICAgICAgICAgIC8qIE1QRUcxICovXG4gICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIChsM19zaWRlLm1haW5fZGF0YV9iZWdpbiksIDkpO1xuXG4gICAgICAgICAgICBpZiAoZ2ZjLmNoYW5uZWxzX291dCA9PSAyKVxuICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgbDNfc2lkZS5wcml2YXRlX2JpdHMsIDMpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgbDNfc2lkZS5wcml2YXRlX2JpdHMsIDUpO1xuXG4gICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJhbmQ7XG4gICAgICAgICAgICAgICAgZm9yIChiYW5kID0gMDsgYmFuZCA8IDQ7IGJhbmQrKykge1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGwzX3NpZGUuc2Nmc2lbY2hdW2JhbmRdLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAoZ3IgPSAwOyBnciA8IDI7IGdyKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBnaSA9IGwzX3NpZGUudHRbZ3JdW2NoXTtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5wYXJ0Ml8zX2xlbmd0aCArIGdpLnBhcnQyX2xlbmd0aCwgMTIpO1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLmJpZ192YWx1ZXMgLyAyLCA5KTtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5nbG9iYWxfZ2FpbiwgOCk7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuc2NhbGVmYWNfY29tcHJlc3MsIDQpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChnaS5ibG9ja190eXBlICE9IEVuY29kZXIuTk9STV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIDEsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogd2luZG93X3N3aXRjaGluZ19mbGFnICovXG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLmJsb2NrX3R5cGUsIDIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5taXhlZF9ibG9ja19mbGFnLCAxKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdpLnRhYmxlX3NlbGVjdFswXSA9PSAxNClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnaS50YWJsZV9zZWxlY3RbMF0gPSAxNjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kudGFibGVfc2VsZWN0WzBdLCA1KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnaS50YWJsZV9zZWxlY3RbMV0gPT0gMTQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2kudGFibGVfc2VsZWN0WzFdID0gMTY7XG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnRhYmxlX3NlbGVjdFsxXSwgNSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuc3ViYmxvY2tfZ2FpblswXSwgMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnN1YmJsb2NrX2dhaW5bMV0sIDMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5zdWJibG9ja19nYWluWzJdLCAzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgMCwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKiB3aW5kb3dfc3dpdGNoaW5nX2ZsYWcgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnaS50YWJsZV9zZWxlY3RbMF0gPT0gMTQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2kudGFibGVfc2VsZWN0WzBdID0gMTY7XG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnRhYmxlX3NlbGVjdFswXSwgNSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2kudGFibGVfc2VsZWN0WzFdID09IDE0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdpLnRhYmxlX3NlbGVjdFsxXSA9IDE2O1xuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS50YWJsZV9zZWxlY3RbMV0sIDUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdpLnRhYmxlX3NlbGVjdFsyXSA9PSAxNClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnaS50YWJsZV9zZWxlY3RbMl0gPSAxNjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kudGFibGVfc2VsZWN0WzJdLCA1KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5yZWdpb24wX2NvdW50LCA0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kucmVnaW9uMV9jb3VudCwgMyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5wcmVmbGFnLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5zY2FsZWZhY19zY2FsZSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuY291bnQxdGFibGVfc2VsZWN0LCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvKiBNUEVHMiAqL1xuICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAobDNfc2lkZS5tYWluX2RhdGFfYmVnaW4pLCA4KTtcbiAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgbDNfc2lkZS5wcml2YXRlX2JpdHMsIGdmYy5jaGFubmVsc19vdXQpO1xuXG4gICAgICAgICAgICBnciA9IDA7XG4gICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGdpID0gbDNfc2lkZS50dFtncl1bY2hdO1xuICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kucGFydDJfM19sZW5ndGggKyBnaS5wYXJ0Ml9sZW5ndGgsIDEyKTtcbiAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLmJpZ192YWx1ZXMgLyAyLCA5KTtcbiAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLmdsb2JhbF9nYWluLCA4KTtcbiAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnNjYWxlZmFjX2NvbXByZXNzLCA5KTtcblxuICAgICAgICAgICAgICAgIGlmIChnaS5ibG9ja190eXBlICE9IEVuY29kZXIuTk9STV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgMSwgMSk7XG4gICAgICAgICAgICAgICAgICAgIC8qIHdpbmRvd19zd2l0Y2hpbmdfZmxhZyAqL1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLmJsb2NrX3R5cGUsIDIpO1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLm1peGVkX2Jsb2NrX2ZsYWcsIDEpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChnaS50YWJsZV9zZWxlY3RbMF0gPT0gMTQpXG4gICAgICAgICAgICAgICAgICAgICAgICBnaS50YWJsZV9zZWxlY3RbMF0gPSAxNjtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS50YWJsZV9zZWxlY3RbMF0sIDUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2kudGFibGVfc2VsZWN0WzFdID09IDE0KVxuICAgICAgICAgICAgICAgICAgICAgICAgZ2kudGFibGVfc2VsZWN0WzFdID0gMTY7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kudGFibGVfc2VsZWN0WzFdLCA1KTtcblxuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnN1YmJsb2NrX2dhaW5bMF0sIDMpO1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnN1YmJsb2NrX2dhaW5bMV0sIDMpO1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnN1YmJsb2NrX2dhaW5bMl0sIDMpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgMCwgMSk7XG4gICAgICAgICAgICAgICAgICAgIC8qIHdpbmRvd19zd2l0Y2hpbmdfZmxhZyAqL1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2kudGFibGVfc2VsZWN0WzBdID09IDE0KVxuICAgICAgICAgICAgICAgICAgICAgICAgZ2kudGFibGVfc2VsZWN0WzBdID0gMTY7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kudGFibGVfc2VsZWN0WzBdLCA1KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdpLnRhYmxlX3NlbGVjdFsxXSA9PSAxNClcbiAgICAgICAgICAgICAgICAgICAgICAgIGdpLnRhYmxlX3NlbGVjdFsxXSA9IDE2O1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnRhYmxlX3NlbGVjdFsxXSwgNSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChnaS50YWJsZV9zZWxlY3RbMl0gPT0gMTQpXG4gICAgICAgICAgICAgICAgICAgICAgICBnaS50YWJsZV9zZWxlY3RbMl0gPSAxNjtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS50YWJsZV9zZWxlY3RbMl0sIDUpO1xuXG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kucmVnaW9uMF9jb3VudCwgNCk7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kucmVnaW9uMV9jb3VudCwgMyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5zY2FsZWZhY19zY2FsZSwgMSk7XG4gICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5jb3VudDF0YWJsZV9zZWxlY3QsIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGdmcC5lcnJvcl9wcm90ZWN0aW9uKSB7XG4gICAgICAgICAgICAvKiAoam8pIGVycm9yX3Byb3RlY3Rpb246IGFkZCBjcmMxNiBpbmZvcm1hdGlvbiB0byBoZWFkZXIgKi9cbiAgICAgICAgICAgIENSQ193cml0ZWhlYWRlcihnZmMsIGdmYy5oZWFkZXJbZ2ZjLmhfcHRyXS5idWYpO1xuICAgICAgICB9XG5cbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIG9sZCA9IGdmYy5oX3B0cjtcblxuICAgICAgICAgICAgZ2ZjLmhfcHRyID0gKG9sZCArIDEpICYgKExhbWVJbnRlcm5hbEZsYWdzLk1BWF9IRUFERVJfQlVGIC0gMSk7XG4gICAgICAgICAgICBnZmMuaGVhZGVyW2dmYy5oX3B0cl0ud3JpdGVfdGltaW5nID0gZ2ZjLmhlYWRlcltvbGRdLndyaXRlX3RpbWluZ1xuICAgICAgICAgICAgICAgICsgYml0c1BlckZyYW1lO1xuXG4gICAgICAgICAgICBpZiAoZ2ZjLmhfcHRyID09IGdmYy53X3B0cikge1xuICAgICAgICAgICAgICAgIC8qIHlpa2VzISB3ZSBhcmUgb3V0IG9mIGhlYWRlciBidWZmZXIgc3BhY2UgKi9cbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyXG4gICAgICAgICAgICAgICAgICAgIC5wcmludGxuKFwiRXJyb3I6IE1BWF9IRUFERVJfQlVGIHRvbyBzbWFsbCBpbiBiaXRzdHJlYW0uYyBcXG5cIik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGh1ZmZtYW5fY29kZXJfY291bnQxKGdmYywgZ2kpIHtcbiAgICAgICAgLyogV3JpdGUgY291bnQxIGFyZWEgKi9cbiAgICAgICAgdmFyIGggPSBUYWJsZXMuaHRbZ2kuY291bnQxdGFibGVfc2VsZWN0ICsgMzJdO1xuICAgICAgICB2YXIgaSwgYml0cyA9IDA7XG5cbiAgICAgICAgdmFyIGl4ID0gZ2kuYmlnX3ZhbHVlcztcbiAgICAgICAgdmFyIHhyID0gZ2kuYmlnX3ZhbHVlcztcblxuICAgICAgICBmb3IgKGkgPSAoZ2kuY291bnQxIC0gZ2kuYmlnX3ZhbHVlcykgLyA0OyBpID4gMDsgLS1pKSB7XG4gICAgICAgICAgICB2YXIgaHVmZmJpdHMgPSAwO1xuICAgICAgICAgICAgdmFyIHAgPSAwLCB2O1xuXG4gICAgICAgICAgICB2ID0gZ2kubDNfZW5jW2l4ICsgMF07XG4gICAgICAgICAgICBpZiAodiAhPSAwKSB7XG4gICAgICAgICAgICAgICAgcCArPSA4O1xuICAgICAgICAgICAgICAgIGlmIChnaS54clt4ciArIDBdIDwgMClcbiAgICAgICAgICAgICAgICAgICAgaHVmZmJpdHMrKztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdiA9IGdpLmwzX2VuY1tpeCArIDFdO1xuICAgICAgICAgICAgaWYgKHYgIT0gMCkge1xuICAgICAgICAgICAgICAgIHAgKz0gNDtcbiAgICAgICAgICAgICAgICBodWZmYml0cyAqPSAyO1xuICAgICAgICAgICAgICAgIGlmIChnaS54clt4ciArIDFdIDwgMClcbiAgICAgICAgICAgICAgICAgICAgaHVmZmJpdHMrKztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdiA9IGdpLmwzX2VuY1tpeCArIDJdO1xuICAgICAgICAgICAgaWYgKHYgIT0gMCkge1xuICAgICAgICAgICAgICAgIHAgKz0gMjtcbiAgICAgICAgICAgICAgICBodWZmYml0cyAqPSAyO1xuICAgICAgICAgICAgICAgIGlmIChnaS54clt4ciArIDJdIDwgMClcbiAgICAgICAgICAgICAgICAgICAgaHVmZmJpdHMrKztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdiA9IGdpLmwzX2VuY1tpeCArIDNdO1xuICAgICAgICAgICAgaWYgKHYgIT0gMCkge1xuICAgICAgICAgICAgICAgIHArKztcbiAgICAgICAgICAgICAgICBodWZmYml0cyAqPSAyO1xuICAgICAgICAgICAgICAgIGlmIChnaS54clt4ciArIDNdIDwgMClcbiAgICAgICAgICAgICAgICAgICAgaHVmZmJpdHMrKztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaXggKz0gNDtcbiAgICAgICAgICAgIHhyICs9IDQ7XG4gICAgICAgICAgICBwdXRiaXRzMihnZmMsIGh1ZmZiaXRzICsgaC50YWJsZVtwXSwgaC5obGVuW3BdKTtcbiAgICAgICAgICAgIGJpdHMgKz0gaC5obGVuW3BdO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBiaXRzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEltcGxlbWVudHMgdGhlIHBzZXVkb2NvZGUgb2YgcGFnZSA5OCBvZiB0aGUgSVNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBIdWZmbWFuY29kZShnZmMsIHRhYmxlaW5kZXgsIHN0YXJ0LCBlbmQsIGdpKSB7XG4gICAgICAgIHZhciBoID0gVGFibGVzLmh0W3RhYmxlaW5kZXhdO1xuICAgICAgICB2YXIgYml0cyA9IDA7XG5cbiAgICAgICAgaWYgKDAgPT0gdGFibGVpbmRleClcbiAgICAgICAgICAgIHJldHVybiBiaXRzO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgaSArPSAyKSB7XG4gICAgICAgICAgICB2YXIgY2JpdHMgPSAwO1xuICAgICAgICAgICAgdmFyIHhiaXRzID0gMDtcbiAgICAgICAgICAgIHZhciBsaW5iaXRzID0gaC54bGVuO1xuICAgICAgICAgICAgdmFyIHhsZW4gPSBoLnhsZW47XG4gICAgICAgICAgICB2YXIgZXh0ID0gMDtcbiAgICAgICAgICAgIHZhciB4MSA9IGdpLmwzX2VuY1tpXTtcbiAgICAgICAgICAgIHZhciB4MiA9IGdpLmwzX2VuY1tpICsgMV07XG5cbiAgICAgICAgICAgIGlmICh4MSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKGdpLnhyW2ldIDwgMClcbiAgICAgICAgICAgICAgICAgICAgZXh0Kys7XG4gICAgICAgICAgICAgICAgY2JpdHMtLTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRhYmxlaW5kZXggPiAxNSkge1xuICAgICAgICAgICAgICAgIC8qIHVzZSBFU0Mtd29yZHMgKi9cbiAgICAgICAgICAgICAgICBpZiAoeDEgPiAxNCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGluYml0c194MSA9IHgxIC0gMTU7XG4gICAgICAgICAgICAgICAgICAgIGV4dCB8PSBsaW5iaXRzX3gxIDw8IDE7XG4gICAgICAgICAgICAgICAgICAgIHhiaXRzID0gbGluYml0cztcbiAgICAgICAgICAgICAgICAgICAgeDEgPSAxNTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoeDIgPiAxNCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGluYml0c194MiA9IHgyIC0gMTU7XG4gICAgICAgICAgICAgICAgICAgIGV4dCA8PD0gbGluYml0cztcbiAgICAgICAgICAgICAgICAgICAgZXh0IHw9IGxpbmJpdHNfeDI7XG4gICAgICAgICAgICAgICAgICAgIHhiaXRzICs9IGxpbmJpdHM7XG4gICAgICAgICAgICAgICAgICAgIHgyID0gMTU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHhsZW4gPSAxNjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHgyICE9IDApIHtcbiAgICAgICAgICAgICAgICBleHQgPDw9IDE7XG4gICAgICAgICAgICAgICAgaWYgKGdpLnhyW2kgKyAxXSA8IDApXG4gICAgICAgICAgICAgICAgICAgIGV4dCsrO1xuICAgICAgICAgICAgICAgIGNiaXRzLS07XG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgeDEgPSB4MSAqIHhsZW4gKyB4MjtcbiAgICAgICAgICAgIHhiaXRzIC09IGNiaXRzO1xuICAgICAgICAgICAgY2JpdHMgKz0gaC5obGVuW3gxXTtcblxuXG4gICAgICAgICAgICBwdXRiaXRzMihnZmMsIGgudGFibGVbeDFdLCBjYml0cyk7XG4gICAgICAgICAgICBwdXRiaXRzMihnZmMsIGV4dCwgeGJpdHMpO1xuICAgICAgICAgICAgYml0cyArPSBjYml0cyArIHhiaXRzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBiaXRzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE5vdGUgdGhlIGRpc2N1c3Npb24gb2YgaHVmZm1hbmNvZGViaXRzKCkgb24gcGFnZXMgMjggYW5kIDI5IG9mIHRoZSBJUywgYXNcbiAgICAgKiB3ZWxsIGFzIHRoZSBkZWZpbml0aW9ucyBvZiB0aGUgc2lkZSBpbmZvcm1hdGlvbiBvbiBwYWdlcyAyNiBhbmQgMjcuXG4gICAgICovXG4gICAgZnVuY3Rpb24gU2hvcnRIdWZmbWFuY29kZWJpdHMoZ2ZjLCBnaSkge1xuICAgICAgICB2YXIgcmVnaW9uMVN0YXJ0ID0gMyAqIGdmYy5zY2FsZWZhY19iYW5kLnNbM107XG4gICAgICAgIGlmIChyZWdpb24xU3RhcnQgPiBnaS5iaWdfdmFsdWVzKVxuICAgICAgICAgICAgcmVnaW9uMVN0YXJ0ID0gZ2kuYmlnX3ZhbHVlcztcblxuICAgICAgICAvKiBzaG9ydCBibG9ja3MgZG8gbm90IGhhdmUgYSByZWdpb24yICovXG4gICAgICAgIHZhciBiaXRzID0gSHVmZm1hbmNvZGUoZ2ZjLCBnaS50YWJsZV9zZWxlY3RbMF0sIDAsIHJlZ2lvbjFTdGFydCwgZ2kpO1xuICAgICAgICBiaXRzICs9IEh1ZmZtYW5jb2RlKGdmYywgZ2kudGFibGVfc2VsZWN0WzFdLCByZWdpb24xU3RhcnQsXG4gICAgICAgICAgICBnaS5iaWdfdmFsdWVzLCBnaSk7XG4gICAgICAgIHJldHVybiBiaXRzO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIExvbmdIdWZmbWFuY29kZWJpdHMoZ2ZjLCBnaSkge1xuICAgICAgICB2YXIgYmlndmFsdWVzLCBiaXRzO1xuICAgICAgICB2YXIgcmVnaW9uMVN0YXJ0LCByZWdpb24yU3RhcnQ7XG5cbiAgICAgICAgYmlndmFsdWVzID0gZ2kuYmlnX3ZhbHVlcztcblxuICAgICAgICB2YXIgaSA9IGdpLnJlZ2lvbjBfY291bnQgKyAxO1xuICAgICAgICByZWdpb24xU3RhcnQgPSBnZmMuc2NhbGVmYWNfYmFuZC5sW2ldO1xuICAgICAgICBpICs9IGdpLnJlZ2lvbjFfY291bnQgKyAxO1xuICAgICAgICByZWdpb24yU3RhcnQgPSBnZmMuc2NhbGVmYWNfYmFuZC5sW2ldO1xuXG4gICAgICAgIGlmIChyZWdpb24xU3RhcnQgPiBiaWd2YWx1ZXMpXG4gICAgICAgICAgICByZWdpb24xU3RhcnQgPSBiaWd2YWx1ZXM7XG5cbiAgICAgICAgaWYgKHJlZ2lvbjJTdGFydCA+IGJpZ3ZhbHVlcylcbiAgICAgICAgICAgIHJlZ2lvbjJTdGFydCA9IGJpZ3ZhbHVlcztcblxuICAgICAgICBiaXRzID0gSHVmZm1hbmNvZGUoZ2ZjLCBnaS50YWJsZV9zZWxlY3RbMF0sIDAsIHJlZ2lvbjFTdGFydCwgZ2kpO1xuICAgICAgICBiaXRzICs9IEh1ZmZtYW5jb2RlKGdmYywgZ2kudGFibGVfc2VsZWN0WzFdLCByZWdpb24xU3RhcnQsXG4gICAgICAgICAgICByZWdpb24yU3RhcnQsIGdpKTtcbiAgICAgICAgYml0cyArPSBIdWZmbWFuY29kZShnZmMsIGdpLnRhYmxlX3NlbGVjdFsyXSwgcmVnaW9uMlN0YXJ0LCBiaWd2YWx1ZXMsXG4gICAgICAgICAgICBnaSk7XG4gICAgICAgIHJldHVybiBiaXRzO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHdyaXRlTWFpbkRhdGEoZ2ZwKSB7XG4gICAgICAgIHZhciBnciwgY2gsIHNmYiwgZGF0YV9iaXRzLCB0b3RfYml0cyA9IDA7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBsM19zaWRlID0gZ2ZjLmwzX3NpZGU7XG5cbiAgICAgICAgaWYgKGdmcC52ZXJzaW9uID09IDEpIHtcbiAgICAgICAgICAgIC8qIE1QRUcgMSAqL1xuICAgICAgICAgICAgZm9yIChnciA9IDA7IGdyIDwgMjsgZ3IrKykge1xuICAgICAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdpID0gbDNfc2lkZS50dFtncl1bY2hdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2xlbjEgPSBUYWtlaGlyby5zbGVuMV90YWJbZ2kuc2NhbGVmYWNfY29tcHJlc3NdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2xlbjIgPSBUYWtlaGlyby5zbGVuMl90YWJbZ2kuc2NhbGVmYWNfY29tcHJlc3NdO1xuICAgICAgICAgICAgICAgICAgICBkYXRhX2JpdHMgPSAwO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHNmYiA9IDA7IHNmYiA8IGdpLnNmYmRpdmlkZTsgc2ZiKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnaS5zY2FsZWZhY1tzZmJdID09IC0xKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogc2Nmc2kgaXMgdXNlZCAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgcHV0Yml0czIoZ2ZjLCBnaS5zY2FsZWZhY1tzZmJdLCBzbGVuMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhX2JpdHMgKz0gc2xlbjE7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZm9yICg7IHNmYiA8IGdpLnNmYm1heDsgc2ZiKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnaS5zY2FsZWZhY1tzZmJdID09IC0xKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogc2Nmc2kgaXMgdXNlZCAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgcHV0Yml0czIoZ2ZjLCBnaS5zY2FsZWZhY1tzZmJdLCBzbGVuMik7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhX2JpdHMgKz0gc2xlbjI7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoZ2kuYmxvY2tfdHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFfYml0cyArPSBTaG9ydEh1ZmZtYW5jb2RlYml0cyhnZmMsIGdpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFfYml0cyArPSBMb25nSHVmZm1hbmNvZGViaXRzKGdmYywgZ2kpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRhdGFfYml0cyArPSBodWZmbWFuX2NvZGVyX2NvdW50MShnZmMsIGdpKTtcbiAgICAgICAgICAgICAgICAgICAgLyogZG9lcyBiaXRjb3VudCBpbiBxdWFudGl6ZS5jIGFncmVlIHdpdGggYWN0dWFsIGJpdCBjb3VudD8gKi9cbiAgICAgICAgICAgICAgICAgICAgdG90X2JpdHMgKz0gZGF0YV9iaXRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKiBmb3IgY2ggKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIGZvciBnciAqL1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLyogTVBFRyAyICovXG4gICAgICAgICAgICBnciA9IDA7XG4gICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGdpID0gbDNfc2lkZS50dFtncl1bY2hdO1xuICAgICAgICAgICAgICAgIHZhciBpLCBzZmJfcGFydGl0aW9uLCBzY2FsZV9iaXRzID0gMDtcbiAgICAgICAgICAgICAgICBkYXRhX2JpdHMgPSAwO1xuICAgICAgICAgICAgICAgIHNmYiA9IDA7XG4gICAgICAgICAgICAgICAgc2ZiX3BhcnRpdGlvbiA9IDA7XG5cbiAgICAgICAgICAgICAgICBpZiAoZ2kuYmxvY2tfdHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICg7IHNmYl9wYXJ0aXRpb24gPCA0OyBzZmJfcGFydGl0aW9uKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZmJzID0gZ2kuc2ZiX3BhcnRpdGlvbl90YWJsZVtzZmJfcGFydGl0aW9uXSAvIDM7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2xlbiA9IGdpLnNsZW5bc2ZiX3BhcnRpdGlvbl07XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2ZiczsgaSsrLCBzZmIrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1dGJpdHMyKGdmYyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5tYXgoZ2kuc2NhbGVmYWNbc2ZiICogMyArIDBdLCAwKSwgc2xlbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHV0Yml0czIoZ2ZjLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1heChnaS5zY2FsZWZhY1tzZmIgKiAzICsgMV0sIDApLCBzbGVuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdXRiaXRzMihnZmMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWF4KGdpLnNjYWxlZmFjW3NmYiAqIDMgKyAyXSwgMCksIHNsZW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlX2JpdHMgKz0gMyAqIHNsZW47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZGF0YV9iaXRzICs9IFNob3J0SHVmZm1hbmNvZGViaXRzKGdmYywgZ2kpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoOyBzZmJfcGFydGl0aW9uIDwgNDsgc2ZiX3BhcnRpdGlvbisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2ZicyA9IGdpLnNmYl9wYXJ0aXRpb25fdGFibGVbc2ZiX3BhcnRpdGlvbl07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2xlbiA9IGdpLnNsZW5bc2ZiX3BhcnRpdGlvbl07XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2ZiczsgaSsrLCBzZmIrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1dGJpdHMyKGdmYywgTWF0aC5tYXgoZ2kuc2NhbGVmYWNbc2ZiXSwgMCksIHNsZW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjYWxlX2JpdHMgKz0gc2xlbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkYXRhX2JpdHMgKz0gTG9uZ0h1ZmZtYW5jb2RlYml0cyhnZmMsIGdpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZGF0YV9iaXRzICs9IGh1ZmZtYW5fY29kZXJfY291bnQxKGdmYywgZ2kpO1xuICAgICAgICAgICAgICAgIC8qIGRvZXMgYml0Y291bnQgaW4gcXVhbnRpemUuYyBhZ3JlZSB3aXRoIGFjdHVhbCBiaXQgY291bnQ/ICovXG4gICAgICAgICAgICAgICAgdG90X2JpdHMgKz0gc2NhbGVfYml0cyArIGRhdGFfYml0cztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIGZvciBjaCAqL1xuICAgICAgICB9XG4gICAgICAgIC8qIGZvciBnZiAqL1xuICAgICAgICByZXR1cm4gdG90X2JpdHM7XG4gICAgfVxuXG4gICAgLyogbWFpbl9kYXRhICovXG5cbiAgICBmdW5jdGlvbiBUb3RhbEJ5dGVzKCkge1xuICAgICAgICB0aGlzLnRvdGFsID0gMDtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIGNvbXB1dGUgdGhlIG51bWJlciBvZiBiaXRzIHJlcXVpcmVkIHRvIGZsdXNoIGFsbCBtcDMgZnJhbWVzIGN1cnJlbnRseSBpblxuICAgICAqIHRoZSBidWZmZXIuIFRoaXMgc2hvdWxkIGJlIHRoZSBzYW1lIGFzIHRoZSByZXNlcnZvaXIgc2l6ZS4gT25seSBjYWxsIHRoaXNcbiAgICAgKiByb3V0aW5lIGJldHdlZW4gZnJhbWVzIC0gaS5lLiBvbmx5IGFmdGVyIGFsbCBoZWFkZXJzIGFuZCBkYXRhIGhhdmUgYmVlblxuICAgICAqIGFkZGVkIHRvIHRoZSBidWZmZXIgYnkgZm9ybWF0X2JpdHN0cmVhbSgpLlxuICAgICAqXG4gICAgICogQWxzbyBjb21wdXRlIHRvdGFsX2JpdHNfb3V0cHV0ID0gc2l6ZSBvZiBtcDMgYnVmZmVyIChpbmNsdWRpbmcgZnJhbWVcbiAgICAgKiBoZWFkZXJzIHdoaWNoIG1heSBub3QgaGF2ZSB5ZXQgYmVlbiBzZW5kIHRvIHRoZSBtcDMgYnVmZmVyKSArIG51bWJlciBvZlxuICAgICAqIGJpdHMgbmVlZGVkIHRvIGZsdXNoIGFsbCBtcDMgZnJhbWVzLlxuICAgICAqXG4gICAgICogdG90YWxfYnl0ZXNfb3V0cHV0IGlzIHRoZSBzaXplIG9mIHRoZSBtcDMgb3V0cHV0IGJ1ZmZlciBpZlxuICAgICAqIGxhbWVfZW5jb2RlX2ZsdXNoX25vZ2FwKCkgd2FzIGNhbGxlZCByaWdodCBub3cuXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29tcHV0ZV9mbHVzaGJpdHMoZ2ZwLCB0b3RhbF9ieXRlc19vdXRwdXQpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGZsdXNoYml0cywgcmVtYWluaW5nX2hlYWRlcnM7XG4gICAgICAgIHZhciBiaXRzUGVyRnJhbWU7XG4gICAgICAgIHZhciBsYXN0X3B0ciwgZmlyc3RfcHRyO1xuICAgICAgICBmaXJzdF9wdHIgPSBnZmMud19wdHI7XG4gICAgICAgIC8qIGZpcnN0IGhlYWRlciB0byBhZGQgdG8gYml0c3RyZWFtICovXG4gICAgICAgIGxhc3RfcHRyID0gZ2ZjLmhfcHRyIC0gMTtcbiAgICAgICAgLyogbGFzdCBoZWFkZXIgdG8gYWRkIHRvIGJpdHN0cmVhbSAqL1xuICAgICAgICBpZiAobGFzdF9wdHIgPT0gLTEpXG4gICAgICAgICAgICBsYXN0X3B0ciA9IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9IRUFERVJfQlVGIC0gMTtcblxuICAgICAgICAvKiBhZGQgdGhpcyBtYW55IGJpdHMgdG8gYml0c3RyZWFtIHNvIHdlIGNhbiBmbHVzaCBhbGwgaGVhZGVycyAqL1xuICAgICAgICBmbHVzaGJpdHMgPSBnZmMuaGVhZGVyW2xhc3RfcHRyXS53cml0ZV90aW1pbmcgLSB0b3RiaXQ7XG4gICAgICAgIHRvdGFsX2J5dGVzX291dHB1dC50b3RhbCA9IGZsdXNoYml0cztcblxuICAgICAgICBpZiAoZmx1c2hiaXRzID49IDApIHtcbiAgICAgICAgICAgIC8qIGlmIGZsdXNoYml0cyA+PSAwLCBzb21lIGhlYWRlcnMgaGF2ZSBub3QgeWV0IGJlZW4gd3JpdHRlbiAqL1xuICAgICAgICAgICAgLyogcmVkdWNlIGZsdXNoYml0cyBieSB0aGUgc2l6ZSBvZiB0aGUgaGVhZGVycyAqL1xuICAgICAgICAgICAgcmVtYWluaW5nX2hlYWRlcnMgPSAxICsgbGFzdF9wdHIgLSBmaXJzdF9wdHI7XG4gICAgICAgICAgICBpZiAobGFzdF9wdHIgPCBmaXJzdF9wdHIpXG4gICAgICAgICAgICAgICAgcmVtYWluaW5nX2hlYWRlcnMgPSAxICsgbGFzdF9wdHIgLSBmaXJzdF9wdHJcbiAgICAgICAgICAgICAgICAgICAgKyBMYW1lSW50ZXJuYWxGbGFncy5NQVhfSEVBREVSX0JVRjtcbiAgICAgICAgICAgIGZsdXNoYml0cyAtPSByZW1haW5pbmdfaGVhZGVycyAqIDggKiBnZmMuc2lkZWluZm9fbGVuO1xuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgICogZmluYWxseSwgYWRkIHNvbWUgYml0cyBzbyB0aGF0IHRoZSBsYXN0IGZyYW1lIGlzIGNvbXBsZXRlIHRoZXNlIGJpdHNcbiAgICAgICAgICogYXJlIG5vdCBuZWNlc3NhcnkgdG8gZGVjb2RlIHRoZSBsYXN0IGZyYW1lLCBidXQgc29tZSBkZWNvZGVycyB3aWxsXG4gICAgICAgICAqIGlnbm9yZSBsYXN0IGZyYW1lIGlmIHRoZXNlIGJpdHMgYXJlIG1pc3NpbmdcbiAgICAgICAgICovXG4gICAgICAgIGJpdHNQZXJGcmFtZSA9IHNlbGYuZ2V0ZnJhbWViaXRzKGdmcCk7XG4gICAgICAgIGZsdXNoYml0cyArPSBiaXRzUGVyRnJhbWU7XG4gICAgICAgIHRvdGFsX2J5dGVzX291dHB1dC50b3RhbCArPSBiaXRzUGVyRnJhbWU7XG4gICAgICAgIC8qIHJvdW5kIHVwOiAqL1xuICAgICAgICBpZiAoKHRvdGFsX2J5dGVzX291dHB1dC50b3RhbCAlIDgpICE9IDApXG4gICAgICAgICAgICB0b3RhbF9ieXRlc19vdXRwdXQudG90YWwgPSAxICsgKHRvdGFsX2J5dGVzX291dHB1dC50b3RhbCAvIDgpO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICB0b3RhbF9ieXRlc19vdXRwdXQudG90YWwgPSAodG90YWxfYnl0ZXNfb3V0cHV0LnRvdGFsIC8gOCk7XG4gICAgICAgIHRvdGFsX2J5dGVzX291dHB1dC50b3RhbCArPSBidWZCeXRlSWR4ICsgMTtcblxuICAgICAgICBpZiAoZmx1c2hiaXRzIDwgMCkge1xuICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwic3RyYW5nZSBlcnJvciBmbHVzaGluZyBidWZmZXIgLi4uIFxcblwiKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmx1c2hiaXRzO1xuICAgIH1cblxuICAgIHRoaXMuZmx1c2hfYml0c3RyZWFtID0gZnVuY3Rpb24gKGdmcCkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgbDNfc2lkZTtcbiAgICAgICAgdmFyIGZsdXNoYml0cztcbiAgICAgICAgdmFyIGxhc3RfcHRyID0gZ2ZjLmhfcHRyIC0gMTtcbiAgICAgICAgLyogbGFzdCBoZWFkZXIgdG8gYWRkIHRvIGJpdHN0cmVhbSAqL1xuICAgICAgICBpZiAobGFzdF9wdHIgPT0gLTEpXG4gICAgICAgICAgICBsYXN0X3B0ciA9IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9IRUFERVJfQlVGIC0gMTtcbiAgICAgICAgbDNfc2lkZSA9IGdmYy5sM19zaWRlO1xuXG4gICAgICAgIGlmICgoZmx1c2hiaXRzID0gY29tcHV0ZV9mbHVzaGJpdHMoZ2ZwLCBuZXcgVG90YWxCeXRlcygpKSkgPCAwKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBkcmFpbl9pbnRvX2FuY2lsbGFyeShnZnAsIGZsdXNoYml0cyk7XG5cbiAgICAgICAgLyogY2hlY2sgdGhhdCB0aGUgMTAwJSBvZiB0aGUgbGFzdCBmcmFtZSBoYXMgYmVlbiB3cml0dGVuIHRvIGJpdHN0cmVhbSAqL1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHdlIGhhdmUgcGFkZGVkIG91dCBhbGwgZnJhbWVzIHdpdGggYW5jaWxsYXJ5IGRhdGEsIHdoaWNoIGlzIHRoZSBzYW1lXG4gICAgICAgICAqIGFzIGZpbGxpbmcgdGhlIGJpdHJlc2Vydm9pciB3aXRoIGFuY2lsbGFyeSBkYXRhLCBzbyA6XG4gICAgICAgICAqL1xuICAgICAgICBnZmMuUmVzdlNpemUgPSAwO1xuICAgICAgICBsM19zaWRlLm1haW5fZGF0YV9iZWdpbiA9IDA7XG5cbiAgICAgICAgLyogc2F2ZSB0aGUgUmVwbGF5R2FpbiB2YWx1ZSAqL1xuICAgICAgICBpZiAoZ2ZjLmZpbmRSZXBsYXlHYWluKSB7XG4gICAgICAgICAgICB2YXIgUmFkaW9HYWluID0gZ2EuR2V0VGl0bGVHYWluKGdmYy5yZ2RhdGEpO1xuICAgICAgICAgICAgZ2ZjLlJhZGlvR2FpbiA9IE1hdGguZmxvb3IoUmFkaW9HYWluICogMTAuMCArIDAuNSkgfCAwO1xuICAgICAgICAgICAgLyogcm91bmQgdG8gbmVhcmVzdCAqL1xuICAgICAgICB9XG5cbiAgICAgICAgLyogZmluZCB0aGUgZ2FpbiBhbmQgc2NhbGUgY2hhbmdlIHJlcXVpcmVkIGZvciBubyBjbGlwcGluZyAqL1xuICAgICAgICBpZiAoZ2ZjLmZpbmRQZWFrU2FtcGxlKSB7XG4gICAgICAgICAgICBnZmMubm9jbGlwR2FpbkNoYW5nZSA9IE1hdGguY2VpbChcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGhfbG9nMTAoZ2ZjLlBlYWtTYW1wbGUgLyAzMjc2Ny4wKSAqIDIwLjAgKiAxMC4wKSB8IDA7XG4gICAgICAgICAgICAvKiByb3VuZCB1cCAqL1xuXG4gICAgICAgICAgICBpZiAoZ2ZjLm5vY2xpcEdhaW5DaGFuZ2UgPiAwKSB7XG4gICAgICAgICAgICAgICAgLyogY2xpcHBpbmcgb2NjdXJzICovXG4gICAgICAgICAgICAgICAgaWYgKEVRKGdmcC5zY2FsZSwgMS4wKSB8fCBFUShnZnAuc2NhbGUsIDAuMCkpXG4gICAgICAgICAgICAgICAgICAgIGdmYy5ub2NsaXBTY2FsZSA9IChNYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmxvb3IoKDMyNzY3LjAgLyBnZmMuUGVha1NhbXBsZSkgKiAxMDAuMCkgLyAxMDAuMCk7XG4gICAgICAgICAgICAgICAgLyogcm91bmQgZG93biAqL1xuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgKiB0aGUgdXNlciBzcGVjaWZpZWQgaGlzIG93biBzY2FsaW5nIGZhY3Rvci4gV2UgY291bGRcbiAgICAgICAgICAgICAgICAgICAgICogc3VnZ2VzdCB0aGUgc2NhbGluZyBmYWN0b3Igb2ZcbiAgICAgICAgICAgICAgICAgICAgICogKDMyNzY3LjAvZ2ZwLlBlYWtTYW1wbGUpKihnZnAuc2NhbGUpIGJ1dCBpdCdzIHVzdWFsbHlcbiAgICAgICAgICAgICAgICAgICAgICogdmVyeSBpbmFjY3VyYXRlLiBTbyB3ZSdkIHJhdGhlciBub3QgYWR2aWNlIGhpbSBvbiB0aGVcbiAgICAgICAgICAgICAgICAgICAgICogc2NhbGluZyBmYWN0b3IuXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICBnZmMubm9jbGlwU2NhbGUgPSAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgIC8qIG5vIGNsaXBwaW5nICovXG4gICAgICAgICAgICAgICAgZ2ZjLm5vY2xpcFNjYWxlID0gLTE7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdGhpcy5hZGRfZHVtbXlfYnl0ZSA9IGZ1bmN0aW9uIChnZnAsIHZhbCwgbikge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgaTtcblxuICAgICAgICB3aGlsZSAobi0tID4gMCkge1xuICAgICAgICAgICAgcHV0Yml0c19ub2hlYWRlcnMoZ2ZjLCB2YWwsIDgpO1xuXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgTGFtZUludGVybmFsRmxhZ3MuTUFYX0hFQURFUl9CVUY7ICsraSlcbiAgICAgICAgICAgICAgICBnZmMuaGVhZGVyW2ldLndyaXRlX3RpbWluZyArPSA4O1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgaXMgY2FsbGVkIGFmdGVyIGEgZnJhbWUgb2YgYXVkaW8gaGFzIGJlZW4gcXVhbnRpemVkIGFuZCBjb2RlZC4gSXRcbiAgICAgKiB3aWxsIHdyaXRlIHRoZSBlbmNvZGVkIGF1ZGlvIHRvIHRoZSBiaXRzdHJlYW0uIE5vdGUgdGhhdCBmcm9tIGEgbGF5ZXIzXG4gICAgICogZW5jb2RlcidzIHBlcnNwZWN0aXZlIHRoZSBiaXQgc3RyZWFtIGlzIHByaW1hcmlseSBhIHNlcmllcyBvZiBtYWluX2RhdGEoKVxuICAgICAqIGJsb2Nrcywgd2l0aCBoZWFkZXIgYW5kIHNpZGUgaW5mb3JtYXRpb24gaW5zZXJ0ZWQgYXQgdGhlIHByb3BlciBsb2NhdGlvbnNcbiAgICAgKiB0byBtYWludGFpbiBmcmFtaW5nLiAoU2VlIEZpZ3VyZSBBLjcgaW4gdGhlIElTKS5cbiAgICAgKi9cbiAgICB0aGlzLmZvcm1hdF9iaXRzdHJlYW0gPSBmdW5jdGlvbiAoZ2ZwKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBsM19zaWRlO1xuICAgICAgICBsM19zaWRlID0gZ2ZjLmwzX3NpZGU7XG5cbiAgICAgICAgdmFyIGJpdHNQZXJGcmFtZSA9IHRoaXMuZ2V0ZnJhbWViaXRzKGdmcCk7XG4gICAgICAgIGRyYWluX2ludG9fYW5jaWxsYXJ5KGdmcCwgbDNfc2lkZS5yZXN2RHJhaW5fcHJlKTtcblxuICAgICAgICBlbmNvZGVTaWRlSW5mbzIoZ2ZwLCBiaXRzUGVyRnJhbWUpO1xuICAgICAgICB2YXIgYml0cyA9IDggKiBnZmMuc2lkZWluZm9fbGVuO1xuICAgICAgICBiaXRzICs9IHdyaXRlTWFpbkRhdGEoZ2ZwKTtcbiAgICAgICAgZHJhaW5faW50b19hbmNpbGxhcnkoZ2ZwLCBsM19zaWRlLnJlc3ZEcmFpbl9wb3N0KTtcbiAgICAgICAgYml0cyArPSBsM19zaWRlLnJlc3ZEcmFpbl9wb3N0O1xuXG4gICAgICAgIGwzX3NpZGUubWFpbl9kYXRhX2JlZ2luICs9IChiaXRzUGVyRnJhbWUgLSBiaXRzKSAvIDg7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogY29tcGFyZSBudW1iZXIgb2YgYml0cyBuZWVkZWQgdG8gY2xlYXIgYWxsIGJ1ZmZlcmVkIG1wMyBmcmFtZXMgd2l0aFxuICAgICAgICAgKiB3aGF0IHdlIHRoaW5rIHRoZSByZXN2c2l6ZSBpczpcbiAgICAgICAgICovXG4gICAgICAgIGlmIChjb21wdXRlX2ZsdXNoYml0cyhnZnAsIG5ldyBUb3RhbEJ5dGVzKCkpICE9IGdmYy5SZXN2U2l6ZSkge1xuICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiSW50ZXJuYWwgYnVmZmVyIGluY29uc2lzdGVuY3kuIGZsdXNoYml0cyA8PiBSZXN2U2l6ZVwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGNvbXBhcmUgbWFpbl9kYXRhX2JlZ2luIGZvciB0aGUgbmV4dCBmcmFtZSB3aXRoIHdoYXQgd2UgdGhpbmsgdGhlXG4gICAgICAgICAqIHJlc3ZzaXplIGlzOlxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKChsM19zaWRlLm1haW5fZGF0YV9iZWdpbiAqIDgpICE9IGdmYy5SZXN2U2l6ZSkge1xuICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGYoXCJiaXQgcmVzZXJ2b2lyIGVycm9yOiBcXG5cIlxuICAgICAgICAgICAgICAgICsgXCJsM19zaWRlLm1haW5fZGF0YV9iZWdpbjogJWQgXFxuXCJcbiAgICAgICAgICAgICAgICArIFwiUmVzdm9pciBzaXplOiAgICAgICAgICAgICAlZCBcXG5cIlxuICAgICAgICAgICAgICAgICsgXCJyZXN2IGRyYWluIChwb3N0KSAgICAgICAgICVkIFxcblwiXG4gICAgICAgICAgICAgICAgKyBcInJlc3YgZHJhaW4gKHByZSkgICAgICAgICAgJWQgXFxuXCJcbiAgICAgICAgICAgICAgICArIFwiaGVhZGVyIGFuZCBzaWRlaW5mbzogICAgICAlZCBcXG5cIlxuICAgICAgICAgICAgICAgICsgXCJkYXRhIGJpdHM6ICAgICAgICAgICAgICAgICVkIFxcblwiXG4gICAgICAgICAgICAgICAgKyBcInRvdGFsIGJpdHM6ICAgICAgICAgICAgICAgJWQgKHJlbWFpbmRlcjogJWQpIFxcblwiXG4gICAgICAgICAgICAgICAgKyBcImJpdHNwZXJmcmFtZTogICAgICAgICAgICAgJWQgXFxuXCIsXG4gICAgICAgICAgICAgICAgOCAqIGwzX3NpZGUubWFpbl9kYXRhX2JlZ2luLCBnZmMuUmVzdlNpemUsXG4gICAgICAgICAgICAgICAgbDNfc2lkZS5yZXN2RHJhaW5fcG9zdCwgbDNfc2lkZS5yZXN2RHJhaW5fcHJlLFxuICAgICAgICAgICAgICAgIDggKiBnZmMuc2lkZWluZm9fbGVuLCBiaXRzIC0gbDNfc2lkZS5yZXN2RHJhaW5fcG9zdCAtIDhcbiAgICAgICAgICAgICAgICAqIGdmYy5zaWRlaW5mb19sZW4sIGJpdHMsIGJpdHMgJSA4LCBiaXRzUGVyRnJhbWUpO1xuXG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJUaGlzIGlzIGEgZmF0YWwgZXJyb3IuICBJdCBoYXMgc2V2ZXJhbCBwb3NzaWJsZSBjYXVzZXM6XCIpO1xuICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiOTAlJSAgTEFNRSBjb21waWxlZCB3aXRoIGJ1Z2d5IHZlcnNpb24gb2YgZ2NjIHVzaW5nIGFkdmFuY2VkIG9wdGltaXphdGlvbnNcIik7XG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCIgOSUlICBZb3VyIHN5c3RlbSBpcyBvdmVyY2xvY2tlZFwiKTtcbiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIiAxJSUgIGJ1ZyBpbiBMQU1FIGVuY29kaW5nIGxpYnJhcnlcIik7XG5cbiAgICAgICAgICAgIGdmYy5SZXN2U2l6ZSA9IGwzX3NpZGUubWFpbl9kYXRhX2JlZ2luICogODtcbiAgICAgICAgfVxuICAgICAgICAvLztcblxuICAgICAgICBpZiAodG90Yml0ID4gMTAwMDAwMDAwMCkge1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIHRvIGF2b2lkIHRvdGJpdCBvdmVyZmxvdywgKGF0IDhoIGVuY29kaW5nIGF0IDEyOGticykgbGV0cyByZXNldFxuICAgICAgICAgICAgICogYml0IGNvdW50ZXJcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFyIGk7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgTGFtZUludGVybmFsRmxhZ3MuTUFYX0hFQURFUl9CVUY7ICsraSlcbiAgICAgICAgICAgICAgICBnZmMuaGVhZGVyW2ldLndyaXRlX3RpbWluZyAtPSB0b3RiaXQ7XG4gICAgICAgICAgICB0b3RiaXQgPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIDxQUkU+XG4gICAgICogY29weSBkYXRhIG91dCBvZiB0aGUgaW50ZXJuYWwgTVAzIGJpdCBidWZmZXIgaW50byBhIHVzZXIgc3VwcGxpZWRcbiAgICAgKiAgICAgICB1bnNpZ25lZCBjaGFyIGJ1ZmZlci5cbiAgICAgKlxuICAgICAqICAgICAgIG1wM2RhdGE9MCAgICAgIGluZGljYXRlcyBkYXRhIGluIGJ1ZmZlciBpcyBhbiBpZDN0YWdzIGFuZCBWQlIgdGFnc1xuICAgICAqICAgICAgIG1wM2RhdGE9MSAgICAgIGRhdGEgaXMgcmVhbCBtcDMgZnJhbWUgZGF0YS5cbiAgICAgKiA8L1BSRT5cbiAgICAgKi9cbiAgICB0aGlzLmNvcHlfYnVmZmVyID0gZnVuY3Rpb24gKGdmYywgYnVmZmVyLCBidWZmZXJQb3MsIHNpemUsIG1wM2RhdGEpIHtcbiAgICAgICAgdmFyIG1pbmltdW0gPSBidWZCeXRlSWR4ICsgMTtcbiAgICAgICAgaWYgKG1pbmltdW0gPD0gMClcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICBpZiAoc2l6ZSAhPSAwICYmIG1pbmltdW0gPiBzaXplKSB7XG4gICAgICAgICAgICAvKiBidWZmZXIgaXMgdG9vIHNtYWxsICovXG4gICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgU3lzdGVtLmFycmF5Y29weShidWYsIDAsIGJ1ZmZlciwgYnVmZmVyUG9zLCBtaW5pbXVtKTtcbiAgICAgICAgYnVmQnl0ZUlkeCA9IC0xO1xuICAgICAgICBidWZCaXRJZHggPSAwO1xuXG4gICAgICAgIGlmIChtcDNkYXRhICE9IDApIHtcbiAgICAgICAgICAgIHZhciBjcmMgPSBuZXdfaW50KDEpO1xuICAgICAgICAgICAgY3JjWzBdID0gZ2ZjLm5NdXNpY0NSQztcbiAgICAgICAgICAgIHZici51cGRhdGVNdXNpY0NSQyhjcmMsIGJ1ZmZlciwgYnVmZmVyUG9zLCBtaW5pbXVtKTtcbiAgICAgICAgICAgIGdmYy5uTXVzaWNDUkMgPSBjcmNbMF07XG5cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogc3VtIG51bWJlciBvZiBieXRlcyBiZWxvbmdpbmcgdG8gdGhlIG1wMyBzdHJlYW0gdGhpcyBpbmZvIHdpbGwgYmVcbiAgICAgICAgICAgICAqIHdyaXR0ZW4gaW50byB0aGUgWGluZy9MQU1FIGhlYWRlciBmb3Igc2Vla2luZ1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAobWluaW11bSA+IDApIHtcbiAgICAgICAgICAgICAgICBnZmMuVkJSX3NlZWtfdGFibGUubkJ5dGVzV3JpdHRlbiArPSBtaW5pbXVtO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZ2ZjLmRlY29kZV9vbl90aGVfZmx5KSB7IC8qIGRlY29kZSB0aGUgZnJhbWUgKi9cbiAgICAgICAgICAgICAgICB2YXIgcGNtX2J1ZiA9IG5ld19mbG9hdF9uKFsyLCAxMTUyXSk7XG4gICAgICAgICAgICAgICAgdmFyIG1wM19pbiA9IG1pbmltdW07XG4gICAgICAgICAgICAgICAgdmFyIHNhbXBsZXNfb3V0ID0gLTE7XG4gICAgICAgICAgICAgICAgdmFyIGk7XG5cbiAgICAgICAgICAgICAgICAvKiByZS1zeW50aGVzaXMgdG8gcGNtLiBSZXBlYXQgdW50aWwgd2UgZ2V0IGEgc2FtcGxlc19vdXQ9MCAqL1xuICAgICAgICAgICAgICAgIHdoaWxlIChzYW1wbGVzX291dCAhPSAwKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgc2FtcGxlc19vdXQgPSBtcGcuaGlwX2RlY29kZTFfdW5jbGlwcGVkKGdmYy5oaXAsIGJ1ZmZlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZmZlclBvcywgbXAzX2luLCBwY21fYnVmWzBdLCBwY21fYnVmWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICogc2FtcGxlc19vdXQgPSAwOiBuZWVkIG1vcmUgZGF0YSB0byBkZWNvZGUgc2FtcGxlc19vdXQgPVxuICAgICAgICAgICAgICAgICAgICAgKiAtMTogZXJyb3IuIExldHMgYXNzdW1lIDAgcGNtIG91dHB1dCBzYW1wbGVzX291dCA9IG51bWJlclxuICAgICAgICAgICAgICAgICAgICAgKiBvZiBzYW1wbGVzIG91dHB1dFxuICAgICAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgKiBzZXQgdGhlIGxlbmdodCBvZiB0aGUgbXAzIGlucHV0IGJ1ZmZlciB0byB6ZXJvLCBzbyB0aGF0XG4gICAgICAgICAgICAgICAgICAgICAqIGluIHRoZSBuZXh0IGl0ZXJhdGlvbiBvZiB0aGUgbG9vcCB3ZSB3aWxsIGJlIHF1ZXJ5aW5nXG4gICAgICAgICAgICAgICAgICAgICAqIG1wZ2xpYiBhYm91dCBidWZmZXJlZCBkYXRhXG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICBtcDNfaW4gPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChzYW1wbGVzX291dCA9PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICAgICAqIGVycm9yIGRlY29kaW5nLiBOb3QgZmF0YWwsIGJ1dCBtaWdodCBzY3JldyB1cCB0aGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAqIFJlcGxheUdhaW4gdGFnLiBXaGF0IHNob3VsZCB3ZSBkbz8gSWdub3JlIGZvciBub3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgc2FtcGxlc19vdXQgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChzYW1wbGVzX291dCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIHByb2Nlc3MgdGhlIFBDTSBkYXRhICovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiB0aGlzIHNob3VsZCBub3QgYmUgcG9zc2libGUsIGFuZCBpbmRpY2F0ZXMgd2UgaGF2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICogb3ZlcmZsb3duIHRoZSBwY21fYnVmIGJ1ZmZlclxuICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnZmMuZmluZFBlYWtTYW1wbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2FtcGxlc19vdXQ7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGNtX2J1ZlswXVtpXSA+IGdmYy5QZWFrU2FtcGxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ZjLlBlYWtTYW1wbGUgPSBwY21fYnVmWzBdW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICgtcGNtX2J1ZlswXVtpXSA+IGdmYy5QZWFrU2FtcGxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ZjLlBlYWtTYW1wbGUgPSAtcGNtX2J1ZlswXVtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdmYy5jaGFubmVsc19vdXQgPiAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgc2FtcGxlc19vdXQ7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBjbV9idWZbMV1baV0gPiBnZmMuUGVha1NhbXBsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZmMuUGVha1NhbXBsZSA9IHBjbV9idWZbMV1baV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICgtcGNtX2J1ZlsxXVtpXSA+IGdmYy5QZWFrU2FtcGxlKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdmYy5QZWFrU2FtcGxlID0gLXBjbV9idWZbMV1baV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdmYy5maW5kUmVwbGF5R2FpbilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2EuQW5hbHl6ZVNhbXBsZXMoZ2ZjLnJnZGF0YSwgcGNtX2J1ZlswXSwgMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBjbV9idWZbMV0sIDAsIHNhbXBsZXNfb3V0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ZjLmNoYW5uZWxzX291dCkgPT0gR2FpbkFuYWx5c2lzLkdBSU5fQU5BTFlTSVNfRVJST1IpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAtNjtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8qIGlmIChzYW1wbGVzX291dD4wKSAqL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKiB3aGlsZSAoc2FtcGxlc19vdXQhPTApICovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBpZiAoZ2ZjLmRlY29kZV9vbl90aGVfZmx5KSAqL1xuXG4gICAgICAgIH1cbiAgICAgICAgLyogaWYgKG1wM2RhdGEpICovXG4gICAgICAgIHJldHVybiBtaW5pbXVtO1xuICAgIH07XG5cbiAgICB0aGlzLmluaXRfYml0X3N0cmVhbV93ID0gZnVuY3Rpb24gKGdmYykge1xuICAgICAgICBidWYgPSBuZXdfYnl0ZShMYW1lLkxBTUVfTUFYTVAzQlVGRkVSKTtcblxuICAgICAgICBnZmMuaF9wdHIgPSBnZmMud19wdHIgPSAwO1xuICAgICAgICBnZmMuaGVhZGVyW2dmYy5oX3B0cl0ud3JpdGVfdGltaW5nID0gMDtcbiAgICAgICAgYnVmQnl0ZUlkeCA9IC0xO1xuICAgICAgICBidWZCaXRJZHggPSAwO1xuICAgICAgICB0b3RiaXQgPSAwO1xuICAgIH07XG5cbiAgICAvLyBGcm9tIG1hY2hpbmUuaFxuXG5cbn1cblxuZnVuY3Rpb24gSHVmZkNvZGVUYWIobGVuLCBtYXgsIHRhYiwgaGwpIHtcbiAgICB0aGlzLnhsZW4gPSBsZW47XG4gICAgdGhpcy5saW5tYXggPSBtYXg7XG4gICAgdGhpcy50YWJsZSA9IHRhYjtcbiAgICB0aGlzLmhsZW4gPSBobDtcbn1cblxudmFyIFRhYmxlcyA9IHt9O1xuXG5cblRhYmxlcy50MUhCID0gW1xuICAgIDEsIDEsXG4gICAgMSwgMFxuXTtcblxuVGFibGVzLnQySEIgPSBbXG4gICAgMSwgMiwgMSxcbiAgICAzLCAxLCAxLFxuICAgIDMsIDIsIDBcbl07XG5cblRhYmxlcy50M0hCID0gW1xuICAgIDMsIDIsIDEsXG4gICAgMSwgMSwgMSxcbiAgICAzLCAyLCAwXG5dO1xuXG5UYWJsZXMudDVIQiA9IFtcbiAgICAxLCAyLCA2LCA1LFxuICAgIDMsIDEsIDQsIDQsXG4gICAgNywgNSwgNywgMSxcbiAgICA2LCAxLCAxLCAwXG5dO1xuXG5UYWJsZXMudDZIQiA9IFtcbiAgICA3LCAzLCA1LCAxLFxuICAgIDYsIDIsIDMsIDIsXG4gICAgNSwgNCwgNCwgMSxcbiAgICAzLCAzLCAyLCAwXG5dO1xuXG5UYWJsZXMudDdIQiA9IFtcbiAgICAxLCAyLCAxMCwgMTksIDE2LCAxMCxcbiAgICAzLCAzLCA3LCAxMCwgNSwgMyxcbiAgICAxMSwgNCwgMTMsIDE3LCA4LCA0LFxuICAgIDEyLCAxMSwgMTgsIDE1LCAxMSwgMixcbiAgICA3LCA2LCA5LCAxNCwgMywgMSxcbiAgICA2LCA0LCA1LCAzLCAyLCAwXG5dO1xuXG5UYWJsZXMudDhIQiA9IFtcbiAgICAzLCA0LCA2LCAxOCwgMTIsIDUsXG4gICAgNSwgMSwgMiwgMTYsIDksIDMsXG4gICAgNywgMywgNSwgMTQsIDcsIDMsXG4gICAgMTksIDE3LCAxNSwgMTMsIDEwLCA0LFxuICAgIDEzLCA1LCA4LCAxMSwgNSwgMSxcbiAgICAxMiwgNCwgNCwgMSwgMSwgMFxuXTtcblxuVGFibGVzLnQ5SEIgPSBbXG4gICAgNywgNSwgOSwgMTQsIDE1LCA3LFxuICAgIDYsIDQsIDUsIDUsIDYsIDcsXG4gICAgNywgNiwgOCwgOCwgOCwgNSxcbiAgICAxNSwgNiwgOSwgMTAsIDUsIDEsXG4gICAgMTEsIDcsIDksIDYsIDQsIDEsXG4gICAgMTQsIDQsIDYsIDIsIDYsIDBcbl07XG5cblRhYmxlcy50MTBIQiA9IFtcbiAgICAxLCAyLCAxMCwgMjMsIDM1LCAzMCwgMTIsIDE3LFxuICAgIDMsIDMsIDgsIDEyLCAxOCwgMjEsIDEyLCA3LFxuICAgIDExLCA5LCAxNSwgMjEsIDMyLCA0MCwgMTksIDYsXG4gICAgMTQsIDEzLCAyMiwgMzQsIDQ2LCAyMywgMTgsIDcsXG4gICAgMjAsIDE5LCAzMywgNDcsIDI3LCAyMiwgOSwgMyxcbiAgICAzMSwgMjIsIDQxLCAyNiwgMjEsIDIwLCA1LCAzLFxuICAgIDE0LCAxMywgMTAsIDExLCAxNiwgNiwgNSwgMSxcbiAgICA5LCA4LCA3LCA4LCA0LCA0LCAyLCAwXG5dO1xuXG5UYWJsZXMudDExSEIgPSBbXG4gICAgMywgNCwgMTAsIDI0LCAzNCwgMzMsIDIxLCAxNSxcbiAgICA1LCAzLCA0LCAxMCwgMzIsIDE3LCAxMSwgMTAsXG4gICAgMTEsIDcsIDEzLCAxOCwgMzAsIDMxLCAyMCwgNSxcbiAgICAyNSwgMTEsIDE5LCA1OSwgMjcsIDE4LCAxMiwgNSxcbiAgICAzNSwgMzMsIDMxLCA1OCwgMzAsIDE2LCA3LCA1LFxuICAgIDI4LCAyNiwgMzIsIDE5LCAxNywgMTUsIDgsIDE0LFxuICAgIDE0LCAxMiwgOSwgMTMsIDE0LCA5LCA0LCAxLFxuICAgIDExLCA0LCA2LCA2LCA2LCAzLCAyLCAwXG5dO1xuXG5UYWJsZXMudDEySEIgPSBbXG4gICAgOSwgNiwgMTYsIDMzLCA0MSwgMzksIDM4LCAyNixcbiAgICA3LCA1LCA2LCA5LCAyMywgMTYsIDI2LCAxMSxcbiAgICAxNywgNywgMTEsIDE0LCAyMSwgMzAsIDEwLCA3LFxuICAgIDE3LCAxMCwgMTUsIDEyLCAxOCwgMjgsIDE0LCA1LFxuICAgIDMyLCAxMywgMjIsIDE5LCAxOCwgMTYsIDksIDUsXG4gICAgNDAsIDE3LCAzMSwgMjksIDE3LCAxMywgNCwgMixcbiAgICAyNywgMTIsIDExLCAxNSwgMTAsIDcsIDQsIDEsXG4gICAgMjcsIDEyLCA4LCAxMiwgNiwgMywgMSwgMFxuXTtcblxuVGFibGVzLnQxM0hCID0gW1xuICAgIDEsIDUsIDE0LCAyMSwgMzQsIDUxLCA0NiwgNzEsIDQyLCA1MiwgNjgsIDUyLCA2NywgNDQsIDQzLCAxOSxcbiAgICAzLCA0LCAxMiwgMTksIDMxLCAyNiwgNDQsIDMzLCAzMSwgMjQsIDMyLCAyNCwgMzEsIDM1LCAyMiwgMTQsXG4gICAgMTUsIDEzLCAyMywgMzYsIDU5LCA0OSwgNzcsIDY1LCAyOSwgNDAsIDMwLCA0MCwgMjcsIDMzLCA0MiwgMTYsXG4gICAgMjIsIDIwLCAzNywgNjEsIDU2LCA3OSwgNzMsIDY0LCA0MywgNzYsIDU2LCAzNywgMjYsIDMxLCAyNSwgMTQsXG4gICAgMzUsIDE2LCA2MCwgNTcsIDk3LCA3NSwgMTE0LCA5MSwgNTQsIDczLCA1NSwgNDEsIDQ4LCA1MywgMjMsIDI0LFxuICAgIDU4LCAyNywgNTAsIDk2LCA3NiwgNzAsIDkzLCA4NCwgNzcsIDU4LCA3OSwgMjksIDc0LCA0OSwgNDEsIDE3LFxuICAgIDQ3LCA0NSwgNzgsIDc0LCAxMTUsIDk0LCA5MCwgNzksIDY5LCA4MywgNzEsIDUwLCA1OSwgMzgsIDM2LCAxNSxcbiAgICA3MiwgMzQsIDU2LCA5NSwgOTIsIDg1LCA5MSwgOTAsIDg2LCA3MywgNzcsIDY1LCA1MSwgNDQsIDQzLCA0MixcbiAgICA0MywgMjAsIDMwLCA0NCwgNTUsIDc4LCA3MiwgODcsIDc4LCA2MSwgNDYsIDU0LCAzNywgMzAsIDIwLCAxNixcbiAgICA1MywgMjUsIDQxLCAzNywgNDQsIDU5LCA1NCwgODEsIDY2LCA3NiwgNTcsIDU0LCAzNywgMTgsIDM5LCAxMSxcbiAgICAzNSwgMzMsIDMxLCA1NywgNDIsIDgyLCA3MiwgODAsIDQ3LCA1OCwgNTUsIDIxLCAyMiwgMjYsIDM4LCAyMixcbiAgICA1MywgMjUsIDIzLCAzOCwgNzAsIDYwLCA1MSwgMzYsIDU1LCAyNiwgMzQsIDIzLCAyNywgMTQsIDksIDcsXG4gICAgMzQsIDMyLCAyOCwgMzksIDQ5LCA3NSwgMzAsIDUyLCA0OCwgNDAsIDUyLCAyOCwgMTgsIDE3LCA5LCA1LFxuICAgIDQ1LCAyMSwgMzQsIDY0LCA1NiwgNTAsIDQ5LCA0NSwgMzEsIDE5LCAxMiwgMTUsIDEwLCA3LCA2LCAzLFxuICAgIDQ4LCAyMywgMjAsIDM5LCAzNiwgMzUsIDUzLCAyMSwgMTYsIDIzLCAxMywgMTAsIDYsIDEsIDQsIDIsXG4gICAgMTYsIDE1LCAxNywgMjcsIDI1LCAyMCwgMjksIDExLCAxNywgMTIsIDE2LCA4LCAxLCAxLCAwLCAxXG5dO1xuXG5UYWJsZXMudDE1SEIgPSBbXG4gICAgNywgMTIsIDE4LCA1MywgNDcsIDc2LCAxMjQsIDEwOCwgODksIDEyMywgMTA4LCAxMTksIDEwNywgODEsIDEyMiwgNjMsXG4gICAgMTMsIDUsIDE2LCAyNywgNDYsIDM2LCA2MSwgNTEsIDQyLCA3MCwgNTIsIDgzLCA2NSwgNDEsIDU5LCAzNixcbiAgICAxOSwgMTcsIDE1LCAyNCwgNDEsIDM0LCA1OSwgNDgsIDQwLCA2NCwgNTAsIDc4LCA2MiwgODAsIDU2LCAzMyxcbiAgICAyOSwgMjgsIDI1LCA0MywgMzksIDYzLCA1NSwgOTMsIDc2LCA1OSwgOTMsIDcyLCA1NCwgNzUsIDUwLCAyOSxcbiAgICA1MiwgMjIsIDQyLCA0MCwgNjcsIDU3LCA5NSwgNzksIDcyLCA1NywgODksIDY5LCA0OSwgNjYsIDQ2LCAyNyxcbiAgICA3NywgMzcsIDM1LCA2NiwgNTgsIDUyLCA5MSwgNzQsIDYyLCA0OCwgNzksIDYzLCA5MCwgNjIsIDQwLCAzOCxcbiAgICAxMjUsIDMyLCA2MCwgNTYsIDUwLCA5MiwgNzgsIDY1LCA1NSwgODcsIDcxLCA1MSwgNzMsIDUxLCA3MCwgMzAsXG4gICAgMTA5LCA1MywgNDksIDk0LCA4OCwgNzUsIDY2LCAxMjIsIDkxLCA3MywgNTYsIDQyLCA2NCwgNDQsIDIxLCAyNSxcbiAgICA5MCwgNDMsIDQxLCA3NywgNzMsIDYzLCA1NiwgOTIsIDc3LCA2NiwgNDcsIDY3LCA0OCwgNTMsIDM2LCAyMCxcbiAgICA3MSwgMzQsIDY3LCA2MCwgNTgsIDQ5LCA4OCwgNzYsIDY3LCAxMDYsIDcxLCA1NCwgMzgsIDM5LCAyMywgMTUsXG4gICAgMTA5LCA1MywgNTEsIDQ3LCA5MCwgODIsIDU4LCA1NywgNDgsIDcyLCA1NywgNDEsIDIzLCAyNywgNjIsIDksXG4gICAgODYsIDQyLCA0MCwgMzcsIDcwLCA2NCwgNTIsIDQzLCA3MCwgNTUsIDQyLCAyNSwgMjksIDE4LCAxMSwgMTEsXG4gICAgMTE4LCA2OCwgMzAsIDU1LCA1MCwgNDYsIDc0LCA2NSwgNDksIDM5LCAyNCwgMTYsIDIyLCAxMywgMTQsIDcsXG4gICAgOTEsIDQ0LCAzOSwgMzgsIDM0LCA2MywgNTIsIDQ1LCAzMSwgNTIsIDI4LCAxOSwgMTQsIDgsIDksIDMsXG4gICAgMTIzLCA2MCwgNTgsIDUzLCA0NywgNDMsIDMyLCAyMiwgMzcsIDI0LCAxNywgMTIsIDE1LCAxMCwgMiwgMSxcbiAgICA3MSwgMzcsIDM0LCAzMCwgMjgsIDIwLCAxNywgMjYsIDIxLCAxNiwgMTAsIDYsIDgsIDYsIDIsIDBcbl07XG5cblRhYmxlcy50MTZIQiA9IFtcbiAgICAxLCA1LCAxNCwgNDQsIDc0LCA2MywgMTEwLCA5MywgMTcyLCAxNDksIDEzOCwgMjQyLCAyMjUsIDE5NSwgMzc2LCAxNyxcbiAgICAzLCA0LCAxMiwgMjAsIDM1LCA2MiwgNTMsIDQ3LCA4MywgNzUsIDY4LCAxMTksIDIwMSwgMTA3LCAyMDcsIDksXG4gICAgMTUsIDEzLCAyMywgMzgsIDY3LCA1OCwgMTAzLCA5MCwgMTYxLCA3MiwgMTI3LCAxMTcsIDExMCwgMjA5LCAyMDYsIDE2LFxuICAgIDQ1LCAyMSwgMzksIDY5LCA2NCwgMTE0LCA5OSwgODcsIDE1OCwgMTQwLCAyNTIsIDIxMiwgMTk5LCAzODcsIDM2NSwgMjYsXG4gICAgNzUsIDM2LCA2OCwgNjUsIDExNSwgMTAxLCAxNzksIDE2NCwgMTU1LCAyNjQsIDI0NiwgMjI2LCAzOTUsIDM4MiwgMzYyLCA5LFxuICAgIDY2LCAzMCwgNTksIDU2LCAxMDIsIDE4NSwgMTczLCAyNjUsIDE0MiwgMjUzLCAyMzIsIDQwMCwgMzg4LCAzNzgsIDQ0NSwgMTYsXG4gICAgMTExLCA1NCwgNTIsIDEwMCwgMTg0LCAxNzgsIDE2MCwgMTMzLCAyNTcsIDI0NCwgMjI4LCAyMTcsIDM4NSwgMzY2LCA3MTUsIDEwLFxuICAgIDk4LCA0OCwgOTEsIDg4LCAxNjUsIDE1NywgMTQ4LCAyNjEsIDI0OCwgNDA3LCAzOTcsIDM3MiwgMzgwLCA4ODksIDg4NCwgOCxcbiAgICA4NSwgODQsIDgxLCAxNTksIDE1NiwgMTQzLCAyNjAsIDI0OSwgNDI3LCA0MDEsIDM5MiwgMzgzLCA3MjcsIDcxMywgNzA4LCA3LFxuICAgIDE1NCwgNzYsIDczLCAxNDEsIDEzMSwgMjU2LCAyNDUsIDQyNiwgNDA2LCAzOTQsIDM4NCwgNzM1LCAzNTksIDcxMCwgMzUyLCAxMSxcbiAgICAxMzksIDEyOSwgNjcsIDEyNSwgMjQ3LCAyMzMsIDIyOSwgMjE5LCAzOTMsIDc0MywgNzM3LCA3MjAsIDg4NSwgODgyLCA0MzksIDQsXG4gICAgMjQzLCAxMjAsIDExOCwgMTE1LCAyMjcsIDIyMywgMzk2LCA3NDYsIDc0MiwgNzM2LCA3MjEsIDcxMiwgNzA2LCAyMjMsIDQzNiwgNixcbiAgICAyMDIsIDIyNCwgMjIyLCAyMTgsIDIxNiwgMzg5LCAzODYsIDM4MSwgMzY0LCA4ODgsIDQ0MywgNzA3LCA0NDAsIDQzNywgMTcyOCwgNCxcbiAgICA3NDcsIDIxMSwgMjEwLCAyMDgsIDM3MCwgMzc5LCA3MzQsIDcyMywgNzE0LCAxNzM1LCA4ODMsIDg3NywgODc2LCAzNDU5LCA4NjUsIDIsXG4gICAgMzc3LCAzNjksIDEwMiwgMTg3LCA3MjYsIDcyMiwgMzU4LCA3MTEsIDcwOSwgODY2LCAxNzM0LCA4NzEsIDM0NTgsIDg3MCwgNDM0LCAwLFxuICAgIDEyLCAxMCwgNywgMTEsIDEwLCAxNywgMTEsIDksIDEzLCAxMiwgMTAsIDcsIDUsIDMsIDEsIDNcbl07XG5cblRhYmxlcy50MjRIQiA9IFtcbiAgICAxNSwgMTMsIDQ2LCA4MCwgMTQ2LCAyNjIsIDI0OCwgNDM0LCA0MjYsIDY2OSwgNjUzLCA2NDksIDYyMSwgNTE3LCAxMDMyLCA4OCxcbiAgICAxNCwgMTIsIDIxLCAzOCwgNzEsIDEzMCwgMTIyLCAyMTYsIDIwOSwgMTk4LCAzMjcsIDM0NSwgMzE5LCAyOTcsIDI3OSwgNDIsXG4gICAgNDcsIDIyLCA0MSwgNzQsIDY4LCAxMjgsIDEyMCwgMjIxLCAyMDcsIDE5NCwgMTgyLCAzNDAsIDMxNSwgMjk1LCA1NDEsIDE4LFxuICAgIDgxLCAzOSwgNzUsIDcwLCAxMzQsIDEyNSwgMTE2LCAyMjAsIDIwNCwgMTkwLCAxNzgsIDMyNSwgMzExLCAyOTMsIDI3MSwgMTYsXG4gICAgMTQ3LCA3MiwgNjksIDEzNSwgMTI3LCAxMTgsIDExMiwgMjEwLCAyMDAsIDE4OCwgMzUyLCAzMjMsIDMwNiwgMjg1LCA1NDAsIDE0LFxuICAgIDI2MywgNjYsIDEyOSwgMTI2LCAxMTksIDExNCwgMjE0LCAyMDIsIDE5MiwgMTgwLCAzNDEsIDMxNywgMzAxLCAyODEsIDI2MiwgMTIsXG4gICAgMjQ5LCAxMjMsIDEyMSwgMTE3LCAxMTMsIDIxNSwgMjA2LCAxOTUsIDE4NSwgMzQ3LCAzMzAsIDMwOCwgMjkxLCAyNzIsIDUyMCwgMTAsXG4gICAgNDM1LCAxMTUsIDExMSwgMTA5LCAyMTEsIDIwMywgMTk2LCAxODcsIDM1MywgMzMyLCAzMTMsIDI5OCwgMjgzLCA1MzEsIDM4MSwgMTcsXG4gICAgNDI3LCAyMTIsIDIwOCwgMjA1LCAyMDEsIDE5MywgMTg2LCAxNzcsIDE2OSwgMzIwLCAzMDMsIDI4NiwgMjY4LCA1MTQsIDM3NywgMTYsXG4gICAgMzM1LCAxOTksIDE5NywgMTkxLCAxODksIDE4MSwgMTc0LCAzMzMsIDMyMSwgMzA1LCAyODksIDI3NSwgNTIxLCAzNzksIDM3MSwgMTEsXG4gICAgNjY4LCAxODQsIDE4MywgMTc5LCAxNzUsIDM0NCwgMzMxLCAzMTQsIDMwNCwgMjkwLCAyNzcsIDUzMCwgMzgzLCAzNzMsIDM2NiwgMTAsXG4gICAgNjUyLCAzNDYsIDE3MSwgMTY4LCAxNjQsIDMxOCwgMzA5LCAyOTksIDI4NywgMjc2LCAyNjMsIDUxMywgMzc1LCAzNjgsIDM2MiwgNixcbiAgICA2NDgsIDMyMiwgMzE2LCAzMTIsIDMwNywgMzAyLCAyOTIsIDI4NCwgMjY5LCAyNjEsIDUxMiwgMzc2LCAzNzAsIDM2NCwgMzU5LCA0LFxuICAgIDYyMCwgMzAwLCAyOTYsIDI5NCwgMjg4LCAyODIsIDI3MywgMjY2LCA1MTUsIDM4MCwgMzc0LCAzNjksIDM2NSwgMzYxLCAzNTcsIDIsXG4gICAgMTAzMywgMjgwLCAyNzgsIDI3NCwgMjY3LCAyNjQsIDI1OSwgMzgyLCAzNzgsIDM3MiwgMzY3LCAzNjMsIDM2MCwgMzU4LCAzNTYsIDAsXG4gICAgNDMsIDIwLCAxOSwgMTcsIDE1LCAxMywgMTEsIDksIDcsIDYsIDQsIDcsIDUsIDMsIDEsIDNcbl07XG5cblRhYmxlcy50MzJIQiA9IFtcbiAgICAxIDw8IDAsIDUgPDwgMSwgNCA8PCAxLCA1IDw8IDIsIDYgPDwgMSwgNSA8PCAyLCA0IDw8IDIsIDQgPDwgMyxcbiAgICA3IDw8IDEsIDMgPDwgMiwgNiA8PCAyLCAwIDw8IDMsIDcgPDwgMiwgMiA8PCAzLCAzIDw8IDMsIDEgPDwgNFxuXTtcblxuVGFibGVzLnQzM0hCID0gW1xuICAgIDE1IDw8IDAsIDE0IDw8IDEsIDEzIDw8IDEsIDEyIDw8IDIsIDExIDw8IDEsIDEwIDw8IDIsIDkgPDwgMiwgOCA8PCAzLFxuICAgIDcgPDwgMSwgNiA8PCAyLCA1IDw8IDIsIDQgPDwgMywgMyA8PCAyLCAyIDw8IDMsIDEgPDwgMywgMCA8PCA0XG5dO1xuXG5UYWJsZXMudDFsID0gW1xuICAgIDEsIDQsXG4gICAgMywgNVxuXTtcblxuVGFibGVzLnQybCA9IFtcbiAgICAxLCA0LCA3LFxuICAgIDQsIDUsIDcsXG4gICAgNiwgNywgOFxuXTtcblxuVGFibGVzLnQzbCA9IFtcbiAgICAyLCAzLCA3LFxuICAgIDQsIDQsIDcsXG4gICAgNiwgNywgOFxuXTtcblxuVGFibGVzLnQ1bCA9IFtcbiAgICAxLCA0LCA3LCA4LFxuICAgIDQsIDUsIDgsIDksXG4gICAgNywgOCwgOSwgMTAsXG4gICAgOCwgOCwgOSwgMTBcbl07XG5cblRhYmxlcy50NmwgPSBbXG4gICAgMywgNCwgNiwgOCxcbiAgICA0LCA0LCA2LCA3LFxuICAgIDUsIDYsIDcsIDgsXG4gICAgNywgNywgOCwgOVxuXTtcblxuVGFibGVzLnQ3bCA9IFtcbiAgICAxLCA0LCA3LCA5LCA5LCAxMCxcbiAgICA0LCA2LCA4LCA5LCA5LCAxMCxcbiAgICA3LCA3LCA5LCAxMCwgMTAsIDExLFxuICAgIDgsIDksIDEwLCAxMSwgMTEsIDExLFxuICAgIDgsIDksIDEwLCAxMSwgMTEsIDEyLFxuICAgIDksIDEwLCAxMSwgMTIsIDEyLCAxMlxuXTtcblxuVGFibGVzLnQ4bCA9IFtcbiAgICAyLCA0LCA3LCA5LCA5LCAxMCxcbiAgICA0LCA0LCA2LCAxMCwgMTAsIDEwLFxuICAgIDcsIDYsIDgsIDEwLCAxMCwgMTEsXG4gICAgOSwgMTAsIDEwLCAxMSwgMTEsIDEyLFxuICAgIDksIDksIDEwLCAxMSwgMTIsIDEyLFxuICAgIDEwLCAxMCwgMTEsIDExLCAxMywgMTNcbl07XG5cblRhYmxlcy50OWwgPSBbXG4gICAgMywgNCwgNiwgNywgOSwgMTAsXG4gICAgNCwgNSwgNiwgNywgOCwgMTAsXG4gICAgNSwgNiwgNywgOCwgOSwgMTAsXG4gICAgNywgNywgOCwgOSwgOSwgMTAsXG4gICAgOCwgOCwgOSwgOSwgMTAsIDExLFxuICAgIDksIDksIDEwLCAxMCwgMTEsIDExXG5dO1xuXG5UYWJsZXMudDEwbCA9IFtcbiAgICAxLCA0LCA3LCA5LCAxMCwgMTAsIDEwLCAxMSxcbiAgICA0LCA2LCA4LCA5LCAxMCwgMTEsIDEwLCAxMCxcbiAgICA3LCA4LCA5LCAxMCwgMTEsIDEyLCAxMSwgMTEsXG4gICAgOCwgOSwgMTAsIDExLCAxMiwgMTIsIDExLCAxMixcbiAgICA5LCAxMCwgMTEsIDEyLCAxMiwgMTIsIDEyLCAxMixcbiAgICAxMCwgMTEsIDEyLCAxMiwgMTMsIDEzLCAxMiwgMTMsXG4gICAgOSwgMTAsIDExLCAxMiwgMTIsIDEyLCAxMywgMTMsXG4gICAgMTAsIDEwLCAxMSwgMTIsIDEyLCAxMywgMTMsIDEzXG5dO1xuXG5UYWJsZXMudDExbCA9IFtcbiAgICAyLCA0LCA2LCA4LCA5LCAxMCwgOSwgMTAsXG4gICAgNCwgNSwgNiwgOCwgMTAsIDEwLCA5LCAxMCxcbiAgICA2LCA3LCA4LCA5LCAxMCwgMTEsIDEwLCAxMCxcbiAgICA4LCA4LCA5LCAxMSwgMTAsIDEyLCAxMCwgMTEsXG4gICAgOSwgMTAsIDEwLCAxMSwgMTEsIDEyLCAxMSwgMTIsXG4gICAgOSwgMTAsIDExLCAxMiwgMTIsIDEzLCAxMiwgMTMsXG4gICAgOSwgOSwgOSwgMTAsIDExLCAxMiwgMTIsIDEyLFxuICAgIDksIDksIDEwLCAxMSwgMTIsIDEyLCAxMiwgMTJcbl07XG5cblRhYmxlcy50MTJsID0gW1xuICAgIDQsIDQsIDYsIDgsIDksIDEwLCAxMCwgMTAsXG4gICAgNCwgNSwgNiwgNywgOSwgOSwgMTAsIDEwLFxuICAgIDYsIDYsIDcsIDgsIDksIDEwLCA5LCAxMCxcbiAgICA3LCA3LCA4LCA4LCA5LCAxMCwgMTAsIDEwLFxuICAgIDgsIDgsIDksIDksIDEwLCAxMCwgMTAsIDExLFxuICAgIDksIDksIDEwLCAxMCwgMTAsIDExLCAxMCwgMTEsXG4gICAgOSwgOSwgOSwgMTAsIDEwLCAxMSwgMTEsIDEyLFxuICAgIDEwLCAxMCwgMTAsIDExLCAxMSwgMTEsIDExLCAxMlxuXTtcblxuVGFibGVzLnQxM2wgPSBbXG4gICAgMSwgNSwgNywgOCwgOSwgMTAsIDEwLCAxMSwgMTAsIDExLCAxMiwgMTIsIDEzLCAxMywgMTQsIDE0LFxuICAgIDQsIDYsIDgsIDksIDEwLCAxMCwgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTMsIDE0LCAxNCwgMTQsXG4gICAgNywgOCwgOSwgMTAsIDExLCAxMSwgMTIsIDEyLCAxMSwgMTIsIDEyLCAxMywgMTMsIDE0LCAxNSwgMTUsXG4gICAgOCwgOSwgMTAsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDEzLCAxNCwgMTUsIDE1LFxuICAgIDksIDksIDExLCAxMSwgMTIsIDEyLCAxMywgMTMsIDEyLCAxMywgMTMsIDE0LCAxNCwgMTUsIDE1LCAxNixcbiAgICAxMCwgMTAsIDExLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxMywgMTQsIDEzLCAxNSwgMTUsIDE2LCAxNixcbiAgICAxMCwgMTEsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE0LCAxNSwgMTUsIDE2LCAxNixcbiAgICAxMSwgMTEsIDEyLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE0LCAxNCwgMTUsIDE1LCAxNSwgMTYsIDE4LCAxOCxcbiAgICAxMCwgMTAsIDExLCAxMiwgMTIsIDEzLCAxMywgMTQsIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTYsIDE3LCAxNyxcbiAgICAxMSwgMTEsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTUsIDE0LCAxNSwgMTUsIDE2LCAxNiwgMTYsIDE4LCAxNyxcbiAgICAxMSwgMTIsIDEyLCAxMywgMTMsIDE0LCAxNCwgMTUsIDE0LCAxNSwgMTYsIDE1LCAxNiwgMTcsIDE4LCAxOSxcbiAgICAxMiwgMTIsIDEyLCAxMywgMTQsIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTUsIDE2LCAxNywgMTcsIDE3LCAxOCxcbiAgICAxMiwgMTMsIDEzLCAxNCwgMTQsIDE1LCAxNCwgMTUsIDE2LCAxNiwgMTcsIDE3LCAxNywgMTgsIDE4LCAxOCxcbiAgICAxMywgMTMsIDE0LCAxNSwgMTUsIDE1LCAxNiwgMTYsIDE2LCAxNiwgMTYsIDE3LCAxOCwgMTcsIDE4LCAxOCxcbiAgICAxNCwgMTQsIDE0LCAxNSwgMTUsIDE1LCAxNywgMTYsIDE2LCAxOSwgMTcsIDE3LCAxNywgMTksIDE4LCAxOCxcbiAgICAxMywgMTQsIDE1LCAxNiwgMTYsIDE2LCAxNywgMTYsIDE3LCAxNywgMTgsIDE4LCAyMSwgMjAsIDIxLCAxOFxuXTtcblxuVGFibGVzLnQxNWwgPSBbXG4gICAgMywgNSwgNiwgOCwgOCwgOSwgMTAsIDEwLCAxMCwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMywgMTQsXG4gICAgNSwgNSwgNywgOCwgOSwgOSwgMTAsIDEwLCAxMCwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMywgMTMsXG4gICAgNiwgNywgNywgOCwgOSwgOSwgMTAsIDEwLCAxMCwgMTEsIDExLCAxMiwgMTIsIDEzLCAxMywgMTMsXG4gICAgNywgOCwgOCwgOSwgOSwgMTAsIDEwLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLFxuICAgIDgsIDgsIDksIDksIDEwLCAxMCwgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsXG4gICAgOSwgOSwgOSwgMTAsIDEwLCAxMCwgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTQsXG4gICAgMTAsIDksIDEwLCAxMCwgMTAsIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMywgMTMsIDE0LCAxNCxcbiAgICAxMCwgMTAsIDEwLCAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxNCxcbiAgICAxMCwgMTAsIDEwLCAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTQsIDE0LCAxNCxcbiAgICAxMCwgMTAsIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxMywgMTQsIDE0LCAxNCxcbiAgICAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxMywgMTQsIDE1LCAxNCxcbiAgICAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE0LCAxNSxcbiAgICAxMiwgMTIsIDExLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE1LCAxNSxcbiAgICAxMiwgMTIsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE0LCAxNCwgMTQsIDE1LCAxNSxcbiAgICAxMywgMTMsIDEzLCAxMywgMTMsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTQsIDE0LCAxNSwgMTUsIDE0LCAxNSxcbiAgICAxMywgMTMsIDEzLCAxMywgMTMsIDEzLCAxMywgMTQsIDE0LCAxNCwgMTQsIDE0LCAxNSwgMTUsIDE1LCAxNVxuXTtcblxuVGFibGVzLnQxNl81bCA9IFtcbiAgICAxLCA1LCA3LCA5LCAxMCwgMTAsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTQsIDExLFxuICAgIDQsIDYsIDgsIDksIDEwLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMywgMTQsIDEzLCAxNCwgMTEsXG4gICAgNywgOCwgOSwgMTAsIDExLCAxMSwgMTIsIDEyLCAxMywgMTIsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTIsXG4gICAgOSwgOSwgMTAsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxNCwgMTQsIDE0LCAxNSwgMTUsIDEzLFxuICAgIDEwLCAxMCwgMTEsIDExLCAxMiwgMTIsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTUsIDEyLFxuICAgIDEwLCAxMCwgMTEsIDExLCAxMiwgMTMsIDEzLCAxNCwgMTMsIDE0LCAxNCwgMTUsIDE1LCAxNSwgMTYsIDEzLFxuICAgIDExLCAxMSwgMTEsIDEyLCAxMywgMTMsIDEzLCAxMywgMTQsIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTYsIDEzLFxuICAgIDExLCAxMSwgMTIsIDEyLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE1LCAxNSwgMTUsIDE1LCAxNywgMTcsIDEzLFxuICAgIDExLCAxMiwgMTIsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTUsIDE1LCAxNSwgMTUsIDE2LCAxNiwgMTYsIDEzLFxuICAgIDEyLCAxMiwgMTIsIDEzLCAxMywgMTQsIDE0LCAxNSwgMTUsIDE1LCAxNSwgMTYsIDE1LCAxNiwgMTUsIDE0LFxuICAgIDEyLCAxMywgMTIsIDEzLCAxNCwgMTQsIDE0LCAxNCwgMTUsIDE2LCAxNiwgMTYsIDE3LCAxNywgMTYsIDEzLFxuICAgIDEzLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE1LCAxNiwgMTYsIDE2LCAxNiwgMTYsIDE2LCAxNSwgMTYsIDE0LFxuICAgIDEzLCAxNCwgMTQsIDE0LCAxNCwgMTUsIDE1LCAxNSwgMTUsIDE3LCAxNiwgMTYsIDE2LCAxNiwgMTgsIDE0LFxuICAgIDE1LCAxNCwgMTQsIDE0LCAxNSwgMTUsIDE2LCAxNiwgMTYsIDE4LCAxNywgMTcsIDE3LCAxOSwgMTcsIDE0LFxuICAgIDE0LCAxNSwgMTMsIDE0LCAxNiwgMTYsIDE1LCAxNiwgMTYsIDE3LCAxOCwgMTcsIDE5LCAxNywgMTYsIDE0LFxuICAgIDExLCAxMSwgMTEsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTQsIDE0LCAxNCwgMTQsIDE0LCAxNCwgMTQsIDEyXG5dO1xuXG5UYWJsZXMudDE2bCA9IFtcbiAgICAxLCA1LCA3LCA5LCAxMCwgMTAsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTQsIDEwLFxuICAgIDQsIDYsIDgsIDksIDEwLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMywgMTQsIDEzLCAxNCwgMTAsXG4gICAgNywgOCwgOSwgMTAsIDExLCAxMSwgMTIsIDEyLCAxMywgMTIsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTEsXG4gICAgOSwgOSwgMTAsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxNCwgMTQsIDE0LCAxNSwgMTUsIDEyLFxuICAgIDEwLCAxMCwgMTEsIDExLCAxMiwgMTIsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTUsIDExLFxuICAgIDEwLCAxMCwgMTEsIDExLCAxMiwgMTMsIDEzLCAxNCwgMTMsIDE0LCAxNCwgMTUsIDE1LCAxNSwgMTYsIDEyLFxuICAgIDExLCAxMSwgMTEsIDEyLCAxMywgMTMsIDEzLCAxMywgMTQsIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTYsIDEyLFxuICAgIDExLCAxMSwgMTIsIDEyLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE1LCAxNSwgMTUsIDE1LCAxNywgMTcsIDEyLFxuICAgIDExLCAxMiwgMTIsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTUsIDE1LCAxNSwgMTUsIDE2LCAxNiwgMTYsIDEyLFxuICAgIDEyLCAxMiwgMTIsIDEzLCAxMywgMTQsIDE0LCAxNSwgMTUsIDE1LCAxNSwgMTYsIDE1LCAxNiwgMTUsIDEzLFxuICAgIDEyLCAxMywgMTIsIDEzLCAxNCwgMTQsIDE0LCAxNCwgMTUsIDE2LCAxNiwgMTYsIDE3LCAxNywgMTYsIDEyLFxuICAgIDEzLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE1LCAxNiwgMTYsIDE2LCAxNiwgMTYsIDE2LCAxNSwgMTYsIDEzLFxuICAgIDEzLCAxNCwgMTQsIDE0LCAxNCwgMTUsIDE1LCAxNSwgMTUsIDE3LCAxNiwgMTYsIDE2LCAxNiwgMTgsIDEzLFxuICAgIDE1LCAxNCwgMTQsIDE0LCAxNSwgMTUsIDE2LCAxNiwgMTYsIDE4LCAxNywgMTcsIDE3LCAxOSwgMTcsIDEzLFxuICAgIDE0LCAxNSwgMTMsIDE0LCAxNiwgMTYsIDE1LCAxNiwgMTYsIDE3LCAxOCwgMTcsIDE5LCAxNywgMTYsIDEzLFxuICAgIDEwLCAxMCwgMTAsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTMsIDEzLCAxMywgMTMsIDEwXG5dO1xuXG5UYWJsZXMudDI0bCA9IFtcbiAgICA0LCA1LCA3LCA4LCA5LCAxMCwgMTAsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMywgMTAsXG4gICAgNSwgNiwgNywgOCwgOSwgMTAsIDEwLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEwLFxuICAgIDcsIDcsIDgsIDksIDksIDEwLCAxMCwgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEzLCA5LFxuICAgIDgsIDgsIDksIDksIDEwLCAxMCwgMTAsIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMiwgOSxcbiAgICA5LCA5LCA5LCAxMCwgMTAsIDEwLCAxMCwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDEzLCA5LFxuICAgIDEwLCA5LCAxMCwgMTAsIDEwLCAxMCwgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEyLCAxMiwgOSxcbiAgICAxMCwgMTAsIDEwLCAxMCwgMTAsIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEzLCA5LFxuICAgIDExLCAxMCwgMTAsIDEwLCAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEwLFxuICAgIDExLCAxMSwgMTEsIDExLCAxMSwgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEwLFxuICAgIDExLCAxMSwgMTEsIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDEwLFxuICAgIDEyLCAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTMsIDEwLFxuICAgIDEyLCAxMiwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTMsIDEwLFxuICAgIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxMywgMTMsIDEwLFxuICAgIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTMsIDEzLCAxMywgMTMsIDEwLFxuICAgIDEzLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxMywgMTMsIDEzLCAxMywgMTMsIDEwLFxuICAgIDksIDksIDksIDksIDksIDksIDksIDksIDksIDksIDksIDEwLCAxMCwgMTAsIDEwLCA2XG5dO1xuXG5UYWJsZXMudDMybCA9IFtcbiAgICAxICsgMCwgNCArIDEsIDQgKyAxLCA1ICsgMiwgNCArIDEsIDYgKyAyLCA1ICsgMiwgNiArIDMsXG4gICAgNCArIDEsIDUgKyAyLCA1ICsgMiwgNiArIDMsIDUgKyAyLCA2ICsgMywgNiArIDMsIDYgKyA0XG5dO1xuXG5UYWJsZXMudDMzbCA9IFtcbiAgICA0ICsgMCwgNCArIDEsIDQgKyAxLCA0ICsgMiwgNCArIDEsIDQgKyAyLCA0ICsgMiwgNCArIDMsXG4gICAgNCArIDEsIDQgKyAyLCA0ICsgMiwgNCArIDMsIDQgKyAyLCA0ICsgMywgNCArIDMsIDQgKyA0XG5dO1xuXG5UYWJsZXMuaHQgPSBbXG4gICAgLyogeGxlbiwgbGlubWF4LCB0YWJsZSwgaGxlbiAqL1xuICAgIG5ldyBIdWZmQ29kZVRhYigwLCAwLCBudWxsLCBudWxsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoMiwgMCwgVGFibGVzLnQxSEIsIFRhYmxlcy50MWwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYigzLCAwLCBUYWJsZXMudDJIQiwgVGFibGVzLnQybCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDMsIDAsIFRhYmxlcy50M0hCLCBUYWJsZXMudDNsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoMCwgMCwgbnVsbCwgbnVsbCksIC8qIEFwcGFyZW50bHkgbm90IHVzZWQgKi9cbiAgICBuZXcgSHVmZkNvZGVUYWIoNCwgMCwgVGFibGVzLnQ1SEIsIFRhYmxlcy50NWwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYig0LCAwLCBUYWJsZXMudDZIQiwgVGFibGVzLnQ2bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDYsIDAsIFRhYmxlcy50N0hCLCBUYWJsZXMudDdsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoNiwgMCwgVGFibGVzLnQ4SEIsIFRhYmxlcy50OGwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYig2LCAwLCBUYWJsZXMudDlIQiwgVGFibGVzLnQ5bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDgsIDAsIFRhYmxlcy50MTBIQiwgVGFibGVzLnQxMGwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYig4LCAwLCBUYWJsZXMudDExSEIsIFRhYmxlcy50MTFsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoOCwgMCwgVGFibGVzLnQxMkhCLCBUYWJsZXMudDEybCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDE2LCAwLCBUYWJsZXMudDEzSEIsIFRhYmxlcy50MTNsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoMCwgMCwgbnVsbCwgVGFibGVzLnQxNl81bCksIC8qIEFwcGFyZW50bHkgbm90IHVzZWQgKi9cbiAgICBuZXcgSHVmZkNvZGVUYWIoMTYsIDAsIFRhYmxlcy50MTVIQiwgVGFibGVzLnQxNWwpLFxuXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDEsIDEsIFRhYmxlcy50MTZIQiwgVGFibGVzLnQxNmwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYigyLCAzLCBUYWJsZXMudDE2SEIsIFRhYmxlcy50MTZsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoMywgNywgVGFibGVzLnQxNkhCLCBUYWJsZXMudDE2bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDQsIDE1LCBUYWJsZXMudDE2SEIsIFRhYmxlcy50MTZsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoNiwgNjMsIFRhYmxlcy50MTZIQiwgVGFibGVzLnQxNmwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYig4LCAyNTUsIFRhYmxlcy50MTZIQiwgVGFibGVzLnQxNmwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYigxMCwgMTAyMywgVGFibGVzLnQxNkhCLCBUYWJsZXMudDE2bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDEzLCA4MTkxLCBUYWJsZXMudDE2SEIsIFRhYmxlcy50MTZsKSxcblxuICAgIG5ldyBIdWZmQ29kZVRhYig0LCAxNSwgVGFibGVzLnQyNEhCLCBUYWJsZXMudDI0bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDUsIDMxLCBUYWJsZXMudDI0SEIsIFRhYmxlcy50MjRsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoNiwgNjMsIFRhYmxlcy50MjRIQiwgVGFibGVzLnQyNGwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYig3LCAxMjcsIFRhYmxlcy50MjRIQiwgVGFibGVzLnQyNGwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYig4LCAyNTUsIFRhYmxlcy50MjRIQiwgVGFibGVzLnQyNGwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYig5LCA1MTEsIFRhYmxlcy50MjRIQiwgVGFibGVzLnQyNGwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYigxMSwgMjA0NywgVGFibGVzLnQyNEhCLCBUYWJsZXMudDI0bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDEzLCA4MTkxLCBUYWJsZXMudDI0SEIsIFRhYmxlcy50MjRsKSxcblxuICAgIG5ldyBIdWZmQ29kZVRhYigwLCAwLCBUYWJsZXMudDMySEIsIFRhYmxlcy50MzJsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoMCwgMCwgVGFibGVzLnQzM0hCLCBUYWJsZXMudDMzbCksXG5dO1xuXG4vKipcbiAqIDxDT0RFPlxuICogIGZvciAoaSA9IDA7IGkgPCAxNioxNjsgaSsrKSBbXG4gKiAgICAgIGxhcmdldGJsW2ldID0gKChodFsxNl0uaGxlbltpXSkgPDwgMTYpICsgaHRbMjRdLmhsZW5baV07XG4gKiAgXVxuICogPC9DT0RFPlxuICpcbiAqL1xuVGFibGVzLmxhcmdldGJsID0gW1xuICAgIDB4MDEwMDA0LCAweDA1MDAwNSwgMHgwNzAwMDcsIDB4MDkwMDA4LCAweDBhMDAwOSwgMHgwYTAwMGEsIDB4MGIwMDBhLCAweDBiMDAwYixcbiAgICAweDBjMDAwYiwgMHgwYzAwMGMsIDB4MGMwMDBjLCAweDBkMDAwYywgMHgwZDAwMGMsIDB4MGQwMDBjLCAweDBlMDAwZCwgMHgwYTAwMGEsXG4gICAgMHgwNDAwMDUsIDB4MDYwMDA2LCAweDA4MDAwNywgMHgwOTAwMDgsIDB4MGEwMDA5LCAweDBiMDAwYSwgMHgwYjAwMGEsIDB4MGIwMDBiLFxuICAgIDB4MGMwMDBiLCAweDBjMDAwYiwgMHgwYzAwMGMsIDB4MGQwMDBjLCAweDBlMDAwYywgMHgwZDAwMGMsIDB4MGUwMDBjLCAweDBhMDAwYSxcbiAgICAweDA3MDAwNywgMHgwODAwMDcsIDB4MDkwMDA4LCAweDBhMDAwOSwgMHgwYjAwMDksIDB4MGIwMDBhLCAweDBjMDAwYSwgMHgwYzAwMGIsXG4gICAgMHgwZDAwMGIsIDB4MGMwMDBiLCAweDBkMDAwYiwgMHgwZDAwMGMsIDB4MGQwMDBjLCAweDBlMDAwYywgMHgwZTAwMGQsIDB4MGIwMDA5LFxuICAgIDB4MDkwMDA4LCAweDA5MDAwOCwgMHgwYTAwMDksIDB4MGIwMDA5LCAweDBiMDAwYSwgMHgwYzAwMGEsIDB4MGMwMDBhLCAweDBjMDAwYixcbiAgICAweDBkMDAwYiwgMHgwZDAwMGIsIDB4MGUwMDBiLCAweDBlMDAwYywgMHgwZTAwMGMsIDB4MGYwMDBjLCAweDBmMDAwYywgMHgwYzAwMDksXG4gICAgMHgwYTAwMDksIDB4MGEwMDA5LCAweDBiMDAwOSwgMHgwYjAwMGEsIDB4MGMwMDBhLCAweDBjMDAwYSwgMHgwZDAwMGEsIDB4MGQwMDBiLFxuICAgIDB4MGQwMDBiLCAweDBlMDAwYiwgMHgwZTAwMGMsIDB4MGUwMDBjLCAweDBmMDAwYywgMHgwZjAwMGMsIDB4MGYwMDBkLCAweDBiMDAwOSxcbiAgICAweDBhMDAwYSwgMHgwYTAwMDksIDB4MGIwMDBhLCAweDBiMDAwYSwgMHgwYzAwMGEsIDB4MGQwMDBhLCAweDBkMDAwYiwgMHgwZTAwMGIsXG4gICAgMHgwZDAwMGIsIDB4MGUwMDBiLCAweDBlMDAwYywgMHgwZjAwMGMsIDB4MGYwMDBjLCAweDBmMDAwYywgMHgxMDAwMGMsIDB4MGMwMDA5LFxuICAgIDB4MGIwMDBhLCAweDBiMDAwYSwgMHgwYjAwMGEsIDB4MGMwMDBhLCAweDBkMDAwYSwgMHgwZDAwMGIsIDB4MGQwMDBiLCAweDBkMDAwYixcbiAgICAweDBlMDAwYiwgMHgwZTAwMGMsIDB4MGUwMDBjLCAweDBlMDAwYywgMHgwZjAwMGMsIDB4MGYwMDBjLCAweDEwMDAwZCwgMHgwYzAwMDksXG4gICAgMHgwYjAwMGIsIDB4MGIwMDBhLCAweDBjMDAwYSwgMHgwYzAwMGEsIDB4MGQwMDBiLCAweDBkMDAwYiwgMHgwZDAwMGIsIDB4MGUwMDBiLFxuICAgIDB4MGUwMDBjLCAweDBmMDAwYywgMHgwZjAwMGMsIDB4MGYwMDBjLCAweDBmMDAwYywgMHgxMTAwMGQsIDB4MTEwMDBkLCAweDBjMDAwYSxcbiAgICAweDBiMDAwYiwgMHgwYzAwMGIsIDB4MGMwMDBiLCAweDBkMDAwYiwgMHgwZDAwMGIsIDB4MGQwMDBiLCAweDBlMDAwYiwgMHgwZTAwMGIsXG4gICAgMHgwZjAwMGIsIDB4MGYwMDBjLCAweDBmMDAwYywgMHgwZjAwMGMsIDB4MTAwMDBjLCAweDEwMDAwZCwgMHgxMDAwMGQsIDB4MGMwMDBhLFxuICAgIDB4MGMwMDBiLCAweDBjMDAwYiwgMHgwYzAwMGIsIDB4MGQwMDBiLCAweDBkMDAwYiwgMHgwZTAwMGIsIDB4MGUwMDBiLCAweDBmMDAwYyxcbiAgICAweDBmMDAwYywgMHgwZjAwMGMsIDB4MGYwMDBjLCAweDEwMDAwYywgMHgwZjAwMGQsIDB4MTAwMDBkLCAweDBmMDAwZCwgMHgwZDAwMGEsXG4gICAgMHgwYzAwMGMsIDB4MGQwMDBiLCAweDBjMDAwYiwgMHgwZDAwMGIsIDB4MGUwMDBiLCAweDBlMDAwYywgMHgwZTAwMGMsIDB4MGUwMDBjLFxuICAgIDB4MGYwMDBjLCAweDEwMDAwYywgMHgxMDAwMGMsIDB4MTAwMDBkLCAweDExMDAwZCwgMHgxMTAwMGQsIDB4MTAwMDBkLCAweDBjMDAwYSxcbiAgICAweDBkMDAwYywgMHgwZDAwMGMsIDB4MGQwMDBiLCAweDBkMDAwYiwgMHgwZTAwMGIsIDB4MGUwMDBjLCAweDBmMDAwYywgMHgxMDAwMGMsXG4gICAgMHgxMDAwMGMsIDB4MTAwMDBjLCAweDEwMDAwYywgMHgxMDAwMGQsIDB4MTAwMDBkLCAweDBmMDAwZCwgMHgxMDAwMGQsIDB4MGQwMDBhLFxuICAgIDB4MGQwMDBjLCAweDBlMDAwYywgMHgwZTAwMGMsIDB4MGUwMDBjLCAweDBlMDAwYywgMHgwZjAwMGMsIDB4MGYwMDBjLCAweDBmMDAwYyxcbiAgICAweDBmMDAwYywgMHgxMTAwMGMsIDB4MTAwMDBkLCAweDEwMDAwZCwgMHgxMDAwMGQsIDB4MTAwMDBkLCAweDEyMDAwZCwgMHgwZDAwMGEsXG4gICAgMHgwZjAwMGMsIDB4MGUwMDBjLCAweDBlMDAwYywgMHgwZTAwMGMsIDB4MGYwMDBjLCAweDBmMDAwYywgMHgxMDAwMGMsIDB4MTAwMDBjLFxuICAgIDB4MTAwMDBkLCAweDEyMDAwZCwgMHgxMTAwMGQsIDB4MTEwMDBkLCAweDExMDAwZCwgMHgxMzAwMGQsIDB4MTEwMDBkLCAweDBkMDAwYSxcbiAgICAweDBlMDAwZCwgMHgwZjAwMGMsIDB4MGQwMDBjLCAweDBlMDAwYywgMHgxMDAwMGMsIDB4MTAwMDBjLCAweDBmMDAwYywgMHgxMDAwMGQsXG4gICAgMHgxMDAwMGQsIDB4MTEwMDBkLCAweDEyMDAwZCwgMHgxMTAwMGQsIDB4MTMwMDBkLCAweDExMDAwZCwgMHgxMDAwMGQsIDB4MGQwMDBhLFxuICAgIDB4MGEwMDA5LCAweDBhMDAwOSwgMHgwYTAwMDksIDB4MGIwMDA5LCAweDBiMDAwOSwgMHgwYzAwMDksIDB4MGMwMDA5LCAweDBjMDAwOSxcbiAgICAweDBkMDAwOSwgMHgwZDAwMDksIDB4MGQwMDA5LCAweDBkMDAwYSwgMHgwZDAwMGEsIDB4MGQwMDBhLCAweDBkMDAwYSwgMHgwYTAwMDZcbl07XG4vKipcbiAqIDxDT0RFPlxuICogIGZvciAoaSA9IDA7IGkgPCAzKjM7IGkrKykgW1xuICogICAgICB0YWJsZTIzW2ldID0gKChodFsyXS5obGVuW2ldKSA8PCAxNikgKyBodFszXS5obGVuW2ldO1xuICogIF1cbiAqIDwvQ09ERT5cbiAqXG4gKi9cblRhYmxlcy50YWJsZTIzID0gW1xuICAgIDB4MDEwMDAyLCAweDA0MDAwMywgMHgwNzAwMDcsXG4gICAgMHgwNDAwMDQsIDB4MDUwMDA0LCAweDA3MDAwNyxcbiAgICAweDA2MDAwNiwgMHgwNzAwMDcsIDB4MDgwMDA4XG5dO1xuXG4vKipcbiAqIDxDT0RFPlxuICogIGZvciAoaSA9IDA7IGkgPCA0KjQ7IGkrKykgW1xuICogICAgICAgdGFibGU1NltpXSA9ICgoaHRbNV0uaGxlbltpXSkgPDwgMTYpICsgaHRbNl0uaGxlbltpXTtcbiAqICAgXVxuICogPC9DT0RFPlxuICpcbiAqL1xuVGFibGVzLnRhYmxlNTYgPSBbXG4gICAgMHgwMTAwMDMsIDB4MDQwMDA0LCAweDA3MDAwNiwgMHgwODAwMDgsIDB4MDQwMDA0LCAweDA1MDAwNCwgMHgwODAwMDYsIDB4MDkwMDA3LFxuICAgIDB4MDcwMDA1LCAweDA4MDAwNiwgMHgwOTAwMDcsIDB4MGEwMDA4LCAweDA4MDAwNywgMHgwODAwMDcsIDB4MDkwMDA4LCAweDBhMDAwOVxuXTtcblxuVGFibGVzLmJpdHJhdGVfdGFibGUgPSBbXG4gICAgWzAsIDgsIDE2LCAyNCwgMzIsIDQwLCA0OCwgNTYsIDY0LCA4MCwgOTYsIDExMiwgMTI4LCAxNDQsIDE2MCwgLTFdLCAvKiBNUEVHIDIgKi9cbiAgICBbMCwgMzIsIDQwLCA0OCwgNTYsIDY0LCA4MCwgOTYsIDExMiwgMTI4LCAxNjAsIDE5MiwgMjI0LCAyNTYsIDMyMCwgLTFdLCAvKiBNUEVHIDEgKi9cbiAgICBbMCwgOCwgMTYsIDI0LCAzMiwgNDAsIDQ4LCA1NiwgNjQsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xXSwgLyogTVBFRyAyLjUgKi9cbl07XG5cbi8qKlxuICogTVBFRyAyLCBNUEVHIDEsIE1QRUcgMi41LlxuICovXG5UYWJsZXMuc2FtcGxlcmF0ZV90YWJsZSA9IFtcbiAgICBbMjIwNTAsIDI0MDAwLCAxNjAwMCwgLTFdLFxuICAgIFs0NDEwMCwgNDgwMDAsIDMyMDAwLCAtMV0sXG4gICAgWzExMDI1LCAxMjAwMCwgODAwMCwgLTFdLFxuXTtcblxuLyoqXG4gKiBUaGlzIGlzIHRoZSBzY2ZzaV9iYW5kIHRhYmxlIGZyb20gMi40LjIuNyBvZiB0aGUgSVMuXG4gKi9cblRhYmxlcy5zY2ZzaV9iYW5kID0gWzAsIDYsIDExLCAxNiwgMjFdO1xuXG5mdW5jdGlvbiBNZWFuQml0cyhtZWFuQml0cykge1xuICAgIHRoaXMuYml0cyA9IG1lYW5CaXRzO1xufVxuXG4vL3BhY2thZ2UgbXAzO1xuXG5mdW5jdGlvbiBDYWxjTm9pc2VSZXN1bHQoKSB7XG4gICAgLyoqXG4gICAgICogc3VtIG9mIHF1YW50aXphdGlvbiBub2lzZSA+IG1hc2tpbmdcbiAgICAgKi9cbiAgICB0aGlzLm92ZXJfbm9pc2UgPSAwLjtcbiAgICAvKipcbiAgICAgKiBzdW0gb2YgYWxsIHF1YW50aXphdGlvbiBub2lzZVxuICAgICAqL1xuICAgIHRoaXMudG90X25vaXNlID0gMC47XG4gICAgLyoqXG4gICAgICogbWF4IHF1YW50aXphdGlvbiBub2lzZVxuICAgICAqL1xuICAgIHRoaXMubWF4X25vaXNlID0gMC47XG4gICAgLyoqXG4gICAgICogbnVtYmVyIG9mIHF1YW50aXphdGlvbiBub2lzZSA+IG1hc2tpbmdcbiAgICAgKi9cbiAgICB0aGlzLm92ZXJfY291bnQgPSAwO1xuICAgIC8qKlxuICAgICAqIFNTRC1saWtlIGNvc3Qgb2YgZGlzdG9ydGVkIGJhbmRzXG4gICAgICovXG4gICAgdGhpcy5vdmVyX1NTRCA9IDA7XG4gICAgdGhpcy5iaXRzID0gMDtcbn1cblxuZnVuY3Rpb24gVkJSUXVhbnRpemUoKSB7XG4gICAgdmFyIHF1cHZ0O1xuICAgIHZhciB0YWs7XG5cbiAgICB0aGlzLnNldE1vZHVsZXMgPSBmdW5jdGlvbiAoX3F1cHZ0LCBfdGspIHtcbiAgICAgICAgcXVwdnQgPSBfcXVwdnQ7XG4gICAgICAgIHRhayA9IF90aztcbiAgICB9XG4gICAgLy9UT0RPXG5cbn1cblxuXG5cbi8qKlxuICogQVRIIHJlbGF0ZWQgc3R1ZmYsIGlmIHNvbWV0aGluZyBuZXcgQVRIIHJlbGF0ZWQgaGFzIHRvIGJlIGFkZGVkLCBwbGVhc2UgcGx1Z1xuICogaXQgaGVyZSBpbnRvIHRoZSBBVEguXG4gKi9cbmZ1bmN0aW9uIEFUSCgpIHtcbiAgICAvKipcbiAgICAgKiBNZXRob2QgZm9yIHRoZSBhdXRvIGFkanVzdG1lbnQuXG4gICAgICovXG4gICAgdGhpcy51c2VBZGp1c3QgPSAwO1xuICAgIC8qKlxuICAgICAqIGZhY3RvciBmb3IgdHVuaW5nIHRoZSAoc2FtcGxlIHBvd2VyKSBwb2ludCBiZWxvdyB3aGljaCBhZGFwdGl2ZSB0aHJlc2hvbGRcbiAgICAgKiBvZiBoZWFyaW5nIGFkanVzdG1lbnQgb2NjdXJzXG4gICAgICovXG4gICAgdGhpcy5hYVNlbnNpdGl2aXR5UCA9IDAuO1xuICAgIC8qKlxuICAgICAqIExvd2VyaW5nIGJhc2VkIG9uIHBlYWsgdm9sdW1lLCAxID0gbm8gbG93ZXJpbmcuXG4gICAgICovXG4gICAgdGhpcy5hZGp1c3QgPSAwLjtcbiAgICAvKipcbiAgICAgKiBMaW1pdCBmb3IgZHluYW1pYyBBVEggYWRqdXN0LlxuICAgICAqL1xuICAgIHRoaXMuYWRqdXN0TGltaXQgPSAwLjtcbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmVkIHRvIGxvd2VyIHggZEIgZWFjaCBzZWNvbmQuXG4gICAgICovXG4gICAgdGhpcy5kZWNheSA9IDAuO1xuICAgIC8qKlxuICAgICAqIExvd2VzdCBBVEggdmFsdWUuXG4gICAgICovXG4gICAgdGhpcy5mbG9vciA9IDAuO1xuICAgIC8qKlxuICAgICAqIEFUSCBmb3Igc2ZicyBpbiBsb25nIGJsb2Nrcy5cbiAgICAgKi9cbiAgICB0aGlzLmwgPSBuZXdfZmxvYXQoRW5jb2Rlci5TQk1BWF9sKTtcbiAgICAvKipcbiAgICAgKiBBVEggZm9yIHNmYnMgaW4gc2hvcnQgYmxvY2tzLlxuICAgICAqL1xuICAgIHRoaXMucyA9IG5ld19mbG9hdChFbmNvZGVyLlNCTUFYX3MpO1xuICAgIC8qKlxuICAgICAqIEFUSCBmb3IgcGFydGl0aW9uZWQgc2ZiMjEgaW4gbG9uZyBibG9ja3MuXG4gICAgICovXG4gICAgdGhpcy5wc2ZiMjEgPSBuZXdfZmxvYXQoRW5jb2Rlci5QU0ZCMjEpO1xuICAgIC8qKlxuICAgICAqIEFUSCBmb3IgcGFydGl0aW9uZWQgc2ZiMTIgaW4gc2hvcnQgYmxvY2tzLlxuICAgICAqL1xuICAgIHRoaXMucHNmYjEyID0gbmV3X2Zsb2F0KEVuY29kZXIuUFNGQjEyKTtcbiAgICAvKipcbiAgICAgKiBBVEggZm9yIGxvbmcgYmxvY2sgY29udm9sdXRpb24gYmFuZHMuXG4gICAgICovXG4gICAgdGhpcy5jYl9sID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTKTtcbiAgICAvKipcbiAgICAgKiBBVEggZm9yIHNob3J0IGJsb2NrIGNvbnZvbHV0aW9uIGJhbmRzLlxuICAgICAqL1xuICAgIHRoaXMuY2JfcyA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyk7XG4gICAgLyoqXG4gICAgICogRXF1YWwgbG91ZG5lc3Mgd2VpZ2h0cyAoYmFzZWQgb24gQVRIKS5cbiAgICAgKi9cbiAgICB0aGlzLmVxbF93ID0gbmV3X2Zsb2F0KEVuY29kZXIuQkxLU0laRSAvIDIpO1xufVxuXG5cbmZ1bmN0aW9uIExhbWVHbG9iYWxGbGFncygpIHtcblxuICAgIHRoaXMuY2xhc3NfaWQgPSAwO1xuXG4gICAgLyogaW5wdXQgZGVzY3JpcHRpb24gKi9cblxuICAgIC8qKlxuICAgICAqIG51bWJlciBvZiBzYW1wbGVzLiBkZWZhdWx0PS0xXG4gICAgICovXG4gICAgdGhpcy5udW1fc2FtcGxlcyA9IDA7XG4gICAgLyoqXG4gICAgICogaW5wdXQgbnVtYmVyIG9mIGNoYW5uZWxzLiBkZWZhdWx0PTJcbiAgICAgKi9cbiAgICB0aGlzLm51bV9jaGFubmVscyA9IDA7XG4gICAgLyoqXG4gICAgICogaW5wdXRfc2FtcF9yYXRlIGluIEh6LiBkZWZhdWx0PTQ0LjEga0h6XG4gICAgICovXG4gICAgdGhpcy5pbl9zYW1wbGVyYXRlID0gMDtcbiAgICAvKipcbiAgICAgKiBvdXRwdXRfc2FtcF9yYXRlLiBkZWZhdWx0OiBMQU1FIHBpY2tzIGJlc3QgdmFsdWUgYXQgbGVhc3Qgbm90IHVzZWQgZm9yXG4gICAgICogTVAzIGRlY29kaW5nOiBSZW1lbWJlciA0NC4xIGtIeiBNUDNzIGFuZCBBQzk3XG4gICAgICovXG4gICAgdGhpcy5vdXRfc2FtcGxlcmF0ZSA9IDA7XG4gICAgLyoqXG4gICAgICogc2NhbGUgaW5wdXQgYnkgdGhpcyBhbW91bnQgYmVmb3JlIGVuY29kaW5nIGF0IGxlYXN0IG5vdCB1c2VkIGZvciBNUDNcbiAgICAgKiBkZWNvZGluZ1xuICAgICAqL1xuICAgIHRoaXMuc2NhbGUgPSAwLjtcbiAgICAvKipcbiAgICAgKiBzY2FsZSBpbnB1dCBvZiBjaGFubmVsIDAgKGxlZnQpIGJ5IHRoaXMgYW1vdW50IGJlZm9yZSBlbmNvZGluZ1xuICAgICAqL1xuICAgIHRoaXMuc2NhbGVfbGVmdCA9IDAuO1xuICAgIC8qKlxuICAgICAqIHNjYWxlIGlucHV0IG9mIGNoYW5uZWwgMSAocmlnaHQpIGJ5IHRoaXMgYW1vdW50IGJlZm9yZSBlbmNvZGluZ1xuICAgICAqL1xuICAgIHRoaXMuc2NhbGVfcmlnaHQgPSAwLjtcblxuICAgIC8qIGdlbmVyYWwgY29udHJvbCBwYXJhbXMgKi9cbiAgICAvKipcbiAgICAgKiBjb2xsZWN0IGRhdGEgZm9yIGEgTVAzIGZyYW1lIGFuYWx5emVyP1xuICAgICAqL1xuICAgIHRoaXMuYW5hbHlzaXMgPSBmYWxzZTtcbiAgICAvKipcbiAgICAgKiBhZGQgWGluZyBWQlIgdGFnP1xuICAgICAqL1xuICAgIHRoaXMuYldyaXRlVmJyVGFnID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiB1c2UgbGFtZS9tcGdsaWIgdG8gY29udmVydCBtcDMgdG8gd2F2XG4gICAgICovXG4gICAgdGhpcy5kZWNvZGVfb25seSA9IGZhbHNlO1xuICAgIC8qKlxuICAgICAqIHF1YWxpdHkgc2V0dGluZyAwPWJlc3QsIDk9d29yc3QgZGVmYXVsdD01XG4gICAgICovXG4gICAgdGhpcy5xdWFsaXR5ID0gMDtcbiAgICAvKipcbiAgICAgKiBzZWUgZW51bSBkZWZhdWx0ID0gTEFNRSBwaWNrcyBiZXN0IHZhbHVlXG4gICAgICovXG4gICAgdGhpcy5tb2RlID0gTVBFR01vZGUuU1RFUkVPO1xuICAgIC8qKlxuICAgICAqIGZvcmNlIE0vUyBtb2RlLiByZXF1aXJlcyBtb2RlPTFcbiAgICAgKi9cbiAgICB0aGlzLmZvcmNlX21zID0gZmFsc2U7XG4gICAgLyoqXG4gICAgICogdXNlIGZyZWUgZm9ybWF0PyBkZWZhdWx0PTBcbiAgICAgKi9cbiAgICB0aGlzLmZyZWVfZm9ybWF0ID0gZmFsc2U7XG4gICAgLyoqXG4gICAgICogZmluZCB0aGUgUkcgdmFsdWU/IGRlZmF1bHQ9MFxuICAgICAqL1xuICAgIHRoaXMuZmluZFJlcGxheUdhaW4gPSBmYWxzZTtcbiAgICAvKipcbiAgICAgKiBkZWNvZGUgb24gdGhlIGZseT8gZGVmYXVsdD0wXG4gICAgICovXG4gICAgdGhpcy5kZWNvZGVfb25fdGhlX2ZseSA9IGZhbHNlO1xuICAgIC8qKlxuICAgICAqIDEgKGRlZmF1bHQpIHdyaXRlcyBJRDMgdGFncywgMCBub3RcbiAgICAgKi9cbiAgICB0aGlzLndyaXRlX2lkM3RhZ19hdXRvbWF0aWMgPSBmYWxzZTtcblxuICAgIC8qXG4gICAgICogc2V0IGVpdGhlciBicmF0ZT4wIG9yIGNvbXByZXNzaW9uX3JhdGlvPjAsIExBTUUgd2lsbCBjb21wdXRlIHRoZSB2YWx1ZSBvZlxuICAgICAqIHRoZSB2YXJpYWJsZSBub3Qgc2V0LiBEZWZhdWx0IGlzIGNvbXByZXNzaW9uX3JhdGlvID0gMTEuMDI1XG4gICAgICovXG4gICAgLyoqXG4gICAgICogYml0cmF0ZVxuICAgICAqL1xuICAgIHRoaXMuYnJhdGUgPSAwO1xuICAgIC8qKlxuICAgICAqIHNpemVvZih3YXYgZmlsZSkvc2l6ZW9mKG1wMyBmaWxlKVxuICAgICAqL1xuICAgIHRoaXMuY29tcHJlc3Npb25fcmF0aW8gPSAwLjtcblxuICAgIC8qIGZyYW1lIHBhcmFtcyAqL1xuICAgIC8qKlxuICAgICAqIG1hcmsgYXMgY29weXJpZ2h0LiBkZWZhdWx0PTBcbiAgICAgKi9cbiAgICB0aGlzLmNvcHlyaWdodCA9IDA7XG4gICAgLyoqXG4gICAgICogbWFyayBhcyBvcmlnaW5hbC4gZGVmYXVsdD0xXG4gICAgICovXG4gICAgdGhpcy5vcmlnaW5hbCA9IDA7XG4gICAgLyoqXG4gICAgICogdGhlIE1QMyAncHJpdmF0ZSBleHRlbnNpb24nIGJpdC4gTWVhbmluZ2xlc3NcbiAgICAgKi9cbiAgICB0aGlzLmV4dGVuc2lvbiA9IDA7XG4gICAgLyoqXG4gICAgICogSW5wdXQgUENNIGlzIGVtcGhhc2VkIFBDTSAoZm9yIGluc3RhbmNlIGZyb20gb25lIG9mIHRoZSByYXJlbHkgZW1waGFzZWRcbiAgICAgKiBDRHMpLCBpdCBpcyBTVFJPTkdMWSBub3QgcmVjb21tZW5kZWQgdG8gdXNlIHRoaXMsIGJlY2F1c2UgcHN5Y2hvIGRvZXMgbm90XG4gICAgICogdGFrZSBpdCBpbnRvIGFjY291bnQsIGFuZCBsYXN0IGJ1dCBub3QgbGVhc3QgbWFueSBkZWNvZGVycyBkb24ndCBjYXJlXG4gICAgICogYWJvdXQgdGhlc2UgYml0c1xuICAgICAqL1xuICAgIHRoaXMuZW1waGFzaXMgPSAwO1xuICAgIC8qKlxuICAgICAqIHVzZSAyIGJ5dGVzIHBlciBmcmFtZSBmb3IgYSBDUkMgY2hlY2tzdW0uIGRlZmF1bHQ9MFxuICAgICAqL1xuICAgIHRoaXMuZXJyb3JfcHJvdGVjdGlvbiA9IDA7XG4gICAgLyoqXG4gICAgICogZW5mb3JjZSBJU08gc3BlYyBhcyBtdWNoIGFzIHBvc3NpYmxlXG4gICAgICovXG4gICAgdGhpcy5zdHJpY3RfSVNPID0gZmFsc2U7XG5cbiAgICAvKipcbiAgICAgKiB1c2UgYml0IHJlc2Vydm9pcj9cbiAgICAgKi9cbiAgICB0aGlzLmRpc2FibGVfcmVzZXJ2b2lyID0gZmFsc2U7XG5cbiAgICAvKiBxdWFudGl6YXRpb24vbm9pc2Ugc2hhcGluZyAqL1xuICAgIHRoaXMucXVhbnRfY29tcCA9IDA7XG4gICAgdGhpcy5xdWFudF9jb21wX3Nob3J0ID0gMDtcbiAgICB0aGlzLmV4cGVyaW1lbnRhbFkgPSBmYWxzZTtcbiAgICB0aGlzLmV4cGVyaW1lbnRhbFogPSAwO1xuICAgIHRoaXMuZXhwX25zcHN5dHVuZSA9IDA7XG5cbiAgICB0aGlzLnByZXNldCA9IDA7XG5cbiAgICAvKiBWQlIgY29udHJvbCAqL1xuICAgIHRoaXMuVkJSID0gbnVsbDtcbiAgICAvKipcbiAgICAgKiBSYW5nZSBbMCwuLi4sMVtcbiAgICAgKi9cbiAgICB0aGlzLlZCUl9xX2ZyYWMgPSAwLjtcbiAgICAvKipcbiAgICAgKiBSYW5nZSBbMCwuLi4sOV1cbiAgICAgKi9cbiAgICB0aGlzLlZCUl9xID0gMDtcbiAgICB0aGlzLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyA9IDA7XG4gICAgdGhpcy5WQlJfbWluX2JpdHJhdGVfa2JwcyA9IDA7XG4gICAgdGhpcy5WQlJfbWF4X2JpdHJhdGVfa2JwcyA9IDA7XG4gICAgLyoqXG4gICAgICogc3RyaWN0bHkgZW5mb3JjZSBWQlJfbWluX2JpdHJhdGUgbm9ybWFseSwgaXQgd2lsbCBiZSB2aW9sYXRlZCBmb3IgYW5hbG9nXG4gICAgICogc2lsZW5jZVxuICAgICAqL1xuICAgIHRoaXMuVkJSX2hhcmRfbWluID0gMDtcblxuICAgIC8qIHJlc2FtcGxpbmcgYW5kIGZpbHRlcmluZyAqL1xuXG4gICAgLyoqXG4gICAgICogZnJlcSBpbiBIei4gMD1sYW1lIGNob3Nlcy4gLTE9bm8gZmlsdGVyXG4gICAgICovXG4gICAgdGhpcy5sb3dwYXNzZnJlcSA9IDA7XG4gICAgLyoqXG4gICAgICogZnJlcSBpbiBIei4gMD1sYW1lIGNob3Nlcy4gLTE9bm8gZmlsdGVyXG4gICAgICovXG4gICAgdGhpcy5oaWdocGFzc2ZyZXEgPSAwO1xuICAgIC8qKlxuICAgICAqIGZyZXEgd2lkdGggb2YgZmlsdGVyLCBpbiBIeiAoZGVmYXVsdD0xNSUpXG4gICAgICovXG4gICAgdGhpcy5sb3dwYXNzd2lkdGggPSAwO1xuICAgIC8qKlxuICAgICAqIGZyZXEgd2lkdGggb2YgZmlsdGVyLCBpbiBIeiAoZGVmYXVsdD0xNSUpXG4gICAgICovXG4gICAgdGhpcy5oaWdocGFzc3dpZHRoID0gMDtcblxuICAgIC8qXG4gICAgICogcHN5Y2hvIGFjb3VzdGljcyBhbmQgb3RoZXIgYXJndW1lbnRzIHdoaWNoIHlvdSBzaG91bGQgbm90IGNoYW5nZSB1bmxlc3NcbiAgICAgKiB5b3Uga25vdyB3aGF0IHlvdSBhcmUgZG9pbmdcbiAgICAgKi9cblxuICAgIHRoaXMubWFza2luZ2FkanVzdCA9IDAuO1xuICAgIHRoaXMubWFza2luZ2FkanVzdF9zaG9ydCA9IDAuO1xuICAgIC8qKlxuICAgICAqIG9ubHkgdXNlIEFUSFxuICAgICAqL1xuICAgIHRoaXMuQVRIb25seSA9IGZhbHNlO1xuICAgIC8qKlxuICAgICAqIG9ubHkgdXNlIEFUSCBmb3Igc2hvcnQgYmxvY2tzXG4gICAgICovXG4gICAgdGhpcy5BVEhzaG9ydCA9IGZhbHNlO1xuICAgIC8qKlxuICAgICAqIGRpc2FibGUgQVRIXG4gICAgICovXG4gICAgdGhpcy5ub0FUSCA9IGZhbHNlO1xuICAgIC8qKlxuICAgICAqIHNlbGVjdCBBVEggZm9ybXVsYVxuICAgICAqL1xuICAgIHRoaXMuQVRIdHlwZSA9IDA7XG4gICAgLyoqXG4gICAgICogY2hhbmdlIEFUSCBmb3JtdWxhIDQgc2hhcGVcbiAgICAgKi9cbiAgICB0aGlzLkFUSGN1cnZlID0gMC47XG4gICAgLyoqXG4gICAgICogbG93ZXIgQVRIIGJ5IHRoaXMgbWFueSBkYlxuICAgICAqL1xuICAgIHRoaXMuQVRIbG93ZXIgPSAwLjtcbiAgICAvKipcbiAgICAgKiBzZWxlY3QgQVRIIGF1dG8tYWRqdXN0IHNjaGVtZVxuICAgICAqL1xuICAgIHRoaXMuYXRoYWFfdHlwZSA9IDA7XG4gICAgLyoqXG4gICAgICogc2VsZWN0IEFUSCBhdXRvLWFkanVzdCBsb3VkbmVzcyBjYWxjXG4gICAgICovXG4gICAgdGhpcy5hdGhhYV9sb3VkYXBwcm94ID0gMDtcbiAgICAvKipcbiAgICAgKiBkQiwgdHVuZSBhY3RpdmUgcmVnaW9uIG9mIGF1dG8tbGV2ZWxcbiAgICAgKi9cbiAgICB0aGlzLmF0aGFhX3NlbnNpdGl2aXR5ID0gMC47XG4gICAgdGhpcy5zaG9ydF9ibG9ja3MgPSBudWxsO1xuICAgIC8qKlxuICAgICAqIHVzZSB0ZW1wb3JhbCBtYXNraW5nIGVmZmVjdFxuICAgICAqL1xuICAgIHRoaXMudXNlVGVtcG9yYWwgPSBmYWxzZTtcbiAgICB0aGlzLmludGVyQ2hSYXRpbyA9IDAuO1xuICAgIC8qKlxuICAgICAqIE5hb2tpJ3MgYWRqdXN0bWVudCBvZiBNaWQvU2lkZSBtYXNraW5nc1xuICAgICAqL1xuICAgIHRoaXMubXNmaXggPSAwLjtcblxuICAgIC8qKlxuICAgICAqIDAgb2ZmLCAxIG9uXG4gICAgICovXG4gICAgdGhpcy50dW5lID0gZmFsc2U7XG4gICAgLyoqXG4gICAgICogdXNlZCB0byBwYXNzIHZhbHVlcyBmb3IgZGVidWdnaW5nIGFuZCBzdHVmZlxuICAgICAqL1xuICAgIHRoaXMudHVuZV92YWx1ZV9hID0gMC47XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgIC8qIGludGVybmFsIHZhcmlhYmxlcywgZG8gbm90IHNldC4uLiAqL1xuICAgIC8qIHByb3ZpZGVkIGJlY2F1c2UgdGhleSBtYXkgYmUgb2YgdXNlIHRvIGNhbGxpbmcgYXBwbGljYXRpb24gKi9cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgLyoqXG4gICAgICogMD1NUEVHLTIvMi41IDE9TVBFRy0xXG4gICAgICovXG4gICAgdGhpcy52ZXJzaW9uID0gMDtcbiAgICB0aGlzLmVuY29kZXJfZGVsYXkgPSAwO1xuICAgIC8qKlxuICAgICAqIG51bWJlciBvZiBzYW1wbGVzIG9mIHBhZGRpbmcgYXBwZW5kZWQgdG8gaW5wdXRcbiAgICAgKi9cbiAgICB0aGlzLmVuY29kZXJfcGFkZGluZyA9IDA7XG4gICAgdGhpcy5mcmFtZXNpemUgPSAwO1xuICAgIC8qKlxuICAgICAqIG51bWJlciBvZiBmcmFtZXMgZW5jb2RlZFxuICAgICAqL1xuICAgIHRoaXMuZnJhbWVOdW0gPSAwO1xuICAgIC8qKlxuICAgICAqIGlzIHRoaXMgc3RydWN0IG93bmVkIGJ5IGNhbGxpbmcgcHJvZ3JhbSBvciBsYW1lP1xuICAgICAqL1xuICAgIHRoaXMubGFtZV9hbGxvY2F0ZWRfZ2ZwID0gMDtcbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgLyogbW9yZSBpbnRlcm5hbCB2YXJpYWJsZXMgYXJlIHN0b3JlZCBpbiB0aGlzIHN0cnVjdHVyZTogKi9cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgdGhpcy5pbnRlcm5hbF9mbGFncyA9IG51bGw7XG59XG5cblxuXG5mdW5jdGlvbiBDQlJOZXdJdGVyYXRpb25Mb29wKF9xdWFudGl6ZSkgIHtcbiAgICB2YXIgcXVhbnRpemUgPSBfcXVhbnRpemU7XG4gICAgdGhpcy5xdWFudGl6ZSA9IHF1YW50aXplO1xuXHR0aGlzLml0ZXJhdGlvbl9sb29wID0gZnVuY3Rpb24oZ2ZwLCBwZSwgbXNfZW5lcl9yYXRpbywgcmF0aW8pIHtcblx0XHR2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgbDNfeG1pbiA9IG5ld19mbG9hdChMM1NpZGUuU0ZCTUFYKTtcblx0XHR2YXIgeHJwb3cgPSBuZXdfZmxvYXQoNTc2KTtcblx0XHR2YXIgdGFyZ19iaXRzID0gbmV3X2ludCgyKTtcblx0XHR2YXIgbWVhbl9iaXRzID0gMCwgbWF4X2JpdHM7XG5cdFx0dmFyIGwzX3NpZGUgPSBnZmMubDNfc2lkZTtcblxuXHRcdHZhciBtYiA9IG5ldyBNZWFuQml0cyhtZWFuX2JpdHMpO1xuXHRcdHRoaXMucXVhbnRpemUucnYuUmVzdkZyYW1lQmVnaW4oZ2ZwLCBtYik7XG5cdFx0bWVhbl9iaXRzID0gbWIuYml0cztcblxuXHRcdC8qIHF1YW50aXplISAqL1xuXHRcdGZvciAodmFyIGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuXG5cdFx0XHQvKlxuXHRcdFx0ICogY2FsY3VsYXRlIG5lZWRlZCBiaXRzXG5cdFx0XHQgKi9cblx0XHRcdG1heF9iaXRzID0gdGhpcy5xdWFudGl6ZS5xdXB2dC5vbl9wZShnZnAsIHBlLCB0YXJnX2JpdHMsIG1lYW5fYml0cyxcblx0XHRcdFx0XHRnciwgZ3IpO1xuXG5cdFx0XHRpZiAoZ2ZjLm1vZGVfZXh0ID09IEVuY29kZXIuTVBHX01EX01TX0xSKSB7XG5cdFx0XHRcdHRoaXMucXVhbnRpemUubXNfY29udmVydChnZmMubDNfc2lkZSwgZ3IpO1xuXHRcdFx0XHR0aGlzLnF1YW50aXplLnF1cHZ0LnJlZHVjZV9zaWRlKHRhcmdfYml0cywgbXNfZW5lcl9yYXRpb1tncl0sXG5cdFx0XHRcdFx0XHRtZWFuX2JpdHMsIG1heF9iaXRzKTtcblx0XHRcdH1cblxuXHRcdFx0Zm9yICh2YXIgY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcblx0XHRcdFx0dmFyIGFkanVzdCwgbWFza2luZ19sb3dlcl9kYjtcblx0XHRcdFx0dmFyIGNvZF9pbmZvID0gbDNfc2lkZS50dFtncl1bY2hdO1xuXG5cdFx0XHRcdGlmIChjb2RfaW5mby5ibG9ja190eXBlICE9IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuXHRcdFx0XHRcdC8vIE5PUk0sIFNUQVJUIG9yIFNUT1AgdHlwZVxuXHRcdFx0XHRcdGFkanVzdCA9IDA7XG5cdFx0XHRcdFx0bWFza2luZ19sb3dlcl9kYiA9IGdmYy5QU1kubWFza19hZGp1c3QgLSBhZGp1c3Q7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0YWRqdXN0ID0gMDtcblx0XHRcdFx0XHRtYXNraW5nX2xvd2VyX2RiID0gZ2ZjLlBTWS5tYXNrX2FkanVzdF9zaG9ydCAtIGFkanVzdDtcblx0XHRcdFx0fVxuXHRcdFx0XHRnZmMubWFza2luZ19sb3dlciA9ICBNYXRoLnBvdygxMC4wLFxuXHRcdFx0XHRcdFx0bWFza2luZ19sb3dlcl9kYiAqIDAuMSk7XG5cblx0XHRcdFx0Lypcblx0XHRcdFx0ICogaW5pdF9vdXRlcl9sb29wIHNldHMgdXAgY29kX2luZm8sIHNjYWxlZmFjIGFuZCB4cnBvd1xuXHRcdFx0XHQgKi9cblx0XHRcdFx0dGhpcy5xdWFudGl6ZS5pbml0X291dGVyX2xvb3AoZ2ZjLCBjb2RfaW5mbyk7XG5cdFx0XHRcdGlmICh0aGlzLnF1YW50aXplLmluaXRfeHJwb3coZ2ZjLCBjb2RfaW5mbywgeHJwb3cpKSB7XG5cdFx0XHRcdFx0Lypcblx0XHRcdFx0XHQgKiB4ciBjb250YWlucyBlbmVyZ3kgd2Ugd2lsbCBoYXZlIHRvIGVuY29kZSBjYWxjdWxhdGUgdGhlXG5cdFx0XHRcdFx0ICogbWFza2luZyBhYmlsaXRpZXMgZmluZCBzb21lIGdvb2QgcXVhbnRpemF0aW9uIGluXG5cdFx0XHRcdFx0ICogb3V0ZXJfbG9vcFxuXHRcdFx0XHRcdCAqL1xuXHRcdFx0XHRcdHRoaXMucXVhbnRpemUucXVwdnQuY2FsY194bWluKGdmcCwgcmF0aW9bZ3JdW2NoXSwgY29kX2luZm8sXG5cdFx0XHRcdFx0XHRcdGwzX3htaW4pO1xuXHRcdFx0XHRcdHRoaXMucXVhbnRpemUub3V0ZXJfbG9vcChnZnAsIGNvZF9pbmZvLCBsM194bWluLCB4cnBvdywgY2gsXG5cdFx0XHRcdFx0XHRcdHRhcmdfYml0c1tjaF0pO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0dGhpcy5xdWFudGl6ZS5pdGVyYXRpb25fZmluaXNoX29uZShnZmMsIGdyLCBjaCk7XG5cdFx0XHR9IC8qIGZvciBjaCAqL1xuXHRcdH0gLyogZm9yIGdyICovXG5cblx0XHR0aGlzLnF1YW50aXplLnJ2LlJlc3ZGcmFtZUVuZChnZmMsIG1lYW5fYml0cyk7XG5cdH1cbn1cblxuXG5mdW5jdGlvbiBSZXBsYXlHYWluKCkge1xuXHQvL2ZpeCDnsr7nroBcbn1cblxuLy9wYWNrYWdlIG1wMztcblxuLyoqXG4gKiBMYXllciBJSUkgc2lkZSBpbmZvcm1hdGlvbi5cbiAqXG4gKiBAYXV0aG9yIEtlblxuICpcbiAqL1xuXG5cblxuZnVuY3Rpb24gU2NhbGVGYWMoYXJyTCwgYXJyUywgYXJyMjEsIGFycjEyKSB7XG5cbiAgICB0aGlzLmwgPSBuZXdfaW50KDEgKyBFbmNvZGVyLlNCTUFYX2wpO1xuICAgIHRoaXMucyA9IG5ld19pbnQoMSArIEVuY29kZXIuU0JNQVhfcyk7XG4gICAgdGhpcy5wc2ZiMjEgPSBuZXdfaW50KDEgKyBFbmNvZGVyLlBTRkIyMSk7XG4gICAgdGhpcy5wc2ZiMTIgPSBuZXdfaW50KDEgKyBFbmNvZGVyLlBTRkIxMik7XG4gICAgdmFyIGwgPSB0aGlzLmw7XG4gICAgdmFyIHMgPSB0aGlzLnM7XG5cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PSA0KSB7XG4gICAgICAgIC8vcHVibGljIFNjYWxlRmFjKGZpbmFsIGludFtdIGFyckwsIGZpbmFsIGludFtdIGFyclMsIGZpbmFsIGludFtdIGFycjIxLFxuICAgICAgICAvLyAgICBmaW5hbCBpbnRbXSBhcnIxMikge1xuICAgICAgICB0aGlzLmFyckwgPSBhcmd1bWVudHNbMF07XG4gICAgICAgIHRoaXMuYXJyUyA9IGFyZ3VtZW50c1sxXTtcbiAgICAgICAgdGhpcy5hcnIyMSA9IGFyZ3VtZW50c1syXTtcbiAgICAgICAgdGhpcy5hcnIxMiA9IGFyZ3VtZW50c1szXTtcblxuICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KHRoaXMuYXJyTCwgMCwgbCwgMCwgTWF0aC5taW4odGhpcy5hcnJMLmxlbmd0aCwgdGhpcy5sLmxlbmd0aCkpO1xuICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KHRoaXMuYXJyUywgMCwgcywgMCwgTWF0aC5taW4odGhpcy5hcnJTLmxlbmd0aCwgdGhpcy5zLmxlbmd0aCkpO1xuICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KHRoaXMuYXJyMjEsIDAsIHRoaXMucHNmYjIxLCAwLCBNYXRoLm1pbih0aGlzLmFycjIxLmxlbmd0aCwgdGhpcy5wc2ZiMjEubGVuZ3RoKSk7XG4gICAgICAgIFN5c3RlbS5hcnJheWNvcHkodGhpcy5hcnIxMiwgMCwgdGhpcy5wc2ZiMTIsIDAsIE1hdGgubWluKHRoaXMuYXJyMTIubGVuZ3RoLCB0aGlzLnBzZmIxMi5sZW5ndGgpKTtcbiAgICB9XG59XG5cbi8qXG4gKiAgICAgIHF1YW50aXplX3B2dCBzb3VyY2UgZmlsZVxuICpcbiAqICAgICAgQ29weXJpZ2h0IChjKSAxOTk5LTIwMDIgVGFrZWhpcm8gVG9taW5hZ2FcbiAqICAgICAgQ29weXJpZ2h0IChjKSAyMDAwLTIwMDIgUm9iZXJ0IEhlZ2VtYW5uXG4gKiAgICAgIENvcHlyaWdodCAoYykgMjAwMSBOYW9raSBTaGliYXRhXG4gKiAgICAgIENvcHlyaWdodCAoYykgMjAwMi0yMDA1IEdhYnJpZWwgQm91dmlnbmVcbiAqXG4gKiBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yXG4gKiBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG4gKiBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXJcbiAqIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCxcbiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mXG4gKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVVxuICogTGlicmFyeSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuXG4gKlxuICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpY1xuICogTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCB3cml0ZSB0byB0aGVcbiAqIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgSW5jLiwgNTkgVGVtcGxlIFBsYWNlIC0gU3VpdGUgMzMwLFxuICogQm9zdG9uLCBNQSAwMjExMS0xMzA3LCBVU0EuXG4gKi9cblxuLyogJElkOiBRdWFudGl6ZVBWVC5qYXZhLHYgMS4yNCAyMDExLzA1LzI0IDIwOjQ4OjA2IGtlbmNoaXMgRXhwICQgKi9cblxuXG5RdWFudGl6ZVBWVC5RX01BWCA9ICgyNTYgKyAxKTtcblF1YW50aXplUFZULlFfTUFYMiA9IDExNjtcblF1YW50aXplUFZULkxBUkdFX0JJVFMgPSAxMDAwMDA7XG5RdWFudGl6ZVBWVC5JWE1BWF9WQUwgPSA4MjA2O1xuXG5mdW5jdGlvbiBRdWFudGl6ZVBWVCgpIHtcblxuICAgIHZhciB0YWsgPSBudWxsO1xuICAgIHZhciBydiA9IG51bGw7XG4gICAgdmFyIHBzeSA9IG51bGw7XG5cbiAgICB0aGlzLnNldE1vZHVsZXMgPSBmdW5jdGlvbiAoX3RrLCBfcnYsIF9wc3kpIHtcbiAgICAgICAgdGFrID0gX3RrO1xuICAgICAgICBydiA9IF9ydjtcbiAgICAgICAgcHN5ID0gX3BzeTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gUE9XMjAoeCkge1xuICAgICAgICByZXR1cm4gcG93MjBbeCArIFF1YW50aXplUFZULlFfTUFYMl07XG4gICAgfVxuXG4gICAgdGhpcy5JUE9XMjAgPSBmdW5jdGlvbiAoeCkge1xuICAgICAgICByZXR1cm4gaXBvdzIwW3hdO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHNtYWxsZXN0IHN1Y2ggdGhhdCAxLjArREJMX0VQU0lMT04gIT0gMS4wXG4gICAgICovXG4gICAgdmFyIERCTF9FUFNJTE9OID0gMi4yMjA0NDYwNDkyNTAzMTMxZS0wMTY7XG5cbiAgICAvKipcbiAgICAgKiBpeCBhbHdheXMgPD0gODE5MSsxNS4gc2VlIGNvdW50X2JpdHMoKVxuICAgICAqL1xuICAgIHZhciBJWE1BWF9WQUwgPSBRdWFudGl6ZVBWVC5JWE1BWF9WQUw7XG5cbiAgICB2YXIgUFJFQ0FMQ19TSVpFID0gKElYTUFYX1ZBTCArIDIpO1xuXG4gICAgdmFyIFFfTUFYID0gUXVhbnRpemVQVlQuUV9NQVg7XG5cblxuICAgIC8qKlxuICAgICAqIDxDT0RFPlxuICAgICAqIG1pbmltdW0gcG9zc2libGUgbnVtYmVyIG9mXG4gICAgICogLWNvZF9pbmZvLmdsb2JhbF9nYWluICsgKChzY2FsZWZhY1tdICsgKGNvZF9pbmZvLnByZWZsYWcgPyBwcmV0YWJbc2ZiXSA6IDApKVxuICAgICAqIDw8IChjb2RfaW5mby5zY2FsZWZhY19zY2FsZSArIDEpKSArIGNvZF9pbmZvLnN1YmJsb2NrX2dhaW5bY29kX2luZm8ud2luZG93W3NmYl1dICogODtcbiAgICAgKlxuICAgICAqIGZvciBsb25nIGJsb2NrLCAwKygoMTUrMyk8PDIpID0gMTgqNCA9IDcyXG4gICAgICogZm9yIHNob3J0IGJsb2NrLCAwKygxNTw8MikrNyo4ID0gMTUqNCs1NiA9IDExNlxuICAgICAqIDwvQ09ERT5cbiAgICAgKi9cbiAgICB2YXIgUV9NQVgyID0gUXVhbnRpemVQVlQuUV9NQVgyO1xuXG4gICAgdmFyIExBUkdFX0JJVFMgPSBRdWFudGl6ZVBWVC5MQVJHRV9CSVRTO1xuXG5cbiAgICAvKipcbiAgICAgKiBBc3N1bWluZyBkeW5hbWljIHJhbmdlPTk2ZEIsIHRoaXMgdmFsdWUgc2hvdWxkIGJlIDkyXG4gICAgICovXG4gICAgdmFyIE5TQVRIU0NBTEUgPSAxMDA7XG5cbiAgICAvKipcbiAgICAgKiBUaGUgZm9sbG93aW5nIHRhYmxlIGlzIHVzZWQgdG8gaW1wbGVtZW50IHRoZSBzY2FsZWZhY3RvciBwYXJ0aXRpb25pbmcgZm9yXG4gICAgICogTVBFRzIgYXMgZGVzY3JpYmVkIGluIHNlY3Rpb24gMi40LjMuMiBvZiB0aGUgSVMuIFRoZSBpbmRleGluZyBjb3JyZXNwb25kc1xuICAgICAqIHRvIHRoZSB3YXkgdGhlIHRhYmxlcyBhcmUgcHJlc2VudGVkIGluIHRoZSBJUzpcbiAgICAgKlxuICAgICAqIFt0YWJsZV9udW1iZXJdW3Jvd19pbl90YWJsZV1bY29sdW1uIG9mIG5yX29mX3NmYl1cbiAgICAgKi9cbiAgICB0aGlzLm5yX29mX3NmYl9ibG9jayA9IFtcbiAgICAgICAgW1s2LCA1LCA1LCA1XSwgWzksIDksIDksIDldLCBbNiwgOSwgOSwgOV1dLFxuICAgICAgICBbWzYsIDUsIDcsIDNdLCBbOSwgOSwgMTIsIDZdLCBbNiwgOSwgMTIsIDZdXSxcbiAgICAgICAgW1sxMSwgMTAsIDAsIDBdLCBbMTgsIDE4LCAwLCAwXSwgWzE1LCAxOCwgMCwgMF1dLFxuICAgICAgICBbWzcsIDcsIDcsIDBdLCBbMTIsIDEyLCAxMiwgMF0sIFs2LCAxNSwgMTIsIDBdXSxcbiAgICAgICAgW1s2LCA2LCA2LCAzXSwgWzEyLCA5LCA5LCA2XSwgWzYsIDEyLCA5LCA2XV0sXG4gICAgICAgIFtbOCwgOCwgNSwgMF0sIFsxNSwgMTIsIDksIDBdLCBbNiwgMTgsIDksIDBdXV07XG5cbiAgICAvKipcbiAgICAgKiBUYWJsZSBCLjY6IGxheWVyMyBwcmVlbXBoYXNpc1xuICAgICAqL1xuICAgIHZhciBwcmV0YWIgPSBbMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMCwgMSwgMSwgMSwgMSxcbiAgICAgICAgMiwgMiwgMywgMywgMywgMiwgMF07XG4gICAgdGhpcy5wcmV0YWIgPSBwcmV0YWI7XG5cbiAgICAvKipcbiAgICAgKiBIZXJlIGFyZSBNUEVHMSBUYWJsZSBCLjggYW5kIE1QRUcyIFRhYmxlIEIuMSAtLSBMYXllciBJSUkgc2NhbGVmYWN0b3JcbiAgICAgKiBiYW5kcy4gPEJSPlxuICAgICAqIEluZGV4IGludG8gdGhpcyB1c2luZyBhIG1ldGhvZCBzdWNoIGFzOjxCUj5cbiAgICAgKiBpZHggPSBmcl9wcy5oZWFkZXIuc2FtcGxpbmdfZnJlcXVlbmN5ICsgKGZyX3BzLmhlYWRlci52ZXJzaW9uICogMylcbiAgICAgKi9cbiAgICB0aGlzLnNmQmFuZEluZGV4ID0gW1xuICAgICAgICAvLyBUYWJsZSBCLjIuYjogMjIuMDUga0h6XG4gICAgICAgIG5ldyBTY2FsZUZhYyhbMCwgNiwgMTIsIDE4LCAyNCwgMzAsIDM2LCA0NCwgNTQsIDY2LCA4MCwgOTYsIDExNiwgMTQwLCAxNjgsIDIwMCwgMjM4LCAyODQsIDMzNiwgMzk2LCA0NjQsXG4gICAgICAgICAgICAgICAgNTIyLCA1NzZdLFxuICAgICAgICAgICAgWzAsIDQsIDgsIDEyLCAxOCwgMjQsIDMyLCA0MiwgNTYsIDc0LCAxMDAsIDEzMiwgMTc0LCAxOTJdXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvLyAgc2ZiMjEgcHNldWRvIHN1YiBiYW5kc1xuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLy8gIHNmYjEyIHBzZXVkbyBzdWIgYmFuZHNcbiAgICAgICAgKSxcbiAgICAgICAgLyogVGFibGUgQi4yLmM6IDI0IGtIeiAqLyAvKiBkb2NzOiAzMzIuIG1wZzEyMyhicm9rZW4pOiAzMzAgKi9cbiAgICAgICAgbmV3IFNjYWxlRmFjKFswLCA2LCAxMiwgMTgsIDI0LCAzMCwgMzYsIDQ0LCA1NCwgNjYsIDgwLCA5NiwgMTE0LCAxMzYsIDE2MiwgMTk0LCAyMzIsIDI3OCwgMzMyLCAzOTQsIDQ2NCxcbiAgICAgICAgICAgICAgICA1NDAsIDU3Nl0sXG4gICAgICAgICAgICBbMCwgNCwgOCwgMTIsIDE4LCAyNiwgMzYsIDQ4LCA2MiwgODAsIDEwNCwgMTM2LCAxODAsIDE5Ml1cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8qICBzZmIyMSBwc2V1ZG8gc3ViIGJhbmRzICovXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvKiAgc2ZiMTIgcHNldWRvIHN1YiBiYW5kcyAqL1xuICAgICAgICApLFxuICAgICAgICAvKiBUYWJsZSBCLjIuYTogMTYga0h6ICovXG4gICAgICAgIG5ldyBTY2FsZUZhYyhbMCwgNiwgMTIsIDE4LCAyNCwgMzAsIDM2LCA0NCwgNTQsIDY2LCA4MCwgOTYsIDExNiwgMTQwLCAxNjgsIDIwMCwgMjM4LCAyODQsIDMzNiwgMzk2LCA0NjQsXG4gICAgICAgICAgICAgICAgNTIyLCA1NzZdLFxuICAgICAgICAgICAgWzAsIDQsIDgsIDEyLCAxOCwgMjYsIDM2LCA0OCwgNjIsIDgwLCAxMDQsIDEzNCwgMTc0LCAxOTJdXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvKiAgc2ZiMjEgcHNldWRvIHN1YiBiYW5kcyAqL1xuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLyogIHNmYjEyIHBzZXVkbyBzdWIgYmFuZHMgKi9cbiAgICAgICAgKSxcbiAgICAgICAgLyogVGFibGUgQi44LmI6IDQ0LjEga0h6ICovXG4gICAgICAgIG5ldyBTY2FsZUZhYyhbMCwgNCwgOCwgMTIsIDE2LCAyMCwgMjQsIDMwLCAzNiwgNDQsIDUyLCA2MiwgNzQsIDkwLCAxMTAsIDEzNCwgMTYyLCAxOTYsIDIzOCwgMjg4LCAzNDIsIDQxOCxcbiAgICAgICAgICAgICAgICA1NzZdLFxuICAgICAgICAgICAgWzAsIDQsIDgsIDEyLCAxNiwgMjIsIDMwLCA0MCwgNTIsIDY2LCA4NCwgMTA2LCAxMzYsIDE5Ml1cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8qICBzZmIyMSBwc2V1ZG8gc3ViIGJhbmRzICovXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvKiAgc2ZiMTIgcHNldWRvIHN1YiBiYW5kcyAqL1xuICAgICAgICApLFxuICAgICAgICAvKiBUYWJsZSBCLjguYzogNDgga0h6ICovXG4gICAgICAgIG5ldyBTY2FsZUZhYyhbMCwgNCwgOCwgMTIsIDE2LCAyMCwgMjQsIDMwLCAzNiwgNDIsIDUwLCA2MCwgNzIsIDg4LCAxMDYsIDEyOCwgMTU2LCAxOTAsIDIzMCwgMjc2LCAzMzAsIDM4NCxcbiAgICAgICAgICAgICAgICA1NzZdLFxuICAgICAgICAgICAgWzAsIDQsIDgsIDEyLCAxNiwgMjIsIDI4LCAzOCwgNTAsIDY0LCA4MCwgMTAwLCAxMjYsIDE5Ml1cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8qICBzZmIyMSBwc2V1ZG8gc3ViIGJhbmRzICovXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvKiAgc2ZiMTIgcHNldWRvIHN1YiBiYW5kcyAqL1xuICAgICAgICApLFxuICAgICAgICAvKiBUYWJsZSBCLjguYTogMzIga0h6ICovXG4gICAgICAgIG5ldyBTY2FsZUZhYyhbMCwgNCwgOCwgMTIsIDE2LCAyMCwgMjQsIDMwLCAzNiwgNDQsIDU0LCA2NiwgODIsIDEwMiwgMTI2LCAxNTYsIDE5NCwgMjQwLCAyOTYsIDM2NCwgNDQ4LCA1NTAsXG4gICAgICAgICAgICAgICAgNTc2XSxcbiAgICAgICAgICAgIFswLCA0LCA4LCAxMiwgMTYsIDIyLCAzMCwgNDIsIDU4LCA3OCwgMTA0LCAxMzgsIDE4MCwgMTkyXVxuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLyogIHNmYjIxIHBzZXVkbyBzdWIgYmFuZHMgKi9cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8qICBzZmIxMiBwc2V1ZG8gc3ViIGJhbmRzICovXG4gICAgICAgICksXG4gICAgICAgIC8qIE1QRUctMi41IDExLjAyNSBrSHogKi9cbiAgICAgICAgbmV3IFNjYWxlRmFjKFswLCA2LCAxMiwgMTgsIDI0LCAzMCwgMzYsIDQ0LCA1NCwgNjYsIDgwLCA5NiwgMTE2LCAxNDAsIDE2OCwgMjAwLCAyMzgsIDI4NCwgMzM2LCAzOTYsIDQ2NCxcbiAgICAgICAgICAgICAgICA1MjIsIDU3Nl0sXG4gICAgICAgICAgICBbMCAvIDMsIDEyIC8gMywgMjQgLyAzLCAzNiAvIDMsIDU0IC8gMywgNzggLyAzLCAxMDggLyAzLCAxNDQgLyAzLCAxODYgLyAzLCAyNDAgLyAzLCAzMTIgLyAzLFxuICAgICAgICAgICAgICAgIDQwMiAvIDMsIDUyMiAvIDMsIDU3NiAvIDNdXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvKiAgc2ZiMjEgcHNldWRvIHN1YiBiYW5kcyAqL1xuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLyogIHNmYjEyIHBzZXVkbyBzdWIgYmFuZHMgKi9cbiAgICAgICAgKSxcbiAgICAgICAgLyogTVBFRy0yLjUgMTIga0h6ICovXG4gICAgICAgIG5ldyBTY2FsZUZhYyhbMCwgNiwgMTIsIDE4LCAyNCwgMzAsIDM2LCA0NCwgNTQsIDY2LCA4MCwgOTYsIDExNiwgMTQwLCAxNjgsIDIwMCwgMjM4LCAyODQsIDMzNiwgMzk2LCA0NjQsXG4gICAgICAgICAgICAgICAgNTIyLCA1NzZdLFxuICAgICAgICAgICAgWzAgLyAzLCAxMiAvIDMsIDI0IC8gMywgMzYgLyAzLCA1NCAvIDMsIDc4IC8gMywgMTA4IC8gMywgMTQ0IC8gMywgMTg2IC8gMywgMjQwIC8gMywgMzEyIC8gMyxcbiAgICAgICAgICAgICAgICA0MDIgLyAzLCA1MjIgLyAzLCA1NzYgLyAzXVxuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLyogIHNmYjIxIHBzZXVkbyBzdWIgYmFuZHMgKi9cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8qICBzZmIxMiBwc2V1ZG8gc3ViIGJhbmRzICovXG4gICAgICAgICksXG4gICAgICAgIC8qIE1QRUctMi41IDgga0h6ICovXG4gICAgICAgIG5ldyBTY2FsZUZhYyhbMCwgMTIsIDI0LCAzNiwgNDgsIDYwLCA3MiwgODgsIDEwOCwgMTMyLCAxNjAsIDE5MiwgMjMyLCAyODAsIDMzNiwgNDAwLCA0NzYsIDU2NiwgNTY4LCA1NzAsXG4gICAgICAgICAgICAgICAgNTcyLCA1NzQsIDU3Nl0sXG4gICAgICAgICAgICBbMCAvIDMsIDI0IC8gMywgNDggLyAzLCA3MiAvIDMsIDEwOCAvIDMsIDE1NiAvIDMsIDIxNiAvIDMsIDI4OCAvIDMsIDM3MiAvIDMsIDQ4MCAvIDMsIDQ4NiAvIDMsXG4gICAgICAgICAgICAgICAgNDkyIC8gMywgNDk4IC8gMywgNTc2IC8gM11cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8qICBzZmIyMSBwc2V1ZG8gc3ViIGJhbmRzICovXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvKiAgc2ZiMTIgcHNldWRvIHN1YiBiYW5kcyAqL1xuICAgICAgICApXG4gICAgXTtcblxuICAgIHZhciBwb3cyMCA9IG5ld19mbG9hdChRX01BWCArIFFfTUFYMiArIDEpO1xuICAgIHZhciBpcG93MjAgPSBuZXdfZmxvYXQoUV9NQVgpO1xuICAgIHZhciBwb3c0MyA9IG5ld19mbG9hdChQUkVDQUxDX1NJWkUpO1xuXG4gICAgdmFyIGFkajQzID0gbmV3X2Zsb2F0KFBSRUNBTENfU0laRSk7XG4gICAgdGhpcy5hZGo0MyA9IGFkajQzO1xuXG4gICAgLyoqXG4gICAgICogPFBSRT5cbiAgICAgKiBjb21wdXRlIHRoZSBBVEggZm9yIGVhY2ggc2NhbGVmYWN0b3IgYmFuZCBjZCByYW5nZTogMC4uOTZkYlxuICAgICAqXG4gICAgICogSW5wdXQ6IDMuM2tIeiBzaWduYWwgMzI3NjcgYW1wbGl0dWRlICgzLjNrSHogaXMgd2hlcmUgQVRIIGlzIHNtYWxsZXN0ID1cbiAgICAgKiAtNWRiKSBsb25nYmxvY2tzOiBzZmI9MTIgZW4wL2J3PS0xMWRiIG1heF9lbjAgPSAxLjNkYiBzaG9ydGJsb2Nrczogc2ZiPTVcbiAgICAgKiAtOWRiIDBkYlxuICAgICAqXG4gICAgICogSW5wdXQ6IDEgMSAxIDEgMSAxIDEgLTEgLTEgLTEgLTEgLTEgLTEgLTEgKHJlcGVhdGVkKSBsb25nYmxvY2tzOiBhbXA9MVxuICAgICAqIHNmYj0xMiBlbjAvYnc9LTEwMyBkYiBtYXhfZW4wID0gLTkyZGIgYW1wPTMyNzY3IHNmYj0xMiAtMTIgZGIgLTEuNGRiXG4gICAgICpcbiAgICAgKiBJbnB1dDogMSAxIDEgMSAxIDEgMSAtMSAtMSAtMSAtMSAtMSAtMSAtMSAocmVwZWF0ZWQpIHNob3J0YmxvY2tzOiBhbXA9MVxuICAgICAqIHNmYj01IGVuMC9idz0gLTk5IC04NiBhbXA9MzI3Njcgc2ZiPTUgLTkgZGIgNGRiXG4gICAgICpcbiAgICAgKlxuICAgICAqIE1BWCBlbmVyZ3kgb2YgbGFyZ2VzdCB3YXZlIGF0IDMuM2tIeiA9IDFkYiBBVkUgZW5lcmd5IG9mIGxhcmdlc3Qgd2F2ZSBhdFxuICAgICAqIDMuM2tIeiA9IC0xMWRiIExldCdzIHRha2UgQVZFOiAtMTFkYiA9IG1heGltdW0gc2lnbmFsIGluIHNmYj0xMi4gRHluYW1pY1xuICAgICAqIHJhbmdlIG9mIENEOiA5NmRiLiBUaGVyZWZvciBlbmVyZ3kgb2Ygc21hbGxlc3QgYXVkaWJsZSB3YXZlIGluIHNmYj0xMiA9XG4gICAgICogLTExIC0gOTYgPSAtMTA3ZGIgPSBBVEggYXQgMy4za0h6LlxuICAgICAqXG4gICAgICogQVRIIGZvcm11bGEgZm9yIHRoaXMgd2F2ZTogLTVkYi4gVG8gYWRqdXN0IHRvIExBTUUgc2NhbGluZywgd2UgbmVlZCBBVEggPVxuICAgICAqIEFUSF9mb3JtdWxhIC0gMTAzIChkYikgQVRIID0gQVRIICogMi41ZS0xMCAoZW5lcilcbiAgICAgKiA8L1BSRT5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBBVEhtZGN0KGdmcCwgZikge1xuICAgICAgICB2YXIgYXRoID0gcHN5LkFUSGZvcm11bGEoZiwgZ2ZwKTtcblxuICAgICAgICBhdGggLT0gTlNBVEhTQ0FMRTtcblxuICAgICAgICAvKiBtb2RpZnkgdGhlIE1EQ1Qgc2NhbGluZyBmb3IgdGhlIEFUSCBhbmQgY29udmVydCB0byBlbmVyZ3kgKi9cbiAgICAgICAgYXRoID0gTWF0aC5wb3coMTAuMCwgYXRoIC8gMTAuMCArIGdmcC5BVEhsb3dlcik7XG4gICAgICAgIHJldHVybiBhdGg7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29tcHV0ZV9hdGgoZ2ZwKSB7XG4gICAgICAgIHZhciBBVEhfbCA9IGdmcC5pbnRlcm5hbF9mbGFncy5BVEgubDtcbiAgICAgICAgdmFyIEFUSF9wc2ZiMjEgPSBnZnAuaW50ZXJuYWxfZmxhZ3MuQVRILnBzZmIyMTtcbiAgICAgICAgdmFyIEFUSF9zID0gZ2ZwLmludGVybmFsX2ZsYWdzLkFUSC5zO1xuICAgICAgICB2YXIgQVRIX3BzZmIxMiA9IGdmcC5pbnRlcm5hbF9mbGFncy5BVEgucHNmYjEyO1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgc2FtcF9mcmVxID0gZ2ZwLm91dF9zYW1wbGVyYXRlO1xuXG4gICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IEVuY29kZXIuU0JNQVhfbDsgc2ZiKyspIHtcbiAgICAgICAgICAgIHZhciBzdGFydCA9IGdmYy5zY2FsZWZhY19iYW5kLmxbc2ZiXTtcbiAgICAgICAgICAgIHZhciBlbmQgPSBnZmMuc2NhbGVmYWNfYmFuZC5sW3NmYiArIDFdO1xuICAgICAgICAgICAgQVRIX2xbc2ZiXSA9IEZsb2F0Lk1BWF9WQUxVRTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyZXEgPSBpICogc2FtcF9mcmVxIC8gKDIgKiA1NzYpO1xuICAgICAgICAgICAgICAgIHZhciBBVEhfZiA9IEFUSG1kY3QoZ2ZwLCBmcmVxKTtcbiAgICAgICAgICAgICAgICAvKiBmcmVxIGluIGtIeiAqL1xuICAgICAgICAgICAgICAgIEFUSF9sW3NmYl0gPSBNYXRoLm1pbihBVEhfbFtzZmJdLCBBVEhfZik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBFbmNvZGVyLlBTRkIyMTsgc2ZiKyspIHtcbiAgICAgICAgICAgIHZhciBzdGFydCA9IGdmYy5zY2FsZWZhY19iYW5kLnBzZmIyMVtzZmJdO1xuICAgICAgICAgICAgdmFyIGVuZCA9IGdmYy5zY2FsZWZhY19iYW5kLnBzZmIyMVtzZmIgKyAxXTtcbiAgICAgICAgICAgIEFUSF9wc2ZiMjFbc2ZiXSA9IEZsb2F0Lk1BWF9WQUxVRTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyZXEgPSBpICogc2FtcF9mcmVxIC8gKDIgKiA1NzYpO1xuICAgICAgICAgICAgICAgIHZhciBBVEhfZiA9IEFUSG1kY3QoZ2ZwLCBmcmVxKTtcbiAgICAgICAgICAgICAgICAvKiBmcmVxIGluIGtIeiAqL1xuICAgICAgICAgICAgICAgIEFUSF9wc2ZiMjFbc2ZiXSA9IE1hdGgubWluKEFUSF9wc2ZiMjFbc2ZiXSwgQVRIX2YpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgRW5jb2Rlci5TQk1BWF9zOyBzZmIrKykge1xuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gZ2ZjLnNjYWxlZmFjX2JhbmQuc1tzZmJdO1xuICAgICAgICAgICAgdmFyIGVuZCA9IGdmYy5zY2FsZWZhY19iYW5kLnNbc2ZiICsgMV07XG4gICAgICAgICAgICBBVEhfc1tzZmJdID0gRmxvYXQuTUFYX1ZBTFVFO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJlcSA9IGkgKiBzYW1wX2ZyZXEgLyAoMiAqIDE5Mik7XG4gICAgICAgICAgICAgICAgdmFyIEFUSF9mID0gQVRIbWRjdChnZnAsIGZyZXEpO1xuICAgICAgICAgICAgICAgIC8qIGZyZXEgaW4ga0h6ICovXG4gICAgICAgICAgICAgICAgQVRIX3Nbc2ZiXSA9IE1hdGgubWluKEFUSF9zW3NmYl0sIEFUSF9mKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIEFUSF9zW3NmYl0gKj0gKGdmYy5zY2FsZWZhY19iYW5kLnNbc2ZiICsgMV0gLSBnZmMuc2NhbGVmYWNfYmFuZC5zW3NmYl0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgRW5jb2Rlci5QU0ZCMTI7IHNmYisrKSB7XG4gICAgICAgICAgICB2YXIgc3RhcnQgPSBnZmMuc2NhbGVmYWNfYmFuZC5wc2ZiMTJbc2ZiXTtcbiAgICAgICAgICAgIHZhciBlbmQgPSBnZmMuc2NhbGVmYWNfYmFuZC5wc2ZiMTJbc2ZiICsgMV07XG4gICAgICAgICAgICBBVEhfcHNmYjEyW3NmYl0gPSBGbG9hdC5NQVhfVkFMVUU7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBmcmVxID0gaSAqIHNhbXBfZnJlcSAvICgyICogMTkyKTtcbiAgICAgICAgICAgICAgICB2YXIgQVRIX2YgPSBBVEhtZGN0KGdmcCwgZnJlcSk7XG4gICAgICAgICAgICAgICAgLyogZnJlcSBpbiBrSHogKi9cbiAgICAgICAgICAgICAgICBBVEhfcHNmYjEyW3NmYl0gPSBNYXRoLm1pbihBVEhfcHNmYjEyW3NmYl0sIEFUSF9mKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIG5vdCBzdXJlIGFib3V0IHRoZSBmb2xsb3dpbmcgKi9cbiAgICAgICAgICAgIEFUSF9wc2ZiMTJbc2ZiXSAqPSAoZ2ZjLnNjYWxlZmFjX2JhbmQuc1sxM10gLSBnZmMuc2NhbGVmYWNfYmFuZC5zWzEyXSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKlxuICAgICAgICAgKiBuby1BVEggbW9kZTogcmVkdWNlIEFUSCB0byAtMjAwIGRCXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoZ2ZwLm5vQVRIKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBFbmNvZGVyLlNCTUFYX2w7IHNmYisrKSB7XG4gICAgICAgICAgICAgICAgQVRIX2xbc2ZiXSA9IDFFLTIwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgRW5jb2Rlci5QU0ZCMjE7IHNmYisrKSB7XG4gICAgICAgICAgICAgICAgQVRIX3BzZmIyMVtzZmJdID0gMUUtMjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBFbmNvZGVyLlNCTUFYX3M7IHNmYisrKSB7XG4gICAgICAgICAgICAgICAgQVRIX3Nbc2ZiXSA9IDFFLTIwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgRW5jb2Rlci5QU0ZCMTI7IHNmYisrKSB7XG4gICAgICAgICAgICAgICAgQVRIX3BzZmIxMltzZmJdID0gMUUtMjA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKlxuICAgICAgICAgKiB3b3JrIGluIHByb2dyZXNzLCBkb24ndCByZWx5IG9uIGl0IHRvbyBtdWNoXG4gICAgICAgICAqL1xuICAgICAgICBnZmMuQVRILmZsb29yID0gMTAuICogTWF0aF9sb2cxMChBVEhtZGN0KGdmcCwgLTEuKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogaW5pdGlhbGl6YXRpb24gZm9yIGl0ZXJhdGlvbl9sb29wXG4gICAgICovXG4gICAgdGhpcy5pdGVyYXRpb25faW5pdCA9IGZ1bmN0aW9uIChnZnApIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGwzX3NpZGUgPSBnZmMubDNfc2lkZTtcbiAgICAgICAgdmFyIGk7XG5cbiAgICAgICAgaWYgKGdmYy5pdGVyYXRpb25faW5pdF9pbml0ID09IDApIHtcbiAgICAgICAgICAgIGdmYy5pdGVyYXRpb25faW5pdF9pbml0ID0gMTtcblxuICAgICAgICAgICAgbDNfc2lkZS5tYWluX2RhdGFfYmVnaW4gPSAwO1xuICAgICAgICAgICAgY29tcHV0ZV9hdGgoZ2ZwKTtcblxuICAgICAgICAgICAgcG93NDNbMF0gPSAwLjA7XG4gICAgICAgICAgICBmb3IgKGkgPSAxOyBpIDwgUFJFQ0FMQ19TSVpFOyBpKyspXG4gICAgICAgICAgICAgICAgcG93NDNbaV0gPSBNYXRoLnBvdyhpLCA0LjAgLyAzLjApO1xuXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgUFJFQ0FMQ19TSVpFIC0gMTsgaSsrKVxuICAgICAgICAgICAgICAgIGFkajQzW2ldID0gKChpICsgMSkgLSBNYXRoLnBvdyhcbiAgICAgICAgICAgICAgICAgICAgMC41ICogKHBvdzQzW2ldICsgcG93NDNbaSArIDFdKSwgMC43NSkpO1xuICAgICAgICAgICAgYWRqNDNbaV0gPSAwLjU7XG5cbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBRX01BWDsgaSsrKVxuICAgICAgICAgICAgICAgIGlwb3cyMFtpXSA9IE1hdGgucG93KDIuMCwgKGkgLSAyMTApICogLTAuMTg3NSk7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDw9IFFfTUFYICsgUV9NQVgyOyBpKyspXG4gICAgICAgICAgICAgICAgcG93MjBbaV0gPSBNYXRoLnBvdygyLjAsIChpIC0gMjEwIC0gUV9NQVgyKSAqIDAuMjUpO1xuXG4gICAgICAgICAgICB0YWsuaHVmZm1hbl9pbml0KGdmYyk7XG5cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXIgYmFzcywgYWx0bywgdHJlYmxlLCBzZmIyMTtcblxuICAgICAgICAgICAgICAgIGkgPSAoZ2ZwLmV4cF9uc3BzeXR1bmUgPj4gMikgJiA2MztcbiAgICAgICAgICAgICAgICBpZiAoaSA+PSAzMilcbiAgICAgICAgICAgICAgICAgICAgaSAtPSA2NDtcbiAgICAgICAgICAgICAgICBiYXNzID0gTWF0aC5wb3coMTAsIGkgLyA0LjAgLyAxMC4wKTtcblxuICAgICAgICAgICAgICAgIGkgPSAoZ2ZwLmV4cF9uc3BzeXR1bmUgPj4gOCkgJiA2MztcbiAgICAgICAgICAgICAgICBpZiAoaSA+PSAzMilcbiAgICAgICAgICAgICAgICAgICAgaSAtPSA2NDtcbiAgICAgICAgICAgICAgICBhbHRvID0gTWF0aC5wb3coMTAsIGkgLyA0LjAgLyAxMC4wKTtcblxuICAgICAgICAgICAgICAgIGkgPSAoZ2ZwLmV4cF9uc3BzeXR1bmUgPj4gMTQpICYgNjM7XG4gICAgICAgICAgICAgICAgaWYgKGkgPj0gMzIpXG4gICAgICAgICAgICAgICAgICAgIGkgLT0gNjQ7XG4gICAgICAgICAgICAgICAgdHJlYmxlID0gTWF0aC5wb3coMTAsIGkgLyA0LjAgLyAxMC4wKTtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogdG8gYmUgY29tcGF0aWJsZSB3aXRoIE5hb2tpJ3Mgb3JpZ2luYWwgY29kZSwgdGhlIG5leHQgNiBiaXRzXG4gICAgICAgICAgICAgICAgICogZGVmaW5lIG9ubHkgdGhlIGFtb3VudCBvZiBjaGFuZ2luZyB0cmVibGUgZm9yIHNmYjIxXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgaSA9IChnZnAuZXhwX25zcHN5dHVuZSA+PiAyMCkgJiA2MztcbiAgICAgICAgICAgICAgICBpZiAoaSA+PSAzMilcbiAgICAgICAgICAgICAgICAgICAgaSAtPSA2NDtcbiAgICAgICAgICAgICAgICBzZmIyMSA9IHRyZWJsZSAqIE1hdGgucG93KDEwLCBpIC8gNC4wIC8gMTAuMCk7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IEVuY29kZXIuU0JNQVhfbDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSA8PSA2KVxuICAgICAgICAgICAgICAgICAgICAgICAgZiA9IGJhc3M7XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGkgPD0gMTMpXG4gICAgICAgICAgICAgICAgICAgICAgICBmID0gYWx0bztcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaSA8PSAyMClcbiAgICAgICAgICAgICAgICAgICAgICAgIGYgPSB0cmVibGU7XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBzZmIyMTtcblxuICAgICAgICAgICAgICAgICAgICBnZmMubnNQc3kubG9uZ2ZhY3RbaV0gPSBmO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgRW5jb2Rlci5TQk1BWF9zOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGY7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpIDw9IDUpXG4gICAgICAgICAgICAgICAgICAgICAgICBmID0gYmFzcztcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaSA8PSAxMClcbiAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBhbHRvO1xuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpIDw9IDExKVxuICAgICAgICAgICAgICAgICAgICAgICAgZiA9IHRyZWJsZTtcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgZiA9IHNmYjIxO1xuXG4gICAgICAgICAgICAgICAgICAgIGdmYy5uc1BzeS5zaG9ydGZhY3RbaV0gPSBmO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGFsbG9jYXRlIGJpdHMgYW1vbmcgMiBjaGFubmVscyBiYXNlZCBvbiBQRTxCUj5cbiAgICAgKiBtdCA2Lzk5PEJSPlxuICAgICAqIGJ1Z2ZpeGVzIHJoIDgvMDE6IG9mdGVuIGFsbG9jYXRlZCBtb3JlIHRoYW4gdGhlIGFsbG93ZWQgNDA5NSBiaXRzXG4gICAgICovXG4gICAgdGhpcy5vbl9wZSA9IGZ1bmN0aW9uIChnZnAsIHBlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ19iaXRzLCBtZWFuX2JpdHMsIGdyLCBjYnIpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIHRiaXRzID0gMCwgYml0cztcbiAgICAgICAgdmFyIGFkZF9iaXRzID0gbmV3X2ludCgyKTtcbiAgICAgICAgdmFyIGNoO1xuXG4gICAgICAgIC8qIGFsbG9jYXRlIHRhcmdfYml0cyBmb3IgZ3JhbnVsZSAqL1xuICAgICAgICB2YXIgbWIgPSBuZXcgTWVhbkJpdHModGJpdHMpO1xuICAgICAgICB2YXIgZXh0cmFfYml0cyA9IHJ2LlJlc3ZNYXhCaXRzKGdmcCwgbWVhbl9iaXRzLCBtYiwgY2JyKTtcbiAgICAgICAgdGJpdHMgPSBtYi5iaXRzO1xuICAgICAgICAvKiBtYXhpbXVtIGFsbG93ZWQgYml0cyBmb3IgdGhpcyBncmFudWxlICovXG4gICAgICAgIHZhciBtYXhfYml0cyA9IHRiaXRzICsgZXh0cmFfYml0cztcbiAgICAgICAgaWYgKG1heF9iaXRzID4gTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0dSQU5VTEUpIHtcbiAgICAgICAgICAgIC8vIGhhcmQgbGltaXQgcGVyIGdyYW51bGVcbiAgICAgICAgICAgIG1heF9iaXRzID0gTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0dSQU5VTEU7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChiaXRzID0gMCwgY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7ICsrY2gpIHtcbiAgICAgICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICAgICAqIGFsbG9jYXRlIGJpdHMgZm9yIGVhY2ggY2hhbm5lbFxuICAgICAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgICAgIHRhcmdfYml0c1tjaF0gPSBNYXRoLm1pbihMYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfQ0hBTk5FTCxcbiAgICAgICAgICAgICAgICB0Yml0cyAvIGdmYy5jaGFubmVsc19vdXQpO1xuXG4gICAgICAgICAgICBhZGRfYml0c1tjaF0gPSAwIHwgKHRhcmdfYml0c1tjaF0gKiBwZVtncl1bY2hdIC8gNzAwLjAgLSB0YXJnX2JpdHNbY2hdKTtcblxuICAgICAgICAgICAgLyogYXQgbW9zdCBpbmNyZWFzZSBiaXRzIGJ5IDEuNSphdmVyYWdlICovXG4gICAgICAgICAgICBpZiAoYWRkX2JpdHNbY2hdID4gbWVhbl9iaXRzICogMyAvIDQpXG4gICAgICAgICAgICAgICAgYWRkX2JpdHNbY2hdID0gbWVhbl9iaXRzICogMyAvIDQ7XG5cbiAgICAgICAgICAgIGlmIChhZGRfYml0c1tjaF0gPCAwKVxuICAgICAgICAgICAgICAgIGFkZF9iaXRzW2NoXSA9IDA7XG5cbiAgICAgICAgICAgIGlmIChhZGRfYml0c1tjaF0gKyB0YXJnX2JpdHNbY2hdID4gTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0NIQU5ORUwpXG4gICAgICAgICAgICAgICAgYWRkX2JpdHNbY2hdID0gTWF0aC5tYXgoMCxcbiAgICAgICAgICAgICAgICAgICAgTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0NIQU5ORUwgLSB0YXJnX2JpdHNbY2hdKTtcblxuICAgICAgICAgICAgYml0cyArPSBhZGRfYml0c1tjaF07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJpdHMgPiBleHRyYV9iaXRzKSB7XG4gICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyArK2NoKSB7XG4gICAgICAgICAgICAgICAgYWRkX2JpdHNbY2hdID0gZXh0cmFfYml0cyAqIGFkZF9iaXRzW2NoXSAvIGJpdHM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyArK2NoKSB7XG4gICAgICAgICAgICB0YXJnX2JpdHNbY2hdICs9IGFkZF9iaXRzW2NoXTtcbiAgICAgICAgICAgIGV4dHJhX2JpdHMgLT0gYWRkX2JpdHNbY2hdO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChiaXRzID0gMCwgY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7ICsrY2gpIHtcbiAgICAgICAgICAgIGJpdHMgKz0gdGFyZ19iaXRzW2NoXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYml0cyA+IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9HUkFOVUxFKSB7XG4gICAgICAgICAgICB2YXIgc3VtID0gMDtcbiAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7ICsrY2gpIHtcbiAgICAgICAgICAgICAgICB0YXJnX2JpdHNbY2hdICo9IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9HUkFOVUxFO1xuICAgICAgICAgICAgICAgIHRhcmdfYml0c1tjaF0gLz0gYml0cztcbiAgICAgICAgICAgICAgICBzdW0gKz0gdGFyZ19iaXRzW2NoXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBtYXhfYml0cztcbiAgICB9XG5cbiAgICB0aGlzLnJlZHVjZV9zaWRlID0gZnVuY3Rpb24gKHRhcmdfYml0cywgbXNfZW5lcl9yYXRpbywgbWVhbl9iaXRzLCBtYXhfYml0cykge1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIG1zX2VuZXJfcmF0aW8gPSAwOiBhbGxvY2F0ZSA2Ni8zMyBtaWQvc2lkZSBmYWM9LjMzIG1zX2VuZXJfcmF0aW8gPS41OlxuICAgICAgICAgKiBhbGxvY2F0ZSA1MC81MCBtaWQvc2lkZSBmYWM9IDBcbiAgICAgICAgICovXG4gICAgICAgIC8qIDc1LzI1IHNwbGl0IGlzIGZhYz0uNSAqL1xuICAgICAgICB2YXIgZmFjID0gLjMzICogKC41IC0gbXNfZW5lcl9yYXRpbykgLyAuNTtcbiAgICAgICAgaWYgKGZhYyA8IDApXG4gICAgICAgICAgICBmYWMgPSAwO1xuICAgICAgICBpZiAoZmFjID4gLjUpXG4gICAgICAgICAgICBmYWMgPSAuNTtcblxuICAgICAgICAvKiBudW1iZXIgb2YgYml0cyB0byBtb3ZlIGZyb20gc2lkZSBjaGFubmVsIHRvIG1pZCBjaGFubmVsICovXG4gICAgICAgIC8qIG1vdmVfYml0cyA9IGZhYyp0YXJnX2JpdHNbMV07ICovXG4gICAgICAgIHZhciBtb3ZlX2JpdHMgPSAwIHwgKGZhYyAqIC41ICogKHRhcmdfYml0c1swXSArIHRhcmdfYml0c1sxXSkpO1xuXG4gICAgICAgIGlmIChtb3ZlX2JpdHMgPiBMYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfQ0hBTk5FTCAtIHRhcmdfYml0c1swXSkge1xuICAgICAgICAgICAgbW92ZV9iaXRzID0gTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0NIQU5ORUwgLSB0YXJnX2JpdHNbMF07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1vdmVfYml0cyA8IDApXG4gICAgICAgICAgICBtb3ZlX2JpdHMgPSAwO1xuXG4gICAgICAgIGlmICh0YXJnX2JpdHNbMV0gPj0gMTI1KSB7XG4gICAgICAgICAgICAvKiBkb250IHJlZHVjZSBzaWRlIGNoYW5uZWwgYmVsb3cgMTI1IGJpdHMgKi9cbiAgICAgICAgICAgIGlmICh0YXJnX2JpdHNbMV0gLSBtb3ZlX2JpdHMgPiAxMjUpIHtcblxuICAgICAgICAgICAgICAgIC8qIGlmIG1pZCBjaGFubmVsIGFscmVhZHkgaGFzIDJ4IG1vcmUgdGhhbiBhdmVyYWdlLCBkb250IGJvdGhlciAqL1xuICAgICAgICAgICAgICAgIC8qIG1lYW5fYml0cyA9IGJpdHMgcGVyIGdyYW51bGUgKGZvciBib3RoIGNoYW5uZWxzKSAqL1xuICAgICAgICAgICAgICAgIGlmICh0YXJnX2JpdHNbMF0gPCBtZWFuX2JpdHMpXG4gICAgICAgICAgICAgICAgICAgIHRhcmdfYml0c1swXSArPSBtb3ZlX2JpdHM7XG4gICAgICAgICAgICAgICAgdGFyZ19iaXRzWzFdIC09IG1vdmVfYml0cztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGFyZ19iaXRzWzBdICs9IHRhcmdfYml0c1sxXSAtIDEyNTtcbiAgICAgICAgICAgICAgICB0YXJnX2JpdHNbMV0gPSAxMjU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBtb3ZlX2JpdHMgPSB0YXJnX2JpdHNbMF0gKyB0YXJnX2JpdHNbMV07XG4gICAgICAgIGlmIChtb3ZlX2JpdHMgPiBtYXhfYml0cykge1xuICAgICAgICAgICAgdGFyZ19iaXRzWzBdID0gKG1heF9iaXRzICogdGFyZ19iaXRzWzBdKSAvIG1vdmVfYml0cztcbiAgICAgICAgICAgIHRhcmdfYml0c1sxXSA9IChtYXhfYml0cyAqIHRhcmdfYml0c1sxXSkgLyBtb3ZlX2JpdHM7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogIFJvYmVydCBIZWdlbWFubiAyMDAxLTA0LTI3OlxuICAgICAqICB0aGlzIGFkanVzdHMgdGhlIEFUSCwga2VlcGluZyB0aGUgb3JpZ2luYWwgbm9pc2UgZmxvb3JcbiAgICAgKiAgYWZmZWN0cyB0aGUgaGlnaGVyIGZyZXF1ZW5jaWVzIG1vcmUgdGhhbiB0aGUgbG93ZXIgb25lc1xuICAgICAqL1xuICAgIHRoaXMuYXRoQWRqdXN0ID0gZnVuY3Rpb24gKGEsIHgsIGF0aEZsb29yKSB7XG4gICAgICAgIC8qXG4gICAgICAgICAqIHdvcmsgaW4gcHJvZ3Jlc3NcbiAgICAgICAgICovXG4gICAgICAgIHZhciBvID0gOTAuMzA4NzMzNjI7XG4gICAgICAgIHZhciBwID0gOTQuODI0NDQ4NjM7XG4gICAgICAgIHZhciB1ID0gVXRpbC5GQVNUX0xPRzEwX1goeCwgMTAuMCk7XG4gICAgICAgIHZhciB2ID0gYSAqIGE7XG4gICAgICAgIHZhciB3ID0gMC4wO1xuICAgICAgICB1IC09IGF0aEZsb29yO1xuICAgICAgICAvKiB1bmRvIHNjYWxpbmcgKi9cbiAgICAgICAgaWYgKHYgPiAxRS0yMClcbiAgICAgICAgICAgIHcgPSAxLiArIFV0aWwuRkFTVF9MT0cxMF9YKHYsIDEwLjAgLyBvKTtcbiAgICAgICAgaWYgKHcgPCAwKVxuICAgICAgICAgICAgdyA9IDAuO1xuICAgICAgICB1ICo9IHc7XG4gICAgICAgIHUgKz0gYXRoRmxvb3IgKyBvIC0gcDtcbiAgICAgICAgLyogcmVkbyBzY2FsaW5nICovXG5cbiAgICAgICAgcmV0dXJuIE1hdGgucG93KDEwLiwgMC4xICogdSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIENhbGN1bGF0ZSB0aGUgYWxsb3dlZCBkaXN0b3J0aW9uIGZvciBlYWNoIHNjYWxlZmFjdG9yIGJhbmQsIGFzIGRldGVybWluZWRcbiAgICAgKiBieSB0aGUgcHN5Y2hvYWNvdXN0aWMgbW9kZWwuIHhtaW4oc2IpID0gcmF0aW8oc2IpICogZW4oc2IpIC8gYncoc2IpXG4gICAgICpcbiAgICAgKiByZXR1cm5zIG51bWJlciBvZiBzZmIncyB3aXRoIGVuZXJneSA+IEFUSFxuICAgICAqL1xuICAgIHRoaXMuY2FsY194bWluID0gZnVuY3Rpb24gKGdmcCwgcmF0aW8sIGNvZF9pbmZvLCBweG1pbikge1xuICAgICAgICB2YXIgcHhtaW5Qb3MgPSAwO1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgZ3NmYiwgaiA9IDAsIGF0aF9vdmVyID0gMDtcbiAgICAgICAgdmFyIEFUSCA9IGdmYy5BVEg7XG4gICAgICAgIHZhciB4ciA9IGNvZF9pbmZvLnhyO1xuICAgICAgICB2YXIgZW5hYmxlX2F0aGFhX2ZpeCA9IChnZnAuVkJSID09IFZick1vZGUudmJyX210cmgpID8gMSA6IDA7XG4gICAgICAgIHZhciBtYXNraW5nX2xvd2VyID0gZ2ZjLm1hc2tpbmdfbG93ZXI7XG5cbiAgICAgICAgaWYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfbXRyaCB8fCBnZnAuVkJSID09IFZick1vZGUudmJyX210KSB7XG4gICAgICAgICAgICAvKiB3YXMgYWxyZWFkeSBkb25lIGluIFBTWS1Nb2RlbCAqL1xuICAgICAgICAgICAgbWFza2luZ19sb3dlciA9IDEuMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoZ3NmYiA9IDA7IGdzZmIgPCBjb2RfaW5mby5wc3lfbG1heDsgZ3NmYisrKSB7XG4gICAgICAgICAgICB2YXIgZW4wLCB4bWluO1xuICAgICAgICAgICAgdmFyIHJoMSwgcmgyO1xuICAgICAgICAgICAgdmFyIHdpZHRoLCBsO1xuXG4gICAgICAgICAgICBpZiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9yaCB8fCBnZnAuVkJSID09IFZick1vZGUudmJyX210cmgpXG4gICAgICAgICAgICAgICAgeG1pbiA9IGF0aEFkanVzdChBVEguYWRqdXN0LCBBVEgubFtnc2ZiXSwgQVRILmZsb29yKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB4bWluID0gQVRILmFkanVzdCAqIEFUSC5sW2dzZmJdO1xuXG4gICAgICAgICAgICB3aWR0aCA9IGNvZF9pbmZvLndpZHRoW2dzZmJdO1xuICAgICAgICAgICAgcmgxID0geG1pbiAvIHdpZHRoO1xuICAgICAgICAgICAgcmgyID0gREJMX0VQU0lMT047XG4gICAgICAgICAgICBsID0gd2lkdGggPj4gMTtcbiAgICAgICAgICAgIGVuMCA9IDAuMDtcbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICB2YXIgeGEsIHhiO1xuICAgICAgICAgICAgICAgIHhhID0geHJbal0gKiB4cltqXTtcbiAgICAgICAgICAgICAgICBlbjAgKz0geGE7XG4gICAgICAgICAgICAgICAgcmgyICs9ICh4YSA8IHJoMSkgPyB4YSA6IHJoMTtcbiAgICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICAgICAgeGIgPSB4cltqXSAqIHhyW2pdO1xuICAgICAgICAgICAgICAgIGVuMCArPSB4YjtcbiAgICAgICAgICAgICAgICByaDIgKz0gKHhiIDwgcmgxKSA/IHhiIDogcmgxO1xuICAgICAgICAgICAgICAgIGorKztcbiAgICAgICAgICAgIH0gd2hpbGUgKC0tbCA+IDApO1xuICAgICAgICAgICAgaWYgKGVuMCA+IHhtaW4pXG4gICAgICAgICAgICAgICAgYXRoX292ZXIrKztcblxuICAgICAgICAgICAgaWYgKGdzZmIgPT0gRW5jb2Rlci5TQlBTWV9sKSB7XG4gICAgICAgICAgICAgICAgdmFyIHggPSB4bWluICogZ2ZjLm5zUHN5LmxvbmdmYWN0W2dzZmJdO1xuICAgICAgICAgICAgICAgIGlmIChyaDIgPCB4KSB7XG4gICAgICAgICAgICAgICAgICAgIHJoMiA9IHg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVuYWJsZV9hdGhhYV9maXggIT0gMCkge1xuICAgICAgICAgICAgICAgIHhtaW4gPSByaDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWdmcC5BVEhvbmx5KSB7XG4gICAgICAgICAgICAgICAgdmFyIGUgPSByYXRpby5lbi5sW2dzZmJdO1xuICAgICAgICAgICAgICAgIGlmIChlID4gMC4wKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB4O1xuICAgICAgICAgICAgICAgICAgICB4ID0gZW4wICogcmF0aW8udGhtLmxbZ3NmYl0gKiBtYXNraW5nX2xvd2VyIC8gZTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVuYWJsZV9hdGhhYV9maXggIT0gMClcbiAgICAgICAgICAgICAgICAgICAgICAgIHggKj0gZ2ZjLm5zUHN5LmxvbmdmYWN0W2dzZmJdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoeG1pbiA8IHgpXG4gICAgICAgICAgICAgICAgICAgICAgICB4bWluID0geDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZW5hYmxlX2F0aGFhX2ZpeCAhPSAwKVxuICAgICAgICAgICAgICAgIHB4bWluW3B4bWluUG9zKytdID0geG1pbjtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBweG1pbltweG1pblBvcysrXSA9IHhtaW4gKiBnZmMubnNQc3kubG9uZ2ZhY3RbZ3NmYl07XG4gICAgICAgIH1cbiAgICAgICAgLyogZW5kIG9mIGxvbmcgYmxvY2sgbG9vcCAqL1xuXG4gICAgICAgIC8qIHVzZSB0aGlzIGZ1bmN0aW9uIHRvIGRldGVybWluZSB0aGUgaGlnaGVzdCBub24temVybyBjb2VmZiAqL1xuICAgICAgICB2YXIgbWF4X25vbnplcm8gPSA1NzU7XG4gICAgICAgIGlmIChjb2RfaW5mby5ibG9ja190eXBlICE9IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgLy8gTk9STSwgU1RBUlQgb3IgU1RPUCB0eXBlLCBidXQgbm90IFNIT1JUXG4gICAgICAgICAgICB2YXIgayA9IDU3NjtcbiAgICAgICAgICAgIHdoaWxlIChrLS0gIT0gMCAmJiBCaXRTdHJlYW0uRVEoeHJba10sIDApKSB7XG4gICAgICAgICAgICAgICAgbWF4X25vbnplcm8gPSBrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvZF9pbmZvLm1heF9ub256ZXJvX2NvZWZmID0gbWF4X25vbnplcm87XG5cbiAgICAgICAgZm9yICh2YXIgc2ZiID0gY29kX2luZm8uc2ZiX3NtaW47IGdzZmIgPCBjb2RfaW5mby5wc3ltYXg7IHNmYisrLCBnc2ZiICs9IDMpIHtcbiAgICAgICAgICAgIHZhciB3aWR0aCwgYjtcbiAgICAgICAgICAgIHZhciB0bXBBVEg7XG4gICAgICAgICAgICBpZiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9yaCB8fCBnZnAuVkJSID09IFZick1vZGUudmJyX210cmgpXG4gICAgICAgICAgICAgICAgdG1wQVRIID0gYXRoQWRqdXN0KEFUSC5hZGp1c3QsIEFUSC5zW3NmYl0sIEFUSC5mbG9vcik7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgdG1wQVRIID0gQVRILmFkanVzdCAqIEFUSC5zW3NmYl07XG5cbiAgICAgICAgICAgIHdpZHRoID0gY29kX2luZm8ud2lkdGhbZ3NmYl07XG4gICAgICAgICAgICBmb3IgKGIgPSAwOyBiIDwgMzsgYisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVuMCA9IDAuMCwgeG1pbjtcbiAgICAgICAgICAgICAgICB2YXIgcmgxLCByaDI7XG4gICAgICAgICAgICAgICAgdmFyIGwgPSB3aWR0aCA+PiAxO1xuXG4gICAgICAgICAgICAgICAgcmgxID0gdG1wQVRIIC8gd2lkdGg7XG4gICAgICAgICAgICAgICAgcmgyID0gREJMX0VQU0lMT047XG4gICAgICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgICAgICB2YXIgeGEsIHhiO1xuICAgICAgICAgICAgICAgICAgICB4YSA9IHhyW2pdICogeHJbal07XG4gICAgICAgICAgICAgICAgICAgIGVuMCArPSB4YTtcbiAgICAgICAgICAgICAgICAgICAgcmgyICs9ICh4YSA8IHJoMSkgPyB4YSA6IHJoMTtcbiAgICAgICAgICAgICAgICAgICAgaisrO1xuICAgICAgICAgICAgICAgICAgICB4YiA9IHhyW2pdICogeHJbal07XG4gICAgICAgICAgICAgICAgICAgIGVuMCArPSB4YjtcbiAgICAgICAgICAgICAgICAgICAgcmgyICs9ICh4YiA8IHJoMSkgPyB4YiA6IHJoMTtcbiAgICAgICAgICAgICAgICAgICAgaisrO1xuICAgICAgICAgICAgICAgIH0gd2hpbGUgKC0tbCA+IDApO1xuICAgICAgICAgICAgICAgIGlmIChlbjAgPiB0bXBBVEgpXG4gICAgICAgICAgICAgICAgICAgIGF0aF9vdmVyKys7XG4gICAgICAgICAgICAgICAgaWYgKHNmYiA9PSBFbmNvZGVyLlNCUFNZX3MpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHggPSB0bXBBVEggKiBnZmMubnNQc3kuc2hvcnRmYWN0W3NmYl07XG4gICAgICAgICAgICAgICAgICAgIGlmIChyaDIgPCB4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByaDIgPSB4O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChlbmFibGVfYXRoYWFfZml4ICE9IDApXG4gICAgICAgICAgICAgICAgICAgIHhtaW4gPSByaDI7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICB4bWluID0gdG1wQVRIO1xuXG4gICAgICAgICAgICAgICAgaWYgKCFnZnAuQVRIb25seSAmJiAhZ2ZwLkFUSHNob3J0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlID0gcmF0aW8uZW4uc1tzZmJdW2JdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZSA+IDAuMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHg7XG4gICAgICAgICAgICAgICAgICAgICAgICB4ID0gZW4wICogcmF0aW8udGhtLnNbc2ZiXVtiXSAqIG1hc2tpbmdfbG93ZXIgLyBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuYWJsZV9hdGhhYV9maXggIT0gMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4ICo9IGdmYy5uc1BzeS5zaG9ydGZhY3Rbc2ZiXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh4bWluIDwgeClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB4bWluID0geDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZW5hYmxlX2F0aGFhX2ZpeCAhPSAwKVxuICAgICAgICAgICAgICAgICAgICBweG1pbltweG1pblBvcysrXSA9IHhtaW47XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBweG1pbltweG1pblBvcysrXSA9IHhtaW4gKiBnZmMubnNQc3kuc2hvcnRmYWN0W3NmYl07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBiICovXG4gICAgICAgICAgICBpZiAoZ2ZwLnVzZVRlbXBvcmFsKSB7XG4gICAgICAgICAgICAgICAgaWYgKHB4bWluW3B4bWluUG9zIC0gM10gPiBweG1pbltweG1pblBvcyAtIDMgKyAxXSlcbiAgICAgICAgICAgICAgICAgICAgcHhtaW5bcHhtaW5Qb3MgLSAzICsgMV0gKz0gKHB4bWluW3B4bWluUG9zIC0gM10gLSBweG1pbltweG1pblBvcyAtIDMgKyAxXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICogZ2ZjLmRlY2F5O1xuICAgICAgICAgICAgICAgIGlmIChweG1pbltweG1pblBvcyAtIDMgKyAxXSA+IHB4bWluW3B4bWluUG9zIC0gMyArIDJdKVxuICAgICAgICAgICAgICAgICAgICBweG1pbltweG1pblBvcyAtIDMgKyAyXSArPSAocHhtaW5bcHhtaW5Qb3MgLSAzICsgMV0gLSBweG1pbltweG1pblBvcyAtIDMgKyAyXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICogZ2ZjLmRlY2F5O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qIGVuZCBvZiBzaG9ydCBibG9jayBzZmIgbG9vcCAqL1xuXG4gICAgICAgIHJldHVybiBhdGhfb3ZlcjtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gU3RhcnRMaW5lKGopIHtcbiAgICAgICAgdGhpcy5zID0gajtcbiAgICB9XG5cbiAgICB0aGlzLmNhbGNfbm9pc2VfY29yZSA9IGZ1bmN0aW9uIChjb2RfaW5mbywgc3RhcnRsaW5lLCBsLCBzdGVwKSB7XG4gICAgICAgIHZhciBub2lzZSA9IDA7XG4gICAgICAgIHZhciBqID0gc3RhcnRsaW5lLnM7XG4gICAgICAgIHZhciBpeCA9IGNvZF9pbmZvLmwzX2VuYztcblxuICAgICAgICBpZiAoaiA+IGNvZF9pbmZvLmNvdW50MSkge1xuICAgICAgICAgICAgd2hpbGUgKChsLS0pICE9IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgdGVtcDtcbiAgICAgICAgICAgICAgICB0ZW1wID0gY29kX2luZm8ueHJbal07XG4gICAgICAgICAgICAgICAgaisrO1xuICAgICAgICAgICAgICAgIG5vaXNlICs9IHRlbXAgKiB0ZW1wO1xuICAgICAgICAgICAgICAgIHRlbXAgPSBjb2RfaW5mby54cltqXTtcbiAgICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICAgICAgbm9pc2UgKz0gdGVtcCAqIHRlbXA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoaiA+IGNvZF9pbmZvLmJpZ192YWx1ZXMpIHtcbiAgICAgICAgICAgIHZhciBpeDAxID0gbmV3X2Zsb2F0KDIpO1xuICAgICAgICAgICAgaXgwMVswXSA9IDA7XG4gICAgICAgICAgICBpeDAxWzFdID0gc3RlcDtcbiAgICAgICAgICAgIHdoaWxlICgobC0tKSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRlbXA7XG4gICAgICAgICAgICAgICAgdGVtcCA9IE1hdGguYWJzKGNvZF9pbmZvLnhyW2pdKSAtIGl4MDFbaXhbal1dO1xuICAgICAgICAgICAgICAgIGorKztcbiAgICAgICAgICAgICAgICBub2lzZSArPSB0ZW1wICogdGVtcDtcbiAgICAgICAgICAgICAgICB0ZW1wID0gTWF0aC5hYnMoY29kX2luZm8ueHJbal0pIC0gaXgwMVtpeFtqXV07XG4gICAgICAgICAgICAgICAgaisrO1xuICAgICAgICAgICAgICAgIG5vaXNlICs9IHRlbXAgKiB0ZW1wO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgd2hpbGUgKChsLS0pICE9IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgdGVtcDtcbiAgICAgICAgICAgICAgICB0ZW1wID0gTWF0aC5hYnMoY29kX2luZm8ueHJbal0pIC0gcG93NDNbaXhbal1dICogc3RlcDtcbiAgICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICAgICAgbm9pc2UgKz0gdGVtcCAqIHRlbXA7XG4gICAgICAgICAgICAgICAgdGVtcCA9IE1hdGguYWJzKGNvZF9pbmZvLnhyW2pdKSAtIHBvdzQzW2l4W2pdXSAqIHN0ZXA7XG4gICAgICAgICAgICAgICAgaisrO1xuICAgICAgICAgICAgICAgIG5vaXNlICs9IHRlbXAgKiB0ZW1wO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgc3RhcnRsaW5lLnMgPSBqO1xuICAgICAgICByZXR1cm4gbm9pc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogPFBSRT5cbiAgICAgKiAtb28gZEIgID0+ICAtMS4wMFxuICAgICAqIC0gNiBkQiAgPT4gIC0wLjk3XG4gICAgICogLSAzIGRCICA9PiAgLTAuODBcbiAgICAgKiAtIDIgZEIgID0+ICAtMC42NFxuICAgICAqIC0gMSBkQiAgPT4gIC0wLjM4XG4gICAgICogICAwIGRCICA9PiAgIDAuMDBcbiAgICAgKiArIDEgZEIgID0+ICArMC40OVxuICAgICAqICsgMiBkQiAgPT4gICsxLjA2XG4gICAgICogKyAzIGRCICA9PiAgKzEuNjhcbiAgICAgKiArIDYgZEIgID0+ICArMy42OVxuICAgICAqICsxMCBkQiAgPT4gICs2LjQ1XG4gICAgICogPC9QUkU+XG4gICAgICovXG4gICAgdGhpcy5jYWxjX25vaXNlID0gZnVuY3Rpb24gKGNvZF9pbmZvLCBsM194bWluLCBkaXN0b3J0LCByZXMsIHByZXZfbm9pc2UpIHtcbiAgICAgICAgdmFyIGRpc3RvcnRQb3MgPSAwO1xuICAgICAgICB2YXIgbDNfeG1pblBvcyA9IDA7XG4gICAgICAgIHZhciBzZmIsIGwsIG92ZXIgPSAwO1xuICAgICAgICB2YXIgb3Zlcl9ub2lzZV9kYiA9IDA7XG4gICAgICAgIC8qIDAgZEIgcmVsYXRpdmUgdG8gbWFza2luZyAqL1xuICAgICAgICB2YXIgdG90X25vaXNlX2RiID0gMDtcbiAgICAgICAgLyogLTIwMCBkQiByZWxhdGl2ZSB0byBtYXNraW5nICovXG4gICAgICAgIHZhciBtYXhfbm9pc2UgPSAtMjAuMDtcbiAgICAgICAgdmFyIGogPSAwO1xuICAgICAgICB2YXIgc2NhbGVmYWMgPSBjb2RfaW5mby5zY2FsZWZhYztcbiAgICAgICAgdmFyIHNjYWxlZmFjUG9zID0gMDtcblxuICAgICAgICByZXMub3Zlcl9TU0QgPSAwO1xuXG4gICAgICAgIGZvciAoc2ZiID0gMDsgc2ZiIDwgY29kX2luZm8ucHN5bWF4OyBzZmIrKykge1xuICAgICAgICAgICAgdmFyIHMgPSBjb2RfaW5mby5nbG9iYWxfZ2FpblxuICAgICAgICAgICAgICAgIC0gKCgoc2NhbGVmYWNbc2NhbGVmYWNQb3MrK10pICsgKGNvZF9pbmZvLnByZWZsYWcgIT0gMCA/IHByZXRhYltzZmJdXG4gICAgICAgICAgICAgICAgICAgIDogMCkpIDw8IChjb2RfaW5mby5zY2FsZWZhY19zY2FsZSArIDEpKVxuICAgICAgICAgICAgICAgIC0gY29kX2luZm8uc3ViYmxvY2tfZ2Fpbltjb2RfaW5mby53aW5kb3dbc2ZiXV0gKiA4O1xuICAgICAgICAgICAgdmFyIG5vaXNlID0gMC4wO1xuXG4gICAgICAgICAgICBpZiAocHJldl9ub2lzZSAhPSBudWxsICYmIChwcmV2X25vaXNlLnN0ZXBbc2ZiXSA9PSBzKSkge1xuXG4gICAgICAgICAgICAgICAgLyogdXNlIHByZXZpb3VzbHkgY29tcHV0ZWQgdmFsdWVzICovXG4gICAgICAgICAgICAgICAgbm9pc2UgPSBwcmV2X25vaXNlLm5vaXNlW3NmYl07XG4gICAgICAgICAgICAgICAgaiArPSBjb2RfaW5mby53aWR0aFtzZmJdO1xuICAgICAgICAgICAgICAgIGRpc3RvcnRbZGlzdG9ydFBvcysrXSA9IG5vaXNlIC8gbDNfeG1pbltsM194bWluUG9zKytdO1xuXG4gICAgICAgICAgICAgICAgbm9pc2UgPSBwcmV2X25vaXNlLm5vaXNlX2xvZ1tzZmJdO1xuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBzdGVwID0gUE9XMjAocyk7XG4gICAgICAgICAgICAgICAgbCA9IGNvZF9pbmZvLndpZHRoW3NmYl0gPj4gMTtcblxuICAgICAgICAgICAgICAgIGlmICgoaiArIGNvZF9pbmZvLndpZHRoW3NmYl0pID4gY29kX2luZm8ubWF4X25vbnplcm9fY29lZmYpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVzZWZ1bGxzaXplO1xuICAgICAgICAgICAgICAgICAgICB1c2VmdWxsc2l6ZSA9IGNvZF9pbmZvLm1heF9ub256ZXJvX2NvZWZmIC0gaiArIDE7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZWZ1bGxzaXplID4gMClcbiAgICAgICAgICAgICAgICAgICAgICAgIGwgPSB1c2VmdWxsc2l6ZSA+PiAxO1xuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBsID0gMDtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgc2wgPSBuZXcgU3RhcnRMaW5lKGopO1xuICAgICAgICAgICAgICAgIG5vaXNlID0gdGhpcy5jYWxjX25vaXNlX2NvcmUoY29kX2luZm8sIHNsLCBsLCBzdGVwKTtcbiAgICAgICAgICAgICAgICBqID0gc2wucztcblxuICAgICAgICAgICAgICAgIGlmIChwcmV2X25vaXNlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgLyogc2F2ZSBub2lzZSB2YWx1ZXMgKi9cbiAgICAgICAgICAgICAgICAgICAgcHJldl9ub2lzZS5zdGVwW3NmYl0gPSBzO1xuICAgICAgICAgICAgICAgICAgICBwcmV2X25vaXNlLm5vaXNlW3NmYl0gPSBub2lzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBub2lzZSA9IGRpc3RvcnRbZGlzdG9ydFBvcysrXSA9IG5vaXNlIC8gbDNfeG1pbltsM194bWluUG9zKytdO1xuXG4gICAgICAgICAgICAgICAgLyogbXVsdGlwbHlpbmcgaGVyZSBpcyBhZGRpbmcgaW4gZEIsIGJ1dCBjYW4gb3ZlcmZsb3cgKi9cbiAgICAgICAgICAgICAgICBub2lzZSA9IFV0aWwuRkFTVF9MT0cxMChNYXRoLm1heChub2lzZSwgMUUtMjApKTtcblxuICAgICAgICAgICAgICAgIGlmIChwcmV2X25vaXNlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgLyogc2F2ZSBub2lzZSB2YWx1ZXMgKi9cbiAgICAgICAgICAgICAgICAgICAgcHJldl9ub2lzZS5ub2lzZV9sb2dbc2ZiXSA9IG5vaXNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHByZXZfbm9pc2UgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIC8qIHNhdmUgbm9pc2UgdmFsdWVzICovXG4gICAgICAgICAgICAgICAgcHJldl9ub2lzZS5nbG9iYWxfZ2FpbiA9IGNvZF9pbmZvLmdsb2JhbF9nYWluO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0b3Rfbm9pc2VfZGIgKz0gbm9pc2U7XG5cbiAgICAgICAgICAgIGlmIChub2lzZSA+IDAuMCkge1xuICAgICAgICAgICAgICAgIHZhciB0bXA7XG5cbiAgICAgICAgICAgICAgICB0bXAgPSBNYXRoLm1heCgwIHwgKG5vaXNlICogMTAgKyAuNSksIDEpO1xuICAgICAgICAgICAgICAgIHJlcy5vdmVyX1NTRCArPSB0bXAgKiB0bXA7XG5cbiAgICAgICAgICAgICAgICBvdmVyKys7XG4gICAgICAgICAgICAgICAgLyogbXVsdGlwbHlpbmcgaGVyZSBpcyBhZGRpbmcgaW4gZEIgLWJ1dCBjYW4gb3ZlcmZsb3cgKi9cbiAgICAgICAgICAgICAgICAvKiBvdmVyX25vaXNlICo9IG5vaXNlOyAqL1xuICAgICAgICAgICAgICAgIG92ZXJfbm9pc2VfZGIgKz0gbm9pc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtYXhfbm9pc2UgPSBNYXRoLm1heChtYXhfbm9pc2UsIG5vaXNlKTtcblxuICAgICAgICB9XG5cbiAgICAgICAgcmVzLm92ZXJfY291bnQgPSBvdmVyO1xuICAgICAgICByZXMudG90X25vaXNlID0gdG90X25vaXNlX2RiO1xuICAgICAgICByZXMub3Zlcl9ub2lzZSA9IG92ZXJfbm9pc2VfZGI7XG4gICAgICAgIHJlcy5tYXhfbm9pc2UgPSBtYXhfbm9pc2U7XG5cbiAgICAgICAgcmV0dXJuIG92ZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogdXBkYXRlcyBwbG90dGluZyBkYXRhXG4gICAgICpcbiAgICAgKiBNYXJrIFRheWxvciAyMDAwLT8/LT8/XG4gICAgICpcbiAgICAgKiBSb2JlcnQgSGVnZW1hbm46IG1vdmVkIG5vaXNlL2Rpc3RvcnRpb24gY2FsYyBpbnRvIGl0XG4gICAgICovXG4gICAgdGhpcy5zZXRfcGluZm8gPSBmdW5jdGlvbiAoZ2ZwLCBjb2RfaW5mbywgcmF0aW8sIGdyLCBjaCkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgc2ZiLCBzZmIyO1xuICAgICAgICB2YXIgbDtcbiAgICAgICAgdmFyIGVuMCwgZW4xO1xuICAgICAgICB2YXIgaWZxc3RlcCA9IChjb2RfaW5mby5zY2FsZWZhY19zY2FsZSA9PSAwKSA/IC41IDogMS4wO1xuICAgICAgICB2YXIgc2NhbGVmYWMgPSBjb2RfaW5mby5zY2FsZWZhYztcblxuICAgICAgICB2YXIgbDNfeG1pbiA9IG5ld19mbG9hdChMM1NpZGUuU0ZCTUFYKTtcbiAgICAgICAgdmFyIHhmc2YgPSBuZXdfZmxvYXQoTDNTaWRlLlNGQk1BWCk7XG4gICAgICAgIHZhciBub2lzZSA9IG5ldyBDYWxjTm9pc2VSZXN1bHQoKTtcblxuICAgICAgICBjYWxjX3htaW4oZ2ZwLCByYXRpbywgY29kX2luZm8sIGwzX3htaW4pO1xuICAgICAgICBjYWxjX25vaXNlKGNvZF9pbmZvLCBsM194bWluLCB4ZnNmLCBub2lzZSwgbnVsbCk7XG5cbiAgICAgICAgdmFyIGogPSAwO1xuICAgICAgICBzZmIyID0gY29kX2luZm8uc2ZiX2xtYXg7XG4gICAgICAgIGlmIChjb2RfaW5mby5ibG9ja190eXBlICE9IEVuY29kZXIuU0hPUlRfVFlQRVxuICAgICAgICAgICAgJiYgMCA9PSBjb2RfaW5mby5taXhlZF9ibG9ja19mbGFnKVxuICAgICAgICAgICAgc2ZiMiA9IDIyO1xuICAgICAgICBmb3IgKHNmYiA9IDA7IHNmYiA8IHNmYjI7IHNmYisrKSB7XG4gICAgICAgICAgICB2YXIgc3RhcnQgPSBnZmMuc2NhbGVmYWNfYmFuZC5sW3NmYl07XG4gICAgICAgICAgICB2YXIgZW5kID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFtzZmIgKyAxXTtcbiAgICAgICAgICAgIHZhciBidyA9IGVuZCAtIHN0YXJ0O1xuICAgICAgICAgICAgZm9yIChlbjAgPSAwLjA7IGogPCBlbmQ7IGorKylcbiAgICAgICAgICAgICAgICBlbjAgKz0gY29kX2luZm8ueHJbal0gKiBjb2RfaW5mby54cltqXTtcbiAgICAgICAgICAgIGVuMCAvPSBidztcbiAgICAgICAgICAgIC8qIGNvbnZlcnQgdG8gTURDVCB1bml0cyAqL1xuICAgICAgICAgICAgLyogc2NhbGluZyBzbyBpdCBzaG93cyB1cCBvbiBGRlQgcGxvdCAqL1xuICAgICAgICAgICAgZW4xID0gMWUxNTtcbiAgICAgICAgICAgIGdmYy5waW5mby5lbltncl1bY2hdW3NmYl0gPSBlbjEgKiBlbjA7XG4gICAgICAgICAgICBnZmMucGluZm8ueGZzZltncl1bY2hdW3NmYl0gPSBlbjEgKiBsM194bWluW3NmYl0gKiB4ZnNmW3NmYl0gLyBidztcblxuICAgICAgICAgICAgaWYgKHJhdGlvLmVuLmxbc2ZiXSA+IDAgJiYgIWdmcC5BVEhvbmx5KVxuICAgICAgICAgICAgICAgIGVuMCA9IGVuMCAvIHJhdGlvLmVuLmxbc2ZiXTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBlbjAgPSAwLjA7XG5cbiAgICAgICAgICAgIGdmYy5waW5mby50aHJbZ3JdW2NoXVtzZmJdID0gZW4xXG4gICAgICAgICAgICAgICAgKiBNYXRoLm1heChlbjAgKiByYXRpby50aG0ubFtzZmJdLCBnZmMuQVRILmxbc2ZiXSk7XG5cbiAgICAgICAgICAgIC8qIHRoZXJlIGlzIG5vIHNjYWxlZmFjdG9yIGJhbmRzID49IFNCUFNZX2wgKi9cbiAgICAgICAgICAgIGdmYy5waW5mby5MQU1Fc2ZiW2dyXVtjaF1bc2ZiXSA9IDA7XG4gICAgICAgICAgICBpZiAoY29kX2luZm8ucHJlZmxhZyAhPSAwICYmIHNmYiA+PSAxMSlcbiAgICAgICAgICAgICAgICBnZmMucGluZm8uTEFNRXNmYltncl1bY2hdW3NmYl0gPSAtaWZxc3RlcCAqIHByZXRhYltzZmJdO1xuXG4gICAgICAgICAgICBpZiAoc2ZiIDwgRW5jb2Rlci5TQlBTWV9sKSB7XG4gICAgICAgICAgICAgICAgLyogc2Nmc2kgc2hvdWxkIGJlIGRlY29kZWQgYnkgY2FsbGVyIHNpZGUgKi9cbiAgICAgICAgICAgICAgICBnZmMucGluZm8uTEFNRXNmYltncl1bY2hdW3NmYl0gLT0gaWZxc3RlcCAqIHNjYWxlZmFjW3NmYl07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyogZm9yIHNmYiAqL1xuXG4gICAgICAgIGlmIChjb2RfaW5mby5ibG9ja190eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgc2ZiMiA9IHNmYjtcbiAgICAgICAgICAgIGZvciAoc2ZiID0gY29kX2luZm8uc2ZiX3NtaW47IHNmYiA8IEVuY29kZXIuU0JNQVhfczsgc2ZiKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBnZmMuc2NhbGVmYWNfYmFuZC5zW3NmYl07XG4gICAgICAgICAgICAgICAgdmFyIGVuZCA9IGdmYy5zY2FsZWZhY19iYW5kLnNbc2ZiICsgMV07XG4gICAgICAgICAgICAgICAgdmFyIGJ3ID0gZW5kIC0gc3RhcnQ7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChlbjAgPSAwLjAsIGwgPSBzdGFydDsgbCA8IGVuZDsgbCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbjAgKz0gY29kX2luZm8ueHJbal0gKiBjb2RfaW5mby54cltqXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGorKztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbjAgPSBNYXRoLm1heChlbjAgLyBidywgMWUtMjApO1xuICAgICAgICAgICAgICAgICAgICAvKiBjb252ZXJ0IHRvIE1EQ1QgdW5pdHMgKi9cbiAgICAgICAgICAgICAgICAgICAgLyogc2NhbGluZyBzbyBpdCBzaG93cyB1cCBvbiBGRlQgcGxvdCAqL1xuICAgICAgICAgICAgICAgICAgICBlbjEgPSAxZTE1O1xuXG4gICAgICAgICAgICAgICAgICAgIGdmYy5waW5mby5lbl9zW2dyXVtjaF1bMyAqIHNmYiArIGldID0gZW4xICogZW4wO1xuICAgICAgICAgICAgICAgICAgICBnZmMucGluZm8ueGZzZl9zW2dyXVtjaF1bMyAqIHNmYiArIGldID0gZW4xICogbDNfeG1pbltzZmIyXVxuICAgICAgICAgICAgICAgICAgICAgICAgKiB4ZnNmW3NmYjJdIC8gYnc7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyYXRpby5lbi5zW3NmYl1baV0gPiAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgZW4wID0gZW4wIC8gcmF0aW8uZW4uc1tzZmJdW2ldO1xuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBlbjAgPSAwLjA7XG4gICAgICAgICAgICAgICAgICAgIGlmIChnZnAuQVRIb25seSB8fCBnZnAuQVRIc2hvcnQpXG4gICAgICAgICAgICAgICAgICAgICAgICBlbjAgPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgIGdmYy5waW5mby50aHJfc1tncl1bY2hdWzMgKiBzZmIgKyBpXSA9IGVuMVxuICAgICAgICAgICAgICAgICAgICAgICAgKiBNYXRoLm1heChlbjAgKiByYXRpby50aG0uc1tzZmJdW2ldLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdmYy5BVEguc1tzZmJdKTtcblxuICAgICAgICAgICAgICAgICAgICAvKiB0aGVyZSBpcyBubyBzY2FsZWZhY3RvciBiYW5kcyA+PSBTQlBTWV9zICovXG4gICAgICAgICAgICAgICAgICAgIGdmYy5waW5mby5MQU1Fc2ZiX3NbZ3JdW2NoXVszICogc2ZiICsgaV0gPSAtMi4wXG4gICAgICAgICAgICAgICAgICAgICAgICAqIGNvZF9pbmZvLnN1YmJsb2NrX2dhaW5baV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZmIgPCBFbmNvZGVyLlNCUFNZX3MpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdmYy5waW5mby5MQU1Fc2ZiX3NbZ3JdW2NoXVszICogc2ZiICsgaV0gLT0gaWZxc3RlcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICogc2NhbGVmYWNbc2ZiMl07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2ZiMisrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiBibG9jayB0eXBlIHNob3J0ICovXG4gICAgICAgIGdmYy5waW5mby5MQU1FcXNzW2dyXVtjaF0gPSBjb2RfaW5mby5nbG9iYWxfZ2FpbjtcbiAgICAgICAgZ2ZjLnBpbmZvLkxBTUVtYWluYml0c1tncl1bY2hdID0gY29kX2luZm8ucGFydDJfM19sZW5ndGhcbiAgICAgICAgICAgICsgY29kX2luZm8ucGFydDJfbGVuZ3RoO1xuICAgICAgICBnZmMucGluZm8uTEFNRXNmYml0c1tncl1bY2hdID0gY29kX2luZm8ucGFydDJfbGVuZ3RoO1xuXG4gICAgICAgIGdmYy5waW5mby5vdmVyW2dyXVtjaF0gPSBub2lzZS5vdmVyX2NvdW50O1xuICAgICAgICBnZmMucGluZm8ubWF4X25vaXNlW2dyXVtjaF0gPSBub2lzZS5tYXhfbm9pc2UgKiAxMC4wO1xuICAgICAgICBnZmMucGluZm8ub3Zlcl9ub2lzZVtncl1bY2hdID0gbm9pc2Uub3Zlcl9ub2lzZSAqIDEwLjA7XG4gICAgICAgIGdmYy5waW5mby50b3Rfbm9pc2VbZ3JdW2NoXSA9IG5vaXNlLnRvdF9ub2lzZSAqIDEwLjA7XG4gICAgICAgIGdmYy5waW5mby5vdmVyX1NTRFtncl1bY2hdID0gbm9pc2Uub3Zlcl9TU0Q7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogdXBkYXRlcyBwbG90dGluZyBkYXRhIGZvciBhIHdob2xlIGZyYW1lXG4gICAgICpcbiAgICAgKiBSb2JlcnQgSGVnZW1hbm4gMjAwMC0xMC0yMVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHNldF9mcmFtZV9waW5mbyhnZnAsIHJhdGlvKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cbiAgICAgICAgZ2ZjLm1hc2tpbmdfbG93ZXIgPSAxLjA7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogZm9yIGV2ZXJ5IGdyYW51bGUgYW5kIGNoYW5uZWwgcGF0Y2ggbDNfZW5jIGFuZCBzZXQgaW5mb1xuICAgICAgICAgKi9cbiAgICAgICAgZm9yICh2YXIgZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgIHZhciBjb2RfaW5mbyA9IGdmYy5sM19zaWRlLnR0W2dyXVtjaF07XG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlZmFjX3NhdiA9IG5ld19pbnQoTDNTaWRlLlNGQk1BWCk7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmFycmF5Y29weShjb2RfaW5mby5zY2FsZWZhYywgMCwgc2NhbGVmYWNfc2F2LCAwLFxuICAgICAgICAgICAgICAgICAgICBzY2FsZWZhY19zYXYubGVuZ3RoKTtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogcmVjb25zdHJ1Y3QgdGhlIHNjYWxlZmFjdG9ycyBpbiBjYXNlIFNDRlNJIHdhcyB1c2VkXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgaWYgKGdyID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNmYjtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChzZmIgPSAwOyBzZmIgPCBjb2RfaW5mby5zZmJfbG1heDsgc2ZiKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2RfaW5mby5zY2FsZWZhY1tzZmJdIDwgMCkgLyogc2Nmc2kgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RfaW5mby5zY2FsZWZhY1tzZmJdID0gZ2ZjLmwzX3NpZGUudHRbMF1bY2hdLnNjYWxlZmFjW3NmYl07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBzZXRfcGluZm8oZ2ZwLCBjb2RfaW5mbywgcmF0aW9bZ3JdW2NoXSwgZ3IsIGNoKTtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KHNjYWxlZmFjX3NhdiwgMCwgY29kX2luZm8uc2NhbGVmYWMsIDAsXG4gICAgICAgICAgICAgICAgICAgIHNjYWxlZmFjX3Nhdi5sZW5ndGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogZm9yIGNoICovXG4gICAgICAgIH1cbiAgICAgICAgLyogZm9yIGdyICovXG4gICAgfVxuXG59XG5cblxuZnVuY3Rpb24gQ2FsY05vaXNlRGF0YSgpIHtcbiAgICB0aGlzLmdsb2JhbF9nYWluID0gMDtcbiAgICB0aGlzLnNmYl9jb3VudDEgPSAwO1xuICAgIHRoaXMuc3RlcCA9IG5ld19pbnQoMzkpO1xuICAgIHRoaXMubm9pc2UgPSBuZXdfZmxvYXQoMzkpO1xuICAgIHRoaXMubm9pc2VfbG9nID0gbmV3X2Zsb2F0KDM5KTtcbn1cblxuLy9wYWNrYWdlIG1wMztcblxuXG5mdW5jdGlvbiBHckluZm8oKSB7XG4gICAgLy9mbG9hdCB4cltdID0gbmV3IGZsb2F0WzU3Nl07XG4gICAgdGhpcy54ciA9IG5ld19mbG9hdCg1NzYpO1xuICAgIC8vaW50IGwzX2VuY1tdID0gbmV3IGludFs1NzZdO1xuICAgIHRoaXMubDNfZW5jID0gbmV3X2ludCg1NzYpO1xuICAgIC8vaW50IHNjYWxlZmFjW10gPSBuZXcgaW50W0wzU2lkZS5TRkJNQVhdO1xuICAgIHRoaXMuc2NhbGVmYWMgPSBuZXdfaW50KEwzU2lkZS5TRkJNQVgpO1xuICAgIHRoaXMueHJwb3dfbWF4ID0gMC47XG5cbiAgICB0aGlzLnBhcnQyXzNfbGVuZ3RoID0gMDtcbiAgICB0aGlzLmJpZ192YWx1ZXMgPSAwO1xuICAgIHRoaXMuY291bnQxID0gMDtcbiAgICB0aGlzLmdsb2JhbF9nYWluID0gMDtcbiAgICB0aGlzLnNjYWxlZmFjX2NvbXByZXNzID0gMDtcbiAgICB0aGlzLmJsb2NrX3R5cGUgPSAwO1xuICAgIHRoaXMubWl4ZWRfYmxvY2tfZmxhZyA9IDA7XG4gICAgdGhpcy50YWJsZV9zZWxlY3QgPSBuZXdfaW50KDMpO1xuICAgIHRoaXMuc3ViYmxvY2tfZ2FpbiA9IG5ld19pbnQoMyArIDEpO1xuICAgIHRoaXMucmVnaW9uMF9jb3VudCA9IDA7XG4gICAgdGhpcy5yZWdpb24xX2NvdW50ID0gMDtcbiAgICB0aGlzLnByZWZsYWcgPSAwO1xuICAgIHRoaXMuc2NhbGVmYWNfc2NhbGUgPSAwO1xuICAgIHRoaXMuY291bnQxdGFibGVfc2VsZWN0ID0gMDtcblxuICAgIHRoaXMucGFydDJfbGVuZ3RoID0gMDtcbiAgICB0aGlzLnNmYl9sbWF4ID0gMDtcbiAgICB0aGlzLnNmYl9zbWluID0gMDtcbiAgICB0aGlzLnBzeV9sbWF4ID0gMDtcbiAgICB0aGlzLnNmYm1heCA9IDA7XG4gICAgdGhpcy5wc3ltYXggPSAwO1xuICAgIHRoaXMuc2ZiZGl2aWRlID0gMDtcbiAgICB0aGlzLndpZHRoID0gbmV3X2ludChMM1NpZGUuU0ZCTUFYKTtcbiAgICB0aGlzLndpbmRvdyA9IG5ld19pbnQoTDNTaWRlLlNGQk1BWCk7XG4gICAgdGhpcy5jb3VudDFiaXRzID0gMDtcbiAgICAvKipcbiAgICAgKiBhZGRlZCBmb3IgTFNGXG4gICAgICovXG4gICAgdGhpcy5zZmJfcGFydGl0aW9uX3RhYmxlID0gbnVsbDtcbiAgICB0aGlzLnNsZW4gPSBuZXdfaW50KDQpO1xuXG4gICAgdGhpcy5tYXhfbm9uemVyb19jb2VmZiA9IDA7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgZnVuY3Rpb24gY2xvbmVfaW50KGFycmF5KSB7XG4gICAgICAgIHJldHVybiBuZXcgSW50MzJBcnJheShhcnJheSk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNsb25lX2Zsb2F0KGFycmF5KSB7XG4gICAgICAgIHJldHVybiBuZXcgRmxvYXQzMkFycmF5KGFycmF5KTtcbiAgICB9XG4gICAgdGhpcy5hc3NpZ24gPSBmdW5jdGlvbiAob3RoZXIpIHtcbiAgICAgICAgc2VsZi54ciA9IGNsb25lX2Zsb2F0KG90aGVyLnhyKTsgLy8uc2xpY2UoMCk7IC8vY2xvbmUoKTtcbiAgICAgICAgc2VsZi5sM19lbmMgPSBjbG9uZV9pbnQob3RoZXIubDNfZW5jKTsgLy8uc2xpY2UoMCk7IC8vY2xvbmUoKTtcbiAgICAgICAgc2VsZi5zY2FsZWZhYyA9IGNsb25lX2ludChvdGhlci5zY2FsZWZhYyk7Ly8uc2xpY2UoMCk7IC8vY2xvbmUoKTtcbiAgICAgICAgc2VsZi54cnBvd19tYXggPSBvdGhlci54cnBvd19tYXg7XG5cbiAgICAgICAgc2VsZi5wYXJ0Ml8zX2xlbmd0aCA9IG90aGVyLnBhcnQyXzNfbGVuZ3RoO1xuICAgICAgICBzZWxmLmJpZ192YWx1ZXMgPSBvdGhlci5iaWdfdmFsdWVzO1xuICAgICAgICBzZWxmLmNvdW50MSA9IG90aGVyLmNvdW50MTtcbiAgICAgICAgc2VsZi5nbG9iYWxfZ2FpbiA9IG90aGVyLmdsb2JhbF9nYWluO1xuICAgICAgICBzZWxmLnNjYWxlZmFjX2NvbXByZXNzID0gb3RoZXIuc2NhbGVmYWNfY29tcHJlc3M7XG4gICAgICAgIHNlbGYuYmxvY2tfdHlwZSA9IG90aGVyLmJsb2NrX3R5cGU7XG4gICAgICAgIHNlbGYubWl4ZWRfYmxvY2tfZmxhZyA9IG90aGVyLm1peGVkX2Jsb2NrX2ZsYWc7XG4gICAgICAgIHNlbGYudGFibGVfc2VsZWN0ID0gY2xvbmVfaW50KG90aGVyLnRhYmxlX3NlbGVjdCk7Ly8uc2xpY2UoMCk7IC8vY2xvbmUoKTtcbiAgICAgICAgc2VsZi5zdWJibG9ja19nYWluID0gY2xvbmVfaW50KG90aGVyLnN1YmJsb2NrX2dhaW4pOyAvLy5zbGljZSgwKTsgLy8uY2xvbmUoKTtcbiAgICAgICAgc2VsZi5yZWdpb24wX2NvdW50ID0gb3RoZXIucmVnaW9uMF9jb3VudDtcbiAgICAgICAgc2VsZi5yZWdpb24xX2NvdW50ID0gb3RoZXIucmVnaW9uMV9jb3VudDtcbiAgICAgICAgc2VsZi5wcmVmbGFnID0gb3RoZXIucHJlZmxhZztcbiAgICAgICAgc2VsZi5zY2FsZWZhY19zY2FsZSA9IG90aGVyLnNjYWxlZmFjX3NjYWxlO1xuICAgICAgICBzZWxmLmNvdW50MXRhYmxlX3NlbGVjdCA9IG90aGVyLmNvdW50MXRhYmxlX3NlbGVjdDtcblxuICAgICAgICBzZWxmLnBhcnQyX2xlbmd0aCA9IG90aGVyLnBhcnQyX2xlbmd0aDtcbiAgICAgICAgc2VsZi5zZmJfbG1heCA9IG90aGVyLnNmYl9sbWF4O1xuICAgICAgICBzZWxmLnNmYl9zbWluID0gb3RoZXIuc2ZiX3NtaW47XG4gICAgICAgIHNlbGYucHN5X2xtYXggPSBvdGhlci5wc3lfbG1heDtcbiAgICAgICAgc2VsZi5zZmJtYXggPSBvdGhlci5zZmJtYXg7XG4gICAgICAgIHNlbGYucHN5bWF4ID0gb3RoZXIucHN5bWF4O1xuICAgICAgICBzZWxmLnNmYmRpdmlkZSA9IG90aGVyLnNmYmRpdmlkZTtcbiAgICAgICAgc2VsZi53aWR0aCA9IGNsb25lX2ludChvdGhlci53aWR0aCk7IC8vLnNsaWNlKDApOyAvLy5jbG9uZSgpO1xuICAgICAgICBzZWxmLndpbmRvdyA9IGNsb25lX2ludChvdGhlci53aW5kb3cpOyAvLy5zbGljZSgwKTsgLy8uY2xvbmUoKTtcbiAgICAgICAgc2VsZi5jb3VudDFiaXRzID0gb3RoZXIuY291bnQxYml0cztcblxuICAgICAgICBzZWxmLnNmYl9wYXJ0aXRpb25fdGFibGUgPSBvdGhlci5zZmJfcGFydGl0aW9uX3RhYmxlLnNsaWNlKDApOyAvLy5jbG9uZSgpO1xuICAgICAgICBzZWxmLnNsZW4gPSBjbG9uZV9pbnQob3RoZXIuc2xlbik7IC8vLnNsaWNlKDApOyAvLy5jbG9uZSgpO1xuICAgICAgICBzZWxmLm1heF9ub256ZXJvX2NvZWZmID0gb3RoZXIubWF4X25vbnplcm9fY29lZmY7XG4gICAgfVxufVxuXG5cbnZhciBMM1NpZGUgPSB7fTtcblxuXG5cdC8qKlxuXHQgKiBtYXggc2NhbGVmYWN0b3IgYmFuZCwgbWF4KFNCTUFYX2wsIFNCTUFYX3MqMywgKFNCTUFYX3MtMykqMys4KVxuXHQgKi9cbkwzU2lkZS5TRkJNQVggPSAoRW5jb2Rlci5TQk1BWF9zICogMyk7XG5cbi8qXG4gKiBNUDMgcXVhbnRpemF0aW9uXG4gKlxuICogICAgICBDb3B5cmlnaHQgKGMpIDE5OTktMjAwMCBNYXJrIFRheWxvclxuICogICAgICBDb3B5cmlnaHQgKGMpIDE5OTktMjAwMyBUYWtlaGlybyBUb21pbmFnYVxuICogICAgICBDb3B5cmlnaHQgKGMpIDIwMDAtMjAwNyBSb2JlcnQgSGVnZW1hbm5cbiAqICAgICAgQ29weXJpZ2h0IChjKSAyMDAxLTIwMDUgR2FicmllbCBCb3V2aWduZVxuICpcbiAqIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3JcbiAqIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWNcbiAqIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlclxuICogdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLlxuICpcbiAqIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLFxuICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2ZcbiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gICAgIFNlZSB0aGUgR05VXG4gKiBMaWJyYXJ5IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cbiAqXG4gKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG4gKiBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHdyaXRlIHRvIHRoZVxuICogRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBJbmMuLCA1OSBUZW1wbGUgUGxhY2UgLSBTdWl0ZSAzMzAsXG4gKiBCb3N0b24sIE1BIDAyMTExLTEzMDcsIFVTQS5cbiAqL1xuXG4vKiAkSWQ6IFF1YW50aXplLmphdmEsdiAxLjI0IDIwMTEvMDUvMjQgMjA6NDg6MDYga2VuY2hpcyBFeHAgJCAqL1xuXG4vL3BhY2thZ2UgbXAzO1xuXG4vL2ltcG9ydCBqYXZhLnV0aWwuQXJyYXlzO1xuXG5cbmZ1bmN0aW9uIFF1YW50aXplKCkge1xuICAgIHZhciBicztcbiAgICB0aGlzLnJ2ID0gbnVsbDtcbiAgICB2YXIgcnY7XG4gICAgdGhpcy5xdXB2dCA9IG51bGw7XG4gICAgdmFyIHF1cHZ0O1xuXG4gICAgdmFyIHZiciA9IG5ldyBWQlJRdWFudGl6ZSgpO1xuICAgIHZhciB0aztcblxuICAgIHRoaXMuc2V0TW9kdWxlcyA9IGZ1bmN0aW9uIChfYnMsIF9ydiwgX3F1cHZ0LCBfdGspIHtcbiAgICAgICAgYnMgPSBfYnM7XG4gICAgICAgIHJ2ID0gX3J2O1xuICAgICAgICB0aGlzLnJ2ID0gX3J2O1xuICAgICAgICBxdXB2dCA9IF9xdXB2dDtcbiAgICAgICAgdGhpcy5xdXB2dCA9IF9xdXB2dDtcbiAgICAgICAgdGsgPSBfdGs7XG4gICAgICAgIHZici5zZXRNb2R1bGVzKHF1cHZ0LCB0ayk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY29udmVydCBmcm9tIEwvUiA8LiBNaWQvU2lkZVxuICAgICAqL1xuICAgIHRoaXMubXNfY29udmVydCA9IGZ1bmN0aW9uIChsM19zaWRlLCBncikge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDU3NjsgKytpKSB7XG4gICAgICAgICAgICB2YXIgbCA9IGwzX3NpZGUudHRbZ3JdWzBdLnhyW2ldO1xuICAgICAgICAgICAgdmFyIHIgPSBsM19zaWRlLnR0W2dyXVsxXS54cltpXTtcbiAgICAgICAgICAgIGwzX3NpZGUudHRbZ3JdWzBdLnhyW2ldID0gKGwgKyByKSAqIChVdGlsLlNRUlQyICogMC41KTtcbiAgICAgICAgICAgIGwzX3NpZGUudHRbZ3JdWzFdLnhyW2ldID0gKGwgLSByKSAqIChVdGlsLlNRUlQyICogMC41KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBtdCA2Lzk5XG4gICAgICpcbiAgICAgKiBpbml0aWFsaXplcyBjb2RfaW5mbywgc2NhbGVmYWMgYW5kIHhycG93XG4gICAgICpcbiAgICAgKiByZXR1cm5zIDAgaWYgYWxsIGVuZXJnaWVzIGluIHhyIGFyZSB6ZXJvLCBlbHNlIDFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpbml0X3hycG93X2NvcmUoY29kX2luZm8sIHhycG93LCB1cHBlciwgc3VtKSB7XG4gICAgICAgIHN1bSA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDw9IHVwcGVyOyArK2kpIHtcbiAgICAgICAgICAgIHZhciB0bXAgPSBNYXRoLmFicyhjb2RfaW5mby54cltpXSk7XG4gICAgICAgICAgICBzdW0gKz0gdG1wO1xuICAgICAgICAgICAgeHJwb3dbaV0gPSBNYXRoLnNxcnQodG1wICogTWF0aC5zcXJ0KHRtcCkpO1xuXG4gICAgICAgICAgICBpZiAoeHJwb3dbaV0gPiBjb2RfaW5mby54cnBvd19tYXgpXG4gICAgICAgICAgICAgICAgY29kX2luZm8ueHJwb3dfbWF4ID0geHJwb3dbaV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN1bTtcbiAgICB9XG5cbiAgICB0aGlzLmluaXRfeHJwb3cgPSBmdW5jdGlvbiAoZ2ZjLCBjb2RfaW5mbywgeHJwb3cpIHtcbiAgICAgICAgdmFyIHN1bSA9IDA7XG4gICAgICAgIHZhciB1cHBlciA9IDAgfCBjb2RfaW5mby5tYXhfbm9uemVyb19jb2VmZjtcblxuICAgICAgICBjb2RfaW5mby54cnBvd19tYXggPSAwO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGNoZWNrIGlmIHRoZXJlIGlzIHNvbWUgZW5lcmd5IHdlIGhhdmUgdG8gcXVhbnRpemUgYW5kIGNhbGN1bGF0ZSB4cnBvd1xuICAgICAgICAgKiBtYXRjaGluZyBvdXIgZnJlc2ggc2NhbGVmYWN0b3JzXG4gICAgICAgICAqL1xuXG4gICAgICAgIEFycmF5cy5maWxsKHhycG93LCB1cHBlciwgNTc2LCAwKTtcblxuICAgICAgICBzdW0gPSBpbml0X3hycG93X2NvcmUoY29kX2luZm8sIHhycG93LCB1cHBlciwgc3VtKTtcblxuICAgICAgICAvKlxuICAgICAgICAgKiByZXR1cm4gMSBpZiB3ZSBoYXZlIHNvbWV0aGluZyB0byBxdWFudGl6ZSwgZWxzZSAwXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoc3VtID4gMUUtMjApIHtcbiAgICAgICAgICAgIHZhciBqID0gMDtcbiAgICAgICAgICAgIGlmICgoZ2ZjLnN1YnN0ZXBfc2hhcGluZyAmIDIpICE9IDApXG4gICAgICAgICAgICAgICAgaiA9IDE7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY29kX2luZm8ucHN5bWF4OyBpKyspXG4gICAgICAgICAgICAgICAgZ2ZjLnBzZXVkb2hhbGZbaV0gPSBqO1xuXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIEFycmF5cy5maWxsKGNvZF9pbmZvLmwzX2VuYywgMCwgNTc2LCAwKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdhYnJpZWwgQm91dmlnbmUgZmViL2FwciAyMDAzPEJSPlxuICAgICAqIEFuYWxvZyBzaWxlbmNlIGRldGVjdGlvbiBpbiBwYXJ0aXRpb25uZWQgc2ZiMjEgb3Igc2ZiMTIgZm9yIHNob3J0IGJsb2Nrc1xuICAgICAqXG4gICAgICogRnJvbSB0b3AgdG8gYm90dG9tIG9mIHNmYiwgY2hhbmdlcyB0byAwIGNvZWZmcyB3aGljaCBhcmUgYmVsb3cgYXRoLiBJdFxuICAgICAqIHN0b3BzIG9uIHRoZSBmaXJzdCBjb2VmZiBoaWdoZXIgdGhhbiBhdGguXG4gICAgICovXG4gICAgZnVuY3Rpb24gcHNmYjIxX2FuYWxvZ3NpbGVuY2UoZ2ZjLCBjb2RfaW5mbykge1xuICAgICAgICB2YXIgYXRoID0gZ2ZjLkFUSDtcbiAgICAgICAgdmFyIHhyID0gY29kX2luZm8ueHI7XG5cbiAgICAgICAgaWYgKGNvZF9pbmZvLmJsb2NrX3R5cGUgIT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICAvKiBOT1JNLCBTVEFSVCBvciBTVE9QIHR5cGUsIGJ1dCBub3QgU0hPUlQgYmxvY2tzICovXG4gICAgICAgICAgICB2YXIgc3RvcCA9IGZhbHNlO1xuICAgICAgICAgICAgZm9yICh2YXIgZ3NmYiA9IEVuY29kZXIuUFNGQjIxIC0gMTsgZ3NmYiA+PSAwICYmICFzdG9wOyBnc2ZiLS0pIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBnZmMuc2NhbGVmYWNfYmFuZC5wc2ZiMjFbZ3NmYl07XG4gICAgICAgICAgICAgICAgdmFyIGVuZCA9IGdmYy5zY2FsZWZhY19iYW5kLnBzZmIyMVtnc2ZiICsgMV07XG4gICAgICAgICAgICAgICAgdmFyIGF0aDIxID0gcXVwdnQuYXRoQWRqdXN0KGF0aC5hZGp1c3QsIGF0aC5wc2ZiMjFbZ3NmYl0sXG4gICAgICAgICAgICAgICAgICAgIGF0aC5mbG9vcik7XG5cbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLm5zUHN5LmxvbmdmYWN0WzIxXSA+IDFlLTEyKVxuICAgICAgICAgICAgICAgICAgICBhdGgyMSAqPSBnZmMubnNQc3kubG9uZ2ZhY3RbMjFdO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IGVuZCAtIDE7IGogPj0gc3RhcnQ7IGotLSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoeHJbal0pIDwgYXRoMjEpXG4gICAgICAgICAgICAgICAgICAgICAgICB4cltqXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8qIG5vdGU6IHNob3J0IGJsb2NrcyBjb2VmZnMgYXJlIHJlb3JkZXJlZCAqL1xuICAgICAgICAgICAgZm9yICh2YXIgYmxvY2sgPSAwOyBibG9jayA8IDM7IGJsb2NrKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RvcCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGdzZmIgPSBFbmNvZGVyLlBTRkIxMiAtIDE7IGdzZmIgPj0gMCAmJiAhc3RvcDsgZ3NmYi0tKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IGdmYy5zY2FsZWZhY19iYW5kLnNbMTJdXG4gICAgICAgICAgICAgICAgICAgICAgICAqIDNcbiAgICAgICAgICAgICAgICAgICAgICAgICsgKGdmYy5zY2FsZWZhY19iYW5kLnNbMTNdIC0gZ2ZjLnNjYWxlZmFjX2JhbmQuc1sxMl0pXG4gICAgICAgICAgICAgICAgICAgICAgICAqIGJsb2NrXG4gICAgICAgICAgICAgICAgICAgICAgICArIChnZmMuc2NhbGVmYWNfYmFuZC5wc2ZiMTJbZ3NmYl0gLSBnZmMuc2NhbGVmYWNfYmFuZC5wc2ZiMTJbMF0pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZW5kID0gc3RhcnRcbiAgICAgICAgICAgICAgICAgICAgICAgICsgKGdmYy5zY2FsZWZhY19iYW5kLnBzZmIxMltnc2ZiICsgMV0gLSBnZmMuc2NhbGVmYWNfYmFuZC5wc2ZiMTJbZ3NmYl0pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYXRoMTIgPSBxdXB2dC5hdGhBZGp1c3QoYXRoLmFkanVzdCwgYXRoLnBzZmIxMltnc2ZiXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGF0aC5mbG9vcik7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGdmYy5uc1BzeS5zaG9ydGZhY3RbMTJdID4gMWUtMTIpXG4gICAgICAgICAgICAgICAgICAgICAgICBhdGgxMiAqPSBnZmMubnNQc3kuc2hvcnRmYWN0WzEyXTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gZW5kIC0gMTsgaiA+PSBzdGFydDsgai0tKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoeHJbal0pIDwgYXRoMTIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeHJbal0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RvcCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIHRoaXMuaW5pdF9vdXRlcl9sb29wID0gZnVuY3Rpb24gKGdmYywgY29kX2luZm8pIHtcbiAgICAgICAgLypcbiAgICAgICAgICogaW5pdGlhbGl6ZSBmcmVzaCBjb2RfaW5mb1xuICAgICAgICAgKi9cbiAgICAgICAgY29kX2luZm8ucGFydDJfM19sZW5ndGggPSAwO1xuICAgICAgICBjb2RfaW5mby5iaWdfdmFsdWVzID0gMDtcbiAgICAgICAgY29kX2luZm8uY291bnQxID0gMDtcbiAgICAgICAgY29kX2luZm8uZ2xvYmFsX2dhaW4gPSAyMTA7XG4gICAgICAgIGNvZF9pbmZvLnNjYWxlZmFjX2NvbXByZXNzID0gMDtcbiAgICAgICAgLyogbWl4ZWRfYmxvY2tfZmxhZywgYmxvY2tfdHlwZSB3YXMgc2V0IGluIHBzeW1vZGVsLmMgKi9cbiAgICAgICAgY29kX2luZm8udGFibGVfc2VsZWN0WzBdID0gMDtcbiAgICAgICAgY29kX2luZm8udGFibGVfc2VsZWN0WzFdID0gMDtcbiAgICAgICAgY29kX2luZm8udGFibGVfc2VsZWN0WzJdID0gMDtcbiAgICAgICAgY29kX2luZm8uc3ViYmxvY2tfZ2FpblswXSA9IDA7XG4gICAgICAgIGNvZF9pbmZvLnN1YmJsb2NrX2dhaW5bMV0gPSAwO1xuICAgICAgICBjb2RfaW5mby5zdWJibG9ja19nYWluWzJdID0gMDtcbiAgICAgICAgY29kX2luZm8uc3ViYmxvY2tfZ2FpblszXSA9IDA7XG4gICAgICAgIC8qIHRoaXMgb25lIGlzIGFsd2F5cyAwICovXG4gICAgICAgIGNvZF9pbmZvLnJlZ2lvbjBfY291bnQgPSAwO1xuICAgICAgICBjb2RfaW5mby5yZWdpb24xX2NvdW50ID0gMDtcbiAgICAgICAgY29kX2luZm8ucHJlZmxhZyA9IDA7XG4gICAgICAgIGNvZF9pbmZvLnNjYWxlZmFjX3NjYWxlID0gMDtcbiAgICAgICAgY29kX2luZm8uY291bnQxdGFibGVfc2VsZWN0ID0gMDtcbiAgICAgICAgY29kX2luZm8ucGFydDJfbGVuZ3RoID0gMDtcbiAgICAgICAgY29kX2luZm8uc2ZiX2xtYXggPSBFbmNvZGVyLlNCUFNZX2w7XG4gICAgICAgIGNvZF9pbmZvLnNmYl9zbWluID0gRW5jb2Rlci5TQlBTWV9zO1xuICAgICAgICBjb2RfaW5mby5wc3lfbG1heCA9IGdmYy5zZmIyMV9leHRyYSA/IEVuY29kZXIuU0JNQVhfbCA6IEVuY29kZXIuU0JQU1lfbDtcbiAgICAgICAgY29kX2luZm8ucHN5bWF4ID0gY29kX2luZm8ucHN5X2xtYXg7XG4gICAgICAgIGNvZF9pbmZvLnNmYm1heCA9IGNvZF9pbmZvLnNmYl9sbWF4O1xuICAgICAgICBjb2RfaW5mby5zZmJkaXZpZGUgPSAxMTtcbiAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgRW5jb2Rlci5TQk1BWF9sOyBzZmIrKykge1xuICAgICAgICAgICAgY29kX2luZm8ud2lkdGhbc2ZiXSA9IGdmYy5zY2FsZWZhY19iYW5kLmxbc2ZiICsgMV1cbiAgICAgICAgICAgICAgICAtIGdmYy5zY2FsZWZhY19iYW5kLmxbc2ZiXTtcbiAgICAgICAgICAgIC8qIHdoaWNoIGlzIGFsd2F5cyAwLiAqL1xuICAgICAgICAgICAgY29kX2luZm8ud2luZG93W3NmYl0gPSAzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb2RfaW5mby5ibG9ja190eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgdmFyIGl4d29yayA9IG5ld19mbG9hdCg1NzYpO1xuXG4gICAgICAgICAgICBjb2RfaW5mby5zZmJfc21pbiA9IDA7XG4gICAgICAgICAgICBjb2RfaW5mby5zZmJfbG1heCA9IDA7XG4gICAgICAgICAgICBpZiAoY29kX2luZm8ubWl4ZWRfYmxvY2tfZmxhZyAhPSAwKSB7XG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBNUEVHLTE6IHNmYnMgMC03IGxvbmcgYmxvY2ssIDMtMTIgc2hvcnQgYmxvY2tzIE1QRUctMiguNSk6XG4gICAgICAgICAgICAgICAgICogc2ZicyAwLTUgbG9uZyBibG9jaywgMy0xMiBzaG9ydCBibG9ja3NcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBjb2RfaW5mby5zZmJfc21pbiA9IDM7XG4gICAgICAgICAgICAgICAgY29kX2luZm8uc2ZiX2xtYXggPSBnZmMubW9kZV9nciAqIDIgKyA0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29kX2luZm8ucHN5bWF4ID0gY29kX2luZm8uc2ZiX2xtYXhcbiAgICAgICAgICAgICAgICArIDNcbiAgICAgICAgICAgICAgICAqICgoZ2ZjLnNmYjIxX2V4dHJhID8gRW5jb2Rlci5TQk1BWF9zIDogRW5jb2Rlci5TQlBTWV9zKSAtIGNvZF9pbmZvLnNmYl9zbWluKTtcbiAgICAgICAgICAgIGNvZF9pbmZvLnNmYm1heCA9IGNvZF9pbmZvLnNmYl9sbWF4ICsgM1xuICAgICAgICAgICAgICAgICogKEVuY29kZXIuU0JQU1lfcyAtIGNvZF9pbmZvLnNmYl9zbWluKTtcbiAgICAgICAgICAgIGNvZF9pbmZvLnNmYmRpdmlkZSA9IGNvZF9pbmZvLnNmYm1heCAtIDE4O1xuICAgICAgICAgICAgY29kX2luZm8ucHN5X2xtYXggPSBjb2RfaW5mby5zZmJfbG1heDtcbiAgICAgICAgICAgIC8qIHJlLW9yZGVyIHRoZSBzaG9ydCBibG9ja3MsIGZvciBtb3JlIGVmZmljaWVudCBlbmNvZGluZyBiZWxvdyAqL1xuICAgICAgICAgICAgLyogQnkgVGFrZWhpcm8gVE9NSU5BR0EgKi9cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBXaXRoaW4gZWFjaCBzY2FsZWZhY3RvciBiYW5kLCBkYXRhIGlzIGdpdmVuIGZvciBzdWNjZXNzaXZlIHRpbWVcbiAgICAgICAgICAgICAqIHdpbmRvd3MsIGJlZ2lubmluZyB3aXRoIHdpbmRvdyAwIGFuZCBlbmRpbmcgd2l0aCB3aW5kb3cgMi4gV2l0aGluXG4gICAgICAgICAgICAgKiBlYWNoIHdpbmRvdywgdGhlIHF1YW50aXplZCB2YWx1ZXMgYXJlIHRoZW4gYXJyYW5nZWQgaW4gb3JkZXIgb2ZcbiAgICAgICAgICAgICAqIGluY3JlYXNpbmcgZnJlcXVlbmN5Li4uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhciBpeCA9IGdmYy5zY2FsZWZhY19iYW5kLmxbY29kX2luZm8uc2ZiX2xtYXhdO1xuICAgICAgICAgICAgU3lzdGVtLmFycmF5Y29weShjb2RfaW5mby54ciwgMCwgaXh3b3JrLCAwLCA1NzYpO1xuICAgICAgICAgICAgZm9yICh2YXIgc2ZiID0gY29kX2luZm8uc2ZiX3NtaW47IHNmYiA8IEVuY29kZXIuU0JNQVhfczsgc2ZiKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBnZmMuc2NhbGVmYWNfYmFuZC5zW3NmYl07XG4gICAgICAgICAgICAgICAgdmFyIGVuZCA9IGdmYy5zY2FsZWZhY19iYW5kLnNbc2ZiICsgMV07XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgd2luZG93ID0gMDsgd2luZG93IDwgMzsgd2luZG93KyspIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgbCA9IHN0YXJ0OyBsIDwgZW5kOyBsKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvLnhyW2l4KytdID0gaXh3b3JrWzMgKiBsICsgd2luZG93XTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGogPSBjb2RfaW5mby5zZmJfbG1heDtcbiAgICAgICAgICAgIGZvciAodmFyIHNmYiA9IGNvZF9pbmZvLnNmYl9zbWluOyBzZmIgPCBFbmNvZGVyLlNCTUFYX3M7IHNmYisrKSB7XG4gICAgICAgICAgICAgICAgY29kX2luZm8ud2lkdGhbal0gPSBjb2RfaW5mby53aWR0aFtqICsgMV0gPSBjb2RfaW5mby53aWR0aFtqICsgMl0gPSBnZmMuc2NhbGVmYWNfYmFuZC5zW3NmYiArIDFdXG4gICAgICAgICAgICAgICAgICAgIC0gZ2ZjLnNjYWxlZmFjX2JhbmQuc1tzZmJdO1xuICAgICAgICAgICAgICAgIGNvZF9pbmZvLndpbmRvd1tqXSA9IDA7XG4gICAgICAgICAgICAgICAgY29kX2luZm8ud2luZG93W2ogKyAxXSA9IDE7XG4gICAgICAgICAgICAgICAgY29kX2luZm8ud2luZG93W2ogKyAyXSA9IDI7XG4gICAgICAgICAgICAgICAgaiArPSAzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29kX2luZm8uY291bnQxYml0cyA9IDA7XG4gICAgICAgIGNvZF9pbmZvLnNmYl9wYXJ0aXRpb25fdGFibGUgPSBxdXB2dC5ucl9vZl9zZmJfYmxvY2tbMF1bMF07XG4gICAgICAgIGNvZF9pbmZvLnNsZW5bMF0gPSAwO1xuICAgICAgICBjb2RfaW5mby5zbGVuWzFdID0gMDtcbiAgICAgICAgY29kX2luZm8uc2xlblsyXSA9IDA7XG4gICAgICAgIGNvZF9pbmZvLnNsZW5bM10gPSAwO1xuXG4gICAgICAgIGNvZF9pbmZvLm1heF9ub256ZXJvX2NvZWZmID0gNTc1O1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGZyZXNoIHNjYWxlZmFjdG9ycyBhcmUgYWxsIHplcm9cbiAgICAgICAgICovXG4gICAgICAgIEFycmF5cy5maWxsKGNvZF9pbmZvLnNjYWxlZmFjLCAwKTtcblxuICAgICAgICBwc2ZiMjFfYW5hbG9nc2lsZW5jZShnZmMsIGNvZF9pbmZvKTtcbiAgICB9O1xuXG4gICAgZnVuY3Rpb24gQmluU2VhcmNoRGlyZWN0aW9uKG9yZGluYWwpIHtcbiAgICAgICAgdGhpcy5vcmRpbmFsID0gb3JkaW5hbDtcbiAgICB9XG5cbiAgICBCaW5TZWFyY2hEaXJlY3Rpb24uQklOU0VBUkNIX05PTkUgPSBuZXcgQmluU2VhcmNoRGlyZWN0aW9uKDApO1xuICAgIEJpblNlYXJjaERpcmVjdGlvbi5CSU5TRUFSQ0hfVVAgPSBuZXcgQmluU2VhcmNoRGlyZWN0aW9uKDEpO1xuICAgIEJpblNlYXJjaERpcmVjdGlvbi5CSU5TRUFSQ0hfRE9XTiA9IG5ldyBCaW5TZWFyY2hEaXJlY3Rpb24oMik7XG5cbiAgICAvKipcbiAgICAgKiBhdXRob3IvZGF0ZT8/XG4gICAgICpcbiAgICAgKiBiaW5hcnkgc3RlcCBzaXplIHNlYXJjaCB1c2VkIGJ5IG91dGVyX2xvb3AgdG8gZ2V0IGEgcXVhbnRpemVyIHN0ZXAgc2l6ZVxuICAgICAqIHRvIHN0YXJ0IHdpdGhcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiaW5fc2VhcmNoX1N0ZXBTaXplKGdmYywgY29kX2luZm8sIGRlc2lyZWRfcmF0ZSwgY2gsIHhycG93KSB7XG4gICAgICAgIHZhciBuQml0cztcbiAgICAgICAgdmFyIEN1cnJlbnRTdGVwID0gZ2ZjLkN1cnJlbnRTdGVwW2NoXTtcbiAgICAgICAgdmFyIGZsYWdHb25lT3ZlciA9IGZhbHNlO1xuICAgICAgICB2YXIgc3RhcnQgPSBnZmMuT2xkVmFsdWVbY2hdO1xuICAgICAgICB2YXIgRGlyZWN0aW9uID0gQmluU2VhcmNoRGlyZWN0aW9uLkJJTlNFQVJDSF9OT05FO1xuICAgICAgICBjb2RfaW5mby5nbG9iYWxfZ2FpbiA9IHN0YXJ0O1xuICAgICAgICBkZXNpcmVkX3JhdGUgLT0gY29kX2luZm8ucGFydDJfbGVuZ3RoO1xuXG4gICAgICAgIGZvciAoOyA7KSB7XG4gICAgICAgICAgICB2YXIgc3RlcDtcbiAgICAgICAgICAgIG5CaXRzID0gdGsuY291bnRfYml0cyhnZmMsIHhycG93LCBjb2RfaW5mbywgbnVsbCk7XG5cbiAgICAgICAgICAgIGlmIChDdXJyZW50U3RlcCA9PSAxIHx8IG5CaXRzID09IGRlc2lyZWRfcmF0ZSlcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIC8qIG5vdGhpbmcgdG8gYWRqdXN0IGFueW1vcmUgKi9cblxuICAgICAgICAgICAgaWYgKG5CaXRzID4gZGVzaXJlZF9yYXRlKSB7XG4gICAgICAgICAgICAgICAgLyogaW5jcmVhc2UgUXVhbnRpemVfU3RlcFNpemUgKi9cbiAgICAgICAgICAgICAgICBpZiAoRGlyZWN0aW9uID09IEJpblNlYXJjaERpcmVjdGlvbi5CSU5TRUFSQ0hfRE9XTilcbiAgICAgICAgICAgICAgICAgICAgZmxhZ0dvbmVPdmVyID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgIGlmIChmbGFnR29uZU92ZXIpXG4gICAgICAgICAgICAgICAgICAgIEN1cnJlbnRTdGVwIC89IDI7XG4gICAgICAgICAgICAgICAgRGlyZWN0aW9uID0gQmluU2VhcmNoRGlyZWN0aW9uLkJJTlNFQVJDSF9VUDtcbiAgICAgICAgICAgICAgICBzdGVwID0gQ3VycmVudFN0ZXA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8qIGRlY3JlYXNlIFF1YW50aXplX1N0ZXBTaXplICovXG4gICAgICAgICAgICAgICAgaWYgKERpcmVjdGlvbiA9PSBCaW5TZWFyY2hEaXJlY3Rpb24uQklOU0VBUkNIX1VQKVxuICAgICAgICAgICAgICAgICAgICBmbGFnR29uZU92ZXIgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZsYWdHb25lT3ZlcilcbiAgICAgICAgICAgICAgICAgICAgQ3VycmVudFN0ZXAgLz0gMjtcbiAgICAgICAgICAgICAgICBEaXJlY3Rpb24gPSBCaW5TZWFyY2hEaXJlY3Rpb24uQklOU0VBUkNIX0RPV047XG4gICAgICAgICAgICAgICAgc3RlcCA9IC1DdXJyZW50U3RlcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvZF9pbmZvLmdsb2JhbF9nYWluICs9IHN0ZXA7XG4gICAgICAgICAgICBpZiAoY29kX2luZm8uZ2xvYmFsX2dhaW4gPCAwKSB7XG4gICAgICAgICAgICAgICAgY29kX2luZm8uZ2xvYmFsX2dhaW4gPSAwO1xuICAgICAgICAgICAgICAgIGZsYWdHb25lT3ZlciA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY29kX2luZm8uZ2xvYmFsX2dhaW4gPiAyNTUpIHtcbiAgICAgICAgICAgICAgICBjb2RfaW5mby5nbG9iYWxfZ2FpbiA9IDI1NTtcbiAgICAgICAgICAgICAgICBmbGFnR29uZU92ZXIgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblxuICAgICAgICB3aGlsZSAobkJpdHMgPiBkZXNpcmVkX3JhdGUgJiYgY29kX2luZm8uZ2xvYmFsX2dhaW4gPCAyNTUpIHtcbiAgICAgICAgICAgIGNvZF9pbmZvLmdsb2JhbF9nYWluKys7XG4gICAgICAgICAgICBuQml0cyA9IHRrLmNvdW50X2JpdHMoZ2ZjLCB4cnBvdywgY29kX2luZm8sIG51bGwpO1xuICAgICAgICB9XG4gICAgICAgIGdmYy5DdXJyZW50U3RlcFtjaF0gPSAoc3RhcnQgLSBjb2RfaW5mby5nbG9iYWxfZ2FpbiA+PSA0KSA/IDQgOiAyO1xuICAgICAgICBnZmMuT2xkVmFsdWVbY2hdID0gY29kX2luZm8uZ2xvYmFsX2dhaW47XG4gICAgICAgIGNvZF9pbmZvLnBhcnQyXzNfbGVuZ3RoID0gbkJpdHM7XG4gICAgICAgIHJldHVybiBuQml0cztcbiAgICB9XG5cbiAgICB0aGlzLnRyYW5jYXRlX3NtYWxsc3BlY3RydW1zID0gZnVuY3Rpb24gKGdmYywgZ2ksIGwzX3htaW4sIHdvcmspIHtcbiAgICAgICAgdmFyIGRpc3RvcnQgPSBuZXdfZmxvYXQoTDNTaWRlLlNGQk1BWCk7XG5cbiAgICAgICAgaWYgKCgwID09IChnZmMuc3Vic3RlcF9zaGFwaW5nICYgNCkgJiYgZ2kuYmxvY2tfdHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpXG4gICAgICAgICAgICB8fCAoZ2ZjLnN1YnN0ZXBfc2hhcGluZyAmIDB4ODApICE9IDApXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHF1cHZ0LmNhbGNfbm9pc2UoZ2ksIGwzX3htaW4sIGRpc3RvcnQsIG5ldyBDYWxjTm9pc2VSZXN1bHQoKSwgbnVsbCk7XG4gICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgNTc2OyBqKyspIHtcbiAgICAgICAgICAgIHZhciB4ciA9IDAuMDtcbiAgICAgICAgICAgIGlmIChnaS5sM19lbmNbal0gIT0gMClcbiAgICAgICAgICAgICAgICB4ciA9IE1hdGguYWJzKGdpLnhyW2pdKTtcbiAgICAgICAgICAgIHdvcmtbal0gPSB4cjtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBqID0gMDtcbiAgICAgICAgdmFyIHNmYiA9IDg7XG4gICAgICAgIGlmIChnaS5ibG9ja190eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRSlcbiAgICAgICAgICAgIHNmYiA9IDY7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIHZhciBhbGxvd2VkTm9pc2UsIHRyYW5jYXRlVGhyZXNob2xkO1xuICAgICAgICAgICAgdmFyIG5zYW1lLCBzdGFydDtcblxuICAgICAgICAgICAgdmFyIHdpZHRoID0gZ2kud2lkdGhbc2ZiXTtcbiAgICAgICAgICAgIGogKz0gd2lkdGg7XG4gICAgICAgICAgICBpZiAoZGlzdG9ydFtzZmJdID49IDEuMClcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICAgICAgQXJyYXlzLnNvcnQod29yaywgaiAtIHdpZHRoLCB3aWR0aCk7XG4gICAgICAgICAgICBpZiAoQml0U3RyZWFtLkVRKHdvcmtbaiAtIDFdLCAwLjApKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgLyogYWxsIHplcm8gc2ZiICovXG5cbiAgICAgICAgICAgIGFsbG93ZWROb2lzZSA9ICgxLjAgLSBkaXN0b3J0W3NmYl0pICogbDNfeG1pbltzZmJdO1xuICAgICAgICAgICAgdHJhbmNhdGVUaHJlc2hvbGQgPSAwLjA7XG4gICAgICAgICAgICBzdGFydCA9IDA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgdmFyIG5vaXNlO1xuICAgICAgICAgICAgICAgIGZvciAobnNhbWUgPSAxOyBzdGFydCArIG5zYW1lIDwgd2lkdGg7IG5zYW1lKyspXG4gICAgICAgICAgICAgICAgICAgIGlmIChCaXRTdHJlYW0uTkVRKHdvcmtbc3RhcnQgKyBqIC0gd2lkdGhdLCB3b3JrW3N0YXJ0ICsgalxuICAgICAgICAgICAgICAgICAgICAgICAgKyBuc2FtZSAtIHdpZHRoXSkpXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIG5vaXNlID0gd29ya1tzdGFydCArIGogLSB3aWR0aF0gKiB3b3JrW3N0YXJ0ICsgaiAtIHdpZHRoXVxuICAgICAgICAgICAgICAgICAgICAqIG5zYW1lO1xuICAgICAgICAgICAgICAgIGlmIChhbGxvd2VkTm9pc2UgPCBub2lzZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc3RhcnQgIT0gMClcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5jYXRlVGhyZXNob2xkID0gd29ya1tzdGFydCArIGogLSB3aWR0aCAtIDFdO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYWxsb3dlZE5vaXNlIC09IG5vaXNlO1xuICAgICAgICAgICAgICAgIHN0YXJ0ICs9IG5zYW1lO1xuICAgICAgICAgICAgfSB3aGlsZSAoc3RhcnQgPCB3aWR0aCk7XG4gICAgICAgICAgICBpZiAoQml0U3RyZWFtLkVRKHRyYW5jYXRlVGhyZXNob2xkLCAwLjApKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKGdpLnhyW2ogLSB3aWR0aF0pIDw9IHRyYW5jYXRlVGhyZXNob2xkKVxuICAgICAgICAgICAgICAgICAgICBnaS5sM19lbmNbaiAtIHdpZHRoXSA9IDA7XG4gICAgICAgICAgICB9IHdoaWxlICgtLXdpZHRoID4gMCk7XG4gICAgICAgIH0gd2hpbGUgKCsrc2ZiIDwgZ2kucHN5bWF4KTtcblxuICAgICAgICBnaS5wYXJ0Ml8zX2xlbmd0aCA9IHRrLm5vcXVhbnRfY291bnRfYml0cyhnZmMsIGdpLCBudWxsKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogYXV0aG9yL2RhdGU/P1xuICAgICAqXG4gICAgICogRnVuY3Rpb246IFJldHVybnMgemVybyBpZiB0aGVyZSBpcyBhIHNjYWxlZmFjIHdoaWNoIGhhcyBub3QgYmVlblxuICAgICAqIGFtcGxpZmllZC4gT3RoZXJ3aXNlIGl0IHJldHVybnMgb25lLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGxvb3BfYnJlYWsoY29kX2luZm8pIHtcbiAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgY29kX2luZm8uc2ZibWF4OyBzZmIrKylcbiAgICAgICAgICAgIGlmIChjb2RfaW5mby5zY2FsZWZhY1tzZmJdXG4gICAgICAgICAgICAgICAgKyBjb2RfaW5mby5zdWJibG9ja19nYWluW2NvZF9pbmZvLndpbmRvd1tzZmJdXSA9PSAwKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKiBtdCA1Lzk5OiBGdW5jdGlvbjogSW1wcm92ZWQgY2FsY19ub2lzZSBmb3IgYSBzaW5nbGUgY2hhbm5lbCAqL1xuXG4gICAgZnVuY3Rpb24gcGVuYWx0aWVzKG5vaXNlKSB7XG4gICAgICAgIHJldHVybiBVdGlsLkZBU1RfTE9HMTAoKDAuMzY4ICsgMC42MzIgKiBub2lzZSAqIG5vaXNlICogbm9pc2UpKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBhdXRob3IvZGF0ZT8/XG4gICAgICpcbiAgICAgKiBzZXZlcmFsIGRpZmZlcmVudCBjb2RlcyB0byBkZWNpZGUgd2hpY2ggcXVhbnRpemF0aW9uIGlzIGJldHRlclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldF9rbGVtbV9ub2lzZShkaXN0b3J0LCBnaSkge1xuICAgICAgICB2YXIga2xlbW1fbm9pc2UgPSAxRS0zNztcbiAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgZ2kucHN5bWF4OyBzZmIrKylcbiAgICAgICAgICAgIGtsZW1tX25vaXNlICs9IHBlbmFsdGllcyhkaXN0b3J0W3NmYl0pO1xuXG4gICAgICAgIHJldHVybiBNYXRoLm1heCgxZS0yMCwga2xlbW1fbm9pc2UpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHF1YW50X2NvbXBhcmUocXVhbnRfY29tcCwgYmVzdCwgY2FsYywgZ2ksIGRpc3RvcnQpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIG5vaXNlIGlzIGdpdmVuIGluIGRlY2liZWxzIChkQikgcmVsYXRpdmUgdG8gbWFza2luZyB0aGVzaG9sZHMuPEJSPlxuICAgICAgICAgKlxuICAgICAgICAgKiBvdmVyX25vaXNlOiA/Pz8gKHRoZSBwcmV2aW91cyBjb21tZW50IGlzIGZ1bGx5IHdyb25nKTxCUj5cbiAgICAgICAgICogdG90X25vaXNlOiA/Pz8gKHRoZSBwcmV2aW91cyBjb21tZW50IGlzIGZ1bGx5IHdyb25nKTxCUj5cbiAgICAgICAgICogbWF4X25vaXNlOiBtYXggcXVhbnRpemF0aW9uIG5vaXNlXG4gICAgICAgICAqL1xuICAgICAgICB2YXIgYmV0dGVyO1xuXG4gICAgICAgIHN3aXRjaCAocXVhbnRfY29tcCkge1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoYmVzdC5vdmVyX2NvdW50ID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAvKiB0aGVyZSBhcmUgZGlzdG9ydGVkIHNmYiAqL1xuICAgICAgICAgICAgICAgICAgICBiZXR0ZXIgPSBjYWxjLm92ZXJfU1NEIDw9IGJlc3Qub3Zlcl9TU0Q7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjYWxjLm92ZXJfU1NEID09IGJlc3Qub3Zlcl9TU0QpXG4gICAgICAgICAgICAgICAgICAgICAgICBiZXR0ZXIgPSBjYWxjLmJpdHMgPCBiZXN0LmJpdHM7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLyogbm8gZGlzdG9ydGVkIHNmYiAqL1xuICAgICAgICAgICAgICAgICAgICBiZXR0ZXIgPSAoKGNhbGMubWF4X25vaXNlIDwgMCkgJiYgKChjYWxjLm1heF9ub2lzZSAqIDEwICsgY2FsYy5iaXRzKSA8PSAoYmVzdC5tYXhfbm9pc2UgKiAxMCArIGJlc3QuYml0cykpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBiZXR0ZXIgPSBjYWxjLm92ZXJfY291bnQgPCBiZXN0Lm92ZXJfY291bnRcbiAgICAgICAgICAgICAgICAgICAgfHwgKGNhbGMub3Zlcl9jb3VudCA9PSBiZXN0Lm92ZXJfY291bnQgJiYgY2FsYy5vdmVyX25vaXNlIDwgYmVzdC5vdmVyX25vaXNlKVxuICAgICAgICAgICAgICAgICAgICB8fCAoY2FsYy5vdmVyX2NvdW50ID09IGJlc3Qub3Zlcl9jb3VudFxuICAgICAgICAgICAgICAgICAgICAmJiBCaXRTdHJlYW0uRVEoY2FsYy5vdmVyX25vaXNlLCBiZXN0Lm92ZXJfbm9pc2UpICYmIGNhbGMudG90X25vaXNlIDwgYmVzdC50b3Rfbm9pc2UpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgY2FsYy5tYXhfbm9pc2UgPSBnZXRfa2xlbW1fbm9pc2UoZGlzdG9ydCwgZ2kpO1xuICAgICAgICAgICAgLy8kRkFMTC1USFJPVUdIJFxuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIGJldHRlciA9IGNhbGMubWF4X25vaXNlIDwgYmVzdC5tYXhfbm9pc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgYmV0dGVyID0gY2FsYy50b3Rfbm9pc2UgPCBiZXN0LnRvdF9ub2lzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICBiZXR0ZXIgPSAoY2FsYy50b3Rfbm9pc2UgPCBiZXN0LnRvdF9ub2lzZSlcbiAgICAgICAgICAgICAgICAgICAgJiYgKGNhbGMubWF4X25vaXNlIDwgYmVzdC5tYXhfbm9pc2UpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgIGJldHRlciA9IChjYWxjLm1heF9ub2lzZSA8PSAwLjAgJiYgYmVzdC5tYXhfbm9pc2UgPiAwLjIpXG4gICAgICAgICAgICAgICAgICAgIHx8IChjYWxjLm1heF9ub2lzZSA8PSAwLjAgJiYgYmVzdC5tYXhfbm9pc2UgPCAwLjBcbiAgICAgICAgICAgICAgICAgICAgJiYgYmVzdC5tYXhfbm9pc2UgPiBjYWxjLm1heF9ub2lzZSAtIDAuMiAmJiBjYWxjLnRvdF9ub2lzZSA8IGJlc3QudG90X25vaXNlKVxuICAgICAgICAgICAgICAgICAgICB8fCAoY2FsYy5tYXhfbm9pc2UgPD0gMC4wICYmIGJlc3QubWF4X25vaXNlID4gMC4wXG4gICAgICAgICAgICAgICAgICAgICYmIGJlc3QubWF4X25vaXNlID4gY2FsYy5tYXhfbm9pc2UgLSAwLjIgJiYgY2FsYy50b3Rfbm9pc2UgPCBiZXN0LnRvdF9ub2lzZVxuICAgICAgICAgICAgICAgICAgICArIGJlc3Qub3Zlcl9ub2lzZSlcbiAgICAgICAgICAgICAgICAgICAgfHwgKGNhbGMubWF4X25vaXNlID4gMC4wICYmIGJlc3QubWF4X25vaXNlID4gLTAuMDVcbiAgICAgICAgICAgICAgICAgICAgJiYgYmVzdC5tYXhfbm9pc2UgPiBjYWxjLm1heF9ub2lzZSAtIDAuMSAmJiBjYWxjLnRvdF9ub2lzZVxuICAgICAgICAgICAgICAgICAgICArIGNhbGMub3Zlcl9ub2lzZSA8IGJlc3QudG90X25vaXNlXG4gICAgICAgICAgICAgICAgICAgICsgYmVzdC5vdmVyX25vaXNlKVxuICAgICAgICAgICAgICAgICAgICB8fCAoY2FsYy5tYXhfbm9pc2UgPiAwLjAgJiYgYmVzdC5tYXhfbm9pc2UgPiAtMC4xXG4gICAgICAgICAgICAgICAgICAgICYmIGJlc3QubWF4X25vaXNlID4gY2FsYy5tYXhfbm9pc2UgLSAwLjE1ICYmIGNhbGMudG90X25vaXNlXG4gICAgICAgICAgICAgICAgICAgICsgY2FsYy5vdmVyX25vaXNlICsgY2FsYy5vdmVyX25vaXNlIDwgYmVzdC50b3Rfbm9pc2VcbiAgICAgICAgICAgICAgICAgICAgKyBiZXN0Lm92ZXJfbm9pc2UgKyBiZXN0Lm92ZXJfbm9pc2UpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA1OlxuICAgICAgICAgICAgICAgIGJldHRlciA9IGNhbGMub3Zlcl9ub2lzZSA8IGJlc3Qub3Zlcl9ub2lzZVxuICAgICAgICAgICAgICAgICAgICB8fCAoQml0U3RyZWFtLkVRKGNhbGMub3Zlcl9ub2lzZSwgYmVzdC5vdmVyX25vaXNlKSAmJiBjYWxjLnRvdF9ub2lzZSA8IGJlc3QudG90X25vaXNlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICBiZXR0ZXIgPSBjYWxjLm92ZXJfbm9pc2UgPCBiZXN0Lm92ZXJfbm9pc2VcbiAgICAgICAgICAgICAgICAgICAgfHwgKEJpdFN0cmVhbS5FUShjYWxjLm92ZXJfbm9pc2UsIGJlc3Qub3Zlcl9ub2lzZSkgJiYgKGNhbGMubWF4X25vaXNlIDwgYmVzdC5tYXhfbm9pc2UgfHwgKEJpdFN0cmVhbVxuICAgICAgICAgICAgICAgICAgICAgICAgLkVRKGNhbGMubWF4X25vaXNlLCBiZXN0Lm1heF9ub2lzZSkgJiYgY2FsYy50b3Rfbm9pc2UgPD0gYmVzdC50b3Rfbm9pc2UpKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgYmV0dGVyID0gY2FsYy5vdmVyX2NvdW50IDwgYmVzdC5vdmVyX2NvdW50XG4gICAgICAgICAgICAgICAgICAgIHx8IGNhbGMub3Zlcl9ub2lzZSA8IGJlc3Qub3Zlcl9ub2lzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChiZXN0Lm92ZXJfY291bnQgPT0gMCkge1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIElmIG5vIGRpc3RvcnRlZCBiYW5kcywgb25seSB1c2UgdGhpcyBxdWFudGl6YXRpb24gaWYgaXQgaXNcbiAgICAgICAgICAgICAqIGJldHRlciwgYW5kIGlmIGl0IHVzZXMgbGVzcyBiaXRzLiBVbmZvcnR1bmF0ZWx5LCBwYXJ0Ml8zX2xlbmd0aFxuICAgICAgICAgICAgICogaXMgc29tZXRpbWVzIGEgcG9vciBlc3RpbWF0b3Igb2YgdGhlIGZpbmFsIHNpemUgYXQgbG93IGJpdHJhdGVzLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBiZXR0ZXIgPSBiZXR0ZXIgJiYgY2FsYy5iaXRzIDwgYmVzdC5iaXRzO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGJldHRlcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBhdXRob3IvZGF0ZT8/XG4gICAgICpcbiAgICAgKiA8UFJFPlxuICAgICAqICBBbXBsaWZ5IHRoZSBzY2FsZWZhY3RvciBiYW5kcyB0aGF0IHZpb2xhdGUgdGhlIG1hc2tpbmcgdGhyZXNob2xkLlxuICAgICAqICBTZWUgSVNPIDExMTcyLTMgU2VjdGlvbiBDLjEuNS40LjMuNVxuICAgICAqXG4gICAgICogIGRpc3RvcnRbXSA9IG5vaXNlL21hc2tpbmdcbiAgICAgKiAgZGlzdG9ydFtdID4gMSAgID09PiBub2lzZSBpcyBub3QgbWFza2VkXG4gICAgICogIGRpc3RvcnRbXSA8IDEgICA9PT4gbm9pc2UgaXMgbWFza2VkXG4gICAgICogIG1heF9kaXN0ID0gbWF4aW11bSB2YWx1ZSBvZiBkaXN0b3J0W11cbiAgICAgKlxuICAgICAqICBUaHJlZSBhbGdvcml0aG1zOlxuICAgICAqICBub2lzZV9zaGFwaW5nX2FtcFxuICAgICAqICAgICAgICAwICAgICAgICAgICAgIEFtcGxpZnkgYWxsIGJhbmRzIHdpdGggZGlzdG9ydFtdPjEuXG4gICAgICpcbiAgICAgKiAgICAgICAgMSAgICAgICAgICAgICBBbXBsaWZ5IGFsbCBiYW5kcyB3aXRoIGRpc3RvcnRbXSA+PSBtYXhfZGlzdF4oLjUpO1xuICAgICAqICAgICAgICAgICAgICAgICAgICAgKCA1MCUgaW4gdGhlIGRiIHNjYWxlKVxuICAgICAqXG4gICAgICogICAgICAgIDIgICAgICAgICAgICAgQW1wbGlmeSBmaXJzdCBiYW5kIHdpdGggZGlzdG9ydFtdID49IG1heF9kaXN0O1xuICAgICAqXG4gICAgICpcbiAgICAgKiAgRm9yIGFsZ29yaXRobXMgMCBhbmQgMSwgaWYgbWF4X2Rpc3QgPCAxLCB0aGVuIGFtcGxpZnkgYWxsIGJhbmRzXG4gICAgICogIHdpdGggZGlzdG9ydFtdID49IC45NSptYXhfZGlzdC4gIFRoaXMgaXMgdG8gbWFrZSBzdXJlIHdlIGFsd2F5c1xuICAgICAqICBhbXBsaWZ5IGF0IGxlYXN0IG9uZSBiYW5kLlxuICAgICAqIDwvUFJFPlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGFtcF9zY2FsZWZhY19iYW5kcyhnZnAsIGNvZF9pbmZvLCBkaXN0b3J0LCB4cnBvdywgYlJlZmluZSkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgaWZxc3RlcDM0O1xuXG4gICAgICAgIGlmIChjb2RfaW5mby5zY2FsZWZhY19zY2FsZSA9PSAwKSB7XG4gICAgICAgICAgICBpZnFzdGVwMzQgPSAxLjI5NjgzOTU1NDY1MTAwOTY0MDU1O1xuICAgICAgICAgICAgLyogMioqKC43NSouNSkgKi9cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmcXN0ZXAzNCA9IDEuNjgxNzkyODMwNTA3NDI5MjI2MTI7XG4gICAgICAgICAgICAvKiAyKiooLjc1KjEpICovXG4gICAgICAgIH1cblxuICAgICAgICAvKiBjb21wdXRlIG1heGltdW0gdmFsdWUgb2YgZGlzdG9ydFtdICovXG4gICAgICAgIHZhciB0cmlnZ2VyID0gMDtcbiAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgY29kX2luZm8uc2ZibWF4OyBzZmIrKykge1xuICAgICAgICAgICAgaWYgKHRyaWdnZXIgPCBkaXN0b3J0W3NmYl0pXG4gICAgICAgICAgICAgICAgdHJpZ2dlciA9IGRpc3RvcnRbc2ZiXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBub2lzZV9zaGFwaW5nX2FtcCA9IGdmYy5ub2lzZV9zaGFwaW5nX2FtcDtcbiAgICAgICAgaWYgKG5vaXNlX3NoYXBpbmdfYW1wID09IDMpIHtcbiAgICAgICAgICAgIGlmIChiUmVmaW5lKVxuICAgICAgICAgICAgICAgIG5vaXNlX3NoYXBpbmdfYW1wID0gMjtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBub2lzZV9zaGFwaW5nX2FtcCA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgc3dpdGNoIChub2lzZV9zaGFwaW5nX2FtcCkge1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIC8qIGFtcGxpZnkgZXhhY3RseSAxIGJhbmQgKi9cbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIC8qIGFtcGxpZnkgYmFuZHMgd2l0aGluIDUwJSBvZiBtYXggKG9uIGRiIHNjYWxlKSAqL1xuICAgICAgICAgICAgICAgIGlmICh0cmlnZ2VyID4gMS4wKVxuICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyID0gTWF0aC5wb3codHJpZ2dlciwgLjUpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlciAqPSAuOTU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgLyogSVNPIGFsZ29yaXRobS4gYW1wbGlmeSBhbGwgYmFuZHMgd2l0aCBkaXN0b3J0PjEgKi9cbiAgICAgICAgICAgICAgICBpZiAodHJpZ2dlciA+IDEuMClcbiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlciA9IDEuMDtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXIgKj0gLjk1O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGogPSAwO1xuICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBjb2RfaW5mby5zZmJtYXg7IHNmYisrKSB7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSBjb2RfaW5mby53aWR0aFtzZmJdO1xuICAgICAgICAgICAgdmFyIGw7XG4gICAgICAgICAgICBqICs9IHdpZHRoO1xuICAgICAgICAgICAgaWYgKGRpc3RvcnRbc2ZiXSA8IHRyaWdnZXIpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgICAgIGlmICgoZ2ZjLnN1YnN0ZXBfc2hhcGluZyAmIDIpICE9IDApIHtcbiAgICAgICAgICAgICAgICBnZmMucHNldWRvaGFsZltzZmJdID0gKDAgPT0gZ2ZjLnBzZXVkb2hhbGZbc2ZiXSkgPyAxIDogMDtcbiAgICAgICAgICAgICAgICBpZiAoMCA9PSBnZmMucHNldWRvaGFsZltzZmJdICYmIGdmYy5ub2lzZV9zaGFwaW5nX2FtcCA9PSAyKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb2RfaW5mby5zY2FsZWZhY1tzZmJdKys7XG4gICAgICAgICAgICBmb3IgKGwgPSAtd2lkdGg7IGwgPCAwOyBsKyspIHtcbiAgICAgICAgICAgICAgICB4cnBvd1tqICsgbF0gKj0gaWZxc3RlcDM0O1xuICAgICAgICAgICAgICAgIGlmICh4cnBvd1tqICsgbF0gPiBjb2RfaW5mby54cnBvd19tYXgpXG4gICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvLnhycG93X21heCA9IHhycG93W2ogKyBsXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGdmYy5ub2lzZV9zaGFwaW5nX2FtcCA9PSAyKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRha2VoaXJvIFRvbWluYWdhIDIwMDAteHgteHhcbiAgICAgKlxuICAgICAqIHR1cm5zIG9uIHNjYWxlZmFjIHNjYWxlIGFuZCBhZGp1c3RzIHNjYWxlZmFjdG9yc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGluY19zY2FsZWZhY19zY2FsZShjb2RfaW5mbywgeHJwb3cpIHtcbiAgICAgICAgdmFyIGlmcXN0ZXAzNCA9IDEuMjk2ODM5NTU0NjUxMDA5NjQwNTU7XG5cbiAgICAgICAgdmFyIGogPSAwO1xuICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBjb2RfaW5mby5zZmJtYXg7IHNmYisrKSB7XG4gICAgICAgICAgICB2YXIgd2lkdGggPSBjb2RfaW5mby53aWR0aFtzZmJdO1xuICAgICAgICAgICAgdmFyIHMgPSBjb2RfaW5mby5zY2FsZWZhY1tzZmJdO1xuICAgICAgICAgICAgaWYgKGNvZF9pbmZvLnByZWZsYWcgIT0gMClcbiAgICAgICAgICAgICAgICBzICs9IHF1cHZ0LnByZXRhYltzZmJdO1xuICAgICAgICAgICAgaiArPSB3aWR0aDtcbiAgICAgICAgICAgIGlmICgocyAmIDEpICE9IDApIHtcbiAgICAgICAgICAgICAgICBzKys7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgbCA9IC13aWR0aDsgbCA8IDA7IGwrKykge1xuICAgICAgICAgICAgICAgICAgICB4cnBvd1tqICsgbF0gKj0gaWZxc3RlcDM0O1xuICAgICAgICAgICAgICAgICAgICBpZiAoeHJwb3dbaiArIGxdID4gY29kX2luZm8ueHJwb3dfbWF4KVxuICAgICAgICAgICAgICAgICAgICAgICAgY29kX2luZm8ueHJwb3dfbWF4ID0geHJwb3dbaiArIGxdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvZF9pbmZvLnNjYWxlZmFjW3NmYl0gPSBzID4+IDE7XG4gICAgICAgIH1cbiAgICAgICAgY29kX2luZm8ucHJlZmxhZyA9IDA7XG4gICAgICAgIGNvZF9pbmZvLnNjYWxlZmFjX3NjYWxlID0gMTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUYWtlaGlybyBUb21pbmFnYSAyMDAwLXh4LXh4XG4gICAgICpcbiAgICAgKiBpbmNyZWFzZXMgdGhlIHN1YmJsb2NrIGdhaW4gYW5kIGFkanVzdHMgc2NhbGVmYWN0b3JzXG4gICAgICovXG4gICAgZnVuY3Rpb24gaW5jX3N1YmJsb2NrX2dhaW4oZ2ZjLCBjb2RfaW5mbywgeHJwb3cpIHtcbiAgICAgICAgdmFyIHNmYjtcbiAgICAgICAgdmFyIHNjYWxlZmFjID0gY29kX2luZm8uc2NhbGVmYWM7XG5cbiAgICAgICAgLyogc3ViYmxvY19nYWluIGNhbid0IGRvIGFueXRoaW5nIGluIHRoZSBsb25nIGJsb2NrIHJlZ2lvbiAqL1xuICAgICAgICBmb3IgKHNmYiA9IDA7IHNmYiA8IGNvZF9pbmZvLnNmYl9sbWF4OyBzZmIrKykge1xuICAgICAgICAgICAgaWYgKHNjYWxlZmFjW3NmYl0gPj0gMTYpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciB3aW5kb3cgPSAwOyB3aW5kb3cgPCAzOyB3aW5kb3crKykge1xuICAgICAgICAgICAgdmFyIHMxID0gMDtcbiAgICAgICAgICAgIHZhciBzMiA9IDA7XG5cbiAgICAgICAgICAgIGZvciAoc2ZiID0gY29kX2luZm8uc2ZiX2xtYXggKyB3aW5kb3c7IHNmYiA8IGNvZF9pbmZvLnNmYmRpdmlkZTsgc2ZiICs9IDMpIHtcbiAgICAgICAgICAgICAgICBpZiAoczEgPCBzY2FsZWZhY1tzZmJdKVxuICAgICAgICAgICAgICAgICAgICBzMSA9IHNjYWxlZmFjW3NmYl07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKDsgc2ZiIDwgY29kX2luZm8uc2ZibWF4OyBzZmIgKz0gMykge1xuICAgICAgICAgICAgICAgIGlmIChzMiA8IHNjYWxlZmFjW3NmYl0pXG4gICAgICAgICAgICAgICAgICAgIHMyID0gc2NhbGVmYWNbc2ZiXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHMxIDwgMTYgJiYgczIgPCA4KVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICBpZiAoY29kX2luZm8uc3ViYmxvY2tfZ2Fpblt3aW5kb3ddID49IDcpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBldmVuIHRob3VnaCB0aGVyZSBpcyBubyBzY2FsZWZhY3RvciBmb3Igc2ZiMTIgc3ViYmxvY2sgZ2FpblxuICAgICAgICAgICAgICogYWZmZWN0cyB1cHBlciBmcmVxdWVuY2llcyB0b28sIHRoYXQncyB3aHkgd2UgaGF2ZSB0byBnbyB1cCB0b1xuICAgICAgICAgICAgICogU0JNQVhfc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBjb2RfaW5mby5zdWJibG9ja19nYWluW3dpbmRvd10rKztcbiAgICAgICAgICAgIHZhciBqID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFtjb2RfaW5mby5zZmJfbG1heF07XG4gICAgICAgICAgICBmb3IgKHNmYiA9IGNvZF9pbmZvLnNmYl9sbWF4ICsgd2luZG93OyBzZmIgPCBjb2RfaW5mby5zZmJtYXg7IHNmYiArPSAzKSB7XG4gICAgICAgICAgICAgICAgdmFyIGFtcDtcbiAgICAgICAgICAgICAgICB2YXIgd2lkdGggPSBjb2RfaW5mby53aWR0aFtzZmJdO1xuICAgICAgICAgICAgICAgIHZhciBzID0gc2NhbGVmYWNbc2ZiXTtcbiAgICAgICAgICAgICAgICBzID0gcyAtICg0ID4+IGNvZF9pbmZvLnNjYWxlZmFjX3NjYWxlKTtcbiAgICAgICAgICAgICAgICBpZiAocyA+PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjYWxlZmFjW3NmYl0gPSBzO1xuICAgICAgICAgICAgICAgICAgICBqICs9IHdpZHRoICogMztcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc2NhbGVmYWNbc2ZiXSA9IDA7XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ2FpbiA9IDIxMCArIChzIDw8IChjb2RfaW5mby5zY2FsZWZhY19zY2FsZSArIDEpKTtcbiAgICAgICAgICAgICAgICAgICAgYW1wID0gcXVwdnQuSVBPVzIwKGdhaW4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBqICs9IHdpZHRoICogKHdpbmRvdyArIDEpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGwgPSAtd2lkdGg7IGwgPCAwOyBsKyspIHtcbiAgICAgICAgICAgICAgICAgICAgeHJwb3dbaiArIGxdICo9IGFtcDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHhycG93W2ogKyBsXSA+IGNvZF9pbmZvLnhycG93X21heClcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvLnhycG93X21heCA9IHhycG93W2ogKyBsXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaiArPSB3aWR0aCAqICgzIC0gd2luZG93IC0gMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXIgYW1wID0gcXVwdnQuSVBPVzIwKDIwMik7XG4gICAgICAgICAgICAgICAgaiArPSBjb2RfaW5mby53aWR0aFtzZmJdICogKHdpbmRvdyArIDEpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGwgPSAtY29kX2luZm8ud2lkdGhbc2ZiXTsgbCA8IDA7IGwrKykge1xuICAgICAgICAgICAgICAgICAgICB4cnBvd1tqICsgbF0gKj0gYW1wO1xuICAgICAgICAgICAgICAgICAgICBpZiAoeHJwb3dbaiArIGxdID4gY29kX2luZm8ueHJwb3dfbWF4KVxuICAgICAgICAgICAgICAgICAgICAgICAgY29kX2luZm8ueHJwb3dfbWF4ID0geHJwb3dbaiArIGxdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogPFBSRT5cbiAgICAgKiAgVGFrZWhpcm8gVG9taW5hZ2EgL2RhdGU/P1xuICAgICAqICBSb2JlcnQgSGVnZW1hbm4gMjAwMC0wOS0wNjogbWFkZSBhIGZ1bmN0aW9uIG9mIGl0XG4gICAgICpcbiAgICAgKiAgYW1wbGlmaWVzIHNjYWxlZmFjdG9yIGJhbmRzLFxuICAgICAqICAgLSBpZiBhbGwgYXJlIGFscmVhZHkgYW1wbGlmaWVkIHJldHVybnMgMFxuICAgICAqICAgLSBpZiBzb21lIGJhbmRzIGFyZSBhbXBsaWZpZWQgdG9vIG11Y2g6XG4gICAgICogICAgICAqIHRyeSB0byBpbmNyZWFzZSBzY2FsZWZhY19zY2FsZVxuICAgICAqICAgICAgKiBpZiBhbHJlYWR5IHNjYWxlZmFjX3NjYWxlIHdhcyBzZXRcbiAgICAgKiAgICAgICAgICB0cnkgb24gc2hvcnQgYmxvY2tzIHRvIGluY3JlYXNlIHN1YmJsb2NrIGdhaW5cbiAgICAgKiA8L1BSRT5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBiYWxhbmNlX25vaXNlKGdmcCwgY29kX2luZm8sIGRpc3RvcnQsIHhycG93LCBiUmVmaW5lKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cbiAgICAgICAgYW1wX3NjYWxlZmFjX2JhbmRzKGdmcCwgY29kX2luZm8sIGRpc3RvcnQsIHhycG93LCBiUmVmaW5lKTtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBjaGVjayB0byBtYWtlIHN1cmUgd2UgaGF2ZSBub3QgYW1wbGlmaWVkIHRvbyBtdWNoIGxvb3BfYnJlYWsgcmV0dXJuc1xuICAgICAgICAgKiAwIGlmIHRoZXJlIGlzIGFuIHVuYW1wbGlmaWVkIHNjYWxlZmFjIHNjYWxlX2JpdGNvdW50IHJldHVybnMgMCBpZiBub1xuICAgICAgICAgKiBzY2FsZWZhY3RvcnMgYXJlIHRvbyBsYXJnZVxuICAgICAgICAgKi9cblxuICAgICAgICB2YXIgc3RhdHVzID0gbG9vcF9icmVhayhjb2RfaW5mbyk7XG5cbiAgICAgICAgaWYgKHN0YXR1cylcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgLyogYWxsIGJhbmRzIGFtcGxpZmllZCAqL1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIG5vdCBhbGwgc2NhbGVmYWN0b3JzIGhhdmUgYmVlbiBhbXBsaWZpZWQuIHNvIHRoZXNlIHNjYWxlZmFjcyBhcmVcbiAgICAgICAgICogcG9zc2libHkgdmFsaWQuIGVuY29kZSB0aGVtOlxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGdmYy5tb2RlX2dyID09IDIpXG4gICAgICAgICAgICBzdGF0dXMgPSB0ay5zY2FsZV9iaXRjb3VudChjb2RfaW5mbyk7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHN0YXR1cyA9IHRrLnNjYWxlX2JpdGNvdW50X2xzZihnZmMsIGNvZF9pbmZvKTtcblxuICAgICAgICBpZiAoIXN0YXR1cylcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAvKiBhbXBsaWZpZWQgc29tZSBiYW5kcyBub3QgZXhjZWVkaW5nIGxpbWl0cyAqL1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHNvbWUgc2NhbGVmYWN0b3JzIGFyZSB0b28gbGFyZ2UuIGxldHMgdHJ5IHNldHRpbmcgc2NhbGVmYWNfc2NhbGU9MVxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGdmYy5ub2lzZV9zaGFwaW5nID4gMSkge1xuICAgICAgICAgICAgQXJyYXlzLmZpbGwoZ2ZjLnBzZXVkb2hhbGYsIDApO1xuICAgICAgICAgICAgaWYgKDAgPT0gY29kX2luZm8uc2NhbGVmYWNfc2NhbGUpIHtcbiAgICAgICAgICAgICAgICBpbmNfc2NhbGVmYWNfc2NhbGUoY29kX2luZm8sIHhycG93KTtcbiAgICAgICAgICAgICAgICBzdGF0dXMgPSBmYWxzZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKGNvZF9pbmZvLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFXG4gICAgICAgICAgICAgICAgICAgICYmIGdmYy5zdWJibG9ja19nYWluID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXMgPSAoaW5jX3N1YmJsb2NrX2dhaW4oZ2ZjLCBjb2RfaW5mbywgeHJwb3cpIHx8IGxvb3BfYnJlYWsoY29kX2luZm8pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXN0YXR1cykge1xuICAgICAgICAgICAgaWYgKGdmYy5tb2RlX2dyID09IDIpXG4gICAgICAgICAgICAgICAgc3RhdHVzID0gdGsuc2NhbGVfYml0Y291bnQoY29kX2luZm8pO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHN0YXR1cyA9IHRrLnNjYWxlX2JpdGNvdW50X2xzZihnZmMsIGNvZF9pbmZvKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gIXN0YXR1cztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiA8UFJFPlxuICAgICAqICBGdW5jdGlvbjogVGhlIG91dGVyIGl0ZXJhdGlvbiBsb29wIGNvbnRyb2xzIHRoZSBtYXNraW5nIGNvbmRpdGlvbnNcbiAgICAgKiAgb2YgYWxsIHNjYWxlZmFjdG9yYmFuZHMuIEl0IGNvbXB1dGVzIHRoZSBiZXN0IHNjYWxlZmFjIGFuZFxuICAgICAqICBnbG9iYWwgZ2Fpbi4gVGhpcyBtb2R1bGUgY2FsbHMgdGhlIGlubmVyIGl0ZXJhdGlvbiBsb29wXG4gICAgICpcbiAgICAgKiAgbXQgNS85OSBjb21wbGV0ZWx5IHJld3JpdHRlbiB0byBhbGxvdyBmb3IgYml0IHJlc2Vydm9pciBjb250cm9sLFxuICAgICAqICBtaWQvc2lkZSBjaGFubmVscyB3aXRoIEwvUiBvciBtaWQvc2lkZSBtYXNraW5nIHRocmVzaG9sZHMsXG4gICAgICogIGFuZCBjaG9vc2VzIGJlc3QgcXVhbnRpemF0aW9uIGluc3RlYWQgb2YgbGFzdCBxdWFudGl6YXRpb24gd2hlblxuICAgICAqICBubyBkaXN0b3J0aW9uIGZyZWUgcXVhbnRpemF0aW9uIGNhbiBiZSBmb3VuZC5cbiAgICAgKlxuICAgICAqICBhZGRlZCBWQlIgc3VwcG9ydCBtdCA1Lzk5XG5cbiAgICAgKlxuICAgICAqICBzb21lIGNvZGUgc2h1ZmZsZSByaCA5LzAwXG4gICAgICogPC9QUkU+XG4gICAgICpcbiAgICAgKiBAcGFyYW0gbDNfeG1pblxuICAgICAqICAgICAgICAgICAgYWxsb3dlZCBkaXN0b3J0aW9uXG4gICAgICogQHBhcmFtIHhycG93XG4gICAgICogICAgICAgICAgICBjb2xvdXJlZCBtYWduaXR1ZGVzIG9mIHNwZWN0cmFsXG4gICAgICogQHBhcmFtIHRhcmdfYml0c1xuICAgICAqICAgICAgICAgICAgbWF4aW11bSBhbGxvd2VkIGJpdHNcbiAgICAgKi9cbiAgICB0aGlzLm91dGVyX2xvb3AgPSBmdW5jdGlvbiAoZ2ZwLCBjb2RfaW5mbywgbDNfeG1pbiwgeHJwb3csIGNoLCB0YXJnX2JpdHMpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGNvZF9pbmZvX3cgPSBuZXcgR3JJbmZvKCk7XG4gICAgICAgIHZhciBzYXZlX3hycG93ID0gbmV3X2Zsb2F0KDU3Nik7XG4gICAgICAgIHZhciBkaXN0b3J0ID0gbmV3X2Zsb2F0KEwzU2lkZS5TRkJNQVgpO1xuICAgICAgICB2YXIgYmVzdF9ub2lzZV9pbmZvID0gbmV3IENhbGNOb2lzZVJlc3VsdCgpO1xuICAgICAgICB2YXIgYmV0dGVyO1xuICAgICAgICB2YXIgcHJldl9ub2lzZSA9IG5ldyBDYWxjTm9pc2VEYXRhKCk7XG4gICAgICAgIHZhciBiZXN0X3BhcnQyXzNfbGVuZ3RoID0gOTk5OTk5OTtcbiAgICAgICAgdmFyIGJFbmRPZlNlYXJjaCA9IGZhbHNlO1xuICAgICAgICB2YXIgYlJlZmluZSA9IGZhbHNlO1xuICAgICAgICB2YXIgYmVzdF9nZ2Fpbl9wYXNzMSA9IDA7XG5cbiAgICAgICAgYmluX3NlYXJjaF9TdGVwU2l6ZShnZmMsIGNvZF9pbmZvLCB0YXJnX2JpdHMsIGNoLCB4cnBvdyk7XG5cbiAgICAgICAgaWYgKDAgPT0gZ2ZjLm5vaXNlX3NoYXBpbmcpXG4gICAgICAgIC8qIGZhc3QgbW9kZSwgbm8gbm9pc2Ugc2hhcGluZywgd2UgYXJlIHJlYWR5ICovXG4gICAgICAgICAgICByZXR1cm4gMTAwO1xuICAgICAgICAvKiBkZWZhdWx0IG5vaXNlX2luZm8ub3Zlcl9jb3VudCAqL1xuXG4gICAgICAgIC8qIGNvbXB1dGUgdGhlIGRpc3RvcnRpb24gaW4gdGhpcyBxdWFudGl6YXRpb24gKi9cbiAgICAgICAgLyogY29lZmZpY2llbnRzIGFuZCB0aHJlc2hvbGRzIGJvdGggbC9yIChvciBib3RoIG1pZC9zaWRlKSAqL1xuICAgICAgICBxdXB2dC5jYWxjX25vaXNlKGNvZF9pbmZvLCBsM194bWluLCBkaXN0b3J0LCBiZXN0X25vaXNlX2luZm8sXG4gICAgICAgICAgICBwcmV2X25vaXNlKTtcbiAgICAgICAgYmVzdF9ub2lzZV9pbmZvLmJpdHMgPSBjb2RfaW5mby5wYXJ0Ml8zX2xlbmd0aDtcblxuICAgICAgICBjb2RfaW5mb193LmFzc2lnbihjb2RfaW5mbyk7XG4gICAgICAgIHZhciBhZ2UgPSAwO1xuICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KHhycG93LCAwLCBzYXZlX3hycG93LCAwLCA1NzYpO1xuXG4gICAgICAgIHdoaWxlICghYkVuZE9mU2VhcmNoKSB7XG4gICAgICAgICAgICAvKiBCRUdJTiBNQUlOIExPT1AgKi9cbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICB2YXIgbm9pc2VfaW5mbyA9IG5ldyBDYWxjTm9pc2VSZXN1bHQoKTtcbiAgICAgICAgICAgICAgICB2YXIgc2VhcmNoX2xpbWl0O1xuICAgICAgICAgICAgICAgIHZhciBtYXhnZ2FpbiA9IDI1NTtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogV2hlbiBxdWFudGl6YXRpb24gd2l0aCBubyBkaXN0b3J0ZWQgYmFuZHMgaXMgZm91bmQsIGFsbG93IHVwXG4gICAgICAgICAgICAgICAgICogdG8gWCBuZXcgdW5zdWNjZXNmdWwgdHJpZXMgaW4gc2VyaWFsLiBUaGlzIGdpdmVzIHVzIG1vcmVcbiAgICAgICAgICAgICAgICAgKiBwb3NzaWJpbGl0aWVzIGZvciBkaWZmZXJlbnQgcXVhbnRfY29tcGFyZSBtb2Rlcy4gTXVjaCBtb3JlXG4gICAgICAgICAgICAgICAgICogdGhhbiAzIG1ha2VzIG5vdCBhIGJpZyBkaWZmZXJlbmNlLCBpdCBpcyBvbmx5IHNsb3dlci5cbiAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgIGlmICgoZ2ZjLnN1YnN0ZXBfc2hhcGluZyAmIDIpICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoX2xpbWl0ID0gMjA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc2VhcmNoX2xpbWl0ID0gMztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIENoZWNrIGlmIHRoZSBsYXN0IHNjYWxlZmFjdG9yIGJhbmQgaXMgZGlzdG9ydGVkLiBpbiBWQlIgbW9kZVxuICAgICAgICAgICAgICAgICAqIHdlIGNhbid0IGdldCByaWQgb2YgdGhlIGRpc3RvcnRpb24sIHNvIHF1aXQgbm93IGFuZCBWQlIgbW9kZVxuICAgICAgICAgICAgICAgICAqIHdpbGwgdHJ5IGFnYWluIHdpdGggbW9yZSBiaXRzLiAobWFrZXMgYSAxMCUgc3BlZWQgaW5jcmVhc2UsXG4gICAgICAgICAgICAgICAgICogdGhlIGZpbGVzIEkgdGVzdGVkIHdlcmUgYmluYXJ5IGlkZW50aWNhbCwgMjAwMC8wNS8yMCBSb2JlcnRcbiAgICAgICAgICAgICAgICAgKiBIZWdlbWFubikgZGlzdG9ydFtdID4gMSBtZWFucyBub2lzZSA+IGFsbG93ZWQgbm9pc2VcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLnNmYjIxX2V4dHJhKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkaXN0b3J0W2NvZF9pbmZvX3cuc2ZibWF4XSA+IDEuMClcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29kX2luZm9fdy5ibG9ja190eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRVxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgKGRpc3RvcnRbY29kX2luZm9fdy5zZmJtYXggKyAxXSA+IDEuMCB8fCBkaXN0b3J0W2NvZF9pbmZvX3cuc2ZibWF4ICsgMl0gPiAxLjApKVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyogdHJ5IGEgbmV3IHNjYWxlZmFjdG9yIGNvbmJpbmF0aW9uIG9uIGNvZF9pbmZvX3cgKi9cbiAgICAgICAgICAgICAgICBpZiAoIWJhbGFuY2Vfbm9pc2UoZ2ZwLCBjb2RfaW5mb193LCBkaXN0b3J0LCB4cnBvdywgYlJlZmluZSkpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGlmIChjb2RfaW5mb193LnNjYWxlZmFjX3NjYWxlICE9IDApXG4gICAgICAgICAgICAgICAgICAgIG1heGdnYWluID0gMjU0O1xuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBpbm5lcl9sb29wIHN0YXJ0cyB3aXRoIHRoZSBpbml0aWFsIHF1YW50aXphdGlvbiBzdGVwIGNvbXB1dGVkXG4gICAgICAgICAgICAgICAgICogYWJvdmUgYW5kIHNsb3dseSBpbmNyZWFzZXMgdW50aWwgdGhlIGJpdHMgPCBodWZmX2JpdHMuIFRodXNcbiAgICAgICAgICAgICAgICAgKiBpdCBpcyBpbXBvcnRhbnQgbm90IHRvIHN0YXJ0IHdpdGggdG9vIGxhcmdlIG9mIGFuIGluaXRhbFxuICAgICAgICAgICAgICAgICAqIHF1YW50aXphdGlvbiBzdGVwLiBUb28gc21hbGwgaXMgb2ssIGJ1dCBpbm5lcl9sb29wIHdpbGwgdGFrZVxuICAgICAgICAgICAgICAgICAqIGxvbmdlclxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIHZhciBodWZmX2JpdHMgPSB0YXJnX2JpdHMgLSBjb2RfaW5mb193LnBhcnQyX2xlbmd0aDtcbiAgICAgICAgICAgICAgICBpZiAoaHVmZl9iaXRzIDw9IDApXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBpbmNyZWFzZSBxdWFudGl6ZXIgc3RlcHNpemUgdW50aWwgbmVlZGVkIGJpdHMgYXJlIGJlbG93XG4gICAgICAgICAgICAgICAgICogbWF4aW11bVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIHdoaWxlICgoY29kX2luZm9fdy5wYXJ0Ml8zX2xlbmd0aCA9IHRrLmNvdW50X2JpdHMoZ2ZjLCB4cnBvdyxcbiAgICAgICAgICAgICAgICAgICAgY29kX2luZm9fdywgcHJldl9ub2lzZSkpID4gaHVmZl9iaXRzXG4gICAgICAgICAgICAgICAgJiYgY29kX2luZm9fdy5nbG9iYWxfZ2FpbiA8PSBtYXhnZ2FpbilcbiAgICAgICAgICAgICAgICAgICAgY29kX2luZm9fdy5nbG9iYWxfZ2FpbisrO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNvZF9pbmZvX3cuZ2xvYmFsX2dhaW4gPiBtYXhnZ2FpbilcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBpZiAoYmVzdF9ub2lzZV9pbmZvLm92ZXJfY291bnQgPT0gMCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHdoaWxlICgoY29kX2luZm9fdy5wYXJ0Ml8zX2xlbmd0aCA9IHRrLmNvdW50X2JpdHMoZ2ZjLFxuICAgICAgICAgICAgICAgICAgICAgICAgeHJwb3csIGNvZF9pbmZvX3csIHByZXZfbm9pc2UpKSA+IGJlc3RfcGFydDJfM19sZW5ndGhcbiAgICAgICAgICAgICAgICAgICAgJiYgY29kX2luZm9fdy5nbG9iYWxfZ2FpbiA8PSBtYXhnZ2FpbilcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvX3cuZ2xvYmFsX2dhaW4rKztcblxuICAgICAgICAgICAgICAgICAgICBpZiAoY29kX2luZm9fdy5nbG9iYWxfZ2FpbiA+IG1heGdnYWluKVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyogY29tcHV0ZSB0aGUgZGlzdG9ydGlvbiBpbiB0aGlzIHF1YW50aXphdGlvbiAqL1xuICAgICAgICAgICAgICAgIHF1cHZ0LmNhbGNfbm9pc2UoY29kX2luZm9fdywgbDNfeG1pbiwgZGlzdG9ydCwgbm9pc2VfaW5mbyxcbiAgICAgICAgICAgICAgICAgICAgcHJldl9ub2lzZSk7XG4gICAgICAgICAgICAgICAgbm9pc2VfaW5mby5iaXRzID0gY29kX2luZm9fdy5wYXJ0Ml8zX2xlbmd0aDtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogY2hlY2sgaWYgdGhpcyBxdWFudGl6YXRpb24gaXMgYmV0dGVyIHRoYW4gb3VyIHNhdmVkXG4gICAgICAgICAgICAgICAgICogcXVhbnRpemF0aW9uXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgaWYgKGNvZF9pbmZvLmJsb2NrX3R5cGUgIT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIE5PUk0sIFNUQVJUIG9yIFNUT1AgdHlwZVxuICAgICAgICAgICAgICAgICAgICBiZXR0ZXIgPSBnZnAucXVhbnRfY29tcDtcbiAgICAgICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICAgICAgYmV0dGVyID0gZ2ZwLnF1YW50X2NvbXBfc2hvcnQ7XG5cbiAgICAgICAgICAgICAgICBiZXR0ZXIgPSBxdWFudF9jb21wYXJlKGJldHRlciwgYmVzdF9ub2lzZV9pbmZvLCBub2lzZV9pbmZvLFxuICAgICAgICAgICAgICAgICAgICBjb2RfaW5mb193LCBkaXN0b3J0KSA/IDEgOiAwO1xuXG4gICAgICAgICAgICAgICAgLyogc2F2ZSBkYXRhIHNvIHdlIGNhbiByZXN0b3JlIHRoaXMgcXVhbnRpemF0aW9uIGxhdGVyICovXG4gICAgICAgICAgICAgICAgaWYgKGJldHRlciAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGJlc3RfcGFydDJfM19sZW5ndGggPSBjb2RfaW5mby5wYXJ0Ml8zX2xlbmd0aDtcbiAgICAgICAgICAgICAgICAgICAgYmVzdF9ub2lzZV9pbmZvID0gbm9pc2VfaW5mbztcbiAgICAgICAgICAgICAgICAgICAgY29kX2luZm8uYXNzaWduKGNvZF9pbmZvX3cpO1xuICAgICAgICAgICAgICAgICAgICBhZ2UgPSAwO1xuICAgICAgICAgICAgICAgICAgICAvKiBzYXZlIGRhdGEgc28gd2UgY2FuIHJlc3RvcmUgdGhpcyBxdWFudGl6YXRpb24gbGF0ZXIgKi9cbiAgICAgICAgICAgICAgICAgICAgLyogc3RvcmUgZm9yIGxhdGVyIHJldXNlICovXG4gICAgICAgICAgICAgICAgICAgIFN5c3RlbS5hcnJheWNvcHkoeHJwb3csIDAsIHNhdmVfeHJwb3csIDAsIDU3Nik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLyogZWFybHkgc3RvcD8gKi9cbiAgICAgICAgICAgICAgICAgICAgaWYgKGdmYy5mdWxsX291dGVyX2xvb3AgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCsrYWdlID4gc2VhcmNoX2xpbWl0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgYmVzdF9ub2lzZV9pbmZvLm92ZXJfY291bnQgPT0gMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoZ2ZjLm5vaXNlX3NoYXBpbmdfYW1wID09IDMpICYmIGJSZWZpbmUgJiYgYWdlID4gMzApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGdmYy5ub2lzZV9zaGFwaW5nX2FtcCA9PSAzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIGJSZWZpbmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiAoY29kX2luZm9fdy5nbG9iYWxfZ2FpbiAtIGJlc3RfZ2dhaW5fcGFzczEpID4gMTUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IHdoaWxlICgoY29kX2luZm9fdy5nbG9iYWxfZ2FpbiArIGNvZF9pbmZvX3cuc2NhbGVmYWNfc2NhbGUpIDwgMjU1KTtcblxuICAgICAgICAgICAgaWYgKGdmYy5ub2lzZV9zaGFwaW5nX2FtcCA9PSAzKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFiUmVmaW5lKSB7XG4gICAgICAgICAgICAgICAgICAgIC8qIHJlZmluZSBzZWFyY2ggKi9cbiAgICAgICAgICAgICAgICAgICAgY29kX2luZm9fdy5hc3NpZ24oY29kX2luZm8pO1xuICAgICAgICAgICAgICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KHNhdmVfeHJwb3csIDAsIHhycG93LCAwLCA1NzYpO1xuICAgICAgICAgICAgICAgICAgICBhZ2UgPSAwO1xuICAgICAgICAgICAgICAgICAgICBiZXN0X2dnYWluX3Bhc3MxID0gY29kX2luZm9fdy5nbG9iYWxfZ2FpbjtcblxuICAgICAgICAgICAgICAgICAgICBiUmVmaW5lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvKiBzZWFyY2ggYWxyZWFkeSByZWZpbmVkLCBzdG9wICovXG4gICAgICAgICAgICAgICAgICAgIGJFbmRPZlNlYXJjaCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGJFbmRPZlNlYXJjaCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKlxuICAgICAgICAgKiBmaW5pc2ggdXBcbiAgICAgICAgICovXG4gICAgICAgIGlmIChnZnAuVkJSID09IFZick1vZGUudmJyX3JoIHx8IGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfbXRyaClcbiAgICAgICAgLyogcmVzdG9yZSBmb3IgcmV1c2Ugb24gbmV4dCB0cnkgKi9cbiAgICAgICAgICAgIFN5c3RlbS5hcnJheWNvcHkoc2F2ZV94cnBvdywgMCwgeHJwb3csIDAsIDU3Nik7XG4gICAgICAgIC8qXG4gICAgICAgICAqIGRvIHRoZSAnc3Vic3RlcCBzaGFwaW5nJ1xuICAgICAgICAgKi9cbiAgICAgICAgZWxzZSBpZiAoKGdmYy5zdWJzdGVwX3NoYXBpbmcgJiAxKSAhPSAwKVxuICAgICAgICAgICAgdHJhbmNhdGVfc21hbGxzcGVjdHJ1bXMoZ2ZjLCBjb2RfaW5mbywgbDNfeG1pbiwgeHJwb3cpO1xuXG4gICAgICAgIHJldHVybiBiZXN0X25vaXNlX2luZm8ub3Zlcl9jb3VudDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSb2JlcnQgSGVnZW1hbm4gMjAwMC0wOS0wNlxuICAgICAqXG4gICAgICogdXBkYXRlIHJlc2Vydm9pciBzdGF0dXMgYWZ0ZXIgRklOQUwgcXVhbnRpemF0aW9uL2JpdHJhdGVcbiAgICAgKi9cbiAgICB0aGlzLml0ZXJhdGlvbl9maW5pc2hfb25lID0gZnVuY3Rpb24gKGdmYywgZ3IsIGNoKSB7XG4gICAgICAgIHZhciBsM19zaWRlID0gZ2ZjLmwzX3NpZGU7XG4gICAgICAgIHZhciBjb2RfaW5mbyA9IGwzX3NpZGUudHRbZ3JdW2NoXTtcblxuICAgICAgICAvKlxuICAgICAgICAgKiB0cnkgc29tZSBiZXR0ZXIgc2NhbGVmYWMgc3RvcmFnZVxuICAgICAgICAgKi9cbiAgICAgICAgdGsuYmVzdF9zY2FsZWZhY19zdG9yZShnZmMsIGdyLCBjaCwgbDNfc2lkZSk7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogYmVzdCBodWZmbWFuX2RpdmlkZSBtYXkgc2F2ZSBzb21lIGJpdHMgdG9vXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoZ2ZjLnVzZV9iZXN0X2h1ZmZtYW4gPT0gMSlcbiAgICAgICAgICAgIHRrLmJlc3RfaHVmZm1hbl9kaXZpZGUoZ2ZjLCBjb2RfaW5mbyk7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogdXBkYXRlIHJlc2Vydm9pciBzdGF0dXMgYWZ0ZXIgRklOQUwgcXVhbnRpemF0aW9uL2JpdHJhdGVcbiAgICAgICAgICovXG4gICAgICAgIHJ2LlJlc3ZBZGp1c3QoZ2ZjLCBjb2RfaW5mbyk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqXG4gICAgICogMjAwMC0wOS0wNCBSb2JlcnQgSGVnZW1hbm5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBsM194bWluXG4gICAgICogICAgICAgICAgICBhbGxvd2VkIGRpc3RvcnRpb24gb2YgdGhlIHNjYWxlZmFjdG9yXG4gICAgICogQHBhcmFtIHhycG93XG4gICAgICogICAgICAgICAgICBjb2xvdXJlZCBtYWduaXR1ZGVzIG9mIHNwZWN0cmFsIHZhbHVlc1xuICAgICAqL1xuICAgIHRoaXMuVkJSX2VuY29kZV9ncmFudWxlID0gZnVuY3Rpb24gKGdmcCwgY29kX2luZm8sIGwzX3htaW4sIHhycG93LCBjaCwgbWluX2JpdHMsIG1heF9iaXRzKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBic3RfY29kX2luZm8gPSBuZXcgR3JJbmZvKCk7XG4gICAgICAgIHZhciBic3RfeHJwb3cgPSBuZXdfZmxvYXQoNTc2KTtcbiAgICAgICAgdmFyIE1heF9iaXRzID0gbWF4X2JpdHM7XG4gICAgICAgIHZhciByZWFsX2JpdHMgPSBtYXhfYml0cyArIDE7XG4gICAgICAgIHZhciB0aGlzX2JpdHMgPSAobWF4X2JpdHMgKyBtaW5fYml0cykgLyAyO1xuICAgICAgICB2YXIgZGJpdHMsIG92ZXIsIGZvdW5kID0gMDtcbiAgICAgICAgdmFyIHNmYjIxX2V4dHJhID0gZ2ZjLnNmYjIxX2V4dHJhO1xuXG4gICAgICAgIEFycmF5cy5maWxsKGJzdF9jb2RfaW5mby5sM19lbmMsIDApO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHNlYXJjaCB3aXRoaW4gcm91bmQgYWJvdXQgNDAgYml0cyBvZiBvcHRpbWFsXG4gICAgICAgICAqL1xuICAgICAgICBkbyB7XG5cbiAgICAgICAgICAgIGlmICh0aGlzX2JpdHMgPiBNYXhfYml0cyAtIDQyKVxuICAgICAgICAgICAgICAgIGdmYy5zZmIyMV9leHRyYSA9IGZhbHNlO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIGdmYy5zZmIyMV9leHRyYSA9IHNmYjIxX2V4dHJhO1xuXG4gICAgICAgICAgICBvdmVyID0gb3V0ZXJfbG9vcChnZnAsIGNvZF9pbmZvLCBsM194bWluLCB4cnBvdywgY2gsIHRoaXNfYml0cyk7XG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBpcyBxdWFudGl6YXRpb24gYXMgZ29vZCBhcyB3ZSBhcmUgbG9va2luZyBmb3IgPyBpbiB0aGlzIGNhc2U6IGlzXG4gICAgICAgICAgICAgKiBubyBzY2FsZWZhY3RvciBiYW5kIGRpc3RvcnRlZD9cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKG92ZXIgPD0gMCkge1xuICAgICAgICAgICAgICAgIGZvdW5kID0gMTtcbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIG5vdyB3ZSBrbm93IGl0IGNhbiBiZSBkb25lIHdpdGggXCJyZWFsX2JpdHNcIiBhbmQgbWF5YmUgd2UgY2FuXG4gICAgICAgICAgICAgICAgICogc2tpcCBzb21lIGl0ZXJhdGlvbnNcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICByZWFsX2JpdHMgPSBjb2RfaW5mby5wYXJ0Ml8zX2xlbmd0aDtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogc3RvcmUgYmVzdCBxdWFudGl6YXRpb24gc28gZmFyXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYnN0X2NvZF9pbmZvLmFzc2lnbihjb2RfaW5mbyk7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmFycmF5Y29weSh4cnBvdywgMCwgYnN0X3hycG93LCAwLCA1NzYpO1xuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiB0cnkgd2l0aCBmZXdlciBiaXRzXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgbWF4X2JpdHMgPSByZWFsX2JpdHMgLSAzMjtcbiAgICAgICAgICAgICAgICBkYml0cyA9IG1heF9iaXRzIC0gbWluX2JpdHM7XG4gICAgICAgICAgICAgICAgdGhpc19iaXRzID0gKG1heF9iaXRzICsgbWluX2JpdHMpIC8gMjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiB0cnkgd2l0aCBtb3JlIGJpdHNcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBtaW5fYml0cyA9IHRoaXNfYml0cyArIDMyO1xuICAgICAgICAgICAgICAgIGRiaXRzID0gbWF4X2JpdHMgLSBtaW5fYml0cztcbiAgICAgICAgICAgICAgICB0aGlzX2JpdHMgPSAobWF4X2JpdHMgKyBtaW5fYml0cykgLyAyO1xuXG4gICAgICAgICAgICAgICAgaWYgKGZvdW5kICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZm91bmQgPSAyO1xuICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgKiBzdGFydCBhZ2FpbiB3aXRoIGJlc3QgcXVhbnRpemF0aW9uIHNvIGZhclxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgY29kX2luZm8uYXNzaWduKGJzdF9jb2RfaW5mbyk7XG4gICAgICAgICAgICAgICAgICAgIFN5c3RlbS5hcnJheWNvcHkoYnN0X3hycG93LCAwLCB4cnBvdywgMCwgNTc2KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gd2hpbGUgKGRiaXRzID4gMTIpO1xuXG4gICAgICAgIGdmYy5zZmIyMV9leHRyYSA9IHNmYjIxX2V4dHJhO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGZvdW5kPTAgPT4gbm90aGluZyBmb3VuZCwgdXNlIGxhc3Qgb25lIGZvdW5kPTEgPT4gd2UganVzdCBmb3VuZCB0aGVcbiAgICAgICAgICogYmVzdCBhbmQgbGVmdCB0aGUgbG9vcCBmb3VuZD0yID0+IHdlIHJlc3RvcmVkIGEgZ29vZCBvbmUgYW5kIGhhdmUgbm93XG4gICAgICAgICAqIGwzX2VuYyB0byByZXN0b3JlIHRvb1xuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGZvdW5kID09IDIpIHtcbiAgICAgICAgICAgIFN5c3RlbS5hcnJheWNvcHkoYnN0X2NvZF9pbmZvLmwzX2VuYywgMCwgY29kX2luZm8ubDNfZW5jLCAwLCA1NzYpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUm9iZXJ0IEhlZ2VtYW5uIDIwMDAtMDktMDVcbiAgICAgKlxuICAgICAqIGNhbGN1bGF0ZXMgKiBob3cgbWFueSBiaXRzIGFyZSBhdmFpbGFibGUgZm9yIGFuYWxvZyBzaWxlbnQgZ3JhbnVsZXMgKiBob3dcbiAgICAgKiBtYW55IGJpdHMgdG8gdXNlIGZvciB0aGUgbG93ZXN0IGFsbG93ZWQgYml0cmF0ZSAqIGhvdyBtYW55IGJpdHMgZWFjaFxuICAgICAqIGJpdHJhdGUgd291bGQgcHJvdmlkZVxuICAgICAqL1xuICAgIHRoaXMuZ2V0X2ZyYW1lYml0cyA9IGZ1bmN0aW9uIChnZnAsIGZyYW1lQml0cykge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGFsd2F5cyB1c2UgYXQgbGVhc3QgdGhpcyBtYW55IGJpdHMgcGVyIGdyYW51bGUgcGVyIGNoYW5uZWwgdW5sZXNzIHdlXG4gICAgICAgICAqIGRldGVjdCBhbmFsb2cgc2lsZW5jZSwgc2VlIGJlbG93XG4gICAgICAgICAqL1xuICAgICAgICBnZmMuYml0cmF0ZV9pbmRleCA9IGdmYy5WQlJfbWluX2JpdHJhdGU7XG4gICAgICAgIHZhciBiaXRzUGVyRnJhbWUgPSBicy5nZXRmcmFtZWJpdHMoZ2ZwKTtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBiaXRzIGZvciBhbmFsb2cgc2lsZW5jZVxuICAgICAgICAgKi9cbiAgICAgICAgZ2ZjLmJpdHJhdGVfaW5kZXggPSAxO1xuICAgICAgICBiaXRzUGVyRnJhbWUgPSBicy5nZXRmcmFtZWJpdHMoZ2ZwKTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8PSBnZmMuVkJSX21heF9iaXRyYXRlOyBpKyspIHtcbiAgICAgICAgICAgIGdmYy5iaXRyYXRlX2luZGV4ID0gaTtcbiAgICAgICAgICAgIHZhciBtYiA9IG5ldyBNZWFuQml0cyhiaXRzUGVyRnJhbWUpO1xuICAgICAgICAgICAgZnJhbWVCaXRzW2ldID0gcnYuUmVzdkZyYW1lQmVnaW4oZ2ZwLCBtYik7XG4gICAgICAgICAgICBiaXRzUGVyRnJhbWUgPSBtYi5iaXRzO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8qIFJIOiB0aGlzIG9uZSBuZWVkcyB0byBiZSBvdmVyaGF1bGVkIHNvbWV0aW1lICovXG5cbiAgICAvKipcbiAgICAgKiA8UFJFPlxuICAgICAqICAyMDAwLTA5LTA0IFJvYmVydCBIZWdlbWFublxuICAgICAqXG4gICAgICogICogY29udmVydHMgTFIgdG8gTVMgY29kaW5nIHdoZW4gbmVjZXNzYXJ5XG4gICAgICogICogY2FsY3VsYXRlcyBhbGxvd2VkL2FkanVzdGVkIHF1YW50aXphdGlvbiBub2lzZSBhbW91bnRzXG4gICAgICogICogZGV0ZWN0cyBhbmFsb2cgc2lsZW50IGZyYW1lc1xuICAgICAqXG4gICAgICogIHNvbWUgcmVtYXJrczpcbiAgICAgKiAgLSBsb3dlciBtYXNraW5nIGRlcGVuZGluZyBvbiBRdWFsaXR5IHNldHRpbmdcbiAgICAgKiAgLSBxdWFsaXR5IGNvbnRyb2wgdG9nZXRoZXIgd2l0aCBhZGp1c3RlZCBBVEggTURDVCBzY2FsaW5nXG4gICAgICogICAgb24gbG93ZXIgcXVhbGl0eSBzZXR0aW5nIGFsbG9jYXRlIG1vcmUgbm9pc2UgZnJvbVxuICAgICAqICAgIEFUSCBtYXNraW5nLCBhbmQgb24gaGlnaGVyIHF1YWxpdHkgc2V0dGluZyBhbGxvY2F0ZVxuICAgICAqICAgIGxlc3Mgbm9pc2UgZnJvbSBBVEggbWFza2luZy5cbiAgICAgKiAgLSBleHBlcmltZW50cyBzaG93IHRoYXQgZ29pbmcgbW9yZSB0aGFuIDJkQiBvdmVyIEdQU1lDSE8nc1xuICAgICAqICAgIGxpbWl0cyBlbmRzIHVwIGluIHZlcnkgYW5ub3lpbmcgYXJ0ZWZhY3RzXG4gICAgICogPC9QUkU+XG4gICAgICovXG4gICAgdGhpcy5WQlJfb2xkX3ByZXBhcmUgPSBmdW5jdGlvbiAoZ2ZwLCBwZSwgbXNfZW5lcl9yYXRpbywgcmF0aW8sIGwzX3htaW4sIGZyYW1lQml0cywgbWluX2JpdHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4X2JpdHMsIGJhbmRzKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cbiAgICAgICAgdmFyIG1hc2tpbmdfbG93ZXJfZGIsIGFkanVzdCA9IDAuMDtcbiAgICAgICAgdmFyIGFuYWxvZ19zaWxlbmNlID0gMTtcbiAgICAgICAgdmFyIGJpdHMgPSAwO1xuXG4gICAgICAgIGdmYy5iaXRyYXRlX2luZGV4ID0gZ2ZjLlZCUl9tYXhfYml0cmF0ZTtcbiAgICAgICAgdmFyIGF2ZyA9IHJ2LlJlc3ZGcmFtZUJlZ2luKGdmcCwgbmV3IE1lYW5CaXRzKDApKSAvIGdmYy5tb2RlX2dyO1xuXG4gICAgICAgIGdldF9mcmFtZWJpdHMoZ2ZwLCBmcmFtZUJpdHMpO1xuXG4gICAgICAgIGZvciAodmFyIGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuICAgICAgICAgICAgdmFyIG14YiA9IHF1cHZ0Lm9uX3BlKGdmcCwgcGUsIG1heF9iaXRzW2dyXSwgYXZnLCBnciwgMCk7XG4gICAgICAgICAgICBpZiAoZ2ZjLm1vZGVfZXh0ID09IEVuY29kZXIuTVBHX01EX01TX0xSKSB7XG4gICAgICAgICAgICAgICAgbXNfY29udmVydChnZmMubDNfc2lkZSwgZ3IpO1xuICAgICAgICAgICAgICAgIHF1cHZ0LnJlZHVjZV9zaWRlKG1heF9iaXRzW2dyXSwgbXNfZW5lcl9yYXRpb1tncl0sIGF2ZywgbXhiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyArK2NoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvZF9pbmZvID0gZ2ZjLmwzX3NpZGUudHRbZ3JdW2NoXTtcblxuICAgICAgICAgICAgICAgIGlmIChjb2RfaW5mby5ibG9ja190eXBlICE9IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBOT1JNLCBTVEFSVCBvciBTVE9QIHR5cGVcbiAgICAgICAgICAgICAgICAgICAgYWRqdXN0ID0gMS4yOCAvICgxICsgTWF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5leHAoMy41IC0gcGVbZ3JdW2NoXSAvIDMwMC4pKSAtIDAuMDU7XG4gICAgICAgICAgICAgICAgICAgIG1hc2tpbmdfbG93ZXJfZGIgPSBnZmMuUFNZLm1hc2tfYWRqdXN0IC0gYWRqdXN0O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGFkanVzdCA9IDIuNTYgLyAoMSArIE1hdGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZXhwKDMuNSAtIHBlW2dyXVtjaF0gLyAzMDAuKSkgLSAwLjE0O1xuICAgICAgICAgICAgICAgICAgICBtYXNraW5nX2xvd2VyX2RiID0gZ2ZjLlBTWS5tYXNrX2FkanVzdF9zaG9ydCAtIGFkanVzdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZ2ZjLm1hc2tpbmdfbG93ZXIgPSBNYXRoLnBvdygxMC4wLFxuICAgICAgICAgICAgICAgICAgICBtYXNraW5nX2xvd2VyX2RiICogMC4xKTtcblxuICAgICAgICAgICAgICAgIGluaXRfb3V0ZXJfbG9vcChnZmMsIGNvZF9pbmZvKTtcbiAgICAgICAgICAgICAgICBiYW5kc1tncl1bY2hdID0gcXVwdnQuY2FsY194bWluKGdmcCwgcmF0aW9bZ3JdW2NoXSwgY29kX2luZm8sXG4gICAgICAgICAgICAgICAgICAgIGwzX3htaW5bZ3JdW2NoXSk7XG4gICAgICAgICAgICAgICAgaWYgKGJhbmRzW2dyXVtjaF0gIT0gMClcbiAgICAgICAgICAgICAgICAgICAgYW5hbG9nX3NpbGVuY2UgPSAwO1xuXG4gICAgICAgICAgICAgICAgbWluX2JpdHNbZ3JdW2NoXSA9IDEyNjtcblxuICAgICAgICAgICAgICAgIGJpdHMgKz0gbWF4X2JpdHNbZ3JdW2NoXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcbiAgICAgICAgICAgIGZvciAodmFyIGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGJpdHMgPiBmcmFtZUJpdHNbZ2ZjLlZCUl9tYXhfYml0cmF0ZV0pIHtcbiAgICAgICAgICAgICAgICAgICAgbWF4X2JpdHNbZ3JdW2NoXSAqPSBmcmFtZUJpdHNbZ2ZjLlZCUl9tYXhfYml0cmF0ZV07XG4gICAgICAgICAgICAgICAgICAgIG1heF9iaXRzW2dyXVtjaF0gLz0gYml0cztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG1pbl9iaXRzW2dyXVtjaF0gPiBtYXhfYml0c1tncl1bY2hdKVxuICAgICAgICAgICAgICAgICAgICBtaW5fYml0c1tncl1bY2hdID0gbWF4X2JpdHNbZ3JdW2NoXTtcblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogZm9yIGNoICovXG4gICAgICAgIH1cbiAgICAgICAgLyogZm9yIGdyICovXG5cbiAgICAgICAgcmV0dXJuIGFuYWxvZ19zaWxlbmNlO1xuICAgIH07XG5cbiAgICB0aGlzLmJpdHByZXNzdXJlX3N0cmF0ZWd5ID0gZnVuY3Rpb24gKGdmYywgbDNfeG1pbiwgbWluX2JpdHMsIG1heF9iaXRzKSB7XG4gICAgICAgIGZvciAodmFyIGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuICAgICAgICAgICAgZm9yICh2YXIgY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZ2kgPSBnZmMubDNfc2lkZS50dFtncl1bY2hdO1xuICAgICAgICAgICAgICAgIHZhciBweG1pbiA9IGwzX3htaW5bZ3JdW2NoXTtcbiAgICAgICAgICAgICAgICB2YXIgcHhtaW5Qb3MgPSAwO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IGdpLnBzeV9sbWF4OyBzZmIrKylcbiAgICAgICAgICAgICAgICAgICAgcHhtaW5bcHhtaW5Qb3MrK10gKj0gMS4gKyAuMDI5ICogc2ZiICogc2ZiXG4gICAgICAgICAgICAgICAgICAgICAgICAvIEVuY29kZXIuU0JNQVhfbCAvIEVuY29kZXIuU0JNQVhfbDtcblxuICAgICAgICAgICAgICAgIGlmIChnaS5ibG9ja190eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBzZmIgPSBnaS5zZmJfc21pbjsgc2ZiIDwgRW5jb2Rlci5TQk1BWF9zOyBzZmIrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgcHhtaW5bcHhtaW5Qb3MrK10gKj0gMS4gKyAuMDI5ICogc2ZiICogc2ZiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLyBFbmNvZGVyLlNCTUFYX3MgLyBFbmNvZGVyLlNCTUFYX3M7XG4gICAgICAgICAgICAgICAgICAgICAgICBweG1pbltweG1pblBvcysrXSAqPSAxLiArIC4wMjkgKiBzZmIgKiBzZmJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvIEVuY29kZXIuU0JNQVhfcyAvIEVuY29kZXIuU0JNQVhfcztcbiAgICAgICAgICAgICAgICAgICAgICAgIHB4bWluW3B4bWluUG9zKytdICo9IDEuICsgLjAyOSAqIHNmYiAqIHNmYlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8gRW5jb2Rlci5TQk1BWF9zIC8gRW5jb2Rlci5TQk1BWF9zO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG1heF9iaXRzW2dyXVtjaF0gPSAwIHwgTWF0aC5tYXgobWluX2JpdHNbZ3JdW2NoXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIDAuOSAqIG1heF9iaXRzW2dyXVtjaF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMuVkJSX25ld19wcmVwYXJlID0gZnVuY3Rpb24gKGdmcCwgcGUsIHJhdGlvLCBsM194bWluLCBmcmFtZUJpdHMsIG1heF9iaXRzKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cbiAgICAgICAgdmFyIGFuYWxvZ19zaWxlbmNlID0gMTtcbiAgICAgICAgdmFyIGF2ZyA9IDAsIGJpdHMgPSAwO1xuICAgICAgICB2YXIgbWF4aW11bV9mcmFtZWJpdHM7XG5cbiAgICAgICAgaWYgKCFnZnAuZnJlZV9mb3JtYXQpIHtcbiAgICAgICAgICAgIGdmYy5iaXRyYXRlX2luZGV4ID0gZ2ZjLlZCUl9tYXhfYml0cmF0ZTtcblxuICAgICAgICAgICAgdmFyIG1iID0gbmV3IE1lYW5CaXRzKGF2Zyk7XG4gICAgICAgICAgICBydi5SZXN2RnJhbWVCZWdpbihnZnAsIG1iKTtcbiAgICAgICAgICAgIGF2ZyA9IG1iLmJpdHM7XG5cbiAgICAgICAgICAgIGdldF9mcmFtZWJpdHMoZ2ZwLCBmcmFtZUJpdHMpO1xuICAgICAgICAgICAgbWF4aW11bV9mcmFtZWJpdHMgPSBmcmFtZUJpdHNbZ2ZjLlZCUl9tYXhfYml0cmF0ZV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBnZmMuYml0cmF0ZV9pbmRleCA9IDA7XG4gICAgICAgICAgICB2YXIgbWIgPSBuZXcgTWVhbkJpdHMoYXZnKTtcbiAgICAgICAgICAgIG1heGltdW1fZnJhbWViaXRzID0gcnYuUmVzdkZyYW1lQmVnaW4oZ2ZwLCBtYik7XG4gICAgICAgICAgICBhdmcgPSBtYi5iaXRzO1xuICAgICAgICAgICAgZnJhbWVCaXRzWzBdID0gbWF4aW11bV9mcmFtZWJpdHM7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcbiAgICAgICAgICAgIHF1cHZ0Lm9uX3BlKGdmcCwgcGUsIG1heF9iaXRzW2dyXSwgYXZnLCBnciwgMCk7XG4gICAgICAgICAgICBpZiAoZ2ZjLm1vZGVfZXh0ID09IEVuY29kZXIuTVBHX01EX01TX0xSKSB7XG4gICAgICAgICAgICAgICAgbXNfY29udmVydChnZmMubDNfc2lkZSwgZ3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7ICsrY2gpIHtcbiAgICAgICAgICAgICAgICB2YXIgY29kX2luZm8gPSBnZmMubDNfc2lkZS50dFtncl1bY2hdO1xuXG4gICAgICAgICAgICAgICAgZ2ZjLm1hc2tpbmdfbG93ZXIgPSBNYXRoLnBvdygxMC4wLFxuICAgICAgICAgICAgICAgICAgICBnZmMuUFNZLm1hc2tfYWRqdXN0ICogMC4xKTtcblxuICAgICAgICAgICAgICAgIGluaXRfb3V0ZXJfbG9vcChnZmMsIGNvZF9pbmZvKTtcbiAgICAgICAgICAgICAgICBpZiAoMCAhPSBxdXB2dC5jYWxjX3htaW4oZ2ZwLCByYXRpb1tncl1bY2hdLCBjb2RfaW5mbyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGwzX3htaW5bZ3JdW2NoXSkpXG4gICAgICAgICAgICAgICAgICAgIGFuYWxvZ19zaWxlbmNlID0gMDtcblxuICAgICAgICAgICAgICAgIGJpdHMgKz0gbWF4X2JpdHNbZ3JdW2NoXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcbiAgICAgICAgICAgIGZvciAodmFyIGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGJpdHMgPiBtYXhpbXVtX2ZyYW1lYml0cykge1xuICAgICAgICAgICAgICAgICAgICBtYXhfYml0c1tncl1bY2hdICo9IG1heGltdW1fZnJhbWViaXRzO1xuICAgICAgICAgICAgICAgICAgICBtYXhfYml0c1tncl1bY2hdIC89IGJpdHM7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBmb3IgY2ggKi9cbiAgICAgICAgfVxuICAgICAgICAvKiBmb3IgZ3IgKi9cblxuICAgICAgICByZXR1cm4gYW5hbG9nX3NpbGVuY2U7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIGNhbGN1bGF0ZXMgdGFyZ2V0IGJpdHMgZm9yIEFCUiBlbmNvZGluZ1xuICAgICAqXG4gICAgICogbXQgMjAwMC8wNS8zMVxuICAgICAqL1xuICAgIHRoaXMuY2FsY190YXJnZXRfYml0cyA9IGZ1bmN0aW9uIChnZnAsIHBlLCBtc19lbmVyX3JhdGlvLCB0YXJnX2JpdHMsIGFuYWxvZ19zaWxlbmNlX2JpdHMsIG1heF9mcmFtZV9iaXRzKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBsM19zaWRlID0gZ2ZjLmwzX3NpZGU7XG4gICAgICAgIHZhciByZXNfZmFjdG9yO1xuICAgICAgICB2YXIgZ3IsIGNoLCB0b3RiaXRzLCBtZWFuX2JpdHMgPSAwO1xuXG4gICAgICAgIGdmYy5iaXRyYXRlX2luZGV4ID0gZ2ZjLlZCUl9tYXhfYml0cmF0ZTtcbiAgICAgICAgdmFyIG1iID0gbmV3IE1lYW5CaXRzKG1lYW5fYml0cyk7XG4gICAgICAgIG1heF9mcmFtZV9iaXRzWzBdID0gcnYuUmVzdkZyYW1lQmVnaW4oZ2ZwLCBtYik7XG4gICAgICAgIG1lYW5fYml0cyA9IG1iLmJpdHM7XG5cbiAgICAgICAgZ2ZjLmJpdHJhdGVfaW5kZXggPSAxO1xuICAgICAgICBtZWFuX2JpdHMgPSBicy5nZXRmcmFtZWJpdHMoZ2ZwKSAtIGdmYy5zaWRlaW5mb19sZW4gKiA4O1xuICAgICAgICBhbmFsb2dfc2lsZW5jZV9iaXRzWzBdID0gbWVhbl9iaXRzIC8gKGdmYy5tb2RlX2dyICogZ2ZjLmNoYW5uZWxzX291dCk7XG5cbiAgICAgICAgbWVhbl9iaXRzID0gZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyAqIGdmcC5mcmFtZXNpemUgKiAxMDAwO1xuICAgICAgICBpZiAoKGdmYy5zdWJzdGVwX3NoYXBpbmcgJiAxKSAhPSAwKVxuICAgICAgICAgICAgbWVhbl9iaXRzICo9IDEuMDk7XG4gICAgICAgIG1lYW5fYml0cyAvPSBnZnAub3V0X3NhbXBsZXJhdGU7XG4gICAgICAgIG1lYW5fYml0cyAtPSBnZmMuc2lkZWluZm9fbGVuICogODtcbiAgICAgICAgbWVhbl9iaXRzIC89IChnZmMubW9kZV9nciAqIGdmYy5jaGFubmVsc19vdXQpO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiA8UFJFPlxuICAgICAgICAgKiAgICAgICAgICAgcmVzX2ZhY3RvciBpcyB0aGUgcGVyY2VudGFnZSBvZiB0aGUgdGFyZ2V0IGJpdHJhdGUgdGhhdCBzaG91bGRcbiAgICAgICAgICogICAgICAgICAgIGJlIHVzZWQgb24gYXZlcmFnZS4gIHRoZSByZW1haW5pbmcgYml0cyBhcmUgYWRkZWQgdG8gdGhlXG4gICAgICAgICAqICAgICAgICAgICBiaXRyZXNlcnZvaXIgYW5kIHVzZWQgZm9yIGRpZmZpY3VsdCB0byBlbmNvZGUgZnJhbWVzLlxuICAgICAgICAgKlxuICAgICAgICAgKiAgICAgICAgICAgU2luY2Ugd2UgYXJlIHRyYWNraW5nIHRoZSBhdmVyYWdlIGJpdHJhdGUsIHdlIHNob3VsZCBhZGp1c3RcbiAgICAgICAgICogICAgICAgICAgIHJlc19mYWN0b3IgXCJvbiB0aGUgZmx5XCIsIGluY3JlYXNpbmcgaXQgaWYgdGhlIGF2ZXJhZ2UgYml0cmF0ZVxuICAgICAgICAgKiAgICAgICAgICAgaXMgZ3JlYXRlciB0aGFuIHRoZSByZXF1ZXN0ZWQgYml0cmF0ZSwgYW5kIGRlY3JlYXNpbmcgaXRcbiAgICAgICAgICogICAgICAgICAgIG90aGVyd2lzZS4gIFJlYXNvbmFibGUgcmFuZ2VzIGFyZSBmcm9tIC45IHRvIDEuMFxuICAgICAgICAgKlxuICAgICAgICAgKiAgICAgICAgICAgVW50aWwgd2UgZ2V0IHRoZSBhYm92ZSBzdWdnZXN0aW9uIHdvcmtpbmcsIHdlIHVzZSB0aGUgZm9sbG93aW5nXG4gICAgICAgICAqICAgICAgICAgICB0dW5pbmc6XG4gICAgICAgICAqICAgICAgICAgICBjb21wcmVzc2lvbiByYXRpbyAgICByZXNfZmFjdG9yXG4gICAgICAgICAqICAgICAgICAgICA1LjUgICgyNTZrYnBzKSAgICAgICAgIDEuMCAgICAgIG5vIG5lZWQgZm9yIGJpdHJlc2Vydm9pclxuICAgICAgICAgKiAgICAgICAgICAgMTEgICAoMTI4a2JwcykgICAgICAgICAuOTMgICAgICA3JSBoZWxkIGZvciByZXNlcnZvaXJcbiAgICAgICAgICpcbiAgICAgICAgICogICAgICAgICAgIHdpdGggbGluZWFyIGludGVycG9sYXRpb24gZm9yIG90aGVyIHZhbHVlcy5cbiAgICAgICAgICogPC9QUkU+XG4gICAgICAgICAqL1xuICAgICAgICByZXNfZmFjdG9yID0gLjkzICsgLjA3ICogKDExLjAgLSBnZnAuY29tcHJlc3Npb25fcmF0aW8pXG4gICAgICAgICAgICAvICgxMS4wIC0gNS41KTtcbiAgICAgICAgaWYgKHJlc19mYWN0b3IgPCAuOTApXG4gICAgICAgICAgICByZXNfZmFjdG9yID0gLjkwO1xuICAgICAgICBpZiAocmVzX2ZhY3RvciA+IDEuMDApXG4gICAgICAgICAgICByZXNfZmFjdG9yID0gMS4wMDtcblxuICAgICAgICBmb3IgKGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuICAgICAgICAgICAgdmFyIHN1bSA9IDA7XG4gICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgdGFyZ19iaXRzW2dyXVtjaF0gPSAoaW50KShyZXNfZmFjdG9yICogbWVhbl9iaXRzKTtcblxuICAgICAgICAgICAgICAgIGlmIChwZVtncl1bY2hdID4gNzAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhZGRfYml0cyA9IChpbnQpKChwZVtncl1bY2hdIC0gNzAwKSAvIDEuNCk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvZF9pbmZvID0gbDNfc2lkZS50dFtncl1bY2hdO1xuICAgICAgICAgICAgICAgICAgICB0YXJnX2JpdHNbZ3JdW2NoXSA9IChpbnQpKHJlc19mYWN0b3IgKiBtZWFuX2JpdHMpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8qIHNob3J0IGJsb2NrcyB1c2UgYSBsaXR0bGUgZXh0cmEsIG5vIG1hdHRlciB3aGF0IHRoZSBwZSAqL1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29kX2luZm8uYmxvY2tfdHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZGRfYml0cyA8IG1lYW5fYml0cyAvIDIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkX2JpdHMgPSBtZWFuX2JpdHMgLyAyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8qIGF0IG1vc3QgaW5jcmVhc2UgYml0cyBieSAxLjUqYXZlcmFnZSAqL1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWRkX2JpdHMgPiBtZWFuX2JpdHMgKiAzIC8gMilcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZF9iaXRzID0gbWVhbl9iaXRzICogMyAvIDI7XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFkZF9iaXRzIDwgMClcbiAgICAgICAgICAgICAgICAgICAgICAgIGFkZF9iaXRzID0gMDtcblxuICAgICAgICAgICAgICAgICAgICB0YXJnX2JpdHNbZ3JdW2NoXSArPSBhZGRfYml0cztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRhcmdfYml0c1tncl1bY2hdID4gTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0NIQU5ORUwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ19iaXRzW2dyXVtjaF0gPSBMYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfQ0hBTk5FTDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3VtICs9IHRhcmdfYml0c1tncl1bY2hdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogZm9yIGNoICovXG4gICAgICAgICAgICBpZiAoc3VtID4gTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0dSQU5VTEUpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyArK2NoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdfYml0c1tncl1bY2hdICo9IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9HUkFOVUxFO1xuICAgICAgICAgICAgICAgICAgICB0YXJnX2JpdHNbZ3JdW2NoXSAvPSBzdW07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qIGZvciBnciAqL1xuXG4gICAgICAgIGlmIChnZmMubW9kZV9leHQgPT0gRW5jb2Rlci5NUEdfTURfTVNfTFIpXG4gICAgICAgICAgICBmb3IgKGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuICAgICAgICAgICAgICAgIHF1cHZ0LnJlZHVjZV9zaWRlKHRhcmdfYml0c1tncl0sIG1zX2VuZXJfcmF0aW9bZ3JdLCBtZWFuX2JpdHNcbiAgICAgICAgICAgICAgICAgICAgKiBnZmMuY2hhbm5lbHNfb3V0LFxuICAgICAgICAgICAgICAgICAgICBMYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfR1JBTlVMRSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgICogc3VtIHRhcmdldCBiaXRzXG4gICAgICAgICAqL1xuICAgICAgICB0b3RiaXRzID0gMDtcbiAgICAgICAgZm9yIChnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcbiAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodGFyZ19iaXRzW2dyXVtjaF0gPiBMYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfQ0hBTk5FTClcbiAgICAgICAgICAgICAgICAgICAgdGFyZ19iaXRzW2dyXVtjaF0gPSBMYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfQ0hBTk5FTDtcbiAgICAgICAgICAgICAgICB0b3RiaXRzICs9IHRhcmdfYml0c1tncl1bY2hdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgICogcmVwYXJ0aW9uIHRhcmdldCBiaXRzIGlmIG5lZWRlZFxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKHRvdGJpdHMgPiBtYXhfZnJhbWVfYml0c1swXSkge1xuICAgICAgICAgICAgZm9yIChnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdfYml0c1tncl1bY2hdICo9IG1heF9mcmFtZV9iaXRzWzBdO1xuICAgICAgICAgICAgICAgICAgICB0YXJnX2JpdHNbZ3JdW2NoXSAvPSB0b3RiaXRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufVxuXG4vKlxuICogICAgICBNUDMgd2luZG93IHN1YmJhbmQgLT4gc3ViYmFuZCBmaWx0ZXJpbmcgLT4gbWRjdCByb3V0aW5lXG4gKlxuICogICAgICBDb3B5cmlnaHQgKGMpIDE5OTktMjAwMCBUYWtlaGlybyBUb21pbmFnYVxuICpcbiAqXG4gKiBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yXG4gKiBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG4gKiBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXJcbiAqIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCxcbiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mXG4gKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVVxuICogTGlicmFyeSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuXG4gKlxuICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExpYnJhcnkgR2VuZXJhbCBQdWJsaWNcbiAqIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgd3JpdGUgdG8gdGhlXG4gKiBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIEluYy4sIDU5IFRlbXBsZSBQbGFjZSAtIFN1aXRlIDMzMCxcbiAqIEJvc3RvbiwgTUEgMDIxMTEtMTMwNywgVVNBLlxuICovXG4vKlxuICogICAgICAgICBTcGVjaWFsIFRoYW5rcyB0byBQYXRyaWNrIERlIFNtZXQgZm9yIHlvdXIgYWR2aWNlcy5cbiAqL1xuXG4vKiAkSWQ6IE5ld01EQ1QuamF2YSx2IDEuMTEgMjAxMS8wNS8yNCAyMDo0ODowNiBrZW5jaGlzIEV4cCAkICovXG5cbi8vcGFja2FnZSBtcDM7XG5cbi8vaW1wb3J0IGphdmEudXRpbC5BcnJheXM7XG5cblxuXG5mdW5jdGlvbiBOZXdNRENUKCkge1xuXG5cdHZhciBlbndpbmRvdyA9IFtcblx0XHRcdC00Ljc3ZS0wNyAqIDAuNzQwOTUxMTI1MzU0OTU5IC8gMi4zODRlLTA2LFxuXHRcdFx0MS4wMzk1MWUtMDQgKiAwLjc0MDk1MTEyNTM1NDk1OSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuNTM2NzRlLTA0ICogMC43NDA5NTExMjUzNTQ5NTkgLyAyLjM4NGUtMDYsXG5cdFx0XHQyLjg0MTQ3M2UtMDMgKiAwLjc0MDk1MTEyNTM1NDk1OSAvIDIuMzg0ZS0wNixcblx0XHRcdDMuNTc1ODk3MmUtMDIgKiAwLjc0MDk1MTEyNTM1NDk1OSAvIDIuMzg0ZS0wNixcblx0XHRcdDMuNDAxNzU2ZS0wMyAqIDAuNzQwOTUxMTI1MzU0OTU5IC8gMi4zODRlLTA2LFxuXHRcdFx0OS44MzcxNWUtMDQgKiAwLjc0MDk1MTEyNTM1NDk1OSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuOTE4MmUtMDUgKiAwLjc0MDk1MTEyNTM1NDk1OSAvIDIuMzg0ZS0wNiwgLyogMTUgKi9cblx0XHRcdDEuMjM5OGUtMDUgKiAwLjc0MDk1MTEyNTM1NDk1OSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuOTEyMTJlLTA0ICogMC43NDA5NTExMjUzNTQ5NTkgLyAyLjM4NGUtMDYsXG5cdFx0XHQyLjI4MzA5NmUtMDMgKiAwLjc0MDk1MTEyNTM1NDk1OSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuNjk5NDQ3NmUtMDIgKiAwLjc0MDk1MTEyNTM1NDk1OSAvIDIuMzg0ZS0wNixcblx0XHRcdC0xLjg3NTY4NjZlLTAyICogMC43NDA5NTExMjUzNTQ5NTkgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi42MzA3MTFlLTAzICogMC43NDA5NTExMjUzNTQ5NTkgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi40NzQ3OGUtMDQgKiAwLjc0MDk1MTEyNTM1NDk1OSAvIDIuMzg0ZS0wNixcblx0XHRcdC0xLjQ3ODJlLTA1ICogMC43NDA5NTExMjUzNTQ5NTkgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjA2MzQ3MTY5MDE5MTQ3MWUtMDEsIDEuOTYwMzQyODA2NTkxMjEzZS0wMSxcblxuXHRcdFx0LTQuNzdlLTA3ICogMC43NzMwMTA0NTMzNjI3MzcgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjA1ODU4ZS0wNCAqIDAuNzczMDEwNDUzMzYyNzM3IC8gMi4zODRlLTA2LFxuXHRcdFx0OS4zMDc4NmUtMDQgKiAwLjc3MzAxMDQ1MzM2MjczNyAvIDIuMzg0ZS0wNixcblx0XHRcdDIuNTIxNTE1ZS0wMyAqIDAuNzczMDEwNDUzMzYyNzM3IC8gMi4zODRlLTA2LFxuXHRcdFx0My41Njk0MTIyZS0wMiAqIDAuNzczMDEwNDUzMzYyNzM3IC8gMi4zODRlLTA2LFxuXHRcdFx0My42NDMwMzZlLTAzICogMC43NzMwMTA0NTMzNjI3MzcgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjkxODIxZS0wNCAqIDAuNzczMDEwNDUzMzYyNzM3IC8gMi4zODRlLTA2LFxuXHRcdFx0OS42MzIxZS0wNSAqIDAuNzczMDEwNDUzMzYyNzM3IC8gMi4zODRlLTA2LCAvKiAxNCAqL1xuXHRcdFx0MS4xNDQ0ZS0wNSAqIDAuNzczMDEwNDUzMzYyNzM3IC8gMi4zODRlLTA2LFxuXHRcdFx0MS42NTQ2MmUtMDQgKiAwLjc3MzAxMDQ1MzM2MjczNyAvIDIuMzg0ZS0wNixcblx0XHRcdDIuMTEwMDA0ZS0wMyAqIDAuNzczMDEwNDUzMzYyNzM3IC8gMi4zODRlLTA2LFxuXHRcdFx0MS42MTEyODA0ZS0wMiAqIDAuNzczMDEwNDUzMzYyNzM3IC8gMi4zODRlLTA2LFxuXHRcdFx0LTEuOTYzNDI0N2UtMDIgKiAwLjc3MzAxMDQ1MzM2MjczNyAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjgwMzMyNmUtMDMgKiAwLjc3MzAxMDQ1MzM2MjczNyAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjc3MDQyZS0wNCAqIDAuNzczMDEwNDUzMzYyNzM3IC8gMi4zODRlLTA2LFxuXHRcdFx0LTEuNjY4OWUtMDUgKiAwLjc3MzAxMDQ1MzM2MjczNyAvIDIuMzg0ZS0wNixcblx0XHRcdDguMjA2Nzg3OTA4Mjg2NjAyZS0wMSwgMy45MDE4MDY0NDAzMjI1NjdlLTAxLFxuXG5cdFx0XHQtNC43N2UtMDcgKiAwLjgwMzIwNzUzMTQ4MDY0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMDcyODhlLTA0ICogMC44MDMyMDc1MzE0ODA2NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjAyNjUzZS0wNCAqIDAuODAzMjA3NTMxNDgwNjQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0Mi4xNzQ4NTRlLTAzICogMC44MDMyMDc1MzE0ODA2NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjU1ODYzNTdlLTAyICogMC44MDMyMDc1MzE0ODA2NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjg1ODU2NmUtMDMgKiAwLjgwMzIwNzUzMTQ4MDY0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuOTUxNTllLTA0ICogMC44MDMyMDc1MzE0ODA2NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjM0NjBlLTA1ICogMC44MDMyMDc1MzE0ODA2NDUgLyAyLjM4NGUtMDYsIC8qIDEzICovXG5cdFx0XHQxLjAwMTRlLTA1ICogMC44MDMyMDc1MzE0ODA2NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjQwMTkwZS0wNCAqIDAuODAzMjA3NTMxNDgwNjQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0MS45MzczODllLTAzICogMC44MDMyMDc1MzE0ODA2NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjUyMzM1MTdlLTAyICogMC44MDMyMDc1MzE0ODA2NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi4wNTA2ODU5ZS0wMiAqIDAuODAzMjA3NTMxNDgwNjQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuOTc0MDMzZS0wMyAqIDAuODAzMjA3NTMxNDgwNjQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0LTMuMDc1NjBlLTA0ICogMC44MDMyMDc1MzE0ODA2NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMS44MTIwZS0wNSAqIDAuODAzMjA3NTMxNDgwNjQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0Ny40MTY1MDU0NjI3MjAzNTNlLTAxLCA1LjgwNTY5MzU0NTA4OTI0OWUtMDEsXG5cblx0XHRcdC00Ljc3ZS0wNyAqIDAuODMxNDY5NjEyMzAyNTQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0MS4wODI0MmUtMDQgKiAwLjgzMTQ2OTYxMjMwMjU0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDguNjg3OTdlLTA0ICogMC44MzE0Njk2MTIzMDI1NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjgwMDUzN2UtMDMgKiAwLjgzMTQ2OTYxMjMwMjU0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDMuNTQzNTIwMGUtMDIgKiAwLjgzMTQ2OTYxMjMwMjU0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDQuMDQ5MzAxZS0wMyAqIDAuODMxNDY5NjEyMzAyNTQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0OS45NDIwNWUtMDQgKiAwLjgzMTQ2OTYxMjMwMjU0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuMDU5OWUtMDUgKiAwLjgzMTQ2OTYxMjMwMjU0NSAvIDIuMzg0ZS0wNiwgLyogMTIgKi9cblx0XHRcdDkuMDYwZS0wNiAqIDAuODMxNDY5NjEyMzAyNTQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0MS4xNjM0OGUtMDQgKiAwLjgzMTQ2OTYxMjMwMjU0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuNzY2NjgyZS0wMyAqIDAuODMxNDY5NjEyMzAyNTQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0MS40MzU4NTIxZS0wMiAqIDAuODMxNDY5NjEyMzAyNTQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuMTM3MjMxOGUtMDIgKiAwLjgzMTQ2OTYxMjMwMjU0NSAvIDIuMzg0ZS0wNixcblx0XHRcdC0zLjE0MTg4ZS0wMyAqIDAuODMxNDY5NjEyMzAyNTQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0LTMuMzkwMzFlLTA0ICogMC44MzE0Njk2MTIzMDI1NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMS45NTUwZS0wNSAqIDAuODMxNDY5NjEyMzAyNTQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0Ni42ODE3ODYzNzkxOTI5ODllLTAxLCA3LjY1MzY2ODY0NzMwMTc5N2UtMDEsXG5cblx0XHRcdC00Ljc3ZS0wNyAqIDAuODU3NzI4NjEwMDAwMjcyIC8gMi4zODRlLTA2LFxuXHRcdFx0MS4wODcxOWUtMDQgKiAwLjg1NzcyODYxMDAwMDI3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDguMjkyMjBlLTA0ICogMC44NTc3Mjg2MTAwMDAyNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjM5OTUxN2UtMDMgKiAwLjg1NzcyODYxMDAwMDI3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDMuNTI0MjA4MWUtMDIgKiAwLjg1NzcyODYxMDAwMDI3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDQuMjE1MjQwZS0wMyAqIDAuODU3NzI4NjEwMDAwMjcyIC8gMi4zODRlLTA2LFxuXHRcdFx0OS44OTQzN2UtMDQgKiAwLjg1NzcyODYxMDAwMDI3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDguNzI2MWUtMDUgKiAwLjg1NzcyODYxMDAwMDI3MiAvIDIuMzg0ZS0wNiwgLyogMTEgKi9cblx0XHRcdDguMTA2ZS0wNiAqIDAuODU3NzI4NjEwMDAwMjcyIC8gMi4zODRlLTA2LFxuXHRcdFx0OS4zOTM3ZS0wNSAqIDAuODU3NzI4NjEwMDAwMjcyIC8gMi4zODRlLTA2LFxuXHRcdFx0MS41OTc4ODFlLTAzICogMC44NTc3Mjg2MTAwMDAyNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjM0ODkyNDZlLTAyICogMC44NTc3Mjg2MTAwMDAyNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi4yMjI4NzE4ZS0wMiAqIDAuODU3NzI4NjEwMDAwMjcyIC8gMi4zODRlLTA2LFxuXHRcdFx0LTMuMzA2ODY2ZS0wMyAqIDAuODU3NzI4NjEwMDAwMjcyIC8gMi4zODRlLTA2LFxuXHRcdFx0LTMuNzE0NTZlLTA0ICogMC44NTc3Mjg2MTAwMDAyNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi4xNDU4ZS0wNSAqIDAuODU3NzI4NjEwMDAwMjcyIC8gMi4zODRlLTA2LFxuXHRcdFx0NS45OTM3NjkzMzY4MTkyMzdlLTAxLCA5LjQyNzkzNDczNjUxOTk1NGUtMDEsXG5cblx0XHRcdC00Ljc3ZS0wNyAqIDAuODgxOTIxMjY0MzQ4MzU1IC8gMi4zODRlLTA2LFxuXHRcdFx0MS4wODcxOWUtMDQgKiAwLjg4MTkyMTI2NDM0ODM1NSAvIDIuMzg0ZS0wNixcblx0XHRcdDcuODM5MmUtMDQgKiAwLjg4MTkyMTI2NDM0ODM1NSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuNzEzMTdlLTA0ICogMC44ODE5MjEyNjQzNDgzNTUgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjUwMDcwMDBlLTAyICogMC44ODE5MjEyNjQzNDgzNTUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0LjM1NzgxNWUtMDMgKiAwLjg4MTkyMTI2NDM0ODM1NSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuODA4NTRlLTA0ICogMC44ODE5MjEyNjQzNDgzNTUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ4LjM5MjNlLTA1ICogMC44ODE5MjEyNjQzNDgzNTUgLyAyLjM4NGUtMDYsIC8qIDEwICovXG5cdFx0XHQ3LjYyOWUtMDYgKiAwLjg4MTkyMTI2NDM0ODM1NSAvIDIuMzg0ZS0wNixcblx0XHRcdDcuMjk1NmUtMDUgKiAwLjg4MTkyMTI2NDM0ODM1NSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuNDMyNDE5ZS0wMyAqIDAuODgxOTIxMjY0MzQ4MzU1IC8gMi4zODRlLTA2LFxuXHRcdFx0MS4yNjI3NjAyZS0wMiAqIDAuODgxOTIxMjY0MzQ4MzU1IC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuMzA3NDE1MGUtMDIgKiAwLjg4MTkyMTI2NDM0ODM1NSAvIDIuMzg0ZS0wNixcblx0XHRcdC0zLjQ2NzA4M2UtMDMgKiAwLjg4MTkyMTI2NDM0ODM1NSAvIDIuMzg0ZS0wNixcblx0XHRcdC00LjA0MzU4ZS0wNCAqIDAuODgxOTIxMjY0MzQ4MzU1IC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuMzM2NWUtMDUgKiAwLjg4MTkyMTI2NDM0ODM1NSAvIDIuMzg0ZS0wNixcblx0XHRcdDUuMzQ1MTExMzU5NTA3OTE2ZS0wMSwgMS4xMTExNDA0NjYwMzkyMDVlKzAwLFxuXG5cdFx0XHQtOS41NGUtMDcgKiAwLjkwMzk4OTI5MzEyMzQ0MyAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMDgyNDJlLTA0ICogMC45MDM5ODkyOTMxMjM0NDMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ3LjMxOTQ1ZS0wNCAqIDAuOTAzOTg5MjkzMTIzNDQzIC8gMi4zODRlLTA2LFxuXHRcdFx0NS4xNTkzOGUtMDQgKiAwLjkwMzk4OTI5MzEyMzQ0MyAvIDIuMzg0ZS0wNixcblx0XHRcdDMuNDczMDQzNGUtMDIgKiAwLjkwMzk4OTI5MzEyMzQ0MyAvIDIuMzg0ZS0wNixcblx0XHRcdDQuNDc3MDI0ZS0wMyAqIDAuOTAzOTg5MjkzMTIzNDQzIC8gMi4zODRlLTA2LFxuXHRcdFx0OS42ODkzM2UtMDQgKiAwLjkwMzk4OTI5MzEyMzQ0MyAvIDIuMzg0ZS0wNixcblx0XHRcdDguMDU4NWUtMDUgKiAwLjkwMzk4OTI5MzEyMzQ0MyAvIDIuMzg0ZS0wNiwgLyogOSAqL1xuXHRcdFx0Ni42NzZlLTA2ICogMC45MDM5ODkyOTMxMjM0NDMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ1LjI5MjllLTA1ICogMC45MDM5ODkyOTMxMjM0NDMgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjI2OTgxN2UtMDMgKiAwLjkwMzk4OTI5MzEyMzQ0MyAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMTc3NTAxN2UtMDIgKiAwLjkwMzk4OTI5MzEyMzQ0MyAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjM5MDcxODVlLTAyICogMC45MDM5ODkyOTMxMjM0NDMgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMy42MjI1MzJlLTAzICogMC45MDM5ODkyOTMxMjM0NDMgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNC4zODIxM2UtMDQgKiAwLjkwMzk4OTI5MzEyMzQ0MyAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjUyNzJlLTA1ICogMC45MDM5ODkyOTMxMjM0NDMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0LjcyOTY0Nzc1ODkxMzE5OWUtMDEsIDEuMjY4Nzg2NTY4MzI3MjkxZSswMCxcblxuXHRcdFx0LTkuNTRlLTA3ICogMC45MjM4Nzk1MzI1MTEyODY3NTYxMyAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMDY4MTJlLTA0ICogMC45MjM4Nzk1MzI1MTEyODY3NTYxMyAvIDIuMzg0ZS0wNixcblx0XHRcdDYuNzQyNDhlLTA0ICogMC45MjM4Nzk1MzI1MTEyODY3NTYxMyAvIDIuMzg0ZS0wNixcblx0XHRcdDMuMzM3OWUtMDUgKiAwLjkyMzg3OTUzMjUxMTI4Njc1NjEzIC8gMi4zODRlLTA2LFxuXHRcdFx0My40NDEyODYxZS0wMiAqIDAuOTIzODc5NTMyNTExMjg2NzU2MTMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0LjU3MzgyMmUtMDMgKiAwLjkyMzg3OTUzMjUxMTI4Njc1NjEzIC8gMi4zODRlLTA2LFxuXHRcdFx0OS41NDE1MWUtMDQgKiAwLjkyMzg3OTUzMjUxMTI4Njc1NjEzIC8gMi4zODRlLTA2LFxuXHRcdFx0Ny42NzcxZS0wNSAqIDAuOTIzODc5NTMyNTExMjg2NzU2MTMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ2LjE5OWUtMDYgKiAwLjkyMzg3OTUzMjUxMTI4Njc1NjEzIC8gMi4zODRlLTA2LFxuXHRcdFx0My40MzMyZS0wNSAqIDAuOTIzODc5NTMyNTExMjg2NzU2MTMgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjExMTAzMWUtMDMgKiAwLjkyMzg3OTUzMjUxMTI4Njc1NjEzIC8gMi4zODRlLTA2LFxuXHRcdFx0MS4wOTMzMzk5ZS0wMiAqIDAuOTIzODc5NTMyNTExMjg2NzU2MTMgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi40NzI1NDM3ZS0wMiAqIDAuOTIzODc5NTMyNTExMjg2NzU2MTMgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMy43NzE3ODJlLTAzICogMC45MjM4Nzk1MzI1MTEyODY3NTYxMyAvIDIuMzg0ZS0wNixcblx0XHRcdC00LjcyNTQ2ZS0wNCAqIDAuOTIzODc5NTMyNTExMjg2NzU2MTMgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi43NjU3ZS0wNSAqIDAuOTIzODc5NTMyNTExMjg2NzU2MTMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0LjE0MjEzNTYyMzczMDk1MDQ4NzllLTAxLCAvKiB0YW4oUEkvOCkgKi9cblx0XHRcdDEuNDE0MjEzNTYyMzczMDk1ZSswMCxcblxuXHRcdFx0LTkuNTRlLTA3ICogMC45NDE1NDQwNjUxODMwMjEgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjA1MzgxZS0wNCAqIDAuOTQxNTQ0MDY1MTgzMDIxIC8gMi4zODRlLTA2LFxuXHRcdFx0Ni4xMDM1MmUtMDQgKiAwLjk0MTU0NDA2NTE4MzAyMSAvIDIuMzg0ZS0wNixcblx0XHRcdC00Ljc1ODgzZS0wNCAqIDAuOTQxNTQ0MDY1MTgzMDIxIC8gMi4zODRlLTA2LFxuXHRcdFx0My40MDU1NzEwZS0wMiAqIDAuOTQxNTQ0MDY1MTgzMDIxIC8gMi4zODRlLTA2LFxuXHRcdFx0NC42NDkxNjJlLTAzICogMC45NDE1NDQwNjUxODMwMjEgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjM1NTU1ZS0wNCAqIDAuOTQxNTQ0MDY1MTgzMDIxIC8gMi4zODRlLTA2LFxuXHRcdFx0Ny4zNDMzZS0wNSAqIDAuOTQxNTQ0MDY1MTgzMDIxIC8gMi4zODRlLTA2LCAvKiA3ICovXG5cdFx0XHQ1LjI0NWUtMDYgKiAwLjk0MTU0NDA2NTE4MzAyMSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuNzE2NmUtMDUgKiAwLjk0MTU0NDA2NTE4MzAyMSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuNTY1MzVlLTA0ICogMC45NDE1NDQwNjUxODMwMjEgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjAxMDM3MDNlLTAyICogMC45NDE1NDQwNjUxODMwMjEgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi41NTI3MDAwZS0wMiAqIDAuOTQxNTQ0MDY1MTgzMDIxIC8gMi4zODRlLTA2LFxuXHRcdFx0LTMuOTE0MzU2ZS0wMyAqIDAuOTQxNTQ0MDY1MTgzMDIxIC8gMi4zODRlLTA2LFxuXHRcdFx0LTUuMDczNTVlLTA0ICogMC45NDE1NDQwNjUxODMwMjEgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMy4wMDQxZS0wNSAqIDAuOTQxNTQ0MDY1MTgzMDIxIC8gMi4zODRlLTA2LFxuXHRcdFx0My41NzgwNTcyMTMxNDUyNDFlLTAxLCAxLjU0NjAyMDkwNjcyNTQ3NGUrMDAsXG5cblx0XHRcdC05LjU0ZS0wNyAqIDAuOTU2OTQwMzM1NzMyMjA5IC8gMi4zODRlLTA2LFxuXHRcdFx0MS4wMjUyMGUtMDQgKiAwLjk1Njk0MDMzNTczMjIwOSAvIDIuMzg0ZS0wNixcblx0XHRcdDUuMzkzMDNlLTA0ICogMC45NTY5NDAzMzU3MzIyMDkgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMS4wMTE4NDhlLTAzICogMC45NTY5NDAzMzU3MzIyMDkgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjM2NTk5MzVlLTAyICogMC45NTY5NDAzMzU3MzIyMDkgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0LjcwMzA0NWUtMDMgKiAwLjk1Njk0MDMzNTczMjIwOSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuMTUwNTFlLTA0ICogMC45NTY5NDAzMzU3MzIyMDkgLyAyLjM4NGUtMDYsXG5cdFx0XHQ3LjAwOTVlLTA1ICogMC45NTY5NDAzMzU3MzIyMDkgLyAyLjM4NGUtMDYsIC8qIDYgKi9cblx0XHRcdDQuNzY4ZS0wNiAqIDAuOTU2OTQwMzM1NzMyMjA5IC8gMi4zODRlLTA2LFxuXHRcdFx0OS41NGUtMDcgKiAwLjk1Njk0MDMzNTczMjIwOSAvIDIuMzg0ZS0wNixcblx0XHRcdDguMDY4MDhlLTA0ICogMC45NTY5NDAzMzU3MzIyMDkgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjI4NzgzNGUtMDMgKiAwLjk1Njk0MDMzNTczMjIwOSAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjYzMTA5MjFlLTAyICogMC45NTY5NDAzMzU3MzIyMDkgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNC4wNDg4MjRlLTAzICogMC45NTY5NDAzMzU3MzIyMDkgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNS40MjE2NGUtMDQgKiAwLjk1Njk0MDMzNTczMjIwOSAvIDIuMzg0ZS0wNixcblx0XHRcdC0zLjI0MjVlLTA1ICogMC45NTY5NDAzMzU3MzIyMDkgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjAzMzQ2NjgzNjA3MzQyNGUtMDEsIDEuNjYyOTM5MjI0NjA1MDkwZSswMCxcblxuXHRcdFx0LTEuNDMxZS0wNiAqIDAuOTcwMDMxMjUzMTk0NTQ0IC8gMi4zODRlLTA2LFxuXHRcdFx0OS45MTgyZS0wNSAqIDAuOTcwMDMxMjUzMTk0NTQ0IC8gMi4zODRlLTA2LFxuXHRcdFx0NC42MjUzMmUtMDQgKiAwLjk3MDAzMTI1MzE5NDU0NCAvIDIuMzg0ZS0wNixcblx0XHRcdC0xLjU3MzU2M2UtMDMgKiAwLjk3MDAzMTI1MzE5NDU0NCAvIDIuMzg0ZS0wNixcblx0XHRcdDMuMzIyNTUzNmUtMDIgKiAwLjk3MDAzMTI1MzE5NDU0NCAvIDIuMzg0ZS0wNixcblx0XHRcdDQuNzM3Mzc3ZS0wMyAqIDAuOTcwMDMxMjUzMTk0NTQ0IC8gMi4zODRlLTA2LFxuXHRcdFx0OC45MTY4NWUtMDQgKiAwLjk3MDAzMTI1MzE5NDU0NCAvIDIuMzg0ZS0wNixcblx0XHRcdDYuNjI4MGUtMDUgKiAwLjk3MDAzMTI1MzE5NDU0NCAvIDIuMzg0ZS0wNiwgLyogNSAqL1xuXHRcdFx0NC4yOTJlLTA2ICogMC45NzAwMzEyNTMxOTQ1NDQgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMS4zODI4ZS0wNSAqIDAuOTcwMDMxMjUzMTk0NTQ0IC8gMi4zODRlLTA2LFxuXHRcdFx0Ni42MTg1MGUtMDQgKiAwLjk3MDAzMTI1MzE5NDU0NCAvIDIuMzg0ZS0wNixcblx0XHRcdDguNDg3MjI1ZS0wMyAqIDAuOTcwMDMxMjUzMTk0NTQ0IC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuNzA3Mzg2MGUtMDIgKiAwLjk3MDAzMTI1MzE5NDU0NCAvIDIuMzg0ZS0wNixcblx0XHRcdC00LjE3NDcwOWUtMDMgKiAwLjk3MDAzMTI1MzE5NDU0NCAvIDIuMzg0ZS0wNixcblx0XHRcdC01Ljc2OTczZS0wNCAqIDAuOTcwMDMxMjUzMTk0NTQ0IC8gMi4zODRlLTA2LFxuXHRcdFx0LTMuNDgwOWUtMDUgKiAwLjk3MDAzMTI1MzE5NDU0NCAvIDIuMzg0ZS0wNixcblx0XHRcdDIuNTA0ODY5NjAxOTEzMDU1ZS0wMSwgMS43NjM4NDI1Mjg2OTY3MTBlKzAwLFxuXG5cdFx0XHQtMS40MzFlLTA2ICogMC45ODA3ODUyODA0MDMyMyAvIDIuMzg0ZS0wNixcblx0XHRcdDkuNTM2N2UtMDUgKiAwLjk4MDc4NTI4MDQwMzIzIC8gMi4zODRlLTA2LFxuXHRcdFx0My43ODYwOWUtMDQgKiAwLjk4MDc4NTI4MDQwMzIzIC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuMTYxNTAzZS0wMyAqIDAuOTgwNzg1MjgwNDAzMjMgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjI3NTQ4OThlLTAyICogMC45ODA3ODUyODA0MDMyMyAvIDIuMzg0ZS0wNixcblx0XHRcdDQuNzUyMTU5ZS0wMyAqIDAuOTgwNzg1MjgwNDAzMjMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ4LjY2NDEzZS0wNCAqIDAuOTgwNzg1MjgwNDAzMjMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ2LjI5NDNlLTA1ICogMC45ODA3ODUyODA0MDMyMyAvIDIuMzg0ZS0wNiwgLyogNCAqL1xuXHRcdFx0My44MTVlLTA2ICogMC45ODA3ODUyODA0MDMyMyAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjcxOGUtMDUgKiAwLjk4MDc4NTI4MDQwMzIzIC8gMi4zODRlLTA2LFxuXHRcdFx0NS4yMjEzN2UtMDQgKiAwLjk4MDc4NTI4MDQwMzIzIC8gMi4zODRlLTA2LFxuXHRcdFx0Ny43MDMzMDRlLTAzICogMC45ODA3ODUyODA0MDMyMyAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjc4MTUzNDJlLTAyICogMC45ODA3ODUyODA0MDMyMyAvIDIuMzg0ZS0wNixcblx0XHRcdC00LjI5MDU4MWUtMDMgKiAwLjk4MDc4NTI4MDQwMzIzIC8gMi4zODRlLTA2LFxuXHRcdFx0LTYuMTE3ODJlLTA0ICogMC45ODA3ODUyODA0MDMyMyAvIDIuMzg0ZS0wNixcblx0XHRcdC0zLjc2NzBlLTA1ICogMC45ODA3ODUyODA0MDMyMyAvIDIuMzg0ZS0wNixcblx0XHRcdDEuOTg5MTIzNjczNzk2NTgwZS0wMSwgMS44NDc3NTkwNjUwMjI1NzNlKzAwLFxuXG5cdFx0XHQtMS45MDdlLTA2ICogMC45ODkxNzY1MDk5NjQ3ODEgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjAxMjJlLTA1ICogMC45ODkxNzY1MDk5NjQ3ODEgLyAyLjM4NGUtMDYsXG5cdFx0XHQyLjg4NDg2ZS0wNCAqIDAuOTg5MTc2NTA5OTY0NzgxIC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuNzc0MjM5ZS0wMyAqIDAuOTg5MTc2NTA5OTY0NzgxIC8gMi4zODRlLTA2LFxuXHRcdFx0My4yMjQ4MDIwZS0wMiAqIDAuOTg5MTc2NTA5OTY0NzgxIC8gMi4zODRlLTA2LFxuXHRcdFx0NC43NDg4MjFlLTAzICogMC45ODkxNzY1MDk5NjQ3ODEgLyAyLjM4NGUtMDYsXG5cdFx0XHQ4LjM4NzU3ZS0wNCAqIDAuOTg5MTc2NTA5OTY0NzgxIC8gMi4zODRlLTA2LFxuXHRcdFx0NS45NjA1ZS0wNSAqIDAuOTg5MTc2NTA5OTY0NzgxIC8gMi4zODRlLTA2LCAvKiAzICovXG5cdFx0XHQzLjMzOGUtMDYgKiAwLjk4OTE3NjUwOTk2NDc4MSAvIDIuMzg0ZS0wNixcblx0XHRcdC0zLjk1NzdlLTA1ICogMC45ODkxNzY1MDk5NjQ3ODEgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjg4MTQ1ZS0wNCAqIDAuOTg5MTc2NTA5OTY0NzgxIC8gMi4zODRlLTA2LFxuXHRcdFx0Ni45MzcwMjdlLTAzICogMC45ODkxNzY1MDk5NjQ3ODEgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi44NTMyOTgyZS0wMiAqIDAuOTg5MTc2NTA5OTY0NzgxIC8gMi4zODRlLTA2LFxuXHRcdFx0LTQuMzk1OTYyZS0wMyAqIDAuOTg5MTc2NTA5OTY0NzgxIC8gMi4zODRlLTA2LFxuXHRcdFx0LTYuNDY1OTFlLTA0ICogMC45ODkxNzY1MDk5NjQ3ODEgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNC4wNTMxZS0wNSAqIDAuOTg5MTc2NTA5OTY0NzgxIC8gMi4zODRlLTA2LFxuXHRcdFx0MS40ODMzNTk4NzUzODM0NzRlLTAxLCAxLjkxMzg4MDY3MTQ2NDQxOGUrMDAsXG5cblx0XHRcdC0xLjkwN2UtMDYgKiAwLjk5NTE4NDcyNjY3MjE5NyAvIDIuMzg0ZS0wNixcblx0XHRcdDguNDQwMGUtMDUgKiAwLjk5NTE4NDcyNjY3MjE5NyAvIDIuMzg0ZS0wNixcblx0XHRcdDEuOTE2ODllLTA0ICogMC45OTUxODQ3MjY2NzIxOTcgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMy40MTEyOTNlLTAzICogMC45OTUxODQ3MjY2NzIxOTcgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjE3MDY4MTBlLTAyICogMC45OTUxODQ3MjY2NzIxOTcgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0LjcyODMxN2UtMDMgKiAwLjk5NTE4NDcyNjY3MjE5NyAvIDIuMzg0ZS0wNixcblx0XHRcdDguMDk2NjllLTA0ICogMC45OTUxODQ3MjY2NzIxOTcgLyAyLjM4NGUtMDYsXG5cdFx0XHQ1LjU3OWUtMDUgKiAwLjk5NTE4NDcyNjY3MjE5NyAvIDIuMzg0ZS0wNixcblx0XHRcdDMuMzM4ZS0wNiAqIDAuOTk1MTg0NzI2NjcyMTk3IC8gMi4zODRlLTA2LFxuXHRcdFx0LTUuMDU0NWUtMDUgKiAwLjk5NTE4NDcyNjY3MjE5NyAvIDIuMzg0ZS0wNixcblx0XHRcdDIuNTk4NzZlLTA0ICogMC45OTUxODQ3MjY2NzIxOTcgLyAyLjM4NGUtMDYsXG5cdFx0XHQ2LjE4OTM0NmUtMDMgKiAwLjk5NTE4NDcyNjY3MjE5NyAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjkyMjQ4NzNlLTAyICogMC45OTUxODQ3MjY2NzIxOTcgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNC40ODk4OTllLTAzICogMC45OTUxODQ3MjY2NzIxOTcgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNi44MDkyM2UtMDQgKiAwLjk5NTE4NDcyNjY3MjE5NyAvIDIuMzg0ZS0wNixcblx0XHRcdC00LjMzOTJlLTA1ICogMC45OTUxODQ3MjY2NzIxOTcgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5Ljg0OTE0MDMzNTcxNjQyNWUtMDIsIDEuOTYxNTcwNTYwODA2NDYxZSswMCxcblxuXHRcdFx0LTIuMzg0ZS0wNiAqIDAuOTk4Nzk1NDU2MjA1MTcyIC8gMi4zODRlLTA2LFxuXHRcdFx0Ny43NzI0ZS0wNSAqIDAuOTk4Nzk1NDU2MjA1MTcyIC8gMi4zODRlLTA2LFxuXHRcdFx0OC44MjE1ZS0wNSAqIDAuOTk4Nzk1NDU2MjA1MTcyIC8gMi4zODRlLTA2LFxuXHRcdFx0LTQuMDcyMTg5ZS0wMyAqIDAuOTk4Nzk1NDU2MjA1MTcyIC8gMi4zODRlLTA2LFxuXHRcdFx0My4xMTMyNjk4ZS0wMiAqIDAuOTk4Nzk1NDU2MjA1MTcyIC8gMi4zODRlLTA2LFxuXHRcdFx0NC42OTExMjRlLTAzICogMC45OTg3OTU0NTYyMDUxNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQ3Ljc5MTUyZS0wNCAqIDAuOTk4Nzk1NDU2MjA1MTcyIC8gMi4zODRlLTA2LFxuXHRcdFx0NS4yOTI5ZS0wNSAqIDAuOTk4Nzk1NDU2MjA1MTcyIC8gMi4zODRlLTA2LFxuXHRcdFx0Mi44NjFlLTA2ICogMC45OTg3OTU0NTYyMDUxNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNi4wNTU4ZS0wNSAqIDAuOTk4Nzk1NDU2MjA1MTcyIC8gMi4zODRlLTA2LFxuXHRcdFx0MS4zNzMyOWUtMDQgKiAwLjk5ODc5NTQ1NjIwNTE3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDUuNDYyMTcwZS0wMyAqIDAuOTk4Nzk1NDU2MjA1MTcyIC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuOTg5MDA2MGUtMDIgKiAwLjk5ODc5NTQ1NjIwNTE3MiAvIDIuMzg0ZS0wNixcblx0XHRcdC00LjU3MDQ4NGUtMDMgKiAwLjk5ODc5NTQ1NjIwNTE3MiAvIDIuMzg0ZS0wNixcblx0XHRcdC03LjE0MzAyZS0wNCAqIDAuOTk4Nzk1NDU2MjA1MTcyIC8gMi4zODRlLTA2LFxuXHRcdFx0LTQuNjI1M2UtMDUgKiAwLjk5ODc5NTQ1NjIwNTE3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDQuOTEyNjg0OTc2OTQ2NzI1ZS0wMiwgMS45OTAzNjk0NTMzNDQzOTRlKzAwLFxuXG5cdFx0XHQzLjU3ODA5MDdlLTAyICogVXRpbC5TUVJUMiAqIDAuNSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuNzg3NjE0OGUtMDIgKiBVdGlsLlNRUlQyICogMC41IC8gMi4zODRlLTA2LFxuXHRcdFx0My4xMzQ3MjdlLTAzICogVXRpbC5TUVJUMiAqIDAuNSAvIDIuMzg0ZS0wNixcblx0XHRcdDIuNDU3MTQyZS0wMyAqIFV0aWwuU1FSVDIgKiAwLjUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjcxMzE3ZS0wNCAqIFV0aWwuU1FSVDIgKiAwLjUgLyAyLjM4NGUtMDYsXG5cdFx0XHQyLjE4ODY4ZS0wNCAqIFV0aWwuU1FSVDIgKiAwLjUgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjAxNTY2ZS0wNCAqIFV0aWwuU1FSVDIgKiAwLjUgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjM4MjhlLTA1ICogVXRpbC5TUVJUMiAqIDAuNSAvIDIuMzg0ZS0wNixcblxuXHRcdFx0My4wNTI2NjM4ZS0wMiAvIDIuMzg0ZS0wNiwgNC42MzgxOTVlLTAzIC8gMi4zODRlLTA2LFxuXHRcdFx0Ny40NzIwNGUtMDQgLyAyLjM4NGUtMDYsIDQuOTU5MWUtMDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0Ljc1NjQ1MWUtMDMgLyAyLjM4NGUtMDYsIDIuMTQ1OGUtMDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNi45NjE4ZS0wNSAvIDIuMzg0ZS0wNiwgLyogMi4zODRlLTA2LzIuMzg0ZS0wNiAqL1xuXHRdO1xuXG5cdHZhciBOUyA9IDEyO1xuXHR2YXIgTkwgPSAzNjtcblxuXHR2YXIgd2luID0gW1xuXHQgICAgW1xuXHQgICAgIDIuMzgyMTkxNzM5MzQ3OTEzZS0xMyxcblx0ICAgICA2LjQyMzMwNTg3MjE0NzgzNGUtMTMsXG5cdCAgICAgOS40MDA4NDkwOTQwNDk2ODhlLTEzLFxuXHQgICAgIDEuMTIyNDM1MDI2MDk2NTU2ZS0xMixcblx0ICAgICAxLjE4Mzg0MDMyMTI2NzQ4MWUtMTIsXG5cdCAgICAgMS4xMjI0MzUwMjYwOTY1NTZlLTEyLFxuXHQgICAgIDkuNDAwODQ5MDk0MDQ5NjkwZS0xMyxcblx0ICAgICA2LjQyMzMwNTg3MjE0NzgzOWUtMTMsXG5cdCAgICAgMi4zODIxOTE3MzkzNDc5MThlLTEzLFxuXG5cdCAgICAgNS40NTYxMTYxMDg5NDM0MTJlLTEyLFxuXHQgICAgIDQuODc4OTg1MTk5NTY1ODUyZS0xMixcblx0ICAgICA0LjI0MDQ0ODk5NTAxNzM2N2UtMTIsXG5cdCAgICAgMy41NTk5MDkwOTQ3NTgyNTJlLTEyLFxuXHQgICAgIDIuODU4MDQzMzU5Mjg4MDc1ZS0xMixcblx0ICAgICAyLjE1NjE3NzYyMzgxNzg5OGUtMTIsXG5cdCAgICAgMS40NzU2Mzc3MjM1NTg3ODNlLTEyLFxuXHQgICAgIDguMzcxMDE1MTkwMTAyOTc0ZS0xMyxcblx0ICAgICAyLjU5OTcwNjA5NjMyNzM3NmUtMTMsXG5cblx0ICAgICAtNS40NTYxMTYxMDg5NDM0MTJlLTEyLFxuXHQgICAgIC00Ljg3ODk4NTE5OTU2NTg1MmUtMTIsXG5cdCAgICAgLTQuMjQwNDQ4OTk1MDE3MzY3ZS0xMixcblx0ICAgICAtMy41NTk5MDkwOTQ3NTgyNTJlLTEyLFxuXHQgICAgIC0yLjg1ODA0MzM1OTI4ODA3NmUtMTIsXG5cdCAgICAgLTIuMTU2MTc3NjIzODE3ODk4ZS0xMixcblx0ICAgICAtMS40NzU2Mzc3MjM1NTg3ODNlLTEyLFxuXHQgICAgIC04LjM3MTAxNTE5MDEwMjk3NWUtMTMsXG5cdCAgICAgLTIuNTk5NzA2MDk2MzI3Mzc2ZS0xMyxcblxuXHQgICAgIC0yLjM4MjE5MTczOTM0NzkyM2UtMTMsXG5cdCAgICAgLTYuNDIzMzA1ODcyMTQ3ODQzZS0xMyxcblx0ICAgICAtOS40MDA4NDkwOTQwNDk2OTZlLTEzLFxuXHQgICAgIC0xLjEyMjQzNTAyNjA5NjU1NmUtMTIsXG5cdCAgICAgLTEuMTgzODQwMzIxMjY3NDgxZS0xMixcblx0ICAgICAtMS4xMjI0MzUwMjYwOTY1NTZlLTEyLFxuXHQgICAgIC05LjQwMDg0OTA5NDA0OTY5NGUtMTMsXG5cdCAgICAgLTYuNDIzMzA1ODcyMTQ3ODQwZS0xMyxcblx0ICAgICAtMi4zODIxOTE3MzkzNDc5MThlLTEzLFxuXHQgICAgIF0sXG5cdCAgICBbXG5cdCAgICAgMi4zODIxOTE3MzkzNDc5MTNlLTEzLFxuXHQgICAgIDYuNDIzMzA1ODcyMTQ3ODM0ZS0xMyxcblx0ICAgICA5LjQwMDg0OTA5NDA0OTY4OGUtMTMsXG5cdCAgICAgMS4xMjI0MzUwMjYwOTY1NTZlLTEyLFxuXHQgICAgIDEuMTgzODQwMzIxMjY3NDgxZS0xMixcblx0ICAgICAxLjEyMjQzNTAyNjA5NjU1NmUtMTIsXG5cdCAgICAgOS40MDA4NDkwOTQwNDk2ODhlLTEzLFxuXHQgICAgIDYuNDIzMzA1ODcyMTQ3ODQxZS0xMyxcblx0ICAgICAyLjM4MjE5MTczOTM0NzkxOGUtMTMsXG5cblx0ICAgICA1LjQ1NjExNjEwODk0MzQxM2UtMTIsXG5cdCAgICAgNC44Nzg5ODUxOTk1NjU4NTJlLTEyLFxuXHQgICAgIDQuMjQwNDQ4OTk1MDE3MzY3ZS0xMixcblx0ICAgICAzLjU1OTkwOTA5NDc1ODI1M2UtMTIsXG5cdCAgICAgMi44NTgwNDMzNTkyODgwNzVlLTEyLFxuXHQgICAgIDIuMTU2MTc3NjIzODE3ODk4ZS0xMixcblx0ICAgICAxLjQ3NTYzNzcyMzU1ODc4MmUtMTIsXG5cdCAgICAgOC4zNzEwMTUxOTAxMDI5NzVlLTEzLFxuXHQgICAgIDIuNTk5NzA2MDk2MzI3Mzc2ZS0xMyxcblxuXHQgICAgIC01LjQ2MTMxNDA2OTgwOTc1NWUtMTIsXG5cdCAgICAgLTQuOTIxMDg1NzcwNTI0MDU1ZS0xMixcblx0ICAgICAtNC4zNDM0MDUwMzcwOTE4MzhlLTEyLFxuXHQgICAgIC0zLjczMjY2ODM2ODcwNzY4N2UtMTIsXG5cdCAgICAgLTMuMDkzNTIzODQwMTkwODg1ZS0xMixcblx0ICAgICAtMi40MzA4MzU3MjczMjk0NjVlLTEyLFxuXHQgICAgIC0xLjczNDY3OTAxMDAwNzc1MWUtMTIsXG5cdCAgICAgLTkuNzQ4MjUzNjU2NjA5MjgxZS0xMyxcblx0ICAgICAtMi43OTc0MzUxMjAxNjgzMjZlLTEzLFxuXG5cdCAgICAgMC4wMDAwMDAwMDAwMDAwMDBlKzAwLFxuXHQgICAgIDAuMDAwMDAwMDAwMDAwMDAwZSswMCxcblx0ICAgICAwLjAwMDAwMDAwMDAwMDAwMGUrMDAsXG5cdCAgICAgMC4wMDAwMDAwMDAwMDAwMDBlKzAwLFxuXHQgICAgIDAuMDAwMDAwMDAwMDAwMDAwZSswMCxcblx0ICAgICAwLjAwMDAwMDAwMDAwMDAwMGUrMDAsXG5cdCAgICAgLTIuMjgzNzQ4MjQxNzk5NTMxZS0xMyxcblx0ICAgICAtNC4wMzc4NTg4NzQwMjA2ODZlLTEzLFxuXHQgICAgIC0yLjE0NjU0NzQ2NDgyNTMyM2UtMTMsXG5cdCAgICAgXSxcblx0ICAgIFtcblx0ICAgICAxLjMxNjUyNDk3NTg3Mzk1OGUtMDEsIC8qIHdpbltTSE9SVF9UWVBFXSAqL1xuXHQgICAgIDQuMTQyMTM1NjIzNzMwOTUwZS0wMSxcblx0ICAgICA3LjY3MzI2OTg3OTc4OTYwMmUtMDEsXG5cblx0ICAgICAxLjA5MTMwODUwMTA2OTI3MWUrMDAsIC8qIHRhbnRhYl9sICovXG5cdCAgICAgMS4zMDMyMjUzNzI4NDEyMDZlKzAwLFxuXHQgICAgIDEuNTY5Njg1NTc3MTE3NDkwZSswMCxcblx0ICAgICAxLjkyMDk4MjEyNjk3MTE2NmUrMDAsXG5cdCAgICAgMi40MTQyMTM1NjIzNzMwOTRlKzAwLFxuXHQgICAgIDMuMTcxNTk0ODAyMzYzMjEyZSswMCxcblx0ICAgICA0LjUxMDcwODUwMzY2MjA1NWUrMDAsXG5cdCAgICAgNy41OTU3NTQxMTI3MjUxNDZlKzAwLFxuXHQgICAgIDIuMjkwMzc2NTU0ODQzMTE1ZSswMSxcblxuXHQgICAgIDAuOTg0ODA3NzUzMDEyMjA4MDIwMzIsIC8qIGN4ICovXG5cdCAgICAgMC42NDI3ODc2MDk2ODY1MzkzNjI5Mixcblx0ICAgICAwLjM0MjAyMDE0MzMyNTY2ODgyMzkzLFxuXHQgICAgIDAuOTM5NjkyNjIwNzg1OTA4NDI3OTEsXG5cdCAgICAgLTAuMTczNjQ4MTc3NjY2OTMwMzAzNDMsXG5cdCAgICAgLTAuNzY2MDQ0NDQzMTE4OTc3OTAyNDMsXG5cdCAgICAgMC44NjYwMjU0MDM3ODQ0Mzg3MDc2MSxcblx0ICAgICAwLjUwMDAwMDAwMDAwMDAwMGUrMDAsXG5cblx0ICAgICAtNS4xNDQ5NTc1NTQyNzUyNjVlLTAxLCAvKiBjYSAqL1xuXHQgICAgIC00LjcxNzMxOTY4NTY0OTcyM2UtMDEsXG5cdCAgICAgLTMuMTMzNzc0NTQyMDM5MDE5ZS0wMSxcblx0ICAgICAtMS44MTkxMzE5OTYxMDk4MTJlLTAxLFxuXHQgICAgIC05LjQ1NzQxOTI1MjY0MjA2NGUtMDIsXG5cdCAgICAgLTQuMDk2NTU4Mjg4NTMwNDA1ZS0wMixcblx0ICAgICAtMS40MTk4NTY4NTcyNDcxMTVlLTAyLFxuXHQgICAgIC0zLjY5OTk3NDY3Mzc2MDAzN2UtMDMsXG5cblx0ICAgICA4LjU3NDkyOTI1NzEyNTQ0MmUtMDEsIC8qIGNzICovXG5cdCAgICAgOC44MTc0MTk5NzMxNzcwNTJlLTAxLFxuXHQgICAgIDkuNDk2Mjg2NDkxMDI3MzI5ZS0wMSxcblx0ICAgICA5LjgzMzE0NTkyNDkxNzkwMWUtMDEsXG5cdCAgICAgOS45NTUxNzgxNjA2NzU4NTdlLTAxLFxuXHQgICAgIDkuOTkxNjA1NTgxNzgxNDc1ZS0wMSxcblx0ICAgICA5Ljk5ODk5MTk1MjQ0NDQ3MGUtMDEsXG5cdCAgICAgOS45OTk5MzE1NTA3MDI4MDJlLTAxLFxuXHQgICAgIF0sXG5cdCAgICBbXG5cdCAgICAgMC4wMDAwMDAwMDAwMDAwMDBlKzAwLFxuXHQgICAgIDAuMDAwMDAwMDAwMDAwMDAwZSswMCxcblx0ICAgICAwLjAwMDAwMDAwMDAwMDAwMGUrMDAsXG5cdCAgICAgMC4wMDAwMDAwMDAwMDAwMDBlKzAwLFxuXHQgICAgIDAuMDAwMDAwMDAwMDAwMDAwZSswMCxcblx0ICAgICAwLjAwMDAwMDAwMDAwMDAwMGUrMDAsXG5cdCAgICAgMi4yODM3NDgyNDE3OTk1MzFlLTEzLFxuXHQgICAgIDQuMDM3ODU4ODc0MDIwNjg2ZS0xMyxcblx0ICAgICAyLjE0NjU0NzQ2NDgyNTMyM2UtMTMsXG5cblx0ICAgICA1LjQ2MTMxNDA2OTgwOTc1NWUtMTIsXG5cdCAgICAgNC45MjEwODU3NzA1MjQwNTVlLTEyLFxuXHQgICAgIDQuMzQzNDA1MDM3MDkxODM4ZS0xMixcblx0ICAgICAzLjczMjY2ODM2ODcwNzY4N2UtMTIsXG5cdCAgICAgMy4wOTM1MjM4NDAxOTA4ODVlLTEyLFxuXHQgICAgIDIuNDMwODM1NzI3MzI5NDY2ZS0xMixcblx0ICAgICAxLjczNDY3OTAxMDAwNzc1MWUtMTIsXG5cdCAgICAgOS43NDgyNTM2NTY2MDkyODFlLTEzLFxuXHQgICAgIDIuNzk3NDM1MTIwMTY4MzI2ZS0xMyxcblxuXHQgICAgIC01LjQ1NjExNjEwODk0MzQxM2UtMTIsXG5cdCAgICAgLTQuODc4OTg1MTk5NTY1ODUyZS0xMixcblx0ICAgICAtNC4yNDA0NDg5OTUwMTczNjdlLTEyLFxuXHQgICAgIC0zLjU1OTkwOTA5NDc1ODI1M2UtMTIsXG5cdCAgICAgLTIuODU4MDQzMzU5Mjg4MDc1ZS0xMixcblx0ICAgICAtMi4xNTYxNzc2MjM4MTc4OThlLTEyLFxuXHQgICAgIC0xLjQ3NTYzNzcyMzU1ODc4MmUtMTIsXG5cdCAgICAgLTguMzcxMDE1MTkwMTAyOTc1ZS0xMyxcblx0ICAgICAtMi41OTk3MDYwOTYzMjczNzZlLTEzLFxuXG5cdCAgICAgLTIuMzgyMTkxNzM5MzQ3OTEzZS0xMyxcblx0ICAgICAtNi40MjMzMDU4NzIxNDc4MzRlLTEzLFxuXHQgICAgIC05LjQwMDg0OTA5NDA0OTY4OGUtMTMsXG5cdCAgICAgLTEuMTIyNDM1MDI2MDk2NTU2ZS0xMixcblx0ICAgICAtMS4xODM4NDAzMjEyNjc0ODFlLTEyLFxuXHQgICAgIC0xLjEyMjQzNTAyNjA5NjU1NmUtMTIsXG5cdCAgICAgLTkuNDAwODQ5MDk0MDQ5Njg4ZS0xMyxcblx0ICAgICAtNi40MjMzMDU4NzIxNDc4NDFlLTEzLFxuXHQgICAgIC0yLjM4MjE5MTczOTM0NzkxOGUtMTMsXG5cdCAgICAgXVxuXHRdO1xuXG5cdHZhciB0YW50YWJfbCA9IHdpbltFbmNvZGVyLlNIT1JUX1RZUEVdO1xuXHR2YXIgY3ggPSB3aW5bRW5jb2Rlci5TSE9SVF9UWVBFXTtcblx0dmFyIGNhID0gd2luW0VuY29kZXIuU0hPUlRfVFlQRV07XG5cdHZhciBjcyA9IHdpbltFbmNvZGVyLlNIT1JUX1RZUEVdO1xuXG5cdC8qKlxuXHQgKiBuZXcgSURDVCByb3V0aW5lIHdyaXR0ZW4gYnkgVGFrZWhpcm8gVE9NSU5BR0Fcblx0ICpcblx0ICogUFVSUE9TRTogT3ZlcmxhcHBpbmcgd2luZG93IG9uIFBDTSBzYW1wbGVzPEJSPlxuXHQgKlxuXHQgKiBTRU1BTlRJQ1M6PEJSPlxuXHQgKiAzMiAxNi1iaXQgcGNtIHNhbXBsZXMgYXJlIHNjYWxlZCB0byBmcmFjdGlvbmFsIDIncyBjb21wbGVtZW50IGFuZFxuXHQgKiBjb25jYXRlbmF0ZWQgdG8gdGhlIGVuZCBvZiB0aGUgd2luZG93IGJ1ZmZlciAjeCMuIFRoZSB1cGRhdGVkIHdpbmRvd1xuXHQgKiBidWZmZXIgI3gjIGlzIHRoZW4gd2luZG93ZWQgYnkgdGhlIGFuYWx5c2lzIHdpbmRvdyAjYyMgdG8gcHJvZHVjZSB0aGVcblx0ICogd2luZG93ZWQgc2FtcGxlICN6I1xuXHQgKi9cblx0dmFyIG9yZGVyID0gW1xuXHQgICAgMCwgMSwgMTYsIDE3LCA4LCA5LCAyNCwgMjUsIDQsIDUsIDIwLCAyMSwgMTIsIDEzLCAyOCwgMjksXG5cdCAgICAyLCAzLCAxOCwgMTksIDEwLCAxMSwgMjYsIDI3LCA2LCA3LCAyMiwgMjMsIDE0LCAxNSwgMzAsIDMxXG5cdF07XG5cblx0LyoqXG5cdCAqIHJldHVybnMgc3VtX2o9MF4zMSBhW2pdKmNvcyhQSSpqKihrKzEvMikvMzIpLCAwPD1rPDMyXG5cdCAqL1xuXHRmdW5jdGlvbiB3aW5kb3dfc3ViYmFuZCh4MSwgeDFQb3MsIGEpIHtcblx0XHR2YXIgd3AgPSAxMDtcblxuXHRcdHZhciB4MiA9IHgxUG9zICsgMjM4IC0gMTQgLSAyODY7XG5cblx0XHRmb3IgKHZhciBpID0gLTE1OyBpIDwgMDsgaSsrKSB7XG5cdFx0XHR2YXIgdywgcywgdDtcblxuXHRcdFx0dyA9IGVud2luZG93W3dwICsgLTEwXTtcblx0XHRcdHMgPSB4MVt4MiArIC0yMjRdICogdztcblx0XHRcdHQgPSB4MVt4MVBvcyArIDIyNF0gKiB3O1xuXHRcdFx0dyA9IGVud2luZG93W3dwICsgLTldO1xuXHRcdFx0cyArPSB4MVt4MiArIC0xNjBdICogdztcblx0XHRcdHQgKz0geDFbeDFQb3MgKyAxNjBdICogdztcblx0XHRcdHcgPSBlbndpbmRvd1t3cCArIC04XTtcblx0XHRcdHMgKz0geDFbeDIgKyAtOTZdICogdztcblx0XHRcdHQgKz0geDFbeDFQb3MgKyA5Nl0gKiB3O1xuXHRcdFx0dyA9IGVud2luZG93W3dwICsgLTddO1xuXHRcdFx0cyArPSB4MVt4MiArIC0zMl0gKiB3O1xuXHRcdFx0dCArPSB4MVt4MVBvcyArIDMyXSAqIHc7XG5cdFx0XHR3ID0gZW53aW5kb3dbd3AgKyAtNl07XG5cdFx0XHRzICs9IHgxW3gyICsgMzJdICogdztcblx0XHRcdHQgKz0geDFbeDFQb3MgKyAtMzJdICogdztcblx0XHRcdHcgPSBlbndpbmRvd1t3cCArIC01XTtcblx0XHRcdHMgKz0geDFbeDIgKyA5Nl0gKiB3O1xuXHRcdFx0dCArPSB4MVt4MVBvcyArIC05Nl0gKiB3O1xuXHRcdFx0dyA9IGVud2luZG93W3dwICsgLTRdO1xuXHRcdFx0cyArPSB4MVt4MiArIDE2MF0gKiB3O1xuXHRcdFx0dCArPSB4MVt4MVBvcyArIC0xNjBdICogdztcblx0XHRcdHcgPSBlbndpbmRvd1t3cCArIC0zXTtcblx0XHRcdHMgKz0geDFbeDIgKyAyMjRdICogdztcblx0XHRcdHQgKz0geDFbeDFQb3MgKyAtMjI0XSAqIHc7XG5cblx0XHRcdHcgPSBlbndpbmRvd1t3cCArIC0yXTtcblx0XHRcdHMgKz0geDFbeDFQb3MgKyAtMjU2XSAqIHc7XG5cdFx0XHR0IC09IHgxW3gyICsgMjU2XSAqIHc7XG5cdFx0XHR3ID0gZW53aW5kb3dbd3AgKyAtMV07XG5cdFx0XHRzICs9IHgxW3gxUG9zICsgLTE5Ml0gKiB3O1xuXHRcdFx0dCAtPSB4MVt4MiArIDE5Ml0gKiB3O1xuXHRcdFx0dyA9IGVud2luZG93W3dwICsgMF07XG5cdFx0XHRzICs9IHgxW3gxUG9zICsgLTEyOF0gKiB3O1xuXHRcdFx0dCAtPSB4MVt4MiArIDEyOF0gKiB3O1xuXHRcdFx0dyA9IGVud2luZG93W3dwICsgMV07XG5cdFx0XHRzICs9IHgxW3gxUG9zICsgLTY0XSAqIHc7XG5cdFx0XHR0IC09IHgxW3gyICsgNjRdICogdztcblx0XHRcdHcgPSBlbndpbmRvd1t3cCArIDJdO1xuXHRcdFx0cyArPSB4MVt4MVBvcyArIDBdICogdztcblx0XHRcdHQgLT0geDFbeDIgKyAwXSAqIHc7XG5cdFx0XHR3ID0gZW53aW5kb3dbd3AgKyAzXTtcblx0XHRcdHMgKz0geDFbeDFQb3MgKyA2NF0gKiB3O1xuXHRcdFx0dCAtPSB4MVt4MiArIC02NF0gKiB3O1xuXHRcdFx0dyA9IGVud2luZG93W3dwICsgNF07XG5cdFx0XHRzICs9IHgxW3gxUG9zICsgMTI4XSAqIHc7XG5cdFx0XHR0IC09IHgxW3gyICsgLTEyOF0gKiB3O1xuXHRcdFx0dyA9IGVud2luZG93W3dwICsgNV07XG5cdFx0XHRzICs9IHgxW3gxUG9zICsgMTkyXSAqIHc7XG5cdFx0XHR0IC09IHgxW3gyICsgLTE5Ml0gKiB3O1xuXG5cdFx0XHQvKlxuXHRcdFx0ICogdGhpcyBtdWx0aXBseWVyIGNvdWxkIGJlIHJlbW92ZWQsIGJ1dCBpdCBuZWVkcyBtb3JlIDI1NiBGTE9BVFxuXHRcdFx0ICogZGF0YS4gdGhpbmtpbmcgYWJvdXQgdGhlIGRhdGEgY2FjaGUgcGVyZm9ybWFuY2UsIEkgdGhpbmsgd2Vcblx0XHRcdCAqIHNob3VsZCBub3QgdXNlIHN1Y2ggYSBodWdlIHRhYmxlLiB0dCAyMDAwL09jdC8yNVxuXHRcdFx0ICovXG5cdFx0XHRzICo9IGVud2luZG93W3dwICsgNl07XG5cdFx0XHR3ID0gdCAtIHM7XG5cdFx0XHRhWzMwICsgaSAqIDJdID0gdCArIHM7XG5cdFx0XHRhWzMxICsgaSAqIDJdID0gZW53aW5kb3dbd3AgKyA3XSAqIHc7XG5cdFx0XHR3cCArPSAxODtcblx0XHRcdHgxUG9zLS07XG5cdFx0XHR4MisrO1xuXHRcdH1cblx0XHR7XG5cdFx0XHR2YXIgcywgdCwgdSwgdjtcblx0XHRcdHQgPSB4MVt4MVBvcyArIC0xNl0gKiBlbndpbmRvd1t3cCArIC0xMF07XG5cdFx0XHRzID0geDFbeDFQb3MgKyAtMzJdICogZW53aW5kb3dbd3AgKyAtMl07XG5cdFx0XHR0ICs9ICh4MVt4MVBvcyArIC00OF0gLSB4MVt4MVBvcyArIDE2XSkgKiBlbndpbmRvd1t3cCArIC05XTtcblx0XHRcdHMgKz0geDFbeDFQb3MgKyAtOTZdICogZW53aW5kb3dbd3AgKyAtMV07XG5cdFx0XHR0ICs9ICh4MVt4MVBvcyArIC04MF0gKyB4MVt4MVBvcyArIDQ4XSkgKiBlbndpbmRvd1t3cCArIC04XTtcblx0XHRcdHMgKz0geDFbeDFQb3MgKyAtMTYwXSAqIGVud2luZG93W3dwICsgMF07XG5cdFx0XHR0ICs9ICh4MVt4MVBvcyArIC0xMTJdIC0geDFbeDFQb3MgKyA4MF0pICogZW53aW5kb3dbd3AgKyAtN107XG5cdFx0XHRzICs9IHgxW3gxUG9zICsgLTIyNF0gKiBlbndpbmRvd1t3cCArIDFdO1xuXHRcdFx0dCArPSAoeDFbeDFQb3MgKyAtMTQ0XSArIHgxW3gxUG9zICsgMTEyXSkgKiBlbndpbmRvd1t3cCArIC02XTtcblx0XHRcdHMgLT0geDFbeDFQb3MgKyAzMl0gKiBlbndpbmRvd1t3cCArIDJdO1xuXHRcdFx0dCArPSAoeDFbeDFQb3MgKyAtMTc2XSAtIHgxW3gxUG9zICsgMTQ0XSkgKiBlbndpbmRvd1t3cCArIC01XTtcblx0XHRcdHMgLT0geDFbeDFQb3MgKyA5Nl0gKiBlbndpbmRvd1t3cCArIDNdO1xuXHRcdFx0dCArPSAoeDFbeDFQb3MgKyAtMjA4XSArIHgxW3gxUG9zICsgMTc2XSkgKiBlbndpbmRvd1t3cCArIC00XTtcblx0XHRcdHMgLT0geDFbeDFQb3MgKyAxNjBdICogZW53aW5kb3dbd3AgKyA0XTtcblx0XHRcdHQgKz0gKHgxW3gxUG9zICsgLTI0MF0gLSB4MVt4MVBvcyArIDIwOF0pICogZW53aW5kb3dbd3AgKyAtM107XG5cdFx0XHRzIC09IHgxW3gxUG9zICsgMjI0XTtcblxuXHRcdFx0dSA9IHMgLSB0O1xuXHRcdFx0diA9IHMgKyB0O1xuXG5cdFx0XHR0ID0gYVsxNF07XG5cdFx0XHRzID0gYVsxNV0gLSB0O1xuXG5cdFx0XHRhWzMxXSA9IHYgKyB0OyAvKiBBMCAqL1xuXHRcdFx0YVszMF0gPSB1ICsgczsgLyogQTEgKi9cblx0XHRcdGFbMTVdID0gdSAtIHM7IC8qIEEyICovXG5cdFx0XHRhWzE0XSA9IHYgLSB0OyAvKiBBMyAqL1xuXHRcdH1cblx0XHR7XG5cdFx0XHR2YXIgeHI7XG5cdFx0XHR4ciA9IGFbMjhdIC0gYVswXTtcblx0XHRcdGFbMF0gKz0gYVsyOF07XG5cdFx0XHRhWzI4XSA9IHhyICogZW53aW5kb3dbd3AgKyAtMiAqIDE4ICsgN107XG5cdFx0XHR4ciA9IGFbMjldIC0gYVsxXTtcblx0XHRcdGFbMV0gKz0gYVsyOV07XG5cdFx0XHRhWzI5XSA9IHhyICogZW53aW5kb3dbd3AgKyAtMiAqIDE4ICsgN107XG5cblx0XHRcdHhyID0gYVsyNl0gLSBhWzJdO1xuXHRcdFx0YVsyXSArPSBhWzI2XTtcblx0XHRcdGFbMjZdID0geHIgKiBlbndpbmRvd1t3cCArIC00ICogMTggKyA3XTtcblx0XHRcdHhyID0gYVsyN10gLSBhWzNdO1xuXHRcdFx0YVszXSArPSBhWzI3XTtcblx0XHRcdGFbMjddID0geHIgKiBlbndpbmRvd1t3cCArIC00ICogMTggKyA3XTtcblxuXHRcdFx0eHIgPSBhWzI0XSAtIGFbNF07XG5cdFx0XHRhWzRdICs9IGFbMjRdO1xuXHRcdFx0YVsyNF0gPSB4ciAqIGVud2luZG93W3dwICsgLTYgKiAxOCArIDddO1xuXHRcdFx0eHIgPSBhWzI1XSAtIGFbNV07XG5cdFx0XHRhWzVdICs9IGFbMjVdO1xuXHRcdFx0YVsyNV0gPSB4ciAqIGVud2luZG93W3dwICsgLTYgKiAxOCArIDddO1xuXG5cdFx0XHR4ciA9IGFbMjJdIC0gYVs2XTtcblx0XHRcdGFbNl0gKz0gYVsyMl07XG5cdFx0XHRhWzIyXSA9IHhyICogVXRpbC5TUVJUMjtcblx0XHRcdHhyID0gYVsyM10gLSBhWzddO1xuXHRcdFx0YVs3XSArPSBhWzIzXTtcblx0XHRcdGFbMjNdID0geHIgKiBVdGlsLlNRUlQyIC0gYVs3XTtcblx0XHRcdGFbN10gLT0gYVs2XTtcblx0XHRcdGFbMjJdIC09IGFbN107XG5cdFx0XHRhWzIzXSAtPSBhWzIyXTtcblxuXHRcdFx0eHIgPSBhWzZdO1xuXHRcdFx0YVs2XSA9IGFbMzFdIC0geHI7XG5cdFx0XHRhWzMxXSA9IGFbMzFdICsgeHI7XG5cdFx0XHR4ciA9IGFbN107XG5cdFx0XHRhWzddID0gYVszMF0gLSB4cjtcblx0XHRcdGFbMzBdID0gYVszMF0gKyB4cjtcblx0XHRcdHhyID0gYVsyMl07XG5cdFx0XHRhWzIyXSA9IGFbMTVdIC0geHI7XG5cdFx0XHRhWzE1XSA9IGFbMTVdICsgeHI7XG5cdFx0XHR4ciA9IGFbMjNdO1xuXHRcdFx0YVsyM10gPSBhWzE0XSAtIHhyO1xuXHRcdFx0YVsxNF0gPSBhWzE0XSArIHhyO1xuXG5cdFx0XHR4ciA9IGFbMjBdIC0gYVs4XTtcblx0XHRcdGFbOF0gKz0gYVsyMF07XG5cdFx0XHRhWzIwXSA9IHhyICogZW53aW5kb3dbd3AgKyAtMTAgKiAxOCArIDddO1xuXHRcdFx0eHIgPSBhWzIxXSAtIGFbOV07XG5cdFx0XHRhWzldICs9IGFbMjFdO1xuXHRcdFx0YVsyMV0gPSB4ciAqIGVud2luZG93W3dwICsgLTEwICogMTggKyA3XTtcblxuXHRcdFx0eHIgPSBhWzE4XSAtIGFbMTBdO1xuXHRcdFx0YVsxMF0gKz0gYVsxOF07XG5cdFx0XHRhWzE4XSA9IHhyICogZW53aW5kb3dbd3AgKyAtMTIgKiAxOCArIDddO1xuXHRcdFx0eHIgPSBhWzE5XSAtIGFbMTFdO1xuXHRcdFx0YVsxMV0gKz0gYVsxOV07XG5cdFx0XHRhWzE5XSA9IHhyICogZW53aW5kb3dbd3AgKyAtMTIgKiAxOCArIDddO1xuXG5cdFx0XHR4ciA9IGFbMTZdIC0gYVsxMl07XG5cdFx0XHRhWzEyXSArPSBhWzE2XTtcblx0XHRcdGFbMTZdID0geHIgKiBlbndpbmRvd1t3cCArIC0xNCAqIDE4ICsgN107XG5cdFx0XHR4ciA9IGFbMTddIC0gYVsxM107XG5cdFx0XHRhWzEzXSArPSBhWzE3XTtcblx0XHRcdGFbMTddID0geHIgKiBlbndpbmRvd1t3cCArIC0xNCAqIDE4ICsgN107XG5cblx0XHRcdHhyID0gLWFbMjBdICsgYVsyNF07XG5cdFx0XHRhWzIwXSArPSBhWzI0XTtcblx0XHRcdGFbMjRdID0geHIgKiBlbndpbmRvd1t3cCArIC0xMiAqIDE4ICsgN107XG5cdFx0XHR4ciA9IC1hWzIxXSArIGFbMjVdO1xuXHRcdFx0YVsyMV0gKz0gYVsyNV07XG5cdFx0XHRhWzI1XSA9IHhyICogZW53aW5kb3dbd3AgKyAtMTIgKiAxOCArIDddO1xuXG5cdFx0XHR4ciA9IGFbNF0gLSBhWzhdO1xuXHRcdFx0YVs0XSArPSBhWzhdO1xuXHRcdFx0YVs4XSA9IHhyICogZW53aW5kb3dbd3AgKyAtMTIgKiAxOCArIDddO1xuXHRcdFx0eHIgPSBhWzVdIC0gYVs5XTtcblx0XHRcdGFbNV0gKz0gYVs5XTtcblx0XHRcdGFbOV0gPSB4ciAqIGVud2luZG93W3dwICsgLTEyICogMTggKyA3XTtcblxuXHRcdFx0eHIgPSBhWzBdIC0gYVsxMl07XG5cdFx0XHRhWzBdICs9IGFbMTJdO1xuXHRcdFx0YVsxMl0gPSB4ciAqIGVud2luZG93W3dwICsgLTQgKiAxOCArIDddO1xuXHRcdFx0eHIgPSBhWzFdIC0gYVsxM107XG5cdFx0XHRhWzFdICs9IGFbMTNdO1xuXHRcdFx0YVsxM10gPSB4ciAqIGVud2luZG93W3dwICsgLTQgKiAxOCArIDddO1xuXHRcdFx0eHIgPSBhWzE2XSAtIGFbMjhdO1xuXHRcdFx0YVsxNl0gKz0gYVsyOF07XG5cdFx0XHRhWzI4XSA9IHhyICogZW53aW5kb3dbd3AgKyAtNCAqIDE4ICsgN107XG5cdFx0XHR4ciA9IC1hWzE3XSArIGFbMjldO1xuXHRcdFx0YVsxN10gKz0gYVsyOV07XG5cdFx0XHRhWzI5XSA9IHhyICogZW53aW5kb3dbd3AgKyAtNCAqIDE4ICsgN107XG5cblx0XHRcdHhyID0gVXRpbC5TUVJUMiAqIChhWzJdIC0gYVsxMF0pO1xuXHRcdFx0YVsyXSArPSBhWzEwXTtcblx0XHRcdGFbMTBdID0geHI7XG5cdFx0XHR4ciA9IFV0aWwuU1FSVDIgKiAoYVszXSAtIGFbMTFdKTtcblx0XHRcdGFbM10gKz0gYVsxMV07XG5cdFx0XHRhWzExXSA9IHhyO1xuXHRcdFx0eHIgPSBVdGlsLlNRUlQyICogKC1hWzE4XSArIGFbMjZdKTtcblx0XHRcdGFbMThdICs9IGFbMjZdO1xuXHRcdFx0YVsyNl0gPSB4ciAtIGFbMThdO1xuXHRcdFx0eHIgPSBVdGlsLlNRUlQyICogKC1hWzE5XSArIGFbMjddKTtcblx0XHRcdGFbMTldICs9IGFbMjddO1xuXHRcdFx0YVsyN10gPSB4ciAtIGFbMTldO1xuXG5cdFx0XHR4ciA9IGFbMl07XG5cdFx0XHRhWzE5XSAtPSBhWzNdO1xuXHRcdFx0YVszXSAtPSB4cjtcblx0XHRcdGFbMl0gPSBhWzMxXSAtIHhyO1xuXHRcdFx0YVszMV0gKz0geHI7XG5cdFx0XHR4ciA9IGFbM107XG5cdFx0XHRhWzExXSAtPSBhWzE5XTtcblx0XHRcdGFbMThdIC09IHhyO1xuXHRcdFx0YVszXSA9IGFbMzBdIC0geHI7XG5cdFx0XHRhWzMwXSArPSB4cjtcblx0XHRcdHhyID0gYVsxOF07XG5cdFx0XHRhWzI3XSAtPSBhWzExXTtcblx0XHRcdGFbMTldIC09IHhyO1xuXHRcdFx0YVsxOF0gPSBhWzE1XSAtIHhyO1xuXHRcdFx0YVsxNV0gKz0geHI7XG5cblx0XHRcdHhyID0gYVsxOV07XG5cdFx0XHRhWzEwXSAtPSB4cjtcblx0XHRcdGFbMTldID0gYVsxNF0gLSB4cjtcblx0XHRcdGFbMTRdICs9IHhyO1xuXHRcdFx0eHIgPSBhWzEwXTtcblx0XHRcdGFbMTFdIC09IHhyO1xuXHRcdFx0YVsxMF0gPSBhWzIzXSAtIHhyO1xuXHRcdFx0YVsyM10gKz0geHI7XG5cdFx0XHR4ciA9IGFbMTFdO1xuXHRcdFx0YVsyNl0gLT0geHI7XG5cdFx0XHRhWzExXSA9IGFbMjJdIC0geHI7XG5cdFx0XHRhWzIyXSArPSB4cjtcblx0XHRcdHhyID0gYVsyNl07XG5cdFx0XHRhWzI3XSAtPSB4cjtcblx0XHRcdGFbMjZdID0gYVs3XSAtIHhyO1xuXHRcdFx0YVs3XSArPSB4cjtcblxuXHRcdFx0eHIgPSBhWzI3XTtcblx0XHRcdGFbMjddID0gYVs2XSAtIHhyO1xuXHRcdFx0YVs2XSArPSB4cjtcblxuXHRcdFx0eHIgPSBVdGlsLlNRUlQyICogKGFbMF0gLSBhWzRdKTtcblx0XHRcdGFbMF0gKz0gYVs0XTtcblx0XHRcdGFbNF0gPSB4cjtcblx0XHRcdHhyID0gVXRpbC5TUVJUMiAqIChhWzFdIC0gYVs1XSk7XG5cdFx0XHRhWzFdICs9IGFbNV07XG5cdFx0XHRhWzVdID0geHI7XG5cdFx0XHR4ciA9IFV0aWwuU1FSVDIgKiAoYVsxNl0gLSBhWzIwXSk7XG5cdFx0XHRhWzE2XSArPSBhWzIwXTtcblx0XHRcdGFbMjBdID0geHI7XG5cdFx0XHR4ciA9IFV0aWwuU1FSVDIgKiAoYVsxN10gLSBhWzIxXSk7XG5cdFx0XHRhWzE3XSArPSBhWzIxXTtcblx0XHRcdGFbMjFdID0geHI7XG5cblx0XHRcdHhyID0gLVV0aWwuU1FSVDIgKiAoYVs4XSAtIGFbMTJdKTtcblx0XHRcdGFbOF0gKz0gYVsxMl07XG5cdFx0XHRhWzEyXSA9IHhyIC0gYVs4XTtcblx0XHRcdHhyID0gLVV0aWwuU1FSVDIgKiAoYVs5XSAtIGFbMTNdKTtcblx0XHRcdGFbOV0gKz0gYVsxM107XG5cdFx0XHRhWzEzXSA9IHhyIC0gYVs5XTtcblx0XHRcdHhyID0gLVV0aWwuU1FSVDIgKiAoYVsyNV0gLSBhWzI5XSk7XG5cdFx0XHRhWzI1XSArPSBhWzI5XTtcblx0XHRcdGFbMjldID0geHIgLSBhWzI1XTtcblx0XHRcdHhyID0gLVV0aWwuU1FSVDIgKiAoYVsyNF0gKyBhWzI4XSk7XG5cdFx0XHRhWzI0XSAtPSBhWzI4XTtcblx0XHRcdGFbMjhdID0geHIgLSBhWzI0XTtcblxuXHRcdFx0eHIgPSBhWzI0XSAtIGFbMTZdO1xuXHRcdFx0YVsyNF0gPSB4cjtcblx0XHRcdHhyID0gYVsyMF0gLSB4cjtcblx0XHRcdGFbMjBdID0geHI7XG5cdFx0XHR4ciA9IGFbMjhdIC0geHI7XG5cdFx0XHRhWzI4XSA9IHhyO1xuXG5cdFx0XHR4ciA9IGFbMjVdIC0gYVsxN107XG5cdFx0XHRhWzI1XSA9IHhyO1xuXHRcdFx0eHIgPSBhWzIxXSAtIHhyO1xuXHRcdFx0YVsyMV0gPSB4cjtcblx0XHRcdHhyID0gYVsyOV0gLSB4cjtcblx0XHRcdGFbMjldID0geHI7XG5cblx0XHRcdHhyID0gYVsxN10gLSBhWzFdO1xuXHRcdFx0YVsxN10gPSB4cjtcblx0XHRcdHhyID0gYVs5XSAtIHhyO1xuXHRcdFx0YVs5XSA9IHhyO1xuXHRcdFx0eHIgPSBhWzI1XSAtIHhyO1xuXHRcdFx0YVsyNV0gPSB4cjtcblx0XHRcdHhyID0gYVs1XSAtIHhyO1xuXHRcdFx0YVs1XSA9IHhyO1xuXHRcdFx0eHIgPSBhWzIxXSAtIHhyO1xuXHRcdFx0YVsyMV0gPSB4cjtcblx0XHRcdHhyID0gYVsxM10gLSB4cjtcblx0XHRcdGFbMTNdID0geHI7XG5cdFx0XHR4ciA9IGFbMjldIC0geHI7XG5cdFx0XHRhWzI5XSA9IHhyO1xuXG5cdFx0XHR4ciA9IGFbMV0gLSBhWzBdO1xuXHRcdFx0YVsxXSA9IHhyO1xuXHRcdFx0eHIgPSBhWzE2XSAtIHhyO1xuXHRcdFx0YVsxNl0gPSB4cjtcblx0XHRcdHhyID0gYVsxN10gLSB4cjtcblx0XHRcdGFbMTddID0geHI7XG5cdFx0XHR4ciA9IGFbOF0gLSB4cjtcblx0XHRcdGFbOF0gPSB4cjtcblx0XHRcdHhyID0gYVs5XSAtIHhyO1xuXHRcdFx0YVs5XSA9IHhyO1xuXHRcdFx0eHIgPSBhWzI0XSAtIHhyO1xuXHRcdFx0YVsyNF0gPSB4cjtcblx0XHRcdHhyID0gYVsyNV0gLSB4cjtcblx0XHRcdGFbMjVdID0geHI7XG5cdFx0XHR4ciA9IGFbNF0gLSB4cjtcblx0XHRcdGFbNF0gPSB4cjtcblx0XHRcdHhyID0gYVs1XSAtIHhyO1xuXHRcdFx0YVs1XSA9IHhyO1xuXHRcdFx0eHIgPSBhWzIwXSAtIHhyO1xuXHRcdFx0YVsyMF0gPSB4cjtcblx0XHRcdHhyID0gYVsyMV0gLSB4cjtcblx0XHRcdGFbMjFdID0geHI7XG5cdFx0XHR4ciA9IGFbMTJdIC0geHI7XG5cdFx0XHRhWzEyXSA9IHhyO1xuXHRcdFx0eHIgPSBhWzEzXSAtIHhyO1xuXHRcdFx0YVsxM10gPSB4cjtcblx0XHRcdHhyID0gYVsyOF0gLSB4cjtcblx0XHRcdGFbMjhdID0geHI7XG5cdFx0XHR4ciA9IGFbMjldIC0geHI7XG5cdFx0XHRhWzI5XSA9IHhyO1xuXG5cdFx0XHR4ciA9IGFbMF07XG5cdFx0XHRhWzBdICs9IGFbMzFdO1xuXHRcdFx0YVszMV0gLT0geHI7XG5cdFx0XHR4ciA9IGFbMV07XG5cdFx0XHRhWzFdICs9IGFbMzBdO1xuXHRcdFx0YVszMF0gLT0geHI7XG5cdFx0XHR4ciA9IGFbMTZdO1xuXHRcdFx0YVsxNl0gKz0gYVsxNV07XG5cdFx0XHRhWzE1XSAtPSB4cjtcblx0XHRcdHhyID0gYVsxN107XG5cdFx0XHRhWzE3XSArPSBhWzE0XTtcblx0XHRcdGFbMTRdIC09IHhyO1xuXHRcdFx0eHIgPSBhWzhdO1xuXHRcdFx0YVs4XSArPSBhWzIzXTtcblx0XHRcdGFbMjNdIC09IHhyO1xuXHRcdFx0eHIgPSBhWzldO1xuXHRcdFx0YVs5XSArPSBhWzIyXTtcblx0XHRcdGFbMjJdIC09IHhyO1xuXHRcdFx0eHIgPSBhWzI0XTtcblx0XHRcdGFbMjRdICs9IGFbN107XG5cdFx0XHRhWzddIC09IHhyO1xuXHRcdFx0eHIgPSBhWzI1XTtcblx0XHRcdGFbMjVdICs9IGFbNl07XG5cdFx0XHRhWzZdIC09IHhyO1xuXHRcdFx0eHIgPSBhWzRdO1xuXHRcdFx0YVs0XSArPSBhWzI3XTtcblx0XHRcdGFbMjddIC09IHhyO1xuXHRcdFx0eHIgPSBhWzVdO1xuXHRcdFx0YVs1XSArPSBhWzI2XTtcblx0XHRcdGFbMjZdIC09IHhyO1xuXHRcdFx0eHIgPSBhWzIwXTtcblx0XHRcdGFbMjBdICs9IGFbMTFdO1xuXHRcdFx0YVsxMV0gLT0geHI7XG5cdFx0XHR4ciA9IGFbMjFdO1xuXHRcdFx0YVsyMV0gKz0gYVsxMF07XG5cdFx0XHRhWzEwXSAtPSB4cjtcblx0XHRcdHhyID0gYVsxMl07XG5cdFx0XHRhWzEyXSArPSBhWzE5XTtcblx0XHRcdGFbMTldIC09IHhyO1xuXHRcdFx0eHIgPSBhWzEzXTtcblx0XHRcdGFbMTNdICs9IGFbMThdO1xuXHRcdFx0YVsxOF0gLT0geHI7XG5cdFx0XHR4ciA9IGFbMjhdO1xuXHRcdFx0YVsyOF0gKz0gYVszXTtcblx0XHRcdGFbM10gLT0geHI7XG5cdFx0XHR4ciA9IGFbMjldO1xuXHRcdFx0YVsyOV0gKz0gYVsyXTtcblx0XHRcdGFbMl0gLT0geHI7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEZ1bmN0aW9uOiBDYWxjdWxhdGlvbiBvZiB0aGUgTURDVCBJbiB0aGUgY2FzZSBvZiBsb25nIGJsb2NrcyAodHlwZSAwLDEsMylcblx0ICogdGhlcmUgYXJlIDM2IGNvZWZmaWNlbnRzIGluIHRoZSB0aW1lIGRvbWFpbiBhbmQgMTggaW4gdGhlIGZyZXF1ZW5jeVxuXHQgKiBkb21haW4uPEJSPlxuXHQgKiBJbiB0aGUgY2FzZSBvZiBzaG9ydCBibG9ja3MgKHR5cGUgMikgdGhlcmUgYXJlIDMgdHJhbnNmb3JtYXRpb25zIHdpdGhcblx0ICogc2hvcnQgbGVuZ3RoLiBUaGlzIGxlYWRzIHRvIDEyIGNvZWZmaWNlbnRzIGluIHRoZSB0aW1lIGFuZCA2IGluIHRoZVxuXHQgKiBmcmVxdWVuY3kgZG9tYWluLiBJbiB0aGlzIGNhc2UgdGhlIHJlc3VsdHMgYXJlIHN0b3JlZCBzaWRlIGJ5IHNpZGUgaW4gdGhlXG5cdCAqIHZlY3RvciBvdXRbXS5cblx0ICpcblx0ICogTmV3IGxheWVyM1xuXHQgKi9cblx0ZnVuY3Rpb24gbWRjdF9zaG9ydChpbm91dCwgaW5vdXRQb3MpIHtcblx0XHRmb3IgKHZhciBsID0gMDsgbCA8IDM7IGwrKykge1xuXHRcdFx0dmFyIHRjMCwgdGMxLCB0YzIsIHRzMCwgdHMxLCB0czI7XG5cblx0XHRcdHRzMCA9IGlub3V0W2lub3V0UG9zICsgMiAqIDNdICogd2luW0VuY29kZXIuU0hPUlRfVFlQRV1bMF1cblx0XHRcdFx0XHQtIGlub3V0W2lub3V0UG9zICsgNSAqIDNdO1xuXHRcdFx0dGMwID0gaW5vdXRbaW5vdXRQb3MgKyAwICogM10gKiB3aW5bRW5jb2Rlci5TSE9SVF9UWVBFXVsyXVxuXHRcdFx0XHRcdC0gaW5vdXRbaW5vdXRQb3MgKyAzICogM107XG5cdFx0XHR0YzEgPSB0czAgKyB0YzA7XG5cdFx0XHR0YzIgPSB0czAgLSB0YzA7XG5cblx0XHRcdHRzMCA9IGlub3V0W2lub3V0UG9zICsgNSAqIDNdICogd2luW0VuY29kZXIuU0hPUlRfVFlQRV1bMF1cblx0XHRcdFx0XHQrIGlub3V0W2lub3V0UG9zICsgMiAqIDNdO1xuXHRcdFx0dGMwID0gaW5vdXRbaW5vdXRQb3MgKyAzICogM10gKiB3aW5bRW5jb2Rlci5TSE9SVF9UWVBFXVsyXVxuXHRcdFx0XHRcdCsgaW5vdXRbaW5vdXRQb3MgKyAwICogM107XG5cdFx0XHR0czEgPSB0czAgKyB0YzA7XG5cdFx0XHR0czIgPSAtdHMwICsgdGMwO1xuXG5cdFx0XHR0YzAgPSAoaW5vdXRbaW5vdXRQb3MgKyAxICogM10gKiB3aW5bRW5jb2Rlci5TSE9SVF9UWVBFXVsxXSAtIGlub3V0W2lub3V0UG9zICsgNCAqIDNdKSAqIDIuMDY5OTc4MTExOTUzMDg5ZS0xMTtcblx0XHRcdC8qXG5cdFx0XHQgKiB0cml0YWJfcyBbIDEgXVxuXHRcdFx0ICovXG5cdFx0XHR0czAgPSAoaW5vdXRbaW5vdXRQb3MgKyA0ICogM10gKiB3aW5bRW5jb2Rlci5TSE9SVF9UWVBFXVsxXSArIGlub3V0W2lub3V0UG9zICsgMSAqIDNdKSAqIDIuMDY5OTc4MTExOTUzMDg5ZS0xMTtcblx0XHRcdC8qXG5cdFx0XHQgKiB0cml0YWJfcyBbIDEgXVxuXHRcdFx0ICovXG5cdFx0XHRpbm91dFtpbm91dFBvcyArIDMgKiAwXSA9IHRjMSAqIDEuOTA3NTI1MTkxNzM3MjgwZS0xMSArIHRjMDtcblx0XHRcdC8qXG5cdFx0XHQgKiB0cml0YWJfc1sgMiBdXG5cdFx0XHQgKi9cblx0XHRcdGlub3V0W2lub3V0UG9zICsgMyAqIDVdID0gLXRzMSAqIDEuOTA3NTI1MTkxNzM3MjgwZS0xMSArIHRzMDtcblx0XHRcdC8qXG5cdFx0XHQgKiB0cml0YWJfc1swIF1cblx0XHRcdCAqL1xuXHRcdFx0dGMyID0gdGMyICogMC44NjYwMjU0MDM3ODQ0Mzg3MDc2MSAqIDEuOTA3NTI1MTkxNzM3MjgxZS0xMTtcblx0XHRcdC8qXG5cdFx0XHQgKiB0cml0YWJfc1sgMl1cblx0XHRcdCAqL1xuXHRcdFx0dHMxID0gdHMxICogMC41ICogMS45MDc1MjUxOTE3MzcyODFlLTExICsgdHMwO1xuXHRcdFx0aW5vdXRbaW5vdXRQb3MgKyAzICogMV0gPSB0YzIgLSB0czE7XG5cdFx0XHRpbm91dFtpbm91dFBvcyArIDMgKiAyXSA9IHRjMiArIHRzMTtcblxuXHRcdFx0dGMxID0gdGMxICogMC41ICogMS45MDc1MjUxOTE3MzcyODFlLTExIC0gdGMwO1xuXHRcdFx0dHMyID0gdHMyICogMC44NjYwMjU0MDM3ODQ0Mzg3MDc2MSAqIDEuOTA3NTI1MTkxNzM3MjgxZS0xMTtcblx0XHRcdC8qXG5cdFx0XHQgKiB0cml0YWJfc1sgMF1cblx0XHRcdCAqL1xuXHRcdFx0aW5vdXRbaW5vdXRQb3MgKyAzICogM10gPSB0YzEgKyB0czI7XG5cdFx0XHRpbm91dFtpbm91dFBvcyArIDMgKiA0XSA9IHRjMSAtIHRzMjtcblxuXHRcdFx0aW5vdXRQb3MrKztcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBtZGN0X2xvbmcob3V0LCBvdXRQb3MsIF9pbikge1xuXHRcdHZhciBjdCwgc3Q7XG5cdFx0e1xuXHRcdFx0dmFyIHRjMSwgdGMyLCB0YzMsIHRjNCwgdHM1LCB0czYsIHRzNywgdHM4O1xuXHRcdFx0LyogMSwyLCA1LDYsIDksMTAsIDEzLDE0LCAxNyAqL1xuXHRcdFx0dGMxID0gX2luWzE3XSAtIF9pbls5XTtcblx0XHRcdHRjMyA9IF9pblsxNV0gLSBfaW5bMTFdO1xuXHRcdFx0dGM0ID0gX2luWzE0XSAtIF9pblsxMl07XG5cdFx0XHR0czUgPSBfaW5bMF0gKyBfaW5bOF07XG5cdFx0XHR0czYgPSBfaW5bMV0gKyBfaW5bN107XG5cdFx0XHR0czcgPSBfaW5bMl0gKyBfaW5bNl07XG5cdFx0XHR0czggPSBfaW5bM10gKyBfaW5bNV07XG5cblx0XHRcdG91dFtvdXRQb3MgKyAxN10gPSAodHM1ICsgdHM3IC0gdHM4KSAtICh0czYgLSBfaW5bNF0pO1xuXHRcdFx0c3QgPSAodHM1ICsgdHM3IC0gdHM4KSAqIGN4WzEyICsgN10gKyAodHM2IC0gX2luWzRdKTtcblx0XHRcdGN0ID0gKHRjMSAtIHRjMyAtIHRjNCkgKiBjeFsxMiArIDZdO1xuXHRcdFx0b3V0W291dFBvcyArIDVdID0gY3QgKyBzdDtcblx0XHRcdG91dFtvdXRQb3MgKyA2XSA9IGN0IC0gc3Q7XG5cblx0XHRcdHRjMiA9IChfaW5bMTZdIC0gX2luWzEwXSkgKiBjeFsxMiArIDZdO1xuXHRcdFx0dHM2ID0gdHM2ICogY3hbMTIgKyA3XSArIF9pbls0XTtcblx0XHRcdGN0ID0gdGMxICogY3hbMTIgKyAwXSArIHRjMiArIHRjMyAqIGN4WzEyICsgMV0gKyB0YzQgKiBjeFsxMiArIDJdO1xuXHRcdFx0c3QgPSAtdHM1ICogY3hbMTIgKyA0XSArIHRzNiAtIHRzNyAqIGN4WzEyICsgNV0gKyB0czggKiBjeFsxMiArIDNdO1xuXHRcdFx0b3V0W291dFBvcyArIDFdID0gY3QgKyBzdDtcblx0XHRcdG91dFtvdXRQb3MgKyAyXSA9IGN0IC0gc3Q7XG5cblx0XHRcdGN0ID0gdGMxICogY3hbMTIgKyAxXSAtIHRjMiAtIHRjMyAqIGN4WzEyICsgMl0gKyB0YzQgKiBjeFsxMiArIDBdO1xuXHRcdFx0c3QgPSAtdHM1ICogY3hbMTIgKyA1XSArIHRzNiAtIHRzNyAqIGN4WzEyICsgM10gKyB0czggKiBjeFsxMiArIDRdO1xuXHRcdFx0b3V0W291dFBvcyArIDldID0gY3QgKyBzdDtcblx0XHRcdG91dFtvdXRQb3MgKyAxMF0gPSBjdCAtIHN0O1xuXG5cdFx0XHRjdCA9IHRjMSAqIGN4WzEyICsgMl0gLSB0YzIgKyB0YzMgKiBjeFsxMiArIDBdIC0gdGM0ICogY3hbMTIgKyAxXTtcblx0XHRcdHN0ID0gdHM1ICogY3hbMTIgKyAzXSAtIHRzNiArIHRzNyAqIGN4WzEyICsgNF0gLSB0czggKiBjeFsxMiArIDVdO1xuXHRcdFx0b3V0W291dFBvcyArIDEzXSA9IGN0ICsgc3Q7XG5cdFx0XHRvdXRbb3V0UG9zICsgMTRdID0gY3QgLSBzdDtcblx0XHR9XG5cdFx0e1xuXHRcdFx0dmFyIHRzMSwgdHMyLCB0czMsIHRzNCwgdGM1LCB0YzYsIHRjNywgdGM4O1xuXG5cdFx0XHR0czEgPSBfaW5bOF0gLSBfaW5bMF07XG5cdFx0XHR0czMgPSBfaW5bNl0gLSBfaW5bMl07XG5cdFx0XHR0czQgPSBfaW5bNV0gLSBfaW5bM107XG5cdFx0XHR0YzUgPSBfaW5bMTddICsgX2luWzldO1xuXHRcdFx0dGM2ID0gX2luWzE2XSArIF9pblsxMF07XG5cdFx0XHR0YzcgPSBfaW5bMTVdICsgX2luWzExXTtcblx0XHRcdHRjOCA9IF9pblsxNF0gKyBfaW5bMTJdO1xuXG5cdFx0XHRvdXRbb3V0UG9zICsgMF0gPSAodGM1ICsgdGM3ICsgdGM4KSArICh0YzYgKyBfaW5bMTNdKTtcblx0XHRcdGN0ID0gKHRjNSArIHRjNyArIHRjOCkgKiBjeFsxMiArIDddIC0gKHRjNiArIF9pblsxM10pO1xuXHRcdFx0c3QgPSAodHMxIC0gdHMzICsgdHM0KSAqIGN4WzEyICsgNl07XG5cdFx0XHRvdXRbb3V0UG9zICsgMTFdID0gY3QgKyBzdDtcblx0XHRcdG91dFtvdXRQb3MgKyAxMl0gPSBjdCAtIHN0O1xuXG5cdFx0XHR0czIgPSAoX2luWzddIC0gX2luWzFdKSAqIGN4WzEyICsgNl07XG5cdFx0XHR0YzYgPSBfaW5bMTNdIC0gdGM2ICogY3hbMTIgKyA3XTtcblx0XHRcdGN0ID0gdGM1ICogY3hbMTIgKyAzXSAtIHRjNiArIHRjNyAqIGN4WzEyICsgNF0gKyB0YzggKiBjeFsxMiArIDVdO1xuXHRcdFx0c3QgPSB0czEgKiBjeFsxMiArIDJdICsgdHMyICsgdHMzICogY3hbMTIgKyAwXSArIHRzNCAqIGN4WzEyICsgMV07XG5cdFx0XHRvdXRbb3V0UG9zICsgM10gPSBjdCArIHN0O1xuXHRcdFx0b3V0W291dFBvcyArIDRdID0gY3QgLSBzdDtcblxuXHRcdFx0Y3QgPSAtdGM1ICogY3hbMTIgKyA1XSArIHRjNiAtIHRjNyAqIGN4WzEyICsgM10gLSB0YzggKiBjeFsxMiArIDRdO1xuXHRcdFx0c3QgPSB0czEgKiBjeFsxMiArIDFdICsgdHMyIC0gdHMzICogY3hbMTIgKyAyXSAtIHRzNCAqIGN4WzEyICsgMF07XG5cdFx0XHRvdXRbb3V0UG9zICsgN10gPSBjdCArIHN0O1xuXHRcdFx0b3V0W291dFBvcyArIDhdID0gY3QgLSBzdDtcblxuXHRcdFx0Y3QgPSAtdGM1ICogY3hbMTIgKyA0XSArIHRjNiAtIHRjNyAqIGN4WzEyICsgNV0gLSB0YzggKiBjeFsxMiArIDNdO1xuXHRcdFx0c3QgPSB0czEgKiBjeFsxMiArIDBdIC0gdHMyICsgdHMzICogY3hbMTIgKyAxXSAtIHRzNCAqIGN4WzEyICsgMl07XG5cdFx0XHRvdXRbb3V0UG9zICsgMTVdID0gY3QgKyBzdDtcblx0XHRcdG91dFtvdXRQb3MgKyAxNl0gPSBjdCAtIHN0O1xuXHRcdH1cblx0fVxuXG5cdHRoaXMubWRjdF9zdWI0OCA9IGZ1bmN0aW9uKGdmYywgdzAsIHcxKSB7XG5cdFx0dmFyIHdrID0gdzA7XG5cdFx0dmFyIHdrUG9zID0gMjg2O1xuXHRcdC8qIHRoaW5raW5nIGNhY2hlIHBlcmZvcm1hbmNlLCBjaC0+Z3IgbG9vcCBpcyBiZXR0ZXIgdGhhbiBnci0+Y2ggbG9vcCAqL1xuXHRcdGZvciAodmFyIGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG5cdFx0XHRmb3IgKHZhciBnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcblx0XHRcdFx0dmFyIGJhbmQ7XG5cdFx0XHRcdHZhciBnaSA9IChnZmMubDNfc2lkZS50dFtncl1bY2hdKTtcblx0XHRcdFx0dmFyIG1kY3RfZW5jID0gZ2kueHI7XG5cdFx0XHRcdHZhciBtZGN0X2VuY1BvcyA9IDA7XG5cdFx0XHRcdHZhciBzYW1wID0gZ2ZjLnNiX3NhbXBsZVtjaF1bMSAtIGdyXTtcblx0XHRcdFx0dmFyIHNhbXBQb3MgPSAwO1xuXG5cdFx0XHRcdGZvciAodmFyIGsgPSAwOyBrIDwgMTggLyAyOyBrKyspIHtcblx0XHRcdFx0XHR3aW5kb3dfc3ViYmFuZCh3aywgd2tQb3MsIHNhbXBbc2FtcFBvc10pO1xuXHRcdFx0XHRcdHdpbmRvd19zdWJiYW5kKHdrLCB3a1BvcyArIDMyLCBzYW1wW3NhbXBQb3MgKyAxXSk7XG5cdFx0XHRcdFx0c2FtcFBvcyArPSAyO1xuXHRcdFx0XHRcdHdrUG9zICs9IDY0O1xuXHRcdFx0XHRcdC8qXG5cdFx0XHRcdFx0ICogQ29tcGVuc2F0ZSBmb3IgaW52ZXJzaW9uIGluIHRoZSBhbmFseXNpcyBmaWx0ZXJcblx0XHRcdFx0XHQgKi9cblx0XHRcdFx0XHRmb3IgKGJhbmQgPSAxOyBiYW5kIDwgMzI7IGJhbmQgKz0gMikge1xuXHRcdFx0XHRcdFx0c2FtcFtzYW1wUG9zIC0gMV1bYmFuZF0gKj0gLTE7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Lypcblx0XHRcdFx0ICogUGVyZm9ybSBpbWRjdCBvZiAxOCBwcmV2aW91cyBzdWJiYW5kIHNhbXBsZXMgKyAxOCBjdXJyZW50XG5cdFx0XHRcdCAqIHN1YmJhbmQgc2FtcGxlc1xuXHRcdFx0XHQgKi9cblx0XHRcdFx0Zm9yIChiYW5kID0gMDsgYmFuZCA8IDMyOyBiYW5kKyssIG1kY3RfZW5jUG9zICs9IDE4KSB7XG5cdFx0XHRcdFx0dmFyIHR5cGUgPSBnaS5ibG9ja190eXBlO1xuXHRcdFx0XHRcdHZhciBiYW5kMCA9IGdmYy5zYl9zYW1wbGVbY2hdW2dyXTtcblx0XHRcdFx0XHR2YXIgYmFuZDEgPSBnZmMuc2Jfc2FtcGxlW2NoXVsxIC0gZ3JdO1xuXHRcdFx0XHRcdGlmIChnaS5taXhlZF9ibG9ja19mbGFnICE9IDAgJiYgYmFuZCA8IDIpXG5cdFx0XHRcdFx0XHR0eXBlID0gMDtcblx0XHRcdFx0XHRpZiAoZ2ZjLmFtcF9maWx0ZXJbYmFuZF0gPCAxZS0xMikge1xuXHRcdFx0XHRcdFx0QXJyYXlzLmZpbGwobWRjdF9lbmMsIG1kY3RfZW5jUG9zICsgMCxcblx0XHRcdFx0XHRcdFx0XHRtZGN0X2VuY1BvcyArIDE4LCAwKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0aWYgKGdmYy5hbXBfZmlsdGVyW2JhbmRdIDwgMS4wKSB7XG5cdFx0XHRcdFx0XHRcdGZvciAodmFyIGsgPSAwOyBrIDwgMTg7IGsrKylcblx0XHRcdFx0XHRcdFx0XHRiYW5kMVtrXVtvcmRlcltiYW5kXV0gKj0gZ2ZjLmFtcF9maWx0ZXJbYmFuZF07XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpZiAodHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcblx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgayA9IC1OUyAvIDQ7IGsgPCAwOyBrKyspIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgdyA9IHdpbltFbmNvZGVyLlNIT1JUX1RZUEVdW2sgKyAzXTtcblx0XHRcdFx0XHRcdFx0XHRtZGN0X2VuY1ttZGN0X2VuY1BvcyArIGsgKiAzICsgOV0gPSBiYW5kMFs5ICsga11bb3JkZXJbYmFuZF1dXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCogdyAtIGJhbmQwWzggLSBrXVtvcmRlcltiYW5kXV07XG5cdFx0XHRcdFx0XHRcdFx0bWRjdF9lbmNbbWRjdF9lbmNQb3MgKyBrICogMyArIDE4XSA9IGJhbmQwWzE0IC0ga11bb3JkZXJbYmFuZF1dXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCogdyArIGJhbmQwWzE1ICsga11bb3JkZXJbYmFuZF1dO1xuXHRcdFx0XHRcdFx0XHRcdG1kY3RfZW5jW21kY3RfZW5jUG9zICsgayAqIDMgKyAxMF0gPSBiYW5kMFsxNSArIGtdW29yZGVyW2JhbmRdXVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQqIHcgLSBiYW5kMFsxNCAtIGtdW29yZGVyW2JhbmRdXTtcblx0XHRcdFx0XHRcdFx0XHRtZGN0X2VuY1ttZGN0X2VuY1BvcyArIGsgKiAzICsgMTldID0gYmFuZDFbMiAtIGtdW29yZGVyW2JhbmRdXVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQqIHcgKyBiYW5kMVszICsga11bb3JkZXJbYmFuZF1dO1xuXHRcdFx0XHRcdFx0XHRcdG1kY3RfZW5jW21kY3RfZW5jUG9zICsgayAqIDMgKyAxMV0gPSBiYW5kMVszICsga11bb3JkZXJbYmFuZF1dXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCogdyAtIGJhbmQxWzIgLSBrXVtvcmRlcltiYW5kXV07XG5cdFx0XHRcdFx0XHRcdFx0bWRjdF9lbmNbbWRjdF9lbmNQb3MgKyBrICogMyArIDIwXSA9IGJhbmQxWzggLSBrXVtvcmRlcltiYW5kXV1cblx0XHRcdFx0XHRcdFx0XHRcdFx0KiB3ICsgYmFuZDFbOSArIGtdW29yZGVyW2JhbmRdXTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRtZGN0X3Nob3J0KG1kY3RfZW5jLCBtZGN0X2VuY1Bvcyk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHR2YXIgd29yayA9IG5ld19mbG9hdCgxOCk7XG5cdFx0XHRcdFx0XHRcdGZvciAodmFyIGsgPSAtTkwgLyA0OyBrIDwgMDsgaysrKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGEsIGI7XG5cdFx0XHRcdFx0XHRcdFx0YSA9IHdpblt0eXBlXVtrICsgMjddXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCogYmFuZDFbayArIDldW29yZGVyW2JhbmRdXVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQrIHdpblt0eXBlXVtrICsgMzZdXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCogYmFuZDFbOCAtIGtdW29yZGVyW2JhbmRdXTtcblx0XHRcdFx0XHRcdFx0XHRiID0gd2luW3R5cGVdW2sgKyA5XVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQqIGJhbmQwW2sgKyA5XVtvcmRlcltiYW5kXV1cblx0XHRcdFx0XHRcdFx0XHRcdFx0LSB3aW5bdHlwZV1bayArIDE4XVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQqIGJhbmQwWzggLSBrXVtvcmRlcltiYW5kXV07XG5cdFx0XHRcdFx0XHRcdFx0d29ya1trICsgOV0gPSBhIC0gYiAqIHRhbnRhYl9sWzMgKyBrICsgOV07XG5cdFx0XHRcdFx0XHRcdFx0d29ya1trICsgMThdID0gYSAqIHRhbnRhYl9sWzMgKyBrICsgOV0gKyBiO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0bWRjdF9sb25nKG1kY3RfZW5jLCBtZGN0X2VuY1Bvcywgd29yayk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdC8qXG5cdFx0XHRcdFx0ICogUGVyZm9ybSBhbGlhc2luZyByZWR1Y3Rpb24gYnV0dGVyZmx5XG5cdFx0XHRcdFx0ICovXG5cdFx0XHRcdFx0aWYgKHR5cGUgIT0gRW5jb2Rlci5TSE9SVF9UWVBFICYmIGJhbmQgIT0gMCkge1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgayA9IDc7IGsgPj0gMDsgLS1rKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBidSwgYmQ7XG5cdFx0XHRcdFx0XHRcdGJ1ID0gbWRjdF9lbmNbbWRjdF9lbmNQb3MgKyBrXSAqIGNhWzIwICsga11cblx0XHRcdFx0XHRcdFx0XHRcdCsgbWRjdF9lbmNbbWRjdF9lbmNQb3MgKyAtMSAtIGtdXG5cdFx0XHRcdFx0XHRcdFx0XHQqIGNzWzI4ICsga107XG5cdFx0XHRcdFx0XHRcdGJkID0gbWRjdF9lbmNbbWRjdF9lbmNQb3MgKyBrXSAqIGNzWzI4ICsga11cblx0XHRcdFx0XHRcdFx0XHRcdC0gbWRjdF9lbmNbbWRjdF9lbmNQb3MgKyAtMSAtIGtdXG5cdFx0XHRcdFx0XHRcdFx0XHQqIGNhWzIwICsga107XG5cblx0XHRcdFx0XHRcdFx0bWRjdF9lbmNbbWRjdF9lbmNQb3MgKyAtMSAtIGtdID0gYnU7XG5cdFx0XHRcdFx0XHRcdG1kY3RfZW5jW21kY3RfZW5jUG9zICsga10gPSBiZDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHdrID0gdzE7XG5cdFx0XHR3a1BvcyA9IDI4Njtcblx0XHRcdGlmIChnZmMubW9kZV9nciA9PSAxKSB7XG5cdFx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgMTg7IGkrKykge1xuXHRcdFx0XHRcdFN5c3RlbS5hcnJheWNvcHkoZ2ZjLnNiX3NhbXBsZVtjaF1bMV1baV0sIDAsXG5cdFx0XHRcdFx0XHRcdGdmYy5zYl9zYW1wbGVbY2hdWzBdW2ldLCAwLCAzMik7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cbn1cblxuLy9wYWNrYWdlIG1wMztcblxuXG5mdW5jdGlvbiBJSUlfcHN5X3JhdGlvKCkge1xuXHR0aGlzLnRobSA9IG5ldyBJSUlfcHN5X3htaW4oKTtcblx0dGhpcy5lbiA9IG5ldyBJSUlfcHN5X3htaW4oKTtcbn1cblxuXG4vKipcbiAqIEVOQ0RFTEFZIFRoZSBlbmNvZGVyIGRlbGF5LlxuICpcbiAqIE1pbmltdW0gYWxsb3dlZCBpcyBNRENUREVMQVkgKHNlZSBiZWxvdylcbiAqXG4gKiBUaGUgZmlyc3QgOTYgc2FtcGxlcyB3aWxsIGJlIGF0dGVudWF0ZWQsIHNvIHVzaW5nIGEgdmFsdWUgbGVzcyB0aGFuIDk2XG4gKiB3aWxsIHJlc3VsdCBpbiBjb3JydXB0IGRhdGEgZm9yIHRoZSBmaXJzdCA5Ni1FTkNERUxBWSBzYW1wbGVzLlxuICpcbiAqIHN1Z2dlc3RlZDogNTc2IHNldCB0byAxMTYwIHRvIHN5bmMgd2l0aCBGaEcuXG4gKi9cbkVuY29kZXIuRU5DREVMQVkgPSA1NzY7XG4vKipcbiAqIG1ha2Ugc3VyZSB0aGVyZSBpcyBhdCBsZWFzdCBvbmUgY29tcGxldGUgZnJhbWUgYWZ0ZXIgdGhlIGxhc3QgZnJhbWVcbiAqIGNvbnRhaW5pbmcgcmVhbCBkYXRhXG4gKlxuICogVXNpbmcgYSB2YWx1ZSBvZiAyODggd291bGQgYmUgc3VmZmljaWVudCBmb3IgYSBhIHZlcnkgc29waGlzdGljYXRlZFxuICogZGVjb2RlciB0aGF0IGNhbiBkZWNvZGUgZ3JhbnVsZS1ieS1ncmFudWxlIGluc3RlYWQgb2YgZnJhbWUgYnkgZnJhbWUuIEJ1dFxuICogbGV0cyBub3QgYXNzdW1lIHRoaXMsIGFuZCBhc3N1bWUgdGhlIGRlY29kZXIgd2lsbCBub3QgZGVjb2RlIGZyYW1lIE5cbiAqIHVubGVzcyBpdCBhbHNvIGhhcyBkYXRhIGZvciBmcmFtZSBOKzFcbiAqL1xuRW5jb2Rlci5QT1NUREVMQVkgPSAxMTUyO1xuXG4vKipcbiAqIGRlbGF5IG9mIHRoZSBNRENUIHVzZWQgaW4gbWRjdC5jIG9yaWdpbmFsIElTTyByb3V0aW5lcyBoYWQgYSBkZWxheSBvZlxuICogNTI4ISBUYWtlaGlybydzIHJvdXRpbmVzOlxuICovXG5FbmNvZGVyLk1EQ1RERUxBWSA9IDQ4O1xuRW5jb2Rlci5GRlRPRkZTRVQgPSAoMjI0ICsgRW5jb2Rlci5NRENUREVMQVkpO1xuXG4vKipcbiAqIE1vc3QgZGVjb2RlcnMsIGluY2x1ZGluZyB0aGUgb25lIHdlIHVzZSwgaGF2ZSBhIGRlbGF5IG9mIDUyOCBzYW1wbGVzLlxuICovXG5FbmNvZGVyLkRFQ0RFTEFZID0gNTI4O1xuXG4vKipcbiAqIG51bWJlciBvZiBzdWJiYW5kc1xuICovXG5FbmNvZGVyLlNCTElNSVQgPSAzMjtcblxuLyoqXG4gKiBwYXJpdGlvbiBiYW5kcyBiYW5kc1xuICovXG5FbmNvZGVyLkNCQU5EUyA9IDY0O1xuXG4vKipcbiAqIG51bWJlciBvZiBjcml0aWNhbCBiYW5kcy9zY2FsZSBmYWN0b3IgYmFuZHMgd2hlcmUgbWFza2luZyBpcyBjb21wdXRlZFxuICovXG5FbmNvZGVyLlNCUFNZX2wgPSAyMTtcbkVuY29kZXIuU0JQU1lfcyA9IDEyO1xuXG4vKipcbiAqIHRvdGFsIG51bWJlciBvZiBzY2FsZWZhY3RvciBiYW5kcyBlbmNvZGVkXG4gKi9cbkVuY29kZXIuU0JNQVhfbCA9IDIyO1xuRW5jb2Rlci5TQk1BWF9zID0gMTM7XG5FbmNvZGVyLlBTRkIyMSA9IDY7XG5FbmNvZGVyLlBTRkIxMiA9IDY7XG5cbi8qKlxuICogRkZUIHNpemVzXG4gKi9cbkVuY29kZXIuQkxLU0laRSA9IDEwMjQ7XG5FbmNvZGVyLkhCTEtTSVpFID0gKEVuY29kZXIuQkxLU0laRSAvIDIgKyAxKTtcbkVuY29kZXIuQkxLU0laRV9zID0gMjU2O1xuRW5jb2Rlci5IQkxLU0laRV9zID0gKEVuY29kZXIuQkxLU0laRV9zIC8gMiArIDEpO1xuXG5FbmNvZGVyLk5PUk1fVFlQRSA9IDA7XG5FbmNvZGVyLlNUQVJUX1RZUEUgPSAxO1xuRW5jb2Rlci5TSE9SVF9UWVBFID0gMjtcbkVuY29kZXIuU1RPUF9UWVBFID0gMztcblxuLyoqXG4gKiA8UFJFPlxuICogTW9kZSBFeHRlbnRpb246XG4gKiBXaGVuIHdlIGFyZSBpbiBzdGVyZW8gbW9kZSwgdGhlcmUgYXJlIDQgcG9zc2libGUgbWV0aG9kcyB0byBzdG9yZSB0aGVzZVxuICogdHdvIGNoYW5uZWxzLiBUaGUgc3RlcmVvIG1vZGVzIC1tPyBhcmUgdXNpbmcgYSBzdWJzZXQgb2YgdGhlbS5cbiAqXG4gKiAgLW1zOiBNUEdfTURfTFJfTFJcbiAqICAtbWo6IE1QR19NRF9MUl9MUiBhbmQgTVBHX01EX01TX0xSXG4gKiAgLW1mOiBNUEdfTURfTVNfTFJcbiAqICAtbWk6IGFsbFxuICogPC9QUkU+XG4gKi9cbkVuY29kZXIuTVBHX01EX0xSX0xSID0gMDtcbkVuY29kZXIuTVBHX01EX0xSX0kgPSAxO1xuRW5jb2Rlci5NUEdfTURfTVNfTFIgPSAyO1xuRW5jb2Rlci5NUEdfTURfTVNfSSA9IDM7XG5cbkVuY29kZXIuZmlyY29lZiA9IFstMC4wMjA3ODg3ICogNSwgLTAuMDM3ODQxMyAqIDUsXG4gICAgLTAuMDQzMjQ3MiAqIDUsIC0wLjAzMTE4MyAqIDUsIDcuNzk2MDllLTE4ICogNSwgMC4wNDY3NzQ1ICogNSxcbiAgICAwLjEwMDkxICogNSwgMC4xNTEzNjUgKiA1LCAwLjE4NzA5OCAqIDVdO1xuXG5mdW5jdGlvbiBFbmNvZGVyKCkge1xuXG4gICAgdmFyIEZGVE9GRlNFVCA9IEVuY29kZXIuRkZUT0ZGU0VUO1xuICAgIHZhciBNUEdfTURfTVNfTFIgPSBFbmNvZGVyLk1QR19NRF9NU19MUjtcbiAgICAvL0JpdFN0cmVhbSBicztcbiAgICAvL1BzeU1vZGVsIHBzeTtcbiAgICAvL1ZCUlRhZyB2YnI7XG4gICAgLy9RdWFudGl6ZVBWVCBxdXB2dDtcbiAgICB2YXIgYnMgPSBudWxsO1xuICAgIHRoaXMucHN5ID0gbnVsbDtcbiAgICB2YXIgcHN5ID0gbnVsbDtcbiAgICB2YXIgdmJyID0gbnVsbDtcbiAgICB2YXIgcXVwdnQgPSBudWxsO1xuXG4gICAgLy9wdWJsaWMgZmluYWwgdm9pZCBzZXRNb2R1bGVzKEJpdFN0cmVhbSBicywgUHN5TW9kZWwgcHN5LCBRdWFudGl6ZVBWVCBxdXB2dCxcbiAgICAvLyAgICBWQlJUYWcgdmJyKSB7XG4gICAgdGhpcy5zZXRNb2R1bGVzID0gZnVuY3Rpb24gKF9icywgX3BzeSwgX3F1cHZ0LCBfdmJyKSB7XG4gICAgICAgIGJzID0gX2JzO1xuICAgICAgICB0aGlzLnBzeSA9IF9wc3k7XG4gICAgICAgIHBzeSA9IF9wc3k7XG4gICAgICAgIHZiciA9IF92YnI7XG4gICAgICAgIHF1cHZ0ID0gX3F1cHZ0O1xuICAgIH07XG5cbiAgICB2YXIgbmV3TURDVCA9IG5ldyBOZXdNRENUKCk7XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKlxuICAgICAqIGVuY29kZXIgYW5kIGRlY29kZXIgZGVsYXlzXG4gICAgICpcbiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAvKipcbiAgICAgKiA8UFJFPlxuICAgICAqIGxheWVyIElJSSBlbmMtPmRlYyBkZWxheTogIDEwNTYgKDEwNTc/KSAgIChvYnNlcnZlZClcbiAgICAgKiBsYXllciAgSUkgZW5jLT5kZWMgZGVsYXk6ICAgNDgwICAoNDgxPykgICAob2JzZXJ2ZWQpXG4gICAgICpcbiAgICAgKiBwb2x5cGhhc2UgMjU2LTE2ICAgICAgICAgICAgIChkZWMgb3IgZW5jKSAgICAgICAgPSAyNDBcbiAgICAgKiBtZGN0ICAgICAgMjU2KzMyICAoOSozMikgICAgIChkZWMgb3IgZW5jKSAgICAgICAgPSAyODhcbiAgICAgKiB0b3RhbDogICAgNTEyKzE2XG4gICAgICpcbiAgICAgKiBNeSBndWVzcyBpcyB0aGF0IGRlbGF5IG9mIHBvbHlwaGFzZSBmaWx0ZXJiYW5rIGlzIGFjdHVhbHkgMjQwLjVcbiAgICAgKiAodGhlcmUgYXJlIHRlY2huaWNhbCByZWFzb25zIGZvciB0aGlzLCBzZWUgcG9zdGluZ3MgaW4gbXAzZW5jb2RlcikuXG4gICAgICogU28gdG90YWwgRW5jb2RlK0RlY29kZSBkZWxheSA9IEVOQ0RFTEFZICsgNTI4ICsgMVxuICAgICAqIDwvUFJFPlxuICAgICAqL1xuXG5cbiAgICAvKipcbiAgICAgKiBhdXRvLWFkanVzdCBvZiBBVEgsIHVzZWZ1bCBmb3IgbG93IHZvbHVtZSBHYWJyaWVsIEJvdXZpZ25lIDMgZmViIDIwMDFcbiAgICAgKlxuICAgICAqIG1vZGlmaWVzIHNvbWUgdmFsdWVzIGluIGdmcC5pbnRlcm5hbF9mbGFncy5BVEggKGdmYy5BVEgpXG4gICAgICovXG4vL3ByaXZhdGUgdm9pZCBhZGp1c3RfQVRIKGZpbmFsIExhbWVJbnRlcm5hbEZsYWdzIGdmYykge1xuICAgIGZ1bmN0aW9uIGFkanVzdF9BVEgoZ2ZjKSB7XG4gICAgICAgIHZhciBncjJfbWF4LCBtYXhfcG93O1xuXG4gICAgICAgIGlmIChnZmMuQVRILnVzZUFkanVzdCA9PSAwKSB7XG4gICAgICAgICAgICBnZmMuQVRILmFkanVzdCA9IDEuMDtcbiAgICAgICAgICAgIC8qIG5vIGFkanVzdG1lbnQgKi9cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGpkIC0gMjAwMSBtYXIgMTIsIDI3LCBqdW4gMzAgKi9cbiAgICAgICAgLyogbG91ZG5lc3MgYmFzZWQgb24gZXF1YWwgbG91ZG5lc3MgY3VydmU7ICovXG4gICAgICAgIC8qIHVzZSBncmFudWxlIHdpdGggbWF4aW11bSBjb21iaW5lZCBsb3VkbmVzcyAqL1xuICAgICAgICBtYXhfcG93ID0gZ2ZjLmxvdWRuZXNzX3NxWzBdWzBdO1xuICAgICAgICBncjJfbWF4ID0gZ2ZjLmxvdWRuZXNzX3NxWzFdWzBdO1xuICAgICAgICBpZiAoZ2ZjLmNoYW5uZWxzX291dCA9PSAyKSB7XG4gICAgICAgICAgICBtYXhfcG93ICs9IGdmYy5sb3VkbmVzc19zcVswXVsxXTtcbiAgICAgICAgICAgIGdyMl9tYXggKz0gZ2ZjLmxvdWRuZXNzX3NxWzFdWzFdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbWF4X3BvdyArPSBtYXhfcG93O1xuICAgICAgICAgICAgZ3IyX21heCArPSBncjJfbWF4O1xuICAgICAgICB9XG4gICAgICAgIGlmIChnZmMubW9kZV9nciA9PSAyKSB7XG4gICAgICAgICAgICBtYXhfcG93ID0gTWF0aC5tYXgobWF4X3BvdywgZ3IyX21heCk7XG4gICAgICAgIH1cbiAgICAgICAgbWF4X3BvdyAqPSAwLjU7XG4gICAgICAgIC8qIG1heF9wb3cgYXBwcm9hY2hlcyAxLjAgZm9yIGZ1bGwgYmFuZCBub2lzZSAqL1xuXG4gICAgICAgIC8qIGpkIC0gMjAwMSBtYXIgMzEsIGp1biAzMCAqL1xuICAgICAgICAvKiB1c2VyIHR1bmluZyBvZiBBVEggYWRqdXN0bWVudCByZWdpb24gKi9cbiAgICAgICAgbWF4X3BvdyAqPSBnZmMuQVRILmFhU2Vuc2l0aXZpdHlQO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGFkanVzdCBBVEggZGVwZW5kaW5nIG9uIHJhbmdlIG9mIG1heGltdW0gdmFsdWVcbiAgICAgICAgICovXG5cbiAgICAgICAgLyogamQgLSAyMDAxIGZlYjI3LCBtYXIxMiwyMCwganVuMzAsIGp1bDIyICovXG4gICAgICAgIC8qIGNvbnRpbnVvdXMgY3VydmVzIGJhc2VkIG9uIGFwcHJveGltYXRpb24gKi9cbiAgICAgICAgLyogdG8gR0IncyBvcmlnaW5hbCB2YWx1ZXMuICovXG4gICAgICAgIC8qIEZvciBhbiBpbmNyZWFzZSBpbiBhcHByb3hpbWF0ZSBsb3VkbmVzcywgKi9cbiAgICAgICAgLyogc2V0IEFUSCBhZGp1c3QgdG8gYWRqdXN0X2xpbWl0IGltbWVkaWF0ZWx5ICovXG4gICAgICAgIC8qIGFmdGVyIGEgZGVsYXkgb2Ygb25lIGZyYW1lLiAqL1xuICAgICAgICAvKiBGb3IgYSBsb3VkbmVzcyBkZWNyZWFzZSwgcmVkdWNlIEFUSCBhZGp1c3QgKi9cbiAgICAgICAgLyogdG93YXJkcyBhZGp1c3RfbGltaXQgZ3JhZHVhbGx5LiAqL1xuICAgICAgICAvKiBtYXhfcG93IGlzIGEgbG91ZG5lc3Mgc3F1YXJlZCBvciBhIHBvd2VyLiAqL1xuICAgICAgICBpZiAobWF4X3BvdyA+IDAuMDMxMjUpIHsgLyogKCgxIC0gMC4wMDA2MjUpLyAzMS45OCkgZnJvbSBjdXJ2ZSBiZWxvdyAqL1xuICAgICAgICAgICAgaWYgKGdmYy5BVEguYWRqdXN0ID49IDEuMCkge1xuICAgICAgICAgICAgICAgIGdmYy5BVEguYWRqdXN0ID0gMS4wO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvKiBwcmVjZWRpbmcgZnJhbWUgaGFzIGxvd2VyIEFUSCBhZGp1c3Q7ICovXG4gICAgICAgICAgICAgICAgLyogYXNjZW5kIG9ubHkgdG8gdGhlIHByZWNlZGluZyBhZGp1c3RfbGltaXQgKi9cbiAgICAgICAgICAgICAgICAvKiBpbiBjYXNlIHRoZXJlIGlzIGxlYWRpbmcgbG93IHZvbHVtZSAqL1xuICAgICAgICAgICAgICAgIGlmIChnZmMuQVRILmFkanVzdCA8IGdmYy5BVEguYWRqdXN0TGltaXQpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLkFUSC5hZGp1c3QgPSBnZmMuQVRILmFkanVzdExpbWl0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy5BVEguYWRqdXN0TGltaXQgPSAxLjA7XG4gICAgICAgIH0gZWxzZSB7IC8qIGFkanVzdG1lbnQgY3VydmUgKi9cbiAgICAgICAgICAgIC8qIGFib3V0IDMyIGRCIG1heGltdW0gYWRqdXN0ICgwLjAwMDYyNSkgKi9cbiAgICAgICAgICAgIHZhciBhZGpfbGltX25ldyA9IDMxLjk4ICogbWF4X3BvdyArIDAuMDAwNjI1O1xuICAgICAgICAgICAgaWYgKGdmYy5BVEguYWRqdXN0ID49IGFkal9saW1fbmV3KSB7IC8qIGRlc2NlbmQgZ3JhZHVhbGx5ICovXG4gICAgICAgICAgICAgICAgZ2ZjLkFUSC5hZGp1c3QgKj0gYWRqX2xpbV9uZXcgKiAwLjA3NSArIDAuOTI1O1xuICAgICAgICAgICAgICAgIGlmIChnZmMuQVRILmFkanVzdCA8IGFkal9saW1fbmV3KSB7IC8qIHN0b3AgZGVzY2VudCAqL1xuICAgICAgICAgICAgICAgICAgICBnZmMuQVRILmFkanVzdCA9IGFkal9saW1fbmV3O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7IC8qIGFzY2VuZCAqL1xuICAgICAgICAgICAgICAgIGlmIChnZmMuQVRILmFkanVzdExpbWl0ID49IGFkal9saW1fbmV3KSB7XG4gICAgICAgICAgICAgICAgICAgIGdmYy5BVEguYWRqdXN0ID0gYWRqX2xpbV9uZXc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLyogcHJlY2VkaW5nIGZyYW1lIGhhcyBsb3dlciBBVEggYWRqdXN0OyAqL1xuICAgICAgICAgICAgICAgICAgICAvKiBhc2NlbmQgb25seSB0byB0aGUgcHJlY2VkaW5nIGFkanVzdF9saW1pdCAqL1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2ZjLkFUSC5hZGp1c3QgPCBnZmMuQVRILmFkanVzdExpbWl0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZmMuQVRILmFkanVzdCA9IGdmYy5BVEguYWRqdXN0TGltaXQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMuQVRILmFkanVzdExpbWl0ID0gYWRqX2xpbV9uZXc7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiA8UFJFPlxuICAgICAqICBzb21lIHNpbXBsZSBzdGF0aXN0aWNzXG4gICAgICpcbiAgICAgKiAgYml0cmF0ZSBpbmRleCAwOiBmcmVlIGJpdHJhdGUgLiBub3QgYWxsb3dlZCBpbiBWQlIgbW9kZVxuICAgICAqICA6IGJpdHJhdGVzLCBrYnBzIGRlcGVuZGluZyBvbiBNUEVHIHZlcnNpb25cbiAgICAgKiAgYml0cmF0ZSBpbmRleCAxNTogZm9yYmlkZGVuXG4gICAgICpcbiAgICAgKiAgbW9kZV9leHQ6XG4gICAgICogIDA6ICBMUlxuICAgICAqICAxOiAgTFItaVxuICAgICAqICAyOiAgTVNcbiAgICAgKiAgMzogIE1TLWlcbiAgICAgKiA8L1BSRT5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiB1cGRhdGVTdGF0cyhnZmMpIHtcbiAgICAgICAgdmFyIGdyLCBjaDtcblxuICAgICAgICAvKiBjb3VudCBiaXRyYXRlIGluZGljZXMgKi9cbiAgICAgICAgZ2ZjLmJpdHJhdGVfc3RlcmVvTW9kZV9IaXN0W2dmYy5iaXRyYXRlX2luZGV4XVs0XSsrO1xuICAgICAgICBnZmMuYml0cmF0ZV9zdGVyZW9Nb2RlX0hpc3RbMTVdWzRdKys7XG5cbiAgICAgICAgLyogY291bnQgJ2VtIGZvciBldmVyeSBtb2RlIGV4dGVuc2lvbiBpbiBjYXNlIG9mIDIgY2hhbm5lbCBlbmNvZGluZyAqL1xuICAgICAgICBpZiAoZ2ZjLmNoYW5uZWxzX291dCA9PSAyKSB7XG4gICAgICAgICAgICBnZmMuYml0cmF0ZV9zdGVyZW9Nb2RlX0hpc3RbZ2ZjLmJpdHJhdGVfaW5kZXhdW2dmYy5tb2RlX2V4dF0rKztcbiAgICAgICAgICAgIGdmYy5iaXRyYXRlX3N0ZXJlb01vZGVfSGlzdFsxNV1bZ2ZjLm1vZGVfZXh0XSsrO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyArK2dyKSB7XG4gICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyArK2NoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJ0ID0gZ2ZjLmwzX3NpZGUudHRbZ3JdW2NoXS5ibG9ja190eXBlIHwgMDtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLmwzX3NpZGUudHRbZ3JdW2NoXS5taXhlZF9ibG9ja19mbGFnICE9IDApXG4gICAgICAgICAgICAgICAgICAgIGJ0ID0gNDtcbiAgICAgICAgICAgICAgICBnZmMuYml0cmF0ZV9ibG9ja1R5cGVfSGlzdFtnZmMuYml0cmF0ZV9pbmRleF1bYnRdKys7XG4gICAgICAgICAgICAgICAgZ2ZjLmJpdHJhdGVfYmxvY2tUeXBlX0hpc3RbZ2ZjLmJpdHJhdGVfaW5kZXhdWzVdKys7XG4gICAgICAgICAgICAgICAgZ2ZjLmJpdHJhdGVfYmxvY2tUeXBlX0hpc3RbMTVdW2J0XSsrO1xuICAgICAgICAgICAgICAgIGdmYy5iaXRyYXRlX2Jsb2NrVHlwZV9IaXN0WzE1XVs1XSsrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGFtZV9lbmNvZGVfZnJhbWVfaW5pdChnZnAsIGluYnVmKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cbiAgICAgICAgdmFyIGNoLCBncjtcblxuICAgICAgICBpZiAoZ2ZjLmxhbWVfZW5jb2RlX2ZyYW1lX2luaXQgPT0gMCkge1xuICAgICAgICAgICAgLyogcHJpbWUgdGhlIE1EQ1QvcG9seXBoYXNlIGZpbHRlcmJhbmsgd2l0aCBhIHNob3J0IGJsb2NrICovXG4gICAgICAgICAgICB2YXIgaSwgajtcbiAgICAgICAgICAgIHZhciBwcmltZWJ1ZmYwID0gbmV3X2Zsb2F0KDI4NiArIDExNTIgKyA1NzYpO1xuICAgICAgICAgICAgdmFyIHByaW1lYnVmZjEgPSBuZXdfZmxvYXQoMjg2ICsgMTE1MiArIDU3Nik7XG4gICAgICAgICAgICBnZmMubGFtZV9lbmNvZGVfZnJhbWVfaW5pdCA9IDE7XG4gICAgICAgICAgICBmb3IgKGkgPSAwLCBqID0gMDsgaSA8IDI4NiArIDU3NiAqICgxICsgZ2ZjLm1vZGVfZ3IpOyArK2kpIHtcbiAgICAgICAgICAgICAgICBpZiAoaSA8IDU3NiAqIGdmYy5tb2RlX2dyKSB7XG4gICAgICAgICAgICAgICAgICAgIHByaW1lYnVmZjBbaV0gPSAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2ZjLmNoYW5uZWxzX291dCA9PSAyKVxuICAgICAgICAgICAgICAgICAgICAgICAgcHJpbWVidWZmMVtpXSA9IDA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcHJpbWVidWZmMFtpXSA9IGluYnVmWzBdW2pdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2ZjLmNoYW5uZWxzX291dCA9PSAyKVxuICAgICAgICAgICAgICAgICAgICAgICAgcHJpbWVidWZmMVtpXSA9IGluYnVmWzFdW2pdO1xuICAgICAgICAgICAgICAgICAgICArK2o7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogcG9seXBoYXNlIGZpbHRlcmluZyAvIG1kY3QgKi9cbiAgICAgICAgICAgIGZvciAoZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgICAgICBnZmMubDNfc2lkZS50dFtncl1bY2hdLmJsb2NrX3R5cGUgPSBFbmNvZGVyLlNIT1JUX1RZUEU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV3TURDVC5tZGN0X3N1YjQ4KGdmYywgcHJpbWVidWZmMCwgcHJpbWVidWZmMSk7XG5cbiAgICAgICAgICAgIC8qIGNoZWNrIEZGVCB3aWxsIG5vdCB1c2UgYSBuZWdhdGl2ZSBzdGFydGluZyBvZmZzZXQgKi9cbiAgICAgICAgICAgIC8qIGNoZWNrIGlmIHdlIGhhdmUgZW5vdWdoIGRhdGEgZm9yIEZGVCAqL1xuICAgICAgICAgICAgLyogY2hlY2sgaWYgd2UgaGF2ZSBlbm91Z2ggZGF0YSBmb3IgcG9seXBoYXNlIGZpbHRlcmJhbmsgKi9cbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogPFBSRT5cbiAgICAgKiBlbmNvZGVmcmFtZSgpICAgICAgICAgICBMYXllciAzXG4gICAgICpcbiAgICAgKiBlbmNvZGUgYSBzaW5nbGUgZnJhbWVcbiAgICAgKlxuICAgICAqXG4gICAgICogICAgbGFtZV9lbmNvZGVfZnJhbWUoKVxuICAgICAqXG4gICAgICpcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgIGdyIDAgICAgICAgICAgICBnciAxXG4gICAgICogICAgaW5idWY6ICAgICAgICAgICB8LS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS18LS0tLS0tLS0tLS0tLS18XG4gICAgICpcbiAgICAgKlxuICAgICAqICAgIFBvbHlwaGFzZSAoMTggd2luZG93cywgZWFjaCBzaGlmdGVkIDMyKVxuICAgICAqICAgIGdyIDA6XG4gICAgICogICAgd2luZG93MSAgICAgICAgICA8LS0tLTUxMi0tLS5cbiAgICAgKiAgICB3aW5kb3cxOCAgICAgICAgICAgICAgICAgPC0tLS01MTItLS0uXG4gICAgICpcbiAgICAgKiAgICBnciAxOlxuICAgICAqICAgIHdpbmRvdzEgICAgICAgICAgICAgICAgICAgICAgICAgPC0tLS01MTItLS0uXG4gICAgICogICAgd2luZG93MTggICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwtLS0tNTEyLS0tLlxuICAgICAqXG4gICAgICpcbiAgICAgKlxuICAgICAqICAgIE1EQ1Qgb3V0cHV0OiAgfC0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tfFxuICAgICAqXG4gICAgICogICAgRkZUJ3MgICAgICAgICAgICAgICAgICAgIDwtLS0tLS0tLS0xMDI0LS0tLS0tLS0tLlxuICAgICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPC0tLS0tLS0tLTEwMjQtLS0tLS0tLlxuICAgICAqXG4gICAgICpcbiAgICAgKlxuICAgICAqICAgICAgICBpbmJ1ZiA9IGJ1ZmZlciBvZiBQQ00gZGF0YSBzaXplPU1QMyBmcmFtZXNpemVcbiAgICAgKiAgICAgICAgZW5jb2RlciBhY3RzIG9uIGluYnVmW2NoXVswXSwgYnV0IG91dHB1dCBpcyBkZWxheWVkIGJ5IE1EQ1RERUxBWVxuICAgICAqICAgICAgICBzbyB0aGUgTURDVCBjb2VmZmljaW50cyBhcmUgZnJvbSBpbmJ1ZltjaF1bLU1EQ1RERUxBWV1cbiAgICAgKlxuICAgICAqICAgICAgICBwc3ktbW9kZWwgRkZUIGhhcyBhIDEgZ3JhbnVsZSBkZWxheSwgc28gd2UgZmVlZCBpdCBkYXRhIGZvciB0aGVcbiAgICAgKiAgICAgICAgbmV4dCBncmFudWxlLlxuICAgICAqICAgICAgICBGRlQgaXMgY2VudGVyZWQgb3ZlciBncmFudWxlOiAgMjI0KzU3NisyMjRcbiAgICAgKiAgICAgICAgU28gRkZUIHN0YXJ0cyBhdDogICA1NzYtMjI0LU1EQ1RERUxBWVxuICAgICAqXG4gICAgICogICAgICAgIE1QRUcyOiAgRkZUIGVuZHMgYXQ6ICBCTEtTSVpFKzU3Ni0yMjQtTURDVERFTEFZICAgICAgKDEzMjgpXG4gICAgICogICAgICAgIE1QRUcxOiAgRkZUIGVuZHMgYXQ6ICBCTEtTSVpFKzIqNTc2LTIyNC1NRENUREVMQVkgICAgKDE5MDQpXG4gICAgICpcbiAgICAgKiAgICAgICAgTVBFRzI6ICBwb2x5cGhhc2UgZmlyc3Qgd2luZG93OiAgWzAuLjUxMV1cbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgMTh0aCB3aW5kb3c6ICAgWzU0NC4uMTA1NV0gICAgICAgICAgKDEwNTYpXG4gICAgICogICAgICAgIE1QRUcxOiAgICAgICAgICAgIDM2dGggd2luZG93OiAgIFsxMTIwLi4xNjMxXSAgICAgICAgICgxNjMyKVxuICAgICAqICAgICAgICAgICAgICAgIGRhdGEgbmVlZGVkOiAgNTEyK2ZyYW1lc2l6ZS0zMlxuICAgICAqXG4gICAgICogICAgICAgIEEgY2xvc2UgbG9vayBuZXdtZGN0LmMgc2hvd3MgdGhhdCB0aGUgcG9seXBoYXNlIGZpbHRlcmJhbmtcbiAgICAgKiAgICAgICAgb25seSB1c2VzIGRhdGEgZnJvbSBbMC4uNTEwXSBmb3IgZWFjaCB3aW5kb3cuICBQZXJoYXBzIGJlY2F1c2UgdGhlIHdpbmRvd1xuICAgICAqICAgICAgICB1c2VkIGJ5IHRoZSBmaWx0ZXJiYW5rIGlzIHplcm8gZm9yIHRoZSBsYXN0IHBvaW50LCBzbyBUYWtlaGlybydzXG4gICAgICogICAgICAgIGNvZGUgZG9lc24ndCBib3RoZXIgdG8gY29tcHV0ZSB3aXRoIGl0LlxuICAgICAqXG4gICAgICogICAgICAgIEZGVCBzdGFydHMgYXQgNTc2LTIyNC1NRENUREVMQVkgKDMwNCkgID0gNTc2LUZGVE9GRlNFVFxuICAgICAqXG4gICAgICogPC9QUkU+XG4gICAgICovXG5cblxuICAgIHRoaXMubGFtZV9lbmNvZGVfbXAzX2ZyYW1lID0gZnVuY3Rpb24gKGdmcCwgaW5idWZfbCwgaW5idWZfciwgbXAzYnVmLCBtcDNidWZQb3MsIG1wM2J1Zl9zaXplKSB7XG4gICAgICAgIHZhciBtcDNjb3VudDtcbiAgICAgICAgdmFyIG1hc2tpbmdfTFIgPSBuZXdfYXJyYXlfbihbMiwgMl0pO1xuICAgICAgICAvKlxuICAgICAgICAgKiBMUiBtYXNraW5nICZcbiAgICAgICAgICogZW5lcmd5XG4gICAgICAgICAqL1xuICAgICAgICBtYXNraW5nX0xSWzBdWzBdID0gbmV3IElJSV9wc3lfcmF0aW8oKTtcbiAgICAgICAgbWFza2luZ19MUlswXVsxXSA9IG5ldyBJSUlfcHN5X3JhdGlvKCk7XG4gICAgICAgIG1hc2tpbmdfTFJbMV1bMF0gPSBuZXcgSUlJX3BzeV9yYXRpbygpO1xuICAgICAgICBtYXNraW5nX0xSWzFdWzFdID0gbmV3IElJSV9wc3lfcmF0aW8oKTtcbiAgICAgICAgdmFyIG1hc2tpbmdfTVMgPSBuZXdfYXJyYXlfbihbMiwgMl0pO1xuICAgICAgICAvKiBNUyBtYXNraW5nICYgZW5lcmd5ICovXG4gICAgICAgIG1hc2tpbmdfTVNbMF1bMF0gPSBuZXcgSUlJX3BzeV9yYXRpbygpO1xuICAgICAgICBtYXNraW5nX01TWzBdWzFdID0gbmV3IElJSV9wc3lfcmF0aW8oKTtcbiAgICAgICAgbWFza2luZ19NU1sxXVswXSA9IG5ldyBJSUlfcHN5X3JhdGlvKCk7XG4gICAgICAgIG1hc2tpbmdfTVNbMV1bMV0gPSBuZXcgSUlJX3BzeV9yYXRpbygpO1xuICAgICAgICAvL0lJSV9wc3lfcmF0aW8gbWFza2luZ1tdW107XG4gICAgICAgIHZhciBtYXNraW5nO1xuICAgICAgICAvKiBwb2ludGVyIHRvIHNlbGVjdGVkIG1hc2tpbmdzICovXG4gICAgICAgIHZhciBpbmJ1ZiA9IFtudWxsLCBudWxsXTtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblxuICAgICAgICB2YXIgdG90X2VuZXIgPSBuZXdfZmxvYXRfbihbMiwgNF0pO1xuICAgICAgICB2YXIgbXNfZW5lcl9yYXRpbyA9IFsuNSwgLjVdO1xuICAgICAgICB2YXIgcGUgPSBbWzAuLCAwLl0sIFswLiwgMC5dXTtcbiAgICAgICAgdmFyIHBlX01TID0gW1swLiwgMC5dLCBbMC4sIDAuXV07XG5cbi8vZmxvYXRbXVtdIHBlX3VzZTtcbiAgICAgICAgdmFyIHBlX3VzZTtcblxuICAgICAgICB2YXIgY2gsIGdyO1xuXG4gICAgICAgIGluYnVmWzBdID0gaW5idWZfbDtcbiAgICAgICAgaW5idWZbMV0gPSBpbmJ1Zl9yO1xuXG4gICAgICAgIGlmIChnZmMubGFtZV9lbmNvZGVfZnJhbWVfaW5pdCA9PSAwKSB7XG4gICAgICAgICAgICAvKiBmaXJzdCBydW4/ICovXG4gICAgICAgICAgICBsYW1lX2VuY29kZV9mcmFtZV9pbml0KGdmcCwgaW5idWYpO1xuXG4gICAgICAgIH1cblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKiBwYWRkaW5nICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICAvKipcbiAgICAgICAgICogPFBSRT5cbiAgICAgICAgICogcGFkZGluZyBtZXRob2QgYXMgZGVzY3JpYmVkIGluXG4gICAgICAgICAqIFwiTVBFRy1MYXllcjMgLyBCaXRzdHJlYW0gU3ludGF4IGFuZCBEZWNvZGluZ1wiXG4gICAgICAgICAqIGJ5IE1hcnRpbiBTaWVsZXIsIFJhbHBoIFNwZXJzY2huZWlkZXJcbiAgICAgICAgICpcbiAgICAgICAgICogbm90ZTogdGhlcmUgaXMgbm8gcGFkZGluZyBmb3IgdGhlIHZlcnkgZmlyc3QgZnJhbWVcbiAgICAgICAgICpcbiAgICAgICAgICogUm9iZXJ0IEhlZ2VtYW5uIDIwMDAtMDYtMjJcbiAgICAgICAgICogPC9QUkU+XG4gICAgICAgICAqL1xuICAgICAgICBnZmMucGFkZGluZyA9IDA7XG4gICAgICAgIGlmICgoZ2ZjLnNsb3RfbGFnIC09IGdmYy5mcmFjX1NwRikgPCAwKSB7XG4gICAgICAgICAgICBnZmMuc2xvdF9sYWcgKz0gZ2ZwLm91dF9zYW1wbGVyYXRlO1xuICAgICAgICAgICAgZ2ZjLnBhZGRpbmcgPSAxO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogU3RhZ2UgMTogcHN5Y2hvYWNvdXN0aWMgbW9kZWwgKlxuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICBpZiAoZ2ZjLnBzeW1vZGVsICE9IDApIHtcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBwc3ljaG9hY291c3RpYyBtb2RlbCBwc3kgbW9kZWwgaGFzIGEgMSBncmFudWxlICg1NzYpIGRlbGF5IHRoYXRcbiAgICAgICAgICAgICAqIHdlIG11c3QgY29tcGVuc2F0ZSBmb3IgKG10IDYvOTkpLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YXIgcmV0O1xuICAgICAgICAgICAgdmFyIGJ1ZnAgPSBbbnVsbCwgbnVsbF07XG4gICAgICAgICAgICAvKiBhZGRyZXNzIG9mIGJlZ2lubmluZyBvZiBsZWZ0ICYgcmlnaHQgZ3JhbnVsZSAqL1xuICAgICAgICAgICAgdmFyIGJ1ZnBQb3MgPSAwO1xuICAgICAgICAgICAgLyogYWRkcmVzcyBvZiBiZWdpbm5pbmcgb2YgbGVmdCAmIHJpZ2h0IGdyYW51bGUgKi9cbiAgICAgICAgICAgIHZhciBibG9ja3R5cGUgPSBuZXdfaW50KDIpO1xuXG4gICAgICAgICAgICBmb3IgKGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuXG4gICAgICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgICAgICBidWZwW2NoXSA9IGluYnVmW2NoXTtcbiAgICAgICAgICAgICAgICAgICAgYnVmcFBvcyA9IDU3NiArIGdyICogNTc2IC0gRW5jb2Rlci5GRlRPRkZTRVQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnZnAuVkJSID09IFZick1vZGUudmJyX210cmggfHwgZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9tdCkge1xuICAgICAgICAgICAgICAgICAgICByZXQgPSBwc3kuTDNwc3ljaG9fYW5hbF92YnIoZ2ZwLCBidWZwLCBidWZwUG9zLCBncixcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hc2tpbmdfTFIsIG1hc2tpbmdfTVMsIHBlW2dyXSwgcGVfTVNbZ3JdLFxuICAgICAgICAgICAgICAgICAgICAgICAgdG90X2VuZXJbZ3JdLCBibG9ja3R5cGUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldCA9IHBzeS5MM3BzeWNob19hbmFsX25zKGdmcCwgYnVmcCwgYnVmcFBvcywgZ3IsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXNraW5nX0xSLCBtYXNraW5nX01TLCBwZVtncl0sIHBlX01TW2dyXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdF9lbmVyW2dyXSwgYmxvY2t0eXBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJldCAhPSAwKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoZ2ZwLm1vZGUgPT0gTVBFR01vZGUuSk9JTlRfU1RFUkVPKSB7XG4gICAgICAgICAgICAgICAgICAgIG1zX2VuZXJfcmF0aW9bZ3JdID0gdG90X2VuZXJbZ3JdWzJdICsgdG90X2VuZXJbZ3JdWzNdO1xuICAgICAgICAgICAgICAgICAgICBpZiAobXNfZW5lcl9yYXRpb1tncl0gPiAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgbXNfZW5lcl9yYXRpb1tncl0gPSB0b3RfZW5lcltncl1bM10gLyBtc19lbmVyX3JhdGlvW2dyXTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKiBibG9jayB0eXBlIGZsYWdzICovXG4gICAgICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY29kX2luZm8gPSBnZmMubDNfc2lkZS50dFtncl1bY2hdO1xuICAgICAgICAgICAgICAgICAgICBjb2RfaW5mby5ibG9ja190eXBlID0gYmxvY2t0eXBlW2NoXTtcbiAgICAgICAgICAgICAgICAgICAgY29kX2luZm8ubWl4ZWRfYmxvY2tfZmxhZyA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLyogbm8gcHN5IG1vZGVsICovXG4gICAgICAgICAgICBmb3IgKGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKylcbiAgICAgICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGdmYy5sM19zaWRlLnR0W2dyXVtjaF0uYmxvY2tfdHlwZSA9IEVuY29kZXIuTk9STV9UWVBFO1xuICAgICAgICAgICAgICAgICAgICBnZmMubDNfc2lkZS50dFtncl1bY2hdLm1peGVkX2Jsb2NrX2ZsYWcgPSAwO1xuICAgICAgICAgICAgICAgICAgICBwZV9NU1tncl1bY2hdID0gcGVbZ3JdW2NoXSA9IDcwMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBhdXRvLWFkanVzdCBvZiBBVEgsIHVzZWZ1bCBmb3IgbG93IHZvbHVtZSAqL1xuICAgICAgICBhZGp1c3RfQVRIKGdmYyk7XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogU3RhZ2UgMjogTURDVCAqXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qIHBvbHlwaGFzZSBmaWx0ZXJpbmcgLyBtZGN0ICovXG4gICAgICAgIG5ld01EQ1QubWRjdF9zdWI0OChnZmMsIGluYnVmWzBdLCBpbmJ1ZlsxXSk7XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogU3RhZ2UgMzogTVMvTFIgZGVjaXNpb24gKlxuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiBIZXJlIHdpbGwgYmUgc2VsZWN0ZWQgTVMgb3IgTFIgY29kaW5nIG9mIHRoZSAyIHN0ZXJlbyBjaGFubmVscyAqL1xuICAgICAgICBnZmMubW9kZV9leHQgPSBFbmNvZGVyLk1QR19NRF9MUl9MUjtcblxuICAgICAgICBpZiAoZ2ZwLmZvcmNlX21zKSB7XG4gICAgICAgICAgICBnZmMubW9kZV9leHQgPSBFbmNvZGVyLk1QR19NRF9NU19MUjtcbiAgICAgICAgfSBlbHNlIGlmIChnZnAubW9kZSA9PSBNUEVHTW9kZS5KT0lOVF9TVEVSRU8pIHtcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBtc19yYXRpbyA9IGlzIHNjYWxlZCwgZm9yIGhpc3RvcmljYWwgcmVhc29ucywgdG8gbG9vayBsaWtlIGFcbiAgICAgICAgICAgICAqIHJhdGlvIG9mIHNpZGVfY2hhbm5lbCAvIHRvdGFsLiAwID0gc2lnbmFsIGlzIDEwMCUgbW9ubyAuNSA9IEwgJiBSXG4gICAgICAgICAgICAgKiB1bmNvcnJlbGF0ZWRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIDxQUkU+XG4gICAgICAgICAgICAgKiBbMF0gYW5kIFsxXSBhcmUgdGhlIHJlc3VsdHMgZm9yIHRoZSB0d28gZ3JhbnVsZXMgaW4gTVBFRy0xLFxuICAgICAgICAgICAgICogaW4gTVBFRy0yIGl0J3Mgb25seSBhIGZha2VkIGF2ZXJhZ2luZyBvZiB0aGUgc2FtZSB2YWx1ZVxuICAgICAgICAgICAgICogX3ByZXYgaXMgdGhlIHZhbHVlIG9mIHRoZSBsYXN0IGdyYW51bGUgb2YgdGhlIHByZXZpb3VzIGZyYW1lXG4gICAgICAgICAgICAgKiBfbmV4dCBpcyB0aGUgdmFsdWUgb2YgdGhlIGZpcnN0IGdyYW51bGUgb2YgdGhlIG5leHQgZnJhbWVcbiAgICAgICAgICAgICAqIDwvUFJFPlxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIHZhciBzdW1fcGVfTVMgPSAwLjtcbiAgICAgICAgICAgIHZhciBzdW1fcGVfTFIgPSAwLjtcbiAgICAgICAgICAgIGZvciAoZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgICAgICBzdW1fcGVfTVMgKz0gcGVfTVNbZ3JdW2NoXTtcbiAgICAgICAgICAgICAgICAgICAgc3VtX3BlX0xSICs9IHBlW2dyXVtjaF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBiYXNlZCBvbiBQRTogTS9TIGNvZGluZyB3b3VsZCBub3QgdXNlIG11Y2ggbW9yZSBiaXRzIHRoYW4gTC9SICovXG4gICAgICAgICAgICBpZiAoc3VtX3BlX01TIDw9IDEuMDAgKiBzdW1fcGVfTFIpIHtcblxuICAgICAgICAgICAgICAgIHZhciBnaTAgPSBnZmMubDNfc2lkZS50dFswXTtcbiAgICAgICAgICAgICAgICB2YXIgZ2kxID0gZ2ZjLmwzX3NpZGUudHRbZ2ZjLm1vZGVfZ3IgLSAxXTtcblxuICAgICAgICAgICAgICAgIGlmIChnaTBbMF0uYmxvY2tfdHlwZSA9PSBnaTBbMV0uYmxvY2tfdHlwZVxuICAgICAgICAgICAgICAgICAgICAmJiBnaTFbMF0uYmxvY2tfdHlwZSA9PSBnaTFbMV0uYmxvY2tfdHlwZSkge1xuXG4gICAgICAgICAgICAgICAgICAgIGdmYy5tb2RlX2V4dCA9IEVuY29kZXIuTVBHX01EX01TX0xSO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGJpdCBhbmQgbm9pc2UgYWxsb2NhdGlvbiAqL1xuICAgICAgICBpZiAoZ2ZjLm1vZGVfZXh0ID09IE1QR19NRF9NU19MUikge1xuICAgICAgICAgICAgbWFza2luZyA9IG1hc2tpbmdfTVM7XG4gICAgICAgICAgICAvKiB1c2UgTVMgbWFza2luZyAqL1xuICAgICAgICAgICAgcGVfdXNlID0gcGVfTVM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtYXNraW5nID0gbWFza2luZ19MUjtcbiAgICAgICAgICAgIC8qIHVzZSBMUiBtYXNraW5nICovXG4gICAgICAgICAgICBwZV91c2UgPSBwZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGNvcHkgZGF0YSBmb3IgTVAzIGZyYW1lIGFuYWx5emVyICovXG4gICAgICAgIGlmIChnZnAuYW5hbHlzaXMgJiYgZ2ZjLnBpbmZvICE9IG51bGwpIHtcbiAgICAgICAgICAgIGZvciAoZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgICAgICBnZmMucGluZm8ubXNfcmF0aW9bZ3JdID0gZ2ZjLm1zX3JhdGlvW2dyXTtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLm1zX2VuZXJfcmF0aW9bZ3JdID0gbXNfZW5lcl9yYXRpb1tncl07XG4gICAgICAgICAgICAgICAgICAgIGdmYy5waW5mby5ibG9ja3R5cGVbZ3JdW2NoXSA9IGdmYy5sM19zaWRlLnR0W2dyXVtjaF0uYmxvY2tfdHlwZTtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLnBlW2dyXVtjaF0gPSBwZV91c2VbZ3JdW2NoXTtcbiAgICAgICAgICAgICAgICAgICAgU3lzdGVtLmFycmF5Y29weShnZmMubDNfc2lkZS50dFtncl1bY2hdLnhyLCAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLnhyW2dyXVtjaF0sIDAsIDU3Nik7XG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAqIGluIHBzeW1vZGVsLCBMUiBhbmQgTVMgZGF0YSB3YXMgc3RvcmVkIGluIHBpbmZvLiBzd2l0Y2hcbiAgICAgICAgICAgICAgICAgICAgICogdG8gTVMgZGF0YTpcbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGlmIChnZmMubW9kZV9leHQgPT0gTVBHX01EX01TX0xSKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZmMucGluZm8uZXJzW2dyXVtjaF0gPSBnZmMucGluZm8uZXJzW2dyXVtjaCArIDJdO1xuICAgICAgICAgICAgICAgICAgICAgICAgU3lzdGVtLmFycmF5Y29weShnZmMucGluZm8uZW5lcmd5W2dyXVtjaCArIDJdLCAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdmYy5waW5mby5lbmVyZ3lbZ3JdW2NoXSwgMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZmMucGluZm8uZW5lcmd5W2dyXVtjaF0ubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIFN0YWdlIDQ6IHF1YW50aXphdGlvbiBsb29wICpcbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgaWYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfb2ZmIHx8IGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfYWJyKSB7XG5cbiAgICAgICAgICAgIHZhciBpO1xuICAgICAgICAgICAgdmFyIGY7XG5cbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCAxODsgaSsrKVxuICAgICAgICAgICAgICAgIGdmYy5uc1BzeS5wZWZpcmJ1ZltpXSA9IGdmYy5uc1BzeS5wZWZpcmJ1ZltpICsgMV07XG5cbiAgICAgICAgICAgIGYgPSAwLjA7XG4gICAgICAgICAgICBmb3IgKGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKylcbiAgICAgICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKVxuICAgICAgICAgICAgICAgICAgICBmICs9IHBlX3VzZVtncl1bY2hdO1xuICAgICAgICAgICAgZ2ZjLm5zUHN5LnBlZmlyYnVmWzE4XSA9IGY7XG5cbiAgICAgICAgICAgIGYgPSBnZmMubnNQc3kucGVmaXJidWZbOV07XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgOTsgaSsrKVxuICAgICAgICAgICAgICAgIGYgKz0gKGdmYy5uc1BzeS5wZWZpcmJ1ZltpXSArIGdmYy5uc1BzeS5wZWZpcmJ1ZlsxOCAtIGldKVxuICAgICAgICAgICAgICAgICAgICAqIEVuY29kZXIuZmlyY29lZltpXTtcblxuICAgICAgICAgICAgZiA9ICg2NzAgKiA1ICogZ2ZjLm1vZGVfZ3IgKiBnZmMuY2hhbm5lbHNfb3V0KSAvIGY7XG4gICAgICAgICAgICBmb3IgKGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuICAgICAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICAgICAgcGVfdXNlW2dyXVtjaF0gKj0gZjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZ2ZjLml0ZXJhdGlvbl9sb29wLml0ZXJhdGlvbl9sb29wKGdmcCwgcGVfdXNlLCBtc19lbmVyX3JhdGlvLCBtYXNraW5nKTtcblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBTdGFnZSA1OiBiaXRzdHJlYW0gZm9ybWF0dGluZyAqXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIC8qIHdyaXRlIHRoZSBmcmFtZSB0byB0aGUgYml0c3RyZWFtICovXG4gICAgICAgIGJzLmZvcm1hdF9iaXRzdHJlYW0oZ2ZwKTtcblxuICAgICAgICAvKiBjb3B5IG1wMyBiaXQgYnVmZmVyIGludG8gYXJyYXkgKi9cbiAgICAgICAgbXAzY291bnQgPSBicy5jb3B5X2J1ZmZlcihnZmMsIG1wM2J1ZiwgbXAzYnVmUG9zLCBtcDNidWZfc2l6ZSwgMSk7XG5cbiAgICAgICAgaWYgKGdmcC5iV3JpdGVWYnJUYWcpXG4gICAgICAgICAgICB2YnIuYWRkVmJyRnJhbWUoZ2ZwKTtcblxuICAgICAgICBpZiAoZ2ZwLmFuYWx5c2lzICYmIGdmYy5waW5mbyAhPSBudWxsKSB7XG4gICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGo7XG4gICAgICAgICAgICAgICAgZm9yIChqID0gMDsgaiA8IEZGVE9GRlNFVDsgaisrKVxuICAgICAgICAgICAgICAgICAgICBnZmMucGluZm8ucGNtZGF0YVtjaF1bal0gPSBnZmMucGluZm8ucGNtZGF0YVtjaF1balxuICAgICAgICAgICAgICAgICAgICArIGdmcC5mcmFtZXNpemVdO1xuICAgICAgICAgICAgICAgIGZvciAoaiA9IEZGVE9GRlNFVDsgaiA8IDE2MDA7IGorKykge1xuICAgICAgICAgICAgICAgICAgICBnZmMucGluZm8ucGNtZGF0YVtjaF1bal0gPSBpbmJ1ZltjaF1baiAtIEZGVE9GRlNFVF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcXVwdnQuc2V0X2ZyYW1lX3BpbmZvKGdmcCwgbWFza2luZyk7XG4gICAgICAgIH1cblxuICAgICAgICB1cGRhdGVTdGF0cyhnZmMpO1xuXG4gICAgICAgIHJldHVybiBtcDNjb3VudDtcbiAgICB9XG59XG5cblxuLy9wYWNrYWdlIG1wMztcblxuZnVuY3Rpb24gVkJSU2Vla0luZm8oKSB7XG4gICAgLyoqXG4gICAgICogV2hhdCB3ZSBoYXZlIHNlZW4gc28gZmFyLlxuICAgICAqL1xuICAgIHRoaXMuc3VtID0gMDtcbiAgICAvKipcbiAgICAgKiBIb3cgbWFueSBmcmFtZXMgd2UgaGF2ZSBzZWVuIGluIHRoaXMgY2h1bmsuXG4gICAgICovXG4gICAgdGhpcy5zZWVuID0gMDtcbiAgICAvKipcbiAgICAgKiBIb3cgbWFueSBmcmFtZXMgd2Ugd2FudCB0byBjb2xsZWN0IGludG8gb25lIGNodW5rLlxuICAgICAqL1xuICAgIHRoaXMud2FudCA9IDA7XG4gICAgLyoqXG4gICAgICogQWN0dWFsIHBvc2l0aW9uIGluIG91ciBiYWcuXG4gICAgICovXG4gICAgdGhpcy5wb3MgPSAwO1xuICAgIC8qKlxuICAgICAqIFNpemUgb2Ygb3VyIGJhZy5cbiAgICAgKi9cbiAgICB0aGlzLnNpemUgPSAwO1xuICAgIC8qKlxuICAgICAqIFBvaW50ZXIgdG8gb3VyIGJhZy5cbiAgICAgKi9cbiAgICB0aGlzLmJhZyA9IG51bGw7XG4gICAgdGhpcy5uVmJyTnVtRnJhbWVzID0gMDtcbiAgICB0aGlzLm5CeXRlc1dyaXR0ZW4gPSAwO1xuICAgIC8qIFZCUiB0YWcgZGF0YSAqL1xuICAgIHRoaXMuVG90YWxGcmFtZVNpemUgPSAwO1xufVxuXG5cblxuZnVuY3Rpb24gSUlJU2lkZUluZm8oKSB7XG4gICAgdGhpcy50dCA9IFtbbnVsbCwgbnVsbF0sIFtudWxsLCBudWxsXV07XG4gICAgdGhpcy5tYWluX2RhdGFfYmVnaW4gPSAwO1xuICAgIHRoaXMucHJpdmF0ZV9iaXRzID0gMDtcbiAgICB0aGlzLnJlc3ZEcmFpbl9wcmUgPSAwO1xuICAgIHRoaXMucmVzdkRyYWluX3Bvc3QgPSAwO1xuICAgIHRoaXMuc2Nmc2kgPSBbbmV3X2ludCg0KSwgbmV3X2ludCg0KV07XG5cbiAgICBmb3IgKHZhciBnciA9IDA7IGdyIDwgMjsgZ3IrKykge1xuICAgICAgICBmb3IgKHZhciBjaCA9IDA7IGNoIDwgMjsgY2grKykge1xuICAgICAgICAgICAgdGhpcy50dFtncl1bY2hdID0gbmV3IEdySW5mbygpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5cbmZ1bmN0aW9uIElJSV9wc3lfeG1pbigpIHtcbiAgICB0aGlzLmwgPSBuZXdfZmxvYXQoRW5jb2Rlci5TQk1BWF9sKTtcbiAgICB0aGlzLnMgPSBuZXdfZmxvYXRfbihbRW5jb2Rlci5TQk1BWF9zLCAzXSk7XG5cbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdGhpcy5hc3NpZ24gPSBmdW5jdGlvbiAoaWlpX3BzeV94bWluKSB7XG4gICAgICAgIFN5c3RlbS5hcnJheWNvcHkoaWlpX3BzeV94bWluLmwsIDAsIHNlbGYubCwgMCwgRW5jb2Rlci5TQk1BWF9sKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBFbmNvZGVyLlNCTUFYX3M7IGkrKykge1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCAzOyBqKyspIHtcbiAgICAgICAgICAgICAgICBzZWxmLnNbaV1bal0gPSBpaWlfcHN5X3htaW4uc1tpXVtqXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuXG5cbi8vcGFja2FnZSBtcDM7XG5cbi8qKlxuICogVmFyaWFibGVzIHVzZWQgZm9yIC0tbnNwc3l0dW5lXG4gKlxuICogQGF1dGhvciBLZW5cbiAqXG4gKi9cbmZ1bmN0aW9uIE5zUHN5KCkge1xuICAgIHRoaXMubGFzdF9lbl9zdWJzaG9ydCA9IG5ld19mbG9hdF9uKFs0LCA5XSk7XG4gICAgdGhpcy5sYXN0QXR0YWNrcyA9IG5ld19pbnQoNCk7XG4gICAgdGhpcy5wZWZpcmJ1ZiA9IG5ld19mbG9hdCgxOSk7XG4gICAgdGhpcy5sb25nZmFjdCA9IG5ld19mbG9hdChFbmNvZGVyLlNCTUFYX2wpO1xuICAgIHRoaXMuc2hvcnRmYWN0ID0gbmV3X2Zsb2F0KEVuY29kZXIuU0JNQVhfcyk7XG5cbiAgICAvKipcbiAgICAgKiBzaG9ydCBibG9jayB0dW5pbmdcbiAgICAgKi9cbiAgICB0aGlzLmF0dGFja3RocmUgPSAwLjtcbiAgICB0aGlzLmF0dGFja3RocmVfcyA9IDAuO1xufVxuXG5cblxuXG5MYW1lSW50ZXJuYWxGbGFncy5NRlNJWkUgPSAoMyAqIDExNTIgKyBFbmNvZGVyLkVOQ0RFTEFZIC0gRW5jb2Rlci5NRENUREVMQVkpO1xuTGFtZUludGVybmFsRmxhZ3MuTUFYX0hFQURFUl9CVUYgPSAyNTY7XG5MYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfQ0hBTk5FTCA9IDQwOTU7XG5MYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfR1JBTlVMRSA9IDc2ODA7XG5MYW1lSW50ZXJuYWxGbGFncy5CUEMgPSAzMjA7XG5cbmZ1bmN0aW9uIExhbWVJbnRlcm5hbEZsYWdzKCkge1xuICAgIHZhciBNQVhfSEVBREVSX0xFTiA9IDQwO1xuXG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKiBpbnRlcm5hbCB2YXJpYWJsZXMgTk9UIHNldCBieSBjYWxsaW5nIHByb2dyYW0sIGFuZCBzaG91bGQgbm90IGJlICpcbiAgICAgKiBtb2RpZmllZCBieSB0aGUgY2FsbGluZyBwcm9ncmFtICpcbiAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAvKipcbiAgICAgKiBTb21lIHJlbWFya3MgdG8gdGhlIENsYXNzX0lEIGZpZWxkOiBUaGUgQ2xhc3MgSUQgaXMgYW4gSWRlbnRpZmllciBmb3IgYVxuICAgICAqIHBvaW50ZXIgdG8gdGhpcyBzdHJ1Y3QuIEl0IGlzIHZlcnkgdW5saWtlbHkgdGhhdCBhIHBvaW50ZXIgdG9cbiAgICAgKiBsYW1lX2dsb2JhbF9mbGFncyBoYXMgdGhlIHNhbWUgMzIgYml0cyBpbiBpdCdzIHN0cnVjdHVyZSAobGFyZ2UgYW5kIG90aGVyXG4gICAgICogc3BlY2lhbCBwcm9wZXJ0aWVzLCBmb3IgaW5zdGFuY2UgcHJpbWUpLlxuICAgICAqXG4gICAgICogVG8gdGVzdCB0aGF0IHRoZSBzdHJ1Y3R1cmUgaXMgcmlnaHQgYW5kIGluaXRpYWxpemVkLCB1c2U6IGlmICggZ2ZjIC5cbiAgICAgKiBDbGFzc19JRCA9PSBMQU1FX0lEICkgLi4uIE90aGVyIHJlbWFyazogSWYgeW91IHNldCBhIGZsYWcgdG8gMCBmb3IgdW5pbml0XG4gICAgICogZGF0YSBhbmQgMSBmb3IgaW5pdCBkYXRhLCB0aGUgcmlnaHQgdGVzdCBzaG91bGQgYmUgXCJpZiAoZmxhZyA9PSAxKVwiIGFuZFxuICAgICAqIE5PVCBcImlmIChmbGFnKVwiLiBVbmludGVuZGVkIG1vZGlmaWNhdGlvbiBvZiB0aGlzIGVsZW1lbnQgd2lsbCBiZVxuICAgICAqIG90aGVyd2lzZSBtaXNpbnRlcnByZXRlZCBhcyBhbiBpbml0LlxuICAgICAqL1xuICAgIHRoaXMuQ2xhc3NfSUQgPSAwO1xuXG4gICAgdGhpcy5sYW1lX2VuY29kZV9mcmFtZV9pbml0ID0gMDtcbiAgICB0aGlzLml0ZXJhdGlvbl9pbml0X2luaXQgPSAwO1xuICAgIHRoaXMuZmlsbF9idWZmZXJfcmVzYW1wbGVfaW5pdCA9IDA7XG5cbiAgICAvL3B1YmxpYyBmbG9hdCBtZmJ1ZltdW10gPSBuZXcgZmxvYXRbMl1bTUZTSVpFXTtcbiAgICB0aGlzLm1mYnVmID0gbmV3X2Zsb2F0X24oWzIsIExhbWVJbnRlcm5hbEZsYWdzLk1GU0laRV0pO1xuXG4gICAgLyoqXG4gICAgICogZ3JhbnVsZXMgcGVyIGZyYW1lXG4gICAgICovXG4gICAgdGhpcy5tb2RlX2dyID0gMDtcbiAgICAvKipcbiAgICAgKiBudW1iZXIgb2YgY2hhbm5lbHMgaW4gdGhlIGlucHV0IGRhdGEgc3RyZWFtIChQQ00gb3IgZGVjb2RlZCBQQ00pXG4gICAgICovXG4gICAgdGhpcy5jaGFubmVsc19pbiA9IDA7XG4gICAgLyoqXG4gICAgICogbnVtYmVyIG9mIGNoYW5uZWxzIGluIHRoZSBvdXRwdXQgZGF0YSBzdHJlYW0gKG5vdCB1c2VkIGZvciBkZWNvZGluZylcbiAgICAgKi9cbiAgICB0aGlzLmNoYW5uZWxzX291dCA9IDA7XG4gICAgLyoqXG4gICAgICogaW5wdXRfc2FtcF9yYXRlL291dHB1dF9zYW1wX3JhdGVcbiAgICAgKi9cbiAgICAgICAgLy9wdWJsaWMgZG91YmxlIHJlc2FtcGxlX3JhdGlvO1xuICAgIHRoaXMucmVzYW1wbGVfcmF0aW8gPSAwLjtcblxuICAgIHRoaXMubWZfc2FtcGxlc190b19lbmNvZGUgPSAwO1xuICAgIHRoaXMubWZfc2l6ZSA9IDA7XG4gICAgLyoqXG4gICAgICogbWluIGJpdHJhdGUgaW5kZXhcbiAgICAgKi9cbiAgICB0aGlzLlZCUl9taW5fYml0cmF0ZSA9IDA7XG4gICAgLyoqXG4gICAgICogbWF4IGJpdHJhdGUgaW5kZXhcbiAgICAgKi9cbiAgICB0aGlzLlZCUl9tYXhfYml0cmF0ZSA9IDA7XG4gICAgdGhpcy5iaXRyYXRlX2luZGV4ID0gMDtcbiAgICB0aGlzLnNhbXBsZXJhdGVfaW5kZXggPSAwO1xuICAgIHRoaXMubW9kZV9leHQgPSAwO1xuXG4gICAgLyogbG93cGFzcyBhbmQgaGlnaHBhc3MgZmlsdGVyIGNvbnRyb2wgKi9cbiAgICAvKipcbiAgICAgKiBub3JtYWxpemVkIGZyZXF1ZW5jeSBib3VuZHMgb2YgcGFzc2JhbmRcbiAgICAgKi9cbiAgICB0aGlzLmxvd3Bhc3MxID0gMC47XG4gICAgdGhpcy5sb3dwYXNzMiA9IDAuO1xuICAgIC8qKlxuICAgICAqIG5vcm1hbGl6ZWQgZnJlcXVlbmN5IGJvdW5kcyBvZiBwYXNzYmFuZFxuICAgICAqL1xuICAgIHRoaXMuaGlnaHBhc3MxID0gMC47XG4gICAgdGhpcy5oaWdocGFzczIgPSAwLjtcblxuICAgIC8qKlxuICAgICAqIDAgPSBub25lIDEgPSBJU08gQUFDIG1vZGVsIDIgPSBhbGxvdyBzY2FsZWZhY19zZWxlY3Q9MVxuICAgICAqL1xuICAgIHRoaXMubm9pc2Vfc2hhcGluZyA9IDA7XG5cbiAgICAvKipcbiAgICAgKiAwID0gSVNPIG1vZGVsOiBhbXBsaWZ5IGFsbCBkaXN0b3J0ZWQgYmFuZHM8QlI+XG4gICAgICogMSA9IGFtcGxpZnkgd2l0aGluIDUwJSBvZiBtYXggKG9uIGRiIHNjYWxlKTxCUj5cbiAgICAgKiAyID0gYW1wbGlmeSBvbmx5IG1vc3QgZGlzdG9ydGVkIGJhbmQ8QlI+XG4gICAgICogMyA9IG1ldGhvZCAxIGFuZCByZWZpbmUgd2l0aCBtZXRob2QgMjxCUj5cbiAgICAgKi9cbiAgICB0aGlzLm5vaXNlX3NoYXBpbmdfYW1wID0gMDtcbiAgICAvKipcbiAgICAgKiAwID0gbm8gc3Vic3RlcDxCUj5cbiAgICAgKiAxID0gdXNlIHN1YnN0ZXAgc2hhcGluZyBhdCBsYXN0IHN0ZXAoVkJSIG9ubHkpPEJSPlxuICAgICAqIChub3QgaW1wbGVtZW50ZWQgeWV0KTxCUj5cbiAgICAgKiAyID0gdXNlIHN1YnN0ZXAgaW5zaWRlIGxvb3A8QlI+XG4gICAgICogMyA9IHVzZSBzdWJzdGVwIGluc2lkZSBsb29wIGFuZCBsYXN0IHN0ZXA8QlI+XG4gICAgICovXG4gICAgdGhpcy5zdWJzdGVwX3NoYXBpbmcgPSAwO1xuXG4gICAgLyoqXG4gICAgICogMSA9IGdwc3ljaG8uIDAgPSBub25lXG4gICAgICovXG4gICAgdGhpcy5wc3ltb2RlbCA9IDA7XG4gICAgLyoqXG4gICAgICogMCA9IHN0b3AgYXQgb3Zlcj0wLCBhbGwgc2NhbGVmYWNzIGFtcGxpZmllZCBvcjxCUj5cbiAgICAgKiBhIHNjYWxlZmFjIGhhcyByZWFjaGVkIG1heCB2YWx1ZTxCUj5cbiAgICAgKiAxID0gc3RvcCB3aGVuIGFsbCBzY2FsZWZhY3MgYW1wbGlmaWVkIG9yIGEgc2NhbGVmYWMgaGFzIHJlYWNoZWQgbWF4IHZhbHVlPEJSPlxuICAgICAqIDIgPSBzdG9wIHdoZW4gYWxsIHNjYWxlZmFjcyBhbXBsaWZpZWRcbiAgICAgKi9cbiAgICB0aGlzLm5vaXNlX3NoYXBpbmdfc3RvcCA9IDA7XG5cbiAgICAvKipcbiAgICAgKiAwID0gbm8sIDEgPSB5ZXNcbiAgICAgKi9cbiAgICB0aGlzLnN1YmJsb2NrX2dhaW4gPSAwO1xuICAgIC8qKlxuICAgICAqIDAgPSBuby4gMT1vdXRzaWRlIGxvb3AgMj1pbnNpZGUgbG9vcChzbG93KVxuICAgICAqL1xuICAgIHRoaXMudXNlX2Jlc3RfaHVmZm1hbiA9IDA7XG5cbiAgICAvKipcbiAgICAgKiAwID0gc3RvcCBlYXJseSBhZnRlciAwIGRpc3RvcnRpb24gZm91bmQuIDEgPSBmdWxsIHNlYXJjaFxuICAgICAqL1xuICAgIHRoaXMuZnVsbF9vdXRlcl9sb29wID0gMDtcblxuICAgIC8vcHVibGljIElJSVNpZGVJbmZvIGwzX3NpZGUgPSBuZXcgSUlJU2lkZUluZm8oKTtcbiAgICB0aGlzLmwzX3NpZGUgPSBuZXcgSUlJU2lkZUluZm8oKTtcbiAgICB0aGlzLm1zX3JhdGlvID0gbmV3X2Zsb2F0KDIpO1xuXG4gICAgLyogdXNlZCBmb3IgcGFkZGluZyAqL1xuICAgIC8qKlxuICAgICAqIHBhZGRpbmcgZm9yIHRoZSBjdXJyZW50IGZyYW1lP1xuICAgICAqL1xuICAgIHRoaXMucGFkZGluZyA9IDA7XG4gICAgdGhpcy5mcmFjX1NwRiA9IDA7XG4gICAgdGhpcy5zbG90X2xhZyA9IDA7XG5cbiAgICAvKipcbiAgICAgKiBvcHRpb25hbCBJRDMgdGFnc1xuICAgICAqL1xuICAgICAgICAvL3B1YmxpYyBJRDNUYWdTcGVjIHRhZ19zcGVjO1xuICAgIHRoaXMudGFnX3NwZWMgPSBudWxsO1xuICAgIHRoaXMubk11c2ljQ1JDID0gMDtcblxuICAgIC8qIHZhcmlhYmxlcyB1c2VkIGJ5IFF1YW50aXplICovXG4gICAgLy9wdWJsaWMgaW50IE9sZFZhbHVlW10gPSBuZXcgaW50WzJdO1xuICAgIHRoaXMuT2xkVmFsdWUgPSBuZXdfaW50KDIpO1xuICAgIC8vcHVibGljIGludCBDdXJyZW50U3RlcFtdID0gbmV3IGludFsyXTtcbiAgICB0aGlzLkN1cnJlbnRTdGVwID0gbmV3X2ludCgyKTtcblxuICAgIHRoaXMubWFza2luZ19sb3dlciA9IDAuO1xuICAgIC8vcHVibGljIGludCBidl9zY2ZbXSA9IG5ldyBpbnRbNTc2XTtcbiAgICB0aGlzLmJ2X3NjZiA9IG5ld19pbnQoNTc2KTtcbiAgICAvL3B1YmxpYyBpbnQgcHNldWRvaGFsZltdID0gbmV3IGludFtMM1NpZGUuU0ZCTUFYXTtcbiAgICB0aGlzLnBzZXVkb2hhbGYgPSBuZXdfaW50KEwzU2lkZS5TRkJNQVgpO1xuXG4gICAgLyoqXG4gICAgICogd2lsbCBiZSBzZXQgaW4gbGFtZV9pbml0X3BhcmFtc1xuICAgICAqL1xuICAgIHRoaXMuc2ZiMjFfZXh0cmEgPSBmYWxzZTtcblxuICAgIC8qIEJQQyA9IG1heGltdW0gbnVtYmVyIG9mIGZpbHRlciBjb252b2x1dGlvbiB3aW5kb3dzIHRvIHByZWNvbXB1dGUgKi9cbiAgICAvL3B1YmxpYyBmbG9hdFtdW10gaW5idWZfb2xkID0gbmV3IGZsb2F0WzJdW107XG4gICAgdGhpcy5pbmJ1Zl9vbGQgPSBuZXcgQXJyYXkoMik7XG4gICAgLy9wdWJsaWMgZmxvYXRbXVtdIGJsYWNrZmlsdCA9IG5ldyBmbG9hdFsyICogQlBDICsgMV1bXTtcbiAgICB0aGlzLmJsYWNrZmlsdCA9IG5ldyBBcnJheSgyICogTGFtZUludGVybmFsRmxhZ3MuQlBDICsgMSk7XG4gICAgLy9wdWJsaWMgZG91YmxlIGl0aW1lW10gPSBuZXcgZG91YmxlWzJdO1xuICAgIHRoaXMuaXRpbWUgPSBuZXdfZG91YmxlKDIpO1xuICAgIHRoaXMuc2lkZWluZm9fbGVuID0gMDtcblxuICAgIC8qIHZhcmlhYmxlcyBmb3IgbmV3bWRjdC5jICovXG4gICAgLy9wdWJsaWMgZmxvYXQgc2Jfc2FtcGxlW11bXVtdW10gPSBuZXcgZmxvYXRbMl1bMl1bMThdW0VuY29kZXIuU0JMSU1JVF07XG4gICAgdGhpcy5zYl9zYW1wbGUgPSBuZXdfZmxvYXRfbihbMiwgMiwgMTgsIEVuY29kZXIuU0JMSU1JVF0pO1xuICAgIHRoaXMuYW1wX2ZpbHRlciA9IG5ld19mbG9hdCgzMik7XG5cbiAgICAvKiB2YXJpYWJsZXMgZm9yIEJpdFN0cmVhbSAqL1xuXG4gICAgLyoqXG4gICAgICogPFBSRT5cbiAgICAgKiBtcGVnMTogYnVmZmVyPTUxMSBieXRlcyAgc21hbGxlc3QgZnJhbWU6IDk2LTM4KHNpZGVpbmZvKT01OFxuICAgICAqIG1heCBudW1iZXIgb2YgZnJhbWVzIGluIHJlc2Vydm9pcjogIDhcbiAgICAgKiBtcGVnMjogYnVmZmVyPTI1NSBieXRlcy4gIHNtYWxsZXN0IGZyYW1lOiAyNC0yM2J5dGVzPTFcbiAgICAgKiB3aXRoIFZCUiwgaWYgeW91IGFyZSBlbmNvZGluZyBhbGwgc2lsZW5jZSwgaXQgaXMgcG9zc2libGUgdG9cbiAgICAgKiBoYXZlIDhrYnMvMjRraHogZnJhbWVzIHdpdGggMWJ5dGUgb2YgZGF0YSBlYWNoLCB3aGljaCBtZWFucyB3ZSBuZWVkXG4gICAgICogdG8gYnVmZmVyIHVwIHRvIDI1NSBoZWFkZXJzIVxuICAgICAqIDwvUFJFPlxuICAgICAqL1xuICAgIC8qKlxuICAgICAqIGFsc28sIG1heF9oZWFkZXJfYnVmIGhhcyB0byBiZSBhIHBvd2VyIG9mIHR3b1xuICAgICAqL1xuICAgIC8qKlxuICAgICAqIG1heCBzaXplIG9mIGhlYWRlciBpcyAzOFxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gSGVhZGVyKCkge1xuICAgICAgICB0aGlzLndyaXRlX3RpbWluZyA9IDA7XG4gICAgICAgIHRoaXMucHRyID0gMDtcbiAgICAgICAgLy9wdWJsaWMgYnl0ZSBidWZbXSA9IG5ldyBieXRlW01BWF9IRUFERVJfTEVOXTtcbiAgICAgICAgdGhpcy5idWYgPSBuZXdfYnl0ZShNQVhfSEVBREVSX0xFTik7XG4gICAgfVxuXG4gICAgdGhpcy5oZWFkZXIgPSBuZXcgQXJyYXkoTGFtZUludGVybmFsRmxhZ3MuTUFYX0hFQURFUl9CVUYpO1xuXG4gICAgdGhpcy5oX3B0ciA9IDA7XG4gICAgdGhpcy53X3B0ciA9IDA7XG4gICAgdGhpcy5hbmNpbGxhcnlfZmxhZyA9IDA7XG5cbiAgICAvKiB2YXJpYWJsZXMgZm9yIFJlc2Vydm9pciAqL1xuICAgIC8qKlxuICAgICAqIGluIGJpdHNcbiAgICAgKi9cbiAgICB0aGlzLlJlc3ZTaXplID0gMDtcbiAgICAvKipcbiAgICAgKiBpbiBiaXRzXG4gICAgICovXG4gICAgdGhpcy5SZXN2TWF4ID0gMDtcblxuICAgIC8vcHVibGljIFNjYWxlRmFjIHNjYWxlZmFjX2JhbmQgPSBuZXcgU2NhbGVGYWMoKTtcbiAgICB0aGlzLnNjYWxlZmFjX2JhbmQgPSBuZXcgU2NhbGVGYWMoKTtcblxuICAgIC8qIGRhYSBmcm9tIFBzeU1vZGVsICovXG4gICAgLyogVGhlIHN0YXRpYyB2YXJpYWJsZXMgXCJyXCIsIFwicGhpX3NhdlwiLCBcIm5ld1wiLCBcIm9sZFwiIGFuZCBcIm9sZGVzdFwiIGhhdmUgKi9cbiAgICAvKiB0byBiZSByZW1lbWJlcmVkIGZvciB0aGUgdW5wcmVkaWN0YWJpbGl0eSBtZWFzdXJlLiBGb3IgXCJyXCIgYW5kICovXG4gICAgLyogXCJwaGlfc2F2XCIsIHRoZSBmaXJzdCBpbmRleCBmcm9tIHRoZSBsZWZ0IGlzIHRoZSBjaGFubmVsIHNlbGVjdCBhbmQgKi9cbiAgICAvKiB0aGUgc2Vjb25kIGluZGV4IGlzIHRoZSBcImFnZVwiIG9mIHRoZSBkYXRhLiAqL1xuICAgIHRoaXMubWludmFsX2wgPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMpO1xuICAgIHRoaXMubWludmFsX3MgPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMpO1xuICAgIHRoaXMubmJfMSA9IG5ld19mbG9hdF9uKFs0LCBFbmNvZGVyLkNCQU5EU10pO1xuICAgIHRoaXMubmJfMiA9IG5ld19mbG9hdF9uKFs0LCBFbmNvZGVyLkNCQU5EU10pO1xuICAgIHRoaXMubmJfczEgPSBuZXdfZmxvYXRfbihbNCwgRW5jb2Rlci5DQkFORFNdKTtcbiAgICB0aGlzLm5iX3MyID0gbmV3X2Zsb2F0X24oWzQsIEVuY29kZXIuQ0JBTkRTXSk7XG4gICAgdGhpcy5zM19zcyA9IG51bGw7XG4gICAgdGhpcy5zM19sbCA9IG51bGw7XG4gICAgdGhpcy5kZWNheSA9IDAuO1xuXG4gICAgLy9wdWJsaWMgSUlJX3BzeV94bWluW10gdGhtID0gbmV3IElJSV9wc3lfeG1pbls0XTtcbiAgICAvL3B1YmxpYyBJSUlfcHN5X3htaW5bXSBlbiA9IG5ldyBJSUlfcHN5X3htaW5bNF07XG4gICAgdGhpcy50aG0gPSBuZXcgQXJyYXkoNCk7XG4gICAgdGhpcy5lbiA9IG5ldyBBcnJheSg0KTtcblxuICAgIC8qKlxuICAgICAqIGZmdCBhbmQgZW5lcmd5IGNhbGN1bGF0aW9uXG4gICAgICovXG4gICAgdGhpcy50b3RfZW5lciA9IG5ld19mbG9hdCg0KTtcblxuICAgIC8qIGxvdWRuZXNzIGNhbGN1bGF0aW9uIChmb3IgYWRhcHRpdmUgdGhyZXNob2xkIG9mIGhlYXJpbmcpICovXG4gICAgLyoqXG4gICAgICogbG91ZG5lc3NeMiBhcHByb3guIHBlciBncmFudWxlIGFuZCBjaGFubmVsXG4gICAgICovXG4gICAgdGhpcy5sb3VkbmVzc19zcSA9IG5ld19mbG9hdF9uKFsyLCAyXSk7XG4gICAgLyoqXG4gICAgICogYWNjb3VudCBmb3IgZ3JhbnVsZSBkZWxheSBvZiBMM3BzeWNob19hbmFsXG4gICAgICovXG4gICAgdGhpcy5sb3VkbmVzc19zcV9zYXZlID0gbmV3X2Zsb2F0KDIpO1xuXG4gICAgLyoqXG4gICAgICogU2NhbGUgRmFjdG9yIEJhbmRzXG4gICAgICovXG4gICAgdGhpcy5tbGRfbCA9IG5ld19mbG9hdChFbmNvZGVyLlNCTUFYX2wpO1xuICAgIHRoaXMubWxkX3MgPSBuZXdfZmxvYXQoRW5jb2Rlci5TQk1BWF9zKTtcbiAgICB0aGlzLmJtX2wgPSBuZXdfaW50KEVuY29kZXIuU0JNQVhfbCk7XG4gICAgdGhpcy5ib19sID0gbmV3X2ludChFbmNvZGVyLlNCTUFYX2wpO1xuICAgIHRoaXMuYm1fcyA9IG5ld19pbnQoRW5jb2Rlci5TQk1BWF9zKTtcbiAgICB0aGlzLmJvX3MgPSBuZXdfaW50KEVuY29kZXIuU0JNQVhfcyk7XG4gICAgdGhpcy5ucGFydF9sID0gMDtcbiAgICB0aGlzLm5wYXJ0X3MgPSAwO1xuXG4gICAgdGhpcy5zM2luZCA9IG5ld19pbnRfbihbRW5jb2Rlci5DQkFORFMsIDJdKTtcbiAgICB0aGlzLnMzaW5kX3MgPSBuZXdfaW50X24oW0VuY29kZXIuQ0JBTkRTLCAyXSk7XG5cbiAgICB0aGlzLm51bWxpbmVzX3MgPSBuZXdfaW50KEVuY29kZXIuQ0JBTkRTKTtcbiAgICB0aGlzLm51bWxpbmVzX2wgPSBuZXdfaW50KEVuY29kZXIuQ0JBTkRTKTtcbiAgICB0aGlzLnJudW1saW5lc19sID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTKTtcbiAgICB0aGlzLm1sZF9jYl9sID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTKTtcbiAgICB0aGlzLm1sZF9jYl9zID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTKTtcbiAgICB0aGlzLm51bWxpbmVzX3NfbnVtMSA9IDA7XG4gICAgdGhpcy5udW1saW5lc19sX251bTEgPSAwO1xuXG4gICAgLyogcmF0aW9zICovXG4gICAgdGhpcy5wZSA9IG5ld19mbG9hdCg0KTtcbiAgICB0aGlzLm1zX3JhdGlvX3Nfb2xkID0gMC47XG4gICAgdGhpcy5tc19yYXRpb19sX29sZCA9IDAuO1xuICAgIHRoaXMubXNfZW5lcl9yYXRpb19vbGQgPSAwLjtcblxuICAgIC8qKlxuICAgICAqIGJsb2NrIHR5cGVcbiAgICAgKi9cbiAgICB0aGlzLmJsb2NrdHlwZV9vbGQgPSBuZXdfaW50KDIpO1xuXG4gICAgLyoqXG4gICAgICogdmFyaWFibGVzIHVzZWQgZm9yIC0tbnNwc3l0dW5lXG4gICAgICovXG4gICAgdGhpcy5uc1BzeSA9IG5ldyBOc1BzeSgpO1xuXG4gICAgLyoqXG4gICAgICogdXNlZCBmb3IgWGluZyBWQlIgaGVhZGVyXG4gICAgICovXG4gICAgdGhpcy5WQlJfc2Vla190YWJsZSA9IG5ldyBWQlJTZWVrSW5mbygpO1xuXG4gICAgLyoqXG4gICAgICogYWxsIEFUSCByZWxhdGVkIHN0dWZmXG4gICAgICovXG4gICAgICAgIC8vcHVibGljIEFUSCBBVEg7XG4gICAgdGhpcy5BVEggPSBudWxsO1xuXG4gICAgdGhpcy5QU1kgPSBudWxsO1xuXG4gICAgdGhpcy5ub2dhcF90b3RhbCA9IDA7XG4gICAgdGhpcy5ub2dhcF9jdXJyZW50ID0gMDtcblxuICAgIC8qIFJlcGxheUdhaW4gKi9cbiAgICB0aGlzLmRlY29kZV9vbl90aGVfZmx5ID0gdHJ1ZTtcbiAgICB0aGlzLmZpbmRSZXBsYXlHYWluID0gdHJ1ZTtcbiAgICB0aGlzLmZpbmRQZWFrU2FtcGxlID0gdHJ1ZTtcbiAgICB0aGlzLlBlYWtTYW1wbGUgPSAwLjtcbiAgICB0aGlzLlJhZGlvR2FpbiA9IDA7XG4gICAgdGhpcy5BdWRpb3BoaWxlR2FpbiA9IDA7XG4gICAgLy9wdWJsaWMgUmVwbGF5R2FpbiByZ2RhdGE7XG4gICAgdGhpcy5yZ2RhdGEgPSBudWxsO1xuXG4gICAgLyoqXG4gICAgICogZ2FpbiBjaGFuZ2UgcmVxdWlyZWQgZm9yIHByZXZlbnRpbmcgY2xpcHBpbmdcbiAgICAgKi9cbiAgICB0aGlzLm5vY2xpcEdhaW5DaGFuZ2UgPSAwO1xuICAgIC8qKlxuICAgICAqIHVzZXItc3BlY2lmaWVkIHNjYWxlIGZhY3RvciByZXF1aXJlZCBmb3IgcHJldmVudGluZyBjbGlwcGluZ1xuICAgICAqL1xuICAgIHRoaXMubm9jbGlwU2NhbGUgPSAwLjtcblxuICAgIC8qIHNpbXBsZSBzdGF0aXN0aWNzICovXG4gICAgdGhpcy5iaXRyYXRlX3N0ZXJlb01vZGVfSGlzdCA9IG5ld19pbnRfbihbMTYsIDQgKyAxXSk7XG4gICAgLyoqXG4gICAgICogbm9ybS9zdGFydC9zaG9ydC9zdG9wL21peGVkKHNob3J0KS9zdW1cbiAgICAgKi9cbiAgICB0aGlzLmJpdHJhdGVfYmxvY2tUeXBlX0hpc3QgPSBuZXdfaW50X24oWzE2LCA0ICsgMSArIDFdKTtcblxuICAgIC8vcHVibGljIFBsb3R0aW5nRGF0YSBwaW5mbztcbiAgICAvL3B1YmxpYyBNUEdMaWIubXBzdHJfdGFnIGhpcDtcbiAgICB0aGlzLnBpbmZvID0gbnVsbDtcbiAgICB0aGlzLmhpcCA9IG51bGw7XG5cbiAgICB0aGlzLmluX2J1ZmZlcl9uc2FtcGxlcyA9IDA7XG4gICAgLy9wdWJsaWMgZmxvYXRbXSBpbl9idWZmZXJfMDtcbiAgICAvL3B1YmxpYyBmbG9hdFtdIGluX2J1ZmZlcl8xO1xuICAgIHRoaXMuaW5fYnVmZmVyXzAgPSBudWxsO1xuICAgIHRoaXMuaW5fYnVmZmVyXzEgPSBudWxsO1xuXG4gICAgLy9wdWJsaWMgSUl0ZXJhdGlvbkxvb3AgaXRlcmF0aW9uX2xvb3A7XG4gICAgdGhpcy5pdGVyYXRpb25fbG9vcCA9IG51bGw7XG5cbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcy5lbltpXSA9IG5ldyBJSUlfcHN5X3htaW4oKTtcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnRobS5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLnRobVtpXSA9IG5ldyBJSUlfcHN5X3htaW4oKTtcbiAgICB9XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmhlYWRlci5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLmhlYWRlcltpXSA9IG5ldyBIZWFkZXIoKTtcbiAgICB9XG5cbn1cblxuXG5cbmZ1bmN0aW9uIEZGVCgpIHtcblxuICAgIHZhciB3aW5kb3cgPSBuZXdfZmxvYXQoRW5jb2Rlci5CTEtTSVpFKTtcbiAgICB2YXIgd2luZG93X3MgPSBuZXdfZmxvYXQoRW5jb2Rlci5CTEtTSVpFX3MgLyAyKTtcblxuICAgIHZhciBjb3N0YWIgPSBbXG4gICAgICAgIDkuMjM4Nzk1MzI1MTEyODY3ZS0wMSwgMy44MjY4MzQzMjM2NTA4OThlLTAxLFxuICAgICAgICA5Ljk1MTg0NzI2NjcyMTk2OWUtMDEsIDkuODAxNzE0MDMyOTU2MDYwZS0wMixcbiAgICAgICAgOS45OTY5ODgxODY5NjIwNDJlLTAxLCAyLjQ1NDEyMjg1MjI5MTIyOWUtMDIsXG4gICAgICAgIDkuOTk5ODExNzUyODI2MDExZS0wMSwgNi4xMzU4ODQ2NDkxNTQ0NzVlLTAzXG4gICAgXTtcblxuICAgIGZ1bmN0aW9uIGZodChmeiwgZnpQb3MsIG4pIHtcbiAgICAgICAgdmFyIHRyaSA9IDA7XG4gICAgICAgIHZhciBrNDtcbiAgICAgICAgdmFyIGZpO1xuICAgICAgICB2YXIgZ2k7XG5cbiAgICAgICAgbiA8PD0gMTtcbiAgICAgICAgLyogdG8gZ2V0IEJMS1NJWkUsIGJlY2F1c2Ugb2YgM0ROb3chIEFTTSByb3V0aW5lICovXG4gICAgICAgIHZhciBmbiA9IGZ6UG9zICsgbjtcbiAgICAgICAgazQgPSA0O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICB2YXIgczEsIGMxO1xuICAgICAgICAgICAgdmFyIGksIGsxLCBrMiwgazMsIGt4O1xuICAgICAgICAgICAga3ggPSBrNCA+PiAxO1xuICAgICAgICAgICAgazEgPSBrNDtcbiAgICAgICAgICAgIGsyID0gazQgPDwgMTtcbiAgICAgICAgICAgIGszID0gazIgKyBrMTtcbiAgICAgICAgICAgIGs0ID0gazIgPDwgMTtcbiAgICAgICAgICAgIGZpID0gZnpQb3M7XG4gICAgICAgICAgICBnaSA9IGZpICsga3g7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgdmFyIGYwLCBmMSwgZjIsIGYzO1xuICAgICAgICAgICAgICAgIGYxID0gZnpbZmkgKyAwXSAtIGZ6W2ZpICsgazFdO1xuICAgICAgICAgICAgICAgIGYwID0gZnpbZmkgKyAwXSArIGZ6W2ZpICsgazFdO1xuICAgICAgICAgICAgICAgIGYzID0gZnpbZmkgKyBrMl0gLSBmeltmaSArIGszXTtcbiAgICAgICAgICAgICAgICBmMiA9IGZ6W2ZpICsgazJdICsgZnpbZmkgKyBrM107XG4gICAgICAgICAgICAgICAgZnpbZmkgKyBrMl0gPSBmMCAtIGYyO1xuICAgICAgICAgICAgICAgIGZ6W2ZpICsgMF0gPSBmMCArIGYyO1xuICAgICAgICAgICAgICAgIGZ6W2ZpICsgazNdID0gZjEgLSBmMztcbiAgICAgICAgICAgICAgICBmeltmaSArIGsxXSA9IGYxICsgZjM7XG4gICAgICAgICAgICAgICAgZjEgPSBmeltnaSArIDBdIC0gZnpbZ2kgKyBrMV07XG4gICAgICAgICAgICAgICAgZjAgPSBmeltnaSArIDBdICsgZnpbZ2kgKyBrMV07XG4gICAgICAgICAgICAgICAgZjMgPSAoVXRpbC5TUVJUMiAqIGZ6W2dpICsgazNdKTtcbiAgICAgICAgICAgICAgICBmMiA9IChVdGlsLlNRUlQyICogZnpbZ2kgKyBrMl0pO1xuICAgICAgICAgICAgICAgIGZ6W2dpICsgazJdID0gZjAgLSBmMjtcbiAgICAgICAgICAgICAgICBmeltnaSArIDBdID0gZjAgKyBmMjtcbiAgICAgICAgICAgICAgICBmeltnaSArIGszXSA9IGYxIC0gZjM7XG4gICAgICAgICAgICAgICAgZnpbZ2kgKyBrMV0gPSBmMSArIGYzO1xuICAgICAgICAgICAgICAgIGdpICs9IGs0O1xuICAgICAgICAgICAgICAgIGZpICs9IGs0O1xuICAgICAgICAgICAgfSB3aGlsZSAoZmkgPCBmbik7XG4gICAgICAgICAgICBjMSA9IGNvc3RhYlt0cmkgKyAwXTtcbiAgICAgICAgICAgIHMxID0gY29zdGFiW3RyaSArIDFdO1xuICAgICAgICAgICAgZm9yIChpID0gMTsgaSA8IGt4OyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgYzIsIHMyO1xuICAgICAgICAgICAgICAgIGMyID0gMSAtICgyICogczEpICogczE7XG4gICAgICAgICAgICAgICAgczIgPSAoMiAqIHMxKSAqIGMxO1xuICAgICAgICAgICAgICAgIGZpID0gZnpQb3MgKyBpO1xuICAgICAgICAgICAgICAgIGdpID0gZnpQb3MgKyBrMSAtIGk7XG4gICAgICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYSwgYiwgZzAsIGYwLCBmMSwgZzEsIGYyLCBnMiwgZjMsIGczO1xuICAgICAgICAgICAgICAgICAgICBiID0gczIgKiBmeltmaSArIGsxXSAtIGMyICogZnpbZ2kgKyBrMV07XG4gICAgICAgICAgICAgICAgICAgIGEgPSBjMiAqIGZ6W2ZpICsgazFdICsgczIgKiBmeltnaSArIGsxXTtcbiAgICAgICAgICAgICAgICAgICAgZjEgPSBmeltmaSArIDBdIC0gYTtcbiAgICAgICAgICAgICAgICAgICAgZjAgPSBmeltmaSArIDBdICsgYTtcbiAgICAgICAgICAgICAgICAgICAgZzEgPSBmeltnaSArIDBdIC0gYjtcbiAgICAgICAgICAgICAgICAgICAgZzAgPSBmeltnaSArIDBdICsgYjtcbiAgICAgICAgICAgICAgICAgICAgYiA9IHMyICogZnpbZmkgKyBrM10gLSBjMiAqIGZ6W2dpICsgazNdO1xuICAgICAgICAgICAgICAgICAgICBhID0gYzIgKiBmeltmaSArIGszXSArIHMyICogZnpbZ2kgKyBrM107XG4gICAgICAgICAgICAgICAgICAgIGYzID0gZnpbZmkgKyBrMl0gLSBhO1xuICAgICAgICAgICAgICAgICAgICBmMiA9IGZ6W2ZpICsgazJdICsgYTtcbiAgICAgICAgICAgICAgICAgICAgZzMgPSBmeltnaSArIGsyXSAtIGI7XG4gICAgICAgICAgICAgICAgICAgIGcyID0gZnpbZ2kgKyBrMl0gKyBiO1xuICAgICAgICAgICAgICAgICAgICBiID0gczEgKiBmMiAtIGMxICogZzM7XG4gICAgICAgICAgICAgICAgICAgIGEgPSBjMSAqIGYyICsgczEgKiBnMztcbiAgICAgICAgICAgICAgICAgICAgZnpbZmkgKyBrMl0gPSBmMCAtIGE7XG4gICAgICAgICAgICAgICAgICAgIGZ6W2ZpICsgMF0gPSBmMCArIGE7XG4gICAgICAgICAgICAgICAgICAgIGZ6W2dpICsgazNdID0gZzEgLSBiO1xuICAgICAgICAgICAgICAgICAgICBmeltnaSArIGsxXSA9IGcxICsgYjtcbiAgICAgICAgICAgICAgICAgICAgYiA9IGMxICogZzIgLSBzMSAqIGYzO1xuICAgICAgICAgICAgICAgICAgICBhID0gczEgKiBnMiArIGMxICogZjM7XG4gICAgICAgICAgICAgICAgICAgIGZ6W2dpICsgazJdID0gZzAgLSBhO1xuICAgICAgICAgICAgICAgICAgICBmeltnaSArIDBdID0gZzAgKyBhO1xuICAgICAgICAgICAgICAgICAgICBmeltmaSArIGszXSA9IGYxIC0gYjtcbiAgICAgICAgICAgICAgICAgICAgZnpbZmkgKyBrMV0gPSBmMSArIGI7XG4gICAgICAgICAgICAgICAgICAgIGdpICs9IGs0O1xuICAgICAgICAgICAgICAgICAgICBmaSArPSBrNDtcbiAgICAgICAgICAgICAgICB9IHdoaWxlIChmaSA8IGZuKTtcbiAgICAgICAgICAgICAgICBjMiA9IGMxO1xuICAgICAgICAgICAgICAgIGMxID0gYzIgKiBjb3N0YWJbdHJpICsgMF0gLSBzMSAqIGNvc3RhYlt0cmkgKyAxXTtcbiAgICAgICAgICAgICAgICBzMSA9IGMyICogY29zdGFiW3RyaSArIDFdICsgczEgKiBjb3N0YWJbdHJpICsgMF07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0cmkgKz0gMjtcbiAgICAgICAgfSB3aGlsZSAoazQgPCBuKTtcbiAgICB9XG5cbiAgICB2YXIgcnZfdGJsID0gWzB4MDAsIDB4ODAsIDB4NDAsXG4gICAgICAgIDB4YzAsIDB4MjAsIDB4YTAsIDB4NjAsIDB4ZTAsIDB4MTAsXG4gICAgICAgIDB4OTAsIDB4NTAsIDB4ZDAsIDB4MzAsIDB4YjAsIDB4NzAsXG4gICAgICAgIDB4ZjAsIDB4MDgsIDB4ODgsIDB4NDgsIDB4YzgsIDB4MjgsXG4gICAgICAgIDB4YTgsIDB4NjgsIDB4ZTgsIDB4MTgsIDB4OTgsIDB4NTgsXG4gICAgICAgIDB4ZDgsIDB4MzgsIDB4YjgsIDB4NzgsIDB4ZjgsIDB4MDQsXG4gICAgICAgIDB4ODQsIDB4NDQsIDB4YzQsIDB4MjQsIDB4YTQsIDB4NjQsXG4gICAgICAgIDB4ZTQsIDB4MTQsIDB4OTQsIDB4NTQsIDB4ZDQsIDB4MzQsXG4gICAgICAgIDB4YjQsIDB4NzQsIDB4ZjQsIDB4MGMsIDB4OGMsIDB4NGMsXG4gICAgICAgIDB4Y2MsIDB4MmMsIDB4YWMsIDB4NmMsIDB4ZWMsIDB4MWMsXG4gICAgICAgIDB4OWMsIDB4NWMsIDB4ZGMsIDB4M2MsIDB4YmMsIDB4N2MsXG4gICAgICAgIDB4ZmMsIDB4MDIsIDB4ODIsIDB4NDIsIDB4YzIsIDB4MjIsXG4gICAgICAgIDB4YTIsIDB4NjIsIDB4ZTIsIDB4MTIsIDB4OTIsIDB4NTIsXG4gICAgICAgIDB4ZDIsIDB4MzIsIDB4YjIsIDB4NzIsIDB4ZjIsIDB4MGEsXG4gICAgICAgIDB4OGEsIDB4NGEsIDB4Y2EsIDB4MmEsIDB4YWEsIDB4NmEsXG4gICAgICAgIDB4ZWEsIDB4MWEsIDB4OWEsIDB4NWEsIDB4ZGEsIDB4M2EsXG4gICAgICAgIDB4YmEsIDB4N2EsIDB4ZmEsIDB4MDYsIDB4ODYsIDB4NDYsXG4gICAgICAgIDB4YzYsIDB4MjYsIDB4YTYsIDB4NjYsIDB4ZTYsIDB4MTYsXG4gICAgICAgIDB4OTYsIDB4NTYsIDB4ZDYsIDB4MzYsIDB4YjYsIDB4NzYsXG4gICAgICAgIDB4ZjYsIDB4MGUsIDB4OGUsIDB4NGUsIDB4Y2UsIDB4MmUsXG4gICAgICAgIDB4YWUsIDB4NmUsIDB4ZWUsIDB4MWUsIDB4OWUsIDB4NWUsXG4gICAgICAgIDB4ZGUsIDB4M2UsIDB4YmUsIDB4N2UsIDB4ZmVdO1xuXG4gICAgdGhpcy5mZnRfc2hvcnQgPSBmdW5jdGlvbiAoZ2ZjLCB4X3JlYWwsIGNobiwgYnVmZmVyLCBidWZQb3MpIHtcbiAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCAzOyBiKyspIHtcbiAgICAgICAgICAgIHZhciB4ID0gRW5jb2Rlci5CTEtTSVpFX3MgLyAyO1xuICAgICAgICAgICAgdmFyIGsgPSAweGZmZmYgJiAoKDU3NiAvIDMpICogKGIgKyAxKSk7XG4gICAgICAgICAgICB2YXIgaiA9IEVuY29kZXIuQkxLU0laRV9zIC8gOCAtIDE7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgdmFyIGYwLCBmMSwgZjIsIGYzLCB3O1xuICAgICAgICAgICAgICAgIHZhciBpID0gcnZfdGJsW2ogPDwgMl0gJiAweGZmO1xuXG4gICAgICAgICAgICAgICAgZjAgPSB3aW5kb3dfc1tpXSAqIGJ1ZmZlcltjaG5dW2J1ZlBvcyArIGkgKyBrXTtcbiAgICAgICAgICAgICAgICB3ID0gd2luZG93X3NbMHg3ZiAtIGldICogYnVmZmVyW2Nobl1bYnVmUG9zICsgaSArIGsgKyAweDgwXTtcbiAgICAgICAgICAgICAgICBmMSA9IGYwIC0gdztcbiAgICAgICAgICAgICAgICBmMCA9IGYwICsgdztcbiAgICAgICAgICAgICAgICBmMiA9IHdpbmRvd19zW2kgKyAweDQwXSAqIGJ1ZmZlcltjaG5dW2J1ZlBvcyArIGkgKyBrICsgMHg0MF07XG4gICAgICAgICAgICAgICAgdyA9IHdpbmRvd19zWzB4M2YgLSBpXSAqIGJ1ZmZlcltjaG5dW2J1ZlBvcyArIGkgKyBrICsgMHhjMF07XG4gICAgICAgICAgICAgICAgZjMgPSBmMiAtIHc7XG4gICAgICAgICAgICAgICAgZjIgPSBmMiArIHc7XG5cbiAgICAgICAgICAgICAgICB4IC09IDQ7XG4gICAgICAgICAgICAgICAgeF9yZWFsW2JdW3ggKyAwXSA9IGYwICsgZjI7XG4gICAgICAgICAgICAgICAgeF9yZWFsW2JdW3ggKyAyXSA9IGYwIC0gZjI7XG4gICAgICAgICAgICAgICAgeF9yZWFsW2JdW3ggKyAxXSA9IGYxICsgZjM7XG4gICAgICAgICAgICAgICAgeF9yZWFsW2JdW3ggKyAzXSA9IGYxIC0gZjM7XG5cbiAgICAgICAgICAgICAgICBmMCA9IHdpbmRvd19zW2kgKyAweDAxXSAqIGJ1ZmZlcltjaG5dW2J1ZlBvcyArIGkgKyBrICsgMHgwMV07XG4gICAgICAgICAgICAgICAgdyA9IHdpbmRvd19zWzB4N2UgLSBpXSAqIGJ1ZmZlcltjaG5dW2J1ZlBvcyArIGkgKyBrICsgMHg4MV07XG4gICAgICAgICAgICAgICAgZjEgPSBmMCAtIHc7XG4gICAgICAgICAgICAgICAgZjAgPSBmMCArIHc7XG4gICAgICAgICAgICAgICAgZjIgPSB3aW5kb3dfc1tpICsgMHg0MV0gKiBidWZmZXJbY2huXVtidWZQb3MgKyBpICsgayArIDB4NDFdO1xuICAgICAgICAgICAgICAgIHcgPSB3aW5kb3dfc1sweDNlIC0gaV0gKiBidWZmZXJbY2huXVtidWZQb3MgKyBpICsgayArIDB4YzFdO1xuICAgICAgICAgICAgICAgIGYzID0gZjIgLSB3O1xuICAgICAgICAgICAgICAgIGYyID0gZjIgKyB3O1xuXG4gICAgICAgICAgICAgICAgeF9yZWFsW2JdW3ggKyBFbmNvZGVyLkJMS1NJWkVfcyAvIDIgKyAwXSA9IGYwICsgZjI7XG4gICAgICAgICAgICAgICAgeF9yZWFsW2JdW3ggKyBFbmNvZGVyLkJMS1NJWkVfcyAvIDIgKyAyXSA9IGYwIC0gZjI7XG4gICAgICAgICAgICAgICAgeF9yZWFsW2JdW3ggKyBFbmNvZGVyLkJMS1NJWkVfcyAvIDIgKyAxXSA9IGYxICsgZjM7XG4gICAgICAgICAgICAgICAgeF9yZWFsW2JdW3ggKyBFbmNvZGVyLkJMS1NJWkVfcyAvIDIgKyAzXSA9IGYxIC0gZjM7XG4gICAgICAgICAgICB9IHdoaWxlICgtLWogPj0gMCk7XG5cbiAgICAgICAgICAgIGZodCh4X3JlYWxbYl0sIHgsIEVuY29kZXIuQkxLU0laRV9zIC8gMik7XG4gICAgICAgICAgICAvKiBCTEtTSVpFX3MvMiBiZWNhdXNlIG9mIDNETm93ISBBU00gcm91dGluZSAqL1xuICAgICAgICAgICAgLyogQkxLU0laRS8yIGJlY2F1c2Ugb2YgM0ROb3chIEFTTSByb3V0aW5lICovXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmZmdF9sb25nID0gZnVuY3Rpb24gKGdmYywgeSwgY2huLCBidWZmZXIsIGJ1ZlBvcykge1xuICAgICAgICB2YXIgamogPSBFbmNvZGVyLkJMS1NJWkUgLyA4IC0gMTtcbiAgICAgICAgdmFyIHggPSBFbmNvZGVyLkJMS1NJWkUgLyAyO1xuXG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIHZhciBmMCwgZjEsIGYyLCBmMywgdztcbiAgICAgICAgICAgIHZhciBpID0gcnZfdGJsW2pqXSAmIDB4ZmY7XG4gICAgICAgICAgICBmMCA9IHdpbmRvd1tpXSAqIGJ1ZmZlcltjaG5dW2J1ZlBvcyArIGldO1xuICAgICAgICAgICAgdyA9IHdpbmRvd1tpICsgMHgyMDBdICogYnVmZmVyW2Nobl1bYnVmUG9zICsgaSArIDB4MjAwXTtcbiAgICAgICAgICAgIGYxID0gZjAgLSB3O1xuICAgICAgICAgICAgZjAgPSBmMCArIHc7XG4gICAgICAgICAgICBmMiA9IHdpbmRvd1tpICsgMHgxMDBdICogYnVmZmVyW2Nobl1bYnVmUG9zICsgaSArIDB4MTAwXTtcbiAgICAgICAgICAgIHcgPSB3aW5kb3dbaSArIDB4MzAwXSAqIGJ1ZmZlcltjaG5dW2J1ZlBvcyArIGkgKyAweDMwMF07XG4gICAgICAgICAgICBmMyA9IGYyIC0gdztcbiAgICAgICAgICAgIGYyID0gZjIgKyB3O1xuXG4gICAgICAgICAgICB4IC09IDQ7XG4gICAgICAgICAgICB5W3ggKyAwXSA9IGYwICsgZjI7XG4gICAgICAgICAgICB5W3ggKyAyXSA9IGYwIC0gZjI7XG4gICAgICAgICAgICB5W3ggKyAxXSA9IGYxICsgZjM7XG4gICAgICAgICAgICB5W3ggKyAzXSA9IGYxIC0gZjM7XG5cbiAgICAgICAgICAgIGYwID0gd2luZG93W2kgKyAweDAwMV0gKiBidWZmZXJbY2huXVtidWZQb3MgKyBpICsgMHgwMDFdO1xuICAgICAgICAgICAgdyA9IHdpbmRvd1tpICsgMHgyMDFdICogYnVmZmVyW2Nobl1bYnVmUG9zICsgaSArIDB4MjAxXTtcbiAgICAgICAgICAgIGYxID0gZjAgLSB3O1xuICAgICAgICAgICAgZjAgPSBmMCArIHc7XG4gICAgICAgICAgICBmMiA9IHdpbmRvd1tpICsgMHgxMDFdICogYnVmZmVyW2Nobl1bYnVmUG9zICsgaSArIDB4MTAxXTtcbiAgICAgICAgICAgIHcgPSB3aW5kb3dbaSArIDB4MzAxXSAqIGJ1ZmZlcltjaG5dW2J1ZlBvcyArIGkgKyAweDMwMV07XG4gICAgICAgICAgICBmMyA9IGYyIC0gdztcbiAgICAgICAgICAgIGYyID0gZjIgKyB3O1xuXG4gICAgICAgICAgICB5W3ggKyBFbmNvZGVyLkJMS1NJWkUgLyAyICsgMF0gPSBmMCArIGYyO1xuICAgICAgICAgICAgeVt4ICsgRW5jb2Rlci5CTEtTSVpFIC8gMiArIDJdID0gZjAgLSBmMjtcbiAgICAgICAgICAgIHlbeCArIEVuY29kZXIuQkxLU0laRSAvIDIgKyAxXSA9IGYxICsgZjM7XG4gICAgICAgICAgICB5W3ggKyBFbmNvZGVyLkJMS1NJWkUgLyAyICsgM10gPSBmMSAtIGYzO1xuICAgICAgICB9IHdoaWxlICgtLWpqID49IDApO1xuXG4gICAgICAgIGZodCh5LCB4LCBFbmNvZGVyLkJMS1NJWkUgLyAyKTtcbiAgICAgICAgLyogQkxLU0laRS8yIGJlY2F1c2Ugb2YgM0ROb3chIEFTTSByb3V0aW5lICovXG4gICAgfVxuXG4gICAgdGhpcy5pbml0X2ZmdCA9IGZ1bmN0aW9uIChnZmMpIHtcbiAgICAgICAgLyogVGhlIHR5cGUgb2Ygd2luZG93IHVzZWQgaGVyZSB3aWxsIG1ha2Ugbm8gcmVhbCBkaWZmZXJlbmNlLCBidXQgKi9cbiAgICAgICAgLypcbiAgICAgICAgICogaW4gdGhlIGludGVyZXN0IG9mIG1lcmdpbmcgbnNwc3l0dW5lIHN0dWZmIC0gc3dpdGNoIHRvIGJsYWNrbWFuXG4gICAgICAgICAqIHdpbmRvd1xuICAgICAgICAgKi9cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBFbmNvZGVyLkJMS1NJWkU7IGkrKylcbiAgICAgICAgICAgIC8qIGJsYWNrbWFuIHdpbmRvdyAqL1xuICAgICAgICAgICAgd2luZG93W2ldID0gKDAuNDIgLSAwLjUgKiBNYXRoLmNvcygyICogTWF0aC5QSSAqIChpICsgLjUpXG4gICAgICAgICAgICAgICAgLyBFbmNvZGVyLkJMS1NJWkUpICsgMC4wOCAqIE1hdGguY29zKDQgKiBNYXRoLlBJICogKGkgKyAuNSlcbiAgICAgICAgICAgICAgICAvIEVuY29kZXIuQkxLU0laRSkpO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgRW5jb2Rlci5CTEtTSVpFX3MgLyAyOyBpKyspXG4gICAgICAgICAgICB3aW5kb3dfc1tpXSA9ICgwLjUgKiAoMS4wIC0gTWF0aC5jb3MoMi4wICogTWF0aC5QSVxuICAgICAgICAgICAgICAgICogKGkgKyAwLjUpIC8gRW5jb2Rlci5CTEtTSVpFX3MpKSk7XG5cbiAgICB9XG5cbn1cblxuLypcbiAqICAgICAgcHN5bW9kZWwuY1xuICpcbiAqICAgICAgQ29weXJpZ2h0IChjKSAxOTk5LTIwMDAgTWFyayBUYXlsb3JcbiAqICAgICAgQ29weXJpZ2h0IChjKSAyMDAxLTIwMDIgTmFva2kgU2hpYmF0YVxuICogICAgICBDb3B5cmlnaHQgKGMpIDIwMDAtMjAwMyBUYWtlaGlybyBUb21pbmFnYVxuICogICAgICBDb3B5cmlnaHQgKGMpIDIwMDAtMjAwOCBSb2JlcnQgSGVnZW1hbm5cbiAqICAgICAgQ29weXJpZ2h0IChjKSAyMDAwLTIwMDUgR2FicmllbCBCb3V2aWduZVxuICogICAgICBDb3B5cmlnaHQgKGMpIDIwMDAtMjAwNSBBbGV4YW5kZXIgTGVpZGluZ2VyXG4gKlxuICogVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vclxuICogbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpY1xuICogTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyXG4gKiB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG4gKlxuICogVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG4gKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlVcbiAqIExpYnJhcnkgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLlxuICpcbiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWNcbiAqIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgd3JpdGUgdG8gdGhlXG4gKiBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIEluYy4sIDU5IFRlbXBsZSBQbGFjZSAtIFN1aXRlIDMzMCxcbiAqIEJvc3RvbiwgTUEgMDIxMTEtMTMwNywgVVNBLlxuICovXG5cbi8qICRJZDogUHN5TW9kZWwuamF2YSx2IDEuMjcgMjAxMS8wNS8yNCAyMDo0ODowNiBrZW5jaGlzIEV4cCAkICovXG5cblxuLypcbiBQU1lDSE8gQUNPVVNUSUNTXG5cblxuIFRoaXMgcm91dGluZSBjb21wdXRlcyB0aGUgcHN5Y2hvIGFjb3VzdGljcywgZGVsYXllZCBieSBvbmUgZ3JhbnVsZS5cblxuIElucHV0OiBidWZmZXIgb2YgUENNIGRhdGEgKDEwMjQgc2FtcGxlcykuXG5cbiBUaGlzIHdpbmRvdyBzaG91bGQgYmUgY2VudGVyZWQgb3ZlciB0aGUgNTc2IHNhbXBsZSBncmFudWxlIHdpbmRvdy5cbiBUaGUgcm91dGluZSB3aWxsIGNvbXB1dGUgdGhlIHBzeWNobyBhY291c3RpY3MgZm9yXG4gdGhpcyBncmFudWxlLCBidXQgcmV0dXJuIHRoZSBwc3ljaG8gYWNvdXN0aWNzIGNvbXB1dGVkXG4gZm9yIHRoZSAqcHJldmlvdXMqIGdyYW51bGUuICBUaGlzIGlzIGJlY2F1c2UgdGhlIGJsb2NrXG4gdHlwZSBvZiB0aGUgcHJldmlvdXMgZ3JhbnVsZSBjYW4gb25seSBiZSBkZXRlcm1pbmVkXG4gYWZ0ZXIgd2UgaGF2ZSBjb21wdXRlZCB0aGUgcHN5Y2hvIGFjb3VzdGljcyBmb3IgdGhlIGZvbGxvd2luZ1xuIGdyYW51bGUuXG5cbiBPdXRwdXQ6ICBtYXNraW5ncyBhbmQgZW5lcmdpZXMgZm9yIGVhY2ggc2NhbGVmYWN0b3IgYmFuZC5cbiBibG9jayB0eXBlLCBQRSwgYW5kIHNvbWUgY29ycmVsYXRpb24gbWVhc3VyZXMuXG4gVGhlIFBFIGlzIHVzZWQgYnkgQ0JSIG1vZGVzIHRvIGRldGVybWluZSBpZiBleHRyYSBiaXRzXG4gZnJvbSB0aGUgYml0IHJlc2Vydm9pciBzaG91bGQgYmUgdXNlZC4gIFRoZSBjb3JyZWxhdGlvblxuIG1lYXN1cmVzIGFyZSB1c2VkIHRvIGRldGVybWluZSBtaWQvc2lkZSBvciByZWd1bGFyIHN0ZXJlby5cbiAqL1xuLypcbiBOb3RhdGlvbjpcblxuIGJhcmtzOiAgYSBub24tbGluZWFyIGZyZXF1ZW5jeSBzY2FsZS4gIE1hcHBpbmcgZnJvbSBmcmVxdWVuY3kgdG9cbiBiYXJrcyBpcyBnaXZlbiBieSBmcmVxMmJhcmsoKVxuXG4gc2NhbGVmYWN0b3IgYmFuZHM6IFRoZSBzcGVjdHJ1bSAoZnJlcXVlbmNpZXMpIGFyZSBicm9rZW4gaW50b1xuIFNCTUFYIFwic2NhbGVmYWN0b3IgYmFuZHNcIi4gIFRoZXMgYmFuZHNcbiBhcmUgZGV0ZXJtaW5lZCBieSB0aGUgTVBFRyBJU08gc3BlYy4gIEluXG4gdGhlIG5vaXNlIHNoYXBpbmcvcXVhbnRpemF0aW9uIGNvZGUsIHdlIGFsbG9jYXRlXG4gYml0cyBhbW9uZyB0aGUgcGFydGl0aW9uIGJhbmRzIHRvIGFjaGlldmUgdGhlXG4gYmVzdCBwb3NzaWJsZSBxdWFsaXR5XG5cbiBwYXJ0aXRpb24gYmFuZHM6ICAgVGhlIHNwZWN0cnVtIGlzIGFsc28gYnJva2VuIGludG8gYWJvdXRcbiA2NCBcInBhcnRpdGlvbiBiYW5kc1wiLiAgRWFjaCBwYXJ0aXRpb25cbiBiYW5kIGlzIGFib3V0IC4zNCBiYXJrcyB3aWRlLiAgVGhlcmUgYXJlIGFib3V0IDItNVxuIHBhcnRpdGlvbiBiYW5kcyBmb3IgZWFjaCBzY2FsZWZhY3RvciBiYW5kLlxuXG4gTEFNRSBjb21wdXRlcyBhbGwgcHN5Y2hvIGFjb3VzdGljIGluZm9ybWF0aW9uIGZvciBlYWNoIHBhcnRpdGlvblxuIGJhbmQuICBUaGVuIGF0IHRoZSBlbmQgb2YgdGhlIGNvbXB1dGF0aW9ucywgdGhpcyBpbmZvcm1hdGlvblxuIGlzIG1hcHBlZCB0byBzY2FsZWZhY3RvciBiYW5kcy4gIFRoZSBlbmVyZ3kgaW4gZWFjaCBzY2FsZWZhY3RvclxuIGJhbmQgaXMgdGFrZW4gYXMgdGhlIHN1bSBvZiB0aGUgZW5lcmd5IGluIGFsbCBwYXJ0aXRpb24gYmFuZHNcbiB3aGljaCBvdmVybGFwIHRoZSBzY2FsZWZhY3RvciBiYW5kLiAgVGhlIG1hc2tpbmdzIGNhbiBiZSBjb21wdXRlZFxuIGluIHRoZSBzYW1lIHdheSAoYW5kIHRodXMgcmVwcmVzZW50IHRoZSBhdmVyYWdlIG1hc2tpbmcgaW4gdGhhdCBiYW5kKVxuIG9yIGJ5IHRha2luZyB0aGUgbWlubXVtIHZhbHVlIG11bHRpcGxpZWQgYnkgdGhlIG51bWJlciBvZlxuIHBhcnRpdGlvbiBiYW5kcyB1c2VkICh3aGljaCByZXByZXNlbnRzIGEgbWluaW11bSBtYXNraW5nIGluIHRoYXQgYmFuZCkuXG4gKi9cbi8qXG4gVGhlIGdlbmVyYWwgb3V0bGluZSBpcyBhcyBmb2xsb3dzOlxuXG4gMS4gY29tcHV0ZSB0aGUgZW5lcmd5IGluIGVhY2ggcGFydGl0aW9uIGJhbmRcbiAyLiBjb21wdXRlIHRoZSB0b25hbGl0eSBpbiBlYWNoIHBhcnRpdGlvbiBiYW5kXG4gMy4gY29tcHV0ZSB0aGUgc3RyZW5ndGggb2YgZWFjaCBwYXJ0aW9uIGJhbmQgXCJtYXNrZXJcIlxuIDQuIGNvbXB1dGUgdGhlIG1hc2tpbmcgKHZpYSB0aGUgc3ByZWFkaW5nIGZ1bmN0aW9uIGFwcGxpZWQgdG8gZWFjaCBtYXNrZXIpXG4gNS4gTW9kaWZpY2F0aW9ucyBmb3IgbWlkL3NpZGUgbWFza2luZy5cblxuIEVhY2ggcGFydGl0aW9uIGJhbmQgaXMgY29uc2lkaWVyZWQgYSBcIm1hc2tlclwiLiAgVGhlIHN0cmVuZ3RoXG4gb2YgdGhlIGkndGggbWFza2VyIGluIGJhbmQgaiBpcyBnaXZlbiBieTpcblxuIHMzKGJhcmsoaSktYmFyayhqKSkqc3RyZW5ndGgoaSlcblxuIFRoZSBzdHJlbmd0aCBvZiB0aGUgbWFza2VyIGlzIGEgZnVuY3Rpb24gb2YgdGhlIGVuZXJneSBhbmQgdG9uYWxpdHkuXG4gVGhlIG1vcmUgdG9uYWwsIHRoZSBsZXNzIG1hc2tpbmcuICBMQU1FIHVzZXMgYSBzaW1wbGUgbGluZWFyIGZvcm11bGFcbiAoY29udHJvbGxlZCBieSBOTVQgYW5kIFRNTikgd2hpY2ggc2F5cyB0aGUgc3RyZW5ndGggaXMgZ2l2ZW4gYnkgdGhlXG4gZW5lcmd5IGRpdmlkZWQgYnkgYSBsaW5lYXIgZnVuY3Rpb24gb2YgdGhlIHRvbmFsaXR5LlxuICovXG4vKlxuIHMzKCkgaXMgdGhlIFwic3ByZWFkaW5nIGZ1bmN0aW9uXCIuICBJdCBpcyBnaXZlbiBieSBhIGZvcm11bGFcbiBkZXRlcm1pbmVkIHZpYSBsaXN0ZW5pbmcgdGVzdHMuXG5cbiBUaGUgdG90YWwgbWFza2luZyBpbiB0aGUgaid0aCBwYXJ0aXRpb24gYmFuZCBpcyB0aGUgc3VtIG92ZXJcbiBhbGwgbWFza2luZ3MgaS4gIEl0IGlzIHRodXMgZ2l2ZW4gYnkgdGhlIGNvbnZvbHV0aW9uIG9mXG4gdGhlIHN0cmVuZ3RoIHdpdGggczMoKSwgdGhlIFwic3ByZWFkaW5nIGZ1bmN0aW9uLlwiXG5cbiBtYXNraW5nKGopID0gc3VtX292ZXJfaSAgczMoaS1qKSpzdHJlbmd0aChpKSAgPSBzMyBvIHN0cmVuZ3RoXG5cbiB3aGVyZSBcIm9cIiA9IGNvbnZvbHV0aW9uIG9wZXJhdG9yLiAgczMgaXMgZ2l2ZW4gYnkgYSBmb3JtdWxhIGRldGVybWluZWRcbiB2aWEgbGlzdGVuaW5nIHRlc3RzLiAgSXQgaXMgbm9ybWFsaXplZCBzbyB0aGF0IHMzIG8gMSA9IDEuXG5cbiBOb3RlOiBpbnN0ZWFkIG9mIGEgc2ltcGxlIGNvbnZvbHV0aW9uLCBMQU1FIGFsc28gaGFzIHRoZVxuIG9wdGlvbiBvZiB1c2luZyBcImFkZGl0aXZlIG1hc2tpbmdcIlxuXG4gVGhlIG1vc3QgY3JpdGljYWwgcGFydCBpcyBzdGVwIDIsIGNvbXB1dGluZyB0aGUgdG9uYWxpdHkgb2YgZWFjaFxuIHBhcnRpdGlvbiBiYW5kLiAgTEFNRSBoYXMgdHdvIHRvbmFsaXR5IGVzdGltYXRvcnMuICBUaGUgZmlyc3RcbiBpcyBiYXNlZCBvbiB0aGUgSVNPIHNwZWMsIGFuZCBtZWFzdXJlcyBob3cgcHJlZGljdGlhYmxlIHRoZVxuIHNpZ25hbCBpcyBvdmVyIHRpbWUuICBUaGUgbW9yZSBwcmVkaWN0YWJsZSwgdGhlIG1vcmUgdG9uYWwuXG4gVGhlIHNlY29uZCBtZWFzdXJlIGlzIGJhc2VkIG9uIGxvb2tpbmcgYXQgdGhlIHNwZWN0cnVtIG9mXG4gYSBzaW5nbGUgZ3JhbnVsZS4gIFRoZSBtb3JlIHBlYWt5IHRoZSBzcGVjdHJ1bSwgdGhlIG1vcmVcbiB0b25hbC4gIEJ5IG1vc3QgaW5kaWNhdGlvbnMsIHRoZSBsYXR0ZXIgYXBwcm9hY2ggaXMgYmV0dGVyLlxuXG4gRmluYWxseSwgaW4gc3RlcCA1LCB0aGUgbWFza2luZ3MgZm9yIHRoZSBtaWQgYW5kIHNpZGVcbiBjaGFubmVsIGFyZSBwb3NzaWJseSBpbmNyZWFzZWQuICBVbmRlciBjZXJ0YWluIGNpcmN1bXN0YW5jZXMsXG4gbm9pc2UgaW4gdGhlIG1pZCAmIHNpZGUgY2hhbm5lbHMgaXMgYXNzdW1lZCB0byBhbHNvXG4gYmUgbWFza2VkIGJ5IHN0cm9uZyBtYXNrZXJzIGluIHRoZSBMIG9yIFIgY2hhbm5lbHMuXG5cblxuIE90aGVyIGRhdGEgY29tcHV0ZWQgYnkgdGhlIHBzeS1tb2RlbDpcblxuIG1zX3JhdGlvICAgICAgICBzaWRlLWNoYW5uZWwgLyBtaWQtY2hhbm5lbCBtYXNraW5nIHJhdGlvIChmb3IgcHJldmlvdXMgZ3JhbnVsZSlcbiBtc19yYXRpb19uZXh0ICAgc2lkZS1jaGFubmVsIC8gbWlkLWNoYW5uZWwgbWFza2luZyByYXRpbyBmb3IgdGhpcyBncmFudWxlXG5cbiBwZXJjZXBfZW50cm9weVsyXSAgICAgTCBhbmQgUiB2YWx1ZXMgKHByZXYgZ3JhbnVsZSkgb2YgUEUgLSBBIG1lYXN1cmUgb2YgaG93XG4gbXVjaCBwcmUtZWNobyBpcyBpbiB0aGUgcHJldmlvdXMgZ3JhbnVsZVxuIHBlcmNlcF9lbnRyb3B5X01TWzJdICBtaWQgYW5kIHNpZGUgY2hhbm5lbCB2YWx1ZXMgKHByZXYgZ3JhbnVsZSkgb2YgcGVyY2VwX2VudHJvcHlcbiBlbmVyZ3lbNF0gICAgICAgICAgICAgTCxSLE0sUyBlbmVyZ3kgaW4gZWFjaCBjaGFubmVsLCBwcmV2IGdyYW51bGVcbiBibG9ja3R5cGVfZFsyXSAgICAgICAgYmxvY2sgdHlwZSB0byB1c2UgZm9yIHByZXZpb3VzIGdyYW51bGVcbiAqL1xuLy9wYWNrYWdlIG1wMztcblxuLy9pbXBvcnQgamF2YS51dGlsLkFycmF5cztcblxuXG5mdW5jdGlvbiBQc3lNb2RlbCgpIHtcblxuICAgIHZhciBmZnQgPSBuZXcgRkZUKCk7XG5cbiAgICB2YXIgTE9HMTAgPSAyLjMwMjU4NTA5Mjk5NDA0NTY4NDAyO1xuXG4gICAgdmFyIHJwZWxldiA9IDI7XG4gICAgdmFyIHJwZWxldjIgPSAxNjtcbiAgICB2YXIgcnBlbGV2X3MgPSAyO1xuICAgIHZhciBycGVsZXYyX3MgPSAxNjtcblxuICAgIC8qIHNpemUgb2YgZWFjaCBwYXJ0aXRpb24gYmFuZCwgaW4gYmFya3M6ICovXG4gICAgdmFyIERFTEJBUksgPSAuMzQ7XG5cbiAgICAvKiB0dW5lZCBmb3Igb3V0cHV0IGxldmVsIChzZW5zaXRpdmUgdG8gZW5lcmd5IHNjYWxlKSAqL1xuICAgIHZhciBWT19TQ0FMRSA9ICgxLiAvICgxNDc1MiAqIDE0NzUyKSAvIChFbmNvZGVyLkJMS1NJWkUgLyAyKSk7XG5cbiAgICB2YXIgdGVtcG9yYWxtYXNrX3N1c3RhaW5fc2VjID0gMC4wMTtcblxuICAgIHZhciBOU19QUkVFQ0hPX0FUVDAgPSAwLjg7XG4gICAgdmFyIE5TX1BSRUVDSE9fQVRUMSA9IDAuNjtcbiAgICB2YXIgTlNfUFJFRUNIT19BVFQyID0gMC4zO1xuXG4gICAgdmFyIE5TX01TRklYID0gMy41O1xuXG4gICAgdmFyIE5TQVRUQUNLVEhSRSA9IDQuNDtcbiAgICB2YXIgTlNBVFRBQ0tUSFJFX1MgPSAyNTtcblxuICAgIHZhciBOU0ZJUkxFTiA9IDIxO1xuXG4gICAgLyogc2l6ZSBvZiBlYWNoIHBhcnRpdGlvbiBiYW5kLCBpbiBiYXJrczogKi9cbiAgICB2YXIgTE5fVE9fTE9HMTAgPSAwLjIzMDI1ODUwOTM7XG5cbiAgICBmdW5jdGlvbiBOT05fTElORUFSX1NDQUxFX0VORVJHWSh4KSB7XG4gICAgICAgIHJldHVybiB4O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIDxQUkU+XG4gICAgICogICAgICAgTDNwc3ljaG9fYW5hbC4gIENvbXB1dGUgcHN5Y2hvIGFjb3VzdGljcy5cbiAgICAgKlxuICAgICAqICAgICAgIERhdGEgcmV0dXJuZWQgdG8gdGhlIGNhbGxpbmcgcHJvZ3JhbSBtdXN0IGJlIGRlbGF5ZWQgYnkgb25lXG4gICAgICogICAgICAgZ3JhbnVsZS5cbiAgICAgKlxuICAgICAqICAgICAgIFRoaXMgaXMgZG9uZSBpbiB0d28gcGxhY2VzLlxuICAgICAqICAgICAgIElmIHdlIGRvIG5vdCBuZWVkIHRvIGtub3cgdGhlIGJsb2NrdHlwZSwgdGhlIGNvcHlpbmdcbiAgICAgKiAgICAgICBjYW4gYmUgZG9uZSBoZXJlIGF0IHRoZSB0b3Agb2YgdGhlIHByb2dyYW06IHdlIGNvcHkgdGhlIGRhdGEgZm9yXG4gICAgICogICAgICAgdGhlIGxhc3QgZ3JhbnVsZSAoY29tcHV0ZWQgZHVyaW5nIHRoZSBsYXN0IGNhbGwpIGJlZm9yZSBpdCBpc1xuICAgICAqICAgICAgIG92ZXJ3cml0dGVuIHdpdGggdGhlIG5ldyBkYXRhLiAgSXQgbG9va3MgbGlrZSB0aGlzOlxuICAgICAqXG4gICAgICogICAgICAgMC4gc3RhdGljIHBzeW1vZGVsX2RhdGFcbiAgICAgKiAgICAgICAxLiBjYWxsaW5nX3Byb2dyYW1fZGF0YSA9IHBzeW1vZGVsX2RhdGFcbiAgICAgKiAgICAgICAyLiBjb21wdXRlIHBzeW1vZGVsX2RhdGFcbiAgICAgKlxuICAgICAqICAgICAgIEZvciBkYXRhIHdoaWNoIG5lZWRzIHRvIGtub3cgdGhlIGJsb2NrdHlwZSwgdGhlIGNvcHlpbmcgbXVzdCBiZVxuICAgICAqICAgICAgIGRvbmUgYXQgdGhlIGVuZCBvZiB0aGlzIGxvb3AsIGFuZCB0aGUgb2xkIHZhbHVlcyBtdXN0IGJlIHNhdmVkOlxuICAgICAqXG4gICAgICogICAgICAgMC4gc3RhdGljIHBzeW1vZGVsX2RhdGFfb2xkXG4gICAgICogICAgICAgMS4gY29tcHV0ZSBwc3ltb2RlbF9kYXRhXG4gICAgICogICAgICAgMi4gY29tcHV0ZSBwb3NzaWJsZSBibG9jayB0eXBlIG9mIHRoaXMgZ3JhbnVsZVxuICAgICAqICAgICAgIDMuIGNvbXB1dGUgZmluYWwgYmxvY2sgdHlwZSBvZiBwcmV2aW91cyBncmFudWxlIGJhc2VkIG9uICMyLlxuICAgICAqICAgICAgIDQuIGNhbGxpbmdfcHJvZ3JhbV9kYXRhID0gcHN5bW9kZWxfZGF0YV9vbGRcbiAgICAgKiAgICAgICA1LiBwc3ltb2RlbF9kYXRhX29sZCA9IHBzeW1vZGVsX2RhdGFcbiAgICAgKiAgICAgcHN5Y2hvX2xvdWRuZXNzX2FwcHJveFxuICAgICAqICAgICAgIGpkIC0gMjAwMSBtYXIgMTJcbiAgICAgKiAgICBpbjogIGVuZXJneSAgIC0gQkxLU0laRS8yIGVsZW1lbnRzIG9mIGZyZXF1ZW5jeSBtYWduaXR1ZGVzIF4gMlxuICAgICAqICAgICAgICAgZ2ZwICAgICAgLSB1c2VzIG91dF9zYW1wbGVyYXRlLCBBVEh0eXBlIChhbHNvIG5lZWRlZCBmb3IgQVRIZm9ybXVsYSlcbiAgICAgKiAgICByZXR1cm5zOiBsb3VkbmVzc14yIGFwcHJveGltYXRpb24sIGEgcG9zaXRpdmUgdmFsdWUgcm91Z2hseSB0dW5lZCBmb3IgYSB2YWx1ZVxuICAgICAqICAgICAgICAgICAgIG9mIDEuMCBmb3Igc2lnbmFscyBuZWFyIGNsaXBwaW5nLlxuICAgICAqICAgIG5vdGVzOiAgIFdoZW4gY2FsaWJyYXRlZCwgZmVlZGluZyB0aGlzIGZ1bmN0aW9uIGJpbmFyeSB3aGl0ZSBub2lzZSBhdCBzYW1wbGVcbiAgICAgKiAgICAgICAgICAgICB2YWx1ZXMgKzMyNzY3IG9yIC0zMjc2OCBzaG91bGQgcmV0dXJuIHZhbHVlcyB0aGF0IGFwcHJvYWNoIDMuXG4gICAgICogICAgICAgICAgICAgQVRIZm9ybXVsYSBpcyB1c2VkIHRvIGFwcHJveGltYXRlIGFuIGVxdWFsIGxvdWRuZXNzIGN1cnZlLlxuICAgICAqICAgIGZ1dHVyZTogIERhdGEgaW5kaWNhdGVzIHRoYXQgdGhlIHNoYXBlIG9mIHRoZSBlcXVhbCBsb3VkbmVzcyBjdXJ2ZSB2YXJpZXNcbiAgICAgKiAgICAgICAgICAgICB3aXRoIGludGVuc2l0eS4gIFRoaXMgZnVuY3Rpb24gbWlnaHQgYmUgaW1wcm92ZWQgYnkgdXNpbmcgYW4gZXF1YWxcbiAgICAgKiAgICAgICAgICAgICBsb3VkbmVzcyBjdXJ2ZSBzaGFwZWQgZm9yIHR5cGljYWwgcGxheWJhY2sgbGV2ZWxzIChpbnN0ZWFkIG9mIHRoZVxuICAgICAqICAgICAgICAgICAgIEFUSCwgdGhhdCBpcyBzaGFwZWQgZm9yIHRoZSB0aHJlc2hvbGQpLiAgQSBmbGV4aWJsZSByZWFsaXphdGlvbiBtaWdodFxuICAgICAqICAgICAgICAgICAgIHNpbXBseSBiZW5kIHRoZSBleGlzdGluZyBBVEggY3VydmUgdG8gYWNoaWV2ZSB0aGUgZGVzaXJlZCBzaGFwZS5cbiAgICAgKiAgICAgICAgICAgICBIb3dldmVyLCB0aGUgcG90ZW50aWFsIGdhaW4gbWF5IG5vdCBiZSBlbm91Z2ggdG8ganVzdGlmeSBhbiBlZmZvcnQuXG4gICAgICogPC9QUkU+XG4gICAgICovXG4gICAgZnVuY3Rpb24gcHN5Y2hvX2xvdWRuZXNzX2FwcHJveChlbmVyZ3ksIGdmYykge1xuICAgICAgICB2YXIgbG91ZG5lc3NfcG93ZXIgPSAwLjA7XG4gICAgICAgIC8qIGFwcGx5IHdlaWdodHMgdG8gcG93ZXIgaW4gZnJlcS4gYmFuZHMgKi9cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBFbmNvZGVyLkJMS1NJWkUgLyAyOyArK2kpXG4gICAgICAgICAgICBsb3VkbmVzc19wb3dlciArPSBlbmVyZ3lbaV0gKiBnZmMuQVRILmVxbF93W2ldO1xuICAgICAgICBsb3VkbmVzc19wb3dlciAqPSBWT19TQ0FMRTtcblxuICAgICAgICByZXR1cm4gbG91ZG5lc3NfcG93ZXI7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY29tcHV0ZV9mZnRzKGdmcCwgZmZ0ZW5lcmd5LCBmZnRlbmVyZ3lfcywgd3NhbXBfbCwgd3NhbXBfbFBvcywgd3NhbXBfcywgd3NhbXBfc1BvcywgZ3Jfb3V0LCBjaG4sIGJ1ZmZlciwgYnVmUG9zKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIGlmIChjaG4gPCAyKSB7XG4gICAgICAgICAgICBmZnQuZmZ0X2xvbmcoZ2ZjLCB3c2FtcF9sW3dzYW1wX2xQb3NdLCBjaG4sIGJ1ZmZlciwgYnVmUG9zKTtcbiAgICAgICAgICAgIGZmdC5mZnRfc2hvcnQoZ2ZjLCB3c2FtcF9zW3dzYW1wX3NQb3NdLCBjaG4sIGJ1ZmZlciwgYnVmUG9zKTtcbiAgICAgICAgfVxuICAgICAgICAvKiBGRlQgZGF0YSBmb3IgbWlkIGFuZCBzaWRlIGNoYW5uZWwgaXMgZGVyaXZlZCBmcm9tIEwgJiBSICovXG4gICAgICAgIGVsc2UgaWYgKGNobiA9PSAyKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gRW5jb2Rlci5CTEtTSVpFIC0gMTsgaiA+PSAwOyAtLWopIHtcbiAgICAgICAgICAgICAgICB2YXIgbCA9IHdzYW1wX2xbd3NhbXBfbFBvcyArIDBdW2pdO1xuICAgICAgICAgICAgICAgIHZhciByID0gd3NhbXBfbFt3c2FtcF9sUG9zICsgMV1bal07XG4gICAgICAgICAgICAgICAgd3NhbXBfbFt3c2FtcF9sUG9zICsgMF1bal0gPSAobCArIHIpICogVXRpbC5TUVJUMiAqIDAuNTtcbiAgICAgICAgICAgICAgICB3c2FtcF9sW3dzYW1wX2xQb3MgKyAxXVtqXSA9IChsIC0gcikgKiBVdGlsLlNRUlQyICogMC41O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgYiA9IDI7IGIgPj0gMDsgLS1iKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IEVuY29kZXIuQkxLU0laRV9zIC0gMTsgaiA+PSAwOyAtLWopIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGwgPSB3c2FtcF9zW3dzYW1wX3NQb3MgKyAwXVtiXVtqXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSB3c2FtcF9zW3dzYW1wX3NQb3MgKyAxXVtiXVtqXTtcbiAgICAgICAgICAgICAgICAgICAgd3NhbXBfc1t3c2FtcF9zUG9zICsgMF1bYl1bal0gPSAobCArIHIpICogVXRpbC5TUVJUMiAqIDAuNTtcbiAgICAgICAgICAgICAgICAgICAgd3NhbXBfc1t3c2FtcF9zUG9zICsgMV1bYl1bal0gPSAobCAtIHIpICogVXRpbC5TUVJUMiAqIDAuNTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIGNvbXB1dGUgZW5lcmdpZXNcbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgZmZ0ZW5lcmd5WzBdID0gTk9OX0xJTkVBUl9TQ0FMRV9FTkVSR1kod3NhbXBfbFt3c2FtcF9sUG9zICsgMF1bMF0pO1xuICAgICAgICBmZnRlbmVyZ3lbMF0gKj0gZmZ0ZW5lcmd5WzBdO1xuXG4gICAgICAgIGZvciAodmFyIGogPSBFbmNvZGVyLkJMS1NJWkUgLyAyIC0gMTsgaiA+PSAwOyAtLWopIHtcbiAgICAgICAgICAgIHZhciByZSA9ICh3c2FtcF9sW3dzYW1wX2xQb3MgKyAwXSlbRW5jb2Rlci5CTEtTSVpFIC8gMiAtIGpdO1xuICAgICAgICAgICAgdmFyIGltID0gKHdzYW1wX2xbd3NhbXBfbFBvcyArIDBdKVtFbmNvZGVyLkJMS1NJWkUgLyAyICsgal07XG4gICAgICAgICAgICBmZnRlbmVyZ3lbRW5jb2Rlci5CTEtTSVpFIC8gMiAtIGpdID0gTk9OX0xJTkVBUl9TQ0FMRV9FTkVSR1koKHJlXG4gICAgICAgICAgICAgICAgKiByZSArIGltICogaW0pICogMC41KTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBiID0gMjsgYiA+PSAwOyAtLWIpIHtcbiAgICAgICAgICAgIGZmdGVuZXJneV9zW2JdWzBdID0gKHdzYW1wX3Nbd3NhbXBfc1BvcyArIDBdKVtiXVswXTtcbiAgICAgICAgICAgIGZmdGVuZXJneV9zW2JdWzBdICo9IGZmdGVuZXJneV9zW2JdWzBdO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IEVuY29kZXIuQkxLU0laRV9zIC8gMiAtIDE7IGogPj0gMDsgLS1qKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlID0gKHdzYW1wX3Nbd3NhbXBfc1BvcyArIDBdKVtiXVtFbmNvZGVyLkJMS1NJWkVfc1xuICAgICAgICAgICAgICAgIC8gMiAtIGpdO1xuICAgICAgICAgICAgICAgIHZhciBpbSA9ICh3c2FtcF9zW3dzYW1wX3NQb3MgKyAwXSlbYl1bRW5jb2Rlci5CTEtTSVpFX3NcbiAgICAgICAgICAgICAgICAvIDIgKyBqXTtcbiAgICAgICAgICAgICAgICBmZnRlbmVyZ3lfc1tiXVtFbmNvZGVyLkJMS1NJWkVfcyAvIDIgLSBqXSA9IE5PTl9MSU5FQVJfU0NBTEVfRU5FUkdZKChyZVxuICAgICAgICAgICAgICAgICAgICAqIHJlICsgaW0gKiBpbSkgKiAwLjUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qIHRvdGFsIGVuZXJneSAqL1xuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgdG90YWxlbmVyZ3kgPSAwLjA7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMTE7IGogPCBFbmNvZGVyLkhCTEtTSVpFOyBqKyspXG4gICAgICAgICAgICAgICAgdG90YWxlbmVyZ3kgKz0gZmZ0ZW5lcmd5W2pdO1xuXG4gICAgICAgICAgICBnZmMudG90X2VuZXJbY2huXSA9IHRvdGFsZW5lcmd5O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGdmcC5hbmFseXNpcykge1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBFbmNvZGVyLkhCTEtTSVpFOyBqKyspIHtcbiAgICAgICAgICAgICAgICBnZmMucGluZm8uZW5lcmd5W2dyX291dF1bY2huXVtqXSA9IGdmYy5waW5mby5lbmVyZ3lfc2F2ZVtjaG5dW2pdO1xuICAgICAgICAgICAgICAgIGdmYy5waW5mby5lbmVyZ3lfc2F2ZVtjaG5dW2pdID0gZmZ0ZW5lcmd5W2pdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLnBpbmZvLnBlW2dyX291dF1bY2huXSA9IGdmYy5wZVtjaG5dO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBjb21wdXRlIGxvdWRuZXNzIGFwcHJveGltYXRpb24gKHVzZWQgZm9yIEFUSCBhdXRvLWxldmVsIGFkanVzdG1lbnQpXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIGlmIChnZnAuYXRoYWFfbG91ZGFwcHJveCA9PSAyICYmIGNobiA8IDIpIHtcbiAgICAgICAgICAgIC8vIG5vIGxvdWRuZXNzIGZvciBtaWQvc2lkZSBjaFxuICAgICAgICAgICAgZ2ZjLmxvdWRuZXNzX3NxW2dyX291dF1bY2huXSA9IGdmYy5sb3VkbmVzc19zcV9zYXZlW2Nobl07XG4gICAgICAgICAgICBnZmMubG91ZG5lc3Nfc3Ffc2F2ZVtjaG5dID0gcHN5Y2hvX2xvdWRuZXNzX2FwcHJveChmZnRlbmVyZ3ksIGdmYyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKiBtYXNrX2FkZCBvcHRpbWl6YXRpb24gKi9cbiAgICAvKiBpbml0IHRoZSBsaW1pdCB2YWx1ZXMgdXNlZCB0byBhdm9pZCBjb21wdXRpbmcgbG9nIGluIG1hc2tfYWRkIHdoZW4gaXQgaXMgbm90IG5lY2Vzc2FyeSAqL1xuXG4gICAgLyoqXG4gICAgICogPFBSRT5cbiAgICAgKiAgRm9yIGV4YW1wbGUsIHdpdGggaSA9IDEwKmxvZzEwKG0yL20xKS8xMCoxNiAgICAgICAgICg9IGxvZzEwKG0yL20xKSoxNilcbiAgICAgKlxuICAgICAqIGFicyhpKT44IGlzIGVxdWl2YWxlbnQgKGFzIGkgaXMgYW4gaW50ZWdlcikgdG9cbiAgICAgKiBhYnMoaSk+PTlcbiAgICAgKiBpPj05IHx8IGk8PS05XG4gICAgICogZXF1aXZhbGVudCB0byAoYXMgaSBpcyB0aGUgYmlnZ2VzdCBpbnRlZ2VyIHNtYWxsZXIgdGhhbiBsb2cxMChtMi9tMSkqMTZcbiAgICAgKiBvciB0aGUgc21hbGxlc3QgaW50ZWdlciBiaWdnZXIgdGhhbiBsb2cxMChtMi9tMSkqMTYgZGVwZW5kaW5nIG9uIHRoZSBzaWduIG9mIGxvZzEwKG0yL20xKSoxNilcbiAgICAgKiBsb2cxMChtMi9tMSk+PTkvMTYgfHwgbG9nMTAobTIvbTEpPD0tOS8xNlxuICAgICAqIGV4cDEwIGlzIHN0cmljdGx5IGluY3JlYXNpbmcgdGh1cyB0aGlzIGlzIGVxdWl2YWxlbnQgdG9cbiAgICAgKiBtMi9tMSA+PSAxMF4oOS8xNikgfHwgbTIvbTE8PTEwXigtOS8xNikgd2hpY2ggYXJlIGNvbXBhcmlzb25zIHRvIGNvbnN0YW50c1xuICAgICAqIDwvUFJFPlxuICAgICAqL1xuXG4gICAgLyoqXG4gICAgICogYXMgaW4gaWYoaT44KVxuICAgICAqL1xuICAgIHZhciBJMUxJTUlUID0gODtcbiAgICAvKipcbiAgICAgKiBhcyBpbiBpZihpPjI0KSAuIGNoYW5nZWQgMjNcbiAgICAgKi9cbiAgICB2YXIgSTJMSU1JVCA9IDIzO1xuICAgIC8qKlxuICAgICAqIGFzIGluIGlmKG08MTUpXG4gICAgICovXG4gICAgdmFyIE1MSU1JVCA9IDE1O1xuXG4gICAgdmFyIG1hX21heF9pMTtcbiAgICB2YXIgbWFfbWF4X2kyO1xuICAgIHZhciBtYV9tYXhfbTtcblxuICAgIC8qKlxuICAgICAqIFRoaXMgaXMgdGhlIG1hc2tpbmcgdGFibGU6PEJSPlxuICAgICAqIEFjY29yZGluZyB0byB0b25hbGl0eSwgdmFsdWVzIGFyZSBnb2luZyBmcm9tIDBkQiAoVE1OKSB0byA5LjNkQiAoTk1UKS48QlI+XG4gICAgICogQWZ0ZXIgYWRkaXRpdmUgbWFza2luZyBjb21wdXRhdGlvbiwgOGRCIGFyZSBhZGRlZCwgc28gZmluYWwgdmFsdWVzIGFyZVxuICAgICAqIGdvaW5nIGZyb20gOGRCIHRvIDE3LjNkQlxuICAgICAqXG4gICAgICogcG93KDEwLCAtMC4wLi4tMC42KVxuICAgICAqL1xuICAgIHZhciB0YWIgPSBbMS4wLCAwLjc5NDMzLCAwLjYzMDk2LCAwLjYzMDk2LFxuICAgICAgICAwLjYzMDk2LCAwLjYzMDk2LCAwLjYzMDk2LCAwLjI1MTE5LCAwLjExNzQ5XTtcblxuICAgIGZ1bmN0aW9uIGluaXRfbWFza19hZGRfbWF4X3ZhbHVlcygpIHtcbiAgICAgICAgbWFfbWF4X2kxID0gTWF0aC5wb3coMTAsIChJMUxJTUlUICsgMSkgLyAxNi4wKTtcbiAgICAgICAgbWFfbWF4X2kyID0gTWF0aC5wb3coMTAsIChJMkxJTUlUICsgMSkgLyAxNi4wKTtcbiAgICAgICAgbWFfbWF4X20gPSBNYXRoLnBvdygxMCwgKE1MSU1JVCkgLyAxMC4wKTtcbiAgICB9XG5cbiAgICB2YXIgdGFibGUxID0gWzMuMzI0NiAqIDMuMzI0NixcbiAgICAgICAgMy4yMzgzNyAqIDMuMjM4MzcsIDMuMTU0MzcgKiAzLjE1NDM3LCAzLjAwNDEyICogMy4wMDQxMixcbiAgICAgICAgMi44NjEwMyAqIDIuODYxMDMsIDIuNjU0MDcgKiAyLjY1NDA3LCAyLjQ2MjA5ICogMi40NjIwOSxcbiAgICAgICAgMi4yODQgKiAyLjI4NCwgMi4xMTg3OSAqIDIuMTE4NzksIDEuOTY1NTIgKiAxLjk2NTUyLFxuICAgICAgICAxLjgyMzM1ICogMS44MjMzNSwgMS42OTE0NiAqIDEuNjkxNDYsIDEuNTY5MTEgKiAxLjU2OTExLFxuICAgICAgICAxLjQ2NjU4ICogMS40NjY1OCwgMS4zNzA3NCAqIDEuMzcwNzQsIDEuMzEwMzYgKiAxLjMxMDM2LFxuICAgICAgICAxLjI1MjY0ICogMS4yNTI2NCwgMS4yMDY0OCAqIDEuMjA2NDgsIDEuMTYyMDMgKiAxLjE2MjAzLFxuICAgICAgICAxLjEyNzY1ICogMS4xMjc2NSwgMS4wOTQyOCAqIDEuMDk0MjgsIDEuMDY1OSAqIDEuMDY1OSxcbiAgICAgICAgMS4wMzgyNiAqIDEuMDM4MjYsIDEuMDE4OTUgKiAxLjAxODk1LCAxXTtcblxuICAgIHZhciB0YWJsZTIgPSBbMS4zMzM1MiAqIDEuMzMzNTIsXG4gICAgICAgIDEuMzU4NzkgKiAxLjM1ODc5LCAxLjM4NDU0ICogMS4zODQ1NCwgMS4zOTQ5NyAqIDEuMzk0OTcsXG4gICAgICAgIDEuNDA1NDggKiAxLjQwNTQ4LCAxLjM1MzcgKiAxLjM1MzcsIDEuMzAzODIgKiAxLjMwMzgyLFxuICAgICAgICAxLjIyMzIxICogMS4yMjMyMSwgMS4xNDc1OCAqIDEuMTQ3NTgsIDFdO1xuXG4gICAgdmFyIHRhYmxlMyA9IFsyLjM1MzY0ICogMi4zNTM2NCxcbiAgICAgICAgMi4yOTI1OSAqIDIuMjkyNTksIDIuMjMzMTMgKiAyLjIzMzEzLCAyLjEyNjc1ICogMi4xMjY3NSxcbiAgICAgICAgMi4wMjU0NSAqIDIuMDI1NDUsIDEuODc4OTQgKiAxLjg3ODk0LCAxLjc0MzAzICogMS43NDMwMyxcbiAgICAgICAgMS42MTY5NSAqIDEuNjE2OTUsIDEuNDk5OTkgKiAxLjQ5OTk5LCAxLjM5MTQ4ICogMS4zOTE0OCxcbiAgICAgICAgMS4yOTA4MyAqIDEuMjkwODMsIDEuMTk3NDYgKiAxLjE5NzQ2LCAxLjExMDg0ICogMS4xMTA4NCxcbiAgICAgICAgMS4wMzgyNiAqIDEuMDM4MjZdO1xuXG4gICAgLyoqXG4gICAgICogYWRkaXRpb24gb2Ygc2ltdWx0YW5lb3VzIG1hc2tpbmcgTmFva2kgU2hpYmF0YSAyMDAwLzdcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBtYXNrX2FkZChtMSwgbTIsIGtrLCBiLCBnZmMsIHNob3J0YmxvY2spIHtcbiAgICAgICAgdmFyIHJhdGlvO1xuXG4gICAgICAgIGlmIChtMiA+IG0xKSB7XG4gICAgICAgICAgICBpZiAobTIgPCAobTEgKiBtYV9tYXhfaTIpKVxuICAgICAgICAgICAgICAgIHJhdGlvID0gbTIgLyBtMTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICByZXR1cm4gKG0xICsgbTIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKG0xID49IChtMiAqIG1hX21heF9pMikpXG4gICAgICAgICAgICAgICAgcmV0dXJuIChtMSArIG0yKTtcbiAgICAgICAgICAgIHJhdGlvID0gbTEgLyBtMjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIFNob3VsZCBhbHdheXMgYmUgdHJ1ZSwganVzdCBjaGVja2luZyAqL1xuXG4gICAgICAgIG0xICs9IG0yO1xuICAgICAgICAvL2lmICgoKGxvbmcpKGIgKyAzKSAmIDB4ZmZmZmZmZmYpIDw9IDMgKyAzKSB7XG4gICAgICAgIGlmICgoYiArIDMpIDw9IDMgKyAzKSB7XG4gICAgICAgICAgICAvKiBhcHByb3hpbWF0ZWx5LCAxIGJhcmsgPSAzIHBhcnRpdGlvbnMgKi9cbiAgICAgICAgICAgIC8qIDY1JSBvZiB0aGUgY2FzZXMgKi9cbiAgICAgICAgICAgIC8qIG9yaWdpbmFsbHkgJ2lmKGkgPiA4KScgKi9cbiAgICAgICAgICAgIGlmIChyYXRpbyA+PSBtYV9tYXhfaTEpIHtcbiAgICAgICAgICAgICAgICAvKiA0MyUgb2YgdGhlIHRvdGFsICovXG4gICAgICAgICAgICAgICAgcmV0dXJuIG0xO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiAyMiUgb2YgdGhlIHRvdGFsICovXG4gICAgICAgICAgICB2YXIgaSA9IDAgfCAoVXRpbC5GQVNUX0xPRzEwX1gocmF0aW8sIDE2LjApKTtcbiAgICAgICAgICAgIHJldHVybiBtMSAqIHRhYmxlMltpXTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiA8UFJFPlxuICAgICAgICAgKiBtPDE1IGVxdSBsb2cxMCgobTErbTIpL2dmYy5BVEguY2Jba10pPDEuNVxuICAgICAgICAgKiBlcXUgKG0xK20yKS9nZmMuQVRILmNiW2tdPDEwXjEuNVxuICAgICAgICAgKiBlcXUgKG0xK20yKTwxMF4xLjUgKiBnZmMuQVRILmNiW2tdXG4gICAgICAgICAqIDwvUFJFPlxuICAgICAgICAgKi9cbiAgICAgICAgdmFyIGkgPSAwIHwgVXRpbC5GQVNUX0xPRzEwX1gocmF0aW8sIDE2LjApO1xuICAgICAgICBpZiAoc2hvcnRibG9jayAhPSAwKSB7XG4gICAgICAgICAgICBtMiA9IGdmYy5BVEguY2Jfc1tra10gKiBnZmMuQVRILmFkanVzdDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG0yID0gZ2ZjLkFUSC5jYl9sW2trXSAqIGdmYy5BVEguYWRqdXN0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChtMSA8IG1hX21heF9tICogbTIpIHtcbiAgICAgICAgICAgIC8qIDMlIG9mIHRoZSB0b3RhbCAqL1xuICAgICAgICAgICAgLyogT3JpZ2luYWxseSBpZiAobSA+IDApIHsgKi9cbiAgICAgICAgICAgIGlmIChtMSA+IG0yKSB7XG4gICAgICAgICAgICAgICAgdmFyIGYsIHI7XG5cbiAgICAgICAgICAgICAgICBmID0gMS4wO1xuICAgICAgICAgICAgICAgIGlmIChpIDw9IDEzKVxuICAgICAgICAgICAgICAgICAgICBmID0gdGFibGUzW2ldO1xuXG4gICAgICAgICAgICAgICAgciA9IFV0aWwuRkFTVF9MT0cxMF9YKG0xIC8gbTIsIDEwLjAgLyAxNS4wKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbTEgKiAoKHRhYmxlMVtpXSAtIGYpICogciArIGYpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoaSA+IDEzKVxuICAgICAgICAgICAgICAgIHJldHVybiBtMTtcblxuICAgICAgICAgICAgcmV0dXJuIG0xICogdGFibGUzW2ldO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogMTAlIG9mIHRvdGFsICovXG4gICAgICAgIHJldHVybiBtMSAqIHRhYmxlMVtpXTtcbiAgICB9XG5cbiAgICB2YXIgdGFibGUyXyA9IFsxLjMzMzUyICogMS4zMzM1MixcbiAgICAgICAgMS4zNTg3OSAqIDEuMzU4NzksIDEuMzg0NTQgKiAxLjM4NDU0LCAxLjM5NDk3ICogMS4zOTQ5NyxcbiAgICAgICAgMS40MDU0OCAqIDEuNDA1NDgsIDEuMzUzNyAqIDEuMzUzNywgMS4zMDM4MiAqIDEuMzAzODIsXG4gICAgICAgIDEuMjIzMjEgKiAxLjIyMzIxLCAxLjE0NzU4ICogMS4xNDc1OCwgMV07XG5cbiAgICAvKipcbiAgICAgKiBhZGRpdGlvbiBvZiBzaW11bHRhbmVvdXMgbWFza2luZyBOYW9raSBTaGliYXRhIDIwMDAvN1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIHZicnBzeV9tYXNrX2FkZChtMSwgbTIsIGIpIHtcbiAgICAgICAgdmFyIHJhdGlvO1xuXG4gICAgICAgIGlmIChtMSA8IDApIHtcbiAgICAgICAgICAgIG0xID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAobTIgPCAwKSB7XG4gICAgICAgICAgICBtMiA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG0xIDw9IDApIHtcbiAgICAgICAgICAgIHJldHVybiBtMjtcbiAgICAgICAgfVxuICAgICAgICBpZiAobTIgPD0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG0xO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtMiA+IG0xKSB7XG4gICAgICAgICAgICByYXRpbyA9IG0yIC8gbTE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByYXRpbyA9IG0xIC8gbTI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKC0yIDw9IGIgJiYgYiA8PSAyKSB7XG4gICAgICAgICAgICAvKiBhcHByb3hpbWF0ZWx5LCAxIGJhcmsgPSAzIHBhcnRpdGlvbnMgKi9cbiAgICAgICAgICAgIC8qIG9yaWdpbmFsbHkgJ2lmKGkgPiA4KScgKi9cbiAgICAgICAgICAgIGlmIChyYXRpbyA+PSBtYV9tYXhfaTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbTEgKyBtMjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGkgPSAwIHwgKFV0aWwuRkFTVF9MT0cxMF9YKHJhdGlvLCAxNi4wKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChtMSArIG0yKSAqIHRhYmxlMl9baV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJhdGlvIDwgbWFfbWF4X2kyKSB7XG4gICAgICAgICAgICByZXR1cm4gbTEgKyBtMjtcbiAgICAgICAgfVxuICAgICAgICBpZiAobTEgPCBtMikge1xuICAgICAgICAgICAgbTEgPSBtMjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbTE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY29tcHV0ZSBpbnRlcmNoYW5uZWwgbWFza2luZyBlZmZlY3RzXG4gICAgICovXG4gICAgZnVuY3Rpb24gY2FsY19pbnRlcmNoYW5uZWxfbWFza2luZyhnZnAsIHJhdGlvKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIGlmIChnZmMuY2hhbm5lbHNfb3V0ID4gMSkge1xuICAgICAgICAgICAgZm9yICh2YXIgc2IgPSAwOyBzYiA8IEVuY29kZXIuU0JNQVhfbDsgc2IrKykge1xuICAgICAgICAgICAgICAgIHZhciBsID0gZ2ZjLnRobVswXS5sW3NiXTtcbiAgICAgICAgICAgICAgICB2YXIgciA9IGdmYy50aG1bMV0ubFtzYl07XG4gICAgICAgICAgICAgICAgZ2ZjLnRobVswXS5sW3NiXSArPSByICogcmF0aW87XG4gICAgICAgICAgICAgICAgZ2ZjLnRobVsxXS5sW3NiXSArPSBsICogcmF0aW87XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBzYiA9IDA7IHNiIDwgRW5jb2Rlci5TQk1BWF9zOyBzYisrKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgc2Jsb2NrID0gMDsgc2Jsb2NrIDwgMzsgc2Jsb2NrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGwgPSBnZmMudGhtWzBdLnNbc2JdW3NibG9ja107XG4gICAgICAgICAgICAgICAgICAgIHZhciByID0gZ2ZjLnRobVsxXS5zW3NiXVtzYmxvY2tdO1xuICAgICAgICAgICAgICAgICAgICBnZmMudGhtWzBdLnNbc2JdW3NibG9ja10gKz0gciAqIHJhdGlvO1xuICAgICAgICAgICAgICAgICAgICBnZmMudGhtWzFdLnNbc2JdW3NibG9ja10gKz0gbCAqIHJhdGlvO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNvbXB1dGUgTS9TIHRocmVzaG9sZHMgZnJvbSBKb2huc3RvbiAmIEZlcnJlaXJhIDE5OTIgSUNBU1NQIHBhcGVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gbXNmaXgxKGdmYykge1xuICAgICAgICBmb3IgKHZhciBzYiA9IDA7IHNiIDwgRW5jb2Rlci5TQk1BWF9sOyBzYisrKSB7XG4gICAgICAgICAgICAvKiB1c2UgdGhpcyBmaXggaWYgTCAmIFIgbWFza2luZyBkaWZmZXJzIGJ5IDJkYiBvciBsZXNzICovXG4gICAgICAgICAgICAvKiBpZiBkYiA9IDEwKmxvZzEwKHgyL3gxKSA8IDIgKi9cbiAgICAgICAgICAgIC8qIGlmICh4MiA8IDEuNTgqeDEpIHsgKi9cbiAgICAgICAgICAgIGlmIChnZmMudGhtWzBdLmxbc2JdID4gMS41OCAqIGdmYy50aG1bMV0ubFtzYl1cbiAgICAgICAgICAgICAgICB8fCBnZmMudGhtWzFdLmxbc2JdID4gMS41OCAqIGdmYy50aG1bMF0ubFtzYl0pXG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB2YXIgbWxkID0gZ2ZjLm1sZF9sW3NiXSAqIGdmYy5lblszXS5sW3NiXTtcbiAgICAgICAgICAgIHZhciBybWlkID0gTWF0aC5tYXgoZ2ZjLnRobVsyXS5sW3NiXSxcbiAgICAgICAgICAgICAgICBNYXRoLm1pbihnZmMudGhtWzNdLmxbc2JdLCBtbGQpKTtcblxuICAgICAgICAgICAgbWxkID0gZ2ZjLm1sZF9sW3NiXSAqIGdmYy5lblsyXS5sW3NiXTtcbiAgICAgICAgICAgIHZhciByc2lkZSA9IE1hdGgubWF4KGdmYy50aG1bM10ubFtzYl0sXG4gICAgICAgICAgICAgICAgTWF0aC5taW4oZ2ZjLnRobVsyXS5sW3NiXSwgbWxkKSk7XG4gICAgICAgICAgICBnZmMudGhtWzJdLmxbc2JdID0gcm1pZDtcbiAgICAgICAgICAgIGdmYy50aG1bM10ubFtzYl0gPSByc2lkZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIHNiID0gMDsgc2IgPCBFbmNvZGVyLlNCTUFYX3M7IHNiKyspIHtcbiAgICAgICAgICAgIGZvciAodmFyIHNibG9jayA9IDA7IHNibG9jayA8IDM7IHNibG9jaysrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy50aG1bMF0uc1tzYl1bc2Jsb2NrXSA+IDEuNTggKiBnZmMudGhtWzFdLnNbc2JdW3NibG9ja11cbiAgICAgICAgICAgICAgICAgICAgfHwgZ2ZjLnRobVsxXS5zW3NiXVtzYmxvY2tdID4gMS41OCAqIGdmYy50aG1bMF0uc1tzYl1bc2Jsb2NrXSlcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgdmFyIG1sZCA9IGdmYy5tbGRfc1tzYl0gKiBnZmMuZW5bM10uc1tzYl1bc2Jsb2NrXTtcbiAgICAgICAgICAgICAgICB2YXIgcm1pZCA9IE1hdGgubWF4KGdmYy50aG1bMl0uc1tzYl1bc2Jsb2NrXSxcbiAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oZ2ZjLnRobVszXS5zW3NiXVtzYmxvY2tdLCBtbGQpKTtcblxuICAgICAgICAgICAgICAgIG1sZCA9IGdmYy5tbGRfc1tzYl0gKiBnZmMuZW5bMl0uc1tzYl1bc2Jsb2NrXTtcbiAgICAgICAgICAgICAgICB2YXIgcnNpZGUgPSBNYXRoLm1heChnZmMudGhtWzNdLnNbc2JdW3NibG9ja10sXG4gICAgICAgICAgICAgICAgICAgIE1hdGgubWluKGdmYy50aG1bMl0uc1tzYl1bc2Jsb2NrXSwgbWxkKSk7XG5cbiAgICAgICAgICAgICAgICBnZmMudGhtWzJdLnNbc2JdW3NibG9ja10gPSBybWlkO1xuICAgICAgICAgICAgICAgIGdmYy50aG1bM10uc1tzYl1bc2Jsb2NrXSA9IHJzaWRlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRqdXN0IE0vUyBtYXNraW5ncyBpZiB1c2VyIHNldCBcIm1zZml4XCJcbiAgICAgKlxuICAgICAqIE5hb2tpIFNoaWJhdGEgMjAwMFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG5zX21zZml4KGdmYywgbXNmaXgsIGF0aGFkanVzdCkge1xuICAgICAgICB2YXIgbXNmaXgyID0gbXNmaXg7XG4gICAgICAgIHZhciBhdGhsb3dlciA9IE1hdGgucG93KDEwLCBhdGhhZGp1c3QpO1xuXG4gICAgICAgIG1zZml4ICo9IDIuMDtcbiAgICAgICAgbXNmaXgyICo9IDIuMDtcbiAgICAgICAgZm9yICh2YXIgc2IgPSAwOyBzYiA8IEVuY29kZXIuU0JNQVhfbDsgc2IrKykge1xuICAgICAgICAgICAgdmFyIHRobUxSLCB0aG1NLCB0aG1TLCBhdGg7XG4gICAgICAgICAgICBhdGggPSAoZ2ZjLkFUSC5jYl9sW2dmYy5ibV9sW3NiXV0pICogYXRobG93ZXI7XG4gICAgICAgICAgICB0aG1MUiA9IE1hdGgubWluKE1hdGgubWF4KGdmYy50aG1bMF0ubFtzYl0sIGF0aCksXG4gICAgICAgICAgICAgICAgTWF0aC5tYXgoZ2ZjLnRobVsxXS5sW3NiXSwgYXRoKSk7XG4gICAgICAgICAgICB0aG1NID0gTWF0aC5tYXgoZ2ZjLnRobVsyXS5sW3NiXSwgYXRoKTtcbiAgICAgICAgICAgIHRobVMgPSBNYXRoLm1heChnZmMudGhtWzNdLmxbc2JdLCBhdGgpO1xuICAgICAgICAgICAgaWYgKHRobUxSICogbXNmaXggPCB0aG1NICsgdGhtUykge1xuICAgICAgICAgICAgICAgIHZhciBmID0gdGhtTFIgKiBtc2ZpeDIgLyAodGhtTSArIHRobVMpO1xuICAgICAgICAgICAgICAgIHRobU0gKj0gZjtcbiAgICAgICAgICAgICAgICB0aG1TICo9IGY7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMudGhtWzJdLmxbc2JdID0gTWF0aC5taW4odGhtTSwgZ2ZjLnRobVsyXS5sW3NiXSk7XG4gICAgICAgICAgICBnZmMudGhtWzNdLmxbc2JdID0gTWF0aC5taW4odGhtUywgZ2ZjLnRobVszXS5sW3NiXSk7XG4gICAgICAgIH1cblxuICAgICAgICBhdGhsb3dlciAqPSAoIEVuY29kZXIuQkxLU0laRV9zIC8gRW5jb2Rlci5CTEtTSVpFKTtcbiAgICAgICAgZm9yICh2YXIgc2IgPSAwOyBzYiA8IEVuY29kZXIuU0JNQVhfczsgc2IrKykge1xuICAgICAgICAgICAgZm9yICh2YXIgc2Jsb2NrID0gMDsgc2Jsb2NrIDwgMzsgc2Jsb2NrKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhtTFIsIHRobU0sIHRobVMsIGF0aDtcbiAgICAgICAgICAgICAgICBhdGggPSAoZ2ZjLkFUSC5jYl9zW2dmYy5ibV9zW3NiXV0pICogYXRobG93ZXI7XG4gICAgICAgICAgICAgICAgdGhtTFIgPSBNYXRoLm1pbihNYXRoLm1heChnZmMudGhtWzBdLnNbc2JdW3NibG9ja10sIGF0aCksXG4gICAgICAgICAgICAgICAgICAgIE1hdGgubWF4KGdmYy50aG1bMV0uc1tzYl1bc2Jsb2NrXSwgYXRoKSk7XG4gICAgICAgICAgICAgICAgdGhtTSA9IE1hdGgubWF4KGdmYy50aG1bMl0uc1tzYl1bc2Jsb2NrXSwgYXRoKTtcbiAgICAgICAgICAgICAgICB0aG1TID0gTWF0aC5tYXgoZ2ZjLnRobVszXS5zW3NiXVtzYmxvY2tdLCBhdGgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRobUxSICogbXNmaXggPCB0aG1NICsgdGhtUykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IHRobUxSICogbXNmaXggLyAodGhtTSArIHRobVMpO1xuICAgICAgICAgICAgICAgICAgICB0aG1NICo9IGY7XG4gICAgICAgICAgICAgICAgICAgIHRobVMgKj0gZjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZ2ZjLnRobVsyXS5zW3NiXVtzYmxvY2tdID0gTWF0aC5taW4oZ2ZjLnRobVsyXS5zW3NiXVtzYmxvY2tdLFxuICAgICAgICAgICAgICAgICAgICB0aG1NKTtcbiAgICAgICAgICAgICAgICBnZmMudGhtWzNdLnNbc2JdW3NibG9ja10gPSBNYXRoLm1pbihnZmMudGhtWzNdLnNbc2JdW3NibG9ja10sXG4gICAgICAgICAgICAgICAgICAgIHRobVMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogc2hvcnQgYmxvY2sgdGhyZXNob2xkIGNhbGN1bGF0aW9uIChwYXJ0IDIpXG4gICAgICpcbiAgICAgKiBwYXJ0aXRpb24gYmFuZCBib19zW3NmYl0gaXMgYXQgdGhlIHRyYW5zaXRpb24gZnJvbSBzY2FsZWZhY3RvciBiYW5kIHNmYlxuICAgICAqIHRvIHRoZSBuZXh0IG9uZSBzZmIrMTsgZW5uIGFuZCB0aG1tIGhhdmUgdG8gYmUgc3BsaXQgYmV0d2VlbiB0aGVtXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29udmVydF9wYXJ0aXRpb24yc2NhbGVmYWNfcyhnZmMsIGViLCB0aHIsIGNobiwgc2Jsb2NrKSB7XG4gICAgICAgIHZhciBzYiwgYjtcbiAgICAgICAgdmFyIGVubiA9IDAuMDtcbiAgICAgICAgdmFyIHRobW0gPSAwLjA7XG4gICAgICAgIGZvciAoc2IgPSBiID0gMDsgc2IgPCBFbmNvZGVyLlNCTUFYX3M7ICsrYiwgKytzYikge1xuICAgICAgICAgICAgdmFyIGJvX3Nfc2IgPSBnZmMuYm9fc1tzYl07XG4gICAgICAgICAgICB2YXIgbnBhcnRfcyA9IGdmYy5ucGFydF9zO1xuICAgICAgICAgICAgdmFyIGJfbGltID0gYm9fc19zYiA8IG5wYXJ0X3MgPyBib19zX3NiIDogbnBhcnRfcztcbiAgICAgICAgICAgIHdoaWxlIChiIDwgYl9saW0pIHtcbiAgICAgICAgICAgICAgICAvLyBpZmYgZmFpbGVkLCBpdCBtYXkgaW5kaWNhdGUgc29tZSBpbmRleCBlcnJvciBlbHNld2hlcmVcbiAgICAgICAgICAgICAgICBlbm4gKz0gZWJbYl07XG4gICAgICAgICAgICAgICAgdGhtbSArPSB0aHJbYl07XG4gICAgICAgICAgICAgICAgYisrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLmVuW2Nobl0uc1tzYl1bc2Jsb2NrXSA9IGVubjtcbiAgICAgICAgICAgIGdmYy50aG1bY2huXS5zW3NiXVtzYmxvY2tdID0gdGhtbTtcblxuICAgICAgICAgICAgaWYgKGIgPj0gbnBhcnRfcykge1xuICAgICAgICAgICAgICAgICsrc2I7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBpZmYgZmFpbGVkLCBpdCBtYXkgaW5kaWNhdGUgc29tZSBpbmRleCBlcnJvciBlbHNld2hlcmVcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvKiBhdCB0cmFuc2l0aW9uIHNmYiAuIHNmYisxICovXG4gICAgICAgICAgICAgICAgdmFyIHdfY3VyciA9IGdmYy5QU1kuYm9fc193ZWlnaHRbc2JdO1xuICAgICAgICAgICAgICAgIHZhciB3X25leHQgPSAxLjAgLSB3X2N1cnI7XG4gICAgICAgICAgICAgICAgZW5uID0gd19jdXJyICogZWJbYl07XG4gICAgICAgICAgICAgICAgdGhtbSA9IHdfY3VyciAqIHRocltiXTtcbiAgICAgICAgICAgICAgICBnZmMuZW5bY2huXS5zW3NiXVtzYmxvY2tdICs9IGVubjtcbiAgICAgICAgICAgICAgICBnZmMudGhtW2Nobl0uc1tzYl1bc2Jsb2NrXSArPSB0aG1tO1xuICAgICAgICAgICAgICAgIGVubiA9IHdfbmV4dCAqIGViW2JdO1xuICAgICAgICAgICAgICAgIHRobW0gPSB3X25leHQgKiB0aHJbYl07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyogemVybyBpbml0aWFsaXplIHRoZSByZXN0ICovXG4gICAgICAgIGZvciAoOyBzYiA8IEVuY29kZXIuU0JNQVhfczsgKytzYikge1xuICAgICAgICAgICAgZ2ZjLmVuW2Nobl0uc1tzYl1bc2Jsb2NrXSA9IDA7XG4gICAgICAgICAgICBnZmMudGhtW2Nobl0uc1tzYl1bc2Jsb2NrXSA9IDA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBsb25nYmxvY2sgdGhyZXNob2xkIGNhbGN1bGF0aW9uIChwYXJ0IDIpXG4gICAgICovXG4gICAgZnVuY3Rpb24gY29udmVydF9wYXJ0aXRpb24yc2NhbGVmYWNfbChnZmMsIGViLCB0aHIsIGNobikge1xuICAgICAgICB2YXIgc2IsIGI7XG4gICAgICAgIHZhciBlbm4gPSAwLjA7XG4gICAgICAgIHZhciB0aG1tID0gMC4wO1xuICAgICAgICBmb3IgKHNiID0gYiA9IDA7IHNiIDwgRW5jb2Rlci5TQk1BWF9sOyArK2IsICsrc2IpIHtcbiAgICAgICAgICAgIHZhciBib19sX3NiID0gZ2ZjLmJvX2xbc2JdO1xuICAgICAgICAgICAgdmFyIG5wYXJ0X2wgPSBnZmMubnBhcnRfbDtcbiAgICAgICAgICAgIHZhciBiX2xpbSA9IGJvX2xfc2IgPCBucGFydF9sID8gYm9fbF9zYiA6IG5wYXJ0X2w7XG4gICAgICAgICAgICB3aGlsZSAoYiA8IGJfbGltKSB7XG4gICAgICAgICAgICAgICAgLy8gaWZmIGZhaWxlZCwgaXQgbWF5IGluZGljYXRlIHNvbWUgaW5kZXggZXJyb3IgZWxzZXdoZXJlXG4gICAgICAgICAgICAgICAgZW5uICs9IGViW2JdO1xuICAgICAgICAgICAgICAgIHRobW0gKz0gdGhyW2JdO1xuICAgICAgICAgICAgICAgIGIrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy5lbltjaG5dLmxbc2JdID0gZW5uO1xuICAgICAgICAgICAgZ2ZjLnRobVtjaG5dLmxbc2JdID0gdGhtbTtcblxuICAgICAgICAgICAgaWYgKGIgPj0gbnBhcnRfbCkge1xuICAgICAgICAgICAgICAgICsrc2I7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLyogYXQgdHJhbnNpdGlvbiBzZmIgLiBzZmIrMSAqL1xuICAgICAgICAgICAgICAgIHZhciB3X2N1cnIgPSBnZmMuUFNZLmJvX2xfd2VpZ2h0W3NiXTtcbiAgICAgICAgICAgICAgICB2YXIgd19uZXh0ID0gMS4wIC0gd19jdXJyO1xuICAgICAgICAgICAgICAgIGVubiA9IHdfY3VyciAqIGViW2JdO1xuICAgICAgICAgICAgICAgIHRobW0gPSB3X2N1cnIgKiB0aHJbYl07XG4gICAgICAgICAgICAgICAgZ2ZjLmVuW2Nobl0ubFtzYl0gKz0gZW5uO1xuICAgICAgICAgICAgICAgIGdmYy50aG1bY2huXS5sW3NiXSArPSB0aG1tO1xuICAgICAgICAgICAgICAgIGVubiA9IHdfbmV4dCAqIGViW2JdO1xuICAgICAgICAgICAgICAgIHRobW0gPSB3X25leHQgKiB0aHJbYl07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyogemVybyBpbml0aWFsaXplIHRoZSByZXN0ICovXG4gICAgICAgIGZvciAoOyBzYiA8IEVuY29kZXIuU0JNQVhfbDsgKytzYikge1xuICAgICAgICAgICAgZ2ZjLmVuW2Nobl0ubFtzYl0gPSAwO1xuICAgICAgICAgICAgZ2ZjLnRobVtjaG5dLmxbc2JdID0gMDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvbXB1dGVfbWFza2luZ19zKGdmcCwgZmZ0ZW5lcmd5X3MsIGViLCB0aHIsIGNobiwgc2Jsb2NrKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBqLCBiO1xuXG4gICAgICAgIGZvciAoYiA9IGogPSAwOyBiIDwgZ2ZjLm5wYXJ0X3M7ICsrYikge1xuICAgICAgICAgICAgdmFyIGViYiA9IDAsIG0gPSAwO1xuICAgICAgICAgICAgdmFyIG4gPSBnZmMubnVtbGluZXNfc1tiXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbjsgKytpLCArK2opIHtcbiAgICAgICAgICAgICAgICB2YXIgZWwgPSBmZnRlbmVyZ3lfc1tzYmxvY2tdW2pdO1xuICAgICAgICAgICAgICAgIGViYiArPSBlbDtcbiAgICAgICAgICAgICAgICBpZiAobSA8IGVsKVxuICAgICAgICAgICAgICAgICAgICBtID0gZWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlYltiXSA9IGViYjtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGogPSBiID0gMDsgYiA8IGdmYy5ucGFydF9zOyBiKyspIHtcbiAgICAgICAgICAgIHZhciBrayA9IGdmYy5zM2luZF9zW2JdWzBdO1xuICAgICAgICAgICAgdmFyIGVjYiA9IGdmYy5zM19zc1tqKytdICogZWJba2tdO1xuICAgICAgICAgICAgKytraztcbiAgICAgICAgICAgIHdoaWxlIChrayA8PSBnZmMuczNpbmRfc1tiXVsxXSkge1xuICAgICAgICAgICAgICAgIGVjYiArPSBnZmMuczNfc3Nbal0gKiBlYltra107XG4gICAgICAgICAgICAgICAgKytqO1xuICAgICAgICAgICAgICAgICsra2s7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHsgLyogbGltaXQgY2FsY3VsYXRlZCB0aHJlc2hvbGQgYnkgcHJldmlvdXMgZ3JhbnVsZSAqL1xuICAgICAgICAgICAgICAgIHZhciB4ID0gcnBlbGV2X3MgKiBnZmMubmJfczFbY2huXVtiXTtcbiAgICAgICAgICAgICAgICB0aHJbYl0gPSBNYXRoLm1pbihlY2IsIHgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGdmYy5ibG9ja3R5cGVfb2xkW2NobiAmIDFdID09IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgICAgIC8qIGxpbWl0IGNhbGN1bGF0ZWQgdGhyZXNob2xkIGJ5IGV2ZW4gb2xkZXIgZ3JhbnVsZSAqL1xuICAgICAgICAgICAgICAgIHZhciB4ID0gcnBlbGV2Ml9zICogZ2ZjLm5iX3MyW2Nobl1bYl07XG4gICAgICAgICAgICAgICAgdmFyIHkgPSB0aHJbYl07XG4gICAgICAgICAgICAgICAgdGhyW2JdID0gTWF0aC5taW4oeCwgeSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGdmYy5uYl9zMltjaG5dW2JdID0gZ2ZjLm5iX3MxW2Nobl1bYl07XG4gICAgICAgICAgICBnZmMubmJfczFbY2huXVtiXSA9IGVjYjtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKDsgYiA8PSBFbmNvZGVyLkNCQU5EUzsgKytiKSB7XG4gICAgICAgICAgICBlYltiXSA9IDA7XG4gICAgICAgICAgICB0aHJbYl0gPSAwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYmxvY2tfdHlwZV9zZXQoZ2ZwLCB1c2Vsb25nYmxvY2ssIGJsb2NrdHlwZV9kLCBibG9ja3R5cGUpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblxuICAgICAgICBpZiAoZ2ZwLnNob3J0X2Jsb2NrcyA9PSBTaG9ydEJsb2NrLnNob3J0X2Jsb2NrX2NvdXBsZWRcbiAgICAgICAgICAgICAgICAvKiBmb3JjZSBib3RoIGNoYW5uZWxzIHRvIHVzZSB0aGUgc2FtZSBibG9jayB0eXBlICovXG4gICAgICAgICAgICAgICAgLyogdGhpcyBpcyBuZWNlc3NhcnkgaWYgdGhlIGZyYW1lIGlzIHRvIGJlIGVuY29kZWQgaW4gbXNfc3RlcmVvLiAqL1xuICAgICAgICAgICAgICAgIC8qIEJ1dCBldmVuIHdpdGhvdXQgbXNfc3RlcmVvLCBGaEcgZG9lcyB0aGlzICovXG4gICAgICAgICAgICAmJiAhKHVzZWxvbmdibG9ja1swXSAhPSAwICYmIHVzZWxvbmdibG9ja1sxXSAhPSAwKSlcbiAgICAgICAgICAgIHVzZWxvbmdibG9ja1swXSA9IHVzZWxvbmdibG9ja1sxXSA9IDA7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogdXBkYXRlIHRoZSBibG9ja3R5cGUgb2YgdGhlIHByZXZpb3VzIGdyYW51bGUsIHNpbmNlIGl0IGRlcGVuZHMgb25cbiAgICAgICAgICogd2hhdCBoYXBwZW5kIGluIHRoaXMgZ3JhbnVsZVxuICAgICAgICAgKi9cbiAgICAgICAgZm9yICh2YXIgY2huID0gMDsgY2huIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2huKyspIHtcbiAgICAgICAgICAgIGJsb2NrdHlwZVtjaG5dID0gRW5jb2Rlci5OT1JNX1RZUEU7XG4gICAgICAgICAgICAvKiBkaXNhYmxlIHNob3J0IGJsb2NrcyAqL1xuICAgICAgICAgICAgaWYgKGdmcC5zaG9ydF9ibG9ja3MgPT0gU2hvcnRCbG9jay5zaG9ydF9ibG9ja19kaXNwZW5zZWQpXG4gICAgICAgICAgICAgICAgdXNlbG9uZ2Jsb2NrW2Nobl0gPSAxO1xuICAgICAgICAgICAgaWYgKGdmcC5zaG9ydF9ibG9ja3MgPT0gU2hvcnRCbG9jay5zaG9ydF9ibG9ja19mb3JjZWQpXG4gICAgICAgICAgICAgICAgdXNlbG9uZ2Jsb2NrW2Nobl0gPSAwO1xuXG4gICAgICAgICAgICBpZiAodXNlbG9uZ2Jsb2NrW2Nobl0gIT0gMCkge1xuICAgICAgICAgICAgICAgIC8qIG5vIGF0dGFjayA6IHVzZSBsb25nIGJsb2NrcyAqL1xuICAgICAgICAgICAgICAgIGlmIChnZmMuYmxvY2t0eXBlX29sZFtjaG5dID09IEVuY29kZXIuU0hPUlRfVFlQRSlcbiAgICAgICAgICAgICAgICAgICAgYmxvY2t0eXBlW2Nobl0gPSBFbmNvZGVyLlNUT1BfVFlQRTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLyogYXR0YWNrIDogdXNlIHNob3J0IGJsb2NrcyAqL1xuICAgICAgICAgICAgICAgIGJsb2NrdHlwZVtjaG5dID0gRW5jb2Rlci5TSE9SVF9UWVBFO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuYmxvY2t0eXBlX29sZFtjaG5dID09IEVuY29kZXIuTk9STV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgIGdmYy5ibG9ja3R5cGVfb2xkW2Nobl0gPSBFbmNvZGVyLlNUQVJUX1RZUEU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnZmMuYmxvY2t0eXBlX29sZFtjaG5dID09IEVuY29kZXIuU1RPUF9UWVBFKVxuICAgICAgICAgICAgICAgICAgICBnZmMuYmxvY2t0eXBlX29sZFtjaG5dID0gRW5jb2Rlci5TSE9SVF9UWVBFO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBibG9ja3R5cGVfZFtjaG5dID0gZ2ZjLmJsb2NrdHlwZV9vbGRbY2huXTtcbiAgICAgICAgICAgIC8vIHZhbHVlIHJldHVybmVkIHRvIGNhbGxpbmcgcHJvZ3JhbVxuICAgICAgICAgICAgZ2ZjLmJsb2NrdHlwZV9vbGRbY2huXSA9IGJsb2NrdHlwZVtjaG5dO1xuICAgICAgICAgICAgLy8gc2F2ZSBmb3IgbmV4dCBjYWxsIHRvIGwzcHN5X2FuYWxcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIE5TX0lOVEVSUCh4LCB5LCByKSB7XG4gICAgICAgIC8qIHdhcyBwb3coKHgpLChyKSkqcG93KCh5KSwxLShyKSkgKi9cbiAgICAgICAgaWYgKHIgPj0gMS4wKSB7XG4gICAgICAgICAgICAvKiA5OS43JSBvZiB0aGUgdGltZSAqL1xuICAgICAgICAgICAgcmV0dXJuIHg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHIgPD0gMC4wKVxuICAgICAgICAgICAgcmV0dXJuIHk7XG4gICAgICAgIGlmICh5ID4gMC4wKSB7XG4gICAgICAgICAgICAvKiByZXN0IG9mIHRoZSB0aW1lICovXG4gICAgICAgICAgICByZXR1cm4gKE1hdGgucG93KHggLyB5LCByKSAqIHkpO1xuICAgICAgICB9XG4gICAgICAgIC8qIG5ldmVyIGhhcHBlbnMgKi9cbiAgICAgICAgcmV0dXJuIDAuMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiB0aGVzZSB2YWx1ZXMgYXJlIHR1bmVkIG9ubHkgZm9yIDQ0LjFrSHouLi5cbiAgICAgKi9cbiAgICB2YXIgcmVnY29lZl9zID0gWzExLjgsIDEzLjYsIDE3LjIsIDMyLCA0Ni41LFxuICAgICAgICA1MS4zLCA1Ny41LCA2Ny4xLCA3MS41LCA4NC42LCA5Ny42LCAxMzAsXG4gICAgICAgIC8qIDI1NS44ICovXG4gICAgXTtcblxuICAgIGZ1bmN0aW9uIHBlY2FsY19zKG1yLCBtYXNraW5nX2xvd2VyKSB7XG4gICAgICAgIHZhciBwZV9zID0gMTIzNi4yOCAvIDQ7XG4gICAgICAgIGZvciAodmFyIHNiID0gMDsgc2IgPCBFbmNvZGVyLlNCTUFYX3MgLSAxOyBzYisrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBzYmxvY2sgPSAwOyBzYmxvY2sgPCAzOyBzYmxvY2srKykge1xuICAgICAgICAgICAgICAgIHZhciB0aG0gPSBtci50aG0uc1tzYl1bc2Jsb2NrXTtcbiAgICAgICAgICAgICAgICBpZiAodGhtID4gMC4wKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB4ID0gdGhtICogbWFza2luZ19sb3dlcjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVuID0gbXIuZW4uc1tzYl1bc2Jsb2NrXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVuID4geCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuID4geCAqIDFlMTApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwZV9zICs9IHJlZ2NvZWZfc1tzYl0gKiAoMTAuMCAqIExPRzEwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVfcyArPSByZWdjb2VmX3Nbc2JdICogVXRpbC5GQVNUX0xPRzEwKGVuIC8geCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcGVfcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiB0aGVzZSB2YWx1ZXMgYXJlIHR1bmVkIG9ubHkgZm9yIDQ0LjFrSHouLi5cbiAgICAgKi9cbiAgICB2YXIgcmVnY29lZl9sID0gWzYuOCwgNS44LCA1LjgsIDYuNCwgNi41LCA5LjksXG4gICAgICAgIDEyLjEsIDE0LjQsIDE1LCAxOC45LCAyMS42LCAyNi45LCAzNC4yLCA0MC4yLCA0Ni44LCA1Ni41LFxuICAgICAgICA2MC43LCA3My45LCA4NS43LCA5My40LCAxMjYuMSxcbiAgICAgICAgLyogMjQxLjMgKi9cbiAgICBdO1xuXG4gICAgZnVuY3Rpb24gcGVjYWxjX2wobXIsIG1hc2tpbmdfbG93ZXIpIHtcbiAgICAgICAgdmFyIHBlX2wgPSAxMTI0LjIzIC8gNDtcbiAgICAgICAgZm9yICh2YXIgc2IgPSAwOyBzYiA8IEVuY29kZXIuU0JNQVhfbCAtIDE7IHNiKyspIHtcbiAgICAgICAgICAgIHZhciB0aG0gPSBtci50aG0ubFtzYl07XG4gICAgICAgICAgICBpZiAodGhtID4gMC4wKSB7XG4gICAgICAgICAgICAgICAgdmFyIHggPSB0aG0gKiBtYXNraW5nX2xvd2VyO1xuICAgICAgICAgICAgICAgIHZhciBlbiA9IG1yLmVuLmxbc2JdO1xuICAgICAgICAgICAgICAgIGlmIChlbiA+IHgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVuID4geCAqIDFlMTApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlX2wgKz0gcmVnY29lZl9sW3NiXSAqICgxMC4wICogTE9HMTApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGVfbCArPSByZWdjb2VmX2xbc2JdICogVXRpbC5GQVNUX0xPRzEwKGVuIC8geCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHBlX2w7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2FsY19lbmVyZ3koZ2ZjLCBmZnRlbmVyZ3ksIGViLCBtYXgsIGF2Zykge1xuICAgICAgICB2YXIgYiwgajtcblxuICAgICAgICBmb3IgKGIgPSBqID0gMDsgYiA8IGdmYy5ucGFydF9sOyArK2IpIHtcbiAgICAgICAgICAgIHZhciBlYmIgPSAwLCBtID0gMDtcbiAgICAgICAgICAgIHZhciBpO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGdmYy5udW1saW5lc19sW2JdOyArK2ksICsraikge1xuICAgICAgICAgICAgICAgIHZhciBlbCA9IGZmdGVuZXJneVtqXTtcbiAgICAgICAgICAgICAgICBlYmIgKz0gZWw7XG4gICAgICAgICAgICAgICAgaWYgKG0gPCBlbClcbiAgICAgICAgICAgICAgICAgICAgbSA9IGVsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWJbYl0gPSBlYmI7XG4gICAgICAgICAgICBtYXhbYl0gPSBtO1xuICAgICAgICAgICAgYXZnW2JdID0gZWJiICogZ2ZjLnJudW1saW5lc19sW2JdO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2FsY19tYXNrX2luZGV4X2woZ2ZjLCBtYXgsIGF2ZywgbWFza19pZHgpIHtcbiAgICAgICAgdmFyIGxhc3RfdGFiX2VudHJ5ID0gdGFiLmxlbmd0aCAtIDE7XG4gICAgICAgIHZhciBiID0gMDtcbiAgICAgICAgdmFyIGEgPSBhdmdbYl0gKyBhdmdbYiArIDFdO1xuICAgICAgICBpZiAoYSA+IDAuMCkge1xuICAgICAgICAgICAgdmFyIG0gPSBtYXhbYl07XG4gICAgICAgICAgICBpZiAobSA8IG1heFtiICsgMV0pXG4gICAgICAgICAgICAgICAgbSA9IG1heFtiICsgMV07XG4gICAgICAgICAgICBhID0gMjAuMCAqIChtICogMi4wIC0gYSlcbiAgICAgICAgICAgICAgICAvIChhICogKGdmYy5udW1saW5lc19sW2JdICsgZ2ZjLm51bWxpbmVzX2xbYiArIDFdIC0gMSkpO1xuICAgICAgICAgICAgdmFyIGsgPSAwIHwgYTtcbiAgICAgICAgICAgIGlmIChrID4gbGFzdF90YWJfZW50cnkpXG4gICAgICAgICAgICAgICAgayA9IGxhc3RfdGFiX2VudHJ5O1xuICAgICAgICAgICAgbWFza19pZHhbYl0gPSBrO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbWFza19pZHhbYl0gPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChiID0gMTsgYiA8IGdmYy5ucGFydF9sIC0gMTsgYisrKSB7XG4gICAgICAgICAgICBhID0gYXZnW2IgLSAxXSArIGF2Z1tiXSArIGF2Z1tiICsgMV07XG4gICAgICAgICAgICBpZiAoYSA+IDAuMCkge1xuICAgICAgICAgICAgICAgIHZhciBtID0gbWF4W2IgLSAxXTtcbiAgICAgICAgICAgICAgICBpZiAobSA8IG1heFtiXSlcbiAgICAgICAgICAgICAgICAgICAgbSA9IG1heFtiXTtcbiAgICAgICAgICAgICAgICBpZiAobSA8IG1heFtiICsgMV0pXG4gICAgICAgICAgICAgICAgICAgIG0gPSBtYXhbYiArIDFdO1xuICAgICAgICAgICAgICAgIGEgPSAyMC4wXG4gICAgICAgICAgICAgICAgICAgICogKG0gKiAzLjAgLSBhKVxuICAgICAgICAgICAgICAgICAgICAvIChhICogKGdmYy5udW1saW5lc19sW2IgLSAxXSArIGdmYy5udW1saW5lc19sW2JdXG4gICAgICAgICAgICAgICAgICAgICsgZ2ZjLm51bWxpbmVzX2xbYiArIDFdIC0gMSkpO1xuICAgICAgICAgICAgICAgIHZhciBrID0gMCB8IGE7XG4gICAgICAgICAgICAgICAgaWYgKGsgPiBsYXN0X3RhYl9lbnRyeSlcbiAgICAgICAgICAgICAgICAgICAgayA9IGxhc3RfdGFiX2VudHJ5O1xuICAgICAgICAgICAgICAgIG1hc2tfaWR4W2JdID0gaztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWFza19pZHhbYl0gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgYSA9IGF2Z1tiIC0gMV0gKyBhdmdbYl07XG4gICAgICAgIGlmIChhID4gMC4wKSB7XG4gICAgICAgICAgICB2YXIgbSA9IG1heFtiIC0gMV07XG4gICAgICAgICAgICBpZiAobSA8IG1heFtiXSlcbiAgICAgICAgICAgICAgICBtID0gbWF4W2JdO1xuICAgICAgICAgICAgYSA9IDIwLjAgKiAobSAqIDIuMCAtIGEpXG4gICAgICAgICAgICAgICAgLyAoYSAqIChnZmMubnVtbGluZXNfbFtiIC0gMV0gKyBnZmMubnVtbGluZXNfbFtiXSAtIDEpKTtcbiAgICAgICAgICAgIHZhciBrID0gMCB8IGE7XG4gICAgICAgICAgICBpZiAoayA+IGxhc3RfdGFiX2VudHJ5KVxuICAgICAgICAgICAgICAgIGsgPSBsYXN0X3RhYl9lbnRyeTtcbiAgICAgICAgICAgIG1hc2tfaWR4W2JdID0gaztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1hc2tfaWR4W2JdID0gMDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciBmaXJjb2VmID0gW1xuICAgICAgICAtOC42NTE2M2UtMTggKiAyLCAtMC4wMDg1MTU4NiAqIDIsIC02Ljc0NzY0ZS0xOCAqIDIsIDAuMDIwOTAzNiAqIDIsXG4gICAgICAgIC0zLjM2NjM5ZS0xNyAqIDIsIC0wLjA0MzgxNjIgKiAyLCAtMS41NDE3NWUtMTcgKiAyLCAwLjA5MzE3MzggKiAyLFxuICAgICAgICAtNS41MjIxMmUtMTcgKiAyLCAtMC4zMTM4MTkgKiAyXG4gICAgXTtcblxuICAgIHRoaXMuTDNwc3ljaG9fYW5hbF9ucyA9IGZ1bmN0aW9uIChnZnAsIGJ1ZmZlciwgYnVmUG9zLCBncl9vdXQsIG1hc2tpbmdfcmF0aW8sIG1hc2tpbmdfTVNfcmF0aW8sIHBlcmNlcF9lbnRyb3B5LCBwZXJjZXBfTVNfZW50cm9weSwgZW5lcmd5LCBibG9ja3R5cGVfZCkge1xuICAgICAgICAvKlxuICAgICAgICAgKiB0byBnZXQgYSBnb29kIGNhY2hlIHBlcmZvcm1hbmNlLCBvbmUgaGFzIHRvIHRoaW5rIGFib3V0IHRoZSBzZXF1ZW5jZSxcbiAgICAgICAgICogaW4gd2hpY2ggdGhlIHZhcmlhYmxlcyBhcmUgdXNlZC5cbiAgICAgICAgICovXG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cbiAgICAgICAgLyogZmZ0IGFuZCBlbmVyZ3kgY2FsY3VsYXRpb24gKi9cbiAgICAgICAgdmFyIHdzYW1wX0wgPSBuZXdfZmxvYXRfbihbMiwgRW5jb2Rlci5CTEtTSVpFXSk7XG4gICAgICAgIHZhciB3c2FtcF9TID0gbmV3X2Zsb2F0X24oWzIsIDMsIEVuY29kZXIuQkxLU0laRV9zXSk7XG5cbiAgICAgICAgLyogY29udm9sdXRpb24gKi9cbiAgICAgICAgdmFyIGViX2wgPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMgKyAxKTtcbiAgICAgICAgdmFyIGViX3MgPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMgKyAxKTtcbiAgICAgICAgdmFyIHRociA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyArIDIpO1xuXG4gICAgICAgIC8qIGJsb2NrIHR5cGUgKi9cbiAgICAgICAgdmFyIGJsb2NrdHlwZSA9IG5ld19pbnQoMiksIHVzZWxvbmdibG9jayA9IG5ld19pbnQoMik7XG5cbiAgICAgICAgLyogdXN1YWwgdmFyaWFibGVzIGxpa2UgbG9vcCBpbmRpY2VzLCBldGMuLiAqL1xuICAgICAgICB2YXIgbnVtY2huLCBjaG47XG4gICAgICAgIHZhciBiLCBpLCBqLCBrO1xuICAgICAgICB2YXIgc2IsIHNibG9jaztcblxuICAgICAgICAvKiB2YXJpYWJsZXMgdXNlZCBmb3IgLS1uc3BzeXR1bmUgKi9cbiAgICAgICAgdmFyIG5zX2hwZnNtcGwgPSBuZXdfZmxvYXRfbihbMiwgNTc2XSk7XG4gICAgICAgIHZhciBwY2ZhY3Q7XG4gICAgICAgIHZhciBtYXNrX2lkeF9sID0gbmV3X2ludChFbmNvZGVyLkNCQU5EUyArIDIpLCBtYXNrX2lkeF9zID0gbmV3X2ludChFbmNvZGVyLkNCQU5EUyArIDIpO1xuXG4gICAgICAgIEFycmF5cy5maWxsKG1hc2tfaWR4X3MsIDApO1xuXG4gICAgICAgIG51bWNobiA9IGdmYy5jaGFubmVsc19vdXQ7XG4gICAgICAgIC8qIGNobj0yIGFuZCAzID0gTWlkIGFuZCBTaWRlIGNoYW5uZWxzICovXG4gICAgICAgIGlmIChnZnAubW9kZSA9PSBNUEVHTW9kZS5KT0lOVF9TVEVSRU8pXG4gICAgICAgICAgICBudW1jaG4gPSA0O1xuXG4gICAgICAgIGlmIChnZnAuVkJSID09IFZick1vZGUudmJyX29mZilcbiAgICAgICAgICAgIHBjZmFjdCA9IGdmYy5SZXN2TWF4ID09IDAgPyAwIDogKCBnZmMuUmVzdlNpemUpXG4gICAgICAgICAgICAvIGdmYy5SZXN2TWF4ICogMC41O1xuICAgICAgICBlbHNlIGlmIChnZnAuVkJSID09IFZick1vZGUudmJyX3JoIHx8IGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfbXRyaFxuICAgICAgICAgICAgfHwgZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9tdCkge1xuICAgICAgICAgICAgcGNmYWN0ID0gMC42O1xuICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgIHBjZmFjdCA9IDEuMDtcblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBBcHBseSBIUEYgb2YgZnMvNCB0byB0aGUgaW5wdXQgc2lnbmFsLiBUaGlzIGlzIHVzZWQgZm9yIGF0dGFja1xuICAgICAgICAgKiBkZXRlY3Rpb24gLyBoYW5kbGluZy5cbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIC8qIERvbid0IGNvcHkgdGhlIGlucHV0IGJ1ZmZlciBpbnRvIGEgdGVtcG9yYXJ5IGJ1ZmZlciAqL1xuICAgICAgICAvKiB1bnJvbGwgdGhlIGxvb3AgMiB0aW1lcyAqL1xuICAgICAgICBmb3IgKGNobiA9IDA7IGNobiA8IGdmYy5jaGFubmVsc19vdXQ7IGNobisrKSB7XG4gICAgICAgICAgICAvKiBhcHBseSBoaWdoIHBhc3MgZmlsdGVyIG9mIGZzLzQgKi9cbiAgICAgICAgICAgIHZhciBmaXJidWYgPSBidWZmZXJbY2huXTtcbiAgICAgICAgICAgIHZhciBmaXJidWZQb3MgPSBidWZQb3MgKyA1NzYgLSAzNTAgLSBOU0ZJUkxFTiArIDE5MjtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCA1NzY7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBzdW0xLCBzdW0yO1xuICAgICAgICAgICAgICAgIHN1bTEgPSBmaXJidWZbZmlyYnVmUG9zICsgaSArIDEwXTtcbiAgICAgICAgICAgICAgICBzdW0yID0gMC4wO1xuICAgICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCAoKE5TRklSTEVOIC0gMSkgLyAyKSAtIDE7IGogKz0gMikge1xuICAgICAgICAgICAgICAgICAgICBzdW0xICs9IGZpcmNvZWZbal1cbiAgICAgICAgICAgICAgICAgICAgICAgICogKGZpcmJ1ZltmaXJidWZQb3MgKyBpICsgal0gKyBmaXJidWZbZmlyYnVmUG9zICsgaVxuICAgICAgICAgICAgICAgICAgICAgICAgKyBOU0ZJUkxFTiAtIGpdKTtcbiAgICAgICAgICAgICAgICAgICAgc3VtMiArPSBmaXJjb2VmW2ogKyAxXVxuICAgICAgICAgICAgICAgICAgICAgICAgKiAoZmlyYnVmW2ZpcmJ1ZlBvcyArIGkgKyBqICsgMV0gKyBmaXJidWZbZmlyYnVmUG9zXG4gICAgICAgICAgICAgICAgICAgICAgICArIGkgKyBOU0ZJUkxFTiAtIGogLSAxXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5zX2hwZnNtcGxbY2huXVtpXSA9IHN1bTEgKyBzdW0yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWFza2luZ19yYXRpb1tncl9vdXRdW2Nobl0uZW4uYXNzaWduKGdmYy5lbltjaG5dKTtcbiAgICAgICAgICAgIG1hc2tpbmdfcmF0aW9bZ3Jfb3V0XVtjaG5dLnRobS5hc3NpZ24oZ2ZjLnRobVtjaG5dKTtcbiAgICAgICAgICAgIGlmIChudW1jaG4gPiAyKSB7XG4gICAgICAgICAgICAgICAgLyogTVMgbWFza2luZ3MgKi9cbiAgICAgICAgICAgICAgICAvKiBwZXJjZXBfTVNfZW50cm9weSBbY2huLTJdID0gZ2ZjIC4gcGUgW2Nobl07ICovXG4gICAgICAgICAgICAgICAgbWFza2luZ19NU19yYXRpb1tncl9vdXRdW2Nobl0uZW4uYXNzaWduKGdmYy5lbltjaG4gKyAyXSk7XG4gICAgICAgICAgICAgICAgbWFza2luZ19NU19yYXRpb1tncl9vdXRdW2Nobl0udGhtLmFzc2lnbihnZmMudGhtW2NobiArIDJdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoY2huID0gMDsgY2huIDwgbnVtY2huOyBjaG4rKykge1xuICAgICAgICAgICAgdmFyIHdzYW1wX2w7XG4gICAgICAgICAgICB2YXIgd3NhbXBfcztcbiAgICAgICAgICAgIHZhciBlbl9zdWJzaG9ydCA9IG5ld19mbG9hdCgxMik7XG4gICAgICAgICAgICB2YXIgZW5fc2hvcnQgPSBbMCwgMCwgMCwgMF07XG4gICAgICAgICAgICB2YXIgYXR0YWNrX2ludGVuc2l0eSA9IG5ld19mbG9hdCgxMik7XG4gICAgICAgICAgICB2YXIgbnNfdXNlbG9uZ2Jsb2NrID0gMTtcbiAgICAgICAgICAgIHZhciBhdHRhY2tUaHJlc2hvbGQ7XG4gICAgICAgICAgICB2YXIgbWF4ID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTKSwgYXZnID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTKTtcbiAgICAgICAgICAgIHZhciBuc19hdHRhY2tzID0gWzAsIDAsIDAsIDBdO1xuICAgICAgICAgICAgdmFyIGZmdGVuZXJneSA9IG5ld19mbG9hdChFbmNvZGVyLkhCTEtTSVpFKTtcbiAgICAgICAgICAgIHZhciBmZnRlbmVyZ3lfcyA9IG5ld19mbG9hdF9uKFszLCBFbmNvZGVyLkhCTEtTSVpFX3NdKTtcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIHJoIDIwMDQwMzAxOiB0aGUgZm9sbG93aW5nIGxvb3BzIGRvIGFjY2VzcyBvbmUgb2ZmIHRoZSBsaW1pdHMgc29cbiAgICAgICAgICAgICAqIEkgaW5jcmVhc2UgdGhlIGFycmF5IGRpbWVuc2lvbnMgYnkgb25lIGFuZCBpbml0aWFsaXplIHRoZVxuICAgICAgICAgICAgICogYWNjZXNzZWQgdmFsdWVzIHRvIHplcm9cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAgICAgKiBkZXRlcm1pbmUgdGhlIGJsb2NrIHR5cGUgKHdpbmRvdyB0eXBlKVxuICAgICAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgICAgIC8qIGNhbGN1bGF0ZSBlbmVyZ2llcyBvZiBlYWNoIHN1Yi1zaG9ydGJsb2NrcyAqL1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDM7IGkrKykge1xuICAgICAgICAgICAgICAgIGVuX3N1YnNob3J0W2ldID0gZ2ZjLm5zUHN5Lmxhc3RfZW5fc3Vic2hvcnRbY2huXVtpICsgNl07XG4gICAgICAgICAgICAgICAgYXR0YWNrX2ludGVuc2l0eVtpXSA9IGVuX3N1YnNob3J0W2ldXG4gICAgICAgICAgICAgICAgICAgIC8gZ2ZjLm5zUHN5Lmxhc3RfZW5fc3Vic2hvcnRbY2huXVtpICsgNF07XG4gICAgICAgICAgICAgICAgZW5fc2hvcnRbMF0gKz0gZW5fc3Vic2hvcnRbaV07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjaG4gPT0gMikge1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCA1NzY7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbCwgcjtcbiAgICAgICAgICAgICAgICAgICAgbCA9IG5zX2hwZnNtcGxbMF1baV07XG4gICAgICAgICAgICAgICAgICAgIHIgPSBuc19ocGZzbXBsWzFdW2ldO1xuICAgICAgICAgICAgICAgICAgICBuc19ocGZzbXBsWzBdW2ldID0gbCArIHI7XG4gICAgICAgICAgICAgICAgICAgIG5zX2hwZnNtcGxbMV1baV0gPSBsIC0gcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIHBmID0gbnNfaHBmc21wbFtjaG4gJiAxXTtcbiAgICAgICAgICAgICAgICB2YXIgcGZQb3MgPSAwO1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCA5OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBmZSA9IHBmUG9zICsgNTc2IC8gOTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSAxLjtcbiAgICAgICAgICAgICAgICAgICAgZm9yICg7IHBmUG9zIDwgcGZlOyBwZlBvcysrKVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHAgPCBNYXRoLmFicyhwZltwZlBvc10pKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBNYXRoLmFicyhwZltwZlBvc10pO1xuXG4gICAgICAgICAgICAgICAgICAgIGdmYy5uc1BzeS5sYXN0X2VuX3N1YnNob3J0W2Nobl1baV0gPSBlbl9zdWJzaG9ydFtpICsgM10gPSBwO1xuICAgICAgICAgICAgICAgICAgICBlbl9zaG9ydFsxICsgaSAvIDNdICs9IHA7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwID4gZW5fc3Vic2hvcnRbaSArIDMgLSAyXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcCA9IHAgLyBlbl9zdWJzaG9ydFtpICsgMyAtIDJdO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVuX3N1YnNob3J0W2kgKyAzIC0gMl0gPiBwICogMTAuMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcCA9IGVuX3N1YnNob3J0W2kgKyAzIC0gMl0gLyAocCAqIDEwLjApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHAgPSAwLjA7XG4gICAgICAgICAgICAgICAgICAgIGF0dGFja19pbnRlbnNpdHlbaSArIDNdID0gcDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChnZnAuYW5hbHlzaXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgeCA9IGF0dGFja19pbnRlbnNpdHlbMF07XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMTsgaSA8IDEyOyBpKyspXG4gICAgICAgICAgICAgICAgICAgIGlmICh4IDwgYXR0YWNrX2ludGVuc2l0eVtpXSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHggPSBhdHRhY2tfaW50ZW5zaXR5W2ldO1xuICAgICAgICAgICAgICAgIGdmYy5waW5mby5lcnNbZ3Jfb3V0XVtjaG5dID0gZ2ZjLnBpbmZvLmVyc19zYXZlW2Nobl07XG4gICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLmVyc19zYXZlW2Nobl0gPSB4O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKiBjb21wYXJlIGVuZXJnaWVzIGJldHdlZW4gc3ViLXNob3J0YmxvY2tzICovXG4gICAgICAgICAgICBhdHRhY2tUaHJlc2hvbGQgPSAoY2huID09IDMpID8gZ2ZjLm5zUHN5LmF0dGFja3RocmVfc1xuICAgICAgICAgICAgICAgIDogZ2ZjLm5zUHN5LmF0dGFja3RocmU7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMTI7IGkrKylcbiAgICAgICAgICAgICAgICBpZiAoMCA9PSBuc19hdHRhY2tzW2kgLyAzXVxuICAgICAgICAgICAgICAgICAgICAmJiBhdHRhY2tfaW50ZW5zaXR5W2ldID4gYXR0YWNrVGhyZXNob2xkKVxuICAgICAgICAgICAgICAgICAgICBuc19hdHRhY2tzW2kgLyAzXSA9IChpICUgMykgKyAxO1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogc2hvdWxkIGhhdmUgZW5lcmd5IGNoYW5nZSBiZXR3ZWVuIHNob3J0IGJsb2NrcywgaW4gb3JkZXIgdG8gYXZvaWRcbiAgICAgICAgICAgICAqIHBlcmlvZGljIHNpZ25hbHNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZm9yIChpID0gMTsgaSA8IDQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciByYXRpbztcbiAgICAgICAgICAgICAgICBpZiAoZW5fc2hvcnRbaSAtIDFdID4gZW5fc2hvcnRbaV0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmF0aW8gPSBlbl9zaG9ydFtpIC0gMV0gLyBlbl9zaG9ydFtpXTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByYXRpbyA9IGVuX3Nob3J0W2ldIC8gZW5fc2hvcnRbaSAtIDFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocmF0aW8gPCAxLjcpIHtcbiAgICAgICAgICAgICAgICAgICAgbnNfYXR0YWNrc1tpXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpID09IDEpXG4gICAgICAgICAgICAgICAgICAgICAgICBuc19hdHRhY2tzWzBdID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChuc19hdHRhY2tzWzBdICE9IDAgJiYgZ2ZjLm5zUHN5Lmxhc3RBdHRhY2tzW2Nobl0gIT0gMClcbiAgICAgICAgICAgICAgICBuc19hdHRhY2tzWzBdID0gMDtcblxuICAgICAgICAgICAgaWYgKGdmYy5uc1BzeS5sYXN0QXR0YWNrc1tjaG5dID09IDNcbiAgICAgICAgICAgICAgICB8fCAobnNfYXR0YWNrc1swXSArIG5zX2F0dGFja3NbMV0gKyBuc19hdHRhY2tzWzJdICsgbnNfYXR0YWNrc1szXSkgIT0gMCkge1xuICAgICAgICAgICAgICAgIG5zX3VzZWxvbmdibG9jayA9IDA7XG5cbiAgICAgICAgICAgICAgICBpZiAobnNfYXR0YWNrc1sxXSAhPSAwICYmIG5zX2F0dGFja3NbMF0gIT0gMClcbiAgICAgICAgICAgICAgICAgICAgbnNfYXR0YWNrc1sxXSA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKG5zX2F0dGFja3NbMl0gIT0gMCAmJiBuc19hdHRhY2tzWzFdICE9IDApXG4gICAgICAgICAgICAgICAgICAgIG5zX2F0dGFja3NbMl0gPSAwO1xuICAgICAgICAgICAgICAgIGlmIChuc19hdHRhY2tzWzNdICE9IDAgJiYgbnNfYXR0YWNrc1syXSAhPSAwKVxuICAgICAgICAgICAgICAgICAgICBuc19hdHRhY2tzWzNdID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNobiA8IDIpIHtcbiAgICAgICAgICAgICAgICB1c2Vsb25nYmxvY2tbY2huXSA9IG5zX3VzZWxvbmdibG9jaztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKG5zX3VzZWxvbmdibG9jayA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHVzZWxvbmdibG9ja1swXSA9IHVzZWxvbmdibG9ja1sxXSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogdGhlcmUgaXMgYSBvbmUgZ3JhbnVsZSBkZWxheS4gQ29weSBtYXNraW5ncyBjb21wdXRlZCBsYXN0IGNhbGxcbiAgICAgICAgICAgICAqIGludG8gbWFza2luZ19yYXRpbyB0byByZXR1cm4gdG8gY2FsbGluZyBwcm9ncmFtLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBlbmVyZ3lbY2huXSA9IGdmYy50b3RfZW5lcltjaG5dO1xuXG4gICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAgICAgKiBjb21wdXRlIEZGVHNcbiAgICAgICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgICAgICB3c2FtcF9zID0gd3NhbXBfUztcbiAgICAgICAgICAgIHdzYW1wX2wgPSB3c2FtcF9MO1xuICAgICAgICAgICAgY29tcHV0ZV9mZnRzKGdmcCwgZmZ0ZW5lcmd5LCBmZnRlbmVyZ3lfcywgd3NhbXBfbCwgKGNobiAmIDEpLFxuICAgICAgICAgICAgICAgIHdzYW1wX3MsIChjaG4gJiAxKSwgZ3Jfb3V0LCBjaG4sIGJ1ZmZlciwgYnVmUG9zKTtcblxuICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgICAgICogQ2FsY3VsYXRlIHRoZSBlbmVyZ3kgYW5kIHRoZSB0b25hbGl0eSBvZiBlYWNoIHBhcnRpdGlvbi5cbiAgICAgICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgICAgICBjYWxjX2VuZXJneShnZmMsIGZmdGVuZXJneSwgZWJfbCwgbWF4LCBhdmcpO1xuICAgICAgICAgICAgY2FsY19tYXNrX2luZGV4X2woZ2ZjLCBtYXgsIGF2ZywgbWFza19pZHhfbCk7XG4gICAgICAgICAgICAvKiBjb21wdXRlIG1hc2tpbmcgdGhyZXNob2xkcyBmb3Igc2hvcnQgYmxvY2tzICovXG4gICAgICAgICAgICBmb3IgKHNibG9jayA9IDA7IHNibG9jayA8IDM7IHNibG9jaysrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVubiwgdGhtbTtcbiAgICAgICAgICAgICAgICBjb21wdXRlX21hc2tpbmdfcyhnZnAsIGZmdGVuZXJneV9zLCBlYl9zLCB0aHIsIGNobiwgc2Jsb2NrKTtcbiAgICAgICAgICAgICAgICBjb252ZXJ0X3BhcnRpdGlvbjJzY2FsZWZhY19zKGdmYywgZWJfcywgdGhyLCBjaG4sIHNibG9jayk7XG4gICAgICAgICAgICAgICAgLyoqKiogc2hvcnQgYmxvY2sgcHJlLWVjaG8gY29udHJvbCAqKioqL1xuICAgICAgICAgICAgICAgIGZvciAoc2IgPSAwOyBzYiA8IEVuY29kZXIuU0JNQVhfczsgc2IrKykge1xuICAgICAgICAgICAgICAgICAgICB0aG1tID0gZ2ZjLnRobVtjaG5dLnNbc2JdW3NibG9ja107XG5cbiAgICAgICAgICAgICAgICAgICAgdGhtbSAqPSBOU19QUkVFQ0hPX0FUVDA7XG4gICAgICAgICAgICAgICAgICAgIGlmIChuc19hdHRhY2tzW3NibG9ja10gPj0gMiB8fCBuc19hdHRhY2tzW3NibG9jayArIDFdID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSAoc2Jsb2NrICE9IDApID8gc2Jsb2NrIC0gMSA6IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IE5TX0lOVEVSUChnZmMudGhtW2Nobl0uc1tzYl1baWR4XSwgdGhtbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBOU19QUkVFQ0hPX0FUVDEgKiBwY2ZhY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhtbSA9IE1hdGgubWluKHRobW0sIHApO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG5zX2F0dGFja3Nbc2Jsb2NrXSA9PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gKHNibG9jayAhPSAwKSA/IHNibG9jayAtIDEgOiAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBOU19JTlRFUlAoZ2ZjLnRobVtjaG5dLnNbc2JdW2lkeF0sIHRobW0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTlNfUFJFRUNIT19BVFQyICogcGNmYWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRobW0gPSBNYXRoLm1pbih0aG1tLCBwKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoc2Jsb2NrICE9IDAgJiYgbnNfYXR0YWNrc1tzYmxvY2sgLSAxXSA9PSAzKVxuICAgICAgICAgICAgICAgICAgICAgICAgfHwgKHNibG9jayA9PSAwICYmIGdmYy5uc1BzeS5sYXN0QXR0YWNrc1tjaG5dID09IDMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gKHNibG9jayAhPSAyKSA/IHNibG9jayArIDEgOiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBOU19JTlRFUlAoZ2ZjLnRobVtjaG5dLnNbc2JdW2lkeF0sIHRobW0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTlNfUFJFRUNIT19BVFQyICogcGNmYWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRobW0gPSBNYXRoLm1pbih0aG1tLCBwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8qIHB1bHNlIGxpa2Ugc2lnbmFsIGRldGVjdGlvbiBmb3IgZmF0Ym95LndhdiBhbmQgc28gb24gKi9cbiAgICAgICAgICAgICAgICAgICAgZW5uID0gZW5fc3Vic2hvcnRbc2Jsb2NrICogMyArIDNdXG4gICAgICAgICAgICAgICAgICAgICAgICArIGVuX3N1YnNob3J0W3NibG9jayAqIDMgKyA0XVxuICAgICAgICAgICAgICAgICAgICAgICAgKyBlbl9zdWJzaG9ydFtzYmxvY2sgKiAzICsgNV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbl9zdWJzaG9ydFtzYmxvY2sgKiAzICsgNV0gKiA2IDwgZW5uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aG1tICo9IDAuNTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbl9zdWJzaG9ydFtzYmxvY2sgKiAzICsgNF0gKiA2IDwgZW5uKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRobW0gKj0gMC41O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnRobVtjaG5dLnNbc2JdW3NibG9ja10gPSB0aG1tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy5uc1BzeS5sYXN0QXR0YWNrc1tjaG5dID0gbnNfYXR0YWNrc1syXTtcblxuICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgICAgICogY29udm9sdmUgdGhlIHBhcnRpdGlvbmVkIGVuZXJneSBhbmQgdW5wcmVkaWN0YWJpbGl0eSB3aXRoIHRoZVxuICAgICAgICAgICAgICogc3ByZWFkaW5nIGZ1bmN0aW9uLCBzM19sW2JdW2tdXG4gICAgICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgICAgICBrID0gMDtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBmb3IgKGIgPSAwOyBiIDwgZ2ZjLm5wYXJ0X2w7IGIrKykge1xuICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgKiBjb252b2x2ZSB0aGUgcGFydGl0aW9uZWQgZW5lcmd5IHdpdGggdGhlIHNwcmVhZGluZ1xuICAgICAgICAgICAgICAgICAgICAgKiBmdW5jdGlvblxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgdmFyIGtrID0gZ2ZjLnMzaW5kW2JdWzBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWIyID0gZWJfbFtra10gKiB0YWJbbWFza19pZHhfbFtra11dO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZWNiID0gZ2ZjLnMzX2xsW2srK10gKiBlYjI7XG4gICAgICAgICAgICAgICAgICAgIHdoaWxlICgrK2trIDw9IGdmYy5zM2luZFtiXVsxXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZWIyID0gZWJfbFtra10gKiB0YWJbbWFza19pZHhfbFtra11dO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWNiID0gbWFza19hZGQoZWNiLCBnZmMuczNfbGxbaysrXSAqIGViMiwga2ssIGtrIC0gYixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZmMsIDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVjYiAqPSAwLjE1ODQ4OTMxOTI0NjExMTtcbiAgICAgICAgICAgICAgICAgICAgLyogcG93KDEwLC0wLjgpICovXG5cbiAgICAgICAgICAgICAgICAgICAgLyoqKiogbG9uZyBibG9jayBwcmUtZWNobyBjb250cm9sICoqKiovXG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiA8UFJFPlxuICAgICAgICAgICAgICAgICAgICAgKiBkb250IHVzZSBsb25nIGJsb2NrIHByZS1lY2hvIGNvbnRyb2wgaWYgcHJldmlvdXMgZ3JhbnVsZSB3YXNcbiAgICAgICAgICAgICAgICAgICAgICogYSBzaG9ydCBibG9jay4gIFRoaXMgaXMgdG8gYXZvaWQgdGhlIHNpdHVhdGlvbjpcbiAgICAgICAgICAgICAgICAgICAgICogZnJhbWUwOiAgcXVpZXQgKHZlcnkgbG93IG1hc2tpbmcpXG4gICAgICAgICAgICAgICAgICAgICAqIGZyYW1lMTogIHN1cmdlICAodHJpZ2dlcnMgc2hvcnQgYmxvY2tzKVxuICAgICAgICAgICAgICAgICAgICAgKiBmcmFtZTI6ICByZWd1bGFyIGZyYW1lLiAgbG9va3MgbGlrZSBwcmUtZWNobyB3aGVuIGNvbXBhcmVkIHRvXG4gICAgICAgICAgICAgICAgICAgICAqICAgICAgICAgIGZyYW1lMCwgYnV0IGFsbCBwcmUtZWNobyB3YXMgaW4gZnJhbWUxLlxuICAgICAgICAgICAgICAgICAgICAgKiA8L1BSRT5cbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAqIGNobj0wLDEgTCBhbmQgUiBjaGFubmVsc1xuICAgICAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAgICAgKiBjaG49MiwzIFMgYW5kIE0gY2hhbm5lbHMuXG4gICAgICAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChnZmMuYmxvY2t0eXBlX29sZFtjaG4gJiAxXSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJbYl0gPSBlY2I7XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocltiXSA9IE5TX0lOVEVSUChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihlY2IsIE1hdGgubWluKHJwZWxldlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGdmYy5uYl8xW2Nobl1bYl0sIHJwZWxldjJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBnZmMubmJfMltjaG5dW2JdKSksIGVjYiwgcGNmYWN0KTtcblxuICAgICAgICAgICAgICAgICAgICBnZmMubmJfMltjaG5dW2JdID0gZ2ZjLm5iXzFbY2huXVtiXTtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLm5iXzFbY2huXVtiXSA9IGVjYjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKDsgYiA8PSBFbmNvZGVyLkNCQU5EUzsgKytiKSB7XG4gICAgICAgICAgICAgICAgZWJfbFtiXSA9IDA7XG4gICAgICAgICAgICAgICAgdGhyW2JdID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIGNvbXB1dGUgbWFza2luZyB0aHJlc2hvbGRzIGZvciBsb25nIGJsb2NrcyAqL1xuICAgICAgICAgICAgY29udmVydF9wYXJ0aXRpb24yc2NhbGVmYWNfbChnZmMsIGViX2wsIHRociwgY2huKTtcbiAgICAgICAgfVxuICAgICAgICAvKiBlbmQgbG9vcCBvdmVyIGNobiAqL1xuXG4gICAgICAgIGlmIChnZnAubW9kZSA9PSBNUEVHTW9kZS5TVEVSRU8gfHwgZ2ZwLm1vZGUgPT0gTVBFR01vZGUuSk9JTlRfU1RFUkVPKSB7XG4gICAgICAgICAgICBpZiAoZ2ZwLmludGVyQ2hSYXRpbyA+IDAuMCkge1xuICAgICAgICAgICAgICAgIGNhbGNfaW50ZXJjaGFubmVsX21hc2tpbmcoZ2ZwLCBnZnAuaW50ZXJDaFJhdGlvKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChnZnAubW9kZSA9PSBNUEVHTW9kZS5KT0lOVF9TVEVSRU8pIHtcbiAgICAgICAgICAgIHZhciBtc2ZpeDtcbiAgICAgICAgICAgIG1zZml4MShnZmMpO1xuICAgICAgICAgICAgbXNmaXggPSBnZnAubXNmaXg7XG4gICAgICAgICAgICBpZiAoTWF0aC5hYnMobXNmaXgpID4gMC4wKVxuICAgICAgICAgICAgICAgIG5zX21zZml4KGdmYywgbXNmaXgsIGdmcC5BVEhsb3dlciAqIGdmYy5BVEguYWRqdXN0KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogZGV0ZXJtaW5lIGZpbmFsIGJsb2NrIHR5cGVcbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgYmxvY2tfdHlwZV9zZXQoZ2ZwLCB1c2Vsb25nYmxvY2ssIGJsb2NrdHlwZV9kLCBibG9ja3R5cGUpO1xuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogY29tcHV0ZSB0aGUgdmFsdWUgb2YgUEUgdG8gcmV0dXJuIC4uLiBubyBkZWxheSBhbmQgYWR2YW5jZVxuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICBmb3IgKGNobiA9IDA7IGNobiA8IG51bWNobjsgY2huKyspIHtcbiAgICAgICAgICAgIHZhciBwcGU7XG4gICAgICAgICAgICB2YXIgcHBlUG9zID0gMDtcbiAgICAgICAgICAgIHZhciB0eXBlO1xuICAgICAgICAgICAgdmFyIG1yO1xuXG4gICAgICAgICAgICBpZiAoY2huID4gMSkge1xuICAgICAgICAgICAgICAgIHBwZSA9IHBlcmNlcF9NU19lbnRyb3B5O1xuICAgICAgICAgICAgICAgIHBwZVBvcyA9IC0yO1xuICAgICAgICAgICAgICAgIHR5cGUgPSBFbmNvZGVyLk5PUk1fVFlQRTtcbiAgICAgICAgICAgICAgICBpZiAoYmxvY2t0eXBlX2RbMF0gPT0gRW5jb2Rlci5TSE9SVF9UWVBFXG4gICAgICAgICAgICAgICAgICAgIHx8IGJsb2NrdHlwZV9kWzFdID09IEVuY29kZXIuU0hPUlRfVFlQRSlcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9IEVuY29kZXIuU0hPUlRfVFlQRTtcbiAgICAgICAgICAgICAgICBtciA9IG1hc2tpbmdfTVNfcmF0aW9bZ3Jfb3V0XVtjaG4gLSAyXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcHBlID0gcGVyY2VwX2VudHJvcHk7XG4gICAgICAgICAgICAgICAgcHBlUG9zID0gMDtcbiAgICAgICAgICAgICAgICB0eXBlID0gYmxvY2t0eXBlX2RbY2huXTtcbiAgICAgICAgICAgICAgICBtciA9IG1hc2tpbmdfcmF0aW9bZ3Jfb3V0XVtjaG5dO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpXG4gICAgICAgICAgICAgICAgcHBlW3BwZVBvcyArIGNobl0gPSBwZWNhbGNfcyhtciwgZ2ZjLm1hc2tpbmdfbG93ZXIpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHBwZVtwcGVQb3MgKyBjaG5dID0gcGVjYWxjX2wobXIsIGdmYy5tYXNraW5nX2xvd2VyKTtcblxuICAgICAgICAgICAgaWYgKGdmcC5hbmFseXNpcylcbiAgICAgICAgICAgICAgICBnZmMucGluZm8ucGVbZ3Jfb3V0XVtjaG5dID0gcHBlW3BwZVBvcyArIGNobl07XG5cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB2YnJwc3lfY29tcHV0ZV9mZnRfbChnZnAsIGJ1ZmZlciwgYnVmUG9zLCBjaG4sIGdyX291dCwgZmZ0ZW5lcmd5LCB3c2FtcF9sLCB3c2FtcF9sUG9zKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIGlmIChjaG4gPCAyKSB7XG4gICAgICAgICAgICBmZnQuZmZ0X2xvbmcoZ2ZjLCB3c2FtcF9sW3dzYW1wX2xQb3NdLCBjaG4sIGJ1ZmZlciwgYnVmUG9zKTtcbiAgICAgICAgfSBlbHNlIGlmIChjaG4gPT0gMikge1xuICAgICAgICAgICAgLyogRkZUIGRhdGEgZm9yIG1pZCBhbmQgc2lkZSBjaGFubmVsIGlzIGRlcml2ZWQgZnJvbSBMICYgUiAqL1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IEVuY29kZXIuQkxLU0laRSAtIDE7IGogPj0gMDsgLS1qKSB7XG4gICAgICAgICAgICAgICAgdmFyIGwgPSB3c2FtcF9sW3dzYW1wX2xQb3MgKyAwXVtqXTtcbiAgICAgICAgICAgICAgICB2YXIgciA9IHdzYW1wX2xbd3NhbXBfbFBvcyArIDFdW2pdO1xuICAgICAgICAgICAgICAgIHdzYW1wX2xbd3NhbXBfbFBvcyArIDBdW2pdID0gKGwgKyByKSAqIFV0aWwuU1FSVDIgKiAwLjU7XG4gICAgICAgICAgICAgICAgd3NhbXBfbFt3c2FtcF9sUG9zICsgMV1bal0gPSAobCAtIHIpICogVXRpbC5TUVJUMiAqIDAuNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogY29tcHV0ZSBlbmVyZ2llc1xuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICBmZnRlbmVyZ3lbMF0gPSBOT05fTElORUFSX1NDQUxFX0VORVJHWSh3c2FtcF9sW3dzYW1wX2xQb3MgKyAwXVswXSk7XG4gICAgICAgIGZmdGVuZXJneVswXSAqPSBmZnRlbmVyZ3lbMF07XG5cbiAgICAgICAgZm9yICh2YXIgaiA9IEVuY29kZXIuQkxLU0laRSAvIDIgLSAxOyBqID49IDA7IC0taikge1xuICAgICAgICAgICAgdmFyIHJlID0gd3NhbXBfbFt3c2FtcF9sUG9zICsgMF1bRW5jb2Rlci5CTEtTSVpFIC8gMiAtIGpdO1xuICAgICAgICAgICAgdmFyIGltID0gd3NhbXBfbFt3c2FtcF9sUG9zICsgMF1bRW5jb2Rlci5CTEtTSVpFIC8gMiArIGpdO1xuICAgICAgICAgICAgZmZ0ZW5lcmd5W0VuY29kZXIuQkxLU0laRSAvIDIgLSBqXSA9IE5PTl9MSU5FQVJfU0NBTEVfRU5FUkdZKChyZVxuICAgICAgICAgICAgICAgICogcmUgKyBpbSAqIGltKSAqIDAuNSk7XG4gICAgICAgIH1cbiAgICAgICAgLyogdG90YWwgZW5lcmd5ICovXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciB0b3RhbGVuZXJneSA9IDAuMDtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAxMTsgaiA8IEVuY29kZXIuSEJMS1NJWkU7IGorKylcbiAgICAgICAgICAgICAgICB0b3RhbGVuZXJneSArPSBmZnRlbmVyZ3lbal07XG5cbiAgICAgICAgICAgIGdmYy50b3RfZW5lcltjaG5dID0gdG90YWxlbmVyZ3k7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ2ZwLmFuYWx5c2lzKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IEVuY29kZXIuSEJMS1NJWkU7IGorKykge1xuICAgICAgICAgICAgICAgIGdmYy5waW5mby5lbmVyZ3lbZ3Jfb3V0XVtjaG5dW2pdID0gZ2ZjLnBpbmZvLmVuZXJneV9zYXZlW2Nobl1bal07XG4gICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLmVuZXJneV9zYXZlW2Nobl1bal0gPSBmZnRlbmVyZ3lbal07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMucGluZm8ucGVbZ3Jfb3V0XVtjaG5dID0gZ2ZjLnBlW2Nobl07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiB2YnJwc3lfY29tcHV0ZV9mZnRfcyhnZnAsIGJ1ZmZlciwgYnVmUG9zLCBjaG4sIHNibG9jaywgZmZ0ZW5lcmd5X3MsIHdzYW1wX3MsIHdzYW1wX3NQb3MpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblxuICAgICAgICBpZiAoc2Jsb2NrID09IDAgJiYgY2huIDwgMikge1xuICAgICAgICAgICAgZmZ0LmZmdF9zaG9ydChnZmMsIHdzYW1wX3Nbd3NhbXBfc1Bvc10sIGNobiwgYnVmZmVyLCBidWZQb3MpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjaG4gPT0gMikge1xuICAgICAgICAgICAgLyogRkZUIGRhdGEgZm9yIG1pZCBhbmQgc2lkZSBjaGFubmVsIGlzIGRlcml2ZWQgZnJvbSBMICYgUiAqL1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IEVuY29kZXIuQkxLU0laRV9zIC0gMTsgaiA+PSAwOyAtLWopIHtcbiAgICAgICAgICAgICAgICB2YXIgbCA9IHdzYW1wX3Nbd3NhbXBfc1BvcyArIDBdW3NibG9ja11bal07XG4gICAgICAgICAgICAgICAgdmFyIHIgPSB3c2FtcF9zW3dzYW1wX3NQb3MgKyAxXVtzYmxvY2tdW2pdO1xuICAgICAgICAgICAgICAgIHdzYW1wX3Nbd3NhbXBfc1BvcyArIDBdW3NibG9ja11bal0gPSAobCArIHIpICogVXRpbC5TUVJUMiAqIDAuNTtcbiAgICAgICAgICAgICAgICB3c2FtcF9zW3dzYW1wX3NQb3MgKyAxXVtzYmxvY2tdW2pdID0gKGwgLSByKSAqIFV0aWwuU1FSVDIgKiAwLjU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIGNvbXB1dGUgZW5lcmdpZXNcbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgZmZ0ZW5lcmd5X3Nbc2Jsb2NrXVswXSA9IHdzYW1wX3Nbd3NhbXBfc1BvcyArIDBdW3NibG9ja11bMF07XG4gICAgICAgIGZmdGVuZXJneV9zW3NibG9ja11bMF0gKj0gZmZ0ZW5lcmd5X3Nbc2Jsb2NrXVswXTtcbiAgICAgICAgZm9yICh2YXIgaiA9IEVuY29kZXIuQkxLU0laRV9zIC8gMiAtIDE7IGogPj0gMDsgLS1qKSB7XG4gICAgICAgICAgICB2YXIgcmUgPSB3c2FtcF9zW3dzYW1wX3NQb3MgKyAwXVtzYmxvY2tdW0VuY29kZXIuQkxLU0laRV9zIC8gMiAtIGpdO1xuICAgICAgICAgICAgdmFyIGltID0gd3NhbXBfc1t3c2FtcF9zUG9zICsgMF1bc2Jsb2NrXVtFbmNvZGVyLkJMS1NJWkVfcyAvIDIgKyBqXTtcbiAgICAgICAgICAgIGZmdGVuZXJneV9zW3NibG9ja11bRW5jb2Rlci5CTEtTSVpFX3MgLyAyIC0gal0gPSBOT05fTElORUFSX1NDQUxFX0VORVJHWSgocmVcbiAgICAgICAgICAgICAgICAqIHJlICsgaW0gKiBpbSkgKiAwLjUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY29tcHV0ZSBsb3VkbmVzcyBhcHByb3hpbWF0aW9uICh1c2VkIGZvciBBVEggYXV0by1sZXZlbCBhZGp1c3RtZW50KVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHZicnBzeV9jb21wdXRlX2xvdWRuZXNzX2FwcHJveGltYXRpb25fbChnZnAsIGdyX291dCwgY2huLCBmZnRlbmVyZ3kpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgaWYgKGdmcC5hdGhhYV9sb3VkYXBwcm94ID09IDIgJiYgY2huIDwgMikge1xuICAgICAgICAgICAgLy8gbm8gbG91ZG5lc3MgZm9yIG1pZC9zaWRlIGNoXG4gICAgICAgICAgICBnZmMubG91ZG5lc3Nfc3FbZ3Jfb3V0XVtjaG5dID0gZ2ZjLmxvdWRuZXNzX3NxX3NhdmVbY2huXTtcbiAgICAgICAgICAgIGdmYy5sb3VkbmVzc19zcV9zYXZlW2Nobl0gPSBwc3ljaG9fbG91ZG5lc3NfYXBwcm94KGZmdGVuZXJneSwgZ2ZjKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHZhciBmaXJjb2VmXyA9IFstOC42NTE2M2UtMTggKiAyLFxuICAgICAgICAtMC4wMDg1MTU4NiAqIDIsIC02Ljc0NzY0ZS0xOCAqIDIsIDAuMDIwOTAzNiAqIDIsXG4gICAgICAgIC0zLjM2NjM5ZS0xNyAqIDIsIC0wLjA0MzgxNjIgKiAyLCAtMS41NDE3NWUtMTcgKiAyLFxuICAgICAgICAwLjA5MzE3MzggKiAyLCAtNS41MjIxMmUtMTcgKiAyLCAtMC4zMTM4MTkgKiAyXTtcblxuICAgIC8qKlxuICAgICAqIEFwcGx5IEhQRiBvZiBmcy80IHRvIHRoZSBpbnB1dCBzaWduYWwuIFRoaXMgaXMgdXNlZCBmb3IgYXR0YWNrIGRldGVjdGlvblxuICAgICAqIC8gaGFuZGxpbmcuXG4gICAgICovXG4gICAgZnVuY3Rpb24gdmJycHN5X2F0dGFja19kZXRlY3Rpb24oZ2ZwLCBidWZmZXIsIGJ1ZlBvcywgZ3Jfb3V0LCBtYXNraW5nX3JhdGlvLCBtYXNraW5nX01TX3JhdGlvLCBlbmVyZ3ksIHN1Yl9zaG9ydF9mYWN0b3IsIG5zX2F0dGFja3MsIHVzZWxvbmdibG9jaykge1xuICAgICAgICB2YXIgbnNfaHBmc21wbCA9IG5ld19mbG9hdF9uKFsyLCA1NzZdKTtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIG5fY2huX291dCA9IGdmYy5jaGFubmVsc19vdXQ7XG4gICAgICAgIC8qIGNobj0yIGFuZCAzID0gTWlkIGFuZCBTaWRlIGNoYW5uZWxzICovXG4gICAgICAgIHZhciBuX2Nobl9wc3kgPSAoZ2ZwLm1vZGUgPT0gTVBFR01vZGUuSk9JTlRfU1RFUkVPKSA/IDQgOiBuX2Nobl9vdXQ7XG4gICAgICAgIC8qIERvbid0IGNvcHkgdGhlIGlucHV0IGJ1ZmZlciBpbnRvIGEgdGVtcG9yYXJ5IGJ1ZmZlciAqL1xuICAgICAgICAvKiB1bnJvbGwgdGhlIGxvb3AgMiB0aW1lcyAqL1xuICAgICAgICBmb3IgKHZhciBjaG4gPSAwOyBjaG4gPCBuX2Nobl9vdXQ7IGNobisrKSB7XG4gICAgICAgICAgICAvKiBhcHBseSBoaWdoIHBhc3MgZmlsdGVyIG9mIGZzLzQgKi9cbiAgICAgICAgICAgIGZpcmJ1ZiA9IGJ1ZmZlcltjaG5dO1xuICAgICAgICAgICAgdmFyIGZpcmJ1ZlBvcyA9IGJ1ZlBvcyArIDU3NiAtIDM1MCAtIE5TRklSTEVOICsgMTkyO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1NzY7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBzdW0xLCBzdW0yO1xuICAgICAgICAgICAgICAgIHN1bTEgPSBmaXJidWZbZmlyYnVmUG9zICsgaSArIDEwXTtcbiAgICAgICAgICAgICAgICBzdW0yID0gMC4wO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgKChOU0ZJUkxFTiAtIDEpIC8gMikgLSAxOyBqICs9IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VtMSArPSBmaXJjb2VmX1tqXVxuICAgICAgICAgICAgICAgICAgICAgICAgKiAoZmlyYnVmW2ZpcmJ1ZlBvcyArIGkgKyBqXSArIGZpcmJ1ZltmaXJidWZQb3MgKyBpXG4gICAgICAgICAgICAgICAgICAgICAgICArIE5TRklSTEVOIC0gal0pO1xuICAgICAgICAgICAgICAgICAgICBzdW0yICs9IGZpcmNvZWZfW2ogKyAxXVxuICAgICAgICAgICAgICAgICAgICAgICAgKiAoZmlyYnVmW2ZpcmJ1ZlBvcyArIGkgKyBqICsgMV0gKyBmaXJidWZbZmlyYnVmUG9zXG4gICAgICAgICAgICAgICAgICAgICAgICArIGkgKyBOU0ZJUkxFTiAtIGogLSAxXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIG5zX2hwZnNtcGxbY2huXVtpXSA9IHN1bTEgKyBzdW0yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWFza2luZ19yYXRpb1tncl9vdXRdW2Nobl0uZW4uYXNzaWduKGdmYy5lbltjaG5dKTtcbiAgICAgICAgICAgIG1hc2tpbmdfcmF0aW9bZ3Jfb3V0XVtjaG5dLnRobS5hc3NpZ24oZ2ZjLnRobVtjaG5dKTtcbiAgICAgICAgICAgIGlmIChuX2Nobl9wc3kgPiAyKSB7XG4gICAgICAgICAgICAgICAgLyogTVMgbWFza2luZ3MgKi9cbiAgICAgICAgICAgICAgICAvKiBwZXJjZXBfTVNfZW50cm9weSBbY2huLTJdID0gZ2ZjIC4gcGUgW2Nobl07ICovXG4gICAgICAgICAgICAgICAgbWFza2luZ19NU19yYXRpb1tncl9vdXRdW2Nobl0uZW4uYXNzaWduKGdmYy5lbltjaG4gKyAyXSk7XG4gICAgICAgICAgICAgICAgbWFza2luZ19NU19yYXRpb1tncl9vdXRdW2Nobl0udGhtLmFzc2lnbihnZmMudGhtW2NobiArIDJdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBjaG4gPSAwOyBjaG4gPCBuX2Nobl9wc3k7IGNobisrKSB7XG4gICAgICAgICAgICB2YXIgYXR0YWNrX2ludGVuc2l0eSA9IG5ld19mbG9hdCgxMik7XG4gICAgICAgICAgICB2YXIgZW5fc3Vic2hvcnQgPSBuZXdfZmxvYXQoMTIpO1xuICAgICAgICAgICAgdmFyIGVuX3Nob3J0ID0gWzAsIDAsIDAsIDBdO1xuICAgICAgICAgICAgdmFyIHBmID0gbnNfaHBmc21wbFtjaG4gJiAxXTtcbiAgICAgICAgICAgIHZhciBwZlBvcyA9IDA7XG4gICAgICAgICAgICB2YXIgYXR0YWNrVGhyZXNob2xkID0gKGNobiA9PSAzKSA/IGdmYy5uc1BzeS5hdHRhY2t0aHJlX3NcbiAgICAgICAgICAgICAgICA6IGdmYy5uc1BzeS5hdHRhY2t0aHJlO1xuICAgICAgICAgICAgdmFyIG5zX3VzZWxvbmdibG9jayA9IDE7XG5cbiAgICAgICAgICAgIGlmIChjaG4gPT0gMikge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBqID0gNTc2OyBqID4gMDsgKytpLCAtLWopIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGwgPSBuc19ocGZzbXBsWzBdW2ldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgciA9IG5zX2hwZnNtcGxbMV1baV07XG4gICAgICAgICAgICAgICAgICAgIG5zX2hwZnNtcGxbMF1baV0gPSBsICsgcjtcbiAgICAgICAgICAgICAgICAgICAgbnNfaHBmc21wbFsxXVtpXSA9IGwgLSByO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICAgICAqIGRldGVybWluZSB0aGUgYmxvY2sgdHlwZSAod2luZG93IHR5cGUpXG4gICAgICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICAgICAgLyogY2FsY3VsYXRlIGVuZXJnaWVzIG9mIGVhY2ggc3ViLXNob3J0YmxvY2tzICovXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDM7IGkrKykge1xuICAgICAgICAgICAgICAgIGVuX3N1YnNob3J0W2ldID0gZ2ZjLm5zUHN5Lmxhc3RfZW5fc3Vic2hvcnRbY2huXVtpICsgNl07XG4gICAgICAgICAgICAgICAgYXR0YWNrX2ludGVuc2l0eVtpXSA9IGVuX3N1YnNob3J0W2ldXG4gICAgICAgICAgICAgICAgICAgIC8gZ2ZjLm5zUHN5Lmxhc3RfZW5fc3Vic2hvcnRbY2huXVtpICsgNF07XG4gICAgICAgICAgICAgICAgZW5fc2hvcnRbMF0gKz0gZW5fc3Vic2hvcnRbaV07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgOTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBmZSA9IHBmUG9zICsgNTc2IC8gOTtcbiAgICAgICAgICAgICAgICB2YXIgcCA9IDEuO1xuICAgICAgICAgICAgICAgIGZvciAoOyBwZlBvcyA8IHBmZTsgcGZQb3MrKylcbiAgICAgICAgICAgICAgICAgICAgaWYgKHAgPCBNYXRoLmFicyhwZltwZlBvc10pKVxuICAgICAgICAgICAgICAgICAgICAgICAgcCA9IE1hdGguYWJzKHBmW3BmUG9zXSk7XG5cbiAgICAgICAgICAgICAgICBnZmMubnNQc3kubGFzdF9lbl9zdWJzaG9ydFtjaG5dW2ldID0gZW5fc3Vic2hvcnRbaSArIDNdID0gcDtcbiAgICAgICAgICAgICAgICBlbl9zaG9ydFsxICsgaSAvIDNdICs9IHA7XG4gICAgICAgICAgICAgICAgaWYgKHAgPiBlbl9zdWJzaG9ydFtpICsgMyAtIDJdKSB7XG4gICAgICAgICAgICAgICAgICAgIHAgPSBwIC8gZW5fc3Vic2hvcnRbaSArIDMgLSAyXTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGVuX3N1YnNob3J0W2kgKyAzIC0gMl0gPiBwICogMTAuMCkge1xuICAgICAgICAgICAgICAgICAgICBwID0gZW5fc3Vic2hvcnRbaSArIDMgLSAyXSAvIChwICogMTAuMCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcCA9IDAuMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgYXR0YWNrX2ludGVuc2l0eVtpICsgM10gPSBwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogcHVsc2UgbGlrZSBzaWduYWwgZGV0ZWN0aW9uIGZvciBmYXRib3kud2F2IGFuZCBzbyBvbiAqL1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyArK2kpIHtcbiAgICAgICAgICAgICAgICB2YXIgZW5uID0gZW5fc3Vic2hvcnRbaSAqIDMgKyAzXVxuICAgICAgICAgICAgICAgICAgICArIGVuX3N1YnNob3J0W2kgKiAzICsgNF0gKyBlbl9zdWJzaG9ydFtpICogMyArIDVdO1xuICAgICAgICAgICAgICAgIHZhciBmYWN0b3IgPSAxLjtcbiAgICAgICAgICAgICAgICBpZiAoZW5fc3Vic2hvcnRbaSAqIDMgKyA1XSAqIDYgPCBlbm4pIHtcbiAgICAgICAgICAgICAgICAgICAgZmFjdG9yICo9IDAuNTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVuX3N1YnNob3J0W2kgKiAzICsgNF0gKiA2IDwgZW5uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3IgKj0gMC41O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN1Yl9zaG9ydF9mYWN0b3JbY2huXVtpXSA9IGZhY3RvcjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGdmcC5hbmFseXNpcykge1xuICAgICAgICAgICAgICAgIHZhciB4ID0gYXR0YWNrX2ludGVuc2l0eVswXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IDEyOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHggPCBhdHRhY2tfaW50ZW5zaXR5W2ldKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4ID0gYXR0YWNrX2ludGVuc2l0eVtpXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBnZmMucGluZm8uZXJzW2dyX291dF1bY2huXSA9IGdmYy5waW5mby5lcnNfc2F2ZVtjaG5dO1xuICAgICAgICAgICAgICAgIGdmYy5waW5mby5lcnNfc2F2ZVtjaG5dID0geDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyogY29tcGFyZSBlbmVyZ2llcyBiZXR3ZWVuIHN1Yi1zaG9ydGJsb2NrcyAqL1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxMjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKDAgPT0gbnNfYXR0YWNrc1tjaG5dW2kgLyAzXVxuICAgICAgICAgICAgICAgICAgICAmJiBhdHRhY2tfaW50ZW5zaXR5W2ldID4gYXR0YWNrVGhyZXNob2xkKSB7XG4gICAgICAgICAgICAgICAgICAgIG5zX2F0dGFja3NbY2huXVtpIC8gM10gPSAoaSAlIDMpICsgMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBzaG91bGQgaGF2ZSBlbmVyZ3kgY2hhbmdlIGJldHdlZW4gc2hvcnQgYmxvY2tzLCBpbiBvcmRlciB0byBhdm9pZFxuICAgICAgICAgICAgICogcGVyaW9kaWMgc2lnbmFsc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICAvKiBHb29kIHNhbXBsZXMgdG8gc2hvdyB0aGUgZWZmZWN0IGFyZSBUcnVtcGV0IHRlc3Qgc29uZ3MgKi9cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBHQjogdHVuZWQgKDEpIHRvIGF2b2lkIHRvbyBtYW55IHNob3J0IGJsb2NrcyBmb3IgdGVzdCBzYW1wbGVcbiAgICAgICAgICAgICAqIFRSVU1QRVRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIFJIOiB0dW5lZCAoMikgdG8gbGV0IGVub3VnaCBzaG9ydCBibG9ja3MgdGhyb3VnaCBmb3IgdGVzdCBzYW1wbGVcbiAgICAgICAgICAgICAqIEZTT0wgYW5kIFNOQVBTXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgNDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHUgPSBlbl9zaG9ydFtpIC0gMV07XG4gICAgICAgICAgICAgICAgdmFyIHYgPSBlbl9zaG9ydFtpXTtcbiAgICAgICAgICAgICAgICB2YXIgbSA9IE1hdGgubWF4KHUsIHYpO1xuICAgICAgICAgICAgICAgIGlmIChtIDwgNDAwMDApIHsgLyogKDIpICovXG4gICAgICAgICAgICAgICAgICAgIGlmICh1IDwgMS43ICogdiAmJiB2IDwgMS43ICogdSkgeyAvKiAoMSkgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpID09IDEgJiYgbnNfYXR0YWNrc1tjaG5dWzBdIDw9IG5zX2F0dGFja3NbY2huXVtpXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5zX2F0dGFja3NbY2huXVswXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBuc19hdHRhY2tzW2Nobl1baV0gPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobnNfYXR0YWNrc1tjaG5dWzBdIDw9IGdmYy5uc1BzeS5sYXN0QXR0YWNrc1tjaG5dKSB7XG4gICAgICAgICAgICAgICAgbnNfYXR0YWNrc1tjaG5dWzBdID0gMDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGdmYy5uc1BzeS5sYXN0QXR0YWNrc1tjaG5dID09IDNcbiAgICAgICAgICAgICAgICB8fCAobnNfYXR0YWNrc1tjaG5dWzBdICsgbnNfYXR0YWNrc1tjaG5dWzFdXG4gICAgICAgICAgICAgICAgKyBuc19hdHRhY2tzW2Nobl1bMl0gKyBuc19hdHRhY2tzW2Nobl1bM10pICE9IDApIHtcbiAgICAgICAgICAgICAgICBuc191c2Vsb25nYmxvY2sgPSAwO1xuXG4gICAgICAgICAgICAgICAgaWYgKG5zX2F0dGFja3NbY2huXVsxXSAhPSAwICYmIG5zX2F0dGFja3NbY2huXVswXSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIG5zX2F0dGFja3NbY2huXVsxXSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChuc19hdHRhY2tzW2Nobl1bMl0gIT0gMCAmJiBuc19hdHRhY2tzW2Nobl1bMV0gIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBuc19hdHRhY2tzW2Nobl1bMl0gPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobnNfYXR0YWNrc1tjaG5dWzNdICE9IDAgJiYgbnNfYXR0YWNrc1tjaG5dWzJdICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbnNfYXR0YWNrc1tjaG5dWzNdID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY2huIDwgMikge1xuICAgICAgICAgICAgICAgIHVzZWxvbmdibG9ja1tjaG5dID0gbnNfdXNlbG9uZ2Jsb2NrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAobnNfdXNlbG9uZ2Jsb2NrID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdXNlbG9uZ2Jsb2NrWzBdID0gdXNlbG9uZ2Jsb2NrWzFdID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiB0aGVyZSBpcyBhIG9uZSBncmFudWxlIGRlbGF5LiBDb3B5IG1hc2tpbmdzIGNvbXB1dGVkIGxhc3QgY2FsbFxuICAgICAgICAgICAgICogaW50byBtYXNraW5nX3JhdGlvIHRvIHJldHVybiB0byBjYWxsaW5nIHByb2dyYW0uXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGVuZXJneVtjaG5dID0gZ2ZjLnRvdF9lbmVyW2Nobl07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiB2YnJwc3lfc2tpcF9tYXNraW5nX3MoZ2ZjLCBjaG4sIHNibG9jaykge1xuICAgICAgICBpZiAoc2Jsb2NrID09IDApIHtcbiAgICAgICAgICAgIGZvciAodmFyIGIgPSAwOyBiIDwgZ2ZjLm5wYXJ0X3M7IGIrKykge1xuICAgICAgICAgICAgICAgIGdmYy5uYl9zMltjaG5dW2JdID0gZ2ZjLm5iX3MxW2Nobl1bYl07XG4gICAgICAgICAgICAgICAgZ2ZjLm5iX3MxW2Nobl1bYl0gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdmJycHN5X3NraXBfbWFza2luZ19sKGdmYywgY2huKSB7XG4gICAgICAgIGZvciAodmFyIGIgPSAwOyBiIDwgZ2ZjLm5wYXJ0X2w7IGIrKykge1xuICAgICAgICAgICAgZ2ZjLm5iXzJbY2huXVtiXSA9IGdmYy5uYl8xW2Nobl1bYl07XG4gICAgICAgICAgICBnZmMubmJfMVtjaG5dW2JdID0gMDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBzeXZicl9jYWxjX21hc2tfaW5kZXhfcyhnZmMsIG1heCwgYXZnLCBtYXNrX2lkeCkge1xuICAgICAgICB2YXIgbGFzdF90YWJfZW50cnkgPSB0YWIubGVuZ3RoIC0gMTtcbiAgICAgICAgdmFyIGIgPSAwO1xuICAgICAgICB2YXIgYSA9IGF2Z1tiXSArIGF2Z1tiICsgMV07XG4gICAgICAgIGlmIChhID4gMC4wKSB7XG4gICAgICAgICAgICB2YXIgbSA9IG1heFtiXTtcbiAgICAgICAgICAgIGlmIChtIDwgbWF4W2IgKyAxXSlcbiAgICAgICAgICAgICAgICBtID0gbWF4W2IgKyAxXTtcbiAgICAgICAgICAgIGEgPSAyMC4wICogKG0gKiAyLjAgLSBhKVxuICAgICAgICAgICAgICAgIC8gKGEgKiAoZ2ZjLm51bWxpbmVzX3NbYl0gKyBnZmMubnVtbGluZXNfc1tiICsgMV0gLSAxKSk7XG4gICAgICAgICAgICB2YXIgayA9IDAgfCBhO1xuICAgICAgICAgICAgaWYgKGsgPiBsYXN0X3RhYl9lbnRyeSlcbiAgICAgICAgICAgICAgICBrID0gbGFzdF90YWJfZW50cnk7XG4gICAgICAgICAgICBtYXNrX2lkeFtiXSA9IGs7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtYXNrX2lkeFtiXSA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGIgPSAxOyBiIDwgZ2ZjLm5wYXJ0X3MgLSAxOyBiKyspIHtcbiAgICAgICAgICAgIGEgPSBhdmdbYiAtIDFdICsgYXZnW2JdICsgYXZnW2IgKyAxXTtcbiAgICAgICAgICAgIGlmIChhID4gMC4wKSB7XG4gICAgICAgICAgICAgICAgdmFyIG0gPSBtYXhbYiAtIDFdO1xuICAgICAgICAgICAgICAgIGlmIChtIDwgbWF4W2JdKVxuICAgICAgICAgICAgICAgICAgICBtID0gbWF4W2JdO1xuICAgICAgICAgICAgICAgIGlmIChtIDwgbWF4W2IgKyAxXSlcbiAgICAgICAgICAgICAgICAgICAgbSA9IG1heFtiICsgMV07XG4gICAgICAgICAgICAgICAgYSA9IDIwLjBcbiAgICAgICAgICAgICAgICAgICAgKiAobSAqIDMuMCAtIGEpXG4gICAgICAgICAgICAgICAgICAgIC8gKGEgKiAoZ2ZjLm51bWxpbmVzX3NbYiAtIDFdICsgZ2ZjLm51bWxpbmVzX3NbYl1cbiAgICAgICAgICAgICAgICAgICAgKyBnZmMubnVtbGluZXNfc1tiICsgMV0gLSAxKSk7XG4gICAgICAgICAgICAgICAgdmFyIGsgPSAwIHwgYTtcbiAgICAgICAgICAgICAgICBpZiAoayA+IGxhc3RfdGFiX2VudHJ5KVxuICAgICAgICAgICAgICAgICAgICBrID0gbGFzdF90YWJfZW50cnk7XG4gICAgICAgICAgICAgICAgbWFza19pZHhbYl0gPSBrO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtYXNrX2lkeFtiXSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBhID0gYXZnW2IgLSAxXSArIGF2Z1tiXTtcbiAgICAgICAgaWYgKGEgPiAwLjApIHtcbiAgICAgICAgICAgIHZhciBtID0gbWF4W2IgLSAxXTtcbiAgICAgICAgICAgIGlmIChtIDwgbWF4W2JdKVxuICAgICAgICAgICAgICAgIG0gPSBtYXhbYl07XG4gICAgICAgICAgICBhID0gMjAuMCAqIChtICogMi4wIC0gYSlcbiAgICAgICAgICAgICAgICAvIChhICogKGdmYy5udW1saW5lc19zW2IgLSAxXSArIGdmYy5udW1saW5lc19zW2JdIC0gMSkpO1xuICAgICAgICAgICAgdmFyIGsgPSAwIHwgYTtcbiAgICAgICAgICAgIGlmIChrID4gbGFzdF90YWJfZW50cnkpXG4gICAgICAgICAgICAgICAgayA9IGxhc3RfdGFiX2VudHJ5O1xuICAgICAgICAgICAgbWFza19pZHhbYl0gPSBrO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbWFza19pZHhbYl0gPSAwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdmJycHN5X2NvbXB1dGVfbWFza2luZ19zKGdmcCwgZmZ0ZW5lcmd5X3MsIGViLCB0aHIsIGNobiwgc2Jsb2NrKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBtYXggPSBuZXcgZmxvYXRbRW5jb2Rlci5DQkFORFNdLCBhdmcgPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMpO1xuICAgICAgICB2YXIgaSwgaiwgYjtcbiAgICAgICAgdmFyIG1hc2tfaWR4X3MgPSBuZXcgaW50W0VuY29kZXIuQ0JBTkRTXTtcblxuICAgICAgICBmb3IgKGIgPSBqID0gMDsgYiA8IGdmYy5ucGFydF9zOyArK2IpIHtcbiAgICAgICAgICAgIHZhciBlYmIgPSAwLCBtID0gMDtcbiAgICAgICAgICAgIHZhciBuID0gZ2ZjLm51bWxpbmVzX3NbYl07XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbjsgKytpLCArK2opIHtcbiAgICAgICAgICAgICAgICB2YXIgZWwgPSBmZnRlbmVyZ3lfc1tzYmxvY2tdW2pdO1xuICAgICAgICAgICAgICAgIGViYiArPSBlbDtcbiAgICAgICAgICAgICAgICBpZiAobSA8IGVsKVxuICAgICAgICAgICAgICAgICAgICBtID0gZWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlYltiXSA9IGViYjtcbiAgICAgICAgICAgIG1heFtiXSA9IG07XG4gICAgICAgICAgICBhdmdbYl0gPSBlYmIgLyBuO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoOyBiIDwgRW5jb2Rlci5DQkFORFM7ICsrYikge1xuICAgICAgICAgICAgbWF4W2JdID0gMDtcbiAgICAgICAgICAgIGF2Z1tiXSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgcHN5dmJyX2NhbGNfbWFza19pbmRleF9zKGdmYywgbWF4LCBhdmcsIG1hc2tfaWR4X3MpO1xuICAgICAgICBmb3IgKGogPSBiID0gMDsgYiA8IGdmYy5ucGFydF9zOyBiKyspIHtcbiAgICAgICAgICAgIHZhciBrayA9IGdmYy5zM2luZF9zW2JdWzBdO1xuICAgICAgICAgICAgdmFyIGxhc3QgPSBnZmMuczNpbmRfc1tiXVsxXTtcbiAgICAgICAgICAgIHZhciBkZCwgZGRfbjtcbiAgICAgICAgICAgIHZhciB4LCBlY2IsIGF2Z19tYXNrO1xuICAgICAgICAgICAgZGQgPSBtYXNrX2lkeF9zW2trXTtcbiAgICAgICAgICAgIGRkX24gPSAxO1xuICAgICAgICAgICAgZWNiID0gZ2ZjLnMzX3NzW2pdICogZWJba2tdICogdGFiW21hc2tfaWR4X3Nba2tdXTtcbiAgICAgICAgICAgICsrajtcbiAgICAgICAgICAgICsra2s7XG4gICAgICAgICAgICB3aGlsZSAoa2sgPD0gbGFzdCkge1xuICAgICAgICAgICAgICAgIGRkICs9IG1hc2tfaWR4X3Nba2tdO1xuICAgICAgICAgICAgICAgIGRkX24gKz0gMTtcbiAgICAgICAgICAgICAgICB4ID0gZ2ZjLnMzX3NzW2pdICogZWJba2tdICogdGFiW21hc2tfaWR4X3Nba2tdXTtcbiAgICAgICAgICAgICAgICBlY2IgPSB2YnJwc3lfbWFza19hZGQoZWNiLCB4LCBrayAtIGIpO1xuICAgICAgICAgICAgICAgICsrajtcbiAgICAgICAgICAgICAgICArK2trO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGQgPSAoMSArIDIgKiBkZCkgLyAoMiAqIGRkX24pO1xuICAgICAgICAgICAgYXZnX21hc2sgPSB0YWJbZGRdICogMC41O1xuICAgICAgICAgICAgZWNiICo9IGF2Z19tYXNrO1xuICAgICAgICAgICAgdGhyW2JdID0gZWNiO1xuICAgICAgICAgICAgZ2ZjLm5iX3MyW2Nobl1bYl0gPSBnZmMubmJfczFbY2huXVtiXTtcbiAgICAgICAgICAgIGdmYy5uYl9zMVtjaG5dW2JdID0gZWNiO1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogaWYgVEhSIGV4Y2VlZHMgRUIsIHRoZSBxdWFudGl6YXRpb24gcm91dGluZXMgd2lsbCB0YWtlIHRoZVxuICAgICAgICAgICAgICAgICAqIGRpZmZlcmVuY2UgZnJvbSBvdGhlciBiYW5kcy4gaW4gY2FzZSBvZiBzdHJvbmcgdG9uYWwgc2FtcGxlc1xuICAgICAgICAgICAgICAgICAqICh0b25hbHRlc3Qud2F2KSB0aGlzIGxlYWRzIHRvIGhlYXZ5IGRpc3RvcnRpb25zLiB0aGF0J3Mgd2h5XG4gICAgICAgICAgICAgICAgICogd2UgbGltaXQgVEhSIGhlcmUuXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgeCA9IG1heFtiXTtcbiAgICAgICAgICAgICAgICB4ICo9IGdmYy5taW52YWxfc1tiXTtcbiAgICAgICAgICAgICAgICB4ICo9IGF2Z19tYXNrO1xuICAgICAgICAgICAgICAgIGlmICh0aHJbYl0gPiB4KSB7XG4gICAgICAgICAgICAgICAgICAgIHRocltiXSA9IHg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGdmYy5tYXNraW5nX2xvd2VyID4gMSkge1xuICAgICAgICAgICAgICAgIHRocltiXSAqPSBnZmMubWFza2luZ19sb3dlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aHJbYl0gPiBlYltiXSkge1xuICAgICAgICAgICAgICAgIHRocltiXSA9IGViW2JdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGdmYy5tYXNraW5nX2xvd2VyIDwgMSkge1xuICAgICAgICAgICAgICAgIHRocltiXSAqPSBnZmMubWFza2luZ19sb3dlcjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICAgIGZvciAoOyBiIDwgRW5jb2Rlci5DQkFORFM7ICsrYikge1xuICAgICAgICAgICAgZWJbYl0gPSAwO1xuICAgICAgICAgICAgdGhyW2JdID0gMDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHZicnBzeV9jb21wdXRlX21hc2tpbmdfbChnZmMsIGZmdGVuZXJneSwgZWJfbCwgdGhyLCBjaG4pIHtcbiAgICAgICAgdmFyIG1heCA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyksIGF2ZyA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyk7XG4gICAgICAgIHZhciBtYXNrX2lkeF9sID0gbmV3X2ludChFbmNvZGVyLkNCQU5EUyArIDIpO1xuICAgICAgICB2YXIgYjtcblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIENhbGN1bGF0ZSB0aGUgZW5lcmd5IGFuZCB0aGUgdG9uYWxpdHkgb2YgZWFjaCBwYXJ0aXRpb24uXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIGNhbGNfZW5lcmd5KGdmYywgZmZ0ZW5lcmd5LCBlYl9sLCBtYXgsIGF2Zyk7XG4gICAgICAgIGNhbGNfbWFza19pbmRleF9sKGdmYywgbWF4LCBhdmcsIG1hc2tfaWR4X2wpO1xuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogY29udm9sdmUgdGhlIHBhcnRpdGlvbmVkIGVuZXJneSBhbmQgdW5wcmVkaWN0YWJpbGl0eSB3aXRoIHRoZVxuICAgICAgICAgKiBzcHJlYWRpbmcgZnVuY3Rpb24sIHMzX2xbYl1ba11cbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICB2YXIgayA9IDA7XG4gICAgICAgIGZvciAoYiA9IDA7IGIgPCBnZmMubnBhcnRfbDsgYisrKSB7XG4gICAgICAgICAgICB2YXIgeCwgZWNiLCBhdmdfbWFzaywgdDtcbiAgICAgICAgICAgIC8qIGNvbnZvbHZlIHRoZSBwYXJ0aXRpb25lZCBlbmVyZ3kgd2l0aCB0aGUgc3ByZWFkaW5nIGZ1bmN0aW9uICovXG4gICAgICAgICAgICB2YXIga2sgPSBnZmMuczNpbmRbYl1bMF07XG4gICAgICAgICAgICB2YXIgbGFzdCA9IGdmYy5zM2luZFtiXVsxXTtcbiAgICAgICAgICAgIHZhciBkZCA9IDAsIGRkX24gPSAwO1xuICAgICAgICAgICAgZGQgPSBtYXNrX2lkeF9sW2trXTtcbiAgICAgICAgICAgIGRkX24gKz0gMTtcbiAgICAgICAgICAgIGVjYiA9IGdmYy5zM19sbFtrXSAqIGViX2xba2tdICogdGFiW21hc2tfaWR4X2xba2tdXTtcbiAgICAgICAgICAgICsraztcbiAgICAgICAgICAgICsra2s7XG4gICAgICAgICAgICB3aGlsZSAoa2sgPD0gbGFzdCkge1xuICAgICAgICAgICAgICAgIGRkICs9IG1hc2tfaWR4X2xba2tdO1xuICAgICAgICAgICAgICAgIGRkX24gKz0gMTtcbiAgICAgICAgICAgICAgICB4ID0gZ2ZjLnMzX2xsW2tdICogZWJfbFtra10gKiB0YWJbbWFza19pZHhfbFtra11dO1xuICAgICAgICAgICAgICAgIHQgPSB2YnJwc3lfbWFza19hZGQoZWNiLCB4LCBrayAtIGIpO1xuICAgICAgICAgICAgICAgIGVjYiA9IHQ7XG4gICAgICAgICAgICAgICAgKytrO1xuICAgICAgICAgICAgICAgICsra2s7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkZCA9ICgxICsgMiAqIGRkKSAvICgyICogZGRfbik7XG4gICAgICAgICAgICBhdmdfbWFzayA9IHRhYltkZF0gKiAwLjU7XG4gICAgICAgICAgICBlY2IgKj0gYXZnX21hc2s7XG5cbiAgICAgICAgICAgIC8qKioqIGxvbmcgYmxvY2sgcHJlLWVjaG8gY29udHJvbCAqKioqL1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiA8UFJFPlxuICAgICAgICAgICAgICogZG9udCB1c2UgbG9uZyBibG9jayBwcmUtZWNobyBjb250cm9sIGlmIHByZXZpb3VzIGdyYW51bGUgd2FzXG4gICAgICAgICAgICAgKiBhIHNob3J0IGJsb2NrLiAgVGhpcyBpcyB0byBhdm9pZCB0aGUgc2l0dWF0aW9uOlxuICAgICAgICAgICAgICogZnJhbWUwOiAgcXVpZXQgKHZlcnkgbG93IG1hc2tpbmcpXG4gICAgICAgICAgICAgKiBmcmFtZTE6ICBzdXJnZSAgKHRyaWdnZXJzIHNob3J0IGJsb2NrcylcbiAgICAgICAgICAgICAqIGZyYW1lMjogIHJlZ3VsYXIgZnJhbWUuICBsb29rcyBsaWtlIHByZS1lY2hvIHdoZW4gY29tcGFyZWQgdG9cbiAgICAgICAgICAgICAqICAgICAgICAgIGZyYW1lMCwgYnV0IGFsbCBwcmUtZWNobyB3YXMgaW4gZnJhbWUxLlxuICAgICAgICAgICAgICogPC9QUkU+XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBjaG49MCwxIEwgYW5kIFIgY2hhbm5lbHMgY2huPTIsMyBTIGFuZCBNIGNoYW5uZWxzLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAoZ2ZjLmJsb2NrdHlwZV9vbGRbY2huICYgMHgwMV0gPT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVjYl9saW1pdCA9IHJwZWxldiAqIGdmYy5uYl8xW2Nobl1bYl07XG4gICAgICAgICAgICAgICAgaWYgKGVjYl9saW1pdCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyW2JdID0gTWF0aC5taW4oZWNiLCBlY2JfbGltaXQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAgICAgKiA8UFJFPlxuICAgICAgICAgICAgICAgICAgICAgKiBSb2JlcnQgMDcxMjA5OlxuICAgICAgICAgICAgICAgICAgICAgKiBCZWNhdXNlIHdlIGRvbid0IGNhbGN1bGF0ZSBsb25nIGJsb2NrIHBzeSB3aGVuIHdlIGtub3cgYSBncmFudWxlXG4gICAgICAgICAgICAgICAgICAgICAqIHNob3VsZCBiZSBvZiBzaG9ydCBibG9ja3MsIHdlIGRvbid0IGhhdmUgYW55IGNsdWUgaG93IHRoZSBncmFudWxlXG4gICAgICAgICAgICAgICAgICAgICAqIGJlZm9yZSB3b3VsZCBoYXZlIGxvb2tlZCBsaWtlIGFzIGEgbG9uZyBibG9jay4gU28gd2UgaGF2ZSB0byBndWVzc1xuICAgICAgICAgICAgICAgICAgICAgKiBhIGxpdHRsZSBiaXQgZm9yIHRoaXMgRU5EX1RZUEUgYmxvY2suXG4gICAgICAgICAgICAgICAgICAgICAqIE1vc3Qgb2YgdGhlIHRpbWUgd2UgZ2V0IGF3YXkgd2l0aCB0aGlzIHNsb3BweW5lc3MuIChmaW5nZXJzIGNyb3NzZWQgOilcbiAgICAgICAgICAgICAgICAgICAgICogVGhlIHNwZWVkIGluY3JlYXNlIGlzIHdvcnRoIGl0LlxuICAgICAgICAgICAgICAgICAgICAgKiA8L1BSRT5cbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIHRocltiXSA9IE1hdGgubWluKGVjYiwgZWJfbFtiXSAqIE5TX1BSRUVDSE9fQVRUMik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgZWNiX2xpbWl0XzIgPSBycGVsZXYyICogZ2ZjLm5iXzJbY2huXVtiXTtcbiAgICAgICAgICAgICAgICB2YXIgZWNiX2xpbWl0XzEgPSBycGVsZXYgKiBnZmMubmJfMVtjaG5dW2JdO1xuICAgICAgICAgICAgICAgIHZhciBlY2JfbGltaXQ7XG4gICAgICAgICAgICAgICAgaWYgKGVjYl9saW1pdF8yIDw9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgZWNiX2xpbWl0XzIgPSBlY2I7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChlY2JfbGltaXRfMSA8PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGVjYl9saW1pdF8xID0gZWNiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLmJsb2NrdHlwZV9vbGRbY2huICYgMHgwMV0gPT0gRW5jb2Rlci5OT1JNX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgZWNiX2xpbWl0ID0gTWF0aC5taW4oZWNiX2xpbWl0XzEsIGVjYl9saW1pdF8yKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlY2JfbGltaXQgPSBlY2JfbGltaXRfMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhyW2JdID0gTWF0aC5taW4oZWNiLCBlY2JfbGltaXQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLm5iXzJbY2huXVtiXSA9IGdmYy5uYl8xW2Nobl1bYl07XG4gICAgICAgICAgICBnZmMubmJfMVtjaG5dW2JdID0gZWNiO1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogaWYgVEhSIGV4Y2VlZHMgRUIsIHRoZSBxdWFudGl6YXRpb24gcm91dGluZXMgd2lsbCB0YWtlIHRoZVxuICAgICAgICAgICAgICAgICAqIGRpZmZlcmVuY2UgZnJvbSBvdGhlciBiYW5kcy4gaW4gY2FzZSBvZiBzdHJvbmcgdG9uYWwgc2FtcGxlc1xuICAgICAgICAgICAgICAgICAqICh0b25hbHRlc3Qud2F2KSB0aGlzIGxlYWRzIHRvIGhlYXZ5IGRpc3RvcnRpb25zLiB0aGF0J3Mgd2h5XG4gICAgICAgICAgICAgICAgICogd2UgbGltaXQgVEhSIGhlcmUuXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgeCA9IG1heFtiXTtcbiAgICAgICAgICAgICAgICB4ICo9IGdmYy5taW52YWxfbFtiXTtcbiAgICAgICAgICAgICAgICB4ICo9IGF2Z19tYXNrO1xuICAgICAgICAgICAgICAgIGlmICh0aHJbYl0gPiB4KSB7XG4gICAgICAgICAgICAgICAgICAgIHRocltiXSA9IHg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGdmYy5tYXNraW5nX2xvd2VyID4gMSkge1xuICAgICAgICAgICAgICAgIHRocltiXSAqPSBnZmMubWFza2luZ19sb3dlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aHJbYl0gPiBlYl9sW2JdKSB7XG4gICAgICAgICAgICAgICAgdGhyW2JdID0gZWJfbFtiXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChnZmMubWFza2luZ19sb3dlciA8IDEpIHtcbiAgICAgICAgICAgICAgICB0aHJbYl0gKj0gZ2ZjLm1hc2tpbmdfbG93ZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICg7IGIgPCBFbmNvZGVyLkNCQU5EUzsgKytiKSB7XG4gICAgICAgICAgICBlYl9sW2JdID0gMDtcbiAgICAgICAgICAgIHRocltiXSA9IDA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiB2YnJwc3lfY29tcHV0ZV9ibG9ja190eXBlKGdmcCwgdXNlbG9uZ2Jsb2NrKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cbiAgICAgICAgaWYgKGdmcC5zaG9ydF9ibG9ja3MgPT0gU2hvcnRCbG9jay5zaG9ydF9ibG9ja19jb3VwbGVkXG4gICAgICAgICAgICAgICAgLyogZm9yY2UgYm90aCBjaGFubmVscyB0byB1c2UgdGhlIHNhbWUgYmxvY2sgdHlwZSAqL1xuICAgICAgICAgICAgICAgIC8qIHRoaXMgaXMgbmVjZXNzYXJ5IGlmIHRoZSBmcmFtZSBpcyB0byBiZSBlbmNvZGVkIGluIG1zX3N0ZXJlby4gKi9cbiAgICAgICAgICAgICAgICAvKiBCdXQgZXZlbiB3aXRob3V0IG1zX3N0ZXJlbywgRmhHIGRvZXMgdGhpcyAqL1xuICAgICAgICAgICAgJiYgISh1c2Vsb25nYmxvY2tbMF0gIT0gMCAmJiB1c2Vsb25nYmxvY2tbMV0gIT0gMCkpXG4gICAgICAgICAgICB1c2Vsb25nYmxvY2tbMF0gPSB1c2Vsb25nYmxvY2tbMV0gPSAwO1xuXG4gICAgICAgIGZvciAodmFyIGNobiA9IDA7IGNobiA8IGdmYy5jaGFubmVsc19vdXQ7IGNobisrKSB7XG4gICAgICAgICAgICAvKiBkaXNhYmxlIHNob3J0IGJsb2NrcyAqL1xuICAgICAgICAgICAgaWYgKGdmcC5zaG9ydF9ibG9ja3MgPT0gU2hvcnRCbG9jay5zaG9ydF9ibG9ja19kaXNwZW5zZWQpIHtcbiAgICAgICAgICAgICAgICB1c2Vsb25nYmxvY2tbY2huXSA9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ2ZwLnNob3J0X2Jsb2NrcyA9PSBTaG9ydEJsb2NrLnNob3J0X2Jsb2NrX2ZvcmNlZCkge1xuICAgICAgICAgICAgICAgIHVzZWxvbmdibG9ja1tjaG5dID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHZicnBzeV9hcHBseV9ibG9ja190eXBlKGdmcCwgdXNlbG9uZ2Jsb2NrLCBibG9ja3R5cGVfZCkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHVwZGF0ZSB0aGUgYmxvY2t0eXBlIG9mIHRoZSBwcmV2aW91cyBncmFudWxlLCBzaW5jZSBpdCBkZXBlbmRzIG9uXG4gICAgICAgICAqIHdoYXQgaGFwcGVuZCBpbiB0aGlzIGdyYW51bGVcbiAgICAgICAgICovXG4gICAgICAgIGZvciAodmFyIGNobiA9IDA7IGNobiA8IGdmYy5jaGFubmVsc19vdXQ7IGNobisrKSB7XG4gICAgICAgICAgICB2YXIgYmxvY2t0eXBlID0gRW5jb2Rlci5OT1JNX1RZUEU7XG4gICAgICAgICAgICAvKiBkaXNhYmxlIHNob3J0IGJsb2NrcyAqL1xuXG4gICAgICAgICAgICBpZiAodXNlbG9uZ2Jsb2NrW2Nobl0gIT0gMCkge1xuICAgICAgICAgICAgICAgIC8qIG5vIGF0dGFjayA6IHVzZSBsb25nIGJsb2NrcyAqL1xuICAgICAgICAgICAgICAgIGlmIChnZmMuYmxvY2t0eXBlX29sZFtjaG5dID09IEVuY29kZXIuU0hPUlRfVFlQRSlcbiAgICAgICAgICAgICAgICAgICAgYmxvY2t0eXBlID0gRW5jb2Rlci5TVE9QX1RZUEU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8qIGF0dGFjayA6IHVzZSBzaG9ydCBibG9ja3MgKi9cbiAgICAgICAgICAgICAgICBibG9ja3R5cGUgPSBFbmNvZGVyLlNIT1JUX1RZUEU7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5ibG9ja3R5cGVfb2xkW2Nobl0gPT0gRW5jb2Rlci5OT1JNX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLmJsb2NrdHlwZV9vbGRbY2huXSA9IEVuY29kZXIuU1RBUlRfVFlQRTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5ibG9ja3R5cGVfb2xkW2Nobl0gPT0gRW5jb2Rlci5TVE9QX1RZUEUpXG4gICAgICAgICAgICAgICAgICAgIGdmYy5ibG9ja3R5cGVfb2xkW2Nobl0gPSBFbmNvZGVyLlNIT1JUX1RZUEU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJsb2NrdHlwZV9kW2Nobl0gPSBnZmMuYmxvY2t0eXBlX29sZFtjaG5dO1xuICAgICAgICAgICAgLy8gdmFsdWUgcmV0dXJuZWQgdG8gY2FsbGluZyBwcm9ncmFtXG4gICAgICAgICAgICBnZmMuYmxvY2t0eXBlX29sZFtjaG5dID0gYmxvY2t0eXBlO1xuICAgICAgICAgICAgLy8gc2F2ZSBmb3IgbmV4dCBjYWxsIHRvIGwzcHN5X2FuYWxcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNvbXB1dGUgTS9TIHRocmVzaG9sZHMgZnJvbSBKb2huc3RvbiAmIEZlcnJlaXJhIDE5OTIgSUNBU1NQIHBhcGVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gdmJycHN5X2NvbXB1dGVfTVNfdGhyZXNob2xkcyhlYiwgdGhyLCBjYl9tbGQsIGF0aF9jYiwgYXRoYWRqdXN0LCBtc2ZpeCwgbikge1xuICAgICAgICB2YXIgbXNmaXgyID0gbXNmaXggKiAyO1xuICAgICAgICB2YXIgYXRobG93ZXIgPSBtc2ZpeCA+IDAgPyBNYXRoLnBvdygxMCwgYXRoYWRqdXN0KSA6IDE7XG4gICAgICAgIHZhciByc2lkZSwgcm1pZDtcbiAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCBuOyArK2IpIHtcbiAgICAgICAgICAgIHZhciBlYk0gPSBlYlsyXVtiXTtcbiAgICAgICAgICAgIHZhciBlYlMgPSBlYlszXVtiXTtcbiAgICAgICAgICAgIHZhciB0aG1MID0gdGhyWzBdW2JdO1xuICAgICAgICAgICAgdmFyIHRobVIgPSB0aHJbMV1bYl07XG4gICAgICAgICAgICB2YXIgdGhtTSA9IHRoclsyXVtiXTtcbiAgICAgICAgICAgIHZhciB0aG1TID0gdGhyWzNdW2JdO1xuXG4gICAgICAgICAgICAvKiB1c2UgdGhpcyBmaXggaWYgTCAmIFIgbWFza2luZyBkaWZmZXJzIGJ5IDJkYiBvciBsZXNzICovXG4gICAgICAgICAgICBpZiAodGhtTCA8PSAxLjU4ICogdGhtUiAmJiB0aG1SIDw9IDEuNTggKiB0aG1MKSB7XG4gICAgICAgICAgICAgICAgdmFyIG1sZF9tID0gY2JfbWxkW2JdICogZWJTO1xuICAgICAgICAgICAgICAgIHZhciBtbGRfcyA9IGNiX21sZFtiXSAqIGViTTtcbiAgICAgICAgICAgICAgICBybWlkID0gTWF0aC5tYXgodGhtTSwgTWF0aC5taW4odGhtUywgbWxkX20pKTtcbiAgICAgICAgICAgICAgICByc2lkZSA9IE1hdGgubWF4KHRobVMsIE1hdGgubWluKHRobU0sIG1sZF9zKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJtaWQgPSB0aG1NO1xuICAgICAgICAgICAgICAgIHJzaWRlID0gdGhtUztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChtc2ZpeCA+IDApIHtcbiAgICAgICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICAgICAgICAgIC8qIEFkanVzdCBNL1MgbWFza2luZ3MgaWYgdXNlciBzZXQgXCJtc2ZpeFwiICovXG4gICAgICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgICAgICAgICAvKiBOYW9raSBTaGliYXRhIDIwMDAgKi9cbiAgICAgICAgICAgICAgICB2YXIgdGhtTFIsIHRobU1TO1xuICAgICAgICAgICAgICAgIHZhciBhdGggPSBhdGhfY2JbYl0gKiBhdGhsb3dlcjtcbiAgICAgICAgICAgICAgICB0aG1MUiA9IE1hdGgubWluKE1hdGgubWF4KHRobUwsIGF0aCksIE1hdGgubWF4KHRobVIsIGF0aCkpO1xuICAgICAgICAgICAgICAgIHRobU0gPSBNYXRoLm1heChybWlkLCBhdGgpO1xuICAgICAgICAgICAgICAgIHRobVMgPSBNYXRoLm1heChyc2lkZSwgYXRoKTtcbiAgICAgICAgICAgICAgICB0aG1NUyA9IHRobU0gKyB0aG1TO1xuICAgICAgICAgICAgICAgIGlmICh0aG1NUyA+IDAgJiYgKHRobUxSICogbXNmaXgyKSA8IHRobU1TKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmID0gdGhtTFIgKiBtc2ZpeDIgLyB0aG1NUztcbiAgICAgICAgICAgICAgICAgICAgdGhtTSAqPSBmO1xuICAgICAgICAgICAgICAgICAgICB0aG1TICo9IGY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJtaWQgPSBNYXRoLm1pbih0aG1NLCBybWlkKTtcbiAgICAgICAgICAgICAgICByc2lkZSA9IE1hdGgubWluKHRobVMsIHJzaWRlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChybWlkID4gZWJNKSB7XG4gICAgICAgICAgICAgICAgcm1pZCA9IGViTTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyc2lkZSA+IGViUykge1xuICAgICAgICAgICAgICAgIHJzaWRlID0gZWJTO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhyWzJdW2JdID0gcm1pZDtcbiAgICAgICAgICAgIHRoclszXVtiXSA9IHJzaWRlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5MM3BzeWNob19hbmFsX3ZiciA9IGZ1bmN0aW9uIChnZnAsIGJ1ZmZlciwgYnVmUG9zLCBncl9vdXQsIG1hc2tpbmdfcmF0aW8sIG1hc2tpbmdfTVNfcmF0aW8sIHBlcmNlcF9lbnRyb3B5LCBwZXJjZXBfTVNfZW50cm9weSwgZW5lcmd5LCBibG9ja3R5cGVfZCkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXG4gICAgICAgIC8qIGZmdCBhbmQgZW5lcmd5IGNhbGN1bGF0aW9uICovXG4gICAgICAgIHZhciB3c2FtcF9sO1xuICAgICAgICB2YXIgd3NhbXBfcztcbiAgICAgICAgdmFyIGZmdGVuZXJneSA9IG5ld19mbG9hdChFbmNvZGVyLkhCTEtTSVpFKTtcbiAgICAgICAgdmFyIGZmdGVuZXJneV9zID0gbmV3X2Zsb2F0X24oWzMsIEVuY29kZXIuSEJMS1NJWkVfc10pO1xuICAgICAgICB2YXIgd3NhbXBfTCA9IG5ld19mbG9hdF9uKFsyLCBFbmNvZGVyLkJMS1NJWkVdKTtcbiAgICAgICAgdmFyIHdzYW1wX1MgPSBuZXdfZmxvYXRfbihbMiwgMywgRW5jb2Rlci5CTEtTSVpFX3NdKTtcbiAgICAgICAgdmFyIGViID0gbmV3X2Zsb2F0X24oWzQsIEVuY29kZXIuQ0JBTkRTXSksIHRociA9IG5ld19mbG9hdF9uKFs0LCBFbmNvZGVyLkNCQU5EU10pO1xuICAgICAgICB2YXIgc3ViX3Nob3J0X2ZhY3RvciA9IG5ld19mbG9hdF9uKFs0LCAzXSk7XG4gICAgICAgIHZhciBwY2ZhY3QgPSAwLjY7XG5cbiAgICAgICAgLyogYmxvY2sgdHlwZSAqL1xuICAgICAgICB2YXIgbnNfYXR0YWNrcyA9IFtbMCwgMCwgMCwgMF0sIFswLCAwLCAwLCAwXSwgWzAsIDAsIDAsIDBdLFxuICAgICAgICAgICAgWzAsIDAsIDAsIDBdXTtcbiAgICAgICAgdmFyIHVzZWxvbmdibG9jayA9IG5ld19pbnQoMik7XG5cbiAgICAgICAgLyogdXN1YWwgdmFyaWFibGVzIGxpa2UgbG9vcCBpbmRpY2VzLCBldGMuLiAqL1xuXG4gICAgICAgIC8qIGNobj0yIGFuZCAzID0gTWlkIGFuZCBTaWRlIGNoYW5uZWxzICovXG4gICAgICAgIHZhciBuX2Nobl9wc3kgPSAoZ2ZwLm1vZGUgPT0gTVBFR01vZGUuSk9JTlRfU1RFUkVPKSA/IDRcbiAgICAgICAgICAgIDogZ2ZjLmNoYW5uZWxzX291dDtcblxuICAgICAgICB2YnJwc3lfYXR0YWNrX2RldGVjdGlvbihnZnAsIGJ1ZmZlciwgYnVmUG9zLCBncl9vdXQsIG1hc2tpbmdfcmF0aW8sXG4gICAgICAgICAgICBtYXNraW5nX01TX3JhdGlvLCBlbmVyZ3ksIHN1Yl9zaG9ydF9mYWN0b3IsIG5zX2F0dGFja3MsXG4gICAgICAgICAgICB1c2Vsb25nYmxvY2spO1xuXG4gICAgICAgIHZicnBzeV9jb21wdXRlX2Jsb2NrX3R5cGUoZ2ZwLCB1c2Vsb25nYmxvY2spO1xuXG4gICAgICAgIC8qIExPTkcgQkxPQ0sgQ0FTRSAqL1xuICAgICAgICB7XG4gICAgICAgICAgICBmb3IgKHZhciBjaG4gPSAwOyBjaG4gPCBuX2Nobl9wc3k7IGNobisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoMDEgPSBjaG4gJiAweDAxO1xuICAgICAgICAgICAgICAgIHdzYW1wX2wgPSB3c2FtcF9MO1xuICAgICAgICAgICAgICAgIHZicnBzeV9jb21wdXRlX2ZmdF9sKGdmcCwgYnVmZmVyLCBidWZQb3MsIGNobiwgZ3Jfb3V0LFxuICAgICAgICAgICAgICAgICAgICBmZnRlbmVyZ3ksIHdzYW1wX2wsIGNoMDEpO1xuXG4gICAgICAgICAgICAgICAgdmJycHN5X2NvbXB1dGVfbG91ZG5lc3NfYXBwcm94aW1hdGlvbl9sKGdmcCwgZ3Jfb3V0LCBjaG4sXG4gICAgICAgICAgICAgICAgICAgIGZmdGVuZXJneSk7XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlbG9uZ2Jsb2NrW2NoMDFdICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdmJycHN5X2NvbXB1dGVfbWFza2luZ19sKGdmYywgZmZ0ZW5lcmd5LCBlYltjaG5dLCB0aHJbY2huXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNobik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmJycHN5X3NraXBfbWFza2luZ19sKGdmYywgY2huKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKHVzZWxvbmdibG9ja1swXSArIHVzZWxvbmdibG9ja1sxXSkgPT0gMikge1xuICAgICAgICAgICAgICAgIC8qIE0vUyBjaGFubmVsICovXG4gICAgICAgICAgICAgICAgaWYgKGdmcC5tb2RlID09IE1QRUdNb2RlLkpPSU5UX1NURVJFTykge1xuICAgICAgICAgICAgICAgICAgICB2YnJwc3lfY29tcHV0ZV9NU190aHJlc2hvbGRzKGViLCB0aHIsIGdmYy5tbGRfY2JfbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdmYy5BVEguY2JfbCwgZ2ZwLkFUSGxvd2VyICogZ2ZjLkFUSC5hZGp1c3QsXG4gICAgICAgICAgICAgICAgICAgICAgICBnZnAubXNmaXgsIGdmYy5ucGFydF9sKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBUT0RPOiBhcHBseSBhZGFwdGl2ZSBBVEggbWFza2luZyBoZXJlID8/ICovXG4gICAgICAgICAgICBmb3IgKHZhciBjaG4gPSAwOyBjaG4gPCBuX2Nobl9wc3k7IGNobisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoMDEgPSBjaG4gJiAweDAxO1xuICAgICAgICAgICAgICAgIGlmICh1c2Vsb25nYmxvY2tbY2gwMV0gIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb252ZXJ0X3BhcnRpdGlvbjJzY2FsZWZhY19sKGdmYywgZWJbY2huXSwgdGhyW2Nobl0sIGNobik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogU0hPUlQgQkxPQ0tTIENBU0UgKi9cbiAgICAgICAge1xuICAgICAgICAgICAgZm9yICh2YXIgc2Jsb2NrID0gMDsgc2Jsb2NrIDwgMzsgc2Jsb2NrKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBjaG4gPSAwOyBjaG4gPCBuX2Nobl9wc3k7ICsrY2huKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaDAxID0gY2huICYgMHgwMTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodXNlbG9uZ2Jsb2NrW2NoMDFdICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZicnBzeV9za2lwX21hc2tpbmdfcyhnZmMsIGNobiwgc2Jsb2NrKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIGNvbXB1dGUgbWFza2luZyB0aHJlc2hvbGRzIGZvciBzaG9ydCBibG9ja3MgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIHdzYW1wX3MgPSB3c2FtcF9TO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmJycHN5X2NvbXB1dGVfZmZ0X3MoZ2ZwLCBidWZmZXIsIGJ1ZlBvcywgY2huLCBzYmxvY2ssXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmZ0ZW5lcmd5X3MsIHdzYW1wX3MsIGNoMDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmJycHN5X2NvbXB1dGVfbWFza2luZ19zKGdmcCwgZmZ0ZW5lcmd5X3MsIGViW2Nobl0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyW2Nobl0sIGNobiwgc2Jsb2NrKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoKHVzZWxvbmdibG9ja1swXSArIHVzZWxvbmdibG9ja1sxXSkgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvKiBNL1MgY2hhbm5lbCAqL1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2ZwLm1vZGUgPT0gTVBFR01vZGUuSk9JTlRfU1RFUkVPKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YnJwc3lfY29tcHV0ZV9NU190aHJlc2hvbGRzKGViLCB0aHIsIGdmYy5tbGRfY2JfcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZmMuQVRILmNiX3MsIGdmcC5BVEhsb3dlciAqIGdmYy5BVEguYWRqdXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdmcC5tc2ZpeCwgZ2ZjLm5wYXJ0X3MpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8qIEwvUiBjaGFubmVsICovXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8qIFRPRE86IGFwcGx5IGFkYXB0aXZlIEFUSCBtYXNraW5nIGhlcmUgPz8gKi9cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBjaG4gPSAwOyBjaG4gPCBuX2Nobl9wc3k7ICsrY2huKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaDAxID0gY2huICYgMHgwMTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKDAgPT0gdXNlbG9uZ2Jsb2NrW2NoMDFdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb252ZXJ0X3BhcnRpdGlvbjJzY2FsZWZhY19zKGdmYywgZWJbY2huXSwgdGhyW2Nobl0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2huLCBzYmxvY2spO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKioqKiBzaG9ydCBibG9jayBwcmUtZWNobyBjb250cm9sICoqKiovXG4gICAgICAgICAgICBmb3IgKHZhciBjaG4gPSAwOyBjaG4gPCBuX2Nobl9wc3k7IGNobisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNoMDEgPSBjaG4gJiAweDAxO1xuXG4gICAgICAgICAgICAgICAgaWYgKHVzZWxvbmdibG9ja1tjaDAxXSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBzYiA9IDA7IHNiIDwgRW5jb2Rlci5TQk1BWF9zOyBzYisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdfdGhtbSA9IG5ld19mbG9hdCgzKTtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgc2Jsb2NrID0gMDsgc2Jsb2NrIDwgMzsgc2Jsb2NrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aG1tID0gZ2ZjLnRobVtjaG5dLnNbc2JdW3NibG9ja107XG4gICAgICAgICAgICAgICAgICAgICAgICB0aG1tICo9IE5TX1BSRUVDSE9fQVRUMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5zX2F0dGFja3NbY2huXVtzYmxvY2tdID49IDJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBuc19hdHRhY2tzW2Nobl1bc2Jsb2NrICsgMV0gPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSAoc2Jsb2NrICE9IDApID8gc2Jsb2NrIC0gMSA6IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBOU19JTlRFUlAoZ2ZjLnRobVtjaG5dLnNbc2JdW2lkeF0sIHRobW0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5TX1BSRUVDSE9fQVRUMSAqIHBjZmFjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhtbSA9IE1hdGgubWluKHRobW0sIHApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChuc19hdHRhY2tzW2Nobl1bc2Jsb2NrXSA9PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IChzYmxvY2sgIT0gMCkgPyBzYmxvY2sgLSAxIDogMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IE5TX0lOVEVSUChnZmMudGhtW2Nobl0uc1tzYl1baWR4XSwgdGhtbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlNfUFJFRUNIT19BVFQyICogcGNmYWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aG1tID0gTWF0aC5taW4odGhtbSwgcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKChzYmxvY2sgIT0gMCAmJiBuc19hdHRhY2tzW2Nobl1bc2Jsb2NrIC0gMV0gPT0gMylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCAoc2Jsb2NrID09IDAgJiYgZ2ZjLm5zUHN5Lmxhc3RBdHRhY2tzW2Nobl0gPT0gMykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gKHNibG9jayAhPSAyKSA/IHNibG9jayArIDEgOiAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwID0gTlNfSU5URVJQKGdmYy50aG1bY2huXS5zW3NiXVtpZHhdLCB0aG1tLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOU19QUkVFQ0hPX0FUVDIgKiBwY2ZhY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRobW0gPSBNYXRoLm1pbih0aG1tLCBwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLyogcHVsc2UgbGlrZSBzaWduYWwgZGV0ZWN0aW9uIGZvciBmYXRib3kud2F2IGFuZCBzbyBvbiAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhtbSAqPSBzdWJfc2hvcnRfZmFjdG9yW2Nobl1bc2Jsb2NrXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3X3RobW1bc2Jsb2NrXSA9IHRobW07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgc2Jsb2NrID0gMDsgc2Jsb2NrIDwgMzsgc2Jsb2NrKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGdmYy50aG1bY2huXS5zW3NiXVtzYmxvY2tdID0gbmV3X3RobW1bc2Jsb2NrXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBjaG4gPSAwOyBjaG4gPCBuX2Nobl9wc3k7IGNobisrKSB7XG4gICAgICAgICAgICBnZmMubnNQc3kubGFzdEF0dGFja3NbY2huXSA9IG5zX2F0dGFja3NbY2huXVsyXTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogZGV0ZXJtaW5lIGZpbmFsIGJsb2NrIHR5cGVcbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgdmJycHN5X2FwcGx5X2Jsb2NrX3R5cGUoZ2ZwLCB1c2Vsb25nYmxvY2ssIGJsb2NrdHlwZV9kKTtcblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIGNvbXB1dGUgdGhlIHZhbHVlIG9mIFBFIHRvIHJldHVybiAuLi4gbm8gZGVsYXkgYW5kIGFkdmFuY2VcbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgZm9yICh2YXIgY2huID0gMDsgY2huIDwgbl9jaG5fcHN5OyBjaG4rKykge1xuICAgICAgICAgICAgdmFyIHBwZTtcbiAgICAgICAgICAgIHZhciBwcGVQb3M7XG4gICAgICAgICAgICB2YXIgdHlwZTtcbiAgICAgICAgICAgIHZhciBtcjtcblxuICAgICAgICAgICAgaWYgKGNobiA+IDEpIHtcbiAgICAgICAgICAgICAgICBwcGUgPSBwZXJjZXBfTVNfZW50cm9weTtcbiAgICAgICAgICAgICAgICBwcGVQb3MgPSAtMjtcbiAgICAgICAgICAgICAgICB0eXBlID0gRW5jb2Rlci5OT1JNX1RZUEU7XG4gICAgICAgICAgICAgICAgaWYgKGJsb2NrdHlwZV9kWzBdID09IEVuY29kZXIuU0hPUlRfVFlQRVxuICAgICAgICAgICAgICAgICAgICB8fCBibG9ja3R5cGVfZFsxXSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSBFbmNvZGVyLlNIT1JUX1RZUEU7XG4gICAgICAgICAgICAgICAgbXIgPSBtYXNraW5nX01TX3JhdGlvW2dyX291dF1bY2huIC0gMl07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBwZSA9IHBlcmNlcF9lbnRyb3B5O1xuICAgICAgICAgICAgICAgIHBwZVBvcyA9IDA7XG4gICAgICAgICAgICAgICAgdHlwZSA9IGJsb2NrdHlwZV9kW2Nobl07XG4gICAgICAgICAgICAgICAgbXIgPSBtYXNraW5nX3JhdGlvW2dyX291dF1bY2huXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHR5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgcHBlW3BwZVBvcyArIGNobl0gPSBwZWNhbGNfcyhtciwgZ2ZjLm1hc2tpbmdfbG93ZXIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcGVbcHBlUG9zICsgY2huXSA9IHBlY2FsY19sKG1yLCBnZmMubWFza2luZ19sb3dlcik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChnZnAuYW5hbHlzaXMpIHtcbiAgICAgICAgICAgICAgICBnZmMucGluZm8ucGVbZ3Jfb3V0XVtjaG5dID0gcHBlW3BwZVBvcyArIGNobl07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gczNfZnVuY194KGJhcmssIGhmX3Nsb3BlKSB7XG4gICAgICAgIHZhciB0ZW1weCA9IGJhcmssIHRlbXB5O1xuXG4gICAgICAgIGlmICh0ZW1weCA+PSAwKSB7XG4gICAgICAgICAgICB0ZW1weSA9IC10ZW1weCAqIDI3O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGVtcHkgPSB0ZW1weCAqIGhmX3Nsb3BlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0ZW1weSA8PSAtNzIuMCkge1xuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIE1hdGguZXhwKHRlbXB5ICogTE5fVE9fTE9HMTApO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG5vcm1fczNfZnVuY194KGhmX3Nsb3BlKSB7XG4gICAgICAgIHZhciBsaW1fYSA9IDAsIGxpbV9iID0gMDtcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIHggPSAwLCBsLCBoO1xuICAgICAgICAgICAgZm9yICh4ID0gMDsgczNfZnVuY194KHgsIGhmX3Nsb3BlKSA+IDFlLTIwOyB4IC09IDEpXG4gICAgICAgICAgICAgICAgO1xuICAgICAgICAgICAgbCA9IHg7XG4gICAgICAgICAgICBoID0gMDtcbiAgICAgICAgICAgIHdoaWxlIChNYXRoLmFicyhoIC0gbCkgPiAxZS0xMikge1xuICAgICAgICAgICAgICAgIHggPSAoaCArIGwpIC8gMjtcbiAgICAgICAgICAgICAgICBpZiAoczNfZnVuY194KHgsIGhmX3Nsb3BlKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaCA9IHg7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbCA9IHg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGltX2EgPSBsO1xuICAgICAgICB9XG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciB4ID0gMCwgbCwgaDtcbiAgICAgICAgICAgIGZvciAoeCA9IDA7IHMzX2Z1bmNfeCh4LCBoZl9zbG9wZSkgPiAxZS0yMDsgeCArPSAxKVxuICAgICAgICAgICAgICAgIDtcbiAgICAgICAgICAgIGwgPSAwO1xuICAgICAgICAgICAgaCA9IHg7XG4gICAgICAgICAgICB3aGlsZSAoTWF0aC5hYnMoaCAtIGwpID4gMWUtMTIpIHtcbiAgICAgICAgICAgICAgICB4ID0gKGggKyBsKSAvIDI7XG4gICAgICAgICAgICAgICAgaWYgKHMzX2Z1bmNfeCh4LCBoZl9zbG9wZSkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGwgPSB4O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGggPSB4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxpbV9iID0gaDtcbiAgICAgICAgfVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgc3VtID0gMDtcbiAgICAgICAgICAgIHZhciBtID0gMTAwMDtcbiAgICAgICAgICAgIHZhciBpO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8PSBtOyArK2kpIHtcbiAgICAgICAgICAgICAgICB2YXIgeCA9IGxpbV9hICsgaSAqIChsaW1fYiAtIGxpbV9hKSAvIG07XG4gICAgICAgICAgICAgICAgdmFyIHkgPSBzM19mdW5jX3goeCwgaGZfc2xvcGUpO1xuICAgICAgICAgICAgICAgIHN1bSArPSB5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhciBub3JtID0gKG0gKyAxKSAvIChzdW0gKiAobGltX2IgLSBsaW1fYSkpO1xuICAgICAgICAgICAgICAgIC8qIHByaW50ZiggXCJub3JtID0gJWxmXFxuXCIsbm9ybSk7ICovXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5vcm07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiAgIFRoZSBzcHJlYWRpbmcgZnVuY3Rpb24uICBWYWx1ZXMgcmV0dXJuZWQgaW4gdW5pdHMgb2YgZW5lcmd5XG4gICAgICovXG4gICAgZnVuY3Rpb24gczNfZnVuYyhiYXJrKSB7XG4gICAgICAgIHZhciB0ZW1weCwgeCwgdGVtcHksIHRlbXA7XG4gICAgICAgIHRlbXB4ID0gYmFyaztcbiAgICAgICAgaWYgKHRlbXB4ID49IDApXG4gICAgICAgICAgICB0ZW1weCAqPSAzO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICB0ZW1weCAqPSAxLjU7XG5cbiAgICAgICAgaWYgKHRlbXB4ID49IDAuNSAmJiB0ZW1weCA8PSAyLjUpIHtcbiAgICAgICAgICAgIHRlbXAgPSB0ZW1weCAtIDAuNTtcbiAgICAgICAgICAgIHggPSA4LjAgKiAodGVtcCAqIHRlbXAgLSAyLjAgKiB0ZW1wKTtcbiAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICB4ID0gMC4wO1xuICAgICAgICB0ZW1weCArPSAwLjQ3NDtcbiAgICAgICAgdGVtcHkgPSAxNS44MTEzODkgKyA3LjUgKiB0ZW1weCAtIDE3LjVcbiAgICAgICAgICAgICogTWF0aC5zcXJ0KDEuMCArIHRlbXB4ICogdGVtcHgpO1xuXG4gICAgICAgIGlmICh0ZW1weSA8PSAtNjAuMClcbiAgICAgICAgICAgIHJldHVybiAwLjA7XG5cbiAgICAgICAgdGVtcHggPSBNYXRoLmV4cCgoeCArIHRlbXB5KSAqIExOX1RPX0xPRzEwKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogPFBSRT5cbiAgICAgICAgICogTm9ybWFsaXphdGlvbi4gIFRoZSBzcHJlYWRpbmcgZnVuY3Rpb24gc2hvdWxkIGJlIG5vcm1hbGl6ZWQgc28gdGhhdDpcbiAgICAgICAgICogK2luZlxuICAgICAgICAgKiAvXG4gICAgICAgICAqIHwgIHMzIFsgYmFyayBdICBkKGJhcmspICAgPSAgMVxuICAgICAgICAgKiAvXG4gICAgICAgICAqIC1pbmZcbiAgICAgICAgICogPC9QUkU+XG4gICAgICAgICAqL1xuICAgICAgICB0ZW1weCAvPSAuNjYwOTE5MztcbiAgICAgICAgcmV0dXJuIHRlbXB4O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHNlZSBmb3IgZXhhbXBsZSBcIlp3aWNrZXI6IFBzeWNob2FrdXN0aWssIDE5ODI7IElTQk4gMy01NDAtMTE0MDEtN1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGZyZXEyYmFyayhmcmVxKSB7XG4gICAgICAgIC8qIGlucHV0OiBmcmVxIGluIGh6IG91dHB1dDogYmFya3MgKi9cbiAgICAgICAgaWYgKGZyZXEgPCAwKVxuICAgICAgICAgICAgZnJlcSA9IDA7XG4gICAgICAgIGZyZXEgPSBmcmVxICogMC4wMDE7XG4gICAgICAgIHJldHVybiAxMy4wICogTWF0aC5hdGFuKC43NiAqIGZyZXEpICsgMy41XG4gICAgICAgICAgICAqIE1hdGguYXRhbihmcmVxICogZnJlcSAvICg3LjUgKiA3LjUpKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbml0X251bWxpbmUobnVtbGluZXMsIGJvLCBibSwgYnZhbCwgYnZhbF93aWR0aCwgbWxkLCBib193LCBzZnJlcSwgYmxrc2l6ZSwgc2NhbGVwb3MsIGRlbHRhZnJlcSwgc2JtYXgpIHtcbiAgICAgICAgdmFyIGJfZnJxID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTICsgMSk7XG4gICAgICAgIHZhciBzYW1wbGVfZnJlcV9mcmFjID0gc2ZyZXEgLyAoc2JtYXggPiAxNSA/IDIgKiA1NzYgOiAyICogMTkyKTtcbiAgICAgICAgdmFyIHBhcnRpdGlvbiA9IG5ld19pbnQoRW5jb2Rlci5IQkxLU0laRSk7XG4gICAgICAgIHZhciBpO1xuICAgICAgICBzZnJlcSAvPSBibGtzaXplO1xuICAgICAgICB2YXIgaiA9IDA7XG4gICAgICAgIHZhciBuaSA9IDA7XG4gICAgICAgIC8qIGNvbXB1dGUgbnVtbGluZXMsIHRoZSBudW1iZXIgb2Ygc3BlY3RyYWwgbGluZXMgaW4gZWFjaCBwYXJ0aXRpb24gYmFuZCAqL1xuICAgICAgICAvKiBlYWNoIHBhcnRpdGlvbiBiYW5kIHNob3VsZCBiZSBhYm91dCBERUxCQVJLIHdpZGUuICovXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBFbmNvZGVyLkNCQU5EUzsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgYmFyazE7XG4gICAgICAgICAgICB2YXIgajI7XG4gICAgICAgICAgICBiYXJrMSA9IGZyZXEyYmFyayhzZnJlcSAqIGopO1xuXG4gICAgICAgICAgICBiX2ZycVtpXSA9IHNmcmVxICogajtcblxuICAgICAgICAgICAgZm9yIChqMiA9IGo7IGZyZXEyYmFyayhzZnJlcSAqIGoyKSAtIGJhcmsxIDwgREVMQkFSS1xuICAgICAgICAgICAgJiYgajIgPD0gYmxrc2l6ZSAvIDI7IGoyKyspXG4gICAgICAgICAgICAgICAgO1xuXG4gICAgICAgICAgICBudW1saW5lc1tpXSA9IGoyIC0gajtcbiAgICAgICAgICAgIG5pID0gaSArIDE7XG5cbiAgICAgICAgICAgIHdoaWxlIChqIDwgajIpIHtcbiAgICAgICAgICAgICAgICBwYXJ0aXRpb25baisrXSA9IGk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaiA+IGJsa3NpemUgLyAyKSB7XG4gICAgICAgICAgICAgICAgaiA9IGJsa3NpemUgLyAyO1xuICAgICAgICAgICAgICAgICsraTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBiX2ZycVtpXSA9IHNmcmVxICogajtcblxuICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBzYm1heDsgc2ZiKyspIHtcbiAgICAgICAgICAgIHZhciBpMSwgaTIsIHN0YXJ0LCBlbmQ7XG4gICAgICAgICAgICB2YXIgYXJnO1xuICAgICAgICAgICAgc3RhcnQgPSBzY2FsZXBvc1tzZmJdO1xuICAgICAgICAgICAgZW5kID0gc2NhbGVwb3Nbc2ZiICsgMV07XG5cbiAgICAgICAgICAgIGkxID0gMCB8IE1hdGguZmxvb3IoLjUgKyBkZWx0YWZyZXEgKiAoc3RhcnQgLSAuNSkpO1xuICAgICAgICAgICAgaWYgKGkxIDwgMClcbiAgICAgICAgICAgICAgICBpMSA9IDA7XG4gICAgICAgICAgICBpMiA9IDAgfCBNYXRoLmZsb29yKC41ICsgZGVsdGFmcmVxICogKGVuZCAtIC41KSk7XG5cbiAgICAgICAgICAgIGlmIChpMiA+IGJsa3NpemUgLyAyKVxuICAgICAgICAgICAgICAgIGkyID0gYmxrc2l6ZSAvIDI7XG5cbiAgICAgICAgICAgIGJtW3NmYl0gPSAocGFydGl0aW9uW2kxXSArIHBhcnRpdGlvbltpMl0pIC8gMjtcbiAgICAgICAgICAgIGJvW3NmYl0gPSBwYXJ0aXRpb25baTJdO1xuICAgICAgICAgICAgdmFyIGZfdG1wID0gc2FtcGxlX2ZyZXFfZnJhYyAqIGVuZDtcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBjYWxjdWxhdGUgaG93IG11Y2ggb2YgdGhpcyBiYW5kIGJlbG9uZ3MgdG8gY3VycmVudCBzY2FsZWZhY3RvclxuICAgICAgICAgICAgICogYmFuZFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBib193W3NmYl0gPSAoZl90bXAgLSBiX2ZycVtib1tzZmJdXSlcbiAgICAgICAgICAgICAgICAvIChiX2ZycVtib1tzZmJdICsgMV0gLSBiX2ZycVtib1tzZmJdXSk7XG4gICAgICAgICAgICBpZiAoYm9fd1tzZmJdIDwgMCkge1xuICAgICAgICAgICAgICAgIGJvX3dbc2ZiXSA9IDA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChib193W3NmYl0gPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgIGJvX3dbc2ZiXSA9IDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogc2V0dXAgc3RlcmVvIGRlbWFza2luZyB0aHJlc2hvbGRzICovXG4gICAgICAgICAgICAvKiBmb3JtdWxhIHJldmVyc2UgZW5naW5lcnJlZCBmcm9tIHBsb3QgaW4gcGFwZXIgKi9cbiAgICAgICAgICAgIGFyZyA9IGZyZXEyYmFyayhzZnJlcSAqIHNjYWxlcG9zW3NmYl0gKiBkZWx0YWZyZXEpO1xuICAgICAgICAgICAgYXJnID0gKCBNYXRoLm1pbihhcmcsIDE1LjUpIC8gMTUuNSk7XG5cbiAgICAgICAgICAgIG1sZFtzZmJdID0gTWF0aC5wb3coMTAuMCxcbiAgICAgICAgICAgICAgICAxLjI1ICogKDEgLSBNYXRoLmNvcyhNYXRoLlBJICogYXJnKSkgLSAyLjUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogY29tcHV0ZSBiYXJrIHZhbHVlcyBvZiBlYWNoIGNyaXRpY2FsIGJhbmQgKi9cbiAgICAgICAgaiA9IDA7XG4gICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgbmk7IGsrKykge1xuICAgICAgICAgICAgdmFyIHcgPSBudW1saW5lc1trXTtcbiAgICAgICAgICAgIHZhciBiYXJrMSwgYmFyazI7XG5cbiAgICAgICAgICAgIGJhcmsxID0gZnJlcTJiYXJrKHNmcmVxICogKGopKTtcbiAgICAgICAgICAgIGJhcmsyID0gZnJlcTJiYXJrKHNmcmVxICogKGogKyB3IC0gMSkpO1xuICAgICAgICAgICAgYnZhbFtrXSA9IC41ICogKGJhcmsxICsgYmFyazIpO1xuXG4gICAgICAgICAgICBiYXJrMSA9IGZyZXEyYmFyayhzZnJlcSAqIChqIC0gLjUpKTtcbiAgICAgICAgICAgIGJhcmsyID0gZnJlcTJiYXJrKHNmcmVxICogKGogKyB3IC0gLjUpKTtcbiAgICAgICAgICAgIGJ2YWxfd2lkdGhba10gPSBiYXJrMiAtIGJhcmsxO1xuICAgICAgICAgICAgaiArPSB3O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGluaXRfczNfdmFsdWVzKHMzaW5kLCBucGFydCwgYnZhbCwgYnZhbF93aWR0aCwgbm9ybSwgdXNlX29sZF9zMykge1xuICAgICAgICB2YXIgczMgPSBuZXdfZmxvYXRfbihbRW5jb2Rlci5DQkFORFMsIEVuY29kZXIuQ0JBTkRTXSk7XG4gICAgICAgIC8qXG4gICAgICAgICAqIFRoZSBzMyBhcnJheSBpcyBub3QgbGluZWFyIGluIHRoZSBiYXJrIHNjYWxlLlxuICAgICAgICAgKlxuICAgICAgICAgKiBidmFsW3hdIHNob3VsZCBiZSB1c2VkIHRvIGdldCB0aGUgYmFyayB2YWx1ZS5cbiAgICAgICAgICovXG4gICAgICAgIHZhciBqO1xuICAgICAgICB2YXIgbnVtYmVyT2ZOb25lWmVybyA9IDA7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIDxQUkU+XG4gICAgICAgICAqIHNbaV1bal0sIHRoZSB2YWx1ZSBvZiB0aGUgc3ByZWFkaW5nIGZ1bmN0aW9uLFxuICAgICAgICAgKiBjZW50ZXJlZCBhdCBiYW5kIGogKG1hc2tlciksIGZvciBiYW5kIGkgKG1hc2tlZSlcbiAgICAgICAgICpcbiAgICAgICAgICogaS5lLjogc3VtIG92ZXIgaiB0byBzcHJlYWQgaW50byBzaWduYWwgYmFya3ZhbD1pXG4gICAgICAgICAqIE5PVEU6IGkgYW5kIGogYXJlIHVzZWQgb3Bwb3NpdGUgYXMgaW4gdGhlIElTTyBkb2NzXG4gICAgICAgICAqIDwvUFJFPlxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKHVzZV9vbGRfczMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnBhcnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBucGFydDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB2ID0gczNfZnVuYyhidmFsW2ldIC0gYnZhbFtqXSkgKiBidmFsX3dpZHRoW2pdO1xuICAgICAgICAgICAgICAgICAgICBzM1tpXVtqXSA9IHYgKiBub3JtW2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBucGFydDsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGhmX3Nsb3BlID0gMTUgKyBNYXRoLm1pbigyMSAvIGJ2YWxbal0sIDEyKTtcbiAgICAgICAgICAgICAgICB2YXIgczNfeF9ub3JtID0gbm9ybV9zM19mdW5jX3goaGZfc2xvcGUpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnBhcnQ7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdiA9IHMzX3hfbm9ybVxuICAgICAgICAgICAgICAgICAgICAgICAgKiBzM19mdW5jX3goYnZhbFtpXSAtIGJ2YWxbal0sIGhmX3Nsb3BlKVxuICAgICAgICAgICAgICAgICAgICAgICAgKiBidmFsX3dpZHRoW2pdO1xuICAgICAgICAgICAgICAgICAgICBzM1tpXVtqXSA9IHYgKiBub3JtW2ldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5wYXJ0OyBpKyspIHtcbiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBucGFydDsgaisrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHMzW2ldW2pdID4gMC4wKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHMzaW5kW2ldWzBdID0gajtcblxuICAgICAgICAgICAgZm9yIChqID0gbnBhcnQgLSAxOyBqID4gMDsgai0tKSB7XG4gICAgICAgICAgICAgICAgaWYgKHMzW2ldW2pdID4gMC4wKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHMzaW5kW2ldWzFdID0gajtcbiAgICAgICAgICAgIG51bWJlck9mTm9uZVplcm8gKz0gKHMzaW5kW2ldWzFdIC0gczNpbmRbaV1bMF0gKyAxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBwID0gbmV3X2Zsb2F0KG51bWJlck9mTm9uZVplcm8pO1xuICAgICAgICB2YXIgayA9IDA7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnBhcnQ7IGkrKylcbiAgICAgICAgICAgIGZvciAoaiA9IHMzaW5kW2ldWzBdOyBqIDw9IHMzaW5kW2ldWzFdOyBqKyspXG4gICAgICAgICAgICAgICAgcFtrKytdID0gczNbaV1bal07XG5cbiAgICAgICAgcmV0dXJuIHA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RlcmVvX2RlbWFzayhmKSB7XG4gICAgICAgIC8qIHNldHVwIHN0ZXJlbyBkZW1hc2tpbmcgdGhyZXNob2xkcyAqL1xuICAgICAgICAvKiBmb3JtdWxhIHJldmVyc2UgZW5naW5lcnJlZCBmcm9tIHBsb3QgaW4gcGFwZXIgKi9cbiAgICAgICAgdmFyIGFyZyA9IGZyZXEyYmFyayhmKTtcbiAgICAgICAgYXJnID0gKE1hdGgubWluKGFyZywgMTUuNSkgLyAxNS41KTtcblxuICAgICAgICByZXR1cm4gTWF0aC5wb3coMTAuMCxcbiAgICAgICAgICAgIDEuMjUgKiAoMSAtIE1hdGguY29zKE1hdGguUEkgKiBhcmcpKSAtIDIuNSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTk9URTogdGhlIGJpdHJhdGUgcmVkdWN0aW9uIGZyb20gdGhlIGludGVyLWNoYW5uZWwgbWFza2luZyBlZmZlY3QgaXMgbG93XG4gICAgICogY29tcGFyZWQgdG8gdGhlIGNoYW5jZSBvZiBnZXR0aW5nIGFubnlvaW5nIGFydGVmYWN0cy4gTDNwc3ljaG9fYW5hbF92YnJcbiAgICAgKiBkb2VzIG5vdCB1c2UgdGhpcyBmZWF0dXJlLiAoUm9iZXJ0IDA3MTIxNilcbiAgICAgKi9cbiAgICB0aGlzLnBzeW1vZGVsX2luaXQgPSBmdW5jdGlvbiAoZ2ZwKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBpO1xuICAgICAgICB2YXIgdXNlT2xkUzMgPSB0cnVlO1xuICAgICAgICB2YXIgYnZsX2EgPSAxMywgYnZsX2IgPSAyNDtcbiAgICAgICAgdmFyIHNucl9sX2EgPSAwLCBzbnJfbF9iID0gMDtcbiAgICAgICAgdmFyIHNucl9zX2EgPSAtOC4yNSwgc25yX3NfYiA9IC00LjU7XG4gICAgICAgIHZhciBidmFsID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTKTtcbiAgICAgICAgdmFyIGJ2YWxfd2lkdGggPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMpO1xuICAgICAgICB2YXIgbm9ybSA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyk7XG4gICAgICAgIHZhciBzZnJlcSA9IGdmcC5vdXRfc2FtcGxlcmF0ZTtcblxuICAgICAgICBzd2l0Y2ggKGdmcC5leHBlcmltZW50YWxaKSB7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIHVzZU9sZFMzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICB1c2VPbGRTMyA9IChnZnAuVkJSID09IFZick1vZGUudmJyX210cmggfHwgZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9tdCkgPyBmYWxzZVxuICAgICAgICAgICAgICAgICAgICA6IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgdXNlT2xkUzMgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICBidmxfYSA9IDg7XG4gICAgICAgICAgICAgICAgc25yX2xfYSA9IC0xLjc1O1xuICAgICAgICAgICAgICAgIHNucl9sX2IgPSAtMC4wMTI1O1xuICAgICAgICAgICAgICAgIHNucl9zX2EgPSAtOC4yNTtcbiAgICAgICAgICAgICAgICBzbnJfc19iID0gLTIuMjU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgZ2ZjLm1zX2VuZXJfcmF0aW9fb2xkID0gLjI1O1xuICAgICAgICBnZmMuYmxvY2t0eXBlX29sZFswXSA9IGdmYy5ibG9ja3R5cGVfb2xkWzFdID0gRW5jb2Rlci5OT1JNX1RZUEU7XG4gICAgICAgIC8vIHRoZSB2YnIgaGVhZGVyIGlzIGxvbmcgYmxvY2tzXG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IDQ7ICsraSkge1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBFbmNvZGVyLkNCQU5EUzsgKytqKSB7XG4gICAgICAgICAgICAgICAgZ2ZjLm5iXzFbaV1bal0gPSAxZTIwO1xuICAgICAgICAgICAgICAgIGdmYy5uYl8yW2ldW2pdID0gMWUyMDtcbiAgICAgICAgICAgICAgICBnZmMubmJfczFbaV1bal0gPSBnZmMubmJfczJbaV1bal0gPSAxLjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBzYiA9IDA7IHNiIDwgRW5jb2Rlci5TQk1BWF9sOyBzYisrKSB7XG4gICAgICAgICAgICAgICAgZ2ZjLmVuW2ldLmxbc2JdID0gMWUyMDtcbiAgICAgICAgICAgICAgICBnZmMudGhtW2ldLmxbc2JdID0gMWUyMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMzsgKytqKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgc2IgPSAwOyBzYiA8IEVuY29kZXIuU0JNQVhfczsgc2IrKykge1xuICAgICAgICAgICAgICAgICAgICBnZmMuZW5baV0uc1tzYl1bal0gPSAxZTIwO1xuICAgICAgICAgICAgICAgICAgICBnZmMudGhtW2ldLnNbc2JdW2pdID0gMWUyMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZ2ZjLm5zUHN5Lmxhc3RBdHRhY2tzW2ldID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgOTsgaisrKVxuICAgICAgICAgICAgICAgIGdmYy5uc1BzeS5sYXN0X2VuX3N1YnNob3J0W2ldW2pdID0gMTAuO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogaW5pdC4gZm9yIGxvdWRuZXNzIGFwcHJveC4gLWpkIDIwMDEgbWFyIDI3ICovXG4gICAgICAgIGdmYy5sb3VkbmVzc19zcV9zYXZlWzBdID0gZ2ZjLmxvdWRuZXNzX3NxX3NhdmVbMV0gPSAwLjA7XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogbm93IGNvbXB1dGUgdGhlIHBzeWNob2Fjb3VzdGljIG1vZGVsIHNwZWNpZmljIGNvbnN0YW50c1xuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICAvKiBjb21wdXRlIG51bWxpbmVzLCBibywgYm0sIGJ2YWwsIGJ2YWxfd2lkdGgsIG1sZCAqL1xuXG4gICAgICAgIGdmYy5ucGFydF9sID0gaW5pdF9udW1saW5lKGdmYy5udW1saW5lc19sLCBnZmMuYm9fbCwgZ2ZjLmJtX2wsIGJ2YWwsXG4gICAgICAgICAgICBidmFsX3dpZHRoLCBnZmMubWxkX2wsIGdmYy5QU1kuYm9fbF93ZWlnaHQsIHNmcmVxLFxuICAgICAgICAgICAgRW5jb2Rlci5CTEtTSVpFLCBnZmMuc2NhbGVmYWNfYmFuZC5sLCBFbmNvZGVyLkJMS1NJWkVcbiAgICAgICAgICAgIC8gKDIuMCAqIDU3NiksIEVuY29kZXIuU0JNQVhfbCk7XG4gICAgICAgIC8qIGNvbXB1dGUgdGhlIHNwcmVhZGluZyBmdW5jdGlvbiAqL1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZ2ZjLm5wYXJ0X2w7IGkrKykge1xuICAgICAgICAgICAgdmFyIHNuciA9IHNucl9sX2E7XG4gICAgICAgICAgICBpZiAoYnZhbFtpXSA+PSBidmxfYSkge1xuICAgICAgICAgICAgICAgIHNuciA9IHNucl9sX2IgKiAoYnZhbFtpXSAtIGJ2bF9hKSAvIChidmxfYiAtIGJ2bF9hKSArIHNucl9sX2FcbiAgICAgICAgICAgICAgICAgICAgKiAoYnZsX2IgLSBidmFsW2ldKSAvIChidmxfYiAtIGJ2bF9hKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5vcm1baV0gPSBNYXRoLnBvdygxMC4wLCBzbnIgLyAxMC4wKTtcbiAgICAgICAgICAgIGlmIChnZmMubnVtbGluZXNfbFtpXSA+IDApIHtcbiAgICAgICAgICAgICAgICBnZmMucm51bWxpbmVzX2xbaV0gPSAxLjAgLyBnZmMubnVtbGluZXNfbFtpXTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZ2ZjLnJudW1saW5lc19sW2ldID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBnZmMuczNfbGwgPSBpbml0X3MzX3ZhbHVlcyhnZmMuczNpbmQsIGdmYy5ucGFydF9sLCBidmFsLCBidmFsX3dpZHRoLFxuICAgICAgICAgICAgbm9ybSwgdXNlT2xkUzMpO1xuXG4gICAgICAgIC8qIGNvbXB1dGUgbG9uZyBibG9jayBzcGVjaWZpYyB2YWx1ZXMsIEFUSCBhbmQgTUlOVkFMICovXG4gICAgICAgIHZhciBqID0gMDtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGdmYy5ucGFydF9sOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB4O1xuXG4gICAgICAgICAgICAvKiBBVEggKi9cbiAgICAgICAgICAgIHggPSBGbG9hdC5NQVhfVkFMVUU7XG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IGdmYy5udW1saW5lc19sW2ldOyBrKyssIGorKykge1xuICAgICAgICAgICAgICAgIHZhciBmcmVxID0gc2ZyZXEgKiBqIC8gKDEwMDAuMCAqIEVuY29kZXIuQkxLU0laRSk7XG4gICAgICAgICAgICAgICAgdmFyIGxldmVsO1xuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogQVRIIGJlbG93IDEwMCBIeiBjb25zdGFudCwgbm90IGZ1cnRoZXIgY2xpbWJpbmdcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBsZXZlbCA9IHRoaXMuQVRIZm9ybXVsYShmcmVxICogMTAwMCwgZ2ZwKSAtIDIwO1xuICAgICAgICAgICAgICAgIC8vIHNjYWxlIHRvIEZGVCB1bml0czsgcmV0dXJuZWQgdmFsdWUgaXMgaW4gZEJcbiAgICAgICAgICAgICAgICBsZXZlbCA9IE1hdGgucG93KDEwLiwgMC4xICogbGV2ZWwpO1xuICAgICAgICAgICAgICAgIC8vIGNvbnZlcnQgZnJvbSBkQiAuIGVuZXJneVxuICAgICAgICAgICAgICAgIGxldmVsICo9IGdmYy5udW1saW5lc19sW2ldO1xuICAgICAgICAgICAgICAgIGlmICh4ID4gbGV2ZWwpXG4gICAgICAgICAgICAgICAgICAgIHggPSBsZXZlbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy5BVEguY2JfbFtpXSA9IHg7XG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBNSU5WQUwuIEZvciBsb3cgZnJlcSwgdGhlIHN0cmVuZ3RoIG9mIHRoZSBtYXNraW5nIGlzIGxpbWl0ZWQgYnlcbiAgICAgICAgICAgICAqIG1pbnZhbCB0aGlzIGlzIGFuIElTTyBNUEVHMSB0aGluZywgZG9udCBrbm93IGlmIGl0IGlzIHJlYWxseVxuICAgICAgICAgICAgICogbmVlZGVkXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBGSVhNRTogaXQgZG9lcyB3b3JrIHRvIHJlZHVjZSBsb3ctZnJlcSBwcm9ibGVtcyBpbiBTNTMtV2luZC1TYXhcbiAgICAgICAgICAgICAqIGFuZCBsZWFkLXZvaWNlIHNhbXBsZXMsIGJ1dCBpbnRyb2R1Y2VzIHNvbWUgMyBrYnBzIGJpdCBibG9hdCB0b28uXG4gICAgICAgICAgICAgKiBUT0RPOiBGdXJ0aGVyIHJlZmluZW1lbnQgb2YgdGhlIHNoYXBlIG9mIHRoaXMgaGFjay5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgeCA9IC0yMCArIGJ2YWxbaV0gKiAyMCAvIDEwO1xuICAgICAgICAgICAgaWYgKHggPiA2KSB7XG4gICAgICAgICAgICAgICAgeCA9IDEwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh4IDwgLTE1KSB7XG4gICAgICAgICAgICAgICAgeCA9IC0xNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHggLT0gOC47XG4gICAgICAgICAgICBnZmMubWludmFsX2xbaV0gPSAoTWF0aC5wb3coMTAuMCwgeCAvIDEwLikgKiBnZmMubnVtbGluZXNfbFtpXSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIGRvIHRoZSBzYW1lIHRoaW5ncyBmb3Igc2hvcnQgYmxvY2tzXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIGdmYy5ucGFydF9zID0gaW5pdF9udW1saW5lKGdmYy5udW1saW5lc19zLCBnZmMuYm9fcywgZ2ZjLmJtX3MsIGJ2YWwsXG4gICAgICAgICAgICBidmFsX3dpZHRoLCBnZmMubWxkX3MsIGdmYy5QU1kuYm9fc193ZWlnaHQsIHNmcmVxLFxuICAgICAgICAgICAgRW5jb2Rlci5CTEtTSVpFX3MsIGdmYy5zY2FsZWZhY19iYW5kLnMsIEVuY29kZXIuQkxLU0laRV9zXG4gICAgICAgICAgICAvICgyLjAgKiAxOTIpLCBFbmNvZGVyLlNCTUFYX3MpO1xuXG4gICAgICAgIC8qIFNOUiBmb3JtdWxhLiBzaG9ydCBibG9jayBpcyBub3JtYWxpemVkIGJ5IFNOUi4gaXMgaXQgc3RpbGwgcmlnaHQgPyAqL1xuICAgICAgICBqID0gMDtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGdmYy5ucGFydF9zOyBpKyspIHtcbiAgICAgICAgICAgIHZhciB4O1xuICAgICAgICAgICAgdmFyIHNuciA9IHNucl9zX2E7XG4gICAgICAgICAgICBpZiAoYnZhbFtpXSA+PSBidmxfYSkge1xuICAgICAgICAgICAgICAgIHNuciA9IHNucl9zX2IgKiAoYnZhbFtpXSAtIGJ2bF9hKSAvIChidmxfYiAtIGJ2bF9hKSArIHNucl9zX2FcbiAgICAgICAgICAgICAgICAgICAgKiAoYnZsX2IgLSBidmFsW2ldKSAvIChidmxfYiAtIGJ2bF9hKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5vcm1baV0gPSBNYXRoLnBvdygxMC4wLCBzbnIgLyAxMC4wKTtcblxuICAgICAgICAgICAgLyogQVRIICovXG4gICAgICAgICAgICB4ID0gRmxvYXQuTUFYX1ZBTFVFO1xuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBnZmMubnVtbGluZXNfc1tpXTsgaysrLCBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJlcSA9IHNmcmVxICogaiAvICgxMDAwLjAgKiBFbmNvZGVyLkJMS1NJWkVfcyk7XG4gICAgICAgICAgICAgICAgdmFyIGxldmVsO1xuICAgICAgICAgICAgICAgIC8qIGZyZXEgPSBNaW4oLjEsZnJlcSk7ICovXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBBVEggYmVsb3cgMTAwIEh6IGNvbnN0YW50LCBub3RcbiAgICAgICAgICAgICAgICAgKiBmdXJ0aGVyIGNsaW1iaW5nXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgbGV2ZWwgPSB0aGlzLkFUSGZvcm11bGEoZnJlcSAqIDEwMDAsIGdmcCkgLSAyMDtcbiAgICAgICAgICAgICAgICAvLyBzY2FsZSB0byBGRlQgdW5pdHM7IHJldHVybmVkIHZhbHVlIGlzIGluIGRCXG4gICAgICAgICAgICAgICAgbGV2ZWwgPSBNYXRoLnBvdygxMC4sIDAuMSAqIGxldmVsKTtcbiAgICAgICAgICAgICAgICAvLyBjb252ZXJ0IGZyb20gZEIgLiBlbmVyZ3lcbiAgICAgICAgICAgICAgICBsZXZlbCAqPSBnZmMubnVtbGluZXNfc1tpXTtcbiAgICAgICAgICAgICAgICBpZiAoeCA+IGxldmVsKVxuICAgICAgICAgICAgICAgICAgICB4ID0gbGV2ZWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMuQVRILmNiX3NbaV0gPSB4O1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogTUlOVkFMLiBGb3IgbG93IGZyZXEsIHRoZSBzdHJlbmd0aCBvZiB0aGUgbWFza2luZyBpcyBsaW1pdGVkIGJ5XG4gICAgICAgICAgICAgKiBtaW52YWwgdGhpcyBpcyBhbiBJU08gTVBFRzEgdGhpbmcsIGRvbnQga25vdyBpZiBpdCBpcyByZWFsbHlcbiAgICAgICAgICAgICAqIG5lZWRlZFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB4ID0gKC03LjAgKyBidmFsW2ldICogNy4wIC8gMTIuMCk7XG4gICAgICAgICAgICBpZiAoYnZhbFtpXSA+IDEyKSB7XG4gICAgICAgICAgICAgICAgeCAqPSAxICsgTWF0aC5sb2coMSArIHgpICogMy4xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGJ2YWxbaV0gPCAxMikge1xuICAgICAgICAgICAgICAgIHggKj0gMSArIE1hdGgubG9nKDEgLSB4KSAqIDIuMztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh4IDwgLTE1KSB7XG4gICAgICAgICAgICAgICAgeCA9IC0xNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHggLT0gODtcbiAgICAgICAgICAgIGdmYy5taW52YWxfc1tpXSA9IE1hdGgucG93KDEwLjAsIHggLyAxMClcbiAgICAgICAgICAgICAgICAqIGdmYy5udW1saW5lc19zW2ldO1xuICAgICAgICB9XG5cbiAgICAgICAgZ2ZjLnMzX3NzID0gaW5pdF9zM192YWx1ZXMoZ2ZjLnMzaW5kX3MsIGdmYy5ucGFydF9zLCBidmFsLCBidmFsX3dpZHRoLFxuICAgICAgICAgICAgbm9ybSwgdXNlT2xkUzMpO1xuXG4gICAgICAgIGluaXRfbWFza19hZGRfbWF4X3ZhbHVlcygpO1xuICAgICAgICBmZnQuaW5pdF9mZnQoZ2ZjKTtcblxuICAgICAgICAvKiBzZXR1cCB0ZW1wb3JhbCBtYXNraW5nICovXG4gICAgICAgIGdmYy5kZWNheSA9IE1hdGguZXhwKC0xLjAgKiBMT0cxMFxuICAgICAgICAgICAgLyAodGVtcG9yYWxtYXNrX3N1c3RhaW5fc2VjICogc2ZyZXEgLyAxOTIuMCkpO1xuXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBtc2ZpeDtcbiAgICAgICAgICAgIG1zZml4ID0gTlNfTVNGSVg7XG4gICAgICAgICAgICBpZiAoKGdmcC5leHBfbnNwc3l0dW5lICYgMikgIT0gMClcbiAgICAgICAgICAgICAgICBtc2ZpeCA9IDEuMDtcbiAgICAgICAgICAgIGlmIChNYXRoLmFicyhnZnAubXNmaXgpID4gMC4wKVxuICAgICAgICAgICAgICAgIG1zZml4ID0gZ2ZwLm1zZml4O1xuICAgICAgICAgICAgZ2ZwLm1zZml4ID0gbXNmaXg7XG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBzcHJlYWQgb25seSBmcm9tIG5wYXJ0X2wgYmFuZHMuIE5vcm1hbGx5LCB3ZSB1c2UgdGhlIHNwcmVhZGluZ1xuICAgICAgICAgICAgICogZnVuY3Rpb24gdG8gY29udm9sdmUgZnJvbSBucGFydF9sIGRvd24gdG8gbnBhcnRfbCBiYW5kc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IGdmYy5ucGFydF9sOyBiKyspXG4gICAgICAgICAgICAgICAgaWYgKGdmYy5zM2luZFtiXVsxXSA+IGdmYy5ucGFydF9sIC0gMSlcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnMzaW5kW2JdWzFdID0gZ2ZjLm5wYXJ0X2wgLSAxO1xuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgICogcHJlcGFyZSBmb3IgQVRIIGF1dG8gYWRqdXN0bWVudDogd2Ugd2FudCB0byBkZWNyZWFzZSB0aGUgQVRIIGJ5IDEyIGRCXG4gICAgICAgICAqIHBlciBzZWNvbmRcbiAgICAgICAgICovXG4gICAgICAgIHZhciBmcmFtZV9kdXJhdGlvbiA9ICg1NzYuICogZ2ZjLm1vZGVfZ3IgLyBzZnJlcSk7XG4gICAgICAgIGdmYy5BVEguZGVjYXkgPSBNYXRoLnBvdygxMC4sIC0xMi4gLyAxMC4gKiBmcmFtZV9kdXJhdGlvbik7XG4gICAgICAgIGdmYy5BVEguYWRqdXN0ID0gMC4wMTtcbiAgICAgICAgLyogbWluaW11bSwgZm9yIGxlYWRpbmcgbG93IGxvdWRuZXNzICovXG4gICAgICAgIGdmYy5BVEguYWRqdXN0TGltaXQgPSAxLjA7XG4gICAgICAgIC8qIG9uIGxlYWQsIGFsbG93IGFkanVzdCB1cCB0byBtYXhpbXVtICovXG5cblxuICAgICAgICBpZiAoZ2ZwLkFUSHR5cGUgIT0gLTEpIHtcbiAgICAgICAgICAgIC8qIGNvbXB1dGUgZXF1YWwgbG91ZG5lc3Mgd2VpZ2h0cyAoZXFsX3cpICovXG4gICAgICAgICAgICB2YXIgZnJlcTtcbiAgICAgICAgICAgIHZhciBmcmVxX2luYyA9IGdmcC5vdXRfc2FtcGxlcmF0ZVxuICAgICAgICAgICAgICAgIC8gKEVuY29kZXIuQkxLU0laRSk7XG4gICAgICAgICAgICB2YXIgZXFsX2JhbGFuY2UgPSAwLjA7XG4gICAgICAgICAgICBmcmVxID0gMC4wO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IEVuY29kZXIuQkxLU0laRSAvIDI7ICsraSkge1xuICAgICAgICAgICAgICAgIC8qIGNvbnZlcnQgQVRIIGRCIHRvIHJlbGF0aXZlIHBvd2VyIChub3QgZEIpICovXG4gICAgICAgICAgICAgICAgLyogdG8gZGV0ZXJtaW5lIGVxbF93ICovXG4gICAgICAgICAgICAgICAgZnJlcSArPSBmcmVxX2luYztcbiAgICAgICAgICAgICAgICBnZmMuQVRILmVxbF93W2ldID0gMS4gLyBNYXRoLnBvdygxMCwgdGhpcy5BVEhmb3JtdWxhKGZyZXEsIGdmcCkgLyAxMCk7XG4gICAgICAgICAgICAgICAgZXFsX2JhbGFuY2UgKz0gZ2ZjLkFUSC5lcWxfd1tpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVxbF9iYWxhbmNlID0gMS4wIC8gZXFsX2JhbGFuY2U7XG4gICAgICAgICAgICBmb3IgKGkgPSBFbmNvZGVyLkJMS1NJWkUgLyAyOyAtLWkgPj0gMDspIHsgLyogc2NhbGUgd2VpZ2h0cyAqL1xuICAgICAgICAgICAgICAgIGdmYy5BVEguZXFsX3dbaV0gKj0gZXFsX2JhbGFuY2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgICAgZm9yICh2YXIgYiA9IGogPSAwOyBiIDwgZ2ZjLm5wYXJ0X3M7ICsrYikge1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBnZmMubnVtbGluZXNfc1tiXTsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgICsrajtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBiID0gaiA9IDA7IGIgPCBnZmMubnBhcnRfbDsgKytiKSB7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGdmYy5udW1saW5lc19sW2JdOyArK2kpIHtcbiAgICAgICAgICAgICAgICAgICAgKytqO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBqID0gMDtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGdmYy5ucGFydF9sOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBmcmVxID0gc2ZyZXEgKiAoaiArIGdmYy5udW1saW5lc19sW2ldIC8gMikgLyAoMS4wICogRW5jb2Rlci5CTEtTSVpFKTtcbiAgICAgICAgICAgIGdmYy5tbGRfY2JfbFtpXSA9IHN0ZXJlb19kZW1hc2soZnJlcSk7XG4gICAgICAgICAgICBqICs9IGdmYy5udW1saW5lc19sW2ldO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoOyBpIDwgRW5jb2Rlci5DQkFORFM7ICsraSkge1xuICAgICAgICAgICAgZ2ZjLm1sZF9jYl9sW2ldID0gMTtcbiAgICAgICAgfVxuICAgICAgICBqID0gMDtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGdmYy5ucGFydF9zOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBmcmVxID0gc2ZyZXEgKiAoaiArIGdmYy5udW1saW5lc19zW2ldIC8gMikgLyAoMS4wICogRW5jb2Rlci5CTEtTSVpFX3MpO1xuICAgICAgICAgICAgZ2ZjLm1sZF9jYl9zW2ldID0gc3RlcmVvX2RlbWFzayhmcmVxKTtcbiAgICAgICAgICAgIGogKz0gZ2ZjLm51bWxpbmVzX3NbaV07XG4gICAgICAgIH1cbiAgICAgICAgZm9yICg7IGkgPCBFbmNvZGVyLkNCQU5EUzsgKytpKSB7XG4gICAgICAgICAgICBnZmMubWxkX2NiX3NbaV0gPSAxO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRob3NlIEFUSCBmb3JtdWxhcyBhcmUgcmV0dXJuaW5nIHRoZWlyIG1pbmltdW0gdmFsdWUgZm9yIGlucHV0ID0gLTFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBBVEhmb3JtdWxhX0dCKGYsIHZhbHVlKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiA8UFJFPlxuICAgICAgICAgKiAgZnJvbSBQYWludGVyICYgU3Bhbmlhc1xuICAgICAgICAgKiAgICAgICAgICAgbW9kaWZpZWQgYnkgR2FicmllbCBCb3V2aWduZSB0byBiZXR0ZXIgZml0IHRoZSByZWFsaXR5XG4gICAgICAgICAqICAgICAgICAgICBhdGggPSAgICAzLjY0MCAqIHBvdyhmLC0wLjgpXG4gICAgICAgICAqICAgICAgICAgICAtIDYuODAwICogZXhwKC0wLjYqcG93KGYtMy40LDIuMCkpXG4gICAgICAgICAqICAgICAgICAgICArIDYuMDAwICogZXhwKC0wLjE1KnBvdyhmLTguNywyLjApKVxuICAgICAgICAgKiAgICAgICAgICAgKyAwLjYqIDAuMDAxICogcG93KGYsNC4wKTtcbiAgICAgICAgICpcbiAgICAgICAgICpcbiAgICAgICAgICogICAgICAgICAgIEluIHRoZSBwYXN0IExBTUUgd2FzIHVzaW5nIHRoZSBQYWludGVyICZTcGFuaWFzIGZvcm11bGEuXG4gICAgICAgICAqICAgICAgICAgICBCdXQgd2UgaGFkIHNvbWUgcmVjdXJyZW50IHByb2JsZW1zIHdpdGggSEYgY29udGVudC5cbiAgICAgICAgICogICAgICAgICAgIFdlIG1lYXN1cmVkIHJlYWwgQVRIIHZhbHVlcywgYW5kIGZvdW5kIHRoZSBvbGRlciBmb3JtdWxhXG4gICAgICAgICAqICAgICAgICAgICB0byBiZSBpbmFjY3VyYXRlIGluIHRoZSBoaWdoZXIgcGFydC4gU28gd2UgbWFkZSB0aGlzIG5ld1xuICAgICAgICAgKiAgICAgICAgICAgZm9ybXVsYSBhbmQgdGhpcyBzb2x2ZWQgbW9zdCBvZiBIRiBwcm9ibGVtYXRpYyB0ZXN0IGNhc2VzLlxuICAgICAgICAgKiAgICAgICAgICAgVGhlIHRyYWRlb2ZmIGlzIHRoYXQgaW4gVkJSIG1vZGUgaXQgaW5jcmVhc2VzIGEgbG90IHRoZVxuICAgICAgICAgKiAgICAgICAgICAgYml0cmF0ZS5cbiAgICAgICAgICogPC9QUkU+XG4gICAgICAgICAqL1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIFRoaXMgY3VydmUgY2FuIGJlIGFkanVzdGVkIGFjY29yZGluZyB0byB0aGUgVkJSIHNjYWxlOiBpdCBhZGp1c3RzXG4gICAgICAgICAqIGZyb20gc29tZXRoaW5nIGNsb3NlIHRvIFBhaW50ZXIgJiBTcGFuaWFzIG9uIFY5IHVwIHRvIEJvdXZpZ25lJ3NcbiAgICAgICAgICogZm9ybXVsYSBmb3IgVjAuIFRoaXMgd2F5IHRoZSBWQlIgYml0cmF0ZSBpcyBtb3JlIGJhbGFuY2VkIGFjY29yZGluZ1xuICAgICAgICAgKiB0byB0aGUgLVYgdmFsdWUuXG4gICAgICAgICAqL1xuXG4gICAgICAgIC8vIHRoZSBmb2xsb3dpbmcgSGFjayBhbGxvd3MgdG8gYXNrIGZvciB0aGUgbG93ZXN0IHZhbHVlXG4gICAgICAgIGlmIChmIDwgLS4zKVxuICAgICAgICAgICAgZiA9IDM0MTA7XG5cbiAgICAgICAgLy8gY29udmVydCB0byBraHpcbiAgICAgICAgZiAvPSAxMDAwO1xuICAgICAgICBmID0gTWF0aC5tYXgoMC4xLCBmKTtcbiAgICAgICAgdmFyIGF0aCA9IDMuNjQwICogTWF0aC5wb3coZiwgLTAuOCkgLSA2LjgwMFxuICAgICAgICAgICAgKiBNYXRoLmV4cCgtMC42ICogTWF0aC5wb3coZiAtIDMuNCwgMi4wKSkgKyA2LjAwMFxuICAgICAgICAgICAgKiBNYXRoLmV4cCgtMC4xNSAqIE1hdGgucG93KGYgLSA4LjcsIDIuMCkpXG4gICAgICAgICAgICArICgwLjYgKyAwLjA0ICogdmFsdWUpICogMC4wMDEgKiBNYXRoLnBvdyhmLCA0LjApO1xuICAgICAgICByZXR1cm4gYXRoO1xuICAgIH1cblxuICAgIHRoaXMuQVRIZm9ybXVsYSA9IGZ1bmN0aW9uIChmLCBnZnApIHtcbiAgICAgICAgdmFyIGF0aDtcbiAgICAgICAgc3dpdGNoIChnZnAuQVRIdHlwZSkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIGF0aCA9IEFUSGZvcm11bGFfR0IoZiwgOSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgLy8gb3ZlciBzZW5zaXRpdmUsIHNob3VsZCBwcm9iYWJseSBiZSByZW1vdmVkXG4gICAgICAgICAgICAgICAgYXRoID0gQVRIZm9ybXVsYV9HQihmLCAtMSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgYXRoID0gQVRIZm9ybXVsYV9HQihmLCAwKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICAvLyBtb2RpZmljYXRpb24gb2YgR0IgZm9ybXVsYSBieSBSb2VsXG4gICAgICAgICAgICAgICAgYXRoID0gQVRIZm9ybXVsYV9HQihmLCAxKSArIDY7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgYXRoID0gQVRIZm9ybXVsYV9HQihmLCBnZnAuQVRIY3VydmUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBhdGggPSBBVEhmb3JtdWxhX0dCKGYsIDApO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhdGg7XG4gICAgfVxuXG59XG5cblxuXG5mdW5jdGlvbiBMYW1lKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgTEFNRV9NQVhBTEJVTUFSVCA9ICgxMjggKiAxMDI0KTtcblxuICAgIExhbWUuVjkgPSA0MTA7XG4gICAgTGFtZS5WOCA9IDQyMDtcbiAgICBMYW1lLlY3ID0gNDMwO1xuICAgIExhbWUuVjYgPSA0NDA7XG4gICAgTGFtZS5WNSA9IDQ1MDtcbiAgICBMYW1lLlY0ID0gNDYwO1xuICAgIExhbWUuVjMgPSA0NzA7XG4gICAgTGFtZS5WMiA9IDQ4MDtcbiAgICBMYW1lLlYxID0gNDkwO1xuICAgIExhbWUuVjAgPSA1MDA7XG5cbiAgICAvKiBzdGlsbCB0aGVyZSBmb3IgY29tcGF0aWJpbGl0eSAqL1xuXG4gICAgTGFtZS5SM01JWCA9IDEwMDA7XG4gICAgTGFtZS5TVEFOREFSRCA9IDEwMDE7XG4gICAgTGFtZS5FWFRSRU1FID0gMTAwMjtcbiAgICBMYW1lLklOU0FORSA9IDEwMDM7XG4gICAgTGFtZS5TVEFOREFSRF9GQVNUID0gMTAwNDtcbiAgICBMYW1lLkVYVFJFTUVfRkFTVCA9IDEwMDU7XG4gICAgTGFtZS5NRURJVU0gPSAxMDA2O1xuICAgIExhbWUuTUVESVVNX0ZBU1QgPSAxMDA3O1xuXG4gICAgLyoqXG4gICAgICogbWF4aW11bSBzaXplIG9mIG1wM2J1ZmZlciBuZWVkZWQgaWYgeW91IGVuY29kZSBhdCBtb3N0IDExNTIgc2FtcGxlcyBmb3JcbiAgICAgKiBlYWNoIGNhbGwgdG8gbGFtZV9lbmNvZGVfYnVmZmVyLiBzZWUgbGFtZV9lbmNvZGVfYnVmZmVyKCkgYmVsb3dcbiAgICAgKiAoTEFNRV9NQVhNUDNCVUZGRVIgaXMgbm93IG9ic29sZXRlKVxuICAgICAqL1xuICAgIHZhciBMQU1FX01BWE1QM0JVRkZFUiA9ICgxNjM4NCArIExBTUVfTUFYQUxCVU1BUlQpO1xuICAgIExhbWUuTEFNRV9NQVhNUDNCVUZGRVIgPSBMQU1FX01BWE1QM0JVRkZFUjtcblxuICAgIHZhciBnYTtcbiAgICB2YXIgYnM7XG4gICAgdmFyIHA7XG4gICAgdmFyIHF1cHZ0O1xuICAgIHZhciBxdTtcbiAgICB2YXIgcHN5ID0gbmV3IFBzeU1vZGVsKCk7XG4gICAgdmFyIHZicjtcbiAgICB2YXIgdmVyO1xuICAgIHZhciBpZDM7XG4gICAgdmFyIG1wZ2xpYjtcbiAgICB0aGlzLmVuYyA9IG5ldyBFbmNvZGVyKCk7XG5cbiAgICB0aGlzLnNldE1vZHVsZXMgPSBmdW5jdGlvbiAoX2dhLCBfYnMsIF9wLCBfcXVwdnQsIF9xdSwgX3ZiciwgX3ZlciwgX2lkMywgX21wZ2xpYikge1xuICAgICAgICBnYSA9IF9nYTtcbiAgICAgICAgYnMgPSBfYnM7XG4gICAgICAgIHAgPSBfcDtcbiAgICAgICAgcXVwdnQgPSBfcXVwdnQ7XG4gICAgICAgIHF1ID0gX3F1O1xuICAgICAgICB2YnIgPSBfdmJyO1xuICAgICAgICB2ZXIgPSBfdmVyO1xuICAgICAgICBpZDMgPSBfaWQzO1xuICAgICAgICBtcGdsaWIgPSBfbXBnbGliO1xuICAgICAgICB0aGlzLmVuYy5zZXRNb2R1bGVzKGJzLCBwc3ksIHF1cHZ0LCB2YnIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBTWSBNb2RlbCByZWxhdGVkIHN0dWZmXG4gICAgICovXG4gICAgZnVuY3Rpb24gUFNZKCkge1xuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGRiUSBzdHVmZi5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubWFza19hZGp1c3QgPSAwLjtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBkYlEgc3R1ZmYuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm1hc2tfYWRqdXN0X3Nob3J0ID0gMC47XG4gICAgICAgIC8qIGF0IHRyYW5zaXRpb24gZnJvbSBvbmUgc2NhbGVmYWN0b3IgYmFuZCB0byBuZXh0ICovXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBCYW5kIHdlaWdodCBsb25nIHNjYWxlZmFjdG9yIGJhbmRzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5ib19sX3dlaWdodCA9IG5ld19mbG9hdChFbmNvZGVyLlNCTUFYX2wpO1xuICAgICAgICAvKipcbiAgICAgICAgICogQmFuZCB3ZWlnaHQgc2hvcnQgc2NhbGVmYWN0b3IgYmFuZHMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJvX3Nfd2VpZ2h0ID0gbmV3X2Zsb2F0KEVuY29kZXIuU0JNQVhfcyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gTG93UGFzc0hpZ2hQYXNzKCkge1xuICAgICAgICB0aGlzLmxvd2VybGltaXQgPSAwLjtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBCYW5kUGFzcyhiaXRyYXRlLCBsUGFzcykge1xuICAgICAgICB0aGlzLmxvd3Bhc3MgPSBsUGFzcztcbiAgICB9XG5cbiAgICB2YXIgTEFNRV9JRCA9IDB4RkZGODhFM0I7XG5cbiAgICBmdW5jdGlvbiBsYW1lX2luaXRfb2xkKGdmcCkge1xuICAgICAgICB2YXIgZ2ZjO1xuXG4gICAgICAgIGdmcC5jbGFzc19pZCA9IExBTUVfSUQ7XG5cbiAgICAgICAgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzID0gbmV3IExhbWVJbnRlcm5hbEZsYWdzKCk7XG5cbiAgICAgICAgLyogR2xvYmFsIGZsYWdzLiBzZXQgZGVmYXVsdHMgaGVyZSBmb3Igbm9uLXplcm8gdmFsdWVzICovXG4gICAgICAgIC8qIHNlZSBsYW1lLmggZm9yIGRlc2NyaXB0aW9uICovXG4gICAgICAgIC8qXG4gICAgICAgICAqIHNldCBpbnRlZ2VyIHZhbHVlcyB0byAtMSB0byBtZWFuIHRoYXQgTEFNRSB3aWxsIGNvbXB1dGUgdGhlIGJlc3RcbiAgICAgICAgICogdmFsdWUsIFVOTEVTUyB0aGUgY2FsbGluZyBwcm9ncmFtIGFzIHNldCBpdCAoYW5kIHRoZSB2YWx1ZSBpcyBub1xuICAgICAgICAgKiBsb25nZXIgLTEpXG4gICAgICAgICAqL1xuXG4gICAgICAgIGdmcC5tb2RlID0gTVBFR01vZGUuTk9UX1NFVDtcbiAgICAgICAgZ2ZwLm9yaWdpbmFsID0gMTtcbiAgICAgICAgZ2ZwLmluX3NhbXBsZXJhdGUgPSA0NDEwMDtcbiAgICAgICAgZ2ZwLm51bV9jaGFubmVscyA9IDI7XG4gICAgICAgIGdmcC5udW1fc2FtcGxlcyA9IC0xO1xuXG4gICAgICAgIGdmcC5iV3JpdGVWYnJUYWcgPSB0cnVlO1xuICAgICAgICBnZnAucXVhbGl0eSA9IC0xO1xuICAgICAgICBnZnAuc2hvcnRfYmxvY2tzID0gbnVsbDtcbiAgICAgICAgZ2ZjLnN1YmJsb2NrX2dhaW4gPSAtMTtcblxuICAgICAgICBnZnAubG93cGFzc2ZyZXEgPSAwO1xuICAgICAgICBnZnAuaGlnaHBhc3NmcmVxID0gMDtcbiAgICAgICAgZ2ZwLmxvd3Bhc3N3aWR0aCA9IC0xO1xuICAgICAgICBnZnAuaGlnaHBhc3N3aWR0aCA9IC0xO1xuXG4gICAgICAgIGdmcC5WQlIgPSBWYnJNb2RlLnZicl9vZmY7XG4gICAgICAgIGdmcC5WQlJfcSA9IDQ7XG4gICAgICAgIGdmcC5BVEhjdXJ2ZSA9IC0xO1xuICAgICAgICBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzID0gMTI4O1xuICAgICAgICBnZnAuVkJSX21pbl9iaXRyYXRlX2ticHMgPSAwO1xuICAgICAgICBnZnAuVkJSX21heF9iaXRyYXRlX2ticHMgPSAwO1xuICAgICAgICBnZnAuVkJSX2hhcmRfbWluID0gMDtcbiAgICAgICAgZ2ZjLlZCUl9taW5fYml0cmF0ZSA9IDE7XG4gICAgICAgIC8qIG5vdCAwID8/Pz8/ICovXG4gICAgICAgIGdmYy5WQlJfbWF4X2JpdHJhdGUgPSAxMztcbiAgICAgICAgLyogbm90IDE0ID8/Pz8/ICovXG5cbiAgICAgICAgZ2ZwLnF1YW50X2NvbXAgPSAtMTtcbiAgICAgICAgZ2ZwLnF1YW50X2NvbXBfc2hvcnQgPSAtMTtcblxuICAgICAgICBnZnAubXNmaXggPSAtMTtcblxuICAgICAgICBnZmMucmVzYW1wbGVfcmF0aW8gPSAxO1xuXG4gICAgICAgIGdmYy5PbGRWYWx1ZVswXSA9IDE4MDtcbiAgICAgICAgZ2ZjLk9sZFZhbHVlWzFdID0gMTgwO1xuICAgICAgICBnZmMuQ3VycmVudFN0ZXBbMF0gPSA0O1xuICAgICAgICBnZmMuQ3VycmVudFN0ZXBbMV0gPSA0O1xuICAgICAgICBnZmMubWFza2luZ19sb3dlciA9IDE7XG4gICAgICAgIGdmYy5uc1BzeS5hdHRhY2t0aHJlID0gLTE7XG4gICAgICAgIGdmYy5uc1BzeS5hdHRhY2t0aHJlX3MgPSAtMTtcblxuICAgICAgICBnZnAuc2NhbGUgPSAtMTtcblxuICAgICAgICBnZnAuYXRoYWFfdHlwZSA9IC0xO1xuICAgICAgICBnZnAuQVRIdHlwZSA9IC0xO1xuICAgICAgICAvKiBkZWZhdWx0ID0gLTEgPSBzZXQgaW4gbGFtZV9pbml0X3BhcmFtcyAqL1xuICAgICAgICBnZnAuYXRoYWFfbG91ZGFwcHJveCA9IC0xO1xuICAgICAgICAvKiAxID0gZmxhdCBsb3VkbmVzcyBhcHByb3guICh0b3RhbCBlbmVyZ3kpICovXG4gICAgICAgIC8qIDIgPSBlcXVhbCBsb3VkbmVzcyBjdXJ2ZSAqL1xuICAgICAgICBnZnAuYXRoYWFfc2Vuc2l0aXZpdHkgPSAwLjA7XG4gICAgICAgIC8qIG5vIG9mZnNldCAqL1xuICAgICAgICBnZnAudXNlVGVtcG9yYWwgPSBudWxsO1xuICAgICAgICBnZnAuaW50ZXJDaFJhdGlvID0gLTE7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogVGhlIHJlYXNvbiBmb3IgaW50IG1mX3NhbXBsZXNfdG9fZW5jb2RlID0gRU5DREVMQVkgKyBQT1NUREVMQVk7XG4gICAgICAgICAqIEVOQ0RFTEFZID0gaW50ZXJuYWwgZW5jb2RlciBkZWxheS4gQW5kIHRoZW4gd2UgaGF2ZSB0byBhZGRcbiAgICAgICAgICogUE9TVERFTEFZPTI4OCBiZWNhdXNlIG9mIHRoZSA1MCUgTURDVCBvdmVybGFwLiBBIDU3NiBNRENUIGdyYW51bGVcbiAgICAgICAgICogZGVjb2RlcyB0byAxMTUyIHNhbXBsZXMuIFRvIHN5bnRoZXNpemUgdGhlIDU3NiBzYW1wbGVzIGNlbnRlcmVkIHVuZGVyXG4gICAgICAgICAqIHRoaXMgZ3JhbnVsZSB3ZSBuZWVkIHRoZSBwcmV2aW91cyBncmFudWxlIGZvciB0aGUgZmlyc3QgMjg4IHNhbXBsZXNcbiAgICAgICAgICogKG5vIHByb2JsZW0pLCBhbmQgdGhlIG5leHQgZ3JhbnVsZSBmb3IgdGhlIG5leHQgMjg4IHNhbXBsZXMgKG5vdFxuICAgICAgICAgKiBwb3NzaWJsZSBpZiB0aGlzIGlzIGxhc3QgZ3JhbnVsZSkuIFNvIHdlIG5lZWQgdG8gcGFkIHdpdGggMjg4IHNhbXBsZXNcbiAgICAgICAgICogdG8gbWFrZSBzdXJlIHdlIGNhbiBlbmNvZGUgdGhlIDU3NiBzYW1wbGVzIHdlIGFyZSBpbnRlcmVzdGVkIGluLlxuICAgICAgICAgKi9cbiAgICAgICAgZ2ZjLm1mX3NhbXBsZXNfdG9fZW5jb2RlID0gRW5jb2Rlci5FTkNERUxBWSArIEVuY29kZXIuUE9TVERFTEFZO1xuICAgICAgICBnZnAuZW5jb2Rlcl9wYWRkaW5nID0gMDtcbiAgICAgICAgZ2ZjLm1mX3NpemUgPSBFbmNvZGVyLkVOQ0RFTEFZIC0gRW5jb2Rlci5NRENUREVMQVk7XG4gICAgICAgIC8qXG4gICAgICAgICAqIHdlIHBhZCBpbnB1dCB3aXRoIHRoaXMgbWFueSAwJ3NcbiAgICAgICAgICovXG5cbiAgICAgICAgZ2ZwLmZpbmRSZXBsYXlHYWluID0gZmFsc2U7XG4gICAgICAgIGdmcC5kZWNvZGVfb25fdGhlX2ZseSA9IGZhbHNlO1xuXG4gICAgICAgIGdmYy5kZWNvZGVfb25fdGhlX2ZseSA9IGZhbHNlO1xuICAgICAgICBnZmMuZmluZFJlcGxheUdhaW4gPSBmYWxzZTtcbiAgICAgICAgZ2ZjLmZpbmRQZWFrU2FtcGxlID0gZmFsc2U7XG5cbiAgICAgICAgZ2ZjLlJhZGlvR2FpbiA9IDA7XG4gICAgICAgIGdmYy5BdWRpb3BoaWxlR2FpbiA9IDA7XG4gICAgICAgIGdmYy5ub2NsaXBHYWluQ2hhbmdlID0gMDtcbiAgICAgICAgZ2ZjLm5vY2xpcFNjYWxlID0gLTEuMDtcblxuICAgICAgICBnZnAucHJlc2V0ID0gMDtcblxuICAgICAgICBnZnAud3JpdGVfaWQzdGFnX2F1dG9tYXRpYyA9IHRydWU7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cblxuICAgIHRoaXMubGFtZV9pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZ2ZwID0gbmV3IExhbWVHbG9iYWxGbGFncygpO1xuXG4gICAgICAgIHZhciByZXQgPSBsYW1lX2luaXRfb2xkKGdmcCk7XG4gICAgICAgIGlmIChyZXQgIT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBnZnAubGFtZV9hbGxvY2F0ZWRfZ2ZwID0gMTtcbiAgICAgICAgcmV0dXJuIGdmcDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmaWx0ZXJfY29lZih4KSB7XG4gICAgICAgIGlmICh4ID4gMS4wKVxuICAgICAgICAgICAgcmV0dXJuIDAuMDtcbiAgICAgICAgaWYgKHggPD0gMC4wKVxuICAgICAgICAgICAgcmV0dXJuIDEuMDtcblxuICAgICAgICByZXR1cm4gTWF0aC5jb3MoTWF0aC5QSSAvIDIgKiB4KTtcbiAgICB9XG5cbiAgICB0aGlzLm5lYXJlc3RCaXRyYXRlRnVsbEluZGV4ID0gZnVuY3Rpb24gKGJpdHJhdGUpIHtcbiAgICAgICAgLyogYm9ycm93ZWQgZnJvbSBETSBhYnIgcHJlc2V0cyAqL1xuXG4gICAgICAgIHZhciBmdWxsX2JpdHJhdGVfdGFibGUgPSBbOCwgMTYsIDI0LCAzMiwgNDAsIDQ4LCA1NiwgNjQsIDgwLFxuICAgICAgICAgICAgOTYsIDExMiwgMTI4LCAxNjAsIDE5MiwgMjI0LCAyNTYsIDMyMF07XG5cbiAgICAgICAgdmFyIGxvd2VyX3JhbmdlID0gMCwgbG93ZXJfcmFuZ2Vfa2JwcyA9IDAsIHVwcGVyX3JhbmdlID0gMCwgdXBwZXJfcmFuZ2Vfa2JwcyA9IDA7XG5cbiAgICAgICAgLyogV2UgYXNzdW1lIHNwZWNpZmllZCBiaXRyYXRlIHdpbGwgYmUgMzIwa2JwcyAqL1xuICAgICAgICB1cHBlcl9yYW5nZV9rYnBzID0gZnVsbF9iaXRyYXRlX3RhYmxlWzE2XTtcbiAgICAgICAgdXBwZXJfcmFuZ2UgPSAxNjtcbiAgICAgICAgbG93ZXJfcmFuZ2Vfa2JwcyA9IGZ1bGxfYml0cmF0ZV90YWJsZVsxNl07XG4gICAgICAgIGxvd2VyX3JhbmdlID0gMTY7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogRGV0ZXJtaW5lIHdoaWNoIHNpZ25pZmljYW50IGJpdHJhdGVzIHRoZSB2YWx1ZSBzcGVjaWZpZWQgZmFsbHNcbiAgICAgICAgICogYmV0d2VlbiwgaWYgbG9vcCBlbmRzIHdpdGhvdXQgYnJlYWtpbmcgdGhlbiB3ZSB3ZXJlIGNvcnJlY3QgYWJvdmVcbiAgICAgICAgICogdGhhdCB0aGUgdmFsdWUgd2FzIDMyMFxuICAgICAgICAgKi9cbiAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCAxNjsgYisrKSB7XG4gICAgICAgICAgICBpZiAoKE1hdGgubWF4KGJpdHJhdGUsIGZ1bGxfYml0cmF0ZV90YWJsZVtiICsgMV0pKSAhPSBiaXRyYXRlKSB7XG4gICAgICAgICAgICAgICAgdXBwZXJfcmFuZ2Vfa2JwcyA9IGZ1bGxfYml0cmF0ZV90YWJsZVtiICsgMV07XG4gICAgICAgICAgICAgICAgdXBwZXJfcmFuZ2UgPSBiICsgMTtcbiAgICAgICAgICAgICAgICBsb3dlcl9yYW5nZV9rYnBzID0gZnVsbF9iaXRyYXRlX3RhYmxlW2JdO1xuICAgICAgICAgICAgICAgIGxvd2VyX3JhbmdlID0gKGIpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIC8qIFdlIGZvdW5kIHVwcGVyIHJhbmdlICovXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBEZXRlcm1pbmUgd2hpY2ggcmFuZ2UgdGhlIHZhbHVlIHNwZWNpZmllZCBpcyBjbG9zZXIgdG8gKi9cbiAgICAgICAgaWYgKCh1cHBlcl9yYW5nZV9rYnBzIC0gYml0cmF0ZSkgPiAoYml0cmF0ZSAtIGxvd2VyX3JhbmdlX2ticHMpKSB7XG4gICAgICAgICAgICByZXR1cm4gbG93ZXJfcmFuZ2U7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHVwcGVyX3JhbmdlO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9wdGltdW1fc2FtcGxlZnJlcShsb3dwYXNzZnJlcSwgaW5wdXRfc2FtcGxlZnJlcSkge1xuICAgICAgICAvKlxuICAgICAgICAgKiBSdWxlczpcbiAgICAgICAgICpcbiAgICAgICAgICogLSBpZiBwb3NzaWJsZSwgc2ZiMjEgc2hvdWxkIE5PVCBiZSB1c2VkXG4gICAgICAgICAqL1xuICAgICAgICB2YXIgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSA0NDEwMDtcblxuICAgICAgICBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+PSA0ODAwMClcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gNDgwMDA7XG4gICAgICAgIGVsc2UgaWYgKGlucHV0X3NhbXBsZWZyZXEgPj0gNDQxMDApXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDQ0MTAwO1xuICAgICAgICBlbHNlIGlmIChpbnB1dF9zYW1wbGVmcmVxID49IDMyMDAwKVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSAzMjAwMDtcbiAgICAgICAgZWxzZSBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+PSAyNDAwMClcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gMjQwMDA7XG4gICAgICAgIGVsc2UgaWYgKGlucHV0X3NhbXBsZWZyZXEgPj0gMjIwNTApXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDIyMDUwO1xuICAgICAgICBlbHNlIGlmIChpbnB1dF9zYW1wbGVmcmVxID49IDE2MDAwKVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSAxNjAwMDtcbiAgICAgICAgZWxzZSBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+PSAxMjAwMClcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gMTIwMDA7XG4gICAgICAgIGVsc2UgaWYgKGlucHV0X3NhbXBsZWZyZXEgPj0gMTEwMjUpXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDExMDI1O1xuICAgICAgICBlbHNlIGlmIChpbnB1dF9zYW1wbGVmcmVxID49IDgwMDApXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDgwMDA7XG5cbiAgICAgICAgaWYgKGxvd3Bhc3NmcmVxID09IC0xKVxuICAgICAgICAgICAgcmV0dXJuIHN1Z2dlc3RlZF9zYW1wbGVmcmVxO1xuXG4gICAgICAgIGlmIChsb3dwYXNzZnJlcSA8PSAxNTk2MClcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gNDQxMDA7XG4gICAgICAgIGlmIChsb3dwYXNzZnJlcSA8PSAxNTI1MClcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gMzIwMDA7XG4gICAgICAgIGlmIChsb3dwYXNzZnJlcSA8PSAxMTIyMClcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gMjQwMDA7XG4gICAgICAgIGlmIChsb3dwYXNzZnJlcSA8PSA5OTcwKVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSAyMjA1MDtcbiAgICAgICAgaWYgKGxvd3Bhc3NmcmVxIDw9IDcyMzApXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDE2MDAwO1xuICAgICAgICBpZiAobG93cGFzc2ZyZXEgPD0gNTQyMClcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gMTIwMDA7XG4gICAgICAgIGlmIChsb3dwYXNzZnJlcSA8PSA0NTEwKVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSAxMTAyNTtcbiAgICAgICAgaWYgKGxvd3Bhc3NmcmVxIDw9IDM5NzApXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDgwMDA7XG5cbiAgICAgICAgaWYgKGlucHV0X3NhbXBsZWZyZXEgPCBzdWdnZXN0ZWRfc2FtcGxlZnJlcSkge1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIGNob29zZSBhIHZhbGlkIE1QRUcgc2FtcGxlIGZyZXF1ZW5jeSBhYm92ZSB0aGUgaW5wdXQgc2FtcGxlXG4gICAgICAgICAgICAgKiBmcmVxdWVuY3kgdG8gYXZvaWQgU0ZCMjEvMTIgYml0cmF0ZSBibG9hdCByaCAwNjExMTVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKGlucHV0X3NhbXBsZWZyZXEgPiA0NDEwMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiA0ODAwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbnB1dF9zYW1wbGVmcmVxID4gMzIwMDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gNDQxMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+IDI0MDAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDMyMDAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlucHV0X3NhbXBsZWZyZXEgPiAyMjA1MCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAyNDAwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbnB1dF9zYW1wbGVmcmVxID4gMTYwMDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMjIwNTA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+IDEyMDAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE2MDAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlucHV0X3NhbXBsZWZyZXEgPiAxMTAyNSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAxMjAwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbnB1dF9zYW1wbGVmcmVxID4gODAwMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAxMTAyNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiA4MDAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdWdnZXN0ZWRfc2FtcGxlZnJlcTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjb252ZXJ0IHNhbXAgZnJlcSBpbiBIeiB0byBpbmRleFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFNtcEZycUluZGV4KHNhbXBsZV9mcmVxLCBncGYpIHtcbiAgICAgICAgc3dpdGNoIChzYW1wbGVfZnJlcSkge1xuICAgICAgICAgICAgY2FzZSA0NDEwMDpcbiAgICAgICAgICAgICAgICBncGYudmVyc2lvbiA9IDE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIDQ4MDAwOlxuICAgICAgICAgICAgICAgIGdwZi52ZXJzaW9uID0gMTtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIGNhc2UgMzIwMDA6XG4gICAgICAgICAgICAgICAgZ3BmLnZlcnNpb24gPSAxO1xuICAgICAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICAgICAgY2FzZSAyMjA1MDpcbiAgICAgICAgICAgICAgICBncGYudmVyc2lvbiA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIDI0MDAwOlxuICAgICAgICAgICAgICAgIGdwZi52ZXJzaW9uID0gMDtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIGNhc2UgMTYwMDA6XG4gICAgICAgICAgICAgICAgZ3BmLnZlcnNpb24gPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICAgICAgY2FzZSAxMTAyNTpcbiAgICAgICAgICAgICAgICBncGYudmVyc2lvbiA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICBjYXNlIDEyMDAwOlxuICAgICAgICAgICAgICAgIGdwZi52ZXJzaW9uID0gMDtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgIGNhc2UgODAwMDpcbiAgICAgICAgICAgICAgICBncGYudmVyc2lvbiA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDI7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGdwZi52ZXJzaW9uID0gMDtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gYlJhdGVcbiAgICAgKiAgICAgICAgICAgIGxlZ2FsIHJhdGVzIGZyb20gOCB0byAzMjBcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBGaW5kTmVhcmVzdEJpdHJhdGUoYlJhdGUsIHZlcnNpb24sIHNhbXBsZXJhdGUpIHtcbiAgICAgICAgLyogTVBFRy0xIG9yIE1QRUctMiBMU0YgKi9cbiAgICAgICAgaWYgKHNhbXBsZXJhdGUgPCAxNjAwMClcbiAgICAgICAgICAgIHZlcnNpb24gPSAyO1xuXG4gICAgICAgIHZhciBiaXRyYXRlID0gVGFibGVzLmJpdHJhdGVfdGFibGVbdmVyc2lvbl1bMV07XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDI7IGkgPD0gMTQ7IGkrKykge1xuICAgICAgICAgICAgaWYgKFRhYmxlcy5iaXRyYXRlX3RhYmxlW3ZlcnNpb25dW2ldID4gMCkge1xuICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyhUYWJsZXMuYml0cmF0ZV90YWJsZVt2ZXJzaW9uXVtpXSAtIGJSYXRlKSA8IE1hdGhcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hYnMoYml0cmF0ZSAtIGJSYXRlKSlcbiAgICAgICAgICAgICAgICAgICAgYml0cmF0ZSA9IFRhYmxlcy5iaXRyYXRlX3RhYmxlW3ZlcnNpb25dW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBiaXRyYXRlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSBiUmF0ZVxuICAgICAqICAgICAgICAgICAgbGVnYWwgcmF0ZXMgZnJvbSAzMiB0byA0NDgga2Jwc1xuICAgICAqIEBwYXJhbSB2ZXJzaW9uXG4gICAgICogICAgICAgICAgICBNUEVHLTEgb3IgTVBFRy0yLzIuNSBMU0ZcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBCaXRyYXRlSW5kZXgoYlJhdGUsIHZlcnNpb24sIHNhbXBsZXJhdGUpIHtcbiAgICAgICAgLyogY29udmVydCBiaXRyYXRlIGluIGticHMgdG8gaW5kZXggKi9cbiAgICAgICAgaWYgKHNhbXBsZXJhdGUgPCAxNjAwMClcbiAgICAgICAgICAgIHZlcnNpb24gPSAyO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8PSAxNDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoVGFibGVzLmJpdHJhdGVfdGFibGVbdmVyc2lvbl1baV0gPiAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKFRhYmxlcy5iaXRyYXRlX3RhYmxlW3ZlcnNpb25dW2ldID09IGJSYXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb3B0aW11bV9iYW5kd2lkdGgobGgsIGJpdHJhdGUpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIDxQUkU+XG4gICAgICAgICAqICBJbnB1dDpcbiAgICAgICAgICogICAgICBiaXRyYXRlICAgICB0b3RhbCBiaXRyYXRlIGluIGticHNcbiAgICAgICAgICpcbiAgICAgICAgICogICBPdXRwdXQ6XG4gICAgICAgICAqICAgICAgbG93ZXJsaW1pdDogYmVzdCBsb3dwYXNzIGZyZXF1ZW5jeSBsaW1pdCBmb3IgaW5wdXQgZmlsdGVyIGluIEh6XG4gICAgICAgICAqICAgICAgdXBwZXJsaW1pdDogYmVzdCBoaWdocGFzcyBmcmVxdWVuY3kgbGltaXQgZm9yIGlucHV0IGZpbHRlciBpbiBIelxuICAgICAgICAgKiA8L1BSRT5cbiAgICAgICAgICovXG4gICAgICAgIHZhciBmcmVxX21hcCA9IFtuZXcgQmFuZFBhc3MoOCwgMjAwMCksXG4gICAgICAgICAgICBuZXcgQmFuZFBhc3MoMTYsIDM3MDApLCBuZXcgQmFuZFBhc3MoMjQsIDM5MDApLFxuICAgICAgICAgICAgbmV3IEJhbmRQYXNzKDMyLCA1NTAwKSwgbmV3IEJhbmRQYXNzKDQwLCA3MDAwKSxcbiAgICAgICAgICAgIG5ldyBCYW5kUGFzcyg0OCwgNzUwMCksIG5ldyBCYW5kUGFzcyg1NiwgMTAwMDApLFxuICAgICAgICAgICAgbmV3IEJhbmRQYXNzKDY0LCAxMTAwMCksIG5ldyBCYW5kUGFzcyg4MCwgMTM1MDApLFxuICAgICAgICAgICAgbmV3IEJhbmRQYXNzKDk2LCAxNTEwMCksIG5ldyBCYW5kUGFzcygxMTIsIDE1NjAwKSxcbiAgICAgICAgICAgIG5ldyBCYW5kUGFzcygxMjgsIDE3MDAwKSwgbmV3IEJhbmRQYXNzKDE2MCwgMTc1MDApLFxuICAgICAgICAgICAgbmV3IEJhbmRQYXNzKDE5MiwgMTg2MDApLCBuZXcgQmFuZFBhc3MoMjI0LCAxOTQwMCksXG4gICAgICAgICAgICBuZXcgQmFuZFBhc3MoMjU2LCAxOTcwMCksIG5ldyBCYW5kUGFzcygzMjAsIDIwNTAwKV07XG5cbiAgICAgICAgdmFyIHRhYmxlX2luZGV4ID0gc2VsZi5uZWFyZXN0Qml0cmF0ZUZ1bGxJbmRleChiaXRyYXRlKTtcbiAgICAgICAgbGgubG93ZXJsaW1pdCA9IGZyZXFfbWFwW3RhYmxlX2luZGV4XS5sb3dwYXNzO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxhbWVfaW5pdF9wYXJhbXNfcHBmbHQoZ2ZwKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIC8qIGNvbXB1dGUgaW5mbyBuZWVkZWQgZm9yIHBvbHlwaGFzZSBmaWx0ZXIgKGZpbHRlciB0eXBlPT0wLCBkZWZhdWx0KSAqL1xuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIHZhciBsb3dwYXNzX2JhbmQgPSAzMjtcbiAgICAgICAgdmFyIGhpZ2hwYXNzX2JhbmQgPSAtMTtcblxuICAgICAgICBpZiAoZ2ZjLmxvd3Bhc3MxID4gMCkge1xuICAgICAgICAgICAgdmFyIG1pbmJhbmQgPSA5OTk7XG4gICAgICAgICAgICBmb3IgKHZhciBiYW5kID0gMDsgYmFuZCA8PSAzMTsgYmFuZCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyZXEgPSAoYmFuZCAvIDMxLjApO1xuICAgICAgICAgICAgICAgIC8qIHRoaXMgYmFuZCBhbmQgYWJvdmUgd2lsbCBiZSB6ZXJvZWQ6ICovXG4gICAgICAgICAgICAgICAgaWYgKGZyZXEgPj0gZ2ZjLmxvd3Bhc3MyKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvd3Bhc3NfYmFuZCA9IE1hdGgubWluKGxvd3Bhc3NfYmFuZCwgYmFuZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnZmMubG93cGFzczEgPCBmcmVxICYmIGZyZXEgPCBnZmMubG93cGFzczIpIHtcbiAgICAgICAgICAgICAgICAgICAgbWluYmFuZCA9IE1hdGgubWluKG1pbmJhbmQsIGJhbmQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIGNvbXB1dGUgdGhlICphY3R1YWwqIHRyYW5zaXRpb24gYmFuZCBpbXBsZW1lbnRlZCBieSB0aGUgcG9seXBoYXNlXG4gICAgICAgICAgICAgKiBmaWx0ZXJcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKG1pbmJhbmQgPT0gOTk5KSB7XG4gICAgICAgICAgICAgICAgZ2ZjLmxvd3Bhc3MxID0gKGxvd3Bhc3NfYmFuZCAtIC43NSkgLyAzMS4wO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBnZmMubG93cGFzczEgPSAobWluYmFuZCAtIC43NSkgLyAzMS4wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLmxvd3Bhc3MyID0gbG93cGFzc19iYW5kIC8gMzEuMDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIG1ha2Ugc3VyZSBoaWdocGFzcyBmaWx0ZXIgaXMgd2l0aGluIDkwJSBvZiB3aGF0IHRoZSBlZmZlY3RpdmVcbiAgICAgICAgICogaGlnaHBhc3MgZnJlcXVlbmN5IHdpbGwgYmVcbiAgICAgICAgICovXG4gICAgICAgIGlmIChnZmMuaGlnaHBhc3MyID4gMCkge1xuICAgICAgICAgICAgaWYgKGdmYy5oaWdocGFzczIgPCAuOSAqICguNzUgLyAzMS4wKSkge1xuICAgICAgICAgICAgICAgIGdmYy5oaWdocGFzczEgPSAwO1xuICAgICAgICAgICAgICAgIGdmYy5oaWdocGFzczIgPSAwO1xuICAgICAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIldhcm5pbmc6IGhpZ2hwYXNzIGZpbHRlciBkaXNhYmxlZC4gIFwiXG4gICAgICAgICAgICAgICAgICAgICsgXCJoaWdocGFzcyBmcmVxdWVuY3kgdG9vIHNtYWxsXFxuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGdmYy5oaWdocGFzczIgPiAwKSB7XG4gICAgICAgICAgICB2YXIgbWF4YmFuZCA9IC0xO1xuICAgICAgICAgICAgZm9yICh2YXIgYmFuZCA9IDA7IGJhbmQgPD0gMzE7IGJhbmQrKykge1xuICAgICAgICAgICAgICAgIHZhciBmcmVxID0gYmFuZCAvIDMxLjA7XG4gICAgICAgICAgICAgICAgLyogdGhpcyBiYW5kIGFuZCBiZWxvdyB3aWxsIGJlIHplcmVvZCAqL1xuICAgICAgICAgICAgICAgIGlmIChmcmVxIDw9IGdmYy5oaWdocGFzczEpIHtcbiAgICAgICAgICAgICAgICAgICAgaGlnaHBhc3NfYmFuZCA9IE1hdGgubWF4KGhpZ2hwYXNzX2JhbmQsIGJhbmQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLmhpZ2hwYXNzMSA8IGZyZXEgJiYgZnJlcSA8IGdmYy5oaWdocGFzczIpIHtcbiAgICAgICAgICAgICAgICAgICAgbWF4YmFuZCA9IE1hdGgubWF4KG1heGJhbmQsIGJhbmQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBjb21wdXRlIHRoZSAqYWN0dWFsKiB0cmFuc2l0aW9uIGJhbmQgaW1wbGVtZW50ZWQgYnkgdGhlIHBvbHlwaGFzZVxuICAgICAgICAgICAgICogZmlsdGVyXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGdmYy5oaWdocGFzczEgPSBoaWdocGFzc19iYW5kIC8gMzEuMDtcbiAgICAgICAgICAgIGlmIChtYXhiYW5kID09IC0xKSB7XG4gICAgICAgICAgICAgICAgZ2ZjLmhpZ2hwYXNzMiA9IChoaWdocGFzc19iYW5kICsgLjc1KSAvIDMxLjA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGdmYy5oaWdocGFzczIgPSAobWF4YmFuZCArIC43NSkgLyAzMS4wO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgYmFuZCA9IDA7IGJhbmQgPCAzMjsgYmFuZCsrKSB7XG4gICAgICAgICAgICB2YXIgZmMxLCBmYzI7XG4gICAgICAgICAgICB2YXIgZnJlcSA9IGJhbmQgLyAzMS4wO1xuICAgICAgICAgICAgaWYgKGdmYy5oaWdocGFzczIgPiBnZmMuaGlnaHBhc3MxKSB7XG4gICAgICAgICAgICAgICAgZmMxID0gZmlsdGVyX2NvZWYoKGdmYy5oaWdocGFzczIgLSBmcmVxKVxuICAgICAgICAgICAgICAgICAgICAvIChnZmMuaGlnaHBhc3MyIC0gZ2ZjLmhpZ2hwYXNzMSArIDFlLTIwKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZjMSA9IDEuMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChnZmMubG93cGFzczIgPiBnZmMubG93cGFzczEpIHtcbiAgICAgICAgICAgICAgICBmYzIgPSBmaWx0ZXJfY29lZigoZnJlcSAtIGdmYy5sb3dwYXNzMSlcbiAgICAgICAgICAgICAgICAgICAgLyAoZ2ZjLmxvd3Bhc3MyIC0gZ2ZjLmxvd3Bhc3MxICsgMWUtMjApKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZmMyID0gMS4wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLmFtcF9maWx0ZXJbYmFuZF0gPSAoZmMxICogZmMyKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxhbWVfaW5pdF9xdmFsKGdmcCkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXG4gICAgICAgIHN3aXRjaCAoZ2ZwLnF1YWxpdHkpIHtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBjYXNlIDk6IC8qIG5vIHBzeW1vZGVsLCBubyBub2lzZSBzaGFwaW5nICovXG4gICAgICAgICAgICAgICAgZ2ZjLnBzeW1vZGVsID0gMDtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZyA9IDA7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfYW1wID0gMDtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19zdG9wID0gMDtcbiAgICAgICAgICAgICAgICBnZmMudXNlX2Jlc3RfaHVmZm1hbiA9IDA7XG4gICAgICAgICAgICAgICAgZ2ZjLmZ1bGxfb3V0ZXJfbG9vcCA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICBnZnAucXVhbGl0eSA9IDc7XG4gICAgICAgICAgICAvLyRGQUxMLVRIUk9VR0gkXG4gICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiB1c2UgcHN5bW9kZWwgKGZvciBzaG9ydCBibG9jayBhbmQgbS9zIHN3aXRjaGluZyksIGJ1dCBubyBub2lzZVxuICAgICAgICAgICAgICAgICAqIHNoYXBwaW5nXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZ2ZjLnBzeW1vZGVsID0gMTtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZyA9IDA7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfYW1wID0gMDtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19zdG9wID0gMDtcbiAgICAgICAgICAgICAgICBnZmMudXNlX2Jlc3RfaHVmZm1hbiA9IDA7XG4gICAgICAgICAgICAgICAgZ2ZjLmZ1bGxfb3V0ZXJfbG9vcCA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgNjpcbiAgICAgICAgICAgICAgICBnZmMucHN5bW9kZWwgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChnZmMubm9pc2Vfc2hhcGluZyA9PSAwKVxuICAgICAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZyA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfYW1wID0gMDtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19zdG9wID0gMDtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLnN1YmJsb2NrX2dhaW4gPT0gLTEpXG4gICAgICAgICAgICAgICAgICAgIGdmYy5zdWJibG9ja19nYWluID0gMTtcbiAgICAgICAgICAgICAgICBnZmMudXNlX2Jlc3RfaHVmZm1hbiA9IDA7XG4gICAgICAgICAgICAgICAgZ2ZjLmZ1bGxfb3V0ZXJfbG9vcCA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICBnZmMucHN5bW9kZWwgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChnZmMubm9pc2Vfc2hhcGluZyA9PSAwKVxuICAgICAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZyA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfYW1wID0gMDtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19zdG9wID0gMDtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLnN1YmJsb2NrX2dhaW4gPT0gLTEpXG4gICAgICAgICAgICAgICAgICAgIGdmYy5zdWJibG9ja19nYWluID0gMTtcbiAgICAgICAgICAgICAgICBnZmMudXNlX2Jlc3RfaHVmZm1hbiA9IDA7XG4gICAgICAgICAgICAgICAgZ2ZjLmZ1bGxfb3V0ZXJfbG9vcCA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICBnZmMucHN5bW9kZWwgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChnZmMubm9pc2Vfc2hhcGluZyA9PSAwKVxuICAgICAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZyA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfYW1wID0gMDtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19zdG9wID0gMDtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLnN1YmJsb2NrX2dhaW4gPT0gLTEpXG4gICAgICAgICAgICAgICAgICAgIGdmYy5zdWJibG9ja19nYWluID0gMTtcbiAgICAgICAgICAgICAgICBnZmMudXNlX2Jlc3RfaHVmZm1hbiA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLmZ1bGxfb3V0ZXJfbG9vcCA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMzpcbiAgICAgICAgICAgICAgICBnZmMucHN5bW9kZWwgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChnZmMubm9pc2Vfc2hhcGluZyA9PSAwKVxuICAgICAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZyA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfYW1wID0gMTtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19zdG9wID0gMTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLnN1YmJsb2NrX2dhaW4gPT0gLTEpXG4gICAgICAgICAgICAgICAgICAgIGdmYy5zdWJibG9ja19nYWluID0gMTtcbiAgICAgICAgICAgICAgICBnZmMudXNlX2Jlc3RfaHVmZm1hbiA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLmZ1bGxfb3V0ZXJfbG9vcCA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICBnZmMucHN5bW9kZWwgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChnZmMubm9pc2Vfc2hhcGluZyA9PSAwKVxuICAgICAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZyA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5zdWJzdGVwX3NoYXBpbmcgPT0gMClcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnN1YnN0ZXBfc2hhcGluZyA9IDI7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfYW1wID0gMTtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19zdG9wID0gMTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLnN1YmJsb2NrX2dhaW4gPT0gLTEpXG4gICAgICAgICAgICAgICAgICAgIGdmYy5zdWJibG9ja19nYWluID0gMTtcbiAgICAgICAgICAgICAgICBnZmMudXNlX2Jlc3RfaHVmZm1hbiA9IDE7XG4gICAgICAgICAgICAgICAgLyogaW5uZXIgbG9vcCAqL1xuICAgICAgICAgICAgICAgIGdmYy5mdWxsX291dGVyX2xvb3AgPSAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgZ2ZjLnBzeW1vZGVsID0gMTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLm5vaXNlX3NoYXBpbmcgPT0gMClcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmcgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuc3Vic3RlcF9zaGFwaW5nID09IDApXG4gICAgICAgICAgICAgICAgICAgIGdmYy5zdWJzdGVwX3NoYXBpbmcgPSAyO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX2FtcCA9IDI7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfc3RvcCA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5zdWJibG9ja19nYWluID09IC0xKVxuICAgICAgICAgICAgICAgICAgICBnZmMuc3ViYmxvY2tfZ2FpbiA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLnVzZV9iZXN0X2h1ZmZtYW4gPSAxO1xuICAgICAgICAgICAgICAgIGdmYy5mdWxsX291dGVyX2xvb3AgPSAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgZ2ZjLnBzeW1vZGVsID0gMTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLm5vaXNlX3NoYXBpbmcgPT0gMClcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmcgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuc3Vic3RlcF9zaGFwaW5nID09IDApXG4gICAgICAgICAgICAgICAgICAgIGdmYy5zdWJzdGVwX3NoYXBpbmcgPSAyO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX2FtcCA9IDI7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfc3RvcCA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5zdWJibG9ja19nYWluID09IC0xKVxuICAgICAgICAgICAgICAgICAgICBnZmMuc3ViYmxvY2tfZ2FpbiA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLnVzZV9iZXN0X2h1ZmZtYW4gPSAxO1xuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogdHlwZSAyIGRpc2FibGVkIGJlY2F1c2Ugb2YgaXQgc2xvd25lc3MsIGluIGZhdm9yIG9mIGZ1bGwgb3V0ZXJcbiAgICAgICAgICAgICAgICAgKiBsb29wIHNlYXJjaFxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGdmYy5mdWxsX291dGVyX2xvb3AgPSAwO1xuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogZnVsbCBvdXRlciBsb29wIHNlYXJjaCBkaXNhYmxlZCBiZWNhdXNlIG9mIGF1ZGlibGUgZGlzdG9ydGlvbnMgaXRcbiAgICAgICAgICAgICAgICAgKiBtYXkgZ2VuZXJhdGUgcmggMDYwNjI5XG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxhbWVfaW5pdF9iaXRzdHJlYW0oZ2ZwKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIGdmcC5mcmFtZU51bSA9IDA7XG5cbiAgICAgICAgaWYgKGdmcC53cml0ZV9pZDN0YWdfYXV0b21hdGljKSB7XG4gICAgICAgICAgICBpZDMuaWQzdGFnX3dyaXRlX3YyKGdmcCk7XG4gICAgICAgIH1cbiAgICAgICAgLyogaW5pdGlhbGl6ZSBoaXN0b2dyYW0gZGF0YSBvcHRpb25hbGx5IHVzZWQgYnkgZnJvbnRlbmQgKi9cblxuICAgICAgICBnZmMuYml0cmF0ZV9zdGVyZW9Nb2RlX0hpc3QgPSBuZXdfaW50X24oWzE2LCA0ICsgMV0pO1xuICAgICAgICBnZmMuYml0cmF0ZV9ibG9ja1R5cGVfSGlzdCA9IG5ld19pbnRfbihbMTYsIDQgKyAxICsgMV0pO1xuXG4gICAgICAgIGdmYy5QZWFrU2FtcGxlID0gMC4wO1xuXG4gICAgICAgIC8qIFdyaXRlIGluaXRpYWwgVkJSIEhlYWRlciB0byBiaXRzdHJlYW0gYW5kIGluaXQgVkJSIGRhdGEgKi9cbiAgICAgICAgaWYgKGdmcC5iV3JpdGVWYnJUYWcpXG4gICAgICAgICAgICB2YnIuSW5pdFZiclRhZyhnZnApO1xuICAgIH1cblxuICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAqIGluaXRpYWxpemUgaW50ZXJuYWwgcGFyYW1zIGJhc2VkIG9uIGRhdGEgaW4gZ2YgKGdsb2JhbGZsYWdzIHN0cnVjdCBmaWxsZWRcbiAgICAgKiBpbiBieSBjYWxsaW5nIHByb2dyYW0pXG4gICAgICpcbiAgICAgKiBPVVRMSU5FOlxuICAgICAqXG4gICAgICogV2UgZmlyc3QgaGF2ZSBzb21lIGNvbXBsZXggY29kZSB0byBkZXRlcm1pbmUgYml0cmF0ZSwgb3V0cHV0IHNhbXBsZXJhdGVcbiAgICAgKiBhbmQgbW9kZS4gSXQgaXMgY29tcGxpY2F0ZWQgYnkgdGhlIGZhY3QgdGhhdCB3ZSBhbGxvdyB0aGUgdXNlciB0byBzZXRcbiAgICAgKiBzb21lIG9yIGFsbCBvZiB0aGVzZSBwYXJhbWV0ZXJzLCBhbmQgbmVlZCB0byBkZXRlcm1pbmUgYmVzdCBwb3NzaWJsZVxuICAgICAqIHZhbHVlcyBmb3IgdGhlIHJlc3Qgb2YgdGhlbTpcbiAgICAgKlxuICAgICAqIDEuIHNldCBzb21lIENQVSByZWxhdGVkIGZsYWdzIDIuIGNoZWNrIGlmIHdlIGFyZSBtb25vLm1vbm8sIHN0ZXJlby5tb25vXG4gICAgICogb3Igc3RlcmVvLnN0ZXJlbyAzLiBjb21wdXRlIGJpdHJhdGUgYW5kIG91dHB1dCBzYW1wbGVyYXRlOiB1c2VyIG1heSBoYXZlXG4gICAgICogc2V0IGNvbXByZXNzaW9uIHJhdGlvIHVzZXIgbWF5IGhhdmUgc2V0IGEgYml0cmF0ZSB1c2VyIG1heSBoYXZlIHNldCBhXG4gICAgICogb3V0cHV0IHNhbXBsZXJhdGUgNC4gc2V0IHNvbWUgb3B0aW9ucyB3aGljaCBkZXBlbmQgb24gb3V0cHV0IHNhbXBsZXJhdGVcbiAgICAgKiA1LiBjb21wdXRlIHRoZSBhY3R1YWwgY29tcHJlc3Npb24gcmF0aW8gNi4gc2V0IG1vZGUgYmFzZWQgb24gY29tcHJlc3Npb25cbiAgICAgKiByYXRpb1xuICAgICAqXG4gICAgICogVGhlIHJlbWFpbmluZyBjb2RlIGlzIG11Y2ggc2ltcGxlciAtIGl0IGp1c3Qgc2V0cyBvcHRpb25zIGJhc2VkIG9uIHRoZVxuICAgICAqIG1vZGUgJiBjb21wcmVzc2lvbiByYXRpbzpcbiAgICAgKlxuICAgICAqIHNldCBhbGxvd19kaWZmX3Nob3J0IGJhc2VkIG9uIG1vZGUgc2VsZWN0IGxvd3Bhc3MgZmlsdGVyIGJhc2VkIG9uXG4gICAgICogY29tcHJlc3Npb24gcmF0aW8gJiBtb2RlIHNldCB0aGUgYml0cmF0ZSBpbmRleCwgYW5kIG1pbi9tYXggYml0cmF0ZXMgZm9yXG4gICAgICogVkJSIG1vZGVzIGRpc2FibGUgVkJSIHRhZyBpZiBpdCBpcyBub3QgYXBwcm9wcmlhdGUgaW5pdGlhbGl6ZSB0aGVcbiAgICAgKiBiaXRzdHJlYW0gaW5pdGlhbGl6ZSBzY2FsZWZhY19iYW5kIGRhdGEgc2V0IHNpZGVpbmZvX2xlbiAoYmFzZWQgb25cbiAgICAgKiBjaGFubmVscywgQ1JDLCBvdXRfc2FtcGxlcmF0ZSkgd3JpdGUgYW4gaWQzdjIgdGFnIGludG8gdGhlIGJpdHN0cmVhbVxuICAgICAqIHdyaXRlIFZCUiB0YWcgaW50byB0aGUgYml0c3RyZWFtIHNldCBtcGVnMS8yIGZsYWcgZXN0aW1hdGUgdGhlIG51bWJlciBvZlxuICAgICAqIGZyYW1lcyAoYmFzZWQgb24gYSBsb3Qgb2YgZGF0YSlcbiAgICAgKlxuICAgICAqIG5vdyB3ZSBzZXQgbW9yZSBmbGFnczogbnNwc3l0dW5lOiBzZWUgY29kZSBWQlIgbW9kZXMgc2VlIGNvZGUgQ0JSL0FCUiBzZWVcbiAgICAgKiBjb2RlXG4gICAgICpcbiAgICAgKiBGaW5hbGx5LCB3ZSBzZXQgdGhlIGFsZ29yaXRobSBmbGFncyBiYXNlZCBvbiB0aGUgZ2ZwLnF1YWxpdHkgdmFsdWVcbiAgICAgKiBsYW1lX2luaXRfcXZhbChnZnApO1xuICAgICAqXG4gICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgIHRoaXMubGFtZV9pbml0X3BhcmFtcyA9IGZ1bmN0aW9uIChnZnApIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblxuICAgICAgICBnZmMuQ2xhc3NfSUQgPSAwO1xuICAgICAgICBpZiAoZ2ZjLkFUSCA9PSBudWxsKVxuICAgICAgICAgICAgZ2ZjLkFUSCA9IG5ldyBBVEgoKTtcbiAgICAgICAgaWYgKGdmYy5QU1kgPT0gbnVsbClcbiAgICAgICAgICAgIGdmYy5QU1kgPSBuZXcgUFNZKCk7XG4gICAgICAgIGlmIChnZmMucmdkYXRhID09IG51bGwpXG4gICAgICAgICAgICBnZmMucmdkYXRhID0gbmV3IFJlcGxheUdhaW4oKTtcblxuICAgICAgICBnZmMuY2hhbm5lbHNfaW4gPSBnZnAubnVtX2NoYW5uZWxzO1xuICAgICAgICBpZiAoZ2ZjLmNoYW5uZWxzX2luID09IDEpXG4gICAgICAgICAgICBnZnAubW9kZSA9IE1QRUdNb2RlLk1PTk87XG4gICAgICAgIGdmYy5jaGFubmVsc19vdXQgPSAoZ2ZwLm1vZGUgPT0gTVBFR01vZGUuTU9OTykgPyAxIDogMjtcbiAgICAgICAgZ2ZjLm1vZGVfZXh0ID0gRW5jb2Rlci5NUEdfTURfTVNfTFI7XG4gICAgICAgIGlmIChnZnAubW9kZSA9PSBNUEVHTW9kZS5NT05PKVxuICAgICAgICAgICAgZ2ZwLmZvcmNlX21zID0gZmFsc2U7XG4gICAgICAgIC8qXG4gICAgICAgICAqIGRvbid0IGFsbG93IGZvcmNlZCBtaWQvc2lkZSBzdGVyZW8gZm9yIG1vbm8gb3V0cHV0XG4gICAgICAgICAqL1xuXG4gICAgICAgIGlmIChnZnAuVkJSID09IFZick1vZGUudmJyX29mZiAmJiBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzICE9IDEyOFxuICAgICAgICAgICAgJiYgZ2ZwLmJyYXRlID09IDApXG4gICAgICAgICAgICBnZnAuYnJhdGUgPSBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzO1xuXG4gICAgICAgIGlmIChnZnAuVkJSID09IFZick1vZGUudmJyX29mZiB8fCBnZnAuVkJSID09IFZick1vZGUudmJyX210cmhcbiAgICAgICAgICAgIHx8IGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfbXQpIHtcbiAgICAgICAgICAgIC8qIHRoZXNlIG1vZGVzIGNhbiBoYW5kbGUgZnJlZSBmb3JtYXQgY29uZGl0aW9uICovXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBnZnAuZnJlZV9mb3JtYXQgPSBmYWxzZTtcbiAgICAgICAgICAgIC8qIG1vZGUgY2FuJ3QgYmUgbWl4ZWQgd2l0aCBmcmVlIGZvcm1hdCAqL1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfb2ZmICYmIGdmcC5icmF0ZSA9PSAwKSB7XG4gICAgICAgICAgICAvKiBubyBiaXRyYXRlIG9yIGNvbXByZXNzaW9uIHJhdGlvIHNwZWNpZmllZCwgdXNlIDExLjAyNSAqL1xuICAgICAgICAgICAgaWYgKEJpdFN0cmVhbS5FUShnZnAuY29tcHJlc3Npb25fcmF0aW8sIDApKVxuICAgICAgICAgICAgICAgIGdmcC5jb21wcmVzc2lvbl9yYXRpbyA9IDExLjAyNTtcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiByYXRlIHRvIGNvbXByZXNzIGEgQ0QgZG93biB0byBleGFjdGx5IDEyODAwMCBicHNcbiAgICAgICAgICAgICAqL1xuICAgICAgICB9XG5cbiAgICAgICAgLyogZmluZCBiaXRyYXRlIGlmIHVzZXIgc3BlY2lmeSBhIGNvbXByZXNzaW9uIHJhdGlvICovXG4gICAgICAgIGlmIChnZnAuVkJSID09IFZick1vZGUudmJyX29mZiAmJiBnZnAuY29tcHJlc3Npb25fcmF0aW8gPiAwKSB7XG5cbiAgICAgICAgICAgIGlmIChnZnAub3V0X3NhbXBsZXJhdGUgPT0gMClcbiAgICAgICAgICAgICAgICBnZnAub3V0X3NhbXBsZXJhdGUgPSBtYXAyTVAzRnJlcXVlbmN5KChpbnQpKDAuOTcgKiBnZnAuaW5fc2FtcGxlcmF0ZSkpO1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIHJvdW5kIHVwIHdpdGggYSBtYXJnaW4gb2YgMyAlXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIGNob29zZSBhIGJpdHJhdGUgZm9yIHRoZSBvdXRwdXQgc2FtcGxlcmF0ZSB3aGljaCBhY2hpZXZlc1xuICAgICAgICAgICAgICogc3BlY2lmaWVkIGNvbXByZXNzaW9uIHJhdGlvXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGdmcC5icmF0ZSA9IDAgfCAoZ2ZwLm91dF9zYW1wbGVyYXRlICogMTYgKiBnZmMuY2hhbm5lbHNfb3V0IC8gKDEuZTMgKiBnZnAuY29tcHJlc3Npb25fcmF0aW8pKTtcblxuICAgICAgICAgICAgLyogd2UgbmVlZCB0aGUgdmVyc2lvbiBmb3IgdGhlIGJpdHJhdGUgdGFibGUgbG9vayB1cCAqL1xuICAgICAgICAgICAgZ2ZjLnNhbXBsZXJhdGVfaW5kZXggPSBTbXBGcnFJbmRleChnZnAub3V0X3NhbXBsZXJhdGUsIGdmcCk7XG5cbiAgICAgICAgICAgIGlmICghZ2ZwLmZyZWVfZm9ybWF0KSAvKlxuICAgICAgICAgICAgICogZm9yIG5vbiBGcmVlIEZvcm1hdCBmaW5kIHRoZSBuZWFyZXN0IGFsbG93ZWRcbiAgICAgICAgICAgICAqIGJpdHJhdGVcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGdmcC5icmF0ZSA9IEZpbmROZWFyZXN0Qml0cmF0ZShnZnAuYnJhdGUsIGdmcC52ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICBnZnAub3V0X3NhbXBsZXJhdGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGdmcC5vdXRfc2FtcGxlcmF0ZSAhPSAwKSB7XG4gICAgICAgICAgICBpZiAoZ2ZwLm91dF9zYW1wbGVyYXRlIDwgMTYwMDApIHtcbiAgICAgICAgICAgICAgICBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzID0gTWF0aC5tYXgoZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyxcbiAgICAgICAgICAgICAgICAgICAgOCk7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyA9IE1hdGgubWluKGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMsXG4gICAgICAgICAgICAgICAgICAgIDY0KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZ2ZwLm91dF9zYW1wbGVyYXRlIDwgMzIwMDApIHtcbiAgICAgICAgICAgICAgICBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzID0gTWF0aC5tYXgoZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyxcbiAgICAgICAgICAgICAgICAgICAgOCk7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyA9IE1hdGgubWluKGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMsXG4gICAgICAgICAgICAgICAgICAgIDE2MCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMgPSBNYXRoLm1heChnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzLFxuICAgICAgICAgICAgICAgICAgICAzMik7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyA9IE1hdGgubWluKGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMsXG4gICAgICAgICAgICAgICAgICAgIDMyMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgLyogaWYgYSBmaWx0ZXIgaGFzIG5vdCBiZWVuIGVuYWJsZWQsIHNlZSBpZiB3ZSBzaG91bGQgYWRkIG9uZTogKi9cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIGlmIChnZnAubG93cGFzc2ZyZXEgPT0gMCkge1xuICAgICAgICAgICAgdmFyIGxvd3Bhc3MgPSAxNjAwMC47XG5cbiAgICAgICAgICAgIHN3aXRjaCAoZ2ZwLlZCUikge1xuICAgICAgICAgICAgICAgIGNhc2UgVmJyTW9kZS52YnJfb2ZmOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxoID0gbmV3IExvd1Bhc3NIaWdoUGFzcygpO1xuICAgICAgICAgICAgICAgICAgICBvcHRpbXVtX2JhbmR3aWR0aChsaCwgZ2ZwLmJyYXRlKTtcbiAgICAgICAgICAgICAgICAgICAgbG93cGFzcyA9IGxoLmxvd2VybGltaXQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIFZick1vZGUudmJyX2FicjpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsaCA9IG5ldyBMb3dQYXNzSGlnaFBhc3MoKTtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW11bV9iYW5kd2lkdGgobGgsIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMpO1xuICAgICAgICAgICAgICAgICAgICBsb3dwYXNzID0gbGgubG93ZXJsaW1pdDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhc2UgVmJyTW9kZS52YnJfcmg6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IFsxOTUwMCwgMTkwMDAsIDE4NjAwLCAxODAwMCwgMTc1MDAsIDE2MDAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgMTU2MDAsIDE0OTAwLCAxMjUwMCwgMTAwMDAsIDM5NTBdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoMCA8PSBnZnAuVkJSX3EgJiYgZ2ZwLlZCUl9xIDw9IDkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0geFtnZnAuVkJSX3FdLCBiID0geFtnZnAuVkJSX3EgKyAxXSwgbSA9IGdmcC5WQlJfcV9mcmFjO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG93cGFzcyA9IGxpbmVhcl9pbnQoYSwgYiwgbSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dwYXNzID0gMTk1MDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IFsxOTUwMCwgMTkwMDAsIDE4NTAwLCAxODAwMCwgMTc1MDAsIDE2NTAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgMTU1MDAsIDE0NTAwLCAxMjUwMCwgOTUwMCwgMzk1MF07XG4gICAgICAgICAgICAgICAgICAgIGlmICgwIDw9IGdmcC5WQlJfcSAmJiBnZnAuVkJSX3EgPD0gOSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSB4W2dmcC5WQlJfcV0sIGIgPSB4W2dmcC5WQlJfcSArIDFdLCBtID0gZ2ZwLlZCUl9xX2ZyYWM7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dwYXNzID0gbGluZWFyX2ludChhLCBiLCBtKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd3Bhc3MgPSAxOTUwMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChnZnAubW9kZSA9PSBNUEVHTW9kZS5NT05PXG4gICAgICAgICAgICAgICAgJiYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfb2ZmIHx8IGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfYWJyKSlcbiAgICAgICAgICAgICAgICBsb3dwYXNzICo9IDEuNTtcblxuICAgICAgICAgICAgZ2ZwLmxvd3Bhc3NmcmVxID0gbG93cGFzcyB8IDA7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ2ZwLm91dF9zYW1wbGVyYXRlID09IDApIHtcbiAgICAgICAgICAgIGlmICgyICogZ2ZwLmxvd3Bhc3NmcmVxID4gZ2ZwLmluX3NhbXBsZXJhdGUpIHtcbiAgICAgICAgICAgICAgICBnZnAubG93cGFzc2ZyZXEgPSBnZnAuaW5fc2FtcGxlcmF0ZSAvIDI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZnAub3V0X3NhbXBsZXJhdGUgPSBvcHRpbXVtX3NhbXBsZWZyZXEoZ2ZwLmxvd3Bhc3NmcmVxIHwgMCxcbiAgICAgICAgICAgICAgICBnZnAuaW5fc2FtcGxlcmF0ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBnZnAubG93cGFzc2ZyZXEgPSBNYXRoLm1pbigyMDUwMCwgZ2ZwLmxvd3Bhc3NmcmVxKTtcbiAgICAgICAgZ2ZwLmxvd3Bhc3NmcmVxID0gTWF0aC5taW4oZ2ZwLm91dF9zYW1wbGVyYXRlIC8gMiwgZ2ZwLmxvd3Bhc3NmcmVxKTtcblxuICAgICAgICBpZiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9vZmYpIHtcbiAgICAgICAgICAgIGdmcC5jb21wcmVzc2lvbl9yYXRpbyA9IGdmcC5vdXRfc2FtcGxlcmF0ZSAqIDE2ICogZ2ZjLmNoYW5uZWxzX291dFxuICAgICAgICAgICAgICAgIC8gKDEuZTMgKiBnZnAuYnJhdGUpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChnZnAuVkJSID09IFZick1vZGUudmJyX2Ficikge1xuICAgICAgICAgICAgZ2ZwLmNvbXByZXNzaW9uX3JhdGlvID0gZ2ZwLm91dF9zYW1wbGVyYXRlICogMTYgKiBnZmMuY2hhbm5lbHNfb3V0XG4gICAgICAgICAgICAgICAgLyAoMS5lMyAqIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMpO1xuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgICogZG8gbm90IGNvbXB1dGUgUmVwbGF5R2FpbiB2YWx1ZXMgYW5kIGRvIG5vdCBmaW5kIHRoZSBwZWFrIHNhbXBsZSBpZlxuICAgICAgICAgKiB3ZSBjYW4ndCBzdG9yZSB0aGVtXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoIWdmcC5iV3JpdGVWYnJUYWcpIHtcbiAgICAgICAgICAgIGdmcC5maW5kUmVwbGF5R2FpbiA9IGZhbHNlO1xuICAgICAgICAgICAgZ2ZwLmRlY29kZV9vbl90aGVfZmx5ID0gZmFsc2U7XG4gICAgICAgICAgICBnZmMuZmluZFBlYWtTYW1wbGUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBnZmMuZmluZFJlcGxheUdhaW4gPSBnZnAuZmluZFJlcGxheUdhaW47XG4gICAgICAgIGdmYy5kZWNvZGVfb25fdGhlX2ZseSA9IGdmcC5kZWNvZGVfb25fdGhlX2ZseTtcblxuICAgICAgICBpZiAoZ2ZjLmRlY29kZV9vbl90aGVfZmx5KVxuICAgICAgICAgICAgZ2ZjLmZpbmRQZWFrU2FtcGxlID0gdHJ1ZTtcblxuICAgICAgICBpZiAoZ2ZjLmZpbmRSZXBsYXlHYWluKSB7XG4gICAgICAgICAgICBpZiAoZ2EuSW5pdEdhaW5BbmFseXNpcyhnZmMucmdkYXRhLCBnZnAub3V0X3NhbXBsZXJhdGUpID09IEdhaW5BbmFseXNpcy5JTklUX0dBSU5fQU5BTFlTSVNfRVJST1IpIHtcbiAgICAgICAgICAgICAgICBnZnAuaW50ZXJuYWxfZmxhZ3MgPSBudWxsO1xuICAgICAgICAgICAgICAgIHJldHVybiAtNjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChnZmMuZGVjb2RlX29uX3RoZV9mbHkgJiYgIWdmcC5kZWNvZGVfb25seSkge1xuICAgICAgICAgICAgaWYgKGdmYy5oaXAgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIG1wZ2xpYi5oaXBfZGVjb2RlX2V4aXQoZ2ZjLmhpcCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMuaGlwID0gbXBnbGliLmhpcF9kZWNvZGVfaW5pdCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgZ2ZjLm1vZGVfZ3IgPSBnZnAub3V0X3NhbXBsZXJhdGUgPD0gMjQwMDAgPyAxIDogMjtcbiAgICAgICAgLypcbiAgICAgICAgICogTnVtYmVyIG9mIGdyYW51bGVzIHBlciBmcmFtZVxuICAgICAgICAgKi9cbiAgICAgICAgZ2ZwLmZyYW1lc2l6ZSA9IDU3NiAqIGdmYy5tb2RlX2dyO1xuICAgICAgICBnZnAuZW5jb2Rlcl9kZWxheSA9IEVuY29kZXIuRU5DREVMQVk7XG5cbiAgICAgICAgZ2ZjLnJlc2FtcGxlX3JhdGlvID0gZ2ZwLmluX3NhbXBsZXJhdGUgLyBnZnAub3V0X3NhbXBsZXJhdGU7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIDxQUkU+XG4gICAgICAgICAqICBzYW1wbGUgZnJlcSAgICAgICBiaXRyYXRlICAgICBjb21wcmVzc2lvbiByYXRpb1xuICAgICAgICAgKiAgICAgW2tIel0gICAgICBba2Jwcy9jaGFubmVsXSAgIGZvciAxNiBiaXQgaW5wdXRcbiAgICAgICAgICogICAgIDQ0LjEgICAgICAgICAgICA1NiAgICAgICAgICAgICAgIDEyLjZcbiAgICAgICAgICogICAgIDQ0LjEgICAgICAgICAgICA2NCAgICAgICAgICAgICAgIDExLjAyNVxuICAgICAgICAgKiAgICAgNDQuMSAgICAgICAgICAgIDgwICAgICAgICAgICAgICAgIDguODJcbiAgICAgICAgICogICAgIDIyLjA1ICAgICAgICAgICAyNCAgICAgICAgICAgICAgIDE0LjdcbiAgICAgICAgICogICAgIDIyLjA1ICAgICAgICAgICAzMiAgICAgICAgICAgICAgIDExLjAyNVxuICAgICAgICAgKiAgICAgMjIuMDUgICAgICAgICAgIDQwICAgICAgICAgICAgICAgIDguODJcbiAgICAgICAgICogICAgIDE2ICAgICAgICAgICAgICAxNiAgICAgICAgICAgICAgIDE2LjBcbiAgICAgICAgICogICAgIDE2ICAgICAgICAgICAgICAyNCAgICAgICAgICAgICAgIDEwLjY2N1xuICAgICAgICAgKiA8L1BSRT5cbiAgICAgICAgICovXG4gICAgICAgIC8qKlxuICAgICAgICAgKiA8UFJFPlxuICAgICAgICAgKiAgRm9yIFZCUiwgdGFrZSBhIGd1ZXNzIGF0IHRoZSBjb21wcmVzc2lvbl9yYXRpby5cbiAgICAgICAgICogIEZvciBleGFtcGxlOlxuICAgICAgICAgKlxuICAgICAgICAgKiAgICBWQlJfcSAgICBjb21wcmVzc2lvbiAgICAgbGlrZVxuICAgICAgICAgKiAgICAgLSAgICAgICAgNC40ICAgICAgICAgMzIwIGticHMvNDQga0h6XG4gICAgICAgICAqICAgMC4uLjEgICAgICA1LjUgICAgICAgICAyNTYga2Jwcy80NCBrSHpcbiAgICAgICAgICogICAgIDIgICAgICAgIDcuMyAgICAgICAgIDE5MiBrYnBzLzQ0IGtIelxuICAgICAgICAgKiAgICAgNCAgICAgICAgOC44ICAgICAgICAgMTYwIGticHMvNDQga0h6XG4gICAgICAgICAqICAgICA2ICAgICAgIDExICAgICAgICAgICAxMjgga2Jwcy80NCBrSHpcbiAgICAgICAgICogICAgIDkgICAgICAgMTQuNyAgICAgICAgICA5NiBrYnBzXG4gICAgICAgICAqXG4gICAgICAgICAqICBmb3IgbG93ZXIgYml0cmF0ZXMsIGRvd25zYW1wbGUgd2l0aCAtLXJlc2FtcGxlXG4gICAgICAgICAqIDwvUFJFPlxuICAgICAgICAgKi9cbiAgICAgICAgc3dpdGNoIChnZnAuVkJSKSB7XG4gICAgICAgICAgICBjYXNlIFZick1vZGUudmJyX210OlxuICAgICAgICAgICAgY2FzZSBWYnJNb2RlLnZicl9yaDpcbiAgICAgICAgICAgIGNhc2UgVmJyTW9kZS52YnJfbXRyaDpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvKiBudW1iZXJzIGFyZSBhIGJpdCBzdHJhbmdlLCBidXQgdGhleSBkZXRlcm1pbmUgdGhlIGxvd3Bhc3MgdmFsdWUgKi9cbiAgICAgICAgICAgICAgICB2YXIgY21wID0gWzUuNywgNi41LCA3LjMsIDguMiwgMTAsIDExLjksIDEzLCAxNCxcbiAgICAgICAgICAgICAgICAgICAgMTUsIDE2LjVdO1xuICAgICAgICAgICAgICAgIGdmcC5jb21wcmVzc2lvbl9yYXRpbyA9IGNtcFtnZnAuVkJSX3FdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBWYnJNb2RlLnZicl9hYnI6XG4gICAgICAgICAgICAgICAgZ2ZwLmNvbXByZXNzaW9uX3JhdGlvID0gZ2ZwLm91dF9zYW1wbGVyYXRlICogMTYgKiBnZmMuY2hhbm5lbHNfb3V0XG4gICAgICAgICAgICAgICAgICAgIC8gKDEuZTMgKiBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgZ2ZwLmNvbXByZXNzaW9uX3JhdGlvID0gZ2ZwLm91dF9zYW1wbGVyYXRlICogMTYgKiBnZmMuY2hhbm5lbHNfb3V0XG4gICAgICAgICAgICAgICAgICAgIC8gKDEuZTMgKiBnZnAuYnJhdGUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgICogbW9kZSA9IC0xIChub3Qgc2V0IGJ5IHVzZXIpIG9yIG1vZGUgPSBNT05PIChiZWNhdXNlIG9mIG9ubHkgMSBpbnB1dFxuICAgICAgICAgKiBjaGFubmVsKS4gSWYgbW9kZSBoYXMgbm90IGJlZW4gc2V0LCB0aGVuIHNlbGVjdCBKLVNURVJFT1xuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGdmcC5tb2RlID09IE1QRUdNb2RlLk5PVF9TRVQpIHtcbiAgICAgICAgICAgIGdmcC5tb2RlID0gTVBFR01vZGUuSk9JTlRfU1RFUkVPO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogYXBwbHkgdXNlciBkcml2ZW4gaGlnaCBwYXNzIGZpbHRlciAqL1xuICAgICAgICBpZiAoZ2ZwLmhpZ2hwYXNzZnJlcSA+IDApIHtcbiAgICAgICAgICAgIGdmYy5oaWdocGFzczEgPSAyLiAqIGdmcC5oaWdocGFzc2ZyZXE7XG5cbiAgICAgICAgICAgIGlmIChnZnAuaGlnaHBhc3N3aWR0aCA+PSAwKVxuICAgICAgICAgICAgICAgIGdmYy5oaWdocGFzczIgPSAyLiAqIChnZnAuaGlnaHBhc3NmcmVxICsgZ2ZwLmhpZ2hwYXNzd2lkdGgpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgLyogMCUgYWJvdmUgb24gZGVmYXVsdCAqL1xuICAgICAgICAgICAgICAgIGdmYy5oaWdocGFzczIgPSAoMSArIDAuMDApICogMi4gKiBnZnAuaGlnaHBhc3NmcmVxO1xuXG4gICAgICAgICAgICBnZmMuaGlnaHBhc3MxIC89IGdmcC5vdXRfc2FtcGxlcmF0ZTtcbiAgICAgICAgICAgIGdmYy5oaWdocGFzczIgLz0gZ2ZwLm91dF9zYW1wbGVyYXRlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ2ZjLmhpZ2hwYXNzMSA9IDA7XG4gICAgICAgICAgICBnZmMuaGlnaHBhc3MyID0gMDtcbiAgICAgICAgfVxuICAgICAgICAvKiBhcHBseSB1c2VyIGRyaXZlbiBsb3cgcGFzcyBmaWx0ZXIgKi9cbiAgICAgICAgaWYgKGdmcC5sb3dwYXNzZnJlcSA+IDApIHtcbiAgICAgICAgICAgIGdmYy5sb3dwYXNzMiA9IDIuICogZ2ZwLmxvd3Bhc3NmcmVxO1xuICAgICAgICAgICAgaWYgKGdmcC5sb3dwYXNzd2lkdGggPj0gMCkge1xuICAgICAgICAgICAgICAgIGdmYy5sb3dwYXNzMSA9IDIuICogKGdmcC5sb3dwYXNzZnJlcSAtIGdmcC5sb3dwYXNzd2lkdGgpO1xuICAgICAgICAgICAgICAgIGlmIChnZmMubG93cGFzczEgPCAwKSAvKiBoYXMgdG8gYmUgPj0gMCAqL1xuICAgICAgICAgICAgICAgICAgICBnZmMubG93cGFzczEgPSAwO1xuICAgICAgICAgICAgfSBlbHNlIHsgLyogMCUgYmVsb3cgb24gZGVmYXVsdCAqL1xuICAgICAgICAgICAgICAgIGdmYy5sb3dwYXNzMSA9ICgxIC0gMC4wMCkgKiAyLiAqIGdmcC5sb3dwYXNzZnJlcTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy5sb3dwYXNzMSAvPSBnZnAub3V0X3NhbXBsZXJhdGU7XG4gICAgICAgICAgICBnZmMubG93cGFzczIgLz0gZ2ZwLm91dF9zYW1wbGVyYXRlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ2ZjLmxvd3Bhc3MxID0gMDtcbiAgICAgICAgICAgIGdmYy5sb3dwYXNzMiA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgLyogY29tcHV0ZSBpbmZvIG5lZWRlZCBmb3IgcG9seXBoYXNlIGZpbHRlciAoZmlsdGVyIHR5cGU9PTAsIGRlZmF1bHQpICovXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICBsYW1lX2luaXRfcGFyYW1zX3BwZmx0KGdmcCk7XG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIHNhbXBsZXJhdGUgYW5kIGJpdHJhdGUgaW5kZXhcbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIGdmYy5zYW1wbGVyYXRlX2luZGV4ID0gU21wRnJxSW5kZXgoZ2ZwLm91dF9zYW1wbGVyYXRlLCBnZnApO1xuICAgICAgICBpZiAoZ2ZjLnNhbXBsZXJhdGVfaW5kZXggPCAwKSB7XG4gICAgICAgICAgICBnZnAuaW50ZXJuYWxfZmxhZ3MgPSBudWxsO1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfb2ZmKSB7XG4gICAgICAgICAgICBpZiAoZ2ZwLmZyZWVfZm9ybWF0KSB7XG4gICAgICAgICAgICAgICAgZ2ZjLmJpdHJhdGVfaW5kZXggPSAwO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBnZnAuYnJhdGUgPSBGaW5kTmVhcmVzdEJpdHJhdGUoZ2ZwLmJyYXRlLCBnZnAudmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLm91dF9zYW1wbGVyYXRlKTtcbiAgICAgICAgICAgICAgICBnZmMuYml0cmF0ZV9pbmRleCA9IEJpdHJhdGVJbmRleChnZnAuYnJhdGUsIGdmcC52ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICBnZnAub3V0X3NhbXBsZXJhdGUpO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuYml0cmF0ZV9pbmRleCA8PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGdmcC5pbnRlcm5hbF9mbGFncyA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBnZmMuYml0cmF0ZV9pbmRleCA9IDE7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBmb3IgQ0JSLCB3ZSB3aWxsIHdyaXRlIGFuIFwiaW5mb1wiIHRhZy4gKi9cblxuICAgICAgICBpZiAoZ2ZwLmFuYWx5c2lzKVxuICAgICAgICAgICAgZ2ZwLmJXcml0ZVZiclRhZyA9IGZhbHNlO1xuXG4gICAgICAgIC8qIHNvbWUgZmlsZSBvcHRpb25zIG5vdCBhbGxvd2VkIGlmIG91dHB1dCBpczogbm90IHNwZWNpZmllZCBvciBzdGRvdXQgKi9cbiAgICAgICAgaWYgKGdmYy5waW5mbyAhPSBudWxsKVxuICAgICAgICAgICAgZ2ZwLmJXcml0ZVZiclRhZyA9IGZhbHNlO1xuICAgICAgICAvKiBkaXNhYmxlIFhpbmcgVkJSIHRhZyAqL1xuXG4gICAgICAgIGJzLmluaXRfYml0X3N0cmVhbV93KGdmYyk7XG5cbiAgICAgICAgdmFyIGogPSBnZmMuc2FtcGxlcmF0ZV9pbmRleCArICgzICogZ2ZwLnZlcnNpb24pICsgNlxuICAgICAgICAgICAgKiAoZ2ZwLm91dF9zYW1wbGVyYXRlIDwgMTYwMDAgPyAxIDogMCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgRW5jb2Rlci5TQk1BWF9sICsgMTsgaSsrKVxuICAgICAgICAgICAgZ2ZjLnNjYWxlZmFjX2JhbmQubFtpXSA9IHF1cHZ0LnNmQmFuZEluZGV4W2pdLmxbaV07XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBFbmNvZGVyLlBTRkIyMSArIDE7IGkrKykge1xuICAgICAgICAgICAgdmFyIHNpemUgPSAoZ2ZjLnNjYWxlZmFjX2JhbmQubFsyMl0gLSBnZmMuc2NhbGVmYWNfYmFuZC5sWzIxXSlcbiAgICAgICAgICAgICAgICAvIEVuY29kZXIuUFNGQjIxO1xuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFsyMV0gKyBpICogc2l6ZTtcbiAgICAgICAgICAgIGdmYy5zY2FsZWZhY19iYW5kLnBzZmIyMVtpXSA9IHN0YXJ0O1xuICAgICAgICB9XG4gICAgICAgIGdmYy5zY2FsZWZhY19iYW5kLnBzZmIyMVtFbmNvZGVyLlBTRkIyMV0gPSA1NzY7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBFbmNvZGVyLlNCTUFYX3MgKyAxOyBpKyspXG4gICAgICAgICAgICBnZmMuc2NhbGVmYWNfYmFuZC5zW2ldID0gcXVwdnQuc2ZCYW5kSW5kZXhbal0uc1tpXTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEVuY29kZXIuUFNGQjEyICsgMTsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgc2l6ZSA9IChnZmMuc2NhbGVmYWNfYmFuZC5zWzEzXSAtIGdmYy5zY2FsZWZhY19iYW5kLnNbMTJdKVxuICAgICAgICAgICAgICAgIC8gRW5jb2Rlci5QU0ZCMTI7XG4gICAgICAgICAgICB2YXIgc3RhcnQgPSBnZmMuc2NhbGVmYWNfYmFuZC5zWzEyXSArIGkgKiBzaXplO1xuICAgICAgICAgICAgZ2ZjLnNjYWxlZmFjX2JhbmQucHNmYjEyW2ldID0gc3RhcnQ7XG4gICAgICAgIH1cbiAgICAgICAgZ2ZjLnNjYWxlZmFjX2JhbmQucHNmYjEyW0VuY29kZXIuUFNGQjEyXSA9IDE5MjtcbiAgICAgICAgLyogZGV0ZXJtaW5lIHRoZSBtZWFuIGJpdHJhdGUgZm9yIG1haW4gZGF0YSAqL1xuICAgICAgICBpZiAoZ2ZwLnZlcnNpb24gPT0gMSkgLyogTVBFRyAxICovXG4gICAgICAgICAgICBnZmMuc2lkZWluZm9fbGVuID0gKGdmYy5jaGFubmVsc19vdXQgPT0gMSkgPyA0ICsgMTcgOiA0ICsgMzI7XG4gICAgICAgIGVsc2VcbiAgICAgICAgLyogTVBFRyAyICovXG4gICAgICAgICAgICBnZmMuc2lkZWluZm9fbGVuID0gKGdmYy5jaGFubmVsc19vdXQgPT0gMSkgPyA0ICsgOSA6IDQgKyAxNztcblxuICAgICAgICBpZiAoZ2ZwLmVycm9yX3Byb3RlY3Rpb24pXG4gICAgICAgICAgICBnZmMuc2lkZWluZm9fbGVuICs9IDI7XG5cbiAgICAgICAgbGFtZV9pbml0X2JpdHN0cmVhbShnZnApO1xuXG4gICAgICAgIGdmYy5DbGFzc19JRCA9IExBTUVfSUQ7XG5cbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIGs7XG5cbiAgICAgICAgICAgIGZvciAoayA9IDA7IGsgPCAxOTsgaysrKVxuICAgICAgICAgICAgICAgIGdmYy5uc1BzeS5wZWZpcmJ1ZltrXSA9IDcwMCAqIGdmYy5tb2RlX2dyICogZ2ZjLmNoYW5uZWxzX291dDtcblxuICAgICAgICAgICAgaWYgKGdmcC5BVEh0eXBlID09IC0xKVxuICAgICAgICAgICAgICAgIGdmcC5BVEh0eXBlID0gNDtcbiAgICAgICAgfVxuXG4gICAgICAgIHN3aXRjaCAoZ2ZwLlZCUikge1xuXG4gICAgICAgICAgICBjYXNlIFZick1vZGUudmJyX210OlxuICAgICAgICAgICAgICAgIGdmcC5WQlIgPSBWYnJNb2RlLnZicl9tdHJoO1xuICAgICAgICAgICAgLy8kRkFMTC1USFJPVUdIJFxuICAgICAgICAgICAgY2FzZSBWYnJNb2RlLnZicl9tdHJoOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGlmIChnZnAudXNlVGVtcG9yYWwgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBnZnAudXNlVGVtcG9yYWwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgLyogb2ZmIGJ5IGRlZmF1bHQgZm9yIHRoaXMgVkJSIG1vZGUgKi9cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBwLmFwcGx5X3ByZXNldChnZnAsIDUwMCAtIChnZnAuVkJSX3EgKiAxMCksIDApO1xuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIDxQUkU+XG4gICAgICAgICAgICAgICAgICogICBUaGUgbmV3ZXIgVkJSIGNvZGUgc3VwcG9ydHMgb25seSBhIGxpbWl0ZWRcbiAgICAgICAgICAgICAgICAgKiAgICAgc3Vic2V0IG9mIHF1YWxpdHkgbGV2ZWxzOlxuICAgICAgICAgICAgICAgICAqICAgICA5LTU9NSBhcmUgdGhlIHNhbWUsIHVzZXMgeF4zLzQgcXVhbnRpemF0aW9uXG4gICAgICAgICAgICAgICAgICogICA0LTA9MCBhcmUgdGhlIHNhbWUgIDUgcGx1cyBiZXN0IGh1ZmZtYW4gZGl2aWRlIGNvZGVcbiAgICAgICAgICAgICAgICAgKiA8L1BSRT5cbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAoZ2ZwLnF1YWxpdHkgPCAwKVxuICAgICAgICAgICAgICAgICAgICBnZnAucXVhbGl0eSA9IExBTUVfREVGQVVMVF9RVUFMSVRZO1xuICAgICAgICAgICAgICAgIGlmIChnZnAucXVhbGl0eSA8IDUpXG4gICAgICAgICAgICAgICAgICAgIGdmcC5xdWFsaXR5ID0gMDtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZwLnF1YWxpdHkgPiA1KVxuICAgICAgICAgICAgICAgICAgICBnZnAucXVhbGl0eSA9IDU7XG5cbiAgICAgICAgICAgICAgICBnZmMuUFNZLm1hc2tfYWRqdXN0ID0gZ2ZwLm1hc2tpbmdhZGp1c3Q7XG4gICAgICAgICAgICAgICAgZ2ZjLlBTWS5tYXNrX2FkanVzdF9zaG9ydCA9IGdmcC5tYXNraW5nYWRqdXN0X3Nob3J0O1xuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBzZmIyMSBleHRyYSBvbmx5IHdpdGggTVBFRy0xIGF0IGhpZ2hlciBzYW1wbGluZyByYXRlc1xuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGlmIChnZnAuZXhwZXJpbWVudGFsWSlcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnNmYjIxX2V4dHJhID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBnZmMuc2ZiMjFfZXh0cmEgPSAoZ2ZwLm91dF9zYW1wbGVyYXRlID4gNDQwMDApO1xuXG4gICAgICAgICAgICAgICAgZ2ZjLml0ZXJhdGlvbl9sb29wID0gbmV3IFZCUk5ld0l0ZXJhdGlvbkxvb3AocXUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIFZick1vZGUudmJyX3JoOlxuICAgICAgICAgICAge1xuXG4gICAgICAgICAgICAgICAgcC5hcHBseV9wcmVzZXQoZ2ZwLCA1MDAgLSAoZ2ZwLlZCUl9xICogMTApLCAwKTtcblxuICAgICAgICAgICAgICAgIGdmYy5QU1kubWFza19hZGp1c3QgPSBnZnAubWFza2luZ2FkanVzdDtcbiAgICAgICAgICAgICAgICBnZmMuUFNZLm1hc2tfYWRqdXN0X3Nob3J0ID0gZ2ZwLm1hc2tpbmdhZGp1c3Rfc2hvcnQ7XG5cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIHNmYjIxIGV4dHJhIG9ubHkgd2l0aCBNUEVHLTEgYXQgaGlnaGVyIHNhbXBsaW5nIHJhdGVzXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgaWYgKGdmcC5leHBlcmltZW50YWxZKVxuICAgICAgICAgICAgICAgICAgICBnZmMuc2ZiMjFfZXh0cmEgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGdmYy5zZmIyMV9leHRyYSA9IChnZnAub3V0X3NhbXBsZXJhdGUgPiA0NDAwMCk7XG5cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIFZCUiBuZWVkcyBhdCBsZWFzdCB0aGUgb3V0cHV0IG9mIEdQU1lDSE8sIHNvIHdlIGhhdmUgdG8gZ2FyYW50ZWVcbiAgICAgICAgICAgICAgICAgKiB0aGF0IGJ5IHNldHRpbmcgYSBtaW5pbXVtIHF1YWxpdHkgbGV2ZWwsIGFjdHVhbGx5IGxldmVsIDYgZG9lc1xuICAgICAgICAgICAgICAgICAqIGl0LiBkb3duIHRvIGxldmVsIDZcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAoZ2ZwLnF1YWxpdHkgPiA2KVxuICAgICAgICAgICAgICAgICAgICBnZnAucXVhbGl0eSA9IDY7XG5cbiAgICAgICAgICAgICAgICBpZiAoZ2ZwLnF1YWxpdHkgPCAwKVxuICAgICAgICAgICAgICAgICAgICBnZnAucXVhbGl0eSA9IExBTUVfREVGQVVMVF9RVUFMSVRZO1xuXG4gICAgICAgICAgICAgICAgZ2ZjLml0ZXJhdGlvbl9sb29wID0gbmV3IFZCUk9sZEl0ZXJhdGlvbkxvb3AocXUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBkZWZhdWx0OiAvKiBjYnIvYWJyICovXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIHZicm1vZGU7XG5cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIG5vIHNmYjIxIGV4dHJhIHdpdGggQ0JSIGNvZGVcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBnZmMuc2ZiMjFfZXh0cmEgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGlmIChnZnAucXVhbGl0eSA8IDApXG4gICAgICAgICAgICAgICAgICAgIGdmcC5xdWFsaXR5ID0gTEFNRV9ERUZBVUxUX1FVQUxJVFk7XG5cbiAgICAgICAgICAgICAgICB2YnJtb2RlID0gZ2ZwLlZCUjtcbiAgICAgICAgICAgICAgICBpZiAodmJybW9kZSA9PSBWYnJNb2RlLnZicl9vZmYpXG4gICAgICAgICAgICAgICAgICAgIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMgPSBnZnAuYnJhdGU7XG4gICAgICAgICAgICAgICAgLyogc2Vjb25kLCBzZXQgcGFyYW1ldGVycyBkZXBlbmRpbmcgb24gYml0cmF0ZSAqL1xuICAgICAgICAgICAgICAgIHAuYXBwbHlfcHJlc2V0KGdmcCwgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcywgMCk7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUiA9IHZicm1vZGU7XG5cbiAgICAgICAgICAgICAgICBnZmMuUFNZLm1hc2tfYWRqdXN0ID0gZ2ZwLm1hc2tpbmdhZGp1c3Q7XG4gICAgICAgICAgICAgICAgZ2ZjLlBTWS5tYXNrX2FkanVzdF9zaG9ydCA9IGdmcC5tYXNraW5nYWRqdXN0X3Nob3J0O1xuXG4gICAgICAgICAgICAgICAgaWYgKHZicm1vZGUgPT0gVmJyTW9kZS52YnJfb2ZmKSB7XG4gICAgICAgICAgICAgICAgICAgIGdmYy5pdGVyYXRpb25fbG9vcCA9IG5ldyBDQlJOZXdJdGVyYXRpb25Mb29wKHF1KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBnZmMuaXRlcmF0aW9uX2xvb3AgPSBuZXcgQUJSSXRlcmF0aW9uTG9vcChxdSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qIGluaXRpYWxpemUgZGVmYXVsdCB2YWx1ZXMgY29tbW9uIGZvciBhbGwgbW9kZXMgKi9cblxuICAgICAgICBpZiAoZ2ZwLlZCUiAhPSBWYnJNb2RlLnZicl9vZmYpIHsgLyogY2hvb3NlIGEgbWluL21heCBiaXRyYXRlIGZvciBWQlIgKi9cbiAgICAgICAgICAgIC8qIGlmIHRoZSB1c2VyIGRpZG4ndCBzcGVjaWZ5IFZCUl9tYXhfYml0cmF0ZTogKi9cbiAgICAgICAgICAgIGdmYy5WQlJfbWluX2JpdHJhdGUgPSAxO1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIGRlZmF1bHQ6IGFsbG93IDgga2JwcyAoTVBFRy0yKSBvciAzMiBrYnBzIChNUEVHLTEpXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGdmYy5WQlJfbWF4X2JpdHJhdGUgPSAxNDtcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBkZWZhdWx0OiBhbGxvdyAxNjAga2JwcyAoTVBFRy0yKSBvciAzMjAga2JwcyAoTVBFRy0xKVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBpZiAoZ2ZwLm91dF9zYW1wbGVyYXRlIDwgMTYwMDApXG4gICAgICAgICAgICAgICAgZ2ZjLlZCUl9tYXhfYml0cmF0ZSA9IDg7XG4gICAgICAgICAgICAvKiBkZWZhdWx0OiBhbGxvdyA2NCBrYnBzIChNUEVHLTIuNSkgKi9cbiAgICAgICAgICAgIGlmIChnZnAuVkJSX21pbl9iaXRyYXRlX2ticHMgIT0gMCkge1xuICAgICAgICAgICAgICAgIGdmcC5WQlJfbWluX2JpdHJhdGVfa2JwcyA9IEZpbmROZWFyZXN0Qml0cmF0ZShcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLlZCUl9taW5fYml0cmF0ZV9rYnBzLCBnZnAudmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLm91dF9zYW1wbGVyYXRlKTtcbiAgICAgICAgICAgICAgICBnZmMuVkJSX21pbl9iaXRyYXRlID0gQml0cmF0ZUluZGV4KGdmcC5WQlJfbWluX2JpdHJhdGVfa2JwcyxcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLnZlcnNpb24sIGdmcC5vdXRfc2FtcGxlcmF0ZSk7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5WQlJfbWluX2JpdHJhdGUgPCAwKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ2ZwLlZCUl9tYXhfYml0cmF0ZV9rYnBzICE9IDApIHtcbiAgICAgICAgICAgICAgICBnZnAuVkJSX21heF9iaXRyYXRlX2ticHMgPSBGaW5kTmVhcmVzdEJpdHJhdGUoXG4gICAgICAgICAgICAgICAgICAgIGdmcC5WQlJfbWF4X2JpdHJhdGVfa2JwcywgZ2ZwLnZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgIGdmcC5vdXRfc2FtcGxlcmF0ZSk7XG4gICAgICAgICAgICAgICAgZ2ZjLlZCUl9tYXhfYml0cmF0ZSA9IEJpdHJhdGVJbmRleChnZnAuVkJSX21heF9iaXRyYXRlX2ticHMsXG4gICAgICAgICAgICAgICAgICAgIGdmcC52ZXJzaW9uLCBnZnAub3V0X3NhbXBsZXJhdGUpO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuVkJSX21heF9iaXRyYXRlIDwgMClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZwLlZCUl9taW5fYml0cmF0ZV9rYnBzID0gVGFibGVzLmJpdHJhdGVfdGFibGVbZ2ZwLnZlcnNpb25dW2dmYy5WQlJfbWluX2JpdHJhdGVdO1xuICAgICAgICAgICAgZ2ZwLlZCUl9tYXhfYml0cmF0ZV9rYnBzID0gVGFibGVzLmJpdHJhdGVfdGFibGVbZ2ZwLnZlcnNpb25dW2dmYy5WQlJfbWF4X2JpdHJhdGVdO1xuICAgICAgICAgICAgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyA9IE1hdGgubWluKFxuICAgICAgICAgICAgICAgIFRhYmxlcy5iaXRyYXRlX3RhYmxlW2dmcC52ZXJzaW9uXVtnZmMuVkJSX21heF9iaXRyYXRlXSxcbiAgICAgICAgICAgICAgICBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzKTtcbiAgICAgICAgICAgIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMgPSBNYXRoLm1heChcbiAgICAgICAgICAgICAgICBUYWJsZXMuYml0cmF0ZV90YWJsZVtnZnAudmVyc2lvbl1bZ2ZjLlZCUl9taW5fYml0cmF0ZV0sXG4gICAgICAgICAgICAgICAgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2Jwcyk7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBqdXN0IGFub3RoZXIgZGFpbHkgY2hhbmdpbmcgZGV2ZWxvcGVyIHN3aXRjaCAqL1xuICAgICAgICBpZiAoZ2ZwLnR1bmUpIHtcbiAgICAgICAgICAgIGdmYy5QU1kubWFza19hZGp1c3QgKz0gZ2ZwLnR1bmVfdmFsdWVfYTtcbiAgICAgICAgICAgIGdmYy5QU1kubWFza19hZGp1c3Rfc2hvcnQgKz0gZ2ZwLnR1bmVfdmFsdWVfYTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGluaXRpYWxpemUgaW50ZXJuYWwgcXZhbCBzZXR0aW5ncyAqL1xuICAgICAgICBsYW1lX2luaXRfcXZhbChnZnApO1xuICAgICAgICAvKlxuICAgICAgICAgKiBhdXRvbWF0aWMgQVRIIGFkanVzdG1lbnQgb25cbiAgICAgICAgICovXG4gICAgICAgIGlmIChnZnAuYXRoYWFfdHlwZSA8IDApXG4gICAgICAgICAgICBnZmMuQVRILnVzZUFkanVzdCA9IDM7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGdmYy5BVEgudXNlQWRqdXN0ID0gZ2ZwLmF0aGFhX3R5cGU7XG5cbiAgICAgICAgLyogaW5pdGlhbGl6ZSBpbnRlcm5hbCBhZGFwdGl2ZSBBVEggc2V0dGluZ3MgLWpkICovXG4gICAgICAgIGdmYy5BVEguYWFTZW5zaXRpdml0eVAgPSBNYXRoLnBvdygxMC4wLCBnZnAuYXRoYWFfc2Vuc2l0aXZpdHlcbiAgICAgICAgICAgIC8gLTEwLjApO1xuXG4gICAgICAgIGlmIChnZnAuc2hvcnRfYmxvY2tzID09IG51bGwpIHtcbiAgICAgICAgICAgIGdmcC5zaG9ydF9ibG9ja3MgPSBTaG9ydEJsb2NrLnNob3J0X2Jsb2NrX2FsbG93ZWQ7XG4gICAgICAgIH1cblxuICAgICAgICAvKlxuICAgICAgICAgKiBOb3RlIEphbi8yMDAzOiBNYW55IGhhcmR3YXJlIGRlY29kZXJzIGNhbm5vdCBoYW5kbGUgc2hvcnQgYmxvY2tzIGluXG4gICAgICAgICAqIHJlZ3VsYXIgc3RlcmVvIG1vZGUgdW5sZXNzIHRoZXkgYXJlIGNvdXBsZWQgKHNhbWUgdHlwZSBpbiBib3RoXG4gICAgICAgICAqIGNoYW5uZWxzKSBpdCBpcyBhIHJhcmUgZXZlbnQgKDEgZnJhbWUgcGVyIG1pbi4gb3Igc28pIHRoYXQgTEFNRSB3b3VsZFxuICAgICAgICAgKiB1c2UgdW5jb3VwbGVkIHNob3J0IGJsb2Nrcywgc28gbGV0cyB0dXJuIHRoZW0gb2ZmIHVudGlsIHdlIGRlY2lkZSBob3dcbiAgICAgICAgICogdG8gaGFuZGxlIHRoaXMuIE5vIG90aGVyIGVuY29kZXJzIGFsbG93IHVuY291cGxlZCBzaG9ydCBibG9ja3MsIGV2ZW5cbiAgICAgICAgICogdGhvdWdoIGl0IGlzIGluIHRoZSBzdGFuZGFyZC5cbiAgICAgICAgICovXG4gICAgICAgIC8qXG4gICAgICAgICAqIHJoIDIwMDQwMjE3OiBjb3VwbGluZyBtYWtlcyBubyBzZW5zZSBmb3IgbW9ubyBhbmQgZHVhbC1tb25vIHN0cmVhbXNcbiAgICAgICAgICovXG4gICAgICAgIGlmIChnZnAuc2hvcnRfYmxvY2tzID09IFNob3J0QmxvY2suc2hvcnRfYmxvY2tfYWxsb3dlZFxuICAgICAgICAgICAgJiYgKGdmcC5tb2RlID09IE1QRUdNb2RlLkpPSU5UX1NURVJFTyB8fCBnZnAubW9kZSA9PSBNUEVHTW9kZS5TVEVSRU8pKSB7XG4gICAgICAgICAgICBnZnAuc2hvcnRfYmxvY2tzID0gU2hvcnRCbG9jay5zaG9ydF9ibG9ja19jb3VwbGVkO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGdmcC5xdWFudF9jb21wIDwgMClcbiAgICAgICAgICAgIGdmcC5xdWFudF9jb21wID0gMTtcbiAgICAgICAgaWYgKGdmcC5xdWFudF9jb21wX3Nob3J0IDwgMClcbiAgICAgICAgICAgIGdmcC5xdWFudF9jb21wX3Nob3J0ID0gMDtcblxuICAgICAgICBpZiAoZ2ZwLm1zZml4IDwgMClcbiAgICAgICAgICAgIGdmcC5tc2ZpeCA9IDA7XG5cbiAgICAgICAgLyogc2VsZWN0IHBzeWNob2Fjb3VzdGljIG1vZGVsICovXG4gICAgICAgIGdmcC5leHBfbnNwc3l0dW5lID0gZ2ZwLmV4cF9uc3BzeXR1bmUgfCAxO1xuXG4gICAgICAgIGlmIChnZnAuaW50ZXJuYWxfZmxhZ3MubnNQc3kuYXR0YWNrdGhyZSA8IDApXG4gICAgICAgICAgICBnZnAuaW50ZXJuYWxfZmxhZ3MubnNQc3kuYXR0YWNrdGhyZSA9IFBzeU1vZGVsLk5TQVRUQUNLVEhSRTtcbiAgICAgICAgaWYgKGdmcC5pbnRlcm5hbF9mbGFncy5uc1BzeS5hdHRhY2t0aHJlX3MgPCAwKVxuICAgICAgICAgICAgZ2ZwLmludGVybmFsX2ZsYWdzLm5zUHN5LmF0dGFja3RocmVfcyA9IFBzeU1vZGVsLk5TQVRUQUNLVEhSRV9TO1xuXG5cbiAgICAgICAgaWYgKGdmcC5zY2FsZSA8IDApXG4gICAgICAgICAgICBnZnAuc2NhbGUgPSAxO1xuXG4gICAgICAgIGlmIChnZnAuQVRIdHlwZSA8IDApXG4gICAgICAgICAgICBnZnAuQVRIdHlwZSA9IDQ7XG5cbiAgICAgICAgaWYgKGdmcC5BVEhjdXJ2ZSA8IDApXG4gICAgICAgICAgICBnZnAuQVRIY3VydmUgPSA0O1xuXG4gICAgICAgIGlmIChnZnAuYXRoYWFfbG91ZGFwcHJveCA8IDApXG4gICAgICAgICAgICBnZnAuYXRoYWFfbG91ZGFwcHJveCA9IDI7XG5cbiAgICAgICAgaWYgKGdmcC5pbnRlckNoUmF0aW8gPCAwKVxuICAgICAgICAgICAgZ2ZwLmludGVyQ2hSYXRpbyA9IDA7XG5cbiAgICAgICAgaWYgKGdmcC51c2VUZW1wb3JhbCA9PSBudWxsKVxuICAgICAgICAgICAgZ2ZwLnVzZVRlbXBvcmFsID0gdHJ1ZTtcbiAgICAgICAgLyogb24gYnkgZGVmYXVsdCAqL1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHBhZGRpbmcgbWV0aG9kIGFzIGRlc2NyaWJlZCBpblxuICAgICAgICAgKiBcIk1QRUctTGF5ZXIzIC8gQml0c3RyZWFtIFN5bnRheCBhbmQgRGVjb2RpbmdcIiBieSBNYXJ0aW4gU2llbGVyLCBSYWxwaFxuICAgICAgICAgKiBTcGVyc2NobmVpZGVyXG4gICAgICAgICAqXG4gICAgICAgICAqIG5vdGU6IHRoZXJlIGlzIG5vIHBhZGRpbmcgZm9yIHRoZSB2ZXJ5IGZpcnN0IGZyYW1lXG4gICAgICAgICAqXG4gICAgICAgICAqIFJvYmVydCBIZWdlbWFubiAyMDAwLTA2LTIyXG4gICAgICAgICAqL1xuICAgICAgICBnZmMuc2xvdF9sYWcgPSBnZmMuZnJhY19TcEYgPSAwO1xuICAgICAgICBpZiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9vZmYpXG4gICAgICAgICAgICBnZmMuc2xvdF9sYWcgPSBnZmMuZnJhY19TcEYgPSAoKChnZnAudmVyc2lvbiArIDEpICogNzIwMDAgKiBnZnAuYnJhdGUpICUgZ2ZwLm91dF9zYW1wbGVyYXRlKSB8IDA7XG5cbiAgICAgICAgcXVwdnQuaXRlcmF0aW9uX2luaXQoZ2ZwKTtcbiAgICAgICAgcHN5LnBzeW1vZGVsX2luaXQoZ2ZwKTtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdXBkYXRlX2luYnVmZmVyX3NpemUoZ2ZjLCBuc2FtcGxlcykge1xuICAgICAgICBpZiAoZ2ZjLmluX2J1ZmZlcl8wID09IG51bGwgfHwgZ2ZjLmluX2J1ZmZlcl9uc2FtcGxlcyA8IG5zYW1wbGVzKSB7XG4gICAgICAgICAgICBnZmMuaW5fYnVmZmVyXzAgPSBuZXdfZmxvYXQobnNhbXBsZXMpO1xuICAgICAgICAgICAgZ2ZjLmluX2J1ZmZlcl8xID0gbmV3X2Zsb2F0KG5zYW1wbGVzKTtcbiAgICAgICAgICAgIGdmYy5pbl9idWZmZXJfbnNhbXBsZXMgPSBuc2FtcGxlcztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMubGFtZV9lbmNvZGVfZmx1c2ggPSBmdW5jdGlvbiAoZ2ZwLCBtcDNidWZmZXIsIG1wM2J1ZmZlclBvcywgbXAzYnVmZmVyX3NpemUpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGJ1ZmZlciA9IG5ld19zaG9ydF9uKFsyLCAxMTUyXSk7XG4gICAgICAgIHZhciBpbXAzID0gMCwgbXAzY291bnQsIG1wM2J1ZmZlcl9zaXplX3JlbWFpbmluZztcblxuICAgICAgICAvKlxuICAgICAgICAgKiB3ZSBhbHdheXMgYWRkIFBPU1RERUxBWT0yODggcGFkZGluZyB0byBtYWtlIHN1cmUgZ3JhbnVsZSB3aXRoIHJlYWxcbiAgICAgICAgICogZGF0YSBjYW4gYmUgY29tcGxldHkgZGVjb2RlZCAoYmVjYXVzZSBvZiA1MCUgb3ZlcmxhcCB3aXRoIG5leHRcbiAgICAgICAgICogZ3JhbnVsZVxuICAgICAgICAgKi9cbiAgICAgICAgdmFyIGVuZF9wYWRkaW5nO1xuICAgICAgICB2YXIgZnJhbWVzX2xlZnQ7XG4gICAgICAgIHZhciBzYW1wbGVzX3RvX2VuY29kZSA9IGdmYy5tZl9zYW1wbGVzX3RvX2VuY29kZSAtIEVuY29kZXIuUE9TVERFTEFZO1xuICAgICAgICB2YXIgbWZfbmVlZGVkID0gY2FsY05lZWRlZChnZnApO1xuXG4gICAgICAgIC8qIFdhcyBmbHVzaCBhbHJlYWR5IGNhbGxlZD8gKi9cbiAgICAgICAgaWYgKGdmYy5tZl9zYW1wbGVzX3RvX2VuY29kZSA8IDEpIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIG1wM2NvdW50ID0gMDtcblxuICAgICAgICBpZiAoZ2ZwLmluX3NhbXBsZXJhdGUgIT0gZ2ZwLm91dF9zYW1wbGVyYXRlKSB7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogZGVsYXkgZHVlIHRvIHJlc2FtcGxpbmc7IG5lZWRzIHRvIGJlIGZpeGVkLCBpZiByZXNhbXBsaW5nIGNvZGVcbiAgICAgICAgICAgICAqIGdldHMgY2hhbmdlZFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBzYW1wbGVzX3RvX2VuY29kZSArPSAxNi4gKiBnZnAub3V0X3NhbXBsZXJhdGUgLyBnZnAuaW5fc2FtcGxlcmF0ZTtcbiAgICAgICAgfVxuICAgICAgICBlbmRfcGFkZGluZyA9IGdmcC5mcmFtZXNpemUgLSAoc2FtcGxlc190b19lbmNvZGUgJSBnZnAuZnJhbWVzaXplKTtcbiAgICAgICAgaWYgKGVuZF9wYWRkaW5nIDwgNTc2KVxuICAgICAgICAgICAgZW5kX3BhZGRpbmcgKz0gZ2ZwLmZyYW1lc2l6ZTtcbiAgICAgICAgZ2ZwLmVuY29kZXJfcGFkZGluZyA9IGVuZF9wYWRkaW5nO1xuXG4gICAgICAgIGZyYW1lc19sZWZ0ID0gKHNhbXBsZXNfdG9fZW5jb2RlICsgZW5kX3BhZGRpbmcpIC8gZ2ZwLmZyYW1lc2l6ZTtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBzZW5kIGluIGEgZnJhbWUgb2YgMCBwYWRkaW5nIHVudGlsIGFsbCBpbnRlcm5hbCBzYW1wbGUgYnVmZmVycyBhcmVcbiAgICAgICAgICogZmx1c2hlZFxuICAgICAgICAgKi9cbiAgICAgICAgd2hpbGUgKGZyYW1lc19sZWZ0ID4gMCAmJiBpbXAzID49IDApIHtcbiAgICAgICAgICAgIHZhciBidW5jaCA9IG1mX25lZWRlZCAtIGdmYy5tZl9zaXplO1xuICAgICAgICAgICAgdmFyIGZyYW1lX251bSA9IGdmcC5mcmFtZU51bTtcblxuICAgICAgICAgICAgYnVuY2ggKj0gZ2ZwLmluX3NhbXBsZXJhdGU7XG4gICAgICAgICAgICBidW5jaCAvPSBnZnAub3V0X3NhbXBsZXJhdGU7XG4gICAgICAgICAgICBpZiAoYnVuY2ggPiAxMTUyKVxuICAgICAgICAgICAgICAgIGJ1bmNoID0gMTE1MjtcbiAgICAgICAgICAgIGlmIChidW5jaCA8IDEpXG4gICAgICAgICAgICAgICAgYnVuY2ggPSAxO1xuXG4gICAgICAgICAgICBtcDNidWZmZXJfc2l6ZV9yZW1haW5pbmcgPSBtcDNidWZmZXJfc2l6ZSAtIG1wM2NvdW50O1xuXG4gICAgICAgICAgICAvKiBpZiB1c2VyIHNwZWNpZmVkIGJ1ZmZlciBzaXplID0gMCwgZG9udCBjaGVjayBzaXplICovXG4gICAgICAgICAgICBpZiAobXAzYnVmZmVyX3NpemUgPT0gMClcbiAgICAgICAgICAgICAgICBtcDNidWZmZXJfc2l6ZV9yZW1haW5pbmcgPSAwO1xuXG4gICAgICAgICAgICBpbXAzID0gdGhpcy5sYW1lX2VuY29kZV9idWZmZXIoZ2ZwLCBidWZmZXJbMF0sIGJ1ZmZlclsxXSwgYnVuY2gsXG4gICAgICAgICAgICAgICAgbXAzYnVmZmVyLCBtcDNidWZmZXJQb3MsIG1wM2J1ZmZlcl9zaXplX3JlbWFpbmluZyk7XG5cbiAgICAgICAgICAgIG1wM2J1ZmZlclBvcyArPSBpbXAzO1xuICAgICAgICAgICAgbXAzY291bnQgKz0gaW1wMztcbiAgICAgICAgICAgIGZyYW1lc19sZWZ0IC09IChmcmFtZV9udW0gIT0gZ2ZwLmZyYW1lTnVtKSA/IDEgOiAwO1xuICAgICAgICB9XG4gICAgICAgIC8qXG4gICAgICAgICAqIFNldCBnZmMubWZfc2FtcGxlc190b19lbmNvZGUgdG8gMCwgc28gd2UgbWF5IGRldGVjdCBhbmQgYnJlYWsgbG9vcHNcbiAgICAgICAgICogY2FsbGluZyBpdCBtb3JlIHRoYW4gb25jZSBpbiBhIHJvdy5cbiAgICAgICAgICovXG4gICAgICAgIGdmYy5tZl9zYW1wbGVzX3RvX2VuY29kZSA9IDA7XG5cbiAgICAgICAgaWYgKGltcDMgPCAwKSB7XG4gICAgICAgICAgICAvKiBzb21lIHR5cGUgb2YgZmF0YWwgZXJyb3IgKi9cbiAgICAgICAgICAgIHJldHVybiBpbXAzO1xuICAgICAgICB9XG5cbiAgICAgICAgbXAzYnVmZmVyX3NpemVfcmVtYWluaW5nID0gbXAzYnVmZmVyX3NpemUgLSBtcDNjb3VudDtcbiAgICAgICAgLyogaWYgdXNlciBzcGVjaWZlZCBidWZmZXIgc2l6ZSA9IDAsIGRvbnQgY2hlY2sgc2l6ZSAqL1xuICAgICAgICBpZiAobXAzYnVmZmVyX3NpemUgPT0gMClcbiAgICAgICAgICAgIG1wM2J1ZmZlcl9zaXplX3JlbWFpbmluZyA9IDA7XG5cbiAgICAgICAgLyogbXAzIHJlbGF0ZWQgc3R1ZmYuIGJpdCBidWZmZXIgbWlnaHQgc3RpbGwgY29udGFpbiBzb21lIG1wMyBkYXRhICovXG4gICAgICAgIGJzLmZsdXNoX2JpdHN0cmVhbShnZnApO1xuICAgICAgICBpbXAzID0gYnMuY29weV9idWZmZXIoZ2ZjLCBtcDNidWZmZXIsIG1wM2J1ZmZlclBvcyxcbiAgICAgICAgICAgIG1wM2J1ZmZlcl9zaXplX3JlbWFpbmluZywgMSk7XG4gICAgICAgIGlmIChpbXAzIDwgMCkge1xuICAgICAgICAgICAgLyogc29tZSB0eXBlIG9mIGZhdGFsIGVycm9yICovXG4gICAgICAgICAgICByZXR1cm4gaW1wMztcbiAgICAgICAgfVxuICAgICAgICBtcDNidWZmZXJQb3MgKz0gaW1wMztcbiAgICAgICAgbXAzY291bnQgKz0gaW1wMztcbiAgICAgICAgbXAzYnVmZmVyX3NpemVfcmVtYWluaW5nID0gbXAzYnVmZmVyX3NpemUgLSBtcDNjb3VudDtcbiAgICAgICAgLyogaWYgdXNlciBzcGVjaWZlZCBidWZmZXIgc2l6ZSA9IDAsIGRvbnQgY2hlY2sgc2l6ZSAqL1xuICAgICAgICBpZiAobXAzYnVmZmVyX3NpemUgPT0gMClcbiAgICAgICAgICAgIG1wM2J1ZmZlcl9zaXplX3JlbWFpbmluZyA9IDA7XG5cbiAgICAgICAgaWYgKGdmcC53cml0ZV9pZDN0YWdfYXV0b21hdGljKSB7XG4gICAgICAgICAgICAvKiB3cml0ZSBhIGlkMyB0YWcgdG8gdGhlIGJpdHN0cmVhbSAqL1xuICAgICAgICAgICAgaWQzLmlkM3RhZ193cml0ZV92MShnZnApO1xuXG4gICAgICAgICAgICBpbXAzID0gYnMuY29weV9idWZmZXIoZ2ZjLCBtcDNidWZmZXIsIG1wM2J1ZmZlclBvcyxcbiAgICAgICAgICAgICAgICBtcDNidWZmZXJfc2l6ZV9yZW1haW5pbmcsIDApO1xuXG4gICAgICAgICAgICBpZiAoaW1wMyA8IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW1wMztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1wM2NvdW50ICs9IGltcDM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG1wM2NvdW50O1xuICAgIH07XG5cbiAgICB0aGlzLmxhbWVfZW5jb2RlX2J1ZmZlciA9IGZ1bmN0aW9uIChnZnAsIGJ1ZmZlcl9sLCBidWZmZXJfciwgbnNhbXBsZXMsIG1wM2J1ZiwgbXAzYnVmUG9zLCBtcDNidWZfc2l6ZSkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgaW5fYnVmZmVyID0gW251bGwsIG51bGxdO1xuXG4gICAgICAgIGlmIChnZmMuQ2xhc3NfSUQgIT0gTEFNRV9JRClcbiAgICAgICAgICAgIHJldHVybiAtMztcblxuICAgICAgICBpZiAobnNhbXBsZXMgPT0gMClcbiAgICAgICAgICAgIHJldHVybiAwO1xuXG4gICAgICAgIHVwZGF0ZV9pbmJ1ZmZlcl9zaXplKGdmYywgbnNhbXBsZXMpO1xuXG4gICAgICAgIGluX2J1ZmZlclswXSA9IGdmYy5pbl9idWZmZXJfMDtcbiAgICAgICAgaW5fYnVmZmVyWzFdID0gZ2ZjLmluX2J1ZmZlcl8xO1xuXG4gICAgICAgIC8qIG1ha2UgYSBjb3B5IG9mIGlucHV0IGJ1ZmZlciwgY2hhbmdpbmcgdHlwZSB0byBzYW1wbGVfdCAqL1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5zYW1wbGVzOyBpKyspIHtcbiAgICAgICAgICAgIGluX2J1ZmZlclswXVtpXSA9IGJ1ZmZlcl9sW2ldO1xuICAgICAgICAgICAgaWYgKGdmYy5jaGFubmVsc19pbiA+IDEpXG4gICAgICAgICAgICAgICAgaW5fYnVmZmVyWzFdW2ldID0gYnVmZmVyX3JbaV07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbGFtZV9lbmNvZGVfYnVmZmVyX3NhbXBsZShnZnAsIGluX2J1ZmZlclswXSwgaW5fYnVmZmVyWzFdLFxuICAgICAgICAgICAgbnNhbXBsZXMsIG1wM2J1ZiwgbXAzYnVmUG9zLCBtcDNidWZfc2l6ZSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY2FsY05lZWRlZChnZnApIHtcbiAgICAgICAgdmFyIG1mX25lZWRlZCA9IEVuY29kZXIuQkxLU0laRSArIGdmcC5mcmFtZXNpemUgLSBFbmNvZGVyLkZGVE9GRlNFVDtcbiAgICAgICAgLypcbiAgICAgICAgICogYW1vdW50IG5lZWRlZCBmb3IgRkZUXG4gICAgICAgICAqL1xuICAgICAgICBtZl9uZWVkZWQgPSBNYXRoLm1heChtZl9uZWVkZWQsIDUxMiArIGdmcC5mcmFtZXNpemUgLSAzMik7XG5cbiAgICAgICAgcmV0dXJuIG1mX25lZWRlZDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsYW1lX2VuY29kZV9idWZmZXJfc2FtcGxlKGdmcCwgYnVmZmVyX2wsIGJ1ZmZlcl9yLCBuc2FtcGxlcywgbXAzYnVmLCBtcDNidWZQb3MsIG1wM2J1Zl9zaXplKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBtcDNzaXplID0gMCwgcmV0LCBpLCBjaCwgbWZfbmVlZGVkO1xuICAgICAgICB2YXIgbXAzb3V0O1xuICAgICAgICB2YXIgbWZidWYgPSBbbnVsbCwgbnVsbF07XG4gICAgICAgIHZhciBpbl9idWZmZXIgPSBbbnVsbCwgbnVsbF07XG5cbiAgICAgICAgaWYgKGdmYy5DbGFzc19JRCAhPSBMQU1FX0lEKVxuICAgICAgICAgICAgcmV0dXJuIC0zO1xuXG4gICAgICAgIGlmIChuc2FtcGxlcyA9PSAwKVxuICAgICAgICAgICAgcmV0dXJuIDA7XG5cbiAgICAgICAgLyogY29weSBvdXQgYW55IHRhZ3MgdGhhdCBtYXkgaGF2ZSBiZWVuIHdyaXR0ZW4gaW50byBiaXRzdHJlYW0gKi9cbiAgICAgICAgbXAzb3V0ID0gYnMuY29weV9idWZmZXIoZ2ZjLCBtcDNidWYsIG1wM2J1ZlBvcywgbXAzYnVmX3NpemUsIDApO1xuICAgICAgICBpZiAobXAzb3V0IDwgMClcbiAgICAgICAgICAgIHJldHVybiBtcDNvdXQ7XG4gICAgICAgIC8qIG5vdCBlbm91Z2ggYnVmZmVyIHNwYWNlICovXG4gICAgICAgIG1wM2J1ZlBvcyArPSBtcDNvdXQ7XG4gICAgICAgIG1wM3NpemUgKz0gbXAzb3V0O1xuXG4gICAgICAgIGluX2J1ZmZlclswXSA9IGJ1ZmZlcl9sO1xuICAgICAgICBpbl9idWZmZXJbMV0gPSBidWZmZXJfcjtcblxuICAgICAgICAvKiBBcHBseSB1c2VyIGRlZmluZWQgcmUtc2NhbGluZyAqL1xuXG4gICAgICAgIC8qIHVzZXIgc2VsZWN0ZWQgc2NhbGluZyBvZiB0aGUgc2FtcGxlcyAqL1xuICAgICAgICBpZiAoQml0U3RyZWFtLk5FUShnZnAuc2NhbGUsIDApICYmIEJpdFN0cmVhbS5ORVEoZ2ZwLnNjYWxlLCAxLjApKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbnNhbXBsZXM7ICsraSkge1xuICAgICAgICAgICAgICAgIGluX2J1ZmZlclswXVtpXSAqPSBnZnAuc2NhbGU7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5jaGFubmVsc19vdXQgPT0gMilcbiAgICAgICAgICAgICAgICAgICAgaW5fYnVmZmVyWzFdW2ldICo9IGdmcC5zY2FsZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIHVzZXIgc2VsZWN0ZWQgc2NhbGluZyBvZiB0aGUgY2hhbm5lbCAwIChsZWZ0KSBzYW1wbGVzICovXG4gICAgICAgIGlmIChCaXRTdHJlYW0uTkVRKGdmcC5zY2FsZV9sZWZ0LCAwKVxuICAgICAgICAgICAgJiYgQml0U3RyZWFtLk5FUShnZnAuc2NhbGVfbGVmdCwgMS4wKSkge1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG5zYW1wbGVzOyArK2kpIHtcbiAgICAgICAgICAgICAgICBpbl9idWZmZXJbMF1baV0gKj0gZ2ZwLnNjYWxlX2xlZnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiB1c2VyIHNlbGVjdGVkIHNjYWxpbmcgb2YgdGhlIGNoYW5uZWwgMSAocmlnaHQpIHNhbXBsZXMgKi9cbiAgICAgICAgaWYgKEJpdFN0cmVhbS5ORVEoZ2ZwLnNjYWxlX3JpZ2h0LCAwKVxuICAgICAgICAgICAgJiYgQml0U3RyZWFtLk5FUShnZnAuc2NhbGVfcmlnaHQsIDEuMCkpIHtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBuc2FtcGxlczsgKytpKSB7XG4gICAgICAgICAgICAgICAgaW5fYnVmZmVyWzFdW2ldICo9IGdmcC5zY2FsZV9yaWdodDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIERvd25zYW1wbGUgdG8gTW9ubyBpZiAyIGNoYW5uZWxzIGluIGFuZCAxIGNoYW5uZWwgb3V0ICovXG4gICAgICAgIGlmIChnZnAubnVtX2NoYW5uZWxzID09IDIgJiYgZ2ZjLmNoYW5uZWxzX291dCA9PSAxKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbnNhbXBsZXM7ICsraSkge1xuICAgICAgICAgICAgICAgIGluX2J1ZmZlclswXVtpXSA9IDAuNSAqICggaW5fYnVmZmVyWzBdW2ldICsgaW5fYnVmZmVyWzFdW2ldKTtcbiAgICAgICAgICAgICAgICBpbl9idWZmZXJbMV1baV0gPSAwLjA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBtZl9uZWVkZWQgPSBjYWxjTmVlZGVkKGdmcCk7XG5cbiAgICAgICAgbWZidWZbMF0gPSBnZmMubWZidWZbMF07XG4gICAgICAgIG1mYnVmWzFdID0gZ2ZjLm1mYnVmWzFdO1xuXG4gICAgICAgIHZhciBpbl9idWZmZXJQb3MgPSAwO1xuICAgICAgICB3aGlsZSAobnNhbXBsZXMgPiAwKSB7XG4gICAgICAgICAgICB2YXIgaW5fYnVmZmVyX3B0ciA9IFtudWxsLCBudWxsXTtcbiAgICAgICAgICAgIHZhciBuX2luID0gMDtcbiAgICAgICAgICAgIC8qIG51bWJlciBvZiBpbnB1dCBzYW1wbGVzIHByb2Nlc3NlZCB3aXRoIGZpbGxfYnVmZmVyICovXG4gICAgICAgICAgICB2YXIgbl9vdXQgPSAwO1xuICAgICAgICAgICAgLyogbnVtYmVyIG9mIHNhbXBsZXMgb3V0cHV0IHdpdGggZmlsbF9idWZmZXIgKi9cbiAgICAgICAgICAgIC8qIG5faW4gPD4gbl9vdXQgaWYgd2UgYXJlIHJlc2FtcGxpbmcgKi9cblxuICAgICAgICAgICAgaW5fYnVmZmVyX3B0clswXSA9IGluX2J1ZmZlclswXTtcbiAgICAgICAgICAgIGluX2J1ZmZlcl9wdHJbMV0gPSBpbl9idWZmZXJbMV07XG4gICAgICAgICAgICAvKiBjb3B5IGluIG5ldyBzYW1wbGVzIGludG8gbWZidWYsIHdpdGggcmVzYW1wbGluZyAqL1xuICAgICAgICAgICAgdmFyIGluT3V0ID0gbmV3IEluT3V0KCk7XG4gICAgICAgICAgICBmaWxsX2J1ZmZlcihnZnAsIG1mYnVmLCBpbl9idWZmZXJfcHRyLCBpbl9idWZmZXJQb3MsIG5zYW1wbGVzLFxuICAgICAgICAgICAgICAgIGluT3V0KTtcbiAgICAgICAgICAgIG5faW4gPSBpbk91dC5uX2luO1xuICAgICAgICAgICAgbl9vdXQgPSBpbk91dC5uX291dDtcblxuICAgICAgICAgICAgLyogY29tcHV0ZSBSZXBsYXlHYWluIG9mIHJlc2FtcGxlZCBpbnB1dCBpZiByZXF1ZXN0ZWQgKi9cbiAgICAgICAgICAgIGlmIChnZmMuZmluZFJlcGxheUdhaW4gJiYgIWdmYy5kZWNvZGVfb25fdGhlX2ZseSlcbiAgICAgICAgICAgICAgICBpZiAoZ2EuQW5hbHl6ZVNhbXBsZXMoZ2ZjLnJnZGF0YSwgbWZidWZbMF0sIGdmYy5tZl9zaXplLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWZidWZbMV0sIGdmYy5tZl9zaXplLCBuX291dCwgZ2ZjLmNoYW5uZWxzX291dCkgPT0gR2FpbkFuYWx5c2lzLkdBSU5fQU5BTFlTSVNfRVJST1IpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtNjtcblxuICAgICAgICAgICAgLyogdXBkYXRlIGluX2J1ZmZlciBjb3VudGVycyAqL1xuICAgICAgICAgICAgbnNhbXBsZXMgLT0gbl9pbjtcbiAgICAgICAgICAgIGluX2J1ZmZlclBvcyArPSBuX2luO1xuICAgICAgICAgICAgaWYgKGdmYy5jaGFubmVsc19vdXQgPT0gMilcbiAgICAgICAgICAgICAgICA7Ly8gaW5fYnVmZmVyUG9zICs9IG5faW47XG5cbiAgICAgICAgICAgIC8qIHVwZGF0ZSBtZmJ1ZltdIGNvdW50ZXJzICovXG4gICAgICAgICAgICBnZmMubWZfc2l6ZSArPSBuX291dDtcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIGxhbWVfZW5jb2RlX2ZsdXNoIG1heSBoYXZlIHNldCBnZmMubWZfc2FtcGxlX3RvX2VuY29kZSB0byAwIHNvIHdlXG4gICAgICAgICAgICAgKiBoYXZlIHRvIHJlaW5pdGlhbGl6ZSBpdCBoZXJlIHdoZW4gdGhhdCBoYXBwZW5lZC5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKGdmYy5tZl9zYW1wbGVzX3RvX2VuY29kZSA8IDEpIHtcbiAgICAgICAgICAgICAgICBnZmMubWZfc2FtcGxlc190b19lbmNvZGUgPSBFbmNvZGVyLkVOQ0RFTEFZICsgRW5jb2Rlci5QT1NUREVMQVk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMubWZfc2FtcGxlc190b19lbmNvZGUgKz0gbl9vdXQ7XG5cbiAgICAgICAgICAgIGlmIChnZmMubWZfc2l6ZSA+PSBtZl9uZWVkZWQpIHtcbiAgICAgICAgICAgICAgICAvKiBlbmNvZGUgdGhlIGZyYW1lLiAqL1xuICAgICAgICAgICAgICAgIC8qIG1wM2J1ZiA9IHBvaW50ZXIgdG8gY3VycmVudCBsb2NhdGlvbiBpbiBidWZmZXIgKi9cbiAgICAgICAgICAgICAgICAvKiBtcDNidWZfc2l6ZSA9IHNpemUgb2Ygb3JpZ2luYWwgbXAzIG91dHB1dCBidWZmZXIgKi9cbiAgICAgICAgICAgICAgICAvKiA9IDAgaWYgd2Ugc2hvdWxkIG5vdCB3b3JyeSBhYm91dCB0aGUgKi9cbiAgICAgICAgICAgICAgICAvKiBidWZmZXIgc2l6ZSBiZWNhdXNlIGNhbGxpbmcgcHJvZ3JhbSBpcyAqL1xuICAgICAgICAgICAgICAgIC8qIHRvIGxhenkgdG8gY29tcHV0ZSBpdCAqL1xuICAgICAgICAgICAgICAgIC8qIG1wM3NpemUgPSBzaXplIG9mIGRhdGEgd3JpdHRlbiB0byBidWZmZXIgc28gZmFyICovXG4gICAgICAgICAgICAgICAgLyogbXAzYnVmX3NpemUtbXAzc2l6ZSA9IGFtb3VudCBvZiBzcGFjZSBhdmFsYWJsZSAqL1xuXG4gICAgICAgICAgICAgICAgdmFyIGJ1Zl9zaXplID0gbXAzYnVmX3NpemUgLSBtcDNzaXplO1xuICAgICAgICAgICAgICAgIGlmIChtcDNidWZfc2l6ZSA9PSAwKVxuICAgICAgICAgICAgICAgICAgICBidWZfc2l6ZSA9IDA7XG5cbiAgICAgICAgICAgICAgICByZXQgPSBsYW1lX2VuY29kZV9mcmFtZShnZnAsIG1mYnVmWzBdLCBtZmJ1ZlsxXSwgbXAzYnVmLFxuICAgICAgICAgICAgICAgICAgICBtcDNidWZQb3MsIGJ1Zl9zaXplKTtcblxuICAgICAgICAgICAgICAgIGlmIChyZXQgPCAwKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmV0O1xuICAgICAgICAgICAgICAgIG1wM2J1ZlBvcyArPSByZXQ7XG4gICAgICAgICAgICAgICAgbXAzc2l6ZSArPSByZXQ7XG5cbiAgICAgICAgICAgICAgICAvKiBzaGlmdCBvdXQgb2xkIHNhbXBsZXMgKi9cbiAgICAgICAgICAgICAgICBnZmMubWZfc2l6ZSAtPSBnZnAuZnJhbWVzaXplO1xuICAgICAgICAgICAgICAgIGdmYy5tZl9zYW1wbGVzX3RvX2VuY29kZSAtPSBnZnAuZnJhbWVzaXplO1xuICAgICAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspXG4gICAgICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBnZmMubWZfc2l6ZTsgaSsrKVxuICAgICAgICAgICAgICAgICAgICAgICAgbWZidWZbY2hdW2ldID0gbWZidWZbY2hdW2kgKyBnZnAuZnJhbWVzaXplXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBtcDNzaXplO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxhbWVfZW5jb2RlX2ZyYW1lKGdmcCwgaW5idWZfbCwgaW5idWZfciwgbXAzYnVmLCBtcDNidWZQb3MsIG1wM2J1Zl9zaXplKSB7XG4gICAgICAgIHZhciByZXQgPSBzZWxmLmVuYy5sYW1lX2VuY29kZV9tcDNfZnJhbWUoZ2ZwLCBpbmJ1Zl9sLCBpbmJ1Zl9yLCBtcDNidWYsXG4gICAgICAgICAgICBtcDNidWZQb3MsIG1wM2J1Zl9zaXplKTtcbiAgICAgICAgZ2ZwLmZyYW1lTnVtKys7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gSW5PdXQoKSB7XG4gICAgICAgIHRoaXMubl9pbiA9IDA7XG4gICAgICAgIHRoaXMubl9vdXQgPSAwO1xuICAgIH1cblxuXG4gICAgZnVuY3Rpb24gTnVtVXNlZCgpIHtcbiAgICAgICAgdGhpcy5udW1fdXNlZCA9IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR3JlYXRlc3QgY29tbW9uIGRpdmlzb3IuXG4gICAgICogPHA+XG4gICAgICogSm9pbnQgd29yayBvZiBFdWNsaWQgYW5kIE0uIEhlbmRyeVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdjZChpLCBqKSB7XG4gICAgICAgIHJldHVybiBqICE9IDAgPyBnY2QoaiwgaSAlIGopIDogaTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZXNhbXBsaW5nIHZpYSBGSVIgZmlsdGVyLCBibGFja21hbiB3aW5kb3cuXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmxhY2ttYW4oeCwgZmNuLCBsKSB7XG4gICAgICAgIC8qXG4gICAgICAgICAqIFRoaXMgYWxnb3JpdGhtIGZyb206IFNJR05BTCBQUk9DRVNTSU5HIEFMR09SSVRITVMgSU4gRk9SVFJBTiBBTkQgQ1xuICAgICAgICAgKiBTLkQuIFN0ZWFybnMgYW5kIFIuQS4gRGF2aWQsIFByZW50aWNlLUhhbGwsIDE5OTJcbiAgICAgICAgICovXG4gICAgICAgIHZhciB3Y24gPSAoTWF0aC5QSSAqIGZjbik7XG5cbiAgICAgICAgeCAvPSBsO1xuICAgICAgICBpZiAoeCA8IDApXG4gICAgICAgICAgICB4ID0gMDtcbiAgICAgICAgaWYgKHggPiAxKVxuICAgICAgICAgICAgeCA9IDE7XG4gICAgICAgIHZhciB4MiA9IHggLSAuNTtcblxuICAgICAgICB2YXIgYmt3biA9IDAuNDIgLSAwLjUgKiBNYXRoLmNvcygyICogeCAqIE1hdGguUEkpICsgMC4wOCAqIE1hdGguY29zKDQgKiB4ICogTWF0aC5QSSk7XG4gICAgICAgIGlmIChNYXRoLmFicyh4MikgPCAxZS05KVxuICAgICAgICAgICAgcmV0dXJuICh3Y24gLyBNYXRoLlBJKTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgcmV0dXJuIChia3duICogTWF0aC5zaW4obCAqIHdjbiAqIHgyKSAvIChNYXRoLlBJICogbCAqIHgyKSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZmlsbF9idWZmZXJfcmVzYW1wbGUoZ2ZwLCBvdXRidWYsIG91dGJ1ZlBvcywgZGVzaXJlZF9sZW4sIGluYnVmLCBpbl9idWZmZXJQb3MsIGxlbiwgbnVtX3VzZWQsIGNoKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBpLCBqID0gMCwgaztcbiAgICAgICAgLyogbnVtYmVyIG9mIGNvbnZvbHV0aW9uIGZ1bmN0aW9ucyB0byBwcmUtY29tcHV0ZSAqL1xuICAgICAgICB2YXIgYnBjID0gZ2ZwLm91dF9zYW1wbGVyYXRlXG4gICAgICAgICAgICAvIGdjZChnZnAub3V0X3NhbXBsZXJhdGUsIGdmcC5pbl9zYW1wbGVyYXRlKTtcbiAgICAgICAgaWYgKGJwYyA+IExhbWVJbnRlcm5hbEZsYWdzLkJQQylcbiAgICAgICAgICAgIGJwYyA9IExhbWVJbnRlcm5hbEZsYWdzLkJQQztcblxuICAgICAgICB2YXIgaW50cmF0aW8gPSAoTWF0aC5hYnMoZ2ZjLnJlc2FtcGxlX3JhdGlvXG4gICAgICAgICAgICAtIE1hdGguZmxvb3IoLjUgKyBnZmMucmVzYW1wbGVfcmF0aW8pKSA8IC4wMDAxKSA/IDEgOiAwO1xuICAgICAgICB2YXIgZmNuID0gMS4wMCAvIGdmYy5yZXNhbXBsZV9yYXRpbztcbiAgICAgICAgaWYgKGZjbiA+IDEuMDApXG4gICAgICAgICAgICBmY24gPSAxLjAwO1xuICAgICAgICB2YXIgZmlsdGVyX2wgPSAzMTtcbiAgICAgICAgaWYgKDAgPT0gZmlsdGVyX2wgJSAyKVxuICAgICAgICAgICAgLS1maWx0ZXJfbDtcbiAgICAgICAgLyogbXVzdCBiZSBvZGQgKi9cbiAgICAgICAgZmlsdGVyX2wgKz0gaW50cmF0aW87XG4gICAgICAgIC8qIHVubGVzcyByZXNhbXBsZV9yYXRpbz1pbnQsIGl0IG11c3QgYmUgZXZlbiAqL1xuXG4gICAgICAgIHZhciBCTEFDS1NJWkUgPSBmaWx0ZXJfbCArIDE7XG4gICAgICAgIC8qIHNpemUgb2YgZGF0YSBuZWVkZWQgZm9yIEZJUiAqL1xuXG4gICAgICAgIGlmIChnZmMuZmlsbF9idWZmZXJfcmVzYW1wbGVfaW5pdCA9PSAwKSB7XG4gICAgICAgICAgICBnZmMuaW5idWZfb2xkWzBdID0gbmV3X2Zsb2F0KEJMQUNLU0laRSk7XG4gICAgICAgICAgICBnZmMuaW5idWZfb2xkWzFdID0gbmV3X2Zsb2F0KEJMQUNLU0laRSk7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDw9IDIgKiBicGM7ICsraSlcbiAgICAgICAgICAgICAgICBnZmMuYmxhY2tmaWx0W2ldID0gbmV3X2Zsb2F0KEJMQUNLU0laRSk7XG5cbiAgICAgICAgICAgIGdmYy5pdGltZVswXSA9IDA7XG4gICAgICAgICAgICBnZmMuaXRpbWVbMV0gPSAwO1xuXG4gICAgICAgICAgICAvKiBwcmVjb21wdXRlIGJsYWNrbWFuIGZpbHRlciBjb2VmZmljaWVudHMgKi9cbiAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPD0gMiAqIGJwYzsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN1bSA9IDAuO1xuICAgICAgICAgICAgICAgIHZhciBvZmZzZXQgPSAoaiAtIGJwYykgLyAoMi4gKiBicGMpO1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPD0gZmlsdGVyX2w7IGkrKylcbiAgICAgICAgICAgICAgICAgICAgc3VtICs9IGdmYy5ibGFja2ZpbHRbal1baV0gPSBibGFja21hbihpIC0gb2Zmc2V0LCBmY24sXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXJfbCk7XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8PSBmaWx0ZXJfbDsgaSsrKVxuICAgICAgICAgICAgICAgICAgICBnZmMuYmxhY2tmaWx0W2pdW2ldIC89IHN1bTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy5maWxsX2J1ZmZlcl9yZXNhbXBsZV9pbml0ID0gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBpbmJ1Zl9vbGQgPSBnZmMuaW5idWZfb2xkW2NoXTtcblxuICAgICAgICAvKiB0aW1lIG9mIGondGggZWxlbWVudCBpbiBpbmJ1ZiA9IGl0aW1lICsgai9pZnJlcTsgKi9cbiAgICAgICAgLyogdGltZSBvZiBrJ3RoIGVsZW1lbnQgaW4gb3V0YnVmID0gai9vZnJlcSAqL1xuICAgICAgICBmb3IgKGsgPSAwOyBrIDwgZGVzaXJlZF9sZW47IGsrKykge1xuICAgICAgICAgICAgdmFyIHRpbWUwO1xuICAgICAgICAgICAgdmFyIGpvZmY7XG5cbiAgICAgICAgICAgIHRpbWUwID0gayAqIGdmYy5yZXNhbXBsZV9yYXRpbztcbiAgICAgICAgICAgIC8qIHRpbWUgb2Ygayd0aCBvdXRwdXQgc2FtcGxlICovXG4gICAgICAgICAgICBqID0gMCB8IE1hdGguZmxvb3IodGltZTAgLSBnZmMuaXRpbWVbY2hdKTtcblxuICAgICAgICAgICAgLyogY2hlY2sgaWYgd2UgbmVlZCBtb3JlIGlucHV0IGRhdGEgKi9cbiAgICAgICAgICAgIGlmICgoZmlsdGVyX2wgKyBqIC0gZmlsdGVyX2wgLyAyKSA+PSBsZW4pXG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIC8qIGJsYWNrbWFuIGZpbHRlci4gYnkgZGVmYXVsdCwgd2luZG93IGNlbnRlcmVkIGF0IGorLjUoZmlsdGVyX2wlMikgKi9cbiAgICAgICAgICAgIC8qIGJ1dCB3ZSB3YW50IGEgd2luZG93IGNlbnRlcmVkIGF0IHRpbWUwLiAqL1xuICAgICAgICAgICAgdmFyIG9mZnNldCA9ICh0aW1lMCAtIGdmYy5pdGltZVtjaF0gLSAoaiArIC41ICogKGZpbHRlcl9sICUgMikpKTtcblxuICAgICAgICAgICAgLyogZmluZCB0aGUgY2xvc2VzdCBwcmVjb21wdXRlZCB3aW5kb3cgZm9yIHRoaXMgb2Zmc2V0OiAqL1xuICAgICAgICAgICAgam9mZiA9IDAgfCBNYXRoLmZsb29yKChvZmZzZXQgKiAyICogYnBjKSArIGJwYyArIC41KTtcbiAgICAgICAgICAgIHZhciB4dmFsdWUgPSAwLjtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPD0gZmlsdGVyX2w7ICsraSkge1xuICAgICAgICAgICAgICAgIHZhciBqMiA9IGkgKyBqIC0gZmlsdGVyX2wgLyAyO1xuICAgICAgICAgICAgICAgIHZhciB5O1xuICAgICAgICAgICAgICAgIHkgPSAoajIgPCAwKSA/IGluYnVmX29sZFtCTEFDS1NJWkUgKyBqMl0gOiBpbmJ1Zltpbl9idWZmZXJQb3NcbiAgICAgICAgICAgICAgICArIGoyXTtcbiAgICAgICAgICAgICAgICB4dmFsdWUgKz0geSAqIGdmYy5ibGFja2ZpbHRbam9mZl1baV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBvdXRidWZbb3V0YnVmUG9zICsga10gPSB4dmFsdWU7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBrID0gbnVtYmVyIG9mIHNhbXBsZXMgYWRkZWQgdG8gb3V0YnVmICovXG4gICAgICAgIC8qIGxhc3QgayBzYW1wbGUgdXNlZCBkYXRhIGZyb20gW2otZmlsdGVyX2wvMixqK2ZpbHRlcl9sLWZpbHRlcl9sLzJdICovXG5cbiAgICAgICAgLyogaG93IG1hbnkgc2FtcGxlcyBvZiBpbnB1dCBkYXRhIHdlcmUgdXNlZDogKi9cbiAgICAgICAgbnVtX3VzZWQubnVtX3VzZWQgPSBNYXRoLm1pbihsZW4sIGZpbHRlcl9sICsgaiAtIGZpbHRlcl9sIC8gMik7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogYWRqdXN0IG91ciBpbnB1dCB0aW1lIGNvdW50ZXIuIEluY3JpbWVudCBieSB0aGUgbnVtYmVyIG9mIHNhbXBsZXNcbiAgICAgICAgICogdXNlZCwgdGhlbiBub3JtYWxpemUgc28gdGhhdCBuZXh0IG91dHB1dCBzYW1wbGUgaXMgYXQgdGltZSAwLCBuZXh0XG4gICAgICAgICAqIGlucHV0IGJ1ZmZlciBpcyBhdCB0aW1lIGl0aW1lW2NoXVxuICAgICAgICAgKi9cbiAgICAgICAgZ2ZjLml0aW1lW2NoXSArPSBudW1fdXNlZC5udW1fdXNlZCAtIGsgKiBnZmMucmVzYW1wbGVfcmF0aW87XG5cbiAgICAgICAgLyogc2F2ZSB0aGUgbGFzdCBCTEFDS1NJWkUgc2FtcGxlcyBpbnRvIHRoZSBpbmJ1Zl9vbGQgYnVmZmVyICovXG4gICAgICAgIGlmIChudW1fdXNlZC5udW1fdXNlZCA+PSBCTEFDS1NJWkUpIHtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBCTEFDS1NJWkU7IGkrKylcbiAgICAgICAgICAgICAgICBpbmJ1Zl9vbGRbaV0gPSBpbmJ1Zltpbl9idWZmZXJQb3MgKyBudW1fdXNlZC5udW1fdXNlZCArIGlcbiAgICAgICAgICAgICAgICAtIEJMQUNLU0laRV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvKiBzaGlmdCBpbiBudW1fdXNlZC5udW1fdXNlZCBzYW1wbGVzIGludG8gaW5idWZfb2xkICovXG4gICAgICAgICAgICB2YXIgbl9zaGlmdCA9IEJMQUNLU0laRSAtIG51bV91c2VkLm51bV91c2VkO1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIG51bWJlciBvZiBzYW1wbGVzIHRvXG4gICAgICAgICAgICAgKiBzaGlmdFxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBzaGlmdCBuX3NoaWZ0IHNhbXBsZXMgYnkgbnVtX3VzZWQubnVtX3VzZWQsIHRvIG1ha2Ugcm9vbSBmb3IgdGhlXG4gICAgICAgICAgICAgKiBudW1fdXNlZCBuZXcgc2FtcGxlc1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbl9zaGlmdDsgKytpKVxuICAgICAgICAgICAgICAgIGluYnVmX29sZFtpXSA9IGluYnVmX29sZFtpICsgbnVtX3VzZWQubnVtX3VzZWRdO1xuXG4gICAgICAgICAgICAvKiBzaGlmdCBpbiB0aGUgbnVtX3VzZWQubnVtX3VzZWQgc2FtcGxlcyAqL1xuICAgICAgICAgICAgZm9yIChqID0gMDsgaSA8IEJMQUNLU0laRTsgKytpLCArK2opXG4gICAgICAgICAgICAgICAgaW5idWZfb2xkW2ldID0gaW5idWZbaW5fYnVmZmVyUG9zICsgal07XG5cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaztcbiAgICAgICAgLyogcmV0dXJuIHRoZSBudW1iZXIgc2FtcGxlcyBjcmVhdGVkIGF0IHRoZSBuZXcgc2FtcGxlcmF0ZSAqL1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZpbGxfYnVmZmVyKGdmcCwgbWZidWYsIGluX2J1ZmZlciwgaW5fYnVmZmVyUG9zLCBuc2FtcGxlcywgaW8pIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblxuICAgICAgICAvKiBjb3B5IGluIG5ldyBzYW1wbGVzIGludG8gbWZidWYsIHdpdGggcmVzYW1wbGluZyBpZiBuZWNlc3NhcnkgKi9cbiAgICAgICAgaWYgKChnZmMucmVzYW1wbGVfcmF0aW8gPCAuOTk5OSkgfHwgKGdmYy5yZXNhbXBsZV9yYXRpbyA+IDEuMDAwMSkpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIG51bVVzZWQgPSBuZXcgTnVtVXNlZCgpO1xuICAgICAgICAgICAgICAgIGlvLm5fb3V0ID0gZmlsbF9idWZmZXJfcmVzYW1wbGUoZ2ZwLCBtZmJ1ZltjaF0sIGdmYy5tZl9zaXplLFxuICAgICAgICAgICAgICAgICAgICBnZnAuZnJhbWVzaXplLCBpbl9idWZmZXJbY2hdLCBpbl9idWZmZXJQb3MsIG5zYW1wbGVzLFxuICAgICAgICAgICAgICAgICAgICBudW1Vc2VkLCBjaCk7XG4gICAgICAgICAgICAgICAgaW8ubl9pbiA9IG51bVVzZWQubnVtX3VzZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpby5uX291dCA9IE1hdGgubWluKGdmcC5mcmFtZXNpemUsIG5zYW1wbGVzKTtcbiAgICAgICAgICAgIGlvLm5faW4gPSBpby5uX291dDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW8ubl9vdXQ7ICsraSkge1xuICAgICAgICAgICAgICAgIG1mYnVmWzBdW2dmYy5tZl9zaXplICsgaV0gPSBpbl9idWZmZXJbMF1baW5fYnVmZmVyUG9zICsgaV07XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5jaGFubmVsc19vdXQgPT0gMilcbiAgICAgICAgICAgICAgICAgICAgbWZidWZbMV1bZ2ZjLm1mX3NpemUgKyBpXSA9IGluX2J1ZmZlclsxXVtpbl9idWZmZXJQb3MgKyBpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufVxuXG5cblxuZnVuY3Rpb24gR2V0QXVkaW8oKSB7XG4gICAgdmFyIHBhcnNlO1xuICAgIHZhciBtcGc7XG5cbiAgICB0aGlzLnNldE1vZHVsZXMgPSBmdW5jdGlvbiAocGFyc2UyLCBtcGcyKSB7XG4gICAgICAgIHBhcnNlID0gcGFyc2UyO1xuICAgICAgICBtcGcgPSBtcGcyO1xuICAgIH1cbn1cblxuXG5mdW5jdGlvbiBQYXJzZSgpIHtcbiAgICB2YXIgdmVyO1xuICAgIHZhciBpZDM7XG4gICAgdmFyIHByZTtcblxuICAgIHRoaXMuc2V0TW9kdWxlcyA9IGZ1bmN0aW9uICh2ZXIyLCBpZDMyLCBwcmUyKSB7XG4gICAgICAgIHZlciA9IHZlcjI7XG4gICAgICAgIGlkMyA9IGlkMzI7XG4gICAgICAgIHByZSA9IHByZTI7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBNUEdMaWIoKSB7XG59XG5cbmZ1bmN0aW9uIElEM1RhZygpIHtcbiAgICB2YXIgYml0cztcbiAgICB2YXIgdmVyO1xuXG4gICAgdGhpcy5zZXRNb2R1bGVzID0gZnVuY3Rpb24gKF9iaXRzLCBfdmVyKSB7XG4gICAgICAgIGJpdHMgPSBfYml0cztcbiAgICAgICAgdmVyID0gX3ZlcjtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIE1wM0VuY29kZXIoY2hhbm5lbHMsIHNhbXBsZXJhdGUsIGticHMpIHtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCAhPSAzKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1dBUk46IE1wM0VuY29kZXIoY2hhbm5lbHMsIHNhbXBsZXJhdGUsIGticHMpIG5vdCBzcGVjaWZpZWQnKTtcbiAgICAgICAgY2hhbm5lbHMgPSAxO1xuICAgICAgICBzYW1wbGVyYXRlID0gNDQxMDA7XG4gICAgICAgIGticHMgPSAxMjg7XG4gICAgfVxuICAgIHZhciBsYW1lID0gbmV3IExhbWUoKTtcbiAgICB2YXIgZ2F1ZCA9IG5ldyBHZXRBdWRpbygpO1xuICAgIHZhciBnYSA9IG5ldyBHYWluQW5hbHlzaXMoKTtcbiAgICB2YXIgYnMgPSBuZXcgQml0U3RyZWFtKCk7XG4gICAgdmFyIHAgPSBuZXcgUHJlc2V0cygpO1xuICAgIHZhciBxdXB2dCA9IG5ldyBRdWFudGl6ZVBWVCgpO1xuICAgIHZhciBxdSA9IG5ldyBRdWFudGl6ZSgpO1xuICAgIHZhciB2YnIgPSBuZXcgVkJSVGFnKCk7XG4gICAgdmFyIHZlciA9IG5ldyBWZXJzaW9uKCk7XG4gICAgdmFyIGlkMyA9IG5ldyBJRDNUYWcoKTtcbiAgICB2YXIgcnYgPSBuZXcgUmVzZXJ2b2lyKCk7XG4gICAgdmFyIHRhayA9IG5ldyBUYWtlaGlybygpO1xuICAgIHZhciBwYXJzZSA9IG5ldyBQYXJzZSgpO1xuICAgIHZhciBtcGcgPSBuZXcgTVBHTGliKCk7XG5cbiAgICBsYW1lLnNldE1vZHVsZXMoZ2EsIGJzLCBwLCBxdXB2dCwgcXUsIHZiciwgdmVyLCBpZDMsIG1wZyk7XG4gICAgYnMuc2V0TW9kdWxlcyhnYSwgbXBnLCB2ZXIsIHZicik7XG4gICAgaWQzLnNldE1vZHVsZXMoYnMsIHZlcik7XG4gICAgcC5zZXRNb2R1bGVzKGxhbWUpO1xuICAgIHF1LnNldE1vZHVsZXMoYnMsIHJ2LCBxdXB2dCwgdGFrKTtcbiAgICBxdXB2dC5zZXRNb2R1bGVzKHRhaywgcnYsIGxhbWUuZW5jLnBzeSk7XG4gICAgcnYuc2V0TW9kdWxlcyhicyk7XG4gICAgdGFrLnNldE1vZHVsZXMocXVwdnQpO1xuICAgIHZici5zZXRNb2R1bGVzKGxhbWUsIGJzLCB2ZXIpO1xuICAgIGdhdWQuc2V0TW9kdWxlcyhwYXJzZSwgbXBnKTtcbiAgICBwYXJzZS5zZXRNb2R1bGVzKHZlciwgaWQzLCBwKTtcblxuICAgIHZhciBnZnAgPSBsYW1lLmxhbWVfaW5pdCgpO1xuXG4gICAgZ2ZwLm51bV9jaGFubmVscyA9IGNoYW5uZWxzO1xuICAgIGdmcC5pbl9zYW1wbGVyYXRlID0gc2FtcGxlcmF0ZTtcbiAgICBnZnAub3V0X3NhbXBsZXJhdGUgPSBzYW1wbGVyYXRlOy8vZml4IGJ5IHhpYW5neXVlY24gMjAxOC0xMi02IDAxOjQ4OjEyIDY0a2Jwc+S7peS4i+WPr+iDveaXoOWjsOmfs++8jOaJi+WKqOaOp+WItui+k+WHuueggeeOh1xuICAgIGdmcC5icmF0ZSA9IGticHM7XG4gICAgZ2ZwLm1vZGUgPSBNUEVHTW9kZS5TVEVSRU87XG4gICAgZ2ZwLnF1YWxpdHkgPSAzO1xuICAgIGdmcC5iV3JpdGVWYnJUYWcgPSBmYWxzZTtcbiAgICBnZnAuZGlzYWJsZV9yZXNlcnZvaXIgPSB0cnVlO1xuICAgIGdmcC53cml0ZV9pZDN0YWdfYXV0b21hdGljID0gZmFsc2U7XG5cbiAgICB2YXIgcmV0Y29kZSA9IGxhbWUubGFtZV9pbml0X3BhcmFtcyhnZnApO1xuICAgIHZhciBtYXhTYW1wbGVzID0gMTE1MjtcbiAgICB2YXIgbXAzYnVmX3NpemUgPSAwIHwgKDEuMjUgKiBtYXhTYW1wbGVzICsgNzIwMCk7XG4gICAgdmFyIG1wM2J1ZiA9IG5ld19ieXRlKG1wM2J1Zl9zaXplKTtcblxuICAgIHRoaXMuZW5jb2RlQnVmZmVyID0gZnVuY3Rpb24gKGxlZnQsIHJpZ2h0KSB7XG4gICAgICAgIGlmIChjaGFubmVscyA9PSAxKSB7XG4gICAgICAgICAgICByaWdodCA9IGxlZnQ7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGxlZnQubGVuZ3RoID4gbWF4U2FtcGxlcykge1xuICAgICAgICAgICAgbWF4U2FtcGxlcyA9IGxlZnQubGVuZ3RoO1xuICAgICAgICAgICAgbXAzYnVmX3NpemUgPSAwIHwgKDEuMjUgKiBtYXhTYW1wbGVzICsgNzIwMCk7XG4gICAgICAgICAgICBtcDNidWYgPSBuZXdfYnl0ZShtcDNidWZfc2l6ZSk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgX3N6ID0gbGFtZS5sYW1lX2VuY29kZV9idWZmZXIoZ2ZwLCBsZWZ0LCByaWdodCwgbGVmdC5sZW5ndGgsIG1wM2J1ZiwgMCwgbXAzYnVmX3NpemUpO1xuICAgICAgICByZXR1cm4gbmV3IEludDhBcnJheShtcDNidWYuc3ViYXJyYXkoMCwgX3N6KSk7XG4gICAgfTtcblxuICAgIHRoaXMuZmx1c2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfc3ogPSBsYW1lLmxhbWVfZW5jb2RlX2ZsdXNoKGdmcCwgbXAzYnVmLCAwLCBtcDNidWZfc2l6ZSk7XG4gICAgICAgIHJldHVybiBuZXcgSW50OEFycmF5KG1wM2J1Zi5zdWJhcnJheSgwLCBfc3opKTtcbiAgICB9O1xufVxuXG4vL2ZpeCDnsr7nroBcbkwzU2lkZS5TRkJNQVggPSAoRW5jb2Rlci5TQk1BWF9zICogMyk7XG4vL3Rlc3RGdWxsTGVuZ3RoKCk7XG5sYW1lanMuTXAzRW5jb2RlciA9IE1wM0VuY29kZXI7XG59XG4vL2ZzPXJlcXVpcmUoJ2ZzJyk7XG5sYW1lanMoKTtcblxuXG5SZWNvcmRlci5sYW1lanM9bGFtZWpzO1xuXG4vL2VuZDMgKioqKue7k+adn2NvcHkgbGFtZWpzKioqKipcbn0pKCk7IiwiLypcbm1wM+e8lueggeWZqO+8jOmcgOW4puS4im1wMy1lbmdpbmUuanPlvJXmk47kvb/nlKhcbmh0dHBzOi8vZ2l0aHViLmNvbS94aWFuZ3l1ZWNuL1JlY29yZGVyXG5cbuW9k+eEtuacgOS9s+aOqOiNkOS9v+eUqG1wM+OAgXdhduagvOW8j++8jOS7o+eggeS5n+aYr+S8mOWFiOeFp+mhvui/meS4pOenjeagvOW8j1xu5rWP6KeI5Zmo5pSv5oyB5oOF5Ya1XG5odHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9IVE1ML1N1cHBvcnRlZF9tZWRpYV9mb3JtYXRzXG4qL1xuKGZ1bmN0aW9uKCl7XG5cInVzZSBzdHJpY3RcIjtcblxuUmVjb3JkZXIucHJvdG90eXBlLmVuY19tcDM9e1xuXHRzdGFibGU6dHJ1ZVxuXHQsdGVzdG1zZzpcIumHh+agt+eOh+iMg+WbtDQ4MDAwLCA0NDEwMCwgMzIwMDAsIDI0MDAwLCAyMjA1MCwgMTYwMDAsIDEyMDAwLCAxMTAyNSwgODAwMFwiXG59O1xuXG5cblxuLy8qKioqKioq5qCH5YeGVUnnur/nqIvovaznoIHmlK/mjIHlh73mlbAqKioqKioqKioqKipcblxuUmVjb3JkZXIucHJvdG90eXBlLm1wMz1mdW5jdGlvbihyZXMsVHJ1ZSxGYWxzZSl7XG5cdFx0dmFyIFRoaXM9dGhpcyxzZXQ9VGhpcy5zZXQsc2l6ZT1yZXMubGVuZ3RoO1xuXHRcdFxuXHRcdC8v5LyY5YWI6YeH55Sod29ya2Vy57yW56CB77yM5aSq5L2O54mI5pys5LiL6Z2i55So6ICB5pa55rOV5o+Q5L6b5YW85a65XG5cdFx0dmFyIGN0eD1UaGlzLm1wM19zdGFydChzZXQpO1xuXHRcdGlmKGN0eCl7XG5cdFx0XHRUaGlzLm1wM19lbmNvZGUoY3R4LHJlcyk7XG5cdFx0XHRUaGlzLm1wM19jb21wbGV0ZShjdHgsVHJ1ZSxGYWxzZSwxKTtcblx0XHRcdHJldHVybjtcblx0XHR9O1xuXHRcdFxuXHRcdC8vaHR0cHM6Ly9naXRodWIuY29tL3dhbmdwZW5nZmVpMTU5NzUvcmVjb3JkZXIuanNcblx0XHQvL2h0dHBzOi8vZ2l0aHViLmNvbS96aHVrZXIvbGFtZWpzIGJ1Zzrph4fmoLfnjoflv4XpobvlkozmupDkuIDoh7TvvIzkuI3nhLY4a+aXtuayoeacieWjsOmfs++8jOaciemXrumimGZpeO+8mmh0dHBzOi8vZ2l0aHViLmNvbS96aHVrZXIvbGFtZWpzL3B1bGwvMTFcblx0XHR2YXIgbXAzPW5ldyBSZWNvcmRlci5sYW1lanMuTXAzRW5jb2RlcigxLHNldC5zYW1wbGVSYXRlLHNldC5iaXRSYXRlKTtcblx0XHRcblx0XHR2YXIgYmxvY2tTaXplPTU3NjAwO1xuXHRcdHZhciBkYXRhPVtdO1xuXHRcdFxuXHRcdHZhciBpZHg9MCxtcDNTaXplPTA7XG5cdFx0dmFyIHJ1bj1mdW5jdGlvbigpe1xuXHRcdFx0aWYoaWR4PHNpemUpe1xuXHRcdFx0XHR2YXIgYnVmPW1wMy5lbmNvZGVCdWZmZXIocmVzLnN1YmFycmF5KGlkeCxpZHgrYmxvY2tTaXplKSk7XG5cdFx0XHRcdGlmKGJ1Zi5sZW5ndGg+MCl7XG5cdFx0XHRcdFx0bXAzU2l6ZSs9YnVmLmJ1ZmZlci5ieXRlTGVuZ3RoO1xuXHRcdFx0XHRcdGRhdGEucHVzaChidWYuYnVmZmVyKTtcblx0XHRcdFx0fTtcblx0XHRcdFx0aWR4Kz1ibG9ja1NpemU7XG5cdFx0XHRcdHNldFRpbWVvdXQocnVuKTsvL+WwvemHj+mBv+WFjeWNoXVpXG5cdFx0XHR9ZWxzZXtcblx0XHRcdFx0dmFyIGJ1Zj1tcDMuZmx1c2goKTtcblx0XHRcdFx0aWYoYnVmLmxlbmd0aD4wKXtcblx0XHRcdFx0XHRtcDNTaXplKz1idWYuYnVmZmVyLmJ5dGVMZW5ndGg7XG5cdFx0XHRcdFx0ZGF0YS5wdXNoKGJ1Zi5idWZmZXIpO1xuXHRcdFx0XHR9O1xuXHRcdFx0XHRcblx0XHRcdFx0Ly/ljrvmjonlvIDlpLTnmoTmoIforrDkv6Hmga/luKdcblx0XHRcdFx0dmFyIG1ldGE9bXAzVHJpbUZpeC5mbihkYXRhLG1wM1NpemUsc2l6ZSxzZXQuc2FtcGxlUmF0ZSk7XG5cdFx0XHRcdG1wM1RyaW1GaXhTZXRNZXRhKG1ldGEsc2V0KTtcblx0XHRcdFx0XG5cdFx0XHRcdFRydWUobmV3IEJsb2IoZGF0YSx7dHlwZTpcImF1ZGlvL21wM1wifSkpO1xuXHRcdFx0fTtcblx0XHR9O1xuXHRcdHJ1bigpO1xuXHR9XG5cblxuLy8qKioqKioqKui+ueW9lei+uei9rOeggShXb3JrZXIp5pSv5oyB5Ye95pWw77yM5aaC5p6c5o+Q5L6b5bCx5Luj6KGo5Y+v6IO95pSv5oyB77yM5ZCm5YiZ5Y+q5pSv5oyB5qCH5YeG6L2s56CBKioqKioqKioqXG5cbi8v5YWo5bGA5YWx5Lqr5LiA5LiqV29ya2Vy77yM5ZCO5Y+w5Liy6KGM5omn6KGM44CC5aaC5p6c5q+P5qyh6YO95byA5LiA5Liq5paw55qE77yM57yW56CB6YCf5bqm5Y+v6IO95Lya5oWi5b6I5aSa77yM5Y+v6IO95piv5rWP6KeI5Zmo6L+Q6KGM57yT5a2Y55qE5Zug57Sg77yM5bm25LiU5Y+v6IO9556s6Ze05Lqn55Sf5aSa5Liq5bm26KGM5pON5L2c5Y2g55So5aSn6YePY3B1XG52YXIgbXAzV29ya2VyO1xuUmVjb3JkZXIuQmluZERlc3Ryb3koXCJtcDNXb3JrZXJcIixmdW5jdGlvbigpe1xuXHRjb25zb2xlLmxvZyhcIm1wM1dvcmtlciBEZXN0cm95XCIpO1xuXHRtcDNXb3JrZXImJm1wM1dvcmtlci50ZXJtaW5hdGUoKTtcblx0bXAzV29ya2VyPW51bGw7XG59KTtcblxuXG5SZWNvcmRlci5wcm90b3R5cGUubXAzX2VudkNoZWNrPWZ1bmN0aW9uKGVudkluZm8sc2V0KXsvL+ajgOafpeeOr+Wig+S4i+mFjee9ruaYr+WQpuWPr+eUqFxuXHR2YXIgZXJyTXNnPVwiXCI7XG5cdC8v6ZyA6KaB5a6e5pe257yW56CB6L+U5Zue5pWw5o2u77yM5q2k5pe26ZyA6KaB5qOA5p+l546v5aKD5piv5ZCm5pyJ5a6e5pe254m55oCn44CB5ZKM5piv5ZCm5Y+v5a6e5pe257yW56CBXG5cdGlmKHNldC50YWtlb2ZmRW5jb2RlQ2h1bmspe1xuXHRcdGlmKCFlbnZJbmZvLmNhblByb2Nlc3Mpe1xuXHRcdFx0ZXJyTXNnPWVudkluZm8uZW52TmFtZStcIueOr+Wig+S4jeaUr+aMgeWunuaXtuWkhOeQhlwiO1xuXHRcdH1lbHNlIGlmKCFuZXdDb250ZXh0KCkpey8v5rWP6KeI5Zmo5LiN6IO95Yib5bu65a6e5pe257yW56CB546v5aKDXG5cdFx0XHRlcnJNc2c9XCLlvZPliY3mtY/op4jlmajniYjmnKzlpKrkvY7vvIzml6Dms5Xlrp7ml7blpITnkIZcIjtcblx0XHR9O1xuXHR9O1xuXHRyZXR1cm4gZXJyTXNnO1xufTtcblJlY29yZGVyLnByb3RvdHlwZS5tcDNfc3RhcnQ9ZnVuY3Rpb24oc2V0KXsvL+WmguaenOi/lOWbnm51bGzku6PooajkuI3mlK/mjIFcblx0cmV0dXJuIG5ld0NvbnRleHQoc2V0KTtcbn07XG52YXIgb3Blbkxpc3Q9e2lkOjB9O1xudmFyIG5ld0NvbnRleHQ9ZnVuY3Rpb24oc2V0T3JOdWxsKXtcblx0dmFyIHdvcmtlcj1tcDNXb3JrZXI7XG5cdHRyeXtcblx0XHRpZighd29ya2VyKXtcblx0XHRcdHZhciBvbm1zZz1mdW5jdGlvbihlKXtcblx0XHRcdFx0dmFyIGVkPWUuZGF0YTtcblx0XHRcdFx0dmFyIGN1cj13a19jdHhzW2VkLmlkXTtcblx0XHRcdFx0aWYoZWQuYWN0aW9uPT1cImluaXRcIil7XG5cdFx0XHRcdFx0d2tfY3R4c1tlZC5pZF09e1xuXHRcdFx0XHRcdFx0c2FtcGxlUmF0ZTplZC5zYW1wbGVSYXRlXG5cdFx0XHRcdFx0XHQsYml0UmF0ZTplZC5iaXRSYXRlXG5cdFx0XHRcdFx0XHQsdGFrZW9mZjplZC50YWtlb2ZmXG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdCxtcDNTaXplOjBcblx0XHRcdFx0XHRcdCxwY21TaXplOjBcblx0XHRcdFx0XHRcdCxlbmNBcnI6W11cblx0XHRcdFx0XHRcdCxlbmNPYmo6bmV3IHdrX2xhbWUuTXAzRW5jb2RlcigxLGVkLnNhbXBsZVJhdGUsZWQuYml0UmF0ZSlcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9ZWxzZSBpZighY3VyKXtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH07XG5cdFx0XHRcdFxuXHRcdFx0XHRzd2l0Y2goZWQuYWN0aW9uKXtcblx0XHRcdFx0Y2FzZSBcInN0b3BcIjpcblx0XHRcdFx0XHRjdXIuZW5jT2JqPW51bGw7XG5cdFx0XHRcdFx0ZGVsZXRlIHdrX2N0eHNbZWQuaWRdO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwiZW5jb2RlXCI6XG5cdFx0XHRcdFx0Y3VyLnBjbVNpemUrPWVkLnBjbS5sZW5ndGg7XG5cdFx0XHRcdFx0dmFyIGJ1Zj1jdXIuZW5jT2JqLmVuY29kZUJ1ZmZlcihlZC5wY20pO1xuXHRcdFx0XHRcdGlmKGJ1Zi5sZW5ndGg+MCl7XG5cdFx0XHRcdFx0XHRpZihjdXIudGFrZW9mZil7XG5cdFx0XHRcdFx0XHRcdHNlbGYucG9zdE1lc3NhZ2Uoe2FjdGlvbjpcInRha2VvZmZcIixpZDplZC5pZCxjaHVuazpidWZ9KTtcblx0XHRcdFx0XHRcdH1lbHNle1xuXHRcdFx0XHRcdFx0XHRjdXIubXAzU2l6ZSs9YnVmLmJ1ZmZlci5ieXRlTGVuZ3RoO1xuXHRcdFx0XHRcdFx0XHRjdXIuZW5jQXJyLnB1c2goYnVmLmJ1ZmZlcik7XG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJjb21wbGV0ZVwiOlxuXHRcdFx0XHRcdHZhciBidWY9Y3VyLmVuY09iai5mbHVzaCgpO1xuXHRcdFx0XHRcdGlmKGJ1Zi5sZW5ndGg+MCl7XG5cdFx0XHRcdFx0XHRpZihjdXIudGFrZW9mZil7XG5cdFx0XHRcdFx0XHRcdHNlbGYucG9zdE1lc3NhZ2Uoe2FjdGlvbjpcInRha2VvZmZcIixpZDplZC5pZCxjaHVuazpidWZ9KTtcblx0XHRcdFx0XHRcdH1lbHNle1xuXHRcdFx0XHRcdFx0XHRjdXIubXAzU2l6ZSs9YnVmLmJ1ZmZlci5ieXRlTGVuZ3RoO1xuXHRcdFx0XHRcdFx0XHRjdXIuZW5jQXJyLnB1c2goYnVmLmJ1ZmZlcik7XG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly/ljrvmjonlvIDlpLTnmoTmoIforrDkv6Hmga/luKdcblx0XHRcdFx0XHR2YXIgbWV0YT13a19tcDNUcmltRml4LmZuKGN1ci5lbmNBcnIsY3VyLm1wM1NpemUsY3VyLnBjbVNpemUsY3VyLnNhbXBsZVJhdGUpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHNlbGYucG9zdE1lc3NhZ2Uoe1xuXHRcdFx0XHRcdFx0YWN0aW9uOmVkLmFjdGlvblxuXHRcdFx0XHRcdFx0LGlkOmVkLmlkXG5cdFx0XHRcdFx0XHQsYmxvYjpuZXcgQmxvYihjdXIuZW5jQXJyLHt0eXBlOlwiYXVkaW8vbXAzXCJ9KVxuXHRcdFx0XHRcdFx0LG1ldGE6bWV0YVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHR9O1xuXHRcdFx0fTtcblx0XHRcdFxuXHRcdFx0Ly/liJvlu7rkuIDkuKrmlrBXb3JrZXJcblx0XHRcdHZhciBqc0NvZGU9XCIpO3drX2xhbWUoKTt2YXIgd2tfY3R4cz17fTtzZWxmLm9ubWVzc2FnZT1cIitvbm1zZztcblx0XHRcdGpzQ29kZSs9XCI7dmFyIHdrX21wM1RyaW1GaXg9e3JtOlwiK21wM1RyaW1GaXgucm0rXCIsZm46XCIrbXAzVHJpbUZpeC5mbitcIn1cIjtcblx0XHRcdFxuXHRcdFx0dmFyIGxhbWVqc0NvZGU9UmVjb3JkZXIubGFtZWpzLnRvU3RyaW5nKCk7XG5cdFx0XHR2YXIgdXJsPSh3aW5kb3cuVVJMfHx3ZWJraXRVUkwpLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYihbXCJ2YXIgd2tfbGFtZT0oXCIsbGFtZWpzQ29kZSxqc0NvZGVdLCB7dHlwZTpcInRleHQvamF2YXNjcmlwdFwifSkpO1xuXHRcdFx0XG5cdFx0XHR3b3JrZXI9bmV3IFdvcmtlcih1cmwpO1xuXHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpe1xuXHRcdFx0XHQod2luZG93LlVSTHx8d2Via2l0VVJMKS5yZXZva2VPYmplY3RVUkwodXJsKTsvL+W/hemhu+imgemHiuaUvu+8jOS4jeeEtuavj+asoeiwg+eUqOWGheWtmOmDveaYjuaYvuazhOmcsuWGheWtmFxuXHRcdFx0fSwxMDAwMCk7Ly9jaHJvbWUgODMgZmlsZeWNj+iuruS4i+WmguaenOebtOaOpemHiuaUvu+8jOWwhuS8muS9v1dlYldvcmtlcuaXoOazleWQr+WKqFxuXHRcdFx0XG5cdFx0XHR3b3JrZXIub25tZXNzYWdlPWZ1bmN0aW9uKGUpe1xuXHRcdFx0XHR2YXIgZGF0YT1lLmRhdGE7XG5cdFx0XHRcdHZhciBjdHg9b3Blbkxpc3RbZGF0YS5pZF07XG5cdFx0XHRcdGlmKGN0eCl7XG5cdFx0XHRcdFx0aWYoZGF0YS5hY3Rpb249PVwidGFrZW9mZlwiKXtcblx0XHRcdFx0XHRcdC8v5Y+W6LWw5a6e5pe255Sf5oiQ55qEbXAz5pWw5o2uXG5cdFx0XHRcdFx0XHRjdHguc2V0LnRha2VvZmZFbmNvZGVDaHVuayhuZXcgVWludDhBcnJheShkYXRhLmNodW5rLmJ1ZmZlcikpO1xuXHRcdFx0XHRcdH1lbHNle1xuXHRcdFx0XHRcdFx0Ly9jb21wbGV0ZVxuXHRcdFx0XHRcdFx0Y3R4LmNhbGwmJmN0eC5jYWxsKGRhdGEpO1xuXHRcdFx0XHRcdFx0Y3R4LmNhbGw9bnVsbDtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9O1xuXHRcdFx0fTtcblx0XHR9O1xuXHRcdFxuXHRcdHZhciBjdHg9e3dvcmtlcjp3b3JrZXIsc2V0OnNldE9yTnVsbCx0YWtlb2ZmUXVldWU6W119O1xuXHRcdGlmKHNldE9yTnVsbCl7XG5cdFx0XHRjdHguaWQ9KytvcGVuTGlzdC5pZDtcblx0XHRcdG9wZW5MaXN0W2N0eC5pZF09Y3R4O1xuXHRcdFx0XG5cdFx0XHR3b3JrZXIucG9zdE1lc3NhZ2Uoe1xuXHRcdFx0XHRhY3Rpb246XCJpbml0XCJcblx0XHRcdFx0LGlkOmN0eC5pZFxuXHRcdFx0XHQsc2FtcGxlUmF0ZTpzZXRPck51bGwuc2FtcGxlUmF0ZVxuXHRcdFx0XHQsYml0UmF0ZTpzZXRPck51bGwuYml0UmF0ZVxuXHRcdFx0XHQsdGFrZW9mZjohIXNldE9yTnVsbC50YWtlb2ZmRW5jb2RlQ2h1bmtcblx0XHRcdFx0XG5cdFx0XHRcdCx4Om5ldyBJbnQxNkFycmF5KDUpLy/kvY7niYjmnKzmtY/op4jlmajkuI3mlK/mjIHluo/liJfljJZUeXBlZEFycmF5XG5cdFx0XHR9KTtcblx0XHR9ZWxzZXtcblx0XHRcdHdvcmtlci5wb3N0TWVzc2FnZSh7XG5cdFx0XHRcdHg6bmV3IEludDE2QXJyYXkoNSkvL+S9jueJiOacrOa1j+iniOWZqOS4jeaUr+aMgeW6j+WIl+WMllR5cGVkQXJyYXlcblx0XHRcdH0pO1xuXHRcdH07XG5cdFx0XG5cdFx0XG5cdFx0bXAzV29ya2VyPXdvcmtlcjtcblx0XHRyZXR1cm4gY3R4O1xuXHR9Y2F0Y2goZSl7Ly/lh7rplJnkuoblsLHkuI3opoHmj5DkvpvkuoZcblx0XHR3b3JrZXImJndvcmtlci50ZXJtaW5hdGUoKTtcblx0XHRcblx0XHRjb25zb2xlLmVycm9yKGUpO1xuXHRcdHJldHVybiBudWxsO1xuXHR9O1xufTtcblJlY29yZGVyLnByb3RvdHlwZS5tcDNfc3RvcD1mdW5jdGlvbihzdGFydEN0eCl7XG5cdGlmKHN0YXJ0Q3R4JiZzdGFydEN0eC53b3JrZXIpe1xuXHRcdHN0YXJ0Q3R4Lndvcmtlci5wb3N0TWVzc2FnZSh7XG5cdFx0XHRhY3Rpb246XCJzdG9wXCJcblx0XHRcdCxpZDpzdGFydEN0eC5pZFxuXHRcdH0pO1xuXHRcdHN0YXJ0Q3R4Lndvcmtlcj1udWxsO1xuXHRcdGRlbGV0ZSBvcGVuTGlzdFtzdGFydEN0eC5pZF07XG5cdFx0XG5cdFx0Ly/nlpHkvLzms4TpnLLmo4DmtYsg5o6S6ZmkaWRcblx0XHR2YXIgb3BlbnM9LTE7XG5cdFx0Zm9yKHZhciBrIGluIG9wZW5MaXN0KXtcblx0XHRcdG9wZW5zKys7XG5cdFx0fTtcblx0XHRpZihvcGVucyl7XG5cdFx0XHRjb25zb2xlLndhcm4oXCJtcDMgd29ya2Vy5YmpXCIrb3BlbnMrXCLkuKrlnKjkuLLooYznrYnlvoVcIik7XG5cdFx0fTtcblx0fTtcbn07XG5SZWNvcmRlci5wcm90b3R5cGUubXAzX2VuY29kZT1mdW5jdGlvbihzdGFydEN0eCxwY20pe1xuXHRpZihzdGFydEN0eCYmc3RhcnRDdHgud29ya2VyKXtcblx0XHRzdGFydEN0eC53b3JrZXIucG9zdE1lc3NhZ2Uoe1xuXHRcdFx0YWN0aW9uOlwiZW5jb2RlXCJcblx0XHRcdCxpZDpzdGFydEN0eC5pZFxuXHRcdFx0LHBjbTpwY21cblx0XHR9KTtcblx0fTtcbn07XG5SZWNvcmRlci5wcm90b3R5cGUubXAzX2NvbXBsZXRlPWZ1bmN0aW9uKHN0YXJ0Q3R4LFRydWUsRmFsc2UsYXV0b1N0b3Ape1xuXHR2YXIgVGhpcz10aGlzO1xuXHRpZihzdGFydEN0eCYmc3RhcnRDdHgud29ya2VyKXtcblx0XHRzdGFydEN0eC5jYWxsPWZ1bmN0aW9uKGRhdGEpe1xuXHRcdFx0bXAzVHJpbUZpeFNldE1ldGEoZGF0YS5tZXRhLHN0YXJ0Q3R4LnNldCk7XG5cdFx0XHRUcnVlKGRhdGEuYmxvYik7XG5cdFx0XHRcblx0XHRcdGlmKGF1dG9TdG9wKXtcblx0XHRcdFx0VGhpcy5tcDNfc3RvcChzdGFydEN0eCk7XG5cdFx0XHR9O1xuXHRcdH07XG5cdFx0c3RhcnRDdHgud29ya2VyLnBvc3RNZXNzYWdlKHtcblx0XHRcdGFjdGlvbjpcImNvbXBsZXRlXCJcblx0XHRcdCxpZDpzdGFydEN0eC5pZFxuXHRcdH0pO1xuXHR9ZWxzZXtcblx0XHRGYWxzZShcIm1wM+e8lueggeWZqOacquaJk+W8gFwiKTtcblx0fTtcbn07XG5cblxuXG5cblxuXG5cbi8vKioqKioqKui+heWKqeWHveaVsCoqKioqKioqKioqKlxuXG4vKuivu+WPlmxhbWVqc+e8lueggeWHuuadpeeahG1wM+S/oeaBr++8jOWPquiDveivu+eJueWumuagvOW8j++8jOWmguaenOivu+WPluWksei0pei/lOWbnm51bGxcbm1wM0J1ZmZlcnM9W0FycmF5QnVmZmVyLC4uLl1cbmxlbmd0aD1tcDNCdWZmZXJz55qE5pWw5o2u5LqM6L+b5Yi25oC76ZW/5bqmXG4qL1xuUmVjb3JkZXIubXAzUmVhZE1ldGE9ZnVuY3Rpb24obXAzQnVmZmVycyxsZW5ndGgpe1xuXHQvL2tpbGwgYmFiZWwtcG9seWZpbGwgRVM2IE51bWJlci5wYXJzZUludCDkuI3nhLbmlL7liLBXb3JrZXLph4zpnaLmib7kuI3liLDmlrnms5Vcblx0dmFyIHBhcnNlSW50X0VTMz10eXBlb2Yod2luZG93KT09XCJvYmplY3RcIj93aW5kb3cucGFyc2VJbnQ6c2VsZi5wYXJzZUludDtcblx0XG5cdHZhciB1OGFycjA9bmV3IFVpbnQ4QXJyYXkobXAzQnVmZmVyc1swXXx8W10pO1xuXHRpZih1OGFycjAubGVuZ3RoPDQpe1xuXHRcdHJldHVybiBudWxsO1xuXHR9O1xuXHR2YXIgYnl0ZUF0PWZ1bmN0aW9uKGlkeCx1OCl7XG5cdFx0cmV0dXJuIChcIjAwMDAwMDBcIisoKHU4fHx1OGFycjApW2lkeF18fDApLnRvU3RyaW5nKDIpKS5zdWJzdHIoLTgpO1xuXHR9O1xuXHR2YXIgYjI9Ynl0ZUF0KDApK2J5dGVBdCgxKTtcblx0dmFyIGI0PWJ5dGVBdCgyKStieXRlQXQoMyk7XG5cdFxuXHRpZighL14xezExfS8udGVzdChiMikpey8v5pyq5Y+R546w5bin5ZCM5q2lXG5cdFx0cmV0dXJuIG51bGw7XG5cdH07XG5cdHZhciB2ZXJzaW9uPSh7XCIwMFwiOjIuNSxcIjEwXCI6MixcIjExXCI6MX0pW2IyLnN1YnN0cigxMSwyKV07XG5cdHZhciBsYXllcj0oe1wiMDFcIjozfSlbYjIuc3Vic3RyKDEzLDIpXTsvL+S7heaUr+aMgUxheWVyM1xuXHR2YXIgc2FtcGxlUmF0ZT0oeyAvL2xhbWVqcyAtPiBUYWJsZXMuc2FtcGxlcmF0ZV90YWJsZVxuXHRcdFwiMVwiOls0NDEwMCwgNDgwMDAsIDMyMDAwXVxuXHRcdCxcIjJcIjpbMjIwNTAsIDI0MDAwLCAxNjAwMF1cblx0XHQsXCIyLjVcIjpbMTEwMjUsIDEyMDAwLCA4MDAwXVxuXHR9KVt2ZXJzaW9uXTtcblx0c2FtcGxlUmF0ZSYmKHNhbXBsZVJhdGU9c2FtcGxlUmF0ZVtwYXJzZUludF9FUzMoYjQuc3Vic3RyKDQsMiksMildKTtcblx0dmFyIGJpdFJhdGU9WyAvL2xhbWVqcyAtPiBUYWJsZXMuYml0cmF0ZV90YWJsZVxuXHRcdFswLCA4LCAxNiwgMjQsIDMyLCA0MCwgNDgsIDU2LCA2NCwgODAsIDk2LCAxMTIsIDEyOCwgMTQ0LCAxNjBdIC8vTVBFRyAyIDIuNVxuXHRcdCxbMCwgMzIsIDQwLCA0OCwgNTYsIDY0LCA4MCwgOTYsIDExMiwgMTI4LCAxNjAsIDE5MiwgMjI0LCAyNTYsIDMyMF0vL01QRUcgMVxuXHRdW3ZlcnNpb249PTE/MTowXVtwYXJzZUludF9FUzMoYjQuc3Vic3RyKDAsNCksMildO1xuXHRcblx0aWYoIXZlcnNpb24gfHwgIWxheWVyIHx8ICFiaXRSYXRlIHx8ICFzYW1wbGVSYXRlKXtcblx0XHRyZXR1cm4gbnVsbDtcblx0fTtcblx0XG5cdHZhciBkdXJhdGlvbj1NYXRoLnJvdW5kKGxlbmd0aCo4L2JpdFJhdGUpO1xuXHR2YXIgZnJhbWU9bGF5ZXI9PTE/Mzg0OmxheWVyPT0yPzExNTI6dmVyc2lvbj09MT8xMTUyOjU3Njtcblx0dmFyIGZyYW1lRHVyYXRpb25GbG9hdD1mcmFtZS9zYW1wbGVSYXRlKjEwMDA7XG5cdHZhciBmcmFtZVNpemU9TWF0aC5mbG9vcigoZnJhbWUqYml0UmF0ZSkvOC9zYW1wbGVSYXRlKjEwMDApO1xuXHRcblx0Ly/mo4DmtYvmmK/lkKblrZjlnKhMYXllcjPluKfloavlhYUx5a2X6IqC44CC6L+Z6YeM5Y+q6I635Y+W56ys5LqM5bin55qE5aGr5YWF5L+h5oGv77yM6aaW5bin5rC46L+c5rKh5pyJ5aGr5YWF44CC5YW25LuW5bin5Y+v6IO96ZqU5LiA5bin5Ye6546w5LiA5Liq5aGr5YWF77yM5oiW6ICF6ZqU5b6I5aSa5bin5Ye6546w5LiA5Liq5aGr5YWF77yb55uu5rWL5piv5Y+W5Yaz5LqOZnJhbWVTaXpl5pyq6IiN5YWl5pe255qE5bCP5pWw6YOo5YiG77yM5Zug5Li65pyJ5Lqb6YeH5qC3546H55qEZnJhbWVTaXpl5Lya5Ye6546w5bCP5pWw77yIMTEwMjXjgIEyMjA1MOOAgTQ0MTAwIOWFuOWei+eahOmZpOS4jeWwve+8ie+8jOeEtuWQjuWtl+iKguaVsOaXoOazleihqOekuui/meenjeWwj+aVsO+8jOWwsemAmui/h+S4gOWumuatpemVv+adpeWhq+WFheW8peihpeWwj+aVsOmDqOWIhuS4ouWksVxuXHR2YXIgaGFzUGFkZGluZz0wLHNlZWs9MDtcblx0Zm9yKHZhciBpPTA7aTxtcDNCdWZmZXJzLmxlbmd0aDtpKyspe1xuXHRcdC8v5a+75om+56ys5LqM5binXG5cdFx0dmFyIGJ1Zj1tcDNCdWZmZXJzW2ldO1xuXHRcdHNlZWsrPWJ1Zi5ieXRlTGVuZ3RoO1xuXHRcdGlmKHNlZWs+PWZyYW1lU2l6ZSszKXtcblx0XHRcdHZhciBidWY4PW5ldyBVaW50OEFycmF5KGJ1Zik7XG5cdFx0XHR2YXIgaWR4PWJ1Zi5ieXRlTGVuZ3RoLShzZWVrLShmcmFtZVNpemUrMykrMSk7XG5cdFx0XHR2YXIgaWI0PWJ5dGVBdChpZHgsYnVmOCk7XG5cdFx0XHRoYXNQYWRkaW5nPWliNC5jaGFyQXQoNik9PVwiMVwiO1xuXHRcdFx0YnJlYWs7XG5cdFx0fTtcblx0fTtcblx0aWYoaGFzUGFkZGluZyl7XG5cdFx0ZnJhbWVTaXplKys7XG5cdH07XG5cdFxuXHRcblx0cmV0dXJuIHtcblx0XHR2ZXJzaW9uOnZlcnNpb24gLy8xIDIgMi41IC0+IE1QRUcxIE1QRUcyIE1QRUcyLjVcblx0XHQsbGF5ZXI6bGF5ZXIvLzMgLT4gTGF5ZXIzXG5cdFx0LHNhbXBsZVJhdGU6c2FtcGxlUmF0ZSAvL+mHh+agt+eOhyBoelxuXHRcdCxiaXRSYXRlOmJpdFJhdGUgLy/mr5Tnibnnjocga2Jwc1xuXHRcdFxuXHRcdCxkdXJhdGlvbjpkdXJhdGlvbiAvL+mfs+mikeaXtumVvyBtc1xuXHRcdCxzaXplOmxlbmd0aCAvL+aAu+mVv+W6piBieXRlXG5cdFx0LGhhc1BhZGRpbmc6aGFzUGFkZGluZyAvL+aYr+WQpuWtmOWcqDHlrZfoioLloavlhYXvvIzpppbluKfmsLjov5zmsqHmnInvvIzov5nkuKrlgLzlhbblrp7ku6PooajnmoTnrKzkuozluKfmmK/lkKbmnInloavlhYXvvIzlubbkuI3ku6Pooajlhbbku5bluKfnmoRcblx0XHQsZnJhbWVTaXplOmZyYW1lU2l6ZSAvL+avj+W4p+acgOWkp+mVv+W6pu+8jOWQq+WPr+iDveWtmOWcqOeahDHlrZfoioJwYWRkaW5nIGJ5dGVcblx0XHQsZnJhbWVEdXJhdGlvbkZsb2F0OmZyYW1lRHVyYXRpb25GbG9hdCAvL+avj+W4p+aXtumVv++8jOWQq+Wwj+aVsCBtc1xuXHR9O1xufTtcblxuLy/ljrvmjolsYW1lanPlvIDlpLTnmoTmoIforrDkv6Hmga/luKfvvIzlhY3lvpdtcDPop6PnoIHlh7rmnaXnmoTml7bplb/mr5RwY23nmoTplb/lpKrlpJpcbnZhciBtcDNUcmltRml4PXsvL21pbmZpeSBrZWVwIG5hbWVcbnJtOlJlY29yZGVyLm1wM1JlYWRNZXRhXG4sZm46ZnVuY3Rpb24obXAzQnVmZmVycyxsZW5ndGgscGNtTGVuZ3RoLHBjbVNhbXBsZVJhdGUpe1xuXHR2YXIgbWV0YT10aGlzLnJtKG1wM0J1ZmZlcnMsbGVuZ3RoKTtcblx0aWYoIW1ldGEpe1xuXHRcdHJldHVybiB7ZXJyOlwibXAz6Z2e6aKE5a6a5qC85byPXCJ9O1xuXHR9O1xuXHR2YXIgcGNtRHVyYXRpb249TWF0aC5yb3VuZChwY21MZW5ndGgvcGNtU2FtcGxlUmF0ZSoxMDAwKTtcblx0XG5cdC8v5byA5aS05aSa5Ye66L+Z5LmI5aSa5bin77yM56e76Zmk5o6J77yb5q2j5bi45oOF5Ya15LiL5pyA5aSa5Li6MuW4p1xuXHR2YXIgbnVtPU1hdGguZmxvb3IoKG1ldGEuZHVyYXRpb24tcGNtRHVyYXRpb24pL21ldGEuZnJhbWVEdXJhdGlvbkZsb2F0KTtcblx0aWYobnVtPjApe1xuXHRcdHZhciBzaXplPW51bSptZXRhLmZyYW1lU2l6ZS0obWV0YS5oYXNQYWRkaW5nPzE6MCk7Ly/pppbluKfmsqHmnInloavlhYXvvIznrKzkuozluKflj6/og73mnInloavlhYXvvIzov5nph4zlgYforr7mnIDlpJrkuLoy5bin77yI5rWL6K+V5bm25pyq5Ye6546wM+W4p+S7peS4iuaDheWGte+8ie+8jOWFtuS7luW4p+S4jeeuoe+8jOWwseeul+WHuueOsOS6huW5tuS4lOWvvOiHtOS6humUmeivr+WQjumdouiHquWKqOWuuemUmVxuXHRcdGxlbmd0aC09c2l6ZTtcblx0XHR2YXIgYXJyMD0wLGFycnM9W107XG5cdFx0Zm9yKHZhciBpPTA7aTxtcDNCdWZmZXJzLmxlbmd0aDtpKyspe1xuXHRcdFx0dmFyIGFycj1tcDNCdWZmZXJzW2ldO1xuXHRcdFx0aWYoc2l6ZTw9MCl7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fTtcblx0XHRcdGlmKHNpemU+PWFyci5ieXRlTGVuZ3RoKXtcblx0XHRcdFx0c2l6ZS09YXJyLmJ5dGVMZW5ndGg7XG5cdFx0XHRcdGFycnMucHVzaChhcnIpO1xuXHRcdFx0XHRtcDNCdWZmZXJzLnNwbGljZShpLDEpO1xuXHRcdFx0XHRpLS07XG5cdFx0XHR9ZWxzZXtcblx0XHRcdFx0bXAzQnVmZmVyc1tpXT1hcnIuc2xpY2Uoc2l6ZSk7XG5cdFx0XHRcdGFycjA9YXJyO1xuXHRcdFx0XHRzaXplPTA7XG5cdFx0XHR9O1xuXHRcdH07XG5cdFx0dmFyIGNoZWNrTWV0YT10aGlzLnJtKG1wM0J1ZmZlcnMsbGVuZ3RoKTtcblx0XHRpZighY2hlY2tNZXRhKXtcblx0XHRcdC8v6L+Y5Y6f5Y+Y5pu077yM5bqU6K+l5LiN5aSq5Y+v6IO95Lya5Ye6546wXG5cdFx0XHRhcnIwJiYobXAzQnVmZmVyc1swXT1hcnIwKTtcblx0XHRcdGZvcih2YXIgaT0wO2k8YXJycy5sZW5ndGg7aSsrKXtcblx0XHRcdFx0bXAzQnVmZmVycy5zcGxpY2UoaSwwLGFycnNbaV0pO1xuXHRcdFx0fTtcblx0XHRcdG1ldGEuZXJyPVwiZml45ZCO5pWw5o2u6ZSZ6K+v77yM5bey6L+Y5Y6f77yM6ZSZ6K+v5Y6f5Zug5LiN5piOXCI7XG5cdFx0fTtcblx0XHRcblx0XHR2YXIgZml4PW1ldGEudHJpbUZpeD17fTtcblx0XHRmaXgucmVtb3ZlPW51bTtcblx0XHRmaXgucmVtb3ZlRHVyYXRpb249TWF0aC5yb3VuZChudW0qbWV0YS5mcmFtZUR1cmF0aW9uRmxvYXQpO1xuXHRcdGZpeC5kdXJhdGlvbj1NYXRoLnJvdW5kKGxlbmd0aCo4L21ldGEuYml0UmF0ZSk7XG5cdH07XG5cdHJldHVybiBtZXRhO1xufVxufTtcbnZhciBtcDNUcmltRml4U2V0TWV0YT1mdW5jdGlvbihtZXRhLHNldCl7XG5cdHZhciB0YWc9XCJNUDPkv6Hmga8gXCI7XG5cdGlmKG1ldGEuc2FtcGxlUmF0ZSYmbWV0YS5zYW1wbGVSYXRlIT1zZXQuc2FtcGxlUmF0ZSB8fCBtZXRhLmJpdFJhdGUmJm1ldGEuYml0UmF0ZSE9c2V0LmJpdFJhdGUpe1xuXHRcdGNvbnNvbGUud2Fybih0YWcrXCLlkozorr7nva7nmoTkuI3ljLnphY1zZXQ6XCIrc2V0LmJpdFJhdGUrXCJrYnBzIFwiK3NldC5zYW1wbGVSYXRlK1wiaHrvvIzlt7Lmm7TmlrBzZXQ6XCIrbWV0YS5iaXRSYXRlK1wia2JwcyBcIittZXRhLnNhbXBsZVJhdGUrXCJoelwiLHNldCk7XG5cdFx0c2V0LnNhbXBsZVJhdGU9bWV0YS5zYW1wbGVSYXRlO1xuXHRcdHNldC5iaXRSYXRlPW1ldGEuYml0UmF0ZTtcblx0fTtcblx0XG5cdHZhciB0cmltRml4PW1ldGEudHJpbUZpeDtcblx0aWYodHJpbUZpeCl7XG5cdFx0dGFnKz1cIkZpeOenu+mZpFwiK3RyaW1GaXgucmVtb3ZlK1wi5binXCIrdHJpbUZpeC5yZW1vdmVEdXJhdGlvbitcIm1zIC0+IFwiK3RyaW1GaXguZHVyYXRpb24rXCJtc1wiO1xuXHRcdGlmKHRyaW1GaXgucmVtb3ZlPjIpe1xuXHRcdFx0bWV0YS5lcnI9KG1ldGEuZXJyP21ldGEuZXJyK1wiLCBcIjpcIlwiKStcIuenu+mZpOW4p+aVsOi/h+WkmlwiO1xuXHRcdH07XG5cdH1lbHNle1xuXHRcdHRhZys9KG1ldGEuZHVyYXRpb258fFwiLVwiKStcIm1zXCI7XG5cdH07XG5cdFxuXHRpZihtZXRhLmVycil7XG5cdFx0Y29uc29sZS5lcnJvcih0YWcsbWV0YS5lcnIsbWV0YSk7XG5cdH1lbHNle1xuXHRcdGNvbnNvbGUubG9nKHRhZyxtZXRhKTtcblx0fTtcbn07XG5cblxuXHRcbn0pKCk7IiwiLypcbuW9lemfs1xuaHR0cHM6Ly9naXRodWIuY29tL3hpYW5neXVlY24vUmVjb3JkZXJcbiovXG4oZnVuY3Rpb24oZmFjdG9yeSl7XG5cdGZhY3Rvcnkod2luZG93KTtcblx0Ly91bWQgcmV0dXJuRXhwb3J0cy5qc1xuXHRpZih0eXBlb2YoZGVmaW5lKT09J2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKXtcblx0XHRkZWZpbmUoZnVuY3Rpb24oKXtcblx0XHRcdHJldHVybiBSZWNvcmRlcjtcblx0XHR9KTtcblx0fTtcblx0aWYodHlwZW9mKG1vZHVsZSk9PSdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzKXtcblx0XHRtb2R1bGUuZXhwb3J0cz1SZWNvcmRlcjtcblx0fTtcbn0oZnVuY3Rpb24od2luZG93KXtcblwidXNlIHN0cmljdFwiO1xuXG4vL+WFvOWuueeOr+Wig1xudmFyIExNPVwiMjAyMC0xMS0xNSAyMTozNjoxMVwiO1xudmFyIE5PT1A9ZnVuY3Rpb24oKXt9O1xuLy9lbmQg5YW85a65546v5aKDICoqKirku47ku6XkuIvlvIDlp4tjb3B55rqQ56CBKioqKipcblxudmFyIFJlY29yZGVyPWZ1bmN0aW9uKHNldCl7XG5cdHJldHVybiBuZXcgaW5pdEZuKHNldCk7XG59O1xuLy/mmK/lkKblt7Lnu4/miZPlvIDkuoblvZXpn7PvvIzmiYDmnInlt6XkvZzpg73lt7Lnu4/lh4blpIflpb3kuobvvIzlsLHnrYnmjqXmlLbpn7PpopHmlbDmja7kuoZcblJlY29yZGVyLklzT3Blbj1mdW5jdGlvbigpe1xuXHR2YXIgc3RyZWFtPVJlY29yZGVyLlN0cmVhbTtcblx0aWYoc3RyZWFtKXtcblx0XHR2YXIgdHJhY2tzPXN0cmVhbS5nZXRUcmFja3MmJnN0cmVhbS5nZXRUcmFja3MoKXx8c3RyZWFtLmF1ZGlvVHJhY2tzfHxbXTtcblx0XHR2YXIgdHJhY2s9dHJhY2tzWzBdO1xuXHRcdGlmKHRyYWNrKXtcblx0XHRcdHZhciBzdGF0ZT10cmFjay5yZWFkeVN0YXRlO1xuXHRcdFx0cmV0dXJuIHN0YXRlPT1cImxpdmVcInx8c3RhdGU9PXRyYWNrLkxJVkU7XG5cdFx0fTtcblx0fTtcblx0cmV0dXJuIGZhbHNlO1xufTtcbi8qSDXlvZXpn7Pml7bnmoRBdWRpb0NvbnRleHTnvJPlhrLlpKflsI/jgILkvJrlvbHlk41INeW9lemfs+aXtueahG9uUHJvY2Vzc+iwg+eUqOmAn+eOh++8jOebuOWvueS6jkF1ZGlvQ29udGV4dC5zYW1wbGVSYXRlPTQ4MDAw5pe277yMNDA5NuaOpei/kTEy5binL3PvvIzosIPoioLmraTlj4LmlbDlj6/nlJ/miJDmr5TovoPmtYHnlYXnmoTlm57osIPliqjnlLvjgIJcblx05Y+W5YC8MjU2LCA1MTIsIDEwMjQsIDIwNDgsIDQwOTYsIDgxOTIsIG9yIDE2Mzg0XG5cdOazqOaEj++8jOWPluWAvOS4jeiDvei/h+S9ju+8jDIwNDjlvIDlp4vkuI3lkIzmtY/op4jlmajlj6/og73lm57osIPpgJ/njofot5/kuI3kuIrpgKDmiJDpn7PotKjpl67popjjgIJcblx05LiA6Iis5peg6ZyA6LCD5pW077yM6LCD5pW05ZCO6ZyA6KaB5YWIY2xvc2Xmjonlt7LmiZPlvIDnmoTlvZXpn7PvvIzlho1vcGVu5pe25omN5Lya55Sf5pWI44CCXG4qL1xuUmVjb3JkZXIuQnVmZmVyU2l6ZT00MDk2O1xuLy/plIDmr4Hlt7LmjIHmnInnmoTmiYDmnInlhajlsYDotYTmupDvvIzlvZPopoHlvbvlupXnp7vpmaRSZWNvcmRlcuaXtumcgOimgeaYvuW8j+eahOiwg+eUqOatpOaWueazlVxuUmVjb3JkZXIuRGVzdHJveT1mdW5jdGlvbigpe1xuXHRDTG9nKFwiUmVjb3JkZXIgRGVzdHJveVwiKTtcblx0Zm9yKHZhciBrIGluIERlc3Ryb3lMaXN0KXtcblx0XHREZXN0cm95TGlzdFtrXSgpO1xuXHR9O1xufTtcbnZhciBEZXN0cm95TGlzdD17fTtcbi8v55m76K6w5LiA5Liq6ZyA6KaB6ZSA5q+B5YWo5bGA6LWE5rqQ55qE5aSE55CG5pa55rOVXG5SZWNvcmRlci5CaW5kRGVzdHJveT1mdW5jdGlvbihrZXksY2FsbCl7XG5cdERlc3Ryb3lMaXN0W2tleV09Y2FsbDtcbn07XG4vL+WIpOaWrea1j+iniOWZqOaYr+WQpuaUr+aMgeW9lemfs++8jOmaj+aXtuWPr+S7peiwg+eUqOOAguazqOaEj++8muS7heS7heaYr+ajgOa1i+a1j+iniOWZqOaUr+aMgeaDheWGte+8jOS4jeS8muWIpOaWreWSjOiwg+i1t+eUqOaIt+aOiOadg++8jOS4jeS8muWIpOaWreaYr+WQpuaUr+aMgeeJueWumuagvOW8j+W9lemfs+OAglxuUmVjb3JkZXIuU3VwcG9ydD1mdW5jdGlvbigpe1xuXHR2YXIgQUM9d2luZG93LkF1ZGlvQ29udGV4dDtcblx0aWYoIUFDKXtcblx0XHRBQz13aW5kb3cud2Via2l0QXVkaW9Db250ZXh0O1xuXHR9O1xuXHRpZighQUMpe1xuXHRcdHJldHVybiBmYWxzZTtcblx0fTtcblx0dmFyIHNjb3BlPW5hdmlnYXRvci5tZWRpYURldmljZXN8fHt9O1xuXHRpZighc2NvcGUuZ2V0VXNlck1lZGlhKXtcblx0XHRzY29wZT1uYXZpZ2F0b3I7XG5cdFx0c2NvcGUuZ2V0VXNlck1lZGlhfHwoc2NvcGUuZ2V0VXNlck1lZGlhPXNjb3BlLndlYmtpdEdldFVzZXJNZWRpYXx8c2NvcGUubW96R2V0VXNlck1lZGlhfHxzY29wZS5tc0dldFVzZXJNZWRpYSk7XG5cdH07XG5cdGlmKCFzY29wZS5nZXRVc2VyTWVkaWEpe1xuXHRcdHJldHVybiBmYWxzZTtcblx0fTtcblx0XG5cdFJlY29yZGVyLlNjb3BlPXNjb3BlO1xuXHRpZighUmVjb3JkZXIuQ3R4fHxSZWNvcmRlci5DdHguc3RhdGU9PVwiY2xvc2VkXCIpe1xuXHRcdC8v5LiN6IO95Y+N5aSN5p6E6YCg77yM5L2O54mI5pysbnVtYmVyIG9mIGhhcmR3YXJlIGNvbnRleHRzIHJlYWNoZWQgbWF4aW11bSAoNilcblx0XHRSZWNvcmRlci5DdHg9bmV3IEFDKCk7XG5cdFx0XG5cdFx0UmVjb3JkZXIuQmluZERlc3Ryb3koXCJDdHhcIixmdW5jdGlvbigpe1xuXHRcdFx0dmFyIGN0eD1SZWNvcmRlci5DdHg7XG5cdFx0XHRjdHgmJmN0eC5jbG9zZSYmY3R4LmNsb3NlKCk7XG5cdFx0fSk7XG5cdH07XG5cdHJldHVybiB0cnVlO1xufTtcbi8q5Yid5aeL5YyWSDXpn7PpopHph4fpm4bov57mjqXvvIzlm6DkuLpTdHJlYW3mmK/lhajlsYDnmoTvvIxTYWZhcmnkuIrmlq3lvIDlkI7lsLHml6Dms5Xlho3mrKHov5vooYzov57mjqXkvb/nlKjvvIzooajnjrDkuLrpnZnpn7PvvIzlm6DmraTkvb/nlKjlhajpg6jkvb/nlKjlhajlsYDlpITnkIbpgb/lhY3osIPnlKjliLBkaXNjb25uZWN077yb5YWo5bGA5aSE55CG5Lmf5pyJ5Yip5LqO5bGP6JS95bqV5bGC57uG6IqC77yMc3RhcnTml7bml6DpnIDlho3osIPnlKjlupXlsYLmjqXlj6PvvIzmj5DljYflhbzlrrnjgIHlj6/pnaDmgKfjgIIqL1xudmFyIENvbm5lY3Q9ZnVuY3Rpb24oKXtcblx0dmFyIGN0eD1SZWNvcmRlci5DdHgsc3RyZWFtPVJlY29yZGVyLlN0cmVhbTtcblx0dmFyIG1lZGlhPXN0cmVhbS5fbT1jdHguY3JlYXRlTWVkaWFTdHJlYW1Tb3VyY2Uoc3RyZWFtKTtcblx0dmFyIHByb2Nlc3M9c3RyZWFtLl9wPShjdHguY3JlYXRlU2NyaXB0UHJvY2Vzc29yfHxjdHguY3JlYXRlSmF2YVNjcmlwdE5vZGUpLmNhbGwoY3R4LFJlY29yZGVyLkJ1ZmZlclNpemUsMSwxKTsvL+WNleWjsOmBk++8jOecgeeahOaVsOaNruWkhOeQhuWkjeadglxuXHRcblx0bWVkaWEuY29ubmVjdChwcm9jZXNzKTtcblx0cHJvY2Vzcy5jb25uZWN0KGN0eC5kZXN0aW5hdGlvbik7XG5cdFxuXHR2YXIgY2FsbHM9c3RyZWFtLl9jYWxsO1xuXHRwcm9jZXNzLm9uYXVkaW9wcm9jZXNzPWZ1bmN0aW9uKGUpe1xuXHRcdGZvcih2YXIgazAgaW4gY2FsbHMpey8vaGFzIGl0ZW1cblx0XHRcdHZhciBvPWUuaW5wdXRCdWZmZXIuZ2V0Q2hhbm5lbERhdGEoMCk7Ly/lnZfmmK/lhbHkuqvnmoTvvIzlv4XpobvlpI3liLblh7rmnaVcblx0XHRcdHZhciBzaXplPW8ubGVuZ3RoO1xuXHRcdFx0XG5cdFx0XHR2YXIgcGNtPW5ldyBJbnQxNkFycmF5KHNpemUpO1xuXHRcdFx0dmFyIHN1bT0wO1xuXHRcdFx0Zm9yKHZhciBqPTA7ajxzaXplO2orKyl7Ly9mbG9hdFRvMTZCaXRQQ00gXG5cdFx0XHRcdHZhciBzPU1hdGgubWF4KC0xLE1hdGgubWluKDEsb1tqXSkpO1xuXHRcdFx0XHRzPXM8MD9zKjB4ODAwMDpzKjB4N0ZGRjtcblx0XHRcdFx0cGNtW2pdPXM7XG5cdFx0XHRcdHN1bSs9TWF0aC5hYnMocyk7XG5cdFx0XHR9O1xuXHRcdFx0XG5cdFx0XHRmb3IodmFyIGsgaW4gY2FsbHMpe1xuXHRcdFx0XHRjYWxsc1trXShwY20sc3VtKTtcblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdHJldHVybjtcblx0XHR9O1xuXHR9O1xufTtcbnZhciBEaXNjb25uZWN0PWZ1bmN0aW9uKCl7XG5cdHZhciBzdHJlYW09UmVjb3JkZXIuU3RyZWFtO1xuXHRpZihzdHJlYW0uX20pe1xuXHRcdHN0cmVhbS5fbS5kaXNjb25uZWN0KCk7XG5cdFx0c3RyZWFtLl9wLmRpc2Nvbm5lY3QoKTtcblx0XHRzdHJlYW0uX3Aub25hdWRpb3Byb2Nlc3M9c3RyZWFtLl9wPXN0cmVhbS5fbT1udWxsO1xuXHR9O1xufTtcblxuLyrlr7lwY23mlbDmja7nmoTph4fmoLfnjofov5vooYzovazmjaJcbnBjbURhdGFzOiBbW0ludDE2LC4uLl1dIHBjbeeJh+auteWIl+ihqFxucGNtU2FtcGxlUmF0ZTo0ODAwMCBwY23mlbDmja7nmoTph4fmoLfnjodcbm5ld1NhbXBsZVJhdGU6MTYwMDAg6ZyA6KaB6L2s5o2i5oiQ55qE6YeH5qC3546H77yMbmV3U2FtcGxlUmF0ZT49cGNtU2FtcGxlUmF0ZeaXtuS4jeS8mui/m+ihjOS7u+S9leWkhOeQhu+8jOWwj+S6juaXtuS8mui/m+ihjOmHjeaWsOmHh+agt1xucHJldkNodW5rSW5mbzp7fSDlj6/pgInvvIzkuIrmrKHosIPnlKjml7bnmoTov5Tlm57lgLzvvIznlKjkuo7ov57nu63ovazmjaLvvIzmnKzmrKHosIPnlKjlsIbku47kuIrmrKHnu5PmnZ/kvY3nva7lvIDlp4vov5vooYzlpITnkIbjgILmiJblj6/oh6rooYzlrprkuYnkuIDkuKpDaHVua0luZm/ku45wY21EYXRhc+aMh+WumueahOS9jee9ruW8gOWni+i/m+ihjOi9rOaNolxub3B0aW9uOnsg5Y+v6YCJ77yM6YWN572u6aG5XG5cdFx0ZnJhbWVTaXplOjEyMzQ1NiDluKflpKflsI/vvIzmr4/luKfnmoRQQ00gSW50MTbnmoTmlbDph4/vvIzph4fmoLfnjofovazmjaLlkI7nmoRwY23plb/luqbkuLpmcmFtZVNpemXnmoTmlbTmlbDlgI3vvIznlKjkuo7ov57nu63ovazmjaLjgILnm67liY3ku4XlnKhtcDPmoLzlvI/ml7bmiY3mnInnlKjvvIxmcmFtZVNpemXlj5blgLzkuLoxMTUy77yM6L+Z5qC357yW56CB5Ye65p2l55qEbXAz5pe26ZW/5ZKMcGNt55qE5pe26ZW/5a6M5YWo5LiA6Ie077yM5ZCm5YiZ5Lya5Zug5Li6bXAz5pyA5ZCO5LiA5bin5b2V6Z+z5LiN5aSf5aGr5ruh5pe25re75Yqg5aGr5YWF5pWw5o2u5a+86Ie0bXAz55qE5pe26ZW/5Y+Y6ZW/44CCXG5cdFx0ZnJhbWVUeXBlOlwiXCIg5bin57G75Z6L77yM5LiA6Iis5Li6cmVjLnNldC50eXBl77yM5o+Q5L6b5q2k5Y+C5pWw5pe25peg6ZyA5o+Q5L6bZnJhbWVTaXpl77yM5Lya6Ieq5Yqo5L2/55So5pyA5L2z55qE5YC857uZZnJhbWVTaXpl6LWL5YC877yM55uu5YmN5LuF5pSv5oyBbXAzPTExNTIoTVBFRzEgTGF5ZXIz55qE5q+P5bin6YeH6YeH5qC35pWwKe+8jOWFtuS7luexu+Weiz0x44CCXG5cdFx0XHTku6XkuIrkuKTkuKrlj4LmlbDnlKjkuo7ov57nu63ovazmjaLml7bkvb/nlKjvvIzmnIDlpJrkvb/nlKjkuIDkuKrvvIzkuI3mj5Dkvpvml7bkuI3ov5vooYzluKfnmoTnibnmrorlpITnkIbvvIzmj5Dkvpvml7blv4XpobvlkIzml7bmj5DkvptwcmV2Q2h1bmtJbmZv5omN5pyJ5L2c55So44CC5pyA5ZCO5LiA5q615pWw5o2u5aSE55CG5pe25peg6ZyA5o+Q5L6b5bin5aSn5bCP5Lul5L6/6L6T5Ye65pyA5ZCO5LiA5LiB54K55q6L55WZ5pWw5o2u44CCXG5cdH1cblxu6L+U5ZueQ2h1bmtJbmZvOntcblx0Ly/lj6/lrprkuYnvvIzku47mjIflrprkvY3nva7lvIDlp4vovazmjaLliLDnu5PlsL5cblx0aW5kZXg6MCBwY21EYXRhc+W3suWkhOeQhuWIsOeahOe0ouW8lVxuXHRvZmZzZXQ6MC4wIOW3suWkhOeQhuWIsOeahGluZGV45a+55bqU55qEcGNt5Lit55qE5YGP56e755qE5LiL5LiA5Liq5L2N572uXG5cdFxuXHQvL+S7heS9nOS4uui/lOWbnuWAvFxuXHRmcmFtZU5leHQ6bnVsbHx8W0ludDE2LC4uLl0g5LiL5LiA5bin55qE6YOo5YiG5pWw5o2u77yMZnJhbWVTaXpl6K6+572u5LqG55qE5pe25YCZ5omN5Y+v6IO95Lya5pyJXG5cdHNhbXBsZVJhdGU6MTYwMDAg57uT5p6c55qE6YeH5qC3546H77yMPD1uZXdTYW1wbGVSYXRlXG5cdGRhdGE6W0ludDE2LC4uLl0g6L2s5o2i5ZCO55qEUENN57uT5p6c77yb5aaC5p6c5piv6L+e57ut6L2s5o2i77yM5bm25LiUcGNtRGF0YXPkuK3lubbmsqHmnInmlrDmlbDmja7ml7bvvIxkYXRh55qE6ZW/5bqm5Y+v6IO95Li6MFxufVxuKi9cblJlY29yZGVyLlNhbXBsZURhdGE9ZnVuY3Rpb24ocGNtRGF0YXMscGNtU2FtcGxlUmF0ZSxuZXdTYW1wbGVSYXRlLHByZXZDaHVua0luZm8sb3B0aW9uKXtcblx0cHJldkNodW5rSW5mb3x8KHByZXZDaHVua0luZm89e30pO1xuXHR2YXIgaW5kZXg9cHJldkNodW5rSW5mby5pbmRleHx8MDtcblx0dmFyIG9mZnNldD1wcmV2Q2h1bmtJbmZvLm9mZnNldHx8MDtcblx0XG5cdHZhciBmcmFtZU5leHQ9cHJldkNodW5rSW5mby5mcmFtZU5leHR8fFtdO1xuXHRvcHRpb258fChvcHRpb249e30pO1xuXHR2YXIgZnJhbWVTaXplPW9wdGlvbi5mcmFtZVNpemV8fDE7XG5cdGlmKG9wdGlvbi5mcmFtZVR5cGUpe1xuXHRcdGZyYW1lU2l6ZT1vcHRpb24uZnJhbWVUeXBlPT1cIm1wM1wiPzExNTI6MTtcblx0fTtcblx0XG5cdHZhciBzaXplPTA7XG5cdGZvcih2YXIgaT1pbmRleDtpPHBjbURhdGFzLmxlbmd0aDtpKyspe1xuXHRcdHNpemUrPXBjbURhdGFzW2ldLmxlbmd0aDtcblx0fTtcblx0c2l6ZT1NYXRoLm1heCgwLHNpemUtTWF0aC5mbG9vcihvZmZzZXQpKTtcblx0XG5cdC8v6YeH5qC3IGh0dHBzOi8vd3d3LmNuYmxvZ3MuY29tL2JscXcvcC8zNzgyNDIwLmh0bWxcblx0dmFyIHN0ZXA9cGNtU2FtcGxlUmF0ZS9uZXdTYW1wbGVSYXRlO1xuXHRpZihzdGVwPjEpey8v5paw6YeH5qC35L2O5LqO5b2V6Z+z6YeH5qC377yM6L+b6KGM5oq95qC3XG5cdFx0c2l6ZT1NYXRoLmZsb29yKHNpemUvc3RlcCk7XG5cdH1lbHNley8v5paw6YeH5qC36auY5LqO5b2V6Z+z6YeH5qC35LiN5aSE55CG77yM55yB5Y675LqG5o+S5YC85aSE55CGXG5cdFx0c3RlcD0xO1xuXHRcdG5ld1NhbXBsZVJhdGU9cGNtU2FtcGxlUmF0ZTtcblx0fTtcblx0XG5cdHNpemUrPWZyYW1lTmV4dC5sZW5ndGg7XG5cdHZhciByZXM9bmV3IEludDE2QXJyYXkoc2l6ZSk7XG5cdHZhciBpZHg9MDtcblx0Ly/mt7vliqDkuIrkuIDmrKHkuI3lpJ/kuIDluKfnmoTliankvZnmlbDmja5cblx0Zm9yKHZhciBpPTA7aTxmcmFtZU5leHQubGVuZ3RoO2krKyl7XG5cdFx0cmVzW2lkeF09ZnJhbWVOZXh0W2ldO1xuXHRcdGlkeCsrO1xuXHR9O1xuXHQvL+WkhOeQhuaVsOaNrlxuXHRmb3IgKHZhciBubD1wY21EYXRhcy5sZW5ndGg7aW5kZXg8bmw7aW5kZXgrKykge1xuXHRcdHZhciBvPXBjbURhdGFzW2luZGV4XTtcblx0XHR2YXIgaT1vZmZzZXQsaWw9by5sZW5ndGg7XG5cdFx0d2hpbGUoaTxpbCl7XG5cdFx0XHQvL3Jlc1tpZHhdPW9bTWF0aC5yb3VuZChpKV07IOebtOaOpeeugOWNleaKveagt1xuXHRcdFx0XG5cdFx0XHQvL2h0dHBzOi8vd3d3LmNuYmxvZ3MuY29tL3hpYW9xaS9wLzY5OTM5MTIuaHRtbFxuXHRcdFx0Ly/lvZPliY3ngrk95b2T5YmN54K5K+WIsOWQjumdouS4gOS4queCueS5i+mXtOeahOWinumHj++8jOmfs+i0qOavlOebtOaOpeeugOWNleaKveagt+WlveS6m1xuXHRcdFx0dmFyIGJlZm9yZSA9IE1hdGguZmxvb3IoaSk7XG5cdFx0XHR2YXIgYWZ0ZXIgPSBNYXRoLmNlaWwoaSk7XG5cdFx0XHR2YXIgYXRQb2ludCA9IGkgLSBiZWZvcmU7XG5cdFx0XHRcblx0XHRcdHZhciBiZWZvcmVWYWw9b1tiZWZvcmVdO1xuXHRcdFx0dmFyIGFmdGVyVmFsPWFmdGVyPGlsID8gb1thZnRlcl1cblx0XHRcdFx0OiAoLy/lkI7kuKrngrnotornlYzkuobvvIzmn6Xmib7kuIvkuIDkuKrmlbDnu4Rcblx0XHRcdFx0XHQocGNtRGF0YXNbaW5kZXgrMV18fFtiZWZvcmVWYWxdKVswXXx8MFxuXHRcdFx0XHQpO1xuXHRcdFx0cmVzW2lkeF09YmVmb3JlVmFsKyhhZnRlclZhbC1iZWZvcmVWYWwpKmF0UG9pbnQ7XG5cdFx0XHRcblx0XHRcdGlkeCsrO1xuXHRcdFx0aSs9c3RlcDsvL+aKveagt1xuXHRcdH07XG5cdFx0b2Zmc2V0PWktaWw7XG5cdH07XG5cdC8v5bin5aSE55CGXG5cdGZyYW1lTmV4dD1udWxsO1xuXHR2YXIgZnJhbWVOZXh0U2l6ZT1yZXMubGVuZ3RoJWZyYW1lU2l6ZTtcblx0aWYoZnJhbWVOZXh0U2l6ZT4wKXtcblx0XHR2YXIgdThQb3M9KHJlcy5sZW5ndGgtZnJhbWVOZXh0U2l6ZSkqMjtcblx0XHRmcmFtZU5leHQ9bmV3IEludDE2QXJyYXkocmVzLmJ1ZmZlci5zbGljZSh1OFBvcykpO1xuXHRcdHJlcz1uZXcgSW50MTZBcnJheShyZXMuYnVmZmVyLnNsaWNlKDAsdThQb3MpKTtcblx0fTtcblx0XG5cdHJldHVybiB7XG5cdFx0aW5kZXg6aW5kZXhcblx0XHQsb2Zmc2V0Om9mZnNldFxuXHRcdFxuXHRcdCxmcmFtZU5leHQ6ZnJhbWVOZXh0XG5cdFx0LHNhbXBsZVJhdGU6bmV3U2FtcGxlUmF0ZVxuXHRcdCxkYXRhOnJlc1xuXHR9O1xufTtcblxuXG4vKuiuoeeul+mfs+mHj+eZvuWIhuavlOeahOS4gOS4quaWueazlVxucGNtQWJzU3VtOiBwY20gSW50MTbmiYDmnInph4fmoLfnmoTnu53lr7nlgLznmoTlkoxcbnBjbUxlbmd0aDogcGNt6ZW/5bqmXG7ov5Tlm57lgLzvvJowLTEwMO+8jOS4u+imgeW9k+WBmueZvuWIhuavlOeUqFxu5rOo5oSP77ya6L+Z5Liq5LiN5piv5YiG6LSd77yM5Zug5q2k5rKh55Sodm9sdW1l5b2T5YGa5ZCN56ewKi9cblJlY29yZGVyLlBvd2VyTGV2ZWw9ZnVuY3Rpb24ocGNtQWJzU3VtLHBjbUxlbmd0aCl7XG5cdC8q6K6h566X6Z+z6YePIGh0dHBzOi8vYmxvZy5jc2RuLm5ldC9qb2R5MTk4OS9hcnRpY2xlL2RldGFpbHMvNzM0ODAyNTlcblx05pu06auY54G15pWP5bqm566X5rOVOlxuXHRcdOmZkOWumuacgOWkp+aEn+W6lOWAvDEwMDAwXG5cdFx0XHTnur/mgKfmm7Lnur/vvJrkvY7pn7Pph4/kuI3lj4vlpb1cblx0XHRcdFx0cG93ZXIvMTAwMDAqMTAwIFxuXHRcdFx05a+55pWw5puy57q/77ya5L2O6Z+z6YeP5Y+L5aW977yM5L2G6ZyA6ZmQ5a6a5pyA5L2O5oSf5bqU5YC8XG5cdFx0XHRcdCgxK01hdGgubG9nMTAocG93ZXIvMTAwMDApKSoxMDBcblx0Ki9cblx0dmFyIHBvd2VyPShwY21BYnNTdW0vcGNtTGVuZ3RoKSB8fCAwOy8vTmFOXG5cdHZhciBsZXZlbDtcblx0aWYocG93ZXI8MTI1MSl7Ly8xMjUw55qE57uT5p6cMTAl77yM5pu05bCP55qE6Z+z6YeP6YeH55So57q/5oCn5Y+W5YC8XG5cdFx0bGV2ZWw9TWF0aC5yb3VuZChwb3dlci8xMjUwKjEwKTtcblx0fWVsc2V7XG5cdFx0bGV2ZWw9TWF0aC5yb3VuZChNYXRoLm1pbigxMDAsTWF0aC5tYXgoMCwoMStNYXRoLmxvZyhwb3dlci8xMDAwMCkvTWF0aC5sb2coMTApKSoxMDApKSk7XG5cdH07XG5cdHJldHVybiBsZXZlbDtcbn07XG5cblxuXG5cbi8v5bim5pe26Ze055qE5pel5b+X6L6T5Ye677yMQ0xvZyhtc2csZXJyT3JMb2dNc2csIGxvZ01zZy4uLikgZXJy5Li65pWw5a2X5pe25Luj6KGo5pel5b+X57G75Z6LMTplcnJvciAyOmxvZ+m7mOiupCAzOndhcm7vvIzlkKbliJnlvZPlgZrlhoXlrrnovpPlh7rvvIznrKzkuIDkuKrlj4LmlbDkuI3og73mmK/lr7nosaHlm6DkuLropoHmi7zmjqXml7bpl7TvvIzlkI7pnaLlj6/ku6XmjqXml6DmlbDkuKrovpPlh7rlj4LmlbBcbnZhciBDTG9nPWZ1bmN0aW9uKG1zZyxlcnIpe1xuXHR2YXIgbm93PW5ldyBEYXRlKCk7XG5cdHZhciB0PShcIjBcIitub3cuZ2V0TWludXRlcygpKS5zdWJzdHIoLTIpXG5cdFx0K1wiOlwiKyhcIjBcIitub3cuZ2V0U2Vjb25kcygpKS5zdWJzdHIoLTIpXG5cdFx0K1wiLlwiKyhcIjAwXCIrbm93LmdldE1pbGxpc2Vjb25kcygpKS5zdWJzdHIoLTMpO1xuXHR2YXIgYXJyPVtcIltcIit0K1wiIFJlY29yZGVyXVwiK21zZ107XG5cdHZhciBhPWFyZ3VtZW50cztcblx0dmFyIGk9Mixmbj1jb25zb2xlLmxvZztcblx0aWYodHlwZW9mKGVycik9PVwibnVtYmVyXCIpe1xuXHRcdGZuPWVycj09MT9jb25zb2xlLmVycm9yOmVycj09Mz9jb25zb2xlLndhcm46Zm47XG5cdH1lbHNle1xuXHRcdGk9MTtcblx0fTtcblx0Zm9yKDtpPGEubGVuZ3RoO2krKyl7XG5cdFx0YXJyLnB1c2goYVtpXSk7XG5cdH07XG5cdGZuLmFwcGx5KGNvbnNvbGUsYXJyKTtcbn07XG5SZWNvcmRlci5DTG9nPUNMb2c7XG5cblxuXG5cbnZhciBJRD0wO1xuZnVuY3Rpb24gaW5pdEZuKHNldCl7XG5cdHRoaXMuaWQ9KytJRDtcblx0XG5cdC8v5aaC5p6c5byA5ZCv5LqG5rWB6YeP57uf6K6h77yM6L+Z6YeM5bCG5Y+R6YCB5LiA5Liq5Zu+54mH6K+35rGCXG5cdFJlY29yZGVyLlRyYWZmaWMmJlJlY29yZGVyLlRyYWZmaWMoKTtcblx0XG5cdFxuXHR2YXIgbz17XG5cdFx0dHlwZTpcIm1wM1wiIC8v6L6T5Ye657G75Z6L77yabXAzLHdhdu+8jHdhdui+k+WHuuaWh+S7tuWwuuWvuOi2heWkp+S4jeaOqOiNkOS9v+eUqO+8jOS9hm1wM+e8lueggeaUr+aMgeS8muWvvOiHtGpz5paH5Lu26LaF5aSn77yM5aaC5p6c5LiN6ZyA5pSv5oyBbXAz5Y+v5Lul5L2/anPmlofku7blpKfluYXlh4/lsI9cblx0XHQsYml0UmF0ZToxNiAvL+avlOeJueeOhyB3YXY6MTbmiJY45L2N77yMTVAz77yaOGticHMgMWsvc++8jDhrYnBzIDJrL3Mg5b2V6Z+z5paH5Lu25b6I5bCPXG5cdFx0XG5cdFx0LHNhbXBsZVJhdGU6MTYwMDAgLy/ph4fmoLfnjofvvIx3YXbmoLzlvI/lpKflsI89c2FtcGxlUmF0ZSrml7bpl7TvvJttcDPmraTpobnlr7nkvY7mr5TnibnnjofmnInlvbHlk43vvIzpq5jmr5Tnibnnjoflh6DkuY7ml6DlvbHlk43jgIJcblx0XHRcdFx0XHQvL3dhduS7u+aEj+WAvO+8jG1wM+WPluWAvOiMg+WbtO+8mjQ4MDAwLCA0NDEwMCwgMzIwMDAsIDI0MDAwLCAyMjA1MCwgMTYwMDAsIDEyMDAwLCAxMTAyNSwgODAwMFxuXHRcdFx0XHRcdC8v6YeH5qC3546H5Y+C6ICDaHR0cHM6Ly93d3cuY25ibG9ncy5jb20vZGV2aW44Ny9wL21wMy1yZWNvcmRlci5odG1sXG5cdFx0XG5cdFx0LG9uUHJvY2VzczpOT09QIC8vZm4oYnVmZmVycyxwb3dlckxldmVsLGJ1ZmZlckR1cmF0aW9uLGJ1ZmZlclNhbXBsZVJhdGUsbmV3QnVmZmVySWR4LGFzeW5jRW5kKSBidWZmZXJzPVtbSW50MTYsLi4uXSwuLi5d77ya57yT5Yay55qEUENN5pWw5o2u77yM5Li65LuO5byA5aeL5b2V6Z+z5Yiw546w5Zyo55qE5omA5pyJcGNt54mH5q6177ybcG93ZXJMZXZlbO+8muW9k+WJjee8k+WGsueahOmfs+mHj+e6p+WIqzAtMTAw77yMYnVmZmVyRHVyYXRpb27vvJrlt7LnvJPlhrLml7bplb/vvIxidWZmZXJTYW1wbGVSYXRl77ya57yT5Yay5L2/55So55qE6YeH5qC3546H77yI5b2TdHlwZeaUr+aMgei+ueW9lei+uei9rOeggShXb3JrZXIp5pe277yM5q2k6YeH5qC3546H5ZKM6K6+572u55qE6YeH5qC3546H55u45ZCM77yM5ZCm5YiZ5LiN5LiA5a6a55u45ZCM77yJ77ybbmV3QnVmZmVySWR4OuacrOasoeWbnuiwg+aWsOWinueahGJ1ZmZlcui1t+Wni+e0ouW8le+8m2FzeW5jRW5kOmZuKCkg5aaC5p6cb25Qcm9jZXNz5piv5byC5q2l55qEKOi/lOWbnuWAvOS4unRydWXml7Yp77yM5aSE55CG5a6M5oiQ5pe26ZyA6KaB6LCD55So5q2k5Zue6LCD77yM5aaC5p6c5LiN5piv5byC5q2l55qE6K+35b+955Wl5q2k5Y+C5pWw77yM5q2k5pa55rOV5Zue6LCD5pe25b+F6aG75piv55yf5byC5q2l77yI5LiN6IO955yf5byC5q2l5pe26ZyA55Soc2V0VGltZW91dOWMheijue+8ieOAgm9uUHJvY2Vzc+i/lOWbnuWAvO+8muWmguaenOi/lOWbnnRydWXku6PooajlvIDlkK/lvILmraXmqKHlvI/vvIzlnKjmn5DkupvlpKfph4/ov5DnrpfnmoTlnLrlkIjlvILmraXmmK/lv4XpobvnmoTvvIzlv4XpobvlnKjlvILmraXlpITnkIblrozmiJDml7bosIPnlKhhc3luY0VuZCjkuI3og73nnJ/lvILmraXml7bpnIDnlKhzZXRUaW1lb3V05YyF6KO5Ke+8jOWcqG9uUHJvY2Vzc+aJp+ihjOWQjuaWsOWinueahGJ1ZmZlcuS8muWFqOmDqOabv+aNouaIkOepuuaVsOe7hO+8jOWboOatpOacrOWbnuiwg+W8gOWktOW6lOeri+WNs+Wwhm5ld0J1ZmZlcklkeOWIsOacrOasoeWbnuiwg+e7k+WwvuS9jee9rueahGJ1ZmZlcuWFqOmDqOS/neWtmOWIsOWPpuWkluS4gOS4quaVsOe7hOWGhe+8jOWkhOeQhuWujOaIkOWQjuWGmeWbnmJ1ZmZlcnPkuK3mnKzmrKHlm57osIPnmoTnu5PlsL7kvY3nva7jgIJcblx0XHRcblx0XHQvLyoqKioqKirpq5jnuqforr7nva4qKioqKipcblx0XHQvLyxkaXNhYmxlRW52SW5GaXg6ZmFsc2Ug5YaF6YOo5Y+C5pWw77yM56aB55So6K6+5aSH5Y2h6aG/5pe26Z+z6aKR6L6T5YWl5Lii5aSx6KGl5YG/5Yqf6IO9XG5cdFx0XG5cdFx0Ly8sdGFrZW9mZkVuY29kZUNodW5rOk5PT1AgLy9mbihjaHVua0J5dGVzKSBjaHVua0J5dGVzPVtVaW50OCwuLi5d77ya5a6e5pe257yW56CB546v5aKD5LiL5o6l566h57yW56CB5Zmo6L6T5Ye677yM5b2T57yW56CB5Zmo5a6e5pe257yW56CB5Ye65LiA5Z2X5pyJ5pWI55qE5LqM6L+b5Yi26Z+z6aKR5pWw5o2u5pe25a6e5pe25Zue6LCD5q2k5pa55rOV77yb5Y+C5pWw5Li65LqM6L+b5Yi255qEVWludDhBcnJhee+8jOWwseaYr+e8lueggeWHuuadpeeahOmfs+mikeaVsOaNrueJh+aute+8jOaJgOacieeahGNodW5rQnl0ZXPmi7zmjqXlnKjkuIDotbfljbPkuLrlrozmlbTpn7PpopHjgILmnKzlrp7njrDnmoTmg7Pms5XmnIDliJ3nlLFRUTI1NDM3NzUwNDjmj5Dlh7pcblx0XHRcdFx0Ly/lvZPmj5DkvpvmraTlm57osIPmlrnms5Xml7bvvIzlsIbmjqXnrqHnvJbnoIHlmajnmoTmlbDmja7ovpPlh7rvvIznvJbnoIHlmajlhoXpg6jlsIbmlL7lvIPlrZjlgqjnlJ/miJDnmoTpn7PpopHmlbDmja7vvJvnjq/looPopoHmsYLmr5TovoPoi5vliLvvvJrlpoLmnpzlvZPliY3njq/looPkuI3mlK/mjIHlrp7ml7bnvJbnoIHlpITnkIbvvIzlsIblnKhvcGVu5pe255u05o6l6LWwZmFpbOmAu+i+kVxuXHRcdFx0XHQvL+WboOatpOaPkOS+m+atpOWbnuiwg+WQjuiwg+eUqHN0b3Dmlrnms5XlsIbml6Dms5XojrflvpfmnInmlYjnmoTpn7PpopHmlbDmja7vvIzlm6DkuLrnvJbnoIHlmajlhoXmsqHmnInpn7PpopHmlbDmja7vvIzlm6DmraRzdG9w5pe26L+U5Zue55qEYmxvYuWwhuaYr+S4gOS4quWtl+iKgumVv+W6puS4ujDnmoRibG9iXG5cdFx0XHRcdC8v55uu5YmN5Y+q5pyJbXAz5qC85byP5a6e546w5LqG5a6e5pe257yW56CB77yM5Zyo5pSv5oyB5a6e5pe25aSE55CG55qE546v5aKD5Lit5bCG5Lya5a6e5pe255qE5bCG57yW56CB5Ye65p2l55qEbXAz54mH5q616YCa6L+H5q2k5pa55rOV5Zue6LCD77yM5omA5pyJ55qEY2h1bmtCeXRlc+aLvOaOpeWIsOS4gOi1t+WNs+S4uuWujOaVtOeahG1wM++8jOatpOenjeaLvOaOpeeahOe7k+aenOavlG1vY2vmlrnms5Xlrp7ml7bnlJ/miJDnmoTpn7PotKjmm7TliqDvvIzlm6DkuLrlpKnnhLbpgb/lhY3kuobpppblsL7nmoTpnZnpu5hcblx0XHRcdFx0Ly/nm67liY3pmaRtcDPlpJblhbbku5bmoLzlvI/kuI3lj6/ku6Xmj5DkvpvmraTlm57osIPvvIzmj5DkvpvkuoblsIblnKhvcGVu5pe255u05o6l6LWwZmFpbOmAu+i+kVxuXHR9O1xuXHRcblx0Zm9yKHZhciBrIGluIHNldCl7XG5cdFx0b1trXT1zZXRba107XG5cdH07XG5cdHRoaXMuc2V0PW87XG5cdFxuXHR0aGlzLl9TPTk7Ly9zdG9w5ZCM5q2l6ZSB77yMc3RvcOWPr+S7pemYu+atom9wZW7ov4fnqIvkuK3ov5jmnKrov5DooYznmoRzdGFydFxufTtcbi8v5ZCM5q2l6ZSB77yM5o6n5Yi25a+5U3RyZWFt55qE56ue5LqJ77yb55So5LqOY2xvc2Xml7bkuK3mlq3lvILmraXnmoRvcGVu77yb5LiA5Liq5a+56LGhb3BlbuWmguaenOWPmOWMluS6humDveimgemYu+atomNsb3Nl77yMU3RyZWFt55qE5o6n5Yi25p2D5Lqk5Liq5paw55qE5a+56LGhXG5SZWNvcmRlci5TeW5jPXsvKm9wZW4qL086OSwvKmNsb3NlKi9DOjl9O1xuXG5SZWNvcmRlci5wcm90b3R5cGU9aW5pdEZuLnByb3RvdHlwZT17XG5cdC8v5omT5byA5b2V6Z+z6LWE5rqQVHJ1ZSgpLEZhbHNlKG1zZyxpc1VzZXJOb3RBbGxvdynvvIzpnIDopoHosIPnlKhjbG9zZeOAguazqOaEj++8muatpOaWueazleaYr+W8guatpeeahO+8m+S4gOiIrOS9v+eUqOaXtuaJk+W8gO+8jOeUqOWujOeri+WNs+WFs+mXre+8m+WPr+mHjeWkjeiwg+eUqO+8jOWPr+eUqOadpea1i+ivleaYr+WQpuiDveW9lemfs1xuXHRvcGVuOmZ1bmN0aW9uKFRydWUsRmFsc2Upe1xuXHRcdHZhciBUaGlzPXRoaXM7XG5cdFx0VHJ1ZT1UcnVlfHxOT09QO1xuXHRcdHZhciBmYWlsQ2FsbD1mdW5jdGlvbihlcnJNc2csaXNVc2VyTm90QWxsb3cpe1xuXHRcdFx0aXNVc2VyTm90QWxsb3c9ISFpc1VzZXJOb3RBbGxvdztcblx0XHRcdENMb2coXCLlvZXpn7NvcGVu5aSx6LSl77yaXCIrZXJyTXNnK1wiLGlzVXNlck5vdEFsbG93OlwiK2lzVXNlck5vdEFsbG93LDEpO1xuXHRcdFx0RmFsc2UmJkZhbHNlKGVyck1zZyxpc1VzZXJOb3RBbGxvdyk7XG5cdFx0fTtcblx0XHRcblx0XHR2YXIgb2s9ZnVuY3Rpb24oKXtcblx0XHRcdENMb2coXCJvcGVu5oiQ5YqfXCIpO1xuXHRcdFx0VHJ1ZSgpO1xuXHRcdFx0XG5cdFx0XHRUaGlzLl9TTz0wOy8v6Kej6Zmkc3RvcOWvuW9wZW7kuK3nmoRzdGFydOiwg+eUqOeahOmYu+atolxuXHRcdH07XG5cdFx0dmFyIGNvZGVGYWlsPWZ1bmN0aW9uKGNvZGUsbXNnKXtcblx0XHRcdHRyeXsvL+i3qOWfn+eahOS8mOWFiOajgOa1i+S4gOS4i1xuXHRcdFx0XHR3aW5kb3cudG9wLmE7XG5cdFx0XHR9Y2F0Y2goZSl7XG5cdFx0XHRcdGZhaWxDYWxsKCfml6DmnYPlvZXpn7Mo6Leo5Z+f77yM6K+35bCd6K+V57uZaWZyYW1l5re75Yqg6bqm5YWL6aOO6K6/6Zeu562W55Wl77yM5aaCYWxsb3c9XCJjYW1lcmE7bWljcm9waG9uZVwiKScpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9O1xuXHRcdFx0XG5cdFx0XHRpZigvUGVybWlzc2lvbnxBbGxvdy9pLnRlc3QoY29kZSkpe1xuXHRcdFx0XHRmYWlsQ2FsbChcIueUqOaIt+aLkue7neS6huW9lemfs+adg+mZkFwiLHRydWUpO1xuXHRcdFx0fWVsc2UgaWYod2luZG93LmlzU2VjdXJlQ29udGV4dD09PWZhbHNlKXtcblx0XHRcdFx0ZmFpbENhbGwoXCLml6DmnYPlvZXpn7Mo6ZyAaHR0cHMpXCIpO1xuXHRcdFx0fWVsc2UgaWYoL0ZvdW5kL2kudGVzdChjb2RlKSl7Ly/lj6/og73mmK/pnZ7lronlhajnjq/looPlr7zoh7TnmoTmsqHmnInorr7lpIdcblx0XHRcdFx0ZmFpbENhbGwobXNnK1wi77yM5peg5Y+v55So6bqm5YWL6aOOXCIpO1xuXHRcdFx0fWVsc2V7XG5cdFx0XHRcdGZhaWxDYWxsKG1zZyk7XG5cdFx0XHR9O1xuXHRcdH07XG5cdFx0XG5cdFx0Ly/lkIzmraXplIFcblx0XHR2YXIgTG9jaz1SZWNvcmRlci5TeW5jO1xuXHRcdHZhciBsb2NrT3Blbj0rK0xvY2suTyxsb2NrQ2xvc2U9TG9jay5DO1xuXHRcdFRoaXMuX089VGhpcy5fT189bG9ja09wZW47Ly/orrDkvY/lvZPliY3nmoRvcGVu77yM5aaC5p6c5Y+Y5YyW5LqG6KaB6Zi75q2iY2xvc2XvvIzov5nph4zlgYflrprkuobmlrDlr7nosaHlt7Llj5bku6PlvZPliY3lr7nosaHlubbkuJTkuI3lho3kvb/nlKhcblx0XHRUaGlzLl9TTz1UaGlzLl9TOy8v6K6w5L2Pb3Blbui/h+eoi+S4reeahHN0b3DvvIzkuK3pgJTku7vkvZVzdG9w6LCD55So5ZCO6YO95LiN6IO957un57utb3BlbuS4reeahHN0YXJ0XG5cdFx0dmFyIGxvY2tGYWlsPWZ1bmN0aW9uKCl7XG5cdFx0XHQvL+WFgeiuuOWkmuasoW9wZW7vvIzkvYbkuI3lhYHorrjku7vkvZXkuIDmrKFjbG9zZe+8jOaIluiAheiHqui6q+W3sue7j+iwg+eUqOS6huWFs+mXrVxuXHRcdFx0aWYobG9ja0Nsb3NlIT1Mb2NrLkMgfHwgIVRoaXMuX08pe1xuXHRcdFx0XHR2YXIgZXJyPVwib3Blbuiiq+WPlua2iFwiO1xuXHRcdFx0XHRpZihsb2NrT3Blbj09TG9jay5PKXtcblx0XHRcdFx0XHQvL+aXoOaWsOeahG9wZW7vvIzlt7Lnu4/osIPnlKjkuoZjbG9zZei/m+ihjOWPlua2iO+8jOatpOWkhOW6lOiuqeS4iuasoeeahGNsb3Nl5piO56Gu55Sf5pWIXG5cdFx0XHRcdFx0VGhpcy5jbG9zZSgpO1xuXHRcdFx0XHR9ZWxzZXtcblx0XHRcdFx0XHRlcnI9XCJvcGVu6KKr5Lit5patXCI7XG5cdFx0XHRcdH07XG5cdFx0XHRcdGZhaWxDYWxsKGVycik7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fTtcblx0XHR9O1xuXHRcdFxuXHRcdFxuXHRcdC8v5aaC5p6c5bey5omT5byA5bCx5LiN6KaB5YaN5omT5byA5LqGXG5cdFx0aWYoUmVjb3JkZXIuSXNPcGVuKCkpe1xuXHRcdFx0b2soKTtcblx0XHRcdHJldHVybjtcblx0XHR9O1xuXHRcdGlmKCFSZWNvcmRlci5TdXBwb3J0KCkpe1xuXHRcdFx0Y29kZUZhaWwoXCJcIixcIuatpOa1j+iniOWZqOS4jeaUr+aMgeW9lemfs1wiKTtcblx0XHRcdHJldHVybjtcblx0XHR9O1xuXHRcdFxuXHRcdC8v546v5aKD6YWN572u5qOA5p+lXG5cdFx0dmFyIGNoZWNrTXNnPVRoaXMuZW52Q2hlY2soe2Vudk5hbWU6XCJINVwiLGNhblByb2Nlc3M6dHJ1ZX0pO1xuXHRcdGlmKGNoZWNrTXNnKXtcblx0XHRcdGZhaWxDYWxsKFwi5LiN6IO95b2V6Z+z77yaXCIrY2hlY2tNc2cpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH07XG5cdFx0XG5cdFx0Ly/or7fmsYLmnYPpmZDvvIzlpoLmnpzku47mnKrmjojmnYPvvIzkuIDoiKzmtY/op4jlmajkvJrlvLnlh7rmnYPpmZDor7fmsYLlvLnmoYZcblx0XHR2YXIgZjE9ZnVuY3Rpb24oc3RyZWFtKXtcblx0XHRcdFJlY29yZGVyLlN0cmVhbT1zdHJlYW07XG5cdFx0XHRzdHJlYW0uX2NhbGw9e307Ly/mraTml7ZpcyBvcGVu77yM5L2G5bm25pyqY29ubmVjdO+8jOaYr+WFgeiuuOe7keWumuaOpeaUtuaVsOaNrueahFxuXHRcdFx0aWYobG9ja0ZhaWwoKSlyZXR1cm47XG5cdFx0XHRcblx0XHRcdC8vaHR0cHM6Ly9naXRodWIuY29tL3hpYW5neXVlY24vUmVjb3JkZXIvaXNzdWVzLzE0IOiOt+WPluWIsOeahHRyYWNrLnJlYWR5U3RhdGUhPVwibGl2ZVwi77yM5Yia5Yia5Zue6LCD5pe25Y+v6IO95piv5q2j5bi455qE77yM5L2G6L+H5LiA5LiL5Y+v6IO95bCx6KKr5YWz5o6J5LqG77yM5Y6f5Zug5LiN5piO44CC5bu26L+f5LiA5LiL5L+d6K+B55yf5byC5q2l44CC5a+55q2j5bi45rWP6KeI5Zmo5LiN5b2x5ZONXG5cdFx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG5cdFx0XHRcdGlmKGxvY2tGYWlsKCkpcmV0dXJuO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYoUmVjb3JkZXIuSXNPcGVuKCkpe1xuXHRcdFx0XHRcdENvbm5lY3QoKTtcblx0XHRcdFx0XHRvaygpO1xuXHRcdFx0XHR9ZWxzZXtcblx0XHRcdFx0XHRmYWlsQ2FsbChcIuW9lemfs+WKn+iDveaXoOaViO+8muaXoOmfs+mikea1gVwiKTtcblx0XHRcdFx0fTtcblx0XHRcdH0sMTAwKTtcblx0XHR9O1xuXHRcdHZhciBmMj1mdW5jdGlvbihlKXtcblx0XHRcdHZhciBjb2RlPWUubmFtZXx8ZS5tZXNzYWdlfHxlLmNvZGUrXCI6XCIrZTtcblx0XHRcdENMb2coXCLor7fmsYLlvZXpn7PmnYPpmZDplJnor69cIiwxLGUpO1xuXHRcdFx0XG5cdFx0XHRjb2RlRmFpbChjb2RlLFwi5peg5rOV5b2V6Z+z77yaXCIrY29kZSk7XG5cdFx0fTtcblx0XHR2YXIgcHJvPVJlY29yZGVyLlNjb3BlLmdldFVzZXJNZWRpYSh7YXVkaW86dHJ1ZX0sZjEsZjIpO1xuXHRcdGlmKHBybyYmcHJvLnRoZW4pe1xuXHRcdFx0cHJvLnRoZW4oZjEpW1RydWUmJlwiY2F0Y2hcIl0oZjIpOyAvL2ZpeCDlhbPplK7lrZfvvIzkv53or4FjYXRjaOWOi+e8qeaXtuS/neaMgeWtl+espuS4suW9ouW8j1xuXHRcdH07XG5cdH1cblx0Ly/lhbPpl63ph4rmlL7lvZXpn7PotYTmupBcblx0LGNsb3NlOmZ1bmN0aW9uKGNhbGwpe1xuXHRcdGNhbGw9Y2FsbHx8Tk9PUDtcblx0XHRcblx0XHR2YXIgVGhpcz10aGlzO1xuXHRcdFRoaXMuX3N0b3AoKTtcblx0XHRcblx0XHR2YXIgTG9jaz1SZWNvcmRlci5TeW5jO1xuXHRcdFRoaXMuX089MDtcblx0XHRpZihUaGlzLl9PXyE9TG9jay5PKXtcblx0XHRcdC8v5ZSv5LiA6LWE5rqQU3RyZWFt55qE5o6n5Yi25p2D5bey5Lqk57uZ5paw5a+56LGh77yM6L+Z6YeM5LiN6IO95YWz6Zet44CC5q2k5aSE5Zyo5q+P5qyh6YO95by55p2D6ZmQ55qE5rWP6KeI5Zmo5YaF5Y+v6IO95a2Y5Zyo5rOE5ryP77yM5paw5a+56LGh6KKr5ouS57ud5p2D6ZmQ5Y+v6IO95LiN5Lya6LCD55SoY2xvc2XvvIzlv73nlaXov5nnp43kuI3lpITnkIZcblx0XHRcdENMb2coXCJjbG9zZeiiq+W/veeVpVwiLDMpO1xuXHRcdFx0Y2FsbCgpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH07XG5cdFx0TG9jay5DKys7Ly/ojrflvpfmjqfliLbmnYNcblx0XHRcblx0XHR2YXIgc3RyZWFtPVJlY29yZGVyLlN0cmVhbTtcblx0XHRpZihzdHJlYW0pe1xuXHRcdFx0RGlzY29ubmVjdCgpO1xuXHRcdFx0XG5cdFx0XHR2YXIgdHJhY2tzPXN0cmVhbS5nZXRUcmFja3MmJnN0cmVhbS5nZXRUcmFja3MoKXx8c3RyZWFtLmF1ZGlvVHJhY2tzfHxbXTtcblx0XHRcdGZvcih2YXIgaT0wO2k8dHJhY2tzLmxlbmd0aDtpKyspe1xuXHRcdFx0XHR2YXIgdHJhY2s9dHJhY2tzW2ldO1xuXHRcdFx0XHR0cmFjay5zdG9wJiZ0cmFjay5zdG9wKCk7XG5cdFx0XHR9O1xuXHRcdFx0c3RyZWFtLnN0b3AmJnN0cmVhbS5zdG9wKCk7XG5cdFx0fTtcblx0XHRcblx0XHRSZWNvcmRlci5TdHJlYW09MDtcblx0XHRDTG9nKFwiY2xvc2VcIik7XG5cdFx0Y2FsbCgpO1xuXHR9XG5cdFxuXHRcblx0XG5cdFxuXHRcblx0LyrmqKHmi5/kuIDmrrXlvZXpn7PmlbDmja7vvIzlkI7pnaLlj6/ku6XosIPnlKhzdG9w6L+b6KGM57yW56CB77yM6ZyA5o+Q5L6bcGNt5pWw5o2uWzEsMiwzLi4uXe+8jHBjbeeahOmHh+agt+eOhyovXG5cdCxtb2NrOmZ1bmN0aW9uKHBjbURhdGEscGNtU2FtcGxlUmF0ZSl7XG5cdFx0dmFyIFRoaXM9dGhpcztcblx0XHRUaGlzLl9zdG9wKCk7Ly/muIXnkIbmjonlt7LmnInnmoTotYTmupBcblx0XHRcblx0XHRUaGlzLmlzTW9jaz0xO1xuXHRcdFRoaXMubW9ja0VudkluZm89bnVsbDtcblx0XHRUaGlzLmJ1ZmZlcnM9W3BjbURhdGFdO1xuXHRcdFRoaXMucmVjU2l6ZT1wY21EYXRhLmxlbmd0aDtcblx0XHRUaGlzLnNyY1NhbXBsZVJhdGU9cGNtU2FtcGxlUmF0ZTtcblx0XHRyZXR1cm4gVGhpcztcblx0fVxuXHQsZW52Q2hlY2s6ZnVuY3Rpb24oZW52SW5mbyl7Ly/lubPlj7Dnjq/looPkuIvnmoTlj6/nlKjmgKfmo4Dmn6XvvIzku7vkvZXml7blgJnpg73lj6/ku6XosIPnlKjmo4Dmn6XvvIzov5Tlm55lcnJNc2c6XCJcIuato+W4uO+8jFwi5aSx6LSl5Y6f5ZugXCJcblx0XHQvL2VudkluZm89e2Vudk5hbWU6XCJINVwiLGNhblByb2Nlc3M6dHJ1ZX1cblx0XHR2YXIgZXJyTXNnLFRoaXM9dGhpcyxzZXQ9VGhpcy5zZXQ7XG5cdFx0XG5cdFx0Ly/nvJbnoIHlmajmo4Dmn6Xnjq/looPkuIvphY3nva7mmK/lkKblj6/nlKhcblx0XHRpZighZXJyTXNnKXtcblx0XHRcdGlmKFRoaXNbc2V0LnR5cGUrXCJfZW52Q2hlY2tcIl0pey8v57yW56CB5Zmo5bey5a6e546w546v5aKD5qOA5p+lXG5cdFx0XHRcdGVyck1zZz1UaGlzW3NldC50eXBlK1wiX2VudkNoZWNrXCJdKGVudkluZm8sc2V0KTtcblx0XHRcdH1lbHNley8v5pyq5a6e546w5qOA5p+l55qE5omL5Yqo5qOA5p+l6YWN572u5piv5ZCm5pyJ5pWIXG5cdFx0XHRcdGlmKHNldC50YWtlb2ZmRW5jb2RlQ2h1bmspe1xuXHRcdFx0XHRcdGVyck1zZz1zZXQudHlwZStcIuexu+Wei+S4jeaUr+aMgeiuvue9rnRha2VvZmZFbmNvZGVDaHVua1wiO1xuXHRcdFx0XHR9O1xuXHRcdFx0fTtcblx0XHR9O1xuXHRcdFxuXHRcdHJldHVybiBlcnJNc2d8fFwiXCI7XG5cdH1cblx0LGVudlN0YXJ0OmZ1bmN0aW9uKG1vY2tFbnZJbmZvLHNhbXBsZVJhdGUpey8v5bmz5Y+w546v5aKD55u45YWz55qEc3RhcnTosIPnlKhcblx0XHR2YXIgVGhpcz10aGlzLHNldD1UaGlzLnNldDtcblx0XHRUaGlzLmlzTW9jaz1tb2NrRW52SW5mbz8xOjA7Ly/pnZ5INeeOr+Wig+mcgOimgeWQr+eUqG1vY2vvvIzlubbmj5DkvptlbnZDaGVja+mcgOimgeeahOeOr+Wig+S/oeaBr1xuXHRcdFRoaXMubW9ja0VudkluZm89bW9ja0VudkluZm87XG5cdFx0VGhpcy5idWZmZXJzPVtdOy8v5pWw5o2u57yT5YayXG5cdFx0VGhpcy5yZWNTaXplPTA7Ly/mlbDmja7lpKflsI9cblx0XHRcblx0XHRUaGlzLmVudkluTGFzdD0wOy8vZW52SW7mjqXmlLbliLDmnIDlkI7lvZXpn7PlhoXlrrnnmoTml7bpl7Rcblx0XHRUaGlzLmVudkluRmlyc3Q9MDsvL2Vudklu5o6l5pS25Yiw55qE6aaW5Liq5b2V6Z+z5YaF5a6555qE5b2V5Yi25pe26Ze0XG5cdFx0VGhpcy5lbnZJbkZpeD0wOy8v6KGl5YG/55qE5oC75pe26Ze0XG5cdFx0VGhpcy5lbnZJbkZpeFRzPVtdOy8v6KGl5YG/6K6h5pWw5YiX6KGoXG5cdFx0XG5cdFx0c2V0LnNhbXBsZVJhdGU9TWF0aC5taW4oc2FtcGxlUmF0ZSxzZXQuc2FtcGxlUmF0ZSk7Ly9lbmdpbmVDdHjpnIDopoHmj5DliY3noa7lrprmnIDnu4jnmoTph4fmoLfnjodcblx0XHRUaGlzLnNyY1NhbXBsZVJhdGU9c2FtcGxlUmF0ZTtcblx0XHRcblx0XHRUaGlzLmVuZ2luZUN0eD0wO1xuXHRcdC8v5q2k57G75Z6L5pyJ6L655b2V6L656L2s56CBKFdvcmtlcinmlK/mjIFcblx0XHRpZihUaGlzW3NldC50eXBlK1wiX3N0YXJ0XCJdKXtcblx0XHRcdHZhciBlbmdpbmVDdHg9VGhpcy5lbmdpbmVDdHg9VGhpc1tzZXQudHlwZStcIl9zdGFydFwiXShzZXQpO1xuXHRcdFx0aWYoZW5naW5lQ3R4KXtcblx0XHRcdFx0ZW5naW5lQ3R4LnBjbURhdGFzPVtdO1xuXHRcdFx0XHRlbmdpbmVDdHgucGNtU2l6ZT0wO1xuXHRcdFx0fTtcblx0XHR9O1xuXHR9XG5cdCxlbnZSZXN1bWU6ZnVuY3Rpb24oKXsvL+WSjOW5s+WPsOeOr+Wig+aXoOWFs+eahOaBouWkjeW9lemfs1xuXHRcdC8v6YeN5paw5byA5aeL6K6h5pWwXG5cdFx0dGhpcy5lbnZJbkZpeFRzPVtdO1xuXHR9XG5cdCxlbnZJbjpmdW5jdGlvbihwY20sc3VtKXsvL+WSjOW5s+WPsOeOr+Wig+aXoOWFs+eahHBjbVtJbnQxNl3ovpPlhaVcblx0XHR2YXIgVGhpcz10aGlzLHNldD1UaGlzLnNldCxlbmdpbmVDdHg9VGhpcy5lbmdpbmVDdHg7XG5cdFx0dmFyIGJ1ZmZlclNhbXBsZVJhdGU9VGhpcy5zcmNTYW1wbGVSYXRlO1xuXHRcdHZhciBzaXplPXBjbS5sZW5ndGg7XG5cdFx0dmFyIHBvd2VyTGV2ZWw9UmVjb3JkZXIuUG93ZXJMZXZlbChzdW0sc2l6ZSk7XG5cdFx0XG5cdFx0dmFyIGJ1ZmZlcnM9VGhpcy5idWZmZXJzO1xuXHRcdHZhciBidWZmZXJGaXJzdElkeD1idWZmZXJzLmxlbmd0aDsvL+S5i+WJjeeahGJ1ZmZlcumDveaYr+e7j+i/h29uUHJvY2Vzc+WkhOeQhuWlveeahO+8jOS4jeWFgeiuuOWGjeS/ruaUuVxuXHRcdGJ1ZmZlcnMucHVzaChwY20pO1xuXHRcdFxuXHRcdC8v5pyJZW5naW5lQ3R45pe25Lya6KKr6KaG55uW77yM6L+Z6YeM5L+d5a2Y5LiA5Lu9XG5cdFx0dmFyIGJ1ZmZlcnNUaGlzPWJ1ZmZlcnM7XG5cdFx0dmFyIGJ1ZmZlckZpcnN0SWR4VGhpcz1idWZmZXJGaXJzdElkeDtcblx0XHRcblx0XHQvL+WNoemhv+S4ouWkseihpeWBv++8muWboOS4uuiuvuWkh+W+iOWNoeeahOaXtuWAmeWvvOiHtEg15o6l5pS25Yiw55qE5pWw5o2u6YeP5LiN5aSf6YCg5oiQ5pKt5pS+5pe25YCZ5Y+Y6YCf77yM57uT5p6c5q+U5a6e6ZmF55qE5pe26ZW/6KaB55+t77yM5q2k5aSE5L+d6K+B5LqG5LiN5Lya5Y+Y55+t77yM5L2G5LiN6IO95L+u5aSN5Lii5aSx55qE6Z+z6aKR5pWw5o2u6YCg5oiQ6Z+z6LSo5Y+Y5beu44CC5b2T5YmN566X5rOV6YeH55So6L6T5YWl5pe26Ze05L6m5rWL5LiL5LiA5bin5piv5ZCm6ZyA6KaB5re75Yqg6KGl5YG/5bin77yM6ZyA6KaBKDbmrKHovpPlhaV8fOi2hei/hzHnp5Ip5Lul5LiK5omN5Lya5byA5aeL5L6m5rWL77yM5aaC5p6c5ruR5Yqo56qX5Y+j5YaF5Lii5aSx6LaF6L+HMS8z5bCx5Lya6L+b6KGM6KGl5YG/XG5cdFx0dmFyIG5vdz1EYXRlLm5vdygpO1xuXHRcdHZhciBwY21UaW1lPU1hdGgucm91bmQoc2l6ZS9idWZmZXJTYW1wbGVSYXRlKjEwMDApO1xuXHRcdFRoaXMuZW52SW5MYXN0PW5vdztcblx0XHRpZihUaGlzLmJ1ZmZlcnMubGVuZ3RoPT0xKXsvL+iusOS4i+mmluS4quW9lemfs+aVsOaNrueahOW9leWItuaXtumXtFxuXHRcdFx0VGhpcy5lbnZJbkZpcnN0PW5vdy1wY21UaW1lO1xuXHRcdH07XG5cdFx0dmFyIGVudkluRml4VHM9VGhpcy5lbnZJbkZpeFRzO1xuXHRcdGVudkluRml4VHMuc3BsaWNlKDAsMCx7dDpub3csZDpwY21UaW1lfSk7XG5cdFx0Ly/kv53nlZkz56eS55qE6K6h5pWw5ruR5Yqo56qX5Y+j77yM5Y+m5aSW6LaF6L+HM+enkueahOWBnOmhv+S4jeihpeWBv1xuXHRcdHZhciB0c0luU3RhcnQ9bm93LHRzUGNtPTA7XG5cdFx0Zm9yKHZhciBpPTA7aTxlbnZJbkZpeFRzLmxlbmd0aDtpKyspe1xuXHRcdFx0dmFyIG89ZW52SW5GaXhUc1tpXTtcblx0XHRcdGlmKG5vdy1vLnQ+MzAwMCl7XG5cdFx0XHRcdGVudkluRml4VHMubGVuZ3RoPWk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fTtcblx0XHRcdHRzSW5TdGFydD1vLnQ7XG5cdFx0XHR0c1BjbSs9by5kO1xuXHRcdH07XG5cdFx0Ly/ovr7liLDpnIDopoHnmoTmlbDmja7ph4/vvIzlvIDlp4vkvqbmtYvmmK/lkKbpnIDopoHooaXlgb9cblx0XHR2YXIgdHNJblByZXY9ZW52SW5GaXhUc1sxXTtcblx0XHR2YXIgdHNJbj1ub3ctdHNJblN0YXJ0O1xuXHRcdHZhciBsb3N0PXRzSW4tdHNQY207XG5cdFx0aWYoIGxvc3Q+dHNJbi8zICYmICh0c0luUHJldiYmdHNJbj4xMDAwIHx8IGVudkluRml4VHMubGVuZ3RoPj02KSApe1xuXHRcdFx0Ly/kuKLlpLHov4flpJrvvIzlvIDlp4vmiafooYzooaXlgb9cblx0XHRcdHZhciBhZGRUaW1lPW5vdy10c0luUHJldi50LXBjbVRpbWU7Ly/ot53nprvkuIrmrKHovpPlhaXkuKLlpLHov5nkuYjlpJptc1xuXHRcdFx0aWYoYWRkVGltZT5wY21UaW1lLzUpey8v5Lii5aSx6LaF6L+H5pys5bin55qEMS81XG5cdFx0XHRcdHZhciBmaXhPcGVuPSFzZXQuZGlzYWJsZUVudkluRml4O1xuXHRcdFx0XHRDTG9nKFwiW1wiK25vdytcIl1cIisoZml4T3Blbj9cIlwiOlwi5pyqXCIpK1wi6KGl5YG/XCIrYWRkVGltZStcIm1zXCIsMyk7XG5cdFx0XHRcdFRoaXMuZW52SW5GaXgrPWFkZFRpbWU7XG5cdFx0XHRcdFxuXHRcdFx0XHQvL+eUqOmdmem7mOi/m+ihjOihpeWBv1xuXHRcdFx0XHRpZihmaXhPcGVuKXtcblx0XHRcdFx0XHR2YXIgYWRkUGNtPW5ldyBJbnQxNkFycmF5KGFkZFRpbWUqYnVmZmVyU2FtcGxlUmF0ZS8xMDAwKTtcblx0XHRcdFx0XHRzaXplKz1hZGRQY20ubGVuZ3RoO1xuXHRcdFx0XHRcdGJ1ZmZlcnMucHVzaChhZGRQY20pO1xuXHRcdFx0XHR9O1xuXHRcdFx0fTtcblx0XHR9O1xuXHRcdFxuXHRcdFxuXHRcdHZhciBzaXplT2xkPVRoaXMucmVjU2l6ZSxhZGRTaXplPXNpemU7XG5cdFx0dmFyIGJ1ZmZlclNpemU9c2l6ZU9sZCthZGRTaXplO1xuXHRcdFRoaXMucmVjU2l6ZT1idWZmZXJTaXplOy8v5q2k5YC85Zyob25Qcm9jZXNz5ZCO6ZyA6KaB5L+u5q2j77yM5Y+v6IO95paw5pWw5o2u6KKr5L+u5pS5XG5cdFx0XG5cdFx0XG5cdFx0Ly/mraTnsbvlnovmnInovrnlvZXovrnovaznoIEoV29ya2VyKeaUr+aMge+8jOW8gOWQr+WunuaXtui9rOeggVxuXHRcdGlmKGVuZ2luZUN0eCl7XG5cdFx0XHQvL+i9rOaNouaIkHNldOeahOmHh+agt+eOh1xuXHRcdFx0dmFyIGNodW5rSW5mbz1SZWNvcmRlci5TYW1wbGVEYXRhKGJ1ZmZlcnMsYnVmZmVyU2FtcGxlUmF0ZSxzZXQuc2FtcGxlUmF0ZSxlbmdpbmVDdHguY2h1bmtJbmZvKTtcblx0XHRcdGVuZ2luZUN0eC5jaHVua0luZm89Y2h1bmtJbmZvO1xuXHRcdFx0XG5cdFx0XHRzaXplT2xkPWVuZ2luZUN0eC5wY21TaXplO1xuXHRcdFx0YWRkU2l6ZT1jaHVua0luZm8uZGF0YS5sZW5ndGg7XG5cdFx0XHRidWZmZXJTaXplPXNpemVPbGQrYWRkU2l6ZTtcblx0XHRcdGVuZ2luZUN0eC5wY21TaXplPWJ1ZmZlclNpemU7Ly/mraTlgLzlnKhvblByb2Nlc3PlkI7pnIDopoHkv67mraPvvIzlj6/og73mlrDmlbDmja7ooqvkv67mlLlcblx0XHRcdFxuXHRcdFx0YnVmZmVycz1lbmdpbmVDdHgucGNtRGF0YXM7XG5cdFx0XHRidWZmZXJGaXJzdElkeD1idWZmZXJzLmxlbmd0aDtcblx0XHRcdGJ1ZmZlcnMucHVzaChjaHVua0luZm8uZGF0YSk7XG5cdFx0XHRidWZmZXJTYW1wbGVSYXRlPWNodW5rSW5mby5zYW1wbGVSYXRlO1xuXHRcdH07XG5cdFx0XG5cdFx0dmFyIGR1cmF0aW9uPU1hdGgucm91bmQoYnVmZmVyU2l6ZS9idWZmZXJTYW1wbGVSYXRlKjEwMDApO1xuXHRcdHZhciBidWZmZXJOZXh0SWR4PWJ1ZmZlcnMubGVuZ3RoO1xuXHRcdHZhciBidWZmZXJOZXh0SWR4VGhpcz1idWZmZXJzVGhpcy5sZW5ndGg7XG5cdFx0XG5cdFx0Ly/lhYHorrjlvILmraXlpITnkIZidWZmZXLmlbDmja5cblx0XHR2YXIgYXN5bmNFbmQ9ZnVuY3Rpb24oKXtcblx0XHRcdC8v6YeN5paw6K6h566Xc2l6Ze+8jOW8guatpeeahOaXqeW3suWHj+WOu+a3u+WKoOeahO+8jOWQjOatpeeahOmcgOWOu+aOieacrOasoea3u+WKoOeahOeEtuWQjumHjeaWsOiuoeeul1xuXHRcdFx0dmFyIG51bT1hc3luY0JlZ2luPzA6LWFkZFNpemU7XG5cdFx0XHR2YXIgaGFzQ2xlYXI9YnVmZmVyc1swXT09bnVsbDtcblx0XHRcdGZvcih2YXIgaT1idWZmZXJGaXJzdElkeDtpPGJ1ZmZlck5leHRJZHg7aSsrKXtcblx0XHRcdFx0dmFyIGJ1ZmZlcj1idWZmZXJzW2ldO1xuXHRcdFx0XHRpZihidWZmZXI9PW51bGwpey8v5bey6KKr5Li75Yqo6YeK5pS+5YaF5a2Y77yM5q+U5aaC6ZW/5pe26Ze05a6e5pe25Lyg6L6T5b2V6Z+z5pe2XG5cdFx0XHRcdFx0aGFzQ2xlYXI9MTtcblx0XHRcdFx0fWVsc2V7XG5cdFx0XHRcdFx0bnVtKz1idWZmZXIubGVuZ3RoO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8v5o6o5YWl5ZCO5Y+w6L655b2V6L656L2s56CBXG5cdFx0XHRcdFx0aWYoZW5naW5lQ3R4JiZidWZmZXIubGVuZ3RoKXtcblx0XHRcdFx0XHRcdFRoaXNbc2V0LnR5cGUrXCJfZW5jb2RlXCJdKGVuZ2luZUN0eCxidWZmZXIpO1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH07XG5cdFx0XHR9O1xuXHRcdFx0XG5cdFx0XHQvL+WQjOatpea4heeQhlRoaXMuYnVmZmVyc++8jOS4jeeuoWJ1ZmZlcnPliLDlupXmuIXkuoblpJrlsJHkuKrvvIxidWZmZXJzVGhpc+aYr+S9v+eUqOS4jeWIsOeahOi/m+ihjOWFqOa4hVxuXHRcdFx0aWYoaGFzQ2xlYXIgJiYgZW5naW5lQ3R4KXtcblx0XHRcdFx0dmFyIGk9YnVmZmVyRmlyc3RJZHhUaGlzO1xuXHRcdFx0XHRpZihidWZmZXJzVGhpc1swXSl7XG5cdFx0XHRcdFx0aT0wO1xuXHRcdFx0XHR9O1xuXHRcdFx0XHRmb3IoO2k8YnVmZmVyTmV4dElkeFRoaXM7aSsrKXtcblx0XHRcdFx0XHRidWZmZXJzVGhpc1tpXT1udWxsO1xuXHRcdFx0XHR9O1xuXHRcdFx0fTtcblx0XHRcdFxuXHRcdFx0Ly/nu5/orqHkv67mlLnlkI7nmoRzaXpl77yM5aaC5p6c5byC5q2l5Y+R55SfY2xlYXLopoHljp/moLfliqDlm57mnaXvvIzlkIzmraXnmoTml6DpnIDmk43kvZxcblx0XHRcdGlmKGhhc0NsZWFyKXtcblx0XHRcdFx0bnVtPWFzeW5jQmVnaW4/YWRkU2l6ZTowO1xuXHRcdFx0XHRcblx0XHRcdFx0YnVmZmVyc1swXT1udWxsOy8v5b275bqV6KKr5riF55CGXG5cdFx0XHR9O1xuXHRcdFx0aWYoZW5naW5lQ3R4KXtcblx0XHRcdFx0ZW5naW5lQ3R4LnBjbVNpemUrPW51bTtcblx0XHRcdH1lbHNle1xuXHRcdFx0XHRUaGlzLnJlY1NpemUrPW51bTtcblx0XHRcdH07XG5cdFx0fTtcblx0XHQvL+WunuaXtuWbnuiwg+WkhOeQhuaVsOaNru+8jOWFgeiuuOS/ruaUueaIluabv+aNouS4iuasoeWbnuiwg+S7peadpeaWsOWinueahOaVsOaNriDvvIzkvYbmmK/kuI3lhYHorrjkv67mlLnlt7LlpITnkIbov4fnmoTvvIzkuI3lhYHorrjlop7liKDnrKzkuIDnu7TmlbDnu4Qg77yM5YWB6K645bCG56ys5LqM57u05pWw57uE5Lu75oSP5L+u5pS55pu/5o2i5oiQ56m65pWw57uE5Lmf5Y+v5LulXG5cdFx0dmFyIGFzeW5jQmVnaW49c2V0Lm9uUHJvY2VzcyhidWZmZXJzLHBvd2VyTGV2ZWwsZHVyYXRpb24sYnVmZmVyU2FtcGxlUmF0ZSxidWZmZXJGaXJzdElkeCxhc3luY0VuZCk7XG5cdFx0XG5cdFx0aWYoYXN5bmNCZWdpbj09PXRydWUpe1xuXHRcdFx0Ly/lvIDlkK/kuoblvILmraXmqKHlvI/vvIxvblByb2Nlc3Plt7LmjqXnrqFidWZmZXJz5paw5pWw5o2u77yM56uL5Y2z5riF56m677yM6YG/5YWN5Ye6546w5pyq5aSE55CG55qE5pWw5o2uXG5cdFx0XHR2YXIgaGFzQ2xlYXI9MDtcblx0XHRcdGZvcih2YXIgaT1idWZmZXJGaXJzdElkeDtpPGJ1ZmZlck5leHRJZHg7aSsrKXtcblx0XHRcdFx0aWYoYnVmZmVyc1tpXT09bnVsbCl7Ly/lt7LooqvkuLvliqjph4rmlL7lhoXlrZjvvIzmr5TlpoLplb/ml7bpl7Tlrp7ml7bkvKDovpPlvZXpn7Pml7Yg77yM5L2G5Y+I6KaB5byA5ZCv5byC5q2l5qih5byP77yM5q2k56eN5oOF5Ya15piv6Z2e5rOV55qEXG5cdFx0XHRcdFx0aGFzQ2xlYXI9MTtcblx0XHRcdFx0fWVsc2V7XG5cdFx0XHRcdFx0YnVmZmVyc1tpXT1uZXcgSW50MTZBcnJheSgwKTtcblx0XHRcdFx0fTtcblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdGlmKGhhc0NsZWFyKXtcblx0XHRcdFx0Q0xvZyhcIuacqui/m+WFpeW8guatpeWJjeS4jeiDvea4hemZpGJ1ZmZlcnNcIiwzKTtcblx0XHRcdH1lbHNle1xuXHRcdFx0XHQvL+i/mOWOn3NpemXvvIzlvILmraXnu5PmnZ/lkI7lho3nu5/orqHku4Xkv67mlLnlkI7nmoRzaXpl77yM5aaC5p6c5Y+R55SfY2xlYXLopoHljp/moLfliqDlm57mnaVcblx0XHRcdFx0aWYoZW5naW5lQ3R4KXtcblx0XHRcdFx0XHRlbmdpbmVDdHgucGNtU2l6ZS09YWRkU2l6ZTtcblx0XHRcdFx0fWVsc2V7XG5cdFx0XHRcdFx0VGhpcy5yZWNTaXplLT1hZGRTaXplO1xuXHRcdFx0XHR9O1xuXHRcdFx0fTtcblx0XHR9ZWxzZXtcblx0XHRcdGFzeW5jRW5kKCk7XG5cdFx0fTtcblx0fVxuXHRcblx0XG5cdFxuXHRcblx0Ly/lvIDlp4vlvZXpn7PvvIzpnIDlhYjosIPnlKhvcGVu77yb5Y+q6KaBb3BlbuaIkOWKn+aXtu+8jOiwg+eUqOatpOaWueazleaYr+WuieWFqOeahO+8jOWmguaenOacqm9wZW7lvLrooYzosIPnlKjlr7zoh7TnmoTlhoXpg6jplJnor6/lsIbkuI3kvJrmnInku7vkvZXmj5DnpLrvvIxzdG9w5pe26Ieq54S26IO95b6X5Yiw6ZSZ6K+vXG5cdCxzdGFydDpmdW5jdGlvbigpe1xuXHRcdGlmKCFSZWNvcmRlci5Jc09wZW4oKSl7XG5cdFx0XHRDTG9nKFwi5pyqb3BlblwiLDEpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH07XG5cdFx0Q0xvZyhcIuW8gOWni+W9lemfs1wiKTtcblx0XHRcblx0XHR2YXIgVGhpcz10aGlzLHNldD1UaGlzLnNldCxjdHg9UmVjb3JkZXIuQ3R4O1xuXHRcdFRoaXMuX3N0b3AoKTtcblx0XHRUaGlzLnN0YXRlPTA7XG5cdFx0VGhpcy5lbnZTdGFydChudWxsLGN0eC5zYW1wbGVSYXRlKTtcblx0XHRcblx0XHQvL+ajgOafpW9wZW7ov4fnqIvkuK1zdG9w5piv5ZCm5bey57uP6LCD55So6L+HXG5cdFx0aWYoVGhpcy5fU08mJlRoaXMuX1NPKzEhPVRoaXMuX1Mpey8v5LiK6Z2i6LCD55So6L+H5LiA5qyhIF9zdG9wXG5cdFx0XHQvL29wZW7mnKrlrozmiJDlsLHosIPnlKjkuoZzdG9w77yM5q2k56eN5oOF5Ya157uI5q2ic3RhcnTjgILkuZ/lupTlsL3ph4/pgb/lhY3lh7rnjrDmraTmg4XlhrVcblx0XHRcdENMb2coXCJzdGFydOiiq+S4reaWrVwiLDMpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH07XG5cdFx0VGhpcy5fU089MDtcblx0XHRcblx0XHR2YXIgZW5kPWZ1bmN0aW9uKCl7XG5cdFx0XHRUaGlzLnN0YXRlPTE7XG5cdFx0XHRUaGlzLnJlc3VtZSgpO1xuXHRcdH07XG5cdFx0aWYoY3R4LnN0YXRlPT1cInN1c3BlbmRlZFwiKXtcblx0XHRcdGN0eC5yZXN1bWUoKS50aGVuKGZ1bmN0aW9uKCl7XG5cdFx0XHRcdENMb2coXCJjdHggcmVzdW1lXCIpO1xuXHRcdFx0XHRlbmQoKTtcblx0XHRcdH0pO1xuXHRcdH1lbHNle1xuXHRcdFx0ZW5kKCk7XG5cdFx0fTtcblx0fVxuXHQvKuaaguWBnOW9lemfsyovXG5cdCxwYXVzZTpmdW5jdGlvbigpe1xuXHRcdHZhciBUaGlzPXRoaXM7XG5cdFx0aWYoVGhpcy5zdGF0ZSl7XG5cdFx0XHRUaGlzLnN0YXRlPTI7XG5cdFx0XHRDTG9nKFwicGF1c2VcIik7XG5cdFx0XHRkZWxldGUgUmVjb3JkZXIuU3RyZWFtLl9jYWxsW1RoaXMuaWRdO1xuXHRcdH07XG5cdH1cblx0LyrmgaLlpI3lvZXpn7MqL1xuXHQscmVzdW1lOmZ1bmN0aW9uKCl7XG5cdFx0dmFyIFRoaXM9dGhpcztcblx0XHRpZihUaGlzLnN0YXRlKXtcblx0XHRcdFRoaXMuc3RhdGU9MTtcblx0XHRcdENMb2coXCJyZXN1bWVcIik7XG5cdFx0XHRUaGlzLmVudlJlc3VtZSgpO1xuXHRcdFx0XG5cdFx0XHRSZWNvcmRlci5TdHJlYW0uX2NhbGxbVGhpcy5pZF09ZnVuY3Rpb24ocGNtLHN1bSl7XG5cdFx0XHRcdGlmKFRoaXMuc3RhdGU9PTEpe1xuXHRcdFx0XHRcdFRoaXMuZW52SW4ocGNtLHN1bSk7XG5cdFx0XHRcdH07XG5cdFx0XHR9O1xuXHRcdH07XG5cdH1cblx0XG5cdFxuXHRcblx0XG5cdCxfc3RvcDpmdW5jdGlvbihrZWVwRW5naW5lKXtcblx0XHR2YXIgVGhpcz10aGlzLHNldD1UaGlzLnNldDtcblx0XHRpZighVGhpcy5pc01vY2spe1xuXHRcdFx0VGhpcy5fUysrO1xuXHRcdH07XG5cdFx0aWYoVGhpcy5zdGF0ZSl7XG5cdFx0XHRUaGlzLnBhdXNlKCk7XG5cdFx0XHRUaGlzLnN0YXRlPTA7XG5cdFx0fTtcblx0XHRpZigha2VlcEVuZ2luZSAmJiBUaGlzW3NldC50eXBlK1wiX3N0b3BcIl0pe1xuXHRcdFx0VGhpc1tzZXQudHlwZStcIl9zdG9wXCJdKFRoaXMuZW5naW5lQ3R4KTtcblx0XHRcdFRoaXMuZW5naW5lQ3R4PTA7XG5cdFx0fTtcblx0fVxuXHQvKlxuXHTnu5PmnZ/lvZXpn7Plubbov5Tlm57lvZXpn7PmlbDmja5ibG9i5a+56LGhXG5cdFx0VHJ1ZShibG9iLGR1cmF0aW9uKSBibG9i77ya5b2V6Z+z5pWw5o2uYXVkaW8vbXAzfHdhduagvOW8j1xuXHRcdFx0XHRcdFx0XHRkdXJhdGlvbu+8muW9lemfs+aXtumVv++8jOWNleS9jeavq+enklxuXHRcdEZhbHNlKG1zZylcblx0XHRhdXRvQ2xvc2U6ZmFsc2Ug5Y+v6YCJ77yM5piv5ZCm6Ieq5Yqo6LCD55SoY2xvc2XvvIzpu5jorqTkuLpmYWxzZVxuXHQqL1xuXHQsc3RvcDpmdW5jdGlvbihUcnVlLEZhbHNlLGF1dG9DbG9zZSl7XG5cdFx0dmFyIFRoaXM9dGhpcyxzZXQ9VGhpcy5zZXQsdDE7XG5cdFx0Q0xvZyhcIlN0b3AgXCIrKFRoaXMuZW52SW5MYXN0P1RoaXMuZW52SW5MYXN0LVRoaXMuZW52SW5GaXJzdCtcIm1zIOihpVwiK1RoaXMuZW52SW5GaXgrXCJtc1wiOlwiLVwiKSk7XG5cdFx0XG5cdFx0dmFyIGVuZD1mdW5jdGlvbigpe1xuXHRcdFx0VGhpcy5fc3RvcCgpOy8v5b275bqV5YWz5o6JZW5naW5lQ3R4XG5cdFx0XHRpZihhdXRvQ2xvc2Upe1xuXHRcdFx0XHRUaGlzLmNsb3NlKCk7XG5cdFx0XHR9O1xuXHRcdH07XG5cdFx0dmFyIGVycj1mdW5jdGlvbihtc2cpe1xuXHRcdFx0Q0xvZyhcIue7k+adn+W9lemfs+Wksei0pe+8mlwiK21zZywxKTtcblx0XHRcdEZhbHNlJiZGYWxzZShtc2cpO1xuXHRcdFx0ZW5kKCk7XG5cdFx0fTtcblx0XHR2YXIgb2s9ZnVuY3Rpb24oYmxvYixkdXJhdGlvbil7XG5cdFx0XHRDTG9nKFwi57uT5p2f5b2V6Z+zIOe8lueggVwiKyhEYXRlLm5vdygpLXQxKStcIm1zIOmfs+mikVwiK2R1cmF0aW9uK1wibXMvXCIrYmxvYi5zaXplK1wiYlwiKTtcblx0XHRcdGlmKHNldC50YWtlb2ZmRW5jb2RlQ2h1bmspey8v5o6l566h5LqG6L6T5Ye677yM5q2k5pe2YmxvYumVv+W6puS4ujBcblx0XHRcdFx0Q0xvZyhcIuWQr+eUqHRha2VvZmZFbmNvZGVDaHVua+WQjnN0b3Dov5Tlm57nmoRibG9i6ZW/5bqm5Li6MOS4jeaPkOS+m+mfs+mikeaVsOaNrlwiLDMpO1xuXHRcdFx0fWVsc2UgaWYoYmxvYi5zaXplPE1hdGgubWF4KDEwMCxkdXJhdGlvbi8yKSl7Ly8x56eS5bCP5LqOMC41a++8n1xuXHRcdFx0XHRlcnIoXCLnlJ/miJDnmoRcIitzZXQudHlwZStcIuaXoOaViFwiKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fTtcblx0XHRcdFRydWUmJlRydWUoYmxvYixkdXJhdGlvbik7XG5cdFx0XHRlbmQoKTtcblx0XHR9O1xuXHRcdGlmKCFUaGlzLmlzTW9jayl7XG5cdFx0XHRpZighVGhpcy5zdGF0ZSl7XG5cdFx0XHRcdGVycihcIuacquW8gOWni+W9lemfs1wiKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fTtcblx0XHRcdFRoaXMuX3N0b3AodHJ1ZSk7XG5cdFx0fTtcblx0XHR2YXIgc2l6ZT1UaGlzLnJlY1NpemU7XG5cdFx0aWYoIXNpemUpe1xuXHRcdFx0ZXJyKFwi5pyq6YeH6ZuG5Yiw5b2V6Z+zXCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH07XG5cdFx0aWYoIVRoaXMuYnVmZmVyc1swXSl7XG5cdFx0XHRlcnIoXCLpn7PpopHooqvph4rmlL5cIik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fTtcblx0XHRpZighVGhpc1tzZXQudHlwZV0pe1xuXHRcdFx0ZXJyKFwi5pyq5Yqg6L29XCIrc2V0LnR5cGUrXCLnvJbnoIHlmahcIik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fTtcblx0XHRcblx0XHQvL+eOr+Wig+mFjee9ruajgOafpe+8jOatpOWkhOS7hemSiOWvuW1vY2vosIPnlKjvvIzlm6DkuLpvcGVu5bey57uP5qOA5p+l6L+H5LqGXG5cdFx0aWYoVGhpcy5pc01vY2spe1xuXHRcdFx0dmFyIGNoZWNrTXNnPVRoaXMuZW52Q2hlY2soVGhpcy5tb2NrRW52SW5mb3x8e2Vudk5hbWU6XCJtb2NrXCIsY2FuUHJvY2VzczpmYWxzZX0pOy8v5rKh5pyJ5o+Q5L6b546v5aKD5L+h5oGv55qEbW9ja+aXtuayoeaciW9uUHJvY2Vzc+Wbnuiwg1xuXHRcdFx0aWYoY2hlY2tNc2cpe1xuXHRcdFx0XHRlcnIoXCLlvZXpn7PplJnor6/vvJpcIitjaGVja01zZyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH07XG5cdFx0fTtcblx0XHRcblx0XHQvL+atpOexu+Wei+aciei+ueW9lei+uei9rOeggShXb3JrZXIp5pSv5oyBXG5cdFx0dmFyIGVuZ2luZUN0eD1UaGlzLmVuZ2luZUN0eDtcblx0XHRpZihUaGlzW3NldC50eXBlK1wiX2NvbXBsZXRlXCJdJiZlbmdpbmVDdHgpe1xuXHRcdFx0dmFyIGR1cmF0aW9uPU1hdGgucm91bmQoZW5naW5lQ3R4LnBjbVNpemUvc2V0LnNhbXBsZVJhdGUqMTAwMCk7Ly/ph4fnlKjlkI7nmoTmlbDmja7plb/luqblkoxidWZmZXJz55qE6ZW/5bqm5Y+v6IO95b6u5bCP55qE5LiN5LiA6Ie077yM5piv6YeH5qC3546H6L+e57ut6L2s5o2i55qE57K+5bqm6Zeu6aKYXG5cdFx0XHRcblx0XHRcdHQxPURhdGUubm93KCk7XG5cdFx0XHRUaGlzW3NldC50eXBlK1wiX2NvbXBsZXRlXCJdKGVuZ2luZUN0eCxmdW5jdGlvbihibG9iKXtcblx0XHRcdFx0b2soYmxvYixkdXJhdGlvbik7XG5cdFx0XHR9LGVycik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fTtcblx0XHRcblx0XHQvL+agh+WHhlVJ57q/56iL6L2s56CB77yM6LCD5pW06YeH5qC3546HXG5cdFx0dDE9RGF0ZS5ub3coKTtcblx0XHR2YXIgY2h1bms9UmVjb3JkZXIuU2FtcGxlRGF0YShUaGlzLmJ1ZmZlcnMsVGhpcy5zcmNTYW1wbGVSYXRlLHNldC5zYW1wbGVSYXRlKTtcblx0XHRcblx0XHRzZXQuc2FtcGxlUmF0ZT1jaHVuay5zYW1wbGVSYXRlO1xuXHRcdHZhciByZXM9Y2h1bmsuZGF0YTtcblx0XHR2YXIgZHVyYXRpb249TWF0aC5yb3VuZChyZXMubGVuZ3RoL3NldC5zYW1wbGVSYXRlKjEwMDApO1xuXHRcdFxuXHRcdENMb2coXCLph4fmoLdcIitzaXplK1wiLT5cIityZXMubGVuZ3RoK1wiIOiKsTpcIisoRGF0ZS5ub3coKS10MSkrXCJtc1wiKTtcblx0XHRcblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG5cdFx0XHR0MT1EYXRlLm5vdygpO1xuXHRcdFx0VGhpc1tzZXQudHlwZV0ocmVzLGZ1bmN0aW9uKGJsb2Ipe1xuXHRcdFx0XHRvayhibG9iLGR1cmF0aW9uKTtcblx0XHRcdH0sZnVuY3Rpb24obXNnKXtcblx0XHRcdFx0ZXJyKG1zZyk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblx0fVxuXG59O1xuXG5pZih3aW5kb3cuUmVjb3JkZXIpe1xuXHR3aW5kb3cuUmVjb3JkZXIuRGVzdHJveSgpO1xufTtcbndpbmRvdy5SZWNvcmRlcj1SZWNvcmRlcjtcblxuLy9lbmQgKioqKmNvcHnmupDnoIHnu5PmnZ8qKioqKlxuUmVjb3JkZXIuTE09TE07XG5cbi8v5rWB6YeP57uf6K6h55SoMeWDj+e0oOWbvueJh+WcsOWdgO+8jOiuvue9ruS4uuepuuWwhuS4jeWPguS4jue7n+iuoVxuUmVjb3JkZXIuVHJhZmZpY0ltZ1VybD1cIi8vaWEuNTEubGEvZ28xP2lkPTIwNDY5OTczJnB2RmxhZz0xXCI7XG5SZWNvcmRlci5UcmFmZmljPWZ1bmN0aW9uKCl7XG5cdHZhciBpbWdVcmw9UmVjb3JkZXIuVHJhZmZpY0ltZ1VybDtcblx0aWYoaW1nVXJsKXtcblx0XHR2YXIgZGF0YT1SZWNvcmRlci5UcmFmZmljO1xuXHRcdHZhciBpZGY9bG9jYXRpb24uaHJlZi5yZXBsYWNlKC8jLiovLFwiXCIpO1xuXHRcdFxuXHRcdGlmKGltZ1VybC5pbmRleE9mKFwiLy9cIik9PTApe1xuXHRcdFx0Ly/nu5l1cmzliqDkuIpodHRw5YmN57yA77yM5aaC5p6c5pivZmlsZeWNj+iuruS4i++8jOS4jeWKoOWJjee8gOayoeazleeUqFxuXHRcdFx0aWYoL15odHRwczovaS50ZXN0KGlkZikpe1xuXHRcdFx0XHRpbWdVcmw9XCJodHRwczpcIitpbWdVcmw7XG5cdFx0XHR9ZWxzZXtcblx0XHRcdFx0aW1nVXJsPVwiaHR0cDpcIitpbWdVcmw7XG5cdFx0XHR9O1xuXHRcdH07XG5cdFx0XG5cdFx0aWYoIWRhdGFbaWRmXSl7XG5cdFx0XHRkYXRhW2lkZl09MTtcblx0XHRcdFxuXHRcdFx0dmFyIGltZz1uZXcgSW1hZ2UoKTtcblx0XHRcdGltZy5zcmM9aW1nVXJsO1xuXHRcdFx0Q0xvZyhcIlRyYWZmaWMgQW5hbHlzaXMgSW1hZ2U6IFJlY29yZGVyLlRyYWZmaWNJbWdVcmw9XCIrUmVjb3JkZXIuVHJhZmZpY0ltZ1VybCk7XG5cdFx0fTtcblx0fTtcbn07XG5cbn0pKTsiLCJleHBvcnQgY2xhc3MgQnl0ZUFycmF5IHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLmxpc3Q9W107XHJcbiAgICAgICAgdGhpcy5ieXRlT2Zmc2V0PTA7XHJcbiAgICAgICAgdGhpcy5sZW5ndGg9MDtcclxuICAgIH1cclxuXHJcbiAgICBwdXNoKHVuaXQ4QXJyKSB7XHJcbiAgICAgICAgdGhpcy5saXN0LnB1c2godW5pdDhBcnIpO1xyXG4gICAgICAgIHRoaXMubGVuZ3RoKz11bml0OEFyci5sZW5ndGg7XHJcbiAgICB9XHJcblxyXG4gICAgcmVhZEJ5dGVzKGxlbikge1xyXG4gICAgICAgIGlmKGxlbj4wKXtcclxuICAgICAgICAgICAgbGV0IHJidWY9bmV3IFVpbnQ4QXJyYXkobGVuKTtcclxuICAgICAgICAgICAgbGV0IHJidWZfaW5kPTA7XHJcbiAgICAgICAgICAgIHdoaWxlKHJidWZfaW5kPGxlbil7XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLmxpc3QubGVuZ3RoPjApe1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB0bXBidWY9dGhpcy5saXN0LnNoaWZ0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRtcGxlbj10bXBidWYubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBsYXN0X2xlbj1sZW4tcmJ1Zl9pbmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYodG1wbGVuPj1sYXN0X2xlbil7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8v6Laz5aSg5LqGXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCB0bXBidWYyID0gdG1wYnVmLnN1YmFycmF5KDAsIGxhc3RfbGVuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmJ1Zi5zZXQodG1wYnVmMixyYnVmX2luZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJidWZfaW5kKz10bXBidWYyLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYobGFzdF9sZW48dG1wbGVuKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBuZXdVaW50OEFycmF5ID0gdG1wYnVmLnN1YmFycmF5KGxhc3RfbGVuLCB0bXBsZW4pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5saXN0LnVuc2hpZnQobmV3VWludDhBcnJheSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJidWYuc2V0KHRtcGJ1ZixyYnVmX2luZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJidWZfaW5kKz10bXBsZW47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgcmJ1Zj1yYnVmLnN1YmFycmF5KDAsIHJidWZfaW5kKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB0aGlzLmxlbmd0aC09cmJ1Zi5sZW5ndGg7XHJcbiAgICAgICAgICAgIHJldHVybiByYnVmO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbn0iLCJcclxuZXhwb3J0IGNsYXNzIFV0aWwge1xyXG4gICAgc3RhdGljIGlzRW1wdHlTdHJpbmcoc3RyKSB7XHJcbiAgICAgICAgaWYgKHN0ciA9PSB1bmRlZmluZWQgfHwgc3RyID09IG51bGwgfHwgc3RyID09IFwiXCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwiaW1wb3J0IHtHUGxheWVyRXZlbnQsIEdFcnJvclR5cGUsIEdQbGF5YmFja0NvbnRyb2xTdGF0dXN9IGZyb20gJy4vcGxheWVyL2dwbGF5ZXItZXZlbnRzJztcclxuaW1wb3J0IHtHVGFsa2VyRXZlbnQsIEdUYWxrZXJDb25uZWN0U3RhdHVzLCBHVGFsa2VyQ29ubmVjdEVycm9yVHlwZX0gZnJvbSAnLi90YWxrZXIvZ3RhbGtlci1ldmVudHMnO1xyXG5pbXBvcnQge0dIZWxwZXJFdmVudH0gZnJvbSBcIi4vaGVscGVyL2doZWxwZXItZXZlbnRzLmpzXCI7XHJcbmltcG9ydCB7R1BsYXllcn0gZnJvbSAnLi9wbGF5ZXIvZ3BsYXllci5qcyc7XHJcbmltcG9ydCB7IEh0dHBGbHZQbGF5ZXIgfSBmcm9tICcuL3BsYXllci9odHRwZmx2LXBsYXllci5qcyc7XHJcbmltcG9ydCB7IEh0dHBGbHZUYWxrZXIgfSBmcm9tICcuL3RhbGtlci9odHRwZmx2LXRhbGtlci5qcyc7XHJcbmltcG9ydCB7IEdIZWxwZXIgfSBmcm9tIFwiLi9oZWxwZXIvZ2hlbHBlci5qc1wiO1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlUGxheWVyKHVybCwgY29uZmlnID0gbnVsbCkge1xyXG4gIGxldCBwbGF5ZXIgPSBuZXcgSHR0cEZsdlBsYXllcigpO1xyXG4gIHBsYXllci5pbml0KHVybCwgY29uZmlnKTtcclxuICByZXR1cm4gcGxheWVyO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVUYWxrZXIoZG93blVybCwgdXBVcmwsIGltZWksIGNoYW5uZWwsIGNvbmZpZyA9IG51bGwpIHtcclxuICBsZXQgdGFsa2VyID0gbmV3IEh0dHBGbHZUYWxrZXIoKTtcclxuICBpZiAoIXRhbGtlci5pbml0KGRvd25VcmwsIHVwVXJsLCBpbWVpLCBjaGFubmVsLCBjb25maWcpKSB7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbiAgcmV0dXJuIHRhbGtlcjtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlSGVscGVyKHVybCkge1xyXG4gIGxldCBoZWxwZXIgPSBuZXcgR0hlbHBlcigpO1xyXG4gIGhlbHBlci5pbml0KHVybCk7XHJcbiAgcmV0dXJuIGhlbHBlcjtcclxufVxyXG5cclxuZnVuY3Rpb24gaXNIdHRwRmx2U3VwcG9ydGVkKCkge1xyXG4gIHJldHVybiBIdHRwRmx2UGxheWVyLmlzU3VwcG9ydGVkKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzVGFsa1N1cHBvcnRlZCgpIHtcclxuICByZXR1cm4gSHR0cEZsdlRhbGtlci5pc1N1cHBvcnRlZCgpO1xyXG59XHJcblxyXG5sZXQgZ21lZGlhanMgPSB7fTtcclxuXHJcbmdtZWRpYWpzLmNyZWF0ZVBsYXllciA9IGNyZWF0ZVBsYXllcjtcclxuZ21lZGlhanMuaXNIdHRwRmx2U3VwcG9ydGVkID0gaXNIdHRwRmx2U3VwcG9ydGVkO1xyXG5nbWVkaWFqcy5IdHRwRmx2UGxheWVyID0gSHR0cEZsdlBsYXllcjtcclxuZ21lZGlhanMuR1BsYXllckV2ZW50ID0gR1BsYXllckV2ZW50O1xyXG5nbWVkaWFqcy5HRXJyb3JUeXBlID0gR0Vycm9yVHlwZTtcclxuZ21lZGlhanMuR1BsYXliYWNrQ29udHJvbFN0YXR1cyA9IEdQbGF5YmFja0NvbnRyb2xTdGF0dXM7XHJcblxyXG5nbWVkaWFqcy5jcmVhdGVUYWxrZXIgPSBjcmVhdGVUYWxrZXI7XHJcbmdtZWRpYWpzLmlzVGFsa1N1cHBvcnRlZCA9IGlzVGFsa1N1cHBvcnRlZDtcclxuZ21lZGlhanMuSHR0cEZsdlRhbGtlciA9IEh0dHBGbHZUYWxrZXI7XHJcbmdtZWRpYWpzLkdUYWxrZXJFdmVudCA9IEdUYWxrZXJFdmVudDtcclxuZ21lZGlhanMuR1RhbGtlckNvbm5lY3RTdGF0dXMgPSBHVGFsa2VyQ29ubmVjdFN0YXR1cztcclxuZ21lZGlhanMuR1RhbGtlckNvbm5lY3RFcnJvclR5cGUgPSBHVGFsa2VyQ29ubmVjdEVycm9yVHlwZTtcclxuXHJcbmdtZWRpYWpzLmNyZWF0ZUhlbHBlciA9IGNyZWF0ZUhlbHBlcjtcclxuZ21lZGlhanMuR0hlbHBlciA9IEdIZWxwZXI7XHJcbmdtZWRpYWpzLkdIZWxwZXJFdmVudCA9IEdIZWxwZXJFdmVudDtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGdtZWRpYWpzOyIsImV4cG9ydCBjb25zdCBHSGVscGVyRXZlbnQgPSB7XHJcbiAgICBNRURJQV9TVEFURTogJ21lZGlhX3N0YXRlJ1xyXG59OyIsImltcG9ydCB7R0hlbHBlckV2ZW50fSBmcm9tIFwiLi9naGVscGVyLWV2ZW50cy5qc1wiXHJcbmV4cG9ydCBjbGFzcyBHSGVscGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgICAgIHRoaXMuY2FsbE1lZGlhU3RhdGUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY29ubmVjdCA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdCh1cmwpIHtcclxuICAgICAgICB0aGlzLmNvbm5lY3QgPSBuZXcgV2ViU29ja2V0KHVybCk7XHJcbiAgICAgICAgdGhpcy5jb25uZWN0Lm9ub3BlbiA9IHRoaXMuX29uQ29ubmVjdE9wZW4uYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLmNvbm5lY3Qub25tZXNzYWdlID0gdGhpcy5fb25Db25uZWN0TWVzc2FnZS5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuY29ubmVjdC5vbmNsb3NlID0gdGhpcy5fb25Db25uZWN0Q2xvc2UuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLmNvbm5lY3Qub25lcnJvciA9IHRoaXMuX29uQ29ubmVjdEVycm9yLmJpbmQodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgb24oZXZlbnQsIGNhbGwpIHtcclxuICAgICAgICBpZiAoZXZlbnQgPSBHSGVscGVyRXZlbnQuTUVESUFfU1RBVEUpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsTWVkaWFTdGF0ZSA9IGNhbGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9mZihldmVudCkge1xyXG4gICAgICAgIGlmIChldmVudCA9IEdIZWxwZXJFdmVudC5NRURJQV9TVEFURSkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxNZWRpYVN0YXRlID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgZGVzdHJveSgpIHtcclxuICAgICAgICB0aGlzLmNhbGxNZWRpYVN0YXRlID0gbnVsbDtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY29ubmVjdCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY29ubmVjdC5jbG9zZSgpO1xyXG4gICAgICAgICAgICB0aGlzLmNvbm5lY3QgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfb25Db25uZWN0T3BlbigpIHtcclxuICAgICAgICB0aGlzLl9zZW5kQ29uc3VtZU1lZGlhU3RhdGVDbWQoKTtcclxuICAgIH1cclxuXHJcbiAgICBfb25Db25uZWN0TWVzc2FnZShlKSB7XHJcbiAgICAgICAgbGV0IGhlYWQgPSBKU09OLnBhcnNlKGUuZGF0YSk7XHJcbiAgICAgICAgaWYgKGhlYWQgPT0gbnVsbCB8fCBoZWFkLnR5cGUgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoaGVhZC50eXBlID09IFwibWVkaWFzdGF0ZVwiICYmIHRoaXMuY2FsbE1lZGlhU3RhdGUgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxNZWRpYVN0YXRlKGhlYWQuZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9vbkNvbm5lY3RDbG9zZSgpIHtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBfb25Db25uZWN0RXJyb3IoKSB7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgX3NlbmRDb25zdW1lTWVkaWFTdGF0ZUNtZCgpIHtcclxuICAgICAgICBsZXQgaGVhZCA9IHt9XHJcbiAgICAgICAgaGVhZFtcImNtZFwiXSA9IFwiY29uc3VtZVwiO1xyXG4gICAgICAgIGhlYWRbXCJ0eXBlXCJdID0gXCJtZWRpYXN0YXRlXCI7XHJcbiAgICAgICAgaGVhZFtcImlkXCJdID0gXCJcIjtcclxuICAgICAgICBoZWFkW1wiZGF0YVwiXSA9IHt9O1xyXG5cclxuICAgICAgICBsZXQgbXNnID0gSlNPTi5zdHJpbmdpZnkoaGVhZCk7XHJcblxyXG4gICAgICAgIHRoaXMuY29ubmVjdC5zZW5kKG1zZyk7XHJcbiAgICB9XHJcbn0iLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vZ21lZGlhLmpzJykuZGVmYXVsdDsiLCJleHBvcnQgY29uc3QgR1BsYXllckV2ZW50ID0ge1xyXG4gICAgRVJST1I6ICdlcnJvcicsXHJcbiAgICBNRURJQV9TT1VSQ0VfRU5EOiAnbWVkaWFfc291cmNlX2VuZCcsXHJcbiAgICBUSU1FVVBEQVRFOiAndGltZXVwZGF0ZScsXHJcbiAgICBTVEFUSVNUSUNTX0lORk86ICdzdGF0aXN0aWNzX2luZm8nLFxyXG4gICAgTUVESUFfU1RBVEU6ICdtZWRpYV9zdGF0ZScsXHJcbiAgICBQTEFZQkFDS19DT05UUk9MX0VWRU5UOiAncGxheWJhY2tfY29udHJvbF9ldmVudCcsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgR0Vycm9yVHlwZSA9IHtcclxuICAgIE5FVFdPUktfRVJST1I6ICdOZXR3b3JrRXJyb3InLFxyXG4gICAgTUVESUFfRVJST1I6ICdNZWRpYUVycm9yJyxcclxuICAgIE9USEVSX0VSUk9SOiAnT3RoZXJFcnJvcidcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBHUGxheWJhY2tDb250cm9sU3RhdHVzID0ge1xyXG4gICAgU2Vla1N0YXJ0OiAwLFxyXG4gICAgU2Vla0ZhaWw6IDEsXHJcbiAgICBTZWVrU3VjY2VzczogMlxyXG59O1xyXG4iLCJleHBvcnQgY2xhc3MgR1BsYXllciB7XHJcblxyXG4gICAgY29uc3RydWN0b3IodHlwZU5hbWUpIHtcclxuICAgICAgICB0aGlzLl90eXBlID0gdHlwZU5hbWUgfHwgJ3VuZGVmaW5lZCc7XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdCh1cmwsIGNvbmZpZykge1xyXG4gICAgfVxyXG5cclxuICAgIG9uKGV2ZW50LCBjYWxsKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG9mZihldmVudCkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBhdHRhY2hNZWRpYUVsZW1lbnQobWVkaWFFbGVtZW50KSB7ICBcclxuICAgIH1cclxuXHJcbiAgICBsb2FkKCkge1xyXG4gICAgfVxyXG5cclxuICAgIHBsYXkoKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNhcHR1cmUoKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHBhdXNlKCkge1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHJlc3VtZSgpIHtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBzZWVrVG9OZXdlc3RUaW1lICgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2Vlayh0aW1lKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHNldFBsYXlTcGVlZChzcGVlZCkge1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIGRlc3Ryb3koKSB7XHJcblxyXG4gICAgfVxyXG5cclxufSIsImltcG9ydCB7R1BsYXllckV2ZW50LCBHRXJyb3JUeXBlLCBHUGxheWJhY2tDb250cm9sU3RhdHVzfSBmcm9tIFwiLi9ncGxheWVyLWV2ZW50cy5qc1wiXHJcbmltcG9ydCB7R1BsYXllcn0gZnJvbSBcIi4vZ3BsYXllci5qc1wiXHJcbmltcG9ydCBmbHZqcyBmcm9tIFwiZmx2LWc3LmpzXCI7XHJcblxyXG5pbXBvcnQge0dIZWxwZXJFdmVudH0gZnJvbSBcIi4uL2hlbHBlci9naGVscGVyLWV2ZW50cy5qc1wiO1xyXG5pbXBvcnQgeyBHSGVscGVyIH0gZnJvbSBcIi4uL2hlbHBlci9naGVscGVyLmpzXCI7XHJcblxyXG5jb25zdCBQbGF5YmFja0tleSA9IFwiZzctZmx2LXZpZGVvLXBsYXliYWNrXCI7XHJcblxyXG5jb25zdCBQbGF5YmFja0NvbnRyb2wgPSB7XHJcbiAgICBOb25lOjAsXHJcbiAgICBBY3RpdmU6MSxcclxuICAgIFBhc3NpdmU6MlxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgSHR0cEZsdlBsYXllciBleHRlbmRzIEdQbGF5ZXIge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yICgpIHtcclxuICAgICAgICBzdXBlcignaHR0cGZsdi1wbGF5ZXInKTtcclxuICAgICAgICB0aGlzLlRBRyA9ICdIdHRwRmx2UGxheWVyJztcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnBsYXllciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gbnVsbDtcclxuICAgICAgICB0aGlzLmlzTGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgIHRoaXMuaGVscFVybCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5oZWxwZXIgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLnBsYXliYWNrUGxhbiA9IDE7XHJcbiAgICAgICAgdGhpcy5wbGF5YmFja0NvbnRyb2wgPSBQbGF5YmFja0NvbnRyb2wuTm9uZTtcclxuXHJcbiAgICAgICAgdGhpcy5zdHJlYW1FbmQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm5lZWRTZWVrID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zZWVraW5nID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5zZWVrVGltZSA9IDA7XHJcbiAgICAgICAgdGhpcy5uZXdQbGF5U3RhcnRUaW1lID0gMDtcclxuICAgICAgICB0aGlzLmxhc3RTZW5kU2Vla1RzID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5jYWxsYmFja1RpbWVVcGRhdGUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tTdGF0aXN0aWNzID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNhbGxiYWNrRXJyb3IgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tNZWRpYVNvdXJjZUVuZCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jYWxsYmFja01lZGlhU3RhdGUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tQbGF5YmFja0NvbnRyb2xFdmVudCA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMuY2hlY2tlclNlZWsgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLmUgPSB7XHJcbiAgICAgICAgICAgIG9uVGltZVVwZGF0ZSA6IHRoaXMuX29uRWxlbWVudFRpbWUuYmluZCh0aGlzKVxyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGlzU3VwcG9ydGVkKCkge1xyXG4gICAgICAgIHJldHVybiB3aW5kb3cuTWVkaWFTb3VyY2UgJiZcclxuICAgICAgICAgICAgd2luZG93Lk1lZGlhU291cmNlLmlzVHlwZVN1cHBvcnRlZCgndmlkZW8vbXA0OyBjb2RlY3M9XCJhdmMxLjQyRTAxRSxtcDRhLjQwLjJcIicpO1xyXG4gICAgfVxyXG5cclxuICAgIGluaXQgKHVybCwgY29uZmlnKSB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tDb25maWcoY29uZmlnKTtcclxuICAgICAgICB0aGlzLmlzTGl2ZSA9IHRoaXMuX2NoZWNrSWZMaXZlKHVybCk7ICBcclxuICAgICAgICB0aGlzLnBsYXliYWNrQ29udHJvbCA9IHRoaXMuX2NoZWNrUGxheWJhY2tDb250cm9sKHVybCk7ICBcclxuXHJcbiAgICAgICAgdGhpcy5wbGF5ZXIgPSBmbHZqcy5jcmVhdGVQbGF5ZXIoe2lzTGl2ZTp0aGlzLmlzTGl2ZSwgdHlwZTonZmx2Jyx1cmw6dXJsfSwge1xyXG4gICAgICAgICAgICBsYXp5TG9hZDogZmFsc2UsXHJcbiAgICAgICAgICAgIGVuYWJsZVN0YXNoQnVmZmVyOiBmYWxzZSxcclxuICAgICAgICAgICAgZGVmZXJMb2FkQWZ0ZXJTb3VyY2VPcGVuOnRydWVcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5wbGF5ZXIub24oZmx2anMuRXZlbnRzLlNUQVRJU1RJQ1NfSU5GTywgdGhpcy5fb25TdGF0aXN0aWNzSW5mby5iaW5kKHRoaXMpKTtcclxuICAgICAgICB0aGlzLnBsYXllci5vbihmbHZqcy5FdmVudHMuRVJST1IsIHRoaXMuX29uRXJyb3IuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXIuc2V0TWVkaWFTb3VyY2VFbmRDYWxsYmFjayh0aGlzLl9vbk1lZGlhU291cmNlRW5kLmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMucGxheWVyLnNldFN0cmVhbVRpbWVDYWxsYmFjayh0aGlzLl9vblN0cmVhbVRpbWUuYmluZCh0aGlzKSk7XHJcbiAgICB9XHJcblxyXG4gICAgb24oZXZlbnQsIGNhbGwpIHtcclxuICAgICAgICBpZiAoZXZlbnQgPT09IEdQbGF5ZXJFdmVudC5USU1FVVBEQVRFKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tUaW1lVXBkYXRlID0gY2FsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZXZlbnQgPT09IEdQbGF5ZXJFdmVudC5TVEFUSVNUSUNTX0lORk8pIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja1N0YXRpc3RpY3MgPSBjYWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChldmVudCA9PT0gR1BsYXllckV2ZW50LkVSUk9SKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tFcnJvciA9IGNhbGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50ID09PSBHUGxheWVyRXZlbnQuTUVESUFfU09VUkNFX0VORCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrTWVkaWFTb3VyY2VFbmQgPSBjYWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChldmVudCA9PT0gR1BsYXllckV2ZW50Lk1FRElBX1NUQVRFKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tNZWRpYVN0YXRlID0gY2FsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZXZlbnQgPT09IEdQbGF5ZXJFdmVudC5QTEFZQkFDS19DT05UUk9MX0VWRU5UKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tQbGF5YmFja0NvbnRyb2xFdmVudCA9IGNhbGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9mZihldmVudCkge1xyXG4gICAgICAgIGlmIChldmVudCA9PT0gR1BsYXllckV2ZW50LlRJTUVVUERBVEUpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja1RpbWVVcGRhdGUgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChldmVudCA9PT0gR1BsYXllckV2ZW50LlNUQVRJU1RJQ1NfSU5GTykge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrU3RhdGlzdGljcyA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50ID09PSBHUGxheWVyRXZlbnQuRVJST1IpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Vycm9yID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZXZlbnQgPT09IEdQbGF5ZXJFdmVudC5NRURJQV9TT1VSQ0VfRU5EKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tNZWRpYVNvdXJjZUVuZCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50ID09PSBHUGxheWVyRXZlbnQuTUVESUFfU1RBVEUpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja01lZGlhU3RhdGUgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChldmVudCA9PT0gR1BsYXllckV2ZW50LlBMQVlCQUNLX0NPTlRST0xfRVZFTlQpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50ID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYXR0YWNoTWVkaWFFbGVtZW50KGVsKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWw7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0aW1ldXBkYXRlXCIsIHRoaXMuZS5vblRpbWVVcGRhdGUpO1xyXG4gICAgICAgIHRoaXMucGxheWVyLmF0dGFjaE1lZGlhRWxlbWVudChlbCk7XHJcbiAgICB9XHJcblxyXG4gICAgbG9hZCgpIHtcclxuICAgICAgICBpZiAodGhpcy5oZWxwVXJsICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5oZWxwZXIgPSBuZXcgR0hlbHBlcigpO1xyXG4gICAgICAgICAgICB0aGlzLmhlbHBlci5pbml0KHRoaXMuaGVscFVybCk7XHJcbiAgICAgICAgICAgIHRoaXMuaGVscGVyLm9uKEdIZWxwZXJFdmVudC5NRURJQV9TVEFURSx0aGlzLl9vbk1lZGlhU3RhdGUuYmluZCh0aGlzKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnBsYXllci5sb2FkKCk7XHJcbiAgICB9XHJcblxyXG4gICAgcGxheSgpIHtcclxuICAgICAgICB0aGlzLnBsYXllci5wbGF5KCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2FwdHVyZSgpIHtcclxuICAgICAgICBsZXQgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcclxuICAgICAgICBjYW52YXMud2lkdGggPSB0aGlzLmVsZW1lbnQudmlkZW9XaWR0aDtcclxuICAgICAgICBjYW52YXMuaGVpZ2h0ID0gdGhpcy5lbGVtZW50LnZpZGVvSGVpZ2h0O1xyXG4gICAgICAgIGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpLmRyYXdJbWFnZSh0aGlzLmVsZW1lbnQsIDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XHJcbiAgICAgICAgbGV0IGRhdGF1cmwgPSBjYW52YXMudG9EYXRhVVJMKCk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGF1cmw7XHJcbiAgICB9XHJcblxyXG4gICAgcGF1c2UoKSB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnBhdXNlKCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc3VtZSgpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucGxheSgpO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBzZWVrVG9OZXdlc3RUaW1lICgpIHtcclxuICAgICAgICBsZXQgYnVmZmVyZWQgPSB0aGlzLmVsZW1lbnQuYnVmZmVyZWQ7XHJcbiAgICAgICAgaWYgKGJ1ZmZlcmVkLmxlbmd0aCA+IDApIHsgXHJcbiAgICAgICAgICAgIGxldCBmcm9tID0gYnVmZmVyZWQuc3RhcnQoYnVmZmVyZWQubGVuZ3RoIC0xKTtcclxuICAgICAgICAgICAgbGV0IHRvID0gYnVmZmVyZWQuZW5kKGJ1ZmZlcmVkLmxlbmd0aCAtMSk7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jdXJyZW50VGltZSA9IHRvO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZWVrKHRpbWUpIHtcclxuICAgICAgICBpZiAodGhpcy5lbGVtZW50ID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5zZWVraW5nKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tQbGF5YmFja0NvbnRyb2xFdmVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tQbGF5YmFja0NvbnRyb2xFdmVudChHUGxheWJhY2tDb250cm9sU3RhdHVzLlNlZWtTdGFydCwgXHJcbiAgICAgICAgICAgICAgICBcIuW8gOWni+WIh+aNouaSreaUvuaXtumXtFwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghdGhpcy5fc2Vla0J5Q2FjaGVkKHRpbWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMucGxheWJhY2tDb250cm9sID09IFBsYXliYWNrQ29udHJvbC5BY3RpdmUpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2Vla0J5QWN0aXZlKHRpbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fc2Vla0J5UGFzc2l2ZSh0aW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0UGxheVNwZWVkKHNwZWVkKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudCA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnBsYXliYWNrUmF0ZSA9IHNwZWVkO1xyXG4gICAgfVxyXG5cclxuICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaGVscGVyICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5oZWxwZXIuZGVzdHJveSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMucGxheWVyICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXIucGF1c2UoKTtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXIudW5sb2FkKCk7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWVyLmRldGFjaE1lZGlhRWxlbWVudCgpO1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllci5kZXN0cm95KCk7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWVyID0gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRpbWV1cGRhdGVcIiwgdGhpcy5lLm9uVGltZVVwZGF0ZSk7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja0NvbmZpZyhjb25maWcpIHtcclxuICAgICAgICBpZiAoY29uZmlnID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGNvbmZpZy5wbGF5YmFja1BsYW4gIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLnBsYXliYWNrUGxhbiA9IGNvbmZpZy5wbGF5YmFja1BsYW47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoY29uZmlnLmhlbHBVcmwgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmhlbHBVcmwgPSBjb25maWcuaGVscFVybDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2NoZWNrSWZMaXZlKHVybCkge1xyXG4gICAgICAgIGlmICh1cmwuaW5kZXhPZihQbGF5YmFja0tleSkgIT0gLTEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBfY2hlY2tQbGF5YmFja0NvbnRyb2wodXJsKSB7XHJcbiAgICAgICAgbGV0IGFyciA9IHVybC5zcGxpdCgnJnN0cmVhbT0nKTtcclxuICAgICAgICBpZiAoYXJyLmxlbmd0aCA8IDIgfHwgYXJyWzFdLmxlbmd0aCA8IDMpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFBsYXliYWNrQ29udHJvbC5Ob25lO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgc3RyZWFtTmFtZSA9IGFyclsxXTtcclxuICAgICAgICBsZXQgZGV2aWNlVHlwZSA9IHN0cmVhbU5hbWUuc3Vic3RyaW5nKDAsMyk7XHJcbiAgICAgICAgaWYgKGRldmljZVR5cGUgPT0gJzEzMScpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFBsYXliYWNrQ29udHJvbC5QYXNzaXZlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUGxheWJhY2tDb250cm9sLkFjdGl2ZTtcclxuICAgIH1cclxuXHJcbiAgICBfc2Vla0J5Q2FjaGVkKHRpbWUpIHtcclxuICAgICAgICBpZiAoIXRoaXMuc3RyZWFtRW5kKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zZWVraW5nID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgbGV0IGJDYWNoZWQgPSBmYWxzZTtcclxuICAgICAgICBsZXQgYnVmZmVyZWQgPSB0aGlzLmVsZW1lbnQuYnVmZmVyZWQ7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBidWZmZXJlZC5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBsZXQgZnJvbSA9IGJ1ZmZlcmVkLnN0YXJ0KGkpO1xyXG4gICAgICAgICAgICBsZXQgdG8gPSBidWZmZXJlZC5lbmQoaSk7XHJcbiAgICAgICAgICAgIGlmICh0aW1lID4gZnJvbSAmJiB0aW1lIDwgdG8pIHtcclxuICAgICAgICAgICAgICAgIGJDYWNoZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoYkNhY2hlZCAmJiB0aW1lID4gdGhpcy5lbGVtZW50LmN1cnJlbnRUaW1lKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jdXJyZW50VGltZSA9IHRpbWU7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNhbGxiYWNrUGxheWJhY2tDb250cm9sRXZlbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50KEdQbGF5YmFja0NvbnRyb2xTdGF0dXMuU2Vla1N1Y2Nlc3MsXHJcbiAgICAgICAgICAgICAgICAgICAgXCLliIfmjaLmkq3mlL7ml7bpl7TmiJDlip9cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNhbGxiYWNrUGxheWJhY2tDb250cm9sRXZlbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50KEdQbGF5YmFja0NvbnRyb2xTdGF0dXMuU2Vla0ZhaWwsXHJcbiAgICAgICAgICAgICAgICAgICAgXCLnvJPlhrLmtYHlt7Lnu5PmnZ/vvIzml6Dms5XliIfmjaLliLDmnKrnvJPlhrLljLrln59cIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuc2Vla2luZyA9IGZhbHNlO1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBfc2Vla0J5QWN0aXZlKHRpbWUpIHtcclxuICAgICAgICB0aGlzLnNlZWtpbmcgPSB0cnVlO1xyXG5cclxuICAgICAgICB0aGlzLmxhc3RTZW5kU2Vla1RzID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XHJcblxyXG4gICAgICAgIHRoaXMuY2hlY2tlclNlZWsgPSBzZXRUaW1lb3V0KCgpPT57XHJcbiAgICAgICAgICAgIHRoaXMubmVlZFNlZWsgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5zZWVraW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNhbGxiYWNrUGxheWJhY2tDb250cm9sRXZlbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50KEdQbGF5YmFja0NvbnRyb2xTdGF0dXMuU2Vla0ZhaWwsXHJcbiAgICAgICAgICAgICAgICAgICAgXCLliIfmjaLmkq3mlL7ml7bpl7TlpLHotKXvvIzor7fph43mlrDlsJ3or5VcIik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LDE1KjEwMDApO1xyXG5cclxuICAgICAgICB0aGlzLnNlZWtUaW1lID0gdGltZTtcclxuICAgICAgICB0aGlzLm5lZWRTZWVrID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBfc2Vla0J5UGFzc2l2ZSh0aW1lKSB7XHJcbiAgICAgICAgdGhpcy5zZWVraW5nID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdGhpcy5zZWVrVGltZSA9IHRpbWU7XHJcbiAgICAgICAgLy/ojrflj5blvZPliY12aWRlb+agh+etvuino+eggee8k+WtmFxyXG4gICAgICAgIGxldCBidWZmZXJlZCA9IHRoaXMuZWxlbWVudC5idWZmZXJlZDtcclxuICAgICAgICBpZiAoYnVmZmVyZWQubGVuZ3RoID4gMCkgeyBcclxuICAgICAgICAgICAgLy/nlLHorr7lpIfnq6/mjqfliLblm57mlL7nmoRidWZmZXJlZOWPquS8muS6p+eUn+S4gOautVxyXG4gICAgICAgICAgICBsZXQgZnJvbSA9IGJ1ZmZlcmVkLnN0YXJ0KDApO1xyXG4gICAgICAgICAgICBsZXQgdG8gPSBidWZmZXJlZC5lbmQoMCk7XHJcbiAgICAgICAgICAgIHRoaXMubmV3UGxheVN0YXJ0VGltZSA9IHRvO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmN1cnJlbnRUaW1lID0gdGhpcy5uZXdQbGF5U3RhcnRUaW1lO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc2V0VGltZW91dCgoKT0+e1xyXG4gICAgICAgICAgICB0aGlzLnNlZWtpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tQbGF5YmFja0NvbnRyb2xFdmVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbGxiYWNrUGxheWJhY2tDb250cm9sRXZlbnQoR1BsYXliYWNrQ29udHJvbFN0YXR1cy5TZWVrU3VjY2VzcyxcclxuICAgICAgICAgICAgICAgICAgICBcIuWIh+aNouaSreaUvuaXtumXtOaIkOWKn1wiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sMTAwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgX29uTWVkaWFTdGF0ZShpbmZvKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tNZWRpYVN0YXRlICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja01lZGlhU3RhdGUoaW5mbyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9vblN0YXRpc3RpY3NJbmZvKGRhdGEpIHtcclxuICAgICAgICBpZiAodGhpcy5jYWxsYmFja1N0YXRpc3RpY3MgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBsZXQgaW5mbyA9IHt9O1xyXG4gICAgICAgICAgICBpbmZvLnNwZWVkID0gZGF0YS5zcGVlZDtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja1N0YXRpc3RpY3MoaW5mbyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9vbkVycm9yKHR5cGUsIGRldGFpbCwgZXJyT2JqKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tFcnJvciAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIGxldCBndHlwZSA9IHR5cGU7XHJcbiAgICAgICAgICAgIGxldCBnc3VidHlwZSA9IGRldGFpbDtcclxuICAgICAgICAgICAgbGV0IGluZm8gPSB0eXBlO1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrRXJyb3IodHlwZSwgZ3N1YnR5cGUsIGluZm8pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfb25NZWRpYVNvdXJjZUVuZChpbmZvKSB7XHJcbiAgICAgICAgdGhpcy5zdHJlYW1FbmQgPSB0cnVlO1xyXG4gICAgICAgIGlmICh0aGlzLmNhbGxiYWNrTWVkaWFTb3VyY2VFbmQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrTWVkaWFTb3VyY2VFbmQoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX29uRWxlbWVudFRpbWUoZXZlbnQpIHtcclxuICAgICAgICAvL+WbnuaUvuaWueahiDFcclxuICAgICAgICBpZiAodGhpcy5wbGF5YmFja1BsYW4gPT0gMSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jYWxsYmFja1RpbWVVcGRhdGUgIT0gbnVsbCAmJiB0aGlzLmVsZW1lbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFja1RpbWVVcGRhdGUodGhpcy5lbGVtZW50LmN1cnJlbnRUaW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvL+WbnuaUvuaWueahiDJcclxuICAgICAgICBpZiAodGhpcy5wbGF5YmFja0NvbnRyb2wgPT09IFBsYXliYWNrQ29udHJvbC5BY3RpdmUpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnNlZWtpbmcgJiYgdGhpcy5jYWxsYmFja1RpbWVVcGRhdGUgIT0gbnVsbCAmJiB0aGlzLmVsZW1lbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFja1RpbWVVcGRhdGUodGhpcy5lbGVtZW50LmN1cnJlbnRUaW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0aGlzLnBsYXliYWNrQ29udHJvbCA9PT0gUGxheWJhY2tDb250cm9sLlBhc3NpdmUpIHtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLnNlZWtpbmcgJiYgdGhpcy5jYWxsYmFja1RpbWVVcGRhdGUgIT0gbnVsbCAmJiB0aGlzLmVsZW1lbnQgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGN1clBsYXlUaW1lID0gdGhpcy5zZWVrVGltZSArICh0aGlzLmVsZW1lbnQuY3VycmVudFRpbWUgLSB0aGlzLm5ld1BsYXlTdGFydFRpbWUpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFja1RpbWVVcGRhdGUoY3VyUGxheVRpbWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9vblN0cmVhbVRpbWUodGltZSkge1xyXG4gICAgICAgIGlmICh0aGlzLm5lZWRTZWVrKSB7XHJcbiAgICAgICAgICAgIGlmIChNYXRoLmFicyh0aGlzLnNlZWtUaW1lKjEwMDAgLSB0aW1lKSA+PSAxMDAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNoZWNrZXJTZWVrICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmNoZWNrZXJTZWVrKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tlclNlZWsgPSBudWxsO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLm5lZWRTZWVrID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCk9PntcclxuICAgICAgICAgICAgICAgIHRoaXMuc2Vla2luZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbGVtZW50LmN1cnJlbnRUaW1lID0gdGltZS8xMDAwO1xyXG4gICAgICAgICAgICAgICAgbGV0IG9mZiA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpIC0gdGhpcy5sYXN0U2VuZFNlZWtUcztcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwi5YiH5o2i6ICX5pe2OiBcIiArIG9mZik7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbGxiYWNrUGxheWJhY2tDb250cm9sRXZlbnQoR1BsYXliYWNrQ29udHJvbFN0YXR1cy5TZWVrU3VjY2VzcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgXCLliIfmjaLmkq3mlL7ml7bpl7TmiJDlip9cIik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sMTAwMCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbiIsImV4cG9ydCBjb25zdCBHVGFsa2VyRXZlbnQgPSB7XHJcbiAgICBDT05ORUNUX1NUQVRVUzogJ2Nvbm5lY3Rfc3RhdHVzJ1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IEdUYWxrZXJDb25uZWN0U3RhdHVzID0ge1xyXG4gICAgQ29ubmVjdFN1Y2Nlc3M6ICdDb25uZWN0U3VjY2VzcycsXHJcbiAgICBDb25uZWN0RXJyb3I6ICdDb25uZWN0RXJyb3InXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgR1RhbGtlckNvbm5lY3RFcnJvclR5cGUgPSB7XHJcbiAgICBEZXZpY2VOb3RSZXNwb25kaW5nOiAnRGV2aWNlTm90UmVzcG9uZGluZycsXHJcbiAgICBEZXZpY2VTdG9wZWRSZXNwb25kaW5nOiAnRGV2aWNlU3RvcGVkUmVzcG9uZGluZycsXHJcbiAgICBEb3duTGlua0ZhaWw6ICdEb3duTGlua0ZhaWwnLFxyXG4gICAgVXBMaW5rRmFpbDogJ1VwTGlua0ZhaWwnLFxyXG4gICAgV2FpdE9wZW5NaWNyb3Bob25lVGltZW91dDogJ1dhaXRPcGVuTWljcm9waG9uZVRpbWVvdXQnLFxyXG4gICAgTm90QWxsb3dPcGVuTWljcm9waG9uZTogJ05vdEFsbG93T3Blbk1pY3JvcGhvbmUnXHJcbn07IiwiZXhwb3J0IGNsYXNzIEdUYWxrZXIge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHR5cGVOYW1lKSB7XHJcbiAgICAgICAgdGhpcy5fdHlwZSA9IHR5cGVOYW1lIHx8ICd1bmRlZmluZWQnO1xyXG4gICAgfVxyXG5cclxuICAgIGluaXQoZG93blVybCwgdXBVcmwsIGltZWksIGNoYW5uZWwsIGNvbmZpZykge1xyXG4gICAgfVxyXG5cclxuICAgIG9uKGV2ZW50LCBjYWxsKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG9mZihldmVudCkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBhdHRhY2hNZWRpYUVsZW1lbnQoZWxlbWVudCkgeyAgXHJcbiAgICB9XHJcblxyXG4gICAgbG9hZCgpIHtcclxuICAgIH1cclxuXHJcbiAgICBkZXN0cm95KCkge1xyXG5cclxuICAgIH1cclxuXHJcbn0iLCJpbXBvcnQge0dUYWxrZXJFdmVudCwgR1RhbGtlckNvbm5lY3RTdGF0dXMsIEdUYWxrZXJDb25uZWN0RXJyb3JUeXBlfSBmcm9tIFwiLi9ndGFsa2VyLWV2ZW50cy5qc1wiXHJcbmltcG9ydCB7R1RhbGtlcn0gZnJvbSBcIi4vZ3RhbGtlci5qc1wiXHJcbmltcG9ydCB7Qnl0ZUFycmF5fSBmcm9tIFwiLi4vY29tbW9uL2J5dGVhcnJheS5qc1wiXHJcbmltcG9ydCB7VXRpbH0gZnJvbSBcIi4uL2NvbW1vbi91dGlsLmpzXCJcclxuXHJcbmltcG9ydCBmbHZqcyBmcm9tIFwiZmx2LWc3LmpzXCI7XHJcblxyXG5pbXBvcnQgUmVjb3JkZXIgZnJvbSAncmVjb3JkZXItY29yZSdcclxuaW1wb3J0ICdyZWNvcmRlci1jb3JlL3NyYy9lbmdpbmUvbXAzJ1xyXG5pbXBvcnQgJ3JlY29yZGVyLWNvcmUvc3JjL2VuZ2luZS9tcDMtZW5naW5lJ1xyXG5cclxuY29uc3QgQXVkaW9CdWZMZW4gPSA2NDA7XHJcbmNvbnN0IERlYnVnRmxhZyA9IGZhbHNlO1xyXG5cclxuZXhwb3J0IGNsYXNzIEh0dHBGbHZUYWxrZXIgZXh0ZW5kcyBHVGFsa2VyIHtcclxuXHJcbiAgICBjb25zdHJ1Y3RvciAoKSB7XHJcbiAgICAgICAgc3VwZXIoJ2h0dHBmbHYtdGFsa2VyJyk7XHJcbiAgICAgICAgdGhpcy5UQUcgPSAnSHR0cEZsdlRhbGtlcic7XHJcblxyXG4gICAgICAgIHRoaXMuZG93blVybCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy51cFVybCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5pbWVpID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNoYW5uZWwgPSBudWxsO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMucGxheWVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLnJlY29yZGVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLnNlbmRlciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gbnVsbDtcclxuXHJcbiAgICAgICAgdGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLmJ5dGVBcnJheSA9IG5ldyBCeXRlQXJyYXkoKTtcclxuXHJcbiAgICAgICAgdGhpcy50aW1lckNoZWNrID0gbnVsbDtcclxuICAgICAgICB0aGlzLnRpbWVyU2VuZCA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMuaGFzUmVjZWl2ZVNlcnZlckRhdGEgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLmhhc1NlbmRDbGllbnREYXRhID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5oYXNXYWl0T3Blbk1pY3JvcGhvbmVUaW1lb3V0ID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5oYXNEZXN0b3J5ID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGlzU3VwcG9ydGVkKCkge1xyXG4gICAgICAgIHJldHVybiB0eXBlb2YgV2ViU29ja2V0ICE9ICd1bmRlZmluZWQnICYmIFJlY29yZGVyLlN1cHBvcnQoKSAmJiB3aW5kb3cuTWVkaWFTb3VyY2UgJiZcclxuICAgICAgICAgICAgd2luZG93Lk1lZGlhU291cmNlLmlzVHlwZVN1cHBvcnRlZCgndmlkZW8vbXA0OyBjb2RlY3M9XCJhdmMxLjQyRTAxRSxtcDRhLjQwLjJcIicpO1xyXG4gICAgfVxyXG5cclxuICAgIGluaXQoZG93blVybCwgdXBVcmwsIGltZWksIGNoYW5uZWwsIGNvbmZpZykge1xyXG4gICAgICAgIHRoaXMuZG93blVybCA9IGRvd25Vcmw7XHJcbiAgICAgICAgdGhpcy51cFVybCA9IHVwVXJsO1xyXG4gICAgICAgIHRoaXMuaW1laSA9IGltZWk7XHJcbiAgICAgICAgdGhpcy5jaGFubmVsID0gY2hhbm5lbDtcclxuICAgICAgICBpZiAoIXRoaXMuX2NoZWNrSW5wdXRQYXJhbSgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX3N0YXJ0UGxheWVyKGRvd25VcmwpO1xyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIG9uKGV2ZW50LCBjYWxsKSB7XHJcbiAgICAgICAgaWYgKGV2ZW50ID09PSBHVGFsa2VyRXZlbnQuQ09OTkVDVF9TVEFUVVMpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMgPSBjYWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBvZmYoZXZlbnQpIHtcclxuICAgICAgICBpZiAoZXZlbnQgPT09IEdUYWxrZXJFdmVudC5DT05ORUNUX1NUQVRVUykge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrQ29ubmVjdFN0YXR1cyA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGF0dGFjaE1lZGlhRWxlbWVudChlbGVtZW50KSB7ICBcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xyXG5cclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRlZGRhdGFcIiwgdGhpcy5fb25QbGF5ZXJMb2FkZWREYXRhLmJpbmQodGhpcyksIHtvbmNlOiB0cnVlfSk7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXIub24oZmx2anMuRXZlbnRzLkVSUk9SLCB0aGlzLl9vblBsYXllckVycm9yLmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMucGxheWVyLnNldE1lZGlhU291cmNlRW5kQ2FsbGJhY2sodGhpcy5fb25QbGF5ZXJNZWRpYVNvdXJjZUVuZC5iaW5kKHRoaXMpKTtcclxuXHJcbiAgICAgICAgdGhpcy5wbGF5ZXIuYXR0YWNoTWVkaWFFbGVtZW50KGVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIGxvYWQoKSB7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXIubG9hZCgpO1xyXG4gICAgICAgIHRoaXMuX3N0YXJ0U2VuZGVyKHRoaXMudXBVcmwpO1xyXG4gICAgfVxyXG5cclxuICAgIGRlc3Ryb3koKSB7XHJcbiAgICAgICAgdGhpcy5oYXNEZXN0b3J5ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgdGhpcy5fZGVzdHJveVBsYXllcigpO1xyXG4gICAgICAgIHRoaXMuX2Rlc3Ryb3lTZW5kZXIoKTtcclxuICAgICAgICB0aGlzLl9kZXN0cm95UmVjb3JkZXIoKTtcclxuICAgICAgICB0aGlzLl9kZXN0cm95U2VuZFByb2MoKTtcclxuICAgIH1cclxuXHJcbiAgICBfY2hlY2tJbnB1dFBhcmFtKCkge1xyXG4gICAgICAgIGlmIChVdGlsLmlzRW1wdHlTdHJpbmcodGhpcy5kb3duVXJsKSB8fCBVdGlsLmlzRW1wdHlTdHJpbmcodGhpcy51cFVybCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoVXRpbC5pc0VtcHR5U3RyaW5nKHRoaXMuaW1laSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5jaGFubmVsIDwgMCB8fCB0aGlzLmNoYW5uZWwgPiAyNTUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBfc3RhcnRQbGF5ZXIodXJsKSB7XHJcbiAgICAgICAgdGhpcy5fZGVzdHJveVBsYXllcigpO1xyXG5cclxuICAgICAgICB0aGlzLnBsYXllciA9IGZsdmpzLmNyZWF0ZVBsYXllcih7aXNMaXZlOnRydWUsIHR5cGU6J2ZsdicsdXJsOnVybH0sIHtcclxuICAgICAgICAgICAgbGF6eUxvYWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICBlbmFibGVTdGFzaEJ1ZmZlcjogZmFsc2UsXHJcbiAgICAgICAgICAgIGRlZmVyTG9hZEFmdGVyU291cmNlT3Blbjp0cnVlXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgX29uUGxheWVyTG9hZGVkRGF0YSgpIHtcclxuICAgICAgICBpZiAoRGVidWdGbGFnKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGxheWVyIGxvYWRlZERhdGFcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmhhc1JlY2VpdmVTZXJ2ZXJEYXRhID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy5oYXNTZW5kQ2xpZW50RGF0YSAmJiB0aGlzLmNhbGxiYWNrQ29ubmVjdFN0YXR1cyAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzKEdUYWxrZXJDb25uZWN0U3RhdHVzLkNvbm5lY3RTdWNjZXNzLCBcIlwiKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX29uUGxheWVyRXJyb3IodHlwZSwgZGV0YWlsLCBlcnJPYmopIHtcclxuICAgICAgICBpZiAoRGVidWdGbGFnKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGxheWVyIGVycm9yXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzID09IG51bGwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuaGFzUmVjZWl2ZVNlcnZlckRhdGEpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMoR1RhbGtlckNvbm5lY3RTdGF0dXMuQ29ubmVjdEVycm9yLCBcclxuICAgICAgICAgICAgICAgIEdUYWxrZXJDb25uZWN0RXJyb3JUeXBlLkRvd25MaW5rRmFpbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrQ29ubmVjdFN0YXR1cyhHVGFsa2VyQ29ubmVjdFN0YXR1cy5Db25uZWN0RXJyb3IsIFxyXG4gICAgICAgICAgICAgICAgR1RhbGtlckNvbm5lY3RFcnJvclR5cGUuRGV2aWNlTm90UmVzcG9uZGluZyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9vblBsYXllck1lZGlhU291cmNlRW5kKGluZm8pIHtcclxuICAgICAgICBpZiAoRGVidWdGbGFnKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwicGxheWVyIHNvdXJjZSBlbmRcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrQ29ubmVjdFN0YXR1cyhHVGFsa2VyQ29ubmVjdFN0YXR1cy5Db25uZWN0RXJyb3IsIFxyXG4gICAgICAgICAgICAgICAgR1RhbGtlckNvbm5lY3RFcnJvclR5cGUuRGV2aWNlU3RvcGVkUmVzcG9uZGluZyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9kZXN0cm95UGxheWVyKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnBsYXllciAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWVyLnBhdXNlKCk7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWVyLnVubG9hZCgpO1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllci5kZXRhY2hNZWRpYUVsZW1lbnQoKTtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXIuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllciA9IG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5lbGVtZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50ID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX3N0YXJ0U2VuZGVyKHVybCkge1xyXG4gICAgICAgIHRoaXMuc2VuZGVyID0gbmV3IFdlYlNvY2tldCh1cmwpO1xyXG4gICAgICAgIHRoaXMuc2VuZGVyLm9ub3BlbiA9IHRoaXMuX29uU2VuZGVyT3Blbi5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuc2VuZGVyLm9ubWVzc2FnZSA9IHRoaXMuX29uU2VuZGVyTXNnLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5zZW5kZXIub25jbG9zZSA9IHRoaXMuX29uU2VuZGVyQ2xvc2UuYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLnNlbmRlci5vbmVycm9yID0gdGhpcy5fb25TZW5kZXJFcnJvci5iaW5kKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIF9vblNlbmRlck9wZW4oKSB7XHJcbiAgICAgICAgaWYgKERlYnVnRmxhZykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIndlYnNvY2tldCBvcGVuXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB0aGlzLl9zdGFydFJlY29yZGVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgX29uU2VuZGVyTXNnKGUpIHtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBfb25TZW5kZXJDbG9zZShlKSB7XHJcbiAgICAgICAgaWYgKERlYnVnRmxhZykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIndlYnNvY2tldCBjbG9zZVwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNhbGxiYWNrQ29ubmVjdFN0YXR1cyAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzKEdUYWxrZXJDb25uZWN0U3RhdHVzLkNvbm5lY3RFcnJvciwgXHJcbiAgICAgICAgICAgICAgICBHVGFsa2VyQ29ubmVjdEVycm9yVHlwZS5VcExpbmtGYWlsKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX29uU2VuZGVyRXJyb3IoZSkge1xyXG4gICAgICAgIGlmIChEZWJ1Z0ZsYWcpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ3ZWJzb2NrZXQgZXJyb3JcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9kZXN0cm95U2VuZGVyKCkge1xyXG4gICAgICAgIHRoaXMuc2VuZGVyLmNsb3NlKCk7XHJcbiAgICAgICAgdGhpcy5zZW5kZXIgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIF9zdGFydFJlY29yZGVyKCkge1xyXG4gICAgICAgIGlmICh0aGlzLnJlY29yZGVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVjb3JkZXIuY2xvc2UoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucmVjb3JkZXIgPSBSZWNvcmRlcih7XHJcbiAgICAgICAgICAgIHR5cGU6XCJtcDNcIixcclxuICAgICAgICAgICAgc2FtcGxlUmF0ZTo4MDAwLFxyXG4gICAgICAgICAgICBiaXRSYXRlOjE2LFxyXG4gICAgICAgICAgICBvblByb2Nlc3M6dGhpcy5fb25SZWNlaXZlTWljcm9waG9uZURhdGEuYmluZCh0aGlzKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMudGltZXJDaGVjayA9IHNldFRpbWVvdXQodGhpcy5fdGltZW91dENoZWNrSWZBbGxvd09wZW5NaWNyb3Bob25lLmJpbmQodGhpcyksMTAwMDApO1xyXG4gICAgICAgIHRoaXMucmVjb3JkZXIub3Blbih0aGlzLl9vbkFsbG93T3Blbk1pY3JvcGhvbmUuYmluZCh0aGlzKSxcclxuICAgICAgICAgICAgdGhpcy5fb25Ob3RBbGxvd09wZW5NaWNyb3Bob25lLmJpbmQodGhpcykpO1xyXG4gICAgfVxyXG5cclxuICAgIF90aW1lb3V0Q2hlY2tJZkFsbG93T3Blbk1pY3JvcGhvbmUoKSB7XHJcbiAgICAgICAgaWYgKERlYnVnRmxhZykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInVzZXIgV2FpdE9wZW5NaWNyb3Bob25lIFRpbWVvdXRcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmhhc1dhaXRPcGVuTWljcm9waG9uZVRpbWVvdXQgPSB0cnVlO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrQ29ubmVjdFN0YXR1cyhHVGFsa2VyQ29ubmVjdFN0YXR1cy5Db25uZWN0RXJyb3IsIFxyXG4gICAgICAgICAgICAgICAgR1RhbGtlckNvbm5lY3RFcnJvclR5cGUuV2FpdE9wZW5NaWNyb3Bob25lVGltZW91dCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9vbkFsbG93T3Blbk1pY3JvcGhvbmUoKSB7XHJcbiAgICAgICAgaWYgKERlYnVnRmxhZykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInVzZXIgQWxsb3dPcGVuTWljcm9waG9uZVwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmhhc1dhaXRPcGVuTWljcm9waG9uZVRpbWVvdXQpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJDaGVjayk7XHJcblxyXG4gICAgICAgIHRoaXMuaGFzU2VuZENsaWVudERhdGEgPSB0cnVlO1xyXG4gICAgICAgIGlmICh0aGlzLmhhc1JlY2VpdmVTZXJ2ZXJEYXRhICYmIHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMoR1RhbGtlckNvbm5lY3RTdGF0dXMuQ29ubmVjdFN1Y2Nlc3MsIFwiXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5yZWNvcmRlci5zdGFydCgpO1xyXG4gICAgICAgIHRoaXMuX3NlbmRQcm9jKCk7XHJcbiAgICB9XHJcblxyXG4gICAgX29uTm90QWxsb3dPcGVuTWljcm9waG9uZShtc2csIGlzVXNlck5vdEFsbG93KSB7XHJcbiAgICAgICAgaWYgKERlYnVnRmxhZykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInVzZXIgTm90QWxsb3dPcGVuTWljcm9waG9uZVwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyQ2hlY2spO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrQ29ubmVjdFN0YXR1cyhHVGFsa2VyQ29ubmVjdFN0YXR1cy5Db25uZWN0RXJyb3IsIFxyXG4gICAgICAgICAgICAgICAgR1RhbGtlckNvbm5lY3RFcnJvclR5cGUuTm90QWxsb3dPcGVuTWljcm9waG9uZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9vblJlY2VpdmVNaWNyb3Bob25lRGF0YShidWZmZXJzLCBwb3dlckxldmVsLCBidWZmZXJEdXJhdGlvbiwgYnVmZmVyU2FtcGxlUmF0ZSkge1xyXG4gICAgICAgIGxldCBhcnJheUJ1ZiA9IGJ1ZmZlcnNbYnVmZmVycy5sZW5ndGggLSAxXS5idWZmZXI7IC8vVWludDE2QXJyYXkgVG8gQXJyYXlCdWZmZXJcclxuICAgICAgICBsZXQgdThidWYgPSBuZXcgVWludDhBcnJheShhcnJheUJ1Zik7IC8vQXJyYXlCdWZmZXIgVG8gVWludDhBcnJheVxyXG4gICAgICAgIHRoaXMuYnl0ZUFycmF5LnB1c2godThidWYpO1xyXG4gICAgfVxyXG5cclxuICAgIF9kZXN0cm95UmVjb3JkZXIoKSB7XHJcbiAgICAgICAgdGhpcy5yZWNvcmRlci5jbG9zZSgpO1xyXG4gICAgICAgIHRoaXMucmVjb3JkZXIgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZW5kUHJvYygpIHtcclxuICAgICAgICBpZiAodGhpcy5oYXNEZXN0b3J5KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmJ5dGVBcnJheS5sZW5ndGggPCBBdWRpb0J1Zkxlbikge1xyXG4gICAgICAgICAgICB0aGlzLnRpbWVyU2VuZCA9IHNldFRpbWVvdXQodGhpcy5fc2VuZFByb2MuYmluZCh0aGlzKSwgNSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBsZXQgYXVkaW9CdWYgPSB0aGlzLmJ5dGVBcnJheS5yZWFkQnl0ZXMoQXVkaW9CdWZMZW4pO1xyXG5cclxuICAgICAgICAgICAgbGV0IHBhY2tlciA9IG5ldyBCeXRlQXJyYXkoKTtcclxuICAgICAgICAgICAgcGFja2VyLnB1c2gobmV3IFVpbnQ4QXJyYXkoWzB4MzEsMHgzMiwweDYzLDB4NjRdKSk7XHJcbiAgICAgICAgICAgIGxldCBhcnJJbWVpQ2hhciA9IHRoaXMuaW1laS5zcGxpdCgnJyk7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJySW1laUNoYXIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIHBhY2tlci5wdXNoKG5ldyBVaW50OEFycmF5KFthcnJJbWVpQ2hhcltpXS5jaGFyQ29kZUF0KCldKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcGFja2VyLnB1c2gobmV3IFVpbnQ4QXJyYXkoW3BhcnNlSW50KHRoaXMuY2hhbm5lbCldKSk7XHJcbiAgICAgICAgICAgIHBhY2tlci5wdXNoKG5ldyBVaW50OEFycmF5KFtNYXRoLmZsb29yKEF1ZGlvQnVmTGVuLzI1NildKSk7XHJcbiAgICAgICAgICAgIHBhY2tlci5wdXNoKG5ldyBVaW50OEFycmF5KFtBdWRpb0J1ZkxlbiUyNTZdKSk7XHJcbiAgICAgICAgICAgIHBhY2tlci5wdXNoKGF1ZGlvQnVmKTtcclxuXHJcbiAgICAgICAgICAgIGxldCB0b3RhbExlbiA9IDQgKyBhcnJJbWVpQ2hhci5sZW5ndGggKyAzICsgQXVkaW9CdWZMZW47XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbmRlciAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbmRlci5zZW5kKHBhY2tlci5yZWFkQnl0ZXModG90YWxMZW4pKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5fc2VuZFByb2MoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2Rlc3Ryb3lTZW5kUHJvYygpIHtcclxuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lclNlbmQpO1xyXG4gICAgfVxyXG59Il19"}