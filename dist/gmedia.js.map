{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/flv-g7.js/dist/flv.js","node_modules/recorder-core/src/engine/mp3-engine.js","node_modules/recorder-core/src/engine/mp3.js","node_modules/recorder-core/src/recorder-core.js","src/common/bytearray.js","src/common/util.js","src/gmedia.js","src/index.js","src/player/gplayer-events.js","src/player/gplayer.js","src/player/httpflv-player.js","src/talker/gtalker-events.js","src/talker/gtalker.js","src/talker/httpflv-talker.js"],"names":[],"mappings":"AAAA;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;ACr4XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC51bA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ICl3Ba,S,WAAA,S;AAET,yBAAc;AAAA;;AACV,aAAK,IAAL,GAAU,EAAV;AACA,aAAK,UAAL,GAAgB,CAAhB;AACA,aAAK,MAAL,GAAY,CAAZ;AACH;;;;6BAEI,Q,EAAU;AACX,iBAAK,IAAL,CAAU,IAAV,CAAe,QAAf;AACA,iBAAK,MAAL,IAAa,SAAS,MAAtB;AACH;;;kCAES,G,EAAK;AACX,gBAAG,MAAI,CAAP,EAAS;AACL,oBAAI,OAAK,IAAI,UAAJ,CAAe,GAAf,CAAT;AACA,oBAAI,WAAS,CAAb;AACA,uBAAM,WAAS,GAAf,EAAmB;AACf,wBAAG,KAAK,IAAL,CAAU,MAAV,GAAiB,CAApB,EAAsB;AAClB,4BAAI,SAAO,KAAK,IAAL,CAAU,KAAV,EAAX;AACA,4BAAI,SAAO,OAAO,MAAlB;AACA,4BAAI,WAAS,MAAI,QAAjB;AACA,4BAAG,UAAQ,QAAX,EAAoB;AAChB;AACA,gCAAI,UAAU,OAAO,QAAP,CAAgB,CAAhB,EAAmB,QAAnB,CAAd;AACA,iCAAK,GAAL,CAAS,OAAT,EAAiB,QAAjB;AACA,wCAAU,QAAQ,MAAlB;AACA,gCAAG,WAAS,MAAZ,EAAmB;AACf,oCAAI,gBAAgB,OAAO,QAAP,CAAgB,QAAhB,EAA0B,MAA1B,CAApB;AACA,qCAAK,IAAL,CAAU,OAAV,CAAkB,aAAlB;AACH;AACD;AACH,yBAVD,MAUK;AACD,iCAAK,GAAL,CAAS,MAAT,EAAgB,QAAhB;AACA,wCAAU,MAAV;AACH;AACJ,qBAlBD,MAkBK;AACD,+BAAK,KAAK,QAAL,CAAc,CAAd,EAAiB,QAAjB,CAAL;AACA;AACH;AACJ;AACD,qBAAK,MAAL,IAAa,KAAK,MAAlB;AACA,uBAAO,IAAP;AACH;AACD,mBAAO,IAAP;AACH;;;;;;;;;;;;;;;;;IC5CQ,I,WAAA,I;;;;;;;sCACY,G,EAAK;AACtB,gBAAI,OAAO,SAAP,IAAoB,OAAO,IAA3B,IAAmC,OAAO,EAA9C,EAAkD;AAC9C,uBAAO,IAAP;AACH,aAFD,MAGK;AACD,uBAAO,KAAP;AACH;AACJ;;;;;;;;;;;;;ACTL;;AACA;;AACA;;AACA;;AACA;;AAEA,SAAS,YAAT,CAAsB,GAAtB,EAA0C;AAAA,MAAf,MAAe,uEAAN,IAAM;;AACxC,MAAI,SAAS,IAAI,4BAAJ,EAAb;AACA,SAAO,IAAP,CAAY,GAAZ,EAAiB,MAAjB;AACA,SAAO,MAAP;AACD;;AAED,SAAS,YAAT,CAAsB,OAAtB,EAA+B,KAA/B,EAAsC,IAAtC,EAA4C,OAA5C,EAAoE;AAAA,MAAf,MAAe,uEAAN,IAAM;;AAClE,MAAI,SAAS,IAAI,4BAAJ,EAAb;AACA,MAAI,CAAC,OAAO,IAAP,CAAY,OAAZ,EAAqB,KAArB,EAA4B,IAA5B,EAAkC,OAAlC,EAA2C,MAA3C,CAAL,EAAyD;AACvD,WAAO,IAAP;AACD;AACD,SAAO,MAAP;AACD;;AAED,SAAS,kBAAT,GAA8B;AAC5B,SAAO,6BAAc,WAAd,EAAP;AACD;;AAED,SAAS,eAAT,GAA2B;AACzB,SAAO,6BAAc,WAAd,EAAP;AACD;;AAED,IAAI,WAAW,EAAf;;AAEA,SAAS,YAAT,GAAwB,YAAxB;AACA,SAAS,kBAAT,GAA8B,kBAA9B;AACA,SAAS,aAAT,GAAyB,4BAAzB;AACA,SAAS,YAAT,GAAwB,2BAAxB;AACA,SAAS,UAAT,GAAsB,yBAAtB;AACA,SAAS,sBAAT,GAAkC,qCAAlC;;AAEA,SAAS,YAAT,GAAwB,YAAxB;AACA,SAAS,eAAT,GAA2B,eAA3B;AACA,SAAS,aAAT,GAAyB,4BAAzB;AACA,SAAS,YAAT,GAAwB,2BAAxB;AACA,SAAS,oBAAT,GAAgC,mCAAhC;AACA,SAAS,uBAAT,GAAmC,sCAAnC;;kBAEe,Q;;;;;AC5Cf,OAAO,OAAP,GAAiB,QAAQ,aAAR,EAAuB,OAAxC;;;;;;;;ACAO,IAAM,sCAAe;AACxB,WAAO,OADiB;AAExB,sBAAkB,kBAFM;AAGxB,gBAAY,YAHY;AAIxB,qBAAiB,iBAJO;AAKxB,4BAAwB;AALA,CAArB;;AAQA,IAAM,kCAAa;AACtB,mBAAe,cADO;AAEtB,iBAAa,YAFS;AAGtB,iBAAa;AAHS,CAAnB;;AAMA,IAAM,0DAAyB;AAClC,eAAW,CADuB;AAElC,cAAU,CAFwB;AAGlC,iBAAa;AAHqB,CAA/B;;;;;;;;;;;;;ICdM,O,WAAA,O;AAET,qBAAY,QAAZ,EAAsB;AAAA;;AAClB,aAAK,KAAL,GAAa,YAAY,WAAzB;AACH;;;;6BAEI,G,EAAK,M,EAAQ,CACjB;;;2BAEE,K,EAAO,I,EAAM,CAEf;;;4BAEG,K,EAAO,CAEV;;;2CAEkB,Y,EAAc,CAChC;;;+BAEM,CACN;;;+BAEM,CAEN;;;kCAES,CAET;;;gCAEO,CAEP;;;iCAEQ,CAER;;;2CAEmB,CAEnB;;;6BAEI,I,EAAM,CAEV;;;kCAES,CAET;;;;;;;;;;;;;;;;ACjDL;;AACA;;AACA;;;;;;;;;;;;AAEA,IAAM,cAAc,uBAApB;;AAEA,IAAM,kBAAkB;AACpB,UAAK,CADe;AAEpB,YAAO,CAFa;AAGpB,aAAQ;AAHY,CAAxB;;IAMa,a,WAAA,a;;;AAET,6BAAe;AAAA;;AAAA,kIACL,gBADK;;AAEX,cAAK,GAAL,GAAW,eAAX;;AAEA,cAAK,MAAL,GAAc,IAAd;AACA,cAAK,OAAL,GAAe,IAAf;AACA,cAAK,MAAL,GAAc,IAAd;;AAEA,cAAK,YAAL,GAAoB,CAApB;AACA,cAAK,eAAL,GAAuB,gBAAgB,IAAvC;;AAEA,cAAK,SAAL,GAAiB,KAAjB;AACA,cAAK,QAAL,GAAgB,KAAhB;AACA,cAAK,OAAL,GAAe,KAAf;AACA,cAAK,QAAL,GAAgB,CAAhB;AACA,cAAK,gBAAL,GAAwB,CAAxB;AACA,cAAK,cAAL,GAAsB,CAAtB;;AAEA,cAAK,kBAAL,GAA0B,IAA1B;AACA,cAAK,kBAAL,GAA0B,IAA1B;AACA,cAAK,aAAL,GAAqB,IAArB;AACA,cAAK,sBAAL,GAA8B,IAA9B;AACA,cAAK,4BAAL,GAAoC,IAApC;;AAEA,cAAK,WAAL,GAAmB,IAAnB;;AAEA,cAAK,CAAL,GAAS;AACL,0BAAe,MAAK,cAAL,CAAoB,IAApB;AADV,SAAT;AA1BW;AA6Bd;;;;6BAOK,G,EAAK,M,EAAQ;AACf,iBAAK,YAAL,CAAkB,MAAlB;AACA,iBAAK,MAAL,GAAc,KAAK,YAAL,CAAkB,GAAlB,CAAd;AACA,iBAAK,eAAL,GAAuB,KAAK,qBAAL,CAA2B,GAA3B,CAAvB;;AAEA,iBAAK,MAAL,GAAc,eAAM,YAAN,CAAmB,EAAC,QAAO,KAAK,MAAb,EAAqB,MAAK,KAA1B,EAAgC,KAAI,GAApC,EAAnB,EAA6D;AACvE,0BAAU,KAD6D;AAEvE,mCAAmB,KAFoD;AAGvE,0CAAyB;AAH8C,aAA7D,CAAd;;AAMA,iBAAK,MAAL,CAAY,EAAZ,CAAe,eAAM,MAAN,CAAa,eAA5B,EAA6C,KAAK,iBAAL,CAAuB,IAAvB,CAA4B,IAA5B,CAA7C;AACA,iBAAK,MAAL,CAAY,EAAZ,CAAe,eAAM,MAAN,CAAa,KAA5B,EAAmC,KAAK,QAAL,CAAc,IAAd,CAAmB,IAAnB,CAAnC;AACA,iBAAK,MAAL,CAAY,yBAAZ,CAAsC,KAAK,iBAAL,CAAuB,IAAvB,CAA4B,IAA5B,CAAtC;AACA,iBAAK,MAAL,CAAY,qBAAZ,CAAkC,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAAlC;AACH;;;2BAEE,K,EAAO,I,EAAM;AACZ,gBAAI,UAAU,4BAAa,UAA3B,EAAuC;AACnC,qBAAK,kBAAL,GAA0B,IAA1B;AACH,aAFD,MAGK,IAAI,UAAU,4BAAa,eAA3B,EAA4C;AAC7C,qBAAK,kBAAL,GAA0B,IAA1B;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,KAA3B,EAAkC;AACnC,qBAAK,aAAL,GAAqB,IAArB;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,gBAA3B,EAA6C;AAC9C,qBAAK,sBAAL,GAA8B,IAA9B;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,sBAA3B,EAAmD;AACpD,qBAAK,4BAAL,GAAoC,IAApC;AACH;AACJ;;;4BAEG,K,EAAO;AACP,gBAAI,UAAU,4BAAa,UAA3B,EAAuC;AACnC,qBAAK,kBAAL,GAA0B,IAA1B;AACH,aAFD,MAGK,IAAI,UAAU,4BAAa,eAA3B,EAA4C;AAC7C,qBAAK,kBAAL,GAA0B,IAA1B;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,KAA3B,EAAkC;AACnC,qBAAK,aAAL,GAAqB,IAArB;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,gBAA3B,EAA6C;AAC9C,qBAAK,sBAAL,GAA8B,IAA9B;AACH,aAFI,MAGA,IAAI,UAAU,4BAAa,sBAA3B,EAAmD;AACpD,qBAAK,4BAAL,GAAoC,IAApC;AACH;AACJ;;;2CAEkB,E,EAAI;AACnB,iBAAK,OAAL,GAAe,EAAf;AACA,iBAAK,OAAL,CAAa,gBAAb,CAA8B,YAA9B,EAA4C,KAAK,CAAL,CAAO,YAAnD;AACA,iBAAK,MAAL,CAAY,kBAAZ,CAA+B,EAA/B;AACH;;;+BAEM;AACH,iBAAK,MAAL,CAAY,IAAZ;AACH;;;+BAEM;AACH,iBAAK,MAAL,CAAY,IAAZ;AACH;;;kCAES;AACN,gBAAI,SAAS,SAAS,aAAT,CAAuB,QAAvB,CAAb;AACA,mBAAO,KAAP,GAAe,KAAK,OAAL,CAAa,UAA5B;AACA,mBAAO,MAAP,GAAgB,KAAK,OAAL,CAAa,WAA7B;AACA,mBAAO,UAAP,CAAkB,IAAlB,EAAwB,SAAxB,CAAkC,KAAK,OAAvC,EAAgD,CAAhD,EAAmD,CAAnD,EAAsD,OAAO,KAA7D,EAAoE,OAAO,MAA3E;AACA,gBAAI,UAAU,OAAO,SAAP,EAAd;AACA,mBAAO,OAAP;AACH;;;gCAEO;AACJ,iBAAK,OAAL,CAAa,KAAb;AACA,mBAAO,KAAP;AACH;;;iCAEQ;AACL,iBAAK,OAAL,CAAa,IAAb;AACA,mBAAO,KAAP;AACH;;;2CAEmB;AAChB,gBAAI,WAAW,KAAK,OAAL,CAAa,QAA5B;AACA,gBAAI,SAAS,MAAT,GAAkB,CAAtB,EAAyB;AACrB,oBAAI,OAAO,SAAS,KAAT,CAAe,SAAS,MAAT,GAAiB,CAAhC,CAAX;AACA,oBAAI,KAAK,SAAS,GAAT,CAAa,SAAS,MAAT,GAAiB,CAA9B,CAAT;AACA,qBAAK,OAAL,CAAa,WAAb,GAA2B,EAA3B;AACH;AACJ;;;6BAEI,I,EAAM;AACP,gBAAI,KAAK,OAAL,IAAgB,IAApB,EAA0B;AACtB,uBAAO,KAAP;AACH;AACD,gBAAI,KAAK,OAAT,EAAkB;AACd,uBAAO,KAAP;AACH;;AAED,gBAAI,KAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,qBAAK,4BAAL,CAAkC,sCAAuB,SAAzD,EACI,UADJ;AAEH;;AAED,gBAAI,CAAC,KAAK,aAAL,CAAmB,IAAnB,CAAL,EAA+B;AAC3B,uBAAO,KAAP;AACH;AACD,gBAAI,KAAK,eAAL,IAAwB,gBAAgB,MAA5C,EAAoD;AAChD,qBAAK,aAAL,CAAmB,IAAnB;AACH,aAFD,MAGK;AACD,qBAAK,cAAL,CAAoB,IAApB;AACH;AACD,mBAAO,IAAP;AACH;;;kCAES;AACN,gBAAI,KAAK,MAAL,IAAe,IAAnB,EAAyB;AACrB,qBAAK,MAAL,CAAY,KAAZ;AACA,qBAAK,MAAL,CAAY,MAAZ;AACA,qBAAK,MAAL,CAAY,kBAAZ;AACA,qBAAK,MAAL,CAAY,OAAZ;AACA,qBAAK,MAAL,GAAc,IAAd;AACH;;AAED,gBAAI,KAAK,OAAL,IAAgB,IAApB,EAA0B;AACtB,qBAAK,OAAL,CAAa,mBAAb,CAAiC,YAAjC,EAA+C,KAAK,CAAL,CAAO,YAAtD;AACA,qBAAK,OAAL,GAAe,IAAf;AACH;AACJ;;;qCAEY,M,EAAQ;AACjB,gBAAI,UAAU,IAAd,EAAoB;AAChB;AACH;;AAED,gBAAI,OAAO,YAAP,IAAuB,IAA3B,EAAiC;AAC7B,qBAAK,YAAL,GAAoB,OAAO,YAA3B;AACH;AACJ;;;qCAEY,G,EAAK;AACd,gBAAI,IAAI,OAAJ,CAAY,WAAZ,KAA4B,CAAC,CAAjC,EAAoC;AAChC,uBAAO,KAAP;AACH;AACD,mBAAO,IAAP;AACH;;;8CAEqB,G,EAAK;AACvB,gBAAI,MAAM,IAAI,KAAJ,CAAU,UAAV,CAAV;AACA,gBAAI,IAAI,MAAJ,GAAa,CAAb,IAAkB,IAAI,CAAJ,EAAO,MAAP,GAAgB,CAAtC,EAAyC;AACrC,uBAAO,gBAAgB,IAAvB;AACH;AACD,gBAAI,aAAa,IAAI,CAAJ,CAAjB;AACA,gBAAI,aAAa,WAAW,SAAX,CAAqB,CAArB,EAAuB,CAAvB,CAAjB;AACA,gBAAI,cAAc,KAAlB,EAAyB;AACrB,uBAAO,gBAAgB,OAAvB;AACH;AACD,mBAAO,gBAAgB,MAAvB;AACH;;;sCAEa,I,EAAM;AAChB,gBAAI,CAAC,KAAK,SAAV,EAAqB;AACjB,uBAAO,IAAP;AACH;;AAED,iBAAK,OAAL,GAAe,IAAf;;AAEA,gBAAI,UAAU,KAAd;AACA,gBAAI,WAAW,KAAK,OAAL,CAAa,QAA5B;AACA,iBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,SAAS,MAA7B,EAAqC,GAArC,EAA0C;AACtC,oBAAI,OAAO,SAAS,KAAT,CAAe,CAAf,CAAX;AACA,oBAAI,KAAK,SAAS,GAAT,CAAa,CAAb,CAAT;AACA,oBAAI,OAAO,IAAP,IAAe,OAAO,EAA1B,EAA8B;AAC1B,8BAAU,IAAV;AACH;AACJ;;AAED,gBAAI,WAAW,OAAO,KAAK,OAAL,CAAa,WAAnC,EAAgD;AAC5C,qBAAK,OAAL,CAAa,WAAb,GAA2B,IAA3B;AACA,oBAAI,KAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,yBAAK,4BAAL,CAAkC,sCAAuB,WAAzD,EACI,UADJ;AAEH;AACJ,aAND,MAOK;AACD,oBAAI,KAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,yBAAK,4BAAL,CAAkC,sCAAuB,QAAzD,EACI,mBADJ;AAEH;AACJ;;AAED,iBAAK,OAAL,GAAe,KAAf;AACA,mBAAO,KAAP;AACH;;;sCAEa,I,EAAM;AAAA;;AAChB,iBAAK,OAAL,GAAe,IAAf;;AAEA,iBAAK,cAAL,GAAsB,IAAI,IAAJ,GAAW,OAAX,EAAtB;;AAEA,iBAAK,WAAL,GAAmB,WAAW,YAAI;AAC9B,uBAAK,QAAL,GAAgB,KAAhB;AACA,uBAAK,OAAL,GAAe,KAAf;AACA,oBAAI,OAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,2BAAK,4BAAL,CAAkC,sCAAuB,QAAzD,EACI,gBADJ;AAEH;AACJ,aAPkB,EAOjB,KAAG,IAPc,CAAnB;;AASA,iBAAK,QAAL,GAAgB,IAAhB;AACA,iBAAK,QAAL,GAAgB,IAAhB;AACH;;;uCAEc,I,EAAM;AAAA;;AACjB,iBAAK,OAAL,GAAe,IAAf;;AAEA,iBAAK,QAAL,GAAgB,IAAhB;AACA;AACA,gBAAI,WAAW,KAAK,OAAL,CAAa,QAA5B;AACA,gBAAI,SAAS,MAAT,GAAkB,CAAtB,EAAyB;AACrB;AACA,oBAAI,OAAO,SAAS,KAAT,CAAe,CAAf,CAAX;AACA,oBAAI,KAAK,SAAS,GAAT,CAAa,CAAb,CAAT;AACA,qBAAK,gBAAL,GAAwB,EAAxB;;AAEA,qBAAK,OAAL,CAAa,WAAb,GAA2B,KAAK,gBAAhC;AACH;;AAED,uBAAW,YAAI;AACX,uBAAK,OAAL,GAAe,KAAf;AACA,oBAAI,OAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,2BAAK,4BAAL,CAAkC,sCAAuB,WAAzD,EACI,UADJ;AAEH;AACJ,aAND,EAME,IANF;AAOH;;;0CAEiB,I,EAAM;AACpB,gBAAI,KAAK,kBAAL,IAA2B,IAA/B,EAAqC;AACjC,oBAAI,OAAO,EAAX;AACA,qBAAK,KAAL,GAAa,KAAK,KAAlB;AACA,qBAAK,kBAAL,CAAwB,IAAxB;AACH;AACJ;;;iCAEQ,I,EAAM,M,EAAQ,M,EAAQ;AAC3B,gBAAI,KAAK,aAAL,IAAsB,IAA1B,EAAgC;AAC5B,oBAAI,QAAQ,IAAZ;AACA,oBAAI,WAAW,MAAf;AACA,oBAAI,OAAO,IAAX;AACA,qBAAK,aAAL,CAAmB,IAAnB,EAAyB,QAAzB,EAAmC,IAAnC;AACH;AACJ;;;0CAEiB,I,EAAM;AACpB,iBAAK,SAAL,GAAiB,IAAjB;AACA,gBAAI,KAAK,sBAAL,IAA+B,IAAnC,EAAyC;AACrC,qBAAK,sBAAL;AACH;AACJ;;;uCAEc,K,EAAO;AAClB;AACA,gBAAI,KAAK,YAAL,IAAqB,CAAzB,EAA4B;AACxB,oBAAI,KAAK,kBAAL,IAA2B,IAA3B,IAAmC,KAAK,OAAL,IAAgB,IAAvD,EAA6D;AACzD,yBAAK,kBAAL,CAAwB,KAAK,OAAL,CAAa,WAArC;AACH;AACD;AACH;;AAED;AACA,gBAAI,KAAK,eAAL,KAAyB,gBAAgB,MAA7C,EAAqD;AACjD,oBAAI,CAAC,KAAK,OAAN,IAAiB,KAAK,kBAAL,IAA2B,IAA5C,IAAoD,KAAK,OAAL,IAAgB,IAAxE,EAA8E;AAC1E,yBAAK,kBAAL,CAAwB,KAAK,OAAL,CAAa,WAArC;AACH;AACJ,aAJD,MAKK,IAAI,KAAK,eAAL,KAAyB,gBAAgB,OAA7C,EAAsD;AACvD,oBAAI,CAAC,KAAK,OAAN,IAAiB,KAAK,kBAAL,IAA2B,IAA5C,IAAoD,KAAK,OAAL,IAAgB,IAAxE,EAA8E;AAC1E,wBAAI,cAAc,KAAK,QAAL,IAAiB,KAAK,OAAL,CAAa,WAAb,GAA2B,KAAK,gBAAjD,CAAlB;AACA,yBAAK,kBAAL,CAAwB,WAAxB;AACH;AACJ;AACJ;;;sCAEa,I,EAAM;AAAA;;AAChB,gBAAI,KAAK,QAAT,EAAmB;AACf,oBAAI,KAAK,GAAL,CAAS,KAAK,QAAL,GAAc,IAAd,GAAqB,IAA9B,KAAuC,IAA3C,EAAiD;AAC7C;AACH;;AAED,oBAAI,KAAK,WAAL,IAAoB,IAAxB,EAA8B;AAC1B,iCAAa,KAAK,WAAlB;AACA,yBAAK,WAAL,GAAmB,IAAnB;AACH;;AAED,qBAAK,QAAL,GAAgB,KAAhB;AACA,2BAAW,YAAI;AACX,2BAAK,OAAL,GAAe,KAAf;AACA,2BAAK,OAAL,CAAa,WAAb,GAA2B,OAAK,IAAhC;AACA,wBAAI,MAAM,IAAI,IAAJ,GAAW,OAAX,KAAuB,OAAK,cAAtC;AACA,4BAAQ,GAAR,CAAY,WAAW,GAAvB;AACA,wBAAI,OAAK,4BAAL,IAAqC,IAAzC,EAA+C;AAC3C,+BAAK,4BAAL,CAAkC,sCAAuB,WAAzD,EACI,UADJ;AAEH;AACJ,iBATD,EASE,IATF;AAUA;AACH;AACJ;;;sCA9ToB;AACjB,mBAAO,OAAO,WAAP,IACH,OAAO,WAAP,CAAmB,eAAnB,CAAmC,2CAAnC,CADJ;AAEH;;;;EApC8B,gB;;;;;;;;ACZ5B,IAAM,sCAAe;AACxB,oBAAgB;AADQ,CAArB;;AAIA,IAAM,sDAAuB;AAChC,oBAAgB,gBADgB;AAEhC,kBAAc;AAFkB,CAA7B;;AAKA,IAAM,4DAA0B;AACnC,yBAAqB,qBADc;AAEnC,4BAAwB,wBAFW;AAGnC,kBAAc,cAHqB;AAInC,gBAAY,YAJuB;AAKnC,+BAA2B,2BALQ;AAMnC,4BAAwB;AANW,CAAhC;;;;;;;;;;;;;ICTM,O,WAAA,O;AAET,qBAAY,QAAZ,EAAsB;AAAA;;AAClB,aAAK,KAAL,GAAa,YAAY,WAAzB;AACH;;;;6BAEI,O,EAAS,K,EAAO,I,EAAM,O,EAAS,M,EAAQ,CAC3C;;;2BAEE,K,EAAO,I,EAAM,CAEf;;;4BAEG,K,EAAO,CAEV;;;2CAEkB,O,EAAS,CAC3B;;;+BAEM,CACN;;;kCAES,CAET;;;;;;;;;;;;;;;;ACzBL;;AACA;;AACA;;AACA;;AAEA;;;;AAEA;;;;AACA;;AACA;;;;;;;;;;AAEA,IAAM,cAAc,GAApB;AACA,IAAM,YAAY,KAAlB;;IAEa,a,WAAA,a;;;AAET,6BAAe;AAAA;;AAAA,kIACL,gBADK;;AAEX,cAAK,GAAL,GAAW,eAAX;;AAEA,cAAK,OAAL,GAAe,IAAf;AACA,cAAK,KAAL,GAAa,IAAb;AACA,cAAK,IAAL,GAAY,IAAZ;AACA,cAAK,OAAL,GAAe,IAAf;;AAEA,cAAK,MAAL,GAAc,IAAd;AACA,cAAK,QAAL,GAAgB,IAAhB;AACA,cAAK,MAAL,GAAc,IAAd;AACA,cAAK,OAAL,GAAe,IAAf;;AAEA,cAAK,qBAAL,GAA6B,IAA7B;;AAEA,cAAK,SAAL,GAAiB,IAAI,oBAAJ,EAAjB;;AAEA,cAAK,UAAL,GAAkB,IAAlB;AACA,cAAK,SAAL,GAAiB,IAAjB;;AAEA,cAAK,oBAAL,GAA4B,KAA5B;AACA,cAAK,iBAAL,GAAyB,KAAzB;AACA,cAAK,4BAAL,GAAoC,KAApC;AACA,cAAK,UAAL,GAAkB,KAAlB;AAxBW;AAyBd;;;;6BAOI,O,EAAS,K,EAAO,I,EAAM,O,EAAS,M,EAAQ;AACxC,iBAAK,OAAL,GAAe,OAAf;AACA,iBAAK,KAAL,GAAa,KAAb;AACA,iBAAK,IAAL,GAAY,IAAZ;AACA,iBAAK,OAAL,GAAe,OAAf;AACA,gBAAI,CAAC,KAAK,gBAAL,EAAL,EAA8B;AAC1B,uBAAO,KAAP;AACH;;AAED,iBAAK,YAAL,CAAkB,OAAlB;AACA,mBAAO,IAAP;AACH;;;2BAEE,K,EAAO,I,EAAM;AACZ,gBAAI,UAAU,4BAAa,cAA3B,EAA2C;AACvC,qBAAK,qBAAL,GAA6B,IAA7B;AACH;AACJ;;;4BAEG,K,EAAO;AACP,gBAAI,UAAU,4BAAa,cAA3B,EAA2C;AACvC,qBAAK,qBAAL,GAA6B,IAA7B;AACH;AACJ;;;2CAEkB,O,EAAS;AACxB,iBAAK,OAAL,GAAe,OAAf;;AAEA,iBAAK,OAAL,CAAa,gBAAb,CAA8B,YAA9B,EAA4C,KAAK,mBAAL,CAAyB,IAAzB,CAA8B,IAA9B,CAA5C,EAAiF,EAAC,MAAM,IAAP,EAAjF;AACA,iBAAK,MAAL,CAAY,EAAZ,CAAe,eAAM,MAAN,CAAa,KAA5B,EAAmC,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAAnC;AACA,iBAAK,MAAL,CAAY,yBAAZ,CAAsC,KAAK,uBAAL,CAA6B,IAA7B,CAAkC,IAAlC,CAAtC;;AAEA,iBAAK,MAAL,CAAY,kBAAZ,CAA+B,OAA/B;AACH;;;+BAEM;AACH,iBAAK,MAAL,CAAY,IAAZ;AACA,iBAAK,YAAL,CAAkB,KAAK,KAAvB;AACH;;;kCAES;AACN,iBAAK,UAAL,GAAkB,IAAlB;;AAEA,iBAAK,cAAL;AACA,iBAAK,cAAL;AACA,iBAAK,gBAAL;AACA,iBAAK,gBAAL;AACH;;;2CAEkB;AACf,gBAAI,WAAK,aAAL,CAAmB,KAAK,OAAxB,KAAoC,WAAK,aAAL,CAAmB,KAAK,KAAxB,CAAxC,EAAwE;AACpE,uBAAO,KAAP;AACH;AACD,gBAAI,WAAK,aAAL,CAAmB,KAAK,IAAxB,CAAJ,EAAmC;AAC/B,uBAAO,KAAP;AACH;AACD,gBAAI,KAAK,OAAL,GAAe,CAAf,IAAoB,KAAK,OAAL,GAAe,GAAvC,EAA4C;AACxC,uBAAO,KAAP;AACH;AACD,mBAAO,IAAP;AACH;;;qCAEY,G,EAAK;AACd,iBAAK,cAAL;;AAEA,iBAAK,MAAL,GAAc,eAAM,YAAN,CAAmB,EAAC,QAAO,IAAR,EAAc,MAAK,KAAnB,EAAyB,KAAI,GAA7B,EAAnB,EAAsD;AAChE,0BAAU,KADsD;AAEhE,mCAAmB,KAF6C;AAGhE,0CAAyB;AAHuC,aAAtD,CAAd;AAKH;;;8CAEqB;AAClB,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,mBAAZ;AACH;;AAED,iBAAK,oBAAL,GAA4B,IAA5B;AACA,gBAAI,KAAK,iBAAL,IAA0B,KAAK,qBAAL,IAA8B,IAA5D,EAAkE;AAC9D,qBAAK,qBAAL,CAA2B,oCAAqB,cAAhD,EAAgE,EAAhE;AACH;AACJ;;;uCAEc,I,EAAM,M,EAAQ,M,EAAQ;AACjC,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,cAAZ;AACH;;AAED,gBAAI,KAAK,qBAAL,IAA8B,IAAlC,EAAwC;AACpC;AACH;;AAED,gBAAI,KAAK,oBAAT,EAA+B;AAC3B,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,YAD5B;AAEH,aAHD,MAIK;AACD,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,mBAD5B;AAEH;AACJ;;;gDAEuB,I,EAAM;AAC1B,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,mBAAZ;AACH;;AAED,gBAAI,KAAK,qBAAL,IAA8B,IAAlC,EAAwC;AACpC,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,sBAD5B;AAEH;AACJ;;;yCAEgB;AACb,gBAAI,KAAK,MAAL,IAAe,IAAnB,EAAyB;AACrB,qBAAK,MAAL,CAAY,KAAZ;AACA,qBAAK,MAAL,CAAY,MAAZ;AACA,qBAAK,MAAL,CAAY,kBAAZ;AACA,qBAAK,MAAL,CAAY,OAAZ;AACA,qBAAK,MAAL,GAAc,IAAd;AACH;;AAED,gBAAI,KAAK,OAAL,IAAgB,IAApB,EAA0B;AACtB,qBAAK,OAAL,GAAe,IAAf;AACH;AACJ;;;qCAEY,G,EAAK;AACd,iBAAK,MAAL,GAAc,IAAI,SAAJ,CAAc,GAAd,CAAd;AACA,iBAAK,MAAL,CAAY,MAAZ,GAAqB,KAAK,aAAL,CAAmB,IAAnB,CAAwB,IAAxB,CAArB;AACA,iBAAK,MAAL,CAAY,SAAZ,GAAwB,KAAK,YAAL,CAAkB,IAAlB,CAAuB,IAAvB,CAAxB;AACA,iBAAK,MAAL,CAAY,OAAZ,GAAsB,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAAtB;AACA,iBAAK,MAAL,CAAY,OAAZ,GAAsB,KAAK,cAAL,CAAoB,IAApB,CAAyB,IAAzB,CAAtB;AACH;;;wCAEe;AACZ,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,gBAAZ;AACH;;AAED,iBAAK,cAAL;AACH;;;qCAEY,C,EAAG,CAEf;;;uCAEc,C,EAAG;AACd,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,iBAAZ;AACH;;AAED,gBAAI,KAAK,qBAAL,IAA8B,IAAlC,EAAwC;AACpC,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,UAD5B;AAEH;AACJ;;;uCAEc,C,EAAG;AACd,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,iBAAZ;AACH;AACJ;;;yCAEgB;AACb,iBAAK,MAAL,CAAY,KAAZ;AACA,iBAAK,MAAL,GAAc,IAAd;AACH;;;yCAEgB;AACb,gBAAI,KAAK,QAAT,EAAmB;AACf,qBAAK,QAAL,CAAc,KAAd;AACH;;AAED,iBAAK,QAAL,GAAgB,4BAAS;AACrB,sBAAK,KADgB;AAErB,4BAAW,IAFU;AAGrB,yBAAQ,EAHa;AAIrB,2BAAU,KAAK,wBAAL,CAA8B,IAA9B,CAAmC,IAAnC;AAJW,aAAT,CAAhB;AAMA,iBAAK,UAAL,GAAkB,WAAW,KAAK,kCAAL,CAAwC,IAAxC,CAA6C,IAA7C,CAAX,EAA8D,KAA9D,CAAlB;AACA,iBAAK,QAAL,CAAc,IAAd,CAAmB,KAAK,sBAAL,CAA4B,IAA5B,CAAiC,IAAjC,CAAnB,EACI,KAAK,yBAAL,CAA+B,IAA/B,CAAoC,IAApC,CADJ;AAEH;;;6DAEoC;AACjC,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,iCAAZ;AACH;;AAED,iBAAK,4BAAL,GAAoC,IAApC;;AAEA,gBAAI,KAAK,qBAAL,IAA8B,IAAlC,EAAwC;AACpC,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,yBAD5B;AAEH;AACJ;;;iDAEwB;AACrB,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,0BAAZ;AACH;;AAED,gBAAI,KAAK,4BAAT,EAAuC;AACnC;AACH;;AAED,yBAAa,KAAK,UAAlB;;AAEA,iBAAK,iBAAL,GAAyB,IAAzB;AACA,gBAAI,KAAK,oBAAL,IAA6B,KAAK,qBAAL,IAA8B,IAA/D,EAAqE;AACjE,qBAAK,qBAAL,CAA2B,oCAAqB,cAAhD,EAAgE,EAAhE;AACH;;AAED,iBAAK,QAAL,CAAc,KAAd;AACA,iBAAK,SAAL;AACH;;;kDAEyB,G,EAAK,c,EAAgB;AAC3C,gBAAI,SAAJ,EAAe;AACX,wBAAQ,GAAR,CAAY,6BAAZ;AACH;;AAED,yBAAa,KAAK,UAAlB;;AAEA,gBAAI,KAAK,qBAAL,IAA8B,IAAlC,EAAwC;AACpC,qBAAK,qBAAL,CAA2B,oCAAqB,YAAhD,EACI,uCAAwB,sBAD5B;AAEH;AACJ;;;iDAEwB,O,EAAS,U,EAAY,c,EAAgB,gB,EAAkB;AAC5E,gBAAI,WAAW,QAAQ,QAAQ,MAAR,GAAiB,CAAzB,EAA4B,MAA3C,CAD4E,CACzB;AACnD,gBAAI,QAAQ,IAAI,UAAJ,CAAe,QAAf,CAAZ,CAF4E,CAEtC;AACtC,iBAAK,SAAL,CAAe,IAAf,CAAoB,KAApB;AACH;;;2CAEkB;AACf,iBAAK,QAAL,CAAc,KAAd;AACA,iBAAK,QAAL,GAAgB,IAAhB;AACH;;;oCAEW;AACR,gBAAI,KAAK,UAAT,EAAqB;AACjB;AACH;;AAED,gBAAI,KAAK,SAAL,CAAe,MAAf,GAAwB,WAA5B,EAAyC;AACrC,qBAAK,SAAL,GAAiB,WAAW,KAAK,SAAL,CAAe,IAAf,CAAoB,IAApB,CAAX,EAAsC,CAAtC,CAAjB;AACH,aAFD,MAGK;AACD,oBAAI,WAAW,KAAK,SAAL,CAAe,SAAf,CAAyB,WAAzB,CAAf;;AAEA,oBAAI,SAAS,IAAI,oBAAJ,EAAb;AACA,uBAAO,IAAP,CAAY,IAAI,UAAJ,CAAe,CAAC,IAAD,EAAM,IAAN,EAAW,IAAX,EAAgB,IAAhB,CAAf,CAAZ;AACA,oBAAI,cAAc,KAAK,IAAL,CAAU,KAAV,CAAgB,EAAhB,CAAlB;AACA,qBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,YAAY,MAAhC,EAAwC,GAAxC,EAA6C;AACzC,2BAAO,IAAP,CAAY,IAAI,UAAJ,CAAe,CAAC,YAAY,CAAZ,EAAe,UAAf,EAAD,CAAf,CAAZ;AACH;AACD,uBAAO,IAAP,CAAY,IAAI,UAAJ,CAAe,CAAC,SAAS,KAAK,OAAd,CAAD,CAAf,CAAZ;AACA,uBAAO,IAAP,CAAY,IAAI,UAAJ,CAAe,CAAC,KAAK,KAAL,CAAW,cAAY,GAAvB,CAAD,CAAf,CAAZ;AACA,uBAAO,IAAP,CAAY,IAAI,UAAJ,CAAe,CAAC,cAAY,GAAb,CAAf,CAAZ;AACA,uBAAO,IAAP,CAAY,QAAZ;;AAEA,oBAAI,WAAW,IAAI,YAAY,MAAhB,GAAyB,CAAzB,GAA6B,WAA5C;AACA,oBAAI,KAAK,MAAL,IAAe,IAAnB,EAAyB;AACrB,yBAAK,MAAL,CAAY,IAAZ,CAAiB,OAAO,SAAP,CAAiB,QAAjB,CAAjB;AACH;;AAED,qBAAK,SAAL;AACH;AACJ;;;2CAEkB;AACf,yBAAa,KAAK,SAAlB;AACH;;;sCAxRoB;AACjB,mBAAO,OAAO,SAAP,IAAoB,WAApB,IAAmC,uBAAS,OAAT,EAAnC,IAAyD,OAAO,WAAhE,IACH,OAAO,WAAP,CAAmB,eAAnB,CAAmC,2CAAnC,CADJ;AAEH;;;;EAhC8B,gB","file":"gmedia.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.flvjs = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){\n(function (process,global){\n/*!\n * @overview es6-promise - a tiny implementation of Promises/A+.\n * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)\n * @license   Licensed under MIT license\n *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE\n * @version   v4.2.5+7f2b526d\n */\n\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.ES6Promise = factory());\n}(this, (function () { 'use strict';\n\nfunction objectOrFunction(x) {\n  var type = typeof x;\n  return x !== null && (type === 'object' || type === 'function');\n}\n\nfunction isFunction(x) {\n  return typeof x === 'function';\n}\n\n\n\nvar _isArray = void 0;\nif (Array.isArray) {\n  _isArray = Array.isArray;\n} else {\n  _isArray = function (x) {\n    return Object.prototype.toString.call(x) === '[object Array]';\n  };\n}\n\nvar isArray = _isArray;\n\nvar len = 0;\nvar vertxNext = void 0;\nvar customSchedulerFn = void 0;\n\nvar asap = function asap(callback, arg) {\n  queue[len] = callback;\n  queue[len + 1] = arg;\n  len += 2;\n  if (len === 2) {\n    // If len is 2, that means that we need to schedule an async flush.\n    // If additional callbacks are queued before the queue is flushed, they\n    // will be processed by this flush that we are scheduling.\n    if (customSchedulerFn) {\n      customSchedulerFn(flush);\n    } else {\n      scheduleFlush();\n    }\n  }\n};\n\nfunction setScheduler(scheduleFn) {\n  customSchedulerFn = scheduleFn;\n}\n\nfunction setAsap(asapFn) {\n  asap = asapFn;\n}\n\nvar browserWindow = typeof window !== 'undefined' ? window : undefined;\nvar browserGlobal = browserWindow || {};\nvar BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;\nvar isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]';\n\n// test for web worker but not in IE10\nvar isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined';\n\n// node\nfunction useNextTick() {\n  // node version 0.10.x displays a deprecation warning when nextTick is used recursively\n  // see https://github.com/cujojs/when/issues/410 for details\n  return function () {\n    return process.nextTick(flush);\n  };\n}\n\n// vertx\nfunction useVertxTimer() {\n  if (typeof vertxNext !== 'undefined') {\n    return function () {\n      vertxNext(flush);\n    };\n  }\n\n  return useSetTimeout();\n}\n\nfunction useMutationObserver() {\n  var iterations = 0;\n  var observer = new BrowserMutationObserver(flush);\n  var node = document.createTextNode('');\n  observer.observe(node, { characterData: true });\n\n  return function () {\n    node.data = iterations = ++iterations % 2;\n  };\n}\n\n// web worker\nfunction useMessageChannel() {\n  var channel = new MessageChannel();\n  channel.port1.onmessage = flush;\n  return function () {\n    return channel.port2.postMessage(0);\n  };\n}\n\nfunction useSetTimeout() {\n  // Store setTimeout reference so es6-promise will be unaffected by\n  // other code modifying setTimeout (like sinon.useFakeTimers())\n  var globalSetTimeout = setTimeout;\n  return function () {\n    return globalSetTimeout(flush, 1);\n  };\n}\n\nvar queue = new Array(1000);\nfunction flush() {\n  for (var i = 0; i < len; i += 2) {\n    var callback = queue[i];\n    var arg = queue[i + 1];\n\n    callback(arg);\n\n    queue[i] = undefined;\n    queue[i + 1] = undefined;\n  }\n\n  len = 0;\n}\n\nfunction attemptVertx() {\n  try {\n    var vertx = Function('return this')().require('vertx');\n    vertxNext = vertx.runOnLoop || vertx.runOnContext;\n    return useVertxTimer();\n  } catch (e) {\n    return useSetTimeout();\n  }\n}\n\nvar scheduleFlush = void 0;\n// Decide what async method to use to triggering processing of queued callbacks:\nif (isNode) {\n  scheduleFlush = useNextTick();\n} else if (BrowserMutationObserver) {\n  scheduleFlush = useMutationObserver();\n} else if (isWorker) {\n  scheduleFlush = useMessageChannel();\n} else if (browserWindow === undefined && typeof _dereq_ === 'function') {\n  scheduleFlush = attemptVertx();\n} else {\n  scheduleFlush = useSetTimeout();\n}\n\nfunction then(onFulfillment, onRejection) {\n  var parent = this;\n\n  var child = new this.constructor(noop);\n\n  if (child[PROMISE_ID] === undefined) {\n    makePromise(child);\n  }\n\n  var _state = parent._state;\n\n\n  if (_state) {\n    var callback = arguments[_state - 1];\n    asap(function () {\n      return invokeCallback(_state, child, callback, parent._result);\n    });\n  } else {\n    subscribe(parent, child, onFulfillment, onRejection);\n  }\n\n  return child;\n}\n\n/**\n  `Promise.resolve` returns a promise that will become resolved with the\n  passed `value`. It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    resolve(1);\n  });\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.resolve(1);\n\n  promise.then(function(value){\n    // value === 1\n  });\n  ```\n\n  @method resolve\n  @static\n  @param {Any} value value that the returned promise will be resolved with\n  Useful for tooling.\n  @return {Promise} a promise that will become fulfilled with the given\n  `value`\n*/\nfunction resolve$1(object) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (object && typeof object === 'object' && object.constructor === Constructor) {\n    return object;\n  }\n\n  var promise = new Constructor(noop);\n  resolve(promise, object);\n  return promise;\n}\n\nvar PROMISE_ID = Math.random().toString(36).substring(2);\n\nfunction noop() {}\n\nvar PENDING = void 0;\nvar FULFILLED = 1;\nvar REJECTED = 2;\n\nvar TRY_CATCH_ERROR = { error: null };\n\nfunction selfFulfillment() {\n  return new TypeError(\"You cannot resolve a promise with itself\");\n}\n\nfunction cannotReturnOwn() {\n  return new TypeError('A promises callback cannot return that same promise.');\n}\n\nfunction getThen(promise) {\n  try {\n    return promise.then;\n  } catch (error) {\n    TRY_CATCH_ERROR.error = error;\n    return TRY_CATCH_ERROR;\n  }\n}\n\nfunction tryThen(then$$1, value, fulfillmentHandler, rejectionHandler) {\n  try {\n    then$$1.call(value, fulfillmentHandler, rejectionHandler);\n  } catch (e) {\n    return e;\n  }\n}\n\nfunction handleForeignThenable(promise, thenable, then$$1) {\n  asap(function (promise) {\n    var sealed = false;\n    var error = tryThen(then$$1, thenable, function (value) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n      if (thenable !== value) {\n        resolve(promise, value);\n      } else {\n        fulfill(promise, value);\n      }\n    }, function (reason) {\n      if (sealed) {\n        return;\n      }\n      sealed = true;\n\n      reject(promise, reason);\n    }, 'Settle: ' + (promise._label || ' unknown promise'));\n\n    if (!sealed && error) {\n      sealed = true;\n      reject(promise, error);\n    }\n  }, promise);\n}\n\nfunction handleOwnThenable(promise, thenable) {\n  if (thenable._state === FULFILLED) {\n    fulfill(promise, thenable._result);\n  } else if (thenable._state === REJECTED) {\n    reject(promise, thenable._result);\n  } else {\n    subscribe(thenable, undefined, function (value) {\n      return resolve(promise, value);\n    }, function (reason) {\n      return reject(promise, reason);\n    });\n  }\n}\n\nfunction handleMaybeThenable(promise, maybeThenable, then$$1) {\n  if (maybeThenable.constructor === promise.constructor && then$$1 === then && maybeThenable.constructor.resolve === resolve$1) {\n    handleOwnThenable(promise, maybeThenable);\n  } else {\n    if (then$$1 === TRY_CATCH_ERROR) {\n      reject(promise, TRY_CATCH_ERROR.error);\n      TRY_CATCH_ERROR.error = null;\n    } else if (then$$1 === undefined) {\n      fulfill(promise, maybeThenable);\n    } else if (isFunction(then$$1)) {\n      handleForeignThenable(promise, maybeThenable, then$$1);\n    } else {\n      fulfill(promise, maybeThenable);\n    }\n  }\n}\n\nfunction resolve(promise, value) {\n  if (promise === value) {\n    reject(promise, selfFulfillment());\n  } else if (objectOrFunction(value)) {\n    handleMaybeThenable(promise, value, getThen(value));\n  } else {\n    fulfill(promise, value);\n  }\n}\n\nfunction publishRejection(promise) {\n  if (promise._onerror) {\n    promise._onerror(promise._result);\n  }\n\n  publish(promise);\n}\n\nfunction fulfill(promise, value) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n\n  promise._result = value;\n  promise._state = FULFILLED;\n\n  if (promise._subscribers.length !== 0) {\n    asap(publish, promise);\n  }\n}\n\nfunction reject(promise, reason) {\n  if (promise._state !== PENDING) {\n    return;\n  }\n  promise._state = REJECTED;\n  promise._result = reason;\n\n  asap(publishRejection, promise);\n}\n\nfunction subscribe(parent, child, onFulfillment, onRejection) {\n  var _subscribers = parent._subscribers;\n  var length = _subscribers.length;\n\n\n  parent._onerror = null;\n\n  _subscribers[length] = child;\n  _subscribers[length + FULFILLED] = onFulfillment;\n  _subscribers[length + REJECTED] = onRejection;\n\n  if (length === 0 && parent._state) {\n    asap(publish, parent);\n  }\n}\n\nfunction publish(promise) {\n  var subscribers = promise._subscribers;\n  var settled = promise._state;\n\n  if (subscribers.length === 0) {\n    return;\n  }\n\n  var child = void 0,\n      callback = void 0,\n      detail = promise._result;\n\n  for (var i = 0; i < subscribers.length; i += 3) {\n    child = subscribers[i];\n    callback = subscribers[i + settled];\n\n    if (child) {\n      invokeCallback(settled, child, callback, detail);\n    } else {\n      callback(detail);\n    }\n  }\n\n  promise._subscribers.length = 0;\n}\n\nfunction tryCatch(callback, detail) {\n  try {\n    return callback(detail);\n  } catch (e) {\n    TRY_CATCH_ERROR.error = e;\n    return TRY_CATCH_ERROR;\n  }\n}\n\nfunction invokeCallback(settled, promise, callback, detail) {\n  var hasCallback = isFunction(callback),\n      value = void 0,\n      error = void 0,\n      succeeded = void 0,\n      failed = void 0;\n\n  if (hasCallback) {\n    value = tryCatch(callback, detail);\n\n    if (value === TRY_CATCH_ERROR) {\n      failed = true;\n      error = value.error;\n      value.error = null;\n    } else {\n      succeeded = true;\n    }\n\n    if (promise === value) {\n      reject(promise, cannotReturnOwn());\n      return;\n    }\n  } else {\n    value = detail;\n    succeeded = true;\n  }\n\n  if (promise._state !== PENDING) {\n    // noop\n  } else if (hasCallback && succeeded) {\n    resolve(promise, value);\n  } else if (failed) {\n    reject(promise, error);\n  } else if (settled === FULFILLED) {\n    fulfill(promise, value);\n  } else if (settled === REJECTED) {\n    reject(promise, value);\n  }\n}\n\nfunction initializePromise(promise, resolver) {\n  try {\n    resolver(function resolvePromise(value) {\n      resolve(promise, value);\n    }, function rejectPromise(reason) {\n      reject(promise, reason);\n    });\n  } catch (e) {\n    reject(promise, e);\n  }\n}\n\nvar id = 0;\nfunction nextId() {\n  return id++;\n}\n\nfunction makePromise(promise) {\n  promise[PROMISE_ID] = id++;\n  promise._state = undefined;\n  promise._result = undefined;\n  promise._subscribers = [];\n}\n\nfunction validationError() {\n  return new Error('Array Methods must be provided an Array');\n}\n\nvar Enumerator = function () {\n  function Enumerator(Constructor, input) {\n    this._instanceConstructor = Constructor;\n    this.promise = new Constructor(noop);\n\n    if (!this.promise[PROMISE_ID]) {\n      makePromise(this.promise);\n    }\n\n    if (isArray(input)) {\n      this.length = input.length;\n      this._remaining = input.length;\n\n      this._result = new Array(this.length);\n\n      if (this.length === 0) {\n        fulfill(this.promise, this._result);\n      } else {\n        this.length = this.length || 0;\n        this._enumerate(input);\n        if (this._remaining === 0) {\n          fulfill(this.promise, this._result);\n        }\n      }\n    } else {\n      reject(this.promise, validationError());\n    }\n  }\n\n  Enumerator.prototype._enumerate = function _enumerate(input) {\n    for (var i = 0; this._state === PENDING && i < input.length; i++) {\n      this._eachEntry(input[i], i);\n    }\n  };\n\n  Enumerator.prototype._eachEntry = function _eachEntry(entry, i) {\n    var c = this._instanceConstructor;\n    var resolve$$1 = c.resolve;\n\n\n    if (resolve$$1 === resolve$1) {\n      var _then = getThen(entry);\n\n      if (_then === then && entry._state !== PENDING) {\n        this._settledAt(entry._state, i, entry._result);\n      } else if (typeof _then !== 'function') {\n        this._remaining--;\n        this._result[i] = entry;\n      } else if (c === Promise$1) {\n        var promise = new c(noop);\n        handleMaybeThenable(promise, entry, _then);\n        this._willSettleAt(promise, i);\n      } else {\n        this._willSettleAt(new c(function (resolve$$1) {\n          return resolve$$1(entry);\n        }), i);\n      }\n    } else {\n      this._willSettleAt(resolve$$1(entry), i);\n    }\n  };\n\n  Enumerator.prototype._settledAt = function _settledAt(state, i, value) {\n    var promise = this.promise;\n\n\n    if (promise._state === PENDING) {\n      this._remaining--;\n\n      if (state === REJECTED) {\n        reject(promise, value);\n      } else {\n        this._result[i] = value;\n      }\n    }\n\n    if (this._remaining === 0) {\n      fulfill(promise, this._result);\n    }\n  };\n\n  Enumerator.prototype._willSettleAt = function _willSettleAt(promise, i) {\n    var enumerator = this;\n\n    subscribe(promise, undefined, function (value) {\n      return enumerator._settledAt(FULFILLED, i, value);\n    }, function (reason) {\n      return enumerator._settledAt(REJECTED, i, reason);\n    });\n  };\n\n  return Enumerator;\n}();\n\n/**\n  `Promise.all` accepts an array of promises, and returns a new promise which\n  is fulfilled with an array of fulfillment values for the passed promises, or\n  rejected with the reason of the first passed promise to be rejected. It casts all\n  elements of the passed iterable to promises as it runs this algorithm.\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = resolve(2);\n  let promise3 = resolve(3);\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // The array here would be [ 1, 2, 3 ];\n  });\n  ```\n\n  If any of the `promises` given to `all` are rejected, the first promise\n  that is rejected will be given as an argument to the returned promises's\n  rejection handler. For example:\n\n  Example:\n\n  ```javascript\n  let promise1 = resolve(1);\n  let promise2 = reject(new Error(\"2\"));\n  let promise3 = reject(new Error(\"3\"));\n  let promises = [ promise1, promise2, promise3 ];\n\n  Promise.all(promises).then(function(array){\n    // Code here never runs because there are rejected promises!\n  }, function(error) {\n    // error.message === \"2\"\n  });\n  ```\n\n  @method all\n  @static\n  @param {Array} entries array of promises\n  @param {String} label optional string for labeling the promise.\n  Useful for tooling.\n  @return {Promise} promise that is fulfilled when all `promises` have been\n  fulfilled, or rejected if any of them become rejected.\n  @static\n*/\nfunction all(entries) {\n  return new Enumerator(this, entries).promise;\n}\n\n/**\n  `Promise.race` returns a new promise which is settled in the same way as the\n  first passed promise to settle.\n\n  Example:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 2');\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // result === 'promise 2' because it was resolved before promise1\n    // was resolved.\n  });\n  ```\n\n  `Promise.race` is deterministic in that only the state of the first\n  settled promise matters. For example, even if other promises given to the\n  `promises` array argument are resolved, but the first settled promise has\n  become rejected before the other promises became fulfilled, the returned\n  promise will become rejected:\n\n  ```javascript\n  let promise1 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      resolve('promise 1');\n    }, 200);\n  });\n\n  let promise2 = new Promise(function(resolve, reject){\n    setTimeout(function(){\n      reject(new Error('promise 2'));\n    }, 100);\n  });\n\n  Promise.race([promise1, promise2]).then(function(result){\n    // Code here never runs\n  }, function(reason){\n    // reason.message === 'promise 2' because promise 2 became rejected before\n    // promise 1 became fulfilled\n  });\n  ```\n\n  An example real-world use case is implementing timeouts:\n\n  ```javascript\n  Promise.race([ajax('foo.json'), timeout(5000)])\n  ```\n\n  @method race\n  @static\n  @param {Array} promises array of promises to observe\n  Useful for tooling.\n  @return {Promise} a promise which settles in the same way as the first passed\n  promise to settle.\n*/\nfunction race(entries) {\n  /*jshint validthis:true */\n  var Constructor = this;\n\n  if (!isArray(entries)) {\n    return new Constructor(function (_, reject) {\n      return reject(new TypeError('You must pass an array to race.'));\n    });\n  } else {\n    return new Constructor(function (resolve, reject) {\n      var length = entries.length;\n      for (var i = 0; i < length; i++) {\n        Constructor.resolve(entries[i]).then(resolve, reject);\n      }\n    });\n  }\n}\n\n/**\n  `Promise.reject` returns a promise rejected with the passed `reason`.\n  It is shorthand for the following:\n\n  ```javascript\n  let promise = new Promise(function(resolve, reject){\n    reject(new Error('WHOOPS'));\n  });\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  Instead of writing the above, your code now simply becomes the following:\n\n  ```javascript\n  let promise = Promise.reject(new Error('WHOOPS'));\n\n  promise.then(function(value){\n    // Code here doesn't run because the promise is rejected!\n  }, function(reason){\n    // reason.message === 'WHOOPS'\n  });\n  ```\n\n  @method reject\n  @static\n  @param {Any} reason value that the returned promise will be rejected with.\n  Useful for tooling.\n  @return {Promise} a promise rejected with the given `reason`.\n*/\nfunction reject$1(reason) {\n  /*jshint validthis:true */\n  var Constructor = this;\n  var promise = new Constructor(noop);\n  reject(promise, reason);\n  return promise;\n}\n\nfunction needsResolver() {\n  throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');\n}\n\nfunction needsNew() {\n  throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");\n}\n\n/**\n  Promise objects represent the eventual result of an asynchronous operation. The\n  primary way of interacting with a promise is through its `then` method, which\n  registers callbacks to receive either a promise's eventual value or the reason\n  why the promise cannot be fulfilled.\n\n  Terminology\n  -----------\n\n  - `promise` is an object or function with a `then` method whose behavior conforms to this specification.\n  - `thenable` is an object or function that defines a `then` method.\n  - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).\n  - `exception` is a value that is thrown using the throw statement.\n  - `reason` is a value that indicates why a promise was rejected.\n  - `settled` the final resting state of a promise, fulfilled or rejected.\n\n  A promise can be in one of three states: pending, fulfilled, or rejected.\n\n  Promises that are fulfilled have a fulfillment value and are in the fulfilled\n  state.  Promises that are rejected have a rejection reason and are in the\n  rejected state.  A fulfillment value is never a thenable.\n\n  Promises can also be said to *resolve* a value.  If this value is also a\n  promise, then the original promise's settled state will match the value's\n  settled state.  So a promise that *resolves* a promise that rejects will\n  itself reject, and a promise that *resolves* a promise that fulfills will\n  itself fulfill.\n\n\n  Basic Usage:\n  ------------\n\n  ```js\n  let promise = new Promise(function(resolve, reject) {\n    // on success\n    resolve(value);\n\n    // on failure\n    reject(reason);\n  });\n\n  promise.then(function(value) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Advanced Usage:\n  ---------------\n\n  Promises shine when abstracting away asynchronous interactions such as\n  `XMLHttpRequest`s.\n\n  ```js\n  function getJSON(url) {\n    return new Promise(function(resolve, reject){\n      let xhr = new XMLHttpRequest();\n\n      xhr.open('GET', url);\n      xhr.onreadystatechange = handler;\n      xhr.responseType = 'json';\n      xhr.setRequestHeader('Accept', 'application/json');\n      xhr.send();\n\n      function handler() {\n        if (this.readyState === this.DONE) {\n          if (this.status === 200) {\n            resolve(this.response);\n          } else {\n            reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));\n          }\n        }\n      };\n    });\n  }\n\n  getJSON('/posts.json').then(function(json) {\n    // on fulfillment\n  }, function(reason) {\n    // on rejection\n  });\n  ```\n\n  Unlike callbacks, promises are great composable primitives.\n\n  ```js\n  Promise.all([\n    getJSON('/posts'),\n    getJSON('/comments')\n  ]).then(function(values){\n    values[0] // => postsJSON\n    values[1] // => commentsJSON\n\n    return values;\n  });\n  ```\n\n  @class Promise\n  @param {Function} resolver\n  Useful for tooling.\n  @constructor\n*/\n\nvar Promise$1 = function () {\n  function Promise(resolver) {\n    this[PROMISE_ID] = nextId();\n    this._result = this._state = undefined;\n    this._subscribers = [];\n\n    if (noop !== resolver) {\n      typeof resolver !== 'function' && needsResolver();\n      this instanceof Promise ? initializePromise(this, resolver) : needsNew();\n    }\n  }\n\n  /**\n  The primary way of interacting with a promise is through its `then` method,\n  which registers callbacks to receive either a promise's eventual value or the\n  reason why the promise cannot be fulfilled.\n   ```js\n  findUser().then(function(user){\n    // user is available\n  }, function(reason){\n    // user is unavailable, and you are given the reason why\n  });\n  ```\n   Chaining\n  --------\n   The return value of `then` is itself a promise.  This second, 'downstream'\n  promise is resolved with the return value of the first promise's fulfillment\n  or rejection handler, or rejected if the handler throws an exception.\n   ```js\n  findUser().then(function (user) {\n    return user.name;\n  }, function (reason) {\n    return 'default name';\n  }).then(function (userName) {\n    // If `findUser` fulfilled, `userName` will be the user's name, otherwise it\n    // will be `'default name'`\n  });\n   findUser().then(function (user) {\n    throw new Error('Found user, but still unhappy');\n  }, function (reason) {\n    throw new Error('`findUser` rejected and we're unhappy');\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.\n    // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.\n  });\n  ```\n  If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.\n   ```js\n  findUser().then(function (user) {\n    throw new PedagogicalException('Upstream error');\n  }).then(function (value) {\n    // never reached\n  }).then(function (value) {\n    // never reached\n  }, function (reason) {\n    // The `PedgagocialException` is propagated all the way down to here\n  });\n  ```\n   Assimilation\n  ------------\n   Sometimes the value you want to propagate to a downstream promise can only be\n  retrieved asynchronously. This can be achieved by returning a promise in the\n  fulfillment or rejection handler. The downstream promise will then be pending\n  until the returned promise is settled. This is called *assimilation*.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // The user's comments are now available\n  });\n  ```\n   If the assimliated promise rejects, then the downstream promise will also reject.\n   ```js\n  findUser().then(function (user) {\n    return findCommentsByAuthor(user);\n  }).then(function (comments) {\n    // If `findCommentsByAuthor` fulfills, we'll have the value here\n  }, function (reason) {\n    // If `findCommentsByAuthor` rejects, we'll have the reason here\n  });\n  ```\n   Simple Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let result;\n   try {\n    result = findResult();\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n  findResult(function(result, err){\n    if (err) {\n      // failure\n    } else {\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findResult().then(function(result){\n    // success\n  }, function(reason){\n    // failure\n  });\n  ```\n   Advanced Example\n  --------------\n   Synchronous Example\n   ```javascript\n  let author, books;\n   try {\n    author = findAuthor();\n    books  = findBooksByAuthor(author);\n    // success\n  } catch(reason) {\n    // failure\n  }\n  ```\n   Errback Example\n   ```js\n   function foundBooks(books) {\n   }\n   function failure(reason) {\n   }\n   findAuthor(function(author, err){\n    if (err) {\n      failure(err);\n      // failure\n    } else {\n      try {\n        findBoooksByAuthor(author, function(books, err) {\n          if (err) {\n            failure(err);\n          } else {\n            try {\n              foundBooks(books);\n            } catch(reason) {\n              failure(reason);\n            }\n          }\n        });\n      } catch(error) {\n        failure(err);\n      }\n      // success\n    }\n  });\n  ```\n   Promise Example;\n   ```javascript\n  findAuthor().\n    then(findBooksByAuthor).\n    then(function(books){\n      // found books\n  }).catch(function(reason){\n    // something went wrong\n  });\n  ```\n   @method then\n  @param {Function} onFulfilled\n  @param {Function} onRejected\n  Useful for tooling.\n  @return {Promise}\n  */\n\n  /**\n  `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same\n  as the catch block of a try/catch statement.\n  ```js\n  function findAuthor(){\n  throw new Error('couldn't find that author');\n  }\n  // synchronous\n  try {\n  findAuthor();\n  } catch(reason) {\n  // something went wrong\n  }\n  // async with promises\n  findAuthor().catch(function(reason){\n  // something went wrong\n  });\n  ```\n  @method catch\n  @param {Function} onRejection\n  Useful for tooling.\n  @return {Promise}\n  */\n\n\n  Promise.prototype.catch = function _catch(onRejection) {\n    return this.then(null, onRejection);\n  };\n\n  /**\n    `finally` will be invoked regardless of the promise's fate just as native\n    try/catch/finally behaves\n  \n    Synchronous example:\n  \n    ```js\n    findAuthor() {\n      if (Math.random() > 0.5) {\n        throw new Error();\n      }\n      return new Author();\n    }\n  \n    try {\n      return findAuthor(); // succeed or fail\n    } catch(error) {\n      return findOtherAuther();\n    } finally {\n      // always runs\n      // doesn't affect the return value\n    }\n    ```\n  \n    Asynchronous example:\n  \n    ```js\n    findAuthor().catch(function(reason){\n      return findOtherAuther();\n    }).finally(function(){\n      // author was either found, or not\n    });\n    ```\n  \n    @method finally\n    @param {Function} callback\n    @return {Promise}\n  */\n\n\n  Promise.prototype.finally = function _finally(callback) {\n    var promise = this;\n    var constructor = promise.constructor;\n\n    if (isFunction(callback)) {\n      return promise.then(function (value) {\n        return constructor.resolve(callback()).then(function () {\n          return value;\n        });\n      }, function (reason) {\n        return constructor.resolve(callback()).then(function () {\n          throw reason;\n        });\n      });\n    }\n\n    return promise.then(callback, callback);\n  };\n\n  return Promise;\n}();\n\nPromise$1.prototype.then = then;\nPromise$1.all = all;\nPromise$1.race = race;\nPromise$1.resolve = resolve$1;\nPromise$1.reject = reject$1;\nPromise$1._setScheduler = setScheduler;\nPromise$1._setAsap = setAsap;\nPromise$1._asap = asap;\n\n/*global self*/\nfunction polyfill() {\n  var local = void 0;\n\n  if (typeof global !== 'undefined') {\n    local = global;\n  } else if (typeof self !== 'undefined') {\n    local = self;\n  } else {\n    try {\n      local = Function('return this')();\n    } catch (e) {\n      throw new Error('polyfill failed because global object is unavailable in this environment');\n    }\n  }\n\n  var P = local.Promise;\n\n  if (P) {\n    var promiseToString = null;\n    try {\n      promiseToString = Object.prototype.toString.call(P.resolve());\n    } catch (e) {\n      // silently ignored\n    }\n\n    if (promiseToString === '[object Promise]' && !P.cast) {\n      return;\n    }\n  }\n\n  local.Promise = Promise$1;\n}\n\n// Strange compat..\nPromise$1.polyfill = polyfill;\nPromise$1.Promise = Promise$1;\n\nreturn Promise$1;\n\n})));\n\n\n\n\n\n}).call(this,_dereq_('_process'),typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n\n},{\"_process\":3}],2:[function(_dereq_,module,exports){\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nfunction EventEmitter() {\n  this._events = this._events || {};\n  this._maxListeners = this._maxListeners || undefined;\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function(n) {\n  if (!isNumber(n) || n < 0 || isNaN(n))\n    throw TypeError('n must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nEventEmitter.prototype.emit = function(type) {\n  var er, handler, len, args, i, listeners;\n\n  if (!this._events)\n    this._events = {};\n\n  // If there is no 'error' event listener then throw.\n  if (type === 'error') {\n    if (!this._events.error ||\n        (isObject(this._events.error) && !this._events.error.length)) {\n      er = arguments[1];\n      if (er instanceof Error) {\n        throw er; // Unhandled 'error' event\n      } else {\n        // At least give some kind of context to the user\n        var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n        err.context = er;\n        throw err;\n      }\n    }\n  }\n\n  handler = this._events[type];\n\n  if (isUndefined(handler))\n    return false;\n\n  if (isFunction(handler)) {\n    switch (arguments.length) {\n      // fast cases\n      case 1:\n        handler.call(this);\n        break;\n      case 2:\n        handler.call(this, arguments[1]);\n        break;\n      case 3:\n        handler.call(this, arguments[1], arguments[2]);\n        break;\n      // slower\n      default:\n        args = Array.prototype.slice.call(arguments, 1);\n        handler.apply(this, args);\n    }\n  } else if (isObject(handler)) {\n    args = Array.prototype.slice.call(arguments, 1);\n    listeners = handler.slice();\n    len = listeners.length;\n    for (i = 0; i < len; i++)\n      listeners[i].apply(this, args);\n  }\n\n  return true;\n};\n\nEventEmitter.prototype.addListener = function(type, listener) {\n  var m;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events)\n    this._events = {};\n\n  // To avoid recursion in the case that type === \"newListener\"! Before\n  // adding it to the listeners, first emit \"newListener\".\n  if (this._events.newListener)\n    this.emit('newListener', type,\n              isFunction(listener.listener) ?\n              listener.listener : listener);\n\n  if (!this._events[type])\n    // Optimize the case of one listener. Don't need the extra array object.\n    this._events[type] = listener;\n  else if (isObject(this._events[type]))\n    // If we've already got an array, just append.\n    this._events[type].push(listener);\n  else\n    // Adding the second element, need to change to array.\n    this._events[type] = [this._events[type], listener];\n\n  // Check for listener leak\n  if (isObject(this._events[type]) && !this._events[type].warned) {\n    if (!isUndefined(this._maxListeners)) {\n      m = this._maxListeners;\n    } else {\n      m = EventEmitter.defaultMaxListeners;\n    }\n\n    if (m && m > 0 && this._events[type].length > m) {\n      this._events[type].warned = true;\n      console.error('(node) warning: possible EventEmitter memory ' +\n                    'leak detected. %d listeners added. ' +\n                    'Use emitter.setMaxListeners() to increase limit.',\n                    this._events[type].length);\n      if (typeof console.trace === 'function') {\n        // not supported in IE 10\n        console.trace();\n      }\n    }\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.once = function(type, listener) {\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  var fired = false;\n\n  function g() {\n    this.removeListener(type, g);\n\n    if (!fired) {\n      fired = true;\n      listener.apply(this, arguments);\n    }\n  }\n\n  g.listener = listener;\n  this.on(type, g);\n\n  return this;\n};\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener = function(type, listener) {\n  var list, position, length, i;\n\n  if (!isFunction(listener))\n    throw TypeError('listener must be a function');\n\n  if (!this._events || !this._events[type])\n    return this;\n\n  list = this._events[type];\n  length = list.length;\n  position = -1;\n\n  if (list === listener ||\n      (isFunction(list.listener) && list.listener === listener)) {\n    delete this._events[type];\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n\n  } else if (isObject(list)) {\n    for (i = length; i-- > 0;) {\n      if (list[i] === listener ||\n          (list[i].listener && list[i].listener === listener)) {\n        position = i;\n        break;\n      }\n    }\n\n    if (position < 0)\n      return this;\n\n    if (list.length === 1) {\n      list.length = 0;\n      delete this._events[type];\n    } else {\n      list.splice(position, 1);\n    }\n\n    if (this._events.removeListener)\n      this.emit('removeListener', type, listener);\n  }\n\n  return this;\n};\n\nEventEmitter.prototype.removeAllListeners = function(type) {\n  var key, listeners;\n\n  if (!this._events)\n    return this;\n\n  // not listening for removeListener, no need to emit\n  if (!this._events.removeListener) {\n    if (arguments.length === 0)\n      this._events = {};\n    else if (this._events[type])\n      delete this._events[type];\n    return this;\n  }\n\n  // emit removeListener for all listeners on all events\n  if (arguments.length === 0) {\n    for (key in this._events) {\n      if (key === 'removeListener') continue;\n      this.removeAllListeners(key);\n    }\n    this.removeAllListeners('removeListener');\n    this._events = {};\n    return this;\n  }\n\n  listeners = this._events[type];\n\n  if (isFunction(listeners)) {\n    this.removeListener(type, listeners);\n  } else if (listeners) {\n    // LIFO order\n    while (listeners.length)\n      this.removeListener(type, listeners[listeners.length - 1]);\n  }\n  delete this._events[type];\n\n  return this;\n};\n\nEventEmitter.prototype.listeners = function(type) {\n  var ret;\n  if (!this._events || !this._events[type])\n    ret = [];\n  else if (isFunction(this._events[type]))\n    ret = [this._events[type]];\n  else\n    ret = this._events[type].slice();\n  return ret;\n};\n\nEventEmitter.prototype.listenerCount = function(type) {\n  if (this._events) {\n    var evlistener = this._events[type];\n\n    if (isFunction(evlistener))\n      return 1;\n    else if (evlistener)\n      return evlistener.length;\n  }\n  return 0;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  return emitter.listenerCount(type);\n};\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\n\n},{}],3:[function(_dereq_,module,exports){\n// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n},{}],4:[function(_dereq_,module,exports){\nvar bundleFn = arguments[3];\nvar sources = arguments[4];\nvar cache = arguments[5];\n\nvar stringify = JSON.stringify;\n\nmodule.exports = function (fn, options) {\n    var wkey;\n    var cacheKeys = Object.keys(cache);\n\n    for (var i = 0, l = cacheKeys.length; i < l; i++) {\n        var key = cacheKeys[i];\n        var exp = cache[key].exports;\n        // Using babel as a transpiler to use esmodule, the export will always\n        // be an object with the default export as a property of it. To ensure\n        // the existing api and babel esmodule exports are both supported we\n        // check for both\n        if (exp === fn || exp && exp.default === fn) {\n            wkey = key;\n            break;\n        }\n    }\n\n    if (!wkey) {\n        wkey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n        var wcache = {};\n        for (var i = 0, l = cacheKeys.length; i < l; i++) {\n            var key = cacheKeys[i];\n            wcache[key] = key;\n        }\n        sources[wkey] = [\n            'function(require,module,exports){' + fn + '(self); }',\n            wcache\n        ];\n    }\n    var skey = Math.floor(Math.pow(16, 8) * Math.random()).toString(16);\n\n    var scache = {}; scache[wkey] = wkey;\n    sources[skey] = [\n        'function(require,module,exports){' +\n            // try to call default if defined to also support babel esmodule exports\n            'var f = require(' + stringify(wkey) + ');' +\n            '(f.default ? f.default : f)(self);' +\n        '}',\n        scache\n    ];\n\n    var workerSources = {};\n    resolveSources(skey);\n\n    function resolveSources(key) {\n        workerSources[key] = true;\n\n        for (var depPath in sources[key][1]) {\n            var depKey = sources[key][1][depPath];\n            if (!workerSources[depKey]) {\n                resolveSources(depKey);\n            }\n        }\n    }\n\n    var src = '(' + bundleFn + ')({'\n        + Object.keys(workerSources).map(function (key) {\n            return stringify(key) + ':['\n                + sources[key][0]\n                + ',' + stringify(sources[key][1]) + ']'\n            ;\n        }).join(',')\n        + '},{},[' + stringify(skey) + '])'\n    ;\n\n    var URL = window.URL || window.webkitURL || window.mozURL || window.msURL;\n\n    var blob = new Blob([src], { type: 'text/javascript' });\n    if (options && options.bare) { return blob; }\n    var workerUrl = URL.createObjectURL(blob);\n    var worker = new Worker(workerUrl);\n    worker.objectURL = workerUrl;\n    return worker;\n};\n\n},{}],5:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.createDefaultConfig = createDefaultConfig;\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar defaultConfig = exports.defaultConfig = {\n    enableWorker: false,\n    enableStashBuffer: true,\n    stashInitialSize: undefined,\n\n    isLive: false,\n\n    lazyLoad: true,\n    lazyLoadMaxDuration: 3 * 60,\n    lazyLoadRecoverDuration: 30,\n    deferLoadAfterSourceOpen: true,\n\n    // autoCleanupSourceBuffer: default as false, leave unspecified\n    autoCleanupMaxBackwardDuration: 3 * 60,\n    autoCleanupMinBackwardDuration: 2 * 60,\n\n    statisticsInfoReportInterval: 600,\n\n    fixAudioTimestampGap: true,\n\n    accurateSeek: false,\n    seekType: 'range', // [range, param, custom]\n    seekParamStart: 'bstart',\n    seekParamEnd: 'bend',\n    rangeLoadZeroStart: false,\n    customSeekHandler: undefined,\n    reuseRedirectedURL: false,\n    // referrerPolicy: leave as unspecified\n\n    headers: undefined,\n    customLoader: undefined\n};\n\nfunction createDefaultConfig() {\n    return Object.assign({}, defaultConfig);\n}\n\n},{}],6:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _ioController = _dereq_('../io/io-controller.js');\n\nvar _ioController2 = _interopRequireDefault(_ioController);\n\nvar _config = _dereq_('../config.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Features = function () {\n    function Features() {\n        _classCallCheck(this, Features);\n    }\n\n    _createClass(Features, null, [{\n        key: 'supportMSEH264Playback',\n        value: function supportMSEH264Playback() {\n            return window.MediaSource && window.MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"');\n        }\n    }, {\n        key: 'supportNetworkStreamIO',\n        value: function supportNetworkStreamIO() {\n            var ioctl = new _ioController2.default({}, (0, _config.createDefaultConfig)());\n            var loaderType = ioctl.loaderType;\n            ioctl.destroy();\n            return loaderType == 'fetch-stream-loader' || loaderType == 'xhr-moz-chunked-loader';\n        }\n    }, {\n        key: 'getNetworkLoaderTypeName',\n        value: function getNetworkLoaderTypeName() {\n            var ioctl = new _ioController2.default({}, (0, _config.createDefaultConfig)());\n            var loaderType = ioctl.loaderType;\n            ioctl.destroy();\n            return loaderType;\n        }\n    }, {\n        key: 'supportNativeMediaPlayback',\n        value: function supportNativeMediaPlayback(mimeType) {\n            if (Features.videoElement == undefined) {\n                Features.videoElement = window.document.createElement('video');\n            }\n            var canPlay = Features.videoElement.canPlayType(mimeType);\n            return canPlay === 'probably' || canPlay == 'maybe';\n        }\n    }, {\n        key: 'getFeatureList',\n        value: function getFeatureList() {\n            var features = {\n                mseFlvPlayback: false,\n                mseLiveFlvPlayback: false,\n                networkStreamIO: false,\n                networkLoaderName: '',\n                nativeMP4H264Playback: false,\n                nativeWebmVP8Playback: false,\n                nativeWebmVP9Playback: false\n            };\n\n            features.mseFlvPlayback = Features.supportMSEH264Playback();\n            features.networkStreamIO = Features.supportNetworkStreamIO();\n            features.networkLoaderName = Features.getNetworkLoaderTypeName();\n            features.mseLiveFlvPlayback = features.mseFlvPlayback && features.networkStreamIO;\n            features.nativeMP4H264Playback = Features.supportNativeMediaPlayback('video/mp4; codecs=\"avc1.42001E, mp4a.40.2\"');\n            features.nativeWebmVP8Playback = Features.supportNativeMediaPlayback('video/webm; codecs=\"vp8.0, vorbis\"');\n            features.nativeWebmVP9Playback = Features.supportNativeMediaPlayback('video/webm; codecs=\"vp9\"');\n\n            return features;\n        }\n    }]);\n\n    return Features;\n}();\n\nexports.default = Features;\n\n},{\"../config.js\":5,\"../io/io-controller.js\":23}],7:[function(_dereq_,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar MediaInfo = function () {\n    function MediaInfo() {\n        _classCallCheck(this, MediaInfo);\n\n        this.mimeType = null;\n        this.duration = null;\n\n        this.hasAudio = null;\n        this.hasVideo = null;\n        this.audioCodec = null;\n        this.videoCodec = null;\n        this.audioDataRate = null;\n        this.videoDataRate = null;\n\n        this.audioSampleRate = null;\n        this.audioChannelCount = null;\n\n        this.width = null;\n        this.height = null;\n        this.fps = null;\n        this.profile = null;\n        this.level = null;\n        this.refFrames = null;\n        this.chromaFormat = null;\n        this.sarNum = null;\n        this.sarDen = null;\n\n        this.metadata = null;\n        this.segments = null; // MediaInfo[]\n        this.segmentCount = null;\n        this.hasKeyframesIndex = null;\n        this.keyframesIndex = null;\n    }\n\n    _createClass(MediaInfo, [{\n        key: \"isComplete\",\n        value: function isComplete() {\n            var audioInfoComplete = this.hasAudio === false || this.hasAudio === true && this.audioCodec != null && this.audioSampleRate != null && this.audioChannelCount != null;\n\n            var videoInfoComplete = this.hasVideo === false || this.hasVideo === true && this.videoCodec != null && this.width != null && this.height != null && this.fps != null && this.profile != null && this.level != null && this.refFrames != null && this.chromaFormat != null && this.sarNum != null && this.sarDen != null;\n\n            // keyframesIndex may not be present\n            return this.mimeType != null && this.duration != null && this.metadata != null && this.hasKeyframesIndex != null && audioInfoComplete && videoInfoComplete;\n        }\n    }, {\n        key: \"isSeekable\",\n        value: function isSeekable() {\n            return this.hasKeyframesIndex === true;\n        }\n    }, {\n        key: \"getNearestKeyframe\",\n        value: function getNearestKeyframe(milliseconds) {\n            if (this.keyframesIndex == null) {\n                return null;\n            }\n\n            var table = this.keyframesIndex;\n            var keyframeIdx = this._search(table.times, milliseconds);\n\n            return {\n                index: keyframeIdx,\n                milliseconds: table.times[keyframeIdx],\n                fileposition: table.filepositions[keyframeIdx]\n            };\n        }\n    }, {\n        key: \"_search\",\n        value: function _search(list, value) {\n            var idx = 0;\n\n            var last = list.length - 1;\n            var mid = 0;\n            var lbound = 0;\n            var ubound = last;\n\n            if (value < list[0]) {\n                idx = 0;\n                lbound = ubound + 1; // skip search\n            }\n\n            while (lbound <= ubound) {\n                mid = lbound + Math.floor((ubound - lbound) / 2);\n                if (mid === last || value >= list[mid] && value < list[mid + 1]) {\n                    idx = mid;\n                    break;\n                } else if (list[mid] < value) {\n                    lbound = mid + 1;\n                } else {\n                    ubound = mid - 1;\n                }\n            }\n\n            return idx;\n        }\n    }]);\n\n    return MediaInfo;\n}();\n\nexports.default = MediaInfo;\n\n},{}],8:[function(_dereq_,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n// Represents an media sample (audio / video)\nvar SampleInfo = exports.SampleInfo = function SampleInfo(dts, pts, duration, originalDts, isSync) {\n    _classCallCheck(this, SampleInfo);\n\n    this.dts = dts;\n    this.pts = pts;\n    this.duration = duration;\n    this.originalDts = originalDts;\n    this.isSyncPoint = isSync;\n    this.fileposition = null;\n};\n\n// Media Segment concept is defined in Media Source Extensions spec.\n// Particularly in ISO BMFF format, an Media Segment contains a moof box followed by a mdat box.\n\n\nvar MediaSegmentInfo = exports.MediaSegmentInfo = function () {\n    function MediaSegmentInfo() {\n        _classCallCheck(this, MediaSegmentInfo);\n\n        this.beginDts = 0;\n        this.endDts = 0;\n        this.beginPts = 0;\n        this.endPts = 0;\n        this.originalBeginDts = 0;\n        this.originalEndDts = 0;\n        this.syncPoints = []; // SampleInfo[n], for video IDR frames only\n        this.firstSample = null; // SampleInfo\n        this.lastSample = null; // SampleInfo\n    }\n\n    _createClass(MediaSegmentInfo, [{\n        key: \"appendSyncPoint\",\n        value: function appendSyncPoint(sampleInfo) {\n            // also called Random Access Point\n            sampleInfo.isSyncPoint = true;\n            this.syncPoints.push(sampleInfo);\n        }\n    }]);\n\n    return MediaSegmentInfo;\n}();\n\n// Ordered list for recording video IDR frames, sorted by originalDts\n\n\nvar IDRSampleList = exports.IDRSampleList = function () {\n    function IDRSampleList() {\n        _classCallCheck(this, IDRSampleList);\n\n        this._list = [];\n    }\n\n    _createClass(IDRSampleList, [{\n        key: \"clear\",\n        value: function clear() {\n            this._list = [];\n        }\n    }, {\n        key: \"appendArray\",\n        value: function appendArray(syncPoints) {\n            var list = this._list;\n\n            if (syncPoints.length === 0) {\n                return;\n            }\n\n            if (list.length > 0 && syncPoints[0].originalDts < list[list.length - 1].originalDts) {\n                this.clear();\n            }\n\n            Array.prototype.push.apply(list, syncPoints);\n        }\n    }, {\n        key: \"getLastSyncPointBeforeDts\",\n        value: function getLastSyncPointBeforeDts(dts) {\n            if (this._list.length == 0) {\n                return null;\n            }\n\n            var list = this._list;\n            var idx = 0;\n            var last = list.length - 1;\n            var mid = 0;\n            var lbound = 0;\n            var ubound = last;\n\n            if (dts < list[0].dts) {\n                idx = 0;\n                lbound = ubound + 1;\n            }\n\n            while (lbound <= ubound) {\n                mid = lbound + Math.floor((ubound - lbound) / 2);\n                if (mid === last || dts >= list[mid].dts && dts < list[mid + 1].dts) {\n                    idx = mid;\n                    break;\n                } else if (list[mid].dts < dts) {\n                    lbound = mid + 1;\n                } else {\n                    ubound = mid - 1;\n                }\n            }\n            return this._list[idx];\n        }\n    }]);\n\n    return IDRSampleList;\n}();\n\n// Data structure for recording information of media segments in single track.\n\n\nvar MediaSegmentInfoList = exports.MediaSegmentInfoList = function () {\n    function MediaSegmentInfoList(type) {\n        _classCallCheck(this, MediaSegmentInfoList);\n\n        this._type = type;\n        this._list = [];\n        this._lastAppendLocation = -1; // cached last insert location\n    }\n\n    _createClass(MediaSegmentInfoList, [{\n        key: \"isEmpty\",\n        value: function isEmpty() {\n            return this._list.length === 0;\n        }\n    }, {\n        key: \"clear\",\n        value: function clear() {\n            this._list = [];\n            this._lastAppendLocation = -1;\n        }\n    }, {\n        key: \"_searchNearestSegmentBefore\",\n        value: function _searchNearestSegmentBefore(originalBeginDts) {\n            var list = this._list;\n            if (list.length === 0) {\n                return -2;\n            }\n            var last = list.length - 1;\n            var mid = 0;\n            var lbound = 0;\n            var ubound = last;\n\n            var idx = 0;\n\n            if (originalBeginDts < list[0].originalBeginDts) {\n                idx = -1;\n                return idx;\n            }\n\n            while (lbound <= ubound) {\n                mid = lbound + Math.floor((ubound - lbound) / 2);\n                if (mid === last || originalBeginDts > list[mid].lastSample.originalDts && originalBeginDts < list[mid + 1].originalBeginDts) {\n                    idx = mid;\n                    break;\n                } else if (list[mid].originalBeginDts < originalBeginDts) {\n                    lbound = mid + 1;\n                } else {\n                    ubound = mid - 1;\n                }\n            }\n            return idx;\n        }\n    }, {\n        key: \"_searchNearestSegmentAfter\",\n        value: function _searchNearestSegmentAfter(originalBeginDts) {\n            return this._searchNearestSegmentBefore(originalBeginDts) + 1;\n        }\n    }, {\n        key: \"append\",\n        value: function append(mediaSegmentInfo) {\n            var list = this._list;\n            var msi = mediaSegmentInfo;\n            var lastAppendIdx = this._lastAppendLocation;\n            var insertIdx = 0;\n\n            if (lastAppendIdx !== -1 && lastAppendIdx < list.length && msi.originalBeginDts >= list[lastAppendIdx].lastSample.originalDts && (lastAppendIdx === list.length - 1 || lastAppendIdx < list.length - 1 && msi.originalBeginDts < list[lastAppendIdx + 1].originalBeginDts)) {\n                insertIdx = lastAppendIdx + 1; // use cached location idx\n            } else {\n                if (list.length > 0) {\n                    insertIdx = this._searchNearestSegmentBefore(msi.originalBeginDts) + 1;\n                }\n            }\n\n            this._lastAppendLocation = insertIdx;\n            this._list.splice(insertIdx, 0, msi);\n        }\n    }, {\n        key: \"getLastSegmentBefore\",\n        value: function getLastSegmentBefore(originalBeginDts) {\n            var idx = this._searchNearestSegmentBefore(originalBeginDts);\n            if (idx >= 0) {\n                return this._list[idx];\n            } else {\n                // -1\n                return null;\n            }\n        }\n    }, {\n        key: \"getLastSampleBefore\",\n        value: function getLastSampleBefore(originalBeginDts) {\n            var segment = this.getLastSegmentBefore(originalBeginDts);\n            if (segment != null) {\n                return segment.lastSample;\n            } else {\n                return null;\n            }\n        }\n    }, {\n        key: \"getLastSyncPointBefore\",\n        value: function getLastSyncPointBefore(originalBeginDts) {\n            var segmentIdx = this._searchNearestSegmentBefore(originalBeginDts);\n            var syncPoints = this._list[segmentIdx].syncPoints;\n            while (syncPoints.length === 0 && segmentIdx > 0) {\n                segmentIdx--;\n                syncPoints = this._list[segmentIdx].syncPoints;\n            }\n            if (syncPoints.length > 0) {\n                return syncPoints[syncPoints.length - 1];\n            } else {\n                return null;\n            }\n        }\n    }, {\n        key: \"type\",\n        get: function get() {\n            return this._type;\n        }\n    }, {\n        key: \"length\",\n        get: function get() {\n            return this._list.length;\n        }\n    }]);\n\n    return MediaSegmentInfoList;\n}();\n\n},{}],9:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _browser = _dereq_('../utils/browser.js');\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _mseEvents = _dereq_('./mse-events.js');\n\nvar _mseEvents2 = _interopRequireDefault(_mseEvents);\n\nvar _mediaSegmentInfo = _dereq_('./media-segment-info.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Media Source Extensions controller\nvar MSEController = function () {\n    function MSEController(config) {\n        _classCallCheck(this, MSEController);\n\n        this.TAG = 'MSEController';\n\n        this._config = config;\n        this._emitter = new _events2.default();\n\n        if (this._config.isLive && this._config.autoCleanupSourceBuffer == undefined) {\n            // For live stream, do auto cleanup by default\n            this._config.autoCleanupSourceBuffer = true;\n        }\n\n        this.e = {\n            onSourceOpen: this._onSourceOpen.bind(this),\n            onSourceEnded: this._onSourceEnded.bind(this),\n            onSourceClose: this._onSourceClose.bind(this),\n            onSourceBufferError: this._onSourceBufferError.bind(this),\n            onSourceBufferUpdateEnd: this._onSourceBufferUpdateEnd.bind(this)\n        };\n\n        this._mediaSource = null;\n        this._mediaSourceObjectURL = null;\n        this._mediaElement = null;\n\n        this._isBufferFull = false;\n        this._hasPendingEos = false;\n\n        this._requireSetMediaDuration = false;\n        this._pendingMediaDuration = 0;\n\n        this._pendingSourceBufferInit = [];\n        this._mimeTypes = {\n            video: null,\n            audio: null\n        };\n        this._sourceBuffers = {\n            video: null,\n            audio: null\n        };\n        this._lastInitSegments = {\n            video: null,\n            audio: null\n        };\n        this._pendingSegments = {\n            video: [],\n            audio: []\n        };\n        this._pendingRemoveRanges = {\n            video: [],\n            audio: []\n        };\n        this._idrList = new _mediaSegmentInfo.IDRSampleList();\n    }\n\n    _createClass(MSEController, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._mediaElement || this._mediaSource) {\n                this.detachMediaElement();\n            }\n            this.e = null;\n            this._emitter.removeAllListeners();\n            this._emitter = null;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, listener) {\n            this._emitter.addListener(event, listener);\n        }\n    }, {\n        key: 'off',\n        value: function off(event, listener) {\n            this._emitter.removeListener(event, listener);\n        }\n    }, {\n        key: 'attachMediaElement',\n        value: function attachMediaElement(mediaElement) {\n            if (this._mediaSource) {\n                throw new _exception.IllegalStateException('MediaSource has been attached to an HTMLMediaElement!');\n            }\n            var ms = this._mediaSource = new window.MediaSource();\n            ms.addEventListener('sourceopen', this.e.onSourceOpen);\n            ms.addEventListener('sourceended', this.e.onSourceEnded);\n            ms.addEventListener('sourceclose', this.e.onSourceClose);\n\n            this._mediaElement = mediaElement;\n            this._mediaSourceObjectURL = window.URL.createObjectURL(this._mediaSource);\n            mediaElement.src = this._mediaSourceObjectURL;\n        }\n    }, {\n        key: 'detachMediaElement',\n        value: function detachMediaElement() {\n            if (this._mediaSource) {\n                var ms = this._mediaSource;\n                for (var type in this._sourceBuffers) {\n                    // pending segments should be discard\n                    var ps = this._pendingSegments[type];\n                    ps.splice(0, ps.length);\n                    this._pendingSegments[type] = null;\n                    this._pendingRemoveRanges[type] = null;\n                    this._lastInitSegments[type] = null;\n\n                    // remove all sourcebuffers\n                    var sb = this._sourceBuffers[type];\n                    if (sb) {\n                        if (ms.readyState !== 'closed') {\n                            // ms edge can throw an error: Unexpected call to method or property access\n                            try {\n                                ms.removeSourceBuffer(sb);\n                            } catch (error) {\n                                _logger2.default.e(this.TAG, error.message);\n                            }\n                            sb.removeEventListener('error', this.e.onSourceBufferError);\n                            sb.removeEventListener('updateend', this.e.onSourceBufferUpdateEnd);\n                        }\n                        this._mimeTypes[type] = null;\n                        this._sourceBuffers[type] = null;\n                    }\n                }\n                if (ms.readyState === 'open') {\n                    try {\n                        ms.endOfStream();\n                    } catch (error) {\n                        _logger2.default.e(this.TAG, error.message);\n                    }\n                }\n                ms.removeEventListener('sourceopen', this.e.onSourceOpen);\n                ms.removeEventListener('sourceended', this.e.onSourceEnded);\n                ms.removeEventListener('sourceclose', this.e.onSourceClose);\n                this._pendingSourceBufferInit = [];\n                this._isBufferFull = false;\n                this._idrList.clear();\n                this._mediaSource = null;\n            }\n\n            if (this._mediaElement) {\n                this._mediaElement.src = '';\n                this._mediaElement.removeAttribute('src');\n                this._mediaElement = null;\n            }\n            if (this._mediaSourceObjectURL) {\n                window.URL.revokeObjectURL(this._mediaSourceObjectURL);\n                this._mediaSourceObjectURL = null;\n            }\n        }\n    }, {\n        key: 'appendInitSegment',\n        value: function appendInitSegment(initSegment, deferred) {\n            if (!this._mediaSource || this._mediaSource.readyState !== 'open') {\n                // sourcebuffer creation requires mediaSource.readyState === 'open'\n                // so we defer the sourcebuffer creation, until sourceopen event triggered\n                this._pendingSourceBufferInit.push(initSegment);\n                // make sure that this InitSegment is in the front of pending segments queue\n                this._pendingSegments[initSegment.type].push(initSegment);\n                return;\n            }\n\n            var is = initSegment;\n            var mimeType = '' + is.container;\n            if (is.codec && is.codec.length > 0) {\n                mimeType += ';codecs=' + is.codec;\n            }\n\n            var firstInitSegment = false;\n\n            _logger2.default.v(this.TAG, 'Received Initialization Segment, mimeType: ' + mimeType);\n            this._lastInitSegments[is.type] = is;\n\n            if (mimeType !== this._mimeTypes[is.type]) {\n                if (!this._mimeTypes[is.type]) {\n                    // empty, first chance create sourcebuffer\n                    firstInitSegment = true;\n                    try {\n                        var sb = this._sourceBuffers[is.type] = this._mediaSource.addSourceBuffer(mimeType);\n                        sb.addEventListener('error', this.e.onSourceBufferError);\n                        sb.addEventListener('updateend', this.e.onSourceBufferUpdateEnd);\n                    } catch (error) {\n                        _logger2.default.e(this.TAG, error.message);\n                        this._emitter.emit(_mseEvents2.default.ERROR, { code: error.code, msg: error.message });\n                        return;\n                    }\n                } else {\n                    _logger2.default.v(this.TAG, 'Notice: ' + is.type + ' mimeType changed, origin: ' + this._mimeTypes[is.type] + ', target: ' + mimeType);\n                }\n                this._mimeTypes[is.type] = mimeType;\n            }\n\n            if (!deferred) {\n                // deferred means this InitSegment has been pushed to pendingSegments queue\n                this._pendingSegments[is.type].push(is);\n            }\n            if (!firstInitSegment) {\n                // append immediately only if init segment in subsequence\n                if (this._sourceBuffers[is.type] && !this._sourceBuffers[is.type].updating) {\n                    this._doAppendSegments();\n                }\n            }\n            if (_browser2.default.safari && is.container === 'audio/mpeg' && is.mediaDuration > 0) {\n                // 'audio/mpeg' track under Safari may cause MediaElement's duration to be NaN\n                // Manually correct MediaSource.duration to make progress bar seekable, and report right duration\n                this._requireSetMediaDuration = true;\n                this._pendingMediaDuration = is.mediaDuration / 1000; // in seconds\n                this._updateMediaSourceDuration();\n            }\n        }\n    }, {\n        key: 'appendMediaSegment',\n        value: function appendMediaSegment(mediaSegment) {\n            var ms = mediaSegment;\n            this._pendingSegments[ms.type].push(ms);\n\n            if (this._config.autoCleanupSourceBuffer && this._needCleanupSourceBuffer()) {\n                this._doCleanupSourceBuffer();\n            }\n\n            var sb = this._sourceBuffers[ms.type];\n            if (sb && !sb.updating && !this._hasPendingRemoveRanges()) {\n                this._doAppendSegments();\n            }\n        }\n    }, {\n        key: 'seek',\n        value: function seek(seconds) {\n            // remove all appended buffers\n            for (var type in this._sourceBuffers) {\n                if (!this._sourceBuffers[type]) {\n                    continue;\n                }\n\n                // abort current buffer append algorithm\n                var sb = this._sourceBuffers[type];\n                if (this._mediaSource.readyState === 'open') {\n                    try {\n                        // If range removal algorithm is running, InvalidStateError will be throwed\n                        // Ignore it.\n                        sb.abort();\n                    } catch (error) {\n                        _logger2.default.e(this.TAG, error.message);\n                    }\n                }\n\n                // IDRList should be clear\n                this._idrList.clear();\n\n                // pending segments should be discard\n                var ps = this._pendingSegments[type];\n                ps.splice(0, ps.length);\n\n                if (this._mediaSource.readyState === 'closed') {\n                    // Parent MediaSource object has been detached from HTMLMediaElement\n                    continue;\n                }\n\n                // record ranges to be remove from SourceBuffer\n                for (var i = 0; i < sb.buffered.length; i++) {\n                    var start = sb.buffered.start(i);\n                    var end = sb.buffered.end(i);\n                    this._pendingRemoveRanges[type].push({ start: start, end: end });\n                }\n\n                // if sb is not updating, let's remove ranges now!\n                if (!sb.updating) {\n                    this._doRemoveRanges();\n                }\n\n                // Safari 10 may get InvalidStateError in the later appendBuffer() after SourceBuffer.remove() call\n                // Internal parser's state may be invalid at this time. Re-append last InitSegment to workaround.\n                // Related issue: https://bugs.webkit.org/show_bug.cgi?id=159230\n                if (_browser2.default.safari) {\n                    var lastInitSegment = this._lastInitSegments[type];\n                    if (lastInitSegment) {\n                        this._pendingSegments[type].push(lastInitSegment);\n                        if (!sb.updating) {\n                            this._doAppendSegments();\n                        }\n                    }\n                }\n            }\n        }\n    }, {\n        key: 'endOfStream',\n        value: function endOfStream() {\n            var ms = this._mediaSource;\n            var sb = this._sourceBuffers;\n            if (!ms || ms.readyState !== 'open') {\n                if (ms && ms.readyState === 'closed' && this._hasPendingSegments()) {\n                    // If MediaSource hasn't turned into open state, and there're pending segments\n                    // Mark pending endOfStream, defer call until all pending segments appended complete\n                    this._hasPendingEos = true;\n                }\n                return;\n            }\n            if (sb.video && sb.video.updating || sb.audio && sb.audio.updating) {\n                // If any sourcebuffer is updating, defer endOfStream operation\n                // See _onSourceBufferUpdateEnd()\n                this._hasPendingEos = true;\n            } else {\n                this._hasPendingEos = false;\n                // Notify media data loading complete\n                // This is helpful for correcting total duration to match last media segment\n                // Otherwise MediaElement's ended event may not be triggered\n                ms.endOfStream();\n            }\n        }\n    }, {\n        key: 'getNearestKeyframe',\n        value: function getNearestKeyframe(dts) {\n            return this._idrList.getLastSyncPointBeforeDts(dts);\n        }\n    }, {\n        key: '_needCleanupSourceBuffer',\n        value: function _needCleanupSourceBuffer() {\n            if (!this._config.autoCleanupSourceBuffer) {\n                return false;\n            }\n\n            var currentTime = this._mediaElement.currentTime;\n\n            for (var type in this._sourceBuffers) {\n                var sb = this._sourceBuffers[type];\n                if (sb) {\n                    var buffered = sb.buffered;\n                    if (buffered.length >= 1) {\n                        if (currentTime - buffered.start(0) >= this._config.autoCleanupMaxBackwardDuration) {\n                            return true;\n                        }\n                    }\n                }\n            }\n\n            return false;\n        }\n    }, {\n        key: '_doCleanupSourceBuffer',\n        value: function _doCleanupSourceBuffer() {\n            var currentTime = this._mediaElement.currentTime;\n\n            for (var type in this._sourceBuffers) {\n                var sb = this._sourceBuffers[type];\n                if (sb) {\n                    var buffered = sb.buffered;\n                    var doRemove = false;\n\n                    for (var i = 0; i < buffered.length; i++) {\n                        var start = buffered.start(i);\n                        var end = buffered.end(i);\n\n                        if (start <= currentTime && currentTime < end + 3) {\n                            // padding 3 seconds\n                            if (currentTime - start >= this._config.autoCleanupMaxBackwardDuration) {\n                                doRemove = true;\n                                var removeEnd = currentTime - this._config.autoCleanupMinBackwardDuration;\n                                this._pendingRemoveRanges[type].push({ start: start, end: removeEnd });\n                            }\n                        } else if (end < currentTime) {\n                            doRemove = true;\n                            this._pendingRemoveRanges[type].push({ start: start, end: end });\n                        }\n                    }\n\n                    if (doRemove && !sb.updating) {\n                        this._doRemoveRanges();\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_updateMediaSourceDuration',\n        value: function _updateMediaSourceDuration() {\n            var sb = this._sourceBuffers;\n            if (this._mediaElement.readyState === 0 || this._mediaSource.readyState !== 'open') {\n                return;\n            }\n            if (sb.video && sb.video.updating || sb.audio && sb.audio.updating) {\n                return;\n            }\n\n            var current = this._mediaSource.duration;\n            var target = this._pendingMediaDuration;\n\n            if (target > 0 && (isNaN(current) || target > current)) {\n                _logger2.default.v(this.TAG, 'Update MediaSource duration from ' + current + ' to ' + target);\n                this._mediaSource.duration = target;\n            }\n\n            this._requireSetMediaDuration = false;\n            this._pendingMediaDuration = 0;\n        }\n    }, {\n        key: '_doRemoveRanges',\n        value: function _doRemoveRanges() {\n            for (var type in this._pendingRemoveRanges) {\n                if (!this._sourceBuffers[type] || this._sourceBuffers[type].updating) {\n                    continue;\n                }\n                var sb = this._sourceBuffers[type];\n                var ranges = this._pendingRemoveRanges[type];\n                while (ranges.length && !sb.updating) {\n                    var range = ranges.shift();\n                    sb.remove(range.start, range.end);\n                }\n            }\n        }\n    }, {\n        key: '_doAppendSegments',\n        value: function _doAppendSegments() {\n            var pendingSegments = this._pendingSegments;\n\n            for (var type in pendingSegments) {\n                if (!this._sourceBuffers[type] || this._sourceBuffers[type].updating) {\n                    continue;\n                }\n\n                if (pendingSegments[type].length > 0) {\n                    var segment = pendingSegments[type].shift();\n\n                    if (segment.timestampOffset) {\n                        // For MPEG audio stream in MSE, if unbuffered-seeking occurred\n                        // We need explicitly set timestampOffset to the desired point in timeline for mpeg SourceBuffer.\n                        var currentOffset = this._sourceBuffers[type].timestampOffset;\n                        var targetOffset = segment.timestampOffset / 1000; // in seconds\n\n                        var delta = Math.abs(currentOffset - targetOffset);\n                        if (delta > 0.1) {\n                            // If time delta > 100ms\n                            _logger2.default.v(this.TAG, 'Update MPEG audio timestampOffset from ' + currentOffset + ' to ' + targetOffset);\n                            this._sourceBuffers[type].timestampOffset = targetOffset;\n                        }\n                        delete segment.timestampOffset;\n                    }\n\n                    if (!segment.data || segment.data.byteLength === 0) {\n                        // Ignore empty buffer\n                        continue;\n                    }\n\n                    try {\n                        this._sourceBuffers[type].appendBuffer(segment.data);\n                        this._isBufferFull = false;\n                        if (type === 'video' && segment.hasOwnProperty('info')) {\n                            this._idrList.appendArray(segment.info.syncPoints);\n                        }\n                    } catch (error) {\n                        this._pendingSegments[type].unshift(segment);\n                        if (error.code === 22) {\n                            // QuotaExceededError\n                            /* Notice that FireFox may not throw QuotaExceededError if SourceBuffer is full\r\n                             * Currently we can only do lazy-load to avoid SourceBuffer become scattered.\r\n                             * SourceBuffer eviction policy may be changed in future version of FireFox.\r\n                             *\r\n                             * Related issues:\r\n                             * https://bugzilla.mozilla.org/show_bug.cgi?id=1279885\r\n                             * https://bugzilla.mozilla.org/show_bug.cgi?id=1280023\r\n                             */\n\n                            // report buffer full, abort network IO\n                            if (!this._isBufferFull) {\n                                this._emitter.emit(_mseEvents2.default.BUFFER_FULL);\n                            }\n                            this._isBufferFull = true;\n                        } else {\n                            _logger2.default.e(this.TAG, error.message);\n                            this._emitter.emit(_mseEvents2.default.ERROR, { code: error.code, msg: error.message });\n                        }\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_onSourceOpen',\n        value: function _onSourceOpen() {\n            _logger2.default.v(this.TAG, 'MediaSource onSourceOpen');\n            this._mediaSource.removeEventListener('sourceopen', this.e.onSourceOpen);\n            // deferred sourcebuffer creation / initialization\n            if (this._pendingSourceBufferInit.length > 0) {\n                var pendings = this._pendingSourceBufferInit;\n                while (pendings.length) {\n                    var segment = pendings.shift();\n                    this.appendInitSegment(segment, true);\n                }\n            }\n            // there may be some pending media segments, append them\n            if (this._hasPendingSegments()) {\n                this._doAppendSegments();\n            }\n            this._emitter.emit(_mseEvents2.default.SOURCE_OPEN);\n        }\n    }, {\n        key: '_onSourceEnded',\n        value: function _onSourceEnded() {\n            // fired on endOfStream\n            _logger2.default.v(this.TAG, 'MediaSource onSourceEnded');\n            this._emitter.emit(_mseEvents2.default.SOURCE_END, 'MediaSource onSourceEnded');\n        }\n    }, {\n        key: '_onSourceClose',\n        value: function _onSourceClose() {\n            // fired on detaching from media element\n            _logger2.default.v(this.TAG, 'MediaSource onSourceClose');\n            if (this._mediaSource && this.e != null) {\n                this._mediaSource.removeEventListener('sourceopen', this.e.onSourceOpen);\n                this._mediaSource.removeEventListener('sourceended', this.e.onSourceEnded);\n                this._mediaSource.removeEventListener('sourceclose', this.e.onSourceClose);\n            }\n        }\n    }, {\n        key: '_hasPendingSegments',\n        value: function _hasPendingSegments() {\n            var ps = this._pendingSegments;\n            return ps.video.length > 0 || ps.audio.length > 0;\n        }\n    }, {\n        key: '_hasPendingRemoveRanges',\n        value: function _hasPendingRemoveRanges() {\n            var prr = this._pendingRemoveRanges;\n            return prr.video.length > 0 || prr.audio.length > 0;\n        }\n    }, {\n        key: '_onSourceBufferUpdateEnd',\n        value: function _onSourceBufferUpdateEnd() {\n            if (this._requireSetMediaDuration) {\n                this._updateMediaSourceDuration();\n            } else if (this._hasPendingRemoveRanges()) {\n                this._doRemoveRanges();\n            } else if (this._hasPendingSegments()) {\n                this._doAppendSegments();\n            } else if (this._hasPendingEos) {\n                this.endOfStream();\n            }\n            this._emitter.emit(_mseEvents2.default.UPDATE_END);\n        }\n    }, {\n        key: '_onSourceBufferError',\n        value: function _onSourceBufferError(e) {\n            _logger2.default.e(this.TAG, 'SourceBuffer Error: ' + e);\n            // this error might not always be fatal, just ignore it\n        }\n    }]);\n\n    return MSEController;\n}();\n\nexports.default = MSEController;\n\n},{\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./media-segment-info.js\":8,\"./mse-events.js\":10,\"events\":2}],10:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar MSEEvents = {\n  ERROR: 'error',\n  SOURCE_OPEN: 'source_open',\n  UPDATE_END: 'update_end',\n  BUFFER_FULL: 'buffer_full',\n  SOURCE_END: 'source_end'\n};\n\nexports.default = MSEEvents;\n\n},{}],11:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _loggingControl = _dereq_('../utils/logging-control.js');\n\nvar _loggingControl2 = _interopRequireDefault(_loggingControl);\n\nvar _transmuxingController = _dereq_('./transmuxing-controller.js');\n\nvar _transmuxingController2 = _interopRequireDefault(_transmuxingController);\n\nvar _transmuxingEvents = _dereq_('./transmuxing-events.js');\n\nvar _transmuxingEvents2 = _interopRequireDefault(_transmuxingEvents);\n\nvar _transmuxingWorker = _dereq_('./transmuxing-worker.js');\n\nvar _transmuxingWorker2 = _interopRequireDefault(_transmuxingWorker);\n\nvar _mediaInfo = _dereq_('./media-info.js');\n\nvar _mediaInfo2 = _interopRequireDefault(_mediaInfo);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Transmuxer = function () {\n    function Transmuxer(mediaDataSource, config) {\n        _classCallCheck(this, Transmuxer);\n\n        this.TAG = 'Transmuxer';\n        this._emitter = new _events2.default();\n\n        if (config.enableWorker && typeof Worker !== 'undefined') {\n            try {\n                var work = _dereq_('webworkify');\n                this._worker = work(_transmuxingWorker2.default);\n                this._workerDestroying = false;\n                this._worker.addEventListener('message', this._onWorkerMessage.bind(this));\n                this._worker.postMessage({ cmd: 'init', param: [mediaDataSource, config] });\n                this.e = {\n                    onLoggingConfigChanged: this._onLoggingConfigChanged.bind(this)\n                };\n                _loggingControl2.default.registerListener(this.e.onLoggingConfigChanged);\n                this._worker.postMessage({ cmd: 'logging_config', param: _loggingControl2.default.getConfig() });\n            } catch (error) {\n                _logger2.default.e(this.TAG, 'Error while initialize transmuxing worker, fallback to inline transmuxing');\n                this._worker = null;\n                this._controller = new _transmuxingController2.default(mediaDataSource, config);\n            }\n        } else {\n            this._controller = new _transmuxingController2.default(mediaDataSource, config);\n        }\n\n        if (this._controller) {\n            var ctl = this._controller;\n            ctl.on(_transmuxingEvents2.default.IO_ERROR, this._onIOError.bind(this));\n            ctl.on(_transmuxingEvents2.default.DEMUX_ERROR, this._onDemuxError.bind(this));\n            ctl.on(_transmuxingEvents2.default.INIT_SEGMENT, this._onInitSegment.bind(this));\n            ctl.on(_transmuxingEvents2.default.MEDIA_SEGMENT, this._onMediaSegment.bind(this));\n            ctl.on(_transmuxingEvents2.default.LOADING_COMPLETE, this._onLoadingComplete.bind(this));\n            ctl.on(_transmuxingEvents2.default.RECOVERED_EARLY_EOF, this._onRecoveredEarlyEof.bind(this));\n            ctl.on(_transmuxingEvents2.default.MEDIA_INFO, this._onMediaInfo.bind(this));\n            ctl.on(_transmuxingEvents2.default.METADATA_ARRIVED, this._onMetaDataArrived.bind(this));\n            ctl.on(_transmuxingEvents2.default.SCRIPTDATA_ARRIVED, this._onScriptDataArrived.bind(this));\n            ctl.on(_transmuxingEvents2.default.STATISTICS_INFO, this._onStatisticsInfo.bind(this));\n            ctl.on(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, this._onRecommendSeekpoint.bind(this));\n            ctl.on(_transmuxingEvents2.default.STREAM_TIME, this._onStreamTime.bind(this));\n        }\n    }\n\n    _createClass(Transmuxer, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._worker) {\n                if (!this._workerDestroying) {\n                    this._workerDestroying = true;\n                    this._worker.postMessage({ cmd: 'destroy' });\n                    _loggingControl2.default.removeListener(this.e.onLoggingConfigChanged);\n                    this.e = null;\n                }\n            } else {\n                this._controller.destroy();\n                this._controller = null;\n            }\n            this._emitter.removeAllListeners();\n            this._emitter = null;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, listener) {\n            this._emitter.addListener(event, listener);\n        }\n    }, {\n        key: 'off',\n        value: function off(event, listener) {\n            this._emitter.removeListener(event, listener);\n        }\n    }, {\n        key: 'hasWorker',\n        value: function hasWorker() {\n            return this._worker != null;\n        }\n    }, {\n        key: 'open',\n        value: function open() {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'start' });\n            } else {\n                this._controller.start();\n            }\n        }\n    }, {\n        key: 'close',\n        value: function close() {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'stop' });\n            } else {\n                this._controller.stop();\n            }\n        }\n    }, {\n        key: 'seek',\n        value: function seek(milliseconds) {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'seek', param: milliseconds });\n            } else {\n                this._controller.seek(milliseconds);\n            }\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'pause' });\n            } else {\n                this._controller.pause();\n            }\n        }\n    }, {\n        key: 'resume',\n        value: function resume() {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'resume' });\n            } else {\n                this._controller.resume();\n            }\n        }\n    }, {\n        key: '_onInitSegment',\n        value: function _onInitSegment(type, initSegment) {\n            var _this = this;\n\n            // do async invoke\n            Promise.resolve().then(function () {\n                _this._emitter.emit(_transmuxingEvents2.default.INIT_SEGMENT, type, initSegment);\n            });\n        }\n    }, {\n        key: '_onMediaSegment',\n        value: function _onMediaSegment(type, mediaSegment) {\n            var _this2 = this;\n\n            Promise.resolve().then(function () {\n                _this2._emitter.emit(_transmuxingEvents2.default.MEDIA_SEGMENT, type, mediaSegment);\n            });\n        }\n    }, {\n        key: '_onLoadingComplete',\n        value: function _onLoadingComplete() {\n            var _this3 = this;\n\n            Promise.resolve().then(function () {\n                _this3._emitter.emit(_transmuxingEvents2.default.LOADING_COMPLETE);\n            });\n        }\n    }, {\n        key: '_onRecoveredEarlyEof',\n        value: function _onRecoveredEarlyEof() {\n            var _this4 = this;\n\n            Promise.resolve().then(function () {\n                _this4._emitter.emit(_transmuxingEvents2.default.RECOVERED_EARLY_EOF);\n            });\n        }\n    }, {\n        key: '_onMediaInfo',\n        value: function _onMediaInfo(mediaInfo) {\n            var _this5 = this;\n\n            Promise.resolve().then(function () {\n                _this5._emitter.emit(_transmuxingEvents2.default.MEDIA_INFO, mediaInfo);\n            });\n        }\n    }, {\n        key: '_onMetaDataArrived',\n        value: function _onMetaDataArrived(metadata) {\n            var _this6 = this;\n\n            Promise.resolve().then(function () {\n                _this6._emitter.emit(_transmuxingEvents2.default.METADATA_ARRIVED, metadata);\n            });\n        }\n    }, {\n        key: '_onScriptDataArrived',\n        value: function _onScriptDataArrived(data) {\n            var _this7 = this;\n\n            Promise.resolve().then(function () {\n                _this7._emitter.emit(_transmuxingEvents2.default.SCRIPTDATA_ARRIVED, data);\n            });\n        }\n    }, {\n        key: '_onStatisticsInfo',\n        value: function _onStatisticsInfo(statisticsInfo) {\n            var _this8 = this;\n\n            Promise.resolve().then(function () {\n                _this8._emitter.emit(_transmuxingEvents2.default.STATISTICS_INFO, statisticsInfo);\n            });\n        }\n    }, {\n        key: '_onIOError',\n        value: function _onIOError(type, info) {\n            var _this9 = this;\n\n            Promise.resolve().then(function () {\n                _this9._emitter.emit(_transmuxingEvents2.default.IO_ERROR, type, info);\n            });\n        }\n    }, {\n        key: '_onDemuxError',\n        value: function _onDemuxError(type, info) {\n            var _this10 = this;\n\n            Promise.resolve().then(function () {\n                _this10._emitter.emit(_transmuxingEvents2.default.DEMUX_ERROR, type, info);\n            });\n        }\n    }, {\n        key: '_onRecommendSeekpoint',\n        value: function _onRecommendSeekpoint(milliseconds) {\n            var _this11 = this;\n\n            Promise.resolve().then(function () {\n                _this11._emitter.emit(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, milliseconds);\n            });\n        }\n    }, {\n        key: '_onStreamTime',\n        value: function _onStreamTime(time) {\n            var _this12 = this;\n\n            Promise.resolve().then(function () {\n                _this12._emitter.emit(_transmuxingEvents2.default.STREAM_TIME, time);\n            });\n        }\n    }, {\n        key: '_onLoggingConfigChanged',\n        value: function _onLoggingConfigChanged(config) {\n            if (this._worker) {\n                this._worker.postMessage({ cmd: 'logging_config', param: config });\n            }\n        }\n    }, {\n        key: '_onWorkerMessage',\n        value: function _onWorkerMessage(e) {\n            var message = e.data;\n            var data = message.data;\n\n            if (message.msg === 'destroyed' || this._workerDestroying) {\n                this._workerDestroying = false;\n                this._worker.terminate();\n                this._worker = null;\n                return;\n            }\n\n            switch (message.msg) {\n                case _transmuxingEvents2.default.INIT_SEGMENT:\n                case _transmuxingEvents2.default.MEDIA_SEGMENT:\n                    this._emitter.emit(message.msg, data.type, data.data);\n                    break;\n                case _transmuxingEvents2.default.LOADING_COMPLETE:\n                case _transmuxingEvents2.default.RECOVERED_EARLY_EOF:\n                    this._emitter.emit(message.msg);\n                    break;\n                case _transmuxingEvents2.default.MEDIA_INFO:\n                    Object.setPrototypeOf(data, _mediaInfo2.default.prototype);\n                    this._emitter.emit(message.msg, data);\n                    break;\n                case _transmuxingEvents2.default.METADATA_ARRIVED:\n                case _transmuxingEvents2.default.SCRIPTDATA_ARRIVED:\n                case _transmuxingEvents2.default.STATISTICS_INFO:\n                    this._emitter.emit(message.msg, data);\n                    break;\n                case _transmuxingEvents2.default.IO_ERROR:\n                case _transmuxingEvents2.default.DEMUX_ERROR:\n                    this._emitter.emit(message.msg, data.type, data.info);\n                    break;\n                case _transmuxingEvents2.default.RECOMMEND_SEEKPOINT:\n                    this._emitter.emit(message.msg, data);\n                    break;\n                case 'logcat_callback':\n                    _logger2.default.emitter.emit('log', data.type, data.logcat);\n                    break;\n                default:\n                    break;\n            }\n        }\n    }]);\n\n    return Transmuxer;\n}();\n\nexports.default = Transmuxer;\n\n},{\"../utils/logger.js\":41,\"../utils/logging-control.js\":42,\"./media-info.js\":7,\"./transmuxing-controller.js\":12,\"./transmuxing-events.js\":13,\"./transmuxing-worker.js\":14,\"events\":2,\"webworkify\":4}],12:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _browser = _dereq_('../utils/browser.js');\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _mediaInfo = _dereq_('./media-info.js');\n\nvar _mediaInfo2 = _interopRequireDefault(_mediaInfo);\n\nvar _flvDemuxer = _dereq_('../demux/flv-demuxer.js');\n\nvar _flvDemuxer2 = _interopRequireDefault(_flvDemuxer);\n\nvar _mp4Remuxer = _dereq_('../remux/mp4-remuxer.js');\n\nvar _mp4Remuxer2 = _interopRequireDefault(_mp4Remuxer);\n\nvar _demuxErrors = _dereq_('../demux/demux-errors.js');\n\nvar _demuxErrors2 = _interopRequireDefault(_demuxErrors);\n\nvar _ioController = _dereq_('../io/io-controller.js');\n\nvar _ioController2 = _interopRequireDefault(_ioController);\n\nvar _transmuxingEvents = _dereq_('./transmuxing-events.js');\n\nvar _transmuxingEvents2 = _interopRequireDefault(_transmuxingEvents);\n\nvar _loader = _dereq_('../io/loader.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Transmuxing (IO, Demuxing, Remuxing) controller, with multipart support\nvar TransmuxingController = function () {\n    function TransmuxingController(mediaDataSource, config) {\n        _classCallCheck(this, TransmuxingController);\n\n        this.TAG = 'TransmuxingController';\n        this._emitter = new _events2.default();\n\n        this._config = config;\n\n        // treat single part media as multipart media, which has only one segment\n        if (!mediaDataSource.segments) {\n            mediaDataSource.segments = [{\n                duration: mediaDataSource.duration,\n                filesize: mediaDataSource.filesize,\n                url: mediaDataSource.url\n            }];\n        }\n\n        // fill in default IO params if not exists\n        if (typeof mediaDataSource.cors !== 'boolean') {\n            mediaDataSource.cors = true;\n        }\n        if (typeof mediaDataSource.withCredentials !== 'boolean') {\n            mediaDataSource.withCredentials = false;\n        }\n\n        this._mediaDataSource = mediaDataSource;\n        this._currentSegmentIndex = 0;\n        var totalDuration = 0;\n\n        this._mediaDataSource.segments.forEach(function (segment) {\n            // timestampBase for each segment, and calculate total duration\n            segment.timestampBase = totalDuration;\n            totalDuration += segment.duration;\n            // params needed by IOController\n            segment.cors = mediaDataSource.cors;\n            segment.withCredentials = mediaDataSource.withCredentials;\n            // referrer policy control, if exist\n            if (config.referrerPolicy) {\n                segment.referrerPolicy = config.referrerPolicy;\n            }\n        });\n\n        if (!isNaN(totalDuration) && this._mediaDataSource.duration !== totalDuration) {\n            this._mediaDataSource.duration = totalDuration;\n        }\n\n        this._mediaInfo = null;\n        this._demuxer = null;\n        this._remuxer = null;\n        this._ioctl = null;\n\n        this._pendingSeekTime = null;\n        this._pendingResolveSeekPoint = null;\n\n        this._statisticsReporter = null;\n    }\n\n    _createClass(TransmuxingController, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._mediaInfo = null;\n            this._mediaDataSource = null;\n\n            if (this._statisticsReporter) {\n                this._disableStatisticsReporter();\n            }\n            if (this._ioctl) {\n                this._ioctl.destroy();\n                this._ioctl = null;\n            }\n            if (this._demuxer) {\n                this._demuxer.destroy();\n                this._demuxer = null;\n            }\n            if (this._remuxer) {\n                this._remuxer.destroy();\n                this._remuxer = null;\n            }\n\n            this._emitter.removeAllListeners();\n            this._emitter = null;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, listener) {\n            this._emitter.addListener(event, listener);\n        }\n    }, {\n        key: 'off',\n        value: function off(event, listener) {\n            this._emitter.removeListener(event, listener);\n        }\n    }, {\n        key: 'start',\n        value: function start() {\n            this._loadSegment(0);\n            this._enableStatisticsReporter();\n        }\n    }, {\n        key: '_loadSegment',\n        value: function _loadSegment(segmentIndex, optionalFrom) {\n            this._currentSegmentIndex = segmentIndex;\n            var dataSource = this._mediaDataSource.segments[segmentIndex];\n\n            var ioctl = this._ioctl = new _ioController2.default(dataSource, this._config, segmentIndex);\n            ioctl.onError = this._onIOException.bind(this);\n            ioctl.onSeeked = this._onIOSeeked.bind(this);\n            ioctl.onComplete = this._onIOComplete.bind(this);\n            ioctl.onRedirect = this._onIORedirect.bind(this);\n            ioctl.onRecoveredEarlyEof = this._onIORecoveredEarlyEof.bind(this);\n\n            if (optionalFrom) {\n                this._demuxer.bindDataSource(this._ioctl);\n            } else {\n                ioctl.onDataArrival = this._onInitChunkArrival.bind(this);\n            }\n\n            ioctl.open(optionalFrom);\n        }\n    }, {\n        key: 'stop',\n        value: function stop() {\n            this._internalAbort();\n            this._disableStatisticsReporter();\n        }\n    }, {\n        key: '_internalAbort',\n        value: function _internalAbort() {\n            if (this._ioctl) {\n                this._ioctl.destroy();\n                this._ioctl = null;\n            }\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            // take a rest\n            if (this._ioctl && this._ioctl.isWorking()) {\n                this._ioctl.pause();\n                this._disableStatisticsReporter();\n            }\n        }\n    }, {\n        key: 'resume',\n        value: function resume() {\n            if (this._ioctl && this._ioctl.isPaused()) {\n                this._ioctl.resume();\n                this._enableStatisticsReporter();\n            }\n        }\n    }, {\n        key: 'seek',\n        value: function seek(milliseconds) {\n            if (this._mediaInfo == null || !this._mediaInfo.isSeekable()) {\n                return;\n            }\n\n            var targetSegmentIndex = this._searchSegmentIndexContains(milliseconds);\n\n            if (targetSegmentIndex === this._currentSegmentIndex) {\n                // intra-segment seeking\n                var segmentInfo = this._mediaInfo.segments[targetSegmentIndex];\n\n                if (segmentInfo == undefined) {\n                    // current segment loading started, but mediainfo hasn't received yet\n                    // wait for the metadata loaded, then seek to expected position\n                    this._pendingSeekTime = milliseconds;\n                } else {\n                    var keyframe = segmentInfo.getNearestKeyframe(milliseconds);\n                    this._remuxer.seek(keyframe.milliseconds);\n                    this._ioctl.seek(keyframe.fileposition);\n                    // Will be resolved in _onRemuxerMediaSegmentArrival()\n                    this._pendingResolveSeekPoint = keyframe.milliseconds;\n                }\n            } else {\n                // cross-segment seeking\n                var targetSegmentInfo = this._mediaInfo.segments[targetSegmentIndex];\n\n                if (targetSegmentInfo == undefined) {\n                    // target segment hasn't been loaded. We need metadata then seek to expected time\n                    this._pendingSeekTime = milliseconds;\n                    this._internalAbort();\n                    this._remuxer.seek();\n                    this._remuxer.insertDiscontinuity();\n                    this._loadSegment(targetSegmentIndex);\n                    // Here we wait for the metadata loaded, then seek to expected position\n                } else {\n                    // We have target segment's metadata, direct seek to target position\n                    var _keyframe = targetSegmentInfo.getNearestKeyframe(milliseconds);\n                    this._internalAbort();\n                    this._remuxer.seek(milliseconds);\n                    this._remuxer.insertDiscontinuity();\n                    this._demuxer.resetMediaInfo();\n                    this._demuxer.timestampBase = this._mediaDataSource.segments[targetSegmentIndex].timestampBase;\n                    this._loadSegment(targetSegmentIndex, _keyframe.fileposition);\n                    this._pendingResolveSeekPoint = _keyframe.milliseconds;\n                    this._reportSegmentMediaInfo(targetSegmentIndex);\n                }\n            }\n\n            this._enableStatisticsReporter();\n        }\n    }, {\n        key: '_searchSegmentIndexContains',\n        value: function _searchSegmentIndexContains(milliseconds) {\n            var segments = this._mediaDataSource.segments;\n            var idx = segments.length - 1;\n\n            for (var i = 0; i < segments.length; i++) {\n                if (milliseconds < segments[i].timestampBase) {\n                    idx = i - 1;\n                    break;\n                }\n            }\n            return idx;\n        }\n    }, {\n        key: '_onInitChunkArrival',\n        value: function _onInitChunkArrival(data, byteStart) {\n            var _this = this;\n\n            var probeData = null;\n            var consumed = 0;\n\n            if (byteStart > 0) {\n                // IOController seeked immediately after opened, byteStart > 0 callback may received\n                this._demuxer.bindDataSource(this._ioctl);\n                this._demuxer.timestampBase = this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase;\n\n                consumed = this._demuxer.parseChunks(data, byteStart);\n            } else if ((probeData = _flvDemuxer2.default.probe(data)).match) {\n                // Always create new FLVDemuxer\n                this._demuxer = new _flvDemuxer2.default(probeData, this._config);\n\n                if (!this._remuxer) {\n                    this._remuxer = new _mp4Remuxer2.default(this._config);\n                }\n\n                var mds = this._mediaDataSource;\n                if (mds.duration != undefined && !isNaN(mds.duration)) {\n                    this._demuxer.overridedDuration = mds.duration;\n                }\n                if (typeof mds.hasAudio === 'boolean') {\n                    this._demuxer.overridedHasAudio = mds.hasAudio;\n                }\n                if (typeof mds.hasVideo === 'boolean') {\n                    this._demuxer.overridedHasVideo = mds.hasVideo;\n                }\n\n                this._demuxer.timestampBase = mds.segments[this._currentSegmentIndex].timestampBase;\n\n                this._demuxer.onError = this._onDemuxException.bind(this);\n                this._demuxer.onMediaInfo = this._onMediaInfo.bind(this);\n                this._demuxer.onMetaDataArrived = this._onMetaDataArrived.bind(this);\n                this._demuxer.onScriptDataArrived = this._onScriptDataArrived.bind(this);\n                this._demuxer.onStreamTime = this._onStreamTime.bind(this);\n\n                this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl));\n\n                this._remuxer.onInitSegment = this._onRemuxerInitSegmentArrival.bind(this);\n                this._remuxer.onMediaSegment = this._onRemuxerMediaSegmentArrival.bind(this);\n\n                consumed = this._demuxer.parseChunks(data, byteStart);\n            } else {\n                probeData = null;\n                _logger2.default.e(this.TAG, 'Non-FLV, Unsupported media type!');\n                Promise.resolve().then(function () {\n                    _this._internalAbort();\n                });\n                this._emitter.emit(_transmuxingEvents2.default.DEMUX_ERROR, _demuxErrors2.default.FORMAT_UNSUPPORTED, 'Non-FLV, Unsupported media type');\n\n                consumed = 0;\n            }\n\n            return consumed;\n        }\n    }, {\n        key: '_onMediaInfo',\n        value: function _onMediaInfo(mediaInfo) {\n            var _this2 = this;\n\n            if (this._mediaInfo == null) {\n                // Store first segment's mediainfo as global mediaInfo\n                this._mediaInfo = Object.assign({}, mediaInfo);\n                this._mediaInfo.keyframesIndex = null;\n                this._mediaInfo.segments = [];\n                this._mediaInfo.segmentCount = this._mediaDataSource.segments.length;\n                Object.setPrototypeOf(this._mediaInfo, _mediaInfo2.default.prototype);\n            }\n\n            var segmentInfo = Object.assign({}, mediaInfo);\n            Object.setPrototypeOf(segmentInfo, _mediaInfo2.default.prototype);\n            this._mediaInfo.segments[this._currentSegmentIndex] = segmentInfo;\n\n            // notify mediaInfo update\n            this._reportSegmentMediaInfo(this._currentSegmentIndex);\n\n            if (this._pendingSeekTime != null) {\n                Promise.resolve().then(function () {\n                    var target = _this2._pendingSeekTime;\n                    _this2._pendingSeekTime = null;\n                    _this2.seek(target);\n                });\n            }\n        }\n    }, {\n        key: '_onMetaDataArrived',\n        value: function _onMetaDataArrived(metadata) {\n            this._emitter.emit(_transmuxingEvents2.default.METADATA_ARRIVED, metadata);\n        }\n    }, {\n        key: '_onScriptDataArrived',\n        value: function _onScriptDataArrived(data) {\n            this._emitter.emit(_transmuxingEvents2.default.SCRIPTDATA_ARRIVED, data);\n        }\n    }, {\n        key: '_onStreamTime',\n        value: function _onStreamTime(time) {\n            this._emitter.emit(_transmuxingEvents2.default.STREAM_TIME, time);\n        }\n    }, {\n        key: '_onIOSeeked',\n        value: function _onIOSeeked() {\n            this._remuxer.insertDiscontinuity();\n        }\n    }, {\n        key: '_onIOComplete',\n        value: function _onIOComplete(extraData) {\n            var segmentIndex = extraData;\n            var nextSegmentIndex = segmentIndex + 1;\n\n            if (nextSegmentIndex < this._mediaDataSource.segments.length) {\n                this._internalAbort();\n                this._remuxer.flushStashedSamples();\n                this._loadSegment(nextSegmentIndex);\n            } else {\n                this._remuxer.flushStashedSamples();\n                this._emitter.emit(_transmuxingEvents2.default.LOADING_COMPLETE);\n                this._disableStatisticsReporter();\n            }\n        }\n    }, {\n        key: '_onIORedirect',\n        value: function _onIORedirect(redirectedURL) {\n            var segmentIndex = this._ioctl.extraData;\n            this._mediaDataSource.segments[segmentIndex].redirectedURL = redirectedURL;\n        }\n    }, {\n        key: '_onIORecoveredEarlyEof',\n        value: function _onIORecoveredEarlyEof() {\n            this._emitter.emit(_transmuxingEvents2.default.RECOVERED_EARLY_EOF);\n        }\n    }, {\n        key: '_onIOException',\n        value: function _onIOException(type, info) {\n            _logger2.default.e(this.TAG, 'IOException: type = ' + type + ', code = ' + info.code + ', msg = ' + info.msg);\n            this._emitter.emit(_transmuxingEvents2.default.IO_ERROR, type, info);\n            this._disableStatisticsReporter();\n        }\n    }, {\n        key: '_onDemuxException',\n        value: function _onDemuxException(type, info) {\n            _logger2.default.e(this.TAG, 'DemuxException: type = ' + type + ', info = ' + info);\n            this._emitter.emit(_transmuxingEvents2.default.DEMUX_ERROR, type, info);\n        }\n    }, {\n        key: '_onRemuxerInitSegmentArrival',\n        value: function _onRemuxerInitSegmentArrival(type, initSegment) {\n            this._emitter.emit(_transmuxingEvents2.default.INIT_SEGMENT, type, initSegment);\n        }\n    }, {\n        key: '_onRemuxerMediaSegmentArrival',\n        value: function _onRemuxerMediaSegmentArrival(type, mediaSegment) {\n            if (this._pendingSeekTime != null) {\n                // Media segments after new-segment cross-seeking should be dropped.\n                return;\n            }\n            this._emitter.emit(_transmuxingEvents2.default.MEDIA_SEGMENT, type, mediaSegment);\n\n            // Resolve pending seekPoint\n            if (this._pendingResolveSeekPoint != null && type === 'video') {\n                var syncPoints = mediaSegment.info.syncPoints;\n                var seekpoint = this._pendingResolveSeekPoint;\n                this._pendingResolveSeekPoint = null;\n\n                // Safari: Pass PTS for recommend_seekpoint\n                if (_browser2.default.safari && syncPoints.length > 0 && syncPoints[0].originalDts === seekpoint) {\n                    seekpoint = syncPoints[0].pts;\n                }\n                // else: use original DTS (keyframe.milliseconds)\n\n                this._emitter.emit(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, seekpoint);\n            }\n        }\n    }, {\n        key: '_enableStatisticsReporter',\n        value: function _enableStatisticsReporter() {\n            if (this._statisticsReporter == null) {\n                this._statisticsReporter = self.setInterval(this._reportStatisticsInfo.bind(this), this._config.statisticsInfoReportInterval);\n            }\n        }\n    }, {\n        key: '_disableStatisticsReporter',\n        value: function _disableStatisticsReporter() {\n            if (this._statisticsReporter) {\n                self.clearInterval(this._statisticsReporter);\n                this._statisticsReporter = null;\n            }\n        }\n    }, {\n        key: '_reportSegmentMediaInfo',\n        value: function _reportSegmentMediaInfo(segmentIndex) {\n            var segmentInfo = this._mediaInfo.segments[segmentIndex];\n            var exportInfo = Object.assign({}, segmentInfo);\n\n            exportInfo.duration = this._mediaInfo.duration;\n            exportInfo.segmentCount = this._mediaInfo.segmentCount;\n            delete exportInfo.segments;\n            delete exportInfo.keyframesIndex;\n\n            this._emitter.emit(_transmuxingEvents2.default.MEDIA_INFO, exportInfo);\n        }\n    }, {\n        key: '_reportStatisticsInfo',\n        value: function _reportStatisticsInfo() {\n            var info = {};\n\n            info.url = this._ioctl.currentURL;\n            info.hasRedirect = this._ioctl.hasRedirect;\n            if (info.hasRedirect) {\n                info.redirectedURL = this._ioctl.currentRedirectedURL;\n            }\n\n            info.speed = this._ioctl.currentSpeed;\n            info.loaderType = this._ioctl.loaderType;\n            info.currentSegmentIndex = this._currentSegmentIndex;\n            info.totalSegmentCount = this._mediaDataSource.segments.length;\n\n            this._emitter.emit(_transmuxingEvents2.default.STATISTICS_INFO, info);\n        }\n    }]);\n\n    return TransmuxingController;\n}();\n\nexports.default = TransmuxingController;\n\n},{\"../demux/demux-errors.js\":16,\"../demux/flv-demuxer.js\":18,\"../io/io-controller.js\":23,\"../io/loader.js\":24,\"../remux/mp4-remuxer.js\":38,\"../utils/browser.js\":39,\"../utils/logger.js\":41,\"./media-info.js\":7,\"./transmuxing-events.js\":13,\"events\":2}],13:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar TransmuxingEvents = {\n  IO_ERROR: 'io_error',\n  DEMUX_ERROR: 'demux_error',\n  INIT_SEGMENT: 'init_segment',\n  MEDIA_SEGMENT: 'media_segment',\n  LOADING_COMPLETE: 'loading_complete',\n  RECOVERED_EARLY_EOF: 'recovered_early_eof',\n  MEDIA_INFO: 'media_info',\n  METADATA_ARRIVED: 'metadata_arrived',\n  SCRIPTDATA_ARRIVED: 'scriptdata_arrived',\n  STATISTICS_INFO: 'statistics_info',\n  RECOMMEND_SEEKPOINT: 'recommend_seekpoint',\n  STREAM_TIME: 'stream_time'\n};\n\nexports.default = TransmuxingEvents;\n\n},{}],14:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _loggingControl = _dereq_('../utils/logging-control.js');\n\nvar _loggingControl2 = _interopRequireDefault(_loggingControl);\n\nvar _polyfill = _dereq_('../utils/polyfill.js');\n\nvar _polyfill2 = _interopRequireDefault(_polyfill);\n\nvar _transmuxingController = _dereq_('./transmuxing-controller.js');\n\nvar _transmuxingController2 = _interopRequireDefault(_transmuxingController);\n\nvar _transmuxingEvents = _dereq_('./transmuxing-events.js');\n\nvar _transmuxingEvents2 = _interopRequireDefault(_transmuxingEvents);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/* post message to worker:\r\n   data: {\r\n       cmd: string\r\n       param: any\r\n   }\r\n\r\n   receive message from worker:\r\n   data: {\r\n       msg: string,\r\n       data: any\r\n   }\r\n */\n\nvar TransmuxingWorker = function TransmuxingWorker(self) {\n\n    var TAG = 'TransmuxingWorker';\n    var controller = null;\n    var logcatListener = onLogcatCallback.bind(this);\n\n    _polyfill2.default.install();\n\n    self.addEventListener('message', function (e) {\n        switch (e.data.cmd) {\n            case 'init':\n                controller = new _transmuxingController2.default(e.data.param[0], e.data.param[1]);\n                controller.on(_transmuxingEvents2.default.IO_ERROR, onIOError.bind(this));\n                controller.on(_transmuxingEvents2.default.DEMUX_ERROR, onDemuxError.bind(this));\n                controller.on(_transmuxingEvents2.default.INIT_SEGMENT, onInitSegment.bind(this));\n                controller.on(_transmuxingEvents2.default.MEDIA_SEGMENT, onMediaSegment.bind(this));\n                controller.on(_transmuxingEvents2.default.LOADING_COMPLETE, onLoadingComplete.bind(this));\n                controller.on(_transmuxingEvents2.default.RECOVERED_EARLY_EOF, onRecoveredEarlyEof.bind(this));\n                controller.on(_transmuxingEvents2.default.MEDIA_INFO, onMediaInfo.bind(this));\n                controller.on(_transmuxingEvents2.default.METADATA_ARRIVED, onMetaDataArrived.bind(this));\n                controller.on(_transmuxingEvents2.default.SCRIPTDATA_ARRIVED, onScriptDataArrived.bind(this));\n                controller.on(_transmuxingEvents2.default.STATISTICS_INFO, onStatisticsInfo.bind(this));\n                controller.on(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, onRecommendSeekpoint.bind(this));\n                break;\n            case 'destroy':\n                if (controller) {\n                    controller.destroy();\n                    controller = null;\n                }\n                self.postMessage({ msg: 'destroyed' });\n                break;\n            case 'start':\n                controller.start();\n                break;\n            case 'stop':\n                controller.stop();\n                break;\n            case 'seek':\n                controller.seek(e.data.param);\n                break;\n            case 'pause':\n                controller.pause();\n                break;\n            case 'resume':\n                controller.resume();\n                break;\n            case 'logging_config':\n                {\n                    var config = e.data.param;\n                    _loggingControl2.default.applyConfig(config);\n\n                    if (config.enableCallback === true) {\n                        _loggingControl2.default.addLogListener(logcatListener);\n                    } else {\n                        _loggingControl2.default.removeLogListener(logcatListener);\n                    }\n                    break;\n                }\n        }\n    });\n\n    function onInitSegment(type, initSegment) {\n        var obj = {\n            msg: _transmuxingEvents2.default.INIT_SEGMENT,\n            data: {\n                type: type,\n                data: initSegment\n            }\n        };\n        self.postMessage(obj, [initSegment.data]); // data: ArrayBuffer\n    }\n\n    function onMediaSegment(type, mediaSegment) {\n        var obj = {\n            msg: _transmuxingEvents2.default.MEDIA_SEGMENT,\n            data: {\n                type: type,\n                data: mediaSegment\n            }\n        };\n        self.postMessage(obj, [mediaSegment.data]); // data: ArrayBuffer\n    }\n\n    function onLoadingComplete() {\n        var obj = {\n            msg: _transmuxingEvents2.default.LOADING_COMPLETE\n        };\n        self.postMessage(obj);\n    }\n\n    function onRecoveredEarlyEof() {\n        var obj = {\n            msg: _transmuxingEvents2.default.RECOVERED_EARLY_EOF\n        };\n        self.postMessage(obj);\n    }\n\n    function onMediaInfo(mediaInfo) {\n        var obj = {\n            msg: _transmuxingEvents2.default.MEDIA_INFO,\n            data: mediaInfo\n        };\n        self.postMessage(obj);\n    }\n\n    function onMetaDataArrived(metadata) {\n        var obj = {\n            msg: _transmuxingEvents2.default.METADATA_ARRIVED,\n            data: metadata\n        };\n        self.postMessage(obj);\n    }\n\n    function onScriptDataArrived(data) {\n        var obj = {\n            msg: _transmuxingEvents2.default.SCRIPTDATA_ARRIVED,\n            data: data\n        };\n        self.postMessage(obj);\n    }\n\n    function onStatisticsInfo(statInfo) {\n        var obj = {\n            msg: _transmuxingEvents2.default.STATISTICS_INFO,\n            data: statInfo\n        };\n        self.postMessage(obj);\n    }\n\n    function onIOError(type, info) {\n        self.postMessage({\n            msg: _transmuxingEvents2.default.IO_ERROR,\n            data: {\n                type: type,\n                info: info\n            }\n        });\n    }\n\n    function onDemuxError(type, info) {\n        self.postMessage({\n            msg: _transmuxingEvents2.default.DEMUX_ERROR,\n            data: {\n                type: type,\n                info: info\n            }\n        });\n    }\n\n    function onRecommendSeekpoint(milliseconds) {\n        self.postMessage({\n            msg: _transmuxingEvents2.default.RECOMMEND_SEEKPOINT,\n            data: milliseconds\n        });\n    }\n\n    function onLogcatCallback(type, str) {\n        self.postMessage({\n            msg: 'logcat_callback',\n            data: {\n                type: type,\n                logcat: str\n            }\n        });\n    }\n}; /*\r\n    * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n    *\r\n    * @author zheng qian <xqq@xqq.im>\r\n    *\r\n    * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n    * you may not use this file except in compliance with the License.\r\n    * You may obtain a copy of the License at\r\n    *\r\n    *     http://www.apache.org/licenses/LICENSE-2.0\r\n    *\r\n    * Unless required by applicable law or agreed to in writing, software\r\n    * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n    * See the License for the specific language governing permissions and\r\n    * limitations under the License.\r\n    */\n\nexports.default = TransmuxingWorker;\n\n},{\"../utils/logger.js\":41,\"../utils/logging-control.js\":42,\"../utils/polyfill.js\":43,\"./transmuxing-controller.js\":12,\"./transmuxing-events.js\":13}],15:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _utf8Conv = _dereq_('../utils/utf8-conv.js');\n\nvar _utf8Conv2 = _interopRequireDefault(_utf8Conv);\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar le = function () {\n    var buf = new ArrayBuffer(2);\n    new DataView(buf).setInt16(0, 256, true); // little-endian write\n    return new Int16Array(buf)[0] === 256; // platform-spec read, if equal then LE\n}();\n\nvar AMF = function () {\n    function AMF() {\n        _classCallCheck(this, AMF);\n    }\n\n    _createClass(AMF, null, [{\n        key: 'parseScriptData',\n        value: function parseScriptData(arrayBuffer, dataOffset, dataSize) {\n            var data = {};\n\n            try {\n                var name = AMF.parseValue(arrayBuffer, dataOffset, dataSize);\n                var value = AMF.parseValue(arrayBuffer, dataOffset + name.size, dataSize - name.size);\n\n                data[name.data] = value.data;\n            } catch (e) {\n                _logger2.default.e('AMF', e.toString());\n            }\n\n            return data;\n        }\n    }, {\n        key: 'parseObject',\n        value: function parseObject(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 3) {\n                throw new _exception.IllegalStateException('Data not enough when parse ScriptDataObject');\n            }\n            var name = AMF.parseString(arrayBuffer, dataOffset, dataSize);\n            var value = AMF.parseValue(arrayBuffer, dataOffset + name.size, dataSize - name.size);\n            var isObjectEnd = value.objectEnd;\n\n            return {\n                data: {\n                    name: name.data,\n                    value: value.data\n                },\n                size: name.size + value.size,\n                objectEnd: isObjectEnd\n            };\n        }\n    }, {\n        key: 'parseVariable',\n        value: function parseVariable(arrayBuffer, dataOffset, dataSize) {\n            return AMF.parseObject(arrayBuffer, dataOffset, dataSize);\n        }\n    }, {\n        key: 'parseString',\n        value: function parseString(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 2) {\n                throw new _exception.IllegalStateException('Data not enough when parse String');\n            }\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n            var length = v.getUint16(0, !le);\n\n            var str = void 0;\n            if (length > 0) {\n                str = (0, _utf8Conv2.default)(new Uint8Array(arrayBuffer, dataOffset + 2, length));\n            } else {\n                str = '';\n            }\n\n            return {\n                data: str,\n                size: 2 + length\n            };\n        }\n    }, {\n        key: 'parseLongString',\n        value: function parseLongString(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 4) {\n                throw new _exception.IllegalStateException('Data not enough when parse LongString');\n            }\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n            var length = v.getUint32(0, !le);\n\n            var str = void 0;\n            if (length > 0) {\n                str = (0, _utf8Conv2.default)(new Uint8Array(arrayBuffer, dataOffset + 4, length));\n            } else {\n                str = '';\n            }\n\n            return {\n                data: str,\n                size: 4 + length\n            };\n        }\n    }, {\n        key: 'parseDate',\n        value: function parseDate(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 10) {\n                throw new _exception.IllegalStateException('Data size invalid when parse Date');\n            }\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n            var timestamp = v.getFloat64(0, !le);\n            var localTimeOffset = v.getInt16(8, !le);\n            timestamp += localTimeOffset * 60 * 1000; // get UTC time\n\n            return {\n                data: new Date(timestamp),\n                size: 8 + 2\n            };\n        }\n    }, {\n        key: 'parseValue',\n        value: function parseValue(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 1) {\n                throw new _exception.IllegalStateException('Data not enough when parse Value');\n            }\n\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n            var offset = 1;\n            var type = v.getUint8(0);\n            var value = void 0;\n            var objectEnd = false;\n\n            try {\n                switch (type) {\n                    case 0:\n                        // Number(Double) type\n                        value = v.getFloat64(1, !le);\n                        offset += 8;\n                        break;\n                    case 1:\n                        {\n                            // Boolean type\n                            var b = v.getUint8(1);\n                            value = b ? true : false;\n                            offset += 1;\n                            break;\n                        }\n                    case 2:\n                        {\n                            // String type\n                            var amfstr = AMF.parseString(arrayBuffer, dataOffset + 1, dataSize - 1);\n                            value = amfstr.data;\n                            offset += amfstr.size;\n                            break;\n                        }\n                    case 3:\n                        {\n                            // Object(s) type\n                            value = {};\n                            var terminal = 0; // workaround for malformed Objects which has missing ScriptDataObjectEnd\n                            if ((v.getUint32(dataSize - 4, !le) & 0x00FFFFFF) === 9) {\n                                terminal = 3;\n                            }\n                            while (offset < dataSize - 4) {\n                                // 4 === type(UI8) + ScriptDataObjectEnd(UI24)\n                                var amfobj = AMF.parseObject(arrayBuffer, dataOffset + offset, dataSize - offset - terminal);\n                                if (amfobj.objectEnd) break;\n                                value[amfobj.data.name] = amfobj.data.value;\n                                offset += amfobj.size;\n                            }\n                            if (offset <= dataSize - 3) {\n                                var marker = v.getUint32(offset - 1, !le) & 0x00FFFFFF;\n                                if (marker === 9) {\n                                    offset += 3;\n                                }\n                            }\n                            break;\n                        }\n                    case 8:\n                        {\n                            // ECMA array type (Mixed array)\n                            value = {};\n                            offset += 4; // ECMAArrayLength(UI32)\n                            var _terminal = 0; // workaround for malformed MixedArrays which has missing ScriptDataObjectEnd\n                            if ((v.getUint32(dataSize - 4, !le) & 0x00FFFFFF) === 9) {\n                                _terminal = 3;\n                            }\n                            while (offset < dataSize - 8) {\n                                // 8 === type(UI8) + ECMAArrayLength(UI32) + ScriptDataVariableEnd(UI24)\n                                var amfvar = AMF.parseVariable(arrayBuffer, dataOffset + offset, dataSize - offset - _terminal);\n                                if (amfvar.objectEnd) break;\n                                value[amfvar.data.name] = amfvar.data.value;\n                                offset += amfvar.size;\n                            }\n                            if (offset <= dataSize - 3) {\n                                var _marker = v.getUint32(offset - 1, !le) & 0x00FFFFFF;\n                                if (_marker === 9) {\n                                    offset += 3;\n                                }\n                            }\n                            break;\n                        }\n                    case 9:\n                        // ScriptDataObjectEnd\n                        value = undefined;\n                        offset = 1;\n                        objectEnd = true;\n                        break;\n                    case 10:\n                        {\n                            // Strict array type\n                            // ScriptDataValue[n]. NOTE: according to video_file_format_spec_v10_1.pdf\n                            value = [];\n                            var strictArrayLength = v.getUint32(1, !le);\n                            offset += 4;\n                            for (var i = 0; i < strictArrayLength; i++) {\n                                var val = AMF.parseValue(arrayBuffer, dataOffset + offset, dataSize - offset);\n                                value.push(val.data);\n                                offset += val.size;\n                            }\n                            break;\n                        }\n                    case 11:\n                        {\n                            // Date type\n                            var date = AMF.parseDate(arrayBuffer, dataOffset + 1, dataSize - 1);\n                            value = date.data;\n                            offset += date.size;\n                            break;\n                        }\n                    case 12:\n                        {\n                            // Long string type\n                            var amfLongStr = AMF.parseString(arrayBuffer, dataOffset + 1, dataSize - 1);\n                            value = amfLongStr.data;\n                            offset += amfLongStr.size;\n                            break;\n                        }\n                    default:\n                        // ignore and skip\n                        offset = dataSize;\n                        _logger2.default.w('AMF', 'Unsupported AMF value type ' + type);\n                }\n            } catch (e) {\n                _logger2.default.e('AMF', e.toString());\n            }\n\n            return {\n                data: value,\n                size: offset,\n                objectEnd: objectEnd\n            };\n        }\n    }]);\n\n    return AMF;\n}();\n\nexports.default = AMF;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"../utils/utf8-conv.js\":44}],16:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar DemuxErrors = {\n  OK: 'OK',\n  FORMAT_ERROR: 'FormatError',\n  FORMAT_UNSUPPORTED: 'FormatUnsupported',\n  CODEC_UNSUPPORTED: 'CodecUnsupported'\n};\n\nexports.default = DemuxErrors;\n\n},{}],17:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Exponential-Golomb buffer decoder\nvar ExpGolomb = function () {\n    function ExpGolomb(uint8array) {\n        _classCallCheck(this, ExpGolomb);\n\n        this.TAG = 'ExpGolomb';\n\n        this._buffer = uint8array;\n        this._buffer_index = 0;\n        this._total_bytes = uint8array.byteLength;\n        this._total_bits = uint8array.byteLength * 8;\n        this._current_word = 0;\n        this._current_word_bits_left = 0;\n    }\n\n    _createClass(ExpGolomb, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._buffer = null;\n        }\n    }, {\n        key: '_fillCurrentWord',\n        value: function _fillCurrentWord() {\n            var buffer_bytes_left = this._total_bytes - this._buffer_index;\n            if (buffer_bytes_left <= 0) throw new _exception.IllegalStateException('ExpGolomb: _fillCurrentWord() but no bytes available');\n\n            var bytes_read = Math.min(4, buffer_bytes_left);\n            var word = new Uint8Array(4);\n            word.set(this._buffer.subarray(this._buffer_index, this._buffer_index + bytes_read));\n            this._current_word = new DataView(word.buffer).getUint32(0, false);\n\n            this._buffer_index += bytes_read;\n            this._current_word_bits_left = bytes_read * 8;\n        }\n    }, {\n        key: 'readBits',\n        value: function readBits(bits) {\n            if (bits > 32) throw new _exception.InvalidArgumentException('ExpGolomb: readBits() bits exceeded max 32bits!');\n\n            if (bits <= this._current_word_bits_left) {\n                var _result = this._current_word >>> 32 - bits;\n                this._current_word <<= bits;\n                this._current_word_bits_left -= bits;\n                return _result;\n            }\n\n            var result = this._current_word_bits_left ? this._current_word : 0;\n            result = result >>> 32 - this._current_word_bits_left;\n            var bits_need_left = bits - this._current_word_bits_left;\n\n            this._fillCurrentWord();\n            var bits_read_next = Math.min(bits_need_left, this._current_word_bits_left);\n\n            var result2 = this._current_word >>> 32 - bits_read_next;\n            this._current_word <<= bits_read_next;\n            this._current_word_bits_left -= bits_read_next;\n\n            result = result << bits_read_next | result2;\n            return result;\n        }\n    }, {\n        key: 'readBool',\n        value: function readBool() {\n            return this.readBits(1) === 1;\n        }\n    }, {\n        key: 'readByte',\n        value: function readByte() {\n            return this.readBits(8);\n        }\n    }, {\n        key: '_skipLeadingZero',\n        value: function _skipLeadingZero() {\n            var zero_count = void 0;\n            for (zero_count = 0; zero_count < this._current_word_bits_left; zero_count++) {\n                if (0 !== (this._current_word & 0x80000000 >>> zero_count)) {\n                    this._current_word <<= zero_count;\n                    this._current_word_bits_left -= zero_count;\n                    return zero_count;\n                }\n            }\n            this._fillCurrentWord();\n            return zero_count + this._skipLeadingZero();\n        }\n    }, {\n        key: 'readUEG',\n        value: function readUEG() {\n            // unsigned exponential golomb\n            var leading_zeros = this._skipLeadingZero();\n            return this.readBits(leading_zeros + 1) - 1;\n        }\n    }, {\n        key: 'readSEG',\n        value: function readSEG() {\n            // signed exponential golomb\n            var value = this.readUEG();\n            if (value & 0x01) {\n                return value + 1 >>> 1;\n            } else {\n                return -1 * (value >>> 1);\n            }\n        }\n    }]);\n\n    return ExpGolomb;\n}();\n\nexports.default = ExpGolomb;\n\n},{\"../utils/exception.js\":40}],18:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _amfParser = _dereq_('./amf-parser.js');\n\nvar _amfParser2 = _interopRequireDefault(_amfParser);\n\nvar _spsParser = _dereq_('./sps-parser.js');\n\nvar _spsParser2 = _interopRequireDefault(_spsParser);\n\nvar _demuxErrors = _dereq_('./demux-errors.js');\n\nvar _demuxErrors2 = _interopRequireDefault(_demuxErrors);\n\nvar _mediaInfo = _dereq_('../core/media-info.js');\n\nvar _mediaInfo2 = _interopRequireDefault(_mediaInfo);\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction Swap16(src) {\n    return src >>> 8 & 0xFF | (src & 0xFF) << 8;\n}\n\nfunction Swap32(src) {\n    return (src & 0xFF000000) >>> 24 | (src & 0x00FF0000) >>> 8 | (src & 0x0000FF00) << 8 | (src & 0x000000FF) << 24;\n}\n\nfunction ReadBig32(array, index) {\n    return array[index] << 24 | array[index + 1] << 16 | array[index + 2] << 8 | array[index + 3];\n}\n\nvar FLVDemuxer = function () {\n    function FLVDemuxer(probeData, config) {\n        _classCallCheck(this, FLVDemuxer);\n\n        this.TAG = 'FLVDemuxer';\n\n        this._config = config;\n\n        this._onError = null;\n        this._onMediaInfo = null;\n        this._onMetaDataArrived = null;\n        this._onScriptDataArrived = null;\n        this._onTrackMetadata = null;\n        this._onDataAvailable = null;\n        this._onStreamTime = null;\n\n        this._dataOffset = probeData.dataOffset;\n        this._firstParse = true;\n        this._dispatch = false;\n\n        this._hasAudio = probeData.hasAudioTrack;\n        this._hasVideo = probeData.hasVideoTrack;\n\n        this._hasAudioFlagOverrided = false;\n        this._hasVideoFlagOverrided = false;\n\n        this._audioInitialMetadataDispatched = false;\n        this._videoInitialMetadataDispatched = false;\n\n        this._mediaInfo = new _mediaInfo2.default();\n        this._mediaInfo.hasAudio = this._hasAudio;\n        this._mediaInfo.hasVideo = this._hasVideo;\n        this._metadata = null;\n        this._audioMetadata = null;\n        this._videoMetadata = null;\n\n        this._naluLengthSize = 4;\n        this._timestampBase = 0; // int32, in milliseconds\n        this._timescale = 1000;\n        this._duration = 0; // int32, in milliseconds\n        this._durationOverrided = false;\n        this._referenceFrameRate = {\n            fixed: true,\n            fps: 23.976,\n            fps_num: 23976,\n            fps_den: 1000\n        };\n\n        this._flvSoundRateTable = [5500, 11025, 22050, 44100, 48000];\n\n        this._mpegSamplingRates = [96000, 88200, 64000, 48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000, 7350];\n\n        this._mpegAudioV10SampleRateTable = [44100, 48000, 32000, 0];\n        this._mpegAudioV20SampleRateTable = [22050, 24000, 16000, 0];\n        this._mpegAudioV25SampleRateTable = [11025, 12000, 8000, 0];\n\n        this._mpegAudioL1BitRateTable = [0, 32, 64, 96, 128, 160, 192, 224, 256, 288, 320, 352, 384, 416, 448, -1];\n        this._mpegAudioL2BitRateTable = [0, 32, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, 384, -1];\n        this._mpegAudioL3BitRateTable = [0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, -1];\n\n        this._videoTrack = { type: 'video', id: 1, sequenceNumber: 0, samples: [], length: 0 };\n        this._audioTrack = { type: 'audio', id: 2, sequenceNumber: 0, samples: [], length: 0 };\n\n        this._littleEndian = function () {\n            var buf = new ArrayBuffer(2);\n            new DataView(buf).setInt16(0, 256, true); // little-endian write\n            return new Int16Array(buf)[0] === 256; // platform-spec read, if equal then LE\n        }();\n    }\n\n    _createClass(FLVDemuxer, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._mediaInfo = null;\n            this._metadata = null;\n            this._audioMetadata = null;\n            this._videoMetadata = null;\n            this._videoTrack = null;\n            this._audioTrack = null;\n\n            this._onError = null;\n            this._onMediaInfo = null;\n            this._onMetaDataArrived = null;\n            this._onScriptDataArrived = null;\n            this._onTrackMetadata = null;\n            this._onDataAvailable = null;\n            this._onStreamTime = null;\n        }\n    }, {\n        key: 'bindDataSource',\n        value: function bindDataSource(loader) {\n            loader.onDataArrival = this.parseChunks.bind(this);\n            return this;\n        }\n\n        // prototype: function(type: string, metadata: any): void\n\n    }, {\n        key: 'resetMediaInfo',\n        value: function resetMediaInfo() {\n            this._mediaInfo = new _mediaInfo2.default();\n        }\n    }, {\n        key: '_isInitialMetadataDispatched',\n        value: function _isInitialMetadataDispatched() {\n            if (this._hasAudio && this._hasVideo) {\n                // both audio & video\n                return this._audioInitialMetadataDispatched && this._videoInitialMetadataDispatched;\n            }\n            if (this._hasAudio && !this._hasVideo) {\n                // audio only\n                return this._audioInitialMetadataDispatched;\n            }\n            if (!this._hasAudio && this._hasVideo) {\n                // video only\n                return this._videoInitialMetadataDispatched;\n            }\n            return false;\n        }\n\n        // function parseChunks(chunk: ArrayBuffer, byteStart: number): number;\n\n    }, {\n        key: 'parseChunks',\n        value: function parseChunks(chunk, byteStart) {\n            if (!this._onError || !this._onMediaInfo || !this._onTrackMetadata || !this._onDataAvailable) {\n                throw new _exception.IllegalStateException('Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified');\n            }\n\n            var offset = 0;\n            var le = this._littleEndian;\n\n            if (byteStart === 0) {\n                // buffer with FLV header\n                if (chunk.byteLength > 13) {\n                    var probeData = FLVDemuxer.probe(chunk);\n                    offset = probeData.dataOffset;\n                } else {\n                    return 0;\n                }\n            }\n\n            if (this._firstParse) {\n                // handle PreviousTagSize0 before Tag1\n                this._firstParse = false;\n                if (byteStart + offset !== this._dataOffset) {\n                    _logger2.default.w(this.TAG, 'First time parsing but chunk byteStart invalid!');\n                }\n\n                var v = new DataView(chunk, offset);\n                var prevTagSize0 = v.getUint32(0, !le);\n                if (prevTagSize0 !== 0) {\n                    _logger2.default.w(this.TAG, 'PrevTagSize0 !== 0 !!!');\n                }\n                offset += 4;\n            }\n\n            while (offset < chunk.byteLength) {\n                this._dispatch = true;\n\n                var _v = new DataView(chunk, offset);\n\n                if (offset + 11 + 4 > chunk.byteLength) {\n                    // data not enough for parsing an flv tag\n                    break;\n                }\n\n                var tagType = _v.getUint8(0);\n                var dataSize = _v.getUint32(0, !le) & 0x00FFFFFF;\n\n                if (offset + 11 + dataSize + 4 > chunk.byteLength) {\n                    // data not enough for parsing actual data body\n                    break;\n                }\n\n                if (tagType !== 8 && tagType !== 9 && tagType !== 18) {\n                    _logger2.default.w(this.TAG, 'Unsupported tag type ' + tagType + ', skipped');\n                    // consume the whole tag (skip it)\n                    offset += 11 + dataSize + 4;\n                    continue;\n                }\n\n                var ts2 = _v.getUint8(4);\n                var ts1 = _v.getUint8(5);\n                var ts0 = _v.getUint8(6);\n                var ts3 = _v.getUint8(7);\n\n                var timestamp = ts0 | ts1 << 8 | ts2 << 16 | ts3 << 24;\n\n                var streamId = _v.getUint32(7, !le) & 0x00FFFFFF;\n                if (streamId !== 0) {\n                    _logger2.default.w(this.TAG, 'Meet tag which has StreamID != 0!');\n                }\n\n                var dataOffset = offset + 11;\n\n                switch (tagType) {\n                    case 8:\n                        // Audio\n                        this._parseAudioData(chunk, dataOffset, dataSize, timestamp);\n                        break;\n                    case 9:\n                        // Video\n                        if (this._onStreamTime != null) {\n                            this._onStreamTime(timestamp);\n                        }\n                        this._parseVideoData(chunk, dataOffset, dataSize, timestamp, byteStart + offset);\n                        break;\n                    case 18:\n                        // ScriptDataObject\n                        this._parseScriptData(chunk, dataOffset, dataSize);\n                        break;\n                }\n\n                var prevTagSize = _v.getUint32(11 + dataSize, !le);\n                if (prevTagSize !== 11 + dataSize) {\n                    _logger2.default.w(this.TAG, 'Invalid PrevTagSize ' + prevTagSize);\n                }\n\n                offset += 11 + dataSize + 4; // tagBody + dataSize + prevTagSize\n            }\n\n            // dispatch parsed frames to consumer (typically, the remuxer)\n            if (this._isInitialMetadataDispatched()) {\n                if (this._dispatch && (this._audioTrack.length || this._videoTrack.length)) {\n                    this._onDataAvailable(this._audioTrack, this._videoTrack);\n                }\n            }\n\n            return offset; // consumed bytes, just equals latest offset index\n        }\n    }, {\n        key: '_parseScriptData',\n        value: function _parseScriptData(arrayBuffer, dataOffset, dataSize) {\n            var scriptData = _amfParser2.default.parseScriptData(arrayBuffer, dataOffset, dataSize);\n\n            if (scriptData.hasOwnProperty('onMetaData')) {\n                if (scriptData.onMetaData == null || _typeof(scriptData.onMetaData) !== 'object') {\n                    _logger2.default.w(this.TAG, 'Invalid onMetaData structure!');\n                    return;\n                }\n                if (this._metadata) {\n                    _logger2.default.w(this.TAG, 'Found another onMetaData tag!');\n                }\n                this._metadata = scriptData;\n                var onMetaData = this._metadata.onMetaData;\n\n                if (this._onMetaDataArrived) {\n                    this._onMetaDataArrived(Object.assign({}, onMetaData));\n                }\n\n                if (typeof onMetaData.hasAudio === 'boolean') {\n                    // hasAudio\n                    if (this._hasAudioFlagOverrided === false) {\n                        this._hasAudio = onMetaData.hasAudio;\n                        this._mediaInfo.hasAudio = this._hasAudio;\n                    }\n                }\n                if (typeof onMetaData.hasVideo === 'boolean') {\n                    // hasVideo\n                    if (this._hasVideoFlagOverrided === false) {\n                        this._hasVideo = onMetaData.hasVideo;\n                        this._mediaInfo.hasVideo = this._hasVideo;\n                    }\n                }\n                if (typeof onMetaData.audiodatarate === 'number') {\n                    // audiodatarate\n                    this._mediaInfo.audioDataRate = onMetaData.audiodatarate;\n                }\n                if (typeof onMetaData.videodatarate === 'number') {\n                    // videodatarate\n                    this._mediaInfo.videoDataRate = onMetaData.videodatarate;\n                }\n                if (typeof onMetaData.width === 'number') {\n                    // width\n                    this._mediaInfo.width = onMetaData.width;\n                }\n                if (typeof onMetaData.height === 'number') {\n                    // height\n                    this._mediaInfo.height = onMetaData.height;\n                }\n                if (typeof onMetaData.duration === 'number') {\n                    // duration\n                    if (!this._durationOverrided) {\n                        var duration = Math.floor(onMetaData.duration * this._timescale);\n                        this._duration = duration;\n                        this._mediaInfo.duration = duration;\n                    }\n                } else {\n                    this._mediaInfo.duration = 0;\n                }\n                if (typeof onMetaData.framerate === 'number') {\n                    // framerate\n                    var fps_num = Math.floor(onMetaData.framerate * 1000);\n                    if (fps_num > 0) {\n                        var fps = fps_num / 1000;\n                        this._referenceFrameRate.fixed = true;\n                        this._referenceFrameRate.fps = fps;\n                        this._referenceFrameRate.fps_num = fps_num;\n                        this._referenceFrameRate.fps_den = 1000;\n                        this._mediaInfo.fps = fps;\n                    }\n                }\n                if (_typeof(onMetaData.keyframes) === 'object') {\n                    // keyframes\n                    this._mediaInfo.hasKeyframesIndex = true;\n                    var keyframes = onMetaData.keyframes;\n                    this._mediaInfo.keyframesIndex = this._parseKeyframesIndex(keyframes);\n                    onMetaData.keyframes = null; // keyframes has been extracted, remove it\n                } else {\n                    this._mediaInfo.hasKeyframesIndex = false;\n                }\n                this._dispatch = false;\n                this._mediaInfo.metadata = onMetaData;\n                _logger2.default.v(this.TAG, 'Parsed onMetaData');\n                if (this._mediaInfo.isComplete()) {\n                    this._onMediaInfo(this._mediaInfo);\n                }\n            }\n\n            if (Object.keys(scriptData).length > 0) {\n                if (this._onScriptDataArrived) {\n                    this._onScriptDataArrived(Object.assign({}, scriptData));\n                }\n            }\n        }\n    }, {\n        key: '_parseKeyframesIndex',\n        value: function _parseKeyframesIndex(keyframes) {\n            var times = [];\n            var filepositions = [];\n\n            // ignore first keyframe which is actually AVC Sequence Header (AVCDecoderConfigurationRecord)\n            for (var i = 1; i < keyframes.times.length; i++) {\n                var time = this._timestampBase + Math.floor(keyframes.times[i] * 1000);\n                times.push(time);\n                filepositions.push(keyframes.filepositions[i]);\n            }\n\n            return {\n                times: times,\n                filepositions: filepositions\n            };\n        }\n    }, {\n        key: '_parseAudioData',\n        value: function _parseAudioData(arrayBuffer, dataOffset, dataSize, tagTimestamp) {\n            if (dataSize <= 1) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid audio packet, missing SoundData payload!');\n                return;\n            }\n\n            if (this._hasAudioFlagOverrided === true && this._hasAudio === false) {\n                // If hasAudio: false indicated explicitly in MediaDataSource,\n                // Ignore all the audio packets\n                return;\n            }\n\n            var le = this._littleEndian;\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n            var soundSpec = v.getUint8(0);\n\n            var soundFormat = soundSpec >>> 4;\n            if (soundFormat !== 2 && soundFormat !== 10) {\n                // MP3 or AAC\n                this._onError(_demuxErrors2.default.CODEC_UNSUPPORTED, 'Flv: Unsupported audio codec idx: ' + soundFormat);\n                return;\n            }\n\n            var soundRate = 0;\n            var soundRateIndex = (soundSpec & 12) >>> 2;\n            if (soundRateIndex >= 0 && soundRateIndex <= 4) {\n                soundRate = this._flvSoundRateTable[soundRateIndex];\n            } else {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid audio sample rate idx: ' + soundRateIndex);\n                return;\n            }\n\n            var soundSize = (soundSpec & 2) >>> 1; // unused\n            var soundType = soundSpec & 1;\n\n            var meta = this._audioMetadata;\n            var track = this._audioTrack;\n\n            if (!meta) {\n                if (this._hasAudio === false && this._hasAudioFlagOverrided === false) {\n                    this._hasAudio = true;\n                    this._mediaInfo.hasAudio = true;\n                }\n\n                // initial metadata\n                meta = this._audioMetadata = {};\n                meta.type = 'audio';\n                meta.id = track.id;\n                meta.timescale = this._timescale;\n                meta.duration = this._duration;\n                meta.audioSampleRate = soundRate;\n                meta.channelCount = soundType === 0 ? 1 : 2;\n            }\n\n            if (soundFormat === 10) {\n                // AAC\n                var aacData = this._parseAACAudioData(arrayBuffer, dataOffset + 1, dataSize - 1);\n                if (aacData == undefined) {\n                    return;\n                }\n\n                if (aacData.packetType === 0) {\n                    // AAC sequence header (AudioSpecificConfig)\n                    if (meta.config) {\n                        _logger2.default.w(this.TAG, 'Found another AudioSpecificConfig!');\n                    }\n                    var misc = aacData.data;\n                    meta.audioSampleRate = misc.samplingRate;\n                    meta.channelCount = misc.channelCount;\n                    meta.codec = misc.codec;\n                    meta.originalCodec = misc.originalCodec;\n                    meta.config = misc.config;\n                    // The decode result of an aac sample is 1024 PCM samples\n                    meta.refSampleDuration = 1024 / meta.audioSampleRate * meta.timescale;\n                    _logger2.default.v(this.TAG, 'Parsed AudioSpecificConfig');\n\n                    if (this._isInitialMetadataDispatched()) {\n                        // Non-initial metadata, force dispatch (or flush) parsed frames to remuxer\n                        if (this._dispatch && (this._audioTrack.length || this._videoTrack.length)) {\n                            this._onDataAvailable(this._audioTrack, this._videoTrack);\n                        }\n                    } else {\n                        this._audioInitialMetadataDispatched = true;\n                    }\n                    // then notify new metadata\n                    this._dispatch = false;\n                    this._onTrackMetadata('audio', meta);\n\n                    var mi = this._mediaInfo;\n                    mi.audioCodec = meta.originalCodec;\n                    mi.audioSampleRate = meta.audioSampleRate;\n                    mi.audioChannelCount = meta.channelCount;\n                    if (mi.hasVideo) {\n                        if (mi.videoCodec != null) {\n                            mi.mimeType = 'video/x-flv; codecs=\"' + mi.videoCodec + ',' + mi.audioCodec + '\"';\n                        }\n                    } else {\n                        mi.mimeType = 'video/x-flv; codecs=\"' + mi.audioCodec + '\"';\n                    }\n                    if (mi.isComplete()) {\n                        this._onMediaInfo(mi);\n                    }\n                } else if (aacData.packetType === 1) {\n                    // AAC raw frame data\n                    var dts = this._timestampBase + tagTimestamp;\n                    var aacSample = { unit: aacData.data, length: aacData.data.byteLength, dts: dts, pts: dts };\n                    track.samples.push(aacSample);\n                    track.length += aacData.data.length;\n                } else {\n                    _logger2.default.e(this.TAG, 'Flv: Unsupported AAC data type ' + aacData.packetType);\n                }\n            } else if (soundFormat === 2) {\n                // MP3\n                if (!meta.codec) {\n                    // We need metadata for mp3 audio track, extract info from frame header\n                    var _misc = this._parseMP3AudioData(arrayBuffer, dataOffset + 1, dataSize - 1, true);\n                    if (_misc == undefined) {\n                        return;\n                    }\n                    meta.audioSampleRate = _misc.samplingRate;\n                    meta.channelCount = _misc.channelCount;\n                    meta.codec = _misc.codec;\n                    meta.originalCodec = _misc.originalCodec;\n                    // The decode result of an mp3 sample is 1152 PCM samples\n                    meta.refSampleDuration = 1152 / meta.audioSampleRate * meta.timescale;\n                    _logger2.default.v(this.TAG, 'Parsed MPEG Audio Frame Header');\n\n                    this._audioInitialMetadataDispatched = true;\n                    this._onTrackMetadata('audio', meta);\n\n                    var _mi = this._mediaInfo;\n                    _mi.audioCodec = meta.codec;\n                    _mi.audioSampleRate = meta.audioSampleRate;\n                    _mi.audioChannelCount = meta.channelCount;\n                    _mi.audioDataRate = _misc.bitRate;\n                    if (_mi.hasVideo) {\n                        if (_mi.videoCodec != null) {\n                            _mi.mimeType = 'video/x-flv; codecs=\"' + _mi.videoCodec + ',' + _mi.audioCodec + '\"';\n                        }\n                    } else {\n                        _mi.mimeType = 'video/x-flv; codecs=\"' + _mi.audioCodec + '\"';\n                    }\n                    if (_mi.isComplete()) {\n                        this._onMediaInfo(_mi);\n                    }\n                }\n\n                // This packet is always a valid audio packet, extract it\n                var data = this._parseMP3AudioData(arrayBuffer, dataOffset + 1, dataSize - 1, false);\n                if (data == undefined) {\n                    return;\n                }\n                var _dts = this._timestampBase + tagTimestamp;\n                var mp3Sample = { unit: data, length: data.byteLength, dts: _dts, pts: _dts };\n                track.samples.push(mp3Sample);\n                track.length += data.length;\n            }\n        }\n    }, {\n        key: '_parseAACAudioData',\n        value: function _parseAACAudioData(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize <= 1) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid AAC packet, missing AACPacketType or/and Data!');\n                return;\n            }\n\n            var result = {};\n            var array = new Uint8Array(arrayBuffer, dataOffset, dataSize);\n\n            result.packetType = array[0];\n\n            if (array[0] === 0) {\n                result.data = this._parseAACAudioSpecificConfig(arrayBuffer, dataOffset + 1, dataSize - 1);\n            } else {\n                result.data = array.subarray(1);\n            }\n\n            return result;\n        }\n    }, {\n        key: '_parseAACAudioSpecificConfig',\n        value: function _parseAACAudioSpecificConfig(arrayBuffer, dataOffset, dataSize) {\n            var array = new Uint8Array(arrayBuffer, dataOffset, dataSize);\n            var config = null;\n\n            /* Audio Object Type:\r\n               0: Null\r\n               1: AAC Main\r\n               2: AAC LC\r\n               3: AAC SSR (Scalable Sample Rate)\r\n               4: AAC LTP (Long Term Prediction)\r\n               5: HE-AAC / SBR (Spectral Band Replication)\r\n               6: AAC Scalable\r\n            */\n\n            var audioObjectType = 0;\n            var originalAudioObjectType = 0;\n            var audioExtensionObjectType = null;\n            var samplingIndex = 0;\n            var extensionSamplingIndex = null;\n\n            // 5 bits\n            audioObjectType = originalAudioObjectType = array[0] >>> 3;\n            // 4 bits\n            samplingIndex = (array[0] & 0x07) << 1 | array[1] >>> 7;\n            if (samplingIndex < 0 || samplingIndex >= this._mpegSamplingRates.length) {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: AAC invalid sampling frequency index!');\n                return;\n            }\n\n            var samplingFrequence = this._mpegSamplingRates[samplingIndex];\n\n            // 4 bits\n            var channelConfig = (array[1] & 0x78) >>> 3;\n            if (channelConfig < 0 || channelConfig >= 8) {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: AAC invalid channel configuration');\n                return;\n            }\n\n            if (audioObjectType === 5) {\n                // HE-AAC?\n                // 4 bits\n                extensionSamplingIndex = (array[1] & 0x07) << 1 | array[2] >>> 7;\n                // 5 bits\n                audioExtensionObjectType = (array[2] & 0x7C) >>> 2;\n            }\n\n            // workarounds for various browsers\n            var userAgent = self.navigator.userAgent.toLowerCase();\n\n            if (userAgent.indexOf('firefox') !== -1) {\n                // firefox: use SBR (HE-AAC) if freq less than 24kHz\n                if (samplingIndex >= 6) {\n                    audioObjectType = 5;\n                    config = new Array(4);\n                    extensionSamplingIndex = samplingIndex - 3;\n                } else {\n                    // use LC-AAC\n                    audioObjectType = 2;\n                    config = new Array(2);\n                    extensionSamplingIndex = samplingIndex;\n                }\n            } else if (userAgent.indexOf('android') !== -1) {\n                // android: always use LC-AAC\n                audioObjectType = 2;\n                config = new Array(2);\n                extensionSamplingIndex = samplingIndex;\n            } else {\n                // for other browsers, e.g. chrome...\n                // Always use HE-AAC to make it easier to switch aac codec profile\n                audioObjectType = 5;\n                extensionSamplingIndex = samplingIndex;\n                config = new Array(4);\n\n                if (samplingIndex >= 6) {\n                    extensionSamplingIndex = samplingIndex - 3;\n                } else if (channelConfig === 1) {\n                    // Mono channel\n                    audioObjectType = 2;\n                    config = new Array(2);\n                    extensionSamplingIndex = samplingIndex;\n                }\n            }\n\n            config[0] = audioObjectType << 3;\n            config[0] |= (samplingIndex & 0x0F) >>> 1;\n            config[1] = (samplingIndex & 0x0F) << 7;\n            config[1] |= (channelConfig & 0x0F) << 3;\n            if (audioObjectType === 5) {\n                config[1] |= (extensionSamplingIndex & 0x0F) >>> 1;\n                config[2] = (extensionSamplingIndex & 0x01) << 7;\n                // extended audio object type: force to 2 (LC-AAC)\n                config[2] |= 2 << 2;\n                config[3] = 0;\n            }\n\n            return {\n                config: config,\n                samplingRate: samplingFrequence,\n                channelCount: channelConfig,\n                codec: 'mp4a.40.' + audioObjectType,\n                originalCodec: 'mp4a.40.' + originalAudioObjectType\n            };\n        }\n    }, {\n        key: '_parseMP3AudioData',\n        value: function _parseMP3AudioData(arrayBuffer, dataOffset, dataSize, requestHeader) {\n            if (dataSize < 4) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid MP3 packet, header missing!');\n                return;\n            }\n\n            var le = this._littleEndian;\n            var array = new Uint8Array(arrayBuffer, dataOffset, dataSize);\n            var result = null;\n\n            if (requestHeader) {\n                if (array[0] !== 0xFF) {\n                    return;\n                }\n                var ver = array[1] >>> 3 & 0x03;\n                var layer = (array[1] & 0x06) >> 1;\n\n                var bitrate_index = (array[2] & 0xF0) >>> 4;\n                var sampling_freq_index = (array[2] & 0x0C) >>> 2;\n\n                var channel_mode = array[3] >>> 6 & 0x03;\n                var channel_count = channel_mode !== 3 ? 2 : 1;\n\n                var sample_rate = 0;\n                var bit_rate = 0;\n                var object_type = 34; // Layer-3, listed in MPEG-4 Audio Object Types\n\n                var codec = 'mp3';\n\n                switch (ver) {\n                    case 0:\n                        // MPEG 2.5\n                        sample_rate = this._mpegAudioV25SampleRateTable[sampling_freq_index];\n                        break;\n                    case 2:\n                        // MPEG 2\n                        sample_rate = this._mpegAudioV20SampleRateTable[sampling_freq_index];\n                        break;\n                    case 3:\n                        // MPEG 1\n                        sample_rate = this._mpegAudioV10SampleRateTable[sampling_freq_index];\n                        break;\n                }\n\n                switch (layer) {\n                    case 1:\n                        // Layer 3\n                        object_type = 34;\n                        if (bitrate_index < this._mpegAudioL3BitRateTable.length) {\n                            bit_rate = this._mpegAudioL3BitRateTable[bitrate_index];\n                        }\n                        break;\n                    case 2:\n                        // Layer 2\n                        object_type = 33;\n                        if (bitrate_index < this._mpegAudioL2BitRateTable.length) {\n                            bit_rate = this._mpegAudioL2BitRateTable[bitrate_index];\n                        }\n                        break;\n                    case 3:\n                        // Layer 1\n                        object_type = 32;\n                        if (bitrate_index < this._mpegAudioL1BitRateTable.length) {\n                            bit_rate = this._mpegAudioL1BitRateTable[bitrate_index];\n                        }\n                        break;\n                }\n\n                result = {\n                    bitRate: bit_rate,\n                    samplingRate: sample_rate,\n                    channelCount: channel_count,\n                    codec: codec,\n                    originalCodec: codec\n                };\n            } else {\n                result = array;\n            }\n\n            return result;\n        }\n    }, {\n        key: '_parseVideoData',\n        value: function _parseVideoData(arrayBuffer, dataOffset, dataSize, tagTimestamp, tagPosition) {\n            if (dataSize <= 1) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid video packet, missing VideoData payload!');\n                return;\n            }\n\n            if (this._hasVideoFlagOverrided === true && this._hasVideo === false) {\n                // If hasVideo: false indicated explicitly in MediaDataSource,\n                // Ignore all the video packets\n                return;\n            }\n\n            var spec = new Uint8Array(arrayBuffer, dataOffset, dataSize)[0];\n\n            var frameType = (spec & 240) >>> 4;\n            var codecId = spec & 15;\n\n            if (codecId !== 7) {\n                this._onError(_demuxErrors2.default.CODEC_UNSUPPORTED, 'Flv: Unsupported codec in video frame: ' + codecId);\n                return;\n            }\n\n            this._parseAVCVideoPacket(arrayBuffer, dataOffset + 1, dataSize - 1, tagTimestamp, tagPosition, frameType);\n        }\n    }, {\n        key: '_parseAVCVideoPacket',\n        value: function _parseAVCVideoPacket(arrayBuffer, dataOffset, dataSize, tagTimestamp, tagPosition, frameType) {\n            if (dataSize < 4) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime');\n                return;\n            }\n\n            var le = this._littleEndian;\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n            var packetType = v.getUint8(0);\n            var cts_unsigned = v.getUint32(0, !le) & 0x00FFFFFF;\n            var cts = cts_unsigned << 8 >> 8; // convert to 24-bit signed int\n\n            if (packetType === 0) {\n                // AVCDecoderConfigurationRecord\n                this._parseAVCDecoderConfigurationRecord(arrayBuffer, dataOffset + 4, dataSize - 4);\n            } else if (packetType === 1) {\n                // One or more Nalus\n                this._parseAVCVideoData(arrayBuffer, dataOffset + 4, dataSize - 4, tagTimestamp, tagPosition, frameType, cts);\n            } else if (packetType === 2) {\n                // empty, AVC end of sequence\n            } else {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid video packet type ' + packetType);\n                return;\n            }\n        }\n    }, {\n        key: '_parseAVCDecoderConfigurationRecord',\n        value: function _parseAVCDecoderConfigurationRecord(arrayBuffer, dataOffset, dataSize) {\n            if (dataSize < 7) {\n                _logger2.default.w(this.TAG, 'Flv: Invalid AVCDecoderConfigurationRecord, lack of data!');\n                return;\n            }\n\n            var meta = this._videoMetadata;\n            var track = this._videoTrack;\n            var le = this._littleEndian;\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n            if (!meta) {\n                if (this._hasVideo === false && this._hasVideoFlagOverrided === false) {\n                    this._hasVideo = true;\n                    this._mediaInfo.hasVideo = true;\n                }\n\n                meta = this._videoMetadata = {};\n                meta.type = 'video';\n                meta.id = track.id;\n                meta.timescale = this._timescale;\n                meta.duration = this._duration;\n            } else {\n                if (typeof meta.avcc !== 'undefined') {\n                    _logger2.default.w(this.TAG, 'Found another AVCDecoderConfigurationRecord!');\n                }\n            }\n\n            var version = v.getUint8(0); // configurationVersion\n            var avcProfile = v.getUint8(1); // avcProfileIndication\n            var profileCompatibility = v.getUint8(2); // profile_compatibility\n            var avcLevel = v.getUint8(3); // AVCLevelIndication\n\n            if (version !== 1 || avcProfile === 0) {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid AVCDecoderConfigurationRecord');\n                return;\n            }\n\n            this._naluLengthSize = (v.getUint8(4) & 3) + 1; // lengthSizeMinusOne\n            if (this._naluLengthSize !== 3 && this._naluLengthSize !== 4) {\n                // holy shit!!!\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Strange NaluLengthSizeMinusOne: ' + (this._naluLengthSize - 1));\n                return;\n            }\n\n            var spsCount = v.getUint8(5) & 31; // numOfSequenceParameterSets\n            if (spsCount === 0) {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid AVCDecoderConfigurationRecord: No SPS');\n                return;\n            } else if (spsCount > 1) {\n                _logger2.default.w(this.TAG, 'Flv: Strange AVCDecoderConfigurationRecord: SPS Count = ' + spsCount);\n            }\n\n            var offset = 6;\n\n            for (var i = 0; i < spsCount; i++) {\n                var len = v.getUint16(offset, !le); // sequenceParameterSetLength\n                offset += 2;\n\n                if (len === 0) {\n                    continue;\n                }\n\n                // Notice: Nalu without startcode header (00 00 00 01)\n                var sps = new Uint8Array(arrayBuffer, dataOffset + offset, len);\n                offset += len;\n\n                var config = _spsParser2.default.parseSPS(sps);\n                if (i !== 0) {\n                    // ignore other sps's config\n                    continue;\n                }\n\n                meta.codecWidth = config.codec_size.width;\n                meta.codecHeight = config.codec_size.height;\n                meta.presentWidth = config.present_size.width;\n                meta.presentHeight = config.present_size.height;\n\n                meta.profile = config.profile_string;\n                meta.level = config.level_string;\n                meta.bitDepth = config.bit_depth;\n                meta.chromaFormat = config.chroma_format;\n                meta.sarRatio = config.sar_ratio;\n                meta.frameRate = config.frame_rate;\n\n                if (config.frame_rate.fixed === false || config.frame_rate.fps_num === 0 || config.frame_rate.fps_den === 0) {\n                    meta.frameRate = this._referenceFrameRate;\n                }\n\n                var fps_den = meta.frameRate.fps_den;\n                var fps_num = meta.frameRate.fps_num;\n                meta.refSampleDuration = meta.timescale * (fps_den / fps_num);\n\n                var codecArray = sps.subarray(1, 4);\n                var codecString = 'avc1.';\n                for (var j = 0; j < 3; j++) {\n                    var h = codecArray[j].toString(16);\n                    if (h.length < 2) {\n                        h = '0' + h;\n                    }\n                    codecString += h;\n                }\n                meta.codec = codecString;\n\n                var mi = this._mediaInfo;\n                mi.width = meta.codecWidth;\n                mi.height = meta.codecHeight;\n                mi.fps = meta.frameRate.fps;\n                mi.profile = meta.profile;\n                mi.level = meta.level;\n                mi.refFrames = config.ref_frames;\n                mi.chromaFormat = config.chroma_format_string;\n                mi.sarNum = meta.sarRatio.width;\n                mi.sarDen = meta.sarRatio.height;\n                mi.videoCodec = codecString;\n\n                if (mi.hasAudio) {\n                    if (mi.audioCodec != null) {\n                        mi.mimeType = 'video/x-flv; codecs=\"' + mi.videoCodec + ',' + mi.audioCodec + '\"';\n                    }\n                } else {\n                    mi.mimeType = 'video/x-flv; codecs=\"' + mi.videoCodec + '\"';\n                }\n                if (mi.isComplete()) {\n                    this._onMediaInfo(mi);\n                }\n            }\n\n            var ppsCount = v.getUint8(offset); // numOfPictureParameterSets\n            if (ppsCount === 0) {\n                this._onError(_demuxErrors2.default.FORMAT_ERROR, 'Flv: Invalid AVCDecoderConfigurationRecord: No PPS');\n                return;\n            } else if (ppsCount > 1) {\n                _logger2.default.w(this.TAG, 'Flv: Strange AVCDecoderConfigurationRecord: PPS Count = ' + ppsCount);\n            }\n\n            offset++;\n\n            for (var _i = 0; _i < ppsCount; _i++) {\n                var _len = v.getUint16(offset, !le); // pictureParameterSetLength\n                offset += 2;\n\n                if (_len === 0) {\n                    continue;\n                }\n\n                // pps is useless for extracting video information\n                offset += _len;\n            }\n\n            meta.avcc = new Uint8Array(dataSize);\n            meta.avcc.set(new Uint8Array(arrayBuffer, dataOffset, dataSize), 0);\n            _logger2.default.v(this.TAG, 'Parsed AVCDecoderConfigurationRecord');\n\n            if (this._isInitialMetadataDispatched()) {\n                // flush parsed frames\n                if (this._dispatch && (this._audioTrack.length || this._videoTrack.length)) {\n                    this._onDataAvailable(this._audioTrack, this._videoTrack);\n                }\n            } else {\n                this._videoInitialMetadataDispatched = true;\n            }\n            // notify new metadata\n            this._dispatch = false;\n            this._onTrackMetadata('video', meta);\n        }\n    }, {\n        key: '_parseAVCVideoData',\n        value: function _parseAVCVideoData(arrayBuffer, dataOffset, dataSize, tagTimestamp, tagPosition, frameType, cts) {\n            var le = this._littleEndian;\n            var v = new DataView(arrayBuffer, dataOffset, dataSize);\n\n            var units = [],\n                length = 0;\n\n            var offset = 0;\n            var lengthSize = this._naluLengthSize;\n            var dts = this._timestampBase + tagTimestamp;\n            var keyframe = frameType === 1; // from FLV Frame Type constants\n\n            while (offset < dataSize) {\n                if (offset + 4 >= dataSize) {\n                    _logger2.default.w(this.TAG, 'Malformed Nalu near timestamp ' + dts + ', offset = ' + offset + ', dataSize = ' + dataSize);\n                    break; // data not enough for next Nalu\n                }\n                // Nalu with length-header (AVC1)\n                var naluSize = v.getUint32(offset, !le); // Big-Endian read\n                if (lengthSize === 3) {\n                    naluSize >>>= 8;\n                }\n                if (naluSize > dataSize - lengthSize) {\n                    _logger2.default.w(this.TAG, 'Malformed Nalus near timestamp ' + dts + ', NaluSize > DataSize!');\n                    return;\n                }\n\n                var unitType = v.getUint8(offset + lengthSize) & 0x1F;\n\n                if (unitType === 5) {\n                    // IDR\n                    keyframe = true;\n                }\n\n                var data = new Uint8Array(arrayBuffer, dataOffset + offset, lengthSize + naluSize);\n                var unit = { type: unitType, data: data };\n                units.push(unit);\n                length += data.byteLength;\n\n                offset += lengthSize + naluSize;\n            }\n\n            if (units.length) {\n                var track = this._videoTrack;\n                var avcSample = {\n                    units: units,\n                    length: length,\n                    isKeyframe: keyframe,\n                    dts: dts,\n                    cts: cts,\n                    pts: dts + cts\n                };\n                if (keyframe) {\n                    avcSample.fileposition = tagPosition;\n                }\n                track.samples.push(avcSample);\n                track.length += length;\n            }\n        }\n    }, {\n        key: 'onTrackMetadata',\n        get: function get() {\n            return this._onTrackMetadata;\n        },\n        set: function set(callback) {\n            this._onTrackMetadata = callback;\n        }\n\n        // prototype: function(mediaInfo: MediaInfo): void\n\n    }, {\n        key: 'onMediaInfo',\n        get: function get() {\n            return this._onMediaInfo;\n        },\n        set: function set(callback) {\n            this._onMediaInfo = callback;\n        }\n    }, {\n        key: 'onMetaDataArrived',\n        get: function get() {\n            return this._onMetaDataArrived;\n        },\n        set: function set(callback) {\n            this._onMetaDataArrived = callback;\n        }\n    }, {\n        key: 'onScriptDataArrived',\n        get: function get() {\n            return this._onScriptDataArrived;\n        },\n        set: function set(callback) {\n            this._onScriptDataArrived = callback;\n        }\n\n        // prototype: function(type: number, info: string): void\n\n    }, {\n        key: 'onError',\n        get: function get() {\n            return this._onError;\n        },\n        set: function set(callback) {\n            this._onError = callback;\n        }\n\n        // prototype: function(videoTrack: any, audioTrack: any): void\n\n    }, {\n        key: 'onDataAvailable',\n        get: function get() {\n            return this._onDataAvailable;\n        },\n        set: function set(callback) {\n            this._onDataAvailable = callback;\n        }\n    }, {\n        key: 'onStreamTime',\n        get: function get() {\n            return this._onStreamTime;\n        },\n        set: function set(callback) {\n            this._onStreamTime = callback;\n        }\n\n        // timestamp base for output samples, must be in milliseconds\n\n    }, {\n        key: 'timestampBase',\n        get: function get() {\n            return this._timestampBase;\n        },\n        set: function set(base) {\n            this._timestampBase = base;\n        }\n    }, {\n        key: 'overridedDuration',\n        get: function get() {\n            return this._duration;\n        }\n\n        // Force-override media duration. Must be in milliseconds, int32\n        ,\n        set: function set(duration) {\n            this._durationOverrided = true;\n            this._duration = duration;\n            this._mediaInfo.duration = duration;\n        }\n\n        // Force-override audio track present flag, boolean\n\n    }, {\n        key: 'overridedHasAudio',\n        set: function set(hasAudio) {\n            this._hasAudioFlagOverrided = true;\n            this._hasAudio = hasAudio;\n            this._mediaInfo.hasAudio = hasAudio;\n        }\n\n        // Force-override video track present flag, boolean\n\n    }, {\n        key: 'overridedHasVideo',\n        set: function set(hasVideo) {\n            this._hasVideoFlagOverrided = true;\n            this._hasVideo = hasVideo;\n            this._mediaInfo.hasVideo = hasVideo;\n        }\n    }], [{\n        key: 'probe',\n        value: function probe(buffer) {\n            var data = new Uint8Array(buffer);\n            var mismatch = { match: false };\n\n            if (data[0] !== 0x46 || data[1] !== 0x4C || data[2] !== 0x56 || data[3] !== 0x01) {\n                return mismatch;\n            }\n\n            var hasAudio = (data[4] & 4) >>> 2 !== 0;\n            var hasVideo = (data[4] & 1) !== 0;\n\n            var offset = ReadBig32(data, 5);\n\n            if (offset < 9) {\n                return mismatch;\n            }\n\n            return {\n                match: true,\n                consumed: offset,\n                dataOffset: offset,\n                hasAudioTrack: hasAudio,\n                hasVideoTrack: hasVideo\n            };\n        }\n    }]);\n\n    return FLVDemuxer;\n}();\n\nexports.default = FLVDemuxer;\n\n},{\"../core/media-info.js\":7,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./amf-parser.js\":15,\"./demux-errors.js\":16,\"./sps-parser.js\":19}],19:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _expGolomb = _dereq_('./exp-golomb.js');\n\nvar _expGolomb2 = _interopRequireDefault(_expGolomb);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar SPSParser = function () {\n    function SPSParser() {\n        _classCallCheck(this, SPSParser);\n    }\n\n    _createClass(SPSParser, null, [{\n        key: '_ebsp2rbsp',\n        value: function _ebsp2rbsp(uint8array) {\n            var src = uint8array;\n            var src_length = src.byteLength;\n            var dst = new Uint8Array(src_length);\n            var dst_idx = 0;\n\n            for (var i = 0; i < src_length; i++) {\n                if (i >= 2) {\n                    // Unescape: Skip 0x03 after 00 00\n                    if (src[i] === 0x03 && src[i - 1] === 0x00 && src[i - 2] === 0x00) {\n                        continue;\n                    }\n                }\n                dst[dst_idx] = src[i];\n                dst_idx++;\n            }\n\n            return new Uint8Array(dst.buffer, 0, dst_idx);\n        }\n    }, {\n        key: 'parseSPS',\n        value: function parseSPS(uint8array) {\n            var rbsp = SPSParser._ebsp2rbsp(uint8array);\n            var gb = new _expGolomb2.default(rbsp);\n\n            gb.readByte();\n            var profile_idc = gb.readByte(); // profile_idc\n            gb.readByte(); // constraint_set_flags[5] + reserved_zero[3]\n            var level_idc = gb.readByte(); // level_idc\n            gb.readUEG(); // seq_parameter_set_id\n\n            var profile_string = SPSParser.getProfileString(profile_idc);\n            var level_string = SPSParser.getLevelString(level_idc);\n            var chroma_format_idc = 1;\n            var chroma_format = 420;\n            var chroma_format_table = [0, 420, 422, 444];\n            var bit_depth = 8;\n\n            if (profile_idc === 100 || profile_idc === 110 || profile_idc === 122 || profile_idc === 244 || profile_idc === 44 || profile_idc === 83 || profile_idc === 86 || profile_idc === 118 || profile_idc === 128 || profile_idc === 138 || profile_idc === 144) {\n\n                chroma_format_idc = gb.readUEG();\n                if (chroma_format_idc === 3) {\n                    gb.readBits(1); // separate_colour_plane_flag\n                }\n                if (chroma_format_idc <= 3) {\n                    chroma_format = chroma_format_table[chroma_format_idc];\n                }\n\n                bit_depth = gb.readUEG() + 8; // bit_depth_luma_minus8\n                gb.readUEG(); // bit_depth_chroma_minus8\n                gb.readBits(1); // qpprime_y_zero_transform_bypass_flag\n                if (gb.readBool()) {\n                    // seq_scaling_matrix_present_flag\n                    var scaling_list_count = chroma_format_idc !== 3 ? 8 : 12;\n                    for (var i = 0; i < scaling_list_count; i++) {\n                        if (gb.readBool()) {\n                            // seq_scaling_list_present_flag\n                            if (i < 6) {\n                                SPSParser._skipScalingList(gb, 16);\n                            } else {\n                                SPSParser._skipScalingList(gb, 64);\n                            }\n                        }\n                    }\n                }\n            }\n            gb.readUEG(); // log2_max_frame_num_minus4\n            var pic_order_cnt_type = gb.readUEG();\n            if (pic_order_cnt_type === 0) {\n                gb.readUEG(); // log2_max_pic_order_cnt_lsb_minus_4\n            } else if (pic_order_cnt_type === 1) {\n                gb.readBits(1); // delta_pic_order_always_zero_flag\n                gb.readSEG(); // offset_for_non_ref_pic\n                gb.readSEG(); // offset_for_top_to_bottom_field\n                var num_ref_frames_in_pic_order_cnt_cycle = gb.readUEG();\n                for (var _i = 0; _i < num_ref_frames_in_pic_order_cnt_cycle; _i++) {\n                    gb.readSEG(); // offset_for_ref_frame\n                }\n            }\n            var ref_frames = gb.readUEG(); // max_num_ref_frames\n            gb.readBits(1); // gaps_in_frame_num_value_allowed_flag\n\n            var pic_width_in_mbs_minus1 = gb.readUEG();\n            var pic_height_in_map_units_minus1 = gb.readUEG();\n\n            var frame_mbs_only_flag = gb.readBits(1);\n            if (frame_mbs_only_flag === 0) {\n                gb.readBits(1); // mb_adaptive_frame_field_flag\n            }\n            gb.readBits(1); // direct_8x8_inference_flag\n\n            var frame_crop_left_offset = 0;\n            var frame_crop_right_offset = 0;\n            var frame_crop_top_offset = 0;\n            var frame_crop_bottom_offset = 0;\n\n            var frame_cropping_flag = gb.readBool();\n            if (frame_cropping_flag) {\n                frame_crop_left_offset = gb.readUEG();\n                frame_crop_right_offset = gb.readUEG();\n                frame_crop_top_offset = gb.readUEG();\n                frame_crop_bottom_offset = gb.readUEG();\n            }\n\n            var sar_width = 1,\n                sar_height = 1;\n            var fps = 0,\n                fps_fixed = true,\n                fps_num = 0,\n                fps_den = 0;\n\n            var vui_parameters_present_flag = gb.readBool();\n            if (vui_parameters_present_flag) {\n                if (gb.readBool()) {\n                    // aspect_ratio_info_present_flag\n                    var aspect_ratio_idc = gb.readByte();\n                    var sar_w_table = [1, 12, 10, 16, 40, 24, 20, 32, 80, 18, 15, 64, 160, 4, 3, 2];\n                    var sar_h_table = [1, 11, 11, 11, 33, 11, 11, 11, 33, 11, 11, 33, 99, 3, 2, 1];\n\n                    if (aspect_ratio_idc > 0 && aspect_ratio_idc < 16) {\n                        sar_width = sar_w_table[aspect_ratio_idc - 1];\n                        sar_height = sar_h_table[aspect_ratio_idc - 1];\n                    } else if (aspect_ratio_idc === 255) {\n                        sar_width = gb.readByte() << 8 | gb.readByte();\n                        sar_height = gb.readByte() << 8 | gb.readByte();\n                    }\n                }\n\n                if (gb.readBool()) {\n                    // overscan_info_present_flag\n                    gb.readBool(); // overscan_appropriate_flag\n                }\n                if (gb.readBool()) {\n                    // video_signal_type_present_flag\n                    gb.readBits(4); // video_format & video_full_range_flag\n                    if (gb.readBool()) {\n                        // colour_description_present_flag\n                        gb.readBits(24); // colour_primaries & transfer_characteristics & matrix_coefficients\n                    }\n                }\n                if (gb.readBool()) {\n                    // chroma_loc_info_present_flag\n                    gb.readUEG(); // chroma_sample_loc_type_top_field\n                    gb.readUEG(); // chroma_sample_loc_type_bottom_field\n                }\n                if (gb.readBool()) {\n                    // timing_info_present_flag\n                    var num_units_in_tick = gb.readBits(32);\n                    var time_scale = gb.readBits(32);\n                    fps_fixed = gb.readBool(); // fixed_frame_rate_flag\n\n                    fps_num = time_scale;\n                    fps_den = num_units_in_tick * 2;\n                    fps = fps_num / fps_den;\n                }\n            }\n\n            var sarScale = 1;\n            if (sar_width !== 1 || sar_height !== 1) {\n                sarScale = sar_width / sar_height;\n            }\n\n            var crop_unit_x = 0,\n                crop_unit_y = 0;\n            if (chroma_format_idc === 0) {\n                crop_unit_x = 1;\n                crop_unit_y = 2 - frame_mbs_only_flag;\n            } else {\n                var sub_wc = chroma_format_idc === 3 ? 1 : 2;\n                var sub_hc = chroma_format_idc === 1 ? 2 : 1;\n                crop_unit_x = sub_wc;\n                crop_unit_y = sub_hc * (2 - frame_mbs_only_flag);\n            }\n\n            var codec_width = (pic_width_in_mbs_minus1 + 1) * 16;\n            var codec_height = (2 - frame_mbs_only_flag) * ((pic_height_in_map_units_minus1 + 1) * 16);\n\n            codec_width -= (frame_crop_left_offset + frame_crop_right_offset) * crop_unit_x;\n            codec_height -= (frame_crop_top_offset + frame_crop_bottom_offset) * crop_unit_y;\n\n            var present_width = Math.ceil(codec_width * sarScale);\n\n            gb.destroy();\n            gb = null;\n\n            return {\n                profile_string: profile_string, // baseline, high, high10, ...\n                level_string: level_string, // 3, 3.1, 4, 4.1, 5, 5.1, ...\n                bit_depth: bit_depth, // 8bit, 10bit, ...\n                ref_frames: ref_frames,\n                chroma_format: chroma_format, // 4:2:0, 4:2:2, ...\n                chroma_format_string: SPSParser.getChromaFormatString(chroma_format),\n\n                frame_rate: {\n                    fixed: fps_fixed,\n                    fps: fps,\n                    fps_den: fps_den,\n                    fps_num: fps_num\n                },\n\n                sar_ratio: {\n                    width: sar_width,\n                    height: sar_height\n                },\n\n                codec_size: {\n                    width: codec_width,\n                    height: codec_height\n                },\n\n                present_size: {\n                    width: present_width,\n                    height: codec_height\n                }\n            };\n        }\n    }, {\n        key: '_skipScalingList',\n        value: function _skipScalingList(gb, count) {\n            var last_scale = 8,\n                next_scale = 8;\n            var delta_scale = 0;\n            for (var i = 0; i < count; i++) {\n                if (next_scale !== 0) {\n                    delta_scale = gb.readSEG();\n                    next_scale = (last_scale + delta_scale + 256) % 256;\n                }\n                last_scale = next_scale === 0 ? last_scale : next_scale;\n            }\n        }\n    }, {\n        key: 'getProfileString',\n        value: function getProfileString(profile_idc) {\n            switch (profile_idc) {\n                case 66:\n                    return 'Baseline';\n                case 77:\n                    return 'Main';\n                case 88:\n                    return 'Extended';\n                case 100:\n                    return 'High';\n                case 110:\n                    return 'High10';\n                case 122:\n                    return 'High422';\n                case 244:\n                    return 'High444';\n                default:\n                    return 'Unknown';\n            }\n        }\n    }, {\n        key: 'getLevelString',\n        value: function getLevelString(level_idc) {\n            return (level_idc / 10).toFixed(1);\n        }\n    }, {\n        key: 'getChromaFormatString',\n        value: function getChromaFormatString(chroma) {\n            switch (chroma) {\n                case 420:\n                    return '4:2:0';\n                case 422:\n                    return '4:2:2';\n                case 444:\n                    return '4:4:4';\n                default:\n                    return 'Unknown';\n            }\n        }\n    }]);\n\n    return SPSParser;\n}();\n\nexports.default = SPSParser;\n\n},{\"./exp-golomb.js\":17}],20:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; /*\r\n                                                                                                                                                                                                                                                                               * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                               *\r\n                                                                                                                                                                                                                                                                               * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                               *\r\n                                                                                                                                                                                                                                                                               * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                               * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                               * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                               *\r\n                                                                                                                                                                                                                                                                               *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                               *\r\n                                                                                                                                                                                                                                                                               * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                               * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                               * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                               * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                               * limitations under the License.\r\n                                                                                                                                                                                                                                                                               */\n\nvar _polyfill = _dereq_('./utils/polyfill.js');\n\nvar _polyfill2 = _interopRequireDefault(_polyfill);\n\nvar _features = _dereq_('./core/features.js');\n\nvar _features2 = _interopRequireDefault(_features);\n\nvar _loader = _dereq_('./io/loader.js');\n\nvar _flvPlayer = _dereq_('./player/flv-player.js');\n\nvar _flvPlayer2 = _interopRequireDefault(_flvPlayer);\n\nvar _nativePlayer = _dereq_('./player/native-player.js');\n\nvar _nativePlayer2 = _interopRequireDefault(_nativePlayer);\n\nvar _playerEvents = _dereq_('./player/player-events.js');\n\nvar _playerEvents2 = _interopRequireDefault(_playerEvents);\n\nvar _playerErrors = _dereq_('./player/player-errors.js');\n\nvar _loggingControl = _dereq_('./utils/logging-control.js');\n\nvar _loggingControl2 = _interopRequireDefault(_loggingControl);\n\nvar _exception = _dereq_('./utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// here are all the interfaces\n\n// install polyfills\n_polyfill2.default.install();\n\n// factory method\nfunction createPlayer(mediaDataSource, optionalConfig) {\n    var mds = mediaDataSource;\n    if (mds == null || (typeof mds === 'undefined' ? 'undefined' : _typeof(mds)) !== 'object') {\n        throw new _exception.InvalidArgumentException('MediaDataSource must be an javascript object!');\n    }\n\n    if (!mds.hasOwnProperty('type')) {\n        throw new _exception.InvalidArgumentException('MediaDataSource must has type field to indicate video file type!');\n    }\n\n    switch (mds.type) {\n        case 'flv':\n            return new _flvPlayer2.default(mds, optionalConfig);\n        default:\n            return new _nativePlayer2.default(mds, optionalConfig);\n    }\n}\n\n// feature detection\nfunction isSupported() {\n    return _features2.default.supportMSEH264Playback();\n}\n\nfunction getFeatureList() {\n    return _features2.default.getFeatureList();\n}\n\n// interfaces\nvar flvjs = {};\n\nflvjs.createPlayer = createPlayer;\nflvjs.isSupported = isSupported;\nflvjs.getFeatureList = getFeatureList;\n\nflvjs.BaseLoader = _loader.BaseLoader;\nflvjs.LoaderStatus = _loader.LoaderStatus;\nflvjs.LoaderErrors = _loader.LoaderErrors;\n\nflvjs.Events = _playerEvents2.default;\nflvjs.ErrorTypes = _playerErrors.ErrorTypes;\nflvjs.ErrorDetails = _playerErrors.ErrorDetails;\n\nflvjs.FlvPlayer = _flvPlayer2.default;\nflvjs.NativePlayer = _nativePlayer2.default;\nflvjs.LoggingControl = _loggingControl2.default;\n\nObject.defineProperty(flvjs, 'version', {\n    enumerable: true,\n    get: function get() {\n        // replaced by browserify-versionify transform\n        return '1.6.1';\n    }\n});\n\nexports.default = flvjs;\n\n},{\"./core/features.js\":6,\"./io/loader.js\":24,\"./player/flv-player.js\":32,\"./player/native-player.js\":33,\"./player/player-errors.js\":34,\"./player/player-events.js\":35,\"./utils/exception.js\":40,\"./utils/logging-control.js\":42,\"./utils/polyfill.js\":43}],21:[function(_dereq_,module,exports){\n'use strict';\n\n// entry/index file\n\n// make it compatible with browserify's umd wrapper\nmodule.exports = _dereq_('./flv.js').default;\n\n},{\"./flv.js\":20}],22:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _browser = _dereq_('../utils/browser.js');\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/* fetch + stream IO loader. Currently working on chrome 43+.\r\n * fetch provides a better alternative http API to XMLHttpRequest\r\n *\r\n * fetch spec   https://fetch.spec.whatwg.org/\r\n * stream spec  https://streams.spec.whatwg.org/\r\n */\nvar FetchStreamLoader = function (_BaseLoader) {\n    _inherits(FetchStreamLoader, _BaseLoader);\n\n    _createClass(FetchStreamLoader, null, [{\n        key: 'isSupported',\n        value: function isSupported() {\n            try {\n                // fetch + stream is broken on Microsoft Edge. Disable before build 15048.\n                // see https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8196907/\n                // Fixed in Jan 10, 2017. Build 15048+ removed from blacklist.\n                var isWorkWellEdge = _browser2.default.msedge && _browser2.default.version.minor >= 15048;\n                var browserNotBlacklisted = _browser2.default.msedge ? isWorkWellEdge : true;\n                return self.fetch && self.ReadableStream && browserNotBlacklisted;\n            } catch (e) {\n                return false;\n            }\n        }\n    }]);\n\n    function FetchStreamLoader(seekHandler, config) {\n        _classCallCheck(this, FetchStreamLoader);\n\n        var _this = _possibleConstructorReturn(this, (FetchStreamLoader.__proto__ || Object.getPrototypeOf(FetchStreamLoader)).call(this, 'fetch-stream-loader'));\n\n        _this.TAG = 'FetchStreamLoader';\n\n        _this._seekHandler = seekHandler;\n        _this._config = config;\n        _this._needStash = true;\n\n        _this._requestAbort = false;\n        _this._contentLength = null;\n        _this._receivedLength = 0;\n        return _this;\n    }\n\n    _createClass(FetchStreamLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this.isWorking()) {\n                this.abort();\n            }\n            _get(FetchStreamLoader.prototype.__proto__ || Object.getPrototypeOf(FetchStreamLoader.prototype), 'destroy', this).call(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(dataSource, range) {\n            var _this2 = this;\n\n            this._dataSource = dataSource;\n            this._range = range;\n\n            var sourceURL = dataSource.url;\n            if (this._config.reuseRedirectedURL && dataSource.redirectedURL != undefined) {\n                sourceURL = dataSource.redirectedURL;\n            }\n\n            var seekConfig = this._seekHandler.getConfig(sourceURL, range);\n\n            var headers = new self.Headers();\n\n            if (_typeof(seekConfig.headers) === 'object') {\n                var configHeaders = seekConfig.headers;\n                for (var key in configHeaders) {\n                    if (configHeaders.hasOwnProperty(key)) {\n                        headers.append(key, configHeaders[key]);\n                    }\n                }\n            }\n\n            var params = {\n                method: 'GET',\n                headers: headers,\n                mode: 'cors',\n                cache: 'default',\n                // The default policy of Fetch API in the whatwg standard\n                // Safari incorrectly indicates 'no-referrer' as default policy, fuck it\n                referrerPolicy: 'no-referrer-when-downgrade'\n            };\n\n            // add additional headers\n            if (_typeof(this._config.headers) === 'object') {\n                for (var _key in this._config.headers) {\n                    headers.append(_key, this._config.headers[_key]);\n                }\n            }\n\n            // cors is enabled by default\n            if (dataSource.cors === false) {\n                // no-cors means 'disregard cors policy', which can only be used in ServiceWorker\n                params.mode = 'same-origin';\n            }\n\n            // withCredentials is disabled by default\n            if (dataSource.withCredentials) {\n                params.credentials = 'include';\n            }\n\n            // referrerPolicy from config\n            if (dataSource.referrerPolicy) {\n                params.referrerPolicy = dataSource.referrerPolicy;\n            }\n\n            // add abort controller, by wmlgl 2019-5-10 12:21:27\n            if (self.AbortController) {\n                this._abortController = new self.AbortController();\n                params.signal = this._abortController.signal;\n            }\n\n            this._status = _loader.LoaderStatus.kConnecting;\n            self.fetch(seekConfig.url, params).then(function (res) {\n                if (_this2._requestAbort) {\n                    _this2._status = _loader.LoaderStatus.kIdle;\n                    res.body.cancel();\n                    return;\n                }\n                if (res.ok && res.status >= 200 && res.status <= 299) {\n                    if (res.url !== seekConfig.url) {\n                        if (_this2._onURLRedirect) {\n                            var redirectedURL = _this2._seekHandler.removeURLParameters(res.url);\n                            _this2._onURLRedirect(redirectedURL);\n                        }\n                    }\n\n                    var lengthHeader = res.headers.get('Content-Length');\n                    if (lengthHeader != null) {\n                        _this2._contentLength = parseInt(lengthHeader);\n                        if (_this2._contentLength !== 0) {\n                            if (_this2._onContentLengthKnown) {\n                                _this2._onContentLengthKnown(_this2._contentLength);\n                            }\n                        }\n                    }\n\n                    return _this2._pump.call(_this2, res.body.getReader());\n                } else {\n                    _this2._status = _loader.LoaderStatus.kError;\n                    if (_this2._onError) {\n                        _this2._onError(_loader.LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: res.status, msg: res.statusText });\n                    } else {\n                        throw new _exception.RuntimeException('FetchStreamLoader: Http code invalid, ' + res.status + ' ' + res.statusText);\n                    }\n                }\n            }).catch(function (e) {\n                if (_this2._abortController && _this2._abortController.signal.aborted) {\n                    return;\n                }\n\n                _this2._status = _loader.LoaderStatus.kError;\n                if (_this2._onError) {\n                    _this2._onError(_loader.LoaderErrors.EXCEPTION, { code: -1, msg: e.message });\n                } else {\n                    throw e;\n                }\n            });\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            this._requestAbort = true;\n\n            if (this._status !== _loader.LoaderStatus.kBuffering || !_browser2.default.chrome) {\n                // Chrome may throw Exception-like things here, avoid using if is buffering\n                if (this._abortController) {\n                    try {\n                        this._abortController.abort();\n                    } catch (e) {\n                        return;\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_pump',\n        value: function _pump(reader) {\n            var _this3 = this;\n\n            // ReadableStreamReader\n            return reader.read().then(function (result) {\n                if (result.done) {\n                    // First check received length\n                    if (_this3._contentLength !== null && _this3._receivedLength < _this3._contentLength) {\n                        // Report Early-EOF\n                        _this3._status = _loader.LoaderStatus.kError;\n                        var type = _loader.LoaderErrors.EARLY_EOF;\n                        var info = { code: -1, msg: 'Fetch stream meet Early-EOF' };\n                        if (_this3._onError) {\n                            _this3._onError(type, info);\n                        } else {\n                            throw new _exception.RuntimeException(info.msg);\n                        }\n                    } else {\n                        // OK. Download complete\n                        _this3._status = _loader.LoaderStatus.kComplete;\n                        if (_this3._onComplete) {\n                            _this3._onComplete(_this3._range.from, _this3._range.from + _this3._receivedLength - 1);\n                        }\n                    }\n                } else {\n                    if (_this3._abortController && _this3._abortController.signal.aborted) {\n                        _this3._status = _loader.LoaderStatus.kComplete;\n                        return;\n                    } else if (_this3._requestAbort === true) {\n                        _this3._status = _loader.LoaderStatus.kComplete;\n                        return reader.cancel();\n                    }\n\n                    _this3._status = _loader.LoaderStatus.kBuffering;\n\n                    var chunk = result.value.buffer;\n                    var byteStart = _this3._range.from + _this3._receivedLength;\n                    _this3._receivedLength += chunk.byteLength;\n\n                    if (_this3._onDataArrival) {\n                        _this3._onDataArrival(chunk, byteStart, _this3._receivedLength);\n                    }\n\n                    _this3._pump(reader);\n                }\n            }).catch(function (e) {\n                if (_this3._abortController && _this3._abortController.signal.aborted) {\n                    _this3._status = _loader.LoaderStatus.kComplete;\n                    return;\n                }\n\n                if (e.code === 11 && _browser2.default.msedge) {\n                    // InvalidStateError on Microsoft Edge\n                    // Workaround: Edge may throw InvalidStateError after ReadableStreamReader.cancel() call\n                    // Ignore the unknown exception.\n                    // Related issue: https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/11265202/\n                    return;\n                }\n\n                _this3._status = _loader.LoaderStatus.kError;\n                var type = 0;\n                var info = null;\n\n                if ((e.code === 19 || e.message === 'network error') && ( // NETWORK_ERR\n                _this3._contentLength === null || _this3._contentLength !== null && _this3._receivedLength < _this3._contentLength)) {\n                    type = _loader.LoaderErrors.EARLY_EOF;\n                    info = { code: e.code, msg: 'Fetch stream meet Early-EOF' };\n                } else {\n                    type = _loader.LoaderErrors.EXCEPTION;\n                    info = { code: e.code, msg: e.message };\n                }\n\n                if (_this3._onError) {\n                    _this3._onError(type, info);\n                } else {\n                    throw new _exception.RuntimeException(info.msg);\n                }\n            });\n        }\n    }]);\n\n    return FetchStreamLoader;\n}(_loader.BaseLoader);\n\nexports.default = FetchStreamLoader;\n\n},{\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],23:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _speedSampler = _dereq_('./speed-sampler.js');\n\nvar _speedSampler2 = _interopRequireDefault(_speedSampler);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _fetchStreamLoader = _dereq_('./fetch-stream-loader.js');\n\nvar _fetchStreamLoader2 = _interopRequireDefault(_fetchStreamLoader);\n\nvar _xhrMozChunkedLoader = _dereq_('./xhr-moz-chunked-loader.js');\n\nvar _xhrMozChunkedLoader2 = _interopRequireDefault(_xhrMozChunkedLoader);\n\nvar _xhrMsstreamLoader = _dereq_('./xhr-msstream-loader.js');\n\nvar _xhrMsstreamLoader2 = _interopRequireDefault(_xhrMsstreamLoader);\n\nvar _xhrRangeLoader = _dereq_('./xhr-range-loader.js');\n\nvar _xhrRangeLoader2 = _interopRequireDefault(_xhrRangeLoader);\n\nvar _websocketLoader = _dereq_('./websocket-loader.js');\n\nvar _websocketLoader2 = _interopRequireDefault(_websocketLoader);\n\nvar _rangeSeekHandler = _dereq_('./range-seek-handler.js');\n\nvar _rangeSeekHandler2 = _interopRequireDefault(_rangeSeekHandler);\n\nvar _paramSeekHandler = _dereq_('./param-seek-handler.js');\n\nvar _paramSeekHandler2 = _interopRequireDefault(_paramSeekHandler);\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/**\r\n * DataSource: {\r\n *     url: string,\r\n *     filesize: number,\r\n *     cors: boolean,\r\n *     withCredentials: boolean\r\n * }\r\n * \r\n */\n\n// Manage IO Loaders\nvar IOController = function () {\n    function IOController(dataSource, config, extraData) {\n        _classCallCheck(this, IOController);\n\n        this.TAG = 'IOController';\n\n        this._config = config;\n        this._extraData = extraData;\n\n        this._stashInitialSize = 1024 * 384; // default initial size: 384KB\n        if (config.stashInitialSize != undefined && config.stashInitialSize > 0) {\n            // apply from config\n            this._stashInitialSize = config.stashInitialSize;\n        }\n\n        this._stashUsed = 0;\n        this._stashSize = this._stashInitialSize;\n        this._bufferSize = 1024 * 1024 * 3; // initial size: 3MB\n        this._stashBuffer = new ArrayBuffer(this._bufferSize);\n        this._stashByteStart = 0;\n        this._enableStash = true;\n        if (config.enableStashBuffer === false) {\n            this._enableStash = false;\n        }\n\n        this._loader = null;\n        this._loaderClass = null;\n        this._seekHandler = null;\n\n        this._dataSource = dataSource;\n        this._isWebSocketURL = /wss?:\\/\\/(.+?)/.test(dataSource.url);\n        this._refTotalLength = dataSource.filesize ? dataSource.filesize : null;\n        this._totalLength = this._refTotalLength;\n        this._fullRequestFlag = false;\n        this._currentRange = null;\n        this._redirectedURL = null;\n\n        this._speedNormalized = 0;\n        this._speedSampler = new _speedSampler2.default();\n        this._speedNormalizeList = [64, 128, 256, 384, 512, 768, 1024, 1536, 2048, 3072, 4096];\n\n        this._isEarlyEofReconnecting = false;\n\n        this._paused = false;\n        this._resumeFrom = 0;\n\n        this._onDataArrival = null;\n        this._onSeeked = null;\n        this._onError = null;\n        this._onComplete = null;\n        this._onRedirect = null;\n        this._onRecoveredEarlyEof = null;\n\n        this._selectSeekHandler();\n        this._selectLoader();\n        this._createLoader();\n    }\n\n    _createClass(IOController, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._loader.isWorking()) {\n                this._loader.abort();\n            }\n            this._loader.destroy();\n            this._loader = null;\n            this._loaderClass = null;\n            this._dataSource = null;\n            this._stashBuffer = null;\n            this._stashUsed = this._stashSize = this._bufferSize = this._stashByteStart = 0;\n            this._currentRange = null;\n            this._speedSampler = null;\n\n            this._isEarlyEofReconnecting = false;\n\n            this._onDataArrival = null;\n            this._onSeeked = null;\n            this._onError = null;\n            this._onComplete = null;\n            this._onRedirect = null;\n            this._onRecoveredEarlyEof = null;\n\n            this._extraData = null;\n        }\n    }, {\n        key: 'isWorking',\n        value: function isWorking() {\n            return this._loader && this._loader.isWorking() && !this._paused;\n        }\n    }, {\n        key: 'isPaused',\n        value: function isPaused() {\n            return this._paused;\n        }\n    }, {\n        key: '_selectSeekHandler',\n        value: function _selectSeekHandler() {\n            var config = this._config;\n\n            if (config.seekType === 'range') {\n                this._seekHandler = new _rangeSeekHandler2.default(this._config.rangeLoadZeroStart);\n            } else if (config.seekType === 'param') {\n                var paramStart = config.seekParamStart || 'bstart';\n                var paramEnd = config.seekParamEnd || 'bend';\n\n                this._seekHandler = new _paramSeekHandler2.default(paramStart, paramEnd);\n            } else if (config.seekType === 'custom') {\n                if (typeof config.customSeekHandler !== 'function') {\n                    throw new _exception.InvalidArgumentException('Custom seekType specified in config but invalid customSeekHandler!');\n                }\n                this._seekHandler = new config.customSeekHandler();\n            } else {\n                throw new _exception.InvalidArgumentException('Invalid seekType in config: ' + config.seekType);\n            }\n        }\n    }, {\n        key: '_selectLoader',\n        value: function _selectLoader() {\n            if (this._config.customLoader != null) {\n                this._loaderClass = this._config.customLoader;\n            } else if (this._isWebSocketURL) {\n                this._loaderClass = _websocketLoader2.default;\n            } else if (_fetchStreamLoader2.default.isSupported()) {\n                this._loaderClass = _fetchStreamLoader2.default;\n            } else if (_xhrMozChunkedLoader2.default.isSupported()) {\n                this._loaderClass = _xhrMozChunkedLoader2.default;\n            } else if (_xhrRangeLoader2.default.isSupported()) {\n                this._loaderClass = _xhrRangeLoader2.default;\n            } else {\n                throw new _exception.RuntimeException('Your browser doesn\\'t support xhr with arraybuffer responseType!');\n            }\n        }\n    }, {\n        key: '_createLoader',\n        value: function _createLoader() {\n            this._loader = new this._loaderClass(this._seekHandler, this._config);\n            if (this._loader.needStashBuffer === false) {\n                this._enableStash = false;\n            }\n            this._loader.onContentLengthKnown = this._onContentLengthKnown.bind(this);\n            this._loader.onURLRedirect = this._onURLRedirect.bind(this);\n            this._loader.onDataArrival = this._onLoaderChunkArrival.bind(this);\n            this._loader.onComplete = this._onLoaderComplete.bind(this);\n            this._loader.onError = this._onLoaderError.bind(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(optionalFrom) {\n            this._currentRange = { from: 0, to: -1 };\n            if (optionalFrom) {\n                this._currentRange.from = optionalFrom;\n            }\n\n            this._speedSampler.reset();\n            if (!optionalFrom) {\n                this._fullRequestFlag = true;\n            }\n\n            this._loader.open(this._dataSource, Object.assign({}, this._currentRange));\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            this._loader.abort();\n\n            if (this._paused) {\n                this._paused = false;\n                this._resumeFrom = 0;\n            }\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            if (this.isWorking()) {\n                this._loader.abort();\n\n                if (this._stashUsed !== 0) {\n                    this._resumeFrom = this._stashByteStart;\n                    this._currentRange.to = this._stashByteStart - 1;\n                } else {\n                    this._resumeFrom = this._currentRange.to + 1;\n                }\n                this._stashUsed = 0;\n                this._stashByteStart = 0;\n                this._paused = true;\n            }\n        }\n    }, {\n        key: 'resume',\n        value: function resume() {\n            if (this._paused) {\n                this._paused = false;\n                var bytes = this._resumeFrom;\n                this._resumeFrom = 0;\n                this._internalSeek(bytes, true);\n            }\n        }\n    }, {\n        key: 'seek',\n        value: function seek(bytes) {\n            this._paused = false;\n            this._stashUsed = 0;\n            this._stashByteStart = 0;\n            this._internalSeek(bytes, true);\n        }\n\n        /**\r\n         * When seeking request is from media seeking, unconsumed stash data should be dropped\r\n         * However, stash data shouldn't be dropped if seeking requested from http reconnection\r\n         *\r\n         * @dropUnconsumed: Ignore and discard all unconsumed data in stash buffer\r\n         */\n\n    }, {\n        key: '_internalSeek',\n        value: function _internalSeek(bytes, dropUnconsumed) {\n            if (this._loader.isWorking()) {\n                this._loader.abort();\n            }\n\n            // dispatch & flush stash buffer before seek\n            this._flushStashBuffer(dropUnconsumed);\n\n            this._loader.destroy();\n            this._loader = null;\n\n            var requestRange = { from: bytes, to: -1 };\n            this._currentRange = { from: requestRange.from, to: -1 };\n\n            this._speedSampler.reset();\n            this._stashSize = this._stashInitialSize;\n            this._createLoader();\n            this._loader.open(this._dataSource, requestRange);\n\n            if (this._onSeeked) {\n                this._onSeeked();\n            }\n        }\n    }, {\n        key: 'updateUrl',\n        value: function updateUrl(url) {\n            if (!url || typeof url !== 'string' || url.length === 0) {\n                throw new _exception.InvalidArgumentException('Url must be a non-empty string!');\n            }\n\n            this._dataSource.url = url;\n\n            // TODO: replace with new url\n        }\n    }, {\n        key: '_expandBuffer',\n        value: function _expandBuffer(expectedBytes) {\n            var bufferNewSize = this._stashSize;\n            while (bufferNewSize + 1024 * 1024 * 1 < expectedBytes) {\n                bufferNewSize *= 2;\n            }\n\n            bufferNewSize += 1024 * 1024 * 1; // bufferSize = stashSize + 1MB\n            if (bufferNewSize === this._bufferSize) {\n                return;\n            }\n\n            var newBuffer = new ArrayBuffer(bufferNewSize);\n\n            if (this._stashUsed > 0) {\n                // copy existing data into new buffer\n                var stashOldArray = new Uint8Array(this._stashBuffer, 0, this._stashUsed);\n                var stashNewArray = new Uint8Array(newBuffer, 0, bufferNewSize);\n                stashNewArray.set(stashOldArray, 0);\n            }\n\n            this._stashBuffer = newBuffer;\n            this._bufferSize = bufferNewSize;\n        }\n    }, {\n        key: '_normalizeSpeed',\n        value: function _normalizeSpeed(input) {\n            var list = this._speedNormalizeList;\n            var last = list.length - 1;\n            var mid = 0;\n            var lbound = 0;\n            var ubound = last;\n\n            if (input < list[0]) {\n                return list[0];\n            }\n\n            // binary search\n            while (lbound <= ubound) {\n                mid = lbound + Math.floor((ubound - lbound) / 2);\n                if (mid === last || input >= list[mid] && input < list[mid + 1]) {\n                    return list[mid];\n                } else if (list[mid] < input) {\n                    lbound = mid + 1;\n                } else {\n                    ubound = mid - 1;\n                }\n            }\n        }\n    }, {\n        key: '_adjustStashSize',\n        value: function _adjustStashSize(normalized) {\n            var stashSizeKB = 0;\n\n            if (this._config.isLive) {\n                // live stream: always use single normalized speed for size of stashSizeKB\n                stashSizeKB = normalized;\n            } else {\n                if (normalized < 512) {\n                    stashSizeKB = normalized;\n                } else if (normalized >= 512 && normalized <= 1024) {\n                    stashSizeKB = Math.floor(normalized * 1.5);\n                } else {\n                    stashSizeKB = normalized * 2;\n                }\n            }\n\n            if (stashSizeKB > 8192) {\n                stashSizeKB = 8192;\n            }\n\n            var bufferSize = stashSizeKB * 1024 + 1024 * 1024 * 1; // stashSize + 1MB\n            if (this._bufferSize < bufferSize) {\n                this._expandBuffer(bufferSize);\n            }\n            this._stashSize = stashSizeKB * 1024;\n        }\n    }, {\n        key: '_dispatchChunks',\n        value: function _dispatchChunks(chunks, byteStart) {\n            this._currentRange.to = byteStart + chunks.byteLength - 1;\n            return this._onDataArrival(chunks, byteStart);\n        }\n    }, {\n        key: '_onURLRedirect',\n        value: function _onURLRedirect(redirectedURL) {\n            this._redirectedURL = redirectedURL;\n            if (this._onRedirect) {\n                this._onRedirect(redirectedURL);\n            }\n        }\n    }, {\n        key: '_onContentLengthKnown',\n        value: function _onContentLengthKnown(contentLength) {\n            if (contentLength && this._fullRequestFlag) {\n                this._totalLength = contentLength;\n                this._fullRequestFlag = false;\n            }\n        }\n    }, {\n        key: '_onLoaderChunkArrival',\n        value: function _onLoaderChunkArrival(chunk, byteStart, receivedLength) {\n            if (!this._onDataArrival) {\n                throw new _exception.IllegalStateException('IOController: No existing consumer (onDataArrival) callback!');\n            }\n            if (this._paused) {\n                return;\n            }\n            if (this._isEarlyEofReconnecting) {\n                // Auto-reconnect for EarlyEof succeed, notify to upper-layer by callback\n                this._isEarlyEofReconnecting = false;\n                if (this._onRecoveredEarlyEof) {\n                    this._onRecoveredEarlyEof();\n                }\n            }\n\n            this._speedSampler.addBytes(chunk.byteLength);\n\n            // adjust stash buffer size according to network speed dynamically\n            var KBps = this._speedSampler.lastSecondKBps;\n            if (KBps !== 0) {\n                var normalized = this._normalizeSpeed(KBps);\n                if (this._speedNormalized !== normalized) {\n                    this._speedNormalized = normalized;\n                    this._adjustStashSize(normalized);\n                }\n            }\n\n            if (!this._enableStash) {\n                // disable stash\n                if (this._stashUsed === 0) {\n                    // dispatch chunk directly to consumer;\n                    // check ret value (consumed bytes) and stash unconsumed to stashBuffer\n                    var consumed = this._dispatchChunks(chunk, byteStart);\n                    if (consumed < chunk.byteLength) {\n                        // unconsumed data remain.\n                        var remain = chunk.byteLength - consumed;\n                        if (remain > this._bufferSize) {\n                            this._expandBuffer(remain);\n                        }\n                        var stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                        stashArray.set(new Uint8Array(chunk, consumed), 0);\n                        this._stashUsed += remain;\n                        this._stashByteStart = byteStart + consumed;\n                    }\n                } else {\n                    // else: Merge chunk into stashBuffer, and dispatch stashBuffer to consumer.\n                    if (this._stashUsed + chunk.byteLength > this._bufferSize) {\n                        this._expandBuffer(this._stashUsed + chunk.byteLength);\n                    }\n                    var _stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                    _stashArray.set(new Uint8Array(chunk), this._stashUsed);\n                    this._stashUsed += chunk.byteLength;\n                    var _consumed = this._dispatchChunks(this._stashBuffer.slice(0, this._stashUsed), this._stashByteStart);\n                    if (_consumed < this._stashUsed && _consumed > 0) {\n                        // unconsumed data remain\n                        var remainArray = new Uint8Array(this._stashBuffer, _consumed);\n                        _stashArray.set(remainArray, 0);\n                    }\n                    this._stashUsed -= _consumed;\n                    this._stashByteStart += _consumed;\n                }\n            } else {\n                // enable stash\n                if (this._stashUsed === 0 && this._stashByteStart === 0) {\n                    // seeked? or init chunk?\n                    // This is the first chunk after seek action\n                    this._stashByteStart = byteStart;\n                }\n                if (this._stashUsed + chunk.byteLength <= this._stashSize) {\n                    // just stash\n                    var _stashArray2 = new Uint8Array(this._stashBuffer, 0, this._stashSize);\n                    _stashArray2.set(new Uint8Array(chunk), this._stashUsed);\n                    this._stashUsed += chunk.byteLength;\n                } else {\n                    // stashUsed + chunkSize > stashSize, size limit exceeded\n                    var _stashArray3 = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                    if (this._stashUsed > 0) {\n                        // There're stash datas in buffer\n                        // dispatch the whole stashBuffer, and stash remain data\n                        // then append chunk to stashBuffer (stash)\n                        var buffer = this._stashBuffer.slice(0, this._stashUsed);\n                        var _consumed2 = this._dispatchChunks(buffer, this._stashByteStart);\n                        if (_consumed2 < buffer.byteLength) {\n                            if (_consumed2 > 0) {\n                                var _remainArray = new Uint8Array(buffer, _consumed2);\n                                _stashArray3.set(_remainArray, 0);\n                                this._stashUsed = _remainArray.byteLength;\n                                this._stashByteStart += _consumed2;\n                            }\n                        } else {\n                            this._stashUsed = 0;\n                            this._stashByteStart += _consumed2;\n                        }\n                        if (this._stashUsed + chunk.byteLength > this._bufferSize) {\n                            this._expandBuffer(this._stashUsed + chunk.byteLength);\n                            _stashArray3 = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                        }\n                        _stashArray3.set(new Uint8Array(chunk), this._stashUsed);\n                        this._stashUsed += chunk.byteLength;\n                    } else {\n                        // stash buffer empty, but chunkSize > stashSize (oh, holy shit)\n                        // dispatch chunk directly and stash remain data\n                        var _consumed3 = this._dispatchChunks(chunk, byteStart);\n                        if (_consumed3 < chunk.byteLength) {\n                            var _remain = chunk.byteLength - _consumed3;\n                            if (_remain > this._bufferSize) {\n                                this._expandBuffer(_remain);\n                                _stashArray3 = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                            }\n                            _stashArray3.set(new Uint8Array(chunk, _consumed3), 0);\n                            this._stashUsed += _remain;\n                            this._stashByteStart = byteStart + _consumed3;\n                        }\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_flushStashBuffer',\n        value: function _flushStashBuffer(dropUnconsumed) {\n            if (this._stashUsed > 0) {\n                var buffer = this._stashBuffer.slice(0, this._stashUsed);\n                var consumed = this._dispatchChunks(buffer, this._stashByteStart);\n                var remain = buffer.byteLength - consumed;\n\n                if (consumed < buffer.byteLength) {\n                    if (dropUnconsumed) {\n                        _logger2.default.w(this.TAG, remain + ' bytes unconsumed data remain when flush buffer, dropped');\n                    } else {\n                        if (consumed > 0) {\n                            var stashArray = new Uint8Array(this._stashBuffer, 0, this._bufferSize);\n                            var remainArray = new Uint8Array(buffer, consumed);\n                            stashArray.set(remainArray, 0);\n                            this._stashUsed = remainArray.byteLength;\n                            this._stashByteStart += consumed;\n                        }\n                        return 0;\n                    }\n                }\n                this._stashUsed = 0;\n                this._stashByteStart = 0;\n                return remain;\n            }\n            return 0;\n        }\n    }, {\n        key: '_onLoaderComplete',\n        value: function _onLoaderComplete(from, to) {\n            // Force-flush stash buffer, and drop unconsumed data\n            this._flushStashBuffer(true);\n\n            if (this._onComplete) {\n                this._onComplete(this._extraData);\n            }\n        }\n    }, {\n        key: '_onLoaderError',\n        value: function _onLoaderError(type, data) {\n            _logger2.default.e(this.TAG, 'Loader error, code = ' + data.code + ', msg = ' + data.msg);\n\n            this._flushStashBuffer(false);\n\n            if (this._isEarlyEofReconnecting) {\n                // Auto-reconnect for EarlyEof failed, throw UnrecoverableEarlyEof error to upper-layer\n                this._isEarlyEofReconnecting = false;\n                type = _loader.LoaderErrors.UNRECOVERABLE_EARLY_EOF;\n            }\n\n            switch (type) {\n                case _loader.LoaderErrors.EARLY_EOF:\n                    {\n                        if (!this._config.isLive) {\n                            // Do internal http reconnect if not live stream\n                            if (this._totalLength) {\n                                var nextFrom = this._currentRange.to + 1;\n                                if (nextFrom < this._totalLength) {\n                                    _logger2.default.w(this.TAG, 'Connection lost, trying reconnect...');\n                                    this._isEarlyEofReconnecting = true;\n                                    this._internalSeek(nextFrom, false);\n                                }\n                                return;\n                            }\n                            // else: We don't know totalLength, throw UnrecoverableEarlyEof\n                        }\n                        // live stream: throw UnrecoverableEarlyEof error to upper-layer\n                        type = _loader.LoaderErrors.UNRECOVERABLE_EARLY_EOF;\n                        break;\n                    }\n                case _loader.LoaderErrors.UNRECOVERABLE_EARLY_EOF:\n                case _loader.LoaderErrors.CONNECTING_TIMEOUT:\n                case _loader.LoaderErrors.HTTP_STATUS_CODE_INVALID:\n                case _loader.LoaderErrors.EXCEPTION:\n                    break;\n            }\n\n            if (this._onError) {\n                this._onError(type, data);\n            } else {\n                throw new _exception.RuntimeException('IOException: ' + data.msg);\n            }\n        }\n    }, {\n        key: 'status',\n        get: function get() {\n            return this._loader.status;\n        }\n    }, {\n        key: 'extraData',\n        get: function get() {\n            return this._extraData;\n        },\n        set: function set(data) {\n            this._extraData = data;\n        }\n\n        // prototype: function onDataArrival(chunks: ArrayBuffer, byteStart: number): number\n\n    }, {\n        key: 'onDataArrival',\n        get: function get() {\n            return this._onDataArrival;\n        },\n        set: function set(callback) {\n            this._onDataArrival = callback;\n        }\n    }, {\n        key: 'onSeeked',\n        get: function get() {\n            return this._onSeeked;\n        },\n        set: function set(callback) {\n            this._onSeeked = callback;\n        }\n\n        // prototype: function onError(type: number, info: {code: number, msg: string}): void\n\n    }, {\n        key: 'onError',\n        get: function get() {\n            return this._onError;\n        },\n        set: function set(callback) {\n            this._onError = callback;\n        }\n    }, {\n        key: 'onComplete',\n        get: function get() {\n            return this._onComplete;\n        },\n        set: function set(callback) {\n            this._onComplete = callback;\n        }\n    }, {\n        key: 'onRedirect',\n        get: function get() {\n            return this._onRedirect;\n        },\n        set: function set(callback) {\n            this._onRedirect = callback;\n        }\n    }, {\n        key: 'onRecoveredEarlyEof',\n        get: function get() {\n            return this._onRecoveredEarlyEof;\n        },\n        set: function set(callback) {\n            this._onRecoveredEarlyEof = callback;\n        }\n    }, {\n        key: 'currentURL',\n        get: function get() {\n            return this._dataSource.url;\n        }\n    }, {\n        key: 'hasRedirect',\n        get: function get() {\n            return this._redirectedURL != null || this._dataSource.redirectedURL != undefined;\n        }\n    }, {\n        key: 'currentRedirectedURL',\n        get: function get() {\n            return this._redirectedURL || this._dataSource.redirectedURL;\n        }\n\n        // in KB/s\n\n    }, {\n        key: 'currentSpeed',\n        get: function get() {\n            if (this._loaderClass === _xhrRangeLoader2.default) {\n                // SpeedSampler is inaccuracy if loader is RangeLoader\n                return this._loader.currentSpeed;\n            }\n            return this._speedSampler.lastSecondKBps;\n        }\n    }, {\n        key: 'loaderType',\n        get: function get() {\n            return this._loader.type;\n        }\n    }]);\n\n    return IOController;\n}();\n\nexports.default = IOController;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./fetch-stream-loader.js\":22,\"./loader.js\":24,\"./param-seek-handler.js\":25,\"./range-seek-handler.js\":26,\"./speed-sampler.js\":27,\"./websocket-loader.js\":28,\"./xhr-moz-chunked-loader.js\":29,\"./xhr-msstream-loader.js\":30,\"./xhr-range-loader.js\":31}],24:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.BaseLoader = exports.LoaderErrors = exports.LoaderStatus = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar LoaderStatus = exports.LoaderStatus = {\n    kIdle: 0,\n    kConnecting: 1,\n    kBuffering: 2,\n    kError: 3,\n    kComplete: 4\n};\n\nvar LoaderErrors = exports.LoaderErrors = {\n    OK: 'OK',\n    EXCEPTION: 'Exception',\n    HTTP_STATUS_CODE_INVALID: 'HttpStatusCodeInvalid',\n    CONNECTING_TIMEOUT: 'ConnectingTimeout',\n    EARLY_EOF: 'EarlyEof',\n    UNRECOVERABLE_EARLY_EOF: 'UnrecoverableEarlyEof'\n};\n\n/* Loader has callbacks which have following prototypes:\r\n *     function onContentLengthKnown(contentLength: number): void\r\n *     function onURLRedirect(url: string): void\r\n *     function onDataArrival(chunk: ArrayBuffer, byteStart: number, receivedLength: number): void\r\n *     function onError(errorType: number, errorInfo: {code: number, msg: string}): void\r\n *     function onComplete(rangeFrom: number, rangeTo: number): void\r\n */\n\nvar BaseLoader = exports.BaseLoader = function () {\n    function BaseLoader(typeName) {\n        _classCallCheck(this, BaseLoader);\n\n        this._type = typeName || 'undefined';\n        this._status = LoaderStatus.kIdle;\n        this._needStash = false;\n        // callbacks\n        this._onContentLengthKnown = null;\n        this._onURLRedirect = null;\n        this._onDataArrival = null;\n        this._onError = null;\n        this._onComplete = null;\n    }\n\n    _createClass(BaseLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._status = LoaderStatus.kIdle;\n            this._onContentLengthKnown = null;\n            this._onURLRedirect = null;\n            this._onDataArrival = null;\n            this._onError = null;\n            this._onComplete = null;\n        }\n    }, {\n        key: 'isWorking',\n        value: function isWorking() {\n            return this._status === LoaderStatus.kConnecting || this._status === LoaderStatus.kBuffering;\n        }\n    }, {\n        key: 'open',\n\n\n        // pure virtual\n        value: function open(dataSource, range) {\n            throw new _exception.NotImplementedException('Unimplemented abstract function!');\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            throw new _exception.NotImplementedException('Unimplemented abstract function!');\n        }\n    }, {\n        key: 'type',\n        get: function get() {\n            return this._type;\n        }\n    }, {\n        key: 'status',\n        get: function get() {\n            return this._status;\n        }\n    }, {\n        key: 'needStashBuffer',\n        get: function get() {\n            return this._needStash;\n        }\n    }, {\n        key: 'onContentLengthKnown',\n        get: function get() {\n            return this._onContentLengthKnown;\n        },\n        set: function set(callback) {\n            this._onContentLengthKnown = callback;\n        }\n    }, {\n        key: 'onURLRedirect',\n        get: function get() {\n            return this._onURLRedirect;\n        },\n        set: function set(callback) {\n            this._onURLRedirect = callback;\n        }\n    }, {\n        key: 'onDataArrival',\n        get: function get() {\n            return this._onDataArrival;\n        },\n        set: function set(callback) {\n            this._onDataArrival = callback;\n        }\n    }, {\n        key: 'onError',\n        get: function get() {\n            return this._onError;\n        },\n        set: function set(callback) {\n            this._onError = callback;\n        }\n    }, {\n        key: 'onComplete',\n        get: function get() {\n            return this._onComplete;\n        },\n        set: function set(callback) {\n            this._onComplete = callback;\n        }\n    }]);\n\n    return BaseLoader;\n}();\n\n},{\"../utils/exception.js\":40}],25:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar ParamSeekHandler = function () {\n    function ParamSeekHandler(paramStart, paramEnd) {\n        _classCallCheck(this, ParamSeekHandler);\n\n        this._startName = paramStart;\n        this._endName = paramEnd;\n    }\n\n    _createClass(ParamSeekHandler, [{\n        key: 'getConfig',\n        value: function getConfig(baseUrl, range) {\n            var url = baseUrl;\n\n            if (range.from !== 0 || range.to !== -1) {\n                var needAnd = true;\n                if (url.indexOf('?') === -1) {\n                    url += '?';\n                    needAnd = false;\n                }\n\n                if (needAnd) {\n                    url += '&';\n                }\n\n                url += this._startName + '=' + range.from.toString();\n\n                if (range.to !== -1) {\n                    url += '&' + this._endName + '=' + range.to.toString();\n                }\n            }\n\n            return {\n                url: url,\n                headers: {}\n            };\n        }\n    }, {\n        key: 'removeURLParameters',\n        value: function removeURLParameters(seekedURL) {\n            var baseURL = seekedURL.split('?')[0];\n            var params = undefined;\n\n            var queryIndex = seekedURL.indexOf('?');\n            if (queryIndex !== -1) {\n                params = seekedURL.substring(queryIndex + 1);\n            }\n\n            var resultParams = '';\n\n            if (params != undefined && params.length > 0) {\n                var pairs = params.split('&');\n\n                for (var i = 0; i < pairs.length; i++) {\n                    var pair = pairs[i].split('=');\n                    var requireAnd = i > 0;\n\n                    if (pair[0] !== this._startName && pair[0] !== this._endName) {\n                        if (requireAnd) {\n                            resultParams += '&';\n                        }\n                        resultParams += pairs[i];\n                    }\n                }\n            }\n\n            return resultParams.length === 0 ? baseURL : baseURL + '?' + resultParams;\n        }\n    }]);\n\n    return ParamSeekHandler;\n}();\n\nexports.default = ParamSeekHandler;\n\n},{}],26:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar RangeSeekHandler = function () {\n    function RangeSeekHandler(zeroStart) {\n        _classCallCheck(this, RangeSeekHandler);\n\n        this._zeroStart = zeroStart || false;\n    }\n\n    _createClass(RangeSeekHandler, [{\n        key: 'getConfig',\n        value: function getConfig(url, range) {\n            var headers = {};\n\n            if (range.from !== 0 || range.to !== -1) {\n                var param = void 0;\n                if (range.to !== -1) {\n                    param = 'bytes=' + range.from.toString() + '-' + range.to.toString();\n                } else {\n                    param = 'bytes=' + range.from.toString() + '-';\n                }\n                headers['Range'] = param;\n            } else if (this._zeroStart) {\n                headers['Range'] = 'bytes=0-';\n            }\n\n            return {\n                url: url,\n                headers: headers\n            };\n        }\n    }, {\n        key: 'removeURLParameters',\n        value: function removeURLParameters(seekedURL) {\n            return seekedURL;\n        }\n    }]);\n\n    return RangeSeekHandler;\n}();\n\nexports.default = RangeSeekHandler;\n\n},{}],27:[function(_dereq_,module,exports){\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n// Utility class to calculate realtime network I/O speed\nvar SpeedSampler = function () {\n    function SpeedSampler() {\n        _classCallCheck(this, SpeedSampler);\n\n        // milliseconds\n        this._firstCheckpoint = 0;\n        this._lastCheckpoint = 0;\n        this._intervalBytes = 0;\n        this._totalBytes = 0;\n        this._lastSecondBytes = 0;\n\n        // compatibility detection\n        if (self.performance && self.performance.now) {\n            this._now = self.performance.now.bind(self.performance);\n        } else {\n            this._now = Date.now;\n        }\n    }\n\n    _createClass(SpeedSampler, [{\n        key: \"reset\",\n        value: function reset() {\n            this._firstCheckpoint = this._lastCheckpoint = 0;\n            this._totalBytes = this._intervalBytes = 0;\n            this._lastSecondBytes = 0;\n        }\n    }, {\n        key: \"addBytes\",\n        value: function addBytes(bytes) {\n            if (this._firstCheckpoint === 0) {\n                this._firstCheckpoint = this._now();\n                this._lastCheckpoint = this._firstCheckpoint;\n                this._intervalBytes += bytes;\n                this._totalBytes += bytes;\n            } else if (this._now() - this._lastCheckpoint < 1000) {\n                this._intervalBytes += bytes;\n                this._totalBytes += bytes;\n            } else {\n                // duration >= 1000\n                this._lastSecondBytes = this._intervalBytes;\n                this._intervalBytes = bytes;\n                this._totalBytes += bytes;\n                this._lastCheckpoint = this._now();\n            }\n        }\n    }, {\n        key: \"currentKBps\",\n        get: function get() {\n            this.addBytes(0);\n\n            var durationSeconds = (this._now() - this._lastCheckpoint) / 1000;\n            if (durationSeconds == 0) durationSeconds = 1;\n            return this._intervalBytes / durationSeconds / 1024;\n        }\n    }, {\n        key: \"lastSecondKBps\",\n        get: function get() {\n            this.addBytes(0);\n\n            if (this._lastSecondBytes !== 0) {\n                return this._lastSecondBytes / 1024;\n            } else {\n                // lastSecondBytes === 0\n                if (this._now() - this._lastCheckpoint >= 500) {\n                    // if time interval since last checkpoint has exceeded 500ms\n                    // the speed is nearly accurate\n                    return this.currentKBps;\n                } else {\n                    // We don't know\n                    return 0;\n                }\n            }\n        }\n    }, {\n        key: \"averageKBps\",\n        get: function get() {\n            var durationSeconds = (this._now() - this._firstCheckpoint) / 1000;\n            return this._totalBytes / durationSeconds / 1024;\n        }\n    }]);\n\n    return SpeedSampler;\n}();\n\nexports.default = SpeedSampler;\n\n},{}],28:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n// For FLV over WebSocket live stream\nvar WebSocketLoader = function (_BaseLoader) {\n    _inherits(WebSocketLoader, _BaseLoader);\n\n    _createClass(WebSocketLoader, null, [{\n        key: 'isSupported',\n        value: function isSupported() {\n            try {\n                return typeof self.WebSocket !== 'undefined';\n            } catch (e) {\n                return false;\n            }\n        }\n    }]);\n\n    function WebSocketLoader() {\n        _classCallCheck(this, WebSocketLoader);\n\n        var _this = _possibleConstructorReturn(this, (WebSocketLoader.__proto__ || Object.getPrototypeOf(WebSocketLoader)).call(this, 'websocket-loader'));\n\n        _this.TAG = 'WebSocketLoader';\n\n        _this._needStash = true;\n\n        _this._ws = null;\n        _this._requestAbort = false;\n        _this._receivedLength = 0;\n        return _this;\n    }\n\n    _createClass(WebSocketLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._ws) {\n                this.abort();\n            }\n            _get(WebSocketLoader.prototype.__proto__ || Object.getPrototypeOf(WebSocketLoader.prototype), 'destroy', this).call(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(dataSource) {\n            try {\n                var ws = this._ws = new self.WebSocket(dataSource.url);\n                ws.binaryType = 'arraybuffer';\n                ws.onopen = this._onWebSocketOpen.bind(this);\n                ws.onclose = this._onWebSocketClose.bind(this);\n                ws.onmessage = this._onWebSocketMessage.bind(this);\n                ws.onerror = this._onWebSocketError.bind(this);\n\n                this._status = _loader.LoaderStatus.kConnecting;\n            } catch (e) {\n                this._status = _loader.LoaderStatus.kError;\n\n                var info = { code: e.code, msg: e.message };\n\n                if (this._onError) {\n                    this._onError(_loader.LoaderErrors.EXCEPTION, info);\n                } else {\n                    throw new _exception.RuntimeException(info.msg);\n                }\n            }\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            var ws = this._ws;\n            if (ws && (ws.readyState === 0 || ws.readyState === 1)) {\n                // CONNECTING || OPEN\n                this._requestAbort = true;\n                ws.close();\n            }\n\n            this._ws = null;\n            this._status = _loader.LoaderStatus.kComplete;\n        }\n    }, {\n        key: '_onWebSocketOpen',\n        value: function _onWebSocketOpen(e) {\n            this._status = _loader.LoaderStatus.kBuffering;\n        }\n    }, {\n        key: '_onWebSocketClose',\n        value: function _onWebSocketClose(e) {\n            if (this._requestAbort === true) {\n                this._requestAbort = false;\n                return;\n            }\n\n            this._status = _loader.LoaderStatus.kComplete;\n\n            if (this._onComplete) {\n                this._onComplete(0, this._receivedLength - 1);\n            }\n        }\n    }, {\n        key: '_onWebSocketMessage',\n        value: function _onWebSocketMessage(e) {\n            var _this2 = this;\n\n            if (e.data instanceof ArrayBuffer) {\n                this._dispatchArrayBuffer(e.data);\n            } else if (e.data instanceof Blob) {\n                var reader = new FileReader();\n                reader.onload = function () {\n                    _this2._dispatchArrayBuffer(reader.result);\n                };\n                reader.readAsArrayBuffer(e.data);\n            } else {\n                this._status = _loader.LoaderStatus.kError;\n                var info = { code: -1, msg: 'Unsupported WebSocket message type: ' + e.data.constructor.name };\n\n                if (this._onError) {\n                    this._onError(_loader.LoaderErrors.EXCEPTION, info);\n                } else {\n                    throw new _exception.RuntimeException(info.msg);\n                }\n            }\n        }\n    }, {\n        key: '_dispatchArrayBuffer',\n        value: function _dispatchArrayBuffer(arraybuffer) {\n            var chunk = arraybuffer;\n            var byteStart = this._receivedLength;\n            this._receivedLength += chunk.byteLength;\n\n            if (this._onDataArrival) {\n                this._onDataArrival(chunk, byteStart, this._receivedLength);\n            }\n        }\n    }, {\n        key: '_onWebSocketError',\n        value: function _onWebSocketError(e) {\n            this._status = _loader.LoaderStatus.kError;\n\n            var info = {\n                code: e.code,\n                msg: e.message\n            };\n\n            if (this._onError) {\n                this._onError(_loader.LoaderErrors.EXCEPTION, info);\n            } else {\n                throw new _exception.RuntimeException(info.msg);\n            }\n        }\n    }]);\n\n    return WebSocketLoader;\n}(_loader.BaseLoader);\n\nexports.default = WebSocketLoader;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],29:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n// For FireFox browser which supports `xhr.responseType = 'moz-chunked-arraybuffer'`\nvar MozChunkedLoader = function (_BaseLoader) {\n    _inherits(MozChunkedLoader, _BaseLoader);\n\n    _createClass(MozChunkedLoader, null, [{\n        key: 'isSupported',\n        value: function isSupported() {\n            try {\n                var xhr = new XMLHttpRequest();\n                // Firefox 37- requires .open() to be called before setting responseType\n                xhr.open('GET', 'https://example.com', true);\n                xhr.responseType = 'moz-chunked-arraybuffer';\n                return xhr.responseType === 'moz-chunked-arraybuffer';\n            } catch (e) {\n                _logger2.default.w('MozChunkedLoader', e.message);\n                return false;\n            }\n        }\n    }]);\n\n    function MozChunkedLoader(seekHandler, config) {\n        _classCallCheck(this, MozChunkedLoader);\n\n        var _this = _possibleConstructorReturn(this, (MozChunkedLoader.__proto__ || Object.getPrototypeOf(MozChunkedLoader)).call(this, 'xhr-moz-chunked-loader'));\n\n        _this.TAG = 'MozChunkedLoader';\n\n        _this._seekHandler = seekHandler;\n        _this._config = config;\n        _this._needStash = true;\n\n        _this._xhr = null;\n        _this._requestAbort = false;\n        _this._contentLength = null;\n        _this._receivedLength = 0;\n        return _this;\n    }\n\n    _createClass(MozChunkedLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this.isWorking()) {\n                this.abort();\n            }\n            if (this._xhr) {\n                this._xhr.onreadystatechange = null;\n                this._xhr.onprogress = null;\n                this._xhr.onloadend = null;\n                this._xhr.onerror = null;\n                this._xhr = null;\n            }\n            _get(MozChunkedLoader.prototype.__proto__ || Object.getPrototypeOf(MozChunkedLoader.prototype), 'destroy', this).call(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(dataSource, range) {\n            this._dataSource = dataSource;\n            this._range = range;\n\n            var sourceURL = dataSource.url;\n            if (this._config.reuseRedirectedURL && dataSource.redirectedURL != undefined) {\n                sourceURL = dataSource.redirectedURL;\n            }\n\n            var seekConfig = this._seekHandler.getConfig(sourceURL, range);\n            this._requestURL = seekConfig.url;\n\n            var xhr = this._xhr = new XMLHttpRequest();\n            xhr.open('GET', seekConfig.url, true);\n            xhr.responseType = 'moz-chunked-arraybuffer';\n            xhr.onreadystatechange = this._onReadyStateChange.bind(this);\n            xhr.onprogress = this._onProgress.bind(this);\n            xhr.onloadend = this._onLoadEnd.bind(this);\n            xhr.onerror = this._onXhrError.bind(this);\n\n            // cors is auto detected and enabled by xhr\n\n            // withCredentials is disabled by default\n            if (dataSource.withCredentials) {\n                xhr.withCredentials = true;\n            }\n\n            if (_typeof(seekConfig.headers) === 'object') {\n                var headers = seekConfig.headers;\n\n                for (var key in headers) {\n                    if (headers.hasOwnProperty(key)) {\n                        xhr.setRequestHeader(key, headers[key]);\n                    }\n                }\n            }\n\n            // add additional headers\n            if (_typeof(this._config.headers) === 'object') {\n                var _headers = this._config.headers;\n\n                for (var _key in _headers) {\n                    if (_headers.hasOwnProperty(_key)) {\n                        xhr.setRequestHeader(_key, _headers[_key]);\n                    }\n                }\n            }\n\n            this._status = _loader.LoaderStatus.kConnecting;\n            xhr.send();\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            this._requestAbort = true;\n            if (this._xhr) {\n                this._xhr.abort();\n            }\n            this._status = _loader.LoaderStatus.kComplete;\n        }\n    }, {\n        key: '_onReadyStateChange',\n        value: function _onReadyStateChange(e) {\n            var xhr = e.target;\n\n            if (xhr.readyState === 2) {\n                // HEADERS_RECEIVED\n                if (xhr.responseURL != undefined && xhr.responseURL !== this._requestURL) {\n                    if (this._onURLRedirect) {\n                        var redirectedURL = this._seekHandler.removeURLParameters(xhr.responseURL);\n                        this._onURLRedirect(redirectedURL);\n                    }\n                }\n\n                if (xhr.status !== 0 && (xhr.status < 200 || xhr.status > 299)) {\n                    this._status = _loader.LoaderStatus.kError;\n                    if (this._onError) {\n                        this._onError(_loader.LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: xhr.status, msg: xhr.statusText });\n                    } else {\n                        throw new _exception.RuntimeException('MozChunkedLoader: Http code invalid, ' + xhr.status + ' ' + xhr.statusText);\n                    }\n                } else {\n                    this._status = _loader.LoaderStatus.kBuffering;\n                }\n            }\n        }\n    }, {\n        key: '_onProgress',\n        value: function _onProgress(e) {\n            if (this._status === _loader.LoaderStatus.kError) {\n                // Ignore error response\n                return;\n            }\n\n            if (this._contentLength === null) {\n                if (e.total !== null && e.total !== 0) {\n                    this._contentLength = e.total;\n                    if (this._onContentLengthKnown) {\n                        this._onContentLengthKnown(this._contentLength);\n                    }\n                }\n            }\n\n            var chunk = e.target.response;\n            var byteStart = this._range.from + this._receivedLength;\n            this._receivedLength += chunk.byteLength;\n\n            if (this._onDataArrival) {\n                this._onDataArrival(chunk, byteStart, this._receivedLength);\n            }\n        }\n    }, {\n        key: '_onLoadEnd',\n        value: function _onLoadEnd(e) {\n            if (this._requestAbort === true) {\n                this._requestAbort = false;\n                return;\n            } else if (this._status === _loader.LoaderStatus.kError) {\n                return;\n            }\n\n            this._status = _loader.LoaderStatus.kComplete;\n            if (this._onComplete) {\n                this._onComplete(this._range.from, this._range.from + this._receivedLength - 1);\n            }\n        }\n    }, {\n        key: '_onXhrError',\n        value: function _onXhrError(e) {\n            this._status = _loader.LoaderStatus.kError;\n            var type = 0;\n            var info = null;\n\n            if (this._contentLength && e.loaded < this._contentLength) {\n                type = _loader.LoaderErrors.EARLY_EOF;\n                info = { code: -1, msg: 'Moz-Chunked stream meet Early-Eof' };\n            } else {\n                type = _loader.LoaderErrors.EXCEPTION;\n                info = { code: -1, msg: e.constructor.name + ' ' + e.type };\n            }\n\n            if (this._onError) {\n                this._onError(type, info);\n            } else {\n                throw new _exception.RuntimeException(info.msg);\n            }\n        }\n    }]);\n\n    return MozChunkedLoader;\n}(_loader.BaseLoader);\n\nexports.default = MozChunkedLoader;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],30:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n/* Notice: ms-stream may cause IE/Edge browser crash if seek too frequently!!!\r\n * The browser may crash in wininet.dll. Disable for now.\r\n *\r\n * For IE11/Edge browser by microsoft which supports `xhr.responseType = 'ms-stream'`\r\n * Notice that ms-stream API sucks. The buffer is always expanding along with downloading.\r\n *\r\n * We need to abort the xhr if buffer size exceeded limit size (e.g. 16 MiB), then do reconnect.\r\n * in order to release previous ArrayBuffer to avoid memory leak\r\n *\r\n * Otherwise, the ArrayBuffer will increase to a terrible size that equals final file size.\r\n */\nvar MSStreamLoader = function (_BaseLoader) {\n    _inherits(MSStreamLoader, _BaseLoader);\n\n    _createClass(MSStreamLoader, null, [{\n        key: 'isSupported',\n        value: function isSupported() {\n            try {\n                if (typeof self.MSStream === 'undefined' || typeof self.MSStreamReader === 'undefined') {\n                    return false;\n                }\n\n                var xhr = new XMLHttpRequest();\n                xhr.open('GET', 'https://example.com', true);\n                xhr.responseType = 'ms-stream';\n                return xhr.responseType === 'ms-stream';\n            } catch (e) {\n                _logger2.default.w('MSStreamLoader', e.message);\n                return false;\n            }\n        }\n    }]);\n\n    function MSStreamLoader(seekHandler, config) {\n        _classCallCheck(this, MSStreamLoader);\n\n        var _this = _possibleConstructorReturn(this, (MSStreamLoader.__proto__ || Object.getPrototypeOf(MSStreamLoader)).call(this, 'xhr-msstream-loader'));\n\n        _this.TAG = 'MSStreamLoader';\n\n        _this._seekHandler = seekHandler;\n        _this._config = config;\n        _this._needStash = true;\n\n        _this._xhr = null;\n        _this._reader = null; // MSStreamReader\n\n        _this._totalRange = null;\n        _this._currentRange = null;\n\n        _this._currentRequestURL = null;\n        _this._currentRedirectedURL = null;\n\n        _this._contentLength = null;\n        _this._receivedLength = 0;\n\n        _this._bufferLimit = 16 * 1024 * 1024; // 16MB\n        _this._lastTimeBufferSize = 0;\n        _this._isReconnecting = false;\n        return _this;\n    }\n\n    _createClass(MSStreamLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this.isWorking()) {\n                this.abort();\n            }\n            if (this._reader) {\n                this._reader.onprogress = null;\n                this._reader.onload = null;\n                this._reader.onerror = null;\n                this._reader = null;\n            }\n            if (this._xhr) {\n                this._xhr.onreadystatechange = null;\n                this._xhr = null;\n            }\n            _get(MSStreamLoader.prototype.__proto__ || Object.getPrototypeOf(MSStreamLoader.prototype), 'destroy', this).call(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(dataSource, range) {\n            this._internalOpen(dataSource, range, false);\n        }\n    }, {\n        key: '_internalOpen',\n        value: function _internalOpen(dataSource, range, isSubrange) {\n            this._dataSource = dataSource;\n\n            if (!isSubrange) {\n                this._totalRange = range;\n            } else {\n                this._currentRange = range;\n            }\n\n            var sourceURL = dataSource.url;\n            if (this._config.reuseRedirectedURL) {\n                if (this._currentRedirectedURL != undefined) {\n                    sourceURL = this._currentRedirectedURL;\n                } else if (dataSource.redirectedURL != undefined) {\n                    sourceURL = dataSource.redirectedURL;\n                }\n            }\n\n            var seekConfig = this._seekHandler.getConfig(sourceURL, range);\n            this._currentRequestURL = seekConfig.url;\n\n            var reader = this._reader = new self.MSStreamReader();\n            reader.onprogress = this._msrOnProgress.bind(this);\n            reader.onload = this._msrOnLoad.bind(this);\n            reader.onerror = this._msrOnError.bind(this);\n\n            var xhr = this._xhr = new XMLHttpRequest();\n            xhr.open('GET', seekConfig.url, true);\n            xhr.responseType = 'ms-stream';\n            xhr.onreadystatechange = this._xhrOnReadyStateChange.bind(this);\n            xhr.onerror = this._xhrOnError.bind(this);\n\n            if (dataSource.withCredentials) {\n                xhr.withCredentials = true;\n            }\n\n            if (_typeof(seekConfig.headers) === 'object') {\n                var headers = seekConfig.headers;\n\n                for (var key in headers) {\n                    if (headers.hasOwnProperty(key)) {\n                        xhr.setRequestHeader(key, headers[key]);\n                    }\n                }\n            }\n\n            // add additional headers\n            if (_typeof(this._config.headers) === 'object') {\n                var _headers = this._config.headers;\n\n                for (var _key in _headers) {\n                    if (_headers.hasOwnProperty(_key)) {\n                        xhr.setRequestHeader(_key, _headers[_key]);\n                    }\n                }\n            }\n\n            if (this._isReconnecting) {\n                this._isReconnecting = false;\n            } else {\n                this._status = _loader.LoaderStatus.kConnecting;\n            }\n            xhr.send();\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            this._internalAbort();\n            this._status = _loader.LoaderStatus.kComplete;\n        }\n    }, {\n        key: '_internalAbort',\n        value: function _internalAbort() {\n            if (this._reader) {\n                if (this._reader.readyState === 1) {\n                    // LOADING\n                    this._reader.abort();\n                }\n                this._reader.onprogress = null;\n                this._reader.onload = null;\n                this._reader.onerror = null;\n                this._reader = null;\n            }\n            if (this._xhr) {\n                this._xhr.abort();\n                this._xhr.onreadystatechange = null;\n                this._xhr = null;\n            }\n        }\n    }, {\n        key: '_xhrOnReadyStateChange',\n        value: function _xhrOnReadyStateChange(e) {\n            var xhr = e.target;\n\n            if (xhr.readyState === 2) {\n                // HEADERS_RECEIVED\n                if (xhr.status >= 200 && xhr.status <= 299) {\n                    this._status = _loader.LoaderStatus.kBuffering;\n\n                    if (xhr.responseURL != undefined) {\n                        var redirectedURL = this._seekHandler.removeURLParameters(xhr.responseURL);\n                        if (xhr.responseURL !== this._currentRequestURL && redirectedURL !== this._currentRedirectedURL) {\n                            this._currentRedirectedURL = redirectedURL;\n                            if (this._onURLRedirect) {\n                                this._onURLRedirect(redirectedURL);\n                            }\n                        }\n                    }\n\n                    var lengthHeader = xhr.getResponseHeader('Content-Length');\n                    if (lengthHeader != null && this._contentLength == null) {\n                        var length = parseInt(lengthHeader);\n                        if (length > 0) {\n                            this._contentLength = length;\n                            if (this._onContentLengthKnown) {\n                                this._onContentLengthKnown(this._contentLength);\n                            }\n                        }\n                    }\n                } else {\n                    this._status = _loader.LoaderStatus.kError;\n                    if (this._onError) {\n                        this._onError(_loader.LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: xhr.status, msg: xhr.statusText });\n                    } else {\n                        throw new _exception.RuntimeException('MSStreamLoader: Http code invalid, ' + xhr.status + ' ' + xhr.statusText);\n                    }\n                }\n            } else if (xhr.readyState === 3) {\n                // LOADING\n                if (xhr.status >= 200 && xhr.status <= 299) {\n                    this._status = _loader.LoaderStatus.kBuffering;\n\n                    var msstream = xhr.response;\n                    this._reader.readAsArrayBuffer(msstream);\n                }\n            }\n        }\n    }, {\n        key: '_xhrOnError',\n        value: function _xhrOnError(e) {\n            this._status = _loader.LoaderStatus.kError;\n            var type = _loader.LoaderErrors.EXCEPTION;\n            var info = { code: -1, msg: e.constructor.name + ' ' + e.type };\n\n            if (this._onError) {\n                this._onError(type, info);\n            } else {\n                throw new _exception.RuntimeException(info.msg);\n            }\n        }\n    }, {\n        key: '_msrOnProgress',\n        value: function _msrOnProgress(e) {\n            var reader = e.target;\n            var bigbuffer = reader.result;\n            if (bigbuffer == null) {\n                // result may be null, workaround for buggy M$\n                this._doReconnectIfNeeded();\n                return;\n            }\n\n            var slice = bigbuffer.slice(this._lastTimeBufferSize);\n            this._lastTimeBufferSize = bigbuffer.byteLength;\n            var byteStart = this._totalRange.from + this._receivedLength;\n            this._receivedLength += slice.byteLength;\n\n            if (this._onDataArrival) {\n                this._onDataArrival(slice, byteStart, this._receivedLength);\n            }\n\n            if (bigbuffer.byteLength >= this._bufferLimit) {\n                _logger2.default.v(this.TAG, 'MSStream buffer exceeded max size near ' + (byteStart + slice.byteLength) + ', reconnecting...');\n                this._doReconnectIfNeeded();\n            }\n        }\n    }, {\n        key: '_doReconnectIfNeeded',\n        value: function _doReconnectIfNeeded() {\n            if (this._contentLength == null || this._receivedLength < this._contentLength) {\n                this._isReconnecting = true;\n                this._lastTimeBufferSize = 0;\n                this._internalAbort();\n\n                var range = {\n                    from: this._totalRange.from + this._receivedLength,\n                    to: -1\n                };\n                this._internalOpen(this._dataSource, range, true);\n            }\n        }\n    }, {\n        key: '_msrOnLoad',\n        value: function _msrOnLoad(e) {\n            // actually it is onComplete event\n            this._status = _loader.LoaderStatus.kComplete;\n            if (this._onComplete) {\n                this._onComplete(this._totalRange.from, this._totalRange.from + this._receivedLength - 1);\n            }\n        }\n    }, {\n        key: '_msrOnError',\n        value: function _msrOnError(e) {\n            this._status = _loader.LoaderStatus.kError;\n            var type = 0;\n            var info = null;\n\n            if (this._contentLength && this._receivedLength < this._contentLength) {\n                type = _loader.LoaderErrors.EARLY_EOF;\n                info = { code: -1, msg: 'MSStream meet Early-Eof' };\n            } else {\n                type = _loader.LoaderErrors.EARLY_EOF;\n                info = { code: -1, msg: e.constructor.name + ' ' + e.type };\n            }\n\n            if (this._onError) {\n                this._onError(type, info);\n            } else {\n                throw new _exception.RuntimeException(info.msg);\n            }\n        }\n    }]);\n\n    return MSStreamLoader;\n}(_loader.BaseLoader);\n\nexports.default = MSStreamLoader;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24}],31:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _speedSampler = _dereq_('./speed-sampler.js');\n\nvar _speedSampler2 = _interopRequireDefault(_speedSampler);\n\nvar _loader = _dereq_('./loader.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n// Universal IO Loader, implemented by adding Range header in xhr's request header\nvar RangeLoader = function (_BaseLoader) {\n    _inherits(RangeLoader, _BaseLoader);\n\n    _createClass(RangeLoader, null, [{\n        key: 'isSupported',\n        value: function isSupported() {\n            try {\n                var xhr = new XMLHttpRequest();\n                xhr.open('GET', 'https://example.com', true);\n                xhr.responseType = 'arraybuffer';\n                return xhr.responseType === 'arraybuffer';\n            } catch (e) {\n                _logger2.default.w('RangeLoader', e.message);\n                return false;\n            }\n        }\n    }]);\n\n    function RangeLoader(seekHandler, config) {\n        _classCallCheck(this, RangeLoader);\n\n        var _this = _possibleConstructorReturn(this, (RangeLoader.__proto__ || Object.getPrototypeOf(RangeLoader)).call(this, 'xhr-range-loader'));\n\n        _this.TAG = 'RangeLoader';\n\n        _this._seekHandler = seekHandler;\n        _this._config = config;\n        _this._needStash = false;\n\n        _this._chunkSizeKBList = [128, 256, 384, 512, 768, 1024, 1536, 2048, 3072, 4096, 5120, 6144, 7168, 8192];\n        _this._currentChunkSizeKB = 384;\n        _this._currentSpeedNormalized = 0;\n        _this._zeroSpeedChunkCount = 0;\n\n        _this._xhr = null;\n        _this._speedSampler = new _speedSampler2.default();\n\n        _this._requestAbort = false;\n        _this._waitForTotalLength = false;\n        _this._totalLengthReceived = false;\n\n        _this._currentRequestURL = null;\n        _this._currentRedirectedURL = null;\n        _this._currentRequestRange = null;\n        _this._totalLength = null; // size of the entire file\n        _this._contentLength = null; // Content-Length of entire request range\n        _this._receivedLength = 0; // total received bytes\n        _this._lastTimeLoaded = 0; // received bytes of current request sub-range\n        return _this;\n    }\n\n    _createClass(RangeLoader, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this.isWorking()) {\n                this.abort();\n            }\n            if (this._xhr) {\n                this._xhr.onreadystatechange = null;\n                this._xhr.onprogress = null;\n                this._xhr.onload = null;\n                this._xhr.onerror = null;\n                this._xhr = null;\n            }\n            _get(RangeLoader.prototype.__proto__ || Object.getPrototypeOf(RangeLoader.prototype), 'destroy', this).call(this);\n        }\n    }, {\n        key: 'open',\n        value: function open(dataSource, range) {\n            this._dataSource = dataSource;\n            this._range = range;\n            this._status = _loader.LoaderStatus.kConnecting;\n\n            var useRefTotalLength = false;\n            if (this._dataSource.filesize != undefined && this._dataSource.filesize !== 0) {\n                useRefTotalLength = true;\n                this._totalLength = this._dataSource.filesize;\n            }\n\n            if (!this._totalLengthReceived && !useRefTotalLength) {\n                // We need total filesize\n                this._waitForTotalLength = true;\n                this._internalOpen(this._dataSource, { from: 0, to: -1 });\n            } else {\n                // We have filesize, start loading\n                this._openSubRange();\n            }\n        }\n    }, {\n        key: '_openSubRange',\n        value: function _openSubRange() {\n            var chunkSize = this._currentChunkSizeKB * 1024;\n\n            var from = this._range.from + this._receivedLength;\n            var to = from + chunkSize;\n\n            if (this._contentLength != null) {\n                if (to - this._range.from >= this._contentLength) {\n                    to = this._range.from + this._contentLength - 1;\n                }\n            }\n\n            this._currentRequestRange = { from: from, to: to };\n            this._internalOpen(this._dataSource, this._currentRequestRange);\n        }\n    }, {\n        key: '_internalOpen',\n        value: function _internalOpen(dataSource, range) {\n            this._lastTimeLoaded = 0;\n\n            var sourceURL = dataSource.url;\n            if (this._config.reuseRedirectedURL) {\n                if (this._currentRedirectedURL != undefined) {\n                    sourceURL = this._currentRedirectedURL;\n                } else if (dataSource.redirectedURL != undefined) {\n                    sourceURL = dataSource.redirectedURL;\n                }\n            }\n\n            var seekConfig = this._seekHandler.getConfig(sourceURL, range);\n            this._currentRequestURL = seekConfig.url;\n\n            var xhr = this._xhr = new XMLHttpRequest();\n            xhr.open('GET', seekConfig.url, true);\n            xhr.responseType = 'arraybuffer';\n            xhr.onreadystatechange = this._onReadyStateChange.bind(this);\n            xhr.onprogress = this._onProgress.bind(this);\n            xhr.onload = this._onLoad.bind(this);\n            xhr.onerror = this._onXhrError.bind(this);\n\n            if (dataSource.withCredentials) {\n                xhr.withCredentials = true;\n            }\n\n            if (_typeof(seekConfig.headers) === 'object') {\n                var headers = seekConfig.headers;\n\n                for (var key in headers) {\n                    if (headers.hasOwnProperty(key)) {\n                        xhr.setRequestHeader(key, headers[key]);\n                    }\n                }\n            }\n\n            // add additional headers\n            if (_typeof(this._config.headers) === 'object') {\n                var _headers = this._config.headers;\n\n                for (var _key in _headers) {\n                    if (_headers.hasOwnProperty(_key)) {\n                        xhr.setRequestHeader(_key, _headers[_key]);\n                    }\n                }\n            }\n\n            xhr.send();\n        }\n    }, {\n        key: 'abort',\n        value: function abort() {\n            this._requestAbort = true;\n            this._internalAbort();\n            this._status = _loader.LoaderStatus.kComplete;\n        }\n    }, {\n        key: '_internalAbort',\n        value: function _internalAbort() {\n            if (this._xhr) {\n                this._xhr.onreadystatechange = null;\n                this._xhr.onprogress = null;\n                this._xhr.onload = null;\n                this._xhr.onerror = null;\n                this._xhr.abort();\n                this._xhr = null;\n            }\n        }\n    }, {\n        key: '_onReadyStateChange',\n        value: function _onReadyStateChange(e) {\n            var xhr = e.target;\n\n            if (xhr.readyState === 2) {\n                // HEADERS_RECEIVED\n                if (xhr.responseURL != undefined) {\n                    // if the browser support this property\n                    var redirectedURL = this._seekHandler.removeURLParameters(xhr.responseURL);\n                    if (xhr.responseURL !== this._currentRequestURL && redirectedURL !== this._currentRedirectedURL) {\n                        this._currentRedirectedURL = redirectedURL;\n                        if (this._onURLRedirect) {\n                            this._onURLRedirect(redirectedURL);\n                        }\n                    }\n                }\n\n                if (xhr.status >= 200 && xhr.status <= 299) {\n                    if (this._waitForTotalLength) {\n                        return;\n                    }\n                    this._status = _loader.LoaderStatus.kBuffering;\n                } else {\n                    this._status = _loader.LoaderStatus.kError;\n                    if (this._onError) {\n                        this._onError(_loader.LoaderErrors.HTTP_STATUS_CODE_INVALID, { code: xhr.status, msg: xhr.statusText });\n                    } else {\n                        throw new _exception.RuntimeException('RangeLoader: Http code invalid, ' + xhr.status + ' ' + xhr.statusText);\n                    }\n                }\n            }\n        }\n    }, {\n        key: '_onProgress',\n        value: function _onProgress(e) {\n            if (this._status === _loader.LoaderStatus.kError) {\n                // Ignore error response\n                return;\n            }\n\n            if (this._contentLength === null) {\n                var openNextRange = false;\n\n                if (this._waitForTotalLength) {\n                    this._waitForTotalLength = false;\n                    this._totalLengthReceived = true;\n                    openNextRange = true;\n\n                    var total = e.total;\n                    this._internalAbort();\n                    if (total != null & total !== 0) {\n                        this._totalLength = total;\n                    }\n                }\n\n                // calculate currrent request range's contentLength\n                if (this._range.to === -1) {\n                    this._contentLength = this._totalLength - this._range.from;\n                } else {\n                    // to !== -1\n                    this._contentLength = this._range.to - this._range.from + 1;\n                }\n\n                if (openNextRange) {\n                    this._openSubRange();\n                    return;\n                }\n                if (this._onContentLengthKnown) {\n                    this._onContentLengthKnown(this._contentLength);\n                }\n            }\n\n            var delta = e.loaded - this._lastTimeLoaded;\n            this._lastTimeLoaded = e.loaded;\n            this._speedSampler.addBytes(delta);\n        }\n    }, {\n        key: '_normalizeSpeed',\n        value: function _normalizeSpeed(input) {\n            var list = this._chunkSizeKBList;\n            var last = list.length - 1;\n            var mid = 0;\n            var lbound = 0;\n            var ubound = last;\n\n            if (input < list[0]) {\n                return list[0];\n            }\n\n            while (lbound <= ubound) {\n                mid = lbound + Math.floor((ubound - lbound) / 2);\n                if (mid === last || input >= list[mid] && input < list[mid + 1]) {\n                    return list[mid];\n                } else if (list[mid] < input) {\n                    lbound = mid + 1;\n                } else {\n                    ubound = mid - 1;\n                }\n            }\n        }\n    }, {\n        key: '_onLoad',\n        value: function _onLoad(e) {\n            if (this._status === _loader.LoaderStatus.kError) {\n                // Ignore error response\n                return;\n            }\n\n            if (this._waitForTotalLength) {\n                this._waitForTotalLength = false;\n                return;\n            }\n\n            this._lastTimeLoaded = 0;\n            var KBps = this._speedSampler.lastSecondKBps;\n            if (KBps === 0) {\n                this._zeroSpeedChunkCount++;\n                if (this._zeroSpeedChunkCount >= 3) {\n                    // Try get currentKBps after 3 chunks\n                    KBps = this._speedSampler.currentKBps;\n                }\n            }\n\n            if (KBps !== 0) {\n                var normalized = this._normalizeSpeed(KBps);\n                if (this._currentSpeedNormalized !== normalized) {\n                    this._currentSpeedNormalized = normalized;\n                    this._currentChunkSizeKB = normalized;\n                }\n            }\n\n            var chunk = e.target.response;\n            var byteStart = this._range.from + this._receivedLength;\n            this._receivedLength += chunk.byteLength;\n\n            var reportComplete = false;\n\n            if (this._contentLength != null && this._receivedLength < this._contentLength) {\n                // continue load next chunk\n                this._openSubRange();\n            } else {\n                reportComplete = true;\n            }\n\n            // dispatch received chunk\n            if (this._onDataArrival) {\n                this._onDataArrival(chunk, byteStart, this._receivedLength);\n            }\n\n            if (reportComplete) {\n                this._status = _loader.LoaderStatus.kComplete;\n                if (this._onComplete) {\n                    this._onComplete(this._range.from, this._range.from + this._receivedLength - 1);\n                }\n            }\n        }\n    }, {\n        key: '_onXhrError',\n        value: function _onXhrError(e) {\n            this._status = _loader.LoaderStatus.kError;\n            var type = 0;\n            var info = null;\n\n            if (this._contentLength && this._receivedLength > 0 && this._receivedLength < this._contentLength) {\n                type = _loader.LoaderErrors.EARLY_EOF;\n                info = { code: -1, msg: 'RangeLoader meet Early-Eof' };\n            } else {\n                type = _loader.LoaderErrors.EXCEPTION;\n                info = { code: -1, msg: e.constructor.name + ' ' + e.type };\n            }\n\n            if (this._onError) {\n                this._onError(type, info);\n            } else {\n                throw new _exception.RuntimeException(info.msg);\n            }\n        }\n    }, {\n        key: 'currentSpeed',\n        get: function get() {\n            return this._speedSampler.lastSecondKBps;\n        }\n    }]);\n\n    return RangeLoader;\n}(_loader.BaseLoader);\n\nexports.default = RangeLoader;\n\n},{\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./loader.js\":24,\"./speed-sampler.js\":27}],32:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _browser = _dereq_('../utils/browser.js');\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _playerEvents = _dereq_('./player-events.js');\n\nvar _playerEvents2 = _interopRequireDefault(_playerEvents);\n\nvar _transmuxer = _dereq_('../core/transmuxer.js');\n\nvar _transmuxer2 = _interopRequireDefault(_transmuxer);\n\nvar _transmuxingEvents = _dereq_('../core/transmuxing-events.js');\n\nvar _transmuxingEvents2 = _interopRequireDefault(_transmuxingEvents);\n\nvar _mseController = _dereq_('../core/mse-controller.js');\n\nvar _mseController2 = _interopRequireDefault(_mseController);\n\nvar _mseEvents = _dereq_('../core/mse-events.js');\n\nvar _mseEvents2 = _interopRequireDefault(_mseEvents);\n\nvar _playerErrors = _dereq_('./player-errors.js');\n\nvar _config = _dereq_('../config.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar FlvPlayer = function () {\n    function FlvPlayer(mediaDataSource, config) {\n        _classCallCheck(this, FlvPlayer);\n\n        this.TAG = 'FlvPlayer';\n        this._type = 'FlvPlayer';\n        this._emitter = new _events2.default();\n\n        this._config = (0, _config.createDefaultConfig)();\n        if ((typeof config === 'undefined' ? 'undefined' : _typeof(config)) === 'object') {\n            Object.assign(this._config, config);\n        }\n\n        if (mediaDataSource.type.toLowerCase() !== 'flv') {\n            throw new _exception.InvalidArgumentException('FlvPlayer requires an flv MediaDataSource input!');\n        }\n\n        if (mediaDataSource.isLive === true) {\n            this._config.isLive = true;\n        }\n\n        this.e = {\n            onvLoadedMetadata: this._onvLoadedMetadata.bind(this),\n            onvSeeking: this._onvSeeking.bind(this),\n            onvCanPlay: this._onvCanPlay.bind(this),\n            onvStalled: this._onvStalled.bind(this),\n            onvProgress: this._onvProgress.bind(this)\n        };\n\n        if (self.performance && self.performance.now) {\n            this._now = self.performance.now.bind(self.performance);\n        } else {\n            this._now = Date.now;\n        }\n\n        this._pendingSeekTime = null; // in seconds\n        this._requestSetTime = false;\n        this._seekpointRecord = null;\n        this._progressChecker = null;\n\n        this._mediaDataSource = mediaDataSource;\n        this._mediaElement = null;\n        this._msectl = null;\n        this._transmuxer = null;\n\n        this._mseSourceOpened = false;\n        this._hasPendingLoad = false;\n        this._receivedCanPlay = false;\n\n        this._mediaInfo = null;\n        this._statisticsInfo = null;\n\n        var chromeNeedIDRFix = _browser2.default.chrome && (_browser2.default.version.major < 50 || _browser2.default.version.major === 50 && _browser2.default.version.build < 2661);\n        this._alwaysSeekKeyframe = chromeNeedIDRFix || _browser2.default.msedge || _browser2.default.msie ? true : false;\n\n        if (this._alwaysSeekKeyframe) {\n            this._config.accurateSeek = false;\n        }\n\n        this.callbackStreamTime = null;\n        this._mediaSourceEndCallback = null;\n    }\n\n    _createClass(FlvPlayer, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._progressChecker != null) {\n                window.clearInterval(this._progressChecker);\n                this._progressChecker = null;\n            }\n            if (this._transmuxer) {\n                this.unload();\n            }\n            if (this._mediaElement) {\n                this.detachMediaElement();\n            }\n            this.e = null;\n            this._mediaDataSource = null;\n\n            this._emitter.removeAllListeners();\n            this._emitter = null;\n\n            this.callbackStreamTime = null;\n            this._mediaSourceEndCallback = null;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, listener) {\n            var _this = this;\n\n            if (event === _playerEvents2.default.MEDIA_INFO) {\n                if (this._mediaInfo != null) {\n                    Promise.resolve().then(function () {\n                        _this._emitter.emit(_playerEvents2.default.MEDIA_INFO, _this.mediaInfo);\n                    });\n                }\n            } else if (event === _playerEvents2.default.STATISTICS_INFO) {\n                if (this._statisticsInfo != null) {\n                    Promise.resolve().then(function () {\n                        _this._emitter.emit(_playerEvents2.default.STATISTICS_INFO, _this.statisticsInfo);\n                    });\n                }\n            }\n            this._emitter.addListener(event, listener);\n        }\n    }, {\n        key: 'off',\n        value: function off(event, listener) {\n            this._emitter.removeListener(event, listener);\n        }\n    }, {\n        key: 'attachMediaElement',\n        value: function attachMediaElement(mediaElement) {\n            var _this2 = this;\n\n            this._mediaElement = mediaElement;\n            mediaElement.addEventListener('loadedmetadata', this.e.onvLoadedMetadata);\n            //mediaElement.addEventListener('seeking', this.e.onvSeeking);\n            mediaElement.addEventListener('canplay', this.e.onvCanPlay);\n            mediaElement.addEventListener('stalled', this.e.onvStalled);\n            //mediaElement.addEventListener('progress', this.e.onvProgress);\n\n            this._msectl = new _mseController2.default(this._config);\n\n            this._msectl.on(_mseEvents2.default.UPDATE_END, this._onmseUpdateEnd.bind(this));\n            this._msectl.on(_mseEvents2.default.BUFFER_FULL, this._onmseBufferFull.bind(this));\n            this._msectl.on(_mseEvents2.default.SOURCE_OPEN, function () {\n                _this2._mseSourceOpened = true;\n                if (_this2._hasPendingLoad) {\n                    _this2._hasPendingLoad = false;\n                    _this2.load();\n                }\n            });\n            this._msectl.on(_mseEvents2.default.ERROR, function (info) {\n                _this2._emitter.emit(_playerEvents2.default.ERROR, _playerErrors.ErrorTypes.MEDIA_ERROR, _playerErrors.ErrorDetails.MEDIA_MSE_ERROR, info);\n            });\n            this._msectl.on(_mseEvents2.default.SOURCE_END, function (info) {\n                if (_this2._mediaSourceEndCallback != null) {\n                    _this2._mediaSourceEndCallback(info);\n                }\n            });\n\n            this._msectl.attachMediaElement(mediaElement);\n\n            if (this._pendingSeekTime != null) {\n                try {\n                    mediaElement.currentTime = this._pendingSeekTime;\n                    this._pendingSeekTime = null;\n                } catch (e) {\n                    // IE11 may throw InvalidStateError if readyState === 0\n                    // We can defer set currentTime operation after loadedmetadata\n                }\n            }\n        }\n    }, {\n        key: 'detachMediaElement',\n        value: function detachMediaElement() {\n            if (this._mediaElement) {\n                this._msectl.detachMediaElement();\n                this._mediaElement.removeEventListener('loadedmetadata', this.e.onvLoadedMetadata);\n                //this._mediaElement.removeEventListener('seeking', this.e.onvSeeking);\n                this._mediaElement.removeEventListener('canplay', this.e.onvCanPlay);\n                this._mediaElement.removeEventListener('stalled', this.e.onvStalled);\n                //this._mediaElement.removeEventListener('progress', this.e.onvProgress);\n                this._mediaElement = null;\n            }\n            if (this._msectl) {\n                this._msectl.destroy();\n                this._msectl = null;\n            }\n        }\n    }, {\n        key: 'load',\n        value: function load() {\n            var _this3 = this;\n\n            if (!this._mediaElement) {\n                throw new _exception.IllegalStateException('HTMLMediaElement must be attached before load()!');\n            }\n            if (this._transmuxer) {\n                throw new _exception.IllegalStateException('FlvPlayer.load() has been called, please call unload() first!');\n            }\n            if (this._hasPendingLoad) {\n                return;\n            }\n\n            if (this._config.deferLoadAfterSourceOpen && this._mseSourceOpened === false) {\n                this._hasPendingLoad = true;\n                return;\n            }\n\n            if (this._mediaElement.readyState > 0) {\n                this._requestSetTime = true;\n                // IE11 may throw InvalidStateError if readyState === 0\n                this._mediaElement.currentTime = 0;\n            }\n\n            this._transmuxer = new _transmuxer2.default(this._mediaDataSource, this._config);\n\n            this._transmuxer.on(_transmuxingEvents2.default.INIT_SEGMENT, function (type, is) {\n                _this3._msectl.appendInitSegment(is);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.MEDIA_SEGMENT, function (type, ms) {\n                _this3._msectl.appendMediaSegment(ms);\n\n                // lazyLoad check\n                if (_this3._config.lazyLoad && !_this3._config.isLive) {\n                    var currentTime = _this3._mediaElement.currentTime;\n                    if (ms.info.endDts >= (currentTime + _this3._config.lazyLoadMaxDuration) * 1000) {\n                        if (_this3._progressChecker == null) {\n                            _logger2.default.v(_this3.TAG, 'Maximum buffering duration exceeded, suspend transmuxing task');\n                            _this3._suspendTransmuxer();\n                        }\n                    }\n                }\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.LOADING_COMPLETE, function () {\n                _this3._msectl.endOfStream();\n                _this3._emitter.emit(_playerEvents2.default.LOADING_COMPLETE);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.RECOVERED_EARLY_EOF, function () {\n                _this3._emitter.emit(_playerEvents2.default.RECOVERED_EARLY_EOF);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.IO_ERROR, function (detail, info) {\n                _this3._emitter.emit(_playerEvents2.default.ERROR, _playerErrors.ErrorTypes.NETWORK_ERROR, detail, info);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.DEMUX_ERROR, function (detail, info) {\n                _this3._emitter.emit(_playerEvents2.default.ERROR, _playerErrors.ErrorTypes.MEDIA_ERROR, detail, { code: -1, msg: info });\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.MEDIA_INFO, function (mediaInfo) {\n                _this3._mediaInfo = mediaInfo;\n                _this3._emitter.emit(_playerEvents2.default.MEDIA_INFO, Object.assign({}, mediaInfo));\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.METADATA_ARRIVED, function (metadata) {\n                _this3._emitter.emit(_playerEvents2.default.METADATA_ARRIVED, metadata);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.SCRIPTDATA_ARRIVED, function (data) {\n                _this3._emitter.emit(_playerEvents2.default.SCRIPTDATA_ARRIVED, data);\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.STATISTICS_INFO, function (statInfo) {\n                _this3._statisticsInfo = _this3._fillStatisticsInfo(statInfo);\n                _this3._emitter.emit(_playerEvents2.default.STATISTICS_INFO, Object.assign({}, _this3._statisticsInfo));\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.RECOMMEND_SEEKPOINT, function (milliseconds) {\n                if (_this3._mediaElement && !_this3._config.accurateSeek) {\n                    _this3._requestSetTime = true;\n                    _this3._mediaElement.currentTime = milliseconds / 1000;\n                }\n            });\n            this._transmuxer.on(_transmuxingEvents2.default.STREAM_TIME, function (ts) {\n                _this3._receiveStreamTime(ts);\n            });\n\n            this._transmuxer.open();\n        }\n    }, {\n        key: 'unload',\n        value: function unload() {\n            if (this._mediaElement) {\n                this._mediaElement.pause();\n            }\n            if (this._msectl) {\n                this._msectl.seek(0);\n            }\n            if (this._transmuxer) {\n                this._transmuxer.close();\n                this._transmuxer.destroy();\n                this._transmuxer = null;\n            }\n        }\n    }, {\n        key: 'play',\n        value: function play() {\n            return this._mediaElement.play();\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            this._mediaElement.pause();\n        }\n    }, {\n        key: '_fillStatisticsInfo',\n        value: function _fillStatisticsInfo(statInfo) {\n            statInfo.playerType = this._type;\n\n            if (!(this._mediaElement instanceof HTMLVideoElement)) {\n                return statInfo;\n            }\n\n            var hasQualityInfo = true;\n            var decoded = 0;\n            var dropped = 0;\n\n            if (this._mediaElement.getVideoPlaybackQuality) {\n                var quality = this._mediaElement.getVideoPlaybackQuality();\n                decoded = quality.totalVideoFrames;\n                dropped = quality.droppedVideoFrames;\n            } else if (this._mediaElement.webkitDecodedFrameCount != undefined) {\n                decoded = this._mediaElement.webkitDecodedFrameCount;\n                dropped = this._mediaElement.webkitDroppedFrameCount;\n            } else {\n                hasQualityInfo = false;\n            }\n\n            if (hasQualityInfo) {\n                statInfo.decodedFrames = decoded;\n                statInfo.droppedFrames = dropped;\n            }\n\n            return statInfo;\n        }\n    }, {\n        key: '_onmseUpdateEnd',\n        value: function _onmseUpdateEnd() {\n            if (!this._config.lazyLoad || this._config.isLive) {\n                return;\n            }\n\n            var buffered = this._mediaElement.buffered;\n            var currentTime = this._mediaElement.currentTime;\n            var currentRangeStart = 0;\n            var currentRangeEnd = 0;\n\n            for (var i = 0; i < buffered.length; i++) {\n                var start = buffered.start(i);\n                var end = buffered.end(i);\n                if (start <= currentTime && currentTime < end) {\n                    currentRangeStart = start;\n                    currentRangeEnd = end;\n                    break;\n                }\n            }\n\n            if (currentRangeEnd >= currentTime + this._config.lazyLoadMaxDuration && this._progressChecker == null) {\n                _logger2.default.v(this.TAG, 'Maximum buffering duration exceeded, suspend transmuxing task');\n                this._suspendTransmuxer();\n            }\n        }\n    }, {\n        key: '_onmseBufferFull',\n        value: function _onmseBufferFull() {\n            _logger2.default.v(this.TAG, 'MSE SourceBuffer is full, suspend transmuxing task');\n            if (this._progressChecker == null) {\n                this._suspendTransmuxer();\n            }\n        }\n    }, {\n        key: '_suspendTransmuxer',\n        value: function _suspendTransmuxer() {\n            if (this._transmuxer) {\n                this._transmuxer.pause();\n\n                if (this._progressChecker == null) {\n                    this._progressChecker = window.setInterval(this._checkProgressAndResume.bind(this), 1000);\n                }\n            }\n        }\n    }, {\n        key: '_checkProgressAndResume',\n        value: function _checkProgressAndResume() {\n            var currentTime = this._mediaElement.currentTime;\n            var buffered = this._mediaElement.buffered;\n\n            var needResume = false;\n\n            for (var i = 0; i < buffered.length; i++) {\n                var from = buffered.start(i);\n                var to = buffered.end(i);\n                if (currentTime >= from && currentTime < to) {\n                    if (currentTime >= to - this._config.lazyLoadRecoverDuration) {\n                        needResume = true;\n                    }\n                    break;\n                }\n            }\n\n            if (needResume) {\n                window.clearInterval(this._progressChecker);\n                this._progressChecker = null;\n                if (needResume) {\n                    _logger2.default.v(this.TAG, 'Continue loading from paused position');\n                    this._transmuxer.resume();\n                }\n            }\n        }\n    }, {\n        key: '_isTimepointBuffered',\n        value: function _isTimepointBuffered(seconds) {\n            var buffered = this._mediaElement.buffered;\n\n            for (var i = 0; i < buffered.length; i++) {\n                var from = buffered.start(i);\n                var to = buffered.end(i);\n                if (seconds >= from && seconds < to) {\n                    return true;\n                }\n            }\n            return false;\n        }\n    }, {\n        key: '_internalSeek',\n        value: function _internalSeek(seconds) {\n            var directSeek = this._isTimepointBuffered(seconds);\n\n            var directSeekBegin = false;\n            var directSeekBeginTime = 0;\n\n            if (seconds < 1.0 && this._mediaElement.buffered.length > 0) {\n                var videoBeginTime = this._mediaElement.buffered.start(0);\n                if (videoBeginTime < 1.0 && seconds < videoBeginTime || _browser2.default.safari) {\n                    directSeekBegin = true;\n                    // also workaround for Safari: Seek to 0 may cause video stuck, use 0.1 to avoid\n                    directSeekBeginTime = _browser2.default.safari ? 0.1 : videoBeginTime;\n                }\n            }\n\n            if (directSeekBegin) {\n                // seek to video begin, set currentTime directly if beginPTS buffered\n                this._requestSetTime = true;\n                this._mediaElement.currentTime = directSeekBeginTime;\n            } else if (directSeek) {\n                // buffered position\n                if (!this._alwaysSeekKeyframe) {\n                    this._requestSetTime = true;\n                    this._mediaElement.currentTime = seconds;\n                } else {\n                    var idr = this._msectl.getNearestKeyframe(Math.floor(seconds * 1000));\n                    this._requestSetTime = true;\n                    if (idr != null) {\n                        this._mediaElement.currentTime = idr.dts / 1000;\n                    } else {\n                        this._mediaElement.currentTime = seconds;\n                    }\n                }\n                if (this._progressChecker != null) {\n                    this._checkProgressAndResume();\n                }\n            } else {\n                if (this._progressChecker != null) {\n                    window.clearInterval(this._progressChecker);\n                    this._progressChecker = null;\n                }\n                this._msectl.seek(seconds);\n                this._transmuxer.seek(Math.floor(seconds * 1000)); // in milliseconds\n                // no need to set mediaElement.currentTime if non-accurateSeek,\n                // just wait for the recommend_seekpoint callback\n                if (this._config.accurateSeek) {\n                    this._requestSetTime = true;\n                    this._mediaElement.currentTime = seconds;\n                }\n            }\n        }\n    }, {\n        key: '_checkAndApplyUnbufferedSeekpoint',\n        value: function _checkAndApplyUnbufferedSeekpoint() {\n            if (this._seekpointRecord) {\n                if (this._seekpointRecord.recordTime <= this._now() - 100) {\n                    var target = this._mediaElement.currentTime;\n                    this._seekpointRecord = null;\n                    if (!this._isTimepointBuffered(target)) {\n                        if (this._progressChecker != null) {\n                            window.clearTimeout(this._progressChecker);\n                            this._progressChecker = null;\n                        }\n                        // .currentTime is consists with .buffered timestamp\n                        // Chrome/Edge use DTS, while FireFox/Safari use PTS\n                        this._msectl.seek(target);\n                        this._transmuxer.seek(Math.floor(target * 1000));\n                        // set currentTime if accurateSeek, or wait for recommend_seekpoint callback\n                        if (this._config.accurateSeek) {\n                            this._requestSetTime = true;\n                            this._mediaElement.currentTime = target;\n                        }\n                    }\n                } else {\n                    window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this), 50);\n                }\n            }\n        }\n    }, {\n        key: '_checkAndResumeStuckPlayback',\n        value: function _checkAndResumeStuckPlayback(stalled) {\n            var media = this._mediaElement;\n            if (stalled || !this._receivedCanPlay || media.readyState < 2) {\n                // HAVE_CURRENT_DATA\n                var buffered = media.buffered;\n                if (buffered.length > 0 && media.currentTime < buffered.start(0)) {\n                    _logger2.default.w(this.TAG, 'Playback seems stuck at ' + media.currentTime + ', seek to ' + buffered.start(0));\n                    this._requestSetTime = true;\n                    this._mediaElement.currentTime = buffered.start(0);\n                    this._mediaElement.removeEventListener('progress', this.e.onvProgress);\n                }\n            } else {\n                // Playback didn't stuck, remove progress event listener\n                this._mediaElement.removeEventListener('progress', this.e.onvProgress);\n            }\n        }\n    }, {\n        key: '_onvLoadedMetadata',\n        value: function _onvLoadedMetadata(e) {\n            if (this._pendingSeekTime != null) {\n                this._mediaElement.currentTime = this._pendingSeekTime;\n                this._pendingSeekTime = null;\n            }\n        }\n    }, {\n        key: '_onvSeeking',\n        value: function _onvSeeking(e) {\n            // handle seeking request from browser's progress bar\n            var target = this._mediaElement.currentTime;\n            var buffered = this._mediaElement.buffered;\n\n            if (this._requestSetTime) {\n                this._requestSetTime = false;\n                return;\n            }\n\n            if (target < 1.0 && buffered.length > 0) {\n                // seek to video begin, set currentTime directly if beginPTS buffered\n                var videoBeginTime = buffered.start(0);\n                if (videoBeginTime < 1.0 && target < videoBeginTime || _browser2.default.safari) {\n                    this._requestSetTime = true;\n                    // also workaround for Safari: Seek to 0 may cause video stuck, use 0.1 to avoid\n                    this._mediaElement.currentTime = _browser2.default.safari ? 0.1 : videoBeginTime;\n                    return;\n                }\n            }\n\n            if (this._isTimepointBuffered(target)) {\n                if (this._alwaysSeekKeyframe) {\n                    var idr = this._msectl.getNearestKeyframe(Math.floor(target * 1000));\n                    if (idr != null) {\n                        this._requestSetTime = true;\n                        this._mediaElement.currentTime = idr.dts / 1000;\n                    }\n                }\n                if (this._progressChecker != null) {\n                    this._checkProgressAndResume();\n                }\n                return;\n            }\n\n            this._seekpointRecord = {\n                seekPoint: target,\n                recordTime: this._now()\n            };\n            window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this), 50);\n        }\n    }, {\n        key: '_onvCanPlay',\n        value: function _onvCanPlay(e) {\n            this._receivedCanPlay = true;\n            this._mediaElement.removeEventListener('canplay', this.e.onvCanPlay);\n        }\n    }, {\n        key: '_onvStalled',\n        value: function _onvStalled(e) {\n            this._checkAndResumeStuckPlayback(true);\n        }\n    }, {\n        key: '_onvProgress',\n        value: function _onvProgress(e) {\n            this._checkAndResumeStuckPlayback();\n        }\n    }, {\n        key: 'setMediaSourceEndCallback',\n        value: function setMediaSourceEndCallback(call) {\n            this._mediaSourceEndCallback = call;\n        }\n    }, {\n        key: 'setStreamTimeCallback',\n        value: function setStreamTimeCallback(call) {\n            this.callbackStreamTime = call;\n        }\n    }, {\n        key: '_receiveStreamTime',\n        value: function _receiveStreamTime(ts) {\n            if (this.callbackStreamTime != null) {\n                this.callbackStreamTime(ts);\n            }\n        }\n    }, {\n        key: 'type',\n        get: function get() {\n            return this._type;\n        }\n    }, {\n        key: 'buffered',\n        get: function get() {\n            return this._mediaElement.buffered;\n        }\n    }, {\n        key: 'duration',\n        get: function get() {\n            return this._mediaElement.duration;\n        }\n    }, {\n        key: 'volume',\n        get: function get() {\n            return this._mediaElement.volume;\n        },\n        set: function set(value) {\n            this._mediaElement.volume = value;\n        }\n    }, {\n        key: 'muted',\n        get: function get() {\n            return this._mediaElement.muted;\n        },\n        set: function set(muted) {\n            this._mediaElement.muted = muted;\n        }\n    }, {\n        key: 'currentTime',\n        get: function get() {\n            if (this._mediaElement) {\n                return this._mediaElement.currentTime;\n            }\n            return 0;\n        },\n        set: function set(seconds) {\n            if (this._mediaElement) {\n                this._internalSeek(seconds);\n            } else {\n                this._pendingSeekTime = seconds;\n            }\n        }\n    }, {\n        key: 'mediaInfo',\n        get: function get() {\n            return Object.assign({}, this._mediaInfo);\n        }\n    }, {\n        key: 'statisticsInfo',\n        get: function get() {\n            if (this._statisticsInfo == null) {\n                this._statisticsInfo = {};\n            }\n            this._statisticsInfo = this._fillStatisticsInfo(this._statisticsInfo);\n            return Object.assign({}, this._statisticsInfo);\n        }\n    }]);\n\n    return FlvPlayer;\n}();\n\nexports.default = FlvPlayer;\n\n},{\"../config.js\":5,\"../core/mse-controller.js\":9,\"../core/mse-events.js\":10,\"../core/transmuxer.js\":11,\"../core/transmuxing-events.js\":13,\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./player-errors.js\":34,\"./player-events.js\":35,\"events\":2}],33:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _playerEvents = _dereq_('./player-events.js');\n\nvar _playerEvents2 = _interopRequireDefault(_playerEvents);\n\nvar _config = _dereq_('../config.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Player wrapper for browser's native player (HTMLVideoElement) without MediaSource src. \nvar NativePlayer = function () {\n    function NativePlayer(mediaDataSource, config) {\n        _classCallCheck(this, NativePlayer);\n\n        this.TAG = 'NativePlayer';\n        this._type = 'NativePlayer';\n        this._emitter = new _events2.default();\n\n        this._config = (0, _config.createDefaultConfig)();\n        if ((typeof config === 'undefined' ? 'undefined' : _typeof(config)) === 'object') {\n            Object.assign(this._config, config);\n        }\n\n        if (mediaDataSource.type.toLowerCase() === 'flv') {\n            throw new _exception.InvalidArgumentException('NativePlayer does\\'t support flv MediaDataSource input!');\n        }\n        if (mediaDataSource.hasOwnProperty('segments')) {\n            throw new _exception.InvalidArgumentException('NativePlayer(' + mediaDataSource.type + ') doesn\\'t support multipart playback!');\n        }\n\n        this.e = {\n            onvLoadedMetadata: this._onvLoadedMetadata.bind(this)\n        };\n\n        this._pendingSeekTime = null;\n        this._statisticsReporter = null;\n\n        this._mediaDataSource = mediaDataSource;\n        this._mediaElement = null;\n    }\n\n    _createClass(NativePlayer, [{\n        key: 'destroy',\n        value: function destroy() {\n            if (this._mediaElement) {\n                this.unload();\n                this.detachMediaElement();\n            }\n            this.e = null;\n            this._mediaDataSource = null;\n            this._emitter.removeAllListeners();\n            this._emitter = null;\n        }\n    }, {\n        key: 'on',\n        value: function on(event, listener) {\n            var _this = this;\n\n            if (event === _playerEvents2.default.MEDIA_INFO) {\n                if (this._mediaElement != null && this._mediaElement.readyState !== 0) {\n                    // HAVE_NOTHING\n                    Promise.resolve().then(function () {\n                        _this._emitter.emit(_playerEvents2.default.MEDIA_INFO, _this.mediaInfo);\n                    });\n                }\n            } else if (event === _playerEvents2.default.STATISTICS_INFO) {\n                if (this._mediaElement != null && this._mediaElement.readyState !== 0) {\n                    Promise.resolve().then(function () {\n                        _this._emitter.emit(_playerEvents2.default.STATISTICS_INFO, _this.statisticsInfo);\n                    });\n                }\n            }\n            this._emitter.addListener(event, listener);\n        }\n    }, {\n        key: 'off',\n        value: function off(event, listener) {\n            this._emitter.removeListener(event, listener);\n        }\n    }, {\n        key: 'attachMediaElement',\n        value: function attachMediaElement(mediaElement) {\n            this._mediaElement = mediaElement;\n            mediaElement.addEventListener('loadedmetadata', this.e.onvLoadedMetadata);\n\n            if (this._pendingSeekTime != null) {\n                try {\n                    mediaElement.currentTime = this._pendingSeekTime;\n                    this._pendingSeekTime = null;\n                } catch (e) {\n                    // IE11 may throw InvalidStateError if readyState === 0\n                    // Defer set currentTime operation after loadedmetadata\n                }\n            }\n        }\n    }, {\n        key: 'detachMediaElement',\n        value: function detachMediaElement() {\n            if (this._mediaElement) {\n                this._mediaElement.src = '';\n                this._mediaElement.removeAttribute('src');\n                this._mediaElement.removeEventListener('loadedmetadata', this.e.onvLoadedMetadata);\n                this._mediaElement = null;\n            }\n            if (this._statisticsReporter != null) {\n                window.clearInterval(this._statisticsReporter);\n                this._statisticsReporter = null;\n            }\n        }\n    }, {\n        key: 'load',\n        value: function load() {\n            if (!this._mediaElement) {\n                throw new _exception.IllegalStateException('HTMLMediaElement must be attached before load()!');\n            }\n            this._mediaElement.src = this._mediaDataSource.url;\n\n            if (this._mediaElement.readyState > 0) {\n                this._mediaElement.currentTime = 0;\n            }\n\n            this._mediaElement.preload = 'auto';\n            this._mediaElement.load();\n            this._statisticsReporter = window.setInterval(this._reportStatisticsInfo.bind(this), this._config.statisticsInfoReportInterval);\n        }\n    }, {\n        key: 'unload',\n        value: function unload() {\n            if (this._mediaElement) {\n                this._mediaElement.src = '';\n                this._mediaElement.removeAttribute('src');\n            }\n            if (this._statisticsReporter != null) {\n                window.clearInterval(this._statisticsReporter);\n                this._statisticsReporter = null;\n            }\n        }\n    }, {\n        key: 'play',\n        value: function play() {\n            return this._mediaElement.play();\n        }\n    }, {\n        key: 'pause',\n        value: function pause() {\n            this._mediaElement.pause();\n        }\n    }, {\n        key: '_onvLoadedMetadata',\n        value: function _onvLoadedMetadata(e) {\n            if (this._pendingSeekTime != null) {\n                this._mediaElement.currentTime = this._pendingSeekTime;\n                this._pendingSeekTime = null;\n            }\n            this._emitter.emit(_playerEvents2.default.MEDIA_INFO, this.mediaInfo);\n        }\n    }, {\n        key: '_reportStatisticsInfo',\n        value: function _reportStatisticsInfo() {\n            this._emitter.emit(_playerEvents2.default.STATISTICS_INFO, this.statisticsInfo);\n        }\n    }, {\n        key: 'type',\n        get: function get() {\n            return this._type;\n        }\n    }, {\n        key: 'buffered',\n        get: function get() {\n            return this._mediaElement.buffered;\n        }\n    }, {\n        key: 'duration',\n        get: function get() {\n            return this._mediaElement.duration;\n        }\n    }, {\n        key: 'volume',\n        get: function get() {\n            return this._mediaElement.volume;\n        },\n        set: function set(value) {\n            this._mediaElement.volume = value;\n        }\n    }, {\n        key: 'muted',\n        get: function get() {\n            return this._mediaElement.muted;\n        },\n        set: function set(muted) {\n            this._mediaElement.muted = muted;\n        }\n    }, {\n        key: 'currentTime',\n        get: function get() {\n            if (this._mediaElement) {\n                return this._mediaElement.currentTime;\n            }\n            return 0;\n        },\n        set: function set(seconds) {\n            if (this._mediaElement) {\n                this._mediaElement.currentTime = seconds;\n            } else {\n                this._pendingSeekTime = seconds;\n            }\n        }\n    }, {\n        key: 'mediaInfo',\n        get: function get() {\n            var mediaPrefix = this._mediaElement instanceof HTMLAudioElement ? 'audio/' : 'video/';\n            var info = {\n                mimeType: mediaPrefix + this._mediaDataSource.type\n            };\n            if (this._mediaElement) {\n                info.duration = Math.floor(this._mediaElement.duration * 1000);\n                if (this._mediaElement instanceof HTMLVideoElement) {\n                    info.width = this._mediaElement.videoWidth;\n                    info.height = this._mediaElement.videoHeight;\n                }\n            }\n            return info;\n        }\n    }, {\n        key: 'statisticsInfo',\n        get: function get() {\n            var info = {\n                playerType: this._type,\n                url: this._mediaDataSource.url\n            };\n\n            if (!(this._mediaElement instanceof HTMLVideoElement)) {\n                return info;\n            }\n\n            var hasQualityInfo = true;\n            var decoded = 0;\n            var dropped = 0;\n\n            if (this._mediaElement.getVideoPlaybackQuality) {\n                var quality = this._mediaElement.getVideoPlaybackQuality();\n                decoded = quality.totalVideoFrames;\n                dropped = quality.droppedVideoFrames;\n            } else if (this._mediaElement.webkitDecodedFrameCount != undefined) {\n                decoded = this._mediaElement.webkitDecodedFrameCount;\n                dropped = this._mediaElement.webkitDroppedFrameCount;\n            } else {\n                hasQualityInfo = false;\n            }\n\n            if (hasQualityInfo) {\n                info.decodedFrames = decoded;\n                info.droppedFrames = dropped;\n            }\n\n            return info;\n        }\n    }]);\n\n    return NativePlayer;\n}();\n\nexports.default = NativePlayer;\n\n},{\"../config.js\":5,\"../utils/exception.js\":40,\"./player-events.js\":35,\"events\":2}],34:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.ErrorDetails = exports.ErrorTypes = undefined;\n\nvar _loader = _dereq_('../io/loader.js');\n\nvar _demuxErrors = _dereq_('../demux/demux-errors.js');\n\nvar _demuxErrors2 = _interopRequireDefault(_demuxErrors);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar ErrorTypes = exports.ErrorTypes = {\n    NETWORK_ERROR: 'NetworkError',\n    MEDIA_ERROR: 'MediaError',\n    OTHER_ERROR: 'OtherError'\n};\n\nvar ErrorDetails = exports.ErrorDetails = {\n    NETWORK_EXCEPTION: _loader.LoaderErrors.EXCEPTION,\n    NETWORK_STATUS_CODE_INVALID: _loader.LoaderErrors.HTTP_STATUS_CODE_INVALID,\n    NETWORK_TIMEOUT: _loader.LoaderErrors.CONNECTING_TIMEOUT,\n    NETWORK_UNRECOVERABLE_EARLY_EOF: _loader.LoaderErrors.UNRECOVERABLE_EARLY_EOF,\n\n    MEDIA_MSE_ERROR: 'MediaMSEError',\n\n    MEDIA_FORMAT_ERROR: _demuxErrors2.default.FORMAT_ERROR,\n    MEDIA_FORMAT_UNSUPPORTED: _demuxErrors2.default.FORMAT_UNSUPPORTED,\n    MEDIA_CODEC_UNSUPPORTED: _demuxErrors2.default.CODEC_UNSUPPORTED\n};\n\n},{\"../demux/demux-errors.js\":16,\"../io/loader.js\":24}],35:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar PlayerEvents = {\n  ERROR: 'error',\n  LOADING_COMPLETE: 'loading_complete',\n  RECOVERED_EARLY_EOF: 'recovered_early_eof',\n  MEDIA_INFO: 'media_info',\n  METADATA_ARRIVED: 'metadata_arrived',\n  SCRIPTDATA_ARRIVED: 'scriptdata_arrived',\n  STATISTICS_INFO: 'statistics_info'\n};\n\nexports.default = PlayerEvents;\n\n},{}],36:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * This file is modified from dailymotion's hls.js library (hls.js/src/helper/aac.js)\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar AAC = function () {\n    function AAC() {\n        _classCallCheck(this, AAC);\n    }\n\n    _createClass(AAC, null, [{\n        key: 'getSilentFrame',\n        value: function getSilentFrame(codec, channelCount) {\n            if (codec === 'mp4a.40.2') {\n                // handle LC-AAC\n                if (channelCount === 1) {\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x23, 0x80]);\n                } else if (channelCount === 2) {\n                    return new Uint8Array([0x21, 0x00, 0x49, 0x90, 0x02, 0x19, 0x00, 0x23, 0x80]);\n                } else if (channelCount === 3) {\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x8e]);\n                } else if (channelCount === 4) {\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x80, 0x2c, 0x80, 0x08, 0x02, 0x38]);\n                } else if (channelCount === 5) {\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x38]);\n                } else if (channelCount === 6) {\n                    return new Uint8Array([0x00, 0xc8, 0x00, 0x80, 0x20, 0x84, 0x01, 0x26, 0x40, 0x08, 0x64, 0x00, 0x82, 0x30, 0x04, 0x99, 0x00, 0x21, 0x90, 0x02, 0x00, 0xb2, 0x00, 0x20, 0x08, 0xe0]);\n                }\n            } else {\n                // handle HE-AAC (mp4a.40.5 / mp4a.40.29)\n                if (channelCount === 1) {\n                    // ffmpeg -y -f lavfi -i \"aevalsrc=0:d=0.05\" -c:a libfdk_aac -profile:a aac_he -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n                    return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x4e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x1c, 0x6, 0xf1, 0xc1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\n                } else if (channelCount === 2) {\n                    // ffmpeg -y -f lavfi -i \"aevalsrc=0|0:d=0.05\" -c:a libfdk_aac -profile:a aac_he_v2 -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n                    return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x5e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x0, 0x95, 0x0, 0x6, 0xf1, 0xa1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\n                } else if (channelCount === 3) {\n                    // ffmpeg -y -f lavfi -i \"aevalsrc=0|0|0:d=0.05\" -c:a libfdk_aac -profile:a aac_he_v2 -b:a 4k output.aac && hexdump -v -e '16/1 \"0x%x,\" \"\\n\"' -v output.aac\n                    return new Uint8Array([0x1, 0x40, 0x22, 0x80, 0xa3, 0x5e, 0xe6, 0x80, 0xba, 0x8, 0x0, 0x0, 0x0, 0x0, 0x95, 0x0, 0x6, 0xf1, 0xa1, 0xa, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5a, 0x5e]);\n                }\n            }\n            return null;\n        }\n    }]);\n\n    return AAC;\n}();\n\nexports.default = AAC;\n\n},{}],37:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * This file is derived from dailymotion's hls.js library (hls.js/src/remux/mp4-generator.js)\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\n//  MP4 boxes generator for ISO BMFF (ISO Base Media File Format, defined in ISO/IEC 14496-12)\nvar MP4 = function () {\n    function MP4() {\n        _classCallCheck(this, MP4);\n    }\n\n    _createClass(MP4, null, [{\n        key: 'init',\n        value: function init() {\n            MP4.types = {\n                avc1: [], avcC: [], btrt: [], dinf: [],\n                dref: [], esds: [], ftyp: [], hdlr: [],\n                mdat: [], mdhd: [], mdia: [], mfhd: [],\n                minf: [], moof: [], moov: [], mp4a: [],\n                mvex: [], mvhd: [], sdtp: [], stbl: [],\n                stco: [], stsc: [], stsd: [], stsz: [],\n                stts: [], tfdt: [], tfhd: [], traf: [],\n                trak: [], trun: [], trex: [], tkhd: [],\n                vmhd: [], smhd: [], '.mp3': []\n            };\n\n            for (var name in MP4.types) {\n                if (MP4.types.hasOwnProperty(name)) {\n                    MP4.types[name] = [name.charCodeAt(0), name.charCodeAt(1), name.charCodeAt(2), name.charCodeAt(3)];\n                }\n            }\n\n            var constants = MP4.constants = {};\n\n            constants.FTYP = new Uint8Array([0x69, 0x73, 0x6F, 0x6D, // major_brand: isom\n            0x0, 0x0, 0x0, 0x1, // minor_version: 0x01\n            0x69, 0x73, 0x6F, 0x6D, // isom\n            0x61, 0x76, 0x63, 0x31 // avc1\n            ]);\n\n            constants.STSD_PREFIX = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x01 // entry_count\n            ]);\n\n            constants.STTS = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00 // entry_count\n            ]);\n\n            constants.STSC = constants.STCO = constants.STTS;\n\n            constants.STSZ = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // sample_size\n            0x00, 0x00, 0x00, 0x00 // sample_count\n            ]);\n\n            constants.HDLR_VIDEO = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // pre_defined\n            0x76, 0x69, 0x64, 0x65, // handler_type: 'vide'\n            0x00, 0x00, 0x00, 0x00, // reserved: 3 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x56, 0x69, 0x64, 0x65, 0x6F, 0x48, 0x61, 0x6E, 0x64, 0x6C, 0x65, 0x72, 0x00 // name: VideoHandler\n            ]);\n\n            constants.HDLR_AUDIO = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // pre_defined\n            0x73, 0x6F, 0x75, 0x6E, // handler_type: 'soun'\n            0x00, 0x00, 0x00, 0x00, // reserved: 3 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x53, 0x6F, 0x75, 0x6E, 0x64, 0x48, 0x61, 0x6E, 0x64, 0x6C, 0x65, 0x72, 0x00 // name: SoundHandler\n            ]);\n\n            constants.DREF = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x01, // entry_count\n            0x00, 0x00, 0x00, 0x0C, // entry_size\n            0x75, 0x72, 0x6C, 0x20, // type 'url '\n            0x00, 0x00, 0x00, 0x01 // version(0) + flags\n            ]);\n\n            // Sound media header\n            constants.SMHD = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00 // balance(2) + reserved(2)\n            ]);\n\n            // video media header\n            constants.VMHD = new Uint8Array([0x00, 0x00, 0x00, 0x01, // version(0) + flags\n            0x00, 0x00, // graphicsmode: 2 bytes\n            0x00, 0x00, 0x00, 0x00, // opcolor: 3 * 2 bytes\n            0x00, 0x00]);\n        }\n\n        // Generate a box\n\n    }, {\n        key: 'box',\n        value: function box(type) {\n            var size = 8;\n            var result = null;\n            var datas = Array.prototype.slice.call(arguments, 1);\n            var arrayCount = datas.length;\n\n            for (var i = 0; i < arrayCount; i++) {\n                size += datas[i].byteLength;\n            }\n\n            result = new Uint8Array(size);\n            result[0] = size >>> 24 & 0xFF; // size\n            result[1] = size >>> 16 & 0xFF;\n            result[2] = size >>> 8 & 0xFF;\n            result[3] = size & 0xFF;\n\n            result.set(type, 4); // type\n\n            var offset = 8;\n            for (var _i = 0; _i < arrayCount; _i++) {\n                // data body\n                result.set(datas[_i], offset);\n                offset += datas[_i].byteLength;\n            }\n\n            return result;\n        }\n\n        // emit ftyp & moov\n\n    }, {\n        key: 'generateInitSegment',\n        value: function generateInitSegment(meta) {\n            var ftyp = MP4.box(MP4.types.ftyp, MP4.constants.FTYP);\n            var moov = MP4.moov(meta);\n\n            var result = new Uint8Array(ftyp.byteLength + moov.byteLength);\n            result.set(ftyp, 0);\n            result.set(moov, ftyp.byteLength);\n            return result;\n        }\n\n        // Movie metadata box\n\n    }, {\n        key: 'moov',\n        value: function moov(meta) {\n            var mvhd = MP4.mvhd(meta.timescale, meta.duration);\n            var trak = MP4.trak(meta);\n            var mvex = MP4.mvex(meta);\n            return MP4.box(MP4.types.moov, mvhd, trak, mvex);\n        }\n\n        // Movie header box\n\n    }, {\n        key: 'mvhd',\n        value: function mvhd(timescale, duration) {\n            return MP4.box(MP4.types.mvhd, new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // creation_time\n            0x00, 0x00, 0x00, 0x00, // modification_time\n            timescale >>> 24 & 0xFF, // timescale: 4 bytes\n            timescale >>> 16 & 0xFF, timescale >>> 8 & 0xFF, timescale & 0xFF, duration >>> 24 & 0xFF, // duration: 4 bytes\n            duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, 0x00, 0x01, 0x00, 0x00, // Preferred rate: 1.0\n            0x01, 0x00, 0x00, 0x00, // PreferredVolume(1.0, 2bytes) + reserved(2bytes)\n            0x00, 0x00, 0x00, 0x00, // reserved: 4 + 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, // ----begin composition matrix----\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, // ----end composition matrix----\n            0x00, 0x00, 0x00, 0x00, // ----begin pre_defined 6 * 4 bytes----\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // ----end pre_defined 6 * 4 bytes----\n            0xFF, 0xFF, 0xFF, 0xFF // next_track_ID\n            ]));\n        }\n\n        // Track box\n\n    }, {\n        key: 'trak',\n        value: function trak(meta) {\n            return MP4.box(MP4.types.trak, MP4.tkhd(meta), MP4.mdia(meta));\n        }\n\n        // Track header box\n\n    }, {\n        key: 'tkhd',\n        value: function tkhd(meta) {\n            var trackId = meta.id,\n                duration = meta.duration;\n            var width = meta.presentWidth,\n                height = meta.presentHeight;\n\n            return MP4.box(MP4.types.tkhd, new Uint8Array([0x00, 0x00, 0x00, 0x07, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // creation_time\n            0x00, 0x00, 0x00, 0x00, // modification_time\n            trackId >>> 24 & 0xFF, // track_ID: 4 bytes\n            trackId >>> 16 & 0xFF, trackId >>> 8 & 0xFF, trackId & 0xFF, 0x00, 0x00, 0x00, 0x00, // reserved: 4 bytes\n            duration >>> 24 & 0xFF, // duration: 4 bytes\n            duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, 0x00, 0x00, 0x00, 0x00, // reserved: 2 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, // layer(2bytes) + alternate_group(2bytes)\n            0x00, 0x00, 0x00, 0x00, // volume(2bytes) + reserved(2bytes)\n            0x00, 0x01, 0x00, 0x00, // ----begin composition matrix----\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x40, 0x00, 0x00, 0x00, // ----end composition matrix----\n            width >>> 8 & 0xFF, // width and height\n            width & 0xFF, 0x00, 0x00, height >>> 8 & 0xFF, height & 0xFF, 0x00, 0x00]));\n        }\n\n        // Media Box\n\n    }, {\n        key: 'mdia',\n        value: function mdia(meta) {\n            return MP4.box(MP4.types.mdia, MP4.mdhd(meta), MP4.hdlr(meta), MP4.minf(meta));\n        }\n\n        // Media header box\n\n    }, {\n        key: 'mdhd',\n        value: function mdhd(meta) {\n            var timescale = meta.timescale;\n            var duration = meta.duration;\n            return MP4.box(MP4.types.mdhd, new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            0x00, 0x00, 0x00, 0x00, // creation_time\n            0x00, 0x00, 0x00, 0x00, // modification_time\n            timescale >>> 24 & 0xFF, // timescale: 4 bytes\n            timescale >>> 16 & 0xFF, timescale >>> 8 & 0xFF, timescale & 0xFF, duration >>> 24 & 0xFF, // duration: 4 bytes\n            duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, 0x55, 0xC4, // language: und (undetermined)\n            0x00, 0x00 // pre_defined = 0\n            ]));\n        }\n\n        // Media handler reference box\n\n    }, {\n        key: 'hdlr',\n        value: function hdlr(meta) {\n            var data = null;\n            if (meta.type === 'audio') {\n                data = MP4.constants.HDLR_AUDIO;\n            } else {\n                data = MP4.constants.HDLR_VIDEO;\n            }\n            return MP4.box(MP4.types.hdlr, data);\n        }\n\n        // Media infomation box\n\n    }, {\n        key: 'minf',\n        value: function minf(meta) {\n            var xmhd = null;\n            if (meta.type === 'audio') {\n                xmhd = MP4.box(MP4.types.smhd, MP4.constants.SMHD);\n            } else {\n                xmhd = MP4.box(MP4.types.vmhd, MP4.constants.VMHD);\n            }\n            return MP4.box(MP4.types.minf, xmhd, MP4.dinf(), MP4.stbl(meta));\n        }\n\n        // Data infomation box\n\n    }, {\n        key: 'dinf',\n        value: function dinf() {\n            var result = MP4.box(MP4.types.dinf, MP4.box(MP4.types.dref, MP4.constants.DREF));\n            return result;\n        }\n\n        // Sample table box\n\n    }, {\n        key: 'stbl',\n        value: function stbl(meta) {\n            var result = MP4.box(MP4.types.stbl, // type: stbl\n            MP4.stsd(meta), // Sample Description Table\n            MP4.box(MP4.types.stts, MP4.constants.STTS), // Time-To-Sample\n            MP4.box(MP4.types.stsc, MP4.constants.STSC), // Sample-To-Chunk\n            MP4.box(MP4.types.stsz, MP4.constants.STSZ), // Sample size\n            MP4.box(MP4.types.stco, MP4.constants.STCO // Chunk offset\n            ));\n            return result;\n        }\n\n        // Sample description box\n\n    }, {\n        key: 'stsd',\n        value: function stsd(meta) {\n            if (meta.type === 'audio') {\n                if (meta.codec === 'mp3') {\n                    return MP4.box(MP4.types.stsd, MP4.constants.STSD_PREFIX, MP4.mp3(meta));\n                }\n                // else: aac -> mp4a\n                return MP4.box(MP4.types.stsd, MP4.constants.STSD_PREFIX, MP4.mp4a(meta));\n            } else {\n                return MP4.box(MP4.types.stsd, MP4.constants.STSD_PREFIX, MP4.avc1(meta));\n            }\n        }\n    }, {\n        key: 'mp3',\n        value: function mp3(meta) {\n            var channelCount = meta.channelCount;\n            var sampleRate = meta.audioSampleRate;\n\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // reserved(4)\n            0x00, 0x00, 0x00, 0x01, // reserved(2) + data_reference_index(2)\n            0x00, 0x00, 0x00, 0x00, // reserved: 2 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, channelCount, // channelCount(2)\n            0x00, 0x10, // sampleSize(2)\n            0x00, 0x00, 0x00, 0x00, // reserved(4)\n            sampleRate >>> 8 & 0xFF, // Audio sample rate\n            sampleRate & 0xFF, 0x00, 0x00]);\n\n            return MP4.box(MP4.types['.mp3'], data);\n        }\n    }, {\n        key: 'mp4a',\n        value: function mp4a(meta) {\n            var channelCount = meta.channelCount;\n            var sampleRate = meta.audioSampleRate;\n\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // reserved(4)\n            0x00, 0x00, 0x00, 0x01, // reserved(2) + data_reference_index(2)\n            0x00, 0x00, 0x00, 0x00, // reserved: 2 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, channelCount, // channelCount(2)\n            0x00, 0x10, // sampleSize(2)\n            0x00, 0x00, 0x00, 0x00, // reserved(4)\n            sampleRate >>> 8 & 0xFF, // Audio sample rate\n            sampleRate & 0xFF, 0x00, 0x00]);\n\n            return MP4.box(MP4.types.mp4a, data, MP4.esds(meta));\n        }\n    }, {\n        key: 'esds',\n        value: function esds(meta) {\n            var config = meta.config || [];\n            var configSize = config.length;\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version 0 + flags\n\n            0x03, // descriptor_type\n            0x17 + configSize, // length3\n            0x00, 0x01, // es_id\n            0x00, // stream_priority\n\n            0x04, // descriptor_type\n            0x0F + configSize, // length\n            0x40, // codec: mpeg4_audio\n            0x15, // stream_type: Audio\n            0x00, 0x00, 0x00, // buffer_size\n            0x00, 0x00, 0x00, 0x00, // maxBitrate\n            0x00, 0x00, 0x00, 0x00, // avgBitrate\n\n            0x05 // descriptor_type\n            ].concat([configSize]).concat(config).concat([0x06, 0x01, 0x02 // GASpecificConfig\n            ]));\n            return MP4.box(MP4.types.esds, data);\n        }\n    }, {\n        key: 'avc1',\n        value: function avc1(meta) {\n            var avcc = meta.avcc;\n            var width = meta.codecWidth,\n                height = meta.codecHeight;\n\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // reserved(4)\n            0x00, 0x00, 0x00, 0x01, // reserved(2) + data_reference_index(2)\n            0x00, 0x00, 0x00, 0x00, // pre_defined(2) + reserved(2)\n            0x00, 0x00, 0x00, 0x00, // pre_defined: 3 * 4 bytes\n            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, width >>> 8 & 0xFF, // width: 2 bytes\n            width & 0xFF, height >>> 8 & 0xFF, // height: 2 bytes\n            height & 0xFF, 0x00, 0x48, 0x00, 0x00, // horizresolution: 4 bytes\n            0x00, 0x48, 0x00, 0x00, // vertresolution: 4 bytes\n            0x00, 0x00, 0x00, 0x00, // reserved: 4 bytes\n            0x00, 0x01, // frame_count\n            0x0A, // strlen\n            0x78, 0x71, 0x71, 0x2F, // compressorname: 32 bytes\n            0x66, 0x6C, 0x76, 0x2E, 0x6A, 0x73, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x18, // depth\n            0xFF, 0xFF // pre_defined = -1\n            ]);\n            return MP4.box(MP4.types.avc1, data, MP4.box(MP4.types.avcC, avcc));\n        }\n\n        // Movie Extends box\n\n    }, {\n        key: 'mvex',\n        value: function mvex(meta) {\n            return MP4.box(MP4.types.mvex, MP4.trex(meta));\n        }\n\n        // Track Extends box\n\n    }, {\n        key: 'trex',\n        value: function trex(meta) {\n            var trackId = meta.id;\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) + flags\n            trackId >>> 24 & 0xFF, // track_ID\n            trackId >>> 16 & 0xFF, trackId >>> 8 & 0xFF, trackId & 0xFF, 0x00, 0x00, 0x00, 0x01, // default_sample_description_index\n            0x00, 0x00, 0x00, 0x00, // default_sample_duration\n            0x00, 0x00, 0x00, 0x00, // default_sample_size\n            0x00, 0x01, 0x00, 0x01 // default_sample_flags\n            ]);\n            return MP4.box(MP4.types.trex, data);\n        }\n\n        // Movie fragment box\n\n    }, {\n        key: 'moof',\n        value: function moof(track, baseMediaDecodeTime) {\n            return MP4.box(MP4.types.moof, MP4.mfhd(track.sequenceNumber), MP4.traf(track, baseMediaDecodeTime));\n        }\n    }, {\n        key: 'mfhd',\n        value: function mfhd(sequenceNumber) {\n            var data = new Uint8Array([0x00, 0x00, 0x00, 0x00, sequenceNumber >>> 24 & 0xFF, // sequence_number: int32\n            sequenceNumber >>> 16 & 0xFF, sequenceNumber >>> 8 & 0xFF, sequenceNumber & 0xFF]);\n            return MP4.box(MP4.types.mfhd, data);\n        }\n\n        // Track fragment box\n\n    }, {\n        key: 'traf',\n        value: function traf(track, baseMediaDecodeTime) {\n            var trackId = track.id;\n\n            // Track fragment header box\n            var tfhd = MP4.box(MP4.types.tfhd, new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) & flags\n            trackId >>> 24 & 0xFF, // track_ID\n            trackId >>> 16 & 0xFF, trackId >>> 8 & 0xFF, trackId & 0xFF]));\n            // Track Fragment Decode Time\n            var tfdt = MP4.box(MP4.types.tfdt, new Uint8Array([0x00, 0x00, 0x00, 0x00, // version(0) & flags\n            baseMediaDecodeTime >>> 24 & 0xFF, // baseMediaDecodeTime: int32\n            baseMediaDecodeTime >>> 16 & 0xFF, baseMediaDecodeTime >>> 8 & 0xFF, baseMediaDecodeTime & 0xFF]));\n            var sdtp = MP4.sdtp(track);\n            var trun = MP4.trun(track, sdtp.byteLength + 16 + 16 + 8 + 16 + 8 + 8);\n\n            return MP4.box(MP4.types.traf, tfhd, tfdt, trun, sdtp);\n        }\n\n        // Sample Dependency Type box\n\n    }, {\n        key: 'sdtp',\n        value: function sdtp(track) {\n            var samples = track.samples || [];\n            var sampleCount = samples.length;\n            var data = new Uint8Array(4 + sampleCount);\n            // 0~4 bytes: version(0) & flags\n            for (var i = 0; i < sampleCount; i++) {\n                var flags = samples[i].flags;\n                data[i + 4] = flags.isLeading << 6 | // is_leading: 2 (bit)\n                flags.dependsOn << 4 // sample_depends_on\n                | flags.isDependedOn << 2 // sample_is_depended_on\n                | flags.hasRedundancy; // sample_has_redundancy\n            }\n            return MP4.box(MP4.types.sdtp, data);\n        }\n\n        // Track fragment run box\n\n    }, {\n        key: 'trun',\n        value: function trun(track, offset) {\n            var samples = track.samples || [];\n            var sampleCount = samples.length;\n            var dataSize = 12 + 16 * sampleCount;\n            var data = new Uint8Array(dataSize);\n            offset += 8 + dataSize;\n\n            data.set([0x00, 0x00, 0x0F, 0x01, // version(0) & flags\n            sampleCount >>> 24 & 0xFF, // sample_count\n            sampleCount >>> 16 & 0xFF, sampleCount >>> 8 & 0xFF, sampleCount & 0xFF, offset >>> 24 & 0xFF, // data_offset\n            offset >>> 16 & 0xFF, offset >>> 8 & 0xFF, offset & 0xFF], 0);\n\n            for (var i = 0; i < sampleCount; i++) {\n                var duration = samples[i].duration;\n                var size = samples[i].size;\n                var flags = samples[i].flags;\n                var cts = samples[i].cts;\n                data.set([duration >>> 24 & 0xFF, // sample_duration\n                duration >>> 16 & 0xFF, duration >>> 8 & 0xFF, duration & 0xFF, size >>> 24 & 0xFF, // sample_size\n                size >>> 16 & 0xFF, size >>> 8 & 0xFF, size & 0xFF, flags.isLeading << 2 | flags.dependsOn, // sample_flags\n                flags.isDependedOn << 6 | flags.hasRedundancy << 4 | flags.isNonSync, 0x00, 0x00, // sample_degradation_priority\n                cts >>> 24 & 0xFF, // sample_composition_time_offset\n                cts >>> 16 & 0xFF, cts >>> 8 & 0xFF, cts & 0xFF], 12 + 16 * i);\n            }\n            return MP4.box(MP4.types.trun, data);\n        }\n    }, {\n        key: 'mdat',\n        value: function mdat(data) {\n            return MP4.box(MP4.types.mdat, data);\n        }\n    }]);\n\n    return MP4;\n}();\n\nMP4.init();\n\nexports.default = MP4;\n\n},{}],38:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _logger = _dereq_('../utils/logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nvar _mp4Generator = _dereq_('./mp4-generator.js');\n\nvar _mp4Generator2 = _interopRequireDefault(_mp4Generator);\n\nvar _aacSilent = _dereq_('./aac-silent.js');\n\nvar _aacSilent2 = _interopRequireDefault(_aacSilent);\n\nvar _browser = _dereq_('../utils/browser.js');\n\nvar _browser2 = _interopRequireDefault(_browser);\n\nvar _mediaSegmentInfo = _dereq_('../core/media-segment-info.js');\n\nvar _exception = _dereq_('../utils/exception.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n// Fragmented mp4 remuxer\nvar MP4Remuxer = function () {\n    function MP4Remuxer(config) {\n        _classCallCheck(this, MP4Remuxer);\n\n        this.TAG = 'MP4Remuxer';\n\n        this._config = config;\n        this._isLive = config.isLive === true ? true : false;\n\n        this._dtsBase = -1;\n        this._dtsBaseInited = false;\n        this._audioDtsBase = Infinity;\n        this._videoDtsBase = Infinity;\n        this._audioNextDts = undefined;\n        this._videoNextDts = undefined;\n        this._audioStashedLastSample = null;\n        this._videoStashedLastSample = null;\n\n        this._audioMeta = null;\n        this._videoMeta = null;\n\n        this._audioSegmentInfoList = new _mediaSegmentInfo.MediaSegmentInfoList('audio');\n        this._videoSegmentInfoList = new _mediaSegmentInfo.MediaSegmentInfoList('video');\n\n        this._onInitSegment = null;\n        this._onMediaSegment = null;\n\n        // Workaround for chrome < 50: Always force first sample as a Random Access Point in media segment\n        // see https://bugs.chromium.org/p/chromium/issues/detail?id=229412\n        this._forceFirstIDR = _browser2.default.chrome && (_browser2.default.version.major < 50 || _browser2.default.version.major === 50 && _browser2.default.version.build < 2661) ? true : false;\n\n        // Workaround for IE11/Edge: Fill silent aac frame after keyframe-seeking\n        // Make audio beginDts equals with video beginDts, in order to fix seek freeze\n        this._fillSilentAfterSeek = _browser2.default.msedge || _browser2.default.msie;\n\n        // While only FireFox supports 'audio/mp4, codecs=\"mp3\"', use 'audio/mpeg' for chrome, safari, ...\n        this._mp3UseMpegAudio = !_browser2.default.firefox;\n\n        this._fillAudioTimestampGap = this._config.fixAudioTimestampGap;\n    }\n\n    _createClass(MP4Remuxer, [{\n        key: 'destroy',\n        value: function destroy() {\n            this._dtsBase = -1;\n            this._dtsBaseInited = false;\n            this._audioMeta = null;\n            this._videoMeta = null;\n            this._audioSegmentInfoList.clear();\n            this._audioSegmentInfoList = null;\n            this._videoSegmentInfoList.clear();\n            this._videoSegmentInfoList = null;\n            this._onInitSegment = null;\n            this._onMediaSegment = null;\n        }\n    }, {\n        key: 'bindDataSource',\n        value: function bindDataSource(producer) {\n            producer.onDataAvailable = this.remux.bind(this);\n            producer.onTrackMetadata = this._onTrackMetadataReceived.bind(this);\n            return this;\n        }\n\n        /* prototype: function onInitSegment(type: string, initSegment: ArrayBuffer): void\r\n           InitSegment: {\r\n               type: string,\r\n               data: ArrayBuffer,\r\n               codec: string,\r\n               container: string\r\n           }\r\n        */\n\n    }, {\n        key: 'insertDiscontinuity',\n        value: function insertDiscontinuity() {\n            this._audioNextDts = this._videoNextDts = undefined;\n        }\n    }, {\n        key: 'seek',\n        value: function seek(originalDts) {\n            this._audioStashedLastSample = null;\n            this._videoStashedLastSample = null;\n            this._videoSegmentInfoList.clear();\n            this._audioSegmentInfoList.clear();\n        }\n    }, {\n        key: 'remux',\n        value: function remux(audioTrack, videoTrack) {\n            if (!this._onMediaSegment) {\n                throw new _exception.IllegalStateException('MP4Remuxer: onMediaSegment callback must be specificed!');\n            }\n            if (!this._dtsBaseInited) {\n                this._calculateDtsBase(audioTrack, videoTrack);\n            }\n            this._remuxVideo(videoTrack);\n            this._remuxAudio(audioTrack);\n        }\n    }, {\n        key: '_onTrackMetadataReceived',\n        value: function _onTrackMetadataReceived(type, metadata) {\n            var metabox = null;\n\n            var container = 'mp4';\n            var codec = metadata.codec;\n\n            if (type === 'audio') {\n                this._audioMeta = metadata;\n                if (metadata.codec === 'mp3' && this._mp3UseMpegAudio) {\n                    // 'audio/mpeg' for MP3 audio track\n                    container = 'mpeg';\n                    codec = '';\n                    metabox = new Uint8Array();\n                } else {\n                    // 'audio/mp4, codecs=\"codec\"'\n                    metabox = _mp4Generator2.default.generateInitSegment(metadata);\n                }\n            } else if (type === 'video') {\n                this._videoMeta = metadata;\n                metabox = _mp4Generator2.default.generateInitSegment(metadata);\n            } else {\n                return;\n            }\n\n            // dispatch metabox (Initialization Segment)\n            if (!this._onInitSegment) {\n                throw new _exception.IllegalStateException('MP4Remuxer: onInitSegment callback must be specified!');\n            }\n            this._onInitSegment(type, {\n                type: type,\n                data: metabox.buffer,\n                codec: codec,\n                container: type + '/' + container,\n                mediaDuration: metadata.duration // in timescale 1000 (milliseconds)\n            });\n        }\n    }, {\n        key: '_calculateDtsBase',\n        value: function _calculateDtsBase(audioTrack, videoTrack) {\n            if (this._dtsBaseInited) {\n                return;\n            }\n\n            if (audioTrack.samples && audioTrack.samples.length) {\n                this._audioDtsBase = audioTrack.samples[0].dts;\n            }\n            if (videoTrack.samples && videoTrack.samples.length) {\n                this._videoDtsBase = videoTrack.samples[0].dts;\n            }\n\n            this._dtsBase = Math.min(this._audioDtsBase, this._videoDtsBase);\n            this._dtsBaseInited = true;\n        }\n    }, {\n        key: 'flushStashedSamples',\n        value: function flushStashedSamples() {\n            var videoSample = this._videoStashedLastSample;\n            var audioSample = this._audioStashedLastSample;\n\n            var videoTrack = {\n                type: 'video',\n                id: 1,\n                sequenceNumber: 0,\n                samples: [],\n                length: 0\n            };\n\n            if (videoSample != null) {\n                videoTrack.samples.push(videoSample);\n                videoTrack.length = videoSample.length;\n            }\n\n            var audioTrack = {\n                type: 'audio',\n                id: 2,\n                sequenceNumber: 0,\n                samples: [],\n                length: 0\n            };\n\n            if (audioSample != null) {\n                audioTrack.samples.push(audioSample);\n                audioTrack.length = audioSample.length;\n            }\n\n            this._videoStashedLastSample = null;\n            this._audioStashedLastSample = null;\n\n            this._remuxVideo(videoTrack, true);\n            this._remuxAudio(audioTrack, true);\n        }\n    }, {\n        key: '_remuxAudio',\n        value: function _remuxAudio(audioTrack, force) {\n            if (this._audioMeta == null) {\n                return;\n            }\n\n            var track = audioTrack;\n            var samples = track.samples;\n            var dtsCorrection = undefined;\n            var firstDts = -1,\n                lastDts = -1,\n                lastPts = -1;\n            var refSampleDuration = this._audioMeta.refSampleDuration;\n\n            var mpegRawTrack = this._audioMeta.codec === 'mp3' && this._mp3UseMpegAudio;\n            var firstSegmentAfterSeek = this._dtsBaseInited && this._audioNextDts === undefined;\n\n            var insertPrefixSilentFrame = false;\n\n            if (!samples || samples.length === 0) {\n                return;\n            }\n            if (samples.length === 1 && !force) {\n                // If [sample count in current batch] === 1 && (force != true)\n                // Ignore and keep in demuxer's queue\n                return;\n            } // else if (force === true) do remux\n\n            var offset = 0;\n            var mdatbox = null;\n            var mdatBytes = 0;\n\n            // calculate initial mdat size\n            if (mpegRawTrack) {\n                // for raw mpeg buffer\n                offset = 0;\n                mdatBytes = track.length;\n            } else {\n                // for fmp4 mdat box\n                offset = 8; // size + type\n                mdatBytes = 8 + track.length;\n            }\n\n            var lastSample = null;\n\n            // Pop the lastSample and waiting for stash\n            if (samples.length > 1) {\n                lastSample = samples.pop();\n                mdatBytes -= lastSample.length;\n            }\n\n            // Insert [stashed lastSample in the previous batch] to the front\n            if (this._audioStashedLastSample != null) {\n                var sample = this._audioStashedLastSample;\n                this._audioStashedLastSample = null;\n                samples.unshift(sample);\n                mdatBytes += sample.length;\n            }\n\n            // Stash the lastSample of current batch, waiting for next batch\n            if (lastSample != null) {\n                this._audioStashedLastSample = lastSample;\n            }\n\n            var firstSampleOriginalDts = samples[0].dts - this._dtsBase;\n\n            // calculate dtsCorrection\n            if (this._audioNextDts) {\n                dtsCorrection = firstSampleOriginalDts - this._audioNextDts;\n            } else {\n                // this._audioNextDts == undefined\n                if (this._audioSegmentInfoList.isEmpty()) {\n                    dtsCorrection = 0;\n                    if (this._fillSilentAfterSeek && !this._videoSegmentInfoList.isEmpty()) {\n                        if (this._audioMeta.originalCodec !== 'mp3') {\n                            insertPrefixSilentFrame = true;\n                        }\n                    }\n                } else {\n                    var _lastSample = this._audioSegmentInfoList.getLastSampleBefore(firstSampleOriginalDts);\n                    if (_lastSample != null) {\n                        var distance = firstSampleOriginalDts - (_lastSample.originalDts + _lastSample.duration);\n                        if (distance <= 3) {\n                            distance = 0;\n                        }\n                        var expectedDts = _lastSample.dts + _lastSample.duration + distance;\n                        dtsCorrection = firstSampleOriginalDts - expectedDts;\n                    } else {\n                        // lastSample == null, cannot found\n                        dtsCorrection = 0;\n                    }\n                }\n            }\n\n            if (insertPrefixSilentFrame) {\n                // align audio segment beginDts to match with current video segment's beginDts\n                var firstSampleDts = firstSampleOriginalDts - dtsCorrection;\n                var videoSegment = this._videoSegmentInfoList.getLastSegmentBefore(firstSampleOriginalDts);\n                if (videoSegment != null && videoSegment.beginDts < firstSampleDts) {\n                    var silentUnit = _aacSilent2.default.getSilentFrame(this._audioMeta.originalCodec, this._audioMeta.channelCount);\n                    if (silentUnit) {\n                        var dts = videoSegment.beginDts;\n                        var silentFrameDuration = firstSampleDts - videoSegment.beginDts;\n                        _logger2.default.v(this.TAG, 'InsertPrefixSilentAudio: dts: ' + dts + ', duration: ' + silentFrameDuration);\n                        samples.unshift({ unit: silentUnit, dts: dts, pts: dts });\n                        mdatBytes += silentUnit.byteLength;\n                    } // silentUnit == null: Cannot generate, skip\n                } else {\n                    insertPrefixSilentFrame = false;\n                }\n            }\n\n            var mp4Samples = [];\n\n            // Correct dts for each sample, and calculate sample duration. Then output to mp4Samples\n            for (var i = 0; i < samples.length; i++) {\n                var _sample = samples[i];\n                var unit = _sample.unit;\n                var originalDts = _sample.dts - this._dtsBase;\n                var _dts = originalDts;\n                var needFillSilentFrames = false;\n                var silentFrames = null;\n                var sampleDuration = 0;\n\n                if (originalDts < -0.001) {\n                    continue; //pass the first sample with the invalid dts\n                }\n\n                if (this._audioMeta.codec !== 'mp3') {\n                    // for AAC codec, we need to keep dts increase based on refSampleDuration\n                    var curRefDts = originalDts;\n                    var maxAudioFramesDrift = 3;\n                    if (this._audioNextDts) {\n                        curRefDts = this._audioNextDts;\n                    }\n\n                    dtsCorrection = originalDts - curRefDts;\n                    if (dtsCorrection <= -maxAudioFramesDrift * refSampleDuration) {\n                        // If we're overlapping by more than maxAudioFramesDrift number of frame, drop this sample\n                        //Log.w(this.TAG, `Dropping 1 audio frame (originalDts: ${originalDts} ms ,curRefDts: ${curRefDts} ms)  due to dtsCorrection: ${dtsCorrection} ms overlap.`);\n                        continue;\n                    } else if (dtsCorrection >= maxAudioFramesDrift * refSampleDuration && this._fillAudioTimestampGap && !_browser2.default.safari) {\n                        // Silent frame generation, if large timestamp gap detected && config.fixAudioTimestampGap\n                        needFillSilentFrames = true;\n                        // We need to insert silent frames to fill timestamp gap\n                        var frameCount = Math.floor(dtsCorrection / refSampleDuration);\n                        _logger2.default.w(this.TAG, 'Large audio timestamp gap detected, may cause AV sync to drift. ' + 'Silent frames will be generated to avoid unsync.\\n' + ('originalDts: ' + originalDts + ' ms, curRefDts: ' + curRefDts + ' ms, ') + ('dtsCorrection: ' + Math.round(dtsCorrection) + ' ms, generate: ' + frameCount + ' frames'));\n\n                        _dts = Math.floor(curRefDts);\n                        sampleDuration = Math.floor(curRefDts + refSampleDuration) - _dts;\n\n                        var _silentUnit = _aacSilent2.default.getSilentFrame(this._audioMeta.originalCodec, this._audioMeta.channelCount);\n                        if (_silentUnit == null) {\n                            _logger2.default.w(this.TAG, 'Unable to generate silent frame for ' + (this._audioMeta.originalCodec + ' with ' + this._audioMeta.channelCount + ' channels, repeat last frame'));\n                            // Repeat last frame\n                            _silentUnit = unit;\n                        }\n                        silentFrames = [];\n\n                        for (var j = 0; j < frameCount; j++) {\n                            curRefDts = curRefDts + refSampleDuration;\n                            var intDts = Math.floor(curRefDts); // change to integer\n                            var intDuration = Math.floor(curRefDts + refSampleDuration) - intDts;\n                            var frame = {\n                                dts: intDts,\n                                pts: intDts,\n                                cts: 0,\n                                unit: _silentUnit,\n                                size: _silentUnit.byteLength,\n                                duration: intDuration, // wait for next sample\n                                originalDts: originalDts,\n                                flags: {\n                                    isLeading: 0,\n                                    dependsOn: 1,\n                                    isDependedOn: 0,\n                                    hasRedundancy: 0\n                                }\n                            };\n                            silentFrames.push(frame);\n                            mdatBytes += frame.size;\n                        }\n\n                        this._audioNextDts = curRefDts + refSampleDuration;\n                    } else {\n\n                        _dts = Math.floor(curRefDts);\n                        sampleDuration = Math.floor(curRefDts + refSampleDuration) - _dts;\n                        this._audioNextDts = curRefDts + refSampleDuration;\n                    }\n                } else {\n                    // keep the original dts calculate algorithm for mp3\n                    _dts = originalDts - dtsCorrection;\n\n                    if (i !== samples.length - 1) {\n                        var nextDts = samples[i + 1].dts - this._dtsBase - dtsCorrection;\n                        sampleDuration = nextDts - _dts;\n                    } else {\n                        // the last sample\n                        if (lastSample != null) {\n                            // use stashed sample's dts to calculate sample duration\n                            var _nextDts = lastSample.dts - this._dtsBase - dtsCorrection;\n                            sampleDuration = _nextDts - _dts;\n                        } else if (mp4Samples.length >= 1) {\n                            // use second last sample duration\n                            sampleDuration = mp4Samples[mp4Samples.length - 1].duration;\n                        } else {\n                            // the only one sample, use reference sample duration\n                            sampleDuration = Math.floor(refSampleDuration);\n                        }\n                    }\n                    this._audioNextDts = _dts + sampleDuration;\n                }\n\n                if (firstDts === -1) {\n                    firstDts = _dts;\n                }\n                mp4Samples.push({\n                    dts: _dts,\n                    pts: _dts,\n                    cts: 0,\n                    unit: _sample.unit,\n                    size: _sample.unit.byteLength,\n                    duration: sampleDuration,\n                    originalDts: originalDts,\n                    flags: {\n                        isLeading: 0,\n                        dependsOn: 1,\n                        isDependedOn: 0,\n                        hasRedundancy: 0\n                    }\n                });\n\n                if (needFillSilentFrames) {\n                    // Silent frames should be inserted after wrong-duration frame\n                    mp4Samples.push.apply(mp4Samples, silentFrames);\n                }\n            }\n\n            if (mp4Samples.length === 0) {\n                //no samples need to remux\n                track.samples = [];\n                track.length = 0;\n                return;\n            }\n\n            // allocate mdatbox\n            if (mpegRawTrack) {\n                // allocate for raw mpeg buffer\n                mdatbox = new Uint8Array(mdatBytes);\n            } else {\n                // allocate for fmp4 mdat box\n                mdatbox = new Uint8Array(mdatBytes);\n                // size field\n                mdatbox[0] = mdatBytes >>> 24 & 0xFF;\n                mdatbox[1] = mdatBytes >>> 16 & 0xFF;\n                mdatbox[2] = mdatBytes >>> 8 & 0xFF;\n                mdatbox[3] = mdatBytes & 0xFF;\n                // type field (fourCC)\n                mdatbox.set(_mp4Generator2.default.types.mdat, 4);\n            }\n\n            // Write samples into mdatbox\n            for (var _i = 0; _i < mp4Samples.length; _i++) {\n                var _unit = mp4Samples[_i].unit;\n                mdatbox.set(_unit, offset);\n                offset += _unit.byteLength;\n            }\n\n            var latest = mp4Samples[mp4Samples.length - 1];\n            lastDts = latest.dts + latest.duration;\n            //this._audioNextDts = lastDts;\n\n            // fill media segment info & add to info list\n            var info = new _mediaSegmentInfo.MediaSegmentInfo();\n            info.beginDts = firstDts;\n            info.endDts = lastDts;\n            info.beginPts = firstDts;\n            info.endPts = lastDts;\n            info.originalBeginDts = mp4Samples[0].originalDts;\n            info.originalEndDts = latest.originalDts + latest.duration;\n            info.firstSample = new _mediaSegmentInfo.SampleInfo(mp4Samples[0].dts, mp4Samples[0].pts, mp4Samples[0].duration, mp4Samples[0].originalDts, false);\n            info.lastSample = new _mediaSegmentInfo.SampleInfo(latest.dts, latest.pts, latest.duration, latest.originalDts, false);\n            if (!this._isLive) {\n                this._audioSegmentInfoList.append(info);\n            }\n\n            track.samples = mp4Samples;\n            track.sequenceNumber++;\n\n            var moofbox = null;\n\n            if (mpegRawTrack) {\n                // Generate empty buffer, because useless for raw mpeg\n                moofbox = new Uint8Array();\n            } else {\n                // Generate moof for fmp4 segment\n                moofbox = _mp4Generator2.default.moof(track, firstDts);\n            }\n\n            track.samples = [];\n            track.length = 0;\n\n            var segment = {\n                type: 'audio',\n                data: this._mergeBoxes(moofbox, mdatbox).buffer,\n                sampleCount: mp4Samples.length,\n                info: info\n            };\n\n            if (mpegRawTrack && firstSegmentAfterSeek) {\n                // For MPEG audio stream in MSE, if seeking occurred, before appending new buffer\n                // We need explicitly set timestampOffset to the desired point in timeline for mpeg SourceBuffer.\n                segment.timestampOffset = firstDts;\n            }\n\n            this._onMediaSegment('audio', segment);\n        }\n    }, {\n        key: '_remuxVideo',\n        value: function _remuxVideo(videoTrack, force) {\n            if (this._videoMeta == null) {\n                return;\n            }\n\n            var track = videoTrack;\n            var samples = track.samples;\n            var dtsCorrection = undefined;\n            var firstDts = -1,\n                lastDts = -1;\n            var firstPts = -1,\n                lastPts = -1;\n\n            if (!samples || samples.length === 0) {\n                return;\n            }\n            if (samples.length === 1 && !force) {\n                // If [sample count in current batch] === 1 && (force != true)\n                // Ignore and keep in demuxer's queue\n                return;\n            } // else if (force === true) do remux\n\n            var offset = 8;\n            var mdatbox = null;\n            var mdatBytes = 8 + videoTrack.length;\n\n            var lastSample = null;\n\n            // Pop the lastSample and waiting for stash\n            if (samples.length > 1) {\n                lastSample = samples.pop();\n                mdatBytes -= lastSample.length;\n            }\n\n            // Insert [stashed lastSample in the previous batch] to the front\n            if (this._videoStashedLastSample != null) {\n                var sample = this._videoStashedLastSample;\n                this._videoStashedLastSample = null;\n                samples.unshift(sample);\n                mdatBytes += sample.length;\n            }\n\n            // Stash the lastSample of current batch, waiting for next batch\n            if (lastSample != null) {\n                this._videoStashedLastSample = lastSample;\n            }\n\n            var firstSampleOriginalDts = samples[0].dts - this._dtsBase;\n\n            // calculate dtsCorrection\n            if (this._videoNextDts) {\n                dtsCorrection = firstSampleOriginalDts - this._videoNextDts;\n            } else {\n                // this._videoNextDts == undefined\n                if (this._videoSegmentInfoList.isEmpty()) {\n                    dtsCorrection = 0;\n                } else {\n                    var _lastSample2 = this._videoSegmentInfoList.getLastSampleBefore(firstSampleOriginalDts);\n                    if (_lastSample2 != null) {\n                        var distance = firstSampleOriginalDts - (_lastSample2.originalDts + _lastSample2.duration);\n                        if (distance <= 3) {\n                            distance = 0;\n                        }\n                        var expectedDts = _lastSample2.dts + _lastSample2.duration + distance;\n                        dtsCorrection = firstSampleOriginalDts - expectedDts;\n                    } else {\n                        // lastSample == null, cannot found\n                        dtsCorrection = 0;\n                    }\n                }\n            }\n\n            var info = new _mediaSegmentInfo.MediaSegmentInfo();\n            var mp4Samples = [];\n\n            // Correct dts for each sample, and calculate sample duration. Then output to mp4Samples\n            for (var i = 0; i < samples.length; i++) {\n                var _sample2 = samples[i];\n                var originalDts = _sample2.dts - this._dtsBase;\n                var isKeyframe = _sample2.isKeyframe;\n                var dts = originalDts - dtsCorrection;\n                var cts = _sample2.cts;\n                var pts = dts + cts;\n\n                if (firstDts === -1) {\n                    firstDts = dts;\n                    firstPts = pts;\n                }\n\n                var sampleDuration = 0;\n\n                if (i !== samples.length - 1) {\n                    var nextDts = samples[i + 1].dts - this._dtsBase - dtsCorrection;\n                    sampleDuration = nextDts - dts;\n                } else {\n                    // the last sample\n                    if (lastSample != null) {\n                        // use stashed sample's dts to calculate sample duration\n                        var _nextDts2 = lastSample.dts - this._dtsBase - dtsCorrection;\n                        sampleDuration = _nextDts2 - dts;\n                    } else if (mp4Samples.length >= 1) {\n                        // use second last sample duration\n                        sampleDuration = mp4Samples[mp4Samples.length - 1].duration;\n                    } else {\n                        // the only one sample, use reference sample duration\n                        sampleDuration = Math.floor(this._videoMeta.refSampleDuration);\n                    }\n                }\n\n                if (isKeyframe) {\n                    var syncPoint = new _mediaSegmentInfo.SampleInfo(dts, pts, sampleDuration, _sample2.dts, true);\n                    syncPoint.fileposition = _sample2.fileposition;\n                    info.appendSyncPoint(syncPoint);\n                }\n\n                mp4Samples.push({\n                    dts: dts,\n                    pts: pts,\n                    cts: cts,\n                    units: _sample2.units,\n                    size: _sample2.length,\n                    isKeyframe: isKeyframe,\n                    duration: sampleDuration,\n                    originalDts: originalDts,\n                    flags: {\n                        isLeading: 0,\n                        dependsOn: isKeyframe ? 2 : 1,\n                        isDependedOn: isKeyframe ? 1 : 0,\n                        hasRedundancy: 0,\n                        isNonSync: isKeyframe ? 0 : 1\n                    }\n                });\n            }\n\n            // allocate mdatbox\n            mdatbox = new Uint8Array(mdatBytes);\n            mdatbox[0] = mdatBytes >>> 24 & 0xFF;\n            mdatbox[1] = mdatBytes >>> 16 & 0xFF;\n            mdatbox[2] = mdatBytes >>> 8 & 0xFF;\n            mdatbox[3] = mdatBytes & 0xFF;\n            mdatbox.set(_mp4Generator2.default.types.mdat, 4);\n\n            // Write samples into mdatbox\n            for (var _i2 = 0; _i2 < mp4Samples.length; _i2++) {\n                var units = mp4Samples[_i2].units;\n                while (units.length) {\n                    var unit = units.shift();\n                    var data = unit.data;\n                    mdatbox.set(data, offset);\n                    offset += data.byteLength;\n                }\n            }\n\n            var latest = mp4Samples[mp4Samples.length - 1];\n            lastDts = latest.dts + latest.duration;\n            lastPts = latest.pts + latest.duration;\n            this._videoNextDts = lastDts;\n\n            // fill media segment info & add to info list\n            info.beginDts = firstDts;\n            info.endDts = lastDts;\n            info.beginPts = firstPts;\n            info.endPts = lastPts;\n            info.originalBeginDts = mp4Samples[0].originalDts;\n            info.originalEndDts = latest.originalDts + latest.duration;\n            info.firstSample = new _mediaSegmentInfo.SampleInfo(mp4Samples[0].dts, mp4Samples[0].pts, mp4Samples[0].duration, mp4Samples[0].originalDts, mp4Samples[0].isKeyframe);\n            info.lastSample = new _mediaSegmentInfo.SampleInfo(latest.dts, latest.pts, latest.duration, latest.originalDts, latest.isKeyframe);\n            if (!this._isLive) {\n                this._videoSegmentInfoList.append(info);\n            }\n\n            track.samples = mp4Samples;\n            track.sequenceNumber++;\n\n            // workaround for chrome < 50: force first sample as a random access point\n            // see https://bugs.chromium.org/p/chromium/issues/detail?id=229412\n            if (this._forceFirstIDR) {\n                var flags = mp4Samples[0].flags;\n                flags.dependsOn = 2;\n                flags.isNonSync = 0;\n            }\n\n            var moofbox = _mp4Generator2.default.moof(track, firstDts);\n            track.samples = [];\n            track.length = 0;\n\n            this._onMediaSegment('video', {\n                type: 'video',\n                data: this._mergeBoxes(moofbox, mdatbox).buffer,\n                sampleCount: mp4Samples.length,\n                info: info\n            });\n        }\n    }, {\n        key: '_mergeBoxes',\n        value: function _mergeBoxes(moof, mdat) {\n            var result = new Uint8Array(moof.byteLength + mdat.byteLength);\n            result.set(moof, 0);\n            result.set(mdat, moof.byteLength);\n            return result;\n        }\n    }, {\n        key: 'onInitSegment',\n        get: function get() {\n            return this._onInitSegment;\n        },\n        set: function set(callback) {\n            this._onInitSegment = callback;\n        }\n\n        /* prototype: function onMediaSegment(type: string, mediaSegment: MediaSegment): void\r\n           MediaSegment: {\r\n               type: string,\r\n               data: ArrayBuffer,\r\n               sampleCount: int32\r\n               info: MediaSegmentInfo\r\n           }\r\n        */\n\n    }, {\n        key: 'onMediaSegment',\n        get: function get() {\n            return this._onMediaSegment;\n        },\n        set: function set(callback) {\n            this._onMediaSegment = callback;\n        }\n    }]);\n\n    return MP4Remuxer;\n}();\n\nexports.default = MP4Remuxer;\n\n},{\"../core/media-segment-info.js\":8,\"../utils/browser.js\":39,\"../utils/exception.js\":40,\"../utils/logger.js\":41,\"./aac-silent.js\":36,\"./mp4-generator.js\":37}],39:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar Browser = {};\n\nfunction detect() {\n    // modified from jquery-browser-plugin\n\n    var ua = self.navigator.userAgent.toLowerCase();\n\n    var match = /(edge)\\/([\\w.]+)/.exec(ua) || /(opr)[\\/]([\\w.]+)/.exec(ua) || /(chrome)[ \\/]([\\w.]+)/.exec(ua) || /(iemobile)[\\/]([\\w.]+)/.exec(ua) || /(version)(applewebkit)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.exec(ua) || /(webkit)[ \\/]([\\w.]+).*(version)[ \\/]([\\w.]+).*(safari)[ \\/]([\\w.]+)/.exec(ua) || /(webkit)[ \\/]([\\w.]+)/.exec(ua) || /(opera)(?:.*version|)[ \\/]([\\w.]+)/.exec(ua) || /(msie) ([\\w.]+)/.exec(ua) || ua.indexOf('trident') >= 0 && /(rv)(?::| )([\\w.]+)/.exec(ua) || ua.indexOf('compatible') < 0 && /(firefox)[ \\/]([\\w.]+)/.exec(ua) || [];\n\n    var platform_match = /(ipad)/.exec(ua) || /(ipod)/.exec(ua) || /(windows phone)/.exec(ua) || /(iphone)/.exec(ua) || /(kindle)/.exec(ua) || /(android)/.exec(ua) || /(windows)/.exec(ua) || /(mac)/.exec(ua) || /(linux)/.exec(ua) || /(cros)/.exec(ua) || [];\n\n    var matched = {\n        browser: match[5] || match[3] || match[1] || '',\n        version: match[2] || match[4] || '0',\n        majorVersion: match[4] || match[2] || '0',\n        platform: platform_match[0] || ''\n    };\n\n    var browser = {};\n    if (matched.browser) {\n        browser[matched.browser] = true;\n\n        var versionArray = matched.majorVersion.split('.');\n        browser.version = {\n            major: parseInt(matched.majorVersion, 10),\n            string: matched.version\n        };\n        if (versionArray.length > 1) {\n            browser.version.minor = parseInt(versionArray[1], 10);\n        }\n        if (versionArray.length > 2) {\n            browser.version.build = parseInt(versionArray[2], 10);\n        }\n    }\n\n    if (matched.platform) {\n        browser[matched.platform] = true;\n    }\n\n    if (browser.chrome || browser.opr || browser.safari) {\n        browser.webkit = true;\n    }\n\n    // MSIE. IE11 has 'rv' identifer\n    if (browser.rv || browser.iemobile) {\n        if (browser.rv) {\n            delete browser.rv;\n        }\n        var msie = 'msie';\n        matched.browser = msie;\n        browser[msie] = true;\n    }\n\n    // Microsoft Edge\n    if (browser.edge) {\n        delete browser.edge;\n        var msedge = 'msedge';\n        matched.browser = msedge;\n        browser[msedge] = true;\n    }\n\n    // Opera 15+\n    if (browser.opr) {\n        var opera = 'opera';\n        matched.browser = opera;\n        browser[opera] = true;\n    }\n\n    // Stock android browsers are marked as Safari\n    if (browser.safari && browser.android) {\n        var android = 'android';\n        matched.browser = android;\n        browser[android] = true;\n    }\n\n    browser.name = matched.browser;\n    browser.platform = matched.platform;\n\n    for (var key in Browser) {\n        if (Browser.hasOwnProperty(key)) {\n            delete Browser[key];\n        }\n    }\n    Object.assign(Browser, browser);\n}\n\ndetect();\n\nexports.default = Browser;\n\n},{}],40:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar RuntimeException = exports.RuntimeException = function () {\n    function RuntimeException(message) {\n        _classCallCheck(this, RuntimeException);\n\n        this._message = message;\n    }\n\n    _createClass(RuntimeException, [{\n        key: 'toString',\n        value: function toString() {\n            return this.name + ': ' + this.message;\n        }\n    }, {\n        key: 'name',\n        get: function get() {\n            return 'RuntimeException';\n        }\n    }, {\n        key: 'message',\n        get: function get() {\n            return this._message;\n        }\n    }]);\n\n    return RuntimeException;\n}();\n\nvar IllegalStateException = exports.IllegalStateException = function (_RuntimeException) {\n    _inherits(IllegalStateException, _RuntimeException);\n\n    function IllegalStateException(message) {\n        _classCallCheck(this, IllegalStateException);\n\n        return _possibleConstructorReturn(this, (IllegalStateException.__proto__ || Object.getPrototypeOf(IllegalStateException)).call(this, message));\n    }\n\n    _createClass(IllegalStateException, [{\n        key: 'name',\n        get: function get() {\n            return 'IllegalStateException';\n        }\n    }]);\n\n    return IllegalStateException;\n}(RuntimeException);\n\nvar InvalidArgumentException = exports.InvalidArgumentException = function (_RuntimeException2) {\n    _inherits(InvalidArgumentException, _RuntimeException2);\n\n    function InvalidArgumentException(message) {\n        _classCallCheck(this, InvalidArgumentException);\n\n        return _possibleConstructorReturn(this, (InvalidArgumentException.__proto__ || Object.getPrototypeOf(InvalidArgumentException)).call(this, message));\n    }\n\n    _createClass(InvalidArgumentException, [{\n        key: 'name',\n        get: function get() {\n            return 'InvalidArgumentException';\n        }\n    }]);\n\n    return InvalidArgumentException;\n}(RuntimeException);\n\nvar NotImplementedException = exports.NotImplementedException = function (_RuntimeException3) {\n    _inherits(NotImplementedException, _RuntimeException3);\n\n    function NotImplementedException(message) {\n        _classCallCheck(this, NotImplementedException);\n\n        return _possibleConstructorReturn(this, (NotImplementedException.__proto__ || Object.getPrototypeOf(NotImplementedException)).call(this, message));\n    }\n\n    _createClass(NotImplementedException, [{\n        key: 'name',\n        get: function get() {\n            return 'NotImplementedException';\n        }\n    }]);\n\n    return NotImplementedException;\n}(RuntimeException);\n\n},{}],41:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Log = function () {\n    function Log() {\n        _classCallCheck(this, Log);\n    }\n\n    _createClass(Log, null, [{\n        key: 'e',\n        value: function e(tag, msg) {\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\n\n            var str = '[' + tag + '] > ' + msg;\n\n            if (Log.ENABLE_CALLBACK) {\n                Log.emitter.emit('log', 'error', str);\n            }\n\n            if (!Log.ENABLE_ERROR) {\n                return;\n            }\n\n            if (console.error) {\n                console.error(str);\n            } else if (console.warn) {\n                console.warn(str);\n            } else {\n                console.log(str);\n            }\n        }\n    }, {\n        key: 'i',\n        value: function i(tag, msg) {\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\n\n            var str = '[' + tag + '] > ' + msg;\n\n            if (Log.ENABLE_CALLBACK) {\n                Log.emitter.emit('log', 'info', str);\n            }\n\n            if (!Log.ENABLE_INFO) {\n                return;\n            }\n\n            if (console.info) {\n                console.info(str);\n            } else {\n                console.log(str);\n            }\n        }\n    }, {\n        key: 'w',\n        value: function w(tag, msg) {\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\n\n            var str = '[' + tag + '] > ' + msg;\n\n            if (Log.ENABLE_CALLBACK) {\n                Log.emitter.emit('log', 'warn', str);\n            }\n\n            if (!Log.ENABLE_WARN) {\n                return;\n            }\n\n            if (console.warn) {\n                console.warn(str);\n            } else {\n                console.log(str);\n            }\n        }\n    }, {\n        key: 'd',\n        value: function d(tag, msg) {\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\n\n            var str = '[' + tag + '] > ' + msg;\n\n            if (Log.ENABLE_CALLBACK) {\n                Log.emitter.emit('log', 'debug', str);\n            }\n\n            if (!Log.ENABLE_DEBUG) {\n                return;\n            }\n\n            if (console.debug) {\n                console.debug(str);\n            } else {\n                console.log(str);\n            }\n        }\n    }, {\n        key: 'v',\n        value: function v(tag, msg) {\n            if (!tag || Log.FORCE_GLOBAL_TAG) tag = Log.GLOBAL_TAG;\n\n            var str = '[' + tag + '] > ' + msg;\n\n            if (Log.ENABLE_CALLBACK) {\n                Log.emitter.emit('log', 'verbose', str);\n            }\n\n            if (!Log.ENABLE_VERBOSE) {\n                return;\n            }\n\n            console.log(str);\n        }\n    }]);\n\n    return Log;\n}();\n\nLog.GLOBAL_TAG = 'flv.js';\nLog.FORCE_GLOBAL_TAG = false;\nLog.ENABLE_ERROR = true;\nLog.ENABLE_INFO = true;\nLog.ENABLE_WARN = true;\nLog.ENABLE_DEBUG = true;\nLog.ENABLE_VERBOSE = true;\n\nLog.ENABLE_CALLBACK = false;\n\nLog.emitter = new _events2.default();\n\nexports.default = Log;\n\n},{\"events\":2}],42:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); /*\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * @author zheng qian <xqq@xqq.im>\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * you may not use this file except in compliance with the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * You may obtain a copy of the License at\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *     http://www.apache.org/licenses/LICENSE-2.0\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      *\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * Unless required by applicable law or agreed to in writing, software\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * See the License for the specific language governing permissions and\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      * limitations under the License.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      */\n\nvar _events = _dereq_('events');\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _logger = _dereq_('./logger.js');\n\nvar _logger2 = _interopRequireDefault(_logger);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar LoggingControl = function () {\n    function LoggingControl() {\n        _classCallCheck(this, LoggingControl);\n    }\n\n    _createClass(LoggingControl, null, [{\n        key: 'getConfig',\n        value: function getConfig() {\n            return {\n                globalTag: _logger2.default.GLOBAL_TAG,\n                forceGlobalTag: _logger2.default.FORCE_GLOBAL_TAG,\n                enableVerbose: _logger2.default.ENABLE_VERBOSE,\n                enableDebug: _logger2.default.ENABLE_DEBUG,\n                enableInfo: _logger2.default.ENABLE_INFO,\n                enableWarn: _logger2.default.ENABLE_WARN,\n                enableError: _logger2.default.ENABLE_ERROR,\n                enableCallback: _logger2.default.ENABLE_CALLBACK\n            };\n        }\n    }, {\n        key: 'applyConfig',\n        value: function applyConfig(config) {\n            _logger2.default.GLOBAL_TAG = config.globalTag;\n            _logger2.default.FORCE_GLOBAL_TAG = config.forceGlobalTag;\n            _logger2.default.ENABLE_VERBOSE = config.enableVerbose;\n            _logger2.default.ENABLE_DEBUG = config.enableDebug;\n            _logger2.default.ENABLE_INFO = config.enableInfo;\n            _logger2.default.ENABLE_WARN = config.enableWarn;\n            _logger2.default.ENABLE_ERROR = config.enableError;\n            _logger2.default.ENABLE_CALLBACK = config.enableCallback;\n        }\n    }, {\n        key: '_notifyChange',\n        value: function _notifyChange() {\n            var emitter = LoggingControl.emitter;\n\n            if (emitter.listenerCount('change') > 0) {\n                var config = LoggingControl.getConfig();\n                emitter.emit('change', config);\n            }\n        }\n    }, {\n        key: 'registerListener',\n        value: function registerListener(listener) {\n            LoggingControl.emitter.addListener('change', listener);\n        }\n    }, {\n        key: 'removeListener',\n        value: function removeListener(listener) {\n            LoggingControl.emitter.removeListener('change', listener);\n        }\n    }, {\n        key: 'addLogListener',\n        value: function addLogListener(listener) {\n            _logger2.default.emitter.addListener('log', listener);\n            if (_logger2.default.emitter.listenerCount('log') > 0) {\n                _logger2.default.ENABLE_CALLBACK = true;\n                LoggingControl._notifyChange();\n            }\n        }\n    }, {\n        key: 'removeLogListener',\n        value: function removeLogListener(listener) {\n            _logger2.default.emitter.removeListener('log', listener);\n            if (_logger2.default.emitter.listenerCount('log') === 0) {\n                _logger2.default.ENABLE_CALLBACK = false;\n                LoggingControl._notifyChange();\n            }\n        }\n    }, {\n        key: 'forceGlobalTag',\n        get: function get() {\n            return _logger2.default.FORCE_GLOBAL_TAG;\n        },\n        set: function set(enable) {\n            _logger2.default.FORCE_GLOBAL_TAG = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'globalTag',\n        get: function get() {\n            return _logger2.default.GLOBAL_TAG;\n        },\n        set: function set(tag) {\n            _logger2.default.GLOBAL_TAG = tag;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableAll',\n        get: function get() {\n            return _logger2.default.ENABLE_VERBOSE && _logger2.default.ENABLE_DEBUG && _logger2.default.ENABLE_INFO && _logger2.default.ENABLE_WARN && _logger2.default.ENABLE_ERROR;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_VERBOSE = enable;\n            _logger2.default.ENABLE_DEBUG = enable;\n            _logger2.default.ENABLE_INFO = enable;\n            _logger2.default.ENABLE_WARN = enable;\n            _logger2.default.ENABLE_ERROR = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableDebug',\n        get: function get() {\n            return _logger2.default.ENABLE_DEBUG;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_DEBUG = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableVerbose',\n        get: function get() {\n            return _logger2.default.ENABLE_VERBOSE;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_VERBOSE = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableInfo',\n        get: function get() {\n            return _logger2.default.ENABLE_INFO;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_INFO = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableWarn',\n        get: function get() {\n            return _logger2.default.ENABLE_WARN;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_WARN = enable;\n            LoggingControl._notifyChange();\n        }\n    }, {\n        key: 'enableError',\n        get: function get() {\n            return _logger2.default.ENABLE_ERROR;\n        },\n        set: function set(enable) {\n            _logger2.default.ENABLE_ERROR = enable;\n            LoggingControl._notifyChange();\n        }\n    }]);\n\n    return LoggingControl;\n}();\n\nLoggingControl.emitter = new _events2.default();\n\nexports.default = LoggingControl;\n\n},{\"./logger.js\":41,\"events\":2}],43:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nvar Polyfill = function () {\n    function Polyfill() {\n        _classCallCheck(this, Polyfill);\n    }\n\n    _createClass(Polyfill, null, [{\n        key: 'install',\n        value: function install() {\n            // ES6 Object.setPrototypeOf\n            Object.setPrototypeOf = Object.setPrototypeOf || function (obj, proto) {\n                obj.__proto__ = proto;\n                return obj;\n            };\n\n            // ES6 Object.assign\n            Object.assign = Object.assign || function (target) {\n                if (target === undefined || target === null) {\n                    throw new TypeError('Cannot convert undefined or null to object');\n                }\n\n                var output = Object(target);\n                for (var i = 1; i < arguments.length; i++) {\n                    var source = arguments[i];\n                    if (source !== undefined && source !== null) {\n                        for (var key in source) {\n                            if (source.hasOwnProperty(key)) {\n                                output[key] = source[key];\n                            }\n                        }\n                    }\n                }\n                return output;\n            };\n\n            // ES6 Promise (missing support in IE11)\n            if (typeof self.Promise !== 'function') {\n                _dereq_('es6-promise').polyfill();\n            }\n        }\n    }]);\n\n    return Polyfill;\n}();\n\nPolyfill.install();\n\nexports.default = Polyfill;\n\n},{\"es6-promise\":1}],44:[function(_dereq_,module,exports){\n'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/*\r\n * Copyright (C) 2016 Bilibili. All Rights Reserved.\r\n *\r\n * This file is derived from C++ project libWinTF8 (https://github.com/m13253/libWinTF8)\r\n * @author zheng qian <xqq@xqq.im>\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *     http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\n\nfunction checkContinuation(uint8array, start, checkLength) {\n    var array = uint8array;\n    if (start + checkLength < array.length) {\n        while (checkLength--) {\n            if ((array[++start] & 0xC0) !== 0x80) return false;\n        }\n        return true;\n    } else {\n        return false;\n    }\n}\n\nfunction decodeUTF8(uint8array) {\n    var out = [];\n    var input = uint8array;\n    var i = 0;\n    var length = uint8array.length;\n\n    while (i < length) {\n        if (input[i] < 0x80) {\n            out.push(String.fromCharCode(input[i]));\n            ++i;\n            continue;\n        } else if (input[i] < 0xC0) {\n            // fallthrough\n        } else if (input[i] < 0xE0) {\n            if (checkContinuation(input, i, 1)) {\n                var ucs4 = (input[i] & 0x1F) << 6 | input[i + 1] & 0x3F;\n                if (ucs4 >= 0x80) {\n                    out.push(String.fromCharCode(ucs4 & 0xFFFF));\n                    i += 2;\n                    continue;\n                }\n            }\n        } else if (input[i] < 0xF0) {\n            if (checkContinuation(input, i, 2)) {\n                var _ucs = (input[i] & 0xF) << 12 | (input[i + 1] & 0x3F) << 6 | input[i + 2] & 0x3F;\n                if (_ucs >= 0x800 && (_ucs & 0xF800) !== 0xD800) {\n                    out.push(String.fromCharCode(_ucs & 0xFFFF));\n                    i += 3;\n                    continue;\n                }\n            }\n        } else if (input[i] < 0xF8) {\n            if (checkContinuation(input, i, 3)) {\n                var _ucs2 = (input[i] & 0x7) << 18 | (input[i + 1] & 0x3F) << 12 | (input[i + 2] & 0x3F) << 6 | input[i + 3] & 0x3F;\n                if (_ucs2 > 0x10000 && _ucs2 < 0x110000) {\n                    _ucs2 -= 0x10000;\n                    out.push(String.fromCharCode(_ucs2 >>> 10 | 0xD800));\n                    out.push(String.fromCharCode(_ucs2 & 0x3FF | 0xDC00));\n                    i += 4;\n                    continue;\n                }\n            }\n        }\n        out.push(String.fromCharCode(0xFFFD));\n        ++i;\n    }\n\n    return out.join('');\n}\n\nexports.default = decodeUTF8;\n\n},{}]},{},[21])(21)\n});\n\n//# sourceMappingURL=flv.js.map\n","/*\nmp3编码器用到的lamejs编码引擎，一般都用MP3格式，浏览器支持广泛，此引擎测试的也比较多，稳定\nhttps://github.com/xiangyuecn/Recorder\n*/\n(function(){\n\"use strict\";\n\n//end2 ****开始copy lamejs*****\n/*\nmp3编码依赖lamejs，如果无需mp3支持直接移除此代码\nhttps://github.com/zhuker/lamejs/blob/bfb7f6c6d7877e0fe1ad9e72697a871676119a0e/lame.all.js\n*/\n\nfunction lamejs() {\nvar Math_log10=function(s){//坚决不能用也不要报语言问题的错误\n\treturn Math.log(s)/Math.log(10);\n};\n\nfunction new_byte(count) {\n    return new Int8Array(count);\n}\n\nfunction new_short(count) {\n    return new Int16Array(count);\n}\n\nfunction new_int(count) {\n    return new Int32Array(count);\n}\n\nfunction new_float(count) {\n    return new Float32Array(count);\n}\n\nfunction new_double(count) {\n    return new Float64Array(count);\n}\n\nfunction new_float_n(args) {\n    if (args.length == 1) {\n        return new_float(args[0]);\n    }\n    var sz = args[0];\n    args = args.slice(1);\n    var A = [];\n    for (var i = 0; i < sz; i++) {\n        A.push(new_float_n(args));\n    }\n    return A;\n}\nfunction new_int_n(args) {\n    if (args.length == 1) {\n        return new_int(args[0]);\n    }\n    var sz = args[0];\n    args = args.slice(1);\n    var A = [];\n    for (var i = 0; i < sz; i++) {\n        A.push(new_int_n(args));\n    }\n    return A;\n}\n\nfunction new_short_n(args) {\n    if (args.length == 1) {\n        return new_short(args[0]);\n    }\n    var sz = args[0];\n    args = args.slice(1);\n    var A = [];\n    for (var i = 0; i < sz; i++) {\n        A.push(new_short_n(args));\n    }\n    return A;\n}\n\nfunction new_array_n(args) {\n    if (args.length == 1) {\n        return new Array(args[0]);\n    }\n    var sz = args[0];\n    args = args.slice(1);\n    var A = [];\n    for (var i = 0; i < sz; i++) {\n        A.push(new_array_n(args));\n    }\n    return A;\n}\n\n\nvar Arrays = {};\n\nArrays.fill = function (a, fromIndex, toIndex, val) {\n    if (arguments.length == 2) {\n        for (var i = 0; i < a.length; i++) {\n            a[i] = arguments[1];\n        }\n    } else {\n        for (var i = fromIndex; i < toIndex; i++) {\n            a[i] = val;\n        }\n    }\n};\n\nvar System = {};\n\nSystem.arraycopy = function (src, srcPos, dest, destPos, length) {\n    var srcEnd = srcPos + length;\n    while (srcPos < srcEnd)\n        dest[destPos++] = src[srcPos++];\n};\n\n\nvar Util = {};\nUtil.SQRT2 = 1.41421356237309504880;\nUtil.FAST_LOG10 = function (x) {\n    return Math_log10(x);\n};\n\nUtil.FAST_LOG10_X = function (x, y) {\n    return Math_log10(x) * y;\n};\n\nfunction ShortBlock(ordinal) {\n    this.ordinal = ordinal;\n}\n/**\n * LAME may use them, even different block types for L/R.\n */\nShortBlock.short_block_allowed = new ShortBlock(0);\n/**\n * LAME may use them, but always same block types in L/R.\n */\nShortBlock.short_block_coupled = new ShortBlock(1);\n/**\n * LAME will not use short blocks, long blocks only.\n */\nShortBlock.short_block_dispensed = new ShortBlock(2);\n/**\n * LAME will not use long blocks, short blocks only.\n */\nShortBlock.short_block_forced = new ShortBlock(3);\n\nvar Float = {};\nFloat.MAX_VALUE = 3.4028235e+38;\n\nfunction VbrMode(ordinal) {\n    this.ordinal = ordinal;\n}\nVbrMode.vbr_off = new VbrMode(0);\nVbrMode.vbr_mt = new VbrMode(1);\nVbrMode.vbr_rh = new VbrMode(2);\nVbrMode.vbr_abr = new VbrMode(3);\nVbrMode.vbr_mtrh = new VbrMode(4);\nVbrMode.vbr_default = VbrMode.vbr_mtrh;\n\nvar assert = function (x) {\n    //console.assert(x);\n};\n\nvar module_exports = {\n    \"System\": System,\n    \"VbrMode\": VbrMode,\n    \"Float\": Float,\n    \"ShortBlock\": ShortBlock,\n    \"Util\": Util,\n    \"Arrays\": Arrays,\n    \"new_array_n\": new_array_n,\n    \"new_byte\": new_byte,\n    \"new_double\": new_double,\n    \"new_float\": new_float,\n    \"new_float_n\": new_float_n,\n    \"new_int\": new_int,\n    \"new_int_n\": new_int_n,\n    \"new_short\": new_short,\n    \"new_short_n\": new_short_n,\n    \"assert\": assert\n};\n//package mp3;\n\n/* MPEG modes */\nfunction MPEGMode(ordinal) {\n    var _ordinal = ordinal;\n    this.ordinal = function () {\n        return _ordinal;\n    }\n}\n\nMPEGMode.STEREO = new MPEGMode(0);\nMPEGMode.JOINT_STEREO = new MPEGMode(1);\nMPEGMode.DUAL_CHANNEL = new MPEGMode(2);\nMPEGMode.MONO = new MPEGMode(3);\nMPEGMode.NOT_SET = new MPEGMode(4);\n\nfunction Version() {\n\n    /**\n     * URL for the LAME website.\n     */\n    var LAME_URL = \"http://www.mp3dev.org/\";\n\n    /**\n     * Major version number.\n     */\n    var LAME_MAJOR_VERSION = 3;\n    /**\n     * Minor version number.\n     */\n    var LAME_MINOR_VERSION = 98;\n    /**\n     * Patch level.\n     */\n    var LAME_PATCH_VERSION = 4;\n\n    /**\n     * Major version number.\n     */\n    var PSY_MAJOR_VERSION = 0;\n    /**\n     * Minor version number.\n     */\n    var PSY_MINOR_VERSION = 93;\n\n    /**\n     * A string which describes the version of LAME.\n     *\n     * @return string which describes the version of LAME\n     */\n    this.getLameVersion = function () {\n        // primary to write screen reports\n        return (LAME_MAJOR_VERSION + \".\" + LAME_MINOR_VERSION + \".\" + LAME_PATCH_VERSION);\n    }\n\n    /**\n     * The short version of the LAME version string.\n     *\n     * @return short version of the LAME version string\n     */\n    this.getLameShortVersion = function () {\n        // Adding date and time to version string makes it harder for output\n        // validation\n        return (LAME_MAJOR_VERSION + \".\" + LAME_MINOR_VERSION + \".\" + LAME_PATCH_VERSION);\n    }\n\n    /**\n     * The shortest version of the LAME version string.\n     *\n     * @return shortest version of the LAME version string\n     */\n    this.getLameVeryShortVersion = function () {\n        // Adding date and time to version string makes it harder for output\n        return (\"LAME\" + LAME_MAJOR_VERSION + \".\" + LAME_MINOR_VERSION + \"r\");\n    }\n\n    /**\n     * String which describes the version of GPSYCHO\n     *\n     * @return string which describes the version of GPSYCHO\n     */\n    this.getPsyVersion = function () {\n        return (PSY_MAJOR_VERSION + \".\" + PSY_MINOR_VERSION);\n    }\n\n    /**\n     * String which is a URL for the LAME website.\n     *\n     * @return string which is a URL for the LAME website\n     */\n    this.getLameUrl = function () {\n        return LAME_URL;\n    }\n\n    /**\n     * Quite useless for a java version, however we are compatible ;-)\n     *\n     * @return \"32bits\"\n     */\n    this.getLameOsBitness = function () {\n        return \"32bits\";\n    }\n\n}\n\n/*\n *\tMP3 huffman table selecting and bit counting\n *\n *\tCopyright (c) 1999-2005 Takehiro TOMINAGA\n *\tCopyright (c) 2002-2005 Gabriel Bouvigne\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\t See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n\n/* $Id: Takehiro.java,v 1.26 2011/05/24 20:48:06 kenchis Exp $ */\n\n//package mp3;\n\n//import java.util.Arrays;\n\n\n\nfunction Takehiro() {\n\n    var qupvt = null;\n    this.qupvt = null;\n\n    this.setModules = function (_qupvt) {\n        this.qupvt = _qupvt;\n        qupvt = _qupvt;\n    }\n\n    function Bits(b) {\n        this.bits = 0 | b;\n    }\n\n    var subdv_table = [[0, 0], /* 0 bands */\n        [0, 0], /* 1 bands */\n        [0, 0], /* 2 bands */\n        [0, 0], /* 3 bands */\n        [0, 0], /* 4 bands */\n        [0, 1], /* 5 bands */\n        [1, 1], /* 6 bands */\n        [1, 1], /* 7 bands */\n        [1, 2], /* 8 bands */\n        [2, 2], /* 9 bands */\n        [2, 3], /* 10 bands */\n        [2, 3], /* 11 bands */\n        [3, 4], /* 12 bands */\n        [3, 4], /* 13 bands */\n        [3, 4], /* 14 bands */\n        [4, 5], /* 15 bands */\n        [4, 5], /* 16 bands */\n        [4, 6], /* 17 bands */\n        [5, 6], /* 18 bands */\n        [5, 6], /* 19 bands */\n        [5, 7], /* 20 bands */\n        [6, 7], /* 21 bands */\n        [6, 7], /* 22 bands */\n    ];\n\n\n    /**\n     * nonlinear quantization of xr More accurate formula than the ISO formula.\n     * Takes into account the fact that we are quantizing xr . ix, but we want\n     * ix^4/3 to be as close as possible to x^4/3. (taking the nearest int would\n     * mean ix is as close as possible to xr, which is different.)\n     *\n     * From Segher Boessenkool <segher@eastsite.nl> 11/1999\n     *\n     * 09/2000: ASM code removed in favor of IEEE754 hack by Takehiro Tominaga.\n     * If you need the ASM code, check CVS circa Aug 2000.\n     *\n     * 01/2004: Optimizations by Gabriel Bouvigne\n     */\n    function quantize_lines_xrpow_01(l, istep, xr, xrPos, ix, ixPos) {\n        var compareval0 = (1.0 - 0.4054) / istep;\n\n        l = l >> 1;\n        while ((l--) != 0) {\n            ix[ixPos++] = (compareval0 > xr[xrPos++]) ? 0 : 1;\n            ix[ixPos++] = (compareval0 > xr[xrPos++]) ? 0 : 1;\n        }\n    }\n\n    /**\n     * XRPOW_FTOI is a macro to convert floats to ints.<BR>\n     * if XRPOW_FTOI(x) = nearest_int(x), then QUANTFAC(x)=adj43asm[x]<BR>\n     * ROUNDFAC= -0.0946<BR>\n     *\n     * if XRPOW_FTOI(x) = floor(x), then QUANTFAC(x)=asj43[x]<BR>\n     * ROUNDFAC=0.4054<BR>\n     *\n     * Note: using floor() or 0| is extremely slow. On machines where the\n     * TAKEHIRO_IEEE754_HACK code above does not work, it is worthwile to write\n     * some ASM for XRPOW_FTOI().\n     */\n    function quantize_lines_xrpow(l, istep, xr, xrPos, ix, ixPos) {\n\n        l = l >> 1;\n        var remaining = l % 2;\n        l = l >> 1;\n        while (l-- != 0) {\n            var x0, x1, x2, x3;\n            var rx0, rx1, rx2, rx3;\n\n            x0 = xr[xrPos++] * istep;\n            x1 = xr[xrPos++] * istep;\n            rx0 = 0 | x0;\n            x2 = xr[xrPos++] * istep;\n            rx1 = 0 | x1;\n            x3 = xr[xrPos++] * istep;\n            rx2 = 0 | x2;\n            x0 += qupvt.adj43[rx0];\n            rx3 = 0 | x3;\n            x1 += qupvt.adj43[rx1];\n            ix[ixPos++] = 0 | x0;\n            x2 += qupvt.adj43[rx2];\n            ix[ixPos++] = 0 | x1;\n            x3 += qupvt.adj43[rx3];\n            ix[ixPos++] = 0 | x2;\n            ix[ixPos++] = 0 | x3;\n        }\n        if (remaining != 0) {\n            var x0, x1;\n            var rx0, rx1;\n\n            x0 = xr[xrPos++] * istep;\n            x1 = xr[xrPos++] * istep;\n            rx0 = 0 | x0;\n            rx1 = 0 | x1;\n            x0 += qupvt.adj43[rx0];\n            x1 += qupvt.adj43[rx1];\n            ix[ixPos++] = 0 | x0;\n            ix[ixPos++] = 0 | x1;\n        }\n    }\n\n    /**\n     * Quantization function This function will select which lines to quantize\n     * and call the proper quantization function\n     */\n    function quantize_xrpow(xp, pi, istep, codInfo, prevNoise) {\n        /* quantize on xr^(3/4) instead of xr */\n        var sfb;\n        var sfbmax;\n        var j = 0;\n        var prev_data_use;\n        var accumulate = 0;\n        var accumulate01 = 0;\n        var xpPos = 0;\n        var iData = pi;\n        var iDataPos = 0;\n        var acc_iData = iData;\n        var acc_iDataPos = 0;\n        var acc_xp = xp;\n        var acc_xpPos = 0;\n\n        /*\n         * Reusing previously computed data does not seems to work if global\n         * gain is changed. Finding why it behaves this way would allow to use a\n         * cache of previously computed values (let's 10 cached values per sfb)\n         * that would probably provide a noticeable speedup\n         */\n        prev_data_use = (prevNoise != null && (codInfo.global_gain == prevNoise.global_gain));\n\n        if (codInfo.block_type == Encoder.SHORT_TYPE)\n            sfbmax = 38;\n        else\n            sfbmax = 21;\n\n        for (sfb = 0; sfb <= sfbmax; sfb++) {\n            var step = -1;\n\n            if (prev_data_use || codInfo.block_type == Encoder.NORM_TYPE) {\n                step = codInfo.global_gain\n                    - ((codInfo.scalefac[sfb] + (codInfo.preflag != 0 ? qupvt.pretab[sfb]\n                        : 0)) << (codInfo.scalefac_scale + 1))\n                    - codInfo.subblock_gain[codInfo.window[sfb]] * 8;\n            }\n            if (prev_data_use && (prevNoise.step[sfb] == step)) {\n                /*\n                 * do not recompute this part, but compute accumulated lines\n                 */\n                if (accumulate != 0) {\n                    quantize_lines_xrpow(accumulate, istep, acc_xp, acc_xpPos,\n                        acc_iData, acc_iDataPos);\n                    accumulate = 0;\n                }\n                if (accumulate01 != 0) {\n                    quantize_lines_xrpow_01(accumulate01, istep, acc_xp,\n                        acc_xpPos, acc_iData, acc_iDataPos);\n                    accumulate01 = 0;\n                }\n            } else { /* should compute this part */\n                var l = codInfo.width[sfb];\n\n                if ((j + codInfo.width[sfb]) > codInfo.max_nonzero_coeff) {\n                    /* do not compute upper zero part */\n                    var usefullsize;\n                    usefullsize = codInfo.max_nonzero_coeff - j + 1;\n                    Arrays.fill(pi, codInfo.max_nonzero_coeff, 576, 0);\n                    l = usefullsize;\n\n                    if (l < 0) {\n                        l = 0;\n                    }\n\n                    /* no need to compute higher sfb values */\n                    sfb = sfbmax + 1;\n                }\n\n                /* accumulate lines to quantize */\n                if (0 == accumulate && 0 == accumulate01) {\n                    acc_iData = iData;\n                    acc_iDataPos = iDataPos;\n                    acc_xp = xp;\n                    acc_xpPos = xpPos;\n                }\n                if (prevNoise != null && prevNoise.sfb_count1 > 0\n                    && sfb >= prevNoise.sfb_count1\n                    && prevNoise.step[sfb] > 0\n                    && step >= prevNoise.step[sfb]) {\n\n                    if (accumulate != 0) {\n                        quantize_lines_xrpow(accumulate, istep, acc_xp,\n                            acc_xpPos, acc_iData, acc_iDataPos);\n                        accumulate = 0;\n                        acc_iData = iData;\n                        acc_iDataPos = iDataPos;\n                        acc_xp = xp;\n                        acc_xpPos = xpPos;\n                    }\n                    accumulate01 += l;\n                } else {\n                    if (accumulate01 != 0) {\n                        quantize_lines_xrpow_01(accumulate01, istep, acc_xp,\n                            acc_xpPos, acc_iData, acc_iDataPos);\n                        accumulate01 = 0;\n                        acc_iData = iData;\n                        acc_iDataPos = iDataPos;\n                        acc_xp = xp;\n                        acc_xpPos = xpPos;\n                    }\n                    accumulate += l;\n                }\n\n                if (l <= 0) {\n                    /*\n                     * rh: 20040215 may happen due to \"prev_data_use\"\n                     * optimization\n                     */\n                    if (accumulate01 != 0) {\n                        quantize_lines_xrpow_01(accumulate01, istep, acc_xp,\n                            acc_xpPos, acc_iData, acc_iDataPos);\n                        accumulate01 = 0;\n                    }\n                    if (accumulate != 0) {\n                        quantize_lines_xrpow(accumulate, istep, acc_xp,\n                            acc_xpPos, acc_iData, acc_iDataPos);\n                        accumulate = 0;\n                    }\n\n                    break;\n                    /* ends for-loop */\n                }\n            }\n            if (sfb <= sfbmax) {\n                iDataPos += codInfo.width[sfb];\n                xpPos += codInfo.width[sfb];\n                j += codInfo.width[sfb];\n            }\n        }\n        if (accumulate != 0) { /* last data part */\n            quantize_lines_xrpow(accumulate, istep, acc_xp, acc_xpPos,\n                acc_iData, acc_iDataPos);\n            accumulate = 0;\n        }\n        if (accumulate01 != 0) { /* last data part */\n            quantize_lines_xrpow_01(accumulate01, istep, acc_xp, acc_xpPos,\n                acc_iData, acc_iDataPos);\n            accumulate01 = 0;\n        }\n\n    }\n\n    /**\n     * ix_max\n     */\n    function ix_max(ix, ixPos, endPos) {\n        var max1 = 0, max2 = 0;\n\n        do {\n            var x1 = ix[ixPos++];\n            var x2 = ix[ixPos++];\n            if (max1 < x1)\n                max1 = x1;\n\n            if (max2 < x2)\n                max2 = x2;\n        } while (ixPos < endPos);\n        if (max1 < max2)\n            max1 = max2;\n        return max1;\n    }\n\n    function count_bit_ESC(ix, ixPos, end, t1, t2, s) {\n        /* ESC-table is used */\n        var linbits = Tables.ht[t1].xlen * 65536 + Tables.ht[t2].xlen;\n        var sum = 0, sum2;\n\n        do {\n            var x = ix[ixPos++];\n            var y = ix[ixPos++];\n\n            if (x != 0) {\n                if (x > 14) {\n                    x = 15;\n                    sum += linbits;\n                }\n                x *= 16;\n            }\n\n            if (y != 0) {\n                if (y > 14) {\n                    y = 15;\n                    sum += linbits;\n                }\n                x += y;\n            }\n\n            sum += Tables.largetbl[x];\n        } while (ixPos < end);\n\n        sum2 = sum & 0xffff;\n        sum >>= 16;\n\n        if (sum > sum2) {\n            sum = sum2;\n            t1 = t2;\n        }\n\n        s.bits += sum;\n        return t1;\n    }\n\n    function count_bit_noESC(ix, ixPos, end, s) {\n        /* No ESC-words */\n        var sum1 = 0;\n        var hlen1 = Tables.ht[1].hlen;\n\n        do {\n            var x = ix[ixPos + 0] * 2 + ix[ixPos + 1];\n            ixPos += 2;\n            sum1 += hlen1[x];\n        } while (ixPos < end);\n\n        s.bits += sum1;\n        return 1;\n    }\n\n    function count_bit_noESC_from2(ix, ixPos, end, t1, s) {\n        /* No ESC-words */\n        var sum = 0, sum2;\n        var xlen = Tables.ht[t1].xlen;\n        var hlen;\n        if (t1 == 2)\n            hlen = Tables.table23;\n        else\n            hlen = Tables.table56;\n\n        do {\n            var x = ix[ixPos + 0] * xlen + ix[ixPos + 1];\n            ixPos += 2;\n            sum += hlen[x];\n        } while (ixPos < end);\n\n        sum2 = sum & 0xffff;\n        sum >>= 16;\n\n        if (sum > sum2) {\n            sum = sum2;\n            t1++;\n        }\n\n        s.bits += sum;\n        return t1;\n    }\n\n    function count_bit_noESC_from3(ix, ixPos, end, t1, s) {\n        /* No ESC-words */\n        var sum1 = 0;\n        var sum2 = 0;\n        var sum3 = 0;\n        var xlen = Tables.ht[t1].xlen;\n        var hlen1 = Tables.ht[t1].hlen;\n        var hlen2 = Tables.ht[t1 + 1].hlen;\n        var hlen3 = Tables.ht[t1 + 2].hlen;\n\n        do {\n            var x = ix[ixPos + 0] * xlen + ix[ixPos + 1];\n            ixPos += 2;\n            sum1 += hlen1[x];\n            sum2 += hlen2[x];\n            sum3 += hlen3[x];\n        } while (ixPos < end);\n        var t = t1;\n        if (sum1 > sum2) {\n            sum1 = sum2;\n            t++;\n        }\n        if (sum1 > sum3) {\n            sum1 = sum3;\n            t = t1 + 2;\n        }\n        s.bits += sum1;\n\n        return t;\n    }\n\n    /*************************************************************************/\n    /* choose table */\n    /*************************************************************************/\n\n    var huf_tbl_noESC = [1, 2, 5, 7, 7, 10, 10, 13, 13,\n        13, 13, 13, 13, 13, 13];\n\n    /**\n     * Choose the Huffman table that will encode ix[begin..end] with the fewest\n     * bits.\n     *\n     * Note: This code contains knowledge about the sizes and characteristics of\n     * the Huffman tables as defined in the IS (Table B.7), and will not work\n     * with any arbitrary tables.\n     */\n    function choose_table(ix, ixPos, endPos, s) {\n        var max = ix_max(ix, ixPos, endPos);\n\n        switch (max) {\n            case 0:\n                return max;\n\n            case 1:\n                return count_bit_noESC(ix, ixPos, endPos, s);\n\n            case 2:\n            case 3:\n                return count_bit_noESC_from2(ix, ixPos, endPos,\n                    huf_tbl_noESC[max - 1], s);\n\n            case 4:\n            case 5:\n            case 6:\n            case 7:\n            case 8:\n            case 9:\n            case 10:\n            case 11:\n            case 12:\n            case 13:\n            case 14:\n            case 15:\n                return count_bit_noESC_from3(ix, ixPos, endPos,\n                    huf_tbl_noESC[max - 1], s);\n\n            default:\n                /* try tables with linbits */\n                if (max > QuantizePVT.IXMAX_VAL) {\n                    s.bits = QuantizePVT.LARGE_BITS;\n                    return -1;\n                }\n                max -= 15;\n                var choice2;\n                for (choice2 = 24; choice2 < 32; choice2++) {\n                    if (Tables.ht[choice2].linmax >= max) {\n                        break;\n                    }\n                }\n                var choice;\n                for (choice = choice2 - 8; choice < 24; choice++) {\n                    if (Tables.ht[choice].linmax >= max) {\n                        break;\n                    }\n                }\n                return count_bit_ESC(ix, ixPos, endPos, choice, choice2, s);\n        }\n    }\n\n    /**\n     * count_bit\n     */\n    this.noquant_count_bits = function (gfc, gi, prev_noise) {\n        var ix = gi.l3_enc;\n        var i = Math.min(576, ((gi.max_nonzero_coeff + 2) >> 1) << 1);\n\n        if (prev_noise != null)\n            prev_noise.sfb_count1 = 0;\n\n        /* Determine count1 region */\n        for (; i > 1; i -= 2)\n            if ((ix[i - 1] | ix[i - 2]) != 0)\n                break;\n        gi.count1 = i;\n\n        /* Determines the number of bits to encode the quadruples. */\n        var a1 = 0;\n        var a2 = 0;\n        for (; i > 3; i -= 4) {\n            var p;\n            /* hack to check if all values <= 1 */\n            //throw \"TODO: HACK         if ((((long) ix[i - 1] | (long) ix[i - 2] | (long) ix[i - 3] | (long) ix[i - 4]) & 0xffffffffL) > 1L        \"\n            //if (true) {\n            if (((ix[i - 1] | ix[i - 2] | ix[i - 3] | ix[i - 4]) & 0x7fffffff) > 1) {\n                break;\n            }\n            p = ((ix[i - 4] * 2 + ix[i - 3]) * 2 + ix[i - 2]) * 2 + ix[i - 1];\n            a1 += Tables.t32l[p];\n            a2 += Tables.t33l[p];\n        }\n        var bits = a1;\n        gi.count1table_select = 0;\n        if (a1 > a2) {\n            bits = a2;\n            gi.count1table_select = 1;\n        }\n\n        gi.count1bits = bits;\n        gi.big_values = i;\n        if (i == 0)\n            return bits;\n\n        if (gi.block_type == Encoder.SHORT_TYPE) {\n            a1 = 3 * gfc.scalefac_band.s[3];\n            if (a1 > gi.big_values)\n                a1 = gi.big_values;\n            a2 = gi.big_values;\n\n        } else if (gi.block_type == Encoder.NORM_TYPE) {\n            /* bv_scf has 576 entries (0..575) */\n            a1 = gi.region0_count = gfc.bv_scf[i - 2];\n            a2 = gi.region1_count = gfc.bv_scf[i - 1];\n\n            a2 = gfc.scalefac_band.l[a1 + a2 + 2];\n            a1 = gfc.scalefac_band.l[a1 + 1];\n            if (a2 < i) {\n                var bi = new Bits(bits);\n                gi.table_select[2] = choose_table(ix, a2, i, bi);\n                bits = bi.bits;\n            }\n        } else {\n            gi.region0_count = 7;\n            /* gi.region1_count = SBPSY_l - 7 - 1; */\n            gi.region1_count = Encoder.SBMAX_l - 1 - 7 - 1;\n            a1 = gfc.scalefac_band.l[7 + 1];\n            a2 = i;\n            if (a1 > a2) {\n                a1 = a2;\n            }\n        }\n\n        /* have to allow for the case when bigvalues < region0 < region1 */\n        /* (and region0, region1 are ignored) */\n        a1 = Math.min(a1, i);\n        a2 = Math.min(a2, i);\n\n\n        /* Count the number of bits necessary to code the bigvalues region. */\n        if (0 < a1) {\n            var bi = new Bits(bits);\n            gi.table_select[0] = choose_table(ix, 0, a1, bi);\n            bits = bi.bits;\n        }\n        if (a1 < a2) {\n            var bi = new Bits(bits);\n            gi.table_select[1] = choose_table(ix, a1, a2, bi);\n            bits = bi.bits;\n        }\n        if (gfc.use_best_huffman == 2) {\n            gi.part2_3_length = bits;\n            best_huffman_divide(gfc, gi);\n            bits = gi.part2_3_length;\n        }\n\n        if (prev_noise != null) {\n            if (gi.block_type == Encoder.NORM_TYPE) {\n                var sfb = 0;\n                while (gfc.scalefac_band.l[sfb] < gi.big_values) {\n                    sfb++;\n                }\n                prev_noise.sfb_count1 = sfb;\n            }\n        }\n\n        return bits;\n    }\n\n    this.count_bits = function (gfc, xr, gi, prev_noise) {\n        var ix = gi.l3_enc;\n\n        /* since quantize_xrpow uses table lookup, we need to check this first: */\n        var w = (QuantizePVT.IXMAX_VAL) / qupvt.IPOW20(gi.global_gain);\n\n        if (gi.xrpow_max > w)\n            return QuantizePVT.LARGE_BITS;\n\n        quantize_xrpow(xr, ix, qupvt.IPOW20(gi.global_gain), gi, prev_noise);\n\n        if ((gfc.substep_shaping & 2) != 0) {\n            var j = 0;\n            /* 0.634521682242439 = 0.5946*2**(.5*0.1875) */\n            var gain = gi.global_gain + gi.scalefac_scale;\n            var roundfac = 0.634521682242439 / qupvt.IPOW20(gain);\n            for (var sfb = 0; sfb < gi.sfbmax; sfb++) {\n                var width = gi.width[sfb];\n                if (0 == gfc.pseudohalf[sfb]) {\n                    j += width;\n                } else {\n                    var k;\n                    for (k = j, j += width; k < j; ++k) {\n                        ix[k] = (xr[k] >= roundfac) ? ix[k] : 0;\n                    }\n                }\n            }\n        }\n        return this.noquant_count_bits(gfc, gi, prev_noise);\n    }\n\n    /**\n     * re-calculate the best scalefac_compress using scfsi the saved bits are\n     * kept in the bit reservoir.\n     */\n    function recalc_divide_init(gfc, cod_info, ix, r01_bits, r01_div, r0_tbl, r1_tbl) {\n        var bigv = cod_info.big_values;\n\n        for (var r0 = 0; r0 <= 7 + 15; r0++) {\n            r01_bits[r0] = QuantizePVT.LARGE_BITS;\n        }\n\n        for (var r0 = 0; r0 < 16; r0++) {\n            var a1 = gfc.scalefac_band.l[r0 + 1];\n            if (a1 >= bigv)\n                break;\n            var r0bits = 0;\n            var bi = new Bits(r0bits);\n            var r0t = choose_table(ix, 0, a1, bi);\n            r0bits = bi.bits;\n\n            for (var r1 = 0; r1 < 8; r1++) {\n                var a2 = gfc.scalefac_band.l[r0 + r1 + 2];\n                if (a2 >= bigv)\n                    break;\n                var bits = r0bits;\n                bi = new Bits(bits);\n                var r1t = choose_table(ix, a1, a2, bi);\n                bits = bi.bits;\n                if (r01_bits[r0 + r1] > bits) {\n                    r01_bits[r0 + r1] = bits;\n                    r01_div[r0 + r1] = r0;\n                    r0_tbl[r0 + r1] = r0t;\n                    r1_tbl[r0 + r1] = r1t;\n                }\n            }\n        }\n    }\n\n    function recalc_divide_sub(gfc, cod_info2, gi, ix, r01_bits, r01_div, r0_tbl, r1_tbl) {\n        var bigv = cod_info2.big_values;\n\n        for (var r2 = 2; r2 < Encoder.SBMAX_l + 1; r2++) {\n            var a2 = gfc.scalefac_band.l[r2];\n            if (a2 >= bigv)\n                break;\n            var bits = r01_bits[r2 - 2] + cod_info2.count1bits;\n            if (gi.part2_3_length <= bits)\n                break;\n\n            var bi = new Bits(bits);\n            var r2t = choose_table(ix, a2, bigv, bi);\n            bits = bi.bits;\n            if (gi.part2_3_length <= bits)\n                continue;\n\n            gi.assign(cod_info2);\n            gi.part2_3_length = bits;\n            gi.region0_count = r01_div[r2 - 2];\n            gi.region1_count = r2 - 2 - r01_div[r2 - 2];\n            gi.table_select[0] = r0_tbl[r2 - 2];\n            gi.table_select[1] = r1_tbl[r2 - 2];\n            gi.table_select[2] = r2t;\n        }\n    }\n\n    this.best_huffman_divide = function (gfc, gi) {\n        var cod_info2 = new GrInfo();\n        var ix = gi.l3_enc;\n        var r01_bits = new_int(7 + 15 + 1);\n        var r01_div = new_int(7 + 15 + 1);\n        var r0_tbl = new_int(7 + 15 + 1);\n        var r1_tbl = new_int(7 + 15 + 1);\n\n        /* SHORT BLOCK stuff fails for MPEG2 */\n        if (gi.block_type == Encoder.SHORT_TYPE && gfc.mode_gr == 1)\n            return;\n\n        cod_info2.assign(gi);\n        if (gi.block_type == Encoder.NORM_TYPE) {\n            recalc_divide_init(gfc, gi, ix, r01_bits, r01_div, r0_tbl, r1_tbl);\n            recalc_divide_sub(gfc, cod_info2, gi, ix, r01_bits, r01_div,\n                r0_tbl, r1_tbl);\n        }\n        var i = cod_info2.big_values;\n        if (i == 0 || (ix[i - 2] | ix[i - 1]) > 1)\n            return;\n\n        i = gi.count1 + 2;\n        if (i > 576)\n            return;\n\n        /* Determines the number of bits to encode the quadruples. */\n        cod_info2.assign(gi);\n        cod_info2.count1 = i;\n        var a1 = 0;\n        var a2 = 0;\n\n\n        for (; i > cod_info2.big_values; i -= 4) {\n            var p = ((ix[i - 4] * 2 + ix[i - 3]) * 2 + ix[i - 2]) * 2\n                + ix[i - 1];\n            a1 += Tables.t32l[p];\n            a2 += Tables.t33l[p];\n        }\n        cod_info2.big_values = i;\n\n        cod_info2.count1table_select = 0;\n        if (a1 > a2) {\n            a1 = a2;\n            cod_info2.count1table_select = 1;\n        }\n\n        cod_info2.count1bits = a1;\n\n        if (cod_info2.block_type == Encoder.NORM_TYPE)\n            recalc_divide_sub(gfc, cod_info2, gi, ix, r01_bits, r01_div,\n                r0_tbl, r1_tbl);\n        else {\n            /* Count the number of bits necessary to code the bigvalues region. */\n            cod_info2.part2_3_length = a1;\n            a1 = gfc.scalefac_band.l[7 + 1];\n            if (a1 > i) {\n                a1 = i;\n            }\n            if (a1 > 0) {\n                var bi = new Bits(cod_info2.part2_3_length);\n                cod_info2.table_select[0] = choose_table(ix, 0, a1, bi);\n                cod_info2.part2_3_length = bi.bits;\n            }\n            if (i > a1) {\n                var bi = new Bits(cod_info2.part2_3_length);\n                cod_info2.table_select[1] = choose_table(ix, a1, i, bi);\n                cod_info2.part2_3_length = bi.bits;\n            }\n            if (gi.part2_3_length > cod_info2.part2_3_length)\n                gi.assign(cod_info2);\n        }\n    }\n\n    var slen1_n = [1, 1, 1, 1, 8, 2, 2, 2, 4, 4, 4, 8, 8, 8, 16, 16];\n    var slen2_n = [1, 2, 4, 8, 1, 2, 4, 8, 2, 4, 8, 2, 4, 8, 4, 8];\n    var slen1_tab = [0, 0, 0, 0, 3, 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4];\n    var slen2_tab = [0, 1, 2, 3, 0, 1, 2, 3, 1, 2, 3, 1, 2, 3, 2, 3];\n    Takehiro.slen1_tab = slen1_tab;\n    Takehiro.slen2_tab = slen2_tab;\n\n    function scfsi_calc(ch, l3_side) {\n        var sfb;\n        var gi = l3_side.tt[1][ch];\n        var g0 = l3_side.tt[0][ch];\n\n        for (var i = 0; i < Tables.scfsi_band.length - 1; i++) {\n            for (sfb = Tables.scfsi_band[i]; sfb < Tables.scfsi_band[i + 1]; sfb++) {\n                if (g0.scalefac[sfb] != gi.scalefac[sfb]\n                    && gi.scalefac[sfb] >= 0)\n                    break;\n            }\n            if (sfb == Tables.scfsi_band[i + 1]) {\n                for (sfb = Tables.scfsi_band[i]; sfb < Tables.scfsi_band[i + 1]; sfb++) {\n                    gi.scalefac[sfb] = -1;\n                }\n                l3_side.scfsi[ch][i] = 1;\n            }\n        }\n        var s1 = 0;\n        var c1 = 0;\n        for (sfb = 0; sfb < 11; sfb++) {\n            if (gi.scalefac[sfb] == -1)\n                continue;\n            c1++;\n            if (s1 < gi.scalefac[sfb])\n                s1 = gi.scalefac[sfb];\n        }\n        var s2 = 0;\n        var c2 = 0;\n        for (; sfb < Encoder.SBPSY_l; sfb++) {\n            if (gi.scalefac[sfb] == -1)\n                continue;\n            c2++;\n            if (s2 < gi.scalefac[sfb])\n                s2 = gi.scalefac[sfb];\n        }\n\n        for (var i = 0; i < 16; i++) {\n            if (s1 < slen1_n[i] && s2 < slen2_n[i]) {\n                var c = slen1_tab[i] * c1 + slen2_tab[i] * c2;\n                if (gi.part2_length > c) {\n                    gi.part2_length = c;\n                    gi.scalefac_compress = i;\n                }\n            }\n        }\n    }\n\n    /**\n     * Find the optimal way to store the scalefactors. Only call this routine\n     * after final scalefactors have been chosen and the channel/granule will\n     * not be re-encoded.\n     */\n    this.best_scalefac_store = function (gfc, gr, ch, l3_side) {\n        /* use scalefac_scale if we can */\n        var gi = l3_side.tt[gr][ch];\n        var sfb, i, j, l;\n        var recalc = 0;\n\n        /*\n         * remove scalefacs from bands with ix=0. This idea comes from the AAC\n         * ISO docs. added mt 3/00\n         */\n        /* check if l3_enc=0 */\n        j = 0;\n        for (sfb = 0; sfb < gi.sfbmax; sfb++) {\n            var width = gi.width[sfb];\n            j += width;\n            for (l = -width; l < 0; l++) {\n                if (gi.l3_enc[l + j] != 0)\n                    break;\n            }\n            if (l == 0)\n                gi.scalefac[sfb] = recalc = -2;\n            /* anything goes. */\n            /*\n             * only best_scalefac_store and calc_scfsi know--and only they\n             * should know--about the magic number -2.\n             */\n        }\n\n        if (0 == gi.scalefac_scale && 0 == gi.preflag) {\n            var s = 0;\n            for (sfb = 0; sfb < gi.sfbmax; sfb++)\n                if (gi.scalefac[sfb] > 0)\n                    s |= gi.scalefac[sfb];\n\n            if (0 == (s & 1) && s != 0) {\n                for (sfb = 0; sfb < gi.sfbmax; sfb++)\n                    if (gi.scalefac[sfb] > 0)\n                        gi.scalefac[sfb] >>= 1;\n\n                gi.scalefac_scale = recalc = 1;\n            }\n        }\n\n        if (0 == gi.preflag && gi.block_type != Encoder.SHORT_TYPE\n            && gfc.mode_gr == 2) {\n            for (sfb = 11; sfb < Encoder.SBPSY_l; sfb++)\n                if (gi.scalefac[sfb] < qupvt.pretab[sfb]\n                    && gi.scalefac[sfb] != -2)\n                    break;\n            if (sfb == Encoder.SBPSY_l) {\n                for (sfb = 11; sfb < Encoder.SBPSY_l; sfb++)\n                    if (gi.scalefac[sfb] > 0)\n                        gi.scalefac[sfb] -= qupvt.pretab[sfb];\n\n                gi.preflag = recalc = 1;\n            }\n        }\n\n        for (i = 0; i < 4; i++)\n            l3_side.scfsi[ch][i] = 0;\n\n        if (gfc.mode_gr == 2 && gr == 1\n            && l3_side.tt[0][ch].block_type != Encoder.SHORT_TYPE\n            && l3_side.tt[1][ch].block_type != Encoder.SHORT_TYPE) {\n            scfsi_calc(ch, l3_side);\n            recalc = 0;\n        }\n        for (sfb = 0; sfb < gi.sfbmax; sfb++) {\n            if (gi.scalefac[sfb] == -2) {\n                gi.scalefac[sfb] = 0;\n                /* if anything goes, then 0 is a good choice */\n            }\n        }\n        if (recalc != 0) {\n            if (gfc.mode_gr == 2) {\n                this.scale_bitcount(gi);\n            } else {\n                this.scale_bitcount_lsf(gfc, gi);\n            }\n        }\n    }\n\n    function all_scalefactors_not_negative(scalefac, n) {\n        for (var i = 0; i < n; ++i) {\n            if (scalefac[i] < 0)\n                return false;\n        }\n        return true;\n    }\n\n    /**\n     * number of bits used to encode scalefacs.\n     *\n     * 18*slen1_tab[i] + 18*slen2_tab[i]\n     */\n    var scale_short = [0, 18, 36, 54, 54, 36, 54, 72,\n        54, 72, 90, 72, 90, 108, 108, 126];\n\n    /**\n     * number of bits used to encode scalefacs.\n     *\n     * 17*slen1_tab[i] + 18*slen2_tab[i]\n     */\n    var scale_mixed = [0, 18, 36, 54, 51, 35, 53, 71,\n        52, 70, 88, 69, 87, 105, 104, 122];\n\n    /**\n     * number of bits used to encode scalefacs.\n     *\n     * 11*slen1_tab[i] + 10*slen2_tab[i]\n     */\n    var scale_long = [0, 10, 20, 30, 33, 21, 31, 41, 32, 42,\n        52, 43, 53, 63, 64, 74];\n\n    /**\n     * Also calculates the number of bits necessary to code the scalefactors.\n     */\n    this.scale_bitcount = function (cod_info) {\n        var k, sfb, max_slen1 = 0, max_slen2 = 0;\n\n        /* maximum values */\n        var tab;\n        var scalefac = cod_info.scalefac;\n\n\n        if (cod_info.block_type == Encoder.SHORT_TYPE) {\n            tab = scale_short;\n            if (cod_info.mixed_block_flag != 0)\n                tab = scale_mixed;\n        } else { /* block_type == 1,2,or 3 */\n            tab = scale_long;\n            if (0 == cod_info.preflag) {\n                for (sfb = 11; sfb < Encoder.SBPSY_l; sfb++)\n                    if (scalefac[sfb] < qupvt.pretab[sfb])\n                        break;\n\n                if (sfb == Encoder.SBPSY_l) {\n                    cod_info.preflag = 1;\n                    for (sfb = 11; sfb < Encoder.SBPSY_l; sfb++)\n                        scalefac[sfb] -= qupvt.pretab[sfb];\n                }\n            }\n        }\n\n        for (sfb = 0; sfb < cod_info.sfbdivide; sfb++)\n            if (max_slen1 < scalefac[sfb])\n                max_slen1 = scalefac[sfb];\n\n        for (; sfb < cod_info.sfbmax; sfb++)\n            if (max_slen2 < scalefac[sfb])\n                max_slen2 = scalefac[sfb];\n\n        /*\n         * from Takehiro TOMINAGA <tominaga@isoternet.org> 10/99 loop over *all*\n         * posible values of scalefac_compress to find the one which uses the\n         * smallest number of bits. ISO would stop at first valid index\n         */\n        cod_info.part2_length = QuantizePVT.LARGE_BITS;\n        for (k = 0; k < 16; k++) {\n            if (max_slen1 < slen1_n[k] && max_slen2 < slen2_n[k]\n                && cod_info.part2_length > tab[k]) {\n                cod_info.part2_length = tab[k];\n                cod_info.scalefac_compress = k;\n            }\n        }\n        return cod_info.part2_length == QuantizePVT.LARGE_BITS;\n    }\n\n    /**\n     * table of largest scalefactor values for MPEG2\n     */\n    var max_range_sfac_tab = [[15, 15, 7, 7],\n        [15, 15, 7, 0], [7, 3, 0, 0], [15, 31, 31, 0],\n        [7, 7, 7, 0], [3, 3, 0, 0]];\n\n    /**\n     * Also counts the number of bits to encode the scalefacs but for MPEG 2\n     * Lower sampling frequencies (24, 22.05 and 16 kHz.)\n     *\n     * This is reverse-engineered from section 2.4.3.2 of the MPEG2 IS,\n     * \"Audio Decoding Layer III\"\n     */\n    this.scale_bitcount_lsf = function (gfc, cod_info) {\n        var table_number, row_in_table, partition, nr_sfb, window;\n        var over;\n        var i, sfb;\n        var max_sfac = new_int(4);\n//var partition_table;\n        var scalefac = cod_info.scalefac;\n\n        /*\n         * Set partition table. Note that should try to use table one, but do\n         * not yet...\n         */\n        if (cod_info.preflag != 0)\n            table_number = 2;\n        else\n            table_number = 0;\n\n        for (i = 0; i < 4; i++)\n            max_sfac[i] = 0;\n\n        if (cod_info.block_type == Encoder.SHORT_TYPE) {\n            row_in_table = 1;\n            var partition_table = qupvt.nr_of_sfb_block[table_number][row_in_table];\n            for (sfb = 0, partition = 0; partition < 4; partition++) {\n                nr_sfb = partition_table[partition] / 3;\n                for (i = 0; i < nr_sfb; i++, sfb++)\n                    for (window = 0; window < 3; window++)\n                        if (scalefac[sfb * 3 + window] > max_sfac[partition])\n                            max_sfac[partition] = scalefac[sfb * 3 + window];\n            }\n        } else {\n            row_in_table = 0;\n            var partition_table = qupvt.nr_of_sfb_block[table_number][row_in_table];\n            for (sfb = 0, partition = 0; partition < 4; partition++) {\n                nr_sfb = partition_table[partition];\n                for (i = 0; i < nr_sfb; i++, sfb++)\n                    if (scalefac[sfb] > max_sfac[partition])\n                        max_sfac[partition] = scalefac[sfb];\n            }\n        }\n\n        for (over = false, partition = 0; partition < 4; partition++) {\n            if (max_sfac[partition] > max_range_sfac_tab[table_number][partition])\n                over = true;\n        }\n        if (!over) {\n            var slen1, slen2, slen3, slen4;\n\n            cod_info.sfb_partition_table = qupvt.nr_of_sfb_block[table_number][row_in_table];\n            for (partition = 0; partition < 4; partition++)\n                cod_info.slen[partition] = log2tab[max_sfac[partition]];\n\n            /* set scalefac_compress */\n            slen1 = cod_info.slen[0];\n            slen2 = cod_info.slen[1];\n            slen3 = cod_info.slen[2];\n            slen4 = cod_info.slen[3];\n\n            switch (table_number) {\n                case 0:\n                    cod_info.scalefac_compress = (((slen1 * 5) + slen2) << 4)\n                        + (slen3 << 2) + slen4;\n                    break;\n\n                case 1:\n                    cod_info.scalefac_compress = 400 + (((slen1 * 5) + slen2) << 2)\n                        + slen3;\n                    break;\n\n                case 2:\n                    cod_info.scalefac_compress = 500 + (slen1 * 3) + slen2;\n                    break;\n\n                default:\n                    System.err.printf(\"intensity stereo not implemented yet\\n\");\n                    break;\n            }\n        }\n        if (!over) {\n            cod_info.part2_length = 0;\n            for (partition = 0; partition < 4; partition++)\n                cod_info.part2_length += cod_info.slen[partition]\n                    * cod_info.sfb_partition_table[partition];\n        }\n        return over;\n    }\n\n    /*\n     * Since no bands have been over-amplified, we can set scalefac_compress and\n     * slen[] for the formatter\n     */\n    var log2tab = [0, 1, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4,\n        4, 4, 4, 4];\n\n    this.huffman_init = function (gfc) {\n        for (var i = 2; i <= 576; i += 2) {\n            var scfb_anz = 0, bv_index;\n            while (gfc.scalefac_band.l[++scfb_anz] < i)\n                ;\n\n            bv_index = subdv_table[scfb_anz][0]; // .region0_count\n            while (gfc.scalefac_band.l[bv_index + 1] > i)\n                bv_index--;\n\n            if (bv_index < 0) {\n                /*\n                 * this is an indication that everything is going to be encoded\n                 * as region0: bigvalues < region0 < region1 so lets set\n                 * region0, region1 to some value larger than bigvalues\n                 */\n                bv_index = subdv_table[scfb_anz][0]; // .region0_count\n            }\n\n            gfc.bv_scf[i - 2] = bv_index;\n\n            bv_index = subdv_table[scfb_anz][1]; // .region1_count\n            while (gfc.scalefac_band.l[bv_index + gfc.bv_scf[i - 2] + 2] > i)\n                bv_index--;\n\n            if (bv_index < 0) {\n                bv_index = subdv_table[scfb_anz][1]; // .region1_count\n            }\n\n            gfc.bv_scf[i - 1] = bv_index;\n        }\n    }\n}\n\n/*\n *  ReplayGainAnalysis - analyzes input samples and give the recommended dB change\n *  Copyright (C) 2001 David Robinson and Glen Sawyer\n *  Improvements and optimizations added by Frank Klemm, and by Marcel Muller \n *\n *  This library is free software; you can redistribute it and/or\n *  modify it under the terms of the GNU Lesser General Public\n *  License as published by the Free Software Foundation; either\n *  version 2.1 of the License, or (at your option) any later version.\n *\n *  This library is distributed in the hope that it will be useful,\n *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n *  Lesser General Public License for more details.\n *\n *  You should have received a copy of the GNU Lesser General Public\n *  License along with this library; if not, write to the Free Software\n *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA\n *\n *  concept and filter values by David Robinson (David@Robinson.org)\n *    -- blame him if you think the idea is flawed\n *  original coding by Glen Sawyer (mp3gain@hotmail.com)\n *    -- blame him if you think this runs too slowly, or the coding is otherwise flawed\n *\n *  lots of code improvements by Frank Klemm ( http://www.uni-jena.de/~pfk/mpp/ )\n *    -- credit him for all the _good_ programming ;)\n *\n *\n *  For an explanation of the concepts and the basic algorithms involved, go to:\n *    http://www.replaygain.org/\n */\n\n/*\n *  Here's the deal. Call\n *\n *    InitGainAnalysis ( long samplefreq );\n *\n *  to initialize everything. Call\n *\n *    AnalyzeSamples ( var Float_t*  left_samples,\n *                     var Float_t*  right_samples,\n *                     size_t          num_samples,\n *                     int             num_channels );\n *\n *  as many times as you want, with as many or as few samples as you want.\n *  If mono, pass the sample buffer in through left_samples, leave\n *  right_samples NULL, and make sure num_channels = 1.\n *\n *    GetTitleGain()\n *\n *  will return the recommended dB level change for all samples analyzed\n *  SINCE THE LAST TIME you called GetTitleGain() OR InitGainAnalysis().\n *\n *    GetAlbumGain()\n *\n *  will return the recommended dB level change for all samples analyzed\n *  since InitGainAnalysis() was called and finalized with GetTitleGain().\n *\n *  Pseudo-code to process an album:\n *\n *    Float_t       l_samples [4096];\n *    Float_t       r_samples [4096];\n *    size_t        num_samples;\n *    unsigned int  num_songs;\n *    unsigned int  i;\n *\n *    InitGainAnalysis ( 44100 );\n *    for ( i = 1; i <= num_songs; i++ ) {\n *        while ( ( num_samples = getSongSamples ( song[i], left_samples, right_samples ) ) > 0 )\n *            AnalyzeSamples ( left_samples, right_samples, num_samples, 2 );\n *        fprintf (\"Recommended dB change for song %2d: %+6.2 dB\\n\", i, GetTitleGain() );\n *    }\n *    fprintf (\"Recommended dB change for whole album: %+6.2 dB\\n\", GetAlbumGain() );\n */\n\n/*\n *  So here's the main source of potential code confusion:\n *\n *  The filters applied to the incoming samples are IIR filters,\n *  meaning they rely on up to <filter order> number of previous samples\n *  AND up to <filter order> number of previous filtered samples.\n *\n *  I set up the AnalyzeSamples routine to minimize memory usage and interface\n *  complexity. The speed isn't compromised too much (I don't think), but the\n *  internal complexity is higher than it should be for such a relatively\n *  simple routine.\n *\n *  Optimization/clarity suggestions are welcome.\n */\n\n/**\n * Table entries per dB\n */\nGainAnalysis.STEPS_per_dB = 100.;\n/**\n * Table entries for 0...MAX_dB (normal max. values are 70...80 dB)\n */\nGainAnalysis.MAX_dB = 120.;\nGainAnalysis.GAIN_NOT_ENOUGH_SAMPLES = -24601;\nGainAnalysis.GAIN_ANALYSIS_ERROR = 0;\nGainAnalysis.GAIN_ANALYSIS_OK = 1;\nGainAnalysis.INIT_GAIN_ANALYSIS_ERROR = 0;\nGainAnalysis.INIT_GAIN_ANALYSIS_OK = 1;\n\nGainAnalysis.YULE_ORDER = 10;\nGainAnalysis.MAX_ORDER = GainAnalysis.YULE_ORDER;\n\nGainAnalysis.MAX_SAMP_FREQ = 48000;\nGainAnalysis.RMS_WINDOW_TIME_NUMERATOR = 1;\nGainAnalysis.RMS_WINDOW_TIME_DENOMINATOR = 20;\nGainAnalysis.MAX_SAMPLES_PER_WINDOW = ((GainAnalysis.MAX_SAMP_FREQ * GainAnalysis.RMS_WINDOW_TIME_NUMERATOR) / GainAnalysis.RMS_WINDOW_TIME_DENOMINATOR + 1);\n\nfunction GainAnalysis() {\n\t//fix 精简\n}\n\n\nfunction Presets() {\n    function VBRPresets(qual, comp, compS,\n                        y, shThreshold, shThresholdS,\n                        adj, adjShort, lower,\n                        curve, sens, inter,\n                        joint, mod, fix) {\n        this.vbr_q = qual;\n        this.quant_comp = comp;\n        this.quant_comp_s = compS;\n        this.expY = y;\n        this.st_lrm = shThreshold;\n        this.st_s = shThresholdS;\n        this.masking_adj = adj;\n        this.masking_adj_short = adjShort;\n        this.ath_lower = lower;\n        this.ath_curve = curve;\n        this.ath_sensitivity = sens;\n        this.interch = inter;\n        this.safejoint = joint;\n        this.sfb21mod = mod;\n        this.msfix = fix;\n    }\n\n    function ABRPresets(kbps, comp, compS,\n                        joint, fix, shThreshold,\n                        shThresholdS, bass, sc,\n                        mask, lower, curve,\n                        interCh, sfScale) {\n        this.quant_comp = comp;\n        this.quant_comp_s = compS;\n        this.safejoint = joint;\n        this.nsmsfix = fix;\n        this.st_lrm = shThreshold;\n        this.st_s = shThresholdS;\n        this.nsbass = bass;\n        this.scale = sc;\n        this.masking_adj = mask;\n        this.ath_lower = lower;\n        this.ath_curve = curve;\n        this.interch = interCh;\n        this.sfscale = sfScale;\n    }\n\n    var lame;\n\n    this.setModules = function (_lame) {\n        lame = _lame;\n    };\n\n    /**\n     * <PRE>\n     * Switch mappings for VBR mode VBR_RH\n     *             vbr_q  qcomp_l  qcomp_s  expY  st_lrm   st_s  mask adj_l  adj_s  ath_lower  ath_curve  ath_sens  interChR  safejoint sfb21mod  msfix\n     * </PRE>\n     */\n    var vbr_old_switch_map = [\n        new VBRPresets(0, 9, 9, 0, 5.20, 125.0, -4.2, -6.3, 4.8, 1, 0, 0, 2, 21, 0.97),\n        new VBRPresets(1, 9, 9, 0, 5.30, 125.0, -3.6, -5.6, 4.5, 1.5, 0, 0, 2, 21, 1.35),\n        new VBRPresets(2, 9, 9, 0, 5.60, 125.0, -2.2, -3.5, 2.8, 2, 0, 0, 2, 21, 1.49),\n        new VBRPresets(3, 9, 9, 1, 5.80, 130.0, -1.8, -2.8, 2.6, 3, -4, 0, 2, 20, 1.64),\n        new VBRPresets(4, 9, 9, 1, 6.00, 135.0, -0.7, -1.1, 1.1, 3.5, -8, 0, 2, 0, 1.79),\n        new VBRPresets(5, 9, 9, 1, 6.40, 140.0, 0.5, 0.4, -7.5, 4, -12, 0.0002, 0, 0, 1.95),\n        new VBRPresets(6, 9, 9, 1, 6.60, 145.0, 0.67, 0.65, -14.7, 6.5, -19, 0.0004, 0, 0, 2.30),\n        new VBRPresets(7, 9, 9, 1, 6.60, 145.0, 0.8, 0.75, -19.7, 8, -22, 0.0006, 0, 0, 2.70),\n        new VBRPresets(8, 9, 9, 1, 6.60, 145.0, 1.2, 1.15, -27.5, 10, -23, 0.0007, 0, 0, 0),\n        new VBRPresets(9, 9, 9, 1, 6.60, 145.0, 1.6, 1.6, -36, 11, -25, 0.0008, 0, 0, 0),\n        new VBRPresets(10, 9, 9, 1, 6.60, 145.0, 2.0, 2.0, -36, 12, -25, 0.0008, 0, 0, 0)\n    ];\n\n    /**\n     * <PRE>\n     *                 vbr_q  qcomp_l  qcomp_s  expY  st_lrm   st_s  mask adj_l  adj_s  ath_lower  ath_curve  ath_sens  interChR  safejoint sfb21mod  msfix\n     * </PRE>\n     */\n    var vbr_psy_switch_map = [\n        new VBRPresets(0, 9, 9, 0, 4.20, 25.0, -7.0, -4.0, 7.5, 1, 0, 0, 2, 26, 0.97),\n        new VBRPresets(1, 9, 9, 0, 4.20, 25.0, -5.6, -3.6, 4.5, 1.5, 0, 0, 2, 21, 1.35),\n        new VBRPresets(2, 9, 9, 0, 4.20, 25.0, -4.4, -1.8, 2, 2, 0, 0, 2, 18, 1.49),\n        new VBRPresets(3, 9, 9, 1, 4.20, 25.0, -3.4, -1.25, 1.1, 3, -4, 0, 2, 15, 1.64),\n        new VBRPresets(4, 9, 9, 1, 4.20, 25.0, -2.2, 0.1, 0, 3.5, -8, 0, 2, 0, 1.79),\n        new VBRPresets(5, 9, 9, 1, 4.20, 25.0, -1.0, 1.65, -7.7, 4, -12, 0.0002, 0, 0, 1.95),\n        new VBRPresets(6, 9, 9, 1, 4.20, 25.0, -0.0, 2.47, -7.7, 6.5, -19, 0.0004, 0, 0, 2),\n        new VBRPresets(7, 9, 9, 1, 4.20, 25.0, 0.5, 2.0, -14.5, 8, -22, 0.0006, 0, 0, 2),\n        new VBRPresets(8, 9, 9, 1, 4.20, 25.0, 1.0, 2.4, -22.0, 10, -23, 0.0007, 0, 0, 2),\n        new VBRPresets(9, 9, 9, 1, 4.20, 25.0, 1.5, 2.95, -30.0, 11, -25, 0.0008, 0, 0, 2),\n        new VBRPresets(10, 9, 9, 1, 4.20, 25.0, 2.0, 2.95, -36.0, 12, -30, 0.0008, 0, 0, 2)\n    ];\n\n    function apply_vbr_preset(gfp, a, enforce) {\n        var vbr_preset = gfp.VBR == VbrMode.vbr_rh ? vbr_old_switch_map\n            : vbr_psy_switch_map;\n\n        var x = gfp.VBR_q_frac;\n        var p = vbr_preset[a];\n        var q = vbr_preset[a + 1];\n        var set = p;\n\n        // NOOP(vbr_q);\n        // NOOP(quant_comp);\n        // NOOP(quant_comp_s);\n        // NOOP(expY);\n        p.st_lrm = p.st_lrm + x * (q.st_lrm - p.st_lrm);\n        // LERP(st_lrm);\n        p.st_s = p.st_s + x * (q.st_s - p.st_s);\n        // LERP(st_s);\n        p.masking_adj = p.masking_adj + x * (q.masking_adj - p.masking_adj);\n        // LERP(masking_adj);\n        p.masking_adj_short = p.masking_adj_short + x\n            * (q.masking_adj_short - p.masking_adj_short);\n        // LERP(masking_adj_short);\n        p.ath_lower = p.ath_lower + x * (q.ath_lower - p.ath_lower);\n        // LERP(ath_lower);\n        p.ath_curve = p.ath_curve + x * (q.ath_curve - p.ath_curve);\n        // LERP(ath_curve);\n        p.ath_sensitivity = p.ath_sensitivity + x\n            * (q.ath_sensitivity - p.ath_sensitivity);\n        // LERP(ath_sensitivity);\n        p.interch = p.interch + x * (q.interch - p.interch);\n        // LERP(interch);\n        // NOOP(safejoint);\n        // NOOP(sfb21mod);\n        p.msfix = p.msfix + x * (q.msfix - p.msfix);\n        // LERP(msfix);\n\n        lame_set_VBR_q(gfp, set.vbr_q);\n\n        if (enforce != 0)\n            gfp.quant_comp = set.quant_comp;\n        else if (!(Math.abs(gfp.quant_comp - -1) > 0))\n            gfp.quant_comp = set.quant_comp;\n        // SET_OPTION(quant_comp, set.quant_comp, -1);\n        if (enforce != 0)\n            gfp.quant_comp_short = set.quant_comp_s;\n        else if (!(Math.abs(gfp.quant_comp_short - -1) > 0))\n            gfp.quant_comp_short = set.quant_comp_s;\n        // SET_OPTION(quant_comp_short, set.quant_comp_s, -1);\n        if (set.expY != 0) {\n            gfp.experimentalY = set.expY != 0;\n        }\n        if (enforce != 0)\n            gfp.internal_flags.nsPsy.attackthre = set.st_lrm;\n        else if (!(Math.abs(gfp.internal_flags.nsPsy.attackthre - -1) > 0))\n            gfp.internal_flags.nsPsy.attackthre = set.st_lrm;\n        // SET_OPTION(short_threshold_lrm, set.st_lrm, -1);\n        if (enforce != 0)\n            gfp.internal_flags.nsPsy.attackthre_s = set.st_s;\n        else if (!(Math.abs(gfp.internal_flags.nsPsy.attackthre_s - -1) > 0))\n            gfp.internal_flags.nsPsy.attackthre_s = set.st_s;\n        // SET_OPTION(short_threshold_s, set.st_s, -1);\n        if (enforce != 0)\n            gfp.maskingadjust = set.masking_adj;\n        else if (!(Math.abs(gfp.maskingadjust - 0) > 0))\n            gfp.maskingadjust = set.masking_adj;\n        // SET_OPTION(maskingadjust, set.masking_adj, 0);\n        if (enforce != 0)\n            gfp.maskingadjust_short = set.masking_adj_short;\n        else if (!(Math.abs(gfp.maskingadjust_short - 0) > 0))\n            gfp.maskingadjust_short = set.masking_adj_short;\n        // SET_OPTION(maskingadjust_short, set.masking_adj_short, 0);\n        if (enforce != 0)\n            gfp.ATHlower = -set.ath_lower / 10.0;\n        else if (!(Math.abs((-gfp.ATHlower * 10.0) - 0) > 0))\n            gfp.ATHlower = -set.ath_lower / 10.0;\n        // SET_OPTION(ATHlower, set.ath_lower, 0);\n        if (enforce != 0)\n            gfp.ATHcurve = set.ath_curve;\n        else if (!(Math.abs(gfp.ATHcurve - -1) > 0))\n            gfp.ATHcurve = set.ath_curve;\n        // SET_OPTION(ATHcurve, set.ath_curve, -1);\n        if (enforce != 0)\n            gfp.athaa_sensitivity = set.ath_sensitivity;\n        else if (!(Math.abs(gfp.athaa_sensitivity - -1) > 0))\n            gfp.athaa_sensitivity = set.ath_sensitivity;\n        // SET_OPTION(athaa_sensitivity, set.ath_sensitivity, 0);\n        if (set.interch > 0) {\n            if (enforce != 0)\n                gfp.interChRatio = set.interch;\n            else if (!(Math.abs(gfp.interChRatio - -1) > 0))\n                gfp.interChRatio = set.interch;\n            // SET_OPTION(interChRatio, set.interch, -1);\n        }\n\n        /* parameters for which there is no proper set/get interface */\n        if (set.safejoint > 0) {\n            gfp.exp_nspsytune = gfp.exp_nspsytune | set.safejoint;\n        }\n        if (set.sfb21mod > 0) {\n            gfp.exp_nspsytune = gfp.exp_nspsytune | (set.sfb21mod << 20);\n        }\n        if (enforce != 0)\n            gfp.msfix = set.msfix;\n        else if (!(Math.abs(gfp.msfix - -1) > 0))\n            gfp.msfix = set.msfix;\n        // SET_OPTION(msfix, set.msfix, -1);\n\n        if (enforce == 0) {\n            gfp.VBR_q = a;\n            gfp.VBR_q_frac = x;\n        }\n    }\n\n    /**\n     * <PRE>\n     *  Switch mappings for ABR mode\n     *\n     *              kbps  quant q_s safejoint nsmsfix st_lrm  st_s  ns-bass scale   msk ath_lwr ath_curve  interch , sfscale\n     * </PRE>\n     */\n    var abr_switch_map = [\n        new ABRPresets(8, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -30.0, 11, 0.0012, 1), /*   8, impossible to use in stereo */\n        new ABRPresets(16, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -25.0, 11, 0.0010, 1), /*  16 */\n        new ABRPresets(24, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -20.0, 11, 0.0010, 1), /*  24 */\n        new ABRPresets(32, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -15.0, 11, 0.0010, 1), /*  32 */\n        new ABRPresets(40, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -10.0, 11, 0.0009, 1), /*  40 */\n        new ABRPresets(48, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -10.0, 11, 0.0009, 1), /*  48 */\n        new ABRPresets(56, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -6.0, 11, 0.0008, 1), /*  56 */\n        new ABRPresets(64, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, -2.0, 11, 0.0008, 1), /*  64 */\n        new ABRPresets(80, 9, 9, 0, 0, 6.60, 145, 0, 0.95, 0, .0, 8, 0.0007, 1), /*  80 */\n        new ABRPresets(96, 9, 9, 0, 2.50, 6.60, 145, 0, 0.95, 0, 1.0, 5.5, 0.0006, 1), /*  96 */\n        new ABRPresets(112, 9, 9, 0, 2.25, 6.60, 145, 0, 0.95, 0, 2.0, 4.5, 0.0005, 1), /* 112 */\n        new ABRPresets(128, 9, 9, 0, 1.95, 6.40, 140, 0, 0.95, 0, 3.0, 4, 0.0002, 1), /* 128 */\n        new ABRPresets(160, 9, 9, 1, 1.79, 6.00, 135, 0, 0.95, -2, 5.0, 3.5, 0, 1), /* 160 */\n        new ABRPresets(192, 9, 9, 1, 1.49, 5.60, 125, 0, 0.97, -4, 7.0, 3, 0, 0), /* 192 */\n        new ABRPresets(224, 9, 9, 1, 1.25, 5.20, 125, 0, 0.98, -6, 9.0, 2, 0, 0), /* 224 */\n        new ABRPresets(256, 9, 9, 1, 0.97, 5.20, 125, 0, 1.00, -8, 10.0, 1, 0, 0), /* 256 */\n        new ABRPresets(320, 9, 9, 1, 0.90, 5.20, 125, 0, 1.00, -10, 12.0, 0, 0, 0)  /* 320 */\n    ];\n\n    function apply_abr_preset(gfp, preset, enforce) {\n        /* Variables for the ABR stuff */\n        var actual_bitrate = preset;\n\n        var r = lame.nearestBitrateFullIndex(preset);\n\n        gfp.VBR = VbrMode.vbr_abr;\n        gfp.VBR_mean_bitrate_kbps = actual_bitrate;\n        gfp.VBR_mean_bitrate_kbps = Math.min(gfp.VBR_mean_bitrate_kbps, 320);\n        gfp.VBR_mean_bitrate_kbps = Math.max(gfp.VBR_mean_bitrate_kbps, 8);\n        gfp.brate = gfp.VBR_mean_bitrate_kbps;\n        if (gfp.VBR_mean_bitrate_kbps > 320) {\n            gfp.disable_reservoir = true;\n        }\n\n        /* parameters for which there is no proper set/get interface */\n        if (abr_switch_map[r].safejoint > 0)\n            gfp.exp_nspsytune = gfp.exp_nspsytune | 2;\n        /* safejoint */\n\n        if (abr_switch_map[r].sfscale > 0) {\n            gfp.internal_flags.noise_shaping = 2;\n        }\n        /* ns-bass tweaks */\n        if (Math.abs(abr_switch_map[r].nsbass) > 0) {\n            var k = (int)(abr_switch_map[r].nsbass * 4);\n            if (k < 0)\n                k += 64;\n            gfp.exp_nspsytune = gfp.exp_nspsytune | (k << 2);\n        }\n\n        if (enforce != 0)\n            gfp.quant_comp = abr_switch_map[r].quant_comp;\n        else if (!(Math.abs(gfp.quant_comp - -1) > 0))\n            gfp.quant_comp = abr_switch_map[r].quant_comp;\n        // SET_OPTION(quant_comp, abr_switch_map[r].quant_comp, -1);\n        if (enforce != 0)\n            gfp.quant_comp_short = abr_switch_map[r].quant_comp_s;\n        else if (!(Math.abs(gfp.quant_comp_short - -1) > 0))\n            gfp.quant_comp_short = abr_switch_map[r].quant_comp_s;\n        // SET_OPTION(quant_comp_short, abr_switch_map[r].quant_comp_s, -1);\n\n        if (enforce != 0)\n            gfp.msfix = abr_switch_map[r].nsmsfix;\n        else if (!(Math.abs(gfp.msfix - -1) > 0))\n            gfp.msfix = abr_switch_map[r].nsmsfix;\n        // SET_OPTION(msfix, abr_switch_map[r].nsmsfix, -1);\n\n        if (enforce != 0)\n            gfp.internal_flags.nsPsy.attackthre = abr_switch_map[r].st_lrm;\n        else if (!(Math.abs(gfp.internal_flags.nsPsy.attackthre - -1) > 0))\n            gfp.internal_flags.nsPsy.attackthre = abr_switch_map[r].st_lrm;\n        // SET_OPTION(short_threshold_lrm, abr_switch_map[r].st_lrm, -1);\n        if (enforce != 0)\n            gfp.internal_flags.nsPsy.attackthre_s = abr_switch_map[r].st_s;\n        else if (!(Math.abs(gfp.internal_flags.nsPsy.attackthre_s - -1) > 0))\n            gfp.internal_flags.nsPsy.attackthre_s = abr_switch_map[r].st_s;\n        // SET_OPTION(short_threshold_s, abr_switch_map[r].st_s, -1);\n\n        /*\n         * ABR seems to have big problems with clipping, especially at low\n         * bitrates\n         */\n        /*\n         * so we compensate for that here by using a scale value depending on\n         * bitrate\n         */\n        if (enforce != 0)\n            gfp.scale = abr_switch_map[r].scale;\n        else if (!(Math.abs(gfp.scale - -1) > 0))\n            gfp.scale = abr_switch_map[r].scale;\n        // SET_OPTION(scale, abr_switch_map[r].scale, -1);\n\n        if (enforce != 0)\n            gfp.maskingadjust = abr_switch_map[r].masking_adj;\n        else if (!(Math.abs(gfp.maskingadjust - 0) > 0))\n            gfp.maskingadjust = abr_switch_map[r].masking_adj;\n        // SET_OPTION(maskingadjust, abr_switch_map[r].masking_adj, 0);\n        if (abr_switch_map[r].masking_adj > 0) {\n            if (enforce != 0)\n                gfp.maskingadjust_short = (abr_switch_map[r].masking_adj * .9);\n            else if (!(Math.abs(gfp.maskingadjust_short - 0) > 0))\n                gfp.maskingadjust_short = (abr_switch_map[r].masking_adj * .9);\n            // SET_OPTION(maskingadjust_short, abr_switch_map[r].masking_adj *\n            // .9, 0);\n        } else {\n            if (enforce != 0)\n                gfp.maskingadjust_short = (abr_switch_map[r].masking_adj * 1.1);\n            else if (!(Math.abs(gfp.maskingadjust_short - 0) > 0))\n                gfp.maskingadjust_short = (abr_switch_map[r].masking_adj * 1.1);\n            // SET_OPTION(maskingadjust_short, abr_switch_map[r].masking_adj *\n            // 1.1, 0);\n        }\n\n        if (enforce != 0)\n            gfp.ATHlower = -abr_switch_map[r].ath_lower / 10.;\n        else if (!(Math.abs((-gfp.ATHlower * 10.) - 0) > 0))\n            gfp.ATHlower = -abr_switch_map[r].ath_lower / 10.;\n        // SET_OPTION(ATHlower, abr_switch_map[r].ath_lower, 0);\n        if (enforce != 0)\n            gfp.ATHcurve = abr_switch_map[r].ath_curve;\n        else if (!(Math.abs(gfp.ATHcurve - -1) > 0))\n            gfp.ATHcurve = abr_switch_map[r].ath_curve;\n        // SET_OPTION(ATHcurve, abr_switch_map[r].ath_curve, -1);\n\n        if (enforce != 0)\n            gfp.interChRatio = abr_switch_map[r].interch;\n        else if (!(Math.abs(gfp.interChRatio - -1) > 0))\n            gfp.interChRatio = abr_switch_map[r].interch;\n        // SET_OPTION(interChRatio, abr_switch_map[r].interch, -1);\n\n        return preset;\n    }\n\n    this.apply_preset = function(gfp, preset, enforce) {\n        /* translate legacy presets */\n        switch (preset) {\n            case Lame.R3MIX:\n            {\n                preset = Lame.V3;\n                gfp.VBR = VbrMode.vbr_mtrh;\n                break;\n            }\n            case Lame.MEDIUM:\n            {\n                preset = Lame.V4;\n                gfp.VBR = VbrMode.vbr_rh;\n                break;\n            }\n            case Lame.MEDIUM_FAST:\n            {\n                preset = Lame.V4;\n                gfp.VBR = VbrMode.vbr_mtrh;\n                break;\n            }\n            case Lame.STANDARD:\n            {\n                preset = Lame.V2;\n                gfp.VBR = VbrMode.vbr_rh;\n                break;\n            }\n            case Lame.STANDARD_FAST:\n            {\n                preset = Lame.V2;\n                gfp.VBR = VbrMode.vbr_mtrh;\n                break;\n            }\n            case Lame.EXTREME:\n            {\n                preset = Lame.V0;\n                gfp.VBR = VbrMode.vbr_rh;\n                break;\n            }\n            case Lame.EXTREME_FAST:\n            {\n                preset = Lame.V0;\n                gfp.VBR = VbrMode.vbr_mtrh;\n                break;\n            }\n            case Lame.INSANE:\n            {\n                preset = 320;\n                gfp.preset = preset;\n                apply_abr_preset(gfp, preset, enforce);\n                gfp.VBR = VbrMode.vbr_off;\n                return preset;\n            }\n        }\n\n        gfp.preset = preset;\n        {\n            switch (preset) {\n                case Lame.V9:\n                    apply_vbr_preset(gfp, 9, enforce);\n                    return preset;\n                case Lame.V8:\n                    apply_vbr_preset(gfp, 8, enforce);\n                    return preset;\n                case Lame.V7:\n                    apply_vbr_preset(gfp, 7, enforce);\n                    return preset;\n                case Lame.V6:\n                    apply_vbr_preset(gfp, 6, enforce);\n                    return preset;\n                case Lame.V5:\n                    apply_vbr_preset(gfp, 5, enforce);\n                    return preset;\n                case Lame.V4:\n                    apply_vbr_preset(gfp, 4, enforce);\n                    return preset;\n                case Lame.V3:\n                    apply_vbr_preset(gfp, 3, enforce);\n                    return preset;\n                case Lame.V2:\n                    apply_vbr_preset(gfp, 2, enforce);\n                    return preset;\n                case Lame.V1:\n                    apply_vbr_preset(gfp, 1, enforce);\n                    return preset;\n                case Lame.V0:\n                    apply_vbr_preset(gfp, 0, enforce);\n                    return preset;\n                default:\n                    break;\n            }\n        }\n        if (8 <= preset && preset <= 320) {\n            return apply_abr_preset(gfp, preset, enforce);\n        }\n\n        /* no corresponding preset found */\n        gfp.preset = 0;\n        return preset;\n    }\n\n    // Rest from getset.c:\n\n    /**\n     * VBR quality level.<BR>\n     * 0 = highest<BR>\n     * 9 = lowest\n     */\n    function lame_set_VBR_q(gfp, VBR_q) {\n        var ret = 0;\n\n        if (0 > VBR_q) {\n            /* Unknown VBR quality level! */\n            ret = -1;\n            VBR_q = 0;\n        }\n        if (9 < VBR_q) {\n            ret = -1;\n            VBR_q = 9;\n        }\n\n        gfp.VBR_q = VBR_q;\n        gfp.VBR_q_frac = 0;\n        return ret;\n    }\n\n}\n\n/*\n *      bit reservoir source file\n *\n *      Copyright (c) 1999-2000 Mark Taylor\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n\n/* $Id: Reservoir.java,v 1.9 2011/05/24 20:48:06 kenchis Exp $ */\n\n//package mp3;\n\n/**\n * ResvFrameBegin:<BR>\n * Called (repeatedly) at the beginning of a frame. Updates the maximum size of\n * the reservoir, and checks to make sure main_data_begin was set properly by\n * the formatter<BR>\n * Background information:\n * \n * This is the original text from the ISO standard. Because of sooo many bugs\n * and irritations correcting comments are added in brackets []. A '^W' means\n * you should remove the last word.\n * \n * <PRE>\n *  1. The following rule can be used to calculate the maximum\n *     number of bits used for one granule [^W frame]:<BR>\n *     At the highest possible bitrate of Layer III (320 kbps\n *     per stereo signal [^W^W^W], 48 kHz) the frames must be of\n *     [^W^W^W are designed to have] constant length, i.e.\n *     one buffer [^W^W the frame] length is:<BR>\n * \n *         320 kbps * 1152/48 kHz = 7680 bit = 960 byte\n * \n *     This value is used as the maximum buffer per channel [^W^W] at\n *     lower bitrates [than 320 kbps]. At 64 kbps mono or 128 kbps\n *     stereo the main granule length is 64 kbps * 576/48 kHz = 768 bit\n *     [per granule and channel] at 48 kHz sampling frequency.\n *     This means that there is a maximum deviation (short time buffer\n *     [= reservoir]) of 7680 - 2*2*768 = 4608 bits is allowed at 64 kbps.\n *     The actual deviation is equal to the number of bytes [with the\n *     meaning of octets] denoted by the main_data_end offset pointer.\n *     The actual maximum deviation is (2^9-1)*8 bit = 4088 bits\n *     [for MPEG-1 and (2^8-1)*8 bit for MPEG-2, both are hard limits].\n *     ... The xchange of buffer bits between the left and right channel\n *     is allowed without restrictions [exception: dual channel].\n *     Because of the [constructed] constraint on the buffer size\n *     main_data_end is always set to 0 in the case of bit_rate_index==14,\n *     i.e. data rate 320 kbps per stereo signal [^W^W^W]. In this case\n *     all data are allocated between adjacent header [^W sync] words\n *     [, i.e. there is no buffering at all].\n * </PRE>\n */\n\n\nfunction Reservoir() {\n\tvar bs;\n\n\tthis.setModules  = function(_bs) {\n\t\tbs = _bs;\n\t}\n\n\tthis.ResvFrameBegin = function(gfp, mean_bits) {\n\t\tvar gfc = gfp.internal_flags;\n\t\tvar maxmp3buf;\n\t\tvar l3_side = gfc.l3_side;\n\n\t\tvar frameLength = bs.getframebits(gfp);\n\t\tmean_bits.bits = (frameLength - gfc.sideinfo_len * 8) / gfc.mode_gr;\n\n\t\t/**\n\t\t * <PRE>\n\t\t *  Meaning of the variables:\n\t\t *      resvLimit: (0, 8, ..., 8*255 (MPEG-2), 8*511 (MPEG-1))\n\t\t *          Number of bits can be stored in previous frame(s) due to\n\t\t *          counter size constaints\n\t\t *      maxmp3buf: ( ??? ... 8*1951 (MPEG-1 and 2), 8*2047 (MPEG-2.5))\n\t\t *          Number of bits allowed to encode one frame (you can take 8*511 bit\n\t\t *          from the bit reservoir and at most 8*1440 bit from the current\n\t\t *          frame (320 kbps, 32 kHz), so 8*1951 bit is the largest possible\n\t\t *          value for MPEG-1 and -2)\n\t\t * \n\t\t *          maximum allowed granule/channel size times 4 = 8*2047 bits.,\n\t\t *          so this is the absolute maximum supported by the format.\n\t\t * \n\t\t * \n\t\t *      fullFrameBits:  maximum number of bits available for encoding\n\t\t *                      the current frame.\n\t\t * \n\t\t *      mean_bits:      target number of bits per granule.\n\t\t * \n\t\t *      frameLength:\n\t\t * \n\t\t *      gfc.ResvMax:   maximum allowed reservoir\n\t\t * \n\t\t *      gfc.ResvSize:  current reservoir size\n\t\t * \n\t\t *      l3_side.resvDrain_pre:\n\t\t *         ancillary data to be added to previous frame:\n\t\t *         (only usefull in VBR modes if it is possible to have\n\t\t *         maxmp3buf < fullFrameBits)).  Currently disabled,\n\t\t *         see #define NEW_DRAIN\n\t\t *         2010-02-13: RH now enabled, it seems to be needed for CBR too,\n\t\t *                     as there exists one example, where the FhG decoder\n\t\t *                     can't decode a -b320 CBR file anymore.\n\t\t * \n\t\t *      l3_side.resvDrain_post:\n\t\t *         ancillary data to be added to this frame:\n\t\t * \n\t\t * </PRE>\n\t\t */\n\n\t\t/* main_data_begin has 9 bits in MPEG-1, 8 bits MPEG-2 */\n\t\tvar resvLimit = (8 * 256) * gfc.mode_gr - 8;\n\n\t\t/*\n\t\t * maximum allowed frame size. dont use more than this number of bits,\n\t\t * even if the frame has the space for them:\n\t\t */\n\t\tif (gfp.brate > 320) {\n\t\t\t/* in freeformat the buffer is constant */\n\t\t\tmaxmp3buf = 8 * ((int) ((gfp.brate * 1000)\n\t\t\t\t\t/ (gfp.out_samplerate / 1152) / 8 + .5));\n\t\t} else {\n\t\t\t/*\n\t\t\t * all mp3 decoders should have enough buffer to handle this value:\n\t\t\t * size of a 320kbps 32kHz frame\n\t\t\t */\n\t\t\tmaxmp3buf = 8 * 1440;\n\n\t\t\t/*\n\t\t\t * Bouvigne suggests this more lax interpretation of the ISO doc\n\t\t\t * instead of using 8*960.\n\t\t\t */\n\n\t\t\tif (gfp.strict_ISO) {\n\t\t\t\tmaxmp3buf = 8 * ((int) (320000 / (gfp.out_samplerate / 1152) / 8 + .5));\n\t\t\t}\n\t\t}\n\n\t\tgfc.ResvMax = maxmp3buf - frameLength;\n\t\tif (gfc.ResvMax > resvLimit)\n\t\t\tgfc.ResvMax = resvLimit;\n\t\tif (gfc.ResvMax < 0 || gfp.disable_reservoir)\n\t\t\tgfc.ResvMax = 0;\n\n\t\tvar fullFrameBits = mean_bits.bits * gfc.mode_gr\n\t\t\t\t+ Math.min(gfc.ResvSize, gfc.ResvMax);\n\n\t\tif (fullFrameBits > maxmp3buf)\n\t\t\tfullFrameBits = maxmp3buf;\n\n\n\t\tl3_side.resvDrain_pre = 0;\n\n\t\t// frame analyzer code\n\t\tif (gfc.pinfo != null) {\n\t\t\t/*\n\t\t\t * expected bits per channel per granule [is this also right for\n\t\t\t * mono/stereo, MPEG-1/2 ?]\n\t\t\t */\n\t\t\tgfc.pinfo.mean_bits = mean_bits.bits / 2;\n\t\t\tgfc.pinfo.resvsize = gfc.ResvSize;\n\t\t}\n\n\t\treturn fullFrameBits;\n\t}\n\n\t/**\n\t * returns targ_bits: target number of bits to use for 1 granule<BR>\n\t * extra_bits: amount extra available from reservoir<BR>\n\t * Mark Taylor 4/99\n\t */\n\tthis.ResvMaxBits = function(gfp, mean_bits, targ_bits, cbr) {\n\t\tvar gfc = gfp.internal_flags;\n\t\tvar add_bits;\n        var ResvSize = gfc.ResvSize, ResvMax = gfc.ResvMax;\n\n\t\t/* compensate the saved bits used in the 1st granule */\n\t\tif (cbr != 0)\n\t\t\tResvSize += mean_bits;\n\n\t\tif ((gfc.substep_shaping & 1) != 0)\n\t\t\tResvMax *= 0.9;\n\n\t\ttarg_bits.bits = mean_bits;\n\n\t\t/* extra bits if the reservoir is almost full */\n\t\tif (ResvSize * 10 > ResvMax * 9) {\n\t\t\tadd_bits = ResvSize - (ResvMax * 9) / 10;\n\t\t\ttarg_bits.bits += add_bits;\n\t\t\tgfc.substep_shaping |= 0x80;\n\t\t} else {\n\t\t\tadd_bits = 0;\n\t\t\tgfc.substep_shaping &= 0x7f;\n\t\t\t/*\n\t\t\t * build up reservoir. this builds the reservoir a little slower\n\t\t\t * than FhG. It could simple be mean_bits/15, but this was rigged to\n\t\t\t * always produce 100 (the old value) at 128kbs\n\t\t\t */\n\t\t\tif (!gfp.disable_reservoir && 0 == (gfc.substep_shaping & 1))\n\t\t\t\ttarg_bits.bits -= .1 * mean_bits;\n\t\t}\n\n\t\t/* amount from the reservoir we are allowed to use. ISO says 6/10 */\n\t\tvar extra_bits = (ResvSize < (gfc.ResvMax * 6) / 10 ? ResvSize\n\t\t\t\t: (gfc.ResvMax * 6) / 10);\n\t\textra_bits -= add_bits;\n\n\t\tif (extra_bits < 0)\n\t\t\textra_bits = 0;\n\t\treturn extra_bits;\n\t}\n\n\t/**\n\t * Called after a granule's bit allocation. Readjusts the size of the\n\t * reservoir to reflect the granule's usage.\n\t */\n\tthis.ResvAdjust = function(gfc, gi) {\n\t\tgfc.ResvSize -= gi.part2_3_length + gi.part2_length;\n\t}\n\n\t/**\n\t * Called after all granules in a frame have been allocated. Makes sure that\n\t * the reservoir size is within limits, possibly by adding stuffing bits.\n\t */\n\tthis.ResvFrameEnd = function(gfc, mean_bits) {\n\t\tvar over_bits;\n\t\tvar l3_side = gfc.l3_side;\n\n\t\tgfc.ResvSize += mean_bits * gfc.mode_gr;\n\t\tvar stuffingBits = 0;\n\t\tl3_side.resvDrain_post = 0;\n\t\tl3_side.resvDrain_pre = 0;\n\n\t\t/* we must be byte aligned */\n\t\tif ((over_bits = gfc.ResvSize % 8) != 0)\n\t\t\tstuffingBits += over_bits;\n\n\t\tover_bits = (gfc.ResvSize - stuffingBits) - gfc.ResvMax;\n\t\tif (over_bits > 0) {\n\t\t\tstuffingBits += over_bits;\n\t\t}\n\n\t\t/*\n\t\t * NOTE: enabling the NEW_DRAIN code fixes some problems with FhG\n\t\t * decoder shipped with MS Windows operating systems. Using this, it is\n\t\t * even possible to use Gabriel's lax buffer consideration again, which\n\t\t * assumes, any decoder should have a buffer large enough for a 320 kbps\n\t\t * frame at 32 kHz sample rate.\n\t\t * \n\t\t * old drain code: lame -b320 BlackBird.wav --. does not play with\n\t\t * GraphEdit.exe using FhG decoder V1.5 Build 50\n\t\t * \n\t\t * new drain code: lame -b320 BlackBird.wav --. plays fine with\n\t\t * GraphEdit.exe using FhG decoder V1.5 Build 50\n\t\t * \n\t\t * Robert Hegemann, 2010-02-13.\n\t\t */\n\t\t/*\n\t\t * drain as many bits as possible into previous frame ancillary data In\n\t\t * particular, in VBR mode ResvMax may have changed, and we have to make\n\t\t * sure main_data_begin does not create a reservoir bigger than ResvMax\n\t\t * mt 4/00\n\t\t */\n\t\t{\n\t\t\tvar mdb_bytes = Math.min(l3_side.main_data_begin * 8, stuffingBits) / 8;\n\t\t\tl3_side.resvDrain_pre += 8 * mdb_bytes;\n\t\t\tstuffingBits -= 8 * mdb_bytes;\n\t\t\tgfc.ResvSize -= 8 * mdb_bytes;\n\t\t\tl3_side.main_data_begin -= mdb_bytes;\n\t\t}\n\t\t/* drain the rest into this frames ancillary data */\n\t\tl3_side.resvDrain_post += stuffingBits;\n\t\tgfc.ResvSize -= stuffingBits;\n\t}\n}\n\n\n/**\n * A Vbr header may be present in the ancillary data field of the first frame of\n * an mp3 bitstream<BR>\n * The Vbr header (optionally) contains\n * <UL>\n * <LI>frames total number of audio frames in the bitstream\n * <LI>bytes total number of bytes in the bitstream\n * <LI>toc table of contents\n * </UL>\n *\n * toc (table of contents) gives seek points for random access.<BR>\n * The ith entry determines the seek point for i-percent duration.<BR>\n * seek point in bytes = (toc[i]/256.0) * total_bitstream_bytes<BR>\n * e.g. half duration seek point = (toc[50]/256.0) * total_bitstream_bytes\n */\nVBRTag.NUMTOCENTRIES = 100;\nVBRTag.MAXFRAMESIZE = 2880;\n\nfunction VBRTag() {\n\n    var lame;\n    var bs;\n    var v;\n\n    this.setModules = function (_lame, _bs, _v) {\n        lame = _lame;\n        bs = _bs;\n        v = _v;\n    };\n\t\n\t//fix 精简\n\t\n    /**\n     * Lookup table for fast CRC-16 computation. Uses the polynomial\n     * x^16+x^15+x^2+1\n     */\n    var crc16Lookup = [0x0000, 0xC0C1, 0xC181, 0x0140,\n        0xC301, 0x03C0, 0x0280, 0xC241, 0xC601, 0x06C0, 0x0780, 0xC741,\n        0x0500, 0xC5C1, 0xC481, 0x0440, 0xCC01, 0x0CC0, 0x0D80, 0xCD41,\n        0x0F00, 0xCFC1, 0xCE81, 0x0E40, 0x0A00, 0xCAC1, 0xCB81, 0x0B40,\n        0xC901, 0x09C0, 0x0880, 0xC841, 0xD801, 0x18C0, 0x1980, 0xD941,\n        0x1B00, 0xDBC1, 0xDA81, 0x1A40, 0x1E00, 0xDEC1, 0xDF81, 0x1F40,\n        0xDD01, 0x1DC0, 0x1C80, 0xDC41, 0x1400, 0xD4C1, 0xD581, 0x1540,\n        0xD701, 0x17C0, 0x1680, 0xD641, 0xD201, 0x12C0, 0x1380, 0xD341,\n        0x1100, 0xD1C1, 0xD081, 0x1040, 0xF001, 0x30C0, 0x3180, 0xF141,\n        0x3300, 0xF3C1, 0xF281, 0x3240, 0x3600, 0xF6C1, 0xF781, 0x3740,\n        0xF501, 0x35C0, 0x3480, 0xF441, 0x3C00, 0xFCC1, 0xFD81, 0x3D40,\n        0xFF01, 0x3FC0, 0x3E80, 0xFE41, 0xFA01, 0x3AC0, 0x3B80, 0xFB41,\n        0x3900, 0xF9C1, 0xF881, 0x3840, 0x2800, 0xE8C1, 0xE981, 0x2940,\n        0xEB01, 0x2BC0, 0x2A80, 0xEA41, 0xEE01, 0x2EC0, 0x2F80, 0xEF41,\n        0x2D00, 0xEDC1, 0xEC81, 0x2C40, 0xE401, 0x24C0, 0x2580, 0xE541,\n        0x2700, 0xE7C1, 0xE681, 0x2640, 0x2200, 0xE2C1, 0xE381, 0x2340,\n        0xE101, 0x21C0, 0x2080, 0xE041, 0xA001, 0x60C0, 0x6180, 0xA141,\n        0x6300, 0xA3C1, 0xA281, 0x6240, 0x6600, 0xA6C1, 0xA781, 0x6740,\n        0xA501, 0x65C0, 0x6480, 0xA441, 0x6C00, 0xACC1, 0xAD81, 0x6D40,\n        0xAF01, 0x6FC0, 0x6E80, 0xAE41, 0xAA01, 0x6AC0, 0x6B80, 0xAB41,\n        0x6900, 0xA9C1, 0xA881, 0x6840, 0x7800, 0xB8C1, 0xB981, 0x7940,\n        0xBB01, 0x7BC0, 0x7A80, 0xBA41, 0xBE01, 0x7EC0, 0x7F80, 0xBF41,\n        0x7D00, 0xBDC1, 0xBC81, 0x7C40, 0xB401, 0x74C0, 0x7580, 0xB541,\n        0x7700, 0xB7C1, 0xB681, 0x7640, 0x7200, 0xB2C1, 0xB381, 0x7340,\n        0xB101, 0x71C0, 0x7080, 0xB041, 0x5000, 0x90C1, 0x9181, 0x5140,\n        0x9301, 0x53C0, 0x5280, 0x9241, 0x9601, 0x56C0, 0x5780, 0x9741,\n        0x5500, 0x95C1, 0x9481, 0x5440, 0x9C01, 0x5CC0, 0x5D80, 0x9D41,\n        0x5F00, 0x9FC1, 0x9E81, 0x5E40, 0x5A00, 0x9AC1, 0x9B81, 0x5B40,\n        0x9901, 0x59C0, 0x5880, 0x9841, 0x8801, 0x48C0, 0x4980, 0x8941,\n        0x4B00, 0x8BC1, 0x8A81, 0x4A40, 0x4E00, 0x8EC1, 0x8F81, 0x4F40,\n        0x8D01, 0x4DC0, 0x4C80, 0x8C41, 0x4400, 0x84C1, 0x8581, 0x4540,\n        0x8701, 0x47C0, 0x4680, 0x8641, 0x8201, 0x42C0, 0x4380, 0x8341,\n        0x4100, 0x81C1, 0x8081, 0x4040];\n\t\t\n\t//fix 精简\n\t\n    /**\n     * Fast CRC-16 computation (uses table crc16Lookup).\n     *\n     * @param value\n     * @param crc\n     * @return\n     */\n    function crcUpdateLookup(value, crc) {\n        var tmp = crc ^ value;\n        crc = (crc >> 8) ^ crc16Lookup[tmp & 0xff];\n        return crc;\n    }\n\n    this.updateMusicCRC = function (crc, buffer, bufferPos, size) {\n        for (var i = 0; i < size; ++i)\n            crc[0] = crcUpdateLookup(buffer[bufferPos + i], crc[0]);\n    }\n\n\t//fix 精简\n}\n\n\n\nBitStream.EQ = function (a, b) {\n    return (Math.abs(a) > Math.abs(b)) ? (Math.abs((a) - (b)) <= (Math\n        .abs(a) * 1e-6))\n        : (Math.abs((a) - (b)) <= (Math.abs(b) * 1e-6));\n};\n\nBitStream.NEQ = function (a, b) {\n    return !BitStream.EQ(a, b);\n};\n\nfunction BitStream() {\n    var self = this;\n    var CRC16_POLYNOMIAL = 0x8005;\n\n    /*\n     * we work with ints, so when doing bit manipulation, we limit ourselves to\n     * MAX_LENGTH-2 just to be on the safe side\n     */\n    var MAX_LENGTH = 32;\n\n    //GainAnalysis ga;\n    //MPGLib mpg;\n    //Version ver;\n    //VBRTag vbr;\n    var ga = null;\n    var mpg = null;\n    var ver = null;\n    var vbr = null;\n\n    //public final void setModules(GainAnalysis ga, MPGLib mpg, Version ver,\n    //\tVBRTag vbr) {\n\n    this.setModules = function (_ga, _mpg, _ver, _vbr) {\n        ga = _ga;\n        mpg = _mpg;\n        ver = _ver;\n        vbr = _vbr;\n    };\n\n    /**\n     * Bit stream buffer.\n     */\n    //private byte[] buf;\n    var buf = null;\n    /**\n     * Bit counter of bit stream.\n     */\n    var totbit = 0;\n    /**\n     * Pointer to top byte in buffer.\n     */\n    var bufByteIdx = 0;\n    /**\n     * Pointer to top bit of top byte in buffer.\n     */\n    var bufBitIdx = 0;\n\n    /**\n     * compute bitsperframe and mean_bits for a layer III frame\n     */\n    this.getframebits = function (gfp) {\n        var gfc = gfp.internal_flags;\n        var bit_rate;\n\n        /* get bitrate in kbps [?] */\n        if (gfc.bitrate_index != 0)\n            bit_rate = Tables.bitrate_table[gfp.version][gfc.bitrate_index];\n        else\n            bit_rate = gfp.brate;\n\n        /* main encoding routine toggles padding on and off */\n        /* one Layer3 Slot consists of 8 bits */\n        var bytes = 0 | (gfp.version + 1) * 72000 * bit_rate / gfp.out_samplerate + gfc.padding;\n        return 8 * bytes;\n    };\n\n    function putheader_bits(gfc) {\n        System.arraycopy(gfc.header[gfc.w_ptr].buf, 0, buf, bufByteIdx, gfc.sideinfo_len);\n        bufByteIdx += gfc.sideinfo_len;\n        totbit += gfc.sideinfo_len * 8;\n        gfc.w_ptr = (gfc.w_ptr + 1) & (LameInternalFlags.MAX_HEADER_BUF - 1);\n    }\n\n    /**\n     * write j bits into the bit stream\n     */\n    function putbits2(gfc, val, j) {\n\n\n        while (j > 0) {\n            var k;\n            if (bufBitIdx == 0) {\n                bufBitIdx = 8;\n                bufByteIdx++;\n                if (gfc.header[gfc.w_ptr].write_timing == totbit) {\n                    putheader_bits(gfc);\n                }\n                buf[bufByteIdx] = 0;\n            }\n\n            k = Math.min(j, bufBitIdx);\n            j -= k;\n\n            bufBitIdx -= k;\n\n            /* 32 too large on 32 bit machines */\n\n            buf[bufByteIdx] |= ((val >> j) << bufBitIdx);\n            totbit += k;\n        }\n    }\n\n    /**\n     * write j bits into the bit stream, ignoring frame headers\n     */\n    function putbits_noheaders(gfc, val, j) {\n\n        while (j > 0) {\n            var k;\n            if (bufBitIdx == 0) {\n                bufBitIdx = 8;\n                bufByteIdx++;\n                buf[bufByteIdx] = 0;\n            }\n\n            k = Math.min(j, bufBitIdx);\n            j -= k;\n\n            bufBitIdx -= k;\n\n            /* 32 too large on 32 bit machines */\n\n            buf[bufByteIdx] |= ((val >> j) << bufBitIdx);\n            totbit += k;\n        }\n    }\n\n    /**\n     * Some combinations of bitrate, Fs, and stereo make it impossible to stuff\n     * out a frame using just main_data, due to the limited number of bits to\n     * indicate main_data_length. In these situations, we put stuffing bits into\n     * the ancillary data...\n     */\n    function drain_into_ancillary(gfp, remainingBits) {\n        var gfc = gfp.internal_flags;\n        var i;\n\n        if (remainingBits >= 8) {\n            putbits2(gfc, 0x4c, 8);\n            remainingBits -= 8;\n        }\n        if (remainingBits >= 8) {\n            putbits2(gfc, 0x41, 8);\n            remainingBits -= 8;\n        }\n        if (remainingBits >= 8) {\n            putbits2(gfc, 0x4d, 8);\n            remainingBits -= 8;\n        }\n        if (remainingBits >= 8) {\n            putbits2(gfc, 0x45, 8);\n            remainingBits -= 8;\n        }\n\n        if (remainingBits >= 32) {\n            var version = ver.getLameShortVersion();\n            if (remainingBits >= 32)\n                for (i = 0; i < version.length && remainingBits >= 8; ++i) {\n                    remainingBits -= 8;\n                    putbits2(gfc, version.charCodeAt(i), 8); //fix 错误的使用charAt\n                }\n        }\n\n        for (; remainingBits >= 1; remainingBits -= 1) {\n            putbits2(gfc, gfc.ancillary_flag, 1);\n            gfc.ancillary_flag ^= (!gfp.disable_reservoir ? 1 : 0);\n        }\n\n\n    }\n\n    /**\n     * write N bits into the header\n     */\n    function writeheader(gfc, val, j) {\n        var ptr = gfc.header[gfc.h_ptr].ptr;\n\n        while (j > 0) {\n            var k = Math.min(j, 8 - (ptr & 7));\n            j -= k;\n            /* >> 32 too large for 32 bit machines */\n\n            gfc.header[gfc.h_ptr].buf[ptr >> 3] |= ((val >> j)) << (8 - (ptr & 7) - k);\n            ptr += k;\n        }\n        gfc.header[gfc.h_ptr].ptr = ptr;\n    }\n\n    function CRC_update(value, crc) {\n        value <<= 8;\n        for (var i = 0; i < 8; i++) {\n            value <<= 1;\n            crc <<= 1;\n\n            if ((((crc ^ value) & 0x10000) != 0))\n                crc ^= CRC16_POLYNOMIAL;\n        }\n        return crc;\n    }\n\n    this.CRC_writeheader = function (gfc, header) {\n        var crc = 0xffff;\n        /* (jo) init crc16 for error_protection */\n\n        crc = CRC_update(header[2] & 0xff, crc);\n        crc = CRC_update(header[3] & 0xff, crc);\n        for (var i = 6; i < gfc.sideinfo_len; i++) {\n            crc = CRC_update(header[i] & 0xff, crc);\n        }\n\n        header[4] = (byte)(crc >> 8);\n        header[5] = (byte)(crc & 255);\n    };\n\n    function encodeSideInfo2(gfp, bitsPerFrame) {\n        var gfc = gfp.internal_flags;\n        var l3_side;\n        var gr, ch;\n\n        l3_side = gfc.l3_side;\n        gfc.header[gfc.h_ptr].ptr = 0;\n        Arrays.fill(gfc.header[gfc.h_ptr].buf, 0, gfc.sideinfo_len, 0);\n        if (gfp.out_samplerate < 16000)\n            writeheader(gfc, 0xffe, 12);\n        else\n            writeheader(gfc, 0xfff, 12);\n        writeheader(gfc, (gfp.version), 1);\n        writeheader(gfc, 4 - 3, 2);\n        writeheader(gfc, (!gfp.error_protection ? 1 : 0), 1);\n        writeheader(gfc, (gfc.bitrate_index), 4);\n        writeheader(gfc, (gfc.samplerate_index), 2);\n        writeheader(gfc, (gfc.padding), 1);\n        writeheader(gfc, (gfp.extension), 1);\n        writeheader(gfc, (gfp.mode.ordinal()), 2);\n        writeheader(gfc, (gfc.mode_ext), 2);\n        writeheader(gfc, (gfp.copyright), 1);\n        writeheader(gfc, (gfp.original), 1);\n        writeheader(gfc, (gfp.emphasis), 2);\n        if (gfp.error_protection) {\n            writeheader(gfc, 0, 16);\n            /* dummy */\n        }\n\n        if (gfp.version == 1) {\n            /* MPEG1 */\n            writeheader(gfc, (l3_side.main_data_begin), 9);\n\n            if (gfc.channels_out == 2)\n                writeheader(gfc, l3_side.private_bits, 3);\n            else\n                writeheader(gfc, l3_side.private_bits, 5);\n\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                var band;\n                for (band = 0; band < 4; band++) {\n                    writeheader(gfc, l3_side.scfsi[ch][band], 1);\n                }\n            }\n\n            for (gr = 0; gr < 2; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    var gi = l3_side.tt[gr][ch];\n                    writeheader(gfc, gi.part2_3_length + gi.part2_length, 12);\n                    writeheader(gfc, gi.big_values / 2, 9);\n                    writeheader(gfc, gi.global_gain, 8);\n                    writeheader(gfc, gi.scalefac_compress, 4);\n\n                    if (gi.block_type != Encoder.NORM_TYPE) {\n                        writeheader(gfc, 1, 1);\n                        /* window_switching_flag */\n                        writeheader(gfc, gi.block_type, 2);\n                        writeheader(gfc, gi.mixed_block_flag, 1);\n\n                        if (gi.table_select[0] == 14)\n                            gi.table_select[0] = 16;\n                        writeheader(gfc, gi.table_select[0], 5);\n                        if (gi.table_select[1] == 14)\n                            gi.table_select[1] = 16;\n                        writeheader(gfc, gi.table_select[1], 5);\n\n                        writeheader(gfc, gi.subblock_gain[0], 3);\n                        writeheader(gfc, gi.subblock_gain[1], 3);\n                        writeheader(gfc, gi.subblock_gain[2], 3);\n                    } else {\n                        writeheader(gfc, 0, 1);\n                        /* window_switching_flag */\n                        if (gi.table_select[0] == 14)\n                            gi.table_select[0] = 16;\n                        writeheader(gfc, gi.table_select[0], 5);\n                        if (gi.table_select[1] == 14)\n                            gi.table_select[1] = 16;\n                        writeheader(gfc, gi.table_select[1], 5);\n                        if (gi.table_select[2] == 14)\n                            gi.table_select[2] = 16;\n                        writeheader(gfc, gi.table_select[2], 5);\n\n                        writeheader(gfc, gi.region0_count, 4);\n                        writeheader(gfc, gi.region1_count, 3);\n                    }\n                    writeheader(gfc, gi.preflag, 1);\n                    writeheader(gfc, gi.scalefac_scale, 1);\n                    writeheader(gfc, gi.count1table_select, 1);\n                }\n            }\n        } else {\n            /* MPEG2 */\n            writeheader(gfc, (l3_side.main_data_begin), 8);\n            writeheader(gfc, l3_side.private_bits, gfc.channels_out);\n\n            gr = 0;\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                var gi = l3_side.tt[gr][ch];\n                writeheader(gfc, gi.part2_3_length + gi.part2_length, 12);\n                writeheader(gfc, gi.big_values / 2, 9);\n                writeheader(gfc, gi.global_gain, 8);\n                writeheader(gfc, gi.scalefac_compress, 9);\n\n                if (gi.block_type != Encoder.NORM_TYPE) {\n                    writeheader(gfc, 1, 1);\n                    /* window_switching_flag */\n                    writeheader(gfc, gi.block_type, 2);\n                    writeheader(gfc, gi.mixed_block_flag, 1);\n\n                    if (gi.table_select[0] == 14)\n                        gi.table_select[0] = 16;\n                    writeheader(gfc, gi.table_select[0], 5);\n                    if (gi.table_select[1] == 14)\n                        gi.table_select[1] = 16;\n                    writeheader(gfc, gi.table_select[1], 5);\n\n                    writeheader(gfc, gi.subblock_gain[0], 3);\n                    writeheader(gfc, gi.subblock_gain[1], 3);\n                    writeheader(gfc, gi.subblock_gain[2], 3);\n                } else {\n                    writeheader(gfc, 0, 1);\n                    /* window_switching_flag */\n                    if (gi.table_select[0] == 14)\n                        gi.table_select[0] = 16;\n                    writeheader(gfc, gi.table_select[0], 5);\n                    if (gi.table_select[1] == 14)\n                        gi.table_select[1] = 16;\n                    writeheader(gfc, gi.table_select[1], 5);\n                    if (gi.table_select[2] == 14)\n                        gi.table_select[2] = 16;\n                    writeheader(gfc, gi.table_select[2], 5);\n\n                    writeheader(gfc, gi.region0_count, 4);\n                    writeheader(gfc, gi.region1_count, 3);\n                }\n\n                writeheader(gfc, gi.scalefac_scale, 1);\n                writeheader(gfc, gi.count1table_select, 1);\n            }\n        }\n\n        if (gfp.error_protection) {\n            /* (jo) error_protection: add crc16 information to header */\n            CRC_writeheader(gfc, gfc.header[gfc.h_ptr].buf);\n        }\n\n        {\n            var old = gfc.h_ptr;\n\n            gfc.h_ptr = (old + 1) & (LameInternalFlags.MAX_HEADER_BUF - 1);\n            gfc.header[gfc.h_ptr].write_timing = gfc.header[old].write_timing\n                + bitsPerFrame;\n\n            if (gfc.h_ptr == gfc.w_ptr) {\n                /* yikes! we are out of header buffer space */\n                System.err\n                    .println(\"Error: MAX_HEADER_BUF too small in bitstream.c \\n\");\n            }\n\n        }\n    }\n\n    function huffman_coder_count1(gfc, gi) {\n        /* Write count1 area */\n        var h = Tables.ht[gi.count1table_select + 32];\n        var i, bits = 0;\n\n        var ix = gi.big_values;\n        var xr = gi.big_values;\n\n        for (i = (gi.count1 - gi.big_values) / 4; i > 0; --i) {\n            var huffbits = 0;\n            var p = 0, v;\n\n            v = gi.l3_enc[ix + 0];\n            if (v != 0) {\n                p += 8;\n                if (gi.xr[xr + 0] < 0)\n                    huffbits++;\n            }\n\n            v = gi.l3_enc[ix + 1];\n            if (v != 0) {\n                p += 4;\n                huffbits *= 2;\n                if (gi.xr[xr + 1] < 0)\n                    huffbits++;\n            }\n\n            v = gi.l3_enc[ix + 2];\n            if (v != 0) {\n                p += 2;\n                huffbits *= 2;\n                if (gi.xr[xr + 2] < 0)\n                    huffbits++;\n            }\n\n            v = gi.l3_enc[ix + 3];\n            if (v != 0) {\n                p++;\n                huffbits *= 2;\n                if (gi.xr[xr + 3] < 0)\n                    huffbits++;\n            }\n\n            ix += 4;\n            xr += 4;\n            putbits2(gfc, huffbits + h.table[p], h.hlen[p]);\n            bits += h.hlen[p];\n        }\n        return bits;\n    }\n\n    /**\n     * Implements the pseudocode of page 98 of the IS\n     */\n    function Huffmancode(gfc, tableindex, start, end, gi) {\n        var h = Tables.ht[tableindex];\n        var bits = 0;\n\n        if (0 == tableindex)\n            return bits;\n\n        for (var i = start; i < end; i += 2) {\n            var cbits = 0;\n            var xbits = 0;\n            var linbits = h.xlen;\n            var xlen = h.xlen;\n            var ext = 0;\n            var x1 = gi.l3_enc[i];\n            var x2 = gi.l3_enc[i + 1];\n\n            if (x1 != 0) {\n                if (gi.xr[i] < 0)\n                    ext++;\n                cbits--;\n            }\n\n            if (tableindex > 15) {\n                /* use ESC-words */\n                if (x1 > 14) {\n                    var linbits_x1 = x1 - 15;\n                    ext |= linbits_x1 << 1;\n                    xbits = linbits;\n                    x1 = 15;\n                }\n\n                if (x2 > 14) {\n                    var linbits_x2 = x2 - 15;\n                    ext <<= linbits;\n                    ext |= linbits_x2;\n                    xbits += linbits;\n                    x2 = 15;\n                }\n                xlen = 16;\n            }\n\n            if (x2 != 0) {\n                ext <<= 1;\n                if (gi.xr[i + 1] < 0)\n                    ext++;\n                cbits--;\n            }\n\n\n            x1 = x1 * xlen + x2;\n            xbits -= cbits;\n            cbits += h.hlen[x1];\n\n\n            putbits2(gfc, h.table[x1], cbits);\n            putbits2(gfc, ext, xbits);\n            bits += cbits + xbits;\n        }\n        return bits;\n    }\n\n    /**\n     * Note the discussion of huffmancodebits() on pages 28 and 29 of the IS, as\n     * well as the definitions of the side information on pages 26 and 27.\n     */\n    function ShortHuffmancodebits(gfc, gi) {\n        var region1Start = 3 * gfc.scalefac_band.s[3];\n        if (region1Start > gi.big_values)\n            region1Start = gi.big_values;\n\n        /* short blocks do not have a region2 */\n        var bits = Huffmancode(gfc, gi.table_select[0], 0, region1Start, gi);\n        bits += Huffmancode(gfc, gi.table_select[1], region1Start,\n            gi.big_values, gi);\n        return bits;\n    }\n\n    function LongHuffmancodebits(gfc, gi) {\n        var bigvalues, bits;\n        var region1Start, region2Start;\n\n        bigvalues = gi.big_values;\n\n        var i = gi.region0_count + 1;\n        region1Start = gfc.scalefac_band.l[i];\n        i += gi.region1_count + 1;\n        region2Start = gfc.scalefac_band.l[i];\n\n        if (region1Start > bigvalues)\n            region1Start = bigvalues;\n\n        if (region2Start > bigvalues)\n            region2Start = bigvalues;\n\n        bits = Huffmancode(gfc, gi.table_select[0], 0, region1Start, gi);\n        bits += Huffmancode(gfc, gi.table_select[1], region1Start,\n            region2Start, gi);\n        bits += Huffmancode(gfc, gi.table_select[2], region2Start, bigvalues,\n            gi);\n        return bits;\n    }\n\n    function writeMainData(gfp) {\n        var gr, ch, sfb, data_bits, tot_bits = 0;\n        var gfc = gfp.internal_flags;\n        var l3_side = gfc.l3_side;\n\n        if (gfp.version == 1) {\n            /* MPEG 1 */\n            for (gr = 0; gr < 2; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    var gi = l3_side.tt[gr][ch];\n                    var slen1 = Takehiro.slen1_tab[gi.scalefac_compress];\n                    var slen2 = Takehiro.slen2_tab[gi.scalefac_compress];\n                    data_bits = 0;\n                    for (sfb = 0; sfb < gi.sfbdivide; sfb++) {\n                        if (gi.scalefac[sfb] == -1)\n                            continue;\n                        /* scfsi is used */\n                        putbits2(gfc, gi.scalefac[sfb], slen1);\n                        data_bits += slen1;\n                    }\n                    for (; sfb < gi.sfbmax; sfb++) {\n                        if (gi.scalefac[sfb] == -1)\n                            continue;\n                        /* scfsi is used */\n                        putbits2(gfc, gi.scalefac[sfb], slen2);\n                        data_bits += slen2;\n                    }\n\n                    if (gi.block_type == Encoder.SHORT_TYPE) {\n                        data_bits += ShortHuffmancodebits(gfc, gi);\n                    } else {\n                        data_bits += LongHuffmancodebits(gfc, gi);\n                    }\n                    data_bits += huffman_coder_count1(gfc, gi);\n                    /* does bitcount in quantize.c agree with actual bit count? */\n                    tot_bits += data_bits;\n                }\n                /* for ch */\n            }\n            /* for gr */\n        } else {\n            /* MPEG 2 */\n            gr = 0;\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                var gi = l3_side.tt[gr][ch];\n                var i, sfb_partition, scale_bits = 0;\n                data_bits = 0;\n                sfb = 0;\n                sfb_partition = 0;\n\n                if (gi.block_type == Encoder.SHORT_TYPE) {\n                    for (; sfb_partition < 4; sfb_partition++) {\n                        var sfbs = gi.sfb_partition_table[sfb_partition] / 3;\n                        var slen = gi.slen[sfb_partition];\n                        for (i = 0; i < sfbs; i++, sfb++) {\n                            putbits2(gfc,\n                                Math.max(gi.scalefac[sfb * 3 + 0], 0), slen);\n                            putbits2(gfc,\n                                Math.max(gi.scalefac[sfb * 3 + 1], 0), slen);\n                            putbits2(gfc,\n                                Math.max(gi.scalefac[sfb * 3 + 2], 0), slen);\n                            scale_bits += 3 * slen;\n                        }\n                    }\n                    data_bits += ShortHuffmancodebits(gfc, gi);\n                } else {\n                    for (; sfb_partition < 4; sfb_partition++) {\n                        var sfbs = gi.sfb_partition_table[sfb_partition];\n                        var slen = gi.slen[sfb_partition];\n                        for (i = 0; i < sfbs; i++, sfb++) {\n                            putbits2(gfc, Math.max(gi.scalefac[sfb], 0), slen);\n                            scale_bits += slen;\n                        }\n                    }\n                    data_bits += LongHuffmancodebits(gfc, gi);\n                }\n                data_bits += huffman_coder_count1(gfc, gi);\n                /* does bitcount in quantize.c agree with actual bit count? */\n                tot_bits += scale_bits + data_bits;\n            }\n            /* for ch */\n        }\n        /* for gf */\n        return tot_bits;\n    }\n\n    /* main_data */\n\n    function TotalBytes() {\n        this.total = 0;\n    }\n\n    /*\n     * compute the number of bits required to flush all mp3 frames currently in\n     * the buffer. This should be the same as the reservoir size. Only call this\n     * routine between frames - i.e. only after all headers and data have been\n     * added to the buffer by format_bitstream().\n     *\n     * Also compute total_bits_output = size of mp3 buffer (including frame\n     * headers which may not have yet been send to the mp3 buffer) + number of\n     * bits needed to flush all mp3 frames.\n     *\n     * total_bytes_output is the size of the mp3 output buffer if\n     * lame_encode_flush_nogap() was called right now.\n     */\n    function compute_flushbits(gfp, total_bytes_output) {\n        var gfc = gfp.internal_flags;\n        var flushbits, remaining_headers;\n        var bitsPerFrame;\n        var last_ptr, first_ptr;\n        first_ptr = gfc.w_ptr;\n        /* first header to add to bitstream */\n        last_ptr = gfc.h_ptr - 1;\n        /* last header to add to bitstream */\n        if (last_ptr == -1)\n            last_ptr = LameInternalFlags.MAX_HEADER_BUF - 1;\n\n        /* add this many bits to bitstream so we can flush all headers */\n        flushbits = gfc.header[last_ptr].write_timing - totbit;\n        total_bytes_output.total = flushbits;\n\n        if (flushbits >= 0) {\n            /* if flushbits >= 0, some headers have not yet been written */\n            /* reduce flushbits by the size of the headers */\n            remaining_headers = 1 + last_ptr - first_ptr;\n            if (last_ptr < first_ptr)\n                remaining_headers = 1 + last_ptr - first_ptr\n                    + LameInternalFlags.MAX_HEADER_BUF;\n            flushbits -= remaining_headers * 8 * gfc.sideinfo_len;\n        }\n\n        /*\n         * finally, add some bits so that the last frame is complete these bits\n         * are not necessary to decode the last frame, but some decoders will\n         * ignore last frame if these bits are missing\n         */\n        bitsPerFrame = self.getframebits(gfp);\n        flushbits += bitsPerFrame;\n        total_bytes_output.total += bitsPerFrame;\n        /* round up: */\n        if ((total_bytes_output.total % 8) != 0)\n            total_bytes_output.total = 1 + (total_bytes_output.total / 8);\n        else\n            total_bytes_output.total = (total_bytes_output.total / 8);\n        total_bytes_output.total += bufByteIdx + 1;\n\n        if (flushbits < 0) {\n            System.err.println(\"strange error flushing buffer ... \\n\");\n        }\n        return flushbits;\n    }\n\n    this.flush_bitstream = function (gfp) {\n        var gfc = gfp.internal_flags;\n        var l3_side;\n        var flushbits;\n        var last_ptr = gfc.h_ptr - 1;\n        /* last header to add to bitstream */\n        if (last_ptr == -1)\n            last_ptr = LameInternalFlags.MAX_HEADER_BUF - 1;\n        l3_side = gfc.l3_side;\n\n        if ((flushbits = compute_flushbits(gfp, new TotalBytes())) < 0)\n            return;\n        drain_into_ancillary(gfp, flushbits);\n\n        /* check that the 100% of the last frame has been written to bitstream */\n\n        /*\n         * we have padded out all frames with ancillary data, which is the same\n         * as filling the bitreservoir with ancillary data, so :\n         */\n        gfc.ResvSize = 0;\n        l3_side.main_data_begin = 0;\n\n        /* save the ReplayGain value */\n        if (gfc.findReplayGain) {\n            var RadioGain = ga.GetTitleGain(gfc.rgdata);\n            gfc.RadioGain = Math.floor(RadioGain * 10.0 + 0.5) | 0;\n            /* round to nearest */\n        }\n\n        /* find the gain and scale change required for no clipping */\n        if (gfc.findPeakSample) {\n            gfc.noclipGainChange = Math.ceil(\n                        Math_log10(gfc.PeakSample / 32767.0) * 20.0 * 10.0) | 0;\n            /* round up */\n\n            if (gfc.noclipGainChange > 0) {\n                /* clipping occurs */\n                if (EQ(gfp.scale, 1.0) || EQ(gfp.scale, 0.0))\n                    gfc.noclipScale = (Math\n                        .floor((32767.0 / gfc.PeakSample) * 100.0) / 100.0);\n                /* round down */\n                else {\n                    /*\n                     * the user specified his own scaling factor. We could\n                     * suggest the scaling factor of\n                     * (32767.0/gfp.PeakSample)*(gfp.scale) but it's usually\n                     * very inaccurate. So we'd rather not advice him on the\n                     * scaling factor.\n                     */\n                    gfc.noclipScale = -1;\n                }\n            } else\n            /* no clipping */\n                gfc.noclipScale = -1;\n        }\n    };\n\n    this.add_dummy_byte = function (gfp, val, n) {\n        var gfc = gfp.internal_flags;\n        var i;\n\n        while (n-- > 0) {\n            putbits_noheaders(gfc, val, 8);\n\n            for (i = 0; i < LameInternalFlags.MAX_HEADER_BUF; ++i)\n                gfc.header[i].write_timing += 8;\n        }\n    };\n\n    /**\n     * This is called after a frame of audio has been quantized and coded. It\n     * will write the encoded audio to the bitstream. Note that from a layer3\n     * encoder's perspective the bit stream is primarily a series of main_data()\n     * blocks, with header and side information inserted at the proper locations\n     * to maintain framing. (See Figure A.7 in the IS).\n     */\n    this.format_bitstream = function (gfp) {\n        var gfc = gfp.internal_flags;\n        var l3_side;\n        l3_side = gfc.l3_side;\n\n        var bitsPerFrame = this.getframebits(gfp);\n        drain_into_ancillary(gfp, l3_side.resvDrain_pre);\n\n        encodeSideInfo2(gfp, bitsPerFrame);\n        var bits = 8 * gfc.sideinfo_len;\n        bits += writeMainData(gfp);\n        drain_into_ancillary(gfp, l3_side.resvDrain_post);\n        bits += l3_side.resvDrain_post;\n\n        l3_side.main_data_begin += (bitsPerFrame - bits) / 8;\n\n        /*\n         * compare number of bits needed to clear all buffered mp3 frames with\n         * what we think the resvsize is:\n         */\n        if (compute_flushbits(gfp, new TotalBytes()) != gfc.ResvSize) {\n            System.err.println(\"Internal buffer inconsistency. flushbits <> ResvSize\");\n        }\n\n        /*\n         * compare main_data_begin for the next frame with what we think the\n         * resvsize is:\n         */\n        if ((l3_side.main_data_begin * 8) != gfc.ResvSize) {\n            System.err.printf(\"bit reservoir error: \\n\"\n                + \"l3_side.main_data_begin: %d \\n\"\n                + \"Resvoir size:             %d \\n\"\n                + \"resv drain (post)         %d \\n\"\n                + \"resv drain (pre)          %d \\n\"\n                + \"header and sideinfo:      %d \\n\"\n                + \"data bits:                %d \\n\"\n                + \"total bits:               %d (remainder: %d) \\n\"\n                + \"bitsperframe:             %d \\n\",\n                8 * l3_side.main_data_begin, gfc.ResvSize,\n                l3_side.resvDrain_post, l3_side.resvDrain_pre,\n                8 * gfc.sideinfo_len, bits - l3_side.resvDrain_post - 8\n                * gfc.sideinfo_len, bits, bits % 8, bitsPerFrame);\n\n            System.err.println(\"This is a fatal error.  It has several possible causes:\");\n            System.err.println(\"90%%  LAME compiled with buggy version of gcc using advanced optimizations\");\n            System.err.println(\" 9%%  Your system is overclocked\");\n            System.err.println(\" 1%%  bug in LAME encoding library\");\n\n            gfc.ResvSize = l3_side.main_data_begin * 8;\n        }\n        //;\n\n        if (totbit > 1000000000) {\n            /*\n             * to avoid totbit overflow, (at 8h encoding at 128kbs) lets reset\n             * bit counter\n             */\n            var i;\n            for (i = 0; i < LameInternalFlags.MAX_HEADER_BUF; ++i)\n                gfc.header[i].write_timing -= totbit;\n            totbit = 0;\n        }\n\n        return 0;\n    };\n\n    /**\n     * <PRE>\n     * copy data out of the internal MP3 bit buffer into a user supplied\n     *       unsigned char buffer.\n     *\n     *       mp3data=0      indicates data in buffer is an id3tags and VBR tags\n     *       mp3data=1      data is real mp3 frame data.\n     * </PRE>\n     */\n    this.copy_buffer = function (gfc, buffer, bufferPos, size, mp3data) {\n        var minimum = bufByteIdx + 1;\n        if (minimum <= 0)\n            return 0;\n        if (size != 0 && minimum > size) {\n            /* buffer is too small */\n            return -1;\n        }\n        System.arraycopy(buf, 0, buffer, bufferPos, minimum);\n        bufByteIdx = -1;\n        bufBitIdx = 0;\n\n        if (mp3data != 0) {\n            var crc = new_int(1);\n            crc[0] = gfc.nMusicCRC;\n            vbr.updateMusicCRC(crc, buffer, bufferPos, minimum);\n            gfc.nMusicCRC = crc[0];\n\n            /**\n             * sum number of bytes belonging to the mp3 stream this info will be\n             * written into the Xing/LAME header for seeking\n             */\n            if (minimum > 0) {\n                gfc.VBR_seek_table.nBytesWritten += minimum;\n            }\n\n            if (gfc.decode_on_the_fly) { /* decode the frame */\n                var pcm_buf = new_float_n([2, 1152]);\n                var mp3_in = minimum;\n                var samples_out = -1;\n                var i;\n\n                /* re-synthesis to pcm. Repeat until we get a samples_out=0 */\n                while (samples_out != 0) {\n\n                    samples_out = mpg.hip_decode1_unclipped(gfc.hip, buffer,\n                        bufferPos, mp3_in, pcm_buf[0], pcm_buf[1]);\n                    /*\n                     * samples_out = 0: need more data to decode samples_out =\n                     * -1: error. Lets assume 0 pcm output samples_out = number\n                     * of samples output\n                     */\n\n                    /*\n                     * set the lenght of the mp3 input buffer to zero, so that\n                     * in the next iteration of the loop we will be querying\n                     * mpglib about buffered data\n                     */\n                    mp3_in = 0;\n\n                    if (samples_out == -1) {\n                        /*\n                         * error decoding. Not fatal, but might screw up the\n                         * ReplayGain tag. What should we do? Ignore for now\n                         */\n                        samples_out = 0;\n                    }\n                    if (samples_out > 0) {\n                        /* process the PCM data */\n\n                        /*\n                         * this should not be possible, and indicates we have\n                         * overflown the pcm_buf buffer\n                         */\n\n                        if (gfc.findPeakSample) {\n                            for (i = 0; i < samples_out; i++) {\n                                if (pcm_buf[0][i] > gfc.PeakSample)\n                                    gfc.PeakSample = pcm_buf[0][i];\n                                else if (-pcm_buf[0][i] > gfc.PeakSample)\n                                    gfc.PeakSample = -pcm_buf[0][i];\n                            }\n                            if (gfc.channels_out > 1)\n                                for (i = 0; i < samples_out; i++) {\n                                    if (pcm_buf[1][i] > gfc.PeakSample)\n                                        gfc.PeakSample = pcm_buf[1][i];\n                                    else if (-pcm_buf[1][i] > gfc.PeakSample)\n                                        gfc.PeakSample = -pcm_buf[1][i];\n                                }\n                        }\n\n                        if (gfc.findReplayGain)\n                            if (ga.AnalyzeSamples(gfc.rgdata, pcm_buf[0], 0,\n                                    pcm_buf[1], 0, samples_out,\n                                    gfc.channels_out) == GainAnalysis.GAIN_ANALYSIS_ERROR)\n                                return -6;\n\n                    }\n                    /* if (samples_out>0) */\n                }\n                /* while (samples_out!=0) */\n            }\n            /* if (gfc.decode_on_the_fly) */\n\n        }\n        /* if (mp3data) */\n        return minimum;\n    };\n\n    this.init_bit_stream_w = function (gfc) {\n        buf = new_byte(Lame.LAME_MAXMP3BUFFER);\n\n        gfc.h_ptr = gfc.w_ptr = 0;\n        gfc.header[gfc.h_ptr].write_timing = 0;\n        bufByteIdx = -1;\n        bufBitIdx = 0;\n        totbit = 0;\n    };\n\n    // From machine.h\n\n\n}\n\nfunction HuffCodeTab(len, max, tab, hl) {\n    this.xlen = len;\n    this.linmax = max;\n    this.table = tab;\n    this.hlen = hl;\n}\n\nvar Tables = {};\n\n\nTables.t1HB = [\n    1, 1,\n    1, 0\n];\n\nTables.t2HB = [\n    1, 2, 1,\n    3, 1, 1,\n    3, 2, 0\n];\n\nTables.t3HB = [\n    3, 2, 1,\n    1, 1, 1,\n    3, 2, 0\n];\n\nTables.t5HB = [\n    1, 2, 6, 5,\n    3, 1, 4, 4,\n    7, 5, 7, 1,\n    6, 1, 1, 0\n];\n\nTables.t6HB = [\n    7, 3, 5, 1,\n    6, 2, 3, 2,\n    5, 4, 4, 1,\n    3, 3, 2, 0\n];\n\nTables.t7HB = [\n    1, 2, 10, 19, 16, 10,\n    3, 3, 7, 10, 5, 3,\n    11, 4, 13, 17, 8, 4,\n    12, 11, 18, 15, 11, 2,\n    7, 6, 9, 14, 3, 1,\n    6, 4, 5, 3, 2, 0\n];\n\nTables.t8HB = [\n    3, 4, 6, 18, 12, 5,\n    5, 1, 2, 16, 9, 3,\n    7, 3, 5, 14, 7, 3,\n    19, 17, 15, 13, 10, 4,\n    13, 5, 8, 11, 5, 1,\n    12, 4, 4, 1, 1, 0\n];\n\nTables.t9HB = [\n    7, 5, 9, 14, 15, 7,\n    6, 4, 5, 5, 6, 7,\n    7, 6, 8, 8, 8, 5,\n    15, 6, 9, 10, 5, 1,\n    11, 7, 9, 6, 4, 1,\n    14, 4, 6, 2, 6, 0\n];\n\nTables.t10HB = [\n    1, 2, 10, 23, 35, 30, 12, 17,\n    3, 3, 8, 12, 18, 21, 12, 7,\n    11, 9, 15, 21, 32, 40, 19, 6,\n    14, 13, 22, 34, 46, 23, 18, 7,\n    20, 19, 33, 47, 27, 22, 9, 3,\n    31, 22, 41, 26, 21, 20, 5, 3,\n    14, 13, 10, 11, 16, 6, 5, 1,\n    9, 8, 7, 8, 4, 4, 2, 0\n];\n\nTables.t11HB = [\n    3, 4, 10, 24, 34, 33, 21, 15,\n    5, 3, 4, 10, 32, 17, 11, 10,\n    11, 7, 13, 18, 30, 31, 20, 5,\n    25, 11, 19, 59, 27, 18, 12, 5,\n    35, 33, 31, 58, 30, 16, 7, 5,\n    28, 26, 32, 19, 17, 15, 8, 14,\n    14, 12, 9, 13, 14, 9, 4, 1,\n    11, 4, 6, 6, 6, 3, 2, 0\n];\n\nTables.t12HB = [\n    9, 6, 16, 33, 41, 39, 38, 26,\n    7, 5, 6, 9, 23, 16, 26, 11,\n    17, 7, 11, 14, 21, 30, 10, 7,\n    17, 10, 15, 12, 18, 28, 14, 5,\n    32, 13, 22, 19, 18, 16, 9, 5,\n    40, 17, 31, 29, 17, 13, 4, 2,\n    27, 12, 11, 15, 10, 7, 4, 1,\n    27, 12, 8, 12, 6, 3, 1, 0\n];\n\nTables.t13HB = [\n    1, 5, 14, 21, 34, 51, 46, 71, 42, 52, 68, 52, 67, 44, 43, 19,\n    3, 4, 12, 19, 31, 26, 44, 33, 31, 24, 32, 24, 31, 35, 22, 14,\n    15, 13, 23, 36, 59, 49, 77, 65, 29, 40, 30, 40, 27, 33, 42, 16,\n    22, 20, 37, 61, 56, 79, 73, 64, 43, 76, 56, 37, 26, 31, 25, 14,\n    35, 16, 60, 57, 97, 75, 114, 91, 54, 73, 55, 41, 48, 53, 23, 24,\n    58, 27, 50, 96, 76, 70, 93, 84, 77, 58, 79, 29, 74, 49, 41, 17,\n    47, 45, 78, 74, 115, 94, 90, 79, 69, 83, 71, 50, 59, 38, 36, 15,\n    72, 34, 56, 95, 92, 85, 91, 90, 86, 73, 77, 65, 51, 44, 43, 42,\n    43, 20, 30, 44, 55, 78, 72, 87, 78, 61, 46, 54, 37, 30, 20, 16,\n    53, 25, 41, 37, 44, 59, 54, 81, 66, 76, 57, 54, 37, 18, 39, 11,\n    35, 33, 31, 57, 42, 82, 72, 80, 47, 58, 55, 21, 22, 26, 38, 22,\n    53, 25, 23, 38, 70, 60, 51, 36, 55, 26, 34, 23, 27, 14, 9, 7,\n    34, 32, 28, 39, 49, 75, 30, 52, 48, 40, 52, 28, 18, 17, 9, 5,\n    45, 21, 34, 64, 56, 50, 49, 45, 31, 19, 12, 15, 10, 7, 6, 3,\n    48, 23, 20, 39, 36, 35, 53, 21, 16, 23, 13, 10, 6, 1, 4, 2,\n    16, 15, 17, 27, 25, 20, 29, 11, 17, 12, 16, 8, 1, 1, 0, 1\n];\n\nTables.t15HB = [\n    7, 12, 18, 53, 47, 76, 124, 108, 89, 123, 108, 119, 107, 81, 122, 63,\n    13, 5, 16, 27, 46, 36, 61, 51, 42, 70, 52, 83, 65, 41, 59, 36,\n    19, 17, 15, 24, 41, 34, 59, 48, 40, 64, 50, 78, 62, 80, 56, 33,\n    29, 28, 25, 43, 39, 63, 55, 93, 76, 59, 93, 72, 54, 75, 50, 29,\n    52, 22, 42, 40, 67, 57, 95, 79, 72, 57, 89, 69, 49, 66, 46, 27,\n    77, 37, 35, 66, 58, 52, 91, 74, 62, 48, 79, 63, 90, 62, 40, 38,\n    125, 32, 60, 56, 50, 92, 78, 65, 55, 87, 71, 51, 73, 51, 70, 30,\n    109, 53, 49, 94, 88, 75, 66, 122, 91, 73, 56, 42, 64, 44, 21, 25,\n    90, 43, 41, 77, 73, 63, 56, 92, 77, 66, 47, 67, 48, 53, 36, 20,\n    71, 34, 67, 60, 58, 49, 88, 76, 67, 106, 71, 54, 38, 39, 23, 15,\n    109, 53, 51, 47, 90, 82, 58, 57, 48, 72, 57, 41, 23, 27, 62, 9,\n    86, 42, 40, 37, 70, 64, 52, 43, 70, 55, 42, 25, 29, 18, 11, 11,\n    118, 68, 30, 55, 50, 46, 74, 65, 49, 39, 24, 16, 22, 13, 14, 7,\n    91, 44, 39, 38, 34, 63, 52, 45, 31, 52, 28, 19, 14, 8, 9, 3,\n    123, 60, 58, 53, 47, 43, 32, 22, 37, 24, 17, 12, 15, 10, 2, 1,\n    71, 37, 34, 30, 28, 20, 17, 26, 21, 16, 10, 6, 8, 6, 2, 0\n];\n\nTables.t16HB = [\n    1, 5, 14, 44, 74, 63, 110, 93, 172, 149, 138, 242, 225, 195, 376, 17,\n    3, 4, 12, 20, 35, 62, 53, 47, 83, 75, 68, 119, 201, 107, 207, 9,\n    15, 13, 23, 38, 67, 58, 103, 90, 161, 72, 127, 117, 110, 209, 206, 16,\n    45, 21, 39, 69, 64, 114, 99, 87, 158, 140, 252, 212, 199, 387, 365, 26,\n    75, 36, 68, 65, 115, 101, 179, 164, 155, 264, 246, 226, 395, 382, 362, 9,\n    66, 30, 59, 56, 102, 185, 173, 265, 142, 253, 232, 400, 388, 378, 445, 16,\n    111, 54, 52, 100, 184, 178, 160, 133, 257, 244, 228, 217, 385, 366, 715, 10,\n    98, 48, 91, 88, 165, 157, 148, 261, 248, 407, 397, 372, 380, 889, 884, 8,\n    85, 84, 81, 159, 156, 143, 260, 249, 427, 401, 392, 383, 727, 713, 708, 7,\n    154, 76, 73, 141, 131, 256, 245, 426, 406, 394, 384, 735, 359, 710, 352, 11,\n    139, 129, 67, 125, 247, 233, 229, 219, 393, 743, 737, 720, 885, 882, 439, 4,\n    243, 120, 118, 115, 227, 223, 396, 746, 742, 736, 721, 712, 706, 223, 436, 6,\n    202, 224, 222, 218, 216, 389, 386, 381, 364, 888, 443, 707, 440, 437, 1728, 4,\n    747, 211, 210, 208, 370, 379, 734, 723, 714, 1735, 883, 877, 876, 3459, 865, 2,\n    377, 369, 102, 187, 726, 722, 358, 711, 709, 866, 1734, 871, 3458, 870, 434, 0,\n    12, 10, 7, 11, 10, 17, 11, 9, 13, 12, 10, 7, 5, 3, 1, 3\n];\n\nTables.t24HB = [\n    15, 13, 46, 80, 146, 262, 248, 434, 426, 669, 653, 649, 621, 517, 1032, 88,\n    14, 12, 21, 38, 71, 130, 122, 216, 209, 198, 327, 345, 319, 297, 279, 42,\n    47, 22, 41, 74, 68, 128, 120, 221, 207, 194, 182, 340, 315, 295, 541, 18,\n    81, 39, 75, 70, 134, 125, 116, 220, 204, 190, 178, 325, 311, 293, 271, 16,\n    147, 72, 69, 135, 127, 118, 112, 210, 200, 188, 352, 323, 306, 285, 540, 14,\n    263, 66, 129, 126, 119, 114, 214, 202, 192, 180, 341, 317, 301, 281, 262, 12,\n    249, 123, 121, 117, 113, 215, 206, 195, 185, 347, 330, 308, 291, 272, 520, 10,\n    435, 115, 111, 109, 211, 203, 196, 187, 353, 332, 313, 298, 283, 531, 381, 17,\n    427, 212, 208, 205, 201, 193, 186, 177, 169, 320, 303, 286, 268, 514, 377, 16,\n    335, 199, 197, 191, 189, 181, 174, 333, 321, 305, 289, 275, 521, 379, 371, 11,\n    668, 184, 183, 179, 175, 344, 331, 314, 304, 290, 277, 530, 383, 373, 366, 10,\n    652, 346, 171, 168, 164, 318, 309, 299, 287, 276, 263, 513, 375, 368, 362, 6,\n    648, 322, 316, 312, 307, 302, 292, 284, 269, 261, 512, 376, 370, 364, 359, 4,\n    620, 300, 296, 294, 288, 282, 273, 266, 515, 380, 374, 369, 365, 361, 357, 2,\n    1033, 280, 278, 274, 267, 264, 259, 382, 378, 372, 367, 363, 360, 358, 356, 0,\n    43, 20, 19, 17, 15, 13, 11, 9, 7, 6, 4, 7, 5, 3, 1, 3\n];\n\nTables.t32HB = [\n    1 << 0, 5 << 1, 4 << 1, 5 << 2, 6 << 1, 5 << 2, 4 << 2, 4 << 3,\n    7 << 1, 3 << 2, 6 << 2, 0 << 3, 7 << 2, 2 << 3, 3 << 3, 1 << 4\n];\n\nTables.t33HB = [\n    15 << 0, 14 << 1, 13 << 1, 12 << 2, 11 << 1, 10 << 2, 9 << 2, 8 << 3,\n    7 << 1, 6 << 2, 5 << 2, 4 << 3, 3 << 2, 2 << 3, 1 << 3, 0 << 4\n];\n\nTables.t1l = [\n    1, 4,\n    3, 5\n];\n\nTables.t2l = [\n    1, 4, 7,\n    4, 5, 7,\n    6, 7, 8\n];\n\nTables.t3l = [\n    2, 3, 7,\n    4, 4, 7,\n    6, 7, 8\n];\n\nTables.t5l = [\n    1, 4, 7, 8,\n    4, 5, 8, 9,\n    7, 8, 9, 10,\n    8, 8, 9, 10\n];\n\nTables.t6l = [\n    3, 4, 6, 8,\n    4, 4, 6, 7,\n    5, 6, 7, 8,\n    7, 7, 8, 9\n];\n\nTables.t7l = [\n    1, 4, 7, 9, 9, 10,\n    4, 6, 8, 9, 9, 10,\n    7, 7, 9, 10, 10, 11,\n    8, 9, 10, 11, 11, 11,\n    8, 9, 10, 11, 11, 12,\n    9, 10, 11, 12, 12, 12\n];\n\nTables.t8l = [\n    2, 4, 7, 9, 9, 10,\n    4, 4, 6, 10, 10, 10,\n    7, 6, 8, 10, 10, 11,\n    9, 10, 10, 11, 11, 12,\n    9, 9, 10, 11, 12, 12,\n    10, 10, 11, 11, 13, 13\n];\n\nTables.t9l = [\n    3, 4, 6, 7, 9, 10,\n    4, 5, 6, 7, 8, 10,\n    5, 6, 7, 8, 9, 10,\n    7, 7, 8, 9, 9, 10,\n    8, 8, 9, 9, 10, 11,\n    9, 9, 10, 10, 11, 11\n];\n\nTables.t10l = [\n    1, 4, 7, 9, 10, 10, 10, 11,\n    4, 6, 8, 9, 10, 11, 10, 10,\n    7, 8, 9, 10, 11, 12, 11, 11,\n    8, 9, 10, 11, 12, 12, 11, 12,\n    9, 10, 11, 12, 12, 12, 12, 12,\n    10, 11, 12, 12, 13, 13, 12, 13,\n    9, 10, 11, 12, 12, 12, 13, 13,\n    10, 10, 11, 12, 12, 13, 13, 13\n];\n\nTables.t11l = [\n    2, 4, 6, 8, 9, 10, 9, 10,\n    4, 5, 6, 8, 10, 10, 9, 10,\n    6, 7, 8, 9, 10, 11, 10, 10,\n    8, 8, 9, 11, 10, 12, 10, 11,\n    9, 10, 10, 11, 11, 12, 11, 12,\n    9, 10, 11, 12, 12, 13, 12, 13,\n    9, 9, 9, 10, 11, 12, 12, 12,\n    9, 9, 10, 11, 12, 12, 12, 12\n];\n\nTables.t12l = [\n    4, 4, 6, 8, 9, 10, 10, 10,\n    4, 5, 6, 7, 9, 9, 10, 10,\n    6, 6, 7, 8, 9, 10, 9, 10,\n    7, 7, 8, 8, 9, 10, 10, 10,\n    8, 8, 9, 9, 10, 10, 10, 11,\n    9, 9, 10, 10, 10, 11, 10, 11,\n    9, 9, 9, 10, 10, 11, 11, 12,\n    10, 10, 10, 11, 11, 11, 11, 12\n];\n\nTables.t13l = [\n    1, 5, 7, 8, 9, 10, 10, 11, 10, 11, 12, 12, 13, 13, 14, 14,\n    4, 6, 8, 9, 10, 10, 11, 11, 11, 11, 12, 12, 13, 14, 14, 14,\n    7, 8, 9, 10, 11, 11, 12, 12, 11, 12, 12, 13, 13, 14, 15, 15,\n    8, 9, 10, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 14, 15, 15,\n    9, 9, 11, 11, 12, 12, 13, 13, 12, 13, 13, 14, 14, 15, 15, 16,\n    10, 10, 11, 12, 12, 12, 13, 13, 13, 13, 14, 13, 15, 15, 16, 16,\n    10, 11, 12, 12, 13, 13, 13, 13, 13, 14, 14, 14, 15, 15, 16, 16,\n    11, 11, 12, 13, 13, 13, 14, 14, 14, 14, 15, 15, 15, 16, 18, 18,\n    10, 10, 11, 12, 12, 13, 13, 14, 14, 14, 14, 15, 15, 16, 17, 17,\n    11, 11, 12, 12, 13, 13, 13, 15, 14, 15, 15, 16, 16, 16, 18, 17,\n    11, 12, 12, 13, 13, 14, 14, 15, 14, 15, 16, 15, 16, 17, 18, 19,\n    12, 12, 12, 13, 14, 14, 14, 14, 15, 15, 15, 16, 17, 17, 17, 18,\n    12, 13, 13, 14, 14, 15, 14, 15, 16, 16, 17, 17, 17, 18, 18, 18,\n    13, 13, 14, 15, 15, 15, 16, 16, 16, 16, 16, 17, 18, 17, 18, 18,\n    14, 14, 14, 15, 15, 15, 17, 16, 16, 19, 17, 17, 17, 19, 18, 18,\n    13, 14, 15, 16, 16, 16, 17, 16, 17, 17, 18, 18, 21, 20, 21, 18\n];\n\nTables.t15l = [\n    3, 5, 6, 8, 8, 9, 10, 10, 10, 11, 11, 12, 12, 12, 13, 14,\n    5, 5, 7, 8, 9, 9, 10, 10, 10, 11, 11, 12, 12, 12, 13, 13,\n    6, 7, 7, 8, 9, 9, 10, 10, 10, 11, 11, 12, 12, 13, 13, 13,\n    7, 8, 8, 9, 9, 10, 10, 11, 11, 11, 12, 12, 12, 13, 13, 13,\n    8, 8, 9, 9, 10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 13, 13,\n    9, 9, 9, 10, 10, 10, 11, 11, 11, 11, 12, 12, 13, 13, 13, 14,\n    10, 9, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 13, 14, 14,\n    10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 13, 13, 14,\n    10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 13, 13, 14, 14, 14,\n    10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 13, 13, 13, 14, 14, 14,\n    11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 13, 13, 13, 14, 15, 14,\n    11, 11, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 14, 14, 14, 15,\n    12, 12, 11, 12, 12, 12, 13, 13, 13, 13, 13, 13, 14, 14, 15, 15,\n    12, 12, 12, 12, 12, 13, 13, 13, 13, 14, 14, 14, 14, 14, 15, 15,\n    13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 15, 15, 14, 15,\n    13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 15, 15, 15, 15\n];\n\nTables.t16_5l = [\n    1, 5, 7, 9, 10, 10, 11, 11, 12, 12, 12, 13, 13, 13, 14, 11,\n    4, 6, 8, 9, 10, 11, 11, 11, 12, 12, 12, 13, 14, 13, 14, 11,\n    7, 8, 9, 10, 11, 11, 12, 12, 13, 12, 13, 13, 13, 14, 14, 12,\n    9, 9, 10, 11, 11, 12, 12, 12, 13, 13, 14, 14, 14, 15, 15, 13,\n    10, 10, 11, 11, 12, 12, 13, 13, 13, 14, 14, 14, 15, 15, 15, 12,\n    10, 10, 11, 11, 12, 13, 13, 14, 13, 14, 14, 15, 15, 15, 16, 13,\n    11, 11, 11, 12, 13, 13, 13, 13, 14, 14, 14, 14, 15, 15, 16, 13,\n    11, 11, 12, 12, 13, 13, 13, 14, 14, 15, 15, 15, 15, 17, 17, 13,\n    11, 12, 12, 13, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 13,\n    12, 12, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 15, 16, 15, 14,\n    12, 13, 12, 13, 14, 14, 14, 14, 15, 16, 16, 16, 17, 17, 16, 13,\n    13, 13, 13, 13, 14, 14, 15, 16, 16, 16, 16, 16, 16, 15, 16, 14,\n    13, 14, 14, 14, 14, 15, 15, 15, 15, 17, 16, 16, 16, 16, 18, 14,\n    15, 14, 14, 14, 15, 15, 16, 16, 16, 18, 17, 17, 17, 19, 17, 14,\n    14, 15, 13, 14, 16, 16, 15, 16, 16, 17, 18, 17, 19, 17, 16, 14,\n    11, 11, 11, 12, 12, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 12\n];\n\nTables.t16l = [\n    1, 5, 7, 9, 10, 10, 11, 11, 12, 12, 12, 13, 13, 13, 14, 10,\n    4, 6, 8, 9, 10, 11, 11, 11, 12, 12, 12, 13, 14, 13, 14, 10,\n    7, 8, 9, 10, 11, 11, 12, 12, 13, 12, 13, 13, 13, 14, 14, 11,\n    9, 9, 10, 11, 11, 12, 12, 12, 13, 13, 14, 14, 14, 15, 15, 12,\n    10, 10, 11, 11, 12, 12, 13, 13, 13, 14, 14, 14, 15, 15, 15, 11,\n    10, 10, 11, 11, 12, 13, 13, 14, 13, 14, 14, 15, 15, 15, 16, 12,\n    11, 11, 11, 12, 13, 13, 13, 13, 14, 14, 14, 14, 15, 15, 16, 12,\n    11, 11, 12, 12, 13, 13, 13, 14, 14, 15, 15, 15, 15, 17, 17, 12,\n    11, 12, 12, 13, 13, 13, 14, 14, 15, 15, 15, 15, 16, 16, 16, 12,\n    12, 12, 12, 13, 13, 14, 14, 15, 15, 15, 15, 16, 15, 16, 15, 13,\n    12, 13, 12, 13, 14, 14, 14, 14, 15, 16, 16, 16, 17, 17, 16, 12,\n    13, 13, 13, 13, 14, 14, 15, 16, 16, 16, 16, 16, 16, 15, 16, 13,\n    13, 14, 14, 14, 14, 15, 15, 15, 15, 17, 16, 16, 16, 16, 18, 13,\n    15, 14, 14, 14, 15, 15, 16, 16, 16, 18, 17, 17, 17, 19, 17, 13,\n    14, 15, 13, 14, 16, 16, 15, 16, 16, 17, 18, 17, 19, 17, 16, 13,\n    10, 10, 10, 11, 11, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 10\n];\n\nTables.t24l = [\n    4, 5, 7, 8, 9, 10, 10, 11, 11, 12, 12, 12, 12, 12, 13, 10,\n    5, 6, 7, 8, 9, 10, 10, 11, 11, 11, 12, 12, 12, 12, 12, 10,\n    7, 7, 8, 9, 9, 10, 10, 11, 11, 11, 11, 12, 12, 12, 13, 9,\n    8, 8, 9, 9, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 9,\n    9, 9, 9, 10, 10, 10, 10, 11, 11, 11, 12, 12, 12, 12, 13, 9,\n    10, 9, 10, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 9,\n    10, 10, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 9,\n    11, 10, 10, 10, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 13, 10,\n    11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 13, 13, 10,\n    11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 13, 13, 13, 10,\n    12, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 10,\n    12, 12, 11, 11, 11, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 10,\n    12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 10,\n    12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 10,\n    13, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 10,\n    9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 6\n];\n\nTables.t32l = [\n    1 + 0, 4 + 1, 4 + 1, 5 + 2, 4 + 1, 6 + 2, 5 + 2, 6 + 3,\n    4 + 1, 5 + 2, 5 + 2, 6 + 3, 5 + 2, 6 + 3, 6 + 3, 6 + 4\n];\n\nTables.t33l = [\n    4 + 0, 4 + 1, 4 + 1, 4 + 2, 4 + 1, 4 + 2, 4 + 2, 4 + 3,\n    4 + 1, 4 + 2, 4 + 2, 4 + 3, 4 + 2, 4 + 3, 4 + 3, 4 + 4\n];\n\nTables.ht = [\n    /* xlen, linmax, table, hlen */\n    new HuffCodeTab(0, 0, null, null),\n    new HuffCodeTab(2, 0, Tables.t1HB, Tables.t1l),\n    new HuffCodeTab(3, 0, Tables.t2HB, Tables.t2l),\n    new HuffCodeTab(3, 0, Tables.t3HB, Tables.t3l),\n    new HuffCodeTab(0, 0, null, null), /* Apparently not used */\n    new HuffCodeTab(4, 0, Tables.t5HB, Tables.t5l),\n    new HuffCodeTab(4, 0, Tables.t6HB, Tables.t6l),\n    new HuffCodeTab(6, 0, Tables.t7HB, Tables.t7l),\n    new HuffCodeTab(6, 0, Tables.t8HB, Tables.t8l),\n    new HuffCodeTab(6, 0, Tables.t9HB, Tables.t9l),\n    new HuffCodeTab(8, 0, Tables.t10HB, Tables.t10l),\n    new HuffCodeTab(8, 0, Tables.t11HB, Tables.t11l),\n    new HuffCodeTab(8, 0, Tables.t12HB, Tables.t12l),\n    new HuffCodeTab(16, 0, Tables.t13HB, Tables.t13l),\n    new HuffCodeTab(0, 0, null, Tables.t16_5l), /* Apparently not used */\n    new HuffCodeTab(16, 0, Tables.t15HB, Tables.t15l),\n\n    new HuffCodeTab(1, 1, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(2, 3, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(3, 7, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(4, 15, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(6, 63, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(8, 255, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(10, 1023, Tables.t16HB, Tables.t16l),\n    new HuffCodeTab(13, 8191, Tables.t16HB, Tables.t16l),\n\n    new HuffCodeTab(4, 15, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(5, 31, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(6, 63, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(7, 127, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(8, 255, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(9, 511, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(11, 2047, Tables.t24HB, Tables.t24l),\n    new HuffCodeTab(13, 8191, Tables.t24HB, Tables.t24l),\n\n    new HuffCodeTab(0, 0, Tables.t32HB, Tables.t32l),\n    new HuffCodeTab(0, 0, Tables.t33HB, Tables.t33l),\n];\n\n/**\n * <CODE>\n *  for (i = 0; i < 16*16; i++) [\n *      largetbl[i] = ((ht[16].hlen[i]) << 16) + ht[24].hlen[i];\n *  ]\n * </CODE>\n *\n */\nTables.largetbl = [\n    0x010004, 0x050005, 0x070007, 0x090008, 0x0a0009, 0x0a000a, 0x0b000a, 0x0b000b,\n    0x0c000b, 0x0c000c, 0x0c000c, 0x0d000c, 0x0d000c, 0x0d000c, 0x0e000d, 0x0a000a,\n    0x040005, 0x060006, 0x080007, 0x090008, 0x0a0009, 0x0b000a, 0x0b000a, 0x0b000b,\n    0x0c000b, 0x0c000b, 0x0c000c, 0x0d000c, 0x0e000c, 0x0d000c, 0x0e000c, 0x0a000a,\n    0x070007, 0x080007, 0x090008, 0x0a0009, 0x0b0009, 0x0b000a, 0x0c000a, 0x0c000b,\n    0x0d000b, 0x0c000b, 0x0d000b, 0x0d000c, 0x0d000c, 0x0e000c, 0x0e000d, 0x0b0009,\n    0x090008, 0x090008, 0x0a0009, 0x0b0009, 0x0b000a, 0x0c000a, 0x0c000a, 0x0c000b,\n    0x0d000b, 0x0d000b, 0x0e000b, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x0c0009,\n    0x0a0009, 0x0a0009, 0x0b0009, 0x0b000a, 0x0c000a, 0x0c000a, 0x0d000a, 0x0d000b,\n    0x0d000b, 0x0e000b, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x0f000d, 0x0b0009,\n    0x0a000a, 0x0a0009, 0x0b000a, 0x0b000a, 0x0c000a, 0x0d000a, 0x0d000b, 0x0e000b,\n    0x0d000b, 0x0e000b, 0x0e000c, 0x0f000c, 0x0f000c, 0x0f000c, 0x10000c, 0x0c0009,\n    0x0b000a, 0x0b000a, 0x0b000a, 0x0c000a, 0x0d000a, 0x0d000b, 0x0d000b, 0x0d000b,\n    0x0e000b, 0x0e000c, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x10000d, 0x0c0009,\n    0x0b000b, 0x0b000a, 0x0c000a, 0x0c000a, 0x0d000b, 0x0d000b, 0x0d000b, 0x0e000b,\n    0x0e000c, 0x0f000c, 0x0f000c, 0x0f000c, 0x0f000c, 0x11000d, 0x11000d, 0x0c000a,\n    0x0b000b, 0x0c000b, 0x0c000b, 0x0d000b, 0x0d000b, 0x0d000b, 0x0e000b, 0x0e000b,\n    0x0f000b, 0x0f000c, 0x0f000c, 0x0f000c, 0x10000c, 0x10000d, 0x10000d, 0x0c000a,\n    0x0c000b, 0x0c000b, 0x0c000b, 0x0d000b, 0x0d000b, 0x0e000b, 0x0e000b, 0x0f000c,\n    0x0f000c, 0x0f000c, 0x0f000c, 0x10000c, 0x0f000d, 0x10000d, 0x0f000d, 0x0d000a,\n    0x0c000c, 0x0d000b, 0x0c000b, 0x0d000b, 0x0e000b, 0x0e000c, 0x0e000c, 0x0e000c,\n    0x0f000c, 0x10000c, 0x10000c, 0x10000d, 0x11000d, 0x11000d, 0x10000d, 0x0c000a,\n    0x0d000c, 0x0d000c, 0x0d000b, 0x0d000b, 0x0e000b, 0x0e000c, 0x0f000c, 0x10000c,\n    0x10000c, 0x10000c, 0x10000c, 0x10000d, 0x10000d, 0x0f000d, 0x10000d, 0x0d000a,\n    0x0d000c, 0x0e000c, 0x0e000c, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x0f000c,\n    0x0f000c, 0x11000c, 0x10000d, 0x10000d, 0x10000d, 0x10000d, 0x12000d, 0x0d000a,\n    0x0f000c, 0x0e000c, 0x0e000c, 0x0e000c, 0x0f000c, 0x0f000c, 0x10000c, 0x10000c,\n    0x10000d, 0x12000d, 0x11000d, 0x11000d, 0x11000d, 0x13000d, 0x11000d, 0x0d000a,\n    0x0e000d, 0x0f000c, 0x0d000c, 0x0e000c, 0x10000c, 0x10000c, 0x0f000c, 0x10000d,\n    0x10000d, 0x11000d, 0x12000d, 0x11000d, 0x13000d, 0x11000d, 0x10000d, 0x0d000a,\n    0x0a0009, 0x0a0009, 0x0a0009, 0x0b0009, 0x0b0009, 0x0c0009, 0x0c0009, 0x0c0009,\n    0x0d0009, 0x0d0009, 0x0d0009, 0x0d000a, 0x0d000a, 0x0d000a, 0x0d000a, 0x0a0006\n];\n/**\n * <CODE>\n *  for (i = 0; i < 3*3; i++) [\n *      table23[i] = ((ht[2].hlen[i]) << 16) + ht[3].hlen[i];\n *  ]\n * </CODE>\n *\n */\nTables.table23 = [\n    0x010002, 0x040003, 0x070007,\n    0x040004, 0x050004, 0x070007,\n    0x060006, 0x070007, 0x080008\n];\n\n/**\n * <CODE>\n *  for (i = 0; i < 4*4; i++) [\n *       table56[i] = ((ht[5].hlen[i]) << 16) + ht[6].hlen[i];\n *   ]\n * </CODE>\n *\n */\nTables.table56 = [\n    0x010003, 0x040004, 0x070006, 0x080008, 0x040004, 0x050004, 0x080006, 0x090007,\n    0x070005, 0x080006, 0x090007, 0x0a0008, 0x080007, 0x080007, 0x090008, 0x0a0009\n];\n\nTables.bitrate_table = [\n    [0, 8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160, -1], /* MPEG 2 */\n    [0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320, -1], /* MPEG 1 */\n    [0, 8, 16, 24, 32, 40, 48, 56, 64, -1, -1, -1, -1, -1, -1, -1], /* MPEG 2.5 */\n];\n\n/**\n * MPEG 2, MPEG 1, MPEG 2.5.\n */\nTables.samplerate_table = [\n    [22050, 24000, 16000, -1],\n    [44100, 48000, 32000, -1],\n    [11025, 12000, 8000, -1],\n];\n\n/**\n * This is the scfsi_band table from 2.4.2.7 of the IS.\n */\nTables.scfsi_band = [0, 6, 11, 16, 21];\n\nfunction MeanBits(meanBits) {\n    this.bits = meanBits;\n}\n\n//package mp3;\n\nfunction CalcNoiseResult() {\n    /**\n     * sum of quantization noise > masking\n     */\n    this.over_noise = 0.;\n    /**\n     * sum of all quantization noise\n     */\n    this.tot_noise = 0.;\n    /**\n     * max quantization noise\n     */\n    this.max_noise = 0.;\n    /**\n     * number of quantization noise > masking\n     */\n    this.over_count = 0;\n    /**\n     * SSD-like cost of distorted bands\n     */\n    this.over_SSD = 0;\n    this.bits = 0;\n}\n\nfunction VBRQuantize() {\n    var qupvt;\n    var tak;\n\n    this.setModules = function (_qupvt, _tk) {\n        qupvt = _qupvt;\n        tak = _tk;\n    }\n    //TODO\n\n}\n\n\n\n/**\n * ATH related stuff, if something new ATH related has to be added, please plug\n * it here into the ATH.\n */\nfunction ATH() {\n    /**\n     * Method for the auto adjustment.\n     */\n    this.useAdjust = 0;\n    /**\n     * factor for tuning the (sample power) point below which adaptive threshold\n     * of hearing adjustment occurs\n     */\n    this.aaSensitivityP = 0.;\n    /**\n     * Lowering based on peak volume, 1 = no lowering.\n     */\n    this.adjust = 0.;\n    /**\n     * Limit for dynamic ATH adjust.\n     */\n    this.adjustLimit = 0.;\n    /**\n     * Determined to lower x dB each second.\n     */\n    this.decay = 0.;\n    /**\n     * Lowest ATH value.\n     */\n    this.floor = 0.;\n    /**\n     * ATH for sfbs in long blocks.\n     */\n    this.l = new_float(Encoder.SBMAX_l);\n    /**\n     * ATH for sfbs in short blocks.\n     */\n    this.s = new_float(Encoder.SBMAX_s);\n    /**\n     * ATH for partitioned sfb21 in long blocks.\n     */\n    this.psfb21 = new_float(Encoder.PSFB21);\n    /**\n     * ATH for partitioned sfb12 in short blocks.\n     */\n    this.psfb12 = new_float(Encoder.PSFB12);\n    /**\n     * ATH for long block convolution bands.\n     */\n    this.cb_l = new_float(Encoder.CBANDS);\n    /**\n     * ATH for short block convolution bands.\n     */\n    this.cb_s = new_float(Encoder.CBANDS);\n    /**\n     * Equal loudness weights (based on ATH).\n     */\n    this.eql_w = new_float(Encoder.BLKSIZE / 2);\n}\n\n\nfunction LameGlobalFlags() {\n\n    this.class_id = 0;\n\n    /* input description */\n\n    /**\n     * number of samples. default=-1\n     */\n    this.num_samples = 0;\n    /**\n     * input number of channels. default=2\n     */\n    this.num_channels = 0;\n    /**\n     * input_samp_rate in Hz. default=44.1 kHz\n     */\n    this.in_samplerate = 0;\n    /**\n     * output_samp_rate. default: LAME picks best value at least not used for\n     * MP3 decoding: Remember 44.1 kHz MP3s and AC97\n     */\n    this.out_samplerate = 0;\n    /**\n     * scale input by this amount before encoding at least not used for MP3\n     * decoding\n     */\n    this.scale = 0.;\n    /**\n     * scale input of channel 0 (left) by this amount before encoding\n     */\n    this.scale_left = 0.;\n    /**\n     * scale input of channel 1 (right) by this amount before encoding\n     */\n    this.scale_right = 0.;\n\n    /* general control params */\n    /**\n     * collect data for a MP3 frame analyzer?\n     */\n    this.analysis = false;\n    /**\n     * add Xing VBR tag?\n     */\n    this.bWriteVbrTag = false;\n\n    /**\n     * use lame/mpglib to convert mp3 to wav\n     */\n    this.decode_only = false;\n    /**\n     * quality setting 0=best, 9=worst default=5\n     */\n    this.quality = 0;\n    /**\n     * see enum default = LAME picks best value\n     */\n    this.mode = MPEGMode.STEREO;\n    /**\n     * force M/S mode. requires mode=1\n     */\n    this.force_ms = false;\n    /**\n     * use free format? default=0\n     */\n    this.free_format = false;\n    /**\n     * find the RG value? default=0\n     */\n    this.findReplayGain = false;\n    /**\n     * decode on the fly? default=0\n     */\n    this.decode_on_the_fly = false;\n    /**\n     * 1 (default) writes ID3 tags, 0 not\n     */\n    this.write_id3tag_automatic = false;\n\n    /*\n     * set either brate>0 or compression_ratio>0, LAME will compute the value of\n     * the variable not set. Default is compression_ratio = 11.025\n     */\n    /**\n     * bitrate\n     */\n    this.brate = 0;\n    /**\n     * sizeof(wav file)/sizeof(mp3 file)\n     */\n    this.compression_ratio = 0.;\n\n    /* frame params */\n    /**\n     * mark as copyright. default=0\n     */\n    this.copyright = 0;\n    /**\n     * mark as original. default=1\n     */\n    this.original = 0;\n    /**\n     * the MP3 'private extension' bit. Meaningless\n     */\n    this.extension = 0;\n    /**\n     * Input PCM is emphased PCM (for instance from one of the rarely emphased\n     * CDs), it is STRONGLY not recommended to use this, because psycho does not\n     * take it into account, and last but not least many decoders don't care\n     * about these bits\n     */\n    this.emphasis = 0;\n    /**\n     * use 2 bytes per frame for a CRC checksum. default=0\n     */\n    this.error_protection = 0;\n    /**\n     * enforce ISO spec as much as possible\n     */\n    this.strict_ISO = false;\n\n    /**\n     * use bit reservoir?\n     */\n    this.disable_reservoir = false;\n\n    /* quantization/noise shaping */\n    this.quant_comp = 0;\n    this.quant_comp_short = 0;\n    this.experimentalY = false;\n    this.experimentalZ = 0;\n    this.exp_nspsytune = 0;\n\n    this.preset = 0;\n\n    /* VBR control */\n    this.VBR = null;\n    /**\n     * Range [0,...,1[\n     */\n    this.VBR_q_frac = 0.;\n    /**\n     * Range [0,...,9]\n     */\n    this.VBR_q = 0;\n    this.VBR_mean_bitrate_kbps = 0;\n    this.VBR_min_bitrate_kbps = 0;\n    this.VBR_max_bitrate_kbps = 0;\n    /**\n     * strictly enforce VBR_min_bitrate normaly, it will be violated for analog\n     * silence\n     */\n    this.VBR_hard_min = 0;\n\n    /* resampling and filtering */\n\n    /**\n     * freq in Hz. 0=lame choses. -1=no filter\n     */\n    this.lowpassfreq = 0;\n    /**\n     * freq in Hz. 0=lame choses. -1=no filter\n     */\n    this.highpassfreq = 0;\n    /**\n     * freq width of filter, in Hz (default=15%)\n     */\n    this.lowpasswidth = 0;\n    /**\n     * freq width of filter, in Hz (default=15%)\n     */\n    this.highpasswidth = 0;\n\n    /*\n     * psycho acoustics and other arguments which you should not change unless\n     * you know what you are doing\n     */\n\n    this.maskingadjust = 0.;\n    this.maskingadjust_short = 0.;\n    /**\n     * only use ATH\n     */\n    this.ATHonly = false;\n    /**\n     * only use ATH for short blocks\n     */\n    this.ATHshort = false;\n    /**\n     * disable ATH\n     */\n    this.noATH = false;\n    /**\n     * select ATH formula\n     */\n    this.ATHtype = 0;\n    /**\n     * change ATH formula 4 shape\n     */\n    this.ATHcurve = 0.;\n    /**\n     * lower ATH by this many db\n     */\n    this.ATHlower = 0.;\n    /**\n     * select ATH auto-adjust scheme\n     */\n    this.athaa_type = 0;\n    /**\n     * select ATH auto-adjust loudness calc\n     */\n    this.athaa_loudapprox = 0;\n    /**\n     * dB, tune active region of auto-level\n     */\n    this.athaa_sensitivity = 0.;\n    this.short_blocks = null;\n    /**\n     * use temporal masking effect\n     */\n    this.useTemporal = false;\n    this.interChRatio = 0.;\n    /**\n     * Naoki's adjustment of Mid/Side maskings\n     */\n    this.msfix = 0.;\n\n    /**\n     * 0 off, 1 on\n     */\n    this.tune = false;\n    /**\n     * used to pass values for debugging and stuff\n     */\n    this.tune_value_a = 0.;\n\n    /************************************************************************/\n    /* internal variables, do not set... */\n    /* provided because they may be of use to calling application */\n    /************************************************************************/\n\n    /**\n     * 0=MPEG-2/2.5 1=MPEG-1\n     */\n    this.version = 0;\n    this.encoder_delay = 0;\n    /**\n     * number of samples of padding appended to input\n     */\n    this.encoder_padding = 0;\n    this.framesize = 0;\n    /**\n     * number of frames encoded\n     */\n    this.frameNum = 0;\n    /**\n     * is this struct owned by calling program or lame?\n     */\n    this.lame_allocated_gfp = 0;\n    /**************************************************************************/\n    /* more internal variables are stored in this structure: */\n    /**************************************************************************/\n    this.internal_flags = null;\n}\n\n\n\nfunction CBRNewIterationLoop(_quantize)  {\n    var quantize = _quantize;\n    this.quantize = quantize;\n\tthis.iteration_loop = function(gfp, pe, ms_ener_ratio, ratio) {\n\t\tvar gfc = gfp.internal_flags;\n        var l3_xmin = new_float(L3Side.SFBMAX);\n\t\tvar xrpow = new_float(576);\n\t\tvar targ_bits = new_int(2);\n\t\tvar mean_bits = 0, max_bits;\n\t\tvar l3_side = gfc.l3_side;\n\n\t\tvar mb = new MeanBits(mean_bits);\n\t\tthis.quantize.rv.ResvFrameBegin(gfp, mb);\n\t\tmean_bits = mb.bits;\n\n\t\t/* quantize! */\n\t\tfor (var gr = 0; gr < gfc.mode_gr; gr++) {\n\n\t\t\t/*\n\t\t\t * calculate needed bits\n\t\t\t */\n\t\t\tmax_bits = this.quantize.qupvt.on_pe(gfp, pe, targ_bits, mean_bits,\n\t\t\t\t\tgr, gr);\n\n\t\t\tif (gfc.mode_ext == Encoder.MPG_MD_MS_LR) {\n\t\t\t\tthis.quantize.ms_convert(gfc.l3_side, gr);\n\t\t\t\tthis.quantize.qupvt.reduce_side(targ_bits, ms_ener_ratio[gr],\n\t\t\t\t\t\tmean_bits, max_bits);\n\t\t\t}\n\n\t\t\tfor (var ch = 0; ch < gfc.channels_out; ch++) {\n\t\t\t\tvar adjust, masking_lower_db;\n\t\t\t\tvar cod_info = l3_side.tt[gr][ch];\n\n\t\t\t\tif (cod_info.block_type != Encoder.SHORT_TYPE) {\n\t\t\t\t\t// NORM, START or STOP type\n\t\t\t\t\tadjust = 0;\n\t\t\t\t\tmasking_lower_db = gfc.PSY.mask_adjust - adjust;\n\t\t\t\t} else {\n\t\t\t\t\tadjust = 0;\n\t\t\t\t\tmasking_lower_db = gfc.PSY.mask_adjust_short - adjust;\n\t\t\t\t}\n\t\t\t\tgfc.masking_lower =  Math.pow(10.0,\n\t\t\t\t\t\tmasking_lower_db * 0.1);\n\n\t\t\t\t/*\n\t\t\t\t * init_outer_loop sets up cod_info, scalefac and xrpow\n\t\t\t\t */\n\t\t\t\tthis.quantize.init_outer_loop(gfc, cod_info);\n\t\t\t\tif (this.quantize.init_xrpow(gfc, cod_info, xrpow)) {\n\t\t\t\t\t/*\n\t\t\t\t\t * xr contains energy we will have to encode calculate the\n\t\t\t\t\t * masking abilities find some good quantization in\n\t\t\t\t\t * outer_loop\n\t\t\t\t\t */\n\t\t\t\t\tthis.quantize.qupvt.calc_xmin(gfp, ratio[gr][ch], cod_info,\n\t\t\t\t\t\t\tl3_xmin);\n\t\t\t\t\tthis.quantize.outer_loop(gfp, cod_info, l3_xmin, xrpow, ch,\n\t\t\t\t\t\t\ttarg_bits[ch]);\n\t\t\t\t}\n\n\t\t\t\tthis.quantize.iteration_finish_one(gfc, gr, ch);\n\t\t\t} /* for ch */\n\t\t} /* for gr */\n\n\t\tthis.quantize.rv.ResvFrameEnd(gfc, mean_bits);\n\t}\n}\n\n\nfunction ReplayGain() {\n\t//fix 精简\n}\n\n//package mp3;\n\n/**\n * Layer III side information.\n *\n * @author Ken\n *\n */\n\n\n\nfunction ScaleFac(arrL, arrS, arr21, arr12) {\n\n    this.l = new_int(1 + Encoder.SBMAX_l);\n    this.s = new_int(1 + Encoder.SBMAX_s);\n    this.psfb21 = new_int(1 + Encoder.PSFB21);\n    this.psfb12 = new_int(1 + Encoder.PSFB12);\n    var l = this.l;\n    var s = this.s;\n\n    if (arguments.length == 4) {\n        //public ScaleFac(final int[] arrL, final int[] arrS, final int[] arr21,\n        //    final int[] arr12) {\n        this.arrL = arguments[0];\n        this.arrS = arguments[1];\n        this.arr21 = arguments[2];\n        this.arr12 = arguments[3];\n\n        System.arraycopy(this.arrL, 0, l, 0, Math.min(this.arrL.length, this.l.length));\n        System.arraycopy(this.arrS, 0, s, 0, Math.min(this.arrS.length, this.s.length));\n        System.arraycopy(this.arr21, 0, this.psfb21, 0, Math.min(this.arr21.length, this.psfb21.length));\n        System.arraycopy(this.arr12, 0, this.psfb12, 0, Math.min(this.arr12.length, this.psfb12.length));\n    }\n}\n\n/*\n *      quantize_pvt source file\n *\n *      Copyright (c) 1999-2002 Takehiro Tominaga\n *      Copyright (c) 2000-2002 Robert Hegemann\n *      Copyright (c) 2001 Naoki Shibata\n *      Copyright (c) 2002-2005 Gabriel Bouvigne\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n\n/* $Id: QuantizePVT.java,v 1.24 2011/05/24 20:48:06 kenchis Exp $ */\n\n\nQuantizePVT.Q_MAX = (256 + 1);\nQuantizePVT.Q_MAX2 = 116;\nQuantizePVT.LARGE_BITS = 100000;\nQuantizePVT.IXMAX_VAL = 8206;\n\nfunction QuantizePVT() {\n\n    var tak = null;\n    var rv = null;\n    var psy = null;\n\n    this.setModules = function (_tk, _rv, _psy) {\n        tak = _tk;\n        rv = _rv;\n        psy = _psy;\n    };\n\n    function POW20(x) {\n        return pow20[x + QuantizePVT.Q_MAX2];\n    }\n\n    this.IPOW20 = function (x) {\n        return ipow20[x];\n    }\n\n    /**\n     * smallest such that 1.0+DBL_EPSILON != 1.0\n     */\n    var DBL_EPSILON = 2.2204460492503131e-016;\n\n    /**\n     * ix always <= 8191+15. see count_bits()\n     */\n    var IXMAX_VAL = QuantizePVT.IXMAX_VAL;\n\n    var PRECALC_SIZE = (IXMAX_VAL + 2);\n\n    var Q_MAX = QuantizePVT.Q_MAX;\n\n\n    /**\n     * <CODE>\n     * minimum possible number of\n     * -cod_info.global_gain + ((scalefac[] + (cod_info.preflag ? pretab[sfb] : 0))\n     * << (cod_info.scalefac_scale + 1)) + cod_info.subblock_gain[cod_info.window[sfb]] * 8;\n     *\n     * for long block, 0+((15+3)<<2) = 18*4 = 72\n     * for short block, 0+(15<<2)+7*8 = 15*4+56 = 116\n     * </CODE>\n     */\n    var Q_MAX2 = QuantizePVT.Q_MAX2;\n\n    var LARGE_BITS = QuantizePVT.LARGE_BITS;\n\n\n    /**\n     * Assuming dynamic range=96dB, this value should be 92\n     */\n    var NSATHSCALE = 100;\n\n    /**\n     * The following table is used to implement the scalefactor partitioning for\n     * MPEG2 as described in section 2.4.3.2 of the IS. The indexing corresponds\n     * to the way the tables are presented in the IS:\n     *\n     * [table_number][row_in_table][column of nr_of_sfb]\n     */\n    this.nr_of_sfb_block = [\n        [[6, 5, 5, 5], [9, 9, 9, 9], [6, 9, 9, 9]],\n        [[6, 5, 7, 3], [9, 9, 12, 6], [6, 9, 12, 6]],\n        [[11, 10, 0, 0], [18, 18, 0, 0], [15, 18, 0, 0]],\n        [[7, 7, 7, 0], [12, 12, 12, 0], [6, 15, 12, 0]],\n        [[6, 6, 6, 3], [12, 9, 9, 6], [6, 12, 9, 6]],\n        [[8, 8, 5, 0], [15, 12, 9, 0], [6, 18, 9, 0]]];\n\n    /**\n     * Table B.6: layer3 preemphasis\n     */\n    var pretab = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1,\n        2, 2, 3, 3, 3, 2, 0];\n    this.pretab = pretab;\n\n    /**\n     * Here are MPEG1 Table B.8 and MPEG2 Table B.1 -- Layer III scalefactor\n     * bands. <BR>\n     * Index into this using a method such as:<BR>\n     * idx = fr_ps.header.sampling_frequency + (fr_ps.header.version * 3)\n     */\n    this.sfBandIndex = [\n        // Table B.2.b: 22.05 kHz\n        new ScaleFac([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 116, 140, 168, 200, 238, 284, 336, 396, 464,\n                522, 576],\n            [0, 4, 8, 12, 18, 24, 32, 42, 56, 74, 100, 132, 174, 192]\n            , [0, 0, 0, 0, 0, 0, 0] //  sfb21 pseudo sub bands\n            , [0, 0, 0, 0, 0, 0, 0] //  sfb12 pseudo sub bands\n        ),\n        /* Table B.2.c: 24 kHz */ /* docs: 332. mpg123(broken): 330 */\n        new ScaleFac([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 114, 136, 162, 194, 232, 278, 332, 394, 464,\n                540, 576],\n            [0, 4, 8, 12, 18, 26, 36, 48, 62, 80, 104, 136, 180, 192]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* Table B.2.a: 16 kHz */\n        new ScaleFac([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 116, 140, 168, 200, 238, 284, 336, 396, 464,\n                522, 576],\n            [0, 4, 8, 12, 18, 26, 36, 48, 62, 80, 104, 134, 174, 192]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* Table B.8.b: 44.1 kHz */\n        new ScaleFac([0, 4, 8, 12, 16, 20, 24, 30, 36, 44, 52, 62, 74, 90, 110, 134, 162, 196, 238, 288, 342, 418,\n                576],\n            [0, 4, 8, 12, 16, 22, 30, 40, 52, 66, 84, 106, 136, 192]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* Table B.8.c: 48 kHz */\n        new ScaleFac([0, 4, 8, 12, 16, 20, 24, 30, 36, 42, 50, 60, 72, 88, 106, 128, 156, 190, 230, 276, 330, 384,\n                576],\n            [0, 4, 8, 12, 16, 22, 28, 38, 50, 64, 80, 100, 126, 192]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* Table B.8.a: 32 kHz */\n        new ScaleFac([0, 4, 8, 12, 16, 20, 24, 30, 36, 44, 54, 66, 82, 102, 126, 156, 194, 240, 296, 364, 448, 550,\n                576],\n            [0, 4, 8, 12, 16, 22, 30, 42, 58, 78, 104, 138, 180, 192]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* MPEG-2.5 11.025 kHz */\n        new ScaleFac([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 116, 140, 168, 200, 238, 284, 336, 396, 464,\n                522, 576],\n            [0 / 3, 12 / 3, 24 / 3, 36 / 3, 54 / 3, 78 / 3, 108 / 3, 144 / 3, 186 / 3, 240 / 3, 312 / 3,\n                402 / 3, 522 / 3, 576 / 3]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* MPEG-2.5 12 kHz */\n        new ScaleFac([0, 6, 12, 18, 24, 30, 36, 44, 54, 66, 80, 96, 116, 140, 168, 200, 238, 284, 336, 396, 464,\n                522, 576],\n            [0 / 3, 12 / 3, 24 / 3, 36 / 3, 54 / 3, 78 / 3, 108 / 3, 144 / 3, 186 / 3, 240 / 3, 312 / 3,\n                402 / 3, 522 / 3, 576 / 3]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        ),\n        /* MPEG-2.5 8 kHz */\n        new ScaleFac([0, 12, 24, 36, 48, 60, 72, 88, 108, 132, 160, 192, 232, 280, 336, 400, 476, 566, 568, 570,\n                572, 574, 576],\n            [0 / 3, 24 / 3, 48 / 3, 72 / 3, 108 / 3, 156 / 3, 216 / 3, 288 / 3, 372 / 3, 480 / 3, 486 / 3,\n                492 / 3, 498 / 3, 576 / 3]\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb21 pseudo sub bands */\n            , [0, 0, 0, 0, 0, 0, 0] /*  sfb12 pseudo sub bands */\n        )\n    ];\n\n    var pow20 = new_float(Q_MAX + Q_MAX2 + 1);\n    var ipow20 = new_float(Q_MAX);\n    var pow43 = new_float(PRECALC_SIZE);\n\n    var adj43 = new_float(PRECALC_SIZE);\n    this.adj43 = adj43;\n\n    /**\n     * <PRE>\n     * compute the ATH for each scalefactor band cd range: 0..96db\n     *\n     * Input: 3.3kHz signal 32767 amplitude (3.3kHz is where ATH is smallest =\n     * -5db) longblocks: sfb=12 en0/bw=-11db max_en0 = 1.3db shortblocks: sfb=5\n     * -9db 0db\n     *\n     * Input: 1 1 1 1 1 1 1 -1 -1 -1 -1 -1 -1 -1 (repeated) longblocks: amp=1\n     * sfb=12 en0/bw=-103 db max_en0 = -92db amp=32767 sfb=12 -12 db -1.4db\n     *\n     * Input: 1 1 1 1 1 1 1 -1 -1 -1 -1 -1 -1 -1 (repeated) shortblocks: amp=1\n     * sfb=5 en0/bw= -99 -86 amp=32767 sfb=5 -9 db 4db\n     *\n     *\n     * MAX energy of largest wave at 3.3kHz = 1db AVE energy of largest wave at\n     * 3.3kHz = -11db Let's take AVE: -11db = maximum signal in sfb=12. Dynamic\n     * range of CD: 96db. Therefor energy of smallest audible wave in sfb=12 =\n     * -11 - 96 = -107db = ATH at 3.3kHz.\n     *\n     * ATH formula for this wave: -5db. To adjust to LAME scaling, we need ATH =\n     * ATH_formula - 103 (db) ATH = ATH * 2.5e-10 (ener)\n     * </PRE>\n     */\n    function ATHmdct(gfp, f) {\n        var ath = psy.ATHformula(f, gfp);\n\n        ath -= NSATHSCALE;\n\n        /* modify the MDCT scaling for the ATH and convert to energy */\n        ath = Math.pow(10.0, ath / 10.0 + gfp.ATHlower);\n        return ath;\n    }\n\n    function compute_ath(gfp) {\n        var ATH_l = gfp.internal_flags.ATH.l;\n        var ATH_psfb21 = gfp.internal_flags.ATH.psfb21;\n        var ATH_s = gfp.internal_flags.ATH.s;\n        var ATH_psfb12 = gfp.internal_flags.ATH.psfb12;\n        var gfc = gfp.internal_flags;\n        var samp_freq = gfp.out_samplerate;\n\n        for (var sfb = 0; sfb < Encoder.SBMAX_l; sfb++) {\n            var start = gfc.scalefac_band.l[sfb];\n            var end = gfc.scalefac_band.l[sfb + 1];\n            ATH_l[sfb] = Float.MAX_VALUE;\n            for (var i = start; i < end; i++) {\n                var freq = i * samp_freq / (2 * 576);\n                var ATH_f = ATHmdct(gfp, freq);\n                /* freq in kHz */\n                ATH_l[sfb] = Math.min(ATH_l[sfb], ATH_f);\n            }\n        }\n\n        for (var sfb = 0; sfb < Encoder.PSFB21; sfb++) {\n            var start = gfc.scalefac_band.psfb21[sfb];\n            var end = gfc.scalefac_band.psfb21[sfb + 1];\n            ATH_psfb21[sfb] = Float.MAX_VALUE;\n            for (var i = start; i < end; i++) {\n                var freq = i * samp_freq / (2 * 576);\n                var ATH_f = ATHmdct(gfp, freq);\n                /* freq in kHz */\n                ATH_psfb21[sfb] = Math.min(ATH_psfb21[sfb], ATH_f);\n            }\n        }\n\n        for (var sfb = 0; sfb < Encoder.SBMAX_s; sfb++) {\n            var start = gfc.scalefac_band.s[sfb];\n            var end = gfc.scalefac_band.s[sfb + 1];\n            ATH_s[sfb] = Float.MAX_VALUE;\n            for (var i = start; i < end; i++) {\n                var freq = i * samp_freq / (2 * 192);\n                var ATH_f = ATHmdct(gfp, freq);\n                /* freq in kHz */\n                ATH_s[sfb] = Math.min(ATH_s[sfb], ATH_f);\n            }\n            ATH_s[sfb] *= (gfc.scalefac_band.s[sfb + 1] - gfc.scalefac_band.s[sfb]);\n        }\n\n        for (var sfb = 0; sfb < Encoder.PSFB12; sfb++) {\n            var start = gfc.scalefac_band.psfb12[sfb];\n            var end = gfc.scalefac_band.psfb12[sfb + 1];\n            ATH_psfb12[sfb] = Float.MAX_VALUE;\n            for (var i = start; i < end; i++) {\n                var freq = i * samp_freq / (2 * 192);\n                var ATH_f = ATHmdct(gfp, freq);\n                /* freq in kHz */\n                ATH_psfb12[sfb] = Math.min(ATH_psfb12[sfb], ATH_f);\n            }\n            /* not sure about the following */\n            ATH_psfb12[sfb] *= (gfc.scalefac_band.s[13] - gfc.scalefac_band.s[12]);\n        }\n\n        /*\n         * no-ATH mode: reduce ATH to -200 dB\n         */\n        if (gfp.noATH) {\n            for (var sfb = 0; sfb < Encoder.SBMAX_l; sfb++) {\n                ATH_l[sfb] = 1E-20;\n            }\n            for (var sfb = 0; sfb < Encoder.PSFB21; sfb++) {\n                ATH_psfb21[sfb] = 1E-20;\n            }\n            for (var sfb = 0; sfb < Encoder.SBMAX_s; sfb++) {\n                ATH_s[sfb] = 1E-20;\n            }\n            for (var sfb = 0; sfb < Encoder.PSFB12; sfb++) {\n                ATH_psfb12[sfb] = 1E-20;\n            }\n        }\n\n        /*\n         * work in progress, don't rely on it too much\n         */\n        gfc.ATH.floor = 10. * Math_log10(ATHmdct(gfp, -1.));\n    }\n\n    /**\n     * initialization for iteration_loop\n     */\n    this.iteration_init = function (gfp) {\n        var gfc = gfp.internal_flags;\n        var l3_side = gfc.l3_side;\n        var i;\n\n        if (gfc.iteration_init_init == 0) {\n            gfc.iteration_init_init = 1;\n\n            l3_side.main_data_begin = 0;\n            compute_ath(gfp);\n\n            pow43[0] = 0.0;\n            for (i = 1; i < PRECALC_SIZE; i++)\n                pow43[i] = Math.pow(i, 4.0 / 3.0);\n\n            for (i = 0; i < PRECALC_SIZE - 1; i++)\n                adj43[i] = ((i + 1) - Math.pow(\n                    0.5 * (pow43[i] + pow43[i + 1]), 0.75));\n            adj43[i] = 0.5;\n\n            for (i = 0; i < Q_MAX; i++)\n                ipow20[i] = Math.pow(2.0, (i - 210) * -0.1875);\n            for (i = 0; i <= Q_MAX + Q_MAX2; i++)\n                pow20[i] = Math.pow(2.0, (i - 210 - Q_MAX2) * 0.25);\n\n            tak.huffman_init(gfc);\n\n            {\n                var bass, alto, treble, sfb21;\n\n                i = (gfp.exp_nspsytune >> 2) & 63;\n                if (i >= 32)\n                    i -= 64;\n                bass = Math.pow(10, i / 4.0 / 10.0);\n\n                i = (gfp.exp_nspsytune >> 8) & 63;\n                if (i >= 32)\n                    i -= 64;\n                alto = Math.pow(10, i / 4.0 / 10.0);\n\n                i = (gfp.exp_nspsytune >> 14) & 63;\n                if (i >= 32)\n                    i -= 64;\n                treble = Math.pow(10, i / 4.0 / 10.0);\n\n                /*\n                 * to be compatible with Naoki's original code, the next 6 bits\n                 * define only the amount of changing treble for sfb21\n                 */\n                i = (gfp.exp_nspsytune >> 20) & 63;\n                if (i >= 32)\n                    i -= 64;\n                sfb21 = treble * Math.pow(10, i / 4.0 / 10.0);\n                for (i = 0; i < Encoder.SBMAX_l; i++) {\n                    var f;\n                    if (i <= 6)\n                        f = bass;\n                    else if (i <= 13)\n                        f = alto;\n                    else if (i <= 20)\n                        f = treble;\n                    else\n                        f = sfb21;\n\n                    gfc.nsPsy.longfact[i] = f;\n                }\n                for (i = 0; i < Encoder.SBMAX_s; i++) {\n                    var f;\n                    if (i <= 5)\n                        f = bass;\n                    else if (i <= 10)\n                        f = alto;\n                    else if (i <= 11)\n                        f = treble;\n                    else\n                        f = sfb21;\n\n                    gfc.nsPsy.shortfact[i] = f;\n                }\n            }\n        }\n    }\n\n    /**\n     * allocate bits among 2 channels based on PE<BR>\n     * mt 6/99<BR>\n     * bugfixes rh 8/01: often allocated more than the allowed 4095 bits\n     */\n    this.on_pe = function (gfp, pe,\n                           targ_bits, mean_bits, gr, cbr) {\n        var gfc = gfp.internal_flags;\n        var tbits = 0, bits;\n        var add_bits = new_int(2);\n        var ch;\n\n        /* allocate targ_bits for granule */\n        var mb = new MeanBits(tbits);\n        var extra_bits = rv.ResvMaxBits(gfp, mean_bits, mb, cbr);\n        tbits = mb.bits;\n        /* maximum allowed bits for this granule */\n        var max_bits = tbits + extra_bits;\n        if (max_bits > LameInternalFlags.MAX_BITS_PER_GRANULE) {\n            // hard limit per granule\n            max_bits = LameInternalFlags.MAX_BITS_PER_GRANULE;\n        }\n        for (bits = 0, ch = 0; ch < gfc.channels_out; ++ch) {\n            /******************************************************************\n             * allocate bits for each channel\n             ******************************************************************/\n            targ_bits[ch] = Math.min(LameInternalFlags.MAX_BITS_PER_CHANNEL,\n                tbits / gfc.channels_out);\n\n            add_bits[ch] = 0 | (targ_bits[ch] * pe[gr][ch] / 700.0 - targ_bits[ch]);\n\n            /* at most increase bits by 1.5*average */\n            if (add_bits[ch] > mean_bits * 3 / 4)\n                add_bits[ch] = mean_bits * 3 / 4;\n\n            if (add_bits[ch] < 0)\n                add_bits[ch] = 0;\n\n            if (add_bits[ch] + targ_bits[ch] > LameInternalFlags.MAX_BITS_PER_CHANNEL)\n                add_bits[ch] = Math.max(0,\n                    LameInternalFlags.MAX_BITS_PER_CHANNEL - targ_bits[ch]);\n\n            bits += add_bits[ch];\n        }\n        if (bits > extra_bits) {\n            for (ch = 0; ch < gfc.channels_out; ++ch) {\n                add_bits[ch] = extra_bits * add_bits[ch] / bits;\n            }\n        }\n\n        for (ch = 0; ch < gfc.channels_out; ++ch) {\n            targ_bits[ch] += add_bits[ch];\n            extra_bits -= add_bits[ch];\n        }\n\n        for (bits = 0, ch = 0; ch < gfc.channels_out; ++ch) {\n            bits += targ_bits[ch];\n        }\n        if (bits > LameInternalFlags.MAX_BITS_PER_GRANULE) {\n            var sum = 0;\n            for (ch = 0; ch < gfc.channels_out; ++ch) {\n                targ_bits[ch] *= LameInternalFlags.MAX_BITS_PER_GRANULE;\n                targ_bits[ch] /= bits;\n                sum += targ_bits[ch];\n            }\n        }\n\n        return max_bits;\n    }\n\n    this.reduce_side = function (targ_bits, ms_ener_ratio, mean_bits, max_bits) {\n\n        /*\n         * ms_ener_ratio = 0: allocate 66/33 mid/side fac=.33 ms_ener_ratio =.5:\n         * allocate 50/50 mid/side fac= 0\n         */\n        /* 75/25 split is fac=.5 */\n        var fac = .33 * (.5 - ms_ener_ratio) / .5;\n        if (fac < 0)\n            fac = 0;\n        if (fac > .5)\n            fac = .5;\n\n        /* number of bits to move from side channel to mid channel */\n        /* move_bits = fac*targ_bits[1]; */\n        var move_bits = 0 | (fac * .5 * (targ_bits[0] + targ_bits[1]));\n\n        if (move_bits > LameInternalFlags.MAX_BITS_PER_CHANNEL - targ_bits[0]) {\n            move_bits = LameInternalFlags.MAX_BITS_PER_CHANNEL - targ_bits[0];\n        }\n        if (move_bits < 0)\n            move_bits = 0;\n\n        if (targ_bits[1] >= 125) {\n            /* dont reduce side channel below 125 bits */\n            if (targ_bits[1] - move_bits > 125) {\n\n                /* if mid channel already has 2x more than average, dont bother */\n                /* mean_bits = bits per granule (for both channels) */\n                if (targ_bits[0] < mean_bits)\n                    targ_bits[0] += move_bits;\n                targ_bits[1] -= move_bits;\n            } else {\n                targ_bits[0] += targ_bits[1] - 125;\n                targ_bits[1] = 125;\n            }\n        }\n\n        move_bits = targ_bits[0] + targ_bits[1];\n        if (move_bits > max_bits) {\n            targ_bits[0] = (max_bits * targ_bits[0]) / move_bits;\n            targ_bits[1] = (max_bits * targ_bits[1]) / move_bits;\n        }\n    };\n\n    /**\n     *  Robert Hegemann 2001-04-27:\n     *  this adjusts the ATH, keeping the original noise floor\n     *  affects the higher frequencies more than the lower ones\n     */\n    this.athAdjust = function (a, x, athFloor) {\n        /*\n         * work in progress\n         */\n        var o = 90.30873362;\n        var p = 94.82444863;\n        var u = Util.FAST_LOG10_X(x, 10.0);\n        var v = a * a;\n        var w = 0.0;\n        u -= athFloor;\n        /* undo scaling */\n        if (v > 1E-20)\n            w = 1. + Util.FAST_LOG10_X(v, 10.0 / o);\n        if (w < 0)\n            w = 0.;\n        u *= w;\n        u += athFloor + o - p;\n        /* redo scaling */\n\n        return Math.pow(10., 0.1 * u);\n    };\n\n    /**\n     * Calculate the allowed distortion for each scalefactor band, as determined\n     * by the psychoacoustic model. xmin(sb) = ratio(sb) * en(sb) / bw(sb)\n     *\n     * returns number of sfb's with energy > ATH\n     */\n    this.calc_xmin = function (gfp, ratio, cod_info, pxmin) {\n        var pxminPos = 0;\n        var gfc = gfp.internal_flags;\n        var gsfb, j = 0, ath_over = 0;\n        var ATH = gfc.ATH;\n        var xr = cod_info.xr;\n        var enable_athaa_fix = (gfp.VBR == VbrMode.vbr_mtrh) ? 1 : 0;\n        var masking_lower = gfc.masking_lower;\n\n        if (gfp.VBR == VbrMode.vbr_mtrh || gfp.VBR == VbrMode.vbr_mt) {\n            /* was already done in PSY-Model */\n            masking_lower = 1.0;\n        }\n\n        for (gsfb = 0; gsfb < cod_info.psy_lmax; gsfb++) {\n            var en0, xmin;\n            var rh1, rh2;\n            var width, l;\n\n            if (gfp.VBR == VbrMode.vbr_rh || gfp.VBR == VbrMode.vbr_mtrh)\n                xmin = athAdjust(ATH.adjust, ATH.l[gsfb], ATH.floor);\n            else\n                xmin = ATH.adjust * ATH.l[gsfb];\n\n            width = cod_info.width[gsfb];\n            rh1 = xmin / width;\n            rh2 = DBL_EPSILON;\n            l = width >> 1;\n            en0 = 0.0;\n            do {\n                var xa, xb;\n                xa = xr[j] * xr[j];\n                en0 += xa;\n                rh2 += (xa < rh1) ? xa : rh1;\n                j++;\n                xb = xr[j] * xr[j];\n                en0 += xb;\n                rh2 += (xb < rh1) ? xb : rh1;\n                j++;\n            } while (--l > 0);\n            if (en0 > xmin)\n                ath_over++;\n\n            if (gsfb == Encoder.SBPSY_l) {\n                var x = xmin * gfc.nsPsy.longfact[gsfb];\n                if (rh2 < x) {\n                    rh2 = x;\n                }\n            }\n            if (enable_athaa_fix != 0) {\n                xmin = rh2;\n            }\n            if (!gfp.ATHonly) {\n                var e = ratio.en.l[gsfb];\n                if (e > 0.0) {\n                    var x;\n                    x = en0 * ratio.thm.l[gsfb] * masking_lower / e;\n                    if (enable_athaa_fix != 0)\n                        x *= gfc.nsPsy.longfact[gsfb];\n                    if (xmin < x)\n                        xmin = x;\n                }\n            }\n            if (enable_athaa_fix != 0)\n                pxmin[pxminPos++] = xmin;\n            else\n                pxmin[pxminPos++] = xmin * gfc.nsPsy.longfact[gsfb];\n        }\n        /* end of long block loop */\n\n        /* use this function to determine the highest non-zero coeff */\n        var max_nonzero = 575;\n        if (cod_info.block_type != Encoder.SHORT_TYPE) {\n            // NORM, START or STOP type, but not SHORT\n            var k = 576;\n            while (k-- != 0 && BitStream.EQ(xr[k], 0)) {\n                max_nonzero = k;\n            }\n        }\n        cod_info.max_nonzero_coeff = max_nonzero;\n\n        for (var sfb = cod_info.sfb_smin; gsfb < cod_info.psymax; sfb++, gsfb += 3) {\n            var width, b;\n            var tmpATH;\n            if (gfp.VBR == VbrMode.vbr_rh || gfp.VBR == VbrMode.vbr_mtrh)\n                tmpATH = athAdjust(ATH.adjust, ATH.s[sfb], ATH.floor);\n            else\n                tmpATH = ATH.adjust * ATH.s[sfb];\n\n            width = cod_info.width[gsfb];\n            for (b = 0; b < 3; b++) {\n                var en0 = 0.0, xmin;\n                var rh1, rh2;\n                var l = width >> 1;\n\n                rh1 = tmpATH / width;\n                rh2 = DBL_EPSILON;\n                do {\n                    var xa, xb;\n                    xa = xr[j] * xr[j];\n                    en0 += xa;\n                    rh2 += (xa < rh1) ? xa : rh1;\n                    j++;\n                    xb = xr[j] * xr[j];\n                    en0 += xb;\n                    rh2 += (xb < rh1) ? xb : rh1;\n                    j++;\n                } while (--l > 0);\n                if (en0 > tmpATH)\n                    ath_over++;\n                if (sfb == Encoder.SBPSY_s) {\n                    var x = tmpATH * gfc.nsPsy.shortfact[sfb];\n                    if (rh2 < x) {\n                        rh2 = x;\n                    }\n                }\n                if (enable_athaa_fix != 0)\n                    xmin = rh2;\n                else\n                    xmin = tmpATH;\n\n                if (!gfp.ATHonly && !gfp.ATHshort) {\n                    var e = ratio.en.s[sfb][b];\n                    if (e > 0.0) {\n                        var x;\n                        x = en0 * ratio.thm.s[sfb][b] * masking_lower / e;\n                        if (enable_athaa_fix != 0)\n                            x *= gfc.nsPsy.shortfact[sfb];\n                        if (xmin < x)\n                            xmin = x;\n                    }\n                }\n                if (enable_athaa_fix != 0)\n                    pxmin[pxminPos++] = xmin;\n                else\n                    pxmin[pxminPos++] = xmin * gfc.nsPsy.shortfact[sfb];\n            }\n            /* b */\n            if (gfp.useTemporal) {\n                if (pxmin[pxminPos - 3] > pxmin[pxminPos - 3 + 1])\n                    pxmin[pxminPos - 3 + 1] += (pxmin[pxminPos - 3] - pxmin[pxminPos - 3 + 1])\n                        * gfc.decay;\n                if (pxmin[pxminPos - 3 + 1] > pxmin[pxminPos - 3 + 2])\n                    pxmin[pxminPos - 3 + 2] += (pxmin[pxminPos - 3 + 1] - pxmin[pxminPos - 3 + 2])\n                        * gfc.decay;\n            }\n        }\n        /* end of short block sfb loop */\n\n        return ath_over;\n    };\n\n    function StartLine(j) {\n        this.s = j;\n    }\n\n    this.calc_noise_core = function (cod_info, startline, l, step) {\n        var noise = 0;\n        var j = startline.s;\n        var ix = cod_info.l3_enc;\n\n        if (j > cod_info.count1) {\n            while ((l--) != 0) {\n                var temp;\n                temp = cod_info.xr[j];\n                j++;\n                noise += temp * temp;\n                temp = cod_info.xr[j];\n                j++;\n                noise += temp * temp;\n            }\n        } else if (j > cod_info.big_values) {\n            var ix01 = new_float(2);\n            ix01[0] = 0;\n            ix01[1] = step;\n            while ((l--) != 0) {\n                var temp;\n                temp = Math.abs(cod_info.xr[j]) - ix01[ix[j]];\n                j++;\n                noise += temp * temp;\n                temp = Math.abs(cod_info.xr[j]) - ix01[ix[j]];\n                j++;\n                noise += temp * temp;\n            }\n        } else {\n            while ((l--) != 0) {\n                var temp;\n                temp = Math.abs(cod_info.xr[j]) - pow43[ix[j]] * step;\n                j++;\n                noise += temp * temp;\n                temp = Math.abs(cod_info.xr[j]) - pow43[ix[j]] * step;\n                j++;\n                noise += temp * temp;\n            }\n        }\n\n        startline.s = j;\n        return noise;\n    }\n\n    /**\n     * <PRE>\n     * -oo dB  =>  -1.00\n     * - 6 dB  =>  -0.97\n     * - 3 dB  =>  -0.80\n     * - 2 dB  =>  -0.64\n     * - 1 dB  =>  -0.38\n     *   0 dB  =>   0.00\n     * + 1 dB  =>  +0.49\n     * + 2 dB  =>  +1.06\n     * + 3 dB  =>  +1.68\n     * + 6 dB  =>  +3.69\n     * +10 dB  =>  +6.45\n     * </PRE>\n     */\n    this.calc_noise = function (cod_info, l3_xmin, distort, res, prev_noise) {\n        var distortPos = 0;\n        var l3_xminPos = 0;\n        var sfb, l, over = 0;\n        var over_noise_db = 0;\n        /* 0 dB relative to masking */\n        var tot_noise_db = 0;\n        /* -200 dB relative to masking */\n        var max_noise = -20.0;\n        var j = 0;\n        var scalefac = cod_info.scalefac;\n        var scalefacPos = 0;\n\n        res.over_SSD = 0;\n\n        for (sfb = 0; sfb < cod_info.psymax; sfb++) {\n            var s = cod_info.global_gain\n                - (((scalefac[scalefacPos++]) + (cod_info.preflag != 0 ? pretab[sfb]\n                    : 0)) << (cod_info.scalefac_scale + 1))\n                - cod_info.subblock_gain[cod_info.window[sfb]] * 8;\n            var noise = 0.0;\n\n            if (prev_noise != null && (prev_noise.step[sfb] == s)) {\n\n                /* use previously computed values */\n                noise = prev_noise.noise[sfb];\n                j += cod_info.width[sfb];\n                distort[distortPos++] = noise / l3_xmin[l3_xminPos++];\n\n                noise = prev_noise.noise_log[sfb];\n\n            } else {\n                var step = POW20(s);\n                l = cod_info.width[sfb] >> 1;\n\n                if ((j + cod_info.width[sfb]) > cod_info.max_nonzero_coeff) {\n                    var usefullsize;\n                    usefullsize = cod_info.max_nonzero_coeff - j + 1;\n\n                    if (usefullsize > 0)\n                        l = usefullsize >> 1;\n                    else\n                        l = 0;\n                }\n\n                var sl = new StartLine(j);\n                noise = this.calc_noise_core(cod_info, sl, l, step);\n                j = sl.s;\n\n                if (prev_noise != null) {\n                    /* save noise values */\n                    prev_noise.step[sfb] = s;\n                    prev_noise.noise[sfb] = noise;\n                }\n\n                noise = distort[distortPos++] = noise / l3_xmin[l3_xminPos++];\n\n                /* multiplying here is adding in dB, but can overflow */\n                noise = Util.FAST_LOG10(Math.max(noise, 1E-20));\n\n                if (prev_noise != null) {\n                    /* save noise values */\n                    prev_noise.noise_log[sfb] = noise;\n                }\n            }\n\n            if (prev_noise != null) {\n                /* save noise values */\n                prev_noise.global_gain = cod_info.global_gain;\n            }\n\n            tot_noise_db += noise;\n\n            if (noise > 0.0) {\n                var tmp;\n\n                tmp = Math.max(0 | (noise * 10 + .5), 1);\n                res.over_SSD += tmp * tmp;\n\n                over++;\n                /* multiplying here is adding in dB -but can overflow */\n                /* over_noise *= noise; */\n                over_noise_db += noise;\n            }\n            max_noise = Math.max(max_noise, noise);\n\n        }\n\n        res.over_count = over;\n        res.tot_noise = tot_noise_db;\n        res.over_noise = over_noise_db;\n        res.max_noise = max_noise;\n\n        return over;\n    }\n\n    /**\n     * updates plotting data\n     *\n     * Mark Taylor 2000-??-??\n     *\n     * Robert Hegemann: moved noise/distortion calc into it\n     */\n    this.set_pinfo = function (gfp, cod_info, ratio, gr, ch) {\n        var gfc = gfp.internal_flags;\n        var sfb, sfb2;\n        var l;\n        var en0, en1;\n        var ifqstep = (cod_info.scalefac_scale == 0) ? .5 : 1.0;\n        var scalefac = cod_info.scalefac;\n\n        var l3_xmin = new_float(L3Side.SFBMAX);\n        var xfsf = new_float(L3Side.SFBMAX);\n        var noise = new CalcNoiseResult();\n\n        calc_xmin(gfp, ratio, cod_info, l3_xmin);\n        calc_noise(cod_info, l3_xmin, xfsf, noise, null);\n\n        var j = 0;\n        sfb2 = cod_info.sfb_lmax;\n        if (cod_info.block_type != Encoder.SHORT_TYPE\n            && 0 == cod_info.mixed_block_flag)\n            sfb2 = 22;\n        for (sfb = 0; sfb < sfb2; sfb++) {\n            var start = gfc.scalefac_band.l[sfb];\n            var end = gfc.scalefac_band.l[sfb + 1];\n            var bw = end - start;\n            for (en0 = 0.0; j < end; j++)\n                en0 += cod_info.xr[j] * cod_info.xr[j];\n            en0 /= bw;\n            /* convert to MDCT units */\n            /* scaling so it shows up on FFT plot */\n            en1 = 1e15;\n            gfc.pinfo.en[gr][ch][sfb] = en1 * en0;\n            gfc.pinfo.xfsf[gr][ch][sfb] = en1 * l3_xmin[sfb] * xfsf[sfb] / bw;\n\n            if (ratio.en.l[sfb] > 0 && !gfp.ATHonly)\n                en0 = en0 / ratio.en.l[sfb];\n            else\n                en0 = 0.0;\n\n            gfc.pinfo.thr[gr][ch][sfb] = en1\n                * Math.max(en0 * ratio.thm.l[sfb], gfc.ATH.l[sfb]);\n\n            /* there is no scalefactor bands >= SBPSY_l */\n            gfc.pinfo.LAMEsfb[gr][ch][sfb] = 0;\n            if (cod_info.preflag != 0 && sfb >= 11)\n                gfc.pinfo.LAMEsfb[gr][ch][sfb] = -ifqstep * pretab[sfb];\n\n            if (sfb < Encoder.SBPSY_l) {\n                /* scfsi should be decoded by caller side */\n                gfc.pinfo.LAMEsfb[gr][ch][sfb] -= ifqstep * scalefac[sfb];\n            }\n        }\n        /* for sfb */\n\n        if (cod_info.block_type == Encoder.SHORT_TYPE) {\n            sfb2 = sfb;\n            for (sfb = cod_info.sfb_smin; sfb < Encoder.SBMAX_s; sfb++) {\n                var start = gfc.scalefac_band.s[sfb];\n                var end = gfc.scalefac_band.s[sfb + 1];\n                var bw = end - start;\n                for (var i = 0; i < 3; i++) {\n                    for (en0 = 0.0, l = start; l < end; l++) {\n                        en0 += cod_info.xr[j] * cod_info.xr[j];\n                        j++;\n                    }\n                    en0 = Math.max(en0 / bw, 1e-20);\n                    /* convert to MDCT units */\n                    /* scaling so it shows up on FFT plot */\n                    en1 = 1e15;\n\n                    gfc.pinfo.en_s[gr][ch][3 * sfb + i] = en1 * en0;\n                    gfc.pinfo.xfsf_s[gr][ch][3 * sfb + i] = en1 * l3_xmin[sfb2]\n                        * xfsf[sfb2] / bw;\n                    if (ratio.en.s[sfb][i] > 0)\n                        en0 = en0 / ratio.en.s[sfb][i];\n                    else\n                        en0 = 0.0;\n                    if (gfp.ATHonly || gfp.ATHshort)\n                        en0 = 0;\n\n                    gfc.pinfo.thr_s[gr][ch][3 * sfb + i] = en1\n                        * Math.max(en0 * ratio.thm.s[sfb][i],\n                            gfc.ATH.s[sfb]);\n\n                    /* there is no scalefactor bands >= SBPSY_s */\n                    gfc.pinfo.LAMEsfb_s[gr][ch][3 * sfb + i] = -2.0\n                        * cod_info.subblock_gain[i];\n                    if (sfb < Encoder.SBPSY_s) {\n                        gfc.pinfo.LAMEsfb_s[gr][ch][3 * sfb + i] -= ifqstep\n                            * scalefac[sfb2];\n                    }\n                    sfb2++;\n                }\n            }\n        }\n        /* block type short */\n        gfc.pinfo.LAMEqss[gr][ch] = cod_info.global_gain;\n        gfc.pinfo.LAMEmainbits[gr][ch] = cod_info.part2_3_length\n            + cod_info.part2_length;\n        gfc.pinfo.LAMEsfbits[gr][ch] = cod_info.part2_length;\n\n        gfc.pinfo.over[gr][ch] = noise.over_count;\n        gfc.pinfo.max_noise[gr][ch] = noise.max_noise * 10.0;\n        gfc.pinfo.over_noise[gr][ch] = noise.over_noise * 10.0;\n        gfc.pinfo.tot_noise[gr][ch] = noise.tot_noise * 10.0;\n        gfc.pinfo.over_SSD[gr][ch] = noise.over_SSD;\n    }\n\n    /**\n     * updates plotting data for a whole frame\n     *\n     * Robert Hegemann 2000-10-21\n     */\n    function set_frame_pinfo(gfp, ratio) {\n        var gfc = gfp.internal_flags;\n\n        gfc.masking_lower = 1.0;\n\n        /*\n         * for every granule and channel patch l3_enc and set info\n         */\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            for (var ch = 0; ch < gfc.channels_out; ch++) {\n                var cod_info = gfc.l3_side.tt[gr][ch];\n                var scalefac_sav = new_int(L3Side.SFBMAX);\n                System.arraycopy(cod_info.scalefac, 0, scalefac_sav, 0,\n                    scalefac_sav.length);\n\n                /*\n                 * reconstruct the scalefactors in case SCFSI was used\n                 */\n                if (gr == 1) {\n                    var sfb;\n                    for (sfb = 0; sfb < cod_info.sfb_lmax; sfb++) {\n                        if (cod_info.scalefac[sfb] < 0) /* scfsi */\n                            cod_info.scalefac[sfb] = gfc.l3_side.tt[0][ch].scalefac[sfb];\n                    }\n                }\n\n                set_pinfo(gfp, cod_info, ratio[gr][ch], gr, ch);\n                System.arraycopy(scalefac_sav, 0, cod_info.scalefac, 0,\n                    scalefac_sav.length);\n            }\n            /* for ch */\n        }\n        /* for gr */\n    }\n\n}\n\n\nfunction CalcNoiseData() {\n    this.global_gain = 0;\n    this.sfb_count1 = 0;\n    this.step = new_int(39);\n    this.noise = new_float(39);\n    this.noise_log = new_float(39);\n}\n\n//package mp3;\n\n\nfunction GrInfo() {\n    //float xr[] = new float[576];\n    this.xr = new_float(576);\n    //int l3_enc[] = new int[576];\n    this.l3_enc = new_int(576);\n    //int scalefac[] = new int[L3Side.SFBMAX];\n    this.scalefac = new_int(L3Side.SFBMAX);\n    this.xrpow_max = 0.;\n\n    this.part2_3_length = 0;\n    this.big_values = 0;\n    this.count1 = 0;\n    this.global_gain = 0;\n    this.scalefac_compress = 0;\n    this.block_type = 0;\n    this.mixed_block_flag = 0;\n    this.table_select = new_int(3);\n    this.subblock_gain = new_int(3 + 1);\n    this.region0_count = 0;\n    this.region1_count = 0;\n    this.preflag = 0;\n    this.scalefac_scale = 0;\n    this.count1table_select = 0;\n\n    this.part2_length = 0;\n    this.sfb_lmax = 0;\n    this.sfb_smin = 0;\n    this.psy_lmax = 0;\n    this.sfbmax = 0;\n    this.psymax = 0;\n    this.sfbdivide = 0;\n    this.width = new_int(L3Side.SFBMAX);\n    this.window = new_int(L3Side.SFBMAX);\n    this.count1bits = 0;\n    /**\n     * added for LSF\n     */\n    this.sfb_partition_table = null;\n    this.slen = new_int(4);\n\n    this.max_nonzero_coeff = 0;\n\n    var self = this;\n    function clone_int(array) {\n        return new Int32Array(array);\n    }\n    function clone_float(array) {\n        return new Float32Array(array);\n    }\n    this.assign = function (other) {\n        self.xr = clone_float(other.xr); //.slice(0); //clone();\n        self.l3_enc = clone_int(other.l3_enc); //.slice(0); //clone();\n        self.scalefac = clone_int(other.scalefac);//.slice(0); //clone();\n        self.xrpow_max = other.xrpow_max;\n\n        self.part2_3_length = other.part2_3_length;\n        self.big_values = other.big_values;\n        self.count1 = other.count1;\n        self.global_gain = other.global_gain;\n        self.scalefac_compress = other.scalefac_compress;\n        self.block_type = other.block_type;\n        self.mixed_block_flag = other.mixed_block_flag;\n        self.table_select = clone_int(other.table_select);//.slice(0); //clone();\n        self.subblock_gain = clone_int(other.subblock_gain); //.slice(0); //.clone();\n        self.region0_count = other.region0_count;\n        self.region1_count = other.region1_count;\n        self.preflag = other.preflag;\n        self.scalefac_scale = other.scalefac_scale;\n        self.count1table_select = other.count1table_select;\n\n        self.part2_length = other.part2_length;\n        self.sfb_lmax = other.sfb_lmax;\n        self.sfb_smin = other.sfb_smin;\n        self.psy_lmax = other.psy_lmax;\n        self.sfbmax = other.sfbmax;\n        self.psymax = other.psymax;\n        self.sfbdivide = other.sfbdivide;\n        self.width = clone_int(other.width); //.slice(0); //.clone();\n        self.window = clone_int(other.window); //.slice(0); //.clone();\n        self.count1bits = other.count1bits;\n\n        self.sfb_partition_table = other.sfb_partition_table.slice(0); //.clone();\n        self.slen = clone_int(other.slen); //.slice(0); //.clone();\n        self.max_nonzero_coeff = other.max_nonzero_coeff;\n    }\n}\n\n\nvar L3Side = {};\n\n\n\t/**\n\t * max scalefactor band, max(SBMAX_l, SBMAX_s*3, (SBMAX_s-3)*3+8)\n\t */\nL3Side.SFBMAX = (Encoder.SBMAX_s * 3);\n\n/*\n * MP3 quantization\n *\n *      Copyright (c) 1999-2000 Mark Taylor\n *      Copyright (c) 1999-2003 Takehiro Tominaga\n *      Copyright (c) 2000-2007 Robert Hegemann\n *      Copyright (c) 2001-2005 Gabriel Bouvigne\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.     See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n\n/* $Id: Quantize.java,v 1.24 2011/05/24 20:48:06 kenchis Exp $ */\n\n//package mp3;\n\n//import java.util.Arrays;\n\n\nfunction Quantize() {\n    var bs;\n    this.rv = null;\n    var rv;\n    this.qupvt = null;\n    var qupvt;\n\n    var vbr = new VBRQuantize();\n    var tk;\n\n    this.setModules = function (_bs, _rv, _qupvt, _tk) {\n        bs = _bs;\n        rv = _rv;\n        this.rv = _rv;\n        qupvt = _qupvt;\n        this.qupvt = _qupvt;\n        tk = _tk;\n        vbr.setModules(qupvt, tk);\n    }\n\n    /**\n     * convert from L/R <. Mid/Side\n     */\n    this.ms_convert = function (l3_side, gr) {\n        for (var i = 0; i < 576; ++i) {\n            var l = l3_side.tt[gr][0].xr[i];\n            var r = l3_side.tt[gr][1].xr[i];\n            l3_side.tt[gr][0].xr[i] = (l + r) * (Util.SQRT2 * 0.5);\n            l3_side.tt[gr][1].xr[i] = (l - r) * (Util.SQRT2 * 0.5);\n        }\n    };\n\n    /**\n     * mt 6/99\n     *\n     * initializes cod_info, scalefac and xrpow\n     *\n     * returns 0 if all energies in xr are zero, else 1\n     */\n    function init_xrpow_core(cod_info, xrpow, upper, sum) {\n        sum = 0;\n        for (var i = 0; i <= upper; ++i) {\n            var tmp = Math.abs(cod_info.xr[i]);\n            sum += tmp;\n            xrpow[i] = Math.sqrt(tmp * Math.sqrt(tmp));\n\n            if (xrpow[i] > cod_info.xrpow_max)\n                cod_info.xrpow_max = xrpow[i];\n        }\n        return sum;\n    }\n\n    this.init_xrpow = function (gfc, cod_info, xrpow) {\n        var sum = 0;\n        var upper = 0 | cod_info.max_nonzero_coeff;\n\n        cod_info.xrpow_max = 0;\n\n        /*\n         * check if there is some energy we have to quantize and calculate xrpow\n         * matching our fresh scalefactors\n         */\n\n        Arrays.fill(xrpow, upper, 576, 0);\n\n        sum = init_xrpow_core(cod_info, xrpow, upper, sum);\n\n        /*\n         * return 1 if we have something to quantize, else 0\n         */\n        if (sum > 1E-20) {\n            var j = 0;\n            if ((gfc.substep_shaping & 2) != 0)\n                j = 1;\n\n            for (var i = 0; i < cod_info.psymax; i++)\n                gfc.pseudohalf[i] = j;\n\n            return true;\n        }\n\n        Arrays.fill(cod_info.l3_enc, 0, 576, 0);\n        return false;\n    }\n\n    /**\n     * Gabriel Bouvigne feb/apr 2003<BR>\n     * Analog silence detection in partitionned sfb21 or sfb12 for short blocks\n     *\n     * From top to bottom of sfb, changes to 0 coeffs which are below ath. It\n     * stops on the first coeff higher than ath.\n     */\n    function psfb21_analogsilence(gfc, cod_info) {\n        var ath = gfc.ATH;\n        var xr = cod_info.xr;\n\n        if (cod_info.block_type != Encoder.SHORT_TYPE) {\n            /* NORM, START or STOP type, but not SHORT blocks */\n            var stop = false;\n            for (var gsfb = Encoder.PSFB21 - 1; gsfb >= 0 && !stop; gsfb--) {\n                var start = gfc.scalefac_band.psfb21[gsfb];\n                var end = gfc.scalefac_band.psfb21[gsfb + 1];\n                var ath21 = qupvt.athAdjust(ath.adjust, ath.psfb21[gsfb],\n                    ath.floor);\n\n                if (gfc.nsPsy.longfact[21] > 1e-12)\n                    ath21 *= gfc.nsPsy.longfact[21];\n\n                for (var j = end - 1; j >= start; j--) {\n                    if (Math.abs(xr[j]) < ath21)\n                        xr[j] = 0;\n                    else {\n                        stop = true;\n                        break;\n                    }\n                }\n            }\n        } else {\n            /* note: short blocks coeffs are reordered */\n            for (var block = 0; block < 3; block++) {\n                var stop = false;\n                for (var gsfb = Encoder.PSFB12 - 1; gsfb >= 0 && !stop; gsfb--) {\n                    var start = gfc.scalefac_band.s[12]\n                        * 3\n                        + (gfc.scalefac_band.s[13] - gfc.scalefac_band.s[12])\n                        * block\n                        + (gfc.scalefac_band.psfb12[gsfb] - gfc.scalefac_band.psfb12[0]);\n                    var end = start\n                        + (gfc.scalefac_band.psfb12[gsfb + 1] - gfc.scalefac_band.psfb12[gsfb]);\n                    var ath12 = qupvt.athAdjust(ath.adjust, ath.psfb12[gsfb],\n                        ath.floor);\n\n                    if (gfc.nsPsy.shortfact[12] > 1e-12)\n                        ath12 *= gfc.nsPsy.shortfact[12];\n\n                    for (var j = end - 1; j >= start; j--) {\n                        if (Math.abs(xr[j]) < ath12)\n                            xr[j] = 0;\n                        else {\n                            stop = true;\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n\n    }\n\n    this.init_outer_loop = function (gfc, cod_info) {\n        /*\n         * initialize fresh cod_info\n         */\n        cod_info.part2_3_length = 0;\n        cod_info.big_values = 0;\n        cod_info.count1 = 0;\n        cod_info.global_gain = 210;\n        cod_info.scalefac_compress = 0;\n        /* mixed_block_flag, block_type was set in psymodel.c */\n        cod_info.table_select[0] = 0;\n        cod_info.table_select[1] = 0;\n        cod_info.table_select[2] = 0;\n        cod_info.subblock_gain[0] = 0;\n        cod_info.subblock_gain[1] = 0;\n        cod_info.subblock_gain[2] = 0;\n        cod_info.subblock_gain[3] = 0;\n        /* this one is always 0 */\n        cod_info.region0_count = 0;\n        cod_info.region1_count = 0;\n        cod_info.preflag = 0;\n        cod_info.scalefac_scale = 0;\n        cod_info.count1table_select = 0;\n        cod_info.part2_length = 0;\n        cod_info.sfb_lmax = Encoder.SBPSY_l;\n        cod_info.sfb_smin = Encoder.SBPSY_s;\n        cod_info.psy_lmax = gfc.sfb21_extra ? Encoder.SBMAX_l : Encoder.SBPSY_l;\n        cod_info.psymax = cod_info.psy_lmax;\n        cod_info.sfbmax = cod_info.sfb_lmax;\n        cod_info.sfbdivide = 11;\n        for (var sfb = 0; sfb < Encoder.SBMAX_l; sfb++) {\n            cod_info.width[sfb] = gfc.scalefac_band.l[sfb + 1]\n                - gfc.scalefac_band.l[sfb];\n            /* which is always 0. */\n            cod_info.window[sfb] = 3;\n        }\n        if (cod_info.block_type == Encoder.SHORT_TYPE) {\n            var ixwork = new_float(576);\n\n            cod_info.sfb_smin = 0;\n            cod_info.sfb_lmax = 0;\n            if (cod_info.mixed_block_flag != 0) {\n                /*\n                 * MPEG-1: sfbs 0-7 long block, 3-12 short blocks MPEG-2(.5):\n                 * sfbs 0-5 long block, 3-12 short blocks\n                 */\n                cod_info.sfb_smin = 3;\n                cod_info.sfb_lmax = gfc.mode_gr * 2 + 4;\n            }\n            cod_info.psymax = cod_info.sfb_lmax\n                + 3\n                * ((gfc.sfb21_extra ? Encoder.SBMAX_s : Encoder.SBPSY_s) - cod_info.sfb_smin);\n            cod_info.sfbmax = cod_info.sfb_lmax + 3\n                * (Encoder.SBPSY_s - cod_info.sfb_smin);\n            cod_info.sfbdivide = cod_info.sfbmax - 18;\n            cod_info.psy_lmax = cod_info.sfb_lmax;\n            /* re-order the short blocks, for more efficient encoding below */\n            /* By Takehiro TOMINAGA */\n            /*\n             * Within each scalefactor band, data is given for successive time\n             * windows, beginning with window 0 and ending with window 2. Within\n             * each window, the quantized values are then arranged in order of\n             * increasing frequency...\n             */\n            var ix = gfc.scalefac_band.l[cod_info.sfb_lmax];\n            System.arraycopy(cod_info.xr, 0, ixwork, 0, 576);\n            for (var sfb = cod_info.sfb_smin; sfb < Encoder.SBMAX_s; sfb++) {\n                var start = gfc.scalefac_band.s[sfb];\n                var end = gfc.scalefac_band.s[sfb + 1];\n                for (var window = 0; window < 3; window++) {\n                    for (var l = start; l < end; l++) {\n                        cod_info.xr[ix++] = ixwork[3 * l + window];\n                    }\n                }\n            }\n\n            var j = cod_info.sfb_lmax;\n            for (var sfb = cod_info.sfb_smin; sfb < Encoder.SBMAX_s; sfb++) {\n                cod_info.width[j] = cod_info.width[j + 1] = cod_info.width[j + 2] = gfc.scalefac_band.s[sfb + 1]\n                    - gfc.scalefac_band.s[sfb];\n                cod_info.window[j] = 0;\n                cod_info.window[j + 1] = 1;\n                cod_info.window[j + 2] = 2;\n                j += 3;\n            }\n        }\n\n        cod_info.count1bits = 0;\n        cod_info.sfb_partition_table = qupvt.nr_of_sfb_block[0][0];\n        cod_info.slen[0] = 0;\n        cod_info.slen[1] = 0;\n        cod_info.slen[2] = 0;\n        cod_info.slen[3] = 0;\n\n        cod_info.max_nonzero_coeff = 575;\n\n        /*\n         * fresh scalefactors are all zero\n         */\n        Arrays.fill(cod_info.scalefac, 0);\n\n        psfb21_analogsilence(gfc, cod_info);\n    };\n\n    function BinSearchDirection(ordinal) {\n        this.ordinal = ordinal;\n    }\n\n    BinSearchDirection.BINSEARCH_NONE = new BinSearchDirection(0);\n    BinSearchDirection.BINSEARCH_UP = new BinSearchDirection(1);\n    BinSearchDirection.BINSEARCH_DOWN = new BinSearchDirection(2);\n\n    /**\n     * author/date??\n     *\n     * binary step size search used by outer_loop to get a quantizer step size\n     * to start with\n     */\n    function bin_search_StepSize(gfc, cod_info, desired_rate, ch, xrpow) {\n        var nBits;\n        var CurrentStep = gfc.CurrentStep[ch];\n        var flagGoneOver = false;\n        var start = gfc.OldValue[ch];\n        var Direction = BinSearchDirection.BINSEARCH_NONE;\n        cod_info.global_gain = start;\n        desired_rate -= cod_info.part2_length;\n\n        for (; ;) {\n            var step;\n            nBits = tk.count_bits(gfc, xrpow, cod_info, null);\n\n            if (CurrentStep == 1 || nBits == desired_rate)\n                break;\n            /* nothing to adjust anymore */\n\n            if (nBits > desired_rate) {\n                /* increase Quantize_StepSize */\n                if (Direction == BinSearchDirection.BINSEARCH_DOWN)\n                    flagGoneOver = true;\n\n                if (flagGoneOver)\n                    CurrentStep /= 2;\n                Direction = BinSearchDirection.BINSEARCH_UP;\n                step = CurrentStep;\n            } else {\n                /* decrease Quantize_StepSize */\n                if (Direction == BinSearchDirection.BINSEARCH_UP)\n                    flagGoneOver = true;\n\n                if (flagGoneOver)\n                    CurrentStep /= 2;\n                Direction = BinSearchDirection.BINSEARCH_DOWN;\n                step = -CurrentStep;\n            }\n            cod_info.global_gain += step;\n            if (cod_info.global_gain < 0) {\n                cod_info.global_gain = 0;\n                flagGoneOver = true;\n            }\n            if (cod_info.global_gain > 255) {\n                cod_info.global_gain = 255;\n                flagGoneOver = true;\n            }\n        }\n\n\n        while (nBits > desired_rate && cod_info.global_gain < 255) {\n            cod_info.global_gain++;\n            nBits = tk.count_bits(gfc, xrpow, cod_info, null);\n        }\n        gfc.CurrentStep[ch] = (start - cod_info.global_gain >= 4) ? 4 : 2;\n        gfc.OldValue[ch] = cod_info.global_gain;\n        cod_info.part2_3_length = nBits;\n        return nBits;\n    }\n\n    this.trancate_smallspectrums = function (gfc, gi, l3_xmin, work) {\n        var distort = new_float(L3Side.SFBMAX);\n\n        if ((0 == (gfc.substep_shaping & 4) && gi.block_type == Encoder.SHORT_TYPE)\n            || (gfc.substep_shaping & 0x80) != 0)\n            return;\n        qupvt.calc_noise(gi, l3_xmin, distort, new CalcNoiseResult(), null);\n        for (var j = 0; j < 576; j++) {\n            var xr = 0.0;\n            if (gi.l3_enc[j] != 0)\n                xr = Math.abs(gi.xr[j]);\n            work[j] = xr;\n        }\n\n        var j = 0;\n        var sfb = 8;\n        if (gi.block_type == Encoder.SHORT_TYPE)\n            sfb = 6;\n        do {\n            var allowedNoise, trancateThreshold;\n            var nsame, start;\n\n            var width = gi.width[sfb];\n            j += width;\n            if (distort[sfb] >= 1.0)\n                continue;\n\n            Arrays.sort(work, j - width, width);\n            if (BitStream.EQ(work[j - 1], 0.0))\n                continue;\n            /* all zero sfb */\n\n            allowedNoise = (1.0 - distort[sfb]) * l3_xmin[sfb];\n            trancateThreshold = 0.0;\n            start = 0;\n            do {\n                var noise;\n                for (nsame = 1; start + nsame < width; nsame++)\n                    if (BitStream.NEQ(work[start + j - width], work[start + j\n                        + nsame - width]))\n                        break;\n\n                noise = work[start + j - width] * work[start + j - width]\n                    * nsame;\n                if (allowedNoise < noise) {\n                    if (start != 0)\n                        trancateThreshold = work[start + j - width - 1];\n                    break;\n                }\n                allowedNoise -= noise;\n                start += nsame;\n            } while (start < width);\n            if (BitStream.EQ(trancateThreshold, 0.0))\n                continue;\n\n            do {\n                if (Math.abs(gi.xr[j - width]) <= trancateThreshold)\n                    gi.l3_enc[j - width] = 0;\n            } while (--width > 0);\n        } while (++sfb < gi.psymax);\n\n        gi.part2_3_length = tk.noquant_count_bits(gfc, gi, null);\n    };\n\n    /**\n     * author/date??\n     *\n     * Function: Returns zero if there is a scalefac which has not been\n     * amplified. Otherwise it returns one.\n     */\n    function loop_break(cod_info) {\n        for (var sfb = 0; sfb < cod_info.sfbmax; sfb++)\n            if (cod_info.scalefac[sfb]\n                + cod_info.subblock_gain[cod_info.window[sfb]] == 0)\n                return false;\n\n        return true;\n    }\n\n    /* mt 5/99: Function: Improved calc_noise for a single channel */\n\n    function penalties(noise) {\n        return Util.FAST_LOG10((0.368 + 0.632 * noise * noise * noise));\n    }\n\n    /**\n     * author/date??\n     *\n     * several different codes to decide which quantization is better\n     */\n    function get_klemm_noise(distort, gi) {\n        var klemm_noise = 1E-37;\n        for (var sfb = 0; sfb < gi.psymax; sfb++)\n            klemm_noise += penalties(distort[sfb]);\n\n        return Math.max(1e-20, klemm_noise);\n    }\n\n    function quant_compare(quant_comp, best, calc, gi, distort) {\n        /**\n         * noise is given in decibels (dB) relative to masking thesholds.<BR>\n         *\n         * over_noise: ??? (the previous comment is fully wrong)<BR>\n         * tot_noise: ??? (the previous comment is fully wrong)<BR>\n         * max_noise: max quantization noise\n         */\n        var better;\n\n        switch (quant_comp) {\n            default:\n            case 9:\n            {\n                if (best.over_count > 0) {\n                    /* there are distorted sfb */\n                    better = calc.over_SSD <= best.over_SSD;\n                    if (calc.over_SSD == best.over_SSD)\n                        better = calc.bits < best.bits;\n                } else {\n                    /* no distorted sfb */\n                    better = ((calc.max_noise < 0) && ((calc.max_noise * 10 + calc.bits) <= (best.max_noise * 10 + best.bits)));\n                }\n                break;\n            }\n\n            case 0:\n                better = calc.over_count < best.over_count\n                    || (calc.over_count == best.over_count && calc.over_noise < best.over_noise)\n                    || (calc.over_count == best.over_count\n                    && BitStream.EQ(calc.over_noise, best.over_noise) && calc.tot_noise < best.tot_noise);\n                break;\n\n            case 8:\n                calc.max_noise = get_klemm_noise(distort, gi);\n            //$FALL-THROUGH$\n            case 1:\n                better = calc.max_noise < best.max_noise;\n                break;\n            case 2:\n                better = calc.tot_noise < best.tot_noise;\n                break;\n            case 3:\n                better = (calc.tot_noise < best.tot_noise)\n                    && (calc.max_noise < best.max_noise);\n                break;\n            case 4:\n                better = (calc.max_noise <= 0.0 && best.max_noise > 0.2)\n                    || (calc.max_noise <= 0.0 && best.max_noise < 0.0\n                    && best.max_noise > calc.max_noise - 0.2 && calc.tot_noise < best.tot_noise)\n                    || (calc.max_noise <= 0.0 && best.max_noise > 0.0\n                    && best.max_noise > calc.max_noise - 0.2 && calc.tot_noise < best.tot_noise\n                    + best.over_noise)\n                    || (calc.max_noise > 0.0 && best.max_noise > -0.05\n                    && best.max_noise > calc.max_noise - 0.1 && calc.tot_noise\n                    + calc.over_noise < best.tot_noise\n                    + best.over_noise)\n                    || (calc.max_noise > 0.0 && best.max_noise > -0.1\n                    && best.max_noise > calc.max_noise - 0.15 && calc.tot_noise\n                    + calc.over_noise + calc.over_noise < best.tot_noise\n                    + best.over_noise + best.over_noise);\n                break;\n            case 5:\n                better = calc.over_noise < best.over_noise\n                    || (BitStream.EQ(calc.over_noise, best.over_noise) && calc.tot_noise < best.tot_noise);\n                break;\n            case 6:\n                better = calc.over_noise < best.over_noise\n                    || (BitStream.EQ(calc.over_noise, best.over_noise) && (calc.max_noise < best.max_noise || (BitStream\n                        .EQ(calc.max_noise, best.max_noise) && calc.tot_noise <= best.tot_noise)));\n                break;\n            case 7:\n                better = calc.over_count < best.over_count\n                    || calc.over_noise < best.over_noise;\n                break;\n        }\n\n        if (best.over_count == 0) {\n            /*\n             * If no distorted bands, only use this quantization if it is\n             * better, and if it uses less bits. Unfortunately, part2_3_length\n             * is sometimes a poor estimator of the final size at low bitrates.\n             */\n            better = better && calc.bits < best.bits;\n        }\n\n        return better;\n    }\n\n    /**\n     * author/date??\n     *\n     * <PRE>\n     *  Amplify the scalefactor bands that violate the masking threshold.\n     *  See ISO 11172-3 Section C.1.5.4.3.5\n     *\n     *  distort[] = noise/masking\n     *  distort[] > 1   ==> noise is not masked\n     *  distort[] < 1   ==> noise is masked\n     *  max_dist = maximum value of distort[]\n     *\n     *  Three algorithms:\n     *  noise_shaping_amp\n     *        0             Amplify all bands with distort[]>1.\n     *\n     *        1             Amplify all bands with distort[] >= max_dist^(.5);\n     *                     ( 50% in the db scale)\n     *\n     *        2             Amplify first band with distort[] >= max_dist;\n     *\n     *\n     *  For algorithms 0 and 1, if max_dist < 1, then amplify all bands\n     *  with distort[] >= .95*max_dist.  This is to make sure we always\n     *  amplify at least one band.\n     * </PRE>\n     */\n    function amp_scalefac_bands(gfp, cod_info, distort, xrpow, bRefine) {\n        var gfc = gfp.internal_flags;\n        var ifqstep34;\n\n        if (cod_info.scalefac_scale == 0) {\n            ifqstep34 = 1.29683955465100964055;\n            /* 2**(.75*.5) */\n        } else {\n            ifqstep34 = 1.68179283050742922612;\n            /* 2**(.75*1) */\n        }\n\n        /* compute maximum value of distort[] */\n        var trigger = 0;\n        for (var sfb = 0; sfb < cod_info.sfbmax; sfb++) {\n            if (trigger < distort[sfb])\n                trigger = distort[sfb];\n        }\n\n        var noise_shaping_amp = gfc.noise_shaping_amp;\n        if (noise_shaping_amp == 3) {\n            if (bRefine)\n                noise_shaping_amp = 2;\n            else\n                noise_shaping_amp = 1;\n        }\n        switch (noise_shaping_amp) {\n            case 2:\n                /* amplify exactly 1 band */\n                break;\n\n            case 1:\n                /* amplify bands within 50% of max (on db scale) */\n                if (trigger > 1.0)\n                    trigger = Math.pow(trigger, .5);\n                else\n                    trigger *= .95;\n                break;\n\n            case 0:\n            default:\n                /* ISO algorithm. amplify all bands with distort>1 */\n                if (trigger > 1.0)\n                    trigger = 1.0;\n                else\n                    trigger *= .95;\n                break;\n        }\n\n        var j = 0;\n        for (var sfb = 0; sfb < cod_info.sfbmax; sfb++) {\n            var width = cod_info.width[sfb];\n            var l;\n            j += width;\n            if (distort[sfb] < trigger)\n                continue;\n\n            if ((gfc.substep_shaping & 2) != 0) {\n                gfc.pseudohalf[sfb] = (0 == gfc.pseudohalf[sfb]) ? 1 : 0;\n                if (0 == gfc.pseudohalf[sfb] && gfc.noise_shaping_amp == 2)\n                    return;\n            }\n            cod_info.scalefac[sfb]++;\n            for (l = -width; l < 0; l++) {\n                xrpow[j + l] *= ifqstep34;\n                if (xrpow[j + l] > cod_info.xrpow_max)\n                    cod_info.xrpow_max = xrpow[j + l];\n            }\n\n            if (gfc.noise_shaping_amp == 2)\n                return;\n        }\n    }\n\n    /**\n     * Takehiro Tominaga 2000-xx-xx\n     *\n     * turns on scalefac scale and adjusts scalefactors\n     */\n    function inc_scalefac_scale(cod_info, xrpow) {\n        var ifqstep34 = 1.29683955465100964055;\n\n        var j = 0;\n        for (var sfb = 0; sfb < cod_info.sfbmax; sfb++) {\n            var width = cod_info.width[sfb];\n            var s = cod_info.scalefac[sfb];\n            if (cod_info.preflag != 0)\n                s += qupvt.pretab[sfb];\n            j += width;\n            if ((s & 1) != 0) {\n                s++;\n                for (var l = -width; l < 0; l++) {\n                    xrpow[j + l] *= ifqstep34;\n                    if (xrpow[j + l] > cod_info.xrpow_max)\n                        cod_info.xrpow_max = xrpow[j + l];\n                }\n            }\n            cod_info.scalefac[sfb] = s >> 1;\n        }\n        cod_info.preflag = 0;\n        cod_info.scalefac_scale = 1;\n    }\n\n    /**\n     * Takehiro Tominaga 2000-xx-xx\n     *\n     * increases the subblock gain and adjusts scalefactors\n     */\n    function inc_subblock_gain(gfc, cod_info, xrpow) {\n        var sfb;\n        var scalefac = cod_info.scalefac;\n\n        /* subbloc_gain can't do anything in the long block region */\n        for (sfb = 0; sfb < cod_info.sfb_lmax; sfb++) {\n            if (scalefac[sfb] >= 16)\n                return true;\n        }\n\n        for (var window = 0; window < 3; window++) {\n            var s1 = 0;\n            var s2 = 0;\n\n            for (sfb = cod_info.sfb_lmax + window; sfb < cod_info.sfbdivide; sfb += 3) {\n                if (s1 < scalefac[sfb])\n                    s1 = scalefac[sfb];\n            }\n            for (; sfb < cod_info.sfbmax; sfb += 3) {\n                if (s2 < scalefac[sfb])\n                    s2 = scalefac[sfb];\n            }\n\n            if (s1 < 16 && s2 < 8)\n                continue;\n\n            if (cod_info.subblock_gain[window] >= 7)\n                return true;\n\n            /*\n             * even though there is no scalefactor for sfb12 subblock gain\n             * affects upper frequencies too, that's why we have to go up to\n             * SBMAX_s\n             */\n            cod_info.subblock_gain[window]++;\n            var j = gfc.scalefac_band.l[cod_info.sfb_lmax];\n            for (sfb = cod_info.sfb_lmax + window; sfb < cod_info.sfbmax; sfb += 3) {\n                var amp;\n                var width = cod_info.width[sfb];\n                var s = scalefac[sfb];\n                s = s - (4 >> cod_info.scalefac_scale);\n                if (s >= 0) {\n                    scalefac[sfb] = s;\n                    j += width * 3;\n                    continue;\n                }\n\n                scalefac[sfb] = 0;\n                {\n                    var gain = 210 + (s << (cod_info.scalefac_scale + 1));\n                    amp = qupvt.IPOW20(gain);\n                }\n                j += width * (window + 1);\n                for (var l = -width; l < 0; l++) {\n                    xrpow[j + l] *= amp;\n                    if (xrpow[j + l] > cod_info.xrpow_max)\n                        cod_info.xrpow_max = xrpow[j + l];\n                }\n                j += width * (3 - window - 1);\n            }\n\n            {\n                var amp = qupvt.IPOW20(202);\n                j += cod_info.width[sfb] * (window + 1);\n                for (var l = -cod_info.width[sfb]; l < 0; l++) {\n                    xrpow[j + l] *= amp;\n                    if (xrpow[j + l] > cod_info.xrpow_max)\n                        cod_info.xrpow_max = xrpow[j + l];\n                }\n            }\n        }\n        return false;\n    }\n\n    /**\n     * <PRE>\n     *  Takehiro Tominaga /date??\n     *  Robert Hegemann 2000-09-06: made a function of it\n     *\n     *  amplifies scalefactor bands,\n     *   - if all are already amplified returns 0\n     *   - if some bands are amplified too much:\n     *      * try to increase scalefac_scale\n     *      * if already scalefac_scale was set\n     *          try on short blocks to increase subblock gain\n     * </PRE>\n     */\n    function balance_noise(gfp, cod_info, distort, xrpow, bRefine) {\n        var gfc = gfp.internal_flags;\n\n        amp_scalefac_bands(gfp, cod_info, distort, xrpow, bRefine);\n\n        /*\n         * check to make sure we have not amplified too much loop_break returns\n         * 0 if there is an unamplified scalefac scale_bitcount returns 0 if no\n         * scalefactors are too large\n         */\n\n        var status = loop_break(cod_info);\n\n        if (status)\n            return false;\n        /* all bands amplified */\n\n        /*\n         * not all scalefactors have been amplified. so these scalefacs are\n         * possibly valid. encode them:\n         */\n        if (gfc.mode_gr == 2)\n            status = tk.scale_bitcount(cod_info);\n        else\n            status = tk.scale_bitcount_lsf(gfc, cod_info);\n\n        if (!status)\n            return true;\n        /* amplified some bands not exceeding limits */\n\n        /*\n         * some scalefactors are too large. lets try setting scalefac_scale=1\n         */\n        if (gfc.noise_shaping > 1) {\n            Arrays.fill(gfc.pseudohalf, 0);\n            if (0 == cod_info.scalefac_scale) {\n                inc_scalefac_scale(cod_info, xrpow);\n                status = false;\n            } else {\n                if (cod_info.block_type == Encoder.SHORT_TYPE\n                    && gfc.subblock_gain > 0) {\n                    status = (inc_subblock_gain(gfc, cod_info, xrpow) || loop_break(cod_info));\n                }\n            }\n        }\n\n        if (!status) {\n            if (gfc.mode_gr == 2)\n                status = tk.scale_bitcount(cod_info);\n            else\n                status = tk.scale_bitcount_lsf(gfc, cod_info);\n        }\n        return !status;\n    }\n\n    /**\n     * <PRE>\n     *  Function: The outer iteration loop controls the masking conditions\n     *  of all scalefactorbands. It computes the best scalefac and\n     *  global gain. This module calls the inner iteration loop\n     *\n     *  mt 5/99 completely rewritten to allow for bit reservoir control,\n     *  mid/side channels with L/R or mid/side masking thresholds,\n     *  and chooses best quantization instead of last quantization when\n     *  no distortion free quantization can be found.\n     *\n     *  added VBR support mt 5/99\n\n     *\n     *  some code shuffle rh 9/00\n     * </PRE>\n     *\n     * @param l3_xmin\n     *            allowed distortion\n     * @param xrpow\n     *            coloured magnitudes of spectral\n     * @param targ_bits\n     *            maximum allowed bits\n     */\n    this.outer_loop = function (gfp, cod_info, l3_xmin, xrpow, ch, targ_bits) {\n        var gfc = gfp.internal_flags;\n        var cod_info_w = new GrInfo();\n        var save_xrpow = new_float(576);\n        var distort = new_float(L3Side.SFBMAX);\n        var best_noise_info = new CalcNoiseResult();\n        var better;\n        var prev_noise = new CalcNoiseData();\n        var best_part2_3_length = 9999999;\n        var bEndOfSearch = false;\n        var bRefine = false;\n        var best_ggain_pass1 = 0;\n\n        bin_search_StepSize(gfc, cod_info, targ_bits, ch, xrpow);\n\n        if (0 == gfc.noise_shaping)\n        /* fast mode, no noise shaping, we are ready */\n            return 100;\n        /* default noise_info.over_count */\n\n        /* compute the distortion in this quantization */\n        /* coefficients and thresholds both l/r (or both mid/side) */\n        qupvt.calc_noise(cod_info, l3_xmin, distort, best_noise_info,\n            prev_noise);\n        best_noise_info.bits = cod_info.part2_3_length;\n\n        cod_info_w.assign(cod_info);\n        var age = 0;\n        System.arraycopy(xrpow, 0, save_xrpow, 0, 576);\n\n        while (!bEndOfSearch) {\n            /* BEGIN MAIN LOOP */\n            do {\n                var noise_info = new CalcNoiseResult();\n                var search_limit;\n                var maxggain = 255;\n\n                /*\n                 * When quantization with no distorted bands is found, allow up\n                 * to X new unsuccesful tries in serial. This gives us more\n                 * possibilities for different quant_compare modes. Much more\n                 * than 3 makes not a big difference, it is only slower.\n                 */\n\n                if ((gfc.substep_shaping & 2) != 0) {\n                    search_limit = 20;\n                } else {\n                    search_limit = 3;\n                }\n\n                /*\n                 * Check if the last scalefactor band is distorted. in VBR mode\n                 * we can't get rid of the distortion, so quit now and VBR mode\n                 * will try again with more bits. (makes a 10% speed increase,\n                 * the files I tested were binary identical, 2000/05/20 Robert\n                 * Hegemann) distort[] > 1 means noise > allowed noise\n                 */\n                if (gfc.sfb21_extra) {\n                    if (distort[cod_info_w.sfbmax] > 1.0)\n                        break;\n                    if (cod_info_w.block_type == Encoder.SHORT_TYPE\n                        && (distort[cod_info_w.sfbmax + 1] > 1.0 || distort[cod_info_w.sfbmax + 2] > 1.0))\n                        break;\n                }\n\n                /* try a new scalefactor conbination on cod_info_w */\n                if (!balance_noise(gfp, cod_info_w, distort, xrpow, bRefine))\n                    break;\n                if (cod_info_w.scalefac_scale != 0)\n                    maxggain = 254;\n\n                /*\n                 * inner_loop starts with the initial quantization step computed\n                 * above and slowly increases until the bits < huff_bits. Thus\n                 * it is important not to start with too large of an inital\n                 * quantization step. Too small is ok, but inner_loop will take\n                 * longer\n                 */\n                var huff_bits = targ_bits - cod_info_w.part2_length;\n                if (huff_bits <= 0)\n                    break;\n\n                /*\n                 * increase quantizer stepsize until needed bits are below\n                 * maximum\n                 */\n                while ((cod_info_w.part2_3_length = tk.count_bits(gfc, xrpow,\n                    cod_info_w, prev_noise)) > huff_bits\n                && cod_info_w.global_gain <= maxggain)\n                    cod_info_w.global_gain++;\n\n                if (cod_info_w.global_gain > maxggain)\n                    break;\n\n                if (best_noise_info.over_count == 0) {\n\n                    while ((cod_info_w.part2_3_length = tk.count_bits(gfc,\n                        xrpow, cod_info_w, prev_noise)) > best_part2_3_length\n                    && cod_info_w.global_gain <= maxggain)\n                        cod_info_w.global_gain++;\n\n                    if (cod_info_w.global_gain > maxggain)\n                        break;\n                }\n\n                /* compute the distortion in this quantization */\n                qupvt.calc_noise(cod_info_w, l3_xmin, distort, noise_info,\n                    prev_noise);\n                noise_info.bits = cod_info_w.part2_3_length;\n\n                /*\n                 * check if this quantization is better than our saved\n                 * quantization\n                 */\n                if (cod_info.block_type != Encoder.SHORT_TYPE) {\n                    // NORM, START or STOP type\n                    better = gfp.quant_comp;\n                } else\n                    better = gfp.quant_comp_short;\n\n                better = quant_compare(better, best_noise_info, noise_info,\n                    cod_info_w, distort) ? 1 : 0;\n\n                /* save data so we can restore this quantization later */\n                if (better != 0) {\n                    best_part2_3_length = cod_info.part2_3_length;\n                    best_noise_info = noise_info;\n                    cod_info.assign(cod_info_w);\n                    age = 0;\n                    /* save data so we can restore this quantization later */\n                    /* store for later reuse */\n                    System.arraycopy(xrpow, 0, save_xrpow, 0, 576);\n                } else {\n                    /* early stop? */\n                    if (gfc.full_outer_loop == 0) {\n                        if (++age > search_limit\n                            && best_noise_info.over_count == 0)\n                            break;\n                        if ((gfc.noise_shaping_amp == 3) && bRefine && age > 30)\n                            break;\n                        if ((gfc.noise_shaping_amp == 3)\n                            && bRefine\n                            && (cod_info_w.global_gain - best_ggain_pass1) > 15)\n                            break;\n                    }\n                }\n            } while ((cod_info_w.global_gain + cod_info_w.scalefac_scale) < 255);\n\n            if (gfc.noise_shaping_amp == 3) {\n                if (!bRefine) {\n                    /* refine search */\n                    cod_info_w.assign(cod_info);\n                    System.arraycopy(save_xrpow, 0, xrpow, 0, 576);\n                    age = 0;\n                    best_ggain_pass1 = cod_info_w.global_gain;\n\n                    bRefine = true;\n                } else {\n                    /* search already refined, stop */\n                    bEndOfSearch = true;\n                }\n\n            } else {\n                bEndOfSearch = true;\n            }\n        }\n\n        /*\n         * finish up\n         */\n        if (gfp.VBR == VbrMode.vbr_rh || gfp.VBR == VbrMode.vbr_mtrh)\n        /* restore for reuse on next try */\n            System.arraycopy(save_xrpow, 0, xrpow, 0, 576);\n        /*\n         * do the 'substep shaping'\n         */\n        else if ((gfc.substep_shaping & 1) != 0)\n            trancate_smallspectrums(gfc, cod_info, l3_xmin, xrpow);\n\n        return best_noise_info.over_count;\n    }\n\n    /**\n     * Robert Hegemann 2000-09-06\n     *\n     * update reservoir status after FINAL quantization/bitrate\n     */\n    this.iteration_finish_one = function (gfc, gr, ch) {\n        var l3_side = gfc.l3_side;\n        var cod_info = l3_side.tt[gr][ch];\n\n        /*\n         * try some better scalefac storage\n         */\n        tk.best_scalefac_store(gfc, gr, ch, l3_side);\n\n        /*\n         * best huffman_divide may save some bits too\n         */\n        if (gfc.use_best_huffman == 1)\n            tk.best_huffman_divide(gfc, cod_info);\n\n        /*\n         * update reservoir status after FINAL quantization/bitrate\n         */\n        rv.ResvAdjust(gfc, cod_info);\n    };\n\n    /**\n     *\n     * 2000-09-04 Robert Hegemann\n     *\n     * @param l3_xmin\n     *            allowed distortion of the scalefactor\n     * @param xrpow\n     *            coloured magnitudes of spectral values\n     */\n    this.VBR_encode_granule = function (gfp, cod_info, l3_xmin, xrpow, ch, min_bits, max_bits) {\n        var gfc = gfp.internal_flags;\n        var bst_cod_info = new GrInfo();\n        var bst_xrpow = new_float(576);\n        var Max_bits = max_bits;\n        var real_bits = max_bits + 1;\n        var this_bits = (max_bits + min_bits) / 2;\n        var dbits, over, found = 0;\n        var sfb21_extra = gfc.sfb21_extra;\n\n        Arrays.fill(bst_cod_info.l3_enc, 0);\n\n        /*\n         * search within round about 40 bits of optimal\n         */\n        do {\n\n            if (this_bits > Max_bits - 42)\n                gfc.sfb21_extra = false;\n            else\n                gfc.sfb21_extra = sfb21_extra;\n\n            over = outer_loop(gfp, cod_info, l3_xmin, xrpow, ch, this_bits);\n\n            /*\n             * is quantization as good as we are looking for ? in this case: is\n             * no scalefactor band distorted?\n             */\n            if (over <= 0) {\n                found = 1;\n                /*\n                 * now we know it can be done with \"real_bits\" and maybe we can\n                 * skip some iterations\n                 */\n                real_bits = cod_info.part2_3_length;\n\n                /*\n                 * store best quantization so far\n                 */\n                bst_cod_info.assign(cod_info);\n                System.arraycopy(xrpow, 0, bst_xrpow, 0, 576);\n\n                /*\n                 * try with fewer bits\n                 */\n                max_bits = real_bits - 32;\n                dbits = max_bits - min_bits;\n                this_bits = (max_bits + min_bits) / 2;\n            } else {\n                /*\n                 * try with more bits\n                 */\n                min_bits = this_bits + 32;\n                dbits = max_bits - min_bits;\n                this_bits = (max_bits + min_bits) / 2;\n\n                if (found != 0) {\n                    found = 2;\n                    /*\n                     * start again with best quantization so far\n                     */\n                    cod_info.assign(bst_cod_info);\n                    System.arraycopy(bst_xrpow, 0, xrpow, 0, 576);\n                }\n            }\n        } while (dbits > 12);\n\n        gfc.sfb21_extra = sfb21_extra;\n\n        /*\n         * found=0 => nothing found, use last one found=1 => we just found the\n         * best and left the loop found=2 => we restored a good one and have now\n         * l3_enc to restore too\n         */\n        if (found == 2) {\n            System.arraycopy(bst_cod_info.l3_enc, 0, cod_info.l3_enc, 0, 576);\n        }\n    }\n\n    /**\n     * Robert Hegemann 2000-09-05\n     *\n     * calculates * how many bits are available for analog silent granules * how\n     * many bits to use for the lowest allowed bitrate * how many bits each\n     * bitrate would provide\n     */\n    this.get_framebits = function (gfp, frameBits) {\n        var gfc = gfp.internal_flags;\n\n        /*\n         * always use at least this many bits per granule per channel unless we\n         * detect analog silence, see below\n         */\n        gfc.bitrate_index = gfc.VBR_min_bitrate;\n        var bitsPerFrame = bs.getframebits(gfp);\n\n        /*\n         * bits for analog silence\n         */\n        gfc.bitrate_index = 1;\n        bitsPerFrame = bs.getframebits(gfp);\n\n        for (var i = 1; i <= gfc.VBR_max_bitrate; i++) {\n            gfc.bitrate_index = i;\n            var mb = new MeanBits(bitsPerFrame);\n            frameBits[i] = rv.ResvFrameBegin(gfp, mb);\n            bitsPerFrame = mb.bits;\n        }\n    };\n\n    /* RH: this one needs to be overhauled sometime */\n\n    /**\n     * <PRE>\n     *  2000-09-04 Robert Hegemann\n     *\n     *  * converts LR to MS coding when necessary\n     *  * calculates allowed/adjusted quantization noise amounts\n     *  * detects analog silent frames\n     *\n     *  some remarks:\n     *  - lower masking depending on Quality setting\n     *  - quality control together with adjusted ATH MDCT scaling\n     *    on lower quality setting allocate more noise from\n     *    ATH masking, and on higher quality setting allocate\n     *    less noise from ATH masking.\n     *  - experiments show that going more than 2dB over GPSYCHO's\n     *    limits ends up in very annoying artefacts\n     * </PRE>\n     */\n    this.VBR_old_prepare = function (gfp, pe, ms_ener_ratio, ratio, l3_xmin, frameBits, min_bits,\n                                     max_bits, bands) {\n        var gfc = gfp.internal_flags;\n\n        var masking_lower_db, adjust = 0.0;\n        var analog_silence = 1;\n        var bits = 0;\n\n        gfc.bitrate_index = gfc.VBR_max_bitrate;\n        var avg = rv.ResvFrameBegin(gfp, new MeanBits(0)) / gfc.mode_gr;\n\n        get_framebits(gfp, frameBits);\n\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            var mxb = qupvt.on_pe(gfp, pe, max_bits[gr], avg, gr, 0);\n            if (gfc.mode_ext == Encoder.MPG_MD_MS_LR) {\n                ms_convert(gfc.l3_side, gr);\n                qupvt.reduce_side(max_bits[gr], ms_ener_ratio[gr], avg, mxb);\n            }\n            for (var ch = 0; ch < gfc.channels_out; ++ch) {\n                var cod_info = gfc.l3_side.tt[gr][ch];\n\n                if (cod_info.block_type != Encoder.SHORT_TYPE) {\n                    // NORM, START or STOP type\n                    adjust = 1.28 / (1 + Math\n                            .exp(3.5 - pe[gr][ch] / 300.)) - 0.05;\n                    masking_lower_db = gfc.PSY.mask_adjust - adjust;\n                } else {\n                    adjust = 2.56 / (1 + Math\n                            .exp(3.5 - pe[gr][ch] / 300.)) - 0.14;\n                    masking_lower_db = gfc.PSY.mask_adjust_short - adjust;\n                }\n                gfc.masking_lower = Math.pow(10.0,\n                    masking_lower_db * 0.1);\n\n                init_outer_loop(gfc, cod_info);\n                bands[gr][ch] = qupvt.calc_xmin(gfp, ratio[gr][ch], cod_info,\n                    l3_xmin[gr][ch]);\n                if (bands[gr][ch] != 0)\n                    analog_silence = 0;\n\n                min_bits[gr][ch] = 126;\n\n                bits += max_bits[gr][ch];\n            }\n        }\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            for (var ch = 0; ch < gfc.channels_out; ch++) {\n                if (bits > frameBits[gfc.VBR_max_bitrate]) {\n                    max_bits[gr][ch] *= frameBits[gfc.VBR_max_bitrate];\n                    max_bits[gr][ch] /= bits;\n                }\n                if (min_bits[gr][ch] > max_bits[gr][ch])\n                    min_bits[gr][ch] = max_bits[gr][ch];\n\n            }\n            /* for ch */\n        }\n        /* for gr */\n\n        return analog_silence;\n    };\n\n    this.bitpressure_strategy = function (gfc, l3_xmin, min_bits, max_bits) {\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            for (var ch = 0; ch < gfc.channels_out; ch++) {\n                var gi = gfc.l3_side.tt[gr][ch];\n                var pxmin = l3_xmin[gr][ch];\n                var pxminPos = 0;\n                for (var sfb = 0; sfb < gi.psy_lmax; sfb++)\n                    pxmin[pxminPos++] *= 1. + .029 * sfb * sfb\n                        / Encoder.SBMAX_l / Encoder.SBMAX_l;\n\n                if (gi.block_type == Encoder.SHORT_TYPE) {\n                    for (var sfb = gi.sfb_smin; sfb < Encoder.SBMAX_s; sfb++) {\n                        pxmin[pxminPos++] *= 1. + .029 * sfb * sfb\n                            / Encoder.SBMAX_s / Encoder.SBMAX_s;\n                        pxmin[pxminPos++] *= 1. + .029 * sfb * sfb\n                            / Encoder.SBMAX_s / Encoder.SBMAX_s;\n                        pxmin[pxminPos++] *= 1. + .029 * sfb * sfb\n                            / Encoder.SBMAX_s / Encoder.SBMAX_s;\n                    }\n                }\n                max_bits[gr][ch] = 0 | Math.max(min_bits[gr][ch],\n                        0.9 * max_bits[gr][ch]);\n            }\n        }\n    };\n\n    this.VBR_new_prepare = function (gfp, pe, ratio, l3_xmin, frameBits, max_bits) {\n        var gfc = gfp.internal_flags;\n\n        var analog_silence = 1;\n        var avg = 0, bits = 0;\n        var maximum_framebits;\n\n        if (!gfp.free_format) {\n            gfc.bitrate_index = gfc.VBR_max_bitrate;\n\n            var mb = new MeanBits(avg);\n            rv.ResvFrameBegin(gfp, mb);\n            avg = mb.bits;\n\n            get_framebits(gfp, frameBits);\n            maximum_framebits = frameBits[gfc.VBR_max_bitrate];\n        } else {\n            gfc.bitrate_index = 0;\n            var mb = new MeanBits(avg);\n            maximum_framebits = rv.ResvFrameBegin(gfp, mb);\n            avg = mb.bits;\n            frameBits[0] = maximum_framebits;\n        }\n\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            qupvt.on_pe(gfp, pe, max_bits[gr], avg, gr, 0);\n            if (gfc.mode_ext == Encoder.MPG_MD_MS_LR) {\n                ms_convert(gfc.l3_side, gr);\n            }\n            for (var ch = 0; ch < gfc.channels_out; ++ch) {\n                var cod_info = gfc.l3_side.tt[gr][ch];\n\n                gfc.masking_lower = Math.pow(10.0,\n                    gfc.PSY.mask_adjust * 0.1);\n\n                init_outer_loop(gfc, cod_info);\n                if (0 != qupvt.calc_xmin(gfp, ratio[gr][ch], cod_info,\n                        l3_xmin[gr][ch]))\n                    analog_silence = 0;\n\n                bits += max_bits[gr][ch];\n            }\n        }\n        for (var gr = 0; gr < gfc.mode_gr; gr++) {\n            for (var ch = 0; ch < gfc.channels_out; ch++) {\n                if (bits > maximum_framebits) {\n                    max_bits[gr][ch] *= maximum_framebits;\n                    max_bits[gr][ch] /= bits;\n                }\n\n            }\n            /* for ch */\n        }\n        /* for gr */\n\n        return analog_silence;\n    };\n\n    /**\n     * calculates target bits for ABR encoding\n     *\n     * mt 2000/05/31\n     */\n    this.calc_target_bits = function (gfp, pe, ms_ener_ratio, targ_bits, analog_silence_bits, max_frame_bits) {\n        var gfc = gfp.internal_flags;\n        var l3_side = gfc.l3_side;\n        var res_factor;\n        var gr, ch, totbits, mean_bits = 0;\n\n        gfc.bitrate_index = gfc.VBR_max_bitrate;\n        var mb = new MeanBits(mean_bits);\n        max_frame_bits[0] = rv.ResvFrameBegin(gfp, mb);\n        mean_bits = mb.bits;\n\n        gfc.bitrate_index = 1;\n        mean_bits = bs.getframebits(gfp) - gfc.sideinfo_len * 8;\n        analog_silence_bits[0] = mean_bits / (gfc.mode_gr * gfc.channels_out);\n\n        mean_bits = gfp.VBR_mean_bitrate_kbps * gfp.framesize * 1000;\n        if ((gfc.substep_shaping & 1) != 0)\n            mean_bits *= 1.09;\n        mean_bits /= gfp.out_samplerate;\n        mean_bits -= gfc.sideinfo_len * 8;\n        mean_bits /= (gfc.mode_gr * gfc.channels_out);\n\n        /**\n         * <PRE>\n         *           res_factor is the percentage of the target bitrate that should\n         *           be used on average.  the remaining bits are added to the\n         *           bitreservoir and used for difficult to encode frames.\n         *\n         *           Since we are tracking the average bitrate, we should adjust\n         *           res_factor \"on the fly\", increasing it if the average bitrate\n         *           is greater than the requested bitrate, and decreasing it\n         *           otherwise.  Reasonable ranges are from .9 to 1.0\n         *\n         *           Until we get the above suggestion working, we use the following\n         *           tuning:\n         *           compression ratio    res_factor\n         *           5.5  (256kbps)         1.0      no need for bitreservoir\n         *           11   (128kbps)         .93      7% held for reservoir\n         *\n         *           with linear interpolation for other values.\n         * </PRE>\n         */\n        res_factor = .93 + .07 * (11.0 - gfp.compression_ratio)\n            / (11.0 - 5.5);\n        if (res_factor < .90)\n            res_factor = .90;\n        if (res_factor > 1.00)\n            res_factor = 1.00;\n\n        for (gr = 0; gr < gfc.mode_gr; gr++) {\n            var sum = 0;\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                targ_bits[gr][ch] = (int)(res_factor * mean_bits);\n\n                if (pe[gr][ch] > 700) {\n                    var add_bits = (int)((pe[gr][ch] - 700) / 1.4);\n\n                    var cod_info = l3_side.tt[gr][ch];\n                    targ_bits[gr][ch] = (int)(res_factor * mean_bits);\n\n                    /* short blocks use a little extra, no matter what the pe */\n                    if (cod_info.block_type == Encoder.SHORT_TYPE) {\n                        if (add_bits < mean_bits / 2)\n                            add_bits = mean_bits / 2;\n                    }\n                    /* at most increase bits by 1.5*average */\n                    if (add_bits > mean_bits * 3 / 2)\n                        add_bits = mean_bits * 3 / 2;\n                    else if (add_bits < 0)\n                        add_bits = 0;\n\n                    targ_bits[gr][ch] += add_bits;\n                }\n                if (targ_bits[gr][ch] > LameInternalFlags.MAX_BITS_PER_CHANNEL) {\n                    targ_bits[gr][ch] = LameInternalFlags.MAX_BITS_PER_CHANNEL;\n                }\n                sum += targ_bits[gr][ch];\n            }\n            /* for ch */\n            if (sum > LameInternalFlags.MAX_BITS_PER_GRANULE) {\n                for (ch = 0; ch < gfc.channels_out; ++ch) {\n                    targ_bits[gr][ch] *= LameInternalFlags.MAX_BITS_PER_GRANULE;\n                    targ_bits[gr][ch] /= sum;\n                }\n            }\n        }\n        /* for gr */\n\n        if (gfc.mode_ext == Encoder.MPG_MD_MS_LR)\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                qupvt.reduce_side(targ_bits[gr], ms_ener_ratio[gr], mean_bits\n                    * gfc.channels_out,\n                    LameInternalFlags.MAX_BITS_PER_GRANULE);\n            }\n\n        /*\n         * sum target bits\n         */\n        totbits = 0;\n        for (gr = 0; gr < gfc.mode_gr; gr++) {\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                if (targ_bits[gr][ch] > LameInternalFlags.MAX_BITS_PER_CHANNEL)\n                    targ_bits[gr][ch] = LameInternalFlags.MAX_BITS_PER_CHANNEL;\n                totbits += targ_bits[gr][ch];\n            }\n        }\n\n        /*\n         * repartion target bits if needed\n         */\n        if (totbits > max_frame_bits[0]) {\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    targ_bits[gr][ch] *= max_frame_bits[0];\n                    targ_bits[gr][ch] /= totbits;\n                }\n            }\n        }\n    }\n\n}\n\n/*\n *      MP3 window subband -> subband filtering -> mdct routine\n *\n *      Copyright (c) 1999-2000 Takehiro Tominaga\n *\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Library General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n/*\n *         Special Thanks to Patrick De Smet for your advices.\n */\n\n/* $Id: NewMDCT.java,v 1.11 2011/05/24 20:48:06 kenchis Exp $ */\n\n//package mp3;\n\n//import java.util.Arrays;\n\n\n\nfunction NewMDCT() {\n\n\tvar enwindow = [\n\t\t\t-4.77e-07 * 0.740951125354959 / 2.384e-06,\n\t\t\t1.03951e-04 * 0.740951125354959 / 2.384e-06,\n\t\t\t9.53674e-04 * 0.740951125354959 / 2.384e-06,\n\t\t\t2.841473e-03 * 0.740951125354959 / 2.384e-06,\n\t\t\t3.5758972e-02 * 0.740951125354959 / 2.384e-06,\n\t\t\t3.401756e-03 * 0.740951125354959 / 2.384e-06,\n\t\t\t9.83715e-04 * 0.740951125354959 / 2.384e-06,\n\t\t\t9.9182e-05 * 0.740951125354959 / 2.384e-06, /* 15 */\n\t\t\t1.2398e-05 * 0.740951125354959 / 2.384e-06,\n\t\t\t1.91212e-04 * 0.740951125354959 / 2.384e-06,\n\t\t\t2.283096e-03 * 0.740951125354959 / 2.384e-06,\n\t\t\t1.6994476e-02 * 0.740951125354959 / 2.384e-06,\n\t\t\t-1.8756866e-02 * 0.740951125354959 / 2.384e-06,\n\t\t\t-2.630711e-03 * 0.740951125354959 / 2.384e-06,\n\t\t\t-2.47478e-04 * 0.740951125354959 / 2.384e-06,\n\t\t\t-1.4782e-05 * 0.740951125354959 / 2.384e-06,\n\t\t\t9.063471690191471e-01, 1.960342806591213e-01,\n\n\t\t\t-4.77e-07 * 0.773010453362737 / 2.384e-06,\n\t\t\t1.05858e-04 * 0.773010453362737 / 2.384e-06,\n\t\t\t9.30786e-04 * 0.773010453362737 / 2.384e-06,\n\t\t\t2.521515e-03 * 0.773010453362737 / 2.384e-06,\n\t\t\t3.5694122e-02 * 0.773010453362737 / 2.384e-06,\n\t\t\t3.643036e-03 * 0.773010453362737 / 2.384e-06,\n\t\t\t9.91821e-04 * 0.773010453362737 / 2.384e-06,\n\t\t\t9.6321e-05 * 0.773010453362737 / 2.384e-06, /* 14 */\n\t\t\t1.1444e-05 * 0.773010453362737 / 2.384e-06,\n\t\t\t1.65462e-04 * 0.773010453362737 / 2.384e-06,\n\t\t\t2.110004e-03 * 0.773010453362737 / 2.384e-06,\n\t\t\t1.6112804e-02 * 0.773010453362737 / 2.384e-06,\n\t\t\t-1.9634247e-02 * 0.773010453362737 / 2.384e-06,\n\t\t\t-2.803326e-03 * 0.773010453362737 / 2.384e-06,\n\t\t\t-2.77042e-04 * 0.773010453362737 / 2.384e-06,\n\t\t\t-1.6689e-05 * 0.773010453362737 / 2.384e-06,\n\t\t\t8.206787908286602e-01, 3.901806440322567e-01,\n\n\t\t\t-4.77e-07 * 0.803207531480645 / 2.384e-06,\n\t\t\t1.07288e-04 * 0.803207531480645 / 2.384e-06,\n\t\t\t9.02653e-04 * 0.803207531480645 / 2.384e-06,\n\t\t\t2.174854e-03 * 0.803207531480645 / 2.384e-06,\n\t\t\t3.5586357e-02 * 0.803207531480645 / 2.384e-06,\n\t\t\t3.858566e-03 * 0.803207531480645 / 2.384e-06,\n\t\t\t9.95159e-04 * 0.803207531480645 / 2.384e-06,\n\t\t\t9.3460e-05 * 0.803207531480645 / 2.384e-06, /* 13 */\n\t\t\t1.0014e-05 * 0.803207531480645 / 2.384e-06,\n\t\t\t1.40190e-04 * 0.803207531480645 / 2.384e-06,\n\t\t\t1.937389e-03 * 0.803207531480645 / 2.384e-06,\n\t\t\t1.5233517e-02 * 0.803207531480645 / 2.384e-06,\n\t\t\t-2.0506859e-02 * 0.803207531480645 / 2.384e-06,\n\t\t\t-2.974033e-03 * 0.803207531480645 / 2.384e-06,\n\t\t\t-3.07560e-04 * 0.803207531480645 / 2.384e-06,\n\t\t\t-1.8120e-05 * 0.803207531480645 / 2.384e-06,\n\t\t\t7.416505462720353e-01, 5.805693545089249e-01,\n\n\t\t\t-4.77e-07 * 0.831469612302545 / 2.384e-06,\n\t\t\t1.08242e-04 * 0.831469612302545 / 2.384e-06,\n\t\t\t8.68797e-04 * 0.831469612302545 / 2.384e-06,\n\t\t\t1.800537e-03 * 0.831469612302545 / 2.384e-06,\n\t\t\t3.5435200e-02 * 0.831469612302545 / 2.384e-06,\n\t\t\t4.049301e-03 * 0.831469612302545 / 2.384e-06,\n\t\t\t9.94205e-04 * 0.831469612302545 / 2.384e-06,\n\t\t\t9.0599e-05 * 0.831469612302545 / 2.384e-06, /* 12 */\n\t\t\t9.060e-06 * 0.831469612302545 / 2.384e-06,\n\t\t\t1.16348e-04 * 0.831469612302545 / 2.384e-06,\n\t\t\t1.766682e-03 * 0.831469612302545 / 2.384e-06,\n\t\t\t1.4358521e-02 * 0.831469612302545 / 2.384e-06,\n\t\t\t-2.1372318e-02 * 0.831469612302545 / 2.384e-06,\n\t\t\t-3.14188e-03 * 0.831469612302545 / 2.384e-06,\n\t\t\t-3.39031e-04 * 0.831469612302545 / 2.384e-06,\n\t\t\t-1.9550e-05 * 0.831469612302545 / 2.384e-06,\n\t\t\t6.681786379192989e-01, 7.653668647301797e-01,\n\n\t\t\t-4.77e-07 * 0.857728610000272 / 2.384e-06,\n\t\t\t1.08719e-04 * 0.857728610000272 / 2.384e-06,\n\t\t\t8.29220e-04 * 0.857728610000272 / 2.384e-06,\n\t\t\t1.399517e-03 * 0.857728610000272 / 2.384e-06,\n\t\t\t3.5242081e-02 * 0.857728610000272 / 2.384e-06,\n\t\t\t4.215240e-03 * 0.857728610000272 / 2.384e-06,\n\t\t\t9.89437e-04 * 0.857728610000272 / 2.384e-06,\n\t\t\t8.7261e-05 * 0.857728610000272 / 2.384e-06, /* 11 */\n\t\t\t8.106e-06 * 0.857728610000272 / 2.384e-06,\n\t\t\t9.3937e-05 * 0.857728610000272 / 2.384e-06,\n\t\t\t1.597881e-03 * 0.857728610000272 / 2.384e-06,\n\t\t\t1.3489246e-02 * 0.857728610000272 / 2.384e-06,\n\t\t\t-2.2228718e-02 * 0.857728610000272 / 2.384e-06,\n\t\t\t-3.306866e-03 * 0.857728610000272 / 2.384e-06,\n\t\t\t-3.71456e-04 * 0.857728610000272 / 2.384e-06,\n\t\t\t-2.1458e-05 * 0.857728610000272 / 2.384e-06,\n\t\t\t5.993769336819237e-01, 9.427934736519954e-01,\n\n\t\t\t-4.77e-07 * 0.881921264348355 / 2.384e-06,\n\t\t\t1.08719e-04 * 0.881921264348355 / 2.384e-06,\n\t\t\t7.8392e-04 * 0.881921264348355 / 2.384e-06,\n\t\t\t9.71317e-04 * 0.881921264348355 / 2.384e-06,\n\t\t\t3.5007000e-02 * 0.881921264348355 / 2.384e-06,\n\t\t\t4.357815e-03 * 0.881921264348355 / 2.384e-06,\n\t\t\t9.80854e-04 * 0.881921264348355 / 2.384e-06,\n\t\t\t8.3923e-05 * 0.881921264348355 / 2.384e-06, /* 10 */\n\t\t\t7.629e-06 * 0.881921264348355 / 2.384e-06,\n\t\t\t7.2956e-05 * 0.881921264348355 / 2.384e-06,\n\t\t\t1.432419e-03 * 0.881921264348355 / 2.384e-06,\n\t\t\t1.2627602e-02 * 0.881921264348355 / 2.384e-06,\n\t\t\t-2.3074150e-02 * 0.881921264348355 / 2.384e-06,\n\t\t\t-3.467083e-03 * 0.881921264348355 / 2.384e-06,\n\t\t\t-4.04358e-04 * 0.881921264348355 / 2.384e-06,\n\t\t\t-2.3365e-05 * 0.881921264348355 / 2.384e-06,\n\t\t\t5.345111359507916e-01, 1.111140466039205e+00,\n\n\t\t\t-9.54e-07 * 0.903989293123443 / 2.384e-06,\n\t\t\t1.08242e-04 * 0.903989293123443 / 2.384e-06,\n\t\t\t7.31945e-04 * 0.903989293123443 / 2.384e-06,\n\t\t\t5.15938e-04 * 0.903989293123443 / 2.384e-06,\n\t\t\t3.4730434e-02 * 0.903989293123443 / 2.384e-06,\n\t\t\t4.477024e-03 * 0.903989293123443 / 2.384e-06,\n\t\t\t9.68933e-04 * 0.903989293123443 / 2.384e-06,\n\t\t\t8.0585e-05 * 0.903989293123443 / 2.384e-06, /* 9 */\n\t\t\t6.676e-06 * 0.903989293123443 / 2.384e-06,\n\t\t\t5.2929e-05 * 0.903989293123443 / 2.384e-06,\n\t\t\t1.269817e-03 * 0.903989293123443 / 2.384e-06,\n\t\t\t1.1775017e-02 * 0.903989293123443 / 2.384e-06,\n\t\t\t-2.3907185e-02 * 0.903989293123443 / 2.384e-06,\n\t\t\t-3.622532e-03 * 0.903989293123443 / 2.384e-06,\n\t\t\t-4.38213e-04 * 0.903989293123443 / 2.384e-06,\n\t\t\t-2.5272e-05 * 0.903989293123443 / 2.384e-06,\n\t\t\t4.729647758913199e-01, 1.268786568327291e+00,\n\n\t\t\t-9.54e-07 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t1.06812e-04 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t6.74248e-04 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t3.3379e-05 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t3.4412861e-02 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t4.573822e-03 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t9.54151e-04 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t7.6771e-05 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t6.199e-06 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t3.4332e-05 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t1.111031e-03 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t1.0933399e-02 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t-2.4725437e-02 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t-3.771782e-03 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t-4.72546e-04 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t-2.7657e-05 * 0.92387953251128675613 / 2.384e-06,\n\t\t\t4.1421356237309504879e-01, /* tan(PI/8) */\n\t\t\t1.414213562373095e+00,\n\n\t\t\t-9.54e-07 * 0.941544065183021 / 2.384e-06,\n\t\t\t1.05381e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t6.10352e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t-4.75883e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t3.4055710e-02 * 0.941544065183021 / 2.384e-06,\n\t\t\t4.649162e-03 * 0.941544065183021 / 2.384e-06,\n\t\t\t9.35555e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t7.3433e-05 * 0.941544065183021 / 2.384e-06, /* 7 */\n\t\t\t5.245e-06 * 0.941544065183021 / 2.384e-06,\n\t\t\t1.7166e-05 * 0.941544065183021 / 2.384e-06,\n\t\t\t9.56535e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t1.0103703e-02 * 0.941544065183021 / 2.384e-06,\n\t\t\t-2.5527000e-02 * 0.941544065183021 / 2.384e-06,\n\t\t\t-3.914356e-03 * 0.941544065183021 / 2.384e-06,\n\t\t\t-5.07355e-04 * 0.941544065183021 / 2.384e-06,\n\t\t\t-3.0041e-05 * 0.941544065183021 / 2.384e-06,\n\t\t\t3.578057213145241e-01, 1.546020906725474e+00,\n\n\t\t\t-9.54e-07 * 0.956940335732209 / 2.384e-06,\n\t\t\t1.02520e-04 * 0.956940335732209 / 2.384e-06,\n\t\t\t5.39303e-04 * 0.956940335732209 / 2.384e-06,\n\t\t\t-1.011848e-03 * 0.956940335732209 / 2.384e-06,\n\t\t\t3.3659935e-02 * 0.956940335732209 / 2.384e-06,\n\t\t\t4.703045e-03 * 0.956940335732209 / 2.384e-06,\n\t\t\t9.15051e-04 * 0.956940335732209 / 2.384e-06,\n\t\t\t7.0095e-05 * 0.956940335732209 / 2.384e-06, /* 6 */\n\t\t\t4.768e-06 * 0.956940335732209 / 2.384e-06,\n\t\t\t9.54e-07 * 0.956940335732209 / 2.384e-06,\n\t\t\t8.06808e-04 * 0.956940335732209 / 2.384e-06,\n\t\t\t9.287834e-03 * 0.956940335732209 / 2.384e-06,\n\t\t\t-2.6310921e-02 * 0.956940335732209 / 2.384e-06,\n\t\t\t-4.048824e-03 * 0.956940335732209 / 2.384e-06,\n\t\t\t-5.42164e-04 * 0.956940335732209 / 2.384e-06,\n\t\t\t-3.2425e-05 * 0.956940335732209 / 2.384e-06,\n\t\t\t3.033466836073424e-01, 1.662939224605090e+00,\n\n\t\t\t-1.431e-06 * 0.970031253194544 / 2.384e-06,\n\t\t\t9.9182e-05 * 0.970031253194544 / 2.384e-06,\n\t\t\t4.62532e-04 * 0.970031253194544 / 2.384e-06,\n\t\t\t-1.573563e-03 * 0.970031253194544 / 2.384e-06,\n\t\t\t3.3225536e-02 * 0.970031253194544 / 2.384e-06,\n\t\t\t4.737377e-03 * 0.970031253194544 / 2.384e-06,\n\t\t\t8.91685e-04 * 0.970031253194544 / 2.384e-06,\n\t\t\t6.6280e-05 * 0.970031253194544 / 2.384e-06, /* 5 */\n\t\t\t4.292e-06 * 0.970031253194544 / 2.384e-06,\n\t\t\t-1.3828e-05 * 0.970031253194544 / 2.384e-06,\n\t\t\t6.61850e-04 * 0.970031253194544 / 2.384e-06,\n\t\t\t8.487225e-03 * 0.970031253194544 / 2.384e-06,\n\t\t\t-2.7073860e-02 * 0.970031253194544 / 2.384e-06,\n\t\t\t-4.174709e-03 * 0.970031253194544 / 2.384e-06,\n\t\t\t-5.76973e-04 * 0.970031253194544 / 2.384e-06,\n\t\t\t-3.4809e-05 * 0.970031253194544 / 2.384e-06,\n\t\t\t2.504869601913055e-01, 1.763842528696710e+00,\n\n\t\t\t-1.431e-06 * 0.98078528040323 / 2.384e-06,\n\t\t\t9.5367e-05 * 0.98078528040323 / 2.384e-06,\n\t\t\t3.78609e-04 * 0.98078528040323 / 2.384e-06,\n\t\t\t-2.161503e-03 * 0.98078528040323 / 2.384e-06,\n\t\t\t3.2754898e-02 * 0.98078528040323 / 2.384e-06,\n\t\t\t4.752159e-03 * 0.98078528040323 / 2.384e-06,\n\t\t\t8.66413e-04 * 0.98078528040323 / 2.384e-06,\n\t\t\t6.2943e-05 * 0.98078528040323 / 2.384e-06, /* 4 */\n\t\t\t3.815e-06 * 0.98078528040323 / 2.384e-06,\n\t\t\t-2.718e-05 * 0.98078528040323 / 2.384e-06,\n\t\t\t5.22137e-04 * 0.98078528040323 / 2.384e-06,\n\t\t\t7.703304e-03 * 0.98078528040323 / 2.384e-06,\n\t\t\t-2.7815342e-02 * 0.98078528040323 / 2.384e-06,\n\t\t\t-4.290581e-03 * 0.98078528040323 / 2.384e-06,\n\t\t\t-6.11782e-04 * 0.98078528040323 / 2.384e-06,\n\t\t\t-3.7670e-05 * 0.98078528040323 / 2.384e-06,\n\t\t\t1.989123673796580e-01, 1.847759065022573e+00,\n\n\t\t\t-1.907e-06 * 0.989176509964781 / 2.384e-06,\n\t\t\t9.0122e-05 * 0.989176509964781 / 2.384e-06,\n\t\t\t2.88486e-04 * 0.989176509964781 / 2.384e-06,\n\t\t\t-2.774239e-03 * 0.989176509964781 / 2.384e-06,\n\t\t\t3.2248020e-02 * 0.989176509964781 / 2.384e-06,\n\t\t\t4.748821e-03 * 0.989176509964781 / 2.384e-06,\n\t\t\t8.38757e-04 * 0.989176509964781 / 2.384e-06,\n\t\t\t5.9605e-05 * 0.989176509964781 / 2.384e-06, /* 3 */\n\t\t\t3.338e-06 * 0.989176509964781 / 2.384e-06,\n\t\t\t-3.9577e-05 * 0.989176509964781 / 2.384e-06,\n\t\t\t3.88145e-04 * 0.989176509964781 / 2.384e-06,\n\t\t\t6.937027e-03 * 0.989176509964781 / 2.384e-06,\n\t\t\t-2.8532982e-02 * 0.989176509964781 / 2.384e-06,\n\t\t\t-4.395962e-03 * 0.989176509964781 / 2.384e-06,\n\t\t\t-6.46591e-04 * 0.989176509964781 / 2.384e-06,\n\t\t\t-4.0531e-05 * 0.989176509964781 / 2.384e-06,\n\t\t\t1.483359875383474e-01, 1.913880671464418e+00,\n\n\t\t\t-1.907e-06 * 0.995184726672197 / 2.384e-06,\n\t\t\t8.4400e-05 * 0.995184726672197 / 2.384e-06,\n\t\t\t1.91689e-04 * 0.995184726672197 / 2.384e-06,\n\t\t\t-3.411293e-03 * 0.995184726672197 / 2.384e-06,\n\t\t\t3.1706810e-02 * 0.995184726672197 / 2.384e-06,\n\t\t\t4.728317e-03 * 0.995184726672197 / 2.384e-06,\n\t\t\t8.09669e-04 * 0.995184726672197 / 2.384e-06,\n\t\t\t5.579e-05 * 0.995184726672197 / 2.384e-06,\n\t\t\t3.338e-06 * 0.995184726672197 / 2.384e-06,\n\t\t\t-5.0545e-05 * 0.995184726672197 / 2.384e-06,\n\t\t\t2.59876e-04 * 0.995184726672197 / 2.384e-06,\n\t\t\t6.189346e-03 * 0.995184726672197 / 2.384e-06,\n\t\t\t-2.9224873e-02 * 0.995184726672197 / 2.384e-06,\n\t\t\t-4.489899e-03 * 0.995184726672197 / 2.384e-06,\n\t\t\t-6.80923e-04 * 0.995184726672197 / 2.384e-06,\n\t\t\t-4.3392e-05 * 0.995184726672197 / 2.384e-06,\n\t\t\t9.849140335716425e-02, 1.961570560806461e+00,\n\n\t\t\t-2.384e-06 * 0.998795456205172 / 2.384e-06,\n\t\t\t7.7724e-05 * 0.998795456205172 / 2.384e-06,\n\t\t\t8.8215e-05 * 0.998795456205172 / 2.384e-06,\n\t\t\t-4.072189e-03 * 0.998795456205172 / 2.384e-06,\n\t\t\t3.1132698e-02 * 0.998795456205172 / 2.384e-06,\n\t\t\t4.691124e-03 * 0.998795456205172 / 2.384e-06,\n\t\t\t7.79152e-04 * 0.998795456205172 / 2.384e-06,\n\t\t\t5.2929e-05 * 0.998795456205172 / 2.384e-06,\n\t\t\t2.861e-06 * 0.998795456205172 / 2.384e-06,\n\t\t\t-6.0558e-05 * 0.998795456205172 / 2.384e-06,\n\t\t\t1.37329e-04 * 0.998795456205172 / 2.384e-06,\n\t\t\t5.462170e-03 * 0.998795456205172 / 2.384e-06,\n\t\t\t-2.9890060e-02 * 0.998795456205172 / 2.384e-06,\n\t\t\t-4.570484e-03 * 0.998795456205172 / 2.384e-06,\n\t\t\t-7.14302e-04 * 0.998795456205172 / 2.384e-06,\n\t\t\t-4.6253e-05 * 0.998795456205172 / 2.384e-06,\n\t\t\t4.912684976946725e-02, 1.990369453344394e+00,\n\n\t\t\t3.5780907e-02 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t1.7876148e-02 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t3.134727e-03 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t2.457142e-03 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t9.71317e-04 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t2.18868e-04 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t1.01566e-04 * Util.SQRT2 * 0.5 / 2.384e-06,\n\t\t\t1.3828e-05 * Util.SQRT2 * 0.5 / 2.384e-06,\n\n\t\t\t3.0526638e-02 / 2.384e-06, 4.638195e-03 / 2.384e-06,\n\t\t\t7.47204e-04 / 2.384e-06, 4.9591e-05 / 2.384e-06,\n\t\t\t4.756451e-03 / 2.384e-06, 2.1458e-05 / 2.384e-06,\n\t\t\t-6.9618e-05 / 2.384e-06, /* 2.384e-06/2.384e-06 */\n\t];\n\n\tvar NS = 12;\n\tvar NL = 36;\n\n\tvar win = [\n\t    [\n\t     2.382191739347913e-13,\n\t     6.423305872147834e-13,\n\t     9.400849094049688e-13,\n\t     1.122435026096556e-12,\n\t     1.183840321267481e-12,\n\t     1.122435026096556e-12,\n\t     9.400849094049690e-13,\n\t     6.423305872147839e-13,\n\t     2.382191739347918e-13,\n\n\t     5.456116108943412e-12,\n\t     4.878985199565852e-12,\n\t     4.240448995017367e-12,\n\t     3.559909094758252e-12,\n\t     2.858043359288075e-12,\n\t     2.156177623817898e-12,\n\t     1.475637723558783e-12,\n\t     8.371015190102974e-13,\n\t     2.599706096327376e-13,\n\n\t     -5.456116108943412e-12,\n\t     -4.878985199565852e-12,\n\t     -4.240448995017367e-12,\n\t     -3.559909094758252e-12,\n\t     -2.858043359288076e-12,\n\t     -2.156177623817898e-12,\n\t     -1.475637723558783e-12,\n\t     -8.371015190102975e-13,\n\t     -2.599706096327376e-13,\n\n\t     -2.382191739347923e-13,\n\t     -6.423305872147843e-13,\n\t     -9.400849094049696e-13,\n\t     -1.122435026096556e-12,\n\t     -1.183840321267481e-12,\n\t     -1.122435026096556e-12,\n\t     -9.400849094049694e-13,\n\t     -6.423305872147840e-13,\n\t     -2.382191739347918e-13,\n\t     ],\n\t    [\n\t     2.382191739347913e-13,\n\t     6.423305872147834e-13,\n\t     9.400849094049688e-13,\n\t     1.122435026096556e-12,\n\t     1.183840321267481e-12,\n\t     1.122435026096556e-12,\n\t     9.400849094049688e-13,\n\t     6.423305872147841e-13,\n\t     2.382191739347918e-13,\n\n\t     5.456116108943413e-12,\n\t     4.878985199565852e-12,\n\t     4.240448995017367e-12,\n\t     3.559909094758253e-12,\n\t     2.858043359288075e-12,\n\t     2.156177623817898e-12,\n\t     1.475637723558782e-12,\n\t     8.371015190102975e-13,\n\t     2.599706096327376e-13,\n\n\t     -5.461314069809755e-12,\n\t     -4.921085770524055e-12,\n\t     -4.343405037091838e-12,\n\t     -3.732668368707687e-12,\n\t     -3.093523840190885e-12,\n\t     -2.430835727329465e-12,\n\t     -1.734679010007751e-12,\n\t     -9.748253656609281e-13,\n\t     -2.797435120168326e-13,\n\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     -2.283748241799531e-13,\n\t     -4.037858874020686e-13,\n\t     -2.146547464825323e-13,\n\t     ],\n\t    [\n\t     1.316524975873958e-01, /* win[SHORT_TYPE] */\n\t     4.142135623730950e-01,\n\t     7.673269879789602e-01,\n\n\t     1.091308501069271e+00, /* tantab_l */\n\t     1.303225372841206e+00,\n\t     1.569685577117490e+00,\n\t     1.920982126971166e+00,\n\t     2.414213562373094e+00,\n\t     3.171594802363212e+00,\n\t     4.510708503662055e+00,\n\t     7.595754112725146e+00,\n\t     2.290376554843115e+01,\n\n\t     0.98480775301220802032, /* cx */\n\t     0.64278760968653936292,\n\t     0.34202014332566882393,\n\t     0.93969262078590842791,\n\t     -0.17364817766693030343,\n\t     -0.76604444311897790243,\n\t     0.86602540378443870761,\n\t     0.500000000000000e+00,\n\n\t     -5.144957554275265e-01, /* ca */\n\t     -4.717319685649723e-01,\n\t     -3.133774542039019e-01,\n\t     -1.819131996109812e-01,\n\t     -9.457419252642064e-02,\n\t     -4.096558288530405e-02,\n\t     -1.419856857247115e-02,\n\t     -3.699974673760037e-03,\n\n\t     8.574929257125442e-01, /* cs */\n\t     8.817419973177052e-01,\n\t     9.496286491027329e-01,\n\t     9.833145924917901e-01,\n\t     9.955178160675857e-01,\n\t     9.991605581781475e-01,\n\t     9.998991952444470e-01,\n\t     9.999931550702802e-01,\n\t     ],\n\t    [\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     0.000000000000000e+00,\n\t     2.283748241799531e-13,\n\t     4.037858874020686e-13,\n\t     2.146547464825323e-13,\n\n\t     5.461314069809755e-12,\n\t     4.921085770524055e-12,\n\t     4.343405037091838e-12,\n\t     3.732668368707687e-12,\n\t     3.093523840190885e-12,\n\t     2.430835727329466e-12,\n\t     1.734679010007751e-12,\n\t     9.748253656609281e-13,\n\t     2.797435120168326e-13,\n\n\t     -5.456116108943413e-12,\n\t     -4.878985199565852e-12,\n\t     -4.240448995017367e-12,\n\t     -3.559909094758253e-12,\n\t     -2.858043359288075e-12,\n\t     -2.156177623817898e-12,\n\t     -1.475637723558782e-12,\n\t     -8.371015190102975e-13,\n\t     -2.599706096327376e-13,\n\n\t     -2.382191739347913e-13,\n\t     -6.423305872147834e-13,\n\t     -9.400849094049688e-13,\n\t     -1.122435026096556e-12,\n\t     -1.183840321267481e-12,\n\t     -1.122435026096556e-12,\n\t     -9.400849094049688e-13,\n\t     -6.423305872147841e-13,\n\t     -2.382191739347918e-13,\n\t     ]\n\t];\n\n\tvar tantab_l = win[Encoder.SHORT_TYPE];\n\tvar cx = win[Encoder.SHORT_TYPE];\n\tvar ca = win[Encoder.SHORT_TYPE];\n\tvar cs = win[Encoder.SHORT_TYPE];\n\n\t/**\n\t * new IDCT routine written by Takehiro TOMINAGA\n\t *\n\t * PURPOSE: Overlapping window on PCM samples<BR>\n\t *\n\t * SEMANTICS:<BR>\n\t * 32 16-bit pcm samples are scaled to fractional 2's complement and\n\t * concatenated to the end of the window buffer #x#. The updated window\n\t * buffer #x# is then windowed by the analysis window #c# to produce the\n\t * windowed sample #z#\n\t */\n\tvar order = [\n\t    0, 1, 16, 17, 8, 9, 24, 25, 4, 5, 20, 21, 12, 13, 28, 29,\n\t    2, 3, 18, 19, 10, 11, 26, 27, 6, 7, 22, 23, 14, 15, 30, 31\n\t];\n\n\t/**\n\t * returns sum_j=0^31 a[j]*cos(PI*j*(k+1/2)/32), 0<=k<32\n\t */\n\tfunction window_subband(x1, x1Pos, a) {\n\t\tvar wp = 10;\n\n\t\tvar x2 = x1Pos + 238 - 14 - 286;\n\n\t\tfor (var i = -15; i < 0; i++) {\n\t\t\tvar w, s, t;\n\n\t\t\tw = enwindow[wp + -10];\n\t\t\ts = x1[x2 + -224] * w;\n\t\t\tt = x1[x1Pos + 224] * w;\n\t\t\tw = enwindow[wp + -9];\n\t\t\ts += x1[x2 + -160] * w;\n\t\t\tt += x1[x1Pos + 160] * w;\n\t\t\tw = enwindow[wp + -8];\n\t\t\ts += x1[x2 + -96] * w;\n\t\t\tt += x1[x1Pos + 96] * w;\n\t\t\tw = enwindow[wp + -7];\n\t\t\ts += x1[x2 + -32] * w;\n\t\t\tt += x1[x1Pos + 32] * w;\n\t\t\tw = enwindow[wp + -6];\n\t\t\ts += x1[x2 + 32] * w;\n\t\t\tt += x1[x1Pos + -32] * w;\n\t\t\tw = enwindow[wp + -5];\n\t\t\ts += x1[x2 + 96] * w;\n\t\t\tt += x1[x1Pos + -96] * w;\n\t\t\tw = enwindow[wp + -4];\n\t\t\ts += x1[x2 + 160] * w;\n\t\t\tt += x1[x1Pos + -160] * w;\n\t\t\tw = enwindow[wp + -3];\n\t\t\ts += x1[x2 + 224] * w;\n\t\t\tt += x1[x1Pos + -224] * w;\n\n\t\t\tw = enwindow[wp + -2];\n\t\t\ts += x1[x1Pos + -256] * w;\n\t\t\tt -= x1[x2 + 256] * w;\n\t\t\tw = enwindow[wp + -1];\n\t\t\ts += x1[x1Pos + -192] * w;\n\t\t\tt -= x1[x2 + 192] * w;\n\t\t\tw = enwindow[wp + 0];\n\t\t\ts += x1[x1Pos + -128] * w;\n\t\t\tt -= x1[x2 + 128] * w;\n\t\t\tw = enwindow[wp + 1];\n\t\t\ts += x1[x1Pos + -64] * w;\n\t\t\tt -= x1[x2 + 64] * w;\n\t\t\tw = enwindow[wp + 2];\n\t\t\ts += x1[x1Pos + 0] * w;\n\t\t\tt -= x1[x2 + 0] * w;\n\t\t\tw = enwindow[wp + 3];\n\t\t\ts += x1[x1Pos + 64] * w;\n\t\t\tt -= x1[x2 + -64] * w;\n\t\t\tw = enwindow[wp + 4];\n\t\t\ts += x1[x1Pos + 128] * w;\n\t\t\tt -= x1[x2 + -128] * w;\n\t\t\tw = enwindow[wp + 5];\n\t\t\ts += x1[x1Pos + 192] * w;\n\t\t\tt -= x1[x2 + -192] * w;\n\n\t\t\t/*\n\t\t\t * this multiplyer could be removed, but it needs more 256 FLOAT\n\t\t\t * data. thinking about the data cache performance, I think we\n\t\t\t * should not use such a huge table. tt 2000/Oct/25\n\t\t\t */\n\t\t\ts *= enwindow[wp + 6];\n\t\t\tw = t - s;\n\t\t\ta[30 + i * 2] = t + s;\n\t\t\ta[31 + i * 2] = enwindow[wp + 7] * w;\n\t\t\twp += 18;\n\t\t\tx1Pos--;\n\t\t\tx2++;\n\t\t}\n\t\t{\n\t\t\tvar s, t, u, v;\n\t\t\tt = x1[x1Pos + -16] * enwindow[wp + -10];\n\t\t\ts = x1[x1Pos + -32] * enwindow[wp + -2];\n\t\t\tt += (x1[x1Pos + -48] - x1[x1Pos + 16]) * enwindow[wp + -9];\n\t\t\ts += x1[x1Pos + -96] * enwindow[wp + -1];\n\t\t\tt += (x1[x1Pos + -80] + x1[x1Pos + 48]) * enwindow[wp + -8];\n\t\t\ts += x1[x1Pos + -160] * enwindow[wp + 0];\n\t\t\tt += (x1[x1Pos + -112] - x1[x1Pos + 80]) * enwindow[wp + -7];\n\t\t\ts += x1[x1Pos + -224] * enwindow[wp + 1];\n\t\t\tt += (x1[x1Pos + -144] + x1[x1Pos + 112]) * enwindow[wp + -6];\n\t\t\ts -= x1[x1Pos + 32] * enwindow[wp + 2];\n\t\t\tt += (x1[x1Pos + -176] - x1[x1Pos + 144]) * enwindow[wp + -5];\n\t\t\ts -= x1[x1Pos + 96] * enwindow[wp + 3];\n\t\t\tt += (x1[x1Pos + -208] + x1[x1Pos + 176]) * enwindow[wp + -4];\n\t\t\ts -= x1[x1Pos + 160] * enwindow[wp + 4];\n\t\t\tt += (x1[x1Pos + -240] - x1[x1Pos + 208]) * enwindow[wp + -3];\n\t\t\ts -= x1[x1Pos + 224];\n\n\t\t\tu = s - t;\n\t\t\tv = s + t;\n\n\t\t\tt = a[14];\n\t\t\ts = a[15] - t;\n\n\t\t\ta[31] = v + t; /* A0 */\n\t\t\ta[30] = u + s; /* A1 */\n\t\t\ta[15] = u - s; /* A2 */\n\t\t\ta[14] = v - t; /* A3 */\n\t\t}\n\t\t{\n\t\t\tvar xr;\n\t\t\txr = a[28] - a[0];\n\t\t\ta[0] += a[28];\n\t\t\ta[28] = xr * enwindow[wp + -2 * 18 + 7];\n\t\t\txr = a[29] - a[1];\n\t\t\ta[1] += a[29];\n\t\t\ta[29] = xr * enwindow[wp + -2 * 18 + 7];\n\n\t\t\txr = a[26] - a[2];\n\t\t\ta[2] += a[26];\n\t\t\ta[26] = xr * enwindow[wp + -4 * 18 + 7];\n\t\t\txr = a[27] - a[3];\n\t\t\ta[3] += a[27];\n\t\t\ta[27] = xr * enwindow[wp + -4 * 18 + 7];\n\n\t\t\txr = a[24] - a[4];\n\t\t\ta[4] += a[24];\n\t\t\ta[24] = xr * enwindow[wp + -6 * 18 + 7];\n\t\t\txr = a[25] - a[5];\n\t\t\ta[5] += a[25];\n\t\t\ta[25] = xr * enwindow[wp + -6 * 18 + 7];\n\n\t\t\txr = a[22] - a[6];\n\t\t\ta[6] += a[22];\n\t\t\ta[22] = xr * Util.SQRT2;\n\t\t\txr = a[23] - a[7];\n\t\t\ta[7] += a[23];\n\t\t\ta[23] = xr * Util.SQRT2 - a[7];\n\t\t\ta[7] -= a[6];\n\t\t\ta[22] -= a[7];\n\t\t\ta[23] -= a[22];\n\n\t\t\txr = a[6];\n\t\t\ta[6] = a[31] - xr;\n\t\t\ta[31] = a[31] + xr;\n\t\t\txr = a[7];\n\t\t\ta[7] = a[30] - xr;\n\t\t\ta[30] = a[30] + xr;\n\t\t\txr = a[22];\n\t\t\ta[22] = a[15] - xr;\n\t\t\ta[15] = a[15] + xr;\n\t\t\txr = a[23];\n\t\t\ta[23] = a[14] - xr;\n\t\t\ta[14] = a[14] + xr;\n\n\t\t\txr = a[20] - a[8];\n\t\t\ta[8] += a[20];\n\t\t\ta[20] = xr * enwindow[wp + -10 * 18 + 7];\n\t\t\txr = a[21] - a[9];\n\t\t\ta[9] += a[21];\n\t\t\ta[21] = xr * enwindow[wp + -10 * 18 + 7];\n\n\t\t\txr = a[18] - a[10];\n\t\t\ta[10] += a[18];\n\t\t\ta[18] = xr * enwindow[wp + -12 * 18 + 7];\n\t\t\txr = a[19] - a[11];\n\t\t\ta[11] += a[19];\n\t\t\ta[19] = xr * enwindow[wp + -12 * 18 + 7];\n\n\t\t\txr = a[16] - a[12];\n\t\t\ta[12] += a[16];\n\t\t\ta[16] = xr * enwindow[wp + -14 * 18 + 7];\n\t\t\txr = a[17] - a[13];\n\t\t\ta[13] += a[17];\n\t\t\ta[17] = xr * enwindow[wp + -14 * 18 + 7];\n\n\t\t\txr = -a[20] + a[24];\n\t\t\ta[20] += a[24];\n\t\t\ta[24] = xr * enwindow[wp + -12 * 18 + 7];\n\t\t\txr = -a[21] + a[25];\n\t\t\ta[21] += a[25];\n\t\t\ta[25] = xr * enwindow[wp + -12 * 18 + 7];\n\n\t\t\txr = a[4] - a[8];\n\t\t\ta[4] += a[8];\n\t\t\ta[8] = xr * enwindow[wp + -12 * 18 + 7];\n\t\t\txr = a[5] - a[9];\n\t\t\ta[5] += a[9];\n\t\t\ta[9] = xr * enwindow[wp + -12 * 18 + 7];\n\n\t\t\txr = a[0] - a[12];\n\t\t\ta[0] += a[12];\n\t\t\ta[12] = xr * enwindow[wp + -4 * 18 + 7];\n\t\t\txr = a[1] - a[13];\n\t\t\ta[1] += a[13];\n\t\t\ta[13] = xr * enwindow[wp + -4 * 18 + 7];\n\t\t\txr = a[16] - a[28];\n\t\t\ta[16] += a[28];\n\t\t\ta[28] = xr * enwindow[wp + -4 * 18 + 7];\n\t\t\txr = -a[17] + a[29];\n\t\t\ta[17] += a[29];\n\t\t\ta[29] = xr * enwindow[wp + -4 * 18 + 7];\n\n\t\t\txr = Util.SQRT2 * (a[2] - a[10]);\n\t\t\ta[2] += a[10];\n\t\t\ta[10] = xr;\n\t\t\txr = Util.SQRT2 * (a[3] - a[11]);\n\t\t\ta[3] += a[11];\n\t\t\ta[11] = xr;\n\t\t\txr = Util.SQRT2 * (-a[18] + a[26]);\n\t\t\ta[18] += a[26];\n\t\t\ta[26] = xr - a[18];\n\t\t\txr = Util.SQRT2 * (-a[19] + a[27]);\n\t\t\ta[19] += a[27];\n\t\t\ta[27] = xr - a[19];\n\n\t\t\txr = a[2];\n\t\t\ta[19] -= a[3];\n\t\t\ta[3] -= xr;\n\t\t\ta[2] = a[31] - xr;\n\t\t\ta[31] += xr;\n\t\t\txr = a[3];\n\t\t\ta[11] -= a[19];\n\t\t\ta[18] -= xr;\n\t\t\ta[3] = a[30] - xr;\n\t\t\ta[30] += xr;\n\t\t\txr = a[18];\n\t\t\ta[27] -= a[11];\n\t\t\ta[19] -= xr;\n\t\t\ta[18] = a[15] - xr;\n\t\t\ta[15] += xr;\n\n\t\t\txr = a[19];\n\t\t\ta[10] -= xr;\n\t\t\ta[19] = a[14] - xr;\n\t\t\ta[14] += xr;\n\t\t\txr = a[10];\n\t\t\ta[11] -= xr;\n\t\t\ta[10] = a[23] - xr;\n\t\t\ta[23] += xr;\n\t\t\txr = a[11];\n\t\t\ta[26] -= xr;\n\t\t\ta[11] = a[22] - xr;\n\t\t\ta[22] += xr;\n\t\t\txr = a[26];\n\t\t\ta[27] -= xr;\n\t\t\ta[26] = a[7] - xr;\n\t\t\ta[7] += xr;\n\n\t\t\txr = a[27];\n\t\t\ta[27] = a[6] - xr;\n\t\t\ta[6] += xr;\n\n\t\t\txr = Util.SQRT2 * (a[0] - a[4]);\n\t\t\ta[0] += a[4];\n\t\t\ta[4] = xr;\n\t\t\txr = Util.SQRT2 * (a[1] - a[5]);\n\t\t\ta[1] += a[5];\n\t\t\ta[5] = xr;\n\t\t\txr = Util.SQRT2 * (a[16] - a[20]);\n\t\t\ta[16] += a[20];\n\t\t\ta[20] = xr;\n\t\t\txr = Util.SQRT2 * (a[17] - a[21]);\n\t\t\ta[17] += a[21];\n\t\t\ta[21] = xr;\n\n\t\t\txr = -Util.SQRT2 * (a[8] - a[12]);\n\t\t\ta[8] += a[12];\n\t\t\ta[12] = xr - a[8];\n\t\t\txr = -Util.SQRT2 * (a[9] - a[13]);\n\t\t\ta[9] += a[13];\n\t\t\ta[13] = xr - a[9];\n\t\t\txr = -Util.SQRT2 * (a[25] - a[29]);\n\t\t\ta[25] += a[29];\n\t\t\ta[29] = xr - a[25];\n\t\t\txr = -Util.SQRT2 * (a[24] + a[28]);\n\t\t\ta[24] -= a[28];\n\t\t\ta[28] = xr - a[24];\n\n\t\t\txr = a[24] - a[16];\n\t\t\ta[24] = xr;\n\t\t\txr = a[20] - xr;\n\t\t\ta[20] = xr;\n\t\t\txr = a[28] - xr;\n\t\t\ta[28] = xr;\n\n\t\t\txr = a[25] - a[17];\n\t\t\ta[25] = xr;\n\t\t\txr = a[21] - xr;\n\t\t\ta[21] = xr;\n\t\t\txr = a[29] - xr;\n\t\t\ta[29] = xr;\n\n\t\t\txr = a[17] - a[1];\n\t\t\ta[17] = xr;\n\t\t\txr = a[9] - xr;\n\t\t\ta[9] = xr;\n\t\t\txr = a[25] - xr;\n\t\t\ta[25] = xr;\n\t\t\txr = a[5] - xr;\n\t\t\ta[5] = xr;\n\t\t\txr = a[21] - xr;\n\t\t\ta[21] = xr;\n\t\t\txr = a[13] - xr;\n\t\t\ta[13] = xr;\n\t\t\txr = a[29] - xr;\n\t\t\ta[29] = xr;\n\n\t\t\txr = a[1] - a[0];\n\t\t\ta[1] = xr;\n\t\t\txr = a[16] - xr;\n\t\t\ta[16] = xr;\n\t\t\txr = a[17] - xr;\n\t\t\ta[17] = xr;\n\t\t\txr = a[8] - xr;\n\t\t\ta[8] = xr;\n\t\t\txr = a[9] - xr;\n\t\t\ta[9] = xr;\n\t\t\txr = a[24] - xr;\n\t\t\ta[24] = xr;\n\t\t\txr = a[25] - xr;\n\t\t\ta[25] = xr;\n\t\t\txr = a[4] - xr;\n\t\t\ta[4] = xr;\n\t\t\txr = a[5] - xr;\n\t\t\ta[5] = xr;\n\t\t\txr = a[20] - xr;\n\t\t\ta[20] = xr;\n\t\t\txr = a[21] - xr;\n\t\t\ta[21] = xr;\n\t\t\txr = a[12] - xr;\n\t\t\ta[12] = xr;\n\t\t\txr = a[13] - xr;\n\t\t\ta[13] = xr;\n\t\t\txr = a[28] - xr;\n\t\t\ta[28] = xr;\n\t\t\txr = a[29] - xr;\n\t\t\ta[29] = xr;\n\n\t\t\txr = a[0];\n\t\t\ta[0] += a[31];\n\t\t\ta[31] -= xr;\n\t\t\txr = a[1];\n\t\t\ta[1] += a[30];\n\t\t\ta[30] -= xr;\n\t\t\txr = a[16];\n\t\t\ta[16] += a[15];\n\t\t\ta[15] -= xr;\n\t\t\txr = a[17];\n\t\t\ta[17] += a[14];\n\t\t\ta[14] -= xr;\n\t\t\txr = a[8];\n\t\t\ta[8] += a[23];\n\t\t\ta[23] -= xr;\n\t\t\txr = a[9];\n\t\t\ta[9] += a[22];\n\t\t\ta[22] -= xr;\n\t\t\txr = a[24];\n\t\t\ta[24] += a[7];\n\t\t\ta[7] -= xr;\n\t\t\txr = a[25];\n\t\t\ta[25] += a[6];\n\t\t\ta[6] -= xr;\n\t\t\txr = a[4];\n\t\t\ta[4] += a[27];\n\t\t\ta[27] -= xr;\n\t\t\txr = a[5];\n\t\t\ta[5] += a[26];\n\t\t\ta[26] -= xr;\n\t\t\txr = a[20];\n\t\t\ta[20] += a[11];\n\t\t\ta[11] -= xr;\n\t\t\txr = a[21];\n\t\t\ta[21] += a[10];\n\t\t\ta[10] -= xr;\n\t\t\txr = a[12];\n\t\t\ta[12] += a[19];\n\t\t\ta[19] -= xr;\n\t\t\txr = a[13];\n\t\t\ta[13] += a[18];\n\t\t\ta[18] -= xr;\n\t\t\txr = a[28];\n\t\t\ta[28] += a[3];\n\t\t\ta[3] -= xr;\n\t\t\txr = a[29];\n\t\t\ta[29] += a[2];\n\t\t\ta[2] -= xr;\n\t\t}\n\t}\n\n\t/**\n\t * Function: Calculation of the MDCT In the case of long blocks (type 0,1,3)\n\t * there are 36 coefficents in the time domain and 18 in the frequency\n\t * domain.<BR>\n\t * In the case of short blocks (type 2) there are 3 transformations with\n\t * short length. This leads to 12 coefficents in the time and 6 in the\n\t * frequency domain. In this case the results are stored side by side in the\n\t * vector out[].\n\t *\n\t * New layer3\n\t */\n\tfunction mdct_short(inout, inoutPos) {\n\t\tfor (var l = 0; l < 3; l++) {\n\t\t\tvar tc0, tc1, tc2, ts0, ts1, ts2;\n\n\t\t\tts0 = inout[inoutPos + 2 * 3] * win[Encoder.SHORT_TYPE][0]\n\t\t\t\t\t- inout[inoutPos + 5 * 3];\n\t\t\ttc0 = inout[inoutPos + 0 * 3] * win[Encoder.SHORT_TYPE][2]\n\t\t\t\t\t- inout[inoutPos + 3 * 3];\n\t\t\ttc1 = ts0 + tc0;\n\t\t\ttc2 = ts0 - tc0;\n\n\t\t\tts0 = inout[inoutPos + 5 * 3] * win[Encoder.SHORT_TYPE][0]\n\t\t\t\t\t+ inout[inoutPos + 2 * 3];\n\t\t\ttc0 = inout[inoutPos + 3 * 3] * win[Encoder.SHORT_TYPE][2]\n\t\t\t\t\t+ inout[inoutPos + 0 * 3];\n\t\t\tts1 = ts0 + tc0;\n\t\t\tts2 = -ts0 + tc0;\n\n\t\t\ttc0 = (inout[inoutPos + 1 * 3] * win[Encoder.SHORT_TYPE][1] - inout[inoutPos + 4 * 3]) * 2.069978111953089e-11;\n\t\t\t/*\n\t\t\t * tritab_s [ 1 ]\n\t\t\t */\n\t\t\tts0 = (inout[inoutPos + 4 * 3] * win[Encoder.SHORT_TYPE][1] + inout[inoutPos + 1 * 3]) * 2.069978111953089e-11;\n\t\t\t/*\n\t\t\t * tritab_s [ 1 ]\n\t\t\t */\n\t\t\tinout[inoutPos + 3 * 0] = tc1 * 1.907525191737280e-11 + tc0;\n\t\t\t/*\n\t\t\t * tritab_s[ 2 ]\n\t\t\t */\n\t\t\tinout[inoutPos + 3 * 5] = -ts1 * 1.907525191737280e-11 + ts0;\n\t\t\t/*\n\t\t\t * tritab_s[0 ]\n\t\t\t */\n\t\t\ttc2 = tc2 * 0.86602540378443870761 * 1.907525191737281e-11;\n\t\t\t/*\n\t\t\t * tritab_s[ 2]\n\t\t\t */\n\t\t\tts1 = ts1 * 0.5 * 1.907525191737281e-11 + ts0;\n\t\t\tinout[inoutPos + 3 * 1] = tc2 - ts1;\n\t\t\tinout[inoutPos + 3 * 2] = tc2 + ts1;\n\n\t\t\ttc1 = tc1 * 0.5 * 1.907525191737281e-11 - tc0;\n\t\t\tts2 = ts2 * 0.86602540378443870761 * 1.907525191737281e-11;\n\t\t\t/*\n\t\t\t * tritab_s[ 0]\n\t\t\t */\n\t\t\tinout[inoutPos + 3 * 3] = tc1 + ts2;\n\t\t\tinout[inoutPos + 3 * 4] = tc1 - ts2;\n\n\t\t\tinoutPos++;\n\t\t}\n\t}\n\n\tfunction mdct_long(out, outPos, _in) {\n\t\tvar ct, st;\n\t\t{\n\t\t\tvar tc1, tc2, tc3, tc4, ts5, ts6, ts7, ts8;\n\t\t\t/* 1,2, 5,6, 9,10, 13,14, 17 */\n\t\t\ttc1 = _in[17] - _in[9];\n\t\t\ttc3 = _in[15] - _in[11];\n\t\t\ttc4 = _in[14] - _in[12];\n\t\t\tts5 = _in[0] + _in[8];\n\t\t\tts6 = _in[1] + _in[7];\n\t\t\tts7 = _in[2] + _in[6];\n\t\t\tts8 = _in[3] + _in[5];\n\n\t\t\tout[outPos + 17] = (ts5 + ts7 - ts8) - (ts6 - _in[4]);\n\t\t\tst = (ts5 + ts7 - ts8) * cx[12 + 7] + (ts6 - _in[4]);\n\t\t\tct = (tc1 - tc3 - tc4) * cx[12 + 6];\n\t\t\tout[outPos + 5] = ct + st;\n\t\t\tout[outPos + 6] = ct - st;\n\n\t\t\ttc2 = (_in[16] - _in[10]) * cx[12 + 6];\n\t\t\tts6 = ts6 * cx[12 + 7] + _in[4];\n\t\t\tct = tc1 * cx[12 + 0] + tc2 + tc3 * cx[12 + 1] + tc4 * cx[12 + 2];\n\t\t\tst = -ts5 * cx[12 + 4] + ts6 - ts7 * cx[12 + 5] + ts8 * cx[12 + 3];\n\t\t\tout[outPos + 1] = ct + st;\n\t\t\tout[outPos + 2] = ct - st;\n\n\t\t\tct = tc1 * cx[12 + 1] - tc2 - tc3 * cx[12 + 2] + tc4 * cx[12 + 0];\n\t\t\tst = -ts5 * cx[12 + 5] + ts6 - ts7 * cx[12 + 3] + ts8 * cx[12 + 4];\n\t\t\tout[outPos + 9] = ct + st;\n\t\t\tout[outPos + 10] = ct - st;\n\n\t\t\tct = tc1 * cx[12 + 2] - tc2 + tc3 * cx[12 + 0] - tc4 * cx[12 + 1];\n\t\t\tst = ts5 * cx[12 + 3] - ts6 + ts7 * cx[12 + 4] - ts8 * cx[12 + 5];\n\t\t\tout[outPos + 13] = ct + st;\n\t\t\tout[outPos + 14] = ct - st;\n\t\t}\n\t\t{\n\t\t\tvar ts1, ts2, ts3, ts4, tc5, tc6, tc7, tc8;\n\n\t\t\tts1 = _in[8] - _in[0];\n\t\t\tts3 = _in[6] - _in[2];\n\t\t\tts4 = _in[5] - _in[3];\n\t\t\ttc5 = _in[17] + _in[9];\n\t\t\ttc6 = _in[16] + _in[10];\n\t\t\ttc7 = _in[15] + _in[11];\n\t\t\ttc8 = _in[14] + _in[12];\n\n\t\t\tout[outPos + 0] = (tc5 + tc7 + tc8) + (tc6 + _in[13]);\n\t\t\tct = (tc5 + tc7 + tc8) * cx[12 + 7] - (tc6 + _in[13]);\n\t\t\tst = (ts1 - ts3 + ts4) * cx[12 + 6];\n\t\t\tout[outPos + 11] = ct + st;\n\t\t\tout[outPos + 12] = ct - st;\n\n\t\t\tts2 = (_in[7] - _in[1]) * cx[12 + 6];\n\t\t\ttc6 = _in[13] - tc6 * cx[12 + 7];\n\t\t\tct = tc5 * cx[12 + 3] - tc6 + tc7 * cx[12 + 4] + tc8 * cx[12 + 5];\n\t\t\tst = ts1 * cx[12 + 2] + ts2 + ts3 * cx[12 + 0] + ts4 * cx[12 + 1];\n\t\t\tout[outPos + 3] = ct + st;\n\t\t\tout[outPos + 4] = ct - st;\n\n\t\t\tct = -tc5 * cx[12 + 5] + tc6 - tc7 * cx[12 + 3] - tc8 * cx[12 + 4];\n\t\t\tst = ts1 * cx[12 + 1] + ts2 - ts3 * cx[12 + 2] - ts4 * cx[12 + 0];\n\t\t\tout[outPos + 7] = ct + st;\n\t\t\tout[outPos + 8] = ct - st;\n\n\t\t\tct = -tc5 * cx[12 + 4] + tc6 - tc7 * cx[12 + 5] - tc8 * cx[12 + 3];\n\t\t\tst = ts1 * cx[12 + 0] - ts2 + ts3 * cx[12 + 1] - ts4 * cx[12 + 2];\n\t\t\tout[outPos + 15] = ct + st;\n\t\t\tout[outPos + 16] = ct - st;\n\t\t}\n\t}\n\n\tthis.mdct_sub48 = function(gfc, w0, w1) {\n\t\tvar wk = w0;\n\t\tvar wkPos = 286;\n\t\t/* thinking cache performance, ch->gr loop is better than gr->ch loop */\n\t\tfor (var ch = 0; ch < gfc.channels_out; ch++) {\n\t\t\tfor (var gr = 0; gr < gfc.mode_gr; gr++) {\n\t\t\t\tvar band;\n\t\t\t\tvar gi = (gfc.l3_side.tt[gr][ch]);\n\t\t\t\tvar mdct_enc = gi.xr;\n\t\t\t\tvar mdct_encPos = 0;\n\t\t\t\tvar samp = gfc.sb_sample[ch][1 - gr];\n\t\t\t\tvar sampPos = 0;\n\n\t\t\t\tfor (var k = 0; k < 18 / 2; k++) {\n\t\t\t\t\twindow_subband(wk, wkPos, samp[sampPos]);\n\t\t\t\t\twindow_subband(wk, wkPos + 32, samp[sampPos + 1]);\n\t\t\t\t\tsampPos += 2;\n\t\t\t\t\twkPos += 64;\n\t\t\t\t\t/*\n\t\t\t\t\t * Compensate for inversion in the analysis filter\n\t\t\t\t\t */\n\t\t\t\t\tfor (band = 1; band < 32; band += 2) {\n\t\t\t\t\t\tsamp[sampPos - 1][band] *= -1;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t/*\n\t\t\t\t * Perform imdct of 18 previous subband samples + 18 current\n\t\t\t\t * subband samples\n\t\t\t\t */\n\t\t\t\tfor (band = 0; band < 32; band++, mdct_encPos += 18) {\n\t\t\t\t\tvar type = gi.block_type;\n\t\t\t\t\tvar band0 = gfc.sb_sample[ch][gr];\n\t\t\t\t\tvar band1 = gfc.sb_sample[ch][1 - gr];\n\t\t\t\t\tif (gi.mixed_block_flag != 0 && band < 2)\n\t\t\t\t\t\ttype = 0;\n\t\t\t\t\tif (gfc.amp_filter[band] < 1e-12) {\n\t\t\t\t\t\tArrays.fill(mdct_enc, mdct_encPos + 0,\n\t\t\t\t\t\t\t\tmdct_encPos + 18, 0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (gfc.amp_filter[band] < 1.0) {\n\t\t\t\t\t\t\tfor (var k = 0; k < 18; k++)\n\t\t\t\t\t\t\t\tband1[k][order[band]] *= gfc.amp_filter[band];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (type == Encoder.SHORT_TYPE) {\n\t\t\t\t\t\t\tfor (var k = -NS / 4; k < 0; k++) {\n\t\t\t\t\t\t\t\tvar w = win[Encoder.SHORT_TYPE][k + 3];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 9] = band0[9 + k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w - band0[8 - k][order[band]];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 18] = band0[14 - k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w + band0[15 + k][order[band]];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 10] = band0[15 + k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w - band0[14 - k][order[band]];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 19] = band1[2 - k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w + band1[3 + k][order[band]];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 11] = band1[3 + k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w - band1[2 - k][order[band]];\n\t\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k * 3 + 20] = band1[8 - k][order[band]]\n\t\t\t\t\t\t\t\t\t\t* w + band1[9 + k][order[band]];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tmdct_short(mdct_enc, mdct_encPos);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar work = new_float(18);\n\t\t\t\t\t\t\tfor (var k = -NL / 4; k < 0; k++) {\n\t\t\t\t\t\t\t\tvar a, b;\n\t\t\t\t\t\t\t\ta = win[type][k + 27]\n\t\t\t\t\t\t\t\t\t\t* band1[k + 9][order[band]]\n\t\t\t\t\t\t\t\t\t\t+ win[type][k + 36]\n\t\t\t\t\t\t\t\t\t\t* band1[8 - k][order[band]];\n\t\t\t\t\t\t\t\tb = win[type][k + 9]\n\t\t\t\t\t\t\t\t\t\t* band0[k + 9][order[band]]\n\t\t\t\t\t\t\t\t\t\t- win[type][k + 18]\n\t\t\t\t\t\t\t\t\t\t* band0[8 - k][order[band]];\n\t\t\t\t\t\t\t\twork[k + 9] = a - b * tantab_l[3 + k + 9];\n\t\t\t\t\t\t\t\twork[k + 18] = a * tantab_l[3 + k + 9] + b;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tmdct_long(mdct_enc, mdct_encPos, work);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t/*\n\t\t\t\t\t * Perform aliasing reduction butterfly\n\t\t\t\t\t */\n\t\t\t\t\tif (type != Encoder.SHORT_TYPE && band != 0) {\n\t\t\t\t\t\tfor (var k = 7; k >= 0; --k) {\n\t\t\t\t\t\t\tvar bu, bd;\n\t\t\t\t\t\t\tbu = mdct_enc[mdct_encPos + k] * ca[20 + k]\n\t\t\t\t\t\t\t\t\t+ mdct_enc[mdct_encPos + -1 - k]\n\t\t\t\t\t\t\t\t\t* cs[28 + k];\n\t\t\t\t\t\t\tbd = mdct_enc[mdct_encPos + k] * cs[28 + k]\n\t\t\t\t\t\t\t\t\t- mdct_enc[mdct_encPos + -1 - k]\n\t\t\t\t\t\t\t\t\t* ca[20 + k];\n\n\t\t\t\t\t\t\tmdct_enc[mdct_encPos + -1 - k] = bu;\n\t\t\t\t\t\t\tmdct_enc[mdct_encPos + k] = bd;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\twk = w1;\n\t\t\twkPos = 286;\n\t\t\tif (gfc.mode_gr == 1) {\n\t\t\t\tfor (var i = 0; i < 18; i++) {\n\t\t\t\t\tSystem.arraycopy(gfc.sb_sample[ch][1][i], 0,\n\t\t\t\t\t\t\tgfc.sb_sample[ch][0][i], 0, 32);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n//package mp3;\n\n\nfunction III_psy_ratio() {\n\tthis.thm = new III_psy_xmin();\n\tthis.en = new III_psy_xmin();\n}\n\n\n/**\n * ENCDELAY The encoder delay.\n *\n * Minimum allowed is MDCTDELAY (see below)\n *\n * The first 96 samples will be attenuated, so using a value less than 96\n * will result in corrupt data for the first 96-ENCDELAY samples.\n *\n * suggested: 576 set to 1160 to sync with FhG.\n */\nEncoder.ENCDELAY = 576;\n/**\n * make sure there is at least one complete frame after the last frame\n * containing real data\n *\n * Using a value of 288 would be sufficient for a a very sophisticated\n * decoder that can decode granule-by-granule instead of frame by frame. But\n * lets not assume this, and assume the decoder will not decode frame N\n * unless it also has data for frame N+1\n */\nEncoder.POSTDELAY = 1152;\n\n/**\n * delay of the MDCT used in mdct.c original ISO routines had a delay of\n * 528! Takehiro's routines:\n */\nEncoder.MDCTDELAY = 48;\nEncoder.FFTOFFSET = (224 + Encoder.MDCTDELAY);\n\n/**\n * Most decoders, including the one we use, have a delay of 528 samples.\n */\nEncoder.DECDELAY = 528;\n\n/**\n * number of subbands\n */\nEncoder.SBLIMIT = 32;\n\n/**\n * parition bands bands\n */\nEncoder.CBANDS = 64;\n\n/**\n * number of critical bands/scale factor bands where masking is computed\n */\nEncoder.SBPSY_l = 21;\nEncoder.SBPSY_s = 12;\n\n/**\n * total number of scalefactor bands encoded\n */\nEncoder.SBMAX_l = 22;\nEncoder.SBMAX_s = 13;\nEncoder.PSFB21 = 6;\nEncoder.PSFB12 = 6;\n\n/**\n * FFT sizes\n */\nEncoder.BLKSIZE = 1024;\nEncoder.HBLKSIZE = (Encoder.BLKSIZE / 2 + 1);\nEncoder.BLKSIZE_s = 256;\nEncoder.HBLKSIZE_s = (Encoder.BLKSIZE_s / 2 + 1);\n\nEncoder.NORM_TYPE = 0;\nEncoder.START_TYPE = 1;\nEncoder.SHORT_TYPE = 2;\nEncoder.STOP_TYPE = 3;\n\n/**\n * <PRE>\n * Mode Extention:\n * When we are in stereo mode, there are 4 possible methods to store these\n * two channels. The stereo modes -m? are using a subset of them.\n *\n *  -ms: MPG_MD_LR_LR\n *  -mj: MPG_MD_LR_LR and MPG_MD_MS_LR\n *  -mf: MPG_MD_MS_LR\n *  -mi: all\n * </PRE>\n */\nEncoder.MPG_MD_LR_LR = 0;\nEncoder.MPG_MD_LR_I = 1;\nEncoder.MPG_MD_MS_LR = 2;\nEncoder.MPG_MD_MS_I = 3;\n\nEncoder.fircoef = [-0.0207887 * 5, -0.0378413 * 5,\n    -0.0432472 * 5, -0.031183 * 5, 7.79609e-18 * 5, 0.0467745 * 5,\n    0.10091 * 5, 0.151365 * 5, 0.187098 * 5];\n\nfunction Encoder() {\n\n    var FFTOFFSET = Encoder.FFTOFFSET;\n    var MPG_MD_MS_LR = Encoder.MPG_MD_MS_LR;\n    //BitStream bs;\n    //PsyModel psy;\n    //VBRTag vbr;\n    //QuantizePVT qupvt;\n    var bs = null;\n    this.psy = null;\n    var psy = null;\n    var vbr = null;\n    var qupvt = null;\n\n    //public final void setModules(BitStream bs, PsyModel psy, QuantizePVT qupvt,\n    //    VBRTag vbr) {\n    this.setModules = function (_bs, _psy, _qupvt, _vbr) {\n        bs = _bs;\n        this.psy = _psy;\n        psy = _psy;\n        vbr = _vbr;\n        qupvt = _qupvt;\n    };\n\n    var newMDCT = new NewMDCT();\n\n    /***********************************************************************\n     *\n     * encoder and decoder delays\n     *\n     ***********************************************************************/\n\n    /**\n     * <PRE>\n     * layer III enc->dec delay:  1056 (1057?)   (observed)\n     * layer  II enc->dec delay:   480  (481?)   (observed)\n     *\n     * polyphase 256-16             (dec or enc)        = 240\n     * mdct      256+32  (9*32)     (dec or enc)        = 288\n     * total:    512+16\n     *\n     * My guess is that delay of polyphase filterbank is actualy 240.5\n     * (there are technical reasons for this, see postings in mp3encoder).\n     * So total Encode+Decode delay = ENCDELAY + 528 + 1\n     * </PRE>\n     */\n\n\n    /**\n     * auto-adjust of ATH, useful for low volume Gabriel Bouvigne 3 feb 2001\n     *\n     * modifies some values in gfp.internal_flags.ATH (gfc.ATH)\n     */\n//private void adjust_ATH(final LameInternalFlags gfc) {\n    function adjust_ATH(gfc) {\n        var gr2_max, max_pow;\n\n        if (gfc.ATH.useAdjust == 0) {\n            gfc.ATH.adjust = 1.0;\n            /* no adjustment */\n            return;\n        }\n\n        /* jd - 2001 mar 12, 27, jun 30 */\n        /* loudness based on equal loudness curve; */\n        /* use granule with maximum combined loudness */\n        max_pow = gfc.loudness_sq[0][0];\n        gr2_max = gfc.loudness_sq[1][0];\n        if (gfc.channels_out == 2) {\n            max_pow += gfc.loudness_sq[0][1];\n            gr2_max += gfc.loudness_sq[1][1];\n        } else {\n            max_pow += max_pow;\n            gr2_max += gr2_max;\n        }\n        if (gfc.mode_gr == 2) {\n            max_pow = Math.max(max_pow, gr2_max);\n        }\n        max_pow *= 0.5;\n        /* max_pow approaches 1.0 for full band noise */\n\n        /* jd - 2001 mar 31, jun 30 */\n        /* user tuning of ATH adjustment region */\n        max_pow *= gfc.ATH.aaSensitivityP;\n\n        /*\n         * adjust ATH depending on range of maximum value\n         */\n\n        /* jd - 2001 feb27, mar12,20, jun30, jul22 */\n        /* continuous curves based on approximation */\n        /* to GB's original values. */\n        /* For an increase in approximate loudness, */\n        /* set ATH adjust to adjust_limit immediately */\n        /* after a delay of one frame. */\n        /* For a loudness decrease, reduce ATH adjust */\n        /* towards adjust_limit gradually. */\n        /* max_pow is a loudness squared or a power. */\n        if (max_pow > 0.03125) { /* ((1 - 0.000625)/ 31.98) from curve below */\n            if (gfc.ATH.adjust >= 1.0) {\n                gfc.ATH.adjust = 1.0;\n            } else {\n                /* preceding frame has lower ATH adjust; */\n                /* ascend only to the preceding adjust_limit */\n                /* in case there is leading low volume */\n                if (gfc.ATH.adjust < gfc.ATH.adjustLimit) {\n                    gfc.ATH.adjust = gfc.ATH.adjustLimit;\n                }\n            }\n            gfc.ATH.adjustLimit = 1.0;\n        } else { /* adjustment curve */\n            /* about 32 dB maximum adjust (0.000625) */\n            var adj_lim_new = 31.98 * max_pow + 0.000625;\n            if (gfc.ATH.adjust >= adj_lim_new) { /* descend gradually */\n                gfc.ATH.adjust *= adj_lim_new * 0.075 + 0.925;\n                if (gfc.ATH.adjust < adj_lim_new) { /* stop descent */\n                    gfc.ATH.adjust = adj_lim_new;\n                }\n            } else { /* ascend */\n                if (gfc.ATH.adjustLimit >= adj_lim_new) {\n                    gfc.ATH.adjust = adj_lim_new;\n                } else {\n                    /* preceding frame has lower ATH adjust; */\n                    /* ascend only to the preceding adjust_limit */\n                    if (gfc.ATH.adjust < gfc.ATH.adjustLimit) {\n                        gfc.ATH.adjust = gfc.ATH.adjustLimit;\n                    }\n                }\n            }\n            gfc.ATH.adjustLimit = adj_lim_new;\n        }\n    }\n\n    /**\n     * <PRE>\n     *  some simple statistics\n     *\n     *  bitrate index 0: free bitrate . not allowed in VBR mode\n     *  : bitrates, kbps depending on MPEG version\n     *  bitrate index 15: forbidden\n     *\n     *  mode_ext:\n     *  0:  LR\n     *  1:  LR-i\n     *  2:  MS\n     *  3:  MS-i\n     * </PRE>\n     */\n    function updateStats(gfc) {\n        var gr, ch;\n\n        /* count bitrate indices */\n        gfc.bitrate_stereoMode_Hist[gfc.bitrate_index][4]++;\n        gfc.bitrate_stereoMode_Hist[15][4]++;\n\n        /* count 'em for every mode extension in case of 2 channel encoding */\n        if (gfc.channels_out == 2) {\n            gfc.bitrate_stereoMode_Hist[gfc.bitrate_index][gfc.mode_ext]++;\n            gfc.bitrate_stereoMode_Hist[15][gfc.mode_ext]++;\n        }\n        for (gr = 0; gr < gfc.mode_gr; ++gr) {\n            for (ch = 0; ch < gfc.channels_out; ++ch) {\n                var bt = gfc.l3_side.tt[gr][ch].block_type | 0;\n                if (gfc.l3_side.tt[gr][ch].mixed_block_flag != 0)\n                    bt = 4;\n                gfc.bitrate_blockType_Hist[gfc.bitrate_index][bt]++;\n                gfc.bitrate_blockType_Hist[gfc.bitrate_index][5]++;\n                gfc.bitrate_blockType_Hist[15][bt]++;\n                gfc.bitrate_blockType_Hist[15][5]++;\n            }\n        }\n    }\n\n    function lame_encode_frame_init(gfp, inbuf) {\n        var gfc = gfp.internal_flags;\n\n        var ch, gr;\n\n        if (gfc.lame_encode_frame_init == 0) {\n            /* prime the MDCT/polyphase filterbank with a short block */\n            var i, j;\n            var primebuff0 = new_float(286 + 1152 + 576);\n            var primebuff1 = new_float(286 + 1152 + 576);\n            gfc.lame_encode_frame_init = 1;\n            for (i = 0, j = 0; i < 286 + 576 * (1 + gfc.mode_gr); ++i) {\n                if (i < 576 * gfc.mode_gr) {\n                    primebuff0[i] = 0;\n                    if (gfc.channels_out == 2)\n                        primebuff1[i] = 0;\n                } else {\n                    primebuff0[i] = inbuf[0][j];\n                    if (gfc.channels_out == 2)\n                        primebuff1[i] = inbuf[1][j];\n                    ++j;\n                }\n            }\n            /* polyphase filtering / mdct */\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    gfc.l3_side.tt[gr][ch].block_type = Encoder.SHORT_TYPE;\n                }\n            }\n            newMDCT.mdct_sub48(gfc, primebuff0, primebuff1);\n\n            /* check FFT will not use a negative starting offset */\n            /* check if we have enough data for FFT */\n            /* check if we have enough data for polyphase filterbank */\n        }\n\n    }\n\n    /**\n     * <PRE>\n     * encodeframe()           Layer 3\n     *\n     * encode a single frame\n     *\n     *\n     *    lame_encode_frame()\n     *\n     *\n     *                           gr 0            gr 1\n     *    inbuf:           |--------------|--------------|--------------|\n     *\n     *\n     *    Polyphase (18 windows, each shifted 32)\n     *    gr 0:\n     *    window1          <----512---.\n     *    window18                 <----512---.\n     *\n     *    gr 1:\n     *    window1                         <----512---.\n     *    window18                                <----512---.\n     *\n     *\n     *\n     *    MDCT output:  |--------------|--------------|--------------|\n     *\n     *    FFT's                    <---------1024---------.\n     *                                             <---------1024-------.\n     *\n     *\n     *\n     *        inbuf = buffer of PCM data size=MP3 framesize\n     *        encoder acts on inbuf[ch][0], but output is delayed by MDCTDELAY\n     *        so the MDCT coefficints are from inbuf[ch][-MDCTDELAY]\n     *\n     *        psy-model FFT has a 1 granule delay, so we feed it data for the\n     *        next granule.\n     *        FFT is centered over granule:  224+576+224\n     *        So FFT starts at:   576-224-MDCTDELAY\n     *\n     *        MPEG2:  FFT ends at:  BLKSIZE+576-224-MDCTDELAY      (1328)\n     *        MPEG1:  FFT ends at:  BLKSIZE+2*576-224-MDCTDELAY    (1904)\n     *\n     *        MPEG2:  polyphase first window:  [0..511]\n     *                          18th window:   [544..1055]          (1056)\n     *        MPEG1:            36th window:   [1120..1631]         (1632)\n     *                data needed:  512+framesize-32\n     *\n     *        A close look newmdct.c shows that the polyphase filterbank\n     *        only uses data from [0..510] for each window.  Perhaps because the window\n     *        used by the filterbank is zero for the last point, so Takehiro's\n     *        code doesn't bother to compute with it.\n     *\n     *        FFT starts at 576-224-MDCTDELAY (304)  = 576-FFTOFFSET\n     *\n     * </PRE>\n     */\n\n\n    this.lame_encode_mp3_frame = function (gfp, inbuf_l, inbuf_r, mp3buf, mp3bufPos, mp3buf_size) {\n        var mp3count;\n        var masking_LR = new_array_n([2, 2]);\n        /*\n         * LR masking &\n         * energy\n         */\n        masking_LR[0][0] = new III_psy_ratio();\n        masking_LR[0][1] = new III_psy_ratio();\n        masking_LR[1][0] = new III_psy_ratio();\n        masking_LR[1][1] = new III_psy_ratio();\n        var masking_MS = new_array_n([2, 2]);\n        /* MS masking & energy */\n        masking_MS[0][0] = new III_psy_ratio();\n        masking_MS[0][1] = new III_psy_ratio();\n        masking_MS[1][0] = new III_psy_ratio();\n        masking_MS[1][1] = new III_psy_ratio();\n        //III_psy_ratio masking[][];\n        var masking;\n        /* pointer to selected maskings */\n        var inbuf = [null, null];\n        var gfc = gfp.internal_flags;\n\n        var tot_ener = new_float_n([2, 4]);\n        var ms_ener_ratio = [.5, .5];\n        var pe = [[0., 0.], [0., 0.]];\n        var pe_MS = [[0., 0.], [0., 0.]];\n\n//float[][] pe_use;\n        var pe_use;\n\n        var ch, gr;\n\n        inbuf[0] = inbuf_l;\n        inbuf[1] = inbuf_r;\n\n        if (gfc.lame_encode_frame_init == 0) {\n            /* first run? */\n            lame_encode_frame_init(gfp, inbuf);\n\n        }\n\n        /********************** padding *****************************/\n        /**\n         * <PRE>\n         * padding method as described in\n         * \"MPEG-Layer3 / Bitstream Syntax and Decoding\"\n         * by Martin Sieler, Ralph Sperschneider\n         *\n         * note: there is no padding for the very first frame\n         *\n         * Robert Hegemann 2000-06-22\n         * </PRE>\n         */\n        gfc.padding = 0;\n        if ((gfc.slot_lag -= gfc.frac_SpF) < 0) {\n            gfc.slot_lag += gfp.out_samplerate;\n            gfc.padding = 1;\n        }\n\n        /****************************************\n         * Stage 1: psychoacoustic model *\n         ****************************************/\n\n        if (gfc.psymodel != 0) {\n            /*\n             * psychoacoustic model psy model has a 1 granule (576) delay that\n             * we must compensate for (mt 6/99).\n             */\n            var ret;\n            var bufp = [null, null];\n            /* address of beginning of left & right granule */\n            var bufpPos = 0;\n            /* address of beginning of left & right granule */\n            var blocktype = new_int(2);\n\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    bufp[ch] = inbuf[ch];\n                    bufpPos = 576 + gr * 576 - Encoder.FFTOFFSET;\n                }\n                if (gfp.VBR == VbrMode.vbr_mtrh || gfp.VBR == VbrMode.vbr_mt) {\n                    ret = psy.L3psycho_anal_vbr(gfp, bufp, bufpPos, gr,\n                        masking_LR, masking_MS, pe[gr], pe_MS[gr],\n                        tot_ener[gr], blocktype);\n                } else {\n                    ret = psy.L3psycho_anal_ns(gfp, bufp, bufpPos, gr,\n                        masking_LR, masking_MS, pe[gr], pe_MS[gr],\n                        tot_ener[gr], blocktype);\n                }\n                if (ret != 0)\n                    return -4;\n\n                if (gfp.mode == MPEGMode.JOINT_STEREO) {\n                    ms_ener_ratio[gr] = tot_ener[gr][2] + tot_ener[gr][3];\n                    if (ms_ener_ratio[gr] > 0)\n                        ms_ener_ratio[gr] = tot_ener[gr][3] / ms_ener_ratio[gr];\n                }\n\n                /* block type flags */\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    var cod_info = gfc.l3_side.tt[gr][ch];\n                    cod_info.block_type = blocktype[ch];\n                    cod_info.mixed_block_flag = 0;\n                }\n            }\n        } else {\n            /* no psy model */\n            for (gr = 0; gr < gfc.mode_gr; gr++)\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    gfc.l3_side.tt[gr][ch].block_type = Encoder.NORM_TYPE;\n                    gfc.l3_side.tt[gr][ch].mixed_block_flag = 0;\n                    pe_MS[gr][ch] = pe[gr][ch] = 700;\n                }\n        }\n\n        /* auto-adjust of ATH, useful for low volume */\n        adjust_ATH(gfc);\n\n        /****************************************\n         * Stage 2: MDCT *\n         ****************************************/\n\n        /* polyphase filtering / mdct */\n        newMDCT.mdct_sub48(gfc, inbuf[0], inbuf[1]);\n\n        /****************************************\n         * Stage 3: MS/LR decision *\n         ****************************************/\n\n        /* Here will be selected MS or LR coding of the 2 stereo channels */\n        gfc.mode_ext = Encoder.MPG_MD_LR_LR;\n\n        if (gfp.force_ms) {\n            gfc.mode_ext = Encoder.MPG_MD_MS_LR;\n        } else if (gfp.mode == MPEGMode.JOINT_STEREO) {\n            /*\n             * ms_ratio = is scaled, for historical reasons, to look like a\n             * ratio of side_channel / total. 0 = signal is 100% mono .5 = L & R\n             * uncorrelated\n             */\n\n            /**\n             * <PRE>\n             * [0] and [1] are the results for the two granules in MPEG-1,\n             * in MPEG-2 it's only a faked averaging of the same value\n             * _prev is the value of the last granule of the previous frame\n             * _next is the value of the first granule of the next frame\n             * </PRE>\n             */\n\n            var sum_pe_MS = 0.;\n            var sum_pe_LR = 0.;\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    sum_pe_MS += pe_MS[gr][ch];\n                    sum_pe_LR += pe[gr][ch];\n                }\n            }\n\n            /* based on PE: M/S coding would not use much more bits than L/R */\n            if (sum_pe_MS <= 1.00 * sum_pe_LR) {\n\n                var gi0 = gfc.l3_side.tt[0];\n                var gi1 = gfc.l3_side.tt[gfc.mode_gr - 1];\n\n                if (gi0[0].block_type == gi0[1].block_type\n                    && gi1[0].block_type == gi1[1].block_type) {\n\n                    gfc.mode_ext = Encoder.MPG_MD_MS_LR;\n                }\n            }\n        }\n\n        /* bit and noise allocation */\n        if (gfc.mode_ext == MPG_MD_MS_LR) {\n            masking = masking_MS;\n            /* use MS masking */\n            pe_use = pe_MS;\n        } else {\n            masking = masking_LR;\n            /* use LR masking */\n            pe_use = pe;\n        }\n\n        /* copy data for MP3 frame analyzer */\n        if (gfp.analysis && gfc.pinfo != null) {\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    gfc.pinfo.ms_ratio[gr] = gfc.ms_ratio[gr];\n                    gfc.pinfo.ms_ener_ratio[gr] = ms_ener_ratio[gr];\n                    gfc.pinfo.blocktype[gr][ch] = gfc.l3_side.tt[gr][ch].block_type;\n                    gfc.pinfo.pe[gr][ch] = pe_use[gr][ch];\n                    System.arraycopy(gfc.l3_side.tt[gr][ch].xr, 0,\n                        gfc.pinfo.xr[gr][ch], 0, 576);\n                    /*\n                     * in psymodel, LR and MS data was stored in pinfo. switch\n                     * to MS data:\n                     */\n                    if (gfc.mode_ext == MPG_MD_MS_LR) {\n                        gfc.pinfo.ers[gr][ch] = gfc.pinfo.ers[gr][ch + 2];\n                        System.arraycopy(gfc.pinfo.energy[gr][ch + 2], 0,\n                            gfc.pinfo.energy[gr][ch], 0,\n                            gfc.pinfo.energy[gr][ch].length);\n                    }\n                }\n            }\n        }\n\n        /****************************************\n         * Stage 4: quantization loop *\n         ****************************************/\n\n        if (gfp.VBR == VbrMode.vbr_off || gfp.VBR == VbrMode.vbr_abr) {\n\n            var i;\n            var f;\n\n            for (i = 0; i < 18; i++)\n                gfc.nsPsy.pefirbuf[i] = gfc.nsPsy.pefirbuf[i + 1];\n\n            f = 0.0;\n            for (gr = 0; gr < gfc.mode_gr; gr++)\n                for (ch = 0; ch < gfc.channels_out; ch++)\n                    f += pe_use[gr][ch];\n            gfc.nsPsy.pefirbuf[18] = f;\n\n            f = gfc.nsPsy.pefirbuf[9];\n            for (i = 0; i < 9; i++)\n                f += (gfc.nsPsy.pefirbuf[i] + gfc.nsPsy.pefirbuf[18 - i])\n                    * Encoder.fircoef[i];\n\n            f = (670 * 5 * gfc.mode_gr * gfc.channels_out) / f;\n            for (gr = 0; gr < gfc.mode_gr; gr++) {\n                for (ch = 0; ch < gfc.channels_out; ch++) {\n                    pe_use[gr][ch] *= f;\n                }\n            }\n        }\n        gfc.iteration_loop.iteration_loop(gfp, pe_use, ms_ener_ratio, masking);\n\n        /****************************************\n         * Stage 5: bitstream formatting *\n         ****************************************/\n\n        /* write the frame to the bitstream */\n        bs.format_bitstream(gfp);\n\n        /* copy mp3 bit buffer into array */\n        mp3count = bs.copy_buffer(gfc, mp3buf, mp3bufPos, mp3buf_size, 1);\n\n        if (gfp.bWriteVbrTag)\n            vbr.addVbrFrame(gfp);\n\n        if (gfp.analysis && gfc.pinfo != null) {\n            for (ch = 0; ch < gfc.channels_out; ch++) {\n                var j;\n                for (j = 0; j < FFTOFFSET; j++)\n                    gfc.pinfo.pcmdata[ch][j] = gfc.pinfo.pcmdata[ch][j\n                    + gfp.framesize];\n                for (j = FFTOFFSET; j < 1600; j++) {\n                    gfc.pinfo.pcmdata[ch][j] = inbuf[ch][j - FFTOFFSET];\n                }\n            }\n            qupvt.set_frame_pinfo(gfp, masking);\n        }\n\n        updateStats(gfc);\n\n        return mp3count;\n    }\n}\n\n\n//package mp3;\n\nfunction VBRSeekInfo() {\n    /**\n     * What we have seen so far.\n     */\n    this.sum = 0;\n    /**\n     * How many frames we have seen in this chunk.\n     */\n    this.seen = 0;\n    /**\n     * How many frames we want to collect into one chunk.\n     */\n    this.want = 0;\n    /**\n     * Actual position in our bag.\n     */\n    this.pos = 0;\n    /**\n     * Size of our bag.\n     */\n    this.size = 0;\n    /**\n     * Pointer to our bag.\n     */\n    this.bag = null;\n    this.nVbrNumFrames = 0;\n    this.nBytesWritten = 0;\n    /* VBR tag data */\n    this.TotalFrameSize = 0;\n}\n\n\n\nfunction IIISideInfo() {\n    this.tt = [[null, null], [null, null]];\n    this.main_data_begin = 0;\n    this.private_bits = 0;\n    this.resvDrain_pre = 0;\n    this.resvDrain_post = 0;\n    this.scfsi = [new_int(4), new_int(4)];\n\n    for (var gr = 0; gr < 2; gr++) {\n        for (var ch = 0; ch < 2; ch++) {\n            this.tt[gr][ch] = new GrInfo();\n        }\n    }\n}\n\n\nfunction III_psy_xmin() {\n    this.l = new_float(Encoder.SBMAX_l);\n    this.s = new_float_n([Encoder.SBMAX_s, 3]);\n\n    var self = this;\n    this.assign = function (iii_psy_xmin) {\n        System.arraycopy(iii_psy_xmin.l, 0, self.l, 0, Encoder.SBMAX_l);\n        for (var i = 0; i < Encoder.SBMAX_s; i++) {\n            for (var j = 0; j < 3; j++) {\n                self.s[i][j] = iii_psy_xmin.s[i][j];\n            }\n        }\n    }\n}\n\n\n\n//package mp3;\n\n/**\n * Variables used for --nspsytune\n *\n * @author Ken\n *\n */\nfunction NsPsy() {\n    this.last_en_subshort = new_float_n([4, 9]);\n    this.lastAttacks = new_int(4);\n    this.pefirbuf = new_float(19);\n    this.longfact = new_float(Encoder.SBMAX_l);\n    this.shortfact = new_float(Encoder.SBMAX_s);\n\n    /**\n     * short block tuning\n     */\n    this.attackthre = 0.;\n    this.attackthre_s = 0.;\n}\n\n\n\n\nLameInternalFlags.MFSIZE = (3 * 1152 + Encoder.ENCDELAY - Encoder.MDCTDELAY);\nLameInternalFlags.MAX_HEADER_BUF = 256;\nLameInternalFlags.MAX_BITS_PER_CHANNEL = 4095;\nLameInternalFlags.MAX_BITS_PER_GRANULE = 7680;\nLameInternalFlags.BPC = 320;\n\nfunction LameInternalFlags() {\n    var MAX_HEADER_LEN = 40;\n\n\n    /********************************************************************\n     * internal variables NOT set by calling program, and should not be *\n     * modified by the calling program *\n     ********************************************************************/\n\n    /**\n     * Some remarks to the Class_ID field: The Class ID is an Identifier for a\n     * pointer to this struct. It is very unlikely that a pointer to\n     * lame_global_flags has the same 32 bits in it's structure (large and other\n     * special properties, for instance prime).\n     *\n     * To test that the structure is right and initialized, use: if ( gfc .\n     * Class_ID == LAME_ID ) ... Other remark: If you set a flag to 0 for uninit\n     * data and 1 for init data, the right test should be \"if (flag == 1)\" and\n     * NOT \"if (flag)\". Unintended modification of this element will be\n     * otherwise misinterpreted as an init.\n     */\n    this.Class_ID = 0;\n\n    this.lame_encode_frame_init = 0;\n    this.iteration_init_init = 0;\n    this.fill_buffer_resample_init = 0;\n\n    //public float mfbuf[][] = new float[2][MFSIZE];\n    this.mfbuf = new_float_n([2, LameInternalFlags.MFSIZE]);\n\n    /**\n     * granules per frame\n     */\n    this.mode_gr = 0;\n    /**\n     * number of channels in the input data stream (PCM or decoded PCM)\n     */\n    this.channels_in = 0;\n    /**\n     * number of channels in the output data stream (not used for decoding)\n     */\n    this.channels_out = 0;\n    /**\n     * input_samp_rate/output_samp_rate\n     */\n        //public double resample_ratio;\n    this.resample_ratio = 0.;\n\n    this.mf_samples_to_encode = 0;\n    this.mf_size = 0;\n    /**\n     * min bitrate index\n     */\n    this.VBR_min_bitrate = 0;\n    /**\n     * max bitrate index\n     */\n    this.VBR_max_bitrate = 0;\n    this.bitrate_index = 0;\n    this.samplerate_index = 0;\n    this.mode_ext = 0;\n\n    /* lowpass and highpass filter control */\n    /**\n     * normalized frequency bounds of passband\n     */\n    this.lowpass1 = 0.;\n    this.lowpass2 = 0.;\n    /**\n     * normalized frequency bounds of passband\n     */\n    this.highpass1 = 0.;\n    this.highpass2 = 0.;\n\n    /**\n     * 0 = none 1 = ISO AAC model 2 = allow scalefac_select=1\n     */\n    this.noise_shaping = 0;\n\n    /**\n     * 0 = ISO model: amplify all distorted bands<BR>\n     * 1 = amplify within 50% of max (on db scale)<BR>\n     * 2 = amplify only most distorted band<BR>\n     * 3 = method 1 and refine with method 2<BR>\n     */\n    this.noise_shaping_amp = 0;\n    /**\n     * 0 = no substep<BR>\n     * 1 = use substep shaping at last step(VBR only)<BR>\n     * (not implemented yet)<BR>\n     * 2 = use substep inside loop<BR>\n     * 3 = use substep inside loop and last step<BR>\n     */\n    this.substep_shaping = 0;\n\n    /**\n     * 1 = gpsycho. 0 = none\n     */\n    this.psymodel = 0;\n    /**\n     * 0 = stop at over=0, all scalefacs amplified or<BR>\n     * a scalefac has reached max value<BR>\n     * 1 = stop when all scalefacs amplified or a scalefac has reached max value<BR>\n     * 2 = stop when all scalefacs amplified\n     */\n    this.noise_shaping_stop = 0;\n\n    /**\n     * 0 = no, 1 = yes\n     */\n    this.subblock_gain = 0;\n    /**\n     * 0 = no. 1=outside loop 2=inside loop(slow)\n     */\n    this.use_best_huffman = 0;\n\n    /**\n     * 0 = stop early after 0 distortion found. 1 = full search\n     */\n    this.full_outer_loop = 0;\n\n    //public IIISideInfo l3_side = new IIISideInfo();\n    this.l3_side = new IIISideInfo();\n    this.ms_ratio = new_float(2);\n\n    /* used for padding */\n    /**\n     * padding for the current frame?\n     */\n    this.padding = 0;\n    this.frac_SpF = 0;\n    this.slot_lag = 0;\n\n    /**\n     * optional ID3 tags\n     */\n        //public ID3TagSpec tag_spec;\n    this.tag_spec = null;\n    this.nMusicCRC = 0;\n\n    /* variables used by Quantize */\n    //public int OldValue[] = new int[2];\n    this.OldValue = new_int(2);\n    //public int CurrentStep[] = new int[2];\n    this.CurrentStep = new_int(2);\n\n    this.masking_lower = 0.;\n    //public int bv_scf[] = new int[576];\n    this.bv_scf = new_int(576);\n    //public int pseudohalf[] = new int[L3Side.SFBMAX];\n    this.pseudohalf = new_int(L3Side.SFBMAX);\n\n    /**\n     * will be set in lame_init_params\n     */\n    this.sfb21_extra = false;\n\n    /* BPC = maximum number of filter convolution windows to precompute */\n    //public float[][] inbuf_old = new float[2][];\n    this.inbuf_old = new Array(2);\n    //public float[][] blackfilt = new float[2 * BPC + 1][];\n    this.blackfilt = new Array(2 * LameInternalFlags.BPC + 1);\n    //public double itime[] = new double[2];\n    this.itime = new_double(2);\n    this.sideinfo_len = 0;\n\n    /* variables for newmdct.c */\n    //public float sb_sample[][][][] = new float[2][2][18][Encoder.SBLIMIT];\n    this.sb_sample = new_float_n([2, 2, 18, Encoder.SBLIMIT]);\n    this.amp_filter = new_float(32);\n\n    /* variables for BitStream */\n\n    /**\n     * <PRE>\n     * mpeg1: buffer=511 bytes  smallest frame: 96-38(sideinfo)=58\n     * max number of frames in reservoir:  8\n     * mpeg2: buffer=255 bytes.  smallest frame: 24-23bytes=1\n     * with VBR, if you are encoding all silence, it is possible to\n     * have 8kbs/24khz frames with 1byte of data each, which means we need\n     * to buffer up to 255 headers!\n     * </PRE>\n     */\n    /**\n     * also, max_header_buf has to be a power of two\n     */\n    /**\n     * max size of header is 38\n     */\n\n    function Header() {\n        this.write_timing = 0;\n        this.ptr = 0;\n        //public byte buf[] = new byte[MAX_HEADER_LEN];\n        this.buf = new_byte(MAX_HEADER_LEN);\n    }\n\n    this.header = new Array(LameInternalFlags.MAX_HEADER_BUF);\n\n    this.h_ptr = 0;\n    this.w_ptr = 0;\n    this.ancillary_flag = 0;\n\n    /* variables for Reservoir */\n    /**\n     * in bits\n     */\n    this.ResvSize = 0;\n    /**\n     * in bits\n     */\n    this.ResvMax = 0;\n\n    //public ScaleFac scalefac_band = new ScaleFac();\n    this.scalefac_band = new ScaleFac();\n\n    /* daa from PsyModel */\n    /* The static variables \"r\", \"phi_sav\", \"new\", \"old\" and \"oldest\" have */\n    /* to be remembered for the unpredictability measure. For \"r\" and */\n    /* \"phi_sav\", the first index from the left is the channel select and */\n    /* the second index is the \"age\" of the data. */\n    this.minval_l = new_float(Encoder.CBANDS);\n    this.minval_s = new_float(Encoder.CBANDS);\n    this.nb_1 = new_float_n([4, Encoder.CBANDS]);\n    this.nb_2 = new_float_n([4, Encoder.CBANDS]);\n    this.nb_s1 = new_float_n([4, Encoder.CBANDS]);\n    this.nb_s2 = new_float_n([4, Encoder.CBANDS]);\n    this.s3_ss = null;\n    this.s3_ll = null;\n    this.decay = 0.;\n\n    //public III_psy_xmin[] thm = new III_psy_xmin[4];\n    //public III_psy_xmin[] en = new III_psy_xmin[4];\n    this.thm = new Array(4);\n    this.en = new Array(4);\n\n    /**\n     * fft and energy calculation\n     */\n    this.tot_ener = new_float(4);\n\n    /* loudness calculation (for adaptive threshold of hearing) */\n    /**\n     * loudness^2 approx. per granule and channel\n     */\n    this.loudness_sq = new_float_n([2, 2]);\n    /**\n     * account for granule delay of L3psycho_anal\n     */\n    this.loudness_sq_save = new_float(2);\n\n    /**\n     * Scale Factor Bands\n     */\n    this.mld_l = new_float(Encoder.SBMAX_l);\n    this.mld_s = new_float(Encoder.SBMAX_s);\n    this.bm_l = new_int(Encoder.SBMAX_l);\n    this.bo_l = new_int(Encoder.SBMAX_l);\n    this.bm_s = new_int(Encoder.SBMAX_s);\n    this.bo_s = new_int(Encoder.SBMAX_s);\n    this.npart_l = 0;\n    this.npart_s = 0;\n\n    this.s3ind = new_int_n([Encoder.CBANDS, 2]);\n    this.s3ind_s = new_int_n([Encoder.CBANDS, 2]);\n\n    this.numlines_s = new_int(Encoder.CBANDS);\n    this.numlines_l = new_int(Encoder.CBANDS);\n    this.rnumlines_l = new_float(Encoder.CBANDS);\n    this.mld_cb_l = new_float(Encoder.CBANDS);\n    this.mld_cb_s = new_float(Encoder.CBANDS);\n    this.numlines_s_num1 = 0;\n    this.numlines_l_num1 = 0;\n\n    /* ratios */\n    this.pe = new_float(4);\n    this.ms_ratio_s_old = 0.;\n    this.ms_ratio_l_old = 0.;\n    this.ms_ener_ratio_old = 0.;\n\n    /**\n     * block type\n     */\n    this.blocktype_old = new_int(2);\n\n    /**\n     * variables used for --nspsytune\n     */\n    this.nsPsy = new NsPsy();\n\n    /**\n     * used for Xing VBR header\n     */\n    this.VBR_seek_table = new VBRSeekInfo();\n\n    /**\n     * all ATH related stuff\n     */\n        //public ATH ATH;\n    this.ATH = null;\n\n    this.PSY = null;\n\n    this.nogap_total = 0;\n    this.nogap_current = 0;\n\n    /* ReplayGain */\n    this.decode_on_the_fly = true;\n    this.findReplayGain = true;\n    this.findPeakSample = true;\n    this.PeakSample = 0.;\n    this.RadioGain = 0;\n    this.AudiophileGain = 0;\n    //public ReplayGain rgdata;\n    this.rgdata = null;\n\n    /**\n     * gain change required for preventing clipping\n     */\n    this.noclipGainChange = 0;\n    /**\n     * user-specified scale factor required for preventing clipping\n     */\n    this.noclipScale = 0.;\n\n    /* simple statistics */\n    this.bitrate_stereoMode_Hist = new_int_n([16, 4 + 1]);\n    /**\n     * norm/start/short/stop/mixed(short)/sum\n     */\n    this.bitrate_blockType_Hist = new_int_n([16, 4 + 1 + 1]);\n\n    //public PlottingData pinfo;\n    //public MPGLib.mpstr_tag hip;\n    this.pinfo = null;\n    this.hip = null;\n\n    this.in_buffer_nsamples = 0;\n    //public float[] in_buffer_0;\n    //public float[] in_buffer_1;\n    this.in_buffer_0 = null;\n    this.in_buffer_1 = null;\n\n    //public IIterationLoop iteration_loop;\n    this.iteration_loop = null;\n\n    for (var i = 0; i < this.en.length; i++) {\n        this.en[i] = new III_psy_xmin();\n    }\n    for (var i = 0; i < this.thm.length; i++) {\n        this.thm[i] = new III_psy_xmin();\n    }\n    for (var i = 0; i < this.header.length; i++) {\n        this.header[i] = new Header();\n    }\n\n}\n\n\n\nfunction FFT() {\n\n    var window = new_float(Encoder.BLKSIZE);\n    var window_s = new_float(Encoder.BLKSIZE_s / 2);\n\n    var costab = [\n        9.238795325112867e-01, 3.826834323650898e-01,\n        9.951847266721969e-01, 9.801714032956060e-02,\n        9.996988186962042e-01, 2.454122852291229e-02,\n        9.999811752826011e-01, 6.135884649154475e-03\n    ];\n\n    function fht(fz, fzPos, n) {\n        var tri = 0;\n        var k4;\n        var fi;\n        var gi;\n\n        n <<= 1;\n        /* to get BLKSIZE, because of 3DNow! ASM routine */\n        var fn = fzPos + n;\n        k4 = 4;\n        do {\n            var s1, c1;\n            var i, k1, k2, k3, kx;\n            kx = k4 >> 1;\n            k1 = k4;\n            k2 = k4 << 1;\n            k3 = k2 + k1;\n            k4 = k2 << 1;\n            fi = fzPos;\n            gi = fi + kx;\n            do {\n                var f0, f1, f2, f3;\n                f1 = fz[fi + 0] - fz[fi + k1];\n                f0 = fz[fi + 0] + fz[fi + k1];\n                f3 = fz[fi + k2] - fz[fi + k3];\n                f2 = fz[fi + k2] + fz[fi + k3];\n                fz[fi + k2] = f0 - f2;\n                fz[fi + 0] = f0 + f2;\n                fz[fi + k3] = f1 - f3;\n                fz[fi + k1] = f1 + f3;\n                f1 = fz[gi + 0] - fz[gi + k1];\n                f0 = fz[gi + 0] + fz[gi + k1];\n                f3 = (Util.SQRT2 * fz[gi + k3]);\n                f2 = (Util.SQRT2 * fz[gi + k2]);\n                fz[gi + k2] = f0 - f2;\n                fz[gi + 0] = f0 + f2;\n                fz[gi + k3] = f1 - f3;\n                fz[gi + k1] = f1 + f3;\n                gi += k4;\n                fi += k4;\n            } while (fi < fn);\n            c1 = costab[tri + 0];\n            s1 = costab[tri + 1];\n            for (i = 1; i < kx; i++) {\n                var c2, s2;\n                c2 = 1 - (2 * s1) * s1;\n                s2 = (2 * s1) * c1;\n                fi = fzPos + i;\n                gi = fzPos + k1 - i;\n                do {\n                    var a, b, g0, f0, f1, g1, f2, g2, f3, g3;\n                    b = s2 * fz[fi + k1] - c2 * fz[gi + k1];\n                    a = c2 * fz[fi + k1] + s2 * fz[gi + k1];\n                    f1 = fz[fi + 0] - a;\n                    f0 = fz[fi + 0] + a;\n                    g1 = fz[gi + 0] - b;\n                    g0 = fz[gi + 0] + b;\n                    b = s2 * fz[fi + k3] - c2 * fz[gi + k3];\n                    a = c2 * fz[fi + k3] + s2 * fz[gi + k3];\n                    f3 = fz[fi + k2] - a;\n                    f2 = fz[fi + k2] + a;\n                    g3 = fz[gi + k2] - b;\n                    g2 = fz[gi + k2] + b;\n                    b = s1 * f2 - c1 * g3;\n                    a = c1 * f2 + s1 * g3;\n                    fz[fi + k2] = f0 - a;\n                    fz[fi + 0] = f0 + a;\n                    fz[gi + k3] = g1 - b;\n                    fz[gi + k1] = g1 + b;\n                    b = c1 * g2 - s1 * f3;\n                    a = s1 * g2 + c1 * f3;\n                    fz[gi + k2] = g0 - a;\n                    fz[gi + 0] = g0 + a;\n                    fz[fi + k3] = f1 - b;\n                    fz[fi + k1] = f1 + b;\n                    gi += k4;\n                    fi += k4;\n                } while (fi < fn);\n                c2 = c1;\n                c1 = c2 * costab[tri + 0] - s1 * costab[tri + 1];\n                s1 = c2 * costab[tri + 1] + s1 * costab[tri + 0];\n            }\n            tri += 2;\n        } while (k4 < n);\n    }\n\n    var rv_tbl = [0x00, 0x80, 0x40,\n        0xc0, 0x20, 0xa0, 0x60, 0xe0, 0x10,\n        0x90, 0x50, 0xd0, 0x30, 0xb0, 0x70,\n        0xf0, 0x08, 0x88, 0x48, 0xc8, 0x28,\n        0xa8, 0x68, 0xe8, 0x18, 0x98, 0x58,\n        0xd8, 0x38, 0xb8, 0x78, 0xf8, 0x04,\n        0x84, 0x44, 0xc4, 0x24, 0xa4, 0x64,\n        0xe4, 0x14, 0x94, 0x54, 0xd4, 0x34,\n        0xb4, 0x74, 0xf4, 0x0c, 0x8c, 0x4c,\n        0xcc, 0x2c, 0xac, 0x6c, 0xec, 0x1c,\n        0x9c, 0x5c, 0xdc, 0x3c, 0xbc, 0x7c,\n        0xfc, 0x02, 0x82, 0x42, 0xc2, 0x22,\n        0xa2, 0x62, 0xe2, 0x12, 0x92, 0x52,\n        0xd2, 0x32, 0xb2, 0x72, 0xf2, 0x0a,\n        0x8a, 0x4a, 0xca, 0x2a, 0xaa, 0x6a,\n        0xea, 0x1a, 0x9a, 0x5a, 0xda, 0x3a,\n        0xba, 0x7a, 0xfa, 0x06, 0x86, 0x46,\n        0xc6, 0x26, 0xa6, 0x66, 0xe6, 0x16,\n        0x96, 0x56, 0xd6, 0x36, 0xb6, 0x76,\n        0xf6, 0x0e, 0x8e, 0x4e, 0xce, 0x2e,\n        0xae, 0x6e, 0xee, 0x1e, 0x9e, 0x5e,\n        0xde, 0x3e, 0xbe, 0x7e, 0xfe];\n\n    this.fft_short = function (gfc, x_real, chn, buffer, bufPos) {\n        for (var b = 0; b < 3; b++) {\n            var x = Encoder.BLKSIZE_s / 2;\n            var k = 0xffff & ((576 / 3) * (b + 1));\n            var j = Encoder.BLKSIZE_s / 8 - 1;\n            do {\n                var f0, f1, f2, f3, w;\n                var i = rv_tbl[j << 2] & 0xff;\n\n                f0 = window_s[i] * buffer[chn][bufPos + i + k];\n                w = window_s[0x7f - i] * buffer[chn][bufPos + i + k + 0x80];\n                f1 = f0 - w;\n                f0 = f0 + w;\n                f2 = window_s[i + 0x40] * buffer[chn][bufPos + i + k + 0x40];\n                w = window_s[0x3f - i] * buffer[chn][bufPos + i + k + 0xc0];\n                f3 = f2 - w;\n                f2 = f2 + w;\n\n                x -= 4;\n                x_real[b][x + 0] = f0 + f2;\n                x_real[b][x + 2] = f0 - f2;\n                x_real[b][x + 1] = f1 + f3;\n                x_real[b][x + 3] = f1 - f3;\n\n                f0 = window_s[i + 0x01] * buffer[chn][bufPos + i + k + 0x01];\n                w = window_s[0x7e - i] * buffer[chn][bufPos + i + k + 0x81];\n                f1 = f0 - w;\n                f0 = f0 + w;\n                f2 = window_s[i + 0x41] * buffer[chn][bufPos + i + k + 0x41];\n                w = window_s[0x3e - i] * buffer[chn][bufPos + i + k + 0xc1];\n                f3 = f2 - w;\n                f2 = f2 + w;\n\n                x_real[b][x + Encoder.BLKSIZE_s / 2 + 0] = f0 + f2;\n                x_real[b][x + Encoder.BLKSIZE_s / 2 + 2] = f0 - f2;\n                x_real[b][x + Encoder.BLKSIZE_s / 2 + 1] = f1 + f3;\n                x_real[b][x + Encoder.BLKSIZE_s / 2 + 3] = f1 - f3;\n            } while (--j >= 0);\n\n            fht(x_real[b], x, Encoder.BLKSIZE_s / 2);\n            /* BLKSIZE_s/2 because of 3DNow! ASM routine */\n            /* BLKSIZE/2 because of 3DNow! ASM routine */\n        }\n    }\n\n    this.fft_long = function (gfc, y, chn, buffer, bufPos) {\n        var jj = Encoder.BLKSIZE / 8 - 1;\n        var x = Encoder.BLKSIZE / 2;\n\n        do {\n            var f0, f1, f2, f3, w;\n            var i = rv_tbl[jj] & 0xff;\n            f0 = window[i] * buffer[chn][bufPos + i];\n            w = window[i + 0x200] * buffer[chn][bufPos + i + 0x200];\n            f1 = f0 - w;\n            f0 = f0 + w;\n            f2 = window[i + 0x100] * buffer[chn][bufPos + i + 0x100];\n            w = window[i + 0x300] * buffer[chn][bufPos + i + 0x300];\n            f3 = f2 - w;\n            f2 = f2 + w;\n\n            x -= 4;\n            y[x + 0] = f0 + f2;\n            y[x + 2] = f0 - f2;\n            y[x + 1] = f1 + f3;\n            y[x + 3] = f1 - f3;\n\n            f0 = window[i + 0x001] * buffer[chn][bufPos + i + 0x001];\n            w = window[i + 0x201] * buffer[chn][bufPos + i + 0x201];\n            f1 = f0 - w;\n            f0 = f0 + w;\n            f2 = window[i + 0x101] * buffer[chn][bufPos + i + 0x101];\n            w = window[i + 0x301] * buffer[chn][bufPos + i + 0x301];\n            f3 = f2 - w;\n            f2 = f2 + w;\n\n            y[x + Encoder.BLKSIZE / 2 + 0] = f0 + f2;\n            y[x + Encoder.BLKSIZE / 2 + 2] = f0 - f2;\n            y[x + Encoder.BLKSIZE / 2 + 1] = f1 + f3;\n            y[x + Encoder.BLKSIZE / 2 + 3] = f1 - f3;\n        } while (--jj >= 0);\n\n        fht(y, x, Encoder.BLKSIZE / 2);\n        /* BLKSIZE/2 because of 3DNow! ASM routine */\n    }\n\n    this.init_fft = function (gfc) {\n        /* The type of window used here will make no real difference, but */\n        /*\n         * in the interest of merging nspsytune stuff - switch to blackman\n         * window\n         */\n        for (var i = 0; i < Encoder.BLKSIZE; i++)\n            /* blackman window */\n            window[i] = (0.42 - 0.5 * Math.cos(2 * Math.PI * (i + .5)\n                / Encoder.BLKSIZE) + 0.08 * Math.cos(4 * Math.PI * (i + .5)\n                / Encoder.BLKSIZE));\n\n        for (var i = 0; i < Encoder.BLKSIZE_s / 2; i++)\n            window_s[i] = (0.5 * (1.0 - Math.cos(2.0 * Math.PI\n                * (i + 0.5) / Encoder.BLKSIZE_s)));\n\n    }\n\n}\n\n/*\n *      psymodel.c\n *\n *      Copyright (c) 1999-2000 Mark Taylor\n *      Copyright (c) 2001-2002 Naoki Shibata\n *      Copyright (c) 2000-2003 Takehiro Tominaga\n *      Copyright (c) 2000-2008 Robert Hegemann\n *      Copyright (c) 2000-2005 Gabriel Bouvigne\n *      Copyright (c) 2000-2005 Alexander Leidinger\n *\n * This library is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 2 of the License, or (at your option) any later version.\n *\n * This library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Library General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this library; if not, write to the\n * Free Software Foundation, Inc., 59 Temple Place - Suite 330,\n * Boston, MA 02111-1307, USA.\n */\n\n/* $Id: PsyModel.java,v 1.27 2011/05/24 20:48:06 kenchis Exp $ */\n\n\n/*\n PSYCHO ACOUSTICS\n\n\n This routine computes the psycho acoustics, delayed by one granule.\n\n Input: buffer of PCM data (1024 samples).\n\n This window should be centered over the 576 sample granule window.\n The routine will compute the psycho acoustics for\n this granule, but return the psycho acoustics computed\n for the *previous* granule.  This is because the block\n type of the previous granule can only be determined\n after we have computed the psycho acoustics for the following\n granule.\n\n Output:  maskings and energies for each scalefactor band.\n block type, PE, and some correlation measures.\n The PE is used by CBR modes to determine if extra bits\n from the bit reservoir should be used.  The correlation\n measures are used to determine mid/side or regular stereo.\n */\n/*\n Notation:\n\n barks:  a non-linear frequency scale.  Mapping from frequency to\n barks is given by freq2bark()\n\n scalefactor bands: The spectrum (frequencies) are broken into\n SBMAX \"scalefactor bands\".  Thes bands\n are determined by the MPEG ISO spec.  In\n the noise shaping/quantization code, we allocate\n bits among the partition bands to achieve the\n best possible quality\n\n partition bands:   The spectrum is also broken into about\n 64 \"partition bands\".  Each partition\n band is about .34 barks wide.  There are about 2-5\n partition bands for each scalefactor band.\n\n LAME computes all psycho acoustic information for each partition\n band.  Then at the end of the computations, this information\n is mapped to scalefactor bands.  The energy in each scalefactor\n band is taken as the sum of the energy in all partition bands\n which overlap the scalefactor band.  The maskings can be computed\n in the same way (and thus represent the average masking in that band)\n or by taking the minmum value multiplied by the number of\n partition bands used (which represents a minimum masking in that band).\n */\n/*\n The general outline is as follows:\n\n 1. compute the energy in each partition band\n 2. compute the tonality in each partition band\n 3. compute the strength of each partion band \"masker\"\n 4. compute the masking (via the spreading function applied to each masker)\n 5. Modifications for mid/side masking.\n\n Each partition band is considiered a \"masker\".  The strength\n of the i'th masker in band j is given by:\n\n s3(bark(i)-bark(j))*strength(i)\n\n The strength of the masker is a function of the energy and tonality.\n The more tonal, the less masking.  LAME uses a simple linear formula\n (controlled by NMT and TMN) which says the strength is given by the\n energy divided by a linear function of the tonality.\n */\n/*\n s3() is the \"spreading function\".  It is given by a formula\n determined via listening tests.\n\n The total masking in the j'th partition band is the sum over\n all maskings i.  It is thus given by the convolution of\n the strength with s3(), the \"spreading function.\"\n\n masking(j) = sum_over_i  s3(i-j)*strength(i)  = s3 o strength\n\n where \"o\" = convolution operator.  s3 is given by a formula determined\n via listening tests.  It is normalized so that s3 o 1 = 1.\n\n Note: instead of a simple convolution, LAME also has the\n option of using \"additive masking\"\n\n The most critical part is step 2, computing the tonality of each\n partition band.  LAME has two tonality estimators.  The first\n is based on the ISO spec, and measures how predictiable the\n signal is over time.  The more predictable, the more tonal.\n The second measure is based on looking at the spectrum of\n a single granule.  The more peaky the spectrum, the more\n tonal.  By most indications, the latter approach is better.\n\n Finally, in step 5, the maskings for the mid and side\n channel are possibly increased.  Under certain circumstances,\n noise in the mid & side channels is assumed to also\n be masked by strong maskers in the L or R channels.\n\n\n Other data computed by the psy-model:\n\n ms_ratio        side-channel / mid-channel masking ratio (for previous granule)\n ms_ratio_next   side-channel / mid-channel masking ratio for this granule\n\n percep_entropy[2]     L and R values (prev granule) of PE - A measure of how\n much pre-echo is in the previous granule\n percep_entropy_MS[2]  mid and side channel values (prev granule) of percep_entropy\n energy[4]             L,R,M,S energy in each channel, prev granule\n blocktype_d[2]        block type to use for previous granule\n */\n//package mp3;\n\n//import java.util.Arrays;\n\n\nfunction PsyModel() {\n\n    var fft = new FFT();\n\n    var LOG10 = 2.30258509299404568402;\n\n    var rpelev = 2;\n    var rpelev2 = 16;\n    var rpelev_s = 2;\n    var rpelev2_s = 16;\n\n    /* size of each partition band, in barks: */\n    var DELBARK = .34;\n\n    /* tuned for output level (sensitive to energy scale) */\n    var VO_SCALE = (1. / (14752 * 14752) / (Encoder.BLKSIZE / 2));\n\n    var temporalmask_sustain_sec = 0.01;\n\n    var NS_PREECHO_ATT0 = 0.8;\n    var NS_PREECHO_ATT1 = 0.6;\n    var NS_PREECHO_ATT2 = 0.3;\n\n    var NS_MSFIX = 3.5;\n\n    var NSATTACKTHRE = 4.4;\n    var NSATTACKTHRE_S = 25;\n\n    var NSFIRLEN = 21;\n\n    /* size of each partition band, in barks: */\n    var LN_TO_LOG10 = 0.2302585093;\n\n    function NON_LINEAR_SCALE_ENERGY(x) {\n        return x;\n    }\n\n    /**\n     * <PRE>\n     *       L3psycho_anal.  Compute psycho acoustics.\n     *\n     *       Data returned to the calling program must be delayed by one\n     *       granule.\n     *\n     *       This is done in two places.\n     *       If we do not need to know the blocktype, the copying\n     *       can be done here at the top of the program: we copy the data for\n     *       the last granule (computed during the last call) before it is\n     *       overwritten with the new data.  It looks like this:\n     *\n     *       0. static psymodel_data\n     *       1. calling_program_data = psymodel_data\n     *       2. compute psymodel_data\n     *\n     *       For data which needs to know the blocktype, the copying must be\n     *       done at the end of this loop, and the old values must be saved:\n     *\n     *       0. static psymodel_data_old\n     *       1. compute psymodel_data\n     *       2. compute possible block type of this granule\n     *       3. compute final block type of previous granule based on #2.\n     *       4. calling_program_data = psymodel_data_old\n     *       5. psymodel_data_old = psymodel_data\n     *     psycho_loudness_approx\n     *       jd - 2001 mar 12\n     *    in:  energy   - BLKSIZE/2 elements of frequency magnitudes ^ 2\n     *         gfp      - uses out_samplerate, ATHtype (also needed for ATHformula)\n     *    returns: loudness^2 approximation, a positive value roughly tuned for a value\n     *             of 1.0 for signals near clipping.\n     *    notes:   When calibrated, feeding this function binary white noise at sample\n     *             values +32767 or -32768 should return values that approach 3.\n     *             ATHformula is used to approximate an equal loudness curve.\n     *    future:  Data indicates that the shape of the equal loudness curve varies\n     *             with intensity.  This function might be improved by using an equal\n     *             loudness curve shaped for typical playback levels (instead of the\n     *             ATH, that is shaped for the threshold).  A flexible realization might\n     *             simply bend the existing ATH curve to achieve the desired shape.\n     *             However, the potential gain may not be enough to justify an effort.\n     * </PRE>\n     */\n    function psycho_loudness_approx(energy, gfc) {\n        var loudness_power = 0.0;\n        /* apply weights to power in freq. bands */\n        for (var i = 0; i < Encoder.BLKSIZE / 2; ++i)\n            loudness_power += energy[i] * gfc.ATH.eql_w[i];\n        loudness_power *= VO_SCALE;\n\n        return loudness_power;\n    }\n\n    function compute_ffts(gfp, fftenergy, fftenergy_s, wsamp_l, wsamp_lPos, wsamp_s, wsamp_sPos, gr_out, chn, buffer, bufPos) {\n        var gfc = gfp.internal_flags;\n        if (chn < 2) {\n            fft.fft_long(gfc, wsamp_l[wsamp_lPos], chn, buffer, bufPos);\n            fft.fft_short(gfc, wsamp_s[wsamp_sPos], chn, buffer, bufPos);\n        }\n        /* FFT data for mid and side channel is derived from L & R */\n        else if (chn == 2) {\n            for (var j = Encoder.BLKSIZE - 1; j >= 0; --j) {\n                var l = wsamp_l[wsamp_lPos + 0][j];\n                var r = wsamp_l[wsamp_lPos + 1][j];\n                wsamp_l[wsamp_lPos + 0][j] = (l + r) * Util.SQRT2 * 0.5;\n                wsamp_l[wsamp_lPos + 1][j] = (l - r) * Util.SQRT2 * 0.5;\n            }\n            for (var b = 2; b >= 0; --b) {\n                for (var j = Encoder.BLKSIZE_s - 1; j >= 0; --j) {\n                    var l = wsamp_s[wsamp_sPos + 0][b][j];\n                    var r = wsamp_s[wsamp_sPos + 1][b][j];\n                    wsamp_s[wsamp_sPos + 0][b][j] = (l + r) * Util.SQRT2 * 0.5;\n                    wsamp_s[wsamp_sPos + 1][b][j] = (l - r) * Util.SQRT2 * 0.5;\n                }\n            }\n        }\n\n        /*********************************************************************\n         * compute energies\n         *********************************************************************/\n        fftenergy[0] = NON_LINEAR_SCALE_ENERGY(wsamp_l[wsamp_lPos + 0][0]);\n        fftenergy[0] *= fftenergy[0];\n\n        for (var j = Encoder.BLKSIZE / 2 - 1; j >= 0; --j) {\n            var re = (wsamp_l[wsamp_lPos + 0])[Encoder.BLKSIZE / 2 - j];\n            var im = (wsamp_l[wsamp_lPos + 0])[Encoder.BLKSIZE / 2 + j];\n            fftenergy[Encoder.BLKSIZE / 2 - j] = NON_LINEAR_SCALE_ENERGY((re\n                * re + im * im) * 0.5);\n        }\n        for (var b = 2; b >= 0; --b) {\n            fftenergy_s[b][0] = (wsamp_s[wsamp_sPos + 0])[b][0];\n            fftenergy_s[b][0] *= fftenergy_s[b][0];\n            for (var j = Encoder.BLKSIZE_s / 2 - 1; j >= 0; --j) {\n                var re = (wsamp_s[wsamp_sPos + 0])[b][Encoder.BLKSIZE_s\n                / 2 - j];\n                var im = (wsamp_s[wsamp_sPos + 0])[b][Encoder.BLKSIZE_s\n                / 2 + j];\n                fftenergy_s[b][Encoder.BLKSIZE_s / 2 - j] = NON_LINEAR_SCALE_ENERGY((re\n                    * re + im * im) * 0.5);\n            }\n        }\n        /* total energy */\n        {\n            var totalenergy = 0.0;\n            for (var j = 11; j < Encoder.HBLKSIZE; j++)\n                totalenergy += fftenergy[j];\n\n            gfc.tot_ener[chn] = totalenergy;\n        }\n\n        if (gfp.analysis) {\n            for (var j = 0; j < Encoder.HBLKSIZE; j++) {\n                gfc.pinfo.energy[gr_out][chn][j] = gfc.pinfo.energy_save[chn][j];\n                gfc.pinfo.energy_save[chn][j] = fftenergy[j];\n            }\n            gfc.pinfo.pe[gr_out][chn] = gfc.pe[chn];\n        }\n\n        /*********************************************************************\n         * compute loudness approximation (used for ATH auto-level adjustment)\n         *********************************************************************/\n        if (gfp.athaa_loudapprox == 2 && chn < 2) {\n            // no loudness for mid/side ch\n            gfc.loudness_sq[gr_out][chn] = gfc.loudness_sq_save[chn];\n            gfc.loudness_sq_save[chn] = psycho_loudness_approx(fftenergy, gfc);\n        }\n    }\n\n    /* mask_add optimization */\n    /* init the limit values used to avoid computing log in mask_add when it is not necessary */\n\n    /**\n     * <PRE>\n     *  For example, with i = 10*log10(m2/m1)/10*16         (= log10(m2/m1)*16)\n     *\n     * abs(i)>8 is equivalent (as i is an integer) to\n     * abs(i)>=9\n     * i>=9 || i<=-9\n     * equivalent to (as i is the biggest integer smaller than log10(m2/m1)*16\n     * or the smallest integer bigger than log10(m2/m1)*16 depending on the sign of log10(m2/m1)*16)\n     * log10(m2/m1)>=9/16 || log10(m2/m1)<=-9/16\n     * exp10 is strictly increasing thus this is equivalent to\n     * m2/m1 >= 10^(9/16) || m2/m1<=10^(-9/16) which are comparisons to constants\n     * </PRE>\n     */\n\n    /**\n     * as in if(i>8)\n     */\n    var I1LIMIT = 8;\n    /**\n     * as in if(i>24) . changed 23\n     */\n    var I2LIMIT = 23;\n    /**\n     * as in if(m<15)\n     */\n    var MLIMIT = 15;\n\n    var ma_max_i1;\n    var ma_max_i2;\n    var ma_max_m;\n\n    /**\n     * This is the masking table:<BR>\n     * According to tonality, values are going from 0dB (TMN) to 9.3dB (NMT).<BR>\n     * After additive masking computation, 8dB are added, so final values are\n     * going from 8dB to 17.3dB\n     *\n     * pow(10, -0.0..-0.6)\n     */\n    var tab = [1.0, 0.79433, 0.63096, 0.63096,\n        0.63096, 0.63096, 0.63096, 0.25119, 0.11749];\n\n    function init_mask_add_max_values() {\n        ma_max_i1 = Math.pow(10, (I1LIMIT + 1) / 16.0);\n        ma_max_i2 = Math.pow(10, (I2LIMIT + 1) / 16.0);\n        ma_max_m = Math.pow(10, (MLIMIT) / 10.0);\n    }\n\n    var table1 = [3.3246 * 3.3246,\n        3.23837 * 3.23837, 3.15437 * 3.15437, 3.00412 * 3.00412,\n        2.86103 * 2.86103, 2.65407 * 2.65407, 2.46209 * 2.46209,\n        2.284 * 2.284, 2.11879 * 2.11879, 1.96552 * 1.96552,\n        1.82335 * 1.82335, 1.69146 * 1.69146, 1.56911 * 1.56911,\n        1.46658 * 1.46658, 1.37074 * 1.37074, 1.31036 * 1.31036,\n        1.25264 * 1.25264, 1.20648 * 1.20648, 1.16203 * 1.16203,\n        1.12765 * 1.12765, 1.09428 * 1.09428, 1.0659 * 1.0659,\n        1.03826 * 1.03826, 1.01895 * 1.01895, 1];\n\n    var table2 = [1.33352 * 1.33352,\n        1.35879 * 1.35879, 1.38454 * 1.38454, 1.39497 * 1.39497,\n        1.40548 * 1.40548, 1.3537 * 1.3537, 1.30382 * 1.30382,\n        1.22321 * 1.22321, 1.14758 * 1.14758, 1];\n\n    var table3 = [2.35364 * 2.35364,\n        2.29259 * 2.29259, 2.23313 * 2.23313, 2.12675 * 2.12675,\n        2.02545 * 2.02545, 1.87894 * 1.87894, 1.74303 * 1.74303,\n        1.61695 * 1.61695, 1.49999 * 1.49999, 1.39148 * 1.39148,\n        1.29083 * 1.29083, 1.19746 * 1.19746, 1.11084 * 1.11084,\n        1.03826 * 1.03826];\n\n    /**\n     * addition of simultaneous masking Naoki Shibata 2000/7\n     */\n    function mask_add(m1, m2, kk, b, gfc, shortblock) {\n        var ratio;\n\n        if (m2 > m1) {\n            if (m2 < (m1 * ma_max_i2))\n                ratio = m2 / m1;\n            else\n                return (m1 + m2);\n        } else {\n            if (m1 >= (m2 * ma_max_i2))\n                return (m1 + m2);\n            ratio = m1 / m2;\n        }\n\n        /* Should always be true, just checking */\n\n        m1 += m2;\n        //if (((long)(b + 3) & 0xffffffff) <= 3 + 3) {\n        if ((b + 3) <= 3 + 3) {\n            /* approximately, 1 bark = 3 partitions */\n            /* 65% of the cases */\n            /* originally 'if(i > 8)' */\n            if (ratio >= ma_max_i1) {\n                /* 43% of the total */\n                return m1;\n            }\n\n            /* 22% of the total */\n            var i = 0 | (Util.FAST_LOG10_X(ratio, 16.0));\n            return m1 * table2[i];\n        }\n\n        /**\n         * <PRE>\n         * m<15 equ log10((m1+m2)/gfc.ATH.cb[k])<1.5\n         * equ (m1+m2)/gfc.ATH.cb[k]<10^1.5\n         * equ (m1+m2)<10^1.5 * gfc.ATH.cb[k]\n         * </PRE>\n         */\n        var i = 0 | Util.FAST_LOG10_X(ratio, 16.0);\n        if (shortblock != 0) {\n            m2 = gfc.ATH.cb_s[kk] * gfc.ATH.adjust;\n        } else {\n            m2 = gfc.ATH.cb_l[kk] * gfc.ATH.adjust;\n        }\n        if (m1 < ma_max_m * m2) {\n            /* 3% of the total */\n            /* Originally if (m > 0) { */\n            if (m1 > m2) {\n                var f, r;\n\n                f = 1.0;\n                if (i <= 13)\n                    f = table3[i];\n\n                r = Util.FAST_LOG10_X(m1 / m2, 10.0 / 15.0);\n                return m1 * ((table1[i] - f) * r + f);\n            }\n\n            if (i > 13)\n                return m1;\n\n            return m1 * table3[i];\n        }\n\n        /* 10% of total */\n        return m1 * table1[i];\n    }\n\n    var table2_ = [1.33352 * 1.33352,\n        1.35879 * 1.35879, 1.38454 * 1.38454, 1.39497 * 1.39497,\n        1.40548 * 1.40548, 1.3537 * 1.3537, 1.30382 * 1.30382,\n        1.22321 * 1.22321, 1.14758 * 1.14758, 1];\n\n    /**\n     * addition of simultaneous masking Naoki Shibata 2000/7\n     */\n    function vbrpsy_mask_add(m1, m2, b) {\n        var ratio;\n\n        if (m1 < 0) {\n            m1 = 0;\n        }\n        if (m2 < 0) {\n            m2 = 0;\n        }\n        if (m1 <= 0) {\n            return m2;\n        }\n        if (m2 <= 0) {\n            return m1;\n        }\n        if (m2 > m1) {\n            ratio = m2 / m1;\n        } else {\n            ratio = m1 / m2;\n        }\n        if (-2 <= b && b <= 2) {\n            /* approximately, 1 bark = 3 partitions */\n            /* originally 'if(i > 8)' */\n            if (ratio >= ma_max_i1) {\n                return m1 + m2;\n            } else {\n                var i = 0 | (Util.FAST_LOG10_X(ratio, 16.0));\n                return (m1 + m2) * table2_[i];\n            }\n        }\n        if (ratio < ma_max_i2) {\n            return m1 + m2;\n        }\n        if (m1 < m2) {\n            m1 = m2;\n        }\n        return m1;\n    }\n\n    /**\n     * compute interchannel masking effects\n     */\n    function calc_interchannel_masking(gfp, ratio) {\n        var gfc = gfp.internal_flags;\n        if (gfc.channels_out > 1) {\n            for (var sb = 0; sb < Encoder.SBMAX_l; sb++) {\n                var l = gfc.thm[0].l[sb];\n                var r = gfc.thm[1].l[sb];\n                gfc.thm[0].l[sb] += r * ratio;\n                gfc.thm[1].l[sb] += l * ratio;\n            }\n            for (var sb = 0; sb < Encoder.SBMAX_s; sb++) {\n                for (var sblock = 0; sblock < 3; sblock++) {\n                    var l = gfc.thm[0].s[sb][sblock];\n                    var r = gfc.thm[1].s[sb][sblock];\n                    gfc.thm[0].s[sb][sblock] += r * ratio;\n                    gfc.thm[1].s[sb][sblock] += l * ratio;\n                }\n            }\n        }\n    }\n\n    /**\n     * compute M/S thresholds from Johnston & Ferreira 1992 ICASSP paper\n     */\n    function msfix1(gfc) {\n        for (var sb = 0; sb < Encoder.SBMAX_l; sb++) {\n            /* use this fix if L & R masking differs by 2db or less */\n            /* if db = 10*log10(x2/x1) < 2 */\n            /* if (x2 < 1.58*x1) { */\n            if (gfc.thm[0].l[sb] > 1.58 * gfc.thm[1].l[sb]\n                || gfc.thm[1].l[sb] > 1.58 * gfc.thm[0].l[sb])\n                continue;\n            var mld = gfc.mld_l[sb] * gfc.en[3].l[sb];\n            var rmid = Math.max(gfc.thm[2].l[sb],\n                Math.min(gfc.thm[3].l[sb], mld));\n\n            mld = gfc.mld_l[sb] * gfc.en[2].l[sb];\n            var rside = Math.max(gfc.thm[3].l[sb],\n                Math.min(gfc.thm[2].l[sb], mld));\n            gfc.thm[2].l[sb] = rmid;\n            gfc.thm[3].l[sb] = rside;\n        }\n\n        for (var sb = 0; sb < Encoder.SBMAX_s; sb++) {\n            for (var sblock = 0; sblock < 3; sblock++) {\n                if (gfc.thm[0].s[sb][sblock] > 1.58 * gfc.thm[1].s[sb][sblock]\n                    || gfc.thm[1].s[sb][sblock] > 1.58 * gfc.thm[0].s[sb][sblock])\n                    continue;\n                var mld = gfc.mld_s[sb] * gfc.en[3].s[sb][sblock];\n                var rmid = Math.max(gfc.thm[2].s[sb][sblock],\n                    Math.min(gfc.thm[3].s[sb][sblock], mld));\n\n                mld = gfc.mld_s[sb] * gfc.en[2].s[sb][sblock];\n                var rside = Math.max(gfc.thm[3].s[sb][sblock],\n                    Math.min(gfc.thm[2].s[sb][sblock], mld));\n\n                gfc.thm[2].s[sb][sblock] = rmid;\n                gfc.thm[3].s[sb][sblock] = rside;\n            }\n        }\n    }\n\n    /**\n     * Adjust M/S maskings if user set \"msfix\"\n     *\n     * Naoki Shibata 2000\n     */\n    function ns_msfix(gfc, msfix, athadjust) {\n        var msfix2 = msfix;\n        var athlower = Math.pow(10, athadjust);\n\n        msfix *= 2.0;\n        msfix2 *= 2.0;\n        for (var sb = 0; sb < Encoder.SBMAX_l; sb++) {\n            var thmLR, thmM, thmS, ath;\n            ath = (gfc.ATH.cb_l[gfc.bm_l[sb]]) * athlower;\n            thmLR = Math.min(Math.max(gfc.thm[0].l[sb], ath),\n                Math.max(gfc.thm[1].l[sb], ath));\n            thmM = Math.max(gfc.thm[2].l[sb], ath);\n            thmS = Math.max(gfc.thm[3].l[sb], ath);\n            if (thmLR * msfix < thmM + thmS) {\n                var f = thmLR * msfix2 / (thmM + thmS);\n                thmM *= f;\n                thmS *= f;\n            }\n            gfc.thm[2].l[sb] = Math.min(thmM, gfc.thm[2].l[sb]);\n            gfc.thm[3].l[sb] = Math.min(thmS, gfc.thm[3].l[sb]);\n        }\n\n        athlower *= ( Encoder.BLKSIZE_s / Encoder.BLKSIZE);\n        for (var sb = 0; sb < Encoder.SBMAX_s; sb++) {\n            for (var sblock = 0; sblock < 3; sblock++) {\n                var thmLR, thmM, thmS, ath;\n                ath = (gfc.ATH.cb_s[gfc.bm_s[sb]]) * athlower;\n                thmLR = Math.min(Math.max(gfc.thm[0].s[sb][sblock], ath),\n                    Math.max(gfc.thm[1].s[sb][sblock], ath));\n                thmM = Math.max(gfc.thm[2].s[sb][sblock], ath);\n                thmS = Math.max(gfc.thm[3].s[sb][sblock], ath);\n\n                if (thmLR * msfix < thmM + thmS) {\n                    var f = thmLR * msfix / (thmM + thmS);\n                    thmM *= f;\n                    thmS *= f;\n                }\n                gfc.thm[2].s[sb][sblock] = Math.min(gfc.thm[2].s[sb][sblock],\n                    thmM);\n                gfc.thm[3].s[sb][sblock] = Math.min(gfc.thm[3].s[sb][sblock],\n                    thmS);\n            }\n        }\n    }\n\n    /**\n     * short block threshold calculation (part 2)\n     *\n     * partition band bo_s[sfb] is at the transition from scalefactor band sfb\n     * to the next one sfb+1; enn and thmm have to be split between them\n     */\n    function convert_partition2scalefac_s(gfc, eb, thr, chn, sblock) {\n        var sb, b;\n        var enn = 0.0;\n        var thmm = 0.0;\n        for (sb = b = 0; sb < Encoder.SBMAX_s; ++b, ++sb) {\n            var bo_s_sb = gfc.bo_s[sb];\n            var npart_s = gfc.npart_s;\n            var b_lim = bo_s_sb < npart_s ? bo_s_sb : npart_s;\n            while (b < b_lim) {\n                // iff failed, it may indicate some index error elsewhere\n                enn += eb[b];\n                thmm += thr[b];\n                b++;\n            }\n            gfc.en[chn].s[sb][sblock] = enn;\n            gfc.thm[chn].s[sb][sblock] = thmm;\n\n            if (b >= npart_s) {\n                ++sb;\n                break;\n            }\n            // iff failed, it may indicate some index error elsewhere\n            {\n                /* at transition sfb . sfb+1 */\n                var w_curr = gfc.PSY.bo_s_weight[sb];\n                var w_next = 1.0 - w_curr;\n                enn = w_curr * eb[b];\n                thmm = w_curr * thr[b];\n                gfc.en[chn].s[sb][sblock] += enn;\n                gfc.thm[chn].s[sb][sblock] += thmm;\n                enn = w_next * eb[b];\n                thmm = w_next * thr[b];\n            }\n        }\n        /* zero initialize the rest */\n        for (; sb < Encoder.SBMAX_s; ++sb) {\n            gfc.en[chn].s[sb][sblock] = 0;\n            gfc.thm[chn].s[sb][sblock] = 0;\n        }\n    }\n\n    /**\n     * longblock threshold calculation (part 2)\n     */\n    function convert_partition2scalefac_l(gfc, eb, thr, chn) {\n        var sb, b;\n        var enn = 0.0;\n        var thmm = 0.0;\n        for (sb = b = 0; sb < Encoder.SBMAX_l; ++b, ++sb) {\n            var bo_l_sb = gfc.bo_l[sb];\n            var npart_l = gfc.npart_l;\n            var b_lim = bo_l_sb < npart_l ? bo_l_sb : npart_l;\n            while (b < b_lim) {\n                // iff failed, it may indicate some index error elsewhere\n                enn += eb[b];\n                thmm += thr[b];\n                b++;\n            }\n            gfc.en[chn].l[sb] = enn;\n            gfc.thm[chn].l[sb] = thmm;\n\n            if (b >= npart_l) {\n                ++sb;\n                break;\n            }\n            {\n                /* at transition sfb . sfb+1 */\n                var w_curr = gfc.PSY.bo_l_weight[sb];\n                var w_next = 1.0 - w_curr;\n                enn = w_curr * eb[b];\n                thmm = w_curr * thr[b];\n                gfc.en[chn].l[sb] += enn;\n                gfc.thm[chn].l[sb] += thmm;\n                enn = w_next * eb[b];\n                thmm = w_next * thr[b];\n            }\n        }\n        /* zero initialize the rest */\n        for (; sb < Encoder.SBMAX_l; ++sb) {\n            gfc.en[chn].l[sb] = 0;\n            gfc.thm[chn].l[sb] = 0;\n        }\n    }\n\n    function compute_masking_s(gfp, fftenergy_s, eb, thr, chn, sblock) {\n        var gfc = gfp.internal_flags;\n        var j, b;\n\n        for (b = j = 0; b < gfc.npart_s; ++b) {\n            var ebb = 0, m = 0;\n            var n = gfc.numlines_s[b];\n            for (var i = 0; i < n; ++i, ++j) {\n                var el = fftenergy_s[sblock][j];\n                ebb += el;\n                if (m < el)\n                    m = el;\n            }\n            eb[b] = ebb;\n        }\n        for (j = b = 0; b < gfc.npart_s; b++) {\n            var kk = gfc.s3ind_s[b][0];\n            var ecb = gfc.s3_ss[j++] * eb[kk];\n            ++kk;\n            while (kk <= gfc.s3ind_s[b][1]) {\n                ecb += gfc.s3_ss[j] * eb[kk];\n                ++j;\n                ++kk;\n            }\n\n            { /* limit calculated threshold by previous granule */\n                var x = rpelev_s * gfc.nb_s1[chn][b];\n                thr[b] = Math.min(ecb, x);\n            }\n            if (gfc.blocktype_old[chn & 1] == Encoder.SHORT_TYPE) {\n                /* limit calculated threshold by even older granule */\n                var x = rpelev2_s * gfc.nb_s2[chn][b];\n                var y = thr[b];\n                thr[b] = Math.min(x, y);\n            }\n\n            gfc.nb_s2[chn][b] = gfc.nb_s1[chn][b];\n            gfc.nb_s1[chn][b] = ecb;\n        }\n        for (; b <= Encoder.CBANDS; ++b) {\n            eb[b] = 0;\n            thr[b] = 0;\n        }\n    }\n\n    function block_type_set(gfp, uselongblock, blocktype_d, blocktype) {\n        var gfc = gfp.internal_flags;\n\n        if (gfp.short_blocks == ShortBlock.short_block_coupled\n                /* force both channels to use the same block type */\n                /* this is necessary if the frame is to be encoded in ms_stereo. */\n                /* But even without ms_stereo, FhG does this */\n            && !(uselongblock[0] != 0 && uselongblock[1] != 0))\n            uselongblock[0] = uselongblock[1] = 0;\n\n        /*\n         * update the blocktype of the previous granule, since it depends on\n         * what happend in this granule\n         */\n        for (var chn = 0; chn < gfc.channels_out; chn++) {\n            blocktype[chn] = Encoder.NORM_TYPE;\n            /* disable short blocks */\n            if (gfp.short_blocks == ShortBlock.short_block_dispensed)\n                uselongblock[chn] = 1;\n            if (gfp.short_blocks == ShortBlock.short_block_forced)\n                uselongblock[chn] = 0;\n\n            if (uselongblock[chn] != 0) {\n                /* no attack : use long blocks */\n                if (gfc.blocktype_old[chn] == Encoder.SHORT_TYPE)\n                    blocktype[chn] = Encoder.STOP_TYPE;\n            } else {\n                /* attack : use short blocks */\n                blocktype[chn] = Encoder.SHORT_TYPE;\n                if (gfc.blocktype_old[chn] == Encoder.NORM_TYPE) {\n                    gfc.blocktype_old[chn] = Encoder.START_TYPE;\n                }\n                if (gfc.blocktype_old[chn] == Encoder.STOP_TYPE)\n                    gfc.blocktype_old[chn] = Encoder.SHORT_TYPE;\n            }\n\n            blocktype_d[chn] = gfc.blocktype_old[chn];\n            // value returned to calling program\n            gfc.blocktype_old[chn] = blocktype[chn];\n            // save for next call to l3psy_anal\n        }\n    }\n\n    function NS_INTERP(x, y, r) {\n        /* was pow((x),(r))*pow((y),1-(r)) */\n        if (r >= 1.0) {\n            /* 99.7% of the time */\n            return x;\n        }\n        if (r <= 0.0)\n            return y;\n        if (y > 0.0) {\n            /* rest of the time */\n            return (Math.pow(x / y, r) * y);\n        }\n        /* never happens */\n        return 0.0;\n    }\n\n    /**\n     * these values are tuned only for 44.1kHz...\n     */\n    var regcoef_s = [11.8, 13.6, 17.2, 32, 46.5,\n        51.3, 57.5, 67.1, 71.5, 84.6, 97.6, 130,\n        /* 255.8 */\n    ];\n\n    function pecalc_s(mr, masking_lower) {\n        var pe_s = 1236.28 / 4;\n        for (var sb = 0; sb < Encoder.SBMAX_s - 1; sb++) {\n            for (var sblock = 0; sblock < 3; sblock++) {\n                var thm = mr.thm.s[sb][sblock];\n                if (thm > 0.0) {\n                    var x = thm * masking_lower;\n                    var en = mr.en.s[sb][sblock];\n                    if (en > x) {\n                        if (en > x * 1e10) {\n                            pe_s += regcoef_s[sb] * (10.0 * LOG10);\n                        } else {\n                            pe_s += regcoef_s[sb] * Util.FAST_LOG10(en / x);\n                        }\n                    }\n                }\n            }\n        }\n\n        return pe_s;\n    }\n\n    /**\n     * these values are tuned only for 44.1kHz...\n     */\n    var regcoef_l = [6.8, 5.8, 5.8, 6.4, 6.5, 9.9,\n        12.1, 14.4, 15, 18.9, 21.6, 26.9, 34.2, 40.2, 46.8, 56.5,\n        60.7, 73.9, 85.7, 93.4, 126.1,\n        /* 241.3 */\n    ];\n\n    function pecalc_l(mr, masking_lower) {\n        var pe_l = 1124.23 / 4;\n        for (var sb = 0; sb < Encoder.SBMAX_l - 1; sb++) {\n            var thm = mr.thm.l[sb];\n            if (thm > 0.0) {\n                var x = thm * masking_lower;\n                var en = mr.en.l[sb];\n                if (en > x) {\n                    if (en > x * 1e10) {\n                        pe_l += regcoef_l[sb] * (10.0 * LOG10);\n                    } else {\n                        pe_l += regcoef_l[sb] * Util.FAST_LOG10(en / x);\n                    }\n                }\n            }\n        }\n        return pe_l;\n    }\n\n    function calc_energy(gfc, fftenergy, eb, max, avg) {\n        var b, j;\n\n        for (b = j = 0; b < gfc.npart_l; ++b) {\n            var ebb = 0, m = 0;\n            var i;\n            for (i = 0; i < gfc.numlines_l[b]; ++i, ++j) {\n                var el = fftenergy[j];\n                ebb += el;\n                if (m < el)\n                    m = el;\n            }\n            eb[b] = ebb;\n            max[b] = m;\n            avg[b] = ebb * gfc.rnumlines_l[b];\n        }\n    }\n\n    function calc_mask_index_l(gfc, max, avg, mask_idx) {\n        var last_tab_entry = tab.length - 1;\n        var b = 0;\n        var a = avg[b] + avg[b + 1];\n        if (a > 0.0) {\n            var m = max[b];\n            if (m < max[b + 1])\n                m = max[b + 1];\n            a = 20.0 * (m * 2.0 - a)\n                / (a * (gfc.numlines_l[b] + gfc.numlines_l[b + 1] - 1));\n            var k = 0 | a;\n            if (k > last_tab_entry)\n                k = last_tab_entry;\n            mask_idx[b] = k;\n        } else {\n            mask_idx[b] = 0;\n        }\n\n        for (b = 1; b < gfc.npart_l - 1; b++) {\n            a = avg[b - 1] + avg[b] + avg[b + 1];\n            if (a > 0.0) {\n                var m = max[b - 1];\n                if (m < max[b])\n                    m = max[b];\n                if (m < max[b + 1])\n                    m = max[b + 1];\n                a = 20.0\n                    * (m * 3.0 - a)\n                    / (a * (gfc.numlines_l[b - 1] + gfc.numlines_l[b]\n                    + gfc.numlines_l[b + 1] - 1));\n                var k = 0 | a;\n                if (k > last_tab_entry)\n                    k = last_tab_entry;\n                mask_idx[b] = k;\n            } else {\n                mask_idx[b] = 0;\n            }\n        }\n\n        a = avg[b - 1] + avg[b];\n        if (a > 0.0) {\n            var m = max[b - 1];\n            if (m < max[b])\n                m = max[b];\n            a = 20.0 * (m * 2.0 - a)\n                / (a * (gfc.numlines_l[b - 1] + gfc.numlines_l[b] - 1));\n            var k = 0 | a;\n            if (k > last_tab_entry)\n                k = last_tab_entry;\n            mask_idx[b] = k;\n        } else {\n            mask_idx[b] = 0;\n        }\n    }\n\n    var fircoef = [\n        -8.65163e-18 * 2, -0.00851586 * 2, -6.74764e-18 * 2, 0.0209036 * 2,\n        -3.36639e-17 * 2, -0.0438162 * 2, -1.54175e-17 * 2, 0.0931738 * 2,\n        -5.52212e-17 * 2, -0.313819 * 2\n    ];\n\n    this.L3psycho_anal_ns = function (gfp, buffer, bufPos, gr_out, masking_ratio, masking_MS_ratio, percep_entropy, percep_MS_entropy, energy, blocktype_d) {\n        /*\n         * to get a good cache performance, one has to think about the sequence,\n         * in which the variables are used.\n         */\n        var gfc = gfp.internal_flags;\n\n        /* fft and energy calculation */\n        var wsamp_L = new_float_n([2, Encoder.BLKSIZE]);\n        var wsamp_S = new_float_n([2, 3, Encoder.BLKSIZE_s]);\n\n        /* convolution */\n        var eb_l = new_float(Encoder.CBANDS + 1);\n        var eb_s = new_float(Encoder.CBANDS + 1);\n        var thr = new_float(Encoder.CBANDS + 2);\n\n        /* block type */\n        var blocktype = new_int(2), uselongblock = new_int(2);\n\n        /* usual variables like loop indices, etc.. */\n        var numchn, chn;\n        var b, i, j, k;\n        var sb, sblock;\n\n        /* variables used for --nspsytune */\n        var ns_hpfsmpl = new_float_n([2, 576]);\n        var pcfact;\n        var mask_idx_l = new_int(Encoder.CBANDS + 2), mask_idx_s = new_int(Encoder.CBANDS + 2);\n\n        Arrays.fill(mask_idx_s, 0);\n\n        numchn = gfc.channels_out;\n        /* chn=2 and 3 = Mid and Side channels */\n        if (gfp.mode == MPEGMode.JOINT_STEREO)\n            numchn = 4;\n\n        if (gfp.VBR == VbrMode.vbr_off)\n            pcfact = gfc.ResvMax == 0 ? 0 : ( gfc.ResvSize)\n            / gfc.ResvMax * 0.5;\n        else if (gfp.VBR == VbrMode.vbr_rh || gfp.VBR == VbrMode.vbr_mtrh\n            || gfp.VBR == VbrMode.vbr_mt) {\n            pcfact = 0.6;\n        } else\n            pcfact = 1.0;\n\n        /**********************************************************************\n         * Apply HPF of fs/4 to the input signal. This is used for attack\n         * detection / handling.\n         **********************************************************************/\n        /* Don't copy the input buffer into a temporary buffer */\n        /* unroll the loop 2 times */\n        for (chn = 0; chn < gfc.channels_out; chn++) {\n            /* apply high pass filter of fs/4 */\n            var firbuf = buffer[chn];\n            var firbufPos = bufPos + 576 - 350 - NSFIRLEN + 192;\n            for (i = 0; i < 576; i++) {\n                var sum1, sum2;\n                sum1 = firbuf[firbufPos + i + 10];\n                sum2 = 0.0;\n                for (j = 0; j < ((NSFIRLEN - 1) / 2) - 1; j += 2) {\n                    sum1 += fircoef[j]\n                        * (firbuf[firbufPos + i + j] + firbuf[firbufPos + i\n                        + NSFIRLEN - j]);\n                    sum2 += fircoef[j + 1]\n                        * (firbuf[firbufPos + i + j + 1] + firbuf[firbufPos\n                        + i + NSFIRLEN - j - 1]);\n                }\n                ns_hpfsmpl[chn][i] = sum1 + sum2;\n            }\n            masking_ratio[gr_out][chn].en.assign(gfc.en[chn]);\n            masking_ratio[gr_out][chn].thm.assign(gfc.thm[chn]);\n            if (numchn > 2) {\n                /* MS maskings */\n                /* percep_MS_entropy [chn-2] = gfc . pe [chn]; */\n                masking_MS_ratio[gr_out][chn].en.assign(gfc.en[chn + 2]);\n                masking_MS_ratio[gr_out][chn].thm.assign(gfc.thm[chn + 2]);\n            }\n        }\n\n        for (chn = 0; chn < numchn; chn++) {\n            var wsamp_l;\n            var wsamp_s;\n            var en_subshort = new_float(12);\n            var en_short = [0, 0, 0, 0];\n            var attack_intensity = new_float(12);\n            var ns_uselongblock = 1;\n            var attackThreshold;\n            var max = new_float(Encoder.CBANDS), avg = new_float(Encoder.CBANDS);\n            var ns_attacks = [0, 0, 0, 0];\n            var fftenergy = new_float(Encoder.HBLKSIZE);\n            var fftenergy_s = new_float_n([3, Encoder.HBLKSIZE_s]);\n\n            /*\n             * rh 20040301: the following loops do access one off the limits so\n             * I increase the array dimensions by one and initialize the\n             * accessed values to zero\n             */\n\n            /***************************************************************\n             * determine the block type (window type)\n             ***************************************************************/\n            /* calculate energies of each sub-shortblocks */\n            for (i = 0; i < 3; i++) {\n                en_subshort[i] = gfc.nsPsy.last_en_subshort[chn][i + 6];\n                attack_intensity[i] = en_subshort[i]\n                    / gfc.nsPsy.last_en_subshort[chn][i + 4];\n                en_short[0] += en_subshort[i];\n            }\n\n            if (chn == 2) {\n                for (i = 0; i < 576; i++) {\n                    var l, r;\n                    l = ns_hpfsmpl[0][i];\n                    r = ns_hpfsmpl[1][i];\n                    ns_hpfsmpl[0][i] = l + r;\n                    ns_hpfsmpl[1][i] = l - r;\n                }\n            }\n            {\n                var pf = ns_hpfsmpl[chn & 1];\n                var pfPos = 0;\n                for (i = 0; i < 9; i++) {\n                    var pfe = pfPos + 576 / 9;\n                    var p = 1.;\n                    for (; pfPos < pfe; pfPos++)\n                        if (p < Math.abs(pf[pfPos]))\n                            p = Math.abs(pf[pfPos]);\n\n                    gfc.nsPsy.last_en_subshort[chn][i] = en_subshort[i + 3] = p;\n                    en_short[1 + i / 3] += p;\n                    if (p > en_subshort[i + 3 - 2]) {\n                        p = p / en_subshort[i + 3 - 2];\n                    } else if (en_subshort[i + 3 - 2] > p * 10.0) {\n                        p = en_subshort[i + 3 - 2] / (p * 10.0);\n                    } else\n                        p = 0.0;\n                    attack_intensity[i + 3] = p;\n                }\n            }\n\n            if (gfp.analysis) {\n                var x = attack_intensity[0];\n                for (i = 1; i < 12; i++)\n                    if (x < attack_intensity[i])\n                        x = attack_intensity[i];\n                gfc.pinfo.ers[gr_out][chn] = gfc.pinfo.ers_save[chn];\n                gfc.pinfo.ers_save[chn] = x;\n            }\n\n            /* compare energies between sub-shortblocks */\n            attackThreshold = (chn == 3) ? gfc.nsPsy.attackthre_s\n                : gfc.nsPsy.attackthre;\n            for (i = 0; i < 12; i++)\n                if (0 == ns_attacks[i / 3]\n                    && attack_intensity[i] > attackThreshold)\n                    ns_attacks[i / 3] = (i % 3) + 1;\n\n            /*\n             * should have energy change between short blocks, in order to avoid\n             * periodic signals\n             */\n            for (i = 1; i < 4; i++) {\n                var ratio;\n                if (en_short[i - 1] > en_short[i]) {\n                    ratio = en_short[i - 1] / en_short[i];\n                } else {\n                    ratio = en_short[i] / en_short[i - 1];\n                }\n                if (ratio < 1.7) {\n                    ns_attacks[i] = 0;\n                    if (i == 1)\n                        ns_attacks[0] = 0;\n                }\n            }\n\n            if (ns_attacks[0] != 0 && gfc.nsPsy.lastAttacks[chn] != 0)\n                ns_attacks[0] = 0;\n\n            if (gfc.nsPsy.lastAttacks[chn] == 3\n                || (ns_attacks[0] + ns_attacks[1] + ns_attacks[2] + ns_attacks[3]) != 0) {\n                ns_uselongblock = 0;\n\n                if (ns_attacks[1] != 0 && ns_attacks[0] != 0)\n                    ns_attacks[1] = 0;\n                if (ns_attacks[2] != 0 && ns_attacks[1] != 0)\n                    ns_attacks[2] = 0;\n                if (ns_attacks[3] != 0 && ns_attacks[2] != 0)\n                    ns_attacks[3] = 0;\n            }\n\n            if (chn < 2) {\n                uselongblock[chn] = ns_uselongblock;\n            } else {\n                if (ns_uselongblock == 0) {\n                    uselongblock[0] = uselongblock[1] = 0;\n                }\n            }\n\n            /*\n             * there is a one granule delay. Copy maskings computed last call\n             * into masking_ratio to return to calling program.\n             */\n            energy[chn] = gfc.tot_ener[chn];\n\n            /*********************************************************************\n             * compute FFTs\n             *********************************************************************/\n            wsamp_s = wsamp_S;\n            wsamp_l = wsamp_L;\n            compute_ffts(gfp, fftenergy, fftenergy_s, wsamp_l, (chn & 1),\n                wsamp_s, (chn & 1), gr_out, chn, buffer, bufPos);\n\n            /*********************************************************************\n             * Calculate the energy and the tonality of each partition.\n             *********************************************************************/\n            calc_energy(gfc, fftenergy, eb_l, max, avg);\n            calc_mask_index_l(gfc, max, avg, mask_idx_l);\n            /* compute masking thresholds for short blocks */\n            for (sblock = 0; sblock < 3; sblock++) {\n                var enn, thmm;\n                compute_masking_s(gfp, fftenergy_s, eb_s, thr, chn, sblock);\n                convert_partition2scalefac_s(gfc, eb_s, thr, chn, sblock);\n                /**** short block pre-echo control ****/\n                for (sb = 0; sb < Encoder.SBMAX_s; sb++) {\n                    thmm = gfc.thm[chn].s[sb][sblock];\n\n                    thmm *= NS_PREECHO_ATT0;\n                    if (ns_attacks[sblock] >= 2 || ns_attacks[sblock + 1] == 1) {\n                        var idx = (sblock != 0) ? sblock - 1 : 2;\n                        var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                            NS_PREECHO_ATT1 * pcfact);\n                        thmm = Math.min(thmm, p);\n                    }\n\n                    if (ns_attacks[sblock] == 1) {\n                        var idx = (sblock != 0) ? sblock - 1 : 2;\n                        var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                            NS_PREECHO_ATT2 * pcfact);\n                        thmm = Math.min(thmm, p);\n                    } else if ((sblock != 0 && ns_attacks[sblock - 1] == 3)\n                        || (sblock == 0 && gfc.nsPsy.lastAttacks[chn] == 3)) {\n                        var idx = (sblock != 2) ? sblock + 1 : 0;\n                        var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                            NS_PREECHO_ATT2 * pcfact);\n                        thmm = Math.min(thmm, p);\n                    }\n\n                    /* pulse like signal detection for fatboy.wav and so on */\n                    enn = en_subshort[sblock * 3 + 3]\n                        + en_subshort[sblock * 3 + 4]\n                        + en_subshort[sblock * 3 + 5];\n                    if (en_subshort[sblock * 3 + 5] * 6 < enn) {\n                        thmm *= 0.5;\n                        if (en_subshort[sblock * 3 + 4] * 6 < enn)\n                            thmm *= 0.5;\n                    }\n\n                    gfc.thm[chn].s[sb][sblock] = thmm;\n                }\n            }\n            gfc.nsPsy.lastAttacks[chn] = ns_attacks[2];\n\n            /*********************************************************************\n             * convolve the partitioned energy and unpredictability with the\n             * spreading function, s3_l[b][k]\n             ********************************************************************/\n            k = 0;\n            {\n                for (b = 0; b < gfc.npart_l; b++) {\n                    /*\n                     * convolve the partitioned energy with the spreading\n                     * function\n                     */\n                    var kk = gfc.s3ind[b][0];\n                    var eb2 = eb_l[kk] * tab[mask_idx_l[kk]];\n                    var ecb = gfc.s3_ll[k++] * eb2;\n                    while (++kk <= gfc.s3ind[b][1]) {\n                        eb2 = eb_l[kk] * tab[mask_idx_l[kk]];\n                        ecb = mask_add(ecb, gfc.s3_ll[k++] * eb2, kk, kk - b,\n                            gfc, 0);\n                    }\n                    ecb *= 0.158489319246111;\n                    /* pow(10,-0.8) */\n\n                    /**** long block pre-echo control ****/\n                    /**\n                     * <PRE>\n                     * dont use long block pre-echo control if previous granule was\n                     * a short block.  This is to avoid the situation:\n                     * frame0:  quiet (very low masking)\n                     * frame1:  surge  (triggers short blocks)\n                     * frame2:  regular frame.  looks like pre-echo when compared to\n                     *          frame0, but all pre-echo was in frame1.\n                     * </PRE>\n                     */\n                    /*\n                     * chn=0,1 L and R channels\n                     *\n                     * chn=2,3 S and M channels.\n                     */\n\n                    if (gfc.blocktype_old[chn & 1] == Encoder.SHORT_TYPE)\n                        thr[b] = ecb;\n                    else\n                        thr[b] = NS_INTERP(\n                            Math.min(ecb, Math.min(rpelev\n                                * gfc.nb_1[chn][b], rpelev2\n                                * gfc.nb_2[chn][b])), ecb, pcfact);\n\n                    gfc.nb_2[chn][b] = gfc.nb_1[chn][b];\n                    gfc.nb_1[chn][b] = ecb;\n                }\n            }\n            for (; b <= Encoder.CBANDS; ++b) {\n                eb_l[b] = 0;\n                thr[b] = 0;\n            }\n            /* compute masking thresholds for long blocks */\n            convert_partition2scalefac_l(gfc, eb_l, thr, chn);\n        }\n        /* end loop over chn */\n\n        if (gfp.mode == MPEGMode.STEREO || gfp.mode == MPEGMode.JOINT_STEREO) {\n            if (gfp.interChRatio > 0.0) {\n                calc_interchannel_masking(gfp, gfp.interChRatio);\n            }\n        }\n\n        if (gfp.mode == MPEGMode.JOINT_STEREO) {\n            var msfix;\n            msfix1(gfc);\n            msfix = gfp.msfix;\n            if (Math.abs(msfix) > 0.0)\n                ns_msfix(gfc, msfix, gfp.ATHlower * gfc.ATH.adjust);\n        }\n\n        /***************************************************************\n         * determine final block type\n         ***************************************************************/\n        block_type_set(gfp, uselongblock, blocktype_d, blocktype);\n\n        /*********************************************************************\n         * compute the value of PE to return ... no delay and advance\n         *********************************************************************/\n        for (chn = 0; chn < numchn; chn++) {\n            var ppe;\n            var ppePos = 0;\n            var type;\n            var mr;\n\n            if (chn > 1) {\n                ppe = percep_MS_entropy;\n                ppePos = -2;\n                type = Encoder.NORM_TYPE;\n                if (blocktype_d[0] == Encoder.SHORT_TYPE\n                    || blocktype_d[1] == Encoder.SHORT_TYPE)\n                    type = Encoder.SHORT_TYPE;\n                mr = masking_MS_ratio[gr_out][chn - 2];\n            } else {\n                ppe = percep_entropy;\n                ppePos = 0;\n                type = blocktype_d[chn];\n                mr = masking_ratio[gr_out][chn];\n            }\n\n            if (type == Encoder.SHORT_TYPE)\n                ppe[ppePos + chn] = pecalc_s(mr, gfc.masking_lower);\n            else\n                ppe[ppePos + chn] = pecalc_l(mr, gfc.masking_lower);\n\n            if (gfp.analysis)\n                gfc.pinfo.pe[gr_out][chn] = ppe[ppePos + chn];\n\n        }\n        return 0;\n    }\n\n    function vbrpsy_compute_fft_l(gfp, buffer, bufPos, chn, gr_out, fftenergy, wsamp_l, wsamp_lPos) {\n        var gfc = gfp.internal_flags;\n        if (chn < 2) {\n            fft.fft_long(gfc, wsamp_l[wsamp_lPos], chn, buffer, bufPos);\n        } else if (chn == 2) {\n            /* FFT data for mid and side channel is derived from L & R */\n            for (var j = Encoder.BLKSIZE - 1; j >= 0; --j) {\n                var l = wsamp_l[wsamp_lPos + 0][j];\n                var r = wsamp_l[wsamp_lPos + 1][j];\n                wsamp_l[wsamp_lPos + 0][j] = (l + r) * Util.SQRT2 * 0.5;\n                wsamp_l[wsamp_lPos + 1][j] = (l - r) * Util.SQRT2 * 0.5;\n            }\n        }\n\n        /*********************************************************************\n         * compute energies\n         *********************************************************************/\n        fftenergy[0] = NON_LINEAR_SCALE_ENERGY(wsamp_l[wsamp_lPos + 0][0]);\n        fftenergy[0] *= fftenergy[0];\n\n        for (var j = Encoder.BLKSIZE / 2 - 1; j >= 0; --j) {\n            var re = wsamp_l[wsamp_lPos + 0][Encoder.BLKSIZE / 2 - j];\n            var im = wsamp_l[wsamp_lPos + 0][Encoder.BLKSIZE / 2 + j];\n            fftenergy[Encoder.BLKSIZE / 2 - j] = NON_LINEAR_SCALE_ENERGY((re\n                * re + im * im) * 0.5);\n        }\n        /* total energy */\n        {\n            var totalenergy = 0.0;\n            for (var j = 11; j < Encoder.HBLKSIZE; j++)\n                totalenergy += fftenergy[j];\n\n            gfc.tot_ener[chn] = totalenergy;\n        }\n\n        if (gfp.analysis) {\n            for (var j = 0; j < Encoder.HBLKSIZE; j++) {\n                gfc.pinfo.energy[gr_out][chn][j] = gfc.pinfo.energy_save[chn][j];\n                gfc.pinfo.energy_save[chn][j] = fftenergy[j];\n            }\n            gfc.pinfo.pe[gr_out][chn] = gfc.pe[chn];\n        }\n    }\n\n    function vbrpsy_compute_fft_s(gfp, buffer, bufPos, chn, sblock, fftenergy_s, wsamp_s, wsamp_sPos) {\n        var gfc = gfp.internal_flags;\n\n        if (sblock == 0 && chn < 2) {\n            fft.fft_short(gfc, wsamp_s[wsamp_sPos], chn, buffer, bufPos);\n        }\n        if (chn == 2) {\n            /* FFT data for mid and side channel is derived from L & R */\n            for (var j = Encoder.BLKSIZE_s - 1; j >= 0; --j) {\n                var l = wsamp_s[wsamp_sPos + 0][sblock][j];\n                var r = wsamp_s[wsamp_sPos + 1][sblock][j];\n                wsamp_s[wsamp_sPos + 0][sblock][j] = (l + r) * Util.SQRT2 * 0.5;\n                wsamp_s[wsamp_sPos + 1][sblock][j] = (l - r) * Util.SQRT2 * 0.5;\n            }\n        }\n\n        /*********************************************************************\n         * compute energies\n         *********************************************************************/\n        fftenergy_s[sblock][0] = wsamp_s[wsamp_sPos + 0][sblock][0];\n        fftenergy_s[sblock][0] *= fftenergy_s[sblock][0];\n        for (var j = Encoder.BLKSIZE_s / 2 - 1; j >= 0; --j) {\n            var re = wsamp_s[wsamp_sPos + 0][sblock][Encoder.BLKSIZE_s / 2 - j];\n            var im = wsamp_s[wsamp_sPos + 0][sblock][Encoder.BLKSIZE_s / 2 + j];\n            fftenergy_s[sblock][Encoder.BLKSIZE_s / 2 - j] = NON_LINEAR_SCALE_ENERGY((re\n                * re + im * im) * 0.5);\n        }\n    }\n\n    /**\n     * compute loudness approximation (used for ATH auto-level adjustment)\n     */\n    function vbrpsy_compute_loudness_approximation_l(gfp, gr_out, chn, fftenergy) {\n        var gfc = gfp.internal_flags;\n        if (gfp.athaa_loudapprox == 2 && chn < 2) {\n            // no loudness for mid/side ch\n            gfc.loudness_sq[gr_out][chn] = gfc.loudness_sq_save[chn];\n            gfc.loudness_sq_save[chn] = psycho_loudness_approx(fftenergy, gfc);\n        }\n    }\n\n    var fircoef_ = [-8.65163e-18 * 2,\n        -0.00851586 * 2, -6.74764e-18 * 2, 0.0209036 * 2,\n        -3.36639e-17 * 2, -0.0438162 * 2, -1.54175e-17 * 2,\n        0.0931738 * 2, -5.52212e-17 * 2, -0.313819 * 2];\n\n    /**\n     * Apply HPF of fs/4 to the input signal. This is used for attack detection\n     * / handling.\n     */\n    function vbrpsy_attack_detection(gfp, buffer, bufPos, gr_out, masking_ratio, masking_MS_ratio, energy, sub_short_factor, ns_attacks, uselongblock) {\n        var ns_hpfsmpl = new_float_n([2, 576]);\n        var gfc = gfp.internal_flags;\n        var n_chn_out = gfc.channels_out;\n        /* chn=2 and 3 = Mid and Side channels */\n        var n_chn_psy = (gfp.mode == MPEGMode.JOINT_STEREO) ? 4 : n_chn_out;\n        /* Don't copy the input buffer into a temporary buffer */\n        /* unroll the loop 2 times */\n        for (var chn = 0; chn < n_chn_out; chn++) {\n            /* apply high pass filter of fs/4 */\n            firbuf = buffer[chn];\n            var firbufPos = bufPos + 576 - 350 - NSFIRLEN + 192;\n            for (var i = 0; i < 576; i++) {\n                var sum1, sum2;\n                sum1 = firbuf[firbufPos + i + 10];\n                sum2 = 0.0;\n                for (var j = 0; j < ((NSFIRLEN - 1) / 2) - 1; j += 2) {\n                    sum1 += fircoef_[j]\n                        * (firbuf[firbufPos + i + j] + firbuf[firbufPos + i\n                        + NSFIRLEN - j]);\n                    sum2 += fircoef_[j + 1]\n                        * (firbuf[firbufPos + i + j + 1] + firbuf[firbufPos\n                        + i + NSFIRLEN - j - 1]);\n                }\n                ns_hpfsmpl[chn][i] = sum1 + sum2;\n            }\n            masking_ratio[gr_out][chn].en.assign(gfc.en[chn]);\n            masking_ratio[gr_out][chn].thm.assign(gfc.thm[chn]);\n            if (n_chn_psy > 2) {\n                /* MS maskings */\n                /* percep_MS_entropy [chn-2] = gfc . pe [chn]; */\n                masking_MS_ratio[gr_out][chn].en.assign(gfc.en[chn + 2]);\n                masking_MS_ratio[gr_out][chn].thm.assign(gfc.thm[chn + 2]);\n            }\n        }\n        for (var chn = 0; chn < n_chn_psy; chn++) {\n            var attack_intensity = new_float(12);\n            var en_subshort = new_float(12);\n            var en_short = [0, 0, 0, 0];\n            var pf = ns_hpfsmpl[chn & 1];\n            var pfPos = 0;\n            var attackThreshold = (chn == 3) ? gfc.nsPsy.attackthre_s\n                : gfc.nsPsy.attackthre;\n            var ns_uselongblock = 1;\n\n            if (chn == 2) {\n                for (var i = 0, j = 576; j > 0; ++i, --j) {\n                    var l = ns_hpfsmpl[0][i];\n                    var r = ns_hpfsmpl[1][i];\n                    ns_hpfsmpl[0][i] = l + r;\n                    ns_hpfsmpl[1][i] = l - r;\n                }\n            }\n            /***************************************************************\n             * determine the block type (window type)\n             ***************************************************************/\n            /* calculate energies of each sub-shortblocks */\n            for (var i = 0; i < 3; i++) {\n                en_subshort[i] = gfc.nsPsy.last_en_subshort[chn][i + 6];\n                attack_intensity[i] = en_subshort[i]\n                    / gfc.nsPsy.last_en_subshort[chn][i + 4];\n                en_short[0] += en_subshort[i];\n            }\n\n            for (var i = 0; i < 9; i++) {\n                var pfe = pfPos + 576 / 9;\n                var p = 1.;\n                for (; pfPos < pfe; pfPos++)\n                    if (p < Math.abs(pf[pfPos]))\n                        p = Math.abs(pf[pfPos]);\n\n                gfc.nsPsy.last_en_subshort[chn][i] = en_subshort[i + 3] = p;\n                en_short[1 + i / 3] += p;\n                if (p > en_subshort[i + 3 - 2]) {\n                    p = p / en_subshort[i + 3 - 2];\n                } else if (en_subshort[i + 3 - 2] > p * 10.0) {\n                    p = en_subshort[i + 3 - 2] / (p * 10.0);\n                } else {\n                    p = 0.0;\n                }\n                attack_intensity[i + 3] = p;\n            }\n            /* pulse like signal detection for fatboy.wav and so on */\n            for (var i = 0; i < 3; ++i) {\n                var enn = en_subshort[i * 3 + 3]\n                    + en_subshort[i * 3 + 4] + en_subshort[i * 3 + 5];\n                var factor = 1.;\n                if (en_subshort[i * 3 + 5] * 6 < enn) {\n                    factor *= 0.5;\n                    if (en_subshort[i * 3 + 4] * 6 < enn) {\n                        factor *= 0.5;\n                    }\n                }\n                sub_short_factor[chn][i] = factor;\n            }\n\n            if (gfp.analysis) {\n                var x = attack_intensity[0];\n                for (var i = 1; i < 12; i++) {\n                    if (x < attack_intensity[i]) {\n                        x = attack_intensity[i];\n                    }\n                }\n                gfc.pinfo.ers[gr_out][chn] = gfc.pinfo.ers_save[chn];\n                gfc.pinfo.ers_save[chn] = x;\n            }\n\n            /* compare energies between sub-shortblocks */\n            for (var i = 0; i < 12; i++) {\n                if (0 == ns_attacks[chn][i / 3]\n                    && attack_intensity[i] > attackThreshold) {\n                    ns_attacks[chn][i / 3] = (i % 3) + 1;\n                }\n            }\n\n            /*\n             * should have energy change between short blocks, in order to avoid\n             * periodic signals\n             */\n            /* Good samples to show the effect are Trumpet test songs */\n            /*\n             * GB: tuned (1) to avoid too many short blocks for test sample\n             * TRUMPET\n             */\n            /*\n             * RH: tuned (2) to let enough short blocks through for test sample\n             * FSOL and SNAPS\n             */\n            for (var i = 1; i < 4; i++) {\n                var u = en_short[i - 1];\n                var v = en_short[i];\n                var m = Math.max(u, v);\n                if (m < 40000) { /* (2) */\n                    if (u < 1.7 * v && v < 1.7 * u) { /* (1) */\n                        if (i == 1 && ns_attacks[chn][0] <= ns_attacks[chn][i]) {\n                            ns_attacks[chn][0] = 0;\n                        }\n                        ns_attacks[chn][i] = 0;\n                    }\n                }\n            }\n\n            if (ns_attacks[chn][0] <= gfc.nsPsy.lastAttacks[chn]) {\n                ns_attacks[chn][0] = 0;\n            }\n\n            if (gfc.nsPsy.lastAttacks[chn] == 3\n                || (ns_attacks[chn][0] + ns_attacks[chn][1]\n                + ns_attacks[chn][2] + ns_attacks[chn][3]) != 0) {\n                ns_uselongblock = 0;\n\n                if (ns_attacks[chn][1] != 0 && ns_attacks[chn][0] != 0) {\n                    ns_attacks[chn][1] = 0;\n                }\n                if (ns_attacks[chn][2] != 0 && ns_attacks[chn][1] != 0) {\n                    ns_attacks[chn][2] = 0;\n                }\n                if (ns_attacks[chn][3] != 0 && ns_attacks[chn][2] != 0) {\n                    ns_attacks[chn][3] = 0;\n                }\n            }\n            if (chn < 2) {\n                uselongblock[chn] = ns_uselongblock;\n            } else {\n                if (ns_uselongblock == 0) {\n                    uselongblock[0] = uselongblock[1] = 0;\n                }\n            }\n\n            /*\n             * there is a one granule delay. Copy maskings computed last call\n             * into masking_ratio to return to calling program.\n             */\n            energy[chn] = gfc.tot_ener[chn];\n        }\n    }\n\n    function vbrpsy_skip_masking_s(gfc, chn, sblock) {\n        if (sblock == 0) {\n            for (var b = 0; b < gfc.npart_s; b++) {\n                gfc.nb_s2[chn][b] = gfc.nb_s1[chn][b];\n                gfc.nb_s1[chn][b] = 0;\n            }\n        }\n    }\n\n    function vbrpsy_skip_masking_l(gfc, chn) {\n        for (var b = 0; b < gfc.npart_l; b++) {\n            gfc.nb_2[chn][b] = gfc.nb_1[chn][b];\n            gfc.nb_1[chn][b] = 0;\n        }\n    }\n\n    function psyvbr_calc_mask_index_s(gfc, max, avg, mask_idx) {\n        var last_tab_entry = tab.length - 1;\n        var b = 0;\n        var a = avg[b] + avg[b + 1];\n        if (a > 0.0) {\n            var m = max[b];\n            if (m < max[b + 1])\n                m = max[b + 1];\n            a = 20.0 * (m * 2.0 - a)\n                / (a * (gfc.numlines_s[b] + gfc.numlines_s[b + 1] - 1));\n            var k = 0 | a;\n            if (k > last_tab_entry)\n                k = last_tab_entry;\n            mask_idx[b] = k;\n        } else {\n            mask_idx[b] = 0;\n        }\n\n        for (b = 1; b < gfc.npart_s - 1; b++) {\n            a = avg[b - 1] + avg[b] + avg[b + 1];\n            if (a > 0.0) {\n                var m = max[b - 1];\n                if (m < max[b])\n                    m = max[b];\n                if (m < max[b + 1])\n                    m = max[b + 1];\n                a = 20.0\n                    * (m * 3.0 - a)\n                    / (a * (gfc.numlines_s[b - 1] + gfc.numlines_s[b]\n                    + gfc.numlines_s[b + 1] - 1));\n                var k = 0 | a;\n                if (k > last_tab_entry)\n                    k = last_tab_entry;\n                mask_idx[b] = k;\n            } else {\n                mask_idx[b] = 0;\n            }\n        }\n\n        a = avg[b - 1] + avg[b];\n        if (a > 0.0) {\n            var m = max[b - 1];\n            if (m < max[b])\n                m = max[b];\n            a = 20.0 * (m * 2.0 - a)\n                / (a * (gfc.numlines_s[b - 1] + gfc.numlines_s[b] - 1));\n            var k = 0 | a;\n            if (k > last_tab_entry)\n                k = last_tab_entry;\n            mask_idx[b] = k;\n        } else {\n            mask_idx[b] = 0;\n        }\n    }\n\n    function vbrpsy_compute_masking_s(gfp, fftenergy_s, eb, thr, chn, sblock) {\n        var gfc = gfp.internal_flags;\n        var max = new float[Encoder.CBANDS], avg = new_float(Encoder.CBANDS);\n        var i, j, b;\n        var mask_idx_s = new int[Encoder.CBANDS];\n\n        for (b = j = 0; b < gfc.npart_s; ++b) {\n            var ebb = 0, m = 0;\n            var n = gfc.numlines_s[b];\n            for (i = 0; i < n; ++i, ++j) {\n                var el = fftenergy_s[sblock][j];\n                ebb += el;\n                if (m < el)\n                    m = el;\n            }\n            eb[b] = ebb;\n            max[b] = m;\n            avg[b] = ebb / n;\n        }\n        for (; b < Encoder.CBANDS; ++b) {\n            max[b] = 0;\n            avg[b] = 0;\n        }\n        psyvbr_calc_mask_index_s(gfc, max, avg, mask_idx_s);\n        for (j = b = 0; b < gfc.npart_s; b++) {\n            var kk = gfc.s3ind_s[b][0];\n            var last = gfc.s3ind_s[b][1];\n            var dd, dd_n;\n            var x, ecb, avg_mask;\n            dd = mask_idx_s[kk];\n            dd_n = 1;\n            ecb = gfc.s3_ss[j] * eb[kk] * tab[mask_idx_s[kk]];\n            ++j;\n            ++kk;\n            while (kk <= last) {\n                dd += mask_idx_s[kk];\n                dd_n += 1;\n                x = gfc.s3_ss[j] * eb[kk] * tab[mask_idx_s[kk]];\n                ecb = vbrpsy_mask_add(ecb, x, kk - b);\n                ++j;\n                ++kk;\n            }\n            dd = (1 + 2 * dd) / (2 * dd_n);\n            avg_mask = tab[dd] * 0.5;\n            ecb *= avg_mask;\n            thr[b] = ecb;\n            gfc.nb_s2[chn][b] = gfc.nb_s1[chn][b];\n            gfc.nb_s1[chn][b] = ecb;\n            {\n                /*\n                 * if THR exceeds EB, the quantization routines will take the\n                 * difference from other bands. in case of strong tonal samples\n                 * (tonaltest.wav) this leads to heavy distortions. that's why\n                 * we limit THR here.\n                 */\n                x = max[b];\n                x *= gfc.minval_s[b];\n                x *= avg_mask;\n                if (thr[b] > x) {\n                    thr[b] = x;\n                }\n            }\n            if (gfc.masking_lower > 1) {\n                thr[b] *= gfc.masking_lower;\n            }\n            if (thr[b] > eb[b]) {\n                thr[b] = eb[b];\n            }\n            if (gfc.masking_lower < 1) {\n                thr[b] *= gfc.masking_lower;\n            }\n\n        }\n        for (; b < Encoder.CBANDS; ++b) {\n            eb[b] = 0;\n            thr[b] = 0;\n        }\n    }\n\n    function vbrpsy_compute_masking_l(gfc, fftenergy, eb_l, thr, chn) {\n        var max = new_float(Encoder.CBANDS), avg = new_float(Encoder.CBANDS);\n        var mask_idx_l = new_int(Encoder.CBANDS + 2);\n        var b;\n\n        /*********************************************************************\n         * Calculate the energy and the tonality of each partition.\n         *********************************************************************/\n        calc_energy(gfc, fftenergy, eb_l, max, avg);\n        calc_mask_index_l(gfc, max, avg, mask_idx_l);\n\n        /*********************************************************************\n         * convolve the partitioned energy and unpredictability with the\n         * spreading function, s3_l[b][k]\n         ********************************************************************/\n        var k = 0;\n        for (b = 0; b < gfc.npart_l; b++) {\n            var x, ecb, avg_mask, t;\n            /* convolve the partitioned energy with the spreading function */\n            var kk = gfc.s3ind[b][0];\n            var last = gfc.s3ind[b][1];\n            var dd = 0, dd_n = 0;\n            dd = mask_idx_l[kk];\n            dd_n += 1;\n            ecb = gfc.s3_ll[k] * eb_l[kk] * tab[mask_idx_l[kk]];\n            ++k;\n            ++kk;\n            while (kk <= last) {\n                dd += mask_idx_l[kk];\n                dd_n += 1;\n                x = gfc.s3_ll[k] * eb_l[kk] * tab[mask_idx_l[kk]];\n                t = vbrpsy_mask_add(ecb, x, kk - b);\n                ecb = t;\n                ++k;\n                ++kk;\n            }\n            dd = (1 + 2 * dd) / (2 * dd_n);\n            avg_mask = tab[dd] * 0.5;\n            ecb *= avg_mask;\n\n            /**** long block pre-echo control ****/\n            /**\n             * <PRE>\n             * dont use long block pre-echo control if previous granule was\n             * a short block.  This is to avoid the situation:\n             * frame0:  quiet (very low masking)\n             * frame1:  surge  (triggers short blocks)\n             * frame2:  regular frame.  looks like pre-echo when compared to\n             *          frame0, but all pre-echo was in frame1.\n             * </PRE>\n             */\n            /*\n             * chn=0,1 L and R channels chn=2,3 S and M channels.\n             */\n            if (gfc.blocktype_old[chn & 0x01] == Encoder.SHORT_TYPE) {\n                var ecb_limit = rpelev * gfc.nb_1[chn][b];\n                if (ecb_limit > 0) {\n                    thr[b] = Math.min(ecb, ecb_limit);\n                } else {\n                    /**\n                     * <PRE>\n                     * Robert 071209:\n                     * Because we don't calculate long block psy when we know a granule\n                     * should be of short blocks, we don't have any clue how the granule\n                     * before would have looked like as a long block. So we have to guess\n                     * a little bit for this END_TYPE block.\n                     * Most of the time we get away with this sloppyness. (fingers crossed :)\n                     * The speed increase is worth it.\n                     * </PRE>\n                     */\n                    thr[b] = Math.min(ecb, eb_l[b] * NS_PREECHO_ATT2);\n                }\n            } else {\n                var ecb_limit_2 = rpelev2 * gfc.nb_2[chn][b];\n                var ecb_limit_1 = rpelev * gfc.nb_1[chn][b];\n                var ecb_limit;\n                if (ecb_limit_2 <= 0) {\n                    ecb_limit_2 = ecb;\n                }\n                if (ecb_limit_1 <= 0) {\n                    ecb_limit_1 = ecb;\n                }\n                if (gfc.blocktype_old[chn & 0x01] == Encoder.NORM_TYPE) {\n                    ecb_limit = Math.min(ecb_limit_1, ecb_limit_2);\n                } else {\n                    ecb_limit = ecb_limit_1;\n                }\n                thr[b] = Math.min(ecb, ecb_limit);\n            }\n            gfc.nb_2[chn][b] = gfc.nb_1[chn][b];\n            gfc.nb_1[chn][b] = ecb;\n            {\n                /*\n                 * if THR exceeds EB, the quantization routines will take the\n                 * difference from other bands. in case of strong tonal samples\n                 * (tonaltest.wav) this leads to heavy distortions. that's why\n                 * we limit THR here.\n                 */\n                x = max[b];\n                x *= gfc.minval_l[b];\n                x *= avg_mask;\n                if (thr[b] > x) {\n                    thr[b] = x;\n                }\n            }\n            if (gfc.masking_lower > 1) {\n                thr[b] *= gfc.masking_lower;\n            }\n            if (thr[b] > eb_l[b]) {\n                thr[b] = eb_l[b];\n            }\n            if (gfc.masking_lower < 1) {\n                thr[b] *= gfc.masking_lower;\n            }\n        }\n        for (; b < Encoder.CBANDS; ++b) {\n            eb_l[b] = 0;\n            thr[b] = 0;\n        }\n    }\n\n    function vbrpsy_compute_block_type(gfp, uselongblock) {\n        var gfc = gfp.internal_flags;\n\n        if (gfp.short_blocks == ShortBlock.short_block_coupled\n                /* force both channels to use the same block type */\n                /* this is necessary if the frame is to be encoded in ms_stereo. */\n                /* But even without ms_stereo, FhG does this */\n            && !(uselongblock[0] != 0 && uselongblock[1] != 0))\n            uselongblock[0] = uselongblock[1] = 0;\n\n        for (var chn = 0; chn < gfc.channels_out; chn++) {\n            /* disable short blocks */\n            if (gfp.short_blocks == ShortBlock.short_block_dispensed) {\n                uselongblock[chn] = 1;\n            }\n            if (gfp.short_blocks == ShortBlock.short_block_forced) {\n                uselongblock[chn] = 0;\n            }\n        }\n    }\n\n    function vbrpsy_apply_block_type(gfp, uselongblock, blocktype_d) {\n        var gfc = gfp.internal_flags;\n\n        /*\n         * update the blocktype of the previous granule, since it depends on\n         * what happend in this granule\n         */\n        for (var chn = 0; chn < gfc.channels_out; chn++) {\n            var blocktype = Encoder.NORM_TYPE;\n            /* disable short blocks */\n\n            if (uselongblock[chn] != 0) {\n                /* no attack : use long blocks */\n                if (gfc.blocktype_old[chn] == Encoder.SHORT_TYPE)\n                    blocktype = Encoder.STOP_TYPE;\n            } else {\n                /* attack : use short blocks */\n                blocktype = Encoder.SHORT_TYPE;\n                if (gfc.blocktype_old[chn] == Encoder.NORM_TYPE) {\n                    gfc.blocktype_old[chn] = Encoder.START_TYPE;\n                }\n                if (gfc.blocktype_old[chn] == Encoder.STOP_TYPE)\n                    gfc.blocktype_old[chn] = Encoder.SHORT_TYPE;\n            }\n\n            blocktype_d[chn] = gfc.blocktype_old[chn];\n            // value returned to calling program\n            gfc.blocktype_old[chn] = blocktype;\n            // save for next call to l3psy_anal\n        }\n    }\n\n    /**\n     * compute M/S thresholds from Johnston & Ferreira 1992 ICASSP paper\n     */\n    function vbrpsy_compute_MS_thresholds(eb, thr, cb_mld, ath_cb, athadjust, msfix, n) {\n        var msfix2 = msfix * 2;\n        var athlower = msfix > 0 ? Math.pow(10, athadjust) : 1;\n        var rside, rmid;\n        for (var b = 0; b < n; ++b) {\n            var ebM = eb[2][b];\n            var ebS = eb[3][b];\n            var thmL = thr[0][b];\n            var thmR = thr[1][b];\n            var thmM = thr[2][b];\n            var thmS = thr[3][b];\n\n            /* use this fix if L & R masking differs by 2db or less */\n            if (thmL <= 1.58 * thmR && thmR <= 1.58 * thmL) {\n                var mld_m = cb_mld[b] * ebS;\n                var mld_s = cb_mld[b] * ebM;\n                rmid = Math.max(thmM, Math.min(thmS, mld_m));\n                rside = Math.max(thmS, Math.min(thmM, mld_s));\n            } else {\n                rmid = thmM;\n                rside = thmS;\n            }\n            if (msfix > 0) {\n                /***************************************************************/\n                /* Adjust M/S maskings if user set \"msfix\" */\n                /***************************************************************/\n                /* Naoki Shibata 2000 */\n                var thmLR, thmMS;\n                var ath = ath_cb[b] * athlower;\n                thmLR = Math.min(Math.max(thmL, ath), Math.max(thmR, ath));\n                thmM = Math.max(rmid, ath);\n                thmS = Math.max(rside, ath);\n                thmMS = thmM + thmS;\n                if (thmMS > 0 && (thmLR * msfix2) < thmMS) {\n                    var f = thmLR * msfix2 / thmMS;\n                    thmM *= f;\n                    thmS *= f;\n                }\n                rmid = Math.min(thmM, rmid);\n                rside = Math.min(thmS, rside);\n            }\n            if (rmid > ebM) {\n                rmid = ebM;\n            }\n            if (rside > ebS) {\n                rside = ebS;\n            }\n            thr[2][b] = rmid;\n            thr[3][b] = rside;\n        }\n    }\n\n    this.L3psycho_anal_vbr = function (gfp, buffer, bufPos, gr_out, masking_ratio, masking_MS_ratio, percep_entropy, percep_MS_entropy, energy, blocktype_d) {\n        var gfc = gfp.internal_flags;\n\n        /* fft and energy calculation */\n        var wsamp_l;\n        var wsamp_s;\n        var fftenergy = new_float(Encoder.HBLKSIZE);\n        var fftenergy_s = new_float_n([3, Encoder.HBLKSIZE_s]);\n        var wsamp_L = new_float_n([2, Encoder.BLKSIZE]);\n        var wsamp_S = new_float_n([2, 3, Encoder.BLKSIZE_s]);\n        var eb = new_float_n([4, Encoder.CBANDS]), thr = new_float_n([4, Encoder.CBANDS]);\n        var sub_short_factor = new_float_n([4, 3]);\n        var pcfact = 0.6;\n\n        /* block type */\n        var ns_attacks = [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0],\n            [0, 0, 0, 0]];\n        var uselongblock = new_int(2);\n\n        /* usual variables like loop indices, etc.. */\n\n        /* chn=2 and 3 = Mid and Side channels */\n        var n_chn_psy = (gfp.mode == MPEGMode.JOINT_STEREO) ? 4\n            : gfc.channels_out;\n\n        vbrpsy_attack_detection(gfp, buffer, bufPos, gr_out, masking_ratio,\n            masking_MS_ratio, energy, sub_short_factor, ns_attacks,\n            uselongblock);\n\n        vbrpsy_compute_block_type(gfp, uselongblock);\n\n        /* LONG BLOCK CASE */\n        {\n            for (var chn = 0; chn < n_chn_psy; chn++) {\n                var ch01 = chn & 0x01;\n                wsamp_l = wsamp_L;\n                vbrpsy_compute_fft_l(gfp, buffer, bufPos, chn, gr_out,\n                    fftenergy, wsamp_l, ch01);\n\n                vbrpsy_compute_loudness_approximation_l(gfp, gr_out, chn,\n                    fftenergy);\n\n                if (uselongblock[ch01] != 0) {\n                    vbrpsy_compute_masking_l(gfc, fftenergy, eb[chn], thr[chn],\n                        chn);\n                } else {\n                    vbrpsy_skip_masking_l(gfc, chn);\n                }\n            }\n            if ((uselongblock[0] + uselongblock[1]) == 2) {\n                /* M/S channel */\n                if (gfp.mode == MPEGMode.JOINT_STEREO) {\n                    vbrpsy_compute_MS_thresholds(eb, thr, gfc.mld_cb_l,\n                        gfc.ATH.cb_l, gfp.ATHlower * gfc.ATH.adjust,\n                        gfp.msfix, gfc.npart_l);\n                }\n            }\n            /* TODO: apply adaptive ATH masking here ?? */\n            for (var chn = 0; chn < n_chn_psy; chn++) {\n                var ch01 = chn & 0x01;\n                if (uselongblock[ch01] != 0) {\n                    convert_partition2scalefac_l(gfc, eb[chn], thr[chn], chn);\n                }\n            }\n        }\n\n        /* SHORT BLOCKS CASE */\n        {\n            for (var sblock = 0; sblock < 3; sblock++) {\n                for (var chn = 0; chn < n_chn_psy; ++chn) {\n                    var ch01 = chn & 0x01;\n\n                    if (uselongblock[ch01] != 0) {\n                        vbrpsy_skip_masking_s(gfc, chn, sblock);\n                    } else {\n                        /* compute masking thresholds for short blocks */\n                        wsamp_s = wsamp_S;\n                        vbrpsy_compute_fft_s(gfp, buffer, bufPos, chn, sblock,\n                            fftenergy_s, wsamp_s, ch01);\n                        vbrpsy_compute_masking_s(gfp, fftenergy_s, eb[chn],\n                            thr[chn], chn, sblock);\n                    }\n                }\n                if ((uselongblock[0] + uselongblock[1]) == 0) {\n                    /* M/S channel */\n                    if (gfp.mode == MPEGMode.JOINT_STEREO) {\n                        vbrpsy_compute_MS_thresholds(eb, thr, gfc.mld_cb_s,\n                            gfc.ATH.cb_s, gfp.ATHlower * gfc.ATH.adjust,\n                            gfp.msfix, gfc.npart_s);\n                    }\n                    /* L/R channel */\n                }\n                /* TODO: apply adaptive ATH masking here ?? */\n                for (var chn = 0; chn < n_chn_psy; ++chn) {\n                    var ch01 = chn & 0x01;\n                    if (0 == uselongblock[ch01]) {\n                        convert_partition2scalefac_s(gfc, eb[chn], thr[chn],\n                            chn, sblock);\n                    }\n                }\n            }\n\n            /**** short block pre-echo control ****/\n            for (var chn = 0; chn < n_chn_psy; chn++) {\n                var ch01 = chn & 0x01;\n\n                if (uselongblock[ch01] != 0) {\n                    continue;\n                }\n                for (var sb = 0; sb < Encoder.SBMAX_s; sb++) {\n                    var new_thmm = new_float(3);\n                    for (var sblock = 0; sblock < 3; sblock++) {\n                        var thmm = gfc.thm[chn].s[sb][sblock];\n                        thmm *= NS_PREECHO_ATT0;\n\n                        if (ns_attacks[chn][sblock] >= 2\n                            || ns_attacks[chn][sblock + 1] == 1) {\n                            var idx = (sblock != 0) ? sblock - 1 : 2;\n                            var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                                NS_PREECHO_ATT1 * pcfact);\n                            thmm = Math.min(thmm, p);\n                        } else if (ns_attacks[chn][sblock] == 1) {\n                            var idx = (sblock != 0) ? sblock - 1 : 2;\n                            var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                                NS_PREECHO_ATT2 * pcfact);\n                            thmm = Math.min(thmm, p);\n                        } else if ((sblock != 0 && ns_attacks[chn][sblock - 1] == 3)\n                            || (sblock == 0 && gfc.nsPsy.lastAttacks[chn] == 3)) {\n                            var idx = (sblock != 2) ? sblock + 1 : 0;\n                            var p = NS_INTERP(gfc.thm[chn].s[sb][idx], thmm,\n                                NS_PREECHO_ATT2 * pcfact);\n                            thmm = Math.min(thmm, p);\n                        }\n\n                        /* pulse like signal detection for fatboy.wav and so on */\n                        thmm *= sub_short_factor[chn][sblock];\n\n                        new_thmm[sblock] = thmm;\n                    }\n                    for (var sblock = 0; sblock < 3; sblock++) {\n                        gfc.thm[chn].s[sb][sblock] = new_thmm[sblock];\n                    }\n                }\n            }\n        }\n        for (var chn = 0; chn < n_chn_psy; chn++) {\n            gfc.nsPsy.lastAttacks[chn] = ns_attacks[chn][2];\n        }\n\n        /***************************************************************\n         * determine final block type\n         ***************************************************************/\n        vbrpsy_apply_block_type(gfp, uselongblock, blocktype_d);\n\n        /*********************************************************************\n         * compute the value of PE to return ... no delay and advance\n         *********************************************************************/\n        for (var chn = 0; chn < n_chn_psy; chn++) {\n            var ppe;\n            var ppePos;\n            var type;\n            var mr;\n\n            if (chn > 1) {\n                ppe = percep_MS_entropy;\n                ppePos = -2;\n                type = Encoder.NORM_TYPE;\n                if (blocktype_d[0] == Encoder.SHORT_TYPE\n                    || blocktype_d[1] == Encoder.SHORT_TYPE)\n                    type = Encoder.SHORT_TYPE;\n                mr = masking_MS_ratio[gr_out][chn - 2];\n            } else {\n                ppe = percep_entropy;\n                ppePos = 0;\n                type = blocktype_d[chn];\n                mr = masking_ratio[gr_out][chn];\n            }\n\n            if (type == Encoder.SHORT_TYPE) {\n                ppe[ppePos + chn] = pecalc_s(mr, gfc.masking_lower);\n            } else {\n                ppe[ppePos + chn] = pecalc_l(mr, gfc.masking_lower);\n            }\n\n            if (gfp.analysis) {\n                gfc.pinfo.pe[gr_out][chn] = ppe[ppePos + chn];\n            }\n        }\n        return 0;\n    }\n\n    function s3_func_x(bark, hf_slope) {\n        var tempx = bark, tempy;\n\n        if (tempx >= 0) {\n            tempy = -tempx * 27;\n        } else {\n            tempy = tempx * hf_slope;\n        }\n        if (tempy <= -72.0) {\n            return 0;\n        }\n        return Math.exp(tempy * LN_TO_LOG10);\n    }\n\n    function norm_s3_func_x(hf_slope) {\n        var lim_a = 0, lim_b = 0;\n        {\n            var x = 0, l, h;\n            for (x = 0; s3_func_x(x, hf_slope) > 1e-20; x -= 1)\n                ;\n            l = x;\n            h = 0;\n            while (Math.abs(h - l) > 1e-12) {\n                x = (h + l) / 2;\n                if (s3_func_x(x, hf_slope) > 0) {\n                    h = x;\n                } else {\n                    l = x;\n                }\n            }\n            lim_a = l;\n        }\n        {\n            var x = 0, l, h;\n            for (x = 0; s3_func_x(x, hf_slope) > 1e-20; x += 1)\n                ;\n            l = 0;\n            h = x;\n            while (Math.abs(h - l) > 1e-12) {\n                x = (h + l) / 2;\n                if (s3_func_x(x, hf_slope) > 0) {\n                    l = x;\n                } else {\n                    h = x;\n                }\n            }\n            lim_b = h;\n        }\n        {\n            var sum = 0;\n            var m = 1000;\n            var i;\n            for (i = 0; i <= m; ++i) {\n                var x = lim_a + i * (lim_b - lim_a) / m;\n                var y = s3_func_x(x, hf_slope);\n                sum += y;\n            }\n            {\n                var norm = (m + 1) / (sum * (lim_b - lim_a));\n                /* printf( \"norm = %lf\\n\",norm); */\n                return norm;\n            }\n        }\n    }\n\n    /**\n     *   The spreading function.  Values returned in units of energy\n     */\n    function s3_func(bark) {\n        var tempx, x, tempy, temp;\n        tempx = bark;\n        if (tempx >= 0)\n            tempx *= 3;\n        else\n            tempx *= 1.5;\n\n        if (tempx >= 0.5 && tempx <= 2.5) {\n            temp = tempx - 0.5;\n            x = 8.0 * (temp * temp - 2.0 * temp);\n        } else\n            x = 0.0;\n        tempx += 0.474;\n        tempy = 15.811389 + 7.5 * tempx - 17.5\n            * Math.sqrt(1.0 + tempx * tempx);\n\n        if (tempy <= -60.0)\n            return 0.0;\n\n        tempx = Math.exp((x + tempy) * LN_TO_LOG10);\n\n        /**\n         * <PRE>\n         * Normalization.  The spreading function should be normalized so that:\n         * +inf\n         * /\n         * |  s3 [ bark ]  d(bark)   =  1\n         * /\n         * -inf\n         * </PRE>\n         */\n        tempx /= .6609193;\n        return tempx;\n    }\n\n    /**\n     * see for example \"Zwicker: Psychoakustik, 1982; ISBN 3-540-11401-7\n     */\n    function freq2bark(freq) {\n        /* input: freq in hz output: barks */\n        if (freq < 0)\n            freq = 0;\n        freq = freq * 0.001;\n        return 13.0 * Math.atan(.76 * freq) + 3.5\n            * Math.atan(freq * freq / (7.5 * 7.5));\n    }\n\n    function init_numline(numlines, bo, bm, bval, bval_width, mld, bo_w, sfreq, blksize, scalepos, deltafreq, sbmax) {\n        var b_frq = new_float(Encoder.CBANDS + 1);\n        var sample_freq_frac = sfreq / (sbmax > 15 ? 2 * 576 : 2 * 192);\n        var partition = new_int(Encoder.HBLKSIZE);\n        var i;\n        sfreq /= blksize;\n        var j = 0;\n        var ni = 0;\n        /* compute numlines, the number of spectral lines in each partition band */\n        /* each partition band should be about DELBARK wide. */\n        for (i = 0; i < Encoder.CBANDS; i++) {\n            var bark1;\n            var j2;\n            bark1 = freq2bark(sfreq * j);\n\n            b_frq[i] = sfreq * j;\n\n            for (j2 = j; freq2bark(sfreq * j2) - bark1 < DELBARK\n            && j2 <= blksize / 2; j2++)\n                ;\n\n            numlines[i] = j2 - j;\n            ni = i + 1;\n\n            while (j < j2) {\n                partition[j++] = i;\n            }\n            if (j > blksize / 2) {\n                j = blksize / 2;\n                ++i;\n                break;\n            }\n        }\n        b_frq[i] = sfreq * j;\n\n        for (var sfb = 0; sfb < sbmax; sfb++) {\n            var i1, i2, start, end;\n            var arg;\n            start = scalepos[sfb];\n            end = scalepos[sfb + 1];\n\n            i1 = 0 | Math.floor(.5 + deltafreq * (start - .5));\n            if (i1 < 0)\n                i1 = 0;\n            i2 = 0 | Math.floor(.5 + deltafreq * (end - .5));\n\n            if (i2 > blksize / 2)\n                i2 = blksize / 2;\n\n            bm[sfb] = (partition[i1] + partition[i2]) / 2;\n            bo[sfb] = partition[i2];\n            var f_tmp = sample_freq_frac * end;\n            /*\n             * calculate how much of this band belongs to current scalefactor\n             * band\n             */\n            bo_w[sfb] = (f_tmp - b_frq[bo[sfb]])\n                / (b_frq[bo[sfb] + 1] - b_frq[bo[sfb]]);\n            if (bo_w[sfb] < 0) {\n                bo_w[sfb] = 0;\n            } else {\n                if (bo_w[sfb] > 1) {\n                    bo_w[sfb] = 1;\n                }\n            }\n            /* setup stereo demasking thresholds */\n            /* formula reverse enginerred from plot in paper */\n            arg = freq2bark(sfreq * scalepos[sfb] * deltafreq);\n            arg = ( Math.min(arg, 15.5) / 15.5);\n\n            mld[sfb] = Math.pow(10.0,\n                1.25 * (1 - Math.cos(Math.PI * arg)) - 2.5);\n        }\n\n        /* compute bark values of each critical band */\n        j = 0;\n        for (var k = 0; k < ni; k++) {\n            var w = numlines[k];\n            var bark1, bark2;\n\n            bark1 = freq2bark(sfreq * (j));\n            bark2 = freq2bark(sfreq * (j + w - 1));\n            bval[k] = .5 * (bark1 + bark2);\n\n            bark1 = freq2bark(sfreq * (j - .5));\n            bark2 = freq2bark(sfreq * (j + w - .5));\n            bval_width[k] = bark2 - bark1;\n            j += w;\n        }\n\n        return ni;\n    }\n\n    function init_s3_values(s3ind, npart, bval, bval_width, norm, use_old_s3) {\n        var s3 = new_float_n([Encoder.CBANDS, Encoder.CBANDS]);\n        /*\n         * The s3 array is not linear in the bark scale.\n         *\n         * bval[x] should be used to get the bark value.\n         */\n        var j;\n        var numberOfNoneZero = 0;\n\n        /**\n         * <PRE>\n         * s[i][j], the value of the spreading function,\n         * centered at band j (masker), for band i (maskee)\n         *\n         * i.e.: sum over j to spread into signal barkval=i\n         * NOTE: i and j are used opposite as in the ISO docs\n         * </PRE>\n         */\n        if (use_old_s3) {\n            for (var i = 0; i < npart; i++) {\n                for (j = 0; j < npart; j++) {\n                    var v = s3_func(bval[i] - bval[j]) * bval_width[j];\n                    s3[i][j] = v * norm[i];\n                }\n            }\n        } else {\n            for (j = 0; j < npart; j++) {\n                var hf_slope = 15 + Math.min(21 / bval[j], 12);\n                var s3_x_norm = norm_s3_func_x(hf_slope);\n                for (var i = 0; i < npart; i++) {\n                    var v = s3_x_norm\n                        * s3_func_x(bval[i] - bval[j], hf_slope)\n                        * bval_width[j];\n                    s3[i][j] = v * norm[i];\n                }\n            }\n        }\n        for (var i = 0; i < npart; i++) {\n            for (j = 0; j < npart; j++) {\n                if (s3[i][j] > 0.0)\n                    break;\n            }\n            s3ind[i][0] = j;\n\n            for (j = npart - 1; j > 0; j--) {\n                if (s3[i][j] > 0.0)\n                    break;\n            }\n            s3ind[i][1] = j;\n            numberOfNoneZero += (s3ind[i][1] - s3ind[i][0] + 1);\n        }\n\n        var p = new_float(numberOfNoneZero);\n        var k = 0;\n        for (var i = 0; i < npart; i++)\n            for (j = s3ind[i][0]; j <= s3ind[i][1]; j++)\n                p[k++] = s3[i][j];\n\n        return p;\n    }\n\n    function stereo_demask(f) {\n        /* setup stereo demasking thresholds */\n        /* formula reverse enginerred from plot in paper */\n        var arg = freq2bark(f);\n        arg = (Math.min(arg, 15.5) / 15.5);\n\n        return Math.pow(10.0,\n            1.25 * (1 - Math.cos(Math.PI * arg)) - 2.5);\n    }\n\n    /**\n     * NOTE: the bitrate reduction from the inter-channel masking effect is low\n     * compared to the chance of getting annyoing artefacts. L3psycho_anal_vbr\n     * does not use this feature. (Robert 071216)\n     */\n    this.psymodel_init = function (gfp) {\n        var gfc = gfp.internal_flags;\n        var i;\n        var useOldS3 = true;\n        var bvl_a = 13, bvl_b = 24;\n        var snr_l_a = 0, snr_l_b = 0;\n        var snr_s_a = -8.25, snr_s_b = -4.5;\n        var bval = new_float(Encoder.CBANDS);\n        var bval_width = new_float(Encoder.CBANDS);\n        var norm = new_float(Encoder.CBANDS);\n        var sfreq = gfp.out_samplerate;\n\n        switch (gfp.experimentalZ) {\n            default:\n            case 0:\n                useOldS3 = true;\n                break;\n            case 1:\n                useOldS3 = (gfp.VBR == VbrMode.vbr_mtrh || gfp.VBR == VbrMode.vbr_mt) ? false\n                    : true;\n                break;\n            case 2:\n                useOldS3 = false;\n                break;\n            case 3:\n                bvl_a = 8;\n                snr_l_a = -1.75;\n                snr_l_b = -0.0125;\n                snr_s_a = -8.25;\n                snr_s_b = -2.25;\n                break;\n        }\n        gfc.ms_ener_ratio_old = .25;\n        gfc.blocktype_old[0] = gfc.blocktype_old[1] = Encoder.NORM_TYPE;\n        // the vbr header is long blocks\n\n        for (i = 0; i < 4; ++i) {\n            for (var j = 0; j < Encoder.CBANDS; ++j) {\n                gfc.nb_1[i][j] = 1e20;\n                gfc.nb_2[i][j] = 1e20;\n                gfc.nb_s1[i][j] = gfc.nb_s2[i][j] = 1.0;\n            }\n            for (var sb = 0; sb < Encoder.SBMAX_l; sb++) {\n                gfc.en[i].l[sb] = 1e20;\n                gfc.thm[i].l[sb] = 1e20;\n            }\n            for (var j = 0; j < 3; ++j) {\n                for (var sb = 0; sb < Encoder.SBMAX_s; sb++) {\n                    gfc.en[i].s[sb][j] = 1e20;\n                    gfc.thm[i].s[sb][j] = 1e20;\n                }\n                gfc.nsPsy.lastAttacks[i] = 0;\n            }\n            for (var j = 0; j < 9; j++)\n                gfc.nsPsy.last_en_subshort[i][j] = 10.;\n        }\n\n        /* init. for loudness approx. -jd 2001 mar 27 */\n        gfc.loudness_sq_save[0] = gfc.loudness_sq_save[1] = 0.0;\n\n        /*************************************************************************\n         * now compute the psychoacoustic model specific constants\n         ************************************************************************/\n        /* compute numlines, bo, bm, bval, bval_width, mld */\n\n        gfc.npart_l = init_numline(gfc.numlines_l, gfc.bo_l, gfc.bm_l, bval,\n            bval_width, gfc.mld_l, gfc.PSY.bo_l_weight, sfreq,\n            Encoder.BLKSIZE, gfc.scalefac_band.l, Encoder.BLKSIZE\n            / (2.0 * 576), Encoder.SBMAX_l);\n        /* compute the spreading function */\n        for (i = 0; i < gfc.npart_l; i++) {\n            var snr = snr_l_a;\n            if (bval[i] >= bvl_a) {\n                snr = snr_l_b * (bval[i] - bvl_a) / (bvl_b - bvl_a) + snr_l_a\n                    * (bvl_b - bval[i]) / (bvl_b - bvl_a);\n            }\n            norm[i] = Math.pow(10.0, snr / 10.0);\n            if (gfc.numlines_l[i] > 0) {\n                gfc.rnumlines_l[i] = 1.0 / gfc.numlines_l[i];\n            } else {\n                gfc.rnumlines_l[i] = 0;\n            }\n        }\n        gfc.s3_ll = init_s3_values(gfc.s3ind, gfc.npart_l, bval, bval_width,\n            norm, useOldS3);\n\n        /* compute long block specific values, ATH and MINVAL */\n        var j = 0;\n        for (i = 0; i < gfc.npart_l; i++) {\n            var x;\n\n            /* ATH */\n            x = Float.MAX_VALUE;\n            for (var k = 0; k < gfc.numlines_l[i]; k++, j++) {\n                var freq = sfreq * j / (1000.0 * Encoder.BLKSIZE);\n                var level;\n                /*\n                 * ATH below 100 Hz constant, not further climbing\n                 */\n                level = this.ATHformula(freq * 1000, gfp) - 20;\n                // scale to FFT units; returned value is in dB\n                level = Math.pow(10., 0.1 * level);\n                // convert from dB . energy\n                level *= gfc.numlines_l[i];\n                if (x > level)\n                    x = level;\n            }\n            gfc.ATH.cb_l[i] = x;\n\n            /*\n             * MINVAL. For low freq, the strength of the masking is limited by\n             * minval this is an ISO MPEG1 thing, dont know if it is really\n             * needed\n             */\n            /*\n             * FIXME: it does work to reduce low-freq problems in S53-Wind-Sax\n             * and lead-voice samples, but introduces some 3 kbps bit bloat too.\n             * TODO: Further refinement of the shape of this hack.\n             */\n            x = -20 + bval[i] * 20 / 10;\n            if (x > 6) {\n                x = 100;\n            }\n            if (x < -15) {\n                x = -15;\n            }\n            x -= 8.;\n            gfc.minval_l[i] = (Math.pow(10.0, x / 10.) * gfc.numlines_l[i]);\n        }\n\n        /************************************************************************\n         * do the same things for short blocks\n         ************************************************************************/\n        gfc.npart_s = init_numline(gfc.numlines_s, gfc.bo_s, gfc.bm_s, bval,\n            bval_width, gfc.mld_s, gfc.PSY.bo_s_weight, sfreq,\n            Encoder.BLKSIZE_s, gfc.scalefac_band.s, Encoder.BLKSIZE_s\n            / (2.0 * 192), Encoder.SBMAX_s);\n\n        /* SNR formula. short block is normalized by SNR. is it still right ? */\n        j = 0;\n        for (i = 0; i < gfc.npart_s; i++) {\n            var x;\n            var snr = snr_s_a;\n            if (bval[i] >= bvl_a) {\n                snr = snr_s_b * (bval[i] - bvl_a) / (bvl_b - bvl_a) + snr_s_a\n                    * (bvl_b - bval[i]) / (bvl_b - bvl_a);\n            }\n            norm[i] = Math.pow(10.0, snr / 10.0);\n\n            /* ATH */\n            x = Float.MAX_VALUE;\n            for (var k = 0; k < gfc.numlines_s[i]; k++, j++) {\n                var freq = sfreq * j / (1000.0 * Encoder.BLKSIZE_s);\n                var level;\n                /* freq = Min(.1,freq); */\n                /*\n                 * ATH below 100 Hz constant, not\n                 * further climbing\n                 */\n                level = this.ATHformula(freq * 1000, gfp) - 20;\n                // scale to FFT units; returned value is in dB\n                level = Math.pow(10., 0.1 * level);\n                // convert from dB . energy\n                level *= gfc.numlines_s[i];\n                if (x > level)\n                    x = level;\n            }\n            gfc.ATH.cb_s[i] = x;\n\n            /*\n             * MINVAL. For low freq, the strength of the masking is limited by\n             * minval this is an ISO MPEG1 thing, dont know if it is really\n             * needed\n             */\n            x = (-7.0 + bval[i] * 7.0 / 12.0);\n            if (bval[i] > 12) {\n                x *= 1 + Math.log(1 + x) * 3.1;\n            }\n            if (bval[i] < 12) {\n                x *= 1 + Math.log(1 - x) * 2.3;\n            }\n            if (x < -15) {\n                x = -15;\n            }\n            x -= 8;\n            gfc.minval_s[i] = Math.pow(10.0, x / 10)\n                * gfc.numlines_s[i];\n        }\n\n        gfc.s3_ss = init_s3_values(gfc.s3ind_s, gfc.npart_s, bval, bval_width,\n            norm, useOldS3);\n\n        init_mask_add_max_values();\n        fft.init_fft(gfc);\n\n        /* setup temporal masking */\n        gfc.decay = Math.exp(-1.0 * LOG10\n            / (temporalmask_sustain_sec * sfreq / 192.0));\n\n        {\n            var msfix;\n            msfix = NS_MSFIX;\n            if ((gfp.exp_nspsytune & 2) != 0)\n                msfix = 1.0;\n            if (Math.abs(gfp.msfix) > 0.0)\n                msfix = gfp.msfix;\n            gfp.msfix = msfix;\n\n            /*\n             * spread only from npart_l bands. Normally, we use the spreading\n             * function to convolve from npart_l down to npart_l bands\n             */\n            for (var b = 0; b < gfc.npart_l; b++)\n                if (gfc.s3ind[b][1] > gfc.npart_l - 1)\n                    gfc.s3ind[b][1] = gfc.npart_l - 1;\n        }\n\n        /*\n         * prepare for ATH auto adjustment: we want to decrease the ATH by 12 dB\n         * per second\n         */\n        var frame_duration = (576. * gfc.mode_gr / sfreq);\n        gfc.ATH.decay = Math.pow(10., -12. / 10. * frame_duration);\n        gfc.ATH.adjust = 0.01;\n        /* minimum, for leading low loudness */\n        gfc.ATH.adjustLimit = 1.0;\n        /* on lead, allow adjust up to maximum */\n\n\n        if (gfp.ATHtype != -1) {\n            /* compute equal loudness weights (eql_w) */\n            var freq;\n            var freq_inc = gfp.out_samplerate\n                / (Encoder.BLKSIZE);\n            var eql_balance = 0.0;\n            freq = 0.0;\n            for (i = 0; i < Encoder.BLKSIZE / 2; ++i) {\n                /* convert ATH dB to relative power (not dB) */\n                /* to determine eql_w */\n                freq += freq_inc;\n                gfc.ATH.eql_w[i] = 1. / Math.pow(10, this.ATHformula(freq, gfp) / 10);\n                eql_balance += gfc.ATH.eql_w[i];\n            }\n            eql_balance = 1.0 / eql_balance;\n            for (i = Encoder.BLKSIZE / 2; --i >= 0;) { /* scale weights */\n                gfc.ATH.eql_w[i] *= eql_balance;\n            }\n        }\n        {\n            for (var b = j = 0; b < gfc.npart_s; ++b) {\n                for (i = 0; i < gfc.numlines_s[b]; ++i) {\n                    ++j;\n                }\n            }\n            for (var b = j = 0; b < gfc.npart_l; ++b) {\n                for (i = 0; i < gfc.numlines_l[b]; ++i) {\n                    ++j;\n                }\n            }\n        }\n        j = 0;\n        for (i = 0; i < gfc.npart_l; i++) {\n            var freq = sfreq * (j + gfc.numlines_l[i] / 2) / (1.0 * Encoder.BLKSIZE);\n            gfc.mld_cb_l[i] = stereo_demask(freq);\n            j += gfc.numlines_l[i];\n        }\n        for (; i < Encoder.CBANDS; ++i) {\n            gfc.mld_cb_l[i] = 1;\n        }\n        j = 0;\n        for (i = 0; i < gfc.npart_s; i++) {\n            var freq = sfreq * (j + gfc.numlines_s[i] / 2) / (1.0 * Encoder.BLKSIZE_s);\n            gfc.mld_cb_s[i] = stereo_demask(freq);\n            j += gfc.numlines_s[i];\n        }\n        for (; i < Encoder.CBANDS; ++i) {\n            gfc.mld_cb_s[i] = 1;\n        }\n        return 0;\n    }\n\n    /**\n     * Those ATH formulas are returning their minimum value for input = -1\n     */\n    function ATHformula_GB(f, value) {\n        /**\n         * <PRE>\n         *  from Painter & Spanias\n         *           modified by Gabriel Bouvigne to better fit the reality\n         *           ath =    3.640 * pow(f,-0.8)\n         *           - 6.800 * exp(-0.6*pow(f-3.4,2.0))\n         *           + 6.000 * exp(-0.15*pow(f-8.7,2.0))\n         *           + 0.6* 0.001 * pow(f,4.0);\n         *\n         *\n         *           In the past LAME was using the Painter &Spanias formula.\n         *           But we had some recurrent problems with HF content.\n         *           We measured real ATH values, and found the older formula\n         *           to be inaccurate in the higher part. So we made this new\n         *           formula and this solved most of HF problematic test cases.\n         *           The tradeoff is that in VBR mode it increases a lot the\n         *           bitrate.\n         * </PRE>\n         */\n\n        /*\n         * This curve can be adjusted according to the VBR scale: it adjusts\n         * from something close to Painter & Spanias on V9 up to Bouvigne's\n         * formula for V0. This way the VBR bitrate is more balanced according\n         * to the -V value.\n         */\n\n        // the following Hack allows to ask for the lowest value\n        if (f < -.3)\n            f = 3410;\n\n        // convert to khz\n        f /= 1000;\n        f = Math.max(0.1, f);\n        var ath = 3.640 * Math.pow(f, -0.8) - 6.800\n            * Math.exp(-0.6 * Math.pow(f - 3.4, 2.0)) + 6.000\n            * Math.exp(-0.15 * Math.pow(f - 8.7, 2.0))\n            + (0.6 + 0.04 * value) * 0.001 * Math.pow(f, 4.0);\n        return ath;\n    }\n\n    this.ATHformula = function (f, gfp) {\n        var ath;\n        switch (gfp.ATHtype) {\n            case 0:\n                ath = ATHformula_GB(f, 9);\n                break;\n            case 1:\n                // over sensitive, should probably be removed\n                ath = ATHformula_GB(f, -1);\n                break;\n            case 2:\n                ath = ATHformula_GB(f, 0);\n                break;\n            case 3:\n                // modification of GB formula by Roel\n                ath = ATHformula_GB(f, 1) + 6;\n                break;\n            case 4:\n                ath = ATHformula_GB(f, gfp.ATHcurve);\n                break;\n            default:\n                ath = ATHformula_GB(f, 0);\n                break;\n        }\n        return ath;\n    }\n\n}\n\n\n\nfunction Lame() {\n    var self = this;\n    var LAME_MAXALBUMART = (128 * 1024);\n\n    Lame.V9 = 410;\n    Lame.V8 = 420;\n    Lame.V7 = 430;\n    Lame.V6 = 440;\n    Lame.V5 = 450;\n    Lame.V4 = 460;\n    Lame.V3 = 470;\n    Lame.V2 = 480;\n    Lame.V1 = 490;\n    Lame.V0 = 500;\n\n    /* still there for compatibility */\n\n    Lame.R3MIX = 1000;\n    Lame.STANDARD = 1001;\n    Lame.EXTREME = 1002;\n    Lame.INSANE = 1003;\n    Lame.STANDARD_FAST = 1004;\n    Lame.EXTREME_FAST = 1005;\n    Lame.MEDIUM = 1006;\n    Lame.MEDIUM_FAST = 1007;\n\n    /**\n     * maximum size of mp3buffer needed if you encode at most 1152 samples for\n     * each call to lame_encode_buffer. see lame_encode_buffer() below\n     * (LAME_MAXMP3BUFFER is now obsolete)\n     */\n    var LAME_MAXMP3BUFFER = (16384 + LAME_MAXALBUMART);\n    Lame.LAME_MAXMP3BUFFER = LAME_MAXMP3BUFFER;\n\n    var ga;\n    var bs;\n    var p;\n    var qupvt;\n    var qu;\n    var psy = new PsyModel();\n    var vbr;\n    var ver;\n    var id3;\n    var mpglib;\n    this.enc = new Encoder();\n\n    this.setModules = function (_ga, _bs, _p, _qupvt, _qu, _vbr, _ver, _id3, _mpglib) {\n        ga = _ga;\n        bs = _bs;\n        p = _p;\n        qupvt = _qupvt;\n        qu = _qu;\n        vbr = _vbr;\n        ver = _ver;\n        id3 = _id3;\n        mpglib = _mpglib;\n        this.enc.setModules(bs, psy, qupvt, vbr);\n    }\n\n    /**\n     * PSY Model related stuff\n     */\n    function PSY() {\n        /**\n         * The dbQ stuff.\n         */\n        this.mask_adjust = 0.;\n        /**\n         * The dbQ stuff.\n         */\n        this.mask_adjust_short = 0.;\n        /* at transition from one scalefactor band to next */\n        /**\n         * Band weight long scalefactor bands.\n         */\n        this.bo_l_weight = new_float(Encoder.SBMAX_l);\n        /**\n         * Band weight short scalefactor bands.\n         */\n        this.bo_s_weight = new_float(Encoder.SBMAX_s);\n    }\n\n    function LowPassHighPass() {\n        this.lowerlimit = 0.;\n    }\n\n    function BandPass(bitrate, lPass) {\n        this.lowpass = lPass;\n    }\n\n    var LAME_ID = 0xFFF88E3B;\n\n    function lame_init_old(gfp) {\n        var gfc;\n\n        gfp.class_id = LAME_ID;\n\n        gfc = gfp.internal_flags = new LameInternalFlags();\n\n        /* Global flags. set defaults here for non-zero values */\n        /* see lame.h for description */\n        /*\n         * set integer values to -1 to mean that LAME will compute the best\n         * value, UNLESS the calling program as set it (and the value is no\n         * longer -1)\n         */\n\n        gfp.mode = MPEGMode.NOT_SET;\n        gfp.original = 1;\n        gfp.in_samplerate = 44100;\n        gfp.num_channels = 2;\n        gfp.num_samples = -1;\n\n        gfp.bWriteVbrTag = true;\n        gfp.quality = -1;\n        gfp.short_blocks = null;\n        gfc.subblock_gain = -1;\n\n        gfp.lowpassfreq = 0;\n        gfp.highpassfreq = 0;\n        gfp.lowpasswidth = -1;\n        gfp.highpasswidth = -1;\n\n        gfp.VBR = VbrMode.vbr_off;\n        gfp.VBR_q = 4;\n        gfp.ATHcurve = -1;\n        gfp.VBR_mean_bitrate_kbps = 128;\n        gfp.VBR_min_bitrate_kbps = 0;\n        gfp.VBR_max_bitrate_kbps = 0;\n        gfp.VBR_hard_min = 0;\n        gfc.VBR_min_bitrate = 1;\n        /* not 0 ????? */\n        gfc.VBR_max_bitrate = 13;\n        /* not 14 ????? */\n\n        gfp.quant_comp = -1;\n        gfp.quant_comp_short = -1;\n\n        gfp.msfix = -1;\n\n        gfc.resample_ratio = 1;\n\n        gfc.OldValue[0] = 180;\n        gfc.OldValue[1] = 180;\n        gfc.CurrentStep[0] = 4;\n        gfc.CurrentStep[1] = 4;\n        gfc.masking_lower = 1;\n        gfc.nsPsy.attackthre = -1;\n        gfc.nsPsy.attackthre_s = -1;\n\n        gfp.scale = -1;\n\n        gfp.athaa_type = -1;\n        gfp.ATHtype = -1;\n        /* default = -1 = set in lame_init_params */\n        gfp.athaa_loudapprox = -1;\n        /* 1 = flat loudness approx. (total energy) */\n        /* 2 = equal loudness curve */\n        gfp.athaa_sensitivity = 0.0;\n        /* no offset */\n        gfp.useTemporal = null;\n        gfp.interChRatio = -1;\n\n        /*\n         * The reason for int mf_samples_to_encode = ENCDELAY + POSTDELAY;\n         * ENCDELAY = internal encoder delay. And then we have to add\n         * POSTDELAY=288 because of the 50% MDCT overlap. A 576 MDCT granule\n         * decodes to 1152 samples. To synthesize the 576 samples centered under\n         * this granule we need the previous granule for the first 288 samples\n         * (no problem), and the next granule for the next 288 samples (not\n         * possible if this is last granule). So we need to pad with 288 samples\n         * to make sure we can encode the 576 samples we are interested in.\n         */\n        gfc.mf_samples_to_encode = Encoder.ENCDELAY + Encoder.POSTDELAY;\n        gfp.encoder_padding = 0;\n        gfc.mf_size = Encoder.ENCDELAY - Encoder.MDCTDELAY;\n        /*\n         * we pad input with this many 0's\n         */\n\n        gfp.findReplayGain = false;\n        gfp.decode_on_the_fly = false;\n\n        gfc.decode_on_the_fly = false;\n        gfc.findReplayGain = false;\n        gfc.findPeakSample = false;\n\n        gfc.RadioGain = 0;\n        gfc.AudiophileGain = 0;\n        gfc.noclipGainChange = 0;\n        gfc.noclipScale = -1.0;\n\n        gfp.preset = 0;\n\n        gfp.write_id3tag_automatic = true;\n        return 0;\n    }\n\n    this.lame_init = function () {\n        var gfp = new LameGlobalFlags();\n\n        var ret = lame_init_old(gfp);\n        if (ret != 0) {\n            return null;\n        }\n\n        gfp.lame_allocated_gfp = 1;\n        return gfp;\n    }\n\n    function filter_coef(x) {\n        if (x > 1.0)\n            return 0.0;\n        if (x <= 0.0)\n            return 1.0;\n\n        return Math.cos(Math.PI / 2 * x);\n    }\n\n    this.nearestBitrateFullIndex = function (bitrate) {\n        /* borrowed from DM abr presets */\n\n        var full_bitrate_table = [8, 16, 24, 32, 40, 48, 56, 64, 80,\n            96, 112, 128, 160, 192, 224, 256, 320];\n\n        var lower_range = 0, lower_range_kbps = 0, upper_range = 0, upper_range_kbps = 0;\n\n        /* We assume specified bitrate will be 320kbps */\n        upper_range_kbps = full_bitrate_table[16];\n        upper_range = 16;\n        lower_range_kbps = full_bitrate_table[16];\n        lower_range = 16;\n\n        /*\n         * Determine which significant bitrates the value specified falls\n         * between, if loop ends without breaking then we were correct above\n         * that the value was 320\n         */\n        for (var b = 0; b < 16; b++) {\n            if ((Math.max(bitrate, full_bitrate_table[b + 1])) != bitrate) {\n                upper_range_kbps = full_bitrate_table[b + 1];\n                upper_range = b + 1;\n                lower_range_kbps = full_bitrate_table[b];\n                lower_range = (b);\n                break;\n                /* We found upper range */\n            }\n        }\n\n        /* Determine which range the value specified is closer to */\n        if ((upper_range_kbps - bitrate) > (bitrate - lower_range_kbps)) {\n            return lower_range;\n        }\n        return upper_range;\n    }\n\n    function optimum_samplefreq(lowpassfreq, input_samplefreq) {\n        /*\n         * Rules:\n         *\n         * - if possible, sfb21 should NOT be used\n         */\n        var suggested_samplefreq = 44100;\n\n        if (input_samplefreq >= 48000)\n            suggested_samplefreq = 48000;\n        else if (input_samplefreq >= 44100)\n            suggested_samplefreq = 44100;\n        else if (input_samplefreq >= 32000)\n            suggested_samplefreq = 32000;\n        else if (input_samplefreq >= 24000)\n            suggested_samplefreq = 24000;\n        else if (input_samplefreq >= 22050)\n            suggested_samplefreq = 22050;\n        else if (input_samplefreq >= 16000)\n            suggested_samplefreq = 16000;\n        else if (input_samplefreq >= 12000)\n            suggested_samplefreq = 12000;\n        else if (input_samplefreq >= 11025)\n            suggested_samplefreq = 11025;\n        else if (input_samplefreq >= 8000)\n            suggested_samplefreq = 8000;\n\n        if (lowpassfreq == -1)\n            return suggested_samplefreq;\n\n        if (lowpassfreq <= 15960)\n            suggested_samplefreq = 44100;\n        if (lowpassfreq <= 15250)\n            suggested_samplefreq = 32000;\n        if (lowpassfreq <= 11220)\n            suggested_samplefreq = 24000;\n        if (lowpassfreq <= 9970)\n            suggested_samplefreq = 22050;\n        if (lowpassfreq <= 7230)\n            suggested_samplefreq = 16000;\n        if (lowpassfreq <= 5420)\n            suggested_samplefreq = 12000;\n        if (lowpassfreq <= 4510)\n            suggested_samplefreq = 11025;\n        if (lowpassfreq <= 3970)\n            suggested_samplefreq = 8000;\n\n        if (input_samplefreq < suggested_samplefreq) {\n            /*\n             * choose a valid MPEG sample frequency above the input sample\n             * frequency to avoid SFB21/12 bitrate bloat rh 061115\n             */\n            if (input_samplefreq > 44100) {\n                return 48000;\n            }\n            if (input_samplefreq > 32000) {\n                return 44100;\n            }\n            if (input_samplefreq > 24000) {\n                return 32000;\n            }\n            if (input_samplefreq > 22050) {\n                return 24000;\n            }\n            if (input_samplefreq > 16000) {\n                return 22050;\n            }\n            if (input_samplefreq > 12000) {\n                return 16000;\n            }\n            if (input_samplefreq > 11025) {\n                return 12000;\n            }\n            if (input_samplefreq > 8000) {\n                return 11025;\n            }\n            return 8000;\n        }\n        return suggested_samplefreq;\n    }\n\n    /**\n     * convert samp freq in Hz to index\n     */\n    function SmpFrqIndex(sample_freq, gpf) {\n        switch (sample_freq) {\n            case 44100:\n                gpf.version = 1;\n                return 0;\n            case 48000:\n                gpf.version = 1;\n                return 1;\n            case 32000:\n                gpf.version = 1;\n                return 2;\n            case 22050:\n                gpf.version = 0;\n                return 0;\n            case 24000:\n                gpf.version = 0;\n                return 1;\n            case 16000:\n                gpf.version = 0;\n                return 2;\n            case 11025:\n                gpf.version = 0;\n                return 0;\n            case 12000:\n                gpf.version = 0;\n                return 1;\n            case 8000:\n                gpf.version = 0;\n                return 2;\n            default:\n                gpf.version = 0;\n                return -1;\n        }\n    }\n\n    /**\n     * @param bRate\n     *            legal rates from 8 to 320\n     */\n    function FindNearestBitrate(bRate, version, samplerate) {\n        /* MPEG-1 or MPEG-2 LSF */\n        if (samplerate < 16000)\n            version = 2;\n\n        var bitrate = Tables.bitrate_table[version][1];\n\n        for (var i = 2; i <= 14; i++) {\n            if (Tables.bitrate_table[version][i] > 0) {\n                if (Math.abs(Tables.bitrate_table[version][i] - bRate) < Math\n                        .abs(bitrate - bRate))\n                    bitrate = Tables.bitrate_table[version][i];\n            }\n        }\n        return bitrate;\n    }\n\n    /**\n     * @param bRate\n     *            legal rates from 32 to 448 kbps\n     * @param version\n     *            MPEG-1 or MPEG-2/2.5 LSF\n     */\n    function BitrateIndex(bRate, version, samplerate) {\n        /* convert bitrate in kbps to index */\n        if (samplerate < 16000)\n            version = 2;\n        for (var i = 0; i <= 14; i++) {\n            if (Tables.bitrate_table[version][i] > 0) {\n                if (Tables.bitrate_table[version][i] == bRate) {\n                    return i;\n                }\n            }\n        }\n        return -1;\n    }\n\n    function optimum_bandwidth(lh, bitrate) {\n        /**\n         * <PRE>\n         *  Input:\n         *      bitrate     total bitrate in kbps\n         *\n         *   Output:\n         *      lowerlimit: best lowpass frequency limit for input filter in Hz\n         *      upperlimit: best highpass frequency limit for input filter in Hz\n         * </PRE>\n         */\n        var freq_map = [new BandPass(8, 2000),\n            new BandPass(16, 3700), new BandPass(24, 3900),\n            new BandPass(32, 5500), new BandPass(40, 7000),\n            new BandPass(48, 7500), new BandPass(56, 10000),\n            new BandPass(64, 11000), new BandPass(80, 13500),\n            new BandPass(96, 15100), new BandPass(112, 15600),\n            new BandPass(128, 17000), new BandPass(160, 17500),\n            new BandPass(192, 18600), new BandPass(224, 19400),\n            new BandPass(256, 19700), new BandPass(320, 20500)];\n\n        var table_index = self.nearestBitrateFullIndex(bitrate);\n        lh.lowerlimit = freq_map[table_index].lowpass;\n    }\n\n    function lame_init_params_ppflt(gfp) {\n        var gfc = gfp.internal_flags;\n        /***************************************************************/\n        /* compute info needed for polyphase filter (filter type==0, default) */\n        /***************************************************************/\n\n        var lowpass_band = 32;\n        var highpass_band = -1;\n\n        if (gfc.lowpass1 > 0) {\n            var minband = 999;\n            for (var band = 0; band <= 31; band++) {\n                var freq = (band / 31.0);\n                /* this band and above will be zeroed: */\n                if (freq >= gfc.lowpass2) {\n                    lowpass_band = Math.min(lowpass_band, band);\n                }\n                if (gfc.lowpass1 < freq && freq < gfc.lowpass2) {\n                    minband = Math.min(minband, band);\n                }\n            }\n\n            /*\n             * compute the *actual* transition band implemented by the polyphase\n             * filter\n             */\n            if (minband == 999) {\n                gfc.lowpass1 = (lowpass_band - .75) / 31.0;\n            } else {\n                gfc.lowpass1 = (minband - .75) / 31.0;\n            }\n            gfc.lowpass2 = lowpass_band / 31.0;\n        }\n\n        /*\n         * make sure highpass filter is within 90% of what the effective\n         * highpass frequency will be\n         */\n        if (gfc.highpass2 > 0) {\n            if (gfc.highpass2 < .9 * (.75 / 31.0)) {\n                gfc.highpass1 = 0;\n                gfc.highpass2 = 0;\n                System.err.println(\"Warning: highpass filter disabled.  \"\n                    + \"highpass frequency too small\\n\");\n            }\n        }\n\n        if (gfc.highpass2 > 0) {\n            var maxband = -1;\n            for (var band = 0; band <= 31; band++) {\n                var freq = band / 31.0;\n                /* this band and below will be zereod */\n                if (freq <= gfc.highpass1) {\n                    highpass_band = Math.max(highpass_band, band);\n                }\n                if (gfc.highpass1 < freq && freq < gfc.highpass2) {\n                    maxband = Math.max(maxband, band);\n                }\n            }\n            /*\n             * compute the *actual* transition band implemented by the polyphase\n             * filter\n             */\n            gfc.highpass1 = highpass_band / 31.0;\n            if (maxband == -1) {\n                gfc.highpass2 = (highpass_band + .75) / 31.0;\n            } else {\n                gfc.highpass2 = (maxband + .75) / 31.0;\n            }\n        }\n\n        for (var band = 0; band < 32; band++) {\n            var fc1, fc2;\n            var freq = band / 31.0;\n            if (gfc.highpass2 > gfc.highpass1) {\n                fc1 = filter_coef((gfc.highpass2 - freq)\n                    / (gfc.highpass2 - gfc.highpass1 + 1e-20));\n            } else {\n                fc1 = 1.0;\n            }\n            if (gfc.lowpass2 > gfc.lowpass1) {\n                fc2 = filter_coef((freq - gfc.lowpass1)\n                    / (gfc.lowpass2 - gfc.lowpass1 + 1e-20));\n            } else {\n                fc2 = 1.0;\n            }\n            gfc.amp_filter[band] = (fc1 * fc2);\n        }\n    }\n\n    function lame_init_qval(gfp) {\n        var gfc = gfp.internal_flags;\n\n        switch (gfp.quality) {\n            default:\n            case 9: /* no psymodel, no noise shaping */\n                gfc.psymodel = 0;\n                gfc.noise_shaping = 0;\n                gfc.noise_shaping_amp = 0;\n                gfc.noise_shaping_stop = 0;\n                gfc.use_best_huffman = 0;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 8:\n                gfp.quality = 7;\n            //$FALL-THROUGH$\n            case 7:\n                /*\n                 * use psymodel (for short block and m/s switching), but no noise\n                 * shapping\n                 */\n                gfc.psymodel = 1;\n                gfc.noise_shaping = 0;\n                gfc.noise_shaping_amp = 0;\n                gfc.noise_shaping_stop = 0;\n                gfc.use_best_huffman = 0;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 6:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                gfc.noise_shaping_amp = 0;\n                gfc.noise_shaping_stop = 0;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 0;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 5:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                gfc.noise_shaping_amp = 0;\n                gfc.noise_shaping_stop = 0;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 0;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 4:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                gfc.noise_shaping_amp = 0;\n                gfc.noise_shaping_stop = 0;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 1;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 3:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                gfc.noise_shaping_amp = 1;\n                gfc.noise_shaping_stop = 1;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 1;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 2:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                if (gfc.substep_shaping == 0)\n                    gfc.substep_shaping = 2;\n                gfc.noise_shaping_amp = 1;\n                gfc.noise_shaping_stop = 1;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 1;\n                /* inner loop */\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 1:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                if (gfc.substep_shaping == 0)\n                    gfc.substep_shaping = 2;\n                gfc.noise_shaping_amp = 2;\n                gfc.noise_shaping_stop = 1;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 1;\n                gfc.full_outer_loop = 0;\n                break;\n\n            case 0:\n                gfc.psymodel = 1;\n                if (gfc.noise_shaping == 0)\n                    gfc.noise_shaping = 1;\n                if (gfc.substep_shaping == 0)\n                    gfc.substep_shaping = 2;\n                gfc.noise_shaping_amp = 2;\n                gfc.noise_shaping_stop = 1;\n                if (gfc.subblock_gain == -1)\n                    gfc.subblock_gain = 1;\n                gfc.use_best_huffman = 1;\n                /*\n                 * type 2 disabled because of it slowness, in favor of full outer\n                 * loop search\n                 */\n                gfc.full_outer_loop = 0;\n                /*\n                 * full outer loop search disabled because of audible distortions it\n                 * may generate rh 060629\n                 */\n                break;\n        }\n\n    }\n\n    function lame_init_bitstream(gfp) {\n        var gfc = gfp.internal_flags;\n        gfp.frameNum = 0;\n\n        if (gfp.write_id3tag_automatic) {\n            id3.id3tag_write_v2(gfp);\n        }\n        /* initialize histogram data optionally used by frontend */\n\n        gfc.bitrate_stereoMode_Hist = new_int_n([16, 4 + 1]);\n        gfc.bitrate_blockType_Hist = new_int_n([16, 4 + 1 + 1]);\n\n        gfc.PeakSample = 0.0;\n\n        /* Write initial VBR Header to bitstream and init VBR data */\n        if (gfp.bWriteVbrTag)\n            vbr.InitVbrTag(gfp);\n    }\n\n    /********************************************************************\n     * initialize internal params based on data in gf (globalflags struct filled\n     * in by calling program)\n     *\n     * OUTLINE:\n     *\n     * We first have some complex code to determine bitrate, output samplerate\n     * and mode. It is complicated by the fact that we allow the user to set\n     * some or all of these parameters, and need to determine best possible\n     * values for the rest of them:\n     *\n     * 1. set some CPU related flags 2. check if we are mono.mono, stereo.mono\n     * or stereo.stereo 3. compute bitrate and output samplerate: user may have\n     * set compression ratio user may have set a bitrate user may have set a\n     * output samplerate 4. set some options which depend on output samplerate\n     * 5. compute the actual compression ratio 6. set mode based on compression\n     * ratio\n     *\n     * The remaining code is much simpler - it just sets options based on the\n     * mode & compression ratio:\n     *\n     * set allow_diff_short based on mode select lowpass filter based on\n     * compression ratio & mode set the bitrate index, and min/max bitrates for\n     * VBR modes disable VBR tag if it is not appropriate initialize the\n     * bitstream initialize scalefac_band data set sideinfo_len (based on\n     * channels, CRC, out_samplerate) write an id3v2 tag into the bitstream\n     * write VBR tag into the bitstream set mpeg1/2 flag estimate the number of\n     * frames (based on a lot of data)\n     *\n     * now we set more flags: nspsytune: see code VBR modes see code CBR/ABR see\n     * code\n     *\n     * Finally, we set the algorithm flags based on the gfp.quality value\n     * lame_init_qval(gfp);\n     *\n     ********************************************************************/\n    this.lame_init_params = function (gfp) {\n        var gfc = gfp.internal_flags;\n\n        gfc.Class_ID = 0;\n        if (gfc.ATH == null)\n            gfc.ATH = new ATH();\n        if (gfc.PSY == null)\n            gfc.PSY = new PSY();\n        if (gfc.rgdata == null)\n            gfc.rgdata = new ReplayGain();\n\n        gfc.channels_in = gfp.num_channels;\n        if (gfc.channels_in == 1)\n            gfp.mode = MPEGMode.MONO;\n        gfc.channels_out = (gfp.mode == MPEGMode.MONO) ? 1 : 2;\n        gfc.mode_ext = Encoder.MPG_MD_MS_LR;\n        if (gfp.mode == MPEGMode.MONO)\n            gfp.force_ms = false;\n        /*\n         * don't allow forced mid/side stereo for mono output\n         */\n\n        if (gfp.VBR == VbrMode.vbr_off && gfp.VBR_mean_bitrate_kbps != 128\n            && gfp.brate == 0)\n            gfp.brate = gfp.VBR_mean_bitrate_kbps;\n\n        if (gfp.VBR == VbrMode.vbr_off || gfp.VBR == VbrMode.vbr_mtrh\n            || gfp.VBR == VbrMode.vbr_mt) {\n            /* these modes can handle free format condition */\n        } else {\n            gfp.free_format = false;\n            /* mode can't be mixed with free format */\n        }\n\n        if (gfp.VBR == VbrMode.vbr_off && gfp.brate == 0) {\n            /* no bitrate or compression ratio specified, use 11.025 */\n            if (BitStream.EQ(gfp.compression_ratio, 0))\n                gfp.compression_ratio = 11.025;\n            /*\n             * rate to compress a CD down to exactly 128000 bps\n             */\n        }\n\n        /* find bitrate if user specify a compression ratio */\n        if (gfp.VBR == VbrMode.vbr_off && gfp.compression_ratio > 0) {\n\n            if (gfp.out_samplerate == 0)\n                gfp.out_samplerate = map2MP3Frequency((int)(0.97 * gfp.in_samplerate));\n            /*\n             * round up with a margin of 3 %\n             */\n\n            /*\n             * choose a bitrate for the output samplerate which achieves\n             * specified compression ratio\n             */\n            gfp.brate = 0 | (gfp.out_samplerate * 16 * gfc.channels_out / (1.e3 * gfp.compression_ratio));\n\n            /* we need the version for the bitrate table look up */\n            gfc.samplerate_index = SmpFrqIndex(gfp.out_samplerate, gfp);\n\n            if (!gfp.free_format) /*\n             * for non Free Format find the nearest allowed\n             * bitrate\n             */\n                gfp.brate = FindNearestBitrate(gfp.brate, gfp.version,\n                    gfp.out_samplerate);\n        }\n\n        if (gfp.out_samplerate != 0) {\n            if (gfp.out_samplerate < 16000) {\n                gfp.VBR_mean_bitrate_kbps = Math.max(gfp.VBR_mean_bitrate_kbps,\n                    8);\n                gfp.VBR_mean_bitrate_kbps = Math.min(gfp.VBR_mean_bitrate_kbps,\n                    64);\n            } else if (gfp.out_samplerate < 32000) {\n                gfp.VBR_mean_bitrate_kbps = Math.max(gfp.VBR_mean_bitrate_kbps,\n                    8);\n                gfp.VBR_mean_bitrate_kbps = Math.min(gfp.VBR_mean_bitrate_kbps,\n                    160);\n            } else {\n                gfp.VBR_mean_bitrate_kbps = Math.max(gfp.VBR_mean_bitrate_kbps,\n                    32);\n                gfp.VBR_mean_bitrate_kbps = Math.min(gfp.VBR_mean_bitrate_kbps,\n                    320);\n            }\n        }\n\n        /****************************************************************/\n        /* if a filter has not been enabled, see if we should add one: */\n        /****************************************************************/\n        if (gfp.lowpassfreq == 0) {\n            var lowpass = 16000.;\n\n            switch (gfp.VBR) {\n                case VbrMode.vbr_off:\n                {\n                    var lh = new LowPassHighPass();\n                    optimum_bandwidth(lh, gfp.brate);\n                    lowpass = lh.lowerlimit;\n                    break;\n                }\n                case VbrMode.vbr_abr:\n                {\n                    var lh = new LowPassHighPass();\n                    optimum_bandwidth(lh, gfp.VBR_mean_bitrate_kbps);\n                    lowpass = lh.lowerlimit;\n                    break;\n                }\n                case VbrMode.vbr_rh:\n                {\n                    var x = [19500, 19000, 18600, 18000, 17500, 16000,\n                        15600, 14900, 12500, 10000, 3950];\n                    if (0 <= gfp.VBR_q && gfp.VBR_q <= 9) {\n                        var a = x[gfp.VBR_q], b = x[gfp.VBR_q + 1], m = gfp.VBR_q_frac;\n                        lowpass = linear_int(a, b, m);\n                    } else {\n                        lowpass = 19500;\n                    }\n                    break;\n                }\n                default:\n                {\n                    var x = [19500, 19000, 18500, 18000, 17500, 16500,\n                        15500, 14500, 12500, 9500, 3950];\n                    if (0 <= gfp.VBR_q && gfp.VBR_q <= 9) {\n                        var a = x[gfp.VBR_q], b = x[gfp.VBR_q + 1], m = gfp.VBR_q_frac;\n                        lowpass = linear_int(a, b, m);\n                    } else {\n                        lowpass = 19500;\n                    }\n                }\n            }\n            if (gfp.mode == MPEGMode.MONO\n                && (gfp.VBR == VbrMode.vbr_off || gfp.VBR == VbrMode.vbr_abr))\n                lowpass *= 1.5;\n\n            gfp.lowpassfreq = lowpass | 0;\n        }\n\n        if (gfp.out_samplerate == 0) {\n            if (2 * gfp.lowpassfreq > gfp.in_samplerate) {\n                gfp.lowpassfreq = gfp.in_samplerate / 2;\n            }\n            gfp.out_samplerate = optimum_samplefreq(gfp.lowpassfreq | 0,\n                gfp.in_samplerate);\n        }\n\n        gfp.lowpassfreq = Math.min(20500, gfp.lowpassfreq);\n        gfp.lowpassfreq = Math.min(gfp.out_samplerate / 2, gfp.lowpassfreq);\n\n        if (gfp.VBR == VbrMode.vbr_off) {\n            gfp.compression_ratio = gfp.out_samplerate * 16 * gfc.channels_out\n                / (1.e3 * gfp.brate);\n        }\n        if (gfp.VBR == VbrMode.vbr_abr) {\n            gfp.compression_ratio = gfp.out_samplerate * 16 * gfc.channels_out\n                / (1.e3 * gfp.VBR_mean_bitrate_kbps);\n        }\n\n        /*\n         * do not compute ReplayGain values and do not find the peak sample if\n         * we can't store them\n         */\n        if (!gfp.bWriteVbrTag) {\n            gfp.findReplayGain = false;\n            gfp.decode_on_the_fly = false;\n            gfc.findPeakSample = false;\n        }\n        gfc.findReplayGain = gfp.findReplayGain;\n        gfc.decode_on_the_fly = gfp.decode_on_the_fly;\n\n        if (gfc.decode_on_the_fly)\n            gfc.findPeakSample = true;\n\n        if (gfc.findReplayGain) {\n            if (ga.InitGainAnalysis(gfc.rgdata, gfp.out_samplerate) == GainAnalysis.INIT_GAIN_ANALYSIS_ERROR) {\n                gfp.internal_flags = null;\n                return -6;\n            }\n        }\n\n        if (gfc.decode_on_the_fly && !gfp.decode_only) {\n            if (gfc.hip != null) {\n                mpglib.hip_decode_exit(gfc.hip);\n            }\n            gfc.hip = mpglib.hip_decode_init();\n        }\n\n        gfc.mode_gr = gfp.out_samplerate <= 24000 ? 1 : 2;\n        /*\n         * Number of granules per frame\n         */\n        gfp.framesize = 576 * gfc.mode_gr;\n        gfp.encoder_delay = Encoder.ENCDELAY;\n\n        gfc.resample_ratio = gfp.in_samplerate / gfp.out_samplerate;\n\n        /**\n         * <PRE>\n         *  sample freq       bitrate     compression ratio\n         *     [kHz]      [kbps/channel]   for 16 bit input\n         *     44.1            56               12.6\n         *     44.1            64               11.025\n         *     44.1            80                8.82\n         *     22.05           24               14.7\n         *     22.05           32               11.025\n         *     22.05           40                8.82\n         *     16              16               16.0\n         *     16              24               10.667\n         * </PRE>\n         */\n        /**\n         * <PRE>\n         *  For VBR, take a guess at the compression_ratio.\n         *  For example:\n         *\n         *    VBR_q    compression     like\n         *     -        4.4         320 kbps/44 kHz\n         *   0...1      5.5         256 kbps/44 kHz\n         *     2        7.3         192 kbps/44 kHz\n         *     4        8.8         160 kbps/44 kHz\n         *     6       11           128 kbps/44 kHz\n         *     9       14.7          96 kbps\n         *\n         *  for lower bitrates, downsample with --resample\n         * </PRE>\n         */\n        switch (gfp.VBR) {\n            case VbrMode.vbr_mt:\n            case VbrMode.vbr_rh:\n            case VbrMode.vbr_mtrh:\n            {\n                /* numbers are a bit strange, but they determine the lowpass value */\n                var cmp = [5.7, 6.5, 7.3, 8.2, 10, 11.9, 13, 14,\n                    15, 16.5];\n                gfp.compression_ratio = cmp[gfp.VBR_q];\n            }\n                break;\n            case VbrMode.vbr_abr:\n                gfp.compression_ratio = gfp.out_samplerate * 16 * gfc.channels_out\n                    / (1.e3 * gfp.VBR_mean_bitrate_kbps);\n                break;\n            default:\n                gfp.compression_ratio = gfp.out_samplerate * 16 * gfc.channels_out\n                    / (1.e3 * gfp.brate);\n                break;\n        }\n\n        /*\n         * mode = -1 (not set by user) or mode = MONO (because of only 1 input\n         * channel). If mode has not been set, then select J-STEREO\n         */\n        if (gfp.mode == MPEGMode.NOT_SET) {\n            gfp.mode = MPEGMode.JOINT_STEREO;\n        }\n\n        /* apply user driven high pass filter */\n        if (gfp.highpassfreq > 0) {\n            gfc.highpass1 = 2. * gfp.highpassfreq;\n\n            if (gfp.highpasswidth >= 0)\n                gfc.highpass2 = 2. * (gfp.highpassfreq + gfp.highpasswidth);\n            else\n            /* 0% above on default */\n                gfc.highpass2 = (1 + 0.00) * 2. * gfp.highpassfreq;\n\n            gfc.highpass1 /= gfp.out_samplerate;\n            gfc.highpass2 /= gfp.out_samplerate;\n        } else {\n            gfc.highpass1 = 0;\n            gfc.highpass2 = 0;\n        }\n        /* apply user driven low pass filter */\n        if (gfp.lowpassfreq > 0) {\n            gfc.lowpass2 = 2. * gfp.lowpassfreq;\n            if (gfp.lowpasswidth >= 0) {\n                gfc.lowpass1 = 2. * (gfp.lowpassfreq - gfp.lowpasswidth);\n                if (gfc.lowpass1 < 0) /* has to be >= 0 */\n                    gfc.lowpass1 = 0;\n            } else { /* 0% below on default */\n                gfc.lowpass1 = (1 - 0.00) * 2. * gfp.lowpassfreq;\n            }\n            gfc.lowpass1 /= gfp.out_samplerate;\n            gfc.lowpass2 /= gfp.out_samplerate;\n        } else {\n            gfc.lowpass1 = 0;\n            gfc.lowpass2 = 0;\n        }\n\n        /**********************************************************************/\n        /* compute info needed for polyphase filter (filter type==0, default) */\n        /**********************************************************************/\n        lame_init_params_ppflt(gfp);\n        /*******************************************************\n         * samplerate and bitrate index\n         *******************************************************/\n        gfc.samplerate_index = SmpFrqIndex(gfp.out_samplerate, gfp);\n        if (gfc.samplerate_index < 0) {\n            gfp.internal_flags = null;\n            return -1;\n        }\n\n        if (gfp.VBR == VbrMode.vbr_off) {\n            if (gfp.free_format) {\n                gfc.bitrate_index = 0;\n            } else {\n                gfp.brate = FindNearestBitrate(gfp.brate, gfp.version,\n                    gfp.out_samplerate);\n                gfc.bitrate_index = BitrateIndex(gfp.brate, gfp.version,\n                    gfp.out_samplerate);\n                if (gfc.bitrate_index <= 0) {\n                    gfp.internal_flags = null;\n                    return -1;\n                }\n            }\n        } else {\n            gfc.bitrate_index = 1;\n        }\n\n        /* for CBR, we will write an \"info\" tag. */\n\n        if (gfp.analysis)\n            gfp.bWriteVbrTag = false;\n\n        /* some file options not allowed if output is: not specified or stdout */\n        if (gfc.pinfo != null)\n            gfp.bWriteVbrTag = false;\n        /* disable Xing VBR tag */\n\n        bs.init_bit_stream_w(gfc);\n\n        var j = gfc.samplerate_index + (3 * gfp.version) + 6\n            * (gfp.out_samplerate < 16000 ? 1 : 0);\n        for (var i = 0; i < Encoder.SBMAX_l + 1; i++)\n            gfc.scalefac_band.l[i] = qupvt.sfBandIndex[j].l[i];\n\n        for (var i = 0; i < Encoder.PSFB21 + 1; i++) {\n            var size = (gfc.scalefac_band.l[22] - gfc.scalefac_band.l[21])\n                / Encoder.PSFB21;\n            var start = gfc.scalefac_band.l[21] + i * size;\n            gfc.scalefac_band.psfb21[i] = start;\n        }\n        gfc.scalefac_band.psfb21[Encoder.PSFB21] = 576;\n\n        for (var i = 0; i < Encoder.SBMAX_s + 1; i++)\n            gfc.scalefac_band.s[i] = qupvt.sfBandIndex[j].s[i];\n\n        for (var i = 0; i < Encoder.PSFB12 + 1; i++) {\n            var size = (gfc.scalefac_band.s[13] - gfc.scalefac_band.s[12])\n                / Encoder.PSFB12;\n            var start = gfc.scalefac_band.s[12] + i * size;\n            gfc.scalefac_band.psfb12[i] = start;\n        }\n        gfc.scalefac_band.psfb12[Encoder.PSFB12] = 192;\n        /* determine the mean bitrate for main data */\n        if (gfp.version == 1) /* MPEG 1 */\n            gfc.sideinfo_len = (gfc.channels_out == 1) ? 4 + 17 : 4 + 32;\n        else\n        /* MPEG 2 */\n            gfc.sideinfo_len = (gfc.channels_out == 1) ? 4 + 9 : 4 + 17;\n\n        if (gfp.error_protection)\n            gfc.sideinfo_len += 2;\n\n        lame_init_bitstream(gfp);\n\n        gfc.Class_ID = LAME_ID;\n\n        {\n            var k;\n\n            for (k = 0; k < 19; k++)\n                gfc.nsPsy.pefirbuf[k] = 700 * gfc.mode_gr * gfc.channels_out;\n\n            if (gfp.ATHtype == -1)\n                gfp.ATHtype = 4;\n        }\n\n        switch (gfp.VBR) {\n\n            case VbrMode.vbr_mt:\n                gfp.VBR = VbrMode.vbr_mtrh;\n            //$FALL-THROUGH$\n            case VbrMode.vbr_mtrh:\n            {\n                if (gfp.useTemporal == null) {\n                    gfp.useTemporal = false;\n                    /* off by default for this VBR mode */\n                }\n\n                p.apply_preset(gfp, 500 - (gfp.VBR_q * 10), 0);\n                /**\n                 * <PRE>\n                 *   The newer VBR code supports only a limited\n                 *     subset of quality levels:\n                 *     9-5=5 are the same, uses x^3/4 quantization\n                 *   4-0=0 are the same  5 plus best huffman divide code\n                 * </PRE>\n                 */\n                if (gfp.quality < 0)\n                    gfp.quality = LAME_DEFAULT_QUALITY;\n                if (gfp.quality < 5)\n                    gfp.quality = 0;\n                if (gfp.quality > 5)\n                    gfp.quality = 5;\n\n                gfc.PSY.mask_adjust = gfp.maskingadjust;\n                gfc.PSY.mask_adjust_short = gfp.maskingadjust_short;\n\n                /*\n                 * sfb21 extra only with MPEG-1 at higher sampling rates\n                 */\n                if (gfp.experimentalY)\n                    gfc.sfb21_extra = false;\n                else\n                    gfc.sfb21_extra = (gfp.out_samplerate > 44000);\n\n                gfc.iteration_loop = new VBRNewIterationLoop(qu);\n                break;\n\n            }\n            case VbrMode.vbr_rh:\n            {\n\n                p.apply_preset(gfp, 500 - (gfp.VBR_q * 10), 0);\n\n                gfc.PSY.mask_adjust = gfp.maskingadjust;\n                gfc.PSY.mask_adjust_short = gfp.maskingadjust_short;\n\n                /*\n                 * sfb21 extra only with MPEG-1 at higher sampling rates\n                 */\n                if (gfp.experimentalY)\n                    gfc.sfb21_extra = false;\n                else\n                    gfc.sfb21_extra = (gfp.out_samplerate > 44000);\n\n                /*\n                 * VBR needs at least the output of GPSYCHO, so we have to garantee\n                 * that by setting a minimum quality level, actually level 6 does\n                 * it. down to level 6\n                 */\n                if (gfp.quality > 6)\n                    gfp.quality = 6;\n\n                if (gfp.quality < 0)\n                    gfp.quality = LAME_DEFAULT_QUALITY;\n\n                gfc.iteration_loop = new VBROldIterationLoop(qu);\n                break;\n            }\n\n            default: /* cbr/abr */\n            {\n                var vbrmode;\n\n                /*\n                 * no sfb21 extra with CBR code\n                 */\n                gfc.sfb21_extra = false;\n\n                if (gfp.quality < 0)\n                    gfp.quality = LAME_DEFAULT_QUALITY;\n\n                vbrmode = gfp.VBR;\n                if (vbrmode == VbrMode.vbr_off)\n                    gfp.VBR_mean_bitrate_kbps = gfp.brate;\n                /* second, set parameters depending on bitrate */\n                p.apply_preset(gfp, gfp.VBR_mean_bitrate_kbps, 0);\n                gfp.VBR = vbrmode;\n\n                gfc.PSY.mask_adjust = gfp.maskingadjust;\n                gfc.PSY.mask_adjust_short = gfp.maskingadjust_short;\n\n                if (vbrmode == VbrMode.vbr_off) {\n                    gfc.iteration_loop = new CBRNewIterationLoop(qu);\n                } else {\n                    gfc.iteration_loop = new ABRIterationLoop(qu);\n                }\n                break;\n            }\n        }\n        /* initialize default values common for all modes */\n\n        if (gfp.VBR != VbrMode.vbr_off) { /* choose a min/max bitrate for VBR */\n            /* if the user didn't specify VBR_max_bitrate: */\n            gfc.VBR_min_bitrate = 1;\n            /*\n             * default: allow 8 kbps (MPEG-2) or 32 kbps (MPEG-1)\n             */\n            gfc.VBR_max_bitrate = 14;\n            /*\n             * default: allow 160 kbps (MPEG-2) or 320 kbps (MPEG-1)\n             */\n            if (gfp.out_samplerate < 16000)\n                gfc.VBR_max_bitrate = 8;\n            /* default: allow 64 kbps (MPEG-2.5) */\n            if (gfp.VBR_min_bitrate_kbps != 0) {\n                gfp.VBR_min_bitrate_kbps = FindNearestBitrate(\n                    gfp.VBR_min_bitrate_kbps, gfp.version,\n                    gfp.out_samplerate);\n                gfc.VBR_min_bitrate = BitrateIndex(gfp.VBR_min_bitrate_kbps,\n                    gfp.version, gfp.out_samplerate);\n                if (gfc.VBR_min_bitrate < 0)\n                    return -1;\n            }\n            if (gfp.VBR_max_bitrate_kbps != 0) {\n                gfp.VBR_max_bitrate_kbps = FindNearestBitrate(\n                    gfp.VBR_max_bitrate_kbps, gfp.version,\n                    gfp.out_samplerate);\n                gfc.VBR_max_bitrate = BitrateIndex(gfp.VBR_max_bitrate_kbps,\n                    gfp.version, gfp.out_samplerate);\n                if (gfc.VBR_max_bitrate < 0)\n                    return -1;\n            }\n            gfp.VBR_min_bitrate_kbps = Tables.bitrate_table[gfp.version][gfc.VBR_min_bitrate];\n            gfp.VBR_max_bitrate_kbps = Tables.bitrate_table[gfp.version][gfc.VBR_max_bitrate];\n            gfp.VBR_mean_bitrate_kbps = Math.min(\n                Tables.bitrate_table[gfp.version][gfc.VBR_max_bitrate],\n                gfp.VBR_mean_bitrate_kbps);\n            gfp.VBR_mean_bitrate_kbps = Math.max(\n                Tables.bitrate_table[gfp.version][gfc.VBR_min_bitrate],\n                gfp.VBR_mean_bitrate_kbps);\n        }\n\n        /* just another daily changing developer switch */\n        if (gfp.tune) {\n            gfc.PSY.mask_adjust += gfp.tune_value_a;\n            gfc.PSY.mask_adjust_short += gfp.tune_value_a;\n        }\n\n        /* initialize internal qval settings */\n        lame_init_qval(gfp);\n        /*\n         * automatic ATH adjustment on\n         */\n        if (gfp.athaa_type < 0)\n            gfc.ATH.useAdjust = 3;\n        else\n            gfc.ATH.useAdjust = gfp.athaa_type;\n\n        /* initialize internal adaptive ATH settings -jd */\n        gfc.ATH.aaSensitivityP = Math.pow(10.0, gfp.athaa_sensitivity\n            / -10.0);\n\n        if (gfp.short_blocks == null) {\n            gfp.short_blocks = ShortBlock.short_block_allowed;\n        }\n\n        /*\n         * Note Jan/2003: Many hardware decoders cannot handle short blocks in\n         * regular stereo mode unless they are coupled (same type in both\n         * channels) it is a rare event (1 frame per min. or so) that LAME would\n         * use uncoupled short blocks, so lets turn them off until we decide how\n         * to handle this. No other encoders allow uncoupled short blocks, even\n         * though it is in the standard.\n         */\n        /*\n         * rh 20040217: coupling makes no sense for mono and dual-mono streams\n         */\n        if (gfp.short_blocks == ShortBlock.short_block_allowed\n            && (gfp.mode == MPEGMode.JOINT_STEREO || gfp.mode == MPEGMode.STEREO)) {\n            gfp.short_blocks = ShortBlock.short_block_coupled;\n        }\n\n        if (gfp.quant_comp < 0)\n            gfp.quant_comp = 1;\n        if (gfp.quant_comp_short < 0)\n            gfp.quant_comp_short = 0;\n\n        if (gfp.msfix < 0)\n            gfp.msfix = 0;\n\n        /* select psychoacoustic model */\n        gfp.exp_nspsytune = gfp.exp_nspsytune | 1;\n\n        if (gfp.internal_flags.nsPsy.attackthre < 0)\n            gfp.internal_flags.nsPsy.attackthre = PsyModel.NSATTACKTHRE;\n        if (gfp.internal_flags.nsPsy.attackthre_s < 0)\n            gfp.internal_flags.nsPsy.attackthre_s = PsyModel.NSATTACKTHRE_S;\n\n\n        if (gfp.scale < 0)\n            gfp.scale = 1;\n\n        if (gfp.ATHtype < 0)\n            gfp.ATHtype = 4;\n\n        if (gfp.ATHcurve < 0)\n            gfp.ATHcurve = 4;\n\n        if (gfp.athaa_loudapprox < 0)\n            gfp.athaa_loudapprox = 2;\n\n        if (gfp.interChRatio < 0)\n            gfp.interChRatio = 0;\n\n        if (gfp.useTemporal == null)\n            gfp.useTemporal = true;\n        /* on by default */\n\n        /*\n         * padding method as described in\n         * \"MPEG-Layer3 / Bitstream Syntax and Decoding\" by Martin Sieler, Ralph\n         * Sperschneider\n         *\n         * note: there is no padding for the very first frame\n         *\n         * Robert Hegemann 2000-06-22\n         */\n        gfc.slot_lag = gfc.frac_SpF = 0;\n        if (gfp.VBR == VbrMode.vbr_off)\n            gfc.slot_lag = gfc.frac_SpF = (((gfp.version + 1) * 72000 * gfp.brate) % gfp.out_samplerate) | 0;\n\n        qupvt.iteration_init(gfp);\n        psy.psymodel_init(gfp);\n        return 0;\n    }\n\n    function update_inbuffer_size(gfc, nsamples) {\n        if (gfc.in_buffer_0 == null || gfc.in_buffer_nsamples < nsamples) {\n            gfc.in_buffer_0 = new_float(nsamples);\n            gfc.in_buffer_1 = new_float(nsamples);\n            gfc.in_buffer_nsamples = nsamples;\n        }\n    }\n\n    this.lame_encode_flush = function (gfp, mp3buffer, mp3bufferPos, mp3buffer_size) {\n        var gfc = gfp.internal_flags;\n        var buffer = new_short_n([2, 1152]);\n        var imp3 = 0, mp3count, mp3buffer_size_remaining;\n\n        /*\n         * we always add POSTDELAY=288 padding to make sure granule with real\n         * data can be complety decoded (because of 50% overlap with next\n         * granule\n         */\n        var end_padding;\n        var frames_left;\n        var samples_to_encode = gfc.mf_samples_to_encode - Encoder.POSTDELAY;\n        var mf_needed = calcNeeded(gfp);\n\n        /* Was flush already called? */\n        if (gfc.mf_samples_to_encode < 1) {\n            return 0;\n        }\n        mp3count = 0;\n\n        if (gfp.in_samplerate != gfp.out_samplerate) {\n            /*\n             * delay due to resampling; needs to be fixed, if resampling code\n             * gets changed\n             */\n            samples_to_encode += 16. * gfp.out_samplerate / gfp.in_samplerate;\n        }\n        end_padding = gfp.framesize - (samples_to_encode % gfp.framesize);\n        if (end_padding < 576)\n            end_padding += gfp.framesize;\n        gfp.encoder_padding = end_padding;\n\n        frames_left = (samples_to_encode + end_padding) / gfp.framesize;\n\n        /*\n         * send in a frame of 0 padding until all internal sample buffers are\n         * flushed\n         */\n        while (frames_left > 0 && imp3 >= 0) {\n            var bunch = mf_needed - gfc.mf_size;\n            var frame_num = gfp.frameNum;\n\n            bunch *= gfp.in_samplerate;\n            bunch /= gfp.out_samplerate;\n            if (bunch > 1152)\n                bunch = 1152;\n            if (bunch < 1)\n                bunch = 1;\n\n            mp3buffer_size_remaining = mp3buffer_size - mp3count;\n\n            /* if user specifed buffer size = 0, dont check size */\n            if (mp3buffer_size == 0)\n                mp3buffer_size_remaining = 0;\n\n            imp3 = this.lame_encode_buffer(gfp, buffer[0], buffer[1], bunch,\n                mp3buffer, mp3bufferPos, mp3buffer_size_remaining);\n\n            mp3bufferPos += imp3;\n            mp3count += imp3;\n            frames_left -= (frame_num != gfp.frameNum) ? 1 : 0;\n        }\n        /*\n         * Set gfc.mf_samples_to_encode to 0, so we may detect and break loops\n         * calling it more than once in a row.\n         */\n        gfc.mf_samples_to_encode = 0;\n\n        if (imp3 < 0) {\n            /* some type of fatal error */\n            return imp3;\n        }\n\n        mp3buffer_size_remaining = mp3buffer_size - mp3count;\n        /* if user specifed buffer size = 0, dont check size */\n        if (mp3buffer_size == 0)\n            mp3buffer_size_remaining = 0;\n\n        /* mp3 related stuff. bit buffer might still contain some mp3 data */\n        bs.flush_bitstream(gfp);\n        imp3 = bs.copy_buffer(gfc, mp3buffer, mp3bufferPos,\n            mp3buffer_size_remaining, 1);\n        if (imp3 < 0) {\n            /* some type of fatal error */\n            return imp3;\n        }\n        mp3bufferPos += imp3;\n        mp3count += imp3;\n        mp3buffer_size_remaining = mp3buffer_size - mp3count;\n        /* if user specifed buffer size = 0, dont check size */\n        if (mp3buffer_size == 0)\n            mp3buffer_size_remaining = 0;\n\n        if (gfp.write_id3tag_automatic) {\n            /* write a id3 tag to the bitstream */\n            id3.id3tag_write_v1(gfp);\n\n            imp3 = bs.copy_buffer(gfc, mp3buffer, mp3bufferPos,\n                mp3buffer_size_remaining, 0);\n\n            if (imp3 < 0) {\n                return imp3;\n            }\n            mp3count += imp3;\n        }\n        return mp3count;\n    };\n\n    this.lame_encode_buffer = function (gfp, buffer_l, buffer_r, nsamples, mp3buf, mp3bufPos, mp3buf_size) {\n        var gfc = gfp.internal_flags;\n        var in_buffer = [null, null];\n\n        if (gfc.Class_ID != LAME_ID)\n            return -3;\n\n        if (nsamples == 0)\n            return 0;\n\n        update_inbuffer_size(gfc, nsamples);\n\n        in_buffer[0] = gfc.in_buffer_0;\n        in_buffer[1] = gfc.in_buffer_1;\n\n        /* make a copy of input buffer, changing type to sample_t */\n        for (var i = 0; i < nsamples; i++) {\n            in_buffer[0][i] = buffer_l[i];\n            if (gfc.channels_in > 1)\n                in_buffer[1][i] = buffer_r[i];\n        }\n\n        return lame_encode_buffer_sample(gfp, in_buffer[0], in_buffer[1],\n            nsamples, mp3buf, mp3bufPos, mp3buf_size);\n    }\n\n    function calcNeeded(gfp) {\n        var mf_needed = Encoder.BLKSIZE + gfp.framesize - Encoder.FFTOFFSET;\n        /*\n         * amount needed for FFT\n         */\n        mf_needed = Math.max(mf_needed, 512 + gfp.framesize - 32);\n\n        return mf_needed;\n    }\n\n    function lame_encode_buffer_sample(gfp, buffer_l, buffer_r, nsamples, mp3buf, mp3bufPos, mp3buf_size) {\n        var gfc = gfp.internal_flags;\n        var mp3size = 0, ret, i, ch, mf_needed;\n        var mp3out;\n        var mfbuf = [null, null];\n        var in_buffer = [null, null];\n\n        if (gfc.Class_ID != LAME_ID)\n            return -3;\n\n        if (nsamples == 0)\n            return 0;\n\n        /* copy out any tags that may have been written into bitstream */\n        mp3out = bs.copy_buffer(gfc, mp3buf, mp3bufPos, mp3buf_size, 0);\n        if (mp3out < 0)\n            return mp3out;\n        /* not enough buffer space */\n        mp3bufPos += mp3out;\n        mp3size += mp3out;\n\n        in_buffer[0] = buffer_l;\n        in_buffer[1] = buffer_r;\n\n        /* Apply user defined re-scaling */\n\n        /* user selected scaling of the samples */\n        if (BitStream.NEQ(gfp.scale, 0) && BitStream.NEQ(gfp.scale, 1.0)) {\n            for (i = 0; i < nsamples; ++i) {\n                in_buffer[0][i] *= gfp.scale;\n                if (gfc.channels_out == 2)\n                    in_buffer[1][i] *= gfp.scale;\n            }\n        }\n\n        /* user selected scaling of the channel 0 (left) samples */\n        if (BitStream.NEQ(gfp.scale_left, 0)\n            && BitStream.NEQ(gfp.scale_left, 1.0)) {\n            for (i = 0; i < nsamples; ++i) {\n                in_buffer[0][i] *= gfp.scale_left;\n            }\n        }\n\n        /* user selected scaling of the channel 1 (right) samples */\n        if (BitStream.NEQ(gfp.scale_right, 0)\n            && BitStream.NEQ(gfp.scale_right, 1.0)) {\n            for (i = 0; i < nsamples; ++i) {\n                in_buffer[1][i] *= gfp.scale_right;\n            }\n        }\n\n        /* Downsample to Mono if 2 channels in and 1 channel out */\n        if (gfp.num_channels == 2 && gfc.channels_out == 1) {\n            for (i = 0; i < nsamples; ++i) {\n                in_buffer[0][i] = 0.5 * ( in_buffer[0][i] + in_buffer[1][i]);\n                in_buffer[1][i] = 0.0;\n            }\n        }\n\n        mf_needed = calcNeeded(gfp);\n\n        mfbuf[0] = gfc.mfbuf[0];\n        mfbuf[1] = gfc.mfbuf[1];\n\n        var in_bufferPos = 0;\n        while (nsamples > 0) {\n            var in_buffer_ptr = [null, null];\n            var n_in = 0;\n            /* number of input samples processed with fill_buffer */\n            var n_out = 0;\n            /* number of samples output with fill_buffer */\n            /* n_in <> n_out if we are resampling */\n\n            in_buffer_ptr[0] = in_buffer[0];\n            in_buffer_ptr[1] = in_buffer[1];\n            /* copy in new samples into mfbuf, with resampling */\n            var inOut = new InOut();\n            fill_buffer(gfp, mfbuf, in_buffer_ptr, in_bufferPos, nsamples,\n                inOut);\n            n_in = inOut.n_in;\n            n_out = inOut.n_out;\n\n            /* compute ReplayGain of resampled input if requested */\n            if (gfc.findReplayGain && !gfc.decode_on_the_fly)\n                if (ga.AnalyzeSamples(gfc.rgdata, mfbuf[0], gfc.mf_size,\n                        mfbuf[1], gfc.mf_size, n_out, gfc.channels_out) == GainAnalysis.GAIN_ANALYSIS_ERROR)\n                    return -6;\n\n            /* update in_buffer counters */\n            nsamples -= n_in;\n            in_bufferPos += n_in;\n            if (gfc.channels_out == 2)\n                ;// in_bufferPos += n_in;\n\n            /* update mfbuf[] counters */\n            gfc.mf_size += n_out;\n\n            /*\n             * lame_encode_flush may have set gfc.mf_sample_to_encode to 0 so we\n             * have to reinitialize it here when that happened.\n             */\n            if (gfc.mf_samples_to_encode < 1) {\n                gfc.mf_samples_to_encode = Encoder.ENCDELAY + Encoder.POSTDELAY;\n            }\n            gfc.mf_samples_to_encode += n_out;\n\n            if (gfc.mf_size >= mf_needed) {\n                /* encode the frame. */\n                /* mp3buf = pointer to current location in buffer */\n                /* mp3buf_size = size of original mp3 output buffer */\n                /* = 0 if we should not worry about the */\n                /* buffer size because calling program is */\n                /* to lazy to compute it */\n                /* mp3size = size of data written to buffer so far */\n                /* mp3buf_size-mp3size = amount of space avalable */\n\n                var buf_size = mp3buf_size - mp3size;\n                if (mp3buf_size == 0)\n                    buf_size = 0;\n\n                ret = lame_encode_frame(gfp, mfbuf[0], mfbuf[1], mp3buf,\n                    mp3bufPos, buf_size);\n\n                if (ret < 0)\n                    return ret;\n                mp3bufPos += ret;\n                mp3size += ret;\n\n                /* shift out old samples */\n                gfc.mf_size -= gfp.framesize;\n                gfc.mf_samples_to_encode -= gfp.framesize;\n                for (ch = 0; ch < gfc.channels_out; ch++)\n                    for (i = 0; i < gfc.mf_size; i++)\n                        mfbuf[ch][i] = mfbuf[ch][i + gfp.framesize];\n            }\n        }\n\n        return mp3size;\n    }\n\n    function lame_encode_frame(gfp, inbuf_l, inbuf_r, mp3buf, mp3bufPos, mp3buf_size) {\n        var ret = self.enc.lame_encode_mp3_frame(gfp, inbuf_l, inbuf_r, mp3buf,\n            mp3bufPos, mp3buf_size);\n        gfp.frameNum++;\n        return ret;\n    }\n\n    function InOut() {\n        this.n_in = 0;\n        this.n_out = 0;\n    }\n\n\n    function NumUsed() {\n        this.num_used = 0;\n    }\n\n    /**\n     * Greatest common divisor.\n     * <p>\n     * Joint work of Euclid and M. Hendry\n     */\n    function gcd(i, j) {\n        return j != 0 ? gcd(j, i % j) : i;\n    }\n\n    /**\n     * Resampling via FIR filter, blackman window.\n     */\n    function blackman(x, fcn, l) {\n        /*\n         * This algorithm from: SIGNAL PROCESSING ALGORITHMS IN FORTRAN AND C\n         * S.D. Stearns and R.A. David, Prentice-Hall, 1992\n         */\n        var wcn = (Math.PI * fcn);\n\n        x /= l;\n        if (x < 0)\n            x = 0;\n        if (x > 1)\n            x = 1;\n        var x2 = x - .5;\n\n        var bkwn = 0.42 - 0.5 * Math.cos(2 * x * Math.PI) + 0.08 * Math.cos(4 * x * Math.PI);\n        if (Math.abs(x2) < 1e-9)\n            return (wcn / Math.PI);\n        else\n            return (bkwn * Math.sin(l * wcn * x2) / (Math.PI * l * x2));\n    }\n\n    function fill_buffer_resample(gfp, outbuf, outbufPos, desired_len, inbuf, in_bufferPos, len, num_used, ch) {\n        var gfc = gfp.internal_flags;\n        var i, j = 0, k;\n        /* number of convolution functions to pre-compute */\n        var bpc = gfp.out_samplerate\n            / gcd(gfp.out_samplerate, gfp.in_samplerate);\n        if (bpc > LameInternalFlags.BPC)\n            bpc = LameInternalFlags.BPC;\n\n        var intratio = (Math.abs(gfc.resample_ratio\n            - Math.floor(.5 + gfc.resample_ratio)) < .0001) ? 1 : 0;\n        var fcn = 1.00 / gfc.resample_ratio;\n        if (fcn > 1.00)\n            fcn = 1.00;\n        var filter_l = 31;\n        if (0 == filter_l % 2)\n            --filter_l;\n        /* must be odd */\n        filter_l += intratio;\n        /* unless resample_ratio=int, it must be even */\n\n        var BLACKSIZE = filter_l + 1;\n        /* size of data needed for FIR */\n\n        if (gfc.fill_buffer_resample_init == 0) {\n            gfc.inbuf_old[0] = new_float(BLACKSIZE);\n            gfc.inbuf_old[1] = new_float(BLACKSIZE);\n            for (i = 0; i <= 2 * bpc; ++i)\n                gfc.blackfilt[i] = new_float(BLACKSIZE);\n\n            gfc.itime[0] = 0;\n            gfc.itime[1] = 0;\n\n            /* precompute blackman filter coefficients */\n            for (j = 0; j <= 2 * bpc; j++) {\n                var sum = 0.;\n                var offset = (j - bpc) / (2. * bpc);\n                for (i = 0; i <= filter_l; i++)\n                    sum += gfc.blackfilt[j][i] = blackman(i - offset, fcn,\n                        filter_l);\n                for (i = 0; i <= filter_l; i++)\n                    gfc.blackfilt[j][i] /= sum;\n            }\n            gfc.fill_buffer_resample_init = 1;\n        }\n\n        var inbuf_old = gfc.inbuf_old[ch];\n\n        /* time of j'th element in inbuf = itime + j/ifreq; */\n        /* time of k'th element in outbuf = j/ofreq */\n        for (k = 0; k < desired_len; k++) {\n            var time0;\n            var joff;\n\n            time0 = k * gfc.resample_ratio;\n            /* time of k'th output sample */\n            j = 0 | Math.floor(time0 - gfc.itime[ch]);\n\n            /* check if we need more input data */\n            if ((filter_l + j - filter_l / 2) >= len)\n                break;\n\n            /* blackman filter. by default, window centered at j+.5(filter_l%2) */\n            /* but we want a window centered at time0. */\n            var offset = (time0 - gfc.itime[ch] - (j + .5 * (filter_l % 2)));\n\n            /* find the closest precomputed window for this offset: */\n            joff = 0 | Math.floor((offset * 2 * bpc) + bpc + .5);\n            var xvalue = 0.;\n            for (i = 0; i <= filter_l; ++i) {\n                var j2 = i + j - filter_l / 2;\n                var y;\n                y = (j2 < 0) ? inbuf_old[BLACKSIZE + j2] : inbuf[in_bufferPos\n                + j2];\n                xvalue += y * gfc.blackfilt[joff][i];\n            }\n            outbuf[outbufPos + k] = xvalue;\n        }\n\n        /* k = number of samples added to outbuf */\n        /* last k sample used data from [j-filter_l/2,j+filter_l-filter_l/2] */\n\n        /* how many samples of input data were used: */\n        num_used.num_used = Math.min(len, filter_l + j - filter_l / 2);\n\n        /*\n         * adjust our input time counter. Incriment by the number of samples\n         * used, then normalize so that next output sample is at time 0, next\n         * input buffer is at time itime[ch]\n         */\n        gfc.itime[ch] += num_used.num_used - k * gfc.resample_ratio;\n\n        /* save the last BLACKSIZE samples into the inbuf_old buffer */\n        if (num_used.num_used >= BLACKSIZE) {\n            for (i = 0; i < BLACKSIZE; i++)\n                inbuf_old[i] = inbuf[in_bufferPos + num_used.num_used + i\n                - BLACKSIZE];\n        } else {\n            /* shift in num_used.num_used samples into inbuf_old */\n            var n_shift = BLACKSIZE - num_used.num_used;\n            /*\n             * number of samples to\n             * shift\n             */\n\n            /*\n             * shift n_shift samples by num_used.num_used, to make room for the\n             * num_used new samples\n             */\n            for (i = 0; i < n_shift; ++i)\n                inbuf_old[i] = inbuf_old[i + num_used.num_used];\n\n            /* shift in the num_used.num_used samples */\n            for (j = 0; i < BLACKSIZE; ++i, ++j)\n                inbuf_old[i] = inbuf[in_bufferPos + j];\n\n        }\n        return k;\n        /* return the number samples created at the new samplerate */\n    }\n\n    function fill_buffer(gfp, mfbuf, in_buffer, in_bufferPos, nsamples, io) {\n        var gfc = gfp.internal_flags;\n\n        /* copy in new samples into mfbuf, with resampling if necessary */\n        if ((gfc.resample_ratio < .9999) || (gfc.resample_ratio > 1.0001)) {\n            for (var ch = 0; ch < gfc.channels_out; ch++) {\n                var numUsed = new NumUsed();\n                io.n_out = fill_buffer_resample(gfp, mfbuf[ch], gfc.mf_size,\n                    gfp.framesize, in_buffer[ch], in_bufferPos, nsamples,\n                    numUsed, ch);\n                io.n_in = numUsed.num_used;\n            }\n        } else {\n            io.n_out = Math.min(gfp.framesize, nsamples);\n            io.n_in = io.n_out;\n            for (var i = 0; i < io.n_out; ++i) {\n                mfbuf[0][gfc.mf_size + i] = in_buffer[0][in_bufferPos + i];\n                if (gfc.channels_out == 2)\n                    mfbuf[1][gfc.mf_size + i] = in_buffer[1][in_bufferPos + i];\n            }\n        }\n    }\n\n}\n\n\n\nfunction GetAudio() {\n    var parse;\n    var mpg;\n\n    this.setModules = function (parse2, mpg2) {\n        parse = parse2;\n        mpg = mpg2;\n    }\n}\n\n\nfunction Parse() {\n    var ver;\n    var id3;\n    var pre;\n\n    this.setModules = function (ver2, id32, pre2) {\n        ver = ver2;\n        id3 = id32;\n        pre = pre2;\n    }\n}\n\nfunction MPGLib() {\n}\n\nfunction ID3Tag() {\n    var bits;\n    var ver;\n\n    this.setModules = function (_bits, _ver) {\n        bits = _bits;\n        ver = _ver;\n    }\n}\n\nfunction Mp3Encoder(channels, samplerate, kbps) {\n    if (arguments.length != 3) {\n        console.error('WARN: Mp3Encoder(channels, samplerate, kbps) not specified');\n        channels = 1;\n        samplerate = 44100;\n        kbps = 128;\n    }\n    var lame = new Lame();\n    var gaud = new GetAudio();\n    var ga = new GainAnalysis();\n    var bs = new BitStream();\n    var p = new Presets();\n    var qupvt = new QuantizePVT();\n    var qu = new Quantize();\n    var vbr = new VBRTag();\n    var ver = new Version();\n    var id3 = new ID3Tag();\n    var rv = new Reservoir();\n    var tak = new Takehiro();\n    var parse = new Parse();\n    var mpg = new MPGLib();\n\n    lame.setModules(ga, bs, p, qupvt, qu, vbr, ver, id3, mpg);\n    bs.setModules(ga, mpg, ver, vbr);\n    id3.setModules(bs, ver);\n    p.setModules(lame);\n    qu.setModules(bs, rv, qupvt, tak);\n    qupvt.setModules(tak, rv, lame.enc.psy);\n    rv.setModules(bs);\n    tak.setModules(qupvt);\n    vbr.setModules(lame, bs, ver);\n    gaud.setModules(parse, mpg);\n    parse.setModules(ver, id3, p);\n\n    var gfp = lame.lame_init();\n\n    gfp.num_channels = channels;\n    gfp.in_samplerate = samplerate;\n    gfp.out_samplerate = samplerate;//fix by xiangyuecn 2018-12-6 01:48:12 64kbps以下可能无声音，手动控制输出码率\n    gfp.brate = kbps;\n    gfp.mode = MPEGMode.STEREO;\n    gfp.quality = 3;\n    gfp.bWriteVbrTag = false;\n    gfp.disable_reservoir = true;\n    gfp.write_id3tag_automatic = false;\n\n    var retcode = lame.lame_init_params(gfp);\n    var maxSamples = 1152;\n    var mp3buf_size = 0 | (1.25 * maxSamples + 7200);\n    var mp3buf = new_byte(mp3buf_size);\n\n    this.encodeBuffer = function (left, right) {\n        if (channels == 1) {\n            right = left;\n        }\n        if (left.length > maxSamples) {\n            maxSamples = left.length;\n            mp3buf_size = 0 | (1.25 * maxSamples + 7200);\n            mp3buf = new_byte(mp3buf_size);\n        }\n\n        var _sz = lame.lame_encode_buffer(gfp, left, right, left.length, mp3buf, 0, mp3buf_size);\n        return new Int8Array(mp3buf.subarray(0, _sz));\n    };\n\n    this.flush = function () {\n        var _sz = lame.lame_encode_flush(gfp, mp3buf, 0, mp3buf_size);\n        return new Int8Array(mp3buf.subarray(0, _sz));\n    };\n}\n\n//fix 精简\nL3Side.SFBMAX = (Encoder.SBMAX_s * 3);\n//testFullLength();\nlamejs.Mp3Encoder = Mp3Encoder;\n}\n//fs=require('fs');\nlamejs();\n\n\nRecorder.lamejs=lamejs;\n\n//end3 ****结束copy lamejs*****\n})();","/*\nmp3编码器，需带上mp3-engine.js引擎使用\nhttps://github.com/xiangyuecn/Recorder\n\n当然最佳推荐使用mp3、wav格式，代码也是优先照顾这两种格式\n浏览器支持情况\nhttps://developer.mozilla.org/en-US/docs/Web/HTML/Supported_media_formats\n*/\n(function(){\n\"use strict\";\n\nRecorder.prototype.enc_mp3={\n\tstable:true\n\t,testmsg:\"采样率范围48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000\"\n};\n\n\n\n//*******标准UI线程转码支持函数************\n\nRecorder.prototype.mp3=function(res,True,False){\n\t\tvar This=this,set=This.set,size=res.length;\n\t\t\n\t\t//优先采用worker编码，太低版本下面用老方法提供兼容\n\t\tvar ctx=This.mp3_start(set);\n\t\tif(ctx){\n\t\t\tThis.mp3_encode(ctx,res);\n\t\t\tThis.mp3_complete(ctx,True,False,1);\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//https://github.com/wangpengfei15975/recorder.js\n\t\t//https://github.com/zhuker/lamejs bug:采样率必须和源一致，不然8k时没有声音，有问题fix：https://github.com/zhuker/lamejs/pull/11\n\t\tvar mp3=new Recorder.lamejs.Mp3Encoder(1,set.sampleRate,set.bitRate);\n\t\t\n\t\tvar blockSize=57600;\n\t\tvar data=[];\n\t\t\n\t\tvar idx=0,mp3Size=0;\n\t\tvar run=function(){\n\t\t\tif(idx<size){\n\t\t\t\tvar buf=mp3.encodeBuffer(res.subarray(idx,idx+blockSize));\n\t\t\t\tif(buf.length>0){\n\t\t\t\t\tmp3Size+=buf.buffer.byteLength;\n\t\t\t\t\tdata.push(buf.buffer);\n\t\t\t\t};\n\t\t\t\tidx+=blockSize;\n\t\t\t\tsetTimeout(run);//尽量避免卡ui\n\t\t\t}else{\n\t\t\t\tvar buf=mp3.flush();\n\t\t\t\tif(buf.length>0){\n\t\t\t\t\tmp3Size+=buf.buffer.byteLength;\n\t\t\t\t\tdata.push(buf.buffer);\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\t//去掉开头的标记信息帧\n\t\t\t\tvar meta=mp3TrimFix.fn(data,mp3Size,size,set.sampleRate);\n\t\t\t\tmp3TrimFixSetMeta(meta,set);\n\t\t\t\t\n\t\t\t\tTrue(new Blob(data,{type:\"audio/mp3\"}));\n\t\t\t};\n\t\t};\n\t\trun();\n\t}\n\n\n//********边录边转码(Worker)支持函数，如果提供就代表可能支持，否则只支持标准转码*********\n\n//全局共享一个Worker，后台串行执行。如果每次都开一个新的，编码速度可能会慢很多，可能是浏览器运行缓存的因素，并且可能瞬间产生多个并行操作占用大量cpu\nvar mp3Worker;\nRecorder.BindDestroy(\"mp3Worker\",function(){\n\tconsole.log(\"mp3Worker Destroy\");\n\tmp3Worker&&mp3Worker.terminate();\n\tmp3Worker=null;\n});\n\n\nRecorder.prototype.mp3_envCheck=function(envInfo,set){//检查环境下配置是否可用\n\tvar errMsg=\"\";\n\t//需要实时编码返回数据，此时需要检查环境是否有实时特性、和是否可实时编码\n\tif(set.takeoffEncodeChunk){\n\t\tif(!envInfo.canProcess){\n\t\t\terrMsg=envInfo.envName+\"环境不支持实时处理\";\n\t\t}else if(!newContext()){//浏览器不能创建实时编码环境\n\t\t\terrMsg=\"当前浏览器版本太低，无法实时处理\";\n\t\t};\n\t};\n\treturn errMsg;\n};\nRecorder.prototype.mp3_start=function(set){//如果返回null代表不支持\n\treturn newContext(set);\n};\nvar openList={id:0};\nvar newContext=function(setOrNull){\n\tvar worker=mp3Worker;\n\ttry{\n\t\tif(!worker){\n\t\t\tvar onmsg=function(e){\n\t\t\t\tvar ed=e.data;\n\t\t\t\tvar cur=wk_ctxs[ed.id];\n\t\t\t\tif(ed.action==\"init\"){\n\t\t\t\t\twk_ctxs[ed.id]={\n\t\t\t\t\t\tsampleRate:ed.sampleRate\n\t\t\t\t\t\t,bitRate:ed.bitRate\n\t\t\t\t\t\t,takeoff:ed.takeoff\n\t\t\t\t\t\t\n\t\t\t\t\t\t,mp3Size:0\n\t\t\t\t\t\t,pcmSize:0\n\t\t\t\t\t\t,encArr:[]\n\t\t\t\t\t\t,encObj:new wk_lame.Mp3Encoder(1,ed.sampleRate,ed.bitRate)\n\t\t\t\t\t};\n\t\t\t\t}else if(!cur){\n\t\t\t\t\treturn;\n\t\t\t\t};\n\t\t\t\t\n\t\t\t\tswitch(ed.action){\n\t\t\t\tcase \"stop\":\n\t\t\t\t\tcur.encObj=null;\n\t\t\t\t\tdelete wk_ctxs[ed.id];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"encode\":\n\t\t\t\t\tcur.pcmSize+=ed.pcm.length;\n\t\t\t\t\tvar buf=cur.encObj.encodeBuffer(ed.pcm);\n\t\t\t\t\tif(buf.length>0){\n\t\t\t\t\t\tif(cur.takeoff){\n\t\t\t\t\t\t\tself.postMessage({action:\"takeoff\",id:ed.id,chunk:buf});\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tcur.mp3Size+=buf.buffer.byteLength;\n\t\t\t\t\t\t\tcur.encArr.push(buf.buffer);\n\t\t\t\t\t\t};\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"complete\":\n\t\t\t\t\tvar buf=cur.encObj.flush();\n\t\t\t\t\tif(buf.length>0){\n\t\t\t\t\t\tif(cur.takeoff){\n\t\t\t\t\t\t\tself.postMessage({action:\"takeoff\",id:ed.id,chunk:buf});\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tcur.mp3Size+=buf.buffer.byteLength;\n\t\t\t\t\t\t\tcur.encArr.push(buf.buffer);\n\t\t\t\t\t\t};\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\t//去掉开头的标记信息帧\n\t\t\t\t\tvar meta=wk_mp3TrimFix.fn(cur.encArr,cur.mp3Size,cur.pcmSize,cur.sampleRate);\n\t\t\t\t\t\n\t\t\t\t\tself.postMessage({\n\t\t\t\t\t\taction:ed.action\n\t\t\t\t\t\t,id:ed.id\n\t\t\t\t\t\t,blob:new Blob(cur.encArr,{type:\"audio/mp3\"})\n\t\t\t\t\t\t,meta:meta\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\t};\n\t\t\t};\n\t\t\t\n\t\t\t//创建一个新Worker\n\t\t\tvar jsCode=\");wk_lame();var wk_ctxs={};self.onmessage=\"+onmsg;\n\t\t\tjsCode+=\";var wk_mp3TrimFix={rm:\"+mp3TrimFix.rm+\",fn:\"+mp3TrimFix.fn+\"}\";\n\t\t\t\n\t\t\tvar lamejsCode=Recorder.lamejs.toString();\n\t\t\tvar url=(window.URL||webkitURL).createObjectURL(new Blob([\"var wk_lame=(\",lamejsCode,jsCode], {type:\"text/javascript\"}));\n\t\t\t\n\t\t\tworker=new Worker(url);\n\t\t\tsetTimeout(function(){\n\t\t\t\t(window.URL||webkitURL).revokeObjectURL(url);//必须要释放，不然每次调用内存都明显泄露内存\n\t\t\t},10000);//chrome 83 file协议下如果直接释放，将会使WebWorker无法启动\n\t\t\t\n\t\t\tworker.onmessage=function(e){\n\t\t\t\tvar data=e.data;\n\t\t\t\tvar ctx=openList[data.id];\n\t\t\t\tif(ctx){\n\t\t\t\t\tif(data.action==\"takeoff\"){\n\t\t\t\t\t\t//取走实时生成的mp3数据\n\t\t\t\t\t\tctx.set.takeoffEncodeChunk(new Uint8Array(data.chunk.buffer));\n\t\t\t\t\t}else{\n\t\t\t\t\t\t//complete\n\t\t\t\t\t\tctx.call&&ctx.call(data);\n\t\t\t\t\t\tctx.call=null;\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t\t\n\t\tvar ctx={worker:worker,set:setOrNull,takeoffQueue:[]};\n\t\tif(setOrNull){\n\t\t\tctx.id=++openList.id;\n\t\t\topenList[ctx.id]=ctx;\n\t\t\t\n\t\t\tworker.postMessage({\n\t\t\t\taction:\"init\"\n\t\t\t\t,id:ctx.id\n\t\t\t\t,sampleRate:setOrNull.sampleRate\n\t\t\t\t,bitRate:setOrNull.bitRate\n\t\t\t\t,takeoff:!!setOrNull.takeoffEncodeChunk\n\t\t\t\t\n\t\t\t\t,x:new Int16Array(5)//低版本浏览器不支持序列化TypedArray\n\t\t\t});\n\t\t}else{\n\t\t\tworker.postMessage({\n\t\t\t\tx:new Int16Array(5)//低版本浏览器不支持序列化TypedArray\n\t\t\t});\n\t\t};\n\t\t\n\t\t\n\t\tmp3Worker=worker;\n\t\treturn ctx;\n\t}catch(e){//出错了就不要提供了\n\t\tworker&&worker.terminate();\n\t\t\n\t\tconsole.error(e);\n\t\treturn null;\n\t};\n};\nRecorder.prototype.mp3_stop=function(startCtx){\n\tif(startCtx&&startCtx.worker){\n\t\tstartCtx.worker.postMessage({\n\t\t\taction:\"stop\"\n\t\t\t,id:startCtx.id\n\t\t});\n\t\tstartCtx.worker=null;\n\t\tdelete openList[startCtx.id];\n\t\t\n\t\t//疑似泄露检测 排除id\n\t\tvar opens=-1;\n\t\tfor(var k in openList){\n\t\t\topens++;\n\t\t};\n\t\tif(opens){\n\t\t\tconsole.warn(\"mp3 worker剩\"+opens+\"个在串行等待\");\n\t\t};\n\t};\n};\nRecorder.prototype.mp3_encode=function(startCtx,pcm){\n\tif(startCtx&&startCtx.worker){\n\t\tstartCtx.worker.postMessage({\n\t\t\taction:\"encode\"\n\t\t\t,id:startCtx.id\n\t\t\t,pcm:pcm\n\t\t});\n\t};\n};\nRecorder.prototype.mp3_complete=function(startCtx,True,False,autoStop){\n\tvar This=this;\n\tif(startCtx&&startCtx.worker){\n\t\tstartCtx.call=function(data){\n\t\t\tmp3TrimFixSetMeta(data.meta,startCtx.set);\n\t\t\tTrue(data.blob);\n\t\t\t\n\t\t\tif(autoStop){\n\t\t\t\tThis.mp3_stop(startCtx);\n\t\t\t};\n\t\t};\n\t\tstartCtx.worker.postMessage({\n\t\t\taction:\"complete\"\n\t\t\t,id:startCtx.id\n\t\t});\n\t}else{\n\t\tFalse(\"mp3编码器未打开\");\n\t};\n};\n\n\n\n\n\n\n\n//*******辅助函数************\n\n/*读取lamejs编码出来的mp3信息，只能读特定格式，如果读取失败返回null\nmp3Buffers=[ArrayBuffer,...]\nlength=mp3Buffers的数据二进制总长度\n*/\nRecorder.mp3ReadMeta=function(mp3Buffers,length){\n\t//kill babel-polyfill ES6 Number.parseInt 不然放到Worker里面找不到方法\n\tvar parseInt_ES3=typeof(window)==\"object\"?window.parseInt:self.parseInt;\n\t\n\tvar u8arr0=new Uint8Array(mp3Buffers[0]||[]);\n\tif(u8arr0.length<4){\n\t\treturn null;\n\t};\n\tvar byteAt=function(idx,u8){\n\t\treturn (\"0000000\"+((u8||u8arr0)[idx]||0).toString(2)).substr(-8);\n\t};\n\tvar b2=byteAt(0)+byteAt(1);\n\tvar b4=byteAt(2)+byteAt(3);\n\t\n\tif(!/^1{11}/.test(b2)){//未发现帧同步\n\t\treturn null;\n\t};\n\tvar version=({\"00\":2.5,\"10\":2,\"11\":1})[b2.substr(11,2)];\n\tvar layer=({\"01\":3})[b2.substr(13,2)];//仅支持Layer3\n\tvar sampleRate=({ //lamejs -> Tables.samplerate_table\n\t\t\"1\":[44100, 48000, 32000]\n\t\t,\"2\":[22050, 24000, 16000]\n\t\t,\"2.5\":[11025, 12000, 8000]\n\t})[version];\n\tsampleRate&&(sampleRate=sampleRate[parseInt_ES3(b4.substr(4,2),2)]);\n\tvar bitRate=[ //lamejs -> Tables.bitrate_table\n\t\t[0, 8, 16, 24, 32, 40, 48, 56, 64, 80, 96, 112, 128, 144, 160] //MPEG 2 2.5\n\t\t,[0, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 256, 320]//MPEG 1\n\t][version==1?1:0][parseInt_ES3(b4.substr(0,4),2)];\n\t\n\tif(!version || !layer || !bitRate || !sampleRate){\n\t\treturn null;\n\t};\n\t\n\tvar duration=Math.round(length*8/bitRate);\n\tvar frame=layer==1?384:layer==2?1152:version==1?1152:576;\n\tvar frameDurationFloat=frame/sampleRate*1000;\n\tvar frameSize=Math.floor((frame*bitRate)/8/sampleRate*1000);\n\t\n\t//检测是否存在Layer3帧填充1字节。这里只获取第二帧的填充信息，首帧永远没有填充。其他帧可能隔一帧出现一个填充，或者隔很多帧出现一个填充；目测是取决于frameSize未舍入时的小数部分，因为有些采样率的frameSize会出现小数（11025、22050、44100 典型的除不尽），然后字节数无法表示这种小数，就通过一定步长来填充弥补小数部分丢失\n\tvar hasPadding=0,seek=0;\n\tfor(var i=0;i<mp3Buffers.length;i++){\n\t\t//寻找第二帧\n\t\tvar buf=mp3Buffers[i];\n\t\tseek+=buf.byteLength;\n\t\tif(seek>=frameSize+3){\n\t\t\tvar buf8=new Uint8Array(buf);\n\t\t\tvar idx=buf.byteLength-(seek-(frameSize+3)+1);\n\t\t\tvar ib4=byteAt(idx,buf8);\n\t\t\thasPadding=ib4.charAt(6)==\"1\";\n\t\t\tbreak;\n\t\t};\n\t};\n\tif(hasPadding){\n\t\tframeSize++;\n\t};\n\t\n\t\n\treturn {\n\t\tversion:version //1 2 2.5 -> MPEG1 MPEG2 MPEG2.5\n\t\t,layer:layer//3 -> Layer3\n\t\t,sampleRate:sampleRate //采样率 hz\n\t\t,bitRate:bitRate //比特率 kbps\n\t\t\n\t\t,duration:duration //音频时长 ms\n\t\t,size:length //总长度 byte\n\t\t,hasPadding:hasPadding //是否存在1字节填充，首帧永远没有，这个值其实代表的第二帧是否有填充，并不代表其他帧的\n\t\t,frameSize:frameSize //每帧最大长度，含可能存在的1字节padding byte\n\t\t,frameDurationFloat:frameDurationFloat //每帧时长，含小数 ms\n\t};\n};\n\n//去掉lamejs开头的标记信息帧，免得mp3解码出来的时长比pcm的长太多\nvar mp3TrimFix={//minfiy keep name\nrm:Recorder.mp3ReadMeta\n,fn:function(mp3Buffers,length,pcmLength,pcmSampleRate){\n\tvar meta=this.rm(mp3Buffers,length);\n\tif(!meta){\n\t\treturn {err:\"mp3非预定格式\"};\n\t};\n\tvar pcmDuration=Math.round(pcmLength/pcmSampleRate*1000);\n\t\n\t//开头多出这么多帧，移除掉；正常情况下最多为2帧\n\tvar num=Math.floor((meta.duration-pcmDuration)/meta.frameDurationFloat);\n\tif(num>0){\n\t\tvar size=num*meta.frameSize-(meta.hasPadding?1:0);//首帧没有填充，第二帧可能有填充，这里假设最多为2帧（测试并未出现3帧以上情况），其他帧不管，就算出现了并且导致了错误后面自动容错\n\t\tlength-=size;\n\t\tvar arr0=0,arrs=[];\n\t\tfor(var i=0;i<mp3Buffers.length;i++){\n\t\t\tvar arr=mp3Buffers[i];\n\t\t\tif(size<=0){\n\t\t\t\tbreak;\n\t\t\t};\n\t\t\tif(size>=arr.byteLength){\n\t\t\t\tsize-=arr.byteLength;\n\t\t\t\tarrs.push(arr);\n\t\t\t\tmp3Buffers.splice(i,1);\n\t\t\t\ti--;\n\t\t\t}else{\n\t\t\t\tmp3Buffers[i]=arr.slice(size);\n\t\t\t\tarr0=arr;\n\t\t\t\tsize=0;\n\t\t\t};\n\t\t};\n\t\tvar checkMeta=this.rm(mp3Buffers,length);\n\t\tif(!checkMeta){\n\t\t\t//还原变更，应该不太可能会出现\n\t\t\tarr0&&(mp3Buffers[0]=arr0);\n\t\t\tfor(var i=0;i<arrs.length;i++){\n\t\t\t\tmp3Buffers.splice(i,0,arrs[i]);\n\t\t\t};\n\t\t\tmeta.err=\"fix后数据错误，已还原，错误原因不明\";\n\t\t};\n\t\t\n\t\tvar fix=meta.trimFix={};\n\t\tfix.remove=num;\n\t\tfix.removeDuration=Math.round(num*meta.frameDurationFloat);\n\t\tfix.duration=Math.round(length*8/meta.bitRate);\n\t};\n\treturn meta;\n}\n};\nvar mp3TrimFixSetMeta=function(meta,set){\n\tvar tag=\"MP3信息 \";\n\tif(meta.sampleRate&&meta.sampleRate!=set.sampleRate || meta.bitRate&&meta.bitRate!=set.bitRate){\n\t\tconsole.warn(tag+\"和设置的不匹配set:\"+set.bitRate+\"kbps \"+set.sampleRate+\"hz，已更新set:\"+meta.bitRate+\"kbps \"+meta.sampleRate+\"hz\",set);\n\t\tset.sampleRate=meta.sampleRate;\n\t\tset.bitRate=meta.bitRate;\n\t};\n\t\n\tvar trimFix=meta.trimFix;\n\tif(trimFix){\n\t\ttag+=\"Fix移除\"+trimFix.remove+\"帧\"+trimFix.removeDuration+\"ms -> \"+trimFix.duration+\"ms\";\n\t\tif(trimFix.remove>2){\n\t\t\tmeta.err=(meta.err?meta.err+\", \":\"\")+\"移除帧数过多\";\n\t\t};\n\t}else{\n\t\ttag+=(meta.duration||\"-\")+\"ms\";\n\t};\n\t\n\tif(meta.err){\n\t\tconsole.error(tag,meta.err,meta);\n\t}else{\n\t\tconsole.log(tag,meta);\n\t};\n};\n\n\n\t\n})();","/*\n录音\nhttps://github.com/xiangyuecn/Recorder\n*/\n(function(factory){\n\tfactory(window);\n\t//umd returnExports.js\n\tif(typeof(define)=='function' && define.amd){\n\t\tdefine(function(){\n\t\t\treturn Recorder;\n\t\t});\n\t};\n\tif(typeof(module)=='object' && module.exports){\n\t\tmodule.exports=Recorder;\n\t};\n}(function(window){\n\"use strict\";\n\n//兼容环境\nvar LM=\"2020-11-15 21:36:11\";\nvar NOOP=function(){};\n//end 兼容环境 ****从以下开始copy源码*****\n\nvar Recorder=function(set){\n\treturn new initFn(set);\n};\n//是否已经打开了录音，所有工作都已经准备好了，就等接收音频数据了\nRecorder.IsOpen=function(){\n\tvar stream=Recorder.Stream;\n\tif(stream){\n\t\tvar tracks=stream.getTracks&&stream.getTracks()||stream.audioTracks||[];\n\t\tvar track=tracks[0];\n\t\tif(track){\n\t\t\tvar state=track.readyState;\n\t\t\treturn state==\"live\"||state==track.LIVE;\n\t\t};\n\t};\n\treturn false;\n};\n/*H5录音时的AudioContext缓冲大小。会影响H5录音时的onProcess调用速率，相对于AudioContext.sampleRate=48000时，4096接近12帧/s，调节此参数可生成比较流畅的回调动画。\n\t取值256, 512, 1024, 2048, 4096, 8192, or 16384\n\t注意，取值不能过低，2048开始不同浏览器可能回调速率跟不上造成音质问题。\n\t一般无需调整，调整后需要先close掉已打开的录音，再open时才会生效。\n*/\nRecorder.BufferSize=4096;\n//销毁已持有的所有全局资源，当要彻底移除Recorder时需要显式的调用此方法\nRecorder.Destroy=function(){\n\tCLog(\"Recorder Destroy\");\n\tfor(var k in DestroyList){\n\t\tDestroyList[k]();\n\t};\n};\nvar DestroyList={};\n//登记一个需要销毁全局资源的处理方法\nRecorder.BindDestroy=function(key,call){\n\tDestroyList[key]=call;\n};\n//判断浏览器是否支持录音，随时可以调用。注意：仅仅是检测浏览器支持情况，不会判断和调起用户授权，不会判断是否支持特定格式录音。\nRecorder.Support=function(){\n\tvar AC=window.AudioContext;\n\tif(!AC){\n\t\tAC=window.webkitAudioContext;\n\t};\n\tif(!AC){\n\t\treturn false;\n\t};\n\tvar scope=navigator.mediaDevices||{};\n\tif(!scope.getUserMedia){\n\t\tscope=navigator;\n\t\tscope.getUserMedia||(scope.getUserMedia=scope.webkitGetUserMedia||scope.mozGetUserMedia||scope.msGetUserMedia);\n\t};\n\tif(!scope.getUserMedia){\n\t\treturn false;\n\t};\n\t\n\tRecorder.Scope=scope;\n\tif(!Recorder.Ctx||Recorder.Ctx.state==\"closed\"){\n\t\t//不能反复构造，低版本number of hardware contexts reached maximum (6)\n\t\tRecorder.Ctx=new AC();\n\t\t\n\t\tRecorder.BindDestroy(\"Ctx\",function(){\n\t\t\tvar ctx=Recorder.Ctx;\n\t\t\tctx&&ctx.close&&ctx.close();\n\t\t});\n\t};\n\treturn true;\n};\n/*初始化H5音频采集连接，因为Stream是全局的，Safari上断开后就无法再次进行连接使用，表现为静音，因此使用全部使用全局处理避免调用到disconnect；全局处理也有利于屏蔽底层细节，start时无需再调用底层接口，提升兼容、可靠性。*/\nvar Connect=function(){\n\tvar ctx=Recorder.Ctx,stream=Recorder.Stream;\n\tvar media=stream._m=ctx.createMediaStreamSource(stream);\n\tvar process=stream._p=(ctx.createScriptProcessor||ctx.createJavaScriptNode).call(ctx,Recorder.BufferSize,1,1);//单声道，省的数据处理复杂\n\t\n\tmedia.connect(process);\n\tprocess.connect(ctx.destination);\n\t\n\tvar calls=stream._call;\n\tprocess.onaudioprocess=function(e){\n\t\tfor(var k0 in calls){//has item\n\t\t\tvar o=e.inputBuffer.getChannelData(0);//块是共享的，必须复制出来\n\t\t\tvar size=o.length;\n\t\t\t\n\t\t\tvar pcm=new Int16Array(size);\n\t\t\tvar sum=0;\n\t\t\tfor(var j=0;j<size;j++){//floatTo16BitPCM \n\t\t\t\tvar s=Math.max(-1,Math.min(1,o[j]));\n\t\t\t\ts=s<0?s*0x8000:s*0x7FFF;\n\t\t\t\tpcm[j]=s;\n\t\t\t\tsum+=Math.abs(s);\n\t\t\t};\n\t\t\t\n\t\t\tfor(var k in calls){\n\t\t\t\tcalls[k](pcm,sum);\n\t\t\t};\n\t\t\t\n\t\t\treturn;\n\t\t};\n\t};\n};\nvar Disconnect=function(){\n\tvar stream=Recorder.Stream;\n\tif(stream._m){\n\t\tstream._m.disconnect();\n\t\tstream._p.disconnect();\n\t\tstream._p.onaudioprocess=stream._p=stream._m=null;\n\t};\n};\n\n/*对pcm数据的采样率进行转换\npcmDatas: [[Int16,...]] pcm片段列表\npcmSampleRate:48000 pcm数据的采样率\nnewSampleRate:16000 需要转换成的采样率，newSampleRate>=pcmSampleRate时不会进行任何处理，小于时会进行重新采样\nprevChunkInfo:{} 可选，上次调用时的返回值，用于连续转换，本次调用将从上次结束位置开始进行处理。或可自行定义一个ChunkInfo从pcmDatas指定的位置开始进行转换\noption:{ 可选，配置项\n\t\tframeSize:123456 帧大小，每帧的PCM Int16的数量，采样率转换后的pcm长度为frameSize的整数倍，用于连续转换。目前仅在mp3格式时才有用，frameSize取值为1152，这样编码出来的mp3时长和pcm的时长完全一致，否则会因为mp3最后一帧录音不够填满时添加填充数据导致mp3的时长变长。\n\t\tframeType:\"\" 帧类型，一般为rec.set.type，提供此参数时无需提供frameSize，会自动使用最佳的值给frameSize赋值，目前仅支持mp3=1152(MPEG1 Layer3的每帧采采样数)，其他类型=1。\n\t\t\t以上两个参数用于连续转换时使用，最多使用一个，不提供时不进行帧的特殊处理，提供时必须同时提供prevChunkInfo才有作用。最后一段数据处理时无需提供帧大小以便输出最后一丁点残留数据。\n\t}\n\n返回ChunkInfo:{\n\t//可定义，从指定位置开始转换到结尾\n\tindex:0 pcmDatas已处理到的索引\n\toffset:0.0 已处理到的index对应的pcm中的偏移的下一个位置\n\t\n\t//仅作为返回值\n\tframeNext:null||[Int16,...] 下一帧的部分数据，frameSize设置了的时候才可能会有\n\tsampleRate:16000 结果的采样率，<=newSampleRate\n\tdata:[Int16,...] 转换后的PCM结果；如果是连续转换，并且pcmDatas中并没有新数据时，data的长度可能为0\n}\n*/\nRecorder.SampleData=function(pcmDatas,pcmSampleRate,newSampleRate,prevChunkInfo,option){\n\tprevChunkInfo||(prevChunkInfo={});\n\tvar index=prevChunkInfo.index||0;\n\tvar offset=prevChunkInfo.offset||0;\n\t\n\tvar frameNext=prevChunkInfo.frameNext||[];\n\toption||(option={});\n\tvar frameSize=option.frameSize||1;\n\tif(option.frameType){\n\t\tframeSize=option.frameType==\"mp3\"?1152:1;\n\t};\n\t\n\tvar size=0;\n\tfor(var i=index;i<pcmDatas.length;i++){\n\t\tsize+=pcmDatas[i].length;\n\t};\n\tsize=Math.max(0,size-Math.floor(offset));\n\t\n\t//采样 https://www.cnblogs.com/blqw/p/3782420.html\n\tvar step=pcmSampleRate/newSampleRate;\n\tif(step>1){//新采样低于录音采样，进行抽样\n\t\tsize=Math.floor(size/step);\n\t}else{//新采样高于录音采样不处理，省去了插值处理\n\t\tstep=1;\n\t\tnewSampleRate=pcmSampleRate;\n\t};\n\t\n\tsize+=frameNext.length;\n\tvar res=new Int16Array(size);\n\tvar idx=0;\n\t//添加上一次不够一帧的剩余数据\n\tfor(var i=0;i<frameNext.length;i++){\n\t\tres[idx]=frameNext[i];\n\t\tidx++;\n\t};\n\t//处理数据\n\tfor (var nl=pcmDatas.length;index<nl;index++) {\n\t\tvar o=pcmDatas[index];\n\t\tvar i=offset,il=o.length;\n\t\twhile(i<il){\n\t\t\t//res[idx]=o[Math.round(i)]; 直接简单抽样\n\t\t\t\n\t\t\t//https://www.cnblogs.com/xiaoqi/p/6993912.html\n\t\t\t//当前点=当前点+到后面一个点之间的增量，音质比直接简单抽样好些\n\t\t\tvar before = Math.floor(i);\n\t\t\tvar after = Math.ceil(i);\n\t\t\tvar atPoint = i - before;\n\t\t\t\n\t\t\tvar beforeVal=o[before];\n\t\t\tvar afterVal=after<il ? o[after]\n\t\t\t\t: (//后个点越界了，查找下一个数组\n\t\t\t\t\t(pcmDatas[index+1]||[beforeVal])[0]||0\n\t\t\t\t);\n\t\t\tres[idx]=beforeVal+(afterVal-beforeVal)*atPoint;\n\t\t\t\n\t\t\tidx++;\n\t\t\ti+=step;//抽样\n\t\t};\n\t\toffset=i-il;\n\t};\n\t//帧处理\n\tframeNext=null;\n\tvar frameNextSize=res.length%frameSize;\n\tif(frameNextSize>0){\n\t\tvar u8Pos=(res.length-frameNextSize)*2;\n\t\tframeNext=new Int16Array(res.buffer.slice(u8Pos));\n\t\tres=new Int16Array(res.buffer.slice(0,u8Pos));\n\t};\n\t\n\treturn {\n\t\tindex:index\n\t\t,offset:offset\n\t\t\n\t\t,frameNext:frameNext\n\t\t,sampleRate:newSampleRate\n\t\t,data:res\n\t};\n};\n\n\n/*计算音量百分比的一个方法\npcmAbsSum: pcm Int16所有采样的绝对值的和\npcmLength: pcm长度\n返回值：0-100，主要当做百分比用\n注意：这个不是分贝，因此没用volume当做名称*/\nRecorder.PowerLevel=function(pcmAbsSum,pcmLength){\n\t/*计算音量 https://blog.csdn.net/jody1989/article/details/73480259\n\t更高灵敏度算法:\n\t\t限定最大感应值10000\n\t\t\t线性曲线：低音量不友好\n\t\t\t\tpower/10000*100 \n\t\t\t对数曲线：低音量友好，但需限定最低感应值\n\t\t\t\t(1+Math.log10(power/10000))*100\n\t*/\n\tvar power=(pcmAbsSum/pcmLength) || 0;//NaN\n\tvar level;\n\tif(power<1251){//1250的结果10%，更小的音量采用线性取值\n\t\tlevel=Math.round(power/1250*10);\n\t}else{\n\t\tlevel=Math.round(Math.min(100,Math.max(0,(1+Math.log(power/10000)/Math.log(10))*100)));\n\t};\n\treturn level;\n};\n\n\n\n\n//带时间的日志输出，CLog(msg,errOrLogMsg, logMsg...) err为数字时代表日志类型1:error 2:log默认 3:warn，否则当做内容输出，第一个参数不能是对象因为要拼接时间，后面可以接无数个输出参数\nvar CLog=function(msg,err){\n\tvar now=new Date();\n\tvar t=(\"0\"+now.getMinutes()).substr(-2)\n\t\t+\":\"+(\"0\"+now.getSeconds()).substr(-2)\n\t\t+\".\"+(\"00\"+now.getMilliseconds()).substr(-3);\n\tvar arr=[\"[\"+t+\" Recorder]\"+msg];\n\tvar a=arguments;\n\tvar i=2,fn=console.log;\n\tif(typeof(err)==\"number\"){\n\t\tfn=err==1?console.error:err==3?console.warn:fn;\n\t}else{\n\t\ti=1;\n\t};\n\tfor(;i<a.length;i++){\n\t\tarr.push(a[i]);\n\t};\n\tfn.apply(console,arr);\n};\nRecorder.CLog=CLog;\n\n\n\n\nvar ID=0;\nfunction initFn(set){\n\tthis.id=++ID;\n\t\n\t//如果开启了流量统计，这里将发送一个图片请求\n\tRecorder.Traffic&&Recorder.Traffic();\n\t\n\t\n\tvar o={\n\t\ttype:\"mp3\" //输出类型：mp3,wav，wav输出文件尺寸超大不推荐使用，但mp3编码支持会导致js文件超大，如果不需支持mp3可以使js文件大幅减小\n\t\t,bitRate:16 //比特率 wav:16或8位，MP3：8kbps 1k/s，8kbps 2k/s 录音文件很小\n\t\t\n\t\t,sampleRate:16000 //采样率，wav格式大小=sampleRate*时间；mp3此项对低比特率有影响，高比特率几乎无影响。\n\t\t\t\t\t//wav任意值，mp3取值范围：48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000\n\t\t\t\t\t//采样率参考https://www.cnblogs.com/devin87/p/mp3-recorder.html\n\t\t\n\t\t,onProcess:NOOP //fn(buffers,powerLevel,bufferDuration,bufferSampleRate,newBufferIdx,asyncEnd) buffers=[[Int16,...],...]：缓冲的PCM数据，为从开始录音到现在的所有pcm片段；powerLevel：当前缓冲的音量级别0-100，bufferDuration：已缓冲时长，bufferSampleRate：缓冲使用的采样率（当type支持边录边转码(Worker)时，此采样率和设置的采样率相同，否则不一定相同）；newBufferIdx:本次回调新增的buffer起始索引；asyncEnd:fn() 如果onProcess是异步的(返回值为true时)，处理完成时需要调用此回调，如果不是异步的请忽略此参数，此方法回调时必须是真异步（不能真异步时需用setTimeout包裹）。onProcess返回值：如果返回true代表开启异步模式，在某些大量运算的场合异步是必须的，必须在异步处理完成时调用asyncEnd(不能真异步时需用setTimeout包裹)，在onProcess执行后新增的buffer会全部替换成空数组，因此本回调开头应立即将newBufferIdx到本次回调结尾位置的buffer全部保存到另外一个数组内，处理完成后写回buffers中本次回调的结尾位置。\n\t\t\n\t\t//*******高级设置******\n\t\t//,disableEnvInFix:false 内部参数，禁用设备卡顿时音频输入丢失补偿功能\n\t\t\n\t\t//,takeoffEncodeChunk:NOOP //fn(chunkBytes) chunkBytes=[Uint8,...]：实时编码环境下接管编码器输出，当编码器实时编码出一块有效的二进制音频数据时实时回调此方法；参数为二进制的Uint8Array，就是编码出来的音频数据片段，所有的chunkBytes拼接在一起即为完整音频。本实现的想法最初由QQ2543775048提出\n\t\t\t\t//当提供此回调方法时，将接管编码器的数据输出，编码器内部将放弃存储生成的音频数据；环境要求比较苛刻：如果当前环境不支持实时编码处理，将在open时直接走fail逻辑\n\t\t\t\t//因此提供此回调后调用stop方法将无法获得有效的音频数据，因为编码器内没有音频数据，因此stop时返回的blob将是一个字节长度为0的blob\n\t\t\t\t//目前只有mp3格式实现了实时编码，在支持实时处理的环境中将会实时的将编码出来的mp3片段通过此方法回调，所有的chunkBytes拼接到一起即为完整的mp3，此种拼接的结果比mock方法实时生成的音质更加，因为天然避免了首尾的静默\n\t\t\t\t//目前除mp3外其他格式不可以提供此回调，提供了将在open时直接走fail逻辑\n\t};\n\t\n\tfor(var k in set){\n\t\to[k]=set[k];\n\t};\n\tthis.set=o;\n\t\n\tthis._S=9;//stop同步锁，stop可以阻止open过程中还未运行的start\n};\n//同步锁，控制对Stream的竞争；用于close时中断异步的open；一个对象open如果变化了都要阻止close，Stream的控制权交个新的对象\nRecorder.Sync={/*open*/O:9,/*close*/C:9};\n\nRecorder.prototype=initFn.prototype={\n\t//打开录音资源True(),False(msg,isUserNotAllow)，需要调用close。注意：此方法是异步的；一般使用时打开，用完立即关闭；可重复调用，可用来测试是否能录音\n\topen:function(True,False){\n\t\tvar This=this;\n\t\tTrue=True||NOOP;\n\t\tvar failCall=function(errMsg,isUserNotAllow){\n\t\t\tisUserNotAllow=!!isUserNotAllow;\n\t\t\tCLog(\"录音open失败：\"+errMsg+\",isUserNotAllow:\"+isUserNotAllow,1);\n\t\t\tFalse&&False(errMsg,isUserNotAllow);\n\t\t};\n\t\t\n\t\tvar ok=function(){\n\t\t\tCLog(\"open成功\");\n\t\t\tTrue();\n\t\t\t\n\t\t\tThis._SO=0;//解除stop对open中的start调用的阻止\n\t\t};\n\t\tvar codeFail=function(code,msg){\n\t\t\ttry{//跨域的优先检测一下\n\t\t\t\twindow.top.a;\n\t\t\t}catch(e){\n\t\t\t\tfailCall('无权录音(跨域，请尝试给iframe添加麦克风访问策略，如allow=\"camera;microphone\")');\n\t\t\t\treturn;\n\t\t\t};\n\t\t\t\n\t\t\tif(/Permission|Allow/i.test(code)){\n\t\t\t\tfailCall(\"用户拒绝了录音权限\",true);\n\t\t\t}else if(window.isSecureContext===false){\n\t\t\t\tfailCall(\"无权录音(需https)\");\n\t\t\t}else if(/Found/i.test(code)){//可能是非安全环境导致的没有设备\n\t\t\t\tfailCall(msg+\"，无可用麦克风\");\n\t\t\t}else{\n\t\t\t\tfailCall(msg);\n\t\t\t};\n\t\t};\n\t\t\n\t\t//同步锁\n\t\tvar Lock=Recorder.Sync;\n\t\tvar lockOpen=++Lock.O,lockClose=Lock.C;\n\t\tThis._O=This._O_=lockOpen;//记住当前的open，如果变化了要阻止close，这里假定了新对象已取代当前对象并且不再使用\n\t\tThis._SO=This._S;//记住open过程中的stop，中途任何stop调用后都不能继续open中的start\n\t\tvar lockFail=function(){\n\t\t\t//允许多次open，但不允许任何一次close，或者自身已经调用了关闭\n\t\t\tif(lockClose!=Lock.C || !This._O){\n\t\t\t\tvar err=\"open被取消\";\n\t\t\t\tif(lockOpen==Lock.O){\n\t\t\t\t\t//无新的open，已经调用了close进行取消，此处应让上次的close明确生效\n\t\t\t\t\tThis.close();\n\t\t\t\t}else{\n\t\t\t\t\terr=\"open被中断\";\n\t\t\t\t};\n\t\t\t\tfailCall(err);\n\t\t\t\treturn true;\n\t\t\t};\n\t\t};\n\t\t\n\t\t\n\t\t//如果已打开就不要再打开了\n\t\tif(Recorder.IsOpen()){\n\t\t\tok();\n\t\t\treturn;\n\t\t};\n\t\tif(!Recorder.Support()){\n\t\t\tcodeFail(\"\",\"此浏览器不支持录音\");\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//环境配置检查\n\t\tvar checkMsg=This.envCheck({envName:\"H5\",canProcess:true});\n\t\tif(checkMsg){\n\t\t\tfailCall(\"不能录音：\"+checkMsg);\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//请求权限，如果从未授权，一般浏览器会弹出权限请求弹框\n\t\tvar f1=function(stream){\n\t\t\tRecorder.Stream=stream;\n\t\t\tstream._call={};//此时is open，但并未connect，是允许绑定接收数据的\n\t\t\tif(lockFail())return;\n\t\t\t\n\t\t\t//https://github.com/xiangyuecn/Recorder/issues/14 获取到的track.readyState!=\"live\"，刚刚回调时可能是正常的，但过一下可能就被关掉了，原因不明。延迟一下保证真异步。对正常浏览器不影响\n\t\t\tsetTimeout(function(){\n\t\t\t\tif(lockFail())return;\n\t\t\t\t\n\t\t\t\tif(Recorder.IsOpen()){\n\t\t\t\t\tConnect();\n\t\t\t\t\tok();\n\t\t\t\t}else{\n\t\t\t\t\tfailCall(\"录音功能无效：无音频流\");\n\t\t\t\t};\n\t\t\t},100);\n\t\t};\n\t\tvar f2=function(e){\n\t\t\tvar code=e.name||e.message||e.code+\":\"+e;\n\t\t\tCLog(\"请求录音权限错误\",1,e);\n\t\t\t\n\t\t\tcodeFail(code,\"无法录音：\"+code);\n\t\t};\n\t\tvar pro=Recorder.Scope.getUserMedia({audio:true},f1,f2);\n\t\tif(pro&&pro.then){\n\t\t\tpro.then(f1)[True&&\"catch\"](f2); //fix 关键字，保证catch压缩时保持字符串形式\n\t\t};\n\t}\n\t//关闭释放录音资源\n\t,close:function(call){\n\t\tcall=call||NOOP;\n\t\t\n\t\tvar This=this;\n\t\tThis._stop();\n\t\t\n\t\tvar Lock=Recorder.Sync;\n\t\tThis._O=0;\n\t\tif(This._O_!=Lock.O){\n\t\t\t//唯一资源Stream的控制权已交给新对象，这里不能关闭。此处在每次都弹权限的浏览器内可能存在泄漏，新对象被拒绝权限可能不会调用close，忽略这种不处理\n\t\t\tCLog(\"close被忽略\",3);\n\t\t\tcall();\n\t\t\treturn;\n\t\t};\n\t\tLock.C++;//获得控制权\n\t\t\n\t\tvar stream=Recorder.Stream;\n\t\tif(stream){\n\t\t\tDisconnect();\n\t\t\t\n\t\t\tvar tracks=stream.getTracks&&stream.getTracks()||stream.audioTracks||[];\n\t\t\tfor(var i=0;i<tracks.length;i++){\n\t\t\t\tvar track=tracks[i];\n\t\t\t\ttrack.stop&&track.stop();\n\t\t\t};\n\t\t\tstream.stop&&stream.stop();\n\t\t};\n\t\t\n\t\tRecorder.Stream=0;\n\t\tCLog(\"close\");\n\t\tcall();\n\t}\n\t\n\t\n\t\n\t\n\t\n\t/*模拟一段录音数据，后面可以调用stop进行编码，需提供pcm数据[1,2,3...]，pcm的采样率*/\n\t,mock:function(pcmData,pcmSampleRate){\n\t\tvar This=this;\n\t\tThis._stop();//清理掉已有的资源\n\t\t\n\t\tThis.isMock=1;\n\t\tThis.mockEnvInfo=null;\n\t\tThis.buffers=[pcmData];\n\t\tThis.recSize=pcmData.length;\n\t\tThis.srcSampleRate=pcmSampleRate;\n\t\treturn This;\n\t}\n\t,envCheck:function(envInfo){//平台环境下的可用性检查，任何时候都可以调用检查，返回errMsg:\"\"正常，\"失败原因\"\n\t\t//envInfo={envName:\"H5\",canProcess:true}\n\t\tvar errMsg,This=this,set=This.set;\n\t\t\n\t\t//编码器检查环境下配置是否可用\n\t\tif(!errMsg){\n\t\t\tif(This[set.type+\"_envCheck\"]){//编码器已实现环境检查\n\t\t\t\terrMsg=This[set.type+\"_envCheck\"](envInfo,set);\n\t\t\t}else{//未实现检查的手动检查配置是否有效\n\t\t\t\tif(set.takeoffEncodeChunk){\n\t\t\t\t\terrMsg=set.type+\"类型不支持设置takeoffEncodeChunk\";\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t\t\n\t\treturn errMsg||\"\";\n\t}\n\t,envStart:function(mockEnvInfo,sampleRate){//平台环境相关的start调用\n\t\tvar This=this,set=This.set;\n\t\tThis.isMock=mockEnvInfo?1:0;//非H5环境需要启用mock，并提供envCheck需要的环境信息\n\t\tThis.mockEnvInfo=mockEnvInfo;\n\t\tThis.buffers=[];//数据缓冲\n\t\tThis.recSize=0;//数据大小\n\t\t\n\t\tThis.envInLast=0;//envIn接收到最后录音内容的时间\n\t\tThis.envInFirst=0;//envIn接收到的首个录音内容的录制时间\n\t\tThis.envInFix=0;//补偿的总时间\n\t\tThis.envInFixTs=[];//补偿计数列表\n\t\t\n\t\tset.sampleRate=Math.min(sampleRate,set.sampleRate);//engineCtx需要提前确定最终的采样率\n\t\tThis.srcSampleRate=sampleRate;\n\t\t\n\t\tThis.engineCtx=0;\n\t\t//此类型有边录边转码(Worker)支持\n\t\tif(This[set.type+\"_start\"]){\n\t\t\tvar engineCtx=This.engineCtx=This[set.type+\"_start\"](set);\n\t\t\tif(engineCtx){\n\t\t\t\tengineCtx.pcmDatas=[];\n\t\t\t\tengineCtx.pcmSize=0;\n\t\t\t};\n\t\t};\n\t}\n\t,envResume:function(){//和平台环境无关的恢复录音\n\t\t//重新开始计数\n\t\tthis.envInFixTs=[];\n\t}\n\t,envIn:function(pcm,sum){//和平台环境无关的pcm[Int16]输入\n\t\tvar This=this,set=This.set,engineCtx=This.engineCtx;\n\t\tvar bufferSampleRate=This.srcSampleRate;\n\t\tvar size=pcm.length;\n\t\tvar powerLevel=Recorder.PowerLevel(sum,size);\n\t\t\n\t\tvar buffers=This.buffers;\n\t\tvar bufferFirstIdx=buffers.length;//之前的buffer都是经过onProcess处理好的，不允许再修改\n\t\tbuffers.push(pcm);\n\t\t\n\t\t//有engineCtx时会被覆盖，这里保存一份\n\t\tvar buffersThis=buffers;\n\t\tvar bufferFirstIdxThis=bufferFirstIdx;\n\t\t\n\t\t//卡顿丢失补偿：因为设备很卡的时候导致H5接收到的数据量不够造成播放时候变速，结果比实际的时长要短，此处保证了不会变短，但不能修复丢失的音频数据造成音质变差。当前算法采用输入时间侦测下一帧是否需要添加补偿帧，需要(6次输入||超过1秒)以上才会开始侦测，如果滑动窗口内丢失超过1/3就会进行补偿\n\t\tvar now=Date.now();\n\t\tvar pcmTime=Math.round(size/bufferSampleRate*1000);\n\t\tThis.envInLast=now;\n\t\tif(This.buffers.length==1){//记下首个录音数据的录制时间\n\t\t\tThis.envInFirst=now-pcmTime;\n\t\t};\n\t\tvar envInFixTs=This.envInFixTs;\n\t\tenvInFixTs.splice(0,0,{t:now,d:pcmTime});\n\t\t//保留3秒的计数滑动窗口，另外超过3秒的停顿不补偿\n\t\tvar tsInStart=now,tsPcm=0;\n\t\tfor(var i=0;i<envInFixTs.length;i++){\n\t\t\tvar o=envInFixTs[i];\n\t\t\tif(now-o.t>3000){\n\t\t\t\tenvInFixTs.length=i;\n\t\t\t\tbreak;\n\t\t\t};\n\t\t\ttsInStart=o.t;\n\t\t\ttsPcm+=o.d;\n\t\t};\n\t\t//达到需要的数据量，开始侦测是否需要补偿\n\t\tvar tsInPrev=envInFixTs[1];\n\t\tvar tsIn=now-tsInStart;\n\t\tvar lost=tsIn-tsPcm;\n\t\tif( lost>tsIn/3 && (tsInPrev&&tsIn>1000 || envInFixTs.length>=6) ){\n\t\t\t//丢失过多，开始执行补偿\n\t\t\tvar addTime=now-tsInPrev.t-pcmTime;//距离上次输入丢失这么多ms\n\t\t\tif(addTime>pcmTime/5){//丢失超过本帧的1/5\n\t\t\t\tvar fixOpen=!set.disableEnvInFix;\n\t\t\t\tCLog(\"[\"+now+\"]\"+(fixOpen?\"\":\"未\")+\"补偿\"+addTime+\"ms\",3);\n\t\t\t\tThis.envInFix+=addTime;\n\t\t\t\t\n\t\t\t\t//用静默进行补偿\n\t\t\t\tif(fixOpen){\n\t\t\t\t\tvar addPcm=new Int16Array(addTime*bufferSampleRate/1000);\n\t\t\t\t\tsize+=addPcm.length;\n\t\t\t\t\tbuffers.push(addPcm);\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t\t\n\t\t\n\t\tvar sizeOld=This.recSize,addSize=size;\n\t\tvar bufferSize=sizeOld+addSize;\n\t\tThis.recSize=bufferSize;//此值在onProcess后需要修正，可能新数据被修改\n\t\t\n\t\t\n\t\t//此类型有边录边转码(Worker)支持，开启实时转码\n\t\tif(engineCtx){\n\t\t\t//转换成set的采样率\n\t\t\tvar chunkInfo=Recorder.SampleData(buffers,bufferSampleRate,set.sampleRate,engineCtx.chunkInfo);\n\t\t\tengineCtx.chunkInfo=chunkInfo;\n\t\t\t\n\t\t\tsizeOld=engineCtx.pcmSize;\n\t\t\taddSize=chunkInfo.data.length;\n\t\t\tbufferSize=sizeOld+addSize;\n\t\t\tengineCtx.pcmSize=bufferSize;//此值在onProcess后需要修正，可能新数据被修改\n\t\t\t\n\t\t\tbuffers=engineCtx.pcmDatas;\n\t\t\tbufferFirstIdx=buffers.length;\n\t\t\tbuffers.push(chunkInfo.data);\n\t\t\tbufferSampleRate=chunkInfo.sampleRate;\n\t\t};\n\t\t\n\t\tvar duration=Math.round(bufferSize/bufferSampleRate*1000);\n\t\tvar bufferNextIdx=buffers.length;\n\t\tvar bufferNextIdxThis=buffersThis.length;\n\t\t\n\t\t//允许异步处理buffer数据\n\t\tvar asyncEnd=function(){\n\t\t\t//重新计算size，异步的早已减去添加的，同步的需去掉本次添加的然后重新计算\n\t\t\tvar num=asyncBegin?0:-addSize;\n\t\t\tvar hasClear=buffers[0]==null;\n\t\t\tfor(var i=bufferFirstIdx;i<bufferNextIdx;i++){\n\t\t\t\tvar buffer=buffers[i];\n\t\t\t\tif(buffer==null){//已被主动释放内存，比如长时间实时传输录音时\n\t\t\t\t\thasClear=1;\n\t\t\t\t}else{\n\t\t\t\t\tnum+=buffer.length;\n\t\t\t\t\t\n\t\t\t\t\t//推入后台边录边转码\n\t\t\t\t\tif(engineCtx&&buffer.length){\n\t\t\t\t\t\tThis[set.type+\"_encode\"](engineCtx,buffer);\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t};\n\t\t\t\n\t\t\t//同步清理This.buffers，不管buffers到底清了多少个，buffersThis是使用不到的进行全清\n\t\t\tif(hasClear && engineCtx){\n\t\t\t\tvar i=bufferFirstIdxThis;\n\t\t\t\tif(buffersThis[0]){\n\t\t\t\t\ti=0;\n\t\t\t\t};\n\t\t\t\tfor(;i<bufferNextIdxThis;i++){\n\t\t\t\t\tbuffersThis[i]=null;\n\t\t\t\t};\n\t\t\t};\n\t\t\t\n\t\t\t//统计修改后的size，如果异步发生clear要原样加回来，同步的无需操作\n\t\t\tif(hasClear){\n\t\t\t\tnum=asyncBegin?addSize:0;\n\t\t\t\t\n\t\t\t\tbuffers[0]=null;//彻底被清理\n\t\t\t};\n\t\t\tif(engineCtx){\n\t\t\t\tengineCtx.pcmSize+=num;\n\t\t\t}else{\n\t\t\t\tThis.recSize+=num;\n\t\t\t};\n\t\t};\n\t\t//实时回调处理数据，允许修改或替换上次回调以来新增的数据 ，但是不允许修改已处理过的，不允许增删第一维数组 ，允许将第二维数组任意修改替换成空数组也可以\n\t\tvar asyncBegin=set.onProcess(buffers,powerLevel,duration,bufferSampleRate,bufferFirstIdx,asyncEnd);\n\t\t\n\t\tif(asyncBegin===true){\n\t\t\t//开启了异步模式，onProcess已接管buffers新数据，立即清空，避免出现未处理的数据\n\t\t\tvar hasClear=0;\n\t\t\tfor(var i=bufferFirstIdx;i<bufferNextIdx;i++){\n\t\t\t\tif(buffers[i]==null){//已被主动释放内存，比如长时间实时传输录音时 ，但又要开启异步模式，此种情况是非法的\n\t\t\t\t\thasClear=1;\n\t\t\t\t}else{\n\t\t\t\t\tbuffers[i]=new Int16Array(0);\n\t\t\t\t};\n\t\t\t};\n\t\t\t\n\t\t\tif(hasClear){\n\t\t\t\tCLog(\"未进入异步前不能清除buffers\",3);\n\t\t\t}else{\n\t\t\t\t//还原size，异步结束后再统计仅修改后的size，如果发生clear要原样加回来\n\t\t\t\tif(engineCtx){\n\t\t\t\t\tengineCtx.pcmSize-=addSize;\n\t\t\t\t}else{\n\t\t\t\t\tThis.recSize-=addSize;\n\t\t\t\t};\n\t\t\t};\n\t\t}else{\n\t\t\tasyncEnd();\n\t\t};\n\t}\n\t\n\t\n\t\n\t\n\t//开始录音，需先调用open；只要open成功时，调用此方法是安全的，如果未open强行调用导致的内部错误将不会有任何提示，stop时自然能得到错误\n\t,start:function(){\n\t\tif(!Recorder.IsOpen()){\n\t\t\tCLog(\"未open\",1);\n\t\t\treturn;\n\t\t};\n\t\tCLog(\"开始录音\");\n\t\t\n\t\tvar This=this,set=This.set,ctx=Recorder.Ctx;\n\t\tThis._stop();\n\t\tThis.state=0;\n\t\tThis.envStart(null,ctx.sampleRate);\n\t\t\n\t\t//检查open过程中stop是否已经调用过\n\t\tif(This._SO&&This._SO+1!=This._S){//上面调用过一次 _stop\n\t\t\t//open未完成就调用了stop，此种情况终止start。也应尽量避免出现此情况\n\t\t\tCLog(\"start被中断\",3);\n\t\t\treturn;\n\t\t};\n\t\tThis._SO=0;\n\t\t\n\t\tvar end=function(){\n\t\t\tThis.state=1;\n\t\t\tThis.resume();\n\t\t};\n\t\tif(ctx.state==\"suspended\"){\n\t\t\tctx.resume().then(function(){\n\t\t\t\tCLog(\"ctx resume\");\n\t\t\t\tend();\n\t\t\t});\n\t\t}else{\n\t\t\tend();\n\t\t};\n\t}\n\t/*暂停录音*/\n\t,pause:function(){\n\t\tvar This=this;\n\t\tif(This.state){\n\t\t\tThis.state=2;\n\t\t\tCLog(\"pause\");\n\t\t\tdelete Recorder.Stream._call[This.id];\n\t\t};\n\t}\n\t/*恢复录音*/\n\t,resume:function(){\n\t\tvar This=this;\n\t\tif(This.state){\n\t\t\tThis.state=1;\n\t\t\tCLog(\"resume\");\n\t\t\tThis.envResume();\n\t\t\t\n\t\t\tRecorder.Stream._call[This.id]=function(pcm,sum){\n\t\t\t\tif(This.state==1){\n\t\t\t\t\tThis.envIn(pcm,sum);\n\t\t\t\t};\n\t\t\t};\n\t\t};\n\t}\n\t\n\t\n\t\n\t\n\t,_stop:function(keepEngine){\n\t\tvar This=this,set=This.set;\n\t\tif(!This.isMock){\n\t\t\tThis._S++;\n\t\t};\n\t\tif(This.state){\n\t\t\tThis.pause();\n\t\t\tThis.state=0;\n\t\t};\n\t\tif(!keepEngine && This[set.type+\"_stop\"]){\n\t\t\tThis[set.type+\"_stop\"](This.engineCtx);\n\t\t\tThis.engineCtx=0;\n\t\t};\n\t}\n\t/*\n\t结束录音并返回录音数据blob对象\n\t\tTrue(blob,duration) blob：录音数据audio/mp3|wav格式\n\t\t\t\t\t\t\tduration：录音时长，单位毫秒\n\t\tFalse(msg)\n\t\tautoClose:false 可选，是否自动调用close，默认为false\n\t*/\n\t,stop:function(True,False,autoClose){\n\t\tvar This=this,set=This.set,t1;\n\t\tCLog(\"Stop \"+(This.envInLast?This.envInLast-This.envInFirst+\"ms 补\"+This.envInFix+\"ms\":\"-\"));\n\t\t\n\t\tvar end=function(){\n\t\t\tThis._stop();//彻底关掉engineCtx\n\t\t\tif(autoClose){\n\t\t\t\tThis.close();\n\t\t\t};\n\t\t};\n\t\tvar err=function(msg){\n\t\t\tCLog(\"结束录音失败：\"+msg,1);\n\t\t\tFalse&&False(msg);\n\t\t\tend();\n\t\t};\n\t\tvar ok=function(blob,duration){\n\t\t\tCLog(\"结束录音 编码\"+(Date.now()-t1)+\"ms 音频\"+duration+\"ms/\"+blob.size+\"b\");\n\t\t\tif(set.takeoffEncodeChunk){//接管了输出，此时blob长度为0\n\t\t\t\tCLog(\"启用takeoffEncodeChunk后stop返回的blob长度为0不提供音频数据\",3);\n\t\t\t}else if(blob.size<Math.max(100,duration/2)){//1秒小于0.5k？\n\t\t\t\terr(\"生成的\"+set.type+\"无效\");\n\t\t\t\treturn;\n\t\t\t};\n\t\t\tTrue&&True(blob,duration);\n\t\t\tend();\n\t\t};\n\t\tif(!This.isMock){\n\t\t\tif(!This.state){\n\t\t\t\terr(\"未开始录音\");\n\t\t\t\treturn;\n\t\t\t};\n\t\t\tThis._stop(true);\n\t\t};\n\t\tvar size=This.recSize;\n\t\tif(!size){\n\t\t\terr(\"未采集到录音\");\n\t\t\treturn;\n\t\t};\n\t\tif(!This.buffers[0]){\n\t\t\terr(\"音频被释放\");\n\t\t\treturn;\n\t\t};\n\t\tif(!This[set.type]){\n\t\t\terr(\"未加载\"+set.type+\"编码器\");\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//环境配置检查，此处仅针对mock调用，因为open已经检查过了\n\t\tif(This.isMock){\n\t\t\tvar checkMsg=This.envCheck(This.mockEnvInfo||{envName:\"mock\",canProcess:false});//没有提供环境信息的mock时没有onProcess回调\n\t\t\tif(checkMsg){\n\t\t\t\terr(\"录音错误：\"+checkMsg);\n\t\t\t\treturn;\n\t\t\t};\n\t\t};\n\t\t\n\t\t//此类型有边录边转码(Worker)支持\n\t\tvar engineCtx=This.engineCtx;\n\t\tif(This[set.type+\"_complete\"]&&engineCtx){\n\t\t\tvar duration=Math.round(engineCtx.pcmSize/set.sampleRate*1000);//采用后的数据长度和buffers的长度可能微小的不一致，是采样率连续转换的精度问题\n\t\t\t\n\t\t\tt1=Date.now();\n\t\t\tThis[set.type+\"_complete\"](engineCtx,function(blob){\n\t\t\t\tok(blob,duration);\n\t\t\t},err);\n\t\t\treturn;\n\t\t};\n\t\t\n\t\t//标准UI线程转码，调整采样率\n\t\tt1=Date.now();\n\t\tvar chunk=Recorder.SampleData(This.buffers,This.srcSampleRate,set.sampleRate);\n\t\t\n\t\tset.sampleRate=chunk.sampleRate;\n\t\tvar res=chunk.data;\n\t\tvar duration=Math.round(res.length/set.sampleRate*1000);\n\t\t\n\t\tCLog(\"采样\"+size+\"->\"+res.length+\" 花:\"+(Date.now()-t1)+\"ms\");\n\t\t\n\t\tsetTimeout(function(){\n\t\t\tt1=Date.now();\n\t\t\tThis[set.type](res,function(blob){\n\t\t\t\tok(blob,duration);\n\t\t\t},function(msg){\n\t\t\t\terr(msg);\n\t\t\t});\n\t\t});\n\t}\n\n};\n\nif(window.Recorder){\n\twindow.Recorder.Destroy();\n};\nwindow.Recorder=Recorder;\n\n//end ****copy源码结束*****\nRecorder.LM=LM;\n\n//流量统计用1像素图片地址，设置为空将不参与统计\nRecorder.TrafficImgUrl=\"//ia.51.la/go1?id=20469973&pvFlag=1\";\nRecorder.Traffic=function(){\n\tvar imgUrl=Recorder.TrafficImgUrl;\n\tif(imgUrl){\n\t\tvar data=Recorder.Traffic;\n\t\tvar idf=location.href.replace(/#.*/,\"\");\n\t\t\n\t\tif(imgUrl.indexOf(\"//\")==0){\n\t\t\t//给url加上http前缀，如果是file协议下，不加前缀没法用\n\t\t\tif(/^https:/i.test(idf)){\n\t\t\t\timgUrl=\"https:\"+imgUrl;\n\t\t\t}else{\n\t\t\t\timgUrl=\"http:\"+imgUrl;\n\t\t\t};\n\t\t};\n\t\t\n\t\tif(!data[idf]){\n\t\t\tdata[idf]=1;\n\t\t\t\n\t\t\tvar img=new Image();\n\t\t\timg.src=imgUrl;\n\t\t\tCLog(\"Traffic Analysis Image: Recorder.TrafficImgUrl=\"+Recorder.TrafficImgUrl);\n\t\t};\n\t};\n};\n\n}));","export class ByteArray {\r\n\r\n    constructor() {\r\n        this.list=[];\r\n        this.byteOffset=0;\r\n        this.length=0;\r\n    }\r\n\r\n    push(unit8Arr) {\r\n        this.list.push(unit8Arr);\r\n        this.length+=unit8Arr.length;\r\n    }\r\n\r\n    readBytes(len) {\r\n        if(len>0){\r\n            let rbuf=new Uint8Array(len);\r\n            let rbuf_ind=0;\r\n            while(rbuf_ind<len){\r\n                if(this.list.length>0){\r\n                    let tmpbuf=this.list.shift();\r\n                    let tmplen=tmpbuf.length;\r\n                    let last_len=len-rbuf_ind;\r\n                    if(tmplen>=last_len){\r\n                        //足夠了\r\n                        let tmpbuf2 = tmpbuf.subarray(0, last_len);\r\n                        rbuf.set(tmpbuf2,rbuf_ind);\r\n                        rbuf_ind+=tmpbuf2.length;\r\n                        if(last_len<tmplen){\r\n                            let newUint8Array = tmpbuf.subarray(last_len, tmplen);\r\n                            this.list.unshift(newUint8Array);\r\n                        }\r\n                        break;\r\n                    }else{\r\n                        rbuf.set(tmpbuf,rbuf_ind);\r\n                        rbuf_ind+=tmplen;\r\n                    }\r\n                }else{\r\n                    rbuf=rbuf.subarray(0, rbuf_ind);\r\n                    break;\r\n                }\r\n            }\r\n            this.length-=rbuf.length;\r\n            return rbuf;\r\n        }\r\n        return null;\r\n    }\r\n\r\n}","\r\nexport class Util {\r\n    static isEmptyString(str) {\r\n        if (str == undefined || str == null || str == \"\") {\r\n            return true;\r\n        }\r\n        else {\r\n            return false;\r\n        }\r\n    }\r\n}","import {GPlayerEvent, GErrorType, GPlaybackControlStatus} from './player/gplayer-events';\r\nimport {GTalkerEvent, GTalkerConnectStatus, GTalkerConnectErrorType} from './talker/gtalker-events';\r\nimport {GPlayer} from './player/gplayer.js';\r\nimport { HttpFlvPlayer } from './player/httpflv-player.js';\r\nimport { HttpFlvTalker } from './talker/httpflv-talker.js';\r\n\r\nfunction createPlayer(url, config = null) {\r\n  let player = new HttpFlvPlayer();\r\n  player.init(url, config);\r\n  return player;\r\n}\r\n\r\nfunction createTalker(downUrl, upUrl, imei, channel, config = null) {\r\n  let talker = new HttpFlvTalker();\r\n  if (!talker.init(downUrl, upUrl, imei, channel, config)) {\r\n    return null;\r\n  }\r\n  return talker;\r\n}\r\n\r\nfunction isHttpFlvSupported() {\r\n  return HttpFlvPlayer.isSupported();\r\n}\r\n\r\nfunction isTalkSupported() {\r\n  return HttpFlvTalker.isSupported();\r\n}\r\n\r\nlet gmediajs = {};\r\n\r\ngmediajs.createPlayer = createPlayer;\r\ngmediajs.isHttpFlvSupported = isHttpFlvSupported;\r\ngmediajs.HttpFlvPlayer = HttpFlvPlayer;\r\ngmediajs.GPlayerEvent = GPlayerEvent;\r\ngmediajs.GErrorType = GErrorType;\r\ngmediajs.GPlaybackControlStatus = GPlaybackControlStatus;\r\n\r\ngmediajs.createTalker = createTalker;\r\ngmediajs.isTalkSupported = isTalkSupported;\r\ngmediajs.HttpFlvTalker = HttpFlvTalker;\r\ngmediajs.GTalkerEvent = GTalkerEvent;\r\ngmediajs.GTalkerConnectStatus = GTalkerConnectStatus;\r\ngmediajs.GTalkerConnectErrorType = GTalkerConnectErrorType;\r\n\r\nexport default gmediajs;","module.exports = require('./gmedia.js').default;","export const GPlayerEvent = {\r\n    ERROR: 'error',\r\n    MEDIA_SOURCE_END: 'media_source_end',\r\n    TIMEUPDATE: 'timeupdate',\r\n    STATISTICS_INFO: 'statistics_info',\r\n    PLAYBACK_CONTROL_EVENT: 'playback_control_event'\r\n};\r\n\r\nexport const GErrorType = {\r\n    NETWORK_ERROR: 'NetworkError',\r\n    MEDIA_ERROR: 'MediaError',\r\n    OTHER_ERROR: 'OtherError'\r\n};\r\n\r\nexport const GPlaybackControlStatus = {\r\n    SeekStart: 0,\r\n    SeekFail: 1,\r\n    SeekSuccess: 2\r\n};\r\n","export class GPlayer {\r\n\r\n    constructor(typeName) {\r\n        this._type = typeName || 'undefined';\r\n    }\r\n\r\n    init(url, config) {\r\n    }\r\n\r\n    on(event, call) {\r\n\r\n    }\r\n\r\n    off(event) {\r\n\r\n    }\r\n\r\n    attachMediaElement(mediaElement) {  \r\n    }\r\n\r\n    load() {\r\n    }\r\n\r\n    play() {\r\n\r\n    }\r\n\r\n    capture() {\r\n\r\n    }\r\n\r\n    pause() {\r\n        \r\n    }\r\n\r\n    resume() {\r\n        \r\n    }\r\n\r\n    seekToNewestTime () {\r\n\r\n    }\r\n\r\n    seek(time) {\r\n\r\n    }\r\n\r\n    destroy() {\r\n\r\n    }\r\n\r\n}","import {GPlayerEvent, GErrorType, GPlaybackControlStatus} from \"./gplayer-events.js\"\r\nimport {GPlayer} from \"./gplayer.js\"\r\nimport flvjs from \"flv-g7.js\";\r\n\r\nconst PlaybackKey = \"g7-flv-video-playback\";\r\n\r\nconst PlaybackControl = {\r\n    None:0,\r\n    Active:1,\r\n    Passive:2\r\n}\r\n\r\nexport class HttpFlvPlayer extends GPlayer {\r\n\r\n    constructor () {\r\n        super('httpflv-player');\r\n        this.TAG = 'HttpFlvPlayer';\r\n        \r\n        this.player = null;\r\n        this.element = null;\r\n        this.isLive = true;\r\n\r\n        this.playbackPlan = 1;\r\n        this.playbackControl = PlaybackControl.None;\r\n\r\n        this.streamEnd = false;\r\n        this.needSeek = false;\r\n        this.seeking = false;\r\n        this.seekTime = 0;\r\n        this.newPlayStartTime = 0;\r\n        this.lastSendSeekTs = 0;\r\n\r\n        this.callbackTimeUpdate = null;\r\n        this.callbackStatistics = null;\r\n        this.callbackError = null;\r\n        this.callbackMediaSourceEnd = null;\r\n        this.callbackPlaybackControlEvent = null;\r\n\r\n        this.checkerSeek = null;\r\n\r\n        this.e = {\r\n            onTimeUpdate : this._onElementTime.bind(this)\r\n        };\r\n    }\r\n\r\n    static isSupported() {\r\n        return window.MediaSource &&\r\n            window.MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"');\r\n    }\r\n\r\n    init (url, config) {\r\n        this._checkConfig(config);\r\n        this.isLive = this._checkIfLive(url);  \r\n        this.playbackControl = this._checkPlaybackControl(url);  \r\n\r\n        this.player = flvjs.createPlayer({isLive:this.isLive, type:'flv',url:url}, {\r\n            lazyLoad: false,\r\n            enableStashBuffer: false,\r\n            deferLoadAfterSourceOpen:true\r\n        });\r\n\r\n        this.player.on(flvjs.Events.STATISTICS_INFO, this._onStatisticsInfo.bind(this));\r\n        this.player.on(flvjs.Events.ERROR, this._onError.bind(this));\r\n        this.player.setMediaSourceEndCallback(this._onMediaSourceEnd.bind(this));\r\n        this.player.setStreamTimeCallback(this._onStreamTime.bind(this));\r\n    }\r\n\r\n    on(event, call) {\r\n        if (event === GPlayerEvent.TIMEUPDATE) {\r\n            this.callbackTimeUpdate = call;\r\n        }\r\n        else if (event === GPlayerEvent.STATISTICS_INFO) {\r\n            this.callbackStatistics = call;\r\n        }\r\n        else if (event === GPlayerEvent.ERROR) {\r\n            this.callbackError = call;\r\n        }\r\n        else if (event === GPlayerEvent.MEDIA_SOURCE_END) {\r\n            this.callbackMediaSourceEnd = call;\r\n        }\r\n        else if (event === GPlayerEvent.PLAYBACK_CONTROL_EVENT) {\r\n            this.callbackPlaybackControlEvent = call;\r\n        }\r\n    }\r\n\r\n    off(event) {\r\n        if (event === GPlayerEvent.TIMEUPDATE) {\r\n            this.callbackTimeUpdate = null;\r\n        }\r\n        else if (event === GPlayerEvent.STATISTICS_INFO) {\r\n            this.callbackStatistics = null;\r\n        }\r\n        else if (event === GPlayerEvent.ERROR) {\r\n            this.callbackError = null;\r\n        }\r\n        else if (event === GPlayerEvent.MEDIA_SOURCE_END) {\r\n            this.callbackMediaSourceEnd = null;\r\n        }\r\n        else if (event === GPlayerEvent.PLAYBACK_CONTROL_EVENT) {\r\n            this.callbackPlaybackControlEvent = null;\r\n        }\r\n    }\r\n\r\n    attachMediaElement(el) {\r\n        this.element = el;\r\n        this.element.addEventListener(\"timeupdate\", this.e.onTimeUpdate);\r\n        this.player.attachMediaElement(el);\r\n    }\r\n\r\n    load() {\r\n        this.player.load();\r\n    }\r\n\r\n    play() {\r\n        this.player.play();\r\n    }\r\n\r\n    capture() {\r\n        let canvas = document.createElement(\"canvas\");\r\n        canvas.width = this.element.videoWidth;\r\n        canvas.height = this.element.videoHeight;\r\n        canvas.getContext('2d').drawImage(this.element, 0, 0, canvas.width, canvas.height);\r\n        let dataurl = canvas.toDataURL();\r\n        return dataurl;\r\n    }\r\n\r\n    pause() {\r\n        this.element.pause();\r\n        return false;\r\n    }\r\n\r\n    resume() {\r\n        this.element.play();\r\n        return false;\r\n    }\r\n\r\n    seekToNewestTime () {\r\n        let buffered = this.element.buffered;\r\n        if (buffered.length > 0) { \r\n            let from = buffered.start(buffered.length -1);\r\n            let to = buffered.end(buffered.length -1);\r\n            this.element.currentTime = to;\r\n        }\r\n    }\r\n\r\n    seek(time) {\r\n        if (this.element == null) {\r\n            return false;\r\n        }\r\n        if (this.seeking) {\r\n            return false;\r\n        }\r\n        \r\n        if (this.callbackPlaybackControlEvent != null) {\r\n            this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekStart, \r\n                \"开始切换播放时间\");\r\n        }\r\n\r\n        if (!this._seekByCached(time)) {\r\n            return false;\r\n        }\r\n        if (this.playbackControl == PlaybackControl.Active) {\r\n            this._seekByActive(time);\r\n        }\r\n        else {\r\n            this._seekByPassive(time);\r\n        }\r\n        return true;\r\n    }\r\n\r\n    destroy() {\r\n        if (this.player != null) {\r\n            this.player.pause();\r\n            this.player.unload();\r\n            this.player.detachMediaElement();\r\n            this.player.destroy();\r\n            this.player = null;\r\n        }\r\n\r\n        if (this.element != null) {\r\n            this.element.removeEventListener(\"timeupdate\", this.e.onTimeUpdate);\r\n            this.element = null;\r\n        }\r\n    }\r\n\r\n    _checkConfig(config) {\r\n        if (config == null) {\r\n            return;\r\n        }\r\n\r\n        if (config.playbackPlan != null) {\r\n            this.playbackPlan = config.playbackPlan;\r\n        }\r\n    }\r\n\r\n    _checkIfLive(url) {\r\n        if (url.indexOf(PlaybackKey) != -1) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    _checkPlaybackControl(url) {\r\n        let arr = url.split('&stream=');\r\n        if (arr.length < 2 || arr[1].length < 3) {\r\n            return PlaybackControl.None;\r\n        }\r\n        let streamName = arr[1];\r\n        let deviceType = streamName.substring(0,3);\r\n        if (deviceType == '131') {\r\n            return PlaybackControl.Passive;\r\n        }\r\n        return PlaybackControl.Active;\r\n    }\r\n\r\n    _seekByCached(time) {\r\n        if (!this.streamEnd) {\r\n            return true;\r\n        }\r\n\r\n        this.seeking = true;\r\n\r\n        let bCached = false;\r\n        let buffered = this.element.buffered;\r\n        for (let i = 0; i < buffered.length; i++) {\r\n            let from = buffered.start(i);\r\n            let to = buffered.end(i);\r\n            if (time > from && time < to) {\r\n                bCached = true;\r\n            }\r\n        }\r\n\r\n        if (bCached && time > this.element.currentTime) {\r\n            this.element.currentTime = time;\r\n            if (this.callbackPlaybackControlEvent != null) {\r\n                this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekSuccess,\r\n                    \"切换播放时间成功\");\r\n            }\r\n        }\r\n        else {\r\n            if (this.callbackPlaybackControlEvent != null) {\r\n                this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekFail,\r\n                    \"缓冲流已结束，无法切换到未缓冲区域\");\r\n            }\r\n        }\r\n\r\n        this.seeking = false;\r\n        return false;\r\n    }\r\n\r\n    _seekByActive(time) {\r\n        this.seeking = true;\r\n\r\n        this.lastSendSeekTs = new Date().getTime();\r\n\r\n        this.checkerSeek = setTimeout(()=>{\r\n            this.needSeek = false;\r\n            this.seeking = false;\r\n            if (this.callbackPlaybackControlEvent != null) {\r\n                this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekFail,\r\n                    \"切换播放时间失败，请重新尝试\");\r\n            }\r\n        },15*1000);\r\n\r\n        this.seekTime = time;\r\n        this.needSeek = true;\r\n    }\r\n\r\n    _seekByPassive(time) {\r\n        this.seeking = true;\r\n\r\n        this.seekTime = time;\r\n        //获取当前video标签解码缓存\r\n        let buffered = this.element.buffered;\r\n        if (buffered.length > 0) { \r\n            //由设备端控制回放的buffered只会产生一段\r\n            let from = buffered.start(0);\r\n            let to = buffered.end(0);\r\n            this.newPlayStartTime = to;\r\n\r\n            this.element.currentTime = this.newPlayStartTime;\r\n        }\r\n\r\n        setTimeout(()=>{\r\n            this.seeking = false;\r\n            if (this.callbackPlaybackControlEvent != null) {\r\n                this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekSuccess,\r\n                    \"切换播放时间成功\");\r\n            }\r\n        },1000);\r\n    }\r\n\r\n    _onStatisticsInfo(data) {\r\n        if (this.callbackStatistics != null) {\r\n            let info = {};\r\n            info.speed = data.speed;\r\n            this.callbackStatistics(info);\r\n        }\r\n    }\r\n\r\n    _onError(type, detail, errObj) {\r\n        if (this.callbackError != null) {\r\n            let gtype = type;\r\n            let gsubtype = detail;\r\n            let info = type;\r\n            this.callbackError(type, gsubtype, info);\r\n        }\r\n    }\r\n\r\n    _onMediaSourceEnd(info) {\r\n        this.streamEnd = true;\r\n        if (this.callbackMediaSourceEnd != null) {\r\n            this.callbackMediaSourceEnd();\r\n        }\r\n    }\r\n\r\n    _onElementTime(event) {\r\n        //回放方案1\r\n        if (this.playbackPlan == 1) {\r\n            if (this.callbackTimeUpdate != null && this.element != null) {\r\n                this.callbackTimeUpdate(this.element.currentTime);\r\n            }\r\n            return;\r\n        }\r\n\r\n        //回放方案2\r\n        if (this.playbackControl === PlaybackControl.Active) {\r\n            if (!this.seeking && this.callbackTimeUpdate != null && this.element != null) {\r\n                this.callbackTimeUpdate(this.element.currentTime);\r\n            }\r\n        }\r\n        else if (this.playbackControl === PlaybackControl.Passive) {\r\n            if (!this.seeking && this.callbackTimeUpdate != null && this.element != null) {\r\n                let curPlayTime = this.seekTime + (this.element.currentTime - this.newPlayStartTime);\r\n                this.callbackTimeUpdate(curPlayTime);\r\n            }\r\n        }\r\n    }\r\n\r\n    _onStreamTime(time) {\r\n        if (this.needSeek) {\r\n            if (Math.abs(this.seekTime*1000 - time) >= 1000) {\r\n                return;\r\n            }\r\n\r\n            if (this.checkerSeek != null) {\r\n                clearTimeout(this.checkerSeek);\r\n                this.checkerSeek = null;\r\n            }\r\n\r\n            this.needSeek = false;\r\n            setTimeout(()=>{\r\n                this.seeking = false;\r\n                this.element.currentTime = time/1000;\r\n                let off = new Date().getTime() - this.lastSendSeekTs;\r\n                console.log(\"切换耗时: \" + off);\r\n                if (this.callbackPlaybackControlEvent != null) {\r\n                    this.callbackPlaybackControlEvent(GPlaybackControlStatus.SeekSuccess,\r\n                        \"切换播放时间成功\");\r\n                }\r\n            },1000);\r\n            return;\r\n        }\r\n    }\r\n}\r\n\r\n","export const GTalkerEvent = {\r\n    CONNECT_STATUS: 'connect_status'\r\n};\r\n\r\nexport const GTalkerConnectStatus = {\r\n    ConnectSuccess: 'ConnectSuccess',\r\n    ConnectError: 'ConnectError'\r\n};\r\n\r\nexport const GTalkerConnectErrorType = {\r\n    DeviceNotResponding: 'DeviceNotResponding',\r\n    DeviceStopedResponding: 'DeviceStopedResponding',\r\n    DownLinkFail: 'DownLinkFail',\r\n    UpLinkFail: 'UpLinkFail',\r\n    WaitOpenMicrophoneTimeout: 'WaitOpenMicrophoneTimeout',\r\n    NotAllowOpenMicrophone: 'NotAllowOpenMicrophone'\r\n};","export class GTalker {\r\n\r\n    constructor(typeName) {\r\n        this._type = typeName || 'undefined';\r\n    }\r\n\r\n    init(downUrl, upUrl, imei, channel, config) {\r\n    }\r\n\r\n    on(event, call) {\r\n\r\n    }\r\n\r\n    off(event) {\r\n\r\n    }\r\n\r\n    attachMediaElement(element) {  \r\n    }\r\n\r\n    load() {\r\n    }\r\n\r\n    destroy() {\r\n\r\n    }\r\n\r\n}","import {GTalkerEvent, GTalkerConnectStatus, GTalkerConnectErrorType} from \"./gtalker-events.js\"\r\nimport {GTalker} from \"./gtalker.js\"\r\nimport {ByteArray} from \"../common/bytearray.js\"\r\nimport {Util} from \"../common/util.js\"\r\n\r\nimport flvjs from \"flv-g7.js\";\r\n\r\nimport Recorder from 'recorder-core'\r\nimport 'recorder-core/src/engine/mp3'\r\nimport 'recorder-core/src/engine/mp3-engine'\r\n\r\nconst AudioBufLen = 640;\r\nconst DebugFlag = false;\r\n\r\nexport class HttpFlvTalker extends GTalker {\r\n\r\n    constructor () {\r\n        super('httpflv-talker');\r\n        this.TAG = 'HttpFlvTalker';\r\n\r\n        this.downUrl = null;\r\n        this.upUrl = null;\r\n        this.imei = null;\r\n        this.channel = null;\r\n        \r\n        this.player = null;\r\n        this.recorder = null;\r\n        this.sender = null;\r\n        this.element = null;\r\n\r\n        this.callbackConnectStatus = null;\r\n\r\n        this.byteArray = new ByteArray();\r\n\r\n        this.timerCheck = null;\r\n        this.timerSend = null;\r\n\r\n        this.hasReceiveServerData = false;\r\n        this.hasSendClientData = false;\r\n        this.hasWaitOpenMicrophoneTimeout = false;\r\n        this.hasDestory = false;\r\n    }\r\n\r\n    static isSupported() {\r\n        return typeof WebSocket != 'undefined' && Recorder.Support() && window.MediaSource &&\r\n            window.MediaSource.isTypeSupported('video/mp4; codecs=\"avc1.42E01E,mp4a.40.2\"');\r\n    }\r\n\r\n    init(downUrl, upUrl, imei, channel, config) {\r\n        this.downUrl = downUrl;\r\n        this.upUrl = upUrl;\r\n        this.imei = imei;\r\n        this.channel = channel;\r\n        if (!this._checkInputParam()) {\r\n            return false;\r\n        }\r\n\r\n        this._startPlayer(downUrl);\r\n        return true;\r\n    }\r\n\r\n    on(event, call) {\r\n        if (event === GTalkerEvent.CONNECT_STATUS) {\r\n            this.callbackConnectStatus = call;\r\n        }\r\n    }\r\n\r\n    off(event) {\r\n        if (event === GTalkerEvent.CONNECT_STATUS) {\r\n            this.callbackConnectStatus = null;\r\n        }\r\n    }\r\n\r\n    attachMediaElement(element) {  \r\n        this.element = element;\r\n\r\n        this.element.addEventListener(\"loadeddata\", this._onPlayerLoadedData.bind(this), {once: true});\r\n        this.player.on(flvjs.Events.ERROR, this._onPlayerError.bind(this));\r\n        this.player.setMediaSourceEndCallback(this._onPlayerMediaSourceEnd.bind(this));\r\n\r\n        this.player.attachMediaElement(element);\r\n    }\r\n\r\n    load() {\r\n        this.player.load();\r\n        this._startSender(this.upUrl);\r\n    }\r\n\r\n    destroy() {\r\n        this.hasDestory = true;\r\n\r\n        this._destroyPlayer();\r\n        this._destroySender();\r\n        this._destroyRecorder();\r\n        this._destroySendProc();\r\n    }\r\n\r\n    _checkInputParam() {\r\n        if (Util.isEmptyString(this.downUrl) || Util.isEmptyString(this.upUrl)) {\r\n            return false;\r\n        }\r\n        if (Util.isEmptyString(this.imei)) {\r\n            return false;\r\n        }\r\n        if (this.channel < 0 || this.channel > 255) {\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n\r\n    _startPlayer(url) {\r\n        this._destroyPlayer();\r\n\r\n        this.player = flvjs.createPlayer({isLive:true, type:'flv',url:url}, {\r\n            lazyLoad: false,\r\n            enableStashBuffer: false,\r\n            deferLoadAfterSourceOpen:true\r\n        });\r\n    }\r\n\r\n    _onPlayerLoadedData() {\r\n        if (DebugFlag) {\r\n            console.log(\"player loadedData\");\r\n        }\r\n\r\n        this.hasReceiveServerData = true;\r\n        if (this.hasSendClientData && this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectSuccess, \"\");\r\n        }\r\n    }\r\n\r\n    _onPlayerError(type, detail, errObj) {\r\n        if (DebugFlag) {\r\n            console.log(\"player error\");\r\n        }\r\n\r\n        if (this.callbackConnectStatus == null) {\r\n            return;\r\n        }\r\n\r\n        if (this.hasReceiveServerData) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.DownLinkFail);\r\n        }\r\n        else {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.DeviceNotResponding);\r\n        }\r\n    }\r\n\r\n    _onPlayerMediaSourceEnd(info) {\r\n        if (DebugFlag) {\r\n            console.log(\"player source end\");\r\n        }\r\n\r\n        if (this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.DeviceStopedResponding);\r\n        }\r\n    }\r\n\r\n    _destroyPlayer() {\r\n        if (this.player != null) {\r\n            this.player.pause();\r\n            this.player.unload();\r\n            this.player.detachMediaElement();\r\n            this.player.destroy();\r\n            this.player = null;\r\n        }\r\n\r\n        if (this.element != null) {\r\n            this.element = null;\r\n        }\r\n    }\r\n\r\n    _startSender(url) {\r\n        this.sender = new WebSocket(url);\r\n        this.sender.onopen = this._onSenderOpen.bind(this);\r\n        this.sender.onmessage = this._onSenderMsg.bind(this);\r\n        this.sender.onclose = this._onSenderClose.bind(this);\r\n        this.sender.onerror = this._onSenderError.bind(this);\r\n    }\r\n\r\n    _onSenderOpen() {\r\n        if (DebugFlag) {\r\n            console.log(\"websocket open\");\r\n        }\r\n        \r\n        this._startRecorder();\r\n    }\r\n\r\n    _onSenderMsg(e) {\r\n        \r\n    }\r\n\r\n    _onSenderClose(e) {\r\n        if (DebugFlag) {\r\n            console.log(\"websocket close\");\r\n        }\r\n\r\n        if (this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.UpLinkFail);\r\n        }\r\n    }\r\n\r\n    _onSenderError(e) {\r\n        if (DebugFlag) {\r\n            console.log(\"websocket error\");\r\n        }\r\n    }\r\n\r\n    _destroySender() {\r\n        this.sender.close();\r\n        this.sender = null;\r\n    }\r\n\r\n    _startRecorder() {\r\n        if (this.recorder) {\r\n            this.recorder.close();\r\n        }\r\n\r\n        this.recorder = Recorder({\r\n            type:\"mp3\",\r\n            sampleRate:8000,\r\n            bitRate:16,\r\n            onProcess:this._onReceiveMicrophoneData.bind(this)\r\n        });\r\n        this.timerCheck = setTimeout(this._timeoutCheckIfAllowOpenMicrophone.bind(this),10000);\r\n        this.recorder.open(this._onAllowOpenMicrophone.bind(this),\r\n            this._onNotAllowOpenMicrophone.bind(this));\r\n    }\r\n\r\n    _timeoutCheckIfAllowOpenMicrophone() {\r\n        if (DebugFlag) {\r\n            console.log(\"user WaitOpenMicrophone Timeout\");\r\n        }\r\n\r\n        this.hasWaitOpenMicrophoneTimeout = true;\r\n\r\n        if (this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.WaitOpenMicrophoneTimeout);\r\n        }\r\n    }\r\n\r\n    _onAllowOpenMicrophone() {\r\n        if (DebugFlag) {\r\n            console.log(\"user AllowOpenMicrophone\");\r\n        }\r\n\r\n        if (this.hasWaitOpenMicrophoneTimeout) {\r\n            return;\r\n        }\r\n\r\n        clearTimeout(this.timerCheck);\r\n\r\n        this.hasSendClientData = true;\r\n        if (this.hasReceiveServerData && this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectSuccess, \"\");\r\n        }\r\n\r\n        this.recorder.start();\r\n        this._sendProc();\r\n    }\r\n\r\n    _onNotAllowOpenMicrophone(msg, isUserNotAllow) {\r\n        if (DebugFlag) {\r\n            console.log(\"user NotAllowOpenMicrophone\");\r\n        }\r\n\r\n        clearTimeout(this.timerCheck);\r\n\r\n        if (this.callbackConnectStatus != null) {\r\n            this.callbackConnectStatus(GTalkerConnectStatus.ConnectError, \r\n                GTalkerConnectErrorType.NotAllowOpenMicrophone);\r\n        }\r\n    }\r\n\r\n    _onReceiveMicrophoneData(buffers, powerLevel, bufferDuration, bufferSampleRate) {\r\n        let arrayBuf = buffers[buffers.length - 1].buffer; //Uint16Array To ArrayBuffer\r\n        let u8buf = new Uint8Array(arrayBuf); //ArrayBuffer To Uint8Array\r\n        this.byteArray.push(u8buf);\r\n    }\r\n\r\n    _destroyRecorder() {\r\n        this.recorder.close();\r\n        this.recorder = null;\r\n    }\r\n\r\n    _sendProc() {\r\n        if (this.hasDestory) {\r\n            return;\r\n        }\r\n\r\n        if (this.byteArray.length < AudioBufLen) {\r\n            this.timerSend = setTimeout(this._sendProc.bind(this), 5);\r\n        }\r\n        else {\r\n            let audioBuf = this.byteArray.readBytes(AudioBufLen);\r\n\r\n            let packer = new ByteArray();\r\n            packer.push(new Uint8Array([0x31,0x32,0x63,0x64]));\r\n            let arrImeiChar = this.imei.split('');\r\n            for (let i = 0; i < arrImeiChar.length; i++) {\r\n                packer.push(new Uint8Array([arrImeiChar[i].charCodeAt()]));\r\n            }\r\n            packer.push(new Uint8Array([parseInt(this.channel)]));\r\n            packer.push(new Uint8Array([Math.floor(AudioBufLen/256)]));\r\n            packer.push(new Uint8Array([AudioBufLen%256]));\r\n            packer.push(audioBuf);\r\n\r\n            let totalLen = 4 + arrImeiChar.length + 3 + AudioBufLen;\r\n            if (this.sender != null) {\r\n                this.sender.send(packer.readBytes(totalLen));\r\n            }\r\n\r\n            this._sendProc();\r\n        }\r\n    }\r\n\r\n    _destroySendProc() {\r\n        clearTimeout(this.timerSend);\r\n    }\r\n}"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvZmx2LWc3LmpzL2Rpc3QvZmx2LmpzIiwibm9kZV9tb2R1bGVzL3JlY29yZGVyLWNvcmUvc3JjL2VuZ2luZS9tcDMtZW5naW5lLmpzIiwibm9kZV9tb2R1bGVzL3JlY29yZGVyLWNvcmUvc3JjL2VuZ2luZS9tcDMuanMiLCJub2RlX21vZHVsZXMvcmVjb3JkZXItY29yZS9zcmMvcmVjb3JkZXItY29yZS5qcyIsInNyYy9jb21tb24vYnl0ZWFycmF5LmpzIiwic3JjL2NvbW1vbi91dGlsLmpzIiwic3JjL2dtZWRpYS5qcyIsInNyYy9pbmRleC5qcyIsInNyYy9wbGF5ZXIvZ3BsYXllci1ldmVudHMuanMiLCJzcmMvcGxheWVyL2dwbGF5ZXIuanMiLCJzcmMvcGxheWVyL2h0dHBmbHYtcGxheWVyLmpzIiwic3JjL3RhbGtlci9ndGFsa2VyLWV2ZW50cy5qcyIsInNyYy90YWxrZXIvZ3RhbGtlci5qcyIsInNyYy90YWxrZXIvaHR0cGZsdi10YWxrZXIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNyNFhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzUxYkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdmFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7SUNsM0JhLFMsV0FBQSxTO0FBRVQseUJBQWM7QUFBQTs7QUFDVixhQUFLLElBQUwsR0FBVSxFQUFWO0FBQ0EsYUFBSyxVQUFMLEdBQWdCLENBQWhCO0FBQ0EsYUFBSyxNQUFMLEdBQVksQ0FBWjtBQUNIOzs7OzZCQUVJLFEsRUFBVTtBQUNYLGlCQUFLLElBQUwsQ0FBVSxJQUFWLENBQWUsUUFBZjtBQUNBLGlCQUFLLE1BQUwsSUFBYSxTQUFTLE1BQXRCO0FBQ0g7OztrQ0FFUyxHLEVBQUs7QUFDWCxnQkFBRyxNQUFJLENBQVAsRUFBUztBQUNMLG9CQUFJLE9BQUssSUFBSSxVQUFKLENBQWUsR0FBZixDQUFUO0FBQ0Esb0JBQUksV0FBUyxDQUFiO0FBQ0EsdUJBQU0sV0FBUyxHQUFmLEVBQW1CO0FBQ2Ysd0JBQUcsS0FBSyxJQUFMLENBQVUsTUFBVixHQUFpQixDQUFwQixFQUFzQjtBQUNsQiw0QkFBSSxTQUFPLEtBQUssSUFBTCxDQUFVLEtBQVYsRUFBWDtBQUNBLDRCQUFJLFNBQU8sT0FBTyxNQUFsQjtBQUNBLDRCQUFJLFdBQVMsTUFBSSxRQUFqQjtBQUNBLDRCQUFHLFVBQVEsUUFBWCxFQUFvQjtBQUNoQjtBQUNBLGdDQUFJLFVBQVUsT0FBTyxRQUFQLENBQWdCLENBQWhCLEVBQW1CLFFBQW5CLENBQWQ7QUFDQSxpQ0FBSyxHQUFMLENBQVMsT0FBVCxFQUFpQixRQUFqQjtBQUNBLHdDQUFVLFFBQVEsTUFBbEI7QUFDQSxnQ0FBRyxXQUFTLE1BQVosRUFBbUI7QUFDZixvQ0FBSSxnQkFBZ0IsT0FBTyxRQUFQLENBQWdCLFFBQWhCLEVBQTBCLE1BQTFCLENBQXBCO0FBQ0EscUNBQUssSUFBTCxDQUFVLE9BQVYsQ0FBa0IsYUFBbEI7QUFDSDtBQUNEO0FBQ0gseUJBVkQsTUFVSztBQUNELGlDQUFLLEdBQUwsQ0FBUyxNQUFULEVBQWdCLFFBQWhCO0FBQ0Esd0NBQVUsTUFBVjtBQUNIO0FBQ0oscUJBbEJELE1Ba0JLO0FBQ0QsK0JBQUssS0FBSyxRQUFMLENBQWMsQ0FBZCxFQUFpQixRQUFqQixDQUFMO0FBQ0E7QUFDSDtBQUNKO0FBQ0QscUJBQUssTUFBTCxJQUFhLEtBQUssTUFBbEI7QUFDQSx1QkFBTyxJQUFQO0FBQ0g7QUFDRCxtQkFBTyxJQUFQO0FBQ0g7Ozs7Ozs7Ozs7Ozs7Ozs7O0lDNUNRLEksV0FBQSxJOzs7Ozs7O3NDQUNZLEcsRUFBSztBQUN0QixnQkFBSSxPQUFPLFNBQVAsSUFBb0IsT0FBTyxJQUEzQixJQUFtQyxPQUFPLEVBQTlDLEVBQWtEO0FBQzlDLHVCQUFPLElBQVA7QUFDSCxhQUZELE1BR0s7QUFDRCx1QkFBTyxLQUFQO0FBQ0g7QUFDSjs7Ozs7Ozs7Ozs7OztBQ1RMOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBLFNBQVMsWUFBVCxDQUFzQixHQUF0QixFQUEwQztBQUFBLE1BQWYsTUFBZSx1RUFBTixJQUFNOztBQUN4QyxNQUFJLFNBQVMsSUFBSSw0QkFBSixFQUFiO0FBQ0EsU0FBTyxJQUFQLENBQVksR0FBWixFQUFpQixNQUFqQjtBQUNBLFNBQU8sTUFBUDtBQUNEOztBQUVELFNBQVMsWUFBVCxDQUFzQixPQUF0QixFQUErQixLQUEvQixFQUFzQyxJQUF0QyxFQUE0QyxPQUE1QyxFQUFvRTtBQUFBLE1BQWYsTUFBZSx1RUFBTixJQUFNOztBQUNsRSxNQUFJLFNBQVMsSUFBSSw0QkFBSixFQUFiO0FBQ0EsTUFBSSxDQUFDLE9BQU8sSUFBUCxDQUFZLE9BQVosRUFBcUIsS0FBckIsRUFBNEIsSUFBNUIsRUFBa0MsT0FBbEMsRUFBMkMsTUFBM0MsQ0FBTCxFQUF5RDtBQUN2RCxXQUFPLElBQVA7QUFDRDtBQUNELFNBQU8sTUFBUDtBQUNEOztBQUVELFNBQVMsa0JBQVQsR0FBOEI7QUFDNUIsU0FBTyw2QkFBYyxXQUFkLEVBQVA7QUFDRDs7QUFFRCxTQUFTLGVBQVQsR0FBMkI7QUFDekIsU0FBTyw2QkFBYyxXQUFkLEVBQVA7QUFDRDs7QUFFRCxJQUFJLFdBQVcsRUFBZjs7QUFFQSxTQUFTLFlBQVQsR0FBd0IsWUFBeEI7QUFDQSxTQUFTLGtCQUFULEdBQThCLGtCQUE5QjtBQUNBLFNBQVMsYUFBVCxHQUF5Qiw0QkFBekI7QUFDQSxTQUFTLFlBQVQsR0FBd0IsMkJBQXhCO0FBQ0EsU0FBUyxVQUFULEdBQXNCLHlCQUF0QjtBQUNBLFNBQVMsc0JBQVQsR0FBa0MscUNBQWxDOztBQUVBLFNBQVMsWUFBVCxHQUF3QixZQUF4QjtBQUNBLFNBQVMsZUFBVCxHQUEyQixlQUEzQjtBQUNBLFNBQVMsYUFBVCxHQUF5Qiw0QkFBekI7QUFDQSxTQUFTLFlBQVQsR0FBd0IsMkJBQXhCO0FBQ0EsU0FBUyxvQkFBVCxHQUFnQyxtQ0FBaEM7QUFDQSxTQUFTLHVCQUFULEdBQW1DLHNDQUFuQzs7a0JBRWUsUTs7Ozs7QUM1Q2YsT0FBTyxPQUFQLEdBQWlCLFFBQVEsYUFBUixFQUF1QixPQUF4Qzs7Ozs7Ozs7QUNBTyxJQUFNLHNDQUFlO0FBQ3hCLFdBQU8sT0FEaUI7QUFFeEIsc0JBQWtCLGtCQUZNO0FBR3hCLGdCQUFZLFlBSFk7QUFJeEIscUJBQWlCLGlCQUpPO0FBS3hCLDRCQUF3QjtBQUxBLENBQXJCOztBQVFBLElBQU0sa0NBQWE7QUFDdEIsbUJBQWUsY0FETztBQUV0QixpQkFBYSxZQUZTO0FBR3RCLGlCQUFhO0FBSFMsQ0FBbkI7O0FBTUEsSUFBTSwwREFBeUI7QUFDbEMsZUFBVyxDQUR1QjtBQUVsQyxjQUFVLENBRndCO0FBR2xDLGlCQUFhO0FBSHFCLENBQS9COzs7Ozs7Ozs7Ozs7O0lDZE0sTyxXQUFBLE87QUFFVCxxQkFBWSxRQUFaLEVBQXNCO0FBQUE7O0FBQ2xCLGFBQUssS0FBTCxHQUFhLFlBQVksV0FBekI7QUFDSDs7Ozs2QkFFSSxHLEVBQUssTSxFQUFRLENBQ2pCOzs7MkJBRUUsSyxFQUFPLEksRUFBTSxDQUVmOzs7NEJBRUcsSyxFQUFPLENBRVY7OzsyQ0FFa0IsWSxFQUFjLENBQ2hDOzs7K0JBRU0sQ0FDTjs7OytCQUVNLENBRU47OztrQ0FFUyxDQUVUOzs7Z0NBRU8sQ0FFUDs7O2lDQUVRLENBRVI7OzsyQ0FFbUIsQ0FFbkI7Ozs2QkFFSSxJLEVBQU0sQ0FFVjs7O2tDQUVTLENBRVQ7Ozs7Ozs7Ozs7Ozs7Ozs7QUNqREw7O0FBQ0E7O0FBQ0E7Ozs7Ozs7Ozs7OztBQUVBLElBQU0sY0FBYyx1QkFBcEI7O0FBRUEsSUFBTSxrQkFBa0I7QUFDcEIsVUFBSyxDQURlO0FBRXBCLFlBQU8sQ0FGYTtBQUdwQixhQUFRO0FBSFksQ0FBeEI7O0lBTWEsYSxXQUFBLGE7OztBQUVULDZCQUFlO0FBQUE7O0FBQUEsa0lBQ0wsZ0JBREs7O0FBRVgsY0FBSyxHQUFMLEdBQVcsZUFBWDs7QUFFQSxjQUFLLE1BQUwsR0FBYyxJQUFkO0FBQ0EsY0FBSyxPQUFMLEdBQWUsSUFBZjtBQUNBLGNBQUssTUFBTCxHQUFjLElBQWQ7O0FBRUEsY0FBSyxZQUFMLEdBQW9CLENBQXBCO0FBQ0EsY0FBSyxlQUFMLEdBQXVCLGdCQUFnQixJQUF2Qzs7QUFFQSxjQUFLLFNBQUwsR0FBaUIsS0FBakI7QUFDQSxjQUFLLFFBQUwsR0FBZ0IsS0FBaEI7QUFDQSxjQUFLLE9BQUwsR0FBZSxLQUFmO0FBQ0EsY0FBSyxRQUFMLEdBQWdCLENBQWhCO0FBQ0EsY0FBSyxnQkFBTCxHQUF3QixDQUF4QjtBQUNBLGNBQUssY0FBTCxHQUFzQixDQUF0Qjs7QUFFQSxjQUFLLGtCQUFMLEdBQTBCLElBQTFCO0FBQ0EsY0FBSyxrQkFBTCxHQUEwQixJQUExQjtBQUNBLGNBQUssYUFBTCxHQUFxQixJQUFyQjtBQUNBLGNBQUssc0JBQUwsR0FBOEIsSUFBOUI7QUFDQSxjQUFLLDRCQUFMLEdBQW9DLElBQXBDOztBQUVBLGNBQUssV0FBTCxHQUFtQixJQUFuQjs7QUFFQSxjQUFLLENBQUwsR0FBUztBQUNMLDBCQUFlLE1BQUssY0FBTCxDQUFvQixJQUFwQjtBQURWLFNBQVQ7QUExQlc7QUE2QmQ7Ozs7NkJBT0ssRyxFQUFLLE0sRUFBUTtBQUNmLGlCQUFLLFlBQUwsQ0FBa0IsTUFBbEI7QUFDQSxpQkFBSyxNQUFMLEdBQWMsS0FBSyxZQUFMLENBQWtCLEdBQWxCLENBQWQ7QUFDQSxpQkFBSyxlQUFMLEdBQXVCLEtBQUsscUJBQUwsQ0FBMkIsR0FBM0IsQ0FBdkI7O0FBRUEsaUJBQUssTUFBTCxHQUFjLGVBQU0sWUFBTixDQUFtQixFQUFDLFFBQU8sS0FBSyxNQUFiLEVBQXFCLE1BQUssS0FBMUIsRUFBZ0MsS0FBSSxHQUFwQyxFQUFuQixFQUE2RDtBQUN2RSwwQkFBVSxLQUQ2RDtBQUV2RSxtQ0FBbUIsS0FGb0Q7QUFHdkUsMENBQXlCO0FBSDhDLGFBQTdELENBQWQ7O0FBTUEsaUJBQUssTUFBTCxDQUFZLEVBQVosQ0FBZSxlQUFNLE1BQU4sQ0FBYSxlQUE1QixFQUE2QyxLQUFLLGlCQUFMLENBQXVCLElBQXZCLENBQTRCLElBQTVCLENBQTdDO0FBQ0EsaUJBQUssTUFBTCxDQUFZLEVBQVosQ0FBZSxlQUFNLE1BQU4sQ0FBYSxLQUE1QixFQUFtQyxLQUFLLFFBQUwsQ0FBYyxJQUFkLENBQW1CLElBQW5CLENBQW5DO0FBQ0EsaUJBQUssTUFBTCxDQUFZLHlCQUFaLENBQXNDLEtBQUssaUJBQUwsQ0FBdUIsSUFBdkIsQ0FBNEIsSUFBNUIsQ0FBdEM7QUFDQSxpQkFBSyxNQUFMLENBQVkscUJBQVosQ0FBa0MsS0FBSyxhQUFMLENBQW1CLElBQW5CLENBQXdCLElBQXhCLENBQWxDO0FBQ0g7OzsyQkFFRSxLLEVBQU8sSSxFQUFNO0FBQ1osZ0JBQUksVUFBVSw0QkFBYSxVQUEzQixFQUF1QztBQUNuQyxxQkFBSyxrQkFBTCxHQUEwQixJQUExQjtBQUNILGFBRkQsTUFHSyxJQUFJLFVBQVUsNEJBQWEsZUFBM0IsRUFBNEM7QUFDN0MscUJBQUssa0JBQUwsR0FBMEIsSUFBMUI7QUFDSCxhQUZJLE1BR0EsSUFBSSxVQUFVLDRCQUFhLEtBQTNCLEVBQWtDO0FBQ25DLHFCQUFLLGFBQUwsR0FBcUIsSUFBckI7QUFDSCxhQUZJLE1BR0EsSUFBSSxVQUFVLDRCQUFhLGdCQUEzQixFQUE2QztBQUM5QyxxQkFBSyxzQkFBTCxHQUE4QixJQUE5QjtBQUNILGFBRkksTUFHQSxJQUFJLFVBQVUsNEJBQWEsc0JBQTNCLEVBQW1EO0FBQ3BELHFCQUFLLDRCQUFMLEdBQW9DLElBQXBDO0FBQ0g7QUFDSjs7OzRCQUVHLEssRUFBTztBQUNQLGdCQUFJLFVBQVUsNEJBQWEsVUFBM0IsRUFBdUM7QUFDbkMscUJBQUssa0JBQUwsR0FBMEIsSUFBMUI7QUFDSCxhQUZELE1BR0ssSUFBSSxVQUFVLDRCQUFhLGVBQTNCLEVBQTRDO0FBQzdDLHFCQUFLLGtCQUFMLEdBQTBCLElBQTFCO0FBQ0gsYUFGSSxNQUdBLElBQUksVUFBVSw0QkFBYSxLQUEzQixFQUFrQztBQUNuQyxxQkFBSyxhQUFMLEdBQXFCLElBQXJCO0FBQ0gsYUFGSSxNQUdBLElBQUksVUFBVSw0QkFBYSxnQkFBM0IsRUFBNkM7QUFDOUMscUJBQUssc0JBQUwsR0FBOEIsSUFBOUI7QUFDSCxhQUZJLE1BR0EsSUFBSSxVQUFVLDRCQUFhLHNCQUEzQixFQUFtRDtBQUNwRCxxQkFBSyw0QkFBTCxHQUFvQyxJQUFwQztBQUNIO0FBQ0o7OzsyQ0FFa0IsRSxFQUFJO0FBQ25CLGlCQUFLLE9BQUwsR0FBZSxFQUFmO0FBQ0EsaUJBQUssT0FBTCxDQUFhLGdCQUFiLENBQThCLFlBQTlCLEVBQTRDLEtBQUssQ0FBTCxDQUFPLFlBQW5EO0FBQ0EsaUJBQUssTUFBTCxDQUFZLGtCQUFaLENBQStCLEVBQS9CO0FBQ0g7OzsrQkFFTTtBQUNILGlCQUFLLE1BQUwsQ0FBWSxJQUFaO0FBQ0g7OzsrQkFFTTtBQUNILGlCQUFLLE1BQUwsQ0FBWSxJQUFaO0FBQ0g7OztrQ0FFUztBQUNOLGdCQUFJLFNBQVMsU0FBUyxhQUFULENBQXVCLFFBQXZCLENBQWI7QUFDQSxtQkFBTyxLQUFQLEdBQWUsS0FBSyxPQUFMLENBQWEsVUFBNUI7QUFDQSxtQkFBTyxNQUFQLEdBQWdCLEtBQUssT0FBTCxDQUFhLFdBQTdCO0FBQ0EsbUJBQU8sVUFBUCxDQUFrQixJQUFsQixFQUF3QixTQUF4QixDQUFrQyxLQUFLLE9BQXZDLEVBQWdELENBQWhELEVBQW1ELENBQW5ELEVBQXNELE9BQU8sS0FBN0QsRUFBb0UsT0FBTyxNQUEzRTtBQUNBLGdCQUFJLFVBQVUsT0FBTyxTQUFQLEVBQWQ7QUFDQSxtQkFBTyxPQUFQO0FBQ0g7OztnQ0FFTztBQUNKLGlCQUFLLE9BQUwsQ0FBYSxLQUFiO0FBQ0EsbUJBQU8sS0FBUDtBQUNIOzs7aUNBRVE7QUFDTCxpQkFBSyxPQUFMLENBQWEsSUFBYjtBQUNBLG1CQUFPLEtBQVA7QUFDSDs7OzJDQUVtQjtBQUNoQixnQkFBSSxXQUFXLEtBQUssT0FBTCxDQUFhLFFBQTVCO0FBQ0EsZ0JBQUksU0FBUyxNQUFULEdBQWtCLENBQXRCLEVBQXlCO0FBQ3JCLG9CQUFJLE9BQU8sU0FBUyxLQUFULENBQWUsU0FBUyxNQUFULEdBQWlCLENBQWhDLENBQVg7QUFDQSxvQkFBSSxLQUFLLFNBQVMsR0FBVCxDQUFhLFNBQVMsTUFBVCxHQUFpQixDQUE5QixDQUFUO0FBQ0EscUJBQUssT0FBTCxDQUFhLFdBQWIsR0FBMkIsRUFBM0I7QUFDSDtBQUNKOzs7NkJBRUksSSxFQUFNO0FBQ1AsZ0JBQUksS0FBSyxPQUFMLElBQWdCLElBQXBCLEVBQTBCO0FBQ3RCLHVCQUFPLEtBQVA7QUFDSDtBQUNELGdCQUFJLEtBQUssT0FBVCxFQUFrQjtBQUNkLHVCQUFPLEtBQVA7QUFDSDs7QUFFRCxnQkFBSSxLQUFLLDRCQUFMLElBQXFDLElBQXpDLEVBQStDO0FBQzNDLHFCQUFLLDRCQUFMLENBQWtDLHNDQUF1QixTQUF6RCxFQUNJLFVBREo7QUFFSDs7QUFFRCxnQkFBSSxDQUFDLEtBQUssYUFBTCxDQUFtQixJQUFuQixDQUFMLEVBQStCO0FBQzNCLHVCQUFPLEtBQVA7QUFDSDtBQUNELGdCQUFJLEtBQUssZUFBTCxJQUF3QixnQkFBZ0IsTUFBNUMsRUFBb0Q7QUFDaEQscUJBQUssYUFBTCxDQUFtQixJQUFuQjtBQUNILGFBRkQsTUFHSztBQUNELHFCQUFLLGNBQUwsQ0FBb0IsSUFBcEI7QUFDSDtBQUNELG1CQUFPLElBQVA7QUFDSDs7O2tDQUVTO0FBQ04sZ0JBQUksS0FBSyxNQUFMLElBQWUsSUFBbkIsRUFBeUI7QUFDckIscUJBQUssTUFBTCxDQUFZLEtBQVo7QUFDQSxxQkFBSyxNQUFMLENBQVksTUFBWjtBQUNBLHFCQUFLLE1BQUwsQ0FBWSxrQkFBWjtBQUNBLHFCQUFLLE1BQUwsQ0FBWSxPQUFaO0FBQ0EscUJBQUssTUFBTCxHQUFjLElBQWQ7QUFDSDs7QUFFRCxnQkFBSSxLQUFLLE9BQUwsSUFBZ0IsSUFBcEIsRUFBMEI7QUFDdEIscUJBQUssT0FBTCxDQUFhLG1CQUFiLENBQWlDLFlBQWpDLEVBQStDLEtBQUssQ0FBTCxDQUFPLFlBQXREO0FBQ0EscUJBQUssT0FBTCxHQUFlLElBQWY7QUFDSDtBQUNKOzs7cUNBRVksTSxFQUFRO0FBQ2pCLGdCQUFJLFVBQVUsSUFBZCxFQUFvQjtBQUNoQjtBQUNIOztBQUVELGdCQUFJLE9BQU8sWUFBUCxJQUF1QixJQUEzQixFQUFpQztBQUM3QixxQkFBSyxZQUFMLEdBQW9CLE9BQU8sWUFBM0I7QUFDSDtBQUNKOzs7cUNBRVksRyxFQUFLO0FBQ2QsZ0JBQUksSUFBSSxPQUFKLENBQVksV0FBWixLQUE0QixDQUFDLENBQWpDLEVBQW9DO0FBQ2hDLHVCQUFPLEtBQVA7QUFDSDtBQUNELG1CQUFPLElBQVA7QUFDSDs7OzhDQUVxQixHLEVBQUs7QUFDdkIsZ0JBQUksTUFBTSxJQUFJLEtBQUosQ0FBVSxVQUFWLENBQVY7QUFDQSxnQkFBSSxJQUFJLE1BQUosR0FBYSxDQUFiLElBQWtCLElBQUksQ0FBSixFQUFPLE1BQVAsR0FBZ0IsQ0FBdEMsRUFBeUM7QUFDckMsdUJBQU8sZ0JBQWdCLElBQXZCO0FBQ0g7QUFDRCxnQkFBSSxhQUFhLElBQUksQ0FBSixDQUFqQjtBQUNBLGdCQUFJLGFBQWEsV0FBVyxTQUFYLENBQXFCLENBQXJCLEVBQXVCLENBQXZCLENBQWpCO0FBQ0EsZ0JBQUksY0FBYyxLQUFsQixFQUF5QjtBQUNyQix1QkFBTyxnQkFBZ0IsT0FBdkI7QUFDSDtBQUNELG1CQUFPLGdCQUFnQixNQUF2QjtBQUNIOzs7c0NBRWEsSSxFQUFNO0FBQ2hCLGdCQUFJLENBQUMsS0FBSyxTQUFWLEVBQXFCO0FBQ2pCLHVCQUFPLElBQVA7QUFDSDs7QUFFRCxpQkFBSyxPQUFMLEdBQWUsSUFBZjs7QUFFQSxnQkFBSSxVQUFVLEtBQWQ7QUFDQSxnQkFBSSxXQUFXLEtBQUssT0FBTCxDQUFhLFFBQTVCO0FBQ0EsaUJBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxTQUFTLE1BQTdCLEVBQXFDLEdBQXJDLEVBQTBDO0FBQ3RDLG9CQUFJLE9BQU8sU0FBUyxLQUFULENBQWUsQ0FBZixDQUFYO0FBQ0Esb0JBQUksS0FBSyxTQUFTLEdBQVQsQ0FBYSxDQUFiLENBQVQ7QUFDQSxvQkFBSSxPQUFPLElBQVAsSUFBZSxPQUFPLEVBQTFCLEVBQThCO0FBQzFCLDhCQUFVLElBQVY7QUFDSDtBQUNKOztBQUVELGdCQUFJLFdBQVcsT0FBTyxLQUFLLE9BQUwsQ0FBYSxXQUFuQyxFQUFnRDtBQUM1QyxxQkFBSyxPQUFMLENBQWEsV0FBYixHQUEyQixJQUEzQjtBQUNBLG9CQUFJLEtBQUssNEJBQUwsSUFBcUMsSUFBekMsRUFBK0M7QUFDM0MseUJBQUssNEJBQUwsQ0FBa0Msc0NBQXVCLFdBQXpELEVBQ0ksVUFESjtBQUVIO0FBQ0osYUFORCxNQU9LO0FBQ0Qsb0JBQUksS0FBSyw0QkFBTCxJQUFxQyxJQUF6QyxFQUErQztBQUMzQyx5QkFBSyw0QkFBTCxDQUFrQyxzQ0FBdUIsUUFBekQsRUFDSSxtQkFESjtBQUVIO0FBQ0o7O0FBRUQsaUJBQUssT0FBTCxHQUFlLEtBQWY7QUFDQSxtQkFBTyxLQUFQO0FBQ0g7OztzQ0FFYSxJLEVBQU07QUFBQTs7QUFDaEIsaUJBQUssT0FBTCxHQUFlLElBQWY7O0FBRUEsaUJBQUssY0FBTCxHQUFzQixJQUFJLElBQUosR0FBVyxPQUFYLEVBQXRCOztBQUVBLGlCQUFLLFdBQUwsR0FBbUIsV0FBVyxZQUFJO0FBQzlCLHVCQUFLLFFBQUwsR0FBZ0IsS0FBaEI7QUFDQSx1QkFBSyxPQUFMLEdBQWUsS0FBZjtBQUNBLG9CQUFJLE9BQUssNEJBQUwsSUFBcUMsSUFBekMsRUFBK0M7QUFDM0MsMkJBQUssNEJBQUwsQ0FBa0Msc0NBQXVCLFFBQXpELEVBQ0ksZ0JBREo7QUFFSDtBQUNKLGFBUGtCLEVBT2pCLEtBQUcsSUFQYyxDQUFuQjs7QUFTQSxpQkFBSyxRQUFMLEdBQWdCLElBQWhCO0FBQ0EsaUJBQUssUUFBTCxHQUFnQixJQUFoQjtBQUNIOzs7dUNBRWMsSSxFQUFNO0FBQUE7O0FBQ2pCLGlCQUFLLE9BQUwsR0FBZSxJQUFmOztBQUVBLGlCQUFLLFFBQUwsR0FBZ0IsSUFBaEI7QUFDQTtBQUNBLGdCQUFJLFdBQVcsS0FBSyxPQUFMLENBQWEsUUFBNUI7QUFDQSxnQkFBSSxTQUFTLE1BQVQsR0FBa0IsQ0FBdEIsRUFBeUI7QUFDckI7QUFDQSxvQkFBSSxPQUFPLFNBQVMsS0FBVCxDQUFlLENBQWYsQ0FBWDtBQUNBLG9CQUFJLEtBQUssU0FBUyxHQUFULENBQWEsQ0FBYixDQUFUO0FBQ0EscUJBQUssZ0JBQUwsR0FBd0IsRUFBeEI7O0FBRUEscUJBQUssT0FBTCxDQUFhLFdBQWIsR0FBMkIsS0FBSyxnQkFBaEM7QUFDSDs7QUFFRCx1QkFBVyxZQUFJO0FBQ1gsdUJBQUssT0FBTCxHQUFlLEtBQWY7QUFDQSxvQkFBSSxPQUFLLDRCQUFMLElBQXFDLElBQXpDLEVBQStDO0FBQzNDLDJCQUFLLDRCQUFMLENBQWtDLHNDQUF1QixXQUF6RCxFQUNJLFVBREo7QUFFSDtBQUNKLGFBTkQsRUFNRSxJQU5GO0FBT0g7OzswQ0FFaUIsSSxFQUFNO0FBQ3BCLGdCQUFJLEtBQUssa0JBQUwsSUFBMkIsSUFBL0IsRUFBcUM7QUFDakMsb0JBQUksT0FBTyxFQUFYO0FBQ0EscUJBQUssS0FBTCxHQUFhLEtBQUssS0FBbEI7QUFDQSxxQkFBSyxrQkFBTCxDQUF3QixJQUF4QjtBQUNIO0FBQ0o7OztpQ0FFUSxJLEVBQU0sTSxFQUFRLE0sRUFBUTtBQUMzQixnQkFBSSxLQUFLLGFBQUwsSUFBc0IsSUFBMUIsRUFBZ0M7QUFDNUIsb0JBQUksUUFBUSxJQUFaO0FBQ0Esb0JBQUksV0FBVyxNQUFmO0FBQ0Esb0JBQUksT0FBTyxJQUFYO0FBQ0EscUJBQUssYUFBTCxDQUFtQixJQUFuQixFQUF5QixRQUF6QixFQUFtQyxJQUFuQztBQUNIO0FBQ0o7OzswQ0FFaUIsSSxFQUFNO0FBQ3BCLGlCQUFLLFNBQUwsR0FBaUIsSUFBakI7QUFDQSxnQkFBSSxLQUFLLHNCQUFMLElBQStCLElBQW5DLEVBQXlDO0FBQ3JDLHFCQUFLLHNCQUFMO0FBQ0g7QUFDSjs7O3VDQUVjLEssRUFBTztBQUNsQjtBQUNBLGdCQUFJLEtBQUssWUFBTCxJQUFxQixDQUF6QixFQUE0QjtBQUN4QixvQkFBSSxLQUFLLGtCQUFMLElBQTJCLElBQTNCLElBQW1DLEtBQUssT0FBTCxJQUFnQixJQUF2RCxFQUE2RDtBQUN6RCx5QkFBSyxrQkFBTCxDQUF3QixLQUFLLE9BQUwsQ0FBYSxXQUFyQztBQUNIO0FBQ0Q7QUFDSDs7QUFFRDtBQUNBLGdCQUFJLEtBQUssZUFBTCxLQUF5QixnQkFBZ0IsTUFBN0MsRUFBcUQ7QUFDakQsb0JBQUksQ0FBQyxLQUFLLE9BQU4sSUFBaUIsS0FBSyxrQkFBTCxJQUEyQixJQUE1QyxJQUFvRCxLQUFLLE9BQUwsSUFBZ0IsSUFBeEUsRUFBOEU7QUFDMUUseUJBQUssa0JBQUwsQ0FBd0IsS0FBSyxPQUFMLENBQWEsV0FBckM7QUFDSDtBQUNKLGFBSkQsTUFLSyxJQUFJLEtBQUssZUFBTCxLQUF5QixnQkFBZ0IsT0FBN0MsRUFBc0Q7QUFDdkQsb0JBQUksQ0FBQyxLQUFLLE9BQU4sSUFBaUIsS0FBSyxrQkFBTCxJQUEyQixJQUE1QyxJQUFvRCxLQUFLLE9BQUwsSUFBZ0IsSUFBeEUsRUFBOEU7QUFDMUUsd0JBQUksY0FBYyxLQUFLLFFBQUwsSUFBaUIsS0FBSyxPQUFMLENBQWEsV0FBYixHQUEyQixLQUFLLGdCQUFqRCxDQUFsQjtBQUNBLHlCQUFLLGtCQUFMLENBQXdCLFdBQXhCO0FBQ0g7QUFDSjtBQUNKOzs7c0NBRWEsSSxFQUFNO0FBQUE7O0FBQ2hCLGdCQUFJLEtBQUssUUFBVCxFQUFtQjtBQUNmLG9CQUFJLEtBQUssR0FBTCxDQUFTLEtBQUssUUFBTCxHQUFjLElBQWQsR0FBcUIsSUFBOUIsS0FBdUMsSUFBM0MsRUFBaUQ7QUFDN0M7QUFDSDs7QUFFRCxvQkFBSSxLQUFLLFdBQUwsSUFBb0IsSUFBeEIsRUFBOEI7QUFDMUIsaUNBQWEsS0FBSyxXQUFsQjtBQUNBLHlCQUFLLFdBQUwsR0FBbUIsSUFBbkI7QUFDSDs7QUFFRCxxQkFBSyxRQUFMLEdBQWdCLEtBQWhCO0FBQ0EsMkJBQVcsWUFBSTtBQUNYLDJCQUFLLE9BQUwsR0FBZSxLQUFmO0FBQ0EsMkJBQUssT0FBTCxDQUFhLFdBQWIsR0FBMkIsT0FBSyxJQUFoQztBQUNBLHdCQUFJLE1BQU0sSUFBSSxJQUFKLEdBQVcsT0FBWCxLQUF1QixPQUFLLGNBQXRDO0FBQ0EsNEJBQVEsR0FBUixDQUFZLFdBQVcsR0FBdkI7QUFDQSx3QkFBSSxPQUFLLDRCQUFMLElBQXFDLElBQXpDLEVBQStDO0FBQzNDLCtCQUFLLDRCQUFMLENBQWtDLHNDQUF1QixXQUF6RCxFQUNJLFVBREo7QUFFSDtBQUNKLGlCQVRELEVBU0UsSUFURjtBQVVBO0FBQ0g7QUFDSjs7O3NDQTlUb0I7QUFDakIsbUJBQU8sT0FBTyxXQUFQLElBQ0gsT0FBTyxXQUFQLENBQW1CLGVBQW5CLENBQW1DLDJDQUFuQyxDQURKO0FBRUg7Ozs7RUFwQzhCLGdCOzs7Ozs7OztBQ1o1QixJQUFNLHNDQUFlO0FBQ3hCLG9CQUFnQjtBQURRLENBQXJCOztBQUlBLElBQU0sc0RBQXVCO0FBQ2hDLG9CQUFnQixnQkFEZ0I7QUFFaEMsa0JBQWM7QUFGa0IsQ0FBN0I7O0FBS0EsSUFBTSw0REFBMEI7QUFDbkMseUJBQXFCLHFCQURjO0FBRW5DLDRCQUF3Qix3QkFGVztBQUduQyxrQkFBYyxjQUhxQjtBQUluQyxnQkFBWSxZQUp1QjtBQUtuQywrQkFBMkIsMkJBTFE7QUFNbkMsNEJBQXdCO0FBTlcsQ0FBaEM7Ozs7Ozs7Ozs7Ozs7SUNUTSxPLFdBQUEsTztBQUVULHFCQUFZLFFBQVosRUFBc0I7QUFBQTs7QUFDbEIsYUFBSyxLQUFMLEdBQWEsWUFBWSxXQUF6QjtBQUNIOzs7OzZCQUVJLE8sRUFBUyxLLEVBQU8sSSxFQUFNLE8sRUFBUyxNLEVBQVEsQ0FDM0M7OzsyQkFFRSxLLEVBQU8sSSxFQUFNLENBRWY7Ozs0QkFFRyxLLEVBQU8sQ0FFVjs7OzJDQUVrQixPLEVBQVMsQ0FDM0I7OzsrQkFFTSxDQUNOOzs7a0NBRVMsQ0FFVDs7Ozs7Ozs7Ozs7Ozs7OztBQ3pCTDs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7OztBQUVBOzs7O0FBQ0E7O0FBQ0E7Ozs7Ozs7Ozs7QUFFQSxJQUFNLGNBQWMsR0FBcEI7QUFDQSxJQUFNLFlBQVksS0FBbEI7O0lBRWEsYSxXQUFBLGE7OztBQUVULDZCQUFlO0FBQUE7O0FBQUEsa0lBQ0wsZ0JBREs7O0FBRVgsY0FBSyxHQUFMLEdBQVcsZUFBWDs7QUFFQSxjQUFLLE9BQUwsR0FBZSxJQUFmO0FBQ0EsY0FBSyxLQUFMLEdBQWEsSUFBYjtBQUNBLGNBQUssSUFBTCxHQUFZLElBQVo7QUFDQSxjQUFLLE9BQUwsR0FBZSxJQUFmOztBQUVBLGNBQUssTUFBTCxHQUFjLElBQWQ7QUFDQSxjQUFLLFFBQUwsR0FBZ0IsSUFBaEI7QUFDQSxjQUFLLE1BQUwsR0FBYyxJQUFkO0FBQ0EsY0FBSyxPQUFMLEdBQWUsSUFBZjs7QUFFQSxjQUFLLHFCQUFMLEdBQTZCLElBQTdCOztBQUVBLGNBQUssU0FBTCxHQUFpQixJQUFJLG9CQUFKLEVBQWpCOztBQUVBLGNBQUssVUFBTCxHQUFrQixJQUFsQjtBQUNBLGNBQUssU0FBTCxHQUFpQixJQUFqQjs7QUFFQSxjQUFLLG9CQUFMLEdBQTRCLEtBQTVCO0FBQ0EsY0FBSyxpQkFBTCxHQUF5QixLQUF6QjtBQUNBLGNBQUssNEJBQUwsR0FBb0MsS0FBcEM7QUFDQSxjQUFLLFVBQUwsR0FBa0IsS0FBbEI7QUF4Qlc7QUF5QmQ7Ozs7NkJBT0ksTyxFQUFTLEssRUFBTyxJLEVBQU0sTyxFQUFTLE0sRUFBUTtBQUN4QyxpQkFBSyxPQUFMLEdBQWUsT0FBZjtBQUNBLGlCQUFLLEtBQUwsR0FBYSxLQUFiO0FBQ0EsaUJBQUssSUFBTCxHQUFZLElBQVo7QUFDQSxpQkFBSyxPQUFMLEdBQWUsT0FBZjtBQUNBLGdCQUFJLENBQUMsS0FBSyxnQkFBTCxFQUFMLEVBQThCO0FBQzFCLHVCQUFPLEtBQVA7QUFDSDs7QUFFRCxpQkFBSyxZQUFMLENBQWtCLE9BQWxCO0FBQ0EsbUJBQU8sSUFBUDtBQUNIOzs7MkJBRUUsSyxFQUFPLEksRUFBTTtBQUNaLGdCQUFJLFVBQVUsNEJBQWEsY0FBM0IsRUFBMkM7QUFDdkMscUJBQUsscUJBQUwsR0FBNkIsSUFBN0I7QUFDSDtBQUNKOzs7NEJBRUcsSyxFQUFPO0FBQ1AsZ0JBQUksVUFBVSw0QkFBYSxjQUEzQixFQUEyQztBQUN2QyxxQkFBSyxxQkFBTCxHQUE2QixJQUE3QjtBQUNIO0FBQ0o7OzsyQ0FFa0IsTyxFQUFTO0FBQ3hCLGlCQUFLLE9BQUwsR0FBZSxPQUFmOztBQUVBLGlCQUFLLE9BQUwsQ0FBYSxnQkFBYixDQUE4QixZQUE5QixFQUE0QyxLQUFLLG1CQUFMLENBQXlCLElBQXpCLENBQThCLElBQTlCLENBQTVDLEVBQWlGLEVBQUMsTUFBTSxJQUFQLEVBQWpGO0FBQ0EsaUJBQUssTUFBTCxDQUFZLEVBQVosQ0FBZSxlQUFNLE1BQU4sQ0FBYSxLQUE1QixFQUFtQyxLQUFLLGNBQUwsQ0FBb0IsSUFBcEIsQ0FBeUIsSUFBekIsQ0FBbkM7QUFDQSxpQkFBSyxNQUFMLENBQVkseUJBQVosQ0FBc0MsS0FBSyx1QkFBTCxDQUE2QixJQUE3QixDQUFrQyxJQUFsQyxDQUF0Qzs7QUFFQSxpQkFBSyxNQUFMLENBQVksa0JBQVosQ0FBK0IsT0FBL0I7QUFDSDs7OytCQUVNO0FBQ0gsaUJBQUssTUFBTCxDQUFZLElBQVo7QUFDQSxpQkFBSyxZQUFMLENBQWtCLEtBQUssS0FBdkI7QUFDSDs7O2tDQUVTO0FBQ04saUJBQUssVUFBTCxHQUFrQixJQUFsQjs7QUFFQSxpQkFBSyxjQUFMO0FBQ0EsaUJBQUssY0FBTDtBQUNBLGlCQUFLLGdCQUFMO0FBQ0EsaUJBQUssZ0JBQUw7QUFDSDs7OzJDQUVrQjtBQUNmLGdCQUFJLFdBQUssYUFBTCxDQUFtQixLQUFLLE9BQXhCLEtBQW9DLFdBQUssYUFBTCxDQUFtQixLQUFLLEtBQXhCLENBQXhDLEVBQXdFO0FBQ3BFLHVCQUFPLEtBQVA7QUFDSDtBQUNELGdCQUFJLFdBQUssYUFBTCxDQUFtQixLQUFLLElBQXhCLENBQUosRUFBbUM7QUFDL0IsdUJBQU8sS0FBUDtBQUNIO0FBQ0QsZ0JBQUksS0FBSyxPQUFMLEdBQWUsQ0FBZixJQUFvQixLQUFLLE9BQUwsR0FBZSxHQUF2QyxFQUE0QztBQUN4Qyx1QkFBTyxLQUFQO0FBQ0g7QUFDRCxtQkFBTyxJQUFQO0FBQ0g7OztxQ0FFWSxHLEVBQUs7QUFDZCxpQkFBSyxjQUFMOztBQUVBLGlCQUFLLE1BQUwsR0FBYyxlQUFNLFlBQU4sQ0FBbUIsRUFBQyxRQUFPLElBQVIsRUFBYyxNQUFLLEtBQW5CLEVBQXlCLEtBQUksR0FBN0IsRUFBbkIsRUFBc0Q7QUFDaEUsMEJBQVUsS0FEc0Q7QUFFaEUsbUNBQW1CLEtBRjZDO0FBR2hFLDBDQUF5QjtBQUh1QyxhQUF0RCxDQUFkO0FBS0g7Ozs4Q0FFcUI7QUFDbEIsZ0JBQUksU0FBSixFQUFlO0FBQ1gsd0JBQVEsR0FBUixDQUFZLG1CQUFaO0FBQ0g7O0FBRUQsaUJBQUssb0JBQUwsR0FBNEIsSUFBNUI7QUFDQSxnQkFBSSxLQUFLLGlCQUFMLElBQTBCLEtBQUsscUJBQUwsSUFBOEIsSUFBNUQsRUFBa0U7QUFDOUQscUJBQUsscUJBQUwsQ0FBMkIsb0NBQXFCLGNBQWhELEVBQWdFLEVBQWhFO0FBQ0g7QUFDSjs7O3VDQUVjLEksRUFBTSxNLEVBQVEsTSxFQUFRO0FBQ2pDLGdCQUFJLFNBQUosRUFBZTtBQUNYLHdCQUFRLEdBQVIsQ0FBWSxjQUFaO0FBQ0g7O0FBRUQsZ0JBQUksS0FBSyxxQkFBTCxJQUE4QixJQUFsQyxFQUF3QztBQUNwQztBQUNIOztBQUVELGdCQUFJLEtBQUssb0JBQVQsRUFBK0I7QUFDM0IscUJBQUsscUJBQUwsQ0FBMkIsb0NBQXFCLFlBQWhELEVBQ0ksdUNBQXdCLFlBRDVCO0FBRUgsYUFIRCxNQUlLO0FBQ0QscUJBQUsscUJBQUwsQ0FBMkIsb0NBQXFCLFlBQWhELEVBQ0ksdUNBQXdCLG1CQUQ1QjtBQUVIO0FBQ0o7OztnREFFdUIsSSxFQUFNO0FBQzFCLGdCQUFJLFNBQUosRUFBZTtBQUNYLHdCQUFRLEdBQVIsQ0FBWSxtQkFBWjtBQUNIOztBQUVELGdCQUFJLEtBQUsscUJBQUwsSUFBOEIsSUFBbEMsRUFBd0M7QUFDcEMscUJBQUsscUJBQUwsQ0FBMkIsb0NBQXFCLFlBQWhELEVBQ0ksdUNBQXdCLHNCQUQ1QjtBQUVIO0FBQ0o7Ozt5Q0FFZ0I7QUFDYixnQkFBSSxLQUFLLE1BQUwsSUFBZSxJQUFuQixFQUF5QjtBQUNyQixxQkFBSyxNQUFMLENBQVksS0FBWjtBQUNBLHFCQUFLLE1BQUwsQ0FBWSxNQUFaO0FBQ0EscUJBQUssTUFBTCxDQUFZLGtCQUFaO0FBQ0EscUJBQUssTUFBTCxDQUFZLE9BQVo7QUFDQSxxQkFBSyxNQUFMLEdBQWMsSUFBZDtBQUNIOztBQUVELGdCQUFJLEtBQUssT0FBTCxJQUFnQixJQUFwQixFQUEwQjtBQUN0QixxQkFBSyxPQUFMLEdBQWUsSUFBZjtBQUNIO0FBQ0o7OztxQ0FFWSxHLEVBQUs7QUFDZCxpQkFBSyxNQUFMLEdBQWMsSUFBSSxTQUFKLENBQWMsR0FBZCxDQUFkO0FBQ0EsaUJBQUssTUFBTCxDQUFZLE1BQVosR0FBcUIsS0FBSyxhQUFMLENBQW1CLElBQW5CLENBQXdCLElBQXhCLENBQXJCO0FBQ0EsaUJBQUssTUFBTCxDQUFZLFNBQVosR0FBd0IsS0FBSyxZQUFMLENBQWtCLElBQWxCLENBQXVCLElBQXZCLENBQXhCO0FBQ0EsaUJBQUssTUFBTCxDQUFZLE9BQVosR0FBc0IsS0FBSyxjQUFMLENBQW9CLElBQXBCLENBQXlCLElBQXpCLENBQXRCO0FBQ0EsaUJBQUssTUFBTCxDQUFZLE9BQVosR0FBc0IsS0FBSyxjQUFMLENBQW9CLElBQXBCLENBQXlCLElBQXpCLENBQXRCO0FBQ0g7Ozt3Q0FFZTtBQUNaLGdCQUFJLFNBQUosRUFBZTtBQUNYLHdCQUFRLEdBQVIsQ0FBWSxnQkFBWjtBQUNIOztBQUVELGlCQUFLLGNBQUw7QUFDSDs7O3FDQUVZLEMsRUFBRyxDQUVmOzs7dUNBRWMsQyxFQUFHO0FBQ2QsZ0JBQUksU0FBSixFQUFlO0FBQ1gsd0JBQVEsR0FBUixDQUFZLGlCQUFaO0FBQ0g7O0FBRUQsZ0JBQUksS0FBSyxxQkFBTCxJQUE4QixJQUFsQyxFQUF3QztBQUNwQyxxQkFBSyxxQkFBTCxDQUEyQixvQ0FBcUIsWUFBaEQsRUFDSSx1Q0FBd0IsVUFENUI7QUFFSDtBQUNKOzs7dUNBRWMsQyxFQUFHO0FBQ2QsZ0JBQUksU0FBSixFQUFlO0FBQ1gsd0JBQVEsR0FBUixDQUFZLGlCQUFaO0FBQ0g7QUFDSjs7O3lDQUVnQjtBQUNiLGlCQUFLLE1BQUwsQ0FBWSxLQUFaO0FBQ0EsaUJBQUssTUFBTCxHQUFjLElBQWQ7QUFDSDs7O3lDQUVnQjtBQUNiLGdCQUFJLEtBQUssUUFBVCxFQUFtQjtBQUNmLHFCQUFLLFFBQUwsQ0FBYyxLQUFkO0FBQ0g7O0FBRUQsaUJBQUssUUFBTCxHQUFnQiw0QkFBUztBQUNyQixzQkFBSyxLQURnQjtBQUVyQiw0QkFBVyxJQUZVO0FBR3JCLHlCQUFRLEVBSGE7QUFJckIsMkJBQVUsS0FBSyx3QkFBTCxDQUE4QixJQUE5QixDQUFtQyxJQUFuQztBQUpXLGFBQVQsQ0FBaEI7QUFNQSxpQkFBSyxVQUFMLEdBQWtCLFdBQVcsS0FBSyxrQ0FBTCxDQUF3QyxJQUF4QyxDQUE2QyxJQUE3QyxDQUFYLEVBQThELEtBQTlELENBQWxCO0FBQ0EsaUJBQUssUUFBTCxDQUFjLElBQWQsQ0FBbUIsS0FBSyxzQkFBTCxDQUE0QixJQUE1QixDQUFpQyxJQUFqQyxDQUFuQixFQUNJLEtBQUsseUJBQUwsQ0FBK0IsSUFBL0IsQ0FBb0MsSUFBcEMsQ0FESjtBQUVIOzs7NkRBRW9DO0FBQ2pDLGdCQUFJLFNBQUosRUFBZTtBQUNYLHdCQUFRLEdBQVIsQ0FBWSxpQ0FBWjtBQUNIOztBQUVELGlCQUFLLDRCQUFMLEdBQW9DLElBQXBDOztBQUVBLGdCQUFJLEtBQUsscUJBQUwsSUFBOEIsSUFBbEMsRUFBd0M7QUFDcEMscUJBQUsscUJBQUwsQ0FBMkIsb0NBQXFCLFlBQWhELEVBQ0ksdUNBQXdCLHlCQUQ1QjtBQUVIO0FBQ0o7OztpREFFd0I7QUFDckIsZ0JBQUksU0FBSixFQUFlO0FBQ1gsd0JBQVEsR0FBUixDQUFZLDBCQUFaO0FBQ0g7O0FBRUQsZ0JBQUksS0FBSyw0QkFBVCxFQUF1QztBQUNuQztBQUNIOztBQUVELHlCQUFhLEtBQUssVUFBbEI7O0FBRUEsaUJBQUssaUJBQUwsR0FBeUIsSUFBekI7QUFDQSxnQkFBSSxLQUFLLG9CQUFMLElBQTZCLEtBQUsscUJBQUwsSUFBOEIsSUFBL0QsRUFBcUU7QUFDakUscUJBQUsscUJBQUwsQ0FBMkIsb0NBQXFCLGNBQWhELEVBQWdFLEVBQWhFO0FBQ0g7O0FBRUQsaUJBQUssUUFBTCxDQUFjLEtBQWQ7QUFDQSxpQkFBSyxTQUFMO0FBQ0g7OztrREFFeUIsRyxFQUFLLGMsRUFBZ0I7QUFDM0MsZ0JBQUksU0FBSixFQUFlO0FBQ1gsd0JBQVEsR0FBUixDQUFZLDZCQUFaO0FBQ0g7O0FBRUQseUJBQWEsS0FBSyxVQUFsQjs7QUFFQSxnQkFBSSxLQUFLLHFCQUFMLElBQThCLElBQWxDLEVBQXdDO0FBQ3BDLHFCQUFLLHFCQUFMLENBQTJCLG9DQUFxQixZQUFoRCxFQUNJLHVDQUF3QixzQkFENUI7QUFFSDtBQUNKOzs7aURBRXdCLE8sRUFBUyxVLEVBQVksYyxFQUFnQixnQixFQUFrQjtBQUM1RSxnQkFBSSxXQUFXLFFBQVEsUUFBUSxNQUFSLEdBQWlCLENBQXpCLEVBQTRCLE1BQTNDLENBRDRFLENBQ3pCO0FBQ25ELGdCQUFJLFFBQVEsSUFBSSxVQUFKLENBQWUsUUFBZixDQUFaLENBRjRFLENBRXRDO0FBQ3RDLGlCQUFLLFNBQUwsQ0FBZSxJQUFmLENBQW9CLEtBQXBCO0FBQ0g7OzsyQ0FFa0I7QUFDZixpQkFBSyxRQUFMLENBQWMsS0FBZDtBQUNBLGlCQUFLLFFBQUwsR0FBZ0IsSUFBaEI7QUFDSDs7O29DQUVXO0FBQ1IsZ0JBQUksS0FBSyxVQUFULEVBQXFCO0FBQ2pCO0FBQ0g7O0FBRUQsZ0JBQUksS0FBSyxTQUFMLENBQWUsTUFBZixHQUF3QixXQUE1QixFQUF5QztBQUNyQyxxQkFBSyxTQUFMLEdBQWlCLFdBQVcsS0FBSyxTQUFMLENBQWUsSUFBZixDQUFvQixJQUFwQixDQUFYLEVBQXNDLENBQXRDLENBQWpCO0FBQ0gsYUFGRCxNQUdLO0FBQ0Qsb0JBQUksV0FBVyxLQUFLLFNBQUwsQ0FBZSxTQUFmLENBQXlCLFdBQXpCLENBQWY7O0FBRUEsb0JBQUksU0FBUyxJQUFJLG9CQUFKLEVBQWI7QUFDQSx1QkFBTyxJQUFQLENBQVksSUFBSSxVQUFKLENBQWUsQ0FBQyxJQUFELEVBQU0sSUFBTixFQUFXLElBQVgsRUFBZ0IsSUFBaEIsQ0FBZixDQUFaO0FBQ0Esb0JBQUksY0FBYyxLQUFLLElBQUwsQ0FBVSxLQUFWLENBQWdCLEVBQWhCLENBQWxCO0FBQ0EscUJBQUssSUFBSSxJQUFJLENBQWIsRUFBZ0IsSUFBSSxZQUFZLE1BQWhDLEVBQXdDLEdBQXhDLEVBQTZDO0FBQ3pDLDJCQUFPLElBQVAsQ0FBWSxJQUFJLFVBQUosQ0FBZSxDQUFDLFlBQVksQ0FBWixFQUFlLFVBQWYsRUFBRCxDQUFmLENBQVo7QUFDSDtBQUNELHVCQUFPLElBQVAsQ0FBWSxJQUFJLFVBQUosQ0FBZSxDQUFDLFNBQVMsS0FBSyxPQUFkLENBQUQsQ0FBZixDQUFaO0FBQ0EsdUJBQU8sSUFBUCxDQUFZLElBQUksVUFBSixDQUFlLENBQUMsS0FBSyxLQUFMLENBQVcsY0FBWSxHQUF2QixDQUFELENBQWYsQ0FBWjtBQUNBLHVCQUFPLElBQVAsQ0FBWSxJQUFJLFVBQUosQ0FBZSxDQUFDLGNBQVksR0FBYixDQUFmLENBQVo7QUFDQSx1QkFBTyxJQUFQLENBQVksUUFBWjs7QUFFQSxvQkFBSSxXQUFXLElBQUksWUFBWSxNQUFoQixHQUF5QixDQUF6QixHQUE2QixXQUE1QztBQUNBLG9CQUFJLEtBQUssTUFBTCxJQUFlLElBQW5CLEVBQXlCO0FBQ3JCLHlCQUFLLE1BQUwsQ0FBWSxJQUFaLENBQWlCLE9BQU8sU0FBUCxDQUFpQixRQUFqQixDQUFqQjtBQUNIOztBQUVELHFCQUFLLFNBQUw7QUFDSDtBQUNKOzs7MkNBRWtCO0FBQ2YseUJBQWEsS0FBSyxTQUFsQjtBQUNIOzs7c0NBeFJvQjtBQUNqQixtQkFBTyxPQUFPLFNBQVAsSUFBb0IsV0FBcEIsSUFBbUMsdUJBQVMsT0FBVCxFQUFuQyxJQUF5RCxPQUFPLFdBQWhFLElBQ0gsT0FBTyxXQUFQLENBQW1CLGVBQW5CLENBQW1DLDJDQUFuQyxDQURKO0FBRUg7Ozs7RUFoQzhCLGdCIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiKGZ1bmN0aW9uKGYpe2lmKHR5cGVvZiBleHBvcnRzPT09XCJvYmplY3RcIiYmdHlwZW9mIG1vZHVsZSE9PVwidW5kZWZpbmVkXCIpe21vZHVsZS5leHBvcnRzPWYoKX1lbHNlIGlmKHR5cGVvZiBkZWZpbmU9PT1cImZ1bmN0aW9uXCImJmRlZmluZS5hbWQpe2RlZmluZShbXSxmKX1lbHNle3ZhciBnO2lmKHR5cGVvZiB3aW5kb3chPT1cInVuZGVmaW5lZFwiKXtnPXdpbmRvd31lbHNlIGlmKHR5cGVvZiBnbG9iYWwhPT1cInVuZGVmaW5lZFwiKXtnPWdsb2JhbH1lbHNlIGlmKHR5cGVvZiBzZWxmIT09XCJ1bmRlZmluZWRcIil7Zz1zZWxmfWVsc2V7Zz10aGlzfWcuZmx2anMgPSBmKCl9fSkoZnVuY3Rpb24oKXt2YXIgZGVmaW5lLG1vZHVsZSxleHBvcnRzO3JldHVybiAoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSh7MTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4oZnVuY3Rpb24gKHByb2Nlc3MsZ2xvYmFsKXtcbi8qIVxuICogQG92ZXJ2aWV3IGVzNi1wcm9taXNlIC0gYSB0aW55IGltcGxlbWVudGF0aW9uIG9mIFByb21pc2VzL0ErLlxuICogQGNvcHlyaWdodCBDb3B5cmlnaHQgKGMpIDIwMTQgWWVodWRhIEthdHosIFRvbSBEYWxlLCBTdGVmYW4gUGVubmVyIGFuZCBjb250cmlidXRvcnMgKENvbnZlcnNpb24gdG8gRVM2IEFQSSBieSBKYWtlIEFyY2hpYmFsZClcbiAqIEBsaWNlbnNlICAgTGljZW5zZWQgdW5kZXIgTUlUIGxpY2Vuc2VcbiAqICAgICAgICAgICAgU2VlIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9zdGVmYW5wZW5uZXIvZXM2LXByb21pc2UvbWFzdGVyL0xJQ0VOU0VcbiAqIEB2ZXJzaW9uICAgdjQuMi41KzdmMmI1MjZkXG4gKi9cblxuKGZ1bmN0aW9uIChnbG9iYWwsIGZhY3RvcnkpIHtcblx0dHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnID8gbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCkgOlxuXHR0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgPyBkZWZpbmUoZmFjdG9yeSkgOlxuXHQoZ2xvYmFsLkVTNlByb21pc2UgPSBmYWN0b3J5KCkpO1xufSh0aGlzLCAoZnVuY3Rpb24gKCkgeyAndXNlIHN0cmljdCc7XG5cbmZ1bmN0aW9uIG9iamVjdE9yRnVuY3Rpb24oeCkge1xuICB2YXIgdHlwZSA9IHR5cGVvZiB4O1xuICByZXR1cm4geCAhPT0gbnVsbCAmJiAodHlwZSA9PT0gJ29iamVjdCcgfHwgdHlwZSA9PT0gJ2Z1bmN0aW9uJyk7XG59XG5cbmZ1bmN0aW9uIGlzRnVuY3Rpb24oeCkge1xuICByZXR1cm4gdHlwZW9mIHggPT09ICdmdW5jdGlvbic7XG59XG5cblxuXG52YXIgX2lzQXJyYXkgPSB2b2lkIDA7XG5pZiAoQXJyYXkuaXNBcnJheSkge1xuICBfaXNBcnJheSA9IEFycmF5LmlzQXJyYXk7XG59IGVsc2Uge1xuICBfaXNBcnJheSA9IGZ1bmN0aW9uICh4KSB7XG4gICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh4KSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbiAgfTtcbn1cblxudmFyIGlzQXJyYXkgPSBfaXNBcnJheTtcblxudmFyIGxlbiA9IDA7XG52YXIgdmVydHhOZXh0ID0gdm9pZCAwO1xudmFyIGN1c3RvbVNjaGVkdWxlckZuID0gdm9pZCAwO1xuXG52YXIgYXNhcCA9IGZ1bmN0aW9uIGFzYXAoY2FsbGJhY2ssIGFyZykge1xuICBxdWV1ZVtsZW5dID0gY2FsbGJhY2s7XG4gIHF1ZXVlW2xlbiArIDFdID0gYXJnO1xuICBsZW4gKz0gMjtcbiAgaWYgKGxlbiA9PT0gMikge1xuICAgIC8vIElmIGxlbiBpcyAyLCB0aGF0IG1lYW5zIHRoYXQgd2UgbmVlZCB0byBzY2hlZHVsZSBhbiBhc3luYyBmbHVzaC5cbiAgICAvLyBJZiBhZGRpdGlvbmFsIGNhbGxiYWNrcyBhcmUgcXVldWVkIGJlZm9yZSB0aGUgcXVldWUgaXMgZmx1c2hlZCwgdGhleVxuICAgIC8vIHdpbGwgYmUgcHJvY2Vzc2VkIGJ5IHRoaXMgZmx1c2ggdGhhdCB3ZSBhcmUgc2NoZWR1bGluZy5cbiAgICBpZiAoY3VzdG9tU2NoZWR1bGVyRm4pIHtcbiAgICAgIGN1c3RvbVNjaGVkdWxlckZuKGZsdXNoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2NoZWR1bGVGbHVzaCgpO1xuICAgIH1cbiAgfVxufTtcblxuZnVuY3Rpb24gc2V0U2NoZWR1bGVyKHNjaGVkdWxlRm4pIHtcbiAgY3VzdG9tU2NoZWR1bGVyRm4gPSBzY2hlZHVsZUZuO1xufVxuXG5mdW5jdGlvbiBzZXRBc2FwKGFzYXBGbikge1xuICBhc2FwID0gYXNhcEZuO1xufVxuXG52YXIgYnJvd3NlcldpbmRvdyA9IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogdW5kZWZpbmVkO1xudmFyIGJyb3dzZXJHbG9iYWwgPSBicm93c2VyV2luZG93IHx8IHt9O1xudmFyIEJyb3dzZXJNdXRhdGlvbk9ic2VydmVyID0gYnJvd3Nlckdsb2JhbC5NdXRhdGlvbk9ic2VydmVyIHx8IGJyb3dzZXJHbG9iYWwuV2ViS2l0TXV0YXRpb25PYnNlcnZlcjtcbnZhciBpc05vZGUgPSB0eXBlb2Ygc2VsZiA9PT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHByb2Nlc3MgIT09ICd1bmRlZmluZWQnICYmIHt9LnRvU3RyaW5nLmNhbGwocHJvY2VzcykgPT09ICdbb2JqZWN0IHByb2Nlc3NdJztcblxuLy8gdGVzdCBmb3Igd2ViIHdvcmtlciBidXQgbm90IGluIElFMTBcbnZhciBpc1dvcmtlciA9IHR5cGVvZiBVaW50OENsYW1wZWRBcnJheSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIGltcG9ydFNjcmlwdHMgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBNZXNzYWdlQ2hhbm5lbCAhPT0gJ3VuZGVmaW5lZCc7XG5cbi8vIG5vZGVcbmZ1bmN0aW9uIHVzZU5leHRUaWNrKCkge1xuICAvLyBub2RlIHZlcnNpb24gMC4xMC54IGRpc3BsYXlzIGEgZGVwcmVjYXRpb24gd2FybmluZyB3aGVuIG5leHRUaWNrIGlzIHVzZWQgcmVjdXJzaXZlbHlcbiAgLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9jdWpvanMvd2hlbi9pc3N1ZXMvNDEwIGZvciBkZXRhaWxzXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHByb2Nlc3MubmV4dFRpY2soZmx1c2gpO1xuICB9O1xufVxuXG4vLyB2ZXJ0eFxuZnVuY3Rpb24gdXNlVmVydHhUaW1lcigpIHtcbiAgaWYgKHR5cGVvZiB2ZXJ0eE5leHQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZlcnR4TmV4dChmbHVzaCk7XG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB1c2VTZXRUaW1lb3V0KCk7XG59XG5cbmZ1bmN0aW9uIHVzZU11dGF0aW9uT2JzZXJ2ZXIoKSB7XG4gIHZhciBpdGVyYXRpb25zID0gMDtcbiAgdmFyIG9ic2VydmVyID0gbmV3IEJyb3dzZXJNdXRhdGlvbk9ic2VydmVyKGZsdXNoKTtcbiAgdmFyIG5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnJyk7XG4gIG9ic2VydmVyLm9ic2VydmUobm9kZSwgeyBjaGFyYWN0ZXJEYXRhOiB0cnVlIH0pO1xuXG4gIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgbm9kZS5kYXRhID0gaXRlcmF0aW9ucyA9ICsraXRlcmF0aW9ucyAlIDI7XG4gIH07XG59XG5cbi8vIHdlYiB3b3JrZXJcbmZ1bmN0aW9uIHVzZU1lc3NhZ2VDaGFubmVsKCkge1xuICB2YXIgY2hhbm5lbCA9IG5ldyBNZXNzYWdlQ2hhbm5lbCgpO1xuICBjaGFubmVsLnBvcnQxLm9ubWVzc2FnZSA9IGZsdXNoO1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBjaGFubmVsLnBvcnQyLnBvc3RNZXNzYWdlKDApO1xuICB9O1xufVxuXG5mdW5jdGlvbiB1c2VTZXRUaW1lb3V0KCkge1xuICAvLyBTdG9yZSBzZXRUaW1lb3V0IHJlZmVyZW5jZSBzbyBlczYtcHJvbWlzZSB3aWxsIGJlIHVuYWZmZWN0ZWQgYnlcbiAgLy8gb3RoZXIgY29kZSBtb2RpZnlpbmcgc2V0VGltZW91dCAobGlrZSBzaW5vbi51c2VGYWtlVGltZXJzKCkpXG4gIHZhciBnbG9iYWxTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gZ2xvYmFsU2V0VGltZW91dChmbHVzaCwgMSk7XG4gIH07XG59XG5cbnZhciBxdWV1ZSA9IG5ldyBBcnJheSgxMDAwKTtcbmZ1bmN0aW9uIGZsdXNoKCkge1xuICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSAyKSB7XG4gICAgdmFyIGNhbGxiYWNrID0gcXVldWVbaV07XG4gICAgdmFyIGFyZyA9IHF1ZXVlW2kgKyAxXTtcblxuICAgIGNhbGxiYWNrKGFyZyk7XG5cbiAgICBxdWV1ZVtpXSA9IHVuZGVmaW5lZDtcbiAgICBxdWV1ZVtpICsgMV0gPSB1bmRlZmluZWQ7XG4gIH1cblxuICBsZW4gPSAwO1xufVxuXG5mdW5jdGlvbiBhdHRlbXB0VmVydHgoKSB7XG4gIHRyeSB7XG4gICAgdmFyIHZlcnR4ID0gRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKS5yZXF1aXJlKCd2ZXJ0eCcpO1xuICAgIHZlcnR4TmV4dCA9IHZlcnR4LnJ1bk9uTG9vcCB8fCB2ZXJ0eC5ydW5PbkNvbnRleHQ7XG4gICAgcmV0dXJuIHVzZVZlcnR4VGltZXIoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB1c2VTZXRUaW1lb3V0KCk7XG4gIH1cbn1cblxudmFyIHNjaGVkdWxlRmx1c2ggPSB2b2lkIDA7XG4vLyBEZWNpZGUgd2hhdCBhc3luYyBtZXRob2QgdG8gdXNlIHRvIHRyaWdnZXJpbmcgcHJvY2Vzc2luZyBvZiBxdWV1ZWQgY2FsbGJhY2tzOlxuaWYgKGlzTm9kZSkge1xuICBzY2hlZHVsZUZsdXNoID0gdXNlTmV4dFRpY2soKTtcbn0gZWxzZSBpZiAoQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIpIHtcbiAgc2NoZWR1bGVGbHVzaCA9IHVzZU11dGF0aW9uT2JzZXJ2ZXIoKTtcbn0gZWxzZSBpZiAoaXNXb3JrZXIpIHtcbiAgc2NoZWR1bGVGbHVzaCA9IHVzZU1lc3NhZ2VDaGFubmVsKCk7XG59IGVsc2UgaWYgKGJyb3dzZXJXaW5kb3cgPT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgX2RlcmVxXyA9PT0gJ2Z1bmN0aW9uJykge1xuICBzY2hlZHVsZUZsdXNoID0gYXR0ZW1wdFZlcnR4KCk7XG59IGVsc2Uge1xuICBzY2hlZHVsZUZsdXNoID0gdXNlU2V0VGltZW91dCgpO1xufVxuXG5mdW5jdGlvbiB0aGVuKG9uRnVsZmlsbG1lbnQsIG9uUmVqZWN0aW9uKSB7XG4gIHZhciBwYXJlbnQgPSB0aGlzO1xuXG4gIHZhciBjaGlsZCA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKG5vb3ApO1xuXG4gIGlmIChjaGlsZFtQUk9NSVNFX0lEXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgbWFrZVByb21pc2UoY2hpbGQpO1xuICB9XG5cbiAgdmFyIF9zdGF0ZSA9IHBhcmVudC5fc3RhdGU7XG5cblxuICBpZiAoX3N0YXRlKSB7XG4gICAgdmFyIGNhbGxiYWNrID0gYXJndW1lbnRzW19zdGF0ZSAtIDFdO1xuICAgIGFzYXAoZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIGludm9rZUNhbGxiYWNrKF9zdGF0ZSwgY2hpbGQsIGNhbGxiYWNrLCBwYXJlbnQuX3Jlc3VsdCk7XG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgc3Vic2NyaWJlKHBhcmVudCwgY2hpbGQsIG9uRnVsZmlsbG1lbnQsIG9uUmVqZWN0aW9uKTtcbiAgfVxuXG4gIHJldHVybiBjaGlsZDtcbn1cblxuLyoqXG4gIGBQcm9taXNlLnJlc29sdmVgIHJldHVybnMgYSBwcm9taXNlIHRoYXQgd2lsbCBiZWNvbWUgcmVzb2x2ZWQgd2l0aCB0aGVcbiAgcGFzc2VkIGB2YWx1ZWAuIEl0IGlzIHNob3J0aGFuZCBmb3IgdGhlIGZvbGxvd2luZzpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICByZXNvbHZlKDEpO1xuICB9KTtcblxuICBwcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpe1xuICAgIC8vIHZhbHVlID09PSAxXG4gIH0pO1xuICBgYGBcblxuICBJbnN0ZWFkIG9mIHdyaXRpbmcgdGhlIGFib3ZlLCB5b3VyIGNvZGUgbm93IHNpbXBseSBiZWNvbWVzIHRoZSBmb2xsb3dpbmc6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZSgxKTtcblxuICBwcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpe1xuICAgIC8vIHZhbHVlID09PSAxXG4gIH0pO1xuICBgYGBcblxuICBAbWV0aG9kIHJlc29sdmVcbiAgQHN0YXRpY1xuICBAcGFyYW0ge0FueX0gdmFsdWUgdmFsdWUgdGhhdCB0aGUgcmV0dXJuZWQgcHJvbWlzZSB3aWxsIGJlIHJlc29sdmVkIHdpdGhcbiAgVXNlZnVsIGZvciB0b29saW5nLlxuICBAcmV0dXJuIHtQcm9taXNlfSBhIHByb21pc2UgdGhhdCB3aWxsIGJlY29tZSBmdWxmaWxsZWQgd2l0aCB0aGUgZ2l2ZW5cbiAgYHZhbHVlYFxuKi9cbmZ1bmN0aW9uIHJlc29sdmUkMShvYmplY3QpIHtcbiAgLypqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cbiAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcblxuICBpZiAob2JqZWN0ICYmIHR5cGVvZiBvYmplY3QgPT09ICdvYmplY3QnICYmIG9iamVjdC5jb25zdHJ1Y3RvciA9PT0gQ29uc3RydWN0b3IpIHtcbiAgICByZXR1cm4gb2JqZWN0O1xuICB9XG5cbiAgdmFyIHByb21pc2UgPSBuZXcgQ29uc3RydWN0b3Iobm9vcCk7XG4gIHJlc29sdmUocHJvbWlzZSwgb2JqZWN0KTtcbiAgcmV0dXJuIHByb21pc2U7XG59XG5cbnZhciBQUk9NSVNFX0lEID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIpO1xuXG5mdW5jdGlvbiBub29wKCkge31cblxudmFyIFBFTkRJTkcgPSB2b2lkIDA7XG52YXIgRlVMRklMTEVEID0gMTtcbnZhciBSRUpFQ1RFRCA9IDI7XG5cbnZhciBUUllfQ0FUQ0hfRVJST1IgPSB7IGVycm9yOiBudWxsIH07XG5cbmZ1bmN0aW9uIHNlbGZGdWxmaWxsbWVudCgpIHtcbiAgcmV0dXJuIG5ldyBUeXBlRXJyb3IoXCJZb3UgY2Fubm90IHJlc29sdmUgYSBwcm9taXNlIHdpdGggaXRzZWxmXCIpO1xufVxuXG5mdW5jdGlvbiBjYW5ub3RSZXR1cm5Pd24oKSB7XG4gIHJldHVybiBuZXcgVHlwZUVycm9yKCdBIHByb21pc2VzIGNhbGxiYWNrIGNhbm5vdCByZXR1cm4gdGhhdCBzYW1lIHByb21pc2UuJyk7XG59XG5cbmZ1bmN0aW9uIGdldFRoZW4ocHJvbWlzZSkge1xuICB0cnkge1xuICAgIHJldHVybiBwcm9taXNlLnRoZW47XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgVFJZX0NBVENIX0VSUk9SLmVycm9yID0gZXJyb3I7XG4gICAgcmV0dXJuIFRSWV9DQVRDSF9FUlJPUjtcbiAgfVxufVxuXG5mdW5jdGlvbiB0cnlUaGVuKHRoZW4kJDEsIHZhbHVlLCBmdWxmaWxsbWVudEhhbmRsZXIsIHJlamVjdGlvbkhhbmRsZXIpIHtcbiAgdHJ5IHtcbiAgICB0aGVuJCQxLmNhbGwodmFsdWUsIGZ1bGZpbGxtZW50SGFuZGxlciwgcmVqZWN0aW9uSGFuZGxlcik7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBoYW5kbGVGb3JlaWduVGhlbmFibGUocHJvbWlzZSwgdGhlbmFibGUsIHRoZW4kJDEpIHtcbiAgYXNhcChmdW5jdGlvbiAocHJvbWlzZSkge1xuICAgIHZhciBzZWFsZWQgPSBmYWxzZTtcbiAgICB2YXIgZXJyb3IgPSB0cnlUaGVuKHRoZW4kJDEsIHRoZW5hYmxlLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIGlmIChzZWFsZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgc2VhbGVkID0gdHJ1ZTtcbiAgICAgIGlmICh0aGVuYWJsZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmdWxmaWxsKHByb21pc2UsIHZhbHVlKTtcbiAgICAgIH1cbiAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICBpZiAoc2VhbGVkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHNlYWxlZCA9IHRydWU7XG5cbiAgICAgIHJlamVjdChwcm9taXNlLCByZWFzb24pO1xuICAgIH0sICdTZXR0bGU6ICcgKyAocHJvbWlzZS5fbGFiZWwgfHwgJyB1bmtub3duIHByb21pc2UnKSk7XG5cbiAgICBpZiAoIXNlYWxlZCAmJiBlcnJvcikge1xuICAgICAgc2VhbGVkID0gdHJ1ZTtcbiAgICAgIHJlamVjdChwcm9taXNlLCBlcnJvcik7XG4gICAgfVxuICB9LCBwcm9taXNlKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlT3duVGhlbmFibGUocHJvbWlzZSwgdGhlbmFibGUpIHtcbiAgaWYgKHRoZW5hYmxlLl9zdGF0ZSA9PT0gRlVMRklMTEVEKSB7XG4gICAgZnVsZmlsbChwcm9taXNlLCB0aGVuYWJsZS5fcmVzdWx0KTtcbiAgfSBlbHNlIGlmICh0aGVuYWJsZS5fc3RhdGUgPT09IFJFSkVDVEVEKSB7XG4gICAgcmVqZWN0KHByb21pc2UsIHRoZW5hYmxlLl9yZXN1bHQpO1xuICB9IGVsc2Uge1xuICAgIHN1YnNjcmliZSh0aGVuYWJsZSwgdW5kZWZpbmVkLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgIHJldHVybiByZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcbiAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICByZXR1cm4gcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG4gICAgfSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaGFuZGxlTWF5YmVUaGVuYWJsZShwcm9taXNlLCBtYXliZVRoZW5hYmxlLCB0aGVuJCQxKSB7XG4gIGlmIChtYXliZVRoZW5hYmxlLmNvbnN0cnVjdG9yID09PSBwcm9taXNlLmNvbnN0cnVjdG9yICYmIHRoZW4kJDEgPT09IHRoZW4gJiYgbWF5YmVUaGVuYWJsZS5jb25zdHJ1Y3Rvci5yZXNvbHZlID09PSByZXNvbHZlJDEpIHtcbiAgICBoYW5kbGVPd25UaGVuYWJsZShwcm9taXNlLCBtYXliZVRoZW5hYmxlKTtcbiAgfSBlbHNlIHtcbiAgICBpZiAodGhlbiQkMSA9PT0gVFJZX0NBVENIX0VSUk9SKSB7XG4gICAgICByZWplY3QocHJvbWlzZSwgVFJZX0NBVENIX0VSUk9SLmVycm9yKTtcbiAgICAgIFRSWV9DQVRDSF9FUlJPUi5lcnJvciA9IG51bGw7XG4gICAgfSBlbHNlIGlmICh0aGVuJCQxID09PSB1bmRlZmluZWQpIHtcbiAgICAgIGZ1bGZpbGwocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSk7XG4gICAgfSBlbHNlIGlmIChpc0Z1bmN0aW9uKHRoZW4kJDEpKSB7XG4gICAgICBoYW5kbGVGb3JlaWduVGhlbmFibGUocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSwgdGhlbiQkMSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZ1bGZpbGwocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSk7XG4gICAgfVxuICB9XG59XG5cbmZ1bmN0aW9uIHJlc29sdmUocHJvbWlzZSwgdmFsdWUpIHtcbiAgaWYgKHByb21pc2UgPT09IHZhbHVlKSB7XG4gICAgcmVqZWN0KHByb21pc2UsIHNlbGZGdWxmaWxsbWVudCgpKTtcbiAgfSBlbHNlIGlmIChvYmplY3RPckZ1bmN0aW9uKHZhbHVlKSkge1xuICAgIGhhbmRsZU1heWJlVGhlbmFibGUocHJvbWlzZSwgdmFsdWUsIGdldFRoZW4odmFsdWUpKTtcbiAgfSBlbHNlIHtcbiAgICBmdWxmaWxsKHByb21pc2UsIHZhbHVlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBwdWJsaXNoUmVqZWN0aW9uKHByb21pc2UpIHtcbiAgaWYgKHByb21pc2UuX29uZXJyb3IpIHtcbiAgICBwcm9taXNlLl9vbmVycm9yKHByb21pc2UuX3Jlc3VsdCk7XG4gIH1cblxuICBwdWJsaXNoKHByb21pc2UpO1xufVxuXG5mdW5jdGlvbiBmdWxmaWxsKHByb21pc2UsIHZhbHVlKSB7XG4gIGlmIChwcm9taXNlLl9zdGF0ZSAhPT0gUEVORElORykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHByb21pc2UuX3Jlc3VsdCA9IHZhbHVlO1xuICBwcm9taXNlLl9zdGF0ZSA9IEZVTEZJTExFRDtcblxuICBpZiAocHJvbWlzZS5fc3Vic2NyaWJlcnMubGVuZ3RoICE9PSAwKSB7XG4gICAgYXNhcChwdWJsaXNoLCBwcm9taXNlKTtcbiAgfVxufVxuXG5mdW5jdGlvbiByZWplY3QocHJvbWlzZSwgcmVhc29uKSB7XG4gIGlmIChwcm9taXNlLl9zdGF0ZSAhPT0gUEVORElORykge1xuICAgIHJldHVybjtcbiAgfVxuICBwcm9taXNlLl9zdGF0ZSA9IFJFSkVDVEVEO1xuICBwcm9taXNlLl9yZXN1bHQgPSByZWFzb247XG5cbiAgYXNhcChwdWJsaXNoUmVqZWN0aW9uLCBwcm9taXNlKTtcbn1cblxuZnVuY3Rpb24gc3Vic2NyaWJlKHBhcmVudCwgY2hpbGQsIG9uRnVsZmlsbG1lbnQsIG9uUmVqZWN0aW9uKSB7XG4gIHZhciBfc3Vic2NyaWJlcnMgPSBwYXJlbnQuX3N1YnNjcmliZXJzO1xuICB2YXIgbGVuZ3RoID0gX3N1YnNjcmliZXJzLmxlbmd0aDtcblxuXG4gIHBhcmVudC5fb25lcnJvciA9IG51bGw7XG5cbiAgX3N1YnNjcmliZXJzW2xlbmd0aF0gPSBjaGlsZDtcbiAgX3N1YnNjcmliZXJzW2xlbmd0aCArIEZVTEZJTExFRF0gPSBvbkZ1bGZpbGxtZW50O1xuICBfc3Vic2NyaWJlcnNbbGVuZ3RoICsgUkVKRUNURURdID0gb25SZWplY3Rpb247XG5cbiAgaWYgKGxlbmd0aCA9PT0gMCAmJiBwYXJlbnQuX3N0YXRlKSB7XG4gICAgYXNhcChwdWJsaXNoLCBwYXJlbnQpO1xuICB9XG59XG5cbmZ1bmN0aW9uIHB1Ymxpc2gocHJvbWlzZSkge1xuICB2YXIgc3Vic2NyaWJlcnMgPSBwcm9taXNlLl9zdWJzY3JpYmVycztcbiAgdmFyIHNldHRsZWQgPSBwcm9taXNlLl9zdGF0ZTtcblxuICBpZiAoc3Vic2NyaWJlcnMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGNoaWxkID0gdm9pZCAwLFxuICAgICAgY2FsbGJhY2sgPSB2b2lkIDAsXG4gICAgICBkZXRhaWwgPSBwcm9taXNlLl9yZXN1bHQ7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdWJzY3JpYmVycy5sZW5ndGg7IGkgKz0gMykge1xuICAgIGNoaWxkID0gc3Vic2NyaWJlcnNbaV07XG4gICAgY2FsbGJhY2sgPSBzdWJzY3JpYmVyc1tpICsgc2V0dGxlZF07XG5cbiAgICBpZiAoY2hpbGQpIHtcbiAgICAgIGludm9rZUNhbGxiYWNrKHNldHRsZWQsIGNoaWxkLCBjYWxsYmFjaywgZGV0YWlsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2FsbGJhY2soZGV0YWlsKTtcbiAgICB9XG4gIH1cblxuICBwcm9taXNlLl9zdWJzY3JpYmVycy5sZW5ndGggPSAwO1xufVxuXG5mdW5jdGlvbiB0cnlDYXRjaChjYWxsYmFjaywgZGV0YWlsKSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGNhbGxiYWNrKGRldGFpbCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICBUUllfQ0FUQ0hfRVJST1IuZXJyb3IgPSBlO1xuICAgIHJldHVybiBUUllfQ0FUQ0hfRVJST1I7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW52b2tlQ2FsbGJhY2soc2V0dGxlZCwgcHJvbWlzZSwgY2FsbGJhY2ssIGRldGFpbCkge1xuICB2YXIgaGFzQ2FsbGJhY2sgPSBpc0Z1bmN0aW9uKGNhbGxiYWNrKSxcbiAgICAgIHZhbHVlID0gdm9pZCAwLFxuICAgICAgZXJyb3IgPSB2b2lkIDAsXG4gICAgICBzdWNjZWVkZWQgPSB2b2lkIDAsXG4gICAgICBmYWlsZWQgPSB2b2lkIDA7XG5cbiAgaWYgKGhhc0NhbGxiYWNrKSB7XG4gICAgdmFsdWUgPSB0cnlDYXRjaChjYWxsYmFjaywgZGV0YWlsKTtcblxuICAgIGlmICh2YWx1ZSA9PT0gVFJZX0NBVENIX0VSUk9SKSB7XG4gICAgICBmYWlsZWQgPSB0cnVlO1xuICAgICAgZXJyb3IgPSB2YWx1ZS5lcnJvcjtcbiAgICAgIHZhbHVlLmVycm9yID0gbnVsbDtcbiAgICB9IGVsc2Uge1xuICAgICAgc3VjY2VlZGVkID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAocHJvbWlzZSA9PT0gdmFsdWUpIHtcbiAgICAgIHJlamVjdChwcm9taXNlLCBjYW5ub3RSZXR1cm5Pd24oKSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHZhbHVlID0gZGV0YWlsO1xuICAgIHN1Y2NlZWRlZCA9IHRydWU7XG4gIH1cblxuICBpZiAocHJvbWlzZS5fc3RhdGUgIT09IFBFTkRJTkcpIHtcbiAgICAvLyBub29wXG4gIH0gZWxzZSBpZiAoaGFzQ2FsbGJhY2sgJiYgc3VjY2VlZGVkKSB7XG4gICAgcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSk7XG4gIH0gZWxzZSBpZiAoZmFpbGVkKSB7XG4gICAgcmVqZWN0KHByb21pc2UsIGVycm9yKTtcbiAgfSBlbHNlIGlmIChzZXR0bGVkID09PSBGVUxGSUxMRUQpIHtcbiAgICBmdWxmaWxsKHByb21pc2UsIHZhbHVlKTtcbiAgfSBlbHNlIGlmIChzZXR0bGVkID09PSBSRUpFQ1RFRCkge1xuICAgIHJlamVjdChwcm9taXNlLCB2YWx1ZSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaW5pdGlhbGl6ZVByb21pc2UocHJvbWlzZSwgcmVzb2x2ZXIpIHtcbiAgdHJ5IHtcbiAgICByZXNvbHZlcihmdW5jdGlvbiByZXNvbHZlUHJvbWlzZSh2YWx1ZSkge1xuICAgICAgcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSk7XG4gICAgfSwgZnVuY3Rpb24gcmVqZWN0UHJvbWlzZShyZWFzb24pIHtcbiAgICAgIHJlamVjdChwcm9taXNlLCByZWFzb24pO1xuICAgIH0pO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmVqZWN0KHByb21pc2UsIGUpO1xuICB9XG59XG5cbnZhciBpZCA9IDA7XG5mdW5jdGlvbiBuZXh0SWQoKSB7XG4gIHJldHVybiBpZCsrO1xufVxuXG5mdW5jdGlvbiBtYWtlUHJvbWlzZShwcm9taXNlKSB7XG4gIHByb21pc2VbUFJPTUlTRV9JRF0gPSBpZCsrO1xuICBwcm9taXNlLl9zdGF0ZSA9IHVuZGVmaW5lZDtcbiAgcHJvbWlzZS5fcmVzdWx0ID0gdW5kZWZpbmVkO1xuICBwcm9taXNlLl9zdWJzY3JpYmVycyA9IFtdO1xufVxuXG5mdW5jdGlvbiB2YWxpZGF0aW9uRXJyb3IoKSB7XG4gIHJldHVybiBuZXcgRXJyb3IoJ0FycmF5IE1ldGhvZHMgbXVzdCBiZSBwcm92aWRlZCBhbiBBcnJheScpO1xufVxuXG52YXIgRW51bWVyYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gRW51bWVyYXRvcihDb25zdHJ1Y3RvciwgaW5wdXQpIHtcbiAgICB0aGlzLl9pbnN0YW5jZUNvbnN0cnVjdG9yID0gQ29uc3RydWN0b3I7XG4gICAgdGhpcy5wcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKG5vb3ApO1xuXG4gICAgaWYgKCF0aGlzLnByb21pc2VbUFJPTUlTRV9JRF0pIHtcbiAgICAgIG1ha2VQcm9taXNlKHRoaXMucHJvbWlzZSk7XG4gICAgfVxuXG4gICAgaWYgKGlzQXJyYXkoaW5wdXQpKSB7XG4gICAgICB0aGlzLmxlbmd0aCA9IGlucHV0Lmxlbmd0aDtcbiAgICAgIHRoaXMuX3JlbWFpbmluZyA9IGlucHV0Lmxlbmd0aDtcblxuICAgICAgdGhpcy5fcmVzdWx0ID0gbmV3IEFycmF5KHRoaXMubGVuZ3RoKTtcblxuICAgICAgaWYgKHRoaXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGZ1bGZpbGwodGhpcy5wcm9taXNlLCB0aGlzLl9yZXN1bHQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5sZW5ndGggPSB0aGlzLmxlbmd0aCB8fCAwO1xuICAgICAgICB0aGlzLl9lbnVtZXJhdGUoaW5wdXQpO1xuICAgICAgICBpZiAodGhpcy5fcmVtYWluaW5nID09PSAwKSB7XG4gICAgICAgICAgZnVsZmlsbCh0aGlzLnByb21pc2UsIHRoaXMuX3Jlc3VsdCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmVqZWN0KHRoaXMucHJvbWlzZSwgdmFsaWRhdGlvbkVycm9yKCkpO1xuICAgIH1cbiAgfVxuXG4gIEVudW1lcmF0b3IucHJvdG90eXBlLl9lbnVtZXJhdGUgPSBmdW5jdGlvbiBfZW51bWVyYXRlKGlucHV0KSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IHRoaXMuX3N0YXRlID09PSBQRU5ESU5HICYmIGkgPCBpbnB1dC5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy5fZWFjaEVudHJ5KGlucHV0W2ldLCBpKTtcbiAgICB9XG4gIH07XG5cbiAgRW51bWVyYXRvci5wcm90b3R5cGUuX2VhY2hFbnRyeSA9IGZ1bmN0aW9uIF9lYWNoRW50cnkoZW50cnksIGkpIHtcbiAgICB2YXIgYyA9IHRoaXMuX2luc3RhbmNlQ29uc3RydWN0b3I7XG4gICAgdmFyIHJlc29sdmUkJDEgPSBjLnJlc29sdmU7XG5cblxuICAgIGlmIChyZXNvbHZlJCQxID09PSByZXNvbHZlJDEpIHtcbiAgICAgIHZhciBfdGhlbiA9IGdldFRoZW4oZW50cnkpO1xuXG4gICAgICBpZiAoX3RoZW4gPT09IHRoZW4gJiYgZW50cnkuX3N0YXRlICE9PSBQRU5ESU5HKSB7XG4gICAgICAgIHRoaXMuX3NldHRsZWRBdChlbnRyeS5fc3RhdGUsIGksIGVudHJ5Ll9yZXN1bHQpO1xuICAgICAgfSBlbHNlIGlmICh0eXBlb2YgX3RoZW4gIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5fcmVtYWluaW5nLS07XG4gICAgICAgIHRoaXMuX3Jlc3VsdFtpXSA9IGVudHJ5O1xuICAgICAgfSBlbHNlIGlmIChjID09PSBQcm9taXNlJDEpIHtcbiAgICAgICAgdmFyIHByb21pc2UgPSBuZXcgYyhub29wKTtcbiAgICAgICAgaGFuZGxlTWF5YmVUaGVuYWJsZShwcm9taXNlLCBlbnRyeSwgX3RoZW4pO1xuICAgICAgICB0aGlzLl93aWxsU2V0dGxlQXQocHJvbWlzZSwgaSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl93aWxsU2V0dGxlQXQobmV3IGMoZnVuY3Rpb24gKHJlc29sdmUkJDEpIHtcbiAgICAgICAgICByZXR1cm4gcmVzb2x2ZSQkMShlbnRyeSk7XG4gICAgICAgIH0pLCBpKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fd2lsbFNldHRsZUF0KHJlc29sdmUkJDEoZW50cnkpLCBpKTtcbiAgICB9XG4gIH07XG5cbiAgRW51bWVyYXRvci5wcm90b3R5cGUuX3NldHRsZWRBdCA9IGZ1bmN0aW9uIF9zZXR0bGVkQXQoc3RhdGUsIGksIHZhbHVlKSB7XG4gICAgdmFyIHByb21pc2UgPSB0aGlzLnByb21pc2U7XG5cblxuICAgIGlmIChwcm9taXNlLl9zdGF0ZSA9PT0gUEVORElORykge1xuICAgICAgdGhpcy5fcmVtYWluaW5nLS07XG5cbiAgICAgIGlmIChzdGF0ZSA9PT0gUkVKRUNURUQpIHtcbiAgICAgICAgcmVqZWN0KHByb21pc2UsIHZhbHVlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX3Jlc3VsdFtpXSA9IHZhbHVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLl9yZW1haW5pbmcgPT09IDApIHtcbiAgICAgIGZ1bGZpbGwocHJvbWlzZSwgdGhpcy5fcmVzdWx0KTtcbiAgICB9XG4gIH07XG5cbiAgRW51bWVyYXRvci5wcm90b3R5cGUuX3dpbGxTZXR0bGVBdCA9IGZ1bmN0aW9uIF93aWxsU2V0dGxlQXQocHJvbWlzZSwgaSkge1xuICAgIHZhciBlbnVtZXJhdG9yID0gdGhpcztcblxuICAgIHN1YnNjcmliZShwcm9taXNlLCB1bmRlZmluZWQsIGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgcmV0dXJuIGVudW1lcmF0b3IuX3NldHRsZWRBdChGVUxGSUxMRUQsIGksIHZhbHVlKTtcbiAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICByZXR1cm4gZW51bWVyYXRvci5fc2V0dGxlZEF0KFJFSkVDVEVELCBpLCByZWFzb24pO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiBFbnVtZXJhdG9yO1xufSgpO1xuXG4vKipcbiAgYFByb21pc2UuYWxsYCBhY2NlcHRzIGFuIGFycmF5IG9mIHByb21pc2VzLCBhbmQgcmV0dXJucyBhIG5ldyBwcm9taXNlIHdoaWNoXG4gIGlzIGZ1bGZpbGxlZCB3aXRoIGFuIGFycmF5IG9mIGZ1bGZpbGxtZW50IHZhbHVlcyBmb3IgdGhlIHBhc3NlZCBwcm9taXNlcywgb3JcbiAgcmVqZWN0ZWQgd2l0aCB0aGUgcmVhc29uIG9mIHRoZSBmaXJzdCBwYXNzZWQgcHJvbWlzZSB0byBiZSByZWplY3RlZC4gSXQgY2FzdHMgYWxsXG4gIGVsZW1lbnRzIG9mIHRoZSBwYXNzZWQgaXRlcmFibGUgdG8gcHJvbWlzZXMgYXMgaXQgcnVucyB0aGlzIGFsZ29yaXRobS5cblxuICBFeGFtcGxlOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UxID0gcmVzb2x2ZSgxKTtcbiAgbGV0IHByb21pc2UyID0gcmVzb2x2ZSgyKTtcbiAgbGV0IHByb21pc2UzID0gcmVzb2x2ZSgzKTtcbiAgbGV0IHByb21pc2VzID0gWyBwcm9taXNlMSwgcHJvbWlzZTIsIHByb21pc2UzIF07XG5cbiAgUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24oYXJyYXkpe1xuICAgIC8vIFRoZSBhcnJheSBoZXJlIHdvdWxkIGJlIFsgMSwgMiwgMyBdO1xuICB9KTtcbiAgYGBgXG5cbiAgSWYgYW55IG9mIHRoZSBgcHJvbWlzZXNgIGdpdmVuIHRvIGBhbGxgIGFyZSByZWplY3RlZCwgdGhlIGZpcnN0IHByb21pc2VcbiAgdGhhdCBpcyByZWplY3RlZCB3aWxsIGJlIGdpdmVuIGFzIGFuIGFyZ3VtZW50IHRvIHRoZSByZXR1cm5lZCBwcm9taXNlcydzXG4gIHJlamVjdGlvbiBoYW5kbGVyLiBGb3IgZXhhbXBsZTpcblxuICBFeGFtcGxlOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgbGV0IHByb21pc2UxID0gcmVzb2x2ZSgxKTtcbiAgbGV0IHByb21pc2UyID0gcmVqZWN0KG5ldyBFcnJvcihcIjJcIikpO1xuICBsZXQgcHJvbWlzZTMgPSByZWplY3QobmV3IEVycm9yKFwiM1wiKSk7XG4gIGxldCBwcm9taXNlcyA9IFsgcHJvbWlzZTEsIHByb21pc2UyLCBwcm9taXNlMyBdO1xuXG4gIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uKGFycmF5KXtcbiAgICAvLyBDb2RlIGhlcmUgbmV2ZXIgcnVucyBiZWNhdXNlIHRoZXJlIGFyZSByZWplY3RlZCBwcm9taXNlcyFcbiAgfSwgZnVuY3Rpb24oZXJyb3IpIHtcbiAgICAvLyBlcnJvci5tZXNzYWdlID09PSBcIjJcIlxuICB9KTtcbiAgYGBgXG5cbiAgQG1ldGhvZCBhbGxcbiAgQHN0YXRpY1xuICBAcGFyYW0ge0FycmF5fSBlbnRyaWVzIGFycmF5IG9mIHByb21pc2VzXG4gIEBwYXJhbSB7U3RyaW5nfSBsYWJlbCBvcHRpb25hbCBzdHJpbmcgZm9yIGxhYmVsaW5nIHRoZSBwcm9taXNlLlxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEByZXR1cm4ge1Byb21pc2V9IHByb21pc2UgdGhhdCBpcyBmdWxmaWxsZWQgd2hlbiBhbGwgYHByb21pc2VzYCBoYXZlIGJlZW5cbiAgZnVsZmlsbGVkLCBvciByZWplY3RlZCBpZiBhbnkgb2YgdGhlbSBiZWNvbWUgcmVqZWN0ZWQuXG4gIEBzdGF0aWNcbiovXG5mdW5jdGlvbiBhbGwoZW50cmllcykge1xuICByZXR1cm4gbmV3IEVudW1lcmF0b3IodGhpcywgZW50cmllcykucHJvbWlzZTtcbn1cblxuLyoqXG4gIGBQcm9taXNlLnJhY2VgIHJldHVybnMgYSBuZXcgcHJvbWlzZSB3aGljaCBpcyBzZXR0bGVkIGluIHRoZSBzYW1lIHdheSBhcyB0aGVcbiAgZmlyc3QgcGFzc2VkIHByb21pc2UgdG8gc2V0dGxlLlxuXG4gIEV4YW1wbGU6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZTEgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIHJlc29sdmUoJ3Byb21pc2UgMScpO1xuICAgIH0sIDIwMCk7XG4gIH0pO1xuXG4gIGxldCBwcm9taXNlMiA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgcmVzb2x2ZSgncHJvbWlzZSAyJyk7XG4gICAgfSwgMTAwKTtcbiAgfSk7XG5cbiAgUHJvbWlzZS5yYWNlKFtwcm9taXNlMSwgcHJvbWlzZTJdKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgLy8gcmVzdWx0ID09PSAncHJvbWlzZSAyJyBiZWNhdXNlIGl0IHdhcyByZXNvbHZlZCBiZWZvcmUgcHJvbWlzZTFcbiAgICAvLyB3YXMgcmVzb2x2ZWQuXG4gIH0pO1xuICBgYGBcblxuICBgUHJvbWlzZS5yYWNlYCBpcyBkZXRlcm1pbmlzdGljIGluIHRoYXQgb25seSB0aGUgc3RhdGUgb2YgdGhlIGZpcnN0XG4gIHNldHRsZWQgcHJvbWlzZSBtYXR0ZXJzLiBGb3IgZXhhbXBsZSwgZXZlbiBpZiBvdGhlciBwcm9taXNlcyBnaXZlbiB0byB0aGVcbiAgYHByb21pc2VzYCBhcnJheSBhcmd1bWVudCBhcmUgcmVzb2x2ZWQsIGJ1dCB0aGUgZmlyc3Qgc2V0dGxlZCBwcm9taXNlIGhhc1xuICBiZWNvbWUgcmVqZWN0ZWQgYmVmb3JlIHRoZSBvdGhlciBwcm9taXNlcyBiZWNhbWUgZnVsZmlsbGVkLCB0aGUgcmV0dXJuZWRcbiAgcHJvbWlzZSB3aWxsIGJlY29tZSByZWplY3RlZDpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlMSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgcmVzb2x2ZSgncHJvbWlzZSAxJyk7XG4gICAgfSwgMjAwKTtcbiAgfSk7XG5cbiAgbGV0IHByb21pc2UyID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICByZWplY3QobmV3IEVycm9yKCdwcm9taXNlIDInKSk7XG4gICAgfSwgMTAwKTtcbiAgfSk7XG5cbiAgUHJvbWlzZS5yYWNlKFtwcm9taXNlMSwgcHJvbWlzZTJdKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgLy8gQ29kZSBoZXJlIG5ldmVyIHJ1bnNcbiAgfSwgZnVuY3Rpb24ocmVhc29uKXtcbiAgICAvLyByZWFzb24ubWVzc2FnZSA9PT0gJ3Byb21pc2UgMicgYmVjYXVzZSBwcm9taXNlIDIgYmVjYW1lIHJlamVjdGVkIGJlZm9yZVxuICAgIC8vIHByb21pc2UgMSBiZWNhbWUgZnVsZmlsbGVkXG4gIH0pO1xuICBgYGBcblxuICBBbiBleGFtcGxlIHJlYWwtd29ybGQgdXNlIGNhc2UgaXMgaW1wbGVtZW50aW5nIHRpbWVvdXRzOlxuXG4gIGBgYGphdmFzY3JpcHRcbiAgUHJvbWlzZS5yYWNlKFthamF4KCdmb28uanNvbicpLCB0aW1lb3V0KDUwMDApXSlcbiAgYGBgXG5cbiAgQG1ldGhvZCByYWNlXG4gIEBzdGF0aWNcbiAgQHBhcmFtIHtBcnJheX0gcHJvbWlzZXMgYXJyYXkgb2YgcHJvbWlzZXMgdG8gb2JzZXJ2ZVxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEByZXR1cm4ge1Byb21pc2V9IGEgcHJvbWlzZSB3aGljaCBzZXR0bGVzIGluIHRoZSBzYW1lIHdheSBhcyB0aGUgZmlyc3QgcGFzc2VkXG4gIHByb21pc2UgdG8gc2V0dGxlLlxuKi9cbmZ1bmN0aW9uIHJhY2UoZW50cmllcykge1xuICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuXG4gIGlmICghaXNBcnJheShlbnRyaWVzKSkge1xuICAgIHJldHVybiBuZXcgQ29uc3RydWN0b3IoZnVuY3Rpb24gKF8sIHJlamVjdCkge1xuICAgICAgcmV0dXJuIHJlamVjdChuZXcgVHlwZUVycm9yKCdZb3UgbXVzdCBwYXNzIGFuIGFycmF5IHRvIHJhY2UuJykpO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBuZXcgQ29uc3RydWN0b3IoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgdmFyIGxlbmd0aCA9IGVudHJpZXMubGVuZ3RoO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICBDb25zdHJ1Y3Rvci5yZXNvbHZlKGVudHJpZXNbaV0pLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAgYFByb21pc2UucmVqZWN0YCByZXR1cm5zIGEgcHJvbWlzZSByZWplY3RlZCB3aXRoIHRoZSBwYXNzZWQgYHJlYXNvbmAuXG4gIEl0IGlzIHNob3J0aGFuZCBmb3IgdGhlIGZvbGxvd2luZzpcblxuICBgYGBqYXZhc2NyaXB0XG4gIGxldCBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICByZWplY3QobmV3IEVycm9yKCdXSE9PUFMnKSk7XG4gIH0pO1xuXG4gIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgLy8gQ29kZSBoZXJlIGRvZXNuJ3QgcnVuIGJlY2F1c2UgdGhlIHByb21pc2UgaXMgcmVqZWN0ZWQhXG4gIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgLy8gcmVhc29uLm1lc3NhZ2UgPT09ICdXSE9PUFMnXG4gIH0pO1xuICBgYGBcblxuICBJbnN0ZWFkIG9mIHdyaXRpbmcgdGhlIGFib3ZlLCB5b3VyIGNvZGUgbm93IHNpbXBseSBiZWNvbWVzIHRoZSBmb2xsb3dpbmc6XG5cbiAgYGBgamF2YXNjcmlwdFxuICBsZXQgcHJvbWlzZSA9IFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignV0hPT1BTJykpO1xuXG4gIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSl7XG4gICAgLy8gQ29kZSBoZXJlIGRvZXNuJ3QgcnVuIGJlY2F1c2UgdGhlIHByb21pc2UgaXMgcmVqZWN0ZWQhXG4gIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgLy8gcmVhc29uLm1lc3NhZ2UgPT09ICdXSE9PUFMnXG4gIH0pO1xuICBgYGBcblxuICBAbWV0aG9kIHJlamVjdFxuICBAc3RhdGljXG4gIEBwYXJhbSB7QW55fSByZWFzb24gdmFsdWUgdGhhdCB0aGUgcmV0dXJuZWQgcHJvbWlzZSB3aWxsIGJlIHJlamVjdGVkIHdpdGguXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQHJldHVybiB7UHJvbWlzZX0gYSBwcm9taXNlIHJlamVjdGVkIHdpdGggdGhlIGdpdmVuIGByZWFzb25gLlxuKi9cbmZ1bmN0aW9uIHJlamVjdCQxKHJlYXNvbikge1xuICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuICB2YXIgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3Rvcihub29wKTtcbiAgcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG4gIHJldHVybiBwcm9taXNlO1xufVxuXG5mdW5jdGlvbiBuZWVkc1Jlc29sdmVyKCkge1xuICB0aHJvdyBuZXcgVHlwZUVycm9yKCdZb3UgbXVzdCBwYXNzIGEgcmVzb2x2ZXIgZnVuY3Rpb24gYXMgdGhlIGZpcnN0IGFyZ3VtZW50IHRvIHRoZSBwcm9taXNlIGNvbnN0cnVjdG9yJyk7XG59XG5cbmZ1bmN0aW9uIG5lZWRzTmV3KCkge1xuICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRmFpbGVkIHRvIGNvbnN0cnVjdCAnUHJvbWlzZSc6IFBsZWFzZSB1c2UgdGhlICduZXcnIG9wZXJhdG9yLCB0aGlzIG9iamVjdCBjb25zdHJ1Y3RvciBjYW5ub3QgYmUgY2FsbGVkIGFzIGEgZnVuY3Rpb24uXCIpO1xufVxuXG4vKipcbiAgUHJvbWlzZSBvYmplY3RzIHJlcHJlc2VudCB0aGUgZXZlbnR1YWwgcmVzdWx0IG9mIGFuIGFzeW5jaHJvbm91cyBvcGVyYXRpb24uIFRoZVxuICBwcmltYXJ5IHdheSBvZiBpbnRlcmFjdGluZyB3aXRoIGEgcHJvbWlzZSBpcyB0aHJvdWdoIGl0cyBgdGhlbmAgbWV0aG9kLCB3aGljaFxuICByZWdpc3RlcnMgY2FsbGJhY2tzIHRvIHJlY2VpdmUgZWl0aGVyIGEgcHJvbWlzZSdzIGV2ZW50dWFsIHZhbHVlIG9yIHRoZSByZWFzb25cbiAgd2h5IHRoZSBwcm9taXNlIGNhbm5vdCBiZSBmdWxmaWxsZWQuXG5cbiAgVGVybWlub2xvZ3lcbiAgLS0tLS0tLS0tLS1cblxuICAtIGBwcm9taXNlYCBpcyBhbiBvYmplY3Qgb3IgZnVuY3Rpb24gd2l0aCBhIGB0aGVuYCBtZXRob2Qgd2hvc2UgYmVoYXZpb3IgY29uZm9ybXMgdG8gdGhpcyBzcGVjaWZpY2F0aW9uLlxuICAtIGB0aGVuYWJsZWAgaXMgYW4gb2JqZWN0IG9yIGZ1bmN0aW9uIHRoYXQgZGVmaW5lcyBhIGB0aGVuYCBtZXRob2QuXG4gIC0gYHZhbHVlYCBpcyBhbnkgbGVnYWwgSmF2YVNjcmlwdCB2YWx1ZSAoaW5jbHVkaW5nIHVuZGVmaW5lZCwgYSB0aGVuYWJsZSwgb3IgYSBwcm9taXNlKS5cbiAgLSBgZXhjZXB0aW9uYCBpcyBhIHZhbHVlIHRoYXQgaXMgdGhyb3duIHVzaW5nIHRoZSB0aHJvdyBzdGF0ZW1lbnQuXG4gIC0gYHJlYXNvbmAgaXMgYSB2YWx1ZSB0aGF0IGluZGljYXRlcyB3aHkgYSBwcm9taXNlIHdhcyByZWplY3RlZC5cbiAgLSBgc2V0dGxlZGAgdGhlIGZpbmFsIHJlc3Rpbmcgc3RhdGUgb2YgYSBwcm9taXNlLCBmdWxmaWxsZWQgb3IgcmVqZWN0ZWQuXG5cbiAgQSBwcm9taXNlIGNhbiBiZSBpbiBvbmUgb2YgdGhyZWUgc3RhdGVzOiBwZW5kaW5nLCBmdWxmaWxsZWQsIG9yIHJlamVjdGVkLlxuXG4gIFByb21pc2VzIHRoYXQgYXJlIGZ1bGZpbGxlZCBoYXZlIGEgZnVsZmlsbG1lbnQgdmFsdWUgYW5kIGFyZSBpbiB0aGUgZnVsZmlsbGVkXG4gIHN0YXRlLiAgUHJvbWlzZXMgdGhhdCBhcmUgcmVqZWN0ZWQgaGF2ZSBhIHJlamVjdGlvbiByZWFzb24gYW5kIGFyZSBpbiB0aGVcbiAgcmVqZWN0ZWQgc3RhdGUuICBBIGZ1bGZpbGxtZW50IHZhbHVlIGlzIG5ldmVyIGEgdGhlbmFibGUuXG5cbiAgUHJvbWlzZXMgY2FuIGFsc28gYmUgc2FpZCB0byAqcmVzb2x2ZSogYSB2YWx1ZS4gIElmIHRoaXMgdmFsdWUgaXMgYWxzbyBhXG4gIHByb21pc2UsIHRoZW4gdGhlIG9yaWdpbmFsIHByb21pc2UncyBzZXR0bGVkIHN0YXRlIHdpbGwgbWF0Y2ggdGhlIHZhbHVlJ3NcbiAgc2V0dGxlZCBzdGF0ZS4gIFNvIGEgcHJvbWlzZSB0aGF0ICpyZXNvbHZlcyogYSBwcm9taXNlIHRoYXQgcmVqZWN0cyB3aWxsXG4gIGl0c2VsZiByZWplY3QsIGFuZCBhIHByb21pc2UgdGhhdCAqcmVzb2x2ZXMqIGEgcHJvbWlzZSB0aGF0IGZ1bGZpbGxzIHdpbGxcbiAgaXRzZWxmIGZ1bGZpbGwuXG5cblxuICBCYXNpYyBVc2FnZTpcbiAgLS0tLS0tLS0tLS0tXG5cbiAgYGBganNcbiAgbGV0IHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAvLyBvbiBzdWNjZXNzXG4gICAgcmVzb2x2ZSh2YWx1ZSk7XG5cbiAgICAvLyBvbiBmYWlsdXJlXG4gICAgcmVqZWN0KHJlYXNvbik7XG4gIH0pO1xuXG4gIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgIC8vIG9uIGZ1bGZpbGxtZW50XG4gIH0sIGZ1bmN0aW9uKHJlYXNvbikge1xuICAgIC8vIG9uIHJlamVjdGlvblxuICB9KTtcbiAgYGBgXG5cbiAgQWR2YW5jZWQgVXNhZ2U6XG4gIC0tLS0tLS0tLS0tLS0tLVxuXG4gIFByb21pc2VzIHNoaW5lIHdoZW4gYWJzdHJhY3RpbmcgYXdheSBhc3luY2hyb25vdXMgaW50ZXJhY3Rpb25zIHN1Y2ggYXNcbiAgYFhNTEh0dHBSZXF1ZXN0YHMuXG5cbiAgYGBganNcbiAgZnVuY3Rpb24gZ2V0SlNPTih1cmwpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcbiAgICAgIGxldCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblxuICAgICAgeGhyLm9wZW4oJ0dFVCcsIHVybCk7XG4gICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gaGFuZGxlcjtcbiAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnanNvbic7XG4gICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQWNjZXB0JywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcbiAgICAgIHhoci5zZW5kKCk7XG5cbiAgICAgIGZ1bmN0aW9uIGhhbmRsZXIoKSB7XG4gICAgICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IHRoaXMuRE9ORSkge1xuICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICByZXNvbHZlKHRoaXMucmVzcG9uc2UpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdnZXRKU09OOiBgJyArIHVybCArICdgIGZhaWxlZCB3aXRoIHN0YXR1czogWycgKyB0aGlzLnN0YXR1cyArICddJykpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldEpTT04oJy9wb3N0cy5qc29uJykudGhlbihmdW5jdGlvbihqc29uKSB7XG4gICAgLy8gb24gZnVsZmlsbG1lbnRcbiAgfSwgZnVuY3Rpb24ocmVhc29uKSB7XG4gICAgLy8gb24gcmVqZWN0aW9uXG4gIH0pO1xuICBgYGBcblxuICBVbmxpa2UgY2FsbGJhY2tzLCBwcm9taXNlcyBhcmUgZ3JlYXQgY29tcG9zYWJsZSBwcmltaXRpdmVzLlxuXG4gIGBgYGpzXG4gIFByb21pc2UuYWxsKFtcbiAgICBnZXRKU09OKCcvcG9zdHMnKSxcbiAgICBnZXRKU09OKCcvY29tbWVudHMnKVxuICBdKS50aGVuKGZ1bmN0aW9uKHZhbHVlcyl7XG4gICAgdmFsdWVzWzBdIC8vID0+IHBvc3RzSlNPTlxuICAgIHZhbHVlc1sxXSAvLyA9PiBjb21tZW50c0pTT05cblxuICAgIHJldHVybiB2YWx1ZXM7XG4gIH0pO1xuICBgYGBcblxuICBAY2xhc3MgUHJvbWlzZVxuICBAcGFyYW0ge0Z1bmN0aW9ufSByZXNvbHZlclxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEBjb25zdHJ1Y3RvclxuKi9cblxudmFyIFByb21pc2UkMSA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUHJvbWlzZShyZXNvbHZlcikge1xuICAgIHRoaXNbUFJPTUlTRV9JRF0gPSBuZXh0SWQoKTtcbiAgICB0aGlzLl9yZXN1bHQgPSB0aGlzLl9zdGF0ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLl9zdWJzY3JpYmVycyA9IFtdO1xuXG4gICAgaWYgKG5vb3AgIT09IHJlc29sdmVyKSB7XG4gICAgICB0eXBlb2YgcmVzb2x2ZXIgIT09ICdmdW5jdGlvbicgJiYgbmVlZHNSZXNvbHZlcigpO1xuICAgICAgdGhpcyBpbnN0YW5jZW9mIFByb21pc2UgPyBpbml0aWFsaXplUHJvbWlzZSh0aGlzLCByZXNvbHZlcikgOiBuZWVkc05ldygpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICBUaGUgcHJpbWFyeSB3YXkgb2YgaW50ZXJhY3Rpbmcgd2l0aCBhIHByb21pc2UgaXMgdGhyb3VnaCBpdHMgYHRoZW5gIG1ldGhvZCxcbiAgd2hpY2ggcmVnaXN0ZXJzIGNhbGxiYWNrcyB0byByZWNlaXZlIGVpdGhlciBhIHByb21pc2UncyBldmVudHVhbCB2YWx1ZSBvciB0aGVcbiAgcmVhc29uIHdoeSB0aGUgcHJvbWlzZSBjYW5ub3QgYmUgZnVsZmlsbGVkLlxuICAgYGBganNcbiAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uKHVzZXIpe1xuICAgIC8vIHVzZXIgaXMgYXZhaWxhYmxlXG4gIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG4gICAgLy8gdXNlciBpcyB1bmF2YWlsYWJsZSwgYW5kIHlvdSBhcmUgZ2l2ZW4gdGhlIHJlYXNvbiB3aHlcbiAgfSk7XG4gIGBgYFxuICAgQ2hhaW5pbmdcbiAgLS0tLS0tLS1cbiAgIFRoZSByZXR1cm4gdmFsdWUgb2YgYHRoZW5gIGlzIGl0c2VsZiBhIHByb21pc2UuICBUaGlzIHNlY29uZCwgJ2Rvd25zdHJlYW0nXG4gIHByb21pc2UgaXMgcmVzb2x2ZWQgd2l0aCB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBmaXJzdCBwcm9taXNlJ3MgZnVsZmlsbG1lbnRcbiAgb3IgcmVqZWN0aW9uIGhhbmRsZXIsIG9yIHJlamVjdGVkIGlmIHRoZSBoYW5kbGVyIHRocm93cyBhbiBleGNlcHRpb24uXG4gICBgYGBqc1xuICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICByZXR1cm4gdXNlci5uYW1lO1xuICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgcmV0dXJuICdkZWZhdWx0IG5hbWUnO1xuICB9KS50aGVuKGZ1bmN0aW9uICh1c2VyTmFtZSkge1xuICAgIC8vIElmIGBmaW5kVXNlcmAgZnVsZmlsbGVkLCBgdXNlck5hbWVgIHdpbGwgYmUgdGhlIHVzZXIncyBuYW1lLCBvdGhlcndpc2UgaXRcbiAgICAvLyB3aWxsIGJlIGAnZGVmYXVsdCBuYW1lJ2BcbiAgfSk7XG4gICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZvdW5kIHVzZXIsIGJ1dCBzdGlsbCB1bmhhcHB5Jyk7XG4gIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2BmaW5kVXNlcmAgcmVqZWN0ZWQgYW5kIHdlJ3JlIHVuaGFwcHknKTtcbiAgfSkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAvLyBuZXZlciByZWFjaGVkXG4gIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAvLyBpZiBgZmluZFVzZXJgIGZ1bGZpbGxlZCwgYHJlYXNvbmAgd2lsbCBiZSAnRm91bmQgdXNlciwgYnV0IHN0aWxsIHVuaGFwcHknLlxuICAgIC8vIElmIGBmaW5kVXNlcmAgcmVqZWN0ZWQsIGByZWFzb25gIHdpbGwgYmUgJ2BmaW5kVXNlcmAgcmVqZWN0ZWQgYW5kIHdlJ3JlIHVuaGFwcHknLlxuICB9KTtcbiAgYGBgXG4gIElmIHRoZSBkb3duc3RyZWFtIHByb21pc2UgZG9lcyBub3Qgc3BlY2lmeSBhIHJlamVjdGlvbiBoYW5kbGVyLCByZWplY3Rpb24gcmVhc29ucyB3aWxsIGJlIHByb3BhZ2F0ZWQgZnVydGhlciBkb3duc3RyZWFtLlxuICAgYGBganNcbiAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgdGhyb3cgbmV3IFBlZGFnb2dpY2FsRXhjZXB0aW9uKCdVcHN0cmVhbSBlcnJvcicpO1xuICB9KS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgIC8vIG5ldmVyIHJlYWNoZWRcbiAgfSkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAvLyBuZXZlciByZWFjaGVkXG4gIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcbiAgICAvLyBUaGUgYFBlZGdhZ29jaWFsRXhjZXB0aW9uYCBpcyBwcm9wYWdhdGVkIGFsbCB0aGUgd2F5IGRvd24gdG8gaGVyZVxuICB9KTtcbiAgYGBgXG4gICBBc3NpbWlsYXRpb25cbiAgLS0tLS0tLS0tLS0tXG4gICBTb21ldGltZXMgdGhlIHZhbHVlIHlvdSB3YW50IHRvIHByb3BhZ2F0ZSB0byBhIGRvd25zdHJlYW0gcHJvbWlzZSBjYW4gb25seSBiZVxuICByZXRyaWV2ZWQgYXN5bmNocm9ub3VzbHkuIFRoaXMgY2FuIGJlIGFjaGlldmVkIGJ5IHJldHVybmluZyBhIHByb21pc2UgaW4gdGhlXG4gIGZ1bGZpbGxtZW50IG9yIHJlamVjdGlvbiBoYW5kbGVyLiBUaGUgZG93bnN0cmVhbSBwcm9taXNlIHdpbGwgdGhlbiBiZSBwZW5kaW5nXG4gIHVudGlsIHRoZSByZXR1cm5lZCBwcm9taXNlIGlzIHNldHRsZWQuIFRoaXMgaXMgY2FsbGVkICphc3NpbWlsYXRpb24qLlxuICAgYGBganNcbiAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgcmV0dXJuIGZpbmRDb21tZW50c0J5QXV0aG9yKHVzZXIpO1xuICB9KS50aGVuKGZ1bmN0aW9uIChjb21tZW50cykge1xuICAgIC8vIFRoZSB1c2VyJ3MgY29tbWVudHMgYXJlIG5vdyBhdmFpbGFibGVcbiAgfSk7XG4gIGBgYFxuICAgSWYgdGhlIGFzc2ltbGlhdGVkIHByb21pc2UgcmVqZWN0cywgdGhlbiB0aGUgZG93bnN0cmVhbSBwcm9taXNlIHdpbGwgYWxzbyByZWplY3QuXG4gICBgYGBqc1xuICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICByZXR1cm4gZmluZENvbW1lbnRzQnlBdXRob3IodXNlcik7XG4gIH0pLnRoZW4oZnVuY3Rpb24gKGNvbW1lbnRzKSB7XG4gICAgLy8gSWYgYGZpbmRDb21tZW50c0J5QXV0aG9yYCBmdWxmaWxscywgd2UnbGwgaGF2ZSB0aGUgdmFsdWUgaGVyZVxuICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgLy8gSWYgYGZpbmRDb21tZW50c0J5QXV0aG9yYCByZWplY3RzLCB3ZSdsbCBoYXZlIHRoZSByZWFzb24gaGVyZVxuICB9KTtcbiAgYGBgXG4gICBTaW1wbGUgRXhhbXBsZVxuICAtLS0tLS0tLS0tLS0tLVxuICAgU3luY2hyb25vdXMgRXhhbXBsZVxuICAgYGBgamF2YXNjcmlwdFxuICBsZXQgcmVzdWx0O1xuICAgdHJ5IHtcbiAgICByZXN1bHQgPSBmaW5kUmVzdWx0KCk7XG4gICAgLy8gc3VjY2Vzc1xuICB9IGNhdGNoKHJlYXNvbikge1xuICAgIC8vIGZhaWx1cmVcbiAgfVxuICBgYGBcbiAgIEVycmJhY2sgRXhhbXBsZVxuICAgYGBganNcbiAgZmluZFJlc3VsdChmdW5jdGlvbihyZXN1bHQsIGVycil7XG4gICAgaWYgKGVycikge1xuICAgICAgLy8gZmFpbHVyZVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBzdWNjZXNzXG4gICAgfVxuICB9KTtcbiAgYGBgXG4gICBQcm9taXNlIEV4YW1wbGU7XG4gICBgYGBqYXZhc2NyaXB0XG4gIGZpbmRSZXN1bHQoKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgLy8gc3VjY2Vzc1xuICB9LCBmdW5jdGlvbihyZWFzb24pe1xuICAgIC8vIGZhaWx1cmVcbiAgfSk7XG4gIGBgYFxuICAgQWR2YW5jZWQgRXhhbXBsZVxuICAtLS0tLS0tLS0tLS0tLVxuICAgU3luY2hyb25vdXMgRXhhbXBsZVxuICAgYGBgamF2YXNjcmlwdFxuICBsZXQgYXV0aG9yLCBib29rcztcbiAgIHRyeSB7XG4gICAgYXV0aG9yID0gZmluZEF1dGhvcigpO1xuICAgIGJvb2tzICA9IGZpbmRCb29rc0J5QXV0aG9yKGF1dGhvcik7XG4gICAgLy8gc3VjY2Vzc1xuICB9IGNhdGNoKHJlYXNvbikge1xuICAgIC8vIGZhaWx1cmVcbiAgfVxuICBgYGBcbiAgIEVycmJhY2sgRXhhbXBsZVxuICAgYGBganNcbiAgIGZ1bmN0aW9uIGZvdW5kQm9va3MoYm9va3MpIHtcbiAgIH1cbiAgIGZ1bmN0aW9uIGZhaWx1cmUocmVhc29uKSB7XG4gICB9XG4gICBmaW5kQXV0aG9yKGZ1bmN0aW9uKGF1dGhvciwgZXJyKXtcbiAgICBpZiAoZXJyKSB7XG4gICAgICBmYWlsdXJlKGVycik7XG4gICAgICAvLyBmYWlsdXJlXG4gICAgfSBlbHNlIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGZpbmRCb29va3NCeUF1dGhvcihhdXRob3IsIGZ1bmN0aW9uKGJvb2tzLCBlcnIpIHtcbiAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICBmYWlsdXJlKGVycik7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGZvdW5kQm9va3MoYm9va3MpO1xuICAgICAgICAgICAgfSBjYXRjaChyZWFzb24pIHtcbiAgICAgICAgICAgICAgZmFpbHVyZShyZWFzb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGNhdGNoKGVycm9yKSB7XG4gICAgICAgIGZhaWx1cmUoZXJyKTtcbiAgICAgIH1cbiAgICAgIC8vIHN1Y2Nlc3NcbiAgICB9XG4gIH0pO1xuICBgYGBcbiAgIFByb21pc2UgRXhhbXBsZTtcbiAgIGBgYGphdmFzY3JpcHRcbiAgZmluZEF1dGhvcigpLlxuICAgIHRoZW4oZmluZEJvb2tzQnlBdXRob3IpLlxuICAgIHRoZW4oZnVuY3Rpb24oYm9va3Mpe1xuICAgICAgLy8gZm91bmQgYm9va3NcbiAgfSkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKXtcbiAgICAvLyBzb21ldGhpbmcgd2VudCB3cm9uZ1xuICB9KTtcbiAgYGBgXG4gICBAbWV0aG9kIHRoZW5cbiAgQHBhcmFtIHtGdW5jdGlvbn0gb25GdWxmaWxsZWRcbiAgQHBhcmFtIHtGdW5jdGlvbn0gb25SZWplY3RlZFxuICBVc2VmdWwgZm9yIHRvb2xpbmcuXG4gIEByZXR1cm4ge1Byb21pc2V9XG4gICovXG5cbiAgLyoqXG4gIGBjYXRjaGAgaXMgc2ltcGx5IHN1Z2FyIGZvciBgdGhlbih1bmRlZmluZWQsIG9uUmVqZWN0aW9uKWAgd2hpY2ggbWFrZXMgaXQgdGhlIHNhbWVcbiAgYXMgdGhlIGNhdGNoIGJsb2NrIG9mIGEgdHJ5L2NhdGNoIHN0YXRlbWVudC5cbiAgYGBganNcbiAgZnVuY3Rpb24gZmluZEF1dGhvcigpe1xuICB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkbid0IGZpbmQgdGhhdCBhdXRob3InKTtcbiAgfVxuICAvLyBzeW5jaHJvbm91c1xuICB0cnkge1xuICBmaW5kQXV0aG9yKCk7XG4gIH0gY2F0Y2gocmVhc29uKSB7XG4gIC8vIHNvbWV0aGluZyB3ZW50IHdyb25nXG4gIH1cbiAgLy8gYXN5bmMgd2l0aCBwcm9taXNlc1xuICBmaW5kQXV0aG9yKCkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKXtcbiAgLy8gc29tZXRoaW5nIHdlbnQgd3JvbmdcbiAgfSk7XG4gIGBgYFxuICBAbWV0aG9kIGNhdGNoXG4gIEBwYXJhbSB7RnVuY3Rpb259IG9uUmVqZWN0aW9uXG4gIFVzZWZ1bCBmb3IgdG9vbGluZy5cbiAgQHJldHVybiB7UHJvbWlzZX1cbiAgKi9cblxuXG4gIFByb21pc2UucHJvdG90eXBlLmNhdGNoID0gZnVuY3Rpb24gX2NhdGNoKG9uUmVqZWN0aW9uKSB7XG4gICAgcmV0dXJuIHRoaXMudGhlbihudWxsLCBvblJlamVjdGlvbik7XG4gIH07XG5cbiAgLyoqXG4gICAgYGZpbmFsbHlgIHdpbGwgYmUgaW52b2tlZCByZWdhcmRsZXNzIG9mIHRoZSBwcm9taXNlJ3MgZmF0ZSBqdXN0IGFzIG5hdGl2ZVxuICAgIHRyeS9jYXRjaC9maW5hbGx5IGJlaGF2ZXNcbiAgXG4gICAgU3luY2hyb25vdXMgZXhhbXBsZTpcbiAgXG4gICAgYGBganNcbiAgICBmaW5kQXV0aG9yKCkge1xuICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPiAwLjUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbmV3IEF1dGhvcigpO1xuICAgIH1cbiAgXG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBmaW5kQXV0aG9yKCk7IC8vIHN1Y2NlZWQgb3IgZmFpbFxuICAgIH0gY2F0Y2goZXJyb3IpIHtcbiAgICAgIHJldHVybiBmaW5kT3RoZXJBdXRoZXIoKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgLy8gYWx3YXlzIHJ1bnNcbiAgICAgIC8vIGRvZXNuJ3QgYWZmZWN0IHRoZSByZXR1cm4gdmFsdWVcbiAgICB9XG4gICAgYGBgXG4gIFxuICAgIEFzeW5jaHJvbm91cyBleGFtcGxlOlxuICBcbiAgICBgYGBqc1xuICAgIGZpbmRBdXRob3IoKS5jYXRjaChmdW5jdGlvbihyZWFzb24pe1xuICAgICAgcmV0dXJuIGZpbmRPdGhlckF1dGhlcigpO1xuICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24oKXtcbiAgICAgIC8vIGF1dGhvciB3YXMgZWl0aGVyIGZvdW5kLCBvciBub3RcbiAgICB9KTtcbiAgICBgYGBcbiAgXG4gICAgQG1ldGhvZCBmaW5hbGx5XG4gICAgQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tcbiAgICBAcmV0dXJuIHtQcm9taXNlfVxuICAqL1xuXG5cbiAgUHJvbWlzZS5wcm90b3R5cGUuZmluYWxseSA9IGZ1bmN0aW9uIF9maW5hbGx5KGNhbGxiYWNrKSB7XG4gICAgdmFyIHByb21pc2UgPSB0aGlzO1xuICAgIHZhciBjb25zdHJ1Y3RvciA9IHByb21pc2UuY29uc3RydWN0b3I7XG5cbiAgICBpZiAoaXNGdW5jdGlvbihjYWxsYmFjaykpIHtcbiAgICAgIHJldHVybiBwcm9taXNlLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiBjb25zdHJ1Y3Rvci5yZXNvbHZlKGNhbGxiYWNrKCkpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICAgICAgfSk7XG4gICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG4gICAgICAgIHJldHVybiBjb25zdHJ1Y3Rvci5yZXNvbHZlKGNhbGxiYWNrKCkpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHRocm93IHJlYXNvbjtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcHJvbWlzZS50aGVuKGNhbGxiYWNrLCBjYWxsYmFjayk7XG4gIH07XG5cbiAgcmV0dXJuIFByb21pc2U7XG59KCk7XG5cblByb21pc2UkMS5wcm90b3R5cGUudGhlbiA9IHRoZW47XG5Qcm9taXNlJDEuYWxsID0gYWxsO1xuUHJvbWlzZSQxLnJhY2UgPSByYWNlO1xuUHJvbWlzZSQxLnJlc29sdmUgPSByZXNvbHZlJDE7XG5Qcm9taXNlJDEucmVqZWN0ID0gcmVqZWN0JDE7XG5Qcm9taXNlJDEuX3NldFNjaGVkdWxlciA9IHNldFNjaGVkdWxlcjtcblByb21pc2UkMS5fc2V0QXNhcCA9IHNldEFzYXA7XG5Qcm9taXNlJDEuX2FzYXAgPSBhc2FwO1xuXG4vKmdsb2JhbCBzZWxmKi9cbmZ1bmN0aW9uIHBvbHlmaWxsKCkge1xuICB2YXIgbG9jYWwgPSB2b2lkIDA7XG5cbiAgaWYgKHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbG9jYWwgPSBnbG9iYWw7XG4gIH0gZWxzZSBpZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbG9jYWwgPSBzZWxmO1xuICB9IGVsc2Uge1xuICAgIHRyeSB7XG4gICAgICBsb2NhbCA9IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdwb2x5ZmlsbCBmYWlsZWQgYmVjYXVzZSBnbG9iYWwgb2JqZWN0IGlzIHVuYXZhaWxhYmxlIGluIHRoaXMgZW52aXJvbm1lbnQnKTtcbiAgICB9XG4gIH1cblxuICB2YXIgUCA9IGxvY2FsLlByb21pc2U7XG5cbiAgaWYgKFApIHtcbiAgICB2YXIgcHJvbWlzZVRvU3RyaW5nID0gbnVsbDtcbiAgICB0cnkge1xuICAgICAgcHJvbWlzZVRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKFAucmVzb2x2ZSgpKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAvLyBzaWxlbnRseSBpZ25vcmVkXG4gICAgfVxuXG4gICAgaWYgKHByb21pc2VUb1N0cmluZyA9PT0gJ1tvYmplY3QgUHJvbWlzZV0nICYmICFQLmNhc3QpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICBsb2NhbC5Qcm9taXNlID0gUHJvbWlzZSQxO1xufVxuXG4vLyBTdHJhbmdlIGNvbXBhdC4uXG5Qcm9taXNlJDEucG9seWZpbGwgPSBwb2x5ZmlsbDtcblByb21pc2UkMS5Qcm9taXNlID0gUHJvbWlzZSQxO1xuXG5yZXR1cm4gUHJvbWlzZSQxO1xuXG59KSkpO1xuXG5cblxuXG5cbn0pLmNhbGwodGhpcyxfZGVyZXFfKCdfcHJvY2VzcycpLHR5cGVvZiBnbG9iYWwgIT09IFwidW5kZWZpbmVkXCIgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gXCJ1bmRlZmluZWRcIiA/IHNlbGYgOiB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiID8gd2luZG93IDoge30pXG5cbn0se1wiX3Byb2Nlc3NcIjozfV0sMjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4vLyBDb3B5cmlnaHQgSm95ZW50LCBJbmMuIGFuZCBvdGhlciBOb2RlIGNvbnRyaWJ1dG9ycy5cbi8vXG4vLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYVxuLy8gY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZVxuLy8gXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nXG4vLyB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsXG4vLyBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0XG4vLyBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGVcbi8vIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkXG4vLyBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTXG4vLyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GXG4vLyBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuIElOXG4vLyBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUlxuLy8gT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRVxuLy8gVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxuZnVuY3Rpb24gRXZlbnRFbWl0dGVyKCkge1xuICB0aGlzLl9ldmVudHMgPSB0aGlzLl9ldmVudHMgfHwge307XG4gIHRoaXMuX21heExpc3RlbmVycyA9IHRoaXMuX21heExpc3RlbmVycyB8fCB1bmRlZmluZWQ7XG59XG5tb2R1bGUuZXhwb3J0cyA9IEV2ZW50RW1pdHRlcjtcblxuLy8gQmFja3dhcmRzLWNvbXBhdCB3aXRoIG5vZGUgMC4xMC54XG5FdmVudEVtaXR0ZXIuRXZlbnRFbWl0dGVyID0gRXZlbnRFbWl0dGVyO1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLl9ldmVudHMgPSB1bmRlZmluZWQ7XG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLl9tYXhMaXN0ZW5lcnMgPSB1bmRlZmluZWQ7XG5cbi8vIEJ5IGRlZmF1bHQgRXZlbnRFbWl0dGVycyB3aWxsIHByaW50IGEgd2FybmluZyBpZiBtb3JlIHRoYW4gMTAgbGlzdGVuZXJzIGFyZVxuLy8gYWRkZWQgdG8gaXQuIFRoaXMgaXMgYSB1c2VmdWwgZGVmYXVsdCB3aGljaCBoZWxwcyBmaW5kaW5nIG1lbW9yeSBsZWFrcy5cbkV2ZW50RW1pdHRlci5kZWZhdWx0TWF4TGlzdGVuZXJzID0gMTA7XG5cbi8vIE9idmlvdXNseSBub3QgYWxsIEVtaXR0ZXJzIHNob3VsZCBiZSBsaW1pdGVkIHRvIDEwLiBUaGlzIGZ1bmN0aW9uIGFsbG93c1xuLy8gdGhhdCB0byBiZSBpbmNyZWFzZWQuIFNldCB0byB6ZXJvIGZvciB1bmxpbWl0ZWQuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLnNldE1heExpc3RlbmVycyA9IGZ1bmN0aW9uKG4pIHtcbiAgaWYgKCFpc051bWJlcihuKSB8fCBuIDwgMCB8fCBpc05hTihuKSlcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ24gbXVzdCBiZSBhIHBvc2l0aXZlIG51bWJlcicpO1xuICB0aGlzLl9tYXhMaXN0ZW5lcnMgPSBuO1xuICByZXR1cm4gdGhpcztcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgdmFyIGVyLCBoYW5kbGVyLCBsZW4sIGFyZ3MsIGksIGxpc3RlbmVycztcblxuICBpZiAoIXRoaXMuX2V2ZW50cylcbiAgICB0aGlzLl9ldmVudHMgPSB7fTtcblxuICAvLyBJZiB0aGVyZSBpcyBubyAnZXJyb3InIGV2ZW50IGxpc3RlbmVyIHRoZW4gdGhyb3cuXG4gIGlmICh0eXBlID09PSAnZXJyb3InKSB7XG4gICAgaWYgKCF0aGlzLl9ldmVudHMuZXJyb3IgfHxcbiAgICAgICAgKGlzT2JqZWN0KHRoaXMuX2V2ZW50cy5lcnJvcikgJiYgIXRoaXMuX2V2ZW50cy5lcnJvci5sZW5ndGgpKSB7XG4gICAgICBlciA9IGFyZ3VtZW50c1sxXTtcbiAgICAgIGlmIChlciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgIHRocm93IGVyOyAvLyBVbmhhbmRsZWQgJ2Vycm9yJyBldmVudFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gQXQgbGVhc3QgZ2l2ZSBzb21lIGtpbmQgb2YgY29udGV4dCB0byB0aGUgdXNlclxuICAgICAgICB2YXIgZXJyID0gbmV3IEVycm9yKCdVbmNhdWdodCwgdW5zcGVjaWZpZWQgXCJlcnJvclwiIGV2ZW50LiAoJyArIGVyICsgJyknKTtcbiAgICAgICAgZXJyLmNvbnRleHQgPSBlcjtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGhhbmRsZXIgPSB0aGlzLl9ldmVudHNbdHlwZV07XG5cbiAgaWYgKGlzVW5kZWZpbmVkKGhhbmRsZXIpKVxuICAgIHJldHVybiBmYWxzZTtcblxuICBpZiAoaXNGdW5jdGlvbihoYW5kbGVyKSkge1xuICAgIHN3aXRjaCAoYXJndW1lbnRzLmxlbmd0aCkge1xuICAgICAgLy8gZmFzdCBjYXNlc1xuICAgICAgY2FzZSAxOlxuICAgICAgICBoYW5kbGVyLmNhbGwodGhpcyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAyOlxuICAgICAgICBoYW5kbGVyLmNhbGwodGhpcywgYXJndW1lbnRzWzFdKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDM6XG4gICAgICAgIGhhbmRsZXIuY2FsbCh0aGlzLCBhcmd1bWVudHNbMV0sIGFyZ3VtZW50c1syXSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgLy8gc2xvd2VyXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgICAgICAgaGFuZGxlci5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICB9XG4gIH0gZWxzZSBpZiAoaXNPYmplY3QoaGFuZGxlcikpIHtcbiAgICBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgICBsaXN0ZW5lcnMgPSBoYW5kbGVyLnNsaWNlKCk7XG4gICAgbGVuID0gbGlzdGVuZXJzLmxlbmd0aDtcbiAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspXG4gICAgICBsaXN0ZW5lcnNbaV0uYXBwbHkodGhpcywgYXJncyk7XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUuYWRkTGlzdGVuZXIgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikge1xuICB2YXIgbTtcblxuICBpZiAoIWlzRnVuY3Rpb24obGlzdGVuZXIpKVxuICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHMpXG4gICAgdGhpcy5fZXZlbnRzID0ge307XG5cbiAgLy8gVG8gYXZvaWQgcmVjdXJzaW9uIGluIHRoZSBjYXNlIHRoYXQgdHlwZSA9PT0gXCJuZXdMaXN0ZW5lclwiISBCZWZvcmVcbiAgLy8gYWRkaW5nIGl0IHRvIHRoZSBsaXN0ZW5lcnMsIGZpcnN0IGVtaXQgXCJuZXdMaXN0ZW5lclwiLlxuICBpZiAodGhpcy5fZXZlbnRzLm5ld0xpc3RlbmVyKVxuICAgIHRoaXMuZW1pdCgnbmV3TGlzdGVuZXInLCB0eXBlLFxuICAgICAgICAgICAgICBpc0Z1bmN0aW9uKGxpc3RlbmVyLmxpc3RlbmVyKSA/XG4gICAgICAgICAgICAgIGxpc3RlbmVyLmxpc3RlbmVyIDogbGlzdGVuZXIpO1xuXG4gIGlmICghdGhpcy5fZXZlbnRzW3R5cGVdKVxuICAgIC8vIE9wdGltaXplIHRoZSBjYXNlIG9mIG9uZSBsaXN0ZW5lci4gRG9uJ3QgbmVlZCB0aGUgZXh0cmEgYXJyYXkgb2JqZWN0LlxuICAgIHRoaXMuX2V2ZW50c1t0eXBlXSA9IGxpc3RlbmVyO1xuICBlbHNlIGlmIChpc09iamVjdCh0aGlzLl9ldmVudHNbdHlwZV0pKVxuICAgIC8vIElmIHdlJ3ZlIGFscmVhZHkgZ290IGFuIGFycmF5LCBqdXN0IGFwcGVuZC5cbiAgICB0aGlzLl9ldmVudHNbdHlwZV0ucHVzaChsaXN0ZW5lcik7XG4gIGVsc2VcbiAgICAvLyBBZGRpbmcgdGhlIHNlY29uZCBlbGVtZW50LCBuZWVkIHRvIGNoYW5nZSB0byBhcnJheS5cbiAgICB0aGlzLl9ldmVudHNbdHlwZV0gPSBbdGhpcy5fZXZlbnRzW3R5cGVdLCBsaXN0ZW5lcl07XG5cbiAgLy8gQ2hlY2sgZm9yIGxpc3RlbmVyIGxlYWtcbiAgaWYgKGlzT2JqZWN0KHRoaXMuX2V2ZW50c1t0eXBlXSkgJiYgIXRoaXMuX2V2ZW50c1t0eXBlXS53YXJuZWQpIHtcbiAgICBpZiAoIWlzVW5kZWZpbmVkKHRoaXMuX21heExpc3RlbmVycykpIHtcbiAgICAgIG0gPSB0aGlzLl9tYXhMaXN0ZW5lcnM7XG4gICAgfSBlbHNlIHtcbiAgICAgIG0gPSBFdmVudEVtaXR0ZXIuZGVmYXVsdE1heExpc3RlbmVycztcbiAgICB9XG5cbiAgICBpZiAobSAmJiBtID4gMCAmJiB0aGlzLl9ldmVudHNbdHlwZV0ubGVuZ3RoID4gbSkge1xuICAgICAgdGhpcy5fZXZlbnRzW3R5cGVdLndhcm5lZCA9IHRydWU7XG4gICAgICBjb25zb2xlLmVycm9yKCcobm9kZSkgd2FybmluZzogcG9zc2libGUgRXZlbnRFbWl0dGVyIG1lbW9yeSAnICtcbiAgICAgICAgICAgICAgICAgICAgJ2xlYWsgZGV0ZWN0ZWQuICVkIGxpc3RlbmVycyBhZGRlZC4gJyArXG4gICAgICAgICAgICAgICAgICAgICdVc2UgZW1pdHRlci5zZXRNYXhMaXN0ZW5lcnMoKSB0byBpbmNyZWFzZSBsaW1pdC4nLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9ldmVudHNbdHlwZV0ubGVuZ3RoKTtcbiAgICAgIGlmICh0eXBlb2YgY29uc29sZS50cmFjZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAvLyBub3Qgc3VwcG9ydGVkIGluIElFIDEwXG4gICAgICAgIGNvbnNvbGUudHJhY2UoKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUub24gPSBFdmVudEVtaXR0ZXIucHJvdG90eXBlLmFkZExpc3RlbmVyO1xuXG5FdmVudEVtaXR0ZXIucHJvdG90eXBlLm9uY2UgPSBmdW5jdGlvbih0eXBlLCBsaXN0ZW5lcikge1xuICBpZiAoIWlzRnVuY3Rpb24obGlzdGVuZXIpKVxuICAgIHRocm93IFR5cGVFcnJvcignbGlzdGVuZXIgbXVzdCBiZSBhIGZ1bmN0aW9uJyk7XG5cbiAgdmFyIGZpcmVkID0gZmFsc2U7XG5cbiAgZnVuY3Rpb24gZygpIHtcbiAgICB0aGlzLnJlbW92ZUxpc3RlbmVyKHR5cGUsIGcpO1xuXG4gICAgaWYgKCFmaXJlZCkge1xuICAgICAgZmlyZWQgPSB0cnVlO1xuICAgICAgbGlzdGVuZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICB9XG4gIH1cblxuICBnLmxpc3RlbmVyID0gbGlzdGVuZXI7XG4gIHRoaXMub24odHlwZSwgZyk7XG5cbiAgcmV0dXJuIHRoaXM7XG59O1xuXG4vLyBlbWl0cyBhICdyZW1vdmVMaXN0ZW5lcicgZXZlbnQgaWZmIHRoZSBsaXN0ZW5lciB3YXMgcmVtb3ZlZFxuRXZlbnRFbWl0dGVyLnByb3RvdHlwZS5yZW1vdmVMaXN0ZW5lciA9IGZ1bmN0aW9uKHR5cGUsIGxpc3RlbmVyKSB7XG4gIHZhciBsaXN0LCBwb3NpdGlvbiwgbGVuZ3RoLCBpO1xuXG4gIGlmICghaXNGdW5jdGlvbihsaXN0ZW5lcikpXG4gICAgdGhyb3cgVHlwZUVycm9yKCdsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcblxuICBpZiAoIXRoaXMuX2V2ZW50cyB8fCAhdGhpcy5fZXZlbnRzW3R5cGVdKVxuICAgIHJldHVybiB0aGlzO1xuXG4gIGxpc3QgPSB0aGlzLl9ldmVudHNbdHlwZV07XG4gIGxlbmd0aCA9IGxpc3QubGVuZ3RoO1xuICBwb3NpdGlvbiA9IC0xO1xuXG4gIGlmIChsaXN0ID09PSBsaXN0ZW5lciB8fFxuICAgICAgKGlzRnVuY3Rpb24obGlzdC5saXN0ZW5lcikgJiYgbGlzdC5saXN0ZW5lciA9PT0gbGlzdGVuZXIpKSB7XG4gICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTtcbiAgICBpZiAodGhpcy5fZXZlbnRzLnJlbW92ZUxpc3RlbmVyKVxuICAgICAgdGhpcy5lbWl0KCdyZW1vdmVMaXN0ZW5lcicsIHR5cGUsIGxpc3RlbmVyKTtcblxuICB9IGVsc2UgaWYgKGlzT2JqZWN0KGxpc3QpKSB7XG4gICAgZm9yIChpID0gbGVuZ3RoOyBpLS0gPiAwOykge1xuICAgICAgaWYgKGxpc3RbaV0gPT09IGxpc3RlbmVyIHx8XG4gICAgICAgICAgKGxpc3RbaV0ubGlzdGVuZXIgJiYgbGlzdFtpXS5saXN0ZW5lciA9PT0gbGlzdGVuZXIpKSB7XG4gICAgICAgIHBvc2l0aW9uID0gaTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHBvc2l0aW9uIDwgMClcbiAgICAgIHJldHVybiB0aGlzO1xuXG4gICAgaWYgKGxpc3QubGVuZ3RoID09PSAxKSB7XG4gICAgICBsaXN0Lmxlbmd0aCA9IDA7XG4gICAgICBkZWxldGUgdGhpcy5fZXZlbnRzW3R5cGVdO1xuICAgIH0gZWxzZSB7XG4gICAgICBsaXN0LnNwbGljZShwb3NpdGlvbiwgMSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcilcbiAgICAgIHRoaXMuZW1pdCgncmVtb3ZlTGlzdGVuZXInLCB0eXBlLCBsaXN0ZW5lcik7XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUucmVtb3ZlQWxsTGlzdGVuZXJzID0gZnVuY3Rpb24odHlwZSkge1xuICB2YXIga2V5LCBsaXN0ZW5lcnM7XG5cbiAgaWYgKCF0aGlzLl9ldmVudHMpXG4gICAgcmV0dXJuIHRoaXM7XG5cbiAgLy8gbm90IGxpc3RlbmluZyBmb3IgcmVtb3ZlTGlzdGVuZXIsIG5vIG5lZWQgdG8gZW1pdFxuICBpZiAoIXRoaXMuX2V2ZW50cy5yZW1vdmVMaXN0ZW5lcikge1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAwKVxuICAgICAgdGhpcy5fZXZlbnRzID0ge307XG4gICAgZWxzZSBpZiAodGhpcy5fZXZlbnRzW3R5cGVdKVxuICAgICAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8vIGVtaXQgcmVtb3ZlTGlzdGVuZXIgZm9yIGFsbCBsaXN0ZW5lcnMgb24gYWxsIGV2ZW50c1xuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgIGZvciAoa2V5IGluIHRoaXMuX2V2ZW50cykge1xuICAgICAgaWYgKGtleSA9PT0gJ3JlbW92ZUxpc3RlbmVyJykgY29udGludWU7XG4gICAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycyhrZXkpO1xuICAgIH1cbiAgICB0aGlzLnJlbW92ZUFsbExpc3RlbmVycygncmVtb3ZlTGlzdGVuZXInKTtcbiAgICB0aGlzLl9ldmVudHMgPSB7fTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGxpc3RlbmVycyA9IHRoaXMuX2V2ZW50c1t0eXBlXTtcblxuICBpZiAoaXNGdW5jdGlvbihsaXN0ZW5lcnMpKSB7XG4gICAgdGhpcy5yZW1vdmVMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lcnMpO1xuICB9IGVsc2UgaWYgKGxpc3RlbmVycykge1xuICAgIC8vIExJRk8gb3JkZXJcbiAgICB3aGlsZSAobGlzdGVuZXJzLmxlbmd0aClcbiAgICAgIHRoaXMucmVtb3ZlTGlzdGVuZXIodHlwZSwgbGlzdGVuZXJzW2xpc3RlbmVycy5sZW5ndGggLSAxXSk7XG4gIH1cbiAgZGVsZXRlIHRoaXMuX2V2ZW50c1t0eXBlXTtcblxuICByZXR1cm4gdGhpcztcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJzID0gZnVuY3Rpb24odHlwZSkge1xuICB2YXIgcmV0O1xuICBpZiAoIXRoaXMuX2V2ZW50cyB8fCAhdGhpcy5fZXZlbnRzW3R5cGVdKVxuICAgIHJldCA9IFtdO1xuICBlbHNlIGlmIChpc0Z1bmN0aW9uKHRoaXMuX2V2ZW50c1t0eXBlXSkpXG4gICAgcmV0ID0gW3RoaXMuX2V2ZW50c1t0eXBlXV07XG4gIGVsc2VcbiAgICByZXQgPSB0aGlzLl9ldmVudHNbdHlwZV0uc2xpY2UoKTtcbiAgcmV0dXJuIHJldDtcbn07XG5cbkV2ZW50RW1pdHRlci5wcm90b3R5cGUubGlzdGVuZXJDb3VudCA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgaWYgKHRoaXMuX2V2ZW50cykge1xuICAgIHZhciBldmxpc3RlbmVyID0gdGhpcy5fZXZlbnRzW3R5cGVdO1xuXG4gICAgaWYgKGlzRnVuY3Rpb24oZXZsaXN0ZW5lcikpXG4gICAgICByZXR1cm4gMTtcbiAgICBlbHNlIGlmIChldmxpc3RlbmVyKVxuICAgICAgcmV0dXJuIGV2bGlzdGVuZXIubGVuZ3RoO1xuICB9XG4gIHJldHVybiAwO1xufTtcblxuRXZlbnRFbWl0dGVyLmxpc3RlbmVyQ291bnQgPSBmdW5jdGlvbihlbWl0dGVyLCB0eXBlKSB7XG4gIHJldHVybiBlbWl0dGVyLmxpc3RlbmVyQ291bnQodHlwZSk7XG59O1xuXG5mdW5jdGlvbiBpc0Z1bmN0aW9uKGFyZykge1xuICByZXR1cm4gdHlwZW9mIGFyZyA9PT0gJ2Z1bmN0aW9uJztcbn1cblxuZnVuY3Rpb24gaXNOdW1iZXIoYXJnKSB7XG4gIHJldHVybiB0eXBlb2YgYXJnID09PSAnbnVtYmVyJztcbn1cblxuZnVuY3Rpb24gaXNPYmplY3QoYXJnKSB7XG4gIHJldHVybiB0eXBlb2YgYXJnID09PSAnb2JqZWN0JyAmJiBhcmcgIT09IG51bGw7XG59XG5cbmZ1bmN0aW9uIGlzVW5kZWZpbmVkKGFyZykge1xuICByZXR1cm4gYXJnID09PSB2b2lkIDA7XG59XG5cbn0se31dLDM6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyXG52YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307XG5cbi8vIGNhY2hlZCBmcm9tIHdoYXRldmVyIGdsb2JhbCBpcyBwcmVzZW50IHNvIHRoYXQgdGVzdCBydW5uZXJzIHRoYXQgc3R1YiBpdFxuLy8gZG9uJ3QgYnJlYWsgdGhpbmdzLiAgQnV0IHdlIG5lZWQgdG8gd3JhcCBpdCBpbiBhIHRyeSBjYXRjaCBpbiBjYXNlIGl0IGlzXG4vLyB3cmFwcGVkIGluIHN0cmljdCBtb2RlIGNvZGUgd2hpY2ggZG9lc24ndCBkZWZpbmUgYW55IGdsb2JhbHMuICBJdCdzIGluc2lkZSBhXG4vLyBmdW5jdGlvbiBiZWNhdXNlIHRyeS9jYXRjaGVzIGRlb3B0aW1pemUgaW4gY2VydGFpbiBlbmdpbmVzLlxuXG52YXIgY2FjaGVkU2V0VGltZW91dDtcbnZhciBjYWNoZWRDbGVhclRpbWVvdXQ7XG5cbmZ1bmN0aW9uIGRlZmF1bHRTZXRUaW1vdXQoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdzZXRUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG5mdW5jdGlvbiBkZWZhdWx0Q2xlYXJUaW1lb3V0ICgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2NsZWFyVGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuKGZ1bmN0aW9uICgpIHtcbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIHNldFRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIGNsZWFyVGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDtcbiAgICB9XG59ICgpKVxuZnVuY3Rpb24gcnVuVGltZW91dChmdW4pIHtcbiAgICBpZiAoY2FjaGVkU2V0VGltZW91dCA9PT0gc2V0VGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgLy8gaWYgc2V0VGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZFNldFRpbWVvdXQgPT09IGRlZmF1bHRTZXRUaW1vdXQgfHwgIWNhY2hlZFNldFRpbWVvdXQpICYmIHNldFRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9IGNhdGNoKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0IHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKG51bGwsIGZ1biwgMCk7XG4gICAgICAgIH0gY2F0Y2goZSl7XG4gICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvclxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbCh0aGlzLCBmdW4sIDApO1xuICAgICAgICB9XG4gICAgfVxuXG5cbn1cbmZ1bmN0aW9uIHJ1bkNsZWFyVGltZW91dChtYXJrZXIpIHtcbiAgICBpZiAoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9XG4gICAgLy8gaWYgY2xlYXJUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBkZWZhdWx0Q2xlYXJUaW1lb3V0IHx8ICFjYWNoZWRDbGVhclRpbWVvdXQpICYmIGNsZWFyVGltZW91dCkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfSBjYXRjaCAoZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgIHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwobnVsbCwgbWFya2VyKTtcbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvci5cbiAgICAgICAgICAgIC8vIFNvbWUgdmVyc2lvbnMgb2YgSS5FLiBoYXZlIGRpZmZlcmVudCBydWxlcyBmb3IgY2xlYXJUaW1lb3V0IHZzIHNldFRpbWVvdXRcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbCh0aGlzLCBtYXJrZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG5cblxufVxudmFyIHF1ZXVlID0gW107XG52YXIgZHJhaW5pbmcgPSBmYWxzZTtcbnZhciBjdXJyZW50UXVldWU7XG52YXIgcXVldWVJbmRleCA9IC0xO1xuXG5mdW5jdGlvbiBjbGVhblVwTmV4dFRpY2soKSB7XG4gICAgaWYgKCFkcmFpbmluZyB8fCAhY3VycmVudFF1ZXVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBpZiAoY3VycmVudFF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBxdWV1ZSA9IGN1cnJlbnRRdWV1ZS5jb25jYXQocXVldWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICB9XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBkcmFpblF1ZXVlKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkcmFpblF1ZXVlKCkge1xuICAgIGlmIChkcmFpbmluZykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0aW1lb3V0ID0gcnVuVGltZW91dChjbGVhblVwTmV4dFRpY2spO1xuICAgIGRyYWluaW5nID0gdHJ1ZTtcblxuICAgIHZhciBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgd2hpbGUobGVuKSB7XG4gICAgICAgIGN1cnJlbnRRdWV1ZSA9IHF1ZXVlO1xuICAgICAgICBxdWV1ZSA9IFtdO1xuICAgICAgICB3aGlsZSAoKytxdWV1ZUluZGV4IDwgbGVuKSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudFF1ZXVlKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFF1ZXVlW3F1ZXVlSW5kZXhdLnJ1bigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICAgICAgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIH1cbiAgICBjdXJyZW50UXVldWUgPSBudWxsO1xuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgcnVuQ2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xufVxuXG5wcm9jZXNzLm5leHRUaWNrID0gZnVuY3Rpb24gKGZ1bikge1xuICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHF1ZXVlLnB1c2gobmV3IEl0ZW0oZnVuLCBhcmdzKSk7XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHtcbiAgICAgICAgcnVuVGltZW91dChkcmFpblF1ZXVlKTtcbiAgICB9XG59O1xuXG4vLyB2OCBsaWtlcyBwcmVkaWN0aWJsZSBvYmplY3RzXG5mdW5jdGlvbiBJdGVtKGZ1biwgYXJyYXkpIHtcbiAgICB0aGlzLmZ1biA9IGZ1bjtcbiAgICB0aGlzLmFycmF5ID0gYXJyYXk7XG59XG5JdGVtLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5mdW4uYXBwbHkobnVsbCwgdGhpcy5hcnJheSk7XG59O1xucHJvY2Vzcy50aXRsZSA9ICdicm93c2VyJztcbnByb2Nlc3MuYnJvd3NlciA9IHRydWU7XG5wcm9jZXNzLmVudiA9IHt9O1xucHJvY2Vzcy5hcmd2ID0gW107XG5wcm9jZXNzLnZlcnNpb24gPSAnJzsgLy8gZW1wdHkgc3RyaW5nIHRvIGF2b2lkIHJlZ2V4cCBpc3N1ZXNcbnByb2Nlc3MudmVyc2lvbnMgPSB7fTtcblxuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbnByb2Nlc3Mub24gPSBub29wO1xucHJvY2Vzcy5hZGRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLm9uY2UgPSBub29wO1xucHJvY2Vzcy5vZmYgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7XG5wcm9jZXNzLmVtaXQgPSBub29wO1xucHJvY2Vzcy5wcmVwZW5kTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5wcmVwZW5kT25jZUxpc3RlbmVyID0gbm9vcDtcblxucHJvY2Vzcy5saXN0ZW5lcnMgPSBmdW5jdGlvbiAobmFtZSkgeyByZXR1cm4gW10gfVxuXG5wcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5cbnByb2Nlc3MuY3dkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gJy8nIH07XG5wcm9jZXNzLmNoZGlyID0gZnVuY3Rpb24gKGRpcikge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xucHJvY2Vzcy51bWFzayA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gMDsgfTtcblxufSx7fV0sNDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG52YXIgYnVuZGxlRm4gPSBhcmd1bWVudHNbM107XG52YXIgc291cmNlcyA9IGFyZ3VtZW50c1s0XTtcbnZhciBjYWNoZSA9IGFyZ3VtZW50c1s1XTtcblxudmFyIHN0cmluZ2lmeSA9IEpTT04uc3RyaW5naWZ5O1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChmbiwgb3B0aW9ucykge1xuICAgIHZhciB3a2V5O1xuICAgIHZhciBjYWNoZUtleXMgPSBPYmplY3Qua2V5cyhjYWNoZSk7XG5cbiAgICBmb3IgKHZhciBpID0gMCwgbCA9IGNhY2hlS2V5cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgdmFyIGtleSA9IGNhY2hlS2V5c1tpXTtcbiAgICAgICAgdmFyIGV4cCA9IGNhY2hlW2tleV0uZXhwb3J0cztcbiAgICAgICAgLy8gVXNpbmcgYmFiZWwgYXMgYSB0cmFuc3BpbGVyIHRvIHVzZSBlc21vZHVsZSwgdGhlIGV4cG9ydCB3aWxsIGFsd2F5c1xuICAgICAgICAvLyBiZSBhbiBvYmplY3Qgd2l0aCB0aGUgZGVmYXVsdCBleHBvcnQgYXMgYSBwcm9wZXJ0eSBvZiBpdC4gVG8gZW5zdXJlXG4gICAgICAgIC8vIHRoZSBleGlzdGluZyBhcGkgYW5kIGJhYmVsIGVzbW9kdWxlIGV4cG9ydHMgYXJlIGJvdGggc3VwcG9ydGVkIHdlXG4gICAgICAgIC8vIGNoZWNrIGZvciBib3RoXG4gICAgICAgIGlmIChleHAgPT09IGZuIHx8IGV4cCAmJiBleHAuZGVmYXVsdCA9PT0gZm4pIHtcbiAgICAgICAgICAgIHdrZXkgPSBrZXk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmICghd2tleSkge1xuICAgICAgICB3a2V5ID0gTWF0aC5mbG9vcihNYXRoLnBvdygxNiwgOCkgKiBNYXRoLnJhbmRvbSgpKS50b1N0cmluZygxNik7XG4gICAgICAgIHZhciB3Y2FjaGUgPSB7fTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBjYWNoZUtleXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIga2V5ID0gY2FjaGVLZXlzW2ldO1xuICAgICAgICAgICAgd2NhY2hlW2tleV0gPSBrZXk7XG4gICAgICAgIH1cbiAgICAgICAgc291cmNlc1t3a2V5XSA9IFtcbiAgICAgICAgICAgICdmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsnICsgZm4gKyAnKHNlbGYpOyB9JyxcbiAgICAgICAgICAgIHdjYWNoZVxuICAgICAgICBdO1xuICAgIH1cbiAgICB2YXIgc2tleSA9IE1hdGguZmxvb3IoTWF0aC5wb3coMTYsIDgpICogTWF0aC5yYW5kb20oKSkudG9TdHJpbmcoMTYpO1xuXG4gICAgdmFyIHNjYWNoZSA9IHt9OyBzY2FjaGVbd2tleV0gPSB3a2V5O1xuICAgIHNvdXJjZXNbc2tleV0gPSBbXG4gICAgICAgICdmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXsnICtcbiAgICAgICAgICAgIC8vIHRyeSB0byBjYWxsIGRlZmF1bHQgaWYgZGVmaW5lZCB0byBhbHNvIHN1cHBvcnQgYmFiZWwgZXNtb2R1bGUgZXhwb3J0c1xuICAgICAgICAgICAgJ3ZhciBmID0gcmVxdWlyZSgnICsgc3RyaW5naWZ5KHdrZXkpICsgJyk7JyArXG4gICAgICAgICAgICAnKGYuZGVmYXVsdCA/IGYuZGVmYXVsdCA6IGYpKHNlbGYpOycgK1xuICAgICAgICAnfScsXG4gICAgICAgIHNjYWNoZVxuICAgIF07XG5cbiAgICB2YXIgd29ya2VyU291cmNlcyA9IHt9O1xuICAgIHJlc29sdmVTb3VyY2VzKHNrZXkpO1xuXG4gICAgZnVuY3Rpb24gcmVzb2x2ZVNvdXJjZXMoa2V5KSB7XG4gICAgICAgIHdvcmtlclNvdXJjZXNba2V5XSA9IHRydWU7XG5cbiAgICAgICAgZm9yICh2YXIgZGVwUGF0aCBpbiBzb3VyY2VzW2tleV1bMV0pIHtcbiAgICAgICAgICAgIHZhciBkZXBLZXkgPSBzb3VyY2VzW2tleV1bMV1bZGVwUGF0aF07XG4gICAgICAgICAgICBpZiAoIXdvcmtlclNvdXJjZXNbZGVwS2V5XSkge1xuICAgICAgICAgICAgICAgIHJlc29sdmVTb3VyY2VzKGRlcEtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgc3JjID0gJygnICsgYnVuZGxlRm4gKyAnKSh7J1xuICAgICAgICArIE9iamVjdC5rZXlzKHdvcmtlclNvdXJjZXMpLm1hcChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICByZXR1cm4gc3RyaW5naWZ5KGtleSkgKyAnOlsnXG4gICAgICAgICAgICAgICAgKyBzb3VyY2VzW2tleV1bMF1cbiAgICAgICAgICAgICAgICArICcsJyArIHN0cmluZ2lmeShzb3VyY2VzW2tleV1bMV0pICsgJ10nXG4gICAgICAgICAgICA7XG4gICAgICAgIH0pLmpvaW4oJywnKVxuICAgICAgICArICd9LHt9LFsnICsgc3RyaW5naWZ5KHNrZXkpICsgJ10pJ1xuICAgIDtcblxuICAgIHZhciBVUkwgPSB3aW5kb3cuVVJMIHx8IHdpbmRvdy53ZWJraXRVUkwgfHwgd2luZG93Lm1velVSTCB8fCB3aW5kb3cubXNVUkw7XG5cbiAgICB2YXIgYmxvYiA9IG5ldyBCbG9iKFtzcmNdLCB7IHR5cGU6ICd0ZXh0L2phdmFzY3JpcHQnIH0pO1xuICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMuYmFyZSkgeyByZXR1cm4gYmxvYjsgfVxuICAgIHZhciB3b3JrZXJVcmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpO1xuICAgIHZhciB3b3JrZXIgPSBuZXcgV29ya2VyKHdvcmtlclVybCk7XG4gICAgd29ya2VyLm9iamVjdFVSTCA9IHdvcmtlclVybDtcbiAgICByZXR1cm4gd29ya2VyO1xufTtcblxufSx7fV0sNTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuY3JlYXRlRGVmYXVsdENvbmZpZyA9IGNyZWF0ZURlZmF1bHRDb25maWc7XG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG52YXIgZGVmYXVsdENvbmZpZyA9IGV4cG9ydHMuZGVmYXVsdENvbmZpZyA9IHtcbiAgICBlbmFibGVXb3JrZXI6IGZhbHNlLFxuICAgIGVuYWJsZVN0YXNoQnVmZmVyOiB0cnVlLFxuICAgIHN0YXNoSW5pdGlhbFNpemU6IHVuZGVmaW5lZCxcblxuICAgIGlzTGl2ZTogZmFsc2UsXG5cbiAgICBsYXp5TG9hZDogdHJ1ZSxcbiAgICBsYXp5TG9hZE1heER1cmF0aW9uOiAzICogNjAsXG4gICAgbGF6eUxvYWRSZWNvdmVyRHVyYXRpb246IDMwLFxuICAgIGRlZmVyTG9hZEFmdGVyU291cmNlT3BlbjogdHJ1ZSxcblxuICAgIC8vIGF1dG9DbGVhbnVwU291cmNlQnVmZmVyOiBkZWZhdWx0IGFzIGZhbHNlLCBsZWF2ZSB1bnNwZWNpZmllZFxuICAgIGF1dG9DbGVhbnVwTWF4QmFja3dhcmREdXJhdGlvbjogMyAqIDYwLFxuICAgIGF1dG9DbGVhbnVwTWluQmFja3dhcmREdXJhdGlvbjogMiAqIDYwLFxuXG4gICAgc3RhdGlzdGljc0luZm9SZXBvcnRJbnRlcnZhbDogNjAwLFxuXG4gICAgZml4QXVkaW9UaW1lc3RhbXBHYXA6IHRydWUsXG5cbiAgICBhY2N1cmF0ZVNlZWs6IGZhbHNlLFxuICAgIHNlZWtUeXBlOiAncmFuZ2UnLCAvLyBbcmFuZ2UsIHBhcmFtLCBjdXN0b21dXG4gICAgc2Vla1BhcmFtU3RhcnQ6ICdic3RhcnQnLFxuICAgIHNlZWtQYXJhbUVuZDogJ2JlbmQnLFxuICAgIHJhbmdlTG9hZFplcm9TdGFydDogZmFsc2UsXG4gICAgY3VzdG9tU2Vla0hhbmRsZXI6IHVuZGVmaW5lZCxcbiAgICByZXVzZVJlZGlyZWN0ZWRVUkw6IGZhbHNlLFxuICAgIC8vIHJlZmVycmVyUG9saWN5OiBsZWF2ZSBhcyB1bnNwZWNpZmllZFxuXG4gICAgaGVhZGVyczogdW5kZWZpbmVkLFxuICAgIGN1c3RvbUxvYWRlcjogdW5kZWZpbmVkXG59O1xuXG5mdW5jdGlvbiBjcmVhdGVEZWZhdWx0Q29uZmlnKCkge1xuICAgIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0Q29uZmlnKTtcbn1cblxufSx7fV0sNjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfaW9Db250cm9sbGVyID0gX2RlcmVxXygnLi4vaW8vaW8tY29udHJvbGxlci5qcycpO1xuXG52YXIgX2lvQ29udHJvbGxlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9pb0NvbnRyb2xsZXIpO1xuXG52YXIgX2NvbmZpZyA9IF9kZXJlcV8oJy4uL2NvbmZpZy5qcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgRmVhdHVyZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRmVhdHVyZXMoKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBGZWF0dXJlcyk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKEZlYXR1cmVzLCBudWxsLCBbe1xuICAgICAgICBrZXk6ICdzdXBwb3J0TVNFSDI2NFBsYXliYWNrJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN1cHBvcnRNU0VIMjY0UGxheWJhY2soKSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93Lk1lZGlhU291cmNlICYmIHdpbmRvdy5NZWRpYVNvdXJjZS5pc1R5cGVTdXBwb3J0ZWQoJ3ZpZGVvL21wNDsgY29kZWNzPVwiYXZjMS40MkUwMUUsbXA0YS40MC4yXCInKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc3VwcG9ydE5ldHdvcmtTdHJlYW1JTycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdXBwb3J0TmV0d29ya1N0cmVhbUlPKCkge1xuICAgICAgICAgICAgdmFyIGlvY3RsID0gbmV3IF9pb0NvbnRyb2xsZXIyLmRlZmF1bHQoe30sICgwLCBfY29uZmlnLmNyZWF0ZURlZmF1bHRDb25maWcpKCkpO1xuICAgICAgICAgICAgdmFyIGxvYWRlclR5cGUgPSBpb2N0bC5sb2FkZXJUeXBlO1xuICAgICAgICAgICAgaW9jdGwuZGVzdHJveSgpO1xuICAgICAgICAgICAgcmV0dXJuIGxvYWRlclR5cGUgPT0gJ2ZldGNoLXN0cmVhbS1sb2FkZXInIHx8IGxvYWRlclR5cGUgPT0gJ3hoci1tb3otY2h1bmtlZC1sb2FkZXInO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdnZXROZXR3b3JrTG9hZGVyVHlwZU5hbWUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TmV0d29ya0xvYWRlclR5cGVOYW1lKCkge1xuICAgICAgICAgICAgdmFyIGlvY3RsID0gbmV3IF9pb0NvbnRyb2xsZXIyLmRlZmF1bHQoe30sICgwLCBfY29uZmlnLmNyZWF0ZURlZmF1bHRDb25maWcpKCkpO1xuICAgICAgICAgICAgdmFyIGxvYWRlclR5cGUgPSBpb2N0bC5sb2FkZXJUeXBlO1xuICAgICAgICAgICAgaW9jdGwuZGVzdHJveSgpO1xuICAgICAgICAgICAgcmV0dXJuIGxvYWRlclR5cGU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3N1cHBvcnROYXRpdmVNZWRpYVBsYXliYWNrJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN1cHBvcnROYXRpdmVNZWRpYVBsYXliYWNrKG1pbWVUeXBlKSB7XG4gICAgICAgICAgICBpZiAoRmVhdHVyZXMudmlkZW9FbGVtZW50ID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIEZlYXR1cmVzLnZpZGVvRWxlbWVudCA9IHdpbmRvdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCd2aWRlbycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNhblBsYXkgPSBGZWF0dXJlcy52aWRlb0VsZW1lbnQuY2FuUGxheVR5cGUobWltZVR5cGUpO1xuICAgICAgICAgICAgcmV0dXJuIGNhblBsYXkgPT09ICdwcm9iYWJseScgfHwgY2FuUGxheSA9PSAnbWF5YmUnO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdnZXRGZWF0dXJlTGlzdCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGZWF0dXJlTGlzdCgpIHtcbiAgICAgICAgICAgIHZhciBmZWF0dXJlcyA9IHtcbiAgICAgICAgICAgICAgICBtc2VGbHZQbGF5YmFjazogZmFsc2UsXG4gICAgICAgICAgICAgICAgbXNlTGl2ZUZsdlBsYXliYWNrOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBuZXR3b3JrU3RyZWFtSU86IGZhbHNlLFxuICAgICAgICAgICAgICAgIG5ldHdvcmtMb2FkZXJOYW1lOiAnJyxcbiAgICAgICAgICAgICAgICBuYXRpdmVNUDRIMjY0UGxheWJhY2s6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG5hdGl2ZVdlYm1WUDhQbGF5YmFjazogZmFsc2UsXG4gICAgICAgICAgICAgICAgbmF0aXZlV2VibVZQOVBsYXliYWNrOiBmYWxzZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZmVhdHVyZXMubXNlRmx2UGxheWJhY2sgPSBGZWF0dXJlcy5zdXBwb3J0TVNFSDI2NFBsYXliYWNrKCk7XG4gICAgICAgICAgICBmZWF0dXJlcy5uZXR3b3JrU3RyZWFtSU8gPSBGZWF0dXJlcy5zdXBwb3J0TmV0d29ya1N0cmVhbUlPKCk7XG4gICAgICAgICAgICBmZWF0dXJlcy5uZXR3b3JrTG9hZGVyTmFtZSA9IEZlYXR1cmVzLmdldE5ldHdvcmtMb2FkZXJUeXBlTmFtZSgpO1xuICAgICAgICAgICAgZmVhdHVyZXMubXNlTGl2ZUZsdlBsYXliYWNrID0gZmVhdHVyZXMubXNlRmx2UGxheWJhY2sgJiYgZmVhdHVyZXMubmV0d29ya1N0cmVhbUlPO1xuICAgICAgICAgICAgZmVhdHVyZXMubmF0aXZlTVA0SDI2NFBsYXliYWNrID0gRmVhdHVyZXMuc3VwcG9ydE5hdGl2ZU1lZGlhUGxheWJhY2soJ3ZpZGVvL21wNDsgY29kZWNzPVwiYXZjMS40MjAwMUUsIG1wNGEuNDAuMlwiJyk7XG4gICAgICAgICAgICBmZWF0dXJlcy5uYXRpdmVXZWJtVlA4UGxheWJhY2sgPSBGZWF0dXJlcy5zdXBwb3J0TmF0aXZlTWVkaWFQbGF5YmFjaygndmlkZW8vd2VibTsgY29kZWNzPVwidnA4LjAsIHZvcmJpc1wiJyk7XG4gICAgICAgICAgICBmZWF0dXJlcy5uYXRpdmVXZWJtVlA5UGxheWJhY2sgPSBGZWF0dXJlcy5zdXBwb3J0TmF0aXZlTWVkaWFQbGF5YmFjaygndmlkZW8vd2VibTsgY29kZWNzPVwidnA5XCInKTtcblxuICAgICAgICAgICAgcmV0dXJuIGZlYXR1cmVzO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIEZlYXR1cmVzO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBGZWF0dXJlcztcblxufSx7XCIuLi9jb25maWcuanNcIjo1LFwiLi4vaW8vaW8tY29udHJvbGxlci5qc1wiOjIzfV0sNzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG52YXIgTWVkaWFJbmZvID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1lZGlhSW5mbygpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1lZGlhSW5mbyk7XG5cbiAgICAgICAgdGhpcy5taW1lVHlwZSA9IG51bGw7XG4gICAgICAgIHRoaXMuZHVyYXRpb24gPSBudWxsO1xuXG4gICAgICAgIHRoaXMuaGFzQXVkaW8gPSBudWxsO1xuICAgICAgICB0aGlzLmhhc1ZpZGVvID0gbnVsbDtcbiAgICAgICAgdGhpcy5hdWRpb0NvZGVjID0gbnVsbDtcbiAgICAgICAgdGhpcy52aWRlb0NvZGVjID0gbnVsbDtcbiAgICAgICAgdGhpcy5hdWRpb0RhdGFSYXRlID0gbnVsbDtcbiAgICAgICAgdGhpcy52aWRlb0RhdGFSYXRlID0gbnVsbDtcblxuICAgICAgICB0aGlzLmF1ZGlvU2FtcGxlUmF0ZSA9IG51bGw7XG4gICAgICAgIHRoaXMuYXVkaW9DaGFubmVsQ291bnQgPSBudWxsO1xuXG4gICAgICAgIHRoaXMud2lkdGggPSBudWxsO1xuICAgICAgICB0aGlzLmhlaWdodCA9IG51bGw7XG4gICAgICAgIHRoaXMuZnBzID0gbnVsbDtcbiAgICAgICAgdGhpcy5wcm9maWxlID0gbnVsbDtcbiAgICAgICAgdGhpcy5sZXZlbCA9IG51bGw7XG4gICAgICAgIHRoaXMucmVmRnJhbWVzID0gbnVsbDtcbiAgICAgICAgdGhpcy5jaHJvbWFGb3JtYXQgPSBudWxsO1xuICAgICAgICB0aGlzLnNhck51bSA9IG51bGw7XG4gICAgICAgIHRoaXMuc2FyRGVuID0gbnVsbDtcblxuICAgICAgICB0aGlzLm1ldGFkYXRhID0gbnVsbDtcbiAgICAgICAgdGhpcy5zZWdtZW50cyA9IG51bGw7IC8vIE1lZGlhSW5mb1tdXG4gICAgICAgIHRoaXMuc2VnbWVudENvdW50ID0gbnVsbDtcbiAgICAgICAgdGhpcy5oYXNLZXlmcmFtZXNJbmRleCA9IG51bGw7XG4gICAgICAgIHRoaXMua2V5ZnJhbWVzSW5kZXggPSBudWxsO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhNZWRpYUluZm8sIFt7XG4gICAgICAgIGtleTogXCJpc0NvbXBsZXRlXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpc0NvbXBsZXRlKCkge1xuICAgICAgICAgICAgdmFyIGF1ZGlvSW5mb0NvbXBsZXRlID0gdGhpcy5oYXNBdWRpbyA9PT0gZmFsc2UgfHwgdGhpcy5oYXNBdWRpbyA9PT0gdHJ1ZSAmJiB0aGlzLmF1ZGlvQ29kZWMgIT0gbnVsbCAmJiB0aGlzLmF1ZGlvU2FtcGxlUmF0ZSAhPSBudWxsICYmIHRoaXMuYXVkaW9DaGFubmVsQ291bnQgIT0gbnVsbDtcblxuICAgICAgICAgICAgdmFyIHZpZGVvSW5mb0NvbXBsZXRlID0gdGhpcy5oYXNWaWRlbyA9PT0gZmFsc2UgfHwgdGhpcy5oYXNWaWRlbyA9PT0gdHJ1ZSAmJiB0aGlzLnZpZGVvQ29kZWMgIT0gbnVsbCAmJiB0aGlzLndpZHRoICE9IG51bGwgJiYgdGhpcy5oZWlnaHQgIT0gbnVsbCAmJiB0aGlzLmZwcyAhPSBudWxsICYmIHRoaXMucHJvZmlsZSAhPSBudWxsICYmIHRoaXMubGV2ZWwgIT0gbnVsbCAmJiB0aGlzLnJlZkZyYW1lcyAhPSBudWxsICYmIHRoaXMuY2hyb21hRm9ybWF0ICE9IG51bGwgJiYgdGhpcy5zYXJOdW0gIT0gbnVsbCAmJiB0aGlzLnNhckRlbiAhPSBudWxsO1xuXG4gICAgICAgICAgICAvLyBrZXlmcmFtZXNJbmRleCBtYXkgbm90IGJlIHByZXNlbnRcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm1pbWVUeXBlICE9IG51bGwgJiYgdGhpcy5kdXJhdGlvbiAhPSBudWxsICYmIHRoaXMubWV0YWRhdGEgIT0gbnVsbCAmJiB0aGlzLmhhc0tleWZyYW1lc0luZGV4ICE9IG51bGwgJiYgYXVkaW9JbmZvQ29tcGxldGUgJiYgdmlkZW9JbmZvQ29tcGxldGU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJpc1NlZWthYmxlXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpc1NlZWthYmxlKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaGFzS2V5ZnJhbWVzSW5kZXggPT09IHRydWU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJnZXROZWFyZXN0S2V5ZnJhbWVcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldE5lYXJlc3RLZXlmcmFtZShtaWxsaXNlY29uZHMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmtleWZyYW1lc0luZGV4ID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHRhYmxlID0gdGhpcy5rZXlmcmFtZXNJbmRleDtcbiAgICAgICAgICAgIHZhciBrZXlmcmFtZUlkeCA9IHRoaXMuX3NlYXJjaCh0YWJsZS50aW1lcywgbWlsbGlzZWNvbmRzKTtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpbmRleDoga2V5ZnJhbWVJZHgsXG4gICAgICAgICAgICAgICAgbWlsbGlzZWNvbmRzOiB0YWJsZS50aW1lc1trZXlmcmFtZUlkeF0sXG4gICAgICAgICAgICAgICAgZmlsZXBvc2l0aW9uOiB0YWJsZS5maWxlcG9zaXRpb25zW2tleWZyYW1lSWR4XVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcIl9zZWFyY2hcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9zZWFyY2gobGlzdCwgdmFsdWUpIHtcbiAgICAgICAgICAgIHZhciBpZHggPSAwO1xuXG4gICAgICAgICAgICB2YXIgbGFzdCA9IGxpc3QubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIHZhciBtaWQgPSAwO1xuICAgICAgICAgICAgdmFyIGxib3VuZCA9IDA7XG4gICAgICAgICAgICB2YXIgdWJvdW5kID0gbGFzdDtcblxuICAgICAgICAgICAgaWYgKHZhbHVlIDwgbGlzdFswXSkge1xuICAgICAgICAgICAgICAgIGlkeCA9IDA7XG4gICAgICAgICAgICAgICAgbGJvdW5kID0gdWJvdW5kICsgMTsgLy8gc2tpcCBzZWFyY2hcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgd2hpbGUgKGxib3VuZCA8PSB1Ym91bmQpIHtcbiAgICAgICAgICAgICAgICBtaWQgPSBsYm91bmQgKyBNYXRoLmZsb29yKCh1Ym91bmQgLSBsYm91bmQpIC8gMik7XG4gICAgICAgICAgICAgICAgaWYgKG1pZCA9PT0gbGFzdCB8fCB2YWx1ZSA+PSBsaXN0W21pZF0gJiYgdmFsdWUgPCBsaXN0W21pZCArIDFdKSB7XG4gICAgICAgICAgICAgICAgICAgIGlkeCA9IG1pZDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaXN0W21pZF0gPCB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICBsYm91bmQgPSBtaWQgKyAxO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHVib3VuZCA9IG1pZCAtIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gaWR4O1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIE1lZGlhSW5mbztcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gTWVkaWFJbmZvO1xuXG59LHt9XSw4OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbi8vIFJlcHJlc2VudHMgYW4gbWVkaWEgc2FtcGxlIChhdWRpbyAvIHZpZGVvKVxudmFyIFNhbXBsZUluZm8gPSBleHBvcnRzLlNhbXBsZUluZm8gPSBmdW5jdGlvbiBTYW1wbGVJbmZvKGR0cywgcHRzLCBkdXJhdGlvbiwgb3JpZ2luYWxEdHMsIGlzU3luYykge1xuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTYW1wbGVJbmZvKTtcblxuICAgIHRoaXMuZHRzID0gZHRzO1xuICAgIHRoaXMucHRzID0gcHRzO1xuICAgIHRoaXMuZHVyYXRpb24gPSBkdXJhdGlvbjtcbiAgICB0aGlzLm9yaWdpbmFsRHRzID0gb3JpZ2luYWxEdHM7XG4gICAgdGhpcy5pc1N5bmNQb2ludCA9IGlzU3luYztcbiAgICB0aGlzLmZpbGVwb3NpdGlvbiA9IG51bGw7XG59O1xuXG4vLyBNZWRpYSBTZWdtZW50IGNvbmNlcHQgaXMgZGVmaW5lZCBpbiBNZWRpYSBTb3VyY2UgRXh0ZW5zaW9ucyBzcGVjLlxuLy8gUGFydGljdWxhcmx5IGluIElTTyBCTUZGIGZvcm1hdCwgYW4gTWVkaWEgU2VnbWVudCBjb250YWlucyBhIG1vb2YgYm94IGZvbGxvd2VkIGJ5IGEgbWRhdCBib3guXG5cblxudmFyIE1lZGlhU2VnbWVudEluZm8gPSBleHBvcnRzLk1lZGlhU2VnbWVudEluZm8gPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTWVkaWFTZWdtZW50SW5mbygpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1lZGlhU2VnbWVudEluZm8pO1xuXG4gICAgICAgIHRoaXMuYmVnaW5EdHMgPSAwO1xuICAgICAgICB0aGlzLmVuZER0cyA9IDA7XG4gICAgICAgIHRoaXMuYmVnaW5QdHMgPSAwO1xuICAgICAgICB0aGlzLmVuZFB0cyA9IDA7XG4gICAgICAgIHRoaXMub3JpZ2luYWxCZWdpbkR0cyA9IDA7XG4gICAgICAgIHRoaXMub3JpZ2luYWxFbmREdHMgPSAwO1xuICAgICAgICB0aGlzLnN5bmNQb2ludHMgPSBbXTsgLy8gU2FtcGxlSW5mb1tuXSwgZm9yIHZpZGVvIElEUiBmcmFtZXMgb25seVxuICAgICAgICB0aGlzLmZpcnN0U2FtcGxlID0gbnVsbDsgLy8gU2FtcGxlSW5mb1xuICAgICAgICB0aGlzLmxhc3RTYW1wbGUgPSBudWxsOyAvLyBTYW1wbGVJbmZvXG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKE1lZGlhU2VnbWVudEluZm8sIFt7XG4gICAgICAgIGtleTogXCJhcHBlbmRTeW5jUG9pbnRcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGVuZFN5bmNQb2ludChzYW1wbGVJbmZvKSB7XG4gICAgICAgICAgICAvLyBhbHNvIGNhbGxlZCBSYW5kb20gQWNjZXNzIFBvaW50XG4gICAgICAgICAgICBzYW1wbGVJbmZvLmlzU3luY1BvaW50ID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuc3luY1BvaW50cy5wdXNoKHNhbXBsZUluZm8pO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIE1lZGlhU2VnbWVudEluZm87XG59KCk7XG5cbi8vIE9yZGVyZWQgbGlzdCBmb3IgcmVjb3JkaW5nIHZpZGVvIElEUiBmcmFtZXMsIHNvcnRlZCBieSBvcmlnaW5hbER0c1xuXG5cbnZhciBJRFJTYW1wbGVMaXN0ID0gZXhwb3J0cy5JRFJTYW1wbGVMaXN0ID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIElEUlNhbXBsZUxpc3QoKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBJRFJTYW1wbGVMaXN0KTtcblxuICAgICAgICB0aGlzLl9saXN0ID0gW107XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKElEUlNhbXBsZUxpc3QsIFt7XG4gICAgICAgIGtleTogXCJjbGVhclwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYXIoKSB7XG4gICAgICAgICAgICB0aGlzLl9saXN0ID0gW107XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJhcHBlbmRBcnJheVwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXBwZW5kQXJyYXkoc3luY1BvaW50cykge1xuICAgICAgICAgICAgdmFyIGxpc3QgPSB0aGlzLl9saXN0O1xuXG4gICAgICAgICAgICBpZiAoc3luY1BvaW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChsaXN0Lmxlbmd0aCA+IDAgJiYgc3luY1BvaW50c1swXS5vcmlnaW5hbER0cyA8IGxpc3RbbGlzdC5sZW5ndGggLSAxXS5vcmlnaW5hbER0cykge1xuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLnB1c2guYXBwbHkobGlzdCwgc3luY1BvaW50cyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJnZXRMYXN0U3luY1BvaW50QmVmb3JlRHRzXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRMYXN0U3luY1BvaW50QmVmb3JlRHRzKGR0cykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2xpc3QubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGxpc3QgPSB0aGlzLl9saXN0O1xuICAgICAgICAgICAgdmFyIGlkeCA9IDA7XG4gICAgICAgICAgICB2YXIgbGFzdCA9IGxpc3QubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIHZhciBtaWQgPSAwO1xuICAgICAgICAgICAgdmFyIGxib3VuZCA9IDA7XG4gICAgICAgICAgICB2YXIgdWJvdW5kID0gbGFzdDtcblxuICAgICAgICAgICAgaWYgKGR0cyA8IGxpc3RbMF0uZHRzKSB7XG4gICAgICAgICAgICAgICAgaWR4ID0gMDtcbiAgICAgICAgICAgICAgICBsYm91bmQgPSB1Ym91bmQgKyAxO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB3aGlsZSAobGJvdW5kIDw9IHVib3VuZCkge1xuICAgICAgICAgICAgICAgIG1pZCA9IGxib3VuZCArIE1hdGguZmxvb3IoKHVib3VuZCAtIGxib3VuZCkgLyAyKTtcbiAgICAgICAgICAgICAgICBpZiAobWlkID09PSBsYXN0IHx8IGR0cyA+PSBsaXN0W21pZF0uZHRzICYmIGR0cyA8IGxpc3RbbWlkICsgMV0uZHRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlkeCA9IG1pZDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChsaXN0W21pZF0uZHRzIDwgZHRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGxib3VuZCA9IG1pZCArIDE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdWJvdW5kID0gbWlkIC0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbGlzdFtpZHhdO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIElEUlNhbXBsZUxpc3Q7XG59KCk7XG5cbi8vIERhdGEgc3RydWN0dXJlIGZvciByZWNvcmRpbmcgaW5mb3JtYXRpb24gb2YgbWVkaWEgc2VnbWVudHMgaW4gc2luZ2xlIHRyYWNrLlxuXG5cbnZhciBNZWRpYVNlZ21lbnRJbmZvTGlzdCA9IGV4cG9ydHMuTWVkaWFTZWdtZW50SW5mb0xpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTWVkaWFTZWdtZW50SW5mb0xpc3QodHlwZSkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTWVkaWFTZWdtZW50SW5mb0xpc3QpO1xuXG4gICAgICAgIHRoaXMuX3R5cGUgPSB0eXBlO1xuICAgICAgICB0aGlzLl9saXN0ID0gW107XG4gICAgICAgIHRoaXMuX2xhc3RBcHBlbmRMb2NhdGlvbiA9IC0xOyAvLyBjYWNoZWQgbGFzdCBpbnNlcnQgbG9jYXRpb25cbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoTWVkaWFTZWdtZW50SW5mb0xpc3QsIFt7XG4gICAgICAgIGtleTogXCJpc0VtcHR5XCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpc0VtcHR5KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xpc3QubGVuZ3RoID09PSAwO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiY2xlYXJcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGNsZWFyKCkge1xuICAgICAgICAgICAgdGhpcy5fbGlzdCA9IFtdO1xuICAgICAgICAgICAgdGhpcy5fbGFzdEFwcGVuZExvY2F0aW9uID0gLTE7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJfc2VhcmNoTmVhcmVzdFNlZ21lbnRCZWZvcmVcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9zZWFyY2hOZWFyZXN0U2VnbWVudEJlZm9yZShvcmlnaW5hbEJlZ2luRHRzKSB7XG4gICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXMuX2xpc3Q7XG4gICAgICAgICAgICBpZiAobGlzdC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgbGFzdCA9IGxpc3QubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIHZhciBtaWQgPSAwO1xuICAgICAgICAgICAgdmFyIGxib3VuZCA9IDA7XG4gICAgICAgICAgICB2YXIgdWJvdW5kID0gbGFzdDtcblxuICAgICAgICAgICAgdmFyIGlkeCA9IDA7XG5cbiAgICAgICAgICAgIGlmIChvcmlnaW5hbEJlZ2luRHRzIDwgbGlzdFswXS5vcmlnaW5hbEJlZ2luRHRzKSB7XG4gICAgICAgICAgICAgICAgaWR4ID0gLTE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGlkeDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgd2hpbGUgKGxib3VuZCA8PSB1Ym91bmQpIHtcbiAgICAgICAgICAgICAgICBtaWQgPSBsYm91bmQgKyBNYXRoLmZsb29yKCh1Ym91bmQgLSBsYm91bmQpIC8gMik7XG4gICAgICAgICAgICAgICAgaWYgKG1pZCA9PT0gbGFzdCB8fCBvcmlnaW5hbEJlZ2luRHRzID4gbGlzdFttaWRdLmxhc3RTYW1wbGUub3JpZ2luYWxEdHMgJiYgb3JpZ2luYWxCZWdpbkR0cyA8IGxpc3RbbWlkICsgMV0ub3JpZ2luYWxCZWdpbkR0cykge1xuICAgICAgICAgICAgICAgICAgICBpZHggPSBtaWQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGlzdFttaWRdLm9yaWdpbmFsQmVnaW5EdHMgPCBvcmlnaW5hbEJlZ2luRHRzKSB7XG4gICAgICAgICAgICAgICAgICAgIGxib3VuZCA9IG1pZCArIDE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdWJvdW5kID0gbWlkIC0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaWR4O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiX3NlYXJjaE5lYXJlc3RTZWdtZW50QWZ0ZXJcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9zZWFyY2hOZWFyZXN0U2VnbWVudEFmdGVyKG9yaWdpbmFsQmVnaW5EdHMpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zZWFyY2hOZWFyZXN0U2VnbWVudEJlZm9yZShvcmlnaW5hbEJlZ2luRHRzKSArIDE7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJhcHBlbmRcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGVuZChtZWRpYVNlZ21lbnRJbmZvKSB7XG4gICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXMuX2xpc3Q7XG4gICAgICAgICAgICB2YXIgbXNpID0gbWVkaWFTZWdtZW50SW5mbztcbiAgICAgICAgICAgIHZhciBsYXN0QXBwZW5kSWR4ID0gdGhpcy5fbGFzdEFwcGVuZExvY2F0aW9uO1xuICAgICAgICAgICAgdmFyIGluc2VydElkeCA9IDA7XG5cbiAgICAgICAgICAgIGlmIChsYXN0QXBwZW5kSWR4ICE9PSAtMSAmJiBsYXN0QXBwZW5kSWR4IDwgbGlzdC5sZW5ndGggJiYgbXNpLm9yaWdpbmFsQmVnaW5EdHMgPj0gbGlzdFtsYXN0QXBwZW5kSWR4XS5sYXN0U2FtcGxlLm9yaWdpbmFsRHRzICYmIChsYXN0QXBwZW5kSWR4ID09PSBsaXN0Lmxlbmd0aCAtIDEgfHwgbGFzdEFwcGVuZElkeCA8IGxpc3QubGVuZ3RoIC0gMSAmJiBtc2kub3JpZ2luYWxCZWdpbkR0cyA8IGxpc3RbbGFzdEFwcGVuZElkeCArIDFdLm9yaWdpbmFsQmVnaW5EdHMpKSB7XG4gICAgICAgICAgICAgICAgaW5zZXJ0SWR4ID0gbGFzdEFwcGVuZElkeCArIDE7IC8vIHVzZSBjYWNoZWQgbG9jYXRpb24gaWR4XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChsaXN0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgaW5zZXJ0SWR4ID0gdGhpcy5fc2VhcmNoTmVhcmVzdFNlZ21lbnRCZWZvcmUobXNpLm9yaWdpbmFsQmVnaW5EdHMpICsgMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX2xhc3RBcHBlbmRMb2NhdGlvbiA9IGluc2VydElkeDtcbiAgICAgICAgICAgIHRoaXMuX2xpc3Quc3BsaWNlKGluc2VydElkeCwgMCwgbXNpKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImdldExhc3RTZWdtZW50QmVmb3JlXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRMYXN0U2VnbWVudEJlZm9yZShvcmlnaW5hbEJlZ2luRHRzKSB7XG4gICAgICAgICAgICB2YXIgaWR4ID0gdGhpcy5fc2VhcmNoTmVhcmVzdFNlZ21lbnRCZWZvcmUob3JpZ2luYWxCZWdpbkR0cyk7XG4gICAgICAgICAgICBpZiAoaWR4ID49IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbGlzdFtpZHhdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyAtMVxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiZ2V0TGFzdFNhbXBsZUJlZm9yZVwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TGFzdFNhbXBsZUJlZm9yZShvcmlnaW5hbEJlZ2luRHRzKSB7XG4gICAgICAgICAgICB2YXIgc2VnbWVudCA9IHRoaXMuZ2V0TGFzdFNlZ21lbnRCZWZvcmUob3JpZ2luYWxCZWdpbkR0cyk7XG4gICAgICAgICAgICBpZiAoc2VnbWVudCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlZ21lbnQubGFzdFNhbXBsZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJnZXRMYXN0U3luY1BvaW50QmVmb3JlXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRMYXN0U3luY1BvaW50QmVmb3JlKG9yaWdpbmFsQmVnaW5EdHMpIHtcbiAgICAgICAgICAgIHZhciBzZWdtZW50SWR4ID0gdGhpcy5fc2VhcmNoTmVhcmVzdFNlZ21lbnRCZWZvcmUob3JpZ2luYWxCZWdpbkR0cyk7XG4gICAgICAgICAgICB2YXIgc3luY1BvaW50cyA9IHRoaXMuX2xpc3Rbc2VnbWVudElkeF0uc3luY1BvaW50cztcbiAgICAgICAgICAgIHdoaWxlIChzeW5jUG9pbnRzLmxlbmd0aCA9PT0gMCAmJiBzZWdtZW50SWR4ID4gMCkge1xuICAgICAgICAgICAgICAgIHNlZ21lbnRJZHgtLTtcbiAgICAgICAgICAgICAgICBzeW5jUG9pbnRzID0gdGhpcy5fbGlzdFtzZWdtZW50SWR4XS5zeW5jUG9pbnRzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN5bmNQb2ludHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzeW5jUG9pbnRzW3N5bmNQb2ludHMubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwidHlwZVwiLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90eXBlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwibGVuZ3RoXCIsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xpc3QubGVuZ3RoO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIE1lZGlhU2VnbWVudEluZm9MaXN0O1xufSgpO1xuXG59LHt9XSw5OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9ldmVudHMgPSBfZGVyZXFfKCdldmVudHMnKTtcblxudmFyIF9ldmVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXZlbnRzKTtcblxudmFyIF9sb2dnZXIgPSBfZGVyZXFfKCcuLi91dGlscy9sb2dnZXIuanMnKTtcblxudmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTtcblxudmFyIF9icm93c2VyID0gX2RlcmVxXygnLi4vdXRpbHMvYnJvd3Nlci5qcycpO1xuXG52YXIgX2Jyb3dzZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYnJvd3Nlcik7XG5cbnZhciBfbXNlRXZlbnRzID0gX2RlcmVxXygnLi9tc2UtZXZlbnRzLmpzJyk7XG5cbnZhciBfbXNlRXZlbnRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21zZUV2ZW50cyk7XG5cbnZhciBfbWVkaWFTZWdtZW50SW5mbyA9IF9kZXJlcV8oJy4vbWVkaWEtc2VnbWVudC1pbmZvLmpzJyk7XG5cbnZhciBfZXhjZXB0aW9uID0gX2RlcmVxXygnLi4vdXRpbHMvZXhjZXB0aW9uLmpzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8vIE1lZGlhIFNvdXJjZSBFeHRlbnNpb25zIGNvbnRyb2xsZXJcbnZhciBNU0VDb250cm9sbGVyID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1TRUNvbnRyb2xsZXIoY29uZmlnKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNU0VDb250cm9sbGVyKTtcblxuICAgICAgICB0aGlzLlRBRyA9ICdNU0VDb250cm9sbGVyJztcblxuICAgICAgICB0aGlzLl9jb25maWcgPSBjb25maWc7XG4gICAgICAgIHRoaXMuX2VtaXR0ZXIgPSBuZXcgX2V2ZW50czIuZGVmYXVsdCgpO1xuXG4gICAgICAgIGlmICh0aGlzLl9jb25maWcuaXNMaXZlICYmIHRoaXMuX2NvbmZpZy5hdXRvQ2xlYW51cFNvdXJjZUJ1ZmZlciA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIC8vIEZvciBsaXZlIHN0cmVhbSwgZG8gYXV0byBjbGVhbnVwIGJ5IGRlZmF1bHRcbiAgICAgICAgICAgIHRoaXMuX2NvbmZpZy5hdXRvQ2xlYW51cFNvdXJjZUJ1ZmZlciA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmUgPSB7XG4gICAgICAgICAgICBvblNvdXJjZU9wZW46IHRoaXMuX29uU291cmNlT3Blbi5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgb25Tb3VyY2VFbmRlZDogdGhpcy5fb25Tb3VyY2VFbmRlZC5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgb25Tb3VyY2VDbG9zZTogdGhpcy5fb25Tb3VyY2VDbG9zZS5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgb25Tb3VyY2VCdWZmZXJFcnJvcjogdGhpcy5fb25Tb3VyY2VCdWZmZXJFcnJvci5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgb25Tb3VyY2VCdWZmZXJVcGRhdGVFbmQ6IHRoaXMuX29uU291cmNlQnVmZmVyVXBkYXRlRW5kLmJpbmQodGhpcylcbiAgICAgICAgfTtcblxuICAgICAgICB0aGlzLl9tZWRpYVNvdXJjZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX21lZGlhU291cmNlT2JqZWN0VVJMID0gbnVsbDtcbiAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50ID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9pc0J1ZmZlckZ1bGwgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5faGFzUGVuZGluZ0VvcyA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuX3JlcXVpcmVTZXRNZWRpYUR1cmF0aW9uID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3BlbmRpbmdNZWRpYUR1cmF0aW9uID0gMDtcblxuICAgICAgICB0aGlzLl9wZW5kaW5nU291cmNlQnVmZmVySW5pdCA9IFtdO1xuICAgICAgICB0aGlzLl9taW1lVHlwZXMgPSB7XG4gICAgICAgICAgICB2aWRlbzogbnVsbCxcbiAgICAgICAgICAgIGF1ZGlvOiBudWxsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX3NvdXJjZUJ1ZmZlcnMgPSB7XG4gICAgICAgICAgICB2aWRlbzogbnVsbCxcbiAgICAgICAgICAgIGF1ZGlvOiBudWxsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX2xhc3RJbml0U2VnbWVudHMgPSB7XG4gICAgICAgICAgICB2aWRlbzogbnVsbCxcbiAgICAgICAgICAgIGF1ZGlvOiBudWxsXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX3BlbmRpbmdTZWdtZW50cyA9IHtcbiAgICAgICAgICAgIHZpZGVvOiBbXSxcbiAgICAgICAgICAgIGF1ZGlvOiBbXVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLl9wZW5kaW5nUmVtb3ZlUmFuZ2VzID0ge1xuICAgICAgICAgICAgdmlkZW86IFtdLFxuICAgICAgICAgICAgYXVkaW86IFtdXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX2lkckxpc3QgPSBuZXcgX21lZGlhU2VnbWVudEluZm8uSURSU2FtcGxlTGlzdCgpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhNU0VDb250cm9sbGVyLCBbe1xuICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50IHx8IHRoaXMuX21lZGlhU291cmNlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kZXRhY2hNZWRpYUVsZW1lbnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLnJlbW92ZUFsbExpc3RlbmVycygpO1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlciA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9uKGV2ZW50LCBsaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5hZGRMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvZmYnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb2ZmKGV2ZW50LCBsaXN0ZW5lcikge1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5yZW1vdmVMaXN0ZW5lcihldmVudCwgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhdHRhY2hNZWRpYUVsZW1lbnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXR0YWNoTWVkaWFFbGVtZW50KG1lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhU291cmNlKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCdNZWRpYVNvdXJjZSBoYXMgYmVlbiBhdHRhY2hlZCB0byBhbiBIVE1MTWVkaWFFbGVtZW50IScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG1zID0gdGhpcy5fbWVkaWFTb3VyY2UgPSBuZXcgd2luZG93Lk1lZGlhU291cmNlKCk7XG4gICAgICAgICAgICBtcy5hZGRFdmVudExpc3RlbmVyKCdzb3VyY2VvcGVuJywgdGhpcy5lLm9uU291cmNlT3Blbik7XG4gICAgICAgICAgICBtcy5hZGRFdmVudExpc3RlbmVyKCdzb3VyY2VlbmRlZCcsIHRoaXMuZS5vblNvdXJjZUVuZGVkKTtcbiAgICAgICAgICAgIG1zLmFkZEV2ZW50TGlzdGVuZXIoJ3NvdXJjZWNsb3NlJywgdGhpcy5lLm9uU291cmNlQ2xvc2UpO1xuXG4gICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQgPSBtZWRpYUVsZW1lbnQ7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYVNvdXJjZU9iamVjdFVSTCA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKHRoaXMuX21lZGlhU291cmNlKTtcbiAgICAgICAgICAgIG1lZGlhRWxlbWVudC5zcmMgPSB0aGlzLl9tZWRpYVNvdXJjZU9iamVjdFVSTDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZGV0YWNoTWVkaWFFbGVtZW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRldGFjaE1lZGlhRWxlbWVudCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYVNvdXJjZSkge1xuICAgICAgICAgICAgICAgIHZhciBtcyA9IHRoaXMuX21lZGlhU291cmNlO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIHR5cGUgaW4gdGhpcy5fc291cmNlQnVmZmVycykge1xuICAgICAgICAgICAgICAgICAgICAvLyBwZW5kaW5nIHNlZ21lbnRzIHNob3VsZCBiZSBkaXNjYXJkXG4gICAgICAgICAgICAgICAgICAgIHZhciBwcyA9IHRoaXMuX3BlbmRpbmdTZWdtZW50c1t0eXBlXTtcbiAgICAgICAgICAgICAgICAgICAgcHMuc3BsaWNlKDAsIHBzLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTZWdtZW50c1t0eXBlXSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdSZW1vdmVSYW5nZXNbdHlwZV0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sYXN0SW5pdFNlZ21lbnRzW3R5cGVdID0gbnVsbDtcblxuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgYWxsIHNvdXJjZWJ1ZmZlcnNcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNiID0gdGhpcy5fc291cmNlQnVmZmVyc1t0eXBlXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobXMucmVhZHlTdGF0ZSAhPT0gJ2Nsb3NlZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtcyBlZGdlIGNhbiB0aHJvdyBhbiBlcnJvcjogVW5leHBlY3RlZCBjYWxsIHRvIG1ldGhvZCBvciBwcm9wZXJ0eSBhY2Nlc3NcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtcy5yZW1vdmVTb3VyY2VCdWZmZXIoc2IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZSh0aGlzLlRBRywgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNiLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgdGhpcy5lLm9uU291cmNlQnVmZmVyRXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNiLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3VwZGF0ZWVuZCcsIHRoaXMuZS5vblNvdXJjZUJ1ZmZlclVwZGF0ZUVuZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9taW1lVHlwZXNbdHlwZV0gPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc291cmNlQnVmZmVyc1t0eXBlXSA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG1zLnJlYWR5U3RhdGUgPT09ICdvcGVuJykge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbXMuZW5kT2ZTdHJlYW0oKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZSh0aGlzLlRBRywgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbXMucmVtb3ZlRXZlbnRMaXN0ZW5lcignc291cmNlb3BlbicsIHRoaXMuZS5vblNvdXJjZU9wZW4pO1xuICAgICAgICAgICAgICAgIG1zLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3NvdXJjZWVuZGVkJywgdGhpcy5lLm9uU291cmNlRW5kZWQpO1xuICAgICAgICAgICAgICAgIG1zLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3NvdXJjZWNsb3NlJywgdGhpcy5lLm9uU291cmNlQ2xvc2UpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTb3VyY2VCdWZmZXJJbml0ID0gW107XG4gICAgICAgICAgICAgICAgdGhpcy5faXNCdWZmZXJGdWxsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5faWRyTGlzdC5jbGVhcigpO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhU291cmNlID0gbnVsbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5zcmMgPSAnJztcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCdzcmMnKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhU291cmNlT2JqZWN0VVJMKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LlVSTC5yZXZva2VPYmplY3RVUkwodGhpcy5fbWVkaWFTb3VyY2VPYmplY3RVUkwpO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhU291cmNlT2JqZWN0VVJMID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYXBwZW5kSW5pdFNlZ21lbnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXBwZW5kSW5pdFNlZ21lbnQoaW5pdFNlZ21lbnQsIGRlZmVycmVkKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX21lZGlhU291cmNlIHx8IHRoaXMuX21lZGlhU291cmNlLnJlYWR5U3RhdGUgIT09ICdvcGVuJykge1xuICAgICAgICAgICAgICAgIC8vIHNvdXJjZWJ1ZmZlciBjcmVhdGlvbiByZXF1aXJlcyBtZWRpYVNvdXJjZS5yZWFkeVN0YXRlID09PSAnb3BlbidcbiAgICAgICAgICAgICAgICAvLyBzbyB3ZSBkZWZlciB0aGUgc291cmNlYnVmZmVyIGNyZWF0aW9uLCB1bnRpbCBzb3VyY2VvcGVuIGV2ZW50IHRyaWdnZXJlZFxuICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTb3VyY2VCdWZmZXJJbml0LnB1c2goaW5pdFNlZ21lbnQpO1xuICAgICAgICAgICAgICAgIC8vIG1ha2Ugc3VyZSB0aGF0IHRoaXMgSW5pdFNlZ21lbnQgaXMgaW4gdGhlIGZyb250IG9mIHBlbmRpbmcgc2VnbWVudHMgcXVldWVcbiAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nU2VnbWVudHNbaW5pdFNlZ21lbnQudHlwZV0ucHVzaChpbml0U2VnbWVudCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgaXMgPSBpbml0U2VnbWVudDtcbiAgICAgICAgICAgIHZhciBtaW1lVHlwZSA9ICcnICsgaXMuY29udGFpbmVyO1xuICAgICAgICAgICAgaWYgKGlzLmNvZGVjICYmIGlzLmNvZGVjLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBtaW1lVHlwZSArPSAnO2NvZGVjcz0nICsgaXMuY29kZWM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBmaXJzdEluaXRTZWdtZW50ID0gZmFsc2U7XG5cbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudih0aGlzLlRBRywgJ1JlY2VpdmVkIEluaXRpYWxpemF0aW9uIFNlZ21lbnQsIG1pbWVUeXBlOiAnICsgbWltZVR5cGUpO1xuICAgICAgICAgICAgdGhpcy5fbGFzdEluaXRTZWdtZW50c1tpcy50eXBlXSA9IGlzO1xuXG4gICAgICAgICAgICBpZiAobWltZVR5cGUgIT09IHRoaXMuX21pbWVUeXBlc1tpcy50eXBlXSkge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fbWltZVR5cGVzW2lzLnR5cGVdKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGVtcHR5LCBmaXJzdCBjaGFuY2UgY3JlYXRlIHNvdXJjZWJ1ZmZlclxuICAgICAgICAgICAgICAgICAgICBmaXJzdEluaXRTZWdtZW50ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzYiA9IHRoaXMuX3NvdXJjZUJ1ZmZlcnNbaXMudHlwZV0gPSB0aGlzLl9tZWRpYVNvdXJjZS5hZGRTb3VyY2VCdWZmZXIobWltZVR5cGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2IuYWRkRXZlbnRMaXN0ZW5lcignZXJyb3InLCB0aGlzLmUub25Tb3VyY2VCdWZmZXJFcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBzYi5hZGRFdmVudExpc3RlbmVyKCd1cGRhdGVlbmQnLCB0aGlzLmUub25Tb3VyY2VCdWZmZXJVcGRhdGVFbmQpO1xuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lKHRoaXMuVEFHLCBlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfbXNlRXZlbnRzMi5kZWZhdWx0LkVSUk9SLCB7IGNvZGU6IGVycm9yLmNvZGUsIG1zZzogZXJyb3IubWVzc2FnZSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudih0aGlzLlRBRywgJ05vdGljZTogJyArIGlzLnR5cGUgKyAnIG1pbWVUeXBlIGNoYW5nZWQsIG9yaWdpbjogJyArIHRoaXMuX21pbWVUeXBlc1tpcy50eXBlXSArICcsIHRhcmdldDogJyArIG1pbWVUeXBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fbWltZVR5cGVzW2lzLnR5cGVdID0gbWltZVR5cGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghZGVmZXJyZWQpIHtcbiAgICAgICAgICAgICAgICAvLyBkZWZlcnJlZCBtZWFucyB0aGlzIEluaXRTZWdtZW50IGhhcyBiZWVuIHB1c2hlZCB0byBwZW5kaW5nU2VnbWVudHMgcXVldWVcbiAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nU2VnbWVudHNbaXMudHlwZV0ucHVzaChpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIWZpcnN0SW5pdFNlZ21lbnQpIHtcbiAgICAgICAgICAgICAgICAvLyBhcHBlbmQgaW1tZWRpYXRlbHkgb25seSBpZiBpbml0IHNlZ21lbnQgaW4gc3Vic2VxdWVuY2VcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc291cmNlQnVmZmVyc1tpcy50eXBlXSAmJiAhdGhpcy5fc291cmNlQnVmZmVyc1tpcy50eXBlXS51cGRhdGluZykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kb0FwcGVuZFNlZ21lbnRzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKF9icm93c2VyMi5kZWZhdWx0LnNhZmFyaSAmJiBpcy5jb250YWluZXIgPT09ICdhdWRpby9tcGVnJyAmJiBpcy5tZWRpYUR1cmF0aW9uID4gMCkge1xuICAgICAgICAgICAgICAgIC8vICdhdWRpby9tcGVnJyB0cmFjayB1bmRlciBTYWZhcmkgbWF5IGNhdXNlIE1lZGlhRWxlbWVudCdzIGR1cmF0aW9uIHRvIGJlIE5hTlxuICAgICAgICAgICAgICAgIC8vIE1hbnVhbGx5IGNvcnJlY3QgTWVkaWFTb3VyY2UuZHVyYXRpb24gdG8gbWFrZSBwcm9ncmVzcyBiYXIgc2Vla2FibGUsIGFuZCByZXBvcnQgcmlnaHQgZHVyYXRpb25cbiAgICAgICAgICAgICAgICB0aGlzLl9yZXF1aXJlU2V0TWVkaWFEdXJhdGlvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ01lZGlhRHVyYXRpb24gPSBpcy5tZWRpYUR1cmF0aW9uIC8gMTAwMDsgLy8gaW4gc2Vjb25kc1xuICAgICAgICAgICAgICAgIHRoaXMuX3VwZGF0ZU1lZGlhU291cmNlRHVyYXRpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYXBwZW5kTWVkaWFTZWdtZW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFwcGVuZE1lZGlhU2VnbWVudChtZWRpYVNlZ21lbnQpIHtcbiAgICAgICAgICAgIHZhciBtcyA9IG1lZGlhU2VnbWVudDtcbiAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTZWdtZW50c1ttcy50eXBlXS5wdXNoKG1zKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbmZpZy5hdXRvQ2xlYW51cFNvdXJjZUJ1ZmZlciAmJiB0aGlzLl9uZWVkQ2xlYW51cFNvdXJjZUJ1ZmZlcigpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZG9DbGVhbnVwU291cmNlQnVmZmVyKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzYiA9IHRoaXMuX3NvdXJjZUJ1ZmZlcnNbbXMudHlwZV07XG4gICAgICAgICAgICBpZiAoc2IgJiYgIXNiLnVwZGF0aW5nICYmICF0aGlzLl9oYXNQZW5kaW5nUmVtb3ZlUmFuZ2VzKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kb0FwcGVuZFNlZ21lbnRzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3NlZWsnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gc2VlayhzZWNvbmRzKSB7XG4gICAgICAgICAgICAvLyByZW1vdmUgYWxsIGFwcGVuZGVkIGJ1ZmZlcnNcbiAgICAgICAgICAgIGZvciAodmFyIHR5cGUgaW4gdGhpcy5fc291cmNlQnVmZmVycykge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fc291cmNlQnVmZmVyc1t0eXBlXSkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBhYm9ydCBjdXJyZW50IGJ1ZmZlciBhcHBlbmQgYWxnb3JpdGhtXG4gICAgICAgICAgICAgICAgdmFyIHNiID0gdGhpcy5fc291cmNlQnVmZmVyc1t0eXBlXTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFTb3VyY2UucmVhZHlTdGF0ZSA9PT0gJ29wZW4nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiByYW5nZSByZW1vdmFsIGFsZ29yaXRobSBpcyBydW5uaW5nLCBJbnZhbGlkU3RhdGVFcnJvciB3aWxsIGJlIHRocm93ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElnbm9yZSBpdC5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNiLmFib3J0KCk7XG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmUodGhpcy5UQUcsIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gSURSTGlzdCBzaG91bGQgYmUgY2xlYXJcbiAgICAgICAgICAgICAgICB0aGlzLl9pZHJMaXN0LmNsZWFyKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBwZW5kaW5nIHNlZ21lbnRzIHNob3VsZCBiZSBkaXNjYXJkXG4gICAgICAgICAgICAgICAgdmFyIHBzID0gdGhpcy5fcGVuZGluZ1NlZ21lbnRzW3R5cGVdO1xuICAgICAgICAgICAgICAgIHBzLnNwbGljZSgwLCBwcy5sZW5ndGgpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhU291cmNlLnJlYWR5U3RhdGUgPT09ICdjbG9zZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFBhcmVudCBNZWRpYVNvdXJjZSBvYmplY3QgaGFzIGJlZW4gZGV0YWNoZWQgZnJvbSBIVE1MTWVkaWFFbGVtZW50XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIHJlY29yZCByYW5nZXMgdG8gYmUgcmVtb3ZlIGZyb20gU291cmNlQnVmZmVyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzYi5idWZmZXJlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBzYi5idWZmZXJlZC5zdGFydChpKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVuZCA9IHNiLmJ1ZmZlcmVkLmVuZChpKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1JlbW92ZVJhbmdlc1t0eXBlXS5wdXNoKHsgc3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZCB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBpZiBzYiBpcyBub3QgdXBkYXRpbmcsIGxldCdzIHJlbW92ZSByYW5nZXMgbm93IVxuICAgICAgICAgICAgICAgIGlmICghc2IudXBkYXRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZG9SZW1vdmVSYW5nZXMoKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBTYWZhcmkgMTAgbWF5IGdldCBJbnZhbGlkU3RhdGVFcnJvciBpbiB0aGUgbGF0ZXIgYXBwZW5kQnVmZmVyKCkgYWZ0ZXIgU291cmNlQnVmZmVyLnJlbW92ZSgpIGNhbGxcbiAgICAgICAgICAgICAgICAvLyBJbnRlcm5hbCBwYXJzZXIncyBzdGF0ZSBtYXkgYmUgaW52YWxpZCBhdCB0aGlzIHRpbWUuIFJlLWFwcGVuZCBsYXN0IEluaXRTZWdtZW50IHRvIHdvcmthcm91bmQuXG4gICAgICAgICAgICAgICAgLy8gUmVsYXRlZCBpc3N1ZTogaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTE1OTIzMFxuICAgICAgICAgICAgICAgIGlmIChfYnJvd3NlcjIuZGVmYXVsdC5zYWZhcmkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxhc3RJbml0U2VnbWVudCA9IHRoaXMuX2xhc3RJbml0U2VnbWVudHNbdHlwZV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChsYXN0SW5pdFNlZ21lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTZWdtZW50c1t0eXBlXS5wdXNoKGxhc3RJbml0U2VnbWVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNiLnVwZGF0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZG9BcHBlbmRTZWdtZW50cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdlbmRPZlN0cmVhbScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBlbmRPZlN0cmVhbSgpIHtcbiAgICAgICAgICAgIHZhciBtcyA9IHRoaXMuX21lZGlhU291cmNlO1xuICAgICAgICAgICAgdmFyIHNiID0gdGhpcy5fc291cmNlQnVmZmVycztcbiAgICAgICAgICAgIGlmICghbXMgfHwgbXMucmVhZHlTdGF0ZSAhPT0gJ29wZW4nKSB7XG4gICAgICAgICAgICAgICAgaWYgKG1zICYmIG1zLnJlYWR5U3RhdGUgPT09ICdjbG9zZWQnICYmIHRoaXMuX2hhc1BlbmRpbmdTZWdtZW50cygpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIE1lZGlhU291cmNlIGhhc24ndCB0dXJuZWQgaW50byBvcGVuIHN0YXRlLCBhbmQgdGhlcmUncmUgcGVuZGluZyBzZWdtZW50c1xuICAgICAgICAgICAgICAgICAgICAvLyBNYXJrIHBlbmRpbmcgZW5kT2ZTdHJlYW0sIGRlZmVyIGNhbGwgdW50aWwgYWxsIHBlbmRpbmcgc2VnbWVudHMgYXBwZW5kZWQgY29tcGxldGVcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGFzUGVuZGluZ0VvcyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzYi52aWRlbyAmJiBzYi52aWRlby51cGRhdGluZyB8fCBzYi5hdWRpbyAmJiBzYi5hdWRpby51cGRhdGluZykge1xuICAgICAgICAgICAgICAgIC8vIElmIGFueSBzb3VyY2VidWZmZXIgaXMgdXBkYXRpbmcsIGRlZmVyIGVuZE9mU3RyZWFtIG9wZXJhdGlvblxuICAgICAgICAgICAgICAgIC8vIFNlZSBfb25Tb3VyY2VCdWZmZXJVcGRhdGVFbmQoKVxuICAgICAgICAgICAgICAgIHRoaXMuX2hhc1BlbmRpbmdFb3MgPSB0cnVlO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9oYXNQZW5kaW5nRW9zID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgLy8gTm90aWZ5IG1lZGlhIGRhdGEgbG9hZGluZyBjb21wbGV0ZVxuICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgaGVscGZ1bCBmb3IgY29ycmVjdGluZyB0b3RhbCBkdXJhdGlvbiB0byBtYXRjaCBsYXN0IG1lZGlhIHNlZ21lbnRcbiAgICAgICAgICAgICAgICAvLyBPdGhlcndpc2UgTWVkaWFFbGVtZW50J3MgZW5kZWQgZXZlbnQgbWF5IG5vdCBiZSB0cmlnZ2VyZWRcbiAgICAgICAgICAgICAgICBtcy5lbmRPZlN0cmVhbSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdnZXROZWFyZXN0S2V5ZnJhbWUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0TmVhcmVzdEtleWZyYW1lKGR0cykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2lkckxpc3QuZ2V0TGFzdFN5bmNQb2ludEJlZm9yZUR0cyhkdHMpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfbmVlZENsZWFudXBTb3VyY2VCdWZmZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX25lZWRDbGVhbnVwU291cmNlQnVmZmVyKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9jb25maWcuYXV0b0NsZWFudXBTb3VyY2VCdWZmZXIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBjdXJyZW50VGltZSA9IHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZTtcblxuICAgICAgICAgICAgZm9yICh2YXIgdHlwZSBpbiB0aGlzLl9zb3VyY2VCdWZmZXJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNiID0gdGhpcy5fc291cmNlQnVmZmVyc1t0eXBlXTtcbiAgICAgICAgICAgICAgICBpZiAoc2IpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJ1ZmZlcmVkID0gc2IuYnVmZmVyZWQ7XG4gICAgICAgICAgICAgICAgICAgIGlmIChidWZmZXJlZC5sZW5ndGggPj0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRUaW1lIC0gYnVmZmVyZWQuc3RhcnQoMCkgPj0gdGhpcy5fY29uZmlnLmF1dG9DbGVhbnVwTWF4QmFja3dhcmREdXJhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19kb0NsZWFudXBTb3VyY2VCdWZmZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2RvQ2xlYW51cFNvdXJjZUJ1ZmZlcigpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50VGltZSA9IHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZTtcblxuICAgICAgICAgICAgZm9yICh2YXIgdHlwZSBpbiB0aGlzLl9zb3VyY2VCdWZmZXJzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNiID0gdGhpcy5fc291cmNlQnVmZmVyc1t0eXBlXTtcbiAgICAgICAgICAgICAgICBpZiAoc2IpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJ1ZmZlcmVkID0gc2IuYnVmZmVyZWQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkb1JlbW92ZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYnVmZmVyZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IGJ1ZmZlcmVkLnN0YXJ0KGkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVuZCA9IGJ1ZmZlcmVkLmVuZChpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0IDw9IGN1cnJlbnRUaW1lICYmIGN1cnJlbnRUaW1lIDwgZW5kICsgMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHBhZGRpbmcgMyBzZWNvbmRzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRUaW1lIC0gc3RhcnQgPj0gdGhpcy5fY29uZmlnLmF1dG9DbGVhbnVwTWF4QmFja3dhcmREdXJhdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb1JlbW92ZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZW1vdmVFbmQgPSBjdXJyZW50VGltZSAtIHRoaXMuX2NvbmZpZy5hdXRvQ2xlYW51cE1pbkJhY2t3YXJkRHVyYXRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdSZW1vdmVSYW5nZXNbdHlwZV0ucHVzaCh7IHN0YXJ0OiBzdGFydCwgZW5kOiByZW1vdmVFbmQgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbmQgPCBjdXJyZW50VGltZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvUmVtb3ZlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nUmVtb3ZlUmFuZ2VzW3R5cGVdLnB1c2goeyBzdGFydDogc3RhcnQsIGVuZDogZW5kIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvUmVtb3ZlICYmICFzYi51cGRhdGluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZG9SZW1vdmVSYW5nZXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3VwZGF0ZU1lZGlhU291cmNlRHVyYXRpb24nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3VwZGF0ZU1lZGlhU291cmNlRHVyYXRpb24oKSB7XG4gICAgICAgICAgICB2YXIgc2IgPSB0aGlzLl9zb3VyY2VCdWZmZXJzO1xuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudC5yZWFkeVN0YXRlID09PSAwIHx8IHRoaXMuX21lZGlhU291cmNlLnJlYWR5U3RhdGUgIT09ICdvcGVuJykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChzYi52aWRlbyAmJiBzYi52aWRlby51cGRhdGluZyB8fCBzYi5hdWRpbyAmJiBzYi5hdWRpby51cGRhdGluZykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGN1cnJlbnQgPSB0aGlzLl9tZWRpYVNvdXJjZS5kdXJhdGlvbjtcbiAgICAgICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLl9wZW5kaW5nTWVkaWFEdXJhdGlvbjtcblxuICAgICAgICAgICAgaWYgKHRhcmdldCA+IDAgJiYgKGlzTmFOKGN1cnJlbnQpIHx8IHRhcmdldCA+IGN1cnJlbnQpKSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KHRoaXMuVEFHLCAnVXBkYXRlIE1lZGlhU291cmNlIGR1cmF0aW9uIGZyb20gJyArIGN1cnJlbnQgKyAnIHRvICcgKyB0YXJnZXQpO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhU291cmNlLmR1cmF0aW9uID0gdGFyZ2V0O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9yZXF1aXJlU2V0TWVkaWFEdXJhdGlvbiA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fcGVuZGluZ01lZGlhRHVyYXRpb24gPSAwO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfZG9SZW1vdmVSYW5nZXMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2RvUmVtb3ZlUmFuZ2VzKCkge1xuICAgICAgICAgICAgZm9yICh2YXIgdHlwZSBpbiB0aGlzLl9wZW5kaW5nUmVtb3ZlUmFuZ2VzKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9zb3VyY2VCdWZmZXJzW3R5cGVdIHx8IHRoaXMuX3NvdXJjZUJ1ZmZlcnNbdHlwZV0udXBkYXRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBzYiA9IHRoaXMuX3NvdXJjZUJ1ZmZlcnNbdHlwZV07XG4gICAgICAgICAgICAgICAgdmFyIHJhbmdlcyA9IHRoaXMuX3BlbmRpbmdSZW1vdmVSYW5nZXNbdHlwZV07XG4gICAgICAgICAgICAgICAgd2hpbGUgKHJhbmdlcy5sZW5ndGggJiYgIXNiLnVwZGF0aW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IHJhbmdlcy5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICBzYi5yZW1vdmUocmFuZ2Uuc3RhcnQsIHJhbmdlLmVuZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfZG9BcHBlbmRTZWdtZW50cycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZG9BcHBlbmRTZWdtZW50cygpIHtcbiAgICAgICAgICAgIHZhciBwZW5kaW5nU2VnbWVudHMgPSB0aGlzLl9wZW5kaW5nU2VnbWVudHM7XG5cbiAgICAgICAgICAgIGZvciAodmFyIHR5cGUgaW4gcGVuZGluZ1NlZ21lbnRzKSB7XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9zb3VyY2VCdWZmZXJzW3R5cGVdIHx8IHRoaXMuX3NvdXJjZUJ1ZmZlcnNbdHlwZV0udXBkYXRpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHBlbmRpbmdTZWdtZW50c1t0eXBlXS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZWdtZW50ID0gcGVuZGluZ1NlZ21lbnRzW3R5cGVdLnNoaWZ0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlZ21lbnQudGltZXN0YW1wT2Zmc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBGb3IgTVBFRyBhdWRpbyBzdHJlYW0gaW4gTVNFLCBpZiB1bmJ1ZmZlcmVkLXNlZWtpbmcgb2NjdXJyZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgZXhwbGljaXRseSBzZXQgdGltZXN0YW1wT2Zmc2V0IHRvIHRoZSBkZXNpcmVkIHBvaW50IGluIHRpbWVsaW5lIGZvciBtcGVnIFNvdXJjZUJ1ZmZlci5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50T2Zmc2V0ID0gdGhpcy5fc291cmNlQnVmZmVyc1t0eXBlXS50aW1lc3RhbXBPZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0T2Zmc2V0ID0gc2VnbWVudC50aW1lc3RhbXBPZmZzZXQgLyAxMDAwOyAvLyBpbiBzZWNvbmRzXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZWx0YSA9IE1hdGguYWJzKGN1cnJlbnRPZmZzZXQgLSB0YXJnZXRPZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRlbHRhID4gMC4xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGltZSBkZWx0YSA+IDEwMG1zXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KHRoaXMuVEFHLCAnVXBkYXRlIE1QRUcgYXVkaW8gdGltZXN0YW1wT2Zmc2V0IGZyb20gJyArIGN1cnJlbnRPZmZzZXQgKyAnIHRvICcgKyB0YXJnZXRPZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NvdXJjZUJ1ZmZlcnNbdHlwZV0udGltZXN0YW1wT2Zmc2V0ID0gdGFyZ2V0T2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZGVsZXRlIHNlZ21lbnQudGltZXN0YW1wT2Zmc2V0O1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFzZWdtZW50LmRhdGEgfHwgc2VnbWVudC5kYXRhLmJ5dGVMZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIElnbm9yZSBlbXB0eSBidWZmZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NvdXJjZUJ1ZmZlcnNbdHlwZV0uYXBwZW5kQnVmZmVyKHNlZ21lbnQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pc0J1ZmZlckZ1bGwgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAndmlkZW8nICYmIHNlZ21lbnQuaGFzT3duUHJvcGVydHkoJ2luZm8nKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2lkckxpc3QuYXBwZW5kQXJyYXkoc2VnbWVudC5pbmZvLnN5bmNQb2ludHMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1NlZ21lbnRzW3R5cGVdLnVuc2hpZnQoc2VnbWVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXJyb3IuY29kZSA9PT0gMjIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBRdW90YUV4Y2VlZGVkRXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvKiBOb3RpY2UgdGhhdCBGaXJlRm94IG1heSBub3QgdGhyb3cgUXVvdGFFeGNlZWRlZEVycm9yIGlmIFNvdXJjZUJ1ZmZlciBpcyBmdWxsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDdXJyZW50bHkgd2UgY2FuIG9ubHkgZG8gbGF6eS1sb2FkIHRvIGF2b2lkIFNvdXJjZUJ1ZmZlciBiZWNvbWUgc2NhdHRlcmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU291cmNlQnVmZmVyIGV2aWN0aW9uIHBvbGljeSBtYXkgYmUgY2hhbmdlZCBpbiBmdXR1cmUgdmVyc2lvbiBvZiBGaXJlRm94LlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFJlbGF0ZWQgaXNzdWVzOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICogaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTI3OTg4NVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICogaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTI4MDAyM1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZXBvcnQgYnVmZmVyIGZ1bGwsIGFib3J0IG5ldHdvcmsgSU9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2lzQnVmZmVyRnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX21zZUV2ZW50czIuZGVmYXVsdC5CVUZGRVJfRlVMTCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2lzQnVmZmVyRnVsbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZSh0aGlzLlRBRywgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF9tc2VFdmVudHMyLmRlZmF1bHQuRVJST1IsIHsgY29kZTogZXJyb3IuY29kZSwgbXNnOiBlcnJvci5tZXNzYWdlIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Tb3VyY2VPcGVuJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblNvdXJjZU9wZW4oKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYodGhpcy5UQUcsICdNZWRpYVNvdXJjZSBvblNvdXJjZU9wZW4nKTtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhU291cmNlLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3NvdXJjZW9wZW4nLCB0aGlzLmUub25Tb3VyY2VPcGVuKTtcbiAgICAgICAgICAgIC8vIGRlZmVycmVkIHNvdXJjZWJ1ZmZlciBjcmVhdGlvbiAvIGluaXRpYWxpemF0aW9uXG4gICAgICAgICAgICBpZiAodGhpcy5fcGVuZGluZ1NvdXJjZUJ1ZmZlckluaXQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBwZW5kaW5ncyA9IHRoaXMuX3BlbmRpbmdTb3VyY2VCdWZmZXJJbml0O1xuICAgICAgICAgICAgICAgIHdoaWxlIChwZW5kaW5ncy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNlZ21lbnQgPSBwZW5kaW5ncy5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcGVuZEluaXRTZWdtZW50KHNlZ21lbnQsIHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIHRoZXJlIG1heSBiZSBzb21lIHBlbmRpbmcgbWVkaWEgc2VnbWVudHMsIGFwcGVuZCB0aGVtXG4gICAgICAgICAgICBpZiAodGhpcy5faGFzUGVuZGluZ1NlZ21lbnRzKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kb0FwcGVuZFNlZ21lbnRzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX21zZUV2ZW50czIuZGVmYXVsdC5TT1VSQ0VfT1BFTik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblNvdXJjZUVuZGVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblNvdXJjZUVuZGVkKCkge1xuICAgICAgICAgICAgLy8gZmlyZWQgb24gZW5kT2ZTdHJlYW1cbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudih0aGlzLlRBRywgJ01lZGlhU291cmNlIG9uU291cmNlRW5kZWQnKTtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfbXNlRXZlbnRzMi5kZWZhdWx0LlNPVVJDRV9FTkQsICdNZWRpYVNvdXJjZSBvblNvdXJjZUVuZGVkJyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblNvdXJjZUNsb3NlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblNvdXJjZUNsb3NlKCkge1xuICAgICAgICAgICAgLy8gZmlyZWQgb24gZGV0YWNoaW5nIGZyb20gbWVkaWEgZWxlbWVudFxuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KHRoaXMuVEFHLCAnTWVkaWFTb3VyY2Ugb25Tb3VyY2VDbG9zZScpO1xuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhU291cmNlICYmIHRoaXMuZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFTb3VyY2UucmVtb3ZlRXZlbnRMaXN0ZW5lcignc291cmNlb3BlbicsIHRoaXMuZS5vblNvdXJjZU9wZW4pO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhU291cmNlLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3NvdXJjZWVuZGVkJywgdGhpcy5lLm9uU291cmNlRW5kZWQpO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhU291cmNlLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3NvdXJjZWNsb3NlJywgdGhpcy5lLm9uU291cmNlQ2xvc2UpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfaGFzUGVuZGluZ1NlZ21lbnRzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9oYXNQZW5kaW5nU2VnbWVudHMoKSB7XG4gICAgICAgICAgICB2YXIgcHMgPSB0aGlzLl9wZW5kaW5nU2VnbWVudHM7XG4gICAgICAgICAgICByZXR1cm4gcHMudmlkZW8ubGVuZ3RoID4gMCB8fCBwcy5hdWRpby5sZW5ndGggPiAwO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfaGFzUGVuZGluZ1JlbW92ZVJhbmdlcycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfaGFzUGVuZGluZ1JlbW92ZVJhbmdlcygpIHtcbiAgICAgICAgICAgIHZhciBwcnIgPSB0aGlzLl9wZW5kaW5nUmVtb3ZlUmFuZ2VzO1xuICAgICAgICAgICAgcmV0dXJuIHByci52aWRlby5sZW5ndGggPiAwIHx8IHByci5hdWRpby5sZW5ndGggPiAwO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Tb3VyY2VCdWZmZXJVcGRhdGVFbmQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uU291cmNlQnVmZmVyVXBkYXRlRW5kKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3JlcXVpcmVTZXRNZWRpYUR1cmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdXBkYXRlTWVkaWFTb3VyY2VEdXJhdGlvbigpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9oYXNQZW5kaW5nUmVtb3ZlUmFuZ2VzKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kb1JlbW92ZVJhbmdlcygpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9oYXNQZW5kaW5nU2VnbWVudHMoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2RvQXBwZW5kU2VnbWVudHMoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5faGFzUGVuZGluZ0Vvcykge1xuICAgICAgICAgICAgICAgIHRoaXMuZW5kT2ZTdHJlYW0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfbXNlRXZlbnRzMi5kZWZhdWx0LlVQREFURV9FTkQpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Tb3VyY2VCdWZmZXJFcnJvcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Tb3VyY2VCdWZmZXJFcnJvcihlKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmUodGhpcy5UQUcsICdTb3VyY2VCdWZmZXIgRXJyb3I6ICcgKyBlKTtcbiAgICAgICAgICAgIC8vIHRoaXMgZXJyb3IgbWlnaHQgbm90IGFsd2F5cyBiZSBmYXRhbCwganVzdCBpZ25vcmUgaXRcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBNU0VDb250cm9sbGVyO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBNU0VDb250cm9sbGVyO1xuXG59LHtcIi4uL3V0aWxzL2Jyb3dzZXIuanNcIjozOSxcIi4uL3V0aWxzL2V4Y2VwdGlvbi5qc1wiOjQwLFwiLi4vdXRpbHMvbG9nZ2VyLmpzXCI6NDEsXCIuL21lZGlhLXNlZ21lbnQtaW5mby5qc1wiOjgsXCIuL21zZS1ldmVudHMuanNcIjoxMCxcImV2ZW50c1wiOjJ9XSwxMDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG52YXIgTVNFRXZlbnRzID0ge1xuICBFUlJPUjogJ2Vycm9yJyxcbiAgU09VUkNFX09QRU46ICdzb3VyY2Vfb3BlbicsXG4gIFVQREFURV9FTkQ6ICd1cGRhdGVfZW5kJyxcbiAgQlVGRkVSX0ZVTEw6ICdidWZmZXJfZnVsbCcsXG4gIFNPVVJDRV9FTkQ6ICdzb3VyY2VfZW5kJ1xufTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gTVNFRXZlbnRzO1xuXG59LHt9XSwxMTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfZXZlbnRzID0gX2RlcmVxXygnZXZlbnRzJyk7XG5cbnZhciBfZXZlbnRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V2ZW50cyk7XG5cbnZhciBfbG9nZ2VyID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nZ2VyLmpzJyk7XG5cbnZhciBfbG9nZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dlcik7XG5cbnZhciBfbG9nZ2luZ0NvbnRyb2wgPSBfZGVyZXFfKCcuLi91dGlscy9sb2dnaW5nLWNvbnRyb2wuanMnKTtcblxudmFyIF9sb2dnaW5nQ29udHJvbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnaW5nQ29udHJvbCk7XG5cbnZhciBfdHJhbnNtdXhpbmdDb250cm9sbGVyID0gX2RlcmVxXygnLi90cmFuc211eGluZy1jb250cm9sbGVyLmpzJyk7XG5cbnZhciBfdHJhbnNtdXhpbmdDb250cm9sbGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RyYW5zbXV4aW5nQ29udHJvbGxlcik7XG5cbnZhciBfdHJhbnNtdXhpbmdFdmVudHMgPSBfZGVyZXFfKCcuL3RyYW5zbXV4aW5nLWV2ZW50cy5qcycpO1xuXG52YXIgX3RyYW5zbXV4aW5nRXZlbnRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RyYW5zbXV4aW5nRXZlbnRzKTtcblxudmFyIF90cmFuc211eGluZ1dvcmtlciA9IF9kZXJlcV8oJy4vdHJhbnNtdXhpbmctd29ya2VyLmpzJyk7XG5cbnZhciBfdHJhbnNtdXhpbmdXb3JrZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHJhbnNtdXhpbmdXb3JrZXIpO1xuXG52YXIgX21lZGlhSW5mbyA9IF9kZXJlcV8oJy4vbWVkaWEtaW5mby5qcycpO1xuXG52YXIgX21lZGlhSW5mbzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tZWRpYUluZm8pO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgVHJhbnNtdXhlciA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBUcmFuc211eGVyKG1lZGlhRGF0YVNvdXJjZSwgY29uZmlnKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUcmFuc211eGVyKTtcblxuICAgICAgICB0aGlzLlRBRyA9ICdUcmFuc211eGVyJztcbiAgICAgICAgdGhpcy5fZW1pdHRlciA9IG5ldyBfZXZlbnRzMi5kZWZhdWx0KCk7XG5cbiAgICAgICAgaWYgKGNvbmZpZy5lbmFibGVXb3JrZXIgJiYgdHlwZW9mIFdvcmtlciAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIHdvcmsgPSBfZGVyZXFfKCd3ZWJ3b3JraWZ5Jyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyID0gd29yayhfdHJhbnNtdXhpbmdXb3JrZXIyLmRlZmF1bHQpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlckRlc3Ryb3lpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXIuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMuX29uV29ya2VyTWVzc2FnZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXIucG9zdE1lc3NhZ2UoeyBjbWQ6ICdpbml0JywgcGFyYW06IFttZWRpYURhdGFTb3VyY2UsIGNvbmZpZ10gfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5lID0ge1xuICAgICAgICAgICAgICAgICAgICBvbkxvZ2dpbmdDb25maWdDaGFuZ2VkOiB0aGlzLl9vbkxvZ2dpbmdDb25maWdDaGFuZ2VkLmJpbmQodGhpcylcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIF9sb2dnaW5nQ29udHJvbDIuZGVmYXVsdC5yZWdpc3Rlckxpc3RlbmVyKHRoaXMuZS5vbkxvZ2dpbmdDb25maWdDaGFuZ2VkKTtcbiAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXIucG9zdE1lc3NhZ2UoeyBjbWQ6ICdsb2dnaW5nX2NvbmZpZycsIHBhcmFtOiBfbG9nZ2luZ0NvbnRyb2wyLmRlZmF1bHQuZ2V0Q29uZmlnKCkgfSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZSh0aGlzLlRBRywgJ0Vycm9yIHdoaWxlIGluaXRpYWxpemUgdHJhbnNtdXhpbmcgd29ya2VyLCBmYWxsYmFjayB0byBpbmxpbmUgdHJhbnNtdXhpbmcnKTtcbiAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xsZXIgPSBuZXcgX3RyYW5zbXV4aW5nQ29udHJvbGxlcjIuZGVmYXVsdChtZWRpYURhdGFTb3VyY2UsIGNvbmZpZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9jb250cm9sbGVyID0gbmV3IF90cmFuc211eGluZ0NvbnRyb2xsZXIyLmRlZmF1bHQobWVkaWFEYXRhU291cmNlLCBjb25maWcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX2NvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgIHZhciBjdGwgPSB0aGlzLl9jb250cm9sbGVyO1xuICAgICAgICAgICAgY3RsLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5JT19FUlJPUiwgdGhpcy5fb25JT0Vycm9yLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgY3RsLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5ERU1VWF9FUlJPUiwgdGhpcy5fb25EZW11eEVycm9yLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgY3RsLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5JTklUX1NFR01FTlQsIHRoaXMuX29uSW5pdFNlZ21lbnQuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICBjdGwub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FRElBX1NFR01FTlQsIHRoaXMuX29uTWVkaWFTZWdtZW50LmJpbmQodGhpcykpO1xuICAgICAgICAgICAgY3RsLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5MT0FESU5HX0NPTVBMRVRFLCB0aGlzLl9vbkxvYWRpbmdDb21wbGV0ZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGN0bC5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuUkVDT1ZFUkVEX0VBUkxZX0VPRiwgdGhpcy5fb25SZWNvdmVyZWRFYXJseUVvZi5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGN0bC5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVESUFfSU5GTywgdGhpcy5fb25NZWRpYUluZm8uYmluZCh0aGlzKSk7XG4gICAgICAgICAgICBjdGwub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FVEFEQVRBX0FSUklWRUQsIHRoaXMuX29uTWV0YURhdGFBcnJpdmVkLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgY3RsLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TQ1JJUFREQVRBX0FSUklWRUQsIHRoaXMuX29uU2NyaXB0RGF0YUFycml2ZWQuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICBjdGwub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNUQVRJU1RJQ1NfSU5GTywgdGhpcy5fb25TdGF0aXN0aWNzSW5mby5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgIGN0bC5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuUkVDT01NRU5EX1NFRUtQT0lOVCwgdGhpcy5fb25SZWNvbW1lbmRTZWVrcG9pbnQuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICBjdGwub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNUUkVBTV9USU1FLCB0aGlzLl9vblN0cmVhbVRpbWUuYmluZCh0aGlzKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoVHJhbnNtdXhlciwgW3tcbiAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3dvcmtlcikge1xuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fd29ya2VyRGVzdHJveWluZykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXJEZXN0cm95aW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyLnBvc3RNZXNzYWdlKHsgY21kOiAnZGVzdHJveScgfSk7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnaW5nQ29udHJvbDIuZGVmYXVsdC5yZW1vdmVMaXN0ZW5lcih0aGlzLmUub25Mb2dnaW5nQ29uZmlnQ2hhbmdlZCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb250cm9sbGVyLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb250cm9sbGVyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb24nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb24oZXZlbnQsIGxpc3RlbmVyKSB7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmFkZExpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29mZicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvZmYoZXZlbnQsIGxpc3RlbmVyKSB7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLnJlbW92ZUxpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2hhc1dvcmtlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoYXNXb3JrZXIoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fd29ya2VyICE9IG51bGw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29wZW4nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb3BlbigpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl93b3JrZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXIucG9zdE1lc3NhZ2UoeyBjbWQ6ICdzdGFydCcgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xsZXIuc3RhcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnY2xvc2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gY2xvc2UoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fd29ya2VyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyLnBvc3RNZXNzYWdlKHsgY21kOiAnc3RvcCcgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xsZXIuc3RvcCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzZWVrJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNlZWsobWlsbGlzZWNvbmRzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fd29ya2VyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyLnBvc3RNZXNzYWdlKHsgY21kOiAnc2VlaycsIHBhcmFtOiBtaWxsaXNlY29uZHMgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xsZXIuc2VlayhtaWxsaXNlY29uZHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwYXVzZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl93b3JrZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXIucG9zdE1lc3NhZ2UoeyBjbWQ6ICdwYXVzZScgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRyb2xsZXIucGF1c2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVzdW1lJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlc3VtZSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl93b3JrZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXIucG9zdE1lc3NhZ2UoeyBjbWQ6ICdyZXN1bWUnIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jb250cm9sbGVyLnJlc3VtZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Jbml0U2VnbWVudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Jbml0U2VnbWVudCh0eXBlLCBpbml0U2VnbWVudCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgICAgICAgLy8gZG8gYXN5bmMgaW52b2tlXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5JTklUX1NFR01FTlQsIHR5cGUsIGluaXRTZWdtZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25NZWRpYVNlZ21lbnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uTWVkaWFTZWdtZW50KHR5cGUsIG1lZGlhU2VnbWVudCkge1xuICAgICAgICAgICAgdmFyIF90aGlzMiA9IHRoaXM7XG5cbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzMi5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRURJQV9TRUdNRU5ULCB0eXBlLCBtZWRpYVNlZ21lbnQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbkxvYWRpbmdDb21wbGV0ZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Mb2FkaW5nQ29tcGxldGUoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMzID0gdGhpcztcblxuICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMzLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LkxPQURJTkdfQ09NUExFVEUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblJlY292ZXJlZEVhcmx5RW9mJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlY292ZXJlZEVhcmx5RW9mKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzNCA9IHRoaXM7XG5cbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzNC5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5SRUNPVkVSRURfRUFSTFlfRU9GKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25NZWRpYUluZm8nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uTWVkaWFJbmZvKG1lZGlhSW5mbykge1xuICAgICAgICAgICAgdmFyIF90aGlzNSA9IHRoaXM7XG5cbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzNS5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRURJQV9JTkZPLCBtZWRpYUluZm8pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbk1ldGFEYXRhQXJyaXZlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25NZXRhRGF0YUFycml2ZWQobWV0YWRhdGEpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczYgPSB0aGlzO1xuXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpczYuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVUQURBVEFfQVJSSVZFRCwgbWV0YWRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblNjcmlwdERhdGFBcnJpdmVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblNjcmlwdERhdGFBcnJpdmVkKGRhdGEpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczcgPSB0aGlzO1xuXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpczcuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU0NSSVBUREFUQV9BUlJJVkVELCBkYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25TdGF0aXN0aWNzSW5mbycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25TdGF0aXN0aWNzSW5mbyhzdGF0aXN0aWNzSW5mbykge1xuICAgICAgICAgICAgdmFyIF90aGlzOCA9IHRoaXM7XG5cbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzOC5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TVEFUSVNUSUNTX0lORk8sIHN0YXRpc3RpY3NJbmZvKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25JT0Vycm9yJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbklPRXJyb3IodHlwZSwgaW5mbykge1xuICAgICAgICAgICAgdmFyIF90aGlzOSA9IHRoaXM7XG5cbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzOS5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5JT19FUlJPUiwgdHlwZSwgaW5mbyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uRGVtdXhFcnJvcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25EZW11eEVycm9yKHR5cGUsIGluZm8pIHtcbiAgICAgICAgICAgIHZhciBfdGhpczEwID0gdGhpcztcblxuICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMxMC5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5ERU1VWF9FUlJPUiwgdHlwZSwgaW5mbyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uUmVjb21tZW5kU2Vla3BvaW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlY29tbWVuZFNlZWtwb2ludChtaWxsaXNlY29uZHMpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczExID0gdGhpcztcblxuICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMxMS5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5SRUNPTU1FTkRfU0VFS1BPSU5ULCBtaWxsaXNlY29uZHMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblN0cmVhbVRpbWUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uU3RyZWFtVGltZSh0aW1lKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMxMiA9IHRoaXM7XG5cbiAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzMTIuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU1RSRUFNX1RJTUUsIHRpbWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbkxvZ2dpbmdDb25maWdDaGFuZ2VkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkxvZ2dpbmdDb25maWdDaGFuZ2VkKGNvbmZpZykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3dvcmtlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlci5wb3N0TWVzc2FnZSh7IGNtZDogJ2xvZ2dpbmdfY29uZmlnJywgcGFyYW06IGNvbmZpZyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uV29ya2VyTWVzc2FnZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Xb3JrZXJNZXNzYWdlKGUpIHtcbiAgICAgICAgICAgIHZhciBtZXNzYWdlID0gZS5kYXRhO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBtZXNzYWdlLmRhdGE7XG5cbiAgICAgICAgICAgIGlmIChtZXNzYWdlLm1zZyA9PT0gJ2Rlc3Ryb3llZCcgfHwgdGhpcy5fd29ya2VyRGVzdHJveWluZykge1xuICAgICAgICAgICAgICAgIHRoaXMuX3dvcmtlckRlc3Ryb3lpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLl93b3JrZXIudGVybWluYXRlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fd29ya2VyID0gbnVsbDtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHN3aXRjaCAobWVzc2FnZS5tc2cpIHtcbiAgICAgICAgICAgICAgICBjYXNlIF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5JTklUX1NFR01FTlQ6XG4gICAgICAgICAgICAgICAgY2FzZSBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVESUFfU0VHTUVOVDpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KG1lc3NhZ2UubXNnLCBkYXRhLnR5cGUsIGRhdGEuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LkxPQURJTkdfQ09NUExFVEU6XG4gICAgICAgICAgICAgICAgY2FzZSBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuUkVDT1ZFUkVEX0VBUkxZX0VPRjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KG1lc3NhZ2UubXNnKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVESUFfSU5GTzpcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKGRhdGEsIF9tZWRpYUluZm8yLmRlZmF1bHQucHJvdG90eXBlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KG1lc3NhZ2UubXNnLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVUQURBVEFfQVJSSVZFRDpcbiAgICAgICAgICAgICAgICBjYXNlIF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TQ1JJUFREQVRBX0FSUklWRUQ6XG4gICAgICAgICAgICAgICAgY2FzZSBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU1RBVElTVElDU19JTkZPOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQobWVzc2FnZS5tc2csIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5JT19FUlJPUjpcbiAgICAgICAgICAgICAgICBjYXNlIF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5ERU1VWF9FUlJPUjpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KG1lc3NhZ2UubXNnLCBkYXRhLnR5cGUsIGRhdGEuaW5mbyk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlJFQ09NTUVORF9TRUVLUE9JTlQ6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChtZXNzYWdlLm1zZywgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2xvZ2NhdF9jYWxsYmFjayc6XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZW1pdHRlci5lbWl0KCdsb2cnLCBkYXRhLnR5cGUsIGRhdGEubG9nY2F0KTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gVHJhbnNtdXhlcjtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gVHJhbnNtdXhlcjtcblxufSx7XCIuLi91dGlscy9sb2dnZXIuanNcIjo0MSxcIi4uL3V0aWxzL2xvZ2dpbmctY29udHJvbC5qc1wiOjQyLFwiLi9tZWRpYS1pbmZvLmpzXCI6NyxcIi4vdHJhbnNtdXhpbmctY29udHJvbGxlci5qc1wiOjEyLFwiLi90cmFuc211eGluZy1ldmVudHMuanNcIjoxMyxcIi4vdHJhbnNtdXhpbmctd29ya2VyLmpzXCI6MTQsXCJldmVudHNcIjoyLFwid2Vid29ya2lmeVwiOjR9XSwxMjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfZXZlbnRzID0gX2RlcmVxXygnZXZlbnRzJyk7XG5cbnZhciBfZXZlbnRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V2ZW50cyk7XG5cbnZhciBfbG9nZ2VyID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nZ2VyLmpzJyk7XG5cbnZhciBfbG9nZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dlcik7XG5cbnZhciBfYnJvd3NlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2Jyb3dzZXIuanMnKTtcblxudmFyIF9icm93c2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2Jyb3dzZXIpO1xuXG52YXIgX21lZGlhSW5mbyA9IF9kZXJlcV8oJy4vbWVkaWEtaW5mby5qcycpO1xuXG52YXIgX21lZGlhSW5mbzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tZWRpYUluZm8pO1xuXG52YXIgX2ZsdkRlbXV4ZXIgPSBfZGVyZXFfKCcuLi9kZW11eC9mbHYtZGVtdXhlci5qcycpO1xuXG52YXIgX2ZsdkRlbXV4ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmx2RGVtdXhlcik7XG5cbnZhciBfbXA0UmVtdXhlciA9IF9kZXJlcV8oJy4uL3JlbXV4L21wNC1yZW11eGVyLmpzJyk7XG5cbnZhciBfbXA0UmVtdXhlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tcDRSZW11eGVyKTtcblxudmFyIF9kZW11eEVycm9ycyA9IF9kZXJlcV8oJy4uL2RlbXV4L2RlbXV4LWVycm9ycy5qcycpO1xuXG52YXIgX2RlbXV4RXJyb3JzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RlbXV4RXJyb3JzKTtcblxudmFyIF9pb0NvbnRyb2xsZXIgPSBfZGVyZXFfKCcuLi9pby9pby1jb250cm9sbGVyLmpzJyk7XG5cbnZhciBfaW9Db250cm9sbGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2lvQ29udHJvbGxlcik7XG5cbnZhciBfdHJhbnNtdXhpbmdFdmVudHMgPSBfZGVyZXFfKCcuL3RyYW5zbXV4aW5nLWV2ZW50cy5qcycpO1xuXG52YXIgX3RyYW5zbXV4aW5nRXZlbnRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RyYW5zbXV4aW5nRXZlbnRzKTtcblxudmFyIF9sb2FkZXIgPSBfZGVyZXFfKCcuLi9pby9sb2FkZXIuanMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLy8gVHJhbnNtdXhpbmcgKElPLCBEZW11eGluZywgUmVtdXhpbmcpIGNvbnRyb2xsZXIsIHdpdGggbXVsdGlwYXJ0IHN1cHBvcnRcbnZhciBUcmFuc211eGluZ0NvbnRyb2xsZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gVHJhbnNtdXhpbmdDb250cm9sbGVyKG1lZGlhRGF0YVNvdXJjZSwgY29uZmlnKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUcmFuc211eGluZ0NvbnRyb2xsZXIpO1xuXG4gICAgICAgIHRoaXMuVEFHID0gJ1RyYW5zbXV4aW5nQ29udHJvbGxlcic7XG4gICAgICAgIHRoaXMuX2VtaXR0ZXIgPSBuZXcgX2V2ZW50czIuZGVmYXVsdCgpO1xuXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcblxuICAgICAgICAvLyB0cmVhdCBzaW5nbGUgcGFydCBtZWRpYSBhcyBtdWx0aXBhcnQgbWVkaWEsIHdoaWNoIGhhcyBvbmx5IG9uZSBzZWdtZW50XG4gICAgICAgIGlmICghbWVkaWFEYXRhU291cmNlLnNlZ21lbnRzKSB7XG4gICAgICAgICAgICBtZWRpYURhdGFTb3VyY2Uuc2VnbWVudHMgPSBbe1xuICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBtZWRpYURhdGFTb3VyY2UuZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgZmlsZXNpemU6IG1lZGlhRGF0YVNvdXJjZS5maWxlc2l6ZSxcbiAgICAgICAgICAgICAgICB1cmw6IG1lZGlhRGF0YVNvdXJjZS51cmxcbiAgICAgICAgICAgIH1dO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZmlsbCBpbiBkZWZhdWx0IElPIHBhcmFtcyBpZiBub3QgZXhpc3RzXG4gICAgICAgIGlmICh0eXBlb2YgbWVkaWFEYXRhU291cmNlLmNvcnMgIT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgbWVkaWFEYXRhU291cmNlLmNvcnMgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2YgbWVkaWFEYXRhU291cmNlLndpdGhDcmVkZW50aWFscyAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICBtZWRpYURhdGFTb3VyY2Uud2l0aENyZWRlbnRpYWxzID0gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9tZWRpYURhdGFTb3VyY2UgPSBtZWRpYURhdGFTb3VyY2U7XG4gICAgICAgIHRoaXMuX2N1cnJlbnRTZWdtZW50SW5kZXggPSAwO1xuICAgICAgICB2YXIgdG90YWxEdXJhdGlvbiA9IDA7XG5cbiAgICAgICAgdGhpcy5fbWVkaWFEYXRhU291cmNlLnNlZ21lbnRzLmZvckVhY2goZnVuY3Rpb24gKHNlZ21lbnQpIHtcbiAgICAgICAgICAgIC8vIHRpbWVzdGFtcEJhc2UgZm9yIGVhY2ggc2VnbWVudCwgYW5kIGNhbGN1bGF0ZSB0b3RhbCBkdXJhdGlvblxuICAgICAgICAgICAgc2VnbWVudC50aW1lc3RhbXBCYXNlID0gdG90YWxEdXJhdGlvbjtcbiAgICAgICAgICAgIHRvdGFsRHVyYXRpb24gKz0gc2VnbWVudC5kdXJhdGlvbjtcbiAgICAgICAgICAgIC8vIHBhcmFtcyBuZWVkZWQgYnkgSU9Db250cm9sbGVyXG4gICAgICAgICAgICBzZWdtZW50LmNvcnMgPSBtZWRpYURhdGFTb3VyY2UuY29ycztcbiAgICAgICAgICAgIHNlZ21lbnQud2l0aENyZWRlbnRpYWxzID0gbWVkaWFEYXRhU291cmNlLndpdGhDcmVkZW50aWFscztcbiAgICAgICAgICAgIC8vIHJlZmVycmVyIHBvbGljeSBjb250cm9sLCBpZiBleGlzdFxuICAgICAgICAgICAgaWYgKGNvbmZpZy5yZWZlcnJlclBvbGljeSkge1xuICAgICAgICAgICAgICAgIHNlZ21lbnQucmVmZXJyZXJQb2xpY3kgPSBjb25maWcucmVmZXJyZXJQb2xpY3k7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghaXNOYU4odG90YWxEdXJhdGlvbikgJiYgdGhpcy5fbWVkaWFEYXRhU291cmNlLmR1cmF0aW9uICE9PSB0b3RhbER1cmF0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYURhdGFTb3VyY2UuZHVyYXRpb24gPSB0b3RhbER1cmF0aW9uO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fbWVkaWFJbmZvID0gbnVsbDtcbiAgICAgICAgdGhpcy5fZGVtdXhlciA9IG51bGw7XG4gICAgICAgIHRoaXMuX3JlbXV4ZXIgPSBudWxsO1xuICAgICAgICB0aGlzLl9pb2N0bCA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5fcGVuZGluZ1NlZWtUaW1lID0gbnVsbDtcbiAgICAgICAgdGhpcy5fcGVuZGluZ1Jlc29sdmVTZWVrUG9pbnQgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuX3N0YXRpc3RpY3NSZXBvcnRlciA9IG51bGw7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFRyYW5zbXV4aW5nQ29udHJvbGxlciwgW3tcbiAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhRGF0YVNvdXJjZSA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGF0aXN0aWNzUmVwb3J0ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXNhYmxlU3RhdGlzdGljc1JlcG9ydGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5faW9jdGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pb2N0bC5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5faW9jdGwgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX2RlbXV4ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9yZW11eGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVtdXhlci5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVtdXhlciA9IG51bGw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb24nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb24oZXZlbnQsIGxpc3RlbmVyKSB7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmFkZExpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29mZicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvZmYoZXZlbnQsIGxpc3RlbmVyKSB7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLnJlbW92ZUxpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3N0YXJ0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN0YXJ0KCkge1xuICAgICAgICAgICAgdGhpcy5fbG9hZFNlZ21lbnQoMCk7XG4gICAgICAgICAgICB0aGlzLl9lbmFibGVTdGF0aXN0aWNzUmVwb3J0ZXIoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2xvYWRTZWdtZW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9sb2FkU2VnbWVudChzZWdtZW50SW5kZXgsIG9wdGlvbmFsRnJvbSkge1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFNlZ21lbnRJbmRleCA9IHNlZ21lbnRJbmRleDtcbiAgICAgICAgICAgIHZhciBkYXRhU291cmNlID0gdGhpcy5fbWVkaWFEYXRhU291cmNlLnNlZ21lbnRzW3NlZ21lbnRJbmRleF07XG5cbiAgICAgICAgICAgIHZhciBpb2N0bCA9IHRoaXMuX2lvY3RsID0gbmV3IF9pb0NvbnRyb2xsZXIyLmRlZmF1bHQoZGF0YVNvdXJjZSwgdGhpcy5fY29uZmlnLCBzZWdtZW50SW5kZXgpO1xuICAgICAgICAgICAgaW9jdGwub25FcnJvciA9IHRoaXMuX29uSU9FeGNlcHRpb24uYmluZCh0aGlzKTtcbiAgICAgICAgICAgIGlvY3RsLm9uU2Vla2VkID0gdGhpcy5fb25JT1NlZWtlZC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgaW9jdGwub25Db21wbGV0ZSA9IHRoaXMuX29uSU9Db21wbGV0ZS5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgaW9jdGwub25SZWRpcmVjdCA9IHRoaXMuX29uSU9SZWRpcmVjdC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgaW9jdGwub25SZWNvdmVyZWRFYXJseUVvZiA9IHRoaXMuX29uSU9SZWNvdmVyZWRFYXJseUVvZi5iaW5kKHRoaXMpO1xuXG4gICAgICAgICAgICBpZiAob3B0aW9uYWxGcm9tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlci5iaW5kRGF0YVNvdXJjZSh0aGlzLl9pb2N0bCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlvY3RsLm9uRGF0YUFycml2YWwgPSB0aGlzLl9vbkluaXRDaHVua0Fycml2YWwuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaW9jdGwub3BlbihvcHRpb25hbEZyb20pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzdG9wJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgICAgICAgICB0aGlzLl9pbnRlcm5hbEFib3J0KCk7XG4gICAgICAgICAgICB0aGlzLl9kaXNhYmxlU3RhdGlzdGljc1JlcG9ydGVyKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19pbnRlcm5hbEFib3J0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9pbnRlcm5hbEFib3J0KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2lvY3RsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faW9jdGwuZGVzdHJveSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2lvY3RsID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncGF1c2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgICAgICAgICAvLyB0YWtlIGEgcmVzdFxuICAgICAgICAgICAgaWYgKHRoaXMuX2lvY3RsICYmIHRoaXMuX2lvY3RsLmlzV29ya2luZygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5faW9jdGwucGF1c2UoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXNhYmxlU3RhdGlzdGljc1JlcG9ydGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3Jlc3VtZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZXN1bWUoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5faW9jdGwgJiYgdGhpcy5faW9jdGwuaXNQYXVzZWQoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2lvY3RsLnJlc3VtZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2VuYWJsZVN0YXRpc3RpY3NSZXBvcnRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzZWVrJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNlZWsobWlsbGlzZWNvbmRzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFJbmZvID09IG51bGwgfHwgIXRoaXMuX21lZGlhSW5mby5pc1NlZWthYmxlKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciB0YXJnZXRTZWdtZW50SW5kZXggPSB0aGlzLl9zZWFyY2hTZWdtZW50SW5kZXhDb250YWlucyhtaWxsaXNlY29uZHMpO1xuXG4gICAgICAgICAgICBpZiAodGFyZ2V0U2VnbWVudEluZGV4ID09PSB0aGlzLl9jdXJyZW50U2VnbWVudEluZGV4KSB7XG4gICAgICAgICAgICAgICAgLy8gaW50cmEtc2VnbWVudCBzZWVraW5nXG4gICAgICAgICAgICAgICAgdmFyIHNlZ21lbnRJbmZvID0gdGhpcy5fbWVkaWFJbmZvLnNlZ21lbnRzW3RhcmdldFNlZ21lbnRJbmRleF07XG5cbiAgICAgICAgICAgICAgICBpZiAoc2VnbWVudEluZm8gPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGN1cnJlbnQgc2VnbWVudCBsb2FkaW5nIHN0YXJ0ZWQsIGJ1dCBtZWRpYWluZm8gaGFzbid0IHJlY2VpdmVkIHlldFxuICAgICAgICAgICAgICAgICAgICAvLyB3YWl0IGZvciB0aGUgbWV0YWRhdGEgbG9hZGVkLCB0aGVuIHNlZWsgdG8gZXhwZWN0ZWQgcG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1NlZWtUaW1lID0gbWlsbGlzZWNvbmRzO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBrZXlmcmFtZSA9IHNlZ21lbnRJbmZvLmdldE5lYXJlc3RLZXlmcmFtZShtaWxsaXNlY29uZHMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW11eGVyLnNlZWsoa2V5ZnJhbWUubWlsbGlzZWNvbmRzKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faW9jdGwuc2VlayhrZXlmcmFtZS5maWxlcG9zaXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAvLyBXaWxsIGJlIHJlc29sdmVkIGluIF9vblJlbXV4ZXJNZWRpYVNlZ21lbnRBcnJpdmFsKClcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1Jlc29sdmVTZWVrUG9pbnQgPSBrZXlmcmFtZS5taWxsaXNlY29uZHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBjcm9zcy1zZWdtZW50IHNlZWtpbmdcbiAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0U2VnbWVudEluZm8gPSB0aGlzLl9tZWRpYUluZm8uc2VnbWVudHNbdGFyZ2V0U2VnbWVudEluZGV4XTtcblxuICAgICAgICAgICAgICAgIGlmICh0YXJnZXRTZWdtZW50SW5mbyA9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGFyZ2V0IHNlZ21lbnQgaGFzbid0IGJlZW4gbG9hZGVkLiBXZSBuZWVkIG1ldGFkYXRhIHRoZW4gc2VlayB0byBleHBlY3RlZCB0aW1lXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTZWVrVGltZSA9IG1pbGxpc2Vjb25kcztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faW50ZXJuYWxBYm9ydCgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW11eGVyLnNlZWsoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtdXhlci5pbnNlcnREaXNjb250aW51aXR5KCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRTZWdtZW50KHRhcmdldFNlZ21lbnRJbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIEhlcmUgd2Ugd2FpdCBmb3IgdGhlIG1ldGFkYXRhIGxvYWRlZCwgdGhlbiBzZWVrIHRvIGV4cGVjdGVkIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgaGF2ZSB0YXJnZXQgc2VnbWVudCdzIG1ldGFkYXRhLCBkaXJlY3Qgc2VlayB0byB0YXJnZXQgcG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgdmFyIF9rZXlmcmFtZSA9IHRhcmdldFNlZ21lbnRJbmZvLmdldE5lYXJlc3RLZXlmcmFtZShtaWxsaXNlY29uZHMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9pbnRlcm5hbEFib3J0KCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlbXV4ZXIuc2VlayhtaWxsaXNlY29uZHMpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZW11eGVyLmluc2VydERpc2NvbnRpbnVpdHkoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlci5yZXNldE1lZGlhSW5mbygpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyLnRpbWVzdGFtcEJhc2UgPSB0aGlzLl9tZWRpYURhdGFTb3VyY2Uuc2VnbWVudHNbdGFyZ2V0U2VnbWVudEluZGV4XS50aW1lc3RhbXBCYXNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9sb2FkU2VnbWVudCh0YXJnZXRTZWdtZW50SW5kZXgsIF9rZXlmcmFtZS5maWxlcG9zaXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nUmVzb2x2ZVNlZWtQb2ludCA9IF9rZXlmcmFtZS5taWxsaXNlY29uZHM7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlcG9ydFNlZ21lbnRNZWRpYUluZm8odGFyZ2V0U2VnbWVudEluZGV4KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX2VuYWJsZVN0YXRpc3RpY3NSZXBvcnRlcigpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfc2VhcmNoU2VnbWVudEluZGV4Q29udGFpbnMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3NlYXJjaFNlZ21lbnRJbmRleENvbnRhaW5zKG1pbGxpc2Vjb25kcykge1xuICAgICAgICAgICAgdmFyIHNlZ21lbnRzID0gdGhpcy5fbWVkaWFEYXRhU291cmNlLnNlZ21lbnRzO1xuICAgICAgICAgICAgdmFyIGlkeCA9IHNlZ21lbnRzLmxlbmd0aCAtIDE7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VnbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAobWlsbGlzZWNvbmRzIDwgc2VnbWVudHNbaV0udGltZXN0YW1wQmFzZSkge1xuICAgICAgICAgICAgICAgICAgICBpZHggPSBpIC0gMTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGlkeDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uSW5pdENodW5rQXJyaXZhbCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Jbml0Q2h1bmtBcnJpdmFsKGRhdGEsIGJ5dGVTdGFydCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICAgICAgICAgdmFyIHByb2JlRGF0YSA9IG51bGw7XG4gICAgICAgICAgICB2YXIgY29uc3VtZWQgPSAwO1xuXG4gICAgICAgICAgICBpZiAoYnl0ZVN0YXJ0ID4gMCkge1xuICAgICAgICAgICAgICAgIC8vIElPQ29udHJvbGxlciBzZWVrZWQgaW1tZWRpYXRlbHkgYWZ0ZXIgb3BlbmVkLCBieXRlU3RhcnQgPiAwIGNhbGxiYWNrIG1heSByZWNlaXZlZFxuICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIuYmluZERhdGFTb3VyY2UodGhpcy5faW9jdGwpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIudGltZXN0YW1wQmFzZSA9IHRoaXMuX21lZGlhRGF0YVNvdXJjZS5zZWdtZW50c1t0aGlzLl9jdXJyZW50U2VnbWVudEluZGV4XS50aW1lc3RhbXBCYXNlO1xuXG4gICAgICAgICAgICAgICAgY29uc3VtZWQgPSB0aGlzLl9kZW11eGVyLnBhcnNlQ2h1bmtzKGRhdGEsIGJ5dGVTdGFydCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKChwcm9iZURhdGEgPSBfZmx2RGVtdXhlcjIuZGVmYXVsdC5wcm9iZShkYXRhKSkubWF0Y2gpIHtcbiAgICAgICAgICAgICAgICAvLyBBbHdheXMgY3JlYXRlIG5ldyBGTFZEZW11eGVyXG4gICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlciA9IG5ldyBfZmx2RGVtdXhlcjIuZGVmYXVsdChwcm9iZURhdGEsIHRoaXMuX2NvbmZpZyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX3JlbXV4ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVtdXhlciA9IG5ldyBfbXA0UmVtdXhlcjIuZGVmYXVsdCh0aGlzLl9jb25maWcpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBtZHMgPSB0aGlzLl9tZWRpYURhdGFTb3VyY2U7XG4gICAgICAgICAgICAgICAgaWYgKG1kcy5kdXJhdGlvbiAhPSB1bmRlZmluZWQgJiYgIWlzTmFOKG1kcy5kdXJhdGlvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlci5vdmVycmlkZWREdXJhdGlvbiA9IG1kcy5kdXJhdGlvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtZHMuaGFzQXVkaW8gPT09ICdib29sZWFuJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyLm92ZXJyaWRlZEhhc0F1ZGlvID0gbWRzLmhhc0F1ZGlvO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG1kcy5oYXNWaWRlbyA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIub3ZlcnJpZGVkSGFzVmlkZW8gPSBtZHMuaGFzVmlkZW87XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlci50aW1lc3RhbXBCYXNlID0gbWRzLnNlZ21lbnRzW3RoaXMuX2N1cnJlbnRTZWdtZW50SW5kZXhdLnRpbWVzdGFtcEJhc2U7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9kZW11eGVyLm9uRXJyb3IgPSB0aGlzLl9vbkRlbXV4RXhjZXB0aW9uLmJpbmQodGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlci5vbk1lZGlhSW5mbyA9IHRoaXMuX29uTWVkaWFJbmZvLmJpbmQodGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlci5vbk1ldGFEYXRhQXJyaXZlZCA9IHRoaXMuX29uTWV0YURhdGFBcnJpdmVkLmJpbmQodGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGVtdXhlci5vblNjcmlwdERhdGFBcnJpdmVkID0gdGhpcy5fb25TY3JpcHREYXRhQXJyaXZlZC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2RlbXV4ZXIub25TdHJlYW1UaW1lID0gdGhpcy5fb25TdHJlYW1UaW1lLmJpbmQodGhpcyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9yZW11eGVyLmJpbmREYXRhU291cmNlKHRoaXMuX2RlbXV4ZXIuYmluZERhdGFTb3VyY2UodGhpcy5faW9jdGwpKTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbXV4ZXIub25Jbml0U2VnbWVudCA9IHRoaXMuX29uUmVtdXhlckluaXRTZWdtZW50QXJyaXZhbC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlbXV4ZXIub25NZWRpYVNlZ21lbnQgPSB0aGlzLl9vblJlbXV4ZXJNZWRpYVNlZ21lbnRBcnJpdmFsLmJpbmQodGhpcyk7XG5cbiAgICAgICAgICAgICAgICBjb25zdW1lZCA9IHRoaXMuX2RlbXV4ZXIucGFyc2VDaHVua3MoZGF0YSwgYnl0ZVN0YXJ0KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcHJvYmVEYXRhID0gbnVsbDtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmUodGhpcy5UQUcsICdOb24tRkxWLCBVbnN1cHBvcnRlZCBtZWRpYSB0eXBlIScpO1xuICAgICAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5faW50ZXJuYWxBYm9ydCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuREVNVVhfRVJST1IsIF9kZW11eEVycm9yczIuZGVmYXVsdC5GT1JNQVRfVU5TVVBQT1JURUQsICdOb24tRkxWLCBVbnN1cHBvcnRlZCBtZWRpYSB0eXBlJyk7XG5cbiAgICAgICAgICAgICAgICBjb25zdW1lZCA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBjb25zdW1lZDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uTWVkaWFJbmZvJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbk1lZGlhSW5mbyhtZWRpYUluZm8pIHtcbiAgICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFJbmZvID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAvLyBTdG9yZSBmaXJzdCBzZWdtZW50J3MgbWVkaWFpbmZvIGFzIGdsb2JhbCBtZWRpYUluZm9cbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8gPSBPYmplY3QuYXNzaWduKHt9LCBtZWRpYUluZm8pO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5rZXlmcmFtZXNJbmRleCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLnNlZ21lbnRzID0gW107XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLnNlZ21lbnRDb3VudCA9IHRoaXMuX21lZGlhRGF0YVNvdXJjZS5zZWdtZW50cy5sZW5ndGg7XG4gICAgICAgICAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMuX21lZGlhSW5mbywgX21lZGlhSW5mbzIuZGVmYXVsdC5wcm90b3R5cGUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc2VnbWVudEluZm8gPSBPYmplY3QuYXNzaWduKHt9LCBtZWRpYUluZm8pO1xuICAgICAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHNlZ21lbnRJbmZvLCBfbWVkaWFJbmZvMi5kZWZhdWx0LnByb3RvdHlwZSk7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uc2VnbWVudHNbdGhpcy5fY3VycmVudFNlZ21lbnRJbmRleF0gPSBzZWdtZW50SW5mbztcblxuICAgICAgICAgICAgLy8gbm90aWZ5IG1lZGlhSW5mbyB1cGRhdGVcbiAgICAgICAgICAgIHRoaXMuX3JlcG9ydFNlZ21lbnRNZWRpYUluZm8odGhpcy5fY3VycmVudFNlZ21lbnRJbmRleCk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nU2Vla1RpbWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gX3RoaXMyLl9wZW5kaW5nU2Vla1RpbWU7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMi5fcGVuZGluZ1NlZWtUaW1lID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLnNlZWsodGFyZ2V0KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uTWV0YURhdGFBcnJpdmVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbk1ldGFEYXRhQXJyaXZlZChtZXRhZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRVRBREFUQV9BUlJJVkVELCBtZXRhZGF0YSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblNjcmlwdERhdGFBcnJpdmVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblNjcmlwdERhdGFBcnJpdmVkKGRhdGEpIHtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU0NSSVBUREFUQV9BUlJJVkVELCBkYXRhKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uU3RyZWFtVGltZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25TdHJlYW1UaW1lKHRpbWUpIHtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuU1RSRUFNX1RJTUUsIHRpbWUpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25JT1NlZWtlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25JT1NlZWtlZCgpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlbXV4ZXIuaW5zZXJ0RGlzY29udGludWl0eSgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25JT0NvbXBsZXRlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbklPQ29tcGxldGUoZXh0cmFEYXRhKSB7XG4gICAgICAgICAgICB2YXIgc2VnbWVudEluZGV4ID0gZXh0cmFEYXRhO1xuICAgICAgICAgICAgdmFyIG5leHRTZWdtZW50SW5kZXggPSBzZWdtZW50SW5kZXggKyAxO1xuXG4gICAgICAgICAgICBpZiAobmV4dFNlZ21lbnRJbmRleCA8IHRoaXMuX21lZGlhRGF0YVNvdXJjZS5zZWdtZW50cy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnRlcm5hbEFib3J0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVtdXhlci5mbHVzaFN0YXNoZWRTYW1wbGVzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZFNlZ21lbnQobmV4dFNlZ21lbnRJbmRleCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlbXV4ZXIuZmx1c2hTdGFzaGVkU2FtcGxlcygpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTE9BRElOR19DT01QTEVURSk7XG4gICAgICAgICAgICAgICAgdGhpcy5fZGlzYWJsZVN0YXRpc3RpY3NSZXBvcnRlcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25JT1JlZGlyZWN0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbklPUmVkaXJlY3QocmVkaXJlY3RlZFVSTCkge1xuICAgICAgICAgICAgdmFyIHNlZ21lbnRJbmRleCA9IHRoaXMuX2lvY3RsLmV4dHJhRGF0YTtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhRGF0YVNvdXJjZS5zZWdtZW50c1tzZWdtZW50SW5kZXhdLnJlZGlyZWN0ZWRVUkwgPSByZWRpcmVjdGVkVVJMO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25JT1JlY292ZXJlZEVhcmx5RW9mJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbklPUmVjb3ZlcmVkRWFybHlFb2YoKSB7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlJFQ09WRVJFRF9FQVJMWV9FT0YpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25JT0V4Y2VwdGlvbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25JT0V4Y2VwdGlvbih0eXBlLCBpbmZvKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmUodGhpcy5UQUcsICdJT0V4Y2VwdGlvbjogdHlwZSA9ICcgKyB0eXBlICsgJywgY29kZSA9ICcgKyBpbmZvLmNvZGUgKyAnLCBtc2cgPSAnICsgaW5mby5tc2cpO1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5JT19FUlJPUiwgdHlwZSwgaW5mbyk7XG4gICAgICAgICAgICB0aGlzLl9kaXNhYmxlU3RhdGlzdGljc1JlcG9ydGVyKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbkRlbXV4RXhjZXB0aW9uJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkRlbXV4RXhjZXB0aW9uKHR5cGUsIGluZm8pIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZSh0aGlzLlRBRywgJ0RlbXV4RXhjZXB0aW9uOiB0eXBlID0gJyArIHR5cGUgKyAnLCBpbmZvID0gJyArIGluZm8pO1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5ERU1VWF9FUlJPUiwgdHlwZSwgaW5mbyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblJlbXV4ZXJJbml0U2VnbWVudEFycml2YWwnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVtdXhlckluaXRTZWdtZW50QXJyaXZhbCh0eXBlLCBpbml0U2VnbWVudCkge1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5JTklUX1NFR01FTlQsIHR5cGUsIGluaXRTZWdtZW50KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uUmVtdXhlck1lZGlhU2VnbWVudEFycml2YWwnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVtdXhlck1lZGlhU2VnbWVudEFycml2YWwodHlwZSwgbWVkaWFTZWdtZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fcGVuZGluZ1NlZWtUaW1lICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAvLyBNZWRpYSBzZWdtZW50cyBhZnRlciBuZXctc2VnbWVudCBjcm9zcy1zZWVraW5nIHNob3VsZCBiZSBkcm9wcGVkLlxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVESUFfU0VHTUVOVCwgdHlwZSwgbWVkaWFTZWdtZW50KTtcblxuICAgICAgICAgICAgLy8gUmVzb2x2ZSBwZW5kaW5nIHNlZWtQb2ludFxuICAgICAgICAgICAgaWYgKHRoaXMuX3BlbmRpbmdSZXNvbHZlU2Vla1BvaW50ICE9IG51bGwgJiYgdHlwZSA9PT0gJ3ZpZGVvJykge1xuICAgICAgICAgICAgICAgIHZhciBzeW5jUG9pbnRzID0gbWVkaWFTZWdtZW50LmluZm8uc3luY1BvaW50cztcbiAgICAgICAgICAgICAgICB2YXIgc2Vla3BvaW50ID0gdGhpcy5fcGVuZGluZ1Jlc29sdmVTZWVrUG9pbnQ7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1Jlc29sdmVTZWVrUG9pbnQgPSBudWxsO1xuXG4gICAgICAgICAgICAgICAgLy8gU2FmYXJpOiBQYXNzIFBUUyBmb3IgcmVjb21tZW5kX3NlZWtwb2ludFxuICAgICAgICAgICAgICAgIGlmIChfYnJvd3NlcjIuZGVmYXVsdC5zYWZhcmkgJiYgc3luY1BvaW50cy5sZW5ndGggPiAwICYmIHN5bmNQb2ludHNbMF0ub3JpZ2luYWxEdHMgPT09IHNlZWtwb2ludCkge1xuICAgICAgICAgICAgICAgICAgICBzZWVrcG9pbnQgPSBzeW5jUG9pbnRzWzBdLnB0cztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gZWxzZTogdXNlIG9yaWdpbmFsIERUUyAoa2V5ZnJhbWUubWlsbGlzZWNvbmRzKVxuXG4gICAgICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5SRUNPTU1FTkRfU0VFS1BPSU5ULCBzZWVrcG9pbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfZW5hYmxlU3RhdGlzdGljc1JlcG9ydGVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9lbmFibGVTdGF0aXN0aWNzUmVwb3J0ZXIoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhdGlzdGljc1JlcG9ydGVyID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0aXN0aWNzUmVwb3J0ZXIgPSBzZWxmLnNldEludGVydmFsKHRoaXMuX3JlcG9ydFN0YXRpc3RpY3NJbmZvLmJpbmQodGhpcyksIHRoaXMuX2NvbmZpZy5zdGF0aXN0aWNzSW5mb1JlcG9ydEludGVydmFsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2Rpc2FibGVTdGF0aXN0aWNzUmVwb3J0ZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2Rpc2FibGVTdGF0aXN0aWNzUmVwb3J0ZXIoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhdGlzdGljc1JlcG9ydGVyKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5jbGVhckludGVydmFsKHRoaXMuX3N0YXRpc3RpY3NSZXBvcnRlcik7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdGlzdGljc1JlcG9ydGVyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3JlcG9ydFNlZ21lbnRNZWRpYUluZm8nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3JlcG9ydFNlZ21lbnRNZWRpYUluZm8oc2VnbWVudEluZGV4KSB7XG4gICAgICAgICAgICB2YXIgc2VnbWVudEluZm8gPSB0aGlzLl9tZWRpYUluZm8uc2VnbWVudHNbc2VnbWVudEluZGV4XTtcbiAgICAgICAgICAgIHZhciBleHBvcnRJbmZvID0gT2JqZWN0LmFzc2lnbih7fSwgc2VnbWVudEluZm8pO1xuXG4gICAgICAgICAgICBleHBvcnRJbmZvLmR1cmF0aW9uID0gdGhpcy5fbWVkaWFJbmZvLmR1cmF0aW9uO1xuICAgICAgICAgICAgZXhwb3J0SW5mby5zZWdtZW50Q291bnQgPSB0aGlzLl9tZWRpYUluZm8uc2VnbWVudENvdW50O1xuICAgICAgICAgICAgZGVsZXRlIGV4cG9ydEluZm8uc2VnbWVudHM7XG4gICAgICAgICAgICBkZWxldGUgZXhwb3J0SW5mby5rZXlmcmFtZXNJbmRleDtcblxuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5lbWl0KF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRURJQV9JTkZPLCBleHBvcnRJbmZvKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3JlcG9ydFN0YXRpc3RpY3NJbmZvJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9yZXBvcnRTdGF0aXN0aWNzSW5mbygpIHtcbiAgICAgICAgICAgIHZhciBpbmZvID0ge307XG5cbiAgICAgICAgICAgIGluZm8udXJsID0gdGhpcy5faW9jdGwuY3VycmVudFVSTDtcbiAgICAgICAgICAgIGluZm8uaGFzUmVkaXJlY3QgPSB0aGlzLl9pb2N0bC5oYXNSZWRpcmVjdDtcbiAgICAgICAgICAgIGlmIChpbmZvLmhhc1JlZGlyZWN0KSB7XG4gICAgICAgICAgICAgICAgaW5mby5yZWRpcmVjdGVkVVJMID0gdGhpcy5faW9jdGwuY3VycmVudFJlZGlyZWN0ZWRVUkw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGluZm8uc3BlZWQgPSB0aGlzLl9pb2N0bC5jdXJyZW50U3BlZWQ7XG4gICAgICAgICAgICBpbmZvLmxvYWRlclR5cGUgPSB0aGlzLl9pb2N0bC5sb2FkZXJUeXBlO1xuICAgICAgICAgICAgaW5mby5jdXJyZW50U2VnbWVudEluZGV4ID0gdGhpcy5fY3VycmVudFNlZ21lbnRJbmRleDtcbiAgICAgICAgICAgIGluZm8udG90YWxTZWdtZW50Q291bnQgPSB0aGlzLl9tZWRpYURhdGFTb3VyY2Uuc2VnbWVudHMubGVuZ3RoO1xuXG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmVtaXQoX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNUQVRJU1RJQ1NfSU5GTywgaW5mbyk7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gVHJhbnNtdXhpbmdDb250cm9sbGVyO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBUcmFuc211eGluZ0NvbnRyb2xsZXI7XG5cbn0se1wiLi4vZGVtdXgvZGVtdXgtZXJyb3JzLmpzXCI6MTYsXCIuLi9kZW11eC9mbHYtZGVtdXhlci5qc1wiOjE4LFwiLi4vaW8vaW8tY29udHJvbGxlci5qc1wiOjIzLFwiLi4vaW8vbG9hZGVyLmpzXCI6MjQsXCIuLi9yZW11eC9tcDQtcmVtdXhlci5qc1wiOjM4LFwiLi4vdXRpbHMvYnJvd3Nlci5qc1wiOjM5LFwiLi4vdXRpbHMvbG9nZ2VyLmpzXCI6NDEsXCIuL21lZGlhLWluZm8uanNcIjo3LFwiLi90cmFuc211eGluZy1ldmVudHMuanNcIjoxMyxcImV2ZW50c1wiOjJ9XSwxMzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG52YXIgVHJhbnNtdXhpbmdFdmVudHMgPSB7XG4gIElPX0VSUk9SOiAnaW9fZXJyb3InLFxuICBERU1VWF9FUlJPUjogJ2RlbXV4X2Vycm9yJyxcbiAgSU5JVF9TRUdNRU5UOiAnaW5pdF9zZWdtZW50JyxcbiAgTUVESUFfU0VHTUVOVDogJ21lZGlhX3NlZ21lbnQnLFxuICBMT0FESU5HX0NPTVBMRVRFOiAnbG9hZGluZ19jb21wbGV0ZScsXG4gIFJFQ09WRVJFRF9FQVJMWV9FT0Y6ICdyZWNvdmVyZWRfZWFybHlfZW9mJyxcbiAgTUVESUFfSU5GTzogJ21lZGlhX2luZm8nLFxuICBNRVRBREFUQV9BUlJJVkVEOiAnbWV0YWRhdGFfYXJyaXZlZCcsXG4gIFNDUklQVERBVEFfQVJSSVZFRDogJ3NjcmlwdGRhdGFfYXJyaXZlZCcsXG4gIFNUQVRJU1RJQ1NfSU5GTzogJ3N0YXRpc3RpY3NfaW5mbycsXG4gIFJFQ09NTUVORF9TRUVLUE9JTlQ6ICdyZWNvbW1lbmRfc2Vla3BvaW50JyxcbiAgU1RSRUFNX1RJTUU6ICdzdHJlYW1fdGltZSdcbn07XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFRyYW5zbXV4aW5nRXZlbnRzO1xuXG59LHt9XSwxNDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9sb2dnZXIgPSBfZGVyZXFfKCcuLi91dGlscy9sb2dnZXIuanMnKTtcblxudmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTtcblxudmFyIF9sb2dnaW5nQ29udHJvbCA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZ2dpbmctY29udHJvbC5qcycpO1xuXG52YXIgX2xvZ2dpbmdDb250cm9sMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dpbmdDb250cm9sKTtcblxudmFyIF9wb2x5ZmlsbCA9IF9kZXJlcV8oJy4uL3V0aWxzL3BvbHlmaWxsLmpzJyk7XG5cbnZhciBfcG9seWZpbGwyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcG9seWZpbGwpO1xuXG52YXIgX3RyYW5zbXV4aW5nQ29udHJvbGxlciA9IF9kZXJlcV8oJy4vdHJhbnNtdXhpbmctY29udHJvbGxlci5qcycpO1xuXG52YXIgX3RyYW5zbXV4aW5nQ29udHJvbGxlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90cmFuc211eGluZ0NvbnRyb2xsZXIpO1xuXG52YXIgX3RyYW5zbXV4aW5nRXZlbnRzID0gX2RlcmVxXygnLi90cmFuc211eGluZy1ldmVudHMuanMnKTtcblxudmFyIF90cmFuc211eGluZ0V2ZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90cmFuc211eGluZ0V2ZW50cyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbi8qIHBvc3QgbWVzc2FnZSB0byB3b3JrZXI6XHJcbiAgIGRhdGE6IHtcclxuICAgICAgIGNtZDogc3RyaW5nXHJcbiAgICAgICBwYXJhbTogYW55XHJcbiAgIH1cclxuXHJcbiAgIHJlY2VpdmUgbWVzc2FnZSBmcm9tIHdvcmtlcjpcclxuICAgZGF0YToge1xyXG4gICAgICAgbXNnOiBzdHJpbmcsXHJcbiAgICAgICBkYXRhOiBhbnlcclxuICAgfVxyXG4gKi9cblxudmFyIFRyYW5zbXV4aW5nV29ya2VyID0gZnVuY3Rpb24gVHJhbnNtdXhpbmdXb3JrZXIoc2VsZikge1xuXG4gICAgdmFyIFRBRyA9ICdUcmFuc211eGluZ1dvcmtlcic7XG4gICAgdmFyIGNvbnRyb2xsZXIgPSBudWxsO1xuICAgIHZhciBsb2djYXRMaXN0ZW5lciA9IG9uTG9nY2F0Q2FsbGJhY2suYmluZCh0aGlzKTtcblxuICAgIF9wb2x5ZmlsbDIuZGVmYXVsdC5pbnN0YWxsKCk7XG5cbiAgICBzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICBzd2l0Y2ggKGUuZGF0YS5jbWQpIHtcbiAgICAgICAgICAgIGNhc2UgJ2luaXQnOlxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIgPSBuZXcgX3RyYW5zbXV4aW5nQ29udHJvbGxlcjIuZGVmYXVsdChlLmRhdGEucGFyYW1bMF0sIGUuZGF0YS5wYXJhbVsxXSk7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuSU9fRVJST1IsIG9uSU9FcnJvci5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5ERU1VWF9FUlJPUiwgb25EZW11eEVycm9yLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LklOSVRfU0VHTUVOVCwgb25Jbml0U2VnbWVudC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5NRURJQV9TRUdNRU5ULCBvbk1lZGlhU2VnbWVudC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5MT0FESU5HX0NPTVBMRVRFLCBvbkxvYWRpbmdDb21wbGV0ZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5SRUNPVkVSRURfRUFSTFlfRU9GLCBvblJlY292ZXJlZEVhcmx5RW9mLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FRElBX0lORk8sIG9uTWVkaWFJbmZvLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FVEFEQVRBX0FSUklWRUQsIG9uTWV0YURhdGFBcnJpdmVkLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlNDUklQVERBVEFfQVJSSVZFRCwgb25TY3JpcHREYXRhQXJyaXZlZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TVEFUSVNUSUNTX0lORk8sIG9uU3RhdGlzdGljc0luZm8uYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuUkVDT01NRU5EX1NFRUtQT0lOVCwgb25SZWNvbW1lbmRTZWVrcG9pbnQuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdkZXN0cm95JzpcbiAgICAgICAgICAgICAgICBpZiAoY29udHJvbGxlcikge1xuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGYucG9zdE1lc3NhZ2UoeyBtc2c6ICdkZXN0cm95ZWQnIH0pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnc3RhcnQnOlxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuc3RhcnQoKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ3N0b3AnOlxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuc3RvcCgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnc2Vlayc6XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5zZWVrKGUuZGF0YS5wYXJhbSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdwYXVzZSc6XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5wYXVzZSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAncmVzdW1lJzpcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyLnJlc3VtZSgpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnbG9nZ2luZ19jb25maWcnOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvbmZpZyA9IGUuZGF0YS5wYXJhbTtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dpbmdDb250cm9sMi5kZWZhdWx0LmFwcGx5Q29uZmlnKGNvbmZpZyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5lbmFibGVDYWxsYmFjayA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2xvZ2dpbmdDb250cm9sMi5kZWZhdWx0LmFkZExvZ0xpc3RlbmVyKGxvZ2NhdExpc3RlbmVyKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2dnaW5nQ29udHJvbDIuZGVmYXVsdC5yZW1vdmVMb2dMaXN0ZW5lcihsb2djYXRMaXN0ZW5lcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiBvbkluaXRTZWdtZW50KHR5cGUsIGluaXRTZWdtZW50KSB7XG4gICAgICAgIHZhciBvYmogPSB7XG4gICAgICAgICAgICBtc2c6IF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5JTklUX1NFR01FTlQsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgICAgICBkYXRhOiBpbml0U2VnbWVudFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKG9iaiwgW2luaXRTZWdtZW50LmRhdGFdKTsgLy8gZGF0YTogQXJyYXlCdWZmZXJcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbk1lZGlhU2VnbWVudCh0eXBlLCBtZWRpYVNlZ21lbnQpIHtcbiAgICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAgICAgIG1zZzogX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FRElBX1NFR01FTlQsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgICAgICBkYXRhOiBtZWRpYVNlZ21lbnRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZShvYmosIFttZWRpYVNlZ21lbnQuZGF0YV0pOyAvLyBkYXRhOiBBcnJheUJ1ZmZlclxuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uTG9hZGluZ0NvbXBsZXRlKCkge1xuICAgICAgICB2YXIgb2JqID0ge1xuICAgICAgICAgICAgbXNnOiBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTE9BRElOR19DT01QTEVURVxuICAgICAgICB9O1xuICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKG9iaik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25SZWNvdmVyZWRFYXJseUVvZigpIHtcbiAgICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAgICAgIG1zZzogX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LlJFQ09WRVJFRF9FQVJMWV9FT0ZcbiAgICAgICAgfTtcbiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZShvYmopO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9uTWVkaWFJbmZvKG1lZGlhSW5mbykge1xuICAgICAgICB2YXIgb2JqID0ge1xuICAgICAgICAgICAgbXNnOiBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVESUFfSU5GTyxcbiAgICAgICAgICAgIGRhdGE6IG1lZGlhSW5mb1xuICAgICAgICB9O1xuICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKG9iaik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25NZXRhRGF0YUFycml2ZWQobWV0YWRhdGEpIHtcbiAgICAgICAgdmFyIG9iaiA9IHtcbiAgICAgICAgICAgIG1zZzogX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FVEFEQVRBX0FSUklWRUQsXG4gICAgICAgICAgICBkYXRhOiBtZXRhZGF0YVxuICAgICAgICB9O1xuICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKG9iaik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25TY3JpcHREYXRhQXJyaXZlZChkYXRhKSB7XG4gICAgICAgIHZhciBvYmogPSB7XG4gICAgICAgICAgICBtc2c6IF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TQ1JJUFREQVRBX0FSUklWRUQsXG4gICAgICAgICAgICBkYXRhOiBkYXRhXG4gICAgICAgIH07XG4gICAgICAgIHNlbGYucG9zdE1lc3NhZ2Uob2JqKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvblN0YXRpc3RpY3NJbmZvKHN0YXRJbmZvKSB7XG4gICAgICAgIHZhciBvYmogPSB7XG4gICAgICAgICAgICBtc2c6IF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TVEFUSVNUSUNTX0lORk8sXG4gICAgICAgICAgICBkYXRhOiBzdGF0SW5mb1xuICAgICAgICB9O1xuICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKG9iaik7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25JT0Vycm9yKHR5cGUsIGluZm8pIHtcbiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICBtc2c6IF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5JT19FUlJPUixcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgICAgICAgIGluZm86IGluZm9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25EZW11eEVycm9yKHR5cGUsIGluZm8pIHtcbiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZSh7XG4gICAgICAgICAgICBtc2c6IF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5ERU1VWF9FUlJPUixcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgICAgICAgIGluZm86IGluZm9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25SZWNvbW1lbmRTZWVrcG9pbnQobWlsbGlzZWNvbmRzKSB7XG4gICAgICAgIHNlbGYucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgbXNnOiBfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuUkVDT01NRU5EX1NFRUtQT0lOVCxcbiAgICAgICAgICAgIGRhdGE6IG1pbGxpc2Vjb25kc1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbkxvZ2NhdENhbGxiYWNrKHR5cGUsIHN0cikge1xuICAgICAgICBzZWxmLnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgIG1zZzogJ2xvZ2NhdF9jYWxsYmFjaycsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgICAgICBsb2djYXQ6IHN0clxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG59OyAvKlxyXG4gICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAqXHJcbiAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICpcclxuICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICpcclxuICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgKlxyXG4gICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAqL1xuXG5leHBvcnRzLmRlZmF1bHQgPSBUcmFuc211eGluZ1dvcmtlcjtcblxufSx7XCIuLi91dGlscy9sb2dnZXIuanNcIjo0MSxcIi4uL3V0aWxzL2xvZ2dpbmctY29udHJvbC5qc1wiOjQyLFwiLi4vdXRpbHMvcG9seWZpbGwuanNcIjo0MyxcIi4vdHJhbnNtdXhpbmctY29udHJvbGxlci5qc1wiOjEyLFwiLi90cmFuc211eGluZy1ldmVudHMuanNcIjoxM31dLDE1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9sb2dnZXIgPSBfZGVyZXFfKCcuLi91dGlscy9sb2dnZXIuanMnKTtcblxudmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTtcblxudmFyIF91dGY4Q29udiA9IF9kZXJlcV8oJy4uL3V0aWxzL3V0ZjgtY29udi5qcycpO1xuXG52YXIgX3V0ZjhDb252MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3V0ZjhDb252KTtcblxudmFyIF9leGNlcHRpb24gPSBfZGVyZXFfKCcuLi91dGlscy9leGNlcHRpb24uanMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIGxlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBidWYgPSBuZXcgQXJyYXlCdWZmZXIoMik7XG4gICAgbmV3IERhdGFWaWV3KGJ1Zikuc2V0SW50MTYoMCwgMjU2LCB0cnVlKTsgLy8gbGl0dGxlLWVuZGlhbiB3cml0ZVxuICAgIHJldHVybiBuZXcgSW50MTZBcnJheShidWYpWzBdID09PSAyNTY7IC8vIHBsYXRmb3JtLXNwZWMgcmVhZCwgaWYgZXF1YWwgdGhlbiBMRVxufSgpO1xuXG52YXIgQU1GID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEFNRigpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFNRik7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKEFNRiwgbnVsbCwgW3tcbiAgICAgICAga2V5OiAncGFyc2VTY3JpcHREYXRhJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBhcnNlU2NyaXB0RGF0YShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpIHtcbiAgICAgICAgICAgIHZhciBkYXRhID0ge307XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBBTUYucGFyc2VWYWx1ZShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpO1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IEFNRi5wYXJzZVZhbHVlKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgbmFtZS5zaXplLCBkYXRhU2l6ZSAtIG5hbWUuc2l6ZSk7XG5cbiAgICAgICAgICAgICAgICBkYXRhW25hbWUuZGF0YV0gPSB2YWx1ZS5kYXRhO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZSgnQU1GJywgZS50b1N0cmluZygpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3BhcnNlT2JqZWN0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBhcnNlT2JqZWN0KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSkge1xuICAgICAgICAgICAgaWYgKGRhdGFTaXplIDwgMykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbignRGF0YSBub3QgZW5vdWdoIHdoZW4gcGFyc2UgU2NyaXB0RGF0YU9iamVjdCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIG5hbWUgPSBBTUYucGFyc2VTdHJpbmcoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKTtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IEFNRi5wYXJzZVZhbHVlKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgbmFtZS5zaXplLCBkYXRhU2l6ZSAtIG5hbWUuc2l6ZSk7XG4gICAgICAgICAgICB2YXIgaXNPYmplY3RFbmQgPSB2YWx1ZS5vYmplY3RFbmQ7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLmRhdGEsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB2YWx1ZS5kYXRhXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzaXplOiBuYW1lLnNpemUgKyB2YWx1ZS5zaXplLFxuICAgICAgICAgICAgICAgIG9iamVjdEVuZDogaXNPYmplY3RFbmRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3BhcnNlVmFyaWFibGUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGFyc2VWYXJpYWJsZShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpIHtcbiAgICAgICAgICAgIHJldHVybiBBTUYucGFyc2VPYmplY3QoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncGFyc2VTdHJpbmcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGFyc2VTdHJpbmcoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKSB7XG4gICAgICAgICAgICBpZiAoZGF0YVNpemUgPCAyKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCdEYXRhIG5vdCBlbm91Z2ggd2hlbiBwYXJzZSBTdHJpbmcnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciB2ID0gbmV3IERhdGFWaWV3KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSk7XG4gICAgICAgICAgICB2YXIgbGVuZ3RoID0gdi5nZXRVaW50MTYoMCwgIWxlKTtcblxuICAgICAgICAgICAgdmFyIHN0ciA9IHZvaWQgMDtcbiAgICAgICAgICAgIGlmIChsZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgc3RyID0gKDAsIF91dGY4Q29udjIuZGVmYXVsdCkobmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyAyLCBsZW5ndGgpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc3RyID0gJyc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZGF0YTogc3RyLFxuICAgICAgICAgICAgICAgIHNpemU6IDIgKyBsZW5ndGhcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3BhcnNlTG9uZ1N0cmluZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXJzZUxvbmdTdHJpbmcoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKSB7XG4gICAgICAgICAgICBpZiAoZGF0YVNpemUgPCA0KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCdEYXRhIG5vdCBlbm91Z2ggd2hlbiBwYXJzZSBMb25nU3RyaW5nJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgdiA9IG5ldyBEYXRhVmlldyhhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpO1xuICAgICAgICAgICAgdmFyIGxlbmd0aCA9IHYuZ2V0VWludDMyKDAsICFsZSk7XG5cbiAgICAgICAgICAgIHZhciBzdHIgPSB2b2lkIDA7XG4gICAgICAgICAgICBpZiAobGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHN0ciA9ICgwLCBfdXRmOENvbnYyLmRlZmF1bHQpKG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgNCwgbGVuZ3RoKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHN0ciA9ICcnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGRhdGE6IHN0cixcbiAgICAgICAgICAgICAgICBzaXplOiA0ICsgbGVuZ3RoXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwYXJzZURhdGUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGFyc2VEYXRlKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSkge1xuICAgICAgICAgICAgaWYgKGRhdGFTaXplIDwgMTApIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbGxlZ2FsU3RhdGVFeGNlcHRpb24oJ0RhdGEgc2l6ZSBpbnZhbGlkIHdoZW4gcGFyc2UgRGF0ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIHYgPSBuZXcgRGF0YVZpZXcoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKTtcbiAgICAgICAgICAgIHZhciB0aW1lc3RhbXAgPSB2LmdldEZsb2F0NjQoMCwgIWxlKTtcbiAgICAgICAgICAgIHZhciBsb2NhbFRpbWVPZmZzZXQgPSB2LmdldEludDE2KDgsICFsZSk7XG4gICAgICAgICAgICB0aW1lc3RhbXAgKz0gbG9jYWxUaW1lT2Zmc2V0ICogNjAgKiAxMDAwOyAvLyBnZXQgVVRDIHRpbWVcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkYXRhOiBuZXcgRGF0ZSh0aW1lc3RhbXApLFxuICAgICAgICAgICAgICAgIHNpemU6IDggKyAyXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwYXJzZVZhbHVlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBhcnNlVmFsdWUoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKSB7XG4gICAgICAgICAgICBpZiAoZGF0YVNpemUgPCAxKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCdEYXRhIG5vdCBlbm91Z2ggd2hlbiBwYXJzZSBWYWx1ZScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdiA9IG5ldyBEYXRhVmlldyhhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpO1xuXG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gMTtcbiAgICAgICAgICAgIHZhciB0eXBlID0gdi5nZXRVaW50OCgwKTtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHZvaWQgMDtcbiAgICAgICAgICAgIHZhciBvYmplY3RFbmQgPSBmYWxzZTtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTnVtYmVyKERvdWJsZSkgdHlwZVxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB2LmdldEZsb2F0NjQoMSwgIWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSA4O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBCb29sZWFuIHR5cGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IHYuZ2V0VWludDgoMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBiID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RyaW5nIHR5cGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYW1mc3RyID0gQU1GLnBhcnNlU3RyaW5nKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgMSwgZGF0YVNpemUgLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGFtZnN0ci5kYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSBhbWZzdHIuc2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9iamVjdChzKSB0eXBlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVybWluYWwgPSAwOyAvLyB3b3JrYXJvdW5kIGZvciBtYWxmb3JtZWQgT2JqZWN0cyB3aGljaCBoYXMgbWlzc2luZyBTY3JpcHREYXRhT2JqZWN0RW5kXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh2LmdldFVpbnQzMihkYXRhU2l6ZSAtIDQsICFsZSkgJiAweDAwRkZGRkZGKSA9PT0gOSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXJtaW5hbCA9IDM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChvZmZzZXQgPCBkYXRhU2l6ZSAtIDQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gNCA9PT0gdHlwZShVSTgpICsgU2NyaXB0RGF0YU9iamVjdEVuZChVSTI0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYW1mb2JqID0gQU1GLnBhcnNlT2JqZWN0KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgb2Zmc2V0LCBkYXRhU2l6ZSAtIG9mZnNldCAtIHRlcm1pbmFsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFtZm9iai5vYmplY3RFbmQpIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZVthbWZvYmouZGF0YS5uYW1lXSA9IGFtZm9iai5kYXRhLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gYW1mb2JqLnNpemU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvZmZzZXQgPD0gZGF0YVNpemUgLSAzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYXJrZXIgPSB2LmdldFVpbnQzMihvZmZzZXQgLSAxLCAhbGUpICYgMHgwMEZGRkZGRjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hcmtlciA9PT0gOSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgODpcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBFQ01BIGFycmF5IHR5cGUgKE1peGVkIGFycmF5KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDQ7IC8vIEVDTUFBcnJheUxlbmd0aChVSTMyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfdGVybWluYWwgPSAwOyAvLyB3b3JrYXJvdW5kIGZvciBtYWxmb3JtZWQgTWl4ZWRBcnJheXMgd2hpY2ggaGFzIG1pc3NpbmcgU2NyaXB0RGF0YU9iamVjdEVuZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodi5nZXRVaW50MzIoZGF0YVNpemUgLSA0LCAhbGUpICYgMHgwMEZGRkZGRikgPT09IDkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3Rlcm1pbmFsID0gMztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKG9mZnNldCA8IGRhdGFTaXplIC0gOCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyA4ID09PSB0eXBlKFVJOCkgKyBFQ01BQXJyYXlMZW5ndGgoVUkzMikgKyBTY3JpcHREYXRhVmFyaWFibGVFbmQoVUkyNClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFtZnZhciA9IEFNRi5wYXJzZVZhcmlhYmxlKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgb2Zmc2V0LCBkYXRhU2l6ZSAtIG9mZnNldCAtIF90ZXJtaW5hbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhbWZ2YXIub2JqZWN0RW5kKSBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVbYW1mdmFyLmRhdGEubmFtZV0gPSBhbWZ2YXIuZGF0YS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IGFtZnZhci5zaXplO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob2Zmc2V0IDw9IGRhdGFTaXplIC0gMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX21hcmtlciA9IHYuZ2V0VWludDMyKG9mZnNldCAtIDEsICFsZSkgJiAweDAwRkZGRkZGO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX21hcmtlciA9PT0gOSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDM7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNjcmlwdERhdGFPYmplY3RFbmRcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdEVuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAxMDpcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTdHJpY3QgYXJyYXkgdHlwZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNjcmlwdERhdGFWYWx1ZVtuXS4gTk9URTogYWNjb3JkaW5nIHRvIHZpZGVvX2ZpbGVfZm9ybWF0X3NwZWNfdjEwXzEucGRmXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3RyaWN0QXJyYXlMZW5ndGggPSB2LmdldFVpbnQzMigxLCAhbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSA0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyaWN0QXJyYXlMZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsID0gQU1GLnBhcnNlVmFsdWUoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyBvZmZzZXQsIGRhdGFTaXplIC0gb2Zmc2V0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUucHVzaCh2YWwuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSB2YWwuc2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6XG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRGF0ZSB0eXBlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGUgPSBBTUYucGFyc2VEYXRlKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgMSwgZGF0YVNpemUgLSAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGRhdGUuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gZGF0ZS5zaXplO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjYXNlIDEyOlxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIExvbmcgc3RyaW5nIHR5cGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYW1mTG9uZ1N0ciA9IEFNRi5wYXJzZVN0cmluZyhhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIDEsIGRhdGFTaXplIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBhbWZMb25nU3RyLmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ICs9IGFtZkxvbmdTdHIuc2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBhbmQgc2tpcFxuICAgICAgICAgICAgICAgICAgICAgICAgb2Zmc2V0ID0gZGF0YVNpemU7XG4gICAgICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncoJ0FNRicsICdVbnN1cHBvcnRlZCBBTUYgdmFsdWUgdHlwZSAnICsgdHlwZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZSgnQU1GJywgZS50b1N0cmluZygpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBkYXRhOiB2YWx1ZSxcbiAgICAgICAgICAgICAgICBzaXplOiBvZmZzZXQsXG4gICAgICAgICAgICAgICAgb2JqZWN0RW5kOiBvYmplY3RFbmRcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gQU1GO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBBTUY7XG5cbn0se1wiLi4vdXRpbHMvZXhjZXB0aW9uLmpzXCI6NDAsXCIuLi91dGlscy9sb2dnZXIuanNcIjo0MSxcIi4uL3V0aWxzL3V0ZjgtY29udi5qc1wiOjQ0fV0sMTY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxudmFyIERlbXV4RXJyb3JzID0ge1xuICBPSzogJ09LJyxcbiAgRk9STUFUX0VSUk9SOiAnRm9ybWF0RXJyb3InLFxuICBGT1JNQVRfVU5TVVBQT1JURUQ6ICdGb3JtYXRVbnN1cHBvcnRlZCcsXG4gIENPREVDX1VOU1VQUE9SVEVEOiAnQ29kZWNVbnN1cHBvcnRlZCdcbn07XG5cbmV4cG9ydHMuZGVmYXVsdCA9IERlbXV4RXJyb3JzO1xuXG59LHt9XSwxNzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfZXhjZXB0aW9uID0gX2RlcmVxXygnLi4vdXRpbHMvZXhjZXB0aW9uLmpzJyk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8vIEV4cG9uZW50aWFsLUdvbG9tYiBidWZmZXIgZGVjb2RlclxudmFyIEV4cEdvbG9tYiA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBFeHBHb2xvbWIodWludDhhcnJheSkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXhwR29sb21iKTtcblxuICAgICAgICB0aGlzLlRBRyA9ICdFeHBHb2xvbWInO1xuXG4gICAgICAgIHRoaXMuX2J1ZmZlciA9IHVpbnQ4YXJyYXk7XG4gICAgICAgIHRoaXMuX2J1ZmZlcl9pbmRleCA9IDA7XG4gICAgICAgIHRoaXMuX3RvdGFsX2J5dGVzID0gdWludDhhcnJheS5ieXRlTGVuZ3RoO1xuICAgICAgICB0aGlzLl90b3RhbF9iaXRzID0gdWludDhhcnJheS5ieXRlTGVuZ3RoICogODtcbiAgICAgICAgdGhpcy5fY3VycmVudF93b3JkID0gMDtcbiAgICAgICAgdGhpcy5fY3VycmVudF93b3JkX2JpdHNfbGVmdCA9IDA7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKEV4cEdvbG9tYiwgW3tcbiAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgdGhpcy5fYnVmZmVyID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2ZpbGxDdXJyZW50V29yZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZmlsbEN1cnJlbnRXb3JkKCkge1xuICAgICAgICAgICAgdmFyIGJ1ZmZlcl9ieXRlc19sZWZ0ID0gdGhpcy5fdG90YWxfYnl0ZXMgLSB0aGlzLl9idWZmZXJfaW5kZXg7XG4gICAgICAgICAgICBpZiAoYnVmZmVyX2J5dGVzX2xlZnQgPD0gMCkgdGhyb3cgbmV3IF9leGNlcHRpb24uSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCdFeHBHb2xvbWI6IF9maWxsQ3VycmVudFdvcmQoKSBidXQgbm8gYnl0ZXMgYXZhaWxhYmxlJyk7XG5cbiAgICAgICAgICAgIHZhciBieXRlc19yZWFkID0gTWF0aC5taW4oNCwgYnVmZmVyX2J5dGVzX2xlZnQpO1xuICAgICAgICAgICAgdmFyIHdvcmQgPSBuZXcgVWludDhBcnJheSg0KTtcbiAgICAgICAgICAgIHdvcmQuc2V0KHRoaXMuX2J1ZmZlci5zdWJhcnJheSh0aGlzLl9idWZmZXJfaW5kZXgsIHRoaXMuX2J1ZmZlcl9pbmRleCArIGJ5dGVzX3JlYWQpKTtcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRfd29yZCA9IG5ldyBEYXRhVmlldyh3b3JkLmJ1ZmZlcikuZ2V0VWludDMyKDAsIGZhbHNlKTtcblxuICAgICAgICAgICAgdGhpcy5fYnVmZmVyX2luZGV4ICs9IGJ5dGVzX3JlYWQ7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50X3dvcmRfYml0c19sZWZ0ID0gYnl0ZXNfcmVhZCAqIDg7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlYWRCaXRzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlYWRCaXRzKGJpdHMpIHtcbiAgICAgICAgICAgIGlmIChiaXRzID4gMzIpIHRocm93IG5ldyBfZXhjZXB0aW9uLkludmFsaWRBcmd1bWVudEV4Y2VwdGlvbignRXhwR29sb21iOiByZWFkQml0cygpIGJpdHMgZXhjZWVkZWQgbWF4IDMyYml0cyEnKTtcblxuICAgICAgICAgICAgaWYgKGJpdHMgPD0gdGhpcy5fY3VycmVudF93b3JkX2JpdHNfbGVmdCkge1xuICAgICAgICAgICAgICAgIHZhciBfcmVzdWx0ID0gdGhpcy5fY3VycmVudF93b3JkID4+PiAzMiAtIGJpdHM7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudF93b3JkIDw8PSBiaXRzO1xuICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRfd29yZF9iaXRzX2xlZnQgLT0gYml0cztcbiAgICAgICAgICAgICAgICByZXR1cm4gX3Jlc3VsdDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuX2N1cnJlbnRfd29yZF9iaXRzX2xlZnQgPyB0aGlzLl9jdXJyZW50X3dvcmQgOiAwO1xuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0ID4+PiAzMiAtIHRoaXMuX2N1cnJlbnRfd29yZF9iaXRzX2xlZnQ7XG4gICAgICAgICAgICB2YXIgYml0c19uZWVkX2xlZnQgPSBiaXRzIC0gdGhpcy5fY3VycmVudF93b3JkX2JpdHNfbGVmdDtcblxuICAgICAgICAgICAgdGhpcy5fZmlsbEN1cnJlbnRXb3JkKCk7XG4gICAgICAgICAgICB2YXIgYml0c19yZWFkX25leHQgPSBNYXRoLm1pbihiaXRzX25lZWRfbGVmdCwgdGhpcy5fY3VycmVudF93b3JkX2JpdHNfbGVmdCk7XG5cbiAgICAgICAgICAgIHZhciByZXN1bHQyID0gdGhpcy5fY3VycmVudF93b3JkID4+PiAzMiAtIGJpdHNfcmVhZF9uZXh0O1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudF93b3JkIDw8PSBiaXRzX3JlYWRfbmV4dDtcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRfd29yZF9iaXRzX2xlZnQgLT0gYml0c19yZWFkX25leHQ7XG5cbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdCA8PCBiaXRzX3JlYWRfbmV4dCB8IHJlc3VsdDI7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZWFkQm9vbCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWFkQm9vbCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlYWRCaXRzKDEpID09PSAxO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZWFkQnl0ZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZWFkQnl0ZSgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlYWRCaXRzKDgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfc2tpcExlYWRpbmdaZXJvJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9za2lwTGVhZGluZ1plcm8oKSB7XG4gICAgICAgICAgICB2YXIgemVyb19jb3VudCA9IHZvaWQgMDtcbiAgICAgICAgICAgIGZvciAoemVyb19jb3VudCA9IDA7IHplcm9fY291bnQgPCB0aGlzLl9jdXJyZW50X3dvcmRfYml0c19sZWZ0OyB6ZXJvX2NvdW50KyspIHtcbiAgICAgICAgICAgICAgICBpZiAoMCAhPT0gKHRoaXMuX2N1cnJlbnRfd29yZCAmIDB4ODAwMDAwMDAgPj4+IHplcm9fY291bnQpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRfd29yZCA8PD0gemVyb19jb3VudDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudF93b3JkX2JpdHNfbGVmdCAtPSB6ZXJvX2NvdW50O1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gemVyb19jb3VudDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9maWxsQ3VycmVudFdvcmQoKTtcbiAgICAgICAgICAgIHJldHVybiB6ZXJvX2NvdW50ICsgdGhpcy5fc2tpcExlYWRpbmdaZXJvKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlYWRVRUcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVhZFVFRygpIHtcbiAgICAgICAgICAgIC8vIHVuc2lnbmVkIGV4cG9uZW50aWFsIGdvbG9tYlxuICAgICAgICAgICAgdmFyIGxlYWRpbmdfemVyb3MgPSB0aGlzLl9za2lwTGVhZGluZ1plcm8oKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlYWRCaXRzKGxlYWRpbmdfemVyb3MgKyAxKSAtIDE7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlYWRTRUcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVhZFNFRygpIHtcbiAgICAgICAgICAgIC8vIHNpZ25lZCBleHBvbmVudGlhbCBnb2xvbWJcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IHRoaXMucmVhZFVFRygpO1xuICAgICAgICAgICAgaWYgKHZhbHVlICYgMHgwMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZSArIDEgPj4+IDE7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiAtMSAqICh2YWx1ZSA+Pj4gMSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gRXhwR29sb21iO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBFeHBHb2xvbWI7XG5cbn0se1wiLi4vdXRpbHMvZXhjZXB0aW9uLmpzXCI6NDB9XSwxODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9sb2dnZXIgPSBfZGVyZXFfKCcuLi91dGlscy9sb2dnZXIuanMnKTtcblxudmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTtcblxudmFyIF9hbWZQYXJzZXIgPSBfZGVyZXFfKCcuL2FtZi1wYXJzZXIuanMnKTtcblxudmFyIF9hbWZQYXJzZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYW1mUGFyc2VyKTtcblxudmFyIF9zcHNQYXJzZXIgPSBfZGVyZXFfKCcuL3Nwcy1wYXJzZXIuanMnKTtcblxudmFyIF9zcHNQYXJzZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3BzUGFyc2VyKTtcblxudmFyIF9kZW11eEVycm9ycyA9IF9kZXJlcV8oJy4vZGVtdXgtZXJyb3JzLmpzJyk7XG5cbnZhciBfZGVtdXhFcnJvcnMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZGVtdXhFcnJvcnMpO1xuXG52YXIgX21lZGlhSW5mbyA9IF9kZXJlcV8oJy4uL2NvcmUvbWVkaWEtaW5mby5qcycpO1xuXG52YXIgX21lZGlhSW5mbzIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tZWRpYUluZm8pO1xuXG52YXIgX2V4Y2VwdGlvbiA9IF9kZXJlcV8oJy4uL3V0aWxzL2V4Y2VwdGlvbi5qcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBTd2FwMTYoc3JjKSB7XG4gICAgcmV0dXJuIHNyYyA+Pj4gOCAmIDB4RkYgfCAoc3JjICYgMHhGRikgPDwgODtcbn1cblxuZnVuY3Rpb24gU3dhcDMyKHNyYykge1xuICAgIHJldHVybiAoc3JjICYgMHhGRjAwMDAwMCkgPj4+IDI0IHwgKHNyYyAmIDB4MDBGRjAwMDApID4+PiA4IHwgKHNyYyAmIDB4MDAwMEZGMDApIDw8IDggfCAoc3JjICYgMHgwMDAwMDBGRikgPDwgMjQ7XG59XG5cbmZ1bmN0aW9uIFJlYWRCaWczMihhcnJheSwgaW5kZXgpIHtcbiAgICByZXR1cm4gYXJyYXlbaW5kZXhdIDw8IDI0IHwgYXJyYXlbaW5kZXggKyAxXSA8PCAxNiB8IGFycmF5W2luZGV4ICsgMl0gPDwgOCB8IGFycmF5W2luZGV4ICsgM107XG59XG5cbnZhciBGTFZEZW11eGVyID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEZMVkRlbXV4ZXIocHJvYmVEYXRhLCBjb25maWcpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEZMVkRlbXV4ZXIpO1xuXG4gICAgICAgIHRoaXMuVEFHID0gJ0ZMVkRlbXV4ZXInO1xuXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcblxuICAgICAgICB0aGlzLl9vbkVycm9yID0gbnVsbDtcbiAgICAgICAgdGhpcy5fb25NZWRpYUluZm8gPSBudWxsO1xuICAgICAgICB0aGlzLl9vbk1ldGFEYXRhQXJyaXZlZCA9IG51bGw7XG4gICAgICAgIHRoaXMuX29uU2NyaXB0RGF0YUFycml2ZWQgPSBudWxsO1xuICAgICAgICB0aGlzLl9vblRyYWNrTWV0YWRhdGEgPSBudWxsO1xuICAgICAgICB0aGlzLl9vbkRhdGFBdmFpbGFibGUgPSBudWxsO1xuICAgICAgICB0aGlzLl9vblN0cmVhbVRpbWUgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuX2RhdGFPZmZzZXQgPSBwcm9iZURhdGEuZGF0YU9mZnNldDtcbiAgICAgICAgdGhpcy5fZmlyc3RQYXJzZSA9IHRydWU7XG4gICAgICAgIHRoaXMuX2Rpc3BhdGNoID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5faGFzQXVkaW8gPSBwcm9iZURhdGEuaGFzQXVkaW9UcmFjaztcbiAgICAgICAgdGhpcy5faGFzVmlkZW8gPSBwcm9iZURhdGEuaGFzVmlkZW9UcmFjaztcblxuICAgICAgICB0aGlzLl9oYXNBdWRpb0ZsYWdPdmVycmlkZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5faGFzVmlkZW9GbGFnT3ZlcnJpZGVkID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5fYXVkaW9Jbml0aWFsTWV0YWRhdGFEaXNwYXRjaGVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3ZpZGVvSW5pdGlhbE1ldGFkYXRhRGlzcGF0Y2hlZCA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuX21lZGlhSW5mbyA9IG5ldyBfbWVkaWFJbmZvMi5kZWZhdWx0KCk7XG4gICAgICAgIHRoaXMuX21lZGlhSW5mby5oYXNBdWRpbyA9IHRoaXMuX2hhc0F1ZGlvO1xuICAgICAgICB0aGlzLl9tZWRpYUluZm8uaGFzVmlkZW8gPSB0aGlzLl9oYXNWaWRlbztcbiAgICAgICAgdGhpcy5fbWV0YWRhdGEgPSBudWxsO1xuICAgICAgICB0aGlzLl9hdWRpb01ldGFkYXRhID0gbnVsbDtcbiAgICAgICAgdGhpcy5fdmlkZW9NZXRhZGF0YSA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5fbmFsdUxlbmd0aFNpemUgPSA0O1xuICAgICAgICB0aGlzLl90aW1lc3RhbXBCYXNlID0gMDsgLy8gaW50MzIsIGluIG1pbGxpc2Vjb25kc1xuICAgICAgICB0aGlzLl90aW1lc2NhbGUgPSAxMDAwO1xuICAgICAgICB0aGlzLl9kdXJhdGlvbiA9IDA7IC8vIGludDMyLCBpbiBtaWxsaXNlY29uZHNcbiAgICAgICAgdGhpcy5fZHVyYXRpb25PdmVycmlkZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fcmVmZXJlbmNlRnJhbWVSYXRlID0ge1xuICAgICAgICAgICAgZml4ZWQ6IHRydWUsXG4gICAgICAgICAgICBmcHM6IDIzLjk3NixcbiAgICAgICAgICAgIGZwc19udW06IDIzOTc2LFxuICAgICAgICAgICAgZnBzX2RlbjogMTAwMFxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuX2ZsdlNvdW5kUmF0ZVRhYmxlID0gWzU1MDAsIDExMDI1LCAyMjA1MCwgNDQxMDAsIDQ4MDAwXTtcblxuICAgICAgICB0aGlzLl9tcGVnU2FtcGxpbmdSYXRlcyA9IFs5NjAwMCwgODgyMDAsIDY0MDAwLCA0ODAwMCwgNDQxMDAsIDMyMDAwLCAyNDAwMCwgMjIwNTAsIDE2MDAwLCAxMjAwMCwgMTEwMjUsIDgwMDAsIDczNTBdO1xuXG4gICAgICAgIHRoaXMuX21wZWdBdWRpb1YxMFNhbXBsZVJhdGVUYWJsZSA9IFs0NDEwMCwgNDgwMDAsIDMyMDAwLCAwXTtcbiAgICAgICAgdGhpcy5fbXBlZ0F1ZGlvVjIwU2FtcGxlUmF0ZVRhYmxlID0gWzIyMDUwLCAyNDAwMCwgMTYwMDAsIDBdO1xuICAgICAgICB0aGlzLl9tcGVnQXVkaW9WMjVTYW1wbGVSYXRlVGFibGUgPSBbMTEwMjUsIDEyMDAwLCA4MDAwLCAwXTtcblxuICAgICAgICB0aGlzLl9tcGVnQXVkaW9MMUJpdFJhdGVUYWJsZSA9IFswLCAzMiwgNjQsIDk2LCAxMjgsIDE2MCwgMTkyLCAyMjQsIDI1NiwgMjg4LCAzMjAsIDM1MiwgMzg0LCA0MTYsIDQ0OCwgLTFdO1xuICAgICAgICB0aGlzLl9tcGVnQXVkaW9MMkJpdFJhdGVUYWJsZSA9IFswLCAzMiwgNDgsIDU2LCA2NCwgODAsIDk2LCAxMTIsIDEyOCwgMTYwLCAxOTIsIDIyNCwgMjU2LCAzMjAsIDM4NCwgLTFdO1xuICAgICAgICB0aGlzLl9tcGVnQXVkaW9MM0JpdFJhdGVUYWJsZSA9IFswLCAzMiwgNDAsIDQ4LCA1NiwgNjQsIDgwLCA5NiwgMTEyLCAxMjgsIDE2MCwgMTkyLCAyMjQsIDI1NiwgMzIwLCAtMV07XG5cbiAgICAgICAgdGhpcy5fdmlkZW9UcmFjayA9IHsgdHlwZTogJ3ZpZGVvJywgaWQ6IDEsIHNlcXVlbmNlTnVtYmVyOiAwLCBzYW1wbGVzOiBbXSwgbGVuZ3RoOiAwIH07XG4gICAgICAgIHRoaXMuX2F1ZGlvVHJhY2sgPSB7IHR5cGU6ICdhdWRpbycsIGlkOiAyLCBzZXF1ZW5jZU51bWJlcjogMCwgc2FtcGxlczogW10sIGxlbmd0aDogMCB9O1xuXG4gICAgICAgIHRoaXMuX2xpdHRsZUVuZGlhbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBidWYgPSBuZXcgQXJyYXlCdWZmZXIoMik7XG4gICAgICAgICAgICBuZXcgRGF0YVZpZXcoYnVmKS5zZXRJbnQxNigwLCAyNTYsIHRydWUpOyAvLyBsaXR0bGUtZW5kaWFuIHdyaXRlXG4gICAgICAgICAgICByZXR1cm4gbmV3IEludDE2QXJyYXkoYnVmKVswXSA9PT0gMjU2OyAvLyBwbGF0Zm9ybS1zcGVjIHJlYWQsIGlmIGVxdWFsIHRoZW4gTEVcbiAgICAgICAgfSgpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhGTFZEZW11eGVyLCBbe1xuICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8gPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fbWV0YWRhdGEgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fYXVkaW9NZXRhZGF0YSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl92aWRlb01ldGFkYXRhID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX3ZpZGVvVHJhY2sgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fYXVkaW9UcmFjayA9IG51bGw7XG5cbiAgICAgICAgICAgIHRoaXMuX29uRXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25NZWRpYUluZm8gPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25NZXRhRGF0YUFycml2ZWQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25TY3JpcHREYXRhQXJyaXZlZCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vblRyYWNrTWV0YWRhdGEgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25EYXRhQXZhaWxhYmxlID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uU3RyZWFtVGltZSA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2JpbmREYXRhU291cmNlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGJpbmREYXRhU291cmNlKGxvYWRlcikge1xuICAgICAgICAgICAgbG9hZGVyLm9uRGF0YUFycml2YWwgPSB0aGlzLnBhcnNlQ2h1bmtzLmJpbmQodGhpcyk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHByb3RvdHlwZTogZnVuY3Rpb24odHlwZTogc3RyaW5nLCBtZXRhZGF0YTogYW55KTogdm9pZFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZXNldE1lZGlhSW5mbycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZXNldE1lZGlhSW5mbygpIHtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mbyA9IG5ldyBfbWVkaWFJbmZvMi5kZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19pc0luaXRpYWxNZXRhZGF0YURpc3BhdGNoZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2lzSW5pdGlhbE1ldGFkYXRhRGlzcGF0Y2hlZCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9oYXNBdWRpbyAmJiB0aGlzLl9oYXNWaWRlbykge1xuICAgICAgICAgICAgICAgIC8vIGJvdGggYXVkaW8gJiB2aWRlb1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9hdWRpb0luaXRpYWxNZXRhZGF0YURpc3BhdGNoZWQgJiYgdGhpcy5fdmlkZW9Jbml0aWFsTWV0YWRhdGFEaXNwYXRjaGVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX2hhc0F1ZGlvICYmICF0aGlzLl9oYXNWaWRlbykge1xuICAgICAgICAgICAgICAgIC8vIGF1ZGlvIG9ubHlcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fYXVkaW9Jbml0aWFsTWV0YWRhdGFEaXNwYXRjaGVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0aGlzLl9oYXNBdWRpbyAmJiB0aGlzLl9oYXNWaWRlbykge1xuICAgICAgICAgICAgICAgIC8vIHZpZGVvIG9ubHlcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fdmlkZW9Jbml0aWFsTWV0YWRhdGFEaXNwYXRjaGVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZnVuY3Rpb24gcGFyc2VDaHVua3MoY2h1bms6IEFycmF5QnVmZmVyLCBieXRlU3RhcnQ6IG51bWJlcik6IG51bWJlcjtcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncGFyc2VDaHVua3MnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGFyc2VDaHVua3MoY2h1bmssIGJ5dGVTdGFydCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9vbkVycm9yIHx8ICF0aGlzLl9vbk1lZGlhSW5mbyB8fCAhdGhpcy5fb25UcmFja01ldGFkYXRhIHx8ICF0aGlzLl9vbkRhdGFBdmFpbGFibGUpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbGxlZ2FsU3RhdGVFeGNlcHRpb24oJ0Zsdjogb25FcnJvciAmIG9uTWVkaWFJbmZvICYgb25UcmFja01ldGFkYXRhICYgb25EYXRhQXZhaWxhYmxlIGNhbGxiYWNrIG11c3QgYmUgc3BlY2lmaWVkJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBvZmZzZXQgPSAwO1xuICAgICAgICAgICAgdmFyIGxlID0gdGhpcy5fbGl0dGxlRW5kaWFuO1xuXG4gICAgICAgICAgICBpZiAoYnl0ZVN0YXJ0ID09PSAwKSB7XG4gICAgICAgICAgICAgICAgLy8gYnVmZmVyIHdpdGggRkxWIGhlYWRlclxuICAgICAgICAgICAgICAgIGlmIChjaHVuay5ieXRlTGVuZ3RoID4gMTMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb2JlRGF0YSA9IEZMVkRlbXV4ZXIucHJvYmUoY2h1bmspO1xuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgPSBwcm9iZURhdGEuZGF0YU9mZnNldDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9maXJzdFBhcnNlKSB7XG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIFByZXZpb3VzVGFnU2l6ZTAgYmVmb3JlIFRhZzFcbiAgICAgICAgICAgICAgICB0aGlzLl9maXJzdFBhcnNlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKGJ5dGVTdGFydCArIG9mZnNldCAhPT0gdGhpcy5fZGF0YU9mZnNldCkge1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdGaXJzdCB0aW1lIHBhcnNpbmcgYnV0IGNodW5rIGJ5dGVTdGFydCBpbnZhbGlkIScpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB2ID0gbmV3IERhdGFWaWV3KGNodW5rLCBvZmZzZXQpO1xuICAgICAgICAgICAgICAgIHZhciBwcmV2VGFnU2l6ZTAgPSB2LmdldFVpbnQzMigwLCAhbGUpO1xuICAgICAgICAgICAgICAgIGlmIChwcmV2VGFnU2l6ZTAgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnUHJldlRhZ1NpemUwICE9PSAwICEhIScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gNDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgd2hpbGUgKG9mZnNldCA8IGNodW5rLmJ5dGVMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXNwYXRjaCA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICB2YXIgX3YgPSBuZXcgRGF0YVZpZXcoY2h1bmssIG9mZnNldCk7XG5cbiAgICAgICAgICAgICAgICBpZiAob2Zmc2V0ICsgMTEgKyA0ID4gY2h1bmsuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBkYXRhIG5vdCBlbm91Z2ggZm9yIHBhcnNpbmcgYW4gZmx2IHRhZ1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdGFnVHlwZSA9IF92LmdldFVpbnQ4KDApO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhU2l6ZSA9IF92LmdldFVpbnQzMigwLCAhbGUpICYgMHgwMEZGRkZGRjtcblxuICAgICAgICAgICAgICAgIGlmIChvZmZzZXQgKyAxMSArIGRhdGFTaXplICsgNCA+IGNodW5rLmJ5dGVMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZGF0YSBub3QgZW5vdWdoIGZvciBwYXJzaW5nIGFjdHVhbCBkYXRhIGJvZHlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRhZ1R5cGUgIT09IDggJiYgdGFnVHlwZSAhPT0gOSAmJiB0YWdUeXBlICE9PSAxOCkge1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdVbnN1cHBvcnRlZCB0YWcgdHlwZSAnICsgdGFnVHlwZSArICcsIHNraXBwZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc3VtZSB0aGUgd2hvbGUgdGFnIChza2lwIGl0KVxuICAgICAgICAgICAgICAgICAgICBvZmZzZXQgKz0gMTEgKyBkYXRhU2l6ZSArIDQ7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB0czIgPSBfdi5nZXRVaW50OCg0KTtcbiAgICAgICAgICAgICAgICB2YXIgdHMxID0gX3YuZ2V0VWludDgoNSk7XG4gICAgICAgICAgICAgICAgdmFyIHRzMCA9IF92LmdldFVpbnQ4KDYpO1xuICAgICAgICAgICAgICAgIHZhciB0czMgPSBfdi5nZXRVaW50OCg3KTtcblxuICAgICAgICAgICAgICAgIHZhciB0aW1lc3RhbXAgPSB0czAgfCB0czEgPDwgOCB8IHRzMiA8PCAxNiB8IHRzMyA8PCAyNDtcblxuICAgICAgICAgICAgICAgIHZhciBzdHJlYW1JZCA9IF92LmdldFVpbnQzMig3LCAhbGUpICYgMHgwMEZGRkZGRjtcbiAgICAgICAgICAgICAgICBpZiAoc3RyZWFtSWQgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnTWVldCB0YWcgd2hpY2ggaGFzIFN0cmVhbUlEICE9IDAhJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGRhdGFPZmZzZXQgPSBvZmZzZXQgKyAxMTtcblxuICAgICAgICAgICAgICAgIHN3aXRjaCAodGFnVHlwZSkge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBBdWRpb1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGFyc2VBdWRpb0RhdGEoY2h1bmssIGRhdGFPZmZzZXQsIGRhdGFTaXplLCB0aW1lc3RhbXApO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgOTpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFZpZGVvXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25TdHJlYW1UaW1lICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vblN0cmVhbVRpbWUodGltZXN0YW1wKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3BhcnNlVmlkZW9EYXRhKGNodW5rLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSwgdGltZXN0YW1wLCBieXRlU3RhcnQgKyBvZmZzZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMTg6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTY3JpcHREYXRhT2JqZWN0XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9wYXJzZVNjcmlwdERhdGEoY2h1bmssIGRhdGFPZmZzZXQsIGRhdGFTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBwcmV2VGFnU2l6ZSA9IF92LmdldFVpbnQzMigxMSArIGRhdGFTaXplLCAhbGUpO1xuICAgICAgICAgICAgICAgIGlmIChwcmV2VGFnU2l6ZSAhPT0gMTEgKyBkYXRhU2l6ZSkge1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdJbnZhbGlkIFByZXZUYWdTaXplICcgKyBwcmV2VGFnU2l6ZSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgb2Zmc2V0ICs9IDExICsgZGF0YVNpemUgKyA0OyAvLyB0YWdCb2R5ICsgZGF0YVNpemUgKyBwcmV2VGFnU2l6ZVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBkaXNwYXRjaCBwYXJzZWQgZnJhbWVzIHRvIGNvbnN1bWVyICh0eXBpY2FsbHksIHRoZSByZW11eGVyKVxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzSW5pdGlhbE1ldGFkYXRhRGlzcGF0Y2hlZCgpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2Rpc3BhdGNoICYmICh0aGlzLl9hdWRpb1RyYWNrLmxlbmd0aCB8fCB0aGlzLl92aWRlb1RyYWNrLmxlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25EYXRhQXZhaWxhYmxlKHRoaXMuX2F1ZGlvVHJhY2ssIHRoaXMuX3ZpZGVvVHJhY2spO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG9mZnNldDsgLy8gY29uc3VtZWQgYnl0ZXMsIGp1c3QgZXF1YWxzIGxhdGVzdCBvZmZzZXQgaW5kZXhcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3BhcnNlU2NyaXB0RGF0YScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcGFyc2VTY3JpcHREYXRhKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSkge1xuICAgICAgICAgICAgdmFyIHNjcmlwdERhdGEgPSBfYW1mUGFyc2VyMi5kZWZhdWx0LnBhcnNlU2NyaXB0RGF0YShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpO1xuXG4gICAgICAgICAgICBpZiAoc2NyaXB0RGF0YS5oYXNPd25Qcm9wZXJ0eSgnb25NZXRhRGF0YScpKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNjcmlwdERhdGEub25NZXRhRGF0YSA9PSBudWxsIHx8IF90eXBlb2Yoc2NyaXB0RGF0YS5vbk1ldGFEYXRhKSAhPT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnSW52YWxpZCBvbk1ldGFEYXRhIHN0cnVjdHVyZSEnKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbWV0YWRhdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnRm91bmQgYW5vdGhlciBvbk1ldGFEYXRhIHRhZyEnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fbWV0YWRhdGEgPSBzY3JpcHREYXRhO1xuICAgICAgICAgICAgICAgIHZhciBvbk1ldGFEYXRhID0gdGhpcy5fbWV0YWRhdGEub25NZXRhRGF0YTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vbk1ldGFEYXRhQXJyaXZlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbk1ldGFEYXRhQXJyaXZlZChPYmplY3QuYXNzaWduKHt9LCBvbk1ldGFEYXRhKSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvbk1ldGFEYXRhLmhhc0F1ZGlvID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaGFzQXVkaW9cbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2hhc0F1ZGlvRmxhZ092ZXJyaWRlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhc0F1ZGlvID0gb25NZXRhRGF0YS5oYXNBdWRpbztcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5oYXNBdWRpbyA9IHRoaXMuX2hhc0F1ZGlvO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb25NZXRhRGF0YS5oYXNWaWRlbyA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGhhc1ZpZGVvXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9oYXNWaWRlb0ZsYWdPdmVycmlkZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9oYXNWaWRlbyA9IG9uTWV0YURhdGEuaGFzVmlkZW87XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uaGFzVmlkZW8gPSB0aGlzLl9oYXNWaWRlbztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9uTWV0YURhdGEuYXVkaW9kYXRhcmF0ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYXVkaW9kYXRhcmF0ZVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uYXVkaW9EYXRhUmF0ZSA9IG9uTWV0YURhdGEuYXVkaW9kYXRhcmF0ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvbk1ldGFEYXRhLnZpZGVvZGF0YXJhdGUgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHZpZGVvZGF0YXJhdGVcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLnZpZGVvRGF0YVJhdGUgPSBvbk1ldGFEYXRhLnZpZGVvZGF0YXJhdGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygb25NZXRhRGF0YS53aWR0aCA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gd2lkdGhcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLndpZHRoID0gb25NZXRhRGF0YS53aWR0aDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvbk1ldGFEYXRhLmhlaWdodCA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gaGVpZ2h0XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5oZWlnaHQgPSBvbk1ldGFEYXRhLmhlaWdodDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvbk1ldGFEYXRhLmR1cmF0aW9uID09PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBkdXJhdGlvblxuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2R1cmF0aW9uT3ZlcnJpZGVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZHVyYXRpb24gPSBNYXRoLmZsb29yKG9uTWV0YURhdGEuZHVyYXRpb24gKiB0aGlzLl90aW1lc2NhbGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZHVyYXRpb24gPSBkdXJhdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5kdXJhdGlvbiA9IGR1cmF0aW9uO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmR1cmF0aW9uID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvbk1ldGFEYXRhLmZyYW1lcmF0ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZnJhbWVyYXRlXG4gICAgICAgICAgICAgICAgICAgIHZhciBmcHNfbnVtID0gTWF0aC5mbG9vcihvbk1ldGFEYXRhLmZyYW1lcmF0ZSAqIDEwMDApO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZnBzX251bSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmcHMgPSBmcHNfbnVtIC8gMTAwMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlZmVyZW5jZUZyYW1lUmF0ZS5maXhlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZWZlcmVuY2VGcmFtZVJhdGUuZnBzID0gZnBzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVmZXJlbmNlRnJhbWVSYXRlLmZwc19udW0gPSBmcHNfbnVtO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVmZXJlbmNlRnJhbWVSYXRlLmZwc19kZW4gPSAxMDAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmZwcyA9IGZwcztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoX3R5cGVvZihvbk1ldGFEYXRhLmtleWZyYW1lcykgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGtleWZyYW1lc1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uaGFzS2V5ZnJhbWVzSW5kZXggPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB2YXIga2V5ZnJhbWVzID0gb25NZXRhRGF0YS5rZXlmcmFtZXM7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5rZXlmcmFtZXNJbmRleCA9IHRoaXMuX3BhcnNlS2V5ZnJhbWVzSW5kZXgoa2V5ZnJhbWVzKTtcbiAgICAgICAgICAgICAgICAgICAgb25NZXRhRGF0YS5rZXlmcmFtZXMgPSBudWxsOyAvLyBrZXlmcmFtZXMgaGFzIGJlZW4gZXh0cmFjdGVkLCByZW1vdmUgaXRcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uaGFzS2V5ZnJhbWVzSW5kZXggPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5fZGlzcGF0Y2ggPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8ubWV0YWRhdGEgPSBvbk1ldGFEYXRhO1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudih0aGlzLlRBRywgJ1BhcnNlZCBvbk1ldGFEYXRhJyk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhSW5mby5pc0NvbXBsZXRlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25NZWRpYUluZm8odGhpcy5fbWVkaWFJbmZvKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhzY3JpcHREYXRhKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uU2NyaXB0RGF0YUFycml2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25TY3JpcHREYXRhQXJyaXZlZChPYmplY3QuYXNzaWduKHt9LCBzY3JpcHREYXRhKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcGFyc2VLZXlmcmFtZXNJbmRleCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcGFyc2VLZXlmcmFtZXNJbmRleChrZXlmcmFtZXMpIHtcbiAgICAgICAgICAgIHZhciB0aW1lcyA9IFtdO1xuICAgICAgICAgICAgdmFyIGZpbGVwb3NpdGlvbnMgPSBbXTtcblxuICAgICAgICAgICAgLy8gaWdub3JlIGZpcnN0IGtleWZyYW1lIHdoaWNoIGlzIGFjdHVhbGx5IEFWQyBTZXF1ZW5jZSBIZWFkZXIgKEFWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkKVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBrZXlmcmFtZXMudGltZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGltZSA9IHRoaXMuX3RpbWVzdGFtcEJhc2UgKyBNYXRoLmZsb29yKGtleWZyYW1lcy50aW1lc1tpXSAqIDEwMDApO1xuICAgICAgICAgICAgICAgIHRpbWVzLnB1c2godGltZSk7XG4gICAgICAgICAgICAgICAgZmlsZXBvc2l0aW9ucy5wdXNoKGtleWZyYW1lcy5maWxlcG9zaXRpb25zW2ldKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB0aW1lczogdGltZXMsXG4gICAgICAgICAgICAgICAgZmlsZXBvc2l0aW9uczogZmlsZXBvc2l0aW9uc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3BhcnNlQXVkaW9EYXRhJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9wYXJzZUF1ZGlvRGF0YShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUsIHRhZ1RpbWVzdGFtcCkge1xuICAgICAgICAgICAgaWYgKGRhdGFTaXplIDw9IDEpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdGbHY6IEludmFsaWQgYXVkaW8gcGFja2V0LCBtaXNzaW5nIFNvdW5kRGF0YSBwYXlsb2FkIScpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX2hhc0F1ZGlvRmxhZ092ZXJyaWRlZCA9PT0gdHJ1ZSAmJiB0aGlzLl9oYXNBdWRpbyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiBoYXNBdWRpbzogZmFsc2UgaW5kaWNhdGVkIGV4cGxpY2l0bHkgaW4gTWVkaWFEYXRhU291cmNlLFxuICAgICAgICAgICAgICAgIC8vIElnbm9yZSBhbGwgdGhlIGF1ZGlvIHBhY2tldHNcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBsZSA9IHRoaXMuX2xpdHRsZUVuZGlhbjtcbiAgICAgICAgICAgIHZhciB2ID0gbmV3IERhdGFWaWV3KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSk7XG5cbiAgICAgICAgICAgIHZhciBzb3VuZFNwZWMgPSB2LmdldFVpbnQ4KDApO1xuXG4gICAgICAgICAgICB2YXIgc291bmRGb3JtYXQgPSBzb3VuZFNwZWMgPj4+IDQ7XG4gICAgICAgICAgICBpZiAoc291bmRGb3JtYXQgIT09IDIgJiYgc291bmRGb3JtYXQgIT09IDEwKSB7XG4gICAgICAgICAgICAgICAgLy8gTVAzIG9yIEFBQ1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoX2RlbXV4RXJyb3JzMi5kZWZhdWx0LkNPREVDX1VOU1VQUE9SVEVELCAnRmx2OiBVbnN1cHBvcnRlZCBhdWRpbyBjb2RlYyBpZHg6ICcgKyBzb3VuZEZvcm1hdCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc291bmRSYXRlID0gMDtcbiAgICAgICAgICAgIHZhciBzb3VuZFJhdGVJbmRleCA9IChzb3VuZFNwZWMgJiAxMikgPj4+IDI7XG4gICAgICAgICAgICBpZiAoc291bmRSYXRlSW5kZXggPj0gMCAmJiBzb3VuZFJhdGVJbmRleCA8PSA0KSB7XG4gICAgICAgICAgICAgICAgc291bmRSYXRlID0gdGhpcy5fZmx2U291bmRSYXRlVGFibGVbc291bmRSYXRlSW5kZXhdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKF9kZW11eEVycm9yczIuZGVmYXVsdC5GT1JNQVRfRVJST1IsICdGbHY6IEludmFsaWQgYXVkaW8gc2FtcGxlIHJhdGUgaWR4OiAnICsgc291bmRSYXRlSW5kZXgpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHNvdW5kU2l6ZSA9IChzb3VuZFNwZWMgJiAyKSA+Pj4gMTsgLy8gdW51c2VkXG4gICAgICAgICAgICB2YXIgc291bmRUeXBlID0gc291bmRTcGVjICYgMTtcblxuICAgICAgICAgICAgdmFyIG1ldGEgPSB0aGlzLl9hdWRpb01ldGFkYXRhO1xuICAgICAgICAgICAgdmFyIHRyYWNrID0gdGhpcy5fYXVkaW9UcmFjaztcblxuICAgICAgICAgICAgaWYgKCFtZXRhKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2hhc0F1ZGlvID09PSBmYWxzZSAmJiB0aGlzLl9oYXNBdWRpb0ZsYWdPdmVycmlkZWQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2hhc0F1ZGlvID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmhhc0F1ZGlvID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBpbml0aWFsIG1ldGFkYXRhXG4gICAgICAgICAgICAgICAgbWV0YSA9IHRoaXMuX2F1ZGlvTWV0YWRhdGEgPSB7fTtcbiAgICAgICAgICAgICAgICBtZXRhLnR5cGUgPSAnYXVkaW8nO1xuICAgICAgICAgICAgICAgIG1ldGEuaWQgPSB0cmFjay5pZDtcbiAgICAgICAgICAgICAgICBtZXRhLnRpbWVzY2FsZSA9IHRoaXMuX3RpbWVzY2FsZTtcbiAgICAgICAgICAgICAgICBtZXRhLmR1cmF0aW9uID0gdGhpcy5fZHVyYXRpb247XG4gICAgICAgICAgICAgICAgbWV0YS5hdWRpb1NhbXBsZVJhdGUgPSBzb3VuZFJhdGU7XG4gICAgICAgICAgICAgICAgbWV0YS5jaGFubmVsQ291bnQgPSBzb3VuZFR5cGUgPT09IDAgPyAxIDogMjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHNvdW5kRm9ybWF0ID09PSAxMCkge1xuICAgICAgICAgICAgICAgIC8vIEFBQ1xuICAgICAgICAgICAgICAgIHZhciBhYWNEYXRhID0gdGhpcy5fcGFyc2VBQUNBdWRpb0RhdGEoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyAxLCBkYXRhU2l6ZSAtIDEpO1xuICAgICAgICAgICAgICAgIGlmIChhYWNEYXRhID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGFhY0RhdGEucGFja2V0VHlwZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBBQUMgc2VxdWVuY2UgaGVhZGVyIChBdWRpb1NwZWNpZmljQ29uZmlnKVxuICAgICAgICAgICAgICAgICAgICBpZiAobWV0YS5jb25maWcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ0ZvdW5kIGFub3RoZXIgQXVkaW9TcGVjaWZpY0NvbmZpZyEnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB2YXIgbWlzYyA9IGFhY0RhdGEuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgbWV0YS5hdWRpb1NhbXBsZVJhdGUgPSBtaXNjLnNhbXBsaW5nUmF0ZTtcbiAgICAgICAgICAgICAgICAgICAgbWV0YS5jaGFubmVsQ291bnQgPSBtaXNjLmNoYW5uZWxDb3VudDtcbiAgICAgICAgICAgICAgICAgICAgbWV0YS5jb2RlYyA9IG1pc2MuY29kZWM7XG4gICAgICAgICAgICAgICAgICAgIG1ldGEub3JpZ2luYWxDb2RlYyA9IG1pc2Mub3JpZ2luYWxDb2RlYztcbiAgICAgICAgICAgICAgICAgICAgbWV0YS5jb25maWcgPSBtaXNjLmNvbmZpZztcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGRlY29kZSByZXN1bHQgb2YgYW4gYWFjIHNhbXBsZSBpcyAxMDI0IFBDTSBzYW1wbGVzXG4gICAgICAgICAgICAgICAgICAgIG1ldGEucmVmU2FtcGxlRHVyYXRpb24gPSAxMDI0IC8gbWV0YS5hdWRpb1NhbXBsZVJhdGUgKiBtZXRhLnRpbWVzY2FsZTtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KHRoaXMuVEFHLCAnUGFyc2VkIEF1ZGlvU3BlY2lmaWNDb25maWcnKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5faXNJbml0aWFsTWV0YWRhdGFEaXNwYXRjaGVkKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vbi1pbml0aWFsIG1ldGFkYXRhLCBmb3JjZSBkaXNwYXRjaCAob3IgZmx1c2gpIHBhcnNlZCBmcmFtZXMgdG8gcmVtdXhlclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2Rpc3BhdGNoICYmICh0aGlzLl9hdWRpb1RyYWNrLmxlbmd0aCB8fCB0aGlzLl92aWRlb1RyYWNrLmxlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkRhdGFBdmFpbGFibGUodGhpcy5fYXVkaW9UcmFjaywgdGhpcy5fdmlkZW9UcmFjayk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hdWRpb0luaXRpYWxNZXRhZGF0YURpc3BhdGNoZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZW4gbm90aWZ5IG5ldyBtZXRhZGF0YVxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kaXNwYXRjaCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vblRyYWNrTWV0YWRhdGEoJ2F1ZGlvJywgbWV0YSk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIG1pID0gdGhpcy5fbWVkaWFJbmZvO1xuICAgICAgICAgICAgICAgICAgICBtaS5hdWRpb0NvZGVjID0gbWV0YS5vcmlnaW5hbENvZGVjO1xuICAgICAgICAgICAgICAgICAgICBtaS5hdWRpb1NhbXBsZVJhdGUgPSBtZXRhLmF1ZGlvU2FtcGxlUmF0ZTtcbiAgICAgICAgICAgICAgICAgICAgbWkuYXVkaW9DaGFubmVsQ291bnQgPSBtZXRhLmNoYW5uZWxDb3VudDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1pLmhhc1ZpZGVvKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWkudmlkZW9Db2RlYyAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWkubWltZVR5cGUgPSAndmlkZW8veC1mbHY7IGNvZGVjcz1cIicgKyBtaS52aWRlb0NvZGVjICsgJywnICsgbWkuYXVkaW9Db2RlYyArICdcIic7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtaS5taW1lVHlwZSA9ICd2aWRlby94LWZsdjsgY29kZWNzPVwiJyArIG1pLmF1ZGlvQ29kZWMgKyAnXCInO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChtaS5pc0NvbXBsZXRlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uTWVkaWFJbmZvKG1pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYWFjRGF0YS5wYWNrZXRUeXBlID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFBQyByYXcgZnJhbWUgZGF0YVxuICAgICAgICAgICAgICAgICAgICB2YXIgZHRzID0gdGhpcy5fdGltZXN0YW1wQmFzZSArIHRhZ1RpbWVzdGFtcDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFhY1NhbXBsZSA9IHsgdW5pdDogYWFjRGF0YS5kYXRhLCBsZW5ndGg6IGFhY0RhdGEuZGF0YS5ieXRlTGVuZ3RoLCBkdHM6IGR0cywgcHRzOiBkdHMgfTtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2suc2FtcGxlcy5wdXNoKGFhY1NhbXBsZSk7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNrLmxlbmd0aCArPSBhYWNEYXRhLmRhdGEubGVuZ3RoO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZSh0aGlzLlRBRywgJ0ZsdjogVW5zdXBwb3J0ZWQgQUFDIGRhdGEgdHlwZSAnICsgYWFjRGF0YS5wYWNrZXRUeXBlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNvdW5kRm9ybWF0ID09PSAyKSB7XG4gICAgICAgICAgICAgICAgLy8gTVAzXG4gICAgICAgICAgICAgICAgaWYgKCFtZXRhLmNvZGVjKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgbWV0YWRhdGEgZm9yIG1wMyBhdWRpbyB0cmFjaywgZXh0cmFjdCBpbmZvIGZyb20gZnJhbWUgaGVhZGVyXG4gICAgICAgICAgICAgICAgICAgIHZhciBfbWlzYyA9IHRoaXMuX3BhcnNlTVAzQXVkaW9EYXRhKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgMSwgZGF0YVNpemUgLSAxLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9taXNjID09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG1ldGEuYXVkaW9TYW1wbGVSYXRlID0gX21pc2Muc2FtcGxpbmdSYXRlO1xuICAgICAgICAgICAgICAgICAgICBtZXRhLmNoYW5uZWxDb3VudCA9IF9taXNjLmNoYW5uZWxDb3VudDtcbiAgICAgICAgICAgICAgICAgICAgbWV0YS5jb2RlYyA9IF9taXNjLmNvZGVjO1xuICAgICAgICAgICAgICAgICAgICBtZXRhLm9yaWdpbmFsQ29kZWMgPSBfbWlzYy5vcmlnaW5hbENvZGVjO1xuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZGVjb2RlIHJlc3VsdCBvZiBhbiBtcDMgc2FtcGxlIGlzIDExNTIgUENNIHNhbXBsZXNcbiAgICAgICAgICAgICAgICAgICAgbWV0YS5yZWZTYW1wbGVEdXJhdGlvbiA9IDExNTIgLyBtZXRhLmF1ZGlvU2FtcGxlUmF0ZSAqIG1ldGEudGltZXNjYWxlO1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYodGhpcy5UQUcsICdQYXJzZWQgTVBFRyBBdWRpbyBGcmFtZSBIZWFkZXInKTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hdWRpb0luaXRpYWxNZXRhZGF0YURpc3BhdGNoZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vblRyYWNrTWV0YWRhdGEoJ2F1ZGlvJywgbWV0YSk7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIF9taSA9IHRoaXMuX21lZGlhSW5mbztcbiAgICAgICAgICAgICAgICAgICAgX21pLmF1ZGlvQ29kZWMgPSBtZXRhLmNvZGVjO1xuICAgICAgICAgICAgICAgICAgICBfbWkuYXVkaW9TYW1wbGVSYXRlID0gbWV0YS5hdWRpb1NhbXBsZVJhdGU7XG4gICAgICAgICAgICAgICAgICAgIF9taS5hdWRpb0NoYW5uZWxDb3VudCA9IG1ldGEuY2hhbm5lbENvdW50O1xuICAgICAgICAgICAgICAgICAgICBfbWkuYXVkaW9EYXRhUmF0ZSA9IF9taXNjLmJpdFJhdGU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfbWkuaGFzVmlkZW8pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfbWkudmlkZW9Db2RlYyAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX21pLm1pbWVUeXBlID0gJ3ZpZGVvL3gtZmx2OyBjb2RlY3M9XCInICsgX21pLnZpZGVvQ29kZWMgKyAnLCcgKyBfbWkuYXVkaW9Db2RlYyArICdcIic7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfbWkubWltZVR5cGUgPSAndmlkZW8veC1mbHY7IGNvZGVjcz1cIicgKyBfbWkuYXVkaW9Db2RlYyArICdcIic7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaWYgKF9taS5pc0NvbXBsZXRlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uTWVkaWFJbmZvKF9taSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBUaGlzIHBhY2tldCBpcyBhbHdheXMgYSB2YWxpZCBhdWRpbyBwYWNrZXQsIGV4dHJhY3QgaXRcbiAgICAgICAgICAgICAgICB2YXIgZGF0YSA9IHRoaXMuX3BhcnNlTVAzQXVkaW9EYXRhKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgMSwgZGF0YVNpemUgLSAxLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgaWYgKGRhdGEgPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIF9kdHMgPSB0aGlzLl90aW1lc3RhbXBCYXNlICsgdGFnVGltZXN0YW1wO1xuICAgICAgICAgICAgICAgIHZhciBtcDNTYW1wbGUgPSB7IHVuaXQ6IGRhdGEsIGxlbmd0aDogZGF0YS5ieXRlTGVuZ3RoLCBkdHM6IF9kdHMsIHB0czogX2R0cyB9O1xuICAgICAgICAgICAgICAgIHRyYWNrLnNhbXBsZXMucHVzaChtcDNTYW1wbGUpO1xuICAgICAgICAgICAgICAgIHRyYWNrLmxlbmd0aCArPSBkYXRhLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3BhcnNlQUFDQXVkaW9EYXRhJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9wYXJzZUFBQ0F1ZGlvRGF0YShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpIHtcbiAgICAgICAgICAgIGlmIChkYXRhU2l6ZSA8PSAxKSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnRmx2OiBJbnZhbGlkIEFBQyBwYWNrZXQsIG1pc3NpbmcgQUFDUGFja2V0VHlwZSBvci9hbmQgRGF0YSEnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB7fTtcbiAgICAgICAgICAgIHZhciBhcnJheSA9IG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSk7XG5cbiAgICAgICAgICAgIHJlc3VsdC5wYWNrZXRUeXBlID0gYXJyYXlbMF07XG5cbiAgICAgICAgICAgIGlmIChhcnJheVswXSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHJlc3VsdC5kYXRhID0gdGhpcy5fcGFyc2VBQUNBdWRpb1NwZWNpZmljQ29uZmlnKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgMSwgZGF0YVNpemUgLSAxKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LmRhdGEgPSBhcnJheS5zdWJhcnJheSgxKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3BhcnNlQUFDQXVkaW9TcGVjaWZpY0NvbmZpZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcGFyc2VBQUNBdWRpb1NwZWNpZmljQ29uZmlnKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSkge1xuICAgICAgICAgICAgdmFyIGFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKTtcbiAgICAgICAgICAgIHZhciBjb25maWcgPSBudWxsO1xuXG4gICAgICAgICAgICAvKiBBdWRpbyBPYmplY3QgVHlwZTpcclxuICAgICAgICAgICAgICAgMDogTnVsbFxyXG4gICAgICAgICAgICAgICAxOiBBQUMgTWFpblxyXG4gICAgICAgICAgICAgICAyOiBBQUMgTENcclxuICAgICAgICAgICAgICAgMzogQUFDIFNTUiAoU2NhbGFibGUgU2FtcGxlIFJhdGUpXHJcbiAgICAgICAgICAgICAgIDQ6IEFBQyBMVFAgKExvbmcgVGVybSBQcmVkaWN0aW9uKVxyXG4gICAgICAgICAgICAgICA1OiBIRS1BQUMgLyBTQlIgKFNwZWN0cmFsIEJhbmQgUmVwbGljYXRpb24pXHJcbiAgICAgICAgICAgICAgIDY6IEFBQyBTY2FsYWJsZVxyXG4gICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB2YXIgYXVkaW9PYmplY3RUeXBlID0gMDtcbiAgICAgICAgICAgIHZhciBvcmlnaW5hbEF1ZGlvT2JqZWN0VHlwZSA9IDA7XG4gICAgICAgICAgICB2YXIgYXVkaW9FeHRlbnNpb25PYmplY3RUeXBlID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBzYW1wbGluZ0luZGV4ID0gMDtcbiAgICAgICAgICAgIHZhciBleHRlbnNpb25TYW1wbGluZ0luZGV4ID0gbnVsbDtcblxuICAgICAgICAgICAgLy8gNSBiaXRzXG4gICAgICAgICAgICBhdWRpb09iamVjdFR5cGUgPSBvcmlnaW5hbEF1ZGlvT2JqZWN0VHlwZSA9IGFycmF5WzBdID4+PiAzO1xuICAgICAgICAgICAgLy8gNCBiaXRzXG4gICAgICAgICAgICBzYW1wbGluZ0luZGV4ID0gKGFycmF5WzBdICYgMHgwNykgPDwgMSB8IGFycmF5WzFdID4+PiA3O1xuICAgICAgICAgICAgaWYgKHNhbXBsaW5nSW5kZXggPCAwIHx8IHNhbXBsaW5nSW5kZXggPj0gdGhpcy5fbXBlZ1NhbXBsaW5nUmF0ZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcihfZGVtdXhFcnJvcnMyLmRlZmF1bHQuRk9STUFUX0VSUk9SLCAnRmx2OiBBQUMgaW52YWxpZCBzYW1wbGluZyBmcmVxdWVuY3kgaW5kZXghJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc2FtcGxpbmdGcmVxdWVuY2UgPSB0aGlzLl9tcGVnU2FtcGxpbmdSYXRlc1tzYW1wbGluZ0luZGV4XTtcblxuICAgICAgICAgICAgLy8gNCBiaXRzXG4gICAgICAgICAgICB2YXIgY2hhbm5lbENvbmZpZyA9IChhcnJheVsxXSAmIDB4NzgpID4+PiAzO1xuICAgICAgICAgICAgaWYgKGNoYW5uZWxDb25maWcgPCAwIHx8IGNoYW5uZWxDb25maWcgPj0gOCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoX2RlbXV4RXJyb3JzMi5kZWZhdWx0LkZPUk1BVF9FUlJPUiwgJ0ZsdjogQUFDIGludmFsaWQgY2hhbm5lbCBjb25maWd1cmF0aW9uJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoYXVkaW9PYmplY3RUeXBlID09PSA1KSB7XG4gICAgICAgICAgICAgICAgLy8gSEUtQUFDP1xuICAgICAgICAgICAgICAgIC8vIDQgYml0c1xuICAgICAgICAgICAgICAgIGV4dGVuc2lvblNhbXBsaW5nSW5kZXggPSAoYXJyYXlbMV0gJiAweDA3KSA8PCAxIHwgYXJyYXlbMl0gPj4+IDc7XG4gICAgICAgICAgICAgICAgLy8gNSBiaXRzXG4gICAgICAgICAgICAgICAgYXVkaW9FeHRlbnNpb25PYmplY3RUeXBlID0gKGFycmF5WzJdICYgMHg3QykgPj4+IDI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHdvcmthcm91bmRzIGZvciB2YXJpb3VzIGJyb3dzZXJzXG4gICAgICAgICAgICB2YXIgdXNlckFnZW50ID0gc2VsZi5uYXZpZ2F0b3IudXNlckFnZW50LnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgICAgIGlmICh1c2VyQWdlbnQuaW5kZXhPZignZmlyZWZveCcpICE9PSAtMSkge1xuICAgICAgICAgICAgICAgIC8vIGZpcmVmb3g6IHVzZSBTQlIgKEhFLUFBQykgaWYgZnJlcSBsZXNzIHRoYW4gMjRrSHpcbiAgICAgICAgICAgICAgICBpZiAoc2FtcGxpbmdJbmRleCA+PSA2KSB7XG4gICAgICAgICAgICAgICAgICAgIGF1ZGlvT2JqZWN0VHlwZSA9IDU7XG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZyA9IG5ldyBBcnJheSg0KTtcbiAgICAgICAgICAgICAgICAgICAgZXh0ZW5zaW9uU2FtcGxpbmdJbmRleCA9IHNhbXBsaW5nSW5kZXggLSAzO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHVzZSBMQy1BQUNcbiAgICAgICAgICAgICAgICAgICAgYXVkaW9PYmplY3RUeXBlID0gMjtcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnID0gbmV3IEFycmF5KDIpO1xuICAgICAgICAgICAgICAgICAgICBleHRlbnNpb25TYW1wbGluZ0luZGV4ID0gc2FtcGxpbmdJbmRleDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHVzZXJBZ2VudC5pbmRleE9mKCdhbmRyb2lkJykgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgLy8gYW5kcm9pZDogYWx3YXlzIHVzZSBMQy1BQUNcbiAgICAgICAgICAgICAgICBhdWRpb09iamVjdFR5cGUgPSAyO1xuICAgICAgICAgICAgICAgIGNvbmZpZyA9IG5ldyBBcnJheSgyKTtcbiAgICAgICAgICAgICAgICBleHRlbnNpb25TYW1wbGluZ0luZGV4ID0gc2FtcGxpbmdJbmRleDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gZm9yIG90aGVyIGJyb3dzZXJzLCBlLmcuIGNocm9tZS4uLlxuICAgICAgICAgICAgICAgIC8vIEFsd2F5cyB1c2UgSEUtQUFDIHRvIG1ha2UgaXQgZWFzaWVyIHRvIHN3aXRjaCBhYWMgY29kZWMgcHJvZmlsZVxuICAgICAgICAgICAgICAgIGF1ZGlvT2JqZWN0VHlwZSA9IDU7XG4gICAgICAgICAgICAgICAgZXh0ZW5zaW9uU2FtcGxpbmdJbmRleCA9IHNhbXBsaW5nSW5kZXg7XG4gICAgICAgICAgICAgICAgY29uZmlnID0gbmV3IEFycmF5KDQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHNhbXBsaW5nSW5kZXggPj0gNikge1xuICAgICAgICAgICAgICAgICAgICBleHRlbnNpb25TYW1wbGluZ0luZGV4ID0gc2FtcGxpbmdJbmRleCAtIDM7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFubmVsQ29uZmlnID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIE1vbm8gY2hhbm5lbFxuICAgICAgICAgICAgICAgICAgICBhdWRpb09iamVjdFR5cGUgPSAyO1xuICAgICAgICAgICAgICAgICAgICBjb25maWcgPSBuZXcgQXJyYXkoMik7XG4gICAgICAgICAgICAgICAgICAgIGV4dGVuc2lvblNhbXBsaW5nSW5kZXggPSBzYW1wbGluZ0luZGV4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uZmlnWzBdID0gYXVkaW9PYmplY3RUeXBlIDw8IDM7XG4gICAgICAgICAgICBjb25maWdbMF0gfD0gKHNhbXBsaW5nSW5kZXggJiAweDBGKSA+Pj4gMTtcbiAgICAgICAgICAgIGNvbmZpZ1sxXSA9IChzYW1wbGluZ0luZGV4ICYgMHgwRikgPDwgNztcbiAgICAgICAgICAgIGNvbmZpZ1sxXSB8PSAoY2hhbm5lbENvbmZpZyAmIDB4MEYpIDw8IDM7XG4gICAgICAgICAgICBpZiAoYXVkaW9PYmplY3RUeXBlID09PSA1KSB7XG4gICAgICAgICAgICAgICAgY29uZmlnWzFdIHw9IChleHRlbnNpb25TYW1wbGluZ0luZGV4ICYgMHgwRikgPj4+IDE7XG4gICAgICAgICAgICAgICAgY29uZmlnWzJdID0gKGV4dGVuc2lvblNhbXBsaW5nSW5kZXggJiAweDAxKSA8PCA3O1xuICAgICAgICAgICAgICAgIC8vIGV4dGVuZGVkIGF1ZGlvIG9iamVjdCB0eXBlOiBmb3JjZSB0byAyIChMQy1BQUMpXG4gICAgICAgICAgICAgICAgY29uZmlnWzJdIHw9IDIgPDwgMjtcbiAgICAgICAgICAgICAgICBjb25maWdbM10gPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGNvbmZpZzogY29uZmlnLFxuICAgICAgICAgICAgICAgIHNhbXBsaW5nUmF0ZTogc2FtcGxpbmdGcmVxdWVuY2UsXG4gICAgICAgICAgICAgICAgY2hhbm5lbENvdW50OiBjaGFubmVsQ29uZmlnLFxuICAgICAgICAgICAgICAgIGNvZGVjOiAnbXA0YS40MC4nICsgYXVkaW9PYmplY3RUeXBlLFxuICAgICAgICAgICAgICAgIG9yaWdpbmFsQ29kZWM6ICdtcDRhLjQwLicgKyBvcmlnaW5hbEF1ZGlvT2JqZWN0VHlwZVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3BhcnNlTVAzQXVkaW9EYXRhJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9wYXJzZU1QM0F1ZGlvRGF0YShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUsIHJlcXVlc3RIZWFkZXIpIHtcbiAgICAgICAgICAgIGlmIChkYXRhU2l6ZSA8IDQpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdGbHY6IEludmFsaWQgTVAzIHBhY2tldCwgaGVhZGVyIG1pc3NpbmchJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbGUgPSB0aGlzLl9saXR0bGVFbmRpYW47XG4gICAgICAgICAgICB2YXIgYXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmIChyZXF1ZXN0SGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgaWYgKGFycmF5WzBdICE9PSAweEZGKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdmFyIHZlciA9IGFycmF5WzFdID4+PiAzICYgMHgwMztcbiAgICAgICAgICAgICAgICB2YXIgbGF5ZXIgPSAoYXJyYXlbMV0gJiAweDA2KSA+PiAxO1xuXG4gICAgICAgICAgICAgICAgdmFyIGJpdHJhdGVfaW5kZXggPSAoYXJyYXlbMl0gJiAweEYwKSA+Pj4gNDtcbiAgICAgICAgICAgICAgICB2YXIgc2FtcGxpbmdfZnJlcV9pbmRleCA9IChhcnJheVsyXSAmIDB4MEMpID4+PiAyO1xuXG4gICAgICAgICAgICAgICAgdmFyIGNoYW5uZWxfbW9kZSA9IGFycmF5WzNdID4+PiA2ICYgMHgwMztcbiAgICAgICAgICAgICAgICB2YXIgY2hhbm5lbF9jb3VudCA9IGNoYW5uZWxfbW9kZSAhPT0gMyA/IDIgOiAxO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNhbXBsZV9yYXRlID0gMDtcbiAgICAgICAgICAgICAgICB2YXIgYml0X3JhdGUgPSAwO1xuICAgICAgICAgICAgICAgIHZhciBvYmplY3RfdHlwZSA9IDM0OyAvLyBMYXllci0zLCBsaXN0ZWQgaW4gTVBFRy00IEF1ZGlvIE9iamVjdCBUeXBlc1xuXG4gICAgICAgICAgICAgICAgdmFyIGNvZGVjID0gJ21wMyc7XG5cbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHZlcikge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBNUEVHIDIuNVxuICAgICAgICAgICAgICAgICAgICAgICAgc2FtcGxlX3JhdGUgPSB0aGlzLl9tcGVnQXVkaW9WMjVTYW1wbGVSYXRlVGFibGVbc2FtcGxpbmdfZnJlcV9pbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTVBFRyAyXG4gICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVfcmF0ZSA9IHRoaXMuX21wZWdBdWRpb1YyMFNhbXBsZVJhdGVUYWJsZVtzYW1wbGluZ19mcmVxX2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBNUEVHIDFcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhbXBsZV9yYXRlID0gdGhpcy5fbXBlZ0F1ZGlvVjEwU2FtcGxlUmF0ZVRhYmxlW3NhbXBsaW5nX2ZyZXFfaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc3dpdGNoIChsYXllcikge1xuICAgICAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBMYXllciAzXG4gICAgICAgICAgICAgICAgICAgICAgICBvYmplY3RfdHlwZSA9IDM0O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpdHJhdGVfaW5kZXggPCB0aGlzLl9tcGVnQXVkaW9MM0JpdFJhdGVUYWJsZS5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRfcmF0ZSA9IHRoaXMuX21wZWdBdWRpb0wzQml0UmF0ZVRhYmxlW2JpdHJhdGVfaW5kZXhdO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIExheWVyIDJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9iamVjdF90eXBlID0gMzM7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYml0cmF0ZV9pbmRleCA8IHRoaXMuX21wZWdBdWRpb0wyQml0UmF0ZVRhYmxlLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdF9yYXRlID0gdGhpcy5fbXBlZ0F1ZGlvTDJCaXRSYXRlVGFibGVbYml0cmF0ZV9pbmRleF07XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTGF5ZXIgMVxuICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0X3R5cGUgPSAzMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXRyYXRlX2luZGV4IDwgdGhpcy5fbXBlZ0F1ZGlvTDFCaXRSYXRlVGFibGUubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYml0X3JhdGUgPSB0aGlzLl9tcGVnQXVkaW9MMUJpdFJhdGVUYWJsZVtiaXRyYXRlX2luZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcbiAgICAgICAgICAgICAgICAgICAgYml0UmF0ZTogYml0X3JhdGUsXG4gICAgICAgICAgICAgICAgICAgIHNhbXBsaW5nUmF0ZTogc2FtcGxlX3JhdGUsXG4gICAgICAgICAgICAgICAgICAgIGNoYW5uZWxDb3VudDogY2hhbm5lbF9jb3VudCxcbiAgICAgICAgICAgICAgICAgICAgY29kZWM6IGNvZGVjLFxuICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbENvZGVjOiBjb2RlY1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IGFycmF5O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcGFyc2VWaWRlb0RhdGEnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3BhcnNlVmlkZW9EYXRhKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSwgdGFnVGltZXN0YW1wLCB0YWdQb3NpdGlvbikge1xuICAgICAgICAgICAgaWYgKGRhdGFTaXplIDw9IDEpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdGbHY6IEludmFsaWQgdmlkZW8gcGFja2V0LCBtaXNzaW5nIFZpZGVvRGF0YSBwYXlsb2FkIScpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX2hhc1ZpZGVvRmxhZ092ZXJyaWRlZCA9PT0gdHJ1ZSAmJiB0aGlzLl9oYXNWaWRlbyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAvLyBJZiBoYXNWaWRlbzogZmFsc2UgaW5kaWNhdGVkIGV4cGxpY2l0bHkgaW4gTWVkaWFEYXRhU291cmNlLFxuICAgICAgICAgICAgICAgIC8vIElnbm9yZSBhbGwgdGhlIHZpZGVvIHBhY2tldHNcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzcGVjID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKVswXTtcblxuICAgICAgICAgICAgdmFyIGZyYW1lVHlwZSA9IChzcGVjICYgMjQwKSA+Pj4gNDtcbiAgICAgICAgICAgIHZhciBjb2RlY0lkID0gc3BlYyAmIDE1O1xuXG4gICAgICAgICAgICBpZiAoY29kZWNJZCAhPT0gNykge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoX2RlbXV4RXJyb3JzMi5kZWZhdWx0LkNPREVDX1VOU1VQUE9SVEVELCAnRmx2OiBVbnN1cHBvcnRlZCBjb2RlYyBpbiB2aWRlbyBmcmFtZTogJyArIGNvZGVjSWQpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fcGFyc2VBVkNWaWRlb1BhY2tldChhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCArIDEsIGRhdGFTaXplIC0gMSwgdGFnVGltZXN0YW1wLCB0YWdQb3NpdGlvbiwgZnJhbWVUeXBlKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3BhcnNlQVZDVmlkZW9QYWNrZXQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3BhcnNlQVZDVmlkZW9QYWNrZXQoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplLCB0YWdUaW1lc3RhbXAsIHRhZ1Bvc2l0aW9uLCBmcmFtZVR5cGUpIHtcbiAgICAgICAgICAgIGlmIChkYXRhU2l6ZSA8IDQpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdGbHY6IEludmFsaWQgQVZDIHBhY2tldCwgbWlzc2luZyBBVkNQYWNrZXRUeXBlIG9yL2FuZCBDb21wb3NpdGlvblRpbWUnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBsZSA9IHRoaXMuX2xpdHRsZUVuZGlhbjtcbiAgICAgICAgICAgIHZhciB2ID0gbmV3IERhdGFWaWV3KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0LCBkYXRhU2l6ZSk7XG5cbiAgICAgICAgICAgIHZhciBwYWNrZXRUeXBlID0gdi5nZXRVaW50OCgwKTtcbiAgICAgICAgICAgIHZhciBjdHNfdW5zaWduZWQgPSB2LmdldFVpbnQzMigwLCAhbGUpICYgMHgwMEZGRkZGRjtcbiAgICAgICAgICAgIHZhciBjdHMgPSBjdHNfdW5zaWduZWQgPDwgOCA+PiA4OyAvLyBjb252ZXJ0IHRvIDI0LWJpdCBzaWduZWQgaW50XG5cbiAgICAgICAgICAgIGlmIChwYWNrZXRUeXBlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgLy8gQVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmRcbiAgICAgICAgICAgICAgICB0aGlzLl9wYXJzZUFWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkKGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgNCwgZGF0YVNpemUgLSA0KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGFja2V0VHlwZSA9PT0gMSkge1xuICAgICAgICAgICAgICAgIC8vIE9uZSBvciBtb3JlIE5hbHVzXG4gICAgICAgICAgICAgICAgdGhpcy5fcGFyc2VBVkNWaWRlb0RhdGEoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyA0LCBkYXRhU2l6ZSAtIDQsIHRhZ1RpbWVzdGFtcCwgdGFnUG9zaXRpb24sIGZyYW1lVHlwZSwgY3RzKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGFja2V0VHlwZSA9PT0gMikge1xuICAgICAgICAgICAgICAgIC8vIGVtcHR5LCBBVkMgZW5kIG9mIHNlcXVlbmNlXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoX2RlbXV4RXJyb3JzMi5kZWZhdWx0LkZPUk1BVF9FUlJPUiwgJ0ZsdjogSW52YWxpZCB2aWRlbyBwYWNrZXQgdHlwZSAnICsgcGFja2V0VHlwZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcGFyc2VBVkNEZWNvZGVyQ29uZmlndXJhdGlvblJlY29yZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcGFyc2VBVkNEZWNvZGVyQ29uZmlndXJhdGlvblJlY29yZChhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpIHtcbiAgICAgICAgICAgIGlmIChkYXRhU2l6ZSA8IDcpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdGbHY6IEludmFsaWQgQVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQsIGxhY2sgb2YgZGF0YSEnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBtZXRhID0gdGhpcy5fdmlkZW9NZXRhZGF0YTtcbiAgICAgICAgICAgIHZhciB0cmFjayA9IHRoaXMuX3ZpZGVvVHJhY2s7XG4gICAgICAgICAgICB2YXIgbGUgPSB0aGlzLl9saXR0bGVFbmRpYW47XG4gICAgICAgICAgICB2YXIgdiA9IG5ldyBEYXRhVmlldyhhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpO1xuXG4gICAgICAgICAgICBpZiAoIW1ldGEpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5faGFzVmlkZW8gPT09IGZhbHNlICYmIHRoaXMuX2hhc1ZpZGVvRmxhZ092ZXJyaWRlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5faGFzVmlkZW8gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uaGFzVmlkZW8gPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG1ldGEgPSB0aGlzLl92aWRlb01ldGFkYXRhID0ge307XG4gICAgICAgICAgICAgICAgbWV0YS50eXBlID0gJ3ZpZGVvJztcbiAgICAgICAgICAgICAgICBtZXRhLmlkID0gdHJhY2suaWQ7XG4gICAgICAgICAgICAgICAgbWV0YS50aW1lc2NhbGUgPSB0aGlzLl90aW1lc2NhbGU7XG4gICAgICAgICAgICAgICAgbWV0YS5kdXJhdGlvbiA9IHRoaXMuX2R1cmF0aW9uO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG1ldGEuYXZjYyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnRm91bmQgYW5vdGhlciBBVkNEZWNvZGVyQ29uZmlndXJhdGlvblJlY29yZCEnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciB2ZXJzaW9uID0gdi5nZXRVaW50OCgwKTsgLy8gY29uZmlndXJhdGlvblZlcnNpb25cbiAgICAgICAgICAgIHZhciBhdmNQcm9maWxlID0gdi5nZXRVaW50OCgxKTsgLy8gYXZjUHJvZmlsZUluZGljYXRpb25cbiAgICAgICAgICAgIHZhciBwcm9maWxlQ29tcGF0aWJpbGl0eSA9IHYuZ2V0VWludDgoMik7IC8vIHByb2ZpbGVfY29tcGF0aWJpbGl0eVxuICAgICAgICAgICAgdmFyIGF2Y0xldmVsID0gdi5nZXRVaW50OCgzKTsgLy8gQVZDTGV2ZWxJbmRpY2F0aW9uXG5cbiAgICAgICAgICAgIGlmICh2ZXJzaW9uICE9PSAxIHx8IGF2Y1Byb2ZpbGUgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKF9kZW11eEVycm9yczIuZGVmYXVsdC5GT1JNQVRfRVJST1IsICdGbHY6IEludmFsaWQgQVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX25hbHVMZW5ndGhTaXplID0gKHYuZ2V0VWludDgoNCkgJiAzKSArIDE7IC8vIGxlbmd0aFNpemVNaW51c09uZVxuICAgICAgICAgICAgaWYgKHRoaXMuX25hbHVMZW5ndGhTaXplICE9PSAzICYmIHRoaXMuX25hbHVMZW5ndGhTaXplICE9PSA0KSB7XG4gICAgICAgICAgICAgICAgLy8gaG9seSBzaGl0ISEhXG4gICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcihfZGVtdXhFcnJvcnMyLmRlZmF1bHQuRk9STUFUX0VSUk9SLCAnRmx2OiBTdHJhbmdlIE5hbHVMZW5ndGhTaXplTWludXNPbmU6ICcgKyAodGhpcy5fbmFsdUxlbmd0aFNpemUgLSAxKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc3BzQ291bnQgPSB2LmdldFVpbnQ4KDUpICYgMzE7IC8vIG51bU9mU2VxdWVuY2VQYXJhbWV0ZXJTZXRzXG4gICAgICAgICAgICBpZiAoc3BzQ291bnQgPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKF9kZW11eEVycm9yczIuZGVmYXVsdC5GT1JNQVRfRVJST1IsICdGbHY6IEludmFsaWQgQVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQ6IE5vIFNQUycpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3BzQ291bnQgPiAxKSB7XG4gICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnRmx2OiBTdHJhbmdlIEFWQ0RlY29kZXJDb25maWd1cmF0aW9uUmVjb3JkOiBTUFMgQ291bnQgPSAnICsgc3BzQ291bnQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gNjtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzcHNDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGxlbiA9IHYuZ2V0VWludDE2KG9mZnNldCwgIWxlKTsgLy8gc2VxdWVuY2VQYXJhbWV0ZXJTZXRMZW5ndGhcbiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gMjtcblxuICAgICAgICAgICAgICAgIGlmIChsZW4gPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gTm90aWNlOiBOYWx1IHdpdGhvdXQgc3RhcnRjb2RlIGhlYWRlciAoMDAgMDAgMDAgMDEpXG4gICAgICAgICAgICAgICAgdmFyIHNwcyA9IG5ldyBVaW50OEFycmF5KGFycmF5QnVmZmVyLCBkYXRhT2Zmc2V0ICsgb2Zmc2V0LCBsZW4pO1xuICAgICAgICAgICAgICAgIG9mZnNldCArPSBsZW47XG5cbiAgICAgICAgICAgICAgICB2YXIgY29uZmlnID0gX3Nwc1BhcnNlcjIuZGVmYXVsdC5wYXJzZVNQUyhzcHMpO1xuICAgICAgICAgICAgICAgIGlmIChpICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBvdGhlciBzcHMncyBjb25maWdcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbWV0YS5jb2RlY1dpZHRoID0gY29uZmlnLmNvZGVjX3NpemUud2lkdGg7XG4gICAgICAgICAgICAgICAgbWV0YS5jb2RlY0hlaWdodCA9IGNvbmZpZy5jb2RlY19zaXplLmhlaWdodDtcbiAgICAgICAgICAgICAgICBtZXRhLnByZXNlbnRXaWR0aCA9IGNvbmZpZy5wcmVzZW50X3NpemUud2lkdGg7XG4gICAgICAgICAgICAgICAgbWV0YS5wcmVzZW50SGVpZ2h0ID0gY29uZmlnLnByZXNlbnRfc2l6ZS5oZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICBtZXRhLnByb2ZpbGUgPSBjb25maWcucHJvZmlsZV9zdHJpbmc7XG4gICAgICAgICAgICAgICAgbWV0YS5sZXZlbCA9IGNvbmZpZy5sZXZlbF9zdHJpbmc7XG4gICAgICAgICAgICAgICAgbWV0YS5iaXREZXB0aCA9IGNvbmZpZy5iaXRfZGVwdGg7XG4gICAgICAgICAgICAgICAgbWV0YS5jaHJvbWFGb3JtYXQgPSBjb25maWcuY2hyb21hX2Zvcm1hdDtcbiAgICAgICAgICAgICAgICBtZXRhLnNhclJhdGlvID0gY29uZmlnLnNhcl9yYXRpbztcbiAgICAgICAgICAgICAgICBtZXRhLmZyYW1lUmF0ZSA9IGNvbmZpZy5mcmFtZV9yYXRlO1xuXG4gICAgICAgICAgICAgICAgaWYgKGNvbmZpZy5mcmFtZV9yYXRlLmZpeGVkID09PSBmYWxzZSB8fCBjb25maWcuZnJhbWVfcmF0ZS5mcHNfbnVtID09PSAwIHx8IGNvbmZpZy5mcmFtZV9yYXRlLmZwc19kZW4gPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbWV0YS5mcmFtZVJhdGUgPSB0aGlzLl9yZWZlcmVuY2VGcmFtZVJhdGU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIGZwc19kZW4gPSBtZXRhLmZyYW1lUmF0ZS5mcHNfZGVuO1xuICAgICAgICAgICAgICAgIHZhciBmcHNfbnVtID0gbWV0YS5mcmFtZVJhdGUuZnBzX251bTtcbiAgICAgICAgICAgICAgICBtZXRhLnJlZlNhbXBsZUR1cmF0aW9uID0gbWV0YS50aW1lc2NhbGUgKiAoZnBzX2RlbiAvIGZwc19udW0pO1xuXG4gICAgICAgICAgICAgICAgdmFyIGNvZGVjQXJyYXkgPSBzcHMuc3ViYXJyYXkoMSwgNCk7XG4gICAgICAgICAgICAgICAgdmFyIGNvZGVjU3RyaW5nID0gJ2F2YzEuJztcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IDM7IGorKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaCA9IGNvZGVjQXJyYXlbal0udG9TdHJpbmcoMTYpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaC5sZW5ndGggPCAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoID0gJzAnICsgaDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb2RlY1N0cmluZyArPSBoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtZXRhLmNvZGVjID0gY29kZWNTdHJpbmc7XG5cbiAgICAgICAgICAgICAgICB2YXIgbWkgPSB0aGlzLl9tZWRpYUluZm87XG4gICAgICAgICAgICAgICAgbWkud2lkdGggPSBtZXRhLmNvZGVjV2lkdGg7XG4gICAgICAgICAgICAgICAgbWkuaGVpZ2h0ID0gbWV0YS5jb2RlY0hlaWdodDtcbiAgICAgICAgICAgICAgICBtaS5mcHMgPSBtZXRhLmZyYW1lUmF0ZS5mcHM7XG4gICAgICAgICAgICAgICAgbWkucHJvZmlsZSA9IG1ldGEucHJvZmlsZTtcbiAgICAgICAgICAgICAgICBtaS5sZXZlbCA9IG1ldGEubGV2ZWw7XG4gICAgICAgICAgICAgICAgbWkucmVmRnJhbWVzID0gY29uZmlnLnJlZl9mcmFtZXM7XG4gICAgICAgICAgICAgICAgbWkuY2hyb21hRm9ybWF0ID0gY29uZmlnLmNocm9tYV9mb3JtYXRfc3RyaW5nO1xuICAgICAgICAgICAgICAgIG1pLnNhck51bSA9IG1ldGEuc2FyUmF0aW8ud2lkdGg7XG4gICAgICAgICAgICAgICAgbWkuc2FyRGVuID0gbWV0YS5zYXJSYXRpby5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgbWkudmlkZW9Db2RlYyA9IGNvZGVjU3RyaW5nO1xuXG4gICAgICAgICAgICAgICAgaWYgKG1pLmhhc0F1ZGlvKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChtaS5hdWRpb0NvZGVjICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1pLm1pbWVUeXBlID0gJ3ZpZGVvL3gtZmx2OyBjb2RlY3M9XCInICsgbWkudmlkZW9Db2RlYyArICcsJyArIG1pLmF1ZGlvQ29kZWMgKyAnXCInO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbWkubWltZVR5cGUgPSAndmlkZW8veC1mbHY7IGNvZGVjcz1cIicgKyBtaS52aWRlb0NvZGVjICsgJ1wiJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG1pLmlzQ29tcGxldGUoKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbk1lZGlhSW5mbyhtaSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcHBzQ291bnQgPSB2LmdldFVpbnQ4KG9mZnNldCk7IC8vIG51bU9mUGljdHVyZVBhcmFtZXRlclNldHNcbiAgICAgICAgICAgIGlmIChwcHNDb3VudCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoX2RlbXV4RXJyb3JzMi5kZWZhdWx0LkZPUk1BVF9FUlJPUiwgJ0ZsdjogSW52YWxpZCBBVkNEZWNvZGVyQ29uZmlndXJhdGlvblJlY29yZDogTm8gUFBTJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChwcHNDb3VudCA+IDEpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdGbHY6IFN0cmFuZ2UgQVZDRGVjb2RlckNvbmZpZ3VyYXRpb25SZWNvcmQ6IFBQUyBDb3VudCA9ICcgKyBwcHNDb3VudCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG9mZnNldCsrO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgcHBzQ291bnQ7IF9pKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgX2xlbiA9IHYuZ2V0VWludDE2KG9mZnNldCwgIWxlKTsgLy8gcGljdHVyZVBhcmFtZXRlclNldExlbmd0aFxuICAgICAgICAgICAgICAgIG9mZnNldCArPSAyO1xuXG4gICAgICAgICAgICAgICAgaWYgKF9sZW4gPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gcHBzIGlzIHVzZWxlc3MgZm9yIGV4dHJhY3RpbmcgdmlkZW8gaW5mb3JtYXRpb25cbiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gX2xlbjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbWV0YS5hdmNjID0gbmV3IFVpbnQ4QXJyYXkoZGF0YVNpemUpO1xuICAgICAgICAgICAgbWV0YS5hdmNjLnNldChuZXcgVWludDhBcnJheShhcnJheUJ1ZmZlciwgZGF0YU9mZnNldCwgZGF0YVNpemUpLCAwKTtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudih0aGlzLlRBRywgJ1BhcnNlZCBBVkNEZWNvZGVyQ29uZmlndXJhdGlvblJlY29yZCcpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5faXNJbml0aWFsTWV0YWRhdGFEaXNwYXRjaGVkKCkpIHtcbiAgICAgICAgICAgICAgICAvLyBmbHVzaCBwYXJzZWQgZnJhbWVzXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2Rpc3BhdGNoICYmICh0aGlzLl9hdWRpb1RyYWNrLmxlbmd0aCB8fCB0aGlzLl92aWRlb1RyYWNrLmxlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25EYXRhQXZhaWxhYmxlKHRoaXMuX2F1ZGlvVHJhY2ssIHRoaXMuX3ZpZGVvVHJhY2spO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdmlkZW9Jbml0aWFsTWV0YWRhdGFEaXNwYXRjaGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIG5vdGlmeSBuZXcgbWV0YWRhdGFcbiAgICAgICAgICAgIHRoaXMuX2Rpc3BhdGNoID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9vblRyYWNrTWV0YWRhdGEoJ3ZpZGVvJywgbWV0YSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19wYXJzZUFWQ1ZpZGVvRGF0YScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcGFyc2VBVkNWaWRlb0RhdGEoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplLCB0YWdUaW1lc3RhbXAsIHRhZ1Bvc2l0aW9uLCBmcmFtZVR5cGUsIGN0cykge1xuICAgICAgICAgICAgdmFyIGxlID0gdGhpcy5fbGl0dGxlRW5kaWFuO1xuICAgICAgICAgICAgdmFyIHYgPSBuZXcgRGF0YVZpZXcoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQsIGRhdGFTaXplKTtcblxuICAgICAgICAgICAgdmFyIHVuaXRzID0gW10sXG4gICAgICAgICAgICAgICAgbGVuZ3RoID0gMDtcblxuICAgICAgICAgICAgdmFyIG9mZnNldCA9IDA7XG4gICAgICAgICAgICB2YXIgbGVuZ3RoU2l6ZSA9IHRoaXMuX25hbHVMZW5ndGhTaXplO1xuICAgICAgICAgICAgdmFyIGR0cyA9IHRoaXMuX3RpbWVzdGFtcEJhc2UgKyB0YWdUaW1lc3RhbXA7XG4gICAgICAgICAgICB2YXIga2V5ZnJhbWUgPSBmcmFtZVR5cGUgPT09IDE7IC8vIGZyb20gRkxWIEZyYW1lIFR5cGUgY29uc3RhbnRzXG5cbiAgICAgICAgICAgIHdoaWxlIChvZmZzZXQgPCBkYXRhU2l6ZSkge1xuICAgICAgICAgICAgICAgIGlmIChvZmZzZXQgKyA0ID49IGRhdGFTaXplKSB7XG4gICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ01hbGZvcm1lZCBOYWx1IG5lYXIgdGltZXN0YW1wICcgKyBkdHMgKyAnLCBvZmZzZXQgPSAnICsgb2Zmc2V0ICsgJywgZGF0YVNpemUgPSAnICsgZGF0YVNpemUpO1xuICAgICAgICAgICAgICAgICAgICBicmVhazsgLy8gZGF0YSBub3QgZW5vdWdoIGZvciBuZXh0IE5hbHVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gTmFsdSB3aXRoIGxlbmd0aC1oZWFkZXIgKEFWQzEpXG4gICAgICAgICAgICAgICAgdmFyIG5hbHVTaXplID0gdi5nZXRVaW50MzIob2Zmc2V0LCAhbGUpOyAvLyBCaWctRW5kaWFuIHJlYWRcbiAgICAgICAgICAgICAgICBpZiAobGVuZ3RoU2l6ZSA9PT0gMykge1xuICAgICAgICAgICAgICAgICAgICBuYWx1U2l6ZSA+Pj49IDg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChuYWx1U2l6ZSA+IGRhdGFTaXplIC0gbGVuZ3RoU2l6ZSkge1xuICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdNYWxmb3JtZWQgTmFsdXMgbmVhciB0aW1lc3RhbXAgJyArIGR0cyArICcsIE5hbHVTaXplID4gRGF0YVNpemUhJyk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgdW5pdFR5cGUgPSB2LmdldFVpbnQ4KG9mZnNldCArIGxlbmd0aFNpemUpICYgMHgxRjtcblxuICAgICAgICAgICAgICAgIGlmICh1bml0VHlwZSA9PT0gNSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJRFJcbiAgICAgICAgICAgICAgICAgICAga2V5ZnJhbWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWZmZXIsIGRhdGFPZmZzZXQgKyBvZmZzZXQsIGxlbmd0aFNpemUgKyBuYWx1U2l6ZSk7XG4gICAgICAgICAgICAgICAgdmFyIHVuaXQgPSB7IHR5cGU6IHVuaXRUeXBlLCBkYXRhOiBkYXRhIH07XG4gICAgICAgICAgICAgICAgdW5pdHMucHVzaCh1bml0KTtcbiAgICAgICAgICAgICAgICBsZW5ndGggKz0gZGF0YS5ieXRlTGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgb2Zmc2V0ICs9IGxlbmd0aFNpemUgKyBuYWx1U2l6ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHVuaXRzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHZhciB0cmFjayA9IHRoaXMuX3ZpZGVvVHJhY2s7XG4gICAgICAgICAgICAgICAgdmFyIGF2Y1NhbXBsZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgdW5pdHM6IHVuaXRzLFxuICAgICAgICAgICAgICAgICAgICBsZW5ndGg6IGxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgaXNLZXlmcmFtZToga2V5ZnJhbWUsXG4gICAgICAgICAgICAgICAgICAgIGR0czogZHRzLFxuICAgICAgICAgICAgICAgICAgICBjdHM6IGN0cyxcbiAgICAgICAgICAgICAgICAgICAgcHRzOiBkdHMgKyBjdHNcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmIChrZXlmcmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBhdmNTYW1wbGUuZmlsZXBvc2l0aW9uID0gdGFnUG9zaXRpb247XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRyYWNrLnNhbXBsZXMucHVzaChhdmNTYW1wbGUpO1xuICAgICAgICAgICAgICAgIHRyYWNrLmxlbmd0aCArPSBsZW5ndGg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uVHJhY2tNZXRhZGF0YScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uVHJhY2tNZXRhZGF0YTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uVHJhY2tNZXRhZGF0YSA9IGNhbGxiYWNrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcHJvdG90eXBlOiBmdW5jdGlvbihtZWRpYUluZm86IE1lZGlhSW5mbyk6IHZvaWRcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25NZWRpYUluZm8nLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vbk1lZGlhSW5mbztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uTWVkaWFJbmZvID0gY2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uTWV0YURhdGFBcnJpdmVkJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25NZXRhRGF0YUFycml2ZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vbk1ldGFEYXRhQXJyaXZlZCA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvblNjcmlwdERhdGFBcnJpdmVkJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25TY3JpcHREYXRhQXJyaXZlZDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uU2NyaXB0RGF0YUFycml2ZWQgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHByb3RvdHlwZTogZnVuY3Rpb24odHlwZTogbnVtYmVyLCBpbmZvOiBzdHJpbmcpOiB2b2lkXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uRXJyb3InLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vbkVycm9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25FcnJvciA9IGNhbGxiYWNrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcHJvdG90eXBlOiBmdW5jdGlvbih2aWRlb1RyYWNrOiBhbnksIGF1ZGlvVHJhY2s6IGFueSk6IHZvaWRcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25EYXRhQXZhaWxhYmxlJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25EYXRhQXZhaWxhYmxlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25EYXRhQXZhaWxhYmxlID0gY2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uU3RyZWFtVGltZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uU3RyZWFtVGltZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uU3RyZWFtVGltZSA9IGNhbGxiYWNrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gdGltZXN0YW1wIGJhc2UgZm9yIG91dHB1dCBzYW1wbGVzLCBtdXN0IGJlIGluIG1pbGxpc2Vjb25kc1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICd0aW1lc3RhbXBCYXNlJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdGltZXN0YW1wQmFzZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoYmFzZSkge1xuICAgICAgICAgICAgdGhpcy5fdGltZXN0YW1wQmFzZSA9IGJhc2U7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ292ZXJyaWRlZER1cmF0aW9uJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZHVyYXRpb247XG4gICAgICAgIH1cblxuICAgICAgICAvLyBGb3JjZS1vdmVycmlkZSBtZWRpYSBkdXJhdGlvbi4gTXVzdCBiZSBpbiBtaWxsaXNlY29uZHMsIGludDMyXG4gICAgICAgICxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZHVyYXRpb24pIHtcbiAgICAgICAgICAgIHRoaXMuX2R1cmF0aW9uT3ZlcnJpZGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuX2R1cmF0aW9uID0gZHVyYXRpb247XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUluZm8uZHVyYXRpb24gPSBkdXJhdGlvbjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZvcmNlLW92ZXJyaWRlIGF1ZGlvIHRyYWNrIHByZXNlbnQgZmxhZywgYm9vbGVhblxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvdmVycmlkZWRIYXNBdWRpbycsXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGhhc0F1ZGlvKSB7XG4gICAgICAgICAgICB0aGlzLl9oYXNBdWRpb0ZsYWdPdmVycmlkZWQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5faGFzQXVkaW8gPSBoYXNBdWRpbztcbiAgICAgICAgICAgIHRoaXMuX21lZGlhSW5mby5oYXNBdWRpbyA9IGhhc0F1ZGlvO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRm9yY2Utb3ZlcnJpZGUgdmlkZW8gdHJhY2sgcHJlc2VudCBmbGFnLCBib29sZWFuXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ292ZXJyaWRlZEhhc1ZpZGVvJyxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoaGFzVmlkZW8pIHtcbiAgICAgICAgICAgIHRoaXMuX2hhc1ZpZGVvRmxhZ092ZXJyaWRlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl9oYXNWaWRlbyA9IGhhc1ZpZGVvO1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFJbmZvLmhhc1ZpZGVvID0gaGFzVmlkZW87XG4gICAgICAgIH1cbiAgICB9XSwgW3tcbiAgICAgICAga2V5OiAncHJvYmUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcHJvYmUoYnVmZmVyKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IG5ldyBVaW50OEFycmF5KGJ1ZmZlcik7XG4gICAgICAgICAgICB2YXIgbWlzbWF0Y2ggPSB7IG1hdGNoOiBmYWxzZSB9O1xuXG4gICAgICAgICAgICBpZiAoZGF0YVswXSAhPT0gMHg0NiB8fCBkYXRhWzFdICE9PSAweDRDIHx8IGRhdGFbMl0gIT09IDB4NTYgfHwgZGF0YVszXSAhPT0gMHgwMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBtaXNtYXRjaDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGhhc0F1ZGlvID0gKGRhdGFbNF0gJiA0KSA+Pj4gMiAhPT0gMDtcbiAgICAgICAgICAgIHZhciBoYXNWaWRlbyA9IChkYXRhWzRdICYgMSkgIT09IDA7XG5cbiAgICAgICAgICAgIHZhciBvZmZzZXQgPSBSZWFkQmlnMzIoZGF0YSwgNSk7XG5cbiAgICAgICAgICAgIGlmIChvZmZzZXQgPCA5KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1pc21hdGNoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG1hdGNoOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNvbnN1bWVkOiBvZmZzZXQsXG4gICAgICAgICAgICAgICAgZGF0YU9mZnNldDogb2Zmc2V0LFxuICAgICAgICAgICAgICAgIGhhc0F1ZGlvVHJhY2s6IGhhc0F1ZGlvLFxuICAgICAgICAgICAgICAgIGhhc1ZpZGVvVHJhY2s6IGhhc1ZpZGVvXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIEZMVkRlbXV4ZXI7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEZMVkRlbXV4ZXI7XG5cbn0se1wiLi4vY29yZS9tZWRpYS1pbmZvLmpzXCI6NyxcIi4uL3V0aWxzL2V4Y2VwdGlvbi5qc1wiOjQwLFwiLi4vdXRpbHMvbG9nZ2VyLmpzXCI6NDEsXCIuL2FtZi1wYXJzZXIuanNcIjoxNSxcIi4vZGVtdXgtZXJyb3JzLmpzXCI6MTYsXCIuL3Nwcy1wYXJzZXIuanNcIjoxOX1dLDE5OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9leHBHb2xvbWIgPSBfZGVyZXFfKCcuL2V4cC1nb2xvbWIuanMnKTtcblxudmFyIF9leHBHb2xvbWIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhwR29sb21iKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIFNQU1BhcnNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBTUFNQYXJzZXIoKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTUFNQYXJzZXIpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhTUFNQYXJzZXIsIG51bGwsIFt7XG4gICAgICAgIGtleTogJ19lYnNwMnJic3AnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2Vic3AycmJzcCh1aW50OGFycmF5KSB7XG4gICAgICAgICAgICB2YXIgc3JjID0gdWludDhhcnJheTtcbiAgICAgICAgICAgIHZhciBzcmNfbGVuZ3RoID0gc3JjLmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICB2YXIgZHN0ID0gbmV3IFVpbnQ4QXJyYXkoc3JjX2xlbmd0aCk7XG4gICAgICAgICAgICB2YXIgZHN0X2lkeCA9IDA7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3JjX2xlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGkgPj0gMikge1xuICAgICAgICAgICAgICAgICAgICAvLyBVbmVzY2FwZTogU2tpcCAweDAzIGFmdGVyIDAwIDAwXG4gICAgICAgICAgICAgICAgICAgIGlmIChzcmNbaV0gPT09IDB4MDMgJiYgc3JjW2kgLSAxXSA9PT0gMHgwMCAmJiBzcmNbaSAtIDJdID09PSAweDAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkc3RbZHN0X2lkeF0gPSBzcmNbaV07XG4gICAgICAgICAgICAgICAgZHN0X2lkeCsrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoZHN0LmJ1ZmZlciwgMCwgZHN0X2lkeCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3BhcnNlU1BTJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBhcnNlU1BTKHVpbnQ4YXJyYXkpIHtcbiAgICAgICAgICAgIHZhciByYnNwID0gU1BTUGFyc2VyLl9lYnNwMnJic3AodWludDhhcnJheSk7XG4gICAgICAgICAgICB2YXIgZ2IgPSBuZXcgX2V4cEdvbG9tYjIuZGVmYXVsdChyYnNwKTtcblxuICAgICAgICAgICAgZ2IucmVhZEJ5dGUoKTtcbiAgICAgICAgICAgIHZhciBwcm9maWxlX2lkYyA9IGdiLnJlYWRCeXRlKCk7IC8vIHByb2ZpbGVfaWRjXG4gICAgICAgICAgICBnYi5yZWFkQnl0ZSgpOyAvLyBjb25zdHJhaW50X3NldF9mbGFnc1s1XSArIHJlc2VydmVkX3plcm9bM11cbiAgICAgICAgICAgIHZhciBsZXZlbF9pZGMgPSBnYi5yZWFkQnl0ZSgpOyAvLyBsZXZlbF9pZGNcbiAgICAgICAgICAgIGdiLnJlYWRVRUcoKTsgLy8gc2VxX3BhcmFtZXRlcl9zZXRfaWRcblxuICAgICAgICAgICAgdmFyIHByb2ZpbGVfc3RyaW5nID0gU1BTUGFyc2VyLmdldFByb2ZpbGVTdHJpbmcocHJvZmlsZV9pZGMpO1xuICAgICAgICAgICAgdmFyIGxldmVsX3N0cmluZyA9IFNQU1BhcnNlci5nZXRMZXZlbFN0cmluZyhsZXZlbF9pZGMpO1xuICAgICAgICAgICAgdmFyIGNocm9tYV9mb3JtYXRfaWRjID0gMTtcbiAgICAgICAgICAgIHZhciBjaHJvbWFfZm9ybWF0ID0gNDIwO1xuICAgICAgICAgICAgdmFyIGNocm9tYV9mb3JtYXRfdGFibGUgPSBbMCwgNDIwLCA0MjIsIDQ0NF07XG4gICAgICAgICAgICB2YXIgYml0X2RlcHRoID0gODtcblxuICAgICAgICAgICAgaWYgKHByb2ZpbGVfaWRjID09PSAxMDAgfHwgcHJvZmlsZV9pZGMgPT09IDExMCB8fCBwcm9maWxlX2lkYyA9PT0gMTIyIHx8IHByb2ZpbGVfaWRjID09PSAyNDQgfHwgcHJvZmlsZV9pZGMgPT09IDQ0IHx8IHByb2ZpbGVfaWRjID09PSA4MyB8fCBwcm9maWxlX2lkYyA9PT0gODYgfHwgcHJvZmlsZV9pZGMgPT09IDExOCB8fCBwcm9maWxlX2lkYyA9PT0gMTI4IHx8IHByb2ZpbGVfaWRjID09PSAxMzggfHwgcHJvZmlsZV9pZGMgPT09IDE0NCkge1xuXG4gICAgICAgICAgICAgICAgY2hyb21hX2Zvcm1hdF9pZGMgPSBnYi5yZWFkVUVHKCk7XG4gICAgICAgICAgICAgICAgaWYgKGNocm9tYV9mb3JtYXRfaWRjID09PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgIGdiLnJlYWRCaXRzKDEpOyAvLyBzZXBhcmF0ZV9jb2xvdXJfcGxhbmVfZmxhZ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoY2hyb21hX2Zvcm1hdF9pZGMgPD0gMykge1xuICAgICAgICAgICAgICAgICAgICBjaHJvbWFfZm9ybWF0ID0gY2hyb21hX2Zvcm1hdF90YWJsZVtjaHJvbWFfZm9ybWF0X2lkY107XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgYml0X2RlcHRoID0gZ2IucmVhZFVFRygpICsgODsgLy8gYml0X2RlcHRoX2x1bWFfbWludXM4XG4gICAgICAgICAgICAgICAgZ2IucmVhZFVFRygpOyAvLyBiaXRfZGVwdGhfY2hyb21hX21pbnVzOFxuICAgICAgICAgICAgICAgIGdiLnJlYWRCaXRzKDEpOyAvLyBxcHByaW1lX3lfemVyb190cmFuc2Zvcm1fYnlwYXNzX2ZsYWdcbiAgICAgICAgICAgICAgICBpZiAoZ2IucmVhZEJvb2woKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBzZXFfc2NhbGluZ19tYXRyaXhfcHJlc2VudF9mbGFnXG4gICAgICAgICAgICAgICAgICAgIHZhciBzY2FsaW5nX2xpc3RfY291bnQgPSBjaHJvbWFfZm9ybWF0X2lkYyAhPT0gMyA/IDggOiAxMjtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzY2FsaW5nX2xpc3RfY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdiLnJlYWRCb29sKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXFfc2NhbGluZ19saXN0X3ByZXNlbnRfZmxhZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpIDwgNikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBTUFNQYXJzZXIuX3NraXBTY2FsaW5nTGlzdChnYiwgMTYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNQU1BhcnNlci5fc2tpcFNjYWxpbmdMaXN0KGdiLCA2NCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2IucmVhZFVFRygpOyAvLyBsb2cyX21heF9mcmFtZV9udW1fbWludXM0XG4gICAgICAgICAgICB2YXIgcGljX29yZGVyX2NudF90eXBlID0gZ2IucmVhZFVFRygpO1xuICAgICAgICAgICAgaWYgKHBpY19vcmRlcl9jbnRfdHlwZSA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGdiLnJlYWRVRUcoKTsgLy8gbG9nMl9tYXhfcGljX29yZGVyX2NudF9sc2JfbWludXNfNFxuICAgICAgICAgICAgfSBlbHNlIGlmIChwaWNfb3JkZXJfY250X3R5cGUgPT09IDEpIHtcbiAgICAgICAgICAgICAgICBnYi5yZWFkQml0cygxKTsgLy8gZGVsdGFfcGljX29yZGVyX2Fsd2F5c196ZXJvX2ZsYWdcbiAgICAgICAgICAgICAgICBnYi5yZWFkU0VHKCk7IC8vIG9mZnNldF9mb3Jfbm9uX3JlZl9waWNcbiAgICAgICAgICAgICAgICBnYi5yZWFkU0VHKCk7IC8vIG9mZnNldF9mb3JfdG9wX3RvX2JvdHRvbV9maWVsZFxuICAgICAgICAgICAgICAgIHZhciBudW1fcmVmX2ZyYW1lc19pbl9waWNfb3JkZXJfY250X2N5Y2xlID0gZ2IucmVhZFVFRygpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBudW1fcmVmX2ZyYW1lc19pbl9waWNfb3JkZXJfY250X2N5Y2xlOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGdiLnJlYWRTRUcoKTsgLy8gb2Zmc2V0X2Zvcl9yZWZfZnJhbWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgcmVmX2ZyYW1lcyA9IGdiLnJlYWRVRUcoKTsgLy8gbWF4X251bV9yZWZfZnJhbWVzXG4gICAgICAgICAgICBnYi5yZWFkQml0cygxKTsgLy8gZ2Fwc19pbl9mcmFtZV9udW1fdmFsdWVfYWxsb3dlZF9mbGFnXG5cbiAgICAgICAgICAgIHZhciBwaWNfd2lkdGhfaW5fbWJzX21pbnVzMSA9IGdiLnJlYWRVRUcoKTtcbiAgICAgICAgICAgIHZhciBwaWNfaGVpZ2h0X2luX21hcF91bml0c19taW51czEgPSBnYi5yZWFkVUVHKCk7XG5cbiAgICAgICAgICAgIHZhciBmcmFtZV9tYnNfb25seV9mbGFnID0gZ2IucmVhZEJpdHMoMSk7XG4gICAgICAgICAgICBpZiAoZnJhbWVfbWJzX29ubHlfZmxhZyA9PT0gMCkge1xuICAgICAgICAgICAgICAgIGdiLnJlYWRCaXRzKDEpOyAvLyBtYl9hZGFwdGl2ZV9mcmFtZV9maWVsZF9mbGFnXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnYi5yZWFkQml0cygxKTsgLy8gZGlyZWN0Xzh4OF9pbmZlcmVuY2VfZmxhZ1xuXG4gICAgICAgICAgICB2YXIgZnJhbWVfY3JvcF9sZWZ0X29mZnNldCA9IDA7XG4gICAgICAgICAgICB2YXIgZnJhbWVfY3JvcF9yaWdodF9vZmZzZXQgPSAwO1xuICAgICAgICAgICAgdmFyIGZyYW1lX2Nyb3BfdG9wX29mZnNldCA9IDA7XG4gICAgICAgICAgICB2YXIgZnJhbWVfY3JvcF9ib3R0b21fb2Zmc2V0ID0gMDtcblxuICAgICAgICAgICAgdmFyIGZyYW1lX2Nyb3BwaW5nX2ZsYWcgPSBnYi5yZWFkQm9vbCgpO1xuICAgICAgICAgICAgaWYgKGZyYW1lX2Nyb3BwaW5nX2ZsYWcpIHtcbiAgICAgICAgICAgICAgICBmcmFtZV9jcm9wX2xlZnRfb2Zmc2V0ID0gZ2IucmVhZFVFRygpO1xuICAgICAgICAgICAgICAgIGZyYW1lX2Nyb3BfcmlnaHRfb2Zmc2V0ID0gZ2IucmVhZFVFRygpO1xuICAgICAgICAgICAgICAgIGZyYW1lX2Nyb3BfdG9wX29mZnNldCA9IGdiLnJlYWRVRUcoKTtcbiAgICAgICAgICAgICAgICBmcmFtZV9jcm9wX2JvdHRvbV9vZmZzZXQgPSBnYi5yZWFkVUVHKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzYXJfd2lkdGggPSAxLFxuICAgICAgICAgICAgICAgIHNhcl9oZWlnaHQgPSAxO1xuICAgICAgICAgICAgdmFyIGZwcyA9IDAsXG4gICAgICAgICAgICAgICAgZnBzX2ZpeGVkID0gdHJ1ZSxcbiAgICAgICAgICAgICAgICBmcHNfbnVtID0gMCxcbiAgICAgICAgICAgICAgICBmcHNfZGVuID0gMDtcblxuICAgICAgICAgICAgdmFyIHZ1aV9wYXJhbWV0ZXJzX3ByZXNlbnRfZmxhZyA9IGdiLnJlYWRCb29sKCk7XG4gICAgICAgICAgICBpZiAodnVpX3BhcmFtZXRlcnNfcHJlc2VudF9mbGFnKSB7XG4gICAgICAgICAgICAgICAgaWYgKGdiLnJlYWRCb29sKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYXNwZWN0X3JhdGlvX2luZm9fcHJlc2VudF9mbGFnXG4gICAgICAgICAgICAgICAgICAgIHZhciBhc3BlY3RfcmF0aW9faWRjID0gZ2IucmVhZEJ5dGUoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNhcl93X3RhYmxlID0gWzEsIDEyLCAxMCwgMTYsIDQwLCAyNCwgMjAsIDMyLCA4MCwgMTgsIDE1LCA2NCwgMTYwLCA0LCAzLCAyXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNhcl9oX3RhYmxlID0gWzEsIDExLCAxMSwgMTEsIDMzLCAxMSwgMTEsIDExLCAzMywgMTEsIDExLCAzMywgOTksIDMsIDIsIDFdO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChhc3BlY3RfcmF0aW9faWRjID4gMCAmJiBhc3BlY3RfcmF0aW9faWRjIDwgMTYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhcl93aWR0aCA9IHNhcl93X3RhYmxlW2FzcGVjdF9yYXRpb19pZGMgLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhcl9oZWlnaHQgPSBzYXJfaF90YWJsZVthc3BlY3RfcmF0aW9faWRjIC0gMV07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYXNwZWN0X3JhdGlvX2lkYyA9PT0gMjU1KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzYXJfd2lkdGggPSBnYi5yZWFkQnl0ZSgpIDw8IDggfCBnYi5yZWFkQnl0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2FyX2hlaWdodCA9IGdiLnJlYWRCeXRlKCkgPDwgOCB8IGdiLnJlYWRCeXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoZ2IucmVhZEJvb2woKSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBvdmVyc2Nhbl9pbmZvX3ByZXNlbnRfZmxhZ1xuICAgICAgICAgICAgICAgICAgICBnYi5yZWFkQm9vbCgpOyAvLyBvdmVyc2Nhbl9hcHByb3ByaWF0ZV9mbGFnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnYi5yZWFkQm9vbCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHZpZGVvX3NpZ25hbF90eXBlX3ByZXNlbnRfZmxhZ1xuICAgICAgICAgICAgICAgICAgICBnYi5yZWFkQml0cyg0KTsgLy8gdmlkZW9fZm9ybWF0ICYgdmlkZW9fZnVsbF9yYW5nZV9mbGFnXG4gICAgICAgICAgICAgICAgICAgIGlmIChnYi5yZWFkQm9vbCgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb2xvdXJfZGVzY3JpcHRpb25fcHJlc2VudF9mbGFnXG4gICAgICAgICAgICAgICAgICAgICAgICBnYi5yZWFkQml0cygyNCk7IC8vIGNvbG91cl9wcmltYXJpZXMgJiB0cmFuc2Zlcl9jaGFyYWN0ZXJpc3RpY3MgJiBtYXRyaXhfY29lZmZpY2llbnRzXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGdiLnJlYWRCb29sKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY2hyb21hX2xvY19pbmZvX3ByZXNlbnRfZmxhZ1xuICAgICAgICAgICAgICAgICAgICBnYi5yZWFkVUVHKCk7IC8vIGNocm9tYV9zYW1wbGVfbG9jX3R5cGVfdG9wX2ZpZWxkXG4gICAgICAgICAgICAgICAgICAgIGdiLnJlYWRVRUcoKTsgLy8gY2hyb21hX3NhbXBsZV9sb2NfdHlwZV9ib3R0b21fZmllbGRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGdiLnJlYWRCb29sKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGltaW5nX2luZm9fcHJlc2VudF9mbGFnXG4gICAgICAgICAgICAgICAgICAgIHZhciBudW1fdW5pdHNfaW5fdGljayA9IGdiLnJlYWRCaXRzKDMyKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRpbWVfc2NhbGUgPSBnYi5yZWFkQml0cygzMik7XG4gICAgICAgICAgICAgICAgICAgIGZwc19maXhlZCA9IGdiLnJlYWRCb29sKCk7IC8vIGZpeGVkX2ZyYW1lX3JhdGVfZmxhZ1xuXG4gICAgICAgICAgICAgICAgICAgIGZwc19udW0gPSB0aW1lX3NjYWxlO1xuICAgICAgICAgICAgICAgICAgICBmcHNfZGVuID0gbnVtX3VuaXRzX2luX3RpY2sgKiAyO1xuICAgICAgICAgICAgICAgICAgICBmcHMgPSBmcHNfbnVtIC8gZnBzX2RlbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzYXJTY2FsZSA9IDE7XG4gICAgICAgICAgICBpZiAoc2FyX3dpZHRoICE9PSAxIHx8IHNhcl9oZWlnaHQgIT09IDEpIHtcbiAgICAgICAgICAgICAgICBzYXJTY2FsZSA9IHNhcl93aWR0aCAvIHNhcl9oZWlnaHQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBjcm9wX3VuaXRfeCA9IDAsXG4gICAgICAgICAgICAgICAgY3JvcF91bml0X3kgPSAwO1xuICAgICAgICAgICAgaWYgKGNocm9tYV9mb3JtYXRfaWRjID09PSAwKSB7XG4gICAgICAgICAgICAgICAgY3JvcF91bml0X3ggPSAxO1xuICAgICAgICAgICAgICAgIGNyb3BfdW5pdF95ID0gMiAtIGZyYW1lX21ic19vbmx5X2ZsYWc7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBzdWJfd2MgPSBjaHJvbWFfZm9ybWF0X2lkYyA9PT0gMyA/IDEgOiAyO1xuICAgICAgICAgICAgICAgIHZhciBzdWJfaGMgPSBjaHJvbWFfZm9ybWF0X2lkYyA9PT0gMSA/IDIgOiAxO1xuICAgICAgICAgICAgICAgIGNyb3BfdW5pdF94ID0gc3ViX3djO1xuICAgICAgICAgICAgICAgIGNyb3BfdW5pdF95ID0gc3ViX2hjICogKDIgLSBmcmFtZV9tYnNfb25seV9mbGFnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGNvZGVjX3dpZHRoID0gKHBpY193aWR0aF9pbl9tYnNfbWludXMxICsgMSkgKiAxNjtcbiAgICAgICAgICAgIHZhciBjb2RlY19oZWlnaHQgPSAoMiAtIGZyYW1lX21ic19vbmx5X2ZsYWcpICogKChwaWNfaGVpZ2h0X2luX21hcF91bml0c19taW51czEgKyAxKSAqIDE2KTtcblxuICAgICAgICAgICAgY29kZWNfd2lkdGggLT0gKGZyYW1lX2Nyb3BfbGVmdF9vZmZzZXQgKyBmcmFtZV9jcm9wX3JpZ2h0X29mZnNldCkgKiBjcm9wX3VuaXRfeDtcbiAgICAgICAgICAgIGNvZGVjX2hlaWdodCAtPSAoZnJhbWVfY3JvcF90b3Bfb2Zmc2V0ICsgZnJhbWVfY3JvcF9ib3R0b21fb2Zmc2V0KSAqIGNyb3BfdW5pdF95O1xuXG4gICAgICAgICAgICB2YXIgcHJlc2VudF93aWR0aCA9IE1hdGguY2VpbChjb2RlY193aWR0aCAqIHNhclNjYWxlKTtcblxuICAgICAgICAgICAgZ2IuZGVzdHJveSgpO1xuICAgICAgICAgICAgZ2IgPSBudWxsO1xuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHByb2ZpbGVfc3RyaW5nOiBwcm9maWxlX3N0cmluZywgLy8gYmFzZWxpbmUsIGhpZ2gsIGhpZ2gxMCwgLi4uXG4gICAgICAgICAgICAgICAgbGV2ZWxfc3RyaW5nOiBsZXZlbF9zdHJpbmcsIC8vIDMsIDMuMSwgNCwgNC4xLCA1LCA1LjEsIC4uLlxuICAgICAgICAgICAgICAgIGJpdF9kZXB0aDogYml0X2RlcHRoLCAvLyA4Yml0LCAxMGJpdCwgLi4uXG4gICAgICAgICAgICAgICAgcmVmX2ZyYW1lczogcmVmX2ZyYW1lcyxcbiAgICAgICAgICAgICAgICBjaHJvbWFfZm9ybWF0OiBjaHJvbWFfZm9ybWF0LCAvLyA0OjI6MCwgNDoyOjIsIC4uLlxuICAgICAgICAgICAgICAgIGNocm9tYV9mb3JtYXRfc3RyaW5nOiBTUFNQYXJzZXIuZ2V0Q2hyb21hRm9ybWF0U3RyaW5nKGNocm9tYV9mb3JtYXQpLFxuXG4gICAgICAgICAgICAgICAgZnJhbWVfcmF0ZToge1xuICAgICAgICAgICAgICAgICAgICBmaXhlZDogZnBzX2ZpeGVkLFxuICAgICAgICAgICAgICAgICAgICBmcHM6IGZwcyxcbiAgICAgICAgICAgICAgICAgICAgZnBzX2RlbjogZnBzX2RlbixcbiAgICAgICAgICAgICAgICAgICAgZnBzX251bTogZnBzX251bVxuICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICBzYXJfcmF0aW86IHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHNhcl93aWR0aCxcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBzYXJfaGVpZ2h0XG4gICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgIGNvZGVjX3NpemU6IHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IGNvZGVjX3dpZHRoLFxuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IGNvZGVjX2hlaWdodFxuICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICBwcmVzZW50X3NpemU6IHtcbiAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHByZXNlbnRfd2lkdGgsXG4gICAgICAgICAgICAgICAgICAgIGhlaWdodDogY29kZWNfaGVpZ2h0XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3NraXBTY2FsaW5nTGlzdCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfc2tpcFNjYWxpbmdMaXN0KGdiLCBjb3VudCkge1xuICAgICAgICAgICAgdmFyIGxhc3Rfc2NhbGUgPSA4LFxuICAgICAgICAgICAgICAgIG5leHRfc2NhbGUgPSA4O1xuICAgICAgICAgICAgdmFyIGRlbHRhX3NjYWxlID0gMDtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChuZXh0X3NjYWxlICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlbHRhX3NjYWxlID0gZ2IucmVhZFNFRygpO1xuICAgICAgICAgICAgICAgICAgICBuZXh0X3NjYWxlID0gKGxhc3Rfc2NhbGUgKyBkZWx0YV9zY2FsZSArIDI1NikgJSAyNTY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGxhc3Rfc2NhbGUgPSBuZXh0X3NjYWxlID09PSAwID8gbGFzdF9zY2FsZSA6IG5leHRfc2NhbGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2dldFByb2ZpbGVTdHJpbmcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UHJvZmlsZVN0cmluZyhwcm9maWxlX2lkYykge1xuICAgICAgICAgICAgc3dpdGNoIChwcm9maWxlX2lkYykge1xuICAgICAgICAgICAgICAgIGNhc2UgNjY6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnQmFzZWxpbmUnO1xuICAgICAgICAgICAgICAgIGNhc2UgNzc6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnTWFpbic7XG4gICAgICAgICAgICAgICAgY2FzZSA4ODpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdFeHRlbmRlZCc7XG4gICAgICAgICAgICAgICAgY2FzZSAxMDA6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnSGlnaCc7XG4gICAgICAgICAgICAgICAgY2FzZSAxMTA6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnSGlnaDEwJztcbiAgICAgICAgICAgICAgICBjYXNlIDEyMjpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdIaWdoNDIyJztcbiAgICAgICAgICAgICAgICBjYXNlIDI0NDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICdIaWdoNDQ0JztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJ1Vua25vd24nO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdnZXRMZXZlbFN0cmluZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRMZXZlbFN0cmluZyhsZXZlbF9pZGMpIHtcbiAgICAgICAgICAgIHJldHVybiAobGV2ZWxfaWRjIC8gMTApLnRvRml4ZWQoMSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2dldENocm9tYUZvcm1hdFN0cmluZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDaHJvbWFGb3JtYXRTdHJpbmcoY2hyb21hKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKGNocm9tYSkge1xuICAgICAgICAgICAgICAgIGNhc2UgNDIwOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzQ6MjowJztcbiAgICAgICAgICAgICAgICBjYXNlIDQyMjpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICc0OjI6Mic7XG4gICAgICAgICAgICAgICAgY2FzZSA0NDQ6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnNDo0OjQnO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAnVW5rbm93bic7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gU1BTUGFyc2VyO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBTUFNQYXJzZXI7XG5cbn0se1wiLi9leHAtZ29sb21iLmpzXCI6MTd9XSwyMDpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9OyAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgX3BvbHlmaWxsID0gX2RlcmVxXygnLi91dGlscy9wb2x5ZmlsbC5qcycpO1xuXG52YXIgX3BvbHlmaWxsMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BvbHlmaWxsKTtcblxudmFyIF9mZWF0dXJlcyA9IF9kZXJlcV8oJy4vY29yZS9mZWF0dXJlcy5qcycpO1xuXG52YXIgX2ZlYXR1cmVzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZlYXR1cmVzKTtcblxudmFyIF9sb2FkZXIgPSBfZGVyZXFfKCcuL2lvL2xvYWRlci5qcycpO1xuXG52YXIgX2ZsdlBsYXllciA9IF9kZXJlcV8oJy4vcGxheWVyL2Zsdi1wbGF5ZXIuanMnKTtcblxudmFyIF9mbHZQbGF5ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmx2UGxheWVyKTtcblxudmFyIF9uYXRpdmVQbGF5ZXIgPSBfZGVyZXFfKCcuL3BsYXllci9uYXRpdmUtcGxheWVyLmpzJyk7XG5cbnZhciBfbmF0aXZlUGxheWVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX25hdGl2ZVBsYXllcik7XG5cbnZhciBfcGxheWVyRXZlbnRzID0gX2RlcmVxXygnLi9wbGF5ZXIvcGxheWVyLWV2ZW50cy5qcycpO1xuXG52YXIgX3BsYXllckV2ZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wbGF5ZXJFdmVudHMpO1xuXG52YXIgX3BsYXllckVycm9ycyA9IF9kZXJlcV8oJy4vcGxheWVyL3BsYXllci1lcnJvcnMuanMnKTtcblxudmFyIF9sb2dnaW5nQ29udHJvbCA9IF9kZXJlcV8oJy4vdXRpbHMvbG9nZ2luZy1jb250cm9sLmpzJyk7XG5cbnZhciBfbG9nZ2luZ0NvbnRyb2wyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2luZ0NvbnRyb2wpO1xuXG52YXIgX2V4Y2VwdGlvbiA9IF9kZXJlcV8oJy4vdXRpbHMvZXhjZXB0aW9uLmpzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbi8vIGhlcmUgYXJlIGFsbCB0aGUgaW50ZXJmYWNlc1xuXG4vLyBpbnN0YWxsIHBvbHlmaWxsc1xuX3BvbHlmaWxsMi5kZWZhdWx0Lmluc3RhbGwoKTtcblxuLy8gZmFjdG9yeSBtZXRob2RcbmZ1bmN0aW9uIGNyZWF0ZVBsYXllcihtZWRpYURhdGFTb3VyY2UsIG9wdGlvbmFsQ29uZmlnKSB7XG4gICAgdmFyIG1kcyA9IG1lZGlhRGF0YVNvdXJjZTtcbiAgICBpZiAobWRzID09IG51bGwgfHwgKHR5cGVvZiBtZHMgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKG1kcykpICE9PSAnb2JqZWN0Jykge1xuICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbnZhbGlkQXJndW1lbnRFeGNlcHRpb24oJ01lZGlhRGF0YVNvdXJjZSBtdXN0IGJlIGFuIGphdmFzY3JpcHQgb2JqZWN0IScpO1xuICAgIH1cblxuICAgIGlmICghbWRzLmhhc093blByb3BlcnR5KCd0eXBlJykpIHtcbiAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uKCdNZWRpYURhdGFTb3VyY2UgbXVzdCBoYXMgdHlwZSBmaWVsZCB0byBpbmRpY2F0ZSB2aWRlbyBmaWxlIHR5cGUhJyk7XG4gICAgfVxuXG4gICAgc3dpdGNoIChtZHMudHlwZSkge1xuICAgICAgICBjYXNlICdmbHYnOlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBfZmx2UGxheWVyMi5kZWZhdWx0KG1kcywgb3B0aW9uYWxDb25maWcpO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIG5ldyBfbmF0aXZlUGxheWVyMi5kZWZhdWx0KG1kcywgb3B0aW9uYWxDb25maWcpO1xuICAgIH1cbn1cblxuLy8gZmVhdHVyZSBkZXRlY3Rpb25cbmZ1bmN0aW9uIGlzU3VwcG9ydGVkKCkge1xuICAgIHJldHVybiBfZmVhdHVyZXMyLmRlZmF1bHQuc3VwcG9ydE1TRUgyNjRQbGF5YmFjaygpO1xufVxuXG5mdW5jdGlvbiBnZXRGZWF0dXJlTGlzdCgpIHtcbiAgICByZXR1cm4gX2ZlYXR1cmVzMi5kZWZhdWx0LmdldEZlYXR1cmVMaXN0KCk7XG59XG5cbi8vIGludGVyZmFjZXNcbnZhciBmbHZqcyA9IHt9O1xuXG5mbHZqcy5jcmVhdGVQbGF5ZXIgPSBjcmVhdGVQbGF5ZXI7XG5mbHZqcy5pc1N1cHBvcnRlZCA9IGlzU3VwcG9ydGVkO1xuZmx2anMuZ2V0RmVhdHVyZUxpc3QgPSBnZXRGZWF0dXJlTGlzdDtcblxuZmx2anMuQmFzZUxvYWRlciA9IF9sb2FkZXIuQmFzZUxvYWRlcjtcbmZsdmpzLkxvYWRlclN0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzO1xuZmx2anMuTG9hZGVyRXJyb3JzID0gX2xvYWRlci5Mb2FkZXJFcnJvcnM7XG5cbmZsdmpzLkV2ZW50cyA9IF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQ7XG5mbHZqcy5FcnJvclR5cGVzID0gX3BsYXllckVycm9ycy5FcnJvclR5cGVzO1xuZmx2anMuRXJyb3JEZXRhaWxzID0gX3BsYXllckVycm9ycy5FcnJvckRldGFpbHM7XG5cbmZsdmpzLkZsdlBsYXllciA9IF9mbHZQbGF5ZXIyLmRlZmF1bHQ7XG5mbHZqcy5OYXRpdmVQbGF5ZXIgPSBfbmF0aXZlUGxheWVyMi5kZWZhdWx0O1xuZmx2anMuTG9nZ2luZ0NvbnRyb2wgPSBfbG9nZ2luZ0NvbnRyb2wyLmRlZmF1bHQ7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShmbHZqcywgJ3ZlcnNpb24nLCB7XG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgLy8gcmVwbGFjZWQgYnkgYnJvd3NlcmlmeS12ZXJzaW9uaWZ5IHRyYW5zZm9ybVxuICAgICAgICByZXR1cm4gJzEuNi4xJztcbiAgICB9XG59KTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gZmx2anM7XG5cbn0se1wiLi9jb3JlL2ZlYXR1cmVzLmpzXCI6NixcIi4vaW8vbG9hZGVyLmpzXCI6MjQsXCIuL3BsYXllci9mbHYtcGxheWVyLmpzXCI6MzIsXCIuL3BsYXllci9uYXRpdmUtcGxheWVyLmpzXCI6MzMsXCIuL3BsYXllci9wbGF5ZXItZXJyb3JzLmpzXCI6MzQsXCIuL3BsYXllci9wbGF5ZXItZXZlbnRzLmpzXCI6MzUsXCIuL3V0aWxzL2V4Y2VwdGlvbi5qc1wiOjQwLFwiLi91dGlscy9sb2dnaW5nLWNvbnRyb2wuanNcIjo0MixcIi4vdXRpbHMvcG9seWZpbGwuanNcIjo0M31dLDIxOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuLy8gZW50cnkvaW5kZXggZmlsZVxuXG4vLyBtYWtlIGl0IGNvbXBhdGlibGUgd2l0aCBicm93c2VyaWZ5J3MgdW1kIHdyYXBwZXJcbm1vZHVsZS5leHBvcnRzID0gX2RlcmVxXygnLi9mbHYuanMnKS5kZWZhdWx0O1xuXG59LHtcIi4vZmx2LmpzXCI6MjB9XSwyMjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfbG9nZ2VyID0gX2RlcmVxXygnLi4vdXRpbHMvbG9nZ2VyLmpzJyk7XG5cbnZhciBfbG9nZ2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2xvZ2dlcik7XG5cbnZhciBfYnJvd3NlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2Jyb3dzZXIuanMnKTtcblxudmFyIF9icm93c2VyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2Jyb3dzZXIpO1xuXG52YXIgX2xvYWRlciA9IF9kZXJlcV8oJy4vbG9hZGVyLmpzJyk7XG5cbnZhciBfZXhjZXB0aW9uID0gX2RlcmVxXygnLi4vdXRpbHMvZXhjZXB0aW9uLmpzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0gLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuLyogZmV0Y2ggKyBzdHJlYW0gSU8gbG9hZGVyLiBDdXJyZW50bHkgd29ya2luZyBvbiBjaHJvbWUgNDMrLlxyXG4gKiBmZXRjaCBwcm92aWRlcyBhIGJldHRlciBhbHRlcm5hdGl2ZSBodHRwIEFQSSB0byBYTUxIdHRwUmVxdWVzdFxyXG4gKlxyXG4gKiBmZXRjaCBzcGVjICAgaHR0cHM6Ly9mZXRjaC5zcGVjLndoYXR3Zy5vcmcvXHJcbiAqIHN0cmVhbSBzcGVjICBodHRwczovL3N0cmVhbXMuc3BlYy53aGF0d2cub3JnL1xyXG4gKi9cbnZhciBGZXRjaFN0cmVhbUxvYWRlciA9IGZ1bmN0aW9uIChfQmFzZUxvYWRlcikge1xuICAgIF9pbmhlcml0cyhGZXRjaFN0cmVhbUxvYWRlciwgX0Jhc2VMb2FkZXIpO1xuXG4gICAgX2NyZWF0ZUNsYXNzKEZldGNoU3RyZWFtTG9hZGVyLCBudWxsLCBbe1xuICAgICAgICBrZXk6ICdpc1N1cHBvcnRlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpc1N1cHBvcnRlZCgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gZmV0Y2ggKyBzdHJlYW0gaXMgYnJva2VuIG9uIE1pY3Jvc29mdCBFZGdlLiBEaXNhYmxlIGJlZm9yZSBidWlsZCAxNTA0OC5cbiAgICAgICAgICAgICAgICAvLyBzZWUgaHR0cHM6Ly9kZXZlbG9wZXIubWljcm9zb2Z0LmNvbS9lbi11cy9taWNyb3NvZnQtZWRnZS9wbGF0Zm9ybS9pc3N1ZXMvODE5NjkwNy9cbiAgICAgICAgICAgICAgICAvLyBGaXhlZCBpbiBKYW4gMTAsIDIwMTcuIEJ1aWxkIDE1MDQ4KyByZW1vdmVkIGZyb20gYmxhY2tsaXN0LlxuICAgICAgICAgICAgICAgIHZhciBpc1dvcmtXZWxsRWRnZSA9IF9icm93c2VyMi5kZWZhdWx0Lm1zZWRnZSAmJiBfYnJvd3NlcjIuZGVmYXVsdC52ZXJzaW9uLm1pbm9yID49IDE1MDQ4O1xuICAgICAgICAgICAgICAgIHZhciBicm93c2VyTm90QmxhY2tsaXN0ZWQgPSBfYnJvd3NlcjIuZGVmYXVsdC5tc2VkZ2UgPyBpc1dvcmtXZWxsRWRnZSA6IHRydWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuZmV0Y2ggJiYgc2VsZi5SZWFkYWJsZVN0cmVhbSAmJiBicm93c2VyTm90QmxhY2tsaXN0ZWQ7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgZnVuY3Rpb24gRmV0Y2hTdHJlYW1Mb2FkZXIoc2Vla0hhbmRsZXIsIGNvbmZpZykge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRmV0Y2hTdHJlYW1Mb2FkZXIpO1xuXG4gICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChGZXRjaFN0cmVhbUxvYWRlci5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKEZldGNoU3RyZWFtTG9hZGVyKSkuY2FsbCh0aGlzLCAnZmV0Y2gtc3RyZWFtLWxvYWRlcicpKTtcblxuICAgICAgICBfdGhpcy5UQUcgPSAnRmV0Y2hTdHJlYW1Mb2FkZXInO1xuXG4gICAgICAgIF90aGlzLl9zZWVrSGFuZGxlciA9IHNlZWtIYW5kbGVyO1xuICAgICAgICBfdGhpcy5fY29uZmlnID0gY29uZmlnO1xuICAgICAgICBfdGhpcy5fbmVlZFN0YXNoID0gdHJ1ZTtcblxuICAgICAgICBfdGhpcy5fcmVxdWVzdEFib3J0ID0gZmFsc2U7XG4gICAgICAgIF90aGlzLl9jb250ZW50TGVuZ3RoID0gbnVsbDtcbiAgICAgICAgX3RoaXMuX3JlY2VpdmVkTGVuZ3RoID0gMDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhGZXRjaFN0cmVhbUxvYWRlciwgW3tcbiAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNXb3JraW5nKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFib3J0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfZ2V0KEZldGNoU3RyZWFtTG9hZGVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKEZldGNoU3RyZWFtTG9hZGVyLnByb3RvdHlwZSksICdkZXN0cm95JywgdGhpcykuY2FsbCh0aGlzKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb3BlbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuKGRhdGFTb3VyY2UsIHJhbmdlKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgICAgICAgdGhpcy5fZGF0YVNvdXJjZSA9IGRhdGFTb3VyY2U7XG4gICAgICAgICAgICB0aGlzLl9yYW5nZSA9IHJhbmdlO1xuXG4gICAgICAgICAgICB2YXIgc291cmNlVVJMID0gZGF0YVNvdXJjZS51cmw7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29uZmlnLnJldXNlUmVkaXJlY3RlZFVSTCAmJiBkYXRhU291cmNlLnJlZGlyZWN0ZWRVUkwgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc291cmNlVVJMID0gZGF0YVNvdXJjZS5yZWRpcmVjdGVkVVJMO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc2Vla0NvbmZpZyA9IHRoaXMuX3NlZWtIYW5kbGVyLmdldENvbmZpZyhzb3VyY2VVUkwsIHJhbmdlKTtcblxuICAgICAgICAgICAgdmFyIGhlYWRlcnMgPSBuZXcgc2VsZi5IZWFkZXJzKCk7XG5cbiAgICAgICAgICAgIGlmIChfdHlwZW9mKHNlZWtDb25maWcuaGVhZGVycykgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvbmZpZ0hlYWRlcnMgPSBzZWVrQ29uZmlnLmhlYWRlcnM7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGNvbmZpZ0hlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpZ0hlYWRlcnMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycy5hcHBlbmQoa2V5LCBjb25maWdIZWFkZXJzW2tleV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgcGFyYW1zID0ge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgICAgICAgICAgaGVhZGVyczogaGVhZGVycyxcbiAgICAgICAgICAgICAgICBtb2RlOiAnY29ycycsXG4gICAgICAgICAgICAgICAgY2FjaGU6ICdkZWZhdWx0JyxcbiAgICAgICAgICAgICAgICAvLyBUaGUgZGVmYXVsdCBwb2xpY3kgb2YgRmV0Y2ggQVBJIGluIHRoZSB3aGF0d2cgc3RhbmRhcmRcbiAgICAgICAgICAgICAgICAvLyBTYWZhcmkgaW5jb3JyZWN0bHkgaW5kaWNhdGVzICduby1yZWZlcnJlcicgYXMgZGVmYXVsdCBwb2xpY3ksIGZ1Y2sgaXRcbiAgICAgICAgICAgICAgICByZWZlcnJlclBvbGljeTogJ25vLXJlZmVycmVyLXdoZW4tZG93bmdyYWRlJ1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gYWRkIGFkZGl0aW9uYWwgaGVhZGVyc1xuICAgICAgICAgICAgaWYgKF90eXBlb2YodGhpcy5fY29uZmlnLmhlYWRlcnMpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9rZXkgaW4gdGhpcy5fY29uZmlnLmhlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVycy5hcHBlbmQoX2tleSwgdGhpcy5fY29uZmlnLmhlYWRlcnNbX2tleV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gY29ycyBpcyBlbmFibGVkIGJ5IGRlZmF1bHRcbiAgICAgICAgICAgIGlmIChkYXRhU291cmNlLmNvcnMgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgLy8gbm8tY29ycyBtZWFucyAnZGlzcmVnYXJkIGNvcnMgcG9saWN5Jywgd2hpY2ggY2FuIG9ubHkgYmUgdXNlZCBpbiBTZXJ2aWNlV29ya2VyXG4gICAgICAgICAgICAgICAgcGFyYW1zLm1vZGUgPSAnc2FtZS1vcmlnaW4nO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyB3aXRoQ3JlZGVudGlhbHMgaXMgZGlzYWJsZWQgYnkgZGVmYXVsdFxuICAgICAgICAgICAgaWYgKGRhdGFTb3VyY2Uud2l0aENyZWRlbnRpYWxzKSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zLmNyZWRlbnRpYWxzID0gJ2luY2x1ZGUnO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyByZWZlcnJlclBvbGljeSBmcm9tIGNvbmZpZ1xuICAgICAgICAgICAgaWYgKGRhdGFTb3VyY2UucmVmZXJyZXJQb2xpY3kpIHtcbiAgICAgICAgICAgICAgICBwYXJhbXMucmVmZXJyZXJQb2xpY3kgPSBkYXRhU291cmNlLnJlZmVycmVyUG9saWN5O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBhZGQgYWJvcnQgY29udHJvbGxlciwgYnkgd21sZ2wgMjAxOS01LTEwIDEyOjIxOjI3XG4gICAgICAgICAgICBpZiAoc2VsZi5BYm9ydENvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hYm9ydENvbnRyb2xsZXIgPSBuZXcgc2VsZi5BYm9ydENvbnRyb2xsZXIoKTtcbiAgICAgICAgICAgICAgICBwYXJhbXMuc2lnbmFsID0gdGhpcy5fYWJvcnRDb250cm9sbGVyLnNpZ25hbDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Nvbm5lY3Rpbmc7XG4gICAgICAgICAgICBzZWxmLmZldGNoKHNlZWtDb25maWcudXJsLCBwYXJhbXMpLnRoZW4oZnVuY3Rpb24gKHJlcykge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpczIuX3JlcXVlc3RBYm9ydCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczIuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtJZGxlO1xuICAgICAgICAgICAgICAgICAgICByZXMuYm9keS5jYW5jZWwoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocmVzLm9rICYmIHJlcy5zdGF0dXMgPj0gMjAwICYmIHJlcy5zdGF0dXMgPD0gMjk5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZXMudXJsICE9PSBzZWVrQ29uZmlnLnVybCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMi5fb25VUkxSZWRpcmVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWRpcmVjdGVkVVJMID0gX3RoaXMyLl9zZWVrSGFuZGxlci5yZW1vdmVVUkxQYXJhbWV0ZXJzKHJlcy51cmwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMi5fb25VUkxSZWRpcmVjdChyZWRpcmVjdGVkVVJMKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHZhciBsZW5ndGhIZWFkZXIgPSByZXMuaGVhZGVycy5nZXQoJ0NvbnRlbnQtTGVuZ3RoJyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChsZW5ndGhIZWFkZXIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMyLl9jb250ZW50TGVuZ3RoID0gcGFyc2VJbnQobGVuZ3RoSGVhZGVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpczIuX2NvbnRlbnRMZW5ndGggIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLl9vbkNvbnRlbnRMZW5ndGhLbm93bikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczIuX29uQ29udGVudExlbmd0aEtub3duKF90aGlzMi5fY29udGVudExlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzMi5fcHVtcC5jYWxsKF90aGlzMiwgcmVzLmJvZHkuZ2V0UmVhZGVyKCkpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMi5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yO1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLl9vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpczIuX29uRXJyb3IoX2xvYWRlci5Mb2FkZXJFcnJvcnMuSFRUUF9TVEFUVVNfQ09ERV9JTlZBTElELCB7IGNvZGU6IHJlcy5zdGF0dXMsIG1zZzogcmVzLnN0YXR1c1RleHQgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5SdW50aW1lRXhjZXB0aW9uKCdGZXRjaFN0cmVhbUxvYWRlcjogSHR0cCBjb2RlIGludmFsaWQsICcgKyByZXMuc3RhdHVzICsgJyAnICsgcmVzLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoX3RoaXMyLl9hYm9ydENvbnRyb2xsZXIgJiYgX3RoaXMyLl9hYm9ydENvbnRyb2xsZXIuc2lnbmFsLmFib3J0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIF90aGlzMi5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yO1xuICAgICAgICAgICAgICAgIGlmIChfdGhpczIuX29uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLl9vbkVycm9yKF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVYQ0VQVElPTiwgeyBjb2RlOiAtMSwgbXNnOiBlLm1lc3NhZ2UgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYWJvcnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWJvcnQoKSB7XG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0QWJvcnQgPSB0cnVlO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhdHVzICE9PSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQnVmZmVyaW5nIHx8ICFfYnJvd3NlcjIuZGVmYXVsdC5jaHJvbWUpIHtcbiAgICAgICAgICAgICAgICAvLyBDaHJvbWUgbWF5IHRocm93IEV4Y2VwdGlvbi1saWtlIHRoaW5ncyBoZXJlLCBhdm9pZCB1c2luZyBpZiBpcyBidWZmZXJpbmdcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fYWJvcnRDb250cm9sbGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9hYm9ydENvbnRyb2xsZXIuYWJvcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcHVtcCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfcHVtcChyZWFkZXIpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgICAgICAgICAvLyBSZWFkYWJsZVN0cmVhbVJlYWRlclxuICAgICAgICAgICAgcmV0dXJuIHJlYWRlci5yZWFkKCkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5kb25lKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0IGNoZWNrIHJlY2VpdmVkIGxlbmd0aFxuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMzLl9jb250ZW50TGVuZ3RoICE9PSBudWxsICYmIF90aGlzMy5fcmVjZWl2ZWRMZW5ndGggPCBfdGhpczMuX2NvbnRlbnRMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlcG9ydCBFYXJseS1FT0ZcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGUgPSBfbG9hZGVyLkxvYWRlckVycm9ycy5FQVJMWV9FT0Y7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IHsgY29kZTogLTEsIG1zZzogJ0ZldGNoIHN0cmVhbSBtZWV0IEVhcmx5LUVPRicgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpczMuX29uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczMuX29uRXJyb3IodHlwZSwgaW5mbyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLlJ1bnRpbWVFeGNlcHRpb24oaW5mby5tc2cpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT0suIERvd25sb2FkIGNvbXBsZXRlXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpczMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb21wbGV0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfdGhpczMuX29uQ29tcGxldGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczMuX29uQ29tcGxldGUoX3RoaXMzLl9yYW5nZS5mcm9tLCBfdGhpczMuX3JhbmdlLmZyb20gKyBfdGhpczMuX3JlY2VpdmVkTGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMzLl9hYm9ydENvbnRyb2xsZXIgJiYgX3RoaXMzLl9hYm9ydENvbnRyb2xsZXIuc2lnbmFsLmFib3J0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0NvbXBsZXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKF90aGlzMy5fcmVxdWVzdEFib3J0ID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpczMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb21wbGV0ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZWFkZXIuY2FuY2VsKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBfdGhpczMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtCdWZmZXJpbmc7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGNodW5rID0gcmVzdWx0LnZhbHVlLmJ1ZmZlcjtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGJ5dGVTdGFydCA9IF90aGlzMy5fcmFuZ2UuZnJvbSArIF90aGlzMy5fcmVjZWl2ZWRMZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMy5fcmVjZWl2ZWRMZW5ndGggKz0gY2h1bmsuYnl0ZUxlbmd0aDtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMzLl9vbkRhdGFBcnJpdmFsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpczMuX29uRGF0YUFycml2YWwoY2h1bmssIGJ5dGVTdGFydCwgX3RoaXMzLl9yZWNlaXZlZExlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBfdGhpczMuX3B1bXAocmVhZGVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpczMuX2Fib3J0Q29udHJvbGxlciAmJiBfdGhpczMuX2Fib3J0Q29udHJvbGxlci5zaWduYWwuYWJvcnRlZCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb21wbGV0ZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChlLmNvZGUgPT09IDExICYmIF9icm93c2VyMi5kZWZhdWx0Lm1zZWRnZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBJbnZhbGlkU3RhdGVFcnJvciBvbiBNaWNyb3NvZnQgRWRnZVxuICAgICAgICAgICAgICAgICAgICAvLyBXb3JrYXJvdW5kOiBFZGdlIG1heSB0aHJvdyBJbnZhbGlkU3RhdGVFcnJvciBhZnRlciBSZWFkYWJsZVN0cmVhbVJlYWRlci5jYW5jZWwoKSBjYWxsXG4gICAgICAgICAgICAgICAgICAgIC8vIElnbm9yZSB0aGUgdW5rbm93biBleGNlcHRpb24uXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlbGF0ZWQgaXNzdWU6IGh0dHBzOi8vZGV2ZWxvcGVyLm1pY3Jvc29mdC5jb20vZW4tdXMvbWljcm9zb2Z0LWVkZ2UvcGxhdGZvcm0vaXNzdWVzLzExMjY1MjAyL1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX3RoaXMzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3I7XG4gICAgICAgICAgICAgICAgdmFyIHR5cGUgPSAwO1xuICAgICAgICAgICAgICAgIHZhciBpbmZvID0gbnVsbDtcblxuICAgICAgICAgICAgICAgIGlmICgoZS5jb2RlID09PSAxOSB8fCBlLm1lc3NhZ2UgPT09ICduZXR3b3JrIGVycm9yJykgJiYgKCAvLyBORVRXT1JLX0VSUlxuICAgICAgICAgICAgICAgIF90aGlzMy5fY29udGVudExlbmd0aCA9PT0gbnVsbCB8fCBfdGhpczMuX2NvbnRlbnRMZW5ndGggIT09IG51bGwgJiYgX3RoaXMzLl9yZWNlaXZlZExlbmd0aCA8IF90aGlzMy5fY29udGVudExlbmd0aCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9IF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVBUkxZX0VPRjtcbiAgICAgICAgICAgICAgICAgICAgaW5mbyA9IHsgY29kZTogZS5jb2RlLCBtc2c6ICdGZXRjaCBzdHJlYW0gbWVldCBFYXJseS1FT0YnIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZSA9IF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVYQ0VQVElPTjtcbiAgICAgICAgICAgICAgICAgICAgaW5mbyA9IHsgY29kZTogZS5jb2RlLCBtc2c6IGUubWVzc2FnZSB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChfdGhpczMuX29uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMzLl9vbkVycm9yKHR5cGUsIGluZm8pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLlJ1bnRpbWVFeGNlcHRpb24oaW5mby5tc2cpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIEZldGNoU3RyZWFtTG9hZGVyO1xufShfbG9hZGVyLkJhc2VMb2FkZXIpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBGZXRjaFN0cmVhbUxvYWRlcjtcblxufSx7XCIuLi91dGlscy9icm93c2VyLmpzXCI6MzksXCIuLi91dGlscy9leGNlcHRpb24uanNcIjo0MCxcIi4uL3V0aWxzL2xvZ2dlci5qc1wiOjQxLFwiLi9sb2FkZXIuanNcIjoyNH1dLDIzOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9sb2dnZXIgPSBfZGVyZXFfKCcuLi91dGlscy9sb2dnZXIuanMnKTtcblxudmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTtcblxudmFyIF9zcGVlZFNhbXBsZXIgPSBfZGVyZXFfKCcuL3NwZWVkLXNhbXBsZXIuanMnKTtcblxudmFyIF9zcGVlZFNhbXBsZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3BlZWRTYW1wbGVyKTtcblxudmFyIF9sb2FkZXIgPSBfZGVyZXFfKCcuL2xvYWRlci5qcycpO1xuXG52YXIgX2ZldGNoU3RyZWFtTG9hZGVyID0gX2RlcmVxXygnLi9mZXRjaC1zdHJlYW0tbG9hZGVyLmpzJyk7XG5cbnZhciBfZmV0Y2hTdHJlYW1Mb2FkZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZmV0Y2hTdHJlYW1Mb2FkZXIpO1xuXG52YXIgX3hock1vekNodW5rZWRMb2FkZXIgPSBfZGVyZXFfKCcuL3hoci1tb3otY2h1bmtlZC1sb2FkZXIuanMnKTtcblxudmFyIF94aHJNb3pDaHVua2VkTG9hZGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3hock1vekNodW5rZWRMb2FkZXIpO1xuXG52YXIgX3hock1zc3RyZWFtTG9hZGVyID0gX2RlcmVxXygnLi94aHItbXNzdHJlYW0tbG9hZGVyLmpzJyk7XG5cbnZhciBfeGhyTXNzdHJlYW1Mb2FkZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfeGhyTXNzdHJlYW1Mb2FkZXIpO1xuXG52YXIgX3hoclJhbmdlTG9hZGVyID0gX2RlcmVxXygnLi94aHItcmFuZ2UtbG9hZGVyLmpzJyk7XG5cbnZhciBfeGhyUmFuZ2VMb2FkZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfeGhyUmFuZ2VMb2FkZXIpO1xuXG52YXIgX3dlYnNvY2tldExvYWRlciA9IF9kZXJlcV8oJy4vd2Vic29ja2V0LWxvYWRlci5qcycpO1xuXG52YXIgX3dlYnNvY2tldExvYWRlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF93ZWJzb2NrZXRMb2FkZXIpO1xuXG52YXIgX3JhbmdlU2Vla0hhbmRsZXIgPSBfZGVyZXFfKCcuL3JhbmdlLXNlZWstaGFuZGxlci5qcycpO1xuXG52YXIgX3JhbmdlU2Vla0hhbmRsZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmFuZ2VTZWVrSGFuZGxlcik7XG5cbnZhciBfcGFyYW1TZWVrSGFuZGxlciA9IF9kZXJlcV8oJy4vcGFyYW0tc2Vlay1oYW5kbGVyLmpzJyk7XG5cbnZhciBfcGFyYW1TZWVrSGFuZGxlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wYXJhbVNlZWtIYW5kbGVyKTtcblxudmFyIF9leGNlcHRpb24gPSBfZGVyZXFfKCcuLi91dGlscy9leGNlcHRpb24uanMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLyoqXHJcbiAqIERhdGFTb3VyY2U6IHtcclxuICogICAgIHVybDogc3RyaW5nLFxyXG4gKiAgICAgZmlsZXNpemU6IG51bWJlcixcclxuICogICAgIGNvcnM6IGJvb2xlYW4sXHJcbiAqICAgICB3aXRoQ3JlZGVudGlhbHM6IGJvb2xlYW5cclxuICogfVxyXG4gKiBcclxuICovXG5cbi8vIE1hbmFnZSBJTyBMb2FkZXJzXG52YXIgSU9Db250cm9sbGVyID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIElPQ29udHJvbGxlcihkYXRhU291cmNlLCBjb25maWcsIGV4dHJhRGF0YSkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSU9Db250cm9sbGVyKTtcblxuICAgICAgICB0aGlzLlRBRyA9ICdJT0NvbnRyb2xsZXInO1xuXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgdGhpcy5fZXh0cmFEYXRhID0gZXh0cmFEYXRhO1xuXG4gICAgICAgIHRoaXMuX3N0YXNoSW5pdGlhbFNpemUgPSAxMDI0ICogMzg0OyAvLyBkZWZhdWx0IGluaXRpYWwgc2l6ZTogMzg0S0JcbiAgICAgICAgaWYgKGNvbmZpZy5zdGFzaEluaXRpYWxTaXplICE9IHVuZGVmaW5lZCAmJiBjb25maWcuc3Rhc2hJbml0aWFsU2l6ZSA+IDApIHtcbiAgICAgICAgICAgIC8vIGFwcGx5IGZyb20gY29uZmlnXG4gICAgICAgICAgICB0aGlzLl9zdGFzaEluaXRpYWxTaXplID0gY29uZmlnLnN0YXNoSW5pdGlhbFNpemU7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9zdGFzaFVzZWQgPSAwO1xuICAgICAgICB0aGlzLl9zdGFzaFNpemUgPSB0aGlzLl9zdGFzaEluaXRpYWxTaXplO1xuICAgICAgICB0aGlzLl9idWZmZXJTaXplID0gMTAyNCAqIDEwMjQgKiAzOyAvLyBpbml0aWFsIHNpemU6IDNNQlxuICAgICAgICB0aGlzLl9zdGFzaEJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcih0aGlzLl9idWZmZXJTaXplKTtcbiAgICAgICAgdGhpcy5fc3Rhc2hCeXRlU3RhcnQgPSAwO1xuICAgICAgICB0aGlzLl9lbmFibGVTdGFzaCA9IHRydWU7XG4gICAgICAgIGlmIChjb25maWcuZW5hYmxlU3Rhc2hCdWZmZXIgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICB0aGlzLl9lbmFibGVTdGFzaCA9IGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fbG9hZGVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5fbG9hZGVyQ2xhc3MgPSBudWxsO1xuICAgICAgICB0aGlzLl9zZWVrSGFuZGxlciA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5fZGF0YVNvdXJjZSA9IGRhdGFTb3VyY2U7XG4gICAgICAgIHRoaXMuX2lzV2ViU29ja2V0VVJMID0gL3dzcz86XFwvXFwvKC4rPykvLnRlc3QoZGF0YVNvdXJjZS51cmwpO1xuICAgICAgICB0aGlzLl9yZWZUb3RhbExlbmd0aCA9IGRhdGFTb3VyY2UuZmlsZXNpemUgPyBkYXRhU291cmNlLmZpbGVzaXplIDogbnVsbDtcbiAgICAgICAgdGhpcy5fdG90YWxMZW5ndGggPSB0aGlzLl9yZWZUb3RhbExlbmd0aDtcbiAgICAgICAgdGhpcy5fZnVsbFJlcXVlc3RGbGFnID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX2N1cnJlbnRSYW5nZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3JlZGlyZWN0ZWRVUkwgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuX3NwZWVkTm9ybWFsaXplZCA9IDA7XG4gICAgICAgIHRoaXMuX3NwZWVkU2FtcGxlciA9IG5ldyBfc3BlZWRTYW1wbGVyMi5kZWZhdWx0KCk7XG4gICAgICAgIHRoaXMuX3NwZWVkTm9ybWFsaXplTGlzdCA9IFs2NCwgMTI4LCAyNTYsIDM4NCwgNTEyLCA3NjgsIDEwMjQsIDE1MzYsIDIwNDgsIDMwNzIsIDQwOTZdO1xuXG4gICAgICAgIHRoaXMuX2lzRWFybHlFb2ZSZWNvbm5lY3RpbmcgPSBmYWxzZTtcblxuICAgICAgICB0aGlzLl9wYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fcmVzdW1lRnJvbSA9IDA7XG5cbiAgICAgICAgdGhpcy5fb25EYXRhQXJyaXZhbCA9IG51bGw7XG4gICAgICAgIHRoaXMuX29uU2Vla2VkID0gbnVsbDtcbiAgICAgICAgdGhpcy5fb25FcnJvciA9IG51bGw7XG4gICAgICAgIHRoaXMuX29uQ29tcGxldGUgPSBudWxsO1xuICAgICAgICB0aGlzLl9vblJlZGlyZWN0ID0gbnVsbDtcbiAgICAgICAgdGhpcy5fb25SZWNvdmVyZWRFYXJseUVvZiA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5fc2VsZWN0U2Vla0hhbmRsZXIoKTtcbiAgICAgICAgdGhpcy5fc2VsZWN0TG9hZGVyKCk7XG4gICAgICAgIHRoaXMuX2NyZWF0ZUxvYWRlcigpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhJT0NvbnRyb2xsZXIsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9sb2FkZXIuaXNXb3JraW5nKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9sb2FkZXIuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2xvYWRlci5kZXN0cm95KCk7XG4gICAgICAgICAgICB0aGlzLl9sb2FkZXIgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fbG9hZGVyQ2xhc3MgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fZGF0YVNvdXJjZSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9zdGFzaEJ1ZmZlciA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9zdGFzaFVzZWQgPSB0aGlzLl9zdGFzaFNpemUgPSB0aGlzLl9idWZmZXJTaXplID0gdGhpcy5fc3Rhc2hCeXRlU3RhcnQgPSAwO1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFJhbmdlID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX3NwZWVkU2FtcGxlciA9IG51bGw7XG5cbiAgICAgICAgICAgIHRoaXMuX2lzRWFybHlFb2ZSZWNvbm5lY3RpbmcgPSBmYWxzZTtcblxuICAgICAgICAgICAgdGhpcy5fb25EYXRhQXJyaXZhbCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vblNlZWtlZCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vbkVycm9yID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uQ29tcGxldGUgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25SZWRpcmVjdCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vblJlY292ZXJlZEVhcmx5RW9mID0gbnVsbDtcblxuICAgICAgICAgICAgdGhpcy5fZXh0cmFEYXRhID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnaXNXb3JraW5nJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzV29ya2luZygpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2FkZXIgJiYgdGhpcy5fbG9hZGVyLmlzV29ya2luZygpICYmICF0aGlzLl9wYXVzZWQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2lzUGF1c2VkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzUGF1c2VkKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3BhdXNlZDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3NlbGVjdFNlZWtIYW5kbGVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9zZWxlY3RTZWVrSGFuZGxlcigpIHtcbiAgICAgICAgICAgIHZhciBjb25maWcgPSB0aGlzLl9jb25maWc7XG5cbiAgICAgICAgICAgIGlmIChjb25maWcuc2Vla1R5cGUgPT09ICdyYW5nZScpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zZWVrSGFuZGxlciA9IG5ldyBfcmFuZ2VTZWVrSGFuZGxlcjIuZGVmYXVsdCh0aGlzLl9jb25maWcucmFuZ2VMb2FkWmVyb1N0YXJ0KTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnNlZWtUeXBlID09PSAncGFyYW0nKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmFtU3RhcnQgPSBjb25maWcuc2Vla1BhcmFtU3RhcnQgfHwgJ2JzdGFydCc7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmFtRW5kID0gY29uZmlnLnNlZWtQYXJhbUVuZCB8fCAnYmVuZCc7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9zZWVrSGFuZGxlciA9IG5ldyBfcGFyYW1TZWVrSGFuZGxlcjIuZGVmYXVsdChwYXJhbVN0YXJ0LCBwYXJhbUVuZCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGNvbmZpZy5zZWVrVHlwZSA9PT0gJ2N1c3RvbScpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGNvbmZpZy5jdXN0b21TZWVrSGFuZGxlciAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbnZhbGlkQXJndW1lbnRFeGNlcHRpb24oJ0N1c3RvbSBzZWVrVHlwZSBzcGVjaWZpZWQgaW4gY29uZmlnIGJ1dCBpbnZhbGlkIGN1c3RvbVNlZWtIYW5kbGVyIScpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9zZWVrSGFuZGxlciA9IG5ldyBjb25maWcuY3VzdG9tU2Vla0hhbmRsZXIoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uKCdJbnZhbGlkIHNlZWtUeXBlIGluIGNvbmZpZzogJyArIGNvbmZpZy5zZWVrVHlwZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19zZWxlY3RMb2FkZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3NlbGVjdExvYWRlcigpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9jb25maWcuY3VzdG9tTG9hZGVyICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9sb2FkZXJDbGFzcyA9IHRoaXMuX2NvbmZpZy5jdXN0b21Mb2FkZXI7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2lzV2ViU29ja2V0VVJMKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZGVyQ2xhc3MgPSBfd2Vic29ja2V0TG9hZGVyMi5kZWZhdWx0O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChfZmV0Y2hTdHJlYW1Mb2FkZXIyLmRlZmF1bHQuaXNTdXBwb3J0ZWQoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRlckNsYXNzID0gX2ZldGNoU3RyZWFtTG9hZGVyMi5kZWZhdWx0O1xuICAgICAgICAgICAgfSBlbHNlIGlmIChfeGhyTW96Q2h1bmtlZExvYWRlcjIuZGVmYXVsdC5pc1N1cHBvcnRlZCgpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZGVyQ2xhc3MgPSBfeGhyTW96Q2h1bmtlZExvYWRlcjIuZGVmYXVsdDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoX3hoclJhbmdlTG9hZGVyMi5kZWZhdWx0LmlzU3VwcG9ydGVkKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9sb2FkZXJDbGFzcyA9IF94aHJSYW5nZUxvYWRlcjIuZGVmYXVsdDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uUnVudGltZUV4Y2VwdGlvbignWW91ciBicm93c2VyIGRvZXNuXFwndCBzdXBwb3J0IHhociB3aXRoIGFycmF5YnVmZmVyIHJlc3BvbnNlVHlwZSEnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2NyZWF0ZUxvYWRlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfY3JlYXRlTG9hZGVyKCkge1xuICAgICAgICAgICAgdGhpcy5fbG9hZGVyID0gbmV3IHRoaXMuX2xvYWRlckNsYXNzKHRoaXMuX3NlZWtIYW5kbGVyLCB0aGlzLl9jb25maWcpO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2xvYWRlci5uZWVkU3Rhc2hCdWZmZXIgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZW5hYmxlU3Rhc2ggPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2xvYWRlci5vbkNvbnRlbnRMZW5ndGhLbm93biA9IHRoaXMuX29uQ29udGVudExlbmd0aEtub3duLmJpbmQodGhpcyk7XG4gICAgICAgICAgICB0aGlzLl9sb2FkZXIub25VUkxSZWRpcmVjdCA9IHRoaXMuX29uVVJMUmVkaXJlY3QuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuX2xvYWRlci5vbkRhdGFBcnJpdmFsID0gdGhpcy5fb25Mb2FkZXJDaHVua0Fycml2YWwuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuX2xvYWRlci5vbkNvbXBsZXRlID0gdGhpcy5fb25Mb2FkZXJDb21wbGV0ZS5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5fbG9hZGVyLm9uRXJyb3IgPSB0aGlzLl9vbkxvYWRlckVycm9yLmJpbmQodGhpcyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29wZW4nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb3BlbihvcHRpb25hbEZyb20pIHtcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRSYW5nZSA9IHsgZnJvbTogMCwgdG86IC0xIH07XG4gICAgICAgICAgICBpZiAob3B0aW9uYWxGcm9tKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudFJhbmdlLmZyb20gPSBvcHRpb25hbEZyb207XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3NwZWVkU2FtcGxlci5yZXNldCgpO1xuICAgICAgICAgICAgaWYgKCFvcHRpb25hbEZyb20pIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9mdWxsUmVxdWVzdEZsYWcgPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9sb2FkZXIub3Blbih0aGlzLl9kYXRhU291cmNlLCBPYmplY3QuYXNzaWduKHt9LCB0aGlzLl9jdXJyZW50UmFuZ2UpKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYWJvcnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWJvcnQoKSB7XG4gICAgICAgICAgICB0aGlzLl9sb2FkZXIuYWJvcnQoKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX3BhdXNlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3BhdXNlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc3VtZUZyb20gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwYXVzZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzV29ya2luZygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZGVyLmFib3J0KCk7XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3Rhc2hVc2VkICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Jlc3VtZUZyb20gPSB0aGlzLl9zdGFzaEJ5dGVTdGFydDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudFJhbmdlLnRvID0gdGhpcy5fc3Rhc2hCeXRlU3RhcnQgLSAxO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Jlc3VtZUZyb20gPSB0aGlzLl9jdXJyZW50UmFuZ2UudG8gKyAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaFVzZWQgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoQnl0ZVN0YXJ0ID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLl9wYXVzZWQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZXN1bWUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVzdW1lKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3BhdXNlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3BhdXNlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBieXRlcyA9IHRoaXMuX3Jlc3VtZUZyb207XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVzdW1lRnJvbSA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5faW50ZXJuYWxTZWVrKGJ5dGVzLCB0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc2VlaycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZWVrKGJ5dGVzKSB7XG4gICAgICAgICAgICB0aGlzLl9wYXVzZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX3N0YXNoVXNlZCA9IDA7XG4gICAgICAgICAgICB0aGlzLl9zdGFzaEJ5dGVTdGFydCA9IDA7XG4gICAgICAgICAgICB0aGlzLl9pbnRlcm5hbFNlZWsoYnl0ZXMsIHRydWUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogV2hlbiBzZWVraW5nIHJlcXVlc3QgaXMgZnJvbSBtZWRpYSBzZWVraW5nLCB1bmNvbnN1bWVkIHN0YXNoIGRhdGEgc2hvdWxkIGJlIGRyb3BwZWRcclxuICAgICAgICAgKiBIb3dldmVyLCBzdGFzaCBkYXRhIHNob3VsZG4ndCBiZSBkcm9wcGVkIGlmIHNlZWtpbmcgcmVxdWVzdGVkIGZyb20gaHR0cCByZWNvbm5lY3Rpb25cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBkcm9wVW5jb25zdW1lZDogSWdub3JlIGFuZCBkaXNjYXJkIGFsbCB1bmNvbnN1bWVkIGRhdGEgaW4gc3Rhc2ggYnVmZmVyXHJcbiAgICAgICAgICovXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19pbnRlcm5hbFNlZWsnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2ludGVybmFsU2VlayhieXRlcywgZHJvcFVuY29uc3VtZWQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9sb2FkZXIuaXNXb3JraW5nKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9sb2FkZXIuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gZGlzcGF0Y2ggJiBmbHVzaCBzdGFzaCBidWZmZXIgYmVmb3JlIHNlZWtcbiAgICAgICAgICAgIHRoaXMuX2ZsdXNoU3Rhc2hCdWZmZXIoZHJvcFVuY29uc3VtZWQpO1xuXG4gICAgICAgICAgICB0aGlzLl9sb2FkZXIuZGVzdHJveSgpO1xuICAgICAgICAgICAgdGhpcy5fbG9hZGVyID0gbnVsbDtcblxuICAgICAgICAgICAgdmFyIHJlcXVlc3RSYW5nZSA9IHsgZnJvbTogYnl0ZXMsIHRvOiAtMSB9O1xuICAgICAgICAgICAgdGhpcy5fY3VycmVudFJhbmdlID0geyBmcm9tOiByZXF1ZXN0UmFuZ2UuZnJvbSwgdG86IC0xIH07XG5cbiAgICAgICAgICAgIHRoaXMuX3NwZWVkU2FtcGxlci5yZXNldCgpO1xuICAgICAgICAgICAgdGhpcy5fc3Rhc2hTaXplID0gdGhpcy5fc3Rhc2hJbml0aWFsU2l6ZTtcbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZUxvYWRlcigpO1xuICAgICAgICAgICAgdGhpcy5fbG9hZGVyLm9wZW4odGhpcy5fZGF0YVNvdXJjZSwgcmVxdWVzdFJhbmdlKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX29uU2Vla2VkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25TZWVrZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndXBkYXRlVXJsJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZVVybCh1cmwpIHtcbiAgICAgICAgICAgIGlmICghdXJsIHx8IHR5cGVvZiB1cmwgIT09ICdzdHJpbmcnIHx8IHVybC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbnZhbGlkQXJndW1lbnRFeGNlcHRpb24oJ1VybCBtdXN0IGJlIGEgbm9uLWVtcHR5IHN0cmluZyEnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fZGF0YVNvdXJjZS51cmwgPSB1cmw7XG5cbiAgICAgICAgICAgIC8vIFRPRE86IHJlcGxhY2Ugd2l0aCBuZXcgdXJsXG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19leHBhbmRCdWZmZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2V4cGFuZEJ1ZmZlcihleHBlY3RlZEJ5dGVzKSB7XG4gICAgICAgICAgICB2YXIgYnVmZmVyTmV3U2l6ZSA9IHRoaXMuX3N0YXNoU2l6ZTtcbiAgICAgICAgICAgIHdoaWxlIChidWZmZXJOZXdTaXplICsgMTAyNCAqIDEwMjQgKiAxIDwgZXhwZWN0ZWRCeXRlcykge1xuICAgICAgICAgICAgICAgIGJ1ZmZlck5ld1NpemUgKj0gMjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYnVmZmVyTmV3U2l6ZSArPSAxMDI0ICogMTAyNCAqIDE7IC8vIGJ1ZmZlclNpemUgPSBzdGFzaFNpemUgKyAxTUJcbiAgICAgICAgICAgIGlmIChidWZmZXJOZXdTaXplID09PSB0aGlzLl9idWZmZXJTaXplKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbmV3QnVmZmVyID0gbmV3IEFycmF5QnVmZmVyKGJ1ZmZlck5ld1NpemUpO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fc3Rhc2hVc2VkID4gMCkge1xuICAgICAgICAgICAgICAgIC8vIGNvcHkgZXhpc3RpbmcgZGF0YSBpbnRvIG5ldyBidWZmZXJcbiAgICAgICAgICAgICAgICB2YXIgc3Rhc2hPbGRBcnJheSA9IG5ldyBVaW50OEFycmF5KHRoaXMuX3N0YXNoQnVmZmVyLCAwLCB0aGlzLl9zdGFzaFVzZWQpO1xuICAgICAgICAgICAgICAgIHZhciBzdGFzaE5ld0FycmF5ID0gbmV3IFVpbnQ4QXJyYXkobmV3QnVmZmVyLCAwLCBidWZmZXJOZXdTaXplKTtcbiAgICAgICAgICAgICAgICBzdGFzaE5ld0FycmF5LnNldChzdGFzaE9sZEFycmF5LCAwKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fc3Rhc2hCdWZmZXIgPSBuZXdCdWZmZXI7XG4gICAgICAgICAgICB0aGlzLl9idWZmZXJTaXplID0gYnVmZmVyTmV3U2l6ZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX25vcm1hbGl6ZVNwZWVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9ub3JtYWxpemVTcGVlZChpbnB1dCkge1xuICAgICAgICAgICAgdmFyIGxpc3QgPSB0aGlzLl9zcGVlZE5vcm1hbGl6ZUxpc3Q7XG4gICAgICAgICAgICB2YXIgbGFzdCA9IGxpc3QubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIHZhciBtaWQgPSAwO1xuICAgICAgICAgICAgdmFyIGxib3VuZCA9IDA7XG4gICAgICAgICAgICB2YXIgdWJvdW5kID0gbGFzdDtcblxuICAgICAgICAgICAgaWYgKGlucHV0IDwgbGlzdFswXSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBsaXN0WzBdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBiaW5hcnkgc2VhcmNoXG4gICAgICAgICAgICB3aGlsZSAobGJvdW5kIDw9IHVib3VuZCkge1xuICAgICAgICAgICAgICAgIG1pZCA9IGxib3VuZCArIE1hdGguZmxvb3IoKHVib3VuZCAtIGxib3VuZCkgLyAyKTtcbiAgICAgICAgICAgICAgICBpZiAobWlkID09PSBsYXN0IHx8IGlucHV0ID49IGxpc3RbbWlkXSAmJiBpbnB1dCA8IGxpc3RbbWlkICsgMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpc3RbbWlkXTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxpc3RbbWlkXSA8IGlucHV0KSB7XG4gICAgICAgICAgICAgICAgICAgIGxib3VuZCA9IG1pZCArIDE7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdWJvdW5kID0gbWlkIC0gMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19hZGp1c3RTdGFzaFNpemUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2FkanVzdFN0YXNoU2l6ZShub3JtYWxpemVkKSB7XG4gICAgICAgICAgICB2YXIgc3Rhc2hTaXplS0IgPSAwO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fY29uZmlnLmlzTGl2ZSkge1xuICAgICAgICAgICAgICAgIC8vIGxpdmUgc3RyZWFtOiBhbHdheXMgdXNlIHNpbmdsZSBub3JtYWxpemVkIHNwZWVkIGZvciBzaXplIG9mIHN0YXNoU2l6ZUtCXG4gICAgICAgICAgICAgICAgc3Rhc2hTaXplS0IgPSBub3JtYWxpemVkO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAobm9ybWFsaXplZCA8IDUxMikge1xuICAgICAgICAgICAgICAgICAgICBzdGFzaFNpemVLQiA9IG5vcm1hbGl6ZWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChub3JtYWxpemVkID49IDUxMiAmJiBub3JtYWxpemVkIDw9IDEwMjQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3Rhc2hTaXplS0IgPSBNYXRoLmZsb29yKG5vcm1hbGl6ZWQgKiAxLjUpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXNoU2l6ZUtCID0gbm9ybWFsaXplZCAqIDI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoc3Rhc2hTaXplS0IgPiA4MTkyKSB7XG4gICAgICAgICAgICAgICAgc3Rhc2hTaXplS0IgPSA4MTkyO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgYnVmZmVyU2l6ZSA9IHN0YXNoU2l6ZUtCICogMTAyNCArIDEwMjQgKiAxMDI0ICogMTsgLy8gc3Rhc2hTaXplICsgMU1CXG4gICAgICAgICAgICBpZiAodGhpcy5fYnVmZmVyU2l6ZSA8IGJ1ZmZlclNpemUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9leHBhbmRCdWZmZXIoYnVmZmVyU2l6ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9zdGFzaFNpemUgPSBzdGFzaFNpemVLQiAqIDEwMjQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19kaXNwYXRjaENodW5rcycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZGlzcGF0Y2hDaHVua3MoY2h1bmtzLCBieXRlU3RhcnQpIHtcbiAgICAgICAgICAgIHRoaXMuX2N1cnJlbnRSYW5nZS50byA9IGJ5dGVTdGFydCArIGNodW5rcy5ieXRlTGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vbkRhdGFBcnJpdmFsKGNodW5rcywgYnl0ZVN0YXJ0KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uVVJMUmVkaXJlY3QnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uVVJMUmVkaXJlY3QocmVkaXJlY3RlZFVSTCkge1xuICAgICAgICAgICAgdGhpcy5fcmVkaXJlY3RlZFVSTCA9IHJlZGlyZWN0ZWRVUkw7XG4gICAgICAgICAgICBpZiAodGhpcy5fb25SZWRpcmVjdCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uUmVkaXJlY3QocmVkaXJlY3RlZFVSTCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbkNvbnRlbnRMZW5ndGhLbm93bicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Db250ZW50TGVuZ3RoS25vd24oY29udGVudExlbmd0aCkge1xuICAgICAgICAgICAgaWYgKGNvbnRlbnRMZW5ndGggJiYgdGhpcy5fZnVsbFJlcXVlc3RGbGFnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdG90YWxMZW5ndGggPSBjb250ZW50TGVuZ3RoO1xuICAgICAgICAgICAgICAgIHRoaXMuX2Z1bGxSZXF1ZXN0RmxhZyA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Mb2FkZXJDaHVua0Fycml2YWwnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uTG9hZGVyQ2h1bmtBcnJpdmFsKGNodW5rLCBieXRlU3RhcnQsIHJlY2VpdmVkTGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX29uRGF0YUFycml2YWwpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbGxlZ2FsU3RhdGVFeGNlcHRpb24oJ0lPQ29udHJvbGxlcjogTm8gZXhpc3RpbmcgY29uc3VtZXIgKG9uRGF0YUFycml2YWwpIGNhbGxiYWNrIScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX3BhdXNlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl9pc0Vhcmx5RW9mUmVjb25uZWN0aW5nKSB7XG4gICAgICAgICAgICAgICAgLy8gQXV0by1yZWNvbm5lY3QgZm9yIEVhcmx5RW9mIHN1Y2NlZWQsIG5vdGlmeSB0byB1cHBlci1sYXllciBieSBjYWxsYmFja1xuICAgICAgICAgICAgICAgIHRoaXMuX2lzRWFybHlFb2ZSZWNvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25SZWNvdmVyZWRFYXJseUVvZikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vblJlY292ZXJlZEVhcmx5RW9mKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9zcGVlZFNhbXBsZXIuYWRkQnl0ZXMoY2h1bmsuYnl0ZUxlbmd0aCk7XG5cbiAgICAgICAgICAgIC8vIGFkanVzdCBzdGFzaCBidWZmZXIgc2l6ZSBhY2NvcmRpbmcgdG8gbmV0d29yayBzcGVlZCBkeW5hbWljYWxseVxuICAgICAgICAgICAgdmFyIEtCcHMgPSB0aGlzLl9zcGVlZFNhbXBsZXIubGFzdFNlY29uZEtCcHM7XG4gICAgICAgICAgICBpZiAoS0JwcyAhPT0gMCkge1xuICAgICAgICAgICAgICAgIHZhciBub3JtYWxpemVkID0gdGhpcy5fbm9ybWFsaXplU3BlZWQoS0Jwcyk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3NwZWVkTm9ybWFsaXplZCAhPT0gbm9ybWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zcGVlZE5vcm1hbGl6ZWQgPSBub3JtYWxpemVkO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9hZGp1c3RTdGFzaFNpemUobm9ybWFsaXplZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXRoaXMuX2VuYWJsZVN0YXNoKSB7XG4gICAgICAgICAgICAgICAgLy8gZGlzYWJsZSBzdGFzaFxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdGFzaFVzZWQgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZGlzcGF0Y2ggY2h1bmsgZGlyZWN0bHkgdG8gY29uc3VtZXI7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIHJldCB2YWx1ZSAoY29uc3VtZWQgYnl0ZXMpIGFuZCBzdGFzaCB1bmNvbnN1bWVkIHRvIHN0YXNoQnVmZmVyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb25zdW1lZCA9IHRoaXMuX2Rpc3BhdGNoQ2h1bmtzKGNodW5rLCBieXRlU3RhcnQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29uc3VtZWQgPCBjaHVuay5ieXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB1bmNvbnN1bWVkIGRhdGEgcmVtYWluLlxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbWFpbiA9IGNodW5rLmJ5dGVMZW5ndGggLSBjb25zdW1lZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZW1haW4gPiB0aGlzLl9idWZmZXJTaXplKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZXhwYW5kQnVmZmVyKHJlbWFpbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3Rhc2hBcnJheSA9IG5ldyBVaW50OEFycmF5KHRoaXMuX3N0YXNoQnVmZmVyLCAwLCB0aGlzLl9idWZmZXJTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXNoQXJyYXkuc2V0KG5ldyBVaW50OEFycmF5KGNodW5rLCBjb25zdW1lZCksIDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hVc2VkICs9IHJlbWFpbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoQnl0ZVN0YXJ0ID0gYnl0ZVN0YXJ0ICsgY29uc3VtZWQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBlbHNlOiBNZXJnZSBjaHVuayBpbnRvIHN0YXNoQnVmZmVyLCBhbmQgZGlzcGF0Y2ggc3Rhc2hCdWZmZXIgdG8gY29uc3VtZXIuXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdGFzaFVzZWQgKyBjaHVuay5ieXRlTGVuZ3RoID4gdGhpcy5fYnVmZmVyU2l6ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZXhwYW5kQnVmZmVyKHRoaXMuX3N0YXNoVXNlZCArIGNodW5rLmJ5dGVMZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBfc3Rhc2hBcnJheSA9IG5ldyBVaW50OEFycmF5KHRoaXMuX3N0YXNoQnVmZmVyLCAwLCB0aGlzLl9idWZmZXJTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgX3N0YXNoQXJyYXkuc2V0KG5ldyBVaW50OEFycmF5KGNodW5rKSwgdGhpcy5fc3Rhc2hVc2VkKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hVc2VkICs9IGNodW5rLmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfY29uc3VtZWQgPSB0aGlzLl9kaXNwYXRjaENodW5rcyh0aGlzLl9zdGFzaEJ1ZmZlci5zbGljZSgwLCB0aGlzLl9zdGFzaFVzZWQpLCB0aGlzLl9zdGFzaEJ5dGVTdGFydCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfY29uc3VtZWQgPCB0aGlzLl9zdGFzaFVzZWQgJiYgX2NvbnN1bWVkID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdW5jb25zdW1lZCBkYXRhIHJlbWFpblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbWFpbkFycmF5ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5fc3Rhc2hCdWZmZXIsIF9jb25zdW1lZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfc3Rhc2hBcnJheS5zZXQocmVtYWluQXJyYXksIDApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoVXNlZCAtPSBfY29uc3VtZWQ7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoQnl0ZVN0YXJ0ICs9IF9jb25zdW1lZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGVuYWJsZSBzdGFzaFxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdGFzaFVzZWQgPT09IDAgJiYgdGhpcy5fc3Rhc2hCeXRlU3RhcnQgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gc2Vla2VkPyBvciBpbml0IGNodW5rP1xuICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIGlzIHRoZSBmaXJzdCBjaHVuayBhZnRlciBzZWVrIGFjdGlvblxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaEJ5dGVTdGFydCA9IGJ5dGVTdGFydDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXNoVXNlZCArIGNodW5rLmJ5dGVMZW5ndGggPD0gdGhpcy5fc3Rhc2hTaXplKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGp1c3Qgc3Rhc2hcbiAgICAgICAgICAgICAgICAgICAgdmFyIF9zdGFzaEFycmF5MiA9IG5ldyBVaW50OEFycmF5KHRoaXMuX3N0YXNoQnVmZmVyLCAwLCB0aGlzLl9zdGFzaFNpemUpO1xuICAgICAgICAgICAgICAgICAgICBfc3Rhc2hBcnJheTIuc2V0KG5ldyBVaW50OEFycmF5KGNodW5rKSwgdGhpcy5fc3Rhc2hVc2VkKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hVc2VkICs9IGNodW5rLmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gc3Rhc2hVc2VkICsgY2h1bmtTaXplID4gc3Rhc2hTaXplLCBzaXplIGxpbWl0IGV4Y2VlZGVkXG4gICAgICAgICAgICAgICAgICAgIHZhciBfc3Rhc2hBcnJheTMgPSBuZXcgVWludDhBcnJheSh0aGlzLl9zdGFzaEJ1ZmZlciwgMCwgdGhpcy5fYnVmZmVyU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdGFzaFVzZWQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBUaGVyZSdyZSBzdGFzaCBkYXRhcyBpbiBidWZmZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpc3BhdGNoIHRoZSB3aG9sZSBzdGFzaEJ1ZmZlciwgYW5kIHN0YXNoIHJlbWFpbiBkYXRhXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGVuIGFwcGVuZCBjaHVuayB0byBzdGFzaEJ1ZmZlciAoc3Rhc2gpXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYnVmZmVyID0gdGhpcy5fc3Rhc2hCdWZmZXIuc2xpY2UoMCwgdGhpcy5fc3Rhc2hVc2VkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfY29uc3VtZWQyID0gdGhpcy5fZGlzcGF0Y2hDaHVua3MoYnVmZmVyLCB0aGlzLl9zdGFzaEJ5dGVTdGFydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2NvbnN1bWVkMiA8IGJ1ZmZlci5ieXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9jb25zdW1lZDIgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfcmVtYWluQXJyYXkgPSBuZXcgVWludDhBcnJheShidWZmZXIsIF9jb25zdW1lZDIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfc3Rhc2hBcnJheTMuc2V0KF9yZW1haW5BcnJheSwgMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoVXNlZCA9IF9yZW1haW5BcnJheS5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaEJ5dGVTdGFydCArPSBfY29uc3VtZWQyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hVc2VkID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaEJ5dGVTdGFydCArPSBfY29uc3VtZWQyO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXNoVXNlZCArIGNodW5rLmJ5dGVMZW5ndGggPiB0aGlzLl9idWZmZXJTaXplKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZXhwYW5kQnVmZmVyKHRoaXMuX3N0YXNoVXNlZCArIGNodW5rLmJ5dGVMZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zdGFzaEFycmF5MyA9IG5ldyBVaW50OEFycmF5KHRoaXMuX3N0YXNoQnVmZmVyLCAwLCB0aGlzLl9idWZmZXJTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIF9zdGFzaEFycmF5My5zZXQobmV3IFVpbnQ4QXJyYXkoY2h1bmspLCB0aGlzLl9zdGFzaFVzZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hVc2VkICs9IGNodW5rLmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzdGFzaCBidWZmZXIgZW1wdHksIGJ1dCBjaHVua1NpemUgPiBzdGFzaFNpemUgKG9oLCBob2x5IHNoaXQpXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBkaXNwYXRjaCBjaHVuayBkaXJlY3RseSBhbmQgc3Rhc2ggcmVtYWluIGRhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBfY29uc3VtZWQzID0gdGhpcy5fZGlzcGF0Y2hDaHVua3MoY2h1bmssIGJ5dGVTdGFydCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2NvbnN1bWVkMyA8IGNodW5rLmJ5dGVMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3JlbWFpbiA9IGNodW5rLmJ5dGVMZW5ndGggLSBfY29uc3VtZWQzO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfcmVtYWluID4gdGhpcy5fYnVmZmVyU2l6ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9leHBhbmRCdWZmZXIoX3JlbWFpbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9zdGFzaEFycmF5MyA9IG5ldyBVaW50OEFycmF5KHRoaXMuX3N0YXNoQnVmZmVyLCAwLCB0aGlzLl9idWZmZXJTaXplKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3N0YXNoQXJyYXkzLnNldChuZXcgVWludDhBcnJheShjaHVuaywgX2NvbnN1bWVkMyksIDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoVXNlZCArPSBfcmVtYWluO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoQnl0ZVN0YXJ0ID0gYnl0ZVN0YXJ0ICsgX2NvbnN1bWVkMztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2ZsdXNoU3Rhc2hCdWZmZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2ZsdXNoU3Rhc2hCdWZmZXIoZHJvcFVuY29uc3VtZWQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGFzaFVzZWQgPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJ1ZmZlciA9IHRoaXMuX3N0YXNoQnVmZmVyLnNsaWNlKDAsIHRoaXMuX3N0YXNoVXNlZCk7XG4gICAgICAgICAgICAgICAgdmFyIGNvbnN1bWVkID0gdGhpcy5fZGlzcGF0Y2hDaHVua3MoYnVmZmVyLCB0aGlzLl9zdGFzaEJ5dGVTdGFydCk7XG4gICAgICAgICAgICAgICAgdmFyIHJlbWFpbiA9IGJ1ZmZlci5ieXRlTGVuZ3RoIC0gY29uc3VtZWQ7XG5cbiAgICAgICAgICAgICAgICBpZiAoY29uc3VtZWQgPCBidWZmZXIuYnl0ZUxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZHJvcFVuY29uc3VtZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgcmVtYWluICsgJyBieXRlcyB1bmNvbnN1bWVkIGRhdGEgcmVtYWluIHdoZW4gZmx1c2ggYnVmZmVyLCBkcm9wcGVkJyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29uc3VtZWQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXNoQXJyYXkgPSBuZXcgVWludDhBcnJheSh0aGlzLl9zdGFzaEJ1ZmZlciwgMCwgdGhpcy5fYnVmZmVyU2l6ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlbWFpbkFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoYnVmZmVyLCBjb25zdW1lZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3Rhc2hBcnJheS5zZXQocmVtYWluQXJyYXksIDApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoVXNlZCA9IHJlbWFpbkFycmF5LmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3Rhc2hCeXRlU3RhcnQgKz0gY29uc3VtZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9zdGFzaFVzZWQgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXNoQnl0ZVN0YXJ0ID0gMDtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVtYWluO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbkxvYWRlckNvbXBsZXRlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkxvYWRlckNvbXBsZXRlKGZyb20sIHRvKSB7XG4gICAgICAgICAgICAvLyBGb3JjZS1mbHVzaCBzdGFzaCBidWZmZXIsIGFuZCBkcm9wIHVuY29uc3VtZWQgZGF0YVxuICAgICAgICAgICAgdGhpcy5fZmx1c2hTdGFzaEJ1ZmZlcih0cnVlKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX29uQ29tcGxldGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkNvbXBsZXRlKHRoaXMuX2V4dHJhRGF0YSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbkxvYWRlckVycm9yJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkxvYWRlckVycm9yKHR5cGUsIGRhdGEpIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuZSh0aGlzLlRBRywgJ0xvYWRlciBlcnJvciwgY29kZSA9ICcgKyBkYXRhLmNvZGUgKyAnLCBtc2cgPSAnICsgZGF0YS5tc2cpO1xuXG4gICAgICAgICAgICB0aGlzLl9mbHVzaFN0YXNoQnVmZmVyKGZhbHNlKTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzRWFybHlFb2ZSZWNvbm5lY3RpbmcpIHtcbiAgICAgICAgICAgICAgICAvLyBBdXRvLXJlY29ubmVjdCBmb3IgRWFybHlFb2YgZmFpbGVkLCB0aHJvdyBVbnJlY292ZXJhYmxlRWFybHlFb2YgZXJyb3IgdG8gdXBwZXItbGF5ZXJcbiAgICAgICAgICAgICAgICB0aGlzLl9pc0Vhcmx5RW9mUmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdHlwZSA9IF9sb2FkZXIuTG9hZGVyRXJyb3JzLlVOUkVDT1ZFUkFCTEVfRUFSTFlfRU9GO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVBUkxZX0VPRjpcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9jb25maWcuaXNMaXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRG8gaW50ZXJuYWwgaHR0cCByZWNvbm5lY3QgaWYgbm90IGxpdmUgc3RyZWFtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3RvdGFsTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXh0RnJvbSA9IHRoaXMuX2N1cnJlbnRSYW5nZS50byArIDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXh0RnJvbSA8IHRoaXMuX3RvdGFsTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncodGhpcy5UQUcsICdDb25uZWN0aW9uIGxvc3QsIHRyeWluZyByZWNvbm5lY3QuLi4nKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2lzRWFybHlFb2ZSZWNvbm5lY3RpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faW50ZXJuYWxTZWVrKG5leHRGcm9tLCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlbHNlOiBXZSBkb24ndCBrbm93IHRvdGFsTGVuZ3RoLCB0aHJvdyBVbnJlY292ZXJhYmxlRWFybHlFb2ZcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxpdmUgc3RyZWFtOiB0aHJvdyBVbnJlY292ZXJhYmxlRWFybHlFb2YgZXJyb3IgdG8gdXBwZXItbGF5ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSBfbG9hZGVyLkxvYWRlckVycm9ycy5VTlJFQ09WRVJBQkxFX0VBUkxZX0VPRjtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBfbG9hZGVyLkxvYWRlckVycm9ycy5VTlJFQ09WRVJBQkxFX0VBUkxZX0VPRjpcbiAgICAgICAgICAgICAgICBjYXNlIF9sb2FkZXIuTG9hZGVyRXJyb3JzLkNPTk5FQ1RJTkdfVElNRU9VVDpcbiAgICAgICAgICAgICAgICBjYXNlIF9sb2FkZXIuTG9hZGVyRXJyb3JzLkhUVFBfU1RBVFVTX0NPREVfSU5WQUxJRDpcbiAgICAgICAgICAgICAgICBjYXNlIF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVYQ0VQVElPTjpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcih0eXBlLCBkYXRhKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uUnVudGltZUV4Y2VwdGlvbignSU9FeGNlcHRpb246ICcgKyBkYXRhLm1zZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3N0YXR1cycsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xvYWRlci5zdGF0dXM7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2V4dHJhRGF0YScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2V4dHJhRGF0YTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZGF0YSkge1xuICAgICAgICAgICAgdGhpcy5fZXh0cmFEYXRhID0gZGF0YTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHByb3RvdHlwZTogZnVuY3Rpb24gb25EYXRhQXJyaXZhbChjaHVua3M6IEFycmF5QnVmZmVyLCBieXRlU3RhcnQ6IG51bWJlcik6IG51bWJlclxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbkRhdGFBcnJpdmFsJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25EYXRhQXJyaXZhbDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uRGF0YUFycml2YWwgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25TZWVrZWQnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vblNlZWtlZDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uU2Vla2VkID0gY2FsbGJhY2s7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBwcm90b3R5cGU6IGZ1bmN0aW9uIG9uRXJyb3IodHlwZTogbnVtYmVyLCBpbmZvOiB7Y29kZTogbnVtYmVyLCBtc2c6IHN0cmluZ30pOiB2b2lkXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uRXJyb3InLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vbkVycm9yO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25FcnJvciA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbkNvbXBsZXRlJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25Db21wbGV0ZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uQ29tcGxldGUgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25SZWRpcmVjdCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uUmVkaXJlY3Q7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vblJlZGlyZWN0ID0gY2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uUmVjb3ZlcmVkRWFybHlFb2YnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vblJlY292ZXJlZEVhcmx5RW9mO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25SZWNvdmVyZWRFYXJseUVvZiA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdjdXJyZW50VVJMJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fZGF0YVNvdXJjZS51cmw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2hhc1JlZGlyZWN0JyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVkaXJlY3RlZFVSTCAhPSBudWxsIHx8IHRoaXMuX2RhdGFTb3VyY2UucmVkaXJlY3RlZFVSTCAhPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2N1cnJlbnRSZWRpcmVjdGVkVVJMJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fcmVkaXJlY3RlZFVSTCB8fCB0aGlzLl9kYXRhU291cmNlLnJlZGlyZWN0ZWRVUkw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpbiBLQi9zXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2N1cnJlbnRTcGVlZCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2xvYWRlckNsYXNzID09PSBfeGhyUmFuZ2VMb2FkZXIyLmRlZmF1bHQpIHtcbiAgICAgICAgICAgICAgICAvLyBTcGVlZFNhbXBsZXIgaXMgaW5hY2N1cmFjeSBpZiBsb2FkZXIgaXMgUmFuZ2VMb2FkZXJcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbG9hZGVyLmN1cnJlbnRTcGVlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zcGVlZFNhbXBsZXIubGFzdFNlY29uZEtCcHM7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2xvYWRlclR5cGUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9sb2FkZXIudHlwZTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBJT0NvbnRyb2xsZXI7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IElPQ29udHJvbGxlcjtcblxufSx7XCIuLi91dGlscy9leGNlcHRpb24uanNcIjo0MCxcIi4uL3V0aWxzL2xvZ2dlci5qc1wiOjQxLFwiLi9mZXRjaC1zdHJlYW0tbG9hZGVyLmpzXCI6MjIsXCIuL2xvYWRlci5qc1wiOjI0LFwiLi9wYXJhbS1zZWVrLWhhbmRsZXIuanNcIjoyNSxcIi4vcmFuZ2Utc2Vlay1oYW5kbGVyLmpzXCI6MjYsXCIuL3NwZWVkLXNhbXBsZXIuanNcIjoyNyxcIi4vd2Vic29ja2V0LWxvYWRlci5qc1wiOjI4LFwiLi94aHItbW96LWNodW5rZWQtbG9hZGVyLmpzXCI6MjksXCIuL3hoci1tc3N0cmVhbS1sb2FkZXIuanNcIjozMCxcIi4veGhyLXJhbmdlLWxvYWRlci5qc1wiOjMxfV0sMjQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLkJhc2VMb2FkZXIgPSBleHBvcnRzLkxvYWRlckVycm9ycyA9IGV4cG9ydHMuTG9hZGVyU3RhdHVzID0gdW5kZWZpbmVkO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9leGNlcHRpb24gPSBfZGVyZXFfKCcuLi91dGlscy9leGNlcHRpb24uanMnKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIExvYWRlclN0YXR1cyA9IGV4cG9ydHMuTG9hZGVyU3RhdHVzID0ge1xuICAgIGtJZGxlOiAwLFxuICAgIGtDb25uZWN0aW5nOiAxLFxuICAgIGtCdWZmZXJpbmc6IDIsXG4gICAga0Vycm9yOiAzLFxuICAgIGtDb21wbGV0ZTogNFxufTtcblxudmFyIExvYWRlckVycm9ycyA9IGV4cG9ydHMuTG9hZGVyRXJyb3JzID0ge1xuICAgIE9LOiAnT0snLFxuICAgIEVYQ0VQVElPTjogJ0V4Y2VwdGlvbicsXG4gICAgSFRUUF9TVEFUVVNfQ09ERV9JTlZBTElEOiAnSHR0cFN0YXR1c0NvZGVJbnZhbGlkJyxcbiAgICBDT05ORUNUSU5HX1RJTUVPVVQ6ICdDb25uZWN0aW5nVGltZW91dCcsXG4gICAgRUFSTFlfRU9GOiAnRWFybHlFb2YnLFxuICAgIFVOUkVDT1ZFUkFCTEVfRUFSTFlfRU9GOiAnVW5yZWNvdmVyYWJsZUVhcmx5RW9mJ1xufTtcblxuLyogTG9hZGVyIGhhcyBjYWxsYmFja3Mgd2hpY2ggaGF2ZSBmb2xsb3dpbmcgcHJvdG90eXBlczpcclxuICogICAgIGZ1bmN0aW9uIG9uQ29udGVudExlbmd0aEtub3duKGNvbnRlbnRMZW5ndGg6IG51bWJlcik6IHZvaWRcclxuICogICAgIGZ1bmN0aW9uIG9uVVJMUmVkaXJlY3QodXJsOiBzdHJpbmcpOiB2b2lkXHJcbiAqICAgICBmdW5jdGlvbiBvbkRhdGFBcnJpdmFsKGNodW5rOiBBcnJheUJ1ZmZlciwgYnl0ZVN0YXJ0OiBudW1iZXIsIHJlY2VpdmVkTGVuZ3RoOiBudW1iZXIpOiB2b2lkXHJcbiAqICAgICBmdW5jdGlvbiBvbkVycm9yKGVycm9yVHlwZTogbnVtYmVyLCBlcnJvckluZm86IHtjb2RlOiBudW1iZXIsIG1zZzogc3RyaW5nfSk6IHZvaWRcclxuICogICAgIGZ1bmN0aW9uIG9uQ29tcGxldGUocmFuZ2VGcm9tOiBudW1iZXIsIHJhbmdlVG86IG51bWJlcik6IHZvaWRcclxuICovXG5cbnZhciBCYXNlTG9hZGVyID0gZXhwb3J0cy5CYXNlTG9hZGVyID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEJhc2VMb2FkZXIodHlwZU5hbWUpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJhc2VMb2FkZXIpO1xuXG4gICAgICAgIHRoaXMuX3R5cGUgPSB0eXBlTmFtZSB8fCAndW5kZWZpbmVkJztcbiAgICAgICAgdGhpcy5fc3RhdHVzID0gTG9hZGVyU3RhdHVzLmtJZGxlO1xuICAgICAgICB0aGlzLl9uZWVkU3Rhc2ggPSBmYWxzZTtcbiAgICAgICAgLy8gY2FsbGJhY2tzXG4gICAgICAgIHRoaXMuX29uQ29udGVudExlbmd0aEtub3duID0gbnVsbDtcbiAgICAgICAgdGhpcy5fb25VUkxSZWRpcmVjdCA9IG51bGw7XG4gICAgICAgIHRoaXMuX29uRGF0YUFycml2YWwgPSBudWxsO1xuICAgICAgICB0aGlzLl9vbkVycm9yID0gbnVsbDtcbiAgICAgICAgdGhpcy5fb25Db21wbGV0ZSA9IG51bGw7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKEJhc2VMb2FkZXIsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IExvYWRlclN0YXR1cy5rSWRsZTtcbiAgICAgICAgICAgIHRoaXMuX29uQ29udGVudExlbmd0aEtub3duID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uVVJMUmVkaXJlY3QgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25EYXRhQXJyaXZhbCA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9vbkVycm9yID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uQ29tcGxldGUgPSBudWxsO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdpc1dvcmtpbmcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaXNXb3JraW5nKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXR1cyA9PT0gTG9hZGVyU3RhdHVzLmtDb25uZWN0aW5nIHx8IHRoaXMuX3N0YXR1cyA9PT0gTG9hZGVyU3RhdHVzLmtCdWZmZXJpbmc7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29wZW4nLFxuXG5cbiAgICAgICAgLy8gcHVyZSB2aXJ0dWFsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuKGRhdGFTb3VyY2UsIHJhbmdlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5Ob3RJbXBsZW1lbnRlZEV4Y2VwdGlvbignVW5pbXBsZW1lbnRlZCBhYnN0cmFjdCBmdW5jdGlvbiEnKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYWJvcnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWJvcnQoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5Ob3RJbXBsZW1lbnRlZEV4Y2VwdGlvbignVW5pbXBsZW1lbnRlZCBhYnN0cmFjdCBmdW5jdGlvbiEnKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndHlwZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3R5cGU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3N0YXR1cycsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3N0YXR1cztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbmVlZFN0YXNoQnVmZmVyJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbmVlZFN0YXNoO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbkNvbnRlbnRMZW5ndGhLbm93bicsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uQ29udGVudExlbmd0aEtub3duO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25Db250ZW50TGVuZ3RoS25vd24gPSBjYWxsYmFjaztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25VUkxSZWRpcmVjdCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uVVJMUmVkaXJlY3Q7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vblVSTFJlZGlyZWN0ID0gY2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29uRGF0YUFycml2YWwnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vbkRhdGFBcnJpdmFsO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChjYWxsYmFjaykge1xuICAgICAgICAgICAgdGhpcy5fb25EYXRhQXJyaXZhbCA9IGNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbkVycm9yJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25FcnJvcjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uRXJyb3IgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25Db21wbGV0ZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX29uQ29tcGxldGU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGNhbGxiYWNrKSB7XG4gICAgICAgICAgICB0aGlzLl9vbkNvbXBsZXRlID0gY2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gQmFzZUxvYWRlcjtcbn0oKTtcblxufSx7XCIuLi91dGlscy9leGNlcHRpb24uanNcIjo0MH1dLDI1OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG52YXIgUGFyYW1TZWVrSGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBQYXJhbVNlZWtIYW5kbGVyKHBhcmFtU3RhcnQsIHBhcmFtRW5kKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQYXJhbVNlZWtIYW5kbGVyKTtcblxuICAgICAgICB0aGlzLl9zdGFydE5hbWUgPSBwYXJhbVN0YXJ0O1xuICAgICAgICB0aGlzLl9lbmROYW1lID0gcGFyYW1FbmQ7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFBhcmFtU2Vla0hhbmRsZXIsIFt7XG4gICAgICAgIGtleTogJ2dldENvbmZpZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDb25maWcoYmFzZVVybCwgcmFuZ2UpIHtcbiAgICAgICAgICAgIHZhciB1cmwgPSBiYXNlVXJsO1xuXG4gICAgICAgICAgICBpZiAocmFuZ2UuZnJvbSAhPT0gMCB8fCByYW5nZS50byAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICB2YXIgbmVlZEFuZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKHVybC5pbmRleE9mKCc/JykgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHVybCArPSAnPyc7XG4gICAgICAgICAgICAgICAgICAgIG5lZWRBbmQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAobmVlZEFuZCkge1xuICAgICAgICAgICAgICAgICAgICB1cmwgKz0gJyYnO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHVybCArPSB0aGlzLl9zdGFydE5hbWUgKyAnPScgKyByYW5nZS5mcm9tLnRvU3RyaW5nKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAocmFuZ2UudG8gIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHVybCArPSAnJicgKyB0aGlzLl9lbmROYW1lICsgJz0nICsgcmFuZ2UudG8udG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge31cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlbW92ZVVSTFBhcmFtZXRlcnMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlVVJMUGFyYW1ldGVycyhzZWVrZWRVUkwpIHtcbiAgICAgICAgICAgIHZhciBiYXNlVVJMID0gc2Vla2VkVVJMLnNwbGl0KCc/JylbMF07XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICB2YXIgcXVlcnlJbmRleCA9IHNlZWtlZFVSTC5pbmRleE9mKCc/Jyk7XG4gICAgICAgICAgICBpZiAocXVlcnlJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICBwYXJhbXMgPSBzZWVrZWRVUkwuc3Vic3RyaW5nKHF1ZXJ5SW5kZXggKyAxKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHJlc3VsdFBhcmFtcyA9ICcnO1xuXG4gICAgICAgICAgICBpZiAocGFyYW1zICE9IHVuZGVmaW5lZCAmJiBwYXJhbXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBwYWlycyA9IHBhcmFtcy5zcGxpdCgnJicpO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYWlycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGFpciA9IHBhaXJzW2ldLnNwbGl0KCc9Jyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZXF1aXJlQW5kID0gaSA+IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhaXJbMF0gIT09IHRoaXMuX3N0YXJ0TmFtZSAmJiBwYWlyWzBdICE9PSB0aGlzLl9lbmROYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVxdWlyZUFuZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFBhcmFtcyArPSAnJic7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRQYXJhbXMgKz0gcGFpcnNbaV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiByZXN1bHRQYXJhbXMubGVuZ3RoID09PSAwID8gYmFzZVVSTCA6IGJhc2VVUkwgKyAnPycgKyByZXN1bHRQYXJhbXM7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gUGFyYW1TZWVrSGFuZGxlcjtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gUGFyYW1TZWVrSGFuZGxlcjtcblxufSx7fV0sMjY6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbnZhciBSYW5nZVNlZWtIYW5kbGVyID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFJhbmdlU2Vla0hhbmRsZXIoemVyb1N0YXJ0KSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBSYW5nZVNlZWtIYW5kbGVyKTtcblxuICAgICAgICB0aGlzLl96ZXJvU3RhcnQgPSB6ZXJvU3RhcnQgfHwgZmFsc2U7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKFJhbmdlU2Vla0hhbmRsZXIsIFt7XG4gICAgICAgIGtleTogJ2dldENvbmZpZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDb25maWcodXJsLCByYW5nZSkge1xuICAgICAgICAgICAgdmFyIGhlYWRlcnMgPSB7fTtcblxuICAgICAgICAgICAgaWYgKHJhbmdlLmZyb20gIT09IDAgfHwgcmFuZ2UudG8gIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdmFyIHBhcmFtID0gdm9pZCAwO1xuICAgICAgICAgICAgICAgIGlmIChyYW5nZS50byAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyYW0gPSAnYnl0ZXM9JyArIHJhbmdlLmZyb20udG9TdHJpbmcoKSArICctJyArIHJhbmdlLnRvLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcGFyYW0gPSAnYnl0ZXM9JyArIHJhbmdlLmZyb20udG9TdHJpbmcoKSArICctJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaGVhZGVyc1snUmFuZ2UnXSA9IHBhcmFtO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLl96ZXJvU3RhcnQpIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzWydSYW5nZSddID0gJ2J5dGVzPTAtJztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB1cmw6IHVybCxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZW1vdmVVUkxQYXJhbWV0ZXJzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZVVSTFBhcmFtZXRlcnMoc2Vla2VkVVJMKSB7XG4gICAgICAgICAgICByZXR1cm4gc2Vla2VkVVJMO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFJhbmdlU2Vla0hhbmRsZXI7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFJhbmdlU2Vla0hhbmRsZXI7XG5cbn0se31dLDI3OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbi8vIFV0aWxpdHkgY2xhc3MgdG8gY2FsY3VsYXRlIHJlYWx0aW1lIG5ldHdvcmsgSS9PIHNwZWVkXG52YXIgU3BlZWRTYW1wbGVyID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNwZWVkU2FtcGxlcigpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFNwZWVkU2FtcGxlcik7XG5cbiAgICAgICAgLy8gbWlsbGlzZWNvbmRzXG4gICAgICAgIHRoaXMuX2ZpcnN0Q2hlY2twb2ludCA9IDA7XG4gICAgICAgIHRoaXMuX2xhc3RDaGVja3BvaW50ID0gMDtcbiAgICAgICAgdGhpcy5faW50ZXJ2YWxCeXRlcyA9IDA7XG4gICAgICAgIHRoaXMuX3RvdGFsQnl0ZXMgPSAwO1xuICAgICAgICB0aGlzLl9sYXN0U2Vjb25kQnl0ZXMgPSAwO1xuXG4gICAgICAgIC8vIGNvbXBhdGliaWxpdHkgZGV0ZWN0aW9uXG4gICAgICAgIGlmIChzZWxmLnBlcmZvcm1hbmNlICYmIHNlbGYucGVyZm9ybWFuY2Uubm93KSB7XG4gICAgICAgICAgICB0aGlzLl9ub3cgPSBzZWxmLnBlcmZvcm1hbmNlLm5vdy5iaW5kKHNlbGYucGVyZm9ybWFuY2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fbm93ID0gRGF0ZS5ub3c7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoU3BlZWRTYW1wbGVyLCBbe1xuICAgICAgICBrZXk6IFwicmVzZXRcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2V0KCkge1xuICAgICAgICAgICAgdGhpcy5fZmlyc3RDaGVja3BvaW50ID0gdGhpcy5fbGFzdENoZWNrcG9pbnQgPSAwO1xuICAgICAgICAgICAgdGhpcy5fdG90YWxCeXRlcyA9IHRoaXMuX2ludGVydmFsQnl0ZXMgPSAwO1xuICAgICAgICAgICAgdGhpcy5fbGFzdFNlY29uZEJ5dGVzID0gMDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImFkZEJ5dGVzXCIsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRCeXRlcyhieXRlcykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2ZpcnN0Q2hlY2twb2ludCA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2ZpcnN0Q2hlY2twb2ludCA9IHRoaXMuX25vdygpO1xuICAgICAgICAgICAgICAgIHRoaXMuX2xhc3RDaGVja3BvaW50ID0gdGhpcy5fZmlyc3RDaGVja3BvaW50O1xuICAgICAgICAgICAgICAgIHRoaXMuX2ludGVydmFsQnl0ZXMgKz0gYnl0ZXM7XG4gICAgICAgICAgICAgICAgdGhpcy5fdG90YWxCeXRlcyArPSBieXRlcztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5fbm93KCkgLSB0aGlzLl9sYXN0Q2hlY2twb2ludCA8IDEwMDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnRlcnZhbEJ5dGVzICs9IGJ5dGVzO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RvdGFsQnl0ZXMgKz0gYnl0ZXM7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGR1cmF0aW9uID49IDEwMDBcbiAgICAgICAgICAgICAgICB0aGlzLl9sYXN0U2Vjb25kQnl0ZXMgPSB0aGlzLl9pbnRlcnZhbEJ5dGVzO1xuICAgICAgICAgICAgICAgIHRoaXMuX2ludGVydmFsQnl0ZXMgPSBieXRlcztcbiAgICAgICAgICAgICAgICB0aGlzLl90b3RhbEJ5dGVzICs9IGJ5dGVzO1xuICAgICAgICAgICAgICAgIHRoaXMuX2xhc3RDaGVja3BvaW50ID0gdGhpcy5fbm93KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJjdXJyZW50S0Jwc1wiLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkQnl0ZXMoMCk7XG5cbiAgICAgICAgICAgIHZhciBkdXJhdGlvblNlY29uZHMgPSAodGhpcy5fbm93KCkgLSB0aGlzLl9sYXN0Q2hlY2twb2ludCkgLyAxMDAwO1xuICAgICAgICAgICAgaWYgKGR1cmF0aW9uU2Vjb25kcyA9PSAwKSBkdXJhdGlvblNlY29uZHMgPSAxO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2ludGVydmFsQnl0ZXMgLyBkdXJhdGlvblNlY29uZHMgLyAxMDI0O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6IFwibGFzdFNlY29uZEtCcHNcIixcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICB0aGlzLmFkZEJ5dGVzKDApO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fbGFzdFNlY29uZEJ5dGVzICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2xhc3RTZWNvbmRCeXRlcyAvIDEwMjQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGxhc3RTZWNvbmRCeXRlcyA9PT0gMFxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9ub3coKSAtIHRoaXMuX2xhc3RDaGVja3BvaW50ID49IDUwMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aW1lIGludGVydmFsIHNpbmNlIGxhc3QgY2hlY2twb2ludCBoYXMgZXhjZWVkZWQgNTAwbXNcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHNwZWVkIGlzIG5lYXJseSBhY2N1cmF0ZVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50S0JwcztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBXZSBkb24ndCBrbm93XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImF2ZXJhZ2VLQnBzXCIsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgdmFyIGR1cmF0aW9uU2Vjb25kcyA9ICh0aGlzLl9ub3coKSAtIHRoaXMuX2ZpcnN0Q2hlY2twb2ludCkgLyAxMDAwO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3RvdGFsQnl0ZXMgLyBkdXJhdGlvblNlY29uZHMgLyAxMDI0O1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFNwZWVkU2FtcGxlcjtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gU3BlZWRTYW1wbGVyO1xuXG59LHt9XSwyODpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9O1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2xvZ2dlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZ2dlci5qcycpO1xuXG52YXIgX2xvZ2dlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnZXIpO1xuXG52YXIgX2xvYWRlciA9IF9kZXJlcV8oJy4vbG9hZGVyLmpzJyk7XG5cbnZhciBfZXhjZXB0aW9uID0gX2RlcmVxXygnLi4vdXRpbHMvZXhjZXB0aW9uLmpzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0gLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuLy8gRm9yIEZMViBvdmVyIFdlYlNvY2tldCBsaXZlIHN0cmVhbVxudmFyIFdlYlNvY2tldExvYWRlciA9IGZ1bmN0aW9uIChfQmFzZUxvYWRlcikge1xuICAgIF9pbmhlcml0cyhXZWJTb2NrZXRMb2FkZXIsIF9CYXNlTG9hZGVyKTtcblxuICAgIF9jcmVhdGVDbGFzcyhXZWJTb2NrZXRMb2FkZXIsIG51bGwsIFt7XG4gICAgICAgIGtleTogJ2lzU3VwcG9ydGVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGlzU3VwcG9ydGVkKCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHlwZW9mIHNlbGYuV2ViU29ja2V0ICE9PSAndW5kZWZpbmVkJztcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICBmdW5jdGlvbiBXZWJTb2NrZXRMb2FkZXIoKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBXZWJTb2NrZXRMb2FkZXIpO1xuXG4gICAgICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChXZWJTb2NrZXRMb2FkZXIuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihXZWJTb2NrZXRMb2FkZXIpKS5jYWxsKHRoaXMsICd3ZWJzb2NrZXQtbG9hZGVyJykpO1xuXG4gICAgICAgIF90aGlzLlRBRyA9ICdXZWJTb2NrZXRMb2FkZXInO1xuXG4gICAgICAgIF90aGlzLl9uZWVkU3Rhc2ggPSB0cnVlO1xuXG4gICAgICAgIF90aGlzLl93cyA9IG51bGw7XG4gICAgICAgIF90aGlzLl9yZXF1ZXN0QWJvcnQgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMuX3JlY2VpdmVkTGVuZ3RoID0gMDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhXZWJTb2NrZXRMb2FkZXIsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl93cykge1xuICAgICAgICAgICAgICAgIHRoaXMuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIF9nZXQoV2ViU29ja2V0TG9hZGVyLnByb3RvdHlwZS5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKFdlYlNvY2tldExvYWRlci5wcm90b3R5cGUpLCAnZGVzdHJveScsIHRoaXMpLmNhbGwodGhpcyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29wZW4nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb3BlbihkYXRhU291cmNlKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciB3cyA9IHRoaXMuX3dzID0gbmV3IHNlbGYuV2ViU29ja2V0KGRhdGFTb3VyY2UudXJsKTtcbiAgICAgICAgICAgICAgICB3cy5iaW5hcnlUeXBlID0gJ2FycmF5YnVmZmVyJztcbiAgICAgICAgICAgICAgICB3cy5vbm9wZW4gPSB0aGlzLl9vbldlYlNvY2tldE9wZW4uYmluZCh0aGlzKTtcbiAgICAgICAgICAgICAgICB3cy5vbmNsb3NlID0gdGhpcy5fb25XZWJTb2NrZXRDbG9zZS5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgICAgIHdzLm9ubWVzc2FnZSA9IHRoaXMuX29uV2ViU29ja2V0TWVzc2FnZS5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgICAgIHdzLm9uZXJyb3IgPSB0aGlzLl9vbldlYlNvY2tldEVycm9yLmJpbmQodGhpcyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29ubmVjdGluZztcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3I7XG5cbiAgICAgICAgICAgICAgICB2YXIgaW5mbyA9IHsgY29kZTogZS5jb2RlLCBtc2c6IGUubWVzc2FnZSB9O1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcihfbG9hZGVyLkxvYWRlckVycm9ycy5FWENFUFRJT04sIGluZm8pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLlJ1bnRpbWVFeGNlcHRpb24oaW5mby5tc2cpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYWJvcnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWJvcnQoKSB7XG4gICAgICAgICAgICB2YXIgd3MgPSB0aGlzLl93cztcbiAgICAgICAgICAgIGlmICh3cyAmJiAod3MucmVhZHlTdGF0ZSA9PT0gMCB8fCB3cy5yZWFkeVN0YXRlID09PSAxKSkge1xuICAgICAgICAgICAgICAgIC8vIENPTk5FQ1RJTkcgfHwgT1BFTlxuICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RBYm9ydCA9IHRydWU7XG4gICAgICAgICAgICAgICAgd3MuY2xvc2UoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fd3MgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0NvbXBsZXRlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25XZWJTb2NrZXRPcGVuJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbldlYlNvY2tldE9wZW4oZSkge1xuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0J1ZmZlcmluZztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uV2ViU29ja2V0Q2xvc2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uV2ViU29ja2V0Q2xvc2UoZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3JlcXVlc3RBYm9ydCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RBYm9ydCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0NvbXBsZXRlO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fb25Db21wbGV0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uQ29tcGxldGUoMCwgdGhpcy5fcmVjZWl2ZWRMZW5ndGggLSAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uV2ViU29ja2V0TWVzc2FnZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25XZWJTb2NrZXRNZXNzYWdlKGUpIHtcbiAgICAgICAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICAgICAgICBpZiAoZS5kYXRhIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9kaXNwYXRjaEFycmF5QnVmZmVyKGUuZGF0YSk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGUuZGF0YSBpbnN0YW5jZW9mIEJsb2IpIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczIuX2Rpc3BhdGNoQXJyYXlCdWZmZXIocmVhZGVyLnJlc3VsdCk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZS5kYXRhKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yO1xuICAgICAgICAgICAgICAgIHZhciBpbmZvID0geyBjb2RlOiAtMSwgbXNnOiAnVW5zdXBwb3J0ZWQgV2ViU29ja2V0IG1lc3NhZ2UgdHlwZTogJyArIGUuZGF0YS5jb25zdHJ1Y3Rvci5uYW1lIH07XG5cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVYQ0VQVElPTiwgaW5mbyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uUnVudGltZUV4Y2VwdGlvbihpbmZvLm1zZyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfZGlzcGF0Y2hBcnJheUJ1ZmZlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfZGlzcGF0Y2hBcnJheUJ1ZmZlcihhcnJheWJ1ZmZlcikge1xuICAgICAgICAgICAgdmFyIGNodW5rID0gYXJyYXlidWZmZXI7XG4gICAgICAgICAgICB2YXIgYnl0ZVN0YXJ0ID0gdGhpcy5fcmVjZWl2ZWRMZW5ndGg7XG4gICAgICAgICAgICB0aGlzLl9yZWNlaXZlZExlbmd0aCArPSBjaHVuay5ieXRlTGVuZ3RoO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fb25EYXRhQXJyaXZhbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRGF0YUFycml2YWwoY2h1bmssIGJ5dGVTdGFydCwgdGhpcy5fcmVjZWl2ZWRMZW5ndGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25XZWJTb2NrZXRFcnJvcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25XZWJTb2NrZXRFcnJvcihlKSB7XG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3I7XG5cbiAgICAgICAgICAgIHZhciBpbmZvID0ge1xuICAgICAgICAgICAgICAgIGNvZGU6IGUuY29kZSxcbiAgICAgICAgICAgICAgICBtc2c6IGUubWVzc2FnZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX29uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVYQ0VQVElPTiwgaW5mbyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLlJ1bnRpbWVFeGNlcHRpb24oaW5mby5tc2cpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFdlYlNvY2tldExvYWRlcjtcbn0oX2xvYWRlci5CYXNlTG9hZGVyKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gV2ViU29ja2V0TG9hZGVyO1xuXG59LHtcIi4uL3V0aWxzL2V4Y2VwdGlvbi5qc1wiOjQwLFwiLi4vdXRpbHMvbG9nZ2VyLmpzXCI6NDEsXCIuL2xvYWRlci5qc1wiOjI0fV0sMjk6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQob2JqZWN0LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpIHsgaWYgKG9iamVjdCA9PT0gbnVsbCkgb2JqZWN0ID0gRnVuY3Rpb24ucHJvdG90eXBlOyB2YXIgZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBwcm9wZXJ0eSk7IGlmIChkZXNjID09PSB1bmRlZmluZWQpIHsgdmFyIHBhcmVudCA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihvYmplY3QpOyBpZiAocGFyZW50ID09PSBudWxsKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gZWxzZSB7IHJldHVybiBnZXQocGFyZW50LCBwcm9wZXJ0eSwgcmVjZWl2ZXIpOyB9IH0gZWxzZSBpZiAoXCJ2YWx1ZVwiIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9O1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2xvZ2dlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZ2dlci5qcycpO1xuXG52YXIgX2xvZ2dlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnZXIpO1xuXG52YXIgX2xvYWRlciA9IF9kZXJlcV8oJy4vbG9hZGVyLmpzJyk7XG5cbnZhciBfZXhjZXB0aW9uID0gX2RlcmVxXygnLi4vdXRpbHMvZXhjZXB0aW9uLmpzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0gLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuLy8gRm9yIEZpcmVGb3ggYnJvd3NlciB3aGljaCBzdXBwb3J0cyBgeGhyLnJlc3BvbnNlVHlwZSA9ICdtb3otY2h1bmtlZC1hcnJheWJ1ZmZlcidgXG52YXIgTW96Q2h1bmtlZExvYWRlciA9IGZ1bmN0aW9uIChfQmFzZUxvYWRlcikge1xuICAgIF9pbmhlcml0cyhNb3pDaHVua2VkTG9hZGVyLCBfQmFzZUxvYWRlcik7XG5cbiAgICBfY3JlYXRlQ2xhc3MoTW96Q2h1bmtlZExvYWRlciwgbnVsbCwgW3tcbiAgICAgICAga2V5OiAnaXNTdXBwb3J0ZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaXNTdXBwb3J0ZWQoKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgICAvLyBGaXJlZm94IDM3LSByZXF1aXJlcyAub3BlbigpIHRvIGJlIGNhbGxlZCBiZWZvcmUgc2V0dGluZyByZXNwb25zZVR5cGVcbiAgICAgICAgICAgICAgICB4aHIub3BlbignR0VUJywgJ2h0dHBzOi8vZXhhbXBsZS5jb20nLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ21vei1jaHVua2VkLWFycmF5YnVmZmVyJztcbiAgICAgICAgICAgICAgICByZXR1cm4geGhyLnJlc3BvbnNlVHlwZSA9PT0gJ21vei1jaHVua2VkLWFycmF5YnVmZmVyJztcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LncoJ01vekNodW5rZWRMb2FkZXInLCBlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIGZ1bmN0aW9uIE1vekNodW5rZWRMb2FkZXIoc2Vla0hhbmRsZXIsIGNvbmZpZykge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTW96Q2h1bmtlZExvYWRlcik7XG5cbiAgICAgICAgdmFyIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKE1vekNodW5rZWRMb2FkZXIuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihNb3pDaHVua2VkTG9hZGVyKSkuY2FsbCh0aGlzLCAneGhyLW1vei1jaHVua2VkLWxvYWRlcicpKTtcblxuICAgICAgICBfdGhpcy5UQUcgPSAnTW96Q2h1bmtlZExvYWRlcic7XG5cbiAgICAgICAgX3RoaXMuX3NlZWtIYW5kbGVyID0gc2Vla0hhbmRsZXI7XG4gICAgICAgIF90aGlzLl9jb25maWcgPSBjb25maWc7XG4gICAgICAgIF90aGlzLl9uZWVkU3Rhc2ggPSB0cnVlO1xuXG4gICAgICAgIF90aGlzLl94aHIgPSBudWxsO1xuICAgICAgICBfdGhpcy5fcmVxdWVzdEFib3J0ID0gZmFsc2U7XG4gICAgICAgIF90aGlzLl9jb250ZW50TGVuZ3RoID0gbnVsbDtcbiAgICAgICAgX3RoaXMuX3JlY2VpdmVkTGVuZ3RoID0gMDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhNb3pDaHVua2VkTG9hZGVyLCBbe1xuICAgICAgICBrZXk6ICdkZXN0cm95JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1dvcmtpbmcoKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWJvcnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl94aHIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIub25wcm9ncmVzcyA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLm9ubG9hZGVuZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLm9uZXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3hociA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfZ2V0KE1vekNodW5rZWRMb2FkZXIucHJvdG90eXBlLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTW96Q2h1bmtlZExvYWRlci5wcm90b3R5cGUpLCAnZGVzdHJveScsIHRoaXMpLmNhbGwodGhpcyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29wZW4nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb3BlbihkYXRhU291cmNlLCByYW5nZSkge1xuICAgICAgICAgICAgdGhpcy5fZGF0YVNvdXJjZSA9IGRhdGFTb3VyY2U7XG4gICAgICAgICAgICB0aGlzLl9yYW5nZSA9IHJhbmdlO1xuXG4gICAgICAgICAgICB2YXIgc291cmNlVVJMID0gZGF0YVNvdXJjZS51cmw7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29uZmlnLnJldXNlUmVkaXJlY3RlZFVSTCAmJiBkYXRhU291cmNlLnJlZGlyZWN0ZWRVUkwgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgc291cmNlVVJMID0gZGF0YVNvdXJjZS5yZWRpcmVjdGVkVVJMO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc2Vla0NvbmZpZyA9IHRoaXMuX3NlZWtIYW5kbGVyLmdldENvbmZpZyhzb3VyY2VVUkwsIHJhbmdlKTtcbiAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RVUkwgPSBzZWVrQ29uZmlnLnVybDtcblxuICAgICAgICAgICAgdmFyIHhociA9IHRoaXMuX3hociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICAgICAgeGhyLm9wZW4oJ0dFVCcsIHNlZWtDb25maWcudXJsLCB0cnVlKTtcbiAgICAgICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnbW96LWNodW5rZWQtYXJyYXlidWZmZXInO1xuICAgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IHRoaXMuX29uUmVhZHlTdGF0ZUNoYW5nZS5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgeGhyLm9ucHJvZ3Jlc3MgPSB0aGlzLl9vblByb2dyZXNzLmJpbmQodGhpcyk7XG4gICAgICAgICAgICB4aHIub25sb2FkZW5kID0gdGhpcy5fb25Mb2FkRW5kLmJpbmQodGhpcyk7XG4gICAgICAgICAgICB4aHIub25lcnJvciA9IHRoaXMuX29uWGhyRXJyb3IuYmluZCh0aGlzKTtcblxuICAgICAgICAgICAgLy8gY29ycyBpcyBhdXRvIGRldGVjdGVkIGFuZCBlbmFibGVkIGJ5IHhoclxuXG4gICAgICAgICAgICAvLyB3aXRoQ3JlZGVudGlhbHMgaXMgZGlzYWJsZWQgYnkgZGVmYXVsdFxuICAgICAgICAgICAgaWYgKGRhdGFTb3VyY2Uud2l0aENyZWRlbnRpYWxzKSB7XG4gICAgICAgICAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChfdHlwZW9mKHNlZWtDb25maWcuaGVhZGVycykgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGhlYWRlcnMgPSBzZWVrQ29uZmlnLmhlYWRlcnM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gaGVhZGVycykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaGVhZGVycy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihrZXksIGhlYWRlcnNba2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFkZCBhZGRpdGlvbmFsIGhlYWRlcnNcbiAgICAgICAgICAgIGlmIChfdHlwZW9mKHRoaXMuX2NvbmZpZy5oZWFkZXJzKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2hlYWRlcnMgPSB0aGlzLl9jb25maWcuaGVhZGVycztcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9rZXkgaW4gX2hlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9oZWFkZXJzLmhhc093blByb3BlcnR5KF9rZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihfa2V5LCBfaGVhZGVyc1tfa2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb25uZWN0aW5nO1xuICAgICAgICAgICAgeGhyLnNlbmQoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYWJvcnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWJvcnQoKSB7XG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0QWJvcnQgPSB0cnVlO1xuICAgICAgICAgICAgaWYgKHRoaXMuX3hocikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0NvbXBsZXRlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25SZWFkeVN0YXRlQ2hhbmdlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblJlYWR5U3RhdGVDaGFuZ2UoZSkge1xuICAgICAgICAgICAgdmFyIHhociA9IGUudGFyZ2V0O1xuXG4gICAgICAgICAgICBpZiAoeGhyLnJlYWR5U3RhdGUgPT09IDIpIHtcbiAgICAgICAgICAgICAgICAvLyBIRUFERVJTX1JFQ0VJVkVEXG4gICAgICAgICAgICAgICAgaWYgKHhoci5yZXNwb25zZVVSTCAhPSB1bmRlZmluZWQgJiYgeGhyLnJlc3BvbnNlVVJMICE9PSB0aGlzLl9yZXF1ZXN0VVJMKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vblVSTFJlZGlyZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVkaXJlY3RlZFVSTCA9IHRoaXMuX3NlZWtIYW5kbGVyLnJlbW92ZVVSTFBhcmFtZXRlcnMoeGhyLnJlc3BvbnNlVVJMKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uVVJMUmVkaXJlY3QocmVkaXJlY3RlZFVSTCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyAhPT0gMCAmJiAoeGhyLnN0YXR1cyA8IDIwMCB8fCB4aHIuc3RhdHVzID4gMjk5KSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKF9sb2FkZXIuTG9hZGVyRXJyb3JzLkhUVFBfU1RBVFVTX0NPREVfSU5WQUxJRCwgeyBjb2RlOiB4aHIuc3RhdHVzLCBtc2c6IHhoci5zdGF0dXNUZXh0IH0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uUnVudGltZUV4Y2VwdGlvbignTW96Q2h1bmtlZExvYWRlcjogSHR0cCBjb2RlIGludmFsaWQsICcgKyB4aHIuc3RhdHVzICsgJyAnICsgeGhyLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0J1ZmZlcmluZztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblByb2dyZXNzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblByb2dyZXNzKGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGF0dXMgPT09IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcikge1xuICAgICAgICAgICAgICAgIC8vIElnbm9yZSBlcnJvciByZXNwb25zZVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbnRlbnRMZW5ndGggPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBpZiAoZS50b3RhbCAhPT0gbnVsbCAmJiBlLnRvdGFsICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRMZW5ndGggPSBlLnRvdGFsO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25Db250ZW50TGVuZ3RoS25vd24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uQ29udGVudExlbmd0aEtub3duKHRoaXMuX2NvbnRlbnRMZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgY2h1bmsgPSBlLnRhcmdldC5yZXNwb25zZTtcbiAgICAgICAgICAgIHZhciBieXRlU3RhcnQgPSB0aGlzLl9yYW5nZS5mcm9tICsgdGhpcy5fcmVjZWl2ZWRMZW5ndGg7XG4gICAgICAgICAgICB0aGlzLl9yZWNlaXZlZExlbmd0aCArPSBjaHVuay5ieXRlTGVuZ3RoO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fb25EYXRhQXJyaXZhbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRGF0YUFycml2YWwoY2h1bmssIGJ5dGVTdGFydCwgdGhpcy5fcmVjZWl2ZWRMZW5ndGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb25Mb2FkRW5kJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbkxvYWRFbmQoZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3JlcXVlc3RBYm9ydCA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlcXVlc3RBYm9ydCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5fc3RhdHVzID09PSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3IpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb21wbGV0ZTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9vbkNvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25Db21wbGV0ZSh0aGlzLl9yYW5nZS5mcm9tLCB0aGlzLl9yYW5nZS5mcm9tICsgdGhpcy5fcmVjZWl2ZWRMZW5ndGggLSAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uWGhyRXJyb3InLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uWGhyRXJyb3IoZSkge1xuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yO1xuICAgICAgICAgICAgdmFyIHR5cGUgPSAwO1xuICAgICAgICAgICAgdmFyIGluZm8gPSBudWxsO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fY29udGVudExlbmd0aCAmJiBlLmxvYWRlZCA8IHRoaXMuX2NvbnRlbnRMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0eXBlID0gX2xvYWRlci5Mb2FkZXJFcnJvcnMuRUFSTFlfRU9GO1xuICAgICAgICAgICAgICAgIGluZm8gPSB7IGNvZGU6IC0xLCBtc2c6ICdNb3otQ2h1bmtlZCBzdHJlYW0gbWVldCBFYXJseS1Fb2YnIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHR5cGUgPSBfbG9hZGVyLkxvYWRlckVycm9ycy5FWENFUFRJT047XG4gICAgICAgICAgICAgICAgaW5mbyA9IHsgY29kZTogLTEsIG1zZzogZS5jb25zdHJ1Y3Rvci5uYW1lICsgJyAnICsgZS50eXBlIH07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9vbkVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcih0eXBlLCBpbmZvKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uUnVudGltZUV4Y2VwdGlvbihpbmZvLm1zZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gTW96Q2h1bmtlZExvYWRlcjtcbn0oX2xvYWRlci5CYXNlTG9hZGVyKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gTW96Q2h1bmtlZExvYWRlcjtcblxufSx7XCIuLi91dGlscy9leGNlcHRpb24uanNcIjo0MCxcIi4uL3V0aWxzL2xvZ2dlci5qc1wiOjQxLFwiLi9sb2FkZXIuanNcIjoyNH1dLDMwOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9sb2dnZXIgPSBfZGVyZXFfKCcuLi91dGlscy9sb2dnZXIuanMnKTtcblxudmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTtcblxudmFyIF9sb2FkZXIgPSBfZGVyZXFfKCcuL2xvYWRlci5qcycpO1xuXG52YXIgX2V4Y2VwdGlvbiA9IF9kZXJlcV8oJy4uL3V0aWxzL2V4Y2VwdGlvbi5qcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbi8qIE5vdGljZTogbXMtc3RyZWFtIG1heSBjYXVzZSBJRS9FZGdlIGJyb3dzZXIgY3Jhc2ggaWYgc2VlayB0b28gZnJlcXVlbnRseSEhIVxyXG4gKiBUaGUgYnJvd3NlciBtYXkgY3Jhc2ggaW4gd2luaW5ldC5kbGwuIERpc2FibGUgZm9yIG5vdy5cclxuICpcclxuICogRm9yIElFMTEvRWRnZSBicm93c2VyIGJ5IG1pY3Jvc29mdCB3aGljaCBzdXBwb3J0cyBgeGhyLnJlc3BvbnNlVHlwZSA9ICdtcy1zdHJlYW0nYFxyXG4gKiBOb3RpY2UgdGhhdCBtcy1zdHJlYW0gQVBJIHN1Y2tzLiBUaGUgYnVmZmVyIGlzIGFsd2F5cyBleHBhbmRpbmcgYWxvbmcgd2l0aCBkb3dubG9hZGluZy5cclxuICpcclxuICogV2UgbmVlZCB0byBhYm9ydCB0aGUgeGhyIGlmIGJ1ZmZlciBzaXplIGV4Y2VlZGVkIGxpbWl0IHNpemUgKGUuZy4gMTYgTWlCKSwgdGhlbiBkbyByZWNvbm5lY3QuXHJcbiAqIGluIG9yZGVyIHRvIHJlbGVhc2UgcHJldmlvdXMgQXJyYXlCdWZmZXIgdG8gYXZvaWQgbWVtb3J5IGxlYWtcclxuICpcclxuICogT3RoZXJ3aXNlLCB0aGUgQXJyYXlCdWZmZXIgd2lsbCBpbmNyZWFzZSB0byBhIHRlcnJpYmxlIHNpemUgdGhhdCBlcXVhbHMgZmluYWwgZmlsZSBzaXplLlxyXG4gKi9cbnZhciBNU1N0cmVhbUxvYWRlciA9IGZ1bmN0aW9uIChfQmFzZUxvYWRlcikge1xuICAgIF9pbmhlcml0cyhNU1N0cmVhbUxvYWRlciwgX0Jhc2VMb2FkZXIpO1xuXG4gICAgX2NyZWF0ZUNsYXNzKE1TU3RyZWFtTG9hZGVyLCBudWxsLCBbe1xuICAgICAgICBrZXk6ICdpc1N1cHBvcnRlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpc1N1cHBvcnRlZCgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBzZWxmLk1TU3RyZWFtID09PSAndW5kZWZpbmVkJyB8fCB0eXBlb2Ygc2VsZi5NU1N0cmVhbVJlYWRlciA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgICAgICB4aHIub3BlbignR0VUJywgJ2h0dHBzOi8vZXhhbXBsZS5jb20nLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ21zLXN0cmVhbSc7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHhoci5yZXNwb25zZVR5cGUgPT09ICdtcy1zdHJlYW0nO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudygnTVNTdHJlYW1Mb2FkZXInLCBlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIGZ1bmN0aW9uIE1TU3RyZWFtTG9hZGVyKHNlZWtIYW5kbGVyLCBjb25maWcpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1TU3RyZWFtTG9hZGVyKTtcblxuICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoTVNTdHJlYW1Mb2FkZXIuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihNU1N0cmVhbUxvYWRlcikpLmNhbGwodGhpcywgJ3hoci1tc3N0cmVhbS1sb2FkZXInKSk7XG5cbiAgICAgICAgX3RoaXMuVEFHID0gJ01TU3RyZWFtTG9hZGVyJztcblxuICAgICAgICBfdGhpcy5fc2Vla0hhbmRsZXIgPSBzZWVrSGFuZGxlcjtcbiAgICAgICAgX3RoaXMuX2NvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgX3RoaXMuX25lZWRTdGFzaCA9IHRydWU7XG5cbiAgICAgICAgX3RoaXMuX3hociA9IG51bGw7XG4gICAgICAgIF90aGlzLl9yZWFkZXIgPSBudWxsOyAvLyBNU1N0cmVhbVJlYWRlclxuXG4gICAgICAgIF90aGlzLl90b3RhbFJhbmdlID0gbnVsbDtcbiAgICAgICAgX3RoaXMuX2N1cnJlbnRSYW5nZSA9IG51bGw7XG5cbiAgICAgICAgX3RoaXMuX2N1cnJlbnRSZXF1ZXN0VVJMID0gbnVsbDtcbiAgICAgICAgX3RoaXMuX2N1cnJlbnRSZWRpcmVjdGVkVVJMID0gbnVsbDtcblxuICAgICAgICBfdGhpcy5fY29udGVudExlbmd0aCA9IG51bGw7XG4gICAgICAgIF90aGlzLl9yZWNlaXZlZExlbmd0aCA9IDA7XG5cbiAgICAgICAgX3RoaXMuX2J1ZmZlckxpbWl0ID0gMTYgKiAxMDI0ICogMTAyNDsgLy8gMTZNQlxuICAgICAgICBfdGhpcy5fbGFzdFRpbWVCdWZmZXJTaXplID0gMDtcbiAgICAgICAgX3RoaXMuX2lzUmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoTVNTdHJlYW1Mb2FkZXIsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzV29ya2luZygpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hYm9ydCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX3JlYWRlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlYWRlci5vbnByb2dyZXNzID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWFkZXIub25sb2FkID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl9yZWFkZXIub25lcnJvciA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVhZGVyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl94aHIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX2dldChNU1N0cmVhbUxvYWRlci5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihNU1N0cmVhbUxvYWRlci5wcm90b3R5cGUpLCAnZGVzdHJveScsIHRoaXMpLmNhbGwodGhpcyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29wZW4nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb3BlbihkYXRhU291cmNlLCByYW5nZSkge1xuICAgICAgICAgICAgdGhpcy5faW50ZXJuYWxPcGVuKGRhdGFTb3VyY2UsIHJhbmdlLCBmYWxzZSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19pbnRlcm5hbE9wZW4nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2ludGVybmFsT3BlbihkYXRhU291cmNlLCByYW5nZSwgaXNTdWJyYW5nZSkge1xuICAgICAgICAgICAgdGhpcy5fZGF0YVNvdXJjZSA9IGRhdGFTb3VyY2U7XG5cbiAgICAgICAgICAgIGlmICghaXNTdWJyYW5nZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RvdGFsUmFuZ2UgPSByYW5nZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudFJhbmdlID0gcmFuZ2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzb3VyY2VVUkwgPSBkYXRhU291cmNlLnVybDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9jb25maWcucmV1c2VSZWRpcmVjdGVkVVJMKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRSZWRpcmVjdGVkVVJMICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VVUkwgPSB0aGlzLl9jdXJyZW50UmVkaXJlY3RlZFVSTDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGFTb3VyY2UucmVkaXJlY3RlZFVSTCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlVVJMID0gZGF0YVNvdXJjZS5yZWRpcmVjdGVkVVJMO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHNlZWtDb25maWcgPSB0aGlzLl9zZWVrSGFuZGxlci5nZXRDb25maWcoc291cmNlVVJMLCByYW5nZSk7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50UmVxdWVzdFVSTCA9IHNlZWtDb25maWcudXJsO1xuXG4gICAgICAgICAgICB2YXIgcmVhZGVyID0gdGhpcy5fcmVhZGVyID0gbmV3IHNlbGYuTVNTdHJlYW1SZWFkZXIoKTtcbiAgICAgICAgICAgIHJlYWRlci5vbnByb2dyZXNzID0gdGhpcy5fbXNyT25Qcm9ncmVzcy5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgcmVhZGVyLm9ubG9hZCA9IHRoaXMuX21zck9uTG9hZC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgcmVhZGVyLm9uZXJyb3IgPSB0aGlzLl9tc3JPbkVycm9yLmJpbmQodGhpcyk7XG5cbiAgICAgICAgICAgIHZhciB4aHIgPSB0aGlzLl94aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgICAgIHhoci5vcGVuKCdHRVQnLCBzZWVrQ29uZmlnLnVybCwgdHJ1ZSk7XG4gICAgICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ21zLXN0cmVhbSc7XG4gICAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gdGhpcy5feGhyT25SZWFkeVN0YXRlQ2hhbmdlLmJpbmQodGhpcyk7XG4gICAgICAgICAgICB4aHIub25lcnJvciA9IHRoaXMuX3hock9uRXJyb3IuYmluZCh0aGlzKTtcblxuICAgICAgICAgICAgaWYgKGRhdGFTb3VyY2Uud2l0aENyZWRlbnRpYWxzKSB7XG4gICAgICAgICAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChfdHlwZW9mKHNlZWtDb25maWcuaGVhZGVycykgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgdmFyIGhlYWRlcnMgPSBzZWVrQ29uZmlnLmhlYWRlcnM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXkgaW4gaGVhZGVycykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoaGVhZGVycy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihrZXksIGhlYWRlcnNba2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFkZCBhZGRpdGlvbmFsIGhlYWRlcnNcbiAgICAgICAgICAgIGlmIChfdHlwZW9mKHRoaXMuX2NvbmZpZy5oZWFkZXJzKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICB2YXIgX2hlYWRlcnMgPSB0aGlzLl9jb25maWcuaGVhZGVycztcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIF9rZXkgaW4gX2hlYWRlcnMpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9oZWFkZXJzLmhhc093blByb3BlcnR5KF9rZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihfa2V5LCBfaGVhZGVyc1tfa2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9pc1JlY29ubmVjdGluZykge1xuICAgICAgICAgICAgICAgIHRoaXMuX2lzUmVjb25uZWN0aW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtDb25uZWN0aW5nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgeGhyLnNlbmQoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYWJvcnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWJvcnQoKSB7XG4gICAgICAgICAgICB0aGlzLl9pbnRlcm5hbEFib3J0KCk7XG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29tcGxldGU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19pbnRlcm5hbEFib3J0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9pbnRlcm5hbEFib3J0KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3JlYWRlcikge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9yZWFkZXIucmVhZHlTdGF0ZSA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBMT0FESU5HXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlYWRlci5hYm9ydCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9yZWFkZXIub25wcm9ncmVzcyA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVhZGVyLm9ubG9hZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVhZGVyLm9uZXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3JlYWRlciA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5feGhyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLmFib3J0KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3hock9uUmVhZHlTdGF0ZUNoYW5nZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfeGhyT25SZWFkeVN0YXRlQ2hhbmdlKGUpIHtcbiAgICAgICAgICAgIHZhciB4aHIgPSBlLnRhcmdldDtcblxuICAgICAgICAgICAgaWYgKHhoci5yZWFkeVN0YXRlID09PSAyKSB7XG4gICAgICAgICAgICAgICAgLy8gSEVBREVSU19SRUNFSVZFRFxuICAgICAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzID49IDIwMCAmJiB4aHIuc3RhdHVzIDw9IDI5OSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQnVmZmVyaW5nO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh4aHIucmVzcG9uc2VVUkwgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVkaXJlY3RlZFVSTCA9IHRoaXMuX3NlZWtIYW5kbGVyLnJlbW92ZVVSTFBhcmFtZXRlcnMoeGhyLnJlc3BvbnNlVVJMKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh4aHIucmVzcG9uc2VVUkwgIT09IHRoaXMuX2N1cnJlbnRSZXF1ZXN0VVJMICYmIHJlZGlyZWN0ZWRVUkwgIT09IHRoaXMuX2N1cnJlbnRSZWRpcmVjdGVkVVJMKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudFJlZGlyZWN0ZWRVUkwgPSByZWRpcmVjdGVkVVJMO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vblVSTFJlZGlyZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uVVJMUmVkaXJlY3QocmVkaXJlY3RlZFVSTCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGxlbmd0aEhlYWRlciA9IHhoci5nZXRSZXNwb25zZUhlYWRlcignQ29udGVudC1MZW5ndGgnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxlbmd0aEhlYWRlciAhPSBudWxsICYmIHRoaXMuX2NvbnRlbnRMZW5ndGggPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxlbmd0aCA9IHBhcnNlSW50KGxlbmd0aEhlYWRlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NvbnRlbnRMZW5ndGggPSBsZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uQ29udGVudExlbmd0aEtub3duKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uQ29udGVudExlbmd0aEtub3duKHRoaXMuX2NvbnRlbnRMZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IoX2xvYWRlci5Mb2FkZXJFcnJvcnMuSFRUUF9TVEFUVVNfQ09ERV9JTlZBTElELCB7IGNvZGU6IHhoci5zdGF0dXMsIG1zZzogeGhyLnN0YXR1c1RleHQgfSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5SdW50aW1lRXhjZXB0aW9uKCdNU1N0cmVhbUxvYWRlcjogSHR0cCBjb2RlIGludmFsaWQsICcgKyB4aHIuc3RhdHVzICsgJyAnICsgeGhyLnN0YXR1c1RleHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gMykge1xuICAgICAgICAgICAgICAgIC8vIExPQURJTkdcbiAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA+PSAyMDAgJiYgeGhyLnN0YXR1cyA8PSAyOTkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0J1ZmZlcmluZztcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbXNzdHJlYW0gPSB4aHIucmVzcG9uc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihtc3N0cmVhbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfeGhyT25FcnJvcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfeGhyT25FcnJvcihlKSB7XG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3I7XG4gICAgICAgICAgICB2YXIgdHlwZSA9IF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVYQ0VQVElPTjtcbiAgICAgICAgICAgIHZhciBpbmZvID0geyBjb2RlOiAtMSwgbXNnOiBlLmNvbnN0cnVjdG9yLm5hbWUgKyAnICcgKyBlLnR5cGUgfTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX29uRXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbkVycm9yKHR5cGUsIGluZm8pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5SdW50aW1lRXhjZXB0aW9uKGluZm8ubXNnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX21zck9uUHJvZ3Jlc3MnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX21zck9uUHJvZ3Jlc3MoZSkge1xuICAgICAgICAgICAgdmFyIHJlYWRlciA9IGUudGFyZ2V0O1xuICAgICAgICAgICAgdmFyIGJpZ2J1ZmZlciA9IHJlYWRlci5yZXN1bHQ7XG4gICAgICAgICAgICBpZiAoYmlnYnVmZmVyID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAvLyByZXN1bHQgbWF5IGJlIG51bGwsIHdvcmthcm91bmQgZm9yIGJ1Z2d5IE0kXG4gICAgICAgICAgICAgICAgdGhpcy5fZG9SZWNvbm5lY3RJZk5lZWRlZCgpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHNsaWNlID0gYmlnYnVmZmVyLnNsaWNlKHRoaXMuX2xhc3RUaW1lQnVmZmVyU2l6ZSk7XG4gICAgICAgICAgICB0aGlzLl9sYXN0VGltZUJ1ZmZlclNpemUgPSBiaWdidWZmZXIuYnl0ZUxlbmd0aDtcbiAgICAgICAgICAgIHZhciBieXRlU3RhcnQgPSB0aGlzLl90b3RhbFJhbmdlLmZyb20gKyB0aGlzLl9yZWNlaXZlZExlbmd0aDtcbiAgICAgICAgICAgIHRoaXMuX3JlY2VpdmVkTGVuZ3RoICs9IHNsaWNlLmJ5dGVMZW5ndGg7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9vbkRhdGFBcnJpdmFsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fb25EYXRhQXJyaXZhbChzbGljZSwgYnl0ZVN0YXJ0LCB0aGlzLl9yZWNlaXZlZExlbmd0aCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChiaWdidWZmZXIuYnl0ZUxlbmd0aCA+PSB0aGlzLl9idWZmZXJMaW1pdCkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudih0aGlzLlRBRywgJ01TU3RyZWFtIGJ1ZmZlciBleGNlZWRlZCBtYXggc2l6ZSBuZWFyICcgKyAoYnl0ZVN0YXJ0ICsgc2xpY2UuYnl0ZUxlbmd0aCkgKyAnLCByZWNvbm5lY3RpbmcuLi4nKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9kb1JlY29ubmVjdElmTmVlZGVkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19kb1JlY29ubmVjdElmTmVlZGVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9kb1JlY29ubmVjdElmTmVlZGVkKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbnRlbnRMZW5ndGggPT0gbnVsbCB8fCB0aGlzLl9yZWNlaXZlZExlbmd0aCA8IHRoaXMuX2NvbnRlbnRMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pc1JlY29ubmVjdGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fbGFzdFRpbWVCdWZmZXJTaXplID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnRlcm5hbEFib3J0KCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb206IHRoaXMuX3RvdGFsUmFuZ2UuZnJvbSArIHRoaXMuX3JlY2VpdmVkTGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICB0bzogLTFcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuX2ludGVybmFsT3Blbih0aGlzLl9kYXRhU291cmNlLCByYW5nZSwgdHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19tc3JPbkxvYWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX21zck9uTG9hZChlKSB7XG4gICAgICAgICAgICAvLyBhY3R1YWxseSBpdCBpcyBvbkNvbXBsZXRlIGV2ZW50XG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29tcGxldGU7XG4gICAgICAgICAgICBpZiAodGhpcy5fb25Db21wbGV0ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uQ29tcGxldGUodGhpcy5fdG90YWxSYW5nZS5mcm9tLCB0aGlzLl90b3RhbFJhbmdlLmZyb20gKyB0aGlzLl9yZWNlaXZlZExlbmd0aCAtIDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfbXNyT25FcnJvcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfbXNyT25FcnJvcihlKSB7XG4gICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rRXJyb3I7XG4gICAgICAgICAgICB2YXIgdHlwZSA9IDA7XG4gICAgICAgICAgICB2YXIgaW5mbyA9IG51bGw7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9jb250ZW50TGVuZ3RoICYmIHRoaXMuX3JlY2VpdmVkTGVuZ3RoIDwgdGhpcy5fY29udGVudExlbmd0aCkge1xuICAgICAgICAgICAgICAgIHR5cGUgPSBfbG9hZGVyLkxvYWRlckVycm9ycy5FQVJMWV9FT0Y7XG4gICAgICAgICAgICAgICAgaW5mbyA9IHsgY29kZTogLTEsIG1zZzogJ01TU3RyZWFtIG1lZXQgRWFybHktRW9mJyB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0eXBlID0gX2xvYWRlci5Mb2FkZXJFcnJvcnMuRUFSTFlfRU9GO1xuICAgICAgICAgICAgICAgIGluZm8gPSB7IGNvZGU6IC0xLCBtc2c6IGUuY29uc3RydWN0b3IubmFtZSArICcgJyArIGUudHlwZSB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5fb25FcnJvcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IodHlwZSwgaW5mbyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLlJ1bnRpbWVFeGNlcHRpb24oaW5mby5tc2cpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIE1TU3RyZWFtTG9hZGVyO1xufShfbG9hZGVyLkJhc2VMb2FkZXIpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBNU1N0cmVhbUxvYWRlcjtcblxufSx7XCIuLi91dGlscy9leGNlcHRpb24uanNcIjo0MCxcIi4uL3V0aWxzL2xvZ2dlci5qc1wiOjQxLFwiLi9sb2FkZXIuanNcIjoyNH1dLDMxOltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxudmFyIF9sb2dnZXIgPSBfZGVyZXFfKCcuLi91dGlscy9sb2dnZXIuanMnKTtcblxudmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTtcblxudmFyIF9zcGVlZFNhbXBsZXIgPSBfZGVyZXFfKCcuL3NwZWVkLXNhbXBsZXIuanMnKTtcblxudmFyIF9zcGVlZFNhbXBsZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfc3BlZWRTYW1wbGVyKTtcblxudmFyIF9sb2FkZXIgPSBfZGVyZXFfKCcuL2xvYWRlci5qcycpO1xuXG52YXIgX2V4Y2VwdGlvbiA9IF9kZXJlcV8oJy4uL3V0aWxzL2V4Y2VwdGlvbi5qcycpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbi8vIFVuaXZlcnNhbCBJTyBMb2FkZXIsIGltcGxlbWVudGVkIGJ5IGFkZGluZyBSYW5nZSBoZWFkZXIgaW4geGhyJ3MgcmVxdWVzdCBoZWFkZXJcbnZhciBSYW5nZUxvYWRlciA9IGZ1bmN0aW9uIChfQmFzZUxvYWRlcikge1xuICAgIF9pbmhlcml0cyhSYW5nZUxvYWRlciwgX0Jhc2VMb2FkZXIpO1xuXG4gICAgX2NyZWF0ZUNsYXNzKFJhbmdlTG9hZGVyLCBudWxsLCBbe1xuICAgICAgICBrZXk6ICdpc1N1cHBvcnRlZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpc1N1cHBvcnRlZCgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICAgICAgICAgIHhoci5vcGVuKCdHRVQnLCAnaHR0cHM6Ly9leGFtcGxlLmNvbScsIHRydWUpO1xuICAgICAgICAgICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnYXJyYXlidWZmZXInO1xuICAgICAgICAgICAgICAgIHJldHVybiB4aHIucmVzcG9uc2VUeXBlID09PSAnYXJyYXlidWZmZXInO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudygnUmFuZ2VMb2FkZXInLCBlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIGZ1bmN0aW9uIFJhbmdlTG9hZGVyKHNlZWtIYW5kbGVyLCBjb25maWcpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFJhbmdlTG9hZGVyKTtcblxuICAgICAgICB2YXIgX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCAoUmFuZ2VMb2FkZXIuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihSYW5nZUxvYWRlcikpLmNhbGwodGhpcywgJ3hoci1yYW5nZS1sb2FkZXInKSk7XG5cbiAgICAgICAgX3RoaXMuVEFHID0gJ1JhbmdlTG9hZGVyJztcblxuICAgICAgICBfdGhpcy5fc2Vla0hhbmRsZXIgPSBzZWVrSGFuZGxlcjtcbiAgICAgICAgX3RoaXMuX2NvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgX3RoaXMuX25lZWRTdGFzaCA9IGZhbHNlO1xuXG4gICAgICAgIF90aGlzLl9jaHVua1NpemVLQkxpc3QgPSBbMTI4LCAyNTYsIDM4NCwgNTEyLCA3NjgsIDEwMjQsIDE1MzYsIDIwNDgsIDMwNzIsIDQwOTYsIDUxMjAsIDYxNDQsIDcxNjgsIDgxOTJdO1xuICAgICAgICBfdGhpcy5fY3VycmVudENodW5rU2l6ZUtCID0gMzg0O1xuICAgICAgICBfdGhpcy5fY3VycmVudFNwZWVkTm9ybWFsaXplZCA9IDA7XG4gICAgICAgIF90aGlzLl96ZXJvU3BlZWRDaHVua0NvdW50ID0gMDtcblxuICAgICAgICBfdGhpcy5feGhyID0gbnVsbDtcbiAgICAgICAgX3RoaXMuX3NwZWVkU2FtcGxlciA9IG5ldyBfc3BlZWRTYW1wbGVyMi5kZWZhdWx0KCk7XG5cbiAgICAgICAgX3RoaXMuX3JlcXVlc3RBYm9ydCA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5fd2FpdEZvclRvdGFsTGVuZ3RoID0gZmFsc2U7XG4gICAgICAgIF90aGlzLl90b3RhbExlbmd0aFJlY2VpdmVkID0gZmFsc2U7XG5cbiAgICAgICAgX3RoaXMuX2N1cnJlbnRSZXF1ZXN0VVJMID0gbnVsbDtcbiAgICAgICAgX3RoaXMuX2N1cnJlbnRSZWRpcmVjdGVkVVJMID0gbnVsbDtcbiAgICAgICAgX3RoaXMuX2N1cnJlbnRSZXF1ZXN0UmFuZ2UgPSBudWxsO1xuICAgICAgICBfdGhpcy5fdG90YWxMZW5ndGggPSBudWxsOyAvLyBzaXplIG9mIHRoZSBlbnRpcmUgZmlsZVxuICAgICAgICBfdGhpcy5fY29udGVudExlbmd0aCA9IG51bGw7IC8vIENvbnRlbnQtTGVuZ3RoIG9mIGVudGlyZSByZXF1ZXN0IHJhbmdlXG4gICAgICAgIF90aGlzLl9yZWNlaXZlZExlbmd0aCA9IDA7IC8vIHRvdGFsIHJlY2VpdmVkIGJ5dGVzXG4gICAgICAgIF90aGlzLl9sYXN0VGltZUxvYWRlZCA9IDA7IC8vIHJlY2VpdmVkIGJ5dGVzIG9mIGN1cnJlbnQgcmVxdWVzdCBzdWItcmFuZ2VcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhSYW5nZUxvYWRlciwgW3tcbiAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNXb3JraW5nKCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFib3J0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5feGhyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLm9ucHJvZ3Jlc3MgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5vbmxvYWQgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5vbmVycm9yID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX2dldChSYW5nZUxvYWRlci5wcm90b3R5cGUuX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihSYW5nZUxvYWRlci5wcm90b3R5cGUpLCAnZGVzdHJveScsIHRoaXMpLmNhbGwodGhpcyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29wZW4nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb3BlbihkYXRhU291cmNlLCByYW5nZSkge1xuICAgICAgICAgICAgdGhpcy5fZGF0YVNvdXJjZSA9IGRhdGFTb3VyY2U7XG4gICAgICAgICAgICB0aGlzLl9yYW5nZSA9IHJhbmdlO1xuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Nvbm5lY3Rpbmc7XG5cbiAgICAgICAgICAgIHZhciB1c2VSZWZUb3RhbExlbmd0aCA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2RhdGFTb3VyY2UuZmlsZXNpemUgIT0gdW5kZWZpbmVkICYmIHRoaXMuX2RhdGFTb3VyY2UuZmlsZXNpemUgIT09IDApIHtcbiAgICAgICAgICAgICAgICB1c2VSZWZUb3RhbExlbmd0aCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fdG90YWxMZW5ndGggPSB0aGlzLl9kYXRhU291cmNlLmZpbGVzaXplO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXRoaXMuX3RvdGFsTGVuZ3RoUmVjZWl2ZWQgJiYgIXVzZVJlZlRvdGFsTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0b3RhbCBmaWxlc2l6ZVxuICAgICAgICAgICAgICAgIHRoaXMuX3dhaXRGb3JUb3RhbExlbmd0aCA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5faW50ZXJuYWxPcGVuKHRoaXMuX2RhdGFTb3VyY2UsIHsgZnJvbTogMCwgdG86IC0xIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIGZpbGVzaXplLCBzdGFydCBsb2FkaW5nXG4gICAgICAgICAgICAgICAgdGhpcy5fb3BlblN1YlJhbmdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vcGVuU3ViUmFuZ2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29wZW5TdWJSYW5nZSgpIHtcbiAgICAgICAgICAgIHZhciBjaHVua1NpemUgPSB0aGlzLl9jdXJyZW50Q2h1bmtTaXplS0IgKiAxMDI0O1xuXG4gICAgICAgICAgICB2YXIgZnJvbSA9IHRoaXMuX3JhbmdlLmZyb20gKyB0aGlzLl9yZWNlaXZlZExlbmd0aDtcbiAgICAgICAgICAgIHZhciB0byA9IGZyb20gKyBjaHVua1NpemU7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9jb250ZW50TGVuZ3RoICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBpZiAodG8gLSB0aGlzLl9yYW5nZS5mcm9tID49IHRoaXMuX2NvbnRlbnRMZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdG8gPSB0aGlzLl9yYW5nZS5mcm9tICsgdGhpcy5fY29udGVudExlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50UmVxdWVzdFJhbmdlID0geyBmcm9tOiBmcm9tLCB0bzogdG8gfTtcbiAgICAgICAgICAgIHRoaXMuX2ludGVybmFsT3Blbih0aGlzLl9kYXRhU291cmNlLCB0aGlzLl9jdXJyZW50UmVxdWVzdFJhbmdlKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2ludGVybmFsT3BlbicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfaW50ZXJuYWxPcGVuKGRhdGFTb3VyY2UsIHJhbmdlKSB7XG4gICAgICAgICAgICB0aGlzLl9sYXN0VGltZUxvYWRlZCA9IDA7XG5cbiAgICAgICAgICAgIHZhciBzb3VyY2VVUkwgPSBkYXRhU291cmNlLnVybDtcbiAgICAgICAgICAgIGlmICh0aGlzLl9jb25maWcucmV1c2VSZWRpcmVjdGVkVVJMKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRSZWRpcmVjdGVkVVJMICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBzb3VyY2VVUkwgPSB0aGlzLl9jdXJyZW50UmVkaXJlY3RlZFVSTDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGRhdGFTb3VyY2UucmVkaXJlY3RlZFVSTCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgc291cmNlVVJMID0gZGF0YVNvdXJjZS5yZWRpcmVjdGVkVVJMO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHNlZWtDb25maWcgPSB0aGlzLl9zZWVrSGFuZGxlci5nZXRDb25maWcoc291cmNlVVJMLCByYW5nZSk7XG4gICAgICAgICAgICB0aGlzLl9jdXJyZW50UmVxdWVzdFVSTCA9IHNlZWtDb25maWcudXJsO1xuXG4gICAgICAgICAgICB2YXIgeGhyID0gdGhpcy5feGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgICAgICB4aHIub3BlbignR0VUJywgc2Vla0NvbmZpZy51cmwsIHRydWUpO1xuICAgICAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdhcnJheWJ1ZmZlcic7XG4gICAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gdGhpcy5fb25SZWFkeVN0YXRlQ2hhbmdlLmJpbmQodGhpcyk7XG4gICAgICAgICAgICB4aHIub25wcm9ncmVzcyA9IHRoaXMuX29uUHJvZ3Jlc3MuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHhoci5vbmxvYWQgPSB0aGlzLl9vbkxvYWQuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHhoci5vbmVycm9yID0gdGhpcy5fb25YaHJFcnJvci5iaW5kKHRoaXMpO1xuXG4gICAgICAgICAgICBpZiAoZGF0YVNvdXJjZS53aXRoQ3JlZGVudGlhbHMpIHtcbiAgICAgICAgICAgICAgICB4aHIud2l0aENyZWRlbnRpYWxzID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKF90eXBlb2Yoc2Vla0NvbmZpZy5oZWFkZXJzKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICB2YXIgaGVhZGVycyA9IHNlZWtDb25maWcuaGVhZGVycztcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBoZWFkZXJzKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChoZWFkZXJzLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKGtleSwgaGVhZGVyc1trZXldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYWRkIGFkZGl0aW9uYWwgaGVhZGVyc1xuICAgICAgICAgICAgaWYgKF90eXBlb2YodGhpcy5fY29uZmlnLmhlYWRlcnMpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIHZhciBfaGVhZGVycyA9IHRoaXMuX2NvbmZpZy5oZWFkZXJzO1xuXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2tleSBpbiBfaGVhZGVycykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX2hlYWRlcnMuaGFzT3duUHJvcGVydHkoX2tleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKF9rZXksIF9oZWFkZXJzW19rZXldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgeGhyLnNlbmQoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYWJvcnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWJvcnQoKSB7XG4gICAgICAgICAgICB0aGlzLl9yZXF1ZXN0QWJvcnQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5faW50ZXJuYWxBYm9ydCgpO1xuICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0NvbXBsZXRlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfaW50ZXJuYWxBYm9ydCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfaW50ZXJuYWxBYm9ydCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl94aHIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDtcbiAgICAgICAgICAgICAgICB0aGlzLl94aHIub25wcm9ncmVzcyA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLm9ubG9hZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgdGhpcy5feGhyLm9uZXJyb3IgPSBudWxsO1xuICAgICAgICAgICAgICAgIHRoaXMuX3hoci5hYm9ydCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3hociA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblJlYWR5U3RhdGVDaGFuZ2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29uUmVhZHlTdGF0ZUNoYW5nZShlKSB7XG4gICAgICAgICAgICB2YXIgeGhyID0gZS50YXJnZXQ7XG5cbiAgICAgICAgICAgIGlmICh4aHIucmVhZHlTdGF0ZSA9PT0gMikge1xuICAgICAgICAgICAgICAgIC8vIEhFQURFUlNfUkVDRUlWRURcbiAgICAgICAgICAgICAgICBpZiAoeGhyLnJlc3BvbnNlVVJMICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgYnJvd3NlciBzdXBwb3J0IHRoaXMgcHJvcGVydHlcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlZGlyZWN0ZWRVUkwgPSB0aGlzLl9zZWVrSGFuZGxlci5yZW1vdmVVUkxQYXJhbWV0ZXJzKHhoci5yZXNwb25zZVVSTCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh4aHIucmVzcG9uc2VVUkwgIT09IHRoaXMuX2N1cnJlbnRSZXF1ZXN0VVJMICYmIHJlZGlyZWN0ZWRVUkwgIT09IHRoaXMuX2N1cnJlbnRSZWRpcmVjdGVkVVJMKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50UmVkaXJlY3RlZFVSTCA9IHJlZGlyZWN0ZWRVUkw7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25VUkxSZWRpcmVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX29uVVJMUmVkaXJlY3QocmVkaXJlY3RlZFVSTCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoeGhyLnN0YXR1cyA+PSAyMDAgJiYgeGhyLnN0YXR1cyA8PSAyOTkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3dhaXRGb3JUb3RhbExlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtCdWZmZXJpbmc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc3RhdHVzID0gX2xvYWRlci5Mb2FkZXJTdGF0dXMua0Vycm9yO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fb25FcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25FcnJvcihfbG9hZGVyLkxvYWRlckVycm9ycy5IVFRQX1NUQVRVU19DT0RFX0lOVkFMSUQsIHsgY29kZTogeGhyLnN0YXR1cywgbXNnOiB4aHIuc3RhdHVzVGV4dCB9KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLlJ1bnRpbWVFeGNlcHRpb24oJ1JhbmdlTG9hZGVyOiBIdHRwIGNvZGUgaW52YWxpZCwgJyArIHhoci5zdGF0dXMgKyAnICcgKyB4aHIuc3RhdHVzVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblByb2dyZXNzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblByb2dyZXNzKGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGF0dXMgPT09IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcikge1xuICAgICAgICAgICAgICAgIC8vIElnbm9yZSBlcnJvciByZXNwb25zZVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbnRlbnRMZW5ndGggPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3Blbk5leHRSYW5nZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3dhaXRGb3JUb3RhbExlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl93YWl0Rm9yVG90YWxMZW5ndGggPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fdG90YWxMZW5ndGhSZWNlaXZlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG9wZW5OZXh0UmFuZ2UgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciB0b3RhbCA9IGUudG90YWw7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2ludGVybmFsQWJvcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRvdGFsICE9IG51bGwgJiB0b3RhbCAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdG90YWxMZW5ndGggPSB0b3RhbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIGNhbGN1bGF0ZSBjdXJycmVudCByZXF1ZXN0IHJhbmdlJ3MgY29udGVudExlbmd0aFxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9yYW5nZS50byA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29udGVudExlbmd0aCA9IHRoaXMuX3RvdGFsTGVuZ3RoIC0gdGhpcy5fcmFuZ2UuZnJvbTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyB0byAhPT0gLTFcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29udGVudExlbmd0aCA9IHRoaXMuX3JhbmdlLnRvIC0gdGhpcy5fcmFuZ2UuZnJvbSArIDE7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKG9wZW5OZXh0UmFuZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb3BlblN1YlJhbmdlKCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uQ29udGVudExlbmd0aEtub3duKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX29uQ29udGVudExlbmd0aEtub3duKHRoaXMuX2NvbnRlbnRMZW5ndGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGRlbHRhID0gZS5sb2FkZWQgLSB0aGlzLl9sYXN0VGltZUxvYWRlZDtcbiAgICAgICAgICAgIHRoaXMuX2xhc3RUaW1lTG9hZGVkID0gZS5sb2FkZWQ7XG4gICAgICAgICAgICB0aGlzLl9zcGVlZFNhbXBsZXIuYWRkQnl0ZXMoZGVsdGEpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfbm9ybWFsaXplU3BlZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX25vcm1hbGl6ZVNwZWVkKGlucHV0KSB7XG4gICAgICAgICAgICB2YXIgbGlzdCA9IHRoaXMuX2NodW5rU2l6ZUtCTGlzdDtcbiAgICAgICAgICAgIHZhciBsYXN0ID0gbGlzdC5sZW5ndGggLSAxO1xuICAgICAgICAgICAgdmFyIG1pZCA9IDA7XG4gICAgICAgICAgICB2YXIgbGJvdW5kID0gMDtcbiAgICAgICAgICAgIHZhciB1Ym91bmQgPSBsYXN0O1xuXG4gICAgICAgICAgICBpZiAoaW5wdXQgPCBsaXN0WzBdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxpc3RbMF07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHdoaWxlIChsYm91bmQgPD0gdWJvdW5kKSB7XG4gICAgICAgICAgICAgICAgbWlkID0gbGJvdW5kICsgTWF0aC5mbG9vcigodWJvdW5kIC0gbGJvdW5kKSAvIDIpO1xuICAgICAgICAgICAgICAgIGlmIChtaWQgPT09IGxhc3QgfHwgaW5wdXQgPj0gbGlzdFttaWRdICYmIGlucHV0IDwgbGlzdFttaWQgKyAxXSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGlzdFttaWRdO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGlzdFttaWRdIDwgaW5wdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgbGJvdW5kID0gbWlkICsgMTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB1Ym91bmQgPSBtaWQgLSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uTG9hZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25Mb2FkKGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9zdGF0dXMgPT09IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcikge1xuICAgICAgICAgICAgICAgIC8vIElnbm9yZSBlcnJvciByZXNwb25zZVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX3dhaXRGb3JUb3RhbExlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3dhaXRGb3JUb3RhbExlbmd0aCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fbGFzdFRpbWVMb2FkZWQgPSAwO1xuICAgICAgICAgICAgdmFyIEtCcHMgPSB0aGlzLl9zcGVlZFNhbXBsZXIubGFzdFNlY29uZEtCcHM7XG4gICAgICAgICAgICBpZiAoS0JwcyA9PT0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3plcm9TcGVlZENodW5rQ291bnQrKztcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5femVyb1NwZWVkQ2h1bmtDb3VudCA+PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRyeSBnZXQgY3VycmVudEtCcHMgYWZ0ZXIgMyBjaHVua3NcbiAgICAgICAgICAgICAgICAgICAgS0JwcyA9IHRoaXMuX3NwZWVkU2FtcGxlci5jdXJyZW50S0JwcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChLQnBzICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIG5vcm1hbGl6ZWQgPSB0aGlzLl9ub3JtYWxpemVTcGVlZChLQnBzKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fY3VycmVudFNwZWVkTm9ybWFsaXplZCAhPT0gbm9ybWFsaXplZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdXJyZW50U3BlZWROb3JtYWxpemVkID0gbm9ybWFsaXplZDtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3VycmVudENodW5rU2l6ZUtCID0gbm9ybWFsaXplZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBjaHVuayA9IGUudGFyZ2V0LnJlc3BvbnNlO1xuICAgICAgICAgICAgdmFyIGJ5dGVTdGFydCA9IHRoaXMuX3JhbmdlLmZyb20gKyB0aGlzLl9yZWNlaXZlZExlbmd0aDtcbiAgICAgICAgICAgIHRoaXMuX3JlY2VpdmVkTGVuZ3RoICs9IGNodW5rLmJ5dGVMZW5ndGg7XG5cbiAgICAgICAgICAgIHZhciByZXBvcnRDb21wbGV0ZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fY29udGVudExlbmd0aCAhPSBudWxsICYmIHRoaXMuX3JlY2VpdmVkTGVuZ3RoIDwgdGhpcy5fY29udGVudExlbmd0aCkge1xuICAgICAgICAgICAgICAgIC8vIGNvbnRpbnVlIGxvYWQgbmV4dCBjaHVua1xuICAgICAgICAgICAgICAgIHRoaXMuX29wZW5TdWJSYW5nZSgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXBvcnRDb21wbGV0ZSA9IHRydWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGRpc3BhdGNoIHJlY2VpdmVkIGNodW5rXG4gICAgICAgICAgICBpZiAodGhpcy5fb25EYXRhQXJyaXZhbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRGF0YUFycml2YWwoY2h1bmssIGJ5dGVTdGFydCwgdGhpcy5fcmVjZWl2ZWRMZW5ndGgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAocmVwb3J0Q29tcGxldGUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0dXMgPSBfbG9hZGVyLkxvYWRlclN0YXR1cy5rQ29tcGxldGU7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uQ29tcGxldGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fb25Db21wbGV0ZSh0aGlzLl9yYW5nZS5mcm9tLCB0aGlzLl9yYW5nZS5mcm9tICsgdGhpcy5fcmVjZWl2ZWRMZW5ndGggLSAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vblhockVycm9yJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblhockVycm9yKGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3N0YXR1cyA9IF9sb2FkZXIuTG9hZGVyU3RhdHVzLmtFcnJvcjtcbiAgICAgICAgICAgIHZhciB0eXBlID0gMDtcbiAgICAgICAgICAgIHZhciBpbmZvID0gbnVsbDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbnRlbnRMZW5ndGggJiYgdGhpcy5fcmVjZWl2ZWRMZW5ndGggPiAwICYmIHRoaXMuX3JlY2VpdmVkTGVuZ3RoIDwgdGhpcy5fY29udGVudExlbmd0aCkge1xuICAgICAgICAgICAgICAgIHR5cGUgPSBfbG9hZGVyLkxvYWRlckVycm9ycy5FQVJMWV9FT0Y7XG4gICAgICAgICAgICAgICAgaW5mbyA9IHsgY29kZTogLTEsIG1zZzogJ1JhbmdlTG9hZGVyIG1lZXQgRWFybHktRW9mJyB9O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0eXBlID0gX2xvYWRlci5Mb2FkZXJFcnJvcnMuRVhDRVBUSU9OO1xuICAgICAgICAgICAgICAgIGluZm8gPSB7IGNvZGU6IC0xLCBtc2c6IGUuY29uc3RydWN0b3IubmFtZSArICcgJyArIGUudHlwZSB9O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5fb25FcnJvcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX29uRXJyb3IodHlwZSwgaW5mbyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLlJ1bnRpbWVFeGNlcHRpb24oaW5mby5tc2cpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdjdXJyZW50U3BlZWQnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9zcGVlZFNhbXBsZXIubGFzdFNlY29uZEtCcHM7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gUmFuZ2VMb2FkZXI7XG59KF9sb2FkZXIuQmFzZUxvYWRlcik7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFJhbmdlTG9hZGVyO1xuXG59LHtcIi4uL3V0aWxzL2V4Y2VwdGlvbi5qc1wiOjQwLFwiLi4vdXRpbHMvbG9nZ2VyLmpzXCI6NDEsXCIuL2xvYWRlci5qc1wiOjI0LFwiLi9zcGVlZC1zYW1wbGVyLmpzXCI6Mjd9XSwzMjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpOyAvKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIF9ldmVudHMgPSBfZGVyZXFfKCdldmVudHMnKTtcblxudmFyIF9ldmVudHMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXZlbnRzKTtcblxudmFyIF9sb2dnZXIgPSBfZGVyZXFfKCcuLi91dGlscy9sb2dnZXIuanMnKTtcblxudmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTtcblxudmFyIF9icm93c2VyID0gX2RlcmVxXygnLi4vdXRpbHMvYnJvd3Nlci5qcycpO1xuXG52YXIgX2Jyb3dzZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYnJvd3Nlcik7XG5cbnZhciBfcGxheWVyRXZlbnRzID0gX2RlcmVxXygnLi9wbGF5ZXItZXZlbnRzLmpzJyk7XG5cbnZhciBfcGxheWVyRXZlbnRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BsYXllckV2ZW50cyk7XG5cbnZhciBfdHJhbnNtdXhlciA9IF9kZXJlcV8oJy4uL2NvcmUvdHJhbnNtdXhlci5qcycpO1xuXG52YXIgX3RyYW5zbXV4ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHJhbnNtdXhlcik7XG5cbnZhciBfdHJhbnNtdXhpbmdFdmVudHMgPSBfZGVyZXFfKCcuLi9jb3JlL3RyYW5zbXV4aW5nLWV2ZW50cy5qcycpO1xuXG52YXIgX3RyYW5zbXV4aW5nRXZlbnRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RyYW5zbXV4aW5nRXZlbnRzKTtcblxudmFyIF9tc2VDb250cm9sbGVyID0gX2RlcmVxXygnLi4vY29yZS9tc2UtY29udHJvbGxlci5qcycpO1xuXG52YXIgX21zZUNvbnRyb2xsZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbXNlQ29udHJvbGxlcik7XG5cbnZhciBfbXNlRXZlbnRzID0gX2RlcmVxXygnLi4vY29yZS9tc2UtZXZlbnRzLmpzJyk7XG5cbnZhciBfbXNlRXZlbnRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21zZUV2ZW50cyk7XG5cbnZhciBfcGxheWVyRXJyb3JzID0gX2RlcmVxXygnLi9wbGF5ZXItZXJyb3JzLmpzJyk7XG5cbnZhciBfY29uZmlnID0gX2RlcmVxXygnLi4vY29uZmlnLmpzJyk7XG5cbnZhciBfZXhjZXB0aW9uID0gX2RlcmVxXygnLi4vdXRpbHMvZXhjZXB0aW9uLmpzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbnZhciBGbHZQbGF5ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gRmx2UGxheWVyKG1lZGlhRGF0YVNvdXJjZSwgY29uZmlnKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBGbHZQbGF5ZXIpO1xuXG4gICAgICAgIHRoaXMuVEFHID0gJ0ZsdlBsYXllcic7XG4gICAgICAgIHRoaXMuX3R5cGUgPSAnRmx2UGxheWVyJztcbiAgICAgICAgdGhpcy5fZW1pdHRlciA9IG5ldyBfZXZlbnRzMi5kZWZhdWx0KCk7XG5cbiAgICAgICAgdGhpcy5fY29uZmlnID0gKDAsIF9jb25maWcuY3JlYXRlRGVmYXVsdENvbmZpZykoKTtcbiAgICAgICAgaWYgKCh0eXBlb2YgY29uZmlnID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogX3R5cGVvZihjb25maWcpKSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5fY29uZmlnLCBjb25maWcpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1lZGlhRGF0YVNvdXJjZS50eXBlLnRvTG93ZXJDYXNlKCkgIT09ICdmbHYnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbnZhbGlkQXJndW1lbnRFeGNlcHRpb24oJ0ZsdlBsYXllciByZXF1aXJlcyBhbiBmbHYgTWVkaWFEYXRhU291cmNlIGlucHV0IScpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKG1lZGlhRGF0YVNvdXJjZS5pc0xpdmUgPT09IHRydWUpIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbmZpZy5pc0xpdmUgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5lID0ge1xuICAgICAgICAgICAgb252TG9hZGVkTWV0YWRhdGE6IHRoaXMuX29udkxvYWRlZE1ldGFkYXRhLmJpbmQodGhpcyksXG4gICAgICAgICAgICBvbnZTZWVraW5nOiB0aGlzLl9vbnZTZWVraW5nLmJpbmQodGhpcyksXG4gICAgICAgICAgICBvbnZDYW5QbGF5OiB0aGlzLl9vbnZDYW5QbGF5LmJpbmQodGhpcyksXG4gICAgICAgICAgICBvbnZTdGFsbGVkOiB0aGlzLl9vbnZTdGFsbGVkLmJpbmQodGhpcyksXG4gICAgICAgICAgICBvbnZQcm9ncmVzczogdGhpcy5fb252UHJvZ3Jlc3MuYmluZCh0aGlzKVxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChzZWxmLnBlcmZvcm1hbmNlICYmIHNlbGYucGVyZm9ybWFuY2Uubm93KSB7XG4gICAgICAgICAgICB0aGlzLl9ub3cgPSBzZWxmLnBlcmZvcm1hbmNlLm5vdy5iaW5kKHNlbGYucGVyZm9ybWFuY2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5fbm93ID0gRGF0ZS5ub3c7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLl9wZW5kaW5nU2Vla1RpbWUgPSBudWxsOyAvLyBpbiBzZWNvbmRzXG4gICAgICAgIHRoaXMuX3JlcXVlc3RTZXRUaW1lID0gZmFsc2U7XG4gICAgICAgIHRoaXMuX3NlZWtwb2ludFJlY29yZCA9IG51bGw7XG4gICAgICAgIHRoaXMuX3Byb2dyZXNzQ2hlY2tlciA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5fbWVkaWFEYXRhU291cmNlID0gbWVkaWFEYXRhU291cmNlO1xuICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQgPSBudWxsO1xuICAgICAgICB0aGlzLl9tc2VjdGwgPSBudWxsO1xuICAgICAgICB0aGlzLl90cmFuc211eGVyID0gbnVsbDtcblxuICAgICAgICB0aGlzLl9tc2VTb3VyY2VPcGVuZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5faGFzUGVuZGluZ0xvYWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fcmVjZWl2ZWRDYW5QbGF5ID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5fbWVkaWFJbmZvID0gbnVsbDtcbiAgICAgICAgdGhpcy5fc3RhdGlzdGljc0luZm8gPSBudWxsO1xuXG4gICAgICAgIHZhciBjaHJvbWVOZWVkSURSRml4ID0gX2Jyb3dzZXIyLmRlZmF1bHQuY2hyb21lICYmIChfYnJvd3NlcjIuZGVmYXVsdC52ZXJzaW9uLm1ham9yIDwgNTAgfHwgX2Jyb3dzZXIyLmRlZmF1bHQudmVyc2lvbi5tYWpvciA9PT0gNTAgJiYgX2Jyb3dzZXIyLmRlZmF1bHQudmVyc2lvbi5idWlsZCA8IDI2NjEpO1xuICAgICAgICB0aGlzLl9hbHdheXNTZWVrS2V5ZnJhbWUgPSBjaHJvbWVOZWVkSURSRml4IHx8IF9icm93c2VyMi5kZWZhdWx0Lm1zZWRnZSB8fCBfYnJvd3NlcjIuZGVmYXVsdC5tc2llID8gdHJ1ZSA6IGZhbHNlO1xuXG4gICAgICAgIGlmICh0aGlzLl9hbHdheXNTZWVrS2V5ZnJhbWUpIHtcbiAgICAgICAgICAgIHRoaXMuX2NvbmZpZy5hY2N1cmF0ZVNlZWsgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuY2FsbGJhY2tTdHJlYW1UaW1lID0gbnVsbDtcbiAgICAgICAgdGhpcy5fbWVkaWFTb3VyY2VFbmRDYWxsYmFjayA9IG51bGw7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKEZsdlBsYXllciwgW3tcbiAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3Byb2dyZXNzQ2hlY2tlciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5fcHJvZ3Jlc3NDaGVja2VyKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9ncmVzc0NoZWNrZXIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX3RyYW5zbXV4ZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVubG9hZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRoaXMuZGV0YWNoTWVkaWFFbGVtZW50KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmUgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFEYXRhU291cmNlID0gbnVsbDtcblxuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIgPSBudWxsO1xuXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrU3RyZWFtVGltZSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYVNvdXJjZUVuZENhbGxiYWNrID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb24nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb24oZXZlbnQsIGxpc3RlbmVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICAgICAgICBpZiAoZXZlbnQgPT09IF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuTUVESUFfSU5GTykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUluZm8gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLl9lbWl0dGVyLmVtaXQoX3BsYXllckV2ZW50czIuZGVmYXVsdC5NRURJQV9JTkZPLCBfdGhpcy5tZWRpYUluZm8pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50ID09PSBfcGxheWVyRXZlbnRzMi5kZWZhdWx0LlNUQVRJU1RJQ1NfSU5GTykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdGF0aXN0aWNzSW5mbyAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuX2VtaXR0ZXIuZW1pdChfcGxheWVyRXZlbnRzMi5kZWZhdWx0LlNUQVRJU1RJQ1NfSU5GTywgX3RoaXMuc3RhdGlzdGljc0luZm8pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLmFkZExpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ29mZicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBvZmYoZXZlbnQsIGxpc3RlbmVyKSB7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLnJlbW92ZUxpc3RlbmVyKGV2ZW50LCBsaXN0ZW5lcik7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2F0dGFjaE1lZGlhRWxlbWVudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhdHRhY2hNZWRpYUVsZW1lbnQobWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50ID0gbWVkaWFFbGVtZW50O1xuICAgICAgICAgICAgbWVkaWFFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlZG1ldGFkYXRhJywgdGhpcy5lLm9udkxvYWRlZE1ldGFkYXRhKTtcbiAgICAgICAgICAgIC8vbWVkaWFFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3NlZWtpbmcnLCB0aGlzLmUub252U2Vla2luZyk7XG4gICAgICAgICAgICBtZWRpYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2FucGxheScsIHRoaXMuZS5vbnZDYW5QbGF5KTtcbiAgICAgICAgICAgIG1lZGlhRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdGFsbGVkJywgdGhpcy5lLm9udlN0YWxsZWQpO1xuICAgICAgICAgICAgLy9tZWRpYUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCB0aGlzLmUub252UHJvZ3Jlc3MpO1xuXG4gICAgICAgICAgICB0aGlzLl9tc2VjdGwgPSBuZXcgX21zZUNvbnRyb2xsZXIyLmRlZmF1bHQodGhpcy5fY29uZmlnKTtcblxuICAgICAgICAgICAgdGhpcy5fbXNlY3RsLm9uKF9tc2VFdmVudHMyLmRlZmF1bHQuVVBEQVRFX0VORCwgdGhpcy5fb25tc2VVcGRhdGVFbmQuYmluZCh0aGlzKSk7XG4gICAgICAgICAgICB0aGlzLl9tc2VjdGwub24oX21zZUV2ZW50czIuZGVmYXVsdC5CVUZGRVJfRlVMTCwgdGhpcy5fb25tc2VCdWZmZXJGdWxsLmJpbmQodGhpcykpO1xuICAgICAgICAgICAgdGhpcy5fbXNlY3RsLm9uKF9tc2VFdmVudHMyLmRlZmF1bHQuU09VUkNFX09QRU4sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpczIuX21zZVNvdXJjZU9wZW5lZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKF90aGlzMi5faGFzUGVuZGluZ0xvYWQpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMyLl9oYXNQZW5kaW5nTG9hZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICBfdGhpczIubG9hZCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fbXNlY3RsLm9uKF9tc2VFdmVudHMyLmRlZmF1bHQuRVJST1IsIGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMyLl9lbWl0dGVyLmVtaXQoX3BsYXllckV2ZW50czIuZGVmYXVsdC5FUlJPUiwgX3BsYXllckVycm9ycy5FcnJvclR5cGVzLk1FRElBX0VSUk9SLCBfcGxheWVyRXJyb3JzLkVycm9yRGV0YWlscy5NRURJQV9NU0VfRVJST1IsIGluZm8pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl9tc2VjdGwub24oX21zZUV2ZW50czIuZGVmYXVsdC5TT1VSQ0VfRU5ELCBmdW5jdGlvbiAoaW5mbykge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpczIuX21lZGlhU291cmNlRW5kQ2FsbGJhY2sgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpczIuX21lZGlhU291cmNlRW5kQ2FsbGJhY2soaW5mbyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHRoaXMuX21zZWN0bC5hdHRhY2hNZWRpYUVsZW1lbnQobWVkaWFFbGVtZW50KTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX3BlbmRpbmdTZWVrVGltZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gdGhpcy5fcGVuZGluZ1NlZWtUaW1lO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nU2Vla1RpbWUgPSBudWxsO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSUUxMSBtYXkgdGhyb3cgSW52YWxpZFN0YXRlRXJyb3IgaWYgcmVhZHlTdGF0ZSA9PT0gMFxuICAgICAgICAgICAgICAgICAgICAvLyBXZSBjYW4gZGVmZXIgc2V0IGN1cnJlbnRUaW1lIG9wZXJhdGlvbiBhZnRlciBsb2FkZWRtZXRhZGF0YVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZGV0YWNoTWVkaWFFbGVtZW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRldGFjaE1lZGlhRWxlbWVudCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tc2VjdGwuZGV0YWNoTWVkaWFFbGVtZW50KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2xvYWRlZG1ldGFkYXRhJywgdGhpcy5lLm9udkxvYWRlZE1ldGFkYXRhKTtcbiAgICAgICAgICAgICAgICAvL3RoaXMuX21lZGlhRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdzZWVraW5nJywgdGhpcy5lLm9udlNlZWtpbmcpO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdjYW5wbGF5JywgdGhpcy5lLm9udkNhblBsYXkpO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdzdGFsbGVkJywgdGhpcy5lLm9udlN0YWxsZWQpO1xuICAgICAgICAgICAgICAgIC8vdGhpcy5fbWVkaWFFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgdGhpcy5lLm9udlByb2dyZXNzKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX21zZWN0bCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX21zZWN0bC5kZXN0cm95KCk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbXNlY3RsID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbG9hZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzMyA9IHRoaXM7XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5fbWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCdIVE1MTWVkaWFFbGVtZW50IG11c3QgYmUgYXR0YWNoZWQgYmVmb3JlIGxvYWQoKSEnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLl90cmFuc211eGVyKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IF9leGNlcHRpb24uSWxsZWdhbFN0YXRlRXhjZXB0aW9uKCdGbHZQbGF5ZXIubG9hZCgpIGhhcyBiZWVuIGNhbGxlZCwgcGxlYXNlIGNhbGwgdW5sb2FkKCkgZmlyc3QhJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5faGFzUGVuZGluZ0xvYWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9jb25maWcuZGVmZXJMb2FkQWZ0ZXJTb3VyY2VPcGVuICYmIHRoaXMuX21zZVNvdXJjZU9wZW5lZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9oYXNQZW5kaW5nTG9hZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50LnJlYWR5U3RhdGUgPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdFNldFRpbWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIC8vIElFMTEgbWF5IHRocm93IEludmFsaWRTdGF0ZUVycm9yIGlmIHJlYWR5U3RhdGUgPT09IDBcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl90cmFuc211eGVyID0gbmV3IF90cmFuc211eGVyMi5kZWZhdWx0KHRoaXMuX21lZGlhRGF0YVNvdXJjZSwgdGhpcy5fY29uZmlnKTtcblxuICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuSU5JVF9TRUdNRU5ULCBmdW5jdGlvbiAodHlwZSwgaXMpIHtcbiAgICAgICAgICAgICAgICBfdGhpczMuX21zZWN0bC5hcHBlbmRJbml0U2VnbWVudChpcyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FRElBX1NFR01FTlQsIGZ1bmN0aW9uICh0eXBlLCBtcykge1xuICAgICAgICAgICAgICAgIF90aGlzMy5fbXNlY3RsLmFwcGVuZE1lZGlhU2VnbWVudChtcyk7XG5cbiAgICAgICAgICAgICAgICAvLyBsYXp5TG9hZCBjaGVja1xuICAgICAgICAgICAgICAgIGlmIChfdGhpczMuX2NvbmZpZy5sYXp5TG9hZCAmJiAhX3RoaXMzLl9jb25maWcuaXNMaXZlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50VGltZSA9IF90aGlzMy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lO1xuICAgICAgICAgICAgICAgICAgICBpZiAobXMuaW5mby5lbmREdHMgPj0gKGN1cnJlbnRUaW1lICsgX3RoaXMzLl9jb25maWcubGF6eUxvYWRNYXhEdXJhdGlvbikgKiAxMDAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMzLl9wcm9ncmVzc0NoZWNrZXIgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudihfdGhpczMuVEFHLCAnTWF4aW11bSBidWZmZXJpbmcgZHVyYXRpb24gZXhjZWVkZWQsIHN1c3BlbmQgdHJhbnNtdXhpbmcgdGFzaycpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMy5fc3VzcGVuZFRyYW5zbXV4ZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTE9BRElOR19DT01QTEVURSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzMy5fbXNlY3RsLmVuZE9mU3RyZWFtKCk7XG4gICAgICAgICAgICAgICAgX3RoaXMzLl9lbWl0dGVyLmVtaXQoX3BsYXllckV2ZW50czIuZGVmYXVsdC5MT0FESU5HX0NPTVBMRVRFKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuUkVDT1ZFUkVEX0VBUkxZX0VPRiwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzMy5fZW1pdHRlci5lbWl0KF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuUkVDT1ZFUkVEX0VBUkxZX0VPRik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LklPX0VSUk9SLCBmdW5jdGlvbiAoZGV0YWlsLCBpbmZvKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMzLl9lbWl0dGVyLmVtaXQoX3BsYXllckV2ZW50czIuZGVmYXVsdC5FUlJPUiwgX3BsYXllckVycm9ycy5FcnJvclR5cGVzLk5FVFdPUktfRVJST1IsIGRldGFpbCwgaW5mbyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0LkRFTVVYX0VSUk9SLCBmdW5jdGlvbiAoZGV0YWlsLCBpbmZvKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMzLl9lbWl0dGVyLmVtaXQoX3BsYXllckV2ZW50czIuZGVmYXVsdC5FUlJPUiwgX3BsYXllckVycm9ycy5FcnJvclR5cGVzLk1FRElBX0VSUk9SLCBkZXRhaWwsIHsgY29kZTogLTEsIG1zZzogaW5mbyB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuTUVESUFfSU5GTywgZnVuY3Rpb24gKG1lZGlhSW5mbykge1xuICAgICAgICAgICAgICAgIF90aGlzMy5fbWVkaWFJbmZvID0gbWVkaWFJbmZvO1xuICAgICAgICAgICAgICAgIF90aGlzMy5fZW1pdHRlci5lbWl0KF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuTUVESUFfSU5GTywgT2JqZWN0LmFzc2lnbih7fSwgbWVkaWFJbmZvKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIub24oX3RyYW5zbXV4aW5nRXZlbnRzMi5kZWZhdWx0Lk1FVEFEQVRBX0FSUklWRUQsIGZ1bmN0aW9uIChtZXRhZGF0YSkge1xuICAgICAgICAgICAgICAgIF90aGlzMy5fZW1pdHRlci5lbWl0KF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuTUVUQURBVEFfQVJSSVZFRCwgbWV0YWRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TQ1JJUFREQVRBX0FSUklWRUQsIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMzLl9lbWl0dGVyLmVtaXQoX3BsYXllckV2ZW50czIuZGVmYXVsdC5TQ1JJUFREQVRBX0FSUklWRUQsIGRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TVEFUSVNUSUNTX0lORk8sIGZ1bmN0aW9uIChzdGF0SW5mbykge1xuICAgICAgICAgICAgICAgIF90aGlzMy5fc3RhdGlzdGljc0luZm8gPSBfdGhpczMuX2ZpbGxTdGF0aXN0aWNzSW5mbyhzdGF0SW5mbyk7XG4gICAgICAgICAgICAgICAgX3RoaXMzLl9lbWl0dGVyLmVtaXQoX3BsYXllckV2ZW50czIuZGVmYXVsdC5TVEFUSVNUSUNTX0lORk8sIE9iamVjdC5hc3NpZ24oe30sIF90aGlzMy5fc3RhdGlzdGljc0luZm8pKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5vbihfdHJhbnNtdXhpbmdFdmVudHMyLmRlZmF1bHQuUkVDT01NRU5EX1NFRUtQT0lOVCwgZnVuY3Rpb24gKG1pbGxpc2Vjb25kcykge1xuICAgICAgICAgICAgICAgIGlmIChfdGhpczMuX21lZGlhRWxlbWVudCAmJiAhX3RoaXMzLl9jb25maWcuYWNjdXJhdGVTZWVrKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzMy5fcmVxdWVzdFNldFRpbWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBfdGhpczMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IG1pbGxpc2Vjb25kcyAvIDEwMDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLm9uKF90cmFuc211eGluZ0V2ZW50czIuZGVmYXVsdC5TVFJFQU1fVElNRSwgZnVuY3Rpb24gKHRzKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMzLl9yZWNlaXZlU3RyZWFtVGltZSh0cyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5vcGVuKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3VubG9hZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1bmxvYWQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnBhdXNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fbXNlY3RsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbXNlY3RsLnNlZWsoMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5fdHJhbnNtdXhlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLmRlc3Ryb3koKTtcbiAgICAgICAgICAgICAgICB0aGlzLl90cmFuc211eGVyID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncGxheScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBwbGF5KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21lZGlhRWxlbWVudC5wbGF5KCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3BhdXNlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnBhdXNlKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19maWxsU3RhdGlzdGljc0luZm8nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2ZpbGxTdGF0aXN0aWNzSW5mbyhzdGF0SW5mbykge1xuICAgICAgICAgICAgc3RhdEluZm8ucGxheWVyVHlwZSA9IHRoaXMuX3R5cGU7XG5cbiAgICAgICAgICAgIGlmICghKHRoaXMuX21lZGlhRWxlbWVudCBpbnN0YW5jZW9mIEhUTUxWaWRlb0VsZW1lbnQpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXRJbmZvO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgaGFzUXVhbGl0eUluZm8gPSB0cnVlO1xuICAgICAgICAgICAgdmFyIGRlY29kZWQgPSAwO1xuICAgICAgICAgICAgdmFyIGRyb3BwZWQgPSAwO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50LmdldFZpZGVvUGxheWJhY2tRdWFsaXR5KSB7XG4gICAgICAgICAgICAgICAgdmFyIHF1YWxpdHkgPSB0aGlzLl9tZWRpYUVsZW1lbnQuZ2V0VmlkZW9QbGF5YmFja1F1YWxpdHkoKTtcbiAgICAgICAgICAgICAgICBkZWNvZGVkID0gcXVhbGl0eS50b3RhbFZpZGVvRnJhbWVzO1xuICAgICAgICAgICAgICAgIGRyb3BwZWQgPSBxdWFsaXR5LmRyb3BwZWRWaWRlb0ZyYW1lcztcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5fbWVkaWFFbGVtZW50LndlYmtpdERlY29kZWRGcmFtZUNvdW50ICE9IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIGRlY29kZWQgPSB0aGlzLl9tZWRpYUVsZW1lbnQud2Via2l0RGVjb2RlZEZyYW1lQ291bnQ7XG4gICAgICAgICAgICAgICAgZHJvcHBlZCA9IHRoaXMuX21lZGlhRWxlbWVudC53ZWJraXREcm9wcGVkRnJhbWVDb3VudDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaGFzUXVhbGl0eUluZm8gPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGhhc1F1YWxpdHlJbmZvKSB7XG4gICAgICAgICAgICAgICAgc3RhdEluZm8uZGVjb2RlZEZyYW1lcyA9IGRlY29kZWQ7XG4gICAgICAgICAgICAgICAgc3RhdEluZm8uZHJvcHBlZEZyYW1lcyA9IGRyb3BwZWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBzdGF0SW5mbztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29ubXNlVXBkYXRlRW5kJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbm1zZVVwZGF0ZUVuZCgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fY29uZmlnLmxhenlMb2FkIHx8IHRoaXMuX2NvbmZpZy5pc0xpdmUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBidWZmZXJlZCA9IHRoaXMuX21lZGlhRWxlbWVudC5idWZmZXJlZDtcbiAgICAgICAgICAgIHZhciBjdXJyZW50VGltZSA9IHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZTtcbiAgICAgICAgICAgIHZhciBjdXJyZW50UmFuZ2VTdGFydCA9IDA7XG4gICAgICAgICAgICB2YXIgY3VycmVudFJhbmdlRW5kID0gMDtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBidWZmZXJlZC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IGJ1ZmZlcmVkLnN0YXJ0KGkpO1xuICAgICAgICAgICAgICAgIHZhciBlbmQgPSBidWZmZXJlZC5lbmQoaSk7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXJ0IDw9IGN1cnJlbnRUaW1lICYmIGN1cnJlbnRUaW1lIDwgZW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRSYW5nZVN0YXJ0ID0gc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRSYW5nZUVuZCA9IGVuZDtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY3VycmVudFJhbmdlRW5kID49IGN1cnJlbnRUaW1lICsgdGhpcy5fY29uZmlnLmxhenlMb2FkTWF4RHVyYXRpb24gJiYgdGhpcy5fcHJvZ3Jlc3NDaGVja2VyID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYodGhpcy5UQUcsICdNYXhpbXVtIGJ1ZmZlcmluZyBkdXJhdGlvbiBleGNlZWRlZCwgc3VzcGVuZCB0cmFuc211eGluZyB0YXNrJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fc3VzcGVuZFRyYW5zbXV4ZXIoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29ubXNlQnVmZmVyRnVsbCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb25tc2VCdWZmZXJGdWxsKCkge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KHRoaXMuVEFHLCAnTVNFIFNvdXJjZUJ1ZmZlciBpcyBmdWxsLCBzdXNwZW5kIHRyYW5zbXV4aW5nIHRhc2snKTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9wcm9ncmVzc0NoZWNrZXIgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N1c3BlbmRUcmFuc211eGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19zdXNwZW5kVHJhbnNtdXhlcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfc3VzcGVuZFRyYW5zbXV4ZXIoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fdHJhbnNtdXhlcikge1xuICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIucGF1c2UoKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9wcm9ncmVzc0NoZWNrZXIgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wcm9ncmVzc0NoZWNrZXIgPSB3aW5kb3cuc2V0SW50ZXJ2YWwodGhpcy5fY2hlY2tQcm9ncmVzc0FuZFJlc3VtZS5iaW5kKHRoaXMpLCAxMDAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19jaGVja1Byb2dyZXNzQW5kUmVzdW1lJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9jaGVja1Byb2dyZXNzQW5kUmVzdW1lKCkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRUaW1lID0gdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lO1xuICAgICAgICAgICAgdmFyIGJ1ZmZlcmVkID0gdGhpcy5fbWVkaWFFbGVtZW50LmJ1ZmZlcmVkO1xuXG4gICAgICAgICAgICB2YXIgbmVlZFJlc3VtZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJ1ZmZlcmVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyb20gPSBidWZmZXJlZC5zdGFydChpKTtcbiAgICAgICAgICAgICAgICB2YXIgdG8gPSBidWZmZXJlZC5lbmQoaSk7XG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRUaW1lID49IGZyb20gJiYgY3VycmVudFRpbWUgPCB0bykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFRpbWUgPj0gdG8gLSB0aGlzLl9jb25maWcubGF6eUxvYWRSZWNvdmVyRHVyYXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5lZWRSZXN1bWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG5lZWRSZXN1bWUpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLl9wcm9ncmVzc0NoZWNrZXIpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3Byb2dyZXNzQ2hlY2tlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgaWYgKG5lZWRSZXN1bWUpIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC52KHRoaXMuVEFHLCAnQ29udGludWUgbG9hZGluZyBmcm9tIHBhdXNlZCBwb3NpdGlvbicpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90cmFuc211eGVyLnJlc3VtZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2lzVGltZXBvaW50QnVmZmVyZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2lzVGltZXBvaW50QnVmZmVyZWQoc2Vjb25kcykge1xuICAgICAgICAgICAgdmFyIGJ1ZmZlcmVkID0gdGhpcy5fbWVkaWFFbGVtZW50LmJ1ZmZlcmVkO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJ1ZmZlcmVkLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyb20gPSBidWZmZXJlZC5zdGFydChpKTtcbiAgICAgICAgICAgICAgICB2YXIgdG8gPSBidWZmZXJlZC5lbmQoaSk7XG4gICAgICAgICAgICAgICAgaWYgKHNlY29uZHMgPj0gZnJvbSAmJiBzZWNvbmRzIDwgdG8pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfaW50ZXJuYWxTZWVrJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9pbnRlcm5hbFNlZWsoc2Vjb25kcykge1xuICAgICAgICAgICAgdmFyIGRpcmVjdFNlZWsgPSB0aGlzLl9pc1RpbWVwb2ludEJ1ZmZlcmVkKHNlY29uZHMpO1xuXG4gICAgICAgICAgICB2YXIgZGlyZWN0U2Vla0JlZ2luID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgZGlyZWN0U2Vla0JlZ2luVGltZSA9IDA7XG5cbiAgICAgICAgICAgIGlmIChzZWNvbmRzIDwgMS4wICYmIHRoaXMuX21lZGlhRWxlbWVudC5idWZmZXJlZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIHZpZGVvQmVnaW5UaW1lID0gdGhpcy5fbWVkaWFFbGVtZW50LmJ1ZmZlcmVkLnN0YXJ0KDApO1xuICAgICAgICAgICAgICAgIGlmICh2aWRlb0JlZ2luVGltZSA8IDEuMCAmJiBzZWNvbmRzIDwgdmlkZW9CZWdpblRpbWUgfHwgX2Jyb3dzZXIyLmRlZmF1bHQuc2FmYXJpKSB7XG4gICAgICAgICAgICAgICAgICAgIGRpcmVjdFNlZWtCZWdpbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIC8vIGFsc28gd29ya2Fyb3VuZCBmb3IgU2FmYXJpOiBTZWVrIHRvIDAgbWF5IGNhdXNlIHZpZGVvIHN0dWNrLCB1c2UgMC4xIHRvIGF2b2lkXG4gICAgICAgICAgICAgICAgICAgIGRpcmVjdFNlZWtCZWdpblRpbWUgPSBfYnJvd3NlcjIuZGVmYXVsdC5zYWZhcmkgPyAwLjEgOiB2aWRlb0JlZ2luVGltZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChkaXJlY3RTZWVrQmVnaW4pIHtcbiAgICAgICAgICAgICAgICAvLyBzZWVrIHRvIHZpZGVvIGJlZ2luLCBzZXQgY3VycmVudFRpbWUgZGlyZWN0bHkgaWYgYmVnaW5QVFMgYnVmZmVyZWRcbiAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0U2V0VGltZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gZGlyZWN0U2Vla0JlZ2luVGltZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZGlyZWN0U2Vlaykge1xuICAgICAgICAgICAgICAgIC8vIGJ1ZmZlcmVkIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLl9hbHdheXNTZWVrS2V5ZnJhbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdFNldFRpbWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSBzZWNvbmRzO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpZHIgPSB0aGlzLl9tc2VjdGwuZ2V0TmVhcmVzdEtleWZyYW1lKE1hdGguZmxvb3Ioc2Vjb25kcyAqIDEwMDApKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdFNldFRpbWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaWRyICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IGlkci5kdHMgLyAxMDAwO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gc2Vjb25kcztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fcHJvZ3Jlc3NDaGVja2VyICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2hlY2tQcm9ncmVzc0FuZFJlc3VtZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Byb2dyZXNzQ2hlY2tlciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhckludGVydmFsKHRoaXMuX3Byb2dyZXNzQ2hlY2tlcik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3Byb2dyZXNzQ2hlY2tlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX21zZWN0bC5zZWVrKHNlY29uZHMpO1xuICAgICAgICAgICAgICAgIHRoaXMuX3RyYW5zbXV4ZXIuc2VlayhNYXRoLmZsb29yKHNlY29uZHMgKiAxMDAwKSk7IC8vIGluIG1pbGxpc2Vjb25kc1xuICAgICAgICAgICAgICAgIC8vIG5vIG5lZWQgdG8gc2V0IG1lZGlhRWxlbWVudC5jdXJyZW50VGltZSBpZiBub24tYWNjdXJhdGVTZWVrLFxuICAgICAgICAgICAgICAgIC8vIGp1c3Qgd2FpdCBmb3IgdGhlIHJlY29tbWVuZF9zZWVrcG9pbnQgY2FsbGJhY2tcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fY29uZmlnLmFjY3VyYXRlU2Vlaykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0U2V0VGltZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IHNlY29uZHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfY2hlY2tBbmRBcHBseVVuYnVmZmVyZWRTZWVrcG9pbnQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX2NoZWNrQW5kQXBwbHlVbmJ1ZmZlcmVkU2Vla3BvaW50KCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3NlZWtwb2ludFJlY29yZCkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zZWVrcG9pbnRSZWNvcmQucmVjb3JkVGltZSA8PSB0aGlzLl9ub3coKSAtIDEwMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9zZWVrcG9pbnRSZWNvcmQgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2lzVGltZXBvaW50QnVmZmVyZWQodGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Byb2dyZXNzQ2hlY2tlciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLl9wcm9ncmVzc0NoZWNrZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3Byb2dyZXNzQ2hlY2tlciA9IG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAuY3VycmVudFRpbWUgaXMgY29uc2lzdHMgd2l0aCAuYnVmZmVyZWQgdGltZXN0YW1wXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDaHJvbWUvRWRnZSB1c2UgRFRTLCB3aGlsZSBGaXJlRm94L1NhZmFyaSB1c2UgUFRTXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9tc2VjdGwuc2Vlayh0YXJnZXQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fdHJhbnNtdXhlci5zZWVrKE1hdGguZmxvb3IodGFyZ2V0ICogMTAwMCkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IGN1cnJlbnRUaW1lIGlmIGFjY3VyYXRlU2Vlaywgb3Igd2FpdCBmb3IgcmVjb21tZW5kX3NlZWtwb2ludCBjYWxsYmFja1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2NvbmZpZy5hY2N1cmF0ZVNlZWspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0U2V0VGltZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gdGFyZ2V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQodGhpcy5fY2hlY2tBbmRBcHBseVVuYnVmZmVyZWRTZWVrcG9pbnQuYmluZCh0aGlzKSwgNTApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX2NoZWNrQW5kUmVzdW1lU3R1Y2tQbGF5YmFjaycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfY2hlY2tBbmRSZXN1bWVTdHVja1BsYXliYWNrKHN0YWxsZWQpIHtcbiAgICAgICAgICAgIHZhciBtZWRpYSA9IHRoaXMuX21lZGlhRWxlbWVudDtcbiAgICAgICAgICAgIGlmIChzdGFsbGVkIHx8ICF0aGlzLl9yZWNlaXZlZENhblBsYXkgfHwgbWVkaWEucmVhZHlTdGF0ZSA8IDIpIHtcbiAgICAgICAgICAgICAgICAvLyBIQVZFX0NVUlJFTlRfREFUQVxuICAgICAgICAgICAgICAgIHZhciBidWZmZXJlZCA9IG1lZGlhLmJ1ZmZlcmVkO1xuICAgICAgICAgICAgICAgIGlmIChidWZmZXJlZC5sZW5ndGggPiAwICYmIG1lZGlhLmN1cnJlbnRUaW1lIDwgYnVmZmVyZWQuc3RhcnQoMCkpIHtcbiAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnUGxheWJhY2sgc2VlbXMgc3R1Y2sgYXQgJyArIG1lZGlhLmN1cnJlbnRUaW1lICsgJywgc2VlayB0byAnICsgYnVmZmVyZWQuc3RhcnQoMCkpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXF1ZXN0U2V0VGltZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IGJ1ZmZlcmVkLnN0YXJ0KDApO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCB0aGlzLmUub252UHJvZ3Jlc3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gUGxheWJhY2sgZGlkbid0IHN0dWNrLCByZW1vdmUgcHJvZ3Jlc3MgZXZlbnQgbGlzdGVuZXJcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCB0aGlzLmUub252UHJvZ3Jlc3MpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb252TG9hZGVkTWV0YWRhdGEnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29udkxvYWRlZE1ldGFkYXRhKGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nU2Vla1RpbWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IHRoaXMuX3BlbmRpbmdTZWVrVGltZTtcbiAgICAgICAgICAgICAgICB0aGlzLl9wZW5kaW5nU2Vla1RpbWUgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb252U2Vla2luZycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfb252U2Vla2luZyhlKSB7XG4gICAgICAgICAgICAvLyBoYW5kbGUgc2Vla2luZyByZXF1ZXN0IGZyb20gYnJvd3NlcidzIHByb2dyZXNzIGJhclxuICAgICAgICAgICAgdmFyIHRhcmdldCA9IHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZTtcbiAgICAgICAgICAgIHZhciBidWZmZXJlZCA9IHRoaXMuX21lZGlhRWxlbWVudC5idWZmZXJlZDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX3JlcXVlc3RTZXRUaW1lKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdFNldFRpbWUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0YXJnZXQgPCAxLjAgJiYgYnVmZmVyZWQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIC8vIHNlZWsgdG8gdmlkZW8gYmVnaW4sIHNldCBjdXJyZW50VGltZSBkaXJlY3RseSBpZiBiZWdpblBUUyBidWZmZXJlZFxuICAgICAgICAgICAgICAgIHZhciB2aWRlb0JlZ2luVGltZSA9IGJ1ZmZlcmVkLnN0YXJ0KDApO1xuICAgICAgICAgICAgICAgIGlmICh2aWRlb0JlZ2luVGltZSA8IDEuMCAmJiB0YXJnZXQgPCB2aWRlb0JlZ2luVGltZSB8fCBfYnJvd3NlcjIuZGVmYXVsdC5zYWZhcmkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdFNldFRpbWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAvLyBhbHNvIHdvcmthcm91bmQgZm9yIFNhZmFyaTogU2VlayB0byAwIG1heSBjYXVzZSB2aWRlbyBzdHVjaywgdXNlIDAuMSB0byBhdm9pZFxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSBfYnJvd3NlcjIuZGVmYXVsdC5zYWZhcmkgPyAwLjEgOiB2aWRlb0JlZ2luVGltZTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuX2lzVGltZXBvaW50QnVmZmVyZWQodGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hbHdheXNTZWVrS2V5ZnJhbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGlkciA9IHRoaXMuX21zZWN0bC5nZXROZWFyZXN0S2V5ZnJhbWUoTWF0aC5mbG9vcih0YXJnZXQgKiAxMDAwKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpZHIgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fcmVxdWVzdFNldFRpbWUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gaWRyLmR0cyAvIDEwMDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3Byb2dyZXNzQ2hlY2tlciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrUHJvZ3Jlc3NBbmRSZXN1bWUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl9zZWVrcG9pbnRSZWNvcmQgPSB7XG4gICAgICAgICAgICAgICAgc2Vla1BvaW50OiB0YXJnZXQsXG4gICAgICAgICAgICAgICAgcmVjb3JkVGltZTogdGhpcy5fbm93KClcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dCh0aGlzLl9jaGVja0FuZEFwcGx5VW5idWZmZXJlZFNlZWtwb2ludC5iaW5kKHRoaXMpLCA1MCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19vbnZDYW5QbGF5JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbnZDYW5QbGF5KGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3JlY2VpdmVkQ2FuUGxheSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2FucGxheScsIHRoaXMuZS5vbnZDYW5QbGF5KTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29udlN0YWxsZWQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29udlN0YWxsZWQoZSkge1xuICAgICAgICAgICAgdGhpcy5fY2hlY2tBbmRSZXN1bWVTdHVja1BsYXliYWNrKHRydWUpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfb252UHJvZ3Jlc3MnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX29udlByb2dyZXNzKGUpIHtcbiAgICAgICAgICAgIHRoaXMuX2NoZWNrQW5kUmVzdW1lU3R1Y2tQbGF5YmFjaygpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzZXRNZWRpYVNvdXJjZUVuZENhbGxiYWNrJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNldE1lZGlhU291cmNlRW5kQ2FsbGJhY2soY2FsbCkge1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFTb3VyY2VFbmRDYWxsYmFjayA9IGNhbGw7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3NldFN0cmVhbVRpbWVDYWxsYmFjaycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRTdHJlYW1UaW1lQ2FsbGJhY2soY2FsbCkge1xuICAgICAgICAgICAgdGhpcy5jYWxsYmFja1N0cmVhbVRpbWUgPSBjYWxsO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfcmVjZWl2ZVN0cmVhbVRpbWUnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3JlY2VpdmVTdHJlYW1UaW1lKHRzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5jYWxsYmFja1N0cmVhbVRpbWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tTdHJlYW1UaW1lKHRzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndHlwZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3R5cGU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2J1ZmZlcmVkJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWVkaWFFbGVtZW50LmJ1ZmZlcmVkO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdkdXJhdGlvbicsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21lZGlhRWxlbWVudC5kdXJhdGlvbjtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndm9sdW1lJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWVkaWFFbGVtZW50LnZvbHVtZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC52b2x1bWUgPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbXV0ZWQnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tZWRpYUVsZW1lbnQubXV0ZWQ7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KG11dGVkKSB7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQubXV0ZWQgPSBtdXRlZDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnY3VycmVudFRpbWUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHNlY29uZHMpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9pbnRlcm5hbFNlZWsoc2Vjb25kcyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX3BlbmRpbmdTZWVrVGltZSA9IHNlY29uZHM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ21lZGlhSW5mbycsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHRoaXMuX21lZGlhSW5mbyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3N0YXRpc3RpY3NJbmZvJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fc3RhdGlzdGljc0luZm8gPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3N0YXRpc3RpY3NJbmZvID0ge307XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9zdGF0aXN0aWNzSW5mbyA9IHRoaXMuX2ZpbGxTdGF0aXN0aWNzSW5mbyh0aGlzLl9zdGF0aXN0aWNzSW5mbyk7XG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5fc3RhdGlzdGljc0luZm8pO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIEZsdlBsYXllcjtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gRmx2UGxheWVyO1xuXG59LHtcIi4uL2NvbmZpZy5qc1wiOjUsXCIuLi9jb3JlL21zZS1jb250cm9sbGVyLmpzXCI6OSxcIi4uL2NvcmUvbXNlLWV2ZW50cy5qc1wiOjEwLFwiLi4vY29yZS90cmFuc211eGVyLmpzXCI6MTEsXCIuLi9jb3JlL3RyYW5zbXV4aW5nLWV2ZW50cy5qc1wiOjEzLFwiLi4vdXRpbHMvYnJvd3Nlci5qc1wiOjM5LFwiLi4vdXRpbHMvZXhjZXB0aW9uLmpzXCI6NDAsXCIuLi91dGlscy9sb2dnZXIuanNcIjo0MSxcIi4vcGxheWVyLWVycm9ycy5qc1wiOjM0LFwiLi9wbGF5ZXItZXZlbnRzLmpzXCI6MzUsXCJldmVudHNcIjoyfV0sMzM6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfdHlwZW9mID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIgPyBmdW5jdGlvbiAob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9IDogZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajsgfTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfZXZlbnRzID0gX2RlcmVxXygnZXZlbnRzJyk7XG5cbnZhciBfZXZlbnRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V2ZW50cyk7XG5cbnZhciBfcGxheWVyRXZlbnRzID0gX2RlcmVxXygnLi9wbGF5ZXItZXZlbnRzLmpzJyk7XG5cbnZhciBfcGxheWVyRXZlbnRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3BsYXllckV2ZW50cyk7XG5cbnZhciBfY29uZmlnID0gX2RlcmVxXygnLi4vY29uZmlnLmpzJyk7XG5cbnZhciBfZXhjZXB0aW9uID0gX2RlcmVxXygnLi4vdXRpbHMvZXhjZXB0aW9uLmpzJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8vIFBsYXllciB3cmFwcGVyIGZvciBicm93c2VyJ3MgbmF0aXZlIHBsYXllciAoSFRNTFZpZGVvRWxlbWVudCkgd2l0aG91dCBNZWRpYVNvdXJjZSBzcmMuIFxudmFyIE5hdGl2ZVBsYXllciA9IGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBOYXRpdmVQbGF5ZXIobWVkaWFEYXRhU291cmNlLCBjb25maWcpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE5hdGl2ZVBsYXllcik7XG5cbiAgICAgICAgdGhpcy5UQUcgPSAnTmF0aXZlUGxheWVyJztcbiAgICAgICAgdGhpcy5fdHlwZSA9ICdOYXRpdmVQbGF5ZXInO1xuICAgICAgICB0aGlzLl9lbWl0dGVyID0gbmV3IF9ldmVudHMyLmRlZmF1bHQoKTtcblxuICAgICAgICB0aGlzLl9jb25maWcgPSAoMCwgX2NvbmZpZy5jcmVhdGVEZWZhdWx0Q29uZmlnKSgpO1xuICAgICAgICBpZiAoKHR5cGVvZiBjb25maWcgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKGNvbmZpZykpID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLl9jb25maWcsIGNvbmZpZyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAobWVkaWFEYXRhU291cmNlLnR5cGUudG9Mb3dlckNhc2UoKSA9PT0gJ2ZsdicpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLkludmFsaWRBcmd1bWVudEV4Y2VwdGlvbignTmF0aXZlUGxheWVyIGRvZXNcXCd0IHN1cHBvcnQgZmx2IE1lZGlhRGF0YVNvdXJjZSBpbnB1dCEnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobWVkaWFEYXRhU291cmNlLmhhc093blByb3BlcnR5KCdzZWdtZW50cycpKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbnZhbGlkQXJndW1lbnRFeGNlcHRpb24oJ05hdGl2ZVBsYXllcignICsgbWVkaWFEYXRhU291cmNlLnR5cGUgKyAnKSBkb2VzblxcJ3Qgc3VwcG9ydCBtdWx0aXBhcnQgcGxheWJhY2shJyk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmUgPSB7XG4gICAgICAgICAgICBvbnZMb2FkZWRNZXRhZGF0YTogdGhpcy5fb252TG9hZGVkTWV0YWRhdGEuYmluZCh0aGlzKVxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuX3BlbmRpbmdTZWVrVGltZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3N0YXRpc3RpY3NSZXBvcnRlciA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5fbWVkaWFEYXRhU291cmNlID0gbWVkaWFEYXRhU291cmNlO1xuICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQgPSBudWxsO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhOYXRpdmVQbGF5ZXIsIFt7XG4gICAgICAgIGtleTogJ2Rlc3Ryb3knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVubG9hZCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuZGV0YWNoTWVkaWFFbGVtZW50KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmUgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFEYXRhU291cmNlID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb24nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gb24oZXZlbnQsIGxpc3RlbmVyKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICAgICAgICBpZiAoZXZlbnQgPT09IF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuTUVESUFfSU5GTykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQgIT0gbnVsbCAmJiB0aGlzLl9tZWRpYUVsZW1lbnQucmVhZHlTdGF0ZSAhPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBIQVZFX05PVEhJTkdcbiAgICAgICAgICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fZW1pdHRlci5lbWl0KF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuTUVESUFfSU5GTywgX3RoaXMubWVkaWFJbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChldmVudCA9PT0gX3BsYXllckV2ZW50czIuZGVmYXVsdC5TVEFUSVNUSUNTX0lORk8pIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50ICE9IG51bGwgJiYgdGhpcy5fbWVkaWFFbGVtZW50LnJlYWR5U3RhdGUgIT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5fZW1pdHRlci5lbWl0KF9wbGF5ZXJFdmVudHMyLmRlZmF1bHQuU1RBVElTVElDU19JTkZPLCBfdGhpcy5zdGF0aXN0aWNzSW5mbyk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuYWRkTGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb2ZmJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG9mZihldmVudCwgbGlzdGVuZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIucmVtb3ZlTGlzdGVuZXIoZXZlbnQsIGxpc3RlbmVyKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYXR0YWNoTWVkaWFFbGVtZW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGF0dGFjaE1lZGlhRWxlbWVudChtZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudCA9IG1lZGlhRWxlbWVudDtcbiAgICAgICAgICAgIG1lZGlhRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWRtZXRhZGF0YScsIHRoaXMuZS5vbnZMb2FkZWRNZXRhZGF0YSk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9wZW5kaW5nU2Vla1RpbWUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIG1lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IHRoaXMuX3BlbmRpbmdTZWVrVGltZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1NlZWtUaW1lID0gbnVsbDtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIElFMTEgbWF5IHRocm93IEludmFsaWRTdGF0ZUVycm9yIGlmIHJlYWR5U3RhdGUgPT09IDBcbiAgICAgICAgICAgICAgICAgICAgLy8gRGVmZXIgc2V0IGN1cnJlbnRUaW1lIG9wZXJhdGlvbiBhZnRlciBsb2FkZWRtZXRhZGF0YVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZGV0YWNoTWVkaWFFbGVtZW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGRldGFjaE1lZGlhRWxlbWVudCgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuc3JjID0gJyc7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnJlbW92ZUF0dHJpYnV0ZSgnc3JjJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2xvYWRlZG1ldGFkYXRhJywgdGhpcy5lLm9udkxvYWRlZE1ldGFkYXRhKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXRpc3RpY3NSZXBvcnRlciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5fc3RhdGlzdGljc1JlcG9ydGVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0aXN0aWNzUmVwb3J0ZXIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdsb2FkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWQoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuX21lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBfZXhjZXB0aW9uLklsbGVnYWxTdGF0ZUV4Y2VwdGlvbignSFRNTE1lZGlhRWxlbWVudCBtdXN0IGJlIGF0dGFjaGVkIGJlZm9yZSBsb2FkKCkhJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuc3JjID0gdGhpcy5fbWVkaWFEYXRhU291cmNlLnVybDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudC5yZWFkeVN0YXRlID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZSA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5wcmVsb2FkID0gJ2F1dG8nO1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LmxvYWQoKTtcbiAgICAgICAgICAgIHRoaXMuX3N0YXRpc3RpY3NSZXBvcnRlciA9IHdpbmRvdy5zZXRJbnRlcnZhbCh0aGlzLl9yZXBvcnRTdGF0aXN0aWNzSW5mby5iaW5kKHRoaXMpLCB0aGlzLl9jb25maWcuc3RhdGlzdGljc0luZm9SZXBvcnRJbnRlcnZhbCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3VubG9hZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB1bmxvYWQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LnNyYyA9ICcnO1xuICAgICAgICAgICAgICAgIHRoaXMuX21lZGlhRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoJ3NyYycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuX3N0YXRpc3RpY3NSZXBvcnRlciAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmNsZWFySW50ZXJ2YWwodGhpcy5fc3RhdGlzdGljc1JlcG9ydGVyKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9zdGF0aXN0aWNzUmVwb3J0ZXIgPSBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdwbGF5JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHBsYXkoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWVkaWFFbGVtZW50LnBsYXkoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncGF1c2UnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQucGF1c2UoKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29udkxvYWRlZE1ldGFkYXRhJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vbnZMb2FkZWRNZXRhZGF0YShlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fcGVuZGluZ1NlZWtUaW1lICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQuY3VycmVudFRpbWUgPSB0aGlzLl9wZW5kaW5nU2Vla1RpbWU7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1NlZWtUaW1lID0gbnVsbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfcGxheWVyRXZlbnRzMi5kZWZhdWx0Lk1FRElBX0lORk8sIHRoaXMubWVkaWFJbmZvKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3JlcG9ydFN0YXRpc3RpY3NJbmZvJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9yZXBvcnRTdGF0aXN0aWNzSW5mbygpIHtcbiAgICAgICAgICAgIHRoaXMuX2VtaXR0ZXIuZW1pdChfcGxheWVyRXZlbnRzMi5kZWZhdWx0LlNUQVRJU1RJQ1NfSU5GTywgdGhpcy5zdGF0aXN0aWNzSW5mbyk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3R5cGUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90eXBlO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdidWZmZXJlZCcsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21lZGlhRWxlbWVudC5idWZmZXJlZDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZHVyYXRpb24nLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tZWRpYUVsZW1lbnQuZHVyYXRpb247XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3ZvbHVtZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21lZGlhRWxlbWVudC52b2x1bWU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLl9tZWRpYUVsZW1lbnQudm9sdW1lID0gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ211dGVkJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbWVkaWFFbGVtZW50Lm11dGVkO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChtdXRlZCkge1xuICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50Lm11dGVkID0gbXV0ZWQ7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2N1cnJlbnRUaW1lJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21lZGlhRWxlbWVudC5jdXJyZW50VGltZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChzZWNvbmRzKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fbWVkaWFFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fbWVkaWFFbGVtZW50LmN1cnJlbnRUaW1lID0gc2Vjb25kcztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcGVuZGluZ1NlZWtUaW1lID0gc2Vjb25kcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbWVkaWFJbmZvJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICB2YXIgbWVkaWFQcmVmaXggPSB0aGlzLl9tZWRpYUVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MQXVkaW9FbGVtZW50ID8gJ2F1ZGlvLycgOiAndmlkZW8vJztcbiAgICAgICAgICAgIHZhciBpbmZvID0ge1xuICAgICAgICAgICAgICAgIG1pbWVUeXBlOiBtZWRpYVByZWZpeCArIHRoaXMuX21lZGlhRGF0YVNvdXJjZS50eXBlXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGluZm8uZHVyYXRpb24gPSBNYXRoLmZsb29yKHRoaXMuX21lZGlhRWxlbWVudC5kdXJhdGlvbiAqIDEwMDApO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9tZWRpYUVsZW1lbnQgaW5zdGFuY2VvZiBIVE1MVmlkZW9FbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGluZm8ud2lkdGggPSB0aGlzLl9tZWRpYUVsZW1lbnQudmlkZW9XaWR0aDtcbiAgICAgICAgICAgICAgICAgICAgaW5mby5oZWlnaHQgPSB0aGlzLl9tZWRpYUVsZW1lbnQudmlkZW9IZWlnaHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGluZm87XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3N0YXRpc3RpY3NJbmZvJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICB2YXIgaW5mbyA9IHtcbiAgICAgICAgICAgICAgICBwbGF5ZXJUeXBlOiB0aGlzLl90eXBlLFxuICAgICAgICAgICAgICAgIHVybDogdGhpcy5fbWVkaWFEYXRhU291cmNlLnVybFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKCEodGhpcy5fbWVkaWFFbGVtZW50IGluc3RhbmNlb2YgSFRNTFZpZGVvRWxlbWVudCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5mbztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGhhc1F1YWxpdHlJbmZvID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBkZWNvZGVkID0gMDtcbiAgICAgICAgICAgIHZhciBkcm9wcGVkID0gMDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX21lZGlhRWxlbWVudC5nZXRWaWRlb1BsYXliYWNrUXVhbGl0eSkge1xuICAgICAgICAgICAgICAgIHZhciBxdWFsaXR5ID0gdGhpcy5fbWVkaWFFbGVtZW50LmdldFZpZGVvUGxheWJhY2tRdWFsaXR5KCk7XG4gICAgICAgICAgICAgICAgZGVjb2RlZCA9IHF1YWxpdHkudG90YWxWaWRlb0ZyYW1lcztcbiAgICAgICAgICAgICAgICBkcm9wcGVkID0gcXVhbGl0eS5kcm9wcGVkVmlkZW9GcmFtZXM7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX21lZGlhRWxlbWVudC53ZWJraXREZWNvZGVkRnJhbWVDb3VudCAhPSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICBkZWNvZGVkID0gdGhpcy5fbWVkaWFFbGVtZW50LndlYmtpdERlY29kZWRGcmFtZUNvdW50O1xuICAgICAgICAgICAgICAgIGRyb3BwZWQgPSB0aGlzLl9tZWRpYUVsZW1lbnQud2Via2l0RHJvcHBlZEZyYW1lQ291bnQ7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGhhc1F1YWxpdHlJbmZvID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChoYXNRdWFsaXR5SW5mbykge1xuICAgICAgICAgICAgICAgIGluZm8uZGVjb2RlZEZyYW1lcyA9IGRlY29kZWQ7XG4gICAgICAgICAgICAgICAgaW5mby5kcm9wcGVkRnJhbWVzID0gZHJvcHBlZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGluZm87XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gTmF0aXZlUGxheWVyO1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBOYXRpdmVQbGF5ZXI7XG5cbn0se1wiLi4vY29uZmlnLmpzXCI6NSxcIi4uL3V0aWxzL2V4Y2VwdGlvbi5qc1wiOjQwLFwiLi9wbGF5ZXItZXZlbnRzLmpzXCI6MzUsXCJldmVudHNcIjoyfV0sMzQ6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLkVycm9yRGV0YWlscyA9IGV4cG9ydHMuRXJyb3JUeXBlcyA9IHVuZGVmaW5lZDtcblxudmFyIF9sb2FkZXIgPSBfZGVyZXFfKCcuLi9pby9sb2FkZXIuanMnKTtcblxudmFyIF9kZW11eEVycm9ycyA9IF9kZXJlcV8oJy4uL2RlbXV4L2RlbXV4LWVycm9ycy5qcycpO1xuXG52YXIgX2RlbXV4RXJyb3JzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2RlbXV4RXJyb3JzKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxudmFyIEVycm9yVHlwZXMgPSBleHBvcnRzLkVycm9yVHlwZXMgPSB7XG4gICAgTkVUV09SS19FUlJPUjogJ05ldHdvcmtFcnJvcicsXG4gICAgTUVESUFfRVJST1I6ICdNZWRpYUVycm9yJyxcbiAgICBPVEhFUl9FUlJPUjogJ090aGVyRXJyb3InXG59O1xuXG52YXIgRXJyb3JEZXRhaWxzID0gZXhwb3J0cy5FcnJvckRldGFpbHMgPSB7XG4gICAgTkVUV09SS19FWENFUFRJT046IF9sb2FkZXIuTG9hZGVyRXJyb3JzLkVYQ0VQVElPTixcbiAgICBORVRXT1JLX1NUQVRVU19DT0RFX0lOVkFMSUQ6IF9sb2FkZXIuTG9hZGVyRXJyb3JzLkhUVFBfU1RBVFVTX0NPREVfSU5WQUxJRCxcbiAgICBORVRXT1JLX1RJTUVPVVQ6IF9sb2FkZXIuTG9hZGVyRXJyb3JzLkNPTk5FQ1RJTkdfVElNRU9VVCxcbiAgICBORVRXT1JLX1VOUkVDT1ZFUkFCTEVfRUFSTFlfRU9GOiBfbG9hZGVyLkxvYWRlckVycm9ycy5VTlJFQ09WRVJBQkxFX0VBUkxZX0VPRixcblxuICAgIE1FRElBX01TRV9FUlJPUjogJ01lZGlhTVNFRXJyb3InLFxuXG4gICAgTUVESUFfRk9STUFUX0VSUk9SOiBfZGVtdXhFcnJvcnMyLmRlZmF1bHQuRk9STUFUX0VSUk9SLFxuICAgIE1FRElBX0ZPUk1BVF9VTlNVUFBPUlRFRDogX2RlbXV4RXJyb3JzMi5kZWZhdWx0LkZPUk1BVF9VTlNVUFBPUlRFRCxcbiAgICBNRURJQV9DT0RFQ19VTlNVUFBPUlRFRDogX2RlbXV4RXJyb3JzMi5kZWZhdWx0LkNPREVDX1VOU1VQUE9SVEVEXG59O1xuXG59LHtcIi4uL2RlbXV4L2RlbXV4LWVycm9ycy5qc1wiOjE2LFwiLi4vaW8vbG9hZGVyLmpzXCI6MjR9XSwzNTpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG52YXIgUGxheWVyRXZlbnRzID0ge1xuICBFUlJPUjogJ2Vycm9yJyxcbiAgTE9BRElOR19DT01QTEVURTogJ2xvYWRpbmdfY29tcGxldGUnLFxuICBSRUNPVkVSRURfRUFSTFlfRU9GOiAncmVjb3ZlcmVkX2Vhcmx5X2VvZicsXG4gIE1FRElBX0lORk86ICdtZWRpYV9pbmZvJyxcbiAgTUVUQURBVEFfQVJSSVZFRDogJ21ldGFkYXRhX2Fycml2ZWQnLFxuICBTQ1JJUFREQVRBX0FSUklWRUQ6ICdzY3JpcHRkYXRhX2Fycml2ZWQnLFxuICBTVEFUSVNUSUNTX0lORk86ICdzdGF0aXN0aWNzX2luZm8nXG59O1xuXG5leHBvcnRzLmRlZmF1bHQgPSBQbGF5ZXJFdmVudHM7XG5cbn0se31dLDM2OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG4vKlxyXG4gKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAqXHJcbiAqIFRoaXMgZmlsZSBpcyBtb2RpZmllZCBmcm9tIGRhaWx5bW90aW9uJ3MgaGxzLmpzIGxpYnJhcnkgKGhscy5qcy9zcmMvaGVscGVyL2FhYy5qcylcclxuICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXG5cbnZhciBBQUMgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQUFDKCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQUFDKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoQUFDLCBudWxsLCBbe1xuICAgICAgICBrZXk6ICdnZXRTaWxlbnRGcmFtZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTaWxlbnRGcmFtZShjb2RlYywgY2hhbm5lbENvdW50KSB7XG4gICAgICAgICAgICBpZiAoY29kZWMgPT09ICdtcDRhLjQwLjInKSB7XG4gICAgICAgICAgICAgICAgLy8gaGFuZGxlIExDLUFBQ1xuICAgICAgICAgICAgICAgIGlmIChjaGFubmVsQ291bnQgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KFsweDAwLCAweGM4LCAweDAwLCAweDgwLCAweDIzLCAweDgwXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFubmVsQ291bnQgPT09IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KFsweDIxLCAweDAwLCAweDQ5LCAweDkwLCAweDAyLCAweDE5LCAweDAwLCAweDIzLCAweDgwXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFubmVsQ291bnQgPT09IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KFsweDAwLCAweGM4LCAweDAwLCAweDgwLCAweDIwLCAweDg0LCAweDAxLCAweDI2LCAweDQwLCAweDA4LCAweDY0LCAweDAwLCAweDhlXSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFubmVsQ291bnQgPT09IDQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KFsweDAwLCAweGM4LCAweDAwLCAweDgwLCAweDIwLCAweDg0LCAweDAxLCAweDI2LCAweDQwLCAweDA4LCAweDY0LCAweDAwLCAweDgwLCAweDJjLCAweDgwLCAweDA4LCAweDAyLCAweDM4XSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFubmVsQ291bnQgPT09IDUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KFsweDAwLCAweGM4LCAweDAwLCAweDgwLCAweDIwLCAweDg0LCAweDAxLCAweDI2LCAweDQwLCAweDA4LCAweDY0LCAweDAwLCAweDgyLCAweDMwLCAweDA0LCAweDk5LCAweDAwLCAweDIxLCAweDkwLCAweDAyLCAweDM4XSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjaGFubmVsQ291bnQgPT09IDYpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KFsweDAwLCAweGM4LCAweDAwLCAweDgwLCAweDIwLCAweDg0LCAweDAxLCAweDI2LCAweDQwLCAweDA4LCAweDY0LCAweDAwLCAweDgyLCAweDMwLCAweDA0LCAweDk5LCAweDAwLCAweDIxLCAweDkwLCAweDAyLCAweDAwLCAweGIyLCAweDAwLCAweDIwLCAweDA4LCAweGUwXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBoYW5kbGUgSEUtQUFDIChtcDRhLjQwLjUgLyBtcDRhLjQwLjI5KVxuICAgICAgICAgICAgICAgIGlmIChjaGFubmVsQ291bnQgPT09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZmZtcGVnIC15IC1mIGxhdmZpIC1pIFwiYWV2YWxzcmM9MDpkPTAuMDVcIiAtYzphIGxpYmZka19hYWMgLXByb2ZpbGU6YSBhYWNfaGUgLWI6YSA0ayBvdXRwdXQuYWFjICYmIGhleGR1bXAgLXYgLWUgJzE2LzEgXCIweCV4LFwiIFwiXFxuXCInIC12IG91dHB1dC5hYWNcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KFsweDEsIDB4NDAsIDB4MjIsIDB4ODAsIDB4YTMsIDB4NGUsIDB4ZTYsIDB4ODAsIDB4YmEsIDB4OCwgMHgwLCAweDAsIDB4MCwgMHgxYywgMHg2LCAweGYxLCAweGMxLCAweGEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWVdKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNoYW5uZWxDb3VudCA9PT0gMikge1xuICAgICAgICAgICAgICAgICAgICAvLyBmZm1wZWcgLXkgLWYgbGF2ZmkgLWkgXCJhZXZhbHNyYz0wfDA6ZD0wLjA1XCIgLWM6YSBsaWJmZGtfYWFjIC1wcm9maWxlOmEgYWFjX2hlX3YyIC1iOmEgNGsgb3V0cHV0LmFhYyAmJiBoZXhkdW1wIC12IC1lICcxNi8xIFwiMHgleCxcIiBcIlxcblwiJyAtdiBvdXRwdXQuYWFjXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheShbMHgxLCAweDQwLCAweDIyLCAweDgwLCAweGEzLCAweDVlLCAweGU2LCAweDgwLCAweGJhLCAweDgsIDB4MCwgMHgwLCAweDAsIDB4MCwgMHg5NSwgMHgwLCAweDYsIDB4ZjEsIDB4YTEsIDB4YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1YSwgMHg1ZV0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hhbm5lbENvdW50ID09PSAzKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGZmbXBlZyAteSAtZiBsYXZmaSAtaSBcImFldmFsc3JjPTB8MHwwOmQ9MC4wNVwiIC1jOmEgbGliZmRrX2FhYyAtcHJvZmlsZTphIGFhY19oZV92MiAtYjphIDRrIG91dHB1dC5hYWMgJiYgaGV4ZHVtcCAtdiAtZSAnMTYvMSBcIjB4JXgsXCIgXCJcXG5cIicgLXYgb3V0cHV0LmFhY1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoWzB4MSwgMHg0MCwgMHgyMiwgMHg4MCwgMHhhMywgMHg1ZSwgMHhlNiwgMHg4MCwgMHhiYSwgMHg4LCAweDAsIDB4MCwgMHgwLCAweDAsIDB4OTUsIDB4MCwgMHg2LCAweGYxLCAweGExLCAweGEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWEsIDB4NWVdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBBQUM7XG59KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEFBQztcblxufSx7fV0sMzc6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbi8qXHJcbiAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICpcclxuICogVGhpcyBmaWxlIGlzIGRlcml2ZWQgZnJvbSBkYWlseW1vdGlvbidzIGhscy5qcyBsaWJyYXJ5IChobHMuanMvc3JjL3JlbXV4L21wNC1nZW5lcmF0b3IuanMpXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG4vLyAgTVA0IGJveGVzIGdlbmVyYXRvciBmb3IgSVNPIEJNRkYgKElTTyBCYXNlIE1lZGlhIEZpbGUgRm9ybWF0LCBkZWZpbmVkIGluIElTTy9JRUMgMTQ0OTYtMTIpXG52YXIgTVA0ID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIE1QNCgpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1QNCk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKE1QNCwgbnVsbCwgW3tcbiAgICAgICAga2V5OiAnaW5pdCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KCkge1xuICAgICAgICAgICAgTVA0LnR5cGVzID0ge1xuICAgICAgICAgICAgICAgIGF2YzE6IFtdLCBhdmNDOiBbXSwgYnRydDogW10sIGRpbmY6IFtdLFxuICAgICAgICAgICAgICAgIGRyZWY6IFtdLCBlc2RzOiBbXSwgZnR5cDogW10sIGhkbHI6IFtdLFxuICAgICAgICAgICAgICAgIG1kYXQ6IFtdLCBtZGhkOiBbXSwgbWRpYTogW10sIG1maGQ6IFtdLFxuICAgICAgICAgICAgICAgIG1pbmY6IFtdLCBtb29mOiBbXSwgbW9vdjogW10sIG1wNGE6IFtdLFxuICAgICAgICAgICAgICAgIG12ZXg6IFtdLCBtdmhkOiBbXSwgc2R0cDogW10sIHN0Ymw6IFtdLFxuICAgICAgICAgICAgICAgIHN0Y286IFtdLCBzdHNjOiBbXSwgc3RzZDogW10sIHN0c3o6IFtdLFxuICAgICAgICAgICAgICAgIHN0dHM6IFtdLCB0ZmR0OiBbXSwgdGZoZDogW10sIHRyYWY6IFtdLFxuICAgICAgICAgICAgICAgIHRyYWs6IFtdLCB0cnVuOiBbXSwgdHJleDogW10sIHRraGQ6IFtdLFxuICAgICAgICAgICAgICAgIHZtaGQ6IFtdLCBzbWhkOiBbXSwgJy5tcDMnOiBbXVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBNUDQudHlwZXMpIHtcbiAgICAgICAgICAgICAgICBpZiAoTVA0LnR5cGVzLmhhc093blByb3BlcnR5KG5hbWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIE1QNC50eXBlc1tuYW1lXSA9IFtuYW1lLmNoYXJDb2RlQXQoMCksIG5hbWUuY2hhckNvZGVBdCgxKSwgbmFtZS5jaGFyQ29kZUF0KDIpLCBuYW1lLmNoYXJDb2RlQXQoMyldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGNvbnN0YW50cyA9IE1QNC5jb25zdGFudHMgPSB7fTtcblxuICAgICAgICAgICAgY29uc3RhbnRzLkZUWVAgPSBuZXcgVWludDhBcnJheShbMHg2OSwgMHg3MywgMHg2RiwgMHg2RCwgLy8gbWFqb3JfYnJhbmQ6IGlzb21cbiAgICAgICAgICAgIDB4MCwgMHgwLCAweDAsIDB4MSwgLy8gbWlub3JfdmVyc2lvbjogMHgwMVxuICAgICAgICAgICAgMHg2OSwgMHg3MywgMHg2RiwgMHg2RCwgLy8gaXNvbVxuICAgICAgICAgICAgMHg2MSwgMHg3NiwgMHg2MywgMHgzMSAvLyBhdmMxXG4gICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgY29uc3RhbnRzLlNUU0RfUFJFRklYID0gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHZlcnNpb24oMCkgKyBmbGFnc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMSAvLyBlbnRyeV9jb3VudFxuICAgICAgICAgICAgXSk7XG5cbiAgICAgICAgICAgIGNvbnN0YW50cy5TVFRTID0gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHZlcnNpb24oMCkgKyBmbGFnc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCAvLyBlbnRyeV9jb3VudFxuICAgICAgICAgICAgXSk7XG5cbiAgICAgICAgICAgIGNvbnN0YW50cy5TVFNDID0gY29uc3RhbnRzLlNUQ08gPSBjb25zdGFudHMuU1RUUztcblxuICAgICAgICAgICAgY29uc3RhbnRzLlNUU1ogPSBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gdmVyc2lvbigwKSArIGZsYWdzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBzYW1wbGVfc2l6ZVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCAvLyBzYW1wbGVfY291bnRcbiAgICAgICAgICAgIF0pO1xuXG4gICAgICAgICAgICBjb25zdGFudHMuSERMUl9WSURFTyA9IG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyB2ZXJzaW9uKDApICsgZmxhZ3NcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHByZV9kZWZpbmVkXG4gICAgICAgICAgICAweDc2LCAweDY5LCAweDY0LCAweDY1LCAvLyBoYW5kbGVyX3R5cGU6ICd2aWRlJ1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcmVzZXJ2ZWQ6IDMgKiA0IGJ5dGVzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDU2LCAweDY5LCAweDY0LCAweDY1LCAweDZGLCAweDQ4LCAweDYxLCAweDZFLCAweDY0LCAweDZDLCAweDY1LCAweDcyLCAweDAwIC8vIG5hbWU6IFZpZGVvSGFuZGxlclxuICAgICAgICAgICAgXSk7XG5cbiAgICAgICAgICAgIGNvbnN0YW50cy5IRExSX0FVRElPID0gbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHZlcnNpb24oMCkgKyBmbGFnc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcHJlX2RlZmluZWRcbiAgICAgICAgICAgIDB4NzMsIDB4NkYsIDB4NzUsIDB4NkUsIC8vIGhhbmRsZXJfdHlwZTogJ3NvdW4nXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyByZXNlcnZlZDogMyAqIDQgYnl0ZXNcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4NTMsIDB4NkYsIDB4NzUsIDB4NkUsIDB4NjQsIDB4NDgsIDB4NjEsIDB4NkUsIDB4NjQsIDB4NkMsIDB4NjUsIDB4NzIsIDB4MDAgLy8gbmFtZTogU291bmRIYW5kbGVyXG4gICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgY29uc3RhbnRzLkRSRUYgPSBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gdmVyc2lvbigwKSArIGZsYWdzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAxLCAvLyBlbnRyeV9jb3VudFxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwQywgLy8gZW50cnlfc2l6ZVxuICAgICAgICAgICAgMHg3NSwgMHg3MiwgMHg2QywgMHgyMCwgLy8gdHlwZSAndXJsICdcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDEgLy8gdmVyc2lvbigwKSArIGZsYWdzXG4gICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgLy8gU291bmQgbWVkaWEgaGVhZGVyXG4gICAgICAgICAgICBjb25zdGFudHMuU01IRCA9IG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyB2ZXJzaW9uKDApICsgZmxhZ3NcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAgLy8gYmFsYW5jZSgyKSArIHJlc2VydmVkKDIpXG4gICAgICAgICAgICBdKTtcblxuICAgICAgICAgICAgLy8gdmlkZW8gbWVkaWEgaGVhZGVyXG4gICAgICAgICAgICBjb25zdGFudHMuVk1IRCA9IG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAxLCAvLyB2ZXJzaW9uKDApICsgZmxhZ3NcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIC8vIGdyYXBoaWNzbW9kZTogMiBieXRlc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gb3Bjb2xvcjogMyAqIDIgYnl0ZXNcbiAgICAgICAgICAgIDB4MDAsIDB4MDBdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEdlbmVyYXRlIGEgYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2JveCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBib3godHlwZSkge1xuICAgICAgICAgICAgdmFyIHNpemUgPSA4O1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG51bGw7XG4gICAgICAgICAgICB2YXIgZGF0YXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuICAgICAgICAgICAgdmFyIGFycmF5Q291bnQgPSBkYXRhcy5sZW5ndGg7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyYXlDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc2l6ZSArPSBkYXRhc1tpXS5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXN1bHQgPSBuZXcgVWludDhBcnJheShzaXplKTtcbiAgICAgICAgICAgIHJlc3VsdFswXSA9IHNpemUgPj4+IDI0ICYgMHhGRjsgLy8gc2l6ZVxuICAgICAgICAgICAgcmVzdWx0WzFdID0gc2l6ZSA+Pj4gMTYgJiAweEZGO1xuICAgICAgICAgICAgcmVzdWx0WzJdID0gc2l6ZSA+Pj4gOCAmIDB4RkY7XG4gICAgICAgICAgICByZXN1bHRbM10gPSBzaXplICYgMHhGRjtcblxuICAgICAgICAgICAgcmVzdWx0LnNldCh0eXBlLCA0KTsgLy8gdHlwZVxuXG4gICAgICAgICAgICB2YXIgb2Zmc2V0ID0gODtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcnJheUNvdW50OyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgLy8gZGF0YSBib2R5XG4gICAgICAgICAgICAgICAgcmVzdWx0LnNldChkYXRhc1tfaV0sIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgb2Zmc2V0ICs9IGRhdGFzW19pXS5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZW1pdCBmdHlwICYgbW9vdlxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdnZW5lcmF0ZUluaXRTZWdtZW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdlbmVyYXRlSW5pdFNlZ21lbnQobWV0YSkge1xuICAgICAgICAgICAgdmFyIGZ0eXAgPSBNUDQuYm94KE1QNC50eXBlcy5mdHlwLCBNUDQuY29uc3RhbnRzLkZUWVApO1xuICAgICAgICAgICAgdmFyIG1vb3YgPSBNUDQubW9vdihtZXRhKTtcblxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBVaW50OEFycmF5KGZ0eXAuYnl0ZUxlbmd0aCArIG1vb3YuYnl0ZUxlbmd0aCk7XG4gICAgICAgICAgICByZXN1bHQuc2V0KGZ0eXAsIDApO1xuICAgICAgICAgICAgcmVzdWx0LnNldChtb292LCBmdHlwLmJ5dGVMZW5ndGgpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1vdmllIG1ldGFkYXRhIGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdtb292JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vb3YobWV0YSkge1xuICAgICAgICAgICAgdmFyIG12aGQgPSBNUDQubXZoZChtZXRhLnRpbWVzY2FsZSwgbWV0YS5kdXJhdGlvbik7XG4gICAgICAgICAgICB2YXIgdHJhayA9IE1QNC50cmFrKG1ldGEpO1xuICAgICAgICAgICAgdmFyIG12ZXggPSBNUDQubXZleChtZXRhKTtcbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5tb292LCBtdmhkLCB0cmFrLCBtdmV4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1vdmllIGhlYWRlciBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbXZoZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtdmhkKHRpbWVzY2FsZSwgZHVyYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5tdmhkLCBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gdmVyc2lvbigwKSArIGZsYWdzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBjcmVhdGlvbl90aW1lXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBtb2RpZmljYXRpb25fdGltZVxuICAgICAgICAgICAgdGltZXNjYWxlID4+PiAyNCAmIDB4RkYsIC8vIHRpbWVzY2FsZTogNCBieXRlc1xuICAgICAgICAgICAgdGltZXNjYWxlID4+PiAxNiAmIDB4RkYsIHRpbWVzY2FsZSA+Pj4gOCAmIDB4RkYsIHRpbWVzY2FsZSAmIDB4RkYsIGR1cmF0aW9uID4+PiAyNCAmIDB4RkYsIC8vIGR1cmF0aW9uOiA0IGJ5dGVzXG4gICAgICAgICAgICBkdXJhdGlvbiA+Pj4gMTYgJiAweEZGLCBkdXJhdGlvbiA+Pj4gOCAmIDB4RkYsIGR1cmF0aW9uICYgMHhGRiwgMHgwMCwgMHgwMSwgMHgwMCwgMHgwMCwgLy8gUHJlZmVycmVkIHJhdGU6IDEuMFxuICAgICAgICAgICAgMHgwMSwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gUHJlZmVycmVkVm9sdW1lKDEuMCwgMmJ5dGVzKSArIHJlc2VydmVkKDJieXRlcylcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHJlc2VydmVkOiA0ICsgNCBieXRlc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMSwgMHgwMCwgMHgwMCwgLy8gLS0tLWJlZ2luIGNvbXBvc2l0aW9uIG1hdHJpeC0tLS1cbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDEsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIDB4NDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIC0tLS1lbmQgY29tcG9zaXRpb24gbWF0cml4LS0tLVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gLS0tLWJlZ2luIHByZV9kZWZpbmVkIDYgKiA0IGJ5dGVzLS0tLVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gLS0tLWVuZCBwcmVfZGVmaW5lZCA2ICogNCBieXRlcy0tLS1cbiAgICAgICAgICAgIDB4RkYsIDB4RkYsIDB4RkYsIDB4RkYgLy8gbmV4dF90cmFja19JRFxuICAgICAgICAgICAgXSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVHJhY2sgYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3RyYWsnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdHJhayhtZXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMudHJhaywgTVA0LnRraGQobWV0YSksIE1QNC5tZGlhKG1ldGEpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRyYWNrIGhlYWRlciBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndGtoZCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB0a2hkKG1ldGEpIHtcbiAgICAgICAgICAgIHZhciB0cmFja0lkID0gbWV0YS5pZCxcbiAgICAgICAgICAgICAgICBkdXJhdGlvbiA9IG1ldGEuZHVyYXRpb247XG4gICAgICAgICAgICB2YXIgd2lkdGggPSBtZXRhLnByZXNlbnRXaWR0aCxcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBtZXRhLnByZXNlbnRIZWlnaHQ7XG5cbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy50a2hkLCBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwNywgLy8gdmVyc2lvbigwKSArIGZsYWdzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBjcmVhdGlvbl90aW1lXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBtb2RpZmljYXRpb25fdGltZVxuICAgICAgICAgICAgdHJhY2tJZCA+Pj4gMjQgJiAweEZGLCAvLyB0cmFja19JRDogNCBieXRlc1xuICAgICAgICAgICAgdHJhY2tJZCA+Pj4gMTYgJiAweEZGLCB0cmFja0lkID4+PiA4ICYgMHhGRiwgdHJhY2tJZCAmIDB4RkYsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHJlc2VydmVkOiA0IGJ5dGVzXG4gICAgICAgICAgICBkdXJhdGlvbiA+Pj4gMjQgJiAweEZGLCAvLyBkdXJhdGlvbjogNCBieXRlc1xuICAgICAgICAgICAgZHVyYXRpb24gPj4+IDE2ICYgMHhGRiwgZHVyYXRpb24gPj4+IDggJiAweEZGLCBkdXJhdGlvbiAmIDB4RkYsIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHJlc2VydmVkOiAyICogNCBieXRlc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gbGF5ZXIoMmJ5dGVzKSArIGFsdGVybmF0ZV9ncm91cCgyYnl0ZXMpXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyB2b2x1bWUoMmJ5dGVzKSArIHJlc2VydmVkKDJieXRlcylcbiAgICAgICAgICAgIDB4MDAsIDB4MDEsIDB4MDAsIDB4MDAsIC8vIC0tLS1iZWdpbiBjb21wb3NpdGlvbiBtYXRyaXgtLS0tXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAxLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDQwLCAweDAwLCAweDAwLCAweDAwLCAvLyAtLS0tZW5kIGNvbXBvc2l0aW9uIG1hdHJpeC0tLS1cbiAgICAgICAgICAgIHdpZHRoID4+PiA4ICYgMHhGRiwgLy8gd2lkdGggYW5kIGhlaWdodFxuICAgICAgICAgICAgd2lkdGggJiAweEZGLCAweDAwLCAweDAwLCBoZWlnaHQgPj4+IDggJiAweEZGLCBoZWlnaHQgJiAweEZGLCAweDAwLCAweDAwXSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTWVkaWEgQm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ21kaWEnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbWRpYShtZXRhKSB7XG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMubWRpYSwgTVA0Lm1kaGQobWV0YSksIE1QNC5oZGxyKG1ldGEpLCBNUDQubWluZihtZXRhKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBNZWRpYSBoZWFkZXIgYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ21kaGQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbWRoZChtZXRhKSB7XG4gICAgICAgICAgICB2YXIgdGltZXNjYWxlID0gbWV0YS50aW1lc2NhbGU7XG4gICAgICAgICAgICB2YXIgZHVyYXRpb24gPSBtZXRhLmR1cmF0aW9uO1xuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLm1kaGQsIG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyB2ZXJzaW9uKDApICsgZmxhZ3NcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIGNyZWF0aW9uX3RpbWVcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIG1vZGlmaWNhdGlvbl90aW1lXG4gICAgICAgICAgICB0aW1lc2NhbGUgPj4+IDI0ICYgMHhGRiwgLy8gdGltZXNjYWxlOiA0IGJ5dGVzXG4gICAgICAgICAgICB0aW1lc2NhbGUgPj4+IDE2ICYgMHhGRiwgdGltZXNjYWxlID4+PiA4ICYgMHhGRiwgdGltZXNjYWxlICYgMHhGRiwgZHVyYXRpb24gPj4+IDI0ICYgMHhGRiwgLy8gZHVyYXRpb246IDQgYnl0ZXNcbiAgICAgICAgICAgIGR1cmF0aW9uID4+PiAxNiAmIDB4RkYsIGR1cmF0aW9uID4+PiA4ICYgMHhGRiwgZHVyYXRpb24gJiAweEZGLCAweDU1LCAweEM0LCAvLyBsYW5ndWFnZTogdW5kICh1bmRldGVybWluZWQpXG4gICAgICAgICAgICAweDAwLCAweDAwIC8vIHByZV9kZWZpbmVkID0gMFxuICAgICAgICAgICAgXSkpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTWVkaWEgaGFuZGxlciByZWZlcmVuY2UgYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2hkbHInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaGRscihtZXRhKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IG51bGw7XG4gICAgICAgICAgICBpZiAobWV0YS50eXBlID09PSAnYXVkaW8nKSB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IE1QNC5jb25zdGFudHMuSERMUl9BVURJTztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZGF0YSA9IE1QNC5jb25zdGFudHMuSERMUl9WSURFTztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5oZGxyLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1lZGlhIGluZm9tYXRpb24gYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ21pbmYnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbWluZihtZXRhKSB7XG4gICAgICAgICAgICB2YXIgeG1oZCA9IG51bGw7XG4gICAgICAgICAgICBpZiAobWV0YS50eXBlID09PSAnYXVkaW8nKSB7XG4gICAgICAgICAgICAgICAgeG1oZCA9IE1QNC5ib3goTVA0LnR5cGVzLnNtaGQsIE1QNC5jb25zdGFudHMuU01IRCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHhtaGQgPSBNUDQuYm94KE1QNC50eXBlcy52bWhkLCBNUDQuY29uc3RhbnRzLlZNSEQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLm1pbmYsIHhtaGQsIE1QNC5kaW5mKCksIE1QNC5zdGJsKG1ldGEpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERhdGEgaW5mb21hdGlvbiBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZGluZicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkaW5mKCkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IE1QNC5ib3goTVA0LnR5cGVzLmRpbmYsIE1QNC5ib3goTVA0LnR5cGVzLmRyZWYsIE1QNC5jb25zdGFudHMuRFJFRikpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNhbXBsZSB0YWJsZSBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc3RibCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzdGJsKG1ldGEpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBNUDQuYm94KE1QNC50eXBlcy5zdGJsLCAvLyB0eXBlOiBzdGJsXG4gICAgICAgICAgICBNUDQuc3RzZChtZXRhKSwgLy8gU2FtcGxlIERlc2NyaXB0aW9uIFRhYmxlXG4gICAgICAgICAgICBNUDQuYm94KE1QNC50eXBlcy5zdHRzLCBNUDQuY29uc3RhbnRzLlNUVFMpLCAvLyBUaW1lLVRvLVNhbXBsZVxuICAgICAgICAgICAgTVA0LmJveChNUDQudHlwZXMuc3RzYywgTVA0LmNvbnN0YW50cy5TVFNDKSwgLy8gU2FtcGxlLVRvLUNodW5rXG4gICAgICAgICAgICBNUDQuYm94KE1QNC50eXBlcy5zdHN6LCBNUDQuY29uc3RhbnRzLlNUU1opLCAvLyBTYW1wbGUgc2l6ZVxuICAgICAgICAgICAgTVA0LmJveChNUDQudHlwZXMuc3RjbywgTVA0LmNvbnN0YW50cy5TVENPIC8vIENodW5rIG9mZnNldFxuICAgICAgICAgICAgKSk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2FtcGxlIGRlc2NyaXB0aW9uIGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdzdHNkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHN0c2QobWV0YSkge1xuICAgICAgICAgICAgaWYgKG1ldGEudHlwZSA9PT0gJ2F1ZGlvJykge1xuICAgICAgICAgICAgICAgIGlmIChtZXRhLmNvZGVjID09PSAnbXAzJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMuc3RzZCwgTVA0LmNvbnN0YW50cy5TVFNEX1BSRUZJWCwgTVA0Lm1wMyhtZXRhKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIGVsc2U6IGFhYyAtPiBtcDRhXG4gICAgICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLnN0c2QsIE1QNC5jb25zdGFudHMuU1RTRF9QUkVGSVgsIE1QNC5tcDRhKG1ldGEpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLnN0c2QsIE1QNC5jb25zdGFudHMuU1RTRF9QUkVGSVgsIE1QNC5hdmMxKG1ldGEpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbXAzJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1wMyhtZXRhKSB7XG4gICAgICAgICAgICB2YXIgY2hhbm5lbENvdW50ID0gbWV0YS5jaGFubmVsQ291bnQ7XG4gICAgICAgICAgICB2YXIgc2FtcGxlUmF0ZSA9IG1ldGEuYXVkaW9TYW1wbGVSYXRlO1xuXG4gICAgICAgICAgICB2YXIgZGF0YSA9IG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyByZXNlcnZlZCg0KVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMSwgLy8gcmVzZXJ2ZWQoMikgKyBkYXRhX3JlZmVyZW5jZV9pbmRleCgyKVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcmVzZXJ2ZWQ6IDIgKiA0IGJ5dGVzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCBjaGFubmVsQ291bnQsIC8vIGNoYW5uZWxDb3VudCgyKVxuICAgICAgICAgICAgMHgwMCwgMHgxMCwgLy8gc2FtcGxlU2l6ZSgyKVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcmVzZXJ2ZWQoNClcbiAgICAgICAgICAgIHNhbXBsZVJhdGUgPj4+IDggJiAweEZGLCAvLyBBdWRpbyBzYW1wbGUgcmF0ZVxuICAgICAgICAgICAgc2FtcGxlUmF0ZSAmIDB4RkYsIDB4MDAsIDB4MDBdKTtcblxuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzWycubXAzJ10sIGRhdGEpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdtcDRhJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1wNGEobWV0YSkge1xuICAgICAgICAgICAgdmFyIGNoYW5uZWxDb3VudCA9IG1ldGEuY2hhbm5lbENvdW50O1xuICAgICAgICAgICAgdmFyIHNhbXBsZVJhdGUgPSBtZXRhLmF1ZGlvU2FtcGxlUmF0ZTtcblxuICAgICAgICAgICAgdmFyIGRhdGEgPSBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcmVzZXJ2ZWQoNClcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDEsIC8vIHJlc2VydmVkKDIpICsgZGF0YV9yZWZlcmVuY2VfaW5kZXgoMilcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHJlc2VydmVkOiAyICogNCBieXRlc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgY2hhbm5lbENvdW50LCAvLyBjaGFubmVsQ291bnQoMilcbiAgICAgICAgICAgIDB4MDAsIDB4MTAsIC8vIHNhbXBsZVNpemUoMilcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHJlc2VydmVkKDQpXG4gICAgICAgICAgICBzYW1wbGVSYXRlID4+PiA4ICYgMHhGRiwgLy8gQXVkaW8gc2FtcGxlIHJhdGVcbiAgICAgICAgICAgIHNhbXBsZVJhdGUgJiAweEZGLCAweDAwLCAweDAwXSk7XG5cbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5tcDRhLCBkYXRhLCBNUDQuZXNkcyhtZXRhKSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2VzZHMnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gZXNkcyhtZXRhKSB7XG4gICAgICAgICAgICB2YXIgY29uZmlnID0gbWV0YS5jb25maWcgfHwgW107XG4gICAgICAgICAgICB2YXIgY29uZmlnU2l6ZSA9IGNvbmZpZy5sZW5ndGg7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyB2ZXJzaW9uIDAgKyBmbGFnc1xuXG4gICAgICAgICAgICAweDAzLCAvLyBkZXNjcmlwdG9yX3R5cGVcbiAgICAgICAgICAgIDB4MTcgKyBjb25maWdTaXplLCAvLyBsZW5ndGgzXG4gICAgICAgICAgICAweDAwLCAweDAxLCAvLyBlc19pZFxuICAgICAgICAgICAgMHgwMCwgLy8gc3RyZWFtX3ByaW9yaXR5XG5cbiAgICAgICAgICAgIDB4MDQsIC8vIGRlc2NyaXB0b3JfdHlwZVxuICAgICAgICAgICAgMHgwRiArIGNvbmZpZ1NpemUsIC8vIGxlbmd0aFxuICAgICAgICAgICAgMHg0MCwgLy8gY29kZWM6IG1wZWc0X2F1ZGlvXG4gICAgICAgICAgICAweDE1LCAvLyBzdHJlYW1fdHlwZTogQXVkaW9cbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIC8vIGJ1ZmZlcl9zaXplXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBtYXhCaXRyYXRlXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBhdmdCaXRyYXRlXG5cbiAgICAgICAgICAgIDB4MDUgLy8gZGVzY3JpcHRvcl90eXBlXG4gICAgICAgICAgICBdLmNvbmNhdChbY29uZmlnU2l6ZV0pLmNvbmNhdChjb25maWcpLmNvbmNhdChbMHgwNiwgMHgwMSwgMHgwMiAvLyBHQVNwZWNpZmljQ29uZmlnXG4gICAgICAgICAgICBdKSk7XG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMuZXNkcywgZGF0YSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2F2YzEnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXZjMShtZXRhKSB7XG4gICAgICAgICAgICB2YXIgYXZjYyA9IG1ldGEuYXZjYztcbiAgICAgICAgICAgIHZhciB3aWR0aCA9IG1ldGEuY29kZWNXaWR0aCxcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBtZXRhLmNvZGVjSGVpZ2h0O1xuXG4gICAgICAgICAgICB2YXIgZGF0YSA9IG5ldyBVaW50OEFycmF5KFsweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyByZXNlcnZlZCg0KVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMSwgLy8gcmVzZXJ2ZWQoMikgKyBkYXRhX3JlZmVyZW5jZV9pbmRleCgyKVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcHJlX2RlZmluZWQoMikgKyByZXNlcnZlZCgyKVxuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcHJlX2RlZmluZWQ6IDMgKiA0IGJ5dGVzXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCAweDAwLCB3aWR0aCA+Pj4gOCAmIDB4RkYsIC8vIHdpZHRoOiAyIGJ5dGVzXG4gICAgICAgICAgICB3aWR0aCAmIDB4RkYsIGhlaWdodCA+Pj4gOCAmIDB4RkYsIC8vIGhlaWdodDogMiBieXRlc1xuICAgICAgICAgICAgaGVpZ2h0ICYgMHhGRiwgMHgwMCwgMHg0OCwgMHgwMCwgMHgwMCwgLy8gaG9yaXpyZXNvbHV0aW9uOiA0IGJ5dGVzXG4gICAgICAgICAgICAweDAwLCAweDQ4LCAweDAwLCAweDAwLCAvLyB2ZXJ0cmVzb2x1dGlvbjogNCBieXRlc1xuICAgICAgICAgICAgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gcmVzZXJ2ZWQ6IDQgYnl0ZXNcbiAgICAgICAgICAgIDB4MDAsIDB4MDEsIC8vIGZyYW1lX2NvdW50XG4gICAgICAgICAgICAweDBBLCAvLyBzdHJsZW5cbiAgICAgICAgICAgIDB4NzgsIDB4NzEsIDB4NzEsIDB4MkYsIC8vIGNvbXByZXNzb3JuYW1lOiAzMiBieXRlc1xuICAgICAgICAgICAgMHg2NiwgMHg2QywgMHg3NiwgMHgyRSwgMHg2QSwgMHg3MywgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgMHgxOCwgLy8gZGVwdGhcbiAgICAgICAgICAgIDB4RkYsIDB4RkYgLy8gcHJlX2RlZmluZWQgPSAtMVxuICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMuYXZjMSwgZGF0YSwgTVA0LmJveChNUDQudHlwZXMuYXZjQywgYXZjYykpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTW92aWUgRXh0ZW5kcyBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbXZleCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtdmV4KG1ldGEpIHtcbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5tdmV4LCBNUDQudHJleChtZXRhKSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUcmFjayBFeHRlbmRzIGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICd0cmV4JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRyZXgobWV0YSkge1xuICAgICAgICAgICAgdmFyIHRyYWNrSWQgPSBtZXRhLmlkO1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gdmVyc2lvbigwKSArIGZsYWdzXG4gICAgICAgICAgICB0cmFja0lkID4+PiAyNCAmIDB4RkYsIC8vIHRyYWNrX0lEXG4gICAgICAgICAgICB0cmFja0lkID4+PiAxNiAmIDB4RkYsIHRyYWNrSWQgPj4+IDggJiAweEZGLCB0cmFja0lkICYgMHhGRiwgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMSwgLy8gZGVmYXVsdF9zYW1wbGVfZGVzY3JpcHRpb25faW5kZXhcbiAgICAgICAgICAgIDB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIGRlZmF1bHRfc2FtcGxlX2R1cmF0aW9uXG4gICAgICAgICAgICAweDAwLCAweDAwLCAweDAwLCAweDAwLCAvLyBkZWZhdWx0X3NhbXBsZV9zaXplXG4gICAgICAgICAgICAweDAwLCAweDAxLCAweDAwLCAweDAxIC8vIGRlZmF1bHRfc2FtcGxlX2ZsYWdzXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy50cmV4LCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1vdmllIGZyYWdtZW50IGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdtb29mJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIG1vb2YodHJhY2ssIGJhc2VNZWRpYURlY29kZVRpbWUpIHtcbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5tb29mLCBNUDQubWZoZCh0cmFjay5zZXF1ZW5jZU51bWJlciksIE1QNC50cmFmKHRyYWNrLCBiYXNlTWVkaWFEZWNvZGVUaW1lKSk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ21maGQnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gbWZoZChzZXF1ZW5jZU51bWJlcikge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgc2VxdWVuY2VOdW1iZXIgPj4+IDI0ICYgMHhGRiwgLy8gc2VxdWVuY2VfbnVtYmVyOiBpbnQzMlxuICAgICAgICAgICAgc2VxdWVuY2VOdW1iZXIgPj4+IDE2ICYgMHhGRiwgc2VxdWVuY2VOdW1iZXIgPj4+IDggJiAweEZGLCBzZXF1ZW5jZU51bWJlciAmIDB4RkZdKTtcbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5tZmhkLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFRyYWNrIGZyYWdtZW50IGJveFxuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICd0cmFmJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHRyYWYodHJhY2ssIGJhc2VNZWRpYURlY29kZVRpbWUpIHtcbiAgICAgICAgICAgIHZhciB0cmFja0lkID0gdHJhY2suaWQ7XG5cbiAgICAgICAgICAgIC8vIFRyYWNrIGZyYWdtZW50IGhlYWRlciBib3hcbiAgICAgICAgICAgIHZhciB0ZmhkID0gTVA0LmJveChNUDQudHlwZXMudGZoZCwgbmV3IFVpbnQ4QXJyYXkoWzB4MDAsIDB4MDAsIDB4MDAsIDB4MDAsIC8vIHZlcnNpb24oMCkgJiBmbGFnc1xuICAgICAgICAgICAgdHJhY2tJZCA+Pj4gMjQgJiAweEZGLCAvLyB0cmFja19JRFxuICAgICAgICAgICAgdHJhY2tJZCA+Pj4gMTYgJiAweEZGLCB0cmFja0lkID4+PiA4ICYgMHhGRiwgdHJhY2tJZCAmIDB4RkZdKSk7XG4gICAgICAgICAgICAvLyBUcmFjayBGcmFnbWVudCBEZWNvZGUgVGltZVxuICAgICAgICAgICAgdmFyIHRmZHQgPSBNUDQuYm94KE1QNC50eXBlcy50ZmR0LCBuZXcgVWludDhBcnJheShbMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCwgLy8gdmVyc2lvbigwKSAmIGZsYWdzXG4gICAgICAgICAgICBiYXNlTWVkaWFEZWNvZGVUaW1lID4+PiAyNCAmIDB4RkYsIC8vIGJhc2VNZWRpYURlY29kZVRpbWU6IGludDMyXG4gICAgICAgICAgICBiYXNlTWVkaWFEZWNvZGVUaW1lID4+PiAxNiAmIDB4RkYsIGJhc2VNZWRpYURlY29kZVRpbWUgPj4+IDggJiAweEZGLCBiYXNlTWVkaWFEZWNvZGVUaW1lICYgMHhGRl0pKTtcbiAgICAgICAgICAgIHZhciBzZHRwID0gTVA0LnNkdHAodHJhY2spO1xuICAgICAgICAgICAgdmFyIHRydW4gPSBNUDQudHJ1bih0cmFjaywgc2R0cC5ieXRlTGVuZ3RoICsgMTYgKyAxNiArIDggKyAxNiArIDggKyA4KTtcblxuICAgICAgICAgICAgcmV0dXJuIE1QNC5ib3goTVA0LnR5cGVzLnRyYWYsIHRmaGQsIHRmZHQsIHRydW4sIHNkdHApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU2FtcGxlIERlcGVuZGVuY3kgVHlwZSBib3hcblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc2R0cCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZHRwKHRyYWNrKSB7XG4gICAgICAgICAgICB2YXIgc2FtcGxlcyA9IHRyYWNrLnNhbXBsZXMgfHwgW107XG4gICAgICAgICAgICB2YXIgc2FtcGxlQ291bnQgPSBzYW1wbGVzLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoNCArIHNhbXBsZUNvdW50KTtcbiAgICAgICAgICAgIC8vIDB+NCBieXRlczogdmVyc2lvbigwKSAmIGZsYWdzXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNhbXBsZUNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZmxhZ3MgPSBzYW1wbGVzW2ldLmZsYWdzO1xuICAgICAgICAgICAgICAgIGRhdGFbaSArIDRdID0gZmxhZ3MuaXNMZWFkaW5nIDw8IDYgfCAvLyBpc19sZWFkaW5nOiAyIChiaXQpXG4gICAgICAgICAgICAgICAgZmxhZ3MuZGVwZW5kc09uIDw8IDQgLy8gc2FtcGxlX2RlcGVuZHNfb25cbiAgICAgICAgICAgICAgICB8IGZsYWdzLmlzRGVwZW5kZWRPbiA8PCAyIC8vIHNhbXBsZV9pc19kZXBlbmRlZF9vblxuICAgICAgICAgICAgICAgIHwgZmxhZ3MuaGFzUmVkdW5kYW5jeTsgLy8gc2FtcGxlX2hhc19yZWR1bmRhbmN5XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gTVA0LmJveChNUDQudHlwZXMuc2R0cCwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUcmFjayBmcmFnbWVudCBydW4gYm94XG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3RydW4nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdHJ1bih0cmFjaywgb2Zmc2V0KSB7XG4gICAgICAgICAgICB2YXIgc2FtcGxlcyA9IHRyYWNrLnNhbXBsZXMgfHwgW107XG4gICAgICAgICAgICB2YXIgc2FtcGxlQ291bnQgPSBzYW1wbGVzLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBkYXRhU2l6ZSA9IDEyICsgMTYgKiBzYW1wbGVDb3VudDtcbiAgICAgICAgICAgIHZhciBkYXRhID0gbmV3IFVpbnQ4QXJyYXkoZGF0YVNpemUpO1xuICAgICAgICAgICAgb2Zmc2V0ICs9IDggKyBkYXRhU2l6ZTtcblxuICAgICAgICAgICAgZGF0YS5zZXQoWzB4MDAsIDB4MDAsIDB4MEYsIDB4MDEsIC8vIHZlcnNpb24oMCkgJiBmbGFnc1xuICAgICAgICAgICAgc2FtcGxlQ291bnQgPj4+IDI0ICYgMHhGRiwgLy8gc2FtcGxlX2NvdW50XG4gICAgICAgICAgICBzYW1wbGVDb3VudCA+Pj4gMTYgJiAweEZGLCBzYW1wbGVDb3VudCA+Pj4gOCAmIDB4RkYsIHNhbXBsZUNvdW50ICYgMHhGRiwgb2Zmc2V0ID4+PiAyNCAmIDB4RkYsIC8vIGRhdGFfb2Zmc2V0XG4gICAgICAgICAgICBvZmZzZXQgPj4+IDE2ICYgMHhGRiwgb2Zmc2V0ID4+PiA4ICYgMHhGRiwgb2Zmc2V0ICYgMHhGRl0sIDApO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNhbXBsZUNvdW50OyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZHVyYXRpb24gPSBzYW1wbGVzW2ldLmR1cmF0aW9uO1xuICAgICAgICAgICAgICAgIHZhciBzaXplID0gc2FtcGxlc1tpXS5zaXplO1xuICAgICAgICAgICAgICAgIHZhciBmbGFncyA9IHNhbXBsZXNbaV0uZmxhZ3M7XG4gICAgICAgICAgICAgICAgdmFyIGN0cyA9IHNhbXBsZXNbaV0uY3RzO1xuICAgICAgICAgICAgICAgIGRhdGEuc2V0KFtkdXJhdGlvbiA+Pj4gMjQgJiAweEZGLCAvLyBzYW1wbGVfZHVyYXRpb25cbiAgICAgICAgICAgICAgICBkdXJhdGlvbiA+Pj4gMTYgJiAweEZGLCBkdXJhdGlvbiA+Pj4gOCAmIDB4RkYsIGR1cmF0aW9uICYgMHhGRiwgc2l6ZSA+Pj4gMjQgJiAweEZGLCAvLyBzYW1wbGVfc2l6ZVxuICAgICAgICAgICAgICAgIHNpemUgPj4+IDE2ICYgMHhGRiwgc2l6ZSA+Pj4gOCAmIDB4RkYsIHNpemUgJiAweEZGLCBmbGFncy5pc0xlYWRpbmcgPDwgMiB8IGZsYWdzLmRlcGVuZHNPbiwgLy8gc2FtcGxlX2ZsYWdzXG4gICAgICAgICAgICAgICAgZmxhZ3MuaXNEZXBlbmRlZE9uIDw8IDYgfCBmbGFncy5oYXNSZWR1bmRhbmN5IDw8IDQgfCBmbGFncy5pc05vblN5bmMsIDB4MDAsIDB4MDAsIC8vIHNhbXBsZV9kZWdyYWRhdGlvbl9wcmlvcml0eVxuICAgICAgICAgICAgICAgIGN0cyA+Pj4gMjQgJiAweEZGLCAvLyBzYW1wbGVfY29tcG9zaXRpb25fdGltZV9vZmZzZXRcbiAgICAgICAgICAgICAgICBjdHMgPj4+IDE2ICYgMHhGRiwgY3RzID4+PiA4ICYgMHhGRiwgY3RzICYgMHhGRl0sIDEyICsgMTYgKiBpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy50cnVuLCBkYXRhKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbWRhdCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBtZGF0KGRhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiBNUDQuYm94KE1QNC50eXBlcy5tZGF0LCBkYXRhKTtcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBNUDQ7XG59KCk7XG5cbk1QNC5pbml0KCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IE1QNDtcblxufSx7fV0sMzg6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgX2xvZ2dlciA9IF9kZXJlcV8oJy4uL3V0aWxzL2xvZ2dlci5qcycpO1xuXG52YXIgX2xvZ2dlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9sb2dnZXIpO1xuXG52YXIgX21wNEdlbmVyYXRvciA9IF9kZXJlcV8oJy4vbXA0LWdlbmVyYXRvci5qcycpO1xuXG52YXIgX21wNEdlbmVyYXRvcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tcDRHZW5lcmF0b3IpO1xuXG52YXIgX2FhY1NpbGVudCA9IF9kZXJlcV8oJy4vYWFjLXNpbGVudC5qcycpO1xuXG52YXIgX2FhY1NpbGVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hYWNTaWxlbnQpO1xuXG52YXIgX2Jyb3dzZXIgPSBfZGVyZXFfKCcuLi91dGlscy9icm93c2VyLmpzJyk7XG5cbnZhciBfYnJvd3NlcjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9icm93c2VyKTtcblxudmFyIF9tZWRpYVNlZ21lbnRJbmZvID0gX2RlcmVxXygnLi4vY29yZS9tZWRpYS1zZWdtZW50LWluZm8uanMnKTtcblxudmFyIF9leGNlcHRpb24gPSBfZGVyZXFfKCcuLi91dGlscy9leGNlcHRpb24uanMnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLy8gRnJhZ21lbnRlZCBtcDQgcmVtdXhlclxudmFyIE1QNFJlbXV4ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gTVA0UmVtdXhlcihjb25maWcpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1QNFJlbXV4ZXIpO1xuXG4gICAgICAgIHRoaXMuVEFHID0gJ01QNFJlbXV4ZXInO1xuXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcbiAgICAgICAgdGhpcy5faXNMaXZlID0gY29uZmlnLmlzTGl2ZSA9PT0gdHJ1ZSA/IHRydWUgOiBmYWxzZTtcblxuICAgICAgICB0aGlzLl9kdHNCYXNlID0gLTE7XG4gICAgICAgIHRoaXMuX2R0c0Jhc2VJbml0ZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5fYXVkaW9EdHNCYXNlID0gSW5maW5pdHk7XG4gICAgICAgIHRoaXMuX3ZpZGVvRHRzQmFzZSA9IEluZmluaXR5O1xuICAgICAgICB0aGlzLl9hdWRpb05leHREdHMgPSB1bmRlZmluZWQ7XG4gICAgICAgIHRoaXMuX3ZpZGVvTmV4dER0cyA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5fYXVkaW9TdGFzaGVkTGFzdFNhbXBsZSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3ZpZGVvU3Rhc2hlZExhc3RTYW1wbGUgPSBudWxsO1xuXG4gICAgICAgIHRoaXMuX2F1ZGlvTWV0YSA9IG51bGw7XG4gICAgICAgIHRoaXMuX3ZpZGVvTWV0YSA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5fYXVkaW9TZWdtZW50SW5mb0xpc3QgPSBuZXcgX21lZGlhU2VnbWVudEluZm8uTWVkaWFTZWdtZW50SW5mb0xpc3QoJ2F1ZGlvJyk7XG4gICAgICAgIHRoaXMuX3ZpZGVvU2VnbWVudEluZm9MaXN0ID0gbmV3IF9tZWRpYVNlZ21lbnRJbmZvLk1lZGlhU2VnbWVudEluZm9MaXN0KCd2aWRlbycpO1xuXG4gICAgICAgIHRoaXMuX29uSW5pdFNlZ21lbnQgPSBudWxsO1xuICAgICAgICB0aGlzLl9vbk1lZGlhU2VnbWVudCA9IG51bGw7XG5cbiAgICAgICAgLy8gV29ya2Fyb3VuZCBmb3IgY2hyb21lIDwgNTA6IEFsd2F5cyBmb3JjZSBmaXJzdCBzYW1wbGUgYXMgYSBSYW5kb20gQWNjZXNzIFBvaW50IGluIG1lZGlhIHNlZ21lbnRcbiAgICAgICAgLy8gc2VlIGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC9jaHJvbWl1bS9pc3N1ZXMvZGV0YWlsP2lkPTIyOTQxMlxuICAgICAgICB0aGlzLl9mb3JjZUZpcnN0SURSID0gX2Jyb3dzZXIyLmRlZmF1bHQuY2hyb21lICYmIChfYnJvd3NlcjIuZGVmYXVsdC52ZXJzaW9uLm1ham9yIDwgNTAgfHwgX2Jyb3dzZXIyLmRlZmF1bHQudmVyc2lvbi5tYWpvciA9PT0gNTAgJiYgX2Jyb3dzZXIyLmRlZmF1bHQudmVyc2lvbi5idWlsZCA8IDI2NjEpID8gdHJ1ZSA6IGZhbHNlO1xuXG4gICAgICAgIC8vIFdvcmthcm91bmQgZm9yIElFMTEvRWRnZTogRmlsbCBzaWxlbnQgYWFjIGZyYW1lIGFmdGVyIGtleWZyYW1lLXNlZWtpbmdcbiAgICAgICAgLy8gTWFrZSBhdWRpbyBiZWdpbkR0cyBlcXVhbHMgd2l0aCB2aWRlbyBiZWdpbkR0cywgaW4gb3JkZXIgdG8gZml4IHNlZWsgZnJlZXplXG4gICAgICAgIHRoaXMuX2ZpbGxTaWxlbnRBZnRlclNlZWsgPSBfYnJvd3NlcjIuZGVmYXVsdC5tc2VkZ2UgfHwgX2Jyb3dzZXIyLmRlZmF1bHQubXNpZTtcblxuICAgICAgICAvLyBXaGlsZSBvbmx5IEZpcmVGb3ggc3VwcG9ydHMgJ2F1ZGlvL21wNCwgY29kZWNzPVwibXAzXCInLCB1c2UgJ2F1ZGlvL21wZWcnIGZvciBjaHJvbWUsIHNhZmFyaSwgLi4uXG4gICAgICAgIHRoaXMuX21wM1VzZU1wZWdBdWRpbyA9ICFfYnJvd3NlcjIuZGVmYXVsdC5maXJlZm94O1xuXG4gICAgICAgIHRoaXMuX2ZpbGxBdWRpb1RpbWVzdGFtcEdhcCA9IHRoaXMuX2NvbmZpZy5maXhBdWRpb1RpbWVzdGFtcEdhcDtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoTVA0UmVtdXhlciwgW3tcbiAgICAgICAga2V5OiAnZGVzdHJveScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95KCkge1xuICAgICAgICAgICAgdGhpcy5fZHRzQmFzZSA9IC0xO1xuICAgICAgICAgICAgdGhpcy5fZHRzQmFzZUluaXRlZCA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fYXVkaW9NZXRhID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX3ZpZGVvTWV0YSA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9hdWRpb1NlZ21lbnRJbmZvTGlzdC5jbGVhcigpO1xuICAgICAgICAgICAgdGhpcy5fYXVkaW9TZWdtZW50SW5mb0xpc3QgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fdmlkZW9TZWdtZW50SW5mb0xpc3QuY2xlYXIoKTtcbiAgICAgICAgICAgIHRoaXMuX3ZpZGVvU2VnbWVudEluZm9MaXN0ID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX29uSW5pdFNlZ21lbnQgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fb25NZWRpYVNlZ21lbnQgPSBudWxsO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdiaW5kRGF0YVNvdXJjZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBiaW5kRGF0YVNvdXJjZShwcm9kdWNlcikge1xuICAgICAgICAgICAgcHJvZHVjZXIub25EYXRhQXZhaWxhYmxlID0gdGhpcy5yZW11eC5iaW5kKHRoaXMpO1xuICAgICAgICAgICAgcHJvZHVjZXIub25UcmFja01ldGFkYXRhID0gdGhpcy5fb25UcmFja01ldGFkYXRhUmVjZWl2ZWQuYmluZCh0aGlzKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogcHJvdG90eXBlOiBmdW5jdGlvbiBvbkluaXRTZWdtZW50KHR5cGU6IHN0cmluZywgaW5pdFNlZ21lbnQ6IEFycmF5QnVmZmVyKTogdm9pZFxyXG4gICAgICAgICAgIEluaXRTZWdtZW50OiB7XHJcbiAgICAgICAgICAgICAgIHR5cGU6IHN0cmluZyxcclxuICAgICAgICAgICAgICAgZGF0YTogQXJyYXlCdWZmZXIsXHJcbiAgICAgICAgICAgICAgIGNvZGVjOiBzdHJpbmcsXHJcbiAgICAgICAgICAgICAgIGNvbnRhaW5lcjogc3RyaW5nXHJcbiAgICAgICAgICAgfVxyXG4gICAgICAgICovXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2luc2VydERpc2NvbnRpbnVpdHknLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5zZXJ0RGlzY29udGludWl0eSgpIHtcbiAgICAgICAgICAgIHRoaXMuX2F1ZGlvTmV4dER0cyA9IHRoaXMuX3ZpZGVvTmV4dER0cyA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc2VlaycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZWVrKG9yaWdpbmFsRHRzKSB7XG4gICAgICAgICAgICB0aGlzLl9hdWRpb1N0YXNoZWRMYXN0U2FtcGxlID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX3ZpZGVvU3Rhc2hlZExhc3RTYW1wbGUgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fdmlkZW9TZWdtZW50SW5mb0xpc3QuY2xlYXIoKTtcbiAgICAgICAgICAgIHRoaXMuX2F1ZGlvU2VnbWVudEluZm9MaXN0LmNsZWFyKCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlbXV4JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbXV4KGF1ZGlvVHJhY2ssIHZpZGVvVHJhY2spIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5fb25NZWRpYVNlZ21lbnQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbGxlZ2FsU3RhdGVFeGNlcHRpb24oJ01QNFJlbXV4ZXI6IG9uTWVkaWFTZWdtZW50IGNhbGxiYWNrIG11c3QgYmUgc3BlY2lmaWNlZCEnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghdGhpcy5fZHRzQmFzZUluaXRlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NhbGN1bGF0ZUR0c0Jhc2UoYXVkaW9UcmFjaywgdmlkZW9UcmFjayk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9yZW11eFZpZGVvKHZpZGVvVHJhY2spO1xuICAgICAgICAgICAgdGhpcy5fcmVtdXhBdWRpbyhhdWRpb1RyYWNrKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX29uVHJhY2tNZXRhZGF0YVJlY2VpdmVkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9vblRyYWNrTWV0YWRhdGFSZWNlaXZlZCh0eXBlLCBtZXRhZGF0YSkge1xuICAgICAgICAgICAgdmFyIG1ldGFib3ggPSBudWxsO1xuXG4gICAgICAgICAgICB2YXIgY29udGFpbmVyID0gJ21wNCc7XG4gICAgICAgICAgICB2YXIgY29kZWMgPSBtZXRhZGF0YS5jb2RlYztcblxuICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdhdWRpbycpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hdWRpb01ldGEgPSBtZXRhZGF0YTtcbiAgICAgICAgICAgICAgICBpZiAobWV0YWRhdGEuY29kZWMgPT09ICdtcDMnICYmIHRoaXMuX21wM1VzZU1wZWdBdWRpbykge1xuICAgICAgICAgICAgICAgICAgICAvLyAnYXVkaW8vbXBlZycgZm9yIE1QMyBhdWRpbyB0cmFja1xuICAgICAgICAgICAgICAgICAgICBjb250YWluZXIgPSAnbXBlZyc7XG4gICAgICAgICAgICAgICAgICAgIGNvZGVjID0gJyc7XG4gICAgICAgICAgICAgICAgICAgIG1ldGFib3ggPSBuZXcgVWludDhBcnJheSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vICdhdWRpby9tcDQsIGNvZGVjcz1cImNvZGVjXCInXG4gICAgICAgICAgICAgICAgICAgIG1ldGFib3ggPSBfbXA0R2VuZXJhdG9yMi5kZWZhdWx0LmdlbmVyYXRlSW5pdFNlZ21lbnQobWV0YWRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3ZpZGVvJykge1xuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZGVvTWV0YSA9IG1ldGFkYXRhO1xuICAgICAgICAgICAgICAgIG1ldGFib3ggPSBfbXA0R2VuZXJhdG9yMi5kZWZhdWx0LmdlbmVyYXRlSW5pdFNlZ21lbnQobWV0YWRhdGEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGRpc3BhdGNoIG1ldGFib3ggKEluaXRpYWxpemF0aW9uIFNlZ21lbnQpXG4gICAgICAgICAgICBpZiAoIXRoaXMuX29uSW5pdFNlZ21lbnQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgX2V4Y2VwdGlvbi5JbGxlZ2FsU3RhdGVFeGNlcHRpb24oJ01QNFJlbXV4ZXI6IG9uSW5pdFNlZ21lbnQgY2FsbGJhY2sgbXVzdCBiZSBzcGVjaWZpZWQhJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9vbkluaXRTZWdtZW50KHR5cGUsIHtcbiAgICAgICAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgICAgICAgIGRhdGE6IG1ldGFib3guYnVmZmVyLFxuICAgICAgICAgICAgICAgIGNvZGVjOiBjb2RlYyxcbiAgICAgICAgICAgICAgICBjb250YWluZXI6IHR5cGUgKyAnLycgKyBjb250YWluZXIsXG4gICAgICAgICAgICAgICAgbWVkaWFEdXJhdGlvbjogbWV0YWRhdGEuZHVyYXRpb24gLy8gaW4gdGltZXNjYWxlIDEwMDAgKG1pbGxpc2Vjb25kcylcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfY2FsY3VsYXRlRHRzQmFzZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfY2FsY3VsYXRlRHRzQmFzZShhdWRpb1RyYWNrLCB2aWRlb1RyYWNrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fZHRzQmFzZUluaXRlZCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGF1ZGlvVHJhY2suc2FtcGxlcyAmJiBhdWRpb1RyYWNrLnNhbXBsZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXVkaW9EdHNCYXNlID0gYXVkaW9UcmFjay5zYW1wbGVzWzBdLmR0cztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh2aWRlb1RyYWNrLnNhbXBsZXMgJiYgdmlkZW9UcmFjay5zYW1wbGVzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZGVvRHRzQmFzZSA9IHZpZGVvVHJhY2suc2FtcGxlc1swXS5kdHM7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuX2R0c0Jhc2UgPSBNYXRoLm1pbih0aGlzLl9hdWRpb0R0c0Jhc2UsIHRoaXMuX3ZpZGVvRHRzQmFzZSk7XG4gICAgICAgICAgICB0aGlzLl9kdHNCYXNlSW5pdGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZmx1c2hTdGFzaGVkU2FtcGxlcycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBmbHVzaFN0YXNoZWRTYW1wbGVzKCkge1xuICAgICAgICAgICAgdmFyIHZpZGVvU2FtcGxlID0gdGhpcy5fdmlkZW9TdGFzaGVkTGFzdFNhbXBsZTtcbiAgICAgICAgICAgIHZhciBhdWRpb1NhbXBsZSA9IHRoaXMuX2F1ZGlvU3Rhc2hlZExhc3RTYW1wbGU7XG5cbiAgICAgICAgICAgIHZhciB2aWRlb1RyYWNrID0ge1xuICAgICAgICAgICAgICAgIHR5cGU6ICd2aWRlbycsXG4gICAgICAgICAgICAgICAgaWQ6IDEsXG4gICAgICAgICAgICAgICAgc2VxdWVuY2VOdW1iZXI6IDAsXG4gICAgICAgICAgICAgICAgc2FtcGxlczogW10sXG4gICAgICAgICAgICAgICAgbGVuZ3RoOiAwXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAodmlkZW9TYW1wbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHZpZGVvVHJhY2suc2FtcGxlcy5wdXNoKHZpZGVvU2FtcGxlKTtcbiAgICAgICAgICAgICAgICB2aWRlb1RyYWNrLmxlbmd0aCA9IHZpZGVvU2FtcGxlLmxlbmd0aDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGF1ZGlvVHJhY2sgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2F1ZGlvJyxcbiAgICAgICAgICAgICAgICBpZDogMixcbiAgICAgICAgICAgICAgICBzZXF1ZW5jZU51bWJlcjogMCxcbiAgICAgICAgICAgICAgICBzYW1wbGVzOiBbXSxcbiAgICAgICAgICAgICAgICBsZW5ndGg6IDBcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmIChhdWRpb1NhbXBsZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgYXVkaW9UcmFjay5zYW1wbGVzLnB1c2goYXVkaW9TYW1wbGUpO1xuICAgICAgICAgICAgICAgIGF1ZGlvVHJhY2subGVuZ3RoID0gYXVkaW9TYW1wbGUubGVuZ3RoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl92aWRlb1N0YXNoZWRMYXN0U2FtcGxlID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX2F1ZGlvU3Rhc2hlZExhc3RTYW1wbGUgPSBudWxsO1xuXG4gICAgICAgICAgICB0aGlzLl9yZW11eFZpZGVvKHZpZGVvVHJhY2ssIHRydWUpO1xuICAgICAgICAgICAgdGhpcy5fcmVtdXhBdWRpbyhhdWRpb1RyYWNrLCB0cnVlKTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnX3JlbXV4QXVkaW8nLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gX3JlbXV4QXVkaW8oYXVkaW9UcmFjaywgZm9yY2UpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9hdWRpb01ldGEgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHRyYWNrID0gYXVkaW9UcmFjaztcbiAgICAgICAgICAgIHZhciBzYW1wbGVzID0gdHJhY2suc2FtcGxlcztcbiAgICAgICAgICAgIHZhciBkdHNDb3JyZWN0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdmFyIGZpcnN0RHRzID0gLTEsXG4gICAgICAgICAgICAgICAgbGFzdER0cyA9IC0xLFxuICAgICAgICAgICAgICAgIGxhc3RQdHMgPSAtMTtcbiAgICAgICAgICAgIHZhciByZWZTYW1wbGVEdXJhdGlvbiA9IHRoaXMuX2F1ZGlvTWV0YS5yZWZTYW1wbGVEdXJhdGlvbjtcblxuICAgICAgICAgICAgdmFyIG1wZWdSYXdUcmFjayA9IHRoaXMuX2F1ZGlvTWV0YS5jb2RlYyA9PT0gJ21wMycgJiYgdGhpcy5fbXAzVXNlTXBlZ0F1ZGlvO1xuICAgICAgICAgICAgdmFyIGZpcnN0U2VnbWVudEFmdGVyU2VlayA9IHRoaXMuX2R0c0Jhc2VJbml0ZWQgJiYgdGhpcy5fYXVkaW9OZXh0RHRzID09PSB1bmRlZmluZWQ7XG5cbiAgICAgICAgICAgIHZhciBpbnNlcnRQcmVmaXhTaWxlbnRGcmFtZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICBpZiAoIXNhbXBsZXMgfHwgc2FtcGxlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc2FtcGxlcy5sZW5ndGggPT09IDEgJiYgIWZvcmNlKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgW3NhbXBsZSBjb3VudCBpbiBjdXJyZW50IGJhdGNoXSA9PT0gMSAmJiAoZm9yY2UgIT0gdHJ1ZSlcbiAgICAgICAgICAgICAgICAvLyBJZ25vcmUgYW5kIGtlZXAgaW4gZGVtdXhlcidzIHF1ZXVlXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSAvLyBlbHNlIGlmIChmb3JjZSA9PT0gdHJ1ZSkgZG8gcmVtdXhcblxuICAgICAgICAgICAgdmFyIG9mZnNldCA9IDA7XG4gICAgICAgICAgICB2YXIgbWRhdGJveCA9IG51bGw7XG4gICAgICAgICAgICB2YXIgbWRhdEJ5dGVzID0gMDtcblxuICAgICAgICAgICAgLy8gY2FsY3VsYXRlIGluaXRpYWwgbWRhdCBzaXplXG4gICAgICAgICAgICBpZiAobXBlZ1Jhd1RyYWNrKSB7XG4gICAgICAgICAgICAgICAgLy8gZm9yIHJhdyBtcGVnIGJ1ZmZlclxuICAgICAgICAgICAgICAgIG9mZnNldCA9IDA7XG4gICAgICAgICAgICAgICAgbWRhdEJ5dGVzID0gdHJhY2subGVuZ3RoO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBmb3IgZm1wNCBtZGF0IGJveFxuICAgICAgICAgICAgICAgIG9mZnNldCA9IDg7IC8vIHNpemUgKyB0eXBlXG4gICAgICAgICAgICAgICAgbWRhdEJ5dGVzID0gOCArIHRyYWNrLmxlbmd0aDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIGxhc3RTYW1wbGUgPSBudWxsO1xuXG4gICAgICAgICAgICAvLyBQb3AgdGhlIGxhc3RTYW1wbGUgYW5kIHdhaXRpbmcgZm9yIHN0YXNoXG4gICAgICAgICAgICBpZiAoc2FtcGxlcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgbGFzdFNhbXBsZSA9IHNhbXBsZXMucG9wKCk7XG4gICAgICAgICAgICAgICAgbWRhdEJ5dGVzIC09IGxhc3RTYW1wbGUubGVuZ3RoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJbnNlcnQgW3N0YXNoZWQgbGFzdFNhbXBsZSBpbiB0aGUgcHJldmlvdXMgYmF0Y2hdIHRvIHRoZSBmcm9udFxuICAgICAgICAgICAgaWYgKHRoaXMuX2F1ZGlvU3Rhc2hlZExhc3RTYW1wbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHZhciBzYW1wbGUgPSB0aGlzLl9hdWRpb1N0YXNoZWRMYXN0U2FtcGxlO1xuICAgICAgICAgICAgICAgIHRoaXMuX2F1ZGlvU3Rhc2hlZExhc3RTYW1wbGUgPSBudWxsO1xuICAgICAgICAgICAgICAgIHNhbXBsZXMudW5zaGlmdChzYW1wbGUpO1xuICAgICAgICAgICAgICAgIG1kYXRCeXRlcyArPSBzYW1wbGUubGVuZ3RoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBTdGFzaCB0aGUgbGFzdFNhbXBsZSBvZiBjdXJyZW50IGJhdGNoLCB3YWl0aW5nIGZvciBuZXh0IGJhdGNoXG4gICAgICAgICAgICBpZiAobGFzdFNhbXBsZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fYXVkaW9TdGFzaGVkTGFzdFNhbXBsZSA9IGxhc3RTYW1wbGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBmaXJzdFNhbXBsZU9yaWdpbmFsRHRzID0gc2FtcGxlc1swXS5kdHMgLSB0aGlzLl9kdHNCYXNlO1xuXG4gICAgICAgICAgICAvLyBjYWxjdWxhdGUgZHRzQ29ycmVjdGlvblxuICAgICAgICAgICAgaWYgKHRoaXMuX2F1ZGlvTmV4dER0cykge1xuICAgICAgICAgICAgICAgIGR0c0NvcnJlY3Rpb24gPSBmaXJzdFNhbXBsZU9yaWdpbmFsRHRzIC0gdGhpcy5fYXVkaW9OZXh0RHRzO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyB0aGlzLl9hdWRpb05leHREdHMgPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2F1ZGlvU2VnbWVudEluZm9MaXN0LmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgICAgICBkdHNDb3JyZWN0aW9uID0gMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2ZpbGxTaWxlbnRBZnRlclNlZWsgJiYgIXRoaXMuX3ZpZGVvU2VnbWVudEluZm9MaXN0LmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2F1ZGlvTWV0YS5vcmlnaW5hbENvZGVjICE9PSAnbXAzJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc2VydFByZWZpeFNpbGVudEZyYW1lID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBfbGFzdFNhbXBsZSA9IHRoaXMuX2F1ZGlvU2VnbWVudEluZm9MaXN0LmdldExhc3RTYW1wbGVCZWZvcmUoZmlyc3RTYW1wbGVPcmlnaW5hbER0cyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfbGFzdFNhbXBsZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGlzdGFuY2UgPSBmaXJzdFNhbXBsZU9yaWdpbmFsRHRzIC0gKF9sYXN0U2FtcGxlLm9yaWdpbmFsRHRzICsgX2xhc3RTYW1wbGUuZHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRpc3RhbmNlIDw9IDMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXN0YW5jZSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXhwZWN0ZWREdHMgPSBfbGFzdFNhbXBsZS5kdHMgKyBfbGFzdFNhbXBsZS5kdXJhdGlvbiArIGRpc3RhbmNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgZHRzQ29ycmVjdGlvbiA9IGZpcnN0U2FtcGxlT3JpZ2luYWxEdHMgLSBleHBlY3RlZER0cztcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxhc3RTYW1wbGUgPT0gbnVsbCwgY2Fubm90IGZvdW5kXG4gICAgICAgICAgICAgICAgICAgICAgICBkdHNDb3JyZWN0aW9uID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGluc2VydFByZWZpeFNpbGVudEZyYW1lKSB7XG4gICAgICAgICAgICAgICAgLy8gYWxpZ24gYXVkaW8gc2VnbWVudCBiZWdpbkR0cyB0byBtYXRjaCB3aXRoIGN1cnJlbnQgdmlkZW8gc2VnbWVudCdzIGJlZ2luRHRzXG4gICAgICAgICAgICAgICAgdmFyIGZpcnN0U2FtcGxlRHRzID0gZmlyc3RTYW1wbGVPcmlnaW5hbER0cyAtIGR0c0NvcnJlY3Rpb247XG4gICAgICAgICAgICAgICAgdmFyIHZpZGVvU2VnbWVudCA9IHRoaXMuX3ZpZGVvU2VnbWVudEluZm9MaXN0LmdldExhc3RTZWdtZW50QmVmb3JlKGZpcnN0U2FtcGxlT3JpZ2luYWxEdHMpO1xuICAgICAgICAgICAgICAgIGlmICh2aWRlb1NlZ21lbnQgIT0gbnVsbCAmJiB2aWRlb1NlZ21lbnQuYmVnaW5EdHMgPCBmaXJzdFNhbXBsZUR0cykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2lsZW50VW5pdCA9IF9hYWNTaWxlbnQyLmRlZmF1bHQuZ2V0U2lsZW50RnJhbWUodGhpcy5fYXVkaW9NZXRhLm9yaWdpbmFsQ29kZWMsIHRoaXMuX2F1ZGlvTWV0YS5jaGFubmVsQ291bnQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2lsZW50VW5pdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGR0cyA9IHZpZGVvU2VnbWVudC5iZWdpbkR0cztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaWxlbnRGcmFtZUR1cmF0aW9uID0gZmlyc3RTYW1wbGVEdHMgLSB2aWRlb1NlZ21lbnQuYmVnaW5EdHM7XG4gICAgICAgICAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LnYodGhpcy5UQUcsICdJbnNlcnRQcmVmaXhTaWxlbnRBdWRpbzogZHRzOiAnICsgZHRzICsgJywgZHVyYXRpb246ICcgKyBzaWxlbnRGcmFtZUR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhbXBsZXMudW5zaGlmdCh7IHVuaXQ6IHNpbGVudFVuaXQsIGR0czogZHRzLCBwdHM6IGR0cyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1kYXRCeXRlcyArPSBzaWxlbnRVbml0LmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIH0gLy8gc2lsZW50VW5pdCA9PSBudWxsOiBDYW5ub3QgZ2VuZXJhdGUsIHNraXBcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpbnNlcnRQcmVmaXhTaWxlbnRGcmFtZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIG1wNFNhbXBsZXMgPSBbXTtcblxuICAgICAgICAgICAgLy8gQ29ycmVjdCBkdHMgZm9yIGVhY2ggc2FtcGxlLCBhbmQgY2FsY3VsYXRlIHNhbXBsZSBkdXJhdGlvbi4gVGhlbiBvdXRwdXQgdG8gbXA0U2FtcGxlc1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzYW1wbGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIF9zYW1wbGUgPSBzYW1wbGVzW2ldO1xuICAgICAgICAgICAgICAgIHZhciB1bml0ID0gX3NhbXBsZS51bml0O1xuICAgICAgICAgICAgICAgIHZhciBvcmlnaW5hbER0cyA9IF9zYW1wbGUuZHRzIC0gdGhpcy5fZHRzQmFzZTtcbiAgICAgICAgICAgICAgICB2YXIgX2R0cyA9IG9yaWdpbmFsRHRzO1xuICAgICAgICAgICAgICAgIHZhciBuZWVkRmlsbFNpbGVudEZyYW1lcyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBzaWxlbnRGcmFtZXMgPSBudWxsO1xuICAgICAgICAgICAgICAgIHZhciBzYW1wbGVEdXJhdGlvbiA9IDA7XG5cbiAgICAgICAgICAgICAgICBpZiAob3JpZ2luYWxEdHMgPCAtMC4wMDEpIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7IC8vcGFzcyB0aGUgZmlyc3Qgc2FtcGxlIHdpdGggdGhlIGludmFsaWQgZHRzXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2F1ZGlvTWV0YS5jb2RlYyAhPT0gJ21wMycpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZm9yIEFBQyBjb2RlYywgd2UgbmVlZCB0byBrZWVwIGR0cyBpbmNyZWFzZSBiYXNlZCBvbiByZWZTYW1wbGVEdXJhdGlvblxuICAgICAgICAgICAgICAgICAgICB2YXIgY3VyUmVmRHRzID0gb3JpZ2luYWxEdHM7XG4gICAgICAgICAgICAgICAgICAgIHZhciBtYXhBdWRpb0ZyYW1lc0RyaWZ0ID0gMztcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2F1ZGlvTmV4dER0cykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY3VyUmVmRHRzID0gdGhpcy5fYXVkaW9OZXh0RHRzO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgZHRzQ29ycmVjdGlvbiA9IG9yaWdpbmFsRHRzIC0gY3VyUmVmRHRzO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZHRzQ29ycmVjdGlvbiA8PSAtbWF4QXVkaW9GcmFtZXNEcmlmdCAqIHJlZlNhbXBsZUR1cmF0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSdyZSBvdmVybGFwcGluZyBieSBtb3JlIHRoYW4gbWF4QXVkaW9GcmFtZXNEcmlmdCBudW1iZXIgb2YgZnJhbWUsIGRyb3AgdGhpcyBzYW1wbGVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vTG9nLncodGhpcy5UQUcsIGBEcm9wcGluZyAxIGF1ZGlvIGZyYW1lIChvcmlnaW5hbER0czogJHtvcmlnaW5hbER0c30gbXMgLGN1clJlZkR0czogJHtjdXJSZWZEdHN9IG1zKSAgZHVlIHRvIGR0c0NvcnJlY3Rpb246ICR7ZHRzQ29ycmVjdGlvbn0gbXMgb3ZlcmxhcC5gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGR0c0NvcnJlY3Rpb24gPj0gbWF4QXVkaW9GcmFtZXNEcmlmdCAqIHJlZlNhbXBsZUR1cmF0aW9uICYmIHRoaXMuX2ZpbGxBdWRpb1RpbWVzdGFtcEdhcCAmJiAhX2Jyb3dzZXIyLmRlZmF1bHQuc2FmYXJpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTaWxlbnQgZnJhbWUgZ2VuZXJhdGlvbiwgaWYgbGFyZ2UgdGltZXN0YW1wIGdhcCBkZXRlY3RlZCAmJiBjb25maWcuZml4QXVkaW9UaW1lc3RhbXBHYXBcbiAgICAgICAgICAgICAgICAgICAgICAgIG5lZWRGaWxsU2lsZW50RnJhbWVzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gaW5zZXJ0IHNpbGVudCBmcmFtZXMgdG8gZmlsbCB0aW1lc3RhbXAgZ2FwXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnJhbWVDb3VudCA9IE1hdGguZmxvb3IoZHRzQ29ycmVjdGlvbiAvIHJlZlNhbXBsZUR1cmF0aW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQudyh0aGlzLlRBRywgJ0xhcmdlIGF1ZGlvIHRpbWVzdGFtcCBnYXAgZGV0ZWN0ZWQsIG1heSBjYXVzZSBBViBzeW5jIHRvIGRyaWZ0LiAnICsgJ1NpbGVudCBmcmFtZXMgd2lsbCBiZSBnZW5lcmF0ZWQgdG8gYXZvaWQgdW5zeW5jLlxcbicgKyAoJ29yaWdpbmFsRHRzOiAnICsgb3JpZ2luYWxEdHMgKyAnIG1zLCBjdXJSZWZEdHM6ICcgKyBjdXJSZWZEdHMgKyAnIG1zLCAnKSArICgnZHRzQ29ycmVjdGlvbjogJyArIE1hdGgucm91bmQoZHRzQ29ycmVjdGlvbikgKyAnIG1zLCBnZW5lcmF0ZTogJyArIGZyYW1lQ291bnQgKyAnIGZyYW1lcycpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgX2R0cyA9IE1hdGguZmxvb3IoY3VyUmVmRHRzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhbXBsZUR1cmF0aW9uID0gTWF0aC5mbG9vcihjdXJSZWZEdHMgKyByZWZTYW1wbGVEdXJhdGlvbikgLSBfZHRzO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX3NpbGVudFVuaXQgPSBfYWFjU2lsZW50Mi5kZWZhdWx0LmdldFNpbGVudEZyYW1lKHRoaXMuX2F1ZGlvTWV0YS5vcmlnaW5hbENvZGVjLCB0aGlzLl9hdWRpb01ldGEuY2hhbm5lbENvdW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfc2lsZW50VW5pdCA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC53KHRoaXMuVEFHLCAnVW5hYmxlIHRvIGdlbmVyYXRlIHNpbGVudCBmcmFtZSBmb3IgJyArICh0aGlzLl9hdWRpb01ldGEub3JpZ2luYWxDb2RlYyArICcgd2l0aCAnICsgdGhpcy5fYXVkaW9NZXRhLmNoYW5uZWxDb3VudCArICcgY2hhbm5lbHMsIHJlcGVhdCBsYXN0IGZyYW1lJykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlcGVhdCBsYXN0IGZyYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3NpbGVudFVuaXQgPSB1bml0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgc2lsZW50RnJhbWVzID0gW107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZnJhbWVDb3VudDsgaisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VyUmVmRHRzID0gY3VyUmVmRHRzICsgcmVmU2FtcGxlRHVyYXRpb247XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGludER0cyA9IE1hdGguZmxvb3IoY3VyUmVmRHRzKTsgLy8gY2hhbmdlIHRvIGludGVnZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW50RHVyYXRpb24gPSBNYXRoLmZsb29yKGN1clJlZkR0cyArIHJlZlNhbXBsZUR1cmF0aW9uKSAtIGludER0cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZnJhbWUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGR0czogaW50RHRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdHM6IGludER0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3RzOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bml0OiBfc2lsZW50VW5pdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogX3NpbGVudFVuaXQuYnl0ZUxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IGludER1cmF0aW9uLCAvLyB3YWl0IGZvciBuZXh0IHNhbXBsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbER0czogb3JpZ2luYWxEdHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZsYWdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0xlYWRpbmc6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXBlbmRzT246IDEsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0RlcGVuZGVkT246IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNSZWR1bmRhbmN5OiAwXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNpbGVudEZyYW1lcy5wdXNoKGZyYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZGF0Qnl0ZXMgKz0gZnJhbWUuc2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXVkaW9OZXh0RHRzID0gY3VyUmVmRHRzICsgcmVmU2FtcGxlRHVyYXRpb247XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIF9kdHMgPSBNYXRoLmZsb29yKGN1clJlZkR0cyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVEdXJhdGlvbiA9IE1hdGguZmxvb3IoY3VyUmVmRHRzICsgcmVmU2FtcGxlRHVyYXRpb24pIC0gX2R0cztcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2F1ZGlvTmV4dER0cyA9IGN1clJlZkR0cyArIHJlZlNhbXBsZUR1cmF0aW9uO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8ga2VlcCB0aGUgb3JpZ2luYWwgZHRzIGNhbGN1bGF0ZSBhbGdvcml0aG0gZm9yIG1wM1xuICAgICAgICAgICAgICAgICAgICBfZHRzID0gb3JpZ2luYWxEdHMgLSBkdHNDb3JyZWN0aW9uO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChpICE9PSBzYW1wbGVzLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXh0RHRzID0gc2FtcGxlc1tpICsgMV0uZHRzIC0gdGhpcy5fZHRzQmFzZSAtIGR0c0NvcnJlY3Rpb247XG4gICAgICAgICAgICAgICAgICAgICAgICBzYW1wbGVEdXJhdGlvbiA9IG5leHREdHMgLSBfZHRzO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGxhc3Qgc2FtcGxlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGFzdFNhbXBsZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXNlIHN0YXNoZWQgc2FtcGxlJ3MgZHRzIHRvIGNhbGN1bGF0ZSBzYW1wbGUgZHVyYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgX25leHREdHMgPSBsYXN0U2FtcGxlLmR0cyAtIHRoaXMuX2R0c0Jhc2UgLSBkdHNDb3JyZWN0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXBsZUR1cmF0aW9uID0gX25leHREdHMgLSBfZHRzO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtcDRTYW1wbGVzLmxlbmd0aCA+PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXNlIHNlY29uZCBsYXN0IHNhbXBsZSBkdXJhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXBsZUR1cmF0aW9uID0gbXA0U2FtcGxlc1ttcDRTYW1wbGVzLmxlbmd0aCAtIDFdLmR1cmF0aW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgb25seSBvbmUgc2FtcGxlLCB1c2UgcmVmZXJlbmNlIHNhbXBsZSBkdXJhdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNhbXBsZUR1cmF0aW9uID0gTWF0aC5mbG9vcihyZWZTYW1wbGVEdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fYXVkaW9OZXh0RHRzID0gX2R0cyArIHNhbXBsZUR1cmF0aW9uO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChmaXJzdER0cyA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgZmlyc3REdHMgPSBfZHRzO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtcDRTYW1wbGVzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBkdHM6IF9kdHMsXG4gICAgICAgICAgICAgICAgICAgIHB0czogX2R0cyxcbiAgICAgICAgICAgICAgICAgICAgY3RzOiAwLFxuICAgICAgICAgICAgICAgICAgICB1bml0OiBfc2FtcGxlLnVuaXQsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IF9zYW1wbGUudW5pdC5ieXRlTGVuZ3RoLFxuICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogc2FtcGxlRHVyYXRpb24sXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsRHRzOiBvcmlnaW5hbER0cyxcbiAgICAgICAgICAgICAgICAgICAgZmxhZ3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzTGVhZGluZzogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlcGVuZHNPbjogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzRGVwZW5kZWRPbjogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc1JlZHVuZGFuY3k6IDBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgaWYgKG5lZWRGaWxsU2lsZW50RnJhbWVzKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFNpbGVudCBmcmFtZXMgc2hvdWxkIGJlIGluc2VydGVkIGFmdGVyIHdyb25nLWR1cmF0aW9uIGZyYW1lXG4gICAgICAgICAgICAgICAgICAgIG1wNFNhbXBsZXMucHVzaC5hcHBseShtcDRTYW1wbGVzLCBzaWxlbnRGcmFtZXMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG1wNFNhbXBsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgLy9ubyBzYW1wbGVzIG5lZWQgdG8gcmVtdXhcbiAgICAgICAgICAgICAgICB0cmFjay5zYW1wbGVzID0gW107XG4gICAgICAgICAgICAgICAgdHJhY2subGVuZ3RoID0gMDtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGFsbG9jYXRlIG1kYXRib3hcbiAgICAgICAgICAgIGlmIChtcGVnUmF3VHJhY2spIHtcbiAgICAgICAgICAgICAgICAvLyBhbGxvY2F0ZSBmb3IgcmF3IG1wZWcgYnVmZmVyXG4gICAgICAgICAgICAgICAgbWRhdGJveCA9IG5ldyBVaW50OEFycmF5KG1kYXRCeXRlcyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGFsbG9jYXRlIGZvciBmbXA0IG1kYXQgYm94XG4gICAgICAgICAgICAgICAgbWRhdGJveCA9IG5ldyBVaW50OEFycmF5KG1kYXRCeXRlcyk7XG4gICAgICAgICAgICAgICAgLy8gc2l6ZSBmaWVsZFxuICAgICAgICAgICAgICAgIG1kYXRib3hbMF0gPSBtZGF0Qnl0ZXMgPj4+IDI0ICYgMHhGRjtcbiAgICAgICAgICAgICAgICBtZGF0Ym94WzFdID0gbWRhdEJ5dGVzID4+PiAxNiAmIDB4RkY7XG4gICAgICAgICAgICAgICAgbWRhdGJveFsyXSA9IG1kYXRCeXRlcyA+Pj4gOCAmIDB4RkY7XG4gICAgICAgICAgICAgICAgbWRhdGJveFszXSA9IG1kYXRCeXRlcyAmIDB4RkY7XG4gICAgICAgICAgICAgICAgLy8gdHlwZSBmaWVsZCAoZm91ckNDKVxuICAgICAgICAgICAgICAgIG1kYXRib3guc2V0KF9tcDRHZW5lcmF0b3IyLmRlZmF1bHQudHlwZXMubWRhdCwgNCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFdyaXRlIHNhbXBsZXMgaW50byBtZGF0Ym94XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDA7IF9pIDwgbXA0U2FtcGxlcy5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgX3VuaXQgPSBtcDRTYW1wbGVzW19pXS51bml0O1xuICAgICAgICAgICAgICAgIG1kYXRib3guc2V0KF91bml0LCBvZmZzZXQpO1xuICAgICAgICAgICAgICAgIG9mZnNldCArPSBfdW5pdC5ieXRlTGVuZ3RoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbGF0ZXN0ID0gbXA0U2FtcGxlc1ttcDRTYW1wbGVzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgbGFzdER0cyA9IGxhdGVzdC5kdHMgKyBsYXRlc3QuZHVyYXRpb247XG4gICAgICAgICAgICAvL3RoaXMuX2F1ZGlvTmV4dER0cyA9IGxhc3REdHM7XG5cbiAgICAgICAgICAgIC8vIGZpbGwgbWVkaWEgc2VnbWVudCBpbmZvICYgYWRkIHRvIGluZm8gbGlzdFxuICAgICAgICAgICAgdmFyIGluZm8gPSBuZXcgX21lZGlhU2VnbWVudEluZm8uTWVkaWFTZWdtZW50SW5mbygpO1xuICAgICAgICAgICAgaW5mby5iZWdpbkR0cyA9IGZpcnN0RHRzO1xuICAgICAgICAgICAgaW5mby5lbmREdHMgPSBsYXN0RHRzO1xuICAgICAgICAgICAgaW5mby5iZWdpblB0cyA9IGZpcnN0RHRzO1xuICAgICAgICAgICAgaW5mby5lbmRQdHMgPSBsYXN0RHRzO1xuICAgICAgICAgICAgaW5mby5vcmlnaW5hbEJlZ2luRHRzID0gbXA0U2FtcGxlc1swXS5vcmlnaW5hbER0cztcbiAgICAgICAgICAgIGluZm8ub3JpZ2luYWxFbmREdHMgPSBsYXRlc3Qub3JpZ2luYWxEdHMgKyBsYXRlc3QuZHVyYXRpb247XG4gICAgICAgICAgICBpbmZvLmZpcnN0U2FtcGxlID0gbmV3IF9tZWRpYVNlZ21lbnRJbmZvLlNhbXBsZUluZm8obXA0U2FtcGxlc1swXS5kdHMsIG1wNFNhbXBsZXNbMF0ucHRzLCBtcDRTYW1wbGVzWzBdLmR1cmF0aW9uLCBtcDRTYW1wbGVzWzBdLm9yaWdpbmFsRHRzLCBmYWxzZSk7XG4gICAgICAgICAgICBpbmZvLmxhc3RTYW1wbGUgPSBuZXcgX21lZGlhU2VnbWVudEluZm8uU2FtcGxlSW5mbyhsYXRlc3QuZHRzLCBsYXRlc3QucHRzLCBsYXRlc3QuZHVyYXRpb24sIGxhdGVzdC5vcmlnaW5hbER0cywgZmFsc2UpO1xuICAgICAgICAgICAgaWYgKCF0aGlzLl9pc0xpdmUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9hdWRpb1NlZ21lbnRJbmZvTGlzdC5hcHBlbmQoaW5mbyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRyYWNrLnNhbXBsZXMgPSBtcDRTYW1wbGVzO1xuICAgICAgICAgICAgdHJhY2suc2VxdWVuY2VOdW1iZXIrKztcblxuICAgICAgICAgICAgdmFyIG1vb2Zib3ggPSBudWxsO1xuXG4gICAgICAgICAgICBpZiAobXBlZ1Jhd1RyYWNrKSB7XG4gICAgICAgICAgICAgICAgLy8gR2VuZXJhdGUgZW1wdHkgYnVmZmVyLCBiZWNhdXNlIHVzZWxlc3MgZm9yIHJhdyBtcGVnXG4gICAgICAgICAgICAgICAgbW9vZmJveCA9IG5ldyBVaW50OEFycmF5KCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIEdlbmVyYXRlIG1vb2YgZm9yIGZtcDQgc2VnbWVudFxuICAgICAgICAgICAgICAgIG1vb2Zib3ggPSBfbXA0R2VuZXJhdG9yMi5kZWZhdWx0Lm1vb2YodHJhY2ssIGZpcnN0RHRzKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdHJhY2suc2FtcGxlcyA9IFtdO1xuICAgICAgICAgICAgdHJhY2subGVuZ3RoID0gMDtcblxuICAgICAgICAgICAgdmFyIHNlZ21lbnQgPSB7XG4gICAgICAgICAgICAgICAgdHlwZTogJ2F1ZGlvJyxcbiAgICAgICAgICAgICAgICBkYXRhOiB0aGlzLl9tZXJnZUJveGVzKG1vb2Zib3gsIG1kYXRib3gpLmJ1ZmZlcixcbiAgICAgICAgICAgICAgICBzYW1wbGVDb3VudDogbXA0U2FtcGxlcy5sZW5ndGgsXG4gICAgICAgICAgICAgICAgaW5mbzogaW5mb1xuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYgKG1wZWdSYXdUcmFjayAmJiBmaXJzdFNlZ21lbnRBZnRlclNlZWspIHtcbiAgICAgICAgICAgICAgICAvLyBGb3IgTVBFRyBhdWRpbyBzdHJlYW0gaW4gTVNFLCBpZiBzZWVraW5nIG9jY3VycmVkLCBiZWZvcmUgYXBwZW5kaW5nIG5ldyBidWZmZXJcbiAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIGV4cGxpY2l0bHkgc2V0IHRpbWVzdGFtcE9mZnNldCB0byB0aGUgZGVzaXJlZCBwb2ludCBpbiB0aW1lbGluZSBmb3IgbXBlZyBTb3VyY2VCdWZmZXIuXG4gICAgICAgICAgICAgICAgc2VnbWVudC50aW1lc3RhbXBPZmZzZXQgPSBmaXJzdER0cztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fb25NZWRpYVNlZ21lbnQoJ2F1ZGlvJywgc2VnbWVudCk7XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ19yZW11eFZpZGVvJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9yZW11eFZpZGVvKHZpZGVvVHJhY2ssIGZvcmNlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fdmlkZW9NZXRhID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciB0cmFjayA9IHZpZGVvVHJhY2s7XG4gICAgICAgICAgICB2YXIgc2FtcGxlcyA9IHRyYWNrLnNhbXBsZXM7XG4gICAgICAgICAgICB2YXIgZHRzQ29ycmVjdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIHZhciBmaXJzdER0cyA9IC0xLFxuICAgICAgICAgICAgICAgIGxhc3REdHMgPSAtMTtcbiAgICAgICAgICAgIHZhciBmaXJzdFB0cyA9IC0xLFxuICAgICAgICAgICAgICAgIGxhc3RQdHMgPSAtMTtcblxuICAgICAgICAgICAgaWYgKCFzYW1wbGVzIHx8IHNhbXBsZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNhbXBsZXMubGVuZ3RoID09PSAxICYmICFmb3JjZSkge1xuICAgICAgICAgICAgICAgIC8vIElmIFtzYW1wbGUgY291bnQgaW4gY3VycmVudCBiYXRjaF0gPT09IDEgJiYgKGZvcmNlICE9IHRydWUpXG4gICAgICAgICAgICAgICAgLy8gSWdub3JlIGFuZCBrZWVwIGluIGRlbXV4ZXIncyBxdWV1ZVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gLy8gZWxzZSBpZiAoZm9yY2UgPT09IHRydWUpIGRvIHJlbXV4XG5cbiAgICAgICAgICAgIHZhciBvZmZzZXQgPSA4O1xuICAgICAgICAgICAgdmFyIG1kYXRib3ggPSBudWxsO1xuICAgICAgICAgICAgdmFyIG1kYXRCeXRlcyA9IDggKyB2aWRlb1RyYWNrLmxlbmd0aDtcblxuICAgICAgICAgICAgdmFyIGxhc3RTYW1wbGUgPSBudWxsO1xuXG4gICAgICAgICAgICAvLyBQb3AgdGhlIGxhc3RTYW1wbGUgYW5kIHdhaXRpbmcgZm9yIHN0YXNoXG4gICAgICAgICAgICBpZiAoc2FtcGxlcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgbGFzdFNhbXBsZSA9IHNhbXBsZXMucG9wKCk7XG4gICAgICAgICAgICAgICAgbWRhdEJ5dGVzIC09IGxhc3RTYW1wbGUubGVuZ3RoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBJbnNlcnQgW3N0YXNoZWQgbGFzdFNhbXBsZSBpbiB0aGUgcHJldmlvdXMgYmF0Y2hdIHRvIHRoZSBmcm9udFxuICAgICAgICAgICAgaWYgKHRoaXMuX3ZpZGVvU3Rhc2hlZExhc3RTYW1wbGUgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHZhciBzYW1wbGUgPSB0aGlzLl92aWRlb1N0YXNoZWRMYXN0U2FtcGxlO1xuICAgICAgICAgICAgICAgIHRoaXMuX3ZpZGVvU3Rhc2hlZExhc3RTYW1wbGUgPSBudWxsO1xuICAgICAgICAgICAgICAgIHNhbXBsZXMudW5zaGlmdChzYW1wbGUpO1xuICAgICAgICAgICAgICAgIG1kYXRCeXRlcyArPSBzYW1wbGUubGVuZ3RoO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBTdGFzaCB0aGUgbGFzdFNhbXBsZSBvZiBjdXJyZW50IGJhdGNoLCB3YWl0aW5nIGZvciBuZXh0IGJhdGNoXG4gICAgICAgICAgICBpZiAobGFzdFNhbXBsZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdmlkZW9TdGFzaGVkTGFzdFNhbXBsZSA9IGxhc3RTYW1wbGU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBmaXJzdFNhbXBsZU9yaWdpbmFsRHRzID0gc2FtcGxlc1swXS5kdHMgLSB0aGlzLl9kdHNCYXNlO1xuXG4gICAgICAgICAgICAvLyBjYWxjdWxhdGUgZHRzQ29ycmVjdGlvblxuICAgICAgICAgICAgaWYgKHRoaXMuX3ZpZGVvTmV4dER0cykge1xuICAgICAgICAgICAgICAgIGR0c0NvcnJlY3Rpb24gPSBmaXJzdFNhbXBsZU9yaWdpbmFsRHRzIC0gdGhpcy5fdmlkZW9OZXh0RHRzO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyB0aGlzLl92aWRlb05leHREdHMgPT0gdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3ZpZGVvU2VnbWVudEluZm9MaXN0LmlzRW1wdHkoKSkge1xuICAgICAgICAgICAgICAgICAgICBkdHNDb3JyZWN0aW9uID0gMDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgX2xhc3RTYW1wbGUyID0gdGhpcy5fdmlkZW9TZWdtZW50SW5mb0xpc3QuZ2V0TGFzdFNhbXBsZUJlZm9yZShmaXJzdFNhbXBsZU9yaWdpbmFsRHRzKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9sYXN0U2FtcGxlMiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGlzdGFuY2UgPSBmaXJzdFNhbXBsZU9yaWdpbmFsRHRzIC0gKF9sYXN0U2FtcGxlMi5vcmlnaW5hbER0cyArIF9sYXN0U2FtcGxlMi5kdXJhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGlzdGFuY2UgPD0gMykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3RhbmNlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBleHBlY3RlZER0cyA9IF9sYXN0U2FtcGxlMi5kdHMgKyBfbGFzdFNhbXBsZTIuZHVyYXRpb24gKyBkaXN0YW5jZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGR0c0NvcnJlY3Rpb24gPSBmaXJzdFNhbXBsZU9yaWdpbmFsRHRzIC0gZXhwZWN0ZWREdHM7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBsYXN0U2FtcGxlID09IG51bGwsIGNhbm5vdCBmb3VuZFxuICAgICAgICAgICAgICAgICAgICAgICAgZHRzQ29ycmVjdGlvbiA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBpbmZvID0gbmV3IF9tZWRpYVNlZ21lbnRJbmZvLk1lZGlhU2VnbWVudEluZm8oKTtcbiAgICAgICAgICAgIHZhciBtcDRTYW1wbGVzID0gW107XG5cbiAgICAgICAgICAgIC8vIENvcnJlY3QgZHRzIGZvciBlYWNoIHNhbXBsZSwgYW5kIGNhbGN1bGF0ZSBzYW1wbGUgZHVyYXRpb24uIFRoZW4gb3V0cHV0IHRvIG1wNFNhbXBsZXNcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2FtcGxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBfc2FtcGxlMiA9IHNhbXBsZXNbaV07XG4gICAgICAgICAgICAgICAgdmFyIG9yaWdpbmFsRHRzID0gX3NhbXBsZTIuZHRzIC0gdGhpcy5fZHRzQmFzZTtcbiAgICAgICAgICAgICAgICB2YXIgaXNLZXlmcmFtZSA9IF9zYW1wbGUyLmlzS2V5ZnJhbWU7XG4gICAgICAgICAgICAgICAgdmFyIGR0cyA9IG9yaWdpbmFsRHRzIC0gZHRzQ29ycmVjdGlvbjtcbiAgICAgICAgICAgICAgICB2YXIgY3RzID0gX3NhbXBsZTIuY3RzO1xuICAgICAgICAgICAgICAgIHZhciBwdHMgPSBkdHMgKyBjdHM7XG5cbiAgICAgICAgICAgICAgICBpZiAoZmlyc3REdHMgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGZpcnN0RHRzID0gZHRzO1xuICAgICAgICAgICAgICAgICAgICBmaXJzdFB0cyA9IHB0cztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB2YXIgc2FtcGxlRHVyYXRpb24gPSAwO1xuXG4gICAgICAgICAgICAgICAgaWYgKGkgIT09IHNhbXBsZXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV4dER0cyA9IHNhbXBsZXNbaSArIDFdLmR0cyAtIHRoaXMuX2R0c0Jhc2UgLSBkdHNDb3JyZWN0aW9uO1xuICAgICAgICAgICAgICAgICAgICBzYW1wbGVEdXJhdGlvbiA9IG5leHREdHMgLSBkdHM7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGxhc3Qgc2FtcGxlXG4gICAgICAgICAgICAgICAgICAgIGlmIChsYXN0U2FtcGxlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVzZSBzdGFzaGVkIHNhbXBsZSdzIGR0cyB0byBjYWxjdWxhdGUgc2FtcGxlIGR1cmF0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgX25leHREdHMyID0gbGFzdFNhbXBsZS5kdHMgLSB0aGlzLl9kdHNCYXNlIC0gZHRzQ29ycmVjdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNhbXBsZUR1cmF0aW9uID0gX25leHREdHMyIC0gZHRzO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1wNFNhbXBsZXMubGVuZ3RoID49IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVzZSBzZWNvbmQgbGFzdCBzYW1wbGUgZHVyYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIHNhbXBsZUR1cmF0aW9uID0gbXA0U2FtcGxlc1ttcDRTYW1wbGVzLmxlbmd0aCAtIDFdLmR1cmF0aW9uO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIG9ubHkgb25lIHNhbXBsZSwgdXNlIHJlZmVyZW5jZSBzYW1wbGUgZHVyYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIHNhbXBsZUR1cmF0aW9uID0gTWF0aC5mbG9vcih0aGlzLl92aWRlb01ldGEucmVmU2FtcGxlRHVyYXRpb24pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGlzS2V5ZnJhbWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN5bmNQb2ludCA9IG5ldyBfbWVkaWFTZWdtZW50SW5mby5TYW1wbGVJbmZvKGR0cywgcHRzLCBzYW1wbGVEdXJhdGlvbiwgX3NhbXBsZTIuZHRzLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgc3luY1BvaW50LmZpbGVwb3NpdGlvbiA9IF9zYW1wbGUyLmZpbGVwb3NpdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgaW5mby5hcHBlbmRTeW5jUG9pbnQoc3luY1BvaW50KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBtcDRTYW1wbGVzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICBkdHM6IGR0cyxcbiAgICAgICAgICAgICAgICAgICAgcHRzOiBwdHMsXG4gICAgICAgICAgICAgICAgICAgIGN0czogY3RzLFxuICAgICAgICAgICAgICAgICAgICB1bml0czogX3NhbXBsZTIudW5pdHMsXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IF9zYW1wbGUyLmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgICAgaXNLZXlmcmFtZTogaXNLZXlmcmFtZSxcbiAgICAgICAgICAgICAgICAgICAgZHVyYXRpb246IHNhbXBsZUR1cmF0aW9uLFxuICAgICAgICAgICAgICAgICAgICBvcmlnaW5hbER0czogb3JpZ2luYWxEdHMsXG4gICAgICAgICAgICAgICAgICAgIGZsYWdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpc0xlYWRpbmc6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZXBlbmRzT246IGlzS2V5ZnJhbWUgPyAyIDogMSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzRGVwZW5kZWRPbjogaXNLZXlmcmFtZSA/IDEgOiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgaGFzUmVkdW5kYW5jeTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzTm9uU3luYzogaXNLZXlmcmFtZSA/IDAgOiAxXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gYWxsb2NhdGUgbWRhdGJveFxuICAgICAgICAgICAgbWRhdGJveCA9IG5ldyBVaW50OEFycmF5KG1kYXRCeXRlcyk7XG4gICAgICAgICAgICBtZGF0Ym94WzBdID0gbWRhdEJ5dGVzID4+PiAyNCAmIDB4RkY7XG4gICAgICAgICAgICBtZGF0Ym94WzFdID0gbWRhdEJ5dGVzID4+PiAxNiAmIDB4RkY7XG4gICAgICAgICAgICBtZGF0Ym94WzJdID0gbWRhdEJ5dGVzID4+PiA4ICYgMHhGRjtcbiAgICAgICAgICAgIG1kYXRib3hbM10gPSBtZGF0Qnl0ZXMgJiAweEZGO1xuICAgICAgICAgICAgbWRhdGJveC5zZXQoX21wNEdlbmVyYXRvcjIuZGVmYXVsdC50eXBlcy5tZGF0LCA0KTtcblxuICAgICAgICAgICAgLy8gV3JpdGUgc2FtcGxlcyBpbnRvIG1kYXRib3hcbiAgICAgICAgICAgIGZvciAodmFyIF9pMiA9IDA7IF9pMiA8IG1wNFNhbXBsZXMubGVuZ3RoOyBfaTIrKykge1xuICAgICAgICAgICAgICAgIHZhciB1bml0cyA9IG1wNFNhbXBsZXNbX2kyXS51bml0cztcbiAgICAgICAgICAgICAgICB3aGlsZSAodW5pdHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1bml0ID0gdW5pdHMuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSB1bml0LmRhdGE7XG4gICAgICAgICAgICAgICAgICAgIG1kYXRib3guc2V0KGRhdGEsIG9mZnNldCk7XG4gICAgICAgICAgICAgICAgICAgIG9mZnNldCArPSBkYXRhLmJ5dGVMZW5ndGg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbGF0ZXN0ID0gbXA0U2FtcGxlc1ttcDRTYW1wbGVzLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgbGFzdER0cyA9IGxhdGVzdC5kdHMgKyBsYXRlc3QuZHVyYXRpb247XG4gICAgICAgICAgICBsYXN0UHRzID0gbGF0ZXN0LnB0cyArIGxhdGVzdC5kdXJhdGlvbjtcbiAgICAgICAgICAgIHRoaXMuX3ZpZGVvTmV4dER0cyA9IGxhc3REdHM7XG5cbiAgICAgICAgICAgIC8vIGZpbGwgbWVkaWEgc2VnbWVudCBpbmZvICYgYWRkIHRvIGluZm8gbGlzdFxuICAgICAgICAgICAgaW5mby5iZWdpbkR0cyA9IGZpcnN0RHRzO1xuICAgICAgICAgICAgaW5mby5lbmREdHMgPSBsYXN0RHRzO1xuICAgICAgICAgICAgaW5mby5iZWdpblB0cyA9IGZpcnN0UHRzO1xuICAgICAgICAgICAgaW5mby5lbmRQdHMgPSBsYXN0UHRzO1xuICAgICAgICAgICAgaW5mby5vcmlnaW5hbEJlZ2luRHRzID0gbXA0U2FtcGxlc1swXS5vcmlnaW5hbER0cztcbiAgICAgICAgICAgIGluZm8ub3JpZ2luYWxFbmREdHMgPSBsYXRlc3Qub3JpZ2luYWxEdHMgKyBsYXRlc3QuZHVyYXRpb247XG4gICAgICAgICAgICBpbmZvLmZpcnN0U2FtcGxlID0gbmV3IF9tZWRpYVNlZ21lbnRJbmZvLlNhbXBsZUluZm8obXA0U2FtcGxlc1swXS5kdHMsIG1wNFNhbXBsZXNbMF0ucHRzLCBtcDRTYW1wbGVzWzBdLmR1cmF0aW9uLCBtcDRTYW1wbGVzWzBdLm9yaWdpbmFsRHRzLCBtcDRTYW1wbGVzWzBdLmlzS2V5ZnJhbWUpO1xuICAgICAgICAgICAgaW5mby5sYXN0U2FtcGxlID0gbmV3IF9tZWRpYVNlZ21lbnRJbmZvLlNhbXBsZUluZm8obGF0ZXN0LmR0cywgbGF0ZXN0LnB0cywgbGF0ZXN0LmR1cmF0aW9uLCBsYXRlc3Qub3JpZ2luYWxEdHMsIGxhdGVzdC5pc0tleWZyYW1lKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5faXNMaXZlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdmlkZW9TZWdtZW50SW5mb0xpc3QuYXBwZW5kKGluZm8pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0cmFjay5zYW1wbGVzID0gbXA0U2FtcGxlcztcbiAgICAgICAgICAgIHRyYWNrLnNlcXVlbmNlTnVtYmVyKys7XG5cbiAgICAgICAgICAgIC8vIHdvcmthcm91bmQgZm9yIGNocm9tZSA8IDUwOiBmb3JjZSBmaXJzdCBzYW1wbGUgYXMgYSByYW5kb20gYWNjZXNzIHBvaW50XG4gICAgICAgICAgICAvLyBzZWUgaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9MjI5NDEyXG4gICAgICAgICAgICBpZiAodGhpcy5fZm9yY2VGaXJzdElEUikge1xuICAgICAgICAgICAgICAgIHZhciBmbGFncyA9IG1wNFNhbXBsZXNbMF0uZmxhZ3M7XG4gICAgICAgICAgICAgICAgZmxhZ3MuZGVwZW5kc09uID0gMjtcbiAgICAgICAgICAgICAgICBmbGFncy5pc05vblN5bmMgPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgbW9vZmJveCA9IF9tcDRHZW5lcmF0b3IyLmRlZmF1bHQubW9vZih0cmFjaywgZmlyc3REdHMpO1xuICAgICAgICAgICAgdHJhY2suc2FtcGxlcyA9IFtdO1xuICAgICAgICAgICAgdHJhY2subGVuZ3RoID0gMDtcblxuICAgICAgICAgICAgdGhpcy5fb25NZWRpYVNlZ21lbnQoJ3ZpZGVvJywge1xuICAgICAgICAgICAgICAgIHR5cGU6ICd2aWRlbycsXG4gICAgICAgICAgICAgICAgZGF0YTogdGhpcy5fbWVyZ2VCb3hlcyhtb29mYm94LCBtZGF0Ym94KS5idWZmZXIsXG4gICAgICAgICAgICAgICAgc2FtcGxlQ291bnQ6IG1wNFNhbXBsZXMubGVuZ3RoLFxuICAgICAgICAgICAgICAgIGluZm86IGluZm9cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfbWVyZ2VCb3hlcycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBfbWVyZ2VCb3hlcyhtb29mLCBtZGF0KSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkobW9vZi5ieXRlTGVuZ3RoICsgbWRhdC5ieXRlTGVuZ3RoKTtcbiAgICAgICAgICAgIHJlc3VsdC5zZXQobW9vZiwgMCk7XG4gICAgICAgICAgICByZXN1bHQuc2V0KG1kYXQsIG1vb2YuYnl0ZUxlbmd0aCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdvbkluaXRTZWdtZW50JyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fb25Jbml0U2VnbWVudDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uSW5pdFNlZ21lbnQgPSBjYWxsYmFjaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIHByb3RvdHlwZTogZnVuY3Rpb24gb25NZWRpYVNlZ21lbnQodHlwZTogc3RyaW5nLCBtZWRpYVNlZ21lbnQ6IE1lZGlhU2VnbWVudCk6IHZvaWRcclxuICAgICAgICAgICBNZWRpYVNlZ21lbnQ6IHtcclxuICAgICAgICAgICAgICAgdHlwZTogc3RyaW5nLFxyXG4gICAgICAgICAgICAgICBkYXRhOiBBcnJheUJ1ZmZlcixcclxuICAgICAgICAgICAgICAgc2FtcGxlQ291bnQ6IGludDMyXHJcbiAgICAgICAgICAgICAgIGluZm86IE1lZGlhU2VnbWVudEluZm9cclxuICAgICAgICAgICB9XHJcbiAgICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnb25NZWRpYVNlZ21lbnQnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9vbk1lZGlhU2VnbWVudDtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIHRoaXMuX29uTWVkaWFTZWdtZW50ID0gY2FsbGJhY2s7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gTVA0UmVtdXhlcjtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gTVA0UmVtdXhlcjtcblxufSx7XCIuLi9jb3JlL21lZGlhLXNlZ21lbnQtaW5mby5qc1wiOjgsXCIuLi91dGlscy9icm93c2VyLmpzXCI6MzksXCIuLi91dGlscy9leGNlcHRpb24uanNcIjo0MCxcIi4uL3V0aWxzL2xvZ2dlci5qc1wiOjQxLFwiLi9hYWMtc2lsZW50LmpzXCI6MzYsXCIuL21wNC1nZW5lcmF0b3IuanNcIjozN31dLDM5OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxudmFyIEJyb3dzZXIgPSB7fTtcblxuZnVuY3Rpb24gZGV0ZWN0KCkge1xuICAgIC8vIG1vZGlmaWVkIGZyb20ganF1ZXJ5LWJyb3dzZXItcGx1Z2luXG5cbiAgICB2YXIgdWEgPSBzZWxmLm5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTtcblxuICAgIHZhciBtYXRjaCA9IC8oZWRnZSlcXC8oW1xcdy5dKykvLmV4ZWModWEpIHx8IC8ob3ByKVtcXC9dKFtcXHcuXSspLy5leGVjKHVhKSB8fCAvKGNocm9tZSlbIFxcL10oW1xcdy5dKykvLmV4ZWModWEpIHx8IC8oaWVtb2JpbGUpW1xcL10oW1xcdy5dKykvLmV4ZWModWEpIHx8IC8odmVyc2lvbikoYXBwbGV3ZWJraXQpWyBcXC9dKFtcXHcuXSspLiooc2FmYXJpKVsgXFwvXShbXFx3Ll0rKS8uZXhlYyh1YSkgfHwgLyh3ZWJraXQpWyBcXC9dKFtcXHcuXSspLioodmVyc2lvbilbIFxcL10oW1xcdy5dKykuKihzYWZhcmkpWyBcXC9dKFtcXHcuXSspLy5leGVjKHVhKSB8fCAvKHdlYmtpdClbIFxcL10oW1xcdy5dKykvLmV4ZWModWEpIHx8IC8ob3BlcmEpKD86Lip2ZXJzaW9ufClbIFxcL10oW1xcdy5dKykvLmV4ZWModWEpIHx8IC8obXNpZSkgKFtcXHcuXSspLy5leGVjKHVhKSB8fCB1YS5pbmRleE9mKCd0cmlkZW50JykgPj0gMCAmJiAvKHJ2KSg/Ojp8ICkoW1xcdy5dKykvLmV4ZWModWEpIHx8IHVhLmluZGV4T2YoJ2NvbXBhdGlibGUnKSA8IDAgJiYgLyhmaXJlZm94KVsgXFwvXShbXFx3Ll0rKS8uZXhlYyh1YSkgfHwgW107XG5cbiAgICB2YXIgcGxhdGZvcm1fbWF0Y2ggPSAvKGlwYWQpLy5leGVjKHVhKSB8fCAvKGlwb2QpLy5leGVjKHVhKSB8fCAvKHdpbmRvd3MgcGhvbmUpLy5leGVjKHVhKSB8fCAvKGlwaG9uZSkvLmV4ZWModWEpIHx8IC8oa2luZGxlKS8uZXhlYyh1YSkgfHwgLyhhbmRyb2lkKS8uZXhlYyh1YSkgfHwgLyh3aW5kb3dzKS8uZXhlYyh1YSkgfHwgLyhtYWMpLy5leGVjKHVhKSB8fCAvKGxpbnV4KS8uZXhlYyh1YSkgfHwgLyhjcm9zKS8uZXhlYyh1YSkgfHwgW107XG5cbiAgICB2YXIgbWF0Y2hlZCA9IHtcbiAgICAgICAgYnJvd3NlcjogbWF0Y2hbNV0gfHwgbWF0Y2hbM10gfHwgbWF0Y2hbMV0gfHwgJycsXG4gICAgICAgIHZlcnNpb246IG1hdGNoWzJdIHx8IG1hdGNoWzRdIHx8ICcwJyxcbiAgICAgICAgbWFqb3JWZXJzaW9uOiBtYXRjaFs0XSB8fCBtYXRjaFsyXSB8fCAnMCcsXG4gICAgICAgIHBsYXRmb3JtOiBwbGF0Zm9ybV9tYXRjaFswXSB8fCAnJ1xuICAgIH07XG5cbiAgICB2YXIgYnJvd3NlciA9IHt9O1xuICAgIGlmIChtYXRjaGVkLmJyb3dzZXIpIHtcbiAgICAgICAgYnJvd3NlclttYXRjaGVkLmJyb3dzZXJdID0gdHJ1ZTtcblxuICAgICAgICB2YXIgdmVyc2lvbkFycmF5ID0gbWF0Y2hlZC5tYWpvclZlcnNpb24uc3BsaXQoJy4nKTtcbiAgICAgICAgYnJvd3Nlci52ZXJzaW9uID0ge1xuICAgICAgICAgICAgbWFqb3I6IHBhcnNlSW50KG1hdGNoZWQubWFqb3JWZXJzaW9uLCAxMCksXG4gICAgICAgICAgICBzdHJpbmc6IG1hdGNoZWQudmVyc2lvblxuICAgICAgICB9O1xuICAgICAgICBpZiAodmVyc2lvbkFycmF5Lmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIGJyb3dzZXIudmVyc2lvbi5taW5vciA9IHBhcnNlSW50KHZlcnNpb25BcnJheVsxXSwgMTApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh2ZXJzaW9uQXJyYXkubGVuZ3RoID4gMikge1xuICAgICAgICAgICAgYnJvd3Nlci52ZXJzaW9uLmJ1aWxkID0gcGFyc2VJbnQodmVyc2lvbkFycmF5WzJdLCAxMCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAobWF0Y2hlZC5wbGF0Zm9ybSkge1xuICAgICAgICBicm93c2VyW21hdGNoZWQucGxhdGZvcm1dID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZiAoYnJvd3Nlci5jaHJvbWUgfHwgYnJvd3Nlci5vcHIgfHwgYnJvd3Nlci5zYWZhcmkpIHtcbiAgICAgICAgYnJvd3Nlci53ZWJraXQgPSB0cnVlO1xuICAgIH1cblxuICAgIC8vIE1TSUUuIElFMTEgaGFzICdydicgaWRlbnRpZmVyXG4gICAgaWYgKGJyb3dzZXIucnYgfHwgYnJvd3Nlci5pZW1vYmlsZSkge1xuICAgICAgICBpZiAoYnJvd3Nlci5ydikge1xuICAgICAgICAgICAgZGVsZXRlIGJyb3dzZXIucnY7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG1zaWUgPSAnbXNpZSc7XG4gICAgICAgIG1hdGNoZWQuYnJvd3NlciA9IG1zaWU7XG4gICAgICAgIGJyb3dzZXJbbXNpZV0gPSB0cnVlO1xuICAgIH1cblxuICAgIC8vIE1pY3Jvc29mdCBFZGdlXG4gICAgaWYgKGJyb3dzZXIuZWRnZSkge1xuICAgICAgICBkZWxldGUgYnJvd3Nlci5lZGdlO1xuICAgICAgICB2YXIgbXNlZGdlID0gJ21zZWRnZSc7XG4gICAgICAgIG1hdGNoZWQuYnJvd3NlciA9IG1zZWRnZTtcbiAgICAgICAgYnJvd3Nlclttc2VkZ2VdID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyBPcGVyYSAxNStcbiAgICBpZiAoYnJvd3Nlci5vcHIpIHtcbiAgICAgICAgdmFyIG9wZXJhID0gJ29wZXJhJztcbiAgICAgICAgbWF0Y2hlZC5icm93c2VyID0gb3BlcmE7XG4gICAgICAgIGJyb3dzZXJbb3BlcmFdID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyBTdG9jayBhbmRyb2lkIGJyb3dzZXJzIGFyZSBtYXJrZWQgYXMgU2FmYXJpXG4gICAgaWYgKGJyb3dzZXIuc2FmYXJpICYmIGJyb3dzZXIuYW5kcm9pZCkge1xuICAgICAgICB2YXIgYW5kcm9pZCA9ICdhbmRyb2lkJztcbiAgICAgICAgbWF0Y2hlZC5icm93c2VyID0gYW5kcm9pZDtcbiAgICAgICAgYnJvd3NlclthbmRyb2lkXSA9IHRydWU7XG4gICAgfVxuXG4gICAgYnJvd3Nlci5uYW1lID0gbWF0Y2hlZC5icm93c2VyO1xuICAgIGJyb3dzZXIucGxhdGZvcm0gPSBtYXRjaGVkLnBsYXRmb3JtO1xuXG4gICAgZm9yICh2YXIga2V5IGluIEJyb3dzZXIpIHtcbiAgICAgICAgaWYgKEJyb3dzZXIuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgZGVsZXRlIEJyb3dzZXJba2V5XTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBPYmplY3QuYXNzaWduKEJyb3dzZXIsIGJyb3dzZXIpO1xufVxuXG5kZXRlY3QoKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gQnJvd3NlcjtcblxufSx7fV0sNDA6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxudmFyIFJ1bnRpbWVFeGNlcHRpb24gPSBleHBvcnRzLlJ1bnRpbWVFeGNlcHRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUnVudGltZUV4Y2VwdGlvbihtZXNzYWdlKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBSdW50aW1lRXhjZXB0aW9uKTtcblxuICAgICAgICB0aGlzLl9tZXNzYWdlID0gbWVzc2FnZTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoUnVudGltZUV4Y2VwdGlvbiwgW3tcbiAgICAgICAga2V5OiAndG9TdHJpbmcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdG9TdHJpbmcoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5uYW1lICsgJzogJyArIHRoaXMubWVzc2FnZTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbmFtZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuICdSdW50aW1lRXhjZXB0aW9uJztcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnbWVzc2FnZScsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21lc3NhZ2U7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gUnVudGltZUV4Y2VwdGlvbjtcbn0oKTtcblxudmFyIElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiA9IGV4cG9ydHMuSWxsZWdhbFN0YXRlRXhjZXB0aW9uID0gZnVuY3Rpb24gKF9SdW50aW1lRXhjZXB0aW9uKSB7XG4gICAgX2luaGVyaXRzKElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiwgX1J1bnRpbWVFeGNlcHRpb24pO1xuXG4gICAgZnVuY3Rpb24gSWxsZWdhbFN0YXRlRXhjZXB0aW9uKG1lc3NhZ2UpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIElsbGVnYWxTdGF0ZUV4Y2VwdGlvbik7XG5cbiAgICAgICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIChJbGxlZ2FsU3RhdGVFeGNlcHRpb24uX19wcm90b19fIHx8IE9iamVjdC5nZXRQcm90b3R5cGVPZihJbGxlZ2FsU3RhdGVFeGNlcHRpb24pKS5jYWxsKHRoaXMsIG1lc3NhZ2UpKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoSWxsZWdhbFN0YXRlRXhjZXB0aW9uLCBbe1xuICAgICAgICBrZXk6ICduYW1lJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ0lsbGVnYWxTdGF0ZUV4Y2VwdGlvbic7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gSWxsZWdhbFN0YXRlRXhjZXB0aW9uO1xufShSdW50aW1lRXhjZXB0aW9uKTtcblxudmFyIEludmFsaWRBcmd1bWVudEV4Y2VwdGlvbiA9IGV4cG9ydHMuSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uID0gZnVuY3Rpb24gKF9SdW50aW1lRXhjZXB0aW9uMikge1xuICAgIF9pbmhlcml0cyhJbnZhbGlkQXJndW1lbnRFeGNlcHRpb24sIF9SdW50aW1lRXhjZXB0aW9uMik7XG5cbiAgICBmdW5jdGlvbiBJbnZhbGlkQXJndW1lbnRFeGNlcHRpb24obWVzc2FnZSkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uKTtcblxuICAgICAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKEludmFsaWRBcmd1bWVudEV4Y2VwdGlvbi5fX3Byb3RvX18gfHwgT2JqZWN0LmdldFByb3RvdHlwZU9mKEludmFsaWRBcmd1bWVudEV4Y2VwdGlvbikpLmNhbGwodGhpcywgbWVzc2FnZSkpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhJbnZhbGlkQXJndW1lbnRFeGNlcHRpb24sIFt7XG4gICAgICAgIGtleTogJ25hbWUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiAnSW52YWxpZEFyZ3VtZW50RXhjZXB0aW9uJztcbiAgICAgICAgfVxuICAgIH1dKTtcblxuICAgIHJldHVybiBJbnZhbGlkQXJndW1lbnRFeGNlcHRpb247XG59KFJ1bnRpbWVFeGNlcHRpb24pO1xuXG52YXIgTm90SW1wbGVtZW50ZWRFeGNlcHRpb24gPSBleHBvcnRzLk5vdEltcGxlbWVudGVkRXhjZXB0aW9uID0gZnVuY3Rpb24gKF9SdW50aW1lRXhjZXB0aW9uMykge1xuICAgIF9pbmhlcml0cyhOb3RJbXBsZW1lbnRlZEV4Y2VwdGlvbiwgX1J1bnRpbWVFeGNlcHRpb24zKTtcblxuICAgIGZ1bmN0aW9uIE5vdEltcGxlbWVudGVkRXhjZXB0aW9uKG1lc3NhZ2UpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE5vdEltcGxlbWVudGVkRXhjZXB0aW9uKTtcblxuICAgICAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgKE5vdEltcGxlbWVudGVkRXhjZXB0aW9uLl9fcHJvdG9fXyB8fCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoTm90SW1wbGVtZW50ZWRFeGNlcHRpb24pKS5jYWxsKHRoaXMsIG1lc3NhZ2UpKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoTm90SW1wbGVtZW50ZWRFeGNlcHRpb24sIFt7XG4gICAgICAgIGtleTogJ25hbWUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiAnTm90SW1wbGVtZW50ZWRFeGNlcHRpb24nO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIE5vdEltcGxlbWVudGVkRXhjZXB0aW9uO1xufShSdW50aW1lRXhjZXB0aW9uKTtcblxufSx7fV0sNDE6W2Z1bmN0aW9uKF9kZXJlcV8sbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7IC8qXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBDb3B5cmlnaHQgKEMpIDIwMTYgQmlsaWJpbGkuIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGF1dGhvciB6aGVuZyBxaWFuIDx4cXFAeHFxLmltPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgX2V2ZW50cyA9IF9kZXJlcV8oJ2V2ZW50cycpO1xuXG52YXIgX2V2ZW50czIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9ldmVudHMpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgTG9nID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIExvZygpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExvZyk7XG4gICAgfVxuXG4gICAgX2NyZWF0ZUNsYXNzKExvZywgbnVsbCwgW3tcbiAgICAgICAga2V5OiAnZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBlKHRhZywgbXNnKSB7XG4gICAgICAgICAgICBpZiAoIXRhZyB8fCBMb2cuRk9SQ0VfR0xPQkFMX1RBRykgdGFnID0gTG9nLkdMT0JBTF9UQUc7XG5cbiAgICAgICAgICAgIHZhciBzdHIgPSAnWycgKyB0YWcgKyAnXSA+ICcgKyBtc2c7XG5cbiAgICAgICAgICAgIGlmIChMb2cuRU5BQkxFX0NBTExCQUNLKSB7XG4gICAgICAgICAgICAgICAgTG9nLmVtaXR0ZXIuZW1pdCgnbG9nJywgJ2Vycm9yJywgc3RyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFMb2cuRU5BQkxFX0VSUk9SKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY29uc29sZS5lcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3Ioc3RyKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoY29uc29sZS53YXJuKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKHN0cik7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0cik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2knLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaSh0YWcsIG1zZykge1xuICAgICAgICAgICAgaWYgKCF0YWcgfHwgTG9nLkZPUkNFX0dMT0JBTF9UQUcpIHRhZyA9IExvZy5HTE9CQUxfVEFHO1xuXG4gICAgICAgICAgICB2YXIgc3RyID0gJ1snICsgdGFnICsgJ10gPiAnICsgbXNnO1xuXG4gICAgICAgICAgICBpZiAoTG9nLkVOQUJMRV9DQUxMQkFDSykge1xuICAgICAgICAgICAgICAgIExvZy5lbWl0dGVyLmVtaXQoJ2xvZycsICdpbmZvJywgc3RyKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFMb2cuRU5BQkxFX0lORk8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjb25zb2xlLmluZm8pIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oc3RyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coc3RyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAndycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiB3KHRhZywgbXNnKSB7XG4gICAgICAgICAgICBpZiAoIXRhZyB8fCBMb2cuRk9SQ0VfR0xPQkFMX1RBRykgdGFnID0gTG9nLkdMT0JBTF9UQUc7XG5cbiAgICAgICAgICAgIHZhciBzdHIgPSAnWycgKyB0YWcgKyAnXSA+ICcgKyBtc2c7XG5cbiAgICAgICAgICAgIGlmIChMb2cuRU5BQkxFX0NBTExCQUNLKSB7XG4gICAgICAgICAgICAgICAgTG9nLmVtaXR0ZXIuZW1pdCgnbG9nJywgJ3dhcm4nLCBzdHIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIUxvZy5FTkFCTEVfV0FSTikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNvbnNvbGUud2Fybikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihzdHIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzdHIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdkJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGQodGFnLCBtc2cpIHtcbiAgICAgICAgICAgIGlmICghdGFnIHx8IExvZy5GT1JDRV9HTE9CQUxfVEFHKSB0YWcgPSBMb2cuR0xPQkFMX1RBRztcblxuICAgICAgICAgICAgdmFyIHN0ciA9ICdbJyArIHRhZyArICddID4gJyArIG1zZztcblxuICAgICAgICAgICAgaWYgKExvZy5FTkFCTEVfQ0FMTEJBQ0spIHtcbiAgICAgICAgICAgICAgICBMb2cuZW1pdHRlci5lbWl0KCdsb2cnLCAnZGVidWcnLCBzdHIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIUxvZy5FTkFCTEVfREVCVUcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjb25zb2xlLmRlYnVnKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhzdHIpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzdHIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICd2JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHYodGFnLCBtc2cpIHtcbiAgICAgICAgICAgIGlmICghdGFnIHx8IExvZy5GT1JDRV9HTE9CQUxfVEFHKSB0YWcgPSBMb2cuR0xPQkFMX1RBRztcblxuICAgICAgICAgICAgdmFyIHN0ciA9ICdbJyArIHRhZyArICddID4gJyArIG1zZztcblxuICAgICAgICAgICAgaWYgKExvZy5FTkFCTEVfQ0FMTEJBQ0spIHtcbiAgICAgICAgICAgICAgICBMb2cuZW1pdHRlci5lbWl0KCdsb2cnLCAndmVyYm9zZScsIHN0cik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghTG9nLkVOQUJMRV9WRVJCT1NFKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzdHIpO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIExvZztcbn0oKTtcblxuTG9nLkdMT0JBTF9UQUcgPSAnZmx2LmpzJztcbkxvZy5GT1JDRV9HTE9CQUxfVEFHID0gZmFsc2U7XG5Mb2cuRU5BQkxFX0VSUk9SID0gdHJ1ZTtcbkxvZy5FTkFCTEVfSU5GTyA9IHRydWU7XG5Mb2cuRU5BQkxFX1dBUk4gPSB0cnVlO1xuTG9nLkVOQUJMRV9ERUJVRyA9IHRydWU7XG5Mb2cuRU5BQkxFX1ZFUkJPU0UgPSB0cnVlO1xuXG5Mb2cuRU5BQkxFX0NBTExCQUNLID0gZmFsc2U7XG5cbkxvZy5lbWl0dGVyID0gbmV3IF9ldmVudHMyLmRlZmF1bHQoKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gTG9nO1xuXG59LHtcImV2ZW50c1wiOjJ9XSw0MjpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTsgLypcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIENvcHlyaWdodCAoQykgMjAxNiBCaWxpYmlsaS4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBfZXZlbnRzID0gX2RlcmVxXygnZXZlbnRzJyk7XG5cbnZhciBfZXZlbnRzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2V2ZW50cyk7XG5cbnZhciBfbG9nZ2VyID0gX2RlcmVxXygnLi9sb2dnZXIuanMnKTtcblxudmFyIF9sb2dnZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbG9nZ2VyKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIExvZ2dpbmdDb250cm9sID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIExvZ2dpbmdDb250cm9sKCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTG9nZ2luZ0NvbnRyb2wpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhMb2dnaW5nQ29udHJvbCwgbnVsbCwgW3tcbiAgICAgICAga2V5OiAnZ2V0Q29uZmlnJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvbmZpZygpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZ2xvYmFsVGFnOiBfbG9nZ2VyMi5kZWZhdWx0LkdMT0JBTF9UQUcsXG4gICAgICAgICAgICAgICAgZm9yY2VHbG9iYWxUYWc6IF9sb2dnZXIyLmRlZmF1bHQuRk9SQ0VfR0xPQkFMX1RBRyxcbiAgICAgICAgICAgICAgICBlbmFibGVWZXJib3NlOiBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9WRVJCT1NFLFxuICAgICAgICAgICAgICAgIGVuYWJsZURlYnVnOiBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9ERUJVRyxcbiAgICAgICAgICAgICAgICBlbmFibGVJbmZvOiBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9JTkZPLFxuICAgICAgICAgICAgICAgIGVuYWJsZVdhcm46IF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX1dBUk4sXG4gICAgICAgICAgICAgICAgZW5hYmxlRXJyb3I6IF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0VSUk9SLFxuICAgICAgICAgICAgICAgIGVuYWJsZUNhbGxiYWNrOiBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9DQUxMQkFDS1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnYXBwbHlDb25maWcnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYXBwbHlDb25maWcoY29uZmlnKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkdMT0JBTF9UQUcgPSBjb25maWcuZ2xvYmFsVGFnO1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5GT1JDRV9HTE9CQUxfVEFHID0gY29uZmlnLmZvcmNlR2xvYmFsVGFnO1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfVkVSQk9TRSA9IGNvbmZpZy5lbmFibGVWZXJib3NlO1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfREVCVUcgPSBjb25maWcuZW5hYmxlRGVidWc7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9JTkZPID0gY29uZmlnLmVuYWJsZUluZm87XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9XQVJOID0gY29uZmlnLmVuYWJsZVdhcm47XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9FUlJPUiA9IGNvbmZpZy5lbmFibGVFcnJvcjtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0NBTExCQUNLID0gY29uZmlnLmVuYWJsZUNhbGxiYWNrO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdfbm90aWZ5Q2hhbmdlJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIF9ub3RpZnlDaGFuZ2UoKSB7XG4gICAgICAgICAgICB2YXIgZW1pdHRlciA9IExvZ2dpbmdDb250cm9sLmVtaXR0ZXI7XG5cbiAgICAgICAgICAgIGlmIChlbWl0dGVyLmxpc3RlbmVyQ291bnQoJ2NoYW5nZScpID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBjb25maWcgPSBMb2dnaW5nQ29udHJvbC5nZXRDb25maWcoKTtcbiAgICAgICAgICAgICAgICBlbWl0dGVyLmVtaXQoJ2NoYW5nZScsIGNvbmZpZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlZ2lzdGVyTGlzdGVuZXInLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVnaXN0ZXJMaXN0ZW5lcihsaXN0ZW5lcikge1xuICAgICAgICAgICAgTG9nZ2luZ0NvbnRyb2wuZW1pdHRlci5hZGRMaXN0ZW5lcignY2hhbmdlJywgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZW1vdmVMaXN0ZW5lcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiByZW1vdmVMaXN0ZW5lcihsaXN0ZW5lcikge1xuICAgICAgICAgICAgTG9nZ2luZ0NvbnRyb2wuZW1pdHRlci5yZW1vdmVMaXN0ZW5lcignY2hhbmdlJywgbGlzdGVuZXIpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhZGRMb2dMaXN0ZW5lcicsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRMb2dMaXN0ZW5lcihsaXN0ZW5lcikge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5lbWl0dGVyLmFkZExpc3RlbmVyKCdsb2cnLCBsaXN0ZW5lcik7XG4gICAgICAgICAgICBpZiAoX2xvZ2dlcjIuZGVmYXVsdC5lbWl0dGVyLmxpc3RlbmVyQ291bnQoJ2xvZycpID4gMCkge1xuICAgICAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0NBTExCQUNLID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBMb2dnaW5nQ29udHJvbC5fbm90aWZ5Q2hhbmdlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3JlbW92ZUxvZ0xpc3RlbmVyJyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZUxvZ0xpc3RlbmVyKGxpc3RlbmVyKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LmVtaXR0ZXIucmVtb3ZlTGlzdGVuZXIoJ2xvZycsIGxpc3RlbmVyKTtcbiAgICAgICAgICAgIGlmIChfbG9nZ2VyMi5kZWZhdWx0LmVtaXR0ZXIubGlzdGVuZXJDb3VudCgnbG9nJykgPT09IDApIHtcbiAgICAgICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9DQUxMQkFDSyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIExvZ2dpbmdDb250cm9sLl9ub3RpZnlDaGFuZ2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZm9yY2VHbG9iYWxUYWcnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiBfbG9nZ2VyMi5kZWZhdWx0LkZPUkNFX0dMT0JBTF9UQUc7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KGVuYWJsZSkge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5GT1JDRV9HTE9CQUxfVEFHID0gZW5hYmxlO1xuICAgICAgICAgICAgTG9nZ2luZ0NvbnRyb2wuX25vdGlmeUNoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdnbG9iYWxUYWcnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiBfbG9nZ2VyMi5kZWZhdWx0LkdMT0JBTF9UQUc7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gc2V0KHRhZykge1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5HTE9CQUxfVEFHID0gdGFnO1xuICAgICAgICAgICAgTG9nZ2luZ0NvbnRyb2wuX25vdGlmeUNoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdlbmFibGVBbGwnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9WRVJCT1NFICYmIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0RFQlVHICYmIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0lORk8gJiYgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfV0FSTiAmJiBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9FUlJPUjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZW5hYmxlKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9WRVJCT1NFID0gZW5hYmxlO1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfREVCVUcgPSBlbmFibGU7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9JTkZPID0gZW5hYmxlO1xuICAgICAgICAgICAgX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfV0FSTiA9IGVuYWJsZTtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0VSUk9SID0gZW5hYmxlO1xuICAgICAgICAgICAgTG9nZ2luZ0NvbnRyb2wuX25vdGlmeUNoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdlbmFibGVEZWJ1ZycsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0RFQlVHO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChlbmFibGUpIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0RFQlVHID0gZW5hYmxlO1xuICAgICAgICAgICAgTG9nZ2luZ0NvbnRyb2wuX25vdGlmeUNoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdlbmFibGVWZXJib3NlJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfVkVSQk9TRTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZW5hYmxlKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9WRVJCT1NFID0gZW5hYmxlO1xuICAgICAgICAgICAgTG9nZ2luZ0NvbnRyb2wuX25vdGlmeUNoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdlbmFibGVJbmZvJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfSU5GTztcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZW5hYmxlKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9JTkZPID0gZW5hYmxlO1xuICAgICAgICAgICAgTG9nZ2luZ0NvbnRyb2wuX25vdGlmeUNoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdlbmFibGVXYXJuJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gX2xvZ2dlcjIuZGVmYXVsdC5FTkFCTEVfV0FSTjtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiBzZXQoZW5hYmxlKSB7XG4gICAgICAgICAgICBfbG9nZ2VyMi5kZWZhdWx0LkVOQUJMRV9XQVJOID0gZW5hYmxlO1xuICAgICAgICAgICAgTG9nZ2luZ0NvbnRyb2wuX25vdGlmeUNoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdlbmFibGVFcnJvcicsXG4gICAgICAgIGdldDogZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgcmV0dXJuIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0VSUk9SO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIHNldChlbmFibGUpIHtcbiAgICAgICAgICAgIF9sb2dnZXIyLmRlZmF1bHQuRU5BQkxFX0VSUk9SID0gZW5hYmxlO1xuICAgICAgICAgICAgTG9nZ2luZ0NvbnRyb2wuX25vdGlmeUNoYW5nZSgpO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIExvZ2dpbmdDb250cm9sO1xufSgpO1xuXG5Mb2dnaW5nQ29udHJvbC5lbWl0dGVyID0gbmV3IF9ldmVudHMyLmRlZmF1bHQoKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gTG9nZ2luZ0NvbnRyb2w7XG5cbn0se1wiLi9sb2dnZXIuanNcIjo0MSxcImV2ZW50c1wiOjJ9XSw0MzpbZnVuY3Rpb24oX2RlcmVxXyxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBAYXV0aG9yIHpoZW5nIHFpYW4gPHhxcUB4cXEuaW0+XHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cblxudmFyIFBvbHlmaWxsID0gZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFBvbHlmaWxsKCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUG9seWZpbGwpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhQb2x5ZmlsbCwgbnVsbCwgW3tcbiAgICAgICAga2V5OiAnaW5zdGFsbCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbnN0YWxsKCkge1xuICAgICAgICAgICAgLy8gRVM2IE9iamVjdC5zZXRQcm90b3R5cGVPZlxuICAgICAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8IGZ1bmN0aW9uIChvYmosIHByb3RvKSB7XG4gICAgICAgICAgICAgICAgb2JqLl9fcHJvdG9fXyA9IHByb3RvO1xuICAgICAgICAgICAgICAgIHJldHVybiBvYmo7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBFUzYgT2JqZWN0LmFzc2lnblxuICAgICAgICAgICAgT2JqZWN0LmFzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24gKHRhcmdldCkge1xuICAgICAgICAgICAgICAgIGlmICh0YXJnZXQgPT09IHVuZGVmaW5lZCB8fCB0YXJnZXQgPT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNvbnZlcnQgdW5kZWZpbmVkIG9yIG51bGwgdG8gb2JqZWN0Jyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IE9iamVjdCh0YXJnZXQpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChzb3VyY2UgIT09IHVuZGVmaW5lZCAmJiBzb3VyY2UgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBzb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoc291cmNlLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0W2tleV0gPSBzb3VyY2Vba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIEVTNiBQcm9taXNlIChtaXNzaW5nIHN1cHBvcnQgaW4gSUUxMSlcbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc2VsZi5Qcm9taXNlICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgICAgX2RlcmVxXygnZXM2LXByb21pc2UnKS5wb2x5ZmlsbCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIFBvbHlmaWxsO1xufSgpO1xuXG5Qb2x5ZmlsbC5pbnN0YWxsKCk7XG5cbmV4cG9ydHMuZGVmYXVsdCA9IFBvbHlmaWxsO1xuXG59LHtcImVzNi1wcm9taXNlXCI6MX1dLDQ0OltmdW5jdGlvbihfZGVyZXFfLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gICAgdmFsdWU6IHRydWVcbn0pO1xuLypcclxuICogQ29weXJpZ2h0IChDKSAyMDE2IEJpbGliaWxpLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxyXG4gKlxyXG4gKiBUaGlzIGZpbGUgaXMgZGVyaXZlZCBmcm9tIEMrKyBwcm9qZWN0IGxpYldpblRGOCAoaHR0cHM6Ly9naXRodWIuY29tL20xMzI1My9saWJXaW5URjgpXHJcbiAqIEBhdXRob3IgemhlbmcgcWlhbiA8eHFxQHhxcS5pbT5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xuXG5mdW5jdGlvbiBjaGVja0NvbnRpbnVhdGlvbih1aW50OGFycmF5LCBzdGFydCwgY2hlY2tMZW5ndGgpIHtcbiAgICB2YXIgYXJyYXkgPSB1aW50OGFycmF5O1xuICAgIGlmIChzdGFydCArIGNoZWNrTGVuZ3RoIDwgYXJyYXkubGVuZ3RoKSB7XG4gICAgICAgIHdoaWxlIChjaGVja0xlbmd0aC0tKSB7XG4gICAgICAgICAgICBpZiAoKGFycmF5Wysrc3RhcnRdICYgMHhDMCkgIT09IDB4ODApIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkZWNvZGVVVEY4KHVpbnQ4YXJyYXkpIHtcbiAgICB2YXIgb3V0ID0gW107XG4gICAgdmFyIGlucHV0ID0gdWludDhhcnJheTtcbiAgICB2YXIgaSA9IDA7XG4gICAgdmFyIGxlbmd0aCA9IHVpbnQ4YXJyYXkubGVuZ3RoO1xuXG4gICAgd2hpbGUgKGkgPCBsZW5ndGgpIHtcbiAgICAgICAgaWYgKGlucHV0W2ldIDwgMHg4MCkge1xuICAgICAgICAgICAgb3V0LnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZShpbnB1dFtpXSkpO1xuICAgICAgICAgICAgKytpO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH0gZWxzZSBpZiAoaW5wdXRbaV0gPCAweEMwKSB7XG4gICAgICAgICAgICAvLyBmYWxsdGhyb3VnaFxuICAgICAgICB9IGVsc2UgaWYgKGlucHV0W2ldIDwgMHhFMCkge1xuICAgICAgICAgICAgaWYgKGNoZWNrQ29udGludWF0aW9uKGlucHV0LCBpLCAxKSkge1xuICAgICAgICAgICAgICAgIHZhciB1Y3M0ID0gKGlucHV0W2ldICYgMHgxRikgPDwgNiB8IGlucHV0W2kgKyAxXSAmIDB4M0Y7XG4gICAgICAgICAgICAgICAgaWYgKHVjczQgPj0gMHg4MCkge1xuICAgICAgICAgICAgICAgICAgICBvdXQucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKHVjczQgJiAweEZGRkYpKTtcbiAgICAgICAgICAgICAgICAgICAgaSArPSAyO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoaW5wdXRbaV0gPCAweEYwKSB7XG4gICAgICAgICAgICBpZiAoY2hlY2tDb250aW51YXRpb24oaW5wdXQsIGksIDIpKSB7XG4gICAgICAgICAgICAgICAgdmFyIF91Y3MgPSAoaW5wdXRbaV0gJiAweEYpIDw8IDEyIHwgKGlucHV0W2kgKyAxXSAmIDB4M0YpIDw8IDYgfCBpbnB1dFtpICsgMl0gJiAweDNGO1xuICAgICAgICAgICAgICAgIGlmIChfdWNzID49IDB4ODAwICYmIChfdWNzICYgMHhGODAwKSAhPT0gMHhEODAwKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dC5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoX3VjcyAmIDB4RkZGRikpO1xuICAgICAgICAgICAgICAgICAgICBpICs9IDM7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChpbnB1dFtpXSA8IDB4RjgpIHtcbiAgICAgICAgICAgIGlmIChjaGVja0NvbnRpbnVhdGlvbihpbnB1dCwgaSwgMykpIHtcbiAgICAgICAgICAgICAgICB2YXIgX3VjczIgPSAoaW5wdXRbaV0gJiAweDcpIDw8IDE4IHwgKGlucHV0W2kgKyAxXSAmIDB4M0YpIDw8IDEyIHwgKGlucHV0W2kgKyAyXSAmIDB4M0YpIDw8IDYgfCBpbnB1dFtpICsgM10gJiAweDNGO1xuICAgICAgICAgICAgICAgIGlmIChfdWNzMiA+IDB4MTAwMDAgJiYgX3VjczIgPCAweDExMDAwMCkge1xuICAgICAgICAgICAgICAgICAgICBfdWNzMiAtPSAweDEwMDAwO1xuICAgICAgICAgICAgICAgICAgICBvdXQucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKF91Y3MyID4+PiAxMCB8IDB4RDgwMCkpO1xuICAgICAgICAgICAgICAgICAgICBvdXQucHVzaChTdHJpbmcuZnJvbUNoYXJDb2RlKF91Y3MyICYgMHgzRkYgfCAweERDMDApKTtcbiAgICAgICAgICAgICAgICAgICAgaSArPSA0O1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgb3V0LnB1c2goU3RyaW5nLmZyb21DaGFyQ29kZSgweEZGRkQpKTtcbiAgICAgICAgKytpO1xuICAgIH1cblxuICAgIHJldHVybiBvdXQuam9pbignJyk7XG59XG5cbmV4cG9ydHMuZGVmYXVsdCA9IGRlY29kZVVURjg7XG5cbn0se31dfSx7fSxbMjFdKSgyMSlcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1mbHYuanMubWFwXG4iLCIvKlxubXAz57yW56CB5Zmo55So5Yiw55qEbGFtZWpz57yW56CB5byV5pOO77yM5LiA6Iis6YO955SoTVAz5qC85byP77yM5rWP6KeI5Zmo5pSv5oyB5bm/5rOb77yM5q2k5byV5pOO5rWL6K+V55qE5Lmf5q+U6L6D5aSa77yM56iz5a6aXG5odHRwczovL2dpdGh1Yi5jb20veGlhbmd5dWVjbi9SZWNvcmRlclxuKi9cbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbi8vZW5kMiAqKioq5byA5aeLY29weSBsYW1lanMqKioqKlxuLypcbm1wM+e8lueggeS+nei1lmxhbWVqc++8jOWmguaenOaXoOmcgG1wM+aUr+aMgeebtOaOpeenu+mZpOatpOS7o+eggVxuaHR0cHM6Ly9naXRodWIuY29tL3podWtlci9sYW1lanMvYmxvYi9iZmI3ZjZjNmQ3ODc3ZTBmZTFhZDllNzI2OTdhODcxNjc2MTE5YTBlL2xhbWUuYWxsLmpzXG4qL1xuXG5mdW5jdGlvbiBsYW1lanMoKSB7XG52YXIgTWF0aF9sb2cxMD1mdW5jdGlvbihzKXsvL+WdmuWGs+S4jeiDveeUqOS5n+S4jeimgeaKpeivreiogOmXrumimOeahOmUmeivr1xuXHRyZXR1cm4gTWF0aC5sb2cocykvTWF0aC5sb2coMTApO1xufTtcblxuZnVuY3Rpb24gbmV3X2J5dGUoY291bnQpIHtcbiAgICByZXR1cm4gbmV3IEludDhBcnJheShjb3VudCk7XG59XG5cbmZ1bmN0aW9uIG5ld19zaG9ydChjb3VudCkge1xuICAgIHJldHVybiBuZXcgSW50MTZBcnJheShjb3VudCk7XG59XG5cbmZ1bmN0aW9uIG5ld19pbnQoY291bnQpIHtcbiAgICByZXR1cm4gbmV3IEludDMyQXJyYXkoY291bnQpO1xufVxuXG5mdW5jdGlvbiBuZXdfZmxvYXQoY291bnQpIHtcbiAgICByZXR1cm4gbmV3IEZsb2F0MzJBcnJheShjb3VudCk7XG59XG5cbmZ1bmN0aW9uIG5ld19kb3VibGUoY291bnQpIHtcbiAgICByZXR1cm4gbmV3IEZsb2F0NjRBcnJheShjb3VudCk7XG59XG5cbmZ1bmN0aW9uIG5ld19mbG9hdF9uKGFyZ3MpIHtcbiAgICBpZiAoYXJncy5sZW5ndGggPT0gMSkge1xuICAgICAgICByZXR1cm4gbmV3X2Zsb2F0KGFyZ3NbMF0pO1xuICAgIH1cbiAgICB2YXIgc3ogPSBhcmdzWzBdO1xuICAgIGFyZ3MgPSBhcmdzLnNsaWNlKDEpO1xuICAgIHZhciBBID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzejsgaSsrKSB7XG4gICAgICAgIEEucHVzaChuZXdfZmxvYXRfbihhcmdzKSk7XG4gICAgfVxuICAgIHJldHVybiBBO1xufVxuZnVuY3Rpb24gbmV3X2ludF9uKGFyZ3MpIHtcbiAgICBpZiAoYXJncy5sZW5ndGggPT0gMSkge1xuICAgICAgICByZXR1cm4gbmV3X2ludChhcmdzWzBdKTtcbiAgICB9XG4gICAgdmFyIHN6ID0gYXJnc1swXTtcbiAgICBhcmdzID0gYXJncy5zbGljZSgxKTtcbiAgICB2YXIgQSA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3o7IGkrKykge1xuICAgICAgICBBLnB1c2gobmV3X2ludF9uKGFyZ3MpKTtcbiAgICB9XG4gICAgcmV0dXJuIEE7XG59XG5cbmZ1bmN0aW9uIG5ld19zaG9ydF9uKGFyZ3MpIHtcbiAgICBpZiAoYXJncy5sZW5ndGggPT0gMSkge1xuICAgICAgICByZXR1cm4gbmV3X3Nob3J0KGFyZ3NbMF0pO1xuICAgIH1cbiAgICB2YXIgc3ogPSBhcmdzWzBdO1xuICAgIGFyZ3MgPSBhcmdzLnNsaWNlKDEpO1xuICAgIHZhciBBID0gW107XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzejsgaSsrKSB7XG4gICAgICAgIEEucHVzaChuZXdfc2hvcnRfbihhcmdzKSk7XG4gICAgfVxuICAgIHJldHVybiBBO1xufVxuXG5mdW5jdGlvbiBuZXdfYXJyYXlfbihhcmdzKSB7XG4gICAgaWYgKGFyZ3MubGVuZ3RoID09IDEpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBBcnJheShhcmdzWzBdKTtcbiAgICB9XG4gICAgdmFyIHN6ID0gYXJnc1swXTtcbiAgICBhcmdzID0gYXJncy5zbGljZSgxKTtcbiAgICB2YXIgQSA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3o7IGkrKykge1xuICAgICAgICBBLnB1c2gobmV3X2FycmF5X24oYXJncykpO1xuICAgIH1cbiAgICByZXR1cm4gQTtcbn1cblxuXG52YXIgQXJyYXlzID0ge307XG5cbkFycmF5cy5maWxsID0gZnVuY3Rpb24gKGEsIGZyb21JbmRleCwgdG9JbmRleCwgdmFsKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gMikge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGFbaV0gPSBhcmd1bWVudHNbMV07XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBmb3IgKHZhciBpID0gZnJvbUluZGV4OyBpIDwgdG9JbmRleDsgaSsrKSB7XG4gICAgICAgICAgICBhW2ldID0gdmFsO1xuICAgICAgICB9XG4gICAgfVxufTtcblxudmFyIFN5c3RlbSA9IHt9O1xuXG5TeXN0ZW0uYXJyYXljb3B5ID0gZnVuY3Rpb24gKHNyYywgc3JjUG9zLCBkZXN0LCBkZXN0UG9zLCBsZW5ndGgpIHtcbiAgICB2YXIgc3JjRW5kID0gc3JjUG9zICsgbGVuZ3RoO1xuICAgIHdoaWxlIChzcmNQb3MgPCBzcmNFbmQpXG4gICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IHNyY1tzcmNQb3MrK107XG59O1xuXG5cbnZhciBVdGlsID0ge307XG5VdGlsLlNRUlQyID0gMS40MTQyMTM1NjIzNzMwOTUwNDg4MDtcblV0aWwuRkFTVF9MT0cxMCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgcmV0dXJuIE1hdGhfbG9nMTAoeCk7XG59O1xuXG5VdGlsLkZBU1RfTE9HMTBfWCA9IGZ1bmN0aW9uICh4LCB5KSB7XG4gICAgcmV0dXJuIE1hdGhfbG9nMTAoeCkgKiB5O1xufTtcblxuZnVuY3Rpb24gU2hvcnRCbG9jayhvcmRpbmFsKSB7XG4gICAgdGhpcy5vcmRpbmFsID0gb3JkaW5hbDtcbn1cbi8qKlxuICogTEFNRSBtYXkgdXNlIHRoZW0sIGV2ZW4gZGlmZmVyZW50IGJsb2NrIHR5cGVzIGZvciBML1IuXG4gKi9cblNob3J0QmxvY2suc2hvcnRfYmxvY2tfYWxsb3dlZCA9IG5ldyBTaG9ydEJsb2NrKDApO1xuLyoqXG4gKiBMQU1FIG1heSB1c2UgdGhlbSwgYnV0IGFsd2F5cyBzYW1lIGJsb2NrIHR5cGVzIGluIEwvUi5cbiAqL1xuU2hvcnRCbG9jay5zaG9ydF9ibG9ja19jb3VwbGVkID0gbmV3IFNob3J0QmxvY2soMSk7XG4vKipcbiAqIExBTUUgd2lsbCBub3QgdXNlIHNob3J0IGJsb2NrcywgbG9uZyBibG9ja3Mgb25seS5cbiAqL1xuU2hvcnRCbG9jay5zaG9ydF9ibG9ja19kaXNwZW5zZWQgPSBuZXcgU2hvcnRCbG9jaygyKTtcbi8qKlxuICogTEFNRSB3aWxsIG5vdCB1c2UgbG9uZyBibG9ja3MsIHNob3J0IGJsb2NrcyBvbmx5LlxuICovXG5TaG9ydEJsb2NrLnNob3J0X2Jsb2NrX2ZvcmNlZCA9IG5ldyBTaG9ydEJsb2NrKDMpO1xuXG52YXIgRmxvYXQgPSB7fTtcbkZsb2F0Lk1BWF9WQUxVRSA9IDMuNDAyODIzNWUrMzg7XG5cbmZ1bmN0aW9uIFZick1vZGUob3JkaW5hbCkge1xuICAgIHRoaXMub3JkaW5hbCA9IG9yZGluYWw7XG59XG5WYnJNb2RlLnZicl9vZmYgPSBuZXcgVmJyTW9kZSgwKTtcblZick1vZGUudmJyX210ID0gbmV3IFZick1vZGUoMSk7XG5WYnJNb2RlLnZicl9yaCA9IG5ldyBWYnJNb2RlKDIpO1xuVmJyTW9kZS52YnJfYWJyID0gbmV3IFZick1vZGUoMyk7XG5WYnJNb2RlLnZicl9tdHJoID0gbmV3IFZick1vZGUoNCk7XG5WYnJNb2RlLnZicl9kZWZhdWx0ID0gVmJyTW9kZS52YnJfbXRyaDtcblxudmFyIGFzc2VydCA9IGZ1bmN0aW9uICh4KSB7XG4gICAgLy9jb25zb2xlLmFzc2VydCh4KTtcbn07XG5cbnZhciBtb2R1bGVfZXhwb3J0cyA9IHtcbiAgICBcIlN5c3RlbVwiOiBTeXN0ZW0sXG4gICAgXCJWYnJNb2RlXCI6IFZick1vZGUsXG4gICAgXCJGbG9hdFwiOiBGbG9hdCxcbiAgICBcIlNob3J0QmxvY2tcIjogU2hvcnRCbG9jayxcbiAgICBcIlV0aWxcIjogVXRpbCxcbiAgICBcIkFycmF5c1wiOiBBcnJheXMsXG4gICAgXCJuZXdfYXJyYXlfblwiOiBuZXdfYXJyYXlfbixcbiAgICBcIm5ld19ieXRlXCI6IG5ld19ieXRlLFxuICAgIFwibmV3X2RvdWJsZVwiOiBuZXdfZG91YmxlLFxuICAgIFwibmV3X2Zsb2F0XCI6IG5ld19mbG9hdCxcbiAgICBcIm5ld19mbG9hdF9uXCI6IG5ld19mbG9hdF9uLFxuICAgIFwibmV3X2ludFwiOiBuZXdfaW50LFxuICAgIFwibmV3X2ludF9uXCI6IG5ld19pbnRfbixcbiAgICBcIm5ld19zaG9ydFwiOiBuZXdfc2hvcnQsXG4gICAgXCJuZXdfc2hvcnRfblwiOiBuZXdfc2hvcnRfbixcbiAgICBcImFzc2VydFwiOiBhc3NlcnRcbn07XG4vL3BhY2thZ2UgbXAzO1xuXG4vKiBNUEVHIG1vZGVzICovXG5mdW5jdGlvbiBNUEVHTW9kZShvcmRpbmFsKSB7XG4gICAgdmFyIF9vcmRpbmFsID0gb3JkaW5hbDtcbiAgICB0aGlzLm9yZGluYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfb3JkaW5hbDtcbiAgICB9XG59XG5cbk1QRUdNb2RlLlNURVJFTyA9IG5ldyBNUEVHTW9kZSgwKTtcbk1QRUdNb2RlLkpPSU5UX1NURVJFTyA9IG5ldyBNUEVHTW9kZSgxKTtcbk1QRUdNb2RlLkRVQUxfQ0hBTk5FTCA9IG5ldyBNUEVHTW9kZSgyKTtcbk1QRUdNb2RlLk1PTk8gPSBuZXcgTVBFR01vZGUoMyk7XG5NUEVHTW9kZS5OT1RfU0VUID0gbmV3IE1QRUdNb2RlKDQpO1xuXG5mdW5jdGlvbiBWZXJzaW9uKCkge1xuXG4gICAgLyoqXG4gICAgICogVVJMIGZvciB0aGUgTEFNRSB3ZWJzaXRlLlxuICAgICAqL1xuICAgIHZhciBMQU1FX1VSTCA9IFwiaHR0cDovL3d3dy5tcDNkZXYub3JnL1wiO1xuXG4gICAgLyoqXG4gICAgICogTWFqb3IgdmVyc2lvbiBudW1iZXIuXG4gICAgICovXG4gICAgdmFyIExBTUVfTUFKT1JfVkVSU0lPTiA9IDM7XG4gICAgLyoqXG4gICAgICogTWlub3IgdmVyc2lvbiBudW1iZXIuXG4gICAgICovXG4gICAgdmFyIExBTUVfTUlOT1JfVkVSU0lPTiA9IDk4O1xuICAgIC8qKlxuICAgICAqIFBhdGNoIGxldmVsLlxuICAgICAqL1xuICAgIHZhciBMQU1FX1BBVENIX1ZFUlNJT04gPSA0O1xuXG4gICAgLyoqXG4gICAgICogTWFqb3IgdmVyc2lvbiBudW1iZXIuXG4gICAgICovXG4gICAgdmFyIFBTWV9NQUpPUl9WRVJTSU9OID0gMDtcbiAgICAvKipcbiAgICAgKiBNaW5vciB2ZXJzaW9uIG51bWJlci5cbiAgICAgKi9cbiAgICB2YXIgUFNZX01JTk9SX1ZFUlNJT04gPSA5MztcblxuICAgIC8qKlxuICAgICAqIEEgc3RyaW5nIHdoaWNoIGRlc2NyaWJlcyB0aGUgdmVyc2lvbiBvZiBMQU1FLlxuICAgICAqXG4gICAgICogQHJldHVybiBzdHJpbmcgd2hpY2ggZGVzY3JpYmVzIHRoZSB2ZXJzaW9uIG9mIExBTUVcbiAgICAgKi9cbiAgICB0aGlzLmdldExhbWVWZXJzaW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBwcmltYXJ5IHRvIHdyaXRlIHNjcmVlbiByZXBvcnRzXG4gICAgICAgIHJldHVybiAoTEFNRV9NQUpPUl9WRVJTSU9OICsgXCIuXCIgKyBMQU1FX01JTk9SX1ZFUlNJT04gKyBcIi5cIiArIExBTUVfUEFUQ0hfVkVSU0lPTik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGhlIHNob3J0IHZlcnNpb24gb2YgdGhlIExBTUUgdmVyc2lvbiBzdHJpbmcuXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIHNob3J0IHZlcnNpb24gb2YgdGhlIExBTUUgdmVyc2lvbiBzdHJpbmdcbiAgICAgKi9cbiAgICB0aGlzLmdldExhbWVTaG9ydFZlcnNpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIEFkZGluZyBkYXRlIGFuZCB0aW1lIHRvIHZlcnNpb24gc3RyaW5nIG1ha2VzIGl0IGhhcmRlciBmb3Igb3V0cHV0XG4gICAgICAgIC8vIHZhbGlkYXRpb25cbiAgICAgICAgcmV0dXJuIChMQU1FX01BSk9SX1ZFUlNJT04gKyBcIi5cIiArIExBTUVfTUlOT1JfVkVSU0lPTiArIFwiLlwiICsgTEFNRV9QQVRDSF9WRVJTSU9OKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaGUgc2hvcnRlc3QgdmVyc2lvbiBvZiB0aGUgTEFNRSB2ZXJzaW9uIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEByZXR1cm4gc2hvcnRlc3QgdmVyc2lvbiBvZiB0aGUgTEFNRSB2ZXJzaW9uIHN0cmluZ1xuICAgICAqL1xuICAgIHRoaXMuZ2V0TGFtZVZlcnlTaG9ydFZlcnNpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIEFkZGluZyBkYXRlIGFuZCB0aW1lIHRvIHZlcnNpb24gc3RyaW5nIG1ha2VzIGl0IGhhcmRlciBmb3Igb3V0cHV0XG4gICAgICAgIHJldHVybiAoXCJMQU1FXCIgKyBMQU1FX01BSk9SX1ZFUlNJT04gKyBcIi5cIiArIExBTUVfTUlOT1JfVkVSU0lPTiArIFwiclwiKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdHJpbmcgd2hpY2ggZGVzY3JpYmVzIHRoZSB2ZXJzaW9uIG9mIEdQU1lDSE9cbiAgICAgKlxuICAgICAqIEByZXR1cm4gc3RyaW5nIHdoaWNoIGRlc2NyaWJlcyB0aGUgdmVyc2lvbiBvZiBHUFNZQ0hPXG4gICAgICovXG4gICAgdGhpcy5nZXRQc3lWZXJzaW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKFBTWV9NQUpPUl9WRVJTSU9OICsgXCIuXCIgKyBQU1lfTUlOT1JfVkVSU0lPTik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3RyaW5nIHdoaWNoIGlzIGEgVVJMIGZvciB0aGUgTEFNRSB3ZWJzaXRlLlxuICAgICAqXG4gICAgICogQHJldHVybiBzdHJpbmcgd2hpY2ggaXMgYSBVUkwgZm9yIHRoZSBMQU1FIHdlYnNpdGVcbiAgICAgKi9cbiAgICB0aGlzLmdldExhbWVVcmwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBMQU1FX1VSTDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBRdWl0ZSB1c2VsZXNzIGZvciBhIGphdmEgdmVyc2lvbiwgaG93ZXZlciB3ZSBhcmUgY29tcGF0aWJsZSA7LSlcbiAgICAgKlxuICAgICAqIEByZXR1cm4gXCIzMmJpdHNcIlxuICAgICAqL1xuICAgIHRoaXMuZ2V0TGFtZU9zQml0bmVzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFwiMzJiaXRzXCI7XG4gICAgfVxuXG59XG5cbi8qXG4gKlx0TVAzIGh1ZmZtYW4gdGFibGUgc2VsZWN0aW5nIGFuZCBiaXQgY291bnRpbmdcbiAqXG4gKlx0Q29weXJpZ2h0IChjKSAxOTk5LTIwMDUgVGFrZWhpcm8gVE9NSU5BR0FcbiAqXHRDb3B5cmlnaHQgKGMpIDIwMDItMjAwNSBHYWJyaWVsIEJvdXZpZ25lXG4gKlxuICogVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vclxuICogbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpY1xuICogTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyXG4gKiB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG4gKlxuICogVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG4gKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLlx0IFNlZSB0aGUgR05VXG4gKiBMaWJyYXJ5IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cbiAqXG4gKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG4gKiBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHdyaXRlIHRvIHRoZVxuICogRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBJbmMuLCA1OSBUZW1wbGUgUGxhY2UgLSBTdWl0ZSAzMzAsXG4gKiBCb3N0b24sIE1BIDAyMTExLTEzMDcsIFVTQS5cbiAqL1xuXG4vKiAkSWQ6IFRha2VoaXJvLmphdmEsdiAxLjI2IDIwMTEvMDUvMjQgMjA6NDg6MDYga2VuY2hpcyBFeHAgJCAqL1xuXG4vL3BhY2thZ2UgbXAzO1xuXG4vL2ltcG9ydCBqYXZhLnV0aWwuQXJyYXlzO1xuXG5cblxuZnVuY3Rpb24gVGFrZWhpcm8oKSB7XG5cbiAgICB2YXIgcXVwdnQgPSBudWxsO1xuICAgIHRoaXMucXVwdnQgPSBudWxsO1xuXG4gICAgdGhpcy5zZXRNb2R1bGVzID0gZnVuY3Rpb24gKF9xdXB2dCkge1xuICAgICAgICB0aGlzLnF1cHZ0ID0gX3F1cHZ0O1xuICAgICAgICBxdXB2dCA9IF9xdXB2dDtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBCaXRzKGIpIHtcbiAgICAgICAgdGhpcy5iaXRzID0gMCB8IGI7XG4gICAgfVxuXG4gICAgdmFyIHN1YmR2X3RhYmxlID0gW1swLCAwXSwgLyogMCBiYW5kcyAqL1xuICAgICAgICBbMCwgMF0sIC8qIDEgYmFuZHMgKi9cbiAgICAgICAgWzAsIDBdLCAvKiAyIGJhbmRzICovXG4gICAgICAgIFswLCAwXSwgLyogMyBiYW5kcyAqL1xuICAgICAgICBbMCwgMF0sIC8qIDQgYmFuZHMgKi9cbiAgICAgICAgWzAsIDFdLCAvKiA1IGJhbmRzICovXG4gICAgICAgIFsxLCAxXSwgLyogNiBiYW5kcyAqL1xuICAgICAgICBbMSwgMV0sIC8qIDcgYmFuZHMgKi9cbiAgICAgICAgWzEsIDJdLCAvKiA4IGJhbmRzICovXG4gICAgICAgIFsyLCAyXSwgLyogOSBiYW5kcyAqL1xuICAgICAgICBbMiwgM10sIC8qIDEwIGJhbmRzICovXG4gICAgICAgIFsyLCAzXSwgLyogMTEgYmFuZHMgKi9cbiAgICAgICAgWzMsIDRdLCAvKiAxMiBiYW5kcyAqL1xuICAgICAgICBbMywgNF0sIC8qIDEzIGJhbmRzICovXG4gICAgICAgIFszLCA0XSwgLyogMTQgYmFuZHMgKi9cbiAgICAgICAgWzQsIDVdLCAvKiAxNSBiYW5kcyAqL1xuICAgICAgICBbNCwgNV0sIC8qIDE2IGJhbmRzICovXG4gICAgICAgIFs0LCA2XSwgLyogMTcgYmFuZHMgKi9cbiAgICAgICAgWzUsIDZdLCAvKiAxOCBiYW5kcyAqL1xuICAgICAgICBbNSwgNl0sIC8qIDE5IGJhbmRzICovXG4gICAgICAgIFs1LCA3XSwgLyogMjAgYmFuZHMgKi9cbiAgICAgICAgWzYsIDddLCAvKiAyMSBiYW5kcyAqL1xuICAgICAgICBbNiwgN10sIC8qIDIyIGJhbmRzICovXG4gICAgXTtcblxuXG4gICAgLyoqXG4gICAgICogbm9ubGluZWFyIHF1YW50aXphdGlvbiBvZiB4ciBNb3JlIGFjY3VyYXRlIGZvcm11bGEgdGhhbiB0aGUgSVNPIGZvcm11bGEuXG4gICAgICogVGFrZXMgaW50byBhY2NvdW50IHRoZSBmYWN0IHRoYXQgd2UgYXJlIHF1YW50aXppbmcgeHIgLiBpeCwgYnV0IHdlIHdhbnRcbiAgICAgKiBpeF40LzMgdG8gYmUgYXMgY2xvc2UgYXMgcG9zc2libGUgdG8geF40LzMuICh0YWtpbmcgdGhlIG5lYXJlc3QgaW50IHdvdWxkXG4gICAgICogbWVhbiBpeCBpcyBhcyBjbG9zZSBhcyBwb3NzaWJsZSB0byB4ciwgd2hpY2ggaXMgZGlmZmVyZW50LilcbiAgICAgKlxuICAgICAqIEZyb20gU2VnaGVyIEJvZXNzZW5rb29sIDxzZWdoZXJAZWFzdHNpdGUubmw+IDExLzE5OTlcbiAgICAgKlxuICAgICAqIDA5LzIwMDA6IEFTTSBjb2RlIHJlbW92ZWQgaW4gZmF2b3Igb2YgSUVFRTc1NCBoYWNrIGJ5IFRha2VoaXJvIFRvbWluYWdhLlxuICAgICAqIElmIHlvdSBuZWVkIHRoZSBBU00gY29kZSwgY2hlY2sgQ1ZTIGNpcmNhIEF1ZyAyMDAwLlxuICAgICAqXG4gICAgICogMDEvMjAwNDogT3B0aW1pemF0aW9ucyBieSBHYWJyaWVsIEJvdXZpZ25lXG4gICAgICovXG4gICAgZnVuY3Rpb24gcXVhbnRpemVfbGluZXNfeHJwb3dfMDEobCwgaXN0ZXAsIHhyLCB4clBvcywgaXgsIGl4UG9zKSB7XG4gICAgICAgIHZhciBjb21wYXJldmFsMCA9ICgxLjAgLSAwLjQwNTQpIC8gaXN0ZXA7XG5cbiAgICAgICAgbCA9IGwgPj4gMTtcbiAgICAgICAgd2hpbGUgKChsLS0pICE9IDApIHtcbiAgICAgICAgICAgIGl4W2l4UG9zKytdID0gKGNvbXBhcmV2YWwwID4geHJbeHJQb3MrK10pID8gMCA6IDE7XG4gICAgICAgICAgICBpeFtpeFBvcysrXSA9IChjb21wYXJldmFsMCA+IHhyW3hyUG9zKytdKSA/IDAgOiAxO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogWFJQT1dfRlRPSSBpcyBhIG1hY3JvIHRvIGNvbnZlcnQgZmxvYXRzIHRvIGludHMuPEJSPlxuICAgICAqIGlmIFhSUE9XX0ZUT0koeCkgPSBuZWFyZXN0X2ludCh4KSwgdGhlbiBRVUFOVEZBQyh4KT1hZGo0M2FzbVt4XTxCUj5cbiAgICAgKiBST1VOREZBQz0gLTAuMDk0NjxCUj5cbiAgICAgKlxuICAgICAqIGlmIFhSUE9XX0ZUT0koeCkgPSBmbG9vcih4KSwgdGhlbiBRVUFOVEZBQyh4KT1hc2o0M1t4XTxCUj5cbiAgICAgKiBST1VOREZBQz0wLjQwNTQ8QlI+XG4gICAgICpcbiAgICAgKiBOb3RlOiB1c2luZyBmbG9vcigpIG9yIDB8IGlzIGV4dHJlbWVseSBzbG93LiBPbiBtYWNoaW5lcyB3aGVyZSB0aGVcbiAgICAgKiBUQUtFSElST19JRUVFNzU0X0hBQ0sgY29kZSBhYm92ZSBkb2VzIG5vdCB3b3JrLCBpdCBpcyB3b3J0aHdpbGUgdG8gd3JpdGVcbiAgICAgKiBzb21lIEFTTSBmb3IgWFJQT1dfRlRPSSgpLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHF1YW50aXplX2xpbmVzX3hycG93KGwsIGlzdGVwLCB4ciwgeHJQb3MsIGl4LCBpeFBvcykge1xuXG4gICAgICAgIGwgPSBsID4+IDE7XG4gICAgICAgIHZhciByZW1haW5pbmcgPSBsICUgMjtcbiAgICAgICAgbCA9IGwgPj4gMTtcbiAgICAgICAgd2hpbGUgKGwtLSAhPSAwKSB7XG4gICAgICAgICAgICB2YXIgeDAsIHgxLCB4MiwgeDM7XG4gICAgICAgICAgICB2YXIgcngwLCByeDEsIHJ4MiwgcngzO1xuXG4gICAgICAgICAgICB4MCA9IHhyW3hyUG9zKytdICogaXN0ZXA7XG4gICAgICAgICAgICB4MSA9IHhyW3hyUG9zKytdICogaXN0ZXA7XG4gICAgICAgICAgICByeDAgPSAwIHwgeDA7XG4gICAgICAgICAgICB4MiA9IHhyW3hyUG9zKytdICogaXN0ZXA7XG4gICAgICAgICAgICByeDEgPSAwIHwgeDE7XG4gICAgICAgICAgICB4MyA9IHhyW3hyUG9zKytdICogaXN0ZXA7XG4gICAgICAgICAgICByeDIgPSAwIHwgeDI7XG4gICAgICAgICAgICB4MCArPSBxdXB2dC5hZGo0M1tyeDBdO1xuICAgICAgICAgICAgcngzID0gMCB8IHgzO1xuICAgICAgICAgICAgeDEgKz0gcXVwdnQuYWRqNDNbcngxXTtcbiAgICAgICAgICAgIGl4W2l4UG9zKytdID0gMCB8IHgwO1xuICAgICAgICAgICAgeDIgKz0gcXVwdnQuYWRqNDNbcngyXTtcbiAgICAgICAgICAgIGl4W2l4UG9zKytdID0gMCB8IHgxO1xuICAgICAgICAgICAgeDMgKz0gcXVwdnQuYWRqNDNbcngzXTtcbiAgICAgICAgICAgIGl4W2l4UG9zKytdID0gMCB8IHgyO1xuICAgICAgICAgICAgaXhbaXhQb3MrK10gPSAwIHwgeDM7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlbWFpbmluZyAhPSAwKSB7XG4gICAgICAgICAgICB2YXIgeDAsIHgxO1xuICAgICAgICAgICAgdmFyIHJ4MCwgcngxO1xuXG4gICAgICAgICAgICB4MCA9IHhyW3hyUG9zKytdICogaXN0ZXA7XG4gICAgICAgICAgICB4MSA9IHhyW3hyUG9zKytdICogaXN0ZXA7XG4gICAgICAgICAgICByeDAgPSAwIHwgeDA7XG4gICAgICAgICAgICByeDEgPSAwIHwgeDE7XG4gICAgICAgICAgICB4MCArPSBxdXB2dC5hZGo0M1tyeDBdO1xuICAgICAgICAgICAgeDEgKz0gcXVwdnQuYWRqNDNbcngxXTtcbiAgICAgICAgICAgIGl4W2l4UG9zKytdID0gMCB8IHgwO1xuICAgICAgICAgICAgaXhbaXhQb3MrK10gPSAwIHwgeDE7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBRdWFudGl6YXRpb24gZnVuY3Rpb24gVGhpcyBmdW5jdGlvbiB3aWxsIHNlbGVjdCB3aGljaCBsaW5lcyB0byBxdWFudGl6ZVxuICAgICAqIGFuZCBjYWxsIHRoZSBwcm9wZXIgcXVhbnRpemF0aW9uIGZ1bmN0aW9uXG4gICAgICovXG4gICAgZnVuY3Rpb24gcXVhbnRpemVfeHJwb3coeHAsIHBpLCBpc3RlcCwgY29kSW5mbywgcHJldk5vaXNlKSB7XG4gICAgICAgIC8qIHF1YW50aXplIG9uIHhyXigzLzQpIGluc3RlYWQgb2YgeHIgKi9cbiAgICAgICAgdmFyIHNmYjtcbiAgICAgICAgdmFyIHNmYm1heDtcbiAgICAgICAgdmFyIGogPSAwO1xuICAgICAgICB2YXIgcHJldl9kYXRhX3VzZTtcbiAgICAgICAgdmFyIGFjY3VtdWxhdGUgPSAwO1xuICAgICAgICB2YXIgYWNjdW11bGF0ZTAxID0gMDtcbiAgICAgICAgdmFyIHhwUG9zID0gMDtcbiAgICAgICAgdmFyIGlEYXRhID0gcGk7XG4gICAgICAgIHZhciBpRGF0YVBvcyA9IDA7XG4gICAgICAgIHZhciBhY2NfaURhdGEgPSBpRGF0YTtcbiAgICAgICAgdmFyIGFjY19pRGF0YVBvcyA9IDA7XG4gICAgICAgIHZhciBhY2NfeHAgPSB4cDtcbiAgICAgICAgdmFyIGFjY194cFBvcyA9IDA7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogUmV1c2luZyBwcmV2aW91c2x5IGNvbXB1dGVkIGRhdGEgZG9lcyBub3Qgc2VlbXMgdG8gd29yayBpZiBnbG9iYWxcbiAgICAgICAgICogZ2FpbiBpcyBjaGFuZ2VkLiBGaW5kaW5nIHdoeSBpdCBiZWhhdmVzIHRoaXMgd2F5IHdvdWxkIGFsbG93IHRvIHVzZSBhXG4gICAgICAgICAqIGNhY2hlIG9mIHByZXZpb3VzbHkgY29tcHV0ZWQgdmFsdWVzIChsZXQncyAxMCBjYWNoZWQgdmFsdWVzIHBlciBzZmIpXG4gICAgICAgICAqIHRoYXQgd291bGQgcHJvYmFibHkgcHJvdmlkZSBhIG5vdGljZWFibGUgc3BlZWR1cFxuICAgICAgICAgKi9cbiAgICAgICAgcHJldl9kYXRhX3VzZSA9IChwcmV2Tm9pc2UgIT0gbnVsbCAmJiAoY29kSW5mby5nbG9iYWxfZ2FpbiA9PSBwcmV2Tm9pc2UuZ2xvYmFsX2dhaW4pKTtcblxuICAgICAgICBpZiAoY29kSW5mby5ibG9ja190eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRSlcbiAgICAgICAgICAgIHNmYm1heCA9IDM4O1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBzZmJtYXggPSAyMTtcblxuICAgICAgICBmb3IgKHNmYiA9IDA7IHNmYiA8PSBzZmJtYXg7IHNmYisrKSB7XG4gICAgICAgICAgICB2YXIgc3RlcCA9IC0xO1xuXG4gICAgICAgICAgICBpZiAocHJldl9kYXRhX3VzZSB8fCBjb2RJbmZvLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5OT1JNX1RZUEUpIHtcbiAgICAgICAgICAgICAgICBzdGVwID0gY29kSW5mby5nbG9iYWxfZ2FpblxuICAgICAgICAgICAgICAgICAgICAtICgoY29kSW5mby5zY2FsZWZhY1tzZmJdICsgKGNvZEluZm8ucHJlZmxhZyAhPSAwID8gcXVwdnQucHJldGFiW3NmYl1cbiAgICAgICAgICAgICAgICAgICAgICAgIDogMCkpIDw8IChjb2RJbmZvLnNjYWxlZmFjX3NjYWxlICsgMSkpXG4gICAgICAgICAgICAgICAgICAgIC0gY29kSW5mby5zdWJibG9ja19nYWluW2NvZEluZm8ud2luZG93W3NmYl1dICogODtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChwcmV2X2RhdGFfdXNlICYmIChwcmV2Tm9pc2Uuc3RlcFtzZmJdID09IHN0ZXApKSB7XG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBkbyBub3QgcmVjb21wdXRlIHRoaXMgcGFydCwgYnV0IGNvbXB1dGUgYWNjdW11bGF0ZWQgbGluZXNcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAoYWNjdW11bGF0ZSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHF1YW50aXplX2xpbmVzX3hycG93KGFjY3VtdWxhdGUsIGlzdGVwLCBhY2NfeHAsIGFjY194cFBvcyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY19pRGF0YSwgYWNjX2lEYXRhUG9zKTtcbiAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChhY2N1bXVsYXRlMDEgIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBxdWFudGl6ZV9saW5lc194cnBvd18wMShhY2N1bXVsYXRlMDEsIGlzdGVwLCBhY2NfeHAsXG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NfeHBQb3MsIGFjY19pRGF0YSwgYWNjX2lEYXRhUG9zKTtcbiAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZTAxID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgeyAvKiBzaG91bGQgY29tcHV0ZSB0aGlzIHBhcnQgKi9cbiAgICAgICAgICAgICAgICB2YXIgbCA9IGNvZEluZm8ud2lkdGhbc2ZiXTtcblxuICAgICAgICAgICAgICAgIGlmICgoaiArIGNvZEluZm8ud2lkdGhbc2ZiXSkgPiBjb2RJbmZvLm1heF9ub256ZXJvX2NvZWZmKSB7XG4gICAgICAgICAgICAgICAgICAgIC8qIGRvIG5vdCBjb21wdXRlIHVwcGVyIHplcm8gcGFydCAqL1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXNlZnVsbHNpemU7XG4gICAgICAgICAgICAgICAgICAgIHVzZWZ1bGxzaXplID0gY29kSW5mby5tYXhfbm9uemVyb19jb2VmZiAtIGogKyAxO1xuICAgICAgICAgICAgICAgICAgICBBcnJheXMuZmlsbChwaSwgY29kSW5mby5tYXhfbm9uemVyb19jb2VmZiwgNTc2LCAwKTtcbiAgICAgICAgICAgICAgICAgICAgbCA9IHVzZWZ1bGxzaXplO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChsIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbCA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvKiBubyBuZWVkIHRvIGNvbXB1dGUgaGlnaGVyIHNmYiB2YWx1ZXMgKi9cbiAgICAgICAgICAgICAgICAgICAgc2ZiID0gc2ZibWF4ICsgMTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvKiBhY2N1bXVsYXRlIGxpbmVzIHRvIHF1YW50aXplICovXG4gICAgICAgICAgICAgICAgaWYgKDAgPT0gYWNjdW11bGF0ZSAmJiAwID09IGFjY3VtdWxhdGUwMSkge1xuICAgICAgICAgICAgICAgICAgICBhY2NfaURhdGEgPSBpRGF0YTtcbiAgICAgICAgICAgICAgICAgICAgYWNjX2lEYXRhUG9zID0gaURhdGFQb3M7XG4gICAgICAgICAgICAgICAgICAgIGFjY194cCA9IHhwO1xuICAgICAgICAgICAgICAgICAgICBhY2NfeHBQb3MgPSB4cFBvcztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHByZXZOb2lzZSAhPSBudWxsICYmIHByZXZOb2lzZS5zZmJfY291bnQxID4gMFxuICAgICAgICAgICAgICAgICAgICAmJiBzZmIgPj0gcHJldk5vaXNlLnNmYl9jb3VudDFcbiAgICAgICAgICAgICAgICAgICAgJiYgcHJldk5vaXNlLnN0ZXBbc2ZiXSA+IDBcbiAgICAgICAgICAgICAgICAgICAgJiYgc3RlcCA+PSBwcmV2Tm9pc2Uuc3RlcFtzZmJdKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGFjY3VtdWxhdGUgIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcXVhbnRpemVfbGluZXNfeHJwb3coYWNjdW11bGF0ZSwgaXN0ZXAsIGFjY194cCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY2NfeHBQb3MsIGFjY19pRGF0YSwgYWNjX2lEYXRhUG9zKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY3VtdWxhdGUgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjX2lEYXRhID0gaURhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NfaURhdGFQb3MgPSBpRGF0YVBvcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY194cCA9IHhwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjX3hwUG9zID0geHBQb3M7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZTAxICs9IGw7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFjY3VtdWxhdGUwMSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl6ZV9saW5lc194cnBvd18wMShhY2N1bXVsYXRlMDEsIGlzdGVwLCBhY2NfeHAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjX3hwUG9zLCBhY2NfaURhdGEsIGFjY19pRGF0YVBvcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlMDEgPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjX2lEYXRhID0gaURhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2NfaURhdGFQb3MgPSBpRGF0YVBvcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjY194cCA9IHhwO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjX3hwUG9zID0geHBQb3M7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYWNjdW11bGF0ZSArPSBsO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChsIDw9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICogcmg6IDIwMDQwMjE1IG1heSBoYXBwZW4gZHVlIHRvIFwicHJldl9kYXRhX3VzZVwiXG4gICAgICAgICAgICAgICAgICAgICAqIG9wdGltaXphdGlvblxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgaWYgKGFjY3VtdWxhdGUwMSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBxdWFudGl6ZV9saW5lc194cnBvd18wMShhY2N1bXVsYXRlMDEsIGlzdGVwLCBhY2NfeHAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjX3hwUG9zLCBhY2NfaURhdGEsIGFjY19pRGF0YVBvcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlMDEgPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGlmIChhY2N1bXVsYXRlICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHF1YW50aXplX2xpbmVzX3hycG93KGFjY3VtdWxhdGUsIGlzdGVwLCBhY2NfeHAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWNjX3hwUG9zLCBhY2NfaURhdGEsIGFjY19pRGF0YVBvcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY2N1bXVsYXRlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAvKiBlbmRzIGZvci1sb29wICovXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNmYiA8PSBzZmJtYXgpIHtcbiAgICAgICAgICAgICAgICBpRGF0YVBvcyArPSBjb2RJbmZvLndpZHRoW3NmYl07XG4gICAgICAgICAgICAgICAgeHBQb3MgKz0gY29kSW5mby53aWR0aFtzZmJdO1xuICAgICAgICAgICAgICAgIGogKz0gY29kSW5mby53aWR0aFtzZmJdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChhY2N1bXVsYXRlICE9IDApIHsgLyogbGFzdCBkYXRhIHBhcnQgKi9cbiAgICAgICAgICAgIHF1YW50aXplX2xpbmVzX3hycG93KGFjY3VtdWxhdGUsIGlzdGVwLCBhY2NfeHAsIGFjY194cFBvcyxcbiAgICAgICAgICAgICAgICBhY2NfaURhdGEsIGFjY19pRGF0YVBvcyk7XG4gICAgICAgICAgICBhY2N1bXVsYXRlID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYWNjdW11bGF0ZTAxICE9IDApIHsgLyogbGFzdCBkYXRhIHBhcnQgKi9cbiAgICAgICAgICAgIHF1YW50aXplX2xpbmVzX3hycG93XzAxKGFjY3VtdWxhdGUwMSwgaXN0ZXAsIGFjY194cCwgYWNjX3hwUG9zLFxuICAgICAgICAgICAgICAgIGFjY19pRGF0YSwgYWNjX2lEYXRhUG9zKTtcbiAgICAgICAgICAgIGFjY3VtdWxhdGUwMSA9IDA7XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGl4X21heFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGl4X21heChpeCwgaXhQb3MsIGVuZFBvcykge1xuICAgICAgICB2YXIgbWF4MSA9IDAsIG1heDIgPSAwO1xuXG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIHZhciB4MSA9IGl4W2l4UG9zKytdO1xuICAgICAgICAgICAgdmFyIHgyID0gaXhbaXhQb3MrK107XG4gICAgICAgICAgICBpZiAobWF4MSA8IHgxKVxuICAgICAgICAgICAgICAgIG1heDEgPSB4MTtcblxuICAgICAgICAgICAgaWYgKG1heDIgPCB4MilcbiAgICAgICAgICAgICAgICBtYXgyID0geDI7XG4gICAgICAgIH0gd2hpbGUgKGl4UG9zIDwgZW5kUG9zKTtcbiAgICAgICAgaWYgKG1heDEgPCBtYXgyKVxuICAgICAgICAgICAgbWF4MSA9IG1heDI7XG4gICAgICAgIHJldHVybiBtYXgxO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvdW50X2JpdF9FU0MoaXgsIGl4UG9zLCBlbmQsIHQxLCB0Miwgcykge1xuICAgICAgICAvKiBFU0MtdGFibGUgaXMgdXNlZCAqL1xuICAgICAgICB2YXIgbGluYml0cyA9IFRhYmxlcy5odFt0MV0ueGxlbiAqIDY1NTM2ICsgVGFibGVzLmh0W3QyXS54bGVuO1xuICAgICAgICB2YXIgc3VtID0gMCwgc3VtMjtcblxuICAgICAgICBkbyB7XG4gICAgICAgICAgICB2YXIgeCA9IGl4W2l4UG9zKytdO1xuICAgICAgICAgICAgdmFyIHkgPSBpeFtpeFBvcysrXTtcblxuICAgICAgICAgICAgaWYgKHggIT0gMCkge1xuICAgICAgICAgICAgICAgIGlmICh4ID4gMTQpIHtcbiAgICAgICAgICAgICAgICAgICAgeCA9IDE1O1xuICAgICAgICAgICAgICAgICAgICBzdW0gKz0gbGluYml0cztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgeCAqPSAxNjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHkgIT0gMCkge1xuICAgICAgICAgICAgICAgIGlmICh5ID4gMTQpIHtcbiAgICAgICAgICAgICAgICAgICAgeSA9IDE1O1xuICAgICAgICAgICAgICAgICAgICBzdW0gKz0gbGluYml0cztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgeCArPSB5O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBzdW0gKz0gVGFibGVzLmxhcmdldGJsW3hdO1xuICAgICAgICB9IHdoaWxlIChpeFBvcyA8IGVuZCk7XG5cbiAgICAgICAgc3VtMiA9IHN1bSAmIDB4ZmZmZjtcbiAgICAgICAgc3VtID4+PSAxNjtcblxuICAgICAgICBpZiAoc3VtID4gc3VtMikge1xuICAgICAgICAgICAgc3VtID0gc3VtMjtcbiAgICAgICAgICAgIHQxID0gdDI7XG4gICAgICAgIH1cblxuICAgICAgICBzLmJpdHMgKz0gc3VtO1xuICAgICAgICByZXR1cm4gdDE7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY291bnRfYml0X25vRVNDKGl4LCBpeFBvcywgZW5kLCBzKSB7XG4gICAgICAgIC8qIE5vIEVTQy13b3JkcyAqL1xuICAgICAgICB2YXIgc3VtMSA9IDA7XG4gICAgICAgIHZhciBobGVuMSA9IFRhYmxlcy5odFsxXS5obGVuO1xuXG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIHZhciB4ID0gaXhbaXhQb3MgKyAwXSAqIDIgKyBpeFtpeFBvcyArIDFdO1xuICAgICAgICAgICAgaXhQb3MgKz0gMjtcbiAgICAgICAgICAgIHN1bTEgKz0gaGxlbjFbeF07XG4gICAgICAgIH0gd2hpbGUgKGl4UG9zIDwgZW5kKTtcblxuICAgICAgICBzLmJpdHMgKz0gc3VtMTtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gY291bnRfYml0X25vRVNDX2Zyb20yKGl4LCBpeFBvcywgZW5kLCB0MSwgcykge1xuICAgICAgICAvKiBObyBFU0Mtd29yZHMgKi9cbiAgICAgICAgdmFyIHN1bSA9IDAsIHN1bTI7XG4gICAgICAgIHZhciB4bGVuID0gVGFibGVzLmh0W3QxXS54bGVuO1xuICAgICAgICB2YXIgaGxlbjtcbiAgICAgICAgaWYgKHQxID09IDIpXG4gICAgICAgICAgICBobGVuID0gVGFibGVzLnRhYmxlMjM7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIGhsZW4gPSBUYWJsZXMudGFibGU1NjtcblxuICAgICAgICBkbyB7XG4gICAgICAgICAgICB2YXIgeCA9IGl4W2l4UG9zICsgMF0gKiB4bGVuICsgaXhbaXhQb3MgKyAxXTtcbiAgICAgICAgICAgIGl4UG9zICs9IDI7XG4gICAgICAgICAgICBzdW0gKz0gaGxlblt4XTtcbiAgICAgICAgfSB3aGlsZSAoaXhQb3MgPCBlbmQpO1xuXG4gICAgICAgIHN1bTIgPSBzdW0gJiAweGZmZmY7XG4gICAgICAgIHN1bSA+Pj0gMTY7XG5cbiAgICAgICAgaWYgKHN1bSA+IHN1bTIpIHtcbiAgICAgICAgICAgIHN1bSA9IHN1bTI7XG4gICAgICAgICAgICB0MSsrO1xuICAgICAgICB9XG5cbiAgICAgICAgcy5iaXRzICs9IHN1bTtcbiAgICAgICAgcmV0dXJuIHQxO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvdW50X2JpdF9ub0VTQ19mcm9tMyhpeCwgaXhQb3MsIGVuZCwgdDEsIHMpIHtcbiAgICAgICAgLyogTm8gRVNDLXdvcmRzICovXG4gICAgICAgIHZhciBzdW0xID0gMDtcbiAgICAgICAgdmFyIHN1bTIgPSAwO1xuICAgICAgICB2YXIgc3VtMyA9IDA7XG4gICAgICAgIHZhciB4bGVuID0gVGFibGVzLmh0W3QxXS54bGVuO1xuICAgICAgICB2YXIgaGxlbjEgPSBUYWJsZXMuaHRbdDFdLmhsZW47XG4gICAgICAgIHZhciBobGVuMiA9IFRhYmxlcy5odFt0MSArIDFdLmhsZW47XG4gICAgICAgIHZhciBobGVuMyA9IFRhYmxlcy5odFt0MSArIDJdLmhsZW47XG5cbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgdmFyIHggPSBpeFtpeFBvcyArIDBdICogeGxlbiArIGl4W2l4UG9zICsgMV07XG4gICAgICAgICAgICBpeFBvcyArPSAyO1xuICAgICAgICAgICAgc3VtMSArPSBobGVuMVt4XTtcbiAgICAgICAgICAgIHN1bTIgKz0gaGxlbjJbeF07XG4gICAgICAgICAgICBzdW0zICs9IGhsZW4zW3hdO1xuICAgICAgICB9IHdoaWxlIChpeFBvcyA8IGVuZCk7XG4gICAgICAgIHZhciB0ID0gdDE7XG4gICAgICAgIGlmIChzdW0xID4gc3VtMikge1xuICAgICAgICAgICAgc3VtMSA9IHN1bTI7XG4gICAgICAgICAgICB0Kys7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN1bTEgPiBzdW0zKSB7XG4gICAgICAgICAgICBzdW0xID0gc3VtMztcbiAgICAgICAgICAgIHQgPSB0MSArIDI7XG4gICAgICAgIH1cbiAgICAgICAgcy5iaXRzICs9IHN1bTE7XG5cbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgfVxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgLyogY2hvb3NlIHRhYmxlICovXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICB2YXIgaHVmX3RibF9ub0VTQyA9IFsxLCAyLCA1LCA3LCA3LCAxMCwgMTAsIDEzLCAxMyxcbiAgICAgICAgMTMsIDEzLCAxMywgMTMsIDEzLCAxM107XG5cbiAgICAvKipcbiAgICAgKiBDaG9vc2UgdGhlIEh1ZmZtYW4gdGFibGUgdGhhdCB3aWxsIGVuY29kZSBpeFtiZWdpbi4uZW5kXSB3aXRoIHRoZSBmZXdlc3RcbiAgICAgKiBiaXRzLlxuICAgICAqXG4gICAgICogTm90ZTogVGhpcyBjb2RlIGNvbnRhaW5zIGtub3dsZWRnZSBhYm91dCB0aGUgc2l6ZXMgYW5kIGNoYXJhY3RlcmlzdGljcyBvZlxuICAgICAqIHRoZSBIdWZmbWFuIHRhYmxlcyBhcyBkZWZpbmVkIGluIHRoZSBJUyAoVGFibGUgQi43KSwgYW5kIHdpbGwgbm90IHdvcmtcbiAgICAgKiB3aXRoIGFueSBhcmJpdHJhcnkgdGFibGVzLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNob29zZV90YWJsZShpeCwgaXhQb3MsIGVuZFBvcywgcykge1xuICAgICAgICB2YXIgbWF4ID0gaXhfbWF4KGl4LCBpeFBvcywgZW5kUG9zKTtcblxuICAgICAgICBzd2l0Y2ggKG1heCkge1xuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIHJldHVybiBtYXg7XG5cbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICByZXR1cm4gY291bnRfYml0X25vRVNDKGl4LCBpeFBvcywgZW5kUG9zLCBzKTtcblxuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgIHJldHVybiBjb3VudF9iaXRfbm9FU0NfZnJvbTIoaXgsIGl4UG9zLCBlbmRQb3MsXG4gICAgICAgICAgICAgICAgICAgIGh1Zl90Ymxfbm9FU0NbbWF4IC0gMV0sIHMpO1xuXG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICBjYXNlIDc6XG4gICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICBjYXNlIDEwOlxuICAgICAgICAgICAgY2FzZSAxMTpcbiAgICAgICAgICAgIGNhc2UgMTI6XG4gICAgICAgICAgICBjYXNlIDEzOlxuICAgICAgICAgICAgY2FzZSAxNDpcbiAgICAgICAgICAgIGNhc2UgMTU6XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvdW50X2JpdF9ub0VTQ19mcm9tMyhpeCwgaXhQb3MsIGVuZFBvcyxcbiAgICAgICAgICAgICAgICAgICAgaHVmX3RibF9ub0VTQ1ttYXggLSAxXSwgcyk7XG5cbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgLyogdHJ5IHRhYmxlcyB3aXRoIGxpbmJpdHMgKi9cbiAgICAgICAgICAgICAgICBpZiAobWF4ID4gUXVhbnRpemVQVlQuSVhNQVhfVkFMKSB7XG4gICAgICAgICAgICAgICAgICAgIHMuYml0cyA9IFF1YW50aXplUFZULkxBUkdFX0JJVFM7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbWF4IC09IDE1O1xuICAgICAgICAgICAgICAgIHZhciBjaG9pY2UyO1xuICAgICAgICAgICAgICAgIGZvciAoY2hvaWNlMiA9IDI0OyBjaG9pY2UyIDwgMzI7IGNob2ljZTIrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoVGFibGVzLmh0W2Nob2ljZTJdLmxpbm1heCA+PSBtYXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBjaG9pY2U7XG4gICAgICAgICAgICAgICAgZm9yIChjaG9pY2UgPSBjaG9pY2UyIC0gODsgY2hvaWNlIDwgMjQ7IGNob2ljZSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChUYWJsZXMuaHRbY2hvaWNlXS5saW5tYXggPj0gbWF4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gY291bnRfYml0X0VTQyhpeCwgaXhQb3MsIGVuZFBvcywgY2hvaWNlLCBjaG9pY2UyLCBzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNvdW50X2JpdFxuICAgICAqL1xuICAgIHRoaXMubm9xdWFudF9jb3VudF9iaXRzID0gZnVuY3Rpb24gKGdmYywgZ2ksIHByZXZfbm9pc2UpIHtcbiAgICAgICAgdmFyIGl4ID0gZ2kubDNfZW5jO1xuICAgICAgICB2YXIgaSA9IE1hdGgubWluKDU3NiwgKChnaS5tYXhfbm9uemVyb19jb2VmZiArIDIpID4+IDEpIDw8IDEpO1xuXG4gICAgICAgIGlmIChwcmV2X25vaXNlICE9IG51bGwpXG4gICAgICAgICAgICBwcmV2X25vaXNlLnNmYl9jb3VudDEgPSAwO1xuXG4gICAgICAgIC8qIERldGVybWluZSBjb3VudDEgcmVnaW9uICovXG4gICAgICAgIGZvciAoOyBpID4gMTsgaSAtPSAyKVxuICAgICAgICAgICAgaWYgKChpeFtpIC0gMV0gfCBpeFtpIC0gMl0pICE9IDApXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGdpLmNvdW50MSA9IGk7XG5cbiAgICAgICAgLyogRGV0ZXJtaW5lcyB0aGUgbnVtYmVyIG9mIGJpdHMgdG8gZW5jb2RlIHRoZSBxdWFkcnVwbGVzLiAqL1xuICAgICAgICB2YXIgYTEgPSAwO1xuICAgICAgICB2YXIgYTIgPSAwO1xuICAgICAgICBmb3IgKDsgaSA+IDM7IGkgLT0gNCkge1xuICAgICAgICAgICAgdmFyIHA7XG4gICAgICAgICAgICAvKiBoYWNrIHRvIGNoZWNrIGlmIGFsbCB2YWx1ZXMgPD0gMSAqL1xuICAgICAgICAgICAgLy90aHJvdyBcIlRPRE86IEhBQ0sgICAgICAgICBpZiAoKCgobG9uZykgaXhbaSAtIDFdIHwgKGxvbmcpIGl4W2kgLSAyXSB8IChsb25nKSBpeFtpIC0gM10gfCAobG9uZykgaXhbaSAtIDRdKSAmIDB4ZmZmZmZmZmZMKSA+IDFMICAgICAgICBcIlxuICAgICAgICAgICAgLy9pZiAodHJ1ZSkge1xuICAgICAgICAgICAgaWYgKCgoaXhbaSAtIDFdIHwgaXhbaSAtIDJdIHwgaXhbaSAtIDNdIHwgaXhbaSAtIDRdKSAmIDB4N2ZmZmZmZmYpID4gMSkge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcCA9ICgoaXhbaSAtIDRdICogMiArIGl4W2kgLSAzXSkgKiAyICsgaXhbaSAtIDJdKSAqIDIgKyBpeFtpIC0gMV07XG4gICAgICAgICAgICBhMSArPSBUYWJsZXMudDMybFtwXTtcbiAgICAgICAgICAgIGEyICs9IFRhYmxlcy50MzNsW3BdO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiaXRzID0gYTE7XG4gICAgICAgIGdpLmNvdW50MXRhYmxlX3NlbGVjdCA9IDA7XG4gICAgICAgIGlmIChhMSA+IGEyKSB7XG4gICAgICAgICAgICBiaXRzID0gYTI7XG4gICAgICAgICAgICBnaS5jb3VudDF0YWJsZV9zZWxlY3QgPSAxO1xuICAgICAgICB9XG5cbiAgICAgICAgZ2kuY291bnQxYml0cyA9IGJpdHM7XG4gICAgICAgIGdpLmJpZ192YWx1ZXMgPSBpO1xuICAgICAgICBpZiAoaSA9PSAwKVxuICAgICAgICAgICAgcmV0dXJuIGJpdHM7XG5cbiAgICAgICAgaWYgKGdpLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICBhMSA9IDMgKiBnZmMuc2NhbGVmYWNfYmFuZC5zWzNdO1xuICAgICAgICAgICAgaWYgKGExID4gZ2kuYmlnX3ZhbHVlcylcbiAgICAgICAgICAgICAgICBhMSA9IGdpLmJpZ192YWx1ZXM7XG4gICAgICAgICAgICBhMiA9IGdpLmJpZ192YWx1ZXM7XG5cbiAgICAgICAgfSBlbHNlIGlmIChnaS5ibG9ja190eXBlID09IEVuY29kZXIuTk9STV9UWVBFKSB7XG4gICAgICAgICAgICAvKiBidl9zY2YgaGFzIDU3NiBlbnRyaWVzICgwLi41NzUpICovXG4gICAgICAgICAgICBhMSA9IGdpLnJlZ2lvbjBfY291bnQgPSBnZmMuYnZfc2NmW2kgLSAyXTtcbiAgICAgICAgICAgIGEyID0gZ2kucmVnaW9uMV9jb3VudCA9IGdmYy5idl9zY2ZbaSAtIDFdO1xuXG4gICAgICAgICAgICBhMiA9IGdmYy5zY2FsZWZhY19iYW5kLmxbYTEgKyBhMiArIDJdO1xuICAgICAgICAgICAgYTEgPSBnZmMuc2NhbGVmYWNfYmFuZC5sW2ExICsgMV07XG4gICAgICAgICAgICBpZiAoYTIgPCBpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGJpID0gbmV3IEJpdHMoYml0cyk7XG4gICAgICAgICAgICAgICAgZ2kudGFibGVfc2VsZWN0WzJdID0gY2hvb3NlX3RhYmxlKGl4LCBhMiwgaSwgYmkpO1xuICAgICAgICAgICAgICAgIGJpdHMgPSBiaS5iaXRzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ2kucmVnaW9uMF9jb3VudCA9IDc7XG4gICAgICAgICAgICAvKiBnaS5yZWdpb24xX2NvdW50ID0gU0JQU1lfbCAtIDcgLSAxOyAqL1xuICAgICAgICAgICAgZ2kucmVnaW9uMV9jb3VudCA9IEVuY29kZXIuU0JNQVhfbCAtIDEgLSA3IC0gMTtcbiAgICAgICAgICAgIGExID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFs3ICsgMV07XG4gICAgICAgICAgICBhMiA9IGk7XG4gICAgICAgICAgICBpZiAoYTEgPiBhMikge1xuICAgICAgICAgICAgICAgIGExID0gYTI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBoYXZlIHRvIGFsbG93IGZvciB0aGUgY2FzZSB3aGVuIGJpZ3ZhbHVlcyA8IHJlZ2lvbjAgPCByZWdpb24xICovXG4gICAgICAgIC8qIChhbmQgcmVnaW9uMCwgcmVnaW9uMSBhcmUgaWdub3JlZCkgKi9cbiAgICAgICAgYTEgPSBNYXRoLm1pbihhMSwgaSk7XG4gICAgICAgIGEyID0gTWF0aC5taW4oYTIsIGkpO1xuXG5cbiAgICAgICAgLyogQ291bnQgdGhlIG51bWJlciBvZiBiaXRzIG5lY2Vzc2FyeSB0byBjb2RlIHRoZSBiaWd2YWx1ZXMgcmVnaW9uLiAqL1xuICAgICAgICBpZiAoMCA8IGExKSB7XG4gICAgICAgICAgICB2YXIgYmkgPSBuZXcgQml0cyhiaXRzKTtcbiAgICAgICAgICAgIGdpLnRhYmxlX3NlbGVjdFswXSA9IGNob29zZV90YWJsZShpeCwgMCwgYTEsIGJpKTtcbiAgICAgICAgICAgIGJpdHMgPSBiaS5iaXRzO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhMSA8IGEyKSB7XG4gICAgICAgICAgICB2YXIgYmkgPSBuZXcgQml0cyhiaXRzKTtcbiAgICAgICAgICAgIGdpLnRhYmxlX3NlbGVjdFsxXSA9IGNob29zZV90YWJsZShpeCwgYTEsIGEyLCBiaSk7XG4gICAgICAgICAgICBiaXRzID0gYmkuYml0cztcbiAgICAgICAgfVxuICAgICAgICBpZiAoZ2ZjLnVzZV9iZXN0X2h1ZmZtYW4gPT0gMikge1xuICAgICAgICAgICAgZ2kucGFydDJfM19sZW5ndGggPSBiaXRzO1xuICAgICAgICAgICAgYmVzdF9odWZmbWFuX2RpdmlkZShnZmMsIGdpKTtcbiAgICAgICAgICAgIGJpdHMgPSBnaS5wYXJ0Ml8zX2xlbmd0aDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChwcmV2X25vaXNlICE9IG51bGwpIHtcbiAgICAgICAgICAgIGlmIChnaS5ibG9ja190eXBlID09IEVuY29kZXIuTk9STV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNmYiA9IDA7XG4gICAgICAgICAgICAgICAgd2hpbGUgKGdmYy5zY2FsZWZhY19iYW5kLmxbc2ZiXSA8IGdpLmJpZ192YWx1ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgc2ZiKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHByZXZfbm9pc2Uuc2ZiX2NvdW50MSA9IHNmYjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBiaXRzO1xuICAgIH1cblxuICAgIHRoaXMuY291bnRfYml0cyA9IGZ1bmN0aW9uIChnZmMsIHhyLCBnaSwgcHJldl9ub2lzZSkge1xuICAgICAgICB2YXIgaXggPSBnaS5sM19lbmM7XG5cbiAgICAgICAgLyogc2luY2UgcXVhbnRpemVfeHJwb3cgdXNlcyB0YWJsZSBsb29rdXAsIHdlIG5lZWQgdG8gY2hlY2sgdGhpcyBmaXJzdDogKi9cbiAgICAgICAgdmFyIHcgPSAoUXVhbnRpemVQVlQuSVhNQVhfVkFMKSAvIHF1cHZ0LklQT1cyMChnaS5nbG9iYWxfZ2Fpbik7XG5cbiAgICAgICAgaWYgKGdpLnhycG93X21heCA+IHcpXG4gICAgICAgICAgICByZXR1cm4gUXVhbnRpemVQVlQuTEFSR0VfQklUUztcblxuICAgICAgICBxdWFudGl6ZV94cnBvdyh4ciwgaXgsIHF1cHZ0LklQT1cyMChnaS5nbG9iYWxfZ2FpbiksIGdpLCBwcmV2X25vaXNlKTtcblxuICAgICAgICBpZiAoKGdmYy5zdWJzdGVwX3NoYXBpbmcgJiAyKSAhPSAwKSB7XG4gICAgICAgICAgICB2YXIgaiA9IDA7XG4gICAgICAgICAgICAvKiAwLjYzNDUyMTY4MjI0MjQzOSA9IDAuNTk0NioyKiooLjUqMC4xODc1KSAqL1xuICAgICAgICAgICAgdmFyIGdhaW4gPSBnaS5nbG9iYWxfZ2FpbiArIGdpLnNjYWxlZmFjX3NjYWxlO1xuICAgICAgICAgICAgdmFyIHJvdW5kZmFjID0gMC42MzQ1MjE2ODIyNDI0MzkgLyBxdXB2dC5JUE9XMjAoZ2Fpbik7XG4gICAgICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBnaS5zZmJtYXg7IHNmYisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gZ2kud2lkdGhbc2ZiXTtcbiAgICAgICAgICAgICAgICBpZiAoMCA9PSBnZmMucHNldWRvaGFsZltzZmJdKSB7XG4gICAgICAgICAgICAgICAgICAgIGogKz0gd2lkdGg7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGs7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoayA9IGosIGogKz0gd2lkdGg7IGsgPCBqOyArK2spIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl4W2tdID0gKHhyW2tdID49IHJvdW5kZmFjKSA/IGl4W2tdIDogMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5ub3F1YW50X2NvdW50X2JpdHMoZ2ZjLCBnaSwgcHJldl9ub2lzZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogcmUtY2FsY3VsYXRlIHRoZSBiZXN0IHNjYWxlZmFjX2NvbXByZXNzIHVzaW5nIHNjZnNpIHRoZSBzYXZlZCBiaXRzIGFyZVxuICAgICAqIGtlcHQgaW4gdGhlIGJpdCByZXNlcnZvaXIuXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVjYWxjX2RpdmlkZV9pbml0KGdmYywgY29kX2luZm8sIGl4LCByMDFfYml0cywgcjAxX2RpdiwgcjBfdGJsLCByMV90YmwpIHtcbiAgICAgICAgdmFyIGJpZ3YgPSBjb2RfaW5mby5iaWdfdmFsdWVzO1xuXG4gICAgICAgIGZvciAodmFyIHIwID0gMDsgcjAgPD0gNyArIDE1OyByMCsrKSB7XG4gICAgICAgICAgICByMDFfYml0c1tyMF0gPSBRdWFudGl6ZVBWVC5MQVJHRV9CSVRTO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgcjAgPSAwOyByMCA8IDE2OyByMCsrKSB7XG4gICAgICAgICAgICB2YXIgYTEgPSBnZmMuc2NhbGVmYWNfYmFuZC5sW3IwICsgMV07XG4gICAgICAgICAgICBpZiAoYTEgPj0gYmlndilcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIHZhciByMGJpdHMgPSAwO1xuICAgICAgICAgICAgdmFyIGJpID0gbmV3IEJpdHMocjBiaXRzKTtcbiAgICAgICAgICAgIHZhciByMHQgPSBjaG9vc2VfdGFibGUoaXgsIDAsIGExLCBiaSk7XG4gICAgICAgICAgICByMGJpdHMgPSBiaS5iaXRzO1xuXG4gICAgICAgICAgICBmb3IgKHZhciByMSA9IDA7IHIxIDwgODsgcjErKykge1xuICAgICAgICAgICAgICAgIHZhciBhMiA9IGdmYy5zY2FsZWZhY19iYW5kLmxbcjAgKyByMSArIDJdO1xuICAgICAgICAgICAgICAgIGlmIChhMiA+PSBiaWd2KVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB2YXIgYml0cyA9IHIwYml0cztcbiAgICAgICAgICAgICAgICBiaSA9IG5ldyBCaXRzKGJpdHMpO1xuICAgICAgICAgICAgICAgIHZhciByMXQgPSBjaG9vc2VfdGFibGUoaXgsIGExLCBhMiwgYmkpO1xuICAgICAgICAgICAgICAgIGJpdHMgPSBiaS5iaXRzO1xuICAgICAgICAgICAgICAgIGlmIChyMDFfYml0c1tyMCArIHIxXSA+IGJpdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgcjAxX2JpdHNbcjAgKyByMV0gPSBiaXRzO1xuICAgICAgICAgICAgICAgICAgICByMDFfZGl2W3IwICsgcjFdID0gcjA7XG4gICAgICAgICAgICAgICAgICAgIHIwX3RibFtyMCArIHIxXSA9IHIwdDtcbiAgICAgICAgICAgICAgICAgICAgcjFfdGJsW3IwICsgcjFdID0gcjF0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlY2FsY19kaXZpZGVfc3ViKGdmYywgY29kX2luZm8yLCBnaSwgaXgsIHIwMV9iaXRzLCByMDFfZGl2LCByMF90YmwsIHIxX3RibCkge1xuICAgICAgICB2YXIgYmlndiA9IGNvZF9pbmZvMi5iaWdfdmFsdWVzO1xuXG4gICAgICAgIGZvciAodmFyIHIyID0gMjsgcjIgPCBFbmNvZGVyLlNCTUFYX2wgKyAxOyByMisrKSB7XG4gICAgICAgICAgICB2YXIgYTIgPSBnZmMuc2NhbGVmYWNfYmFuZC5sW3IyXTtcbiAgICAgICAgICAgIGlmIChhMiA+PSBiaWd2KVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgdmFyIGJpdHMgPSByMDFfYml0c1tyMiAtIDJdICsgY29kX2luZm8yLmNvdW50MWJpdHM7XG4gICAgICAgICAgICBpZiAoZ2kucGFydDJfM19sZW5ndGggPD0gYml0cylcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgdmFyIGJpID0gbmV3IEJpdHMoYml0cyk7XG4gICAgICAgICAgICB2YXIgcjJ0ID0gY2hvb3NlX3RhYmxlKGl4LCBhMiwgYmlndiwgYmkpO1xuICAgICAgICAgICAgYml0cyA9IGJpLmJpdHM7XG4gICAgICAgICAgICBpZiAoZ2kucGFydDJfM19sZW5ndGggPD0gYml0cylcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICAgICAgZ2kuYXNzaWduKGNvZF9pbmZvMik7XG4gICAgICAgICAgICBnaS5wYXJ0Ml8zX2xlbmd0aCA9IGJpdHM7XG4gICAgICAgICAgICBnaS5yZWdpb24wX2NvdW50ID0gcjAxX2RpdltyMiAtIDJdO1xuICAgICAgICAgICAgZ2kucmVnaW9uMV9jb3VudCA9IHIyIC0gMiAtIHIwMV9kaXZbcjIgLSAyXTtcbiAgICAgICAgICAgIGdpLnRhYmxlX3NlbGVjdFswXSA9IHIwX3RibFtyMiAtIDJdO1xuICAgICAgICAgICAgZ2kudGFibGVfc2VsZWN0WzFdID0gcjFfdGJsW3IyIC0gMl07XG4gICAgICAgICAgICBnaS50YWJsZV9zZWxlY3RbMl0gPSByMnQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmJlc3RfaHVmZm1hbl9kaXZpZGUgPSBmdW5jdGlvbiAoZ2ZjLCBnaSkge1xuICAgICAgICB2YXIgY29kX2luZm8yID0gbmV3IEdySW5mbygpO1xuICAgICAgICB2YXIgaXggPSBnaS5sM19lbmM7XG4gICAgICAgIHZhciByMDFfYml0cyA9IG5ld19pbnQoNyArIDE1ICsgMSk7XG4gICAgICAgIHZhciByMDFfZGl2ID0gbmV3X2ludCg3ICsgMTUgKyAxKTtcbiAgICAgICAgdmFyIHIwX3RibCA9IG5ld19pbnQoNyArIDE1ICsgMSk7XG4gICAgICAgIHZhciByMV90YmwgPSBuZXdfaW50KDcgKyAxNSArIDEpO1xuXG4gICAgICAgIC8qIFNIT1JUIEJMT0NLIHN0dWZmIGZhaWxzIGZvciBNUEVHMiAqL1xuICAgICAgICBpZiAoZ2kuYmxvY2tfdHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUgJiYgZ2ZjLm1vZGVfZ3IgPT0gMSlcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICBjb2RfaW5mbzIuYXNzaWduKGdpKTtcbiAgICAgICAgaWYgKGdpLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5OT1JNX1RZUEUpIHtcbiAgICAgICAgICAgIHJlY2FsY19kaXZpZGVfaW5pdChnZmMsIGdpLCBpeCwgcjAxX2JpdHMsIHIwMV9kaXYsIHIwX3RibCwgcjFfdGJsKTtcbiAgICAgICAgICAgIHJlY2FsY19kaXZpZGVfc3ViKGdmYywgY29kX2luZm8yLCBnaSwgaXgsIHIwMV9iaXRzLCByMDFfZGl2LFxuICAgICAgICAgICAgICAgIHIwX3RibCwgcjFfdGJsKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgaSA9IGNvZF9pbmZvMi5iaWdfdmFsdWVzO1xuICAgICAgICBpZiAoaSA9PSAwIHx8IChpeFtpIC0gMl0gfCBpeFtpIC0gMV0pID4gMSlcbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICBpID0gZ2kuY291bnQxICsgMjtcbiAgICAgICAgaWYgKGkgPiA1NzYpXG4gICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgLyogRGV0ZXJtaW5lcyB0aGUgbnVtYmVyIG9mIGJpdHMgdG8gZW5jb2RlIHRoZSBxdWFkcnVwbGVzLiAqL1xuICAgICAgICBjb2RfaW5mbzIuYXNzaWduKGdpKTtcbiAgICAgICAgY29kX2luZm8yLmNvdW50MSA9IGk7XG4gICAgICAgIHZhciBhMSA9IDA7XG4gICAgICAgIHZhciBhMiA9IDA7XG5cblxuICAgICAgICBmb3IgKDsgaSA+IGNvZF9pbmZvMi5iaWdfdmFsdWVzOyBpIC09IDQpIHtcbiAgICAgICAgICAgIHZhciBwID0gKChpeFtpIC0gNF0gKiAyICsgaXhbaSAtIDNdKSAqIDIgKyBpeFtpIC0gMl0pICogMlxuICAgICAgICAgICAgICAgICsgaXhbaSAtIDFdO1xuICAgICAgICAgICAgYTEgKz0gVGFibGVzLnQzMmxbcF07XG4gICAgICAgICAgICBhMiArPSBUYWJsZXMudDMzbFtwXTtcbiAgICAgICAgfVxuICAgICAgICBjb2RfaW5mbzIuYmlnX3ZhbHVlcyA9IGk7XG5cbiAgICAgICAgY29kX2luZm8yLmNvdW50MXRhYmxlX3NlbGVjdCA9IDA7XG4gICAgICAgIGlmIChhMSA+IGEyKSB7XG4gICAgICAgICAgICBhMSA9IGEyO1xuICAgICAgICAgICAgY29kX2luZm8yLmNvdW50MXRhYmxlX3NlbGVjdCA9IDE7XG4gICAgICAgIH1cblxuICAgICAgICBjb2RfaW5mbzIuY291bnQxYml0cyA9IGExO1xuXG4gICAgICAgIGlmIChjb2RfaW5mbzIuYmxvY2tfdHlwZSA9PSBFbmNvZGVyLk5PUk1fVFlQRSlcbiAgICAgICAgICAgIHJlY2FsY19kaXZpZGVfc3ViKGdmYywgY29kX2luZm8yLCBnaSwgaXgsIHIwMV9iaXRzLCByMDFfZGl2LFxuICAgICAgICAgICAgICAgIHIwX3RibCwgcjFfdGJsKTtcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvKiBDb3VudCB0aGUgbnVtYmVyIG9mIGJpdHMgbmVjZXNzYXJ5IHRvIGNvZGUgdGhlIGJpZ3ZhbHVlcyByZWdpb24uICovXG4gICAgICAgICAgICBjb2RfaW5mbzIucGFydDJfM19sZW5ndGggPSBhMTtcbiAgICAgICAgICAgIGExID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFs3ICsgMV07XG4gICAgICAgICAgICBpZiAoYTEgPiBpKSB7XG4gICAgICAgICAgICAgICAgYTEgPSBpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGExID4gMCkge1xuICAgICAgICAgICAgICAgIHZhciBiaSA9IG5ldyBCaXRzKGNvZF9pbmZvMi5wYXJ0Ml8zX2xlbmd0aCk7XG4gICAgICAgICAgICAgICAgY29kX2luZm8yLnRhYmxlX3NlbGVjdFswXSA9IGNob29zZV90YWJsZShpeCwgMCwgYTEsIGJpKTtcbiAgICAgICAgICAgICAgICBjb2RfaW5mbzIucGFydDJfM19sZW5ndGggPSBiaS5iaXRzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGkgPiBhMSkge1xuICAgICAgICAgICAgICAgIHZhciBiaSA9IG5ldyBCaXRzKGNvZF9pbmZvMi5wYXJ0Ml8zX2xlbmd0aCk7XG4gICAgICAgICAgICAgICAgY29kX2luZm8yLnRhYmxlX3NlbGVjdFsxXSA9IGNob29zZV90YWJsZShpeCwgYTEsIGksIGJpKTtcbiAgICAgICAgICAgICAgICBjb2RfaW5mbzIucGFydDJfM19sZW5ndGggPSBiaS5iaXRzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGdpLnBhcnQyXzNfbGVuZ3RoID4gY29kX2luZm8yLnBhcnQyXzNfbGVuZ3RoKVxuICAgICAgICAgICAgICAgIGdpLmFzc2lnbihjb2RfaW5mbzIpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFyIHNsZW4xX24gPSBbMSwgMSwgMSwgMSwgOCwgMiwgMiwgMiwgNCwgNCwgNCwgOCwgOCwgOCwgMTYsIDE2XTtcbiAgICB2YXIgc2xlbjJfbiA9IFsxLCAyLCA0LCA4LCAxLCAyLCA0LCA4LCAyLCA0LCA4LCAyLCA0LCA4LCA0LCA4XTtcbiAgICB2YXIgc2xlbjFfdGFiID0gWzAsIDAsIDAsIDAsIDMsIDEsIDEsIDEsIDIsIDIsIDIsIDMsIDMsIDMsIDQsIDRdO1xuICAgIHZhciBzbGVuMl90YWIgPSBbMCwgMSwgMiwgMywgMCwgMSwgMiwgMywgMSwgMiwgMywgMSwgMiwgMywgMiwgM107XG4gICAgVGFrZWhpcm8uc2xlbjFfdGFiID0gc2xlbjFfdGFiO1xuICAgIFRha2VoaXJvLnNsZW4yX3RhYiA9IHNsZW4yX3RhYjtcblxuICAgIGZ1bmN0aW9uIHNjZnNpX2NhbGMoY2gsIGwzX3NpZGUpIHtcbiAgICAgICAgdmFyIHNmYjtcbiAgICAgICAgdmFyIGdpID0gbDNfc2lkZS50dFsxXVtjaF07XG4gICAgICAgIHZhciBnMCA9IGwzX3NpZGUudHRbMF1bY2hdO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgVGFibGVzLnNjZnNpX2JhbmQubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKHNmYiA9IFRhYmxlcy5zY2ZzaV9iYW5kW2ldOyBzZmIgPCBUYWJsZXMuc2Nmc2lfYmFuZFtpICsgMV07IHNmYisrKSB7XG4gICAgICAgICAgICAgICAgaWYgKGcwLnNjYWxlZmFjW3NmYl0gIT0gZ2kuc2NhbGVmYWNbc2ZiXVxuICAgICAgICAgICAgICAgICAgICAmJiBnaS5zY2FsZWZhY1tzZmJdID49IDApXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHNmYiA9PSBUYWJsZXMuc2Nmc2lfYmFuZFtpICsgMV0pIHtcbiAgICAgICAgICAgICAgICBmb3IgKHNmYiA9IFRhYmxlcy5zY2ZzaV9iYW5kW2ldOyBzZmIgPCBUYWJsZXMuc2Nmc2lfYmFuZFtpICsgMV07IHNmYisrKSB7XG4gICAgICAgICAgICAgICAgICAgIGdpLnNjYWxlZmFjW3NmYl0gPSAtMTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbDNfc2lkZS5zY2ZzaVtjaF1baV0gPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciBzMSA9IDA7XG4gICAgICAgIHZhciBjMSA9IDA7XG4gICAgICAgIGZvciAoc2ZiID0gMDsgc2ZiIDwgMTE7IHNmYisrKSB7XG4gICAgICAgICAgICBpZiAoZ2kuc2NhbGVmYWNbc2ZiXSA9PSAtMSlcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIGMxKys7XG4gICAgICAgICAgICBpZiAoczEgPCBnaS5zY2FsZWZhY1tzZmJdKVxuICAgICAgICAgICAgICAgIHMxID0gZ2kuc2NhbGVmYWNbc2ZiXTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgczIgPSAwO1xuICAgICAgICB2YXIgYzIgPSAwO1xuICAgICAgICBmb3IgKDsgc2ZiIDwgRW5jb2Rlci5TQlBTWV9sOyBzZmIrKykge1xuICAgICAgICAgICAgaWYgKGdpLnNjYWxlZmFjW3NmYl0gPT0gLTEpXG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICBjMisrO1xuICAgICAgICAgICAgaWYgKHMyIDwgZ2kuc2NhbGVmYWNbc2ZiXSlcbiAgICAgICAgICAgICAgICBzMiA9IGdpLnNjYWxlZmFjW3NmYl07XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDE2OyBpKyspIHtcbiAgICAgICAgICAgIGlmIChzMSA8IHNsZW4xX25baV0gJiYgczIgPCBzbGVuMl9uW2ldKSB7XG4gICAgICAgICAgICAgICAgdmFyIGMgPSBzbGVuMV90YWJbaV0gKiBjMSArIHNsZW4yX3RhYltpXSAqIGMyO1xuICAgICAgICAgICAgICAgIGlmIChnaS5wYXJ0Ml9sZW5ndGggPiBjKSB7XG4gICAgICAgICAgICAgICAgICAgIGdpLnBhcnQyX2xlbmd0aCA9IGM7XG4gICAgICAgICAgICAgICAgICAgIGdpLnNjYWxlZmFjX2NvbXByZXNzID0gaTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaW5kIHRoZSBvcHRpbWFsIHdheSB0byBzdG9yZSB0aGUgc2NhbGVmYWN0b3JzLiBPbmx5IGNhbGwgdGhpcyByb3V0aW5lXG4gICAgICogYWZ0ZXIgZmluYWwgc2NhbGVmYWN0b3JzIGhhdmUgYmVlbiBjaG9zZW4gYW5kIHRoZSBjaGFubmVsL2dyYW51bGUgd2lsbFxuICAgICAqIG5vdCBiZSByZS1lbmNvZGVkLlxuICAgICAqL1xuICAgIHRoaXMuYmVzdF9zY2FsZWZhY19zdG9yZSA9IGZ1bmN0aW9uIChnZmMsIGdyLCBjaCwgbDNfc2lkZSkge1xuICAgICAgICAvKiB1c2Ugc2NhbGVmYWNfc2NhbGUgaWYgd2UgY2FuICovXG4gICAgICAgIHZhciBnaSA9IGwzX3NpZGUudHRbZ3JdW2NoXTtcbiAgICAgICAgdmFyIHNmYiwgaSwgaiwgbDtcbiAgICAgICAgdmFyIHJlY2FsYyA9IDA7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogcmVtb3ZlIHNjYWxlZmFjcyBmcm9tIGJhbmRzIHdpdGggaXg9MC4gVGhpcyBpZGVhIGNvbWVzIGZyb20gdGhlIEFBQ1xuICAgICAgICAgKiBJU08gZG9jcy4gYWRkZWQgbXQgMy8wMFxuICAgICAgICAgKi9cbiAgICAgICAgLyogY2hlY2sgaWYgbDNfZW5jPTAgKi9cbiAgICAgICAgaiA9IDA7XG4gICAgICAgIGZvciAoc2ZiID0gMDsgc2ZiIDwgZ2kuc2ZibWF4OyBzZmIrKykge1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gZ2kud2lkdGhbc2ZiXTtcbiAgICAgICAgICAgIGogKz0gd2lkdGg7XG4gICAgICAgICAgICBmb3IgKGwgPSAtd2lkdGg7IGwgPCAwOyBsKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoZ2kubDNfZW5jW2wgKyBqXSAhPSAwKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChsID09IDApXG4gICAgICAgICAgICAgICAgZ2kuc2NhbGVmYWNbc2ZiXSA9IHJlY2FsYyA9IC0yO1xuICAgICAgICAgICAgLyogYW55dGhpbmcgZ29lcy4gKi9cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBvbmx5IGJlc3Rfc2NhbGVmYWNfc3RvcmUgYW5kIGNhbGNfc2Nmc2kga25vdy0tYW5kIG9ubHkgdGhleVxuICAgICAgICAgICAgICogc2hvdWxkIGtub3ctLWFib3V0IHRoZSBtYWdpYyBudW1iZXIgLTIuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICgwID09IGdpLnNjYWxlZmFjX3NjYWxlICYmIDAgPT0gZ2kucHJlZmxhZykge1xuICAgICAgICAgICAgdmFyIHMgPSAwO1xuICAgICAgICAgICAgZm9yIChzZmIgPSAwOyBzZmIgPCBnaS5zZmJtYXg7IHNmYisrKVxuICAgICAgICAgICAgICAgIGlmIChnaS5zY2FsZWZhY1tzZmJdID4gMClcbiAgICAgICAgICAgICAgICAgICAgcyB8PSBnaS5zY2FsZWZhY1tzZmJdO1xuXG4gICAgICAgICAgICBpZiAoMCA9PSAocyAmIDEpICYmIHMgIT0gMCkge1xuICAgICAgICAgICAgICAgIGZvciAoc2ZiID0gMDsgc2ZiIDwgZ2kuc2ZibWF4OyBzZmIrKylcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdpLnNjYWxlZmFjW3NmYl0gPiAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgZ2kuc2NhbGVmYWNbc2ZiXSA+Pj0gMTtcblxuICAgICAgICAgICAgICAgIGdpLnNjYWxlZmFjX3NjYWxlID0gcmVjYWxjID0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmICgwID09IGdpLnByZWZsYWcgJiYgZ2kuYmxvY2tfdHlwZSAhPSBFbmNvZGVyLlNIT1JUX1RZUEVcbiAgICAgICAgICAgICYmIGdmYy5tb2RlX2dyID09IDIpIHtcbiAgICAgICAgICAgIGZvciAoc2ZiID0gMTE7IHNmYiA8IEVuY29kZXIuU0JQU1lfbDsgc2ZiKyspXG4gICAgICAgICAgICAgICAgaWYgKGdpLnNjYWxlZmFjW3NmYl0gPCBxdXB2dC5wcmV0YWJbc2ZiXVxuICAgICAgICAgICAgICAgICAgICAmJiBnaS5zY2FsZWZhY1tzZmJdICE9IC0yKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGlmIChzZmIgPT0gRW5jb2Rlci5TQlBTWV9sKSB7XG4gICAgICAgICAgICAgICAgZm9yIChzZmIgPSAxMTsgc2ZiIDwgRW5jb2Rlci5TQlBTWV9sOyBzZmIrKylcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdpLnNjYWxlZmFjW3NmYl0gPiAwKVxuICAgICAgICAgICAgICAgICAgICAgICAgZ2kuc2NhbGVmYWNbc2ZiXSAtPSBxdXB2dC5wcmV0YWJbc2ZiXTtcblxuICAgICAgICAgICAgICAgIGdpLnByZWZsYWcgPSByZWNhbGMgPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IDQ7IGkrKylcbiAgICAgICAgICAgIGwzX3NpZGUuc2Nmc2lbY2hdW2ldID0gMDtcblxuICAgICAgICBpZiAoZ2ZjLm1vZGVfZ3IgPT0gMiAmJiBnciA9PSAxXG4gICAgICAgICAgICAmJiBsM19zaWRlLnR0WzBdW2NoXS5ibG9ja190eXBlICE9IEVuY29kZXIuU0hPUlRfVFlQRVxuICAgICAgICAgICAgJiYgbDNfc2lkZS50dFsxXVtjaF0uYmxvY2tfdHlwZSAhPSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgIHNjZnNpX2NhbGMoY2gsIGwzX3NpZGUpO1xuICAgICAgICAgICAgcmVjYWxjID0gMDtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKHNmYiA9IDA7IHNmYiA8IGdpLnNmYm1heDsgc2ZiKyspIHtcbiAgICAgICAgICAgIGlmIChnaS5zY2FsZWZhY1tzZmJdID09IC0yKSB7XG4gICAgICAgICAgICAgICAgZ2kuc2NhbGVmYWNbc2ZiXSA9IDA7XG4gICAgICAgICAgICAgICAgLyogaWYgYW55dGhpbmcgZ29lcywgdGhlbiAwIGlzIGEgZ29vZCBjaG9pY2UgKi9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAocmVjYWxjICE9IDApIHtcbiAgICAgICAgICAgIGlmIChnZmMubW9kZV9nciA9PSAyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zY2FsZV9iaXRjb3VudChnaSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc2NhbGVfYml0Y291bnRfbHNmKGdmYywgZ2kpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gYWxsX3NjYWxlZmFjdG9yc19ub3RfbmVnYXRpdmUoc2NhbGVmYWMsIG4pIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyArK2kpIHtcbiAgICAgICAgICAgIGlmIChzY2FsZWZhY1tpXSA8IDApXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIG51bWJlciBvZiBiaXRzIHVzZWQgdG8gZW5jb2RlIHNjYWxlZmFjcy5cbiAgICAgKlxuICAgICAqIDE4KnNsZW4xX3RhYltpXSArIDE4KnNsZW4yX3RhYltpXVxuICAgICAqL1xuICAgIHZhciBzY2FsZV9zaG9ydCA9IFswLCAxOCwgMzYsIDU0LCA1NCwgMzYsIDU0LCA3MixcbiAgICAgICAgNTQsIDcyLCA5MCwgNzIsIDkwLCAxMDgsIDEwOCwgMTI2XTtcblxuICAgIC8qKlxuICAgICAqIG51bWJlciBvZiBiaXRzIHVzZWQgdG8gZW5jb2RlIHNjYWxlZmFjcy5cbiAgICAgKlxuICAgICAqIDE3KnNsZW4xX3RhYltpXSArIDE4KnNsZW4yX3RhYltpXVxuICAgICAqL1xuICAgIHZhciBzY2FsZV9taXhlZCA9IFswLCAxOCwgMzYsIDU0LCA1MSwgMzUsIDUzLCA3MSxcbiAgICAgICAgNTIsIDcwLCA4OCwgNjksIDg3LCAxMDUsIDEwNCwgMTIyXTtcblxuICAgIC8qKlxuICAgICAqIG51bWJlciBvZiBiaXRzIHVzZWQgdG8gZW5jb2RlIHNjYWxlZmFjcy5cbiAgICAgKlxuICAgICAqIDExKnNsZW4xX3RhYltpXSArIDEwKnNsZW4yX3RhYltpXVxuICAgICAqL1xuICAgIHZhciBzY2FsZV9sb25nID0gWzAsIDEwLCAyMCwgMzAsIDMzLCAyMSwgMzEsIDQxLCAzMiwgNDIsXG4gICAgICAgIDUyLCA0MywgNTMsIDYzLCA2NCwgNzRdO1xuXG4gICAgLyoqXG4gICAgICogQWxzbyBjYWxjdWxhdGVzIHRoZSBudW1iZXIgb2YgYml0cyBuZWNlc3NhcnkgdG8gY29kZSB0aGUgc2NhbGVmYWN0b3JzLlxuICAgICAqL1xuICAgIHRoaXMuc2NhbGVfYml0Y291bnQgPSBmdW5jdGlvbiAoY29kX2luZm8pIHtcbiAgICAgICAgdmFyIGssIHNmYiwgbWF4X3NsZW4xID0gMCwgbWF4X3NsZW4yID0gMDtcblxuICAgICAgICAvKiBtYXhpbXVtIHZhbHVlcyAqL1xuICAgICAgICB2YXIgdGFiO1xuICAgICAgICB2YXIgc2NhbGVmYWMgPSBjb2RfaW5mby5zY2FsZWZhYztcblxuXG4gICAgICAgIGlmIChjb2RfaW5mby5ibG9ja190eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgdGFiID0gc2NhbGVfc2hvcnQ7XG4gICAgICAgICAgICBpZiAoY29kX2luZm8ubWl4ZWRfYmxvY2tfZmxhZyAhPSAwKVxuICAgICAgICAgICAgICAgIHRhYiA9IHNjYWxlX21peGVkO1xuICAgICAgICB9IGVsc2UgeyAvKiBibG9ja190eXBlID09IDEsMixvciAzICovXG4gICAgICAgICAgICB0YWIgPSBzY2FsZV9sb25nO1xuICAgICAgICAgICAgaWYgKDAgPT0gY29kX2luZm8ucHJlZmxhZykge1xuICAgICAgICAgICAgICAgIGZvciAoc2ZiID0gMTE7IHNmYiA8IEVuY29kZXIuU0JQU1lfbDsgc2ZiKyspXG4gICAgICAgICAgICAgICAgICAgIGlmIChzY2FsZWZhY1tzZmJdIDwgcXVwdnQucHJldGFiW3NmYl0pXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGlmIChzZmIgPT0gRW5jb2Rlci5TQlBTWV9sKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvLnByZWZsYWcgPSAxO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHNmYiA9IDExOyBzZmIgPCBFbmNvZGVyLlNCUFNZX2w7IHNmYisrKVxuICAgICAgICAgICAgICAgICAgICAgICAgc2NhbGVmYWNbc2ZiXSAtPSBxdXB2dC5wcmV0YWJbc2ZiXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHNmYiA9IDA7IHNmYiA8IGNvZF9pbmZvLnNmYmRpdmlkZTsgc2ZiKyspXG4gICAgICAgICAgICBpZiAobWF4X3NsZW4xIDwgc2NhbGVmYWNbc2ZiXSlcbiAgICAgICAgICAgICAgICBtYXhfc2xlbjEgPSBzY2FsZWZhY1tzZmJdO1xuXG4gICAgICAgIGZvciAoOyBzZmIgPCBjb2RfaW5mby5zZmJtYXg7IHNmYisrKVxuICAgICAgICAgICAgaWYgKG1heF9zbGVuMiA8IHNjYWxlZmFjW3NmYl0pXG4gICAgICAgICAgICAgICAgbWF4X3NsZW4yID0gc2NhbGVmYWNbc2ZiXTtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBmcm9tIFRha2VoaXJvIFRPTUlOQUdBIDx0b21pbmFnYUBpc290ZXJuZXQub3JnPiAxMC85OSBsb29wIG92ZXIgKmFsbCpcbiAgICAgICAgICogcG9zaWJsZSB2YWx1ZXMgb2Ygc2NhbGVmYWNfY29tcHJlc3MgdG8gZmluZCB0aGUgb25lIHdoaWNoIHVzZXMgdGhlXG4gICAgICAgICAqIHNtYWxsZXN0IG51bWJlciBvZiBiaXRzLiBJU08gd291bGQgc3RvcCBhdCBmaXJzdCB2YWxpZCBpbmRleFxuICAgICAgICAgKi9cbiAgICAgICAgY29kX2luZm8ucGFydDJfbGVuZ3RoID0gUXVhbnRpemVQVlQuTEFSR0VfQklUUztcbiAgICAgICAgZm9yIChrID0gMDsgayA8IDE2OyBrKyspIHtcbiAgICAgICAgICAgIGlmIChtYXhfc2xlbjEgPCBzbGVuMV9uW2tdICYmIG1heF9zbGVuMiA8IHNsZW4yX25ba11cbiAgICAgICAgICAgICAgICAmJiBjb2RfaW5mby5wYXJ0Ml9sZW5ndGggPiB0YWJba10pIHtcbiAgICAgICAgICAgICAgICBjb2RfaW5mby5wYXJ0Ml9sZW5ndGggPSB0YWJba107XG4gICAgICAgICAgICAgICAgY29kX2luZm8uc2NhbGVmYWNfY29tcHJlc3MgPSBrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjb2RfaW5mby5wYXJ0Ml9sZW5ndGggPT0gUXVhbnRpemVQVlQuTEFSR0VfQklUUztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiB0YWJsZSBvZiBsYXJnZXN0IHNjYWxlZmFjdG9yIHZhbHVlcyBmb3IgTVBFRzJcbiAgICAgKi9cbiAgICB2YXIgbWF4X3JhbmdlX3NmYWNfdGFiID0gW1sxNSwgMTUsIDcsIDddLFxuICAgICAgICBbMTUsIDE1LCA3LCAwXSwgWzcsIDMsIDAsIDBdLCBbMTUsIDMxLCAzMSwgMF0sXG4gICAgICAgIFs3LCA3LCA3LCAwXSwgWzMsIDMsIDAsIDBdXTtcblxuICAgIC8qKlxuICAgICAqIEFsc28gY291bnRzIHRoZSBudW1iZXIgb2YgYml0cyB0byBlbmNvZGUgdGhlIHNjYWxlZmFjcyBidXQgZm9yIE1QRUcgMlxuICAgICAqIExvd2VyIHNhbXBsaW5nIGZyZXF1ZW5jaWVzICgyNCwgMjIuMDUgYW5kIDE2IGtIei4pXG4gICAgICpcbiAgICAgKiBUaGlzIGlzIHJldmVyc2UtZW5naW5lZXJlZCBmcm9tIHNlY3Rpb24gMi40LjMuMiBvZiB0aGUgTVBFRzIgSVMsXG4gICAgICogXCJBdWRpbyBEZWNvZGluZyBMYXllciBJSUlcIlxuICAgICAqL1xuICAgIHRoaXMuc2NhbGVfYml0Y291bnRfbHNmID0gZnVuY3Rpb24gKGdmYywgY29kX2luZm8pIHtcbiAgICAgICAgdmFyIHRhYmxlX251bWJlciwgcm93X2luX3RhYmxlLCBwYXJ0aXRpb24sIG5yX3NmYiwgd2luZG93O1xuICAgICAgICB2YXIgb3ZlcjtcbiAgICAgICAgdmFyIGksIHNmYjtcbiAgICAgICAgdmFyIG1heF9zZmFjID0gbmV3X2ludCg0KTtcbi8vdmFyIHBhcnRpdGlvbl90YWJsZTtcbiAgICAgICAgdmFyIHNjYWxlZmFjID0gY29kX2luZm8uc2NhbGVmYWM7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogU2V0IHBhcnRpdGlvbiB0YWJsZS4gTm90ZSB0aGF0IHNob3VsZCB0cnkgdG8gdXNlIHRhYmxlIG9uZSwgYnV0IGRvXG4gICAgICAgICAqIG5vdCB5ZXQuLi5cbiAgICAgICAgICovXG4gICAgICAgIGlmIChjb2RfaW5mby5wcmVmbGFnICE9IDApXG4gICAgICAgICAgICB0YWJsZV9udW1iZXIgPSAyO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICB0YWJsZV9udW1iZXIgPSAwO1xuXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCA0OyBpKyspXG4gICAgICAgICAgICBtYXhfc2ZhY1tpXSA9IDA7XG5cbiAgICAgICAgaWYgKGNvZF9pbmZvLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICByb3dfaW5fdGFibGUgPSAxO1xuICAgICAgICAgICAgdmFyIHBhcnRpdGlvbl90YWJsZSA9IHF1cHZ0Lm5yX29mX3NmYl9ibG9ja1t0YWJsZV9udW1iZXJdW3Jvd19pbl90YWJsZV07XG4gICAgICAgICAgICBmb3IgKHNmYiA9IDAsIHBhcnRpdGlvbiA9IDA7IHBhcnRpdGlvbiA8IDQ7IHBhcnRpdGlvbisrKSB7XG4gICAgICAgICAgICAgICAgbnJfc2ZiID0gcGFydGl0aW9uX3RhYmxlW3BhcnRpdGlvbl0gLyAzO1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBucl9zZmI7IGkrKywgc2ZiKyspXG4gICAgICAgICAgICAgICAgICAgIGZvciAod2luZG93ID0gMDsgd2luZG93IDwgMzsgd2luZG93KyspXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2NhbGVmYWNbc2ZiICogMyArIHdpbmRvd10gPiBtYXhfc2ZhY1twYXJ0aXRpb25dKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heF9zZmFjW3BhcnRpdGlvbl0gPSBzY2FsZWZhY1tzZmIgKiAzICsgd2luZG93XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJvd19pbl90YWJsZSA9IDA7XG4gICAgICAgICAgICB2YXIgcGFydGl0aW9uX3RhYmxlID0gcXVwdnQubnJfb2Zfc2ZiX2Jsb2NrW3RhYmxlX251bWJlcl1bcm93X2luX3RhYmxlXTtcbiAgICAgICAgICAgIGZvciAoc2ZiID0gMCwgcGFydGl0aW9uID0gMDsgcGFydGl0aW9uIDwgNDsgcGFydGl0aW9uKyspIHtcbiAgICAgICAgICAgICAgICBucl9zZmIgPSBwYXJ0aXRpb25fdGFibGVbcGFydGl0aW9uXTtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbnJfc2ZiOyBpKyssIHNmYisrKVxuICAgICAgICAgICAgICAgICAgICBpZiAoc2NhbGVmYWNbc2ZiXSA+IG1heF9zZmFjW3BhcnRpdGlvbl0pXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhfc2ZhY1twYXJ0aXRpb25dID0gc2NhbGVmYWNbc2ZiXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAob3ZlciA9IGZhbHNlLCBwYXJ0aXRpb24gPSAwOyBwYXJ0aXRpb24gPCA0OyBwYXJ0aXRpb24rKykge1xuICAgICAgICAgICAgaWYgKG1heF9zZmFjW3BhcnRpdGlvbl0gPiBtYXhfcmFuZ2Vfc2ZhY190YWJbdGFibGVfbnVtYmVyXVtwYXJ0aXRpb25dKVxuICAgICAgICAgICAgICAgIG92ZXIgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGlmICghb3Zlcikge1xuICAgICAgICAgICAgdmFyIHNsZW4xLCBzbGVuMiwgc2xlbjMsIHNsZW40O1xuXG4gICAgICAgICAgICBjb2RfaW5mby5zZmJfcGFydGl0aW9uX3RhYmxlID0gcXVwdnQubnJfb2Zfc2ZiX2Jsb2NrW3RhYmxlX251bWJlcl1bcm93X2luX3RhYmxlXTtcbiAgICAgICAgICAgIGZvciAocGFydGl0aW9uID0gMDsgcGFydGl0aW9uIDwgNDsgcGFydGl0aW9uKyspXG4gICAgICAgICAgICAgICAgY29kX2luZm8uc2xlbltwYXJ0aXRpb25dID0gbG9nMnRhYlttYXhfc2ZhY1twYXJ0aXRpb25dXTtcblxuICAgICAgICAgICAgLyogc2V0IHNjYWxlZmFjX2NvbXByZXNzICovXG4gICAgICAgICAgICBzbGVuMSA9IGNvZF9pbmZvLnNsZW5bMF07XG4gICAgICAgICAgICBzbGVuMiA9IGNvZF9pbmZvLnNsZW5bMV07XG4gICAgICAgICAgICBzbGVuMyA9IGNvZF9pbmZvLnNsZW5bMl07XG4gICAgICAgICAgICBzbGVuNCA9IGNvZF9pbmZvLnNsZW5bM107XG5cbiAgICAgICAgICAgIHN3aXRjaCAodGFibGVfbnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgICAgICBjb2RfaW5mby5zY2FsZWZhY19jb21wcmVzcyA9ICgoKHNsZW4xICogNSkgKyBzbGVuMikgPDwgNClcbiAgICAgICAgICAgICAgICAgICAgICAgICsgKHNsZW4zIDw8IDIpICsgc2xlbjQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgICAgICBjb2RfaW5mby5zY2FsZWZhY19jb21wcmVzcyA9IDQwMCArICgoKHNsZW4xICogNSkgKyBzbGVuMikgPDwgMilcbiAgICAgICAgICAgICAgICAgICAgICAgICsgc2xlbjM7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBjb2RfaW5mby5zY2FsZWZhY19jb21wcmVzcyA9IDUwMCArIChzbGVuMSAqIDMpICsgc2xlbjI7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGYoXCJpbnRlbnNpdHkgc3RlcmVvIG5vdCBpbXBsZW1lbnRlZCB5ZXRcXG5cIik7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICghb3Zlcikge1xuICAgICAgICAgICAgY29kX2luZm8ucGFydDJfbGVuZ3RoID0gMDtcbiAgICAgICAgICAgIGZvciAocGFydGl0aW9uID0gMDsgcGFydGl0aW9uIDwgNDsgcGFydGl0aW9uKyspXG4gICAgICAgICAgICAgICAgY29kX2luZm8ucGFydDJfbGVuZ3RoICs9IGNvZF9pbmZvLnNsZW5bcGFydGl0aW9uXVxuICAgICAgICAgICAgICAgICAgICAqIGNvZF9pbmZvLnNmYl9wYXJ0aXRpb25fdGFibGVbcGFydGl0aW9uXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3ZlcjtcbiAgICB9XG5cbiAgICAvKlxuICAgICAqIFNpbmNlIG5vIGJhbmRzIGhhdmUgYmVlbiBvdmVyLWFtcGxpZmllZCwgd2UgY2FuIHNldCBzY2FsZWZhY19jb21wcmVzcyBhbmRcbiAgICAgKiBzbGVuW10gZm9yIHRoZSBmb3JtYXR0ZXJcbiAgICAgKi9cbiAgICB2YXIgbG9nMnRhYiA9IFswLCAxLCAyLCAyLCAzLCAzLCAzLCAzLCA0LCA0LCA0LCA0LFxuICAgICAgICA0LCA0LCA0LCA0XTtcblxuICAgIHRoaXMuaHVmZm1hbl9pbml0ID0gZnVuY3Rpb24gKGdmYykge1xuICAgICAgICBmb3IgKHZhciBpID0gMjsgaSA8PSA1NzY7IGkgKz0gMikge1xuICAgICAgICAgICAgdmFyIHNjZmJfYW56ID0gMCwgYnZfaW5kZXg7XG4gICAgICAgICAgICB3aGlsZSAoZ2ZjLnNjYWxlZmFjX2JhbmQubFsrK3NjZmJfYW56XSA8IGkpXG4gICAgICAgICAgICAgICAgO1xuXG4gICAgICAgICAgICBidl9pbmRleCA9IHN1YmR2X3RhYmxlW3NjZmJfYW56XVswXTsgLy8gLnJlZ2lvbjBfY291bnRcbiAgICAgICAgICAgIHdoaWxlIChnZmMuc2NhbGVmYWNfYmFuZC5sW2J2X2luZGV4ICsgMV0gPiBpKVxuICAgICAgICAgICAgICAgIGJ2X2luZGV4LS07XG5cbiAgICAgICAgICAgIGlmIChidl9pbmRleCA8IDApIHtcbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIHRoaXMgaXMgYW4gaW5kaWNhdGlvbiB0aGF0IGV2ZXJ5dGhpbmcgaXMgZ29pbmcgdG8gYmUgZW5jb2RlZFxuICAgICAgICAgICAgICAgICAqIGFzIHJlZ2lvbjA6IGJpZ3ZhbHVlcyA8IHJlZ2lvbjAgPCByZWdpb24xIHNvIGxldHMgc2V0XG4gICAgICAgICAgICAgICAgICogcmVnaW9uMCwgcmVnaW9uMSB0byBzb21lIHZhbHVlIGxhcmdlciB0aGFuIGJpZ3ZhbHVlc1xuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGJ2X2luZGV4ID0gc3ViZHZfdGFibGVbc2NmYl9hbnpdWzBdOyAvLyAucmVnaW9uMF9jb3VudFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBnZmMuYnZfc2NmW2kgLSAyXSA9IGJ2X2luZGV4O1xuXG4gICAgICAgICAgICBidl9pbmRleCA9IHN1YmR2X3RhYmxlW3NjZmJfYW56XVsxXTsgLy8gLnJlZ2lvbjFfY291bnRcbiAgICAgICAgICAgIHdoaWxlIChnZmMuc2NhbGVmYWNfYmFuZC5sW2J2X2luZGV4ICsgZ2ZjLmJ2X3NjZltpIC0gMl0gKyAyXSA+IGkpXG4gICAgICAgICAgICAgICAgYnZfaW5kZXgtLTtcblxuICAgICAgICAgICAgaWYgKGJ2X2luZGV4IDwgMCkge1xuICAgICAgICAgICAgICAgIGJ2X2luZGV4ID0gc3ViZHZfdGFibGVbc2NmYl9hbnpdWzFdOyAvLyAucmVnaW9uMV9jb3VudFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBnZmMuYnZfc2NmW2kgLSAxXSA9IGJ2X2luZGV4O1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vKlxuICogIFJlcGxheUdhaW5BbmFseXNpcyAtIGFuYWx5emVzIGlucHV0IHNhbXBsZXMgYW5kIGdpdmUgdGhlIHJlY29tbWVuZGVkIGRCIGNoYW5nZVxuICogIENvcHlyaWdodCAoQykgMjAwMSBEYXZpZCBSb2JpbnNvbiBhbmQgR2xlbiBTYXd5ZXJcbiAqICBJbXByb3ZlbWVudHMgYW5kIG9wdGltaXphdGlvbnMgYWRkZWQgYnkgRnJhbmsgS2xlbW0sIGFuZCBieSBNYXJjZWwgTXVsbGVyIFxuICpcbiAqICBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yXG4gKiAgbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpY1xuICogIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlclxuICogIHZlcnNpb24gMi4xIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLlxuICpcbiAqICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCxcbiAqICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuICogIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VXG4gKiAgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cbiAqXG4gKiAgWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpY1xuICogIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgd3JpdGUgdG8gdGhlIEZyZWUgU29mdHdhcmVcbiAqICBGb3VuZGF0aW9uLCBJbmMuLCA1OSBUZW1wbGUgUGxhY2UsIFN1aXRlIDMzMCwgQm9zdG9uLCBNQSAgMDIxMTEtMTMwNyAgVVNBXG4gKlxuICogIGNvbmNlcHQgYW5kIGZpbHRlciB2YWx1ZXMgYnkgRGF2aWQgUm9iaW5zb24gKERhdmlkQFJvYmluc29uLm9yZylcbiAqICAgIC0tIGJsYW1lIGhpbSBpZiB5b3UgdGhpbmsgdGhlIGlkZWEgaXMgZmxhd2VkXG4gKiAgb3JpZ2luYWwgY29kaW5nIGJ5IEdsZW4gU2F3eWVyIChtcDNnYWluQGhvdG1haWwuY29tKVxuICogICAgLS0gYmxhbWUgaGltIGlmIHlvdSB0aGluayB0aGlzIHJ1bnMgdG9vIHNsb3dseSwgb3IgdGhlIGNvZGluZyBpcyBvdGhlcndpc2UgZmxhd2VkXG4gKlxuICogIGxvdHMgb2YgY29kZSBpbXByb3ZlbWVudHMgYnkgRnJhbmsgS2xlbW0gKCBodHRwOi8vd3d3LnVuaS1qZW5hLmRlL35wZmsvbXBwLyApXG4gKiAgICAtLSBjcmVkaXQgaGltIGZvciBhbGwgdGhlIF9nb29kXyBwcm9ncmFtbWluZyA7KVxuICpcbiAqXG4gKiAgRm9yIGFuIGV4cGxhbmF0aW9uIG9mIHRoZSBjb25jZXB0cyBhbmQgdGhlIGJhc2ljIGFsZ29yaXRobXMgaW52b2x2ZWQsIGdvIHRvOlxuICogICAgaHR0cDovL3d3dy5yZXBsYXlnYWluLm9yZy9cbiAqL1xuXG4vKlxuICogIEhlcmUncyB0aGUgZGVhbC4gQ2FsbFxuICpcbiAqICAgIEluaXRHYWluQW5hbHlzaXMgKCBsb25nIHNhbXBsZWZyZXEgKTtcbiAqXG4gKiAgdG8gaW5pdGlhbGl6ZSBldmVyeXRoaW5nLiBDYWxsXG4gKlxuICogICAgQW5hbHl6ZVNhbXBsZXMgKCB2YXIgRmxvYXRfdCogIGxlZnRfc2FtcGxlcyxcbiAqICAgICAgICAgICAgICAgICAgICAgdmFyIEZsb2F0X3QqICByaWdodF9zYW1wbGVzLFxuICogICAgICAgICAgICAgICAgICAgICBzaXplX3QgICAgICAgICAgbnVtX3NhbXBsZXMsXG4gKiAgICAgICAgICAgICAgICAgICAgIGludCAgICAgICAgICAgICBudW1fY2hhbm5lbHMgKTtcbiAqXG4gKiAgYXMgbWFueSB0aW1lcyBhcyB5b3Ugd2FudCwgd2l0aCBhcyBtYW55IG9yIGFzIGZldyBzYW1wbGVzIGFzIHlvdSB3YW50LlxuICogIElmIG1vbm8sIHBhc3MgdGhlIHNhbXBsZSBidWZmZXIgaW4gdGhyb3VnaCBsZWZ0X3NhbXBsZXMsIGxlYXZlXG4gKiAgcmlnaHRfc2FtcGxlcyBOVUxMLCBhbmQgbWFrZSBzdXJlIG51bV9jaGFubmVscyA9IDEuXG4gKlxuICogICAgR2V0VGl0bGVHYWluKClcbiAqXG4gKiAgd2lsbCByZXR1cm4gdGhlIHJlY29tbWVuZGVkIGRCIGxldmVsIGNoYW5nZSBmb3IgYWxsIHNhbXBsZXMgYW5hbHl6ZWRcbiAqICBTSU5DRSBUSEUgTEFTVCBUSU1FIHlvdSBjYWxsZWQgR2V0VGl0bGVHYWluKCkgT1IgSW5pdEdhaW5BbmFseXNpcygpLlxuICpcbiAqICAgIEdldEFsYnVtR2FpbigpXG4gKlxuICogIHdpbGwgcmV0dXJuIHRoZSByZWNvbW1lbmRlZCBkQiBsZXZlbCBjaGFuZ2UgZm9yIGFsbCBzYW1wbGVzIGFuYWx5emVkXG4gKiAgc2luY2UgSW5pdEdhaW5BbmFseXNpcygpIHdhcyBjYWxsZWQgYW5kIGZpbmFsaXplZCB3aXRoIEdldFRpdGxlR2FpbigpLlxuICpcbiAqICBQc2V1ZG8tY29kZSB0byBwcm9jZXNzIGFuIGFsYnVtOlxuICpcbiAqICAgIEZsb2F0X3QgICAgICAgbF9zYW1wbGVzIFs0MDk2XTtcbiAqICAgIEZsb2F0X3QgICAgICAgcl9zYW1wbGVzIFs0MDk2XTtcbiAqICAgIHNpemVfdCAgICAgICAgbnVtX3NhbXBsZXM7XG4gKiAgICB1bnNpZ25lZCBpbnQgIG51bV9zb25ncztcbiAqICAgIHVuc2lnbmVkIGludCAgaTtcbiAqXG4gKiAgICBJbml0R2FpbkFuYWx5c2lzICggNDQxMDAgKTtcbiAqICAgIGZvciAoIGkgPSAxOyBpIDw9IG51bV9zb25nczsgaSsrICkge1xuICogICAgICAgIHdoaWxlICggKCBudW1fc2FtcGxlcyA9IGdldFNvbmdTYW1wbGVzICggc29uZ1tpXSwgbGVmdF9zYW1wbGVzLCByaWdodF9zYW1wbGVzICkgKSA+IDAgKVxuICogICAgICAgICAgICBBbmFseXplU2FtcGxlcyAoIGxlZnRfc2FtcGxlcywgcmlnaHRfc2FtcGxlcywgbnVtX3NhbXBsZXMsIDIgKTtcbiAqICAgICAgICBmcHJpbnRmIChcIlJlY29tbWVuZGVkIGRCIGNoYW5nZSBmb3Igc29uZyAlMmQ6ICUrNi4yIGRCXFxuXCIsIGksIEdldFRpdGxlR2FpbigpICk7XG4gKiAgICB9XG4gKiAgICBmcHJpbnRmIChcIlJlY29tbWVuZGVkIGRCIGNoYW5nZSBmb3Igd2hvbGUgYWxidW06ICUrNi4yIGRCXFxuXCIsIEdldEFsYnVtR2FpbigpICk7XG4gKi9cblxuLypcbiAqICBTbyBoZXJlJ3MgdGhlIG1haW4gc291cmNlIG9mIHBvdGVudGlhbCBjb2RlIGNvbmZ1c2lvbjpcbiAqXG4gKiAgVGhlIGZpbHRlcnMgYXBwbGllZCB0byB0aGUgaW5jb21pbmcgc2FtcGxlcyBhcmUgSUlSIGZpbHRlcnMsXG4gKiAgbWVhbmluZyB0aGV5IHJlbHkgb24gdXAgdG8gPGZpbHRlciBvcmRlcj4gbnVtYmVyIG9mIHByZXZpb3VzIHNhbXBsZXNcbiAqICBBTkQgdXAgdG8gPGZpbHRlciBvcmRlcj4gbnVtYmVyIG9mIHByZXZpb3VzIGZpbHRlcmVkIHNhbXBsZXMuXG4gKlxuICogIEkgc2V0IHVwIHRoZSBBbmFseXplU2FtcGxlcyByb3V0aW5lIHRvIG1pbmltaXplIG1lbW9yeSB1c2FnZSBhbmQgaW50ZXJmYWNlXG4gKiAgY29tcGxleGl0eS4gVGhlIHNwZWVkIGlzbid0IGNvbXByb21pc2VkIHRvbyBtdWNoIChJIGRvbid0IHRoaW5rKSwgYnV0IHRoZVxuICogIGludGVybmFsIGNvbXBsZXhpdHkgaXMgaGlnaGVyIHRoYW4gaXQgc2hvdWxkIGJlIGZvciBzdWNoIGEgcmVsYXRpdmVseVxuICogIHNpbXBsZSByb3V0aW5lLlxuICpcbiAqICBPcHRpbWl6YXRpb24vY2xhcml0eSBzdWdnZXN0aW9ucyBhcmUgd2VsY29tZS5cbiAqL1xuXG4vKipcbiAqIFRhYmxlIGVudHJpZXMgcGVyIGRCXG4gKi9cbkdhaW5BbmFseXNpcy5TVEVQU19wZXJfZEIgPSAxMDAuO1xuLyoqXG4gKiBUYWJsZSBlbnRyaWVzIGZvciAwLi4uTUFYX2RCIChub3JtYWwgbWF4LiB2YWx1ZXMgYXJlIDcwLi4uODAgZEIpXG4gKi9cbkdhaW5BbmFseXNpcy5NQVhfZEIgPSAxMjAuO1xuR2FpbkFuYWx5c2lzLkdBSU5fTk9UX0VOT1VHSF9TQU1QTEVTID0gLTI0NjAxO1xuR2FpbkFuYWx5c2lzLkdBSU5fQU5BTFlTSVNfRVJST1IgPSAwO1xuR2FpbkFuYWx5c2lzLkdBSU5fQU5BTFlTSVNfT0sgPSAxO1xuR2FpbkFuYWx5c2lzLklOSVRfR0FJTl9BTkFMWVNJU19FUlJPUiA9IDA7XG5HYWluQW5hbHlzaXMuSU5JVF9HQUlOX0FOQUxZU0lTX09LID0gMTtcblxuR2FpbkFuYWx5c2lzLllVTEVfT1JERVIgPSAxMDtcbkdhaW5BbmFseXNpcy5NQVhfT1JERVIgPSBHYWluQW5hbHlzaXMuWVVMRV9PUkRFUjtcblxuR2FpbkFuYWx5c2lzLk1BWF9TQU1QX0ZSRVEgPSA0ODAwMDtcbkdhaW5BbmFseXNpcy5STVNfV0lORE9XX1RJTUVfTlVNRVJBVE9SID0gMTtcbkdhaW5BbmFseXNpcy5STVNfV0lORE9XX1RJTUVfREVOT01JTkFUT1IgPSAyMDtcbkdhaW5BbmFseXNpcy5NQVhfU0FNUExFU19QRVJfV0lORE9XID0gKChHYWluQW5hbHlzaXMuTUFYX1NBTVBfRlJFUSAqIEdhaW5BbmFseXNpcy5STVNfV0lORE9XX1RJTUVfTlVNRVJBVE9SKSAvIEdhaW5BbmFseXNpcy5STVNfV0lORE9XX1RJTUVfREVOT01JTkFUT1IgKyAxKTtcblxuZnVuY3Rpb24gR2FpbkFuYWx5c2lzKCkge1xuXHQvL2ZpeCDnsr7nroBcbn1cblxuXG5mdW5jdGlvbiBQcmVzZXRzKCkge1xuICAgIGZ1bmN0aW9uIFZCUlByZXNldHMocXVhbCwgY29tcCwgY29tcFMsXG4gICAgICAgICAgICAgICAgICAgICAgICB5LCBzaFRocmVzaG9sZCwgc2hUaHJlc2hvbGRTLFxuICAgICAgICAgICAgICAgICAgICAgICAgYWRqLCBhZGpTaG9ydCwgbG93ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJ2ZSwgc2VucywgaW50ZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBqb2ludCwgbW9kLCBmaXgpIHtcbiAgICAgICAgdGhpcy52YnJfcSA9IHF1YWw7XG4gICAgICAgIHRoaXMucXVhbnRfY29tcCA9IGNvbXA7XG4gICAgICAgIHRoaXMucXVhbnRfY29tcF9zID0gY29tcFM7XG4gICAgICAgIHRoaXMuZXhwWSA9IHk7XG4gICAgICAgIHRoaXMuc3RfbHJtID0gc2hUaHJlc2hvbGQ7XG4gICAgICAgIHRoaXMuc3RfcyA9IHNoVGhyZXNob2xkUztcbiAgICAgICAgdGhpcy5tYXNraW5nX2FkaiA9IGFkajtcbiAgICAgICAgdGhpcy5tYXNraW5nX2Fkal9zaG9ydCA9IGFkalNob3J0O1xuICAgICAgICB0aGlzLmF0aF9sb3dlciA9IGxvd2VyO1xuICAgICAgICB0aGlzLmF0aF9jdXJ2ZSA9IGN1cnZlO1xuICAgICAgICB0aGlzLmF0aF9zZW5zaXRpdml0eSA9IHNlbnM7XG4gICAgICAgIHRoaXMuaW50ZXJjaCA9IGludGVyO1xuICAgICAgICB0aGlzLnNhZmVqb2ludCA9IGpvaW50O1xuICAgICAgICB0aGlzLnNmYjIxbW9kID0gbW9kO1xuICAgICAgICB0aGlzLm1zZml4ID0gZml4O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIEFCUlByZXNldHMoa2JwcywgY29tcCwgY29tcFMsXG4gICAgICAgICAgICAgICAgICAgICAgICBqb2ludCwgZml4LCBzaFRocmVzaG9sZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHNoVGhyZXNob2xkUywgYmFzcywgc2MsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXNrLCBsb3dlciwgY3VydmUsXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnRlckNoLCBzZlNjYWxlKSB7XG4gICAgICAgIHRoaXMucXVhbnRfY29tcCA9IGNvbXA7XG4gICAgICAgIHRoaXMucXVhbnRfY29tcF9zID0gY29tcFM7XG4gICAgICAgIHRoaXMuc2FmZWpvaW50ID0gam9pbnQ7XG4gICAgICAgIHRoaXMubnNtc2ZpeCA9IGZpeDtcbiAgICAgICAgdGhpcy5zdF9scm0gPSBzaFRocmVzaG9sZDtcbiAgICAgICAgdGhpcy5zdF9zID0gc2hUaHJlc2hvbGRTO1xuICAgICAgICB0aGlzLm5zYmFzcyA9IGJhc3M7XG4gICAgICAgIHRoaXMuc2NhbGUgPSBzYztcbiAgICAgICAgdGhpcy5tYXNraW5nX2FkaiA9IG1hc2s7XG4gICAgICAgIHRoaXMuYXRoX2xvd2VyID0gbG93ZXI7XG4gICAgICAgIHRoaXMuYXRoX2N1cnZlID0gY3VydmU7XG4gICAgICAgIHRoaXMuaW50ZXJjaCA9IGludGVyQ2g7XG4gICAgICAgIHRoaXMuc2ZzY2FsZSA9IHNmU2NhbGU7XG4gICAgfVxuXG4gICAgdmFyIGxhbWU7XG5cbiAgICB0aGlzLnNldE1vZHVsZXMgPSBmdW5jdGlvbiAoX2xhbWUpIHtcbiAgICAgICAgbGFtZSA9IF9sYW1lO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiA8UFJFPlxuICAgICAqIFN3aXRjaCBtYXBwaW5ncyBmb3IgVkJSIG1vZGUgVkJSX1JIXG4gICAgICogICAgICAgICAgICAgdmJyX3EgIHFjb21wX2wgIHFjb21wX3MgIGV4cFkgIHN0X2xybSAgIHN0X3MgIG1hc2sgYWRqX2wgIGFkal9zICBhdGhfbG93ZXIgIGF0aF9jdXJ2ZSAgYXRoX3NlbnMgIGludGVyQ2hSICBzYWZlam9pbnQgc2ZiMjFtb2QgIG1zZml4XG4gICAgICogPC9QUkU+XG4gICAgICovXG4gICAgdmFyIHZicl9vbGRfc3dpdGNoX21hcCA9IFtcbiAgICAgICAgbmV3IFZCUlByZXNldHMoMCwgOSwgOSwgMCwgNS4yMCwgMTI1LjAsIC00LjIsIC02LjMsIDQuOCwgMSwgMCwgMCwgMiwgMjEsIDAuOTcpLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cygxLCA5LCA5LCAwLCA1LjMwLCAxMjUuMCwgLTMuNiwgLTUuNiwgNC41LCAxLjUsIDAsIDAsIDIsIDIxLCAxLjM1KSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoMiwgOSwgOSwgMCwgNS42MCwgMTI1LjAsIC0yLjIsIC0zLjUsIDIuOCwgMiwgMCwgMCwgMiwgMjEsIDEuNDkpLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cygzLCA5LCA5LCAxLCA1LjgwLCAxMzAuMCwgLTEuOCwgLTIuOCwgMi42LCAzLCAtNCwgMCwgMiwgMjAsIDEuNjQpLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cyg0LCA5LCA5LCAxLCA2LjAwLCAxMzUuMCwgLTAuNywgLTEuMSwgMS4xLCAzLjUsIC04LCAwLCAyLCAwLCAxLjc5KSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoNSwgOSwgOSwgMSwgNi40MCwgMTQwLjAsIDAuNSwgMC40LCAtNy41LCA0LCAtMTIsIDAuMDAwMiwgMCwgMCwgMS45NSksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDYsIDksIDksIDEsIDYuNjAsIDE0NS4wLCAwLjY3LCAwLjY1LCAtMTQuNywgNi41LCAtMTksIDAuMDAwNCwgMCwgMCwgMi4zMCksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDcsIDksIDksIDEsIDYuNjAsIDE0NS4wLCAwLjgsIDAuNzUsIC0xOS43LCA4LCAtMjIsIDAuMDAwNiwgMCwgMCwgMi43MCksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDgsIDksIDksIDEsIDYuNjAsIDE0NS4wLCAxLjIsIDEuMTUsIC0yNy41LCAxMCwgLTIzLCAwLjAwMDcsIDAsIDAsIDApLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cyg5LCA5LCA5LCAxLCA2LjYwLCAxNDUuMCwgMS42LCAxLjYsIC0zNiwgMTEsIC0yNSwgMC4wMDA4LCAwLCAwLCAwKSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoMTAsIDksIDksIDEsIDYuNjAsIDE0NS4wLCAyLjAsIDIuMCwgLTM2LCAxMiwgLTI1LCAwLjAwMDgsIDAsIDAsIDApXG4gICAgXTtcblxuICAgIC8qKlxuICAgICAqIDxQUkU+XG4gICAgICogICAgICAgICAgICAgICAgIHZicl9xICBxY29tcF9sICBxY29tcF9zICBleHBZICBzdF9scm0gICBzdF9zICBtYXNrIGFkal9sICBhZGpfcyAgYXRoX2xvd2VyICBhdGhfY3VydmUgIGF0aF9zZW5zICBpbnRlckNoUiAgc2FmZWpvaW50IHNmYjIxbW9kICBtc2ZpeFxuICAgICAqIDwvUFJFPlxuICAgICAqL1xuICAgIHZhciB2YnJfcHN5X3N3aXRjaF9tYXAgPSBbXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDAsIDksIDksIDAsIDQuMjAsIDI1LjAsIC03LjAsIC00LjAsIDcuNSwgMSwgMCwgMCwgMiwgMjYsIDAuOTcpLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cygxLCA5LCA5LCAwLCA0LjIwLCAyNS4wLCAtNS42LCAtMy42LCA0LjUsIDEuNSwgMCwgMCwgMiwgMjEsIDEuMzUpLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cygyLCA5LCA5LCAwLCA0LjIwLCAyNS4wLCAtNC40LCAtMS44LCAyLCAyLCAwLCAwLCAyLCAxOCwgMS40OSksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDMsIDksIDksIDEsIDQuMjAsIDI1LjAsIC0zLjQsIC0xLjI1LCAxLjEsIDMsIC00LCAwLCAyLCAxNSwgMS42NCksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDQsIDksIDksIDEsIDQuMjAsIDI1LjAsIC0yLjIsIDAuMSwgMCwgMy41LCAtOCwgMCwgMiwgMCwgMS43OSksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDUsIDksIDksIDEsIDQuMjAsIDI1LjAsIC0xLjAsIDEuNjUsIC03LjcsIDQsIC0xMiwgMC4wMDAyLCAwLCAwLCAxLjk1KSxcbiAgICAgICAgbmV3IFZCUlByZXNldHMoNiwgOSwgOSwgMSwgNC4yMCwgMjUuMCwgLTAuMCwgMi40NywgLTcuNywgNi41LCAtMTksIDAuMDAwNCwgMCwgMCwgMiksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDcsIDksIDksIDEsIDQuMjAsIDI1LjAsIDAuNSwgMi4wLCAtMTQuNSwgOCwgLTIyLCAwLjAwMDYsIDAsIDAsIDIpLFxuICAgICAgICBuZXcgVkJSUHJlc2V0cyg4LCA5LCA5LCAxLCA0LjIwLCAyNS4wLCAxLjAsIDIuNCwgLTIyLjAsIDEwLCAtMjMsIDAuMDAwNywgMCwgMCwgMiksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDksIDksIDksIDEsIDQuMjAsIDI1LjAsIDEuNSwgMi45NSwgLTMwLjAsIDExLCAtMjUsIDAuMDAwOCwgMCwgMCwgMiksXG4gICAgICAgIG5ldyBWQlJQcmVzZXRzKDEwLCA5LCA5LCAxLCA0LjIwLCAyNS4wLCAyLjAsIDIuOTUsIC0zNi4wLCAxMiwgLTMwLCAwLjAwMDgsIDAsIDAsIDIpXG4gICAgXTtcblxuICAgIGZ1bmN0aW9uIGFwcGx5X3Zicl9wcmVzZXQoZ2ZwLCBhLCBlbmZvcmNlKSB7XG4gICAgICAgIHZhciB2YnJfcHJlc2V0ID0gZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9yaCA/IHZicl9vbGRfc3dpdGNoX21hcFxuICAgICAgICAgICAgOiB2YnJfcHN5X3N3aXRjaF9tYXA7XG5cbiAgICAgICAgdmFyIHggPSBnZnAuVkJSX3FfZnJhYztcbiAgICAgICAgdmFyIHAgPSB2YnJfcHJlc2V0W2FdO1xuICAgICAgICB2YXIgcSA9IHZicl9wcmVzZXRbYSArIDFdO1xuICAgICAgICB2YXIgc2V0ID0gcDtcblxuICAgICAgICAvLyBOT09QKHZicl9xKTtcbiAgICAgICAgLy8gTk9PUChxdWFudF9jb21wKTtcbiAgICAgICAgLy8gTk9PUChxdWFudF9jb21wX3MpO1xuICAgICAgICAvLyBOT09QKGV4cFkpO1xuICAgICAgICBwLnN0X2xybSA9IHAuc3RfbHJtICsgeCAqIChxLnN0X2xybSAtIHAuc3RfbHJtKTtcbiAgICAgICAgLy8gTEVSUChzdF9scm0pO1xuICAgICAgICBwLnN0X3MgPSBwLnN0X3MgKyB4ICogKHEuc3RfcyAtIHAuc3Rfcyk7XG4gICAgICAgIC8vIExFUlAoc3Rfcyk7XG4gICAgICAgIHAubWFza2luZ19hZGogPSBwLm1hc2tpbmdfYWRqICsgeCAqIChxLm1hc2tpbmdfYWRqIC0gcC5tYXNraW5nX2Fkaik7XG4gICAgICAgIC8vIExFUlAobWFza2luZ19hZGopO1xuICAgICAgICBwLm1hc2tpbmdfYWRqX3Nob3J0ID0gcC5tYXNraW5nX2Fkal9zaG9ydCArIHhcbiAgICAgICAgICAgICogKHEubWFza2luZ19hZGpfc2hvcnQgLSBwLm1hc2tpbmdfYWRqX3Nob3J0KTtcbiAgICAgICAgLy8gTEVSUChtYXNraW5nX2Fkal9zaG9ydCk7XG4gICAgICAgIHAuYXRoX2xvd2VyID0gcC5hdGhfbG93ZXIgKyB4ICogKHEuYXRoX2xvd2VyIC0gcC5hdGhfbG93ZXIpO1xuICAgICAgICAvLyBMRVJQKGF0aF9sb3dlcik7XG4gICAgICAgIHAuYXRoX2N1cnZlID0gcC5hdGhfY3VydmUgKyB4ICogKHEuYXRoX2N1cnZlIC0gcC5hdGhfY3VydmUpO1xuICAgICAgICAvLyBMRVJQKGF0aF9jdXJ2ZSk7XG4gICAgICAgIHAuYXRoX3NlbnNpdGl2aXR5ID0gcC5hdGhfc2Vuc2l0aXZpdHkgKyB4XG4gICAgICAgICAgICAqIChxLmF0aF9zZW5zaXRpdml0eSAtIHAuYXRoX3NlbnNpdGl2aXR5KTtcbiAgICAgICAgLy8gTEVSUChhdGhfc2Vuc2l0aXZpdHkpO1xuICAgICAgICBwLmludGVyY2ggPSBwLmludGVyY2ggKyB4ICogKHEuaW50ZXJjaCAtIHAuaW50ZXJjaCk7XG4gICAgICAgIC8vIExFUlAoaW50ZXJjaCk7XG4gICAgICAgIC8vIE5PT1Aoc2FmZWpvaW50KTtcbiAgICAgICAgLy8gTk9PUChzZmIyMW1vZCk7XG4gICAgICAgIHAubXNmaXggPSBwLm1zZml4ICsgeCAqIChxLm1zZml4IC0gcC5tc2ZpeCk7XG4gICAgICAgIC8vIExFUlAobXNmaXgpO1xuXG4gICAgICAgIGxhbWVfc2V0X1ZCUl9xKGdmcCwgc2V0LnZicl9xKTtcblxuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLnF1YW50X2NvbXAgPSBzZXQucXVhbnRfY29tcDtcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAucXVhbnRfY29tcCAtIC0xKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLnF1YW50X2NvbXAgPSBzZXQucXVhbnRfY29tcDtcbiAgICAgICAgLy8gU0VUX09QVElPTihxdWFudF9jb21wLCBzZXQucXVhbnRfY29tcCwgLTEpO1xuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLnF1YW50X2NvbXBfc2hvcnQgPSBzZXQucXVhbnRfY29tcF9zO1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5xdWFudF9jb21wX3Nob3J0IC0gLTEpID4gMCkpXG4gICAgICAgICAgICBnZnAucXVhbnRfY29tcF9zaG9ydCA9IHNldC5xdWFudF9jb21wX3M7XG4gICAgICAgIC8vIFNFVF9PUFRJT04ocXVhbnRfY29tcF9zaG9ydCwgc2V0LnF1YW50X2NvbXBfcywgLTEpO1xuICAgICAgICBpZiAoc2V0LmV4cFkgIT0gMCkge1xuICAgICAgICAgICAgZ2ZwLmV4cGVyaW1lbnRhbFkgPSBzZXQuZXhwWSAhPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAuaW50ZXJuYWxfZmxhZ3MubnNQc3kuYXR0YWNrdGhyZSA9IHNldC5zdF9scm07XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLmludGVybmFsX2ZsYWdzLm5zUHN5LmF0dGFja3RocmUgLSAtMSkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5pbnRlcm5hbF9mbGFncy5uc1BzeS5hdHRhY2t0aHJlID0gc2V0LnN0X2xybTtcbiAgICAgICAgLy8gU0VUX09QVElPTihzaG9ydF90aHJlc2hvbGRfbHJtLCBzZXQuc3RfbHJtLCAtMSk7XG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAuaW50ZXJuYWxfZmxhZ3MubnNQc3kuYXR0YWNrdGhyZV9zID0gc2V0LnN0X3M7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLmludGVybmFsX2ZsYWdzLm5zUHN5LmF0dGFja3RocmVfcyAtIC0xKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLmludGVybmFsX2ZsYWdzLm5zUHN5LmF0dGFja3RocmVfcyA9IHNldC5zdF9zO1xuICAgICAgICAvLyBTRVRfT1BUSU9OKHNob3J0X3RocmVzaG9sZF9zLCBzZXQuc3RfcywgLTEpO1xuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLm1hc2tpbmdhZGp1c3QgPSBzZXQubWFza2luZ19hZGo7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLm1hc2tpbmdhZGp1c3QgLSAwKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLm1hc2tpbmdhZGp1c3QgPSBzZXQubWFza2luZ19hZGo7XG4gICAgICAgIC8vIFNFVF9PUFRJT04obWFza2luZ2FkanVzdCwgc2V0Lm1hc2tpbmdfYWRqLCAwKTtcbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5tYXNraW5nYWRqdXN0X3Nob3J0ID0gc2V0Lm1hc2tpbmdfYWRqX3Nob3J0O1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5tYXNraW5nYWRqdXN0X3Nob3J0IC0gMCkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5tYXNraW5nYWRqdXN0X3Nob3J0ID0gc2V0Lm1hc2tpbmdfYWRqX3Nob3J0O1xuICAgICAgICAvLyBTRVRfT1BUSU9OKG1hc2tpbmdhZGp1c3Rfc2hvcnQsIHNldC5tYXNraW5nX2Fkal9zaG9ydCwgMCk7XG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAuQVRIbG93ZXIgPSAtc2V0LmF0aF9sb3dlciAvIDEwLjA7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoKC1nZnAuQVRIbG93ZXIgKiAxMC4wKSAtIDApID4gMCkpXG4gICAgICAgICAgICBnZnAuQVRIbG93ZXIgPSAtc2V0LmF0aF9sb3dlciAvIDEwLjA7XG4gICAgICAgIC8vIFNFVF9PUFRJT04oQVRIbG93ZXIsIHNldC5hdGhfbG93ZXIsIDApO1xuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLkFUSGN1cnZlID0gc2V0LmF0aF9jdXJ2ZTtcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAuQVRIY3VydmUgLSAtMSkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5BVEhjdXJ2ZSA9IHNldC5hdGhfY3VydmU7XG4gICAgICAgIC8vIFNFVF9PUFRJT04oQVRIY3VydmUsIHNldC5hdGhfY3VydmUsIC0xKTtcbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5hdGhhYV9zZW5zaXRpdml0eSA9IHNldC5hdGhfc2Vuc2l0aXZpdHk7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLmF0aGFhX3NlbnNpdGl2aXR5IC0gLTEpID4gMCkpXG4gICAgICAgICAgICBnZnAuYXRoYWFfc2Vuc2l0aXZpdHkgPSBzZXQuYXRoX3NlbnNpdGl2aXR5O1xuICAgICAgICAvLyBTRVRfT1BUSU9OKGF0aGFhX3NlbnNpdGl2aXR5LCBzZXQuYXRoX3NlbnNpdGl2aXR5LCAwKTtcbiAgICAgICAgaWYgKHNldC5pbnRlcmNoID4gMCkge1xuICAgICAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgICAgICBnZnAuaW50ZXJDaFJhdGlvID0gc2V0LmludGVyY2g7XG4gICAgICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5pbnRlckNoUmF0aW8gLSAtMSkgPiAwKSlcbiAgICAgICAgICAgICAgICBnZnAuaW50ZXJDaFJhdGlvID0gc2V0LmludGVyY2g7XG4gICAgICAgICAgICAvLyBTRVRfT1BUSU9OKGludGVyQ2hSYXRpbywgc2V0LmludGVyY2gsIC0xKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIHBhcmFtZXRlcnMgZm9yIHdoaWNoIHRoZXJlIGlzIG5vIHByb3BlciBzZXQvZ2V0IGludGVyZmFjZSAqL1xuICAgICAgICBpZiAoc2V0LnNhZmVqb2ludCA+IDApIHtcbiAgICAgICAgICAgIGdmcC5leHBfbnNwc3l0dW5lID0gZ2ZwLmV4cF9uc3BzeXR1bmUgfCBzZXQuc2FmZWpvaW50O1xuICAgICAgICB9XG4gICAgICAgIGlmIChzZXQuc2ZiMjFtb2QgPiAwKSB7XG4gICAgICAgICAgICBnZnAuZXhwX25zcHN5dHVuZSA9IGdmcC5leHBfbnNwc3l0dW5lIHwgKHNldC5zZmIyMW1vZCA8PCAyMCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5tc2ZpeCA9IHNldC5tc2ZpeDtcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAubXNmaXggLSAtMSkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5tc2ZpeCA9IHNldC5tc2ZpeDtcbiAgICAgICAgLy8gU0VUX09QVElPTihtc2ZpeCwgc2V0Lm1zZml4LCAtMSk7XG5cbiAgICAgICAgaWYgKGVuZm9yY2UgPT0gMCkge1xuICAgICAgICAgICAgZ2ZwLlZCUl9xID0gYTtcbiAgICAgICAgICAgIGdmcC5WQlJfcV9mcmFjID0geDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIDxQUkU+XG4gICAgICogIFN3aXRjaCBtYXBwaW5ncyBmb3IgQUJSIG1vZGVcbiAgICAgKlxuICAgICAqICAgICAgICAgICAgICBrYnBzICBxdWFudCBxX3Mgc2FmZWpvaW50IG5zbXNmaXggc3RfbHJtICBzdF9zICBucy1iYXNzIHNjYWxlICAgbXNrIGF0aF9sd3IgYXRoX2N1cnZlICBpbnRlcmNoICwgc2ZzY2FsZVxuICAgICAqIDwvUFJFPlxuICAgICAqL1xuICAgIHZhciBhYnJfc3dpdGNoX21hcCA9IFtcbiAgICAgICAgbmV3IEFCUlByZXNldHMoOCwgOSwgOSwgMCwgMCwgNi42MCwgMTQ1LCAwLCAwLjk1LCAwLCAtMzAuMCwgMTEsIDAuMDAxMiwgMSksIC8qICAgOCwgaW1wb3NzaWJsZSB0byB1c2UgaW4gc3RlcmVvICovXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDE2LCA5LCA5LCAwLCAwLCA2LjYwLCAxNDUsIDAsIDAuOTUsIDAsIC0yNS4wLCAxMSwgMC4wMDEwLCAxKSwgLyogIDE2ICovXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDI0LCA5LCA5LCAwLCAwLCA2LjYwLCAxNDUsIDAsIDAuOTUsIDAsIC0yMC4wLCAxMSwgMC4wMDEwLCAxKSwgLyogIDI0ICovXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDMyLCA5LCA5LCAwLCAwLCA2LjYwLCAxNDUsIDAsIDAuOTUsIDAsIC0xNS4wLCAxMSwgMC4wMDEwLCAxKSwgLyogIDMyICovXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDQwLCA5LCA5LCAwLCAwLCA2LjYwLCAxNDUsIDAsIDAuOTUsIDAsIC0xMC4wLCAxMSwgMC4wMDA5LCAxKSwgLyogIDQwICovXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDQ4LCA5LCA5LCAwLCAwLCA2LjYwLCAxNDUsIDAsIDAuOTUsIDAsIC0xMC4wLCAxMSwgMC4wMDA5LCAxKSwgLyogIDQ4ICovXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDU2LCA5LCA5LCAwLCAwLCA2LjYwLCAxNDUsIDAsIDAuOTUsIDAsIC02LjAsIDExLCAwLjAwMDgsIDEpLCAvKiAgNTYgKi9cbiAgICAgICAgbmV3IEFCUlByZXNldHMoNjQsIDksIDksIDAsIDAsIDYuNjAsIDE0NSwgMCwgMC45NSwgMCwgLTIuMCwgMTEsIDAuMDAwOCwgMSksIC8qICA2NCAqL1xuICAgICAgICBuZXcgQUJSUHJlc2V0cyg4MCwgOSwgOSwgMCwgMCwgNi42MCwgMTQ1LCAwLCAwLjk1LCAwLCAuMCwgOCwgMC4wMDA3LCAxKSwgLyogIDgwICovXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDk2LCA5LCA5LCAwLCAyLjUwLCA2LjYwLCAxNDUsIDAsIDAuOTUsIDAsIDEuMCwgNS41LCAwLjAwMDYsIDEpLCAvKiAgOTYgKi9cbiAgICAgICAgbmV3IEFCUlByZXNldHMoMTEyLCA5LCA5LCAwLCAyLjI1LCA2LjYwLCAxNDUsIDAsIDAuOTUsIDAsIDIuMCwgNC41LCAwLjAwMDUsIDEpLCAvKiAxMTIgKi9cbiAgICAgICAgbmV3IEFCUlByZXNldHMoMTI4LCA5LCA5LCAwLCAxLjk1LCA2LjQwLCAxNDAsIDAsIDAuOTUsIDAsIDMuMCwgNCwgMC4wMDAyLCAxKSwgLyogMTI4ICovXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDE2MCwgOSwgOSwgMSwgMS43OSwgNi4wMCwgMTM1LCAwLCAwLjk1LCAtMiwgNS4wLCAzLjUsIDAsIDEpLCAvKiAxNjAgKi9cbiAgICAgICAgbmV3IEFCUlByZXNldHMoMTkyLCA5LCA5LCAxLCAxLjQ5LCA1LjYwLCAxMjUsIDAsIDAuOTcsIC00LCA3LjAsIDMsIDAsIDApLCAvKiAxOTIgKi9cbiAgICAgICAgbmV3IEFCUlByZXNldHMoMjI0LCA5LCA5LCAxLCAxLjI1LCA1LjIwLCAxMjUsIDAsIDAuOTgsIC02LCA5LjAsIDIsIDAsIDApLCAvKiAyMjQgKi9cbiAgICAgICAgbmV3IEFCUlByZXNldHMoMjU2LCA5LCA5LCAxLCAwLjk3LCA1LjIwLCAxMjUsIDAsIDEuMDAsIC04LCAxMC4wLCAxLCAwLCAwKSwgLyogMjU2ICovXG4gICAgICAgIG5ldyBBQlJQcmVzZXRzKDMyMCwgOSwgOSwgMSwgMC45MCwgNS4yMCwgMTI1LCAwLCAxLjAwLCAtMTAsIDEyLjAsIDAsIDAsIDApICAvKiAzMjAgKi9cbiAgICBdO1xuXG4gICAgZnVuY3Rpb24gYXBwbHlfYWJyX3ByZXNldChnZnAsIHByZXNldCwgZW5mb3JjZSkge1xuICAgICAgICAvKiBWYXJpYWJsZXMgZm9yIHRoZSBBQlIgc3R1ZmYgKi9cbiAgICAgICAgdmFyIGFjdHVhbF9iaXRyYXRlID0gcHJlc2V0O1xuXG4gICAgICAgIHZhciByID0gbGFtZS5uZWFyZXN0Qml0cmF0ZUZ1bGxJbmRleChwcmVzZXQpO1xuXG4gICAgICAgIGdmcC5WQlIgPSBWYnJNb2RlLnZicl9hYnI7XG4gICAgICAgIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMgPSBhY3R1YWxfYml0cmF0ZTtcbiAgICAgICAgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyA9IE1hdGgubWluKGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMsIDMyMCk7XG4gICAgICAgIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMgPSBNYXRoLm1heChnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzLCA4KTtcbiAgICAgICAgZ2ZwLmJyYXRlID0gZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcztcbiAgICAgICAgaWYgKGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMgPiAzMjApIHtcbiAgICAgICAgICAgIGdmcC5kaXNhYmxlX3Jlc2Vydm9pciA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBwYXJhbWV0ZXJzIGZvciB3aGljaCB0aGVyZSBpcyBubyBwcm9wZXIgc2V0L2dldCBpbnRlcmZhY2UgKi9cbiAgICAgICAgaWYgKGFicl9zd2l0Y2hfbWFwW3JdLnNhZmVqb2ludCA+IDApXG4gICAgICAgICAgICBnZnAuZXhwX25zcHN5dHVuZSA9IGdmcC5leHBfbnNwc3l0dW5lIHwgMjtcbiAgICAgICAgLyogc2FmZWpvaW50ICovXG5cbiAgICAgICAgaWYgKGFicl9zd2l0Y2hfbWFwW3JdLnNmc2NhbGUgPiAwKSB7XG4gICAgICAgICAgICBnZnAuaW50ZXJuYWxfZmxhZ3Mubm9pc2Vfc2hhcGluZyA9IDI7XG4gICAgICAgIH1cbiAgICAgICAgLyogbnMtYmFzcyB0d2Vha3MgKi9cbiAgICAgICAgaWYgKE1hdGguYWJzKGFicl9zd2l0Y2hfbWFwW3JdLm5zYmFzcykgPiAwKSB7XG4gICAgICAgICAgICB2YXIgayA9IChpbnQpKGFicl9zd2l0Y2hfbWFwW3JdLm5zYmFzcyAqIDQpO1xuICAgICAgICAgICAgaWYgKGsgPCAwKVxuICAgICAgICAgICAgICAgIGsgKz0gNjQ7XG4gICAgICAgICAgICBnZnAuZXhwX25zcHN5dHVuZSA9IGdmcC5leHBfbnNwc3l0dW5lIHwgKGsgPDwgMik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLnF1YW50X2NvbXAgPSBhYnJfc3dpdGNoX21hcFtyXS5xdWFudF9jb21wO1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5xdWFudF9jb21wIC0gLTEpID4gMCkpXG4gICAgICAgICAgICBnZnAucXVhbnRfY29tcCA9IGFicl9zd2l0Y2hfbWFwW3JdLnF1YW50X2NvbXA7XG4gICAgICAgIC8vIFNFVF9PUFRJT04ocXVhbnRfY29tcCwgYWJyX3N3aXRjaF9tYXBbcl0ucXVhbnRfY29tcCwgLTEpO1xuICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgZ2ZwLnF1YW50X2NvbXBfc2hvcnQgPSBhYnJfc3dpdGNoX21hcFtyXS5xdWFudF9jb21wX3M7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLnF1YW50X2NvbXBfc2hvcnQgLSAtMSkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5xdWFudF9jb21wX3Nob3J0ID0gYWJyX3N3aXRjaF9tYXBbcl0ucXVhbnRfY29tcF9zO1xuICAgICAgICAvLyBTRVRfT1BUSU9OKHF1YW50X2NvbXBfc2hvcnQsIGFicl9zd2l0Y2hfbWFwW3JdLnF1YW50X2NvbXBfcywgLTEpO1xuXG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAubXNmaXggPSBhYnJfc3dpdGNoX21hcFtyXS5uc21zZml4O1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5tc2ZpeCAtIC0xKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLm1zZml4ID0gYWJyX3N3aXRjaF9tYXBbcl0ubnNtc2ZpeDtcbiAgICAgICAgLy8gU0VUX09QVElPTihtc2ZpeCwgYWJyX3N3aXRjaF9tYXBbcl0ubnNtc2ZpeCwgLTEpO1xuXG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAuaW50ZXJuYWxfZmxhZ3MubnNQc3kuYXR0YWNrdGhyZSA9IGFicl9zd2l0Y2hfbWFwW3JdLnN0X2xybTtcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAuaW50ZXJuYWxfZmxhZ3MubnNQc3kuYXR0YWNrdGhyZSAtIC0xKSA+IDApKVxuICAgICAgICAgICAgZ2ZwLmludGVybmFsX2ZsYWdzLm5zUHN5LmF0dGFja3RocmUgPSBhYnJfc3dpdGNoX21hcFtyXS5zdF9scm07XG4gICAgICAgIC8vIFNFVF9PUFRJT04oc2hvcnRfdGhyZXNob2xkX2xybSwgYWJyX3N3aXRjaF9tYXBbcl0uc3RfbHJtLCAtMSk7XG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAuaW50ZXJuYWxfZmxhZ3MubnNQc3kuYXR0YWNrdGhyZV9zID0gYWJyX3N3aXRjaF9tYXBbcl0uc3RfcztcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAuaW50ZXJuYWxfZmxhZ3MubnNQc3kuYXR0YWNrdGhyZV9zIC0gLTEpID4gMCkpXG4gICAgICAgICAgICBnZnAuaW50ZXJuYWxfZmxhZ3MubnNQc3kuYXR0YWNrdGhyZV9zID0gYWJyX3N3aXRjaF9tYXBbcl0uc3RfcztcbiAgICAgICAgLy8gU0VUX09QVElPTihzaG9ydF90aHJlc2hvbGRfcywgYWJyX3N3aXRjaF9tYXBbcl0uc3RfcywgLTEpO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIEFCUiBzZWVtcyB0byBoYXZlIGJpZyBwcm9ibGVtcyB3aXRoIGNsaXBwaW5nLCBlc3BlY2lhbGx5IGF0IGxvd1xuICAgICAgICAgKiBiaXRyYXRlc1xuICAgICAgICAgKi9cbiAgICAgICAgLypcbiAgICAgICAgICogc28gd2UgY29tcGVuc2F0ZSBmb3IgdGhhdCBoZXJlIGJ5IHVzaW5nIGEgc2NhbGUgdmFsdWUgZGVwZW5kaW5nIG9uXG4gICAgICAgICAqIGJpdHJhdGVcbiAgICAgICAgICovXG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAuc2NhbGUgPSBhYnJfc3dpdGNoX21hcFtyXS5zY2FsZTtcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAuc2NhbGUgLSAtMSkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5zY2FsZSA9IGFicl9zd2l0Y2hfbWFwW3JdLnNjYWxlO1xuICAgICAgICAvLyBTRVRfT1BUSU9OKHNjYWxlLCBhYnJfc3dpdGNoX21hcFtyXS5zY2FsZSwgLTEpO1xuXG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAubWFza2luZ2FkanVzdCA9IGFicl9zd2l0Y2hfbWFwW3JdLm1hc2tpbmdfYWRqO1xuICAgICAgICBlbHNlIGlmICghKE1hdGguYWJzKGdmcC5tYXNraW5nYWRqdXN0IC0gMCkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5tYXNraW5nYWRqdXN0ID0gYWJyX3N3aXRjaF9tYXBbcl0ubWFza2luZ19hZGo7XG4gICAgICAgIC8vIFNFVF9PUFRJT04obWFza2luZ2FkanVzdCwgYWJyX3N3aXRjaF9tYXBbcl0ubWFza2luZ19hZGosIDApO1xuICAgICAgICBpZiAoYWJyX3N3aXRjaF9tYXBbcl0ubWFza2luZ19hZGogPiAwKSB7XG4gICAgICAgICAgICBpZiAoZW5mb3JjZSAhPSAwKVxuICAgICAgICAgICAgICAgIGdmcC5tYXNraW5nYWRqdXN0X3Nob3J0ID0gKGFicl9zd2l0Y2hfbWFwW3JdLm1hc2tpbmdfYWRqICogLjkpO1xuICAgICAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAubWFza2luZ2FkanVzdF9zaG9ydCAtIDApID4gMCkpXG4gICAgICAgICAgICAgICAgZ2ZwLm1hc2tpbmdhZGp1c3Rfc2hvcnQgPSAoYWJyX3N3aXRjaF9tYXBbcl0ubWFza2luZ19hZGogKiAuOSk7XG4gICAgICAgICAgICAvLyBTRVRfT1BUSU9OKG1hc2tpbmdhZGp1c3Rfc2hvcnQsIGFicl9zd2l0Y2hfbWFwW3JdLm1hc2tpbmdfYWRqICpcbiAgICAgICAgICAgIC8vIC45LCAwKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICAgICAgZ2ZwLm1hc2tpbmdhZGp1c3Rfc2hvcnQgPSAoYWJyX3N3aXRjaF9tYXBbcl0ubWFza2luZ19hZGogKiAxLjEpO1xuICAgICAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAubWFza2luZ2FkanVzdF9zaG9ydCAtIDApID4gMCkpXG4gICAgICAgICAgICAgICAgZ2ZwLm1hc2tpbmdhZGp1c3Rfc2hvcnQgPSAoYWJyX3N3aXRjaF9tYXBbcl0ubWFza2luZ19hZGogKiAxLjEpO1xuICAgICAgICAgICAgLy8gU0VUX09QVElPTihtYXNraW5nYWRqdXN0X3Nob3J0LCBhYnJfc3dpdGNoX21hcFtyXS5tYXNraW5nX2FkaiAqXG4gICAgICAgICAgICAvLyAxLjEsIDApO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGVuZm9yY2UgIT0gMClcbiAgICAgICAgICAgIGdmcC5BVEhsb3dlciA9IC1hYnJfc3dpdGNoX21hcFtyXS5hdGhfbG93ZXIgLyAxMC47XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoKC1nZnAuQVRIbG93ZXIgKiAxMC4pIC0gMCkgPiAwKSlcbiAgICAgICAgICAgIGdmcC5BVEhsb3dlciA9IC1hYnJfc3dpdGNoX21hcFtyXS5hdGhfbG93ZXIgLyAxMC47XG4gICAgICAgIC8vIFNFVF9PUFRJT04oQVRIbG93ZXIsIGFicl9zd2l0Y2hfbWFwW3JdLmF0aF9sb3dlciwgMCk7XG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAuQVRIY3VydmUgPSBhYnJfc3dpdGNoX21hcFtyXS5hdGhfY3VydmU7XG4gICAgICAgIGVsc2UgaWYgKCEoTWF0aC5hYnMoZ2ZwLkFUSGN1cnZlIC0gLTEpID4gMCkpXG4gICAgICAgICAgICBnZnAuQVRIY3VydmUgPSBhYnJfc3dpdGNoX21hcFtyXS5hdGhfY3VydmU7XG4gICAgICAgIC8vIFNFVF9PUFRJT04oQVRIY3VydmUsIGFicl9zd2l0Y2hfbWFwW3JdLmF0aF9jdXJ2ZSwgLTEpO1xuXG4gICAgICAgIGlmIChlbmZvcmNlICE9IDApXG4gICAgICAgICAgICBnZnAuaW50ZXJDaFJhdGlvID0gYWJyX3N3aXRjaF9tYXBbcl0uaW50ZXJjaDtcbiAgICAgICAgZWxzZSBpZiAoIShNYXRoLmFicyhnZnAuaW50ZXJDaFJhdGlvIC0gLTEpID4gMCkpXG4gICAgICAgICAgICBnZnAuaW50ZXJDaFJhdGlvID0gYWJyX3N3aXRjaF9tYXBbcl0uaW50ZXJjaDtcbiAgICAgICAgLy8gU0VUX09QVElPTihpbnRlckNoUmF0aW8sIGFicl9zd2l0Y2hfbWFwW3JdLmludGVyY2gsIC0xKTtcblxuICAgICAgICByZXR1cm4gcHJlc2V0O1xuICAgIH1cblxuICAgIHRoaXMuYXBwbHlfcHJlc2V0ID0gZnVuY3Rpb24oZ2ZwLCBwcmVzZXQsIGVuZm9yY2UpIHtcbiAgICAgICAgLyogdHJhbnNsYXRlIGxlZ2FjeSBwcmVzZXRzICovXG4gICAgICAgIHN3aXRjaCAocHJlc2V0KSB7XG4gICAgICAgICAgICBjYXNlIExhbWUuUjNNSVg6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJlc2V0ID0gTGFtZS5WMztcbiAgICAgICAgICAgICAgICBnZnAuVkJSID0gVmJyTW9kZS52YnJfbXRyaDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgTGFtZS5NRURJVU06XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJlc2V0ID0gTGFtZS5WNDtcbiAgICAgICAgICAgICAgICBnZnAuVkJSID0gVmJyTW9kZS52YnJfcmg7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIExhbWUuTUVESVVNX0ZBU1Q6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJlc2V0ID0gTGFtZS5WNDtcbiAgICAgICAgICAgICAgICBnZnAuVkJSID0gVmJyTW9kZS52YnJfbXRyaDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgTGFtZS5TVEFOREFSRDpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcmVzZXQgPSBMYW1lLlYyO1xuICAgICAgICAgICAgICAgIGdmcC5WQlIgPSBWYnJNb2RlLnZicl9yaDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgTGFtZS5TVEFOREFSRF9GQVNUOlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHByZXNldCA9IExhbWUuVjI7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUiA9IFZick1vZGUudmJyX210cmg7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXNlIExhbWUuRVhUUkVNRTpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBwcmVzZXQgPSBMYW1lLlYwO1xuICAgICAgICAgICAgICAgIGdmcC5WQlIgPSBWYnJNb2RlLnZicl9yaDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgTGFtZS5FWFRSRU1FX0ZBU1Q6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJlc2V0ID0gTGFtZS5WMDtcbiAgICAgICAgICAgICAgICBnZnAuVkJSID0gVmJyTW9kZS52YnJfbXRyaDtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhc2UgTGFtZS5JTlNBTkU6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcHJlc2V0ID0gMzIwO1xuICAgICAgICAgICAgICAgIGdmcC5wcmVzZXQgPSBwcmVzZXQ7XG4gICAgICAgICAgICAgICAgYXBwbHlfYWJyX3ByZXNldChnZnAsIHByZXNldCwgZW5mb3JjZSk7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUiA9IFZick1vZGUudmJyX29mZjtcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJlc2V0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZ2ZwLnByZXNldCA9IHByZXNldDtcbiAgICAgICAge1xuICAgICAgICAgICAgc3dpdGNoIChwcmVzZXQpIHtcbiAgICAgICAgICAgICAgICBjYXNlIExhbWUuVjk6XG4gICAgICAgICAgICAgICAgICAgIGFwcGx5X3Zicl9wcmVzZXQoZ2ZwLCA5LCBlbmZvcmNlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByZXNldDtcbiAgICAgICAgICAgICAgICBjYXNlIExhbWUuVjg6XG4gICAgICAgICAgICAgICAgICAgIGFwcGx5X3Zicl9wcmVzZXQoZ2ZwLCA4LCBlbmZvcmNlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByZXNldDtcbiAgICAgICAgICAgICAgICBjYXNlIExhbWUuVjc6XG4gICAgICAgICAgICAgICAgICAgIGFwcGx5X3Zicl9wcmVzZXQoZ2ZwLCA3LCBlbmZvcmNlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByZXNldDtcbiAgICAgICAgICAgICAgICBjYXNlIExhbWUuVjY6XG4gICAgICAgICAgICAgICAgICAgIGFwcGx5X3Zicl9wcmVzZXQoZ2ZwLCA2LCBlbmZvcmNlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByZXNldDtcbiAgICAgICAgICAgICAgICBjYXNlIExhbWUuVjU6XG4gICAgICAgICAgICAgICAgICAgIGFwcGx5X3Zicl9wcmVzZXQoZ2ZwLCA1LCBlbmZvcmNlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByZXNldDtcbiAgICAgICAgICAgICAgICBjYXNlIExhbWUuVjQ6XG4gICAgICAgICAgICAgICAgICAgIGFwcGx5X3Zicl9wcmVzZXQoZ2ZwLCA0LCBlbmZvcmNlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByZXNldDtcbiAgICAgICAgICAgICAgICBjYXNlIExhbWUuVjM6XG4gICAgICAgICAgICAgICAgICAgIGFwcGx5X3Zicl9wcmVzZXQoZ2ZwLCAzLCBlbmZvcmNlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByZXNldDtcbiAgICAgICAgICAgICAgICBjYXNlIExhbWUuVjI6XG4gICAgICAgICAgICAgICAgICAgIGFwcGx5X3Zicl9wcmVzZXQoZ2ZwLCAyLCBlbmZvcmNlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByZXNldDtcbiAgICAgICAgICAgICAgICBjYXNlIExhbWUuVjE6XG4gICAgICAgICAgICAgICAgICAgIGFwcGx5X3Zicl9wcmVzZXQoZ2ZwLCAxLCBlbmZvcmNlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByZXNldDtcbiAgICAgICAgICAgICAgICBjYXNlIExhbWUuVjA6XG4gICAgICAgICAgICAgICAgICAgIGFwcGx5X3Zicl9wcmVzZXQoZ2ZwLCAwLCBlbmZvcmNlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByZXNldDtcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoOCA8PSBwcmVzZXQgJiYgcHJlc2V0IDw9IDMyMCkge1xuICAgICAgICAgICAgcmV0dXJuIGFwcGx5X2Ficl9wcmVzZXQoZ2ZwLCBwcmVzZXQsIGVuZm9yY2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogbm8gY29ycmVzcG9uZGluZyBwcmVzZXQgZm91bmQgKi9cbiAgICAgICAgZ2ZwLnByZXNldCA9IDA7XG4gICAgICAgIHJldHVybiBwcmVzZXQ7XG4gICAgfVxuXG4gICAgLy8gUmVzdCBmcm9tIGdldHNldC5jOlxuXG4gICAgLyoqXG4gICAgICogVkJSIHF1YWxpdHkgbGV2ZWwuPEJSPlxuICAgICAqIDAgPSBoaWdoZXN0PEJSPlxuICAgICAqIDkgPSBsb3dlc3RcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBsYW1lX3NldF9WQlJfcShnZnAsIFZCUl9xKSB7XG4gICAgICAgIHZhciByZXQgPSAwO1xuXG4gICAgICAgIGlmICgwID4gVkJSX3EpIHtcbiAgICAgICAgICAgIC8qIFVua25vd24gVkJSIHF1YWxpdHkgbGV2ZWwhICovXG4gICAgICAgICAgICByZXQgPSAtMTtcbiAgICAgICAgICAgIFZCUl9xID0gMDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoOSA8IFZCUl9xKSB7XG4gICAgICAgICAgICByZXQgPSAtMTtcbiAgICAgICAgICAgIFZCUl9xID0gOTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdmcC5WQlJfcSA9IFZCUl9xO1xuICAgICAgICBnZnAuVkJSX3FfZnJhYyA9IDA7XG4gICAgICAgIHJldHVybiByZXQ7XG4gICAgfVxuXG59XG5cbi8qXG4gKiAgICAgIGJpdCByZXNlcnZvaXIgc291cmNlIGZpbGVcbiAqXG4gKiAgICAgIENvcHlyaWdodCAoYykgMTk5OS0yMDAwIE1hcmsgVGF5bG9yXG4gKlxuICogVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vclxuICogbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpY1xuICogTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyXG4gKiB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG4gKlxuICogVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG4gKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlVcbiAqIExpYnJhcnkgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLlxuICpcbiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWNcbiAqIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgd3JpdGUgdG8gdGhlXG4gKiBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIEluYy4sIDU5IFRlbXBsZSBQbGFjZSAtIFN1aXRlIDMzMCxcbiAqIEJvc3RvbiwgTUEgMDIxMTEtMTMwNywgVVNBLlxuICovXG5cbi8qICRJZDogUmVzZXJ2b2lyLmphdmEsdiAxLjkgMjAxMS8wNS8yNCAyMDo0ODowNiBrZW5jaGlzIEV4cCAkICovXG5cbi8vcGFja2FnZSBtcDM7XG5cbi8qKlxuICogUmVzdkZyYW1lQmVnaW46PEJSPlxuICogQ2FsbGVkIChyZXBlYXRlZGx5KSBhdCB0aGUgYmVnaW5uaW5nIG9mIGEgZnJhbWUuIFVwZGF0ZXMgdGhlIG1heGltdW0gc2l6ZSBvZlxuICogdGhlIHJlc2Vydm9pciwgYW5kIGNoZWNrcyB0byBtYWtlIHN1cmUgbWFpbl9kYXRhX2JlZ2luIHdhcyBzZXQgcHJvcGVybHkgYnlcbiAqIHRoZSBmb3JtYXR0ZXI8QlI+XG4gKiBCYWNrZ3JvdW5kIGluZm9ybWF0aW9uOlxuICogXG4gKiBUaGlzIGlzIHRoZSBvcmlnaW5hbCB0ZXh0IGZyb20gdGhlIElTTyBzdGFuZGFyZC4gQmVjYXVzZSBvZiBzb29vIG1hbnkgYnVnc1xuICogYW5kIGlycml0YXRpb25zIGNvcnJlY3RpbmcgY29tbWVudHMgYXJlIGFkZGVkIGluIGJyYWNrZXRzIFtdLiBBICdeVycgbWVhbnNcbiAqIHlvdSBzaG91bGQgcmVtb3ZlIHRoZSBsYXN0IHdvcmQuXG4gKiBcbiAqIDxQUkU+XG4gKiAgMS4gVGhlIGZvbGxvd2luZyBydWxlIGNhbiBiZSB1c2VkIHRvIGNhbGN1bGF0ZSB0aGUgbWF4aW11bVxuICogICAgIG51bWJlciBvZiBiaXRzIHVzZWQgZm9yIG9uZSBncmFudWxlIFteVyBmcmFtZV06PEJSPlxuICogICAgIEF0IHRoZSBoaWdoZXN0IHBvc3NpYmxlIGJpdHJhdGUgb2YgTGF5ZXIgSUlJICgzMjAga2Jwc1xuICogICAgIHBlciBzdGVyZW8gc2lnbmFsIFteV15XXlddLCA0OCBrSHopIHRoZSBmcmFtZXMgbXVzdCBiZSBvZlxuICogICAgIFteV15XXlcgYXJlIGRlc2lnbmVkIHRvIGhhdmVdIGNvbnN0YW50IGxlbmd0aCwgaS5lLlxuICogICAgIG9uZSBidWZmZXIgW15XXlcgdGhlIGZyYW1lXSBsZW5ndGggaXM6PEJSPlxuICogXG4gKiAgICAgICAgIDMyMCBrYnBzICogMTE1Mi80OCBrSHogPSA3NjgwIGJpdCA9IDk2MCBieXRlXG4gKiBcbiAqICAgICBUaGlzIHZhbHVlIGlzIHVzZWQgYXMgdGhlIG1heGltdW0gYnVmZmVyIHBlciBjaGFubmVsIFteV15XXSBhdFxuICogICAgIGxvd2VyIGJpdHJhdGVzIFt0aGFuIDMyMCBrYnBzXS4gQXQgNjQga2JwcyBtb25vIG9yIDEyOCBrYnBzXG4gKiAgICAgc3RlcmVvIHRoZSBtYWluIGdyYW51bGUgbGVuZ3RoIGlzIDY0IGticHMgKiA1NzYvNDgga0h6ID0gNzY4IGJpdFxuICogICAgIFtwZXIgZ3JhbnVsZSBhbmQgY2hhbm5lbF0gYXQgNDgga0h6IHNhbXBsaW5nIGZyZXF1ZW5jeS5cbiAqICAgICBUaGlzIG1lYW5zIHRoYXQgdGhlcmUgaXMgYSBtYXhpbXVtIGRldmlhdGlvbiAoc2hvcnQgdGltZSBidWZmZXJcbiAqICAgICBbPSByZXNlcnZvaXJdKSBvZiA3NjgwIC0gMioyKjc2OCA9IDQ2MDggYml0cyBpcyBhbGxvd2VkIGF0IDY0IGticHMuXG4gKiAgICAgVGhlIGFjdHVhbCBkZXZpYXRpb24gaXMgZXF1YWwgdG8gdGhlIG51bWJlciBvZiBieXRlcyBbd2l0aCB0aGVcbiAqICAgICBtZWFuaW5nIG9mIG9jdGV0c10gZGVub3RlZCBieSB0aGUgbWFpbl9kYXRhX2VuZCBvZmZzZXQgcG9pbnRlci5cbiAqICAgICBUaGUgYWN0dWFsIG1heGltdW0gZGV2aWF0aW9uIGlzICgyXjktMSkqOCBiaXQgPSA0MDg4IGJpdHNcbiAqICAgICBbZm9yIE1QRUctMSBhbmQgKDJeOC0xKSo4IGJpdCBmb3IgTVBFRy0yLCBib3RoIGFyZSBoYXJkIGxpbWl0c10uXG4gKiAgICAgLi4uIFRoZSB4Y2hhbmdlIG9mIGJ1ZmZlciBiaXRzIGJldHdlZW4gdGhlIGxlZnQgYW5kIHJpZ2h0IGNoYW5uZWxcbiAqICAgICBpcyBhbGxvd2VkIHdpdGhvdXQgcmVzdHJpY3Rpb25zIFtleGNlcHRpb246IGR1YWwgY2hhbm5lbF0uXG4gKiAgICAgQmVjYXVzZSBvZiB0aGUgW2NvbnN0cnVjdGVkXSBjb25zdHJhaW50IG9uIHRoZSBidWZmZXIgc2l6ZVxuICogICAgIG1haW5fZGF0YV9lbmQgaXMgYWx3YXlzIHNldCB0byAwIGluIHRoZSBjYXNlIG9mIGJpdF9yYXRlX2luZGV4PT0xNCxcbiAqICAgICBpLmUuIGRhdGEgcmF0ZSAzMjAga2JwcyBwZXIgc3RlcmVvIHNpZ25hbCBbXldeV15XXS4gSW4gdGhpcyBjYXNlXG4gKiAgICAgYWxsIGRhdGEgYXJlIGFsbG9jYXRlZCBiZXR3ZWVuIGFkamFjZW50IGhlYWRlciBbXlcgc3luY10gd29yZHNcbiAqICAgICBbLCBpLmUuIHRoZXJlIGlzIG5vIGJ1ZmZlcmluZyBhdCBhbGxdLlxuICogPC9QUkU+XG4gKi9cblxuXG5mdW5jdGlvbiBSZXNlcnZvaXIoKSB7XG5cdHZhciBicztcblxuXHR0aGlzLnNldE1vZHVsZXMgID0gZnVuY3Rpb24oX2JzKSB7XG5cdFx0YnMgPSBfYnM7XG5cdH1cblxuXHR0aGlzLlJlc3ZGcmFtZUJlZ2luID0gZnVuY3Rpb24oZ2ZwLCBtZWFuX2JpdHMpIHtcblx0XHR2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXHRcdHZhciBtYXhtcDNidWY7XG5cdFx0dmFyIGwzX3NpZGUgPSBnZmMubDNfc2lkZTtcblxuXHRcdHZhciBmcmFtZUxlbmd0aCA9IGJzLmdldGZyYW1lYml0cyhnZnApO1xuXHRcdG1lYW5fYml0cy5iaXRzID0gKGZyYW1lTGVuZ3RoIC0gZ2ZjLnNpZGVpbmZvX2xlbiAqIDgpIC8gZ2ZjLm1vZGVfZ3I7XG5cblx0XHQvKipcblx0XHQgKiA8UFJFPlxuXHRcdCAqICBNZWFuaW5nIG9mIHRoZSB2YXJpYWJsZXM6XG5cdFx0ICogICAgICByZXN2TGltaXQ6ICgwLCA4LCAuLi4sIDgqMjU1IChNUEVHLTIpLCA4KjUxMSAoTVBFRy0xKSlcblx0XHQgKiAgICAgICAgICBOdW1iZXIgb2YgYml0cyBjYW4gYmUgc3RvcmVkIGluIHByZXZpb3VzIGZyYW1lKHMpIGR1ZSB0b1xuXHRcdCAqICAgICAgICAgIGNvdW50ZXIgc2l6ZSBjb25zdGFpbnRzXG5cdFx0ICogICAgICBtYXhtcDNidWY6ICggPz8/IC4uLiA4KjE5NTEgKE1QRUctMSBhbmQgMiksIDgqMjA0NyAoTVBFRy0yLjUpKVxuXHRcdCAqICAgICAgICAgIE51bWJlciBvZiBiaXRzIGFsbG93ZWQgdG8gZW5jb2RlIG9uZSBmcmFtZSAoeW91IGNhbiB0YWtlIDgqNTExIGJpdFxuXHRcdCAqICAgICAgICAgIGZyb20gdGhlIGJpdCByZXNlcnZvaXIgYW5kIGF0IG1vc3QgOCoxNDQwIGJpdCBmcm9tIHRoZSBjdXJyZW50XG5cdFx0ICogICAgICAgICAgZnJhbWUgKDMyMCBrYnBzLCAzMiBrSHopLCBzbyA4KjE5NTEgYml0IGlzIHRoZSBsYXJnZXN0IHBvc3NpYmxlXG5cdFx0ICogICAgICAgICAgdmFsdWUgZm9yIE1QRUctMSBhbmQgLTIpXG5cdFx0ICogXG5cdFx0ICogICAgICAgICAgbWF4aW11bSBhbGxvd2VkIGdyYW51bGUvY2hhbm5lbCBzaXplIHRpbWVzIDQgPSA4KjIwNDcgYml0cy4sXG5cdFx0ICogICAgICAgICAgc28gdGhpcyBpcyB0aGUgYWJzb2x1dGUgbWF4aW11bSBzdXBwb3J0ZWQgYnkgdGhlIGZvcm1hdC5cblx0XHQgKiBcblx0XHQgKiBcblx0XHQgKiAgICAgIGZ1bGxGcmFtZUJpdHM6ICBtYXhpbXVtIG51bWJlciBvZiBiaXRzIGF2YWlsYWJsZSBmb3IgZW5jb2Rpbmdcblx0XHQgKiAgICAgICAgICAgICAgICAgICAgICB0aGUgY3VycmVudCBmcmFtZS5cblx0XHQgKiBcblx0XHQgKiAgICAgIG1lYW5fYml0czogICAgICB0YXJnZXQgbnVtYmVyIG9mIGJpdHMgcGVyIGdyYW51bGUuXG5cdFx0ICogXG5cdFx0ICogICAgICBmcmFtZUxlbmd0aDpcblx0XHQgKiBcblx0XHQgKiAgICAgIGdmYy5SZXN2TWF4OiAgIG1heGltdW0gYWxsb3dlZCByZXNlcnZvaXJcblx0XHQgKiBcblx0XHQgKiAgICAgIGdmYy5SZXN2U2l6ZTogIGN1cnJlbnQgcmVzZXJ2b2lyIHNpemVcblx0XHQgKiBcblx0XHQgKiAgICAgIGwzX3NpZGUucmVzdkRyYWluX3ByZTpcblx0XHQgKiAgICAgICAgIGFuY2lsbGFyeSBkYXRhIHRvIGJlIGFkZGVkIHRvIHByZXZpb3VzIGZyYW1lOlxuXHRcdCAqICAgICAgICAgKG9ubHkgdXNlZnVsbCBpbiBWQlIgbW9kZXMgaWYgaXQgaXMgcG9zc2libGUgdG8gaGF2ZVxuXHRcdCAqICAgICAgICAgbWF4bXAzYnVmIDwgZnVsbEZyYW1lQml0cykpLiAgQ3VycmVudGx5IGRpc2FibGVkLFxuXHRcdCAqICAgICAgICAgc2VlICNkZWZpbmUgTkVXX0RSQUlOXG5cdFx0ICogICAgICAgICAyMDEwLTAyLTEzOiBSSCBub3cgZW5hYmxlZCwgaXQgc2VlbXMgdG8gYmUgbmVlZGVkIGZvciBDQlIgdG9vLFxuXHRcdCAqICAgICAgICAgICAgICAgICAgICAgYXMgdGhlcmUgZXhpc3RzIG9uZSBleGFtcGxlLCB3aGVyZSB0aGUgRmhHIGRlY29kZXJcblx0XHQgKiAgICAgICAgICAgICAgICAgICAgIGNhbid0IGRlY29kZSBhIC1iMzIwIENCUiBmaWxlIGFueW1vcmUuXG5cdFx0ICogXG5cdFx0ICogICAgICBsM19zaWRlLnJlc3ZEcmFpbl9wb3N0OlxuXHRcdCAqICAgICAgICAgYW5jaWxsYXJ5IGRhdGEgdG8gYmUgYWRkZWQgdG8gdGhpcyBmcmFtZTpcblx0XHQgKiBcblx0XHQgKiA8L1BSRT5cblx0XHQgKi9cblxuXHRcdC8qIG1haW5fZGF0YV9iZWdpbiBoYXMgOSBiaXRzIGluIE1QRUctMSwgOCBiaXRzIE1QRUctMiAqL1xuXHRcdHZhciByZXN2TGltaXQgPSAoOCAqIDI1NikgKiBnZmMubW9kZV9nciAtIDg7XG5cblx0XHQvKlxuXHRcdCAqIG1heGltdW0gYWxsb3dlZCBmcmFtZSBzaXplLiBkb250IHVzZSBtb3JlIHRoYW4gdGhpcyBudW1iZXIgb2YgYml0cyxcblx0XHQgKiBldmVuIGlmIHRoZSBmcmFtZSBoYXMgdGhlIHNwYWNlIGZvciB0aGVtOlxuXHRcdCAqL1xuXHRcdGlmIChnZnAuYnJhdGUgPiAzMjApIHtcblx0XHRcdC8qIGluIGZyZWVmb3JtYXQgdGhlIGJ1ZmZlciBpcyBjb25zdGFudCAqL1xuXHRcdFx0bWF4bXAzYnVmID0gOCAqICgoaW50KSAoKGdmcC5icmF0ZSAqIDEwMDApXG5cdFx0XHRcdFx0LyAoZ2ZwLm91dF9zYW1wbGVyYXRlIC8gMTE1MikgLyA4ICsgLjUpKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Lypcblx0XHRcdCAqIGFsbCBtcDMgZGVjb2RlcnMgc2hvdWxkIGhhdmUgZW5vdWdoIGJ1ZmZlciB0byBoYW5kbGUgdGhpcyB2YWx1ZTpcblx0XHRcdCAqIHNpemUgb2YgYSAzMjBrYnBzIDMya0h6IGZyYW1lXG5cdFx0XHQgKi9cblx0XHRcdG1heG1wM2J1ZiA9IDggKiAxNDQwO1xuXG5cdFx0XHQvKlxuXHRcdFx0ICogQm91dmlnbmUgc3VnZ2VzdHMgdGhpcyBtb3JlIGxheCBpbnRlcnByZXRhdGlvbiBvZiB0aGUgSVNPIGRvY1xuXHRcdFx0ICogaW5zdGVhZCBvZiB1c2luZyA4Kjk2MC5cblx0XHRcdCAqL1xuXG5cdFx0XHRpZiAoZ2ZwLnN0cmljdF9JU08pIHtcblx0XHRcdFx0bWF4bXAzYnVmID0gOCAqICgoaW50KSAoMzIwMDAwIC8gKGdmcC5vdXRfc2FtcGxlcmF0ZSAvIDExNTIpIC8gOCArIC41KSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Z2ZjLlJlc3ZNYXggPSBtYXhtcDNidWYgLSBmcmFtZUxlbmd0aDtcblx0XHRpZiAoZ2ZjLlJlc3ZNYXggPiByZXN2TGltaXQpXG5cdFx0XHRnZmMuUmVzdk1heCA9IHJlc3ZMaW1pdDtcblx0XHRpZiAoZ2ZjLlJlc3ZNYXggPCAwIHx8IGdmcC5kaXNhYmxlX3Jlc2Vydm9pcilcblx0XHRcdGdmYy5SZXN2TWF4ID0gMDtcblxuXHRcdHZhciBmdWxsRnJhbWVCaXRzID0gbWVhbl9iaXRzLmJpdHMgKiBnZmMubW9kZV9nclxuXHRcdFx0XHQrIE1hdGgubWluKGdmYy5SZXN2U2l6ZSwgZ2ZjLlJlc3ZNYXgpO1xuXG5cdFx0aWYgKGZ1bGxGcmFtZUJpdHMgPiBtYXhtcDNidWYpXG5cdFx0XHRmdWxsRnJhbWVCaXRzID0gbWF4bXAzYnVmO1xuXG5cblx0XHRsM19zaWRlLnJlc3ZEcmFpbl9wcmUgPSAwO1xuXG5cdFx0Ly8gZnJhbWUgYW5hbHl6ZXIgY29kZVxuXHRcdGlmIChnZmMucGluZm8gIT0gbnVsbCkge1xuXHRcdFx0Lypcblx0XHRcdCAqIGV4cGVjdGVkIGJpdHMgcGVyIGNoYW5uZWwgcGVyIGdyYW51bGUgW2lzIHRoaXMgYWxzbyByaWdodCBmb3Jcblx0XHRcdCAqIG1vbm8vc3RlcmVvLCBNUEVHLTEvMiA/XVxuXHRcdFx0ICovXG5cdFx0XHRnZmMucGluZm8ubWVhbl9iaXRzID0gbWVhbl9iaXRzLmJpdHMgLyAyO1xuXHRcdFx0Z2ZjLnBpbmZvLnJlc3ZzaXplID0gZ2ZjLlJlc3ZTaXplO1xuXHRcdH1cblxuXHRcdHJldHVybiBmdWxsRnJhbWVCaXRzO1xuXHR9XG5cblx0LyoqXG5cdCAqIHJldHVybnMgdGFyZ19iaXRzOiB0YXJnZXQgbnVtYmVyIG9mIGJpdHMgdG8gdXNlIGZvciAxIGdyYW51bGU8QlI+XG5cdCAqIGV4dHJhX2JpdHM6IGFtb3VudCBleHRyYSBhdmFpbGFibGUgZnJvbSByZXNlcnZvaXI8QlI+XG5cdCAqIE1hcmsgVGF5bG9yIDQvOTlcblx0ICovXG5cdHRoaXMuUmVzdk1heEJpdHMgPSBmdW5jdGlvbihnZnAsIG1lYW5fYml0cywgdGFyZ19iaXRzLCBjYnIpIHtcblx0XHR2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXHRcdHZhciBhZGRfYml0cztcbiAgICAgICAgdmFyIFJlc3ZTaXplID0gZ2ZjLlJlc3ZTaXplLCBSZXN2TWF4ID0gZ2ZjLlJlc3ZNYXg7XG5cblx0XHQvKiBjb21wZW5zYXRlIHRoZSBzYXZlZCBiaXRzIHVzZWQgaW4gdGhlIDFzdCBncmFudWxlICovXG5cdFx0aWYgKGNiciAhPSAwKVxuXHRcdFx0UmVzdlNpemUgKz0gbWVhbl9iaXRzO1xuXG5cdFx0aWYgKChnZmMuc3Vic3RlcF9zaGFwaW5nICYgMSkgIT0gMClcblx0XHRcdFJlc3ZNYXggKj0gMC45O1xuXG5cdFx0dGFyZ19iaXRzLmJpdHMgPSBtZWFuX2JpdHM7XG5cblx0XHQvKiBleHRyYSBiaXRzIGlmIHRoZSByZXNlcnZvaXIgaXMgYWxtb3N0IGZ1bGwgKi9cblx0XHRpZiAoUmVzdlNpemUgKiAxMCA+IFJlc3ZNYXggKiA5KSB7XG5cdFx0XHRhZGRfYml0cyA9IFJlc3ZTaXplIC0gKFJlc3ZNYXggKiA5KSAvIDEwO1xuXHRcdFx0dGFyZ19iaXRzLmJpdHMgKz0gYWRkX2JpdHM7XG5cdFx0XHRnZmMuc3Vic3RlcF9zaGFwaW5nIHw9IDB4ODA7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGFkZF9iaXRzID0gMDtcblx0XHRcdGdmYy5zdWJzdGVwX3NoYXBpbmcgJj0gMHg3Zjtcblx0XHRcdC8qXG5cdFx0XHQgKiBidWlsZCB1cCByZXNlcnZvaXIuIHRoaXMgYnVpbGRzIHRoZSByZXNlcnZvaXIgYSBsaXR0bGUgc2xvd2VyXG5cdFx0XHQgKiB0aGFuIEZoRy4gSXQgY291bGQgc2ltcGxlIGJlIG1lYW5fYml0cy8xNSwgYnV0IHRoaXMgd2FzIHJpZ2dlZCB0b1xuXHRcdFx0ICogYWx3YXlzIHByb2R1Y2UgMTAwICh0aGUgb2xkIHZhbHVlKSBhdCAxMjhrYnNcblx0XHRcdCAqL1xuXHRcdFx0aWYgKCFnZnAuZGlzYWJsZV9yZXNlcnZvaXIgJiYgMCA9PSAoZ2ZjLnN1YnN0ZXBfc2hhcGluZyAmIDEpKVxuXHRcdFx0XHR0YXJnX2JpdHMuYml0cyAtPSAuMSAqIG1lYW5fYml0cztcblx0XHR9XG5cblx0XHQvKiBhbW91bnQgZnJvbSB0aGUgcmVzZXJ2b2lyIHdlIGFyZSBhbGxvd2VkIHRvIHVzZS4gSVNPIHNheXMgNi8xMCAqL1xuXHRcdHZhciBleHRyYV9iaXRzID0gKFJlc3ZTaXplIDwgKGdmYy5SZXN2TWF4ICogNikgLyAxMCA/IFJlc3ZTaXplXG5cdFx0XHRcdDogKGdmYy5SZXN2TWF4ICogNikgLyAxMCk7XG5cdFx0ZXh0cmFfYml0cyAtPSBhZGRfYml0cztcblxuXHRcdGlmIChleHRyYV9iaXRzIDwgMClcblx0XHRcdGV4dHJhX2JpdHMgPSAwO1xuXHRcdHJldHVybiBleHRyYV9iaXRzO1xuXHR9XG5cblx0LyoqXG5cdCAqIENhbGxlZCBhZnRlciBhIGdyYW51bGUncyBiaXQgYWxsb2NhdGlvbi4gUmVhZGp1c3RzIHRoZSBzaXplIG9mIHRoZVxuXHQgKiByZXNlcnZvaXIgdG8gcmVmbGVjdCB0aGUgZ3JhbnVsZSdzIHVzYWdlLlxuXHQgKi9cblx0dGhpcy5SZXN2QWRqdXN0ID0gZnVuY3Rpb24oZ2ZjLCBnaSkge1xuXHRcdGdmYy5SZXN2U2l6ZSAtPSBnaS5wYXJ0Ml8zX2xlbmd0aCArIGdpLnBhcnQyX2xlbmd0aDtcblx0fVxuXG5cdC8qKlxuXHQgKiBDYWxsZWQgYWZ0ZXIgYWxsIGdyYW51bGVzIGluIGEgZnJhbWUgaGF2ZSBiZWVuIGFsbG9jYXRlZC4gTWFrZXMgc3VyZSB0aGF0XG5cdCAqIHRoZSByZXNlcnZvaXIgc2l6ZSBpcyB3aXRoaW4gbGltaXRzLCBwb3NzaWJseSBieSBhZGRpbmcgc3R1ZmZpbmcgYml0cy5cblx0ICovXG5cdHRoaXMuUmVzdkZyYW1lRW5kID0gZnVuY3Rpb24oZ2ZjLCBtZWFuX2JpdHMpIHtcblx0XHR2YXIgb3Zlcl9iaXRzO1xuXHRcdHZhciBsM19zaWRlID0gZ2ZjLmwzX3NpZGU7XG5cblx0XHRnZmMuUmVzdlNpemUgKz0gbWVhbl9iaXRzICogZ2ZjLm1vZGVfZ3I7XG5cdFx0dmFyIHN0dWZmaW5nQml0cyA9IDA7XG5cdFx0bDNfc2lkZS5yZXN2RHJhaW5fcG9zdCA9IDA7XG5cdFx0bDNfc2lkZS5yZXN2RHJhaW5fcHJlID0gMDtcblxuXHRcdC8qIHdlIG11c3QgYmUgYnl0ZSBhbGlnbmVkICovXG5cdFx0aWYgKChvdmVyX2JpdHMgPSBnZmMuUmVzdlNpemUgJSA4KSAhPSAwKVxuXHRcdFx0c3R1ZmZpbmdCaXRzICs9IG92ZXJfYml0cztcblxuXHRcdG92ZXJfYml0cyA9IChnZmMuUmVzdlNpemUgLSBzdHVmZmluZ0JpdHMpIC0gZ2ZjLlJlc3ZNYXg7XG5cdFx0aWYgKG92ZXJfYml0cyA+IDApIHtcblx0XHRcdHN0dWZmaW5nQml0cyArPSBvdmVyX2JpdHM7XG5cdFx0fVxuXG5cdFx0Lypcblx0XHQgKiBOT1RFOiBlbmFibGluZyB0aGUgTkVXX0RSQUlOIGNvZGUgZml4ZXMgc29tZSBwcm9ibGVtcyB3aXRoIEZoR1xuXHRcdCAqIGRlY29kZXIgc2hpcHBlZCB3aXRoIE1TIFdpbmRvd3Mgb3BlcmF0aW5nIHN5c3RlbXMuIFVzaW5nIHRoaXMsIGl0IGlzXG5cdFx0ICogZXZlbiBwb3NzaWJsZSB0byB1c2UgR2FicmllbCdzIGxheCBidWZmZXIgY29uc2lkZXJhdGlvbiBhZ2Fpbiwgd2hpY2hcblx0XHQgKiBhc3N1bWVzLCBhbnkgZGVjb2RlciBzaG91bGQgaGF2ZSBhIGJ1ZmZlciBsYXJnZSBlbm91Z2ggZm9yIGEgMzIwIGticHNcblx0XHQgKiBmcmFtZSBhdCAzMiBrSHogc2FtcGxlIHJhdGUuXG5cdFx0ICogXG5cdFx0ICogb2xkIGRyYWluIGNvZGU6IGxhbWUgLWIzMjAgQmxhY2tCaXJkLndhdiAtLS4gZG9lcyBub3QgcGxheSB3aXRoXG5cdFx0ICogR3JhcGhFZGl0LmV4ZSB1c2luZyBGaEcgZGVjb2RlciBWMS41IEJ1aWxkIDUwXG5cdFx0ICogXG5cdFx0ICogbmV3IGRyYWluIGNvZGU6IGxhbWUgLWIzMjAgQmxhY2tCaXJkLndhdiAtLS4gcGxheXMgZmluZSB3aXRoXG5cdFx0ICogR3JhcGhFZGl0LmV4ZSB1c2luZyBGaEcgZGVjb2RlciBWMS41IEJ1aWxkIDUwXG5cdFx0ICogXG5cdFx0ICogUm9iZXJ0IEhlZ2VtYW5uLCAyMDEwLTAyLTEzLlxuXHRcdCAqL1xuXHRcdC8qXG5cdFx0ICogZHJhaW4gYXMgbWFueSBiaXRzIGFzIHBvc3NpYmxlIGludG8gcHJldmlvdXMgZnJhbWUgYW5jaWxsYXJ5IGRhdGEgSW5cblx0XHQgKiBwYXJ0aWN1bGFyLCBpbiBWQlIgbW9kZSBSZXN2TWF4IG1heSBoYXZlIGNoYW5nZWQsIGFuZCB3ZSBoYXZlIHRvIG1ha2Vcblx0XHQgKiBzdXJlIG1haW5fZGF0YV9iZWdpbiBkb2VzIG5vdCBjcmVhdGUgYSByZXNlcnZvaXIgYmlnZ2VyIHRoYW4gUmVzdk1heFxuXHRcdCAqIG10IDQvMDBcblx0XHQgKi9cblx0XHR7XG5cdFx0XHR2YXIgbWRiX2J5dGVzID0gTWF0aC5taW4obDNfc2lkZS5tYWluX2RhdGFfYmVnaW4gKiA4LCBzdHVmZmluZ0JpdHMpIC8gODtcblx0XHRcdGwzX3NpZGUucmVzdkRyYWluX3ByZSArPSA4ICogbWRiX2J5dGVzO1xuXHRcdFx0c3R1ZmZpbmdCaXRzIC09IDggKiBtZGJfYnl0ZXM7XG5cdFx0XHRnZmMuUmVzdlNpemUgLT0gOCAqIG1kYl9ieXRlcztcblx0XHRcdGwzX3NpZGUubWFpbl9kYXRhX2JlZ2luIC09IG1kYl9ieXRlcztcblx0XHR9XG5cdFx0LyogZHJhaW4gdGhlIHJlc3QgaW50byB0aGlzIGZyYW1lcyBhbmNpbGxhcnkgZGF0YSAqL1xuXHRcdGwzX3NpZGUucmVzdkRyYWluX3Bvc3QgKz0gc3R1ZmZpbmdCaXRzO1xuXHRcdGdmYy5SZXN2U2l6ZSAtPSBzdHVmZmluZ0JpdHM7XG5cdH1cbn1cblxuXG4vKipcbiAqIEEgVmJyIGhlYWRlciBtYXkgYmUgcHJlc2VudCBpbiB0aGUgYW5jaWxsYXJ5IGRhdGEgZmllbGQgb2YgdGhlIGZpcnN0IGZyYW1lIG9mXG4gKiBhbiBtcDMgYml0c3RyZWFtPEJSPlxuICogVGhlIFZiciBoZWFkZXIgKG9wdGlvbmFsbHkpIGNvbnRhaW5zXG4gKiA8VUw+XG4gKiA8TEk+ZnJhbWVzIHRvdGFsIG51bWJlciBvZiBhdWRpbyBmcmFtZXMgaW4gdGhlIGJpdHN0cmVhbVxuICogPExJPmJ5dGVzIHRvdGFsIG51bWJlciBvZiBieXRlcyBpbiB0aGUgYml0c3RyZWFtXG4gKiA8TEk+dG9jIHRhYmxlIG9mIGNvbnRlbnRzXG4gKiA8L1VMPlxuICpcbiAqIHRvYyAodGFibGUgb2YgY29udGVudHMpIGdpdmVzIHNlZWsgcG9pbnRzIGZvciByYW5kb20gYWNjZXNzLjxCUj5cbiAqIFRoZSBpdGggZW50cnkgZGV0ZXJtaW5lcyB0aGUgc2VlayBwb2ludCBmb3IgaS1wZXJjZW50IGR1cmF0aW9uLjxCUj5cbiAqIHNlZWsgcG9pbnQgaW4gYnl0ZXMgPSAodG9jW2ldLzI1Ni4wKSAqIHRvdGFsX2JpdHN0cmVhbV9ieXRlczxCUj5cbiAqIGUuZy4gaGFsZiBkdXJhdGlvbiBzZWVrIHBvaW50ID0gKHRvY1s1MF0vMjU2LjApICogdG90YWxfYml0c3RyZWFtX2J5dGVzXG4gKi9cblZCUlRhZy5OVU1UT0NFTlRSSUVTID0gMTAwO1xuVkJSVGFnLk1BWEZSQU1FU0laRSA9IDI4ODA7XG5cbmZ1bmN0aW9uIFZCUlRhZygpIHtcblxuICAgIHZhciBsYW1lO1xuICAgIHZhciBicztcbiAgICB2YXIgdjtcblxuICAgIHRoaXMuc2V0TW9kdWxlcyA9IGZ1bmN0aW9uIChfbGFtZSwgX2JzLCBfdikge1xuICAgICAgICBsYW1lID0gX2xhbWU7XG4gICAgICAgIGJzID0gX2JzO1xuICAgICAgICB2ID0gX3Y7XG4gICAgfTtcblx0XG5cdC8vZml4IOeyvueugFxuXHRcbiAgICAvKipcbiAgICAgKiBMb29rdXAgdGFibGUgZm9yIGZhc3QgQ1JDLTE2IGNvbXB1dGF0aW9uLiBVc2VzIHRoZSBwb2x5bm9taWFsXG4gICAgICogeF4xNit4XjE1K3heMisxXG4gICAgICovXG4gICAgdmFyIGNyYzE2TG9va3VwID0gWzB4MDAwMCwgMHhDMEMxLCAweEMxODEsIDB4MDE0MCxcbiAgICAgICAgMHhDMzAxLCAweDAzQzAsIDB4MDI4MCwgMHhDMjQxLCAweEM2MDEsIDB4MDZDMCwgMHgwNzgwLCAweEM3NDEsXG4gICAgICAgIDB4MDUwMCwgMHhDNUMxLCAweEM0ODEsIDB4MDQ0MCwgMHhDQzAxLCAweDBDQzAsIDB4MEQ4MCwgMHhDRDQxLFxuICAgICAgICAweDBGMDAsIDB4Q0ZDMSwgMHhDRTgxLCAweDBFNDAsIDB4MEEwMCwgMHhDQUMxLCAweENCODEsIDB4MEI0MCxcbiAgICAgICAgMHhDOTAxLCAweDA5QzAsIDB4MDg4MCwgMHhDODQxLCAweEQ4MDEsIDB4MThDMCwgMHgxOTgwLCAweEQ5NDEsXG4gICAgICAgIDB4MUIwMCwgMHhEQkMxLCAweERBODEsIDB4MUE0MCwgMHgxRTAwLCAweERFQzEsIDB4REY4MSwgMHgxRjQwLFxuICAgICAgICAweEREMDEsIDB4MURDMCwgMHgxQzgwLCAweERDNDEsIDB4MTQwMCwgMHhENEMxLCAweEQ1ODEsIDB4MTU0MCxcbiAgICAgICAgMHhENzAxLCAweDE3QzAsIDB4MTY4MCwgMHhENjQxLCAweEQyMDEsIDB4MTJDMCwgMHgxMzgwLCAweEQzNDEsXG4gICAgICAgIDB4MTEwMCwgMHhEMUMxLCAweEQwODEsIDB4MTA0MCwgMHhGMDAxLCAweDMwQzAsIDB4MzE4MCwgMHhGMTQxLFxuICAgICAgICAweDMzMDAsIDB4RjNDMSwgMHhGMjgxLCAweDMyNDAsIDB4MzYwMCwgMHhGNkMxLCAweEY3ODEsIDB4Mzc0MCxcbiAgICAgICAgMHhGNTAxLCAweDM1QzAsIDB4MzQ4MCwgMHhGNDQxLCAweDNDMDAsIDB4RkNDMSwgMHhGRDgxLCAweDNENDAsXG4gICAgICAgIDB4RkYwMSwgMHgzRkMwLCAweDNFODAsIDB4RkU0MSwgMHhGQTAxLCAweDNBQzAsIDB4M0I4MCwgMHhGQjQxLFxuICAgICAgICAweDM5MDAsIDB4RjlDMSwgMHhGODgxLCAweDM4NDAsIDB4MjgwMCwgMHhFOEMxLCAweEU5ODEsIDB4Mjk0MCxcbiAgICAgICAgMHhFQjAxLCAweDJCQzAsIDB4MkE4MCwgMHhFQTQxLCAweEVFMDEsIDB4MkVDMCwgMHgyRjgwLCAweEVGNDEsXG4gICAgICAgIDB4MkQwMCwgMHhFREMxLCAweEVDODEsIDB4MkM0MCwgMHhFNDAxLCAweDI0QzAsIDB4MjU4MCwgMHhFNTQxLFxuICAgICAgICAweDI3MDAsIDB4RTdDMSwgMHhFNjgxLCAweDI2NDAsIDB4MjIwMCwgMHhFMkMxLCAweEUzODEsIDB4MjM0MCxcbiAgICAgICAgMHhFMTAxLCAweDIxQzAsIDB4MjA4MCwgMHhFMDQxLCAweEEwMDEsIDB4NjBDMCwgMHg2MTgwLCAweEExNDEsXG4gICAgICAgIDB4NjMwMCwgMHhBM0MxLCAweEEyODEsIDB4NjI0MCwgMHg2NjAwLCAweEE2QzEsIDB4QTc4MSwgMHg2NzQwLFxuICAgICAgICAweEE1MDEsIDB4NjVDMCwgMHg2NDgwLCAweEE0NDEsIDB4NkMwMCwgMHhBQ0MxLCAweEFEODEsIDB4NkQ0MCxcbiAgICAgICAgMHhBRjAxLCAweDZGQzAsIDB4NkU4MCwgMHhBRTQxLCAweEFBMDEsIDB4NkFDMCwgMHg2QjgwLCAweEFCNDEsXG4gICAgICAgIDB4NjkwMCwgMHhBOUMxLCAweEE4ODEsIDB4Njg0MCwgMHg3ODAwLCAweEI4QzEsIDB4Qjk4MSwgMHg3OTQwLFxuICAgICAgICAweEJCMDEsIDB4N0JDMCwgMHg3QTgwLCAweEJBNDEsIDB4QkUwMSwgMHg3RUMwLCAweDdGODAsIDB4QkY0MSxcbiAgICAgICAgMHg3RDAwLCAweEJEQzEsIDB4QkM4MSwgMHg3QzQwLCAweEI0MDEsIDB4NzRDMCwgMHg3NTgwLCAweEI1NDEsXG4gICAgICAgIDB4NzcwMCwgMHhCN0MxLCAweEI2ODEsIDB4NzY0MCwgMHg3MjAwLCAweEIyQzEsIDB4QjM4MSwgMHg3MzQwLFxuICAgICAgICAweEIxMDEsIDB4NzFDMCwgMHg3MDgwLCAweEIwNDEsIDB4NTAwMCwgMHg5MEMxLCAweDkxODEsIDB4NTE0MCxcbiAgICAgICAgMHg5MzAxLCAweDUzQzAsIDB4NTI4MCwgMHg5MjQxLCAweDk2MDEsIDB4NTZDMCwgMHg1NzgwLCAweDk3NDEsXG4gICAgICAgIDB4NTUwMCwgMHg5NUMxLCAweDk0ODEsIDB4NTQ0MCwgMHg5QzAxLCAweDVDQzAsIDB4NUQ4MCwgMHg5RDQxLFxuICAgICAgICAweDVGMDAsIDB4OUZDMSwgMHg5RTgxLCAweDVFNDAsIDB4NUEwMCwgMHg5QUMxLCAweDlCODEsIDB4NUI0MCxcbiAgICAgICAgMHg5OTAxLCAweDU5QzAsIDB4NTg4MCwgMHg5ODQxLCAweDg4MDEsIDB4NDhDMCwgMHg0OTgwLCAweDg5NDEsXG4gICAgICAgIDB4NEIwMCwgMHg4QkMxLCAweDhBODEsIDB4NEE0MCwgMHg0RTAwLCAweDhFQzEsIDB4OEY4MSwgMHg0RjQwLFxuICAgICAgICAweDhEMDEsIDB4NERDMCwgMHg0QzgwLCAweDhDNDEsIDB4NDQwMCwgMHg4NEMxLCAweDg1ODEsIDB4NDU0MCxcbiAgICAgICAgMHg4NzAxLCAweDQ3QzAsIDB4NDY4MCwgMHg4NjQxLCAweDgyMDEsIDB4NDJDMCwgMHg0MzgwLCAweDgzNDEsXG4gICAgICAgIDB4NDEwMCwgMHg4MUMxLCAweDgwODEsIDB4NDA0MF07XG5cdFx0XG5cdC8vZml4IOeyvueugFxuXHRcbiAgICAvKipcbiAgICAgKiBGYXN0IENSQy0xNiBjb21wdXRhdGlvbiAodXNlcyB0YWJsZSBjcmMxNkxvb2t1cCkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdmFsdWVcbiAgICAgKiBAcGFyYW0gY3JjXG4gICAgICogQHJldHVyblxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNyY1VwZGF0ZUxvb2t1cCh2YWx1ZSwgY3JjKSB7XG4gICAgICAgIHZhciB0bXAgPSBjcmMgXiB2YWx1ZTtcbiAgICAgICAgY3JjID0gKGNyYyA+PiA4KSBeIGNyYzE2TG9va3VwW3RtcCAmIDB4ZmZdO1xuICAgICAgICByZXR1cm4gY3JjO1xuICAgIH1cblxuICAgIHRoaXMudXBkYXRlTXVzaWNDUkMgPSBmdW5jdGlvbiAoY3JjLCBidWZmZXIsIGJ1ZmZlclBvcywgc2l6ZSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7ICsraSlcbiAgICAgICAgICAgIGNyY1swXSA9IGNyY1VwZGF0ZUxvb2t1cChidWZmZXJbYnVmZmVyUG9zICsgaV0sIGNyY1swXSk7XG4gICAgfVxuXG5cdC8vZml4IOeyvueugFxufVxuXG5cblxuQml0U3RyZWFtLkVRID0gZnVuY3Rpb24gKGEsIGIpIHtcbiAgICByZXR1cm4gKE1hdGguYWJzKGEpID4gTWF0aC5hYnMoYikpID8gKE1hdGguYWJzKChhKSAtIChiKSkgPD0gKE1hdGhcbiAgICAgICAgLmFicyhhKSAqIDFlLTYpKVxuICAgICAgICA6IChNYXRoLmFicygoYSkgLSAoYikpIDw9IChNYXRoLmFicyhiKSAqIDFlLTYpKTtcbn07XG5cbkJpdFN0cmVhbS5ORVEgPSBmdW5jdGlvbiAoYSwgYikge1xuICAgIHJldHVybiAhQml0U3RyZWFtLkVRKGEsIGIpO1xufTtcblxuZnVuY3Rpb24gQml0U3RyZWFtKCkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgQ1JDMTZfUE9MWU5PTUlBTCA9IDB4ODAwNTtcblxuICAgIC8qXG4gICAgICogd2Ugd29yayB3aXRoIGludHMsIHNvIHdoZW4gZG9pbmcgYml0IG1hbmlwdWxhdGlvbiwgd2UgbGltaXQgb3Vyc2VsdmVzIHRvXG4gICAgICogTUFYX0xFTkdUSC0yIGp1c3QgdG8gYmUgb24gdGhlIHNhZmUgc2lkZVxuICAgICAqL1xuICAgIHZhciBNQVhfTEVOR1RIID0gMzI7XG5cbiAgICAvL0dhaW5BbmFseXNpcyBnYTtcbiAgICAvL01QR0xpYiBtcGc7XG4gICAgLy9WZXJzaW9uIHZlcjtcbiAgICAvL1ZCUlRhZyB2YnI7XG4gICAgdmFyIGdhID0gbnVsbDtcbiAgICB2YXIgbXBnID0gbnVsbDtcbiAgICB2YXIgdmVyID0gbnVsbDtcbiAgICB2YXIgdmJyID0gbnVsbDtcblxuICAgIC8vcHVibGljIGZpbmFsIHZvaWQgc2V0TW9kdWxlcyhHYWluQW5hbHlzaXMgZ2EsIE1QR0xpYiBtcGcsIFZlcnNpb24gdmVyLFxuICAgIC8vXHRWQlJUYWcgdmJyKSB7XG5cbiAgICB0aGlzLnNldE1vZHVsZXMgPSBmdW5jdGlvbiAoX2dhLCBfbXBnLCBfdmVyLCBfdmJyKSB7XG4gICAgICAgIGdhID0gX2dhO1xuICAgICAgICBtcGcgPSBfbXBnO1xuICAgICAgICB2ZXIgPSBfdmVyO1xuICAgICAgICB2YnIgPSBfdmJyO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBCaXQgc3RyZWFtIGJ1ZmZlci5cbiAgICAgKi9cbiAgICAvL3ByaXZhdGUgYnl0ZVtdIGJ1ZjtcbiAgICB2YXIgYnVmID0gbnVsbDtcbiAgICAvKipcbiAgICAgKiBCaXQgY291bnRlciBvZiBiaXQgc3RyZWFtLlxuICAgICAqL1xuICAgIHZhciB0b3RiaXQgPSAwO1xuICAgIC8qKlxuICAgICAqIFBvaW50ZXIgdG8gdG9wIGJ5dGUgaW4gYnVmZmVyLlxuICAgICAqL1xuICAgIHZhciBidWZCeXRlSWR4ID0gMDtcbiAgICAvKipcbiAgICAgKiBQb2ludGVyIHRvIHRvcCBiaXQgb2YgdG9wIGJ5dGUgaW4gYnVmZmVyLlxuICAgICAqL1xuICAgIHZhciBidWZCaXRJZHggPSAwO1xuXG4gICAgLyoqXG4gICAgICogY29tcHV0ZSBiaXRzcGVyZnJhbWUgYW5kIG1lYW5fYml0cyBmb3IgYSBsYXllciBJSUkgZnJhbWVcbiAgICAgKi9cbiAgICB0aGlzLmdldGZyYW1lYml0cyA9IGZ1bmN0aW9uIChnZnApIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGJpdF9yYXRlO1xuXG4gICAgICAgIC8qIGdldCBiaXRyYXRlIGluIGticHMgWz9dICovXG4gICAgICAgIGlmIChnZmMuYml0cmF0ZV9pbmRleCAhPSAwKVxuICAgICAgICAgICAgYml0X3JhdGUgPSBUYWJsZXMuYml0cmF0ZV90YWJsZVtnZnAudmVyc2lvbl1bZ2ZjLmJpdHJhdGVfaW5kZXhdO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBiaXRfcmF0ZSA9IGdmcC5icmF0ZTtcblxuICAgICAgICAvKiBtYWluIGVuY29kaW5nIHJvdXRpbmUgdG9nZ2xlcyBwYWRkaW5nIG9uIGFuZCBvZmYgKi9cbiAgICAgICAgLyogb25lIExheWVyMyBTbG90IGNvbnNpc3RzIG9mIDggYml0cyAqL1xuICAgICAgICB2YXIgYnl0ZXMgPSAwIHwgKGdmcC52ZXJzaW9uICsgMSkgKiA3MjAwMCAqIGJpdF9yYXRlIC8gZ2ZwLm91dF9zYW1wbGVyYXRlICsgZ2ZjLnBhZGRpbmc7XG4gICAgICAgIHJldHVybiA4ICogYnl0ZXM7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIHB1dGhlYWRlcl9iaXRzKGdmYykge1xuICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KGdmYy5oZWFkZXJbZ2ZjLndfcHRyXS5idWYsIDAsIGJ1ZiwgYnVmQnl0ZUlkeCwgZ2ZjLnNpZGVpbmZvX2xlbik7XG4gICAgICAgIGJ1ZkJ5dGVJZHggKz0gZ2ZjLnNpZGVpbmZvX2xlbjtcbiAgICAgICAgdG90Yml0ICs9IGdmYy5zaWRlaW5mb19sZW4gKiA4O1xuICAgICAgICBnZmMud19wdHIgPSAoZ2ZjLndfcHRyICsgMSkgJiAoTGFtZUludGVybmFsRmxhZ3MuTUFYX0hFQURFUl9CVUYgLSAxKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiB3cml0ZSBqIGJpdHMgaW50byB0aGUgYml0IHN0cmVhbVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHB1dGJpdHMyKGdmYywgdmFsLCBqKSB7XG5cblxuICAgICAgICB3aGlsZSAoaiA+IDApIHtcbiAgICAgICAgICAgIHZhciBrO1xuICAgICAgICAgICAgaWYgKGJ1ZkJpdElkeCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgYnVmQml0SWR4ID0gODtcbiAgICAgICAgICAgICAgICBidWZCeXRlSWR4Kys7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5oZWFkZXJbZ2ZjLndfcHRyXS53cml0ZV90aW1pbmcgPT0gdG90Yml0KSB7XG4gICAgICAgICAgICAgICAgICAgIHB1dGhlYWRlcl9iaXRzKGdmYyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJ1ZltidWZCeXRlSWR4XSA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGsgPSBNYXRoLm1pbihqLCBidWZCaXRJZHgpO1xuICAgICAgICAgICAgaiAtPSBrO1xuXG4gICAgICAgICAgICBidWZCaXRJZHggLT0gaztcblxuICAgICAgICAgICAgLyogMzIgdG9vIGxhcmdlIG9uIDMyIGJpdCBtYWNoaW5lcyAqL1xuXG4gICAgICAgICAgICBidWZbYnVmQnl0ZUlkeF0gfD0gKCh2YWwgPj4gaikgPDwgYnVmQml0SWR4KTtcbiAgICAgICAgICAgIHRvdGJpdCArPSBrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogd3JpdGUgaiBiaXRzIGludG8gdGhlIGJpdCBzdHJlYW0sIGlnbm9yaW5nIGZyYW1lIGhlYWRlcnNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBwdXRiaXRzX25vaGVhZGVycyhnZmMsIHZhbCwgaikge1xuXG4gICAgICAgIHdoaWxlIChqID4gMCkge1xuICAgICAgICAgICAgdmFyIGs7XG4gICAgICAgICAgICBpZiAoYnVmQml0SWR4ID09IDApIHtcbiAgICAgICAgICAgICAgICBidWZCaXRJZHggPSA4O1xuICAgICAgICAgICAgICAgIGJ1ZkJ5dGVJZHgrKztcbiAgICAgICAgICAgICAgICBidWZbYnVmQnl0ZUlkeF0gPSAwO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBrID0gTWF0aC5taW4oaiwgYnVmQml0SWR4KTtcbiAgICAgICAgICAgIGogLT0gaztcblxuICAgICAgICAgICAgYnVmQml0SWR4IC09IGs7XG5cbiAgICAgICAgICAgIC8qIDMyIHRvbyBsYXJnZSBvbiAzMiBiaXQgbWFjaGluZXMgKi9cblxuICAgICAgICAgICAgYnVmW2J1ZkJ5dGVJZHhdIHw9ICgodmFsID4+IGopIDw8IGJ1ZkJpdElkeCk7XG4gICAgICAgICAgICB0b3RiaXQgKz0gaztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNvbWUgY29tYmluYXRpb25zIG9mIGJpdHJhdGUsIEZzLCBhbmQgc3RlcmVvIG1ha2UgaXQgaW1wb3NzaWJsZSB0byBzdHVmZlxuICAgICAqIG91dCBhIGZyYW1lIHVzaW5nIGp1c3QgbWFpbl9kYXRhLCBkdWUgdG8gdGhlIGxpbWl0ZWQgbnVtYmVyIG9mIGJpdHMgdG9cbiAgICAgKiBpbmRpY2F0ZSBtYWluX2RhdGFfbGVuZ3RoLiBJbiB0aGVzZSBzaXR1YXRpb25zLCB3ZSBwdXQgc3R1ZmZpbmcgYml0cyBpbnRvXG4gICAgICogdGhlIGFuY2lsbGFyeSBkYXRhLi4uXG4gICAgICovXG4gICAgZnVuY3Rpb24gZHJhaW5faW50b19hbmNpbGxhcnkoZ2ZwLCByZW1haW5pbmdCaXRzKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBpO1xuXG4gICAgICAgIGlmIChyZW1haW5pbmdCaXRzID49IDgpIHtcbiAgICAgICAgICAgIHB1dGJpdHMyKGdmYywgMHg0YywgOCk7XG4gICAgICAgICAgICByZW1haW5pbmdCaXRzIC09IDg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlbWFpbmluZ0JpdHMgPj0gOCkge1xuICAgICAgICAgICAgcHV0Yml0czIoZ2ZjLCAweDQxLCA4KTtcbiAgICAgICAgICAgIHJlbWFpbmluZ0JpdHMgLT0gODtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVtYWluaW5nQml0cyA+PSA4KSB7XG4gICAgICAgICAgICBwdXRiaXRzMihnZmMsIDB4NGQsIDgpO1xuICAgICAgICAgICAgcmVtYWluaW5nQml0cyAtPSA4O1xuICAgICAgICB9XG4gICAgICAgIGlmIChyZW1haW5pbmdCaXRzID49IDgpIHtcbiAgICAgICAgICAgIHB1dGJpdHMyKGdmYywgMHg0NSwgOCk7XG4gICAgICAgICAgICByZW1haW5pbmdCaXRzIC09IDg7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocmVtYWluaW5nQml0cyA+PSAzMikge1xuICAgICAgICAgICAgdmFyIHZlcnNpb24gPSB2ZXIuZ2V0TGFtZVNob3J0VmVyc2lvbigpO1xuICAgICAgICAgICAgaWYgKHJlbWFpbmluZ0JpdHMgPj0gMzIpXG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHZlcnNpb24ubGVuZ3RoICYmIHJlbWFpbmluZ0JpdHMgPj0gODsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlbWFpbmluZ0JpdHMgLT0gODtcbiAgICAgICAgICAgICAgICAgICAgcHV0Yml0czIoZ2ZjLCB2ZXJzaW9uLmNoYXJDb2RlQXQoaSksIDgpOyAvL2ZpeCDplJnor6/nmoTkvb/nlKhjaGFyQXRcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKDsgcmVtYWluaW5nQml0cyA+PSAxOyByZW1haW5pbmdCaXRzIC09IDEpIHtcbiAgICAgICAgICAgIHB1dGJpdHMyKGdmYywgZ2ZjLmFuY2lsbGFyeV9mbGFnLCAxKTtcbiAgICAgICAgICAgIGdmYy5hbmNpbGxhcnlfZmxhZyBePSAoIWdmcC5kaXNhYmxlX3Jlc2Vydm9pciA/IDEgOiAwKTtcbiAgICAgICAgfVxuXG5cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiB3cml0ZSBOIGJpdHMgaW50byB0aGUgaGVhZGVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gd3JpdGVoZWFkZXIoZ2ZjLCB2YWwsIGopIHtcbiAgICAgICAgdmFyIHB0ciA9IGdmYy5oZWFkZXJbZ2ZjLmhfcHRyXS5wdHI7XG5cbiAgICAgICAgd2hpbGUgKGogPiAwKSB7XG4gICAgICAgICAgICB2YXIgayA9IE1hdGgubWluKGosIDggLSAocHRyICYgNykpO1xuICAgICAgICAgICAgaiAtPSBrO1xuICAgICAgICAgICAgLyogPj4gMzIgdG9vIGxhcmdlIGZvciAzMiBiaXQgbWFjaGluZXMgKi9cblxuICAgICAgICAgICAgZ2ZjLmhlYWRlcltnZmMuaF9wdHJdLmJ1ZltwdHIgPj4gM10gfD0gKCh2YWwgPj4gaikpIDw8ICg4IC0gKHB0ciAmIDcpIC0gayk7XG4gICAgICAgICAgICBwdHIgKz0gaztcbiAgICAgICAgfVxuICAgICAgICBnZmMuaGVhZGVyW2dmYy5oX3B0cl0ucHRyID0gcHRyO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIENSQ191cGRhdGUodmFsdWUsIGNyYykge1xuICAgICAgICB2YWx1ZSA8PD0gODtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA4OyBpKyspIHtcbiAgICAgICAgICAgIHZhbHVlIDw8PSAxO1xuICAgICAgICAgICAgY3JjIDw8PSAxO1xuXG4gICAgICAgICAgICBpZiAoKCgoY3JjIF4gdmFsdWUpICYgMHgxMDAwMCkgIT0gMCkpXG4gICAgICAgICAgICAgICAgY3JjIF49IENSQzE2X1BPTFlOT01JQUw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNyYztcbiAgICB9XG5cbiAgICB0aGlzLkNSQ193cml0ZWhlYWRlciA9IGZ1bmN0aW9uIChnZmMsIGhlYWRlcikge1xuICAgICAgICB2YXIgY3JjID0gMHhmZmZmO1xuICAgICAgICAvKiAoam8pIGluaXQgY3JjMTYgZm9yIGVycm9yX3Byb3RlY3Rpb24gKi9cblxuICAgICAgICBjcmMgPSBDUkNfdXBkYXRlKGhlYWRlclsyXSAmIDB4ZmYsIGNyYyk7XG4gICAgICAgIGNyYyA9IENSQ191cGRhdGUoaGVhZGVyWzNdICYgMHhmZiwgY3JjKTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDY7IGkgPCBnZmMuc2lkZWluZm9fbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGNyYyA9IENSQ191cGRhdGUoaGVhZGVyW2ldICYgMHhmZiwgY3JjKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGhlYWRlcls0XSA9IChieXRlKShjcmMgPj4gOCk7XG4gICAgICAgIGhlYWRlcls1XSA9IChieXRlKShjcmMgJiAyNTUpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBlbmNvZGVTaWRlSW5mbzIoZ2ZwLCBiaXRzUGVyRnJhbWUpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGwzX3NpZGU7XG4gICAgICAgIHZhciBnciwgY2g7XG5cbiAgICAgICAgbDNfc2lkZSA9IGdmYy5sM19zaWRlO1xuICAgICAgICBnZmMuaGVhZGVyW2dmYy5oX3B0cl0ucHRyID0gMDtcbiAgICAgICAgQXJyYXlzLmZpbGwoZ2ZjLmhlYWRlcltnZmMuaF9wdHJdLmJ1ZiwgMCwgZ2ZjLnNpZGVpbmZvX2xlbiwgMCk7XG4gICAgICAgIGlmIChnZnAub3V0X3NhbXBsZXJhdGUgPCAxNjAwMClcbiAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgMHhmZmUsIDEyKTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAweGZmZiwgMTIpO1xuICAgICAgICB3cml0ZWhlYWRlcihnZmMsIChnZnAudmVyc2lvbiksIDEpO1xuICAgICAgICB3cml0ZWhlYWRlcihnZmMsIDQgLSAzLCAyKTtcbiAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAoIWdmcC5lcnJvcl9wcm90ZWN0aW9uID8gMSA6IDApLCAxKTtcbiAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAoZ2ZjLmJpdHJhdGVfaW5kZXgpLCA0KTtcbiAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAoZ2ZjLnNhbXBsZXJhdGVfaW5kZXgpLCAyKTtcbiAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAoZ2ZjLnBhZGRpbmcpLCAxKTtcbiAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAoZ2ZwLmV4dGVuc2lvbiksIDEpO1xuICAgICAgICB3cml0ZWhlYWRlcihnZmMsIChnZnAubW9kZS5vcmRpbmFsKCkpLCAyKTtcbiAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAoZ2ZjLm1vZGVfZXh0KSwgMik7XG4gICAgICAgIHdyaXRlaGVhZGVyKGdmYywgKGdmcC5jb3B5cmlnaHQpLCAxKTtcbiAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAoZ2ZwLm9yaWdpbmFsKSwgMSk7XG4gICAgICAgIHdyaXRlaGVhZGVyKGdmYywgKGdmcC5lbXBoYXNpcyksIDIpO1xuICAgICAgICBpZiAoZ2ZwLmVycm9yX3Byb3RlY3Rpb24pIHtcbiAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgMCwgMTYpO1xuICAgICAgICAgICAgLyogZHVtbXkgKi9cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChnZnAudmVyc2lvbiA9PSAxKSB7XG4gICAgICAgICAgICAvKiBNUEVHMSAqL1xuICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAobDNfc2lkZS5tYWluX2RhdGFfYmVnaW4pLCA5KTtcblxuICAgICAgICAgICAgaWYgKGdmYy5jaGFubmVsc19vdXQgPT0gMilcbiAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGwzX3NpZGUucHJpdmF0ZV9iaXRzLCAzKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGwzX3NpZGUucHJpdmF0ZV9iaXRzLCA1KTtcblxuICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgIHZhciBiYW5kO1xuICAgICAgICAgICAgICAgIGZvciAoYmFuZCA9IDA7IGJhbmQgPCA0OyBiYW5kKyspIHtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBsM19zaWRlLnNjZnNpW2NoXVtiYW5kXSwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKGdyID0gMDsgZ3IgPCAyOyBncisrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZ2kgPSBsM19zaWRlLnR0W2dyXVtjaF07XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kucGFydDJfM19sZW5ndGggKyBnaS5wYXJ0Ml9sZW5ndGgsIDEyKTtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5iaWdfdmFsdWVzIC8gMiwgOSk7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuZ2xvYmFsX2dhaW4sIDgpO1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnNjYWxlZmFjX2NvbXByZXNzLCA0KTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZ2kuYmxvY2tfdHlwZSAhPSBFbmNvZGVyLk5PUk1fVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCAxLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIHdpbmRvd19zd2l0Y2hpbmdfZmxhZyAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5ibG9ja190eXBlLCAyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kubWl4ZWRfYmxvY2tfZmxhZywgMSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnaS50YWJsZV9zZWxlY3RbMF0gPT0gMTQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2kudGFibGVfc2VsZWN0WzBdID0gMTY7XG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnRhYmxlX3NlbGVjdFswXSwgNSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2kudGFibGVfc2VsZWN0WzFdID09IDE0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdpLnRhYmxlX3NlbGVjdFsxXSA9IDE2O1xuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS50YWJsZV9zZWxlY3RbMV0sIDUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnN1YmJsb2NrX2dhaW5bMF0sIDMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5zdWJibG9ja19nYWluWzFdLCAzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuc3ViYmxvY2tfZ2FpblsyXSwgMyk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIDAsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLyogd2luZG93X3N3aXRjaGluZ19mbGFnICovXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2kudGFibGVfc2VsZWN0WzBdID09IDE0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdpLnRhYmxlX3NlbGVjdFswXSA9IDE2O1xuICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS50YWJsZV9zZWxlY3RbMF0sIDUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdpLnRhYmxlX3NlbGVjdFsxXSA9PSAxNClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnaS50YWJsZV9zZWxlY3RbMV0gPSAxNjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kudGFibGVfc2VsZWN0WzFdLCA1KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnaS50YWJsZV9zZWxlY3RbMl0gPT0gMTQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2kudGFibGVfc2VsZWN0WzJdID0gMTY7XG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnRhYmxlX3NlbGVjdFsyXSwgNSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kucmVnaW9uMF9jb3VudCwgNCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnJlZ2lvbjFfY291bnQsIDMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kucHJlZmxhZywgMSk7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuc2NhbGVmYWNfc2NhbGUsIDEpO1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLmNvdW50MXRhYmxlX3NlbGVjdCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLyogTVBFRzIgKi9cbiAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgKGwzX3NpZGUubWFpbl9kYXRhX2JlZ2luKSwgOCk7XG4gICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGwzX3NpZGUucHJpdmF0ZV9iaXRzLCBnZmMuY2hhbm5lbHNfb3V0KTtcblxuICAgICAgICAgICAgZ3IgPSAwO1xuICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgIHZhciBnaSA9IGwzX3NpZGUudHRbZ3JdW2NoXTtcbiAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnBhcnQyXzNfbGVuZ3RoICsgZ2kucGFydDJfbGVuZ3RoLCAxMik7XG4gICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5iaWdfdmFsdWVzIC8gMiwgOSk7XG4gICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5nbG9iYWxfZ2FpbiwgOCk7XG4gICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5zY2FsZWZhY19jb21wcmVzcywgOSk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZ2kuYmxvY2tfdHlwZSAhPSBFbmNvZGVyLk5PUk1fVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIDEsIDEpO1xuICAgICAgICAgICAgICAgICAgICAvKiB3aW5kb3dfc3dpdGNoaW5nX2ZsYWcgKi9cbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5ibG9ja190eXBlLCAyKTtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5taXhlZF9ibG9ja19mbGFnLCAxKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZ2kudGFibGVfc2VsZWN0WzBdID09IDE0KVxuICAgICAgICAgICAgICAgICAgICAgICAgZ2kudGFibGVfc2VsZWN0WzBdID0gMTY7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kudGFibGVfc2VsZWN0WzBdLCA1KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdpLnRhYmxlX3NlbGVjdFsxXSA9PSAxNClcbiAgICAgICAgICAgICAgICAgICAgICAgIGdpLnRhYmxlX3NlbGVjdFsxXSA9IDE2O1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnRhYmxlX3NlbGVjdFsxXSwgNSk7XG5cbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5zdWJibG9ja19nYWluWzBdLCAzKTtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5zdWJibG9ja19nYWluWzFdLCAzKTtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS5zdWJibG9ja19nYWluWzJdLCAzKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIDAsIDEpO1xuICAgICAgICAgICAgICAgICAgICAvKiB3aW5kb3dfc3dpdGNoaW5nX2ZsYWcgKi9cbiAgICAgICAgICAgICAgICAgICAgaWYgKGdpLnRhYmxlX3NlbGVjdFswXSA9PSAxNClcbiAgICAgICAgICAgICAgICAgICAgICAgIGdpLnRhYmxlX3NlbGVjdFswXSA9IDE2O1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnRhYmxlX3NlbGVjdFswXSwgNSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChnaS50YWJsZV9zZWxlY3RbMV0gPT0gMTQpXG4gICAgICAgICAgICAgICAgICAgICAgICBnaS50YWJsZV9zZWxlY3RbMV0gPSAxNjtcbiAgICAgICAgICAgICAgICAgICAgd3JpdGVoZWFkZXIoZ2ZjLCBnaS50YWJsZV9zZWxlY3RbMV0sIDUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2kudGFibGVfc2VsZWN0WzJdID09IDE0KVxuICAgICAgICAgICAgICAgICAgICAgICAgZ2kudGFibGVfc2VsZWN0WzJdID0gMTY7XG4gICAgICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kudGFibGVfc2VsZWN0WzJdLCA1KTtcblxuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnJlZ2lvbjBfY291bnQsIDQpO1xuICAgICAgICAgICAgICAgICAgICB3cml0ZWhlYWRlcihnZmMsIGdpLnJlZ2lvbjFfY291bnQsIDMpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuc2NhbGVmYWNfc2NhbGUsIDEpO1xuICAgICAgICAgICAgICAgIHdyaXRlaGVhZGVyKGdmYywgZ2kuY291bnQxdGFibGVfc2VsZWN0LCAxKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChnZnAuZXJyb3JfcHJvdGVjdGlvbikge1xuICAgICAgICAgICAgLyogKGpvKSBlcnJvcl9wcm90ZWN0aW9uOiBhZGQgY3JjMTYgaW5mb3JtYXRpb24gdG8gaGVhZGVyICovXG4gICAgICAgICAgICBDUkNfd3JpdGVoZWFkZXIoZ2ZjLCBnZmMuaGVhZGVyW2dmYy5oX3B0cl0uYnVmKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBvbGQgPSBnZmMuaF9wdHI7XG5cbiAgICAgICAgICAgIGdmYy5oX3B0ciA9IChvbGQgKyAxKSAmIChMYW1lSW50ZXJuYWxGbGFncy5NQVhfSEVBREVSX0JVRiAtIDEpO1xuICAgICAgICAgICAgZ2ZjLmhlYWRlcltnZmMuaF9wdHJdLndyaXRlX3RpbWluZyA9IGdmYy5oZWFkZXJbb2xkXS53cml0ZV90aW1pbmdcbiAgICAgICAgICAgICAgICArIGJpdHNQZXJGcmFtZTtcblxuICAgICAgICAgICAgaWYgKGdmYy5oX3B0ciA9PSBnZmMud19wdHIpIHtcbiAgICAgICAgICAgICAgICAvKiB5aWtlcyEgd2UgYXJlIG91dCBvZiBoZWFkZXIgYnVmZmVyIHNwYWNlICovXG4gICAgICAgICAgICAgICAgU3lzdGVtLmVyclxuICAgICAgICAgICAgICAgICAgICAucHJpbnRsbihcIkVycm9yOiBNQVhfSEVBREVSX0JVRiB0b28gc21hbGwgaW4gYml0c3RyZWFtLmMgXFxuXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBodWZmbWFuX2NvZGVyX2NvdW50MShnZmMsIGdpKSB7XG4gICAgICAgIC8qIFdyaXRlIGNvdW50MSBhcmVhICovXG4gICAgICAgIHZhciBoID0gVGFibGVzLmh0W2dpLmNvdW50MXRhYmxlX3NlbGVjdCArIDMyXTtcbiAgICAgICAgdmFyIGksIGJpdHMgPSAwO1xuXG4gICAgICAgIHZhciBpeCA9IGdpLmJpZ192YWx1ZXM7XG4gICAgICAgIHZhciB4ciA9IGdpLmJpZ192YWx1ZXM7XG5cbiAgICAgICAgZm9yIChpID0gKGdpLmNvdW50MSAtIGdpLmJpZ192YWx1ZXMpIC8gNDsgaSA+IDA7IC0taSkge1xuICAgICAgICAgICAgdmFyIGh1ZmZiaXRzID0gMDtcbiAgICAgICAgICAgIHZhciBwID0gMCwgdjtcblxuICAgICAgICAgICAgdiA9IGdpLmwzX2VuY1tpeCArIDBdO1xuICAgICAgICAgICAgaWYgKHYgIT0gMCkge1xuICAgICAgICAgICAgICAgIHAgKz0gODtcbiAgICAgICAgICAgICAgICBpZiAoZ2kueHJbeHIgKyAwXSA8IDApXG4gICAgICAgICAgICAgICAgICAgIGh1ZmZiaXRzKys7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHYgPSBnaS5sM19lbmNbaXggKyAxXTtcbiAgICAgICAgICAgIGlmICh2ICE9IDApIHtcbiAgICAgICAgICAgICAgICBwICs9IDQ7XG4gICAgICAgICAgICAgICAgaHVmZmJpdHMgKj0gMjtcbiAgICAgICAgICAgICAgICBpZiAoZ2kueHJbeHIgKyAxXSA8IDApXG4gICAgICAgICAgICAgICAgICAgIGh1ZmZiaXRzKys7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHYgPSBnaS5sM19lbmNbaXggKyAyXTtcbiAgICAgICAgICAgIGlmICh2ICE9IDApIHtcbiAgICAgICAgICAgICAgICBwICs9IDI7XG4gICAgICAgICAgICAgICAgaHVmZmJpdHMgKj0gMjtcbiAgICAgICAgICAgICAgICBpZiAoZ2kueHJbeHIgKyAyXSA8IDApXG4gICAgICAgICAgICAgICAgICAgIGh1ZmZiaXRzKys7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHYgPSBnaS5sM19lbmNbaXggKyAzXTtcbiAgICAgICAgICAgIGlmICh2ICE9IDApIHtcbiAgICAgICAgICAgICAgICBwKys7XG4gICAgICAgICAgICAgICAgaHVmZmJpdHMgKj0gMjtcbiAgICAgICAgICAgICAgICBpZiAoZ2kueHJbeHIgKyAzXSA8IDApXG4gICAgICAgICAgICAgICAgICAgIGh1ZmZiaXRzKys7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGl4ICs9IDQ7XG4gICAgICAgICAgICB4ciArPSA0O1xuICAgICAgICAgICAgcHV0Yml0czIoZ2ZjLCBodWZmYml0cyArIGgudGFibGVbcF0sIGguaGxlbltwXSk7XG4gICAgICAgICAgICBiaXRzICs9IGguaGxlbltwXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYml0cztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbXBsZW1lbnRzIHRoZSBwc2V1ZG9jb2RlIG9mIHBhZ2UgOTggb2YgdGhlIElTXG4gICAgICovXG4gICAgZnVuY3Rpb24gSHVmZm1hbmNvZGUoZ2ZjLCB0YWJsZWluZGV4LCBzdGFydCwgZW5kLCBnaSkge1xuICAgICAgICB2YXIgaCA9IFRhYmxlcy5odFt0YWJsZWluZGV4XTtcbiAgICAgICAgdmFyIGJpdHMgPSAwO1xuXG4gICAgICAgIGlmICgwID09IHRhYmxlaW5kZXgpXG4gICAgICAgICAgICByZXR1cm4gYml0cztcblxuICAgICAgICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7IGkgKz0gMikge1xuICAgICAgICAgICAgdmFyIGNiaXRzID0gMDtcbiAgICAgICAgICAgIHZhciB4Yml0cyA9IDA7XG4gICAgICAgICAgICB2YXIgbGluYml0cyA9IGgueGxlbjtcbiAgICAgICAgICAgIHZhciB4bGVuID0gaC54bGVuO1xuICAgICAgICAgICAgdmFyIGV4dCA9IDA7XG4gICAgICAgICAgICB2YXIgeDEgPSBnaS5sM19lbmNbaV07XG4gICAgICAgICAgICB2YXIgeDIgPSBnaS5sM19lbmNbaSArIDFdO1xuXG4gICAgICAgICAgICBpZiAoeDEgIT0gMCkge1xuICAgICAgICAgICAgICAgIGlmIChnaS54cltpXSA8IDApXG4gICAgICAgICAgICAgICAgICAgIGV4dCsrO1xuICAgICAgICAgICAgICAgIGNiaXRzLS07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0YWJsZWluZGV4ID4gMTUpIHtcbiAgICAgICAgICAgICAgICAvKiB1c2UgRVNDLXdvcmRzICovXG4gICAgICAgICAgICAgICAgaWYgKHgxID4gMTQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmJpdHNfeDEgPSB4MSAtIDE1O1xuICAgICAgICAgICAgICAgICAgICBleHQgfD0gbGluYml0c194MSA8PCAxO1xuICAgICAgICAgICAgICAgICAgICB4Yml0cyA9IGxpbmJpdHM7XG4gICAgICAgICAgICAgICAgICAgIHgxID0gMTU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHgyID4gMTQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmJpdHNfeDIgPSB4MiAtIDE1O1xuICAgICAgICAgICAgICAgICAgICBleHQgPDw9IGxpbmJpdHM7XG4gICAgICAgICAgICAgICAgICAgIGV4dCB8PSBsaW5iaXRzX3gyO1xuICAgICAgICAgICAgICAgICAgICB4Yml0cyArPSBsaW5iaXRzO1xuICAgICAgICAgICAgICAgICAgICB4MiA9IDE1O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB4bGVuID0gMTY7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh4MiAhPSAwKSB7XG4gICAgICAgICAgICAgICAgZXh0IDw8PSAxO1xuICAgICAgICAgICAgICAgIGlmIChnaS54cltpICsgMV0gPCAwKVxuICAgICAgICAgICAgICAgICAgICBleHQrKztcbiAgICAgICAgICAgICAgICBjYml0cy0tO1xuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIHgxID0geDEgKiB4bGVuICsgeDI7XG4gICAgICAgICAgICB4Yml0cyAtPSBjYml0cztcbiAgICAgICAgICAgIGNiaXRzICs9IGguaGxlblt4MV07XG5cblxuICAgICAgICAgICAgcHV0Yml0czIoZ2ZjLCBoLnRhYmxlW3gxXSwgY2JpdHMpO1xuICAgICAgICAgICAgcHV0Yml0czIoZ2ZjLCBleHQsIHhiaXRzKTtcbiAgICAgICAgICAgIGJpdHMgKz0gY2JpdHMgKyB4Yml0cztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYml0cztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBOb3RlIHRoZSBkaXNjdXNzaW9uIG9mIGh1ZmZtYW5jb2RlYml0cygpIG9uIHBhZ2VzIDI4IGFuZCAyOSBvZiB0aGUgSVMsIGFzXG4gICAgICogd2VsbCBhcyB0aGUgZGVmaW5pdGlvbnMgb2YgdGhlIHNpZGUgaW5mb3JtYXRpb24gb24gcGFnZXMgMjYgYW5kIDI3LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFNob3J0SHVmZm1hbmNvZGViaXRzKGdmYywgZ2kpIHtcbiAgICAgICAgdmFyIHJlZ2lvbjFTdGFydCA9IDMgKiBnZmMuc2NhbGVmYWNfYmFuZC5zWzNdO1xuICAgICAgICBpZiAocmVnaW9uMVN0YXJ0ID4gZ2kuYmlnX3ZhbHVlcylcbiAgICAgICAgICAgIHJlZ2lvbjFTdGFydCA9IGdpLmJpZ192YWx1ZXM7XG5cbiAgICAgICAgLyogc2hvcnQgYmxvY2tzIGRvIG5vdCBoYXZlIGEgcmVnaW9uMiAqL1xuICAgICAgICB2YXIgYml0cyA9IEh1ZmZtYW5jb2RlKGdmYywgZ2kudGFibGVfc2VsZWN0WzBdLCAwLCByZWdpb24xU3RhcnQsIGdpKTtcbiAgICAgICAgYml0cyArPSBIdWZmbWFuY29kZShnZmMsIGdpLnRhYmxlX3NlbGVjdFsxXSwgcmVnaW9uMVN0YXJ0LFxuICAgICAgICAgICAgZ2kuYmlnX3ZhbHVlcywgZ2kpO1xuICAgICAgICByZXR1cm4gYml0cztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBMb25nSHVmZm1hbmNvZGViaXRzKGdmYywgZ2kpIHtcbiAgICAgICAgdmFyIGJpZ3ZhbHVlcywgYml0cztcbiAgICAgICAgdmFyIHJlZ2lvbjFTdGFydCwgcmVnaW9uMlN0YXJ0O1xuXG4gICAgICAgIGJpZ3ZhbHVlcyA9IGdpLmJpZ192YWx1ZXM7XG5cbiAgICAgICAgdmFyIGkgPSBnaS5yZWdpb24wX2NvdW50ICsgMTtcbiAgICAgICAgcmVnaW9uMVN0YXJ0ID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFtpXTtcbiAgICAgICAgaSArPSBnaS5yZWdpb24xX2NvdW50ICsgMTtcbiAgICAgICAgcmVnaW9uMlN0YXJ0ID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFtpXTtcblxuICAgICAgICBpZiAocmVnaW9uMVN0YXJ0ID4gYmlndmFsdWVzKVxuICAgICAgICAgICAgcmVnaW9uMVN0YXJ0ID0gYmlndmFsdWVzO1xuXG4gICAgICAgIGlmIChyZWdpb24yU3RhcnQgPiBiaWd2YWx1ZXMpXG4gICAgICAgICAgICByZWdpb24yU3RhcnQgPSBiaWd2YWx1ZXM7XG5cbiAgICAgICAgYml0cyA9IEh1ZmZtYW5jb2RlKGdmYywgZ2kudGFibGVfc2VsZWN0WzBdLCAwLCByZWdpb24xU3RhcnQsIGdpKTtcbiAgICAgICAgYml0cyArPSBIdWZmbWFuY29kZShnZmMsIGdpLnRhYmxlX3NlbGVjdFsxXSwgcmVnaW9uMVN0YXJ0LFxuICAgICAgICAgICAgcmVnaW9uMlN0YXJ0LCBnaSk7XG4gICAgICAgIGJpdHMgKz0gSHVmZm1hbmNvZGUoZ2ZjLCBnaS50YWJsZV9zZWxlY3RbMl0sIHJlZ2lvbjJTdGFydCwgYmlndmFsdWVzLFxuICAgICAgICAgICAgZ2kpO1xuICAgICAgICByZXR1cm4gYml0cztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiB3cml0ZU1haW5EYXRhKGdmcCkge1xuICAgICAgICB2YXIgZ3IsIGNoLCBzZmIsIGRhdGFfYml0cywgdG90X2JpdHMgPSAwO1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgbDNfc2lkZSA9IGdmYy5sM19zaWRlO1xuXG4gICAgICAgIGlmIChnZnAudmVyc2lvbiA9PSAxKSB7XG4gICAgICAgICAgICAvKiBNUEVHIDEgKi9cbiAgICAgICAgICAgIGZvciAoZ3IgPSAwOyBnciA8IDI7IGdyKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBnaSA9IGwzX3NpZGUudHRbZ3JdW2NoXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNsZW4xID0gVGFrZWhpcm8uc2xlbjFfdGFiW2dpLnNjYWxlZmFjX2NvbXByZXNzXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNsZW4yID0gVGFrZWhpcm8uc2xlbjJfdGFiW2dpLnNjYWxlZmFjX2NvbXByZXNzXTtcbiAgICAgICAgICAgICAgICAgICAgZGF0YV9iaXRzID0gMDtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChzZmIgPSAwOyBzZmIgPCBnaS5zZmJkaXZpZGU7IHNmYisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2kuc2NhbGVmYWNbc2ZiXSA9PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIHNjZnNpIGlzIHVzZWQgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIHB1dGJpdHMyKGdmYywgZ2kuc2NhbGVmYWNbc2ZiXSwgc2xlbjEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YV9iaXRzICs9IHNsZW4xO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZvciAoOyBzZmIgPCBnaS5zZmJtYXg7IHNmYisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2kuc2NhbGVmYWNbc2ZiXSA9PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIHNjZnNpIGlzIHVzZWQgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIHB1dGJpdHMyKGdmYywgZ2kuc2NhbGVmYWNbc2ZiXSwgc2xlbjIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YV9iaXRzICs9IHNsZW4yO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGdpLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhX2JpdHMgKz0gU2hvcnRIdWZmbWFuY29kZWJpdHMoZ2ZjLCBnaSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhX2JpdHMgKz0gTG9uZ0h1ZmZtYW5jb2RlYml0cyhnZmMsIGdpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBkYXRhX2JpdHMgKz0gaHVmZm1hbl9jb2Rlcl9jb3VudDEoZ2ZjLCBnaSk7XG4gICAgICAgICAgICAgICAgICAgIC8qIGRvZXMgYml0Y291bnQgaW4gcXVhbnRpemUuYyBhZ3JlZSB3aXRoIGFjdHVhbCBiaXQgY291bnQ/ICovXG4gICAgICAgICAgICAgICAgICAgIHRvdF9iaXRzICs9IGRhdGFfYml0cztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLyogZm9yIGNoICovXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBmb3IgZ3IgKi9cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8qIE1QRUcgMiAqL1xuICAgICAgICAgICAgZ3IgPSAwO1xuICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgIHZhciBnaSA9IGwzX3NpZGUudHRbZ3JdW2NoXTtcbiAgICAgICAgICAgICAgICB2YXIgaSwgc2ZiX3BhcnRpdGlvbiwgc2NhbGVfYml0cyA9IDA7XG4gICAgICAgICAgICAgICAgZGF0YV9iaXRzID0gMDtcbiAgICAgICAgICAgICAgICBzZmIgPSAwO1xuICAgICAgICAgICAgICAgIHNmYl9wYXJ0aXRpb24gPSAwO1xuXG4gICAgICAgICAgICAgICAgaWYgKGdpLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoOyBzZmJfcGFydGl0aW9uIDwgNDsgc2ZiX3BhcnRpdGlvbisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2ZicyA9IGdpLnNmYl9wYXJ0aXRpb25fdGFibGVbc2ZiX3BhcnRpdGlvbl0gLyAzO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNsZW4gPSBnaS5zbGVuW3NmYl9wYXJ0aXRpb25dO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNmYnM7IGkrKywgc2ZiKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdXRiaXRzMihnZmMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1hdGgubWF4KGdpLnNjYWxlZmFjW3NmYiAqIDMgKyAwXSwgMCksIHNsZW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHB1dGJpdHMyKGdmYyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5tYXgoZ2kuc2NhbGVmYWNbc2ZiICogMyArIDFdLCAwKSwgc2xlbik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcHV0Yml0czIoZ2ZjLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNYXRoLm1heChnaS5zY2FsZWZhY1tzZmIgKiAzICsgMl0sIDApLCBzbGVuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZV9iaXRzICs9IDMgKiBzbGVuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGRhdGFfYml0cyArPSBTaG9ydEh1ZmZtYW5jb2RlYml0cyhnZmMsIGdpKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKDsgc2ZiX3BhcnRpdGlvbiA8IDQ7IHNmYl9wYXJ0aXRpb24rKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNmYnMgPSBnaS5zZmJfcGFydGl0aW9uX3RhYmxlW3NmYl9wYXJ0aXRpb25dO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNsZW4gPSBnaS5zbGVuW3NmYl9wYXJ0aXRpb25dO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNmYnM7IGkrKywgc2ZiKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwdXRiaXRzMihnZmMsIE1hdGgubWF4KGdpLnNjYWxlZmFjW3NmYl0sIDApLCBzbGVuKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY2FsZV9iaXRzICs9IHNsZW47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZGF0YV9iaXRzICs9IExvbmdIdWZmbWFuY29kZWJpdHMoZ2ZjLCBnaSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRhdGFfYml0cyArPSBodWZmbWFuX2NvZGVyX2NvdW50MShnZmMsIGdpKTtcbiAgICAgICAgICAgICAgICAvKiBkb2VzIGJpdGNvdW50IGluIHF1YW50aXplLmMgYWdyZWUgd2l0aCBhY3R1YWwgYml0IGNvdW50PyAqL1xuICAgICAgICAgICAgICAgIHRvdF9iaXRzICs9IHNjYWxlX2JpdHMgKyBkYXRhX2JpdHM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBmb3IgY2ggKi9cbiAgICAgICAgfVxuICAgICAgICAvKiBmb3IgZ2YgKi9cbiAgICAgICAgcmV0dXJuIHRvdF9iaXRzO1xuICAgIH1cblxuICAgIC8qIG1haW5fZGF0YSAqL1xuXG4gICAgZnVuY3Rpb24gVG90YWxCeXRlcygpIHtcbiAgICAgICAgdGhpcy50b3RhbCA9IDA7XG4gICAgfVxuXG4gICAgLypcbiAgICAgKiBjb21wdXRlIHRoZSBudW1iZXIgb2YgYml0cyByZXF1aXJlZCB0byBmbHVzaCBhbGwgbXAzIGZyYW1lcyBjdXJyZW50bHkgaW5cbiAgICAgKiB0aGUgYnVmZmVyLiBUaGlzIHNob3VsZCBiZSB0aGUgc2FtZSBhcyB0aGUgcmVzZXJ2b2lyIHNpemUuIE9ubHkgY2FsbCB0aGlzXG4gICAgICogcm91dGluZSBiZXR3ZWVuIGZyYW1lcyAtIGkuZS4gb25seSBhZnRlciBhbGwgaGVhZGVycyBhbmQgZGF0YSBoYXZlIGJlZW5cbiAgICAgKiBhZGRlZCB0byB0aGUgYnVmZmVyIGJ5IGZvcm1hdF9iaXRzdHJlYW0oKS5cbiAgICAgKlxuICAgICAqIEFsc28gY29tcHV0ZSB0b3RhbF9iaXRzX291dHB1dCA9IHNpemUgb2YgbXAzIGJ1ZmZlciAoaW5jbHVkaW5nIGZyYW1lXG4gICAgICogaGVhZGVycyB3aGljaCBtYXkgbm90IGhhdmUgeWV0IGJlZW4gc2VuZCB0byB0aGUgbXAzIGJ1ZmZlcikgKyBudW1iZXIgb2ZcbiAgICAgKiBiaXRzIG5lZWRlZCB0byBmbHVzaCBhbGwgbXAzIGZyYW1lcy5cbiAgICAgKlxuICAgICAqIHRvdGFsX2J5dGVzX291dHB1dCBpcyB0aGUgc2l6ZSBvZiB0aGUgbXAzIG91dHB1dCBidWZmZXIgaWZcbiAgICAgKiBsYW1lX2VuY29kZV9mbHVzaF9ub2dhcCgpIHdhcyBjYWxsZWQgcmlnaHQgbm93LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbXB1dGVfZmx1c2hiaXRzKGdmcCwgdG90YWxfYnl0ZXNfb3V0cHV0KSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBmbHVzaGJpdHMsIHJlbWFpbmluZ19oZWFkZXJzO1xuICAgICAgICB2YXIgYml0c1BlckZyYW1lO1xuICAgICAgICB2YXIgbGFzdF9wdHIsIGZpcnN0X3B0cjtcbiAgICAgICAgZmlyc3RfcHRyID0gZ2ZjLndfcHRyO1xuICAgICAgICAvKiBmaXJzdCBoZWFkZXIgdG8gYWRkIHRvIGJpdHN0cmVhbSAqL1xuICAgICAgICBsYXN0X3B0ciA9IGdmYy5oX3B0ciAtIDE7XG4gICAgICAgIC8qIGxhc3QgaGVhZGVyIHRvIGFkZCB0byBiaXRzdHJlYW0gKi9cbiAgICAgICAgaWYgKGxhc3RfcHRyID09IC0xKVxuICAgICAgICAgICAgbGFzdF9wdHIgPSBMYW1lSW50ZXJuYWxGbGFncy5NQVhfSEVBREVSX0JVRiAtIDE7XG5cbiAgICAgICAgLyogYWRkIHRoaXMgbWFueSBiaXRzIHRvIGJpdHN0cmVhbSBzbyB3ZSBjYW4gZmx1c2ggYWxsIGhlYWRlcnMgKi9cbiAgICAgICAgZmx1c2hiaXRzID0gZ2ZjLmhlYWRlcltsYXN0X3B0cl0ud3JpdGVfdGltaW5nIC0gdG90Yml0O1xuICAgICAgICB0b3RhbF9ieXRlc19vdXRwdXQudG90YWwgPSBmbHVzaGJpdHM7XG5cbiAgICAgICAgaWYgKGZsdXNoYml0cyA+PSAwKSB7XG4gICAgICAgICAgICAvKiBpZiBmbHVzaGJpdHMgPj0gMCwgc29tZSBoZWFkZXJzIGhhdmUgbm90IHlldCBiZWVuIHdyaXR0ZW4gKi9cbiAgICAgICAgICAgIC8qIHJlZHVjZSBmbHVzaGJpdHMgYnkgdGhlIHNpemUgb2YgdGhlIGhlYWRlcnMgKi9cbiAgICAgICAgICAgIHJlbWFpbmluZ19oZWFkZXJzID0gMSArIGxhc3RfcHRyIC0gZmlyc3RfcHRyO1xuICAgICAgICAgICAgaWYgKGxhc3RfcHRyIDwgZmlyc3RfcHRyKVxuICAgICAgICAgICAgICAgIHJlbWFpbmluZ19oZWFkZXJzID0gMSArIGxhc3RfcHRyIC0gZmlyc3RfcHRyXG4gICAgICAgICAgICAgICAgICAgICsgTGFtZUludGVybmFsRmxhZ3MuTUFYX0hFQURFUl9CVUY7XG4gICAgICAgICAgICBmbHVzaGJpdHMgLT0gcmVtYWluaW5nX2hlYWRlcnMgKiA4ICogZ2ZjLnNpZGVpbmZvX2xlbjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGZpbmFsbHksIGFkZCBzb21lIGJpdHMgc28gdGhhdCB0aGUgbGFzdCBmcmFtZSBpcyBjb21wbGV0ZSB0aGVzZSBiaXRzXG4gICAgICAgICAqIGFyZSBub3QgbmVjZXNzYXJ5IHRvIGRlY29kZSB0aGUgbGFzdCBmcmFtZSwgYnV0IHNvbWUgZGVjb2RlcnMgd2lsbFxuICAgICAgICAgKiBpZ25vcmUgbGFzdCBmcmFtZSBpZiB0aGVzZSBiaXRzIGFyZSBtaXNzaW5nXG4gICAgICAgICAqL1xuICAgICAgICBiaXRzUGVyRnJhbWUgPSBzZWxmLmdldGZyYW1lYml0cyhnZnApO1xuICAgICAgICBmbHVzaGJpdHMgKz0gYml0c1BlckZyYW1lO1xuICAgICAgICB0b3RhbF9ieXRlc19vdXRwdXQudG90YWwgKz0gYml0c1BlckZyYW1lO1xuICAgICAgICAvKiByb3VuZCB1cDogKi9cbiAgICAgICAgaWYgKCh0b3RhbF9ieXRlc19vdXRwdXQudG90YWwgJSA4KSAhPSAwKVxuICAgICAgICAgICAgdG90YWxfYnl0ZXNfb3V0cHV0LnRvdGFsID0gMSArICh0b3RhbF9ieXRlc19vdXRwdXQudG90YWwgLyA4KTtcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgdG90YWxfYnl0ZXNfb3V0cHV0LnRvdGFsID0gKHRvdGFsX2J5dGVzX291dHB1dC50b3RhbCAvIDgpO1xuICAgICAgICB0b3RhbF9ieXRlc19vdXRwdXQudG90YWwgKz0gYnVmQnl0ZUlkeCArIDE7XG5cbiAgICAgICAgaWYgKGZsdXNoYml0cyA8IDApIHtcbiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcInN0cmFuZ2UgZXJyb3IgZmx1c2hpbmcgYnVmZmVyIC4uLiBcXG5cIik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZsdXNoYml0cztcbiAgICB9XG5cbiAgICB0aGlzLmZsdXNoX2JpdHN0cmVhbSA9IGZ1bmN0aW9uIChnZnApIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGwzX3NpZGU7XG4gICAgICAgIHZhciBmbHVzaGJpdHM7XG4gICAgICAgIHZhciBsYXN0X3B0ciA9IGdmYy5oX3B0ciAtIDE7XG4gICAgICAgIC8qIGxhc3QgaGVhZGVyIHRvIGFkZCB0byBiaXRzdHJlYW0gKi9cbiAgICAgICAgaWYgKGxhc3RfcHRyID09IC0xKVxuICAgICAgICAgICAgbGFzdF9wdHIgPSBMYW1lSW50ZXJuYWxGbGFncy5NQVhfSEVBREVSX0JVRiAtIDE7XG4gICAgICAgIGwzX3NpZGUgPSBnZmMubDNfc2lkZTtcblxuICAgICAgICBpZiAoKGZsdXNoYml0cyA9IGNvbXB1dGVfZmx1c2hiaXRzKGdmcCwgbmV3IFRvdGFsQnl0ZXMoKSkpIDwgMClcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgZHJhaW5faW50b19hbmNpbGxhcnkoZ2ZwLCBmbHVzaGJpdHMpO1xuXG4gICAgICAgIC8qIGNoZWNrIHRoYXQgdGhlIDEwMCUgb2YgdGhlIGxhc3QgZnJhbWUgaGFzIGJlZW4gd3JpdHRlbiB0byBiaXRzdHJlYW0gKi9cblxuICAgICAgICAvKlxuICAgICAgICAgKiB3ZSBoYXZlIHBhZGRlZCBvdXQgYWxsIGZyYW1lcyB3aXRoIGFuY2lsbGFyeSBkYXRhLCB3aGljaCBpcyB0aGUgc2FtZVxuICAgICAgICAgKiBhcyBmaWxsaW5nIHRoZSBiaXRyZXNlcnZvaXIgd2l0aCBhbmNpbGxhcnkgZGF0YSwgc28gOlxuICAgICAgICAgKi9cbiAgICAgICAgZ2ZjLlJlc3ZTaXplID0gMDtcbiAgICAgICAgbDNfc2lkZS5tYWluX2RhdGFfYmVnaW4gPSAwO1xuXG4gICAgICAgIC8qIHNhdmUgdGhlIFJlcGxheUdhaW4gdmFsdWUgKi9cbiAgICAgICAgaWYgKGdmYy5maW5kUmVwbGF5R2Fpbikge1xuICAgICAgICAgICAgdmFyIFJhZGlvR2FpbiA9IGdhLkdldFRpdGxlR2FpbihnZmMucmdkYXRhKTtcbiAgICAgICAgICAgIGdmYy5SYWRpb0dhaW4gPSBNYXRoLmZsb29yKFJhZGlvR2FpbiAqIDEwLjAgKyAwLjUpIHwgMDtcbiAgICAgICAgICAgIC8qIHJvdW5kIHRvIG5lYXJlc3QgKi9cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGZpbmQgdGhlIGdhaW4gYW5kIHNjYWxlIGNoYW5nZSByZXF1aXJlZCBmb3Igbm8gY2xpcHBpbmcgKi9cbiAgICAgICAgaWYgKGdmYy5maW5kUGVha1NhbXBsZSkge1xuICAgICAgICAgICAgZ2ZjLm5vY2xpcEdhaW5DaGFuZ2UgPSBNYXRoLmNlaWwoXG4gICAgICAgICAgICAgICAgICAgICAgICBNYXRoX2xvZzEwKGdmYy5QZWFrU2FtcGxlIC8gMzI3NjcuMCkgKiAyMC4wICogMTAuMCkgfCAwO1xuICAgICAgICAgICAgLyogcm91bmQgdXAgKi9cblxuICAgICAgICAgICAgaWYgKGdmYy5ub2NsaXBHYWluQ2hhbmdlID4gMCkge1xuICAgICAgICAgICAgICAgIC8qIGNsaXBwaW5nIG9jY3VycyAqL1xuICAgICAgICAgICAgICAgIGlmIChFUShnZnAuc2NhbGUsIDEuMCkgfHwgRVEoZ2ZwLnNjYWxlLCAwLjApKVxuICAgICAgICAgICAgICAgICAgICBnZmMubm9jbGlwU2NhbGUgPSAoTWF0aFxuICAgICAgICAgICAgICAgICAgICAgICAgLmZsb29yKCgzMjc2Ny4wIC8gZ2ZjLlBlYWtTYW1wbGUpICogMTAwLjApIC8gMTAwLjApO1xuICAgICAgICAgICAgICAgIC8qIHJvdW5kIGRvd24gKi9cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICogdGhlIHVzZXIgc3BlY2lmaWVkIGhpcyBvd24gc2NhbGluZyBmYWN0b3IuIFdlIGNvdWxkXG4gICAgICAgICAgICAgICAgICAgICAqIHN1Z2dlc3QgdGhlIHNjYWxpbmcgZmFjdG9yIG9mXG4gICAgICAgICAgICAgICAgICAgICAqICgzMjc2Ny4wL2dmcC5QZWFrU2FtcGxlKSooZ2ZwLnNjYWxlKSBidXQgaXQncyB1c3VhbGx5XG4gICAgICAgICAgICAgICAgICAgICAqIHZlcnkgaW5hY2N1cmF0ZS4gU28gd2UnZCByYXRoZXIgbm90IGFkdmljZSBoaW0gb24gdGhlXG4gICAgICAgICAgICAgICAgICAgICAqIHNjYWxpbmcgZmFjdG9yLlxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgZ2ZjLm5vY2xpcFNjYWxlID0gLTE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAvKiBubyBjbGlwcGluZyAqL1xuICAgICAgICAgICAgICAgIGdmYy5ub2NsaXBTY2FsZSA9IC0xO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHRoaXMuYWRkX2R1bW15X2J5dGUgPSBmdW5jdGlvbiAoZ2ZwLCB2YWwsIG4pIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGk7XG5cbiAgICAgICAgd2hpbGUgKG4tLSA+IDApIHtcbiAgICAgICAgICAgIHB1dGJpdHNfbm9oZWFkZXJzKGdmYywgdmFsLCA4KTtcblxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9IRUFERVJfQlVGOyArK2kpXG4gICAgICAgICAgICAgICAgZ2ZjLmhlYWRlcltpXS53cml0ZV90aW1pbmcgKz0gODtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIGlzIGNhbGxlZCBhZnRlciBhIGZyYW1lIG9mIGF1ZGlvIGhhcyBiZWVuIHF1YW50aXplZCBhbmQgY29kZWQuIEl0XG4gICAgICogd2lsbCB3cml0ZSB0aGUgZW5jb2RlZCBhdWRpbyB0byB0aGUgYml0c3RyZWFtLiBOb3RlIHRoYXQgZnJvbSBhIGxheWVyM1xuICAgICAqIGVuY29kZXIncyBwZXJzcGVjdGl2ZSB0aGUgYml0IHN0cmVhbSBpcyBwcmltYXJpbHkgYSBzZXJpZXMgb2YgbWFpbl9kYXRhKClcbiAgICAgKiBibG9ja3MsIHdpdGggaGVhZGVyIGFuZCBzaWRlIGluZm9ybWF0aW9uIGluc2VydGVkIGF0IHRoZSBwcm9wZXIgbG9jYXRpb25zXG4gICAgICogdG8gbWFpbnRhaW4gZnJhbWluZy4gKFNlZSBGaWd1cmUgQS43IGluIHRoZSBJUykuXG4gICAgICovXG4gICAgdGhpcy5mb3JtYXRfYml0c3RyZWFtID0gZnVuY3Rpb24gKGdmcCkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgbDNfc2lkZTtcbiAgICAgICAgbDNfc2lkZSA9IGdmYy5sM19zaWRlO1xuXG4gICAgICAgIHZhciBiaXRzUGVyRnJhbWUgPSB0aGlzLmdldGZyYW1lYml0cyhnZnApO1xuICAgICAgICBkcmFpbl9pbnRvX2FuY2lsbGFyeShnZnAsIGwzX3NpZGUucmVzdkRyYWluX3ByZSk7XG5cbiAgICAgICAgZW5jb2RlU2lkZUluZm8yKGdmcCwgYml0c1BlckZyYW1lKTtcbiAgICAgICAgdmFyIGJpdHMgPSA4ICogZ2ZjLnNpZGVpbmZvX2xlbjtcbiAgICAgICAgYml0cyArPSB3cml0ZU1haW5EYXRhKGdmcCk7XG4gICAgICAgIGRyYWluX2ludG9fYW5jaWxsYXJ5KGdmcCwgbDNfc2lkZS5yZXN2RHJhaW5fcG9zdCk7XG4gICAgICAgIGJpdHMgKz0gbDNfc2lkZS5yZXN2RHJhaW5fcG9zdDtcblxuICAgICAgICBsM19zaWRlLm1haW5fZGF0YV9iZWdpbiArPSAoYml0c1BlckZyYW1lIC0gYml0cykgLyA4O1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGNvbXBhcmUgbnVtYmVyIG9mIGJpdHMgbmVlZGVkIHRvIGNsZWFyIGFsbCBidWZmZXJlZCBtcDMgZnJhbWVzIHdpdGhcbiAgICAgICAgICogd2hhdCB3ZSB0aGluayB0aGUgcmVzdnNpemUgaXM6XG4gICAgICAgICAqL1xuICAgICAgICBpZiAoY29tcHV0ZV9mbHVzaGJpdHMoZ2ZwLCBuZXcgVG90YWxCeXRlcygpKSAhPSBnZmMuUmVzdlNpemUpIHtcbiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIkludGVybmFsIGJ1ZmZlciBpbmNvbnNpc3RlbmN5LiBmbHVzaGJpdHMgPD4gUmVzdlNpemVcIik7XG4gICAgICAgIH1cblxuICAgICAgICAvKlxuICAgICAgICAgKiBjb21wYXJlIG1haW5fZGF0YV9iZWdpbiBmb3IgdGhlIG5leHQgZnJhbWUgd2l0aCB3aGF0IHdlIHRoaW5rIHRoZVxuICAgICAgICAgKiByZXN2c2l6ZSBpczpcbiAgICAgICAgICovXG4gICAgICAgIGlmICgobDNfc2lkZS5tYWluX2RhdGFfYmVnaW4gKiA4KSAhPSBnZmMuUmVzdlNpemUpIHtcbiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRmKFwiYml0IHJlc2Vydm9pciBlcnJvcjogXFxuXCJcbiAgICAgICAgICAgICAgICArIFwibDNfc2lkZS5tYWluX2RhdGFfYmVnaW46ICVkIFxcblwiXG4gICAgICAgICAgICAgICAgKyBcIlJlc3ZvaXIgc2l6ZTogICAgICAgICAgICAgJWQgXFxuXCJcbiAgICAgICAgICAgICAgICArIFwicmVzdiBkcmFpbiAocG9zdCkgICAgICAgICAlZCBcXG5cIlxuICAgICAgICAgICAgICAgICsgXCJyZXN2IGRyYWluIChwcmUpICAgICAgICAgICVkIFxcblwiXG4gICAgICAgICAgICAgICAgKyBcImhlYWRlciBhbmQgc2lkZWluZm86ICAgICAgJWQgXFxuXCJcbiAgICAgICAgICAgICAgICArIFwiZGF0YSBiaXRzOiAgICAgICAgICAgICAgICAlZCBcXG5cIlxuICAgICAgICAgICAgICAgICsgXCJ0b3RhbCBiaXRzOiAgICAgICAgICAgICAgICVkIChyZW1haW5kZXI6ICVkKSBcXG5cIlxuICAgICAgICAgICAgICAgICsgXCJiaXRzcGVyZnJhbWU6ICAgICAgICAgICAgICVkIFxcblwiLFxuICAgICAgICAgICAgICAgIDggKiBsM19zaWRlLm1haW5fZGF0YV9iZWdpbiwgZ2ZjLlJlc3ZTaXplLFxuICAgICAgICAgICAgICAgIGwzX3NpZGUucmVzdkRyYWluX3Bvc3QsIGwzX3NpZGUucmVzdkRyYWluX3ByZSxcbiAgICAgICAgICAgICAgICA4ICogZ2ZjLnNpZGVpbmZvX2xlbiwgYml0cyAtIGwzX3NpZGUucmVzdkRyYWluX3Bvc3QgLSA4XG4gICAgICAgICAgICAgICAgKiBnZmMuc2lkZWluZm9fbGVuLCBiaXRzLCBiaXRzICUgOCwgYml0c1BlckZyYW1lKTtcblxuICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiVGhpcyBpcyBhIGZhdGFsIGVycm9yLiAgSXQgaGFzIHNldmVyYWwgcG9zc2libGUgY2F1c2VzOlwiKTtcbiAgICAgICAgICAgIFN5c3RlbS5lcnIucHJpbnRsbihcIjkwJSUgIExBTUUgY29tcGlsZWQgd2l0aCBidWdneSB2ZXJzaW9uIG9mIGdjYyB1c2luZyBhZHZhbmNlZCBvcHRpbWl6YXRpb25zXCIpO1xuICAgICAgICAgICAgU3lzdGVtLmVyci5wcmludGxuKFwiIDklJSAgWW91ciBzeXN0ZW0gaXMgb3ZlcmNsb2NrZWRcIik7XG4gICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCIgMSUlICBidWcgaW4gTEFNRSBlbmNvZGluZyBsaWJyYXJ5XCIpO1xuXG4gICAgICAgICAgICBnZmMuUmVzdlNpemUgPSBsM19zaWRlLm1haW5fZGF0YV9iZWdpbiAqIDg7XG4gICAgICAgIH1cbiAgICAgICAgLy87XG5cbiAgICAgICAgaWYgKHRvdGJpdCA+IDEwMDAwMDAwMDApIHtcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiB0byBhdm9pZCB0b3RiaXQgb3ZlcmZsb3csIChhdCA4aCBlbmNvZGluZyBhdCAxMjhrYnMpIGxldHMgcmVzZXRcbiAgICAgICAgICAgICAqIGJpdCBjb3VudGVyXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHZhciBpO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9IRUFERVJfQlVGOyArK2kpXG4gICAgICAgICAgICAgICAgZ2ZjLmhlYWRlcltpXS53cml0ZV90aW1pbmcgLT0gdG90Yml0O1xuICAgICAgICAgICAgdG90Yml0ID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAwO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiA8UFJFPlxuICAgICAqIGNvcHkgZGF0YSBvdXQgb2YgdGhlIGludGVybmFsIE1QMyBiaXQgYnVmZmVyIGludG8gYSB1c2VyIHN1cHBsaWVkXG4gICAgICogICAgICAgdW5zaWduZWQgY2hhciBidWZmZXIuXG4gICAgICpcbiAgICAgKiAgICAgICBtcDNkYXRhPTAgICAgICBpbmRpY2F0ZXMgZGF0YSBpbiBidWZmZXIgaXMgYW4gaWQzdGFncyBhbmQgVkJSIHRhZ3NcbiAgICAgKiAgICAgICBtcDNkYXRhPTEgICAgICBkYXRhIGlzIHJlYWwgbXAzIGZyYW1lIGRhdGEuXG4gICAgICogPC9QUkU+XG4gICAgICovXG4gICAgdGhpcy5jb3B5X2J1ZmZlciA9IGZ1bmN0aW9uIChnZmMsIGJ1ZmZlciwgYnVmZmVyUG9zLCBzaXplLCBtcDNkYXRhKSB7XG4gICAgICAgIHZhciBtaW5pbXVtID0gYnVmQnl0ZUlkeCArIDE7XG4gICAgICAgIGlmIChtaW5pbXVtIDw9IDApXG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgaWYgKHNpemUgIT0gMCAmJiBtaW5pbXVtID4gc2l6ZSkge1xuICAgICAgICAgICAgLyogYnVmZmVyIGlzIHRvbyBzbWFsbCAqL1xuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgICAgIFN5c3RlbS5hcnJheWNvcHkoYnVmLCAwLCBidWZmZXIsIGJ1ZmZlclBvcywgbWluaW11bSk7XG4gICAgICAgIGJ1ZkJ5dGVJZHggPSAtMTtcbiAgICAgICAgYnVmQml0SWR4ID0gMDtcblxuICAgICAgICBpZiAobXAzZGF0YSAhPSAwKSB7XG4gICAgICAgICAgICB2YXIgY3JjID0gbmV3X2ludCgxKTtcbiAgICAgICAgICAgIGNyY1swXSA9IGdmYy5uTXVzaWNDUkM7XG4gICAgICAgICAgICB2YnIudXBkYXRlTXVzaWNDUkMoY3JjLCBidWZmZXIsIGJ1ZmZlclBvcywgbWluaW11bSk7XG4gICAgICAgICAgICBnZmMubk11c2ljQ1JDID0gY3JjWzBdO1xuXG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIHN1bSBudW1iZXIgb2YgYnl0ZXMgYmVsb25naW5nIHRvIHRoZSBtcDMgc3RyZWFtIHRoaXMgaW5mbyB3aWxsIGJlXG4gICAgICAgICAgICAgKiB3cml0dGVuIGludG8gdGhlIFhpbmcvTEFNRSBoZWFkZXIgZm9yIHNlZWtpbmdcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKG1pbmltdW0gPiAwKSB7XG4gICAgICAgICAgICAgICAgZ2ZjLlZCUl9zZWVrX3RhYmxlLm5CeXRlc1dyaXR0ZW4gKz0gbWluaW11bTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGdmYy5kZWNvZGVfb25fdGhlX2ZseSkgeyAvKiBkZWNvZGUgdGhlIGZyYW1lICovXG4gICAgICAgICAgICAgICAgdmFyIHBjbV9idWYgPSBuZXdfZmxvYXRfbihbMiwgMTE1Ml0pO1xuICAgICAgICAgICAgICAgIHZhciBtcDNfaW4gPSBtaW5pbXVtO1xuICAgICAgICAgICAgICAgIHZhciBzYW1wbGVzX291dCA9IC0xO1xuICAgICAgICAgICAgICAgIHZhciBpO1xuXG4gICAgICAgICAgICAgICAgLyogcmUtc3ludGhlc2lzIHRvIHBjbS4gUmVwZWF0IHVudGlsIHdlIGdldCBhIHNhbXBsZXNfb3V0PTAgKi9cbiAgICAgICAgICAgICAgICB3aGlsZSAoc2FtcGxlc19vdXQgIT0gMCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHNhbXBsZXNfb3V0ID0gbXBnLmhpcF9kZWNvZGUxX3VuY2xpcHBlZChnZmMuaGlwLCBidWZmZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICBidWZmZXJQb3MsIG1wM19pbiwgcGNtX2J1ZlswXSwgcGNtX2J1ZlsxXSk7XG4gICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAqIHNhbXBsZXNfb3V0ID0gMDogbmVlZCBtb3JlIGRhdGEgdG8gZGVjb2RlIHNhbXBsZXNfb3V0ID1cbiAgICAgICAgICAgICAgICAgICAgICogLTE6IGVycm9yLiBMZXRzIGFzc3VtZSAwIHBjbSBvdXRwdXQgc2FtcGxlc19vdXQgPSBudW1iZXJcbiAgICAgICAgICAgICAgICAgICAgICogb2Ygc2FtcGxlcyBvdXRwdXRcbiAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICogc2V0IHRoZSBsZW5naHQgb2YgdGhlIG1wMyBpbnB1dCBidWZmZXIgdG8gemVybywgc28gdGhhdFxuICAgICAgICAgICAgICAgICAgICAgKiBpbiB0aGUgbmV4dCBpdGVyYXRpb24gb2YgdGhlIGxvb3Agd2Ugd2lsbCBiZSBxdWVyeWluZ1xuICAgICAgICAgICAgICAgICAgICAgKiBtcGdsaWIgYWJvdXQgYnVmZmVyZWQgZGF0YVxuICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgbXAzX2luID0gMDtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoc2FtcGxlc19vdXQgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiBlcnJvciBkZWNvZGluZy4gTm90IGZhdGFsLCBidXQgbWlnaHQgc2NyZXcgdXAgdGhlXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiBSZXBsYXlHYWluIHRhZy4gV2hhdCBzaG91bGQgd2UgZG8/IElnbm9yZSBmb3Igbm93XG4gICAgICAgICAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIHNhbXBsZXNfb3V0ID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoc2FtcGxlc19vdXQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBwcm9jZXNzIHRoZSBQQ00gZGF0YSAqL1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICogdGhpcyBzaG91bGQgbm90IGJlIHBvc3NpYmxlLCBhbmQgaW5kaWNhdGVzIHdlIGhhdmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAqIG92ZXJmbG93biB0aGUgcGNtX2J1ZiBidWZmZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2ZjLmZpbmRQZWFrU2FtcGxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNhbXBsZXNfb3V0OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBjbV9idWZbMF1baV0gPiBnZmMuUGVha1NhbXBsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdmYy5QZWFrU2FtcGxlID0gcGNtX2J1ZlswXVtpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoLXBjbV9idWZbMF1baV0gPiBnZmMuUGVha1NhbXBsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdmYy5QZWFrU2FtcGxlID0gLXBjbV9idWZbMF1baV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnZmMuY2hhbm5lbHNfb3V0ID4gMSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IHNhbXBsZXNfb3V0OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwY21fYnVmWzFdW2ldID4gZ2ZjLlBlYWtTYW1wbGUpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ZjLlBlYWtTYW1wbGUgPSBwY21fYnVmWzFdW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoLXBjbV9idWZbMV1baV0gPiBnZmMuUGVha1NhbXBsZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZmMuUGVha1NhbXBsZSA9IC1wY21fYnVmWzFdW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnZmMuZmluZFJlcGxheUdhaW4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdhLkFuYWx5emVTYW1wbGVzKGdmYy5yZ2RhdGEsIHBjbV9idWZbMF0sIDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwY21fYnVmWzFdLCAwLCBzYW1wbGVzX291dCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdmYy5jaGFubmVsc19vdXQpID09IEdhaW5BbmFseXNpcy5HQUlOX0FOQUxZU0lTX0VSUk9SKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTY7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKiBpZiAoc2FtcGxlc19vdXQ+MCkgKi9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLyogd2hpbGUgKHNhbXBsZXNfb3V0IT0wKSAqL1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogaWYgKGdmYy5kZWNvZGVfb25fdGhlX2ZseSkgKi9cblxuICAgICAgICB9XG4gICAgICAgIC8qIGlmIChtcDNkYXRhKSAqL1xuICAgICAgICByZXR1cm4gbWluaW11bTtcbiAgICB9O1xuXG4gICAgdGhpcy5pbml0X2JpdF9zdHJlYW1fdyA9IGZ1bmN0aW9uIChnZmMpIHtcbiAgICAgICAgYnVmID0gbmV3X2J5dGUoTGFtZS5MQU1FX01BWE1QM0JVRkZFUik7XG5cbiAgICAgICAgZ2ZjLmhfcHRyID0gZ2ZjLndfcHRyID0gMDtcbiAgICAgICAgZ2ZjLmhlYWRlcltnZmMuaF9wdHJdLndyaXRlX3RpbWluZyA9IDA7XG4gICAgICAgIGJ1ZkJ5dGVJZHggPSAtMTtcbiAgICAgICAgYnVmQml0SWR4ID0gMDtcbiAgICAgICAgdG90Yml0ID0gMDtcbiAgICB9O1xuXG4gICAgLy8gRnJvbSBtYWNoaW5lLmhcblxuXG59XG5cbmZ1bmN0aW9uIEh1ZmZDb2RlVGFiKGxlbiwgbWF4LCB0YWIsIGhsKSB7XG4gICAgdGhpcy54bGVuID0gbGVuO1xuICAgIHRoaXMubGlubWF4ID0gbWF4O1xuICAgIHRoaXMudGFibGUgPSB0YWI7XG4gICAgdGhpcy5obGVuID0gaGw7XG59XG5cbnZhciBUYWJsZXMgPSB7fTtcblxuXG5UYWJsZXMudDFIQiA9IFtcbiAgICAxLCAxLFxuICAgIDEsIDBcbl07XG5cblRhYmxlcy50MkhCID0gW1xuICAgIDEsIDIsIDEsXG4gICAgMywgMSwgMSxcbiAgICAzLCAyLCAwXG5dO1xuXG5UYWJsZXMudDNIQiA9IFtcbiAgICAzLCAyLCAxLFxuICAgIDEsIDEsIDEsXG4gICAgMywgMiwgMFxuXTtcblxuVGFibGVzLnQ1SEIgPSBbXG4gICAgMSwgMiwgNiwgNSxcbiAgICAzLCAxLCA0LCA0LFxuICAgIDcsIDUsIDcsIDEsXG4gICAgNiwgMSwgMSwgMFxuXTtcblxuVGFibGVzLnQ2SEIgPSBbXG4gICAgNywgMywgNSwgMSxcbiAgICA2LCAyLCAzLCAyLFxuICAgIDUsIDQsIDQsIDEsXG4gICAgMywgMywgMiwgMFxuXTtcblxuVGFibGVzLnQ3SEIgPSBbXG4gICAgMSwgMiwgMTAsIDE5LCAxNiwgMTAsXG4gICAgMywgMywgNywgMTAsIDUsIDMsXG4gICAgMTEsIDQsIDEzLCAxNywgOCwgNCxcbiAgICAxMiwgMTEsIDE4LCAxNSwgMTEsIDIsXG4gICAgNywgNiwgOSwgMTQsIDMsIDEsXG4gICAgNiwgNCwgNSwgMywgMiwgMFxuXTtcblxuVGFibGVzLnQ4SEIgPSBbXG4gICAgMywgNCwgNiwgMTgsIDEyLCA1LFxuICAgIDUsIDEsIDIsIDE2LCA5LCAzLFxuICAgIDcsIDMsIDUsIDE0LCA3LCAzLFxuICAgIDE5LCAxNywgMTUsIDEzLCAxMCwgNCxcbiAgICAxMywgNSwgOCwgMTEsIDUsIDEsXG4gICAgMTIsIDQsIDQsIDEsIDEsIDBcbl07XG5cblRhYmxlcy50OUhCID0gW1xuICAgIDcsIDUsIDksIDE0LCAxNSwgNyxcbiAgICA2LCA0LCA1LCA1LCA2LCA3LFxuICAgIDcsIDYsIDgsIDgsIDgsIDUsXG4gICAgMTUsIDYsIDksIDEwLCA1LCAxLFxuICAgIDExLCA3LCA5LCA2LCA0LCAxLFxuICAgIDE0LCA0LCA2LCAyLCA2LCAwXG5dO1xuXG5UYWJsZXMudDEwSEIgPSBbXG4gICAgMSwgMiwgMTAsIDIzLCAzNSwgMzAsIDEyLCAxNyxcbiAgICAzLCAzLCA4LCAxMiwgMTgsIDIxLCAxMiwgNyxcbiAgICAxMSwgOSwgMTUsIDIxLCAzMiwgNDAsIDE5LCA2LFxuICAgIDE0LCAxMywgMjIsIDM0LCA0NiwgMjMsIDE4LCA3LFxuICAgIDIwLCAxOSwgMzMsIDQ3LCAyNywgMjIsIDksIDMsXG4gICAgMzEsIDIyLCA0MSwgMjYsIDIxLCAyMCwgNSwgMyxcbiAgICAxNCwgMTMsIDEwLCAxMSwgMTYsIDYsIDUsIDEsXG4gICAgOSwgOCwgNywgOCwgNCwgNCwgMiwgMFxuXTtcblxuVGFibGVzLnQxMUhCID0gW1xuICAgIDMsIDQsIDEwLCAyNCwgMzQsIDMzLCAyMSwgMTUsXG4gICAgNSwgMywgNCwgMTAsIDMyLCAxNywgMTEsIDEwLFxuICAgIDExLCA3LCAxMywgMTgsIDMwLCAzMSwgMjAsIDUsXG4gICAgMjUsIDExLCAxOSwgNTksIDI3LCAxOCwgMTIsIDUsXG4gICAgMzUsIDMzLCAzMSwgNTgsIDMwLCAxNiwgNywgNSxcbiAgICAyOCwgMjYsIDMyLCAxOSwgMTcsIDE1LCA4LCAxNCxcbiAgICAxNCwgMTIsIDksIDEzLCAxNCwgOSwgNCwgMSxcbiAgICAxMSwgNCwgNiwgNiwgNiwgMywgMiwgMFxuXTtcblxuVGFibGVzLnQxMkhCID0gW1xuICAgIDksIDYsIDE2LCAzMywgNDEsIDM5LCAzOCwgMjYsXG4gICAgNywgNSwgNiwgOSwgMjMsIDE2LCAyNiwgMTEsXG4gICAgMTcsIDcsIDExLCAxNCwgMjEsIDMwLCAxMCwgNyxcbiAgICAxNywgMTAsIDE1LCAxMiwgMTgsIDI4LCAxNCwgNSxcbiAgICAzMiwgMTMsIDIyLCAxOSwgMTgsIDE2LCA5LCA1LFxuICAgIDQwLCAxNywgMzEsIDI5LCAxNywgMTMsIDQsIDIsXG4gICAgMjcsIDEyLCAxMSwgMTUsIDEwLCA3LCA0LCAxLFxuICAgIDI3LCAxMiwgOCwgMTIsIDYsIDMsIDEsIDBcbl07XG5cblRhYmxlcy50MTNIQiA9IFtcbiAgICAxLCA1LCAxNCwgMjEsIDM0LCA1MSwgNDYsIDcxLCA0MiwgNTIsIDY4LCA1MiwgNjcsIDQ0LCA0MywgMTksXG4gICAgMywgNCwgMTIsIDE5LCAzMSwgMjYsIDQ0LCAzMywgMzEsIDI0LCAzMiwgMjQsIDMxLCAzNSwgMjIsIDE0LFxuICAgIDE1LCAxMywgMjMsIDM2LCA1OSwgNDksIDc3LCA2NSwgMjksIDQwLCAzMCwgNDAsIDI3LCAzMywgNDIsIDE2LFxuICAgIDIyLCAyMCwgMzcsIDYxLCA1NiwgNzksIDczLCA2NCwgNDMsIDc2LCA1NiwgMzcsIDI2LCAzMSwgMjUsIDE0LFxuICAgIDM1LCAxNiwgNjAsIDU3LCA5NywgNzUsIDExNCwgOTEsIDU0LCA3MywgNTUsIDQxLCA0OCwgNTMsIDIzLCAyNCxcbiAgICA1OCwgMjcsIDUwLCA5NiwgNzYsIDcwLCA5MywgODQsIDc3LCA1OCwgNzksIDI5LCA3NCwgNDksIDQxLCAxNyxcbiAgICA0NywgNDUsIDc4LCA3NCwgMTE1LCA5NCwgOTAsIDc5LCA2OSwgODMsIDcxLCA1MCwgNTksIDM4LCAzNiwgMTUsXG4gICAgNzIsIDM0LCA1NiwgOTUsIDkyLCA4NSwgOTEsIDkwLCA4NiwgNzMsIDc3LCA2NSwgNTEsIDQ0LCA0MywgNDIsXG4gICAgNDMsIDIwLCAzMCwgNDQsIDU1LCA3OCwgNzIsIDg3LCA3OCwgNjEsIDQ2LCA1NCwgMzcsIDMwLCAyMCwgMTYsXG4gICAgNTMsIDI1LCA0MSwgMzcsIDQ0LCA1OSwgNTQsIDgxLCA2NiwgNzYsIDU3LCA1NCwgMzcsIDE4LCAzOSwgMTEsXG4gICAgMzUsIDMzLCAzMSwgNTcsIDQyLCA4MiwgNzIsIDgwLCA0NywgNTgsIDU1LCAyMSwgMjIsIDI2LCAzOCwgMjIsXG4gICAgNTMsIDI1LCAyMywgMzgsIDcwLCA2MCwgNTEsIDM2LCA1NSwgMjYsIDM0LCAyMywgMjcsIDE0LCA5LCA3LFxuICAgIDM0LCAzMiwgMjgsIDM5LCA0OSwgNzUsIDMwLCA1MiwgNDgsIDQwLCA1MiwgMjgsIDE4LCAxNywgOSwgNSxcbiAgICA0NSwgMjEsIDM0LCA2NCwgNTYsIDUwLCA0OSwgNDUsIDMxLCAxOSwgMTIsIDE1LCAxMCwgNywgNiwgMyxcbiAgICA0OCwgMjMsIDIwLCAzOSwgMzYsIDM1LCA1MywgMjEsIDE2LCAyMywgMTMsIDEwLCA2LCAxLCA0LCAyLFxuICAgIDE2LCAxNSwgMTcsIDI3LCAyNSwgMjAsIDI5LCAxMSwgMTcsIDEyLCAxNiwgOCwgMSwgMSwgMCwgMVxuXTtcblxuVGFibGVzLnQxNUhCID0gW1xuICAgIDcsIDEyLCAxOCwgNTMsIDQ3LCA3NiwgMTI0LCAxMDgsIDg5LCAxMjMsIDEwOCwgMTE5LCAxMDcsIDgxLCAxMjIsIDYzLFxuICAgIDEzLCA1LCAxNiwgMjcsIDQ2LCAzNiwgNjEsIDUxLCA0MiwgNzAsIDUyLCA4MywgNjUsIDQxLCA1OSwgMzYsXG4gICAgMTksIDE3LCAxNSwgMjQsIDQxLCAzNCwgNTksIDQ4LCA0MCwgNjQsIDUwLCA3OCwgNjIsIDgwLCA1NiwgMzMsXG4gICAgMjksIDI4LCAyNSwgNDMsIDM5LCA2MywgNTUsIDkzLCA3NiwgNTksIDkzLCA3MiwgNTQsIDc1LCA1MCwgMjksXG4gICAgNTIsIDIyLCA0MiwgNDAsIDY3LCA1NywgOTUsIDc5LCA3MiwgNTcsIDg5LCA2OSwgNDksIDY2LCA0NiwgMjcsXG4gICAgNzcsIDM3LCAzNSwgNjYsIDU4LCA1MiwgOTEsIDc0LCA2MiwgNDgsIDc5LCA2MywgOTAsIDYyLCA0MCwgMzgsXG4gICAgMTI1LCAzMiwgNjAsIDU2LCA1MCwgOTIsIDc4LCA2NSwgNTUsIDg3LCA3MSwgNTEsIDczLCA1MSwgNzAsIDMwLFxuICAgIDEwOSwgNTMsIDQ5LCA5NCwgODgsIDc1LCA2NiwgMTIyLCA5MSwgNzMsIDU2LCA0MiwgNjQsIDQ0LCAyMSwgMjUsXG4gICAgOTAsIDQzLCA0MSwgNzcsIDczLCA2MywgNTYsIDkyLCA3NywgNjYsIDQ3LCA2NywgNDgsIDUzLCAzNiwgMjAsXG4gICAgNzEsIDM0LCA2NywgNjAsIDU4LCA0OSwgODgsIDc2LCA2NywgMTA2LCA3MSwgNTQsIDM4LCAzOSwgMjMsIDE1LFxuICAgIDEwOSwgNTMsIDUxLCA0NywgOTAsIDgyLCA1OCwgNTcsIDQ4LCA3MiwgNTcsIDQxLCAyMywgMjcsIDYyLCA5LFxuICAgIDg2LCA0MiwgNDAsIDM3LCA3MCwgNjQsIDUyLCA0MywgNzAsIDU1LCA0MiwgMjUsIDI5LCAxOCwgMTEsIDExLFxuICAgIDExOCwgNjgsIDMwLCA1NSwgNTAsIDQ2LCA3NCwgNjUsIDQ5LCAzOSwgMjQsIDE2LCAyMiwgMTMsIDE0LCA3LFxuICAgIDkxLCA0NCwgMzksIDM4LCAzNCwgNjMsIDUyLCA0NSwgMzEsIDUyLCAyOCwgMTksIDE0LCA4LCA5LCAzLFxuICAgIDEyMywgNjAsIDU4LCA1MywgNDcsIDQzLCAzMiwgMjIsIDM3LCAyNCwgMTcsIDEyLCAxNSwgMTAsIDIsIDEsXG4gICAgNzEsIDM3LCAzNCwgMzAsIDI4LCAyMCwgMTcsIDI2LCAyMSwgMTYsIDEwLCA2LCA4LCA2LCAyLCAwXG5dO1xuXG5UYWJsZXMudDE2SEIgPSBbXG4gICAgMSwgNSwgMTQsIDQ0LCA3NCwgNjMsIDExMCwgOTMsIDE3MiwgMTQ5LCAxMzgsIDI0MiwgMjI1LCAxOTUsIDM3NiwgMTcsXG4gICAgMywgNCwgMTIsIDIwLCAzNSwgNjIsIDUzLCA0NywgODMsIDc1LCA2OCwgMTE5LCAyMDEsIDEwNywgMjA3LCA5LFxuICAgIDE1LCAxMywgMjMsIDM4LCA2NywgNTgsIDEwMywgOTAsIDE2MSwgNzIsIDEyNywgMTE3LCAxMTAsIDIwOSwgMjA2LCAxNixcbiAgICA0NSwgMjEsIDM5LCA2OSwgNjQsIDExNCwgOTksIDg3LCAxNTgsIDE0MCwgMjUyLCAyMTIsIDE5OSwgMzg3LCAzNjUsIDI2LFxuICAgIDc1LCAzNiwgNjgsIDY1LCAxMTUsIDEwMSwgMTc5LCAxNjQsIDE1NSwgMjY0LCAyNDYsIDIyNiwgMzk1LCAzODIsIDM2MiwgOSxcbiAgICA2NiwgMzAsIDU5LCA1NiwgMTAyLCAxODUsIDE3MywgMjY1LCAxNDIsIDI1MywgMjMyLCA0MDAsIDM4OCwgMzc4LCA0NDUsIDE2LFxuICAgIDExMSwgNTQsIDUyLCAxMDAsIDE4NCwgMTc4LCAxNjAsIDEzMywgMjU3LCAyNDQsIDIyOCwgMjE3LCAzODUsIDM2NiwgNzE1LCAxMCxcbiAgICA5OCwgNDgsIDkxLCA4OCwgMTY1LCAxNTcsIDE0OCwgMjYxLCAyNDgsIDQwNywgMzk3LCAzNzIsIDM4MCwgODg5LCA4ODQsIDgsXG4gICAgODUsIDg0LCA4MSwgMTU5LCAxNTYsIDE0MywgMjYwLCAyNDksIDQyNywgNDAxLCAzOTIsIDM4MywgNzI3LCA3MTMsIDcwOCwgNyxcbiAgICAxNTQsIDc2LCA3MywgMTQxLCAxMzEsIDI1NiwgMjQ1LCA0MjYsIDQwNiwgMzk0LCAzODQsIDczNSwgMzU5LCA3MTAsIDM1MiwgMTEsXG4gICAgMTM5LCAxMjksIDY3LCAxMjUsIDI0NywgMjMzLCAyMjksIDIxOSwgMzkzLCA3NDMsIDczNywgNzIwLCA4ODUsIDg4MiwgNDM5LCA0LFxuICAgIDI0MywgMTIwLCAxMTgsIDExNSwgMjI3LCAyMjMsIDM5NiwgNzQ2LCA3NDIsIDczNiwgNzIxLCA3MTIsIDcwNiwgMjIzLCA0MzYsIDYsXG4gICAgMjAyLCAyMjQsIDIyMiwgMjE4LCAyMTYsIDM4OSwgMzg2LCAzODEsIDM2NCwgODg4LCA0NDMsIDcwNywgNDQwLCA0MzcsIDE3MjgsIDQsXG4gICAgNzQ3LCAyMTEsIDIxMCwgMjA4LCAzNzAsIDM3OSwgNzM0LCA3MjMsIDcxNCwgMTczNSwgODgzLCA4NzcsIDg3NiwgMzQ1OSwgODY1LCAyLFxuICAgIDM3NywgMzY5LCAxMDIsIDE4NywgNzI2LCA3MjIsIDM1OCwgNzExLCA3MDksIDg2NiwgMTczNCwgODcxLCAzNDU4LCA4NzAsIDQzNCwgMCxcbiAgICAxMiwgMTAsIDcsIDExLCAxMCwgMTcsIDExLCA5LCAxMywgMTIsIDEwLCA3LCA1LCAzLCAxLCAzXG5dO1xuXG5UYWJsZXMudDI0SEIgPSBbXG4gICAgMTUsIDEzLCA0NiwgODAsIDE0NiwgMjYyLCAyNDgsIDQzNCwgNDI2LCA2NjksIDY1MywgNjQ5LCA2MjEsIDUxNywgMTAzMiwgODgsXG4gICAgMTQsIDEyLCAyMSwgMzgsIDcxLCAxMzAsIDEyMiwgMjE2LCAyMDksIDE5OCwgMzI3LCAzNDUsIDMxOSwgMjk3LCAyNzksIDQyLFxuICAgIDQ3LCAyMiwgNDEsIDc0LCA2OCwgMTI4LCAxMjAsIDIyMSwgMjA3LCAxOTQsIDE4MiwgMzQwLCAzMTUsIDI5NSwgNTQxLCAxOCxcbiAgICA4MSwgMzksIDc1LCA3MCwgMTM0LCAxMjUsIDExNiwgMjIwLCAyMDQsIDE5MCwgMTc4LCAzMjUsIDMxMSwgMjkzLCAyNzEsIDE2LFxuICAgIDE0NywgNzIsIDY5LCAxMzUsIDEyNywgMTE4LCAxMTIsIDIxMCwgMjAwLCAxODgsIDM1MiwgMzIzLCAzMDYsIDI4NSwgNTQwLCAxNCxcbiAgICAyNjMsIDY2LCAxMjksIDEyNiwgMTE5LCAxMTQsIDIxNCwgMjAyLCAxOTIsIDE4MCwgMzQxLCAzMTcsIDMwMSwgMjgxLCAyNjIsIDEyLFxuICAgIDI0OSwgMTIzLCAxMjEsIDExNywgMTEzLCAyMTUsIDIwNiwgMTk1LCAxODUsIDM0NywgMzMwLCAzMDgsIDI5MSwgMjcyLCA1MjAsIDEwLFxuICAgIDQzNSwgMTE1LCAxMTEsIDEwOSwgMjExLCAyMDMsIDE5NiwgMTg3LCAzNTMsIDMzMiwgMzEzLCAyOTgsIDI4MywgNTMxLCAzODEsIDE3LFxuICAgIDQyNywgMjEyLCAyMDgsIDIwNSwgMjAxLCAxOTMsIDE4NiwgMTc3LCAxNjksIDMyMCwgMzAzLCAyODYsIDI2OCwgNTE0LCAzNzcsIDE2LFxuICAgIDMzNSwgMTk5LCAxOTcsIDE5MSwgMTg5LCAxODEsIDE3NCwgMzMzLCAzMjEsIDMwNSwgMjg5LCAyNzUsIDUyMSwgMzc5LCAzNzEsIDExLFxuICAgIDY2OCwgMTg0LCAxODMsIDE3OSwgMTc1LCAzNDQsIDMzMSwgMzE0LCAzMDQsIDI5MCwgMjc3LCA1MzAsIDM4MywgMzczLCAzNjYsIDEwLFxuICAgIDY1MiwgMzQ2LCAxNzEsIDE2OCwgMTY0LCAzMTgsIDMwOSwgMjk5LCAyODcsIDI3NiwgMjYzLCA1MTMsIDM3NSwgMzY4LCAzNjIsIDYsXG4gICAgNjQ4LCAzMjIsIDMxNiwgMzEyLCAzMDcsIDMwMiwgMjkyLCAyODQsIDI2OSwgMjYxLCA1MTIsIDM3NiwgMzcwLCAzNjQsIDM1OSwgNCxcbiAgICA2MjAsIDMwMCwgMjk2LCAyOTQsIDI4OCwgMjgyLCAyNzMsIDI2NiwgNTE1LCAzODAsIDM3NCwgMzY5LCAzNjUsIDM2MSwgMzU3LCAyLFxuICAgIDEwMzMsIDI4MCwgMjc4LCAyNzQsIDI2NywgMjY0LCAyNTksIDM4MiwgMzc4LCAzNzIsIDM2NywgMzYzLCAzNjAsIDM1OCwgMzU2LCAwLFxuICAgIDQzLCAyMCwgMTksIDE3LCAxNSwgMTMsIDExLCA5LCA3LCA2LCA0LCA3LCA1LCAzLCAxLCAzXG5dO1xuXG5UYWJsZXMudDMySEIgPSBbXG4gICAgMSA8PCAwLCA1IDw8IDEsIDQgPDwgMSwgNSA8PCAyLCA2IDw8IDEsIDUgPDwgMiwgNCA8PCAyLCA0IDw8IDMsXG4gICAgNyA8PCAxLCAzIDw8IDIsIDYgPDwgMiwgMCA8PCAzLCA3IDw8IDIsIDIgPDwgMywgMyA8PCAzLCAxIDw8IDRcbl07XG5cblRhYmxlcy50MzNIQiA9IFtcbiAgICAxNSA8PCAwLCAxNCA8PCAxLCAxMyA8PCAxLCAxMiA8PCAyLCAxMSA8PCAxLCAxMCA8PCAyLCA5IDw8IDIsIDggPDwgMyxcbiAgICA3IDw8IDEsIDYgPDwgMiwgNSA8PCAyLCA0IDw8IDMsIDMgPDwgMiwgMiA8PCAzLCAxIDw8IDMsIDAgPDwgNFxuXTtcblxuVGFibGVzLnQxbCA9IFtcbiAgICAxLCA0LFxuICAgIDMsIDVcbl07XG5cblRhYmxlcy50MmwgPSBbXG4gICAgMSwgNCwgNyxcbiAgICA0LCA1LCA3LFxuICAgIDYsIDcsIDhcbl07XG5cblRhYmxlcy50M2wgPSBbXG4gICAgMiwgMywgNyxcbiAgICA0LCA0LCA3LFxuICAgIDYsIDcsIDhcbl07XG5cblRhYmxlcy50NWwgPSBbXG4gICAgMSwgNCwgNywgOCxcbiAgICA0LCA1LCA4LCA5LFxuICAgIDcsIDgsIDksIDEwLFxuICAgIDgsIDgsIDksIDEwXG5dO1xuXG5UYWJsZXMudDZsID0gW1xuICAgIDMsIDQsIDYsIDgsXG4gICAgNCwgNCwgNiwgNyxcbiAgICA1LCA2LCA3LCA4LFxuICAgIDcsIDcsIDgsIDlcbl07XG5cblRhYmxlcy50N2wgPSBbXG4gICAgMSwgNCwgNywgOSwgOSwgMTAsXG4gICAgNCwgNiwgOCwgOSwgOSwgMTAsXG4gICAgNywgNywgOSwgMTAsIDEwLCAxMSxcbiAgICA4LCA5LCAxMCwgMTEsIDExLCAxMSxcbiAgICA4LCA5LCAxMCwgMTEsIDExLCAxMixcbiAgICA5LCAxMCwgMTEsIDEyLCAxMiwgMTJcbl07XG5cblRhYmxlcy50OGwgPSBbXG4gICAgMiwgNCwgNywgOSwgOSwgMTAsXG4gICAgNCwgNCwgNiwgMTAsIDEwLCAxMCxcbiAgICA3LCA2LCA4LCAxMCwgMTAsIDExLFxuICAgIDksIDEwLCAxMCwgMTEsIDExLCAxMixcbiAgICA5LCA5LCAxMCwgMTEsIDEyLCAxMixcbiAgICAxMCwgMTAsIDExLCAxMSwgMTMsIDEzXG5dO1xuXG5UYWJsZXMudDlsID0gW1xuICAgIDMsIDQsIDYsIDcsIDksIDEwLFxuICAgIDQsIDUsIDYsIDcsIDgsIDEwLFxuICAgIDUsIDYsIDcsIDgsIDksIDEwLFxuICAgIDcsIDcsIDgsIDksIDksIDEwLFxuICAgIDgsIDgsIDksIDksIDEwLCAxMSxcbiAgICA5LCA5LCAxMCwgMTAsIDExLCAxMVxuXTtcblxuVGFibGVzLnQxMGwgPSBbXG4gICAgMSwgNCwgNywgOSwgMTAsIDEwLCAxMCwgMTEsXG4gICAgNCwgNiwgOCwgOSwgMTAsIDExLCAxMCwgMTAsXG4gICAgNywgOCwgOSwgMTAsIDExLCAxMiwgMTEsIDExLFxuICAgIDgsIDksIDEwLCAxMSwgMTIsIDEyLCAxMSwgMTIsXG4gICAgOSwgMTAsIDExLCAxMiwgMTIsIDEyLCAxMiwgMTIsXG4gICAgMTAsIDExLCAxMiwgMTIsIDEzLCAxMywgMTIsIDEzLFxuICAgIDksIDEwLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDEzLFxuICAgIDEwLCAxMCwgMTEsIDEyLCAxMiwgMTMsIDEzLCAxM1xuXTtcblxuVGFibGVzLnQxMWwgPSBbXG4gICAgMiwgNCwgNiwgOCwgOSwgMTAsIDksIDEwLFxuICAgIDQsIDUsIDYsIDgsIDEwLCAxMCwgOSwgMTAsXG4gICAgNiwgNywgOCwgOSwgMTAsIDExLCAxMCwgMTAsXG4gICAgOCwgOCwgOSwgMTEsIDEwLCAxMiwgMTAsIDExLFxuICAgIDksIDEwLCAxMCwgMTEsIDExLCAxMiwgMTEsIDEyLFxuICAgIDksIDEwLCAxMSwgMTIsIDEyLCAxMywgMTIsIDEzLFxuICAgIDksIDksIDksIDEwLCAxMSwgMTIsIDEyLCAxMixcbiAgICA5LCA5LCAxMCwgMTEsIDEyLCAxMiwgMTIsIDEyXG5dO1xuXG5UYWJsZXMudDEybCA9IFtcbiAgICA0LCA0LCA2LCA4LCA5LCAxMCwgMTAsIDEwLFxuICAgIDQsIDUsIDYsIDcsIDksIDksIDEwLCAxMCxcbiAgICA2LCA2LCA3LCA4LCA5LCAxMCwgOSwgMTAsXG4gICAgNywgNywgOCwgOCwgOSwgMTAsIDEwLCAxMCxcbiAgICA4LCA4LCA5LCA5LCAxMCwgMTAsIDEwLCAxMSxcbiAgICA5LCA5LCAxMCwgMTAsIDEwLCAxMSwgMTAsIDExLFxuICAgIDksIDksIDksIDEwLCAxMCwgMTEsIDExLCAxMixcbiAgICAxMCwgMTAsIDEwLCAxMSwgMTEsIDExLCAxMSwgMTJcbl07XG5cblRhYmxlcy50MTNsID0gW1xuICAgIDEsIDUsIDcsIDgsIDksIDEwLCAxMCwgMTEsIDEwLCAxMSwgMTIsIDEyLCAxMywgMTMsIDE0LCAxNCxcbiAgICA0LCA2LCA4LCA5LCAxMCwgMTAsIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEzLCAxNCwgMTQsIDE0LFxuICAgIDcsIDgsIDksIDEwLCAxMSwgMTEsIDEyLCAxMiwgMTEsIDEyLCAxMiwgMTMsIDEzLCAxNCwgMTUsIDE1LFxuICAgIDgsIDksIDEwLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxMywgMTQsIDE1LCAxNSxcbiAgICA5LCA5LCAxMSwgMTEsIDEyLCAxMiwgMTMsIDEzLCAxMiwgMTMsIDEzLCAxNCwgMTQsIDE1LCAxNSwgMTYsXG4gICAgMTAsIDEwLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTMsIDE0LCAxMywgMTUsIDE1LCAxNiwgMTYsXG4gICAgMTAsIDExLCAxMiwgMTIsIDEzLCAxMywgMTMsIDEzLCAxMywgMTQsIDE0LCAxNCwgMTUsIDE1LCAxNiwgMTYsXG4gICAgMTEsIDExLCAxMiwgMTMsIDEzLCAxMywgMTQsIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTUsIDE2LCAxOCwgMTgsXG4gICAgMTAsIDEwLCAxMSwgMTIsIDEyLCAxMywgMTMsIDE0LCAxNCwgMTQsIDE0LCAxNSwgMTUsIDE2LCAxNywgMTcsXG4gICAgMTEsIDExLCAxMiwgMTIsIDEzLCAxMywgMTMsIDE1LCAxNCwgMTUsIDE1LCAxNiwgMTYsIDE2LCAxOCwgMTcsXG4gICAgMTEsIDEyLCAxMiwgMTMsIDEzLCAxNCwgMTQsIDE1LCAxNCwgMTUsIDE2LCAxNSwgMTYsIDE3LCAxOCwgMTksXG4gICAgMTIsIDEyLCAxMiwgMTMsIDE0LCAxNCwgMTQsIDE0LCAxNSwgMTUsIDE1LCAxNiwgMTcsIDE3LCAxNywgMTgsXG4gICAgMTIsIDEzLCAxMywgMTQsIDE0LCAxNSwgMTQsIDE1LCAxNiwgMTYsIDE3LCAxNywgMTcsIDE4LCAxOCwgMTgsXG4gICAgMTMsIDEzLCAxNCwgMTUsIDE1LCAxNSwgMTYsIDE2LCAxNiwgMTYsIDE2LCAxNywgMTgsIDE3LCAxOCwgMTgsXG4gICAgMTQsIDE0LCAxNCwgMTUsIDE1LCAxNSwgMTcsIDE2LCAxNiwgMTksIDE3LCAxNywgMTcsIDE5LCAxOCwgMTgsXG4gICAgMTMsIDE0LCAxNSwgMTYsIDE2LCAxNiwgMTcsIDE2LCAxNywgMTcsIDE4LCAxOCwgMjEsIDIwLCAyMSwgMThcbl07XG5cblRhYmxlcy50MTVsID0gW1xuICAgIDMsIDUsIDYsIDgsIDgsIDksIDEwLCAxMCwgMTAsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDE0LFxuICAgIDUsIDUsIDcsIDgsIDksIDksIDEwLCAxMCwgMTAsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDEzLFxuICAgIDYsIDcsIDcsIDgsIDksIDksIDEwLCAxMCwgMTAsIDExLCAxMSwgMTIsIDEyLCAxMywgMTMsIDEzLFxuICAgIDcsIDgsIDgsIDksIDksIDEwLCAxMCwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMyxcbiAgICA4LCA4LCA5LCA5LCAxMCwgMTAsIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLFxuICAgIDksIDksIDksIDEwLCAxMCwgMTAsIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEzLCAxMywgMTMsIDE0LFxuICAgIDEwLCA5LCAxMCwgMTAsIDEwLCAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxNCwgMTQsXG4gICAgMTAsIDEwLCAxMCwgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTQsXG4gICAgMTAsIDEwLCAxMCwgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEyLCAxMywgMTMsIDE0LCAxNCwgMTQsXG4gICAgMTAsIDEwLCAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTQsXG4gICAgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTMsIDE0LCAxNSwgMTQsXG4gICAgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxMywgMTQsIDE0LCAxNCwgMTUsXG4gICAgMTIsIDEyLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTMsIDEzLCAxMywgMTQsIDE0LCAxNSwgMTUsXG4gICAgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxMywgMTQsIDE0LCAxNCwgMTQsIDE0LCAxNSwgMTUsXG4gICAgMTMsIDEzLCAxMywgMTMsIDEzLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE0LCAxNCwgMTUsIDE1LCAxNCwgMTUsXG4gICAgMTMsIDEzLCAxMywgMTMsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTQsIDE0LCAxNCwgMTUsIDE1LCAxNSwgMTVcbl07XG5cblRhYmxlcy50MTZfNWwgPSBbXG4gICAgMSwgNSwgNywgOSwgMTAsIDEwLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDE0LCAxMSxcbiAgICA0LCA2LCA4LCA5LCAxMCwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDE0LCAxMywgMTQsIDExLFxuICAgIDcsIDgsIDksIDEwLCAxMSwgMTEsIDEyLCAxMiwgMTMsIDEyLCAxMywgMTMsIDEzLCAxNCwgMTQsIDEyLFxuICAgIDksIDksIDEwLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTQsIDE0LCAxNCwgMTUsIDE1LCAxMyxcbiAgICAxMCwgMTAsIDExLCAxMSwgMTIsIDEyLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE0LCAxNSwgMTUsIDE1LCAxMixcbiAgICAxMCwgMTAsIDExLCAxMSwgMTIsIDEzLCAxMywgMTQsIDEzLCAxNCwgMTQsIDE1LCAxNSwgMTUsIDE2LCAxMyxcbiAgICAxMSwgMTEsIDExLCAxMiwgMTMsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTQsIDE0LCAxNSwgMTUsIDE2LCAxMyxcbiAgICAxMSwgMTEsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTQsIDE0LCAxNSwgMTUsIDE1LCAxNSwgMTcsIDE3LCAxMyxcbiAgICAxMSwgMTIsIDEyLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE1LCAxNSwgMTUsIDE1LCAxNiwgMTYsIDE2LCAxMyxcbiAgICAxMiwgMTIsIDEyLCAxMywgMTMsIDE0LCAxNCwgMTUsIDE1LCAxNSwgMTUsIDE2LCAxNSwgMTYsIDE1LCAxNCxcbiAgICAxMiwgMTMsIDEyLCAxMywgMTQsIDE0LCAxNCwgMTQsIDE1LCAxNiwgMTYsIDE2LCAxNywgMTcsIDE2LCAxMyxcbiAgICAxMywgMTMsIDEzLCAxMywgMTQsIDE0LCAxNSwgMTYsIDE2LCAxNiwgMTYsIDE2LCAxNiwgMTUsIDE2LCAxNCxcbiAgICAxMywgMTQsIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTUsIDE1LCAxNywgMTYsIDE2LCAxNiwgMTYsIDE4LCAxNCxcbiAgICAxNSwgMTQsIDE0LCAxNCwgMTUsIDE1LCAxNiwgMTYsIDE2LCAxOCwgMTcsIDE3LCAxNywgMTksIDE3LCAxNCxcbiAgICAxNCwgMTUsIDEzLCAxNCwgMTYsIDE2LCAxNSwgMTYsIDE2LCAxNywgMTgsIDE3LCAxOSwgMTcsIDE2LCAxNCxcbiAgICAxMSwgMTEsIDExLCAxMiwgMTIsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTQsIDE0LCAxNCwgMTQsIDE0LCAxMlxuXTtcblxuVGFibGVzLnQxNmwgPSBbXG4gICAgMSwgNSwgNywgOSwgMTAsIDEwLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDE0LCAxMCxcbiAgICA0LCA2LCA4LCA5LCAxMCwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTMsIDE0LCAxMywgMTQsIDEwLFxuICAgIDcsIDgsIDksIDEwLCAxMSwgMTEsIDEyLCAxMiwgMTMsIDEyLCAxMywgMTMsIDEzLCAxNCwgMTQsIDExLFxuICAgIDksIDksIDEwLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTQsIDE0LCAxNCwgMTUsIDE1LCAxMixcbiAgICAxMCwgMTAsIDExLCAxMSwgMTIsIDEyLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE0LCAxNSwgMTUsIDE1LCAxMSxcbiAgICAxMCwgMTAsIDExLCAxMSwgMTIsIDEzLCAxMywgMTQsIDEzLCAxNCwgMTQsIDE1LCAxNSwgMTUsIDE2LCAxMixcbiAgICAxMSwgMTEsIDExLCAxMiwgMTMsIDEzLCAxMywgMTMsIDE0LCAxNCwgMTQsIDE0LCAxNSwgMTUsIDE2LCAxMixcbiAgICAxMSwgMTEsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTQsIDE0LCAxNSwgMTUsIDE1LCAxNSwgMTcsIDE3LCAxMixcbiAgICAxMSwgMTIsIDEyLCAxMywgMTMsIDEzLCAxNCwgMTQsIDE1LCAxNSwgMTUsIDE1LCAxNiwgMTYsIDE2LCAxMixcbiAgICAxMiwgMTIsIDEyLCAxMywgMTMsIDE0LCAxNCwgMTUsIDE1LCAxNSwgMTUsIDE2LCAxNSwgMTYsIDE1LCAxMyxcbiAgICAxMiwgMTMsIDEyLCAxMywgMTQsIDE0LCAxNCwgMTQsIDE1LCAxNiwgMTYsIDE2LCAxNywgMTcsIDE2LCAxMixcbiAgICAxMywgMTMsIDEzLCAxMywgMTQsIDE0LCAxNSwgMTYsIDE2LCAxNiwgMTYsIDE2LCAxNiwgMTUsIDE2LCAxMyxcbiAgICAxMywgMTQsIDE0LCAxNCwgMTQsIDE1LCAxNSwgMTUsIDE1LCAxNywgMTYsIDE2LCAxNiwgMTYsIDE4LCAxMyxcbiAgICAxNSwgMTQsIDE0LCAxNCwgMTUsIDE1LCAxNiwgMTYsIDE2LCAxOCwgMTcsIDE3LCAxNywgMTksIDE3LCAxMyxcbiAgICAxNCwgMTUsIDEzLCAxNCwgMTYsIDE2LCAxNSwgMTYsIDE2LCAxNywgMTgsIDE3LCAxOSwgMTcsIDE2LCAxMyxcbiAgICAxMCwgMTAsIDEwLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDEzLCAxMywgMTMsIDEzLCAxMFxuXTtcblxuVGFibGVzLnQyNGwgPSBbXG4gICAgNCwgNSwgNywgOCwgOSwgMTAsIDEwLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDEwLFxuICAgIDUsIDYsIDcsIDgsIDksIDEwLCAxMCwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMCxcbiAgICA3LCA3LCA4LCA5LCA5LCAxMCwgMTAsIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMywgOSxcbiAgICA4LCA4LCA5LCA5LCAxMCwgMTAsIDEwLCAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDksXG4gICAgOSwgOSwgOSwgMTAsIDEwLCAxMCwgMTAsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEyLCAxMywgOSxcbiAgICAxMCwgOSwgMTAsIDEwLCAxMCwgMTAsIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDksXG4gICAgMTAsIDEwLCAxMCwgMTAsIDEwLCAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMywgOSxcbiAgICAxMSwgMTAsIDEwLCAxMCwgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMCxcbiAgICAxMSwgMTEsIDExLCAxMSwgMTEsIDExLCAxMSwgMTEsIDExLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMCxcbiAgICAxMSwgMTEsIDExLCAxMSwgMTEsIDExLCAxMSwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMywgMTMsIDEzLCAxMCxcbiAgICAxMiwgMTEsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDEzLCAxMCxcbiAgICAxMiwgMTIsIDExLCAxMSwgMTEsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDEzLCAxMCxcbiAgICAxMiwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTMsIDEzLCAxMCxcbiAgICAxMiwgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTIsIDEzLCAxMywgMTMsIDEzLCAxMywgMTMsIDEzLCAxMCxcbiAgICAxMywgMTIsIDEyLCAxMiwgMTIsIDEyLCAxMiwgMTMsIDEzLCAxMywgMTMsIDEzLCAxMywgMTMsIDEzLCAxMCxcbiAgICA5LCA5LCA5LCA5LCA5LCA5LCA5LCA5LCA5LCA5LCA5LCAxMCwgMTAsIDEwLCAxMCwgNlxuXTtcblxuVGFibGVzLnQzMmwgPSBbXG4gICAgMSArIDAsIDQgKyAxLCA0ICsgMSwgNSArIDIsIDQgKyAxLCA2ICsgMiwgNSArIDIsIDYgKyAzLFxuICAgIDQgKyAxLCA1ICsgMiwgNSArIDIsIDYgKyAzLCA1ICsgMiwgNiArIDMsIDYgKyAzLCA2ICsgNFxuXTtcblxuVGFibGVzLnQzM2wgPSBbXG4gICAgNCArIDAsIDQgKyAxLCA0ICsgMSwgNCArIDIsIDQgKyAxLCA0ICsgMiwgNCArIDIsIDQgKyAzLFxuICAgIDQgKyAxLCA0ICsgMiwgNCArIDIsIDQgKyAzLCA0ICsgMiwgNCArIDMsIDQgKyAzLCA0ICsgNFxuXTtcblxuVGFibGVzLmh0ID0gW1xuICAgIC8qIHhsZW4sIGxpbm1heCwgdGFibGUsIGhsZW4gKi9cbiAgICBuZXcgSHVmZkNvZGVUYWIoMCwgMCwgbnVsbCwgbnVsbCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDIsIDAsIFRhYmxlcy50MUhCLCBUYWJsZXMudDFsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoMywgMCwgVGFibGVzLnQySEIsIFRhYmxlcy50MmwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYigzLCAwLCBUYWJsZXMudDNIQiwgVGFibGVzLnQzbCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDAsIDAsIG51bGwsIG51bGwpLCAvKiBBcHBhcmVudGx5IG5vdCB1c2VkICovXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDQsIDAsIFRhYmxlcy50NUhCLCBUYWJsZXMudDVsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoNCwgMCwgVGFibGVzLnQ2SEIsIFRhYmxlcy50NmwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYig2LCAwLCBUYWJsZXMudDdIQiwgVGFibGVzLnQ3bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDYsIDAsIFRhYmxlcy50OEhCLCBUYWJsZXMudDhsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoNiwgMCwgVGFibGVzLnQ5SEIsIFRhYmxlcy50OWwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYig4LCAwLCBUYWJsZXMudDEwSEIsIFRhYmxlcy50MTBsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoOCwgMCwgVGFibGVzLnQxMUhCLCBUYWJsZXMudDExbCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDgsIDAsIFRhYmxlcy50MTJIQiwgVGFibGVzLnQxMmwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYigxNiwgMCwgVGFibGVzLnQxM0hCLCBUYWJsZXMudDEzbCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDAsIDAsIG51bGwsIFRhYmxlcy50MTZfNWwpLCAvKiBBcHBhcmVudGx5IG5vdCB1c2VkICovXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDE2LCAwLCBUYWJsZXMudDE1SEIsIFRhYmxlcy50MTVsKSxcblxuICAgIG5ldyBIdWZmQ29kZVRhYigxLCAxLCBUYWJsZXMudDE2SEIsIFRhYmxlcy50MTZsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoMiwgMywgVGFibGVzLnQxNkhCLCBUYWJsZXMudDE2bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDMsIDcsIFRhYmxlcy50MTZIQiwgVGFibGVzLnQxNmwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYig0LCAxNSwgVGFibGVzLnQxNkhCLCBUYWJsZXMudDE2bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDYsIDYzLCBUYWJsZXMudDE2SEIsIFRhYmxlcy50MTZsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoOCwgMjU1LCBUYWJsZXMudDE2SEIsIFRhYmxlcy50MTZsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoMTAsIDEwMjMsIFRhYmxlcy50MTZIQiwgVGFibGVzLnQxNmwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYigxMywgODE5MSwgVGFibGVzLnQxNkhCLCBUYWJsZXMudDE2bCksXG5cbiAgICBuZXcgSHVmZkNvZGVUYWIoNCwgMTUsIFRhYmxlcy50MjRIQiwgVGFibGVzLnQyNGwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYig1LCAzMSwgVGFibGVzLnQyNEhCLCBUYWJsZXMudDI0bCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDYsIDYzLCBUYWJsZXMudDI0SEIsIFRhYmxlcy50MjRsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoNywgMTI3LCBUYWJsZXMudDI0SEIsIFRhYmxlcy50MjRsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoOCwgMjU1LCBUYWJsZXMudDI0SEIsIFRhYmxlcy50MjRsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoOSwgNTExLCBUYWJsZXMudDI0SEIsIFRhYmxlcy50MjRsKSxcbiAgICBuZXcgSHVmZkNvZGVUYWIoMTEsIDIwNDcsIFRhYmxlcy50MjRIQiwgVGFibGVzLnQyNGwpLFxuICAgIG5ldyBIdWZmQ29kZVRhYigxMywgODE5MSwgVGFibGVzLnQyNEhCLCBUYWJsZXMudDI0bCksXG5cbiAgICBuZXcgSHVmZkNvZGVUYWIoMCwgMCwgVGFibGVzLnQzMkhCLCBUYWJsZXMudDMybCksXG4gICAgbmV3IEh1ZmZDb2RlVGFiKDAsIDAsIFRhYmxlcy50MzNIQiwgVGFibGVzLnQzM2wpLFxuXTtcblxuLyoqXG4gKiA8Q09ERT5cbiAqICBmb3IgKGkgPSAwOyBpIDwgMTYqMTY7IGkrKykgW1xuICogICAgICBsYXJnZXRibFtpXSA9ICgoaHRbMTZdLmhsZW5baV0pIDw8IDE2KSArIGh0WzI0XS5obGVuW2ldO1xuICogIF1cbiAqIDwvQ09ERT5cbiAqXG4gKi9cblRhYmxlcy5sYXJnZXRibCA9IFtcbiAgICAweDAxMDAwNCwgMHgwNTAwMDUsIDB4MDcwMDA3LCAweDA5MDAwOCwgMHgwYTAwMDksIDB4MGEwMDBhLCAweDBiMDAwYSwgMHgwYjAwMGIsXG4gICAgMHgwYzAwMGIsIDB4MGMwMDBjLCAweDBjMDAwYywgMHgwZDAwMGMsIDB4MGQwMDBjLCAweDBkMDAwYywgMHgwZTAwMGQsIDB4MGEwMDBhLFxuICAgIDB4MDQwMDA1LCAweDA2MDAwNiwgMHgwODAwMDcsIDB4MDkwMDA4LCAweDBhMDAwOSwgMHgwYjAwMGEsIDB4MGIwMDBhLCAweDBiMDAwYixcbiAgICAweDBjMDAwYiwgMHgwYzAwMGIsIDB4MGMwMDBjLCAweDBkMDAwYywgMHgwZTAwMGMsIDB4MGQwMDBjLCAweDBlMDAwYywgMHgwYTAwMGEsXG4gICAgMHgwNzAwMDcsIDB4MDgwMDA3LCAweDA5MDAwOCwgMHgwYTAwMDksIDB4MGIwMDA5LCAweDBiMDAwYSwgMHgwYzAwMGEsIDB4MGMwMDBiLFxuICAgIDB4MGQwMDBiLCAweDBjMDAwYiwgMHgwZDAwMGIsIDB4MGQwMDBjLCAweDBkMDAwYywgMHgwZTAwMGMsIDB4MGUwMDBkLCAweDBiMDAwOSxcbiAgICAweDA5MDAwOCwgMHgwOTAwMDgsIDB4MGEwMDA5LCAweDBiMDAwOSwgMHgwYjAwMGEsIDB4MGMwMDBhLCAweDBjMDAwYSwgMHgwYzAwMGIsXG4gICAgMHgwZDAwMGIsIDB4MGQwMDBiLCAweDBlMDAwYiwgMHgwZTAwMGMsIDB4MGUwMDBjLCAweDBmMDAwYywgMHgwZjAwMGMsIDB4MGMwMDA5LFxuICAgIDB4MGEwMDA5LCAweDBhMDAwOSwgMHgwYjAwMDksIDB4MGIwMDBhLCAweDBjMDAwYSwgMHgwYzAwMGEsIDB4MGQwMDBhLCAweDBkMDAwYixcbiAgICAweDBkMDAwYiwgMHgwZTAwMGIsIDB4MGUwMDBjLCAweDBlMDAwYywgMHgwZjAwMGMsIDB4MGYwMDBjLCAweDBmMDAwZCwgMHgwYjAwMDksXG4gICAgMHgwYTAwMGEsIDB4MGEwMDA5LCAweDBiMDAwYSwgMHgwYjAwMGEsIDB4MGMwMDBhLCAweDBkMDAwYSwgMHgwZDAwMGIsIDB4MGUwMDBiLFxuICAgIDB4MGQwMDBiLCAweDBlMDAwYiwgMHgwZTAwMGMsIDB4MGYwMDBjLCAweDBmMDAwYywgMHgwZjAwMGMsIDB4MTAwMDBjLCAweDBjMDAwOSxcbiAgICAweDBiMDAwYSwgMHgwYjAwMGEsIDB4MGIwMDBhLCAweDBjMDAwYSwgMHgwZDAwMGEsIDB4MGQwMDBiLCAweDBkMDAwYiwgMHgwZDAwMGIsXG4gICAgMHgwZTAwMGIsIDB4MGUwMDBjLCAweDBlMDAwYywgMHgwZTAwMGMsIDB4MGYwMDBjLCAweDBmMDAwYywgMHgxMDAwMGQsIDB4MGMwMDA5LFxuICAgIDB4MGIwMDBiLCAweDBiMDAwYSwgMHgwYzAwMGEsIDB4MGMwMDBhLCAweDBkMDAwYiwgMHgwZDAwMGIsIDB4MGQwMDBiLCAweDBlMDAwYixcbiAgICAweDBlMDAwYywgMHgwZjAwMGMsIDB4MGYwMDBjLCAweDBmMDAwYywgMHgwZjAwMGMsIDB4MTEwMDBkLCAweDExMDAwZCwgMHgwYzAwMGEsXG4gICAgMHgwYjAwMGIsIDB4MGMwMDBiLCAweDBjMDAwYiwgMHgwZDAwMGIsIDB4MGQwMDBiLCAweDBkMDAwYiwgMHgwZTAwMGIsIDB4MGUwMDBiLFxuICAgIDB4MGYwMDBiLCAweDBmMDAwYywgMHgwZjAwMGMsIDB4MGYwMDBjLCAweDEwMDAwYywgMHgxMDAwMGQsIDB4MTAwMDBkLCAweDBjMDAwYSxcbiAgICAweDBjMDAwYiwgMHgwYzAwMGIsIDB4MGMwMDBiLCAweDBkMDAwYiwgMHgwZDAwMGIsIDB4MGUwMDBiLCAweDBlMDAwYiwgMHgwZjAwMGMsXG4gICAgMHgwZjAwMGMsIDB4MGYwMDBjLCAweDBmMDAwYywgMHgxMDAwMGMsIDB4MGYwMDBkLCAweDEwMDAwZCwgMHgwZjAwMGQsIDB4MGQwMDBhLFxuICAgIDB4MGMwMDBjLCAweDBkMDAwYiwgMHgwYzAwMGIsIDB4MGQwMDBiLCAweDBlMDAwYiwgMHgwZTAwMGMsIDB4MGUwMDBjLCAweDBlMDAwYyxcbiAgICAweDBmMDAwYywgMHgxMDAwMGMsIDB4MTAwMDBjLCAweDEwMDAwZCwgMHgxMTAwMGQsIDB4MTEwMDBkLCAweDEwMDAwZCwgMHgwYzAwMGEsXG4gICAgMHgwZDAwMGMsIDB4MGQwMDBjLCAweDBkMDAwYiwgMHgwZDAwMGIsIDB4MGUwMDBiLCAweDBlMDAwYywgMHgwZjAwMGMsIDB4MTAwMDBjLFxuICAgIDB4MTAwMDBjLCAweDEwMDAwYywgMHgxMDAwMGMsIDB4MTAwMDBkLCAweDEwMDAwZCwgMHgwZjAwMGQsIDB4MTAwMDBkLCAweDBkMDAwYSxcbiAgICAweDBkMDAwYywgMHgwZTAwMGMsIDB4MGUwMDBjLCAweDBlMDAwYywgMHgwZTAwMGMsIDB4MGYwMDBjLCAweDBmMDAwYywgMHgwZjAwMGMsXG4gICAgMHgwZjAwMGMsIDB4MTEwMDBjLCAweDEwMDAwZCwgMHgxMDAwMGQsIDB4MTAwMDBkLCAweDEwMDAwZCwgMHgxMjAwMGQsIDB4MGQwMDBhLFxuICAgIDB4MGYwMDBjLCAweDBlMDAwYywgMHgwZTAwMGMsIDB4MGUwMDBjLCAweDBmMDAwYywgMHgwZjAwMGMsIDB4MTAwMDBjLCAweDEwMDAwYyxcbiAgICAweDEwMDAwZCwgMHgxMjAwMGQsIDB4MTEwMDBkLCAweDExMDAwZCwgMHgxMTAwMGQsIDB4MTMwMDBkLCAweDExMDAwZCwgMHgwZDAwMGEsXG4gICAgMHgwZTAwMGQsIDB4MGYwMDBjLCAweDBkMDAwYywgMHgwZTAwMGMsIDB4MTAwMDBjLCAweDEwMDAwYywgMHgwZjAwMGMsIDB4MTAwMDBkLFxuICAgIDB4MTAwMDBkLCAweDExMDAwZCwgMHgxMjAwMGQsIDB4MTEwMDBkLCAweDEzMDAwZCwgMHgxMTAwMGQsIDB4MTAwMDBkLCAweDBkMDAwYSxcbiAgICAweDBhMDAwOSwgMHgwYTAwMDksIDB4MGEwMDA5LCAweDBiMDAwOSwgMHgwYjAwMDksIDB4MGMwMDA5LCAweDBjMDAwOSwgMHgwYzAwMDksXG4gICAgMHgwZDAwMDksIDB4MGQwMDA5LCAweDBkMDAwOSwgMHgwZDAwMGEsIDB4MGQwMDBhLCAweDBkMDAwYSwgMHgwZDAwMGEsIDB4MGEwMDA2XG5dO1xuLyoqXG4gKiA8Q09ERT5cbiAqICBmb3IgKGkgPSAwOyBpIDwgMyozOyBpKyspIFtcbiAqICAgICAgdGFibGUyM1tpXSA9ICgoaHRbMl0uaGxlbltpXSkgPDwgMTYpICsgaHRbM10uaGxlbltpXTtcbiAqICBdXG4gKiA8L0NPREU+XG4gKlxuICovXG5UYWJsZXMudGFibGUyMyA9IFtcbiAgICAweDAxMDAwMiwgMHgwNDAwMDMsIDB4MDcwMDA3LFxuICAgIDB4MDQwMDA0LCAweDA1MDAwNCwgMHgwNzAwMDcsXG4gICAgMHgwNjAwMDYsIDB4MDcwMDA3LCAweDA4MDAwOFxuXTtcblxuLyoqXG4gKiA8Q09ERT5cbiAqICBmb3IgKGkgPSAwOyBpIDwgNCo0OyBpKyspIFtcbiAqICAgICAgIHRhYmxlNTZbaV0gPSAoKGh0WzVdLmhsZW5baV0pIDw8IDE2KSArIGh0WzZdLmhsZW5baV07XG4gKiAgIF1cbiAqIDwvQ09ERT5cbiAqXG4gKi9cblRhYmxlcy50YWJsZTU2ID0gW1xuICAgIDB4MDEwMDAzLCAweDA0MDAwNCwgMHgwNzAwMDYsIDB4MDgwMDA4LCAweDA0MDAwNCwgMHgwNTAwMDQsIDB4MDgwMDA2LCAweDA5MDAwNyxcbiAgICAweDA3MDAwNSwgMHgwODAwMDYsIDB4MDkwMDA3LCAweDBhMDAwOCwgMHgwODAwMDcsIDB4MDgwMDA3LCAweDA5MDAwOCwgMHgwYTAwMDlcbl07XG5cblRhYmxlcy5iaXRyYXRlX3RhYmxlID0gW1xuICAgIFswLCA4LCAxNiwgMjQsIDMyLCA0MCwgNDgsIDU2LCA2NCwgODAsIDk2LCAxMTIsIDEyOCwgMTQ0LCAxNjAsIC0xXSwgLyogTVBFRyAyICovXG4gICAgWzAsIDMyLCA0MCwgNDgsIDU2LCA2NCwgODAsIDk2LCAxMTIsIDEyOCwgMTYwLCAxOTIsIDIyNCwgMjU2LCAzMjAsIC0xXSwgLyogTVBFRyAxICovXG4gICAgWzAsIDgsIDE2LCAyNCwgMzIsIDQwLCA0OCwgNTYsIDY0LCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMV0sIC8qIE1QRUcgMi41ICovXG5dO1xuXG4vKipcbiAqIE1QRUcgMiwgTVBFRyAxLCBNUEVHIDIuNS5cbiAqL1xuVGFibGVzLnNhbXBsZXJhdGVfdGFibGUgPSBbXG4gICAgWzIyMDUwLCAyNDAwMCwgMTYwMDAsIC0xXSxcbiAgICBbNDQxMDAsIDQ4MDAwLCAzMjAwMCwgLTFdLFxuICAgIFsxMTAyNSwgMTIwMDAsIDgwMDAsIC0xXSxcbl07XG5cbi8qKlxuICogVGhpcyBpcyB0aGUgc2Nmc2lfYmFuZCB0YWJsZSBmcm9tIDIuNC4yLjcgb2YgdGhlIElTLlxuICovXG5UYWJsZXMuc2Nmc2lfYmFuZCA9IFswLCA2LCAxMSwgMTYsIDIxXTtcblxuZnVuY3Rpb24gTWVhbkJpdHMobWVhbkJpdHMpIHtcbiAgICB0aGlzLmJpdHMgPSBtZWFuQml0cztcbn1cblxuLy9wYWNrYWdlIG1wMztcblxuZnVuY3Rpb24gQ2FsY05vaXNlUmVzdWx0KCkge1xuICAgIC8qKlxuICAgICAqIHN1bSBvZiBxdWFudGl6YXRpb24gbm9pc2UgPiBtYXNraW5nXG4gICAgICovXG4gICAgdGhpcy5vdmVyX25vaXNlID0gMC47XG4gICAgLyoqXG4gICAgICogc3VtIG9mIGFsbCBxdWFudGl6YXRpb24gbm9pc2VcbiAgICAgKi9cbiAgICB0aGlzLnRvdF9ub2lzZSA9IDAuO1xuICAgIC8qKlxuICAgICAqIG1heCBxdWFudGl6YXRpb24gbm9pc2VcbiAgICAgKi9cbiAgICB0aGlzLm1heF9ub2lzZSA9IDAuO1xuICAgIC8qKlxuICAgICAqIG51bWJlciBvZiBxdWFudGl6YXRpb24gbm9pc2UgPiBtYXNraW5nXG4gICAgICovXG4gICAgdGhpcy5vdmVyX2NvdW50ID0gMDtcbiAgICAvKipcbiAgICAgKiBTU0QtbGlrZSBjb3N0IG9mIGRpc3RvcnRlZCBiYW5kc1xuICAgICAqL1xuICAgIHRoaXMub3Zlcl9TU0QgPSAwO1xuICAgIHRoaXMuYml0cyA9IDA7XG59XG5cbmZ1bmN0aW9uIFZCUlF1YW50aXplKCkge1xuICAgIHZhciBxdXB2dDtcbiAgICB2YXIgdGFrO1xuXG4gICAgdGhpcy5zZXRNb2R1bGVzID0gZnVuY3Rpb24gKF9xdXB2dCwgX3RrKSB7XG4gICAgICAgIHF1cHZ0ID0gX3F1cHZ0O1xuICAgICAgICB0YWsgPSBfdGs7XG4gICAgfVxuICAgIC8vVE9ET1xuXG59XG5cblxuXG4vKipcbiAqIEFUSCByZWxhdGVkIHN0dWZmLCBpZiBzb21ldGhpbmcgbmV3IEFUSCByZWxhdGVkIGhhcyB0byBiZSBhZGRlZCwgcGxlYXNlIHBsdWdcbiAqIGl0IGhlcmUgaW50byB0aGUgQVRILlxuICovXG5mdW5jdGlvbiBBVEgoKSB7XG4gICAgLyoqXG4gICAgICogTWV0aG9kIGZvciB0aGUgYXV0byBhZGp1c3RtZW50LlxuICAgICAqL1xuICAgIHRoaXMudXNlQWRqdXN0ID0gMDtcbiAgICAvKipcbiAgICAgKiBmYWN0b3IgZm9yIHR1bmluZyB0aGUgKHNhbXBsZSBwb3dlcikgcG9pbnQgYmVsb3cgd2hpY2ggYWRhcHRpdmUgdGhyZXNob2xkXG4gICAgICogb2YgaGVhcmluZyBhZGp1c3RtZW50IG9jY3Vyc1xuICAgICAqL1xuICAgIHRoaXMuYWFTZW5zaXRpdml0eVAgPSAwLjtcbiAgICAvKipcbiAgICAgKiBMb3dlcmluZyBiYXNlZCBvbiBwZWFrIHZvbHVtZSwgMSA9IG5vIGxvd2VyaW5nLlxuICAgICAqL1xuICAgIHRoaXMuYWRqdXN0ID0gMC47XG4gICAgLyoqXG4gICAgICogTGltaXQgZm9yIGR5bmFtaWMgQVRIIGFkanVzdC5cbiAgICAgKi9cbiAgICB0aGlzLmFkanVzdExpbWl0ID0gMC47XG4gICAgLyoqXG4gICAgICogRGV0ZXJtaW5lZCB0byBsb3dlciB4IGRCIGVhY2ggc2Vjb25kLlxuICAgICAqL1xuICAgIHRoaXMuZGVjYXkgPSAwLjtcbiAgICAvKipcbiAgICAgKiBMb3dlc3QgQVRIIHZhbHVlLlxuICAgICAqL1xuICAgIHRoaXMuZmxvb3IgPSAwLjtcbiAgICAvKipcbiAgICAgKiBBVEggZm9yIHNmYnMgaW4gbG9uZyBibG9ja3MuXG4gICAgICovXG4gICAgdGhpcy5sID0gbmV3X2Zsb2F0KEVuY29kZXIuU0JNQVhfbCk7XG4gICAgLyoqXG4gICAgICogQVRIIGZvciBzZmJzIGluIHNob3J0IGJsb2Nrcy5cbiAgICAgKi9cbiAgICB0aGlzLnMgPSBuZXdfZmxvYXQoRW5jb2Rlci5TQk1BWF9zKTtcbiAgICAvKipcbiAgICAgKiBBVEggZm9yIHBhcnRpdGlvbmVkIHNmYjIxIGluIGxvbmcgYmxvY2tzLlxuICAgICAqL1xuICAgIHRoaXMucHNmYjIxID0gbmV3X2Zsb2F0KEVuY29kZXIuUFNGQjIxKTtcbiAgICAvKipcbiAgICAgKiBBVEggZm9yIHBhcnRpdGlvbmVkIHNmYjEyIGluIHNob3J0IGJsb2Nrcy5cbiAgICAgKi9cbiAgICB0aGlzLnBzZmIxMiA9IG5ld19mbG9hdChFbmNvZGVyLlBTRkIxMik7XG4gICAgLyoqXG4gICAgICogQVRIIGZvciBsb25nIGJsb2NrIGNvbnZvbHV0aW9uIGJhbmRzLlxuICAgICAqL1xuICAgIHRoaXMuY2JfbCA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyk7XG4gICAgLyoqXG4gICAgICogQVRIIGZvciBzaG9ydCBibG9jayBjb252b2x1dGlvbiBiYW5kcy5cbiAgICAgKi9cbiAgICB0aGlzLmNiX3MgPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMpO1xuICAgIC8qKlxuICAgICAqIEVxdWFsIGxvdWRuZXNzIHdlaWdodHMgKGJhc2VkIG9uIEFUSCkuXG4gICAgICovXG4gICAgdGhpcy5lcWxfdyA9IG5ld19mbG9hdChFbmNvZGVyLkJMS1NJWkUgLyAyKTtcbn1cblxuXG5mdW5jdGlvbiBMYW1lR2xvYmFsRmxhZ3MoKSB7XG5cbiAgICB0aGlzLmNsYXNzX2lkID0gMDtcblxuICAgIC8qIGlucHV0IGRlc2NyaXB0aW9uICovXG5cbiAgICAvKipcbiAgICAgKiBudW1iZXIgb2Ygc2FtcGxlcy4gZGVmYXVsdD0tMVxuICAgICAqL1xuICAgIHRoaXMubnVtX3NhbXBsZXMgPSAwO1xuICAgIC8qKlxuICAgICAqIGlucHV0IG51bWJlciBvZiBjaGFubmVscy4gZGVmYXVsdD0yXG4gICAgICovXG4gICAgdGhpcy5udW1fY2hhbm5lbHMgPSAwO1xuICAgIC8qKlxuICAgICAqIGlucHV0X3NhbXBfcmF0ZSBpbiBIei4gZGVmYXVsdD00NC4xIGtIelxuICAgICAqL1xuICAgIHRoaXMuaW5fc2FtcGxlcmF0ZSA9IDA7XG4gICAgLyoqXG4gICAgICogb3V0cHV0X3NhbXBfcmF0ZS4gZGVmYXVsdDogTEFNRSBwaWNrcyBiZXN0IHZhbHVlIGF0IGxlYXN0IG5vdCB1c2VkIGZvclxuICAgICAqIE1QMyBkZWNvZGluZzogUmVtZW1iZXIgNDQuMSBrSHogTVAzcyBhbmQgQUM5N1xuICAgICAqL1xuICAgIHRoaXMub3V0X3NhbXBsZXJhdGUgPSAwO1xuICAgIC8qKlxuICAgICAqIHNjYWxlIGlucHV0IGJ5IHRoaXMgYW1vdW50IGJlZm9yZSBlbmNvZGluZyBhdCBsZWFzdCBub3QgdXNlZCBmb3IgTVAzXG4gICAgICogZGVjb2RpbmdcbiAgICAgKi9cbiAgICB0aGlzLnNjYWxlID0gMC47XG4gICAgLyoqXG4gICAgICogc2NhbGUgaW5wdXQgb2YgY2hhbm5lbCAwIChsZWZ0KSBieSB0aGlzIGFtb3VudCBiZWZvcmUgZW5jb2RpbmdcbiAgICAgKi9cbiAgICB0aGlzLnNjYWxlX2xlZnQgPSAwLjtcbiAgICAvKipcbiAgICAgKiBzY2FsZSBpbnB1dCBvZiBjaGFubmVsIDEgKHJpZ2h0KSBieSB0aGlzIGFtb3VudCBiZWZvcmUgZW5jb2RpbmdcbiAgICAgKi9cbiAgICB0aGlzLnNjYWxlX3JpZ2h0ID0gMC47XG5cbiAgICAvKiBnZW5lcmFsIGNvbnRyb2wgcGFyYW1zICovXG4gICAgLyoqXG4gICAgICogY29sbGVjdCBkYXRhIGZvciBhIE1QMyBmcmFtZSBhbmFseXplcj9cbiAgICAgKi9cbiAgICB0aGlzLmFuYWx5c2lzID0gZmFsc2U7XG4gICAgLyoqXG4gICAgICogYWRkIFhpbmcgVkJSIHRhZz9cbiAgICAgKi9cbiAgICB0aGlzLmJXcml0ZVZiclRhZyA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogdXNlIGxhbWUvbXBnbGliIHRvIGNvbnZlcnQgbXAzIHRvIHdhdlxuICAgICAqL1xuICAgIHRoaXMuZGVjb2RlX29ubHkgPSBmYWxzZTtcbiAgICAvKipcbiAgICAgKiBxdWFsaXR5IHNldHRpbmcgMD1iZXN0LCA5PXdvcnN0IGRlZmF1bHQ9NVxuICAgICAqL1xuICAgIHRoaXMucXVhbGl0eSA9IDA7XG4gICAgLyoqXG4gICAgICogc2VlIGVudW0gZGVmYXVsdCA9IExBTUUgcGlja3MgYmVzdCB2YWx1ZVxuICAgICAqL1xuICAgIHRoaXMubW9kZSA9IE1QRUdNb2RlLlNURVJFTztcbiAgICAvKipcbiAgICAgKiBmb3JjZSBNL1MgbW9kZS4gcmVxdWlyZXMgbW9kZT0xXG4gICAgICovXG4gICAgdGhpcy5mb3JjZV9tcyA9IGZhbHNlO1xuICAgIC8qKlxuICAgICAqIHVzZSBmcmVlIGZvcm1hdD8gZGVmYXVsdD0wXG4gICAgICovXG4gICAgdGhpcy5mcmVlX2Zvcm1hdCA9IGZhbHNlO1xuICAgIC8qKlxuICAgICAqIGZpbmQgdGhlIFJHIHZhbHVlPyBkZWZhdWx0PTBcbiAgICAgKi9cbiAgICB0aGlzLmZpbmRSZXBsYXlHYWluID0gZmFsc2U7XG4gICAgLyoqXG4gICAgICogZGVjb2RlIG9uIHRoZSBmbHk/IGRlZmF1bHQ9MFxuICAgICAqL1xuICAgIHRoaXMuZGVjb2RlX29uX3RoZV9mbHkgPSBmYWxzZTtcbiAgICAvKipcbiAgICAgKiAxIChkZWZhdWx0KSB3cml0ZXMgSUQzIHRhZ3MsIDAgbm90XG4gICAgICovXG4gICAgdGhpcy53cml0ZV9pZDN0YWdfYXV0b21hdGljID0gZmFsc2U7XG5cbiAgICAvKlxuICAgICAqIHNldCBlaXRoZXIgYnJhdGU+MCBvciBjb21wcmVzc2lvbl9yYXRpbz4wLCBMQU1FIHdpbGwgY29tcHV0ZSB0aGUgdmFsdWUgb2ZcbiAgICAgKiB0aGUgdmFyaWFibGUgbm90IHNldC4gRGVmYXVsdCBpcyBjb21wcmVzc2lvbl9yYXRpbyA9IDExLjAyNVxuICAgICAqL1xuICAgIC8qKlxuICAgICAqIGJpdHJhdGVcbiAgICAgKi9cbiAgICB0aGlzLmJyYXRlID0gMDtcbiAgICAvKipcbiAgICAgKiBzaXplb2Yod2F2IGZpbGUpL3NpemVvZihtcDMgZmlsZSlcbiAgICAgKi9cbiAgICB0aGlzLmNvbXByZXNzaW9uX3JhdGlvID0gMC47XG5cbiAgICAvKiBmcmFtZSBwYXJhbXMgKi9cbiAgICAvKipcbiAgICAgKiBtYXJrIGFzIGNvcHlyaWdodC4gZGVmYXVsdD0wXG4gICAgICovXG4gICAgdGhpcy5jb3B5cmlnaHQgPSAwO1xuICAgIC8qKlxuICAgICAqIG1hcmsgYXMgb3JpZ2luYWwuIGRlZmF1bHQ9MVxuICAgICAqL1xuICAgIHRoaXMub3JpZ2luYWwgPSAwO1xuICAgIC8qKlxuICAgICAqIHRoZSBNUDMgJ3ByaXZhdGUgZXh0ZW5zaW9uJyBiaXQuIE1lYW5pbmdsZXNzXG4gICAgICovXG4gICAgdGhpcy5leHRlbnNpb24gPSAwO1xuICAgIC8qKlxuICAgICAqIElucHV0IFBDTSBpcyBlbXBoYXNlZCBQQ00gKGZvciBpbnN0YW5jZSBmcm9tIG9uZSBvZiB0aGUgcmFyZWx5IGVtcGhhc2VkXG4gICAgICogQ0RzKSwgaXQgaXMgU1RST05HTFkgbm90IHJlY29tbWVuZGVkIHRvIHVzZSB0aGlzLCBiZWNhdXNlIHBzeWNobyBkb2VzIG5vdFxuICAgICAqIHRha2UgaXQgaW50byBhY2NvdW50LCBhbmQgbGFzdCBidXQgbm90IGxlYXN0IG1hbnkgZGVjb2RlcnMgZG9uJ3QgY2FyZVxuICAgICAqIGFib3V0IHRoZXNlIGJpdHNcbiAgICAgKi9cbiAgICB0aGlzLmVtcGhhc2lzID0gMDtcbiAgICAvKipcbiAgICAgKiB1c2UgMiBieXRlcyBwZXIgZnJhbWUgZm9yIGEgQ1JDIGNoZWNrc3VtLiBkZWZhdWx0PTBcbiAgICAgKi9cbiAgICB0aGlzLmVycm9yX3Byb3RlY3Rpb24gPSAwO1xuICAgIC8qKlxuICAgICAqIGVuZm9yY2UgSVNPIHNwZWMgYXMgbXVjaCBhcyBwb3NzaWJsZVxuICAgICAqL1xuICAgIHRoaXMuc3RyaWN0X0lTTyA9IGZhbHNlO1xuXG4gICAgLyoqXG4gICAgICogdXNlIGJpdCByZXNlcnZvaXI/XG4gICAgICovXG4gICAgdGhpcy5kaXNhYmxlX3Jlc2Vydm9pciA9IGZhbHNlO1xuXG4gICAgLyogcXVhbnRpemF0aW9uL25vaXNlIHNoYXBpbmcgKi9cbiAgICB0aGlzLnF1YW50X2NvbXAgPSAwO1xuICAgIHRoaXMucXVhbnRfY29tcF9zaG9ydCA9IDA7XG4gICAgdGhpcy5leHBlcmltZW50YWxZID0gZmFsc2U7XG4gICAgdGhpcy5leHBlcmltZW50YWxaID0gMDtcbiAgICB0aGlzLmV4cF9uc3BzeXR1bmUgPSAwO1xuXG4gICAgdGhpcy5wcmVzZXQgPSAwO1xuXG4gICAgLyogVkJSIGNvbnRyb2wgKi9cbiAgICB0aGlzLlZCUiA9IG51bGw7XG4gICAgLyoqXG4gICAgICogUmFuZ2UgWzAsLi4uLDFbXG4gICAgICovXG4gICAgdGhpcy5WQlJfcV9mcmFjID0gMC47XG4gICAgLyoqXG4gICAgICogUmFuZ2UgWzAsLi4uLDldXG4gICAgICovXG4gICAgdGhpcy5WQlJfcSA9IDA7XG4gICAgdGhpcy5WQlJfbWVhbl9iaXRyYXRlX2ticHMgPSAwO1xuICAgIHRoaXMuVkJSX21pbl9iaXRyYXRlX2ticHMgPSAwO1xuICAgIHRoaXMuVkJSX21heF9iaXRyYXRlX2ticHMgPSAwO1xuICAgIC8qKlxuICAgICAqIHN0cmljdGx5IGVuZm9yY2UgVkJSX21pbl9iaXRyYXRlIG5vcm1hbHksIGl0IHdpbGwgYmUgdmlvbGF0ZWQgZm9yIGFuYWxvZ1xuICAgICAqIHNpbGVuY2VcbiAgICAgKi9cbiAgICB0aGlzLlZCUl9oYXJkX21pbiA9IDA7XG5cbiAgICAvKiByZXNhbXBsaW5nIGFuZCBmaWx0ZXJpbmcgKi9cblxuICAgIC8qKlxuICAgICAqIGZyZXEgaW4gSHouIDA9bGFtZSBjaG9zZXMuIC0xPW5vIGZpbHRlclxuICAgICAqL1xuICAgIHRoaXMubG93cGFzc2ZyZXEgPSAwO1xuICAgIC8qKlxuICAgICAqIGZyZXEgaW4gSHouIDA9bGFtZSBjaG9zZXMuIC0xPW5vIGZpbHRlclxuICAgICAqL1xuICAgIHRoaXMuaGlnaHBhc3NmcmVxID0gMDtcbiAgICAvKipcbiAgICAgKiBmcmVxIHdpZHRoIG9mIGZpbHRlciwgaW4gSHogKGRlZmF1bHQ9MTUlKVxuICAgICAqL1xuICAgIHRoaXMubG93cGFzc3dpZHRoID0gMDtcbiAgICAvKipcbiAgICAgKiBmcmVxIHdpZHRoIG9mIGZpbHRlciwgaW4gSHogKGRlZmF1bHQ9MTUlKVxuICAgICAqL1xuICAgIHRoaXMuaGlnaHBhc3N3aWR0aCA9IDA7XG5cbiAgICAvKlxuICAgICAqIHBzeWNobyBhY291c3RpY3MgYW5kIG90aGVyIGFyZ3VtZW50cyB3aGljaCB5b3Ugc2hvdWxkIG5vdCBjaGFuZ2UgdW5sZXNzXG4gICAgICogeW91IGtub3cgd2hhdCB5b3UgYXJlIGRvaW5nXG4gICAgICovXG5cbiAgICB0aGlzLm1hc2tpbmdhZGp1c3QgPSAwLjtcbiAgICB0aGlzLm1hc2tpbmdhZGp1c3Rfc2hvcnQgPSAwLjtcbiAgICAvKipcbiAgICAgKiBvbmx5IHVzZSBBVEhcbiAgICAgKi9cbiAgICB0aGlzLkFUSG9ubHkgPSBmYWxzZTtcbiAgICAvKipcbiAgICAgKiBvbmx5IHVzZSBBVEggZm9yIHNob3J0IGJsb2Nrc1xuICAgICAqL1xuICAgIHRoaXMuQVRIc2hvcnQgPSBmYWxzZTtcbiAgICAvKipcbiAgICAgKiBkaXNhYmxlIEFUSFxuICAgICAqL1xuICAgIHRoaXMubm9BVEggPSBmYWxzZTtcbiAgICAvKipcbiAgICAgKiBzZWxlY3QgQVRIIGZvcm11bGFcbiAgICAgKi9cbiAgICB0aGlzLkFUSHR5cGUgPSAwO1xuICAgIC8qKlxuICAgICAqIGNoYW5nZSBBVEggZm9ybXVsYSA0IHNoYXBlXG4gICAgICovXG4gICAgdGhpcy5BVEhjdXJ2ZSA9IDAuO1xuICAgIC8qKlxuICAgICAqIGxvd2VyIEFUSCBieSB0aGlzIG1hbnkgZGJcbiAgICAgKi9cbiAgICB0aGlzLkFUSGxvd2VyID0gMC47XG4gICAgLyoqXG4gICAgICogc2VsZWN0IEFUSCBhdXRvLWFkanVzdCBzY2hlbWVcbiAgICAgKi9cbiAgICB0aGlzLmF0aGFhX3R5cGUgPSAwO1xuICAgIC8qKlxuICAgICAqIHNlbGVjdCBBVEggYXV0by1hZGp1c3QgbG91ZG5lc3MgY2FsY1xuICAgICAqL1xuICAgIHRoaXMuYXRoYWFfbG91ZGFwcHJveCA9IDA7XG4gICAgLyoqXG4gICAgICogZEIsIHR1bmUgYWN0aXZlIHJlZ2lvbiBvZiBhdXRvLWxldmVsXG4gICAgICovXG4gICAgdGhpcy5hdGhhYV9zZW5zaXRpdml0eSA9IDAuO1xuICAgIHRoaXMuc2hvcnRfYmxvY2tzID0gbnVsbDtcbiAgICAvKipcbiAgICAgKiB1c2UgdGVtcG9yYWwgbWFza2luZyBlZmZlY3RcbiAgICAgKi9cbiAgICB0aGlzLnVzZVRlbXBvcmFsID0gZmFsc2U7XG4gICAgdGhpcy5pbnRlckNoUmF0aW8gPSAwLjtcbiAgICAvKipcbiAgICAgKiBOYW9raSdzIGFkanVzdG1lbnQgb2YgTWlkL1NpZGUgbWFza2luZ3NcbiAgICAgKi9cbiAgICB0aGlzLm1zZml4ID0gMC47XG5cbiAgICAvKipcbiAgICAgKiAwIG9mZiwgMSBvblxuICAgICAqL1xuICAgIHRoaXMudHVuZSA9IGZhbHNlO1xuICAgIC8qKlxuICAgICAqIHVzZWQgdG8gcGFzcyB2YWx1ZXMgZm9yIGRlYnVnZ2luZyBhbmQgc3R1ZmZcbiAgICAgKi9cbiAgICB0aGlzLnR1bmVfdmFsdWVfYSA9IDAuO1xuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAvKiBpbnRlcm5hbCB2YXJpYWJsZXMsIGRvIG5vdCBzZXQuLi4gKi9cbiAgICAvKiBwcm92aWRlZCBiZWNhdXNlIHRoZXkgbWF5IGJlIG9mIHVzZSB0byBjYWxsaW5nIGFwcGxpY2F0aW9uICovXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgIC8qKlxuICAgICAqIDA9TVBFRy0yLzIuNSAxPU1QRUctMVxuICAgICAqL1xuICAgIHRoaXMudmVyc2lvbiA9IDA7XG4gICAgdGhpcy5lbmNvZGVyX2RlbGF5ID0gMDtcbiAgICAvKipcbiAgICAgKiBudW1iZXIgb2Ygc2FtcGxlcyBvZiBwYWRkaW5nIGFwcGVuZGVkIHRvIGlucHV0XG4gICAgICovXG4gICAgdGhpcy5lbmNvZGVyX3BhZGRpbmcgPSAwO1xuICAgIHRoaXMuZnJhbWVzaXplID0gMDtcbiAgICAvKipcbiAgICAgKiBudW1iZXIgb2YgZnJhbWVzIGVuY29kZWRcbiAgICAgKi9cbiAgICB0aGlzLmZyYW1lTnVtID0gMDtcbiAgICAvKipcbiAgICAgKiBpcyB0aGlzIHN0cnVjdCBvd25lZCBieSBjYWxsaW5nIHByb2dyYW0gb3IgbGFtZT9cbiAgICAgKi9cbiAgICB0aGlzLmxhbWVfYWxsb2NhdGVkX2dmcCA9IDA7XG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgIC8qIG1vcmUgaW50ZXJuYWwgdmFyaWFibGVzIGFyZSBzdG9yZWQgaW4gdGhpcyBzdHJ1Y3R1cmU6ICovXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgIHRoaXMuaW50ZXJuYWxfZmxhZ3MgPSBudWxsO1xufVxuXG5cblxuZnVuY3Rpb24gQ0JSTmV3SXRlcmF0aW9uTG9vcChfcXVhbnRpemUpICB7XG4gICAgdmFyIHF1YW50aXplID0gX3F1YW50aXplO1xuICAgIHRoaXMucXVhbnRpemUgPSBxdWFudGl6ZTtcblx0dGhpcy5pdGVyYXRpb25fbG9vcCA9IGZ1bmN0aW9uKGdmcCwgcGUsIG1zX2VuZXJfcmF0aW8sIHJhdGlvKSB7XG5cdFx0dmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGwzX3htaW4gPSBuZXdfZmxvYXQoTDNTaWRlLlNGQk1BWCk7XG5cdFx0dmFyIHhycG93ID0gbmV3X2Zsb2F0KDU3Nik7XG5cdFx0dmFyIHRhcmdfYml0cyA9IG5ld19pbnQoMik7XG5cdFx0dmFyIG1lYW5fYml0cyA9IDAsIG1heF9iaXRzO1xuXHRcdHZhciBsM19zaWRlID0gZ2ZjLmwzX3NpZGU7XG5cblx0XHR2YXIgbWIgPSBuZXcgTWVhbkJpdHMobWVhbl9iaXRzKTtcblx0XHR0aGlzLnF1YW50aXplLnJ2LlJlc3ZGcmFtZUJlZ2luKGdmcCwgbWIpO1xuXHRcdG1lYW5fYml0cyA9IG1iLmJpdHM7XG5cblx0XHQvKiBxdWFudGl6ZSEgKi9cblx0XHRmb3IgKHZhciBnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcblxuXHRcdFx0Lypcblx0XHRcdCAqIGNhbGN1bGF0ZSBuZWVkZWQgYml0c1xuXHRcdFx0ICovXG5cdFx0XHRtYXhfYml0cyA9IHRoaXMucXVhbnRpemUucXVwdnQub25fcGUoZ2ZwLCBwZSwgdGFyZ19iaXRzLCBtZWFuX2JpdHMsXG5cdFx0XHRcdFx0Z3IsIGdyKTtcblxuXHRcdFx0aWYgKGdmYy5tb2RlX2V4dCA9PSBFbmNvZGVyLk1QR19NRF9NU19MUikge1xuXHRcdFx0XHR0aGlzLnF1YW50aXplLm1zX2NvbnZlcnQoZ2ZjLmwzX3NpZGUsIGdyKTtcblx0XHRcdFx0dGhpcy5xdWFudGl6ZS5xdXB2dC5yZWR1Y2Vfc2lkZSh0YXJnX2JpdHMsIG1zX2VuZXJfcmF0aW9bZ3JdLFxuXHRcdFx0XHRcdFx0bWVhbl9iaXRzLCBtYXhfYml0cyk7XG5cdFx0XHR9XG5cblx0XHRcdGZvciAodmFyIGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG5cdFx0XHRcdHZhciBhZGp1c3QsIG1hc2tpbmdfbG93ZXJfZGI7XG5cdFx0XHRcdHZhciBjb2RfaW5mbyA9IGwzX3NpZGUudHRbZ3JdW2NoXTtcblxuXHRcdFx0XHRpZiAoY29kX2luZm8uYmxvY2tfdHlwZSAhPSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcblx0XHRcdFx0XHQvLyBOT1JNLCBTVEFSVCBvciBTVE9QIHR5cGVcblx0XHRcdFx0XHRhZGp1c3QgPSAwO1xuXHRcdFx0XHRcdG1hc2tpbmdfbG93ZXJfZGIgPSBnZmMuUFNZLm1hc2tfYWRqdXN0IC0gYWRqdXN0O1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGFkanVzdCA9IDA7XG5cdFx0XHRcdFx0bWFza2luZ19sb3dlcl9kYiA9IGdmYy5QU1kubWFza19hZGp1c3Rfc2hvcnQgLSBhZGp1c3Q7XG5cdFx0XHRcdH1cblx0XHRcdFx0Z2ZjLm1hc2tpbmdfbG93ZXIgPSAgTWF0aC5wb3coMTAuMCxcblx0XHRcdFx0XHRcdG1hc2tpbmdfbG93ZXJfZGIgKiAwLjEpO1xuXG5cdFx0XHRcdC8qXG5cdFx0XHRcdCAqIGluaXRfb3V0ZXJfbG9vcCBzZXRzIHVwIGNvZF9pbmZvLCBzY2FsZWZhYyBhbmQgeHJwb3dcblx0XHRcdFx0ICovXG5cdFx0XHRcdHRoaXMucXVhbnRpemUuaW5pdF9vdXRlcl9sb29wKGdmYywgY29kX2luZm8pO1xuXHRcdFx0XHRpZiAodGhpcy5xdWFudGl6ZS5pbml0X3hycG93KGdmYywgY29kX2luZm8sIHhycG93KSkge1xuXHRcdFx0XHRcdC8qXG5cdFx0XHRcdFx0ICogeHIgY29udGFpbnMgZW5lcmd5IHdlIHdpbGwgaGF2ZSB0byBlbmNvZGUgY2FsY3VsYXRlIHRoZVxuXHRcdFx0XHRcdCAqIG1hc2tpbmcgYWJpbGl0aWVzIGZpbmQgc29tZSBnb29kIHF1YW50aXphdGlvbiBpblxuXHRcdFx0XHRcdCAqIG91dGVyX2xvb3Bcblx0XHRcdFx0XHQgKi9cblx0XHRcdFx0XHR0aGlzLnF1YW50aXplLnF1cHZ0LmNhbGNfeG1pbihnZnAsIHJhdGlvW2dyXVtjaF0sIGNvZF9pbmZvLFxuXHRcdFx0XHRcdFx0XHRsM194bWluKTtcblx0XHRcdFx0XHR0aGlzLnF1YW50aXplLm91dGVyX2xvb3AoZ2ZwLCBjb2RfaW5mbywgbDNfeG1pbiwgeHJwb3csIGNoLFxuXHRcdFx0XHRcdFx0XHR0YXJnX2JpdHNbY2hdKTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHRoaXMucXVhbnRpemUuaXRlcmF0aW9uX2ZpbmlzaF9vbmUoZ2ZjLCBnciwgY2gpO1xuXHRcdFx0fSAvKiBmb3IgY2ggKi9cblx0XHR9IC8qIGZvciBnciAqL1xuXG5cdFx0dGhpcy5xdWFudGl6ZS5ydi5SZXN2RnJhbWVFbmQoZ2ZjLCBtZWFuX2JpdHMpO1xuXHR9XG59XG5cblxuZnVuY3Rpb24gUmVwbGF5R2FpbigpIHtcblx0Ly9maXgg57K+566AXG59XG5cbi8vcGFja2FnZSBtcDM7XG5cbi8qKlxuICogTGF5ZXIgSUlJIHNpZGUgaW5mb3JtYXRpb24uXG4gKlxuICogQGF1dGhvciBLZW5cbiAqXG4gKi9cblxuXG5cbmZ1bmN0aW9uIFNjYWxlRmFjKGFyckwsIGFyclMsIGFycjIxLCBhcnIxMikge1xuXG4gICAgdGhpcy5sID0gbmV3X2ludCgxICsgRW5jb2Rlci5TQk1BWF9sKTtcbiAgICB0aGlzLnMgPSBuZXdfaW50KDEgKyBFbmNvZGVyLlNCTUFYX3MpO1xuICAgIHRoaXMucHNmYjIxID0gbmV3X2ludCgxICsgRW5jb2Rlci5QU0ZCMjEpO1xuICAgIHRoaXMucHNmYjEyID0gbmV3X2ludCgxICsgRW5jb2Rlci5QU0ZCMTIpO1xuICAgIHZhciBsID0gdGhpcy5sO1xuICAgIHZhciBzID0gdGhpcy5zO1xuXG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT0gNCkge1xuICAgICAgICAvL3B1YmxpYyBTY2FsZUZhYyhmaW5hbCBpbnRbXSBhcnJMLCBmaW5hbCBpbnRbXSBhcnJTLCBmaW5hbCBpbnRbXSBhcnIyMSxcbiAgICAgICAgLy8gICAgZmluYWwgaW50W10gYXJyMTIpIHtcbiAgICAgICAgdGhpcy5hcnJMID0gYXJndW1lbnRzWzBdO1xuICAgICAgICB0aGlzLmFyclMgPSBhcmd1bWVudHNbMV07XG4gICAgICAgIHRoaXMuYXJyMjEgPSBhcmd1bWVudHNbMl07XG4gICAgICAgIHRoaXMuYXJyMTIgPSBhcmd1bWVudHNbM107XG5cbiAgICAgICAgU3lzdGVtLmFycmF5Y29weSh0aGlzLmFyckwsIDAsIGwsIDAsIE1hdGgubWluKHRoaXMuYXJyTC5sZW5ndGgsIHRoaXMubC5sZW5ndGgpKTtcbiAgICAgICAgU3lzdGVtLmFycmF5Y29weSh0aGlzLmFyclMsIDAsIHMsIDAsIE1hdGgubWluKHRoaXMuYXJyUy5sZW5ndGgsIHRoaXMucy5sZW5ndGgpKTtcbiAgICAgICAgU3lzdGVtLmFycmF5Y29weSh0aGlzLmFycjIxLCAwLCB0aGlzLnBzZmIyMSwgMCwgTWF0aC5taW4odGhpcy5hcnIyMS5sZW5ndGgsIHRoaXMucHNmYjIxLmxlbmd0aCkpO1xuICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KHRoaXMuYXJyMTIsIDAsIHRoaXMucHNmYjEyLCAwLCBNYXRoLm1pbih0aGlzLmFycjEyLmxlbmd0aCwgdGhpcy5wc2ZiMTIubGVuZ3RoKSk7XG4gICAgfVxufVxuXG4vKlxuICogICAgICBxdWFudGl6ZV9wdnQgc291cmNlIGZpbGVcbiAqXG4gKiAgICAgIENvcHlyaWdodCAoYykgMTk5OS0yMDAyIFRha2VoaXJvIFRvbWluYWdhXG4gKiAgICAgIENvcHlyaWdodCAoYykgMjAwMC0yMDAyIFJvYmVydCBIZWdlbWFublxuICogICAgICBDb3B5cmlnaHQgKGMpIDIwMDEgTmFva2kgU2hpYmF0YVxuICogICAgICBDb3B5cmlnaHQgKGMpIDIwMDItMjAwNSBHYWJyaWVsIEJvdXZpZ25lXG4gKlxuICogVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vclxuICogbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpY1xuICogTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyXG4gKiB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG4gKlxuICogVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG4gKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlVcbiAqIExpYnJhcnkgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLlxuICpcbiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWNcbiAqIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgd3JpdGUgdG8gdGhlXG4gKiBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb24sIEluYy4sIDU5IFRlbXBsZSBQbGFjZSAtIFN1aXRlIDMzMCxcbiAqIEJvc3RvbiwgTUEgMDIxMTEtMTMwNywgVVNBLlxuICovXG5cbi8qICRJZDogUXVhbnRpemVQVlQuamF2YSx2IDEuMjQgMjAxMS8wNS8yNCAyMDo0ODowNiBrZW5jaGlzIEV4cCAkICovXG5cblxuUXVhbnRpemVQVlQuUV9NQVggPSAoMjU2ICsgMSk7XG5RdWFudGl6ZVBWVC5RX01BWDIgPSAxMTY7XG5RdWFudGl6ZVBWVC5MQVJHRV9CSVRTID0gMTAwMDAwO1xuUXVhbnRpemVQVlQuSVhNQVhfVkFMID0gODIwNjtcblxuZnVuY3Rpb24gUXVhbnRpemVQVlQoKSB7XG5cbiAgICB2YXIgdGFrID0gbnVsbDtcbiAgICB2YXIgcnYgPSBudWxsO1xuICAgIHZhciBwc3kgPSBudWxsO1xuXG4gICAgdGhpcy5zZXRNb2R1bGVzID0gZnVuY3Rpb24gKF90aywgX3J2LCBfcHN5KSB7XG4gICAgICAgIHRhayA9IF90aztcbiAgICAgICAgcnYgPSBfcnY7XG4gICAgICAgIHBzeSA9IF9wc3k7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIFBPVzIwKHgpIHtcbiAgICAgICAgcmV0dXJuIHBvdzIwW3ggKyBRdWFudGl6ZVBWVC5RX01BWDJdO1xuICAgIH1cblxuICAgIHRoaXMuSVBPVzIwID0gZnVuY3Rpb24gKHgpIHtcbiAgICAgICAgcmV0dXJuIGlwb3cyMFt4XTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBzbWFsbGVzdCBzdWNoIHRoYXQgMS4wK0RCTF9FUFNJTE9OICE9IDEuMFxuICAgICAqL1xuICAgIHZhciBEQkxfRVBTSUxPTiA9IDIuMjIwNDQ2MDQ5MjUwMzEzMWUtMDE2O1xuXG4gICAgLyoqXG4gICAgICogaXggYWx3YXlzIDw9IDgxOTErMTUuIHNlZSBjb3VudF9iaXRzKClcbiAgICAgKi9cbiAgICB2YXIgSVhNQVhfVkFMID0gUXVhbnRpemVQVlQuSVhNQVhfVkFMO1xuXG4gICAgdmFyIFBSRUNBTENfU0laRSA9IChJWE1BWF9WQUwgKyAyKTtcblxuICAgIHZhciBRX01BWCA9IFF1YW50aXplUFZULlFfTUFYO1xuXG5cbiAgICAvKipcbiAgICAgKiA8Q09ERT5cbiAgICAgKiBtaW5pbXVtIHBvc3NpYmxlIG51bWJlciBvZlxuICAgICAqIC1jb2RfaW5mby5nbG9iYWxfZ2FpbiArICgoc2NhbGVmYWNbXSArIChjb2RfaW5mby5wcmVmbGFnID8gcHJldGFiW3NmYl0gOiAwKSlcbiAgICAgKiA8PCAoY29kX2luZm8uc2NhbGVmYWNfc2NhbGUgKyAxKSkgKyBjb2RfaW5mby5zdWJibG9ja19nYWluW2NvZF9pbmZvLndpbmRvd1tzZmJdXSAqIDg7XG4gICAgICpcbiAgICAgKiBmb3IgbG9uZyBibG9jaywgMCsoKDE1KzMpPDwyKSA9IDE4KjQgPSA3MlxuICAgICAqIGZvciBzaG9ydCBibG9jaywgMCsoMTU8PDIpKzcqOCA9IDE1KjQrNTYgPSAxMTZcbiAgICAgKiA8L0NPREU+XG4gICAgICovXG4gICAgdmFyIFFfTUFYMiA9IFF1YW50aXplUFZULlFfTUFYMjtcblxuICAgIHZhciBMQVJHRV9CSVRTID0gUXVhbnRpemVQVlQuTEFSR0VfQklUUztcblxuXG4gICAgLyoqXG4gICAgICogQXNzdW1pbmcgZHluYW1pYyByYW5nZT05NmRCLCB0aGlzIHZhbHVlIHNob3VsZCBiZSA5MlxuICAgICAqL1xuICAgIHZhciBOU0FUSFNDQUxFID0gMTAwO1xuXG4gICAgLyoqXG4gICAgICogVGhlIGZvbGxvd2luZyB0YWJsZSBpcyB1c2VkIHRvIGltcGxlbWVudCB0aGUgc2NhbGVmYWN0b3IgcGFydGl0aW9uaW5nIGZvclxuICAgICAqIE1QRUcyIGFzIGRlc2NyaWJlZCBpbiBzZWN0aW9uIDIuNC4zLjIgb2YgdGhlIElTLiBUaGUgaW5kZXhpbmcgY29ycmVzcG9uZHNcbiAgICAgKiB0byB0aGUgd2F5IHRoZSB0YWJsZXMgYXJlIHByZXNlbnRlZCBpbiB0aGUgSVM6XG4gICAgICpcbiAgICAgKiBbdGFibGVfbnVtYmVyXVtyb3dfaW5fdGFibGVdW2NvbHVtbiBvZiBucl9vZl9zZmJdXG4gICAgICovXG4gICAgdGhpcy5ucl9vZl9zZmJfYmxvY2sgPSBbXG4gICAgICAgIFtbNiwgNSwgNSwgNV0sIFs5LCA5LCA5LCA5XSwgWzYsIDksIDksIDldXSxcbiAgICAgICAgW1s2LCA1LCA3LCAzXSwgWzksIDksIDEyLCA2XSwgWzYsIDksIDEyLCA2XV0sXG4gICAgICAgIFtbMTEsIDEwLCAwLCAwXSwgWzE4LCAxOCwgMCwgMF0sIFsxNSwgMTgsIDAsIDBdXSxcbiAgICAgICAgW1s3LCA3LCA3LCAwXSwgWzEyLCAxMiwgMTIsIDBdLCBbNiwgMTUsIDEyLCAwXV0sXG4gICAgICAgIFtbNiwgNiwgNiwgM10sIFsxMiwgOSwgOSwgNl0sIFs2LCAxMiwgOSwgNl1dLFxuICAgICAgICBbWzgsIDgsIDUsIDBdLCBbMTUsIDEyLCA5LCAwXSwgWzYsIDE4LCA5LCAwXV1dO1xuXG4gICAgLyoqXG4gICAgICogVGFibGUgQi42OiBsYXllcjMgcHJlZW1waGFzaXNcbiAgICAgKi9cbiAgICB2YXIgcHJldGFiID0gWzAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDAsIDEsIDEsIDEsIDEsXG4gICAgICAgIDIsIDIsIDMsIDMsIDMsIDIsIDBdO1xuICAgIHRoaXMucHJldGFiID0gcHJldGFiO1xuXG4gICAgLyoqXG4gICAgICogSGVyZSBhcmUgTVBFRzEgVGFibGUgQi44IGFuZCBNUEVHMiBUYWJsZSBCLjEgLS0gTGF5ZXIgSUlJIHNjYWxlZmFjdG9yXG4gICAgICogYmFuZHMuIDxCUj5cbiAgICAgKiBJbmRleCBpbnRvIHRoaXMgdXNpbmcgYSBtZXRob2Qgc3VjaCBhczo8QlI+XG4gICAgICogaWR4ID0gZnJfcHMuaGVhZGVyLnNhbXBsaW5nX2ZyZXF1ZW5jeSArIChmcl9wcy5oZWFkZXIudmVyc2lvbiAqIDMpXG4gICAgICovXG4gICAgdGhpcy5zZkJhbmRJbmRleCA9IFtcbiAgICAgICAgLy8gVGFibGUgQi4yLmI6IDIyLjA1IGtIelxuICAgICAgICBuZXcgU2NhbGVGYWMoWzAsIDYsIDEyLCAxOCwgMjQsIDMwLCAzNiwgNDQsIDU0LCA2NiwgODAsIDk2LCAxMTYsIDE0MCwgMTY4LCAyMDAsIDIzOCwgMjg0LCAzMzYsIDM5NiwgNDY0LFxuICAgICAgICAgICAgICAgIDUyMiwgNTc2XSxcbiAgICAgICAgICAgIFswLCA0LCA4LCAxMiwgMTgsIDI0LCAzMiwgNDIsIDU2LCA3NCwgMTAwLCAxMzIsIDE3NCwgMTkyXVxuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLy8gIHNmYjIxIHBzZXVkbyBzdWIgYmFuZHNcbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8vICBzZmIxMiBwc2V1ZG8gc3ViIGJhbmRzXG4gICAgICAgICksXG4gICAgICAgIC8qIFRhYmxlIEIuMi5jOiAyNCBrSHogKi8gLyogZG9jczogMzMyLiBtcGcxMjMoYnJva2VuKTogMzMwICovXG4gICAgICAgIG5ldyBTY2FsZUZhYyhbMCwgNiwgMTIsIDE4LCAyNCwgMzAsIDM2LCA0NCwgNTQsIDY2LCA4MCwgOTYsIDExNCwgMTM2LCAxNjIsIDE5NCwgMjMyLCAyNzgsIDMzMiwgMzk0LCA0NjQsXG4gICAgICAgICAgICAgICAgNTQwLCA1NzZdLFxuICAgICAgICAgICAgWzAsIDQsIDgsIDEyLCAxOCwgMjYsIDM2LCA0OCwgNjIsIDgwLCAxMDQsIDEzNiwgMTgwLCAxOTJdXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvKiAgc2ZiMjEgcHNldWRvIHN1YiBiYW5kcyAqL1xuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLyogIHNmYjEyIHBzZXVkbyBzdWIgYmFuZHMgKi9cbiAgICAgICAgKSxcbiAgICAgICAgLyogVGFibGUgQi4yLmE6IDE2IGtIeiAqL1xuICAgICAgICBuZXcgU2NhbGVGYWMoWzAsIDYsIDEyLCAxOCwgMjQsIDMwLCAzNiwgNDQsIDU0LCA2NiwgODAsIDk2LCAxMTYsIDE0MCwgMTY4LCAyMDAsIDIzOCwgMjg0LCAzMzYsIDM5NiwgNDY0LFxuICAgICAgICAgICAgICAgIDUyMiwgNTc2XSxcbiAgICAgICAgICAgIFswLCA0LCA4LCAxMiwgMTgsIDI2LCAzNiwgNDgsIDYyLCA4MCwgMTA0LCAxMzQsIDE3NCwgMTkyXVxuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLyogIHNmYjIxIHBzZXVkbyBzdWIgYmFuZHMgKi9cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8qICBzZmIxMiBwc2V1ZG8gc3ViIGJhbmRzICovXG4gICAgICAgICksXG4gICAgICAgIC8qIFRhYmxlIEIuOC5iOiA0NC4xIGtIeiAqL1xuICAgICAgICBuZXcgU2NhbGVGYWMoWzAsIDQsIDgsIDEyLCAxNiwgMjAsIDI0LCAzMCwgMzYsIDQ0LCA1MiwgNjIsIDc0LCA5MCwgMTEwLCAxMzQsIDE2MiwgMTk2LCAyMzgsIDI4OCwgMzQyLCA0MTgsXG4gICAgICAgICAgICAgICAgNTc2XSxcbiAgICAgICAgICAgIFswLCA0LCA4LCAxMiwgMTYsIDIyLCAzMCwgNDAsIDUyLCA2NiwgODQsIDEwNiwgMTM2LCAxOTJdXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvKiAgc2ZiMjEgcHNldWRvIHN1YiBiYW5kcyAqL1xuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLyogIHNmYjEyIHBzZXVkbyBzdWIgYmFuZHMgKi9cbiAgICAgICAgKSxcbiAgICAgICAgLyogVGFibGUgQi44LmM6IDQ4IGtIeiAqL1xuICAgICAgICBuZXcgU2NhbGVGYWMoWzAsIDQsIDgsIDEyLCAxNiwgMjAsIDI0LCAzMCwgMzYsIDQyLCA1MCwgNjAsIDcyLCA4OCwgMTA2LCAxMjgsIDE1NiwgMTkwLCAyMzAsIDI3NiwgMzMwLCAzODQsXG4gICAgICAgICAgICAgICAgNTc2XSxcbiAgICAgICAgICAgIFswLCA0LCA4LCAxMiwgMTYsIDIyLCAyOCwgMzgsIDUwLCA2NCwgODAsIDEwMCwgMTI2LCAxOTJdXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvKiAgc2ZiMjEgcHNldWRvIHN1YiBiYW5kcyAqL1xuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLyogIHNmYjEyIHBzZXVkbyBzdWIgYmFuZHMgKi9cbiAgICAgICAgKSxcbiAgICAgICAgLyogVGFibGUgQi44LmE6IDMyIGtIeiAqL1xuICAgICAgICBuZXcgU2NhbGVGYWMoWzAsIDQsIDgsIDEyLCAxNiwgMjAsIDI0LCAzMCwgMzYsIDQ0LCA1NCwgNjYsIDgyLCAxMDIsIDEyNiwgMTU2LCAxOTQsIDI0MCwgMjk2LCAzNjQsIDQ0OCwgNTUwLFxuICAgICAgICAgICAgICAgIDU3Nl0sXG4gICAgICAgICAgICBbMCwgNCwgOCwgMTIsIDE2LCAyMiwgMzAsIDQyLCA1OCwgNzgsIDEwNCwgMTM4LCAxODAsIDE5Ml1cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8qICBzZmIyMSBwc2V1ZG8gc3ViIGJhbmRzICovXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvKiAgc2ZiMTIgcHNldWRvIHN1YiBiYW5kcyAqL1xuICAgICAgICApLFxuICAgICAgICAvKiBNUEVHLTIuNSAxMS4wMjUga0h6ICovXG4gICAgICAgIG5ldyBTY2FsZUZhYyhbMCwgNiwgMTIsIDE4LCAyNCwgMzAsIDM2LCA0NCwgNTQsIDY2LCA4MCwgOTYsIDExNiwgMTQwLCAxNjgsIDIwMCwgMjM4LCAyODQsIDMzNiwgMzk2LCA0NjQsXG4gICAgICAgICAgICAgICAgNTIyLCA1NzZdLFxuICAgICAgICAgICAgWzAgLyAzLCAxMiAvIDMsIDI0IC8gMywgMzYgLyAzLCA1NCAvIDMsIDc4IC8gMywgMTA4IC8gMywgMTQ0IC8gMywgMTg2IC8gMywgMjQwIC8gMywgMzEyIC8gMyxcbiAgICAgICAgICAgICAgICA0MDIgLyAzLCA1MjIgLyAzLCA1NzYgLyAzXVxuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLyogIHNmYjIxIHBzZXVkbyBzdWIgYmFuZHMgKi9cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8qICBzZmIxMiBwc2V1ZG8gc3ViIGJhbmRzICovXG4gICAgICAgICksXG4gICAgICAgIC8qIE1QRUctMi41IDEyIGtIeiAqL1xuICAgICAgICBuZXcgU2NhbGVGYWMoWzAsIDYsIDEyLCAxOCwgMjQsIDMwLCAzNiwgNDQsIDU0LCA2NiwgODAsIDk2LCAxMTYsIDE0MCwgMTY4LCAyMDAsIDIzOCwgMjg0LCAzMzYsIDM5NiwgNDY0LFxuICAgICAgICAgICAgICAgIDUyMiwgNTc2XSxcbiAgICAgICAgICAgIFswIC8gMywgMTIgLyAzLCAyNCAvIDMsIDM2IC8gMywgNTQgLyAzLCA3OCAvIDMsIDEwOCAvIDMsIDE0NCAvIDMsIDE4NiAvIDMsIDI0MCAvIDMsIDMxMiAvIDMsXG4gICAgICAgICAgICAgICAgNDAyIC8gMywgNTIyIC8gMywgNTc2IC8gM11cbiAgICAgICAgICAgICwgWzAsIDAsIDAsIDAsIDAsIDAsIDBdIC8qICBzZmIyMSBwc2V1ZG8gc3ViIGJhbmRzICovXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvKiAgc2ZiMTIgcHNldWRvIHN1YiBiYW5kcyAqL1xuICAgICAgICApLFxuICAgICAgICAvKiBNUEVHLTIuNSA4IGtIeiAqL1xuICAgICAgICBuZXcgU2NhbGVGYWMoWzAsIDEyLCAyNCwgMzYsIDQ4LCA2MCwgNzIsIDg4LCAxMDgsIDEzMiwgMTYwLCAxOTIsIDIzMiwgMjgwLCAzMzYsIDQwMCwgNDc2LCA1NjYsIDU2OCwgNTcwLFxuICAgICAgICAgICAgICAgIDU3MiwgNTc0LCA1NzZdLFxuICAgICAgICAgICAgWzAgLyAzLCAyNCAvIDMsIDQ4IC8gMywgNzIgLyAzLCAxMDggLyAzLCAxNTYgLyAzLCAyMTYgLyAzLCAyODggLyAzLCAzNzIgLyAzLCA0ODAgLyAzLCA0ODYgLyAzLFxuICAgICAgICAgICAgICAgIDQ5MiAvIDMsIDQ5OCAvIDMsIDU3NiAvIDNdXG4gICAgICAgICAgICAsIFswLCAwLCAwLCAwLCAwLCAwLCAwXSAvKiAgc2ZiMjEgcHNldWRvIHN1YiBiYW5kcyAqL1xuICAgICAgICAgICAgLCBbMCwgMCwgMCwgMCwgMCwgMCwgMF0gLyogIHNmYjEyIHBzZXVkbyBzdWIgYmFuZHMgKi9cbiAgICAgICAgKVxuICAgIF07XG5cbiAgICB2YXIgcG93MjAgPSBuZXdfZmxvYXQoUV9NQVggKyBRX01BWDIgKyAxKTtcbiAgICB2YXIgaXBvdzIwID0gbmV3X2Zsb2F0KFFfTUFYKTtcbiAgICB2YXIgcG93NDMgPSBuZXdfZmxvYXQoUFJFQ0FMQ19TSVpFKTtcblxuICAgIHZhciBhZGo0MyA9IG5ld19mbG9hdChQUkVDQUxDX1NJWkUpO1xuICAgIHRoaXMuYWRqNDMgPSBhZGo0MztcblxuICAgIC8qKlxuICAgICAqIDxQUkU+XG4gICAgICogY29tcHV0ZSB0aGUgQVRIIGZvciBlYWNoIHNjYWxlZmFjdG9yIGJhbmQgY2QgcmFuZ2U6IDAuLjk2ZGJcbiAgICAgKlxuICAgICAqIElucHV0OiAzLjNrSHogc2lnbmFsIDMyNzY3IGFtcGxpdHVkZSAoMy4za0h6IGlzIHdoZXJlIEFUSCBpcyBzbWFsbGVzdCA9XG4gICAgICogLTVkYikgbG9uZ2Jsb2Nrczogc2ZiPTEyIGVuMC9idz0tMTFkYiBtYXhfZW4wID0gMS4zZGIgc2hvcnRibG9ja3M6IHNmYj01XG4gICAgICogLTlkYiAwZGJcbiAgICAgKlxuICAgICAqIElucHV0OiAxIDEgMSAxIDEgMSAxIC0xIC0xIC0xIC0xIC0xIC0xIC0xIChyZXBlYXRlZCkgbG9uZ2Jsb2NrczogYW1wPTFcbiAgICAgKiBzZmI9MTIgZW4wL2J3PS0xMDMgZGIgbWF4X2VuMCA9IC05MmRiIGFtcD0zMjc2NyBzZmI9MTIgLTEyIGRiIC0xLjRkYlxuICAgICAqXG4gICAgICogSW5wdXQ6IDEgMSAxIDEgMSAxIDEgLTEgLTEgLTEgLTEgLTEgLTEgLTEgKHJlcGVhdGVkKSBzaG9ydGJsb2NrczogYW1wPTFcbiAgICAgKiBzZmI9NSBlbjAvYnc9IC05OSAtODYgYW1wPTMyNzY3IHNmYj01IC05IGRiIDRkYlxuICAgICAqXG4gICAgICpcbiAgICAgKiBNQVggZW5lcmd5IG9mIGxhcmdlc3Qgd2F2ZSBhdCAzLjNrSHogPSAxZGIgQVZFIGVuZXJneSBvZiBsYXJnZXN0IHdhdmUgYXRcbiAgICAgKiAzLjNrSHogPSAtMTFkYiBMZXQncyB0YWtlIEFWRTogLTExZGIgPSBtYXhpbXVtIHNpZ25hbCBpbiBzZmI9MTIuIER5bmFtaWNcbiAgICAgKiByYW5nZSBvZiBDRDogOTZkYi4gVGhlcmVmb3IgZW5lcmd5IG9mIHNtYWxsZXN0IGF1ZGlibGUgd2F2ZSBpbiBzZmI9MTIgPVxuICAgICAqIC0xMSAtIDk2ID0gLTEwN2RiID0gQVRIIGF0IDMuM2tIei5cbiAgICAgKlxuICAgICAqIEFUSCBmb3JtdWxhIGZvciB0aGlzIHdhdmU6IC01ZGIuIFRvIGFkanVzdCB0byBMQU1FIHNjYWxpbmcsIHdlIG5lZWQgQVRIID1cbiAgICAgKiBBVEhfZm9ybXVsYSAtIDEwMyAoZGIpIEFUSCA9IEFUSCAqIDIuNWUtMTAgKGVuZXIpXG4gICAgICogPC9QUkU+XG4gICAgICovXG4gICAgZnVuY3Rpb24gQVRIbWRjdChnZnAsIGYpIHtcbiAgICAgICAgdmFyIGF0aCA9IHBzeS5BVEhmb3JtdWxhKGYsIGdmcCk7XG5cbiAgICAgICAgYXRoIC09IE5TQVRIU0NBTEU7XG5cbiAgICAgICAgLyogbW9kaWZ5IHRoZSBNRENUIHNjYWxpbmcgZm9yIHRoZSBBVEggYW5kIGNvbnZlcnQgdG8gZW5lcmd5ICovXG4gICAgICAgIGF0aCA9IE1hdGgucG93KDEwLjAsIGF0aCAvIDEwLjAgKyBnZnAuQVRIbG93ZXIpO1xuICAgICAgICByZXR1cm4gYXRoO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvbXB1dGVfYXRoKGdmcCkge1xuICAgICAgICB2YXIgQVRIX2wgPSBnZnAuaW50ZXJuYWxfZmxhZ3MuQVRILmw7XG4gICAgICAgIHZhciBBVEhfcHNmYjIxID0gZ2ZwLmludGVybmFsX2ZsYWdzLkFUSC5wc2ZiMjE7XG4gICAgICAgIHZhciBBVEhfcyA9IGdmcC5pbnRlcm5hbF9mbGFncy5BVEgucztcbiAgICAgICAgdmFyIEFUSF9wc2ZiMTIgPSBnZnAuaW50ZXJuYWxfZmxhZ3MuQVRILnBzZmIxMjtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIHNhbXBfZnJlcSA9IGdmcC5vdXRfc2FtcGxlcmF0ZTtcblxuICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBFbmNvZGVyLlNCTUFYX2w7IHNmYisrKSB7XG4gICAgICAgICAgICB2YXIgc3RhcnQgPSBnZmMuc2NhbGVmYWNfYmFuZC5sW3NmYl07XG4gICAgICAgICAgICB2YXIgZW5kID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFtzZmIgKyAxXTtcbiAgICAgICAgICAgIEFUSF9sW3NmYl0gPSBGbG9hdC5NQVhfVkFMVUU7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBmcmVxID0gaSAqIHNhbXBfZnJlcSAvICgyICogNTc2KTtcbiAgICAgICAgICAgICAgICB2YXIgQVRIX2YgPSBBVEhtZGN0KGdmcCwgZnJlcSk7XG4gICAgICAgICAgICAgICAgLyogZnJlcSBpbiBrSHogKi9cbiAgICAgICAgICAgICAgICBBVEhfbFtzZmJdID0gTWF0aC5taW4oQVRIX2xbc2ZiXSwgQVRIX2YpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgRW5jb2Rlci5QU0ZCMjE7IHNmYisrKSB7XG4gICAgICAgICAgICB2YXIgc3RhcnQgPSBnZmMuc2NhbGVmYWNfYmFuZC5wc2ZiMjFbc2ZiXTtcbiAgICAgICAgICAgIHZhciBlbmQgPSBnZmMuc2NhbGVmYWNfYmFuZC5wc2ZiMjFbc2ZiICsgMV07XG4gICAgICAgICAgICBBVEhfcHNmYjIxW3NmYl0gPSBGbG9hdC5NQVhfVkFMVUU7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPCBlbmQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBmcmVxID0gaSAqIHNhbXBfZnJlcSAvICgyICogNTc2KTtcbiAgICAgICAgICAgICAgICB2YXIgQVRIX2YgPSBBVEhtZGN0KGdmcCwgZnJlcSk7XG4gICAgICAgICAgICAgICAgLyogZnJlcSBpbiBrSHogKi9cbiAgICAgICAgICAgICAgICBBVEhfcHNmYjIxW3NmYl0gPSBNYXRoLm1pbihBVEhfcHNmYjIxW3NmYl0sIEFUSF9mKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IEVuY29kZXIuU0JNQVhfczsgc2ZiKyspIHtcbiAgICAgICAgICAgIHZhciBzdGFydCA9IGdmYy5zY2FsZWZhY19iYW5kLnNbc2ZiXTtcbiAgICAgICAgICAgIHZhciBlbmQgPSBnZmMuc2NhbGVmYWNfYmFuZC5zW3NmYiArIDFdO1xuICAgICAgICAgICAgQVRIX3Nbc2ZiXSA9IEZsb2F0Lk1BWF9WQUxVRTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IGVuZDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyZXEgPSBpICogc2FtcF9mcmVxIC8gKDIgKiAxOTIpO1xuICAgICAgICAgICAgICAgIHZhciBBVEhfZiA9IEFUSG1kY3QoZ2ZwLCBmcmVxKTtcbiAgICAgICAgICAgICAgICAvKiBmcmVxIGluIGtIeiAqL1xuICAgICAgICAgICAgICAgIEFUSF9zW3NmYl0gPSBNYXRoLm1pbihBVEhfc1tzZmJdLCBBVEhfZik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBBVEhfc1tzZmJdICo9IChnZmMuc2NhbGVmYWNfYmFuZC5zW3NmYiArIDFdIC0gZ2ZjLnNjYWxlZmFjX2JhbmQuc1tzZmJdKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IEVuY29kZXIuUFNGQjEyOyBzZmIrKykge1xuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gZ2ZjLnNjYWxlZmFjX2JhbmQucHNmYjEyW3NmYl07XG4gICAgICAgICAgICB2YXIgZW5kID0gZ2ZjLnNjYWxlZmFjX2JhbmQucHNmYjEyW3NmYiArIDFdO1xuICAgICAgICAgICAgQVRIX3BzZmIxMltzZmJdID0gRmxvYXQuTUFYX1ZBTFVFO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IHN0YXJ0OyBpIDwgZW5kOyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJlcSA9IGkgKiBzYW1wX2ZyZXEgLyAoMiAqIDE5Mik7XG4gICAgICAgICAgICAgICAgdmFyIEFUSF9mID0gQVRIbWRjdChnZnAsIGZyZXEpO1xuICAgICAgICAgICAgICAgIC8qIGZyZXEgaW4ga0h6ICovXG4gICAgICAgICAgICAgICAgQVRIX3BzZmIxMltzZmJdID0gTWF0aC5taW4oQVRIX3BzZmIxMltzZmJdLCBBVEhfZik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBub3Qgc3VyZSBhYm91dCB0aGUgZm9sbG93aW5nICovXG4gICAgICAgICAgICBBVEhfcHNmYjEyW3NmYl0gKj0gKGdmYy5zY2FsZWZhY19iYW5kLnNbMTNdIC0gZ2ZjLnNjYWxlZmFjX2JhbmQuc1sxMl0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgICogbm8tQVRIIG1vZGU6IHJlZHVjZSBBVEggdG8gLTIwMCBkQlxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGdmcC5ub0FUSCkge1xuICAgICAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgRW5jb2Rlci5TQk1BWF9sOyBzZmIrKykge1xuICAgICAgICAgICAgICAgIEFUSF9sW3NmYl0gPSAxRS0yMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IEVuY29kZXIuUFNGQjIxOyBzZmIrKykge1xuICAgICAgICAgICAgICAgIEFUSF9wc2ZiMjFbc2ZiXSA9IDFFLTIwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgRW5jb2Rlci5TQk1BWF9zOyBzZmIrKykge1xuICAgICAgICAgICAgICAgIEFUSF9zW3NmYl0gPSAxRS0yMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IEVuY29kZXIuUFNGQjEyOyBzZmIrKykge1xuICAgICAgICAgICAgICAgIEFUSF9wc2ZiMTJbc2ZiXSA9IDFFLTIwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgICogd29yayBpbiBwcm9ncmVzcywgZG9uJ3QgcmVseSBvbiBpdCB0b28gbXVjaFxuICAgICAgICAgKi9cbiAgICAgICAgZ2ZjLkFUSC5mbG9vciA9IDEwLiAqIE1hdGhfbG9nMTAoQVRIbWRjdChnZnAsIC0xLikpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGluaXRpYWxpemF0aW9uIGZvciBpdGVyYXRpb25fbG9vcFxuICAgICAqL1xuICAgIHRoaXMuaXRlcmF0aW9uX2luaXQgPSBmdW5jdGlvbiAoZ2ZwKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBsM19zaWRlID0gZ2ZjLmwzX3NpZGU7XG4gICAgICAgIHZhciBpO1xuXG4gICAgICAgIGlmIChnZmMuaXRlcmF0aW9uX2luaXRfaW5pdCA9PSAwKSB7XG4gICAgICAgICAgICBnZmMuaXRlcmF0aW9uX2luaXRfaW5pdCA9IDE7XG5cbiAgICAgICAgICAgIGwzX3NpZGUubWFpbl9kYXRhX2JlZ2luID0gMDtcbiAgICAgICAgICAgIGNvbXB1dGVfYXRoKGdmcCk7XG5cbiAgICAgICAgICAgIHBvdzQzWzBdID0gMC4wO1xuICAgICAgICAgICAgZm9yIChpID0gMTsgaSA8IFBSRUNBTENfU0laRTsgaSsrKVxuICAgICAgICAgICAgICAgIHBvdzQzW2ldID0gTWF0aC5wb3coaSwgNC4wIC8gMy4wKTtcblxuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IFBSRUNBTENfU0laRSAtIDE7IGkrKylcbiAgICAgICAgICAgICAgICBhZGo0M1tpXSA9ICgoaSArIDEpIC0gTWF0aC5wb3coXG4gICAgICAgICAgICAgICAgICAgIDAuNSAqIChwb3c0M1tpXSArIHBvdzQzW2kgKyAxXSksIDAuNzUpKTtcbiAgICAgICAgICAgIGFkajQzW2ldID0gMC41O1xuXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgUV9NQVg7IGkrKylcbiAgICAgICAgICAgICAgICBpcG93MjBbaV0gPSBNYXRoLnBvdygyLjAsIChpIC0gMjEwKSAqIC0wLjE4NzUpO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8PSBRX01BWCArIFFfTUFYMjsgaSsrKVxuICAgICAgICAgICAgICAgIHBvdzIwW2ldID0gTWF0aC5wb3coMi4wLCAoaSAtIDIxMCAtIFFfTUFYMikgKiAwLjI1KTtcblxuICAgICAgICAgICAgdGFrLmh1ZmZtYW5faW5pdChnZmMpO1xuXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIGJhc3MsIGFsdG8sIHRyZWJsZSwgc2ZiMjE7XG5cbiAgICAgICAgICAgICAgICBpID0gKGdmcC5leHBfbnNwc3l0dW5lID4+IDIpICYgNjM7XG4gICAgICAgICAgICAgICAgaWYgKGkgPj0gMzIpXG4gICAgICAgICAgICAgICAgICAgIGkgLT0gNjQ7XG4gICAgICAgICAgICAgICAgYmFzcyA9IE1hdGgucG93KDEwLCBpIC8gNC4wIC8gMTAuMCk7XG5cbiAgICAgICAgICAgICAgICBpID0gKGdmcC5leHBfbnNwc3l0dW5lID4+IDgpICYgNjM7XG4gICAgICAgICAgICAgICAgaWYgKGkgPj0gMzIpXG4gICAgICAgICAgICAgICAgICAgIGkgLT0gNjQ7XG4gICAgICAgICAgICAgICAgYWx0byA9IE1hdGgucG93KDEwLCBpIC8gNC4wIC8gMTAuMCk7XG5cbiAgICAgICAgICAgICAgICBpID0gKGdmcC5leHBfbnNwc3l0dW5lID4+IDE0KSAmIDYzO1xuICAgICAgICAgICAgICAgIGlmIChpID49IDMyKVxuICAgICAgICAgICAgICAgICAgICBpIC09IDY0O1xuICAgICAgICAgICAgICAgIHRyZWJsZSA9IE1hdGgucG93KDEwLCBpIC8gNC4wIC8gMTAuMCk7XG5cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIHRvIGJlIGNvbXBhdGlibGUgd2l0aCBOYW9raSdzIG9yaWdpbmFsIGNvZGUsIHRoZSBuZXh0IDYgYml0c1xuICAgICAgICAgICAgICAgICAqIGRlZmluZSBvbmx5IHRoZSBhbW91bnQgb2YgY2hhbmdpbmcgdHJlYmxlIGZvciBzZmIyMVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGkgPSAoZ2ZwLmV4cF9uc3BzeXR1bmUgPj4gMjApICYgNjM7XG4gICAgICAgICAgICAgICAgaWYgKGkgPj0gMzIpXG4gICAgICAgICAgICAgICAgICAgIGkgLT0gNjQ7XG4gICAgICAgICAgICAgICAgc2ZiMjEgPSB0cmVibGUgKiBNYXRoLnBvdygxMCwgaSAvIDQuMCAvIDEwLjApO1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBFbmNvZGVyLlNCTUFYX2w7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZjtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGkgPD0gNilcbiAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBiYXNzO1xuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChpIDw9IDEzKVxuICAgICAgICAgICAgICAgICAgICAgICAgZiA9IGFsdG87XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGkgPD0gMjApXG4gICAgICAgICAgICAgICAgICAgICAgICBmID0gdHJlYmxlO1xuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBmID0gc2ZiMjE7XG5cbiAgICAgICAgICAgICAgICAgICAgZ2ZjLm5zUHN5LmxvbmdmYWN0W2ldID0gZjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IEVuY29kZXIuU0JNQVhfczsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBmO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSA8PSA1KVxuICAgICAgICAgICAgICAgICAgICAgICAgZiA9IGJhc3M7XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGkgPD0gMTApXG4gICAgICAgICAgICAgICAgICAgICAgICBmID0gYWx0bztcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoaSA8PSAxMSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGYgPSB0cmVibGU7XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBzZmIyMTtcblxuICAgICAgICAgICAgICAgICAgICBnZmMubnNQc3kuc2hvcnRmYWN0W2ldID0gZjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBhbGxvY2F0ZSBiaXRzIGFtb25nIDIgY2hhbm5lbHMgYmFzZWQgb24gUEU8QlI+XG4gICAgICogbXQgNi85OTxCUj5cbiAgICAgKiBidWdmaXhlcyByaCA4LzAxOiBvZnRlbiBhbGxvY2F0ZWQgbW9yZSB0aGFuIHRoZSBhbGxvd2VkIDQwOTUgYml0c1xuICAgICAqL1xuICAgIHRoaXMub25fcGUgPSBmdW5jdGlvbiAoZ2ZwLCBwZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdfYml0cywgbWVhbl9iaXRzLCBnciwgY2JyKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciB0Yml0cyA9IDAsIGJpdHM7XG4gICAgICAgIHZhciBhZGRfYml0cyA9IG5ld19pbnQoMik7XG4gICAgICAgIHZhciBjaDtcblxuICAgICAgICAvKiBhbGxvY2F0ZSB0YXJnX2JpdHMgZm9yIGdyYW51bGUgKi9cbiAgICAgICAgdmFyIG1iID0gbmV3IE1lYW5CaXRzKHRiaXRzKTtcbiAgICAgICAgdmFyIGV4dHJhX2JpdHMgPSBydi5SZXN2TWF4Qml0cyhnZnAsIG1lYW5fYml0cywgbWIsIGNicik7XG4gICAgICAgIHRiaXRzID0gbWIuYml0cztcbiAgICAgICAgLyogbWF4aW11bSBhbGxvd2VkIGJpdHMgZm9yIHRoaXMgZ3JhbnVsZSAqL1xuICAgICAgICB2YXIgbWF4X2JpdHMgPSB0Yml0cyArIGV4dHJhX2JpdHM7XG4gICAgICAgIGlmIChtYXhfYml0cyA+IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9HUkFOVUxFKSB7XG4gICAgICAgICAgICAvLyBoYXJkIGxpbWl0IHBlciBncmFudWxlXG4gICAgICAgICAgICBtYXhfYml0cyA9IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9HUkFOVUxFO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoYml0cyA9IDAsIGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyArK2NoKSB7XG4gICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAgICAgKiBhbGxvY2F0ZSBiaXRzIGZvciBlYWNoIGNoYW5uZWxcbiAgICAgICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgICAgICB0YXJnX2JpdHNbY2hdID0gTWF0aC5taW4oTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0NIQU5ORUwsXG4gICAgICAgICAgICAgICAgdGJpdHMgLyBnZmMuY2hhbm5lbHNfb3V0KTtcblxuICAgICAgICAgICAgYWRkX2JpdHNbY2hdID0gMCB8ICh0YXJnX2JpdHNbY2hdICogcGVbZ3JdW2NoXSAvIDcwMC4wIC0gdGFyZ19iaXRzW2NoXSk7XG5cbiAgICAgICAgICAgIC8qIGF0IG1vc3QgaW5jcmVhc2UgYml0cyBieSAxLjUqYXZlcmFnZSAqL1xuICAgICAgICAgICAgaWYgKGFkZF9iaXRzW2NoXSA+IG1lYW5fYml0cyAqIDMgLyA0KVxuICAgICAgICAgICAgICAgIGFkZF9iaXRzW2NoXSA9IG1lYW5fYml0cyAqIDMgLyA0O1xuXG4gICAgICAgICAgICBpZiAoYWRkX2JpdHNbY2hdIDwgMClcbiAgICAgICAgICAgICAgICBhZGRfYml0c1tjaF0gPSAwO1xuXG4gICAgICAgICAgICBpZiAoYWRkX2JpdHNbY2hdICsgdGFyZ19iaXRzW2NoXSA+IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9DSEFOTkVMKVxuICAgICAgICAgICAgICAgIGFkZF9iaXRzW2NoXSA9IE1hdGgubWF4KDAsXG4gICAgICAgICAgICAgICAgICAgIExhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9DSEFOTkVMIC0gdGFyZ19iaXRzW2NoXSk7XG5cbiAgICAgICAgICAgIGJpdHMgKz0gYWRkX2JpdHNbY2hdO1xuICAgICAgICB9XG4gICAgICAgIGlmIChiaXRzID4gZXh0cmFfYml0cykge1xuICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgKytjaCkge1xuICAgICAgICAgICAgICAgIGFkZF9iaXRzW2NoXSA9IGV4dHJhX2JpdHMgKiBhZGRfYml0c1tjaF0gLyBiaXRzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgKytjaCkge1xuICAgICAgICAgICAgdGFyZ19iaXRzW2NoXSArPSBhZGRfYml0c1tjaF07XG4gICAgICAgICAgICBleHRyYV9iaXRzIC09IGFkZF9iaXRzW2NoXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoYml0cyA9IDAsIGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyArK2NoKSB7XG4gICAgICAgICAgICBiaXRzICs9IHRhcmdfYml0c1tjaF07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJpdHMgPiBMYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfR1JBTlVMRSkge1xuICAgICAgICAgICAgdmFyIHN1bSA9IDA7XG4gICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyArK2NoKSB7XG4gICAgICAgICAgICAgICAgdGFyZ19iaXRzW2NoXSAqPSBMYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfR1JBTlVMRTtcbiAgICAgICAgICAgICAgICB0YXJnX2JpdHNbY2hdIC89IGJpdHM7XG4gICAgICAgICAgICAgICAgc3VtICs9IHRhcmdfYml0c1tjaF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbWF4X2JpdHM7XG4gICAgfVxuXG4gICAgdGhpcy5yZWR1Y2Vfc2lkZSA9IGZ1bmN0aW9uICh0YXJnX2JpdHMsIG1zX2VuZXJfcmF0aW8sIG1lYW5fYml0cywgbWF4X2JpdHMpIHtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBtc19lbmVyX3JhdGlvID0gMDogYWxsb2NhdGUgNjYvMzMgbWlkL3NpZGUgZmFjPS4zMyBtc19lbmVyX3JhdGlvID0uNTpcbiAgICAgICAgICogYWxsb2NhdGUgNTAvNTAgbWlkL3NpZGUgZmFjPSAwXG4gICAgICAgICAqL1xuICAgICAgICAvKiA3NS8yNSBzcGxpdCBpcyBmYWM9LjUgKi9cbiAgICAgICAgdmFyIGZhYyA9IC4zMyAqICguNSAtIG1zX2VuZXJfcmF0aW8pIC8gLjU7XG4gICAgICAgIGlmIChmYWMgPCAwKVxuICAgICAgICAgICAgZmFjID0gMDtcbiAgICAgICAgaWYgKGZhYyA+IC41KVxuICAgICAgICAgICAgZmFjID0gLjU7XG5cbiAgICAgICAgLyogbnVtYmVyIG9mIGJpdHMgdG8gbW92ZSBmcm9tIHNpZGUgY2hhbm5lbCB0byBtaWQgY2hhbm5lbCAqL1xuICAgICAgICAvKiBtb3ZlX2JpdHMgPSBmYWMqdGFyZ19iaXRzWzFdOyAqL1xuICAgICAgICB2YXIgbW92ZV9iaXRzID0gMCB8IChmYWMgKiAuNSAqICh0YXJnX2JpdHNbMF0gKyB0YXJnX2JpdHNbMV0pKTtcblxuICAgICAgICBpZiAobW92ZV9iaXRzID4gTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0NIQU5ORUwgLSB0YXJnX2JpdHNbMF0pIHtcbiAgICAgICAgICAgIG1vdmVfYml0cyA9IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9DSEFOTkVMIC0gdGFyZ19iaXRzWzBdO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtb3ZlX2JpdHMgPCAwKVxuICAgICAgICAgICAgbW92ZV9iaXRzID0gMDtcblxuICAgICAgICBpZiAodGFyZ19iaXRzWzFdID49IDEyNSkge1xuICAgICAgICAgICAgLyogZG9udCByZWR1Y2Ugc2lkZSBjaGFubmVsIGJlbG93IDEyNSBiaXRzICovXG4gICAgICAgICAgICBpZiAodGFyZ19iaXRzWzFdIC0gbW92ZV9iaXRzID4gMTI1KSB7XG5cbiAgICAgICAgICAgICAgICAvKiBpZiBtaWQgY2hhbm5lbCBhbHJlYWR5IGhhcyAyeCBtb3JlIHRoYW4gYXZlcmFnZSwgZG9udCBib3RoZXIgKi9cbiAgICAgICAgICAgICAgICAvKiBtZWFuX2JpdHMgPSBiaXRzIHBlciBncmFudWxlIChmb3IgYm90aCBjaGFubmVscykgKi9cbiAgICAgICAgICAgICAgICBpZiAodGFyZ19iaXRzWzBdIDwgbWVhbl9iaXRzKVxuICAgICAgICAgICAgICAgICAgICB0YXJnX2JpdHNbMF0gKz0gbW92ZV9iaXRzO1xuICAgICAgICAgICAgICAgIHRhcmdfYml0c1sxXSAtPSBtb3ZlX2JpdHM7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRhcmdfYml0c1swXSArPSB0YXJnX2JpdHNbMV0gLSAxMjU7XG4gICAgICAgICAgICAgICAgdGFyZ19iaXRzWzFdID0gMTI1O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgbW92ZV9iaXRzID0gdGFyZ19iaXRzWzBdICsgdGFyZ19iaXRzWzFdO1xuICAgICAgICBpZiAobW92ZV9iaXRzID4gbWF4X2JpdHMpIHtcbiAgICAgICAgICAgIHRhcmdfYml0c1swXSA9IChtYXhfYml0cyAqIHRhcmdfYml0c1swXSkgLyBtb3ZlX2JpdHM7XG4gICAgICAgICAgICB0YXJnX2JpdHNbMV0gPSAobWF4X2JpdHMgKiB0YXJnX2JpdHNbMV0pIC8gbW92ZV9iaXRzO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqICBSb2JlcnQgSGVnZW1hbm4gMjAwMS0wNC0yNzpcbiAgICAgKiAgdGhpcyBhZGp1c3RzIHRoZSBBVEgsIGtlZXBpbmcgdGhlIG9yaWdpbmFsIG5vaXNlIGZsb29yXG4gICAgICogIGFmZmVjdHMgdGhlIGhpZ2hlciBmcmVxdWVuY2llcyBtb3JlIHRoYW4gdGhlIGxvd2VyIG9uZXNcbiAgICAgKi9cbiAgICB0aGlzLmF0aEFkanVzdCA9IGZ1bmN0aW9uIChhLCB4LCBhdGhGbG9vcikge1xuICAgICAgICAvKlxuICAgICAgICAgKiB3b3JrIGluIHByb2dyZXNzXG4gICAgICAgICAqL1xuICAgICAgICB2YXIgbyA9IDkwLjMwODczMzYyO1xuICAgICAgICB2YXIgcCA9IDk0LjgyNDQ0ODYzO1xuICAgICAgICB2YXIgdSA9IFV0aWwuRkFTVF9MT0cxMF9YKHgsIDEwLjApO1xuICAgICAgICB2YXIgdiA9IGEgKiBhO1xuICAgICAgICB2YXIgdyA9IDAuMDtcbiAgICAgICAgdSAtPSBhdGhGbG9vcjtcbiAgICAgICAgLyogdW5kbyBzY2FsaW5nICovXG4gICAgICAgIGlmICh2ID4gMUUtMjApXG4gICAgICAgICAgICB3ID0gMS4gKyBVdGlsLkZBU1RfTE9HMTBfWCh2LCAxMC4wIC8gbyk7XG4gICAgICAgIGlmICh3IDwgMClcbiAgICAgICAgICAgIHcgPSAwLjtcbiAgICAgICAgdSAqPSB3O1xuICAgICAgICB1ICs9IGF0aEZsb29yICsgbyAtIHA7XG4gICAgICAgIC8qIHJlZG8gc2NhbGluZyAqL1xuXG4gICAgICAgIHJldHVybiBNYXRoLnBvdygxMC4sIDAuMSAqIHUpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDYWxjdWxhdGUgdGhlIGFsbG93ZWQgZGlzdG9ydGlvbiBmb3IgZWFjaCBzY2FsZWZhY3RvciBiYW5kLCBhcyBkZXRlcm1pbmVkXG4gICAgICogYnkgdGhlIHBzeWNob2Fjb3VzdGljIG1vZGVsLiB4bWluKHNiKSA9IHJhdGlvKHNiKSAqIGVuKHNiKSAvIGJ3KHNiKVxuICAgICAqXG4gICAgICogcmV0dXJucyBudW1iZXIgb2Ygc2ZiJ3Mgd2l0aCBlbmVyZ3kgPiBBVEhcbiAgICAgKi9cbiAgICB0aGlzLmNhbGNfeG1pbiA9IGZ1bmN0aW9uIChnZnAsIHJhdGlvLCBjb2RfaW5mbywgcHhtaW4pIHtcbiAgICAgICAgdmFyIHB4bWluUG9zID0gMDtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGdzZmIsIGogPSAwLCBhdGhfb3ZlciA9IDA7XG4gICAgICAgIHZhciBBVEggPSBnZmMuQVRIO1xuICAgICAgICB2YXIgeHIgPSBjb2RfaW5mby54cjtcbiAgICAgICAgdmFyIGVuYWJsZV9hdGhhYV9maXggPSAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9tdHJoKSA/IDEgOiAwO1xuICAgICAgICB2YXIgbWFza2luZ19sb3dlciA9IGdmYy5tYXNraW5nX2xvd2VyO1xuXG4gICAgICAgIGlmIChnZnAuVkJSID09IFZick1vZGUudmJyX210cmggfHwgZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9tdCkge1xuICAgICAgICAgICAgLyogd2FzIGFscmVhZHkgZG9uZSBpbiBQU1ktTW9kZWwgKi9cbiAgICAgICAgICAgIG1hc2tpbmdfbG93ZXIgPSAxLjA7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGdzZmIgPSAwOyBnc2ZiIDwgY29kX2luZm8ucHN5X2xtYXg7IGdzZmIrKykge1xuICAgICAgICAgICAgdmFyIGVuMCwgeG1pbjtcbiAgICAgICAgICAgIHZhciByaDEsIHJoMjtcbiAgICAgICAgICAgIHZhciB3aWR0aCwgbDtcblxuICAgICAgICAgICAgaWYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfcmggfHwgZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9tdHJoKVxuICAgICAgICAgICAgICAgIHhtaW4gPSBhdGhBZGp1c3QoQVRILmFkanVzdCwgQVRILmxbZ3NmYl0sIEFUSC5mbG9vcik7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgeG1pbiA9IEFUSC5hZGp1c3QgKiBBVEgubFtnc2ZiXTtcblxuICAgICAgICAgICAgd2lkdGggPSBjb2RfaW5mby53aWR0aFtnc2ZiXTtcbiAgICAgICAgICAgIHJoMSA9IHhtaW4gLyB3aWR0aDtcbiAgICAgICAgICAgIHJoMiA9IERCTF9FUFNJTE9OO1xuICAgICAgICAgICAgbCA9IHdpZHRoID4+IDE7XG4gICAgICAgICAgICBlbjAgPSAwLjA7XG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgdmFyIHhhLCB4YjtcbiAgICAgICAgICAgICAgICB4YSA9IHhyW2pdICogeHJbal07XG4gICAgICAgICAgICAgICAgZW4wICs9IHhhO1xuICAgICAgICAgICAgICAgIHJoMiArPSAoeGEgPCByaDEpID8geGEgOiByaDE7XG4gICAgICAgICAgICAgICAgaisrO1xuICAgICAgICAgICAgICAgIHhiID0geHJbal0gKiB4cltqXTtcbiAgICAgICAgICAgICAgICBlbjAgKz0geGI7XG4gICAgICAgICAgICAgICAgcmgyICs9ICh4YiA8IHJoMSkgPyB4YiA6IHJoMTtcbiAgICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICB9IHdoaWxlICgtLWwgPiAwKTtcbiAgICAgICAgICAgIGlmIChlbjAgPiB4bWluKVxuICAgICAgICAgICAgICAgIGF0aF9vdmVyKys7XG5cbiAgICAgICAgICAgIGlmIChnc2ZiID09IEVuY29kZXIuU0JQU1lfbCkge1xuICAgICAgICAgICAgICAgIHZhciB4ID0geG1pbiAqIGdmYy5uc1BzeS5sb25nZmFjdFtnc2ZiXTtcbiAgICAgICAgICAgICAgICBpZiAocmgyIDwgeCkge1xuICAgICAgICAgICAgICAgICAgICByaDIgPSB4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlbmFibGVfYXRoYWFfZml4ICE9IDApIHtcbiAgICAgICAgICAgICAgICB4bWluID0gcmgyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFnZnAuQVRIb25seSkge1xuICAgICAgICAgICAgICAgIHZhciBlID0gcmF0aW8uZW4ubFtnc2ZiXTtcbiAgICAgICAgICAgICAgICBpZiAoZSA+IDAuMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgeDtcbiAgICAgICAgICAgICAgICAgICAgeCA9IGVuMCAqIHJhdGlvLnRobS5sW2dzZmJdICogbWFza2luZ19sb3dlciAvIGU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbmFibGVfYXRoYWFfZml4ICE9IDApXG4gICAgICAgICAgICAgICAgICAgICAgICB4ICo9IGdmYy5uc1BzeS5sb25nZmFjdFtnc2ZiXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHhtaW4gPCB4KVxuICAgICAgICAgICAgICAgICAgICAgICAgeG1pbiA9IHg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGVuYWJsZV9hdGhhYV9maXggIT0gMClcbiAgICAgICAgICAgICAgICBweG1pbltweG1pblBvcysrXSA9IHhtaW47XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgcHhtaW5bcHhtaW5Qb3MrK10gPSB4bWluICogZ2ZjLm5zUHN5LmxvbmdmYWN0W2dzZmJdO1xuICAgICAgICB9XG4gICAgICAgIC8qIGVuZCBvZiBsb25nIGJsb2NrIGxvb3AgKi9cblxuICAgICAgICAvKiB1c2UgdGhpcyBmdW5jdGlvbiB0byBkZXRlcm1pbmUgdGhlIGhpZ2hlc3Qgbm9uLXplcm8gY29lZmYgKi9cbiAgICAgICAgdmFyIG1heF9ub256ZXJvID0gNTc1O1xuICAgICAgICBpZiAoY29kX2luZm8uYmxvY2tfdHlwZSAhPSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgIC8vIE5PUk0sIFNUQVJUIG9yIFNUT1AgdHlwZSwgYnV0IG5vdCBTSE9SVFxuICAgICAgICAgICAgdmFyIGsgPSA1NzY7XG4gICAgICAgICAgICB3aGlsZSAoay0tICE9IDAgJiYgQml0U3RyZWFtLkVRKHhyW2tdLCAwKSkge1xuICAgICAgICAgICAgICAgIG1heF9ub256ZXJvID0gaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb2RfaW5mby5tYXhfbm9uemVyb19jb2VmZiA9IG1heF9ub256ZXJvO1xuXG4gICAgICAgIGZvciAodmFyIHNmYiA9IGNvZF9pbmZvLnNmYl9zbWluOyBnc2ZiIDwgY29kX2luZm8ucHN5bWF4OyBzZmIrKywgZ3NmYiArPSAzKSB7XG4gICAgICAgICAgICB2YXIgd2lkdGgsIGI7XG4gICAgICAgICAgICB2YXIgdG1wQVRIO1xuICAgICAgICAgICAgaWYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfcmggfHwgZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9tdHJoKVxuICAgICAgICAgICAgICAgIHRtcEFUSCA9IGF0aEFkanVzdChBVEguYWRqdXN0LCBBVEguc1tzZmJdLCBBVEguZmxvb3IpO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIHRtcEFUSCA9IEFUSC5hZGp1c3QgKiBBVEguc1tzZmJdO1xuXG4gICAgICAgICAgICB3aWR0aCA9IGNvZF9pbmZvLndpZHRoW2dzZmJdO1xuICAgICAgICAgICAgZm9yIChiID0gMDsgYiA8IDM7IGIrKykge1xuICAgICAgICAgICAgICAgIHZhciBlbjAgPSAwLjAsIHhtaW47XG4gICAgICAgICAgICAgICAgdmFyIHJoMSwgcmgyO1xuICAgICAgICAgICAgICAgIHZhciBsID0gd2lkdGggPj4gMTtcblxuICAgICAgICAgICAgICAgIHJoMSA9IHRtcEFUSCAvIHdpZHRoO1xuICAgICAgICAgICAgICAgIHJoMiA9IERCTF9FUFNJTE9OO1xuICAgICAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHhhLCB4YjtcbiAgICAgICAgICAgICAgICAgICAgeGEgPSB4cltqXSAqIHhyW2pdO1xuICAgICAgICAgICAgICAgICAgICBlbjAgKz0geGE7XG4gICAgICAgICAgICAgICAgICAgIHJoMiArPSAoeGEgPCByaDEpID8geGEgOiByaDE7XG4gICAgICAgICAgICAgICAgICAgIGorKztcbiAgICAgICAgICAgICAgICAgICAgeGIgPSB4cltqXSAqIHhyW2pdO1xuICAgICAgICAgICAgICAgICAgICBlbjAgKz0geGI7XG4gICAgICAgICAgICAgICAgICAgIHJoMiArPSAoeGIgPCByaDEpID8geGIgOiByaDE7XG4gICAgICAgICAgICAgICAgICAgIGorKztcbiAgICAgICAgICAgICAgICB9IHdoaWxlICgtLWwgPiAwKTtcbiAgICAgICAgICAgICAgICBpZiAoZW4wID4gdG1wQVRIKVxuICAgICAgICAgICAgICAgICAgICBhdGhfb3ZlcisrO1xuICAgICAgICAgICAgICAgIGlmIChzZmIgPT0gRW5jb2Rlci5TQlBTWV9zKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB4ID0gdG1wQVRIICogZ2ZjLm5zUHN5LnNob3J0ZmFjdFtzZmJdO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmgyIDwgeCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmgyID0geDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZW5hYmxlX2F0aGFhX2ZpeCAhPSAwKVxuICAgICAgICAgICAgICAgICAgICB4bWluID0gcmgyO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgeG1pbiA9IHRtcEFUSDtcblxuICAgICAgICAgICAgICAgIGlmICghZ2ZwLkFUSG9ubHkgJiYgIWdmcC5BVEhzaG9ydCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZSA9IHJhdGlvLmVuLnNbc2ZiXVtiXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUgPiAwLjApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB4O1xuICAgICAgICAgICAgICAgICAgICAgICAgeCA9IGVuMCAqIHJhdGlvLnRobS5zW3NmYl1bYl0gKiBtYXNraW5nX2xvd2VyIC8gZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbmFibGVfYXRoYWFfZml4ICE9IDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeCAqPSBnZmMubnNQc3kuc2hvcnRmYWN0W3NmYl07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoeG1pbiA8IHgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgeG1pbiA9IHg7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGVuYWJsZV9hdGhhYV9maXggIT0gMClcbiAgICAgICAgICAgICAgICAgICAgcHhtaW5bcHhtaW5Qb3MrK10gPSB4bWluO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgcHhtaW5bcHhtaW5Qb3MrK10gPSB4bWluICogZ2ZjLm5zUHN5LnNob3J0ZmFjdFtzZmJdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogYiAqL1xuICAgICAgICAgICAgaWYgKGdmcC51c2VUZW1wb3JhbCkge1xuICAgICAgICAgICAgICAgIGlmIChweG1pbltweG1pblBvcyAtIDNdID4gcHhtaW5bcHhtaW5Qb3MgLSAzICsgMV0pXG4gICAgICAgICAgICAgICAgICAgIHB4bWluW3B4bWluUG9zIC0gMyArIDFdICs9IChweG1pbltweG1pblBvcyAtIDNdIC0gcHhtaW5bcHhtaW5Qb3MgLSAzICsgMV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAqIGdmYy5kZWNheTtcbiAgICAgICAgICAgICAgICBpZiAocHhtaW5bcHhtaW5Qb3MgLSAzICsgMV0gPiBweG1pbltweG1pblBvcyAtIDMgKyAyXSlcbiAgICAgICAgICAgICAgICAgICAgcHhtaW5bcHhtaW5Qb3MgLSAzICsgMl0gKz0gKHB4bWluW3B4bWluUG9zIC0gMyArIDFdIC0gcHhtaW5bcHhtaW5Qb3MgLSAzICsgMl0pXG4gICAgICAgICAgICAgICAgICAgICAgICAqIGdmYy5kZWNheTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiBlbmQgb2Ygc2hvcnQgYmxvY2sgc2ZiIGxvb3AgKi9cblxuICAgICAgICByZXR1cm4gYXRoX292ZXI7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIFN0YXJ0TGluZShqKSB7XG4gICAgICAgIHRoaXMucyA9IGo7XG4gICAgfVxuXG4gICAgdGhpcy5jYWxjX25vaXNlX2NvcmUgPSBmdW5jdGlvbiAoY29kX2luZm8sIHN0YXJ0bGluZSwgbCwgc3RlcCkge1xuICAgICAgICB2YXIgbm9pc2UgPSAwO1xuICAgICAgICB2YXIgaiA9IHN0YXJ0bGluZS5zO1xuICAgICAgICB2YXIgaXggPSBjb2RfaW5mby5sM19lbmM7XG5cbiAgICAgICAgaWYgKGogPiBjb2RfaW5mby5jb3VudDEpIHtcbiAgICAgICAgICAgIHdoaWxlICgobC0tKSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRlbXA7XG4gICAgICAgICAgICAgICAgdGVtcCA9IGNvZF9pbmZvLnhyW2pdO1xuICAgICAgICAgICAgICAgIGorKztcbiAgICAgICAgICAgICAgICBub2lzZSArPSB0ZW1wICogdGVtcDtcbiAgICAgICAgICAgICAgICB0ZW1wID0gY29kX2luZm8ueHJbal07XG4gICAgICAgICAgICAgICAgaisrO1xuICAgICAgICAgICAgICAgIG5vaXNlICs9IHRlbXAgKiB0ZW1wO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGogPiBjb2RfaW5mby5iaWdfdmFsdWVzKSB7XG4gICAgICAgICAgICB2YXIgaXgwMSA9IG5ld19mbG9hdCgyKTtcbiAgICAgICAgICAgIGl4MDFbMF0gPSAwO1xuICAgICAgICAgICAgaXgwMVsxXSA9IHN0ZXA7XG4gICAgICAgICAgICB3aGlsZSAoKGwtLSkgIT0gMCkge1xuICAgICAgICAgICAgICAgIHZhciB0ZW1wO1xuICAgICAgICAgICAgICAgIHRlbXAgPSBNYXRoLmFicyhjb2RfaW5mby54cltqXSkgLSBpeDAxW2l4W2pdXTtcbiAgICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICAgICAgbm9pc2UgKz0gdGVtcCAqIHRlbXA7XG4gICAgICAgICAgICAgICAgdGVtcCA9IE1hdGguYWJzKGNvZF9pbmZvLnhyW2pdKSAtIGl4MDFbaXhbal1dO1xuICAgICAgICAgICAgICAgIGorKztcbiAgICAgICAgICAgICAgICBub2lzZSArPSB0ZW1wICogdGVtcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHdoaWxlICgobC0tKSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRlbXA7XG4gICAgICAgICAgICAgICAgdGVtcCA9IE1hdGguYWJzKGNvZF9pbmZvLnhyW2pdKSAtIHBvdzQzW2l4W2pdXSAqIHN0ZXA7XG4gICAgICAgICAgICAgICAgaisrO1xuICAgICAgICAgICAgICAgIG5vaXNlICs9IHRlbXAgKiB0ZW1wO1xuICAgICAgICAgICAgICAgIHRlbXAgPSBNYXRoLmFicyhjb2RfaW5mby54cltqXSkgLSBwb3c0M1tpeFtqXV0gKiBzdGVwO1xuICAgICAgICAgICAgICAgIGorKztcbiAgICAgICAgICAgICAgICBub2lzZSArPSB0ZW1wICogdGVtcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHN0YXJ0bGluZS5zID0gajtcbiAgICAgICAgcmV0dXJuIG5vaXNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIDxQUkU+XG4gICAgICogLW9vIGRCICA9PiAgLTEuMDBcbiAgICAgKiAtIDYgZEIgID0+ICAtMC45N1xuICAgICAqIC0gMyBkQiAgPT4gIC0wLjgwXG4gICAgICogLSAyIGRCICA9PiAgLTAuNjRcbiAgICAgKiAtIDEgZEIgID0+ICAtMC4zOFxuICAgICAqICAgMCBkQiAgPT4gICAwLjAwXG4gICAgICogKyAxIGRCICA9PiAgKzAuNDlcbiAgICAgKiArIDIgZEIgID0+ICArMS4wNlxuICAgICAqICsgMyBkQiAgPT4gICsxLjY4XG4gICAgICogKyA2IGRCICA9PiAgKzMuNjlcbiAgICAgKiArMTAgZEIgID0+ICArNi40NVxuICAgICAqIDwvUFJFPlxuICAgICAqL1xuICAgIHRoaXMuY2FsY19ub2lzZSA9IGZ1bmN0aW9uIChjb2RfaW5mbywgbDNfeG1pbiwgZGlzdG9ydCwgcmVzLCBwcmV2X25vaXNlKSB7XG4gICAgICAgIHZhciBkaXN0b3J0UG9zID0gMDtcbiAgICAgICAgdmFyIGwzX3htaW5Qb3MgPSAwO1xuICAgICAgICB2YXIgc2ZiLCBsLCBvdmVyID0gMDtcbiAgICAgICAgdmFyIG92ZXJfbm9pc2VfZGIgPSAwO1xuICAgICAgICAvKiAwIGRCIHJlbGF0aXZlIHRvIG1hc2tpbmcgKi9cbiAgICAgICAgdmFyIHRvdF9ub2lzZV9kYiA9IDA7XG4gICAgICAgIC8qIC0yMDAgZEIgcmVsYXRpdmUgdG8gbWFza2luZyAqL1xuICAgICAgICB2YXIgbWF4X25vaXNlID0gLTIwLjA7XG4gICAgICAgIHZhciBqID0gMDtcbiAgICAgICAgdmFyIHNjYWxlZmFjID0gY29kX2luZm8uc2NhbGVmYWM7XG4gICAgICAgIHZhciBzY2FsZWZhY1BvcyA9IDA7XG5cbiAgICAgICAgcmVzLm92ZXJfU1NEID0gMDtcblxuICAgICAgICBmb3IgKHNmYiA9IDA7IHNmYiA8IGNvZF9pbmZvLnBzeW1heDsgc2ZiKyspIHtcbiAgICAgICAgICAgIHZhciBzID0gY29kX2luZm8uZ2xvYmFsX2dhaW5cbiAgICAgICAgICAgICAgICAtICgoKHNjYWxlZmFjW3NjYWxlZmFjUG9zKytdKSArIChjb2RfaW5mby5wcmVmbGFnICE9IDAgPyBwcmV0YWJbc2ZiXVxuICAgICAgICAgICAgICAgICAgICA6IDApKSA8PCAoY29kX2luZm8uc2NhbGVmYWNfc2NhbGUgKyAxKSlcbiAgICAgICAgICAgICAgICAtIGNvZF9pbmZvLnN1YmJsb2NrX2dhaW5bY29kX2luZm8ud2luZG93W3NmYl1dICogODtcbiAgICAgICAgICAgIHZhciBub2lzZSA9IDAuMDtcblxuICAgICAgICAgICAgaWYgKHByZXZfbm9pc2UgIT0gbnVsbCAmJiAocHJldl9ub2lzZS5zdGVwW3NmYl0gPT0gcykpIHtcblxuICAgICAgICAgICAgICAgIC8qIHVzZSBwcmV2aW91c2x5IGNvbXB1dGVkIHZhbHVlcyAqL1xuICAgICAgICAgICAgICAgIG5vaXNlID0gcHJldl9ub2lzZS5ub2lzZVtzZmJdO1xuICAgICAgICAgICAgICAgIGogKz0gY29kX2luZm8ud2lkdGhbc2ZiXTtcbiAgICAgICAgICAgICAgICBkaXN0b3J0W2Rpc3RvcnRQb3MrK10gPSBub2lzZSAvIGwzX3htaW5bbDNfeG1pblBvcysrXTtcblxuICAgICAgICAgICAgICAgIG5vaXNlID0gcHJldl9ub2lzZS5ub2lzZV9sb2dbc2ZiXTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RlcCA9IFBPVzIwKHMpO1xuICAgICAgICAgICAgICAgIGwgPSBjb2RfaW5mby53aWR0aFtzZmJdID4+IDE7XG5cbiAgICAgICAgICAgICAgICBpZiAoKGogKyBjb2RfaW5mby53aWR0aFtzZmJdKSA+IGNvZF9pbmZvLm1heF9ub256ZXJvX2NvZWZmKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1c2VmdWxsc2l6ZTtcbiAgICAgICAgICAgICAgICAgICAgdXNlZnVsbHNpemUgPSBjb2RfaW5mby5tYXhfbm9uemVyb19jb2VmZiAtIGogKyAxO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2VmdWxsc2l6ZSA+IDApXG4gICAgICAgICAgICAgICAgICAgICAgICBsID0gdXNlZnVsbHNpemUgPj4gMTtcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgbCA9IDA7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgdmFyIHNsID0gbmV3IFN0YXJ0TGluZShqKTtcbiAgICAgICAgICAgICAgICBub2lzZSA9IHRoaXMuY2FsY19ub2lzZV9jb3JlKGNvZF9pbmZvLCBzbCwgbCwgc3RlcCk7XG4gICAgICAgICAgICAgICAgaiA9IHNsLnM7XG5cbiAgICAgICAgICAgICAgICBpZiAocHJldl9ub2lzZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8qIHNhdmUgbm9pc2UgdmFsdWVzICovXG4gICAgICAgICAgICAgICAgICAgIHByZXZfbm9pc2Uuc3RlcFtzZmJdID0gcztcbiAgICAgICAgICAgICAgICAgICAgcHJldl9ub2lzZS5ub2lzZVtzZmJdID0gbm9pc2U7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgbm9pc2UgPSBkaXN0b3J0W2Rpc3RvcnRQb3MrK10gPSBub2lzZSAvIGwzX3htaW5bbDNfeG1pblBvcysrXTtcblxuICAgICAgICAgICAgICAgIC8qIG11bHRpcGx5aW5nIGhlcmUgaXMgYWRkaW5nIGluIGRCLCBidXQgY2FuIG92ZXJmbG93ICovXG4gICAgICAgICAgICAgICAgbm9pc2UgPSBVdGlsLkZBU1RfTE9HMTAoTWF0aC5tYXgobm9pc2UsIDFFLTIwKSk7XG5cbiAgICAgICAgICAgICAgICBpZiAocHJldl9ub2lzZSAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8qIHNhdmUgbm9pc2UgdmFsdWVzICovXG4gICAgICAgICAgICAgICAgICAgIHByZXZfbm9pc2Uubm9pc2VfbG9nW3NmYl0gPSBub2lzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChwcmV2X25vaXNlICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICAvKiBzYXZlIG5vaXNlIHZhbHVlcyAqL1xuICAgICAgICAgICAgICAgIHByZXZfbm9pc2UuZ2xvYmFsX2dhaW4gPSBjb2RfaW5mby5nbG9iYWxfZ2FpbjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdG90X25vaXNlX2RiICs9IG5vaXNlO1xuXG4gICAgICAgICAgICBpZiAobm9pc2UgPiAwLjApIHtcbiAgICAgICAgICAgICAgICB2YXIgdG1wO1xuXG4gICAgICAgICAgICAgICAgdG1wID0gTWF0aC5tYXgoMCB8IChub2lzZSAqIDEwICsgLjUpLCAxKTtcbiAgICAgICAgICAgICAgICByZXMub3Zlcl9TU0QgKz0gdG1wICogdG1wO1xuXG4gICAgICAgICAgICAgICAgb3ZlcisrO1xuICAgICAgICAgICAgICAgIC8qIG11bHRpcGx5aW5nIGhlcmUgaXMgYWRkaW5nIGluIGRCIC1idXQgY2FuIG92ZXJmbG93ICovXG4gICAgICAgICAgICAgICAgLyogb3Zlcl9ub2lzZSAqPSBub2lzZTsgKi9cbiAgICAgICAgICAgICAgICBvdmVyX25vaXNlX2RiICs9IG5vaXNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbWF4X25vaXNlID0gTWF0aC5tYXgobWF4X25vaXNlLCBub2lzZSk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIHJlcy5vdmVyX2NvdW50ID0gb3ZlcjtcbiAgICAgICAgcmVzLnRvdF9ub2lzZSA9IHRvdF9ub2lzZV9kYjtcbiAgICAgICAgcmVzLm92ZXJfbm9pc2UgPSBvdmVyX25vaXNlX2RiO1xuICAgICAgICByZXMubWF4X25vaXNlID0gbWF4X25vaXNlO1xuXG4gICAgICAgIHJldHVybiBvdmVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHVwZGF0ZXMgcGxvdHRpbmcgZGF0YVxuICAgICAqXG4gICAgICogTWFyayBUYXlsb3IgMjAwMC0/Py0/P1xuICAgICAqXG4gICAgICogUm9iZXJ0IEhlZ2VtYW5uOiBtb3ZlZCBub2lzZS9kaXN0b3J0aW9uIGNhbGMgaW50byBpdFxuICAgICAqL1xuICAgIHRoaXMuc2V0X3BpbmZvID0gZnVuY3Rpb24gKGdmcCwgY29kX2luZm8sIHJhdGlvLCBnciwgY2gpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIHNmYiwgc2ZiMjtcbiAgICAgICAgdmFyIGw7XG4gICAgICAgIHZhciBlbjAsIGVuMTtcbiAgICAgICAgdmFyIGlmcXN0ZXAgPSAoY29kX2luZm8uc2NhbGVmYWNfc2NhbGUgPT0gMCkgPyAuNSA6IDEuMDtcbiAgICAgICAgdmFyIHNjYWxlZmFjID0gY29kX2luZm8uc2NhbGVmYWM7XG5cbiAgICAgICAgdmFyIGwzX3htaW4gPSBuZXdfZmxvYXQoTDNTaWRlLlNGQk1BWCk7XG4gICAgICAgIHZhciB4ZnNmID0gbmV3X2Zsb2F0KEwzU2lkZS5TRkJNQVgpO1xuICAgICAgICB2YXIgbm9pc2UgPSBuZXcgQ2FsY05vaXNlUmVzdWx0KCk7XG5cbiAgICAgICAgY2FsY194bWluKGdmcCwgcmF0aW8sIGNvZF9pbmZvLCBsM194bWluKTtcbiAgICAgICAgY2FsY19ub2lzZShjb2RfaW5mbywgbDNfeG1pbiwgeGZzZiwgbm9pc2UsIG51bGwpO1xuXG4gICAgICAgIHZhciBqID0gMDtcbiAgICAgICAgc2ZiMiA9IGNvZF9pbmZvLnNmYl9sbWF4O1xuICAgICAgICBpZiAoY29kX2luZm8uYmxvY2tfdHlwZSAhPSBFbmNvZGVyLlNIT1JUX1RZUEVcbiAgICAgICAgICAgICYmIDAgPT0gY29kX2luZm8ubWl4ZWRfYmxvY2tfZmxhZylcbiAgICAgICAgICAgIHNmYjIgPSAyMjtcbiAgICAgICAgZm9yIChzZmIgPSAwOyBzZmIgPCBzZmIyOyBzZmIrKykge1xuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gZ2ZjLnNjYWxlZmFjX2JhbmQubFtzZmJdO1xuICAgICAgICAgICAgdmFyIGVuZCA9IGdmYy5zY2FsZWZhY19iYW5kLmxbc2ZiICsgMV07XG4gICAgICAgICAgICB2YXIgYncgPSBlbmQgLSBzdGFydDtcbiAgICAgICAgICAgIGZvciAoZW4wID0gMC4wOyBqIDwgZW5kOyBqKyspXG4gICAgICAgICAgICAgICAgZW4wICs9IGNvZF9pbmZvLnhyW2pdICogY29kX2luZm8ueHJbal07XG4gICAgICAgICAgICBlbjAgLz0gYnc7XG4gICAgICAgICAgICAvKiBjb252ZXJ0IHRvIE1EQ1QgdW5pdHMgKi9cbiAgICAgICAgICAgIC8qIHNjYWxpbmcgc28gaXQgc2hvd3MgdXAgb24gRkZUIHBsb3QgKi9cbiAgICAgICAgICAgIGVuMSA9IDFlMTU7XG4gICAgICAgICAgICBnZmMucGluZm8uZW5bZ3JdW2NoXVtzZmJdID0gZW4xICogZW4wO1xuICAgICAgICAgICAgZ2ZjLnBpbmZvLnhmc2ZbZ3JdW2NoXVtzZmJdID0gZW4xICogbDNfeG1pbltzZmJdICogeGZzZltzZmJdIC8gYnc7XG5cbiAgICAgICAgICAgIGlmIChyYXRpby5lbi5sW3NmYl0gPiAwICYmICFnZnAuQVRIb25seSlcbiAgICAgICAgICAgICAgICBlbjAgPSBlbjAgLyByYXRpby5lbi5sW3NmYl07XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgZW4wID0gMC4wO1xuXG4gICAgICAgICAgICBnZmMucGluZm8udGhyW2dyXVtjaF1bc2ZiXSA9IGVuMVxuICAgICAgICAgICAgICAgICogTWF0aC5tYXgoZW4wICogcmF0aW8udGhtLmxbc2ZiXSwgZ2ZjLkFUSC5sW3NmYl0pO1xuXG4gICAgICAgICAgICAvKiB0aGVyZSBpcyBubyBzY2FsZWZhY3RvciBiYW5kcyA+PSBTQlBTWV9sICovXG4gICAgICAgICAgICBnZmMucGluZm8uTEFNRXNmYltncl1bY2hdW3NmYl0gPSAwO1xuICAgICAgICAgICAgaWYgKGNvZF9pbmZvLnByZWZsYWcgIT0gMCAmJiBzZmIgPj0gMTEpXG4gICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLkxBTUVzZmJbZ3JdW2NoXVtzZmJdID0gLWlmcXN0ZXAgKiBwcmV0YWJbc2ZiXTtcblxuICAgICAgICAgICAgaWYgKHNmYiA8IEVuY29kZXIuU0JQU1lfbCkge1xuICAgICAgICAgICAgICAgIC8qIHNjZnNpIHNob3VsZCBiZSBkZWNvZGVkIGJ5IGNhbGxlciBzaWRlICovXG4gICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLkxBTUVzZmJbZ3JdW2NoXVtzZmJdIC09IGlmcXN0ZXAgKiBzY2FsZWZhY1tzZmJdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qIGZvciBzZmIgKi9cblxuICAgICAgICBpZiAoY29kX2luZm8uYmxvY2tfdHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgIHNmYjIgPSBzZmI7XG4gICAgICAgICAgICBmb3IgKHNmYiA9IGNvZF9pbmZvLnNmYl9zbWluOyBzZmIgPCBFbmNvZGVyLlNCTUFYX3M7IHNmYisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gZ2ZjLnNjYWxlZmFjX2JhbmQuc1tzZmJdO1xuICAgICAgICAgICAgICAgIHZhciBlbmQgPSBnZmMuc2NhbGVmYWNfYmFuZC5zW3NmYiArIDFdO1xuICAgICAgICAgICAgICAgIHZhciBidyA9IGVuZCAtIHN0YXJ0O1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMzsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoZW4wID0gMC4wLCBsID0gc3RhcnQ7IGwgPCBlbmQ7IGwrKykge1xuICAgICAgICAgICAgICAgICAgICAgICAgZW4wICs9IGNvZF9pbmZvLnhyW2pdICogY29kX2luZm8ueHJbal07XG4gICAgICAgICAgICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZW4wID0gTWF0aC5tYXgoZW4wIC8gYncsIDFlLTIwKTtcbiAgICAgICAgICAgICAgICAgICAgLyogY29udmVydCB0byBNRENUIHVuaXRzICovXG4gICAgICAgICAgICAgICAgICAgIC8qIHNjYWxpbmcgc28gaXQgc2hvd3MgdXAgb24gRkZUIHBsb3QgKi9cbiAgICAgICAgICAgICAgICAgICAgZW4xID0gMWUxNTtcblxuICAgICAgICAgICAgICAgICAgICBnZmMucGluZm8uZW5fc1tncl1bY2hdWzMgKiBzZmIgKyBpXSA9IGVuMSAqIGVuMDtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLnhmc2Zfc1tncl1bY2hdWzMgKiBzZmIgKyBpXSA9IGVuMSAqIGwzX3htaW5bc2ZiMl1cbiAgICAgICAgICAgICAgICAgICAgICAgICogeGZzZltzZmIyXSAvIGJ3O1xuICAgICAgICAgICAgICAgICAgICBpZiAocmF0aW8uZW4uc1tzZmJdW2ldID4gMClcbiAgICAgICAgICAgICAgICAgICAgICAgIGVuMCA9IGVuMCAvIHJhdGlvLmVuLnNbc2ZiXVtpXTtcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgZW4wID0gMC4wO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2ZwLkFUSG9ubHkgfHwgZ2ZwLkFUSHNob3J0KVxuICAgICAgICAgICAgICAgICAgICAgICAgZW4wID0gMDtcblxuICAgICAgICAgICAgICAgICAgICBnZmMucGluZm8udGhyX3NbZ3JdW2NoXVszICogc2ZiICsgaV0gPSBlbjFcbiAgICAgICAgICAgICAgICAgICAgICAgICogTWF0aC5tYXgoZW4wICogcmF0aW8udGhtLnNbc2ZiXVtpXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZmMuQVRILnNbc2ZiXSk7XG5cbiAgICAgICAgICAgICAgICAgICAgLyogdGhlcmUgaXMgbm8gc2NhbGVmYWN0b3IgYmFuZHMgPj0gU0JQU1lfcyAqL1xuICAgICAgICAgICAgICAgICAgICBnZmMucGluZm8uTEFNRXNmYl9zW2dyXVtjaF1bMyAqIHNmYiArIGldID0gLTIuMFxuICAgICAgICAgICAgICAgICAgICAgICAgKiBjb2RfaW5mby5zdWJibG9ja19nYWluW2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2ZiIDwgRW5jb2Rlci5TQlBTWV9zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZmMucGluZm8uTEFNRXNmYl9zW2dyXVtjaF1bMyAqIHNmYiArIGldIC09IGlmcXN0ZXBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIHNjYWxlZmFjW3NmYjJdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHNmYjIrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyogYmxvY2sgdHlwZSBzaG9ydCAqL1xuICAgICAgICBnZmMucGluZm8uTEFNRXFzc1tncl1bY2hdID0gY29kX2luZm8uZ2xvYmFsX2dhaW47XG4gICAgICAgIGdmYy5waW5mby5MQU1FbWFpbmJpdHNbZ3JdW2NoXSA9IGNvZF9pbmZvLnBhcnQyXzNfbGVuZ3RoXG4gICAgICAgICAgICArIGNvZF9pbmZvLnBhcnQyX2xlbmd0aDtcbiAgICAgICAgZ2ZjLnBpbmZvLkxBTUVzZmJpdHNbZ3JdW2NoXSA9IGNvZF9pbmZvLnBhcnQyX2xlbmd0aDtcblxuICAgICAgICBnZmMucGluZm8ub3Zlcltncl1bY2hdID0gbm9pc2Uub3Zlcl9jb3VudDtcbiAgICAgICAgZ2ZjLnBpbmZvLm1heF9ub2lzZVtncl1bY2hdID0gbm9pc2UubWF4X25vaXNlICogMTAuMDtcbiAgICAgICAgZ2ZjLnBpbmZvLm92ZXJfbm9pc2VbZ3JdW2NoXSA9IG5vaXNlLm92ZXJfbm9pc2UgKiAxMC4wO1xuICAgICAgICBnZmMucGluZm8udG90X25vaXNlW2dyXVtjaF0gPSBub2lzZS50b3Rfbm9pc2UgKiAxMC4wO1xuICAgICAgICBnZmMucGluZm8ub3Zlcl9TU0RbZ3JdW2NoXSA9IG5vaXNlLm92ZXJfU1NEO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHVwZGF0ZXMgcGxvdHRpbmcgZGF0YSBmb3IgYSB3aG9sZSBmcmFtZVxuICAgICAqXG4gICAgICogUm9iZXJ0IEhlZ2VtYW5uIDIwMDAtMTAtMjFcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBzZXRfZnJhbWVfcGluZm8oZ2ZwLCByYXRpbykge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXG4gICAgICAgIGdmYy5tYXNraW5nX2xvd2VyID0gMS4wO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGZvciBldmVyeSBncmFudWxlIGFuZCBjaGFubmVsIHBhdGNoIGwzX2VuYyBhbmQgc2V0IGluZm9cbiAgICAgICAgICovXG4gICAgICAgIGZvciAodmFyIGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuICAgICAgICAgICAgZm9yICh2YXIgY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgY29kX2luZm8gPSBnZmMubDNfc2lkZS50dFtncl1bY2hdO1xuICAgICAgICAgICAgICAgIHZhciBzY2FsZWZhY19zYXYgPSBuZXdfaW50KEwzU2lkZS5TRkJNQVgpO1xuICAgICAgICAgICAgICAgIFN5c3RlbS5hcnJheWNvcHkoY29kX2luZm8uc2NhbGVmYWMsIDAsIHNjYWxlZmFjX3NhdiwgMCxcbiAgICAgICAgICAgICAgICAgICAgc2NhbGVmYWNfc2F2Lmxlbmd0aCk7XG5cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIHJlY29uc3RydWN0IHRoZSBzY2FsZWZhY3RvcnMgaW4gY2FzZSBTQ0ZTSSB3YXMgdXNlZFxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGlmIChnciA9PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzZmI7XG4gICAgICAgICAgICAgICAgICAgIGZvciAoc2ZiID0gMDsgc2ZiIDwgY29kX2luZm8uc2ZiX2xtYXg7IHNmYisrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29kX2luZm8uc2NhbGVmYWNbc2ZiXSA8IDApIC8qIHNjZnNpICovXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29kX2luZm8uc2NhbGVmYWNbc2ZiXSA9IGdmYy5sM19zaWRlLnR0WzBdW2NoXS5zY2FsZWZhY1tzZmJdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgc2V0X3BpbmZvKGdmcCwgY29kX2luZm8sIHJhdGlvW2dyXVtjaF0sIGdyLCBjaCk7XG4gICAgICAgICAgICAgICAgU3lzdGVtLmFycmF5Y29weShzY2FsZWZhY19zYXYsIDAsIGNvZF9pbmZvLnNjYWxlZmFjLCAwLFxuICAgICAgICAgICAgICAgICAgICBzY2FsZWZhY19zYXYubGVuZ3RoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIGZvciBjaCAqL1xuICAgICAgICB9XG4gICAgICAgIC8qIGZvciBnciAqL1xuICAgIH1cblxufVxuXG5cbmZ1bmN0aW9uIENhbGNOb2lzZURhdGEoKSB7XG4gICAgdGhpcy5nbG9iYWxfZ2FpbiA9IDA7XG4gICAgdGhpcy5zZmJfY291bnQxID0gMDtcbiAgICB0aGlzLnN0ZXAgPSBuZXdfaW50KDM5KTtcbiAgICB0aGlzLm5vaXNlID0gbmV3X2Zsb2F0KDM5KTtcbiAgICB0aGlzLm5vaXNlX2xvZyA9IG5ld19mbG9hdCgzOSk7XG59XG5cbi8vcGFja2FnZSBtcDM7XG5cblxuZnVuY3Rpb24gR3JJbmZvKCkge1xuICAgIC8vZmxvYXQgeHJbXSA9IG5ldyBmbG9hdFs1NzZdO1xuICAgIHRoaXMueHIgPSBuZXdfZmxvYXQoNTc2KTtcbiAgICAvL2ludCBsM19lbmNbXSA9IG5ldyBpbnRbNTc2XTtcbiAgICB0aGlzLmwzX2VuYyA9IG5ld19pbnQoNTc2KTtcbiAgICAvL2ludCBzY2FsZWZhY1tdID0gbmV3IGludFtMM1NpZGUuU0ZCTUFYXTtcbiAgICB0aGlzLnNjYWxlZmFjID0gbmV3X2ludChMM1NpZGUuU0ZCTUFYKTtcbiAgICB0aGlzLnhycG93X21heCA9IDAuO1xuXG4gICAgdGhpcy5wYXJ0Ml8zX2xlbmd0aCA9IDA7XG4gICAgdGhpcy5iaWdfdmFsdWVzID0gMDtcbiAgICB0aGlzLmNvdW50MSA9IDA7XG4gICAgdGhpcy5nbG9iYWxfZ2FpbiA9IDA7XG4gICAgdGhpcy5zY2FsZWZhY19jb21wcmVzcyA9IDA7XG4gICAgdGhpcy5ibG9ja190eXBlID0gMDtcbiAgICB0aGlzLm1peGVkX2Jsb2NrX2ZsYWcgPSAwO1xuICAgIHRoaXMudGFibGVfc2VsZWN0ID0gbmV3X2ludCgzKTtcbiAgICB0aGlzLnN1YmJsb2NrX2dhaW4gPSBuZXdfaW50KDMgKyAxKTtcbiAgICB0aGlzLnJlZ2lvbjBfY291bnQgPSAwO1xuICAgIHRoaXMucmVnaW9uMV9jb3VudCA9IDA7XG4gICAgdGhpcy5wcmVmbGFnID0gMDtcbiAgICB0aGlzLnNjYWxlZmFjX3NjYWxlID0gMDtcbiAgICB0aGlzLmNvdW50MXRhYmxlX3NlbGVjdCA9IDA7XG5cbiAgICB0aGlzLnBhcnQyX2xlbmd0aCA9IDA7XG4gICAgdGhpcy5zZmJfbG1heCA9IDA7XG4gICAgdGhpcy5zZmJfc21pbiA9IDA7XG4gICAgdGhpcy5wc3lfbG1heCA9IDA7XG4gICAgdGhpcy5zZmJtYXggPSAwO1xuICAgIHRoaXMucHN5bWF4ID0gMDtcbiAgICB0aGlzLnNmYmRpdmlkZSA9IDA7XG4gICAgdGhpcy53aWR0aCA9IG5ld19pbnQoTDNTaWRlLlNGQk1BWCk7XG4gICAgdGhpcy53aW5kb3cgPSBuZXdfaW50KEwzU2lkZS5TRkJNQVgpO1xuICAgIHRoaXMuY291bnQxYml0cyA9IDA7XG4gICAgLyoqXG4gICAgICogYWRkZWQgZm9yIExTRlxuICAgICAqL1xuICAgIHRoaXMuc2ZiX3BhcnRpdGlvbl90YWJsZSA9IG51bGw7XG4gICAgdGhpcy5zbGVuID0gbmV3X2ludCg0KTtcblxuICAgIHRoaXMubWF4X25vbnplcm9fY29lZmYgPSAwO1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIGZ1bmN0aW9uIGNsb25lX2ludChhcnJheSkge1xuICAgICAgICByZXR1cm4gbmV3IEludDMyQXJyYXkoYXJyYXkpO1xuICAgIH1cbiAgICBmdW5jdGlvbiBjbG9uZV9mbG9hdChhcnJheSkge1xuICAgICAgICByZXR1cm4gbmV3IEZsb2F0MzJBcnJheShhcnJheSk7XG4gICAgfVxuICAgIHRoaXMuYXNzaWduID0gZnVuY3Rpb24gKG90aGVyKSB7XG4gICAgICAgIHNlbGYueHIgPSBjbG9uZV9mbG9hdChvdGhlci54cik7IC8vLnNsaWNlKDApOyAvL2Nsb25lKCk7XG4gICAgICAgIHNlbGYubDNfZW5jID0gY2xvbmVfaW50KG90aGVyLmwzX2VuYyk7IC8vLnNsaWNlKDApOyAvL2Nsb25lKCk7XG4gICAgICAgIHNlbGYuc2NhbGVmYWMgPSBjbG9uZV9pbnQob3RoZXIuc2NhbGVmYWMpOy8vLnNsaWNlKDApOyAvL2Nsb25lKCk7XG4gICAgICAgIHNlbGYueHJwb3dfbWF4ID0gb3RoZXIueHJwb3dfbWF4O1xuXG4gICAgICAgIHNlbGYucGFydDJfM19sZW5ndGggPSBvdGhlci5wYXJ0Ml8zX2xlbmd0aDtcbiAgICAgICAgc2VsZi5iaWdfdmFsdWVzID0gb3RoZXIuYmlnX3ZhbHVlcztcbiAgICAgICAgc2VsZi5jb3VudDEgPSBvdGhlci5jb3VudDE7XG4gICAgICAgIHNlbGYuZ2xvYmFsX2dhaW4gPSBvdGhlci5nbG9iYWxfZ2FpbjtcbiAgICAgICAgc2VsZi5zY2FsZWZhY19jb21wcmVzcyA9IG90aGVyLnNjYWxlZmFjX2NvbXByZXNzO1xuICAgICAgICBzZWxmLmJsb2NrX3R5cGUgPSBvdGhlci5ibG9ja190eXBlO1xuICAgICAgICBzZWxmLm1peGVkX2Jsb2NrX2ZsYWcgPSBvdGhlci5taXhlZF9ibG9ja19mbGFnO1xuICAgICAgICBzZWxmLnRhYmxlX3NlbGVjdCA9IGNsb25lX2ludChvdGhlci50YWJsZV9zZWxlY3QpOy8vLnNsaWNlKDApOyAvL2Nsb25lKCk7XG4gICAgICAgIHNlbGYuc3ViYmxvY2tfZ2FpbiA9IGNsb25lX2ludChvdGhlci5zdWJibG9ja19nYWluKTsgLy8uc2xpY2UoMCk7IC8vLmNsb25lKCk7XG4gICAgICAgIHNlbGYucmVnaW9uMF9jb3VudCA9IG90aGVyLnJlZ2lvbjBfY291bnQ7XG4gICAgICAgIHNlbGYucmVnaW9uMV9jb3VudCA9IG90aGVyLnJlZ2lvbjFfY291bnQ7XG4gICAgICAgIHNlbGYucHJlZmxhZyA9IG90aGVyLnByZWZsYWc7XG4gICAgICAgIHNlbGYuc2NhbGVmYWNfc2NhbGUgPSBvdGhlci5zY2FsZWZhY19zY2FsZTtcbiAgICAgICAgc2VsZi5jb3VudDF0YWJsZV9zZWxlY3QgPSBvdGhlci5jb3VudDF0YWJsZV9zZWxlY3Q7XG5cbiAgICAgICAgc2VsZi5wYXJ0Ml9sZW5ndGggPSBvdGhlci5wYXJ0Ml9sZW5ndGg7XG4gICAgICAgIHNlbGYuc2ZiX2xtYXggPSBvdGhlci5zZmJfbG1heDtcbiAgICAgICAgc2VsZi5zZmJfc21pbiA9IG90aGVyLnNmYl9zbWluO1xuICAgICAgICBzZWxmLnBzeV9sbWF4ID0gb3RoZXIucHN5X2xtYXg7XG4gICAgICAgIHNlbGYuc2ZibWF4ID0gb3RoZXIuc2ZibWF4O1xuICAgICAgICBzZWxmLnBzeW1heCA9IG90aGVyLnBzeW1heDtcbiAgICAgICAgc2VsZi5zZmJkaXZpZGUgPSBvdGhlci5zZmJkaXZpZGU7XG4gICAgICAgIHNlbGYud2lkdGggPSBjbG9uZV9pbnQob3RoZXIud2lkdGgpOyAvLy5zbGljZSgwKTsgLy8uY2xvbmUoKTtcbiAgICAgICAgc2VsZi53aW5kb3cgPSBjbG9uZV9pbnQob3RoZXIud2luZG93KTsgLy8uc2xpY2UoMCk7IC8vLmNsb25lKCk7XG4gICAgICAgIHNlbGYuY291bnQxYml0cyA9IG90aGVyLmNvdW50MWJpdHM7XG5cbiAgICAgICAgc2VsZi5zZmJfcGFydGl0aW9uX3RhYmxlID0gb3RoZXIuc2ZiX3BhcnRpdGlvbl90YWJsZS5zbGljZSgwKTsgLy8uY2xvbmUoKTtcbiAgICAgICAgc2VsZi5zbGVuID0gY2xvbmVfaW50KG90aGVyLnNsZW4pOyAvLy5zbGljZSgwKTsgLy8uY2xvbmUoKTtcbiAgICAgICAgc2VsZi5tYXhfbm9uemVyb19jb2VmZiA9IG90aGVyLm1heF9ub256ZXJvX2NvZWZmO1xuICAgIH1cbn1cblxuXG52YXIgTDNTaWRlID0ge307XG5cblxuXHQvKipcblx0ICogbWF4IHNjYWxlZmFjdG9yIGJhbmQsIG1heChTQk1BWF9sLCBTQk1BWF9zKjMsIChTQk1BWF9zLTMpKjMrOClcblx0ICovXG5MM1NpZGUuU0ZCTUFYID0gKEVuY29kZXIuU0JNQVhfcyAqIDMpO1xuXG4vKlxuICogTVAzIHF1YW50aXphdGlvblxuICpcbiAqICAgICAgQ29weXJpZ2h0IChjKSAxOTk5LTIwMDAgTWFyayBUYXlsb3JcbiAqICAgICAgQ29weXJpZ2h0IChjKSAxOTk5LTIwMDMgVGFrZWhpcm8gVG9taW5hZ2FcbiAqICAgICAgQ29weXJpZ2h0IChjKSAyMDAwLTIwMDcgUm9iZXJ0IEhlZ2VtYW5uXG4gKiAgICAgIENvcHlyaWdodCAoYykgMjAwMS0yMDA1IEdhYnJpZWwgQm91dmlnbmVcbiAqXG4gKiBUaGlzIGxpYnJhcnkgaXMgZnJlZSBzb2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yXG4gKiBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG4gKiBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXJcbiAqIHZlcnNpb24gMiBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cbiAqXG4gKiBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCxcbiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mXG4gKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICAgICBTZWUgdGhlIEdOVVxuICogTGlicmFyeSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuXG4gKlxuICogWW91IHNob3VsZCBoYXZlIHJlY2VpdmVkIGEgY29weSBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpY1xuICogTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCB3cml0ZSB0byB0aGVcbiAqIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbiwgSW5jLiwgNTkgVGVtcGxlIFBsYWNlIC0gU3VpdGUgMzMwLFxuICogQm9zdG9uLCBNQSAwMjExMS0xMzA3LCBVU0EuXG4gKi9cblxuLyogJElkOiBRdWFudGl6ZS5qYXZhLHYgMS4yNCAyMDExLzA1LzI0IDIwOjQ4OjA2IGtlbmNoaXMgRXhwICQgKi9cblxuLy9wYWNrYWdlIG1wMztcblxuLy9pbXBvcnQgamF2YS51dGlsLkFycmF5cztcblxuXG5mdW5jdGlvbiBRdWFudGl6ZSgpIHtcbiAgICB2YXIgYnM7XG4gICAgdGhpcy5ydiA9IG51bGw7XG4gICAgdmFyIHJ2O1xuICAgIHRoaXMucXVwdnQgPSBudWxsO1xuICAgIHZhciBxdXB2dDtcblxuICAgIHZhciB2YnIgPSBuZXcgVkJSUXVhbnRpemUoKTtcbiAgICB2YXIgdGs7XG5cbiAgICB0aGlzLnNldE1vZHVsZXMgPSBmdW5jdGlvbiAoX2JzLCBfcnYsIF9xdXB2dCwgX3RrKSB7XG4gICAgICAgIGJzID0gX2JzO1xuICAgICAgICBydiA9IF9ydjtcbiAgICAgICAgdGhpcy5ydiA9IF9ydjtcbiAgICAgICAgcXVwdnQgPSBfcXVwdnQ7XG4gICAgICAgIHRoaXMucXVwdnQgPSBfcXVwdnQ7XG4gICAgICAgIHRrID0gX3RrO1xuICAgICAgICB2YnIuc2V0TW9kdWxlcyhxdXB2dCwgdGspO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNvbnZlcnQgZnJvbSBML1IgPC4gTWlkL1NpZGVcbiAgICAgKi9cbiAgICB0aGlzLm1zX2NvbnZlcnQgPSBmdW5jdGlvbiAobDNfc2lkZSwgZ3IpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1NzY7ICsraSkge1xuICAgICAgICAgICAgdmFyIGwgPSBsM19zaWRlLnR0W2dyXVswXS54cltpXTtcbiAgICAgICAgICAgIHZhciByID0gbDNfc2lkZS50dFtncl1bMV0ueHJbaV07XG4gICAgICAgICAgICBsM19zaWRlLnR0W2dyXVswXS54cltpXSA9IChsICsgcikgKiAoVXRpbC5TUVJUMiAqIDAuNSk7XG4gICAgICAgICAgICBsM19zaWRlLnR0W2dyXVsxXS54cltpXSA9IChsIC0gcikgKiAoVXRpbC5TUVJUMiAqIDAuNSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogbXQgNi85OVxuICAgICAqXG4gICAgICogaW5pdGlhbGl6ZXMgY29kX2luZm8sIHNjYWxlZmFjIGFuZCB4cnBvd1xuICAgICAqXG4gICAgICogcmV0dXJucyAwIGlmIGFsbCBlbmVyZ2llcyBpbiB4ciBhcmUgemVybywgZWxzZSAxXG4gICAgICovXG4gICAgZnVuY3Rpb24gaW5pdF94cnBvd19jb3JlKGNvZF9pbmZvLCB4cnBvdywgdXBwZXIsIHN1bSkge1xuICAgICAgICBzdW0gPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8PSB1cHBlcjsgKytpKSB7XG4gICAgICAgICAgICB2YXIgdG1wID0gTWF0aC5hYnMoY29kX2luZm8ueHJbaV0pO1xuICAgICAgICAgICAgc3VtICs9IHRtcDtcbiAgICAgICAgICAgIHhycG93W2ldID0gTWF0aC5zcXJ0KHRtcCAqIE1hdGguc3FydCh0bXApKTtcblxuICAgICAgICAgICAgaWYgKHhycG93W2ldID4gY29kX2luZm8ueHJwb3dfbWF4KVxuICAgICAgICAgICAgICAgIGNvZF9pbmZvLnhycG93X21heCA9IHhycG93W2ldO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdW07XG4gICAgfVxuXG4gICAgdGhpcy5pbml0X3hycG93ID0gZnVuY3Rpb24gKGdmYywgY29kX2luZm8sIHhycG93KSB7XG4gICAgICAgIHZhciBzdW0gPSAwO1xuICAgICAgICB2YXIgdXBwZXIgPSAwIHwgY29kX2luZm8ubWF4X25vbnplcm9fY29lZmY7XG5cbiAgICAgICAgY29kX2luZm8ueHJwb3dfbWF4ID0gMDtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBjaGVjayBpZiB0aGVyZSBpcyBzb21lIGVuZXJneSB3ZSBoYXZlIHRvIHF1YW50aXplIGFuZCBjYWxjdWxhdGUgeHJwb3dcbiAgICAgICAgICogbWF0Y2hpbmcgb3VyIGZyZXNoIHNjYWxlZmFjdG9yc1xuICAgICAgICAgKi9cblxuICAgICAgICBBcnJheXMuZmlsbCh4cnBvdywgdXBwZXIsIDU3NiwgMCk7XG5cbiAgICAgICAgc3VtID0gaW5pdF94cnBvd19jb3JlKGNvZF9pbmZvLCB4cnBvdywgdXBwZXIsIHN1bSk7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogcmV0dXJuIDEgaWYgd2UgaGF2ZSBzb21ldGhpbmcgdG8gcXVhbnRpemUsIGVsc2UgMFxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKHN1bSA+IDFFLTIwKSB7XG4gICAgICAgICAgICB2YXIgaiA9IDA7XG4gICAgICAgICAgICBpZiAoKGdmYy5zdWJzdGVwX3NoYXBpbmcgJiAyKSAhPSAwKVxuICAgICAgICAgICAgICAgIGogPSAxO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvZF9pbmZvLnBzeW1heDsgaSsrKVxuICAgICAgICAgICAgICAgIGdmYy5wc2V1ZG9oYWxmW2ldID0gajtcblxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBBcnJheXMuZmlsbChjb2RfaW5mby5sM19lbmMsIDAsIDU3NiwgMCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHYWJyaWVsIEJvdXZpZ25lIGZlYi9hcHIgMjAwMzxCUj5cbiAgICAgKiBBbmFsb2cgc2lsZW5jZSBkZXRlY3Rpb24gaW4gcGFydGl0aW9ubmVkIHNmYjIxIG9yIHNmYjEyIGZvciBzaG9ydCBibG9ja3NcbiAgICAgKlxuICAgICAqIEZyb20gdG9wIHRvIGJvdHRvbSBvZiBzZmIsIGNoYW5nZXMgdG8gMCBjb2VmZnMgd2hpY2ggYXJlIGJlbG93IGF0aC4gSXRcbiAgICAgKiBzdG9wcyBvbiB0aGUgZmlyc3QgY29lZmYgaGlnaGVyIHRoYW4gYXRoLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHBzZmIyMV9hbmFsb2dzaWxlbmNlKGdmYywgY29kX2luZm8pIHtcbiAgICAgICAgdmFyIGF0aCA9IGdmYy5BVEg7XG4gICAgICAgIHZhciB4ciA9IGNvZF9pbmZvLnhyO1xuXG4gICAgICAgIGlmIChjb2RfaW5mby5ibG9ja190eXBlICE9IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgLyogTk9STSwgU1RBUlQgb3IgU1RPUCB0eXBlLCBidXQgbm90IFNIT1JUIGJsb2NrcyAqL1xuICAgICAgICAgICAgdmFyIHN0b3AgPSBmYWxzZTtcbiAgICAgICAgICAgIGZvciAodmFyIGdzZmIgPSBFbmNvZGVyLlBTRkIyMSAtIDE7IGdzZmIgPj0gMCAmJiAhc3RvcDsgZ3NmYi0tKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gZ2ZjLnNjYWxlZmFjX2JhbmQucHNmYjIxW2dzZmJdO1xuICAgICAgICAgICAgICAgIHZhciBlbmQgPSBnZmMuc2NhbGVmYWNfYmFuZC5wc2ZiMjFbZ3NmYiArIDFdO1xuICAgICAgICAgICAgICAgIHZhciBhdGgyMSA9IHF1cHZ0LmF0aEFkanVzdChhdGguYWRqdXN0LCBhdGgucHNmYjIxW2dzZmJdLFxuICAgICAgICAgICAgICAgICAgICBhdGguZmxvb3IpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGdmYy5uc1BzeS5sb25nZmFjdFsyMV0gPiAxZS0xMilcbiAgICAgICAgICAgICAgICAgICAgYXRoMjEgKj0gZ2ZjLm5zUHN5LmxvbmdmYWN0WzIxXTtcblxuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSBlbmQgLSAxOyBqID49IHN0YXJ0OyBqLS0pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHhyW2pdKSA8IGF0aDIxKVxuICAgICAgICAgICAgICAgICAgICAgICAgeHJbal0gPSAwO1xuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0b3AgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvKiBub3RlOiBzaG9ydCBibG9ja3MgY29lZmZzIGFyZSByZW9yZGVyZWQgKi9cbiAgICAgICAgICAgIGZvciAodmFyIGJsb2NrID0gMDsgYmxvY2sgPCAzOyBibG9jaysrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0b3AgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBnc2ZiID0gRW5jb2Rlci5QU0ZCMTIgLSAxOyBnc2ZiID49IDAgJiYgIXN0b3A7IGdzZmItLSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBnZmMuc2NhbGVmYWNfYmFuZC5zWzEyXVxuICAgICAgICAgICAgICAgICAgICAgICAgKiAzXG4gICAgICAgICAgICAgICAgICAgICAgICArIChnZmMuc2NhbGVmYWNfYmFuZC5zWzEzXSAtIGdmYy5zY2FsZWZhY19iYW5kLnNbMTJdKVxuICAgICAgICAgICAgICAgICAgICAgICAgKiBibG9ja1xuICAgICAgICAgICAgICAgICAgICAgICAgKyAoZ2ZjLnNjYWxlZmFjX2JhbmQucHNmYjEyW2dzZmJdIC0gZ2ZjLnNjYWxlZmFjX2JhbmQucHNmYjEyWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVuZCA9IHN0YXJ0XG4gICAgICAgICAgICAgICAgICAgICAgICArIChnZmMuc2NhbGVmYWNfYmFuZC5wc2ZiMTJbZ3NmYiArIDFdIC0gZ2ZjLnNjYWxlZmFjX2JhbmQucHNmYjEyW2dzZmJdKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGF0aDEyID0gcXVwdnQuYXRoQWRqdXN0KGF0aC5hZGp1c3QsIGF0aC5wc2ZiMTJbZ3NmYl0sXG4gICAgICAgICAgICAgICAgICAgICAgICBhdGguZmxvb3IpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChnZmMubnNQc3kuc2hvcnRmYWN0WzEyXSA+IDFlLTEyKVxuICAgICAgICAgICAgICAgICAgICAgICAgYXRoMTIgKj0gZ2ZjLm5zUHN5LnNob3J0ZmFjdFsxMl07XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IGVuZCAtIDE7IGogPj0gc3RhcnQ7IGotLSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHhyW2pdKSA8IGF0aDEyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHhyW2pdID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0b3AgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICB0aGlzLmluaXRfb3V0ZXJfbG9vcCA9IGZ1bmN0aW9uIChnZmMsIGNvZF9pbmZvKSB7XG4gICAgICAgIC8qXG4gICAgICAgICAqIGluaXRpYWxpemUgZnJlc2ggY29kX2luZm9cbiAgICAgICAgICovXG4gICAgICAgIGNvZF9pbmZvLnBhcnQyXzNfbGVuZ3RoID0gMDtcbiAgICAgICAgY29kX2luZm8uYmlnX3ZhbHVlcyA9IDA7XG4gICAgICAgIGNvZF9pbmZvLmNvdW50MSA9IDA7XG4gICAgICAgIGNvZF9pbmZvLmdsb2JhbF9nYWluID0gMjEwO1xuICAgICAgICBjb2RfaW5mby5zY2FsZWZhY19jb21wcmVzcyA9IDA7XG4gICAgICAgIC8qIG1peGVkX2Jsb2NrX2ZsYWcsIGJsb2NrX3R5cGUgd2FzIHNldCBpbiBwc3ltb2RlbC5jICovXG4gICAgICAgIGNvZF9pbmZvLnRhYmxlX3NlbGVjdFswXSA9IDA7XG4gICAgICAgIGNvZF9pbmZvLnRhYmxlX3NlbGVjdFsxXSA9IDA7XG4gICAgICAgIGNvZF9pbmZvLnRhYmxlX3NlbGVjdFsyXSA9IDA7XG4gICAgICAgIGNvZF9pbmZvLnN1YmJsb2NrX2dhaW5bMF0gPSAwO1xuICAgICAgICBjb2RfaW5mby5zdWJibG9ja19nYWluWzFdID0gMDtcbiAgICAgICAgY29kX2luZm8uc3ViYmxvY2tfZ2FpblsyXSA9IDA7XG4gICAgICAgIGNvZF9pbmZvLnN1YmJsb2NrX2dhaW5bM10gPSAwO1xuICAgICAgICAvKiB0aGlzIG9uZSBpcyBhbHdheXMgMCAqL1xuICAgICAgICBjb2RfaW5mby5yZWdpb24wX2NvdW50ID0gMDtcbiAgICAgICAgY29kX2luZm8ucmVnaW9uMV9jb3VudCA9IDA7XG4gICAgICAgIGNvZF9pbmZvLnByZWZsYWcgPSAwO1xuICAgICAgICBjb2RfaW5mby5zY2FsZWZhY19zY2FsZSA9IDA7XG4gICAgICAgIGNvZF9pbmZvLmNvdW50MXRhYmxlX3NlbGVjdCA9IDA7XG4gICAgICAgIGNvZF9pbmZvLnBhcnQyX2xlbmd0aCA9IDA7XG4gICAgICAgIGNvZF9pbmZvLnNmYl9sbWF4ID0gRW5jb2Rlci5TQlBTWV9sO1xuICAgICAgICBjb2RfaW5mby5zZmJfc21pbiA9IEVuY29kZXIuU0JQU1lfcztcbiAgICAgICAgY29kX2luZm8ucHN5X2xtYXggPSBnZmMuc2ZiMjFfZXh0cmEgPyBFbmNvZGVyLlNCTUFYX2wgOiBFbmNvZGVyLlNCUFNZX2w7XG4gICAgICAgIGNvZF9pbmZvLnBzeW1heCA9IGNvZF9pbmZvLnBzeV9sbWF4O1xuICAgICAgICBjb2RfaW5mby5zZmJtYXggPSBjb2RfaW5mby5zZmJfbG1heDtcbiAgICAgICAgY29kX2luZm8uc2ZiZGl2aWRlID0gMTE7XG4gICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IEVuY29kZXIuU0JNQVhfbDsgc2ZiKyspIHtcbiAgICAgICAgICAgIGNvZF9pbmZvLndpZHRoW3NmYl0gPSBnZmMuc2NhbGVmYWNfYmFuZC5sW3NmYiArIDFdXG4gICAgICAgICAgICAgICAgLSBnZmMuc2NhbGVmYWNfYmFuZC5sW3NmYl07XG4gICAgICAgICAgICAvKiB3aGljaCBpcyBhbHdheXMgMC4gKi9cbiAgICAgICAgICAgIGNvZF9pbmZvLndpbmRvd1tzZmJdID0gMztcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29kX2luZm8uYmxvY2tfdHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgIHZhciBpeHdvcmsgPSBuZXdfZmxvYXQoNTc2KTtcblxuICAgICAgICAgICAgY29kX2luZm8uc2ZiX3NtaW4gPSAwO1xuICAgICAgICAgICAgY29kX2luZm8uc2ZiX2xtYXggPSAwO1xuICAgICAgICAgICAgaWYgKGNvZF9pbmZvLm1peGVkX2Jsb2NrX2ZsYWcgIT0gMCkge1xuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogTVBFRy0xOiBzZmJzIDAtNyBsb25nIGJsb2NrLCAzLTEyIHNob3J0IGJsb2NrcyBNUEVHLTIoLjUpOlxuICAgICAgICAgICAgICAgICAqIHNmYnMgMC01IGxvbmcgYmxvY2ssIDMtMTIgc2hvcnQgYmxvY2tzXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgY29kX2luZm8uc2ZiX3NtaW4gPSAzO1xuICAgICAgICAgICAgICAgIGNvZF9pbmZvLnNmYl9sbWF4ID0gZ2ZjLm1vZGVfZ3IgKiAyICsgNDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvZF9pbmZvLnBzeW1heCA9IGNvZF9pbmZvLnNmYl9sbWF4XG4gICAgICAgICAgICAgICAgKyAzXG4gICAgICAgICAgICAgICAgKiAoKGdmYy5zZmIyMV9leHRyYSA/IEVuY29kZXIuU0JNQVhfcyA6IEVuY29kZXIuU0JQU1lfcykgLSBjb2RfaW5mby5zZmJfc21pbik7XG4gICAgICAgICAgICBjb2RfaW5mby5zZmJtYXggPSBjb2RfaW5mby5zZmJfbG1heCArIDNcbiAgICAgICAgICAgICAgICAqIChFbmNvZGVyLlNCUFNZX3MgLSBjb2RfaW5mby5zZmJfc21pbik7XG4gICAgICAgICAgICBjb2RfaW5mby5zZmJkaXZpZGUgPSBjb2RfaW5mby5zZmJtYXggLSAxODtcbiAgICAgICAgICAgIGNvZF9pbmZvLnBzeV9sbWF4ID0gY29kX2luZm8uc2ZiX2xtYXg7XG4gICAgICAgICAgICAvKiByZS1vcmRlciB0aGUgc2hvcnQgYmxvY2tzLCBmb3IgbW9yZSBlZmZpY2llbnQgZW5jb2RpbmcgYmVsb3cgKi9cbiAgICAgICAgICAgIC8qIEJ5IFRha2VoaXJvIFRPTUlOQUdBICovXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogV2l0aGluIGVhY2ggc2NhbGVmYWN0b3IgYmFuZCwgZGF0YSBpcyBnaXZlbiBmb3Igc3VjY2Vzc2l2ZSB0aW1lXG4gICAgICAgICAgICAgKiB3aW5kb3dzLCBiZWdpbm5pbmcgd2l0aCB3aW5kb3cgMCBhbmQgZW5kaW5nIHdpdGggd2luZG93IDIuIFdpdGhpblxuICAgICAgICAgICAgICogZWFjaCB3aW5kb3csIHRoZSBxdWFudGl6ZWQgdmFsdWVzIGFyZSB0aGVuIGFycmFuZ2VkIGluIG9yZGVyIG9mXG4gICAgICAgICAgICAgKiBpbmNyZWFzaW5nIGZyZXF1ZW5jeS4uLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB2YXIgaXggPSBnZmMuc2NhbGVmYWNfYmFuZC5sW2NvZF9pbmZvLnNmYl9sbWF4XTtcbiAgICAgICAgICAgIFN5c3RlbS5hcnJheWNvcHkoY29kX2luZm8ueHIsIDAsIGl4d29yaywgMCwgNTc2KTtcbiAgICAgICAgICAgIGZvciAodmFyIHNmYiA9IGNvZF9pbmZvLnNmYl9zbWluOyBzZmIgPCBFbmNvZGVyLlNCTUFYX3M7IHNmYisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gZ2ZjLnNjYWxlZmFjX2JhbmQuc1tzZmJdO1xuICAgICAgICAgICAgICAgIHZhciBlbmQgPSBnZmMuc2NhbGVmYWNfYmFuZC5zW3NmYiArIDFdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIHdpbmRvdyA9IDA7IHdpbmRvdyA8IDM7IHdpbmRvdysrKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGwgPSBzdGFydDsgbCA8IGVuZDsgbCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RfaW5mby54cltpeCsrXSA9IGl4d29ya1szICogbCArIHdpbmRvd107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBqID0gY29kX2luZm8uc2ZiX2xtYXg7XG4gICAgICAgICAgICBmb3IgKHZhciBzZmIgPSBjb2RfaW5mby5zZmJfc21pbjsgc2ZiIDwgRW5jb2Rlci5TQk1BWF9zOyBzZmIrKykge1xuICAgICAgICAgICAgICAgIGNvZF9pbmZvLndpZHRoW2pdID0gY29kX2luZm8ud2lkdGhbaiArIDFdID0gY29kX2luZm8ud2lkdGhbaiArIDJdID0gZ2ZjLnNjYWxlZmFjX2JhbmQuc1tzZmIgKyAxXVxuICAgICAgICAgICAgICAgICAgICAtIGdmYy5zY2FsZWZhY19iYW5kLnNbc2ZiXTtcbiAgICAgICAgICAgICAgICBjb2RfaW5mby53aW5kb3dbal0gPSAwO1xuICAgICAgICAgICAgICAgIGNvZF9pbmZvLndpbmRvd1tqICsgMV0gPSAxO1xuICAgICAgICAgICAgICAgIGNvZF9pbmZvLndpbmRvd1tqICsgMl0gPSAyO1xuICAgICAgICAgICAgICAgIGogKz0gMztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvZF9pbmZvLmNvdW50MWJpdHMgPSAwO1xuICAgICAgICBjb2RfaW5mby5zZmJfcGFydGl0aW9uX3RhYmxlID0gcXVwdnQubnJfb2Zfc2ZiX2Jsb2NrWzBdWzBdO1xuICAgICAgICBjb2RfaW5mby5zbGVuWzBdID0gMDtcbiAgICAgICAgY29kX2luZm8uc2xlblsxXSA9IDA7XG4gICAgICAgIGNvZF9pbmZvLnNsZW5bMl0gPSAwO1xuICAgICAgICBjb2RfaW5mby5zbGVuWzNdID0gMDtcblxuICAgICAgICBjb2RfaW5mby5tYXhfbm9uemVyb19jb2VmZiA9IDU3NTtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBmcmVzaCBzY2FsZWZhY3RvcnMgYXJlIGFsbCB6ZXJvXG4gICAgICAgICAqL1xuICAgICAgICBBcnJheXMuZmlsbChjb2RfaW5mby5zY2FsZWZhYywgMCk7XG5cbiAgICAgICAgcHNmYjIxX2FuYWxvZ3NpbGVuY2UoZ2ZjLCBjb2RfaW5mbyk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIEJpblNlYXJjaERpcmVjdGlvbihvcmRpbmFsKSB7XG4gICAgICAgIHRoaXMub3JkaW5hbCA9IG9yZGluYWw7XG4gICAgfVxuXG4gICAgQmluU2VhcmNoRGlyZWN0aW9uLkJJTlNFQVJDSF9OT05FID0gbmV3IEJpblNlYXJjaERpcmVjdGlvbigwKTtcbiAgICBCaW5TZWFyY2hEaXJlY3Rpb24uQklOU0VBUkNIX1VQID0gbmV3IEJpblNlYXJjaERpcmVjdGlvbigxKTtcbiAgICBCaW5TZWFyY2hEaXJlY3Rpb24uQklOU0VBUkNIX0RPV04gPSBuZXcgQmluU2VhcmNoRGlyZWN0aW9uKDIpO1xuXG4gICAgLyoqXG4gICAgICogYXV0aG9yL2RhdGU/P1xuICAgICAqXG4gICAgICogYmluYXJ5IHN0ZXAgc2l6ZSBzZWFyY2ggdXNlZCBieSBvdXRlcl9sb29wIHRvIGdldCBhIHF1YW50aXplciBzdGVwIHNpemVcbiAgICAgKiB0byBzdGFydCB3aXRoXG4gICAgICovXG4gICAgZnVuY3Rpb24gYmluX3NlYXJjaF9TdGVwU2l6ZShnZmMsIGNvZF9pbmZvLCBkZXNpcmVkX3JhdGUsIGNoLCB4cnBvdykge1xuICAgICAgICB2YXIgbkJpdHM7XG4gICAgICAgIHZhciBDdXJyZW50U3RlcCA9IGdmYy5DdXJyZW50U3RlcFtjaF07XG4gICAgICAgIHZhciBmbGFnR29uZU92ZXIgPSBmYWxzZTtcbiAgICAgICAgdmFyIHN0YXJ0ID0gZ2ZjLk9sZFZhbHVlW2NoXTtcbiAgICAgICAgdmFyIERpcmVjdGlvbiA9IEJpblNlYXJjaERpcmVjdGlvbi5CSU5TRUFSQ0hfTk9ORTtcbiAgICAgICAgY29kX2luZm8uZ2xvYmFsX2dhaW4gPSBzdGFydDtcbiAgICAgICAgZGVzaXJlZF9yYXRlIC09IGNvZF9pbmZvLnBhcnQyX2xlbmd0aDtcblxuICAgICAgICBmb3IgKDsgOykge1xuICAgICAgICAgICAgdmFyIHN0ZXA7XG4gICAgICAgICAgICBuQml0cyA9IHRrLmNvdW50X2JpdHMoZ2ZjLCB4cnBvdywgY29kX2luZm8sIG51bGwpO1xuXG4gICAgICAgICAgICBpZiAoQ3VycmVudFN0ZXAgPT0gMSB8fCBuQml0cyA9PSBkZXNpcmVkX3JhdGUpXG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAvKiBub3RoaW5nIHRvIGFkanVzdCBhbnltb3JlICovXG5cbiAgICAgICAgICAgIGlmIChuQml0cyA+IGRlc2lyZWRfcmF0ZSkge1xuICAgICAgICAgICAgICAgIC8qIGluY3JlYXNlIFF1YW50aXplX1N0ZXBTaXplICovXG4gICAgICAgICAgICAgICAgaWYgKERpcmVjdGlvbiA9PSBCaW5TZWFyY2hEaXJlY3Rpb24uQklOU0VBUkNIX0RPV04pXG4gICAgICAgICAgICAgICAgICAgIGZsYWdHb25lT3ZlciA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICBpZiAoZmxhZ0dvbmVPdmVyKVxuICAgICAgICAgICAgICAgICAgICBDdXJyZW50U3RlcCAvPSAyO1xuICAgICAgICAgICAgICAgIERpcmVjdGlvbiA9IEJpblNlYXJjaERpcmVjdGlvbi5CSU5TRUFSQ0hfVVA7XG4gICAgICAgICAgICAgICAgc3RlcCA9IEN1cnJlbnRTdGVwO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvKiBkZWNyZWFzZSBRdWFudGl6ZV9TdGVwU2l6ZSAqL1xuICAgICAgICAgICAgICAgIGlmIChEaXJlY3Rpb24gPT0gQmluU2VhcmNoRGlyZWN0aW9uLkJJTlNFQVJDSF9VUClcbiAgICAgICAgICAgICAgICAgICAgZmxhZ0dvbmVPdmVyID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgIGlmIChmbGFnR29uZU92ZXIpXG4gICAgICAgICAgICAgICAgICAgIEN1cnJlbnRTdGVwIC89IDI7XG4gICAgICAgICAgICAgICAgRGlyZWN0aW9uID0gQmluU2VhcmNoRGlyZWN0aW9uLkJJTlNFQVJDSF9ET1dOO1xuICAgICAgICAgICAgICAgIHN0ZXAgPSAtQ3VycmVudFN0ZXA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb2RfaW5mby5nbG9iYWxfZ2FpbiArPSBzdGVwO1xuICAgICAgICAgICAgaWYgKGNvZF9pbmZvLmdsb2JhbF9nYWluIDwgMCkge1xuICAgICAgICAgICAgICAgIGNvZF9pbmZvLmdsb2JhbF9nYWluID0gMDtcbiAgICAgICAgICAgICAgICBmbGFnR29uZU92ZXIgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvZF9pbmZvLmdsb2JhbF9nYWluID4gMjU1KSB7XG4gICAgICAgICAgICAgICAgY29kX2luZm8uZ2xvYmFsX2dhaW4gPSAyNTU7XG4gICAgICAgICAgICAgICAgZmxhZ0dvbmVPdmVyID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG5cbiAgICAgICAgd2hpbGUgKG5CaXRzID4gZGVzaXJlZF9yYXRlICYmIGNvZF9pbmZvLmdsb2JhbF9nYWluIDwgMjU1KSB7XG4gICAgICAgICAgICBjb2RfaW5mby5nbG9iYWxfZ2FpbisrO1xuICAgICAgICAgICAgbkJpdHMgPSB0ay5jb3VudF9iaXRzKGdmYywgeHJwb3csIGNvZF9pbmZvLCBudWxsKTtcbiAgICAgICAgfVxuICAgICAgICBnZmMuQ3VycmVudFN0ZXBbY2hdID0gKHN0YXJ0IC0gY29kX2luZm8uZ2xvYmFsX2dhaW4gPj0gNCkgPyA0IDogMjtcbiAgICAgICAgZ2ZjLk9sZFZhbHVlW2NoXSA9IGNvZF9pbmZvLmdsb2JhbF9nYWluO1xuICAgICAgICBjb2RfaW5mby5wYXJ0Ml8zX2xlbmd0aCA9IG5CaXRzO1xuICAgICAgICByZXR1cm4gbkJpdHM7XG4gICAgfVxuXG4gICAgdGhpcy50cmFuY2F0ZV9zbWFsbHNwZWN0cnVtcyA9IGZ1bmN0aW9uIChnZmMsIGdpLCBsM194bWluLCB3b3JrKSB7XG4gICAgICAgIHZhciBkaXN0b3J0ID0gbmV3X2Zsb2F0KEwzU2lkZS5TRkJNQVgpO1xuXG4gICAgICAgIGlmICgoMCA9PSAoZ2ZjLnN1YnN0ZXBfc2hhcGluZyAmIDQpICYmIGdpLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFKVxuICAgICAgICAgICAgfHwgKGdmYy5zdWJzdGVwX3NoYXBpbmcgJiAweDgwKSAhPSAwKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBxdXB2dC5jYWxjX25vaXNlKGdpLCBsM194bWluLCBkaXN0b3J0LCBuZXcgQ2FsY05vaXNlUmVzdWx0KCksIG51bGwpO1xuICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IDU3NjsgaisrKSB7XG4gICAgICAgICAgICB2YXIgeHIgPSAwLjA7XG4gICAgICAgICAgICBpZiAoZ2kubDNfZW5jW2pdICE9IDApXG4gICAgICAgICAgICAgICAgeHIgPSBNYXRoLmFicyhnaS54cltqXSk7XG4gICAgICAgICAgICB3b3JrW2pdID0geHI7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgaiA9IDA7XG4gICAgICAgIHZhciBzZmIgPSA4O1xuICAgICAgICBpZiAoZ2kuYmxvY2tfdHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpXG4gICAgICAgICAgICBzZmIgPSA2O1xuICAgICAgICBkbyB7XG4gICAgICAgICAgICB2YXIgYWxsb3dlZE5vaXNlLCB0cmFuY2F0ZVRocmVzaG9sZDtcbiAgICAgICAgICAgIHZhciBuc2FtZSwgc3RhcnQ7XG5cbiAgICAgICAgICAgIHZhciB3aWR0aCA9IGdpLndpZHRoW3NmYl07XG4gICAgICAgICAgICBqICs9IHdpZHRoO1xuICAgICAgICAgICAgaWYgKGRpc3RvcnRbc2ZiXSA+PSAxLjApXG4gICAgICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgICAgIEFycmF5cy5zb3J0KHdvcmssIGogLSB3aWR0aCwgd2lkdGgpO1xuICAgICAgICAgICAgaWYgKEJpdFN0cmVhbS5FUSh3b3JrW2ogLSAxXSwgMC4wKSlcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIC8qIGFsbCB6ZXJvIHNmYiAqL1xuXG4gICAgICAgICAgICBhbGxvd2VkTm9pc2UgPSAoMS4wIC0gZGlzdG9ydFtzZmJdKSAqIGwzX3htaW5bc2ZiXTtcbiAgICAgICAgICAgIHRyYW5jYXRlVGhyZXNob2xkID0gMC4wO1xuICAgICAgICAgICAgc3RhcnQgPSAwO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIHZhciBub2lzZTtcbiAgICAgICAgICAgICAgICBmb3IgKG5zYW1lID0gMTsgc3RhcnQgKyBuc2FtZSA8IHdpZHRoOyBuc2FtZSsrKVxuICAgICAgICAgICAgICAgICAgICBpZiAoQml0U3RyZWFtLk5FUSh3b3JrW3N0YXJ0ICsgaiAtIHdpZHRoXSwgd29ya1tzdGFydCArIGpcbiAgICAgICAgICAgICAgICAgICAgICAgICsgbnNhbWUgLSB3aWR0aF0pKVxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBub2lzZSA9IHdvcmtbc3RhcnQgKyBqIC0gd2lkdGhdICogd29ya1tzdGFydCArIGogLSB3aWR0aF1cbiAgICAgICAgICAgICAgICAgICAgKiBuc2FtZTtcbiAgICAgICAgICAgICAgICBpZiAoYWxsb3dlZE5vaXNlIDwgbm9pc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0ICE9IDApXG4gICAgICAgICAgICAgICAgICAgICAgICB0cmFuY2F0ZVRocmVzaG9sZCA9IHdvcmtbc3RhcnQgKyBqIC0gd2lkdGggLSAxXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGFsbG93ZWROb2lzZSAtPSBub2lzZTtcbiAgICAgICAgICAgICAgICBzdGFydCArPSBuc2FtZTtcbiAgICAgICAgICAgIH0gd2hpbGUgKHN0YXJ0IDwgd2lkdGgpO1xuICAgICAgICAgICAgaWYgKEJpdFN0cmVhbS5FUSh0cmFuY2F0ZVRocmVzaG9sZCwgMC4wKSlcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIGlmIChNYXRoLmFicyhnaS54cltqIC0gd2lkdGhdKSA8PSB0cmFuY2F0ZVRocmVzaG9sZClcbiAgICAgICAgICAgICAgICAgICAgZ2kubDNfZW5jW2ogLSB3aWR0aF0gPSAwO1xuICAgICAgICAgICAgfSB3aGlsZSAoLS13aWR0aCA+IDApO1xuICAgICAgICB9IHdoaWxlICgrK3NmYiA8IGdpLnBzeW1heCk7XG5cbiAgICAgICAgZ2kucGFydDJfM19sZW5ndGggPSB0ay5ub3F1YW50X2NvdW50X2JpdHMoZ2ZjLCBnaSwgbnVsbCk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIGF1dGhvci9kYXRlPz9cbiAgICAgKlxuICAgICAqIEZ1bmN0aW9uOiBSZXR1cm5zIHplcm8gaWYgdGhlcmUgaXMgYSBzY2FsZWZhYyB3aGljaCBoYXMgbm90IGJlZW5cbiAgICAgKiBhbXBsaWZpZWQuIE90aGVyd2lzZSBpdCByZXR1cm5zIG9uZS5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBsb29wX2JyZWFrKGNvZF9pbmZvKSB7XG4gICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IGNvZF9pbmZvLnNmYm1heDsgc2ZiKyspXG4gICAgICAgICAgICBpZiAoY29kX2luZm8uc2NhbGVmYWNbc2ZiXVxuICAgICAgICAgICAgICAgICsgY29kX2luZm8uc3ViYmxvY2tfZ2Fpbltjb2RfaW5mby53aW5kb3dbc2ZiXV0gPT0gMClcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLyogbXQgNS85OTogRnVuY3Rpb246IEltcHJvdmVkIGNhbGNfbm9pc2UgZm9yIGEgc2luZ2xlIGNoYW5uZWwgKi9cblxuICAgIGZ1bmN0aW9uIHBlbmFsdGllcyhub2lzZSkge1xuICAgICAgICByZXR1cm4gVXRpbC5GQVNUX0xPRzEwKCgwLjM2OCArIDAuNjMyICogbm9pc2UgKiBub2lzZSAqIG5vaXNlKSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogYXV0aG9yL2RhdGU/P1xuICAgICAqXG4gICAgICogc2V2ZXJhbCBkaWZmZXJlbnQgY29kZXMgdG8gZGVjaWRlIHdoaWNoIHF1YW50aXphdGlvbiBpcyBiZXR0ZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRfa2xlbW1fbm9pc2UoZGlzdG9ydCwgZ2kpIHtcbiAgICAgICAgdmFyIGtsZW1tX25vaXNlID0gMUUtMzc7XG4gICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IGdpLnBzeW1heDsgc2ZiKyspXG4gICAgICAgICAgICBrbGVtbV9ub2lzZSArPSBwZW5hbHRpZXMoZGlzdG9ydFtzZmJdKTtcblxuICAgICAgICByZXR1cm4gTWF0aC5tYXgoMWUtMjAsIGtsZW1tX25vaXNlKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBxdWFudF9jb21wYXJlKHF1YW50X2NvbXAsIGJlc3QsIGNhbGMsIGdpLCBkaXN0b3J0KSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBub2lzZSBpcyBnaXZlbiBpbiBkZWNpYmVscyAoZEIpIHJlbGF0aXZlIHRvIG1hc2tpbmcgdGhlc2hvbGRzLjxCUj5cbiAgICAgICAgICpcbiAgICAgICAgICogb3Zlcl9ub2lzZTogPz8/ICh0aGUgcHJldmlvdXMgY29tbWVudCBpcyBmdWxseSB3cm9uZyk8QlI+XG4gICAgICAgICAqIHRvdF9ub2lzZTogPz8/ICh0aGUgcHJldmlvdXMgY29tbWVudCBpcyBmdWxseSB3cm9uZyk8QlI+XG4gICAgICAgICAqIG1heF9ub2lzZTogbWF4IHF1YW50aXphdGlvbiBub2lzZVxuICAgICAgICAgKi9cbiAgICAgICAgdmFyIGJldHRlcjtcblxuICAgICAgICBzd2l0Y2ggKHF1YW50X2NvbXApIHtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBjYXNlIDk6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgaWYgKGJlc3Qub3Zlcl9jb3VudCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLyogdGhlcmUgYXJlIGRpc3RvcnRlZCBzZmIgKi9cbiAgICAgICAgICAgICAgICAgICAgYmV0dGVyID0gY2FsYy5vdmVyX1NTRCA8PSBiZXN0Lm92ZXJfU1NEO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2FsYy5vdmVyX1NTRCA9PSBiZXN0Lm92ZXJfU1NEKVxuICAgICAgICAgICAgICAgICAgICAgICAgYmV0dGVyID0gY2FsYy5iaXRzIDwgYmVzdC5iaXRzO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8qIG5vIGRpc3RvcnRlZCBzZmIgKi9cbiAgICAgICAgICAgICAgICAgICAgYmV0dGVyID0gKChjYWxjLm1heF9ub2lzZSA8IDApICYmICgoY2FsYy5tYXhfbm9pc2UgKiAxMCArIGNhbGMuYml0cykgPD0gKGJlc3QubWF4X25vaXNlICogMTAgKyBiZXN0LmJpdHMpKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICAgICAgYmV0dGVyID0gY2FsYy5vdmVyX2NvdW50IDwgYmVzdC5vdmVyX2NvdW50XG4gICAgICAgICAgICAgICAgICAgIHx8IChjYWxjLm92ZXJfY291bnQgPT0gYmVzdC5vdmVyX2NvdW50ICYmIGNhbGMub3Zlcl9ub2lzZSA8IGJlc3Qub3Zlcl9ub2lzZSlcbiAgICAgICAgICAgICAgICAgICAgfHwgKGNhbGMub3Zlcl9jb3VudCA9PSBiZXN0Lm92ZXJfY291bnRcbiAgICAgICAgICAgICAgICAgICAgJiYgQml0U3RyZWFtLkVRKGNhbGMub3Zlcl9ub2lzZSwgYmVzdC5vdmVyX25vaXNlKSAmJiBjYWxjLnRvdF9ub2lzZSA8IGJlc3QudG90X25vaXNlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSA4OlxuICAgICAgICAgICAgICAgIGNhbGMubWF4X25vaXNlID0gZ2V0X2tsZW1tX25vaXNlKGRpc3RvcnQsIGdpKTtcbiAgICAgICAgICAgIC8vJEZBTEwtVEhST1VHSCRcbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICBiZXR0ZXIgPSBjYWxjLm1heF9ub2lzZSA8IGJlc3QubWF4X25vaXNlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIGJldHRlciA9IGNhbGMudG90X25vaXNlIDwgYmVzdC50b3Rfbm9pc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgYmV0dGVyID0gKGNhbGMudG90X25vaXNlIDwgYmVzdC50b3Rfbm9pc2UpXG4gICAgICAgICAgICAgICAgICAgICYmIChjYWxjLm1heF9ub2lzZSA8IGJlc3QubWF4X25vaXNlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNDpcbiAgICAgICAgICAgICAgICBiZXR0ZXIgPSAoY2FsYy5tYXhfbm9pc2UgPD0gMC4wICYmIGJlc3QubWF4X25vaXNlID4gMC4yKVxuICAgICAgICAgICAgICAgICAgICB8fCAoY2FsYy5tYXhfbm9pc2UgPD0gMC4wICYmIGJlc3QubWF4X25vaXNlIDwgMC4wXG4gICAgICAgICAgICAgICAgICAgICYmIGJlc3QubWF4X25vaXNlID4gY2FsYy5tYXhfbm9pc2UgLSAwLjIgJiYgY2FsYy50b3Rfbm9pc2UgPCBiZXN0LnRvdF9ub2lzZSlcbiAgICAgICAgICAgICAgICAgICAgfHwgKGNhbGMubWF4X25vaXNlIDw9IDAuMCAmJiBiZXN0Lm1heF9ub2lzZSA+IDAuMFxuICAgICAgICAgICAgICAgICAgICAmJiBiZXN0Lm1heF9ub2lzZSA+IGNhbGMubWF4X25vaXNlIC0gMC4yICYmIGNhbGMudG90X25vaXNlIDwgYmVzdC50b3Rfbm9pc2VcbiAgICAgICAgICAgICAgICAgICAgKyBiZXN0Lm92ZXJfbm9pc2UpXG4gICAgICAgICAgICAgICAgICAgIHx8IChjYWxjLm1heF9ub2lzZSA+IDAuMCAmJiBiZXN0Lm1heF9ub2lzZSA+IC0wLjA1XG4gICAgICAgICAgICAgICAgICAgICYmIGJlc3QubWF4X25vaXNlID4gY2FsYy5tYXhfbm9pc2UgLSAwLjEgJiYgY2FsYy50b3Rfbm9pc2VcbiAgICAgICAgICAgICAgICAgICAgKyBjYWxjLm92ZXJfbm9pc2UgPCBiZXN0LnRvdF9ub2lzZVxuICAgICAgICAgICAgICAgICAgICArIGJlc3Qub3Zlcl9ub2lzZSlcbiAgICAgICAgICAgICAgICAgICAgfHwgKGNhbGMubWF4X25vaXNlID4gMC4wICYmIGJlc3QubWF4X25vaXNlID4gLTAuMVxuICAgICAgICAgICAgICAgICAgICAmJiBiZXN0Lm1heF9ub2lzZSA+IGNhbGMubWF4X25vaXNlIC0gMC4xNSAmJiBjYWxjLnRvdF9ub2lzZVxuICAgICAgICAgICAgICAgICAgICArIGNhbGMub3Zlcl9ub2lzZSArIGNhbGMub3Zlcl9ub2lzZSA8IGJlc3QudG90X25vaXNlXG4gICAgICAgICAgICAgICAgICAgICsgYmVzdC5vdmVyX25vaXNlICsgYmVzdC5vdmVyX25vaXNlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgNTpcbiAgICAgICAgICAgICAgICBiZXR0ZXIgPSBjYWxjLm92ZXJfbm9pc2UgPCBiZXN0Lm92ZXJfbm9pc2VcbiAgICAgICAgICAgICAgICAgICAgfHwgKEJpdFN0cmVhbS5FUShjYWxjLm92ZXJfbm9pc2UsIGJlc3Qub3Zlcl9ub2lzZSkgJiYgY2FsYy50b3Rfbm9pc2UgPCBiZXN0LnRvdF9ub2lzZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgYmV0dGVyID0gY2FsYy5vdmVyX25vaXNlIDwgYmVzdC5vdmVyX25vaXNlXG4gICAgICAgICAgICAgICAgICAgIHx8IChCaXRTdHJlYW0uRVEoY2FsYy5vdmVyX25vaXNlLCBiZXN0Lm92ZXJfbm9pc2UpICYmIChjYWxjLm1heF9ub2lzZSA8IGJlc3QubWF4X25vaXNlIHx8IChCaXRTdHJlYW1cbiAgICAgICAgICAgICAgICAgICAgICAgIC5FUShjYWxjLm1heF9ub2lzZSwgYmVzdC5tYXhfbm9pc2UpICYmIGNhbGMudG90X25vaXNlIDw9IGJlc3QudG90X25vaXNlKSkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgIGJldHRlciA9IGNhbGMub3Zlcl9jb3VudCA8IGJlc3Qub3Zlcl9jb3VudFxuICAgICAgICAgICAgICAgICAgICB8fCBjYWxjLm92ZXJfbm9pc2UgPCBiZXN0Lm92ZXJfbm9pc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYmVzdC5vdmVyX2NvdW50ID09IDApIHtcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBJZiBubyBkaXN0b3J0ZWQgYmFuZHMsIG9ubHkgdXNlIHRoaXMgcXVhbnRpemF0aW9uIGlmIGl0IGlzXG4gICAgICAgICAgICAgKiBiZXR0ZXIsIGFuZCBpZiBpdCB1c2VzIGxlc3MgYml0cy4gVW5mb3J0dW5hdGVseSwgcGFydDJfM19sZW5ndGhcbiAgICAgICAgICAgICAqIGlzIHNvbWV0aW1lcyBhIHBvb3IgZXN0aW1hdG9yIG9mIHRoZSBmaW5hbCBzaXplIGF0IGxvdyBiaXRyYXRlcy5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgYmV0dGVyID0gYmV0dGVyICYmIGNhbGMuYml0cyA8IGJlc3QuYml0cztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBiZXR0ZXI7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogYXV0aG9yL2RhdGU/P1xuICAgICAqXG4gICAgICogPFBSRT5cbiAgICAgKiAgQW1wbGlmeSB0aGUgc2NhbGVmYWN0b3IgYmFuZHMgdGhhdCB2aW9sYXRlIHRoZSBtYXNraW5nIHRocmVzaG9sZC5cbiAgICAgKiAgU2VlIElTTyAxMTE3Mi0zIFNlY3Rpb24gQy4xLjUuNC4zLjVcbiAgICAgKlxuICAgICAqICBkaXN0b3J0W10gPSBub2lzZS9tYXNraW5nXG4gICAgICogIGRpc3RvcnRbXSA+IDEgICA9PT4gbm9pc2UgaXMgbm90IG1hc2tlZFxuICAgICAqICBkaXN0b3J0W10gPCAxICAgPT0+IG5vaXNlIGlzIG1hc2tlZFxuICAgICAqICBtYXhfZGlzdCA9IG1heGltdW0gdmFsdWUgb2YgZGlzdG9ydFtdXG4gICAgICpcbiAgICAgKiAgVGhyZWUgYWxnb3JpdGhtczpcbiAgICAgKiAgbm9pc2Vfc2hhcGluZ19hbXBcbiAgICAgKiAgICAgICAgMCAgICAgICAgICAgICBBbXBsaWZ5IGFsbCBiYW5kcyB3aXRoIGRpc3RvcnRbXT4xLlxuICAgICAqXG4gICAgICogICAgICAgIDEgICAgICAgICAgICAgQW1wbGlmeSBhbGwgYmFuZHMgd2l0aCBkaXN0b3J0W10gPj0gbWF4X2Rpc3ReKC41KTtcbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICggNTAlIGluIHRoZSBkYiBzY2FsZSlcbiAgICAgKlxuICAgICAqICAgICAgICAyICAgICAgICAgICAgIEFtcGxpZnkgZmlyc3QgYmFuZCB3aXRoIGRpc3RvcnRbXSA+PSBtYXhfZGlzdDtcbiAgICAgKlxuICAgICAqXG4gICAgICogIEZvciBhbGdvcml0aG1zIDAgYW5kIDEsIGlmIG1heF9kaXN0IDwgMSwgdGhlbiBhbXBsaWZ5IGFsbCBiYW5kc1xuICAgICAqICB3aXRoIGRpc3RvcnRbXSA+PSAuOTUqbWF4X2Rpc3QuICBUaGlzIGlzIHRvIG1ha2Ugc3VyZSB3ZSBhbHdheXNcbiAgICAgKiAgYW1wbGlmeSBhdCBsZWFzdCBvbmUgYmFuZC5cbiAgICAgKiA8L1BSRT5cbiAgICAgKi9cbiAgICBmdW5jdGlvbiBhbXBfc2NhbGVmYWNfYmFuZHMoZ2ZwLCBjb2RfaW5mbywgZGlzdG9ydCwgeHJwb3csIGJSZWZpbmUpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGlmcXN0ZXAzNDtcblxuICAgICAgICBpZiAoY29kX2luZm8uc2NhbGVmYWNfc2NhbGUgPT0gMCkge1xuICAgICAgICAgICAgaWZxc3RlcDM0ID0gMS4yOTY4Mzk1NTQ2NTEwMDk2NDA1NTtcbiAgICAgICAgICAgIC8qIDIqKiguNzUqLjUpICovXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZnFzdGVwMzQgPSAxLjY4MTc5MjgzMDUwNzQyOTIyNjEyO1xuICAgICAgICAgICAgLyogMioqKC43NSoxKSAqL1xuICAgICAgICB9XG5cbiAgICAgICAgLyogY29tcHV0ZSBtYXhpbXVtIHZhbHVlIG9mIGRpc3RvcnRbXSAqL1xuICAgICAgICB2YXIgdHJpZ2dlciA9IDA7XG4gICAgICAgIGZvciAodmFyIHNmYiA9IDA7IHNmYiA8IGNvZF9pbmZvLnNmYm1heDsgc2ZiKyspIHtcbiAgICAgICAgICAgIGlmICh0cmlnZ2VyIDwgZGlzdG9ydFtzZmJdKVxuICAgICAgICAgICAgICAgIHRyaWdnZXIgPSBkaXN0b3J0W3NmYl07XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgbm9pc2Vfc2hhcGluZ19hbXAgPSBnZmMubm9pc2Vfc2hhcGluZ19hbXA7XG4gICAgICAgIGlmIChub2lzZV9zaGFwaW5nX2FtcCA9PSAzKSB7XG4gICAgICAgICAgICBpZiAoYlJlZmluZSlcbiAgICAgICAgICAgICAgICBub2lzZV9zaGFwaW5nX2FtcCA9IDI7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgbm9pc2Vfc2hhcGluZ19hbXAgPSAxO1xuICAgICAgICB9XG4gICAgICAgIHN3aXRjaCAobm9pc2Vfc2hhcGluZ19hbXApIHtcbiAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAvKiBhbXBsaWZ5IGV4YWN0bHkgMSBiYW5kICovXG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAvKiBhbXBsaWZ5IGJhbmRzIHdpdGhpbiA1MCUgb2YgbWF4IChvbiBkYiBzY2FsZSkgKi9cbiAgICAgICAgICAgICAgICBpZiAodHJpZ2dlciA+IDEuMClcbiAgICAgICAgICAgICAgICAgICAgdHJpZ2dlciA9IE1hdGgucG93KHRyaWdnZXIsIC41KTtcbiAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXIgKj0gLjk1O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIC8qIElTTyBhbGdvcml0aG0uIGFtcGxpZnkgYWxsIGJhbmRzIHdpdGggZGlzdG9ydD4xICovXG4gICAgICAgICAgICAgICAgaWYgKHRyaWdnZXIgPiAxLjApXG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXIgPSAxLjA7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICB0cmlnZ2VyICo9IC45NTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBqID0gMDtcbiAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgY29kX2luZm8uc2ZibWF4OyBzZmIrKykge1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gY29kX2luZm8ud2lkdGhbc2ZiXTtcbiAgICAgICAgICAgIHZhciBsO1xuICAgICAgICAgICAgaiArPSB3aWR0aDtcbiAgICAgICAgICAgIGlmIChkaXN0b3J0W3NmYl0gPCB0cmlnZ2VyKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICBpZiAoKGdmYy5zdWJzdGVwX3NoYXBpbmcgJiAyKSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgZ2ZjLnBzZXVkb2hhbGZbc2ZiXSA9ICgwID09IGdmYy5wc2V1ZG9oYWxmW3NmYl0pID8gMSA6IDA7XG4gICAgICAgICAgICAgICAgaWYgKDAgPT0gZ2ZjLnBzZXVkb2hhbGZbc2ZiXSAmJiBnZmMubm9pc2Vfc2hhcGluZ19hbXAgPT0gMilcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29kX2luZm8uc2NhbGVmYWNbc2ZiXSsrO1xuICAgICAgICAgICAgZm9yIChsID0gLXdpZHRoOyBsIDwgMDsgbCsrKSB7XG4gICAgICAgICAgICAgICAgeHJwb3dbaiArIGxdICo9IGlmcXN0ZXAzNDtcbiAgICAgICAgICAgICAgICBpZiAoeHJwb3dbaiArIGxdID4gY29kX2luZm8ueHJwb3dfbWF4KVxuICAgICAgICAgICAgICAgICAgICBjb2RfaW5mby54cnBvd19tYXggPSB4cnBvd1tqICsgbF07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChnZmMubm9pc2Vfc2hhcGluZ19hbXAgPT0gMilcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUYWtlaGlybyBUb21pbmFnYSAyMDAwLXh4LXh4XG4gICAgICpcbiAgICAgKiB0dXJucyBvbiBzY2FsZWZhYyBzY2FsZSBhbmQgYWRqdXN0cyBzY2FsZWZhY3RvcnNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBpbmNfc2NhbGVmYWNfc2NhbGUoY29kX2luZm8sIHhycG93KSB7XG4gICAgICAgIHZhciBpZnFzdGVwMzQgPSAxLjI5NjgzOTU1NDY1MTAwOTY0MDU1O1xuXG4gICAgICAgIHZhciBqID0gMDtcbiAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgY29kX2luZm8uc2ZibWF4OyBzZmIrKykge1xuICAgICAgICAgICAgdmFyIHdpZHRoID0gY29kX2luZm8ud2lkdGhbc2ZiXTtcbiAgICAgICAgICAgIHZhciBzID0gY29kX2luZm8uc2NhbGVmYWNbc2ZiXTtcbiAgICAgICAgICAgIGlmIChjb2RfaW5mby5wcmVmbGFnICE9IDApXG4gICAgICAgICAgICAgICAgcyArPSBxdXB2dC5wcmV0YWJbc2ZiXTtcbiAgICAgICAgICAgIGogKz0gd2lkdGg7XG4gICAgICAgICAgICBpZiAoKHMgJiAxKSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgcysrO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGwgPSAtd2lkdGg7IGwgPCAwOyBsKyspIHtcbiAgICAgICAgICAgICAgICAgICAgeHJwb3dbaiArIGxdICo9IGlmcXN0ZXAzNDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHhycG93W2ogKyBsXSA+IGNvZF9pbmZvLnhycG93X21heClcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvLnhycG93X21heCA9IHhycG93W2ogKyBsXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb2RfaW5mby5zY2FsZWZhY1tzZmJdID0gcyA+PiAxO1xuICAgICAgICB9XG4gICAgICAgIGNvZF9pbmZvLnByZWZsYWcgPSAwO1xuICAgICAgICBjb2RfaW5mby5zY2FsZWZhY19zY2FsZSA9IDE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGFrZWhpcm8gVG9taW5hZ2EgMjAwMC14eC14eFxuICAgICAqXG4gICAgICogaW5jcmVhc2VzIHRoZSBzdWJibG9jayBnYWluIGFuZCBhZGp1c3RzIHNjYWxlZmFjdG9yc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGluY19zdWJibG9ja19nYWluKGdmYywgY29kX2luZm8sIHhycG93KSB7XG4gICAgICAgIHZhciBzZmI7XG4gICAgICAgIHZhciBzY2FsZWZhYyA9IGNvZF9pbmZvLnNjYWxlZmFjO1xuXG4gICAgICAgIC8qIHN1YmJsb2NfZ2FpbiBjYW4ndCBkbyBhbnl0aGluZyBpbiB0aGUgbG9uZyBibG9jayByZWdpb24gKi9cbiAgICAgICAgZm9yIChzZmIgPSAwOyBzZmIgPCBjb2RfaW5mby5zZmJfbG1heDsgc2ZiKyspIHtcbiAgICAgICAgICAgIGlmIChzY2FsZWZhY1tzZmJdID49IDE2KVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgd2luZG93ID0gMDsgd2luZG93IDwgMzsgd2luZG93KyspIHtcbiAgICAgICAgICAgIHZhciBzMSA9IDA7XG4gICAgICAgICAgICB2YXIgczIgPSAwO1xuXG4gICAgICAgICAgICBmb3IgKHNmYiA9IGNvZF9pbmZvLnNmYl9sbWF4ICsgd2luZG93OyBzZmIgPCBjb2RfaW5mby5zZmJkaXZpZGU7IHNmYiArPSAzKSB7XG4gICAgICAgICAgICAgICAgaWYgKHMxIDwgc2NhbGVmYWNbc2ZiXSlcbiAgICAgICAgICAgICAgICAgICAgczEgPSBzY2FsZWZhY1tzZmJdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICg7IHNmYiA8IGNvZF9pbmZvLnNmYm1heDsgc2ZiICs9IDMpIHtcbiAgICAgICAgICAgICAgICBpZiAoczIgPCBzY2FsZWZhY1tzZmJdKVxuICAgICAgICAgICAgICAgICAgICBzMiA9IHNjYWxlZmFjW3NmYl07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzMSA8IDE2ICYmIHMyIDwgOClcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICAgICAgaWYgKGNvZF9pbmZvLnN1YmJsb2NrX2dhaW5bd2luZG93XSA+PSA3KVxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogZXZlbiB0aG91Z2ggdGhlcmUgaXMgbm8gc2NhbGVmYWN0b3IgZm9yIHNmYjEyIHN1YmJsb2NrIGdhaW5cbiAgICAgICAgICAgICAqIGFmZmVjdHMgdXBwZXIgZnJlcXVlbmNpZXMgdG9vLCB0aGF0J3Mgd2h5IHdlIGhhdmUgdG8gZ28gdXAgdG9cbiAgICAgICAgICAgICAqIFNCTUFYX3NcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29kX2luZm8uc3ViYmxvY2tfZ2Fpblt3aW5kb3ddKys7XG4gICAgICAgICAgICB2YXIgaiA9IGdmYy5zY2FsZWZhY19iYW5kLmxbY29kX2luZm8uc2ZiX2xtYXhdO1xuICAgICAgICAgICAgZm9yIChzZmIgPSBjb2RfaW5mby5zZmJfbG1heCArIHdpbmRvdzsgc2ZiIDwgY29kX2luZm8uc2ZibWF4OyBzZmIgKz0gMykge1xuICAgICAgICAgICAgICAgIHZhciBhbXA7XG4gICAgICAgICAgICAgICAgdmFyIHdpZHRoID0gY29kX2luZm8ud2lkdGhbc2ZiXTtcbiAgICAgICAgICAgICAgICB2YXIgcyA9IHNjYWxlZmFjW3NmYl07XG4gICAgICAgICAgICAgICAgcyA9IHMgLSAoNCA+PiBjb2RfaW5mby5zY2FsZWZhY19zY2FsZSk7XG4gICAgICAgICAgICAgICAgaWYgKHMgPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICBzY2FsZWZhY1tzZmJdID0gcztcbiAgICAgICAgICAgICAgICAgICAgaiArPSB3aWR0aCAqIDM7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHNjYWxlZmFjW3NmYl0gPSAwO1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdhaW4gPSAyMTAgKyAocyA8PCAoY29kX2luZm8uc2NhbGVmYWNfc2NhbGUgKyAxKSk7XG4gICAgICAgICAgICAgICAgICAgIGFtcCA9IHF1cHZ0LklQT1cyMChnYWluKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaiArPSB3aWR0aCAqICh3aW5kb3cgKyAxKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBsID0gLXdpZHRoOyBsIDwgMDsgbCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHhycG93W2ogKyBsXSAqPSBhbXA7XG4gICAgICAgICAgICAgICAgICAgIGlmICh4cnBvd1tqICsgbF0gPiBjb2RfaW5mby54cnBvd19tYXgpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RfaW5mby54cnBvd19tYXggPSB4cnBvd1tqICsgbF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGogKz0gd2lkdGggKiAoMyAtIHdpbmRvdyAtIDEpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIGFtcCA9IHF1cHZ0LklQT1cyMCgyMDIpO1xuICAgICAgICAgICAgICAgIGogKz0gY29kX2luZm8ud2lkdGhbc2ZiXSAqICh3aW5kb3cgKyAxKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBsID0gLWNvZF9pbmZvLndpZHRoW3NmYl07IGwgPCAwOyBsKyspIHtcbiAgICAgICAgICAgICAgICAgICAgeHJwb3dbaiArIGxdICo9IGFtcDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHhycG93W2ogKyBsXSA+IGNvZF9pbmZvLnhycG93X21heClcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvLnhycG93X21heCA9IHhycG93W2ogKyBsXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIDxQUkU+XG4gICAgICogIFRha2VoaXJvIFRvbWluYWdhIC9kYXRlPz9cbiAgICAgKiAgUm9iZXJ0IEhlZ2VtYW5uIDIwMDAtMDktMDY6IG1hZGUgYSBmdW5jdGlvbiBvZiBpdFxuICAgICAqXG4gICAgICogIGFtcGxpZmllcyBzY2FsZWZhY3RvciBiYW5kcyxcbiAgICAgKiAgIC0gaWYgYWxsIGFyZSBhbHJlYWR5IGFtcGxpZmllZCByZXR1cm5zIDBcbiAgICAgKiAgIC0gaWYgc29tZSBiYW5kcyBhcmUgYW1wbGlmaWVkIHRvbyBtdWNoOlxuICAgICAqICAgICAgKiB0cnkgdG8gaW5jcmVhc2Ugc2NhbGVmYWNfc2NhbGVcbiAgICAgKiAgICAgICogaWYgYWxyZWFkeSBzY2FsZWZhY19zY2FsZSB3YXMgc2V0XG4gICAgICogICAgICAgICAgdHJ5IG9uIHNob3J0IGJsb2NrcyB0byBpbmNyZWFzZSBzdWJibG9jayBnYWluXG4gICAgICogPC9QUkU+XG4gICAgICovXG4gICAgZnVuY3Rpb24gYmFsYW5jZV9ub2lzZShnZnAsIGNvZF9pbmZvLCBkaXN0b3J0LCB4cnBvdywgYlJlZmluZSkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXG4gICAgICAgIGFtcF9zY2FsZWZhY19iYW5kcyhnZnAsIGNvZF9pbmZvLCBkaXN0b3J0LCB4cnBvdywgYlJlZmluZSk7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogY2hlY2sgdG8gbWFrZSBzdXJlIHdlIGhhdmUgbm90IGFtcGxpZmllZCB0b28gbXVjaCBsb29wX2JyZWFrIHJldHVybnNcbiAgICAgICAgICogMCBpZiB0aGVyZSBpcyBhbiB1bmFtcGxpZmllZCBzY2FsZWZhYyBzY2FsZV9iaXRjb3VudCByZXR1cm5zIDAgaWYgbm9cbiAgICAgICAgICogc2NhbGVmYWN0b3JzIGFyZSB0b28gbGFyZ2VcbiAgICAgICAgICovXG5cbiAgICAgICAgdmFyIHN0YXR1cyA9IGxvb3BfYnJlYWsoY29kX2luZm8pO1xuXG4gICAgICAgIGlmIChzdGF0dXMpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIC8qIGFsbCBiYW5kcyBhbXBsaWZpZWQgKi9cblxuICAgICAgICAvKlxuICAgICAgICAgKiBub3QgYWxsIHNjYWxlZmFjdG9ycyBoYXZlIGJlZW4gYW1wbGlmaWVkLiBzbyB0aGVzZSBzY2FsZWZhY3MgYXJlXG4gICAgICAgICAqIHBvc3NpYmx5IHZhbGlkLiBlbmNvZGUgdGhlbTpcbiAgICAgICAgICovXG4gICAgICAgIGlmIChnZmMubW9kZV9nciA9PSAyKVxuICAgICAgICAgICAgc3RhdHVzID0gdGsuc2NhbGVfYml0Y291bnQoY29kX2luZm8pO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBzdGF0dXMgPSB0ay5zY2FsZV9iaXRjb3VudF9sc2YoZ2ZjLCBjb2RfaW5mbyk7XG5cbiAgICAgICAgaWYgKCFzdGF0dXMpXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgLyogYW1wbGlmaWVkIHNvbWUgYmFuZHMgbm90IGV4Y2VlZGluZyBsaW1pdHMgKi9cblxuICAgICAgICAvKlxuICAgICAgICAgKiBzb21lIHNjYWxlZmFjdG9ycyBhcmUgdG9vIGxhcmdlLiBsZXRzIHRyeSBzZXR0aW5nIHNjYWxlZmFjX3NjYWxlPTFcbiAgICAgICAgICovXG4gICAgICAgIGlmIChnZmMubm9pc2Vfc2hhcGluZyA+IDEpIHtcbiAgICAgICAgICAgIEFycmF5cy5maWxsKGdmYy5wc2V1ZG9oYWxmLCAwKTtcbiAgICAgICAgICAgIGlmICgwID09IGNvZF9pbmZvLnNjYWxlZmFjX3NjYWxlKSB7XG4gICAgICAgICAgICAgICAgaW5jX3NjYWxlZmFjX3NjYWxlKGNvZF9pbmZvLCB4cnBvdyk7XG4gICAgICAgICAgICAgICAgc3RhdHVzID0gZmFsc2U7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChjb2RfaW5mby5ibG9ja190eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRVxuICAgICAgICAgICAgICAgICAgICAmJiBnZmMuc3ViYmxvY2tfZ2FpbiA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzID0gKGluY19zdWJibG9ja19nYWluKGdmYywgY29kX2luZm8sIHhycG93KSB8fCBsb29wX2JyZWFrKGNvZF9pbmZvKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFzdGF0dXMpIHtcbiAgICAgICAgICAgIGlmIChnZmMubW9kZV9nciA9PSAyKVxuICAgICAgICAgICAgICAgIHN0YXR1cyA9IHRrLnNjYWxlX2JpdGNvdW50KGNvZF9pbmZvKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBzdGF0dXMgPSB0ay5zY2FsZV9iaXRjb3VudF9sc2YoZ2ZjLCBjb2RfaW5mbyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICFzdGF0dXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogPFBSRT5cbiAgICAgKiAgRnVuY3Rpb246IFRoZSBvdXRlciBpdGVyYXRpb24gbG9vcCBjb250cm9scyB0aGUgbWFza2luZyBjb25kaXRpb25zXG4gICAgICogIG9mIGFsbCBzY2FsZWZhY3RvcmJhbmRzLiBJdCBjb21wdXRlcyB0aGUgYmVzdCBzY2FsZWZhYyBhbmRcbiAgICAgKiAgZ2xvYmFsIGdhaW4uIFRoaXMgbW9kdWxlIGNhbGxzIHRoZSBpbm5lciBpdGVyYXRpb24gbG9vcFxuICAgICAqXG4gICAgICogIG10IDUvOTkgY29tcGxldGVseSByZXdyaXR0ZW4gdG8gYWxsb3cgZm9yIGJpdCByZXNlcnZvaXIgY29udHJvbCxcbiAgICAgKiAgbWlkL3NpZGUgY2hhbm5lbHMgd2l0aCBML1Igb3IgbWlkL3NpZGUgbWFza2luZyB0aHJlc2hvbGRzLFxuICAgICAqICBhbmQgY2hvb3NlcyBiZXN0IHF1YW50aXphdGlvbiBpbnN0ZWFkIG9mIGxhc3QgcXVhbnRpemF0aW9uIHdoZW5cbiAgICAgKiAgbm8gZGlzdG9ydGlvbiBmcmVlIHF1YW50aXphdGlvbiBjYW4gYmUgZm91bmQuXG4gICAgICpcbiAgICAgKiAgYWRkZWQgVkJSIHN1cHBvcnQgbXQgNS85OVxuXG4gICAgICpcbiAgICAgKiAgc29tZSBjb2RlIHNodWZmbGUgcmggOS8wMFxuICAgICAqIDwvUFJFPlxuICAgICAqXG4gICAgICogQHBhcmFtIGwzX3htaW5cbiAgICAgKiAgICAgICAgICAgIGFsbG93ZWQgZGlzdG9ydGlvblxuICAgICAqIEBwYXJhbSB4cnBvd1xuICAgICAqICAgICAgICAgICAgY29sb3VyZWQgbWFnbml0dWRlcyBvZiBzcGVjdHJhbFxuICAgICAqIEBwYXJhbSB0YXJnX2JpdHNcbiAgICAgKiAgICAgICAgICAgIG1heGltdW0gYWxsb3dlZCBiaXRzXG4gICAgICovXG4gICAgdGhpcy5vdXRlcl9sb29wID0gZnVuY3Rpb24gKGdmcCwgY29kX2luZm8sIGwzX3htaW4sIHhycG93LCBjaCwgdGFyZ19iaXRzKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBjb2RfaW5mb193ID0gbmV3IEdySW5mbygpO1xuICAgICAgICB2YXIgc2F2ZV94cnBvdyA9IG5ld19mbG9hdCg1NzYpO1xuICAgICAgICB2YXIgZGlzdG9ydCA9IG5ld19mbG9hdChMM1NpZGUuU0ZCTUFYKTtcbiAgICAgICAgdmFyIGJlc3Rfbm9pc2VfaW5mbyA9IG5ldyBDYWxjTm9pc2VSZXN1bHQoKTtcbiAgICAgICAgdmFyIGJldHRlcjtcbiAgICAgICAgdmFyIHByZXZfbm9pc2UgPSBuZXcgQ2FsY05vaXNlRGF0YSgpO1xuICAgICAgICB2YXIgYmVzdF9wYXJ0Ml8zX2xlbmd0aCA9IDk5OTk5OTk7XG4gICAgICAgIHZhciBiRW5kT2ZTZWFyY2ggPSBmYWxzZTtcbiAgICAgICAgdmFyIGJSZWZpbmUgPSBmYWxzZTtcbiAgICAgICAgdmFyIGJlc3RfZ2dhaW5fcGFzczEgPSAwO1xuXG4gICAgICAgIGJpbl9zZWFyY2hfU3RlcFNpemUoZ2ZjLCBjb2RfaW5mbywgdGFyZ19iaXRzLCBjaCwgeHJwb3cpO1xuXG4gICAgICAgIGlmICgwID09IGdmYy5ub2lzZV9zaGFwaW5nKVxuICAgICAgICAvKiBmYXN0IG1vZGUsIG5vIG5vaXNlIHNoYXBpbmcsIHdlIGFyZSByZWFkeSAqL1xuICAgICAgICAgICAgcmV0dXJuIDEwMDtcbiAgICAgICAgLyogZGVmYXVsdCBub2lzZV9pbmZvLm92ZXJfY291bnQgKi9cblxuICAgICAgICAvKiBjb21wdXRlIHRoZSBkaXN0b3J0aW9uIGluIHRoaXMgcXVhbnRpemF0aW9uICovXG4gICAgICAgIC8qIGNvZWZmaWNpZW50cyBhbmQgdGhyZXNob2xkcyBib3RoIGwvciAob3IgYm90aCBtaWQvc2lkZSkgKi9cbiAgICAgICAgcXVwdnQuY2FsY19ub2lzZShjb2RfaW5mbywgbDNfeG1pbiwgZGlzdG9ydCwgYmVzdF9ub2lzZV9pbmZvLFxuICAgICAgICAgICAgcHJldl9ub2lzZSk7XG4gICAgICAgIGJlc3Rfbm9pc2VfaW5mby5iaXRzID0gY29kX2luZm8ucGFydDJfM19sZW5ndGg7XG5cbiAgICAgICAgY29kX2luZm9fdy5hc3NpZ24oY29kX2luZm8pO1xuICAgICAgICB2YXIgYWdlID0gMDtcbiAgICAgICAgU3lzdGVtLmFycmF5Y29weSh4cnBvdywgMCwgc2F2ZV94cnBvdywgMCwgNTc2KTtcblxuICAgICAgICB3aGlsZSAoIWJFbmRPZlNlYXJjaCkge1xuICAgICAgICAgICAgLyogQkVHSU4gTUFJTiBMT09QICovXG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgdmFyIG5vaXNlX2luZm8gPSBuZXcgQ2FsY05vaXNlUmVzdWx0KCk7XG4gICAgICAgICAgICAgICAgdmFyIHNlYXJjaF9saW1pdDtcbiAgICAgICAgICAgICAgICB2YXIgbWF4Z2dhaW4gPSAyNTU7XG5cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIFdoZW4gcXVhbnRpemF0aW9uIHdpdGggbm8gZGlzdG9ydGVkIGJhbmRzIGlzIGZvdW5kLCBhbGxvdyB1cFxuICAgICAgICAgICAgICAgICAqIHRvIFggbmV3IHVuc3VjY2VzZnVsIHRyaWVzIGluIHNlcmlhbC4gVGhpcyBnaXZlcyB1cyBtb3JlXG4gICAgICAgICAgICAgICAgICogcG9zc2liaWxpdGllcyBmb3IgZGlmZmVyZW50IHF1YW50X2NvbXBhcmUgbW9kZXMuIE11Y2ggbW9yZVxuICAgICAgICAgICAgICAgICAqIHRoYW4gMyBtYWtlcyBub3QgYSBiaWcgZGlmZmVyZW5jZSwgaXQgaXMgb25seSBzbG93ZXIuXG4gICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICBpZiAoKGdmYy5zdWJzdGVwX3NoYXBpbmcgJiAyKSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlYXJjaF9saW1pdCA9IDIwO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNlYXJjaF9saW1pdCA9IDM7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBDaGVjayBpZiB0aGUgbGFzdCBzY2FsZWZhY3RvciBiYW5kIGlzIGRpc3RvcnRlZC4gaW4gVkJSIG1vZGVcbiAgICAgICAgICAgICAgICAgKiB3ZSBjYW4ndCBnZXQgcmlkIG9mIHRoZSBkaXN0b3J0aW9uLCBzbyBxdWl0IG5vdyBhbmQgVkJSIG1vZGVcbiAgICAgICAgICAgICAgICAgKiB3aWxsIHRyeSBhZ2FpbiB3aXRoIG1vcmUgYml0cy4gKG1ha2VzIGEgMTAlIHNwZWVkIGluY3JlYXNlLFxuICAgICAgICAgICAgICAgICAqIHRoZSBmaWxlcyBJIHRlc3RlZCB3ZXJlIGJpbmFyeSBpZGVudGljYWwsIDIwMDAvMDUvMjAgUm9iZXJ0XG4gICAgICAgICAgICAgICAgICogSGVnZW1hbm4pIGRpc3RvcnRbXSA+IDEgbWVhbnMgbm9pc2UgPiBhbGxvd2VkIG5vaXNlXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgaWYgKGdmYy5zZmIyMV9leHRyYSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGlzdG9ydFtjb2RfaW5mb193LnNmYm1heF0gPiAxLjApXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvZF9pbmZvX3cuYmxvY2tfdHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEVcbiAgICAgICAgICAgICAgICAgICAgICAgICYmIChkaXN0b3J0W2NvZF9pbmZvX3cuc2ZibWF4ICsgMV0gPiAxLjAgfHwgZGlzdG9ydFtjb2RfaW5mb193LnNmYm1heCArIDJdID4gMS4wKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qIHRyeSBhIG5ldyBzY2FsZWZhY3RvciBjb25iaW5hdGlvbiBvbiBjb2RfaW5mb193ICovXG4gICAgICAgICAgICAgICAgaWYgKCFiYWxhbmNlX25vaXNlKGdmcCwgY29kX2luZm9fdywgZGlzdG9ydCwgeHJwb3csIGJSZWZpbmUpKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBpZiAoY29kX2luZm9fdy5zY2FsZWZhY19zY2FsZSAhPSAwKVxuICAgICAgICAgICAgICAgICAgICBtYXhnZ2FpbiA9IDI1NDtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogaW5uZXJfbG9vcCBzdGFydHMgd2l0aCB0aGUgaW5pdGlhbCBxdWFudGl6YXRpb24gc3RlcCBjb21wdXRlZFxuICAgICAgICAgICAgICAgICAqIGFib3ZlIGFuZCBzbG93bHkgaW5jcmVhc2VzIHVudGlsIHRoZSBiaXRzIDwgaHVmZl9iaXRzLiBUaHVzXG4gICAgICAgICAgICAgICAgICogaXQgaXMgaW1wb3J0YW50IG5vdCB0byBzdGFydCB3aXRoIHRvbyBsYXJnZSBvZiBhbiBpbml0YWxcbiAgICAgICAgICAgICAgICAgKiBxdWFudGl6YXRpb24gc3RlcC4gVG9vIHNtYWxsIGlzIG9rLCBidXQgaW5uZXJfbG9vcCB3aWxsIHRha2VcbiAgICAgICAgICAgICAgICAgKiBsb25nZXJcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICB2YXIgaHVmZl9iaXRzID0gdGFyZ19iaXRzIC0gY29kX2luZm9fdy5wYXJ0Ml9sZW5ndGg7XG4gICAgICAgICAgICAgICAgaWYgKGh1ZmZfYml0cyA8PSAwKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogaW5jcmVhc2UgcXVhbnRpemVyIHN0ZXBzaXplIHVudGlsIG5lZWRlZCBiaXRzIGFyZSBiZWxvd1xuICAgICAgICAgICAgICAgICAqIG1heGltdW1cbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICB3aGlsZSAoKGNvZF9pbmZvX3cucGFydDJfM19sZW5ndGggPSB0ay5jb3VudF9iaXRzKGdmYywgeHJwb3csXG4gICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvX3csIHByZXZfbm9pc2UpKSA+IGh1ZmZfYml0c1xuICAgICAgICAgICAgICAgICYmIGNvZF9pbmZvX3cuZ2xvYmFsX2dhaW4gPD0gbWF4Z2dhaW4pXG4gICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvX3cuZ2xvYmFsX2dhaW4rKztcblxuICAgICAgICAgICAgICAgIGlmIChjb2RfaW5mb193Lmdsb2JhbF9nYWluID4gbWF4Z2dhaW4pXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgaWYgKGJlc3Rfbm9pc2VfaW5mby5vdmVyX2NvdW50ID09IDApIHtcblxuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoKGNvZF9pbmZvX3cucGFydDJfM19sZW5ndGggPSB0ay5jb3VudF9iaXRzKGdmYyxcbiAgICAgICAgICAgICAgICAgICAgICAgIHhycG93LCBjb2RfaW5mb193LCBwcmV2X25vaXNlKSkgPiBiZXN0X3BhcnQyXzNfbGVuZ3RoXG4gICAgICAgICAgICAgICAgICAgICYmIGNvZF9pbmZvX3cuZ2xvYmFsX2dhaW4gPD0gbWF4Z2dhaW4pXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RfaW5mb193Lmdsb2JhbF9nYWluKys7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvZF9pbmZvX3cuZ2xvYmFsX2dhaW4gPiBtYXhnZ2FpbilcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8qIGNvbXB1dGUgdGhlIGRpc3RvcnRpb24gaW4gdGhpcyBxdWFudGl6YXRpb24gKi9cbiAgICAgICAgICAgICAgICBxdXB2dC5jYWxjX25vaXNlKGNvZF9pbmZvX3csIGwzX3htaW4sIGRpc3RvcnQsIG5vaXNlX2luZm8sXG4gICAgICAgICAgICAgICAgICAgIHByZXZfbm9pc2UpO1xuICAgICAgICAgICAgICAgIG5vaXNlX2luZm8uYml0cyA9IGNvZF9pbmZvX3cucGFydDJfM19sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIGNoZWNrIGlmIHRoaXMgcXVhbnRpemF0aW9uIGlzIGJldHRlciB0aGFuIG91ciBzYXZlZFxuICAgICAgICAgICAgICAgICAqIHF1YW50aXphdGlvblxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGlmIChjb2RfaW5mby5ibG9ja190eXBlICE9IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBOT1JNLCBTVEFSVCBvciBTVE9QIHR5cGVcbiAgICAgICAgICAgICAgICAgICAgYmV0dGVyID0gZ2ZwLnF1YW50X2NvbXA7XG4gICAgICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgICAgIGJldHRlciA9IGdmcC5xdWFudF9jb21wX3Nob3J0O1xuXG4gICAgICAgICAgICAgICAgYmV0dGVyID0gcXVhbnRfY29tcGFyZShiZXR0ZXIsIGJlc3Rfbm9pc2VfaW5mbywgbm9pc2VfaW5mbyxcbiAgICAgICAgICAgICAgICAgICAgY29kX2luZm9fdywgZGlzdG9ydCkgPyAxIDogMDtcblxuICAgICAgICAgICAgICAgIC8qIHNhdmUgZGF0YSBzbyB3ZSBjYW4gcmVzdG9yZSB0aGlzIHF1YW50aXphdGlvbiBsYXRlciAqL1xuICAgICAgICAgICAgICAgIGlmIChiZXR0ZXIgIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBiZXN0X3BhcnQyXzNfbGVuZ3RoID0gY29kX2luZm8ucGFydDJfM19sZW5ndGg7XG4gICAgICAgICAgICAgICAgICAgIGJlc3Rfbm9pc2VfaW5mbyA9IG5vaXNlX2luZm87XG4gICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvLmFzc2lnbihjb2RfaW5mb193KTtcbiAgICAgICAgICAgICAgICAgICAgYWdlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgLyogc2F2ZSBkYXRhIHNvIHdlIGNhbiByZXN0b3JlIHRoaXMgcXVhbnRpemF0aW9uIGxhdGVyICovXG4gICAgICAgICAgICAgICAgICAgIC8qIHN0b3JlIGZvciBsYXRlciByZXVzZSAqL1xuICAgICAgICAgICAgICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KHhycG93LCAwLCBzYXZlX3hycG93LCAwLCA1NzYpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8qIGVhcmx5IHN0b3A/ICovXG4gICAgICAgICAgICAgICAgICAgIGlmIChnZmMuZnVsbF9vdXRlcl9sb29wID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgrK2FnZSA+IHNlYXJjaF9saW1pdFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIGJlc3Rfbm9pc2VfaW5mby5vdmVyX2NvdW50ID09IDApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoKGdmYy5ub2lzZV9zaGFwaW5nX2FtcCA9PSAzKSAmJiBiUmVmaW5lICYmIGFnZSA+IDMwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChnZmMubm9pc2Vfc2hhcGluZ19hbXAgPT0gMylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiBiUmVmaW5lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgKGNvZF9pbmZvX3cuZ2xvYmFsX2dhaW4gLSBiZXN0X2dnYWluX3Bhc3MxKSA+IDE1KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB3aGlsZSAoKGNvZF9pbmZvX3cuZ2xvYmFsX2dhaW4gKyBjb2RfaW5mb193LnNjYWxlZmFjX3NjYWxlKSA8IDI1NSk7XG5cbiAgICAgICAgICAgIGlmIChnZmMubm9pc2Vfc2hhcGluZ19hbXAgPT0gMykge1xuICAgICAgICAgICAgICAgIGlmICghYlJlZmluZSkge1xuICAgICAgICAgICAgICAgICAgICAvKiByZWZpbmUgc2VhcmNoICovXG4gICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvX3cuYXNzaWduKGNvZF9pbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgU3lzdGVtLmFycmF5Y29weShzYXZlX3hycG93LCAwLCB4cnBvdywgMCwgNTc2KTtcbiAgICAgICAgICAgICAgICAgICAgYWdlID0gMDtcbiAgICAgICAgICAgICAgICAgICAgYmVzdF9nZ2Fpbl9wYXNzMSA9IGNvZF9pbmZvX3cuZ2xvYmFsX2dhaW47XG5cbiAgICAgICAgICAgICAgICAgICAgYlJlZmluZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLyogc2VhcmNoIGFscmVhZHkgcmVmaW5lZCwgc3RvcCAqL1xuICAgICAgICAgICAgICAgICAgICBiRW5kT2ZTZWFyY2ggPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBiRW5kT2ZTZWFyY2ggPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgICogZmluaXNoIHVwXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9yaCB8fCBnZnAuVkJSID09IFZick1vZGUudmJyX210cmgpXG4gICAgICAgIC8qIHJlc3RvcmUgZm9yIHJldXNlIG9uIG5leHQgdHJ5ICovXG4gICAgICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KHNhdmVfeHJwb3csIDAsIHhycG93LCAwLCA1NzYpO1xuICAgICAgICAvKlxuICAgICAgICAgKiBkbyB0aGUgJ3N1YnN0ZXAgc2hhcGluZydcbiAgICAgICAgICovXG4gICAgICAgIGVsc2UgaWYgKChnZmMuc3Vic3RlcF9zaGFwaW5nICYgMSkgIT0gMClcbiAgICAgICAgICAgIHRyYW5jYXRlX3NtYWxsc3BlY3RydW1zKGdmYywgY29kX2luZm8sIGwzX3htaW4sIHhycG93KTtcblxuICAgICAgICByZXR1cm4gYmVzdF9ub2lzZV9pbmZvLm92ZXJfY291bnQ7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUm9iZXJ0IEhlZ2VtYW5uIDIwMDAtMDktMDZcbiAgICAgKlxuICAgICAqIHVwZGF0ZSByZXNlcnZvaXIgc3RhdHVzIGFmdGVyIEZJTkFMIHF1YW50aXphdGlvbi9iaXRyYXRlXG4gICAgICovXG4gICAgdGhpcy5pdGVyYXRpb25fZmluaXNoX29uZSA9IGZ1bmN0aW9uIChnZmMsIGdyLCBjaCkge1xuICAgICAgICB2YXIgbDNfc2lkZSA9IGdmYy5sM19zaWRlO1xuICAgICAgICB2YXIgY29kX2luZm8gPSBsM19zaWRlLnR0W2dyXVtjaF07XG5cbiAgICAgICAgLypcbiAgICAgICAgICogdHJ5IHNvbWUgYmV0dGVyIHNjYWxlZmFjIHN0b3JhZ2VcbiAgICAgICAgICovXG4gICAgICAgIHRrLmJlc3Rfc2NhbGVmYWNfc3RvcmUoZ2ZjLCBnciwgY2gsIGwzX3NpZGUpO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGJlc3QgaHVmZm1hbl9kaXZpZGUgbWF5IHNhdmUgc29tZSBiaXRzIHRvb1xuICAgICAgICAgKi9cbiAgICAgICAgaWYgKGdmYy51c2VfYmVzdF9odWZmbWFuID09IDEpXG4gICAgICAgICAgICB0ay5iZXN0X2h1ZmZtYW5fZGl2aWRlKGdmYywgY29kX2luZm8pO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHVwZGF0ZSByZXNlcnZvaXIgc3RhdHVzIGFmdGVyIEZJTkFMIHF1YW50aXphdGlvbi9iaXRyYXRlXG4gICAgICAgICAqL1xuICAgICAgICBydi5SZXN2QWRqdXN0KGdmYywgY29kX2luZm8pO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqIDIwMDAtMDktMDQgUm9iZXJ0IEhlZ2VtYW5uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gbDNfeG1pblxuICAgICAqICAgICAgICAgICAgYWxsb3dlZCBkaXN0b3J0aW9uIG9mIHRoZSBzY2FsZWZhY3RvclxuICAgICAqIEBwYXJhbSB4cnBvd1xuICAgICAqICAgICAgICAgICAgY29sb3VyZWQgbWFnbml0dWRlcyBvZiBzcGVjdHJhbCB2YWx1ZXNcbiAgICAgKi9cbiAgICB0aGlzLlZCUl9lbmNvZGVfZ3JhbnVsZSA9IGZ1bmN0aW9uIChnZnAsIGNvZF9pbmZvLCBsM194bWluLCB4cnBvdywgY2gsIG1pbl9iaXRzLCBtYXhfYml0cykge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgYnN0X2NvZF9pbmZvID0gbmV3IEdySW5mbygpO1xuICAgICAgICB2YXIgYnN0X3hycG93ID0gbmV3X2Zsb2F0KDU3Nik7XG4gICAgICAgIHZhciBNYXhfYml0cyA9IG1heF9iaXRzO1xuICAgICAgICB2YXIgcmVhbF9iaXRzID0gbWF4X2JpdHMgKyAxO1xuICAgICAgICB2YXIgdGhpc19iaXRzID0gKG1heF9iaXRzICsgbWluX2JpdHMpIC8gMjtcbiAgICAgICAgdmFyIGRiaXRzLCBvdmVyLCBmb3VuZCA9IDA7XG4gICAgICAgIHZhciBzZmIyMV9leHRyYSA9IGdmYy5zZmIyMV9leHRyYTtcblxuICAgICAgICBBcnJheXMuZmlsbChic3RfY29kX2luZm8ubDNfZW5jLCAwKTtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBzZWFyY2ggd2l0aGluIHJvdW5kIGFib3V0IDQwIGJpdHMgb2Ygb3B0aW1hbFxuICAgICAgICAgKi9cbiAgICAgICAgZG8ge1xuXG4gICAgICAgICAgICBpZiAodGhpc19iaXRzID4gTWF4X2JpdHMgLSA0MilcbiAgICAgICAgICAgICAgICBnZmMuc2ZiMjFfZXh0cmEgPSBmYWxzZTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBnZmMuc2ZiMjFfZXh0cmEgPSBzZmIyMV9leHRyYTtcblxuICAgICAgICAgICAgb3ZlciA9IG91dGVyX2xvb3AoZ2ZwLCBjb2RfaW5mbywgbDNfeG1pbiwgeHJwb3csIGNoLCB0aGlzX2JpdHMpO1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogaXMgcXVhbnRpemF0aW9uIGFzIGdvb2QgYXMgd2UgYXJlIGxvb2tpbmcgZm9yID8gaW4gdGhpcyBjYXNlOiBpc1xuICAgICAgICAgICAgICogbm8gc2NhbGVmYWN0b3IgYmFuZCBkaXN0b3J0ZWQ/XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGlmIChvdmVyIDw9IDApIHtcbiAgICAgICAgICAgICAgICBmb3VuZCA9IDE7XG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBub3cgd2Uga25vdyBpdCBjYW4gYmUgZG9uZSB3aXRoIFwicmVhbF9iaXRzXCIgYW5kIG1heWJlIHdlIGNhblxuICAgICAgICAgICAgICAgICAqIHNraXAgc29tZSBpdGVyYXRpb25zXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgcmVhbF9iaXRzID0gY29kX2luZm8ucGFydDJfM19sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIHN0b3JlIGJlc3QgcXVhbnRpemF0aW9uIHNvIGZhclxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGJzdF9jb2RfaW5mby5hc3NpZ24oY29kX2luZm8pO1xuICAgICAgICAgICAgICAgIFN5c3RlbS5hcnJheWNvcHkoeHJwb3csIDAsIGJzdF94cnBvdywgMCwgNTc2KTtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogdHJ5IHdpdGggZmV3ZXIgYml0c1xuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIG1heF9iaXRzID0gcmVhbF9iaXRzIC0gMzI7XG4gICAgICAgICAgICAgICAgZGJpdHMgPSBtYXhfYml0cyAtIG1pbl9iaXRzO1xuICAgICAgICAgICAgICAgIHRoaXNfYml0cyA9IChtYXhfYml0cyArIG1pbl9iaXRzKSAvIDI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogdHJ5IHdpdGggbW9yZSBiaXRzXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgbWluX2JpdHMgPSB0aGlzX2JpdHMgKyAzMjtcbiAgICAgICAgICAgICAgICBkYml0cyA9IG1heF9iaXRzIC0gbWluX2JpdHM7XG4gICAgICAgICAgICAgICAgdGhpc19iaXRzID0gKG1heF9iaXRzICsgbWluX2JpdHMpIC8gMjtcblxuICAgICAgICAgICAgICAgIGlmIChmb3VuZCAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvdW5kID0gMjtcbiAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICogc3RhcnQgYWdhaW4gd2l0aCBiZXN0IHF1YW50aXphdGlvbiBzbyBmYXJcbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvLmFzc2lnbihic3RfY29kX2luZm8pO1xuICAgICAgICAgICAgICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KGJzdF94cnBvdywgMCwgeHJwb3csIDAsIDU3Nik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IHdoaWxlIChkYml0cyA+IDEyKTtcblxuICAgICAgICBnZmMuc2ZiMjFfZXh0cmEgPSBzZmIyMV9leHRyYTtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBmb3VuZD0wID0+IG5vdGhpbmcgZm91bmQsIHVzZSBsYXN0IG9uZSBmb3VuZD0xID0+IHdlIGp1c3QgZm91bmQgdGhlXG4gICAgICAgICAqIGJlc3QgYW5kIGxlZnQgdGhlIGxvb3AgZm91bmQ9MiA9PiB3ZSByZXN0b3JlZCBhIGdvb2Qgb25lIGFuZCBoYXZlIG5vd1xuICAgICAgICAgKiBsM19lbmMgdG8gcmVzdG9yZSB0b29cbiAgICAgICAgICovXG4gICAgICAgIGlmIChmb3VuZCA9PSAyKSB7XG4gICAgICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KGJzdF9jb2RfaW5mby5sM19lbmMsIDAsIGNvZF9pbmZvLmwzX2VuYywgMCwgNTc2KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJvYmVydCBIZWdlbWFubiAyMDAwLTA5LTA1XG4gICAgICpcbiAgICAgKiBjYWxjdWxhdGVzICogaG93IG1hbnkgYml0cyBhcmUgYXZhaWxhYmxlIGZvciBhbmFsb2cgc2lsZW50IGdyYW51bGVzICogaG93XG4gICAgICogbWFueSBiaXRzIHRvIHVzZSBmb3IgdGhlIGxvd2VzdCBhbGxvd2VkIGJpdHJhdGUgKiBob3cgbWFueSBiaXRzIGVhY2hcbiAgICAgKiBiaXRyYXRlIHdvdWxkIHByb3ZpZGVcbiAgICAgKi9cbiAgICB0aGlzLmdldF9mcmFtZWJpdHMgPSBmdW5jdGlvbiAoZ2ZwLCBmcmFtZUJpdHMpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblxuICAgICAgICAvKlxuICAgICAgICAgKiBhbHdheXMgdXNlIGF0IGxlYXN0IHRoaXMgbWFueSBiaXRzIHBlciBncmFudWxlIHBlciBjaGFubmVsIHVubGVzcyB3ZVxuICAgICAgICAgKiBkZXRlY3QgYW5hbG9nIHNpbGVuY2UsIHNlZSBiZWxvd1xuICAgICAgICAgKi9cbiAgICAgICAgZ2ZjLmJpdHJhdGVfaW5kZXggPSBnZmMuVkJSX21pbl9iaXRyYXRlO1xuICAgICAgICB2YXIgYml0c1BlckZyYW1lID0gYnMuZ2V0ZnJhbWViaXRzKGdmcCk7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogYml0cyBmb3IgYW5hbG9nIHNpbGVuY2VcbiAgICAgICAgICovXG4gICAgICAgIGdmYy5iaXRyYXRlX2luZGV4ID0gMTtcbiAgICAgICAgYml0c1BlckZyYW1lID0gYnMuZ2V0ZnJhbWViaXRzKGdmcCk7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gZ2ZjLlZCUl9tYXhfYml0cmF0ZTsgaSsrKSB7XG4gICAgICAgICAgICBnZmMuYml0cmF0ZV9pbmRleCA9IGk7XG4gICAgICAgICAgICB2YXIgbWIgPSBuZXcgTWVhbkJpdHMoYml0c1BlckZyYW1lKTtcbiAgICAgICAgICAgIGZyYW1lQml0c1tpXSA9IHJ2LlJlc3ZGcmFtZUJlZ2luKGdmcCwgbWIpO1xuICAgICAgICAgICAgYml0c1BlckZyYW1lID0gbWIuYml0cztcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKiBSSDogdGhpcyBvbmUgbmVlZHMgdG8gYmUgb3ZlcmhhdWxlZCBzb21ldGltZSAqL1xuXG4gICAgLyoqXG4gICAgICogPFBSRT5cbiAgICAgKiAgMjAwMC0wOS0wNCBSb2JlcnQgSGVnZW1hbm5cbiAgICAgKlxuICAgICAqICAqIGNvbnZlcnRzIExSIHRvIE1TIGNvZGluZyB3aGVuIG5lY2Vzc2FyeVxuICAgICAqICAqIGNhbGN1bGF0ZXMgYWxsb3dlZC9hZGp1c3RlZCBxdWFudGl6YXRpb24gbm9pc2UgYW1vdW50c1xuICAgICAqICAqIGRldGVjdHMgYW5hbG9nIHNpbGVudCBmcmFtZXNcbiAgICAgKlxuICAgICAqICBzb21lIHJlbWFya3M6XG4gICAgICogIC0gbG93ZXIgbWFza2luZyBkZXBlbmRpbmcgb24gUXVhbGl0eSBzZXR0aW5nXG4gICAgICogIC0gcXVhbGl0eSBjb250cm9sIHRvZ2V0aGVyIHdpdGggYWRqdXN0ZWQgQVRIIE1EQ1Qgc2NhbGluZ1xuICAgICAqICAgIG9uIGxvd2VyIHF1YWxpdHkgc2V0dGluZyBhbGxvY2F0ZSBtb3JlIG5vaXNlIGZyb21cbiAgICAgKiAgICBBVEggbWFza2luZywgYW5kIG9uIGhpZ2hlciBxdWFsaXR5IHNldHRpbmcgYWxsb2NhdGVcbiAgICAgKiAgICBsZXNzIG5vaXNlIGZyb20gQVRIIG1hc2tpbmcuXG4gICAgICogIC0gZXhwZXJpbWVudHMgc2hvdyB0aGF0IGdvaW5nIG1vcmUgdGhhbiAyZEIgb3ZlciBHUFNZQ0hPJ3NcbiAgICAgKiAgICBsaW1pdHMgZW5kcyB1cCBpbiB2ZXJ5IGFubm95aW5nIGFydGVmYWN0c1xuICAgICAqIDwvUFJFPlxuICAgICAqL1xuICAgIHRoaXMuVkJSX29sZF9wcmVwYXJlID0gZnVuY3Rpb24gKGdmcCwgcGUsIG1zX2VuZXJfcmF0aW8sIHJhdGlvLCBsM194bWluLCBmcmFtZUJpdHMsIG1pbl9iaXRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heF9iaXRzLCBiYW5kcykge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXG4gICAgICAgIHZhciBtYXNraW5nX2xvd2VyX2RiLCBhZGp1c3QgPSAwLjA7XG4gICAgICAgIHZhciBhbmFsb2dfc2lsZW5jZSA9IDE7XG4gICAgICAgIHZhciBiaXRzID0gMDtcblxuICAgICAgICBnZmMuYml0cmF0ZV9pbmRleCA9IGdmYy5WQlJfbWF4X2JpdHJhdGU7XG4gICAgICAgIHZhciBhdmcgPSBydi5SZXN2RnJhbWVCZWdpbihnZnAsIG5ldyBNZWFuQml0cygwKSkgLyBnZmMubW9kZV9ncjtcblxuICAgICAgICBnZXRfZnJhbWViaXRzKGdmcCwgZnJhbWVCaXRzKTtcblxuICAgICAgICBmb3IgKHZhciBnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcbiAgICAgICAgICAgIHZhciBteGIgPSBxdXB2dC5vbl9wZShnZnAsIHBlLCBtYXhfYml0c1tncl0sIGF2ZywgZ3IsIDApO1xuICAgICAgICAgICAgaWYgKGdmYy5tb2RlX2V4dCA9PSBFbmNvZGVyLk1QR19NRF9NU19MUikge1xuICAgICAgICAgICAgICAgIG1zX2NvbnZlcnQoZ2ZjLmwzX3NpZGUsIGdyKTtcbiAgICAgICAgICAgICAgICBxdXB2dC5yZWR1Y2Vfc2lkZShtYXhfYml0c1tncl0sIG1zX2VuZXJfcmF0aW9bZ3JdLCBhdmcsIG14Yik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgKytjaCkge1xuICAgICAgICAgICAgICAgIHZhciBjb2RfaW5mbyA9IGdmYy5sM19zaWRlLnR0W2dyXVtjaF07XG5cbiAgICAgICAgICAgICAgICBpZiAoY29kX2luZm8uYmxvY2tfdHlwZSAhPSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTk9STSwgU1RBUlQgb3IgU1RPUCB0eXBlXG4gICAgICAgICAgICAgICAgICAgIGFkanVzdCA9IDEuMjggLyAoMSArIE1hdGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZXhwKDMuNSAtIHBlW2dyXVtjaF0gLyAzMDAuKSkgLSAwLjA1O1xuICAgICAgICAgICAgICAgICAgICBtYXNraW5nX2xvd2VyX2RiID0gZ2ZjLlBTWS5tYXNrX2FkanVzdCAtIGFkanVzdDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBhZGp1c3QgPSAyLjU2IC8gKDEgKyBNYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmV4cCgzLjUgLSBwZVtncl1bY2hdIC8gMzAwLikpIC0gMC4xNDtcbiAgICAgICAgICAgICAgICAgICAgbWFza2luZ19sb3dlcl9kYiA9IGdmYy5QU1kubWFza19hZGp1c3Rfc2hvcnQgLSBhZGp1c3Q7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGdmYy5tYXNraW5nX2xvd2VyID0gTWF0aC5wb3coMTAuMCxcbiAgICAgICAgICAgICAgICAgICAgbWFza2luZ19sb3dlcl9kYiAqIDAuMSk7XG5cbiAgICAgICAgICAgICAgICBpbml0X291dGVyX2xvb3AoZ2ZjLCBjb2RfaW5mbyk7XG4gICAgICAgICAgICAgICAgYmFuZHNbZ3JdW2NoXSA9IHF1cHZ0LmNhbGNfeG1pbihnZnAsIHJhdGlvW2dyXVtjaF0sIGNvZF9pbmZvLFxuICAgICAgICAgICAgICAgICAgICBsM194bWluW2dyXVtjaF0pO1xuICAgICAgICAgICAgICAgIGlmIChiYW5kc1tncl1bY2hdICE9IDApXG4gICAgICAgICAgICAgICAgICAgIGFuYWxvZ19zaWxlbmNlID0gMDtcblxuICAgICAgICAgICAgICAgIG1pbl9iaXRzW2dyXVtjaF0gPSAxMjY7XG5cbiAgICAgICAgICAgICAgICBiaXRzICs9IG1heF9iaXRzW2dyXVtjaF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgIGlmIChiaXRzID4gZnJhbWVCaXRzW2dmYy5WQlJfbWF4X2JpdHJhdGVdKSB7XG4gICAgICAgICAgICAgICAgICAgIG1heF9iaXRzW2dyXVtjaF0gKj0gZnJhbWVCaXRzW2dmYy5WQlJfbWF4X2JpdHJhdGVdO1xuICAgICAgICAgICAgICAgICAgICBtYXhfYml0c1tncl1bY2hdIC89IGJpdHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChtaW5fYml0c1tncl1bY2hdID4gbWF4X2JpdHNbZ3JdW2NoXSlcbiAgICAgICAgICAgICAgICAgICAgbWluX2JpdHNbZ3JdW2NoXSA9IG1heF9iaXRzW2dyXVtjaF07XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIGZvciBjaCAqL1xuICAgICAgICB9XG4gICAgICAgIC8qIGZvciBnciAqL1xuXG4gICAgICAgIHJldHVybiBhbmFsb2dfc2lsZW5jZTtcbiAgICB9O1xuXG4gICAgdGhpcy5iaXRwcmVzc3VyZV9zdHJhdGVneSA9IGZ1bmN0aW9uIChnZmMsIGwzX3htaW4sIG1pbl9iaXRzLCBtYXhfYml0cykge1xuICAgICAgICBmb3IgKHZhciBnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcbiAgICAgICAgICAgIGZvciAodmFyIGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGdpID0gZ2ZjLmwzX3NpZGUudHRbZ3JdW2NoXTtcbiAgICAgICAgICAgICAgICB2YXIgcHhtaW4gPSBsM194bWluW2dyXVtjaF07XG4gICAgICAgICAgICAgICAgdmFyIHB4bWluUG9zID0gMDtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBzZmIgPSAwOyBzZmIgPCBnaS5wc3lfbG1heDsgc2ZiKyspXG4gICAgICAgICAgICAgICAgICAgIHB4bWluW3B4bWluUG9zKytdICo9IDEuICsgLjAyOSAqIHNmYiAqIHNmYlxuICAgICAgICAgICAgICAgICAgICAgICAgLyBFbmNvZGVyLlNCTUFYX2wgLyBFbmNvZGVyLlNCTUFYX2w7XG5cbiAgICAgICAgICAgICAgICBpZiAoZ2kuYmxvY2tfdHlwZSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgc2ZiID0gZ2kuc2ZiX3NtaW47IHNmYiA8IEVuY29kZXIuU0JNQVhfczsgc2ZiKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHB4bWluW3B4bWluUG9zKytdICo9IDEuICsgLjAyOSAqIHNmYiAqIHNmYlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8gRW5jb2Rlci5TQk1BWF9zIC8gRW5jb2Rlci5TQk1BWF9zO1xuICAgICAgICAgICAgICAgICAgICAgICAgcHhtaW5bcHhtaW5Qb3MrK10gKj0gMS4gKyAuMDI5ICogc2ZiICogc2ZiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLyBFbmNvZGVyLlNCTUFYX3MgLyBFbmNvZGVyLlNCTUFYX3M7XG4gICAgICAgICAgICAgICAgICAgICAgICBweG1pbltweG1pblBvcysrXSAqPSAxLiArIC4wMjkgKiBzZmIgKiBzZmJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvIEVuY29kZXIuU0JNQVhfcyAvIEVuY29kZXIuU0JNQVhfcztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBtYXhfYml0c1tncl1bY2hdID0gMCB8IE1hdGgubWF4KG1pbl9iaXRzW2dyXVtjaF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAwLjkgKiBtYXhfYml0c1tncl1bY2hdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB0aGlzLlZCUl9uZXdfcHJlcGFyZSA9IGZ1bmN0aW9uIChnZnAsIHBlLCByYXRpbywgbDNfeG1pbiwgZnJhbWVCaXRzLCBtYXhfYml0cykge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXG4gICAgICAgIHZhciBhbmFsb2dfc2lsZW5jZSA9IDE7XG4gICAgICAgIHZhciBhdmcgPSAwLCBiaXRzID0gMDtcbiAgICAgICAgdmFyIG1heGltdW1fZnJhbWViaXRzO1xuXG4gICAgICAgIGlmICghZ2ZwLmZyZWVfZm9ybWF0KSB7XG4gICAgICAgICAgICBnZmMuYml0cmF0ZV9pbmRleCA9IGdmYy5WQlJfbWF4X2JpdHJhdGU7XG5cbiAgICAgICAgICAgIHZhciBtYiA9IG5ldyBNZWFuQml0cyhhdmcpO1xuICAgICAgICAgICAgcnYuUmVzdkZyYW1lQmVnaW4oZ2ZwLCBtYik7XG4gICAgICAgICAgICBhdmcgPSBtYi5iaXRzO1xuXG4gICAgICAgICAgICBnZXRfZnJhbWViaXRzKGdmcCwgZnJhbWVCaXRzKTtcbiAgICAgICAgICAgIG1heGltdW1fZnJhbWViaXRzID0gZnJhbWVCaXRzW2dmYy5WQlJfbWF4X2JpdHJhdGVdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ2ZjLmJpdHJhdGVfaW5kZXggPSAwO1xuICAgICAgICAgICAgdmFyIG1iID0gbmV3IE1lYW5CaXRzKGF2Zyk7XG4gICAgICAgICAgICBtYXhpbXVtX2ZyYW1lYml0cyA9IHJ2LlJlc3ZGcmFtZUJlZ2luKGdmcCwgbWIpO1xuICAgICAgICAgICAgYXZnID0gbWIuYml0cztcbiAgICAgICAgICAgIGZyYW1lQml0c1swXSA9IG1heGltdW1fZnJhbWViaXRzO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yICh2YXIgZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG4gICAgICAgICAgICBxdXB2dC5vbl9wZShnZnAsIHBlLCBtYXhfYml0c1tncl0sIGF2ZywgZ3IsIDApO1xuICAgICAgICAgICAgaWYgKGdmYy5tb2RlX2V4dCA9PSBFbmNvZGVyLk1QR19NRF9NU19MUikge1xuICAgICAgICAgICAgICAgIG1zX2NvbnZlcnQoZ2ZjLmwzX3NpZGUsIGdyKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyArK2NoKSB7XG4gICAgICAgICAgICAgICAgdmFyIGNvZF9pbmZvID0gZ2ZjLmwzX3NpZGUudHRbZ3JdW2NoXTtcblxuICAgICAgICAgICAgICAgIGdmYy5tYXNraW5nX2xvd2VyID0gTWF0aC5wb3coMTAuMCxcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLlBTWS5tYXNrX2FkanVzdCAqIDAuMSk7XG5cbiAgICAgICAgICAgICAgICBpbml0X291dGVyX2xvb3AoZ2ZjLCBjb2RfaW5mbyk7XG4gICAgICAgICAgICAgICAgaWYgKDAgIT0gcXVwdnQuY2FsY194bWluKGdmcCwgcmF0aW9bZ3JdW2NoXSwgY29kX2luZm8sXG4gICAgICAgICAgICAgICAgICAgICAgICBsM194bWluW2dyXVtjaF0pKVxuICAgICAgICAgICAgICAgICAgICBhbmFsb2dfc2lsZW5jZSA9IDA7XG5cbiAgICAgICAgICAgICAgICBiaXRzICs9IG1heF9iaXRzW2dyXVtjaF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgIGlmIChiaXRzID4gbWF4aW11bV9mcmFtZWJpdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgbWF4X2JpdHNbZ3JdW2NoXSAqPSBtYXhpbXVtX2ZyYW1lYml0cztcbiAgICAgICAgICAgICAgICAgICAgbWF4X2JpdHNbZ3JdW2NoXSAvPSBiaXRzO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogZm9yIGNoICovXG4gICAgICAgIH1cbiAgICAgICAgLyogZm9yIGdyICovXG5cbiAgICAgICAgcmV0dXJuIGFuYWxvZ19zaWxlbmNlO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBjYWxjdWxhdGVzIHRhcmdldCBiaXRzIGZvciBBQlIgZW5jb2RpbmdcbiAgICAgKlxuICAgICAqIG10IDIwMDAvMDUvMzFcbiAgICAgKi9cbiAgICB0aGlzLmNhbGNfdGFyZ2V0X2JpdHMgPSBmdW5jdGlvbiAoZ2ZwLCBwZSwgbXNfZW5lcl9yYXRpbywgdGFyZ19iaXRzLCBhbmFsb2dfc2lsZW5jZV9iaXRzLCBtYXhfZnJhbWVfYml0cykge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgbDNfc2lkZSA9IGdmYy5sM19zaWRlO1xuICAgICAgICB2YXIgcmVzX2ZhY3RvcjtcbiAgICAgICAgdmFyIGdyLCBjaCwgdG90Yml0cywgbWVhbl9iaXRzID0gMDtcblxuICAgICAgICBnZmMuYml0cmF0ZV9pbmRleCA9IGdmYy5WQlJfbWF4X2JpdHJhdGU7XG4gICAgICAgIHZhciBtYiA9IG5ldyBNZWFuQml0cyhtZWFuX2JpdHMpO1xuICAgICAgICBtYXhfZnJhbWVfYml0c1swXSA9IHJ2LlJlc3ZGcmFtZUJlZ2luKGdmcCwgbWIpO1xuICAgICAgICBtZWFuX2JpdHMgPSBtYi5iaXRzO1xuXG4gICAgICAgIGdmYy5iaXRyYXRlX2luZGV4ID0gMTtcbiAgICAgICAgbWVhbl9iaXRzID0gYnMuZ2V0ZnJhbWViaXRzKGdmcCkgLSBnZmMuc2lkZWluZm9fbGVuICogODtcbiAgICAgICAgYW5hbG9nX3NpbGVuY2VfYml0c1swXSA9IG1lYW5fYml0cyAvIChnZmMubW9kZV9nciAqIGdmYy5jaGFubmVsc19vdXQpO1xuXG4gICAgICAgIG1lYW5fYml0cyA9IGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMgKiBnZnAuZnJhbWVzaXplICogMTAwMDtcbiAgICAgICAgaWYgKChnZmMuc3Vic3RlcF9zaGFwaW5nICYgMSkgIT0gMClcbiAgICAgICAgICAgIG1lYW5fYml0cyAqPSAxLjA5O1xuICAgICAgICBtZWFuX2JpdHMgLz0gZ2ZwLm91dF9zYW1wbGVyYXRlO1xuICAgICAgICBtZWFuX2JpdHMgLT0gZ2ZjLnNpZGVpbmZvX2xlbiAqIDg7XG4gICAgICAgIG1lYW5fYml0cyAvPSAoZ2ZjLm1vZGVfZ3IgKiBnZmMuY2hhbm5lbHNfb3V0KTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogPFBSRT5cbiAgICAgICAgICogICAgICAgICAgIHJlc19mYWN0b3IgaXMgdGhlIHBlcmNlbnRhZ2Ugb2YgdGhlIHRhcmdldCBiaXRyYXRlIHRoYXQgc2hvdWxkXG4gICAgICAgICAqICAgICAgICAgICBiZSB1c2VkIG9uIGF2ZXJhZ2UuICB0aGUgcmVtYWluaW5nIGJpdHMgYXJlIGFkZGVkIHRvIHRoZVxuICAgICAgICAgKiAgICAgICAgICAgYml0cmVzZXJ2b2lyIGFuZCB1c2VkIGZvciBkaWZmaWN1bHQgdG8gZW5jb2RlIGZyYW1lcy5cbiAgICAgICAgICpcbiAgICAgICAgICogICAgICAgICAgIFNpbmNlIHdlIGFyZSB0cmFja2luZyB0aGUgYXZlcmFnZSBiaXRyYXRlLCB3ZSBzaG91bGQgYWRqdXN0XG4gICAgICAgICAqICAgICAgICAgICByZXNfZmFjdG9yIFwib24gdGhlIGZseVwiLCBpbmNyZWFzaW5nIGl0IGlmIHRoZSBhdmVyYWdlIGJpdHJhdGVcbiAgICAgICAgICogICAgICAgICAgIGlzIGdyZWF0ZXIgdGhhbiB0aGUgcmVxdWVzdGVkIGJpdHJhdGUsIGFuZCBkZWNyZWFzaW5nIGl0XG4gICAgICAgICAqICAgICAgICAgICBvdGhlcndpc2UuICBSZWFzb25hYmxlIHJhbmdlcyBhcmUgZnJvbSAuOSB0byAxLjBcbiAgICAgICAgICpcbiAgICAgICAgICogICAgICAgICAgIFVudGlsIHdlIGdldCB0aGUgYWJvdmUgc3VnZ2VzdGlvbiB3b3JraW5nLCB3ZSB1c2UgdGhlIGZvbGxvd2luZ1xuICAgICAgICAgKiAgICAgICAgICAgdHVuaW5nOlxuICAgICAgICAgKiAgICAgICAgICAgY29tcHJlc3Npb24gcmF0aW8gICAgcmVzX2ZhY3RvclxuICAgICAgICAgKiAgICAgICAgICAgNS41ICAoMjU2a2JwcykgICAgICAgICAxLjAgICAgICBubyBuZWVkIGZvciBiaXRyZXNlcnZvaXJcbiAgICAgICAgICogICAgICAgICAgIDExICAgKDEyOGticHMpICAgICAgICAgLjkzICAgICAgNyUgaGVsZCBmb3IgcmVzZXJ2b2lyXG4gICAgICAgICAqXG4gICAgICAgICAqICAgICAgICAgICB3aXRoIGxpbmVhciBpbnRlcnBvbGF0aW9uIGZvciBvdGhlciB2YWx1ZXMuXG4gICAgICAgICAqIDwvUFJFPlxuICAgICAgICAgKi9cbiAgICAgICAgcmVzX2ZhY3RvciA9IC45MyArIC4wNyAqICgxMS4wIC0gZ2ZwLmNvbXByZXNzaW9uX3JhdGlvKVxuICAgICAgICAgICAgLyAoMTEuMCAtIDUuNSk7XG4gICAgICAgIGlmIChyZXNfZmFjdG9yIDwgLjkwKVxuICAgICAgICAgICAgcmVzX2ZhY3RvciA9IC45MDtcbiAgICAgICAgaWYgKHJlc19mYWN0b3IgPiAxLjAwKVxuICAgICAgICAgICAgcmVzX2ZhY3RvciA9IDEuMDA7XG5cbiAgICAgICAgZm9yIChnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcbiAgICAgICAgICAgIHZhciBzdW0gPSAwO1xuICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgIHRhcmdfYml0c1tncl1bY2hdID0gKGludCkocmVzX2ZhY3RvciAqIG1lYW5fYml0cyk7XG5cbiAgICAgICAgICAgICAgICBpZiAocGVbZ3JdW2NoXSA+IDcwMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYWRkX2JpdHMgPSAoaW50KSgocGVbZ3JdW2NoXSAtIDcwMCkgLyAxLjQpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2RfaW5mbyA9IGwzX3NpZGUudHRbZ3JdW2NoXTtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ19iaXRzW2dyXVtjaF0gPSAoaW50KShyZXNfZmFjdG9yICogbWVhbl9iaXRzKTtcblxuICAgICAgICAgICAgICAgICAgICAvKiBzaG9ydCBibG9ja3MgdXNlIGEgbGl0dGxlIGV4dHJhLCBubyBtYXR0ZXIgd2hhdCB0aGUgcGUgKi9cbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvZF9pbmZvLmJsb2NrX3R5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWRkX2JpdHMgPCBtZWFuX2JpdHMgLyAyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkZF9iaXRzID0gbWVhbl9iaXRzIC8gMjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKiBhdCBtb3N0IGluY3JlYXNlIGJpdHMgYnkgMS41KmF2ZXJhZ2UgKi9cbiAgICAgICAgICAgICAgICAgICAgaWYgKGFkZF9iaXRzID4gbWVhbl9iaXRzICogMyAvIDIpXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRfYml0cyA9IG1lYW5fYml0cyAqIDMgLyAyO1xuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChhZGRfYml0cyA8IDApXG4gICAgICAgICAgICAgICAgICAgICAgICBhZGRfYml0cyA9IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgdGFyZ19iaXRzW2dyXVtjaF0gKz0gYWRkX2JpdHM7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0YXJnX2JpdHNbZ3JdW2NoXSA+IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9DSEFOTkVMKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdfYml0c1tncl1bY2hdID0gTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0NIQU5ORUw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN1bSArPSB0YXJnX2JpdHNbZ3JdW2NoXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIGZvciBjaCAqL1xuICAgICAgICAgICAgaWYgKHN1bSA+IExhbWVJbnRlcm5hbEZsYWdzLk1BWF9CSVRTX1BFUl9HUkFOVUxFKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgKytjaCkge1xuICAgICAgICAgICAgICAgICAgICB0YXJnX2JpdHNbZ3JdW2NoXSAqPSBMYW1lSW50ZXJuYWxGbGFncy5NQVhfQklUU19QRVJfR1JBTlVMRTtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ19iaXRzW2dyXVtjaF0gLz0gc3VtO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiBmb3IgZ3IgKi9cblxuICAgICAgICBpZiAoZ2ZjLm1vZGVfZXh0ID09IEVuY29kZXIuTVBHX01EX01TX0xSKVxuICAgICAgICAgICAgZm9yIChnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcbiAgICAgICAgICAgICAgICBxdXB2dC5yZWR1Y2Vfc2lkZSh0YXJnX2JpdHNbZ3JdLCBtc19lbmVyX3JhdGlvW2dyXSwgbWVhbl9iaXRzXG4gICAgICAgICAgICAgICAgICAgICogZ2ZjLmNoYW5uZWxzX291dCxcbiAgICAgICAgICAgICAgICAgICAgTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0dSQU5VTEUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHN1bSB0YXJnZXQgYml0c1xuICAgICAgICAgKi9cbiAgICAgICAgdG90Yml0cyA9IDA7XG4gICAgICAgIGZvciAoZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG4gICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRhcmdfYml0c1tncl1bY2hdID4gTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0NIQU5ORUwpXG4gICAgICAgICAgICAgICAgICAgIHRhcmdfYml0c1tncl1bY2hdID0gTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0NIQU5ORUw7XG4gICAgICAgICAgICAgICAgdG90Yml0cyArPSB0YXJnX2JpdHNbZ3JdW2NoXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHJlcGFydGlvbiB0YXJnZXQgYml0cyBpZiBuZWVkZWRcbiAgICAgICAgICovXG4gICAgICAgIGlmICh0b3RiaXRzID4gbWF4X2ZyYW1lX2JpdHNbMF0pIHtcbiAgICAgICAgICAgIGZvciAoZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG4gICAgICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgICAgICB0YXJnX2JpdHNbZ3JdW2NoXSAqPSBtYXhfZnJhbWVfYml0c1swXTtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ19iaXRzW2dyXVtjaF0gLz0gdG90Yml0cztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbn1cblxuLypcbiAqICAgICAgTVAzIHdpbmRvdyBzdWJiYW5kIC0+IHN1YmJhbmQgZmlsdGVyaW5nIC0+IG1kY3Qgcm91dGluZVxuICpcbiAqICAgICAgQ29weXJpZ2h0IChjKSAxOTk5LTIwMDAgVGFrZWhpcm8gVG9taW5hZ2FcbiAqXG4gKlxuICogVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vclxuICogbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpY1xuICogTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyXG4gKiB2ZXJzaW9uIDIgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uXG4gKlxuICogVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsXG4gKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZlxuICogTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiAgU2VlIHRoZSBHTlVcbiAqIExpYnJhcnkgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLlxuICpcbiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMaWJyYXJ5IEdlbmVyYWwgUHVibGljXG4gKiBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHdyaXRlIHRvIHRoZVxuICogRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBJbmMuLCA1OSBUZW1wbGUgUGxhY2UgLSBTdWl0ZSAzMzAsXG4gKiBCb3N0b24sIE1BIDAyMTExLTEzMDcsIFVTQS5cbiAqL1xuLypcbiAqICAgICAgICAgU3BlY2lhbCBUaGFua3MgdG8gUGF0cmljayBEZSBTbWV0IGZvciB5b3VyIGFkdmljZXMuXG4gKi9cblxuLyogJElkOiBOZXdNRENULmphdmEsdiAxLjExIDIwMTEvMDUvMjQgMjA6NDg6MDYga2VuY2hpcyBFeHAgJCAqL1xuXG4vL3BhY2thZ2UgbXAzO1xuXG4vL2ltcG9ydCBqYXZhLnV0aWwuQXJyYXlzO1xuXG5cblxuZnVuY3Rpb24gTmV3TURDVCgpIHtcblxuXHR2YXIgZW53aW5kb3cgPSBbXG5cdFx0XHQtNC43N2UtMDcgKiAwLjc0MDk1MTEyNTM1NDk1OSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMDM5NTFlLTA0ICogMC43NDA5NTExMjUzNTQ5NTkgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjUzNjc0ZS0wNCAqIDAuNzQwOTUxMTI1MzU0OTU5IC8gMi4zODRlLTA2LFxuXHRcdFx0Mi44NDE0NzNlLTAzICogMC43NDA5NTExMjUzNTQ5NTkgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjU3NTg5NzJlLTAyICogMC43NDA5NTExMjUzNTQ5NTkgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjQwMTc1NmUtMDMgKiAwLjc0MDk1MTEyNTM1NDk1OSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuODM3MTVlLTA0ICogMC43NDA5NTExMjUzNTQ5NTkgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjkxODJlLTA1ICogMC43NDA5NTExMjUzNTQ5NTkgLyAyLjM4NGUtMDYsIC8qIDE1ICovXG5cdFx0XHQxLjIzOThlLTA1ICogMC43NDA5NTExMjUzNTQ5NTkgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjkxMjEyZS0wNCAqIDAuNzQwOTUxMTI1MzU0OTU5IC8gMi4zODRlLTA2LFxuXHRcdFx0Mi4yODMwOTZlLTAzICogMC43NDA5NTExMjUzNTQ5NTkgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjY5OTQ0NzZlLTAyICogMC43NDA5NTExMjUzNTQ5NTkgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMS44NzU2ODY2ZS0wMiAqIDAuNzQwOTUxMTI1MzU0OTU5IC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuNjMwNzExZS0wMyAqIDAuNzQwOTUxMTI1MzU0OTU5IC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuNDc0NzhlLTA0ICogMC43NDA5NTExMjUzNTQ5NTkgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMS40NzgyZS0wNSAqIDAuNzQwOTUxMTI1MzU0OTU5IC8gMi4zODRlLTA2LFxuXHRcdFx0OS4wNjM0NzE2OTAxOTE0NzFlLTAxLCAxLjk2MDM0MjgwNjU5MTIxM2UtMDEsXG5cblx0XHRcdC00Ljc3ZS0wNyAqIDAuNzczMDEwNDUzMzYyNzM3IC8gMi4zODRlLTA2LFxuXHRcdFx0MS4wNTg1OGUtMDQgKiAwLjc3MzAxMDQ1MzM2MjczNyAvIDIuMzg0ZS0wNixcblx0XHRcdDkuMzA3ODZlLTA0ICogMC43NzMwMTA0NTMzNjI3MzcgLyAyLjM4NGUtMDYsXG5cdFx0XHQyLjUyMTUxNWUtMDMgKiAwLjc3MzAxMDQ1MzM2MjczNyAvIDIuMzg0ZS0wNixcblx0XHRcdDMuNTY5NDEyMmUtMDIgKiAwLjc3MzAxMDQ1MzM2MjczNyAvIDIuMzg0ZS0wNixcblx0XHRcdDMuNjQzMDM2ZS0wMyAqIDAuNzczMDEwNDUzMzYyNzM3IC8gMi4zODRlLTA2LFxuXHRcdFx0OS45MTgyMWUtMDQgKiAwLjc3MzAxMDQ1MzM2MjczNyAvIDIuMzg0ZS0wNixcblx0XHRcdDkuNjMyMWUtMDUgKiAwLjc3MzAxMDQ1MzM2MjczNyAvIDIuMzg0ZS0wNiwgLyogMTQgKi9cblx0XHRcdDEuMTQ0NGUtMDUgKiAwLjc3MzAxMDQ1MzM2MjczNyAvIDIuMzg0ZS0wNixcblx0XHRcdDEuNjU0NjJlLTA0ICogMC43NzMwMTA0NTMzNjI3MzcgLyAyLjM4NGUtMDYsXG5cdFx0XHQyLjExMDAwNGUtMDMgKiAwLjc3MzAxMDQ1MzM2MjczNyAvIDIuMzg0ZS0wNixcblx0XHRcdDEuNjExMjgwNGUtMDIgKiAwLjc3MzAxMDQ1MzM2MjczNyAvIDIuMzg0ZS0wNixcblx0XHRcdC0xLjk2MzQyNDdlLTAyICogMC43NzMwMTA0NTMzNjI3MzcgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi44MDMzMjZlLTAzICogMC43NzMwMTA0NTMzNjI3MzcgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi43NzA0MmUtMDQgKiAwLjc3MzAxMDQ1MzM2MjczNyAvIDIuMzg0ZS0wNixcblx0XHRcdC0xLjY2ODllLTA1ICogMC43NzMwMTA0NTMzNjI3MzcgLyAyLjM4NGUtMDYsXG5cdFx0XHQ4LjIwNjc4NzkwODI4NjYwMmUtMDEsIDMuOTAxODA2NDQwMzIyNTY3ZS0wMSxcblxuXHRcdFx0LTQuNzdlLTA3ICogMC44MDMyMDc1MzE0ODA2NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjA3Mjg4ZS0wNCAqIDAuODAzMjA3NTMxNDgwNjQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0OS4wMjY1M2UtMDQgKiAwLjgwMzIwNzUzMTQ4MDY0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDIuMTc0ODU0ZS0wMyAqIDAuODAzMjA3NTMxNDgwNjQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0My41NTg2MzU3ZS0wMiAqIDAuODAzMjA3NTMxNDgwNjQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0My44NTg1NjZlLTAzICogMC44MDMyMDc1MzE0ODA2NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5Ljk1MTU5ZS0wNCAqIDAuODAzMjA3NTMxNDgwNjQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0OS4zNDYwZS0wNSAqIDAuODAzMjA3NTMxNDgwNjQ1IC8gMi4zODRlLTA2LCAvKiAxMyAqL1xuXHRcdFx0MS4wMDE0ZS0wNSAqIDAuODAzMjA3NTMxNDgwNjQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0MS40MDE5MGUtMDQgKiAwLjgwMzIwNzUzMTQ4MDY0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuOTM3Mzg5ZS0wMyAqIDAuODAzMjA3NTMxNDgwNjQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0MS41MjMzNTE3ZS0wMiAqIDAuODAzMjA3NTMxNDgwNjQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuMDUwNjg1OWUtMDIgKiAwLjgwMzIwNzUzMTQ4MDY0NSAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjk3NDAzM2UtMDMgKiAwLjgwMzIwNzUzMTQ4MDY0NSAvIDIuMzg0ZS0wNixcblx0XHRcdC0zLjA3NTYwZS0wNCAqIDAuODAzMjA3NTMxNDgwNjQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0LTEuODEyMGUtMDUgKiAwLjgwMzIwNzUzMTQ4MDY0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDcuNDE2NTA1NDYyNzIwMzUzZS0wMSwgNS44MDU2OTM1NDUwODkyNDllLTAxLFxuXG5cdFx0XHQtNC43N2UtMDcgKiAwLjgzMTQ2OTYxMjMwMjU0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMDgyNDJlLTA0ICogMC44MzE0Njk2MTIzMDI1NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ4LjY4Nzk3ZS0wNCAqIDAuODMxNDY5NjEyMzAyNTQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0MS44MDA1MzdlLTAzICogMC44MzE0Njk2MTIzMDI1NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjU0MzUyMDBlLTAyICogMC44MzE0Njk2MTIzMDI1NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0LjA0OTMwMWUtMDMgKiAwLjgzMTQ2OTYxMjMwMjU0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuOTQyMDVlLTA0ICogMC44MzE0Njk2MTIzMDI1NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjA1OTllLTA1ICogMC44MzE0Njk2MTIzMDI1NDUgLyAyLjM4NGUtMDYsIC8qIDEyICovXG5cdFx0XHQ5LjA2MGUtMDYgKiAwLjgzMTQ2OTYxMjMwMjU0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMTYzNDhlLTA0ICogMC44MzE0Njk2MTIzMDI1NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjc2NjY4MmUtMDMgKiAwLjgzMTQ2OTYxMjMwMjU0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuNDM1ODUyMWUtMDIgKiAwLjgzMTQ2OTYxMjMwMjU0NSAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjEzNzIzMThlLTAyICogMC44MzE0Njk2MTIzMDI1NDUgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMy4xNDE4OGUtMDMgKiAwLjgzMTQ2OTYxMjMwMjU0NSAvIDIuMzg0ZS0wNixcblx0XHRcdC0zLjM5MDMxZS0wNCAqIDAuODMxNDY5NjEyMzAyNTQ1IC8gMi4zODRlLTA2LFxuXHRcdFx0LTEuOTU1MGUtMDUgKiAwLjgzMTQ2OTYxMjMwMjU0NSAvIDIuMzg0ZS0wNixcblx0XHRcdDYuNjgxNzg2Mzc5MTkyOTg5ZS0wMSwgNy42NTM2Njg2NDczMDE3OTdlLTAxLFxuXG5cdFx0XHQtNC43N2UtMDcgKiAwLjg1NzcyODYxMDAwMDI3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMDg3MTllLTA0ICogMC44NTc3Mjg2MTAwMDAyNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQ4LjI5MjIwZS0wNCAqIDAuODU3NzI4NjEwMDAwMjcyIC8gMi4zODRlLTA2LFxuXHRcdFx0MS4zOTk1MTdlLTAzICogMC44NTc3Mjg2MTAwMDAyNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjUyNDIwODFlLTAyICogMC44NTc3Mjg2MTAwMDAyNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0LjIxNTI0MGUtMDMgKiAwLjg1NzcyODYxMDAwMDI3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDkuODk0MzdlLTA0ICogMC44NTc3Mjg2MTAwMDAyNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQ4LjcyNjFlLTA1ICogMC44NTc3Mjg2MTAwMDAyNzIgLyAyLjM4NGUtMDYsIC8qIDExICovXG5cdFx0XHQ4LjEwNmUtMDYgKiAwLjg1NzcyODYxMDAwMDI3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDkuMzkzN2UtMDUgKiAwLjg1NzcyODYxMDAwMDI3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDEuNTk3ODgxZS0wMyAqIDAuODU3NzI4NjEwMDAwMjcyIC8gMi4zODRlLTA2LFxuXHRcdFx0MS4zNDg5MjQ2ZS0wMiAqIDAuODU3NzI4NjEwMDAwMjcyIC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuMjIyODcxOGUtMDIgKiAwLjg1NzcyODYxMDAwMDI3MiAvIDIuMzg0ZS0wNixcblx0XHRcdC0zLjMwNjg2NmUtMDMgKiAwLjg1NzcyODYxMDAwMDI3MiAvIDIuMzg0ZS0wNixcblx0XHRcdC0zLjcxNDU2ZS0wNCAqIDAuODU3NzI4NjEwMDAwMjcyIC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuMTQ1OGUtMDUgKiAwLjg1NzcyODYxMDAwMDI3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDUuOTkzNzY5MzM2ODE5MjM3ZS0wMSwgOS40Mjc5MzQ3MzY1MTk5NTRlLTAxLFxuXG5cdFx0XHQtNC43N2UtMDcgKiAwLjg4MTkyMTI2NDM0ODM1NSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMDg3MTllLTA0ICogMC44ODE5MjEyNjQzNDgzNTUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ3LjgzOTJlLTA0ICogMC44ODE5MjEyNjQzNDgzNTUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjcxMzE3ZS0wNCAqIDAuODgxOTIxMjY0MzQ4MzU1IC8gMi4zODRlLTA2LFxuXHRcdFx0My41MDA3MDAwZS0wMiAqIDAuODgxOTIxMjY0MzQ4MzU1IC8gMi4zODRlLTA2LFxuXHRcdFx0NC4zNTc4MTVlLTAzICogMC44ODE5MjEyNjQzNDgzNTUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjgwODU0ZS0wNCAqIDAuODgxOTIxMjY0MzQ4MzU1IC8gMi4zODRlLTA2LFxuXHRcdFx0OC4zOTIzZS0wNSAqIDAuODgxOTIxMjY0MzQ4MzU1IC8gMi4zODRlLTA2LCAvKiAxMCAqL1xuXHRcdFx0Ny42MjllLTA2ICogMC44ODE5MjEyNjQzNDgzNTUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ3LjI5NTZlLTA1ICogMC44ODE5MjEyNjQzNDgzNTUgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjQzMjQxOWUtMDMgKiAwLjg4MTkyMTI2NDM0ODM1NSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMjYyNzYwMmUtMDIgKiAwLjg4MTkyMTI2NDM0ODM1NSAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjMwNzQxNTBlLTAyICogMC44ODE5MjEyNjQzNDgzNTUgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMy40NjcwODNlLTAzICogMC44ODE5MjEyNjQzNDgzNTUgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNC4wNDM1OGUtMDQgKiAwLjg4MTkyMTI2NDM0ODM1NSAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjMzNjVlLTA1ICogMC44ODE5MjEyNjQzNDgzNTUgLyAyLjM4NGUtMDYsXG5cdFx0XHQ1LjM0NTExMTM1OTUwNzkxNmUtMDEsIDEuMTExMTQwNDY2MDM5MjA1ZSswMCxcblxuXHRcdFx0LTkuNTRlLTA3ICogMC45MDM5ODkyOTMxMjM0NDMgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjA4MjQyZS0wNCAqIDAuOTAzOTg5MjkzMTIzNDQzIC8gMi4zODRlLTA2LFxuXHRcdFx0Ny4zMTk0NWUtMDQgKiAwLjkwMzk4OTI5MzEyMzQ0MyAvIDIuMzg0ZS0wNixcblx0XHRcdDUuMTU5MzhlLTA0ICogMC45MDM5ODkyOTMxMjM0NDMgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjQ3MzA0MzRlLTAyICogMC45MDM5ODkyOTMxMjM0NDMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0LjQ3NzAyNGUtMDMgKiAwLjkwMzk4OTI5MzEyMzQ0MyAvIDIuMzg0ZS0wNixcblx0XHRcdDkuNjg5MzNlLTA0ICogMC45MDM5ODkyOTMxMjM0NDMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ4LjA1ODVlLTA1ICogMC45MDM5ODkyOTMxMjM0NDMgLyAyLjM4NGUtMDYsIC8qIDkgKi9cblx0XHRcdDYuNjc2ZS0wNiAqIDAuOTAzOTg5MjkzMTIzNDQzIC8gMi4zODRlLTA2LFxuXHRcdFx0NS4yOTI5ZS0wNSAqIDAuOTAzOTg5MjkzMTIzNDQzIC8gMi4zODRlLTA2LFxuXHRcdFx0MS4yNjk4MTdlLTAzICogMC45MDM5ODkyOTMxMjM0NDMgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjE3NzUwMTdlLTAyICogMC45MDM5ODkyOTMxMjM0NDMgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi4zOTA3MTg1ZS0wMiAqIDAuOTAzOTg5MjkzMTIzNDQzIC8gMi4zODRlLTA2LFxuXHRcdFx0LTMuNjIyNTMyZS0wMyAqIDAuOTAzOTg5MjkzMTIzNDQzIC8gMi4zODRlLTA2LFxuXHRcdFx0LTQuMzgyMTNlLTA0ICogMC45MDM5ODkyOTMxMjM0NDMgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi41MjcyZS0wNSAqIDAuOTAzOTg5MjkzMTIzNDQzIC8gMi4zODRlLTA2LFxuXHRcdFx0NC43Mjk2NDc3NTg5MTMxOTllLTAxLCAxLjI2ODc4NjU2ODMyNzI5MWUrMDAsXG5cblx0XHRcdC05LjU0ZS0wNyAqIDAuOTIzODc5NTMyNTExMjg2NzU2MTMgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjA2ODEyZS0wNCAqIDAuOTIzODc5NTMyNTExMjg2NzU2MTMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ2Ljc0MjQ4ZS0wNCAqIDAuOTIzODc5NTMyNTExMjg2NzU2MTMgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjMzNzllLTA1ICogMC45MjM4Nzk1MzI1MTEyODY3NTYxMyAvIDIuMzg0ZS0wNixcblx0XHRcdDMuNDQxMjg2MWUtMDIgKiAwLjkyMzg3OTUzMjUxMTI4Njc1NjEzIC8gMi4zODRlLTA2LFxuXHRcdFx0NC41NzM4MjJlLTAzICogMC45MjM4Nzk1MzI1MTEyODY3NTYxMyAvIDIuMzg0ZS0wNixcblx0XHRcdDkuNTQxNTFlLTA0ICogMC45MjM4Nzk1MzI1MTEyODY3NTYxMyAvIDIuMzg0ZS0wNixcblx0XHRcdDcuNjc3MWUtMDUgKiAwLjkyMzg3OTUzMjUxMTI4Njc1NjEzIC8gMi4zODRlLTA2LFxuXHRcdFx0Ni4xOTllLTA2ICogMC45MjM4Nzk1MzI1MTEyODY3NTYxMyAvIDIuMzg0ZS0wNixcblx0XHRcdDMuNDMzMmUtMDUgKiAwLjkyMzg3OTUzMjUxMTI4Njc1NjEzIC8gMi4zODRlLTA2LFxuXHRcdFx0MS4xMTEwMzFlLTAzICogMC45MjM4Nzk1MzI1MTEyODY3NTYxMyAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMDkzMzM5OWUtMDIgKiAwLjkyMzg3OTUzMjUxMTI4Njc1NjEzIC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuNDcyNTQzN2UtMDIgKiAwLjkyMzg3OTUzMjUxMTI4Njc1NjEzIC8gMi4zODRlLTA2LFxuXHRcdFx0LTMuNzcxNzgyZS0wMyAqIDAuOTIzODc5NTMyNTExMjg2NzU2MTMgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNC43MjU0NmUtMDQgKiAwLjkyMzg3OTUzMjUxMTI4Njc1NjEzIC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuNzY1N2UtMDUgKiAwLjkyMzg3OTUzMjUxMTI4Njc1NjEzIC8gMi4zODRlLTA2LFxuXHRcdFx0NC4xNDIxMzU2MjM3MzA5NTA0ODc5ZS0wMSwgLyogdGFuKFBJLzgpICovXG5cdFx0XHQxLjQxNDIxMzU2MjM3MzA5NWUrMDAsXG5cblx0XHRcdC05LjU0ZS0wNyAqIDAuOTQxNTQ0MDY1MTgzMDIxIC8gMi4zODRlLTA2LFxuXHRcdFx0MS4wNTM4MWUtMDQgKiAwLjk0MTU0NDA2NTE4MzAyMSAvIDIuMzg0ZS0wNixcblx0XHRcdDYuMTAzNTJlLTA0ICogMC45NDE1NDQwNjUxODMwMjEgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNC43NTg4M2UtMDQgKiAwLjk0MTU0NDA2NTE4MzAyMSAvIDIuMzg0ZS0wNixcblx0XHRcdDMuNDA1NTcxMGUtMDIgKiAwLjk0MTU0NDA2NTE4MzAyMSAvIDIuMzg0ZS0wNixcblx0XHRcdDQuNjQ5MTYyZS0wMyAqIDAuOTQxNTQ0MDY1MTgzMDIxIC8gMi4zODRlLTA2LFxuXHRcdFx0OS4zNTU1NWUtMDQgKiAwLjk0MTU0NDA2NTE4MzAyMSAvIDIuMzg0ZS0wNixcblx0XHRcdDcuMzQzM2UtMDUgKiAwLjk0MTU0NDA2NTE4MzAyMSAvIDIuMzg0ZS0wNiwgLyogNyAqL1xuXHRcdFx0NS4yNDVlLTA2ICogMC45NDE1NDQwNjUxODMwMjEgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjcxNjZlLTA1ICogMC45NDE1NDQwNjUxODMwMjEgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjU2NTM1ZS0wNCAqIDAuOTQxNTQ0MDY1MTgzMDIxIC8gMi4zODRlLTA2LFxuXHRcdFx0MS4wMTAzNzAzZS0wMiAqIDAuOTQxNTQ0MDY1MTgzMDIxIC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuNTUyNzAwMGUtMDIgKiAwLjk0MTU0NDA2NTE4MzAyMSAvIDIuMzg0ZS0wNixcblx0XHRcdC0zLjkxNDM1NmUtMDMgKiAwLjk0MTU0NDA2NTE4MzAyMSAvIDIuMzg0ZS0wNixcblx0XHRcdC01LjA3MzU1ZS0wNCAqIDAuOTQxNTQ0MDY1MTgzMDIxIC8gMi4zODRlLTA2LFxuXHRcdFx0LTMuMDA0MWUtMDUgKiAwLjk0MTU0NDA2NTE4MzAyMSAvIDIuMzg0ZS0wNixcblx0XHRcdDMuNTc4MDU3MjEzMTQ1MjQxZS0wMSwgMS41NDYwMjA5MDY3MjU0NzRlKzAwLFxuXG5cdFx0XHQtOS41NGUtMDcgKiAwLjk1Njk0MDMzNTczMjIwOSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMDI1MjBlLTA0ICogMC45NTY5NDAzMzU3MzIyMDkgLyAyLjM4NGUtMDYsXG5cdFx0XHQ1LjM5MzAzZS0wNCAqIDAuOTU2OTQwMzM1NzMyMjA5IC8gMi4zODRlLTA2LFxuXHRcdFx0LTEuMDExODQ4ZS0wMyAqIDAuOTU2OTQwMzM1NzMyMjA5IC8gMi4zODRlLTA2LFxuXHRcdFx0My4zNjU5OTM1ZS0wMiAqIDAuOTU2OTQwMzM1NzMyMjA5IC8gMi4zODRlLTA2LFxuXHRcdFx0NC43MDMwNDVlLTAzICogMC45NTY5NDAzMzU3MzIyMDkgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjE1MDUxZS0wNCAqIDAuOTU2OTQwMzM1NzMyMjA5IC8gMi4zODRlLTA2LFxuXHRcdFx0Ny4wMDk1ZS0wNSAqIDAuOTU2OTQwMzM1NzMyMjA5IC8gMi4zODRlLTA2LCAvKiA2ICovXG5cdFx0XHQ0Ljc2OGUtMDYgKiAwLjk1Njk0MDMzNTczMjIwOSAvIDIuMzg0ZS0wNixcblx0XHRcdDkuNTRlLTA3ICogMC45NTY5NDAzMzU3MzIyMDkgLyAyLjM4NGUtMDYsXG5cdFx0XHQ4LjA2ODA4ZS0wNCAqIDAuOTU2OTQwMzM1NzMyMjA5IC8gMi4zODRlLTA2LFxuXHRcdFx0OS4yODc4MzRlLTAzICogMC45NTY5NDAzMzU3MzIyMDkgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi42MzEwOTIxZS0wMiAqIDAuOTU2OTQwMzM1NzMyMjA5IC8gMi4zODRlLTA2LFxuXHRcdFx0LTQuMDQ4ODI0ZS0wMyAqIDAuOTU2OTQwMzM1NzMyMjA5IC8gMi4zODRlLTA2LFxuXHRcdFx0LTUuNDIxNjRlLTA0ICogMC45NTY5NDAzMzU3MzIyMDkgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMy4yNDI1ZS0wNSAqIDAuOTU2OTQwMzM1NzMyMjA5IC8gMi4zODRlLTA2LFxuXHRcdFx0My4wMzM0NjY4MzYwNzM0MjRlLTAxLCAxLjY2MjkzOTIyNDYwNTA5MGUrMDAsXG5cblx0XHRcdC0xLjQzMWUtMDYgKiAwLjk3MDAzMTI1MzE5NDU0NCAvIDIuMzg0ZS0wNixcblx0XHRcdDkuOTE4MmUtMDUgKiAwLjk3MDAzMTI1MzE5NDU0NCAvIDIuMzg0ZS0wNixcblx0XHRcdDQuNjI1MzJlLTA0ICogMC45NzAwMzEyNTMxOTQ1NDQgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMS41NzM1NjNlLTAzICogMC45NzAwMzEyNTMxOTQ1NDQgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjMyMjU1MzZlLTAyICogMC45NzAwMzEyNTMxOTQ1NDQgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0LjczNzM3N2UtMDMgKiAwLjk3MDAzMTI1MzE5NDU0NCAvIDIuMzg0ZS0wNixcblx0XHRcdDguOTE2ODVlLTA0ICogMC45NzAwMzEyNTMxOTQ1NDQgLyAyLjM4NGUtMDYsXG5cdFx0XHQ2LjYyODBlLTA1ICogMC45NzAwMzEyNTMxOTQ1NDQgLyAyLjM4NGUtMDYsIC8qIDUgKi9cblx0XHRcdDQuMjkyZS0wNiAqIDAuOTcwMDMxMjUzMTk0NTQ0IC8gMi4zODRlLTA2LFxuXHRcdFx0LTEuMzgyOGUtMDUgKiAwLjk3MDAzMTI1MzE5NDU0NCAvIDIuMzg0ZS0wNixcblx0XHRcdDYuNjE4NTBlLTA0ICogMC45NzAwMzEyNTMxOTQ1NDQgLyAyLjM4NGUtMDYsXG5cdFx0XHQ4LjQ4NzIyNWUtMDMgKiAwLjk3MDAzMTI1MzE5NDU0NCAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjcwNzM4NjBlLTAyICogMC45NzAwMzEyNTMxOTQ1NDQgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNC4xNzQ3MDllLTAzICogMC45NzAwMzEyNTMxOTQ1NDQgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNS43Njk3M2UtMDQgKiAwLjk3MDAzMTI1MzE5NDU0NCAvIDIuMzg0ZS0wNixcblx0XHRcdC0zLjQ4MDllLTA1ICogMC45NzAwMzEyNTMxOTQ1NDQgLyAyLjM4NGUtMDYsXG5cdFx0XHQyLjUwNDg2OTYwMTkxMzA1NWUtMDEsIDEuNzYzODQyNTI4Njk2NzEwZSswMCxcblxuXHRcdFx0LTEuNDMxZS0wNiAqIDAuOTgwNzg1MjgwNDAzMjMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ5LjUzNjdlLTA1ICogMC45ODA3ODUyODA0MDMyMyAvIDIuMzg0ZS0wNixcblx0XHRcdDMuNzg2MDllLTA0ICogMC45ODA3ODUyODA0MDMyMyAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjE2MTUwM2UtMDMgKiAwLjk4MDc4NTI4MDQwMzIzIC8gMi4zODRlLTA2LFxuXHRcdFx0My4yNzU0ODk4ZS0wMiAqIDAuOTgwNzg1MjgwNDAzMjMgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0Ljc1MjE1OWUtMDMgKiAwLjk4MDc4NTI4MDQwMzIzIC8gMi4zODRlLTA2LFxuXHRcdFx0OC42NjQxM2UtMDQgKiAwLjk4MDc4NTI4MDQwMzIzIC8gMi4zODRlLTA2LFxuXHRcdFx0Ni4yOTQzZS0wNSAqIDAuOTgwNzg1MjgwNDAzMjMgLyAyLjM4NGUtMDYsIC8qIDQgKi9cblx0XHRcdDMuODE1ZS0wNiAqIDAuOTgwNzg1MjgwNDAzMjMgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi43MThlLTA1ICogMC45ODA3ODUyODA0MDMyMyAvIDIuMzg0ZS0wNixcblx0XHRcdDUuMjIxMzdlLTA0ICogMC45ODA3ODUyODA0MDMyMyAvIDIuMzg0ZS0wNixcblx0XHRcdDcuNzAzMzA0ZS0wMyAqIDAuOTgwNzg1MjgwNDAzMjMgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi43ODE1MzQyZS0wMiAqIDAuOTgwNzg1MjgwNDAzMjMgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNC4yOTA1ODFlLTAzICogMC45ODA3ODUyODA0MDMyMyAvIDIuMzg0ZS0wNixcblx0XHRcdC02LjExNzgyZS0wNCAqIDAuOTgwNzg1MjgwNDAzMjMgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMy43NjcwZS0wNSAqIDAuOTgwNzg1MjgwNDAzMjMgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjk4OTEyMzY3Mzc5NjU4MGUtMDEsIDEuODQ3NzU5MDY1MDIyNTczZSswMCxcblxuXHRcdFx0LTEuOTA3ZS0wNiAqIDAuOTg5MTc2NTA5OTY0NzgxIC8gMi4zODRlLTA2LFxuXHRcdFx0OS4wMTIyZS0wNSAqIDAuOTg5MTc2NTA5OTY0NzgxIC8gMi4zODRlLTA2LFxuXHRcdFx0Mi44ODQ4NmUtMDQgKiAwLjk4OTE3NjUwOTk2NDc4MSAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjc3NDIzOWUtMDMgKiAwLjk4OTE3NjUwOTk2NDc4MSAvIDIuMzg0ZS0wNixcblx0XHRcdDMuMjI0ODAyMGUtMDIgKiAwLjk4OTE3NjUwOTk2NDc4MSAvIDIuMzg0ZS0wNixcblx0XHRcdDQuNzQ4ODIxZS0wMyAqIDAuOTg5MTc2NTA5OTY0NzgxIC8gMi4zODRlLTA2LFxuXHRcdFx0OC4zODc1N2UtMDQgKiAwLjk4OTE3NjUwOTk2NDc4MSAvIDIuMzg0ZS0wNixcblx0XHRcdDUuOTYwNWUtMDUgKiAwLjk4OTE3NjUwOTk2NDc4MSAvIDIuMzg0ZS0wNiwgLyogMyAqL1xuXHRcdFx0My4zMzhlLTA2ICogMC45ODkxNzY1MDk5NjQ3ODEgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMy45NTc3ZS0wNSAqIDAuOTg5MTc2NTA5OTY0NzgxIC8gMi4zODRlLTA2LFxuXHRcdFx0My44ODE0NWUtMDQgKiAwLjk4OTE3NjUwOTk2NDc4MSAvIDIuMzg0ZS0wNixcblx0XHRcdDYuOTM3MDI3ZS0wMyAqIDAuOTg5MTc2NTA5OTY0NzgxIC8gMi4zODRlLTA2LFxuXHRcdFx0LTIuODUzMjk4MmUtMDIgKiAwLjk4OTE3NjUwOTk2NDc4MSAvIDIuMzg0ZS0wNixcblx0XHRcdC00LjM5NTk2MmUtMDMgKiAwLjk4OTE3NjUwOTk2NDc4MSAvIDIuMzg0ZS0wNixcblx0XHRcdC02LjQ2NTkxZS0wNCAqIDAuOTg5MTc2NTA5OTY0NzgxIC8gMi4zODRlLTA2LFxuXHRcdFx0LTQuMDUzMWUtMDUgKiAwLjk4OTE3NjUwOTk2NDc4MSAvIDIuMzg0ZS0wNixcblx0XHRcdDEuNDgzMzU5ODc1MzgzNDc0ZS0wMSwgMS45MTM4ODA2NzE0NjQ0MThlKzAwLFxuXG5cdFx0XHQtMS45MDdlLTA2ICogMC45OTUxODQ3MjY2NzIxOTcgLyAyLjM4NGUtMDYsXG5cdFx0XHQ4LjQ0MDBlLTA1ICogMC45OTUxODQ3MjY2NzIxOTcgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjkxNjg5ZS0wNCAqIDAuOTk1MTg0NzI2NjcyMTk3IC8gMi4zODRlLTA2LFxuXHRcdFx0LTMuNDExMjkzZS0wMyAqIDAuOTk1MTg0NzI2NjcyMTk3IC8gMi4zODRlLTA2LFxuXHRcdFx0My4xNzA2ODEwZS0wMiAqIDAuOTk1MTg0NzI2NjcyMTk3IC8gMi4zODRlLTA2LFxuXHRcdFx0NC43MjgzMTdlLTAzICogMC45OTUxODQ3MjY2NzIxOTcgLyAyLjM4NGUtMDYsXG5cdFx0XHQ4LjA5NjY5ZS0wNCAqIDAuOTk1MTg0NzI2NjcyMTk3IC8gMi4zODRlLTA2LFxuXHRcdFx0NS41NzllLTA1ICogMC45OTUxODQ3MjY2NzIxOTcgLyAyLjM4NGUtMDYsXG5cdFx0XHQzLjMzOGUtMDYgKiAwLjk5NTE4NDcyNjY3MjE5NyAvIDIuMzg0ZS0wNixcblx0XHRcdC01LjA1NDVlLTA1ICogMC45OTUxODQ3MjY2NzIxOTcgLyAyLjM4NGUtMDYsXG5cdFx0XHQyLjU5ODc2ZS0wNCAqIDAuOTk1MTg0NzI2NjcyMTk3IC8gMi4zODRlLTA2LFxuXHRcdFx0Ni4xODkzNDZlLTAzICogMC45OTUxODQ3MjY2NzIxOTcgLyAyLjM4NGUtMDYsXG5cdFx0XHQtMi45MjI0ODczZS0wMiAqIDAuOTk1MTg0NzI2NjcyMTk3IC8gMi4zODRlLTA2LFxuXHRcdFx0LTQuNDg5ODk5ZS0wMyAqIDAuOTk1MTg0NzI2NjcyMTk3IC8gMi4zODRlLTA2LFxuXHRcdFx0LTYuODA5MjNlLTA0ICogMC45OTUxODQ3MjY2NzIxOTcgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNC4zMzkyZS0wNSAqIDAuOTk1MTg0NzI2NjcyMTk3IC8gMi4zODRlLTA2LFxuXHRcdFx0OS44NDkxNDAzMzU3MTY0MjVlLTAyLCAxLjk2MTU3MDU2MDgwNjQ2MWUrMDAsXG5cblx0XHRcdC0yLjM4NGUtMDYgKiAwLjk5ODc5NTQ1NjIwNTE3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDcuNzcyNGUtMDUgKiAwLjk5ODc5NTQ1NjIwNTE3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDguODIxNWUtMDUgKiAwLjk5ODc5NTQ1NjIwNTE3MiAvIDIuMzg0ZS0wNixcblx0XHRcdC00LjA3MjE4OWUtMDMgKiAwLjk5ODc5NTQ1NjIwNTE3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDMuMTEzMjY5OGUtMDIgKiAwLjk5ODc5NTQ1NjIwNTE3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDQuNjkxMTI0ZS0wMyAqIDAuOTk4Nzk1NDU2MjA1MTcyIC8gMi4zODRlLTA2LFxuXHRcdFx0Ny43OTE1MmUtMDQgKiAwLjk5ODc5NTQ1NjIwNTE3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDUuMjkyOWUtMDUgKiAwLjk5ODc5NTQ1NjIwNTE3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDIuODYxZS0wNiAqIDAuOTk4Nzk1NDU2MjA1MTcyIC8gMi4zODRlLTA2LFxuXHRcdFx0LTYuMDU1OGUtMDUgKiAwLjk5ODc5NTQ1NjIwNTE3MiAvIDIuMzg0ZS0wNixcblx0XHRcdDEuMzczMjllLTA0ICogMC45OTg3OTU0NTYyMDUxNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQ1LjQ2MjE3MGUtMDMgKiAwLjk5ODc5NTQ1NjIwNTE3MiAvIDIuMzg0ZS0wNixcblx0XHRcdC0yLjk4OTAwNjBlLTAyICogMC45OTg3OTU0NTYyMDUxNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNC41NzA0ODRlLTAzICogMC45OTg3OTU0NTYyMDUxNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQtNy4xNDMwMmUtMDQgKiAwLjk5ODc5NTQ1NjIwNTE3MiAvIDIuMzg0ZS0wNixcblx0XHRcdC00LjYyNTNlLTA1ICogMC45OTg3OTU0NTYyMDUxNzIgLyAyLjM4NGUtMDYsXG5cdFx0XHQ0LjkxMjY4NDk3Njk0NjcyNWUtMDIsIDEuOTkwMzY5NDUzMzQ0Mzk0ZSswMCxcblxuXHRcdFx0My41NzgwOTA3ZS0wMiAqIFV0aWwuU1FSVDIgKiAwLjUgLyAyLjM4NGUtMDYsXG5cdFx0XHQxLjc4NzYxNDhlLTAyICogVXRpbC5TUVJUMiAqIDAuNSAvIDIuMzg0ZS0wNixcblx0XHRcdDMuMTM0NzI3ZS0wMyAqIFV0aWwuU1FSVDIgKiAwLjUgLyAyLjM4NGUtMDYsXG5cdFx0XHQyLjQ1NzE0MmUtMDMgKiBVdGlsLlNRUlQyICogMC41IC8gMi4zODRlLTA2LFxuXHRcdFx0OS43MTMxN2UtMDQgKiBVdGlsLlNRUlQyICogMC41IC8gMi4zODRlLTA2LFxuXHRcdFx0Mi4xODg2OGUtMDQgKiBVdGlsLlNRUlQyICogMC41IC8gMi4zODRlLTA2LFxuXHRcdFx0MS4wMTU2NmUtMDQgKiBVdGlsLlNRUlQyICogMC41IC8gMi4zODRlLTA2LFxuXHRcdFx0MS4zODI4ZS0wNSAqIFV0aWwuU1FSVDIgKiAwLjUgLyAyLjM4NGUtMDYsXG5cblx0XHRcdDMuMDUyNjYzOGUtMDIgLyAyLjM4NGUtMDYsIDQuNjM4MTk1ZS0wMyAvIDIuMzg0ZS0wNixcblx0XHRcdDcuNDcyMDRlLTA0IC8gMi4zODRlLTA2LCA0Ljk1OTFlLTA1IC8gMi4zODRlLTA2LFxuXHRcdFx0NC43NTY0NTFlLTAzIC8gMi4zODRlLTA2LCAyLjE0NThlLTA1IC8gMi4zODRlLTA2LFxuXHRcdFx0LTYuOTYxOGUtMDUgLyAyLjM4NGUtMDYsIC8qIDIuMzg0ZS0wNi8yLjM4NGUtMDYgKi9cblx0XTtcblxuXHR2YXIgTlMgPSAxMjtcblx0dmFyIE5MID0gMzY7XG5cblx0dmFyIHdpbiA9IFtcblx0ICAgIFtcblx0ICAgICAyLjM4MjE5MTczOTM0NzkxM2UtMTMsXG5cdCAgICAgNi40MjMzMDU4NzIxNDc4MzRlLTEzLFxuXHQgICAgIDkuNDAwODQ5MDk0MDQ5Njg4ZS0xMyxcblx0ICAgICAxLjEyMjQzNTAyNjA5NjU1NmUtMTIsXG5cdCAgICAgMS4xODM4NDAzMjEyNjc0ODFlLTEyLFxuXHQgICAgIDEuMTIyNDM1MDI2MDk2NTU2ZS0xMixcblx0ICAgICA5LjQwMDg0OTA5NDA0OTY5MGUtMTMsXG5cdCAgICAgNi40MjMzMDU4NzIxNDc4MzllLTEzLFxuXHQgICAgIDIuMzgyMTkxNzM5MzQ3OTE4ZS0xMyxcblxuXHQgICAgIDUuNDU2MTE2MTA4OTQzNDEyZS0xMixcblx0ICAgICA0Ljg3ODk4NTE5OTU2NTg1MmUtMTIsXG5cdCAgICAgNC4yNDA0NDg5OTUwMTczNjdlLTEyLFxuXHQgICAgIDMuNTU5OTA5MDk0NzU4MjUyZS0xMixcblx0ICAgICAyLjg1ODA0MzM1OTI4ODA3NWUtMTIsXG5cdCAgICAgMi4xNTYxNzc2MjM4MTc4OThlLTEyLFxuXHQgICAgIDEuNDc1NjM3NzIzNTU4NzgzZS0xMixcblx0ICAgICA4LjM3MTAxNTE5MDEwMjk3NGUtMTMsXG5cdCAgICAgMi41OTk3MDYwOTYzMjczNzZlLTEzLFxuXG5cdCAgICAgLTUuNDU2MTE2MTA4OTQzNDEyZS0xMixcblx0ICAgICAtNC44Nzg5ODUxOTk1NjU4NTJlLTEyLFxuXHQgICAgIC00LjI0MDQ0ODk5NTAxNzM2N2UtMTIsXG5cdCAgICAgLTMuNTU5OTA5MDk0NzU4MjUyZS0xMixcblx0ICAgICAtMi44NTgwNDMzNTkyODgwNzZlLTEyLFxuXHQgICAgIC0yLjE1NjE3NzYyMzgxNzg5OGUtMTIsXG5cdCAgICAgLTEuNDc1NjM3NzIzNTU4NzgzZS0xMixcblx0ICAgICAtOC4zNzEwMTUxOTAxMDI5NzVlLTEzLFxuXHQgICAgIC0yLjU5OTcwNjA5NjMyNzM3NmUtMTMsXG5cblx0ICAgICAtMi4zODIxOTE3MzkzNDc5MjNlLTEzLFxuXHQgICAgIC02LjQyMzMwNTg3MjE0Nzg0M2UtMTMsXG5cdCAgICAgLTkuNDAwODQ5MDk0MDQ5Njk2ZS0xMyxcblx0ICAgICAtMS4xMjI0MzUwMjYwOTY1NTZlLTEyLFxuXHQgICAgIC0xLjE4Mzg0MDMyMTI2NzQ4MWUtMTIsXG5cdCAgICAgLTEuMTIyNDM1MDI2MDk2NTU2ZS0xMixcblx0ICAgICAtOS40MDA4NDkwOTQwNDk2OTRlLTEzLFxuXHQgICAgIC02LjQyMzMwNTg3MjE0Nzg0MGUtMTMsXG5cdCAgICAgLTIuMzgyMTkxNzM5MzQ3OTE4ZS0xMyxcblx0ICAgICBdLFxuXHQgICAgW1xuXHQgICAgIDIuMzgyMTkxNzM5MzQ3OTEzZS0xMyxcblx0ICAgICA2LjQyMzMwNTg3MjE0NzgzNGUtMTMsXG5cdCAgICAgOS40MDA4NDkwOTQwNDk2ODhlLTEzLFxuXHQgICAgIDEuMTIyNDM1MDI2MDk2NTU2ZS0xMixcblx0ICAgICAxLjE4Mzg0MDMyMTI2NzQ4MWUtMTIsXG5cdCAgICAgMS4xMjI0MzUwMjYwOTY1NTZlLTEyLFxuXHQgICAgIDkuNDAwODQ5MDk0MDQ5Njg4ZS0xMyxcblx0ICAgICA2LjQyMzMwNTg3MjE0Nzg0MWUtMTMsXG5cdCAgICAgMi4zODIxOTE3MzkzNDc5MThlLTEzLFxuXG5cdCAgICAgNS40NTYxMTYxMDg5NDM0MTNlLTEyLFxuXHQgICAgIDQuODc4OTg1MTk5NTY1ODUyZS0xMixcblx0ICAgICA0LjI0MDQ0ODk5NTAxNzM2N2UtMTIsXG5cdCAgICAgMy41NTk5MDkwOTQ3NTgyNTNlLTEyLFxuXHQgICAgIDIuODU4MDQzMzU5Mjg4MDc1ZS0xMixcblx0ICAgICAyLjE1NjE3NzYyMzgxNzg5OGUtMTIsXG5cdCAgICAgMS40NzU2Mzc3MjM1NTg3ODJlLTEyLFxuXHQgICAgIDguMzcxMDE1MTkwMTAyOTc1ZS0xMyxcblx0ICAgICAyLjU5OTcwNjA5NjMyNzM3NmUtMTMsXG5cblx0ICAgICAtNS40NjEzMTQwNjk4MDk3NTVlLTEyLFxuXHQgICAgIC00LjkyMTA4NTc3MDUyNDA1NWUtMTIsXG5cdCAgICAgLTQuMzQzNDA1MDM3MDkxODM4ZS0xMixcblx0ICAgICAtMy43MzI2NjgzNjg3MDc2ODdlLTEyLFxuXHQgICAgIC0zLjA5MzUyMzg0MDE5MDg4NWUtMTIsXG5cdCAgICAgLTIuNDMwODM1NzI3MzI5NDY1ZS0xMixcblx0ICAgICAtMS43MzQ2NzkwMTAwMDc3NTFlLTEyLFxuXHQgICAgIC05Ljc0ODI1MzY1NjYwOTI4MWUtMTMsXG5cdCAgICAgLTIuNzk3NDM1MTIwMTY4MzI2ZS0xMyxcblxuXHQgICAgIDAuMDAwMDAwMDAwMDAwMDAwZSswMCxcblx0ICAgICAwLjAwMDAwMDAwMDAwMDAwMGUrMDAsXG5cdCAgICAgMC4wMDAwMDAwMDAwMDAwMDBlKzAwLFxuXHQgICAgIDAuMDAwMDAwMDAwMDAwMDAwZSswMCxcblx0ICAgICAwLjAwMDAwMDAwMDAwMDAwMGUrMDAsXG5cdCAgICAgMC4wMDAwMDAwMDAwMDAwMDBlKzAwLFxuXHQgICAgIC0yLjI4Mzc0ODI0MTc5OTUzMWUtMTMsXG5cdCAgICAgLTQuMDM3ODU4ODc0MDIwNjg2ZS0xMyxcblx0ICAgICAtMi4xNDY1NDc0NjQ4MjUzMjNlLTEzLFxuXHQgICAgIF0sXG5cdCAgICBbXG5cdCAgICAgMS4zMTY1MjQ5NzU4NzM5NThlLTAxLCAvKiB3aW5bU0hPUlRfVFlQRV0gKi9cblx0ICAgICA0LjE0MjEzNTYyMzczMDk1MGUtMDEsXG5cdCAgICAgNy42NzMyNjk4Nzk3ODk2MDJlLTAxLFxuXG5cdCAgICAgMS4wOTEzMDg1MDEwNjkyNzFlKzAwLCAvKiB0YW50YWJfbCAqL1xuXHQgICAgIDEuMzAzMjI1MzcyODQxMjA2ZSswMCxcblx0ICAgICAxLjU2OTY4NTU3NzExNzQ5MGUrMDAsXG5cdCAgICAgMS45MjA5ODIxMjY5NzExNjZlKzAwLFxuXHQgICAgIDIuNDE0MjEzNTYyMzczMDk0ZSswMCxcblx0ICAgICAzLjE3MTU5NDgwMjM2MzIxMmUrMDAsXG5cdCAgICAgNC41MTA3MDg1MDM2NjIwNTVlKzAwLFxuXHQgICAgIDcuNTk1NzU0MTEyNzI1MTQ2ZSswMCxcblx0ICAgICAyLjI5MDM3NjU1NDg0MzExNWUrMDEsXG5cblx0ICAgICAwLjk4NDgwNzc1MzAxMjIwODAyMDMyLCAvKiBjeCAqL1xuXHQgICAgIDAuNjQyNzg3NjA5Njg2NTM5MzYyOTIsXG5cdCAgICAgMC4zNDIwMjAxNDMzMjU2Njg4MjM5Myxcblx0ICAgICAwLjkzOTY5MjYyMDc4NTkwODQyNzkxLFxuXHQgICAgIC0wLjE3MzY0ODE3NzY2NjkzMDMwMzQzLFxuXHQgICAgIC0wLjc2NjA0NDQ0MzExODk3NzkwMjQzLFxuXHQgICAgIDAuODY2MDI1NDAzNzg0NDM4NzA3NjEsXG5cdCAgICAgMC41MDAwMDAwMDAwMDAwMDBlKzAwLFxuXG5cdCAgICAgLTUuMTQ0OTU3NTU0Mjc1MjY1ZS0wMSwgLyogY2EgKi9cblx0ICAgICAtNC43MTczMTk2ODU2NDk3MjNlLTAxLFxuXHQgICAgIC0zLjEzMzc3NDU0MjAzOTAxOWUtMDEsXG5cdCAgICAgLTEuODE5MTMxOTk2MTA5ODEyZS0wMSxcblx0ICAgICAtOS40NTc0MTkyNTI2NDIwNjRlLTAyLFxuXHQgICAgIC00LjA5NjU1ODI4ODUzMDQwNWUtMDIsXG5cdCAgICAgLTEuNDE5ODU2ODU3MjQ3MTE1ZS0wMixcblx0ICAgICAtMy42OTk5NzQ2NzM3NjAwMzdlLTAzLFxuXG5cdCAgICAgOC41NzQ5MjkyNTcxMjU0NDJlLTAxLCAvKiBjcyAqL1xuXHQgICAgIDguODE3NDE5OTczMTc3MDUyZS0wMSxcblx0ICAgICA5LjQ5NjI4NjQ5MTAyNzMyOWUtMDEsXG5cdCAgICAgOS44MzMxNDU5MjQ5MTc5MDFlLTAxLFxuXHQgICAgIDkuOTU1MTc4MTYwNjc1ODU3ZS0wMSxcblx0ICAgICA5Ljk5MTYwNTU4MTc4MTQ3NWUtMDEsXG5cdCAgICAgOS45OTg5OTE5NTI0NDQ0NzBlLTAxLFxuXHQgICAgIDkuOTk5OTMxNTUwNzAyODAyZS0wMSxcblx0ICAgICBdLFxuXHQgICAgW1xuXHQgICAgIDAuMDAwMDAwMDAwMDAwMDAwZSswMCxcblx0ICAgICAwLjAwMDAwMDAwMDAwMDAwMGUrMDAsXG5cdCAgICAgMC4wMDAwMDAwMDAwMDAwMDBlKzAwLFxuXHQgICAgIDAuMDAwMDAwMDAwMDAwMDAwZSswMCxcblx0ICAgICAwLjAwMDAwMDAwMDAwMDAwMGUrMDAsXG5cdCAgICAgMC4wMDAwMDAwMDAwMDAwMDBlKzAwLFxuXHQgICAgIDIuMjgzNzQ4MjQxNzk5NTMxZS0xMyxcblx0ICAgICA0LjAzNzg1ODg3NDAyMDY4NmUtMTMsXG5cdCAgICAgMi4xNDY1NDc0NjQ4MjUzMjNlLTEzLFxuXG5cdCAgICAgNS40NjEzMTQwNjk4MDk3NTVlLTEyLFxuXHQgICAgIDQuOTIxMDg1NzcwNTI0MDU1ZS0xMixcblx0ICAgICA0LjM0MzQwNTAzNzA5MTgzOGUtMTIsXG5cdCAgICAgMy43MzI2NjgzNjg3MDc2ODdlLTEyLFxuXHQgICAgIDMuMDkzNTIzODQwMTkwODg1ZS0xMixcblx0ICAgICAyLjQzMDgzNTcyNzMyOTQ2NmUtMTIsXG5cdCAgICAgMS43MzQ2NzkwMTAwMDc3NTFlLTEyLFxuXHQgICAgIDkuNzQ4MjUzNjU2NjA5MjgxZS0xMyxcblx0ICAgICAyLjc5NzQzNTEyMDE2ODMyNmUtMTMsXG5cblx0ICAgICAtNS40NTYxMTYxMDg5NDM0MTNlLTEyLFxuXHQgICAgIC00Ljg3ODk4NTE5OTU2NTg1MmUtMTIsXG5cdCAgICAgLTQuMjQwNDQ4OTk1MDE3MzY3ZS0xMixcblx0ICAgICAtMy41NTk5MDkwOTQ3NTgyNTNlLTEyLFxuXHQgICAgIC0yLjg1ODA0MzM1OTI4ODA3NWUtMTIsXG5cdCAgICAgLTIuMTU2MTc3NjIzODE3ODk4ZS0xMixcblx0ICAgICAtMS40NzU2Mzc3MjM1NTg3ODJlLTEyLFxuXHQgICAgIC04LjM3MTAxNTE5MDEwMjk3NWUtMTMsXG5cdCAgICAgLTIuNTk5NzA2MDk2MzI3Mzc2ZS0xMyxcblxuXHQgICAgIC0yLjM4MjE5MTczOTM0NzkxM2UtMTMsXG5cdCAgICAgLTYuNDIzMzA1ODcyMTQ3ODM0ZS0xMyxcblx0ICAgICAtOS40MDA4NDkwOTQwNDk2ODhlLTEzLFxuXHQgICAgIC0xLjEyMjQzNTAyNjA5NjU1NmUtMTIsXG5cdCAgICAgLTEuMTgzODQwMzIxMjY3NDgxZS0xMixcblx0ICAgICAtMS4xMjI0MzUwMjYwOTY1NTZlLTEyLFxuXHQgICAgIC05LjQwMDg0OTA5NDA0OTY4OGUtMTMsXG5cdCAgICAgLTYuNDIzMzA1ODcyMTQ3ODQxZS0xMyxcblx0ICAgICAtMi4zODIxOTE3MzkzNDc5MThlLTEzLFxuXHQgICAgIF1cblx0XTtcblxuXHR2YXIgdGFudGFiX2wgPSB3aW5bRW5jb2Rlci5TSE9SVF9UWVBFXTtcblx0dmFyIGN4ID0gd2luW0VuY29kZXIuU0hPUlRfVFlQRV07XG5cdHZhciBjYSA9IHdpbltFbmNvZGVyLlNIT1JUX1RZUEVdO1xuXHR2YXIgY3MgPSB3aW5bRW5jb2Rlci5TSE9SVF9UWVBFXTtcblxuXHQvKipcblx0ICogbmV3IElEQ1Qgcm91dGluZSB3cml0dGVuIGJ5IFRha2VoaXJvIFRPTUlOQUdBXG5cdCAqXG5cdCAqIFBVUlBPU0U6IE92ZXJsYXBwaW5nIHdpbmRvdyBvbiBQQ00gc2FtcGxlczxCUj5cblx0ICpcblx0ICogU0VNQU5USUNTOjxCUj5cblx0ICogMzIgMTYtYml0IHBjbSBzYW1wbGVzIGFyZSBzY2FsZWQgdG8gZnJhY3Rpb25hbCAyJ3MgY29tcGxlbWVudCBhbmRcblx0ICogY29uY2F0ZW5hdGVkIHRvIHRoZSBlbmQgb2YgdGhlIHdpbmRvdyBidWZmZXIgI3gjLiBUaGUgdXBkYXRlZCB3aW5kb3dcblx0ICogYnVmZmVyICN4IyBpcyB0aGVuIHdpbmRvd2VkIGJ5IHRoZSBhbmFseXNpcyB3aW5kb3cgI2MjIHRvIHByb2R1Y2UgdGhlXG5cdCAqIHdpbmRvd2VkIHNhbXBsZSAjeiNcblx0ICovXG5cdHZhciBvcmRlciA9IFtcblx0ICAgIDAsIDEsIDE2LCAxNywgOCwgOSwgMjQsIDI1LCA0LCA1LCAyMCwgMjEsIDEyLCAxMywgMjgsIDI5LFxuXHQgICAgMiwgMywgMTgsIDE5LCAxMCwgMTEsIDI2LCAyNywgNiwgNywgMjIsIDIzLCAxNCwgMTUsIDMwLCAzMVxuXHRdO1xuXG5cdC8qKlxuXHQgKiByZXR1cm5zIHN1bV9qPTBeMzEgYVtqXSpjb3MoUEkqaiooaysxLzIpLzMyKSwgMDw9azwzMlxuXHQgKi9cblx0ZnVuY3Rpb24gd2luZG93X3N1YmJhbmQoeDEsIHgxUG9zLCBhKSB7XG5cdFx0dmFyIHdwID0gMTA7XG5cblx0XHR2YXIgeDIgPSB4MVBvcyArIDIzOCAtIDE0IC0gMjg2O1xuXG5cdFx0Zm9yICh2YXIgaSA9IC0xNTsgaSA8IDA7IGkrKykge1xuXHRcdFx0dmFyIHcsIHMsIHQ7XG5cblx0XHRcdHcgPSBlbndpbmRvd1t3cCArIC0xMF07XG5cdFx0XHRzID0geDFbeDIgKyAtMjI0XSAqIHc7XG5cdFx0XHR0ID0geDFbeDFQb3MgKyAyMjRdICogdztcblx0XHRcdHcgPSBlbndpbmRvd1t3cCArIC05XTtcblx0XHRcdHMgKz0geDFbeDIgKyAtMTYwXSAqIHc7XG5cdFx0XHR0ICs9IHgxW3gxUG9zICsgMTYwXSAqIHc7XG5cdFx0XHR3ID0gZW53aW5kb3dbd3AgKyAtOF07XG5cdFx0XHRzICs9IHgxW3gyICsgLTk2XSAqIHc7XG5cdFx0XHR0ICs9IHgxW3gxUG9zICsgOTZdICogdztcblx0XHRcdHcgPSBlbndpbmRvd1t3cCArIC03XTtcblx0XHRcdHMgKz0geDFbeDIgKyAtMzJdICogdztcblx0XHRcdHQgKz0geDFbeDFQb3MgKyAzMl0gKiB3O1xuXHRcdFx0dyA9IGVud2luZG93W3dwICsgLTZdO1xuXHRcdFx0cyArPSB4MVt4MiArIDMyXSAqIHc7XG5cdFx0XHR0ICs9IHgxW3gxUG9zICsgLTMyXSAqIHc7XG5cdFx0XHR3ID0gZW53aW5kb3dbd3AgKyAtNV07XG5cdFx0XHRzICs9IHgxW3gyICsgOTZdICogdztcblx0XHRcdHQgKz0geDFbeDFQb3MgKyAtOTZdICogdztcblx0XHRcdHcgPSBlbndpbmRvd1t3cCArIC00XTtcblx0XHRcdHMgKz0geDFbeDIgKyAxNjBdICogdztcblx0XHRcdHQgKz0geDFbeDFQb3MgKyAtMTYwXSAqIHc7XG5cdFx0XHR3ID0gZW53aW5kb3dbd3AgKyAtM107XG5cdFx0XHRzICs9IHgxW3gyICsgMjI0XSAqIHc7XG5cdFx0XHR0ICs9IHgxW3gxUG9zICsgLTIyNF0gKiB3O1xuXG5cdFx0XHR3ID0gZW53aW5kb3dbd3AgKyAtMl07XG5cdFx0XHRzICs9IHgxW3gxUG9zICsgLTI1Nl0gKiB3O1xuXHRcdFx0dCAtPSB4MVt4MiArIDI1Nl0gKiB3O1xuXHRcdFx0dyA9IGVud2luZG93W3dwICsgLTFdO1xuXHRcdFx0cyArPSB4MVt4MVBvcyArIC0xOTJdICogdztcblx0XHRcdHQgLT0geDFbeDIgKyAxOTJdICogdztcblx0XHRcdHcgPSBlbndpbmRvd1t3cCArIDBdO1xuXHRcdFx0cyArPSB4MVt4MVBvcyArIC0xMjhdICogdztcblx0XHRcdHQgLT0geDFbeDIgKyAxMjhdICogdztcblx0XHRcdHcgPSBlbndpbmRvd1t3cCArIDFdO1xuXHRcdFx0cyArPSB4MVt4MVBvcyArIC02NF0gKiB3O1xuXHRcdFx0dCAtPSB4MVt4MiArIDY0XSAqIHc7XG5cdFx0XHR3ID0gZW53aW5kb3dbd3AgKyAyXTtcblx0XHRcdHMgKz0geDFbeDFQb3MgKyAwXSAqIHc7XG5cdFx0XHR0IC09IHgxW3gyICsgMF0gKiB3O1xuXHRcdFx0dyA9IGVud2luZG93W3dwICsgM107XG5cdFx0XHRzICs9IHgxW3gxUG9zICsgNjRdICogdztcblx0XHRcdHQgLT0geDFbeDIgKyAtNjRdICogdztcblx0XHRcdHcgPSBlbndpbmRvd1t3cCArIDRdO1xuXHRcdFx0cyArPSB4MVt4MVBvcyArIDEyOF0gKiB3O1xuXHRcdFx0dCAtPSB4MVt4MiArIC0xMjhdICogdztcblx0XHRcdHcgPSBlbndpbmRvd1t3cCArIDVdO1xuXHRcdFx0cyArPSB4MVt4MVBvcyArIDE5Ml0gKiB3O1xuXHRcdFx0dCAtPSB4MVt4MiArIC0xOTJdICogdztcblxuXHRcdFx0Lypcblx0XHRcdCAqIHRoaXMgbXVsdGlwbHllciBjb3VsZCBiZSByZW1vdmVkLCBidXQgaXQgbmVlZHMgbW9yZSAyNTYgRkxPQVRcblx0XHRcdCAqIGRhdGEuIHRoaW5raW5nIGFib3V0IHRoZSBkYXRhIGNhY2hlIHBlcmZvcm1hbmNlLCBJIHRoaW5rIHdlXG5cdFx0XHQgKiBzaG91bGQgbm90IHVzZSBzdWNoIGEgaHVnZSB0YWJsZS4gdHQgMjAwMC9PY3QvMjVcblx0XHRcdCAqL1xuXHRcdFx0cyAqPSBlbndpbmRvd1t3cCArIDZdO1xuXHRcdFx0dyA9IHQgLSBzO1xuXHRcdFx0YVszMCArIGkgKiAyXSA9IHQgKyBzO1xuXHRcdFx0YVszMSArIGkgKiAyXSA9IGVud2luZG93W3dwICsgN10gKiB3O1xuXHRcdFx0d3AgKz0gMTg7XG5cdFx0XHR4MVBvcy0tO1xuXHRcdFx0eDIrKztcblx0XHR9XG5cdFx0e1xuXHRcdFx0dmFyIHMsIHQsIHUsIHY7XG5cdFx0XHR0ID0geDFbeDFQb3MgKyAtMTZdICogZW53aW5kb3dbd3AgKyAtMTBdO1xuXHRcdFx0cyA9IHgxW3gxUG9zICsgLTMyXSAqIGVud2luZG93W3dwICsgLTJdO1xuXHRcdFx0dCArPSAoeDFbeDFQb3MgKyAtNDhdIC0geDFbeDFQb3MgKyAxNl0pICogZW53aW5kb3dbd3AgKyAtOV07XG5cdFx0XHRzICs9IHgxW3gxUG9zICsgLTk2XSAqIGVud2luZG93W3dwICsgLTFdO1xuXHRcdFx0dCArPSAoeDFbeDFQb3MgKyAtODBdICsgeDFbeDFQb3MgKyA0OF0pICogZW53aW5kb3dbd3AgKyAtOF07XG5cdFx0XHRzICs9IHgxW3gxUG9zICsgLTE2MF0gKiBlbndpbmRvd1t3cCArIDBdO1xuXHRcdFx0dCArPSAoeDFbeDFQb3MgKyAtMTEyXSAtIHgxW3gxUG9zICsgODBdKSAqIGVud2luZG93W3dwICsgLTddO1xuXHRcdFx0cyArPSB4MVt4MVBvcyArIC0yMjRdICogZW53aW5kb3dbd3AgKyAxXTtcblx0XHRcdHQgKz0gKHgxW3gxUG9zICsgLTE0NF0gKyB4MVt4MVBvcyArIDExMl0pICogZW53aW5kb3dbd3AgKyAtNl07XG5cdFx0XHRzIC09IHgxW3gxUG9zICsgMzJdICogZW53aW5kb3dbd3AgKyAyXTtcblx0XHRcdHQgKz0gKHgxW3gxUG9zICsgLTE3Nl0gLSB4MVt4MVBvcyArIDE0NF0pICogZW53aW5kb3dbd3AgKyAtNV07XG5cdFx0XHRzIC09IHgxW3gxUG9zICsgOTZdICogZW53aW5kb3dbd3AgKyAzXTtcblx0XHRcdHQgKz0gKHgxW3gxUG9zICsgLTIwOF0gKyB4MVt4MVBvcyArIDE3Nl0pICogZW53aW5kb3dbd3AgKyAtNF07XG5cdFx0XHRzIC09IHgxW3gxUG9zICsgMTYwXSAqIGVud2luZG93W3dwICsgNF07XG5cdFx0XHR0ICs9ICh4MVt4MVBvcyArIC0yNDBdIC0geDFbeDFQb3MgKyAyMDhdKSAqIGVud2luZG93W3dwICsgLTNdO1xuXHRcdFx0cyAtPSB4MVt4MVBvcyArIDIyNF07XG5cblx0XHRcdHUgPSBzIC0gdDtcblx0XHRcdHYgPSBzICsgdDtcblxuXHRcdFx0dCA9IGFbMTRdO1xuXHRcdFx0cyA9IGFbMTVdIC0gdDtcblxuXHRcdFx0YVszMV0gPSB2ICsgdDsgLyogQTAgKi9cblx0XHRcdGFbMzBdID0gdSArIHM7IC8qIEExICovXG5cdFx0XHRhWzE1XSA9IHUgLSBzOyAvKiBBMiAqL1xuXHRcdFx0YVsxNF0gPSB2IC0gdDsgLyogQTMgKi9cblx0XHR9XG5cdFx0e1xuXHRcdFx0dmFyIHhyO1xuXHRcdFx0eHIgPSBhWzI4XSAtIGFbMF07XG5cdFx0XHRhWzBdICs9IGFbMjhdO1xuXHRcdFx0YVsyOF0gPSB4ciAqIGVud2luZG93W3dwICsgLTIgKiAxOCArIDddO1xuXHRcdFx0eHIgPSBhWzI5XSAtIGFbMV07XG5cdFx0XHRhWzFdICs9IGFbMjldO1xuXHRcdFx0YVsyOV0gPSB4ciAqIGVud2luZG93W3dwICsgLTIgKiAxOCArIDddO1xuXG5cdFx0XHR4ciA9IGFbMjZdIC0gYVsyXTtcblx0XHRcdGFbMl0gKz0gYVsyNl07XG5cdFx0XHRhWzI2XSA9IHhyICogZW53aW5kb3dbd3AgKyAtNCAqIDE4ICsgN107XG5cdFx0XHR4ciA9IGFbMjddIC0gYVszXTtcblx0XHRcdGFbM10gKz0gYVsyN107XG5cdFx0XHRhWzI3XSA9IHhyICogZW53aW5kb3dbd3AgKyAtNCAqIDE4ICsgN107XG5cblx0XHRcdHhyID0gYVsyNF0gLSBhWzRdO1xuXHRcdFx0YVs0XSArPSBhWzI0XTtcblx0XHRcdGFbMjRdID0geHIgKiBlbndpbmRvd1t3cCArIC02ICogMTggKyA3XTtcblx0XHRcdHhyID0gYVsyNV0gLSBhWzVdO1xuXHRcdFx0YVs1XSArPSBhWzI1XTtcblx0XHRcdGFbMjVdID0geHIgKiBlbndpbmRvd1t3cCArIC02ICogMTggKyA3XTtcblxuXHRcdFx0eHIgPSBhWzIyXSAtIGFbNl07XG5cdFx0XHRhWzZdICs9IGFbMjJdO1xuXHRcdFx0YVsyMl0gPSB4ciAqIFV0aWwuU1FSVDI7XG5cdFx0XHR4ciA9IGFbMjNdIC0gYVs3XTtcblx0XHRcdGFbN10gKz0gYVsyM107XG5cdFx0XHRhWzIzXSA9IHhyICogVXRpbC5TUVJUMiAtIGFbN107XG5cdFx0XHRhWzddIC09IGFbNl07XG5cdFx0XHRhWzIyXSAtPSBhWzddO1xuXHRcdFx0YVsyM10gLT0gYVsyMl07XG5cblx0XHRcdHhyID0gYVs2XTtcblx0XHRcdGFbNl0gPSBhWzMxXSAtIHhyO1xuXHRcdFx0YVszMV0gPSBhWzMxXSArIHhyO1xuXHRcdFx0eHIgPSBhWzddO1xuXHRcdFx0YVs3XSA9IGFbMzBdIC0geHI7XG5cdFx0XHRhWzMwXSA9IGFbMzBdICsgeHI7XG5cdFx0XHR4ciA9IGFbMjJdO1xuXHRcdFx0YVsyMl0gPSBhWzE1XSAtIHhyO1xuXHRcdFx0YVsxNV0gPSBhWzE1XSArIHhyO1xuXHRcdFx0eHIgPSBhWzIzXTtcblx0XHRcdGFbMjNdID0gYVsxNF0gLSB4cjtcblx0XHRcdGFbMTRdID0gYVsxNF0gKyB4cjtcblxuXHRcdFx0eHIgPSBhWzIwXSAtIGFbOF07XG5cdFx0XHRhWzhdICs9IGFbMjBdO1xuXHRcdFx0YVsyMF0gPSB4ciAqIGVud2luZG93W3dwICsgLTEwICogMTggKyA3XTtcblx0XHRcdHhyID0gYVsyMV0gLSBhWzldO1xuXHRcdFx0YVs5XSArPSBhWzIxXTtcblx0XHRcdGFbMjFdID0geHIgKiBlbndpbmRvd1t3cCArIC0xMCAqIDE4ICsgN107XG5cblx0XHRcdHhyID0gYVsxOF0gLSBhWzEwXTtcblx0XHRcdGFbMTBdICs9IGFbMThdO1xuXHRcdFx0YVsxOF0gPSB4ciAqIGVud2luZG93W3dwICsgLTEyICogMTggKyA3XTtcblx0XHRcdHhyID0gYVsxOV0gLSBhWzExXTtcblx0XHRcdGFbMTFdICs9IGFbMTldO1xuXHRcdFx0YVsxOV0gPSB4ciAqIGVud2luZG93W3dwICsgLTEyICogMTggKyA3XTtcblxuXHRcdFx0eHIgPSBhWzE2XSAtIGFbMTJdO1xuXHRcdFx0YVsxMl0gKz0gYVsxNl07XG5cdFx0XHRhWzE2XSA9IHhyICogZW53aW5kb3dbd3AgKyAtMTQgKiAxOCArIDddO1xuXHRcdFx0eHIgPSBhWzE3XSAtIGFbMTNdO1xuXHRcdFx0YVsxM10gKz0gYVsxN107XG5cdFx0XHRhWzE3XSA9IHhyICogZW53aW5kb3dbd3AgKyAtMTQgKiAxOCArIDddO1xuXG5cdFx0XHR4ciA9IC1hWzIwXSArIGFbMjRdO1xuXHRcdFx0YVsyMF0gKz0gYVsyNF07XG5cdFx0XHRhWzI0XSA9IHhyICogZW53aW5kb3dbd3AgKyAtMTIgKiAxOCArIDddO1xuXHRcdFx0eHIgPSAtYVsyMV0gKyBhWzI1XTtcblx0XHRcdGFbMjFdICs9IGFbMjVdO1xuXHRcdFx0YVsyNV0gPSB4ciAqIGVud2luZG93W3dwICsgLTEyICogMTggKyA3XTtcblxuXHRcdFx0eHIgPSBhWzRdIC0gYVs4XTtcblx0XHRcdGFbNF0gKz0gYVs4XTtcblx0XHRcdGFbOF0gPSB4ciAqIGVud2luZG93W3dwICsgLTEyICogMTggKyA3XTtcblx0XHRcdHhyID0gYVs1XSAtIGFbOV07XG5cdFx0XHRhWzVdICs9IGFbOV07XG5cdFx0XHRhWzldID0geHIgKiBlbndpbmRvd1t3cCArIC0xMiAqIDE4ICsgN107XG5cblx0XHRcdHhyID0gYVswXSAtIGFbMTJdO1xuXHRcdFx0YVswXSArPSBhWzEyXTtcblx0XHRcdGFbMTJdID0geHIgKiBlbndpbmRvd1t3cCArIC00ICogMTggKyA3XTtcblx0XHRcdHhyID0gYVsxXSAtIGFbMTNdO1xuXHRcdFx0YVsxXSArPSBhWzEzXTtcblx0XHRcdGFbMTNdID0geHIgKiBlbndpbmRvd1t3cCArIC00ICogMTggKyA3XTtcblx0XHRcdHhyID0gYVsxNl0gLSBhWzI4XTtcblx0XHRcdGFbMTZdICs9IGFbMjhdO1xuXHRcdFx0YVsyOF0gPSB4ciAqIGVud2luZG93W3dwICsgLTQgKiAxOCArIDddO1xuXHRcdFx0eHIgPSAtYVsxN10gKyBhWzI5XTtcblx0XHRcdGFbMTddICs9IGFbMjldO1xuXHRcdFx0YVsyOV0gPSB4ciAqIGVud2luZG93W3dwICsgLTQgKiAxOCArIDddO1xuXG5cdFx0XHR4ciA9IFV0aWwuU1FSVDIgKiAoYVsyXSAtIGFbMTBdKTtcblx0XHRcdGFbMl0gKz0gYVsxMF07XG5cdFx0XHRhWzEwXSA9IHhyO1xuXHRcdFx0eHIgPSBVdGlsLlNRUlQyICogKGFbM10gLSBhWzExXSk7XG5cdFx0XHRhWzNdICs9IGFbMTFdO1xuXHRcdFx0YVsxMV0gPSB4cjtcblx0XHRcdHhyID0gVXRpbC5TUVJUMiAqICgtYVsxOF0gKyBhWzI2XSk7XG5cdFx0XHRhWzE4XSArPSBhWzI2XTtcblx0XHRcdGFbMjZdID0geHIgLSBhWzE4XTtcblx0XHRcdHhyID0gVXRpbC5TUVJUMiAqICgtYVsxOV0gKyBhWzI3XSk7XG5cdFx0XHRhWzE5XSArPSBhWzI3XTtcblx0XHRcdGFbMjddID0geHIgLSBhWzE5XTtcblxuXHRcdFx0eHIgPSBhWzJdO1xuXHRcdFx0YVsxOV0gLT0gYVszXTtcblx0XHRcdGFbM10gLT0geHI7XG5cdFx0XHRhWzJdID0gYVszMV0gLSB4cjtcblx0XHRcdGFbMzFdICs9IHhyO1xuXHRcdFx0eHIgPSBhWzNdO1xuXHRcdFx0YVsxMV0gLT0gYVsxOV07XG5cdFx0XHRhWzE4XSAtPSB4cjtcblx0XHRcdGFbM10gPSBhWzMwXSAtIHhyO1xuXHRcdFx0YVszMF0gKz0geHI7XG5cdFx0XHR4ciA9IGFbMThdO1xuXHRcdFx0YVsyN10gLT0gYVsxMV07XG5cdFx0XHRhWzE5XSAtPSB4cjtcblx0XHRcdGFbMThdID0gYVsxNV0gLSB4cjtcblx0XHRcdGFbMTVdICs9IHhyO1xuXG5cdFx0XHR4ciA9IGFbMTldO1xuXHRcdFx0YVsxMF0gLT0geHI7XG5cdFx0XHRhWzE5XSA9IGFbMTRdIC0geHI7XG5cdFx0XHRhWzE0XSArPSB4cjtcblx0XHRcdHhyID0gYVsxMF07XG5cdFx0XHRhWzExXSAtPSB4cjtcblx0XHRcdGFbMTBdID0gYVsyM10gLSB4cjtcblx0XHRcdGFbMjNdICs9IHhyO1xuXHRcdFx0eHIgPSBhWzExXTtcblx0XHRcdGFbMjZdIC09IHhyO1xuXHRcdFx0YVsxMV0gPSBhWzIyXSAtIHhyO1xuXHRcdFx0YVsyMl0gKz0geHI7XG5cdFx0XHR4ciA9IGFbMjZdO1xuXHRcdFx0YVsyN10gLT0geHI7XG5cdFx0XHRhWzI2XSA9IGFbN10gLSB4cjtcblx0XHRcdGFbN10gKz0geHI7XG5cblx0XHRcdHhyID0gYVsyN107XG5cdFx0XHRhWzI3XSA9IGFbNl0gLSB4cjtcblx0XHRcdGFbNl0gKz0geHI7XG5cblx0XHRcdHhyID0gVXRpbC5TUVJUMiAqIChhWzBdIC0gYVs0XSk7XG5cdFx0XHRhWzBdICs9IGFbNF07XG5cdFx0XHRhWzRdID0geHI7XG5cdFx0XHR4ciA9IFV0aWwuU1FSVDIgKiAoYVsxXSAtIGFbNV0pO1xuXHRcdFx0YVsxXSArPSBhWzVdO1xuXHRcdFx0YVs1XSA9IHhyO1xuXHRcdFx0eHIgPSBVdGlsLlNRUlQyICogKGFbMTZdIC0gYVsyMF0pO1xuXHRcdFx0YVsxNl0gKz0gYVsyMF07XG5cdFx0XHRhWzIwXSA9IHhyO1xuXHRcdFx0eHIgPSBVdGlsLlNRUlQyICogKGFbMTddIC0gYVsyMV0pO1xuXHRcdFx0YVsxN10gKz0gYVsyMV07XG5cdFx0XHRhWzIxXSA9IHhyO1xuXG5cdFx0XHR4ciA9IC1VdGlsLlNRUlQyICogKGFbOF0gLSBhWzEyXSk7XG5cdFx0XHRhWzhdICs9IGFbMTJdO1xuXHRcdFx0YVsxMl0gPSB4ciAtIGFbOF07XG5cdFx0XHR4ciA9IC1VdGlsLlNRUlQyICogKGFbOV0gLSBhWzEzXSk7XG5cdFx0XHRhWzldICs9IGFbMTNdO1xuXHRcdFx0YVsxM10gPSB4ciAtIGFbOV07XG5cdFx0XHR4ciA9IC1VdGlsLlNRUlQyICogKGFbMjVdIC0gYVsyOV0pO1xuXHRcdFx0YVsyNV0gKz0gYVsyOV07XG5cdFx0XHRhWzI5XSA9IHhyIC0gYVsyNV07XG5cdFx0XHR4ciA9IC1VdGlsLlNRUlQyICogKGFbMjRdICsgYVsyOF0pO1xuXHRcdFx0YVsyNF0gLT0gYVsyOF07XG5cdFx0XHRhWzI4XSA9IHhyIC0gYVsyNF07XG5cblx0XHRcdHhyID0gYVsyNF0gLSBhWzE2XTtcblx0XHRcdGFbMjRdID0geHI7XG5cdFx0XHR4ciA9IGFbMjBdIC0geHI7XG5cdFx0XHRhWzIwXSA9IHhyO1xuXHRcdFx0eHIgPSBhWzI4XSAtIHhyO1xuXHRcdFx0YVsyOF0gPSB4cjtcblxuXHRcdFx0eHIgPSBhWzI1XSAtIGFbMTddO1xuXHRcdFx0YVsyNV0gPSB4cjtcblx0XHRcdHhyID0gYVsyMV0gLSB4cjtcblx0XHRcdGFbMjFdID0geHI7XG5cdFx0XHR4ciA9IGFbMjldIC0geHI7XG5cdFx0XHRhWzI5XSA9IHhyO1xuXG5cdFx0XHR4ciA9IGFbMTddIC0gYVsxXTtcblx0XHRcdGFbMTddID0geHI7XG5cdFx0XHR4ciA9IGFbOV0gLSB4cjtcblx0XHRcdGFbOV0gPSB4cjtcblx0XHRcdHhyID0gYVsyNV0gLSB4cjtcblx0XHRcdGFbMjVdID0geHI7XG5cdFx0XHR4ciA9IGFbNV0gLSB4cjtcblx0XHRcdGFbNV0gPSB4cjtcblx0XHRcdHhyID0gYVsyMV0gLSB4cjtcblx0XHRcdGFbMjFdID0geHI7XG5cdFx0XHR4ciA9IGFbMTNdIC0geHI7XG5cdFx0XHRhWzEzXSA9IHhyO1xuXHRcdFx0eHIgPSBhWzI5XSAtIHhyO1xuXHRcdFx0YVsyOV0gPSB4cjtcblxuXHRcdFx0eHIgPSBhWzFdIC0gYVswXTtcblx0XHRcdGFbMV0gPSB4cjtcblx0XHRcdHhyID0gYVsxNl0gLSB4cjtcblx0XHRcdGFbMTZdID0geHI7XG5cdFx0XHR4ciA9IGFbMTddIC0geHI7XG5cdFx0XHRhWzE3XSA9IHhyO1xuXHRcdFx0eHIgPSBhWzhdIC0geHI7XG5cdFx0XHRhWzhdID0geHI7XG5cdFx0XHR4ciA9IGFbOV0gLSB4cjtcblx0XHRcdGFbOV0gPSB4cjtcblx0XHRcdHhyID0gYVsyNF0gLSB4cjtcblx0XHRcdGFbMjRdID0geHI7XG5cdFx0XHR4ciA9IGFbMjVdIC0geHI7XG5cdFx0XHRhWzI1XSA9IHhyO1xuXHRcdFx0eHIgPSBhWzRdIC0geHI7XG5cdFx0XHRhWzRdID0geHI7XG5cdFx0XHR4ciA9IGFbNV0gLSB4cjtcblx0XHRcdGFbNV0gPSB4cjtcblx0XHRcdHhyID0gYVsyMF0gLSB4cjtcblx0XHRcdGFbMjBdID0geHI7XG5cdFx0XHR4ciA9IGFbMjFdIC0geHI7XG5cdFx0XHRhWzIxXSA9IHhyO1xuXHRcdFx0eHIgPSBhWzEyXSAtIHhyO1xuXHRcdFx0YVsxMl0gPSB4cjtcblx0XHRcdHhyID0gYVsxM10gLSB4cjtcblx0XHRcdGFbMTNdID0geHI7XG5cdFx0XHR4ciA9IGFbMjhdIC0geHI7XG5cdFx0XHRhWzI4XSA9IHhyO1xuXHRcdFx0eHIgPSBhWzI5XSAtIHhyO1xuXHRcdFx0YVsyOV0gPSB4cjtcblxuXHRcdFx0eHIgPSBhWzBdO1xuXHRcdFx0YVswXSArPSBhWzMxXTtcblx0XHRcdGFbMzFdIC09IHhyO1xuXHRcdFx0eHIgPSBhWzFdO1xuXHRcdFx0YVsxXSArPSBhWzMwXTtcblx0XHRcdGFbMzBdIC09IHhyO1xuXHRcdFx0eHIgPSBhWzE2XTtcblx0XHRcdGFbMTZdICs9IGFbMTVdO1xuXHRcdFx0YVsxNV0gLT0geHI7XG5cdFx0XHR4ciA9IGFbMTddO1xuXHRcdFx0YVsxN10gKz0gYVsxNF07XG5cdFx0XHRhWzE0XSAtPSB4cjtcblx0XHRcdHhyID0gYVs4XTtcblx0XHRcdGFbOF0gKz0gYVsyM107XG5cdFx0XHRhWzIzXSAtPSB4cjtcblx0XHRcdHhyID0gYVs5XTtcblx0XHRcdGFbOV0gKz0gYVsyMl07XG5cdFx0XHRhWzIyXSAtPSB4cjtcblx0XHRcdHhyID0gYVsyNF07XG5cdFx0XHRhWzI0XSArPSBhWzddO1xuXHRcdFx0YVs3XSAtPSB4cjtcblx0XHRcdHhyID0gYVsyNV07XG5cdFx0XHRhWzI1XSArPSBhWzZdO1xuXHRcdFx0YVs2XSAtPSB4cjtcblx0XHRcdHhyID0gYVs0XTtcblx0XHRcdGFbNF0gKz0gYVsyN107XG5cdFx0XHRhWzI3XSAtPSB4cjtcblx0XHRcdHhyID0gYVs1XTtcblx0XHRcdGFbNV0gKz0gYVsyNl07XG5cdFx0XHRhWzI2XSAtPSB4cjtcblx0XHRcdHhyID0gYVsyMF07XG5cdFx0XHRhWzIwXSArPSBhWzExXTtcblx0XHRcdGFbMTFdIC09IHhyO1xuXHRcdFx0eHIgPSBhWzIxXTtcblx0XHRcdGFbMjFdICs9IGFbMTBdO1xuXHRcdFx0YVsxMF0gLT0geHI7XG5cdFx0XHR4ciA9IGFbMTJdO1xuXHRcdFx0YVsxMl0gKz0gYVsxOV07XG5cdFx0XHRhWzE5XSAtPSB4cjtcblx0XHRcdHhyID0gYVsxM107XG5cdFx0XHRhWzEzXSArPSBhWzE4XTtcblx0XHRcdGFbMThdIC09IHhyO1xuXHRcdFx0eHIgPSBhWzI4XTtcblx0XHRcdGFbMjhdICs9IGFbM107XG5cdFx0XHRhWzNdIC09IHhyO1xuXHRcdFx0eHIgPSBhWzI5XTtcblx0XHRcdGFbMjldICs9IGFbMl07XG5cdFx0XHRhWzJdIC09IHhyO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBGdW5jdGlvbjogQ2FsY3VsYXRpb24gb2YgdGhlIE1EQ1QgSW4gdGhlIGNhc2Ugb2YgbG9uZyBibG9ja3MgKHR5cGUgMCwxLDMpXG5cdCAqIHRoZXJlIGFyZSAzNiBjb2VmZmljZW50cyBpbiB0aGUgdGltZSBkb21haW4gYW5kIDE4IGluIHRoZSBmcmVxdWVuY3lcblx0ICogZG9tYWluLjxCUj5cblx0ICogSW4gdGhlIGNhc2Ugb2Ygc2hvcnQgYmxvY2tzICh0eXBlIDIpIHRoZXJlIGFyZSAzIHRyYW5zZm9ybWF0aW9ucyB3aXRoXG5cdCAqIHNob3J0IGxlbmd0aC4gVGhpcyBsZWFkcyB0byAxMiBjb2VmZmljZW50cyBpbiB0aGUgdGltZSBhbmQgNiBpbiB0aGVcblx0ICogZnJlcXVlbmN5IGRvbWFpbi4gSW4gdGhpcyBjYXNlIHRoZSByZXN1bHRzIGFyZSBzdG9yZWQgc2lkZSBieSBzaWRlIGluIHRoZVxuXHQgKiB2ZWN0b3Igb3V0W10uXG5cdCAqXG5cdCAqIE5ldyBsYXllcjNcblx0ICovXG5cdGZ1bmN0aW9uIG1kY3Rfc2hvcnQoaW5vdXQsIGlub3V0UG9zKSB7XG5cdFx0Zm9yICh2YXIgbCA9IDA7IGwgPCAzOyBsKyspIHtcblx0XHRcdHZhciB0YzAsIHRjMSwgdGMyLCB0czAsIHRzMSwgdHMyO1xuXG5cdFx0XHR0czAgPSBpbm91dFtpbm91dFBvcyArIDIgKiAzXSAqIHdpbltFbmNvZGVyLlNIT1JUX1RZUEVdWzBdXG5cdFx0XHRcdFx0LSBpbm91dFtpbm91dFBvcyArIDUgKiAzXTtcblx0XHRcdHRjMCA9IGlub3V0W2lub3V0UG9zICsgMCAqIDNdICogd2luW0VuY29kZXIuU0hPUlRfVFlQRV1bMl1cblx0XHRcdFx0XHQtIGlub3V0W2lub3V0UG9zICsgMyAqIDNdO1xuXHRcdFx0dGMxID0gdHMwICsgdGMwO1xuXHRcdFx0dGMyID0gdHMwIC0gdGMwO1xuXG5cdFx0XHR0czAgPSBpbm91dFtpbm91dFBvcyArIDUgKiAzXSAqIHdpbltFbmNvZGVyLlNIT1JUX1RZUEVdWzBdXG5cdFx0XHRcdFx0KyBpbm91dFtpbm91dFBvcyArIDIgKiAzXTtcblx0XHRcdHRjMCA9IGlub3V0W2lub3V0UG9zICsgMyAqIDNdICogd2luW0VuY29kZXIuU0hPUlRfVFlQRV1bMl1cblx0XHRcdFx0XHQrIGlub3V0W2lub3V0UG9zICsgMCAqIDNdO1xuXHRcdFx0dHMxID0gdHMwICsgdGMwO1xuXHRcdFx0dHMyID0gLXRzMCArIHRjMDtcblxuXHRcdFx0dGMwID0gKGlub3V0W2lub3V0UG9zICsgMSAqIDNdICogd2luW0VuY29kZXIuU0hPUlRfVFlQRV1bMV0gLSBpbm91dFtpbm91dFBvcyArIDQgKiAzXSkgKiAyLjA2OTk3ODExMTk1MzA4OWUtMTE7XG5cdFx0XHQvKlxuXHRcdFx0ICogdHJpdGFiX3MgWyAxIF1cblx0XHRcdCAqL1xuXHRcdFx0dHMwID0gKGlub3V0W2lub3V0UG9zICsgNCAqIDNdICogd2luW0VuY29kZXIuU0hPUlRfVFlQRV1bMV0gKyBpbm91dFtpbm91dFBvcyArIDEgKiAzXSkgKiAyLjA2OTk3ODExMTk1MzA4OWUtMTE7XG5cdFx0XHQvKlxuXHRcdFx0ICogdHJpdGFiX3MgWyAxIF1cblx0XHRcdCAqL1xuXHRcdFx0aW5vdXRbaW5vdXRQb3MgKyAzICogMF0gPSB0YzEgKiAxLjkwNzUyNTE5MTczNzI4MGUtMTEgKyB0YzA7XG5cdFx0XHQvKlxuXHRcdFx0ICogdHJpdGFiX3NbIDIgXVxuXHRcdFx0ICovXG5cdFx0XHRpbm91dFtpbm91dFBvcyArIDMgKiA1XSA9IC10czEgKiAxLjkwNzUyNTE5MTczNzI4MGUtMTEgKyB0czA7XG5cdFx0XHQvKlxuXHRcdFx0ICogdHJpdGFiX3NbMCBdXG5cdFx0XHQgKi9cblx0XHRcdHRjMiA9IHRjMiAqIDAuODY2MDI1NDAzNzg0NDM4NzA3NjEgKiAxLjkwNzUyNTE5MTczNzI4MWUtMTE7XG5cdFx0XHQvKlxuXHRcdFx0ICogdHJpdGFiX3NbIDJdXG5cdFx0XHQgKi9cblx0XHRcdHRzMSA9IHRzMSAqIDAuNSAqIDEuOTA3NTI1MTkxNzM3MjgxZS0xMSArIHRzMDtcblx0XHRcdGlub3V0W2lub3V0UG9zICsgMyAqIDFdID0gdGMyIC0gdHMxO1xuXHRcdFx0aW5vdXRbaW5vdXRQb3MgKyAzICogMl0gPSB0YzIgKyB0czE7XG5cblx0XHRcdHRjMSA9IHRjMSAqIDAuNSAqIDEuOTA3NTI1MTkxNzM3MjgxZS0xMSAtIHRjMDtcblx0XHRcdHRzMiA9IHRzMiAqIDAuODY2MDI1NDAzNzg0NDM4NzA3NjEgKiAxLjkwNzUyNTE5MTczNzI4MWUtMTE7XG5cdFx0XHQvKlxuXHRcdFx0ICogdHJpdGFiX3NbIDBdXG5cdFx0XHQgKi9cblx0XHRcdGlub3V0W2lub3V0UG9zICsgMyAqIDNdID0gdGMxICsgdHMyO1xuXHRcdFx0aW5vdXRbaW5vdXRQb3MgKyAzICogNF0gPSB0YzEgLSB0czI7XG5cblx0XHRcdGlub3V0UG9zKys7XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gbWRjdF9sb25nKG91dCwgb3V0UG9zLCBfaW4pIHtcblx0XHR2YXIgY3QsIHN0O1xuXHRcdHtcblx0XHRcdHZhciB0YzEsIHRjMiwgdGMzLCB0YzQsIHRzNSwgdHM2LCB0czcsIHRzODtcblx0XHRcdC8qIDEsMiwgNSw2LCA5LDEwLCAxMywxNCwgMTcgKi9cblx0XHRcdHRjMSA9IF9pblsxN10gLSBfaW5bOV07XG5cdFx0XHR0YzMgPSBfaW5bMTVdIC0gX2luWzExXTtcblx0XHRcdHRjNCA9IF9pblsxNF0gLSBfaW5bMTJdO1xuXHRcdFx0dHM1ID0gX2luWzBdICsgX2luWzhdO1xuXHRcdFx0dHM2ID0gX2luWzFdICsgX2luWzddO1xuXHRcdFx0dHM3ID0gX2luWzJdICsgX2luWzZdO1xuXHRcdFx0dHM4ID0gX2luWzNdICsgX2luWzVdO1xuXG5cdFx0XHRvdXRbb3V0UG9zICsgMTddID0gKHRzNSArIHRzNyAtIHRzOCkgLSAodHM2IC0gX2luWzRdKTtcblx0XHRcdHN0ID0gKHRzNSArIHRzNyAtIHRzOCkgKiBjeFsxMiArIDddICsgKHRzNiAtIF9pbls0XSk7XG5cdFx0XHRjdCA9ICh0YzEgLSB0YzMgLSB0YzQpICogY3hbMTIgKyA2XTtcblx0XHRcdG91dFtvdXRQb3MgKyA1XSA9IGN0ICsgc3Q7XG5cdFx0XHRvdXRbb3V0UG9zICsgNl0gPSBjdCAtIHN0O1xuXG5cdFx0XHR0YzIgPSAoX2luWzE2XSAtIF9pblsxMF0pICogY3hbMTIgKyA2XTtcblx0XHRcdHRzNiA9IHRzNiAqIGN4WzEyICsgN10gKyBfaW5bNF07XG5cdFx0XHRjdCA9IHRjMSAqIGN4WzEyICsgMF0gKyB0YzIgKyB0YzMgKiBjeFsxMiArIDFdICsgdGM0ICogY3hbMTIgKyAyXTtcblx0XHRcdHN0ID0gLXRzNSAqIGN4WzEyICsgNF0gKyB0czYgLSB0czcgKiBjeFsxMiArIDVdICsgdHM4ICogY3hbMTIgKyAzXTtcblx0XHRcdG91dFtvdXRQb3MgKyAxXSA9IGN0ICsgc3Q7XG5cdFx0XHRvdXRbb3V0UG9zICsgMl0gPSBjdCAtIHN0O1xuXG5cdFx0XHRjdCA9IHRjMSAqIGN4WzEyICsgMV0gLSB0YzIgLSB0YzMgKiBjeFsxMiArIDJdICsgdGM0ICogY3hbMTIgKyAwXTtcblx0XHRcdHN0ID0gLXRzNSAqIGN4WzEyICsgNV0gKyB0czYgLSB0czcgKiBjeFsxMiArIDNdICsgdHM4ICogY3hbMTIgKyA0XTtcblx0XHRcdG91dFtvdXRQb3MgKyA5XSA9IGN0ICsgc3Q7XG5cdFx0XHRvdXRbb3V0UG9zICsgMTBdID0gY3QgLSBzdDtcblxuXHRcdFx0Y3QgPSB0YzEgKiBjeFsxMiArIDJdIC0gdGMyICsgdGMzICogY3hbMTIgKyAwXSAtIHRjNCAqIGN4WzEyICsgMV07XG5cdFx0XHRzdCA9IHRzNSAqIGN4WzEyICsgM10gLSB0czYgKyB0czcgKiBjeFsxMiArIDRdIC0gdHM4ICogY3hbMTIgKyA1XTtcblx0XHRcdG91dFtvdXRQb3MgKyAxM10gPSBjdCArIHN0O1xuXHRcdFx0b3V0W291dFBvcyArIDE0XSA9IGN0IC0gc3Q7XG5cdFx0fVxuXHRcdHtcblx0XHRcdHZhciB0czEsIHRzMiwgdHMzLCB0czQsIHRjNSwgdGM2LCB0YzcsIHRjODtcblxuXHRcdFx0dHMxID0gX2luWzhdIC0gX2luWzBdO1xuXHRcdFx0dHMzID0gX2luWzZdIC0gX2luWzJdO1xuXHRcdFx0dHM0ID0gX2luWzVdIC0gX2luWzNdO1xuXHRcdFx0dGM1ID0gX2luWzE3XSArIF9pbls5XTtcblx0XHRcdHRjNiA9IF9pblsxNl0gKyBfaW5bMTBdO1xuXHRcdFx0dGM3ID0gX2luWzE1XSArIF9pblsxMV07XG5cdFx0XHR0YzggPSBfaW5bMTRdICsgX2luWzEyXTtcblxuXHRcdFx0b3V0W291dFBvcyArIDBdID0gKHRjNSArIHRjNyArIHRjOCkgKyAodGM2ICsgX2luWzEzXSk7XG5cdFx0XHRjdCA9ICh0YzUgKyB0YzcgKyB0YzgpICogY3hbMTIgKyA3XSAtICh0YzYgKyBfaW5bMTNdKTtcblx0XHRcdHN0ID0gKHRzMSAtIHRzMyArIHRzNCkgKiBjeFsxMiArIDZdO1xuXHRcdFx0b3V0W291dFBvcyArIDExXSA9IGN0ICsgc3Q7XG5cdFx0XHRvdXRbb3V0UG9zICsgMTJdID0gY3QgLSBzdDtcblxuXHRcdFx0dHMyID0gKF9pbls3XSAtIF9pblsxXSkgKiBjeFsxMiArIDZdO1xuXHRcdFx0dGM2ID0gX2luWzEzXSAtIHRjNiAqIGN4WzEyICsgN107XG5cdFx0XHRjdCA9IHRjNSAqIGN4WzEyICsgM10gLSB0YzYgKyB0YzcgKiBjeFsxMiArIDRdICsgdGM4ICogY3hbMTIgKyA1XTtcblx0XHRcdHN0ID0gdHMxICogY3hbMTIgKyAyXSArIHRzMiArIHRzMyAqIGN4WzEyICsgMF0gKyB0czQgKiBjeFsxMiArIDFdO1xuXHRcdFx0b3V0W291dFBvcyArIDNdID0gY3QgKyBzdDtcblx0XHRcdG91dFtvdXRQb3MgKyA0XSA9IGN0IC0gc3Q7XG5cblx0XHRcdGN0ID0gLXRjNSAqIGN4WzEyICsgNV0gKyB0YzYgLSB0YzcgKiBjeFsxMiArIDNdIC0gdGM4ICogY3hbMTIgKyA0XTtcblx0XHRcdHN0ID0gdHMxICogY3hbMTIgKyAxXSArIHRzMiAtIHRzMyAqIGN4WzEyICsgMl0gLSB0czQgKiBjeFsxMiArIDBdO1xuXHRcdFx0b3V0W291dFBvcyArIDddID0gY3QgKyBzdDtcblx0XHRcdG91dFtvdXRQb3MgKyA4XSA9IGN0IC0gc3Q7XG5cblx0XHRcdGN0ID0gLXRjNSAqIGN4WzEyICsgNF0gKyB0YzYgLSB0YzcgKiBjeFsxMiArIDVdIC0gdGM4ICogY3hbMTIgKyAzXTtcblx0XHRcdHN0ID0gdHMxICogY3hbMTIgKyAwXSAtIHRzMiArIHRzMyAqIGN4WzEyICsgMV0gLSB0czQgKiBjeFsxMiArIDJdO1xuXHRcdFx0b3V0W291dFBvcyArIDE1XSA9IGN0ICsgc3Q7XG5cdFx0XHRvdXRbb3V0UG9zICsgMTZdID0gY3QgLSBzdDtcblx0XHR9XG5cdH1cblxuXHR0aGlzLm1kY3Rfc3ViNDggPSBmdW5jdGlvbihnZmMsIHcwLCB3MSkge1xuXHRcdHZhciB3ayA9IHcwO1xuXHRcdHZhciB3a1BvcyA9IDI4Njtcblx0XHQvKiB0aGlua2luZyBjYWNoZSBwZXJmb3JtYW5jZSwgY2gtPmdyIGxvb3AgaXMgYmV0dGVyIHRoYW4gZ3ItPmNoIGxvb3AgKi9cblx0XHRmb3IgKHZhciBjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuXHRcdFx0Zm9yICh2YXIgZ3IgPSAwOyBnciA8IGdmYy5tb2RlX2dyOyBncisrKSB7XG5cdFx0XHRcdHZhciBiYW5kO1xuXHRcdFx0XHR2YXIgZ2kgPSAoZ2ZjLmwzX3NpZGUudHRbZ3JdW2NoXSk7XG5cdFx0XHRcdHZhciBtZGN0X2VuYyA9IGdpLnhyO1xuXHRcdFx0XHR2YXIgbWRjdF9lbmNQb3MgPSAwO1xuXHRcdFx0XHR2YXIgc2FtcCA9IGdmYy5zYl9zYW1wbGVbY2hdWzEgLSBncl07XG5cdFx0XHRcdHZhciBzYW1wUG9zID0gMDtcblxuXHRcdFx0XHRmb3IgKHZhciBrID0gMDsgayA8IDE4IC8gMjsgaysrKSB7XG5cdFx0XHRcdFx0d2luZG93X3N1YmJhbmQod2ssIHdrUG9zLCBzYW1wW3NhbXBQb3NdKTtcblx0XHRcdFx0XHR3aW5kb3dfc3ViYmFuZCh3aywgd2tQb3MgKyAzMiwgc2FtcFtzYW1wUG9zICsgMV0pO1xuXHRcdFx0XHRcdHNhbXBQb3MgKz0gMjtcblx0XHRcdFx0XHR3a1BvcyArPSA2NDtcblx0XHRcdFx0XHQvKlxuXHRcdFx0XHRcdCAqIENvbXBlbnNhdGUgZm9yIGludmVyc2lvbiBpbiB0aGUgYW5hbHlzaXMgZmlsdGVyXG5cdFx0XHRcdFx0ICovXG5cdFx0XHRcdFx0Zm9yIChiYW5kID0gMTsgYmFuZCA8IDMyOyBiYW5kICs9IDIpIHtcblx0XHRcdFx0XHRcdHNhbXBbc2FtcFBvcyAtIDFdW2JhbmRdICo9IC0xO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8qXG5cdFx0XHRcdCAqIFBlcmZvcm0gaW1kY3Qgb2YgMTggcHJldmlvdXMgc3ViYmFuZCBzYW1wbGVzICsgMTggY3VycmVudFxuXHRcdFx0XHQgKiBzdWJiYW5kIHNhbXBsZXNcblx0XHRcdFx0ICovXG5cdFx0XHRcdGZvciAoYmFuZCA9IDA7IGJhbmQgPCAzMjsgYmFuZCsrLCBtZGN0X2VuY1BvcyArPSAxOCkge1xuXHRcdFx0XHRcdHZhciB0eXBlID0gZ2kuYmxvY2tfdHlwZTtcblx0XHRcdFx0XHR2YXIgYmFuZDAgPSBnZmMuc2Jfc2FtcGxlW2NoXVtncl07XG5cdFx0XHRcdFx0dmFyIGJhbmQxID0gZ2ZjLnNiX3NhbXBsZVtjaF1bMSAtIGdyXTtcblx0XHRcdFx0XHRpZiAoZ2kubWl4ZWRfYmxvY2tfZmxhZyAhPSAwICYmIGJhbmQgPCAyKVxuXHRcdFx0XHRcdFx0dHlwZSA9IDA7XG5cdFx0XHRcdFx0aWYgKGdmYy5hbXBfZmlsdGVyW2JhbmRdIDwgMWUtMTIpIHtcblx0XHRcdFx0XHRcdEFycmF5cy5maWxsKG1kY3RfZW5jLCBtZGN0X2VuY1BvcyArIDAsXG5cdFx0XHRcdFx0XHRcdFx0bWRjdF9lbmNQb3MgKyAxOCwgMCk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGlmIChnZmMuYW1wX2ZpbHRlcltiYW5kXSA8IDEuMCkge1xuXHRcdFx0XHRcdFx0XHRmb3IgKHZhciBrID0gMDsgayA8IDE4OyBrKyspXG5cdFx0XHRcdFx0XHRcdFx0YmFuZDFba11bb3JkZXJbYmFuZF1dICo9IGdmYy5hbXBfZmlsdGVyW2JhbmRdO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0aWYgKHR5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFKSB7XG5cdFx0XHRcdFx0XHRcdGZvciAodmFyIGsgPSAtTlMgLyA0OyBrIDwgMDsgaysrKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIHcgPSB3aW5bRW5jb2Rlci5TSE9SVF9UWVBFXVtrICsgM107XG5cdFx0XHRcdFx0XHRcdFx0bWRjdF9lbmNbbWRjdF9lbmNQb3MgKyBrICogMyArIDldID0gYmFuZDBbOSArIGtdW29yZGVyW2JhbmRdXVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQqIHcgLSBiYW5kMFs4IC0ga11bb3JkZXJbYmFuZF1dO1xuXHRcdFx0XHRcdFx0XHRcdG1kY3RfZW5jW21kY3RfZW5jUG9zICsgayAqIDMgKyAxOF0gPSBiYW5kMFsxNCAtIGtdW29yZGVyW2JhbmRdXVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQqIHcgKyBiYW5kMFsxNSArIGtdW29yZGVyW2JhbmRdXTtcblx0XHRcdFx0XHRcdFx0XHRtZGN0X2VuY1ttZGN0X2VuY1BvcyArIGsgKiAzICsgMTBdID0gYmFuZDBbMTUgKyBrXVtvcmRlcltiYW5kXV1cblx0XHRcdFx0XHRcdFx0XHRcdFx0KiB3IC0gYmFuZDBbMTQgLSBrXVtvcmRlcltiYW5kXV07XG5cdFx0XHRcdFx0XHRcdFx0bWRjdF9lbmNbbWRjdF9lbmNQb3MgKyBrICogMyArIDE5XSA9IGJhbmQxWzIgLSBrXVtvcmRlcltiYW5kXV1cblx0XHRcdFx0XHRcdFx0XHRcdFx0KiB3ICsgYmFuZDFbMyArIGtdW29yZGVyW2JhbmRdXTtcblx0XHRcdFx0XHRcdFx0XHRtZGN0X2VuY1ttZGN0X2VuY1BvcyArIGsgKiAzICsgMTFdID0gYmFuZDFbMyArIGtdW29yZGVyW2JhbmRdXVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQqIHcgLSBiYW5kMVsyIC0ga11bb3JkZXJbYmFuZF1dO1xuXHRcdFx0XHRcdFx0XHRcdG1kY3RfZW5jW21kY3RfZW5jUG9zICsgayAqIDMgKyAyMF0gPSBiYW5kMVs4IC0ga11bb3JkZXJbYmFuZF1dXG5cdFx0XHRcdFx0XHRcdFx0XHRcdCogdyArIGJhbmQxWzkgKyBrXVtvcmRlcltiYW5kXV07XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0bWRjdF9zaG9ydChtZGN0X2VuYywgbWRjdF9lbmNQb3MpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0dmFyIHdvcmsgPSBuZXdfZmxvYXQoMTgpO1xuXHRcdFx0XHRcdFx0XHRmb3IgKHZhciBrID0gLU5MIC8gNDsgayA8IDA7IGsrKykge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBhLCBiO1xuXHRcdFx0XHRcdFx0XHRcdGEgPSB3aW5bdHlwZV1bayArIDI3XVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQqIGJhbmQxW2sgKyA5XVtvcmRlcltiYW5kXV1cblx0XHRcdFx0XHRcdFx0XHRcdFx0KyB3aW5bdHlwZV1bayArIDM2XVxuXHRcdFx0XHRcdFx0XHRcdFx0XHQqIGJhbmQxWzggLSBrXVtvcmRlcltiYW5kXV07XG5cdFx0XHRcdFx0XHRcdFx0YiA9IHdpblt0eXBlXVtrICsgOV1cblx0XHRcdFx0XHRcdFx0XHRcdFx0KiBiYW5kMFtrICsgOV1bb3JkZXJbYmFuZF1dXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC0gd2luW3R5cGVdW2sgKyAxOF1cblx0XHRcdFx0XHRcdFx0XHRcdFx0KiBiYW5kMFs4IC0ga11bb3JkZXJbYmFuZF1dO1xuXHRcdFx0XHRcdFx0XHRcdHdvcmtbayArIDldID0gYSAtIGIgKiB0YW50YWJfbFszICsgayArIDldO1xuXHRcdFx0XHRcdFx0XHRcdHdvcmtbayArIDE4XSA9IGEgKiB0YW50YWJfbFszICsgayArIDldICsgYjtcblx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdG1kY3RfbG9uZyhtZGN0X2VuYywgbWRjdF9lbmNQb3MsIHdvcmspO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQvKlxuXHRcdFx0XHRcdCAqIFBlcmZvcm0gYWxpYXNpbmcgcmVkdWN0aW9uIGJ1dHRlcmZseVxuXHRcdFx0XHRcdCAqL1xuXHRcdFx0XHRcdGlmICh0eXBlICE9IEVuY29kZXIuU0hPUlRfVFlQRSAmJiBiYW5kICE9IDApIHtcblx0XHRcdFx0XHRcdGZvciAodmFyIGsgPSA3OyBrID49IDA7IC0taykge1xuXHRcdFx0XHRcdFx0XHR2YXIgYnUsIGJkO1xuXHRcdFx0XHRcdFx0XHRidSA9IG1kY3RfZW5jW21kY3RfZW5jUG9zICsga10gKiBjYVsyMCArIGtdXG5cdFx0XHRcdFx0XHRcdFx0XHQrIG1kY3RfZW5jW21kY3RfZW5jUG9zICsgLTEgLSBrXVxuXHRcdFx0XHRcdFx0XHRcdFx0KiBjc1syOCArIGtdO1xuXHRcdFx0XHRcdFx0XHRiZCA9IG1kY3RfZW5jW21kY3RfZW5jUG9zICsga10gKiBjc1syOCArIGtdXG5cdFx0XHRcdFx0XHRcdFx0XHQtIG1kY3RfZW5jW21kY3RfZW5jUG9zICsgLTEgLSBrXVxuXHRcdFx0XHRcdFx0XHRcdFx0KiBjYVsyMCArIGtdO1xuXG5cdFx0XHRcdFx0XHRcdG1kY3RfZW5jW21kY3RfZW5jUG9zICsgLTEgLSBrXSA9IGJ1O1xuXHRcdFx0XHRcdFx0XHRtZGN0X2VuY1ttZGN0X2VuY1BvcyArIGtdID0gYmQ7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHR3ayA9IHcxO1xuXHRcdFx0d2tQb3MgPSAyODY7XG5cdFx0XHRpZiAoZ2ZjLm1vZGVfZ3IgPT0gMSkge1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IDE4OyBpKyspIHtcblx0XHRcdFx0XHRTeXN0ZW0uYXJyYXljb3B5KGdmYy5zYl9zYW1wbGVbY2hdWzFdW2ldLCAwLFxuXHRcdFx0XHRcdFx0XHRnZmMuc2Jfc2FtcGxlW2NoXVswXVtpXSwgMCwgMzIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59XG5cbi8vcGFja2FnZSBtcDM7XG5cblxuZnVuY3Rpb24gSUlJX3BzeV9yYXRpbygpIHtcblx0dGhpcy50aG0gPSBuZXcgSUlJX3BzeV94bWluKCk7XG5cdHRoaXMuZW4gPSBuZXcgSUlJX3BzeV94bWluKCk7XG59XG5cblxuLyoqXG4gKiBFTkNERUxBWSBUaGUgZW5jb2RlciBkZWxheS5cbiAqXG4gKiBNaW5pbXVtIGFsbG93ZWQgaXMgTURDVERFTEFZIChzZWUgYmVsb3cpXG4gKlxuICogVGhlIGZpcnN0IDk2IHNhbXBsZXMgd2lsbCBiZSBhdHRlbnVhdGVkLCBzbyB1c2luZyBhIHZhbHVlIGxlc3MgdGhhbiA5NlxuICogd2lsbCByZXN1bHQgaW4gY29ycnVwdCBkYXRhIGZvciB0aGUgZmlyc3QgOTYtRU5DREVMQVkgc2FtcGxlcy5cbiAqXG4gKiBzdWdnZXN0ZWQ6IDU3NiBzZXQgdG8gMTE2MCB0byBzeW5jIHdpdGggRmhHLlxuICovXG5FbmNvZGVyLkVOQ0RFTEFZID0gNTc2O1xuLyoqXG4gKiBtYWtlIHN1cmUgdGhlcmUgaXMgYXQgbGVhc3Qgb25lIGNvbXBsZXRlIGZyYW1lIGFmdGVyIHRoZSBsYXN0IGZyYW1lXG4gKiBjb250YWluaW5nIHJlYWwgZGF0YVxuICpcbiAqIFVzaW5nIGEgdmFsdWUgb2YgMjg4IHdvdWxkIGJlIHN1ZmZpY2llbnQgZm9yIGEgYSB2ZXJ5IHNvcGhpc3RpY2F0ZWRcbiAqIGRlY29kZXIgdGhhdCBjYW4gZGVjb2RlIGdyYW51bGUtYnktZ3JhbnVsZSBpbnN0ZWFkIG9mIGZyYW1lIGJ5IGZyYW1lLiBCdXRcbiAqIGxldHMgbm90IGFzc3VtZSB0aGlzLCBhbmQgYXNzdW1lIHRoZSBkZWNvZGVyIHdpbGwgbm90IGRlY29kZSBmcmFtZSBOXG4gKiB1bmxlc3MgaXQgYWxzbyBoYXMgZGF0YSBmb3IgZnJhbWUgTisxXG4gKi9cbkVuY29kZXIuUE9TVERFTEFZID0gMTE1MjtcblxuLyoqXG4gKiBkZWxheSBvZiB0aGUgTURDVCB1c2VkIGluIG1kY3QuYyBvcmlnaW5hbCBJU08gcm91dGluZXMgaGFkIGEgZGVsYXkgb2ZcbiAqIDUyOCEgVGFrZWhpcm8ncyByb3V0aW5lczpcbiAqL1xuRW5jb2Rlci5NRENUREVMQVkgPSA0ODtcbkVuY29kZXIuRkZUT0ZGU0VUID0gKDIyNCArIEVuY29kZXIuTURDVERFTEFZKTtcblxuLyoqXG4gKiBNb3N0IGRlY29kZXJzLCBpbmNsdWRpbmcgdGhlIG9uZSB3ZSB1c2UsIGhhdmUgYSBkZWxheSBvZiA1Mjggc2FtcGxlcy5cbiAqL1xuRW5jb2Rlci5ERUNERUxBWSA9IDUyODtcblxuLyoqXG4gKiBudW1iZXIgb2Ygc3ViYmFuZHNcbiAqL1xuRW5jb2Rlci5TQkxJTUlUID0gMzI7XG5cbi8qKlxuICogcGFyaXRpb24gYmFuZHMgYmFuZHNcbiAqL1xuRW5jb2Rlci5DQkFORFMgPSA2NDtcblxuLyoqXG4gKiBudW1iZXIgb2YgY3JpdGljYWwgYmFuZHMvc2NhbGUgZmFjdG9yIGJhbmRzIHdoZXJlIG1hc2tpbmcgaXMgY29tcHV0ZWRcbiAqL1xuRW5jb2Rlci5TQlBTWV9sID0gMjE7XG5FbmNvZGVyLlNCUFNZX3MgPSAxMjtcblxuLyoqXG4gKiB0b3RhbCBudW1iZXIgb2Ygc2NhbGVmYWN0b3IgYmFuZHMgZW5jb2RlZFxuICovXG5FbmNvZGVyLlNCTUFYX2wgPSAyMjtcbkVuY29kZXIuU0JNQVhfcyA9IDEzO1xuRW5jb2Rlci5QU0ZCMjEgPSA2O1xuRW5jb2Rlci5QU0ZCMTIgPSA2O1xuXG4vKipcbiAqIEZGVCBzaXplc1xuICovXG5FbmNvZGVyLkJMS1NJWkUgPSAxMDI0O1xuRW5jb2Rlci5IQkxLU0laRSA9IChFbmNvZGVyLkJMS1NJWkUgLyAyICsgMSk7XG5FbmNvZGVyLkJMS1NJWkVfcyA9IDI1NjtcbkVuY29kZXIuSEJMS1NJWkVfcyA9IChFbmNvZGVyLkJMS1NJWkVfcyAvIDIgKyAxKTtcblxuRW5jb2Rlci5OT1JNX1RZUEUgPSAwO1xuRW5jb2Rlci5TVEFSVF9UWVBFID0gMTtcbkVuY29kZXIuU0hPUlRfVFlQRSA9IDI7XG5FbmNvZGVyLlNUT1BfVFlQRSA9IDM7XG5cbi8qKlxuICogPFBSRT5cbiAqIE1vZGUgRXh0ZW50aW9uOlxuICogV2hlbiB3ZSBhcmUgaW4gc3RlcmVvIG1vZGUsIHRoZXJlIGFyZSA0IHBvc3NpYmxlIG1ldGhvZHMgdG8gc3RvcmUgdGhlc2VcbiAqIHR3byBjaGFubmVscy4gVGhlIHN0ZXJlbyBtb2RlcyAtbT8gYXJlIHVzaW5nIGEgc3Vic2V0IG9mIHRoZW0uXG4gKlxuICogIC1tczogTVBHX01EX0xSX0xSXG4gKiAgLW1qOiBNUEdfTURfTFJfTFIgYW5kIE1QR19NRF9NU19MUlxuICogIC1tZjogTVBHX01EX01TX0xSXG4gKiAgLW1pOiBhbGxcbiAqIDwvUFJFPlxuICovXG5FbmNvZGVyLk1QR19NRF9MUl9MUiA9IDA7XG5FbmNvZGVyLk1QR19NRF9MUl9JID0gMTtcbkVuY29kZXIuTVBHX01EX01TX0xSID0gMjtcbkVuY29kZXIuTVBHX01EX01TX0kgPSAzO1xuXG5FbmNvZGVyLmZpcmNvZWYgPSBbLTAuMDIwNzg4NyAqIDUsIC0wLjAzNzg0MTMgKiA1LFxuICAgIC0wLjA0MzI0NzIgKiA1LCAtMC4wMzExODMgKiA1LCA3Ljc5NjA5ZS0xOCAqIDUsIDAuMDQ2Nzc0NSAqIDUsXG4gICAgMC4xMDA5MSAqIDUsIDAuMTUxMzY1ICogNSwgMC4xODcwOTggKiA1XTtcblxuZnVuY3Rpb24gRW5jb2RlcigpIHtcblxuICAgIHZhciBGRlRPRkZTRVQgPSBFbmNvZGVyLkZGVE9GRlNFVDtcbiAgICB2YXIgTVBHX01EX01TX0xSID0gRW5jb2Rlci5NUEdfTURfTVNfTFI7XG4gICAgLy9CaXRTdHJlYW0gYnM7XG4gICAgLy9Qc3lNb2RlbCBwc3k7XG4gICAgLy9WQlJUYWcgdmJyO1xuICAgIC8vUXVhbnRpemVQVlQgcXVwdnQ7XG4gICAgdmFyIGJzID0gbnVsbDtcbiAgICB0aGlzLnBzeSA9IG51bGw7XG4gICAgdmFyIHBzeSA9IG51bGw7XG4gICAgdmFyIHZiciA9IG51bGw7XG4gICAgdmFyIHF1cHZ0ID0gbnVsbDtcblxuICAgIC8vcHVibGljIGZpbmFsIHZvaWQgc2V0TW9kdWxlcyhCaXRTdHJlYW0gYnMsIFBzeU1vZGVsIHBzeSwgUXVhbnRpemVQVlQgcXVwdnQsXG4gICAgLy8gICAgVkJSVGFnIHZicikge1xuICAgIHRoaXMuc2V0TW9kdWxlcyA9IGZ1bmN0aW9uIChfYnMsIF9wc3ksIF9xdXB2dCwgX3Zicikge1xuICAgICAgICBicyA9IF9icztcbiAgICAgICAgdGhpcy5wc3kgPSBfcHN5O1xuICAgICAgICBwc3kgPSBfcHN5O1xuICAgICAgICB2YnIgPSBfdmJyO1xuICAgICAgICBxdXB2dCA9IF9xdXB2dDtcbiAgICB9O1xuXG4gICAgdmFyIG5ld01EQ1QgPSBuZXcgTmV3TURDVCgpO1xuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICpcbiAgICAgKiBlbmNvZGVyIGFuZCBkZWNvZGVyIGRlbGF5c1xuICAgICAqXG4gICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgLyoqXG4gICAgICogPFBSRT5cbiAgICAgKiBsYXllciBJSUkgZW5jLT5kZWMgZGVsYXk6ICAxMDU2ICgxMDU3PykgICAob2JzZXJ2ZWQpXG4gICAgICogbGF5ZXIgIElJIGVuYy0+ZGVjIGRlbGF5OiAgIDQ4MCAgKDQ4MT8pICAgKG9ic2VydmVkKVxuICAgICAqXG4gICAgICogcG9seXBoYXNlIDI1Ni0xNiAgICAgICAgICAgICAoZGVjIG9yIGVuYykgICAgICAgID0gMjQwXG4gICAgICogbWRjdCAgICAgIDI1NiszMiAgKDkqMzIpICAgICAoZGVjIG9yIGVuYykgICAgICAgID0gMjg4XG4gICAgICogdG90YWw6ICAgIDUxMisxNlxuICAgICAqXG4gICAgICogTXkgZ3Vlc3MgaXMgdGhhdCBkZWxheSBvZiBwb2x5cGhhc2UgZmlsdGVyYmFuayBpcyBhY3R1YWx5IDI0MC41XG4gICAgICogKHRoZXJlIGFyZSB0ZWNobmljYWwgcmVhc29ucyBmb3IgdGhpcywgc2VlIHBvc3RpbmdzIGluIG1wM2VuY29kZXIpLlxuICAgICAqIFNvIHRvdGFsIEVuY29kZStEZWNvZGUgZGVsYXkgPSBFTkNERUxBWSArIDUyOCArIDFcbiAgICAgKiA8L1BSRT5cbiAgICAgKi9cblxuXG4gICAgLyoqXG4gICAgICogYXV0by1hZGp1c3Qgb2YgQVRILCB1c2VmdWwgZm9yIGxvdyB2b2x1bWUgR2FicmllbCBCb3V2aWduZSAzIGZlYiAyMDAxXG4gICAgICpcbiAgICAgKiBtb2RpZmllcyBzb21lIHZhbHVlcyBpbiBnZnAuaW50ZXJuYWxfZmxhZ3MuQVRIIChnZmMuQVRIKVxuICAgICAqL1xuLy9wcml2YXRlIHZvaWQgYWRqdXN0X0FUSChmaW5hbCBMYW1lSW50ZXJuYWxGbGFncyBnZmMpIHtcbiAgICBmdW5jdGlvbiBhZGp1c3RfQVRIKGdmYykge1xuICAgICAgICB2YXIgZ3IyX21heCwgbWF4X3BvdztcblxuICAgICAgICBpZiAoZ2ZjLkFUSC51c2VBZGp1c3QgPT0gMCkge1xuICAgICAgICAgICAgZ2ZjLkFUSC5hZGp1c3QgPSAxLjA7XG4gICAgICAgICAgICAvKiBubyBhZGp1c3RtZW50ICovXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvKiBqZCAtIDIwMDEgbWFyIDEyLCAyNywganVuIDMwICovXG4gICAgICAgIC8qIGxvdWRuZXNzIGJhc2VkIG9uIGVxdWFsIGxvdWRuZXNzIGN1cnZlOyAqL1xuICAgICAgICAvKiB1c2UgZ3JhbnVsZSB3aXRoIG1heGltdW0gY29tYmluZWQgbG91ZG5lc3MgKi9cbiAgICAgICAgbWF4X3BvdyA9IGdmYy5sb3VkbmVzc19zcVswXVswXTtcbiAgICAgICAgZ3IyX21heCA9IGdmYy5sb3VkbmVzc19zcVsxXVswXTtcbiAgICAgICAgaWYgKGdmYy5jaGFubmVsc19vdXQgPT0gMikge1xuICAgICAgICAgICAgbWF4X3BvdyArPSBnZmMubG91ZG5lc3Nfc3FbMF1bMV07XG4gICAgICAgICAgICBncjJfbWF4ICs9IGdmYy5sb3VkbmVzc19zcVsxXVsxXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1heF9wb3cgKz0gbWF4X3BvdztcbiAgICAgICAgICAgIGdyMl9tYXggKz0gZ3IyX21heDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZ2ZjLm1vZGVfZ3IgPT0gMikge1xuICAgICAgICAgICAgbWF4X3BvdyA9IE1hdGgubWF4KG1heF9wb3csIGdyMl9tYXgpO1xuICAgICAgICB9XG4gICAgICAgIG1heF9wb3cgKj0gMC41O1xuICAgICAgICAvKiBtYXhfcG93IGFwcHJvYWNoZXMgMS4wIGZvciBmdWxsIGJhbmQgbm9pc2UgKi9cblxuICAgICAgICAvKiBqZCAtIDIwMDEgbWFyIDMxLCBqdW4gMzAgKi9cbiAgICAgICAgLyogdXNlciB0dW5pbmcgb2YgQVRIIGFkanVzdG1lbnQgcmVnaW9uICovXG4gICAgICAgIG1heF9wb3cgKj0gZ2ZjLkFUSC5hYVNlbnNpdGl2aXR5UDtcblxuICAgICAgICAvKlxuICAgICAgICAgKiBhZGp1c3QgQVRIIGRlcGVuZGluZyBvbiByYW5nZSBvZiBtYXhpbXVtIHZhbHVlXG4gICAgICAgICAqL1xuXG4gICAgICAgIC8qIGpkIC0gMjAwMSBmZWIyNywgbWFyMTIsMjAsIGp1bjMwLCBqdWwyMiAqL1xuICAgICAgICAvKiBjb250aW51b3VzIGN1cnZlcyBiYXNlZCBvbiBhcHByb3hpbWF0aW9uICovXG4gICAgICAgIC8qIHRvIEdCJ3Mgb3JpZ2luYWwgdmFsdWVzLiAqL1xuICAgICAgICAvKiBGb3IgYW4gaW5jcmVhc2UgaW4gYXBwcm94aW1hdGUgbG91ZG5lc3MsICovXG4gICAgICAgIC8qIHNldCBBVEggYWRqdXN0IHRvIGFkanVzdF9saW1pdCBpbW1lZGlhdGVseSAqL1xuICAgICAgICAvKiBhZnRlciBhIGRlbGF5IG9mIG9uZSBmcmFtZS4gKi9cbiAgICAgICAgLyogRm9yIGEgbG91ZG5lc3MgZGVjcmVhc2UsIHJlZHVjZSBBVEggYWRqdXN0ICovXG4gICAgICAgIC8qIHRvd2FyZHMgYWRqdXN0X2xpbWl0IGdyYWR1YWxseS4gKi9cbiAgICAgICAgLyogbWF4X3BvdyBpcyBhIGxvdWRuZXNzIHNxdWFyZWQgb3IgYSBwb3dlci4gKi9cbiAgICAgICAgaWYgKG1heF9wb3cgPiAwLjAzMTI1KSB7IC8qICgoMSAtIDAuMDAwNjI1KS8gMzEuOTgpIGZyb20gY3VydmUgYmVsb3cgKi9cbiAgICAgICAgICAgIGlmIChnZmMuQVRILmFkanVzdCA+PSAxLjApIHtcbiAgICAgICAgICAgICAgICBnZmMuQVRILmFkanVzdCA9IDEuMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLyogcHJlY2VkaW5nIGZyYW1lIGhhcyBsb3dlciBBVEggYWRqdXN0OyAqL1xuICAgICAgICAgICAgICAgIC8qIGFzY2VuZCBvbmx5IHRvIHRoZSBwcmVjZWRpbmcgYWRqdXN0X2xpbWl0ICovXG4gICAgICAgICAgICAgICAgLyogaW4gY2FzZSB0aGVyZSBpcyBsZWFkaW5nIGxvdyB2b2x1bWUgKi9cbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLkFUSC5hZGp1c3QgPCBnZmMuQVRILmFkanVzdExpbWl0KSB7XG4gICAgICAgICAgICAgICAgICAgIGdmYy5BVEguYWRqdXN0ID0gZ2ZjLkFUSC5hZGp1c3RMaW1pdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMuQVRILmFkanVzdExpbWl0ID0gMS4wO1xuICAgICAgICB9IGVsc2UgeyAvKiBhZGp1c3RtZW50IGN1cnZlICovXG4gICAgICAgICAgICAvKiBhYm91dCAzMiBkQiBtYXhpbXVtIGFkanVzdCAoMC4wMDA2MjUpICovXG4gICAgICAgICAgICB2YXIgYWRqX2xpbV9uZXcgPSAzMS45OCAqIG1heF9wb3cgKyAwLjAwMDYyNTtcbiAgICAgICAgICAgIGlmIChnZmMuQVRILmFkanVzdCA+PSBhZGpfbGltX25ldykgeyAvKiBkZXNjZW5kIGdyYWR1YWxseSAqL1xuICAgICAgICAgICAgICAgIGdmYy5BVEguYWRqdXN0ICo9IGFkal9saW1fbmV3ICogMC4wNzUgKyAwLjkyNTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLkFUSC5hZGp1c3QgPCBhZGpfbGltX25ldykgeyAvKiBzdG9wIGRlc2NlbnQgKi9cbiAgICAgICAgICAgICAgICAgICAgZ2ZjLkFUSC5hZGp1c3QgPSBhZGpfbGltX25ldztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgeyAvKiBhc2NlbmQgKi9cbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLkFUSC5hZGp1c3RMaW1pdCA+PSBhZGpfbGltX25ldykge1xuICAgICAgICAgICAgICAgICAgICBnZmMuQVRILmFkanVzdCA9IGFkal9saW1fbmV3O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8qIHByZWNlZGluZyBmcmFtZSBoYXMgbG93ZXIgQVRIIGFkanVzdDsgKi9cbiAgICAgICAgICAgICAgICAgICAgLyogYXNjZW5kIG9ubHkgdG8gdGhlIHByZWNlZGluZyBhZGp1c3RfbGltaXQgKi9cbiAgICAgICAgICAgICAgICAgICAgaWYgKGdmYy5BVEguYWRqdXN0IDwgZ2ZjLkFUSC5hZGp1c3RMaW1pdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2ZjLkFUSC5hZGp1c3QgPSBnZmMuQVRILmFkanVzdExpbWl0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLkFUSC5hZGp1c3RMaW1pdCA9IGFkal9saW1fbmV3O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogPFBSRT5cbiAgICAgKiAgc29tZSBzaW1wbGUgc3RhdGlzdGljc1xuICAgICAqXG4gICAgICogIGJpdHJhdGUgaW5kZXggMDogZnJlZSBiaXRyYXRlIC4gbm90IGFsbG93ZWQgaW4gVkJSIG1vZGVcbiAgICAgKiAgOiBiaXRyYXRlcywga2JwcyBkZXBlbmRpbmcgb24gTVBFRyB2ZXJzaW9uXG4gICAgICogIGJpdHJhdGUgaW5kZXggMTU6IGZvcmJpZGRlblxuICAgICAqXG4gICAgICogIG1vZGVfZXh0OlxuICAgICAqICAwOiAgTFJcbiAgICAgKiAgMTogIExSLWlcbiAgICAgKiAgMjogIE1TXG4gICAgICogIDM6ICBNUy1pXG4gICAgICogPC9QUkU+XG4gICAgICovXG4gICAgZnVuY3Rpb24gdXBkYXRlU3RhdHMoZ2ZjKSB7XG4gICAgICAgIHZhciBnciwgY2g7XG5cbiAgICAgICAgLyogY291bnQgYml0cmF0ZSBpbmRpY2VzICovXG4gICAgICAgIGdmYy5iaXRyYXRlX3N0ZXJlb01vZGVfSGlzdFtnZmMuYml0cmF0ZV9pbmRleF1bNF0rKztcbiAgICAgICAgZ2ZjLmJpdHJhdGVfc3RlcmVvTW9kZV9IaXN0WzE1XVs0XSsrO1xuXG4gICAgICAgIC8qIGNvdW50ICdlbSBmb3IgZXZlcnkgbW9kZSBleHRlbnNpb24gaW4gY2FzZSBvZiAyIGNoYW5uZWwgZW5jb2RpbmcgKi9cbiAgICAgICAgaWYgKGdmYy5jaGFubmVsc19vdXQgPT0gMikge1xuICAgICAgICAgICAgZ2ZjLmJpdHJhdGVfc3RlcmVvTW9kZV9IaXN0W2dmYy5iaXRyYXRlX2luZGV4XVtnZmMubW9kZV9leHRdKys7XG4gICAgICAgICAgICBnZmMuYml0cmF0ZV9zdGVyZW9Nb2RlX0hpc3RbMTVdW2dmYy5tb2RlX2V4dF0rKztcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgKytncikge1xuICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgKytjaCkge1xuICAgICAgICAgICAgICAgIHZhciBidCA9IGdmYy5sM19zaWRlLnR0W2dyXVtjaF0uYmxvY2tfdHlwZSB8IDA7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5sM19zaWRlLnR0W2dyXVtjaF0ubWl4ZWRfYmxvY2tfZmxhZyAhPSAwKVxuICAgICAgICAgICAgICAgICAgICBidCA9IDQ7XG4gICAgICAgICAgICAgICAgZ2ZjLmJpdHJhdGVfYmxvY2tUeXBlX0hpc3RbZ2ZjLmJpdHJhdGVfaW5kZXhdW2J0XSsrO1xuICAgICAgICAgICAgICAgIGdmYy5iaXRyYXRlX2Jsb2NrVHlwZV9IaXN0W2dmYy5iaXRyYXRlX2luZGV4XVs1XSsrO1xuICAgICAgICAgICAgICAgIGdmYy5iaXRyYXRlX2Jsb2NrVHlwZV9IaXN0WzE1XVtidF0rKztcbiAgICAgICAgICAgICAgICBnZmMuYml0cmF0ZV9ibG9ja1R5cGVfSGlzdFsxNV1bNV0rKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxhbWVfZW5jb2RlX2ZyYW1lX2luaXQoZ2ZwLCBpbmJ1Zikge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXG4gICAgICAgIHZhciBjaCwgZ3I7XG5cbiAgICAgICAgaWYgKGdmYy5sYW1lX2VuY29kZV9mcmFtZV9pbml0ID09IDApIHtcbiAgICAgICAgICAgIC8qIHByaW1lIHRoZSBNRENUL3BvbHlwaGFzZSBmaWx0ZXJiYW5rIHdpdGggYSBzaG9ydCBibG9jayAqL1xuICAgICAgICAgICAgdmFyIGksIGo7XG4gICAgICAgICAgICB2YXIgcHJpbWVidWZmMCA9IG5ld19mbG9hdCgyODYgKyAxMTUyICsgNTc2KTtcbiAgICAgICAgICAgIHZhciBwcmltZWJ1ZmYxID0gbmV3X2Zsb2F0KDI4NiArIDExNTIgKyA1NzYpO1xuICAgICAgICAgICAgZ2ZjLmxhbWVfZW5jb2RlX2ZyYW1lX2luaXQgPSAxO1xuICAgICAgICAgICAgZm9yIChpID0gMCwgaiA9IDA7IGkgPCAyODYgKyA1NzYgKiAoMSArIGdmYy5tb2RlX2dyKTsgKytpKSB7XG4gICAgICAgICAgICAgICAgaWYgKGkgPCA1NzYgKiBnZmMubW9kZV9ncikge1xuICAgICAgICAgICAgICAgICAgICBwcmltZWJ1ZmYwW2ldID0gMDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdmYy5jaGFubmVsc19vdXQgPT0gMilcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW1lYnVmZjFbaV0gPSAwO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHByaW1lYnVmZjBbaV0gPSBpbmJ1ZlswXVtqXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdmYy5jaGFubmVsc19vdXQgPT0gMilcbiAgICAgICAgICAgICAgICAgICAgICAgIHByaW1lYnVmZjFbaV0gPSBpbmJ1ZlsxXVtqXTtcbiAgICAgICAgICAgICAgICAgICAgKytqO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIHBvbHlwaGFzZSBmaWx0ZXJpbmcgLyBtZGN0ICovXG4gICAgICAgICAgICBmb3IgKGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuICAgICAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLmwzX3NpZGUudHRbZ3JdW2NoXS5ibG9ja190eXBlID0gRW5jb2Rlci5TSE9SVF9UWVBFO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG5ld01EQ1QubWRjdF9zdWI0OChnZmMsIHByaW1lYnVmZjAsIHByaW1lYnVmZjEpO1xuXG4gICAgICAgICAgICAvKiBjaGVjayBGRlQgd2lsbCBub3QgdXNlIGEgbmVnYXRpdmUgc3RhcnRpbmcgb2Zmc2V0ICovXG4gICAgICAgICAgICAvKiBjaGVjayBpZiB3ZSBoYXZlIGVub3VnaCBkYXRhIGZvciBGRlQgKi9cbiAgICAgICAgICAgIC8qIGNoZWNrIGlmIHdlIGhhdmUgZW5vdWdoIGRhdGEgZm9yIHBvbHlwaGFzZSBmaWx0ZXJiYW5rICovXG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIDxQUkU+XG4gICAgICogZW5jb2RlZnJhbWUoKSAgICAgICAgICAgTGF5ZXIgM1xuICAgICAqXG4gICAgICogZW5jb2RlIGEgc2luZ2xlIGZyYW1lXG4gICAgICpcbiAgICAgKlxuICAgICAqICAgIGxhbWVfZW5jb2RlX2ZyYW1lKClcbiAgICAgKlxuICAgICAqXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgICBnciAwICAgICAgICAgICAgZ3IgMVxuICAgICAqICAgIGluYnVmOiAgICAgICAgICAgfC0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tfC0tLS0tLS0tLS0tLS0tfFxuICAgICAqXG4gICAgICpcbiAgICAgKiAgICBQb2x5cGhhc2UgKDE4IHdpbmRvd3MsIGVhY2ggc2hpZnRlZCAzMilcbiAgICAgKiAgICBnciAwOlxuICAgICAqICAgIHdpbmRvdzEgICAgICAgICAgPC0tLS01MTItLS0uXG4gICAgICogICAgd2luZG93MTggICAgICAgICAgICAgICAgIDwtLS0tNTEyLS0tLlxuICAgICAqXG4gICAgICogICAgZ3IgMTpcbiAgICAgKiAgICB3aW5kb3cxICAgICAgICAgICAgICAgICAgICAgICAgIDwtLS0tNTEyLS0tLlxuICAgICAqICAgIHdpbmRvdzE4ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA8LS0tLTUxMi0tLS5cbiAgICAgKlxuICAgICAqXG4gICAgICpcbiAgICAgKiAgICBNRENUIG91dHB1dDogIHwtLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLXwtLS0tLS0tLS0tLS0tLXxcbiAgICAgKlxuICAgICAqICAgIEZGVCdzICAgICAgICAgICAgICAgICAgICA8LS0tLS0tLS0tMTAyNC0tLS0tLS0tLS5cbiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwtLS0tLS0tLS0xMDI0LS0tLS0tLS5cbiAgICAgKlxuICAgICAqXG4gICAgICpcbiAgICAgKiAgICAgICAgaW5idWYgPSBidWZmZXIgb2YgUENNIGRhdGEgc2l6ZT1NUDMgZnJhbWVzaXplXG4gICAgICogICAgICAgIGVuY29kZXIgYWN0cyBvbiBpbmJ1ZltjaF1bMF0sIGJ1dCBvdXRwdXQgaXMgZGVsYXllZCBieSBNRENUREVMQVlcbiAgICAgKiAgICAgICAgc28gdGhlIE1EQ1QgY29lZmZpY2ludHMgYXJlIGZyb20gaW5idWZbY2hdWy1NRENUREVMQVldXG4gICAgICpcbiAgICAgKiAgICAgICAgcHN5LW1vZGVsIEZGVCBoYXMgYSAxIGdyYW51bGUgZGVsYXksIHNvIHdlIGZlZWQgaXQgZGF0YSBmb3IgdGhlXG4gICAgICogICAgICAgIG5leHQgZ3JhbnVsZS5cbiAgICAgKiAgICAgICAgRkZUIGlzIGNlbnRlcmVkIG92ZXIgZ3JhbnVsZTogIDIyNCs1NzYrMjI0XG4gICAgICogICAgICAgIFNvIEZGVCBzdGFydHMgYXQ6ICAgNTc2LTIyNC1NRENUREVMQVlcbiAgICAgKlxuICAgICAqICAgICAgICBNUEVHMjogIEZGVCBlbmRzIGF0OiAgQkxLU0laRSs1NzYtMjI0LU1EQ1RERUxBWSAgICAgICgxMzI4KVxuICAgICAqICAgICAgICBNUEVHMTogIEZGVCBlbmRzIGF0OiAgQkxLU0laRSsyKjU3Ni0yMjQtTURDVERFTEFZICAgICgxOTA0KVxuICAgICAqXG4gICAgICogICAgICAgIE1QRUcyOiAgcG9seXBoYXNlIGZpcnN0IHdpbmRvdzogIFswLi41MTFdXG4gICAgICogICAgICAgICAgICAgICAgICAgICAgICAgIDE4dGggd2luZG93OiAgIFs1NDQuLjEwNTVdICAgICAgICAgICgxMDU2KVxuICAgICAqICAgICAgICBNUEVHMTogICAgICAgICAgICAzNnRoIHdpbmRvdzogICBbMTEyMC4uMTYzMV0gICAgICAgICAoMTYzMilcbiAgICAgKiAgICAgICAgICAgICAgICBkYXRhIG5lZWRlZDogIDUxMitmcmFtZXNpemUtMzJcbiAgICAgKlxuICAgICAqICAgICAgICBBIGNsb3NlIGxvb2sgbmV3bWRjdC5jIHNob3dzIHRoYXQgdGhlIHBvbHlwaGFzZSBmaWx0ZXJiYW5rXG4gICAgICogICAgICAgIG9ubHkgdXNlcyBkYXRhIGZyb20gWzAuLjUxMF0gZm9yIGVhY2ggd2luZG93LiAgUGVyaGFwcyBiZWNhdXNlIHRoZSB3aW5kb3dcbiAgICAgKiAgICAgICAgdXNlZCBieSB0aGUgZmlsdGVyYmFuayBpcyB6ZXJvIGZvciB0aGUgbGFzdCBwb2ludCwgc28gVGFrZWhpcm8nc1xuICAgICAqICAgICAgICBjb2RlIGRvZXNuJ3QgYm90aGVyIHRvIGNvbXB1dGUgd2l0aCBpdC5cbiAgICAgKlxuICAgICAqICAgICAgICBGRlQgc3RhcnRzIGF0IDU3Ni0yMjQtTURDVERFTEFZICgzMDQpICA9IDU3Ni1GRlRPRkZTRVRcbiAgICAgKlxuICAgICAqIDwvUFJFPlxuICAgICAqL1xuXG5cbiAgICB0aGlzLmxhbWVfZW5jb2RlX21wM19mcmFtZSA9IGZ1bmN0aW9uIChnZnAsIGluYnVmX2wsIGluYnVmX3IsIG1wM2J1ZiwgbXAzYnVmUG9zLCBtcDNidWZfc2l6ZSkge1xuICAgICAgICB2YXIgbXAzY291bnQ7XG4gICAgICAgIHZhciBtYXNraW5nX0xSID0gbmV3X2FycmF5X24oWzIsIDJdKTtcbiAgICAgICAgLypcbiAgICAgICAgICogTFIgbWFza2luZyAmXG4gICAgICAgICAqIGVuZXJneVxuICAgICAgICAgKi9cbiAgICAgICAgbWFza2luZ19MUlswXVswXSA9IG5ldyBJSUlfcHN5X3JhdGlvKCk7XG4gICAgICAgIG1hc2tpbmdfTFJbMF1bMV0gPSBuZXcgSUlJX3BzeV9yYXRpbygpO1xuICAgICAgICBtYXNraW5nX0xSWzFdWzBdID0gbmV3IElJSV9wc3lfcmF0aW8oKTtcbiAgICAgICAgbWFza2luZ19MUlsxXVsxXSA9IG5ldyBJSUlfcHN5X3JhdGlvKCk7XG4gICAgICAgIHZhciBtYXNraW5nX01TID0gbmV3X2FycmF5X24oWzIsIDJdKTtcbiAgICAgICAgLyogTVMgbWFza2luZyAmIGVuZXJneSAqL1xuICAgICAgICBtYXNraW5nX01TWzBdWzBdID0gbmV3IElJSV9wc3lfcmF0aW8oKTtcbiAgICAgICAgbWFza2luZ19NU1swXVsxXSA9IG5ldyBJSUlfcHN5X3JhdGlvKCk7XG4gICAgICAgIG1hc2tpbmdfTVNbMV1bMF0gPSBuZXcgSUlJX3BzeV9yYXRpbygpO1xuICAgICAgICBtYXNraW5nX01TWzFdWzFdID0gbmV3IElJSV9wc3lfcmF0aW8oKTtcbiAgICAgICAgLy9JSUlfcHN5X3JhdGlvIG1hc2tpbmdbXVtdO1xuICAgICAgICB2YXIgbWFza2luZztcbiAgICAgICAgLyogcG9pbnRlciB0byBzZWxlY3RlZCBtYXNraW5ncyAqL1xuICAgICAgICB2YXIgaW5idWYgPSBbbnVsbCwgbnVsbF07XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cbiAgICAgICAgdmFyIHRvdF9lbmVyID0gbmV3X2Zsb2F0X24oWzIsIDRdKTtcbiAgICAgICAgdmFyIG1zX2VuZXJfcmF0aW8gPSBbLjUsIC41XTtcbiAgICAgICAgdmFyIHBlID0gW1swLiwgMC5dLCBbMC4sIDAuXV07XG4gICAgICAgIHZhciBwZV9NUyA9IFtbMC4sIDAuXSwgWzAuLCAwLl1dO1xuXG4vL2Zsb2F0W11bXSBwZV91c2U7XG4gICAgICAgIHZhciBwZV91c2U7XG5cbiAgICAgICAgdmFyIGNoLCBncjtcblxuICAgICAgICBpbmJ1ZlswXSA9IGluYnVmX2w7XG4gICAgICAgIGluYnVmWzFdID0gaW5idWZfcjtcblxuICAgICAgICBpZiAoZ2ZjLmxhbWVfZW5jb2RlX2ZyYW1lX2luaXQgPT0gMCkge1xuICAgICAgICAgICAgLyogZmlyc3QgcnVuPyAqL1xuICAgICAgICAgICAgbGFtZV9lbmNvZGVfZnJhbWVfaW5pdChnZnAsIGluYnVmKTtcblxuICAgICAgICB9XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKiogcGFkZGluZyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgLyoqXG4gICAgICAgICAqIDxQUkU+XG4gICAgICAgICAqIHBhZGRpbmcgbWV0aG9kIGFzIGRlc2NyaWJlZCBpblxuICAgICAgICAgKiBcIk1QRUctTGF5ZXIzIC8gQml0c3RyZWFtIFN5bnRheCBhbmQgRGVjb2RpbmdcIlxuICAgICAgICAgKiBieSBNYXJ0aW4gU2llbGVyLCBSYWxwaCBTcGVyc2NobmVpZGVyXG4gICAgICAgICAqXG4gICAgICAgICAqIG5vdGU6IHRoZXJlIGlzIG5vIHBhZGRpbmcgZm9yIHRoZSB2ZXJ5IGZpcnN0IGZyYW1lXG4gICAgICAgICAqXG4gICAgICAgICAqIFJvYmVydCBIZWdlbWFubiAyMDAwLTA2LTIyXG4gICAgICAgICAqIDwvUFJFPlxuICAgICAgICAgKi9cbiAgICAgICAgZ2ZjLnBhZGRpbmcgPSAwO1xuICAgICAgICBpZiAoKGdmYy5zbG90X2xhZyAtPSBnZmMuZnJhY19TcEYpIDwgMCkge1xuICAgICAgICAgICAgZ2ZjLnNsb3RfbGFnICs9IGdmcC5vdXRfc2FtcGxlcmF0ZTtcbiAgICAgICAgICAgIGdmYy5wYWRkaW5nID0gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIFN0YWdlIDE6IHBzeWNob2Fjb3VzdGljIG1vZGVsICpcbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgaWYgKGdmYy5wc3ltb2RlbCAhPSAwKSB7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogcHN5Y2hvYWNvdXN0aWMgbW9kZWwgcHN5IG1vZGVsIGhhcyBhIDEgZ3JhbnVsZSAoNTc2KSBkZWxheSB0aGF0XG4gICAgICAgICAgICAgKiB3ZSBtdXN0IGNvbXBlbnNhdGUgZm9yIChtdCA2Lzk5KS5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgdmFyIHJldDtcbiAgICAgICAgICAgIHZhciBidWZwID0gW251bGwsIG51bGxdO1xuICAgICAgICAgICAgLyogYWRkcmVzcyBvZiBiZWdpbm5pbmcgb2YgbGVmdCAmIHJpZ2h0IGdyYW51bGUgKi9cbiAgICAgICAgICAgIHZhciBidWZwUG9zID0gMDtcbiAgICAgICAgICAgIC8qIGFkZHJlc3Mgb2YgYmVnaW5uaW5nIG9mIGxlZnQgJiByaWdodCBncmFudWxlICovXG4gICAgICAgICAgICB2YXIgYmxvY2t0eXBlID0gbmV3X2ludCgyKTtcblxuICAgICAgICAgICAgZm9yIChnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcblxuICAgICAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICAgICAgYnVmcFtjaF0gPSBpbmJ1ZltjaF07XG4gICAgICAgICAgICAgICAgICAgIGJ1ZnBQb3MgPSA1NzYgKyBnciAqIDU3NiAtIEVuY29kZXIuRkZUT0ZGU0VUO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9tdHJoIHx8IGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfbXQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0ID0gcHN5LkwzcHN5Y2hvX2FuYWxfdmJyKGdmcCwgYnVmcCwgYnVmcFBvcywgZ3IsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXNraW5nX0xSLCBtYXNraW5nX01TLCBwZVtncl0sIHBlX01TW2dyXSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRvdF9lbmVyW2dyXSwgYmxvY2t0eXBlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXQgPSBwc3kuTDNwc3ljaG9fYW5hbF9ucyhnZnAsIGJ1ZnAsIGJ1ZnBQb3MsIGdyLFxuICAgICAgICAgICAgICAgICAgICAgICAgbWFza2luZ19MUiwgbWFza2luZ19NUywgcGVbZ3JdLCBwZV9NU1tncl0sXG4gICAgICAgICAgICAgICAgICAgICAgICB0b3RfZW5lcltncl0sIGJsb2NrdHlwZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChyZXQgIT0gMClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC00O1xuXG4gICAgICAgICAgICAgICAgaWYgKGdmcC5tb2RlID09IE1QRUdNb2RlLkpPSU5UX1NURVJFTykge1xuICAgICAgICAgICAgICAgICAgICBtc19lbmVyX3JhdGlvW2dyXSA9IHRvdF9lbmVyW2dyXVsyXSArIHRvdF9lbmVyW2dyXVszXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG1zX2VuZXJfcmF0aW9bZ3JdID4gMClcbiAgICAgICAgICAgICAgICAgICAgICAgIG1zX2VuZXJfcmF0aW9bZ3JdID0gdG90X2VuZXJbZ3JdWzNdIC8gbXNfZW5lcl9yYXRpb1tncl07XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLyogYmxvY2sgdHlwZSBmbGFncyAqL1xuICAgICAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvZF9pbmZvID0gZ2ZjLmwzX3NpZGUudHRbZ3JdW2NoXTtcbiAgICAgICAgICAgICAgICAgICAgY29kX2luZm8uYmxvY2tfdHlwZSA9IGJsb2NrdHlwZVtjaF07XG4gICAgICAgICAgICAgICAgICAgIGNvZF9pbmZvLm1peGVkX2Jsb2NrX2ZsYWcgPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8qIG5vIHBzeSBtb2RlbCAqL1xuICAgICAgICAgICAgZm9yIChnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspXG4gICAgICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgICAgICBnZmMubDNfc2lkZS50dFtncl1bY2hdLmJsb2NrX3R5cGUgPSBFbmNvZGVyLk5PUk1fVFlQRTtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLmwzX3NpZGUudHRbZ3JdW2NoXS5taXhlZF9ibG9ja19mbGFnID0gMDtcbiAgICAgICAgICAgICAgICAgICAgcGVfTVNbZ3JdW2NoXSA9IHBlW2dyXVtjaF0gPSA3MDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogYXV0by1hZGp1c3Qgb2YgQVRILCB1c2VmdWwgZm9yIGxvdyB2b2x1bWUgKi9cbiAgICAgICAgYWRqdXN0X0FUSChnZmMpO1xuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIFN0YWdlIDI6IE1EQ1QgKlxuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiBwb2x5cGhhc2UgZmlsdGVyaW5nIC8gbWRjdCAqL1xuICAgICAgICBuZXdNRENULm1kY3Rfc3ViNDgoZ2ZjLCBpbmJ1ZlswXSwgaW5idWZbMV0pO1xuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIFN0YWdlIDM6IE1TL0xSIGRlY2lzaW9uICpcbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgICAgICAgLyogSGVyZSB3aWxsIGJlIHNlbGVjdGVkIE1TIG9yIExSIGNvZGluZyBvZiB0aGUgMiBzdGVyZW8gY2hhbm5lbHMgKi9cbiAgICAgICAgZ2ZjLm1vZGVfZXh0ID0gRW5jb2Rlci5NUEdfTURfTFJfTFI7XG5cbiAgICAgICAgaWYgKGdmcC5mb3JjZV9tcykge1xuICAgICAgICAgICAgZ2ZjLm1vZGVfZXh0ID0gRW5jb2Rlci5NUEdfTURfTVNfTFI7XG4gICAgICAgIH0gZWxzZSBpZiAoZ2ZwLm1vZGUgPT0gTVBFR01vZGUuSk9JTlRfU1RFUkVPKSB7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogbXNfcmF0aW8gPSBpcyBzY2FsZWQsIGZvciBoaXN0b3JpY2FsIHJlYXNvbnMsIHRvIGxvb2sgbGlrZSBhXG4gICAgICAgICAgICAgKiByYXRpbyBvZiBzaWRlX2NoYW5uZWwgLyB0b3RhbC4gMCA9IHNpZ25hbCBpcyAxMDAlIG1vbm8gLjUgPSBMICYgUlxuICAgICAgICAgICAgICogdW5jb3JyZWxhdGVkXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiA8UFJFPlxuICAgICAgICAgICAgICogWzBdIGFuZCBbMV0gYXJlIHRoZSByZXN1bHRzIGZvciB0aGUgdHdvIGdyYW51bGVzIGluIE1QRUctMSxcbiAgICAgICAgICAgICAqIGluIE1QRUctMiBpdCdzIG9ubHkgYSBmYWtlZCBhdmVyYWdpbmcgb2YgdGhlIHNhbWUgdmFsdWVcbiAgICAgICAgICAgICAqIF9wcmV2IGlzIHRoZSB2YWx1ZSBvZiB0aGUgbGFzdCBncmFudWxlIG9mIHRoZSBwcmV2aW91cyBmcmFtZVxuICAgICAgICAgICAgICogX25leHQgaXMgdGhlIHZhbHVlIG9mIHRoZSBmaXJzdCBncmFudWxlIG9mIHRoZSBuZXh0IGZyYW1lXG4gICAgICAgICAgICAgKiA8L1BSRT5cbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICB2YXIgc3VtX3BlX01TID0gMC47XG4gICAgICAgICAgICB2YXIgc3VtX3BlX0xSID0gMC47XG4gICAgICAgICAgICBmb3IgKGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuICAgICAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICAgICAgc3VtX3BlX01TICs9IHBlX01TW2dyXVtjaF07XG4gICAgICAgICAgICAgICAgICAgIHN1bV9wZV9MUiArPSBwZVtncl1bY2hdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyogYmFzZWQgb24gUEU6IE0vUyBjb2Rpbmcgd291bGQgbm90IHVzZSBtdWNoIG1vcmUgYml0cyB0aGFuIEwvUiAqL1xuICAgICAgICAgICAgaWYgKHN1bV9wZV9NUyA8PSAxLjAwICogc3VtX3BlX0xSKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgZ2kwID0gZ2ZjLmwzX3NpZGUudHRbMF07XG4gICAgICAgICAgICAgICAgdmFyIGdpMSA9IGdmYy5sM19zaWRlLnR0W2dmYy5tb2RlX2dyIC0gMV07XG5cbiAgICAgICAgICAgICAgICBpZiAoZ2kwWzBdLmJsb2NrX3R5cGUgPT0gZ2kwWzFdLmJsb2NrX3R5cGVcbiAgICAgICAgICAgICAgICAgICAgJiYgZ2kxWzBdLmJsb2NrX3R5cGUgPT0gZ2kxWzFdLmJsb2NrX3R5cGUpIHtcblxuICAgICAgICAgICAgICAgICAgICBnZmMubW9kZV9leHQgPSBFbmNvZGVyLk1QR19NRF9NU19MUjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBiaXQgYW5kIG5vaXNlIGFsbG9jYXRpb24gKi9cbiAgICAgICAgaWYgKGdmYy5tb2RlX2V4dCA9PSBNUEdfTURfTVNfTFIpIHtcbiAgICAgICAgICAgIG1hc2tpbmcgPSBtYXNraW5nX01TO1xuICAgICAgICAgICAgLyogdXNlIE1TIG1hc2tpbmcgKi9cbiAgICAgICAgICAgIHBlX3VzZSA9IHBlX01TO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbWFza2luZyA9IG1hc2tpbmdfTFI7XG4gICAgICAgICAgICAvKiB1c2UgTFIgbWFza2luZyAqL1xuICAgICAgICAgICAgcGVfdXNlID0gcGU7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBjb3B5IGRhdGEgZm9yIE1QMyBmcmFtZSBhbmFseXplciAqL1xuICAgICAgICBpZiAoZ2ZwLmFuYWx5c2lzICYmIGdmYy5waW5mbyAhPSBudWxsKSB7XG4gICAgICAgICAgICBmb3IgKGdyID0gMDsgZ3IgPCBnZmMubW9kZV9ncjsgZ3IrKykge1xuICAgICAgICAgICAgICAgIGZvciAoY2ggPSAwOyBjaCA8IGdmYy5jaGFubmVsc19vdXQ7IGNoKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLm1zX3JhdGlvW2dyXSA9IGdmYy5tc19yYXRpb1tncl07XG4gICAgICAgICAgICAgICAgICAgIGdmYy5waW5mby5tc19lbmVyX3JhdGlvW2dyXSA9IG1zX2VuZXJfcmF0aW9bZ3JdO1xuICAgICAgICAgICAgICAgICAgICBnZmMucGluZm8uYmxvY2t0eXBlW2dyXVtjaF0gPSBnZmMubDNfc2lkZS50dFtncl1bY2hdLmJsb2NrX3R5cGU7XG4gICAgICAgICAgICAgICAgICAgIGdmYy5waW5mby5wZVtncl1bY2hdID0gcGVfdXNlW2dyXVtjaF07XG4gICAgICAgICAgICAgICAgICAgIFN5c3RlbS5hcnJheWNvcHkoZ2ZjLmwzX3NpZGUudHRbZ3JdW2NoXS54ciwgMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGdmYy5waW5mby54cltncl1bY2hdLCAwLCA1NzYpO1xuICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgKiBpbiBwc3ltb2RlbCwgTFIgYW5kIE1TIGRhdGEgd2FzIHN0b3JlZCBpbiBwaW5mby4gc3dpdGNoXG4gICAgICAgICAgICAgICAgICAgICAqIHRvIE1TIGRhdGE6XG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICBpZiAoZ2ZjLm1vZGVfZXh0ID09IE1QR19NRF9NU19MUikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLmVyc1tncl1bY2hdID0gZ2ZjLnBpbmZvLmVyc1tncl1bY2ggKyAyXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFN5c3RlbS5hcnJheWNvcHkoZ2ZjLnBpbmZvLmVuZXJneVtncl1bY2ggKyAyXSwgMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZmMucGluZm8uZW5lcmd5W2dyXVtjaF0sIDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLmVuZXJneVtncl1bY2hdLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBTdGFnZSA0OiBxdWFudGl6YXRpb24gbG9vcCAqXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgICAgIGlmIChnZnAuVkJSID09IFZick1vZGUudmJyX29mZiB8fCBnZnAuVkJSID09IFZick1vZGUudmJyX2Ficikge1xuXG4gICAgICAgICAgICB2YXIgaTtcbiAgICAgICAgICAgIHZhciBmO1xuXG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMTg7IGkrKylcbiAgICAgICAgICAgICAgICBnZmMubnNQc3kucGVmaXJidWZbaV0gPSBnZmMubnNQc3kucGVmaXJidWZbaSArIDFdO1xuXG4gICAgICAgICAgICBmID0gMC4wO1xuICAgICAgICAgICAgZm9yIChnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspXG4gICAgICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKylcbiAgICAgICAgICAgICAgICAgICAgZiArPSBwZV91c2VbZ3JdW2NoXTtcbiAgICAgICAgICAgIGdmYy5uc1BzeS5wZWZpcmJ1ZlsxOF0gPSBmO1xuXG4gICAgICAgICAgICBmID0gZ2ZjLm5zUHN5LnBlZmlyYnVmWzldO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDk7IGkrKylcbiAgICAgICAgICAgICAgICBmICs9IChnZmMubnNQc3kucGVmaXJidWZbaV0gKyBnZmMubnNQc3kucGVmaXJidWZbMTggLSBpXSlcbiAgICAgICAgICAgICAgICAgICAgKiBFbmNvZGVyLmZpcmNvZWZbaV07XG5cbiAgICAgICAgICAgIGYgPSAoNjcwICogNSAqIGdmYy5tb2RlX2dyICogZ2ZjLmNoYW5uZWxzX291dCkgLyBmO1xuICAgICAgICAgICAgZm9yIChnciA9IDA7IGdyIDwgZ2ZjLm1vZGVfZ3I7IGdyKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHBlX3VzZVtncl1bY2hdICo9IGY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGdmYy5pdGVyYXRpb25fbG9vcC5pdGVyYXRpb25fbG9vcChnZnAsIHBlX3VzZSwgbXNfZW5lcl9yYXRpbywgbWFza2luZyk7XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogU3RhZ2UgNTogYml0c3RyZWFtIGZvcm1hdHRpbmcgKlxuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICAvKiB3cml0ZSB0aGUgZnJhbWUgdG8gdGhlIGJpdHN0cmVhbSAqL1xuICAgICAgICBicy5mb3JtYXRfYml0c3RyZWFtKGdmcCk7XG5cbiAgICAgICAgLyogY29weSBtcDMgYml0IGJ1ZmZlciBpbnRvIGFycmF5ICovXG4gICAgICAgIG1wM2NvdW50ID0gYnMuY29weV9idWZmZXIoZ2ZjLCBtcDNidWYsIG1wM2J1ZlBvcywgbXAzYnVmX3NpemUsIDEpO1xuXG4gICAgICAgIGlmIChnZnAuYldyaXRlVmJyVGFnKVxuICAgICAgICAgICAgdmJyLmFkZFZickZyYW1lKGdmcCk7XG5cbiAgICAgICAgaWYgKGdmcC5hbmFseXNpcyAmJiBnZmMucGluZm8gIT0gbnVsbCkge1xuICAgICAgICAgICAgZm9yIChjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgIHZhciBqO1xuICAgICAgICAgICAgICAgIGZvciAoaiA9IDA7IGogPCBGRlRPRkZTRVQ7IGorKylcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLnBjbWRhdGFbY2hdW2pdID0gZ2ZjLnBpbmZvLnBjbWRhdGFbY2hdW2pcbiAgICAgICAgICAgICAgICAgICAgKyBnZnAuZnJhbWVzaXplXTtcbiAgICAgICAgICAgICAgICBmb3IgKGogPSBGRlRPRkZTRVQ7IGogPCAxNjAwOyBqKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLnBjbWRhdGFbY2hdW2pdID0gaW5idWZbY2hdW2ogLSBGRlRPRkZTRVRdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHF1cHZ0LnNldF9mcmFtZV9waW5mbyhnZnAsIG1hc2tpbmcpO1xuICAgICAgICB9XG5cbiAgICAgICAgdXBkYXRlU3RhdHMoZ2ZjKTtcblxuICAgICAgICByZXR1cm4gbXAzY291bnQ7XG4gICAgfVxufVxuXG5cbi8vcGFja2FnZSBtcDM7XG5cbmZ1bmN0aW9uIFZCUlNlZWtJbmZvKCkge1xuICAgIC8qKlxuICAgICAqIFdoYXQgd2UgaGF2ZSBzZWVuIHNvIGZhci5cbiAgICAgKi9cbiAgICB0aGlzLnN1bSA9IDA7XG4gICAgLyoqXG4gICAgICogSG93IG1hbnkgZnJhbWVzIHdlIGhhdmUgc2VlbiBpbiB0aGlzIGNodW5rLlxuICAgICAqL1xuICAgIHRoaXMuc2VlbiA9IDA7XG4gICAgLyoqXG4gICAgICogSG93IG1hbnkgZnJhbWVzIHdlIHdhbnQgdG8gY29sbGVjdCBpbnRvIG9uZSBjaHVuay5cbiAgICAgKi9cbiAgICB0aGlzLndhbnQgPSAwO1xuICAgIC8qKlxuICAgICAqIEFjdHVhbCBwb3NpdGlvbiBpbiBvdXIgYmFnLlxuICAgICAqL1xuICAgIHRoaXMucG9zID0gMDtcbiAgICAvKipcbiAgICAgKiBTaXplIG9mIG91ciBiYWcuXG4gICAgICovXG4gICAgdGhpcy5zaXplID0gMDtcbiAgICAvKipcbiAgICAgKiBQb2ludGVyIHRvIG91ciBiYWcuXG4gICAgICovXG4gICAgdGhpcy5iYWcgPSBudWxsO1xuICAgIHRoaXMublZick51bUZyYW1lcyA9IDA7XG4gICAgdGhpcy5uQnl0ZXNXcml0dGVuID0gMDtcbiAgICAvKiBWQlIgdGFnIGRhdGEgKi9cbiAgICB0aGlzLlRvdGFsRnJhbWVTaXplID0gMDtcbn1cblxuXG5cbmZ1bmN0aW9uIElJSVNpZGVJbmZvKCkge1xuICAgIHRoaXMudHQgPSBbW251bGwsIG51bGxdLCBbbnVsbCwgbnVsbF1dO1xuICAgIHRoaXMubWFpbl9kYXRhX2JlZ2luID0gMDtcbiAgICB0aGlzLnByaXZhdGVfYml0cyA9IDA7XG4gICAgdGhpcy5yZXN2RHJhaW5fcHJlID0gMDtcbiAgICB0aGlzLnJlc3ZEcmFpbl9wb3N0ID0gMDtcbiAgICB0aGlzLnNjZnNpID0gW25ld19pbnQoNCksIG5ld19pbnQoNCldO1xuXG4gICAgZm9yICh2YXIgZ3IgPSAwOyBnciA8IDI7IGdyKyspIHtcbiAgICAgICAgZm9yICh2YXIgY2ggPSAwOyBjaCA8IDI7IGNoKyspIHtcbiAgICAgICAgICAgIHRoaXMudHRbZ3JdW2NoXSA9IG5ldyBHckluZm8oKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuXG5mdW5jdGlvbiBJSUlfcHN5X3htaW4oKSB7XG4gICAgdGhpcy5sID0gbmV3X2Zsb2F0KEVuY29kZXIuU0JNQVhfbCk7XG4gICAgdGhpcy5zID0gbmV3X2Zsb2F0X24oW0VuY29kZXIuU0JNQVhfcywgM10pO1xuXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuYXNzaWduID0gZnVuY3Rpb24gKGlpaV9wc3lfeG1pbikge1xuICAgICAgICBTeXN0ZW0uYXJyYXljb3B5KGlpaV9wc3lfeG1pbi5sLCAwLCBzZWxmLmwsIDAsIEVuY29kZXIuU0JNQVhfbCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgRW5jb2Rlci5TQk1BWF9zOyBpKyspIHtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgMzsgaisrKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5zW2ldW2pdID0gaWlpX3BzeV94bWluLnNbaV1bal07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG5cblxuXG4vL3BhY2thZ2UgbXAzO1xuXG4vKipcbiAqIFZhcmlhYmxlcyB1c2VkIGZvciAtLW5zcHN5dHVuZVxuICpcbiAqIEBhdXRob3IgS2VuXG4gKlxuICovXG5mdW5jdGlvbiBOc1BzeSgpIHtcbiAgICB0aGlzLmxhc3RfZW5fc3Vic2hvcnQgPSBuZXdfZmxvYXRfbihbNCwgOV0pO1xuICAgIHRoaXMubGFzdEF0dGFja3MgPSBuZXdfaW50KDQpO1xuICAgIHRoaXMucGVmaXJidWYgPSBuZXdfZmxvYXQoMTkpO1xuICAgIHRoaXMubG9uZ2ZhY3QgPSBuZXdfZmxvYXQoRW5jb2Rlci5TQk1BWF9sKTtcbiAgICB0aGlzLnNob3J0ZmFjdCA9IG5ld19mbG9hdChFbmNvZGVyLlNCTUFYX3MpO1xuXG4gICAgLyoqXG4gICAgICogc2hvcnQgYmxvY2sgdHVuaW5nXG4gICAgICovXG4gICAgdGhpcy5hdHRhY2t0aHJlID0gMC47XG4gICAgdGhpcy5hdHRhY2t0aHJlX3MgPSAwLjtcbn1cblxuXG5cblxuTGFtZUludGVybmFsRmxhZ3MuTUZTSVpFID0gKDMgKiAxMTUyICsgRW5jb2Rlci5FTkNERUxBWSAtIEVuY29kZXIuTURDVERFTEFZKTtcbkxhbWVJbnRlcm5hbEZsYWdzLk1BWF9IRUFERVJfQlVGID0gMjU2O1xuTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0NIQU5ORUwgPSA0MDk1O1xuTGFtZUludGVybmFsRmxhZ3MuTUFYX0JJVFNfUEVSX0dSQU5VTEUgPSA3NjgwO1xuTGFtZUludGVybmFsRmxhZ3MuQlBDID0gMzIwO1xuXG5mdW5jdGlvbiBMYW1lSW50ZXJuYWxGbGFncygpIHtcbiAgICB2YXIgTUFYX0hFQURFUl9MRU4gPSA0MDtcblxuXG4gICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICogaW50ZXJuYWwgdmFyaWFibGVzIE5PVCBzZXQgYnkgY2FsbGluZyBwcm9ncmFtLCBhbmQgc2hvdWxkIG5vdCBiZSAqXG4gICAgICogbW9kaWZpZWQgYnkgdGhlIGNhbGxpbmcgcHJvZ3JhbSAqXG4gICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuXG4gICAgLyoqXG4gICAgICogU29tZSByZW1hcmtzIHRvIHRoZSBDbGFzc19JRCBmaWVsZDogVGhlIENsYXNzIElEIGlzIGFuIElkZW50aWZpZXIgZm9yIGFcbiAgICAgKiBwb2ludGVyIHRvIHRoaXMgc3RydWN0LiBJdCBpcyB2ZXJ5IHVubGlrZWx5IHRoYXQgYSBwb2ludGVyIHRvXG4gICAgICogbGFtZV9nbG9iYWxfZmxhZ3MgaGFzIHRoZSBzYW1lIDMyIGJpdHMgaW4gaXQncyBzdHJ1Y3R1cmUgKGxhcmdlIGFuZCBvdGhlclxuICAgICAqIHNwZWNpYWwgcHJvcGVydGllcywgZm9yIGluc3RhbmNlIHByaW1lKS5cbiAgICAgKlxuICAgICAqIFRvIHRlc3QgdGhhdCB0aGUgc3RydWN0dXJlIGlzIHJpZ2h0IGFuZCBpbml0aWFsaXplZCwgdXNlOiBpZiAoIGdmYyAuXG4gICAgICogQ2xhc3NfSUQgPT0gTEFNRV9JRCApIC4uLiBPdGhlciByZW1hcms6IElmIHlvdSBzZXQgYSBmbGFnIHRvIDAgZm9yIHVuaW5pdFxuICAgICAqIGRhdGEgYW5kIDEgZm9yIGluaXQgZGF0YSwgdGhlIHJpZ2h0IHRlc3Qgc2hvdWxkIGJlIFwiaWYgKGZsYWcgPT0gMSlcIiBhbmRcbiAgICAgKiBOT1QgXCJpZiAoZmxhZylcIi4gVW5pbnRlbmRlZCBtb2RpZmljYXRpb24gb2YgdGhpcyBlbGVtZW50IHdpbGwgYmVcbiAgICAgKiBvdGhlcndpc2UgbWlzaW50ZXJwcmV0ZWQgYXMgYW4gaW5pdC5cbiAgICAgKi9cbiAgICB0aGlzLkNsYXNzX0lEID0gMDtcblxuICAgIHRoaXMubGFtZV9lbmNvZGVfZnJhbWVfaW5pdCA9IDA7XG4gICAgdGhpcy5pdGVyYXRpb25faW5pdF9pbml0ID0gMDtcbiAgICB0aGlzLmZpbGxfYnVmZmVyX3Jlc2FtcGxlX2luaXQgPSAwO1xuXG4gICAgLy9wdWJsaWMgZmxvYXQgbWZidWZbXVtdID0gbmV3IGZsb2F0WzJdW01GU0laRV07XG4gICAgdGhpcy5tZmJ1ZiA9IG5ld19mbG9hdF9uKFsyLCBMYW1lSW50ZXJuYWxGbGFncy5NRlNJWkVdKTtcblxuICAgIC8qKlxuICAgICAqIGdyYW51bGVzIHBlciBmcmFtZVxuICAgICAqL1xuICAgIHRoaXMubW9kZV9nciA9IDA7XG4gICAgLyoqXG4gICAgICogbnVtYmVyIG9mIGNoYW5uZWxzIGluIHRoZSBpbnB1dCBkYXRhIHN0cmVhbSAoUENNIG9yIGRlY29kZWQgUENNKVxuICAgICAqL1xuICAgIHRoaXMuY2hhbm5lbHNfaW4gPSAwO1xuICAgIC8qKlxuICAgICAqIG51bWJlciBvZiBjaGFubmVscyBpbiB0aGUgb3V0cHV0IGRhdGEgc3RyZWFtIChub3QgdXNlZCBmb3IgZGVjb2RpbmcpXG4gICAgICovXG4gICAgdGhpcy5jaGFubmVsc19vdXQgPSAwO1xuICAgIC8qKlxuICAgICAqIGlucHV0X3NhbXBfcmF0ZS9vdXRwdXRfc2FtcF9yYXRlXG4gICAgICovXG4gICAgICAgIC8vcHVibGljIGRvdWJsZSByZXNhbXBsZV9yYXRpbztcbiAgICB0aGlzLnJlc2FtcGxlX3JhdGlvID0gMC47XG5cbiAgICB0aGlzLm1mX3NhbXBsZXNfdG9fZW5jb2RlID0gMDtcbiAgICB0aGlzLm1mX3NpemUgPSAwO1xuICAgIC8qKlxuICAgICAqIG1pbiBiaXRyYXRlIGluZGV4XG4gICAgICovXG4gICAgdGhpcy5WQlJfbWluX2JpdHJhdGUgPSAwO1xuICAgIC8qKlxuICAgICAqIG1heCBiaXRyYXRlIGluZGV4XG4gICAgICovXG4gICAgdGhpcy5WQlJfbWF4X2JpdHJhdGUgPSAwO1xuICAgIHRoaXMuYml0cmF0ZV9pbmRleCA9IDA7XG4gICAgdGhpcy5zYW1wbGVyYXRlX2luZGV4ID0gMDtcbiAgICB0aGlzLm1vZGVfZXh0ID0gMDtcblxuICAgIC8qIGxvd3Bhc3MgYW5kIGhpZ2hwYXNzIGZpbHRlciBjb250cm9sICovXG4gICAgLyoqXG4gICAgICogbm9ybWFsaXplZCBmcmVxdWVuY3kgYm91bmRzIG9mIHBhc3NiYW5kXG4gICAgICovXG4gICAgdGhpcy5sb3dwYXNzMSA9IDAuO1xuICAgIHRoaXMubG93cGFzczIgPSAwLjtcbiAgICAvKipcbiAgICAgKiBub3JtYWxpemVkIGZyZXF1ZW5jeSBib3VuZHMgb2YgcGFzc2JhbmRcbiAgICAgKi9cbiAgICB0aGlzLmhpZ2hwYXNzMSA9IDAuO1xuICAgIHRoaXMuaGlnaHBhc3MyID0gMC47XG5cbiAgICAvKipcbiAgICAgKiAwID0gbm9uZSAxID0gSVNPIEFBQyBtb2RlbCAyID0gYWxsb3cgc2NhbGVmYWNfc2VsZWN0PTFcbiAgICAgKi9cbiAgICB0aGlzLm5vaXNlX3NoYXBpbmcgPSAwO1xuXG4gICAgLyoqXG4gICAgICogMCA9IElTTyBtb2RlbDogYW1wbGlmeSBhbGwgZGlzdG9ydGVkIGJhbmRzPEJSPlxuICAgICAqIDEgPSBhbXBsaWZ5IHdpdGhpbiA1MCUgb2YgbWF4IChvbiBkYiBzY2FsZSk8QlI+XG4gICAgICogMiA9IGFtcGxpZnkgb25seSBtb3N0IGRpc3RvcnRlZCBiYW5kPEJSPlxuICAgICAqIDMgPSBtZXRob2QgMSBhbmQgcmVmaW5lIHdpdGggbWV0aG9kIDI8QlI+XG4gICAgICovXG4gICAgdGhpcy5ub2lzZV9zaGFwaW5nX2FtcCA9IDA7XG4gICAgLyoqXG4gICAgICogMCA9IG5vIHN1YnN0ZXA8QlI+XG4gICAgICogMSA9IHVzZSBzdWJzdGVwIHNoYXBpbmcgYXQgbGFzdCBzdGVwKFZCUiBvbmx5KTxCUj5cbiAgICAgKiAobm90IGltcGxlbWVudGVkIHlldCk8QlI+XG4gICAgICogMiA9IHVzZSBzdWJzdGVwIGluc2lkZSBsb29wPEJSPlxuICAgICAqIDMgPSB1c2Ugc3Vic3RlcCBpbnNpZGUgbG9vcCBhbmQgbGFzdCBzdGVwPEJSPlxuICAgICAqL1xuICAgIHRoaXMuc3Vic3RlcF9zaGFwaW5nID0gMDtcblxuICAgIC8qKlxuICAgICAqIDEgPSBncHN5Y2hvLiAwID0gbm9uZVxuICAgICAqL1xuICAgIHRoaXMucHN5bW9kZWwgPSAwO1xuICAgIC8qKlxuICAgICAqIDAgPSBzdG9wIGF0IG92ZXI9MCwgYWxsIHNjYWxlZmFjcyBhbXBsaWZpZWQgb3I8QlI+XG4gICAgICogYSBzY2FsZWZhYyBoYXMgcmVhY2hlZCBtYXggdmFsdWU8QlI+XG4gICAgICogMSA9IHN0b3Agd2hlbiBhbGwgc2NhbGVmYWNzIGFtcGxpZmllZCBvciBhIHNjYWxlZmFjIGhhcyByZWFjaGVkIG1heCB2YWx1ZTxCUj5cbiAgICAgKiAyID0gc3RvcCB3aGVuIGFsbCBzY2FsZWZhY3MgYW1wbGlmaWVkXG4gICAgICovXG4gICAgdGhpcy5ub2lzZV9zaGFwaW5nX3N0b3AgPSAwO1xuXG4gICAgLyoqXG4gICAgICogMCA9IG5vLCAxID0geWVzXG4gICAgICovXG4gICAgdGhpcy5zdWJibG9ja19nYWluID0gMDtcbiAgICAvKipcbiAgICAgKiAwID0gbm8uIDE9b3V0c2lkZSBsb29wIDI9aW5zaWRlIGxvb3Aoc2xvdylcbiAgICAgKi9cbiAgICB0aGlzLnVzZV9iZXN0X2h1ZmZtYW4gPSAwO1xuXG4gICAgLyoqXG4gICAgICogMCA9IHN0b3AgZWFybHkgYWZ0ZXIgMCBkaXN0b3J0aW9uIGZvdW5kLiAxID0gZnVsbCBzZWFyY2hcbiAgICAgKi9cbiAgICB0aGlzLmZ1bGxfb3V0ZXJfbG9vcCA9IDA7XG5cbiAgICAvL3B1YmxpYyBJSUlTaWRlSW5mbyBsM19zaWRlID0gbmV3IElJSVNpZGVJbmZvKCk7XG4gICAgdGhpcy5sM19zaWRlID0gbmV3IElJSVNpZGVJbmZvKCk7XG4gICAgdGhpcy5tc19yYXRpbyA9IG5ld19mbG9hdCgyKTtcblxuICAgIC8qIHVzZWQgZm9yIHBhZGRpbmcgKi9cbiAgICAvKipcbiAgICAgKiBwYWRkaW5nIGZvciB0aGUgY3VycmVudCBmcmFtZT9cbiAgICAgKi9cbiAgICB0aGlzLnBhZGRpbmcgPSAwO1xuICAgIHRoaXMuZnJhY19TcEYgPSAwO1xuICAgIHRoaXMuc2xvdF9sYWcgPSAwO1xuXG4gICAgLyoqXG4gICAgICogb3B0aW9uYWwgSUQzIHRhZ3NcbiAgICAgKi9cbiAgICAgICAgLy9wdWJsaWMgSUQzVGFnU3BlYyB0YWdfc3BlYztcbiAgICB0aGlzLnRhZ19zcGVjID0gbnVsbDtcbiAgICB0aGlzLm5NdXNpY0NSQyA9IDA7XG5cbiAgICAvKiB2YXJpYWJsZXMgdXNlZCBieSBRdWFudGl6ZSAqL1xuICAgIC8vcHVibGljIGludCBPbGRWYWx1ZVtdID0gbmV3IGludFsyXTtcbiAgICB0aGlzLk9sZFZhbHVlID0gbmV3X2ludCgyKTtcbiAgICAvL3B1YmxpYyBpbnQgQ3VycmVudFN0ZXBbXSA9IG5ldyBpbnRbMl07XG4gICAgdGhpcy5DdXJyZW50U3RlcCA9IG5ld19pbnQoMik7XG5cbiAgICB0aGlzLm1hc2tpbmdfbG93ZXIgPSAwLjtcbiAgICAvL3B1YmxpYyBpbnQgYnZfc2NmW10gPSBuZXcgaW50WzU3Nl07XG4gICAgdGhpcy5idl9zY2YgPSBuZXdfaW50KDU3Nik7XG4gICAgLy9wdWJsaWMgaW50IHBzZXVkb2hhbGZbXSA9IG5ldyBpbnRbTDNTaWRlLlNGQk1BWF07XG4gICAgdGhpcy5wc2V1ZG9oYWxmID0gbmV3X2ludChMM1NpZGUuU0ZCTUFYKTtcblxuICAgIC8qKlxuICAgICAqIHdpbGwgYmUgc2V0IGluIGxhbWVfaW5pdF9wYXJhbXNcbiAgICAgKi9cbiAgICB0aGlzLnNmYjIxX2V4dHJhID0gZmFsc2U7XG5cbiAgICAvKiBCUEMgPSBtYXhpbXVtIG51bWJlciBvZiBmaWx0ZXIgY29udm9sdXRpb24gd2luZG93cyB0byBwcmVjb21wdXRlICovXG4gICAgLy9wdWJsaWMgZmxvYXRbXVtdIGluYnVmX29sZCA9IG5ldyBmbG9hdFsyXVtdO1xuICAgIHRoaXMuaW5idWZfb2xkID0gbmV3IEFycmF5KDIpO1xuICAgIC8vcHVibGljIGZsb2F0W11bXSBibGFja2ZpbHQgPSBuZXcgZmxvYXRbMiAqIEJQQyArIDFdW107XG4gICAgdGhpcy5ibGFja2ZpbHQgPSBuZXcgQXJyYXkoMiAqIExhbWVJbnRlcm5hbEZsYWdzLkJQQyArIDEpO1xuICAgIC8vcHVibGljIGRvdWJsZSBpdGltZVtdID0gbmV3IGRvdWJsZVsyXTtcbiAgICB0aGlzLml0aW1lID0gbmV3X2RvdWJsZSgyKTtcbiAgICB0aGlzLnNpZGVpbmZvX2xlbiA9IDA7XG5cbiAgICAvKiB2YXJpYWJsZXMgZm9yIG5ld21kY3QuYyAqL1xuICAgIC8vcHVibGljIGZsb2F0IHNiX3NhbXBsZVtdW11bXVtdID0gbmV3IGZsb2F0WzJdWzJdWzE4XVtFbmNvZGVyLlNCTElNSVRdO1xuICAgIHRoaXMuc2Jfc2FtcGxlID0gbmV3X2Zsb2F0X24oWzIsIDIsIDE4LCBFbmNvZGVyLlNCTElNSVRdKTtcbiAgICB0aGlzLmFtcF9maWx0ZXIgPSBuZXdfZmxvYXQoMzIpO1xuXG4gICAgLyogdmFyaWFibGVzIGZvciBCaXRTdHJlYW0gKi9cblxuICAgIC8qKlxuICAgICAqIDxQUkU+XG4gICAgICogbXBlZzE6IGJ1ZmZlcj01MTEgYnl0ZXMgIHNtYWxsZXN0IGZyYW1lOiA5Ni0zOChzaWRlaW5mbyk9NThcbiAgICAgKiBtYXggbnVtYmVyIG9mIGZyYW1lcyBpbiByZXNlcnZvaXI6ICA4XG4gICAgICogbXBlZzI6IGJ1ZmZlcj0yNTUgYnl0ZXMuICBzbWFsbGVzdCBmcmFtZTogMjQtMjNieXRlcz0xXG4gICAgICogd2l0aCBWQlIsIGlmIHlvdSBhcmUgZW5jb2RpbmcgYWxsIHNpbGVuY2UsIGl0IGlzIHBvc3NpYmxlIHRvXG4gICAgICogaGF2ZSA4a2JzLzI0a2h6IGZyYW1lcyB3aXRoIDFieXRlIG9mIGRhdGEgZWFjaCwgd2hpY2ggbWVhbnMgd2UgbmVlZFxuICAgICAqIHRvIGJ1ZmZlciB1cCB0byAyNTUgaGVhZGVycyFcbiAgICAgKiA8L1BSRT5cbiAgICAgKi9cbiAgICAvKipcbiAgICAgKiBhbHNvLCBtYXhfaGVhZGVyX2J1ZiBoYXMgdG8gYmUgYSBwb3dlciBvZiB0d29cbiAgICAgKi9cbiAgICAvKipcbiAgICAgKiBtYXggc2l6ZSBvZiBoZWFkZXIgaXMgMzhcbiAgICAgKi9cblxuICAgIGZ1bmN0aW9uIEhlYWRlcigpIHtcbiAgICAgICAgdGhpcy53cml0ZV90aW1pbmcgPSAwO1xuICAgICAgICB0aGlzLnB0ciA9IDA7XG4gICAgICAgIC8vcHVibGljIGJ5dGUgYnVmW10gPSBuZXcgYnl0ZVtNQVhfSEVBREVSX0xFTl07XG4gICAgICAgIHRoaXMuYnVmID0gbmV3X2J5dGUoTUFYX0hFQURFUl9MRU4pO1xuICAgIH1cblxuICAgIHRoaXMuaGVhZGVyID0gbmV3IEFycmF5KExhbWVJbnRlcm5hbEZsYWdzLk1BWF9IRUFERVJfQlVGKTtcblxuICAgIHRoaXMuaF9wdHIgPSAwO1xuICAgIHRoaXMud19wdHIgPSAwO1xuICAgIHRoaXMuYW5jaWxsYXJ5X2ZsYWcgPSAwO1xuXG4gICAgLyogdmFyaWFibGVzIGZvciBSZXNlcnZvaXIgKi9cbiAgICAvKipcbiAgICAgKiBpbiBiaXRzXG4gICAgICovXG4gICAgdGhpcy5SZXN2U2l6ZSA9IDA7XG4gICAgLyoqXG4gICAgICogaW4gYml0c1xuICAgICAqL1xuICAgIHRoaXMuUmVzdk1heCA9IDA7XG5cbiAgICAvL3B1YmxpYyBTY2FsZUZhYyBzY2FsZWZhY19iYW5kID0gbmV3IFNjYWxlRmFjKCk7XG4gICAgdGhpcy5zY2FsZWZhY19iYW5kID0gbmV3IFNjYWxlRmFjKCk7XG5cbiAgICAvKiBkYWEgZnJvbSBQc3lNb2RlbCAqL1xuICAgIC8qIFRoZSBzdGF0aWMgdmFyaWFibGVzIFwiclwiLCBcInBoaV9zYXZcIiwgXCJuZXdcIiwgXCJvbGRcIiBhbmQgXCJvbGRlc3RcIiBoYXZlICovXG4gICAgLyogdG8gYmUgcmVtZW1iZXJlZCBmb3IgdGhlIHVucHJlZGljdGFiaWxpdHkgbWVhc3VyZS4gRm9yIFwiclwiIGFuZCAqL1xuICAgIC8qIFwicGhpX3NhdlwiLCB0aGUgZmlyc3QgaW5kZXggZnJvbSB0aGUgbGVmdCBpcyB0aGUgY2hhbm5lbCBzZWxlY3QgYW5kICovXG4gICAgLyogdGhlIHNlY29uZCBpbmRleCBpcyB0aGUgXCJhZ2VcIiBvZiB0aGUgZGF0YS4gKi9cbiAgICB0aGlzLm1pbnZhbF9sID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTKTtcbiAgICB0aGlzLm1pbnZhbF9zID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTKTtcbiAgICB0aGlzLm5iXzEgPSBuZXdfZmxvYXRfbihbNCwgRW5jb2Rlci5DQkFORFNdKTtcbiAgICB0aGlzLm5iXzIgPSBuZXdfZmxvYXRfbihbNCwgRW5jb2Rlci5DQkFORFNdKTtcbiAgICB0aGlzLm5iX3MxID0gbmV3X2Zsb2F0X24oWzQsIEVuY29kZXIuQ0JBTkRTXSk7XG4gICAgdGhpcy5uYl9zMiA9IG5ld19mbG9hdF9uKFs0LCBFbmNvZGVyLkNCQU5EU10pO1xuICAgIHRoaXMuczNfc3MgPSBudWxsO1xuICAgIHRoaXMuczNfbGwgPSBudWxsO1xuICAgIHRoaXMuZGVjYXkgPSAwLjtcblxuICAgIC8vcHVibGljIElJSV9wc3lfeG1pbltdIHRobSA9IG5ldyBJSUlfcHN5X3htaW5bNF07XG4gICAgLy9wdWJsaWMgSUlJX3BzeV94bWluW10gZW4gPSBuZXcgSUlJX3BzeV94bWluWzRdO1xuICAgIHRoaXMudGhtID0gbmV3IEFycmF5KDQpO1xuICAgIHRoaXMuZW4gPSBuZXcgQXJyYXkoNCk7XG5cbiAgICAvKipcbiAgICAgKiBmZnQgYW5kIGVuZXJneSBjYWxjdWxhdGlvblxuICAgICAqL1xuICAgIHRoaXMudG90X2VuZXIgPSBuZXdfZmxvYXQoNCk7XG5cbiAgICAvKiBsb3VkbmVzcyBjYWxjdWxhdGlvbiAoZm9yIGFkYXB0aXZlIHRocmVzaG9sZCBvZiBoZWFyaW5nKSAqL1xuICAgIC8qKlxuICAgICAqIGxvdWRuZXNzXjIgYXBwcm94LiBwZXIgZ3JhbnVsZSBhbmQgY2hhbm5lbFxuICAgICAqL1xuICAgIHRoaXMubG91ZG5lc3Nfc3EgPSBuZXdfZmxvYXRfbihbMiwgMl0pO1xuICAgIC8qKlxuICAgICAqIGFjY291bnQgZm9yIGdyYW51bGUgZGVsYXkgb2YgTDNwc3ljaG9fYW5hbFxuICAgICAqL1xuICAgIHRoaXMubG91ZG5lc3Nfc3Ffc2F2ZSA9IG5ld19mbG9hdCgyKTtcblxuICAgIC8qKlxuICAgICAqIFNjYWxlIEZhY3RvciBCYW5kc1xuICAgICAqL1xuICAgIHRoaXMubWxkX2wgPSBuZXdfZmxvYXQoRW5jb2Rlci5TQk1BWF9sKTtcbiAgICB0aGlzLm1sZF9zID0gbmV3X2Zsb2F0KEVuY29kZXIuU0JNQVhfcyk7XG4gICAgdGhpcy5ibV9sID0gbmV3X2ludChFbmNvZGVyLlNCTUFYX2wpO1xuICAgIHRoaXMuYm9fbCA9IG5ld19pbnQoRW5jb2Rlci5TQk1BWF9sKTtcbiAgICB0aGlzLmJtX3MgPSBuZXdfaW50KEVuY29kZXIuU0JNQVhfcyk7XG4gICAgdGhpcy5ib19zID0gbmV3X2ludChFbmNvZGVyLlNCTUFYX3MpO1xuICAgIHRoaXMubnBhcnRfbCA9IDA7XG4gICAgdGhpcy5ucGFydF9zID0gMDtcblxuICAgIHRoaXMuczNpbmQgPSBuZXdfaW50X24oW0VuY29kZXIuQ0JBTkRTLCAyXSk7XG4gICAgdGhpcy5zM2luZF9zID0gbmV3X2ludF9uKFtFbmNvZGVyLkNCQU5EUywgMl0pO1xuXG4gICAgdGhpcy5udW1saW5lc19zID0gbmV3X2ludChFbmNvZGVyLkNCQU5EUyk7XG4gICAgdGhpcy5udW1saW5lc19sID0gbmV3X2ludChFbmNvZGVyLkNCQU5EUyk7XG4gICAgdGhpcy5ybnVtbGluZXNfbCA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyk7XG4gICAgdGhpcy5tbGRfY2JfbCA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyk7XG4gICAgdGhpcy5tbGRfY2JfcyA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyk7XG4gICAgdGhpcy5udW1saW5lc19zX251bTEgPSAwO1xuICAgIHRoaXMubnVtbGluZXNfbF9udW0xID0gMDtcblxuICAgIC8qIHJhdGlvcyAqL1xuICAgIHRoaXMucGUgPSBuZXdfZmxvYXQoNCk7XG4gICAgdGhpcy5tc19yYXRpb19zX29sZCA9IDAuO1xuICAgIHRoaXMubXNfcmF0aW9fbF9vbGQgPSAwLjtcbiAgICB0aGlzLm1zX2VuZXJfcmF0aW9fb2xkID0gMC47XG5cbiAgICAvKipcbiAgICAgKiBibG9jayB0eXBlXG4gICAgICovXG4gICAgdGhpcy5ibG9ja3R5cGVfb2xkID0gbmV3X2ludCgyKTtcblxuICAgIC8qKlxuICAgICAqIHZhcmlhYmxlcyB1c2VkIGZvciAtLW5zcHN5dHVuZVxuICAgICAqL1xuICAgIHRoaXMubnNQc3kgPSBuZXcgTnNQc3koKTtcblxuICAgIC8qKlxuICAgICAqIHVzZWQgZm9yIFhpbmcgVkJSIGhlYWRlclxuICAgICAqL1xuICAgIHRoaXMuVkJSX3NlZWtfdGFibGUgPSBuZXcgVkJSU2Vla0luZm8oKTtcblxuICAgIC8qKlxuICAgICAqIGFsbCBBVEggcmVsYXRlZCBzdHVmZlxuICAgICAqL1xuICAgICAgICAvL3B1YmxpYyBBVEggQVRIO1xuICAgIHRoaXMuQVRIID0gbnVsbDtcblxuICAgIHRoaXMuUFNZID0gbnVsbDtcblxuICAgIHRoaXMubm9nYXBfdG90YWwgPSAwO1xuICAgIHRoaXMubm9nYXBfY3VycmVudCA9IDA7XG5cbiAgICAvKiBSZXBsYXlHYWluICovXG4gICAgdGhpcy5kZWNvZGVfb25fdGhlX2ZseSA9IHRydWU7XG4gICAgdGhpcy5maW5kUmVwbGF5R2FpbiA9IHRydWU7XG4gICAgdGhpcy5maW5kUGVha1NhbXBsZSA9IHRydWU7XG4gICAgdGhpcy5QZWFrU2FtcGxlID0gMC47XG4gICAgdGhpcy5SYWRpb0dhaW4gPSAwO1xuICAgIHRoaXMuQXVkaW9waGlsZUdhaW4gPSAwO1xuICAgIC8vcHVibGljIFJlcGxheUdhaW4gcmdkYXRhO1xuICAgIHRoaXMucmdkYXRhID0gbnVsbDtcblxuICAgIC8qKlxuICAgICAqIGdhaW4gY2hhbmdlIHJlcXVpcmVkIGZvciBwcmV2ZW50aW5nIGNsaXBwaW5nXG4gICAgICovXG4gICAgdGhpcy5ub2NsaXBHYWluQ2hhbmdlID0gMDtcbiAgICAvKipcbiAgICAgKiB1c2VyLXNwZWNpZmllZCBzY2FsZSBmYWN0b3IgcmVxdWlyZWQgZm9yIHByZXZlbnRpbmcgY2xpcHBpbmdcbiAgICAgKi9cbiAgICB0aGlzLm5vY2xpcFNjYWxlID0gMC47XG5cbiAgICAvKiBzaW1wbGUgc3RhdGlzdGljcyAqL1xuICAgIHRoaXMuYml0cmF0ZV9zdGVyZW9Nb2RlX0hpc3QgPSBuZXdfaW50X24oWzE2LCA0ICsgMV0pO1xuICAgIC8qKlxuICAgICAqIG5vcm0vc3RhcnQvc2hvcnQvc3RvcC9taXhlZChzaG9ydCkvc3VtXG4gICAgICovXG4gICAgdGhpcy5iaXRyYXRlX2Jsb2NrVHlwZV9IaXN0ID0gbmV3X2ludF9uKFsxNiwgNCArIDEgKyAxXSk7XG5cbiAgICAvL3B1YmxpYyBQbG90dGluZ0RhdGEgcGluZm87XG4gICAgLy9wdWJsaWMgTVBHTGliLm1wc3RyX3RhZyBoaXA7XG4gICAgdGhpcy5waW5mbyA9IG51bGw7XG4gICAgdGhpcy5oaXAgPSBudWxsO1xuXG4gICAgdGhpcy5pbl9idWZmZXJfbnNhbXBsZXMgPSAwO1xuICAgIC8vcHVibGljIGZsb2F0W10gaW5fYnVmZmVyXzA7XG4gICAgLy9wdWJsaWMgZmxvYXRbXSBpbl9idWZmZXJfMTtcbiAgICB0aGlzLmluX2J1ZmZlcl8wID0gbnVsbDtcbiAgICB0aGlzLmluX2J1ZmZlcl8xID0gbnVsbDtcblxuICAgIC8vcHVibGljIElJdGVyYXRpb25Mb29wIGl0ZXJhdGlvbl9sb29wO1xuICAgIHRoaXMuaXRlcmF0aW9uX2xvb3AgPSBudWxsO1xuXG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMuZW5baV0gPSBuZXcgSUlJX3BzeV94bWluKCk7XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy50aG0ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcy50aG1baV0gPSBuZXcgSUlJX3BzeV94bWluKCk7XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5oZWFkZXIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcy5oZWFkZXJbaV0gPSBuZXcgSGVhZGVyKCk7XG4gICAgfVxuXG59XG5cblxuXG5mdW5jdGlvbiBGRlQoKSB7XG5cbiAgICB2YXIgd2luZG93ID0gbmV3X2Zsb2F0KEVuY29kZXIuQkxLU0laRSk7XG4gICAgdmFyIHdpbmRvd19zID0gbmV3X2Zsb2F0KEVuY29kZXIuQkxLU0laRV9zIC8gMik7XG5cbiAgICB2YXIgY29zdGFiID0gW1xuICAgICAgICA5LjIzODc5NTMyNTExMjg2N2UtMDEsIDMuODI2ODM0MzIzNjUwODk4ZS0wMSxcbiAgICAgICAgOS45NTE4NDcyNjY3MjE5NjllLTAxLCA5LjgwMTcxNDAzMjk1NjA2MGUtMDIsXG4gICAgICAgIDkuOTk2OTg4MTg2OTYyMDQyZS0wMSwgMi40NTQxMjI4NTIyOTEyMjllLTAyLFxuICAgICAgICA5Ljk5OTgxMTc1MjgyNjAxMWUtMDEsIDYuMTM1ODg0NjQ5MTU0NDc1ZS0wM1xuICAgIF07XG5cbiAgICBmdW5jdGlvbiBmaHQoZnosIGZ6UG9zLCBuKSB7XG4gICAgICAgIHZhciB0cmkgPSAwO1xuICAgICAgICB2YXIgazQ7XG4gICAgICAgIHZhciBmaTtcbiAgICAgICAgdmFyIGdpO1xuXG4gICAgICAgIG4gPDw9IDE7XG4gICAgICAgIC8qIHRvIGdldCBCTEtTSVpFLCBiZWNhdXNlIG9mIDNETm93ISBBU00gcm91dGluZSAqL1xuICAgICAgICB2YXIgZm4gPSBmelBvcyArIG47XG4gICAgICAgIGs0ID0gNDtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgdmFyIHMxLCBjMTtcbiAgICAgICAgICAgIHZhciBpLCBrMSwgazIsIGszLCBreDtcbiAgICAgICAgICAgIGt4ID0gazQgPj4gMTtcbiAgICAgICAgICAgIGsxID0gazQ7XG4gICAgICAgICAgICBrMiA9IGs0IDw8IDE7XG4gICAgICAgICAgICBrMyA9IGsyICsgazE7XG4gICAgICAgICAgICBrNCA9IGsyIDw8IDE7XG4gICAgICAgICAgICBmaSA9IGZ6UG9zO1xuICAgICAgICAgICAgZ2kgPSBmaSArIGt4O1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIHZhciBmMCwgZjEsIGYyLCBmMztcbiAgICAgICAgICAgICAgICBmMSA9IGZ6W2ZpICsgMF0gLSBmeltmaSArIGsxXTtcbiAgICAgICAgICAgICAgICBmMCA9IGZ6W2ZpICsgMF0gKyBmeltmaSArIGsxXTtcbiAgICAgICAgICAgICAgICBmMyA9IGZ6W2ZpICsgazJdIC0gZnpbZmkgKyBrM107XG4gICAgICAgICAgICAgICAgZjIgPSBmeltmaSArIGsyXSArIGZ6W2ZpICsgazNdO1xuICAgICAgICAgICAgICAgIGZ6W2ZpICsgazJdID0gZjAgLSBmMjtcbiAgICAgICAgICAgICAgICBmeltmaSArIDBdID0gZjAgKyBmMjtcbiAgICAgICAgICAgICAgICBmeltmaSArIGszXSA9IGYxIC0gZjM7XG4gICAgICAgICAgICAgICAgZnpbZmkgKyBrMV0gPSBmMSArIGYzO1xuICAgICAgICAgICAgICAgIGYxID0gZnpbZ2kgKyAwXSAtIGZ6W2dpICsgazFdO1xuICAgICAgICAgICAgICAgIGYwID0gZnpbZ2kgKyAwXSArIGZ6W2dpICsgazFdO1xuICAgICAgICAgICAgICAgIGYzID0gKFV0aWwuU1FSVDIgKiBmeltnaSArIGszXSk7XG4gICAgICAgICAgICAgICAgZjIgPSAoVXRpbC5TUVJUMiAqIGZ6W2dpICsgazJdKTtcbiAgICAgICAgICAgICAgICBmeltnaSArIGsyXSA9IGYwIC0gZjI7XG4gICAgICAgICAgICAgICAgZnpbZ2kgKyAwXSA9IGYwICsgZjI7XG4gICAgICAgICAgICAgICAgZnpbZ2kgKyBrM10gPSBmMSAtIGYzO1xuICAgICAgICAgICAgICAgIGZ6W2dpICsgazFdID0gZjEgKyBmMztcbiAgICAgICAgICAgICAgICBnaSArPSBrNDtcbiAgICAgICAgICAgICAgICBmaSArPSBrNDtcbiAgICAgICAgICAgIH0gd2hpbGUgKGZpIDwgZm4pO1xuICAgICAgICAgICAgYzEgPSBjb3N0YWJbdHJpICsgMF07XG4gICAgICAgICAgICBzMSA9IGNvc3RhYlt0cmkgKyAxXTtcbiAgICAgICAgICAgIGZvciAoaSA9IDE7IGkgPCBreDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGMyLCBzMjtcbiAgICAgICAgICAgICAgICBjMiA9IDEgLSAoMiAqIHMxKSAqIHMxO1xuICAgICAgICAgICAgICAgIHMyID0gKDIgKiBzMSkgKiBjMTtcbiAgICAgICAgICAgICAgICBmaSA9IGZ6UG9zICsgaTtcbiAgICAgICAgICAgICAgICBnaSA9IGZ6UG9zICsgazEgLSBpO1xuICAgICAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEsIGIsIGcwLCBmMCwgZjEsIGcxLCBmMiwgZzIsIGYzLCBnMztcbiAgICAgICAgICAgICAgICAgICAgYiA9IHMyICogZnpbZmkgKyBrMV0gLSBjMiAqIGZ6W2dpICsgazFdO1xuICAgICAgICAgICAgICAgICAgICBhID0gYzIgKiBmeltmaSArIGsxXSArIHMyICogZnpbZ2kgKyBrMV07XG4gICAgICAgICAgICAgICAgICAgIGYxID0gZnpbZmkgKyAwXSAtIGE7XG4gICAgICAgICAgICAgICAgICAgIGYwID0gZnpbZmkgKyAwXSArIGE7XG4gICAgICAgICAgICAgICAgICAgIGcxID0gZnpbZ2kgKyAwXSAtIGI7XG4gICAgICAgICAgICAgICAgICAgIGcwID0gZnpbZ2kgKyAwXSArIGI7XG4gICAgICAgICAgICAgICAgICAgIGIgPSBzMiAqIGZ6W2ZpICsgazNdIC0gYzIgKiBmeltnaSArIGszXTtcbiAgICAgICAgICAgICAgICAgICAgYSA9IGMyICogZnpbZmkgKyBrM10gKyBzMiAqIGZ6W2dpICsgazNdO1xuICAgICAgICAgICAgICAgICAgICBmMyA9IGZ6W2ZpICsgazJdIC0gYTtcbiAgICAgICAgICAgICAgICAgICAgZjIgPSBmeltmaSArIGsyXSArIGE7XG4gICAgICAgICAgICAgICAgICAgIGczID0gZnpbZ2kgKyBrMl0gLSBiO1xuICAgICAgICAgICAgICAgICAgICBnMiA9IGZ6W2dpICsgazJdICsgYjtcbiAgICAgICAgICAgICAgICAgICAgYiA9IHMxICogZjIgLSBjMSAqIGczO1xuICAgICAgICAgICAgICAgICAgICBhID0gYzEgKiBmMiArIHMxICogZzM7XG4gICAgICAgICAgICAgICAgICAgIGZ6W2ZpICsgazJdID0gZjAgLSBhO1xuICAgICAgICAgICAgICAgICAgICBmeltmaSArIDBdID0gZjAgKyBhO1xuICAgICAgICAgICAgICAgICAgICBmeltnaSArIGszXSA9IGcxIC0gYjtcbiAgICAgICAgICAgICAgICAgICAgZnpbZ2kgKyBrMV0gPSBnMSArIGI7XG4gICAgICAgICAgICAgICAgICAgIGIgPSBjMSAqIGcyIC0gczEgKiBmMztcbiAgICAgICAgICAgICAgICAgICAgYSA9IHMxICogZzIgKyBjMSAqIGYzO1xuICAgICAgICAgICAgICAgICAgICBmeltnaSArIGsyXSA9IGcwIC0gYTtcbiAgICAgICAgICAgICAgICAgICAgZnpbZ2kgKyAwXSA9IGcwICsgYTtcbiAgICAgICAgICAgICAgICAgICAgZnpbZmkgKyBrM10gPSBmMSAtIGI7XG4gICAgICAgICAgICAgICAgICAgIGZ6W2ZpICsgazFdID0gZjEgKyBiO1xuICAgICAgICAgICAgICAgICAgICBnaSArPSBrNDtcbiAgICAgICAgICAgICAgICAgICAgZmkgKz0gazQ7XG4gICAgICAgICAgICAgICAgfSB3aGlsZSAoZmkgPCBmbik7XG4gICAgICAgICAgICAgICAgYzIgPSBjMTtcbiAgICAgICAgICAgICAgICBjMSA9IGMyICogY29zdGFiW3RyaSArIDBdIC0gczEgKiBjb3N0YWJbdHJpICsgMV07XG4gICAgICAgICAgICAgICAgczEgPSBjMiAqIGNvc3RhYlt0cmkgKyAxXSArIHMxICogY29zdGFiW3RyaSArIDBdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHJpICs9IDI7XG4gICAgICAgIH0gd2hpbGUgKGs0IDwgbik7XG4gICAgfVxuXG4gICAgdmFyIHJ2X3RibCA9IFsweDAwLCAweDgwLCAweDQwLFxuICAgICAgICAweGMwLCAweDIwLCAweGEwLCAweDYwLCAweGUwLCAweDEwLFxuICAgICAgICAweDkwLCAweDUwLCAweGQwLCAweDMwLCAweGIwLCAweDcwLFxuICAgICAgICAweGYwLCAweDA4LCAweDg4LCAweDQ4LCAweGM4LCAweDI4LFxuICAgICAgICAweGE4LCAweDY4LCAweGU4LCAweDE4LCAweDk4LCAweDU4LFxuICAgICAgICAweGQ4LCAweDM4LCAweGI4LCAweDc4LCAweGY4LCAweDA0LFxuICAgICAgICAweDg0LCAweDQ0LCAweGM0LCAweDI0LCAweGE0LCAweDY0LFxuICAgICAgICAweGU0LCAweDE0LCAweDk0LCAweDU0LCAweGQ0LCAweDM0LFxuICAgICAgICAweGI0LCAweDc0LCAweGY0LCAweDBjLCAweDhjLCAweDRjLFxuICAgICAgICAweGNjLCAweDJjLCAweGFjLCAweDZjLCAweGVjLCAweDFjLFxuICAgICAgICAweDljLCAweDVjLCAweGRjLCAweDNjLCAweGJjLCAweDdjLFxuICAgICAgICAweGZjLCAweDAyLCAweDgyLCAweDQyLCAweGMyLCAweDIyLFxuICAgICAgICAweGEyLCAweDYyLCAweGUyLCAweDEyLCAweDkyLCAweDUyLFxuICAgICAgICAweGQyLCAweDMyLCAweGIyLCAweDcyLCAweGYyLCAweDBhLFxuICAgICAgICAweDhhLCAweDRhLCAweGNhLCAweDJhLCAweGFhLCAweDZhLFxuICAgICAgICAweGVhLCAweDFhLCAweDlhLCAweDVhLCAweGRhLCAweDNhLFxuICAgICAgICAweGJhLCAweDdhLCAweGZhLCAweDA2LCAweDg2LCAweDQ2LFxuICAgICAgICAweGM2LCAweDI2LCAweGE2LCAweDY2LCAweGU2LCAweDE2LFxuICAgICAgICAweDk2LCAweDU2LCAweGQ2LCAweDM2LCAweGI2LCAweDc2LFxuICAgICAgICAweGY2LCAweDBlLCAweDhlLCAweDRlLCAweGNlLCAweDJlLFxuICAgICAgICAweGFlLCAweDZlLCAweGVlLCAweDFlLCAweDllLCAweDVlLFxuICAgICAgICAweGRlLCAweDNlLCAweGJlLCAweDdlLCAweGZlXTtcblxuICAgIHRoaXMuZmZ0X3Nob3J0ID0gZnVuY3Rpb24gKGdmYywgeF9yZWFsLCBjaG4sIGJ1ZmZlciwgYnVmUG9zKSB7XG4gICAgICAgIGZvciAodmFyIGIgPSAwOyBiIDwgMzsgYisrKSB7XG4gICAgICAgICAgICB2YXIgeCA9IEVuY29kZXIuQkxLU0laRV9zIC8gMjtcbiAgICAgICAgICAgIHZhciBrID0gMHhmZmZmICYgKCg1NzYgLyAzKSAqIChiICsgMSkpO1xuICAgICAgICAgICAgdmFyIGogPSBFbmNvZGVyLkJMS1NJWkVfcyAvIDggLSAxO1xuICAgICAgICAgICAgZG8ge1xuICAgICAgICAgICAgICAgIHZhciBmMCwgZjEsIGYyLCBmMywgdztcbiAgICAgICAgICAgICAgICB2YXIgaSA9IHJ2X3RibFtqIDw8IDJdICYgMHhmZjtcblxuICAgICAgICAgICAgICAgIGYwID0gd2luZG93X3NbaV0gKiBidWZmZXJbY2huXVtidWZQb3MgKyBpICsga107XG4gICAgICAgICAgICAgICAgdyA9IHdpbmRvd19zWzB4N2YgLSBpXSAqIGJ1ZmZlcltjaG5dW2J1ZlBvcyArIGkgKyBrICsgMHg4MF07XG4gICAgICAgICAgICAgICAgZjEgPSBmMCAtIHc7XG4gICAgICAgICAgICAgICAgZjAgPSBmMCArIHc7XG4gICAgICAgICAgICAgICAgZjIgPSB3aW5kb3dfc1tpICsgMHg0MF0gKiBidWZmZXJbY2huXVtidWZQb3MgKyBpICsgayArIDB4NDBdO1xuICAgICAgICAgICAgICAgIHcgPSB3aW5kb3dfc1sweDNmIC0gaV0gKiBidWZmZXJbY2huXVtidWZQb3MgKyBpICsgayArIDB4YzBdO1xuICAgICAgICAgICAgICAgIGYzID0gZjIgLSB3O1xuICAgICAgICAgICAgICAgIGYyID0gZjIgKyB3O1xuXG4gICAgICAgICAgICAgICAgeCAtPSA0O1xuICAgICAgICAgICAgICAgIHhfcmVhbFtiXVt4ICsgMF0gPSBmMCArIGYyO1xuICAgICAgICAgICAgICAgIHhfcmVhbFtiXVt4ICsgMl0gPSBmMCAtIGYyO1xuICAgICAgICAgICAgICAgIHhfcmVhbFtiXVt4ICsgMV0gPSBmMSArIGYzO1xuICAgICAgICAgICAgICAgIHhfcmVhbFtiXVt4ICsgM10gPSBmMSAtIGYzO1xuXG4gICAgICAgICAgICAgICAgZjAgPSB3aW5kb3dfc1tpICsgMHgwMV0gKiBidWZmZXJbY2huXVtidWZQb3MgKyBpICsgayArIDB4MDFdO1xuICAgICAgICAgICAgICAgIHcgPSB3aW5kb3dfc1sweDdlIC0gaV0gKiBidWZmZXJbY2huXVtidWZQb3MgKyBpICsgayArIDB4ODFdO1xuICAgICAgICAgICAgICAgIGYxID0gZjAgLSB3O1xuICAgICAgICAgICAgICAgIGYwID0gZjAgKyB3O1xuICAgICAgICAgICAgICAgIGYyID0gd2luZG93X3NbaSArIDB4NDFdICogYnVmZmVyW2Nobl1bYnVmUG9zICsgaSArIGsgKyAweDQxXTtcbiAgICAgICAgICAgICAgICB3ID0gd2luZG93X3NbMHgzZSAtIGldICogYnVmZmVyW2Nobl1bYnVmUG9zICsgaSArIGsgKyAweGMxXTtcbiAgICAgICAgICAgICAgICBmMyA9IGYyIC0gdztcbiAgICAgICAgICAgICAgICBmMiA9IGYyICsgdztcblxuICAgICAgICAgICAgICAgIHhfcmVhbFtiXVt4ICsgRW5jb2Rlci5CTEtTSVpFX3MgLyAyICsgMF0gPSBmMCArIGYyO1xuICAgICAgICAgICAgICAgIHhfcmVhbFtiXVt4ICsgRW5jb2Rlci5CTEtTSVpFX3MgLyAyICsgMl0gPSBmMCAtIGYyO1xuICAgICAgICAgICAgICAgIHhfcmVhbFtiXVt4ICsgRW5jb2Rlci5CTEtTSVpFX3MgLyAyICsgMV0gPSBmMSArIGYzO1xuICAgICAgICAgICAgICAgIHhfcmVhbFtiXVt4ICsgRW5jb2Rlci5CTEtTSVpFX3MgLyAyICsgM10gPSBmMSAtIGYzO1xuICAgICAgICAgICAgfSB3aGlsZSAoLS1qID49IDApO1xuXG4gICAgICAgICAgICBmaHQoeF9yZWFsW2JdLCB4LCBFbmNvZGVyLkJMS1NJWkVfcyAvIDIpO1xuICAgICAgICAgICAgLyogQkxLU0laRV9zLzIgYmVjYXVzZSBvZiAzRE5vdyEgQVNNIHJvdXRpbmUgKi9cbiAgICAgICAgICAgIC8qIEJMS1NJWkUvMiBiZWNhdXNlIG9mIDNETm93ISBBU00gcm91dGluZSAqL1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5mZnRfbG9uZyA9IGZ1bmN0aW9uIChnZmMsIHksIGNobiwgYnVmZmVyLCBidWZQb3MpIHtcbiAgICAgICAgdmFyIGpqID0gRW5jb2Rlci5CTEtTSVpFIC8gOCAtIDE7XG4gICAgICAgIHZhciB4ID0gRW5jb2Rlci5CTEtTSVpFIC8gMjtcblxuICAgICAgICBkbyB7XG4gICAgICAgICAgICB2YXIgZjAsIGYxLCBmMiwgZjMsIHc7XG4gICAgICAgICAgICB2YXIgaSA9IHJ2X3RibFtqal0gJiAweGZmO1xuICAgICAgICAgICAgZjAgPSB3aW5kb3dbaV0gKiBidWZmZXJbY2huXVtidWZQb3MgKyBpXTtcbiAgICAgICAgICAgIHcgPSB3aW5kb3dbaSArIDB4MjAwXSAqIGJ1ZmZlcltjaG5dW2J1ZlBvcyArIGkgKyAweDIwMF07XG4gICAgICAgICAgICBmMSA9IGYwIC0gdztcbiAgICAgICAgICAgIGYwID0gZjAgKyB3O1xuICAgICAgICAgICAgZjIgPSB3aW5kb3dbaSArIDB4MTAwXSAqIGJ1ZmZlcltjaG5dW2J1ZlBvcyArIGkgKyAweDEwMF07XG4gICAgICAgICAgICB3ID0gd2luZG93W2kgKyAweDMwMF0gKiBidWZmZXJbY2huXVtidWZQb3MgKyBpICsgMHgzMDBdO1xuICAgICAgICAgICAgZjMgPSBmMiAtIHc7XG4gICAgICAgICAgICBmMiA9IGYyICsgdztcblxuICAgICAgICAgICAgeCAtPSA0O1xuICAgICAgICAgICAgeVt4ICsgMF0gPSBmMCArIGYyO1xuICAgICAgICAgICAgeVt4ICsgMl0gPSBmMCAtIGYyO1xuICAgICAgICAgICAgeVt4ICsgMV0gPSBmMSArIGYzO1xuICAgICAgICAgICAgeVt4ICsgM10gPSBmMSAtIGYzO1xuXG4gICAgICAgICAgICBmMCA9IHdpbmRvd1tpICsgMHgwMDFdICogYnVmZmVyW2Nobl1bYnVmUG9zICsgaSArIDB4MDAxXTtcbiAgICAgICAgICAgIHcgPSB3aW5kb3dbaSArIDB4MjAxXSAqIGJ1ZmZlcltjaG5dW2J1ZlBvcyArIGkgKyAweDIwMV07XG4gICAgICAgICAgICBmMSA9IGYwIC0gdztcbiAgICAgICAgICAgIGYwID0gZjAgKyB3O1xuICAgICAgICAgICAgZjIgPSB3aW5kb3dbaSArIDB4MTAxXSAqIGJ1ZmZlcltjaG5dW2J1ZlBvcyArIGkgKyAweDEwMV07XG4gICAgICAgICAgICB3ID0gd2luZG93W2kgKyAweDMwMV0gKiBidWZmZXJbY2huXVtidWZQb3MgKyBpICsgMHgzMDFdO1xuICAgICAgICAgICAgZjMgPSBmMiAtIHc7XG4gICAgICAgICAgICBmMiA9IGYyICsgdztcblxuICAgICAgICAgICAgeVt4ICsgRW5jb2Rlci5CTEtTSVpFIC8gMiArIDBdID0gZjAgKyBmMjtcbiAgICAgICAgICAgIHlbeCArIEVuY29kZXIuQkxLU0laRSAvIDIgKyAyXSA9IGYwIC0gZjI7XG4gICAgICAgICAgICB5W3ggKyBFbmNvZGVyLkJMS1NJWkUgLyAyICsgMV0gPSBmMSArIGYzO1xuICAgICAgICAgICAgeVt4ICsgRW5jb2Rlci5CTEtTSVpFIC8gMiArIDNdID0gZjEgLSBmMztcbiAgICAgICAgfSB3aGlsZSAoLS1qaiA+PSAwKTtcblxuICAgICAgICBmaHQoeSwgeCwgRW5jb2Rlci5CTEtTSVpFIC8gMik7XG4gICAgICAgIC8qIEJMS1NJWkUvMiBiZWNhdXNlIG9mIDNETm93ISBBU00gcm91dGluZSAqL1xuICAgIH1cblxuICAgIHRoaXMuaW5pdF9mZnQgPSBmdW5jdGlvbiAoZ2ZjKSB7XG4gICAgICAgIC8qIFRoZSB0eXBlIG9mIHdpbmRvdyB1c2VkIGhlcmUgd2lsbCBtYWtlIG5vIHJlYWwgZGlmZmVyZW5jZSwgYnV0ICovXG4gICAgICAgIC8qXG4gICAgICAgICAqIGluIHRoZSBpbnRlcmVzdCBvZiBtZXJnaW5nIG5zcHN5dHVuZSBzdHVmZiAtIHN3aXRjaCB0byBibGFja21hblxuICAgICAgICAgKiB3aW5kb3dcbiAgICAgICAgICovXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgRW5jb2Rlci5CTEtTSVpFOyBpKyspXG4gICAgICAgICAgICAvKiBibGFja21hbiB3aW5kb3cgKi9cbiAgICAgICAgICAgIHdpbmRvd1tpXSA9ICgwLjQyIC0gMC41ICogTWF0aC5jb3MoMiAqIE1hdGguUEkgKiAoaSArIC41KVxuICAgICAgICAgICAgICAgIC8gRW5jb2Rlci5CTEtTSVpFKSArIDAuMDggKiBNYXRoLmNvcyg0ICogTWF0aC5QSSAqIChpICsgLjUpXG4gICAgICAgICAgICAgICAgLyBFbmNvZGVyLkJMS1NJWkUpKTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEVuY29kZXIuQkxLU0laRV9zIC8gMjsgaSsrKVxuICAgICAgICAgICAgd2luZG93X3NbaV0gPSAoMC41ICogKDEuMCAtIE1hdGguY29zKDIuMCAqIE1hdGguUElcbiAgICAgICAgICAgICAgICAqIChpICsgMC41KSAvIEVuY29kZXIuQkxLU0laRV9zKSkpO1xuXG4gICAgfVxuXG59XG5cbi8qXG4gKiAgICAgIHBzeW1vZGVsLmNcbiAqXG4gKiAgICAgIENvcHlyaWdodCAoYykgMTk5OS0yMDAwIE1hcmsgVGF5bG9yXG4gKiAgICAgIENvcHlyaWdodCAoYykgMjAwMS0yMDAyIE5hb2tpIFNoaWJhdGFcbiAqICAgICAgQ29weXJpZ2h0IChjKSAyMDAwLTIwMDMgVGFrZWhpcm8gVG9taW5hZ2FcbiAqICAgICAgQ29weXJpZ2h0IChjKSAyMDAwLTIwMDggUm9iZXJ0IEhlZ2VtYW5uXG4gKiAgICAgIENvcHlyaWdodCAoYykgMjAwMC0yMDA1IEdhYnJpZWwgQm91dmlnbmVcbiAqICAgICAgQ29weXJpZ2h0IChjKSAyMDAwLTIwMDUgQWxleGFuZGVyIExlaWRpbmdlclxuICpcbiAqIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3JcbiAqIG1vZGlmeSBpdCB1bmRlciB0aGUgdGVybXMgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWNcbiAqIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlclxuICogdmVyc2lvbiAyIG9mIHRoZSBMaWNlbnNlLCBvciAoYXQgeW91ciBvcHRpb24pIGFueSBsYXRlciB2ZXJzaW9uLlxuICpcbiAqIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLFxuICogYnV0IFdJVEhPVVQgQU5ZIFdBUlJBTlRZOyB3aXRob3V0IGV2ZW4gdGhlIGltcGxpZWQgd2FycmFudHkgb2ZcbiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VXG4gKiBMaWJyYXJ5IEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy5cbiAqXG4gKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljXG4gKiBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHdyaXRlIHRvIHRoZVxuICogRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBJbmMuLCA1OSBUZW1wbGUgUGxhY2UgLSBTdWl0ZSAzMzAsXG4gKiBCb3N0b24sIE1BIDAyMTExLTEzMDcsIFVTQS5cbiAqL1xuXG4vKiAkSWQ6IFBzeU1vZGVsLmphdmEsdiAxLjI3IDIwMTEvMDUvMjQgMjA6NDg6MDYga2VuY2hpcyBFeHAgJCAqL1xuXG5cbi8qXG4gUFNZQ0hPIEFDT1VTVElDU1xuXG5cbiBUaGlzIHJvdXRpbmUgY29tcHV0ZXMgdGhlIHBzeWNobyBhY291c3RpY3MsIGRlbGF5ZWQgYnkgb25lIGdyYW51bGUuXG5cbiBJbnB1dDogYnVmZmVyIG9mIFBDTSBkYXRhICgxMDI0IHNhbXBsZXMpLlxuXG4gVGhpcyB3aW5kb3cgc2hvdWxkIGJlIGNlbnRlcmVkIG92ZXIgdGhlIDU3NiBzYW1wbGUgZ3JhbnVsZSB3aW5kb3cuXG4gVGhlIHJvdXRpbmUgd2lsbCBjb21wdXRlIHRoZSBwc3ljaG8gYWNvdXN0aWNzIGZvclxuIHRoaXMgZ3JhbnVsZSwgYnV0IHJldHVybiB0aGUgcHN5Y2hvIGFjb3VzdGljcyBjb21wdXRlZFxuIGZvciB0aGUgKnByZXZpb3VzKiBncmFudWxlLiAgVGhpcyBpcyBiZWNhdXNlIHRoZSBibG9ja1xuIHR5cGUgb2YgdGhlIHByZXZpb3VzIGdyYW51bGUgY2FuIG9ubHkgYmUgZGV0ZXJtaW5lZFxuIGFmdGVyIHdlIGhhdmUgY29tcHV0ZWQgdGhlIHBzeWNobyBhY291c3RpY3MgZm9yIHRoZSBmb2xsb3dpbmdcbiBncmFudWxlLlxuXG4gT3V0cHV0OiAgbWFza2luZ3MgYW5kIGVuZXJnaWVzIGZvciBlYWNoIHNjYWxlZmFjdG9yIGJhbmQuXG4gYmxvY2sgdHlwZSwgUEUsIGFuZCBzb21lIGNvcnJlbGF0aW9uIG1lYXN1cmVzLlxuIFRoZSBQRSBpcyB1c2VkIGJ5IENCUiBtb2RlcyB0byBkZXRlcm1pbmUgaWYgZXh0cmEgYml0c1xuIGZyb20gdGhlIGJpdCByZXNlcnZvaXIgc2hvdWxkIGJlIHVzZWQuICBUaGUgY29ycmVsYXRpb25cbiBtZWFzdXJlcyBhcmUgdXNlZCB0byBkZXRlcm1pbmUgbWlkL3NpZGUgb3IgcmVndWxhciBzdGVyZW8uXG4gKi9cbi8qXG4gTm90YXRpb246XG5cbiBiYXJrczogIGEgbm9uLWxpbmVhciBmcmVxdWVuY3kgc2NhbGUuICBNYXBwaW5nIGZyb20gZnJlcXVlbmN5IHRvXG4gYmFya3MgaXMgZ2l2ZW4gYnkgZnJlcTJiYXJrKClcblxuIHNjYWxlZmFjdG9yIGJhbmRzOiBUaGUgc3BlY3RydW0gKGZyZXF1ZW5jaWVzKSBhcmUgYnJva2VuIGludG9cbiBTQk1BWCBcInNjYWxlZmFjdG9yIGJhbmRzXCIuICBUaGVzIGJhbmRzXG4gYXJlIGRldGVybWluZWQgYnkgdGhlIE1QRUcgSVNPIHNwZWMuICBJblxuIHRoZSBub2lzZSBzaGFwaW5nL3F1YW50aXphdGlvbiBjb2RlLCB3ZSBhbGxvY2F0ZVxuIGJpdHMgYW1vbmcgdGhlIHBhcnRpdGlvbiBiYW5kcyB0byBhY2hpZXZlIHRoZVxuIGJlc3QgcG9zc2libGUgcXVhbGl0eVxuXG4gcGFydGl0aW9uIGJhbmRzOiAgIFRoZSBzcGVjdHJ1bSBpcyBhbHNvIGJyb2tlbiBpbnRvIGFib3V0XG4gNjQgXCJwYXJ0aXRpb24gYmFuZHNcIi4gIEVhY2ggcGFydGl0aW9uXG4gYmFuZCBpcyBhYm91dCAuMzQgYmFya3Mgd2lkZS4gIFRoZXJlIGFyZSBhYm91dCAyLTVcbiBwYXJ0aXRpb24gYmFuZHMgZm9yIGVhY2ggc2NhbGVmYWN0b3IgYmFuZC5cblxuIExBTUUgY29tcHV0ZXMgYWxsIHBzeWNobyBhY291c3RpYyBpbmZvcm1hdGlvbiBmb3IgZWFjaCBwYXJ0aXRpb25cbiBiYW5kLiAgVGhlbiBhdCB0aGUgZW5kIG9mIHRoZSBjb21wdXRhdGlvbnMsIHRoaXMgaW5mb3JtYXRpb25cbiBpcyBtYXBwZWQgdG8gc2NhbGVmYWN0b3IgYmFuZHMuICBUaGUgZW5lcmd5IGluIGVhY2ggc2NhbGVmYWN0b3JcbiBiYW5kIGlzIHRha2VuIGFzIHRoZSBzdW0gb2YgdGhlIGVuZXJneSBpbiBhbGwgcGFydGl0aW9uIGJhbmRzXG4gd2hpY2ggb3ZlcmxhcCB0aGUgc2NhbGVmYWN0b3IgYmFuZC4gIFRoZSBtYXNraW5ncyBjYW4gYmUgY29tcHV0ZWRcbiBpbiB0aGUgc2FtZSB3YXkgKGFuZCB0aHVzIHJlcHJlc2VudCB0aGUgYXZlcmFnZSBtYXNraW5nIGluIHRoYXQgYmFuZClcbiBvciBieSB0YWtpbmcgdGhlIG1pbm11bSB2YWx1ZSBtdWx0aXBsaWVkIGJ5IHRoZSBudW1iZXIgb2ZcbiBwYXJ0aXRpb24gYmFuZHMgdXNlZCAod2hpY2ggcmVwcmVzZW50cyBhIG1pbmltdW0gbWFza2luZyBpbiB0aGF0IGJhbmQpLlxuICovXG4vKlxuIFRoZSBnZW5lcmFsIG91dGxpbmUgaXMgYXMgZm9sbG93czpcblxuIDEuIGNvbXB1dGUgdGhlIGVuZXJneSBpbiBlYWNoIHBhcnRpdGlvbiBiYW5kXG4gMi4gY29tcHV0ZSB0aGUgdG9uYWxpdHkgaW4gZWFjaCBwYXJ0aXRpb24gYmFuZFxuIDMuIGNvbXB1dGUgdGhlIHN0cmVuZ3RoIG9mIGVhY2ggcGFydGlvbiBiYW5kIFwibWFza2VyXCJcbiA0LiBjb21wdXRlIHRoZSBtYXNraW5nICh2aWEgdGhlIHNwcmVhZGluZyBmdW5jdGlvbiBhcHBsaWVkIHRvIGVhY2ggbWFza2VyKVxuIDUuIE1vZGlmaWNhdGlvbnMgZm9yIG1pZC9zaWRlIG1hc2tpbmcuXG5cbiBFYWNoIHBhcnRpdGlvbiBiYW5kIGlzIGNvbnNpZGllcmVkIGEgXCJtYXNrZXJcIi4gIFRoZSBzdHJlbmd0aFxuIG9mIHRoZSBpJ3RoIG1hc2tlciBpbiBiYW5kIGogaXMgZ2l2ZW4gYnk6XG5cbiBzMyhiYXJrKGkpLWJhcmsoaikpKnN0cmVuZ3RoKGkpXG5cbiBUaGUgc3RyZW5ndGggb2YgdGhlIG1hc2tlciBpcyBhIGZ1bmN0aW9uIG9mIHRoZSBlbmVyZ3kgYW5kIHRvbmFsaXR5LlxuIFRoZSBtb3JlIHRvbmFsLCB0aGUgbGVzcyBtYXNraW5nLiAgTEFNRSB1c2VzIGEgc2ltcGxlIGxpbmVhciBmb3JtdWxhXG4gKGNvbnRyb2xsZWQgYnkgTk1UIGFuZCBUTU4pIHdoaWNoIHNheXMgdGhlIHN0cmVuZ3RoIGlzIGdpdmVuIGJ5IHRoZVxuIGVuZXJneSBkaXZpZGVkIGJ5IGEgbGluZWFyIGZ1bmN0aW9uIG9mIHRoZSB0b25hbGl0eS5cbiAqL1xuLypcbiBzMygpIGlzIHRoZSBcInNwcmVhZGluZyBmdW5jdGlvblwiLiAgSXQgaXMgZ2l2ZW4gYnkgYSBmb3JtdWxhXG4gZGV0ZXJtaW5lZCB2aWEgbGlzdGVuaW5nIHRlc3RzLlxuXG4gVGhlIHRvdGFsIG1hc2tpbmcgaW4gdGhlIGondGggcGFydGl0aW9uIGJhbmQgaXMgdGhlIHN1bSBvdmVyXG4gYWxsIG1hc2tpbmdzIGkuICBJdCBpcyB0aHVzIGdpdmVuIGJ5IHRoZSBjb252b2x1dGlvbiBvZlxuIHRoZSBzdHJlbmd0aCB3aXRoIHMzKCksIHRoZSBcInNwcmVhZGluZyBmdW5jdGlvbi5cIlxuXG4gbWFza2luZyhqKSA9IHN1bV9vdmVyX2kgIHMzKGktaikqc3RyZW5ndGgoaSkgID0gczMgbyBzdHJlbmd0aFxuXG4gd2hlcmUgXCJvXCIgPSBjb252b2x1dGlvbiBvcGVyYXRvci4gIHMzIGlzIGdpdmVuIGJ5IGEgZm9ybXVsYSBkZXRlcm1pbmVkXG4gdmlhIGxpc3RlbmluZyB0ZXN0cy4gIEl0IGlzIG5vcm1hbGl6ZWQgc28gdGhhdCBzMyBvIDEgPSAxLlxuXG4gTm90ZTogaW5zdGVhZCBvZiBhIHNpbXBsZSBjb252b2x1dGlvbiwgTEFNRSBhbHNvIGhhcyB0aGVcbiBvcHRpb24gb2YgdXNpbmcgXCJhZGRpdGl2ZSBtYXNraW5nXCJcblxuIFRoZSBtb3N0IGNyaXRpY2FsIHBhcnQgaXMgc3RlcCAyLCBjb21wdXRpbmcgdGhlIHRvbmFsaXR5IG9mIGVhY2hcbiBwYXJ0aXRpb24gYmFuZC4gIExBTUUgaGFzIHR3byB0b25hbGl0eSBlc3RpbWF0b3JzLiAgVGhlIGZpcnN0XG4gaXMgYmFzZWQgb24gdGhlIElTTyBzcGVjLCBhbmQgbWVhc3VyZXMgaG93IHByZWRpY3RpYWJsZSB0aGVcbiBzaWduYWwgaXMgb3ZlciB0aW1lLiAgVGhlIG1vcmUgcHJlZGljdGFibGUsIHRoZSBtb3JlIHRvbmFsLlxuIFRoZSBzZWNvbmQgbWVhc3VyZSBpcyBiYXNlZCBvbiBsb29raW5nIGF0IHRoZSBzcGVjdHJ1bSBvZlxuIGEgc2luZ2xlIGdyYW51bGUuICBUaGUgbW9yZSBwZWFreSB0aGUgc3BlY3RydW0sIHRoZSBtb3JlXG4gdG9uYWwuICBCeSBtb3N0IGluZGljYXRpb25zLCB0aGUgbGF0dGVyIGFwcHJvYWNoIGlzIGJldHRlci5cblxuIEZpbmFsbHksIGluIHN0ZXAgNSwgdGhlIG1hc2tpbmdzIGZvciB0aGUgbWlkIGFuZCBzaWRlXG4gY2hhbm5lbCBhcmUgcG9zc2libHkgaW5jcmVhc2VkLiAgVW5kZXIgY2VydGFpbiBjaXJjdW1zdGFuY2VzLFxuIG5vaXNlIGluIHRoZSBtaWQgJiBzaWRlIGNoYW5uZWxzIGlzIGFzc3VtZWQgdG8gYWxzb1xuIGJlIG1hc2tlZCBieSBzdHJvbmcgbWFza2VycyBpbiB0aGUgTCBvciBSIGNoYW5uZWxzLlxuXG5cbiBPdGhlciBkYXRhIGNvbXB1dGVkIGJ5IHRoZSBwc3ktbW9kZWw6XG5cbiBtc19yYXRpbyAgICAgICAgc2lkZS1jaGFubmVsIC8gbWlkLWNoYW5uZWwgbWFza2luZyByYXRpbyAoZm9yIHByZXZpb3VzIGdyYW51bGUpXG4gbXNfcmF0aW9fbmV4dCAgIHNpZGUtY2hhbm5lbCAvIG1pZC1jaGFubmVsIG1hc2tpbmcgcmF0aW8gZm9yIHRoaXMgZ3JhbnVsZVxuXG4gcGVyY2VwX2VudHJvcHlbMl0gICAgIEwgYW5kIFIgdmFsdWVzIChwcmV2IGdyYW51bGUpIG9mIFBFIC0gQSBtZWFzdXJlIG9mIGhvd1xuIG11Y2ggcHJlLWVjaG8gaXMgaW4gdGhlIHByZXZpb3VzIGdyYW51bGVcbiBwZXJjZXBfZW50cm9weV9NU1syXSAgbWlkIGFuZCBzaWRlIGNoYW5uZWwgdmFsdWVzIChwcmV2IGdyYW51bGUpIG9mIHBlcmNlcF9lbnRyb3B5XG4gZW5lcmd5WzRdICAgICAgICAgICAgIEwsUixNLFMgZW5lcmd5IGluIGVhY2ggY2hhbm5lbCwgcHJldiBncmFudWxlXG4gYmxvY2t0eXBlX2RbMl0gICAgICAgIGJsb2NrIHR5cGUgdG8gdXNlIGZvciBwcmV2aW91cyBncmFudWxlXG4gKi9cbi8vcGFja2FnZSBtcDM7XG5cbi8vaW1wb3J0IGphdmEudXRpbC5BcnJheXM7XG5cblxuZnVuY3Rpb24gUHN5TW9kZWwoKSB7XG5cbiAgICB2YXIgZmZ0ID0gbmV3IEZGVCgpO1xuXG4gICAgdmFyIExPRzEwID0gMi4zMDI1ODUwOTI5OTQwNDU2ODQwMjtcblxuICAgIHZhciBycGVsZXYgPSAyO1xuICAgIHZhciBycGVsZXYyID0gMTY7XG4gICAgdmFyIHJwZWxldl9zID0gMjtcbiAgICB2YXIgcnBlbGV2Ml9zID0gMTY7XG5cbiAgICAvKiBzaXplIG9mIGVhY2ggcGFydGl0aW9uIGJhbmQsIGluIGJhcmtzOiAqL1xuICAgIHZhciBERUxCQVJLID0gLjM0O1xuXG4gICAgLyogdHVuZWQgZm9yIG91dHB1dCBsZXZlbCAoc2Vuc2l0aXZlIHRvIGVuZXJneSBzY2FsZSkgKi9cbiAgICB2YXIgVk9fU0NBTEUgPSAoMS4gLyAoMTQ3NTIgKiAxNDc1MikgLyAoRW5jb2Rlci5CTEtTSVpFIC8gMikpO1xuXG4gICAgdmFyIHRlbXBvcmFsbWFza19zdXN0YWluX3NlYyA9IDAuMDE7XG5cbiAgICB2YXIgTlNfUFJFRUNIT19BVFQwID0gMC44O1xuICAgIHZhciBOU19QUkVFQ0hPX0FUVDEgPSAwLjY7XG4gICAgdmFyIE5TX1BSRUVDSE9fQVRUMiA9IDAuMztcblxuICAgIHZhciBOU19NU0ZJWCA9IDMuNTtcblxuICAgIHZhciBOU0FUVEFDS1RIUkUgPSA0LjQ7XG4gICAgdmFyIE5TQVRUQUNLVEhSRV9TID0gMjU7XG5cbiAgICB2YXIgTlNGSVJMRU4gPSAyMTtcblxuICAgIC8qIHNpemUgb2YgZWFjaCBwYXJ0aXRpb24gYmFuZCwgaW4gYmFya3M6ICovXG4gICAgdmFyIExOX1RPX0xPRzEwID0gMC4yMzAyNTg1MDkzO1xuXG4gICAgZnVuY3Rpb24gTk9OX0xJTkVBUl9TQ0FMRV9FTkVSR1koeCkge1xuICAgICAgICByZXR1cm4geDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiA8UFJFPlxuICAgICAqICAgICAgIEwzcHN5Y2hvX2FuYWwuICBDb21wdXRlIHBzeWNobyBhY291c3RpY3MuXG4gICAgICpcbiAgICAgKiAgICAgICBEYXRhIHJldHVybmVkIHRvIHRoZSBjYWxsaW5nIHByb2dyYW0gbXVzdCBiZSBkZWxheWVkIGJ5IG9uZVxuICAgICAqICAgICAgIGdyYW51bGUuXG4gICAgICpcbiAgICAgKiAgICAgICBUaGlzIGlzIGRvbmUgaW4gdHdvIHBsYWNlcy5cbiAgICAgKiAgICAgICBJZiB3ZSBkbyBub3QgbmVlZCB0byBrbm93IHRoZSBibG9ja3R5cGUsIHRoZSBjb3B5aW5nXG4gICAgICogICAgICAgY2FuIGJlIGRvbmUgaGVyZSBhdCB0aGUgdG9wIG9mIHRoZSBwcm9ncmFtOiB3ZSBjb3B5IHRoZSBkYXRhIGZvclxuICAgICAqICAgICAgIHRoZSBsYXN0IGdyYW51bGUgKGNvbXB1dGVkIGR1cmluZyB0aGUgbGFzdCBjYWxsKSBiZWZvcmUgaXQgaXNcbiAgICAgKiAgICAgICBvdmVyd3JpdHRlbiB3aXRoIHRoZSBuZXcgZGF0YS4gIEl0IGxvb2tzIGxpa2UgdGhpczpcbiAgICAgKlxuICAgICAqICAgICAgIDAuIHN0YXRpYyBwc3ltb2RlbF9kYXRhXG4gICAgICogICAgICAgMS4gY2FsbGluZ19wcm9ncmFtX2RhdGEgPSBwc3ltb2RlbF9kYXRhXG4gICAgICogICAgICAgMi4gY29tcHV0ZSBwc3ltb2RlbF9kYXRhXG4gICAgICpcbiAgICAgKiAgICAgICBGb3IgZGF0YSB3aGljaCBuZWVkcyB0byBrbm93IHRoZSBibG9ja3R5cGUsIHRoZSBjb3B5aW5nIG11c3QgYmVcbiAgICAgKiAgICAgICBkb25lIGF0IHRoZSBlbmQgb2YgdGhpcyBsb29wLCBhbmQgdGhlIG9sZCB2YWx1ZXMgbXVzdCBiZSBzYXZlZDpcbiAgICAgKlxuICAgICAqICAgICAgIDAuIHN0YXRpYyBwc3ltb2RlbF9kYXRhX29sZFxuICAgICAqICAgICAgIDEuIGNvbXB1dGUgcHN5bW9kZWxfZGF0YVxuICAgICAqICAgICAgIDIuIGNvbXB1dGUgcG9zc2libGUgYmxvY2sgdHlwZSBvZiB0aGlzIGdyYW51bGVcbiAgICAgKiAgICAgICAzLiBjb21wdXRlIGZpbmFsIGJsb2NrIHR5cGUgb2YgcHJldmlvdXMgZ3JhbnVsZSBiYXNlZCBvbiAjMi5cbiAgICAgKiAgICAgICA0LiBjYWxsaW5nX3Byb2dyYW1fZGF0YSA9IHBzeW1vZGVsX2RhdGFfb2xkXG4gICAgICogICAgICAgNS4gcHN5bW9kZWxfZGF0YV9vbGQgPSBwc3ltb2RlbF9kYXRhXG4gICAgICogICAgIHBzeWNob19sb3VkbmVzc19hcHByb3hcbiAgICAgKiAgICAgICBqZCAtIDIwMDEgbWFyIDEyXG4gICAgICogICAgaW46ICBlbmVyZ3kgICAtIEJMS1NJWkUvMiBlbGVtZW50cyBvZiBmcmVxdWVuY3kgbWFnbml0dWRlcyBeIDJcbiAgICAgKiAgICAgICAgIGdmcCAgICAgIC0gdXNlcyBvdXRfc2FtcGxlcmF0ZSwgQVRIdHlwZSAoYWxzbyBuZWVkZWQgZm9yIEFUSGZvcm11bGEpXG4gICAgICogICAgcmV0dXJuczogbG91ZG5lc3NeMiBhcHByb3hpbWF0aW9uLCBhIHBvc2l0aXZlIHZhbHVlIHJvdWdobHkgdHVuZWQgZm9yIGEgdmFsdWVcbiAgICAgKiAgICAgICAgICAgICBvZiAxLjAgZm9yIHNpZ25hbHMgbmVhciBjbGlwcGluZy5cbiAgICAgKiAgICBub3RlczogICBXaGVuIGNhbGlicmF0ZWQsIGZlZWRpbmcgdGhpcyBmdW5jdGlvbiBiaW5hcnkgd2hpdGUgbm9pc2UgYXQgc2FtcGxlXG4gICAgICogICAgICAgICAgICAgdmFsdWVzICszMjc2NyBvciAtMzI3Njggc2hvdWxkIHJldHVybiB2YWx1ZXMgdGhhdCBhcHByb2FjaCAzLlxuICAgICAqICAgICAgICAgICAgIEFUSGZvcm11bGEgaXMgdXNlZCB0byBhcHByb3hpbWF0ZSBhbiBlcXVhbCBsb3VkbmVzcyBjdXJ2ZS5cbiAgICAgKiAgICBmdXR1cmU6ICBEYXRhIGluZGljYXRlcyB0aGF0IHRoZSBzaGFwZSBvZiB0aGUgZXF1YWwgbG91ZG5lc3MgY3VydmUgdmFyaWVzXG4gICAgICogICAgICAgICAgICAgd2l0aCBpbnRlbnNpdHkuICBUaGlzIGZ1bmN0aW9uIG1pZ2h0IGJlIGltcHJvdmVkIGJ5IHVzaW5nIGFuIGVxdWFsXG4gICAgICogICAgICAgICAgICAgbG91ZG5lc3MgY3VydmUgc2hhcGVkIGZvciB0eXBpY2FsIHBsYXliYWNrIGxldmVscyAoaW5zdGVhZCBvZiB0aGVcbiAgICAgKiAgICAgICAgICAgICBBVEgsIHRoYXQgaXMgc2hhcGVkIGZvciB0aGUgdGhyZXNob2xkKS4gIEEgZmxleGlibGUgcmVhbGl6YXRpb24gbWlnaHRcbiAgICAgKiAgICAgICAgICAgICBzaW1wbHkgYmVuZCB0aGUgZXhpc3RpbmcgQVRIIGN1cnZlIHRvIGFjaGlldmUgdGhlIGRlc2lyZWQgc2hhcGUuXG4gICAgICogICAgICAgICAgICAgSG93ZXZlciwgdGhlIHBvdGVudGlhbCBnYWluIG1heSBub3QgYmUgZW5vdWdoIHRvIGp1c3RpZnkgYW4gZWZmb3J0LlxuICAgICAqIDwvUFJFPlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHBzeWNob19sb3VkbmVzc19hcHByb3goZW5lcmd5LCBnZmMpIHtcbiAgICAgICAgdmFyIGxvdWRuZXNzX3Bvd2VyID0gMC4wO1xuICAgICAgICAvKiBhcHBseSB3ZWlnaHRzIHRvIHBvd2VyIGluIGZyZXEuIGJhbmRzICovXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgRW5jb2Rlci5CTEtTSVpFIC8gMjsgKytpKVxuICAgICAgICAgICAgbG91ZG5lc3NfcG93ZXIgKz0gZW5lcmd5W2ldICogZ2ZjLkFUSC5lcWxfd1tpXTtcbiAgICAgICAgbG91ZG5lc3NfcG93ZXIgKj0gVk9fU0NBTEU7XG5cbiAgICAgICAgcmV0dXJuIGxvdWRuZXNzX3Bvd2VyO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNvbXB1dGVfZmZ0cyhnZnAsIGZmdGVuZXJneSwgZmZ0ZW5lcmd5X3MsIHdzYW1wX2wsIHdzYW1wX2xQb3MsIHdzYW1wX3MsIHdzYW1wX3NQb3MsIGdyX291dCwgY2huLCBidWZmZXIsIGJ1ZlBvcykge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICBpZiAoY2huIDwgMikge1xuICAgICAgICAgICAgZmZ0LmZmdF9sb25nKGdmYywgd3NhbXBfbFt3c2FtcF9sUG9zXSwgY2huLCBidWZmZXIsIGJ1ZlBvcyk7XG4gICAgICAgICAgICBmZnQuZmZ0X3Nob3J0KGdmYywgd3NhbXBfc1t3c2FtcF9zUG9zXSwgY2huLCBidWZmZXIsIGJ1ZlBvcyk7XG4gICAgICAgIH1cbiAgICAgICAgLyogRkZUIGRhdGEgZm9yIG1pZCBhbmQgc2lkZSBjaGFubmVsIGlzIGRlcml2ZWQgZnJvbSBMICYgUiAqL1xuICAgICAgICBlbHNlIGlmIChjaG4gPT0gMikge1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IEVuY29kZXIuQkxLU0laRSAtIDE7IGogPj0gMDsgLS1qKSB7XG4gICAgICAgICAgICAgICAgdmFyIGwgPSB3c2FtcF9sW3dzYW1wX2xQb3MgKyAwXVtqXTtcbiAgICAgICAgICAgICAgICB2YXIgciA9IHdzYW1wX2xbd3NhbXBfbFBvcyArIDFdW2pdO1xuICAgICAgICAgICAgICAgIHdzYW1wX2xbd3NhbXBfbFBvcyArIDBdW2pdID0gKGwgKyByKSAqIFV0aWwuU1FSVDIgKiAwLjU7XG4gICAgICAgICAgICAgICAgd3NhbXBfbFt3c2FtcF9sUG9zICsgMV1bal0gPSAobCAtIHIpICogVXRpbC5TUVJUMiAqIDAuNTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGIgPSAyOyBiID49IDA7IC0tYikge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSBFbmNvZGVyLkJMS1NJWkVfcyAtIDE7IGogPj0gMDsgLS1qKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsID0gd3NhbXBfc1t3c2FtcF9zUG9zICsgMF1bYl1bal07XG4gICAgICAgICAgICAgICAgICAgIHZhciByID0gd3NhbXBfc1t3c2FtcF9zUG9zICsgMV1bYl1bal07XG4gICAgICAgICAgICAgICAgICAgIHdzYW1wX3Nbd3NhbXBfc1BvcyArIDBdW2JdW2pdID0gKGwgKyByKSAqIFV0aWwuU1FSVDIgKiAwLjU7XG4gICAgICAgICAgICAgICAgICAgIHdzYW1wX3Nbd3NhbXBfc1BvcyArIDFdW2JdW2pdID0gKGwgLSByKSAqIFV0aWwuU1FSVDIgKiAwLjU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBjb21wdXRlIGVuZXJnaWVzXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIGZmdGVuZXJneVswXSA9IE5PTl9MSU5FQVJfU0NBTEVfRU5FUkdZKHdzYW1wX2xbd3NhbXBfbFBvcyArIDBdWzBdKTtcbiAgICAgICAgZmZ0ZW5lcmd5WzBdICo9IGZmdGVuZXJneVswXTtcblxuICAgICAgICBmb3IgKHZhciBqID0gRW5jb2Rlci5CTEtTSVpFIC8gMiAtIDE7IGogPj0gMDsgLS1qKSB7XG4gICAgICAgICAgICB2YXIgcmUgPSAod3NhbXBfbFt3c2FtcF9sUG9zICsgMF0pW0VuY29kZXIuQkxLU0laRSAvIDIgLSBqXTtcbiAgICAgICAgICAgIHZhciBpbSA9ICh3c2FtcF9sW3dzYW1wX2xQb3MgKyAwXSlbRW5jb2Rlci5CTEtTSVpFIC8gMiArIGpdO1xuICAgICAgICAgICAgZmZ0ZW5lcmd5W0VuY29kZXIuQkxLU0laRSAvIDIgLSBqXSA9IE5PTl9MSU5FQVJfU0NBTEVfRU5FUkdZKChyZVxuICAgICAgICAgICAgICAgICogcmUgKyBpbSAqIGltKSAqIDAuNSk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgYiA9IDI7IGIgPj0gMDsgLS1iKSB7XG4gICAgICAgICAgICBmZnRlbmVyZ3lfc1tiXVswXSA9ICh3c2FtcF9zW3dzYW1wX3NQb3MgKyAwXSlbYl1bMF07XG4gICAgICAgICAgICBmZnRlbmVyZ3lfc1tiXVswXSAqPSBmZnRlbmVyZ3lfc1tiXVswXTtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSBFbmNvZGVyLkJMS1NJWkVfcyAvIDIgLSAxOyBqID49IDA7IC0taikge1xuICAgICAgICAgICAgICAgIHZhciByZSA9ICh3c2FtcF9zW3dzYW1wX3NQb3MgKyAwXSlbYl1bRW5jb2Rlci5CTEtTSVpFX3NcbiAgICAgICAgICAgICAgICAvIDIgLSBqXTtcbiAgICAgICAgICAgICAgICB2YXIgaW0gPSAod3NhbXBfc1t3c2FtcF9zUG9zICsgMF0pW2JdW0VuY29kZXIuQkxLU0laRV9zXG4gICAgICAgICAgICAgICAgLyAyICsgal07XG4gICAgICAgICAgICAgICAgZmZ0ZW5lcmd5X3NbYl1bRW5jb2Rlci5CTEtTSVpFX3MgLyAyIC0gal0gPSBOT05fTElORUFSX1NDQUxFX0VORVJHWSgocmVcbiAgICAgICAgICAgICAgICAgICAgKiByZSArIGltICogaW0pICogMC41KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiB0b3RhbCBlbmVyZ3kgKi9cbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIHRvdGFsZW5lcmd5ID0gMC4wO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDExOyBqIDwgRW5jb2Rlci5IQkxLU0laRTsgaisrKVxuICAgICAgICAgICAgICAgIHRvdGFsZW5lcmd5ICs9IGZmdGVuZXJneVtqXTtcblxuICAgICAgICAgICAgZ2ZjLnRvdF9lbmVyW2Nobl0gPSB0b3RhbGVuZXJneTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChnZnAuYW5hbHlzaXMpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgRW5jb2Rlci5IQkxLU0laRTsgaisrKSB7XG4gICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLmVuZXJneVtncl9vdXRdW2Nobl1bal0gPSBnZmMucGluZm8uZW5lcmd5X3NhdmVbY2huXVtqXTtcbiAgICAgICAgICAgICAgICBnZmMucGluZm8uZW5lcmd5X3NhdmVbY2huXVtqXSA9IGZmdGVuZXJneVtqXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy5waW5mby5wZVtncl9vdXRdW2Nobl0gPSBnZmMucGVbY2huXTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogY29tcHV0ZSBsb3VkbmVzcyBhcHByb3hpbWF0aW9uICh1c2VkIGZvciBBVEggYXV0by1sZXZlbCBhZGp1c3RtZW50KVxuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICBpZiAoZ2ZwLmF0aGFhX2xvdWRhcHByb3ggPT0gMiAmJiBjaG4gPCAyKSB7XG4gICAgICAgICAgICAvLyBubyBsb3VkbmVzcyBmb3IgbWlkL3NpZGUgY2hcbiAgICAgICAgICAgIGdmYy5sb3VkbmVzc19zcVtncl9vdXRdW2Nobl0gPSBnZmMubG91ZG5lc3Nfc3Ffc2F2ZVtjaG5dO1xuICAgICAgICAgICAgZ2ZjLmxvdWRuZXNzX3NxX3NhdmVbY2huXSA9IHBzeWNob19sb3VkbmVzc19hcHByb3goZmZ0ZW5lcmd5LCBnZmMpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyogbWFza19hZGQgb3B0aW1pemF0aW9uICovXG4gICAgLyogaW5pdCB0aGUgbGltaXQgdmFsdWVzIHVzZWQgdG8gYXZvaWQgY29tcHV0aW5nIGxvZyBpbiBtYXNrX2FkZCB3aGVuIGl0IGlzIG5vdCBuZWNlc3NhcnkgKi9cblxuICAgIC8qKlxuICAgICAqIDxQUkU+XG4gICAgICogIEZvciBleGFtcGxlLCB3aXRoIGkgPSAxMCpsb2cxMChtMi9tMSkvMTAqMTYgICAgICAgICAoPSBsb2cxMChtMi9tMSkqMTYpXG4gICAgICpcbiAgICAgKiBhYnMoaSk+OCBpcyBlcXVpdmFsZW50IChhcyBpIGlzIGFuIGludGVnZXIpIHRvXG4gICAgICogYWJzKGkpPj05XG4gICAgICogaT49OSB8fCBpPD0tOVxuICAgICAqIGVxdWl2YWxlbnQgdG8gKGFzIGkgaXMgdGhlIGJpZ2dlc3QgaW50ZWdlciBzbWFsbGVyIHRoYW4gbG9nMTAobTIvbTEpKjE2XG4gICAgICogb3IgdGhlIHNtYWxsZXN0IGludGVnZXIgYmlnZ2VyIHRoYW4gbG9nMTAobTIvbTEpKjE2IGRlcGVuZGluZyBvbiB0aGUgc2lnbiBvZiBsb2cxMChtMi9tMSkqMTYpXG4gICAgICogbG9nMTAobTIvbTEpPj05LzE2IHx8IGxvZzEwKG0yL20xKTw9LTkvMTZcbiAgICAgKiBleHAxMCBpcyBzdHJpY3RseSBpbmNyZWFzaW5nIHRodXMgdGhpcyBpcyBlcXVpdmFsZW50IHRvXG4gICAgICogbTIvbTEgPj0gMTBeKDkvMTYpIHx8IG0yL20xPD0xMF4oLTkvMTYpIHdoaWNoIGFyZSBjb21wYXJpc29ucyB0byBjb25zdGFudHNcbiAgICAgKiA8L1BSRT5cbiAgICAgKi9cblxuICAgIC8qKlxuICAgICAqIGFzIGluIGlmKGk+OClcbiAgICAgKi9cbiAgICB2YXIgSTFMSU1JVCA9IDg7XG4gICAgLyoqXG4gICAgICogYXMgaW4gaWYoaT4yNCkgLiBjaGFuZ2VkIDIzXG4gICAgICovXG4gICAgdmFyIEkyTElNSVQgPSAyMztcbiAgICAvKipcbiAgICAgKiBhcyBpbiBpZihtPDE1KVxuICAgICAqL1xuICAgIHZhciBNTElNSVQgPSAxNTtcblxuICAgIHZhciBtYV9tYXhfaTE7XG4gICAgdmFyIG1hX21heF9pMjtcbiAgICB2YXIgbWFfbWF4X207XG5cbiAgICAvKipcbiAgICAgKiBUaGlzIGlzIHRoZSBtYXNraW5nIHRhYmxlOjxCUj5cbiAgICAgKiBBY2NvcmRpbmcgdG8gdG9uYWxpdHksIHZhbHVlcyBhcmUgZ29pbmcgZnJvbSAwZEIgKFRNTikgdG8gOS4zZEIgKE5NVCkuPEJSPlxuICAgICAqIEFmdGVyIGFkZGl0aXZlIG1hc2tpbmcgY29tcHV0YXRpb24sIDhkQiBhcmUgYWRkZWQsIHNvIGZpbmFsIHZhbHVlcyBhcmVcbiAgICAgKiBnb2luZyBmcm9tIDhkQiB0byAxNy4zZEJcbiAgICAgKlxuICAgICAqIHBvdygxMCwgLTAuMC4uLTAuNilcbiAgICAgKi9cbiAgICB2YXIgdGFiID0gWzEuMCwgMC43OTQzMywgMC42MzA5NiwgMC42MzA5NixcbiAgICAgICAgMC42MzA5NiwgMC42MzA5NiwgMC42MzA5NiwgMC4yNTExOSwgMC4xMTc0OV07XG5cbiAgICBmdW5jdGlvbiBpbml0X21hc2tfYWRkX21heF92YWx1ZXMoKSB7XG4gICAgICAgIG1hX21heF9pMSA9IE1hdGgucG93KDEwLCAoSTFMSU1JVCArIDEpIC8gMTYuMCk7XG4gICAgICAgIG1hX21heF9pMiA9IE1hdGgucG93KDEwLCAoSTJMSU1JVCArIDEpIC8gMTYuMCk7XG4gICAgICAgIG1hX21heF9tID0gTWF0aC5wb3coMTAsIChNTElNSVQpIC8gMTAuMCk7XG4gICAgfVxuXG4gICAgdmFyIHRhYmxlMSA9IFszLjMyNDYgKiAzLjMyNDYsXG4gICAgICAgIDMuMjM4MzcgKiAzLjIzODM3LCAzLjE1NDM3ICogMy4xNTQzNywgMy4wMDQxMiAqIDMuMDA0MTIsXG4gICAgICAgIDIuODYxMDMgKiAyLjg2MTAzLCAyLjY1NDA3ICogMi42NTQwNywgMi40NjIwOSAqIDIuNDYyMDksXG4gICAgICAgIDIuMjg0ICogMi4yODQsIDIuMTE4NzkgKiAyLjExODc5LCAxLjk2NTUyICogMS45NjU1MixcbiAgICAgICAgMS44MjMzNSAqIDEuODIzMzUsIDEuNjkxNDYgKiAxLjY5MTQ2LCAxLjU2OTExICogMS41NjkxMSxcbiAgICAgICAgMS40NjY1OCAqIDEuNDY2NTgsIDEuMzcwNzQgKiAxLjM3MDc0LCAxLjMxMDM2ICogMS4zMTAzNixcbiAgICAgICAgMS4yNTI2NCAqIDEuMjUyNjQsIDEuMjA2NDggKiAxLjIwNjQ4LCAxLjE2MjAzICogMS4xNjIwMyxcbiAgICAgICAgMS4xMjc2NSAqIDEuMTI3NjUsIDEuMDk0MjggKiAxLjA5NDI4LCAxLjA2NTkgKiAxLjA2NTksXG4gICAgICAgIDEuMDM4MjYgKiAxLjAzODI2LCAxLjAxODk1ICogMS4wMTg5NSwgMV07XG5cbiAgICB2YXIgdGFibGUyID0gWzEuMzMzNTIgKiAxLjMzMzUyLFxuICAgICAgICAxLjM1ODc5ICogMS4zNTg3OSwgMS4zODQ1NCAqIDEuMzg0NTQsIDEuMzk0OTcgKiAxLjM5NDk3LFxuICAgICAgICAxLjQwNTQ4ICogMS40MDU0OCwgMS4zNTM3ICogMS4zNTM3LCAxLjMwMzgyICogMS4zMDM4MixcbiAgICAgICAgMS4yMjMyMSAqIDEuMjIzMjEsIDEuMTQ3NTggKiAxLjE0NzU4LCAxXTtcblxuICAgIHZhciB0YWJsZTMgPSBbMi4zNTM2NCAqIDIuMzUzNjQsXG4gICAgICAgIDIuMjkyNTkgKiAyLjI5MjU5LCAyLjIzMzEzICogMi4yMzMxMywgMi4xMjY3NSAqIDIuMTI2NzUsXG4gICAgICAgIDIuMDI1NDUgKiAyLjAyNTQ1LCAxLjg3ODk0ICogMS44Nzg5NCwgMS43NDMwMyAqIDEuNzQzMDMsXG4gICAgICAgIDEuNjE2OTUgKiAxLjYxNjk1LCAxLjQ5OTk5ICogMS40OTk5OSwgMS4zOTE0OCAqIDEuMzkxNDgsXG4gICAgICAgIDEuMjkwODMgKiAxLjI5MDgzLCAxLjE5NzQ2ICogMS4xOTc0NiwgMS4xMTA4NCAqIDEuMTEwODQsXG4gICAgICAgIDEuMDM4MjYgKiAxLjAzODI2XTtcblxuICAgIC8qKlxuICAgICAqIGFkZGl0aW9uIG9mIHNpbXVsdGFuZW91cyBtYXNraW5nIE5hb2tpIFNoaWJhdGEgMjAwMC83XG4gICAgICovXG4gICAgZnVuY3Rpb24gbWFza19hZGQobTEsIG0yLCBraywgYiwgZ2ZjLCBzaG9ydGJsb2NrKSB7XG4gICAgICAgIHZhciByYXRpbztcblxuICAgICAgICBpZiAobTIgPiBtMSkge1xuICAgICAgICAgICAgaWYgKG0yIDwgKG0xICogbWFfbWF4X2kyKSlcbiAgICAgICAgICAgICAgICByYXRpbyA9IG0yIC8gbTE7XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgcmV0dXJuIChtMSArIG0yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmIChtMSA+PSAobTIgKiBtYV9tYXhfaTIpKVxuICAgICAgICAgICAgICAgIHJldHVybiAobTEgKyBtMik7XG4gICAgICAgICAgICByYXRpbyA9IG0xIC8gbTI7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBTaG91bGQgYWx3YXlzIGJlIHRydWUsIGp1c3QgY2hlY2tpbmcgKi9cblxuICAgICAgICBtMSArPSBtMjtcbiAgICAgICAgLy9pZiAoKChsb25nKShiICsgMykgJiAweGZmZmZmZmZmKSA8PSAzICsgMykge1xuICAgICAgICBpZiAoKGIgKyAzKSA8PSAzICsgMykge1xuICAgICAgICAgICAgLyogYXBwcm94aW1hdGVseSwgMSBiYXJrID0gMyBwYXJ0aXRpb25zICovXG4gICAgICAgICAgICAvKiA2NSUgb2YgdGhlIGNhc2VzICovXG4gICAgICAgICAgICAvKiBvcmlnaW5hbGx5ICdpZihpID4gOCknICovXG4gICAgICAgICAgICBpZiAocmF0aW8gPj0gbWFfbWF4X2kxKSB7XG4gICAgICAgICAgICAgICAgLyogNDMlIG9mIHRoZSB0b3RhbCAqL1xuICAgICAgICAgICAgICAgIHJldHVybiBtMTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyogMjIlIG9mIHRoZSB0b3RhbCAqL1xuICAgICAgICAgICAgdmFyIGkgPSAwIHwgKFV0aWwuRkFTVF9MT0cxMF9YKHJhdGlvLCAxNi4wKSk7XG4gICAgICAgICAgICByZXR1cm4gbTEgKiB0YWJsZTJbaV07XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogPFBSRT5cbiAgICAgICAgICogbTwxNSBlcXUgbG9nMTAoKG0xK20yKS9nZmMuQVRILmNiW2tdKTwxLjVcbiAgICAgICAgICogZXF1IChtMSttMikvZ2ZjLkFUSC5jYltrXTwxMF4xLjVcbiAgICAgICAgICogZXF1IChtMSttMik8MTBeMS41ICogZ2ZjLkFUSC5jYltrXVxuICAgICAgICAgKiA8L1BSRT5cbiAgICAgICAgICovXG4gICAgICAgIHZhciBpID0gMCB8IFV0aWwuRkFTVF9MT0cxMF9YKHJhdGlvLCAxNi4wKTtcbiAgICAgICAgaWYgKHNob3J0YmxvY2sgIT0gMCkge1xuICAgICAgICAgICAgbTIgPSBnZmMuQVRILmNiX3Nba2tdICogZ2ZjLkFUSC5hZGp1c3Q7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtMiA9IGdmYy5BVEguY2JfbFtra10gKiBnZmMuQVRILmFkanVzdDtcbiAgICAgICAgfVxuICAgICAgICBpZiAobTEgPCBtYV9tYXhfbSAqIG0yKSB7XG4gICAgICAgICAgICAvKiAzJSBvZiB0aGUgdG90YWwgKi9cbiAgICAgICAgICAgIC8qIE9yaWdpbmFsbHkgaWYgKG0gPiAwKSB7ICovXG4gICAgICAgICAgICBpZiAobTEgPiBtMikge1xuICAgICAgICAgICAgICAgIHZhciBmLCByO1xuXG4gICAgICAgICAgICAgICAgZiA9IDEuMDtcbiAgICAgICAgICAgICAgICBpZiAoaSA8PSAxMylcbiAgICAgICAgICAgICAgICAgICAgZiA9IHRhYmxlM1tpXTtcblxuICAgICAgICAgICAgICAgIHIgPSBVdGlsLkZBU1RfTE9HMTBfWChtMSAvIG0yLCAxMC4wIC8gMTUuMCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG0xICogKCh0YWJsZTFbaV0gLSBmKSAqIHIgKyBmKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGkgPiAxMylcbiAgICAgICAgICAgICAgICByZXR1cm4gbTE7XG5cbiAgICAgICAgICAgIHJldHVybiBtMSAqIHRhYmxlM1tpXTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIDEwJSBvZiB0b3RhbCAqL1xuICAgICAgICByZXR1cm4gbTEgKiB0YWJsZTFbaV07XG4gICAgfVxuXG4gICAgdmFyIHRhYmxlMl8gPSBbMS4zMzM1MiAqIDEuMzMzNTIsXG4gICAgICAgIDEuMzU4NzkgKiAxLjM1ODc5LCAxLjM4NDU0ICogMS4zODQ1NCwgMS4zOTQ5NyAqIDEuMzk0OTcsXG4gICAgICAgIDEuNDA1NDggKiAxLjQwNTQ4LCAxLjM1MzcgKiAxLjM1MzcsIDEuMzAzODIgKiAxLjMwMzgyLFxuICAgICAgICAxLjIyMzIxICogMS4yMjMyMSwgMS4xNDc1OCAqIDEuMTQ3NTgsIDFdO1xuXG4gICAgLyoqXG4gICAgICogYWRkaXRpb24gb2Ygc2ltdWx0YW5lb3VzIG1hc2tpbmcgTmFva2kgU2hpYmF0YSAyMDAwLzdcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB2YnJwc3lfbWFza19hZGQobTEsIG0yLCBiKSB7XG4gICAgICAgIHZhciByYXRpbztcblxuICAgICAgICBpZiAobTEgPCAwKSB7XG4gICAgICAgICAgICBtMSA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG0yIDwgMCkge1xuICAgICAgICAgICAgbTIgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtMSA8PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gbTI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG0yIDw9IDApIHtcbiAgICAgICAgICAgIHJldHVybiBtMTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobTIgPiBtMSkge1xuICAgICAgICAgICAgcmF0aW8gPSBtMiAvIG0xO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmF0aW8gPSBtMSAvIG0yO1xuICAgICAgICB9XG4gICAgICAgIGlmICgtMiA8PSBiICYmIGIgPD0gMikge1xuICAgICAgICAgICAgLyogYXBwcm94aW1hdGVseSwgMSBiYXJrID0gMyBwYXJ0aXRpb25zICovXG4gICAgICAgICAgICAvKiBvcmlnaW5hbGx5ICdpZihpID4gOCknICovXG4gICAgICAgICAgICBpZiAocmF0aW8gPj0gbWFfbWF4X2kxKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG0xICsgbTI7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBpID0gMCB8IChVdGlsLkZBU1RfTE9HMTBfWChyYXRpbywgMTYuMCkpO1xuICAgICAgICAgICAgICAgIHJldHVybiAobTEgKyBtMikgKiB0YWJsZTJfW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmIChyYXRpbyA8IG1hX21heF9pMikge1xuICAgICAgICAgICAgcmV0dXJuIG0xICsgbTI7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG0xIDwgbTIpIHtcbiAgICAgICAgICAgIG0xID0gbTI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG0xO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNvbXB1dGUgaW50ZXJjaGFubmVsIG1hc2tpbmcgZWZmZWN0c1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNhbGNfaW50ZXJjaGFubmVsX21hc2tpbmcoZ2ZwLCByYXRpbykge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICBpZiAoZ2ZjLmNoYW5uZWxzX291dCA+IDEpIHtcbiAgICAgICAgICAgIGZvciAodmFyIHNiID0gMDsgc2IgPCBFbmNvZGVyLlNCTUFYX2w7IHNiKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgbCA9IGdmYy50aG1bMF0ubFtzYl07XG4gICAgICAgICAgICAgICAgdmFyIHIgPSBnZmMudGhtWzFdLmxbc2JdO1xuICAgICAgICAgICAgICAgIGdmYy50aG1bMF0ubFtzYl0gKz0gciAqIHJhdGlvO1xuICAgICAgICAgICAgICAgIGdmYy50aG1bMV0ubFtzYl0gKz0gbCAqIHJhdGlvO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgc2IgPSAwOyBzYiA8IEVuY29kZXIuU0JNQVhfczsgc2IrKykge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIHNibG9jayA9IDA7IHNibG9jayA8IDM7IHNibG9jaysrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsID0gZ2ZjLnRobVswXS5zW3NiXVtzYmxvY2tdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgciA9IGdmYy50aG1bMV0uc1tzYl1bc2Jsb2NrXTtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnRobVswXS5zW3NiXVtzYmxvY2tdICs9IHIgKiByYXRpbztcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnRobVsxXS5zW3NiXVtzYmxvY2tdICs9IGwgKiByYXRpbztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjb21wdXRlIE0vUyB0aHJlc2hvbGRzIGZyb20gSm9obnN0b24gJiBGZXJyZWlyYSAxOTkyIElDQVNTUCBwYXBlclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIG1zZml4MShnZmMpIHtcbiAgICAgICAgZm9yICh2YXIgc2IgPSAwOyBzYiA8IEVuY29kZXIuU0JNQVhfbDsgc2IrKykge1xuICAgICAgICAgICAgLyogdXNlIHRoaXMgZml4IGlmIEwgJiBSIG1hc2tpbmcgZGlmZmVycyBieSAyZGIgb3IgbGVzcyAqL1xuICAgICAgICAgICAgLyogaWYgZGIgPSAxMCpsb2cxMCh4Mi94MSkgPCAyICovXG4gICAgICAgICAgICAvKiBpZiAoeDIgPCAxLjU4KngxKSB7ICovXG4gICAgICAgICAgICBpZiAoZ2ZjLnRobVswXS5sW3NiXSA+IDEuNTggKiBnZmMudGhtWzFdLmxbc2JdXG4gICAgICAgICAgICAgICAgfHwgZ2ZjLnRobVsxXS5sW3NiXSA+IDEuNTggKiBnZmMudGhtWzBdLmxbc2JdKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgdmFyIG1sZCA9IGdmYy5tbGRfbFtzYl0gKiBnZmMuZW5bM10ubFtzYl07XG4gICAgICAgICAgICB2YXIgcm1pZCA9IE1hdGgubWF4KGdmYy50aG1bMl0ubFtzYl0sXG4gICAgICAgICAgICAgICAgTWF0aC5taW4oZ2ZjLnRobVszXS5sW3NiXSwgbWxkKSk7XG5cbiAgICAgICAgICAgIG1sZCA9IGdmYy5tbGRfbFtzYl0gKiBnZmMuZW5bMl0ubFtzYl07XG4gICAgICAgICAgICB2YXIgcnNpZGUgPSBNYXRoLm1heChnZmMudGhtWzNdLmxbc2JdLFxuICAgICAgICAgICAgICAgIE1hdGgubWluKGdmYy50aG1bMl0ubFtzYl0sIG1sZCkpO1xuICAgICAgICAgICAgZ2ZjLnRobVsyXS5sW3NiXSA9IHJtaWQ7XG4gICAgICAgICAgICBnZmMudGhtWzNdLmxbc2JdID0gcnNpZGU7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKHZhciBzYiA9IDA7IHNiIDwgRW5jb2Rlci5TQk1BWF9zOyBzYisrKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBzYmxvY2sgPSAwOyBzYmxvY2sgPCAzOyBzYmxvY2srKykge1xuICAgICAgICAgICAgICAgIGlmIChnZmMudGhtWzBdLnNbc2JdW3NibG9ja10gPiAxLjU4ICogZ2ZjLnRobVsxXS5zW3NiXVtzYmxvY2tdXG4gICAgICAgICAgICAgICAgICAgIHx8IGdmYy50aG1bMV0uc1tzYl1bc2Jsb2NrXSA+IDEuNTggKiBnZmMudGhtWzBdLnNbc2JdW3NibG9ja10pXG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIHZhciBtbGQgPSBnZmMubWxkX3Nbc2JdICogZ2ZjLmVuWzNdLnNbc2JdW3NibG9ja107XG4gICAgICAgICAgICAgICAgdmFyIHJtaWQgPSBNYXRoLm1heChnZmMudGhtWzJdLnNbc2JdW3NibG9ja10sXG4gICAgICAgICAgICAgICAgICAgIE1hdGgubWluKGdmYy50aG1bM10uc1tzYl1bc2Jsb2NrXSwgbWxkKSk7XG5cbiAgICAgICAgICAgICAgICBtbGQgPSBnZmMubWxkX3Nbc2JdICogZ2ZjLmVuWzJdLnNbc2JdW3NibG9ja107XG4gICAgICAgICAgICAgICAgdmFyIHJzaWRlID0gTWF0aC5tYXgoZ2ZjLnRobVszXS5zW3NiXVtzYmxvY2tdLFxuICAgICAgICAgICAgICAgICAgICBNYXRoLm1pbihnZmMudGhtWzJdLnNbc2JdW3NibG9ja10sIG1sZCkpO1xuXG4gICAgICAgICAgICAgICAgZ2ZjLnRobVsyXS5zW3NiXVtzYmxvY2tdID0gcm1pZDtcbiAgICAgICAgICAgICAgICBnZmMudGhtWzNdLnNbc2JdW3NibG9ja10gPSByc2lkZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkanVzdCBNL1MgbWFza2luZ3MgaWYgdXNlciBzZXQgXCJtc2ZpeFwiXG4gICAgICpcbiAgICAgKiBOYW9raSBTaGliYXRhIDIwMDBcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBuc19tc2ZpeChnZmMsIG1zZml4LCBhdGhhZGp1c3QpIHtcbiAgICAgICAgdmFyIG1zZml4MiA9IG1zZml4O1xuICAgICAgICB2YXIgYXRobG93ZXIgPSBNYXRoLnBvdygxMCwgYXRoYWRqdXN0KTtcblxuICAgICAgICBtc2ZpeCAqPSAyLjA7XG4gICAgICAgIG1zZml4MiAqPSAyLjA7XG4gICAgICAgIGZvciAodmFyIHNiID0gMDsgc2IgPCBFbmNvZGVyLlNCTUFYX2w7IHNiKyspIHtcbiAgICAgICAgICAgIHZhciB0aG1MUiwgdGhtTSwgdGhtUywgYXRoO1xuICAgICAgICAgICAgYXRoID0gKGdmYy5BVEguY2JfbFtnZmMuYm1fbFtzYl1dKSAqIGF0aGxvd2VyO1xuICAgICAgICAgICAgdGhtTFIgPSBNYXRoLm1pbihNYXRoLm1heChnZmMudGhtWzBdLmxbc2JdLCBhdGgpLFxuICAgICAgICAgICAgICAgIE1hdGgubWF4KGdmYy50aG1bMV0ubFtzYl0sIGF0aCkpO1xuICAgICAgICAgICAgdGhtTSA9IE1hdGgubWF4KGdmYy50aG1bMl0ubFtzYl0sIGF0aCk7XG4gICAgICAgICAgICB0aG1TID0gTWF0aC5tYXgoZ2ZjLnRobVszXS5sW3NiXSwgYXRoKTtcbiAgICAgICAgICAgIGlmICh0aG1MUiAqIG1zZml4IDwgdGhtTSArIHRobVMpIHtcbiAgICAgICAgICAgICAgICB2YXIgZiA9IHRobUxSICogbXNmaXgyIC8gKHRobU0gKyB0aG1TKTtcbiAgICAgICAgICAgICAgICB0aG1NICo9IGY7XG4gICAgICAgICAgICAgICAgdGhtUyAqPSBmO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLnRobVsyXS5sW3NiXSA9IE1hdGgubWluKHRobU0sIGdmYy50aG1bMl0ubFtzYl0pO1xuICAgICAgICAgICAgZ2ZjLnRobVszXS5sW3NiXSA9IE1hdGgubWluKHRobVMsIGdmYy50aG1bM10ubFtzYl0pO1xuICAgICAgICB9XG5cbiAgICAgICAgYXRobG93ZXIgKj0gKCBFbmNvZGVyLkJMS1NJWkVfcyAvIEVuY29kZXIuQkxLU0laRSk7XG4gICAgICAgIGZvciAodmFyIHNiID0gMDsgc2IgPCBFbmNvZGVyLlNCTUFYX3M7IHNiKyspIHtcbiAgICAgICAgICAgIGZvciAodmFyIHNibG9jayA9IDA7IHNibG9jayA8IDM7IHNibG9jaysrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRobUxSLCB0aG1NLCB0aG1TLCBhdGg7XG4gICAgICAgICAgICAgICAgYXRoID0gKGdmYy5BVEguY2Jfc1tnZmMuYm1fc1tzYl1dKSAqIGF0aGxvd2VyO1xuICAgICAgICAgICAgICAgIHRobUxSID0gTWF0aC5taW4oTWF0aC5tYXgoZ2ZjLnRobVswXS5zW3NiXVtzYmxvY2tdLCBhdGgpLFxuICAgICAgICAgICAgICAgICAgICBNYXRoLm1heChnZmMudGhtWzFdLnNbc2JdW3NibG9ja10sIGF0aCkpO1xuICAgICAgICAgICAgICAgIHRobU0gPSBNYXRoLm1heChnZmMudGhtWzJdLnNbc2JdW3NibG9ja10sIGF0aCk7XG4gICAgICAgICAgICAgICAgdGhtUyA9IE1hdGgubWF4KGdmYy50aG1bM10uc1tzYl1bc2Jsb2NrXSwgYXRoKTtcblxuICAgICAgICAgICAgICAgIGlmICh0aG1MUiAqIG1zZml4IDwgdGhtTSArIHRobVMpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGYgPSB0aG1MUiAqIG1zZml4IC8gKHRobU0gKyB0aG1TKTtcbiAgICAgICAgICAgICAgICAgICAgdGhtTSAqPSBmO1xuICAgICAgICAgICAgICAgICAgICB0aG1TICo9IGY7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGdmYy50aG1bMl0uc1tzYl1bc2Jsb2NrXSA9IE1hdGgubWluKGdmYy50aG1bMl0uc1tzYl1bc2Jsb2NrXSxcbiAgICAgICAgICAgICAgICAgICAgdGhtTSk7XG4gICAgICAgICAgICAgICAgZ2ZjLnRobVszXS5zW3NiXVtzYmxvY2tdID0gTWF0aC5taW4oZ2ZjLnRobVszXS5zW3NiXVtzYmxvY2tdLFxuICAgICAgICAgICAgICAgICAgICB0aG1TKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIHNob3J0IGJsb2NrIHRocmVzaG9sZCBjYWxjdWxhdGlvbiAocGFydCAyKVxuICAgICAqXG4gICAgICogcGFydGl0aW9uIGJhbmQgYm9fc1tzZmJdIGlzIGF0IHRoZSB0cmFuc2l0aW9uIGZyb20gc2NhbGVmYWN0b3IgYmFuZCBzZmJcbiAgICAgKiB0byB0aGUgbmV4dCBvbmUgc2ZiKzE7IGVubiBhbmQgdGhtbSBoYXZlIHRvIGJlIHNwbGl0IGJldHdlZW4gdGhlbVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbnZlcnRfcGFydGl0aW9uMnNjYWxlZmFjX3MoZ2ZjLCBlYiwgdGhyLCBjaG4sIHNibG9jaykge1xuICAgICAgICB2YXIgc2IsIGI7XG4gICAgICAgIHZhciBlbm4gPSAwLjA7XG4gICAgICAgIHZhciB0aG1tID0gMC4wO1xuICAgICAgICBmb3IgKHNiID0gYiA9IDA7IHNiIDwgRW5jb2Rlci5TQk1BWF9zOyArK2IsICsrc2IpIHtcbiAgICAgICAgICAgIHZhciBib19zX3NiID0gZ2ZjLmJvX3Nbc2JdO1xuICAgICAgICAgICAgdmFyIG5wYXJ0X3MgPSBnZmMubnBhcnRfcztcbiAgICAgICAgICAgIHZhciBiX2xpbSA9IGJvX3Nfc2IgPCBucGFydF9zID8gYm9fc19zYiA6IG5wYXJ0X3M7XG4gICAgICAgICAgICB3aGlsZSAoYiA8IGJfbGltKSB7XG4gICAgICAgICAgICAgICAgLy8gaWZmIGZhaWxlZCwgaXQgbWF5IGluZGljYXRlIHNvbWUgaW5kZXggZXJyb3IgZWxzZXdoZXJlXG4gICAgICAgICAgICAgICAgZW5uICs9IGViW2JdO1xuICAgICAgICAgICAgICAgIHRobW0gKz0gdGhyW2JdO1xuICAgICAgICAgICAgICAgIGIrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy5lbltjaG5dLnNbc2JdW3NibG9ja10gPSBlbm47XG4gICAgICAgICAgICBnZmMudGhtW2Nobl0uc1tzYl1bc2Jsb2NrXSA9IHRobW07XG5cbiAgICAgICAgICAgIGlmIChiID49IG5wYXJ0X3MpIHtcbiAgICAgICAgICAgICAgICArK3NiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gaWZmIGZhaWxlZCwgaXQgbWF5IGluZGljYXRlIHNvbWUgaW5kZXggZXJyb3IgZWxzZXdoZXJlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLyogYXQgdHJhbnNpdGlvbiBzZmIgLiBzZmIrMSAqL1xuICAgICAgICAgICAgICAgIHZhciB3X2N1cnIgPSBnZmMuUFNZLmJvX3Nfd2VpZ2h0W3NiXTtcbiAgICAgICAgICAgICAgICB2YXIgd19uZXh0ID0gMS4wIC0gd19jdXJyO1xuICAgICAgICAgICAgICAgIGVubiA9IHdfY3VyciAqIGViW2JdO1xuICAgICAgICAgICAgICAgIHRobW0gPSB3X2N1cnIgKiB0aHJbYl07XG4gICAgICAgICAgICAgICAgZ2ZjLmVuW2Nobl0uc1tzYl1bc2Jsb2NrXSArPSBlbm47XG4gICAgICAgICAgICAgICAgZ2ZjLnRobVtjaG5dLnNbc2JdW3NibG9ja10gKz0gdGhtbTtcbiAgICAgICAgICAgICAgICBlbm4gPSB3X25leHQgKiBlYltiXTtcbiAgICAgICAgICAgICAgICB0aG1tID0gd19uZXh0ICogdGhyW2JdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qIHplcm8gaW5pdGlhbGl6ZSB0aGUgcmVzdCAqL1xuICAgICAgICBmb3IgKDsgc2IgPCBFbmNvZGVyLlNCTUFYX3M7ICsrc2IpIHtcbiAgICAgICAgICAgIGdmYy5lbltjaG5dLnNbc2JdW3NibG9ja10gPSAwO1xuICAgICAgICAgICAgZ2ZjLnRobVtjaG5dLnNbc2JdW3NibG9ja10gPSAwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogbG9uZ2Jsb2NrIHRocmVzaG9sZCBjYWxjdWxhdGlvbiAocGFydCAyKVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGNvbnZlcnRfcGFydGl0aW9uMnNjYWxlZmFjX2woZ2ZjLCBlYiwgdGhyLCBjaG4pIHtcbiAgICAgICAgdmFyIHNiLCBiO1xuICAgICAgICB2YXIgZW5uID0gMC4wO1xuICAgICAgICB2YXIgdGhtbSA9IDAuMDtcbiAgICAgICAgZm9yIChzYiA9IGIgPSAwOyBzYiA8IEVuY29kZXIuU0JNQVhfbDsgKytiLCArK3NiKSB7XG4gICAgICAgICAgICB2YXIgYm9fbF9zYiA9IGdmYy5ib19sW3NiXTtcbiAgICAgICAgICAgIHZhciBucGFydF9sID0gZ2ZjLm5wYXJ0X2w7XG4gICAgICAgICAgICB2YXIgYl9saW0gPSBib19sX3NiIDwgbnBhcnRfbCA/IGJvX2xfc2IgOiBucGFydF9sO1xuICAgICAgICAgICAgd2hpbGUgKGIgPCBiX2xpbSkge1xuICAgICAgICAgICAgICAgIC8vIGlmZiBmYWlsZWQsIGl0IG1heSBpbmRpY2F0ZSBzb21lIGluZGV4IGVycm9yIGVsc2V3aGVyZVxuICAgICAgICAgICAgICAgIGVubiArPSBlYltiXTtcbiAgICAgICAgICAgICAgICB0aG1tICs9IHRocltiXTtcbiAgICAgICAgICAgICAgICBiKys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMuZW5bY2huXS5sW3NiXSA9IGVubjtcbiAgICAgICAgICAgIGdmYy50aG1bY2huXS5sW3NiXSA9IHRobW07XG5cbiAgICAgICAgICAgIGlmIChiID49IG5wYXJ0X2wpIHtcbiAgICAgICAgICAgICAgICArK3NiO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIC8qIGF0IHRyYW5zaXRpb24gc2ZiIC4gc2ZiKzEgKi9cbiAgICAgICAgICAgICAgICB2YXIgd19jdXJyID0gZ2ZjLlBTWS5ib19sX3dlaWdodFtzYl07XG4gICAgICAgICAgICAgICAgdmFyIHdfbmV4dCA9IDEuMCAtIHdfY3VycjtcbiAgICAgICAgICAgICAgICBlbm4gPSB3X2N1cnIgKiBlYltiXTtcbiAgICAgICAgICAgICAgICB0aG1tID0gd19jdXJyICogdGhyW2JdO1xuICAgICAgICAgICAgICAgIGdmYy5lbltjaG5dLmxbc2JdICs9IGVubjtcbiAgICAgICAgICAgICAgICBnZmMudGhtW2Nobl0ubFtzYl0gKz0gdGhtbTtcbiAgICAgICAgICAgICAgICBlbm4gPSB3X25leHQgKiBlYltiXTtcbiAgICAgICAgICAgICAgICB0aG1tID0gd19uZXh0ICogdGhyW2JdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8qIHplcm8gaW5pdGlhbGl6ZSB0aGUgcmVzdCAqL1xuICAgICAgICBmb3IgKDsgc2IgPCBFbmNvZGVyLlNCTUFYX2w7ICsrc2IpIHtcbiAgICAgICAgICAgIGdmYy5lbltjaG5dLmxbc2JdID0gMDtcbiAgICAgICAgICAgIGdmYy50aG1bY2huXS5sW3NiXSA9IDA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjb21wdXRlX21hc2tpbmdfcyhnZnAsIGZmdGVuZXJneV9zLCBlYiwgdGhyLCBjaG4sIHNibG9jaykge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgaiwgYjtcblxuICAgICAgICBmb3IgKGIgPSBqID0gMDsgYiA8IGdmYy5ucGFydF9zOyArK2IpIHtcbiAgICAgICAgICAgIHZhciBlYmIgPSAwLCBtID0gMDtcbiAgICAgICAgICAgIHZhciBuID0gZ2ZjLm51bWxpbmVzX3NbYl07XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG47ICsraSwgKytqKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsID0gZmZ0ZW5lcmd5X3Nbc2Jsb2NrXVtqXTtcbiAgICAgICAgICAgICAgICBlYmIgKz0gZWw7XG4gICAgICAgICAgICAgICAgaWYgKG0gPCBlbClcbiAgICAgICAgICAgICAgICAgICAgbSA9IGVsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWJbYl0gPSBlYmI7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChqID0gYiA9IDA7IGIgPCBnZmMubnBhcnRfczsgYisrKSB7XG4gICAgICAgICAgICB2YXIga2sgPSBnZmMuczNpbmRfc1tiXVswXTtcbiAgICAgICAgICAgIHZhciBlY2IgPSBnZmMuczNfc3NbaisrXSAqIGViW2trXTtcbiAgICAgICAgICAgICsra2s7XG4gICAgICAgICAgICB3aGlsZSAoa2sgPD0gZ2ZjLnMzaW5kX3NbYl1bMV0pIHtcbiAgICAgICAgICAgICAgICBlY2IgKz0gZ2ZjLnMzX3NzW2pdICogZWJba2tdO1xuICAgICAgICAgICAgICAgICsrajtcbiAgICAgICAgICAgICAgICArK2trO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB7IC8qIGxpbWl0IGNhbGN1bGF0ZWQgdGhyZXNob2xkIGJ5IHByZXZpb3VzIGdyYW51bGUgKi9cbiAgICAgICAgICAgICAgICB2YXIgeCA9IHJwZWxldl9zICogZ2ZjLm5iX3MxW2Nobl1bYl07XG4gICAgICAgICAgICAgICAgdGhyW2JdID0gTWF0aC5taW4oZWNiLCB4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChnZmMuYmxvY2t0eXBlX29sZFtjaG4gJiAxXSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpIHtcbiAgICAgICAgICAgICAgICAvKiBsaW1pdCBjYWxjdWxhdGVkIHRocmVzaG9sZCBieSBldmVuIG9sZGVyIGdyYW51bGUgKi9cbiAgICAgICAgICAgICAgICB2YXIgeCA9IHJwZWxldjJfcyAqIGdmYy5uYl9zMltjaG5dW2JdO1xuICAgICAgICAgICAgICAgIHZhciB5ID0gdGhyW2JdO1xuICAgICAgICAgICAgICAgIHRocltiXSA9IE1hdGgubWluKHgsIHkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBnZmMubmJfczJbY2huXVtiXSA9IGdmYy5uYl9zMVtjaG5dW2JdO1xuICAgICAgICAgICAgZ2ZjLm5iX3MxW2Nobl1bYl0gPSBlY2I7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICg7IGIgPD0gRW5jb2Rlci5DQkFORFM7ICsrYikge1xuICAgICAgICAgICAgZWJbYl0gPSAwO1xuICAgICAgICAgICAgdGhyW2JdID0gMDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGJsb2NrX3R5cGVfc2V0KGdmcCwgdXNlbG9uZ2Jsb2NrLCBibG9ja3R5cGVfZCwgYmxvY2t0eXBlKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cbiAgICAgICAgaWYgKGdmcC5zaG9ydF9ibG9ja3MgPT0gU2hvcnRCbG9jay5zaG9ydF9ibG9ja19jb3VwbGVkXG4gICAgICAgICAgICAgICAgLyogZm9yY2UgYm90aCBjaGFubmVscyB0byB1c2UgdGhlIHNhbWUgYmxvY2sgdHlwZSAqL1xuICAgICAgICAgICAgICAgIC8qIHRoaXMgaXMgbmVjZXNzYXJ5IGlmIHRoZSBmcmFtZSBpcyB0byBiZSBlbmNvZGVkIGluIG1zX3N0ZXJlby4gKi9cbiAgICAgICAgICAgICAgICAvKiBCdXQgZXZlbiB3aXRob3V0IG1zX3N0ZXJlbywgRmhHIGRvZXMgdGhpcyAqL1xuICAgICAgICAgICAgJiYgISh1c2Vsb25nYmxvY2tbMF0gIT0gMCAmJiB1c2Vsb25nYmxvY2tbMV0gIT0gMCkpXG4gICAgICAgICAgICB1c2Vsb25nYmxvY2tbMF0gPSB1c2Vsb25nYmxvY2tbMV0gPSAwO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHVwZGF0ZSB0aGUgYmxvY2t0eXBlIG9mIHRoZSBwcmV2aW91cyBncmFudWxlLCBzaW5jZSBpdCBkZXBlbmRzIG9uXG4gICAgICAgICAqIHdoYXQgaGFwcGVuZCBpbiB0aGlzIGdyYW51bGVcbiAgICAgICAgICovXG4gICAgICAgIGZvciAodmFyIGNobiA9IDA7IGNobiA8IGdmYy5jaGFubmVsc19vdXQ7IGNobisrKSB7XG4gICAgICAgICAgICBibG9ja3R5cGVbY2huXSA9IEVuY29kZXIuTk9STV9UWVBFO1xuICAgICAgICAgICAgLyogZGlzYWJsZSBzaG9ydCBibG9ja3MgKi9cbiAgICAgICAgICAgIGlmIChnZnAuc2hvcnRfYmxvY2tzID09IFNob3J0QmxvY2suc2hvcnRfYmxvY2tfZGlzcGVuc2VkKVxuICAgICAgICAgICAgICAgIHVzZWxvbmdibG9ja1tjaG5dID0gMTtcbiAgICAgICAgICAgIGlmIChnZnAuc2hvcnRfYmxvY2tzID09IFNob3J0QmxvY2suc2hvcnRfYmxvY2tfZm9yY2VkKVxuICAgICAgICAgICAgICAgIHVzZWxvbmdibG9ja1tjaG5dID0gMDtcblxuICAgICAgICAgICAgaWYgKHVzZWxvbmdibG9ja1tjaG5dICE9IDApIHtcbiAgICAgICAgICAgICAgICAvKiBubyBhdHRhY2sgOiB1c2UgbG9uZyBibG9ja3MgKi9cbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLmJsb2NrdHlwZV9vbGRbY2huXSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpXG4gICAgICAgICAgICAgICAgICAgIGJsb2NrdHlwZVtjaG5dID0gRW5jb2Rlci5TVE9QX1RZUEU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8qIGF0dGFjayA6IHVzZSBzaG9ydCBibG9ja3MgKi9cbiAgICAgICAgICAgICAgICBibG9ja3R5cGVbY2huXSA9IEVuY29kZXIuU0hPUlRfVFlQRTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLmJsb2NrdHlwZV9vbGRbY2huXSA9PSBFbmNvZGVyLk5PUk1fVFlQRSkge1xuICAgICAgICAgICAgICAgICAgICBnZmMuYmxvY2t0eXBlX29sZFtjaG5dID0gRW5jb2Rlci5TVEFSVF9UWVBFO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLmJsb2NrdHlwZV9vbGRbY2huXSA9PSBFbmNvZGVyLlNUT1BfVFlQRSlcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLmJsb2NrdHlwZV9vbGRbY2huXSA9IEVuY29kZXIuU0hPUlRfVFlQRTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgYmxvY2t0eXBlX2RbY2huXSA9IGdmYy5ibG9ja3R5cGVfb2xkW2Nobl07XG4gICAgICAgICAgICAvLyB2YWx1ZSByZXR1cm5lZCB0byBjYWxsaW5nIHByb2dyYW1cbiAgICAgICAgICAgIGdmYy5ibG9ja3R5cGVfb2xkW2Nobl0gPSBibG9ja3R5cGVbY2huXTtcbiAgICAgICAgICAgIC8vIHNhdmUgZm9yIG5leHQgY2FsbCB0byBsM3BzeV9hbmFsXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBOU19JTlRFUlAoeCwgeSwgcikge1xuICAgICAgICAvKiB3YXMgcG93KCh4KSwocikpKnBvdygoeSksMS0ocikpICovXG4gICAgICAgIGlmIChyID49IDEuMCkge1xuICAgICAgICAgICAgLyogOTkuNyUgb2YgdGhlIHRpbWUgKi9cbiAgICAgICAgICAgIHJldHVybiB4O1xuICAgICAgICB9XG4gICAgICAgIGlmIChyIDw9IDAuMClcbiAgICAgICAgICAgIHJldHVybiB5O1xuICAgICAgICBpZiAoeSA+IDAuMCkge1xuICAgICAgICAgICAgLyogcmVzdCBvZiB0aGUgdGltZSAqL1xuICAgICAgICAgICAgcmV0dXJuIChNYXRoLnBvdyh4IC8geSwgcikgKiB5KTtcbiAgICAgICAgfVxuICAgICAgICAvKiBuZXZlciBoYXBwZW5zICovXG4gICAgICAgIHJldHVybiAwLjA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogdGhlc2UgdmFsdWVzIGFyZSB0dW5lZCBvbmx5IGZvciA0NC4xa0h6Li4uXG4gICAgICovXG4gICAgdmFyIHJlZ2NvZWZfcyA9IFsxMS44LCAxMy42LCAxNy4yLCAzMiwgNDYuNSxcbiAgICAgICAgNTEuMywgNTcuNSwgNjcuMSwgNzEuNSwgODQuNiwgOTcuNiwgMTMwLFxuICAgICAgICAvKiAyNTUuOCAqL1xuICAgIF07XG5cbiAgICBmdW5jdGlvbiBwZWNhbGNfcyhtciwgbWFza2luZ19sb3dlcikge1xuICAgICAgICB2YXIgcGVfcyA9IDEyMzYuMjggLyA0O1xuICAgICAgICBmb3IgKHZhciBzYiA9IDA7IHNiIDwgRW5jb2Rlci5TQk1BWF9zIC0gMTsgc2IrKykge1xuICAgICAgICAgICAgZm9yICh2YXIgc2Jsb2NrID0gMDsgc2Jsb2NrIDwgMzsgc2Jsb2NrKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGhtID0gbXIudGhtLnNbc2JdW3NibG9ja107XG4gICAgICAgICAgICAgICAgaWYgKHRobSA+IDAuMCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgeCA9IHRobSAqIG1hc2tpbmdfbG93ZXI7XG4gICAgICAgICAgICAgICAgICAgIHZhciBlbiA9IG1yLmVuLnNbc2JdW3NibG9ja107XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbiA+IHgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlbiA+IHggKiAxZTEwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGVfcyArPSByZWdjb2VmX3Nbc2JdICogKDEwLjAgKiBMT0cxMCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlX3MgKz0gcmVnY29lZl9zW3NiXSAqIFV0aWwuRkFTVF9MT0cxMChlbiAvIHgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHBlX3M7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogdGhlc2UgdmFsdWVzIGFyZSB0dW5lZCBvbmx5IGZvciA0NC4xa0h6Li4uXG4gICAgICovXG4gICAgdmFyIHJlZ2NvZWZfbCA9IFs2LjgsIDUuOCwgNS44LCA2LjQsIDYuNSwgOS45LFxuICAgICAgICAxMi4xLCAxNC40LCAxNSwgMTguOSwgMjEuNiwgMjYuOSwgMzQuMiwgNDAuMiwgNDYuOCwgNTYuNSxcbiAgICAgICAgNjAuNywgNzMuOSwgODUuNywgOTMuNCwgMTI2LjEsXG4gICAgICAgIC8qIDI0MS4zICovXG4gICAgXTtcblxuICAgIGZ1bmN0aW9uIHBlY2FsY19sKG1yLCBtYXNraW5nX2xvd2VyKSB7XG4gICAgICAgIHZhciBwZV9sID0gMTEyNC4yMyAvIDQ7XG4gICAgICAgIGZvciAodmFyIHNiID0gMDsgc2IgPCBFbmNvZGVyLlNCTUFYX2wgLSAxOyBzYisrKSB7XG4gICAgICAgICAgICB2YXIgdGhtID0gbXIudGhtLmxbc2JdO1xuICAgICAgICAgICAgaWYgKHRobSA+IDAuMCkge1xuICAgICAgICAgICAgICAgIHZhciB4ID0gdGhtICogbWFza2luZ19sb3dlcjtcbiAgICAgICAgICAgICAgICB2YXIgZW4gPSBtci5lbi5sW3NiXTtcbiAgICAgICAgICAgICAgICBpZiAoZW4gPiB4KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbiA+IHggKiAxZTEwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwZV9sICs9IHJlZ2NvZWZfbFtzYl0gKiAoMTAuMCAqIExPRzEwKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBlX2wgKz0gcmVnY29lZl9sW3NiXSAqIFV0aWwuRkFTVF9MT0cxMChlbiAvIHgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBwZV9sO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNhbGNfZW5lcmd5KGdmYywgZmZ0ZW5lcmd5LCBlYiwgbWF4LCBhdmcpIHtcbiAgICAgICAgdmFyIGIsIGo7XG5cbiAgICAgICAgZm9yIChiID0gaiA9IDA7IGIgPCBnZmMubnBhcnRfbDsgKytiKSB7XG4gICAgICAgICAgICB2YXIgZWJiID0gMCwgbSA9IDA7XG4gICAgICAgICAgICB2YXIgaTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBnZmMubnVtbGluZXNfbFtiXTsgKytpLCArK2opIHtcbiAgICAgICAgICAgICAgICB2YXIgZWwgPSBmZnRlbmVyZ3lbal07XG4gICAgICAgICAgICAgICAgZWJiICs9IGVsO1xuICAgICAgICAgICAgICAgIGlmIChtIDwgZWwpXG4gICAgICAgICAgICAgICAgICAgIG0gPSBlbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGViW2JdID0gZWJiO1xuICAgICAgICAgICAgbWF4W2JdID0gbTtcbiAgICAgICAgICAgIGF2Z1tiXSA9IGViYiAqIGdmYy5ybnVtbGluZXNfbFtiXTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNhbGNfbWFza19pbmRleF9sKGdmYywgbWF4LCBhdmcsIG1hc2tfaWR4KSB7XG4gICAgICAgIHZhciBsYXN0X3RhYl9lbnRyeSA9IHRhYi5sZW5ndGggLSAxO1xuICAgICAgICB2YXIgYiA9IDA7XG4gICAgICAgIHZhciBhID0gYXZnW2JdICsgYXZnW2IgKyAxXTtcbiAgICAgICAgaWYgKGEgPiAwLjApIHtcbiAgICAgICAgICAgIHZhciBtID0gbWF4W2JdO1xuICAgICAgICAgICAgaWYgKG0gPCBtYXhbYiArIDFdKVxuICAgICAgICAgICAgICAgIG0gPSBtYXhbYiArIDFdO1xuICAgICAgICAgICAgYSA9IDIwLjAgKiAobSAqIDIuMCAtIGEpXG4gICAgICAgICAgICAgICAgLyAoYSAqIChnZmMubnVtbGluZXNfbFtiXSArIGdmYy5udW1saW5lc19sW2IgKyAxXSAtIDEpKTtcbiAgICAgICAgICAgIHZhciBrID0gMCB8IGE7XG4gICAgICAgICAgICBpZiAoayA+IGxhc3RfdGFiX2VudHJ5KVxuICAgICAgICAgICAgICAgIGsgPSBsYXN0X3RhYl9lbnRyeTtcbiAgICAgICAgICAgIG1hc2tfaWR4W2JdID0gaztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1hc2tfaWR4W2JdID0gMDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoYiA9IDE7IGIgPCBnZmMubnBhcnRfbCAtIDE7IGIrKykge1xuICAgICAgICAgICAgYSA9IGF2Z1tiIC0gMV0gKyBhdmdbYl0gKyBhdmdbYiArIDFdO1xuICAgICAgICAgICAgaWYgKGEgPiAwLjApIHtcbiAgICAgICAgICAgICAgICB2YXIgbSA9IG1heFtiIC0gMV07XG4gICAgICAgICAgICAgICAgaWYgKG0gPCBtYXhbYl0pXG4gICAgICAgICAgICAgICAgICAgIG0gPSBtYXhbYl07XG4gICAgICAgICAgICAgICAgaWYgKG0gPCBtYXhbYiArIDFdKVxuICAgICAgICAgICAgICAgICAgICBtID0gbWF4W2IgKyAxXTtcbiAgICAgICAgICAgICAgICBhID0gMjAuMFxuICAgICAgICAgICAgICAgICAgICAqIChtICogMy4wIC0gYSlcbiAgICAgICAgICAgICAgICAgICAgLyAoYSAqIChnZmMubnVtbGluZXNfbFtiIC0gMV0gKyBnZmMubnVtbGluZXNfbFtiXVxuICAgICAgICAgICAgICAgICAgICArIGdmYy5udW1saW5lc19sW2IgKyAxXSAtIDEpKTtcbiAgICAgICAgICAgICAgICB2YXIgayA9IDAgfCBhO1xuICAgICAgICAgICAgICAgIGlmIChrID4gbGFzdF90YWJfZW50cnkpXG4gICAgICAgICAgICAgICAgICAgIGsgPSBsYXN0X3RhYl9lbnRyeTtcbiAgICAgICAgICAgICAgICBtYXNrX2lkeFtiXSA9IGs7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG1hc2tfaWR4W2JdID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGEgPSBhdmdbYiAtIDFdICsgYXZnW2JdO1xuICAgICAgICBpZiAoYSA+IDAuMCkge1xuICAgICAgICAgICAgdmFyIG0gPSBtYXhbYiAtIDFdO1xuICAgICAgICAgICAgaWYgKG0gPCBtYXhbYl0pXG4gICAgICAgICAgICAgICAgbSA9IG1heFtiXTtcbiAgICAgICAgICAgIGEgPSAyMC4wICogKG0gKiAyLjAgLSBhKVxuICAgICAgICAgICAgICAgIC8gKGEgKiAoZ2ZjLm51bWxpbmVzX2xbYiAtIDFdICsgZ2ZjLm51bWxpbmVzX2xbYl0gLSAxKSk7XG4gICAgICAgICAgICB2YXIgayA9IDAgfCBhO1xuICAgICAgICAgICAgaWYgKGsgPiBsYXN0X3RhYl9lbnRyeSlcbiAgICAgICAgICAgICAgICBrID0gbGFzdF90YWJfZW50cnk7XG4gICAgICAgICAgICBtYXNrX2lkeFtiXSA9IGs7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtYXNrX2lkeFtiXSA9IDA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgZmlyY29lZiA9IFtcbiAgICAgICAgLTguNjUxNjNlLTE4ICogMiwgLTAuMDA4NTE1ODYgKiAyLCAtNi43NDc2NGUtMTggKiAyLCAwLjAyMDkwMzYgKiAyLFxuICAgICAgICAtMy4zNjYzOWUtMTcgKiAyLCAtMC4wNDM4MTYyICogMiwgLTEuNTQxNzVlLTE3ICogMiwgMC4wOTMxNzM4ICogMixcbiAgICAgICAgLTUuNTIyMTJlLTE3ICogMiwgLTAuMzEzODE5ICogMlxuICAgIF07XG5cbiAgICB0aGlzLkwzcHN5Y2hvX2FuYWxfbnMgPSBmdW5jdGlvbiAoZ2ZwLCBidWZmZXIsIGJ1ZlBvcywgZ3Jfb3V0LCBtYXNraW5nX3JhdGlvLCBtYXNraW5nX01TX3JhdGlvLCBwZXJjZXBfZW50cm9weSwgcGVyY2VwX01TX2VudHJvcHksIGVuZXJneSwgYmxvY2t0eXBlX2QpIHtcbiAgICAgICAgLypcbiAgICAgICAgICogdG8gZ2V0IGEgZ29vZCBjYWNoZSBwZXJmb3JtYW5jZSwgb25lIGhhcyB0byB0aGluayBhYm91dCB0aGUgc2VxdWVuY2UsXG4gICAgICAgICAqIGluIHdoaWNoIHRoZSB2YXJpYWJsZXMgYXJlIHVzZWQuXG4gICAgICAgICAqL1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXG4gICAgICAgIC8qIGZmdCBhbmQgZW5lcmd5IGNhbGN1bGF0aW9uICovXG4gICAgICAgIHZhciB3c2FtcF9MID0gbmV3X2Zsb2F0X24oWzIsIEVuY29kZXIuQkxLU0laRV0pO1xuICAgICAgICB2YXIgd3NhbXBfUyA9IG5ld19mbG9hdF9uKFsyLCAzLCBFbmNvZGVyLkJMS1NJWkVfc10pO1xuXG4gICAgICAgIC8qIGNvbnZvbHV0aW9uICovXG4gICAgICAgIHZhciBlYl9sID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTICsgMSk7XG4gICAgICAgIHZhciBlYl9zID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTICsgMSk7XG4gICAgICAgIHZhciB0aHIgPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMgKyAyKTtcblxuICAgICAgICAvKiBibG9jayB0eXBlICovXG4gICAgICAgIHZhciBibG9ja3R5cGUgPSBuZXdfaW50KDIpLCB1c2Vsb25nYmxvY2sgPSBuZXdfaW50KDIpO1xuXG4gICAgICAgIC8qIHVzdWFsIHZhcmlhYmxlcyBsaWtlIGxvb3AgaW5kaWNlcywgZXRjLi4gKi9cbiAgICAgICAgdmFyIG51bWNobiwgY2huO1xuICAgICAgICB2YXIgYiwgaSwgaiwgaztcbiAgICAgICAgdmFyIHNiLCBzYmxvY2s7XG5cbiAgICAgICAgLyogdmFyaWFibGVzIHVzZWQgZm9yIC0tbnNwc3l0dW5lICovXG4gICAgICAgIHZhciBuc19ocGZzbXBsID0gbmV3X2Zsb2F0X24oWzIsIDU3Nl0pO1xuICAgICAgICB2YXIgcGNmYWN0O1xuICAgICAgICB2YXIgbWFza19pZHhfbCA9IG5ld19pbnQoRW5jb2Rlci5DQkFORFMgKyAyKSwgbWFza19pZHhfcyA9IG5ld19pbnQoRW5jb2Rlci5DQkFORFMgKyAyKTtcblxuICAgICAgICBBcnJheXMuZmlsbChtYXNrX2lkeF9zLCAwKTtcblxuICAgICAgICBudW1jaG4gPSBnZmMuY2hhbm5lbHNfb3V0O1xuICAgICAgICAvKiBjaG49MiBhbmQgMyA9IE1pZCBhbmQgU2lkZSBjaGFubmVscyAqL1xuICAgICAgICBpZiAoZ2ZwLm1vZGUgPT0gTVBFR01vZGUuSk9JTlRfU1RFUkVPKVxuICAgICAgICAgICAgbnVtY2huID0gNDtcblxuICAgICAgICBpZiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9vZmYpXG4gICAgICAgICAgICBwY2ZhY3QgPSBnZmMuUmVzdk1heCA9PSAwID8gMCA6ICggZ2ZjLlJlc3ZTaXplKVxuICAgICAgICAgICAgLyBnZmMuUmVzdk1heCAqIDAuNTtcbiAgICAgICAgZWxzZSBpZiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9yaCB8fCBnZnAuVkJSID09IFZick1vZGUudmJyX210cmhcbiAgICAgICAgICAgIHx8IGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfbXQpIHtcbiAgICAgICAgICAgIHBjZmFjdCA9IDAuNjtcbiAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICBwY2ZhY3QgPSAxLjA7XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICogQXBwbHkgSFBGIG9mIGZzLzQgdG8gdGhlIGlucHV0IHNpZ25hbC4gVGhpcyBpcyB1c2VkIGZvciBhdHRhY2tcbiAgICAgICAgICogZGV0ZWN0aW9uIC8gaGFuZGxpbmcuXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICAvKiBEb24ndCBjb3B5IHRoZSBpbnB1dCBidWZmZXIgaW50byBhIHRlbXBvcmFyeSBidWZmZXIgKi9cbiAgICAgICAgLyogdW5yb2xsIHRoZSBsb29wIDIgdGltZXMgKi9cbiAgICAgICAgZm9yIChjaG4gPSAwOyBjaG4gPCBnZmMuY2hhbm5lbHNfb3V0OyBjaG4rKykge1xuICAgICAgICAgICAgLyogYXBwbHkgaGlnaCBwYXNzIGZpbHRlciBvZiBmcy80ICovXG4gICAgICAgICAgICB2YXIgZmlyYnVmID0gYnVmZmVyW2Nobl07XG4gICAgICAgICAgICB2YXIgZmlyYnVmUG9zID0gYnVmUG9zICsgNTc2IC0gMzUwIC0gTlNGSVJMRU4gKyAxOTI7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgNTc2OyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgc3VtMSwgc3VtMjtcbiAgICAgICAgICAgICAgICBzdW0xID0gZmlyYnVmW2ZpcmJ1ZlBvcyArIGkgKyAxMF07XG4gICAgICAgICAgICAgICAgc3VtMiA9IDAuMDtcbiAgICAgICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgKChOU0ZJUkxFTiAtIDEpIC8gMikgLSAxOyBqICs9IDIpIHtcbiAgICAgICAgICAgICAgICAgICAgc3VtMSArPSBmaXJjb2VmW2pdXG4gICAgICAgICAgICAgICAgICAgICAgICAqIChmaXJidWZbZmlyYnVmUG9zICsgaSArIGpdICsgZmlyYnVmW2ZpcmJ1ZlBvcyArIGlcbiAgICAgICAgICAgICAgICAgICAgICAgICsgTlNGSVJMRU4gLSBqXSk7XG4gICAgICAgICAgICAgICAgICAgIHN1bTIgKz0gZmlyY29lZltqICsgMV1cbiAgICAgICAgICAgICAgICAgICAgICAgICogKGZpcmJ1ZltmaXJidWZQb3MgKyBpICsgaiArIDFdICsgZmlyYnVmW2ZpcmJ1ZlBvc1xuICAgICAgICAgICAgICAgICAgICAgICAgKyBpICsgTlNGSVJMRU4gLSBqIC0gMV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBuc19ocGZzbXBsW2Nobl1baV0gPSBzdW0xICsgc3VtMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1hc2tpbmdfcmF0aW9bZ3Jfb3V0XVtjaG5dLmVuLmFzc2lnbihnZmMuZW5bY2huXSk7XG4gICAgICAgICAgICBtYXNraW5nX3JhdGlvW2dyX291dF1bY2huXS50aG0uYXNzaWduKGdmYy50aG1bY2huXSk7XG4gICAgICAgICAgICBpZiAobnVtY2huID4gMikge1xuICAgICAgICAgICAgICAgIC8qIE1TIG1hc2tpbmdzICovXG4gICAgICAgICAgICAgICAgLyogcGVyY2VwX01TX2VudHJvcHkgW2Nobi0yXSA9IGdmYyAuIHBlIFtjaG5dOyAqL1xuICAgICAgICAgICAgICAgIG1hc2tpbmdfTVNfcmF0aW9bZ3Jfb3V0XVtjaG5dLmVuLmFzc2lnbihnZmMuZW5bY2huICsgMl0pO1xuICAgICAgICAgICAgICAgIG1hc2tpbmdfTVNfcmF0aW9bZ3Jfb3V0XVtjaG5dLnRobS5hc3NpZ24oZ2ZjLnRobVtjaG4gKyAyXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGNobiA9IDA7IGNobiA8IG51bWNobjsgY2huKyspIHtcbiAgICAgICAgICAgIHZhciB3c2FtcF9sO1xuICAgICAgICAgICAgdmFyIHdzYW1wX3M7XG4gICAgICAgICAgICB2YXIgZW5fc3Vic2hvcnQgPSBuZXdfZmxvYXQoMTIpO1xuICAgICAgICAgICAgdmFyIGVuX3Nob3J0ID0gWzAsIDAsIDAsIDBdO1xuICAgICAgICAgICAgdmFyIGF0dGFja19pbnRlbnNpdHkgPSBuZXdfZmxvYXQoMTIpO1xuICAgICAgICAgICAgdmFyIG5zX3VzZWxvbmdibG9jayA9IDE7XG4gICAgICAgICAgICB2YXIgYXR0YWNrVGhyZXNob2xkO1xuICAgICAgICAgICAgdmFyIG1heCA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyksIGF2ZyA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyk7XG4gICAgICAgICAgICB2YXIgbnNfYXR0YWNrcyA9IFswLCAwLCAwLCAwXTtcbiAgICAgICAgICAgIHZhciBmZnRlbmVyZ3kgPSBuZXdfZmxvYXQoRW5jb2Rlci5IQkxLU0laRSk7XG4gICAgICAgICAgICB2YXIgZmZ0ZW5lcmd5X3MgPSBuZXdfZmxvYXRfbihbMywgRW5jb2Rlci5IQkxLU0laRV9zXSk7XG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiByaCAyMDA0MDMwMTogdGhlIGZvbGxvd2luZyBsb29wcyBkbyBhY2Nlc3Mgb25lIG9mZiB0aGUgbGltaXRzIHNvXG4gICAgICAgICAgICAgKiBJIGluY3JlYXNlIHRoZSBhcnJheSBkaW1lbnNpb25zIGJ5IG9uZSBhbmQgaW5pdGlhbGl6ZSB0aGVcbiAgICAgICAgICAgICAqIGFjY2Vzc2VkIHZhbHVlcyB0byB6ZXJvXG4gICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgICAgICogZGV0ZXJtaW5lIHRoZSBibG9jayB0eXBlICh3aW5kb3cgdHlwZSlcbiAgICAgICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgICAgICAvKiBjYWxjdWxhdGUgZW5lcmdpZXMgb2YgZWFjaCBzdWItc2hvcnRibG9ja3MgKi9cbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCAzOyBpKyspIHtcbiAgICAgICAgICAgICAgICBlbl9zdWJzaG9ydFtpXSA9IGdmYy5uc1BzeS5sYXN0X2VuX3N1YnNob3J0W2Nobl1baSArIDZdO1xuICAgICAgICAgICAgICAgIGF0dGFja19pbnRlbnNpdHlbaV0gPSBlbl9zdWJzaG9ydFtpXVxuICAgICAgICAgICAgICAgICAgICAvIGdmYy5uc1BzeS5sYXN0X2VuX3N1YnNob3J0W2Nobl1baSArIDRdO1xuICAgICAgICAgICAgICAgIGVuX3Nob3J0WzBdICs9IGVuX3N1YnNob3J0W2ldO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY2huID09IDIpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgNTc2OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGwsIHI7XG4gICAgICAgICAgICAgICAgICAgIGwgPSBuc19ocGZzbXBsWzBdW2ldO1xuICAgICAgICAgICAgICAgICAgICByID0gbnNfaHBmc21wbFsxXVtpXTtcbiAgICAgICAgICAgICAgICAgICAgbnNfaHBmc21wbFswXVtpXSA9IGwgKyByO1xuICAgICAgICAgICAgICAgICAgICBuc19ocGZzbXBsWzFdW2ldID0gbCAtIHI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhciBwZiA9IG5zX2hwZnNtcGxbY2huICYgMV07XG4gICAgICAgICAgICAgICAgdmFyIHBmUG9zID0gMDtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgOTsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwZmUgPSBwZlBvcyArIDU3NiAvIDk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwID0gMS47XG4gICAgICAgICAgICAgICAgICAgIGZvciAoOyBwZlBvcyA8IHBmZTsgcGZQb3MrKylcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwIDwgTWF0aC5hYnMocGZbcGZQb3NdKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwID0gTWF0aC5hYnMocGZbcGZQb3NdKTtcblxuICAgICAgICAgICAgICAgICAgICBnZmMubnNQc3kubGFzdF9lbl9zdWJzaG9ydFtjaG5dW2ldID0gZW5fc3Vic2hvcnRbaSArIDNdID0gcDtcbiAgICAgICAgICAgICAgICAgICAgZW5fc2hvcnRbMSArIGkgLyAzXSArPSBwO1xuICAgICAgICAgICAgICAgICAgICBpZiAocCA+IGVuX3N1YnNob3J0W2kgKyAzIC0gMl0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBwIC8gZW5fc3Vic2hvcnRbaSArIDMgLSAyXTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbl9zdWJzaG9ydFtpICsgMyAtIDJdID4gcCAqIDEwLjApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBlbl9zdWJzaG9ydFtpICsgMyAtIDJdIC8gKHAgKiAxMC4wKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICBwID0gMC4wO1xuICAgICAgICAgICAgICAgICAgICBhdHRhY2tfaW50ZW5zaXR5W2kgKyAzXSA9IHA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZ2ZwLmFuYWx5c2lzKSB7XG4gICAgICAgICAgICAgICAgdmFyIHggPSBhdHRhY2tfaW50ZW5zaXR5WzBdO1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDE7IGkgPCAxMjsgaSsrKVxuICAgICAgICAgICAgICAgICAgICBpZiAoeCA8IGF0dGFja19pbnRlbnNpdHlbaV0pXG4gICAgICAgICAgICAgICAgICAgICAgICB4ID0gYXR0YWNrX2ludGVuc2l0eVtpXTtcbiAgICAgICAgICAgICAgICBnZmMucGluZm8uZXJzW2dyX291dF1bY2huXSA9IGdmYy5waW5mby5lcnNfc2F2ZVtjaG5dO1xuICAgICAgICAgICAgICAgIGdmYy5waW5mby5lcnNfc2F2ZVtjaG5dID0geDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyogY29tcGFyZSBlbmVyZ2llcyBiZXR3ZWVuIHN1Yi1zaG9ydGJsb2NrcyAqL1xuICAgICAgICAgICAgYXR0YWNrVGhyZXNob2xkID0gKGNobiA9PSAzKSA/IGdmYy5uc1BzeS5hdHRhY2t0aHJlX3NcbiAgICAgICAgICAgICAgICA6IGdmYy5uc1BzeS5hdHRhY2t0aHJlO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IDEyOyBpKyspXG4gICAgICAgICAgICAgICAgaWYgKDAgPT0gbnNfYXR0YWNrc1tpIC8gM11cbiAgICAgICAgICAgICAgICAgICAgJiYgYXR0YWNrX2ludGVuc2l0eVtpXSA+IGF0dGFja1RocmVzaG9sZClcbiAgICAgICAgICAgICAgICAgICAgbnNfYXR0YWNrc1tpIC8gM10gPSAoaSAlIDMpICsgMTtcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIHNob3VsZCBoYXZlIGVuZXJneSBjaGFuZ2UgYmV0d2VlbiBzaG9ydCBibG9ja3MsIGluIG9yZGVyIHRvIGF2b2lkXG4gICAgICAgICAgICAgKiBwZXJpb2RpYyBzaWduYWxzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGZvciAoaSA9IDE7IGkgPCA0OyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgcmF0aW87XG4gICAgICAgICAgICAgICAgaWYgKGVuX3Nob3J0W2kgLSAxXSA+IGVuX3Nob3J0W2ldKSB7XG4gICAgICAgICAgICAgICAgICAgIHJhdGlvID0gZW5fc2hvcnRbaSAtIDFdIC8gZW5fc2hvcnRbaV07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmF0aW8gPSBlbl9zaG9ydFtpXSAvIGVuX3Nob3J0W2kgLSAxXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHJhdGlvIDwgMS43KSB7XG4gICAgICAgICAgICAgICAgICAgIG5zX2F0dGFja3NbaV0gPSAwO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PSAxKVxuICAgICAgICAgICAgICAgICAgICAgICAgbnNfYXR0YWNrc1swXSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobnNfYXR0YWNrc1swXSAhPSAwICYmIGdmYy5uc1BzeS5sYXN0QXR0YWNrc1tjaG5dICE9IDApXG4gICAgICAgICAgICAgICAgbnNfYXR0YWNrc1swXSA9IDA7XG5cbiAgICAgICAgICAgIGlmIChnZmMubnNQc3kubGFzdEF0dGFja3NbY2huXSA9PSAzXG4gICAgICAgICAgICAgICAgfHwgKG5zX2F0dGFja3NbMF0gKyBuc19hdHRhY2tzWzFdICsgbnNfYXR0YWNrc1syXSArIG5zX2F0dGFja3NbM10pICE9IDApIHtcbiAgICAgICAgICAgICAgICBuc191c2Vsb25nYmxvY2sgPSAwO1xuXG4gICAgICAgICAgICAgICAgaWYgKG5zX2F0dGFja3NbMV0gIT0gMCAmJiBuc19hdHRhY2tzWzBdICE9IDApXG4gICAgICAgICAgICAgICAgICAgIG5zX2F0dGFja3NbMV0gPSAwO1xuICAgICAgICAgICAgICAgIGlmIChuc19hdHRhY2tzWzJdICE9IDAgJiYgbnNfYXR0YWNrc1sxXSAhPSAwKVxuICAgICAgICAgICAgICAgICAgICBuc19hdHRhY2tzWzJdID0gMDtcbiAgICAgICAgICAgICAgICBpZiAobnNfYXR0YWNrc1szXSAhPSAwICYmIG5zX2F0dGFja3NbMl0gIT0gMClcbiAgICAgICAgICAgICAgICAgICAgbnNfYXR0YWNrc1szXSA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChjaG4gPCAyKSB7XG4gICAgICAgICAgICAgICAgdXNlbG9uZ2Jsb2NrW2Nobl0gPSBuc191c2Vsb25nYmxvY2s7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmIChuc191c2Vsb25nYmxvY2sgPT0gMCkge1xuICAgICAgICAgICAgICAgICAgICB1c2Vsb25nYmxvY2tbMF0gPSB1c2Vsb25nYmxvY2tbMV0gPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIHRoZXJlIGlzIGEgb25lIGdyYW51bGUgZGVsYXkuIENvcHkgbWFza2luZ3MgY29tcHV0ZWQgbGFzdCBjYWxsXG4gICAgICAgICAgICAgKiBpbnRvIG1hc2tpbmdfcmF0aW8gdG8gcmV0dXJuIHRvIGNhbGxpbmcgcHJvZ3JhbS5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZW5lcmd5W2Nobl0gPSBnZmMudG90X2VuZXJbY2huXTtcblxuICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgICAgICogY29tcHV0ZSBGRlRzXG4gICAgICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICAgICAgd3NhbXBfcyA9IHdzYW1wX1M7XG4gICAgICAgICAgICB3c2FtcF9sID0gd3NhbXBfTDtcbiAgICAgICAgICAgIGNvbXB1dGVfZmZ0cyhnZnAsIGZmdGVuZXJneSwgZmZ0ZW5lcmd5X3MsIHdzYW1wX2wsIChjaG4gJiAxKSxcbiAgICAgICAgICAgICAgICB3c2FtcF9zLCAoY2huICYgMSksIGdyX291dCwgY2huLCBidWZmZXIsIGJ1ZlBvcyk7XG5cbiAgICAgICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICAgICAqIENhbGN1bGF0ZSB0aGUgZW5lcmd5IGFuZCB0aGUgdG9uYWxpdHkgb2YgZWFjaCBwYXJ0aXRpb24uXG4gICAgICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICAgICAgY2FsY19lbmVyZ3koZ2ZjLCBmZnRlbmVyZ3ksIGViX2wsIG1heCwgYXZnKTtcbiAgICAgICAgICAgIGNhbGNfbWFza19pbmRleF9sKGdmYywgbWF4LCBhdmcsIG1hc2tfaWR4X2wpO1xuICAgICAgICAgICAgLyogY29tcHV0ZSBtYXNraW5nIHRocmVzaG9sZHMgZm9yIHNob3J0IGJsb2NrcyAqL1xuICAgICAgICAgICAgZm9yIChzYmxvY2sgPSAwOyBzYmxvY2sgPCAzOyBzYmxvY2srKykge1xuICAgICAgICAgICAgICAgIHZhciBlbm4sIHRobW07XG4gICAgICAgICAgICAgICAgY29tcHV0ZV9tYXNraW5nX3MoZ2ZwLCBmZnRlbmVyZ3lfcywgZWJfcywgdGhyLCBjaG4sIHNibG9jayk7XG4gICAgICAgICAgICAgICAgY29udmVydF9wYXJ0aXRpb24yc2NhbGVmYWNfcyhnZmMsIGViX3MsIHRociwgY2huLCBzYmxvY2spO1xuICAgICAgICAgICAgICAgIC8qKioqIHNob3J0IGJsb2NrIHByZS1lY2hvIGNvbnRyb2wgKioqKi9cbiAgICAgICAgICAgICAgICBmb3IgKHNiID0gMDsgc2IgPCBFbmNvZGVyLlNCTUFYX3M7IHNiKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdGhtbSA9IGdmYy50aG1bY2huXS5zW3NiXVtzYmxvY2tdO1xuXG4gICAgICAgICAgICAgICAgICAgIHRobW0gKj0gTlNfUFJFRUNIT19BVFQwO1xuICAgICAgICAgICAgICAgICAgICBpZiAobnNfYXR0YWNrc1tzYmxvY2tdID49IDIgfHwgbnNfYXR0YWNrc1tzYmxvY2sgKyAxXSA9PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gKHNibG9jayAhPSAwKSA/IHNibG9jayAtIDEgOiAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBOU19JTlRFUlAoZ2ZjLnRobVtjaG5dLnNbc2JdW2lkeF0sIHRobW0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTlNfUFJFRUNIT19BVFQxICogcGNmYWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRobW0gPSBNYXRoLm1pbih0aG1tLCBwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChuc19hdHRhY2tzW3NibG9ja10gPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IChzYmxvY2sgIT0gMCkgPyBzYmxvY2sgLSAxIDogMjtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwID0gTlNfSU5URVJQKGdmYy50aG1bY2huXS5zW3NiXVtpZHhdLCB0aG1tLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5TX1BSRUVDSE9fQVRUMiAqIHBjZmFjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aG1tID0gTWF0aC5taW4odGhtbSwgcCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoKHNibG9jayAhPSAwICYmIG5zX2F0dGFja3Nbc2Jsb2NrIC0gMV0gPT0gMylcbiAgICAgICAgICAgICAgICAgICAgICAgIHx8IChzYmxvY2sgPT0gMCAmJiBnZmMubnNQc3kubGFzdEF0dGFja3NbY2huXSA9PSAzKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IChzYmxvY2sgIT0gMikgPyBzYmxvY2sgKyAxIDogMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwID0gTlNfSU5URVJQKGdmYy50aG1bY2huXS5zW3NiXVtpZHhdLCB0aG1tLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5TX1BSRUVDSE9fQVRUMiAqIHBjZmFjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aG1tID0gTWF0aC5taW4odGhtbSwgcCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvKiBwdWxzZSBsaWtlIHNpZ25hbCBkZXRlY3Rpb24gZm9yIGZhdGJveS53YXYgYW5kIHNvIG9uICovXG4gICAgICAgICAgICAgICAgICAgIGVubiA9IGVuX3N1YnNob3J0W3NibG9jayAqIDMgKyAzXVxuICAgICAgICAgICAgICAgICAgICAgICAgKyBlbl9zdWJzaG9ydFtzYmxvY2sgKiAzICsgNF1cbiAgICAgICAgICAgICAgICAgICAgICAgICsgZW5fc3Vic2hvcnRbc2Jsb2NrICogMyArIDVdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZW5fc3Vic2hvcnRbc2Jsb2NrICogMyArIDVdICogNiA8IGVubikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhtbSAqPSAwLjU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZW5fc3Vic2hvcnRbc2Jsb2NrICogMyArIDRdICogNiA8IGVubilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aG1tICo9IDAuNTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGdmYy50aG1bY2huXS5zW3NiXVtzYmxvY2tdID0gdGhtbTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMubnNQc3kubGFzdEF0dGFja3NbY2huXSA9IG5zX2F0dGFja3NbMl07XG5cbiAgICAgICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgICAgICAgICAqIGNvbnZvbHZlIHRoZSBwYXJ0aXRpb25lZCBlbmVyZ3kgYW5kIHVucHJlZGljdGFiaWxpdHkgd2l0aCB0aGVcbiAgICAgICAgICAgICAqIHNwcmVhZGluZyBmdW5jdGlvbiwgczNfbFtiXVtrXVxuICAgICAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICAgICAgayA9IDA7XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZm9yIChiID0gMDsgYiA8IGdmYy5ucGFydF9sOyBiKyspIHtcbiAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICogY29udm9sdmUgdGhlIHBhcnRpdGlvbmVkIGVuZXJneSB3aXRoIHRoZSBzcHJlYWRpbmdcbiAgICAgICAgICAgICAgICAgICAgICogZnVuY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgICAgIHZhciBrayA9IGdmYy5zM2luZFtiXVswXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGViMiA9IGViX2xba2tdICogdGFiW21hc2tfaWR4X2xba2tdXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVjYiA9IGdmYy5zM19sbFtrKytdICogZWIyO1xuICAgICAgICAgICAgICAgICAgICB3aGlsZSAoKytrayA8PSBnZmMuczNpbmRbYl1bMV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGViMiA9IGViX2xba2tdICogdGFiW21hc2tfaWR4X2xba2tdXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVjYiA9IG1hc2tfYWRkKGVjYiwgZ2ZjLnMzX2xsW2srK10gKiBlYjIsIGtrLCBrayAtIGIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ZjLCAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlY2IgKj0gMC4xNTg0ODkzMTkyNDYxMTE7XG4gICAgICAgICAgICAgICAgICAgIC8qIHBvdygxMCwtMC44KSAqL1xuXG4gICAgICAgICAgICAgICAgICAgIC8qKioqIGxvbmcgYmxvY2sgcHJlLWVjaG8gY29udHJvbCAqKioqL1xuICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICogPFBSRT5cbiAgICAgICAgICAgICAgICAgICAgICogZG9udCB1c2UgbG9uZyBibG9jayBwcmUtZWNobyBjb250cm9sIGlmIHByZXZpb3VzIGdyYW51bGUgd2FzXG4gICAgICAgICAgICAgICAgICAgICAqIGEgc2hvcnQgYmxvY2suICBUaGlzIGlzIHRvIGF2b2lkIHRoZSBzaXR1YXRpb246XG4gICAgICAgICAgICAgICAgICAgICAqIGZyYW1lMDogIHF1aWV0ICh2ZXJ5IGxvdyBtYXNraW5nKVxuICAgICAgICAgICAgICAgICAgICAgKiBmcmFtZTE6ICBzdXJnZSAgKHRyaWdnZXJzIHNob3J0IGJsb2NrcylcbiAgICAgICAgICAgICAgICAgICAgICogZnJhbWUyOiAgcmVndWxhciBmcmFtZS4gIGxvb2tzIGxpa2UgcHJlLWVjaG8gd2hlbiBjb21wYXJlZCB0b1xuICAgICAgICAgICAgICAgICAgICAgKiAgICAgICAgICBmcmFtZTAsIGJ1dCBhbGwgcHJlLWVjaG8gd2FzIGluIGZyYW1lMS5cbiAgICAgICAgICAgICAgICAgICAgICogPC9QUkU+XG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgKiBjaG49MCwxIEwgYW5kIFIgY2hhbm5lbHNcbiAgICAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICAgICogY2huPTIsMyBTIGFuZCBNIGNoYW5uZWxzLlxuICAgICAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICAgICBpZiAoZ2ZjLmJsb2NrdHlwZV9vbGRbY2huICYgMV0gPT0gRW5jb2Rlci5TSE9SVF9UWVBFKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyW2JdID0gZWNiO1xuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJbYl0gPSBOU19JTlRFUlAoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5taW4oZWNiLCBNYXRoLm1pbihycGVsZXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBnZmMubmJfMVtjaG5dW2JdLCBycGVsZXYyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogZ2ZjLm5iXzJbY2huXVtiXSkpLCBlY2IsIHBjZmFjdCk7XG5cbiAgICAgICAgICAgICAgICAgICAgZ2ZjLm5iXzJbY2huXVtiXSA9IGdmYy5uYl8xW2Nobl1bYl07XG4gICAgICAgICAgICAgICAgICAgIGdmYy5uYl8xW2Nobl1bYl0gPSBlY2I7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICg7IGIgPD0gRW5jb2Rlci5DQkFORFM7ICsrYikge1xuICAgICAgICAgICAgICAgIGViX2xbYl0gPSAwO1xuICAgICAgICAgICAgICAgIHRocltiXSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKiBjb21wdXRlIG1hc2tpbmcgdGhyZXNob2xkcyBmb3IgbG9uZyBibG9ja3MgKi9cbiAgICAgICAgICAgIGNvbnZlcnRfcGFydGl0aW9uMnNjYWxlZmFjX2woZ2ZjLCBlYl9sLCB0aHIsIGNobik7XG4gICAgICAgIH1cbiAgICAgICAgLyogZW5kIGxvb3Agb3ZlciBjaG4gKi9cblxuICAgICAgICBpZiAoZ2ZwLm1vZGUgPT0gTVBFR01vZGUuU1RFUkVPIHx8IGdmcC5tb2RlID09IE1QRUdNb2RlLkpPSU5UX1NURVJFTykge1xuICAgICAgICAgICAgaWYgKGdmcC5pbnRlckNoUmF0aW8gPiAwLjApIHtcbiAgICAgICAgICAgICAgICBjYWxjX2ludGVyY2hhbm5lbF9tYXNraW5nKGdmcCwgZ2ZwLmludGVyQ2hSYXRpbyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ2ZwLm1vZGUgPT0gTVBFR01vZGUuSk9JTlRfU1RFUkVPKSB7XG4gICAgICAgICAgICB2YXIgbXNmaXg7XG4gICAgICAgICAgICBtc2ZpeDEoZ2ZjKTtcbiAgICAgICAgICAgIG1zZml4ID0gZ2ZwLm1zZml4O1xuICAgICAgICAgICAgaWYgKE1hdGguYWJzKG1zZml4KSA+IDAuMClcbiAgICAgICAgICAgICAgICBuc19tc2ZpeChnZmMsIG1zZml4LCBnZnAuQVRIbG93ZXIgKiBnZmMuQVRILmFkanVzdCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIGRldGVybWluZSBmaW5hbCBibG9jayB0eXBlXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIGJsb2NrX3R5cGVfc2V0KGdmcCwgdXNlbG9uZ2Jsb2NrLCBibG9ja3R5cGVfZCwgYmxvY2t0eXBlKTtcblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIGNvbXB1dGUgdGhlIHZhbHVlIG9mIFBFIHRvIHJldHVybiAuLi4gbm8gZGVsYXkgYW5kIGFkdmFuY2VcbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgZm9yIChjaG4gPSAwOyBjaG4gPCBudW1jaG47IGNobisrKSB7XG4gICAgICAgICAgICB2YXIgcHBlO1xuICAgICAgICAgICAgdmFyIHBwZVBvcyA9IDA7XG4gICAgICAgICAgICB2YXIgdHlwZTtcbiAgICAgICAgICAgIHZhciBtcjtcblxuICAgICAgICAgICAgaWYgKGNobiA+IDEpIHtcbiAgICAgICAgICAgICAgICBwcGUgPSBwZXJjZXBfTVNfZW50cm9weTtcbiAgICAgICAgICAgICAgICBwcGVQb3MgPSAtMjtcbiAgICAgICAgICAgICAgICB0eXBlID0gRW5jb2Rlci5OT1JNX1RZUEU7XG4gICAgICAgICAgICAgICAgaWYgKGJsb2NrdHlwZV9kWzBdID09IEVuY29kZXIuU0hPUlRfVFlQRVxuICAgICAgICAgICAgICAgICAgICB8fCBibG9ja3R5cGVfZFsxXSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpXG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSBFbmNvZGVyLlNIT1JUX1RZUEU7XG4gICAgICAgICAgICAgICAgbXIgPSBtYXNraW5nX01TX3JhdGlvW2dyX291dF1bY2huIC0gMl07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBwZSA9IHBlcmNlcF9lbnRyb3B5O1xuICAgICAgICAgICAgICAgIHBwZVBvcyA9IDA7XG4gICAgICAgICAgICAgICAgdHlwZSA9IGJsb2NrdHlwZV9kW2Nobl07XG4gICAgICAgICAgICAgICAgbXIgPSBtYXNraW5nX3JhdGlvW2dyX291dF1bY2huXTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHR5cGUgPT0gRW5jb2Rlci5TSE9SVF9UWVBFKVxuICAgICAgICAgICAgICAgIHBwZVtwcGVQb3MgKyBjaG5dID0gcGVjYWxjX3MobXIsIGdmYy5tYXNraW5nX2xvd2VyKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBwcGVbcHBlUG9zICsgY2huXSA9IHBlY2FsY19sKG1yLCBnZmMubWFza2luZ19sb3dlcik7XG5cbiAgICAgICAgICAgIGlmIChnZnAuYW5hbHlzaXMpXG4gICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLnBlW2dyX291dF1bY2huXSA9IHBwZVtwcGVQb3MgKyBjaG5dO1xuXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdmJycHN5X2NvbXB1dGVfZmZ0X2woZ2ZwLCBidWZmZXIsIGJ1ZlBvcywgY2huLCBncl9vdXQsIGZmdGVuZXJneSwgd3NhbXBfbCwgd3NhbXBfbFBvcykge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICBpZiAoY2huIDwgMikge1xuICAgICAgICAgICAgZmZ0LmZmdF9sb25nKGdmYywgd3NhbXBfbFt3c2FtcF9sUG9zXSwgY2huLCBidWZmZXIsIGJ1ZlBvcyk7XG4gICAgICAgIH0gZWxzZSBpZiAoY2huID09IDIpIHtcbiAgICAgICAgICAgIC8qIEZGVCBkYXRhIGZvciBtaWQgYW5kIHNpZGUgY2hhbm5lbCBpcyBkZXJpdmVkIGZyb20gTCAmIFIgKi9cbiAgICAgICAgICAgIGZvciAodmFyIGogPSBFbmNvZGVyLkJMS1NJWkUgLSAxOyBqID49IDA7IC0taikge1xuICAgICAgICAgICAgICAgIHZhciBsID0gd3NhbXBfbFt3c2FtcF9sUG9zICsgMF1bal07XG4gICAgICAgICAgICAgICAgdmFyIHIgPSB3c2FtcF9sW3dzYW1wX2xQb3MgKyAxXVtqXTtcbiAgICAgICAgICAgICAgICB3c2FtcF9sW3dzYW1wX2xQb3MgKyAwXVtqXSA9IChsICsgcikgKiBVdGlsLlNRUlQyICogMC41O1xuICAgICAgICAgICAgICAgIHdzYW1wX2xbd3NhbXBfbFBvcyArIDFdW2pdID0gKGwgLSByKSAqIFV0aWwuU1FSVDIgKiAwLjU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIGNvbXB1dGUgZW5lcmdpZXNcbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgZmZ0ZW5lcmd5WzBdID0gTk9OX0xJTkVBUl9TQ0FMRV9FTkVSR1kod3NhbXBfbFt3c2FtcF9sUG9zICsgMF1bMF0pO1xuICAgICAgICBmZnRlbmVyZ3lbMF0gKj0gZmZ0ZW5lcmd5WzBdO1xuXG4gICAgICAgIGZvciAodmFyIGogPSBFbmNvZGVyLkJMS1NJWkUgLyAyIC0gMTsgaiA+PSAwOyAtLWopIHtcbiAgICAgICAgICAgIHZhciByZSA9IHdzYW1wX2xbd3NhbXBfbFBvcyArIDBdW0VuY29kZXIuQkxLU0laRSAvIDIgLSBqXTtcbiAgICAgICAgICAgIHZhciBpbSA9IHdzYW1wX2xbd3NhbXBfbFBvcyArIDBdW0VuY29kZXIuQkxLU0laRSAvIDIgKyBqXTtcbiAgICAgICAgICAgIGZmdGVuZXJneVtFbmNvZGVyLkJMS1NJWkUgLyAyIC0gal0gPSBOT05fTElORUFSX1NDQUxFX0VORVJHWSgocmVcbiAgICAgICAgICAgICAgICAqIHJlICsgaW0gKiBpbSkgKiAwLjUpO1xuICAgICAgICB9XG4gICAgICAgIC8qIHRvdGFsIGVuZXJneSAqL1xuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgdG90YWxlbmVyZ3kgPSAwLjA7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMTE7IGogPCBFbmNvZGVyLkhCTEtTSVpFOyBqKyspXG4gICAgICAgICAgICAgICAgdG90YWxlbmVyZ3kgKz0gZmZ0ZW5lcmd5W2pdO1xuXG4gICAgICAgICAgICBnZmMudG90X2VuZXJbY2huXSA9IHRvdGFsZW5lcmd5O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGdmcC5hbmFseXNpcykge1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBFbmNvZGVyLkhCTEtTSVpFOyBqKyspIHtcbiAgICAgICAgICAgICAgICBnZmMucGluZm8uZW5lcmd5W2dyX291dF1bY2huXVtqXSA9IGdmYy5waW5mby5lbmVyZ3lfc2F2ZVtjaG5dW2pdO1xuICAgICAgICAgICAgICAgIGdmYy5waW5mby5lbmVyZ3lfc2F2ZVtjaG5dW2pdID0gZmZ0ZW5lcmd5W2pdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLnBpbmZvLnBlW2dyX291dF1bY2huXSA9IGdmYy5wZVtjaG5dO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdmJycHN5X2NvbXB1dGVfZmZ0X3MoZ2ZwLCBidWZmZXIsIGJ1ZlBvcywgY2huLCBzYmxvY2ssIGZmdGVuZXJneV9zLCB3c2FtcF9zLCB3c2FtcF9zUG9zKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cbiAgICAgICAgaWYgKHNibG9jayA9PSAwICYmIGNobiA8IDIpIHtcbiAgICAgICAgICAgIGZmdC5mZnRfc2hvcnQoZ2ZjLCB3c2FtcF9zW3dzYW1wX3NQb3NdLCBjaG4sIGJ1ZmZlciwgYnVmUG9zKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY2huID09IDIpIHtcbiAgICAgICAgICAgIC8qIEZGVCBkYXRhIGZvciBtaWQgYW5kIHNpZGUgY2hhbm5lbCBpcyBkZXJpdmVkIGZyb20gTCAmIFIgKi9cbiAgICAgICAgICAgIGZvciAodmFyIGogPSBFbmNvZGVyLkJMS1NJWkVfcyAtIDE7IGogPj0gMDsgLS1qKSB7XG4gICAgICAgICAgICAgICAgdmFyIGwgPSB3c2FtcF9zW3dzYW1wX3NQb3MgKyAwXVtzYmxvY2tdW2pdO1xuICAgICAgICAgICAgICAgIHZhciByID0gd3NhbXBfc1t3c2FtcF9zUG9zICsgMV1bc2Jsb2NrXVtqXTtcbiAgICAgICAgICAgICAgICB3c2FtcF9zW3dzYW1wX3NQb3MgKyAwXVtzYmxvY2tdW2pdID0gKGwgKyByKSAqIFV0aWwuU1FSVDIgKiAwLjU7XG4gICAgICAgICAgICAgICAgd3NhbXBfc1t3c2FtcF9zUG9zICsgMV1bc2Jsb2NrXVtqXSA9IChsIC0gcikgKiBVdGlsLlNRUlQyICogMC41O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBjb21wdXRlIGVuZXJnaWVzXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIGZmdGVuZXJneV9zW3NibG9ja11bMF0gPSB3c2FtcF9zW3dzYW1wX3NQb3MgKyAwXVtzYmxvY2tdWzBdO1xuICAgICAgICBmZnRlbmVyZ3lfc1tzYmxvY2tdWzBdICo9IGZmdGVuZXJneV9zW3NibG9ja11bMF07XG4gICAgICAgIGZvciAodmFyIGogPSBFbmNvZGVyLkJMS1NJWkVfcyAvIDIgLSAxOyBqID49IDA7IC0taikge1xuICAgICAgICAgICAgdmFyIHJlID0gd3NhbXBfc1t3c2FtcF9zUG9zICsgMF1bc2Jsb2NrXVtFbmNvZGVyLkJMS1NJWkVfcyAvIDIgLSBqXTtcbiAgICAgICAgICAgIHZhciBpbSA9IHdzYW1wX3Nbd3NhbXBfc1BvcyArIDBdW3NibG9ja11bRW5jb2Rlci5CTEtTSVpFX3MgLyAyICsgal07XG4gICAgICAgICAgICBmZnRlbmVyZ3lfc1tzYmxvY2tdW0VuY29kZXIuQkxLU0laRV9zIC8gMiAtIGpdID0gTk9OX0xJTkVBUl9TQ0FMRV9FTkVSR1koKHJlXG4gICAgICAgICAgICAgICAgKiByZSArIGltICogaW0pICogMC41KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIGNvbXB1dGUgbG91ZG5lc3MgYXBwcm94aW1hdGlvbiAodXNlZCBmb3IgQVRIIGF1dG8tbGV2ZWwgYWRqdXN0bWVudClcbiAgICAgKi9cbiAgICBmdW5jdGlvbiB2YnJwc3lfY29tcHV0ZV9sb3VkbmVzc19hcHByb3hpbWF0aW9uX2woZ2ZwLCBncl9vdXQsIGNobiwgZmZ0ZW5lcmd5KSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIGlmIChnZnAuYXRoYWFfbG91ZGFwcHJveCA9PSAyICYmIGNobiA8IDIpIHtcbiAgICAgICAgICAgIC8vIG5vIGxvdWRuZXNzIGZvciBtaWQvc2lkZSBjaFxuICAgICAgICAgICAgZ2ZjLmxvdWRuZXNzX3NxW2dyX291dF1bY2huXSA9IGdmYy5sb3VkbmVzc19zcV9zYXZlW2Nobl07XG4gICAgICAgICAgICBnZmMubG91ZG5lc3Nfc3Ffc2F2ZVtjaG5dID0gcHN5Y2hvX2xvdWRuZXNzX2FwcHJveChmZnRlbmVyZ3ksIGdmYyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB2YXIgZmlyY29lZl8gPSBbLTguNjUxNjNlLTE4ICogMixcbiAgICAgICAgLTAuMDA4NTE1ODYgKiAyLCAtNi43NDc2NGUtMTggKiAyLCAwLjAyMDkwMzYgKiAyLFxuICAgICAgICAtMy4zNjYzOWUtMTcgKiAyLCAtMC4wNDM4MTYyICogMiwgLTEuNTQxNzVlLTE3ICogMixcbiAgICAgICAgMC4wOTMxNzM4ICogMiwgLTUuNTIyMTJlLTE3ICogMiwgLTAuMzEzODE5ICogMl07XG5cbiAgICAvKipcbiAgICAgKiBBcHBseSBIUEYgb2YgZnMvNCB0byB0aGUgaW5wdXQgc2lnbmFsLiBUaGlzIGlzIHVzZWQgZm9yIGF0dGFjayBkZXRlY3Rpb25cbiAgICAgKiAvIGhhbmRsaW5nLlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHZicnBzeV9hdHRhY2tfZGV0ZWN0aW9uKGdmcCwgYnVmZmVyLCBidWZQb3MsIGdyX291dCwgbWFza2luZ19yYXRpbywgbWFza2luZ19NU19yYXRpbywgZW5lcmd5LCBzdWJfc2hvcnRfZmFjdG9yLCBuc19hdHRhY2tzLCB1c2Vsb25nYmxvY2spIHtcbiAgICAgICAgdmFyIG5zX2hwZnNtcGwgPSBuZXdfZmxvYXRfbihbMiwgNTc2XSk7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBuX2Nobl9vdXQgPSBnZmMuY2hhbm5lbHNfb3V0O1xuICAgICAgICAvKiBjaG49MiBhbmQgMyA9IE1pZCBhbmQgU2lkZSBjaGFubmVscyAqL1xuICAgICAgICB2YXIgbl9jaG5fcHN5ID0gKGdmcC5tb2RlID09IE1QRUdNb2RlLkpPSU5UX1NURVJFTykgPyA0IDogbl9jaG5fb3V0O1xuICAgICAgICAvKiBEb24ndCBjb3B5IHRoZSBpbnB1dCBidWZmZXIgaW50byBhIHRlbXBvcmFyeSBidWZmZXIgKi9cbiAgICAgICAgLyogdW5yb2xsIHRoZSBsb29wIDIgdGltZXMgKi9cbiAgICAgICAgZm9yICh2YXIgY2huID0gMDsgY2huIDwgbl9jaG5fb3V0OyBjaG4rKykge1xuICAgICAgICAgICAgLyogYXBwbHkgaGlnaCBwYXNzIGZpbHRlciBvZiBmcy80ICovXG4gICAgICAgICAgICBmaXJidWYgPSBidWZmZXJbY2huXTtcbiAgICAgICAgICAgIHZhciBmaXJidWZQb3MgPSBidWZQb3MgKyA1NzYgLSAzNTAgLSBOU0ZJUkxFTiArIDE5MjtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNTc2OyBpKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgc3VtMSwgc3VtMjtcbiAgICAgICAgICAgICAgICBzdW0xID0gZmlyYnVmW2ZpcmJ1ZlBvcyArIGkgKyAxMF07XG4gICAgICAgICAgICAgICAgc3VtMiA9IDAuMDtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8ICgoTlNGSVJMRU4gLSAxKSAvIDIpIC0gMTsgaiArPSAyKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1bTEgKz0gZmlyY29lZl9bal1cbiAgICAgICAgICAgICAgICAgICAgICAgICogKGZpcmJ1ZltmaXJidWZQb3MgKyBpICsgal0gKyBmaXJidWZbZmlyYnVmUG9zICsgaVxuICAgICAgICAgICAgICAgICAgICAgICAgKyBOU0ZJUkxFTiAtIGpdKTtcbiAgICAgICAgICAgICAgICAgICAgc3VtMiArPSBmaXJjb2VmX1tqICsgMV1cbiAgICAgICAgICAgICAgICAgICAgICAgICogKGZpcmJ1ZltmaXJidWZQb3MgKyBpICsgaiArIDFdICsgZmlyYnVmW2ZpcmJ1ZlBvc1xuICAgICAgICAgICAgICAgICAgICAgICAgKyBpICsgTlNGSVJMRU4gLSBqIC0gMV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBuc19ocGZzbXBsW2Nobl1baV0gPSBzdW0xICsgc3VtMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1hc2tpbmdfcmF0aW9bZ3Jfb3V0XVtjaG5dLmVuLmFzc2lnbihnZmMuZW5bY2huXSk7XG4gICAgICAgICAgICBtYXNraW5nX3JhdGlvW2dyX291dF1bY2huXS50aG0uYXNzaWduKGdmYy50aG1bY2huXSk7XG4gICAgICAgICAgICBpZiAobl9jaG5fcHN5ID4gMikge1xuICAgICAgICAgICAgICAgIC8qIE1TIG1hc2tpbmdzICovXG4gICAgICAgICAgICAgICAgLyogcGVyY2VwX01TX2VudHJvcHkgW2Nobi0yXSA9IGdmYyAuIHBlIFtjaG5dOyAqL1xuICAgICAgICAgICAgICAgIG1hc2tpbmdfTVNfcmF0aW9bZ3Jfb3V0XVtjaG5dLmVuLmFzc2lnbihnZmMuZW5bY2huICsgMl0pO1xuICAgICAgICAgICAgICAgIG1hc2tpbmdfTVNfcmF0aW9bZ3Jfb3V0XVtjaG5dLnRobS5hc3NpZ24oZ2ZjLnRobVtjaG4gKyAyXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgY2huID0gMDsgY2huIDwgbl9jaG5fcHN5OyBjaG4rKykge1xuICAgICAgICAgICAgdmFyIGF0dGFja19pbnRlbnNpdHkgPSBuZXdfZmxvYXQoMTIpO1xuICAgICAgICAgICAgdmFyIGVuX3N1YnNob3J0ID0gbmV3X2Zsb2F0KDEyKTtcbiAgICAgICAgICAgIHZhciBlbl9zaG9ydCA9IFswLCAwLCAwLCAwXTtcbiAgICAgICAgICAgIHZhciBwZiA9IG5zX2hwZnNtcGxbY2huICYgMV07XG4gICAgICAgICAgICB2YXIgcGZQb3MgPSAwO1xuICAgICAgICAgICAgdmFyIGF0dGFja1RocmVzaG9sZCA9IChjaG4gPT0gMykgPyBnZmMubnNQc3kuYXR0YWNrdGhyZV9zXG4gICAgICAgICAgICAgICAgOiBnZmMubnNQc3kuYXR0YWNrdGhyZTtcbiAgICAgICAgICAgIHZhciBuc191c2Vsb25nYmxvY2sgPSAxO1xuXG4gICAgICAgICAgICBpZiAoY2huID09IDIpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgaiA9IDU3NjsgaiA+IDA7ICsraSwgLS1qKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsID0gbnNfaHBmc21wbFswXVtpXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHIgPSBuc19ocGZzbXBsWzFdW2ldO1xuICAgICAgICAgICAgICAgICAgICBuc19ocGZzbXBsWzBdW2ldID0gbCArIHI7XG4gICAgICAgICAgICAgICAgICAgIG5zX2hwZnNtcGxbMV1baV0gPSBsIC0gcjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAgICAgKiBkZXRlcm1pbmUgdGhlIGJsb2NrIHR5cGUgKHdpbmRvdyB0eXBlKVxuICAgICAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgICAgIC8qIGNhbGN1bGF0ZSBlbmVyZ2llcyBvZiBlYWNoIHN1Yi1zaG9ydGJsb2NrcyAqL1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHtcbiAgICAgICAgICAgICAgICBlbl9zdWJzaG9ydFtpXSA9IGdmYy5uc1BzeS5sYXN0X2VuX3N1YnNob3J0W2Nobl1baSArIDZdO1xuICAgICAgICAgICAgICAgIGF0dGFja19pbnRlbnNpdHlbaV0gPSBlbl9zdWJzaG9ydFtpXVxuICAgICAgICAgICAgICAgICAgICAvIGdmYy5uc1BzeS5sYXN0X2VuX3N1YnNob3J0W2Nobl1baSArIDRdO1xuICAgICAgICAgICAgICAgIGVuX3Nob3J0WzBdICs9IGVuX3N1YnNob3J0W2ldO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDk7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciBwZmUgPSBwZlBvcyArIDU3NiAvIDk7XG4gICAgICAgICAgICAgICAgdmFyIHAgPSAxLjtcbiAgICAgICAgICAgICAgICBmb3IgKDsgcGZQb3MgPCBwZmU7IHBmUG9zKyspXG4gICAgICAgICAgICAgICAgICAgIGlmIChwIDwgTWF0aC5hYnMocGZbcGZQb3NdKSlcbiAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBNYXRoLmFicyhwZltwZlBvc10pO1xuXG4gICAgICAgICAgICAgICAgZ2ZjLm5zUHN5Lmxhc3RfZW5fc3Vic2hvcnRbY2huXVtpXSA9IGVuX3N1YnNob3J0W2kgKyAzXSA9IHA7XG4gICAgICAgICAgICAgICAgZW5fc2hvcnRbMSArIGkgLyAzXSArPSBwO1xuICAgICAgICAgICAgICAgIGlmIChwID4gZW5fc3Vic2hvcnRbaSArIDMgLSAyXSkge1xuICAgICAgICAgICAgICAgICAgICBwID0gcCAvIGVuX3N1YnNob3J0W2kgKyAzIC0gMl07XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbl9zdWJzaG9ydFtpICsgMyAtIDJdID4gcCAqIDEwLjApIHtcbiAgICAgICAgICAgICAgICAgICAgcCA9IGVuX3N1YnNob3J0W2kgKyAzIC0gMl0gLyAocCAqIDEwLjApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHAgPSAwLjA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGF0dGFja19pbnRlbnNpdHlbaSArIDNdID0gcDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIHB1bHNlIGxpa2Ugc2lnbmFsIGRldGVjdGlvbiBmb3IgZmF0Ym95LndhdiBhbmQgc28gb24gKi9cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMzsgKytpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVubiA9IGVuX3N1YnNob3J0W2kgKiAzICsgM11cbiAgICAgICAgICAgICAgICAgICAgKyBlbl9zdWJzaG9ydFtpICogMyArIDRdICsgZW5fc3Vic2hvcnRbaSAqIDMgKyA1XTtcbiAgICAgICAgICAgICAgICB2YXIgZmFjdG9yID0gMS47XG4gICAgICAgICAgICAgICAgaWYgKGVuX3N1YnNob3J0W2kgKiAzICsgNV0gKiA2IDwgZW5uKSB7XG4gICAgICAgICAgICAgICAgICAgIGZhY3RvciAqPSAwLjU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbl9zdWJzaG9ydFtpICogMyArIDRdICogNiA8IGVubikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmFjdG9yICo9IDAuNTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdWJfc2hvcnRfZmFjdG9yW2Nobl1baV0gPSBmYWN0b3I7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChnZnAuYW5hbHlzaXMpIHtcbiAgICAgICAgICAgICAgICB2YXIgeCA9IGF0dGFja19pbnRlbnNpdHlbMF07XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCAxMjsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh4IDwgYXR0YWNrX2ludGVuc2l0eVtpXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgeCA9IGF0dGFja19pbnRlbnNpdHlbaV07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLmVyc1tncl9vdXRdW2Nobl0gPSBnZmMucGluZm8uZXJzX3NhdmVbY2huXTtcbiAgICAgICAgICAgICAgICBnZmMucGluZm8uZXJzX3NhdmVbY2huXSA9IHg7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qIGNvbXBhcmUgZW5lcmdpZXMgYmV0d2VlbiBzdWItc2hvcnRibG9ja3MgKi9cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTI7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmICgwID09IG5zX2F0dGFja3NbY2huXVtpIC8gM11cbiAgICAgICAgICAgICAgICAgICAgJiYgYXR0YWNrX2ludGVuc2l0eVtpXSA+IGF0dGFja1RocmVzaG9sZCkge1xuICAgICAgICAgICAgICAgICAgICBuc19hdHRhY2tzW2Nobl1baSAvIDNdID0gKGkgJSAzKSArIDE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogc2hvdWxkIGhhdmUgZW5lcmd5IGNoYW5nZSBiZXR3ZWVuIHNob3J0IGJsb2NrcywgaW4gb3JkZXIgdG8gYXZvaWRcbiAgICAgICAgICAgICAqIHBlcmlvZGljIHNpZ25hbHNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgLyogR29vZCBzYW1wbGVzIHRvIHNob3cgdGhlIGVmZmVjdCBhcmUgVHJ1bXBldCB0ZXN0IHNvbmdzICovXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogR0I6IHR1bmVkICgxKSB0byBhdm9pZCB0b28gbWFueSBzaG9ydCBibG9ja3MgZm9yIHRlc3Qgc2FtcGxlXG4gICAgICAgICAgICAgKiBUUlVNUEVUXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBSSDogdHVuZWQgKDIpIHRvIGxldCBlbm91Z2ggc2hvcnQgYmxvY2tzIHRocm91Z2ggZm9yIHRlc3Qgc2FtcGxlXG4gICAgICAgICAgICAgKiBGU09MIGFuZCBTTkFQU1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IDQ7IGkrKykge1xuICAgICAgICAgICAgICAgIHZhciB1ID0gZW5fc2hvcnRbaSAtIDFdO1xuICAgICAgICAgICAgICAgIHZhciB2ID0gZW5fc2hvcnRbaV07XG4gICAgICAgICAgICAgICAgdmFyIG0gPSBNYXRoLm1heCh1LCB2KTtcbiAgICAgICAgICAgICAgICBpZiAobSA8IDQwMDAwKSB7IC8qICgyKSAqL1xuICAgICAgICAgICAgICAgICAgICBpZiAodSA8IDEuNyAqIHYgJiYgdiA8IDEuNyAqIHUpIHsgLyogKDEpICovXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaSA9PSAxICYmIG5zX2F0dGFja3NbY2huXVswXSA8PSBuc19hdHRhY2tzW2Nobl1baV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuc19hdHRhY2tzW2Nobl1bMF0gPSAwO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgbnNfYXR0YWNrc1tjaG5dW2ldID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKG5zX2F0dGFja3NbY2huXVswXSA8PSBnZmMubnNQc3kubGFzdEF0dGFja3NbY2huXSkge1xuICAgICAgICAgICAgICAgIG5zX2F0dGFja3NbY2huXVswXSA9IDA7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChnZmMubnNQc3kubGFzdEF0dGFja3NbY2huXSA9PSAzXG4gICAgICAgICAgICAgICAgfHwgKG5zX2F0dGFja3NbY2huXVswXSArIG5zX2F0dGFja3NbY2huXVsxXVxuICAgICAgICAgICAgICAgICsgbnNfYXR0YWNrc1tjaG5dWzJdICsgbnNfYXR0YWNrc1tjaG5dWzNdKSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgbnNfdXNlbG9uZ2Jsb2NrID0gMDtcblxuICAgICAgICAgICAgICAgIGlmIChuc19hdHRhY2tzW2Nobl1bMV0gIT0gMCAmJiBuc19hdHRhY2tzW2Nobl1bMF0gIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBuc19hdHRhY2tzW2Nobl1bMV0gPSAwO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAobnNfYXR0YWNrc1tjaG5dWzJdICE9IDAgJiYgbnNfYXR0YWNrc1tjaG5dWzFdICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgbnNfYXR0YWNrc1tjaG5dWzJdID0gMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKG5zX2F0dGFja3NbY2huXVszXSAhPSAwICYmIG5zX2F0dGFja3NbY2huXVsyXSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIG5zX2F0dGFja3NbY2huXVszXSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNobiA8IDIpIHtcbiAgICAgICAgICAgICAgICB1c2Vsb25nYmxvY2tbY2huXSA9IG5zX3VzZWxvbmdibG9jaztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKG5zX3VzZWxvbmdibG9jayA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHVzZWxvbmdibG9ja1swXSA9IHVzZWxvbmdibG9ja1sxXSA9IDA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogdGhlcmUgaXMgYSBvbmUgZ3JhbnVsZSBkZWxheS4gQ29weSBtYXNraW5ncyBjb21wdXRlZCBsYXN0IGNhbGxcbiAgICAgICAgICAgICAqIGludG8gbWFza2luZ19yYXRpbyB0byByZXR1cm4gdG8gY2FsbGluZyBwcm9ncmFtLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBlbmVyZ3lbY2huXSA9IGdmYy50b3RfZW5lcltjaG5dO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdmJycHN5X3NraXBfbWFza2luZ19zKGdmYywgY2huLCBzYmxvY2spIHtcbiAgICAgICAgaWYgKHNibG9jayA9PSAwKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IGdmYy5ucGFydF9zOyBiKyspIHtcbiAgICAgICAgICAgICAgICBnZmMubmJfczJbY2huXVtiXSA9IGdmYy5uYl9zMVtjaG5dW2JdO1xuICAgICAgICAgICAgICAgIGdmYy5uYl9zMVtjaG5dW2JdID0gMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHZicnBzeV9za2lwX21hc2tpbmdfbChnZmMsIGNobikge1xuICAgICAgICBmb3IgKHZhciBiID0gMDsgYiA8IGdmYy5ucGFydF9sOyBiKyspIHtcbiAgICAgICAgICAgIGdmYy5uYl8yW2Nobl1bYl0gPSBnZmMubmJfMVtjaG5dW2JdO1xuICAgICAgICAgICAgZ2ZjLm5iXzFbY2huXVtiXSA9IDA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwc3l2YnJfY2FsY19tYXNrX2luZGV4X3MoZ2ZjLCBtYXgsIGF2ZywgbWFza19pZHgpIHtcbiAgICAgICAgdmFyIGxhc3RfdGFiX2VudHJ5ID0gdGFiLmxlbmd0aCAtIDE7XG4gICAgICAgIHZhciBiID0gMDtcbiAgICAgICAgdmFyIGEgPSBhdmdbYl0gKyBhdmdbYiArIDFdO1xuICAgICAgICBpZiAoYSA+IDAuMCkge1xuICAgICAgICAgICAgdmFyIG0gPSBtYXhbYl07XG4gICAgICAgICAgICBpZiAobSA8IG1heFtiICsgMV0pXG4gICAgICAgICAgICAgICAgbSA9IG1heFtiICsgMV07XG4gICAgICAgICAgICBhID0gMjAuMCAqIChtICogMi4wIC0gYSlcbiAgICAgICAgICAgICAgICAvIChhICogKGdmYy5udW1saW5lc19zW2JdICsgZ2ZjLm51bWxpbmVzX3NbYiArIDFdIC0gMSkpO1xuICAgICAgICAgICAgdmFyIGsgPSAwIHwgYTtcbiAgICAgICAgICAgIGlmIChrID4gbGFzdF90YWJfZW50cnkpXG4gICAgICAgICAgICAgICAgayA9IGxhc3RfdGFiX2VudHJ5O1xuICAgICAgICAgICAgbWFza19pZHhbYl0gPSBrO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbWFza19pZHhbYl0gPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChiID0gMTsgYiA8IGdmYy5ucGFydF9zIC0gMTsgYisrKSB7XG4gICAgICAgICAgICBhID0gYXZnW2IgLSAxXSArIGF2Z1tiXSArIGF2Z1tiICsgMV07XG4gICAgICAgICAgICBpZiAoYSA+IDAuMCkge1xuICAgICAgICAgICAgICAgIHZhciBtID0gbWF4W2IgLSAxXTtcbiAgICAgICAgICAgICAgICBpZiAobSA8IG1heFtiXSlcbiAgICAgICAgICAgICAgICAgICAgbSA9IG1heFtiXTtcbiAgICAgICAgICAgICAgICBpZiAobSA8IG1heFtiICsgMV0pXG4gICAgICAgICAgICAgICAgICAgIG0gPSBtYXhbYiArIDFdO1xuICAgICAgICAgICAgICAgIGEgPSAyMC4wXG4gICAgICAgICAgICAgICAgICAgICogKG0gKiAzLjAgLSBhKVxuICAgICAgICAgICAgICAgICAgICAvIChhICogKGdmYy5udW1saW5lc19zW2IgLSAxXSArIGdmYy5udW1saW5lc19zW2JdXG4gICAgICAgICAgICAgICAgICAgICsgZ2ZjLm51bWxpbmVzX3NbYiArIDFdIC0gMSkpO1xuICAgICAgICAgICAgICAgIHZhciBrID0gMCB8IGE7XG4gICAgICAgICAgICAgICAgaWYgKGsgPiBsYXN0X3RhYl9lbnRyeSlcbiAgICAgICAgICAgICAgICAgICAgayA9IGxhc3RfdGFiX2VudHJ5O1xuICAgICAgICAgICAgICAgIG1hc2tfaWR4W2JdID0gaztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbWFza19pZHhbYl0gPSAwO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgYSA9IGF2Z1tiIC0gMV0gKyBhdmdbYl07XG4gICAgICAgIGlmIChhID4gMC4wKSB7XG4gICAgICAgICAgICB2YXIgbSA9IG1heFtiIC0gMV07XG4gICAgICAgICAgICBpZiAobSA8IG1heFtiXSlcbiAgICAgICAgICAgICAgICBtID0gbWF4W2JdO1xuICAgICAgICAgICAgYSA9IDIwLjAgKiAobSAqIDIuMCAtIGEpXG4gICAgICAgICAgICAgICAgLyAoYSAqIChnZmMubnVtbGluZXNfc1tiIC0gMV0gKyBnZmMubnVtbGluZXNfc1tiXSAtIDEpKTtcbiAgICAgICAgICAgIHZhciBrID0gMCB8IGE7XG4gICAgICAgICAgICBpZiAoayA+IGxhc3RfdGFiX2VudHJ5KVxuICAgICAgICAgICAgICAgIGsgPSBsYXN0X3RhYl9lbnRyeTtcbiAgICAgICAgICAgIG1hc2tfaWR4W2JdID0gaztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1hc2tfaWR4W2JdID0gMDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHZicnBzeV9jb21wdXRlX21hc2tpbmdfcyhnZnAsIGZmdGVuZXJneV9zLCBlYiwgdGhyLCBjaG4sIHNibG9jaykge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgbWF4ID0gbmV3IGZsb2F0W0VuY29kZXIuQ0JBTkRTXSwgYXZnID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTKTtcbiAgICAgICAgdmFyIGksIGosIGI7XG4gICAgICAgIHZhciBtYXNrX2lkeF9zID0gbmV3IGludFtFbmNvZGVyLkNCQU5EU107XG5cbiAgICAgICAgZm9yIChiID0gaiA9IDA7IGIgPCBnZmMubnBhcnRfczsgKytiKSB7XG4gICAgICAgICAgICB2YXIgZWJiID0gMCwgbSA9IDA7XG4gICAgICAgICAgICB2YXIgbiA9IGdmYy5udW1saW5lc19zW2JdO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG47ICsraSwgKytqKSB7XG4gICAgICAgICAgICAgICAgdmFyIGVsID0gZmZ0ZW5lcmd5X3Nbc2Jsb2NrXVtqXTtcbiAgICAgICAgICAgICAgICBlYmIgKz0gZWw7XG4gICAgICAgICAgICAgICAgaWYgKG0gPCBlbClcbiAgICAgICAgICAgICAgICAgICAgbSA9IGVsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWJbYl0gPSBlYmI7XG4gICAgICAgICAgICBtYXhbYl0gPSBtO1xuICAgICAgICAgICAgYXZnW2JdID0gZWJiIC8gbjtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKDsgYiA8IEVuY29kZXIuQ0JBTkRTOyArK2IpIHtcbiAgICAgICAgICAgIG1heFtiXSA9IDA7XG4gICAgICAgICAgICBhdmdbYl0gPSAwO1xuICAgICAgICB9XG4gICAgICAgIHBzeXZicl9jYWxjX21hc2tfaW5kZXhfcyhnZmMsIG1heCwgYXZnLCBtYXNrX2lkeF9zKTtcbiAgICAgICAgZm9yIChqID0gYiA9IDA7IGIgPCBnZmMubnBhcnRfczsgYisrKSB7XG4gICAgICAgICAgICB2YXIga2sgPSBnZmMuczNpbmRfc1tiXVswXTtcbiAgICAgICAgICAgIHZhciBsYXN0ID0gZ2ZjLnMzaW5kX3NbYl1bMV07XG4gICAgICAgICAgICB2YXIgZGQsIGRkX247XG4gICAgICAgICAgICB2YXIgeCwgZWNiLCBhdmdfbWFzaztcbiAgICAgICAgICAgIGRkID0gbWFza19pZHhfc1tra107XG4gICAgICAgICAgICBkZF9uID0gMTtcbiAgICAgICAgICAgIGVjYiA9IGdmYy5zM19zc1tqXSAqIGViW2trXSAqIHRhYlttYXNrX2lkeF9zW2trXV07XG4gICAgICAgICAgICArK2o7XG4gICAgICAgICAgICArK2trO1xuICAgICAgICAgICAgd2hpbGUgKGtrIDw9IGxhc3QpIHtcbiAgICAgICAgICAgICAgICBkZCArPSBtYXNrX2lkeF9zW2trXTtcbiAgICAgICAgICAgICAgICBkZF9uICs9IDE7XG4gICAgICAgICAgICAgICAgeCA9IGdmYy5zM19zc1tqXSAqIGViW2trXSAqIHRhYlttYXNrX2lkeF9zW2trXV07XG4gICAgICAgICAgICAgICAgZWNiID0gdmJycHN5X21hc2tfYWRkKGVjYiwgeCwga2sgLSBiKTtcbiAgICAgICAgICAgICAgICArK2o7XG4gICAgICAgICAgICAgICAgKytraztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRkID0gKDEgKyAyICogZGQpIC8gKDIgKiBkZF9uKTtcbiAgICAgICAgICAgIGF2Z19tYXNrID0gdGFiW2RkXSAqIDAuNTtcbiAgICAgICAgICAgIGVjYiAqPSBhdmdfbWFzaztcbiAgICAgICAgICAgIHRocltiXSA9IGVjYjtcbiAgICAgICAgICAgIGdmYy5uYl9zMltjaG5dW2JdID0gZ2ZjLm5iX3MxW2Nobl1bYl07XG4gICAgICAgICAgICBnZmMubmJfczFbY2huXVtiXSA9IGVjYjtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIGlmIFRIUiBleGNlZWRzIEVCLCB0aGUgcXVhbnRpemF0aW9uIHJvdXRpbmVzIHdpbGwgdGFrZSB0aGVcbiAgICAgICAgICAgICAgICAgKiBkaWZmZXJlbmNlIGZyb20gb3RoZXIgYmFuZHMuIGluIGNhc2Ugb2Ygc3Ryb25nIHRvbmFsIHNhbXBsZXNcbiAgICAgICAgICAgICAgICAgKiAodG9uYWx0ZXN0LndhdikgdGhpcyBsZWFkcyB0byBoZWF2eSBkaXN0b3J0aW9ucy4gdGhhdCdzIHdoeVxuICAgICAgICAgICAgICAgICAqIHdlIGxpbWl0IFRIUiBoZXJlLlxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIHggPSBtYXhbYl07XG4gICAgICAgICAgICAgICAgeCAqPSBnZmMubWludmFsX3NbYl07XG4gICAgICAgICAgICAgICAgeCAqPSBhdmdfbWFzaztcbiAgICAgICAgICAgICAgICBpZiAodGhyW2JdID4geCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJbYl0gPSB4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChnZmMubWFza2luZ19sb3dlciA+IDEpIHtcbiAgICAgICAgICAgICAgICB0aHJbYl0gKj0gZ2ZjLm1hc2tpbmdfbG93ZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhyW2JdID4gZWJbYl0pIHtcbiAgICAgICAgICAgICAgICB0aHJbYl0gPSBlYltiXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChnZmMubWFza2luZ19sb3dlciA8IDEpIHtcbiAgICAgICAgICAgICAgICB0aHJbYl0gKj0gZ2ZjLm1hc2tpbmdfbG93ZXI7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgICBmb3IgKDsgYiA8IEVuY29kZXIuQ0JBTkRTOyArK2IpIHtcbiAgICAgICAgICAgIGViW2JdID0gMDtcbiAgICAgICAgICAgIHRocltiXSA9IDA7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiB2YnJwc3lfY29tcHV0ZV9tYXNraW5nX2woZ2ZjLCBmZnRlbmVyZ3ksIGViX2wsIHRociwgY2huKSB7XG4gICAgICAgIHZhciBtYXggPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMpLCBhdmcgPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMpO1xuICAgICAgICB2YXIgbWFza19pZHhfbCA9IG5ld19pbnQoRW5jb2Rlci5DQkFORFMgKyAyKTtcbiAgICAgICAgdmFyIGI7XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBDYWxjdWxhdGUgdGhlIGVuZXJneSBhbmQgdGhlIHRvbmFsaXR5IG9mIGVhY2ggcGFydGl0aW9uLlxuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICBjYWxjX2VuZXJneShnZmMsIGZmdGVuZXJneSwgZWJfbCwgbWF4LCBhdmcpO1xuICAgICAgICBjYWxjX21hc2tfaW5kZXhfbChnZmMsIG1heCwgYXZnLCBtYXNrX2lkeF9sKTtcblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIGNvbnZvbHZlIHRoZSBwYXJ0aXRpb25lZCBlbmVyZ3kgYW5kIHVucHJlZGljdGFiaWxpdHkgd2l0aCB0aGVcbiAgICAgICAgICogc3ByZWFkaW5nIGZ1bmN0aW9uLCBzM19sW2JdW2tdXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgdmFyIGsgPSAwO1xuICAgICAgICBmb3IgKGIgPSAwOyBiIDwgZ2ZjLm5wYXJ0X2w7IGIrKykge1xuICAgICAgICAgICAgdmFyIHgsIGVjYiwgYXZnX21hc2ssIHQ7XG4gICAgICAgICAgICAvKiBjb252b2x2ZSB0aGUgcGFydGl0aW9uZWQgZW5lcmd5IHdpdGggdGhlIHNwcmVhZGluZyBmdW5jdGlvbiAqL1xuICAgICAgICAgICAgdmFyIGtrID0gZ2ZjLnMzaW5kW2JdWzBdO1xuICAgICAgICAgICAgdmFyIGxhc3QgPSBnZmMuczNpbmRbYl1bMV07XG4gICAgICAgICAgICB2YXIgZGQgPSAwLCBkZF9uID0gMDtcbiAgICAgICAgICAgIGRkID0gbWFza19pZHhfbFtra107XG4gICAgICAgICAgICBkZF9uICs9IDE7XG4gICAgICAgICAgICBlY2IgPSBnZmMuczNfbGxba10gKiBlYl9sW2trXSAqIHRhYlttYXNrX2lkeF9sW2trXV07XG4gICAgICAgICAgICArK2s7XG4gICAgICAgICAgICArK2trO1xuICAgICAgICAgICAgd2hpbGUgKGtrIDw9IGxhc3QpIHtcbiAgICAgICAgICAgICAgICBkZCArPSBtYXNrX2lkeF9sW2trXTtcbiAgICAgICAgICAgICAgICBkZF9uICs9IDE7XG4gICAgICAgICAgICAgICAgeCA9IGdmYy5zM19sbFtrXSAqIGViX2xba2tdICogdGFiW21hc2tfaWR4X2xba2tdXTtcbiAgICAgICAgICAgICAgICB0ID0gdmJycHN5X21hc2tfYWRkKGVjYiwgeCwga2sgLSBiKTtcbiAgICAgICAgICAgICAgICBlY2IgPSB0O1xuICAgICAgICAgICAgICAgICsraztcbiAgICAgICAgICAgICAgICArK2trO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZGQgPSAoMSArIDIgKiBkZCkgLyAoMiAqIGRkX24pO1xuICAgICAgICAgICAgYXZnX21hc2sgPSB0YWJbZGRdICogMC41O1xuICAgICAgICAgICAgZWNiICo9IGF2Z19tYXNrO1xuXG4gICAgICAgICAgICAvKioqKiBsb25nIGJsb2NrIHByZS1lY2hvIGNvbnRyb2wgKioqKi9cbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogPFBSRT5cbiAgICAgICAgICAgICAqIGRvbnQgdXNlIGxvbmcgYmxvY2sgcHJlLWVjaG8gY29udHJvbCBpZiBwcmV2aW91cyBncmFudWxlIHdhc1xuICAgICAgICAgICAgICogYSBzaG9ydCBibG9jay4gIFRoaXMgaXMgdG8gYXZvaWQgdGhlIHNpdHVhdGlvbjpcbiAgICAgICAgICAgICAqIGZyYW1lMDogIHF1aWV0ICh2ZXJ5IGxvdyBtYXNraW5nKVxuICAgICAgICAgICAgICogZnJhbWUxOiAgc3VyZ2UgICh0cmlnZ2VycyBzaG9ydCBibG9ja3MpXG4gICAgICAgICAgICAgKiBmcmFtZTI6ICByZWd1bGFyIGZyYW1lLiAgbG9va3MgbGlrZSBwcmUtZWNobyB3aGVuIGNvbXBhcmVkIHRvXG4gICAgICAgICAgICAgKiAgICAgICAgICBmcmFtZTAsIGJ1dCBhbGwgcHJlLWVjaG8gd2FzIGluIGZyYW1lMS5cbiAgICAgICAgICAgICAqIDwvUFJFPlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogY2huPTAsMSBMIGFuZCBSIGNoYW5uZWxzIGNobj0yLDMgUyBhbmQgTSBjaGFubmVscy5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKGdmYy5ibG9ja3R5cGVfb2xkW2NobiAmIDB4MDFdID09IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgICAgIHZhciBlY2JfbGltaXQgPSBycGVsZXYgKiBnZmMubmJfMVtjaG5dW2JdO1xuICAgICAgICAgICAgICAgIGlmIChlY2JfbGltaXQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRocltiXSA9IE1hdGgubWluKGVjYiwgZWNiX2xpbWl0KTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgICAgICogPFBSRT5cbiAgICAgICAgICAgICAgICAgICAgICogUm9iZXJ0IDA3MTIwOTpcbiAgICAgICAgICAgICAgICAgICAgICogQmVjYXVzZSB3ZSBkb24ndCBjYWxjdWxhdGUgbG9uZyBibG9jayBwc3kgd2hlbiB3ZSBrbm93IGEgZ3JhbnVsZVxuICAgICAgICAgICAgICAgICAgICAgKiBzaG91bGQgYmUgb2Ygc2hvcnQgYmxvY2tzLCB3ZSBkb24ndCBoYXZlIGFueSBjbHVlIGhvdyB0aGUgZ3JhbnVsZVxuICAgICAgICAgICAgICAgICAgICAgKiBiZWZvcmUgd291bGQgaGF2ZSBsb29rZWQgbGlrZSBhcyBhIGxvbmcgYmxvY2suIFNvIHdlIGhhdmUgdG8gZ3Vlc3NcbiAgICAgICAgICAgICAgICAgICAgICogYSBsaXR0bGUgYml0IGZvciB0aGlzIEVORF9UWVBFIGJsb2NrLlxuICAgICAgICAgICAgICAgICAgICAgKiBNb3N0IG9mIHRoZSB0aW1lIHdlIGdldCBhd2F5IHdpdGggdGhpcyBzbG9wcHluZXNzLiAoZmluZ2VycyBjcm9zc2VkIDopXG4gICAgICAgICAgICAgICAgICAgICAqIFRoZSBzcGVlZCBpbmNyZWFzZSBpcyB3b3J0aCBpdC5cbiAgICAgICAgICAgICAgICAgICAgICogPC9QUkU+XG4gICAgICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgICAgICB0aHJbYl0gPSBNYXRoLm1pbihlY2IsIGViX2xbYl0gKiBOU19QUkVFQ0hPX0FUVDIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGVjYl9saW1pdF8yID0gcnBlbGV2MiAqIGdmYy5uYl8yW2Nobl1bYl07XG4gICAgICAgICAgICAgICAgdmFyIGVjYl9saW1pdF8xID0gcnBlbGV2ICogZ2ZjLm5iXzFbY2huXVtiXTtcbiAgICAgICAgICAgICAgICB2YXIgZWNiX2xpbWl0O1xuICAgICAgICAgICAgICAgIGlmIChlY2JfbGltaXRfMiA8PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGVjYl9saW1pdF8yID0gZWNiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZWNiX2xpbWl0XzEgPD0gMCkge1xuICAgICAgICAgICAgICAgICAgICBlY2JfbGltaXRfMSA9IGVjYjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5ibG9ja3R5cGVfb2xkW2NobiAmIDB4MDFdID09IEVuY29kZXIuTk9STV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgIGVjYl9saW1pdCA9IE1hdGgubWluKGVjYl9saW1pdF8xLCBlY2JfbGltaXRfMik7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZWNiX2xpbWl0ID0gZWNiX2xpbWl0XzE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRocltiXSA9IE1hdGgubWluKGVjYiwgZWNiX2xpbWl0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy5uYl8yW2Nobl1bYl0gPSBnZmMubmJfMVtjaG5dW2JdO1xuICAgICAgICAgICAgZ2ZjLm5iXzFbY2huXVtiXSA9IGVjYjtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIGlmIFRIUiBleGNlZWRzIEVCLCB0aGUgcXVhbnRpemF0aW9uIHJvdXRpbmVzIHdpbGwgdGFrZSB0aGVcbiAgICAgICAgICAgICAgICAgKiBkaWZmZXJlbmNlIGZyb20gb3RoZXIgYmFuZHMuIGluIGNhc2Ugb2Ygc3Ryb25nIHRvbmFsIHNhbXBsZXNcbiAgICAgICAgICAgICAgICAgKiAodG9uYWx0ZXN0LndhdikgdGhpcyBsZWFkcyB0byBoZWF2eSBkaXN0b3J0aW9ucy4gdGhhdCdzIHdoeVxuICAgICAgICAgICAgICAgICAqIHdlIGxpbWl0IFRIUiBoZXJlLlxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIHggPSBtYXhbYl07XG4gICAgICAgICAgICAgICAgeCAqPSBnZmMubWludmFsX2xbYl07XG4gICAgICAgICAgICAgICAgeCAqPSBhdmdfbWFzaztcbiAgICAgICAgICAgICAgICBpZiAodGhyW2JdID4geCkge1xuICAgICAgICAgICAgICAgICAgICB0aHJbYl0gPSB4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChnZmMubWFza2luZ19sb3dlciA+IDEpIHtcbiAgICAgICAgICAgICAgICB0aHJbYl0gKj0gZ2ZjLm1hc2tpbmdfbG93ZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhyW2JdID4gZWJfbFtiXSkge1xuICAgICAgICAgICAgICAgIHRocltiXSA9IGViX2xbYl07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ2ZjLm1hc2tpbmdfbG93ZXIgPCAxKSB7XG4gICAgICAgICAgICAgICAgdGhyW2JdICo9IGdmYy5tYXNraW5nX2xvd2VyO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoOyBiIDwgRW5jb2Rlci5DQkFORFM7ICsrYikge1xuICAgICAgICAgICAgZWJfbFtiXSA9IDA7XG4gICAgICAgICAgICB0aHJbYl0gPSAwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdmJycHN5X2NvbXB1dGVfYmxvY2tfdHlwZShnZnAsIHVzZWxvbmdibG9jaykge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuXG4gICAgICAgIGlmIChnZnAuc2hvcnRfYmxvY2tzID09IFNob3J0QmxvY2suc2hvcnRfYmxvY2tfY291cGxlZFxuICAgICAgICAgICAgICAgIC8qIGZvcmNlIGJvdGggY2hhbm5lbHMgdG8gdXNlIHRoZSBzYW1lIGJsb2NrIHR5cGUgKi9cbiAgICAgICAgICAgICAgICAvKiB0aGlzIGlzIG5lY2Vzc2FyeSBpZiB0aGUgZnJhbWUgaXMgdG8gYmUgZW5jb2RlZCBpbiBtc19zdGVyZW8uICovXG4gICAgICAgICAgICAgICAgLyogQnV0IGV2ZW4gd2l0aG91dCBtc19zdGVyZW8sIEZoRyBkb2VzIHRoaXMgKi9cbiAgICAgICAgICAgICYmICEodXNlbG9uZ2Jsb2NrWzBdICE9IDAgJiYgdXNlbG9uZ2Jsb2NrWzFdICE9IDApKVxuICAgICAgICAgICAgdXNlbG9uZ2Jsb2NrWzBdID0gdXNlbG9uZ2Jsb2NrWzFdID0gMDtcblxuICAgICAgICBmb3IgKHZhciBjaG4gPSAwOyBjaG4gPCBnZmMuY2hhbm5lbHNfb3V0OyBjaG4rKykge1xuICAgICAgICAgICAgLyogZGlzYWJsZSBzaG9ydCBibG9ja3MgKi9cbiAgICAgICAgICAgIGlmIChnZnAuc2hvcnRfYmxvY2tzID09IFNob3J0QmxvY2suc2hvcnRfYmxvY2tfZGlzcGVuc2VkKSB7XG4gICAgICAgICAgICAgICAgdXNlbG9uZ2Jsb2NrW2Nobl0gPSAxO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGdmcC5zaG9ydF9ibG9ja3MgPT0gU2hvcnRCbG9jay5zaG9ydF9ibG9ja19mb3JjZWQpIHtcbiAgICAgICAgICAgICAgICB1c2Vsb25nYmxvY2tbY2huXSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiB2YnJwc3lfYXBwbHlfYmxvY2tfdHlwZShnZnAsIHVzZWxvbmdibG9jaywgYmxvY2t0eXBlX2QpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblxuICAgICAgICAvKlxuICAgICAgICAgKiB1cGRhdGUgdGhlIGJsb2NrdHlwZSBvZiB0aGUgcHJldmlvdXMgZ3JhbnVsZSwgc2luY2UgaXQgZGVwZW5kcyBvblxuICAgICAgICAgKiB3aGF0IGhhcHBlbmQgaW4gdGhpcyBncmFudWxlXG4gICAgICAgICAqL1xuICAgICAgICBmb3IgKHZhciBjaG4gPSAwOyBjaG4gPCBnZmMuY2hhbm5lbHNfb3V0OyBjaG4rKykge1xuICAgICAgICAgICAgdmFyIGJsb2NrdHlwZSA9IEVuY29kZXIuTk9STV9UWVBFO1xuICAgICAgICAgICAgLyogZGlzYWJsZSBzaG9ydCBibG9ja3MgKi9cblxuICAgICAgICAgICAgaWYgKHVzZWxvbmdibG9ja1tjaG5dICE9IDApIHtcbiAgICAgICAgICAgICAgICAvKiBubyBhdHRhY2sgOiB1c2UgbG9uZyBibG9ja3MgKi9cbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLmJsb2NrdHlwZV9vbGRbY2huXSA9PSBFbmNvZGVyLlNIT1JUX1RZUEUpXG4gICAgICAgICAgICAgICAgICAgIGJsb2NrdHlwZSA9IEVuY29kZXIuU1RPUF9UWVBFO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvKiBhdHRhY2sgOiB1c2Ugc2hvcnQgYmxvY2tzICovXG4gICAgICAgICAgICAgICAgYmxvY2t0eXBlID0gRW5jb2Rlci5TSE9SVF9UWVBFO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuYmxvY2t0eXBlX29sZFtjaG5dID09IEVuY29kZXIuTk9STV9UWVBFKSB7XG4gICAgICAgICAgICAgICAgICAgIGdmYy5ibG9ja3R5cGVfb2xkW2Nobl0gPSBFbmNvZGVyLlNUQVJUX1RZUEU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChnZmMuYmxvY2t0eXBlX29sZFtjaG5dID09IEVuY29kZXIuU1RPUF9UWVBFKVxuICAgICAgICAgICAgICAgICAgICBnZmMuYmxvY2t0eXBlX29sZFtjaG5dID0gRW5jb2Rlci5TSE9SVF9UWVBFO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBibG9ja3R5cGVfZFtjaG5dID0gZ2ZjLmJsb2NrdHlwZV9vbGRbY2huXTtcbiAgICAgICAgICAgIC8vIHZhbHVlIHJldHVybmVkIHRvIGNhbGxpbmcgcHJvZ3JhbVxuICAgICAgICAgICAgZ2ZjLmJsb2NrdHlwZV9vbGRbY2huXSA9IGJsb2NrdHlwZTtcbiAgICAgICAgICAgIC8vIHNhdmUgZm9yIG5leHQgY2FsbCB0byBsM3BzeV9hbmFsXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBjb21wdXRlIE0vUyB0aHJlc2hvbGRzIGZyb20gSm9obnN0b24gJiBGZXJyZWlyYSAxOTkyIElDQVNTUCBwYXBlclxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHZicnBzeV9jb21wdXRlX01TX3RocmVzaG9sZHMoZWIsIHRociwgY2JfbWxkLCBhdGhfY2IsIGF0aGFkanVzdCwgbXNmaXgsIG4pIHtcbiAgICAgICAgdmFyIG1zZml4MiA9IG1zZml4ICogMjtcbiAgICAgICAgdmFyIGF0aGxvd2VyID0gbXNmaXggPiAwID8gTWF0aC5wb3coMTAsIGF0aGFkanVzdCkgOiAxO1xuICAgICAgICB2YXIgcnNpZGUsIHJtaWQ7XG4gICAgICAgIGZvciAodmFyIGIgPSAwOyBiIDwgbjsgKytiKSB7XG4gICAgICAgICAgICB2YXIgZWJNID0gZWJbMl1bYl07XG4gICAgICAgICAgICB2YXIgZWJTID0gZWJbM11bYl07XG4gICAgICAgICAgICB2YXIgdGhtTCA9IHRoclswXVtiXTtcbiAgICAgICAgICAgIHZhciB0aG1SID0gdGhyWzFdW2JdO1xuICAgICAgICAgICAgdmFyIHRobU0gPSB0aHJbMl1bYl07XG4gICAgICAgICAgICB2YXIgdGhtUyA9IHRoclszXVtiXTtcblxuICAgICAgICAgICAgLyogdXNlIHRoaXMgZml4IGlmIEwgJiBSIG1hc2tpbmcgZGlmZmVycyBieSAyZGIgb3IgbGVzcyAqL1xuICAgICAgICAgICAgaWYgKHRobUwgPD0gMS41OCAqIHRobVIgJiYgdGhtUiA8PSAxLjU4ICogdGhtTCkge1xuICAgICAgICAgICAgICAgIHZhciBtbGRfbSA9IGNiX21sZFtiXSAqIGViUztcbiAgICAgICAgICAgICAgICB2YXIgbWxkX3MgPSBjYl9tbGRbYl0gKiBlYk07XG4gICAgICAgICAgICAgICAgcm1pZCA9IE1hdGgubWF4KHRobU0sIE1hdGgubWluKHRobVMsIG1sZF9tKSk7XG4gICAgICAgICAgICAgICAgcnNpZGUgPSBNYXRoLm1heCh0aG1TLCBNYXRoLm1pbih0aG1NLCBtbGRfcykpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBybWlkID0gdGhtTTtcbiAgICAgICAgICAgICAgICByc2lkZSA9IHRobVM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobXNmaXggPiAwKSB7XG4gICAgICAgICAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgICAgICAgICAvKiBBZGp1c3QgTS9TIG1hc2tpbmdzIGlmIHVzZXIgc2V0IFwibXNmaXhcIiAqL1xuICAgICAgICAgICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgICAgICAgICAgLyogTmFva2kgU2hpYmF0YSAyMDAwICovXG4gICAgICAgICAgICAgICAgdmFyIHRobUxSLCB0aG1NUztcbiAgICAgICAgICAgICAgICB2YXIgYXRoID0gYXRoX2NiW2JdICogYXRobG93ZXI7XG4gICAgICAgICAgICAgICAgdGhtTFIgPSBNYXRoLm1pbihNYXRoLm1heCh0aG1MLCBhdGgpLCBNYXRoLm1heCh0aG1SLCBhdGgpKTtcbiAgICAgICAgICAgICAgICB0aG1NID0gTWF0aC5tYXgocm1pZCwgYXRoKTtcbiAgICAgICAgICAgICAgICB0aG1TID0gTWF0aC5tYXgocnNpZGUsIGF0aCk7XG4gICAgICAgICAgICAgICAgdGhtTVMgPSB0aG1NICsgdGhtUztcbiAgICAgICAgICAgICAgICBpZiAodGhtTVMgPiAwICYmICh0aG1MUiAqIG1zZml4MikgPCB0aG1NUykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZiA9IHRobUxSICogbXNmaXgyIC8gdGhtTVM7XG4gICAgICAgICAgICAgICAgICAgIHRobU0gKj0gZjtcbiAgICAgICAgICAgICAgICAgICAgdGhtUyAqPSBmO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBybWlkID0gTWF0aC5taW4odGhtTSwgcm1pZCk7XG4gICAgICAgICAgICAgICAgcnNpZGUgPSBNYXRoLm1pbih0aG1TLCByc2lkZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocm1pZCA+IGViTSkge1xuICAgICAgICAgICAgICAgIHJtaWQgPSBlYk07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocnNpZGUgPiBlYlMpIHtcbiAgICAgICAgICAgICAgICByc2lkZSA9IGViUztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoclsyXVtiXSA9IHJtaWQ7XG4gICAgICAgICAgICB0aHJbM11bYl0gPSByc2lkZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuTDNwc3ljaG9fYW5hbF92YnIgPSBmdW5jdGlvbiAoZ2ZwLCBidWZmZXIsIGJ1ZlBvcywgZ3Jfb3V0LCBtYXNraW5nX3JhdGlvLCBtYXNraW5nX01TX3JhdGlvLCBwZXJjZXBfZW50cm9weSwgcGVyY2VwX01TX2VudHJvcHksIGVuZXJneSwgYmxvY2t0eXBlX2QpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblxuICAgICAgICAvKiBmZnQgYW5kIGVuZXJneSBjYWxjdWxhdGlvbiAqL1xuICAgICAgICB2YXIgd3NhbXBfbDtcbiAgICAgICAgdmFyIHdzYW1wX3M7XG4gICAgICAgIHZhciBmZnRlbmVyZ3kgPSBuZXdfZmxvYXQoRW5jb2Rlci5IQkxLU0laRSk7XG4gICAgICAgIHZhciBmZnRlbmVyZ3lfcyA9IG5ld19mbG9hdF9uKFszLCBFbmNvZGVyLkhCTEtTSVpFX3NdKTtcbiAgICAgICAgdmFyIHdzYW1wX0wgPSBuZXdfZmxvYXRfbihbMiwgRW5jb2Rlci5CTEtTSVpFXSk7XG4gICAgICAgIHZhciB3c2FtcF9TID0gbmV3X2Zsb2F0X24oWzIsIDMsIEVuY29kZXIuQkxLU0laRV9zXSk7XG4gICAgICAgIHZhciBlYiA9IG5ld19mbG9hdF9uKFs0LCBFbmNvZGVyLkNCQU5EU10pLCB0aHIgPSBuZXdfZmxvYXRfbihbNCwgRW5jb2Rlci5DQkFORFNdKTtcbiAgICAgICAgdmFyIHN1Yl9zaG9ydF9mYWN0b3IgPSBuZXdfZmxvYXRfbihbNCwgM10pO1xuICAgICAgICB2YXIgcGNmYWN0ID0gMC42O1xuXG4gICAgICAgIC8qIGJsb2NrIHR5cGUgKi9cbiAgICAgICAgdmFyIG5zX2F0dGFja3MgPSBbWzAsIDAsIDAsIDBdLCBbMCwgMCwgMCwgMF0sIFswLCAwLCAwLCAwXSxcbiAgICAgICAgICAgIFswLCAwLCAwLCAwXV07XG4gICAgICAgIHZhciB1c2Vsb25nYmxvY2sgPSBuZXdfaW50KDIpO1xuXG4gICAgICAgIC8qIHVzdWFsIHZhcmlhYmxlcyBsaWtlIGxvb3AgaW5kaWNlcywgZXRjLi4gKi9cblxuICAgICAgICAvKiBjaG49MiBhbmQgMyA9IE1pZCBhbmQgU2lkZSBjaGFubmVscyAqL1xuICAgICAgICB2YXIgbl9jaG5fcHN5ID0gKGdmcC5tb2RlID09IE1QRUdNb2RlLkpPSU5UX1NURVJFTykgPyA0XG4gICAgICAgICAgICA6IGdmYy5jaGFubmVsc19vdXQ7XG5cbiAgICAgICAgdmJycHN5X2F0dGFja19kZXRlY3Rpb24oZ2ZwLCBidWZmZXIsIGJ1ZlBvcywgZ3Jfb3V0LCBtYXNraW5nX3JhdGlvLFxuICAgICAgICAgICAgbWFza2luZ19NU19yYXRpbywgZW5lcmd5LCBzdWJfc2hvcnRfZmFjdG9yLCBuc19hdHRhY2tzLFxuICAgICAgICAgICAgdXNlbG9uZ2Jsb2NrKTtcblxuICAgICAgICB2YnJwc3lfY29tcHV0ZV9ibG9ja190eXBlKGdmcCwgdXNlbG9uZ2Jsb2NrKTtcblxuICAgICAgICAvKiBMT05HIEJMT0NLIENBU0UgKi9cbiAgICAgICAge1xuICAgICAgICAgICAgZm9yICh2YXIgY2huID0gMDsgY2huIDwgbl9jaG5fcHN5OyBjaG4rKykge1xuICAgICAgICAgICAgICAgIHZhciBjaDAxID0gY2huICYgMHgwMTtcbiAgICAgICAgICAgICAgICB3c2FtcF9sID0gd3NhbXBfTDtcbiAgICAgICAgICAgICAgICB2YnJwc3lfY29tcHV0ZV9mZnRfbChnZnAsIGJ1ZmZlciwgYnVmUG9zLCBjaG4sIGdyX291dCxcbiAgICAgICAgICAgICAgICAgICAgZmZ0ZW5lcmd5LCB3c2FtcF9sLCBjaDAxKTtcblxuICAgICAgICAgICAgICAgIHZicnBzeV9jb21wdXRlX2xvdWRuZXNzX2FwcHJveGltYXRpb25fbChnZnAsIGdyX291dCwgY2huLFxuICAgICAgICAgICAgICAgICAgICBmZnRlbmVyZ3kpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHVzZWxvbmdibG9ja1tjaDAxXSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHZicnBzeV9jb21wdXRlX21hc2tpbmdfbChnZmMsIGZmdGVuZXJneSwgZWJbY2huXSwgdGhyW2Nobl0sXG4gICAgICAgICAgICAgICAgICAgICAgICBjaG4pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZicnBzeV9za2lwX21hc2tpbmdfbChnZmMsIGNobik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCh1c2Vsb25nYmxvY2tbMF0gKyB1c2Vsb25nYmxvY2tbMV0pID09IDIpIHtcbiAgICAgICAgICAgICAgICAvKiBNL1MgY2hhbm5lbCAqL1xuICAgICAgICAgICAgICAgIGlmIChnZnAubW9kZSA9PSBNUEVHTW9kZS5KT0lOVF9TVEVSRU8pIHtcbiAgICAgICAgICAgICAgICAgICAgdmJycHN5X2NvbXB1dGVfTVNfdGhyZXNob2xkcyhlYiwgdGhyLCBnZmMubWxkX2NiX2wsXG4gICAgICAgICAgICAgICAgICAgICAgICBnZmMuQVRILmNiX2wsIGdmcC5BVEhsb3dlciAqIGdmYy5BVEguYWRqdXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2ZwLm1zZml4LCBnZmMubnBhcnRfbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyogVE9ETzogYXBwbHkgYWRhcHRpdmUgQVRIIG1hc2tpbmcgaGVyZSA/PyAqL1xuICAgICAgICAgICAgZm9yICh2YXIgY2huID0gMDsgY2huIDwgbl9jaG5fcHN5OyBjaG4rKykge1xuICAgICAgICAgICAgICAgIHZhciBjaDAxID0gY2huICYgMHgwMTtcbiAgICAgICAgICAgICAgICBpZiAodXNlbG9uZ2Jsb2NrW2NoMDFdICE9IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29udmVydF9wYXJ0aXRpb24yc2NhbGVmYWNfbChnZmMsIGViW2Nobl0sIHRocltjaG5dLCBjaG4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIFNIT1JUIEJMT0NLUyBDQVNFICovXG4gICAgICAgIHtcbiAgICAgICAgICAgIGZvciAodmFyIHNibG9jayA9IDA7IHNibG9jayA8IDM7IHNibG9jaysrKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgY2huID0gMDsgY2huIDwgbl9jaG5fcHN5OyArK2Nobikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2gwMSA9IGNobiAmIDB4MDE7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZWxvbmdibG9ja1tjaDAxXSAhPSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YnJwc3lfc2tpcF9tYXNraW5nX3MoZ2ZjLCBjaG4sIHNibG9jayk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvKiBjb21wdXRlIG1hc2tpbmcgdGhyZXNob2xkcyBmb3Igc2hvcnQgYmxvY2tzICovXG4gICAgICAgICAgICAgICAgICAgICAgICB3c2FtcF9zID0gd3NhbXBfUztcbiAgICAgICAgICAgICAgICAgICAgICAgIHZicnBzeV9jb21wdXRlX2ZmdF9zKGdmcCwgYnVmZmVyLCBidWZQb3MsIGNobiwgc2Jsb2NrLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZmdGVuZXJneV9zLCB3c2FtcF9zLCBjaDAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZicnBzeV9jb21wdXRlX21hc2tpbmdfcyhnZnAsIGZmdGVuZXJneV9zLCBlYltjaG5dLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocltjaG5dLCBjaG4sIHNibG9jayk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCh1c2Vsb25nYmxvY2tbMF0gKyB1c2Vsb25nYmxvY2tbMV0pID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLyogTS9TIGNoYW5uZWwgKi9cbiAgICAgICAgICAgICAgICAgICAgaWYgKGdmcC5tb2RlID09IE1QRUdNb2RlLkpPSU5UX1NURVJFTykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmJycHN5X2NvbXB1dGVfTVNfdGhyZXNob2xkcyhlYiwgdGhyLCBnZmMubWxkX2NiX3MsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2ZjLkFUSC5jYl9zLCBnZnAuQVRIbG93ZXIgKiBnZmMuQVRILmFkanVzdCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZnAubXNmaXgsIGdmYy5ucGFydF9zKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKiBML1IgY2hhbm5lbCAqL1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvKiBUT0RPOiBhcHBseSBhZGFwdGl2ZSBBVEggbWFza2luZyBoZXJlID8/ICovXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgY2huID0gMDsgY2huIDwgbl9jaG5fcHN5OyArK2Nobikge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2gwMSA9IGNobiAmIDB4MDE7XG4gICAgICAgICAgICAgICAgICAgIGlmICgwID09IHVzZWxvbmdibG9ja1tjaDAxXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udmVydF9wYXJ0aXRpb24yc2NhbGVmYWNfcyhnZmMsIGViW2Nobl0sIHRocltjaG5dLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNobiwgc2Jsb2NrKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLyoqKiogc2hvcnQgYmxvY2sgcHJlLWVjaG8gY29udHJvbCAqKioqL1xuICAgICAgICAgICAgZm9yICh2YXIgY2huID0gMDsgY2huIDwgbl9jaG5fcHN5OyBjaG4rKykge1xuICAgICAgICAgICAgICAgIHZhciBjaDAxID0gY2huICYgMHgwMTtcblxuICAgICAgICAgICAgICAgIGlmICh1c2Vsb25nYmxvY2tbY2gwMV0gIT0gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgc2IgPSAwOyBzYiA8IEVuY29kZXIuU0JNQVhfczsgc2IrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3X3RobW0gPSBuZXdfZmxvYXQoMyk7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHNibG9jayA9IDA7IHNibG9jayA8IDM7IHNibG9jaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGhtbSA9IGdmYy50aG1bY2huXS5zW3NiXVtzYmxvY2tdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhtbSAqPSBOU19QUkVFQ0hPX0FUVDA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuc19hdHRhY2tzW2Nobl1bc2Jsb2NrXSA+PSAyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgbnNfYXR0YWNrc1tjaG5dW3NibG9jayArIDFdID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWR4ID0gKHNibG9jayAhPSAwKSA/IHNibG9jayAtIDEgOiAyO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwID0gTlNfSU5URVJQKGdmYy50aG1bY2huXS5zW3NiXVtpZHhdLCB0aG1tLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOU19QUkVFQ0hPX0FUVDEgKiBwY2ZhY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRobW0gPSBNYXRoLm1pbih0aG1tLCBwKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobnNfYXR0YWNrc1tjaG5dW3NibG9ja10gPT0gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZHggPSAoc2Jsb2NrICE9IDApID8gc2Jsb2NrIC0gMSA6IDI7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHAgPSBOU19JTlRFUlAoZ2ZjLnRobVtjaG5dLnNbc2JdW2lkeF0sIHRobW0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE5TX1BSRUVDSE9fQVRUMiAqIHBjZmFjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhtbSA9IE1hdGgubWluKHRobW0sIHApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICgoc2Jsb2NrICE9IDAgJiYgbnNfYXR0YWNrc1tjaG5dW3NibG9jayAtIDFdID09IDMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgKHNibG9jayA9PSAwICYmIGdmYy5uc1BzeS5sYXN0QXR0YWNrc1tjaG5dID09IDMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlkeCA9IChzYmxvY2sgIT0gMikgPyBzYmxvY2sgKyAxIDogMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcCA9IE5TX0lOVEVSUChnZmMudGhtW2Nobl0uc1tzYl1baWR4XSwgdGhtbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTlNfUFJFRUNIT19BVFQyICogcGNmYWN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aG1tID0gTWF0aC5taW4odGhtbSwgcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8qIHB1bHNlIGxpa2Ugc2lnbmFsIGRldGVjdGlvbiBmb3IgZmF0Ym95LndhdiBhbmQgc28gb24gKi9cbiAgICAgICAgICAgICAgICAgICAgICAgIHRobW0gKj0gc3ViX3Nob3J0X2ZhY3RvcltjaG5dW3NibG9ja107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld190aG1tW3NibG9ja10gPSB0aG1tO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIHNibG9jayA9IDA7IHNibG9jayA8IDM7IHNibG9jaysrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBnZmMudGhtW2Nobl0uc1tzYl1bc2Jsb2NrXSA9IG5ld190aG1tW3NibG9ja107XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgY2huID0gMDsgY2huIDwgbl9jaG5fcHN5OyBjaG4rKykge1xuICAgICAgICAgICAgZ2ZjLm5zUHN5Lmxhc3RBdHRhY2tzW2Nobl0gPSBuc19hdHRhY2tzW2Nobl1bMl07XG4gICAgICAgIH1cblxuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIGRldGVybWluZSBmaW5hbCBibG9jayB0eXBlXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIHZicnBzeV9hcHBseV9ibG9ja190eXBlKGdmcCwgdXNlbG9uZ2Jsb2NrLCBibG9ja3R5cGVfZCk7XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBjb21wdXRlIHRoZSB2YWx1ZSBvZiBQRSB0byByZXR1cm4gLi4uIG5vIGRlbGF5IGFuZCBhZHZhbmNlXG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIGZvciAodmFyIGNobiA9IDA7IGNobiA8IG5fY2huX3BzeTsgY2huKyspIHtcbiAgICAgICAgICAgIHZhciBwcGU7XG4gICAgICAgICAgICB2YXIgcHBlUG9zO1xuICAgICAgICAgICAgdmFyIHR5cGU7XG4gICAgICAgICAgICB2YXIgbXI7XG5cbiAgICAgICAgICAgIGlmIChjaG4gPiAxKSB7XG4gICAgICAgICAgICAgICAgcHBlID0gcGVyY2VwX01TX2VudHJvcHk7XG4gICAgICAgICAgICAgICAgcHBlUG9zID0gLTI7XG4gICAgICAgICAgICAgICAgdHlwZSA9IEVuY29kZXIuTk9STV9UWVBFO1xuICAgICAgICAgICAgICAgIGlmIChibG9ja3R5cGVfZFswXSA9PSBFbmNvZGVyLlNIT1JUX1RZUEVcbiAgICAgICAgICAgICAgICAgICAgfHwgYmxvY2t0eXBlX2RbMV0gPT0gRW5jb2Rlci5TSE9SVF9UWVBFKVxuICAgICAgICAgICAgICAgICAgICB0eXBlID0gRW5jb2Rlci5TSE9SVF9UWVBFO1xuICAgICAgICAgICAgICAgIG1yID0gbWFza2luZ19NU19yYXRpb1tncl9vdXRdW2NobiAtIDJdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBwcGUgPSBwZXJjZXBfZW50cm9weTtcbiAgICAgICAgICAgICAgICBwcGVQb3MgPSAwO1xuICAgICAgICAgICAgICAgIHR5cGUgPSBibG9ja3R5cGVfZFtjaG5dO1xuICAgICAgICAgICAgICAgIG1yID0gbWFza2luZ19yYXRpb1tncl9vdXRdW2Nobl07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0eXBlID09IEVuY29kZXIuU0hPUlRfVFlQRSkge1xuICAgICAgICAgICAgICAgIHBwZVtwcGVQb3MgKyBjaG5dID0gcGVjYWxjX3MobXIsIGdmYy5tYXNraW5nX2xvd2VyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcHBlW3BwZVBvcyArIGNobl0gPSBwZWNhbGNfbChtciwgZ2ZjLm1hc2tpbmdfbG93ZXIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoZ2ZwLmFuYWx5c2lzKSB7XG4gICAgICAgICAgICAgICAgZ2ZjLnBpbmZvLnBlW2dyX291dF1bY2huXSA9IHBwZVtwcGVQb3MgKyBjaG5dO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHMzX2Z1bmNfeChiYXJrLCBoZl9zbG9wZSkge1xuICAgICAgICB2YXIgdGVtcHggPSBiYXJrLCB0ZW1weTtcblxuICAgICAgICBpZiAodGVtcHggPj0gMCkge1xuICAgICAgICAgICAgdGVtcHkgPSAtdGVtcHggKiAyNztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRlbXB5ID0gdGVtcHggKiBoZl9zbG9wZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGVtcHkgPD0gLTcyLjApIHtcbiAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBNYXRoLmV4cCh0ZW1weSAqIExOX1RPX0xPRzEwKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBub3JtX3MzX2Z1bmNfeChoZl9zbG9wZSkge1xuICAgICAgICB2YXIgbGltX2EgPSAwLCBsaW1fYiA9IDA7XG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciB4ID0gMCwgbCwgaDtcbiAgICAgICAgICAgIGZvciAoeCA9IDA7IHMzX2Z1bmNfeCh4LCBoZl9zbG9wZSkgPiAxZS0yMDsgeCAtPSAxKVxuICAgICAgICAgICAgICAgIDtcbiAgICAgICAgICAgIGwgPSB4O1xuICAgICAgICAgICAgaCA9IDA7XG4gICAgICAgICAgICB3aGlsZSAoTWF0aC5hYnMoaCAtIGwpID4gMWUtMTIpIHtcbiAgICAgICAgICAgICAgICB4ID0gKGggKyBsKSAvIDI7XG4gICAgICAgICAgICAgICAgaWYgKHMzX2Z1bmNfeCh4LCBoZl9zbG9wZSkgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIGggPSB4O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGwgPSB4O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxpbV9hID0gbDtcbiAgICAgICAgfVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgeCA9IDAsIGwsIGg7XG4gICAgICAgICAgICBmb3IgKHggPSAwOyBzM19mdW5jX3goeCwgaGZfc2xvcGUpID4gMWUtMjA7IHggKz0gMSlcbiAgICAgICAgICAgICAgICA7XG4gICAgICAgICAgICBsID0gMDtcbiAgICAgICAgICAgIGggPSB4O1xuICAgICAgICAgICAgd2hpbGUgKE1hdGguYWJzKGggLSBsKSA+IDFlLTEyKSB7XG4gICAgICAgICAgICAgICAgeCA9IChoICsgbCkgLyAyO1xuICAgICAgICAgICAgICAgIGlmIChzM19mdW5jX3goeCwgaGZfc2xvcGUpID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBsID0geDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBoID0geDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsaW1fYiA9IGg7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIHN1bSA9IDA7XG4gICAgICAgICAgICB2YXIgbSA9IDEwMDA7XG4gICAgICAgICAgICB2YXIgaTtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPD0gbTsgKytpKSB7XG4gICAgICAgICAgICAgICAgdmFyIHggPSBsaW1fYSArIGkgKiAobGltX2IgLSBsaW1fYSkgLyBtO1xuICAgICAgICAgICAgICAgIHZhciB5ID0gczNfZnVuY194KHgsIGhmX3Nsb3BlKTtcbiAgICAgICAgICAgICAgICBzdW0gKz0geTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICB2YXIgbm9ybSA9IChtICsgMSkgLyAoc3VtICogKGxpbV9iIC0gbGltX2EpKTtcbiAgICAgICAgICAgICAgICAvKiBwcmludGYoIFwibm9ybSA9ICVsZlxcblwiLG5vcm0pOyAqL1xuICAgICAgICAgICAgICAgIHJldHVybiBub3JtO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogICBUaGUgc3ByZWFkaW5nIGZ1bmN0aW9uLiAgVmFsdWVzIHJldHVybmVkIGluIHVuaXRzIG9mIGVuZXJneVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHMzX2Z1bmMoYmFyaykge1xuICAgICAgICB2YXIgdGVtcHgsIHgsIHRlbXB5LCB0ZW1wO1xuICAgICAgICB0ZW1weCA9IGJhcms7XG4gICAgICAgIGlmICh0ZW1weCA+PSAwKVxuICAgICAgICAgICAgdGVtcHggKj0gMztcbiAgICAgICAgZWxzZVxuICAgICAgICAgICAgdGVtcHggKj0gMS41O1xuXG4gICAgICAgIGlmICh0ZW1weCA+PSAwLjUgJiYgdGVtcHggPD0gMi41KSB7XG4gICAgICAgICAgICB0ZW1wID0gdGVtcHggLSAwLjU7XG4gICAgICAgICAgICB4ID0gOC4wICogKHRlbXAgKiB0ZW1wIC0gMi4wICogdGVtcCk7XG4gICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgeCA9IDAuMDtcbiAgICAgICAgdGVtcHggKz0gMC40NzQ7XG4gICAgICAgIHRlbXB5ID0gMTUuODExMzg5ICsgNy41ICogdGVtcHggLSAxNy41XG4gICAgICAgICAgICAqIE1hdGguc3FydCgxLjAgKyB0ZW1weCAqIHRlbXB4KTtcblxuICAgICAgICBpZiAodGVtcHkgPD0gLTYwLjApXG4gICAgICAgICAgICByZXR1cm4gMC4wO1xuXG4gICAgICAgIHRlbXB4ID0gTWF0aC5leHAoKHggKyB0ZW1weSkgKiBMTl9UT19MT0cxMCk7XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIDxQUkU+XG4gICAgICAgICAqIE5vcm1hbGl6YXRpb24uICBUaGUgc3ByZWFkaW5nIGZ1bmN0aW9uIHNob3VsZCBiZSBub3JtYWxpemVkIHNvIHRoYXQ6XG4gICAgICAgICAqICtpbmZcbiAgICAgICAgICogL1xuICAgICAgICAgKiB8ICBzMyBbIGJhcmsgXSAgZChiYXJrKSAgID0gIDFcbiAgICAgICAgICogL1xuICAgICAgICAgKiAtaW5mXG4gICAgICAgICAqIDwvUFJFPlxuICAgICAgICAgKi9cbiAgICAgICAgdGVtcHggLz0gLjY2MDkxOTM7XG4gICAgICAgIHJldHVybiB0ZW1weDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBzZWUgZm9yIGV4YW1wbGUgXCJad2lja2VyOiBQc3ljaG9ha3VzdGlrLCAxOTgyOyBJU0JOIDMtNTQwLTExNDAxLTdcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBmcmVxMmJhcmsoZnJlcSkge1xuICAgICAgICAvKiBpbnB1dDogZnJlcSBpbiBoeiBvdXRwdXQ6IGJhcmtzICovXG4gICAgICAgIGlmIChmcmVxIDwgMClcbiAgICAgICAgICAgIGZyZXEgPSAwO1xuICAgICAgICBmcmVxID0gZnJlcSAqIDAuMDAxO1xuICAgICAgICByZXR1cm4gMTMuMCAqIE1hdGguYXRhbiguNzYgKiBmcmVxKSArIDMuNVxuICAgICAgICAgICAgKiBNYXRoLmF0YW4oZnJlcSAqIGZyZXEgLyAoNy41ICogNy41KSk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gaW5pdF9udW1saW5lKG51bWxpbmVzLCBibywgYm0sIGJ2YWwsIGJ2YWxfd2lkdGgsIG1sZCwgYm9fdywgc2ZyZXEsIGJsa3NpemUsIHNjYWxlcG9zLCBkZWx0YWZyZXEsIHNibWF4KSB7XG4gICAgICAgIHZhciBiX2ZycSA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyArIDEpO1xuICAgICAgICB2YXIgc2FtcGxlX2ZyZXFfZnJhYyA9IHNmcmVxIC8gKHNibWF4ID4gMTUgPyAyICogNTc2IDogMiAqIDE5Mik7XG4gICAgICAgIHZhciBwYXJ0aXRpb24gPSBuZXdfaW50KEVuY29kZXIuSEJMS1NJWkUpO1xuICAgICAgICB2YXIgaTtcbiAgICAgICAgc2ZyZXEgLz0gYmxrc2l6ZTtcbiAgICAgICAgdmFyIGogPSAwO1xuICAgICAgICB2YXIgbmkgPSAwO1xuICAgICAgICAvKiBjb21wdXRlIG51bWxpbmVzLCB0aGUgbnVtYmVyIG9mIHNwZWN0cmFsIGxpbmVzIGluIGVhY2ggcGFydGl0aW9uIGJhbmQgKi9cbiAgICAgICAgLyogZWFjaCBwYXJ0aXRpb24gYmFuZCBzaG91bGQgYmUgYWJvdXQgREVMQkFSSyB3aWRlLiAqL1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgRW5jb2Rlci5DQkFORFM7IGkrKykge1xuICAgICAgICAgICAgdmFyIGJhcmsxO1xuICAgICAgICAgICAgdmFyIGoyO1xuICAgICAgICAgICAgYmFyazEgPSBmcmVxMmJhcmsoc2ZyZXEgKiBqKTtcblxuICAgICAgICAgICAgYl9mcnFbaV0gPSBzZnJlcSAqIGo7XG5cbiAgICAgICAgICAgIGZvciAoajIgPSBqOyBmcmVxMmJhcmsoc2ZyZXEgKiBqMikgLSBiYXJrMSA8IERFTEJBUktcbiAgICAgICAgICAgICYmIGoyIDw9IGJsa3NpemUgLyAyOyBqMisrKVxuICAgICAgICAgICAgICAgIDtcblxuICAgICAgICAgICAgbnVtbGluZXNbaV0gPSBqMiAtIGo7XG4gICAgICAgICAgICBuaSA9IGkgKyAxO1xuXG4gICAgICAgICAgICB3aGlsZSAoaiA8IGoyKSB7XG4gICAgICAgICAgICAgICAgcGFydGl0aW9uW2orK10gPSBpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGogPiBibGtzaXplIC8gMikge1xuICAgICAgICAgICAgICAgIGogPSBibGtzaXplIC8gMjtcbiAgICAgICAgICAgICAgICArK2k7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYl9mcnFbaV0gPSBzZnJlcSAqIGo7XG5cbiAgICAgICAgZm9yICh2YXIgc2ZiID0gMDsgc2ZiIDwgc2JtYXg7IHNmYisrKSB7XG4gICAgICAgICAgICB2YXIgaTEsIGkyLCBzdGFydCwgZW5kO1xuICAgICAgICAgICAgdmFyIGFyZztcbiAgICAgICAgICAgIHN0YXJ0ID0gc2NhbGVwb3Nbc2ZiXTtcbiAgICAgICAgICAgIGVuZCA9IHNjYWxlcG9zW3NmYiArIDFdO1xuXG4gICAgICAgICAgICBpMSA9IDAgfCBNYXRoLmZsb29yKC41ICsgZGVsdGFmcmVxICogKHN0YXJ0IC0gLjUpKTtcbiAgICAgICAgICAgIGlmIChpMSA8IDApXG4gICAgICAgICAgICAgICAgaTEgPSAwO1xuICAgICAgICAgICAgaTIgPSAwIHwgTWF0aC5mbG9vciguNSArIGRlbHRhZnJlcSAqIChlbmQgLSAuNSkpO1xuXG4gICAgICAgICAgICBpZiAoaTIgPiBibGtzaXplIC8gMilcbiAgICAgICAgICAgICAgICBpMiA9IGJsa3NpemUgLyAyO1xuXG4gICAgICAgICAgICBibVtzZmJdID0gKHBhcnRpdGlvbltpMV0gKyBwYXJ0aXRpb25baTJdKSAvIDI7XG4gICAgICAgICAgICBib1tzZmJdID0gcGFydGl0aW9uW2kyXTtcbiAgICAgICAgICAgIHZhciBmX3RtcCA9IHNhbXBsZV9mcmVxX2ZyYWMgKiBlbmQ7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogY2FsY3VsYXRlIGhvdyBtdWNoIG9mIHRoaXMgYmFuZCBiZWxvbmdzIHRvIGN1cnJlbnQgc2NhbGVmYWN0b3JcbiAgICAgICAgICAgICAqIGJhbmRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgYm9fd1tzZmJdID0gKGZfdG1wIC0gYl9mcnFbYm9bc2ZiXV0pXG4gICAgICAgICAgICAgICAgLyAoYl9mcnFbYm9bc2ZiXSArIDFdIC0gYl9mcnFbYm9bc2ZiXV0pO1xuICAgICAgICAgICAgaWYgKGJvX3dbc2ZiXSA8IDApIHtcbiAgICAgICAgICAgICAgICBib193W3NmYl0gPSAwO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAoYm9fd1tzZmJdID4gMSkge1xuICAgICAgICAgICAgICAgICAgICBib193W3NmYl0gPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qIHNldHVwIHN0ZXJlbyBkZW1hc2tpbmcgdGhyZXNob2xkcyAqL1xuICAgICAgICAgICAgLyogZm9ybXVsYSByZXZlcnNlIGVuZ2luZXJyZWQgZnJvbSBwbG90IGluIHBhcGVyICovXG4gICAgICAgICAgICBhcmcgPSBmcmVxMmJhcmsoc2ZyZXEgKiBzY2FsZXBvc1tzZmJdICogZGVsdGFmcmVxKTtcbiAgICAgICAgICAgIGFyZyA9ICggTWF0aC5taW4oYXJnLCAxNS41KSAvIDE1LjUpO1xuXG4gICAgICAgICAgICBtbGRbc2ZiXSA9IE1hdGgucG93KDEwLjAsXG4gICAgICAgICAgICAgICAgMS4yNSAqICgxIC0gTWF0aC5jb3MoTWF0aC5QSSAqIGFyZykpIC0gMi41KTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGNvbXB1dGUgYmFyayB2YWx1ZXMgb2YgZWFjaCBjcml0aWNhbCBiYW5kICovXG4gICAgICAgIGogPSAwO1xuICAgICAgICBmb3IgKHZhciBrID0gMDsgayA8IG5pOyBrKyspIHtcbiAgICAgICAgICAgIHZhciB3ID0gbnVtbGluZXNba107XG4gICAgICAgICAgICB2YXIgYmFyazEsIGJhcmsyO1xuXG4gICAgICAgICAgICBiYXJrMSA9IGZyZXEyYmFyayhzZnJlcSAqIChqKSk7XG4gICAgICAgICAgICBiYXJrMiA9IGZyZXEyYmFyayhzZnJlcSAqIChqICsgdyAtIDEpKTtcbiAgICAgICAgICAgIGJ2YWxba10gPSAuNSAqIChiYXJrMSArIGJhcmsyKTtcblxuICAgICAgICAgICAgYmFyazEgPSBmcmVxMmJhcmsoc2ZyZXEgKiAoaiAtIC41KSk7XG4gICAgICAgICAgICBiYXJrMiA9IGZyZXEyYmFyayhzZnJlcSAqIChqICsgdyAtIC41KSk7XG4gICAgICAgICAgICBidmFsX3dpZHRoW2tdID0gYmFyazIgLSBiYXJrMTtcbiAgICAgICAgICAgIGogKz0gdztcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBuaTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpbml0X3MzX3ZhbHVlcyhzM2luZCwgbnBhcnQsIGJ2YWwsIGJ2YWxfd2lkdGgsIG5vcm0sIHVzZV9vbGRfczMpIHtcbiAgICAgICAgdmFyIHMzID0gbmV3X2Zsb2F0X24oW0VuY29kZXIuQ0JBTkRTLCBFbmNvZGVyLkNCQU5EU10pO1xuICAgICAgICAvKlxuICAgICAgICAgKiBUaGUgczMgYXJyYXkgaXMgbm90IGxpbmVhciBpbiB0aGUgYmFyayBzY2FsZS5cbiAgICAgICAgICpcbiAgICAgICAgICogYnZhbFt4XSBzaG91bGQgYmUgdXNlZCB0byBnZXQgdGhlIGJhcmsgdmFsdWUuXG4gICAgICAgICAqL1xuICAgICAgICB2YXIgajtcbiAgICAgICAgdmFyIG51bWJlck9mTm9uZVplcm8gPSAwO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiA8UFJFPlxuICAgICAgICAgKiBzW2ldW2pdLCB0aGUgdmFsdWUgb2YgdGhlIHNwcmVhZGluZyBmdW5jdGlvbixcbiAgICAgICAgICogY2VudGVyZWQgYXQgYmFuZCBqIChtYXNrZXIpLCBmb3IgYmFuZCBpIChtYXNrZWUpXG4gICAgICAgICAqXG4gICAgICAgICAqIGkuZS46IHN1bSBvdmVyIGogdG8gc3ByZWFkIGludG8gc2lnbmFsIGJhcmt2YWw9aVxuICAgICAgICAgKiBOT1RFOiBpIGFuZCBqIGFyZSB1c2VkIG9wcG9zaXRlIGFzIGluIHRoZSBJU08gZG9jc1xuICAgICAgICAgKiA8L1BSRT5cbiAgICAgICAgICovXG4gICAgICAgIGlmICh1c2Vfb2xkX3MzKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5wYXJ0OyBpKyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgbnBhcnQ7IGorKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdiA9IHMzX2Z1bmMoYnZhbFtpXSAtIGJ2YWxbal0pICogYnZhbF93aWR0aFtqXTtcbiAgICAgICAgICAgICAgICAgICAgczNbaV1bal0gPSB2ICogbm9ybVtpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgbnBhcnQ7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBoZl9zbG9wZSA9IDE1ICsgTWF0aC5taW4oMjEgLyBidmFsW2pdLCAxMik7XG4gICAgICAgICAgICAgICAgdmFyIHMzX3hfbm9ybSA9IG5vcm1fczNfZnVuY194KGhmX3Nsb3BlKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5wYXJ0OyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHYgPSBzM194X25vcm1cbiAgICAgICAgICAgICAgICAgICAgICAgICogczNfZnVuY194KGJ2YWxbaV0gLSBidmFsW2pdLCBoZl9zbG9wZSlcbiAgICAgICAgICAgICAgICAgICAgICAgICogYnZhbF93aWR0aFtqXTtcbiAgICAgICAgICAgICAgICAgICAgczNbaV1bal0gPSB2ICogbm9ybVtpXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBucGFydDsgaSsrKSB7XG4gICAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgbnBhcnQ7IGorKykge1xuICAgICAgICAgICAgICAgIGlmIChzM1tpXVtqXSA+IDAuMClcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzM2luZFtpXVswXSA9IGo7XG5cbiAgICAgICAgICAgIGZvciAoaiA9IG5wYXJ0IC0gMTsgaiA+IDA7IGotLSkge1xuICAgICAgICAgICAgICAgIGlmIChzM1tpXVtqXSA+IDAuMClcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzM2luZFtpXVsxXSA9IGo7XG4gICAgICAgICAgICBudW1iZXJPZk5vbmVaZXJvICs9IChzM2luZFtpXVsxXSAtIHMzaW5kW2ldWzBdICsgMSk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgcCA9IG5ld19mbG9hdChudW1iZXJPZk5vbmVaZXJvKTtcbiAgICAgICAgdmFyIGsgPSAwO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5wYXJ0OyBpKyspXG4gICAgICAgICAgICBmb3IgKGogPSBzM2luZFtpXVswXTsgaiA8PSBzM2luZFtpXVsxXTsgaisrKVxuICAgICAgICAgICAgICAgIHBbaysrXSA9IHMzW2ldW2pdO1xuXG4gICAgICAgIHJldHVybiBwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN0ZXJlb19kZW1hc2soZikge1xuICAgICAgICAvKiBzZXR1cCBzdGVyZW8gZGVtYXNraW5nIHRocmVzaG9sZHMgKi9cbiAgICAgICAgLyogZm9ybXVsYSByZXZlcnNlIGVuZ2luZXJyZWQgZnJvbSBwbG90IGluIHBhcGVyICovXG4gICAgICAgIHZhciBhcmcgPSBmcmVxMmJhcmsoZik7XG4gICAgICAgIGFyZyA9IChNYXRoLm1pbihhcmcsIDE1LjUpIC8gMTUuNSk7XG5cbiAgICAgICAgcmV0dXJuIE1hdGgucG93KDEwLjAsXG4gICAgICAgICAgICAxLjI1ICogKDEgLSBNYXRoLmNvcyhNYXRoLlBJICogYXJnKSkgLSAyLjUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIE5PVEU6IHRoZSBiaXRyYXRlIHJlZHVjdGlvbiBmcm9tIHRoZSBpbnRlci1jaGFubmVsIG1hc2tpbmcgZWZmZWN0IGlzIGxvd1xuICAgICAqIGNvbXBhcmVkIHRvIHRoZSBjaGFuY2Ugb2YgZ2V0dGluZyBhbm55b2luZyBhcnRlZmFjdHMuIEwzcHN5Y2hvX2FuYWxfdmJyXG4gICAgICogZG9lcyBub3QgdXNlIHRoaXMgZmVhdHVyZS4gKFJvYmVydCAwNzEyMTYpXG4gICAgICovXG4gICAgdGhpcy5wc3ltb2RlbF9pbml0ID0gZnVuY3Rpb24gKGdmcCkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgaTtcbiAgICAgICAgdmFyIHVzZU9sZFMzID0gdHJ1ZTtcbiAgICAgICAgdmFyIGJ2bF9hID0gMTMsIGJ2bF9iID0gMjQ7XG4gICAgICAgIHZhciBzbnJfbF9hID0gMCwgc25yX2xfYiA9IDA7XG4gICAgICAgIHZhciBzbnJfc19hID0gLTguMjUsIHNucl9zX2IgPSAtNC41O1xuICAgICAgICB2YXIgYnZhbCA9IG5ld19mbG9hdChFbmNvZGVyLkNCQU5EUyk7XG4gICAgICAgIHZhciBidmFsX3dpZHRoID0gbmV3X2Zsb2F0KEVuY29kZXIuQ0JBTkRTKTtcbiAgICAgICAgdmFyIG5vcm0gPSBuZXdfZmxvYXQoRW5jb2Rlci5DQkFORFMpO1xuICAgICAgICB2YXIgc2ZyZXEgPSBnZnAub3V0X3NhbXBsZXJhdGU7XG5cbiAgICAgICAgc3dpdGNoIChnZnAuZXhwZXJpbWVudGFsWikge1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICB1c2VPbGRTMyA9IHRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgdXNlT2xkUzMgPSAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9tdHJoIHx8IGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfbXQpID8gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgOiB0cnVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIHVzZU9sZFMzID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgYnZsX2EgPSA4O1xuICAgICAgICAgICAgICAgIHNucl9sX2EgPSAtMS43NTtcbiAgICAgICAgICAgICAgICBzbnJfbF9iID0gLTAuMDEyNTtcbiAgICAgICAgICAgICAgICBzbnJfc19hID0gLTguMjU7XG4gICAgICAgICAgICAgICAgc25yX3NfYiA9IC0yLjI1O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGdmYy5tc19lbmVyX3JhdGlvX29sZCA9IC4yNTtcbiAgICAgICAgZ2ZjLmJsb2NrdHlwZV9vbGRbMF0gPSBnZmMuYmxvY2t0eXBlX29sZFsxXSA9IEVuY29kZXIuTk9STV9UWVBFO1xuICAgICAgICAvLyB0aGUgdmJyIGhlYWRlciBpcyBsb25nIGJsb2Nrc1xuXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCA0OyArK2kpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgRW5jb2Rlci5DQkFORFM7ICsraikge1xuICAgICAgICAgICAgICAgIGdmYy5uYl8xW2ldW2pdID0gMWUyMDtcbiAgICAgICAgICAgICAgICBnZmMubmJfMltpXVtqXSA9IDFlMjA7XG4gICAgICAgICAgICAgICAgZ2ZjLm5iX3MxW2ldW2pdID0gZ2ZjLm5iX3MyW2ldW2pdID0gMS4wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgc2IgPSAwOyBzYiA8IEVuY29kZXIuU0JNQVhfbDsgc2IrKykge1xuICAgICAgICAgICAgICAgIGdmYy5lbltpXS5sW3NiXSA9IDFlMjA7XG4gICAgICAgICAgICAgICAgZ2ZjLnRobVtpXS5sW3NiXSA9IDFlMjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IDM7ICsraikge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIHNiID0gMDsgc2IgPCBFbmNvZGVyLlNCTUFYX3M7IHNiKyspIHtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLmVuW2ldLnNbc2JdW2pdID0gMWUyMDtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnRobVtpXS5zW3NiXVtqXSA9IDFlMjA7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGdmYy5uc1BzeS5sYXN0QXR0YWNrc1tpXSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IDk7IGorKylcbiAgICAgICAgICAgICAgICBnZmMubnNQc3kubGFzdF9lbl9zdWJzaG9ydFtpXVtqXSA9IDEwLjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGluaXQuIGZvciBsb3VkbmVzcyBhcHByb3guIC1qZCAyMDAxIG1hciAyNyAqL1xuICAgICAgICBnZmMubG91ZG5lc3Nfc3Ffc2F2ZVswXSA9IGdmYy5sb3VkbmVzc19zcV9zYXZlWzFdID0gMC4wO1xuXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAgICAgICAqIG5vdyBjb21wdXRlIHRoZSBwc3ljaG9hY291c3RpYyBtb2RlbCBzcGVjaWZpYyBjb25zdGFudHNcbiAgICAgICAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgLyogY29tcHV0ZSBudW1saW5lcywgYm8sIGJtLCBidmFsLCBidmFsX3dpZHRoLCBtbGQgKi9cblxuICAgICAgICBnZmMubnBhcnRfbCA9IGluaXRfbnVtbGluZShnZmMubnVtbGluZXNfbCwgZ2ZjLmJvX2wsIGdmYy5ibV9sLCBidmFsLFxuICAgICAgICAgICAgYnZhbF93aWR0aCwgZ2ZjLm1sZF9sLCBnZmMuUFNZLmJvX2xfd2VpZ2h0LCBzZnJlcSxcbiAgICAgICAgICAgIEVuY29kZXIuQkxLU0laRSwgZ2ZjLnNjYWxlZmFjX2JhbmQubCwgRW5jb2Rlci5CTEtTSVpFXG4gICAgICAgICAgICAvICgyLjAgKiA1NzYpLCBFbmNvZGVyLlNCTUFYX2wpO1xuICAgICAgICAvKiBjb21wdXRlIHRoZSBzcHJlYWRpbmcgZnVuY3Rpb24gKi9cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGdmYy5ucGFydF9sOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBzbnIgPSBzbnJfbF9hO1xuICAgICAgICAgICAgaWYgKGJ2YWxbaV0gPj0gYnZsX2EpIHtcbiAgICAgICAgICAgICAgICBzbnIgPSBzbnJfbF9iICogKGJ2YWxbaV0gLSBidmxfYSkgLyAoYnZsX2IgLSBidmxfYSkgKyBzbnJfbF9hXG4gICAgICAgICAgICAgICAgICAgICogKGJ2bF9iIC0gYnZhbFtpXSkgLyAoYnZsX2IgLSBidmxfYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBub3JtW2ldID0gTWF0aC5wb3coMTAuMCwgc25yIC8gMTAuMCk7XG4gICAgICAgICAgICBpZiAoZ2ZjLm51bWxpbmVzX2xbaV0gPiAwKSB7XG4gICAgICAgICAgICAgICAgZ2ZjLnJudW1saW5lc19sW2ldID0gMS4wIC8gZ2ZjLm51bWxpbmVzX2xbaV07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGdmYy5ybnVtbGluZXNfbFtpXSA9IDA7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZ2ZjLnMzX2xsID0gaW5pdF9zM192YWx1ZXMoZ2ZjLnMzaW5kLCBnZmMubnBhcnRfbCwgYnZhbCwgYnZhbF93aWR0aCxcbiAgICAgICAgICAgIG5vcm0sIHVzZU9sZFMzKTtcblxuICAgICAgICAvKiBjb21wdXRlIGxvbmcgYmxvY2sgc3BlY2lmaWMgdmFsdWVzLCBBVEggYW5kIE1JTlZBTCAqL1xuICAgICAgICB2YXIgaiA9IDA7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBnZmMubnBhcnRfbDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgeDtcblxuICAgICAgICAgICAgLyogQVRIICovXG4gICAgICAgICAgICB4ID0gRmxvYXQuTUFYX1ZBTFVFO1xuICAgICAgICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCBnZmMubnVtbGluZXNfbFtpXTsgaysrLCBqKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJlcSA9IHNmcmVxICogaiAvICgxMDAwLjAgKiBFbmNvZGVyLkJMS1NJWkUpO1xuICAgICAgICAgICAgICAgIHZhciBsZXZlbDtcbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIEFUSCBiZWxvdyAxMDAgSHogY29uc3RhbnQsIG5vdCBmdXJ0aGVyIGNsaW1iaW5nXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgbGV2ZWwgPSB0aGlzLkFUSGZvcm11bGEoZnJlcSAqIDEwMDAsIGdmcCkgLSAyMDtcbiAgICAgICAgICAgICAgICAvLyBzY2FsZSB0byBGRlQgdW5pdHM7IHJldHVybmVkIHZhbHVlIGlzIGluIGRCXG4gICAgICAgICAgICAgICAgbGV2ZWwgPSBNYXRoLnBvdygxMC4sIDAuMSAqIGxldmVsKTtcbiAgICAgICAgICAgICAgICAvLyBjb252ZXJ0IGZyb20gZEIgLiBlbmVyZ3lcbiAgICAgICAgICAgICAgICBsZXZlbCAqPSBnZmMubnVtbGluZXNfbFtpXTtcbiAgICAgICAgICAgICAgICBpZiAoeCA+IGxldmVsKVxuICAgICAgICAgICAgICAgICAgICB4ID0gbGV2ZWw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMuQVRILmNiX2xbaV0gPSB4O1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogTUlOVkFMLiBGb3IgbG93IGZyZXEsIHRoZSBzdHJlbmd0aCBvZiB0aGUgbWFza2luZyBpcyBsaW1pdGVkIGJ5XG4gICAgICAgICAgICAgKiBtaW52YWwgdGhpcyBpcyBhbiBJU08gTVBFRzEgdGhpbmcsIGRvbnQga25vdyBpZiBpdCBpcyByZWFsbHlcbiAgICAgICAgICAgICAqIG5lZWRlZFxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogRklYTUU6IGl0IGRvZXMgd29yayB0byByZWR1Y2UgbG93LWZyZXEgcHJvYmxlbXMgaW4gUzUzLVdpbmQtU2F4XG4gICAgICAgICAgICAgKiBhbmQgbGVhZC12b2ljZSBzYW1wbGVzLCBidXQgaW50cm9kdWNlcyBzb21lIDMga2JwcyBiaXQgYmxvYXQgdG9vLlxuICAgICAgICAgICAgICogVE9ETzogRnVydGhlciByZWZpbmVtZW50IG9mIHRoZSBzaGFwZSBvZiB0aGlzIGhhY2suXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIHggPSAtMjAgKyBidmFsW2ldICogMjAgLyAxMDtcbiAgICAgICAgICAgIGlmICh4ID4gNikge1xuICAgICAgICAgICAgICAgIHggPSAxMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoeCA8IC0xNSkge1xuICAgICAgICAgICAgICAgIHggPSAtMTU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB4IC09IDguO1xuICAgICAgICAgICAgZ2ZjLm1pbnZhbF9sW2ldID0gKE1hdGgucG93KDEwLjAsIHggLyAxMC4pICogZ2ZjLm51bWxpbmVzX2xbaV0pO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBkbyB0aGUgc2FtZSB0aGluZ3MgZm9yIHNob3J0IGJsb2Nrc1xuICAgICAgICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICBnZmMubnBhcnRfcyA9IGluaXRfbnVtbGluZShnZmMubnVtbGluZXNfcywgZ2ZjLmJvX3MsIGdmYy5ibV9zLCBidmFsLFxuICAgICAgICAgICAgYnZhbF93aWR0aCwgZ2ZjLm1sZF9zLCBnZmMuUFNZLmJvX3Nfd2VpZ2h0LCBzZnJlcSxcbiAgICAgICAgICAgIEVuY29kZXIuQkxLU0laRV9zLCBnZmMuc2NhbGVmYWNfYmFuZC5zLCBFbmNvZGVyLkJMS1NJWkVfc1xuICAgICAgICAgICAgLyAoMi4wICogMTkyKSwgRW5jb2Rlci5TQk1BWF9zKTtcblxuICAgICAgICAvKiBTTlIgZm9ybXVsYS4gc2hvcnQgYmxvY2sgaXMgbm9ybWFsaXplZCBieSBTTlIuIGlzIGl0IHN0aWxsIHJpZ2h0ID8gKi9cbiAgICAgICAgaiA9IDA7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBnZmMubnBhcnRfczsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgeDtcbiAgICAgICAgICAgIHZhciBzbnIgPSBzbnJfc19hO1xuICAgICAgICAgICAgaWYgKGJ2YWxbaV0gPj0gYnZsX2EpIHtcbiAgICAgICAgICAgICAgICBzbnIgPSBzbnJfc19iICogKGJ2YWxbaV0gLSBidmxfYSkgLyAoYnZsX2IgLSBidmxfYSkgKyBzbnJfc19hXG4gICAgICAgICAgICAgICAgICAgICogKGJ2bF9iIC0gYnZhbFtpXSkgLyAoYnZsX2IgLSBidmxfYSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBub3JtW2ldID0gTWF0aC5wb3coMTAuMCwgc25yIC8gMTAuMCk7XG5cbiAgICAgICAgICAgIC8qIEFUSCAqL1xuICAgICAgICAgICAgeCA9IEZsb2F0Lk1BWF9WQUxVRTtcbiAgICAgICAgICAgIGZvciAodmFyIGsgPSAwOyBrIDwgZ2ZjLm51bWxpbmVzX3NbaV07IGsrKywgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZyZXEgPSBzZnJlcSAqIGogLyAoMTAwMC4wICogRW5jb2Rlci5CTEtTSVpFX3MpO1xuICAgICAgICAgICAgICAgIHZhciBsZXZlbDtcbiAgICAgICAgICAgICAgICAvKiBmcmVxID0gTWluKC4xLGZyZXEpOyAqL1xuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogQVRIIGJlbG93IDEwMCBIeiBjb25zdGFudCwgbm90XG4gICAgICAgICAgICAgICAgICogZnVydGhlciBjbGltYmluZ1xuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGxldmVsID0gdGhpcy5BVEhmb3JtdWxhKGZyZXEgKiAxMDAwLCBnZnApIC0gMjA7XG4gICAgICAgICAgICAgICAgLy8gc2NhbGUgdG8gRkZUIHVuaXRzOyByZXR1cm5lZCB2YWx1ZSBpcyBpbiBkQlxuICAgICAgICAgICAgICAgIGxldmVsID0gTWF0aC5wb3coMTAuLCAwLjEgKiBsZXZlbCk7XG4gICAgICAgICAgICAgICAgLy8gY29udmVydCBmcm9tIGRCIC4gZW5lcmd5XG4gICAgICAgICAgICAgICAgbGV2ZWwgKj0gZ2ZjLm51bWxpbmVzX3NbaV07XG4gICAgICAgICAgICAgICAgaWYgKHggPiBsZXZlbClcbiAgICAgICAgICAgICAgICAgICAgeCA9IGxldmVsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLkFUSC5jYl9zW2ldID0geDtcblxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIE1JTlZBTC4gRm9yIGxvdyBmcmVxLCB0aGUgc3RyZW5ndGggb2YgdGhlIG1hc2tpbmcgaXMgbGltaXRlZCBieVxuICAgICAgICAgICAgICogbWludmFsIHRoaXMgaXMgYW4gSVNPIE1QRUcxIHRoaW5nLCBkb250IGtub3cgaWYgaXQgaXMgcmVhbGx5XG4gICAgICAgICAgICAgKiBuZWVkZWRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgeCA9ICgtNy4wICsgYnZhbFtpXSAqIDcuMCAvIDEyLjApO1xuICAgICAgICAgICAgaWYgKGJ2YWxbaV0gPiAxMikge1xuICAgICAgICAgICAgICAgIHggKj0gMSArIE1hdGgubG9nKDEgKyB4KSAqIDMuMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChidmFsW2ldIDwgMTIpIHtcbiAgICAgICAgICAgICAgICB4ICo9IDEgKyBNYXRoLmxvZygxIC0geCkgKiAyLjM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoeCA8IC0xNSkge1xuICAgICAgICAgICAgICAgIHggPSAtMTU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB4IC09IDg7XG4gICAgICAgICAgICBnZmMubWludmFsX3NbaV0gPSBNYXRoLnBvdygxMC4wLCB4IC8gMTApXG4gICAgICAgICAgICAgICAgKiBnZmMubnVtbGluZXNfc1tpXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdmYy5zM19zcyA9IGluaXRfczNfdmFsdWVzKGdmYy5zM2luZF9zLCBnZmMubnBhcnRfcywgYnZhbCwgYnZhbF93aWR0aCxcbiAgICAgICAgICAgIG5vcm0sIHVzZU9sZFMzKTtcblxuICAgICAgICBpbml0X21hc2tfYWRkX21heF92YWx1ZXMoKTtcbiAgICAgICAgZmZ0LmluaXRfZmZ0KGdmYyk7XG5cbiAgICAgICAgLyogc2V0dXAgdGVtcG9yYWwgbWFza2luZyAqL1xuICAgICAgICBnZmMuZGVjYXkgPSBNYXRoLmV4cCgtMS4wICogTE9HMTBcbiAgICAgICAgICAgIC8gKHRlbXBvcmFsbWFza19zdXN0YWluX3NlYyAqIHNmcmVxIC8gMTkyLjApKTtcblxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgbXNmaXg7XG4gICAgICAgICAgICBtc2ZpeCA9IE5TX01TRklYO1xuICAgICAgICAgICAgaWYgKChnZnAuZXhwX25zcHN5dHVuZSAmIDIpICE9IDApXG4gICAgICAgICAgICAgICAgbXNmaXggPSAxLjA7XG4gICAgICAgICAgICBpZiAoTWF0aC5hYnMoZ2ZwLm1zZml4KSA+IDAuMClcbiAgICAgICAgICAgICAgICBtc2ZpeCA9IGdmcC5tc2ZpeDtcbiAgICAgICAgICAgIGdmcC5tc2ZpeCA9IG1zZml4O1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogc3ByZWFkIG9ubHkgZnJvbSBucGFydF9sIGJhbmRzLiBOb3JtYWxseSwgd2UgdXNlIHRoZSBzcHJlYWRpbmdcbiAgICAgICAgICAgICAqIGZ1bmN0aW9uIHRvIGNvbnZvbHZlIGZyb20gbnBhcnRfbCBkb3duIHRvIG5wYXJ0X2wgYmFuZHNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZm9yICh2YXIgYiA9IDA7IGIgPCBnZmMubnBhcnRfbDsgYisrKVxuICAgICAgICAgICAgICAgIGlmIChnZmMuczNpbmRbYl1bMV0gPiBnZmMubnBhcnRfbCAtIDEpXG4gICAgICAgICAgICAgICAgICAgIGdmYy5zM2luZFtiXVsxXSA9IGdmYy5ucGFydF9sIC0gMTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIHByZXBhcmUgZm9yIEFUSCBhdXRvIGFkanVzdG1lbnQ6IHdlIHdhbnQgdG8gZGVjcmVhc2UgdGhlIEFUSCBieSAxMiBkQlxuICAgICAgICAgKiBwZXIgc2Vjb25kXG4gICAgICAgICAqL1xuICAgICAgICB2YXIgZnJhbWVfZHVyYXRpb24gPSAoNTc2LiAqIGdmYy5tb2RlX2dyIC8gc2ZyZXEpO1xuICAgICAgICBnZmMuQVRILmRlY2F5ID0gTWF0aC5wb3coMTAuLCAtMTIuIC8gMTAuICogZnJhbWVfZHVyYXRpb24pO1xuICAgICAgICBnZmMuQVRILmFkanVzdCA9IDAuMDE7XG4gICAgICAgIC8qIG1pbmltdW0sIGZvciBsZWFkaW5nIGxvdyBsb3VkbmVzcyAqL1xuICAgICAgICBnZmMuQVRILmFkanVzdExpbWl0ID0gMS4wO1xuICAgICAgICAvKiBvbiBsZWFkLCBhbGxvdyBhZGp1c3QgdXAgdG8gbWF4aW11bSAqL1xuXG5cbiAgICAgICAgaWYgKGdmcC5BVEh0eXBlICE9IC0xKSB7XG4gICAgICAgICAgICAvKiBjb21wdXRlIGVxdWFsIGxvdWRuZXNzIHdlaWdodHMgKGVxbF93KSAqL1xuICAgICAgICAgICAgdmFyIGZyZXE7XG4gICAgICAgICAgICB2YXIgZnJlcV9pbmMgPSBnZnAub3V0X3NhbXBsZXJhdGVcbiAgICAgICAgICAgICAgICAvIChFbmNvZGVyLkJMS1NJWkUpO1xuICAgICAgICAgICAgdmFyIGVxbF9iYWxhbmNlID0gMC4wO1xuICAgICAgICAgICAgZnJlcSA9IDAuMDtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBFbmNvZGVyLkJMS1NJWkUgLyAyOyArK2kpIHtcbiAgICAgICAgICAgICAgICAvKiBjb252ZXJ0IEFUSCBkQiB0byByZWxhdGl2ZSBwb3dlciAobm90IGRCKSAqL1xuICAgICAgICAgICAgICAgIC8qIHRvIGRldGVybWluZSBlcWxfdyAqL1xuICAgICAgICAgICAgICAgIGZyZXEgKz0gZnJlcV9pbmM7XG4gICAgICAgICAgICAgICAgZ2ZjLkFUSC5lcWxfd1tpXSA9IDEuIC8gTWF0aC5wb3coMTAsIHRoaXMuQVRIZm9ybXVsYShmcmVxLCBnZnApIC8gMTApO1xuICAgICAgICAgICAgICAgIGVxbF9iYWxhbmNlICs9IGdmYy5BVEguZXFsX3dbaV07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlcWxfYmFsYW5jZSA9IDEuMCAvIGVxbF9iYWxhbmNlO1xuICAgICAgICAgICAgZm9yIChpID0gRW5jb2Rlci5CTEtTSVpFIC8gMjsgLS1pID49IDA7KSB7IC8qIHNjYWxlIHdlaWdodHMgKi9cbiAgICAgICAgICAgICAgICBnZmMuQVRILmVxbF93W2ldICo9IGVxbF9iYWxhbmNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHtcbiAgICAgICAgICAgIGZvciAodmFyIGIgPSBqID0gMDsgYiA8IGdmYy5ucGFydF9zOyArK2IpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZ2ZjLm51bWxpbmVzX3NbYl07ICsraSkge1xuICAgICAgICAgICAgICAgICAgICArK2o7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgYiA9IGogPSAwOyBiIDwgZ2ZjLm5wYXJ0X2w7ICsrYikge1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBnZmMubnVtbGluZXNfbFtiXTsgKytpKSB7XG4gICAgICAgICAgICAgICAgICAgICsrajtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaiA9IDA7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBnZmMubnBhcnRfbDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZnJlcSA9IHNmcmVxICogKGogKyBnZmMubnVtbGluZXNfbFtpXSAvIDIpIC8gKDEuMCAqIEVuY29kZXIuQkxLU0laRSk7XG4gICAgICAgICAgICBnZmMubWxkX2NiX2xbaV0gPSBzdGVyZW9fZGVtYXNrKGZyZXEpO1xuICAgICAgICAgICAgaiArPSBnZmMubnVtbGluZXNfbFtpXTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKDsgaSA8IEVuY29kZXIuQ0JBTkRTOyArK2kpIHtcbiAgICAgICAgICAgIGdmYy5tbGRfY2JfbFtpXSA9IDE7XG4gICAgICAgIH1cbiAgICAgICAgaiA9IDA7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBnZmMubnBhcnRfczsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgZnJlcSA9IHNmcmVxICogKGogKyBnZmMubnVtbGluZXNfc1tpXSAvIDIpIC8gKDEuMCAqIEVuY29kZXIuQkxLU0laRV9zKTtcbiAgICAgICAgICAgIGdmYy5tbGRfY2Jfc1tpXSA9IHN0ZXJlb19kZW1hc2soZnJlcSk7XG4gICAgICAgICAgICBqICs9IGdmYy5udW1saW5lc19zW2ldO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoOyBpIDwgRW5jb2Rlci5DQkFORFM7ICsraSkge1xuICAgICAgICAgICAgZ2ZjLm1sZF9jYl9zW2ldID0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUaG9zZSBBVEggZm9ybXVsYXMgYXJlIHJldHVybmluZyB0aGVpciBtaW5pbXVtIHZhbHVlIGZvciBpbnB1dCA9IC0xXG4gICAgICovXG4gICAgZnVuY3Rpb24gQVRIZm9ybXVsYV9HQihmLCB2YWx1ZSkge1xuICAgICAgICAvKipcbiAgICAgICAgICogPFBSRT5cbiAgICAgICAgICogIGZyb20gUGFpbnRlciAmIFNwYW5pYXNcbiAgICAgICAgICogICAgICAgICAgIG1vZGlmaWVkIGJ5IEdhYnJpZWwgQm91dmlnbmUgdG8gYmV0dGVyIGZpdCB0aGUgcmVhbGl0eVxuICAgICAgICAgKiAgICAgICAgICAgYXRoID0gICAgMy42NDAgKiBwb3coZiwtMC44KVxuICAgICAgICAgKiAgICAgICAgICAgLSA2LjgwMCAqIGV4cCgtMC42KnBvdyhmLTMuNCwyLjApKVxuICAgICAgICAgKiAgICAgICAgICAgKyA2LjAwMCAqIGV4cCgtMC4xNSpwb3coZi04LjcsMi4wKSlcbiAgICAgICAgICogICAgICAgICAgICsgMC42KiAwLjAwMSAqIHBvdyhmLDQuMCk7XG4gICAgICAgICAqXG4gICAgICAgICAqXG4gICAgICAgICAqICAgICAgICAgICBJbiB0aGUgcGFzdCBMQU1FIHdhcyB1c2luZyB0aGUgUGFpbnRlciAmU3BhbmlhcyBmb3JtdWxhLlxuICAgICAgICAgKiAgICAgICAgICAgQnV0IHdlIGhhZCBzb21lIHJlY3VycmVudCBwcm9ibGVtcyB3aXRoIEhGIGNvbnRlbnQuXG4gICAgICAgICAqICAgICAgICAgICBXZSBtZWFzdXJlZCByZWFsIEFUSCB2YWx1ZXMsIGFuZCBmb3VuZCB0aGUgb2xkZXIgZm9ybXVsYVxuICAgICAgICAgKiAgICAgICAgICAgdG8gYmUgaW5hY2N1cmF0ZSBpbiB0aGUgaGlnaGVyIHBhcnQuIFNvIHdlIG1hZGUgdGhpcyBuZXdcbiAgICAgICAgICogICAgICAgICAgIGZvcm11bGEgYW5kIHRoaXMgc29sdmVkIG1vc3Qgb2YgSEYgcHJvYmxlbWF0aWMgdGVzdCBjYXNlcy5cbiAgICAgICAgICogICAgICAgICAgIFRoZSB0cmFkZW9mZiBpcyB0aGF0IGluIFZCUiBtb2RlIGl0IGluY3JlYXNlcyBhIGxvdCB0aGVcbiAgICAgICAgICogICAgICAgICAgIGJpdHJhdGUuXG4gICAgICAgICAqIDwvUFJFPlxuICAgICAgICAgKi9cblxuICAgICAgICAvKlxuICAgICAgICAgKiBUaGlzIGN1cnZlIGNhbiBiZSBhZGp1c3RlZCBhY2NvcmRpbmcgdG8gdGhlIFZCUiBzY2FsZTogaXQgYWRqdXN0c1xuICAgICAgICAgKiBmcm9tIHNvbWV0aGluZyBjbG9zZSB0byBQYWludGVyICYgU3BhbmlhcyBvbiBWOSB1cCB0byBCb3V2aWduZSdzXG4gICAgICAgICAqIGZvcm11bGEgZm9yIFYwLiBUaGlzIHdheSB0aGUgVkJSIGJpdHJhdGUgaXMgbW9yZSBiYWxhbmNlZCBhY2NvcmRpbmdcbiAgICAgICAgICogdG8gdGhlIC1WIHZhbHVlLlxuICAgICAgICAgKi9cblxuICAgICAgICAvLyB0aGUgZm9sbG93aW5nIEhhY2sgYWxsb3dzIHRvIGFzayBmb3IgdGhlIGxvd2VzdCB2YWx1ZVxuICAgICAgICBpZiAoZiA8IC0uMylcbiAgICAgICAgICAgIGYgPSAzNDEwO1xuXG4gICAgICAgIC8vIGNvbnZlcnQgdG8ga2h6XG4gICAgICAgIGYgLz0gMTAwMDtcbiAgICAgICAgZiA9IE1hdGgubWF4KDAuMSwgZik7XG4gICAgICAgIHZhciBhdGggPSAzLjY0MCAqIE1hdGgucG93KGYsIC0wLjgpIC0gNi44MDBcbiAgICAgICAgICAgICogTWF0aC5leHAoLTAuNiAqIE1hdGgucG93KGYgLSAzLjQsIDIuMCkpICsgNi4wMDBcbiAgICAgICAgICAgICogTWF0aC5leHAoLTAuMTUgKiBNYXRoLnBvdyhmIC0gOC43LCAyLjApKVxuICAgICAgICAgICAgKyAoMC42ICsgMC4wNCAqIHZhbHVlKSAqIDAuMDAxICogTWF0aC5wb3coZiwgNC4wKTtcbiAgICAgICAgcmV0dXJuIGF0aDtcbiAgICB9XG5cbiAgICB0aGlzLkFUSGZvcm11bGEgPSBmdW5jdGlvbiAoZiwgZ2ZwKSB7XG4gICAgICAgIHZhciBhdGg7XG4gICAgICAgIHN3aXRjaCAoZ2ZwLkFUSHR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgMDpcbiAgICAgICAgICAgICAgICBhdGggPSBBVEhmb3JtdWxhX0dCKGYsIDkpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIC8vIG92ZXIgc2Vuc2l0aXZlLCBzaG91bGQgcHJvYmFibHkgYmUgcmVtb3ZlZFxuICAgICAgICAgICAgICAgIGF0aCA9IEFUSGZvcm11bGFfR0IoZiwgLTEpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgIGF0aCA9IEFUSGZvcm11bGFfR0IoZiwgMCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgLy8gbW9kaWZpY2F0aW9uIG9mIEdCIGZvcm11bGEgYnkgUm9lbFxuICAgICAgICAgICAgICAgIGF0aCA9IEFUSGZvcm11bGFfR0IoZiwgMSkgKyA2O1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSA0OlxuICAgICAgICAgICAgICAgIGF0aCA9IEFUSGZvcm11bGFfR0IoZiwgZ2ZwLkFUSGN1cnZlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYXRoID0gQVRIZm9ybXVsYV9HQihmLCAwKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXRoO1xuICAgIH1cblxufVxuXG5cblxuZnVuY3Rpb24gTGFtZSgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIExBTUVfTUFYQUxCVU1BUlQgPSAoMTI4ICogMTAyNCk7XG5cbiAgICBMYW1lLlY5ID0gNDEwO1xuICAgIExhbWUuVjggPSA0MjA7XG4gICAgTGFtZS5WNyA9IDQzMDtcbiAgICBMYW1lLlY2ID0gNDQwO1xuICAgIExhbWUuVjUgPSA0NTA7XG4gICAgTGFtZS5WNCA9IDQ2MDtcbiAgICBMYW1lLlYzID0gNDcwO1xuICAgIExhbWUuVjIgPSA0ODA7XG4gICAgTGFtZS5WMSA9IDQ5MDtcbiAgICBMYW1lLlYwID0gNTAwO1xuXG4gICAgLyogc3RpbGwgdGhlcmUgZm9yIGNvbXBhdGliaWxpdHkgKi9cblxuICAgIExhbWUuUjNNSVggPSAxMDAwO1xuICAgIExhbWUuU1RBTkRBUkQgPSAxMDAxO1xuICAgIExhbWUuRVhUUkVNRSA9IDEwMDI7XG4gICAgTGFtZS5JTlNBTkUgPSAxMDAzO1xuICAgIExhbWUuU1RBTkRBUkRfRkFTVCA9IDEwMDQ7XG4gICAgTGFtZS5FWFRSRU1FX0ZBU1QgPSAxMDA1O1xuICAgIExhbWUuTUVESVVNID0gMTAwNjtcbiAgICBMYW1lLk1FRElVTV9GQVNUID0gMTAwNztcblxuICAgIC8qKlxuICAgICAqIG1heGltdW0gc2l6ZSBvZiBtcDNidWZmZXIgbmVlZGVkIGlmIHlvdSBlbmNvZGUgYXQgbW9zdCAxMTUyIHNhbXBsZXMgZm9yXG4gICAgICogZWFjaCBjYWxsIHRvIGxhbWVfZW5jb2RlX2J1ZmZlci4gc2VlIGxhbWVfZW5jb2RlX2J1ZmZlcigpIGJlbG93XG4gICAgICogKExBTUVfTUFYTVAzQlVGRkVSIGlzIG5vdyBvYnNvbGV0ZSlcbiAgICAgKi9cbiAgICB2YXIgTEFNRV9NQVhNUDNCVUZGRVIgPSAoMTYzODQgKyBMQU1FX01BWEFMQlVNQVJUKTtcbiAgICBMYW1lLkxBTUVfTUFYTVAzQlVGRkVSID0gTEFNRV9NQVhNUDNCVUZGRVI7XG5cbiAgICB2YXIgZ2E7XG4gICAgdmFyIGJzO1xuICAgIHZhciBwO1xuICAgIHZhciBxdXB2dDtcbiAgICB2YXIgcXU7XG4gICAgdmFyIHBzeSA9IG5ldyBQc3lNb2RlbCgpO1xuICAgIHZhciB2YnI7XG4gICAgdmFyIHZlcjtcbiAgICB2YXIgaWQzO1xuICAgIHZhciBtcGdsaWI7XG4gICAgdGhpcy5lbmMgPSBuZXcgRW5jb2RlcigpO1xuXG4gICAgdGhpcy5zZXRNb2R1bGVzID0gZnVuY3Rpb24gKF9nYSwgX2JzLCBfcCwgX3F1cHZ0LCBfcXUsIF92YnIsIF92ZXIsIF9pZDMsIF9tcGdsaWIpIHtcbiAgICAgICAgZ2EgPSBfZ2E7XG4gICAgICAgIGJzID0gX2JzO1xuICAgICAgICBwID0gX3A7XG4gICAgICAgIHF1cHZ0ID0gX3F1cHZ0O1xuICAgICAgICBxdSA9IF9xdTtcbiAgICAgICAgdmJyID0gX3ZicjtcbiAgICAgICAgdmVyID0gX3ZlcjtcbiAgICAgICAgaWQzID0gX2lkMztcbiAgICAgICAgbXBnbGliID0gX21wZ2xpYjtcbiAgICAgICAgdGhpcy5lbmMuc2V0TW9kdWxlcyhicywgcHN5LCBxdXB2dCwgdmJyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQU1kgTW9kZWwgcmVsYXRlZCBzdHVmZlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIFBTWSgpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBkYlEgc3R1ZmYuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm1hc2tfYWRqdXN0ID0gMC47XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgZGJRIHN0dWZmLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tYXNrX2FkanVzdF9zaG9ydCA9IDAuO1xuICAgICAgICAvKiBhdCB0cmFuc2l0aW9uIGZyb20gb25lIHNjYWxlZmFjdG9yIGJhbmQgdG8gbmV4dCAqL1xuICAgICAgICAvKipcbiAgICAgICAgICogQmFuZCB3ZWlnaHQgbG9uZyBzY2FsZWZhY3RvciBiYW5kcy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuYm9fbF93ZWlnaHQgPSBuZXdfZmxvYXQoRW5jb2Rlci5TQk1BWF9sKTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEJhbmQgd2VpZ2h0IHNob3J0IHNjYWxlZmFjdG9yIGJhbmRzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5ib19zX3dlaWdodCA9IG5ld19mbG9hdChFbmNvZGVyLlNCTUFYX3MpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIExvd1Bhc3NIaWdoUGFzcygpIHtcbiAgICAgICAgdGhpcy5sb3dlcmxpbWl0ID0gMC47XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gQmFuZFBhc3MoYml0cmF0ZSwgbFBhc3MpIHtcbiAgICAgICAgdGhpcy5sb3dwYXNzID0gbFBhc3M7XG4gICAgfVxuXG4gICAgdmFyIExBTUVfSUQgPSAweEZGRjg4RTNCO1xuXG4gICAgZnVuY3Rpb24gbGFtZV9pbml0X29sZChnZnApIHtcbiAgICAgICAgdmFyIGdmYztcblxuICAgICAgICBnZnAuY2xhc3NfaWQgPSBMQU1FX0lEO1xuXG4gICAgICAgIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncyA9IG5ldyBMYW1lSW50ZXJuYWxGbGFncygpO1xuXG4gICAgICAgIC8qIEdsb2JhbCBmbGFncy4gc2V0IGRlZmF1bHRzIGhlcmUgZm9yIG5vbi16ZXJvIHZhbHVlcyAqL1xuICAgICAgICAvKiBzZWUgbGFtZS5oIGZvciBkZXNjcmlwdGlvbiAqL1xuICAgICAgICAvKlxuICAgICAgICAgKiBzZXQgaW50ZWdlciB2YWx1ZXMgdG8gLTEgdG8gbWVhbiB0aGF0IExBTUUgd2lsbCBjb21wdXRlIHRoZSBiZXN0XG4gICAgICAgICAqIHZhbHVlLCBVTkxFU1MgdGhlIGNhbGxpbmcgcHJvZ3JhbSBhcyBzZXQgaXQgKGFuZCB0aGUgdmFsdWUgaXMgbm9cbiAgICAgICAgICogbG9uZ2VyIC0xKVxuICAgICAgICAgKi9cblxuICAgICAgICBnZnAubW9kZSA9IE1QRUdNb2RlLk5PVF9TRVQ7XG4gICAgICAgIGdmcC5vcmlnaW5hbCA9IDE7XG4gICAgICAgIGdmcC5pbl9zYW1wbGVyYXRlID0gNDQxMDA7XG4gICAgICAgIGdmcC5udW1fY2hhbm5lbHMgPSAyO1xuICAgICAgICBnZnAubnVtX3NhbXBsZXMgPSAtMTtcblxuICAgICAgICBnZnAuYldyaXRlVmJyVGFnID0gdHJ1ZTtcbiAgICAgICAgZ2ZwLnF1YWxpdHkgPSAtMTtcbiAgICAgICAgZ2ZwLnNob3J0X2Jsb2NrcyA9IG51bGw7XG4gICAgICAgIGdmYy5zdWJibG9ja19nYWluID0gLTE7XG5cbiAgICAgICAgZ2ZwLmxvd3Bhc3NmcmVxID0gMDtcbiAgICAgICAgZ2ZwLmhpZ2hwYXNzZnJlcSA9IDA7XG4gICAgICAgIGdmcC5sb3dwYXNzd2lkdGggPSAtMTtcbiAgICAgICAgZ2ZwLmhpZ2hwYXNzd2lkdGggPSAtMTtcblxuICAgICAgICBnZnAuVkJSID0gVmJyTW9kZS52YnJfb2ZmO1xuICAgICAgICBnZnAuVkJSX3EgPSA0O1xuICAgICAgICBnZnAuQVRIY3VydmUgPSAtMTtcbiAgICAgICAgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyA9IDEyODtcbiAgICAgICAgZ2ZwLlZCUl9taW5fYml0cmF0ZV9rYnBzID0gMDtcbiAgICAgICAgZ2ZwLlZCUl9tYXhfYml0cmF0ZV9rYnBzID0gMDtcbiAgICAgICAgZ2ZwLlZCUl9oYXJkX21pbiA9IDA7XG4gICAgICAgIGdmYy5WQlJfbWluX2JpdHJhdGUgPSAxO1xuICAgICAgICAvKiBub3QgMCA/Pz8/PyAqL1xuICAgICAgICBnZmMuVkJSX21heF9iaXRyYXRlID0gMTM7XG4gICAgICAgIC8qIG5vdCAxNCA/Pz8/PyAqL1xuXG4gICAgICAgIGdmcC5xdWFudF9jb21wID0gLTE7XG4gICAgICAgIGdmcC5xdWFudF9jb21wX3Nob3J0ID0gLTE7XG5cbiAgICAgICAgZ2ZwLm1zZml4ID0gLTE7XG5cbiAgICAgICAgZ2ZjLnJlc2FtcGxlX3JhdGlvID0gMTtcblxuICAgICAgICBnZmMuT2xkVmFsdWVbMF0gPSAxODA7XG4gICAgICAgIGdmYy5PbGRWYWx1ZVsxXSA9IDE4MDtcbiAgICAgICAgZ2ZjLkN1cnJlbnRTdGVwWzBdID0gNDtcbiAgICAgICAgZ2ZjLkN1cnJlbnRTdGVwWzFdID0gNDtcbiAgICAgICAgZ2ZjLm1hc2tpbmdfbG93ZXIgPSAxO1xuICAgICAgICBnZmMubnNQc3kuYXR0YWNrdGhyZSA9IC0xO1xuICAgICAgICBnZmMubnNQc3kuYXR0YWNrdGhyZV9zID0gLTE7XG5cbiAgICAgICAgZ2ZwLnNjYWxlID0gLTE7XG5cbiAgICAgICAgZ2ZwLmF0aGFhX3R5cGUgPSAtMTtcbiAgICAgICAgZ2ZwLkFUSHR5cGUgPSAtMTtcbiAgICAgICAgLyogZGVmYXVsdCA9IC0xID0gc2V0IGluIGxhbWVfaW5pdF9wYXJhbXMgKi9cbiAgICAgICAgZ2ZwLmF0aGFhX2xvdWRhcHByb3ggPSAtMTtcbiAgICAgICAgLyogMSA9IGZsYXQgbG91ZG5lc3MgYXBwcm94LiAodG90YWwgZW5lcmd5KSAqL1xuICAgICAgICAvKiAyID0gZXF1YWwgbG91ZG5lc3MgY3VydmUgKi9cbiAgICAgICAgZ2ZwLmF0aGFhX3NlbnNpdGl2aXR5ID0gMC4wO1xuICAgICAgICAvKiBubyBvZmZzZXQgKi9cbiAgICAgICAgZ2ZwLnVzZVRlbXBvcmFsID0gbnVsbDtcbiAgICAgICAgZ2ZwLmludGVyQ2hSYXRpbyA9IC0xO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIFRoZSByZWFzb24gZm9yIGludCBtZl9zYW1wbGVzX3RvX2VuY29kZSA9IEVOQ0RFTEFZICsgUE9TVERFTEFZO1xuICAgICAgICAgKiBFTkNERUxBWSA9IGludGVybmFsIGVuY29kZXIgZGVsYXkuIEFuZCB0aGVuIHdlIGhhdmUgdG8gYWRkXG4gICAgICAgICAqIFBPU1RERUxBWT0yODggYmVjYXVzZSBvZiB0aGUgNTAlIE1EQ1Qgb3ZlcmxhcC4gQSA1NzYgTURDVCBncmFudWxlXG4gICAgICAgICAqIGRlY29kZXMgdG8gMTE1MiBzYW1wbGVzLiBUbyBzeW50aGVzaXplIHRoZSA1NzYgc2FtcGxlcyBjZW50ZXJlZCB1bmRlclxuICAgICAgICAgKiB0aGlzIGdyYW51bGUgd2UgbmVlZCB0aGUgcHJldmlvdXMgZ3JhbnVsZSBmb3IgdGhlIGZpcnN0IDI4OCBzYW1wbGVzXG4gICAgICAgICAqIChubyBwcm9ibGVtKSwgYW5kIHRoZSBuZXh0IGdyYW51bGUgZm9yIHRoZSBuZXh0IDI4OCBzYW1wbGVzIChub3RcbiAgICAgICAgICogcG9zc2libGUgaWYgdGhpcyBpcyBsYXN0IGdyYW51bGUpLiBTbyB3ZSBuZWVkIHRvIHBhZCB3aXRoIDI4OCBzYW1wbGVzXG4gICAgICAgICAqIHRvIG1ha2Ugc3VyZSB3ZSBjYW4gZW5jb2RlIHRoZSA1NzYgc2FtcGxlcyB3ZSBhcmUgaW50ZXJlc3RlZCBpbi5cbiAgICAgICAgICovXG4gICAgICAgIGdmYy5tZl9zYW1wbGVzX3RvX2VuY29kZSA9IEVuY29kZXIuRU5DREVMQVkgKyBFbmNvZGVyLlBPU1RERUxBWTtcbiAgICAgICAgZ2ZwLmVuY29kZXJfcGFkZGluZyA9IDA7XG4gICAgICAgIGdmYy5tZl9zaXplID0gRW5jb2Rlci5FTkNERUxBWSAtIEVuY29kZXIuTURDVERFTEFZO1xuICAgICAgICAvKlxuICAgICAgICAgKiB3ZSBwYWQgaW5wdXQgd2l0aCB0aGlzIG1hbnkgMCdzXG4gICAgICAgICAqL1xuXG4gICAgICAgIGdmcC5maW5kUmVwbGF5R2FpbiA9IGZhbHNlO1xuICAgICAgICBnZnAuZGVjb2RlX29uX3RoZV9mbHkgPSBmYWxzZTtcblxuICAgICAgICBnZmMuZGVjb2RlX29uX3RoZV9mbHkgPSBmYWxzZTtcbiAgICAgICAgZ2ZjLmZpbmRSZXBsYXlHYWluID0gZmFsc2U7XG4gICAgICAgIGdmYy5maW5kUGVha1NhbXBsZSA9IGZhbHNlO1xuXG4gICAgICAgIGdmYy5SYWRpb0dhaW4gPSAwO1xuICAgICAgICBnZmMuQXVkaW9waGlsZUdhaW4gPSAwO1xuICAgICAgICBnZmMubm9jbGlwR2FpbkNoYW5nZSA9IDA7XG4gICAgICAgIGdmYy5ub2NsaXBTY2FsZSA9IC0xLjA7XG5cbiAgICAgICAgZ2ZwLnByZXNldCA9IDA7XG5cbiAgICAgICAgZ2ZwLndyaXRlX2lkM3RhZ19hdXRvbWF0aWMgPSB0cnVlO1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG5cbiAgICB0aGlzLmxhbWVfaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGdmcCA9IG5ldyBMYW1lR2xvYmFsRmxhZ3MoKTtcblxuICAgICAgICB2YXIgcmV0ID0gbGFtZV9pbml0X29sZChnZnApO1xuICAgICAgICBpZiAocmV0ICE9IDApIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgZ2ZwLmxhbWVfYWxsb2NhdGVkX2dmcCA9IDE7XG4gICAgICAgIHJldHVybiBnZnA7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZmlsdGVyX2NvZWYoeCkge1xuICAgICAgICBpZiAoeCA+IDEuMClcbiAgICAgICAgICAgIHJldHVybiAwLjA7XG4gICAgICAgIGlmICh4IDw9IDAuMClcbiAgICAgICAgICAgIHJldHVybiAxLjA7XG5cbiAgICAgICAgcmV0dXJuIE1hdGguY29zKE1hdGguUEkgLyAyICogeCk7XG4gICAgfVxuXG4gICAgdGhpcy5uZWFyZXN0Qml0cmF0ZUZ1bGxJbmRleCA9IGZ1bmN0aW9uIChiaXRyYXRlKSB7XG4gICAgICAgIC8qIGJvcnJvd2VkIGZyb20gRE0gYWJyIHByZXNldHMgKi9cblxuICAgICAgICB2YXIgZnVsbF9iaXRyYXRlX3RhYmxlID0gWzgsIDE2LCAyNCwgMzIsIDQwLCA0OCwgNTYsIDY0LCA4MCxcbiAgICAgICAgICAgIDk2LCAxMTIsIDEyOCwgMTYwLCAxOTIsIDIyNCwgMjU2LCAzMjBdO1xuXG4gICAgICAgIHZhciBsb3dlcl9yYW5nZSA9IDAsIGxvd2VyX3JhbmdlX2ticHMgPSAwLCB1cHBlcl9yYW5nZSA9IDAsIHVwcGVyX3JhbmdlX2ticHMgPSAwO1xuXG4gICAgICAgIC8qIFdlIGFzc3VtZSBzcGVjaWZpZWQgYml0cmF0ZSB3aWxsIGJlIDMyMGticHMgKi9cbiAgICAgICAgdXBwZXJfcmFuZ2Vfa2JwcyA9IGZ1bGxfYml0cmF0ZV90YWJsZVsxNl07XG4gICAgICAgIHVwcGVyX3JhbmdlID0gMTY7XG4gICAgICAgIGxvd2VyX3JhbmdlX2ticHMgPSBmdWxsX2JpdHJhdGVfdGFibGVbMTZdO1xuICAgICAgICBsb3dlcl9yYW5nZSA9IDE2O1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIERldGVybWluZSB3aGljaCBzaWduaWZpY2FudCBiaXRyYXRlcyB0aGUgdmFsdWUgc3BlY2lmaWVkIGZhbGxzXG4gICAgICAgICAqIGJldHdlZW4sIGlmIGxvb3AgZW5kcyB3aXRob3V0IGJyZWFraW5nIHRoZW4gd2Ugd2VyZSBjb3JyZWN0IGFib3ZlXG4gICAgICAgICAqIHRoYXQgdGhlIHZhbHVlIHdhcyAzMjBcbiAgICAgICAgICovXG4gICAgICAgIGZvciAodmFyIGIgPSAwOyBiIDwgMTY7IGIrKykge1xuICAgICAgICAgICAgaWYgKChNYXRoLm1heChiaXRyYXRlLCBmdWxsX2JpdHJhdGVfdGFibGVbYiArIDFdKSkgIT0gYml0cmF0ZSkge1xuICAgICAgICAgICAgICAgIHVwcGVyX3JhbmdlX2ticHMgPSBmdWxsX2JpdHJhdGVfdGFibGVbYiArIDFdO1xuICAgICAgICAgICAgICAgIHVwcGVyX3JhbmdlID0gYiArIDE7XG4gICAgICAgICAgICAgICAgbG93ZXJfcmFuZ2Vfa2JwcyA9IGZ1bGxfYml0cmF0ZV90YWJsZVtiXTtcbiAgICAgICAgICAgICAgICBsb3dlcl9yYW5nZSA9IChiKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAvKiBXZSBmb3VuZCB1cHBlciByYW5nZSAqL1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogRGV0ZXJtaW5lIHdoaWNoIHJhbmdlIHRoZSB2YWx1ZSBzcGVjaWZpZWQgaXMgY2xvc2VyIHRvICovXG4gICAgICAgIGlmICgodXBwZXJfcmFuZ2Vfa2JwcyAtIGJpdHJhdGUpID4gKGJpdHJhdGUgLSBsb3dlcl9yYW5nZV9rYnBzKSkge1xuICAgICAgICAgICAgcmV0dXJuIGxvd2VyX3JhbmdlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB1cHBlcl9yYW5nZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvcHRpbXVtX3NhbXBsZWZyZXEobG93cGFzc2ZyZXEsIGlucHV0X3NhbXBsZWZyZXEpIHtcbiAgICAgICAgLypcbiAgICAgICAgICogUnVsZXM6XG4gICAgICAgICAqXG4gICAgICAgICAqIC0gaWYgcG9zc2libGUsIHNmYjIxIHNob3VsZCBOT1QgYmUgdXNlZFxuICAgICAgICAgKi9cbiAgICAgICAgdmFyIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gNDQxMDA7XG5cbiAgICAgICAgaWYgKGlucHV0X3NhbXBsZWZyZXEgPj0gNDgwMDApXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDQ4MDAwO1xuICAgICAgICBlbHNlIGlmIChpbnB1dF9zYW1wbGVmcmVxID49IDQ0MTAwKVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSA0NDEwMDtcbiAgICAgICAgZWxzZSBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+PSAzMjAwMClcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gMzIwMDA7XG4gICAgICAgIGVsc2UgaWYgKGlucHV0X3NhbXBsZWZyZXEgPj0gMjQwMDApXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDI0MDAwO1xuICAgICAgICBlbHNlIGlmIChpbnB1dF9zYW1wbGVmcmVxID49IDIyMDUwKVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSAyMjA1MDtcbiAgICAgICAgZWxzZSBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+PSAxNjAwMClcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gMTYwMDA7XG4gICAgICAgIGVsc2UgaWYgKGlucHV0X3NhbXBsZWZyZXEgPj0gMTIwMDApXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDEyMDAwO1xuICAgICAgICBlbHNlIGlmIChpbnB1dF9zYW1wbGVmcmVxID49IDExMDI1KVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSAxMTAyNTtcbiAgICAgICAgZWxzZSBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+PSA4MDAwKVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSA4MDAwO1xuXG4gICAgICAgIGlmIChsb3dwYXNzZnJlcSA9PSAtMSlcbiAgICAgICAgICAgIHJldHVybiBzdWdnZXN0ZWRfc2FtcGxlZnJlcTtcblxuICAgICAgICBpZiAobG93cGFzc2ZyZXEgPD0gMTU5NjApXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDQ0MTAwO1xuICAgICAgICBpZiAobG93cGFzc2ZyZXEgPD0gMTUyNTApXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDMyMDAwO1xuICAgICAgICBpZiAobG93cGFzc2ZyZXEgPD0gMTEyMjApXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDI0MDAwO1xuICAgICAgICBpZiAobG93cGFzc2ZyZXEgPD0gOTk3MClcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gMjIwNTA7XG4gICAgICAgIGlmIChsb3dwYXNzZnJlcSA8PSA3MjMwKVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSAxNjAwMDtcbiAgICAgICAgaWYgKGxvd3Bhc3NmcmVxIDw9IDU0MjApXG4gICAgICAgICAgICBzdWdnZXN0ZWRfc2FtcGxlZnJlcSA9IDEyMDAwO1xuICAgICAgICBpZiAobG93cGFzc2ZyZXEgPD0gNDUxMClcbiAgICAgICAgICAgIHN1Z2dlc3RlZF9zYW1wbGVmcmVxID0gMTEwMjU7XG4gICAgICAgIGlmIChsb3dwYXNzZnJlcSA8PSAzOTcwKVxuICAgICAgICAgICAgc3VnZ2VzdGVkX3NhbXBsZWZyZXEgPSA4MDAwO1xuXG4gICAgICAgIGlmIChpbnB1dF9zYW1wbGVmcmVxIDwgc3VnZ2VzdGVkX3NhbXBsZWZyZXEpIHtcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBjaG9vc2UgYSB2YWxpZCBNUEVHIHNhbXBsZSBmcmVxdWVuY3kgYWJvdmUgdGhlIGlucHV0IHNhbXBsZVxuICAgICAgICAgICAgICogZnJlcXVlbmN5IHRvIGF2b2lkIFNGQjIxLzEyIGJpdHJhdGUgYmxvYXQgcmggMDYxMTE1XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGlmIChpbnB1dF9zYW1wbGVmcmVxID4gNDQxMDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gNDgwMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+IDMyMDAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDQ0MTAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlucHV0X3NhbXBsZWZyZXEgPiAyNDAwMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAzMjAwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbnB1dF9zYW1wbGVmcmVxID4gMjIwNTApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMjQwMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+IDE2MDAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDIyMDUwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGlucHV0X3NhbXBsZWZyZXEgPiAxMjAwMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiAxNjAwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbnB1dF9zYW1wbGVmcmVxID4gMTEwMjUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTIwMDA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW5wdXRfc2FtcGxlZnJlcSA+IDgwMDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMTEwMjU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gODAwMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3VnZ2VzdGVkX3NhbXBsZWZyZXE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogY29udmVydCBzYW1wIGZyZXEgaW4gSHogdG8gaW5kZXhcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBTbXBGcnFJbmRleChzYW1wbGVfZnJlcSwgZ3BmKSB7XG4gICAgICAgIHN3aXRjaCAoc2FtcGxlX2ZyZXEpIHtcbiAgICAgICAgICAgIGNhc2UgNDQxMDA6XG4gICAgICAgICAgICAgICAgZ3BmLnZlcnNpb24gPSAxO1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgY2FzZSA0ODAwMDpcbiAgICAgICAgICAgICAgICBncGYudmVyc2lvbiA9IDE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICBjYXNlIDMyMDAwOlxuICAgICAgICAgICAgICAgIGdwZi52ZXJzaW9uID0gMTtcbiAgICAgICAgICAgICAgICByZXR1cm4gMjtcbiAgICAgICAgICAgIGNhc2UgMjIwNTA6XG4gICAgICAgICAgICAgICAgZ3BmLnZlcnNpb24gPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgY2FzZSAyNDAwMDpcbiAgICAgICAgICAgICAgICBncGYudmVyc2lvbiA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICBjYXNlIDE2MDAwOlxuICAgICAgICAgICAgICAgIGdwZi52ZXJzaW9uID0gMDtcbiAgICAgICAgICAgICAgICByZXR1cm4gMjtcbiAgICAgICAgICAgIGNhc2UgMTEwMjU6XG4gICAgICAgICAgICAgICAgZ3BmLnZlcnNpb24gPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgY2FzZSAxMjAwMDpcbiAgICAgICAgICAgICAgICBncGYudmVyc2lvbiA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICBjYXNlIDgwMDA6XG4gICAgICAgICAgICAgICAgZ3BmLnZlcnNpb24gPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybiAyO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBncGYudmVyc2lvbiA9IDA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIGJSYXRlXG4gICAgICogICAgICAgICAgICBsZWdhbCByYXRlcyBmcm9tIDggdG8gMzIwXG4gICAgICovXG4gICAgZnVuY3Rpb24gRmluZE5lYXJlc3RCaXRyYXRlKGJSYXRlLCB2ZXJzaW9uLCBzYW1wbGVyYXRlKSB7XG4gICAgICAgIC8qIE1QRUctMSBvciBNUEVHLTIgTFNGICovXG4gICAgICAgIGlmIChzYW1wbGVyYXRlIDwgMTYwMDApXG4gICAgICAgICAgICB2ZXJzaW9uID0gMjtcblxuICAgICAgICB2YXIgYml0cmF0ZSA9IFRhYmxlcy5iaXRyYXRlX3RhYmxlW3ZlcnNpb25dWzFdO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAyOyBpIDw9IDE0OyBpKyspIHtcbiAgICAgICAgICAgIGlmIChUYWJsZXMuYml0cmF0ZV90YWJsZVt2ZXJzaW9uXVtpXSA+IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoVGFibGVzLmJpdHJhdGVfdGFibGVbdmVyc2lvbl1baV0gLSBiUmF0ZSkgPCBNYXRoXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWJzKGJpdHJhdGUgLSBiUmF0ZSkpXG4gICAgICAgICAgICAgICAgICAgIGJpdHJhdGUgPSBUYWJsZXMuYml0cmF0ZV90YWJsZVt2ZXJzaW9uXVtpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYml0cmF0ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gYlJhdGVcbiAgICAgKiAgICAgICAgICAgIGxlZ2FsIHJhdGVzIGZyb20gMzIgdG8gNDQ4IGticHNcbiAgICAgKiBAcGFyYW0gdmVyc2lvblxuICAgICAqICAgICAgICAgICAgTVBFRy0xIG9yIE1QRUctMi8yLjUgTFNGXG4gICAgICovXG4gICAgZnVuY3Rpb24gQml0cmF0ZUluZGV4KGJSYXRlLCB2ZXJzaW9uLCBzYW1wbGVyYXRlKSB7XG4gICAgICAgIC8qIGNvbnZlcnQgYml0cmF0ZSBpbiBrYnBzIHRvIGluZGV4ICovXG4gICAgICAgIGlmIChzYW1wbGVyYXRlIDwgMTYwMDApXG4gICAgICAgICAgICB2ZXJzaW9uID0gMjtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPD0gMTQ7IGkrKykge1xuICAgICAgICAgICAgaWYgKFRhYmxlcy5iaXRyYXRlX3RhYmxlW3ZlcnNpb25dW2ldID4gMCkge1xuICAgICAgICAgICAgICAgIGlmIChUYWJsZXMuYml0cmF0ZV90YWJsZVt2ZXJzaW9uXVtpXSA9PSBiUmF0ZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIG9wdGltdW1fYmFuZHdpZHRoKGxoLCBiaXRyYXRlKSB7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiA8UFJFPlxuICAgICAgICAgKiAgSW5wdXQ6XG4gICAgICAgICAqICAgICAgYml0cmF0ZSAgICAgdG90YWwgYml0cmF0ZSBpbiBrYnBzXG4gICAgICAgICAqXG4gICAgICAgICAqICAgT3V0cHV0OlxuICAgICAgICAgKiAgICAgIGxvd2VybGltaXQ6IGJlc3QgbG93cGFzcyBmcmVxdWVuY3kgbGltaXQgZm9yIGlucHV0IGZpbHRlciBpbiBIelxuICAgICAgICAgKiAgICAgIHVwcGVybGltaXQ6IGJlc3QgaGlnaHBhc3MgZnJlcXVlbmN5IGxpbWl0IGZvciBpbnB1dCBmaWx0ZXIgaW4gSHpcbiAgICAgICAgICogPC9QUkU+XG4gICAgICAgICAqL1xuICAgICAgICB2YXIgZnJlcV9tYXAgPSBbbmV3IEJhbmRQYXNzKDgsIDIwMDApLFxuICAgICAgICAgICAgbmV3IEJhbmRQYXNzKDE2LCAzNzAwKSwgbmV3IEJhbmRQYXNzKDI0LCAzOTAwKSxcbiAgICAgICAgICAgIG5ldyBCYW5kUGFzcygzMiwgNTUwMCksIG5ldyBCYW5kUGFzcyg0MCwgNzAwMCksXG4gICAgICAgICAgICBuZXcgQmFuZFBhc3MoNDgsIDc1MDApLCBuZXcgQmFuZFBhc3MoNTYsIDEwMDAwKSxcbiAgICAgICAgICAgIG5ldyBCYW5kUGFzcyg2NCwgMTEwMDApLCBuZXcgQmFuZFBhc3MoODAsIDEzNTAwKSxcbiAgICAgICAgICAgIG5ldyBCYW5kUGFzcyg5NiwgMTUxMDApLCBuZXcgQmFuZFBhc3MoMTEyLCAxNTYwMCksXG4gICAgICAgICAgICBuZXcgQmFuZFBhc3MoMTI4LCAxNzAwMCksIG5ldyBCYW5kUGFzcygxNjAsIDE3NTAwKSxcbiAgICAgICAgICAgIG5ldyBCYW5kUGFzcygxOTIsIDE4NjAwKSwgbmV3IEJhbmRQYXNzKDIyNCwgMTk0MDApLFxuICAgICAgICAgICAgbmV3IEJhbmRQYXNzKDI1NiwgMTk3MDApLCBuZXcgQmFuZFBhc3MoMzIwLCAyMDUwMCldO1xuXG4gICAgICAgIHZhciB0YWJsZV9pbmRleCA9IHNlbGYubmVhcmVzdEJpdHJhdGVGdWxsSW5kZXgoYml0cmF0ZSk7XG4gICAgICAgIGxoLmxvd2VybGltaXQgPSBmcmVxX21hcFt0YWJsZV9pbmRleF0ubG93cGFzcztcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsYW1lX2luaXRfcGFyYW1zX3BwZmx0KGdmcCkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICAvKiBjb21wdXRlIGluZm8gbmVlZGVkIGZvciBwb2x5cGhhc2UgZmlsdGVyIChmaWx0ZXIgdHlwZT09MCwgZGVmYXVsdCkgKi9cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAgICAgICB2YXIgbG93cGFzc19iYW5kID0gMzI7XG4gICAgICAgIHZhciBoaWdocGFzc19iYW5kID0gLTE7XG5cbiAgICAgICAgaWYgKGdmYy5sb3dwYXNzMSA+IDApIHtcbiAgICAgICAgICAgIHZhciBtaW5iYW5kID0gOTk5O1xuICAgICAgICAgICAgZm9yICh2YXIgYmFuZCA9IDA7IGJhbmQgPD0gMzE7IGJhbmQrKykge1xuICAgICAgICAgICAgICAgIHZhciBmcmVxID0gKGJhbmQgLyAzMS4wKTtcbiAgICAgICAgICAgICAgICAvKiB0aGlzIGJhbmQgYW5kIGFib3ZlIHdpbGwgYmUgemVyb2VkOiAqL1xuICAgICAgICAgICAgICAgIGlmIChmcmVxID49IGdmYy5sb3dwYXNzMikge1xuICAgICAgICAgICAgICAgICAgICBsb3dwYXNzX2JhbmQgPSBNYXRoLm1pbihsb3dwYXNzX2JhbmQsIGJhbmQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLmxvd3Bhc3MxIDwgZnJlcSAmJiBmcmVxIDwgZ2ZjLmxvd3Bhc3MyKSB7XG4gICAgICAgICAgICAgICAgICAgIG1pbmJhbmQgPSBNYXRoLm1pbihtaW5iYW5kLCBiYW5kKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBjb21wdXRlIHRoZSAqYWN0dWFsKiB0cmFuc2l0aW9uIGJhbmQgaW1wbGVtZW50ZWQgYnkgdGhlIHBvbHlwaGFzZVxuICAgICAgICAgICAgICogZmlsdGVyXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGlmIChtaW5iYW5kID09IDk5OSkge1xuICAgICAgICAgICAgICAgIGdmYy5sb3dwYXNzMSA9IChsb3dwYXNzX2JhbmQgLSAuNzUpIC8gMzEuMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZ2ZjLmxvd3Bhc3MxID0gKG1pbmJhbmQgLSAuNzUpIC8gMzEuMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy5sb3dwYXNzMiA9IGxvd3Bhc3NfYmFuZCAvIDMxLjA7XG4gICAgICAgIH1cblxuICAgICAgICAvKlxuICAgICAgICAgKiBtYWtlIHN1cmUgaGlnaHBhc3MgZmlsdGVyIGlzIHdpdGhpbiA5MCUgb2Ygd2hhdCB0aGUgZWZmZWN0aXZlXG4gICAgICAgICAqIGhpZ2hwYXNzIGZyZXF1ZW5jeSB3aWxsIGJlXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoZ2ZjLmhpZ2hwYXNzMiA+IDApIHtcbiAgICAgICAgICAgIGlmIChnZmMuaGlnaHBhc3MyIDwgLjkgKiAoLjc1IC8gMzEuMCkpIHtcbiAgICAgICAgICAgICAgICBnZmMuaGlnaHBhc3MxID0gMDtcbiAgICAgICAgICAgICAgICBnZmMuaGlnaHBhc3MyID0gMDtcbiAgICAgICAgICAgICAgICBTeXN0ZW0uZXJyLnByaW50bG4oXCJXYXJuaW5nOiBoaWdocGFzcyBmaWx0ZXIgZGlzYWJsZWQuICBcIlxuICAgICAgICAgICAgICAgICAgICArIFwiaGlnaHBhc3MgZnJlcXVlbmN5IHRvbyBzbWFsbFxcblwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChnZmMuaGlnaHBhc3MyID4gMCkge1xuICAgICAgICAgICAgdmFyIG1heGJhbmQgPSAtMTtcbiAgICAgICAgICAgIGZvciAodmFyIGJhbmQgPSAwOyBiYW5kIDw9IDMxOyBiYW5kKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgZnJlcSA9IGJhbmQgLyAzMS4wO1xuICAgICAgICAgICAgICAgIC8qIHRoaXMgYmFuZCBhbmQgYmVsb3cgd2lsbCBiZSB6ZXJlb2QgKi9cbiAgICAgICAgICAgICAgICBpZiAoZnJlcSA8PSBnZmMuaGlnaHBhc3MxKSB7XG4gICAgICAgICAgICAgICAgICAgIGhpZ2hwYXNzX2JhbmQgPSBNYXRoLm1heChoaWdocGFzc19iYW5kLCBiYW5kKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5oaWdocGFzczEgPCBmcmVxICYmIGZyZXEgPCBnZmMuaGlnaHBhc3MyKSB7XG4gICAgICAgICAgICAgICAgICAgIG1heGJhbmQgPSBNYXRoLm1heChtYXhiYW5kLCBiYW5kKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogY29tcHV0ZSB0aGUgKmFjdHVhbCogdHJhbnNpdGlvbiBiYW5kIGltcGxlbWVudGVkIGJ5IHRoZSBwb2x5cGhhc2VcbiAgICAgICAgICAgICAqIGZpbHRlclxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBnZmMuaGlnaHBhc3MxID0gaGlnaHBhc3NfYmFuZCAvIDMxLjA7XG4gICAgICAgICAgICBpZiAobWF4YmFuZCA9PSAtMSkge1xuICAgICAgICAgICAgICAgIGdmYy5oaWdocGFzczIgPSAoaGlnaHBhc3NfYmFuZCArIC43NSkgLyAzMS4wO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBnZmMuaGlnaHBhc3MyID0gKG1heGJhbmQgKyAuNzUpIC8gMzEuMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAodmFyIGJhbmQgPSAwOyBiYW5kIDwgMzI7IGJhbmQrKykge1xuICAgICAgICAgICAgdmFyIGZjMSwgZmMyO1xuICAgICAgICAgICAgdmFyIGZyZXEgPSBiYW5kIC8gMzEuMDtcbiAgICAgICAgICAgIGlmIChnZmMuaGlnaHBhc3MyID4gZ2ZjLmhpZ2hwYXNzMSkge1xuICAgICAgICAgICAgICAgIGZjMSA9IGZpbHRlcl9jb2VmKChnZmMuaGlnaHBhc3MyIC0gZnJlcSlcbiAgICAgICAgICAgICAgICAgICAgLyAoZ2ZjLmhpZ2hwYXNzMiAtIGdmYy5oaWdocGFzczEgKyAxZS0yMCkpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBmYzEgPSAxLjA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ2ZjLmxvd3Bhc3MyID4gZ2ZjLmxvd3Bhc3MxKSB7XG4gICAgICAgICAgICAgICAgZmMyID0gZmlsdGVyX2NvZWYoKGZyZXEgLSBnZmMubG93cGFzczEpXG4gICAgICAgICAgICAgICAgICAgIC8gKGdmYy5sb3dwYXNzMiAtIGdmYy5sb3dwYXNzMSArIDFlLTIwKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZjMiA9IDEuMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmYy5hbXBfZmlsdGVyW2JhbmRdID0gKGZjMSAqIGZjMik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsYW1lX2luaXRfcXZhbChnZnApIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcblxuICAgICAgICBzd2l0Y2ggKGdmcC5xdWFsaXR5KSB7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgY2FzZSA5OiAvKiBubyBwc3ltb2RlbCwgbm8gbm9pc2Ugc2hhcGluZyAqL1xuICAgICAgICAgICAgICAgIGdmYy5wc3ltb2RlbCA9IDA7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmcgPSAwO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX2FtcCA9IDA7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfc3RvcCA9IDA7XG4gICAgICAgICAgICAgICAgZ2ZjLnVzZV9iZXN0X2h1ZmZtYW4gPSAwO1xuICAgICAgICAgICAgICAgIGdmYy5mdWxsX291dGVyX2xvb3AgPSAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDg6XG4gICAgICAgICAgICAgICAgZ2ZwLnF1YWxpdHkgPSA3O1xuICAgICAgICAgICAgLy8kRkFMTC1USFJPVUdIJFxuICAgICAgICAgICAgY2FzZSA3OlxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogdXNlIHBzeW1vZGVsIChmb3Igc2hvcnQgYmxvY2sgYW5kIG0vcyBzd2l0Y2hpbmcpLCBidXQgbm8gbm9pc2VcbiAgICAgICAgICAgICAgICAgKiBzaGFwcGluZ1xuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGdmYy5wc3ltb2RlbCA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmcgPSAwO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX2FtcCA9IDA7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfc3RvcCA9IDA7XG4gICAgICAgICAgICAgICAgZ2ZjLnVzZV9iZXN0X2h1ZmZtYW4gPSAwO1xuICAgICAgICAgICAgICAgIGdmYy5mdWxsX291dGVyX2xvb3AgPSAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDY6XG4gICAgICAgICAgICAgICAgZ2ZjLnBzeW1vZGVsID0gMTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLm5vaXNlX3NoYXBpbmcgPT0gMClcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmcgPSAxO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX2FtcCA9IDA7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfc3RvcCA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5zdWJibG9ja19nYWluID09IC0xKVxuICAgICAgICAgICAgICAgICAgICBnZmMuc3ViYmxvY2tfZ2FpbiA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLnVzZV9iZXN0X2h1ZmZtYW4gPSAwO1xuICAgICAgICAgICAgICAgIGdmYy5mdWxsX291dGVyX2xvb3AgPSAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgICAgICAgZ2ZjLnBzeW1vZGVsID0gMTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLm5vaXNlX3NoYXBpbmcgPT0gMClcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmcgPSAxO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX2FtcCA9IDA7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfc3RvcCA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5zdWJibG9ja19nYWluID09IC0xKVxuICAgICAgICAgICAgICAgICAgICBnZmMuc3ViYmxvY2tfZ2FpbiA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLnVzZV9iZXN0X2h1ZmZtYW4gPSAwO1xuICAgICAgICAgICAgICAgIGdmYy5mdWxsX291dGVyX2xvb3AgPSAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDQ6XG4gICAgICAgICAgICAgICAgZ2ZjLnBzeW1vZGVsID0gMTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLm5vaXNlX3NoYXBpbmcgPT0gMClcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmcgPSAxO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX2FtcCA9IDA7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfc3RvcCA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5zdWJibG9ja19nYWluID09IC0xKVxuICAgICAgICAgICAgICAgICAgICBnZmMuc3ViYmxvY2tfZ2FpbiA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLnVzZV9iZXN0X2h1ZmZtYW4gPSAxO1xuICAgICAgICAgICAgICAgIGdmYy5mdWxsX291dGVyX2xvb3AgPSAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgZ2ZjLnBzeW1vZGVsID0gMTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLm5vaXNlX3NoYXBpbmcgPT0gMClcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmcgPSAxO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX2FtcCA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfc3RvcCA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5zdWJibG9ja19nYWluID09IC0xKVxuICAgICAgICAgICAgICAgICAgICBnZmMuc3ViYmxvY2tfZ2FpbiA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLnVzZV9iZXN0X2h1ZmZtYW4gPSAxO1xuICAgICAgICAgICAgICAgIGdmYy5mdWxsX291dGVyX2xvb3AgPSAwO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgICAgICAgZ2ZjLnBzeW1vZGVsID0gMTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLm5vaXNlX3NoYXBpbmcgPT0gMClcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmcgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuc3Vic3RlcF9zaGFwaW5nID09IDApXG4gICAgICAgICAgICAgICAgICAgIGdmYy5zdWJzdGVwX3NoYXBpbmcgPSAyO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX2FtcCA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLm5vaXNlX3NoYXBpbmdfc3RvcCA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5zdWJibG9ja19nYWluID09IC0xKVxuICAgICAgICAgICAgICAgICAgICBnZmMuc3ViYmxvY2tfZ2FpbiA9IDE7XG4gICAgICAgICAgICAgICAgZ2ZjLnVzZV9iZXN0X2h1ZmZtYW4gPSAxO1xuICAgICAgICAgICAgICAgIC8qIGlubmVyIGxvb3AgKi9cbiAgICAgICAgICAgICAgICBnZmMuZnVsbF9vdXRlcl9sb29wID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAxOlxuICAgICAgICAgICAgICAgIGdmYy5wc3ltb2RlbCA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5ub2lzZV9zaGFwaW5nID09IDApXG4gICAgICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nID0gMTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLnN1YnN0ZXBfc2hhcGluZyA9PSAwKVxuICAgICAgICAgICAgICAgICAgICBnZmMuc3Vic3RlcF9zaGFwaW5nID0gMjtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19hbXAgPSAyO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX3N0b3AgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuc3ViYmxvY2tfZ2FpbiA9PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnN1YmJsb2NrX2dhaW4gPSAxO1xuICAgICAgICAgICAgICAgIGdmYy51c2VfYmVzdF9odWZmbWFuID0gMTtcbiAgICAgICAgICAgICAgICBnZmMuZnVsbF9vdXRlcl9sb29wID0gMDtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgY2FzZSAwOlxuICAgICAgICAgICAgICAgIGdmYy5wc3ltb2RlbCA9IDE7XG4gICAgICAgICAgICAgICAgaWYgKGdmYy5ub2lzZV9zaGFwaW5nID09IDApXG4gICAgICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nID0gMTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLnN1YnN0ZXBfc2hhcGluZyA9PSAwKVxuICAgICAgICAgICAgICAgICAgICBnZmMuc3Vic3RlcF9zaGFwaW5nID0gMjtcbiAgICAgICAgICAgICAgICBnZmMubm9pc2Vfc2hhcGluZ19hbXAgPSAyO1xuICAgICAgICAgICAgICAgIGdmYy5ub2lzZV9zaGFwaW5nX3N0b3AgPSAxO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuc3ViYmxvY2tfZ2FpbiA9PSAtMSlcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnN1YmJsb2NrX2dhaW4gPSAxO1xuICAgICAgICAgICAgICAgIGdmYy51c2VfYmVzdF9odWZmbWFuID0gMTtcbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIHR5cGUgMiBkaXNhYmxlZCBiZWNhdXNlIG9mIGl0IHNsb3duZXNzLCBpbiBmYXZvciBvZiBmdWxsIG91dGVyXG4gICAgICAgICAgICAgICAgICogbG9vcCBzZWFyY2hcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBnZmMuZnVsbF9vdXRlcl9sb29wID0gMDtcbiAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAqIGZ1bGwgb3V0ZXIgbG9vcCBzZWFyY2ggZGlzYWJsZWQgYmVjYXVzZSBvZiBhdWRpYmxlIGRpc3RvcnRpb25zIGl0XG4gICAgICAgICAgICAgICAgICogbWF5IGdlbmVyYXRlIHJoIDA2MDYyOVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsYW1lX2luaXRfYml0c3RyZWFtKGdmcCkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICBnZnAuZnJhbWVOdW0gPSAwO1xuXG4gICAgICAgIGlmIChnZnAud3JpdGVfaWQzdGFnX2F1dG9tYXRpYykge1xuICAgICAgICAgICAgaWQzLmlkM3RhZ193cml0ZV92MihnZnApO1xuICAgICAgICB9XG4gICAgICAgIC8qIGluaXRpYWxpemUgaGlzdG9ncmFtIGRhdGEgb3B0aW9uYWxseSB1c2VkIGJ5IGZyb250ZW5kICovXG5cbiAgICAgICAgZ2ZjLmJpdHJhdGVfc3RlcmVvTW9kZV9IaXN0ID0gbmV3X2ludF9uKFsxNiwgNCArIDFdKTtcbiAgICAgICAgZ2ZjLmJpdHJhdGVfYmxvY2tUeXBlX0hpc3QgPSBuZXdfaW50X24oWzE2LCA0ICsgMSArIDFdKTtcblxuICAgICAgICBnZmMuUGVha1NhbXBsZSA9IDAuMDtcblxuICAgICAgICAvKiBXcml0ZSBpbml0aWFsIFZCUiBIZWFkZXIgdG8gYml0c3RyZWFtIGFuZCBpbml0IFZCUiBkYXRhICovXG4gICAgICAgIGlmIChnZnAuYldyaXRlVmJyVGFnKVxuICAgICAgICAgICAgdmJyLkluaXRWYnJUYWcoZ2ZwKTtcbiAgICB9XG5cbiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICAgKiBpbml0aWFsaXplIGludGVybmFsIHBhcmFtcyBiYXNlZCBvbiBkYXRhIGluIGdmIChnbG9iYWxmbGFncyBzdHJ1Y3QgZmlsbGVkXG4gICAgICogaW4gYnkgY2FsbGluZyBwcm9ncmFtKVxuICAgICAqXG4gICAgICogT1VUTElORTpcbiAgICAgKlxuICAgICAqIFdlIGZpcnN0IGhhdmUgc29tZSBjb21wbGV4IGNvZGUgdG8gZGV0ZXJtaW5lIGJpdHJhdGUsIG91dHB1dCBzYW1wbGVyYXRlXG4gICAgICogYW5kIG1vZGUuIEl0IGlzIGNvbXBsaWNhdGVkIGJ5IHRoZSBmYWN0IHRoYXQgd2UgYWxsb3cgdGhlIHVzZXIgdG8gc2V0XG4gICAgICogc29tZSBvciBhbGwgb2YgdGhlc2UgcGFyYW1ldGVycywgYW5kIG5lZWQgdG8gZGV0ZXJtaW5lIGJlc3QgcG9zc2libGVcbiAgICAgKiB2YWx1ZXMgZm9yIHRoZSByZXN0IG9mIHRoZW06XG4gICAgICpcbiAgICAgKiAxLiBzZXQgc29tZSBDUFUgcmVsYXRlZCBmbGFncyAyLiBjaGVjayBpZiB3ZSBhcmUgbW9uby5tb25vLCBzdGVyZW8ubW9ub1xuICAgICAqIG9yIHN0ZXJlby5zdGVyZW8gMy4gY29tcHV0ZSBiaXRyYXRlIGFuZCBvdXRwdXQgc2FtcGxlcmF0ZTogdXNlciBtYXkgaGF2ZVxuICAgICAqIHNldCBjb21wcmVzc2lvbiByYXRpbyB1c2VyIG1heSBoYXZlIHNldCBhIGJpdHJhdGUgdXNlciBtYXkgaGF2ZSBzZXQgYVxuICAgICAqIG91dHB1dCBzYW1wbGVyYXRlIDQuIHNldCBzb21lIG9wdGlvbnMgd2hpY2ggZGVwZW5kIG9uIG91dHB1dCBzYW1wbGVyYXRlXG4gICAgICogNS4gY29tcHV0ZSB0aGUgYWN0dWFsIGNvbXByZXNzaW9uIHJhdGlvIDYuIHNldCBtb2RlIGJhc2VkIG9uIGNvbXByZXNzaW9uXG4gICAgICogcmF0aW9cbiAgICAgKlxuICAgICAqIFRoZSByZW1haW5pbmcgY29kZSBpcyBtdWNoIHNpbXBsZXIgLSBpdCBqdXN0IHNldHMgb3B0aW9ucyBiYXNlZCBvbiB0aGVcbiAgICAgKiBtb2RlICYgY29tcHJlc3Npb24gcmF0aW86XG4gICAgICpcbiAgICAgKiBzZXQgYWxsb3dfZGlmZl9zaG9ydCBiYXNlZCBvbiBtb2RlIHNlbGVjdCBsb3dwYXNzIGZpbHRlciBiYXNlZCBvblxuICAgICAqIGNvbXByZXNzaW9uIHJhdGlvICYgbW9kZSBzZXQgdGhlIGJpdHJhdGUgaW5kZXgsIGFuZCBtaW4vbWF4IGJpdHJhdGVzIGZvclxuICAgICAqIFZCUiBtb2RlcyBkaXNhYmxlIFZCUiB0YWcgaWYgaXQgaXMgbm90IGFwcHJvcHJpYXRlIGluaXRpYWxpemUgdGhlXG4gICAgICogYml0c3RyZWFtIGluaXRpYWxpemUgc2NhbGVmYWNfYmFuZCBkYXRhIHNldCBzaWRlaW5mb19sZW4gKGJhc2VkIG9uXG4gICAgICogY2hhbm5lbHMsIENSQywgb3V0X3NhbXBsZXJhdGUpIHdyaXRlIGFuIGlkM3YyIHRhZyBpbnRvIHRoZSBiaXRzdHJlYW1cbiAgICAgKiB3cml0ZSBWQlIgdGFnIGludG8gdGhlIGJpdHN0cmVhbSBzZXQgbXBlZzEvMiBmbGFnIGVzdGltYXRlIHRoZSBudW1iZXIgb2ZcbiAgICAgKiBmcmFtZXMgKGJhc2VkIG9uIGEgbG90IG9mIGRhdGEpXG4gICAgICpcbiAgICAgKiBub3cgd2Ugc2V0IG1vcmUgZmxhZ3M6IG5zcHN5dHVuZTogc2VlIGNvZGUgVkJSIG1vZGVzIHNlZSBjb2RlIENCUi9BQlIgc2VlXG4gICAgICogY29kZVxuICAgICAqXG4gICAgICogRmluYWxseSwgd2Ugc2V0IHRoZSBhbGdvcml0aG0gZmxhZ3MgYmFzZWQgb24gdGhlIGdmcC5xdWFsaXR5IHZhbHVlXG4gICAgICogbGFtZV9pbml0X3F2YWwoZ2ZwKTtcbiAgICAgKlxuICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICB0aGlzLmxhbWVfaW5pdF9wYXJhbXMgPSBmdW5jdGlvbiAoZ2ZwKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cbiAgICAgICAgZ2ZjLkNsYXNzX0lEID0gMDtcbiAgICAgICAgaWYgKGdmYy5BVEggPT0gbnVsbClcbiAgICAgICAgICAgIGdmYy5BVEggPSBuZXcgQVRIKCk7XG4gICAgICAgIGlmIChnZmMuUFNZID09IG51bGwpXG4gICAgICAgICAgICBnZmMuUFNZID0gbmV3IFBTWSgpO1xuICAgICAgICBpZiAoZ2ZjLnJnZGF0YSA9PSBudWxsKVxuICAgICAgICAgICAgZ2ZjLnJnZGF0YSA9IG5ldyBSZXBsYXlHYWluKCk7XG5cbiAgICAgICAgZ2ZjLmNoYW5uZWxzX2luID0gZ2ZwLm51bV9jaGFubmVscztcbiAgICAgICAgaWYgKGdmYy5jaGFubmVsc19pbiA9PSAxKVxuICAgICAgICAgICAgZ2ZwLm1vZGUgPSBNUEVHTW9kZS5NT05PO1xuICAgICAgICBnZmMuY2hhbm5lbHNfb3V0ID0gKGdmcC5tb2RlID09IE1QRUdNb2RlLk1PTk8pID8gMSA6IDI7XG4gICAgICAgIGdmYy5tb2RlX2V4dCA9IEVuY29kZXIuTVBHX01EX01TX0xSO1xuICAgICAgICBpZiAoZ2ZwLm1vZGUgPT0gTVBFR01vZGUuTU9OTylcbiAgICAgICAgICAgIGdmcC5mb3JjZV9tcyA9IGZhbHNlO1xuICAgICAgICAvKlxuICAgICAgICAgKiBkb24ndCBhbGxvdyBmb3JjZWQgbWlkL3NpZGUgc3RlcmVvIGZvciBtb25vIG91dHB1dFxuICAgICAgICAgKi9cblxuICAgICAgICBpZiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9vZmYgJiYgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyAhPSAxMjhcbiAgICAgICAgICAgICYmIGdmcC5icmF0ZSA9PSAwKVxuICAgICAgICAgICAgZ2ZwLmJyYXRlID0gZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcztcblxuICAgICAgICBpZiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9vZmYgfHwgZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9tdHJoXG4gICAgICAgICAgICB8fCBnZnAuVkJSID09IFZick1vZGUudmJyX210KSB7XG4gICAgICAgICAgICAvKiB0aGVzZSBtb2RlcyBjYW4gaGFuZGxlIGZyZWUgZm9ybWF0IGNvbmRpdGlvbiAqL1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ2ZwLmZyZWVfZm9ybWF0ID0gZmFsc2U7XG4gICAgICAgICAgICAvKiBtb2RlIGNhbid0IGJlIG1peGVkIHdpdGggZnJlZSBmb3JtYXQgKi9cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChnZnAuVkJSID09IFZick1vZGUudmJyX29mZiAmJiBnZnAuYnJhdGUgPT0gMCkge1xuICAgICAgICAgICAgLyogbm8gYml0cmF0ZSBvciBjb21wcmVzc2lvbiByYXRpbyBzcGVjaWZpZWQsIHVzZSAxMS4wMjUgKi9cbiAgICAgICAgICAgIGlmIChCaXRTdHJlYW0uRVEoZ2ZwLmNvbXByZXNzaW9uX3JhdGlvLCAwKSlcbiAgICAgICAgICAgICAgICBnZnAuY29tcHJlc3Npb25fcmF0aW8gPSAxMS4wMjU7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogcmF0ZSB0byBjb21wcmVzcyBhIENEIGRvd24gdG8gZXhhY3RseSAxMjgwMDAgYnBzXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGZpbmQgYml0cmF0ZSBpZiB1c2VyIHNwZWNpZnkgYSBjb21wcmVzc2lvbiByYXRpbyAqL1xuICAgICAgICBpZiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9vZmYgJiYgZ2ZwLmNvbXByZXNzaW9uX3JhdGlvID4gMCkge1xuXG4gICAgICAgICAgICBpZiAoZ2ZwLm91dF9zYW1wbGVyYXRlID09IDApXG4gICAgICAgICAgICAgICAgZ2ZwLm91dF9zYW1wbGVyYXRlID0gbWFwMk1QM0ZyZXF1ZW5jeSgoaW50KSgwLjk3ICogZ2ZwLmluX3NhbXBsZXJhdGUpKTtcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiByb3VuZCB1cCB3aXRoIGEgbWFyZ2luIG9mIDMgJVxuICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBjaG9vc2UgYSBiaXRyYXRlIGZvciB0aGUgb3V0cHV0IHNhbXBsZXJhdGUgd2hpY2ggYWNoaWV2ZXNcbiAgICAgICAgICAgICAqIHNwZWNpZmllZCBjb21wcmVzc2lvbiByYXRpb1xuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBnZnAuYnJhdGUgPSAwIHwgKGdmcC5vdXRfc2FtcGxlcmF0ZSAqIDE2ICogZ2ZjLmNoYW5uZWxzX291dCAvICgxLmUzICogZ2ZwLmNvbXByZXNzaW9uX3JhdGlvKSk7XG5cbiAgICAgICAgICAgIC8qIHdlIG5lZWQgdGhlIHZlcnNpb24gZm9yIHRoZSBiaXRyYXRlIHRhYmxlIGxvb2sgdXAgKi9cbiAgICAgICAgICAgIGdmYy5zYW1wbGVyYXRlX2luZGV4ID0gU21wRnJxSW5kZXgoZ2ZwLm91dF9zYW1wbGVyYXRlLCBnZnApO1xuXG4gICAgICAgICAgICBpZiAoIWdmcC5mcmVlX2Zvcm1hdCkgLypcbiAgICAgICAgICAgICAqIGZvciBub24gRnJlZSBGb3JtYXQgZmluZCB0aGUgbmVhcmVzdCBhbGxvd2VkXG4gICAgICAgICAgICAgKiBiaXRyYXRlXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBnZnAuYnJhdGUgPSBGaW5kTmVhcmVzdEJpdHJhdGUoZ2ZwLmJyYXRlLCBnZnAudmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLm91dF9zYW1wbGVyYXRlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChnZnAub3V0X3NhbXBsZXJhdGUgIT0gMCkge1xuICAgICAgICAgICAgaWYgKGdmcC5vdXRfc2FtcGxlcmF0ZSA8IDE2MDAwKSB7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyA9IE1hdGgubWF4KGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMsXG4gICAgICAgICAgICAgICAgICAgIDgpO1xuICAgICAgICAgICAgICAgIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMgPSBNYXRoLm1pbihnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzLFxuICAgICAgICAgICAgICAgICAgICA2NCk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGdmcC5vdXRfc2FtcGxlcmF0ZSA8IDMyMDAwKSB7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyA9IE1hdGgubWF4KGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMsXG4gICAgICAgICAgICAgICAgICAgIDgpO1xuICAgICAgICAgICAgICAgIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMgPSBNYXRoLm1pbihnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzLFxuICAgICAgICAgICAgICAgICAgICAxNjApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzID0gTWF0aC5tYXgoZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2JwcyxcbiAgICAgICAgICAgICAgICAgICAgMzIpO1xuICAgICAgICAgICAgICAgIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMgPSBNYXRoLm1pbihnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzLFxuICAgICAgICAgICAgICAgICAgICAzMjApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIC8qIGlmIGEgZmlsdGVyIGhhcyBub3QgYmVlbiBlbmFibGVkLCBzZWUgaWYgd2Ugc2hvdWxkIGFkZCBvbmU6ICovXG4gICAgICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICBpZiAoZ2ZwLmxvd3Bhc3NmcmVxID09IDApIHtcbiAgICAgICAgICAgIHZhciBsb3dwYXNzID0gMTYwMDAuO1xuXG4gICAgICAgICAgICBzd2l0Y2ggKGdmcC5WQlIpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFZick1vZGUudmJyX29mZjpcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsaCA9IG5ldyBMb3dQYXNzSGlnaFBhc3MoKTtcbiAgICAgICAgICAgICAgICAgICAgb3B0aW11bV9iYW5kd2lkdGgobGgsIGdmcC5icmF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIGxvd3Bhc3MgPSBsaC5sb3dlcmxpbWl0O1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2FzZSBWYnJNb2RlLnZicl9hYnI6XG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGggPSBuZXcgTG93UGFzc0hpZ2hQYXNzKCk7XG4gICAgICAgICAgICAgICAgICAgIG9wdGltdW1fYmFuZHdpZHRoKGxoLCBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzKTtcbiAgICAgICAgICAgICAgICAgICAgbG93cGFzcyA9IGxoLmxvd2VybGltaXQ7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXNlIFZick1vZGUudmJyX3JoOlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBbMTk1MDAsIDE5MDAwLCAxODYwMCwgMTgwMDAsIDE3NTAwLCAxNjAwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIDE1NjAwLCAxNDkwMCwgMTI1MDAsIDEwMDAwLCAzOTUwXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKDAgPD0gZ2ZwLlZCUl9xICYmIGdmcC5WQlJfcSA8PSA5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IHhbZ2ZwLlZCUl9xXSwgYiA9IHhbZ2ZwLlZCUl9xICsgMV0sIG0gPSBnZnAuVkJSX3FfZnJhYztcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvd3Bhc3MgPSBsaW5lYXJfaW50KGEsIGIsIG0pO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG93cGFzcyA9IDE5NTAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHggPSBbMTk1MDAsIDE5MDAwLCAxODUwMCwgMTgwMDAsIDE3NTAwLCAxNjUwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgIDE1NTAwLCAxNDUwMCwgMTI1MDAsIDk1MDAsIDM5NTBdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoMCA8PSBnZnAuVkJSX3EgJiYgZ2ZwLlZCUl9xIDw9IDkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0geFtnZnAuVkJSX3FdLCBiID0geFtnZnAuVkJSX3EgKyAxXSwgbSA9IGdmcC5WQlJfcV9mcmFjO1xuICAgICAgICAgICAgICAgICAgICAgICAgbG93cGFzcyA9IGxpbmVhcl9pbnQoYSwgYiwgbSk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb3dwYXNzID0gMTk1MDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZ2ZwLm1vZGUgPT0gTVBFR01vZGUuTU9OT1xuICAgICAgICAgICAgICAgICYmIChnZnAuVkJSID09IFZick1vZGUudmJyX29mZiB8fCBnZnAuVkJSID09IFZick1vZGUudmJyX2FicikpXG4gICAgICAgICAgICAgICAgbG93cGFzcyAqPSAxLjU7XG5cbiAgICAgICAgICAgIGdmcC5sb3dwYXNzZnJlcSA9IGxvd3Bhc3MgfCAwO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGdmcC5vdXRfc2FtcGxlcmF0ZSA9PSAwKSB7XG4gICAgICAgICAgICBpZiAoMiAqIGdmcC5sb3dwYXNzZnJlcSA+IGdmcC5pbl9zYW1wbGVyYXRlKSB7XG4gICAgICAgICAgICAgICAgZ2ZwLmxvd3Bhc3NmcmVxID0gZ2ZwLmluX3NhbXBsZXJhdGUgLyAyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZwLm91dF9zYW1wbGVyYXRlID0gb3B0aW11bV9zYW1wbGVmcmVxKGdmcC5sb3dwYXNzZnJlcSB8IDAsXG4gICAgICAgICAgICAgICAgZ2ZwLmluX3NhbXBsZXJhdGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgZ2ZwLmxvd3Bhc3NmcmVxID0gTWF0aC5taW4oMjA1MDAsIGdmcC5sb3dwYXNzZnJlcSk7XG4gICAgICAgIGdmcC5sb3dwYXNzZnJlcSA9IE1hdGgubWluKGdmcC5vdXRfc2FtcGxlcmF0ZSAvIDIsIGdmcC5sb3dwYXNzZnJlcSk7XG5cbiAgICAgICAgaWYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfb2ZmKSB7XG4gICAgICAgICAgICBnZnAuY29tcHJlc3Npb25fcmF0aW8gPSBnZnAub3V0X3NhbXBsZXJhdGUgKiAxNiAqIGdmYy5jaGFubmVsc19vdXRcbiAgICAgICAgICAgICAgICAvICgxLmUzICogZ2ZwLmJyYXRlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZ2ZwLlZCUiA9PSBWYnJNb2RlLnZicl9hYnIpIHtcbiAgICAgICAgICAgIGdmcC5jb21wcmVzc2lvbl9yYXRpbyA9IGdmcC5vdXRfc2FtcGxlcmF0ZSAqIDE2ICogZ2ZjLmNoYW5uZWxzX291dFxuICAgICAgICAgICAgICAgIC8gKDEuZTMgKiBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGRvIG5vdCBjb21wdXRlIFJlcGxheUdhaW4gdmFsdWVzIGFuZCBkbyBub3QgZmluZCB0aGUgcGVhayBzYW1wbGUgaWZcbiAgICAgICAgICogd2UgY2FuJ3Qgc3RvcmUgdGhlbVxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKCFnZnAuYldyaXRlVmJyVGFnKSB7XG4gICAgICAgICAgICBnZnAuZmluZFJlcGxheUdhaW4gPSBmYWxzZTtcbiAgICAgICAgICAgIGdmcC5kZWNvZGVfb25fdGhlX2ZseSA9IGZhbHNlO1xuICAgICAgICAgICAgZ2ZjLmZpbmRQZWFrU2FtcGxlID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZ2ZjLmZpbmRSZXBsYXlHYWluID0gZ2ZwLmZpbmRSZXBsYXlHYWluO1xuICAgICAgICBnZmMuZGVjb2RlX29uX3RoZV9mbHkgPSBnZnAuZGVjb2RlX29uX3RoZV9mbHk7XG5cbiAgICAgICAgaWYgKGdmYy5kZWNvZGVfb25fdGhlX2ZseSlcbiAgICAgICAgICAgIGdmYy5maW5kUGVha1NhbXBsZSA9IHRydWU7XG5cbiAgICAgICAgaWYgKGdmYy5maW5kUmVwbGF5R2Fpbikge1xuICAgICAgICAgICAgaWYgKGdhLkluaXRHYWluQW5hbHlzaXMoZ2ZjLnJnZGF0YSwgZ2ZwLm91dF9zYW1wbGVyYXRlKSA9PSBHYWluQW5hbHlzaXMuSU5JVF9HQUlOX0FOQUxZU0lTX0VSUk9SKSB7XG4gICAgICAgICAgICAgICAgZ2ZwLmludGVybmFsX2ZsYWdzID0gbnVsbDtcbiAgICAgICAgICAgICAgICByZXR1cm4gLTY7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ2ZjLmRlY29kZV9vbl90aGVfZmx5ICYmICFnZnAuZGVjb2RlX29ubHkpIHtcbiAgICAgICAgICAgIGlmIChnZmMuaGlwICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICBtcGdsaWIuaGlwX2RlY29kZV9leGl0KGdmYy5oaXApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLmhpcCA9IG1wZ2xpYi5oaXBfZGVjb2RlX2luaXQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGdmYy5tb2RlX2dyID0gZ2ZwLm91dF9zYW1wbGVyYXRlIDw9IDI0MDAwID8gMSA6IDI7XG4gICAgICAgIC8qXG4gICAgICAgICAqIE51bWJlciBvZiBncmFudWxlcyBwZXIgZnJhbWVcbiAgICAgICAgICovXG4gICAgICAgIGdmcC5mcmFtZXNpemUgPSA1NzYgKiBnZmMubW9kZV9ncjtcbiAgICAgICAgZ2ZwLmVuY29kZXJfZGVsYXkgPSBFbmNvZGVyLkVOQ0RFTEFZO1xuXG4gICAgICAgIGdmYy5yZXNhbXBsZV9yYXRpbyA9IGdmcC5pbl9zYW1wbGVyYXRlIC8gZ2ZwLm91dF9zYW1wbGVyYXRlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiA8UFJFPlxuICAgICAgICAgKiAgc2FtcGxlIGZyZXEgICAgICAgYml0cmF0ZSAgICAgY29tcHJlc3Npb24gcmF0aW9cbiAgICAgICAgICogICAgIFtrSHpdICAgICAgW2ticHMvY2hhbm5lbF0gICBmb3IgMTYgYml0IGlucHV0XG4gICAgICAgICAqICAgICA0NC4xICAgICAgICAgICAgNTYgICAgICAgICAgICAgICAxMi42XG4gICAgICAgICAqICAgICA0NC4xICAgICAgICAgICAgNjQgICAgICAgICAgICAgICAxMS4wMjVcbiAgICAgICAgICogICAgIDQ0LjEgICAgICAgICAgICA4MCAgICAgICAgICAgICAgICA4LjgyXG4gICAgICAgICAqICAgICAyMi4wNSAgICAgICAgICAgMjQgICAgICAgICAgICAgICAxNC43XG4gICAgICAgICAqICAgICAyMi4wNSAgICAgICAgICAgMzIgICAgICAgICAgICAgICAxMS4wMjVcbiAgICAgICAgICogICAgIDIyLjA1ICAgICAgICAgICA0MCAgICAgICAgICAgICAgICA4LjgyXG4gICAgICAgICAqICAgICAxNiAgICAgICAgICAgICAgMTYgICAgICAgICAgICAgICAxNi4wXG4gICAgICAgICAqICAgICAxNiAgICAgICAgICAgICAgMjQgICAgICAgICAgICAgICAxMC42NjdcbiAgICAgICAgICogPC9QUkU+XG4gICAgICAgICAqL1xuICAgICAgICAvKipcbiAgICAgICAgICogPFBSRT5cbiAgICAgICAgICogIEZvciBWQlIsIHRha2UgYSBndWVzcyBhdCB0aGUgY29tcHJlc3Npb25fcmF0aW8uXG4gICAgICAgICAqICBGb3IgZXhhbXBsZTpcbiAgICAgICAgICpcbiAgICAgICAgICogICAgVkJSX3EgICAgY29tcHJlc3Npb24gICAgIGxpa2VcbiAgICAgICAgICogICAgIC0gICAgICAgIDQuNCAgICAgICAgIDMyMCBrYnBzLzQ0IGtIelxuICAgICAgICAgKiAgIDAuLi4xICAgICAgNS41ICAgICAgICAgMjU2IGticHMvNDQga0h6XG4gICAgICAgICAqICAgICAyICAgICAgICA3LjMgICAgICAgICAxOTIga2Jwcy80NCBrSHpcbiAgICAgICAgICogICAgIDQgICAgICAgIDguOCAgICAgICAgIDE2MCBrYnBzLzQ0IGtIelxuICAgICAgICAgKiAgICAgNiAgICAgICAxMSAgICAgICAgICAgMTI4IGticHMvNDQga0h6XG4gICAgICAgICAqICAgICA5ICAgICAgIDE0LjcgICAgICAgICAgOTYga2Jwc1xuICAgICAgICAgKlxuICAgICAgICAgKiAgZm9yIGxvd2VyIGJpdHJhdGVzLCBkb3duc2FtcGxlIHdpdGggLS1yZXNhbXBsZVxuICAgICAgICAgKiA8L1BSRT5cbiAgICAgICAgICovXG4gICAgICAgIHN3aXRjaCAoZ2ZwLlZCUikge1xuICAgICAgICAgICAgY2FzZSBWYnJNb2RlLnZicl9tdDpcbiAgICAgICAgICAgIGNhc2UgVmJyTW9kZS52YnJfcmg6XG4gICAgICAgICAgICBjYXNlIFZick1vZGUudmJyX210cmg6XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgLyogbnVtYmVycyBhcmUgYSBiaXQgc3RyYW5nZSwgYnV0IHRoZXkgZGV0ZXJtaW5lIHRoZSBsb3dwYXNzIHZhbHVlICovXG4gICAgICAgICAgICAgICAgdmFyIGNtcCA9IFs1LjcsIDYuNSwgNy4zLCA4LjIsIDEwLCAxMS45LCAxMywgMTQsXG4gICAgICAgICAgICAgICAgICAgIDE1LCAxNi41XTtcbiAgICAgICAgICAgICAgICBnZnAuY29tcHJlc3Npb25fcmF0aW8gPSBjbXBbZ2ZwLlZCUl9xXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgVmJyTW9kZS52YnJfYWJyOlxuICAgICAgICAgICAgICAgIGdmcC5jb21wcmVzc2lvbl9yYXRpbyA9IGdmcC5vdXRfc2FtcGxlcmF0ZSAqIDE2ICogZ2ZjLmNoYW5uZWxzX291dFxuICAgICAgICAgICAgICAgICAgICAvICgxLmUzICogZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2Jwcyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGdmcC5jb21wcmVzc2lvbl9yYXRpbyA9IGdmcC5vdXRfc2FtcGxlcmF0ZSAqIDE2ICogZ2ZjLmNoYW5uZWxzX291dFxuICAgICAgICAgICAgICAgICAgICAvICgxLmUzICogZ2ZwLmJyYXRlKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qXG4gICAgICAgICAqIG1vZGUgPSAtMSAobm90IHNldCBieSB1c2VyKSBvciBtb2RlID0gTU9OTyAoYmVjYXVzZSBvZiBvbmx5IDEgaW5wdXRcbiAgICAgICAgICogY2hhbm5lbCkuIElmIG1vZGUgaGFzIG5vdCBiZWVuIHNldCwgdGhlbiBzZWxlY3QgSi1TVEVSRU9cbiAgICAgICAgICovXG4gICAgICAgIGlmIChnZnAubW9kZSA9PSBNUEVHTW9kZS5OT1RfU0VUKSB7XG4gICAgICAgICAgICBnZnAubW9kZSA9IE1QRUdNb2RlLkpPSU5UX1NURVJFTztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGFwcGx5IHVzZXIgZHJpdmVuIGhpZ2ggcGFzcyBmaWx0ZXIgKi9cbiAgICAgICAgaWYgKGdmcC5oaWdocGFzc2ZyZXEgPiAwKSB7XG4gICAgICAgICAgICBnZmMuaGlnaHBhc3MxID0gMi4gKiBnZnAuaGlnaHBhc3NmcmVxO1xuXG4gICAgICAgICAgICBpZiAoZ2ZwLmhpZ2hwYXNzd2lkdGggPj0gMClcbiAgICAgICAgICAgICAgICBnZmMuaGlnaHBhc3MyID0gMi4gKiAoZ2ZwLmhpZ2hwYXNzZnJlcSArIGdmcC5oaWdocGFzc3dpZHRoKTtcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIC8qIDAlIGFib3ZlIG9uIGRlZmF1bHQgKi9cbiAgICAgICAgICAgICAgICBnZmMuaGlnaHBhc3MyID0gKDEgKyAwLjAwKSAqIDIuICogZ2ZwLmhpZ2hwYXNzZnJlcTtcblxuICAgICAgICAgICAgZ2ZjLmhpZ2hwYXNzMSAvPSBnZnAub3V0X3NhbXBsZXJhdGU7XG4gICAgICAgICAgICBnZmMuaGlnaHBhc3MyIC89IGdmcC5vdXRfc2FtcGxlcmF0ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdmYy5oaWdocGFzczEgPSAwO1xuICAgICAgICAgICAgZ2ZjLmhpZ2hwYXNzMiA9IDA7XG4gICAgICAgIH1cbiAgICAgICAgLyogYXBwbHkgdXNlciBkcml2ZW4gbG93IHBhc3MgZmlsdGVyICovXG4gICAgICAgIGlmIChnZnAubG93cGFzc2ZyZXEgPiAwKSB7XG4gICAgICAgICAgICBnZmMubG93cGFzczIgPSAyLiAqIGdmcC5sb3dwYXNzZnJlcTtcbiAgICAgICAgICAgIGlmIChnZnAubG93cGFzc3dpZHRoID49IDApIHtcbiAgICAgICAgICAgICAgICBnZmMubG93cGFzczEgPSAyLiAqIChnZnAubG93cGFzc2ZyZXEgLSBnZnAubG93cGFzc3dpZHRoKTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLmxvd3Bhc3MxIDwgMCkgLyogaGFzIHRvIGJlID49IDAgKi9cbiAgICAgICAgICAgICAgICAgICAgZ2ZjLmxvd3Bhc3MxID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSB7IC8qIDAlIGJlbG93IG9uIGRlZmF1bHQgKi9cbiAgICAgICAgICAgICAgICBnZmMubG93cGFzczEgPSAoMSAtIDAuMDApICogMi4gKiBnZnAubG93cGFzc2ZyZXE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMubG93cGFzczEgLz0gZ2ZwLm91dF9zYW1wbGVyYXRlO1xuICAgICAgICAgICAgZ2ZjLmxvd3Bhc3MyIC89IGdmcC5vdXRfc2FtcGxlcmF0ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGdmYy5sb3dwYXNzMSA9IDA7XG4gICAgICAgICAgICBnZmMubG93cGFzczIgPSAwO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4gICAgICAgIC8qIGNvbXB1dGUgaW5mbyBuZWVkZWQgZm9yIHBvbHlwaGFzZSBmaWx0ZXIgKGZpbHRlciB0eXBlPT0wLCBkZWZhdWx0KSAqL1xuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbiAgICAgICAgbGFtZV9pbml0X3BhcmFtc19wcGZsdChnZnApO1xuICAgICAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICAgKiBzYW1wbGVyYXRlIGFuZCBiaXRyYXRlIGluZGV4XG4gICAgICAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqL1xuICAgICAgICBnZmMuc2FtcGxlcmF0ZV9pbmRleCA9IFNtcEZycUluZGV4KGdmcC5vdXRfc2FtcGxlcmF0ZSwgZ2ZwKTtcbiAgICAgICAgaWYgKGdmYy5zYW1wbGVyYXRlX2luZGV4IDwgMCkge1xuICAgICAgICAgICAgZ2ZwLmludGVybmFsX2ZsYWdzID0gbnVsbDtcbiAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChnZnAuVkJSID09IFZick1vZGUudmJyX29mZikge1xuICAgICAgICAgICAgaWYgKGdmcC5mcmVlX2Zvcm1hdCkge1xuICAgICAgICAgICAgICAgIGdmYy5iaXRyYXRlX2luZGV4ID0gMDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZ2ZwLmJyYXRlID0gRmluZE5lYXJlc3RCaXRyYXRlKGdmcC5icmF0ZSwgZ2ZwLnZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgIGdmcC5vdXRfc2FtcGxlcmF0ZSk7XG4gICAgICAgICAgICAgICAgZ2ZjLmJpdHJhdGVfaW5kZXggPSBCaXRyYXRlSW5kZXgoZ2ZwLmJyYXRlLCBnZnAudmVyc2lvbixcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLm91dF9zYW1wbGVyYXRlKTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLmJpdHJhdGVfaW5kZXggPD0gMCkge1xuICAgICAgICAgICAgICAgICAgICBnZnAuaW50ZXJuYWxfZmxhZ3MgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZ2ZjLmJpdHJhdGVfaW5kZXggPSAxO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogZm9yIENCUiwgd2Ugd2lsbCB3cml0ZSBhbiBcImluZm9cIiB0YWcuICovXG5cbiAgICAgICAgaWYgKGdmcC5hbmFseXNpcylcbiAgICAgICAgICAgIGdmcC5iV3JpdGVWYnJUYWcgPSBmYWxzZTtcblxuICAgICAgICAvKiBzb21lIGZpbGUgb3B0aW9ucyBub3QgYWxsb3dlZCBpZiBvdXRwdXQgaXM6IG5vdCBzcGVjaWZpZWQgb3Igc3Rkb3V0ICovXG4gICAgICAgIGlmIChnZmMucGluZm8gIT0gbnVsbClcbiAgICAgICAgICAgIGdmcC5iV3JpdGVWYnJUYWcgPSBmYWxzZTtcbiAgICAgICAgLyogZGlzYWJsZSBYaW5nIFZCUiB0YWcgKi9cblxuICAgICAgICBicy5pbml0X2JpdF9zdHJlYW1fdyhnZmMpO1xuXG4gICAgICAgIHZhciBqID0gZ2ZjLnNhbXBsZXJhdGVfaW5kZXggKyAoMyAqIGdmcC52ZXJzaW9uKSArIDZcbiAgICAgICAgICAgICogKGdmcC5vdXRfc2FtcGxlcmF0ZSA8IDE2MDAwID8gMSA6IDApO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEVuY29kZXIuU0JNQVhfbCArIDE7IGkrKylcbiAgICAgICAgICAgIGdmYy5zY2FsZWZhY19iYW5kLmxbaV0gPSBxdXB2dC5zZkJhbmRJbmRleFtqXS5sW2ldO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgRW5jb2Rlci5QU0ZCMjEgKyAxOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBzaXplID0gKGdmYy5zY2FsZWZhY19iYW5kLmxbMjJdIC0gZ2ZjLnNjYWxlZmFjX2JhbmQubFsyMV0pXG4gICAgICAgICAgICAgICAgLyBFbmNvZGVyLlBTRkIyMTtcbiAgICAgICAgICAgIHZhciBzdGFydCA9IGdmYy5zY2FsZWZhY19iYW5kLmxbMjFdICsgaSAqIHNpemU7XG4gICAgICAgICAgICBnZmMuc2NhbGVmYWNfYmFuZC5wc2ZiMjFbaV0gPSBzdGFydDtcbiAgICAgICAgfVxuICAgICAgICBnZmMuc2NhbGVmYWNfYmFuZC5wc2ZiMjFbRW5jb2Rlci5QU0ZCMjFdID0gNTc2O1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgRW5jb2Rlci5TQk1BWF9zICsgMTsgaSsrKVxuICAgICAgICAgICAgZ2ZjLnNjYWxlZmFjX2JhbmQuc1tpXSA9IHF1cHZ0LnNmQmFuZEluZGV4W2pdLnNbaV07XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBFbmNvZGVyLlBTRkIxMiArIDE7IGkrKykge1xuICAgICAgICAgICAgdmFyIHNpemUgPSAoZ2ZjLnNjYWxlZmFjX2JhbmQuc1sxM10gLSBnZmMuc2NhbGVmYWNfYmFuZC5zWzEyXSlcbiAgICAgICAgICAgICAgICAvIEVuY29kZXIuUFNGQjEyO1xuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gZ2ZjLnNjYWxlZmFjX2JhbmQuc1sxMl0gKyBpICogc2l6ZTtcbiAgICAgICAgICAgIGdmYy5zY2FsZWZhY19iYW5kLnBzZmIxMltpXSA9IHN0YXJ0O1xuICAgICAgICB9XG4gICAgICAgIGdmYy5zY2FsZWZhY19iYW5kLnBzZmIxMltFbmNvZGVyLlBTRkIxMl0gPSAxOTI7XG4gICAgICAgIC8qIGRldGVybWluZSB0aGUgbWVhbiBiaXRyYXRlIGZvciBtYWluIGRhdGEgKi9cbiAgICAgICAgaWYgKGdmcC52ZXJzaW9uID09IDEpIC8qIE1QRUcgMSAqL1xuICAgICAgICAgICAgZ2ZjLnNpZGVpbmZvX2xlbiA9IChnZmMuY2hhbm5lbHNfb3V0ID09IDEpID8gNCArIDE3IDogNCArIDMyO1xuICAgICAgICBlbHNlXG4gICAgICAgIC8qIE1QRUcgMiAqL1xuICAgICAgICAgICAgZ2ZjLnNpZGVpbmZvX2xlbiA9IChnZmMuY2hhbm5lbHNfb3V0ID09IDEpID8gNCArIDkgOiA0ICsgMTc7XG5cbiAgICAgICAgaWYgKGdmcC5lcnJvcl9wcm90ZWN0aW9uKVxuICAgICAgICAgICAgZ2ZjLnNpZGVpbmZvX2xlbiArPSAyO1xuXG4gICAgICAgIGxhbWVfaW5pdF9iaXRzdHJlYW0oZ2ZwKTtcblxuICAgICAgICBnZmMuQ2xhc3NfSUQgPSBMQU1FX0lEO1xuXG4gICAgICAgIHtcbiAgICAgICAgICAgIHZhciBrO1xuXG4gICAgICAgICAgICBmb3IgKGsgPSAwOyBrIDwgMTk7IGsrKylcbiAgICAgICAgICAgICAgICBnZmMubnNQc3kucGVmaXJidWZba10gPSA3MDAgKiBnZmMubW9kZV9nciAqIGdmYy5jaGFubmVsc19vdXQ7XG5cbiAgICAgICAgICAgIGlmIChnZnAuQVRIdHlwZSA9PSAtMSlcbiAgICAgICAgICAgICAgICBnZnAuQVRIdHlwZSA9IDQ7XG4gICAgICAgIH1cblxuICAgICAgICBzd2l0Y2ggKGdmcC5WQlIpIHtcblxuICAgICAgICAgICAgY2FzZSBWYnJNb2RlLnZicl9tdDpcbiAgICAgICAgICAgICAgICBnZnAuVkJSID0gVmJyTW9kZS52YnJfbXRyaDtcbiAgICAgICAgICAgIC8vJEZBTEwtVEhST1VHSCRcbiAgICAgICAgICAgIGNhc2UgVmJyTW9kZS52YnJfbXRyaDpcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZwLnVzZVRlbXBvcmFsID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLnVzZVRlbXBvcmFsID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIC8qIG9mZiBieSBkZWZhdWx0IGZvciB0aGlzIFZCUiBtb2RlICovXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcC5hcHBseV9wcmVzZXQoZ2ZwLCA1MDAgLSAoZ2ZwLlZCUl9xICogMTApLCAwKTtcbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiA8UFJFPlxuICAgICAgICAgICAgICAgICAqICAgVGhlIG5ld2VyIFZCUiBjb2RlIHN1cHBvcnRzIG9ubHkgYSBsaW1pdGVkXG4gICAgICAgICAgICAgICAgICogICAgIHN1YnNldCBvZiBxdWFsaXR5IGxldmVsczpcbiAgICAgICAgICAgICAgICAgKiAgICAgOS01PTUgYXJlIHRoZSBzYW1lLCB1c2VzIHheMy80IHF1YW50aXphdGlvblxuICAgICAgICAgICAgICAgICAqICAgNC0wPTAgYXJlIHRoZSBzYW1lICA1IHBsdXMgYmVzdCBodWZmbWFuIGRpdmlkZSBjb2RlXG4gICAgICAgICAgICAgICAgICogPC9QUkU+XG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgaWYgKGdmcC5xdWFsaXR5IDwgMClcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLnF1YWxpdHkgPSBMQU1FX0RFRkFVTFRfUVVBTElUWTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZwLnF1YWxpdHkgPCA1KVxuICAgICAgICAgICAgICAgICAgICBnZnAucXVhbGl0eSA9IDA7XG4gICAgICAgICAgICAgICAgaWYgKGdmcC5xdWFsaXR5ID4gNSlcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLnF1YWxpdHkgPSA1O1xuXG4gICAgICAgICAgICAgICAgZ2ZjLlBTWS5tYXNrX2FkanVzdCA9IGdmcC5tYXNraW5nYWRqdXN0O1xuICAgICAgICAgICAgICAgIGdmYy5QU1kubWFza19hZGp1c3Rfc2hvcnQgPSBnZnAubWFza2luZ2FkanVzdF9zaG9ydDtcblxuICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICogc2ZiMjEgZXh0cmEgb25seSB3aXRoIE1QRUctMSBhdCBoaWdoZXIgc2FtcGxpbmcgcmF0ZXNcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBpZiAoZ2ZwLmV4cGVyaW1lbnRhbFkpXG4gICAgICAgICAgICAgICAgICAgIGdmYy5zZmIyMV9leHRyYSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnNmYjIxX2V4dHJhID0gKGdmcC5vdXRfc2FtcGxlcmF0ZSA+IDQ0MDAwKTtcblxuICAgICAgICAgICAgICAgIGdmYy5pdGVyYXRpb25fbG9vcCA9IG5ldyBWQlJOZXdJdGVyYXRpb25Mb29wKHF1KTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2FzZSBWYnJNb2RlLnZicl9yaDpcbiAgICAgICAgICAgIHtcblxuICAgICAgICAgICAgICAgIHAuYXBwbHlfcHJlc2V0KGdmcCwgNTAwIC0gKGdmcC5WQlJfcSAqIDEwKSwgMCk7XG5cbiAgICAgICAgICAgICAgICBnZmMuUFNZLm1hc2tfYWRqdXN0ID0gZ2ZwLm1hc2tpbmdhZGp1c3Q7XG4gICAgICAgICAgICAgICAgZ2ZjLlBTWS5tYXNrX2FkanVzdF9zaG9ydCA9IGdmcC5tYXNraW5nYWRqdXN0X3Nob3J0O1xuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBzZmIyMSBleHRyYSBvbmx5IHdpdGggTVBFRy0xIGF0IGhpZ2hlciBzYW1wbGluZyByYXRlc1xuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIGlmIChnZnAuZXhwZXJpbWVudGFsWSlcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLnNmYjIxX2V4dHJhID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgICAgICBnZmMuc2ZiMjFfZXh0cmEgPSAoZ2ZwLm91dF9zYW1wbGVyYXRlID4gNDQwMDApO1xuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBWQlIgbmVlZHMgYXQgbGVhc3QgdGhlIG91dHB1dCBvZiBHUFNZQ0hPLCBzbyB3ZSBoYXZlIHRvIGdhcmFudGVlXG4gICAgICAgICAgICAgICAgICogdGhhdCBieSBzZXR0aW5nIGEgbWluaW11bSBxdWFsaXR5IGxldmVsLCBhY3R1YWxseSBsZXZlbCA2IGRvZXNcbiAgICAgICAgICAgICAgICAgKiBpdC4gZG93biB0byBsZXZlbCA2XG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgaWYgKGdmcC5xdWFsaXR5ID4gNilcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLnF1YWxpdHkgPSA2O1xuXG4gICAgICAgICAgICAgICAgaWYgKGdmcC5xdWFsaXR5IDwgMClcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLnF1YWxpdHkgPSBMQU1FX0RFRkFVTFRfUVVBTElUWTtcblxuICAgICAgICAgICAgICAgIGdmYy5pdGVyYXRpb25fbG9vcCA9IG5ldyBWQlJPbGRJdGVyYXRpb25Mb29wKHF1KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZGVmYXVsdDogLyogY2JyL2FiciAqL1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhciB2YnJtb2RlO1xuXG4gICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgKiBubyBzZmIyMSBleHRyYSB3aXRoIENCUiBjb2RlXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgZ2ZjLnNmYjIxX2V4dHJhID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBpZiAoZ2ZwLnF1YWxpdHkgPCAwKVxuICAgICAgICAgICAgICAgICAgICBnZnAucXVhbGl0eSA9IExBTUVfREVGQVVMVF9RVUFMSVRZO1xuXG4gICAgICAgICAgICAgICAgdmJybW9kZSA9IGdmcC5WQlI7XG4gICAgICAgICAgICAgICAgaWYgKHZicm1vZGUgPT0gVmJyTW9kZS52YnJfb2ZmKVxuICAgICAgICAgICAgICAgICAgICBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzID0gZ2ZwLmJyYXRlO1xuICAgICAgICAgICAgICAgIC8qIHNlY29uZCwgc2V0IHBhcmFtZXRlcnMgZGVwZW5kaW5nIG9uIGJpdHJhdGUgKi9cbiAgICAgICAgICAgICAgICBwLmFwcGx5X3ByZXNldChnZnAsIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMsIDApO1xuICAgICAgICAgICAgICAgIGdmcC5WQlIgPSB2YnJtb2RlO1xuXG4gICAgICAgICAgICAgICAgZ2ZjLlBTWS5tYXNrX2FkanVzdCA9IGdmcC5tYXNraW5nYWRqdXN0O1xuICAgICAgICAgICAgICAgIGdmYy5QU1kubWFza19hZGp1c3Rfc2hvcnQgPSBnZnAubWFza2luZ2FkanVzdF9zaG9ydDtcblxuICAgICAgICAgICAgICAgIGlmICh2YnJtb2RlID09IFZick1vZGUudmJyX29mZikge1xuICAgICAgICAgICAgICAgICAgICBnZmMuaXRlcmF0aW9uX2xvb3AgPSBuZXcgQ0JSTmV3SXRlcmF0aW9uTG9vcChxdSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLml0ZXJhdGlvbl9sb29wID0gbmV3IEFCUkl0ZXJhdGlvbkxvb3AocXUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiBpbml0aWFsaXplIGRlZmF1bHQgdmFsdWVzIGNvbW1vbiBmb3IgYWxsIG1vZGVzICovXG5cbiAgICAgICAgaWYgKGdmcC5WQlIgIT0gVmJyTW9kZS52YnJfb2ZmKSB7IC8qIGNob29zZSBhIG1pbi9tYXggYml0cmF0ZSBmb3IgVkJSICovXG4gICAgICAgICAgICAvKiBpZiB0aGUgdXNlciBkaWRuJ3Qgc3BlY2lmeSBWQlJfbWF4X2JpdHJhdGU6ICovXG4gICAgICAgICAgICBnZmMuVkJSX21pbl9iaXRyYXRlID0gMTtcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBkZWZhdWx0OiBhbGxvdyA4IGticHMgKE1QRUctMikgb3IgMzIga2JwcyAoTVBFRy0xKVxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICBnZmMuVkJSX21heF9iaXRyYXRlID0gMTQ7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogZGVmYXVsdDogYWxsb3cgMTYwIGticHMgKE1QRUctMikgb3IgMzIwIGticHMgKE1QRUctMSlcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgaWYgKGdmcC5vdXRfc2FtcGxlcmF0ZSA8IDE2MDAwKVxuICAgICAgICAgICAgICAgIGdmYy5WQlJfbWF4X2JpdHJhdGUgPSA4O1xuICAgICAgICAgICAgLyogZGVmYXVsdDogYWxsb3cgNjQga2JwcyAoTVBFRy0yLjUpICovXG4gICAgICAgICAgICBpZiAoZ2ZwLlZCUl9taW5fYml0cmF0ZV9rYnBzICE9IDApIHtcbiAgICAgICAgICAgICAgICBnZnAuVkJSX21pbl9iaXRyYXRlX2ticHMgPSBGaW5kTmVhcmVzdEJpdHJhdGUoXG4gICAgICAgICAgICAgICAgICAgIGdmcC5WQlJfbWluX2JpdHJhdGVfa2JwcywgZ2ZwLnZlcnNpb24sXG4gICAgICAgICAgICAgICAgICAgIGdmcC5vdXRfc2FtcGxlcmF0ZSk7XG4gICAgICAgICAgICAgICAgZ2ZjLlZCUl9taW5fYml0cmF0ZSA9IEJpdHJhdGVJbmRleChnZnAuVkJSX21pbl9iaXRyYXRlX2ticHMsXG4gICAgICAgICAgICAgICAgICAgIGdmcC52ZXJzaW9uLCBnZnAub3V0X3NhbXBsZXJhdGUpO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuVkJSX21pbl9iaXRyYXRlIDwgMClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGdmcC5WQlJfbWF4X2JpdHJhdGVfa2JwcyAhPSAwKSB7XG4gICAgICAgICAgICAgICAgZ2ZwLlZCUl9tYXhfYml0cmF0ZV9rYnBzID0gRmluZE5lYXJlc3RCaXRyYXRlKFxuICAgICAgICAgICAgICAgICAgICBnZnAuVkJSX21heF9iaXRyYXRlX2ticHMsIGdmcC52ZXJzaW9uLFxuICAgICAgICAgICAgICAgICAgICBnZnAub3V0X3NhbXBsZXJhdGUpO1xuICAgICAgICAgICAgICAgIGdmYy5WQlJfbWF4X2JpdHJhdGUgPSBCaXRyYXRlSW5kZXgoZ2ZwLlZCUl9tYXhfYml0cmF0ZV9rYnBzLFxuICAgICAgICAgICAgICAgICAgICBnZnAudmVyc2lvbiwgZ2ZwLm91dF9zYW1wbGVyYXRlKTtcbiAgICAgICAgICAgICAgICBpZiAoZ2ZjLlZCUl9tYXhfYml0cmF0ZSA8IDApXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdmcC5WQlJfbWluX2JpdHJhdGVfa2JwcyA9IFRhYmxlcy5iaXRyYXRlX3RhYmxlW2dmcC52ZXJzaW9uXVtnZmMuVkJSX21pbl9iaXRyYXRlXTtcbiAgICAgICAgICAgIGdmcC5WQlJfbWF4X2JpdHJhdGVfa2JwcyA9IFRhYmxlcy5iaXRyYXRlX3RhYmxlW2dmcC52ZXJzaW9uXVtnZmMuVkJSX21heF9iaXRyYXRlXTtcbiAgICAgICAgICAgIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMgPSBNYXRoLm1pbihcbiAgICAgICAgICAgICAgICBUYWJsZXMuYml0cmF0ZV90YWJsZVtnZnAudmVyc2lvbl1bZ2ZjLlZCUl9tYXhfYml0cmF0ZV0sXG4gICAgICAgICAgICAgICAgZ2ZwLlZCUl9tZWFuX2JpdHJhdGVfa2Jwcyk7XG4gICAgICAgICAgICBnZnAuVkJSX21lYW5fYml0cmF0ZV9rYnBzID0gTWF0aC5tYXgoXG4gICAgICAgICAgICAgICAgVGFibGVzLmJpdHJhdGVfdGFibGVbZ2ZwLnZlcnNpb25dW2dmYy5WQlJfbWluX2JpdHJhdGVdLFxuICAgICAgICAgICAgICAgIGdmcC5WQlJfbWVhbl9iaXRyYXRlX2ticHMpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoganVzdCBhbm90aGVyIGRhaWx5IGNoYW5naW5nIGRldmVsb3BlciBzd2l0Y2ggKi9cbiAgICAgICAgaWYgKGdmcC50dW5lKSB7XG4gICAgICAgICAgICBnZmMuUFNZLm1hc2tfYWRqdXN0ICs9IGdmcC50dW5lX3ZhbHVlX2E7XG4gICAgICAgICAgICBnZmMuUFNZLm1hc2tfYWRqdXN0X3Nob3J0ICs9IGdmcC50dW5lX3ZhbHVlX2E7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBpbml0aWFsaXplIGludGVybmFsIHF2YWwgc2V0dGluZ3MgKi9cbiAgICAgICAgbGFtZV9pbml0X3F2YWwoZ2ZwKTtcbiAgICAgICAgLypcbiAgICAgICAgICogYXV0b21hdGljIEFUSCBhZGp1c3RtZW50IG9uXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoZ2ZwLmF0aGFhX3R5cGUgPCAwKVxuICAgICAgICAgICAgZ2ZjLkFUSC51c2VBZGp1c3QgPSAzO1xuICAgICAgICBlbHNlXG4gICAgICAgICAgICBnZmMuQVRILnVzZUFkanVzdCA9IGdmcC5hdGhhYV90eXBlO1xuXG4gICAgICAgIC8qIGluaXRpYWxpemUgaW50ZXJuYWwgYWRhcHRpdmUgQVRIIHNldHRpbmdzIC1qZCAqL1xuICAgICAgICBnZmMuQVRILmFhU2Vuc2l0aXZpdHlQID0gTWF0aC5wb3coMTAuMCwgZ2ZwLmF0aGFhX3NlbnNpdGl2aXR5XG4gICAgICAgICAgICAvIC0xMC4wKTtcblxuICAgICAgICBpZiAoZ2ZwLnNob3J0X2Jsb2NrcyA9PSBudWxsKSB7XG4gICAgICAgICAgICBnZnAuc2hvcnRfYmxvY2tzID0gU2hvcnRCbG9jay5zaG9ydF9ibG9ja19hbGxvd2VkO1xuICAgICAgICB9XG5cbiAgICAgICAgLypcbiAgICAgICAgICogTm90ZSBKYW4vMjAwMzogTWFueSBoYXJkd2FyZSBkZWNvZGVycyBjYW5ub3QgaGFuZGxlIHNob3J0IGJsb2NrcyBpblxuICAgICAgICAgKiByZWd1bGFyIHN0ZXJlbyBtb2RlIHVubGVzcyB0aGV5IGFyZSBjb3VwbGVkIChzYW1lIHR5cGUgaW4gYm90aFxuICAgICAgICAgKiBjaGFubmVscykgaXQgaXMgYSByYXJlIGV2ZW50ICgxIGZyYW1lIHBlciBtaW4uIG9yIHNvKSB0aGF0IExBTUUgd291bGRcbiAgICAgICAgICogdXNlIHVuY291cGxlZCBzaG9ydCBibG9ja3MsIHNvIGxldHMgdHVybiB0aGVtIG9mZiB1bnRpbCB3ZSBkZWNpZGUgaG93XG4gICAgICAgICAqIHRvIGhhbmRsZSB0aGlzLiBObyBvdGhlciBlbmNvZGVycyBhbGxvdyB1bmNvdXBsZWQgc2hvcnQgYmxvY2tzLCBldmVuXG4gICAgICAgICAqIHRob3VnaCBpdCBpcyBpbiB0aGUgc3RhbmRhcmQuXG4gICAgICAgICAqL1xuICAgICAgICAvKlxuICAgICAgICAgKiByaCAyMDA0MDIxNzogY291cGxpbmcgbWFrZXMgbm8gc2Vuc2UgZm9yIG1vbm8gYW5kIGR1YWwtbW9ubyBzdHJlYW1zXG4gICAgICAgICAqL1xuICAgICAgICBpZiAoZ2ZwLnNob3J0X2Jsb2NrcyA9PSBTaG9ydEJsb2NrLnNob3J0X2Jsb2NrX2FsbG93ZWRcbiAgICAgICAgICAgICYmIChnZnAubW9kZSA9PSBNUEVHTW9kZS5KT0lOVF9TVEVSRU8gfHwgZ2ZwLm1vZGUgPT0gTVBFR01vZGUuU1RFUkVPKSkge1xuICAgICAgICAgICAgZ2ZwLnNob3J0X2Jsb2NrcyA9IFNob3J0QmxvY2suc2hvcnRfYmxvY2tfY291cGxlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChnZnAucXVhbnRfY29tcCA8IDApXG4gICAgICAgICAgICBnZnAucXVhbnRfY29tcCA9IDE7XG4gICAgICAgIGlmIChnZnAucXVhbnRfY29tcF9zaG9ydCA8IDApXG4gICAgICAgICAgICBnZnAucXVhbnRfY29tcF9zaG9ydCA9IDA7XG5cbiAgICAgICAgaWYgKGdmcC5tc2ZpeCA8IDApXG4gICAgICAgICAgICBnZnAubXNmaXggPSAwO1xuXG4gICAgICAgIC8qIHNlbGVjdCBwc3ljaG9hY291c3RpYyBtb2RlbCAqL1xuICAgICAgICBnZnAuZXhwX25zcHN5dHVuZSA9IGdmcC5leHBfbnNwc3l0dW5lIHwgMTtcblxuICAgICAgICBpZiAoZ2ZwLmludGVybmFsX2ZsYWdzLm5zUHN5LmF0dGFja3RocmUgPCAwKVxuICAgICAgICAgICAgZ2ZwLmludGVybmFsX2ZsYWdzLm5zUHN5LmF0dGFja3RocmUgPSBQc3lNb2RlbC5OU0FUVEFDS1RIUkU7XG4gICAgICAgIGlmIChnZnAuaW50ZXJuYWxfZmxhZ3MubnNQc3kuYXR0YWNrdGhyZV9zIDwgMClcbiAgICAgICAgICAgIGdmcC5pbnRlcm5hbF9mbGFncy5uc1BzeS5hdHRhY2t0aHJlX3MgPSBQc3lNb2RlbC5OU0FUVEFDS1RIUkVfUztcblxuXG4gICAgICAgIGlmIChnZnAuc2NhbGUgPCAwKVxuICAgICAgICAgICAgZ2ZwLnNjYWxlID0gMTtcblxuICAgICAgICBpZiAoZ2ZwLkFUSHR5cGUgPCAwKVxuICAgICAgICAgICAgZ2ZwLkFUSHR5cGUgPSA0O1xuXG4gICAgICAgIGlmIChnZnAuQVRIY3VydmUgPCAwKVxuICAgICAgICAgICAgZ2ZwLkFUSGN1cnZlID0gNDtcblxuICAgICAgICBpZiAoZ2ZwLmF0aGFhX2xvdWRhcHByb3ggPCAwKVxuICAgICAgICAgICAgZ2ZwLmF0aGFhX2xvdWRhcHByb3ggPSAyO1xuXG4gICAgICAgIGlmIChnZnAuaW50ZXJDaFJhdGlvIDwgMClcbiAgICAgICAgICAgIGdmcC5pbnRlckNoUmF0aW8gPSAwO1xuXG4gICAgICAgIGlmIChnZnAudXNlVGVtcG9yYWwgPT0gbnVsbClcbiAgICAgICAgICAgIGdmcC51c2VUZW1wb3JhbCA9IHRydWU7XG4gICAgICAgIC8qIG9uIGJ5IGRlZmF1bHQgKi9cblxuICAgICAgICAvKlxuICAgICAgICAgKiBwYWRkaW5nIG1ldGhvZCBhcyBkZXNjcmliZWQgaW5cbiAgICAgICAgICogXCJNUEVHLUxheWVyMyAvIEJpdHN0cmVhbSBTeW50YXggYW5kIERlY29kaW5nXCIgYnkgTWFydGluIFNpZWxlciwgUmFscGhcbiAgICAgICAgICogU3BlcnNjaG5laWRlclxuICAgICAgICAgKlxuICAgICAgICAgKiBub3RlOiB0aGVyZSBpcyBubyBwYWRkaW5nIGZvciB0aGUgdmVyeSBmaXJzdCBmcmFtZVxuICAgICAgICAgKlxuICAgICAgICAgKiBSb2JlcnQgSGVnZW1hbm4gMjAwMC0wNi0yMlxuICAgICAgICAgKi9cbiAgICAgICAgZ2ZjLnNsb3RfbGFnID0gZ2ZjLmZyYWNfU3BGID0gMDtcbiAgICAgICAgaWYgKGdmcC5WQlIgPT0gVmJyTW9kZS52YnJfb2ZmKVxuICAgICAgICAgICAgZ2ZjLnNsb3RfbGFnID0gZ2ZjLmZyYWNfU3BGID0gKCgoZ2ZwLnZlcnNpb24gKyAxKSAqIDcyMDAwICogZ2ZwLmJyYXRlKSAlIGdmcC5vdXRfc2FtcGxlcmF0ZSkgfCAwO1xuXG4gICAgICAgIHF1cHZ0Lml0ZXJhdGlvbl9pbml0KGdmcCk7XG4gICAgICAgIHBzeS5wc3ltb2RlbF9pbml0KGdmcCk7XG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZV9pbmJ1ZmZlcl9zaXplKGdmYywgbnNhbXBsZXMpIHtcbiAgICAgICAgaWYgKGdmYy5pbl9idWZmZXJfMCA9PSBudWxsIHx8IGdmYy5pbl9idWZmZXJfbnNhbXBsZXMgPCBuc2FtcGxlcykge1xuICAgICAgICAgICAgZ2ZjLmluX2J1ZmZlcl8wID0gbmV3X2Zsb2F0KG5zYW1wbGVzKTtcbiAgICAgICAgICAgIGdmYy5pbl9idWZmZXJfMSA9IG5ld19mbG9hdChuc2FtcGxlcyk7XG4gICAgICAgICAgICBnZmMuaW5fYnVmZmVyX25zYW1wbGVzID0gbnNhbXBsZXM7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmxhbWVfZW5jb2RlX2ZsdXNoID0gZnVuY3Rpb24gKGdmcCwgbXAzYnVmZmVyLCBtcDNidWZmZXJQb3MsIG1wM2J1ZmZlcl9zaXplKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG4gICAgICAgIHZhciBidWZmZXIgPSBuZXdfc2hvcnRfbihbMiwgMTE1Ml0pO1xuICAgICAgICB2YXIgaW1wMyA9IDAsIG1wM2NvdW50LCBtcDNidWZmZXJfc2l6ZV9yZW1haW5pbmc7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogd2UgYWx3YXlzIGFkZCBQT1NUREVMQVk9Mjg4IHBhZGRpbmcgdG8gbWFrZSBzdXJlIGdyYW51bGUgd2l0aCByZWFsXG4gICAgICAgICAqIGRhdGEgY2FuIGJlIGNvbXBsZXR5IGRlY29kZWQgKGJlY2F1c2Ugb2YgNTAlIG92ZXJsYXAgd2l0aCBuZXh0XG4gICAgICAgICAqIGdyYW51bGVcbiAgICAgICAgICovXG4gICAgICAgIHZhciBlbmRfcGFkZGluZztcbiAgICAgICAgdmFyIGZyYW1lc19sZWZ0O1xuICAgICAgICB2YXIgc2FtcGxlc190b19lbmNvZGUgPSBnZmMubWZfc2FtcGxlc190b19lbmNvZGUgLSBFbmNvZGVyLlBPU1RERUxBWTtcbiAgICAgICAgdmFyIG1mX25lZWRlZCA9IGNhbGNOZWVkZWQoZ2ZwKTtcblxuICAgICAgICAvKiBXYXMgZmx1c2ggYWxyZWFkeSBjYWxsZWQ/ICovXG4gICAgICAgIGlmIChnZmMubWZfc2FtcGxlc190b19lbmNvZGUgPCAxKSB7XG4gICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgICBtcDNjb3VudCA9IDA7XG5cbiAgICAgICAgaWYgKGdmcC5pbl9zYW1wbGVyYXRlICE9IGdmcC5vdXRfc2FtcGxlcmF0ZSkge1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAqIGRlbGF5IGR1ZSB0byByZXNhbXBsaW5nOyBuZWVkcyB0byBiZSBmaXhlZCwgaWYgcmVzYW1wbGluZyBjb2RlXG4gICAgICAgICAgICAgKiBnZXRzIGNoYW5nZWRcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgc2FtcGxlc190b19lbmNvZGUgKz0gMTYuICogZ2ZwLm91dF9zYW1wbGVyYXRlIC8gZ2ZwLmluX3NhbXBsZXJhdGU7XG4gICAgICAgIH1cbiAgICAgICAgZW5kX3BhZGRpbmcgPSBnZnAuZnJhbWVzaXplIC0gKHNhbXBsZXNfdG9fZW5jb2RlICUgZ2ZwLmZyYW1lc2l6ZSk7XG4gICAgICAgIGlmIChlbmRfcGFkZGluZyA8IDU3NilcbiAgICAgICAgICAgIGVuZF9wYWRkaW5nICs9IGdmcC5mcmFtZXNpemU7XG4gICAgICAgIGdmcC5lbmNvZGVyX3BhZGRpbmcgPSBlbmRfcGFkZGluZztcblxuICAgICAgICBmcmFtZXNfbGVmdCA9IChzYW1wbGVzX3RvX2VuY29kZSArIGVuZF9wYWRkaW5nKSAvIGdmcC5mcmFtZXNpemU7XG5cbiAgICAgICAgLypcbiAgICAgICAgICogc2VuZCBpbiBhIGZyYW1lIG9mIDAgcGFkZGluZyB1bnRpbCBhbGwgaW50ZXJuYWwgc2FtcGxlIGJ1ZmZlcnMgYXJlXG4gICAgICAgICAqIGZsdXNoZWRcbiAgICAgICAgICovXG4gICAgICAgIHdoaWxlIChmcmFtZXNfbGVmdCA+IDAgJiYgaW1wMyA+PSAwKSB7XG4gICAgICAgICAgICB2YXIgYnVuY2ggPSBtZl9uZWVkZWQgLSBnZmMubWZfc2l6ZTtcbiAgICAgICAgICAgIHZhciBmcmFtZV9udW0gPSBnZnAuZnJhbWVOdW07XG5cbiAgICAgICAgICAgIGJ1bmNoICo9IGdmcC5pbl9zYW1wbGVyYXRlO1xuICAgICAgICAgICAgYnVuY2ggLz0gZ2ZwLm91dF9zYW1wbGVyYXRlO1xuICAgICAgICAgICAgaWYgKGJ1bmNoID4gMTE1MilcbiAgICAgICAgICAgICAgICBidW5jaCA9IDExNTI7XG4gICAgICAgICAgICBpZiAoYnVuY2ggPCAxKVxuICAgICAgICAgICAgICAgIGJ1bmNoID0gMTtcblxuICAgICAgICAgICAgbXAzYnVmZmVyX3NpemVfcmVtYWluaW5nID0gbXAzYnVmZmVyX3NpemUgLSBtcDNjb3VudDtcblxuICAgICAgICAgICAgLyogaWYgdXNlciBzcGVjaWZlZCBidWZmZXIgc2l6ZSA9IDAsIGRvbnQgY2hlY2sgc2l6ZSAqL1xuICAgICAgICAgICAgaWYgKG1wM2J1ZmZlcl9zaXplID09IDApXG4gICAgICAgICAgICAgICAgbXAzYnVmZmVyX3NpemVfcmVtYWluaW5nID0gMDtcblxuICAgICAgICAgICAgaW1wMyA9IHRoaXMubGFtZV9lbmNvZGVfYnVmZmVyKGdmcCwgYnVmZmVyWzBdLCBidWZmZXJbMV0sIGJ1bmNoLFxuICAgICAgICAgICAgICAgIG1wM2J1ZmZlciwgbXAzYnVmZmVyUG9zLCBtcDNidWZmZXJfc2l6ZV9yZW1haW5pbmcpO1xuXG4gICAgICAgICAgICBtcDNidWZmZXJQb3MgKz0gaW1wMztcbiAgICAgICAgICAgIG1wM2NvdW50ICs9IGltcDM7XG4gICAgICAgICAgICBmcmFtZXNfbGVmdCAtPSAoZnJhbWVfbnVtICE9IGdmcC5mcmFtZU51bSkgPyAxIDogMDtcbiAgICAgICAgfVxuICAgICAgICAvKlxuICAgICAgICAgKiBTZXQgZ2ZjLm1mX3NhbXBsZXNfdG9fZW5jb2RlIHRvIDAsIHNvIHdlIG1heSBkZXRlY3QgYW5kIGJyZWFrIGxvb3BzXG4gICAgICAgICAqIGNhbGxpbmcgaXQgbW9yZSB0aGFuIG9uY2UgaW4gYSByb3cuXG4gICAgICAgICAqL1xuICAgICAgICBnZmMubWZfc2FtcGxlc190b19lbmNvZGUgPSAwO1xuXG4gICAgICAgIGlmIChpbXAzIDwgMCkge1xuICAgICAgICAgICAgLyogc29tZSB0eXBlIG9mIGZhdGFsIGVycm9yICovXG4gICAgICAgICAgICByZXR1cm4gaW1wMztcbiAgICAgICAgfVxuXG4gICAgICAgIG1wM2J1ZmZlcl9zaXplX3JlbWFpbmluZyA9IG1wM2J1ZmZlcl9zaXplIC0gbXAzY291bnQ7XG4gICAgICAgIC8qIGlmIHVzZXIgc3BlY2lmZWQgYnVmZmVyIHNpemUgPSAwLCBkb250IGNoZWNrIHNpemUgKi9cbiAgICAgICAgaWYgKG1wM2J1ZmZlcl9zaXplID09IDApXG4gICAgICAgICAgICBtcDNidWZmZXJfc2l6ZV9yZW1haW5pbmcgPSAwO1xuXG4gICAgICAgIC8qIG1wMyByZWxhdGVkIHN0dWZmLiBiaXQgYnVmZmVyIG1pZ2h0IHN0aWxsIGNvbnRhaW4gc29tZSBtcDMgZGF0YSAqL1xuICAgICAgICBicy5mbHVzaF9iaXRzdHJlYW0oZ2ZwKTtcbiAgICAgICAgaW1wMyA9IGJzLmNvcHlfYnVmZmVyKGdmYywgbXAzYnVmZmVyLCBtcDNidWZmZXJQb3MsXG4gICAgICAgICAgICBtcDNidWZmZXJfc2l6ZV9yZW1haW5pbmcsIDEpO1xuICAgICAgICBpZiAoaW1wMyA8IDApIHtcbiAgICAgICAgICAgIC8qIHNvbWUgdHlwZSBvZiBmYXRhbCBlcnJvciAqL1xuICAgICAgICAgICAgcmV0dXJuIGltcDM7XG4gICAgICAgIH1cbiAgICAgICAgbXAzYnVmZmVyUG9zICs9IGltcDM7XG4gICAgICAgIG1wM2NvdW50ICs9IGltcDM7XG4gICAgICAgIG1wM2J1ZmZlcl9zaXplX3JlbWFpbmluZyA9IG1wM2J1ZmZlcl9zaXplIC0gbXAzY291bnQ7XG4gICAgICAgIC8qIGlmIHVzZXIgc3BlY2lmZWQgYnVmZmVyIHNpemUgPSAwLCBkb250IGNoZWNrIHNpemUgKi9cbiAgICAgICAgaWYgKG1wM2J1ZmZlcl9zaXplID09IDApXG4gICAgICAgICAgICBtcDNidWZmZXJfc2l6ZV9yZW1haW5pbmcgPSAwO1xuXG4gICAgICAgIGlmIChnZnAud3JpdGVfaWQzdGFnX2F1dG9tYXRpYykge1xuICAgICAgICAgICAgLyogd3JpdGUgYSBpZDMgdGFnIHRvIHRoZSBiaXRzdHJlYW0gKi9cbiAgICAgICAgICAgIGlkMy5pZDN0YWdfd3JpdGVfdjEoZ2ZwKTtcblxuICAgICAgICAgICAgaW1wMyA9IGJzLmNvcHlfYnVmZmVyKGdmYywgbXAzYnVmZmVyLCBtcDNidWZmZXJQb3MsXG4gICAgICAgICAgICAgICAgbXAzYnVmZmVyX3NpemVfcmVtYWluaW5nLCAwKTtcblxuICAgICAgICAgICAgaWYgKGltcDMgPCAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGltcDM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtcDNjb3VudCArPSBpbXAzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBtcDNjb3VudDtcbiAgICB9O1xuXG4gICAgdGhpcy5sYW1lX2VuY29kZV9idWZmZXIgPSBmdW5jdGlvbiAoZ2ZwLCBidWZmZXJfbCwgYnVmZmVyX3IsIG5zYW1wbGVzLCBtcDNidWYsIG1wM2J1ZlBvcywgbXAzYnVmX3NpemUpIHtcbiAgICAgICAgdmFyIGdmYyA9IGdmcC5pbnRlcm5hbF9mbGFncztcbiAgICAgICAgdmFyIGluX2J1ZmZlciA9IFtudWxsLCBudWxsXTtcblxuICAgICAgICBpZiAoZ2ZjLkNsYXNzX0lEICE9IExBTUVfSUQpXG4gICAgICAgICAgICByZXR1cm4gLTM7XG5cbiAgICAgICAgaWYgKG5zYW1wbGVzID09IDApXG4gICAgICAgICAgICByZXR1cm4gMDtcblxuICAgICAgICB1cGRhdGVfaW5idWZmZXJfc2l6ZShnZmMsIG5zYW1wbGVzKTtcblxuICAgICAgICBpbl9idWZmZXJbMF0gPSBnZmMuaW5fYnVmZmVyXzA7XG4gICAgICAgIGluX2J1ZmZlclsxXSA9IGdmYy5pbl9idWZmZXJfMTtcblxuICAgICAgICAvKiBtYWtlIGEgY29weSBvZiBpbnB1dCBidWZmZXIsIGNoYW5naW5nIHR5cGUgdG8gc2FtcGxlX3QgKi9cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuc2FtcGxlczsgaSsrKSB7XG4gICAgICAgICAgICBpbl9idWZmZXJbMF1baV0gPSBidWZmZXJfbFtpXTtcbiAgICAgICAgICAgIGlmIChnZmMuY2hhbm5lbHNfaW4gPiAxKVxuICAgICAgICAgICAgICAgIGluX2J1ZmZlclsxXVtpXSA9IGJ1ZmZlcl9yW2ldO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGxhbWVfZW5jb2RlX2J1ZmZlcl9zYW1wbGUoZ2ZwLCBpbl9idWZmZXJbMF0sIGluX2J1ZmZlclsxXSxcbiAgICAgICAgICAgIG5zYW1wbGVzLCBtcDNidWYsIG1wM2J1ZlBvcywgbXAzYnVmX3NpemUpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNhbGNOZWVkZWQoZ2ZwKSB7XG4gICAgICAgIHZhciBtZl9uZWVkZWQgPSBFbmNvZGVyLkJMS1NJWkUgKyBnZnAuZnJhbWVzaXplIC0gRW5jb2Rlci5GRlRPRkZTRVQ7XG4gICAgICAgIC8qXG4gICAgICAgICAqIGFtb3VudCBuZWVkZWQgZm9yIEZGVFxuICAgICAgICAgKi9cbiAgICAgICAgbWZfbmVlZGVkID0gTWF0aC5tYXgobWZfbmVlZGVkLCA1MTIgKyBnZnAuZnJhbWVzaXplIC0gMzIpO1xuXG4gICAgICAgIHJldHVybiBtZl9uZWVkZWQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gbGFtZV9lbmNvZGVfYnVmZmVyX3NhbXBsZShnZnAsIGJ1ZmZlcl9sLCBidWZmZXJfciwgbnNhbXBsZXMsIG1wM2J1ZiwgbXAzYnVmUG9zLCBtcDNidWZfc2l6ZSkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgbXAzc2l6ZSA9IDAsIHJldCwgaSwgY2gsIG1mX25lZWRlZDtcbiAgICAgICAgdmFyIG1wM291dDtcbiAgICAgICAgdmFyIG1mYnVmID0gW251bGwsIG51bGxdO1xuICAgICAgICB2YXIgaW5fYnVmZmVyID0gW251bGwsIG51bGxdO1xuXG4gICAgICAgIGlmIChnZmMuQ2xhc3NfSUQgIT0gTEFNRV9JRClcbiAgICAgICAgICAgIHJldHVybiAtMztcblxuICAgICAgICBpZiAobnNhbXBsZXMgPT0gMClcbiAgICAgICAgICAgIHJldHVybiAwO1xuXG4gICAgICAgIC8qIGNvcHkgb3V0IGFueSB0YWdzIHRoYXQgbWF5IGhhdmUgYmVlbiB3cml0dGVuIGludG8gYml0c3RyZWFtICovXG4gICAgICAgIG1wM291dCA9IGJzLmNvcHlfYnVmZmVyKGdmYywgbXAzYnVmLCBtcDNidWZQb3MsIG1wM2J1Zl9zaXplLCAwKTtcbiAgICAgICAgaWYgKG1wM291dCA8IDApXG4gICAgICAgICAgICByZXR1cm4gbXAzb3V0O1xuICAgICAgICAvKiBub3QgZW5vdWdoIGJ1ZmZlciBzcGFjZSAqL1xuICAgICAgICBtcDNidWZQb3MgKz0gbXAzb3V0O1xuICAgICAgICBtcDNzaXplICs9IG1wM291dDtcblxuICAgICAgICBpbl9idWZmZXJbMF0gPSBidWZmZXJfbDtcbiAgICAgICAgaW5fYnVmZmVyWzFdID0gYnVmZmVyX3I7XG5cbiAgICAgICAgLyogQXBwbHkgdXNlciBkZWZpbmVkIHJlLXNjYWxpbmcgKi9cblxuICAgICAgICAvKiB1c2VyIHNlbGVjdGVkIHNjYWxpbmcgb2YgdGhlIHNhbXBsZXMgKi9cbiAgICAgICAgaWYgKEJpdFN0cmVhbS5ORVEoZ2ZwLnNjYWxlLCAwKSAmJiBCaXRTdHJlYW0uTkVRKGdmcC5zY2FsZSwgMS4wKSkge1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG5zYW1wbGVzOyArK2kpIHtcbiAgICAgICAgICAgICAgICBpbl9idWZmZXJbMF1baV0gKj0gZ2ZwLnNjYWxlO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuY2hhbm5lbHNfb3V0ID09IDIpXG4gICAgICAgICAgICAgICAgICAgIGluX2J1ZmZlclsxXVtpXSAqPSBnZnAuc2NhbGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiB1c2VyIHNlbGVjdGVkIHNjYWxpbmcgb2YgdGhlIGNoYW5uZWwgMCAobGVmdCkgc2FtcGxlcyAqL1xuICAgICAgICBpZiAoQml0U3RyZWFtLk5FUShnZnAuc2NhbGVfbGVmdCwgMClcbiAgICAgICAgICAgICYmIEJpdFN0cmVhbS5ORVEoZ2ZwLnNjYWxlX2xlZnQsIDEuMCkpIHtcbiAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBuc2FtcGxlczsgKytpKSB7XG4gICAgICAgICAgICAgICAgaW5fYnVmZmVyWzBdW2ldICo9IGdmcC5zY2FsZV9sZWZ0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogdXNlciBzZWxlY3RlZCBzY2FsaW5nIG9mIHRoZSBjaGFubmVsIDEgKHJpZ2h0KSBzYW1wbGVzICovXG4gICAgICAgIGlmIChCaXRTdHJlYW0uTkVRKGdmcC5zY2FsZV9yaWdodCwgMClcbiAgICAgICAgICAgICYmIEJpdFN0cmVhbS5ORVEoZ2ZwLnNjYWxlX3JpZ2h0LCAxLjApKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbnNhbXBsZXM7ICsraSkge1xuICAgICAgICAgICAgICAgIGluX2J1ZmZlclsxXVtpXSAqPSBnZnAuc2NhbGVfcmlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBEb3duc2FtcGxlIHRvIE1vbm8gaWYgMiBjaGFubmVscyBpbiBhbmQgMSBjaGFubmVsIG91dCAqL1xuICAgICAgICBpZiAoZ2ZwLm51bV9jaGFubmVscyA9PSAyICYmIGdmYy5jaGFubmVsc19vdXQgPT0gMSkge1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG5zYW1wbGVzOyArK2kpIHtcbiAgICAgICAgICAgICAgICBpbl9idWZmZXJbMF1baV0gPSAwLjUgKiAoIGluX2J1ZmZlclswXVtpXSArIGluX2J1ZmZlclsxXVtpXSk7XG4gICAgICAgICAgICAgICAgaW5fYnVmZmVyWzFdW2ldID0gMC4wO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgbWZfbmVlZGVkID0gY2FsY05lZWRlZChnZnApO1xuXG4gICAgICAgIG1mYnVmWzBdID0gZ2ZjLm1mYnVmWzBdO1xuICAgICAgICBtZmJ1ZlsxXSA9IGdmYy5tZmJ1ZlsxXTtcblxuICAgICAgICB2YXIgaW5fYnVmZmVyUG9zID0gMDtcbiAgICAgICAgd2hpbGUgKG5zYW1wbGVzID4gMCkge1xuICAgICAgICAgICAgdmFyIGluX2J1ZmZlcl9wdHIgPSBbbnVsbCwgbnVsbF07XG4gICAgICAgICAgICB2YXIgbl9pbiA9IDA7XG4gICAgICAgICAgICAvKiBudW1iZXIgb2YgaW5wdXQgc2FtcGxlcyBwcm9jZXNzZWQgd2l0aCBmaWxsX2J1ZmZlciAqL1xuICAgICAgICAgICAgdmFyIG5fb3V0ID0gMDtcbiAgICAgICAgICAgIC8qIG51bWJlciBvZiBzYW1wbGVzIG91dHB1dCB3aXRoIGZpbGxfYnVmZmVyICovXG4gICAgICAgICAgICAvKiBuX2luIDw+IG5fb3V0IGlmIHdlIGFyZSByZXNhbXBsaW5nICovXG5cbiAgICAgICAgICAgIGluX2J1ZmZlcl9wdHJbMF0gPSBpbl9idWZmZXJbMF07XG4gICAgICAgICAgICBpbl9idWZmZXJfcHRyWzFdID0gaW5fYnVmZmVyWzFdO1xuICAgICAgICAgICAgLyogY29weSBpbiBuZXcgc2FtcGxlcyBpbnRvIG1mYnVmLCB3aXRoIHJlc2FtcGxpbmcgKi9cbiAgICAgICAgICAgIHZhciBpbk91dCA9IG5ldyBJbk91dCgpO1xuICAgICAgICAgICAgZmlsbF9idWZmZXIoZ2ZwLCBtZmJ1ZiwgaW5fYnVmZmVyX3B0ciwgaW5fYnVmZmVyUG9zLCBuc2FtcGxlcyxcbiAgICAgICAgICAgICAgICBpbk91dCk7XG4gICAgICAgICAgICBuX2luID0gaW5PdXQubl9pbjtcbiAgICAgICAgICAgIG5fb3V0ID0gaW5PdXQubl9vdXQ7XG5cbiAgICAgICAgICAgIC8qIGNvbXB1dGUgUmVwbGF5R2FpbiBvZiByZXNhbXBsZWQgaW5wdXQgaWYgcmVxdWVzdGVkICovXG4gICAgICAgICAgICBpZiAoZ2ZjLmZpbmRSZXBsYXlHYWluICYmICFnZmMuZGVjb2RlX29uX3RoZV9mbHkpXG4gICAgICAgICAgICAgICAgaWYgKGdhLkFuYWx5emVTYW1wbGVzKGdmYy5yZ2RhdGEsIG1mYnVmWzBdLCBnZmMubWZfc2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1mYnVmWzFdLCBnZmMubWZfc2l6ZSwgbl9vdXQsIGdmYy5jaGFubmVsc19vdXQpID09IEdhaW5BbmFseXNpcy5HQUlOX0FOQUxZU0lTX0VSUk9SKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTY7XG5cbiAgICAgICAgICAgIC8qIHVwZGF0ZSBpbl9idWZmZXIgY291bnRlcnMgKi9cbiAgICAgICAgICAgIG5zYW1wbGVzIC09IG5faW47XG4gICAgICAgICAgICBpbl9idWZmZXJQb3MgKz0gbl9pbjtcbiAgICAgICAgICAgIGlmIChnZmMuY2hhbm5lbHNfb3V0ID09IDIpXG4gICAgICAgICAgICAgICAgOy8vIGluX2J1ZmZlclBvcyArPSBuX2luO1xuXG4gICAgICAgICAgICAvKiB1cGRhdGUgbWZidWZbXSBjb3VudGVycyAqL1xuICAgICAgICAgICAgZ2ZjLm1mX3NpemUgKz0gbl9vdXQ7XG5cbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBsYW1lX2VuY29kZV9mbHVzaCBtYXkgaGF2ZSBzZXQgZ2ZjLm1mX3NhbXBsZV90b19lbmNvZGUgdG8gMCBzbyB3ZVxuICAgICAgICAgICAgICogaGF2ZSB0byByZWluaXRpYWxpemUgaXQgaGVyZSB3aGVuIHRoYXQgaGFwcGVuZWQuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGlmIChnZmMubWZfc2FtcGxlc190b19lbmNvZGUgPCAxKSB7XG4gICAgICAgICAgICAgICAgZ2ZjLm1mX3NhbXBsZXNfdG9fZW5jb2RlID0gRW5jb2Rlci5FTkNERUxBWSArIEVuY29kZXIuUE9TVERFTEFZO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZ2ZjLm1mX3NhbXBsZXNfdG9fZW5jb2RlICs9IG5fb3V0O1xuXG4gICAgICAgICAgICBpZiAoZ2ZjLm1mX3NpemUgPj0gbWZfbmVlZGVkKSB7XG4gICAgICAgICAgICAgICAgLyogZW5jb2RlIHRoZSBmcmFtZS4gKi9cbiAgICAgICAgICAgICAgICAvKiBtcDNidWYgPSBwb2ludGVyIHRvIGN1cnJlbnQgbG9jYXRpb24gaW4gYnVmZmVyICovXG4gICAgICAgICAgICAgICAgLyogbXAzYnVmX3NpemUgPSBzaXplIG9mIG9yaWdpbmFsIG1wMyBvdXRwdXQgYnVmZmVyICovXG4gICAgICAgICAgICAgICAgLyogPSAwIGlmIHdlIHNob3VsZCBub3Qgd29ycnkgYWJvdXQgdGhlICovXG4gICAgICAgICAgICAgICAgLyogYnVmZmVyIHNpemUgYmVjYXVzZSBjYWxsaW5nIHByb2dyYW0gaXMgKi9cbiAgICAgICAgICAgICAgICAvKiB0byBsYXp5IHRvIGNvbXB1dGUgaXQgKi9cbiAgICAgICAgICAgICAgICAvKiBtcDNzaXplID0gc2l6ZSBvZiBkYXRhIHdyaXR0ZW4gdG8gYnVmZmVyIHNvIGZhciAqL1xuICAgICAgICAgICAgICAgIC8qIG1wM2J1Zl9zaXplLW1wM3NpemUgPSBhbW91bnQgb2Ygc3BhY2UgYXZhbGFibGUgKi9cblxuICAgICAgICAgICAgICAgIHZhciBidWZfc2l6ZSA9IG1wM2J1Zl9zaXplIC0gbXAzc2l6ZTtcbiAgICAgICAgICAgICAgICBpZiAobXAzYnVmX3NpemUgPT0gMClcbiAgICAgICAgICAgICAgICAgICAgYnVmX3NpemUgPSAwO1xuXG4gICAgICAgICAgICAgICAgcmV0ID0gbGFtZV9lbmNvZGVfZnJhbWUoZ2ZwLCBtZmJ1ZlswXSwgbWZidWZbMV0sIG1wM2J1ZixcbiAgICAgICAgICAgICAgICAgICAgbXAzYnVmUG9zLCBidWZfc2l6ZSk7XG5cbiAgICAgICAgICAgICAgICBpZiAocmV0IDwgMClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJldDtcbiAgICAgICAgICAgICAgICBtcDNidWZQb3MgKz0gcmV0O1xuICAgICAgICAgICAgICAgIG1wM3NpemUgKz0gcmV0O1xuXG4gICAgICAgICAgICAgICAgLyogc2hpZnQgb3V0IG9sZCBzYW1wbGVzICovXG4gICAgICAgICAgICAgICAgZ2ZjLm1mX3NpemUgLT0gZ2ZwLmZyYW1lc2l6ZTtcbiAgICAgICAgICAgICAgICBnZmMubWZfc2FtcGxlc190b19lbmNvZGUgLT0gZ2ZwLmZyYW1lc2l6ZTtcbiAgICAgICAgICAgICAgICBmb3IgKGNoID0gMDsgY2ggPCBnZmMuY2hhbm5lbHNfb3V0OyBjaCsrKVxuICAgICAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgZ2ZjLm1mX3NpemU7IGkrKylcbiAgICAgICAgICAgICAgICAgICAgICAgIG1mYnVmW2NoXVtpXSA9IG1mYnVmW2NoXVtpICsgZ2ZwLmZyYW1lc2l6ZV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gbXAzc2l6ZTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBsYW1lX2VuY29kZV9mcmFtZShnZnAsIGluYnVmX2wsIGluYnVmX3IsIG1wM2J1ZiwgbXAzYnVmUG9zLCBtcDNidWZfc2l6ZSkge1xuICAgICAgICB2YXIgcmV0ID0gc2VsZi5lbmMubGFtZV9lbmNvZGVfbXAzX2ZyYW1lKGdmcCwgaW5idWZfbCwgaW5idWZfciwgbXAzYnVmLFxuICAgICAgICAgICAgbXAzYnVmUG9zLCBtcDNidWZfc2l6ZSk7XG4gICAgICAgIGdmcC5mcmFtZU51bSsrO1xuICAgICAgICByZXR1cm4gcmV0O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIEluT3V0KCkge1xuICAgICAgICB0aGlzLm5faW4gPSAwO1xuICAgICAgICB0aGlzLm5fb3V0ID0gMDtcbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIE51bVVzZWQoKSB7XG4gICAgICAgIHRoaXMubnVtX3VzZWQgPSAwO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEdyZWF0ZXN0IGNvbW1vbiBkaXZpc29yLlxuICAgICAqIDxwPlxuICAgICAqIEpvaW50IHdvcmsgb2YgRXVjbGlkIGFuZCBNLiBIZW5kcnlcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnY2QoaSwgaikge1xuICAgICAgICByZXR1cm4gaiAhPSAwID8gZ2NkKGosIGkgJSBqKSA6IGk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVzYW1wbGluZyB2aWEgRklSIGZpbHRlciwgYmxhY2ttYW4gd2luZG93LlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGJsYWNrbWFuKHgsIGZjbiwgbCkge1xuICAgICAgICAvKlxuICAgICAgICAgKiBUaGlzIGFsZ29yaXRobSBmcm9tOiBTSUdOQUwgUFJPQ0VTU0lORyBBTEdPUklUSE1TIElOIEZPUlRSQU4gQU5EIENcbiAgICAgICAgICogUy5ELiBTdGVhcm5zIGFuZCBSLkEuIERhdmlkLCBQcmVudGljZS1IYWxsLCAxOTkyXG4gICAgICAgICAqL1xuICAgICAgICB2YXIgd2NuID0gKE1hdGguUEkgKiBmY24pO1xuXG4gICAgICAgIHggLz0gbDtcbiAgICAgICAgaWYgKHggPCAwKVxuICAgICAgICAgICAgeCA9IDA7XG4gICAgICAgIGlmICh4ID4gMSlcbiAgICAgICAgICAgIHggPSAxO1xuICAgICAgICB2YXIgeDIgPSB4IC0gLjU7XG5cbiAgICAgICAgdmFyIGJrd24gPSAwLjQyIC0gMC41ICogTWF0aC5jb3MoMiAqIHggKiBNYXRoLlBJKSArIDAuMDggKiBNYXRoLmNvcyg0ICogeCAqIE1hdGguUEkpO1xuICAgICAgICBpZiAoTWF0aC5hYnMoeDIpIDwgMWUtOSlcbiAgICAgICAgICAgIHJldHVybiAod2NuIC8gTWF0aC5QSSk7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJldHVybiAoYmt3biAqIE1hdGguc2luKGwgKiB3Y24gKiB4MikgLyAoTWF0aC5QSSAqIGwgKiB4MikpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZpbGxfYnVmZmVyX3Jlc2FtcGxlKGdmcCwgb3V0YnVmLCBvdXRidWZQb3MsIGRlc2lyZWRfbGVuLCBpbmJ1ZiwgaW5fYnVmZmVyUG9zLCBsZW4sIG51bV91c2VkLCBjaCkge1xuICAgICAgICB2YXIgZ2ZjID0gZ2ZwLmludGVybmFsX2ZsYWdzO1xuICAgICAgICB2YXIgaSwgaiA9IDAsIGs7XG4gICAgICAgIC8qIG51bWJlciBvZiBjb252b2x1dGlvbiBmdW5jdGlvbnMgdG8gcHJlLWNvbXB1dGUgKi9cbiAgICAgICAgdmFyIGJwYyA9IGdmcC5vdXRfc2FtcGxlcmF0ZVxuICAgICAgICAgICAgLyBnY2QoZ2ZwLm91dF9zYW1wbGVyYXRlLCBnZnAuaW5fc2FtcGxlcmF0ZSk7XG4gICAgICAgIGlmIChicGMgPiBMYW1lSW50ZXJuYWxGbGFncy5CUEMpXG4gICAgICAgICAgICBicGMgPSBMYW1lSW50ZXJuYWxGbGFncy5CUEM7XG5cbiAgICAgICAgdmFyIGludHJhdGlvID0gKE1hdGguYWJzKGdmYy5yZXNhbXBsZV9yYXRpb1xuICAgICAgICAgICAgLSBNYXRoLmZsb29yKC41ICsgZ2ZjLnJlc2FtcGxlX3JhdGlvKSkgPCAuMDAwMSkgPyAxIDogMDtcbiAgICAgICAgdmFyIGZjbiA9IDEuMDAgLyBnZmMucmVzYW1wbGVfcmF0aW87XG4gICAgICAgIGlmIChmY24gPiAxLjAwKVxuICAgICAgICAgICAgZmNuID0gMS4wMDtcbiAgICAgICAgdmFyIGZpbHRlcl9sID0gMzE7XG4gICAgICAgIGlmICgwID09IGZpbHRlcl9sICUgMilcbiAgICAgICAgICAgIC0tZmlsdGVyX2w7XG4gICAgICAgIC8qIG11c3QgYmUgb2RkICovXG4gICAgICAgIGZpbHRlcl9sICs9IGludHJhdGlvO1xuICAgICAgICAvKiB1bmxlc3MgcmVzYW1wbGVfcmF0aW89aW50LCBpdCBtdXN0IGJlIGV2ZW4gKi9cblxuICAgICAgICB2YXIgQkxBQ0tTSVpFID0gZmlsdGVyX2wgKyAxO1xuICAgICAgICAvKiBzaXplIG9mIGRhdGEgbmVlZGVkIGZvciBGSVIgKi9cblxuICAgICAgICBpZiAoZ2ZjLmZpbGxfYnVmZmVyX3Jlc2FtcGxlX2luaXQgPT0gMCkge1xuICAgICAgICAgICAgZ2ZjLmluYnVmX29sZFswXSA9IG5ld19mbG9hdChCTEFDS1NJWkUpO1xuICAgICAgICAgICAgZ2ZjLmluYnVmX29sZFsxXSA9IG5ld19mbG9hdChCTEFDS1NJWkUpO1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8PSAyICogYnBjOyArK2kpXG4gICAgICAgICAgICAgICAgZ2ZjLmJsYWNrZmlsdFtpXSA9IG5ld19mbG9hdChCTEFDS1NJWkUpO1xuXG4gICAgICAgICAgICBnZmMuaXRpbWVbMF0gPSAwO1xuICAgICAgICAgICAgZ2ZjLml0aW1lWzFdID0gMDtcblxuICAgICAgICAgICAgLyogcHJlY29tcHV0ZSBibGFja21hbiBmaWx0ZXIgY29lZmZpY2llbnRzICovXG4gICAgICAgICAgICBmb3IgKGogPSAwOyBqIDw9IDIgKiBicGM7IGorKykge1xuICAgICAgICAgICAgICAgIHZhciBzdW0gPSAwLjtcbiAgICAgICAgICAgICAgICB2YXIgb2Zmc2V0ID0gKGogLSBicGMpIC8gKDIuICogYnBjKTtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDw9IGZpbHRlcl9sOyBpKyspXG4gICAgICAgICAgICAgICAgICAgIHN1bSArPSBnZmMuYmxhY2tmaWx0W2pdW2ldID0gYmxhY2ttYW4oaSAtIG9mZnNldCwgZmNuLFxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyX2wpO1xuICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPD0gZmlsdGVyX2w7IGkrKylcbiAgICAgICAgICAgICAgICAgICAgZ2ZjLmJsYWNrZmlsdFtqXVtpXSAvPSBzdW07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBnZmMuZmlsbF9idWZmZXJfcmVzYW1wbGVfaW5pdCA9IDE7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgaW5idWZfb2xkID0gZ2ZjLmluYnVmX29sZFtjaF07XG5cbiAgICAgICAgLyogdGltZSBvZiBqJ3RoIGVsZW1lbnQgaW4gaW5idWYgPSBpdGltZSArIGovaWZyZXE7ICovXG4gICAgICAgIC8qIHRpbWUgb2Ygayd0aCBlbGVtZW50IGluIG91dGJ1ZiA9IGovb2ZyZXEgKi9cbiAgICAgICAgZm9yIChrID0gMDsgayA8IGRlc2lyZWRfbGVuOyBrKyspIHtcbiAgICAgICAgICAgIHZhciB0aW1lMDtcbiAgICAgICAgICAgIHZhciBqb2ZmO1xuXG4gICAgICAgICAgICB0aW1lMCA9IGsgKiBnZmMucmVzYW1wbGVfcmF0aW87XG4gICAgICAgICAgICAvKiB0aW1lIG9mIGsndGggb3V0cHV0IHNhbXBsZSAqL1xuICAgICAgICAgICAgaiA9IDAgfCBNYXRoLmZsb29yKHRpbWUwIC0gZ2ZjLml0aW1lW2NoXSk7XG5cbiAgICAgICAgICAgIC8qIGNoZWNrIGlmIHdlIG5lZWQgbW9yZSBpbnB1dCBkYXRhICovXG4gICAgICAgICAgICBpZiAoKGZpbHRlcl9sICsgaiAtIGZpbHRlcl9sIC8gMikgPj0gbGVuKVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAvKiBibGFja21hbiBmaWx0ZXIuIGJ5IGRlZmF1bHQsIHdpbmRvdyBjZW50ZXJlZCBhdCBqKy41KGZpbHRlcl9sJTIpICovXG4gICAgICAgICAgICAvKiBidXQgd2Ugd2FudCBhIHdpbmRvdyBjZW50ZXJlZCBhdCB0aW1lMC4gKi9cbiAgICAgICAgICAgIHZhciBvZmZzZXQgPSAodGltZTAgLSBnZmMuaXRpbWVbY2hdIC0gKGogKyAuNSAqIChmaWx0ZXJfbCAlIDIpKSk7XG5cbiAgICAgICAgICAgIC8qIGZpbmQgdGhlIGNsb3Nlc3QgcHJlY29tcHV0ZWQgd2luZG93IGZvciB0aGlzIG9mZnNldDogKi9cbiAgICAgICAgICAgIGpvZmYgPSAwIHwgTWF0aC5mbG9vcigob2Zmc2V0ICogMiAqIGJwYykgKyBicGMgKyAuNSk7XG4gICAgICAgICAgICB2YXIgeHZhbHVlID0gMC47XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDw9IGZpbHRlcl9sOyArK2kpIHtcbiAgICAgICAgICAgICAgICB2YXIgajIgPSBpICsgaiAtIGZpbHRlcl9sIC8gMjtcbiAgICAgICAgICAgICAgICB2YXIgeTtcbiAgICAgICAgICAgICAgICB5ID0gKGoyIDwgMCkgPyBpbmJ1Zl9vbGRbQkxBQ0tTSVpFICsgajJdIDogaW5idWZbaW5fYnVmZmVyUG9zXG4gICAgICAgICAgICAgICAgKyBqMl07XG4gICAgICAgICAgICAgICAgeHZhbHVlICs9IHkgKiBnZmMuYmxhY2tmaWx0W2pvZmZdW2ldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgb3V0YnVmW291dGJ1ZlBvcyArIGtdID0geHZhbHVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogayA9IG51bWJlciBvZiBzYW1wbGVzIGFkZGVkIHRvIG91dGJ1ZiAqL1xuICAgICAgICAvKiBsYXN0IGsgc2FtcGxlIHVzZWQgZGF0YSBmcm9tIFtqLWZpbHRlcl9sLzIsaitmaWx0ZXJfbC1maWx0ZXJfbC8yXSAqL1xuXG4gICAgICAgIC8qIGhvdyBtYW55IHNhbXBsZXMgb2YgaW5wdXQgZGF0YSB3ZXJlIHVzZWQ6ICovXG4gICAgICAgIG51bV91c2VkLm51bV91c2VkID0gTWF0aC5taW4obGVuLCBmaWx0ZXJfbCArIGogLSBmaWx0ZXJfbCAvIDIpO1xuXG4gICAgICAgIC8qXG4gICAgICAgICAqIGFkanVzdCBvdXIgaW5wdXQgdGltZSBjb3VudGVyLiBJbmNyaW1lbnQgYnkgdGhlIG51bWJlciBvZiBzYW1wbGVzXG4gICAgICAgICAqIHVzZWQsIHRoZW4gbm9ybWFsaXplIHNvIHRoYXQgbmV4dCBvdXRwdXQgc2FtcGxlIGlzIGF0IHRpbWUgMCwgbmV4dFxuICAgICAgICAgKiBpbnB1dCBidWZmZXIgaXMgYXQgdGltZSBpdGltZVtjaF1cbiAgICAgICAgICovXG4gICAgICAgIGdmYy5pdGltZVtjaF0gKz0gbnVtX3VzZWQubnVtX3VzZWQgLSBrICogZ2ZjLnJlc2FtcGxlX3JhdGlvO1xuXG4gICAgICAgIC8qIHNhdmUgdGhlIGxhc3QgQkxBQ0tTSVpFIHNhbXBsZXMgaW50byB0aGUgaW5idWZfb2xkIGJ1ZmZlciAqL1xuICAgICAgICBpZiAobnVtX3VzZWQubnVtX3VzZWQgPj0gQkxBQ0tTSVpFKSB7XG4gICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgQkxBQ0tTSVpFOyBpKyspXG4gICAgICAgICAgICAgICAgaW5idWZfb2xkW2ldID0gaW5idWZbaW5fYnVmZmVyUG9zICsgbnVtX3VzZWQubnVtX3VzZWQgKyBpXG4gICAgICAgICAgICAgICAgLSBCTEFDS1NJWkVdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLyogc2hpZnQgaW4gbnVtX3VzZWQubnVtX3VzZWQgc2FtcGxlcyBpbnRvIGluYnVmX29sZCAqL1xuICAgICAgICAgICAgdmFyIG5fc2hpZnQgPSBCTEFDS1NJWkUgLSBudW1fdXNlZC5udW1fdXNlZDtcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgKiBudW1iZXIgb2Ygc2FtcGxlcyB0b1xuICAgICAgICAgICAgICogc2hpZnRcbiAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgICogc2hpZnQgbl9zaGlmdCBzYW1wbGVzIGJ5IG51bV91c2VkLm51bV91c2VkLCB0byBtYWtlIHJvb20gZm9yIHRoZVxuICAgICAgICAgICAgICogbnVtX3VzZWQgbmV3IHNhbXBsZXNcbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG5fc2hpZnQ7ICsraSlcbiAgICAgICAgICAgICAgICBpbmJ1Zl9vbGRbaV0gPSBpbmJ1Zl9vbGRbaSArIG51bV91c2VkLm51bV91c2VkXTtcblxuICAgICAgICAgICAgLyogc2hpZnQgaW4gdGhlIG51bV91c2VkLm51bV91c2VkIHNhbXBsZXMgKi9cbiAgICAgICAgICAgIGZvciAoaiA9IDA7IGkgPCBCTEFDS1NJWkU7ICsraSwgKytqKVxuICAgICAgICAgICAgICAgIGluYnVmX29sZFtpXSA9IGluYnVmW2luX2J1ZmZlclBvcyArIGpdO1xuXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGs7XG4gICAgICAgIC8qIHJldHVybiB0aGUgbnVtYmVyIHNhbXBsZXMgY3JlYXRlZCBhdCB0aGUgbmV3IHNhbXBsZXJhdGUgKi9cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmaWxsX2J1ZmZlcihnZnAsIG1mYnVmLCBpbl9idWZmZXIsIGluX2J1ZmZlclBvcywgbnNhbXBsZXMsIGlvKSB7XG4gICAgICAgIHZhciBnZmMgPSBnZnAuaW50ZXJuYWxfZmxhZ3M7XG5cbiAgICAgICAgLyogY29weSBpbiBuZXcgc2FtcGxlcyBpbnRvIG1mYnVmLCB3aXRoIHJlc2FtcGxpbmcgaWYgbmVjZXNzYXJ5ICovXG4gICAgICAgIGlmICgoZ2ZjLnJlc2FtcGxlX3JhdGlvIDwgLjk5OTkpIHx8IChnZmMucmVzYW1wbGVfcmF0aW8gPiAxLjAwMDEpKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBjaCA9IDA7IGNoIDwgZ2ZjLmNoYW5uZWxzX291dDsgY2grKykge1xuICAgICAgICAgICAgICAgIHZhciBudW1Vc2VkID0gbmV3IE51bVVzZWQoKTtcbiAgICAgICAgICAgICAgICBpby5uX291dCA9IGZpbGxfYnVmZmVyX3Jlc2FtcGxlKGdmcCwgbWZidWZbY2hdLCBnZmMubWZfc2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgZ2ZwLmZyYW1lc2l6ZSwgaW5fYnVmZmVyW2NoXSwgaW5fYnVmZmVyUG9zLCBuc2FtcGxlcyxcbiAgICAgICAgICAgICAgICAgICAgbnVtVXNlZCwgY2gpO1xuICAgICAgICAgICAgICAgIGlvLm5faW4gPSBudW1Vc2VkLm51bV91c2VkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaW8ubl9vdXQgPSBNYXRoLm1pbihnZnAuZnJhbWVzaXplLCBuc2FtcGxlcyk7XG4gICAgICAgICAgICBpby5uX2luID0gaW8ubl9vdXQ7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGlvLm5fb3V0OyArK2kpIHtcbiAgICAgICAgICAgICAgICBtZmJ1ZlswXVtnZmMubWZfc2l6ZSArIGldID0gaW5fYnVmZmVyWzBdW2luX2J1ZmZlclBvcyArIGldO1xuICAgICAgICAgICAgICAgIGlmIChnZmMuY2hhbm5lbHNfb3V0ID09IDIpXG4gICAgICAgICAgICAgICAgICAgIG1mYnVmWzFdW2dmYy5tZl9zaXplICsgaV0gPSBpbl9idWZmZXJbMV1baW5fYnVmZmVyUG9zICsgaV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbn1cblxuXG5cbmZ1bmN0aW9uIEdldEF1ZGlvKCkge1xuICAgIHZhciBwYXJzZTtcbiAgICB2YXIgbXBnO1xuXG4gICAgdGhpcy5zZXRNb2R1bGVzID0gZnVuY3Rpb24gKHBhcnNlMiwgbXBnMikge1xuICAgICAgICBwYXJzZSA9IHBhcnNlMjtcbiAgICAgICAgbXBnID0gbXBnMjtcbiAgICB9XG59XG5cblxuZnVuY3Rpb24gUGFyc2UoKSB7XG4gICAgdmFyIHZlcjtcbiAgICB2YXIgaWQzO1xuICAgIHZhciBwcmU7XG5cbiAgICB0aGlzLnNldE1vZHVsZXMgPSBmdW5jdGlvbiAodmVyMiwgaWQzMiwgcHJlMikge1xuICAgICAgICB2ZXIgPSB2ZXIyO1xuICAgICAgICBpZDMgPSBpZDMyO1xuICAgICAgICBwcmUgPSBwcmUyO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gTVBHTGliKCkge1xufVxuXG5mdW5jdGlvbiBJRDNUYWcoKSB7XG4gICAgdmFyIGJpdHM7XG4gICAgdmFyIHZlcjtcblxuICAgIHRoaXMuc2V0TW9kdWxlcyA9IGZ1bmN0aW9uIChfYml0cywgX3Zlcikge1xuICAgICAgICBiaXRzID0gX2JpdHM7XG4gICAgICAgIHZlciA9IF92ZXI7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBNcDNFbmNvZGVyKGNoYW5uZWxzLCBzYW1wbGVyYXRlLCBrYnBzKSB7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggIT0gMykge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdXQVJOOiBNcDNFbmNvZGVyKGNoYW5uZWxzLCBzYW1wbGVyYXRlLCBrYnBzKSBub3Qgc3BlY2lmaWVkJyk7XG4gICAgICAgIGNoYW5uZWxzID0gMTtcbiAgICAgICAgc2FtcGxlcmF0ZSA9IDQ0MTAwO1xuICAgICAgICBrYnBzID0gMTI4O1xuICAgIH1cbiAgICB2YXIgbGFtZSA9IG5ldyBMYW1lKCk7XG4gICAgdmFyIGdhdWQgPSBuZXcgR2V0QXVkaW8oKTtcbiAgICB2YXIgZ2EgPSBuZXcgR2FpbkFuYWx5c2lzKCk7XG4gICAgdmFyIGJzID0gbmV3IEJpdFN0cmVhbSgpO1xuICAgIHZhciBwID0gbmV3IFByZXNldHMoKTtcbiAgICB2YXIgcXVwdnQgPSBuZXcgUXVhbnRpemVQVlQoKTtcbiAgICB2YXIgcXUgPSBuZXcgUXVhbnRpemUoKTtcbiAgICB2YXIgdmJyID0gbmV3IFZCUlRhZygpO1xuICAgIHZhciB2ZXIgPSBuZXcgVmVyc2lvbigpO1xuICAgIHZhciBpZDMgPSBuZXcgSUQzVGFnKCk7XG4gICAgdmFyIHJ2ID0gbmV3IFJlc2Vydm9pcigpO1xuICAgIHZhciB0YWsgPSBuZXcgVGFrZWhpcm8oKTtcbiAgICB2YXIgcGFyc2UgPSBuZXcgUGFyc2UoKTtcbiAgICB2YXIgbXBnID0gbmV3IE1QR0xpYigpO1xuXG4gICAgbGFtZS5zZXRNb2R1bGVzKGdhLCBicywgcCwgcXVwdnQsIHF1LCB2YnIsIHZlciwgaWQzLCBtcGcpO1xuICAgIGJzLnNldE1vZHVsZXMoZ2EsIG1wZywgdmVyLCB2YnIpO1xuICAgIGlkMy5zZXRNb2R1bGVzKGJzLCB2ZXIpO1xuICAgIHAuc2V0TW9kdWxlcyhsYW1lKTtcbiAgICBxdS5zZXRNb2R1bGVzKGJzLCBydiwgcXVwdnQsIHRhayk7XG4gICAgcXVwdnQuc2V0TW9kdWxlcyh0YWssIHJ2LCBsYW1lLmVuYy5wc3kpO1xuICAgIHJ2LnNldE1vZHVsZXMoYnMpO1xuICAgIHRhay5zZXRNb2R1bGVzKHF1cHZ0KTtcbiAgICB2YnIuc2V0TW9kdWxlcyhsYW1lLCBicywgdmVyKTtcbiAgICBnYXVkLnNldE1vZHVsZXMocGFyc2UsIG1wZyk7XG4gICAgcGFyc2Uuc2V0TW9kdWxlcyh2ZXIsIGlkMywgcCk7XG5cbiAgICB2YXIgZ2ZwID0gbGFtZS5sYW1lX2luaXQoKTtcblxuICAgIGdmcC5udW1fY2hhbm5lbHMgPSBjaGFubmVscztcbiAgICBnZnAuaW5fc2FtcGxlcmF0ZSA9IHNhbXBsZXJhdGU7XG4gICAgZ2ZwLm91dF9zYW1wbGVyYXRlID0gc2FtcGxlcmF0ZTsvL2ZpeCBieSB4aWFuZ3l1ZWNuIDIwMTgtMTItNiAwMTo0ODoxMiA2NGticHPku6XkuIvlj6/og73ml6Dlo7Dpn7PvvIzmiYvliqjmjqfliLbovpPlh7rnoIHnjodcbiAgICBnZnAuYnJhdGUgPSBrYnBzO1xuICAgIGdmcC5tb2RlID0gTVBFR01vZGUuU1RFUkVPO1xuICAgIGdmcC5xdWFsaXR5ID0gMztcbiAgICBnZnAuYldyaXRlVmJyVGFnID0gZmFsc2U7XG4gICAgZ2ZwLmRpc2FibGVfcmVzZXJ2b2lyID0gdHJ1ZTtcbiAgICBnZnAud3JpdGVfaWQzdGFnX2F1dG9tYXRpYyA9IGZhbHNlO1xuXG4gICAgdmFyIHJldGNvZGUgPSBsYW1lLmxhbWVfaW5pdF9wYXJhbXMoZ2ZwKTtcbiAgICB2YXIgbWF4U2FtcGxlcyA9IDExNTI7XG4gICAgdmFyIG1wM2J1Zl9zaXplID0gMCB8ICgxLjI1ICogbWF4U2FtcGxlcyArIDcyMDApO1xuICAgIHZhciBtcDNidWYgPSBuZXdfYnl0ZShtcDNidWZfc2l6ZSk7XG5cbiAgICB0aGlzLmVuY29kZUJ1ZmZlciA9IGZ1bmN0aW9uIChsZWZ0LCByaWdodCkge1xuICAgICAgICBpZiAoY2hhbm5lbHMgPT0gMSkge1xuICAgICAgICAgICAgcmlnaHQgPSBsZWZ0O1xuICAgICAgICB9XG4gICAgICAgIGlmIChsZWZ0Lmxlbmd0aCA+IG1heFNhbXBsZXMpIHtcbiAgICAgICAgICAgIG1heFNhbXBsZXMgPSBsZWZ0Lmxlbmd0aDtcbiAgICAgICAgICAgIG1wM2J1Zl9zaXplID0gMCB8ICgxLjI1ICogbWF4U2FtcGxlcyArIDcyMDApO1xuICAgICAgICAgICAgbXAzYnVmID0gbmV3X2J5dGUobXAzYnVmX3NpemUpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIF9zeiA9IGxhbWUubGFtZV9lbmNvZGVfYnVmZmVyKGdmcCwgbGVmdCwgcmlnaHQsIGxlZnQubGVuZ3RoLCBtcDNidWYsIDAsIG1wM2J1Zl9zaXplKTtcbiAgICAgICAgcmV0dXJuIG5ldyBJbnQ4QXJyYXkobXAzYnVmLnN1YmFycmF5KDAsIF9zeikpO1xuICAgIH07XG5cbiAgICB0aGlzLmZsdXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3N6ID0gbGFtZS5sYW1lX2VuY29kZV9mbHVzaChnZnAsIG1wM2J1ZiwgMCwgbXAzYnVmX3NpemUpO1xuICAgICAgICByZXR1cm4gbmV3IEludDhBcnJheShtcDNidWYuc3ViYXJyYXkoMCwgX3N6KSk7XG4gICAgfTtcbn1cblxuLy9maXgg57K+566AXG5MM1NpZGUuU0ZCTUFYID0gKEVuY29kZXIuU0JNQVhfcyAqIDMpO1xuLy90ZXN0RnVsbExlbmd0aCgpO1xubGFtZWpzLk1wM0VuY29kZXIgPSBNcDNFbmNvZGVyO1xufVxuLy9mcz1yZXF1aXJlKCdmcycpO1xubGFtZWpzKCk7XG5cblxuUmVjb3JkZXIubGFtZWpzPWxhbWVqcztcblxuLy9lbmQzICoqKirnu5PmnZ9jb3B5IGxhbWVqcyoqKioqXG59KSgpOyIsIi8qXG5tcDPnvJbnoIHlmajvvIzpnIDluKbkuIptcDMtZW5naW5lLmpz5byV5pOO5L2/55SoXG5odHRwczovL2dpdGh1Yi5jb20veGlhbmd5dWVjbi9SZWNvcmRlclxuXG7lvZPnhLbmnIDkvbPmjqjojZDkvb/nlKhtcDPjgIF3YXbmoLzlvI/vvIzku6PnoIHkuZ/mmK/kvJjlhYjnhafpob7ov5nkuKTnp43moLzlvI9cbua1j+iniOWZqOaUr+aMgeaDheWGtVxuaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSFRNTC9TdXBwb3J0ZWRfbWVkaWFfZm9ybWF0c1xuKi9cbihmdW5jdGlvbigpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblJlY29yZGVyLnByb3RvdHlwZS5lbmNfbXAzPXtcblx0c3RhYmxlOnRydWVcblx0LHRlc3Rtc2c6XCLph4fmoLfnjofojIPlm7Q0ODAwMCwgNDQxMDAsIDMyMDAwLCAyNDAwMCwgMjIwNTAsIDE2MDAwLCAxMjAwMCwgMTEwMjUsIDgwMDBcIlxufTtcblxuXG5cbi8vKioqKioqKuagh+WHhlVJ57q/56iL6L2s56CB5pSv5oyB5Ye95pWwKioqKioqKioqKioqXG5cblJlY29yZGVyLnByb3RvdHlwZS5tcDM9ZnVuY3Rpb24ocmVzLFRydWUsRmFsc2Upe1xuXHRcdHZhciBUaGlzPXRoaXMsc2V0PVRoaXMuc2V0LHNpemU9cmVzLmxlbmd0aDtcblx0XHRcblx0XHQvL+S8mOWFiOmHh+eUqHdvcmtlcue8luegge+8jOWkquS9jueJiOacrOS4i+mdoueUqOiAgeaWueazleaPkOS+m+WFvOWuuVxuXHRcdHZhciBjdHg9VGhpcy5tcDNfc3RhcnQoc2V0KTtcblx0XHRpZihjdHgpe1xuXHRcdFx0VGhpcy5tcDNfZW5jb2RlKGN0eCxyZXMpO1xuXHRcdFx0VGhpcy5tcDNfY29tcGxldGUoY3R4LFRydWUsRmFsc2UsMSk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fTtcblx0XHRcblx0XHQvL2h0dHBzOi8vZ2l0aHViLmNvbS93YW5ncGVuZ2ZlaTE1OTc1L3JlY29yZGVyLmpzXG5cdFx0Ly9odHRwczovL2dpdGh1Yi5jb20vemh1a2VyL2xhbWVqcyBidWc66YeH5qC3546H5b+F6aG75ZKM5rqQ5LiA6Ie077yM5LiN54S2OGvml7bmsqHmnInlo7Dpn7PvvIzmnInpl67pophmaXjvvJpodHRwczovL2dpdGh1Yi5jb20vemh1a2VyL2xhbWVqcy9wdWxsLzExXG5cdFx0dmFyIG1wMz1uZXcgUmVjb3JkZXIubGFtZWpzLk1wM0VuY29kZXIoMSxzZXQuc2FtcGxlUmF0ZSxzZXQuYml0UmF0ZSk7XG5cdFx0XG5cdFx0dmFyIGJsb2NrU2l6ZT01NzYwMDtcblx0XHR2YXIgZGF0YT1bXTtcblx0XHRcblx0XHR2YXIgaWR4PTAsbXAzU2l6ZT0wO1xuXHRcdHZhciBydW49ZnVuY3Rpb24oKXtcblx0XHRcdGlmKGlkeDxzaXplKXtcblx0XHRcdFx0dmFyIGJ1Zj1tcDMuZW5jb2RlQnVmZmVyKHJlcy5zdWJhcnJheShpZHgsaWR4K2Jsb2NrU2l6ZSkpO1xuXHRcdFx0XHRpZihidWYubGVuZ3RoPjApe1xuXHRcdFx0XHRcdG1wM1NpemUrPWJ1Zi5idWZmZXIuYnl0ZUxlbmd0aDtcblx0XHRcdFx0XHRkYXRhLnB1c2goYnVmLmJ1ZmZlcik7XG5cdFx0XHRcdH07XG5cdFx0XHRcdGlkeCs9YmxvY2tTaXplO1xuXHRcdFx0XHRzZXRUaW1lb3V0KHJ1bik7Ly/lsL3ph4/pgb/lhY3ljaF1aVxuXHRcdFx0fWVsc2V7XG5cdFx0XHRcdHZhciBidWY9bXAzLmZsdXNoKCk7XG5cdFx0XHRcdGlmKGJ1Zi5sZW5ndGg+MCl7XG5cdFx0XHRcdFx0bXAzU2l6ZSs9YnVmLmJ1ZmZlci5ieXRlTGVuZ3RoO1xuXHRcdFx0XHRcdGRhdGEucHVzaChidWYuYnVmZmVyKTtcblx0XHRcdFx0fTtcblx0XHRcdFx0XG5cdFx0XHRcdC8v5Y675o6J5byA5aS055qE5qCH6K6w5L+h5oGv5binXG5cdFx0XHRcdHZhciBtZXRhPW1wM1RyaW1GaXguZm4oZGF0YSxtcDNTaXplLHNpemUsc2V0LnNhbXBsZVJhdGUpO1xuXHRcdFx0XHRtcDNUcmltRml4U2V0TWV0YShtZXRhLHNldCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRUcnVlKG5ldyBCbG9iKGRhdGEse3R5cGU6XCJhdWRpby9tcDNcIn0pKTtcblx0XHRcdH07XG5cdFx0fTtcblx0XHRydW4oKTtcblx0fVxuXG5cbi8vKioqKioqKirovrnlvZXovrnovaznoIEoV29ya2VyKeaUr+aMgeWHveaVsO+8jOWmguaenOaPkOS+m+WwseS7o+ihqOWPr+iDveaUr+aMge+8jOWQpuWImeWPquaUr+aMgeagh+WHhui9rOeggSoqKioqKioqKlxuXG4vL+WFqOWxgOWFseS6q+S4gOS4qldvcmtlcu+8jOWQjuWPsOS4suihjOaJp+ihjOOAguWmguaenOavj+asoemDveW8gOS4gOS4quaWsOeahO+8jOe8lueggemAn+W6puWPr+iDveS8muaFouW+iOWkmu+8jOWPr+iDveaYr+a1j+iniOWZqOi/kOihjOe8k+WtmOeahOWboOe0oO+8jOW5tuS4lOWPr+iDveeerOmXtOS6p+eUn+WkmuS4quW5tuihjOaTjeS9nOWNoOeUqOWkp+mHj2NwdVxudmFyIG1wM1dvcmtlcjtcblJlY29yZGVyLkJpbmREZXN0cm95KFwibXAzV29ya2VyXCIsZnVuY3Rpb24oKXtcblx0Y29uc29sZS5sb2coXCJtcDNXb3JrZXIgRGVzdHJveVwiKTtcblx0bXAzV29ya2VyJiZtcDNXb3JrZXIudGVybWluYXRlKCk7XG5cdG1wM1dvcmtlcj1udWxsO1xufSk7XG5cblxuUmVjb3JkZXIucHJvdG90eXBlLm1wM19lbnZDaGVjaz1mdW5jdGlvbihlbnZJbmZvLHNldCl7Ly/mo4Dmn6Xnjq/looPkuIvphY3nva7mmK/lkKblj6/nlKhcblx0dmFyIGVyck1zZz1cIlwiO1xuXHQvL+mcgOimgeWunuaXtue8lueggei/lOWbnuaVsOaNru+8jOatpOaXtumcgOimgeajgOafpeeOr+Wig+aYr+WQpuacieWunuaXtueJueaAp+OAgeWSjOaYr+WQpuWPr+WunuaXtue8lueggVxuXHRpZihzZXQudGFrZW9mZkVuY29kZUNodW5rKXtcblx0XHRpZighZW52SW5mby5jYW5Qcm9jZXNzKXtcblx0XHRcdGVyck1zZz1lbnZJbmZvLmVudk5hbWUrXCLnjq/looPkuI3mlK/mjIHlrp7ml7blpITnkIZcIjtcblx0XHR9ZWxzZSBpZighbmV3Q29udGV4dCgpKXsvL+a1j+iniOWZqOS4jeiDveWIm+W7uuWunuaXtue8lueggeeOr+Wig1xuXHRcdFx0ZXJyTXNnPVwi5b2T5YmN5rWP6KeI5Zmo54mI5pys5aSq5L2O77yM5peg5rOV5a6e5pe25aSE55CGXCI7XG5cdFx0fTtcblx0fTtcblx0cmV0dXJuIGVyck1zZztcbn07XG5SZWNvcmRlci5wcm90b3R5cGUubXAzX3N0YXJ0PWZ1bmN0aW9uKHNldCl7Ly/lpoLmnpzov5Tlm55udWxs5Luj6KGo5LiN5pSv5oyBXG5cdHJldHVybiBuZXdDb250ZXh0KHNldCk7XG59O1xudmFyIG9wZW5MaXN0PXtpZDowfTtcbnZhciBuZXdDb250ZXh0PWZ1bmN0aW9uKHNldE9yTnVsbCl7XG5cdHZhciB3b3JrZXI9bXAzV29ya2VyO1xuXHR0cnl7XG5cdFx0aWYoIXdvcmtlcil7XG5cdFx0XHR2YXIgb25tc2c9ZnVuY3Rpb24oZSl7XG5cdFx0XHRcdHZhciBlZD1lLmRhdGE7XG5cdFx0XHRcdHZhciBjdXI9d2tfY3R4c1tlZC5pZF07XG5cdFx0XHRcdGlmKGVkLmFjdGlvbj09XCJpbml0XCIpe1xuXHRcdFx0XHRcdHdrX2N0eHNbZWQuaWRdPXtcblx0XHRcdFx0XHRcdHNhbXBsZVJhdGU6ZWQuc2FtcGxlUmF0ZVxuXHRcdFx0XHRcdFx0LGJpdFJhdGU6ZWQuYml0UmF0ZVxuXHRcdFx0XHRcdFx0LHRha2VvZmY6ZWQudGFrZW9mZlxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQsbXAzU2l6ZTowXG5cdFx0XHRcdFx0XHQscGNtU2l6ZTowXG5cdFx0XHRcdFx0XHQsZW5jQXJyOltdXG5cdFx0XHRcdFx0XHQsZW5jT2JqOm5ldyB3a19sYW1lLk1wM0VuY29kZXIoMSxlZC5zYW1wbGVSYXRlLGVkLmJpdFJhdGUpXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fWVsc2UgaWYoIWN1cil7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9O1xuXHRcdFx0XHRcblx0XHRcdFx0c3dpdGNoKGVkLmFjdGlvbil7XG5cdFx0XHRcdGNhc2UgXCJzdG9wXCI6XG5cdFx0XHRcdFx0Y3VyLmVuY09iaj1udWxsO1xuXHRcdFx0XHRcdGRlbGV0ZSB3a19jdHhzW2VkLmlkXTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBcImVuY29kZVwiOlxuXHRcdFx0XHRcdGN1ci5wY21TaXplKz1lZC5wY20ubGVuZ3RoO1xuXHRcdFx0XHRcdHZhciBidWY9Y3VyLmVuY09iai5lbmNvZGVCdWZmZXIoZWQucGNtKTtcblx0XHRcdFx0XHRpZihidWYubGVuZ3RoPjApe1xuXHRcdFx0XHRcdFx0aWYoY3VyLnRha2VvZmYpe1xuXHRcdFx0XHRcdFx0XHRzZWxmLnBvc3RNZXNzYWdlKHthY3Rpb246XCJ0YWtlb2ZmXCIsaWQ6ZWQuaWQsY2h1bms6YnVmfSk7XG5cdFx0XHRcdFx0XHR9ZWxzZXtcblx0XHRcdFx0XHRcdFx0Y3VyLm1wM1NpemUrPWJ1Zi5idWZmZXIuYnl0ZUxlbmd0aDtcblx0XHRcdFx0XHRcdFx0Y3VyLmVuY0Fyci5wdXNoKGJ1Zi5idWZmZXIpO1xuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwiY29tcGxldGVcIjpcblx0XHRcdFx0XHR2YXIgYnVmPWN1ci5lbmNPYmouZmx1c2goKTtcblx0XHRcdFx0XHRpZihidWYubGVuZ3RoPjApe1xuXHRcdFx0XHRcdFx0aWYoY3VyLnRha2VvZmYpe1xuXHRcdFx0XHRcdFx0XHRzZWxmLnBvc3RNZXNzYWdlKHthY3Rpb246XCJ0YWtlb2ZmXCIsaWQ6ZWQuaWQsY2h1bms6YnVmfSk7XG5cdFx0XHRcdFx0XHR9ZWxzZXtcblx0XHRcdFx0XHRcdFx0Y3VyLm1wM1NpemUrPWJ1Zi5idWZmZXIuYnl0ZUxlbmd0aDtcblx0XHRcdFx0XHRcdFx0Y3VyLmVuY0Fyci5wdXNoKGJ1Zi5idWZmZXIpO1xuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8v5Y675o6J5byA5aS055qE5qCH6K6w5L+h5oGv5binXG5cdFx0XHRcdFx0dmFyIG1ldGE9d2tfbXAzVHJpbUZpeC5mbihjdXIuZW5jQXJyLGN1ci5tcDNTaXplLGN1ci5wY21TaXplLGN1ci5zYW1wbGVSYXRlKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRzZWxmLnBvc3RNZXNzYWdlKHtcblx0XHRcdFx0XHRcdGFjdGlvbjplZC5hY3Rpb25cblx0XHRcdFx0XHRcdCxpZDplZC5pZFxuXHRcdFx0XHRcdFx0LGJsb2I6bmV3IEJsb2IoY3VyLmVuY0Fycix7dHlwZTpcImF1ZGlvL21wM1wifSlcblx0XHRcdFx0XHRcdCxtZXRhOm1ldGFcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0fTtcblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdC8v5Yib5bu65LiA5Liq5pawV29ya2VyXG5cdFx0XHR2YXIganNDb2RlPVwiKTt3a19sYW1lKCk7dmFyIHdrX2N0eHM9e307c2VsZi5vbm1lc3NhZ2U9XCIrb25tc2c7XG5cdFx0XHRqc0NvZGUrPVwiO3ZhciB3a19tcDNUcmltRml4PXtybTpcIittcDNUcmltRml4LnJtK1wiLGZuOlwiK21wM1RyaW1GaXguZm4rXCJ9XCI7XG5cdFx0XHRcblx0XHRcdHZhciBsYW1lanNDb2RlPVJlY29yZGVyLmxhbWVqcy50b1N0cmluZygpO1xuXHRcdFx0dmFyIHVybD0od2luZG93LlVSTHx8d2Via2l0VVJMKS5jcmVhdGVPYmplY3RVUkwobmV3IEJsb2IoW1widmFyIHdrX2xhbWU9KFwiLGxhbWVqc0NvZGUsanNDb2RlXSwge3R5cGU6XCJ0ZXh0L2phdmFzY3JpcHRcIn0pKTtcblx0XHRcdFxuXHRcdFx0d29ya2VyPW5ldyBXb3JrZXIodXJsKTtcblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcblx0XHRcdFx0KHdpbmRvdy5VUkx8fHdlYmtpdFVSTCkucmV2b2tlT2JqZWN0VVJMKHVybCk7Ly/lv4XpobvopoHph4rmlL7vvIzkuI3nhLbmr4/mrKHosIPnlKjlhoXlrZjpg73mmI7mmL7ms4TpnLLlhoXlrZhcblx0XHRcdH0sMTAwMDApOy8vY2hyb21lIDgzIGZpbGXljY/orq7kuIvlpoLmnpznm7TmjqXph4rmlL7vvIzlsIbkvJrkvb9XZWJXb3JrZXLml6Dms5XlkK/liqhcblx0XHRcdFxuXHRcdFx0d29ya2VyLm9ubWVzc2FnZT1mdW5jdGlvbihlKXtcblx0XHRcdFx0dmFyIGRhdGE9ZS5kYXRhO1xuXHRcdFx0XHR2YXIgY3R4PW9wZW5MaXN0W2RhdGEuaWRdO1xuXHRcdFx0XHRpZihjdHgpe1xuXHRcdFx0XHRcdGlmKGRhdGEuYWN0aW9uPT1cInRha2VvZmZcIil7XG5cdFx0XHRcdFx0XHQvL+WPlui1sOWunuaXtueUn+aIkOeahG1wM+aVsOaNrlxuXHRcdFx0XHRcdFx0Y3R4LnNldC50YWtlb2ZmRW5jb2RlQ2h1bmsobmV3IFVpbnQ4QXJyYXkoZGF0YS5jaHVuay5idWZmZXIpKTtcblx0XHRcdFx0XHR9ZWxzZXtcblx0XHRcdFx0XHRcdC8vY29tcGxldGVcblx0XHRcdFx0XHRcdGN0eC5jYWxsJiZjdHguY2FsbChkYXRhKTtcblx0XHRcdFx0XHRcdGN0eC5jYWxsPW51bGw7XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fTtcblx0XHRcdH07XG5cdFx0fTtcblx0XHRcblx0XHR2YXIgY3R4PXt3b3JrZXI6d29ya2VyLHNldDpzZXRPck51bGwsdGFrZW9mZlF1ZXVlOltdfTtcblx0XHRpZihzZXRPck51bGwpe1xuXHRcdFx0Y3R4LmlkPSsrb3Blbkxpc3QuaWQ7XG5cdFx0XHRvcGVuTGlzdFtjdHguaWRdPWN0eDtcblx0XHRcdFxuXHRcdFx0d29ya2VyLnBvc3RNZXNzYWdlKHtcblx0XHRcdFx0YWN0aW9uOlwiaW5pdFwiXG5cdFx0XHRcdCxpZDpjdHguaWRcblx0XHRcdFx0LHNhbXBsZVJhdGU6c2V0T3JOdWxsLnNhbXBsZVJhdGVcblx0XHRcdFx0LGJpdFJhdGU6c2V0T3JOdWxsLmJpdFJhdGVcblx0XHRcdFx0LHRha2VvZmY6ISFzZXRPck51bGwudGFrZW9mZkVuY29kZUNodW5rXG5cdFx0XHRcdFxuXHRcdFx0XHQseDpuZXcgSW50MTZBcnJheSg1KS8v5L2O54mI5pys5rWP6KeI5Zmo5LiN5pSv5oyB5bqP5YiX5YyWVHlwZWRBcnJheVxuXHRcdFx0fSk7XG5cdFx0fWVsc2V7XG5cdFx0XHR3b3JrZXIucG9zdE1lc3NhZ2Uoe1xuXHRcdFx0XHR4Om5ldyBJbnQxNkFycmF5KDUpLy/kvY7niYjmnKzmtY/op4jlmajkuI3mlK/mjIHluo/liJfljJZUeXBlZEFycmF5XG5cdFx0XHR9KTtcblx0XHR9O1xuXHRcdFxuXHRcdFxuXHRcdG1wM1dvcmtlcj13b3JrZXI7XG5cdFx0cmV0dXJuIGN0eDtcblx0fWNhdGNoKGUpey8v5Ye66ZSZ5LqG5bCx5LiN6KaB5o+Q5L6b5LqGXG5cdFx0d29ya2VyJiZ3b3JrZXIudGVybWluYXRlKCk7XG5cdFx0XG5cdFx0Y29uc29sZS5lcnJvcihlKTtcblx0XHRyZXR1cm4gbnVsbDtcblx0fTtcbn07XG5SZWNvcmRlci5wcm90b3R5cGUubXAzX3N0b3A9ZnVuY3Rpb24oc3RhcnRDdHgpe1xuXHRpZihzdGFydEN0eCYmc3RhcnRDdHgud29ya2VyKXtcblx0XHRzdGFydEN0eC53b3JrZXIucG9zdE1lc3NhZ2Uoe1xuXHRcdFx0YWN0aW9uOlwic3RvcFwiXG5cdFx0XHQsaWQ6c3RhcnRDdHguaWRcblx0XHR9KTtcblx0XHRzdGFydEN0eC53b3JrZXI9bnVsbDtcblx0XHRkZWxldGUgb3Blbkxpc3Rbc3RhcnRDdHguaWRdO1xuXHRcdFxuXHRcdC8v55aR5Ly85rOE6Zyy5qOA5rWLIOaOkumZpGlkXG5cdFx0dmFyIG9wZW5zPS0xO1xuXHRcdGZvcih2YXIgayBpbiBvcGVuTGlzdCl7XG5cdFx0XHRvcGVucysrO1xuXHRcdH07XG5cdFx0aWYob3BlbnMpe1xuXHRcdFx0Y29uc29sZS53YXJuKFwibXAzIHdvcmtlcuWJqVwiK29wZW5zK1wi5Liq5Zyo5Liy6KGM562J5b6FXCIpO1xuXHRcdH07XG5cdH07XG59O1xuUmVjb3JkZXIucHJvdG90eXBlLm1wM19lbmNvZGU9ZnVuY3Rpb24oc3RhcnRDdHgscGNtKXtcblx0aWYoc3RhcnRDdHgmJnN0YXJ0Q3R4Lndvcmtlcil7XG5cdFx0c3RhcnRDdHgud29ya2VyLnBvc3RNZXNzYWdlKHtcblx0XHRcdGFjdGlvbjpcImVuY29kZVwiXG5cdFx0XHQsaWQ6c3RhcnRDdHguaWRcblx0XHRcdCxwY206cGNtXG5cdFx0fSk7XG5cdH07XG59O1xuUmVjb3JkZXIucHJvdG90eXBlLm1wM19jb21wbGV0ZT1mdW5jdGlvbihzdGFydEN0eCxUcnVlLEZhbHNlLGF1dG9TdG9wKXtcblx0dmFyIFRoaXM9dGhpcztcblx0aWYoc3RhcnRDdHgmJnN0YXJ0Q3R4Lndvcmtlcil7XG5cdFx0c3RhcnRDdHguY2FsbD1mdW5jdGlvbihkYXRhKXtcblx0XHRcdG1wM1RyaW1GaXhTZXRNZXRhKGRhdGEubWV0YSxzdGFydEN0eC5zZXQpO1xuXHRcdFx0VHJ1ZShkYXRhLmJsb2IpO1xuXHRcdFx0XG5cdFx0XHRpZihhdXRvU3RvcCl7XG5cdFx0XHRcdFRoaXMubXAzX3N0b3Aoc3RhcnRDdHgpO1xuXHRcdFx0fTtcblx0XHR9O1xuXHRcdHN0YXJ0Q3R4Lndvcmtlci5wb3N0TWVzc2FnZSh7XG5cdFx0XHRhY3Rpb246XCJjb21wbGV0ZVwiXG5cdFx0XHQsaWQ6c3RhcnRDdHguaWRcblx0XHR9KTtcblx0fWVsc2V7XG5cdFx0RmFsc2UoXCJtcDPnvJbnoIHlmajmnKrmiZPlvIBcIik7XG5cdH07XG59O1xuXG5cblxuXG5cblxuXG4vLyoqKioqKirovoXliqnlh73mlbAqKioqKioqKioqKipcblxuLyror7vlj5ZsYW1lanPnvJbnoIHlh7rmnaXnmoRtcDPkv6Hmga/vvIzlj6rog73or7vnibnlrprmoLzlvI/vvIzlpoLmnpzor7vlj5blpLHotKXov5Tlm55udWxsXG5tcDNCdWZmZXJzPVtBcnJheUJ1ZmZlciwuLi5dXG5sZW5ndGg9bXAzQnVmZmVyc+eahOaVsOaNruS6jOi/m+WItuaAu+mVv+W6plxuKi9cblJlY29yZGVyLm1wM1JlYWRNZXRhPWZ1bmN0aW9uKG1wM0J1ZmZlcnMsbGVuZ3RoKXtcblx0Ly9raWxsIGJhYmVsLXBvbHlmaWxsIEVTNiBOdW1iZXIucGFyc2VJbnQg5LiN54S25pS+5YiwV29ya2Vy6YeM6Z2i5om+5LiN5Yiw5pa55rOVXG5cdHZhciBwYXJzZUludF9FUzM9dHlwZW9mKHdpbmRvdyk9PVwib2JqZWN0XCI/d2luZG93LnBhcnNlSW50OnNlbGYucGFyc2VJbnQ7XG5cdFxuXHR2YXIgdThhcnIwPW5ldyBVaW50OEFycmF5KG1wM0J1ZmZlcnNbMF18fFtdKTtcblx0aWYodThhcnIwLmxlbmd0aDw0KXtcblx0XHRyZXR1cm4gbnVsbDtcblx0fTtcblx0dmFyIGJ5dGVBdD1mdW5jdGlvbihpZHgsdTgpe1xuXHRcdHJldHVybiAoXCIwMDAwMDAwXCIrKCh1OHx8dThhcnIwKVtpZHhdfHwwKS50b1N0cmluZygyKSkuc3Vic3RyKC04KTtcblx0fTtcblx0dmFyIGIyPWJ5dGVBdCgwKStieXRlQXQoMSk7XG5cdHZhciBiND1ieXRlQXQoMikrYnl0ZUF0KDMpO1xuXHRcblx0aWYoIS9eMXsxMX0vLnRlc3QoYjIpKXsvL+acquWPkeeOsOW4p+WQjOatpVxuXHRcdHJldHVybiBudWxsO1xuXHR9O1xuXHR2YXIgdmVyc2lvbj0oe1wiMDBcIjoyLjUsXCIxMFwiOjIsXCIxMVwiOjF9KVtiMi5zdWJzdHIoMTEsMildO1xuXHR2YXIgbGF5ZXI9KHtcIjAxXCI6M30pW2IyLnN1YnN0cigxMywyKV07Ly/ku4XmlK/mjIFMYXllcjNcblx0dmFyIHNhbXBsZVJhdGU9KHsgLy9sYW1lanMgLT4gVGFibGVzLnNhbXBsZXJhdGVfdGFibGVcblx0XHRcIjFcIjpbNDQxMDAsIDQ4MDAwLCAzMjAwMF1cblx0XHQsXCIyXCI6WzIyMDUwLCAyNDAwMCwgMTYwMDBdXG5cdFx0LFwiMi41XCI6WzExMDI1LCAxMjAwMCwgODAwMF1cblx0fSlbdmVyc2lvbl07XG5cdHNhbXBsZVJhdGUmJihzYW1wbGVSYXRlPXNhbXBsZVJhdGVbcGFyc2VJbnRfRVMzKGI0LnN1YnN0cig0LDIpLDIpXSk7XG5cdHZhciBiaXRSYXRlPVsgLy9sYW1lanMgLT4gVGFibGVzLmJpdHJhdGVfdGFibGVcblx0XHRbMCwgOCwgMTYsIDI0LCAzMiwgNDAsIDQ4LCA1NiwgNjQsIDgwLCA5NiwgMTEyLCAxMjgsIDE0NCwgMTYwXSAvL01QRUcgMiAyLjVcblx0XHQsWzAsIDMyLCA0MCwgNDgsIDU2LCA2NCwgODAsIDk2LCAxMTIsIDEyOCwgMTYwLCAxOTIsIDIyNCwgMjU2LCAzMjBdLy9NUEVHIDFcblx0XVt2ZXJzaW9uPT0xPzE6MF1bcGFyc2VJbnRfRVMzKGI0LnN1YnN0cigwLDQpLDIpXTtcblx0XG5cdGlmKCF2ZXJzaW9uIHx8ICFsYXllciB8fCAhYml0UmF0ZSB8fCAhc2FtcGxlUmF0ZSl7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH07XG5cdFxuXHR2YXIgZHVyYXRpb249TWF0aC5yb3VuZChsZW5ndGgqOC9iaXRSYXRlKTtcblx0dmFyIGZyYW1lPWxheWVyPT0xPzM4NDpsYXllcj09Mj8xMTUyOnZlcnNpb249PTE/MTE1Mjo1NzY7XG5cdHZhciBmcmFtZUR1cmF0aW9uRmxvYXQ9ZnJhbWUvc2FtcGxlUmF0ZSoxMDAwO1xuXHR2YXIgZnJhbWVTaXplPU1hdGguZmxvb3IoKGZyYW1lKmJpdFJhdGUpLzgvc2FtcGxlUmF0ZSoxMDAwKTtcblx0XG5cdC8v5qOA5rWL5piv5ZCm5a2Y5ZyoTGF5ZXIz5bin5aGr5YWFMeWtl+iKguOAgui/memHjOWPquiOt+WPluesrOS6jOW4p+eahOWhq+WFheS/oeaBr++8jOmmluW4p+awuOi/nOayoeacieWhq+WFheOAguWFtuS7luW4p+WPr+iDvemalOS4gOW4p+WHuueOsOS4gOS4quWhq+WFhe+8jOaIluiAhemalOW+iOWkmuW4p+WHuueOsOS4gOS4quWhq+WFhe+8m+ebrua1i+aYr+WPluWGs+S6jmZyYW1lU2l6ZeacquiIjeWFpeaXtueahOWwj+aVsOmDqOWIhu+8jOWboOS4uuacieS6m+mHh+agt+eOh+eahGZyYW1lU2l6ZeS8muWHuueOsOWwj+aVsO+8iDExMDI144CBMjIwNTDjgIE0NDEwMCDlhbjlnovnmoTpmaTkuI3lsL3vvInvvIznhLblkI7lrZfoioLmlbDml6Dms5XooajnpLrov5nnp43lsI/mlbDvvIzlsLHpgJrov4fkuIDlrprmraXplb/mnaXloavlhYXlvKXooaXlsI/mlbDpg6jliIbkuKLlpLFcblx0dmFyIGhhc1BhZGRpbmc9MCxzZWVrPTA7XG5cdGZvcih2YXIgaT0wO2k8bXAzQnVmZmVycy5sZW5ndGg7aSsrKXtcblx0XHQvL+Wvu+aJvuesrOS6jOW4p1xuXHRcdHZhciBidWY9bXAzQnVmZmVyc1tpXTtcblx0XHRzZWVrKz1idWYuYnl0ZUxlbmd0aDtcblx0XHRpZihzZWVrPj1mcmFtZVNpemUrMyl7XG5cdFx0XHR2YXIgYnVmOD1uZXcgVWludDhBcnJheShidWYpO1xuXHRcdFx0dmFyIGlkeD1idWYuYnl0ZUxlbmd0aC0oc2Vlay0oZnJhbWVTaXplKzMpKzEpO1xuXHRcdFx0dmFyIGliND1ieXRlQXQoaWR4LGJ1ZjgpO1xuXHRcdFx0aGFzUGFkZGluZz1pYjQuY2hhckF0KDYpPT1cIjFcIjtcblx0XHRcdGJyZWFrO1xuXHRcdH07XG5cdH07XG5cdGlmKGhhc1BhZGRpbmcpe1xuXHRcdGZyYW1lU2l6ZSsrO1xuXHR9O1xuXHRcblx0XG5cdHJldHVybiB7XG5cdFx0dmVyc2lvbjp2ZXJzaW9uIC8vMSAyIDIuNSAtPiBNUEVHMSBNUEVHMiBNUEVHMi41XG5cdFx0LGxheWVyOmxheWVyLy8zIC0+IExheWVyM1xuXHRcdCxzYW1wbGVSYXRlOnNhbXBsZVJhdGUgLy/ph4fmoLfnjocgaHpcblx0XHQsYml0UmF0ZTpiaXRSYXRlIC8v5q+U54m5546HIGticHNcblx0XHRcblx0XHQsZHVyYXRpb246ZHVyYXRpb24gLy/pn7PpopHml7bplb8gbXNcblx0XHQsc2l6ZTpsZW5ndGggLy/mgLvplb/luqYgYnl0ZVxuXHRcdCxoYXNQYWRkaW5nOmhhc1BhZGRpbmcgLy/mmK/lkKblrZjlnKgx5a2X6IqC5aGr5YWF77yM6aaW5bin5rC46L+c5rKh5pyJ77yM6L+Z5Liq5YC85YW25a6e5Luj6KGo55qE56ys5LqM5bin5piv5ZCm5pyJ5aGr5YWF77yM5bm25LiN5Luj6KGo5YW25LuW5bin55qEXG5cdFx0LGZyYW1lU2l6ZTpmcmFtZVNpemUgLy/mr4/luKfmnIDlpKfplb/luqbvvIzlkKvlj6/og73lrZjlnKjnmoQx5a2X6IqCcGFkZGluZyBieXRlXG5cdFx0LGZyYW1lRHVyYXRpb25GbG9hdDpmcmFtZUR1cmF0aW9uRmxvYXQgLy/mr4/luKfml7bplb/vvIzlkKvlsI/mlbAgbXNcblx0fTtcbn07XG5cbi8v5Y675o6JbGFtZWpz5byA5aS055qE5qCH6K6w5L+h5oGv5bin77yM5YWN5b6XbXAz6Kej56CB5Ye65p2l55qE5pe26ZW/5q+UcGNt55qE6ZW/5aSq5aSaXG52YXIgbXAzVHJpbUZpeD17Ly9taW5maXkga2VlcCBuYW1lXG5ybTpSZWNvcmRlci5tcDNSZWFkTWV0YVxuLGZuOmZ1bmN0aW9uKG1wM0J1ZmZlcnMsbGVuZ3RoLHBjbUxlbmd0aCxwY21TYW1wbGVSYXRlKXtcblx0dmFyIG1ldGE9dGhpcy5ybShtcDNCdWZmZXJzLGxlbmd0aCk7XG5cdGlmKCFtZXRhKXtcblx0XHRyZXR1cm4ge2VycjpcIm1wM+mdnumihOWumuagvOW8j1wifTtcblx0fTtcblx0dmFyIHBjbUR1cmF0aW9uPU1hdGgucm91bmQocGNtTGVuZ3RoL3BjbVNhbXBsZVJhdGUqMTAwMCk7XG5cdFxuXHQvL+W8gOWktOWkmuWHuui/meS5iOWkmuW4p++8jOenu+mZpOaOie+8m+ato+W4uOaDheWGteS4i+acgOWkmuS4ujLluKdcblx0dmFyIG51bT1NYXRoLmZsb29yKChtZXRhLmR1cmF0aW9uLXBjbUR1cmF0aW9uKS9tZXRhLmZyYW1lRHVyYXRpb25GbG9hdCk7XG5cdGlmKG51bT4wKXtcblx0XHR2YXIgc2l6ZT1udW0qbWV0YS5mcmFtZVNpemUtKG1ldGEuaGFzUGFkZGluZz8xOjApOy8v6aaW5bin5rKh5pyJ5aGr5YWF77yM56ys5LqM5bin5Y+v6IO95pyJ5aGr5YWF77yM6L+Z6YeM5YGH6K6+5pyA5aSa5Li6MuW4p++8iOa1i+ivleW5tuacquWHuueOsDPluKfku6XkuIrmg4XlhrXvvInvvIzlhbbku5bluKfkuI3nrqHvvIzlsLHnrpflh7rnjrDkuoblubbkuJTlr7zoh7TkuobplJnor6/lkI7pnaLoh6rliqjlrrnplJlcblx0XHRsZW5ndGgtPXNpemU7XG5cdFx0dmFyIGFycjA9MCxhcnJzPVtdO1xuXHRcdGZvcih2YXIgaT0wO2k8bXAzQnVmZmVycy5sZW5ndGg7aSsrKXtcblx0XHRcdHZhciBhcnI9bXAzQnVmZmVyc1tpXTtcblx0XHRcdGlmKHNpemU8PTApe1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH07XG5cdFx0XHRpZihzaXplPj1hcnIuYnl0ZUxlbmd0aCl7XG5cdFx0XHRcdHNpemUtPWFyci5ieXRlTGVuZ3RoO1xuXHRcdFx0XHRhcnJzLnB1c2goYXJyKTtcblx0XHRcdFx0bXAzQnVmZmVycy5zcGxpY2UoaSwxKTtcblx0XHRcdFx0aS0tO1xuXHRcdFx0fWVsc2V7XG5cdFx0XHRcdG1wM0J1ZmZlcnNbaV09YXJyLnNsaWNlKHNpemUpO1xuXHRcdFx0XHRhcnIwPWFycjtcblx0XHRcdFx0c2l6ZT0wO1xuXHRcdFx0fTtcblx0XHR9O1xuXHRcdHZhciBjaGVja01ldGE9dGhpcy5ybShtcDNCdWZmZXJzLGxlbmd0aCk7XG5cdFx0aWYoIWNoZWNrTWV0YSl7XG5cdFx0XHQvL+i/mOWOn+WPmOabtO+8jOW6lOivpeS4jeWkquWPr+iDveS8muWHuueOsFxuXHRcdFx0YXJyMCYmKG1wM0J1ZmZlcnNbMF09YXJyMCk7XG5cdFx0XHRmb3IodmFyIGk9MDtpPGFycnMubGVuZ3RoO2krKyl7XG5cdFx0XHRcdG1wM0J1ZmZlcnMuc3BsaWNlKGksMCxhcnJzW2ldKTtcblx0XHRcdH07XG5cdFx0XHRtZXRhLmVycj1cImZpeOWQjuaVsOaNrumUmeivr++8jOW3sui/mOWOn++8jOmUmeivr+WOn+WboOS4jeaYjlwiO1xuXHRcdH07XG5cdFx0XG5cdFx0dmFyIGZpeD1tZXRhLnRyaW1GaXg9e307XG5cdFx0Zml4LnJlbW92ZT1udW07XG5cdFx0Zml4LnJlbW92ZUR1cmF0aW9uPU1hdGgucm91bmQobnVtKm1ldGEuZnJhbWVEdXJhdGlvbkZsb2F0KTtcblx0XHRmaXguZHVyYXRpb249TWF0aC5yb3VuZChsZW5ndGgqOC9tZXRhLmJpdFJhdGUpO1xuXHR9O1xuXHRyZXR1cm4gbWV0YTtcbn1cbn07XG52YXIgbXAzVHJpbUZpeFNldE1ldGE9ZnVuY3Rpb24obWV0YSxzZXQpe1xuXHR2YXIgdGFnPVwiTVAz5L+h5oGvIFwiO1xuXHRpZihtZXRhLnNhbXBsZVJhdGUmJm1ldGEuc2FtcGxlUmF0ZSE9c2V0LnNhbXBsZVJhdGUgfHwgbWV0YS5iaXRSYXRlJiZtZXRhLmJpdFJhdGUhPXNldC5iaXRSYXRlKXtcblx0XHRjb25zb2xlLndhcm4odGFnK1wi5ZKM6K6+572u55qE5LiN5Yy56YWNc2V0OlwiK3NldC5iaXRSYXRlK1wia2JwcyBcIitzZXQuc2FtcGxlUmF0ZStcImh677yM5bey5pu05pawc2V0OlwiK21ldGEuYml0UmF0ZStcImticHMgXCIrbWV0YS5zYW1wbGVSYXRlK1wiaHpcIixzZXQpO1xuXHRcdHNldC5zYW1wbGVSYXRlPW1ldGEuc2FtcGxlUmF0ZTtcblx0XHRzZXQuYml0UmF0ZT1tZXRhLmJpdFJhdGU7XG5cdH07XG5cdFxuXHR2YXIgdHJpbUZpeD1tZXRhLnRyaW1GaXg7XG5cdGlmKHRyaW1GaXgpe1xuXHRcdHRhZys9XCJGaXjnp7vpmaRcIit0cmltRml4LnJlbW92ZStcIuW4p1wiK3RyaW1GaXgucmVtb3ZlRHVyYXRpb24rXCJtcyAtPiBcIit0cmltRml4LmR1cmF0aW9uK1wibXNcIjtcblx0XHRpZih0cmltRml4LnJlbW92ZT4yKXtcblx0XHRcdG1ldGEuZXJyPShtZXRhLmVycj9tZXRhLmVycitcIiwgXCI6XCJcIikrXCLnp7vpmaTluKfmlbDov4flpJpcIjtcblx0XHR9O1xuXHR9ZWxzZXtcblx0XHR0YWcrPShtZXRhLmR1cmF0aW9ufHxcIi1cIikrXCJtc1wiO1xuXHR9O1xuXHRcblx0aWYobWV0YS5lcnIpe1xuXHRcdGNvbnNvbGUuZXJyb3IodGFnLG1ldGEuZXJyLG1ldGEpO1xuXHR9ZWxzZXtcblx0XHRjb25zb2xlLmxvZyh0YWcsbWV0YSk7XG5cdH07XG59O1xuXG5cblx0XG59KSgpOyIsIi8qXG7lvZXpn7Ncbmh0dHBzOi8vZ2l0aHViLmNvbS94aWFuZ3l1ZWNuL1JlY29yZGVyXG4qL1xuKGZ1bmN0aW9uKGZhY3Rvcnkpe1xuXHRmYWN0b3J5KHdpbmRvdyk7XG5cdC8vdW1kIHJldHVybkV4cG9ydHMuanNcblx0aWYodHlwZW9mKGRlZmluZSk9PSdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCl7XG5cdFx0ZGVmaW5lKGZ1bmN0aW9uKCl7XG5cdFx0XHRyZXR1cm4gUmVjb3JkZXI7XG5cdFx0fSk7XG5cdH07XG5cdGlmKHR5cGVvZihtb2R1bGUpPT0nb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyl7XG5cdFx0bW9kdWxlLmV4cG9ydHM9UmVjb3JkZXI7XG5cdH07XG59KGZ1bmN0aW9uKHdpbmRvdyl7XG5cInVzZSBzdHJpY3RcIjtcblxuLy/lhbzlrrnnjq/looNcbnZhciBMTT1cIjIwMjAtMTEtMTUgMjE6MzY6MTFcIjtcbnZhciBOT09QPWZ1bmN0aW9uKCl7fTtcbi8vZW5kIOWFvOWuueeOr+WigyAqKioq5LuO5Lul5LiL5byA5aeLY29weea6kOeggSoqKioqXG5cbnZhciBSZWNvcmRlcj1mdW5jdGlvbihzZXQpe1xuXHRyZXR1cm4gbmV3IGluaXRGbihzZXQpO1xufTtcbi8v5piv5ZCm5bey57uP5omT5byA5LqG5b2V6Z+z77yM5omA5pyJ5bel5L2c6YO95bey57uP5YeG5aSH5aW95LqG77yM5bCx562J5o6l5pS26Z+z6aKR5pWw5o2u5LqGXG5SZWNvcmRlci5Jc09wZW49ZnVuY3Rpb24oKXtcblx0dmFyIHN0cmVhbT1SZWNvcmRlci5TdHJlYW07XG5cdGlmKHN0cmVhbSl7XG5cdFx0dmFyIHRyYWNrcz1zdHJlYW0uZ2V0VHJhY2tzJiZzdHJlYW0uZ2V0VHJhY2tzKCl8fHN0cmVhbS5hdWRpb1RyYWNrc3x8W107XG5cdFx0dmFyIHRyYWNrPXRyYWNrc1swXTtcblx0XHRpZih0cmFjayl7XG5cdFx0XHR2YXIgc3RhdGU9dHJhY2sucmVhZHlTdGF0ZTtcblx0XHRcdHJldHVybiBzdGF0ZT09XCJsaXZlXCJ8fHN0YXRlPT10cmFjay5MSVZFO1xuXHRcdH07XG5cdH07XG5cdHJldHVybiBmYWxzZTtcbn07XG4vKkg15b2V6Z+z5pe255qEQXVkaW9Db250ZXh057yT5Yay5aSn5bCP44CC5Lya5b2x5ZONSDXlvZXpn7Pml7bnmoRvblByb2Nlc3PosIPnlKjpgJ/njofvvIznm7jlr7nkuo5BdWRpb0NvbnRleHQuc2FtcGxlUmF0ZT00ODAwMOaXtu+8jDQwOTbmjqXov5ExMuW4py9z77yM6LCD6IqC5q2k5Y+C5pWw5Y+v55Sf5oiQ5q+U6L6D5rWB55WF55qE5Zue6LCD5Yqo55S744CCXG5cdOWPluWAvDI1NiwgNTEyLCAxMDI0LCAyMDQ4LCA0MDk2LCA4MTkyLCBvciAxNjM4NFxuXHTms6jmhI/vvIzlj5blgLzkuI3og73ov4fkvY7vvIwyMDQ45byA5aeL5LiN5ZCM5rWP6KeI5Zmo5Y+v6IO95Zue6LCD6YCf546H6Lef5LiN5LiK6YCg5oiQ6Z+z6LSo6Zeu6aKY44CCXG5cdOS4gOiIrOaXoOmcgOiwg+aVtO+8jOiwg+aVtOWQjumcgOimgeWFiGNsb3Nl5o6J5bey5omT5byA55qE5b2V6Z+z77yM5YaNb3BlbuaXtuaJjeS8mueUn+aViOOAglxuKi9cblJlY29yZGVyLkJ1ZmZlclNpemU9NDA5Njtcbi8v6ZSA5q+B5bey5oyB5pyJ55qE5omA5pyJ5YWo5bGA6LWE5rqQ77yM5b2T6KaB5b275bqV56e76ZmkUmVjb3JkZXLml7bpnIDopoHmmL7lvI/nmoTosIPnlKjmraTmlrnms5VcblJlY29yZGVyLkRlc3Ryb3k9ZnVuY3Rpb24oKXtcblx0Q0xvZyhcIlJlY29yZGVyIERlc3Ryb3lcIik7XG5cdGZvcih2YXIgayBpbiBEZXN0cm95TGlzdCl7XG5cdFx0RGVzdHJveUxpc3Rba10oKTtcblx0fTtcbn07XG52YXIgRGVzdHJveUxpc3Q9e307XG4vL+eZu+iusOS4gOS4qumcgOimgemUgOavgeWFqOWxgOi1hOa6kOeahOWkhOeQhuaWueazlVxuUmVjb3JkZXIuQmluZERlc3Ryb3k9ZnVuY3Rpb24oa2V5LGNhbGwpe1xuXHREZXN0cm95TGlzdFtrZXldPWNhbGw7XG59O1xuLy/liKTmlq3mtY/op4jlmajmmK/lkKbmlK/mjIHlvZXpn7PvvIzpmo/ml7blj6/ku6XosIPnlKjjgILms6jmhI/vvJrku4Xku4XmmK/mo4DmtYvmtY/op4jlmajmlK/mjIHmg4XlhrXvvIzkuI3kvJrliKTmlq3lkozosIPotbfnlKjmiLfmjojmnYPvvIzkuI3kvJrliKTmlq3mmK/lkKbmlK/mjIHnibnlrprmoLzlvI/lvZXpn7PjgIJcblJlY29yZGVyLlN1cHBvcnQ9ZnVuY3Rpb24oKXtcblx0dmFyIEFDPXdpbmRvdy5BdWRpb0NvbnRleHQ7XG5cdGlmKCFBQyl7XG5cdFx0QUM9d2luZG93LndlYmtpdEF1ZGlvQ29udGV4dDtcblx0fTtcblx0aWYoIUFDKXtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH07XG5cdHZhciBzY29wZT1uYXZpZ2F0b3IubWVkaWFEZXZpY2VzfHx7fTtcblx0aWYoIXNjb3BlLmdldFVzZXJNZWRpYSl7XG5cdFx0c2NvcGU9bmF2aWdhdG9yO1xuXHRcdHNjb3BlLmdldFVzZXJNZWRpYXx8KHNjb3BlLmdldFVzZXJNZWRpYT1zY29wZS53ZWJraXRHZXRVc2VyTWVkaWF8fHNjb3BlLm1vekdldFVzZXJNZWRpYXx8c2NvcGUubXNHZXRVc2VyTWVkaWEpO1xuXHR9O1xuXHRpZighc2NvcGUuZ2V0VXNlck1lZGlhKXtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH07XG5cdFxuXHRSZWNvcmRlci5TY29wZT1zY29wZTtcblx0aWYoIVJlY29yZGVyLkN0eHx8UmVjb3JkZXIuQ3R4LnN0YXRlPT1cImNsb3NlZFwiKXtcblx0XHQvL+S4jeiDveWPjeWkjeaehOmAoO+8jOS9jueJiOacrG51bWJlciBvZiBoYXJkd2FyZSBjb250ZXh0cyByZWFjaGVkIG1heGltdW0gKDYpXG5cdFx0UmVjb3JkZXIuQ3R4PW5ldyBBQygpO1xuXHRcdFxuXHRcdFJlY29yZGVyLkJpbmREZXN0cm95KFwiQ3R4XCIsZnVuY3Rpb24oKXtcblx0XHRcdHZhciBjdHg9UmVjb3JkZXIuQ3R4O1xuXHRcdFx0Y3R4JiZjdHguY2xvc2UmJmN0eC5jbG9zZSgpO1xuXHRcdH0pO1xuXHR9O1xuXHRyZXR1cm4gdHJ1ZTtcbn07XG4vKuWIneWni+WMlkg16Z+z6aKR6YeH6ZuG6L+e5o6l77yM5Zug5Li6U3RyZWFt5piv5YWo5bGA55qE77yMU2FmYXJp5LiK5pat5byA5ZCO5bCx5peg5rOV5YaN5qyh6L+b6KGM6L+e5o6l5L2/55So77yM6KGo546w5Li66Z2Z6Z+z77yM5Zug5q2k5L2/55So5YWo6YOo5L2/55So5YWo5bGA5aSE55CG6YG/5YWN6LCD55So5YiwZGlzY29ubmVjdO+8m+WFqOWxgOWkhOeQhuS5n+acieWIqeS6juWxj+iUveW6leWxgue7huiKgu+8jHN0YXJ05pe25peg6ZyA5YaN6LCD55So5bqV5bGC5o6l5Y+j77yM5o+Q5Y2H5YW85a6544CB5Y+v6Z2g5oCn44CCKi9cbnZhciBDb25uZWN0PWZ1bmN0aW9uKCl7XG5cdHZhciBjdHg9UmVjb3JkZXIuQ3R4LHN0cmVhbT1SZWNvcmRlci5TdHJlYW07XG5cdHZhciBtZWRpYT1zdHJlYW0uX209Y3R4LmNyZWF0ZU1lZGlhU3RyZWFtU291cmNlKHN0cmVhbSk7XG5cdHZhciBwcm9jZXNzPXN0cmVhbS5fcD0oY3R4LmNyZWF0ZVNjcmlwdFByb2Nlc3Nvcnx8Y3R4LmNyZWF0ZUphdmFTY3JpcHROb2RlKS5jYWxsKGN0eCxSZWNvcmRlci5CdWZmZXJTaXplLDEsMSk7Ly/ljZXlo7DpgZPvvIznnIHnmoTmlbDmja7lpITnkIblpI3mnYJcblx0XG5cdG1lZGlhLmNvbm5lY3QocHJvY2Vzcyk7XG5cdHByb2Nlc3MuY29ubmVjdChjdHguZGVzdGluYXRpb24pO1xuXHRcblx0dmFyIGNhbGxzPXN0cmVhbS5fY2FsbDtcblx0cHJvY2Vzcy5vbmF1ZGlvcHJvY2Vzcz1mdW5jdGlvbihlKXtcblx0XHRmb3IodmFyIGswIGluIGNhbGxzKXsvL2hhcyBpdGVtXG5cdFx0XHR2YXIgbz1lLmlucHV0QnVmZmVyLmdldENoYW5uZWxEYXRhKDApOy8v5Z2X5piv5YWx5Lqr55qE77yM5b+F6aG75aSN5Yi25Ye65p2lXG5cdFx0XHR2YXIgc2l6ZT1vLmxlbmd0aDtcblx0XHRcdFxuXHRcdFx0dmFyIHBjbT1uZXcgSW50MTZBcnJheShzaXplKTtcblx0XHRcdHZhciBzdW09MDtcblx0XHRcdGZvcih2YXIgaj0wO2o8c2l6ZTtqKyspey8vZmxvYXRUbzE2Qml0UENNIFxuXHRcdFx0XHR2YXIgcz1NYXRoLm1heCgtMSxNYXRoLm1pbigxLG9bal0pKTtcblx0XHRcdFx0cz1zPDA/cyoweDgwMDA6cyoweDdGRkY7XG5cdFx0XHRcdHBjbVtqXT1zO1xuXHRcdFx0XHRzdW0rPU1hdGguYWJzKHMpO1xuXHRcdFx0fTtcblx0XHRcdFxuXHRcdFx0Zm9yKHZhciBrIGluIGNhbGxzKXtcblx0XHRcdFx0Y2FsbHNba10ocGNtLHN1bSk7XG5cdFx0XHR9O1xuXHRcdFx0XG5cdFx0XHRyZXR1cm47XG5cdFx0fTtcblx0fTtcbn07XG52YXIgRGlzY29ubmVjdD1mdW5jdGlvbigpe1xuXHR2YXIgc3RyZWFtPVJlY29yZGVyLlN0cmVhbTtcblx0aWYoc3RyZWFtLl9tKXtcblx0XHRzdHJlYW0uX20uZGlzY29ubmVjdCgpO1xuXHRcdHN0cmVhbS5fcC5kaXNjb25uZWN0KCk7XG5cdFx0c3RyZWFtLl9wLm9uYXVkaW9wcm9jZXNzPXN0cmVhbS5fcD1zdHJlYW0uX209bnVsbDtcblx0fTtcbn07XG5cbi8q5a+5cGNt5pWw5o2u55qE6YeH5qC3546H6L+b6KGM6L2s5o2iXG5wY21EYXRhczogW1tJbnQxNiwuLi5dXSBwY23niYfmrrXliJfooahcbnBjbVNhbXBsZVJhdGU6NDgwMDAgcGNt5pWw5o2u55qE6YeH5qC3546HXG5uZXdTYW1wbGVSYXRlOjE2MDAwIOmcgOimgei9rOaNouaIkOeahOmHh+agt+eOh++8jG5ld1NhbXBsZVJhdGU+PXBjbVNhbXBsZVJhdGXml7bkuI3kvJrov5vooYzku7vkvZXlpITnkIbvvIzlsI/kuo7ml7bkvJrov5vooYzph43mlrDph4fmoLdcbnByZXZDaHVua0luZm86e30g5Y+v6YCJ77yM5LiK5qyh6LCD55So5pe255qE6L+U5Zue5YC877yM55So5LqO6L+e57ut6L2s5o2i77yM5pys5qyh6LCD55So5bCG5LuO5LiK5qyh57uT5p2f5L2N572u5byA5aeL6L+b6KGM5aSE55CG44CC5oiW5Y+v6Ieq6KGM5a6a5LmJ5LiA5LiqQ2h1bmtJbmZv5LuOcGNtRGF0YXPmjIflrprnmoTkvY3nva7lvIDlp4vov5vooYzovazmjaJcbm9wdGlvbjp7IOWPr+mAie+8jOmFjee9rumhuVxuXHRcdGZyYW1lU2l6ZToxMjM0NTYg5bin5aSn5bCP77yM5q+P5bin55qEUENNIEludDE255qE5pWw6YeP77yM6YeH5qC3546H6L2s5o2i5ZCO55qEcGNt6ZW/5bqm5Li6ZnJhbWVTaXpl55qE5pW05pWw5YCN77yM55So5LqO6L+e57ut6L2s5o2i44CC55uu5YmN5LuF5ZyobXAz5qC85byP5pe25omN5pyJ55So77yMZnJhbWVTaXpl5Y+W5YC85Li6MTE1Mu+8jOi/meagt+e8lueggeWHuuadpeeahG1wM+aXtumVv+WSjHBjbeeahOaXtumVv+WujOWFqOS4gOiHtO+8jOWQpuWImeS8muWboOS4um1wM+acgOWQjuS4gOW4p+W9lemfs+S4jeWkn+Whq+a7oeaXtua3u+WKoOWhq+WFheaVsOaNruWvvOiHtG1wM+eahOaXtumVv+WPmOmVv+OAglxuXHRcdGZyYW1lVHlwZTpcIlwiIOW4p+exu+Wei++8jOS4gOiIrOS4unJlYy5zZXQudHlwZe+8jOaPkOS+m+atpOWPguaVsOaXtuaXoOmcgOaPkOS+m2ZyYW1lU2l6Ze+8jOS8muiHquWKqOS9v+eUqOacgOS9s+eahOWAvOe7mWZyYW1lU2l6Zei1i+WAvO+8jOebruWJjeS7heaUr+aMgW1wMz0xMTUyKE1QRUcxIExheWVyM+eahOavj+W4p+mHh+mHh+agt+aVsCnvvIzlhbbku5bnsbvlnos9MeOAglxuXHRcdFx05Lul5LiK5Lik5Liq5Y+C5pWw55So5LqO6L+e57ut6L2s5o2i5pe25L2/55So77yM5pyA5aSa5L2/55So5LiA5Liq77yM5LiN5o+Q5L6b5pe25LiN6L+b6KGM5bin55qE54m55q6K5aSE55CG77yM5o+Q5L6b5pe25b+F6aG75ZCM5pe25o+Q5L6bcHJldkNodW5rSW5mb+aJjeacieS9nOeUqOOAguacgOWQjuS4gOauteaVsOaNruWkhOeQhuaXtuaXoOmcgOaPkOS+m+W4p+Wkp+Wwj+S7peS+v+i+k+WHuuacgOWQjuS4gOS4geeCueaui+eVmeaVsOaNruOAglxuXHR9XG5cbui/lOWbnkNodW5rSW5mbzp7XG5cdC8v5Y+v5a6a5LmJ77yM5LuO5oyH5a6a5L2N572u5byA5aeL6L2s5o2i5Yiw57uT5bC+XG5cdGluZGV4OjAgcGNtRGF0YXPlt7LlpITnkIbliLDnmoTntKLlvJVcblx0b2Zmc2V0OjAuMCDlt7LlpITnkIbliLDnmoRpbmRleOWvueW6lOeahHBjbeS4reeahOWBj+enu+eahOS4i+S4gOS4quS9jee9rlxuXHRcblx0Ly/ku4XkvZzkuLrov5Tlm57lgLxcblx0ZnJhbWVOZXh0Om51bGx8fFtJbnQxNiwuLi5dIOS4i+S4gOW4p+eahOmDqOWIhuaVsOaNru+8jGZyYW1lU2l6Zeiuvue9ruS6hueahOaXtuWAmeaJjeWPr+iDveS8muaciVxuXHRzYW1wbGVSYXRlOjE2MDAwIOe7k+aenOeahOmHh+agt+eOh++8jDw9bmV3U2FtcGxlUmF0ZVxuXHRkYXRhOltJbnQxNiwuLi5dIOi9rOaNouWQjueahFBDTee7k+aenO+8m+WmguaenOaYr+i/nue7rei9rOaNou+8jOW5tuS4lHBjbURhdGFz5Lit5bm25rKh5pyJ5paw5pWw5o2u5pe277yMZGF0YeeahOmVv+W6puWPr+iDveS4ujBcbn1cbiovXG5SZWNvcmRlci5TYW1wbGVEYXRhPWZ1bmN0aW9uKHBjbURhdGFzLHBjbVNhbXBsZVJhdGUsbmV3U2FtcGxlUmF0ZSxwcmV2Q2h1bmtJbmZvLG9wdGlvbil7XG5cdHByZXZDaHVua0luZm98fChwcmV2Q2h1bmtJbmZvPXt9KTtcblx0dmFyIGluZGV4PXByZXZDaHVua0luZm8uaW5kZXh8fDA7XG5cdHZhciBvZmZzZXQ9cHJldkNodW5rSW5mby5vZmZzZXR8fDA7XG5cdFxuXHR2YXIgZnJhbWVOZXh0PXByZXZDaHVua0luZm8uZnJhbWVOZXh0fHxbXTtcblx0b3B0aW9ufHwob3B0aW9uPXt9KTtcblx0dmFyIGZyYW1lU2l6ZT1vcHRpb24uZnJhbWVTaXplfHwxO1xuXHRpZihvcHRpb24uZnJhbWVUeXBlKXtcblx0XHRmcmFtZVNpemU9b3B0aW9uLmZyYW1lVHlwZT09XCJtcDNcIj8xMTUyOjE7XG5cdH07XG5cdFxuXHR2YXIgc2l6ZT0wO1xuXHRmb3IodmFyIGk9aW5kZXg7aTxwY21EYXRhcy5sZW5ndGg7aSsrKXtcblx0XHRzaXplKz1wY21EYXRhc1tpXS5sZW5ndGg7XG5cdH07XG5cdHNpemU9TWF0aC5tYXgoMCxzaXplLU1hdGguZmxvb3Iob2Zmc2V0KSk7XG5cdFxuXHQvL+mHh+agtyBodHRwczovL3d3dy5jbmJsb2dzLmNvbS9ibHF3L3AvMzc4MjQyMC5odG1sXG5cdHZhciBzdGVwPXBjbVNhbXBsZVJhdGUvbmV3U2FtcGxlUmF0ZTtcblx0aWYoc3RlcD4xKXsvL+aWsOmHh+agt+S9juS6juW9lemfs+mHh+agt++8jOi/m+ihjOaKveagt1xuXHRcdHNpemU9TWF0aC5mbG9vcihzaXplL3N0ZXApO1xuXHR9ZWxzZXsvL+aWsOmHh+agt+mrmOS6juW9lemfs+mHh+agt+S4jeWkhOeQhu+8jOecgeWOu+S6huaPkuWAvOWkhOeQhlxuXHRcdHN0ZXA9MTtcblx0XHRuZXdTYW1wbGVSYXRlPXBjbVNhbXBsZVJhdGU7XG5cdH07XG5cdFxuXHRzaXplKz1mcmFtZU5leHQubGVuZ3RoO1xuXHR2YXIgcmVzPW5ldyBJbnQxNkFycmF5KHNpemUpO1xuXHR2YXIgaWR4PTA7XG5cdC8v5re75Yqg5LiK5LiA5qyh5LiN5aSf5LiA5bin55qE5Ymp5L2Z5pWw5o2uXG5cdGZvcih2YXIgaT0wO2k8ZnJhbWVOZXh0Lmxlbmd0aDtpKyspe1xuXHRcdHJlc1tpZHhdPWZyYW1lTmV4dFtpXTtcblx0XHRpZHgrKztcblx0fTtcblx0Ly/lpITnkIbmlbDmja5cblx0Zm9yICh2YXIgbmw9cGNtRGF0YXMubGVuZ3RoO2luZGV4PG5sO2luZGV4KyspIHtcblx0XHR2YXIgbz1wY21EYXRhc1tpbmRleF07XG5cdFx0dmFyIGk9b2Zmc2V0LGlsPW8ubGVuZ3RoO1xuXHRcdHdoaWxlKGk8aWwpe1xuXHRcdFx0Ly9yZXNbaWR4XT1vW01hdGgucm91bmQoaSldOyDnm7TmjqXnroDljZXmir3moLdcblx0XHRcdFxuXHRcdFx0Ly9odHRwczovL3d3dy5jbmJsb2dzLmNvbS94aWFvcWkvcC82OTkzOTEyLmh0bWxcblx0XHRcdC8v5b2T5YmN54K5PeW9k+WJjeeCuSvliLDlkI7pnaLkuIDkuKrngrnkuYvpl7TnmoTlop7ph4/vvIzpn7PotKjmr5Tnm7TmjqXnroDljZXmir3moLflpb3kuptcblx0XHRcdHZhciBiZWZvcmUgPSBNYXRoLmZsb29yKGkpO1xuXHRcdFx0dmFyIGFmdGVyID0gTWF0aC5jZWlsKGkpO1xuXHRcdFx0dmFyIGF0UG9pbnQgPSBpIC0gYmVmb3JlO1xuXHRcdFx0XG5cdFx0XHR2YXIgYmVmb3JlVmFsPW9bYmVmb3JlXTtcblx0XHRcdHZhciBhZnRlclZhbD1hZnRlcjxpbCA/IG9bYWZ0ZXJdXG5cdFx0XHRcdDogKC8v5ZCO5Liq54K56LaK55WM5LqG77yM5p+l5om+5LiL5LiA5Liq5pWw57uEXG5cdFx0XHRcdFx0KHBjbURhdGFzW2luZGV4KzFdfHxbYmVmb3JlVmFsXSlbMF18fDBcblx0XHRcdFx0KTtcblx0XHRcdHJlc1tpZHhdPWJlZm9yZVZhbCsoYWZ0ZXJWYWwtYmVmb3JlVmFsKSphdFBvaW50O1xuXHRcdFx0XG5cdFx0XHRpZHgrKztcblx0XHRcdGkrPXN0ZXA7Ly/mir3moLdcblx0XHR9O1xuXHRcdG9mZnNldD1pLWlsO1xuXHR9O1xuXHQvL+W4p+WkhOeQhlxuXHRmcmFtZU5leHQ9bnVsbDtcblx0dmFyIGZyYW1lTmV4dFNpemU9cmVzLmxlbmd0aCVmcmFtZVNpemU7XG5cdGlmKGZyYW1lTmV4dFNpemU+MCl7XG5cdFx0dmFyIHU4UG9zPShyZXMubGVuZ3RoLWZyYW1lTmV4dFNpemUpKjI7XG5cdFx0ZnJhbWVOZXh0PW5ldyBJbnQxNkFycmF5KHJlcy5idWZmZXIuc2xpY2UodThQb3MpKTtcblx0XHRyZXM9bmV3IEludDE2QXJyYXkocmVzLmJ1ZmZlci5zbGljZSgwLHU4UG9zKSk7XG5cdH07XG5cdFxuXHRyZXR1cm4ge1xuXHRcdGluZGV4OmluZGV4XG5cdFx0LG9mZnNldDpvZmZzZXRcblx0XHRcblx0XHQsZnJhbWVOZXh0OmZyYW1lTmV4dFxuXHRcdCxzYW1wbGVSYXRlOm5ld1NhbXBsZVJhdGVcblx0XHQsZGF0YTpyZXNcblx0fTtcbn07XG5cblxuLyrorqHnrpfpn7Pph4/nmb7liIbmr5TnmoTkuIDkuKrmlrnms5VcbnBjbUFic1N1bTogcGNtIEludDE25omA5pyJ6YeH5qC355qE57ud5a+55YC855qE5ZKMXG5wY21MZW5ndGg6IHBjbemVv+W6plxu6L+U5Zue5YC877yaMC0xMDDvvIzkuLvopoHlvZPlgZrnmb7liIbmr5TnlKhcbuazqOaEj++8mui/meS4quS4jeaYr+WIhui0ne+8jOWboOatpOayoeeUqHZvbHVtZeW9k+WBmuWQjeensCovXG5SZWNvcmRlci5Qb3dlckxldmVsPWZ1bmN0aW9uKHBjbUFic1N1bSxwY21MZW5ndGgpe1xuXHQvKuiuoeeul+mfs+mHjyBodHRwczovL2Jsb2cuY3Nkbi5uZXQvam9keTE5ODkvYXJ0aWNsZS9kZXRhaWxzLzczNDgwMjU5XG5cdOabtOmrmOeBteaVj+W6pueul+azlTpcblx0XHTpmZDlrprmnIDlpKfmhJ/lupTlgLwxMDAwMFxuXHRcdFx057q/5oCn5puy57q/77ya5L2O6Z+z6YeP5LiN5Y+L5aW9XG5cdFx0XHRcdHBvd2VyLzEwMDAwKjEwMCBcblx0XHRcdOWvueaVsOabsue6v++8muS9jumfs+mHj+WPi+Wlve+8jOS9humcgOmZkOWumuacgOS9juaEn+W6lOWAvFxuXHRcdFx0XHQoMStNYXRoLmxvZzEwKHBvd2VyLzEwMDAwKSkqMTAwXG5cdCovXG5cdHZhciBwb3dlcj0ocGNtQWJzU3VtL3BjbUxlbmd0aCkgfHwgMDsvL05hTlxuXHR2YXIgbGV2ZWw7XG5cdGlmKHBvd2VyPDEyNTEpey8vMTI1MOeahOe7k+aenDEwJe+8jOabtOWwj+eahOmfs+mHj+mHh+eUqOe6v+aAp+WPluWAvFxuXHRcdGxldmVsPU1hdGgucm91bmQocG93ZXIvMTI1MCoxMCk7XG5cdH1lbHNle1xuXHRcdGxldmVsPU1hdGgucm91bmQoTWF0aC5taW4oMTAwLE1hdGgubWF4KDAsKDErTWF0aC5sb2cocG93ZXIvMTAwMDApL01hdGgubG9nKDEwKSkqMTAwKSkpO1xuXHR9O1xuXHRyZXR1cm4gbGV2ZWw7XG59O1xuXG5cblxuXG4vL+W4puaXtumXtOeahOaXpeW/l+i+k+WHuu+8jENMb2cobXNnLGVyck9yTG9nTXNnLCBsb2dNc2cuLi4pIGVycuS4uuaVsOWtl+aXtuS7o+ihqOaXpeW/l+exu+WeizE6ZXJyb3IgMjpsb2fpu5jorqQgMzp3YXJu77yM5ZCm5YiZ5b2T5YGa5YaF5a656L6T5Ye677yM56ys5LiA5Liq5Y+C5pWw5LiN6IO95piv5a+56LGh5Zug5Li66KaB5ou85o6l5pe26Ze077yM5ZCO6Z2i5Y+v5Lul5o6l5peg5pWw5Liq6L6T5Ye65Y+C5pWwXG52YXIgQ0xvZz1mdW5jdGlvbihtc2csZXJyKXtcblx0dmFyIG5vdz1uZXcgRGF0ZSgpO1xuXHR2YXIgdD0oXCIwXCIrbm93LmdldE1pbnV0ZXMoKSkuc3Vic3RyKC0yKVxuXHRcdCtcIjpcIisoXCIwXCIrbm93LmdldFNlY29uZHMoKSkuc3Vic3RyKC0yKVxuXHRcdCtcIi5cIisoXCIwMFwiK25vdy5nZXRNaWxsaXNlY29uZHMoKSkuc3Vic3RyKC0zKTtcblx0dmFyIGFycj1bXCJbXCIrdCtcIiBSZWNvcmRlcl1cIittc2ddO1xuXHR2YXIgYT1hcmd1bWVudHM7XG5cdHZhciBpPTIsZm49Y29uc29sZS5sb2c7XG5cdGlmKHR5cGVvZihlcnIpPT1cIm51bWJlclwiKXtcblx0XHRmbj1lcnI9PTE/Y29uc29sZS5lcnJvcjplcnI9PTM/Y29uc29sZS53YXJuOmZuO1xuXHR9ZWxzZXtcblx0XHRpPTE7XG5cdH07XG5cdGZvcig7aTxhLmxlbmd0aDtpKyspe1xuXHRcdGFyci5wdXNoKGFbaV0pO1xuXHR9O1xuXHRmbi5hcHBseShjb25zb2xlLGFycik7XG59O1xuUmVjb3JkZXIuQ0xvZz1DTG9nO1xuXG5cblxuXG52YXIgSUQ9MDtcbmZ1bmN0aW9uIGluaXRGbihzZXQpe1xuXHR0aGlzLmlkPSsrSUQ7XG5cdFxuXHQvL+WmguaenOW8gOWQr+S6hua1gemHj+e7n+iuoe+8jOi/memHjOWwhuWPkemAgeS4gOS4quWbvueJh+ivt+axglxuXHRSZWNvcmRlci5UcmFmZmljJiZSZWNvcmRlci5UcmFmZmljKCk7XG5cdFxuXHRcblx0dmFyIG89e1xuXHRcdHR5cGU6XCJtcDNcIiAvL+i+k+WHuuexu+Wei++8mm1wMyx3YXbvvIx3YXbovpPlh7rmlofku7blsLrlr7jotoXlpKfkuI3mjqjojZDkvb/nlKjvvIzkvYZtcDPnvJbnoIHmlK/mjIHkvJrlr7zoh7Rqc+aWh+S7tui2heWkp++8jOWmguaenOS4jemcgOaUr+aMgW1wM+WPr+S7peS9v2pz5paH5Lu25aSn5bmF5YeP5bCPXG5cdFx0LGJpdFJhdGU6MTYgLy/mr5Tnibnnjocgd2F2OjE25oiWOOS9je+8jE1QM++8mjhrYnBzIDFrL3PvvIw4a2JwcyAyay9zIOW9lemfs+aWh+S7tuW+iOWwj1xuXHRcdFxuXHRcdCxzYW1wbGVSYXRlOjE2MDAwIC8v6YeH5qC3546H77yMd2F25qC85byP5aSn5bCPPXNhbXBsZVJhdGUq5pe26Ze077ybbXAz5q2k6aG55a+55L2O5q+U54m5546H5pyJ5b2x5ZON77yM6auY5q+U54m5546H5Yeg5LmO5peg5b2x5ZON44CCXG5cdFx0XHRcdFx0Ly93YXbku7vmhI/lgLzvvIxtcDPlj5blgLzojIPlm7TvvJo0ODAwMCwgNDQxMDAsIDMyMDAwLCAyNDAwMCwgMjIwNTAsIDE2MDAwLCAxMjAwMCwgMTEwMjUsIDgwMDBcblx0XHRcdFx0XHQvL+mHh+agt+eOh+WPguiAg2h0dHBzOi8vd3d3LmNuYmxvZ3MuY29tL2RldmluODcvcC9tcDMtcmVjb3JkZXIuaHRtbFxuXHRcdFxuXHRcdCxvblByb2Nlc3M6Tk9PUCAvL2ZuKGJ1ZmZlcnMscG93ZXJMZXZlbCxidWZmZXJEdXJhdGlvbixidWZmZXJTYW1wbGVSYXRlLG5ld0J1ZmZlcklkeCxhc3luY0VuZCkgYnVmZmVycz1bW0ludDE2LC4uLl0sLi4uXe+8mue8k+WGsueahFBDTeaVsOaNru+8jOS4uuS7juW8gOWni+W9lemfs+WIsOeOsOWcqOeahOaJgOaciXBjbeeJh+aute+8m3Bvd2VyTGV2ZWzvvJrlvZPliY3nvJPlhrLnmoTpn7Pph4/nuqfliKswLTEwMO+8jGJ1ZmZlckR1cmF0aW9u77ya5bey57yT5Yay5pe26ZW/77yMYnVmZmVyU2FtcGxlUmF0Ze+8mue8k+WGsuS9v+eUqOeahOmHh+agt+eOh++8iOW9k3R5cGXmlK/mjIHovrnlvZXovrnovaznoIEoV29ya2VyKeaXtu+8jOatpOmHh+agt+eOh+WSjOiuvue9rueahOmHh+agt+eOh+ebuOWQjO+8jOWQpuWImeS4jeS4gOWumuebuOWQjO+8ie+8m25ld0J1ZmZlcklkeDrmnKzmrKHlm57osIPmlrDlop7nmoRidWZmZXLotbflp4vntKLlvJXvvJthc3luY0VuZDpmbigpIOWmguaenG9uUHJvY2Vzc+aYr+W8guatpeeahCjov5Tlm57lgLzkuLp0cnVl5pe2Ke+8jOWkhOeQhuWujOaIkOaXtumcgOimgeiwg+eUqOatpOWbnuiwg++8jOWmguaenOS4jeaYr+W8guatpeeahOivt+W/veeVpeatpOWPguaVsO+8jOatpOaWueazleWbnuiwg+aXtuW/hemhu+aYr+ecn+W8guatpe+8iOS4jeiDveecn+W8guatpeaXtumcgOeUqHNldFRpbWVvdXTljIXoo7nvvInjgIJvblByb2Nlc3Pov5Tlm57lgLzvvJrlpoLmnpzov5Tlm550cnVl5Luj6KGo5byA5ZCv5byC5q2l5qih5byP77yM5Zyo5p+Q5Lqb5aSn6YeP6L+Q566X55qE5Zy65ZCI5byC5q2l5piv5b+F6aG755qE77yM5b+F6aG75Zyo5byC5q2l5aSE55CG5a6M5oiQ5pe26LCD55SoYXN5bmNFbmQo5LiN6IO955yf5byC5q2l5pe26ZyA55Soc2V0VGltZW91dOWMheijuSnvvIzlnKhvblByb2Nlc3PmiafooYzlkI7mlrDlop7nmoRidWZmZXLkvJrlhajpg6jmm7/mjaLmiJDnqbrmlbDnu4TvvIzlm6DmraTmnKzlm57osIPlvIDlpLTlupTnq4vljbPlsIZuZXdCdWZmZXJJZHjliLDmnKzmrKHlm57osIPnu5PlsL7kvY3nva7nmoRidWZmZXLlhajpg6jkv53lrZjliLDlj6blpJbkuIDkuKrmlbDnu4TlhoXvvIzlpITnkIblrozmiJDlkI7lhpnlm55idWZmZXJz5Lit5pys5qyh5Zue6LCD55qE57uT5bC+5L2N572u44CCXG5cdFx0XG5cdFx0Ly8qKioqKioq6auY57qn6K6+572uKioqKioqXG5cdFx0Ly8sZGlzYWJsZUVudkluRml4OmZhbHNlIOWGhemDqOWPguaVsO+8jOemgeeUqOiuvuWkh+WNoemhv+aXtumfs+mikei+k+WFpeS4ouWkseihpeWBv+WKn+iDvVxuXHRcdFxuXHRcdC8vLHRha2VvZmZFbmNvZGVDaHVuazpOT09QIC8vZm4oY2h1bmtCeXRlcykgY2h1bmtCeXRlcz1bVWludDgsLi4uXe+8muWunuaXtue8lueggeeOr+Wig+S4i+aOpeeuoee8lueggeWZqOi+k+WHuu+8jOW9k+e8lueggeWZqOWunuaXtue8lueggeWHuuS4gOWdl+acieaViOeahOS6jOi/m+WItumfs+mikeaVsOaNruaXtuWunuaXtuWbnuiwg+atpOaWueazle+8m+WPguaVsOS4uuS6jOi/m+WItueahFVpbnQ4QXJyYXnvvIzlsLHmmK/nvJbnoIHlh7rmnaXnmoTpn7PpopHmlbDmja7niYfmrrXvvIzmiYDmnInnmoRjaHVua0J5dGVz5ou85o6l5Zyo5LiA6LW35Y2z5Li65a6M5pW06Z+z6aKR44CC5pys5a6e546w55qE5oOz5rOV5pyA5Yid55SxUVEyNTQzNzc1MDQ45o+Q5Ye6XG5cdFx0XHRcdC8v5b2T5o+Q5L6b5q2k5Zue6LCD5pa55rOV5pe277yM5bCG5o6l566h57yW56CB5Zmo55qE5pWw5o2u6L6T5Ye677yM57yW56CB5Zmo5YaF6YOo5bCG5pS+5byD5a2Y5YKo55Sf5oiQ55qE6Z+z6aKR5pWw5o2u77yb546v5aKD6KaB5rGC5q+U6L6D6Iub5Yi777ya5aaC5p6c5b2T5YmN546v5aKD5LiN5pSv5oyB5a6e5pe257yW56CB5aSE55CG77yM5bCG5Zyob3BlbuaXtuebtOaOpei1sGZhaWzpgLvovpFcblx0XHRcdFx0Ly/lm6DmraTmj5DkvpvmraTlm57osIPlkI7osIPnlKhzdG9w5pa55rOV5bCG5peg5rOV6I635b6X5pyJ5pWI55qE6Z+z6aKR5pWw5o2u77yM5Zug5Li657yW56CB5Zmo5YaF5rKh5pyJ6Z+z6aKR5pWw5o2u77yM5Zug5q2kc3RvcOaXtui/lOWbnueahGJsb2LlsIbmmK/kuIDkuKrlrZfoioLplb/luqbkuLow55qEYmxvYlxuXHRcdFx0XHQvL+ebruWJjeWPquaciW1wM+agvOW8j+WunueOsOS6huWunuaXtue8luegge+8jOWcqOaUr+aMgeWunuaXtuWkhOeQhueahOeOr+Wig+S4reWwhuS8muWunuaXtueahOWwhue8lueggeWHuuadpeeahG1wM+eJh+autemAmui/h+atpOaWueazleWbnuiwg++8jOaJgOacieeahGNodW5rQnl0ZXPmi7zmjqXliLDkuIDotbfljbPkuLrlrozmlbTnmoRtcDPvvIzmraTnp43mi7zmjqXnmoTnu5Pmnpzmr5Rtb2Nr5pa55rOV5a6e5pe255Sf5oiQ55qE6Z+z6LSo5pu05Yqg77yM5Zug5Li65aSp54S26YG/5YWN5LqG6aaW5bC+55qE6Z2Z6buYXG5cdFx0XHRcdC8v55uu5YmN6ZmkbXAz5aSW5YW25LuW5qC85byP5LiN5Y+v5Lul5o+Q5L6b5q2k5Zue6LCD77yM5o+Q5L6b5LqG5bCG5Zyob3BlbuaXtuebtOaOpei1sGZhaWzpgLvovpFcblx0fTtcblx0XG5cdGZvcih2YXIgayBpbiBzZXQpe1xuXHRcdG9ba109c2V0W2tdO1xuXHR9O1xuXHR0aGlzLnNldD1vO1xuXHRcblx0dGhpcy5fUz05Oy8vc3RvcOWQjOatpemUge+8jHN0b3Dlj6/ku6XpmLvmraJvcGVu6L+H56iL5Lit6L+Y5pyq6L+Q6KGM55qEc3RhcnRcbn07XG4vL+WQjOatpemUge+8jOaOp+WItuWvuVN0cmVhbeeahOernuS6ie+8m+eUqOS6jmNsb3Nl5pe25Lit5pat5byC5q2l55qEb3Blbu+8m+S4gOS4quWvueixoW9wZW7lpoLmnpzlj5jljJbkuobpg73opoHpmLvmraJjbG9zZe+8jFN0cmVhbeeahOaOp+WItuadg+S6pOS4quaWsOeahOWvueixoVxuUmVjb3JkZXIuU3luYz17LypvcGVuKi9POjksLypjbG9zZSovQzo5fTtcblxuUmVjb3JkZXIucHJvdG90eXBlPWluaXRGbi5wcm90b3R5cGU9e1xuXHQvL+aJk+W8gOW9lemfs+i1hOa6kFRydWUoKSxGYWxzZShtc2csaXNVc2VyTm90QWxsb3cp77yM6ZyA6KaB6LCD55SoY2xvc2XjgILms6jmhI/vvJrmraTmlrnms5XmmK/lvILmraXnmoTvvJvkuIDoiKzkvb/nlKjml7bmiZPlvIDvvIznlKjlroznq4vljbPlhbPpl63vvJvlj6/ph43lpI3osIPnlKjvvIzlj6/nlKjmnaXmtYvor5XmmK/lkKbog73lvZXpn7Ncblx0b3BlbjpmdW5jdGlvbihUcnVlLEZhbHNlKXtcblx0XHR2YXIgVGhpcz10aGlzO1xuXHRcdFRydWU9VHJ1ZXx8Tk9PUDtcblx0XHR2YXIgZmFpbENhbGw9ZnVuY3Rpb24oZXJyTXNnLGlzVXNlck5vdEFsbG93KXtcblx0XHRcdGlzVXNlck5vdEFsbG93PSEhaXNVc2VyTm90QWxsb3c7XG5cdFx0XHRDTG9nKFwi5b2V6Z+zb3BlbuWksei0pe+8mlwiK2Vyck1zZytcIixpc1VzZXJOb3RBbGxvdzpcIitpc1VzZXJOb3RBbGxvdywxKTtcblx0XHRcdEZhbHNlJiZGYWxzZShlcnJNc2csaXNVc2VyTm90QWxsb3cpO1xuXHRcdH07XG5cdFx0XG5cdFx0dmFyIG9rPWZ1bmN0aW9uKCl7XG5cdFx0XHRDTG9nKFwib3BlbuaIkOWKn1wiKTtcblx0XHRcdFRydWUoKTtcblx0XHRcdFxuXHRcdFx0VGhpcy5fU089MDsvL+ino+mZpHN0b3Dlr7lvcGVu5Lit55qEc3RhcnTosIPnlKjnmoTpmLvmraJcblx0XHR9O1xuXHRcdHZhciBjb2RlRmFpbD1mdW5jdGlvbihjb2RlLG1zZyl7XG5cdFx0XHR0cnl7Ly/ot6jln5/nmoTkvJjlhYjmo4DmtYvkuIDkuItcblx0XHRcdFx0d2luZG93LnRvcC5hO1xuXHRcdFx0fWNhdGNoKGUpe1xuXHRcdFx0XHRmYWlsQ2FsbCgn5peg5p2D5b2V6Z+zKOi3qOWfn++8jOivt+Wwneivlee7mWlmcmFtZea3u+WKoOm6puWFi+mjjuiuv+mXruetlueVpe+8jOWmgmFsbG93PVwiY2FtZXJhO21pY3JvcGhvbmVcIiknKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fTtcblx0XHRcdFxuXHRcdFx0aWYoL1Blcm1pc3Npb258QWxsb3cvaS50ZXN0KGNvZGUpKXtcblx0XHRcdFx0ZmFpbENhbGwoXCLnlKjmiLfmi5Lnu53kuoblvZXpn7PmnYPpmZBcIix0cnVlKTtcblx0XHRcdH1lbHNlIGlmKHdpbmRvdy5pc1NlY3VyZUNvbnRleHQ9PT1mYWxzZSl7XG5cdFx0XHRcdGZhaWxDYWxsKFwi5peg5p2D5b2V6Z+zKOmcgGh0dHBzKVwiKTtcblx0XHRcdH1lbHNlIGlmKC9Gb3VuZC9pLnRlc3QoY29kZSkpey8v5Y+v6IO95piv6Z2e5a6J5YWo546v5aKD5a+86Ie055qE5rKh5pyJ6K6+5aSHXG5cdFx0XHRcdGZhaWxDYWxsKG1zZytcIu+8jOaXoOWPr+eUqOm6puWFi+mjjlwiKTtcblx0XHRcdH1lbHNle1xuXHRcdFx0XHRmYWlsQ2FsbChtc2cpO1xuXHRcdFx0fTtcblx0XHR9O1xuXHRcdFxuXHRcdC8v5ZCM5q2l6ZSBXG5cdFx0dmFyIExvY2s9UmVjb3JkZXIuU3luYztcblx0XHR2YXIgbG9ja09wZW49KytMb2NrLk8sbG9ja0Nsb3NlPUxvY2suQztcblx0XHRUaGlzLl9PPVRoaXMuX09fPWxvY2tPcGVuOy8v6K6w5L2P5b2T5YmN55qEb3Blbu+8jOWmguaenOWPmOWMluS6huimgemYu+atomNsb3Nl77yM6L+Z6YeM5YGH5a6a5LqG5paw5a+56LGh5bey5Y+W5Luj5b2T5YmN5a+56LGh5bm25LiU5LiN5YaN5L2/55SoXG5cdFx0VGhpcy5fU089VGhpcy5fUzsvL+iusOS9j29wZW7ov4fnqIvkuK3nmoRzdG9w77yM5Lit6YCU5Lu75L2Vc3RvcOiwg+eUqOWQjumDveS4jeiDvee7p+e7rW9wZW7kuK3nmoRzdGFydFxuXHRcdHZhciBsb2NrRmFpbD1mdW5jdGlvbigpe1xuXHRcdFx0Ly/lhYHorrjlpJrmrKFvcGVu77yM5L2G5LiN5YWB6K645Lu75L2V5LiA5qyhY2xvc2XvvIzmiJbogIXoh6rouqvlt7Lnu4/osIPnlKjkuoblhbPpl61cblx0XHRcdGlmKGxvY2tDbG9zZSE9TG9jay5DIHx8ICFUaGlzLl9PKXtcblx0XHRcdFx0dmFyIGVycj1cIm9wZW7ooqvlj5bmtohcIjtcblx0XHRcdFx0aWYobG9ja09wZW49PUxvY2suTyl7XG5cdFx0XHRcdFx0Ly/ml6DmlrDnmoRvcGVu77yM5bey57uP6LCD55So5LqGY2xvc2Xov5vooYzlj5bmtojvvIzmraTlpITlupTorqnkuIrmrKHnmoRjbG9zZeaYjuehrueUn+aViFxuXHRcdFx0XHRcdFRoaXMuY2xvc2UoKTtcblx0XHRcdFx0fWVsc2V7XG5cdFx0XHRcdFx0ZXJyPVwib3Blbuiiq+S4reaWrVwiO1xuXHRcdFx0XHR9O1xuXHRcdFx0XHRmYWlsQ2FsbChlcnIpO1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH07XG5cdFx0fTtcblx0XHRcblx0XHRcblx0XHQvL+WmguaenOW3suaJk+W8gOWwseS4jeimgeWGjeaJk+W8gOS6hlxuXHRcdGlmKFJlY29yZGVyLklzT3BlbigpKXtcblx0XHRcdG9rKCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fTtcblx0XHRpZighUmVjb3JkZXIuU3VwcG9ydCgpKXtcblx0XHRcdGNvZGVGYWlsKFwiXCIsXCLmraTmtY/op4jlmajkuI3mlK/mjIHlvZXpn7NcIik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fTtcblx0XHRcblx0XHQvL+eOr+Wig+mFjee9ruajgOafpVxuXHRcdHZhciBjaGVja01zZz1UaGlzLmVudkNoZWNrKHtlbnZOYW1lOlwiSDVcIixjYW5Qcm9jZXNzOnRydWV9KTtcblx0XHRpZihjaGVja01zZyl7XG5cdFx0XHRmYWlsQ2FsbChcIuS4jeiDveW9lemfs++8mlwiK2NoZWNrTXNnKTtcblx0XHRcdHJldHVybjtcblx0XHR9O1xuXHRcdFxuXHRcdC8v6K+35rGC5p2D6ZmQ77yM5aaC5p6c5LuO5pyq5o6I5p2D77yM5LiA6Iis5rWP6KeI5Zmo5Lya5by55Ye65p2D6ZmQ6K+35rGC5by55qGGXG5cdFx0dmFyIGYxPWZ1bmN0aW9uKHN0cmVhbSl7XG5cdFx0XHRSZWNvcmRlci5TdHJlYW09c3RyZWFtO1xuXHRcdFx0c3RyZWFtLl9jYWxsPXt9Oy8v5q2k5pe2aXMgb3Blbu+8jOS9huW5tuacqmNvbm5lY3TvvIzmmK/lhYHorrjnu5HlrprmjqXmlLbmlbDmja7nmoRcblx0XHRcdGlmKGxvY2tGYWlsKCkpcmV0dXJuO1xuXHRcdFx0XG5cdFx0XHQvL2h0dHBzOi8vZ2l0aHViLmNvbS94aWFuZ3l1ZWNuL1JlY29yZGVyL2lzc3Vlcy8xNCDojrflj5bliLDnmoR0cmFjay5yZWFkeVN0YXRlIT1cImxpdmVcIu+8jOWImuWImuWbnuiwg+aXtuWPr+iDveaYr+ato+W4uOeahO+8jOS9hui/h+S4gOS4i+WPr+iDveWwseiiq+WFs+aOieS6hu+8jOWOn+WboOS4jeaYjuOAguW7tui/n+S4gOS4i+S/neivgeecn+W8guatpeOAguWvueato+W4uOa1j+iniOWZqOS4jeW9seWTjVxuXHRcdFx0c2V0VGltZW91dChmdW5jdGlvbigpe1xuXHRcdFx0XHRpZihsb2NrRmFpbCgpKXJldHVybjtcblx0XHRcdFx0XG5cdFx0XHRcdGlmKFJlY29yZGVyLklzT3BlbigpKXtcblx0XHRcdFx0XHRDb25uZWN0KCk7XG5cdFx0XHRcdFx0b2soKTtcblx0XHRcdFx0fWVsc2V7XG5cdFx0XHRcdFx0ZmFpbENhbGwoXCLlvZXpn7Plip/og73ml6DmlYjvvJrml6Dpn7PpopHmtYFcIik7XG5cdFx0XHRcdH07XG5cdFx0XHR9LDEwMCk7XG5cdFx0fTtcblx0XHR2YXIgZjI9ZnVuY3Rpb24oZSl7XG5cdFx0XHR2YXIgY29kZT1lLm5hbWV8fGUubWVzc2FnZXx8ZS5jb2RlK1wiOlwiK2U7XG5cdFx0XHRDTG9nKFwi6K+35rGC5b2V6Z+z5p2D6ZmQ6ZSZ6K+vXCIsMSxlKTtcblx0XHRcdFxuXHRcdFx0Y29kZUZhaWwoY29kZSxcIuaXoOazleW9lemfs++8mlwiK2NvZGUpO1xuXHRcdH07XG5cdFx0dmFyIHBybz1SZWNvcmRlci5TY29wZS5nZXRVc2VyTWVkaWEoe2F1ZGlvOnRydWV9LGYxLGYyKTtcblx0XHRpZihwcm8mJnByby50aGVuKXtcblx0XHRcdHByby50aGVuKGYxKVtUcnVlJiZcImNhdGNoXCJdKGYyKTsgLy9maXgg5YWz6ZSu5a2X77yM5L+d6K+BY2F0Y2jljovnvKnml7bkv53mjIHlrZfnrKbkuLLlvaLlvI9cblx0XHR9O1xuXHR9XG5cdC8v5YWz6Zet6YeK5pS+5b2V6Z+z6LWE5rqQXG5cdCxjbG9zZTpmdW5jdGlvbihjYWxsKXtcblx0XHRjYWxsPWNhbGx8fE5PT1A7XG5cdFx0XG5cdFx0dmFyIFRoaXM9dGhpcztcblx0XHRUaGlzLl9zdG9wKCk7XG5cdFx0XG5cdFx0dmFyIExvY2s9UmVjb3JkZXIuU3luYztcblx0XHRUaGlzLl9PPTA7XG5cdFx0aWYoVGhpcy5fT18hPUxvY2suTyl7XG5cdFx0XHQvL+WUr+S4gOi1hOa6kFN0cmVhbeeahOaOp+WItuadg+W3suS6pOe7meaWsOWvueixoe+8jOi/memHjOS4jeiDveWFs+mXreOAguatpOWkhOWcqOavj+asoemDveW8ueadg+mZkOeahOa1j+iniOWZqOWGheWPr+iDveWtmOWcqOazhOa8j++8jOaWsOWvueixoeiiq+aLkue7neadg+mZkOWPr+iDveS4jeS8muiwg+eUqGNsb3Nl77yM5b+955Wl6L+Z56eN5LiN5aSE55CGXG5cdFx0XHRDTG9nKFwiY2xvc2Xooqvlv73nlaVcIiwzKTtcblx0XHRcdGNhbGwoKTtcblx0XHRcdHJldHVybjtcblx0XHR9O1xuXHRcdExvY2suQysrOy8v6I635b6X5o6n5Yi25p2DXG5cdFx0XG5cdFx0dmFyIHN0cmVhbT1SZWNvcmRlci5TdHJlYW07XG5cdFx0aWYoc3RyZWFtKXtcblx0XHRcdERpc2Nvbm5lY3QoKTtcblx0XHRcdFxuXHRcdFx0dmFyIHRyYWNrcz1zdHJlYW0uZ2V0VHJhY2tzJiZzdHJlYW0uZ2V0VHJhY2tzKCl8fHN0cmVhbS5hdWRpb1RyYWNrc3x8W107XG5cdFx0XHRmb3IodmFyIGk9MDtpPHRyYWNrcy5sZW5ndGg7aSsrKXtcblx0XHRcdFx0dmFyIHRyYWNrPXRyYWNrc1tpXTtcblx0XHRcdFx0dHJhY2suc3RvcCYmdHJhY2suc3RvcCgpO1xuXHRcdFx0fTtcblx0XHRcdHN0cmVhbS5zdG9wJiZzdHJlYW0uc3RvcCgpO1xuXHRcdH07XG5cdFx0XG5cdFx0UmVjb3JkZXIuU3RyZWFtPTA7XG5cdFx0Q0xvZyhcImNsb3NlXCIpO1xuXHRcdGNhbGwoKTtcblx0fVxuXHRcblx0XG5cdFxuXHRcblx0XG5cdC8q5qih5ouf5LiA5q615b2V6Z+z5pWw5o2u77yM5ZCO6Z2i5Y+v5Lul6LCD55Soc3RvcOi/m+ihjOe8luegge+8jOmcgOaPkOS+m3BjbeaVsOaNrlsxLDIsMy4uLl3vvIxwY23nmoTph4fmoLfnjocqL1xuXHQsbW9jazpmdW5jdGlvbihwY21EYXRhLHBjbVNhbXBsZVJhdGUpe1xuXHRcdHZhciBUaGlzPXRoaXM7XG5cdFx0VGhpcy5fc3RvcCgpOy8v5riF55CG5o6J5bey5pyJ55qE6LWE5rqQXG5cdFx0XG5cdFx0VGhpcy5pc01vY2s9MTtcblx0XHRUaGlzLm1vY2tFbnZJbmZvPW51bGw7XG5cdFx0VGhpcy5idWZmZXJzPVtwY21EYXRhXTtcblx0XHRUaGlzLnJlY1NpemU9cGNtRGF0YS5sZW5ndGg7XG5cdFx0VGhpcy5zcmNTYW1wbGVSYXRlPXBjbVNhbXBsZVJhdGU7XG5cdFx0cmV0dXJuIFRoaXM7XG5cdH1cblx0LGVudkNoZWNrOmZ1bmN0aW9uKGVudkluZm8pey8v5bmz5Y+w546v5aKD5LiL55qE5Y+v55So5oCn5qOA5p+l77yM5Lu75L2V5pe25YCZ6YO95Y+v5Lul6LCD55So5qOA5p+l77yM6L+U5ZueZXJyTXNnOlwiXCLmraPluLjvvIxcIuWksei0peWOn+WboFwiXG5cdFx0Ly9lbnZJbmZvPXtlbnZOYW1lOlwiSDVcIixjYW5Qcm9jZXNzOnRydWV9XG5cdFx0dmFyIGVyck1zZyxUaGlzPXRoaXMsc2V0PVRoaXMuc2V0O1xuXHRcdFxuXHRcdC8v57yW56CB5Zmo5qOA5p+l546v5aKD5LiL6YWN572u5piv5ZCm5Y+v55SoXG5cdFx0aWYoIWVyck1zZyl7XG5cdFx0XHRpZihUaGlzW3NldC50eXBlK1wiX2VudkNoZWNrXCJdKXsvL+e8lueggeWZqOW3suWunueOsOeOr+Wig+ajgOafpVxuXHRcdFx0XHRlcnJNc2c9VGhpc1tzZXQudHlwZStcIl9lbnZDaGVja1wiXShlbnZJbmZvLHNldCk7XG5cdFx0XHR9ZWxzZXsvL+acquWunueOsOajgOafpeeahOaJi+WKqOajgOafpemFjee9ruaYr+WQpuacieaViFxuXHRcdFx0XHRpZihzZXQudGFrZW9mZkVuY29kZUNodW5rKXtcblx0XHRcdFx0XHRlcnJNc2c9c2V0LnR5cGUrXCLnsbvlnovkuI3mlK/mjIHorr7nva50YWtlb2ZmRW5jb2RlQ2h1bmtcIjtcblx0XHRcdFx0fTtcblx0XHRcdH07XG5cdFx0fTtcblx0XHRcblx0XHRyZXR1cm4gZXJyTXNnfHxcIlwiO1xuXHR9XG5cdCxlbnZTdGFydDpmdW5jdGlvbihtb2NrRW52SW5mbyxzYW1wbGVSYXRlKXsvL+W5s+WPsOeOr+Wig+ebuOWFs+eahHN0YXJ06LCD55SoXG5cdFx0dmFyIFRoaXM9dGhpcyxzZXQ9VGhpcy5zZXQ7XG5cdFx0VGhpcy5pc01vY2s9bW9ja0VudkluZm8/MTowOy8v6Z2eSDXnjq/looPpnIDopoHlkK/nlKhtb2Nr77yM5bm25o+Q5L6bZW52Q2hlY2vpnIDopoHnmoTnjq/looPkv6Hmga9cblx0XHRUaGlzLm1vY2tFbnZJbmZvPW1vY2tFbnZJbmZvO1xuXHRcdFRoaXMuYnVmZmVycz1bXTsvL+aVsOaNrue8k+WGslxuXHRcdFRoaXMucmVjU2l6ZT0wOy8v5pWw5o2u5aSn5bCPXG5cdFx0XG5cdFx0VGhpcy5lbnZJbkxhc3Q9MDsvL2Vudklu5o6l5pS25Yiw5pyA5ZCO5b2V6Z+z5YaF5a6555qE5pe26Ze0XG5cdFx0VGhpcy5lbnZJbkZpcnN0PTA7Ly9lbnZJbuaOpeaUtuWIsOeahOmmluS4quW9lemfs+WGheWuueeahOW9leWItuaXtumXtFxuXHRcdFRoaXMuZW52SW5GaXg9MDsvL+ihpeWBv+eahOaAu+aXtumXtFxuXHRcdFRoaXMuZW52SW5GaXhUcz1bXTsvL+ihpeWBv+iuoeaVsOWIl+ihqFxuXHRcdFxuXHRcdHNldC5zYW1wbGVSYXRlPU1hdGgubWluKHNhbXBsZVJhdGUsc2V0LnNhbXBsZVJhdGUpOy8vZW5naW5lQ3R46ZyA6KaB5o+Q5YmN56Gu5a6a5pyA57uI55qE6YeH5qC3546HXG5cdFx0VGhpcy5zcmNTYW1wbGVSYXRlPXNhbXBsZVJhdGU7XG5cdFx0XG5cdFx0VGhpcy5lbmdpbmVDdHg9MDtcblx0XHQvL+atpOexu+Wei+aciei+ueW9lei+uei9rOeggShXb3JrZXIp5pSv5oyBXG5cdFx0aWYoVGhpc1tzZXQudHlwZStcIl9zdGFydFwiXSl7XG5cdFx0XHR2YXIgZW5naW5lQ3R4PVRoaXMuZW5naW5lQ3R4PVRoaXNbc2V0LnR5cGUrXCJfc3RhcnRcIl0oc2V0KTtcblx0XHRcdGlmKGVuZ2luZUN0eCl7XG5cdFx0XHRcdGVuZ2luZUN0eC5wY21EYXRhcz1bXTtcblx0XHRcdFx0ZW5naW5lQ3R4LnBjbVNpemU9MDtcblx0XHRcdH07XG5cdFx0fTtcblx0fVxuXHQsZW52UmVzdW1lOmZ1bmN0aW9uKCl7Ly/lkozlubPlj7Dnjq/looPml6DlhbPnmoTmgaLlpI3lvZXpn7Ncblx0XHQvL+mHjeaWsOW8gOWni+iuoeaVsFxuXHRcdHRoaXMuZW52SW5GaXhUcz1bXTtcblx0fVxuXHQsZW52SW46ZnVuY3Rpb24ocGNtLHN1bSl7Ly/lkozlubPlj7Dnjq/looPml6DlhbPnmoRwY21bSW50MTZd6L6T5YWlXG5cdFx0dmFyIFRoaXM9dGhpcyxzZXQ9VGhpcy5zZXQsZW5naW5lQ3R4PVRoaXMuZW5naW5lQ3R4O1xuXHRcdHZhciBidWZmZXJTYW1wbGVSYXRlPVRoaXMuc3JjU2FtcGxlUmF0ZTtcblx0XHR2YXIgc2l6ZT1wY20ubGVuZ3RoO1xuXHRcdHZhciBwb3dlckxldmVsPVJlY29yZGVyLlBvd2VyTGV2ZWwoc3VtLHNpemUpO1xuXHRcdFxuXHRcdHZhciBidWZmZXJzPVRoaXMuYnVmZmVycztcblx0XHR2YXIgYnVmZmVyRmlyc3RJZHg9YnVmZmVycy5sZW5ndGg7Ly/kuYvliY3nmoRidWZmZXLpg73mmK/nu4/ov4dvblByb2Nlc3PlpITnkIblpb3nmoTvvIzkuI3lhYHorrjlho3kv67mlLlcblx0XHRidWZmZXJzLnB1c2gocGNtKTtcblx0XHRcblx0XHQvL+aciWVuZ2luZUN0eOaXtuS8muiiq+imhueblu+8jOi/memHjOS/neWtmOS4gOS7vVxuXHRcdHZhciBidWZmZXJzVGhpcz1idWZmZXJzO1xuXHRcdHZhciBidWZmZXJGaXJzdElkeFRoaXM9YnVmZmVyRmlyc3RJZHg7XG5cdFx0XG5cdFx0Ly/ljaHpob/kuKLlpLHooaXlgb/vvJrlm6DkuLrorr7lpIflvojljaHnmoTml7blgJnlr7zoh7RINeaOpeaUtuWIsOeahOaVsOaNrumHj+S4jeWkn+mAoOaIkOaSreaUvuaXtuWAmeWPmOmAn++8jOe7k+aenOavlOWunumZheeahOaXtumVv+imgeefre+8jOatpOWkhOS/neivgeS6huS4jeS8muWPmOefre+8jOS9huS4jeiDveS/ruWkjeS4ouWkseeahOmfs+mikeaVsOaNrumAoOaIkOmfs+i0qOWPmOW3ruOAguW9k+WJjeeul+azlemHh+eUqOi+k+WFpeaXtumXtOS+pua1i+S4i+S4gOW4p+aYr+WQpumcgOimgea3u+WKoOihpeWBv+W4p++8jOmcgOimgSg25qyh6L6T5YWlfHzotoXov4cx56eSKeS7peS4iuaJjeS8muW8gOWni+S+pua1i++8jOWmguaenOa7keWKqOeql+WPo+WGheS4ouWksei2hei/hzEvM+WwseS8mui/m+ihjOihpeWBv1xuXHRcdHZhciBub3c9RGF0ZS5ub3coKTtcblx0XHR2YXIgcGNtVGltZT1NYXRoLnJvdW5kKHNpemUvYnVmZmVyU2FtcGxlUmF0ZSoxMDAwKTtcblx0XHRUaGlzLmVudkluTGFzdD1ub3c7XG5cdFx0aWYoVGhpcy5idWZmZXJzLmxlbmd0aD09MSl7Ly/orrDkuIvpppbkuKrlvZXpn7PmlbDmja7nmoTlvZXliLbml7bpl7Rcblx0XHRcdFRoaXMuZW52SW5GaXJzdD1ub3ctcGNtVGltZTtcblx0XHR9O1xuXHRcdHZhciBlbnZJbkZpeFRzPVRoaXMuZW52SW5GaXhUcztcblx0XHRlbnZJbkZpeFRzLnNwbGljZSgwLDAse3Q6bm93LGQ6cGNtVGltZX0pO1xuXHRcdC8v5L+d55WZM+enkueahOiuoeaVsOa7keWKqOeql+WPo++8jOWPpuWklui2hei/hzPnp5LnmoTlgZzpob/kuI3ooaXlgb9cblx0XHR2YXIgdHNJblN0YXJ0PW5vdyx0c1BjbT0wO1xuXHRcdGZvcih2YXIgaT0wO2k8ZW52SW5GaXhUcy5sZW5ndGg7aSsrKXtcblx0XHRcdHZhciBvPWVudkluRml4VHNbaV07XG5cdFx0XHRpZihub3ctby50PjMwMDApe1xuXHRcdFx0XHRlbnZJbkZpeFRzLmxlbmd0aD1pO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdH07XG5cdFx0XHR0c0luU3RhcnQ9by50O1xuXHRcdFx0dHNQY20rPW8uZDtcblx0XHR9O1xuXHRcdC8v6L6+5Yiw6ZyA6KaB55qE5pWw5o2u6YeP77yM5byA5aeL5L6m5rWL5piv5ZCm6ZyA6KaB6KGl5YG/XG5cdFx0dmFyIHRzSW5QcmV2PWVudkluRml4VHNbMV07XG5cdFx0dmFyIHRzSW49bm93LXRzSW5TdGFydDtcblx0XHR2YXIgbG9zdD10c0luLXRzUGNtO1xuXHRcdGlmKCBsb3N0PnRzSW4vMyAmJiAodHNJblByZXYmJnRzSW4+MTAwMCB8fCBlbnZJbkZpeFRzLmxlbmd0aD49NikgKXtcblx0XHRcdC8v5Lii5aSx6L+H5aSa77yM5byA5aeL5omn6KGM6KGl5YG/XG5cdFx0XHR2YXIgYWRkVGltZT1ub3ctdHNJblByZXYudC1wY21UaW1lOy8v6Led56a75LiK5qyh6L6T5YWl5Lii5aSx6L+Z5LmI5aSabXNcblx0XHRcdGlmKGFkZFRpbWU+cGNtVGltZS81KXsvL+S4ouWksei2hei/h+acrOW4p+eahDEvNVxuXHRcdFx0XHR2YXIgZml4T3Blbj0hc2V0LmRpc2FibGVFbnZJbkZpeDtcblx0XHRcdFx0Q0xvZyhcIltcIitub3crXCJdXCIrKGZpeE9wZW4/XCJcIjpcIuacqlwiKStcIuihpeWBv1wiK2FkZFRpbWUrXCJtc1wiLDMpO1xuXHRcdFx0XHRUaGlzLmVudkluRml4Kz1hZGRUaW1lO1xuXHRcdFx0XHRcblx0XHRcdFx0Ly/nlKjpnZnpu5jov5vooYzooaXlgb9cblx0XHRcdFx0aWYoZml4T3Blbil7XG5cdFx0XHRcdFx0dmFyIGFkZFBjbT1uZXcgSW50MTZBcnJheShhZGRUaW1lKmJ1ZmZlclNhbXBsZVJhdGUvMTAwMCk7XG5cdFx0XHRcdFx0c2l6ZSs9YWRkUGNtLmxlbmd0aDtcblx0XHRcdFx0XHRidWZmZXJzLnB1c2goYWRkUGNtKTtcblx0XHRcdFx0fTtcblx0XHRcdH07XG5cdFx0fTtcblx0XHRcblx0XHRcblx0XHR2YXIgc2l6ZU9sZD1UaGlzLnJlY1NpemUsYWRkU2l6ZT1zaXplO1xuXHRcdHZhciBidWZmZXJTaXplPXNpemVPbGQrYWRkU2l6ZTtcblx0XHRUaGlzLnJlY1NpemU9YnVmZmVyU2l6ZTsvL+atpOWAvOWcqG9uUHJvY2Vzc+WQjumcgOimgeS/ruato++8jOWPr+iDveaWsOaVsOaNruiiq+S/ruaUuVxuXHRcdFxuXHRcdFxuXHRcdC8v5q2k57G75Z6L5pyJ6L655b2V6L656L2s56CBKFdvcmtlcinmlK/mjIHvvIzlvIDlkK/lrp7ml7bovaznoIFcblx0XHRpZihlbmdpbmVDdHgpe1xuXHRcdFx0Ly/ovazmjaLmiJBzZXTnmoTph4fmoLfnjodcblx0XHRcdHZhciBjaHVua0luZm89UmVjb3JkZXIuU2FtcGxlRGF0YShidWZmZXJzLGJ1ZmZlclNhbXBsZVJhdGUsc2V0LnNhbXBsZVJhdGUsZW5naW5lQ3R4LmNodW5rSW5mbyk7XG5cdFx0XHRlbmdpbmVDdHguY2h1bmtJbmZvPWNodW5rSW5mbztcblx0XHRcdFxuXHRcdFx0c2l6ZU9sZD1lbmdpbmVDdHgucGNtU2l6ZTtcblx0XHRcdGFkZFNpemU9Y2h1bmtJbmZvLmRhdGEubGVuZ3RoO1xuXHRcdFx0YnVmZmVyU2l6ZT1zaXplT2xkK2FkZFNpemU7XG5cdFx0XHRlbmdpbmVDdHgucGNtU2l6ZT1idWZmZXJTaXplOy8v5q2k5YC85Zyob25Qcm9jZXNz5ZCO6ZyA6KaB5L+u5q2j77yM5Y+v6IO95paw5pWw5o2u6KKr5L+u5pS5XG5cdFx0XHRcblx0XHRcdGJ1ZmZlcnM9ZW5naW5lQ3R4LnBjbURhdGFzO1xuXHRcdFx0YnVmZmVyRmlyc3RJZHg9YnVmZmVycy5sZW5ndGg7XG5cdFx0XHRidWZmZXJzLnB1c2goY2h1bmtJbmZvLmRhdGEpO1xuXHRcdFx0YnVmZmVyU2FtcGxlUmF0ZT1jaHVua0luZm8uc2FtcGxlUmF0ZTtcblx0XHR9O1xuXHRcdFxuXHRcdHZhciBkdXJhdGlvbj1NYXRoLnJvdW5kKGJ1ZmZlclNpemUvYnVmZmVyU2FtcGxlUmF0ZSoxMDAwKTtcblx0XHR2YXIgYnVmZmVyTmV4dElkeD1idWZmZXJzLmxlbmd0aDtcblx0XHR2YXIgYnVmZmVyTmV4dElkeFRoaXM9YnVmZmVyc1RoaXMubGVuZ3RoO1xuXHRcdFxuXHRcdC8v5YWB6K645byC5q2l5aSE55CGYnVmZmVy5pWw5o2uXG5cdFx0dmFyIGFzeW5jRW5kPWZ1bmN0aW9uKCl7XG5cdFx0XHQvL+mHjeaWsOiuoeeul3NpemXvvIzlvILmraXnmoTml6nlt7Llh4/ljrvmt7vliqDnmoTvvIzlkIzmraXnmoTpnIDljrvmjonmnKzmrKHmt7vliqDnmoTnhLblkI7ph43mlrDorqHnrpdcblx0XHRcdHZhciBudW09YXN5bmNCZWdpbj8wOi1hZGRTaXplO1xuXHRcdFx0dmFyIGhhc0NsZWFyPWJ1ZmZlcnNbMF09PW51bGw7XG5cdFx0XHRmb3IodmFyIGk9YnVmZmVyRmlyc3RJZHg7aTxidWZmZXJOZXh0SWR4O2krKyl7XG5cdFx0XHRcdHZhciBidWZmZXI9YnVmZmVyc1tpXTtcblx0XHRcdFx0aWYoYnVmZmVyPT1udWxsKXsvL+W3suiiq+S4u+WKqOmHiuaUvuWGheWtmO+8jOavlOWmgumVv+aXtumXtOWunuaXtuS8oOi+k+W9lemfs+aXtlxuXHRcdFx0XHRcdGhhc0NsZWFyPTE7XG5cdFx0XHRcdH1lbHNle1xuXHRcdFx0XHRcdG51bSs9YnVmZmVyLmxlbmd0aDtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvL+aOqOWFpeWQjuWPsOi+ueW9lei+uei9rOeggVxuXHRcdFx0XHRcdGlmKGVuZ2luZUN0eCYmYnVmZmVyLmxlbmd0aCl7XG5cdFx0XHRcdFx0XHRUaGlzW3NldC50eXBlK1wiX2VuY29kZVwiXShlbmdpbmVDdHgsYnVmZmVyKTtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9O1xuXHRcdFx0fTtcblx0XHRcdFxuXHRcdFx0Ly/lkIzmraXmuIXnkIZUaGlzLmJ1ZmZlcnPvvIzkuI3nrqFidWZmZXJz5Yiw5bqV5riF5LqG5aSa5bCR5Liq77yMYnVmZmVyc1RoaXPmmK/kvb/nlKjkuI3liLDnmoTov5vooYzlhajmuIVcblx0XHRcdGlmKGhhc0NsZWFyICYmIGVuZ2luZUN0eCl7XG5cdFx0XHRcdHZhciBpPWJ1ZmZlckZpcnN0SWR4VGhpcztcblx0XHRcdFx0aWYoYnVmZmVyc1RoaXNbMF0pe1xuXHRcdFx0XHRcdGk9MDtcblx0XHRcdFx0fTtcblx0XHRcdFx0Zm9yKDtpPGJ1ZmZlck5leHRJZHhUaGlzO2krKyl7XG5cdFx0XHRcdFx0YnVmZmVyc1RoaXNbaV09bnVsbDtcblx0XHRcdFx0fTtcblx0XHRcdH07XG5cdFx0XHRcblx0XHRcdC8v57uf6K6h5L+u5pS55ZCO55qEc2l6Ze+8jOWmguaenOW8guatpeWPkeeUn2NsZWFy6KaB5Y6f5qC35Yqg5Zue5p2l77yM5ZCM5q2l55qE5peg6ZyA5pON5L2cXG5cdFx0XHRpZihoYXNDbGVhcil7XG5cdFx0XHRcdG51bT1hc3luY0JlZ2luP2FkZFNpemU6MDtcblx0XHRcdFx0XG5cdFx0XHRcdGJ1ZmZlcnNbMF09bnVsbDsvL+W9u+W6leiiq+a4heeQhlxuXHRcdFx0fTtcblx0XHRcdGlmKGVuZ2luZUN0eCl7XG5cdFx0XHRcdGVuZ2luZUN0eC5wY21TaXplKz1udW07XG5cdFx0XHR9ZWxzZXtcblx0XHRcdFx0VGhpcy5yZWNTaXplKz1udW07XG5cdFx0XHR9O1xuXHRcdH07XG5cdFx0Ly/lrp7ml7blm57osIPlpITnkIbmlbDmja7vvIzlhYHorrjkv67mlLnmiJbmm7/mjaLkuIrmrKHlm57osIPku6XmnaXmlrDlop7nmoTmlbDmja4g77yM5L2G5piv5LiN5YWB6K645L+u5pS55bey5aSE55CG6L+H55qE77yM5LiN5YWB6K645aKe5Yig56ys5LiA57u05pWw57uEIO+8jOWFgeiuuOWwhuesrOS6jOe7tOaVsOe7hOS7u+aEj+S/ruaUueabv+aNouaIkOepuuaVsOe7hOS5n+WPr+S7pVxuXHRcdHZhciBhc3luY0JlZ2luPXNldC5vblByb2Nlc3MoYnVmZmVycyxwb3dlckxldmVsLGR1cmF0aW9uLGJ1ZmZlclNhbXBsZVJhdGUsYnVmZmVyRmlyc3RJZHgsYXN5bmNFbmQpO1xuXHRcdFxuXHRcdGlmKGFzeW5jQmVnaW49PT10cnVlKXtcblx0XHRcdC8v5byA5ZCv5LqG5byC5q2l5qih5byP77yMb25Qcm9jZXNz5bey5o6l566hYnVmZmVyc+aWsOaVsOaNru+8jOeri+WNs+a4heepuu+8jOmBv+WFjeWHuueOsOacquWkhOeQhueahOaVsOaNrlxuXHRcdFx0dmFyIGhhc0NsZWFyPTA7XG5cdFx0XHRmb3IodmFyIGk9YnVmZmVyRmlyc3RJZHg7aTxidWZmZXJOZXh0SWR4O2krKyl7XG5cdFx0XHRcdGlmKGJ1ZmZlcnNbaV09PW51bGwpey8v5bey6KKr5Li75Yqo6YeK5pS+5YaF5a2Y77yM5q+U5aaC6ZW/5pe26Ze05a6e5pe25Lyg6L6T5b2V6Z+z5pe2IO+8jOS9huWPiOimgeW8gOWQr+W8guatpeaooeW8j++8jOatpOenjeaDheWGteaYr+mdnuazleeahFxuXHRcdFx0XHRcdGhhc0NsZWFyPTE7XG5cdFx0XHRcdH1lbHNle1xuXHRcdFx0XHRcdGJ1ZmZlcnNbaV09bmV3IEludDE2QXJyYXkoMCk7XG5cdFx0XHRcdH07XG5cdFx0XHR9O1xuXHRcdFx0XG5cdFx0XHRpZihoYXNDbGVhcil7XG5cdFx0XHRcdENMb2coXCLmnKrov5vlhaXlvILmraXliY3kuI3og73muIXpmaRidWZmZXJzXCIsMyk7XG5cdFx0XHR9ZWxzZXtcblx0XHRcdFx0Ly/ov5jljp9zaXpl77yM5byC5q2l57uT5p2f5ZCO5YaN57uf6K6h5LuF5L+u5pS55ZCO55qEc2l6Ze+8jOWmguaenOWPkeeUn2NsZWFy6KaB5Y6f5qC35Yqg5Zue5p2lXG5cdFx0XHRcdGlmKGVuZ2luZUN0eCl7XG5cdFx0XHRcdFx0ZW5naW5lQ3R4LnBjbVNpemUtPWFkZFNpemU7XG5cdFx0XHRcdH1lbHNle1xuXHRcdFx0XHRcdFRoaXMucmVjU2l6ZS09YWRkU2l6ZTtcblx0XHRcdFx0fTtcblx0XHRcdH07XG5cdFx0fWVsc2V7XG5cdFx0XHRhc3luY0VuZCgpO1xuXHRcdH07XG5cdH1cblx0XG5cdFxuXHRcblx0XG5cdC8v5byA5aeL5b2V6Z+z77yM6ZyA5YWI6LCD55Sob3Blbu+8m+WPquimgW9wZW7miJDlip/ml7bvvIzosIPnlKjmraTmlrnms5XmmK/lronlhajnmoTvvIzlpoLmnpzmnKpvcGVu5by66KGM6LCD55So5a+86Ie055qE5YaF6YOo6ZSZ6K+v5bCG5LiN5Lya5pyJ5Lu75L2V5o+Q56S677yMc3RvcOaXtuiHqueEtuiDveW+l+WIsOmUmeivr1xuXHQsc3RhcnQ6ZnVuY3Rpb24oKXtcblx0XHRpZighUmVjb3JkZXIuSXNPcGVuKCkpe1xuXHRcdFx0Q0xvZyhcIuacqm9wZW5cIiwxKTtcblx0XHRcdHJldHVybjtcblx0XHR9O1xuXHRcdENMb2coXCLlvIDlp4vlvZXpn7NcIik7XG5cdFx0XG5cdFx0dmFyIFRoaXM9dGhpcyxzZXQ9VGhpcy5zZXQsY3R4PVJlY29yZGVyLkN0eDtcblx0XHRUaGlzLl9zdG9wKCk7XG5cdFx0VGhpcy5zdGF0ZT0wO1xuXHRcdFRoaXMuZW52U3RhcnQobnVsbCxjdHguc2FtcGxlUmF0ZSk7XG5cdFx0XG5cdFx0Ly/mo4Dmn6VvcGVu6L+H56iL5Litc3RvcOaYr+WQpuW3sue7j+iwg+eUqOi/h1xuXHRcdGlmKFRoaXMuX1NPJiZUaGlzLl9TTysxIT1UaGlzLl9TKXsvL+S4iumdouiwg+eUqOi/h+S4gOasoSBfc3RvcFxuXHRcdFx0Ly9vcGVu5pyq5a6M5oiQ5bCx6LCD55So5LqGc3RvcO+8jOatpOenjeaDheWGtee7iOatonN0YXJ044CC5Lmf5bqU5bC96YeP6YG/5YWN5Ye6546w5q2k5oOF5Ya1XG5cdFx0XHRDTG9nKFwic3RhcnTooqvkuK3mlq1cIiwzKTtcblx0XHRcdHJldHVybjtcblx0XHR9O1xuXHRcdFRoaXMuX1NPPTA7XG5cdFx0XG5cdFx0dmFyIGVuZD1mdW5jdGlvbigpe1xuXHRcdFx0VGhpcy5zdGF0ZT0xO1xuXHRcdFx0VGhpcy5yZXN1bWUoKTtcblx0XHR9O1xuXHRcdGlmKGN0eC5zdGF0ZT09XCJzdXNwZW5kZWRcIil7XG5cdFx0XHRjdHgucmVzdW1lKCkudGhlbihmdW5jdGlvbigpe1xuXHRcdFx0XHRDTG9nKFwiY3R4IHJlc3VtZVwiKTtcblx0XHRcdFx0ZW5kKCk7XG5cdFx0XHR9KTtcblx0XHR9ZWxzZXtcblx0XHRcdGVuZCgpO1xuXHRcdH07XG5cdH1cblx0LyrmmoLlgZzlvZXpn7MqL1xuXHQscGF1c2U6ZnVuY3Rpb24oKXtcblx0XHR2YXIgVGhpcz10aGlzO1xuXHRcdGlmKFRoaXMuc3RhdGUpe1xuXHRcdFx0VGhpcy5zdGF0ZT0yO1xuXHRcdFx0Q0xvZyhcInBhdXNlXCIpO1xuXHRcdFx0ZGVsZXRlIFJlY29yZGVyLlN0cmVhbS5fY2FsbFtUaGlzLmlkXTtcblx0XHR9O1xuXHR9XG5cdC8q5oGi5aSN5b2V6Z+zKi9cblx0LHJlc3VtZTpmdW5jdGlvbigpe1xuXHRcdHZhciBUaGlzPXRoaXM7XG5cdFx0aWYoVGhpcy5zdGF0ZSl7XG5cdFx0XHRUaGlzLnN0YXRlPTE7XG5cdFx0XHRDTG9nKFwicmVzdW1lXCIpO1xuXHRcdFx0VGhpcy5lbnZSZXN1bWUoKTtcblx0XHRcdFxuXHRcdFx0UmVjb3JkZXIuU3RyZWFtLl9jYWxsW1RoaXMuaWRdPWZ1bmN0aW9uKHBjbSxzdW0pe1xuXHRcdFx0XHRpZihUaGlzLnN0YXRlPT0xKXtcblx0XHRcdFx0XHRUaGlzLmVudkluKHBjbSxzdW0pO1xuXHRcdFx0XHR9O1xuXHRcdFx0fTtcblx0XHR9O1xuXHR9XG5cdFxuXHRcblx0XG5cdFxuXHQsX3N0b3A6ZnVuY3Rpb24oa2VlcEVuZ2luZSl7XG5cdFx0dmFyIFRoaXM9dGhpcyxzZXQ9VGhpcy5zZXQ7XG5cdFx0aWYoIVRoaXMuaXNNb2NrKXtcblx0XHRcdFRoaXMuX1MrKztcblx0XHR9O1xuXHRcdGlmKFRoaXMuc3RhdGUpe1xuXHRcdFx0VGhpcy5wYXVzZSgpO1xuXHRcdFx0VGhpcy5zdGF0ZT0wO1xuXHRcdH07XG5cdFx0aWYoIWtlZXBFbmdpbmUgJiYgVGhpc1tzZXQudHlwZStcIl9zdG9wXCJdKXtcblx0XHRcdFRoaXNbc2V0LnR5cGUrXCJfc3RvcFwiXShUaGlzLmVuZ2luZUN0eCk7XG5cdFx0XHRUaGlzLmVuZ2luZUN0eD0wO1xuXHRcdH07XG5cdH1cblx0Lypcblx057uT5p2f5b2V6Z+z5bm26L+U5Zue5b2V6Z+z5pWw5o2uYmxvYuWvueixoVxuXHRcdFRydWUoYmxvYixkdXJhdGlvbikgYmxvYu+8muW9lemfs+aVsOaNrmF1ZGlvL21wM3x3YXbmoLzlvI9cblx0XHRcdFx0XHRcdFx0ZHVyYXRpb27vvJrlvZXpn7Pml7bplb/vvIzljZXkvY3mr6vnp5Jcblx0XHRGYWxzZShtc2cpXG5cdFx0YXV0b0Nsb3NlOmZhbHNlIOWPr+mAie+8jOaYr+WQpuiHquWKqOiwg+eUqGNsb3Nl77yM6buY6K6k5Li6ZmFsc2Vcblx0Ki9cblx0LHN0b3A6ZnVuY3Rpb24oVHJ1ZSxGYWxzZSxhdXRvQ2xvc2Upe1xuXHRcdHZhciBUaGlzPXRoaXMsc2V0PVRoaXMuc2V0LHQxO1xuXHRcdENMb2coXCJTdG9wIFwiKyhUaGlzLmVudkluTGFzdD9UaGlzLmVudkluTGFzdC1UaGlzLmVudkluRmlyc3QrXCJtcyDooaVcIitUaGlzLmVudkluRml4K1wibXNcIjpcIi1cIikpO1xuXHRcdFxuXHRcdHZhciBlbmQ9ZnVuY3Rpb24oKXtcblx0XHRcdFRoaXMuX3N0b3AoKTsvL+W9u+W6leWFs+aOiWVuZ2luZUN0eFxuXHRcdFx0aWYoYXV0b0Nsb3NlKXtcblx0XHRcdFx0VGhpcy5jbG9zZSgpO1xuXHRcdFx0fTtcblx0XHR9O1xuXHRcdHZhciBlcnI9ZnVuY3Rpb24obXNnKXtcblx0XHRcdENMb2coXCLnu5PmnZ/lvZXpn7PlpLHotKXvvJpcIittc2csMSk7XG5cdFx0XHRGYWxzZSYmRmFsc2UobXNnKTtcblx0XHRcdGVuZCgpO1xuXHRcdH07XG5cdFx0dmFyIG9rPWZ1bmN0aW9uKGJsb2IsZHVyYXRpb24pe1xuXHRcdFx0Q0xvZyhcIue7k+adn+W9lemfsyDnvJbnoIFcIisoRGF0ZS5ub3coKS10MSkrXCJtcyDpn7PpopFcIitkdXJhdGlvbitcIm1zL1wiK2Jsb2Iuc2l6ZStcImJcIik7XG5cdFx0XHRpZihzZXQudGFrZW9mZkVuY29kZUNodW5rKXsvL+aOpeeuoeS6hui+k+WHuu+8jOatpOaXtmJsb2Lplb/luqbkuLowXG5cdFx0XHRcdENMb2coXCLlkK/nlKh0YWtlb2ZmRW5jb2RlQ2h1bmvlkI5zdG9w6L+U5Zue55qEYmxvYumVv+W6puS4ujDkuI3mj5Dkvpvpn7PpopHmlbDmja5cIiwzKTtcblx0XHRcdH1lbHNlIGlmKGJsb2Iuc2l6ZTxNYXRoLm1heCgxMDAsZHVyYXRpb24vMikpey8vMeenkuWwj+S6jjAuNWvvvJ9cblx0XHRcdFx0ZXJyKFwi55Sf5oiQ55qEXCIrc2V0LnR5cGUrXCLml6DmlYhcIik7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH07XG5cdFx0XHRUcnVlJiZUcnVlKGJsb2IsZHVyYXRpb24pO1xuXHRcdFx0ZW5kKCk7XG5cdFx0fTtcblx0XHRpZighVGhpcy5pc01vY2spe1xuXHRcdFx0aWYoIVRoaXMuc3RhdGUpe1xuXHRcdFx0XHRlcnIoXCLmnKrlvIDlp4vlvZXpn7NcIik7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH07XG5cdFx0XHRUaGlzLl9zdG9wKHRydWUpO1xuXHRcdH07XG5cdFx0dmFyIHNpemU9VGhpcy5yZWNTaXplO1xuXHRcdGlmKCFzaXplKXtcblx0XHRcdGVycihcIuacqumHh+mbhuWIsOW9lemfs1wiKTtcblx0XHRcdHJldHVybjtcblx0XHR9O1xuXHRcdGlmKCFUaGlzLmJ1ZmZlcnNbMF0pe1xuXHRcdFx0ZXJyKFwi6Z+z6aKR6KKr6YeK5pS+XCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH07XG5cdFx0aWYoIVRoaXNbc2V0LnR5cGVdKXtcblx0XHRcdGVycihcIuacquWKoOi9vVwiK3NldC50eXBlK1wi57yW56CB5ZmoXCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH07XG5cdFx0XG5cdFx0Ly/njq/looPphY3nva7mo4Dmn6XvvIzmraTlpITku4Xpkojlr7ltb2Nr6LCD55So77yM5Zug5Li6b3BlbuW3sue7j+ajgOafpei/h+S6hlxuXHRcdGlmKFRoaXMuaXNNb2NrKXtcblx0XHRcdHZhciBjaGVja01zZz1UaGlzLmVudkNoZWNrKFRoaXMubW9ja0VudkluZm98fHtlbnZOYW1lOlwibW9ja1wiLGNhblByb2Nlc3M6ZmFsc2V9KTsvL+ayoeacieaPkOS+m+eOr+Wig+S/oeaBr+eahG1vY2vml7bmsqHmnIlvblByb2Nlc3Plm57osINcblx0XHRcdGlmKGNoZWNrTXNnKXtcblx0XHRcdFx0ZXJyKFwi5b2V6Z+z6ZSZ6K+v77yaXCIrY2hlY2tNc2cpO1xuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9O1xuXHRcdH07XG5cdFx0XG5cdFx0Ly/mraTnsbvlnovmnInovrnlvZXovrnovaznoIEoV29ya2VyKeaUr+aMgVxuXHRcdHZhciBlbmdpbmVDdHg9VGhpcy5lbmdpbmVDdHg7XG5cdFx0aWYoVGhpc1tzZXQudHlwZStcIl9jb21wbGV0ZVwiXSYmZW5naW5lQ3R4KXtcblx0XHRcdHZhciBkdXJhdGlvbj1NYXRoLnJvdW5kKGVuZ2luZUN0eC5wY21TaXplL3NldC5zYW1wbGVSYXRlKjEwMDApOy8v6YeH55So5ZCO55qE5pWw5o2u6ZW/5bqm5ZKMYnVmZmVyc+eahOmVv+W6puWPr+iDveW+ruWwj+eahOS4jeS4gOiHtO+8jOaYr+mHh+agt+eOh+i/nue7rei9rOaNoueahOeyvuW6pumXrumimFxuXHRcdFx0XG5cdFx0XHR0MT1EYXRlLm5vdygpO1xuXHRcdFx0VGhpc1tzZXQudHlwZStcIl9jb21wbGV0ZVwiXShlbmdpbmVDdHgsZnVuY3Rpb24oYmxvYil7XG5cdFx0XHRcdG9rKGJsb2IsZHVyYXRpb24pO1xuXHRcdFx0fSxlcnIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH07XG5cdFx0XG5cdFx0Ly/moIflh4ZVSee6v+eoi+i9rOegge+8jOiwg+aVtOmHh+agt+eOh1xuXHRcdHQxPURhdGUubm93KCk7XG5cdFx0dmFyIGNodW5rPVJlY29yZGVyLlNhbXBsZURhdGEoVGhpcy5idWZmZXJzLFRoaXMuc3JjU2FtcGxlUmF0ZSxzZXQuc2FtcGxlUmF0ZSk7XG5cdFx0XG5cdFx0c2V0LnNhbXBsZVJhdGU9Y2h1bmsuc2FtcGxlUmF0ZTtcblx0XHR2YXIgcmVzPWNodW5rLmRhdGE7XG5cdFx0dmFyIGR1cmF0aW9uPU1hdGgucm91bmQocmVzLmxlbmd0aC9zZXQuc2FtcGxlUmF0ZSoxMDAwKTtcblx0XHRcblx0XHRDTG9nKFwi6YeH5qC3XCIrc2l6ZStcIi0+XCIrcmVzLmxlbmd0aCtcIiDoirE6XCIrKERhdGUubm93KCktdDEpK1wibXNcIik7XG5cdFx0XG5cdFx0c2V0VGltZW91dChmdW5jdGlvbigpe1xuXHRcdFx0dDE9RGF0ZS5ub3coKTtcblx0XHRcdFRoaXNbc2V0LnR5cGVdKHJlcyxmdW5jdGlvbihibG9iKXtcblx0XHRcdFx0b2soYmxvYixkdXJhdGlvbik7XG5cdFx0XHR9LGZ1bmN0aW9uKG1zZyl7XG5cdFx0XHRcdGVycihtc2cpO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdH1cblxufTtcblxuaWYod2luZG93LlJlY29yZGVyKXtcblx0d2luZG93LlJlY29yZGVyLkRlc3Ryb3koKTtcbn07XG53aW5kb3cuUmVjb3JkZXI9UmVjb3JkZXI7XG5cbi8vZW5kICoqKipjb3B55rqQ56CB57uT5p2fKioqKipcblJlY29yZGVyLkxNPUxNO1xuXG4vL+a1gemHj+e7n+iuoeeUqDHlg4/ntKDlm77niYflnLDlnYDvvIzorr7nva7kuLrnqbrlsIbkuI3lj4LkuI7nu5/orqFcblJlY29yZGVyLlRyYWZmaWNJbWdVcmw9XCIvL2lhLjUxLmxhL2dvMT9pZD0yMDQ2OTk3MyZwdkZsYWc9MVwiO1xuUmVjb3JkZXIuVHJhZmZpYz1mdW5jdGlvbigpe1xuXHR2YXIgaW1nVXJsPVJlY29yZGVyLlRyYWZmaWNJbWdVcmw7XG5cdGlmKGltZ1VybCl7XG5cdFx0dmFyIGRhdGE9UmVjb3JkZXIuVHJhZmZpYztcblx0XHR2YXIgaWRmPWxvY2F0aW9uLmhyZWYucmVwbGFjZSgvIy4qLyxcIlwiKTtcblx0XHRcblx0XHRpZihpbWdVcmwuaW5kZXhPZihcIi8vXCIpPT0wKXtcblx0XHRcdC8v57uZdXJs5Yqg5LiKaHR0cOWJjee8gO+8jOWmguaenOaYr2ZpbGXljY/orq7kuIvvvIzkuI3liqDliY3nvIDmsqHms5XnlKhcblx0XHRcdGlmKC9eaHR0cHM6L2kudGVzdChpZGYpKXtcblx0XHRcdFx0aW1nVXJsPVwiaHR0cHM6XCIraW1nVXJsO1xuXHRcdFx0fWVsc2V7XG5cdFx0XHRcdGltZ1VybD1cImh0dHA6XCIraW1nVXJsO1xuXHRcdFx0fTtcblx0XHR9O1xuXHRcdFxuXHRcdGlmKCFkYXRhW2lkZl0pe1xuXHRcdFx0ZGF0YVtpZGZdPTE7XG5cdFx0XHRcblx0XHRcdHZhciBpbWc9bmV3IEltYWdlKCk7XG5cdFx0XHRpbWcuc3JjPWltZ1VybDtcblx0XHRcdENMb2coXCJUcmFmZmljIEFuYWx5c2lzIEltYWdlOiBSZWNvcmRlci5UcmFmZmljSW1nVXJsPVwiK1JlY29yZGVyLlRyYWZmaWNJbWdVcmwpO1xuXHRcdH07XG5cdH07XG59O1xuXG59KSk7IiwiZXhwb3J0IGNsYXNzIEJ5dGVBcnJheSB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5saXN0PVtdO1xyXG4gICAgICAgIHRoaXMuYnl0ZU9mZnNldD0wO1xyXG4gICAgICAgIHRoaXMubGVuZ3RoPTA7XHJcbiAgICB9XHJcblxyXG4gICAgcHVzaCh1bml0OEFycikge1xyXG4gICAgICAgIHRoaXMubGlzdC5wdXNoKHVuaXQ4QXJyKTtcclxuICAgICAgICB0aGlzLmxlbmd0aCs9dW5pdDhBcnIubGVuZ3RoO1xyXG4gICAgfVxyXG5cclxuICAgIHJlYWRCeXRlcyhsZW4pIHtcclxuICAgICAgICBpZihsZW4+MCl7XHJcbiAgICAgICAgICAgIGxldCByYnVmPW5ldyBVaW50OEFycmF5KGxlbik7XHJcbiAgICAgICAgICAgIGxldCByYnVmX2luZD0wO1xyXG4gICAgICAgICAgICB3aGlsZShyYnVmX2luZDxsZW4pe1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5saXN0Lmxlbmd0aD4wKXtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdG1wYnVmPXRoaXMubGlzdC5zaGlmdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCB0bXBsZW49dG1wYnVmLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgbGFzdF9sZW49bGVuLXJidWZfaW5kO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHRtcGxlbj49bGFzdF9sZW4pe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL+i2s+WkoOS6hlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgdG1wYnVmMiA9IHRtcGJ1Zi5zdWJhcnJheSgwLCBsYXN0X2xlbik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJidWYuc2V0KHRtcGJ1ZjIscmJ1Zl9pbmQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByYnVmX2luZCs9dG1wYnVmMi5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGxhc3RfbGVuPHRtcGxlbil7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgbmV3VWludDhBcnJheSA9IHRtcGJ1Zi5zdWJhcnJheShsYXN0X2xlbiwgdG1wbGVuKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubGlzdC51bnNoaWZ0KG5ld1VpbnQ4QXJyYXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByYnVmLnNldCh0bXBidWYscmJ1Zl9pbmQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByYnVmX2luZCs9dG1wbGVuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgICAgIHJidWY9cmJ1Zi5zdWJhcnJheSgwLCByYnVmX2luZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5sZW5ndGgtPXJidWYubGVuZ3RoO1xyXG4gICAgICAgICAgICByZXR1cm4gcmJ1ZjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG59IiwiXHJcbmV4cG9ydCBjbGFzcyBVdGlsIHtcclxuICAgIHN0YXRpYyBpc0VtcHR5U3RyaW5nKHN0cikge1xyXG4gICAgICAgIGlmIChzdHIgPT0gdW5kZWZpbmVkIHx8IHN0ciA9PSBudWxsIHx8IHN0ciA9PSBcIlwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsImltcG9ydCB7R1BsYXllckV2ZW50LCBHRXJyb3JUeXBlLCBHUGxheWJhY2tDb250cm9sU3RhdHVzfSBmcm9tICcuL3BsYXllci9ncGxheWVyLWV2ZW50cyc7XHJcbmltcG9ydCB7R1RhbGtlckV2ZW50LCBHVGFsa2VyQ29ubmVjdFN0YXR1cywgR1RhbGtlckNvbm5lY3RFcnJvclR5cGV9IGZyb20gJy4vdGFsa2VyL2d0YWxrZXItZXZlbnRzJztcclxuaW1wb3J0IHtHUGxheWVyfSBmcm9tICcuL3BsYXllci9ncGxheWVyLmpzJztcclxuaW1wb3J0IHsgSHR0cEZsdlBsYXllciB9IGZyb20gJy4vcGxheWVyL2h0dHBmbHYtcGxheWVyLmpzJztcclxuaW1wb3J0IHsgSHR0cEZsdlRhbGtlciB9IGZyb20gJy4vdGFsa2VyL2h0dHBmbHYtdGFsa2VyLmpzJztcclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZVBsYXllcih1cmwsIGNvbmZpZyA9IG51bGwpIHtcclxuICBsZXQgcGxheWVyID0gbmV3IEh0dHBGbHZQbGF5ZXIoKTtcclxuICBwbGF5ZXIuaW5pdCh1cmwsIGNvbmZpZyk7XHJcbiAgcmV0dXJuIHBsYXllcjtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlVGFsa2VyKGRvd25VcmwsIHVwVXJsLCBpbWVpLCBjaGFubmVsLCBjb25maWcgPSBudWxsKSB7XHJcbiAgbGV0IHRhbGtlciA9IG5ldyBIdHRwRmx2VGFsa2VyKCk7XHJcbiAgaWYgKCF0YWxrZXIuaW5pdChkb3duVXJsLCB1cFVybCwgaW1laSwgY2hhbm5lbCwgY29uZmlnKSkge1xyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG4gIHJldHVybiB0YWxrZXI7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGlzSHR0cEZsdlN1cHBvcnRlZCgpIHtcclxuICByZXR1cm4gSHR0cEZsdlBsYXllci5pc1N1cHBvcnRlZCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBpc1RhbGtTdXBwb3J0ZWQoKSB7XHJcbiAgcmV0dXJuIEh0dHBGbHZUYWxrZXIuaXNTdXBwb3J0ZWQoKTtcclxufVxyXG5cclxubGV0IGdtZWRpYWpzID0ge307XHJcblxyXG5nbWVkaWFqcy5jcmVhdGVQbGF5ZXIgPSBjcmVhdGVQbGF5ZXI7XHJcbmdtZWRpYWpzLmlzSHR0cEZsdlN1cHBvcnRlZCA9IGlzSHR0cEZsdlN1cHBvcnRlZDtcclxuZ21lZGlhanMuSHR0cEZsdlBsYXllciA9IEh0dHBGbHZQbGF5ZXI7XHJcbmdtZWRpYWpzLkdQbGF5ZXJFdmVudCA9IEdQbGF5ZXJFdmVudDtcclxuZ21lZGlhanMuR0Vycm9yVHlwZSA9IEdFcnJvclR5cGU7XHJcbmdtZWRpYWpzLkdQbGF5YmFja0NvbnRyb2xTdGF0dXMgPSBHUGxheWJhY2tDb250cm9sU3RhdHVzO1xyXG5cclxuZ21lZGlhanMuY3JlYXRlVGFsa2VyID0gY3JlYXRlVGFsa2VyO1xyXG5nbWVkaWFqcy5pc1RhbGtTdXBwb3J0ZWQgPSBpc1RhbGtTdXBwb3J0ZWQ7XHJcbmdtZWRpYWpzLkh0dHBGbHZUYWxrZXIgPSBIdHRwRmx2VGFsa2VyO1xyXG5nbWVkaWFqcy5HVGFsa2VyRXZlbnQgPSBHVGFsa2VyRXZlbnQ7XHJcbmdtZWRpYWpzLkdUYWxrZXJDb25uZWN0U3RhdHVzID0gR1RhbGtlckNvbm5lY3RTdGF0dXM7XHJcbmdtZWRpYWpzLkdUYWxrZXJDb25uZWN0RXJyb3JUeXBlID0gR1RhbGtlckNvbm5lY3RFcnJvclR5cGU7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBnbWVkaWFqczsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vZ21lZGlhLmpzJykuZGVmYXVsdDsiLCJleHBvcnQgY29uc3QgR1BsYXllckV2ZW50ID0ge1xyXG4gICAgRVJST1I6ICdlcnJvcicsXHJcbiAgICBNRURJQV9TT1VSQ0VfRU5EOiAnbWVkaWFfc291cmNlX2VuZCcsXHJcbiAgICBUSU1FVVBEQVRFOiAndGltZXVwZGF0ZScsXHJcbiAgICBTVEFUSVNUSUNTX0lORk86ICdzdGF0aXN0aWNzX2luZm8nLFxyXG4gICAgUExBWUJBQ0tfQ09OVFJPTF9FVkVOVDogJ3BsYXliYWNrX2NvbnRyb2xfZXZlbnQnXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgR0Vycm9yVHlwZSA9IHtcclxuICAgIE5FVFdPUktfRVJST1I6ICdOZXR3b3JrRXJyb3InLFxyXG4gICAgTUVESUFfRVJST1I6ICdNZWRpYUVycm9yJyxcclxuICAgIE9USEVSX0VSUk9SOiAnT3RoZXJFcnJvcidcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBHUGxheWJhY2tDb250cm9sU3RhdHVzID0ge1xyXG4gICAgU2Vla1N0YXJ0OiAwLFxyXG4gICAgU2Vla0ZhaWw6IDEsXHJcbiAgICBTZWVrU3VjY2VzczogMlxyXG59O1xyXG4iLCJleHBvcnQgY2xhc3MgR1BsYXllciB7XHJcblxyXG4gICAgY29uc3RydWN0b3IodHlwZU5hbWUpIHtcclxuICAgICAgICB0aGlzLl90eXBlID0gdHlwZU5hbWUgfHwgJ3VuZGVmaW5lZCc7XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdCh1cmwsIGNvbmZpZykge1xyXG4gICAgfVxyXG5cclxuICAgIG9uKGV2ZW50LCBjYWxsKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG9mZihldmVudCkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBhdHRhY2hNZWRpYUVsZW1lbnQobWVkaWFFbGVtZW50KSB7ICBcclxuICAgIH1cclxuXHJcbiAgICBsb2FkKCkge1xyXG4gICAgfVxyXG5cclxuICAgIHBsYXkoKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNhcHR1cmUoKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHBhdXNlKCkge1xyXG4gICAgICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHJlc3VtZSgpIHtcclxuICAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBzZWVrVG9OZXdlc3RUaW1lICgpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgc2Vlayh0aW1lKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGRlc3Ryb3koKSB7XHJcblxyXG4gICAgfVxyXG5cclxufSIsImltcG9ydCB7R1BsYXllckV2ZW50LCBHRXJyb3JUeXBlLCBHUGxheWJhY2tDb250cm9sU3RhdHVzfSBmcm9tIFwiLi9ncGxheWVyLWV2ZW50cy5qc1wiXHJcbmltcG9ydCB7R1BsYXllcn0gZnJvbSBcIi4vZ3BsYXllci5qc1wiXHJcbmltcG9ydCBmbHZqcyBmcm9tIFwiZmx2LWc3LmpzXCI7XHJcblxyXG5jb25zdCBQbGF5YmFja0tleSA9IFwiZzctZmx2LXZpZGVvLXBsYXliYWNrXCI7XHJcblxyXG5jb25zdCBQbGF5YmFja0NvbnRyb2wgPSB7XHJcbiAgICBOb25lOjAsXHJcbiAgICBBY3RpdmU6MSxcclxuICAgIFBhc3NpdmU6MlxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgSHR0cEZsdlBsYXllciBleHRlbmRzIEdQbGF5ZXIge1xyXG5cclxuICAgIGNvbnN0cnVjdG9yICgpIHtcclxuICAgICAgICBzdXBlcignaHR0cGZsdi1wbGF5ZXInKTtcclxuICAgICAgICB0aGlzLlRBRyA9ICdIdHRwRmx2UGxheWVyJztcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnBsYXllciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gbnVsbDtcclxuICAgICAgICB0aGlzLmlzTGl2ZSA9IHRydWU7XHJcblxyXG4gICAgICAgIHRoaXMucGxheWJhY2tQbGFuID0gMTtcclxuICAgICAgICB0aGlzLnBsYXliYWNrQ29udHJvbCA9IFBsYXliYWNrQ29udHJvbC5Ob25lO1xyXG5cclxuICAgICAgICB0aGlzLnN0cmVhbUVuZCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMubmVlZFNlZWsgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnNlZWtpbmcgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLnNlZWtUaW1lID0gMDtcclxuICAgICAgICB0aGlzLm5ld1BsYXlTdGFydFRpbWUgPSAwO1xyXG4gICAgICAgIHRoaXMubGFzdFNlbmRTZWVrVHMgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLmNhbGxiYWNrVGltZVVwZGF0ZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jYWxsYmFja1N0YXRpc3RpY3MgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tFcnJvciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jYWxsYmFja01lZGlhU291cmNlRW5kID0gbnVsbDtcclxuICAgICAgICB0aGlzLmNhbGxiYWNrUGxheWJhY2tDb250cm9sRXZlbnQgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLmNoZWNrZXJTZWVrID0gbnVsbDtcclxuXHJcbiAgICAgICAgdGhpcy5lID0ge1xyXG4gICAgICAgICAgICBvblRpbWVVcGRhdGUgOiB0aGlzLl9vbkVsZW1lbnRUaW1lLmJpbmQodGhpcylcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBpc1N1cHBvcnRlZCgpIHtcclxuICAgICAgICByZXR1cm4gd2luZG93Lk1lZGlhU291cmNlICYmXHJcbiAgICAgICAgICAgIHdpbmRvdy5NZWRpYVNvdXJjZS5pc1R5cGVTdXBwb3J0ZWQoJ3ZpZGVvL21wNDsgY29kZWNzPVwiYXZjMS40MkUwMUUsbXA0YS40MC4yXCInKTtcclxuICAgIH1cclxuXHJcbiAgICBpbml0ICh1cmwsIGNvbmZpZykge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrQ29uZmlnKGNvbmZpZyk7XHJcbiAgICAgICAgdGhpcy5pc0xpdmUgPSB0aGlzLl9jaGVja0lmTGl2ZSh1cmwpOyAgXHJcbiAgICAgICAgdGhpcy5wbGF5YmFja0NvbnRyb2wgPSB0aGlzLl9jaGVja1BsYXliYWNrQ29udHJvbCh1cmwpOyAgXHJcblxyXG4gICAgICAgIHRoaXMucGxheWVyID0gZmx2anMuY3JlYXRlUGxheWVyKHtpc0xpdmU6dGhpcy5pc0xpdmUsIHR5cGU6J2ZsdicsdXJsOnVybH0sIHtcclxuICAgICAgICAgICAgbGF6eUxvYWQ6IGZhbHNlLFxyXG4gICAgICAgICAgICBlbmFibGVTdGFzaEJ1ZmZlcjogZmFsc2UsXHJcbiAgICAgICAgICAgIGRlZmVyTG9hZEFmdGVyU291cmNlT3Blbjp0cnVlXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMucGxheWVyLm9uKGZsdmpzLkV2ZW50cy5TVEFUSVNUSUNTX0lORk8sIHRoaXMuX29uU3RhdGlzdGljc0luZm8uYmluZCh0aGlzKSk7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXIub24oZmx2anMuRXZlbnRzLkVSUk9SLCB0aGlzLl9vbkVycm9yLmJpbmQodGhpcykpO1xyXG4gICAgICAgIHRoaXMucGxheWVyLnNldE1lZGlhU291cmNlRW5kQ2FsbGJhY2sodGhpcy5fb25NZWRpYVNvdXJjZUVuZC5iaW5kKHRoaXMpKTtcclxuICAgICAgICB0aGlzLnBsYXllci5zZXRTdHJlYW1UaW1lQ2FsbGJhY2sodGhpcy5fb25TdHJlYW1UaW1lLmJpbmQodGhpcykpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uKGV2ZW50LCBjYWxsKSB7XHJcbiAgICAgICAgaWYgKGV2ZW50ID09PSBHUGxheWVyRXZlbnQuVElNRVVQREFURSkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrVGltZVVwZGF0ZSA9IGNhbGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50ID09PSBHUGxheWVyRXZlbnQuU1RBVElTVElDU19JTkZPKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tTdGF0aXN0aWNzID0gY2FsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZXZlbnQgPT09IEdQbGF5ZXJFdmVudC5FUlJPUikge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrRXJyb3IgPSBjYWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChldmVudCA9PT0gR1BsYXllckV2ZW50Lk1FRElBX1NPVVJDRV9FTkQpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja01lZGlhU291cmNlRW5kID0gY2FsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZXZlbnQgPT09IEdQbGF5ZXJFdmVudC5QTEFZQkFDS19DT05UUk9MX0VWRU5UKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tQbGF5YmFja0NvbnRyb2xFdmVudCA9IGNhbGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9mZihldmVudCkge1xyXG4gICAgICAgIGlmIChldmVudCA9PT0gR1BsYXllckV2ZW50LlRJTUVVUERBVEUpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja1RpbWVVcGRhdGUgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChldmVudCA9PT0gR1BsYXllckV2ZW50LlNUQVRJU1RJQ1NfSU5GTykge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrU3RhdGlzdGljcyA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50ID09PSBHUGxheWVyRXZlbnQuRVJST1IpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Vycm9yID0gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoZXZlbnQgPT09IEdQbGF5ZXJFdmVudC5NRURJQV9TT1VSQ0VfRU5EKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tNZWRpYVNvdXJjZUVuZCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGV2ZW50ID09PSBHUGxheWVyRXZlbnQuUExBWUJBQ0tfQ09OVFJPTF9FVkVOVCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrUGxheWJhY2tDb250cm9sRXZlbnQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhdHRhY2hNZWRpYUVsZW1lbnQoZWwpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBlbDtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRpbWV1cGRhdGVcIiwgdGhpcy5lLm9uVGltZVVwZGF0ZSk7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXIuYXR0YWNoTWVkaWFFbGVtZW50KGVsKTtcclxuICAgIH1cclxuXHJcbiAgICBsb2FkKCkge1xyXG4gICAgICAgIHRoaXMucGxheWVyLmxvYWQoKTtcclxuICAgIH1cclxuXHJcbiAgICBwbGF5KCkge1xyXG4gICAgICAgIHRoaXMucGxheWVyLnBsYXkoKTtcclxuICAgIH1cclxuXHJcbiAgICBjYXB0dXJlKCkge1xyXG4gICAgICAgIGxldCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gICAgICAgIGNhbnZhcy53aWR0aCA9IHRoaXMuZWxlbWVudC52aWRlb1dpZHRoO1xyXG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSB0aGlzLmVsZW1lbnQudmlkZW9IZWlnaHQ7XHJcbiAgICAgICAgY2FudmFzLmdldENvbnRleHQoJzJkJykuZHJhd0ltYWdlKHRoaXMuZWxlbWVudCwgMCwgMCwgY2FudmFzLndpZHRoLCBjYW52YXMuaGVpZ2h0KTtcclxuICAgICAgICBsZXQgZGF0YXVybCA9IGNhbnZhcy50b0RhdGFVUkwoKTtcclxuICAgICAgICByZXR1cm4gZGF0YXVybDtcclxuICAgIH1cclxuXHJcbiAgICBwYXVzZSgpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucGF1c2UoKTtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgcmVzdW1lKCkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5wbGF5KCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHNlZWtUb05ld2VzdFRpbWUgKCkge1xyXG4gICAgICAgIGxldCBidWZmZXJlZCA9IHRoaXMuZWxlbWVudC5idWZmZXJlZDtcclxuICAgICAgICBpZiAoYnVmZmVyZWQubGVuZ3RoID4gMCkgeyBcclxuICAgICAgICAgICAgbGV0IGZyb20gPSBidWZmZXJlZC5zdGFydChidWZmZXJlZC5sZW5ndGggLTEpO1xyXG4gICAgICAgICAgICBsZXQgdG8gPSBidWZmZXJlZC5lbmQoYnVmZmVyZWQubGVuZ3RoIC0xKTtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmN1cnJlbnRUaW1lID0gdG87XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNlZWsodGltZSkge1xyXG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnNlZWtpbmcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBpZiAodGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50KEdQbGF5YmFja0NvbnRyb2xTdGF0dXMuU2Vla1N0YXJ0LCBcclxuICAgICAgICAgICAgICAgIFwi5byA5aeL5YiH5o2i5pKt5pS+5pe26Ze0XCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLl9zZWVrQnlDYWNoZWQodGltZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5wbGF5YmFja0NvbnRyb2wgPT0gUGxheWJhY2tDb250cm9sLkFjdGl2ZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9zZWVrQnlBY3RpdmUodGltZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9zZWVrQnlQYXNzaXZlKHRpbWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBkZXN0cm95KCkge1xyXG4gICAgICAgIGlmICh0aGlzLnBsYXllciAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWVyLnBhdXNlKCk7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWVyLnVubG9hZCgpO1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllci5kZXRhY2hNZWRpYUVsZW1lbnQoKTtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXIuZGVzdHJveSgpO1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllciA9IG51bGw7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5lbGVtZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJ0aW1ldXBkYXRlXCIsIHRoaXMuZS5vblRpbWVVcGRhdGUpO1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfY2hlY2tDb25maWcoY29uZmlnKSB7XHJcbiAgICAgICAgaWYgKGNvbmZpZyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChjb25maWcucGxheWJhY2tQbGFuICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5wbGF5YmFja1BsYW4gPSBjb25maWcucGxheWJhY2tQbGFuO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfY2hlY2tJZkxpdmUodXJsKSB7XHJcbiAgICAgICAgaWYgKHVybC5pbmRleE9mKFBsYXliYWNrS2V5KSAhPSAtMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja1BsYXliYWNrQ29udHJvbCh1cmwpIHtcclxuICAgICAgICBsZXQgYXJyID0gdXJsLnNwbGl0KCcmc3RyZWFtPScpO1xyXG4gICAgICAgIGlmIChhcnIubGVuZ3RoIDwgMiB8fCBhcnJbMV0ubGVuZ3RoIDwgMykge1xyXG4gICAgICAgICAgICByZXR1cm4gUGxheWJhY2tDb250cm9sLk5vbmU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBzdHJlYW1OYW1lID0gYXJyWzFdO1xyXG4gICAgICAgIGxldCBkZXZpY2VUeXBlID0gc3RyZWFtTmFtZS5zdWJzdHJpbmcoMCwzKTtcclxuICAgICAgICBpZiAoZGV2aWNlVHlwZSA9PSAnMTMxJykge1xyXG4gICAgICAgICAgICByZXR1cm4gUGxheWJhY2tDb250cm9sLlBhc3NpdmU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQbGF5YmFja0NvbnRyb2wuQWN0aXZlO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZWVrQnlDYWNoZWQodGltZSkge1xyXG4gICAgICAgIGlmICghdGhpcy5zdHJlYW1FbmQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnNlZWtpbmcgPSB0cnVlO1xyXG5cclxuICAgICAgICBsZXQgYkNhY2hlZCA9IGZhbHNlO1xyXG4gICAgICAgIGxldCBidWZmZXJlZCA9IHRoaXMuZWxlbWVudC5idWZmZXJlZDtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1ZmZlcmVkLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBmcm9tID0gYnVmZmVyZWQuc3RhcnQoaSk7XHJcbiAgICAgICAgICAgIGxldCB0byA9IGJ1ZmZlcmVkLmVuZChpKTtcclxuICAgICAgICAgICAgaWYgKHRpbWUgPiBmcm9tICYmIHRpbWUgPCB0bykge1xyXG4gICAgICAgICAgICAgICAgYkNhY2hlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChiQ2FjaGVkICYmIHRpbWUgPiB0aGlzLmVsZW1lbnQuY3VycmVudFRpbWUpIHtcclxuICAgICAgICAgICAgdGhpcy5lbGVtZW50LmN1cnJlbnRUaW1lID0gdGltZTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tQbGF5YmFja0NvbnRyb2xFdmVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbGxiYWNrUGxheWJhY2tDb250cm9sRXZlbnQoR1BsYXliYWNrQ29udHJvbFN0YXR1cy5TZWVrU3VjY2VzcyxcclxuICAgICAgICAgICAgICAgICAgICBcIuWIh+aNouaSreaUvuaXtumXtOaIkOWKn1wiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tQbGF5YmFja0NvbnRyb2xFdmVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbGxiYWNrUGxheWJhY2tDb250cm9sRXZlbnQoR1BsYXliYWNrQ29udHJvbFN0YXR1cy5TZWVrRmFpbCxcclxuICAgICAgICAgICAgICAgICAgICBcIue8k+WGsua1geW3sue7k+adn++8jOaXoOazleWIh+aNouWIsOacque8k+WGsuWMuuWfn1wiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5zZWVraW5nID0gZmFsc2U7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZWVrQnlBY3RpdmUodGltZSkge1xyXG4gICAgICAgIHRoaXMuc2Vla2luZyA9IHRydWU7XHJcblxyXG4gICAgICAgIHRoaXMubGFzdFNlbmRTZWVrVHMgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuXHJcbiAgICAgICAgdGhpcy5jaGVja2VyU2VlayA9IHNldFRpbWVvdXQoKCk9PntcclxuICAgICAgICAgICAgdGhpcy5uZWVkU2VlayA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLnNlZWtpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tQbGF5YmFja0NvbnRyb2xFdmVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNhbGxiYWNrUGxheWJhY2tDb250cm9sRXZlbnQoR1BsYXliYWNrQ29udHJvbFN0YXR1cy5TZWVrRmFpbCxcclxuICAgICAgICAgICAgICAgICAgICBcIuWIh+aNouaSreaUvuaXtumXtOWksei0pe+8jOivt+mHjeaWsOWwneivlVwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sMTUqMTAwMCk7XHJcblxyXG4gICAgICAgIHRoaXMuc2Vla1RpbWUgPSB0aW1lO1xyXG4gICAgICAgIHRoaXMubmVlZFNlZWsgPSB0cnVlO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZWVrQnlQYXNzaXZlKHRpbWUpIHtcclxuICAgICAgICB0aGlzLnNlZWtpbmcgPSB0cnVlO1xyXG5cclxuICAgICAgICB0aGlzLnNlZWtUaW1lID0gdGltZTtcclxuICAgICAgICAvL+iOt+WPluW9k+WJjXZpZGVv5qCH562+6Kej56CB57yT5a2YXHJcbiAgICAgICAgbGV0IGJ1ZmZlcmVkID0gdGhpcy5lbGVtZW50LmJ1ZmZlcmVkO1xyXG4gICAgICAgIGlmIChidWZmZXJlZC5sZW5ndGggPiAwKSB7IFxyXG4gICAgICAgICAgICAvL+eUseiuvuWkh+err+aOp+WItuWbnuaUvueahGJ1ZmZlcmVk5Y+q5Lya5Lqn55Sf5LiA5q61XHJcbiAgICAgICAgICAgIGxldCBmcm9tID0gYnVmZmVyZWQuc3RhcnQoMCk7XHJcbiAgICAgICAgICAgIGxldCB0byA9IGJ1ZmZlcmVkLmVuZCgwKTtcclxuICAgICAgICAgICAgdGhpcy5uZXdQbGF5U3RhcnRUaW1lID0gdG87XHJcblxyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuY3VycmVudFRpbWUgPSB0aGlzLm5ld1BsYXlTdGFydFRpbWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzZXRUaW1lb3V0KCgpPT57XHJcbiAgICAgICAgICAgIHRoaXMuc2Vla2luZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tQbGF5YmFja0NvbnRyb2xFdmVudChHUGxheWJhY2tDb250cm9sU3RhdHVzLlNlZWtTdWNjZXNzLFxyXG4gICAgICAgICAgICAgICAgICAgIFwi5YiH5o2i5pKt5pS+5pe26Ze05oiQ5YqfXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwxMDAwKTtcclxuICAgIH1cclxuXHJcbiAgICBfb25TdGF0aXN0aWNzSW5mbyhkYXRhKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tTdGF0aXN0aWNzICE9IG51bGwpIHtcclxuICAgICAgICAgICAgbGV0IGluZm8gPSB7fTtcclxuICAgICAgICAgICAgaW5mby5zcGVlZCA9IGRhdGEuc3BlZWQ7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tTdGF0aXN0aWNzKGluZm8pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfb25FcnJvcih0eXBlLCBkZXRhaWwsIGVyck9iaikge1xyXG4gICAgICAgIGlmICh0aGlzLmNhbGxiYWNrRXJyb3IgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICBsZXQgZ3R5cGUgPSB0eXBlO1xyXG4gICAgICAgICAgICBsZXQgZ3N1YnR5cGUgPSBkZXRhaWw7XHJcbiAgICAgICAgICAgIGxldCBpbmZvID0gdHlwZTtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Vycm9yKHR5cGUsIGdzdWJ0eXBlLCBpbmZvKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX29uTWVkaWFTb3VyY2VFbmQoaW5mbykge1xyXG4gICAgICAgIHRoaXMuc3RyZWFtRW5kID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy5jYWxsYmFja01lZGlhU291cmNlRW5kICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja01lZGlhU291cmNlRW5kKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9vbkVsZW1lbnRUaW1lKGV2ZW50KSB7XHJcbiAgICAgICAgLy/lm57mlL7mlrnmoYgxXHJcbiAgICAgICAgaWYgKHRoaXMucGxheWJhY2tQbGFuID09IDEpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tUaW1lVXBkYXRlICE9IG51bGwgJiYgdGhpcy5lbGVtZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tUaW1lVXBkYXRlKHRoaXMuZWxlbWVudC5jdXJyZW50VGltZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy/lm57mlL7mlrnmoYgyXHJcbiAgICAgICAgaWYgKHRoaXMucGxheWJhY2tDb250cm9sID09PSBQbGF5YmFja0NvbnRyb2wuQWN0aXZlKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5zZWVraW5nICYmIHRoaXMuY2FsbGJhY2tUaW1lVXBkYXRlICE9IG51bGwgJiYgdGhpcy5lbGVtZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tUaW1lVXBkYXRlKHRoaXMuZWxlbWVudC5jdXJyZW50VGltZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAodGhpcy5wbGF5YmFja0NvbnRyb2wgPT09IFBsYXliYWNrQ29udHJvbC5QYXNzaXZlKSB7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5zZWVraW5nICYmIHRoaXMuY2FsbGJhY2tUaW1lVXBkYXRlICE9IG51bGwgJiYgdGhpcy5lbGVtZW50ICE9IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGxldCBjdXJQbGF5VGltZSA9IHRoaXMuc2Vla1RpbWUgKyAodGhpcy5lbGVtZW50LmN1cnJlbnRUaW1lIC0gdGhpcy5uZXdQbGF5U3RhcnRUaW1lKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tUaW1lVXBkYXRlKGN1clBsYXlUaW1lKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfb25TdHJlYW1UaW1lKHRpbWUpIHtcclxuICAgICAgICBpZiAodGhpcy5uZWVkU2Vlaykge1xyXG4gICAgICAgICAgICBpZiAoTWF0aC5hYnModGhpcy5zZWVrVGltZSoxMDAwIC0gdGltZSkgPj0gMTAwMCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGhpcy5jaGVja2VyU2VlayAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGhpcy5jaGVja2VyU2Vlayk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrZXJTZWVrID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5uZWVkU2VlayA9IGZhbHNlO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpPT57XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlZWtpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZWxlbWVudC5jdXJyZW50VGltZSA9IHRpbWUvMTAwMDtcclxuICAgICAgICAgICAgICAgIGxldCBvZmYgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSAtIHRoaXMubGFzdFNlbmRTZWVrVHM7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIuWIh+aNouiAl+aXtjogXCIgKyBvZmYpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tQbGF5YmFja0NvbnRyb2xFdmVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFja1BsYXliYWNrQ29udHJvbEV2ZW50KEdQbGF5YmFja0NvbnRyb2xTdGF0dXMuU2Vla1N1Y2Nlc3MsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwi5YiH5o2i5pKt5pS+5pe26Ze05oiQ5YqfXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LDEwMDApO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4iLCJleHBvcnQgY29uc3QgR1RhbGtlckV2ZW50ID0ge1xyXG4gICAgQ09OTkVDVF9TVEFUVVM6ICdjb25uZWN0X3N0YXR1cydcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBHVGFsa2VyQ29ubmVjdFN0YXR1cyA9IHtcclxuICAgIENvbm5lY3RTdWNjZXNzOiAnQ29ubmVjdFN1Y2Nlc3MnLFxyXG4gICAgQ29ubmVjdEVycm9yOiAnQ29ubmVjdEVycm9yJ1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IEdUYWxrZXJDb25uZWN0RXJyb3JUeXBlID0ge1xyXG4gICAgRGV2aWNlTm90UmVzcG9uZGluZzogJ0RldmljZU5vdFJlc3BvbmRpbmcnLFxyXG4gICAgRGV2aWNlU3RvcGVkUmVzcG9uZGluZzogJ0RldmljZVN0b3BlZFJlc3BvbmRpbmcnLFxyXG4gICAgRG93bkxpbmtGYWlsOiAnRG93bkxpbmtGYWlsJyxcclxuICAgIFVwTGlua0ZhaWw6ICdVcExpbmtGYWlsJyxcclxuICAgIFdhaXRPcGVuTWljcm9waG9uZVRpbWVvdXQ6ICdXYWl0T3Blbk1pY3JvcGhvbmVUaW1lb3V0JyxcclxuICAgIE5vdEFsbG93T3Blbk1pY3JvcGhvbmU6ICdOb3RBbGxvd09wZW5NaWNyb3Bob25lJ1xyXG59OyIsImV4cG9ydCBjbGFzcyBHVGFsa2VyIHtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcih0eXBlTmFtZSkge1xyXG4gICAgICAgIHRoaXMuX3R5cGUgPSB0eXBlTmFtZSB8fCAndW5kZWZpbmVkJztcclxuICAgIH1cclxuXHJcbiAgICBpbml0KGRvd25VcmwsIHVwVXJsLCBpbWVpLCBjaGFubmVsLCBjb25maWcpIHtcclxuICAgIH1cclxuXHJcbiAgICBvbihldmVudCwgY2FsbCkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBvZmYoZXZlbnQpIHtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgYXR0YWNoTWVkaWFFbGVtZW50KGVsZW1lbnQpIHsgIFxyXG4gICAgfVxyXG5cclxuICAgIGxvYWQoKSB7XHJcbiAgICB9XHJcblxyXG4gICAgZGVzdHJveSgpIHtcclxuXHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IHtHVGFsa2VyRXZlbnQsIEdUYWxrZXJDb25uZWN0U3RhdHVzLCBHVGFsa2VyQ29ubmVjdEVycm9yVHlwZX0gZnJvbSBcIi4vZ3RhbGtlci1ldmVudHMuanNcIlxyXG5pbXBvcnQge0dUYWxrZXJ9IGZyb20gXCIuL2d0YWxrZXIuanNcIlxyXG5pbXBvcnQge0J5dGVBcnJheX0gZnJvbSBcIi4uL2NvbW1vbi9ieXRlYXJyYXkuanNcIlxyXG5pbXBvcnQge1V0aWx9IGZyb20gXCIuLi9jb21tb24vdXRpbC5qc1wiXHJcblxyXG5pbXBvcnQgZmx2anMgZnJvbSBcImZsdi1nNy5qc1wiO1xyXG5cclxuaW1wb3J0IFJlY29yZGVyIGZyb20gJ3JlY29yZGVyLWNvcmUnXHJcbmltcG9ydCAncmVjb3JkZXItY29yZS9zcmMvZW5naW5lL21wMydcclxuaW1wb3J0ICdyZWNvcmRlci1jb3JlL3NyYy9lbmdpbmUvbXAzLWVuZ2luZSdcclxuXHJcbmNvbnN0IEF1ZGlvQnVmTGVuID0gNjQwO1xyXG5jb25zdCBEZWJ1Z0ZsYWcgPSBmYWxzZTtcclxuXHJcbmV4cG9ydCBjbGFzcyBIdHRwRmx2VGFsa2VyIGV4dGVuZHMgR1RhbGtlciB7XHJcblxyXG4gICAgY29uc3RydWN0b3IgKCkge1xyXG4gICAgICAgIHN1cGVyKCdodHRwZmx2LXRhbGtlcicpO1xyXG4gICAgICAgIHRoaXMuVEFHID0gJ0h0dHBGbHZUYWxrZXInO1xyXG5cclxuICAgICAgICB0aGlzLmRvd25VcmwgPSBudWxsO1xyXG4gICAgICAgIHRoaXMudXBVcmwgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaW1laSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jaGFubmVsID0gbnVsbDtcclxuICAgICAgICBcclxuICAgICAgICB0aGlzLnBsYXllciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5yZWNvcmRlciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5zZW5kZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzID0gbnVsbDtcclxuXHJcbiAgICAgICAgdGhpcy5ieXRlQXJyYXkgPSBuZXcgQnl0ZUFycmF5KCk7XHJcblxyXG4gICAgICAgIHRoaXMudGltZXJDaGVjayA9IG51bGw7XHJcbiAgICAgICAgdGhpcy50aW1lclNlbmQgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLmhhc1JlY2VpdmVTZXJ2ZXJEYXRhID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5oYXNTZW5kQ2xpZW50RGF0YSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaGFzV2FpdE9wZW5NaWNyb3Bob25lVGltZW91dCA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuaGFzRGVzdG9yeSA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBpc1N1cHBvcnRlZCgpIHtcclxuICAgICAgICByZXR1cm4gdHlwZW9mIFdlYlNvY2tldCAhPSAndW5kZWZpbmVkJyAmJiBSZWNvcmRlci5TdXBwb3J0KCkgJiYgd2luZG93Lk1lZGlhU291cmNlICYmXHJcbiAgICAgICAgICAgIHdpbmRvdy5NZWRpYVNvdXJjZS5pc1R5cGVTdXBwb3J0ZWQoJ3ZpZGVvL21wNDsgY29kZWNzPVwiYXZjMS40MkUwMUUsbXA0YS40MC4yXCInKTtcclxuICAgIH1cclxuXHJcbiAgICBpbml0KGRvd25VcmwsIHVwVXJsLCBpbWVpLCBjaGFubmVsLCBjb25maWcpIHtcclxuICAgICAgICB0aGlzLmRvd25VcmwgPSBkb3duVXJsO1xyXG4gICAgICAgIHRoaXMudXBVcmwgPSB1cFVybDtcclxuICAgICAgICB0aGlzLmltZWkgPSBpbWVpO1xyXG4gICAgICAgIHRoaXMuY2hhbm5lbCA9IGNoYW5uZWw7XHJcbiAgICAgICAgaWYgKCF0aGlzLl9jaGVja0lucHV0UGFyYW0oKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9zdGFydFBsYXllcihkb3duVXJsKTtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBvbihldmVudCwgY2FsbCkge1xyXG4gICAgICAgIGlmIChldmVudCA9PT0gR1RhbGtlckV2ZW50LkNPTk5FQ1RfU1RBVFVTKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzID0gY2FsbDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgb2ZmKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKGV2ZW50ID09PSBHVGFsa2VyRXZlbnQuQ09OTkVDVF9TVEFUVVMpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhdHRhY2hNZWRpYUVsZW1lbnQoZWxlbWVudCkgeyAgXHJcbiAgICAgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuXHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkZWRkYXRhXCIsIHRoaXMuX29uUGxheWVyTG9hZGVkRGF0YS5iaW5kKHRoaXMpLCB7b25jZTogdHJ1ZX0pO1xyXG4gICAgICAgIHRoaXMucGxheWVyLm9uKGZsdmpzLkV2ZW50cy5FUlJPUiwgdGhpcy5fb25QbGF5ZXJFcnJvci5iaW5kKHRoaXMpKTtcclxuICAgICAgICB0aGlzLnBsYXllci5zZXRNZWRpYVNvdXJjZUVuZENhbGxiYWNrKHRoaXMuX29uUGxheWVyTWVkaWFTb3VyY2VFbmQuYmluZCh0aGlzKSk7XHJcblxyXG4gICAgICAgIHRoaXMucGxheWVyLmF0dGFjaE1lZGlhRWxlbWVudChlbGVtZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBsb2FkKCkge1xyXG4gICAgICAgIHRoaXMucGxheWVyLmxvYWQoKTtcclxuICAgICAgICB0aGlzLl9zdGFydFNlbmRlcih0aGlzLnVwVXJsKTtcclxuICAgIH1cclxuXHJcbiAgICBkZXN0cm95KCkge1xyXG4gICAgICAgIHRoaXMuaGFzRGVzdG9yeSA9IHRydWU7XHJcblxyXG4gICAgICAgIHRoaXMuX2Rlc3Ryb3lQbGF5ZXIoKTtcclxuICAgICAgICB0aGlzLl9kZXN0cm95U2VuZGVyKCk7XHJcbiAgICAgICAgdGhpcy5fZGVzdHJveVJlY29yZGVyKCk7XHJcbiAgICAgICAgdGhpcy5fZGVzdHJveVNlbmRQcm9jKCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2NoZWNrSW5wdXRQYXJhbSgpIHtcclxuICAgICAgICBpZiAoVXRpbC5pc0VtcHR5U3RyaW5nKHRoaXMuZG93blVybCkgfHwgVXRpbC5pc0VtcHR5U3RyaW5nKHRoaXMudXBVcmwpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKFV0aWwuaXNFbXB0eVN0cmluZyh0aGlzLmltZWkpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuY2hhbm5lbCA8IDAgfHwgdGhpcy5jaGFubmVsID4gMjU1KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgX3N0YXJ0UGxheWVyKHVybCkge1xyXG4gICAgICAgIHRoaXMuX2Rlc3Ryb3lQbGF5ZXIoKTtcclxuXHJcbiAgICAgICAgdGhpcy5wbGF5ZXIgPSBmbHZqcy5jcmVhdGVQbGF5ZXIoe2lzTGl2ZTp0cnVlLCB0eXBlOidmbHYnLHVybDp1cmx9LCB7XHJcbiAgICAgICAgICAgIGxhenlMb2FkOiBmYWxzZSxcclxuICAgICAgICAgICAgZW5hYmxlU3Rhc2hCdWZmZXI6IGZhbHNlLFxyXG4gICAgICAgICAgICBkZWZlckxvYWRBZnRlclNvdXJjZU9wZW46dHJ1ZVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIF9vblBsYXllckxvYWRlZERhdGEoKSB7XHJcbiAgICAgICAgaWYgKERlYnVnRmxhZykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInBsYXllciBsb2FkZWREYXRhXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5oYXNSZWNlaXZlU2VydmVyRGF0YSA9IHRydWU7XHJcbiAgICAgICAgaWYgKHRoaXMuaGFzU2VuZENsaWVudERhdGEgJiYgdGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrQ29ubmVjdFN0YXR1cyhHVGFsa2VyQ29ubmVjdFN0YXR1cy5Db25uZWN0U3VjY2VzcywgXCJcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9vblBsYXllckVycm9yKHR5cGUsIGRldGFpbCwgZXJyT2JqKSB7XHJcbiAgICAgICAgaWYgKERlYnVnRmxhZykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInBsYXllciBlcnJvclwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmNhbGxiYWNrQ29ubmVjdFN0YXR1cyA9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLmhhc1JlY2VpdmVTZXJ2ZXJEYXRhKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzKEdUYWxrZXJDb25uZWN0U3RhdHVzLkNvbm5lY3RFcnJvciwgXHJcbiAgICAgICAgICAgICAgICBHVGFsa2VyQ29ubmVjdEVycm9yVHlwZS5Eb3duTGlua0ZhaWwpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMoR1RhbGtlckNvbm5lY3RTdGF0dXMuQ29ubmVjdEVycm9yLCBcclxuICAgICAgICAgICAgICAgIEdUYWxrZXJDb25uZWN0RXJyb3JUeXBlLkRldmljZU5vdFJlc3BvbmRpbmcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfb25QbGF5ZXJNZWRpYVNvdXJjZUVuZChpbmZvKSB7XHJcbiAgICAgICAgaWYgKERlYnVnRmxhZykge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcInBsYXllciBzb3VyY2UgZW5kXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMoR1RhbGtlckNvbm5lY3RTdGF0dXMuQ29ubmVjdEVycm9yLCBcclxuICAgICAgICAgICAgICAgIEdUYWxrZXJDb25uZWN0RXJyb3JUeXBlLkRldmljZVN0b3BlZFJlc3BvbmRpbmcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfZGVzdHJveVBsYXllcigpIHtcclxuICAgICAgICBpZiAodGhpcy5wbGF5ZXIgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllci5wYXVzZSgpO1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllci51bmxvYWQoKTtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXIuZGV0YWNoTWVkaWFFbGVtZW50KCk7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWVyLmRlc3Ryb3koKTtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXIgPSBudWxsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudCAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZWxlbWVudCA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9zdGFydFNlbmRlcih1cmwpIHtcclxuICAgICAgICB0aGlzLnNlbmRlciA9IG5ldyBXZWJTb2NrZXQodXJsKTtcclxuICAgICAgICB0aGlzLnNlbmRlci5vbm9wZW4gPSB0aGlzLl9vblNlbmRlck9wZW4uYmluZCh0aGlzKTtcclxuICAgICAgICB0aGlzLnNlbmRlci5vbm1lc3NhZ2UgPSB0aGlzLl9vblNlbmRlck1zZy5iaW5kKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuc2VuZGVyLm9uY2xvc2UgPSB0aGlzLl9vblNlbmRlckNsb3NlLmJpbmQodGhpcyk7XHJcbiAgICAgICAgdGhpcy5zZW5kZXIub25lcnJvciA9IHRoaXMuX29uU2VuZGVyRXJyb3IuYmluZCh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBfb25TZW5kZXJPcGVuKCkge1xyXG4gICAgICAgIGlmIChEZWJ1Z0ZsYWcpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ3ZWJzb2NrZXQgb3BlblwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5fc3RhcnRSZWNvcmRlcigpO1xyXG4gICAgfVxyXG5cclxuICAgIF9vblNlbmRlck1zZyhlKSB7XHJcbiAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgX29uU2VuZGVyQ2xvc2UoZSkge1xyXG4gICAgICAgIGlmIChEZWJ1Z0ZsYWcpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ3ZWJzb2NrZXQgY2xvc2VcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrQ29ubmVjdFN0YXR1cyhHVGFsa2VyQ29ubmVjdFN0YXR1cy5Db25uZWN0RXJyb3IsIFxyXG4gICAgICAgICAgICAgICAgR1RhbGtlckNvbm5lY3RFcnJvclR5cGUuVXBMaW5rRmFpbCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9vblNlbmRlckVycm9yKGUpIHtcclxuICAgICAgICBpZiAoRGVidWdGbGFnKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwid2Vic29ja2V0IGVycm9yXCIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfZGVzdHJveVNlbmRlcigpIHtcclxuICAgICAgICB0aGlzLnNlbmRlci5jbG9zZSgpO1xyXG4gICAgICAgIHRoaXMuc2VuZGVyID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBfc3RhcnRSZWNvcmRlcigpIHtcclxuICAgICAgICBpZiAodGhpcy5yZWNvcmRlcikge1xyXG4gICAgICAgICAgICB0aGlzLnJlY29yZGVyLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnJlY29yZGVyID0gUmVjb3JkZXIoe1xyXG4gICAgICAgICAgICB0eXBlOlwibXAzXCIsXHJcbiAgICAgICAgICAgIHNhbXBsZVJhdGU6ODAwMCxcclxuICAgICAgICAgICAgYml0UmF0ZToxNixcclxuICAgICAgICAgICAgb25Qcm9jZXNzOnRoaXMuX29uUmVjZWl2ZU1pY3JvcGhvbmVEYXRhLmJpbmQodGhpcylcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnRpbWVyQ2hlY2sgPSBzZXRUaW1lb3V0KHRoaXMuX3RpbWVvdXRDaGVja0lmQWxsb3dPcGVuTWljcm9waG9uZS5iaW5kKHRoaXMpLDEwMDAwKTtcclxuICAgICAgICB0aGlzLnJlY29yZGVyLm9wZW4odGhpcy5fb25BbGxvd09wZW5NaWNyb3Bob25lLmJpbmQodGhpcyksXHJcbiAgICAgICAgICAgIHRoaXMuX29uTm90QWxsb3dPcGVuTWljcm9waG9uZS5iaW5kKHRoaXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBfdGltZW91dENoZWNrSWZBbGxvd09wZW5NaWNyb3Bob25lKCkge1xyXG4gICAgICAgIGlmIChEZWJ1Z0ZsYWcpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1c2VyIFdhaXRPcGVuTWljcm9waG9uZSBUaW1lb3V0XCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5oYXNXYWl0T3Blbk1pY3JvcGhvbmVUaW1lb3V0ID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMoR1RhbGtlckNvbm5lY3RTdGF0dXMuQ29ubmVjdEVycm9yLCBcclxuICAgICAgICAgICAgICAgIEdUYWxrZXJDb25uZWN0RXJyb3JUeXBlLldhaXRPcGVuTWljcm9waG9uZVRpbWVvdXQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfb25BbGxvd09wZW5NaWNyb3Bob25lKCkge1xyXG4gICAgICAgIGlmIChEZWJ1Z0ZsYWcpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1c2VyIEFsbG93T3Blbk1pY3JvcGhvbmVcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5oYXNXYWl0T3Blbk1pY3JvcGhvbmVUaW1lb3V0KSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyQ2hlY2spO1xyXG5cclxuICAgICAgICB0aGlzLmhhc1NlbmRDbGllbnREYXRhID0gdHJ1ZTtcclxuICAgICAgICBpZiAodGhpcy5oYXNSZWNlaXZlU2VydmVyRGF0YSAmJiB0aGlzLmNhbGxiYWNrQ29ubmVjdFN0YXR1cyAhPSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzKEdUYWxrZXJDb25uZWN0U3RhdHVzLkNvbm5lY3RTdWNjZXNzLCBcIlwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucmVjb3JkZXIuc3RhcnQoKTtcclxuICAgICAgICB0aGlzLl9zZW5kUHJvYygpO1xyXG4gICAgfVxyXG5cclxuICAgIF9vbk5vdEFsbG93T3Blbk1pY3JvcGhvbmUobXNnLCBpc1VzZXJOb3RBbGxvdykge1xyXG4gICAgICAgIGlmIChEZWJ1Z0ZsYWcpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJ1c2VyIE5vdEFsbG93T3Blbk1pY3JvcGhvbmVcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lckNoZWNrKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuY2FsbGJhY2tDb25uZWN0U3RhdHVzICE9IG51bGwpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxsYmFja0Nvbm5lY3RTdGF0dXMoR1RhbGtlckNvbm5lY3RTdGF0dXMuQ29ubmVjdEVycm9yLCBcclxuICAgICAgICAgICAgICAgIEdUYWxrZXJDb25uZWN0RXJyb3JUeXBlLk5vdEFsbG93T3Blbk1pY3JvcGhvbmUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfb25SZWNlaXZlTWljcm9waG9uZURhdGEoYnVmZmVycywgcG93ZXJMZXZlbCwgYnVmZmVyRHVyYXRpb24sIGJ1ZmZlclNhbXBsZVJhdGUpIHtcclxuICAgICAgICBsZXQgYXJyYXlCdWYgPSBidWZmZXJzW2J1ZmZlcnMubGVuZ3RoIC0gMV0uYnVmZmVyOyAvL1VpbnQxNkFycmF5IFRvIEFycmF5QnVmZmVyXHJcbiAgICAgICAgbGV0IHU4YnVmID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlCdWYpOyAvL0FycmF5QnVmZmVyIFRvIFVpbnQ4QXJyYXlcclxuICAgICAgICB0aGlzLmJ5dGVBcnJheS5wdXNoKHU4YnVmKTtcclxuICAgIH1cclxuXHJcbiAgICBfZGVzdHJveVJlY29yZGVyKCkge1xyXG4gICAgICAgIHRoaXMucmVjb3JkZXIuY2xvc2UoKTtcclxuICAgICAgICB0aGlzLnJlY29yZGVyID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBfc2VuZFByb2MoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuaGFzRGVzdG9yeSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5ieXRlQXJyYXkubGVuZ3RoIDwgQXVkaW9CdWZMZW4pIHtcclxuICAgICAgICAgICAgdGhpcy50aW1lclNlbmQgPSBzZXRUaW1lb3V0KHRoaXMuX3NlbmRQcm9jLmJpbmQodGhpcyksIDUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbGV0IGF1ZGlvQnVmID0gdGhpcy5ieXRlQXJyYXkucmVhZEJ5dGVzKEF1ZGlvQnVmTGVuKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBwYWNrZXIgPSBuZXcgQnl0ZUFycmF5KCk7XHJcbiAgICAgICAgICAgIHBhY2tlci5wdXNoKG5ldyBVaW50OEFycmF5KFsweDMxLDB4MzIsMHg2MywweDY0XSkpO1xyXG4gICAgICAgICAgICBsZXQgYXJySW1laUNoYXIgPSB0aGlzLmltZWkuc3BsaXQoJycpO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFyckltZWlDaGFyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBwYWNrZXIucHVzaChuZXcgVWludDhBcnJheShbYXJySW1laUNoYXJbaV0uY2hhckNvZGVBdCgpXSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhY2tlci5wdXNoKG5ldyBVaW50OEFycmF5KFtwYXJzZUludCh0aGlzLmNoYW5uZWwpXSkpO1xyXG4gICAgICAgICAgICBwYWNrZXIucHVzaChuZXcgVWludDhBcnJheShbTWF0aC5mbG9vcihBdWRpb0J1Zkxlbi8yNTYpXSkpO1xyXG4gICAgICAgICAgICBwYWNrZXIucHVzaChuZXcgVWludDhBcnJheShbQXVkaW9CdWZMZW4lMjU2XSkpO1xyXG4gICAgICAgICAgICBwYWNrZXIucHVzaChhdWRpb0J1Zik7XHJcblxyXG4gICAgICAgICAgICBsZXQgdG90YWxMZW4gPSA0ICsgYXJySW1laUNoYXIubGVuZ3RoICsgMyArIEF1ZGlvQnVmTGVuO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zZW5kZXIgIT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZW5kZXIuc2VuZChwYWNrZXIucmVhZEJ5dGVzKHRvdGFsTGVuKSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3NlbmRQcm9jKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9kZXN0cm95U2VuZFByb2MoKSB7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJTZW5kKTtcclxuICAgIH1cclxufSJdfQ=="}